         TITLE 'IGG019G7 - APPENDAGES-PART 1,BLKD,USR WA,WITH WRT CHK'  00020000
IGG019G7 CSECT                                                          00040000
*          RELEASE OS/VS2-02 DELETIONS                                * 00042002
*          RELEASE 19 DELETIONS                                       * 00052000
*2372079000,079500,099400                                        A27341 00053019
*2372070300,140100                                               A29928 00053519
*          RELEASE 20 DELETIONS                                       * 00054000
*0518018850,018900,018950,019000,039600-039800,040000-040800,    S20201 00054120
*0518042600,043600,044000,047400,047600,047800,048000,048200,    S20201 00054220
*0518048400,048600,052200-053000,055200,056200,056400-056800,    S20201 00054320
*0518058000,059400,062200,065200,071800,076620,076800,079500,    S20201 00054420
*0518079800,080600,081160,089600,092800,093400,093600,094000,    S20201 00054520
*0518096000,114200,114600,118000,130800,142000,142200,142400,    S20201 00054620
*0518142600-142680,142760,147200,147600,148600,149400,149600,    S20201 00054720
*0518158400,160400,162800,163000,165948,166400,174800,175000,    S20201 00054820
*0518185600,185800,186000,189000,189200,189400,189600-190200,    S20201 00054920
*0518191000,195000,195200,195400,195800,196800,207800-210600,    S20201 00055020
*0518210800-214600,214800-219600,219800-225600,225800-229600,    S20201 00055120
*0518229800-231600,231800-233600,233800-234600,234800-238800,    S20201 00055220
*0518244800-247600,247800-257600,258000-258800,259000-263160,    S20201 00055320
*0518263400-264200,264400-270800                                 S20201 00055420
*0518                                                            M5874  00055720
*          RELEASE 21 DELETIONS                                       * 00056000
*1192022200,023200,117000,133000                                 S21045 00056121
*1192                                                            A33533 00056321
*1192037200,049800,082008-082040,193600,199000-199200,207200-    A37184 00056621
*1192207400                                                      A37184 00057221
*1192082023                                                      M0060  00057621
*1192                                                            A46955 00057821
*XXXX                                                            A49403 00057921
*1192022000                                                      A50670 00064600
*          CHANGES SINCE VS2-3.7                                      * 00066637
*A024060-024120,A206820-206825                                 @ZA26522 00068637
*                                                                     * 00071302
*STATUS CHANGE LEVEL 011                                                00078002
*                                                                       00100000
* FUNCTION/OPERATION- APPENDAGE ROUTINES FOR BISAM                      00120000
*        WHEN WRITE KN IS USED WITH OR WITHOUT READ AND UPDATE          00140000
*        WHEN THE USER HAS     SUPPLIED A READ-IN AREA,                 00160000
*        WHEN WRITE VALIDITY CHECKING IS     REQUESTED,                 00180000
*        AND RECORD FORMAT IS   BLOCKED.                                00200000
*        (PART 1)                                                       00220000
*                                                                       00240000
*        CEND  - IF CHANNEL PROGRAM ENDS                                00260000
*                **WITHOUT ERROR, EITHER                                00280000
*                    PROCESSING COMPLETION WILL BE SCHEDULED,           00300000
*                    PROCESSING CONTINUATION WILL BE SCHEDULED,         00320000
*                    OR PROCESSING WILL CONTINUE.                       00340000
*                **WITH A LENGTH CHECK, TESTS DETERMINE WHETHER         00360000
*                    OR NOT TO TREAT THE SITUATION AS A REAL            00380000
*                    ERROR.                                             00400000
*                **ANY OTHER ERROR, IN GENERAL, 'UNREACHABLE            00420000
*                    BLOCK' IS INDICATED IN THE DECB, AND               00440000
*                    PROCESSING COMPLETION WILL BE SCHEDULED.           00460000
*                                                                       00480000
*        ABEND - IF CHANNEL PROGRAM ENDS ABNORMALLY BECAUSE OF          00500000
*                **PERMANENT ERROR, 'UNCORRECTABLE I/O ERROR'           00520000
*                    IS INDICATED IN THE DECB, AND PROCESSING           00540000
*                    COMPLETION WILL BE SCHEDULED.                      00560000
*                    USE OF WRITE VALIDITY CHECKING OPTION              00580000
*                    ALLOWS A LIMITED NUMBER OF RE-EXECUTIONS           00600000
*                    BEFORE INDICATING AN ERROR.                        00620000
*                **NON-PERMANENT ERROR, ONE RE-TRY IS MADE              00640000
*                    BEFORE INDICATING A PERMANENT ERROR.               00660000
*                **FILE PROTECTION, TESTS DETERMINE WHETHER             00680000
*                    OR NOT TO TREAT THE SITUATION AS A REAL            00700000
*                    ERROR.                                             00720000
*                **ANY OTHER ERROR, IN GENERAL, 'UNREACHABLE            00740000
*                    BLOCK' IS INDICATED IN THE DECB, AND               00760000
*                    PROCESSING COMPLETION WILL BE SCHEDULED.           00780000
* ENTRY POINTS-                                                         00800000
*        ENTRY POINT               FUNCTION                             00820000
*        -----------               --------                             00840000
*        APPCEND                   CEND                                 00860000
*        APPABEND                  ABEND                                00880000
* INPUT - N/A                                                           00900000
* OUTPUT - N/A                                                          00920000
* EXTERNAL ROUTINES - N/A                                               00940000
*                                                                       00960000
* EXITS- 1. RETURN TO IOS VIA THE APPENDAGE RETURN VECTOR TABLE POINTED 00980000
*            TO BY REGISTER 14.  SEE THE DSECT LABELED    APPRV FOR THE 01000000
*            FORMAT OF THIS TABLE AND THE USE OF EACH EXIT.             01020000
*           USED TO CONTINUE PROCESSING.                                01040000
*        2. SCHEDULE AN ASYNCHRONOUS ROUTINE - BRANCH VIA THE EXIT      01060000
*            EFFECTOR ADDRESS IN THE COMMUNICATION VECTOR TABLE.        01080000
*           USED TO SCHEDULE PROCESSING COMPLETION OR CONTINUATION.     01100000
*        3. IF THE DESIRED APPENDAGE ROUTINE IS IN PART 2, BRANCH TO    01120000
*            THAT ROUTINE VIA THE PART 2 VECTOR TABLE.  THE POINTER TO  01140000
*            THE MODULE IS IN DCBWKPT5.  SEE THE DSECT LABELED          01160000
*            IHAPART2 FOR RELATIVE ADDRESSES AND USES OF THE ROUTINES.  01180000
*                                                                       01200000
* TABLES/WORK AREAS - DECB, DCB, IOB AND EXTENTION, DCB WA (DCW), DEB,  01220000
*        CVT, PART 2 VECTOR TABLE.                                      01240000
*        SEE DSECTS AT END OF MODULE FOR FORMAT AND DESCRIPTIONS.       01260000
*                                                                       01280000
* ATTRIBUTES- REENTRANT. DISABLED.                                      01300000
* NOTES - NONE                                                          01320000
         EJECT                                                          01340000
* GENERAL REGISTERS ARE USED AS FOLLOWS                                 01360000
*                                                                       01380000
R0       EQU   0                   *    -----                           01400000
R1       EQU   1                   *    12* ADDRESS                     01420000
R2       EQU   2                   *    IOB                             01440000
R3       EQU   3                   *    DEB                             01460000
R4       EQU   4                   *    DCB                             01480000
BASEXXXX EQU   5                        BASE REG FOR CLEANUP     Y02072 01492002
SAVEXXXX EQU   6                        SAVE AREA FOR CLEANUP    Y02072 01510002
R7       EQU   7                   *    UCB                             01540000
R8       EQU   8                        NOT USED                 Y02072 01550002
R9       EQU   9                   #    WORK REGISTER                   01580000
R10      EQU   10                       CHANNEL PROGRAM POINTER         01600000
R11      EQU   11                       DECB                            01620000
R12      EQU   12                       WORK REGISTER                   01640000
R13      EQU   13                       WORK REGISTER                   01660000
R14      EQU   14                       IOS RETURN VECTOR TABLE         01680000
R15      EQU   15                       BASE REGISTER                   01700000
*                                                                       01720000
*        * MEANS THIS REGISTER IS SET UP UPON ENTRY FROM IOS,           01740000
*          AND ITS CONTENTS MUST BE RESTORED UPON RETURN TO IOS         01760000
*        # MEANS THIS REGISTER MAY BE CHANGED, BUT UPON RETURN TO IOS   01780000
*          MUST CONTAIN ZEROES IN THE THREE HIGH ORDER BYTES            01800000
*                                                                       01820000
PERRMASK EQU   X'20'          TO TEST FOR PERMANENT ERROR, TEST         01840000
PERRYES  EQU   8               IOBECBAD, B2. IF OFF (CONDITION CODE 8)  01860000
PERRNO   EQU   7               THERE IS A PERM ERR. ELSE B2 ON ( CD 7)  01880000
ONE      EQU   1                        MISC OFFSETS             S20201 01880820
TWO      EQU   2                        *                        S20201 01881620
THREE    EQU   3                        *                        S20201 01882420
FOUR     EQU   4                        *                        S20201 01883220
FIVE     EQU   5                        *                        S20201 01884020
SIX      EQU   6                        *                        S20201 01887020
SEVEN    EQU   7                        *                        S20201 01888020
EIGHT    EQU   8                        *                        S20201 01889020
NINE     EQU   9                        *                        S20201 01890020
SIXTEEN  EQU   16                       *                        S20201 01891020
OFLOW    EQU   X'10'                    OVERFLOW BIT OF F BYTE   S20201 01893020
DUMMY    EQU   X'20'                    DUMMY BIT OF F BYTE      S20201 01894020
KADDRCHG EQU   X'80'                    KEY ADDRESS CHANGE SW    S20201 01895020
CCOFF    EQU   X'BF'                    MASK FOR CC OFF                 01895501
BYP      EQU   12                       RETURN TO IOS/BYPASS     S20201 01896020
EXCP     EQU   8                        RETURN TO IOS/EXCP       S20201 01902020
NORMAL   EQU   0                        RETURN TO IOS/NORMAL     S20201 01908020
ABENTRY  EQU   X'01'                    ABEND ENTRY INDICATOR    A50670 01913000
DATACHK  EQU   X'08'                    DATA CHECK IOB SENSE     A50670 01913400
REEXCP   EQU   8                        REEXCP RETURN TO IOS     Y02072 01913802
SKIPX    EQU   4                        SKIP RETURN TO IOS       Y02072 01913902
BYPASS   EQU   12                       BYPASS RETURN TO IOS     Y02072 01920402
NOTSEEK  EQU   8                        CC - SEEK TEST SENSE B0  Y02072 01922402
FMVIOL   EQU   X'04'                    FILE MASK VIOLATION      Y02072 01922802
SEEKCHK  EQU   X'01'                    SEEK CHECK INDICATOR     Y02072 01924402
*                                                                       01926402
         USING RQE,R1                   RQE ADDRESSABILITY       Y02072 01926802
         USING IHAIOB,R2                IOB POINTER              S20201 01927002
         USING IHADEB,R3                DEB POINTER                     01933502
         USING IHADCB,R4                DCB POINTER                     01940000
         USING IHAWKNCP,R10             CHANNEL PROGRAM POINTER         01960000
         USING IHADECB,R11              DECB POINTER                    01980000
         USING IHADCW,R12               DCB WA POINTER ONLY AS WORK REG 02000000
         EJECT                                                          02040000
*                             APPENDAGE VECTOR TABLE                    02060000
APP      DC    A(APPCEND-APP)          CHANNEL END-   USED BY WKN       02080000
         DC    A(APPABEND-APP)          ABNORMAL END  -     USED BY WKN 02100000
APPNO    EQU   *                                                        02120000
         USING APPCEND,R15                                              02140000
APPCEND  NI    IOBINDCT,X'FE'          INDICATE CEND ENTRY              02160000
         B     SETUPREG                 BRANCH TO SET UP REGISTERS      02180000
APPABEND EQU   *                                                 A50670 02190000
         USING APPABEND,R15                                             02192000
*                                                                A50670 02200000
*        IF THIS IS A CORRECTABLE DATA CHECK FROM AN RPS         A50670 02210000
*        DEVICE THEN RETURN TO IOS FOR ERP HANDLING              A50670 02220000
*                                                                A50670 02222000
         TM    IOBECBAD,PERRMASK        PERMANENT ERROR          A50670 02222400
         BZ    NOCDACK                  YES CONTINUE AS USUAL    A50670 02222800
         TM    IOBSENS1,FMVIOL          WAS IT A SEEK CHECK      Y02072 02224802
         BCR   NOTSEEK,R14              NO - RETURN TO ERPS      Y02072 02226802
         SPACE 3                                                        02228802
NOCDACK  EQU   *                                                 A50670 02230100
         OI    IOBINDCT,ABENTRY         INDICATE ABEND ENTRY     A50670 02230200
SETUPREG L     R15,DEBEXPTR              GET ADDR OF DEB         S21045 02248800
*                                       EXTENSION PTR            S21045 02254000
         USING DEBEXT,R15                                        S21045 02259200
         L     R15,DEBWKPT4              R15  BASE               S21045 02264400
         DROP  R15                                                      02269600
         USING APP,R15                                                  02274800
*                                                                       02275202
*   SAVE IOS REGISTERS AND SET UP ADDRESSABILITY TO RETURN TO SPECIAL   02276802
*   CLEANUP ROUTINE.                                                    02278802
*                                                                       02278902
         STM   R14,R12,0(R13)           SAVE REGISTERS           Y02072 02279202
         LR    SAVEXXXX,R13             SAVE SAVE AREA PTR       Y02072 02279602
         LA    R14,IOSRETS              RETURN TO RETURN TO IOS  Y02072 02279702
         LR    BASEXXXX,R14             BASE REG FOR RETURN      Y02072 02279802
         SPACE 2                                                        02279902
         MODESET KEYADDR=RQEPRT,WORKREG=13 ACQUIRE USER KEY      Y02072 02280002
         SPACE 3                                                        02283902
         L     R10,IOBCCWAD             R10  CP                         02288002
         LA    R10,0(R10)               CLEAR HIGH ORDER BYTE    A49403 02292002
         MVC   IOBECBAD+1(3),IOBBCHAD+1 RESTORE ECB              A33533 02296002
         L     R11,IOBECBAD             R11  DECB                       02300000
         L     R13,DEBEXPTR              GET ADDR OF DEB         S21045 02306021
*                                       EXTENSION PTR            S21045 02312021
         USING DEBEXT,R13                                        S21045 02318021
         L     R13,DEBWKPT5              R13  BASE, PART 2       S21045 02324021
         DROP  R13                                               S21045 02330021
         USING IHAPART2,R13                                             02340000
         L     R12,IOBCSW               R12  ADDRESS OF LAST CCW + 8    02360000
         LA    R12,0(0,R12)                                             02380000
         IC    R9,IOBAPP                R9   RELATIVE ADDRESS IN        02400000
         CH    R9,TWOFOUR               IS APPCODE GT 24?      @ZA26522 02406037
         BH    INVAPPCD                 IF SO, GO PROG CHK     @ZA26522 02412037
         SLL   R9,2                            APPENDAGE TABLE          02420000
         TM    IOBINDCT,X'01'                                           02440000
         BO    APPABENT(R9)            IF ABEND, BRANCH VIA ABEND TABLE 02460000
         B     APPCENDT(R9)            IF CEND, BRANCH VIA THAT TABLE   02480000
         EJECT                                                          02500000
*********************************************************************** 02520000
*****              CHANNEL END APPENDAGE VECTOR TABLE             ***** 02540000
*********************************************************************** 02560000
APPCENDT EQU   *              CODE      FOR COMPLETION OF               02580000
         B     APPABA2   0             CP4/CP5, READ                    02600000
         B     APPABA2   1             CP4/CP5, WRITE                   02620000
         B     APPADB2   2             CP7W                             02640000
         B     APPAAB2   3             CP1 OR CP2, READ AND UPDATE      02660000
         B     APPAFB                   CP14-PART2                17332 02680018
         B     APPACA2   5             CP6                              02700000
         B     APPAHB2   6             CP4/CP5 WRITE CHECK              02720000
         B     APPM67CE  7             CP1 OR CP2, WRITE KN             02740000
         B     APPN3B21                                                 02760000
         B     APPN7B2   9             CP10AW - TRUE INSERT             02780000
         B     APPN8A2   10            CP10BW - TRUE INSERT             02800000
         B     APPN8A2   11            CP10BW - ADD TO END              02820000
         B     APPM4A2   12            CP14W - SETUPS 1, 2, OR 5        02840000
         B     APPM5A2   13            CP14W - SETUPS 3, 4, OR 6        02860000
         B     APPM1B21                                                 02880000
         B     APPM2B2   15            CP16 - SITUATION 2               02900000
         B     APPM3B2   16            CP16 - SITUATION 3               02920000
         B     APPN9A2   17            CP17W - TRACK INDEX ONLY         02940000
         B     APPN9A2   18            CP17W - TRACK AND HIGHER LEVELS  02960000
         B     APPN9A2   19            CP17W - HIGHER LEVELS ONLY       02980000
         B     APPU1B2   20            CP13A                            03000000
         B     APPU2B2   21            CP13B                            03020000
         B     APPJAC2   22            CP123W                           03040000
         B     APPN7B2   23             CP10AW - ADD TO END             03060000
         B     APPU6B2   24            CP13CW                           03080000
         EJECT                                                          03100000
*********************************************************************** 03120000
*****             ABNORMAL END APPENDAGE VECTOR TABLE             ***** 03140000
*********************************************************************** 03160000
APPABENT EQU   *              CODE      FOR COMPLETION OF               03180000
         B     APPABD2   0             CP4/CP5, READ                    03200000
         B     APPABD2   1             CP4/CP5, WRITE                   03220000
         B     APPAIB2   2             CP7                              03240000
         B     APPAAA2   3             CP1 OR CP2, READ AND UPDATE      03260000
         B     APPAEB                   CP14 PART 2               17332 03280018
         B     APPACE2   5             CP6                              03300000
         B     APPAHD2   6             CP4/CP5 WRITE CHECK              03320000
         B     APPM67AE  7             CP1 OR CP2, WRITE KN             03340000
         B     APPN3E2     8            CP8                             03360000
         B     APPJ3B2   9             CP10AW - TRUE INSERT             03380000
         B     APPJ4B2   10            CP10BW - TRUE INSERT             03400000
         B     APPJ4B2   11            CP10BW - ADD TO END              03420000
         B     APPJ5B2   12            CP14W - SETUPS 1, 2, OR 5        03440000
         B     APPJ6B2   13            CP14W - SETUPS 3, 4, OR 6        03460000
         B     APPM1J2   14            CP15                             03480000
         B     APPM2H2   15            CP16 - SITUATION 2               03500000
         B     APPM2H2   16            CP16 - SITUATION 3               03520000
         B     APPJ7B2   17            CP17W - TRACK INDEX ONLY         03540000
         B     APPJ7B2   18            CP17W - TRACK AND HIGHER LEVELS  03560000
         B     APPJ7B2   19            CP17W - HIGHER LEVELS ONLY       03580000
         B     APPU4B2   20            CP13A                            03600000
         B     APPJAE2                                            17332 03620018
         B     APPJAE2   22            CP123W                           03640000
         B     APPJ3B2   23             CP10AW - ADD TO END             03660000
         B     APPJCB2   24            CP13CW                           03680000
         DROP  R13                                                      03700000
         EJECT                                                          03740000
*   SPECIAL IOS RETURN CLEANUP ROUTINE INTERCEPTS ALL RETURNS TO        03750002
*   IOS AND RESTORES REGISTERS AND SETS PROTECTION KEY TO 0.            03752002
         SPACE 2                                                 Y02072 03754002
IOSRETS  EQU   *                        RETURN POINT             Y02072 03756002
         USING *,BASEXXXX               ADDRESSABILITY           Y02072 03758002
         B     NORMRET                  NORMAL RETURN            Y02072 03758402
         B     SKIPRET                  SKIP POST RETURN         Y02072 03758802
         B     REEXCPRT                 REEXCP RETURN            Y02072 03759202
         SPACE 2                                                        03759602
BYPASRET EQU   *                        BYPASS POST RETURN       Y02072 03759702
         BAL   R12,IOSRETX              RESTORE REGS AND KEY     Y02072 03759802
         LA    R14,BYPASS(R14)          SCHEDULE ASYNCH ROUTINE  Y02072 03759902
         L     R13,CVTPTR               CVT ADDRESSABILITY       Y02072 03766602
         USING CVT,R13                  *                        Y02072 03767002
         L     R13,CVT0EF00             ASYNCH SCHED ROUTINE     Y02072 03768602
         DROP  R13                      *                        Y02072 03769002
         BR    R13                      GO TO ROUTINE            Y02072 03770602
         SPACE 2                                                        03772602
REEXCPRT EQU   *                        REEXCP RETURN            Y02072 03773002
         BAL   R12,IOSRETX              RESTORE REGS AND KEY     Y02072 03773102
         B     REEXCP(R14)              RETURN - REEXCP          Y02072 03773202
         SPACE 2                                                        03775302
SKIPRET  EQU   *                        RETURN - SKIP            Y02072 03777302
         BAL   R12,IOSRETX              RESTORE REGS AND KEY     Y02072 03777702
         B     SKIPX(R14)               RETURN - SKIP            Y02072 03777802
         SPACE 2                                                        03777902
NORMRET  EQU   *                        RETURN - NORMAL          Y02072 03778602
         BAL   R12,IOSRETX              RESTORE REGS AND KEY     Y02072 03779002
         BR    R14                      RETURN                   Y02072 03779402
         SPACE 2                                                        03779802
IOSRETX  EQU   *                        RESTORE REGS AND KEY     Y02072 03779902
         MODESET KEYADDR=KEY0,WORKREG=13   SET KEY = 0           Y02072 03780102
         SPACE 2                                                        03780202
         LM    R14,R11,0(SAVEXXXX)      RESTORE REGISTERS        Y02072 03780502
         BR    R12                      RETURN                   Y02072 03780602
         DROP  BASEXXXX                 RESET ADDRESSABILITY     Y02072 03780702
         SPACE 2                                                 Y02072 03781002
KEY0     DC    H'0'                     KEY 0                    Y02072 03781402
         EJECT                                                   Y02072 03781502
*              CHANNEL  END CP8,    APPENDAGE CODE  8,         CHART N3 03781702
APPN3B2  EQU   *                        *                               03782002
*                                                                       03782202
         LA    R13,CB8A+EIGHT           DID CHANNEL PROGRAM END ON      03784302
         CLR   R12,R13                  CB8A                            03786402
         BNE   APPAOS22                 NO, CONTINUE                    03788502
         TM    CB8A+FIVE,CC             WAS CB8A CHAINED                03790602
         BZ    APPAOS22                 NO, CP UNCHANGED                03792702
         NI    CB8A+FIVE,CCOFF          RESET CHAIN IND.                03794802
         OI    CB8A+FOUR,CC             TURN CC BACK ON                 03796902
         CLI   CB12,SEEKHH              CB12 SET FOR HEAD SEEK          03799002
         BNE   APPN3F3                  NO,  FILE PROTECT               03801102
         LA    R13,CB16                 RESET IOBSTART                  03803202
         ST    R13,IOBSTART-ONE         START CP WITH SETSECT           03805302
         MVC   IOBDADAD,CB10+SEVEN      RESET IOBSEEK                   03807402
         B     APPRVXCP                 SECHDULE EXCP IOS RETURN        03809502
APPAOS22 EQU   *                        *                               03811602
*                                                                       03813702
         LA    R13,CB21+EIGHT           DID CHAN PROG STOP AT CB21      03815802
         CLR   R12,R13                  BE MEANS YES, BNE MEANS NO      03817902
         BNE   APPN3A3                  NO - CHECK FOR LENGTH ERROR     03820000
         TM    CB11+7,X'08'             TEST IF TRACK IS SHARED         03840000
         L     R12,DCBWKPT2             CREATE PROPER 'R' IN DCWHIRPS   03860000
         BO    APPN3C2A                 BO IF SHARED                    03880000
         MVC   DCWHIRPS,DCBHIRPD        UNSHARED - USE DCBHIRPD         03900000
         B     APPN3C2B                                                 03920000
APPN3C2A MVC   DCWHIRPS,DCBHIRSH        SHARED   - USE DCBHIRSH         03940000
APPN3C2B EQU   *                                                 S20201 03970020
APPN3C2D MVC   IOBDADAD+3(5),CB23+3    MOVE CB23 CCHHR TO IOB           04100000
         MVI   IOBAPP,X'14'             SET APPENDAGE CODE TO 20        04120000
         OI    IOBFLAG1,X'40'           USE COMMAND CHAINING            04140000
         NI    IOBFLAG1,X'7F'           DONT USE DATA CHAINING          04160000
         LA    R13,CF1                  START AT CF1                    04180000
         ST    R13,IOBSTART-1                                           04200000
         L     R12,DCBWKPT2                                             04220000
         L     R13,CF2+4                SET OFF KEY ADDRESS CHANGE SW   04240000
         USING CP13B,R13                ESTABLISH ADDRESSABILITY S20201 04250020
         NI    CG2+FOUR,X'FF'-KADDRCHG  TURN BIT OFF             S20201 04260020
         MVI   IOBCOUNT,X'0A'           SET COUNTER TO 10               04280000
         IC    R9,DCWHIRPS              INITIALIZE CP13A AND CP13B      04300000
         L     R12,CB2+4                POINTER TO CEA                  04320000
         LA    R13,IOBDADAD+3           PUT IOB ADDRESS IN CEA          04340000
         USING CP123,R12                                         S20201 04350020
         STH   R13,CEA+TWO              STORE IOBSEEK ADDRESS    S20201 04360020
         SRL   R13,16                                                   04380000
         STC   R13,CEA+ONE              STORE IOBSEEK ADDRESS    S20201 04400020
         LA    R12,0(R0,R9)             SET CC FLAGS ACCORDING TO       04420000
         IC    R9,IOBDADAD+7             NUMBER OF RCDS TO RD/WR        04440000
         SR    R12,R9                                                   04460000
         SLL   R12,4                                                    04480000
         LA    R13,CF3+4                REG 13 = FIRST CC FLAG          04500000
         LA    R12,0(R12,R13)           REG 12 = LAST  CC FLAG          04520000
APPN3D2A CLR   R12,R13                                                  04540000
         BE    APPN3D2B                                                 04560000
         MVI   0(R13),X'40'             SET CC FLAG ON                  04580000
         LA    R13,16(R0,R13)                                           04600000
         B     APPN3D2A                                                 04620000
APPN3D2B MVI   0(R13),X'00'             SET CC FLAG OFF                 04640000
         L     R12,DCBMSWA              INSERT COUNT FIELD IN Y         04660000
         MVC   0(5,R12),IOBDADAD+3                                      04680000
         MVC   5(1,R12),DCBKEYLE                                        04700000
         MVC   6(2,R12),DCBBLKSI                                        04720000
         LA    R12,IOBDADAD+THREE       POINT TO IOBSEEK         S20201 04740020
         L     R13,CF2+FOUR             POINT TO CG1 OF CP13B    S20201 04760020
         STH   R12,CG1+TWO                                       S20201 04780020
         SRL   R12,SIXTEEN                                       S20201 04800020
         STC   R12,CG1+ONE                                       S20201 04820020
         MVC   CL5+ONE(THREE),CG1+ONE   MOVE ADDRESS             S20201 04840020
         MVC   CL7A+ONE(THREE),CG1+ONE  MOVE ADDRESS             S20201 04860020
         B     APPRVXCP                 EXCP RETURN TO IOS              04880000
APPN3B1  EQU   *                        ASYNCHRONOUS EXIT        Y02072 04886002
*                                                                       04896002
APPN3B3  OI    DECBEXC1,X'04'           RECORD IS UNREACHABLE           04900000
APPN3B4  MVI   IOBASYN,X'08'            SCHEDULE PROCESSING COMPLETION  04920000
APPN3B5  B     BYP(R14)                 SCHEDULE ASYNCH ROUTINE  Y02072 04940002
         SPACE 2                                                        04990002
APPN3B6  LA    R13,CB8A+EIGHT           DID CP STOP AT CB8A      S20201 05002020
         CLR   R12,R13                                           S20201 05004020
         BNE   APPN3B3                  NO, UNREACHABLE BLOCK    S20201 05006020
         TM    CB11+SEVEN,OFLOW+DUMMY   OFLO, INACTIVE, OR DUMMY S20201 05008020
         BNZ   APPN3F3                  YES, GO TO FILE PROTECT  S20201 05010020
         MVC   CB23+THREE(FOUR),CB11+TWO  SET UP CCHH            S20201 05012020
         MVI   CB23+SEVEN,ONE           SET R EQUAL TO 1         S20201 05014020
         B     APPN3C2D                 GO READ RECORD           S20201 05016020
         EJECT                                                          05020000
*              ABNORMAL END CP8,    APPENDAGE CODE  8,         CHART N3 05040000
APPN3E2  EQU   *                                                  19374 05060000
         TM    IOBSENSE+1,X'04'         WAS ABEND DUE TO          15924 05080016
*                                       FILE PROTECT              15924 05090016
         BO    APPN3F2                  YES--BRANCH               19374 05100000
         TM    IOBECBAD,PERRMASK        PERMANENT ERROR?          19374 05110000
         BC    PERRYES,APPN3B3          YES--BRANCH               19374 05120000
         B     APPRVNOR                 NO--RETRY CHANNEL PGM     19374 05130000
APPN3F2  LA    R13,CB12+8               DID CHAN PROG STOP AT CB12      05160000
         CLR   R12,R13                  BE MEANS YES, BNE MEANS NO      05180000
         BNE   APPN3B3                  NO - RECORD IS UNREACHABLE      05200000
APPN3F3  TM    CB11+SEVEN,OFLOW         WAS OFLO TRK IX ENTRY RD S20201 05210020
         BZ    APPN3G3                  BZ IF NO                        05320000
         TM    CB11+7,X'20'                                             05340000
         BO    APPN3G3                  BO IF NO                        05360000
         MVC   CJ11(7),IOBDADAD        SAVE TRACK INDEX MBBCCHH         05380000
         MVI   IOBAPP,X'10'             SET APPENDAGE CODE TO 16        05400000
         NI    IOBFLAG1,X'7F'           DONT USE DATA CHAINING          05420000
         OI    IOBFLAG1,X'40'           USE COMMAND CHAINING            05440000
         LA    R13,CJ1                  START AT CJ1                    05460000
         ST    R13,IOBSTART-1                                           05480000
         MVC   IOBDADAD,CB10+7          PUT CB10 MBBCCHHR IN IOB        05500000
         LA    R13,IOBDADAD+3           PUT SEEK ADDRESS IN CJ1 AND CJ5 05540000
         IC    R9,CJ1                                                   05560000
         ST    R13,CJ1                                                  05580000
         STC   R9,CJ1                                                   05600000
         MVC   CJ5+ONE(THREE),CJ1+ONE   MOVE IN ADDR OF SEEK     S20201 05610020
         MVC   CJ3+ONE(THREE),DECBKEY+ONE  MOVE IN ADDR OF KEY   S20201 05620020
         MVC   CJ7+ONE(THREE),DECBKEY+ONE  MOVE IN ADDR OF KEY   S20201 05630020
         L     R12,DCBWKPT2             SET ON FIRST TIME ONLY SWITCH   05700000
         USING IHADCW,R12               ESTABLISH ADDRESSABILITY S20201 05710020
         OI    DCWWKNI,X'40'                                            05720000
         LA    R12,0(R0,R0)             IS FIRST OFLO ON SAME MODULE    05740000
         IC    R12,CB10+7                      GET M OF OFLO ENTRY      05760000
         SLL   R12,4(R0)                       MULT BY 16               05780000
         L     R12,DEBUCBAD(R12)        LOAD UCB ADDR FROM DEB   S20201 05800020
         LA    R12,0(R0,R12)                   COMP WITH UCB AD IN 7    05820000
         CR    R12,R7                                                   05840000
         BE    APPRVXCP                 SAME MODULE - EXCP RTRN TO IOS  05860000
         MVI   IOBASYN,X'01'            DIFFERENT MODULE - MUST EXCP    05880000
         B     APPN3B5                   IN ASYNCHRONOUS ROUTINE        05900000
APPN3A3  TM    IOBCSW+5,X'40'           DID CHAN PROG HAVE LENGTH ERROR 05920000
         BZ    APPN3B6                  GO TEST FOR SPECIAL CASE S20201 05940020
         TM    CB11+7,X'30'             WAS ENTRY INACTIVE              05960000
         BO    APPN3B3                  BO IF YES                       05980000
APPN3G3  TM    CB11+7,X'20'             VERIFY ADD-TO-END SITUATION     06000000
         BZ    APPN3B3                  BZ IF DUMMY OR INACTIVE         06020000
         CLI   DCBNLEV,X'00'            ERROR IF 2 OR MORE INDEX LEVELS 06040000
         BNE   APPN3B3                  BNE IF MORE THAN 1 INDEX LEVEL  06060000
         TM    CB11+7,X'08'             TEST IF TRACK IS SHARED         06080000
         L     R12,DCBWKPT2             CREATE PROPER 'R' IN DCWHIRPS   06100000
         USING IHADCW,R12                                        S20201 06110020
         BO    APPN3G33                 BO IF SHARED                    06120000
         MVC   DCWHIRPS,DCBHIRPD        UNSHARED - USE DCBHIRPD         06140000
         B     APPN3G34                                                 06160000
APPN3G33 MVC   DCWHIRPS,DCBHIRSH        SHARED   - USE DCBHIRSH         06180000
APPN3G34 L     R13,CF2+4                SET OFF KEY ADDR CHANGE SW      06200000
         USING CP13B,R13                ESTABLISH ADDRESSABILITY S20201 06210020
         NI    CG2+FOUR,X'FF'-KADDRCHG  TURN SWITCH OFF          S20201 06220020
APPN3G5  MVI   IOBAPP,X'0E'             SET APPENDAGE CODE TO 14        06240000
         MVC   IOBDADAD(3),DCBLPDA      SEEK TO DCBLETI'S CYLINDER      06260000
         MVC   IOBDADAD+3(4),DCBLETI   CCHH TO IOB                      06280000
         OC    IOBDADAD+6(1),DCBFIRSH+3  MASK OUT TRACK VALUE           06300000
         XC    IOBDADAD+6(1),DCBFIRSH+3   TO REDUCETO CYL BOUNDRY       06320000
         MVI   IOBDADAD+7,X'00'        R=0                              06340000
         LA    R12,CI1                  START AT CI1                    06360000
         ST    R12,IOBSTART-1                                           06380000
         NI    IOBFLAG1,X'7F'           DON'T USE DATA CHAINING         06400000
         OI    IOBFLAG1,X'40'           USE COMMAND CHAINING            06420000
         LA    R12,IOBDADAD+3           PUT SEEK ADDRESS IN CI1         06440000
         IC    R9,CI1                                                   06460000
         ST    R12,CI1                                                  06480000
         STC   R9,CI1                                                   06500000
         MVC   CI5+TWO(FIVE),DCBLETI    PUT DCBLETI CCHHR IN CI5 S20201 06510020
         MVC   CI5(TWO),DCBLPDA+ONE     MOVE IN BB FOR HEAD SEEK S20201 06520020
         B     APPRVXCP                                                 06540000
         EJECT                                                          06560000
*              CHANNEL  END CP13A,  APPENDAGE CODE 20,         CHART U1 06580000
APPU1B2  LA    R9,8                                                     06600000
         SR    R12,R9                   POINT TO LAST OP CODE           06620000
         CLI   0(R12),X'06'                                             06640000
         BNE   APPN3B3                  NO - BRANCH UNREACHABLE         06660000
         L     R12,DCBWKPT2             DCB WORK AREA                   06680000
         USING IHADCW,R12               ESTABLISH ADDRESSABILITY S20201 06690020
         TM    DCWWKNI,X'10'            WAS CP13A USED FOR ADD TO END   06700000
         BO    APPU3B2                  YES BRANCH TO A.T.E. CHART U3   06720000
*              REGISTERS 3 AND 10 WILL NOW BE DESTROYED                 06740000
         L     R13,CF3                  Z+RL                            06760000
         LA    R13,0(R0,R13)                                            06780000
         SH    R13,DCBLRECL             POINT TO RCV ADDR, Z            06800000
APPU1C3  L     R10,DECBKEY              POINT TO KEY OF INSERT          06820000
         LR    R12,R13                                                  06840000
         AH    R12,DCBLRECL                                             06860000
         AH    R12,DCBRKP               POINT TO KEY OF SEND AREA       06880000
         IC    R9,DCBKEYLE                                              06900000
         BCTR  R9,R0                    COMPARE KEYLE BYTES             06920000
         EX    R9,APPU1C32              COMPARE INSERT TO SEND          06940000
         BL    APPU1D2                  BRANCH TO INSERT                06960000
         BE    APPU1C1                  BRANCH TO REPLACE               06980000
         SH    R12,DCBRKP               ADJUST SEND ADDRESS             07000000
         BAL   R3,APPMOV10              MOVE FORWARD ONE RECORD         07020000
*                                                                       07020402
*                       GIVE UNREACHABLE BLOCK CONDITION IF NO KEY      07021018
*                       IN FIRST BLOCK READ IS HIGHER THAN KEY          07022018
*                       TO BE ADDED                                     07023018
*                                                                       07023402
         L     R10,IOBCCWAD             GET CP ADDRESS AGAIN      24080 07024018
         L     R3,CF3                   ADDRESS OF BLOCK READ     24080 07025018
         LA    R3,0(0,R3)                                         24080 07026018
         AH    R3,DCBBLKSI              ADDRESS OF END OF BLOCK   24080 07027018
         CR    R12,R3                   NEXT LRECL TO BE MOVED VS 24080 07028018
*                                       END OF BLOCK                    07029018
         BNL   APPN3B1                  BRANCH IF BEYOND END     A29928 07034019
         B     APPU1C3                  LOOP                            07040000
APPU1C32 CLC   0(0,R10),0(R12)          EXECUTED INSTRUCTION            07060000
APPU1D2  L     R12,DECBAREA                                             07080000
         LA    R12,16(R0,R12)           MOVE AREA +16                   07100000
         BAL   R3,APPMOV10              INSERT NEW RECORD               07120000
         L     R10,DCBWKPT3             RESTORE CP8 POINTER ONLY        07140000
         L     R3,CF2+4                                                 07160000
         DROP  R13                                               S20201 07170020
         USING CP13B,R3                                          S20201 07180020
         LA    R3,CG1                   GET A(CG1) INTO BASE REG S20201 07190020
         IC    R9,IOBDADAD+7                                            07200000
         BCTR  R9,R0                                                    07220000
         STC   R9,IOBDADAD+7            REDUCE R BY 1                   07240000
         L     R12,DCBWKPT2                                             07260000
         USING IHADCW,R12                                        S20201 07270020
         TM    IOBCSW+4,X'01'                                           07280000
         BO    APPU1G4                  BRANCH IF EOF                   07300000
         NI    DCWWKNI,X'F7'            SET EOF INDICATOR OFF           07320000
         BAL   R11,APPURTN                                              07340000
         L     R11,IOBECBAD                                             07360000
APPU1G2  SR    R12,R9                   REDUCE BY 24                    07380000
         CLR   R12,R13                  IF GONE PAST CG4                07400000
         BL    APPU1J2                  BRANCH OUT                      07420000
         OI    12(R12),X'40'            OTHERWISE SET COMMAND CHNG ON   07440000
         B     APPU1G2                  AND LOOP                        07460000
APPU1J2  CLC   CB10+7(7),DCBLPDA        BRANCH IF SEEK-SRCH MBBCCHH     07480000
         BNE   APPU1K2                  NOT EQUAL TO LPDA               07500000
         L     R12,DCBWKPT2                                             07520000
         USING IHADCW,R12                                        S20201 07530020
         CLC   DCWHIRPS(1),DCBLPDA+7    BRANCH IF SEEK-SRCH R           07540000
         BNE   APPU1K2                  NOT EQUAL TO LPDA               07560000
APPU1J3  TM    DCBST,X'02'              IS LAST BLOCK FULL              07580000
         BO    APPU1K2                  BRANCH IF YES                   07600000
         L     R12,DCBNREC              ADD 1 TO NUMBER OF PRIME DATA   07620000
         LA    R12,1(0,R12)              RECORDS - A LOGICAL RECORD     07640000
         ST    R12,DCBNREC               WILL REPLACE A PADDING RECORD. 07660000
         L     R12,CG2+FOUR                                      S20201 07662020
         L     R12,8(R0,R12)                                      7S083 07664000
         AH    R12,DCBBLKSI             GO TO ORIGINAL LAST RECORD7S083 07666000
         BAL   R13,APPPAD10             WAS IT REALLY PADDING     7S083 07668000
         B     APPU1J4                  YES--STATUS OK            7S083 07670000
         OI    DCBST,X'02'              NO--LAST BLOCK WAS FULL   7S083 07672000
         B     APPU1K2                  REJOIN MAINLINE CODE      7S083 07674000
APPU1J4  L     R12,CG2+FOUR             WR KEY ADDR AT CG2       S20201 07684020
         L     R12,8(R0,R12)            POINT TO LAST BLOCK             07700000
APPU1J5  STH   R12,IOBFCHAD+2                                           07720000
         SRL   R12,16                                                   07740000
         STC   R12,IOBFCHAD+1           STORE LAST BLOCK ADDRESS        07760000
         L     R12,IOBFCHAD             RESTORE                         07780000
         BAL   R13,APPPAD10             IS IT PADDING                   07800000
         B     APPU1H5                  SUB-ROUTINE SAYS YES            07820000
         L     R12,IOBFCHAD             LAST LOGICAL RCD CHECKED        07840000
         AH    R12,DCBLRECL             TRY THE NEXT                    07860000
         B     APPU1J5                                                  07880000
APPU1H5  EQU   *                                                 A27341 07900019
         L     R12,IOBFCHAD             POINTER TO FIRST PAD            07920000
         SH    R12,DCBLRECL             POINTER TO LAST NON-PAD         07940000
APPU1H6  L     R13,CG2+FOUR             LAST WR KEY ADDR         S20201 07950020
         AH    R12,DCBRKP               POINTER TO ITS KEY              07960000
         MVC   CG2+FIVE(THREE),ONE(R13) SAVE A(ORIGINAL KEY)     S20201 07980020
         STH   R12,2(R0,R13)                                            08000000
         SRL   R12,16                                                   08020000
         STC   R12,1(R0,R13)            PLACE CORRECT KEY ADDRESS       08040000
         OI    CG2+FOUR,KADDRCHG        KEY ADDR CHANGE IND ON   S20201 08050020
         USING IHADEB,R3                                         S20201 08060020
APPU1K2  ST    R3,IOBSTART-1           CP13B TO IOB                     08080000
         L     R3,RQEDEB                RESTORE DEB POINTER      Y02072 08100002
         B     APPJAB2                 SET UP CP 123W             17332 08105018
         USING IHADCW,R12                                        S20201 08107020
APPU1K3  TM    DCWWKNI,X'08'           DID CP13A END WITH AN EOF  17332 08110018
         BO    APPU2H2                 IF YES-BRANCH              M3216 08112018
         L     R13,CF2+4               TEST FOR KEY CHANGE        M3216 08114018
         USING CP13B,R13                ESTABLISH ADDRESSABILITY S20201 08115020
         TM    CG2+FOUR,KADDRCHG        DID IT CHANGE            S20201 08116020
         BO    APPU2H2               IF YES-BRANCH                M3216 08118018
         OI    CH8E+4,X'02'                                       M3216 08120018
         TM    DCWWKNI,X'10'      WAS CP13A USED FOR ADD TO END   17332 08125018
         BZ    APPU2F3            IF NO-BRANCH                    17332 08130018
APPU2H2  NI    CH8E+4,X'FD'            RESET BUMP TO OVFL FLAG    17332 08135018
         OI    IOBFLAG1,X'C0'           DATA AND COMMAND CHAINING       08140000
         MVI   IOBAPP,X'15'             SET APPENDAGE CODE TO 21        08160000
         B     APPRVXCP                 EXCP RETURN TO IOS              08180000
APPU2F3  EQU   *                                                  12999 08180818
         TM    DCBOPTCD,X'02'           OTHERWISE BRANCH IF DELETE      08181618
         BZ    APPU2J3                  OPTION NOT TAKEN                08182418
         L     R13,IOBFCHAD             IS LFTOVR RCD MRKD FOR DELETION 08183218
         L     R12,16(R0,R13)                                           08184018
         AH    R12,22(R0,R13)                                           08184818
         CLI   0(R12),X'FF'                                             08185618
         BNE   APPU2J3                  BRANCH IF NOT DELETED     12999 08186418
         IC    R9,IOBDADAD+6            SAVE H                    12999 08187218
         NC    IOBDADAD+6(1),DCBFIRSH+3  LEAVE ONLY TRACK VALUE         08188018
         CLC   IOBDADAD+6(1),DCBLDT+1                                   08188818
         STC   R9,IOBDADAD+6                                            08189618
         BE    APPD2G31                 BRANCH--LAST TRACK OF CYL 12999 08190418
         CLC   DCBLPDA(7),IOBDADAD                                      08191218
         BNE   APPU2H2                  NO--DON'T BUMP            12999 08192018
APPD2G31 EQU   *                                                  12999 08192818
         TM    CB11+7,X'10'             CURR IX ENTRY OFLOW       12999 08193618
         BZ    APPD2G33                 NO, BRANCH--NEXT INDEX    12999 08194418
*                                       ENTRY MUST BE OVERFLOW    12999 08195218
         TM    CB11+7,X'08'             CHAINING PRESENT          12999 08196018
         BZ    APPU2J3                  NO--BUMP DELETED REC      12999 08196818
         B     APPU2H2                  YES--DON'T BUMP           12999 08197618
APPD2G33 TM    CB26,X'08'               CHECK FOR CHAINING        12999 08198418
         BO    APPU2H2                  CHAIN--DON'T BUMP MORE    12999 08199218
*                                                                 12999 08200018
APPU2J3  EQU   *                                                 A37184 08200121
         L     R13,DECBAREA                                      A37184 08200221
         LA    R13,16(R0,R13)           RCV ADDR EQ AREA PLUS 16 A37184 08200321
*                                                                       08200502
         LR    R12,R4                   SAVE DCB ADDRESS         Y02072 08204002
         LR    R3,R14                   SAVE REG FOR IOS RETURN  Y02072 08204202
         L     R4,RQEDEB                ADDR OF CURRENT DEB      Y02072 08204402
         L     R4,0(R4)                 ADDR OF CURRENT TCB      Y02072 08204602
         LR    R8,R15                   SAVE BASE ADDRESS        Y02072 08204702
         LR    R9,R1                    SAVE RQE ADDRESS         Y02072 08205502
         LR    R10,R2                   SAVE IOB ADDRESS         Y02072 08207502
         SR    R2,R2                    IND. NO RANGE TEST       Y02072 08207902
         LR    R1,R13                   ADDR TO BE VALIDATED     Y02072 08208002
         SPACE 2                                                        08208402
         MODESET KEYADDR=KEY0,WORKREG=15  SET PROTECTION KEY 0   Y02072 08208502
         SPACE 2                                                        08208602
         L     R15,CVTPTR               ADDR OF CVT              Y02072 08208802
         USING CVT,R15                  CVT ADDRESSABILITY       Y02072 08209602
         L     R15,CVT0VL00             ADDR OF VALIDATION RTN   Y02072 08210402
         DROP  R15                      END USING ON CVT         Y02072 08211202
         SPACE 1                                                        08211602
         BALR  R14,R15                  VALIDATE ADDR            Y02072 08212002
         SPACE 1                                                        08212402
         LR    R14,R3                   RESTORE IOS REG          Y02072 08212802
         LR    R4,R12                   RESTORE DCB ADDRESS      Y02072 08213602
         LR    R15,R8                   RESTORE BASE ADDRESS AND Y02072 08214002
         USING APP,R15                  MODULE ADDRESSABILITY    Y02072 08214102
         LR    R1,R9                    RESTORE RQE ADDRESS      Y02072 08214202
         LR    R2,R10                   RESTORE IOB ADDRESS      Y02072 08214302
         SPACE 2                                                        08214402
         MODESET  KEYADDR=RQEPRT,WORKREG=10  SET USER'S KEY      Y02072 08215602
         SPACE 2                                                        08216002
         BZ    OKAREA                   B IF VALID TO CONTINUE   A37184 08217102
         OI    DECBEXC1,X'10'           SET INVALID REQUEST      A37184 08218402
         B     APPN3B4                  BR TO SCHED ASYNC        A37184 08222302
OKAREA   EQU   *                                                 A37184 08223602
         L     R13,IOBFCHAD             LAST WCKD                A37184 08224902
         L     R12,16(R0,R13)           LAST DATA                M0060  08226202
         AH    R12,DCBBLKSI             SEND ADDR EQ LAST DATA + A37184 08227502
*                                       AL                       A37184 08228802
         L     R13,DECBAREA                                      M0060  08230102
         LA    R13,16(R0,R13)           RCV ADDR EQ AREA + 16    M0060  08231402
         BAL   R3,APPMOV10              MOVE LEFT-OVER RCD              08232702
         SH    R12,DCBLRECL             RESTORE SEND ADDRESS            08234002
         AH    R12,DCBRKP               POINT TO LEFT-OVER KEY          08235302
         L     R13,DECBKEY              POINT TO I                      08236602
         SR    R9,R9                                             A37184 08237902
         IC    R9,DCBKEYLE                                              08239202
         BCTR  R9,R0                    MOVE KEYLENGTH BYTES            08240502
         EX    R9,APPU2J3A              MOVE LEFT-OVER KEY              08241802
         L     R3,RQEDEB                RESTORE DEB POINTER      Y02072 08243102
         LA    R3,0(R0,R3)                                              08244402
         L     R10,IOBCCWAD             RESTORE R10 USED ABOVE          08245702
         NI    IOBINDCT,X'DF'           POINT TO AREA + I FOR OFLO RCD  08247002
         L     R13,IOBFCHAD             PUT ADDR OF KEY OF LAST         08248302
         MVC   CH7+1(3),9(R13)          BLOCK WRITTEN IN CH7            08249602
         MVI   IOBASYN,X'09'            SET ASYNCH CODE TO 9            08250902
         B     APPN3B5                  SCHEDULE ASYNCH ROUTINE         08252202
APPU2F4  L     R12,CF2+4               KEY ADDR CHANGE            17332 08253502
         BO    APPU2H2                 IF YES-BRANCH              17332 08254802
APPU1C1  TM    DCBOPTCD,X'02'          WAS DELETE OPTION TAKEN    17332 08256102
         BZ    APPU1A3                  NO  BRANCH TO DUP. RCD EXIT     08257402
         SH    R12,DCBRKP               POINT TO LOGICAL RCD BYTE 1     08258702
         CLI   0(R12),X'FF'     WAS IT DELETED                     7851 08260000
         BNE   APPU1A3       NO BRNCH TO DUP REC EXIT              7851 08280000
         L     R12,DECBAREA             YES POINT TO INSERT RCD         08300000
         LA    R12,16(R0,R12)                                           08320000
         BAL   R3,APPMOV10              MOVE NEW RCD INTO BLOCK         08340000
APPU1F1  L     R10,DCBWKPT3             RESTORE CP8 POINTER             08360000
         L     R12,CF3                  Z+RL                            08380000
         LA    R12,0(R0,R12)                                            08400000
         AH    R12,DCBBLKSI             Z+RL+AL                         08420000
         SH    R12,DCBLRECL             Z+AL                            08440000
         CLR   R12,R13                  DOES LST RCD IN BLK EQ RCV ADDR 08460000
         BE    APPU1G1                  YES - BRANCH                    08480000
         LR    R12,R13                                             7851 08500000
         AH    R12,DCBLRECL     RECREATE SEND POINTER              7851 08520000
         BAL   R3,APPMOV10              MOVE                            08540000
         B     APPU1F1                  LOOP                            08560000
APPU1G1  L     R10,DCBWKPT3             RESTORE CP8 POINTER             08580000
         L     R3,RQEDEB                RESTORE DEB POINTER      Y02072 08590002
         LA    R13,CL5                                                  08640000
         ST    R13,IOBSTART-1          CP13C  START                     08660000
         NI    IOBFLAG1,X'7F'           DATA CHAINING OFF               08680000
         OI    IOBFLAG1,X'40'           COMMAND CHAINING ON             08700000
         MVI   IOBAPP,X'18'             SET APPENDAGE CODE TO 24        08720000
         B     APPRVXCP                 EXCP RETURN TO IOS              08740000
APPU1A3  L     R10,DCBWKPT3             RESTORE CP8 POINTER             08760000
         L     R3,RQEDEB                RESTORE DEB POINTER      Y02072 08770002
         OI    DECBEXC1,X'01'           DUPLICATE RECORD                08820000
         MVI   IOBASYN,X'08'            SET ASYNCHRONOUS CODE TO 8      08840000
         B     APPN3B5                  SCHEDULE ASYNCHRONOUS ROUTINE   08860000
APPU1G4  OI    DCWWKNI,X'08'            SET EOF INDICATOR ON            08880000
         TM    DCBST,X'02'              IS LAST BLOCK FULL              08900000
         BO    APPU1F5                  YES BRANCH                      08920000
         L     R3,CF2+4                                                 08940000
         DROP  R13                                               S20201 08950020
         USING CP13B,R3                                          S20201 08960020
         LA    R3,CG1                   CG1 IN REG 3             S20201 08970020
         LA    R13,CF4                                                  08980000
         BAL   R11,APPURTN+4                                            09000000
         L     R11,IOBECBAD                                             09020000
APPU1E4  SR    R12,R9                   REDUCE BY 24                    09040000
         CLR   R12,R13                  IF GONE PAST CG4                09060000
         BL    APPU1E3                  BRANCH OUT                      09080000
         OI    12(R12),X'40'            OTHERWISE SET COMMAND CHNG ON   09100000
         B     APPU1E4                  AND LOOP                        09120000
APPURTN  LA    R13,CF2                                                  09140000
         L     R12,IOBCSW                                               09160000
         LA    R12,0(R12)                                               09180000
         SR    R12,R13                 16 TIMES NO. OF DATA RDS-1       09200000
         LR    R13,R12                                                  09220000
         SRL   R13,1                   NOW 8 TIMES NO OF RDS-1          09240000
         AR    R12,R13                 24 TIMES NO OF DATA RDS-1        09260000
         LA    R13,CG3                                           S20201 09280020
         AR    R12,R3                  ADDR OF CC SW-8                  09300000
         NI    12(R12),X'BF'           CC BIT OFF                       09320000
         ST    R12,CG2+FOUR             POINT TO LAST WRITE KEY  S20201 09330020
         LA    R12,16(R12)        ADDR OF CCW AFTER CP13B         17332 09341018
APPU1GA  ST    R12,CH10+4              LAST CCW ADDR IN CP13B     17332 09342018
         LA    R9,24                                              17332 09343018
         SR    R12,R9              LINK CP13B TO CP123W           17332 09344018
         ST    R12,IOBFCHAD            CKD IN CP13A               17332 09345018
         CLC   CB2+5(3),CH10+5    LAST CCW 13B EQ 1ST CCW CP123W  17332 09346018
         BE    APPU1G6                                            17332 09347018
APPU1G5  MVC   25(3,R12),CB2+5         SET CMD TO TIC TO CP123W   17332 09348018
         MVI   24(R12),X'08'                                      17332 09349018
APPU1G6  OI    20(R12),X'40'           SET CMD CHAIN BIT  ON      17332 09350018
         LA    R12,8(R12)                                         17332 09351018
         BR    R11                                                      09380000
APPU1E3  L     R12,CG2+FOUR             POINT TO LAST WRITE DATA S20201 09400020
         L     R12,8(R0,R12)                                            09420000
         LA    R12,0(R0,R12)                                            09440000
         AH    R12,DCBBLKSI             ADD AL                          09460000
         SH    R12,DCBLRECL             SUB RL                          09480000
         BAL   R13,APPPAD10             IS IT PADDING                   09500000
         B     APPU1J4                  YES BRANCH                      09520000
         OI    DCBST,X'02'              NO  SET LAST BLOCK FULL         09540000
         B     APPU1K2                  BRANCH TO SET UP CP13B          09560000
APPU1F5  L     R3,CF2+4                                                 09580000
         LA    R3,CG1                   CG1 OF CP13B,HI BYTE=0   S20201 09590020
         DROP  R3                                                S20201 09600020
         USING IHADEB,R3                                         S20201 09610020
         BAL   R11,APPURTN                                              09620000
         L     R11,IOBECBAD                                             09640000
APPU1E5  SR    R12,R9                   REDUCE BY 24                    09660000
         CLR   R12,R13                  IF GONE PAST CG4                09680000
         BL    APPU1D5                  BRANCH OUT                      09700000
         OI    12(R12),X'40'            OTHERWISE SET COMMAND CHNG ON   09720000
         B     APPU1E5                  AND LOOP                        09740000
APPU1D5  L     R12,12(R0,R3)            POINT TO LAST WR DATA           09760000
         LA    R9,8(R0,R0)                                              09780000
         SR    R12,R9                   POINT TO CCW LAST WR CT         09800000
         L     R12,0(R0,R12)            POINT TO COUNT                  09820000
         MVC   5(1,R12),DCBKEYLE        RESET RECORD KEY &DATA          09840000
         MVC   6(2,R12),DCBBLKSI        LENGTHS AFTER EOF               09860000
         L     R12,12(R0,R3)            RESTORE TO LAST WRITE DATA      09880000
         L     R12,8(R0,R12)                                            09900000
         LA    R12,0(R0,R12)                                            09920000
         LH    R13,DCBBLKSI             MOVE (M-1)LRECL BYTES           09960000
         SH    R13,DCBLRECL                                             09980000
         BZ    APPU1H6                  NO PADDING (1 REC/BLOCK)  12244 09990016
         AH    R12,DCBLRECL             START PADDING AT +LRECL  A27341 09995019
APPU1D52 MVI   0(R12),X'FF'                                             10000000
         LA    R12,1(R0,R12)            ADD 1                           10020000
         BCT   R13,APPU1D52                                             10040000
         NI    DCBST,X'FD'              SET LAST BLOCK NOT FULL         10060000
         B     APPU1J4                  BRANCH                          10080000
         EJECT                                                          10100000
*              TEST FOR PADDING SUBROUTINE                              10120000
*                                                                       10130002
* ENTRY  LA    12,FIRSTPOS    FIRSTPOS = LOGICAL RECORD FIRST BYTE      10140000
*        BAL   13,APPPAD10                                              10160000
*                                                                       10170002
* DESTROYS     REGISTERS 9 (ONE BYTE), 12, 13 DESTRUCTIVELY             10180000
*              REGISTER 11, BUT RESTORES IT TO IOBECBAD                 10200000
*                                                                       10210002
* RETURNS      TO BAL INSTRUCTION PLUS FOUR BYTES IF PADDING            10220000
*              TO BAL INSTRUCTION PLUS EIGHT BYTES IF NO                10240000
*                                                                       10250002
APPPAD10 CLI   0(R12),X'FF'             TEST FIRST BYTE FOR ALL ONES    10260000
         BNE   APPPAD40                 NO - NOT A PADDING RECORD       10280000
         LA    R9,255(R0,R0)            PLACE 255 IN REG 9              10300000
         LH    R11,DCBLRECL             PLACE RECORD LENGTH IN IR 11    10320000
         BCTR  R11,R0                   LRECL MINUS ONE COMPARES REQD   10340000
APPPAD20 CLR   R11,R9                   LENGTH REMAINDER MORE THAN 255  10360000
         BNH   APPPAD30                 NO - NO MORE LOOPING            10380000
         CLC   0(255,R12),1(R12)        COMPARE 255 BYTES               10400000
         BNE   APPPAD40                 NOT PADDING                     10420000
         SR    R11,R9                   REDUCE LENGTH REMAINDER BY 255  10440000
         AR    R12,R9                   INCREASE INDEXING BY 255        10460000
         B     APPPAD20                 LOOP                            10480000
APPPAD30 BCTR  R11,R0                   ADJUST FOR MACHINE LANGUAGE     10500000
         EX    R11,APPPAD60             COMPARE 255 OR FEWER BYTES      10520000
         BE    APPPAD50                 PADDING                         10540000
APPPAD40 LA    R13,4(R0,R13)            MODIFY RETURN FOR NOT PADDING   10560000
APPPAD50 L     R11,IOBECBAD             RESTORE REGISTER 11             10580000
         BR    R13                      RETURN                          10600000
APPPAD60 CLC   0(0,R12),1(R12)          EXECUTED COMPARE                10620000
         EJECT                                                          10640000
*              GENERALIZED MOVE OF LOGICAL RECORD SUBROUTINE            10660000
*                                                                       10670002
* ENTRY  LA    12,SENDADDR    SENDADDR = SEND ADDRESS FIRST BYTE        10680000
*        LA    13,RCVADDR     RCVADDR = RECEIVE ADDRESS FIRST BYTE      10700000
*        BAL   3,APPMOV10                                               10720000
*                                                                       10730002
* DESTROYS     REGISTER 9 (ONE BYTE), REGISTERS 3, 10, 12, 13           10740000
*                                                                       10750002
* AT EXIT      REGISTER 3 CONTAINS RETURN ADDR                          10760000
*              REGISTER 9 CONTAINS X'FF' IN LOW-ORDER BYTE              10780000
*              REGISTER 10 CONTAINS A VARIABLE QUANTITY, LESS THAN 256  10800000
*              REGISTER 12 CONTAINS SENDADDR + DCBLRECL                 10820000
*              REGISTER 13 CONTAINS RCVADDR + DCBLRECL                  10840000
*                                                                       10850002
* RETURNS      TO BAL INSTRUCTION PLUS FOUR BYTES                       10860000
*                                                                       10870002
APPMOV10 LA    R9,255(R0,R0)            PLACE 255 IN REG 9              10880000
         LH    R10,DCBLRECL             PLACE RECORD LENGTH IN REG 10   10900000
         BCTR  R10,R0                   MOVE LRECL BYTES                10920000
APPMOV20 CLR   R10,R9                   COMPARE LENGTH REMAINDER TO 255 10940000
         BNH   APPMOV30                 BRANCH LAST TIME                10960000
         MVC   0(255,R13),0(R12)        MOVE 255 BYTES                  10980000
         SR    R10,R9                   REDUCE LENGTH REMAINDER BY 255  11000000
         AR    R12,R9                   INCREASE SEND INDEXING BY 255   11020000
         AR    R13,R9                   INCREASE RCV INDEXING BY 255    11040000
         B     APPMOV20                 LOOP                            11060000
APPMOV30 EX    R10,APPMOV40             MOVE 255 OR FEWER BYTES         11080000
         LA    R12,1(R12,R10)           UPDATE INDEXING BY 255 OR LESS  11100000
         LA    R13,1(R13,R10)           UPDATE INDEXING BY 255 OR LESS  11120000
         BR    R3                       RETURN FROM SUB-ROUTINE         11140000
APPMOV40 MVC   0(0,R13),0(R12)          LENGTH, RCV ADDR, SEND ADDR     11160000
         EJECT                                                          11180000
APPU2B2  B     APPJAC2                 CHANNEL CP 123W            17332 11280018
APPU2C2  L     R13,IOBFCHAD                                             11380000
         L     R12,CF2+4                HAS KEY ADDR IN CP13B CHANGED   11400000
         USING CP13B,R12                ESTABLISH ADDRESSABILITY S20201 11410020
         TM    CG2+FOUR,KADDRCHG        DID IT CHANGE            S20201 11420020
         BZ    APPU2B3                  NO. BRANCH FOR ADD TO END TEST  11440000
         MVC   NINE(THREE,R13),CG2+FIVE YES, RESTORE A(KEY)      S20201 11450020
         USING IHADCW,R12               ESTABLISH ADDRESSABILITY S20201 11460020
APPU2B3  L     R12,DCBWKPT2             WAS CP USED FOR ADD TO END      11480000
         USING IHADCW,R12                                        S20201 11490020
         TM    DCWWKNI,X'10'                                            11500000
         BO    APPU3E2                  YES. BRANCH TO ADD TO END CHART 11520000
         TM    DCWWKNI,X'08'            NO.  DID CP13A END WITH EOF     11540000
         BZ    APPU2E3                  NO.  BRANCH                     11560000
         L     R13,IOBFCHAD             YES. PUT LAST RCD CHHR IN IOB   11580000
         L     R13,0(R13)                                               11600000
         MVC   IOBDADAD+3(5),0(R13)                                     11620000
         OI    DCWWKNI,X'20'            SET SAME MODULE SW ON           11640000
         MVI   IOBAPP,X'09'             SET APPENDAGE CODE TO 9         11660000
         MVC   DCBLPDA+7(1),IOBDADAD+7  UPDATE R IN LPDA          13494 11680015
         L     R15,DEBEXPTR              GET ADDR OF DEB         S21045 11685021
*                                       EXTENSION PTR            S21045 11690021
         USING DEBEXT,R15                                        S21045 11695021
         L     R15,DEBWKPT5              ADDRESS OF PART 2 IN    S21045 11700021
*                                       R15                      S21045 11705021
         DROP  R15                                               S21045 11710021
         USING IHAPART2,R15                                             11720000
         B     APPN7B4                  BRANCH TO CP10A CHART           11740000
         USING APP,R15                                                  11760000
APPU2E3  L     R12,CF2+4                IS KEY ADDR CHANGE IND ON       11780000
         USING CP13B,R12                ESTABLISH ADDRESSABILITY S20201 11790020
         TM    CG2+FOUR,KADDRCHG        IS KEY ADDR CHANGE IND   S20201 11800020
*                                       ON                       S20201 11810020
         BZ    APPU2F5                                            17332 11820018
         L     R13,IOBFCHAD             YES. CALCULATE ADDRESS OF LAST  11840000
         L     R12,16(R0,R13)           WRITE KEY.                      11860000
         AH    R12,22(R0,R13)                                           11880000
         SH    R12,DCBLRECL                                             11900000
         BAL   R13,APPPAD10             TEST RECORD FOR PADDING         11920000
         B     APPN3B4                  YES. GO TO SCHEDULE COMPLETION  11940000
         OI    DCBST,X'03'              NO. SET LST BLCK, LST TRCK FULL 11960000
         B     APPN3B4                  GO TO SCHEDULE COMPLETION       11980000
APPU2F5  TM    CH8E+4,X'02'                                       17332 12040018
         BZ    APPT2J2                  IF NO-BRANCH              17332 12100018
         MVI   IOBAPP,X'04'             SET UP 2ND PART CP14      17332 12160018
         MVC   IOBSTART,CH21+4          TO UPDATE INDICES         17332 12220018
         MVC   IOBDADAD,CH14           RESTORE IOBSEEK            17332 12280018
         MVI   CH14,X'03'               CHANGE CH14               17332 12340018
         MVI   CH14+4,X'20'             TO ANOP                   17332 12400018
         MVI   CH14+7,X'01'                                       17332 12460018
         NI    CH8E+4,X'40'            RESET  FLAG                17332 12520018
         B     APPRVXCP                                           17332 12580018
APPT2J2  OI    IOBFLAG1,X'C0'                                     17332 12640018
         LA    R12,CK1                  START AT CK1                    12700000
         ST    R12,IOBSTART-1                                           12720000
         MVC   IOBDADAD+5(3),CB23       SET SEEK ADDRESS                12740000
         LA    R12,IOBDADAD+3           PUT IOB ADDRESS IN CK1 AND CK4  12760000
         ST    R12,CK1                                                  12780000
         MVI   CK1,X'31'                                                12800000
         MVC   CK4(4),CK1              MOVE OP CODE AND ID TO IOB       12820000
         L     R13,IOBFCHAD                                             12840000
         L     R13,8(R0,R13)                                            12860000
         ST    R13,CK6                  ADDRESS OF LAST KEY TO CK6      12880000
         MVI   CK6,X'0D'                                                12900000
         MVI   IOBAPP,X'11'             SET APPENDAGE CODE TO 16        12920000
         MVC   CK7A+1(3),CK1+1          PUT IOB ADDRESS IN CK7A         12940000
         MVI   IOBCOUNT,X'0A'           SET COUNTER TO 10               12960000
         B     APPRVXCP                 EXCP RETURN TO IOS              12980000
APPU2J3A MVC   0(0,R13),0(R12)     EXECUTED INSTRUCTION            7851 13000000
         EJECT                                                          13020000
*              CP13B WHEN USED FOR ADD-TO-END, CHART U3                 13040000
APPU3E2  L     R12,CF2+4                GET ADDR OF CP13B         10353 13060000
         USING CP13B,R12                ESTABLISH ADDRESSABILITY S20201 13066020
         TM    CG2+FOUR,KADDRCHG        BR IF KEY ADDR CHANGE    S20201 13072020
         BO    APPU3E3                  INDICATOR IS ON                 13100000
         OI    DCBST,X'02'              OTHERWISE, SET LST BLCK FULL    13120000
         L     R12,DCBWKPT2                                             13140000
         USING IHADCW,R12                                        S20201 13150020
         CLC   DCWHIRPS,DCBLPDA+7       IS LPDA THE SAME AS HIRPS       13160000
         BNE   APPU3G4                  NO.  BRANCH                     13180000
         OI    DCBST,X'01'              YES  SET LAST TRK FULL IND ON   13200000
         B     APPU3F3                                                  13220000
APPU3E3  CLC   DCWHIRPS,DCBLPDA+7                                       13240000
         BE    APPU3F3                  BRANCH IF LPDA EQUALS HIRPS     13260000
APPU3G4  MVI   IOBAPP,X'17'             SET APPENDAGE CODE TO 23        13280000
         L     R15,DEBEXPTR              GET ADDR OF DEB         S21045 13285021
*                                       EXTENSION PTR            S21045 13290021
         USING DEBEXT,R15                                        S21045 13295021
         L     R15,DEBWKPT5              ADDRESS OF PART 2 IN    S21045 13300021
*                                       R15                      S21045 13305021
         DROP  R15                                               S21045 13310021
         USING IHAPART2,R15                                             13320000
         B     APPN7A3                  BRANCH TO CP10A CHART           13340000
         USING APP,R15                                                  13360000
APPU3F3  L     R12,DCBNREC              ADD 1 TO NUMBER OF PRIME DATA   13380000
         LA    R12,1(0,R12)              RECORDS - A LOGICAL RECORD     13400000
         ST    R12,DCBNREC               WILL REPLACE A PADDING RECORD. 13420000
         OI    IOBFLAG1,X'C0'           SET FLAGS TO ALLOW CC AND DC    13440000
         LA    R12,CK1                  START AT CK1                    13460000
         ST    R12,IOBSTART-1                                           13480000
         MVC   IOBDADAD(3),DCBLPDA      SET IOB SEEK                    13500000
         MVC   IOBDADAD+3(5),DCBLETI                                    13520000
         LA    R12,IOBDADAD+3           PUT IOB ADDRESS IN CK1 AND CK4  13540000
         ST    R12,CK1                                                  13560000
         MVI   CK1,X'31'                                                13580000
         MVC   CK4(4),CK1              MOVE OP CODE AND ID TO IOB       13600000
         MVC   CK6+1(3),DECBKEY+1                                       13620000
         MVI   IOBAPP,X'12'             SET APPENDAGE CODE TO 18        13640000
         MVC   CK7A+1(3),CK1+1          PUT IOB ADDRESS IN CK7A         13660000
         MVI   IOBCOUNT,X'0A'           SET COUNTER TO 10               13680000
         B     APPRVXCP                 EXCP RETURN TO IOS              13700000
         EJECT                                                          13720000
*              CP13A WHEN USED FOR ADD-TO-END, CHART U3                 13740000
APPU3B2  L     R13,CF3                  Z PLUS RL INTO R13              13760000
         LA    R13,0(R0,R13)                                            13780000
         SH    R13,DCBLRECL             POINT TO RCV ADDRESS, Z         13800000
APPU3B22 L     R10,DECBKEY              POINT TO KEY OF INSERT          13820000
         LR    R12,R13                                                  13840000
         AH    R12,DCBLRECL                                             13860000
         AH    R12,DCBRKP               POINT TO SEND AREA'S KEY        13880000
         IC    R9,DCBKEYLE                                              13900000
         BCTR  R9,R0                    COMPARE KEYLENGTH BYTES         13920000
         EX    R9,APPU1C32              COMPARE INSERT TO SEND          13940000
         BNH   APPU3B3                  INSERT                          13960000
         SH    R12,DCBRKP               ADJUST SEND ADDRESS             13980000
         BAL   R3,APPMOV10              MOVE FORWARD ONE RECORD         14000000
*                                                                       14000402
*                       GIVE UNREACHABLE BLOCK CONDITION IF NO KEY      14001018
*                       IN FIRST BLOCK READ IS HIGHER THAN KEY          14002018
*                       TO BE ADDED                                     14003018
*                                                                       14003402
         L     R10,IOBCCWAD             GET CP ADDRESS AGAIN      24080 14004018
         L     R3,CF3                   ADDRESS OF BLOCK READ     24080 14005018
         LA    R3,0(0,R3)                                         24080 14006018
         AH    R3,DCBBLKSI              ADDRESS OF END OF BLOCK   24080 14007018
         CR    R12,R3                   NEXT LRECL TO BE MOVED VS 24080 14008018
*                                       END OF BLOCK                    14009018
         BNL   APPN3B1                  BRANCH IF BEYOND END     A29928 14014019
         B     APPU3B22                 AND LOOP                        14020000
APPU3B3  L     R12,DECBAREA                                             14040000
         LA    R12,16(R0,R12)           MOVE AREA PLUS 16               14060000
         BAL   R3,APPMOV10              INSERT NEW RECORD               14080000
         IC    R9,IOBDADAD+7                                            14100000
         BCTR  R9,R0                                                    14120000
         STC   R9,IOBDADAD+7            REDUCE R BY 1                   14140000
         L     R10,DCBWKPT3             CHANNEL PROGRAM POINTER         14160000
         L     R3,CF2+4                                                 14180000
         USING CP13B,R3                                          S20201 14190020
         LA    R3,CG1                   CG1 WITH HI BYTE = 0     S20201 14200020
         LA    R12,CG4                                           S20201 14210020
         NI    CG5+FOUR,X'FF'-CC        CC OFF AT CG5            S20201 14220020
         ST    R12,CG2+FOUR             SAVE A(LAST KEY) AT CG2  S20201 14230020
         LA    R12,CG5+EIGHT            A(1ST CG5+8)             S20201 14240020
         BAL   R11,APPU1GA             CHAIN CP13B TO CP123W      17332 14272018
         L     R12,CG2+FOUR             RESTORE A(LAST KEY)      S20201 14274020
         USING IHADEB,R3                                         S20201 14277020
         L     R12,8(R0,R12)            POINT TO LAST WRITE DATA        14280000
         AH    R12,DCBBLKSI             ADD AL                          14300000
         SH    R12,DCBLRECL             SUBTRACT RL                     14320000
         BAL   R13,APPPAD10             IS RECORD PADDING               14340000
         B     APPU1J4                  YES. CONTINUE PADDING CHECK     14360000
         B     APPU1K2                  NO.  GO TO SET UP CP13B START   14380000
         EJECT                                                          14400000
*              ABNORMAL END CP13A,  APPENDAGE CODE 20,         CHART U4 14420000
APPU4B2  TM    IOBECBAD,PERRMASK        WAS ABEND DUE TO PERM ERROR     14440000
         BC    PERRNO,APPRVNOR          NO.  NORMAL RETURN TO IOS       14460000
         TM    IOBSENSE,X'08'           CONTINUE IF CAUSE DATA CHECK    14480000
         BZ    APPN3B3                  OTHERWISE, RECORD IS UNRCHBLE   14500000
         LA    R13,CF2+8                                                14520000
         CLR   R12,R13                                                  14540000
         BNH   APPN3B3                  NO.  RECORD UNRCHBLE, BRANCH    14560000
APPU4E2  OI    DECBEXC1,X'08'           YES. UNCORRECTABLE I/O ERROR    14580000
         B     APPN3B4                                                  14600000
         EJECT                                                          14620000
*              ABNORMAL END CP13B,  APPENDAGE CODE 21,         CHART U4 14640000
APPU4G2  TM    IOBECBAD,PERRMASK        WAS ABEND DUE TO PERM ERROR     14660000
         BC    PERRNO,APPRVNOR          NO.  NORMAL RETURN TO IOS       14680000
         L     R13,CF2+4                CG1 POINTER                     14700000
         USING CP13B,R13                                         S20201 14710020
         TM    CG2+FOUR,KADDRCHG        WAS KEY ADDR CHANGED     S20201 14720020
         BZ    APPU4J1+6                NO.  BRANCH                     14740000
         LA    R12,CG4                  CG4 POINTER              S20201 14760020
APPU4H1  TM    12(R12),X'40'                                            14780013
         BZ    APPU4J1                                                  14800013
         LA    R12,24(R0,R12)           YES. TRY NEXT SEQUENCE          14820000
         B     APPU4H1                  LOOP                            14840000
APPU4J1  MVC   ONE(THREE,R12),CG2+FIVE  RESTORE KEY ADDRESS      S20201 14860020
         TM    IOBSENSE,X'08'           WAS CAUSE DATA CHECK            14880000
         BZ    APPN3B3                  NO.  BRANCH UNREACHABLE         14900000
         L     R12,IOBCSW               DID CP STOP AT WR CCW           14920000
         LA    R13,CG4                  CG4 ADDR                 S20201 14940020
         LA    R12,0(R0,R12)                                            14980000
         CLR   R12,R13                                                  15000000
         BL    APPN3B3                  BRANCH IF NOT TO UNRCHBLE       15020000
         B     APPU4E2                                                  15040000
         EJECT                                                          15060000
*              CHANNEL  END CP13CW, APPENDAGE CODE 24,         CHART U6 15080000
APPU6B2  LA    R13,CL7C+8              DID CP STOP AT CL7C              15100000
         CLR   R12,R13                                                  15120000
         BNE   APPN3B3                  NO.  BRANCH UNREACHABLE         15140000
         B     APPN3B4                  YES. SCHEDULE COMPLETION        15160000
         EJECT                                                          15180000
*              ABNORMAL END CP13CW, APPENDAGE CODE 24,         CHART JC 15200000
APPJCB2  EQU   *                                                        15210013
         TM    IOBECBAD,PERRMASK        WAS ABEND DUE TO PERM ERROR     15220013
         BC    PERRNO,APPRVNOR          NO-NORMAL RETURN TO IOS         15230013
         TM    IOBSENSE,X'08'           WAS ABEND DUE TO DATA CHECK     15240013
         BZ    APPN3B3                  NO- RECORD UNREACHABLE          15250013
         LA    R13,CL7C+8               DID CHAN PROG STOP AT CL7C      15260000
         CLR   R12,R13                                                  15280000
         BE    APPJCE3                  YES- E3 I/O ERROR               15380013
         LA    R13,CL7+8                DID CP STOP AT CL7              15540000
         CLR   R12,R13                                                  15560000
         BNE   APPN3B3                  NO.  BRANCH UNREACHABLE         15580000
APPJCE3  OI    DECBEXC1,X'08'           YES. UNCORRECTABLE I/O ERROR    15600000
         B     APPN3B4                  SCHEDULE PROCESSING COMPLETION  15620000
         EJECT                                                          15640000
*              SET UP CP123W AFTER CP13B (CHART JA)                     15660000
APPJAB2  L     R13,CH10+4              ADDR OF LAST CP13B WRITE   17332 15730018
         LA    R13,0(R0,R13)                                            15800000
         L     R12,CF2+4                POINTER TO CG1                  15820000
         DROP  R13                                               S20201 15826020
         USING CP13B,R12                                         S20201 15832020
         LA    R12,CG3                                           S20201 15842020
         SR    R13,R12                  NO. OF WRITES TIMES 24          15860000
         SR    R9,R9                                                    15880000
APPJAB32 LA    R9,1(R0,R9)              COUNT 1 FOR EVERY SUBTRACT OF 3 15900000
         BCTR  R13,R0                   EVENTUALLY NO. OF WRITES X 8    15920000
         BCTR  R13,R0                                                   15940000
         BCTR  R13,R0                                                   15960000
         LTR   R13,R13                                                  15980000
         BNE   APPJAB32                 LOOP INCOMPLETE                 16000000
         L     R12,CB2+4                POINTER TO CEA                  16020000
         USING CP123,R12                                         S20201 16030020
         LA    R12,CEB                  POINT TO CEB             S20201 16040020
         LA    R13,0(R9,R12)            SET REG 13 TO 'SET OFF CC' ADDR 16060000
         NI    4(R13),X'BF'             SET OFF CC FLAG                 16080000
         LA    R9,8(R0,R0)              PUT 8 IN REG 9                  16100000
APPJAB34 SR    R13,R9                   REDUCE REG 13                   16120000
         CLR   R13,R12                  IS LOOP COMPLETE                16140000
         BE    APPJAB4                  YES - EXECUTE CP123W            16160000
         OI    4(R13),X'40'             SET ON  CC FLAG                 16180000
         B     APPJAB34                 LOOP                            16200000
APPJAB4  L     R12,CB2+4                                          17332 16230018
         LA    R13,IOBDADAD+3          ADDR OF IOB INTO R13             16260000
         ST    R13,CEA                  STORE SCH ARG IN CP123   S20201 16270020
         MVI   CEA,SIDEQ                RESTORE COMMAND CODE     S20201 16280020
         USING IHADCW,R12                                        S20201 16290020
         L     R12,DCBWKPT2            RESTORE WORK AREA REG      17332 16310018
         B     APPU1K3                                            17332 16320018
         EJECT                                                          16340000
*              CHANNEL  END CP123W, APPENDAGE CODE 22,         CHART JA 16360000
APPJAC2  EQU   *                        *                               16370001
*                                                                       16370702
         LA    R9,EIGHT                 CCW LENGTH                      16371401
         SR    R12,R9                   MOVE BACK TO LAST CCW           16372101
         TM    FIVE(R12),CC             WAS IT CHAINED                  16372801
         BZ    APPJAC3                  NO, CP UNCHANGED                16373501
         NI    FIVE(R12),CCOFF          RESET INDICATOR                 16374201
         OI    FOUR(R12),CC             RESET CC                        16374901
         MVC   IOBSTART(THREE),CB2+FIVE SETUP TO EXCP CP123             16375601
         B     APPRVXCP                 EXCP CP123                      16376301
APPJAC3  EQU   *                        *                               16377001
         AR    R12,R9                   ADD BACK CCW LENGTH             16377701
*                                                                       16378402
         BAL   R11,APPRCP               RESTORE CP13B                   16379101
         L     R11,IOBECBAD                                       17332 16380018
         SR    R12,R9                   POINT TO LAST OP CODE           16400000
         CLI   0(R12),X'1E'             DID CHAN PROG STOP AT A RD CKD  16420000
         BNE   APPN3B3                  NO - RECORD IS UNREACHABLE      16440000
         TM    4(R12),X'40'             WAS CC FLAG OFF                 16460000
         BO    APPN3B3                 IF YES-BRANCH              17332 16470018
         B     APPU2C2                                            17332 16490018
APPRCP   EQU   *                                                  17332 16493018
         MVC   IOBCSW(4),CH10+4        SIM NON OCCUR OF CP123W    M3216 16494018
         L     R13,CH10+4                                         M3216 16495018
         LA    R9,24                                              M3216 16496018
         SR    R13,R9              SET IOBFCHAD TO                M3216 16497018
         ST    R13,IOBFCHAD       PTR TO LAST CKD                 M3216 16498018
         CLC   CH10+5(3),CB2+5                                    17332 16499018
         BE    APPJAB5                 IF EQUAL BRANCH            17332 16502018
         L     R9,0(R13)                                          17332 16514018
         LA    R9,8(R9)                                           17332 16517018
         ST    R9,24(R13)                                         17332 16520018
         MVI   24(R13),X'1D'           RESTORE WRITE CMD          17332 16523018
APPJAB5  LA    R9,8                                               17332 16526018
         BR    R11                                                17332 16529018
         EJECT                                                          16540000
*              ABNORMAL END CP123W, APPENDAGE CODE 22,         CHART JA 16560000
APPJAE2  EQU   *                                                        16570013
         TM    IOBECBAD,PERRMASK        WAS ABEND DUE TO PERM ERROR     16580013
         BC    PERRNO,APPRVNOR          NO-NORMAL RETURN TO IOS         16590013
         BAL   R11,APPRCP              RESTORE CP13B              17332 16593018
         L     R13,CF2+4          TEST FOR KEY CHANGE             M3216 16593318
         USING CP13B,R13                                         S20201 16593420
         TM    CG2+FOUR,KADDRCHG        DID KEY CHANGE           M5874  16593520
         BZ    APPJAH4            IF NO-BRANCH                    M3216 16593618
         L     R11,CH10+4         CHANGE KEY                      M3216 16593918
         LA    R9,24                                              M3216 16594218
         SR    R11,R9                                             M3216 16594518
         MVC   NINE(THREE,R11),CG2+FIVE MOVE OLD KEY ADDR IN     S20201 16594820
APPJAH4  EQU   *                                                  M3216 16595118
         L     R11,IOBECBAD                                       17332 16596018
         TM    IOBSENSE,X'08'           WAS ABEND DUE TO DATA CHECK     16600013
         BZ    APPN3B3                  NO-RECORD UNREACHABLE           16610013
         L     R13,CB2+4                POINTER TO CEA                  16620000
         USING CP123,R13                                         S20201 16630020
         LA    R13,CEB+ONE                                       S20201 16640020
         CLR   R12,R13                  DID CHAN PROG STOP AT A RD CCW  16660000
         BL    APPN3B3                                                  16760013
APPJAH3  OI    DECBEXC1,X'08'           UNCORRECTABLE I/O ERROR         16920000
         B     APPN3B4                  SCHEDULE PROCESSING COMPLETION  16940000
         EJECT                                                          16960000
*              CHANNEL  END CP15,   APPENDAGE CODE 14,         CHART M1 16980000
APPM1B2  LA    R13,CI4+8                DID CHAN PROG STOP AT CI4       17000000
         CLR   R12,R13                  BE MEANS YES, BNE MEANS NO      17020000
         BNE   APPM1B3                  NO - RECORD IS UNREACHABLE      17040000
*              SIMULATE CHART U5 SUBROUTINE                             17060000
         L     R12,DCBWKPT2                                             17080000
         USING IHADCW,R12                                        S20201 17090020
         OI    DCWWKNI,X'10'            SET ADD-TO-END INDICATOR ON     17100000
         CLI   DCBFIRSH+TWO,ONE         TEST FOR SHARED TRACK    A46955 17106021
         BNH   APPM1B20                 NO                       A46955 17112021
         CLC   DCBFIRSH(2),DCBLPDA+5    END OF SHARED TRACK        7851 17120000
         BE    APPM1B2A                                            7851 17140000
APPM1B20 EQU   *                        *                        A46955 17150021
         MVC   DCWHIRPS(1),DCBHIRPD                                7851 17160000
         B     APPM1B2B                                            7851 17180000
APPM1B2A MVC   DCWHIRPS(1),DCBHIRSH                                7851 17200000
APPM1B2B EQU   *                                                   7851 17220000
         TM    DCBST,X'02'              IS LAST BLOCK FULL              17240000
         BO    APPU5B3                  BO IF YES                       17260000
         OI    IOBFLAG1,X'40'           USE COMMAND CHAINING            17280000
         NI    IOBFLAG1,X'7F'           DONT USE DATA CHAINING          17300000
         LA    R12,CF1                  START AT CF1                    17320000
         ST    R12,IOBSTART-1                                           17340000
         MVC   IOBDADAD,DCBLPDA         SEEK TO LAST RECORD             17360000
         LA    R12,IOBDADAD+3           PUT IOB ADDRESS IN CL5 AND CG1  17380000
         STH   R12,CL5+2                                                17400000
         SRL   R12,16                                                   17420000
         STC   R12,CL5+1                                                17440000
         MVC   CL7A+1(3),CL5+1          PUT IOB ADDRESS IN CL7A         17460000
         L     R13,CF2+FOUR             POINT TO CG1             S20201 17470020
         USING CP13B,R13                                         S20201 17480020
         MVC   CG1+ONE(THREE),CL5+ONE   MOVE IOBSEEK TO CP13B    S20201 17500020
         MVI   CF3+4,X'00'                                              17520000
         L     R12,DCBMSWA                                              17540000
         MVC   0(5,R12),IOBDADAD+3                                      17560000
         MVC   5(1,R12),DCBKEYLE                                        17580000
         MVC   6(2,R12),DCBBLKSI        ASSEMBLE COUNT FIELD AT W       17600000
         MVI   IOBAPP,X'14'             SET APPENDAGE CODE TO 20        17620000
         B     APPRVXCP                                                 17640000
APPU5B3  TM    DCBST,X'01'              IS LAST TRACK FULL              17660000
         BO    APPM1C2                  BO IF YES, TO SET UP CP16       17680000
         L     R12,DECBAREA             NO - MOVE RECORD FROM           17700000
         LA    R12,16(R0,R12)           AREA+16 TO Z                    17720000
         L     R13,CF3                                                  17740000
         LA    R13,0(R0,R13)                                            17760000
         SH    R13,DCBLRECL                                             17780000
*              SIMULATE GENERALIZED MOVE SUBROUTINE                     17800000
         LA    R9,255(R0,R0)            PLACE 255 IN IR 9               17820000
         LH    R10,DCBLRECL             RCD LGTH IN IR 10               17840000
         BCTR  R10,R0                   LRECL MOVES REQD                17860000
APPU5B3B CLR   R10,R9                   LGTH REMAINDER MORE THAN 255    17880000
         BNH   APPU5B3C                 BRANCH LAST TIME                17900000
         MVC   0(255,R13),0(R12)        MOVE 255 CHS                    17920000
         SR    R10,R9                   REDUCE LGTH REMAINDER BY 255    17940000
         AR    R12,R9                   INCREASE INDEXING BY 255        17960000
         AR    R13,R9                                                   17980000
         B     APPU5B3B                 LOOP                            18000000
APPU5B3D MVC   0(0,R13),0(R12)          EXECUTED MOVE                   18020000
APPU5B3C EX    R10,APPU5B3D             MOVE 255 OR FEWER BYTES         18040000
         L     R10,IOBCCWAD             RESTORE REGISTER 10             18060000
         L     R12,CF3                  FORM PADDING RCDS AS FOLLOWS    18080000
         LA    R12,0(R0,R12)            Z+RL TO REG 12                  18100000
         LR    R13,R12                                                  18120000
         AH    R13,CF3+6                Z+RL+AL TO REG 13               18140000
         SH    R13,DCBLRECL             Z+AL TO REG 13                  18160000
         CLR   R12,R13                  IS PADDING NECESSARY      12244 18166016
         BE    APPU5C4B                 NO--BRANCH (1 REC/BLOCK)  12244 18172016
APPU5C4A MVI   0(R12),X'FF'             PAD                             18180000
         LA    R12,1(R0,R12)            INCREMENT                       18200000
         CLR   R12,R13                                                  18220000
         BL    APPU5C4A                 LOOP                            18240000
         NI    DCBST,X'FD'              LAST BLOCK NOT FULL       12244 18246016
APPU5C4B EQU   *                                                  12244 18252016
         MVI   IOBAPP,X'17'             SET APPENDAGE CODE TO 23        18260000
         MVC   IOBDADAD+3(5),DCBLPDA+3  SET UP IOB SEEK ADDR            18300000
         MVC   CB51(4),IOBDADAD+3       MOVE DCBLPDA CCHHR TO CB51      18320000
         IC    R12,IOBDADAD+7            THEN INCREASE CB51 R BY 1      18340000
         LA    R12,1(R0,R12)                                            18360000
         STC   R12,CB51+4                                               18380000
         OI    IOBFLAG1,X'C0'           USE DATA AND COMMAND CHAINING   18400000
         LA    R12,CB46                 START AT CB46                   18420000
         ST    R12,IOBSTART-1                                           18440000
         LA    R12,IOBDADAD+3           MOVE IOB ADDRESS TO CB46        18460000
         STH   R12,CB46+2                                               18480000
         SRL   R12,16                                                   18500000
         STC   R12,CB46+1                                               18520000
         MVC   CB49+1(3),DECBKEY+1      MOVE KEY  ADDRESS TO CB49       18540000
         L     R13,CF2+FOUR             POINT TO CG1             S20201 18560020
         MVC   CB50(FOUR),CG5           MOVE DATA ADDR TO CB50   S20201 18580020
         MVC   CB50A+1(3),CB46+1        MOVE IOB ADDRESS TO CB50A       18620000
         MVI   IOBCOUNT,X'0A'           SET COUNTER TO 10               18640000
         B     APPRVXCP                 EXCP RETURN TO IOS              18660000
APPM1C2  EQU   *                                                        18680000
         TM    CB26,X'08'               WAS ENTRY READ IN CB25 OFLO END 18700000
         BZ    APPM1D3                  YES  M1D3                       18720000
         MVC   IOBDADAD,CB25            MOVE CB25 MBBCCHHR TO IOB       18740000
         MVI   IOBAPP,X'0F'             SET APPENDAGE CODE TO 15        18760000
         NI    IOBFLAG1,X'7F'           DONT USE DATA CHAINING          18780000
         OI    IOBFLAG1,X'40'           USE COMMAND CHAINING            18800000
         LA    R12,CJ1                  START AT CJ1                    18820000
         ST    R12,IOBSTART-1                                           18840000
         LA    R12,IOBDADAD+3           MOVE IOB ADDRESS TO CJ1 AND CJ5 18860000
         ST    R12,CJ1                                                  18880000
         MVI   CJ1,SIDEQ                RESTORE COMMAND CODE     S20201 18900020
         MVC   CJ5+ONE(THREE),CJ1+ONE   MOVE IN ADDR OF SEEK     S20201 18910020
         MVC   CJ3+ONE(THREE),DECBKEY+ONE  MOVE IN ADDR OF KEY   S20201 18920020
         MVC   CJ7+ONE(THREE),DECBKEY+ONE  MOVE IN ADDR OF KEY   S20201 18940020
         LA    R12,0(R0,R0)             CMP TRK INDEX AND OFLO RCD MODL 19040000
         IC    R12,CB25                  ARE THEY THE SAME              19060000
         SLL   R12,4(R0)                                                19080000
         L     R12,DEBUCBAD(R12)        GET UCB ADDR FROM DEB    S20201 19100020
         LA    R12,0(R0,R12)                                            19120000
         CLR   R12,R7                                                   19140000
         BE    APPRVXCP                 YES - EXCP RETURN TO IOS        19160000
         MVI   IOBASYN,X'01'                                            19180000
         B     APPM1D4                  EXCP IN ASYNCHRONOUS ROUTINE    19200000
APPM1D3  MVI   IOBASYN,X'0A'            SET ASYNCHRONOUS CODE TO 10     19220000
APPM1D4  NI    IOBINDCT,X'DF'           INDICATE OFLO RECORD IN AREA    19240000
         B     APPM1B5                  SCHEDULE ASYNCHRONOUS ROUTINE   19260000
APPM1B3  OI    DECBEXC1,X'04'           RECORD IS UNREACHABLE           19280000
APPM1B4  MVI   IOBASYN,X'08'            SCHEDULE PROCESSING COMPLETION  19300000
APPM1B5  B     BYP(R14)                 SCHEDULE ASYNCH ROUTINE  Y02072 19320002
APPN3B21 LA    R13,APPN3B2                                              19400000
         BC    15,APPN3B22                                              19420000
APPM1B21 LA    R13,APPM1B2                                              19440000
APPN3B22 BR    R13                      NULL ROUTINE             Y02072 19460002
APPRVXCP SR    R12,R12                                                  19600000
         IC    R12,IOBDADAD                                             19620000
         SLL   R12,4                                                    19640000
         L     R3,RQEDEB                RESTORE DEB POINTER      Y02072 19670002
         LA    R12,DEBUCBAD(R12)        POINT TO CURRENT EXTENT  S20201 19680020
         MVC   IOBDADAD+1(2),4(R12)           MOVE IN BB                19700000
         LA    R14,EXCP(R14)            SETUP FOR EXCP IOS RETURN 15924 19705016
         XC    IOBFLAG2(3),IOBFLAG2     CLEAR FLAG2,SENSE BYTES   15924 19710016
         XC    IOBCSW(9),IOBCSW         CLEAR FLAG3,CSW,AND SIOCC 15924 19715016
         XC    IOBERRCT(2),IOBERRCT     CLEAR ERROR COUNT         15924 19720016
         NI    IOBFLAG1,X'C2'           RESET FLAG1               15924 19725016
APPRVNOR BR    R14                      RETURN TO IOS             15924 19730016
         EJECT                                                          19740000
*              ABNORMAL END CP15,   APPENDAGE CODE 14,         CHART M1 19760000
APPM1J2  TM    IOBECBAD,PERRMASK        WAS ABEND DUE TO PERM ERROR     19780000
         BC    PERRNO,APPRVNOR          NO   CONTINUE, NORMAL IOS       19800000
         B     APPM1B3                  YES  M1B3                       19820000
         SPACE 9                                                        19840002
*                             RETURN TO IOS VECTOR TABLE                19940000
IHAPART2 DS    0D                       PART 2 VECTOR TABLE             20060000
*        ROUTINE FOR          CODE      CEND COMPLETION OF              20080000
APPM67CE DS    CL6            7         CP1 OR CP2, WRITE KN            20100000
APPN7B2  DS    CL6            9,23      CP10AW                          20120000
APPN8A2  DS    CL6            10,11     CP10BW                          20140000
APPM4A2  DS    CL6            12        CP14W - SETUPS 1, 2, OR 5       20160000
APPM5A2  DS    CL6            13        CP14W - SET UPS 3, 4, OR 6      20180000
APPM2B2  DS    CL6            15        CP16 - SITUATION 2              20200000
APPM3B2  DS    CL6            16        CP16 - SITUATION 3              20220000
APPN9A2  DS    CL6            17,18,19  CP17W                           20240000
APPAFB   DS    CL6                                                17332 20250018
*        ROUTINE FOR          CODE     ABEND COMPLETION OF              20260000
APPM67AE DS    CL6            7         CP1 OR CP2, WRITE KN            20280000
APPJ3B2  DS    CL6            9,23      CP10AW                          20300000
APPJ4B2  DS    CL6            10,11     CP10BW                          20320000
APPJ5B2  DS    CL6            12        CP14W -SETUPS 1, 2, OR 5        20340000
APPJ6B2  DS    CL6            13        CP14W -SETUPS 3, 4, OR 6        20360000
APPM2H2  DS    CL6            15,16     CP16                            20380000
APPJ7B2  DS    CL6            17,18,19  CP17W                           20400000
APPAEB   DS    CL6                                                17332 20410018
APPN7A3  DS    CL4            CONTINUATION OF ROUTINES BEGUN IN         20420000
APPN7B4  DS    CL4                 PART 1                               20440000
*        ROUTINE FOR          CODE      CEND COMPLETION OF              20460000
APPABA2  DS    CL6            0,1       CP4/CP5                         20480000
APPADB2  DS    CL6            2         CP7W                            20500000
APPAAB2  DS    CL6            3         CP1 OR CP2, READ AND UPDATE     20520000
APPACA2  DS    CL6            5         CP6W                            20540000
APPAHB2  DS    CL6            6         CP4/CP5W, WRITE CHECK           20560000
*        ROUTINE FOR          CODE     ABEND COMPLETION OF              20580000
APPABD2  DS    CL6            0,1       CP4/CP5W                        20600000
APPAIB2  DS    CL6            2         CP7W                            20620000
APPAAA2  DS    CL6            3         CP1 OR CP2, READ AND UPDATE     20640000
APPACE2  DS    CL6            5         CP6W                            20660000
APPAHD2  DS    CL6            6         CP4/CP5W, WRITE CHECK           20680000
INVAPPCD DC    H'0'                     PGMCHK FOR BAD APPCODE @ZA26522 20682037
TWOFOUR  DC    X'0018'                  MAX APPCODE VALUE      @ZA26522 20682537
*                                                                       20683037
MODID    DC    C'IGG019G7'              MODULE NAME            @ZA26522 20683537
DATE     DC    CL8'&SYSDATE'            DATE OF FIX            @ZA26522 20684037
FIX      DC    C' OZ26522'              LATEST FIX             @ZA26522 20684537
PATCH    DC    40F'0'                   ZEROED PATCH AREA        Y02072 20685037
*                                                                       20686002
         EJECT                                                          20690002
RQE      IECDRQE ,                      RQE                      Y02072 20692002
         EJECT                                                          20694002
CVT      DSECT                                                          20700000
         CVT                                                            20730002
         SPACE 5                                                        20760002
*        WRITE KEY NEW CHANNEL PROGRAM REFERENCES (WRITE CHECK)         20860020
IHAWKNCP IGGWKNCP  OPTCD=W                                       S20201 21160020
         IGGCP13C  OPTCD=W                                       S20201 21560020
         IGGCP13A                                                       22060020
CP13B    DSECT                                                          22460020
         IGGCP13B                                                       22760020
CP123    DSECT                                                          23060020
         IGGCP123                                                       23260020
         EJECT                                                          23900000
*              DATA EVENT CONTROL BLOCK                                 23920000
IHADECB  DSECT                                                          23940000
         DS    0F                                                       23960000
DECBECB  DS    CL4                      EVENT CONTROL BLOCK (ECB)       23980000
DECBTYP1 DS    BL1                      TYPE B6 - 1 IF LENGTH IS S      24000000
*                                            B7 - 1 IF AREA IS S        24020000
DECBTYP2 DS    BL1                           B0 - 1 IF READ K           24040000
*                                            B1 - 1 IF READ KX          24060000
*                                            B2 - 1 IF READ KU          24080000
*                                            B4 - 1 IF WRITE K          24100000
*                                            B5 - 1 IF WRITE KN         24120000
DECBLGTH DS    CL2                      LENGTH OF BLOCK                 24140000
DECBDCBA DS    A                        POINTER TO DCB                  24160000
DECBAREA DS    A                        ADDRESS OF AREA                 24180000
DECBLOGR DS    A                        POINTER TO LOGICAL RECORD       24200000
DECBKEY  DS    A                        POINTER TO KEY                  24220000
DECBEXC1 DS    BL1                      EXCPTN CD B0-RECORD NOT FOUND   24240000
*                                                 B1-RECORD LGTH CHK    24260000
*                                                 B2-NO SPACE           24280000
*                                                 B3-INVALID REQUEST    24300000
*                                                 B4-UNCORRECTABLE IO   24320000
*                                                 B5-UNREACHABLE BLOCK  24340000
*                                                 B6-OVERFLOW RECORD    24360000
*                                                 B7-DUPLICATE          24380000
DECBEXC2 DS    BL1                                B7-READ KU            24400000
         EJECT                                                          24420000
         DCBD  DSORG=(IS)                                               24440000
         EJECT                                                          24460000
IHAIOB   IGGIOBD                                                        24560020
         EJECT                                                          25780000
IHADCW   IGGBISAM                                                       25840020
         EJECT                                                          26320000
IHADEB   IGGDEBD                                                        26380020
         END                                                            27219900
