         TITLE 'IGG019JH-SIO APPENDAGE FOR RPS AND NON-RPS CP INIT'     00060020
IGG019JH CSECT                                                          00120020
*          RELEASE OS/VS2-02 DELETIONS/CHANGES                   Y02072 00122002
*D                                                               Y02072 00124002
*D                                                              YM02868 00126002
*A                                                              YA03708 00128002
*          RELEASE 20 DELETIONS/CHANGES                                 00130002
*0000                                                            M4967  00150020
*0000765000,820200-821400                                        M6178  00155020
*0000                                                            M5874  00160020
*          RELEASE 21 DELETIONS/CHANGES                                 00300020
*1200                                                            A45232 00305021
*1200                                                            A45232 00310021
*1200                                                            A44446 00330021
*1200298800                                                      A46644 00340021
*1200548340,551400,555600-556800                                 MXXXX  00350000
*1200                                                            A50669 00350400
*1200                                                            A51136 00352000
*D539400-540000,A536900-536920                                  SA68845 00354002
*          CHANGES SINCE VS2-3.7                                      * 00356037
*A038600-038800,A834200-834400                                 @ZA26522 00358037
*                                                                       00360020
* FUNCTION/ OPERATION- THIS MODULE IS THE APPENDAGE ROUTINE THAT        00420020
* INITIALIZES THE BISAM CHANNEL PROGRAMS TO UTILIZE THE ROTATIONAL      00480020
* POSITION SENSING (RPS) FEATURE OR NOT. THE PRESENCE OF THE FEATURE    00540020
* IS DETERMINED BY THE UCB.  THE RPS FEATURE IS EXPLOITED BY            00600020
* CHANGING CERTAIN CCW'S IN THE BISAM CHANNEL PROGRAMS FROM             00660020
* NOP TO SET SECTOR, WITH ATTENDANT CALCULATION OF THE PROPER           00720020
* SECTOR VALUE.  ADDITIONALLY SOME TIC ADDRESSES MUST BE CHANGED        00780020
* TO BRING THE SET SECTOR CCW'S INTO USE.                               00840020
* ENTRY POINT- IGG019JH IS THE ONLY ENTRY POINT.  THE MODULE IS         00900020
*              ENTERED AT SIO TIME BY IOS VIA THE DEB APPENDAGE         00960020
*              VECTOR TABLE.                                            01020020
* INPUT-       THE IOS REGISTER INTERFACE IS THE PRINCIPAL INPUT        01080020
*              TO THE MODULE. THEY PROVIDE ADDRESSABILITY FOR THE DCB.  01140020
*              WORK AREA, IOB, DEB, CHANNEL PROGRAMS , ETC.             01200020
* OUTPUT-      THE CHANNEL PROGRAM TO BE EXECUTED ON THIS SIO WILL BE   01260020
*              INITIALIZED ACCORDING TO THE DEVICE FEATURE (RPS OR      01320020
*              NON RPS) IN THE UCB.                                     01380020
*              EXTERNAL ROUTINES- IEA0SCRL VIA CVT0SCRL.  THE ROUTINE   01440020
*              DOES CONVERSION OF THE INPUT PARAMETERS TO A SECTOR      01500020
*              VALUE                                                    01560020
* EXITS-       NORMAL RETURN TO IOS, TO PROCEED WITH SIO.               01620020
* TABLES/WORK AREAS - DECB, DCB, IOB AND EXTENTION, DCB WA (DCW), DEB,  01680020
*        CVT, PART 2 VECTOR TABLE.                                      01740020
*        SEE DSECTS AT END OF MODULE FOR FORMAT AND DESCRIPTIONS.       01800020
*                                                                       01860020
* GENERAL REGISTERS ARE USED AS FOLLOWS                                 01920020
R0       EQU   0                        * WORK REGISTER                 01980020
R1       EQU   1                        * 12* ADDRESS                   02040020
R2       EQU   2                        * IOB AND WORK REGISTER         02100020
R3       EQU   3                        * DEB AND WORK REGISTER         02160020
R4       EQU   4                        * DCB                           02220020
R5       EQU   5                        * -----                         02280020
R6       EQU   6                        * ----                          02340020
R7       EQU   7                        * UCB                           02400020
R8       EQU   8                        * -----                         02460020
R9       EQU   9                        + WORK REGISTER                 02520020
R10      EQU   10                       CHANNEL PROGRAM POINTER         02580020
R11      EQU   11                       WORK REGISTER                   02640020
R12      EQU   12                       WORK REGISTER                   02700020
R13      EQU   13                       WORK REGISTER                   02760020
R14      EQU   14                       IOS RETURN VECTOR TABLE         02820020
R15      EQU   15                       BASE REG AND ADDR OF ENTRY      02880020
*                                       POINT TO SECTOR CALCULATION     02940020
*                                       ROUTINE                         03000020
*1200513000-514200                                               A43729 03030021
*                                                                       03060020
*        * MEANS THIS REGISTER IS SET UP UPON ENTRY FROM IOS,           03120020
*          AND ITS CONTENTS MUST BE RESTORE UPON RETURN TO IOS          03180020
*        + MEANS THIS REGISTER MAY BE CHANGED, BUT UPON RETURN TO IOS   03240020
*          IT MUST CONTAIN ZEROES IN THE THREE HIGH ORDER BYTES         03300020
*                                                                       03360020
         EJECT                                                          03420020
         USING *,R15                                                    03480020
         USING IHADCB,R4                                                03540020
         USING IHAIOB,R2                                                03600020
         USING RQE,R1                   RQE ADDRESSABILITY       Y02072 03650002
         SPACE 2                                                        03650402
         STM   R14,R12,0(R13)           SAVE REGS FOR EXCP      YM02868 03650802
         LR    R5,R13                   SAVE SAVE AREA ADDRESS  YM02868 03651202
         SPACE 2                                                        03652002
         MODESET  KEYADDR=RQEPRT,WORKREG=10 CHANGE TO USERS KEY  Y02072 03654002
         SPACE 2                                                        03656002
         L     R10,IOBSTART-ONE         ADDR OR CP OR PREFIX            03660020
         LA    R10,ZERO(R10)            CLEAR HIGH ORDER BYTE           03720020
         LA    R11,IOBSECT              SECTOR ADDR INTO R11            03780020
         MVI   IDXOVFLO,ZERO            CLEAR WORK BYTE         YA03708 03830002
         IC    R9,IOBAPP                APP CODE USED AS INDEX          03840020
         CH    R9,TWOFOUR           IS APP CODE GT 24?         @ZA26522 03860037
         BH    INVAPPCD             IF YES-GO PROG CHK         @ZA26522 03880037
         SLL   R9,2                     MULTIPLY BY 4                   03900020
         B     APPSIOTB(R9)             BRANCH TO SET-UP CP'S           03960020
*                                                                       04020020
*********************************************************************** 04080020
*****               SIO APPENDAGE VECTOR TABLE                    ***** 04140020
*********************************************************************** 04200020
*                                                                       04260020
*             APPENDAGE CODE      FOR COMPLETION OF                     04320020
*                    0         CP4 OR CP5/5W FOR READ                   04380020
*                    1         CP4 OR CP5/5W FOR WRITE                  04440020
*                    2         CP7/7W                                   04500020
*                    3         CP1 OR CP2                               04560020
*                    4         CP14 PART2 FOR FIXED                     04620020
*                    5         CP6/6W                                   04680020
*                    6         INVALID                                  04740020
*                    7         CP1 OR CP2 FOR WKN                       04800020
*                    8         CP8                                      04860020
*                    9         CP10A-FIXED CP14-VLR (EOF EXTN)          04920020
*                    10        CP10B-FIXED CP14-VLR                     04980020
*                    11        CP10B                                    05040020
*                    12        CP14 OR CP14 PART1                       05100020
*                    13        CP14 OR CP14 PART1                       05160020
*                    14        CP15                                     05220020
*                    15        CP16                                     05280020
*                    16        CP16                                     05340020
*                    17        CP17-FIXED CP14-VLR                      05400020
*                    18        CP17                                     05460020
*                    19        CP17                                     05520020
*                    20        CP9A,CP11A,CP12A,CP13A OR CP12AV         05580020
*                    21        CP9B,CP11B,CP12B,CP13B OR CP12BV         05640020
*                    22        CP9C,CP123W OR CP123WV                   05700020
*                    23        CP10A/10AW                               05760020
*                    24        CP12C/12CW OR CP13C/13CW                 05820020
*                                                                       05880020
APPSIOTB EQU   *                        APPENDAGE CODES                 05940020
         B     APPCD0                   0                               06000020
         B     APPCD0                   1                               06060020
         B     APPCD2                   2                               06120020
         B     APPCD3                   3                               06180020
         B     APPCD4                   4                               06240020
         B     APPCD5                   5                               06300020
         B     APPRET                   6                               06360020
         B     APPCD3                   7                               06420020
         B     APPCD8                   8                               06480020
         B     APPCD9                   9                               06540020
         B     APPCD10                  10                              06600020
         B     APPCD10                  11                              06660020
         B     APPCD4                   12                              06720020
         B     APPCD4                   13                              06780020
         B     APPCD14                  14                              06840020
         B     APPCD15                  15                              06900020
         B     APPCD15                  16                              06960020
         B     APPCD17                  17                              07020020
         B     APPCD170                 18                              07080020
         B     APPCD170                 19                              07140020
         B     APPCD20                  20                              07200020
         B     APPCD21                  21                              07260020
         B     APPCD22                  22                              07320020
         B     APPCD23                  23                              07380020
         B     APPCD24                  24                              07440020
         EJECT                                                          07500020
*                                                                       07560020
*        COMMOM EXIT ROUTINE. RESTORE REGISTERS AND RETURN              07620020
*        VIA REGISTER 14                                                07680020
*                                                                       07740020
APPNOMO  EQU   *                        RESTORE IOS REGISTERS AND EXIT  07800020
         L     R3,RQEDEB                RESTORE DEB ADDRESS             07860000
         LA    R3,ZERO(R3)              CLEAR HIGH ORDER BYTE           07920020
APPRET   EQU   *                        *                               07980020
         SPACE 2                                                        07990002
         MODESET  KEYADDR=KEYZERO,WORKREG=9  CHANGE TO KEY ZERO  Y02072 08030002
         SPACE 2                                                        08032002
         LM    R14,R12,0(R5)            RESTORE REGS FOR EXCP   YM02868 08034002
         SR    R9,R9                    CLEAR REG 9                     08040020
         BR    R14                      RETURN TO IOS                   08100020
         EJECT                                                          08160020
*                                                                       08220020
*        APPENDAGE CODE 0, 1, SET UP CP4-5-5W FOR READ OR WRITE         08280020
*                                                                       08340020
         USING CP4,R10                                                  08400020
APPCD0   EQU   *                        *                               08460020
         L     R9,IOBCCWAD              ADDR OF CP4                     08520020
         LA    R9,ZERO(R9)              CLEAR HIGH ORDER BYTE           08580020
         CR    R10,R9                   DOES CP START AT CP4            08640020
         BNE   APPCD02                  BNE MEANS NO                    08700020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    08760020
         BZ    APPCD01                  BZ MEANS NON RPS                08820020
         MVI   CA6B,SETSECT             MOVE IN SET SECT CMD CODES      08880020
         MVI   CA15,SETSECT                                             08940020
         ST    R11,CA24                 PUT SECTOR ADDR IN CCW          09000020
         MVI   CA24,RDSECT              MOVE IN READ SECT CMD CODE      09060020
         TM    DCBOPTCD,WRTCHK          TEST FOR WC                     09120020
         BZ    APPRET                   BRANCH MEANS NO-EXIT            09180020
         ST    R11,CA240                PUT SECTOR ADDR IN WC CCW       09240020
         MVI   CA240,SETSECT            MOVE IN SET SECT CMD CODE       09300020
         B     APPRET                   COMMON EXIT                     09360020
*                                                                       09420020
APPCD01  EQU   *                        *                               09480020
         MVI   CA6B,NOP                 CHANGE SET/READ SECTO TO NOPS   09540020
         MVI   CA15,NOP                                                 09600020
         MVI   CA24,NOP                                                 09660020
         TM    DCBOPTCD,WRTCHK          TEST FOR WC                     09720020
         BZ    APPRET                   BRANCH MEANS NO-EXIT            09780020
         MVI   CA240,NOP                CHANGE SET SECTOR TO NOP        09840020
         B     APPRET                   COMMON EXIT                     09900020
*                                                                       09960020
APPCD02  EQU   *                        *                               10020020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    10080020
         BZ    APPRET                   BZ MEANS NO EXIT                10140020
         LA    R3,APPSUB1               RETURN TO CONVERT SECTOR        10200020
         B     APPSUB                   CP PREFIX ROUTINE               10260020
         EJECT                                                          10320020
*                                                                       10380020
*        APPENDAGE CODE 2, SET-UP CP7 OR CP7W                           10440020
*                                                                       10500020
         USING CP7,R10                                                  10560020
APPCD2   EQU   *                        *                               10620020
         BAL   R3,APPSUB                CP PREFIX ROUTINE               10680020
         TM    DCBOPTCD,WRTCHK          TEST FOR WC - CP7 RPS WC ONLY   10740020
         BZ    APPNOMO                  BZ MEANS NOT WC - EXIT          10800020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    10860020
         BZ    APPCD21A                 BZ MEANS NON RPS                10920020
         MVC   CA460(FOUR),IOBCCW1      SET UP SET SECTOR CCW           10980020
         B     APPNOMO                  COMMON EXIT                     11040020
APPCD21A EQU   *                        *                               11100020
         MVI   CA460,NOP                CHANGE SET SECTOR TO NOP        11160020
         B     APPNOMO                  COMMON EXIT                     11220020
         EJECT                                                          11280020
*                                                                       11340020
*        APPENDAGE CODE 3, SET UP CP1 OR CP2                            11400020
*                                                                       11460020
         USING CP2,R10                                                  11520020
APPCD3   EQU   *                        *                               11580020
         L     R10,IOBCCWAD             ADDR OF CP1 OR CP2              11640020
         L     R13,DCBWKPT2             WA ADDRESSABILITY               11700020
         CLI   WA11(R13),ONE            IF NSLD GREATER THAN 1          11760020
         BH    APPCD31                  THEN BRANCH TO SET UP CP1       11820020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    11880020
         BZ    APPCD301                 BZ MEANS NON-RPS                11940020
         MVI   C31B,SETSECT             MOVE IN SET SECTOR CMD CODE     12000020
         B    APPRET                    COMMON EXIT                     12060020
*                                                                       12120020
APPCD301 EQU   *                        *                               12180020
         MVI   C31B,NOP                 CHANGE SET SECTOR TO NOP        12240020
         B     APPRET                   COMMON EXIT                     12300020
*                                                                       12360020
         USING CP1,R10                                                  12420020
APPCD31  EQU   *                        *                               12480020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    12540020
         BZ    APPCD33                  BZ MEANS NON-RPS                12600020
         MVI   C2B,SETSECT              MOVE IN SET SECTOR CMD CODES    12660020
         MVI   C12B,SETSECT                                             12720020
         B     APPRET                   COMMON EXIT                     12780020
*                                                                       12840020
APPCD33  EQU   *                        *                               12900020
         MVI   C2B,NOP                  CHANGE SET SECTORS TO NOPS      12960020
         MVI   C12B,NOP                                                 13020020
         B     APPRET                   COMMON EXIT                     13080020
         EJECT                                                          13140020
*                                                                       13200020
*        APPENDAGE CODE 4, SET UP CP14 PART2 (FIXED LENGTH RECORDS      13260020
*        WITH USER WA).THE STARTING POINT OF CP14 HAS TO BE DETERMINED. 13320020
*                                                                       13380020
         USING CP14,R3                                                  13440020
APPCD4   EQU   *                        *                               13500020
         BAL   R3,APPSUB                CP PREFIX ROUTINE               13560020
         L     R3,IOBCCWAD              FIND THE ADDR OF                13620020
         LA    R3,SZ8(R3)               CP14 BY TAKING THE ADDR OF CP8  13680020
         TM    DCBRECFM,VLR             (TEST FOR VLR                   13740020
         BZ    APPAD10B                 NOT VLR ADD SIZE CP10B          13800020
         TM    RPS(R7),RPSTST           TEST FOR RPS - VLR              13860020
         BO    APPCD4A                  BO MEANS RPS                    13920020
         MVI   CH8G,NOP                 CH8G                            13980020
         MVI   CH150,NOP                CH150                           14040020
         MVI   CH200,NOP                CH200                           14100020
         TM    DCBOPTCD,WRTCHK          VLR WITH WC                     14160020
         BZ    APPNOMO                  BZ MEANS NO - COMMON EXIT       14220020
         MVI   CH3A1,NOP                CH3A1                           14280020
         MVI   CH80,NOP                 CH80                            14340020
         MVI   CH130,NOP                CH130                           14400020
         MVI   CH180,NOP                CH180                           14460020
         MVI   CH220,NOP                CH220                           14520020
         B     APPNOMO                  COMMON EXIT)                    14580020
*                                                                       14640020
APPAD10B EQU   *                        *                               14700020
         TM    DCBOPTCD,WRTCHK          AND ADD CP8 AND CP10B/10BW      14760020
         BO    APPCD4AA                 BO MEANS WC                     14820020
         LA    R3,SZ10B(R3)             LENGTH OF CP10B                 14880020
         B     APPCD400                 BRANCH FOR NON- WC              14940020
*                                                                       15000020
*        THIS SECTION DETERMINES THE STARTING POINT OF CP14             15060020
*        WHEN WRITE CHECKING IS SPECIFIED FOR FIXED LENGTH              15120020
*        RECORDS AND FOR VARIBLE LENGTH RECORDS WHEATHER WRITE          15180020
*        CHECKING IS SPECIFIED OR NOT.                                  15240020
*                                                                       15300020
APPCD4AA EQU   *                        *                               15360020
         LA    R3,SZ10BW(R3)            LENGTH OF CP10B WITH WC         15420020
APPCD4A  EQU   *                        *                               15480020
         MVI   IDXOVFLO,OVFLO           TURN ON OVERFLOW                15540020
         LA    R9,CH150                 ADDR OF CH150                   15600020
         CR    R10,R9                   DOES CP14 START AT CH150        15660020
         BE    APPCD12A                 BE MEANS YES                    15720020
         LA    R9,CH15                  ADDR OF CH15                    15780020
         CR    R10,R9                   DOES CP14 START AT CH15         15840020
         BE    APP12AA                  BE MEANS YES                    15900020
         LA    R9,CH200                 ADDR OF CH200                   15960020
         CR    R10,R9                   DOES CP14 START AT CH200        16020020
         BE    APPCD12D                 BE MEANS YES                    16080020
         LA    R9,CH20                  ADDR OF CH20                    16140020
         CR    R10,R9                   DOES CP14 START AT CH20         16200020
         BE    APPCD12E                 BE MEANS YES                    16260020
         MVI   IDXOVFLO,INDEX           USE INDEX CALCULATION           16320020
         LA    R9,CH5                   ADDR OF CH5                     16380020
         CR    R10,R9                   DOES CP14 START AT CH5          16440020
         BE    APPCH5                   BE MEANS YES                    16500020
         LA    R9,CH1                   ADDR OF CH1                     16560020
         CR    R10,R9                   DOES CP14 START AT CH1          16620020
         BE    APPCD40A                 BE MEANS YES                    16680020
         LA    R9,CH55                  ADDR OF CH55                    16740020
         CR    R10,R9                   DOES CP14 START AT CH55         16800020
         BE    APPCD40B                 BE MEANS YES                    16860020
         LA    R9,CH8D                  ADDR OF CH8D                    16920020
         CR    R10,R9                   DOES CP14 START AT CH8D         16980020
         BE    APPCD40E                 BE MEANS YES                    17040020
         TM    DCBRECFM,VLR             TEST FOR VLR                    17100020
         BO    APPCD4B                  IF VLR BRANCH AROUND ADDITION   17160020
         LA    R3,EIGHT(R3)             FIXED-ADD 8 TO GET TO CH9       17220020
APPCD4B  EQU   *                        *                               17280020
         LA    R9,CH8G                  CH9 FOR FIXED                   17340020
         CR    R10,R9                   START AT CH8G-CH9 FIXED         17400020
         BE    APPCH8G                  BE MEANS YES                    17460020
         LA    R9,CH8G5                 CH95 FOR FIXED                  17520020
         CR    R10,R9                   START AT CH8G5-CH95 FIXED       17580020
         BE    APPCD40G                 BE MEANS YES                    17640020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    17700020
         BO    APPCD425                 BO MEANS RPS                    17760020
         B     APPCD406                 CONTINUE FOR NON-RPS INIT       17820020
*                                                                       17880020
*        THIS SECTION DETERMINES THE STARTING POINT OF CP14             17940020
*        WHEN WRITE CHECKING IS NOT SPECIFIED FOR FIXED LENGTH RECORDS. 18000020
*                                                                       18060020
APPCD400 EQU   *                        *                               18120020
         MVI   IDXOVFLO,INDEX           USE INDEX CALCULATION           18180020
         LA    R9,CH1                   ADDR OF CH1                     18240020
         CR    R10,R9                   DOES CP14 START AT CH1          18300020
         BE    APPCD408                 BE MEANS YES                    18360020
         LA    R3,LCH3(R3)              ADD LENGTH OF COMMON            18420020
         USING CH4,R3                                                   18480020
         LA    R9,CH5                   ADDR OF CH5                     18540020
         CR    R10,R9                   DOES CP14 START AT CH5          18600020
         BE    APPCH55                  BE MEANS YES                    18660020
         LA    R9,CH55                  ADDR OF CH55                    18720020
         CR    R10,R9                   DOES CP14 START AT CH55         18780020
         BE    APPCD40D                 BE MEANS YES                    18840020
         LA    R3,LCH8(R3)              ADD LENGTH OF COMMON            18900020
         USING CH8D,R3                                                  18960020
         LA    R9,CH8D                  ADDR OF CH8D                    19020020
         CR    R10,R9                   DOES CP14 START AT CH8D         19080020
         BE    APPCD40F                 BE MEANS YES                    19140020
         TM    DCBRECFM,VLR             TEST FOR VLR                    19200020
         BO    APPCD4C                  IF VLR BRANCH AROUND ADDITION   19260020
         LA    R3,EIGHT(R3)             FIXED-ADD 8 TO GET TO CH8G5     19320020
APPCD4C  EQU   *                        *                               19380020
         LA    R9,CH8G5                 ADDR OF CH8G5                   19440020
         CR    R10,R9                   DOES CP14 START AT CH8G5        19500020
         BE    APPCD40H                 BE MEANS YES                    19560020
         LA    R9,CH8G                  ADDR OF CH8G                    19620020
         CR    R10,R9                   DOES CP14 START AT CH8G         19680020
         BE    APPCH56                  BE MEANS YES                    19740020
         TM    DCBRECFM,VLR             TEST FOR VLR                    19800020
         BZ    APPCD4D                  BZ MEANS NOT VLR                19860020
         LA    R3,EIGHT(R3)             ADD 8 FOR VLR                   19920020
APPCD4D  EQU   *                        *                               19980020
         LA    R3,LCH13-EIGHT(R3)       ADD LENGTH OF COMMON            20040020
         USING CH14,R3                                                  20100020
         LA    R9,CH14                  ADDR OF CH14                    20160020
         CR    R10,R9                   DOES CP14 START AT CH14         20220020
         BE    APP431A                  BE MEANS YES                    20280020
*                                                                       20340020
         LA    R9,CH150                 ADDR OF CH150                   20400020
         CR    R10,R9                   DOES CP14 START AT CH150        20460020
         BE    APPCD12F                 BE MEANS YES                    20520020
         MVI   IDXOVFLO,OVFLO           TURN ON OVERFLOW                20580020
         LA    R9,CH15                  ADDR OF CH15                    20640020
         CR    R10,R9                   DOES CP14 START AT CH15         20700020
         BE    APPCD122                 BE MEANS YES                    20760020
         LA    R3,LCH18(R3)             GET TO CH19                     20820020
         USING CH19,R3                                                  20880020
         LA    R9,CH200                 ADDR OF CH200                   20940020
         CR    R10,R9                   DOES CP14 START AT CH200        21000020
         BE    APP122AA                 BE MEANS YES                    21060020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    21120020
         BZ    APPNOMO                  BZ MEANS NON-RPS - EXIT         21180020
         L     R3,CH20                  GET CCHHR                       21240020
         MVC   HEAD(THREE),TWO(R3)      MOVE HHR TO HEAD                21300020
         LA    R3,APPNOMO               RETURN TO COMMON EXIT           21360020
         B     APPSUBX                  SECTOR CONVERT ROUTINE          21420020
*                                                                       21480020
*        THE STARTING POINT OF CP14 HAS NOW BEEN DETERMINED             21540020
*                                                                       21600020
APPCD12A EQU   *                        *                               21660020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    21720020
         BO    APPCD426                 BO MEANS RPS                    21780020
         B     APPCD407                 BRANCH FOR NON-RPS INIT         21840020
         USING CP14,R3                                                  21900020
APPCD12D EQU   *                        *                               21960020
         LA    R10,CH15                 FOR NEXT USING                  22020020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    22080020
         BZ    APP122CC                 BZ MEANS NON-RPS                22140020
         B     APP122BB                 BRANCH FOR RPS INIT             22200020
APPCD12E EQU   *                        *                               22260020
         LA    R10,CH15                 FOR NEXT USING                  22320020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    22380020
         BZ    APP122CA                 BRANCH FOR NON-RPS INIT         22440020
         L     R3,CH20                  GET CCHHR                       22500020
         MVC   HEAD(THREE),TWO(R3)      MOVE HHR TO HEAD                22560020
         BAL   R3,APPSUBX               SECTOR CONVERT ROUTINE          22620020
         LA    R11,IOBSECT+THREE        SECTOR ADDR                     22680020
         B     APP122DD                 CONTINUE                        22740020
APPCD12F EQU   *                        *                               22800020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    22860020
         BZ    APPCD415                 BZ MEAMS NON-RPS                22920020
         LR    R10,R3                   FOR NEXT USING ON CH14          22980020
         B     APPCD431                 CONTINUE RPS INIT               23040020
         USING CH55,R10                                                 23100020
APPCD40B EQU   *                        *                               23160020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    23220020
         BZ    APPCD40C                 BZ MEANS NO                     23280020
         L     R3,CH55                  GET CCHHR                       23340020
         MVC   HEAD(THREE),TWO(R3)      MOVE HHR TO HEAD                23400020
         BAL   R3,APPSUBX               SECTOR CONVERT ROUTINE          23460020
         LA    R3,EIGHT                 SUBTRACT 8 FROM R10 TO          23520020
         SR    R10,R3                   GET BACK TO CH5                 23580020
         B     APPSKCH5                 BO MEANS WC                     23640020
APPCD40C EQU   *                        *                               23700020
         LA    R10,CH80                 NEXT USING IS ON CH80           23760020
         B     APPCD402                 BRANCH TO SET UP NON-RPS        23820020
         USING CH55,R10                                                 23880020
APPCD40D EQU   *                        *                               23940020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    24000020
         BZ    APPCD410                 BZ MEANS NON-WC                 24060020
         L     R3,CH55                  GET CCHHR                       24120020
         MVC   HEAD(THREE),TWO(R3)      MOVE HHR TO HEAD                24180020
         BAL   R3,APPSUBX               SECTOR CONVERT ROUTINE          24240020
         LA    R10,LCH3+LCH3C+LCH8(R10) ADD LENGTH OF COMMON SEGMENTS   24300020
         B     APPCD430                 BRANCH TO FINISH PART1          24360020
         USING CH8D,R10                                                 24420020
APPCD40E EQU   *                        *                               24480020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    24540020
         BZ    APPCD403                 BZ MEANS NON RPS                24600020
         L     R3,CH8D                  GET CCHHR                       24660020
         MVC   HEAD(THREE),TWO(R3)      MOVE HHR TO HEAD                24720020
         BAL   R3,APPSUBX               SECTOR CONVERT ROUTINE          24780020
         LA    R10,CH8G5                FOR NEXT USING                  24840020
         B     APPCD424                 BO MEANS WC                     24900020
APPCD40F EQU   *                        *                               24960020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    25020020
         BZ    APPCD411                 BZ MEANS NON-RPS                25080020
         L     R3,CH8D                  GET CCHHR                       25140020
         MVC   HEAD(THREE),TWO(R3)      MOVE HHR TO HEAD                25200020
         BAL   R3,APPSUBX               SECTOR CONVERT ROUTINE          25260020
         LA    R10,LCH13(R10)           LENGTH OF COMMON                25320020
         B     APPCD430                 GO TEST FOR SETUP PART1         25380020
         USING CH8G5,R10                                                25440020
APPCD40G EQU   *                        *                               25500020
         BAL   R3,APPVF2                BRANCH TO TAKE OUT 8 IF FIXED   25560020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    25620020
         BZ    APPCD405                 BZ MEANS NON-RPS                25680020
         BAL   R3,APPSUBX               SECTOR CONVERT ROUTINE          25740020
         B     APPCD424                 GO TEST FOR SETUP PART1         25800020
APPCD40H EQU   *                        *                               25860020
         BAL   R3,APPVF2                BRANCH TO TAKE OUT 8 IF FIXED   25920020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    25980020
         BZ    APPCD413                 BZ MEANS NON-RPS                26040020
         BAL   R3,APPSUBX               SECTOR CONVERT ROUTINE          26100020
         LA    R10,CH130-CH8G5(R10)     GET TO CH14                     26160020
         B     APPCD430                 CONTINUE FOR PART1              26220020
*                                                                       26280020
APPCH5   EQU   *                        *                               26340020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    26400020
         BO    APPCD421                 BO MEANS RPS                    26460020
         B     APPCD4A1                 CONTINUE PART2                  26520020
APPCH55  EQU   *                        *                               26580020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    26640020
         BO    APPCD435                 BO MEANS RPS                    26700020
         B     APPCD409                 BRANCH FOR NON RPS INIT         26760020
APPCH8G  EQU   *                        *                               26820020
         BAL   R3,APPVF01               BRANCH TO TAKE OUT 8 IF FIXED   26880020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    26940020
         BO    APPCD423                 BO MEANS RPS                    27000020
         B     APPCD404                 CONTINUE NON RPS INIT           27060020
APPCH56  EQU   *                        *                               27120020
         BAL   R3,APPVF01               BRANCH TO TAKE OUT 8 IF FIXED   27180020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    27240020
         BO    APPCD42A                 BO MEANS RPS                    27300020
         B     APPCD412                 BRANCH FOR NON RPS INIT         27360020
*                                                                       27420020
APPCD40A EQU   *                        *                               27480020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    27540020
         BO    APPCD417                 BO MEANS RPS                    27600020
         USING CP14,R10                                                 27660020
         MVI   CH3A1,NOP                CHANGE SET SECTORS TO NOP       27720020
*                                                                       27780020
         LA    R10,LCH4+EIGHT(R10)      ADD LENGTH OF COMMON SEGMENT    27840020
         USING CH5,R10                                                  27900020
APPCD4A1 EQU   *                        *                               27960020
         LA    R10,LCH8-EIGHT(R10)      LENGTH OF COMMON                28020020
         USING CH80,R10                                                 28080020
APPCD402 EQU   *                        *                               28140020
         MVI   CH80,NOP                 CHANGE SET SECTOR TO NOP        28200020
         LA    R10,LCH8C(R10)           LENGTH OF COMMON                28260020
         USING CH8D,R10                                                 28320020
APPCD403 EQU   *                        *                               28380020
         LA    R10,LCH8C-EIGHT(R10)     LENGTH OF COMMON                28440020
         USING CH8G,R10                                                 28500020
APPCD404 EQU   *                        *                               28560020
         BAL   R3,APPVF                 BRANCH TO SETUP CH8G OR CH9     28620020
         LA    R10,EIGHT(R10)           ADD LENGTH OF ONE CCW           28680020
         USING CH8G5,R10                                                28740020
APPCD405 EQU   *                        *                               28800020
         MVI   CH130,NOP                CHANGE SET SECTOR TO NOP        28860020
         LA    R10,CH14                 LENGTH OF COMMON                28920020
         USING CH14,R10                                                 28980020
APPCD406 EQU   *                        *                               29040020
         CLI   CH14,NOP                 IF CH14 IS NOP EXIT             29100020
         BE    APPNOMO                  BE MEAN YES EXIT                29160020
         LA    R10,EIGHT(R10)           LENGTH OF ONE CCW               29220020
         USING CH150,R10                                                29280020
APPCD407 EQU   *                        *                               29340020
         MVI   CH150,NOP                CHANGE SET SECTOR TO NOP        29400020
         LA    R10,EIGHT(R10)           LENGTH OF ONE CCW               29460020
         B     APPCD121                 BRANCH TO FINISH PART1          29520020
*                                                                       29580020
         USING CP14,R10                                                 29640020
APPCD408 EQU   *                        *                               29700020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    29760020
         BO    APPCD427                 BO MEANS RPS                    29820020
         LA    R10,LCH3+EIGHT(R10)      LENGTH OF COMMON                29940020
         USING CH5,R10                                                  30000020
APPCD409 EQU   *                        *                               30060020
         LA    R10,EIGHT(R10)           LENGTH OF ONE CCW               30120020
         USING CH55,R10                                                 30180020
APPCD410 EQU   *                        *                               30240020
         LA    R10,CH8+EIGHT-CH55(R10)  ADD LENGTH OF COM SEGMENTA51136 30300000
         USING CH8D,R10                                                 30360020
APPCD411 EQU   *                        *                               30420020
         LA    R10,CH8G                 ADDRESSIBILITY ON CH9           30480020
         USING CH8G,R10                                                 30540020
APPCD412 EQU   *                        *                               30600020
         BAL   R3,APPVF                 BRANCH TO SETUP CH8G OR CH9     30660020
         LA    R10,EIGHT(R10)           LENGHT OF ONE CCW               30720020
         USING CH8G5,R10                                                30780020
APPCD413 EQU   *                        *                               30840020
         LA    R10,CH130-CH8G5(R10)     LENGTH OF COMMON                30900020
         USING CH14,R10                                                 30960020
APPCD414 EQU   *                        *                               31020020
         CLI   CH14,NOP                 IS CH14 NOP                     31080020
         BE    APPNOMO                  BE MEANS YES EXIT               31140020
         LA    R10,EIGHT(R10)           LENGTH OF ONE CCW               31200020
         USING CH150,R10                                                31260020
APPCD415 EQU   *                        *                               31320020
         MVI   CH150,NOP                CHANGE SET SECTOR TO NOP        31380020
         LA    R10,EIGHT(R10)           LENGTH OF ONE CCW               31440020
         USING CH15,R10                                                 31500020
*                                                                       31560020
         LA    R10,LCH18-EIGHT(R10)     LENGTH OF COMMON                31620020
         USING CH200,R10                                                31680020
         MVI   CH200,NOP                                                31740020
         B     APPNOMO                  COMMON EXIT                     31800020
*                                                                       31860020
         USING CP14,R10                                                 31920020
APPCD417 EQU   *                        *                               31980020
         LA    R3,IOBCCW1+FIVE          SET SECTOR TO 0                 32040020
         ST    R3,IOBCCW1               SECTOR ADDR IN CP PREFIX        32100020
         MVI   IOBCCW1,SETSECT          RESET SET SECTOR CMD CODE       32160020
         CLI   CH3A1,TIC                CH3A1 TIC TO CH4                32220020
         BE    APPCD4E                  YES SKIP CHANGE TO SET SECTOR   32280020
         MVI   CH3A1,SETSECT            MOVE IN SET SECTOR CMD CODE     32340020
APPCD4E  EQU   *                        *                               32400020
         LA    R10,LCH4(R10)            LENGTH OF COMMON                32460020
         USING CH4,R10                                                  32520020
*                                                                       32580020
         L     R9,CH4                   DETERMINE IF TIC ADDR IS        32640020
         LA    R9,ZERO(R9)              CH5,CH55,CH8D,CH9,OR CH14       32700020
         LA    R3,CH5                   ADDR OF CH5                     32760020
         CR    R3,R9                    TIC TO CH5                      32820020
         BE    APPCD420                 YES CH5                         32880020
         LA    R3,CH55                  ADDR OF CH55                    32940020
         LA    R10,EIGHT(R10)           ADD LENGTH OF ONE CCW TO GET    33000020
         CR    R3,R9                    TO CH5. TIC TO CH55             33060020
         BE    APPSKCH5                 YES CH55                        33120020
         TM    DCBRECFM,VLR             TEST FOR VLR                    33180020
         BO    APPCD419                 BO MEANS VLR                    33240020
         USING CH5,R10                                                  33300020
         LA    R3,CH8D                  ADDR OF CH8D                    33360020
         CR    R3,R9                    TIC TO CH8D                     33420020
         BE    APPLD95                  YES CH8D                        33480020
APPCD419 EQU   *                        *                               33540020
         LA    R3,CH8G                  ADDR OF CH8G                    33600020
         CR    R3,R9                    TIC TO CH8G                     33660020
         BE    APPCD422                 YES CH8G                        33720020
         LA    R3,CH8G5                 ADDR OF CH8G5 (CH9 FOR FIXED)   33780020
         CR    R3,R9                    TIC TO CH8G5 (CH9)              33840020
         BE    APPCD422                 YES CH8G5 (CH9)                 33900020
         LR    R10,R9                   TIC ADDR INTO CP POINTER        33960020
         B     APPCD425                 HAS TO BE CH14                  34020020
*                                                                       34080020
APPCD420 EQU   *                        *                               34140020
         LA    R10,EIGHT(R10)           ADD LENGTH OF ONE CCW TO        34200020
         USING CH5,R10                  GET TO CH5                      34260020
APPCD421 EQU   *                        *                               34320020
         CLI   CH5,SEEKHH               CH5 DOING A HEAD SEEK           34380020
         BE    APPSKCH5                 BE MEANS YES-NO CHANGE          34440020
         ST    R11,CH5                  PUT SECTOR ADDR IN CH5          34500020
         MVI   CH5,SETSECT              MOVE IN SET SECTOR CMD CODE     34560020
APPSKCH5 EQU   *                        *                               34620020
         CLI   CH80,TIC                 CH80 TIC TO CH8D                34680020
         BE    APPLD55                  YES SKIP SECTOR CONVERSION      34740020
         ST    R11,CH80                 PUT IN SECTOR ADDR              34800020
         MVI   CH80,SETSECT             MOVE IN SET SECTOR CMD CODE     34860020
APPLD55  EQU   *                        *                               34920020
         L     R3,CH55                  GET CCHHR                       34980020
         MVC   HEAD(THREE),TWO(R3)      MOVE HHR TO HEAD                35040020
         BAL   R3,APPSUBX               SECTOR CONVERT ROUTINE          35100020
APPLD95  EQU   *                        *                               35160020
         TM    DCBRECFM,VLR             TEST FOR VLR                    35220020
         BO    APPCD422                 BO MEANS YES-SETUP CH8G         35280020
         LA    R10,CH8G5                ADDRESSIBILITY FOR CH95         35340020
         B     APPCD424                 CONTINUE FOR CH9                35400020
         USING CH5,R10                                                  35460020
APPCD422 EQU   *                        *                               35520020
         LA    R10,CH8G                 CH9 FOR FIXED                   35580020
         USING CH8G,R10                                                 35640020
APPCD423 EQU   *                        *                               35700020
         LA    R11,IOBSECT+ONE          ADDR OF SECTOR                  35760020
         BAL   R3,APPVF                 BRANCH TO SETUP CH8G OR CH9     35820020
         BAL   R3,APPSUBX               SECTOR CONVERT ROUTINE          35880020
         LA    R10,EIGHT(R10)           ADD ONE CCW LENGTH FOR CH8F0    35940020
         USING CH8G5,R10                                                36000020
APPCD424 EQU   *                        *                               36060020
         CLI   CH130,TIC                CH130 TIC TO CH14               36120020
         BE    APPLD14                  YES SKIP SECTOR CONVERSION      36180020
         LA    R11,IOBSECT+ONE          SECTOR ADDR                     36240020
         ST    R11,CH130                PUT SECTOR ADDR IN CCW          36300020
         MVI   CH130,SETSECT            MOVE IN SET SECTOR CMD CODE     36360020
         L     R3,CH13A                 GET CCHHR                       36420020
         MVC   HEAD(THREE),TWO(R3)      MOVE HHR TO HEAD                36480020
         BAL   R3,APPSUBX               SECTOR CONVERT ROUTINE          36540020
APPLD14  EQU   *                        *                               36600020
         LA    R10,CH14                 NEXT USING ON CH14              36660020
         USING CH14,R10                                                 36720020
APPCD425 EQU   *                        *                               36780020
         CLI   CH14,NOP                 IF CH14 IS NOP EXIT             36840020
         BE    APPNOMO                  BE MEANS YES - EXIT             36900020
         LA    R10,EIGHT(R10)           ADD ONE CCW TO GET TO CH150     36960020
         USING CH150,R10                                                37020020
APPCD426 EQU   *                        *                               37080020
         MVI   IDXOVFLO,OVFLO           TURN ON OVERFLOW                37140020
         LA    R11,IOBSECT+TWO          SECTOR ADDR                     37200020
         ST    R11,CH150                PUT SECTOR ADDR IN CCW          37260020
         MVI   CH150,SETSECT            MOVE IN SET SECTOR CMD CODE     37320020
         MVC   HEAD(THREE),CH23+FIVE    MOVE HHR TO HEAD                37380020
         LA    R10,CH15                 ADDR OF PART1                   37440020
         LA    R3,APPCD120              RETURN TO APPCD120              37500020
         B     APPSUBX                  SECTOR CONVERT ROUTINE          37560020
*                                                                       37620020
APPCD427 EQU   *                        *                               37680020
         LA    R3,IOBCCW1+FIVE          SET SECTOR TO 0                 37740020
         ST    R3,IOBCCW1               SECTOR ADDR IN CP PREFIX        37800020
         MVI   IOBCCW1,SETSECT          RESET SET SECTOR CMD CODE       37860020
         USING CH4,R10                                                  37920020
         LA    R10,LCH3(R10)            DETERMINE IF TIC ADDR IS        37980020
         L     R3,CH4                   CH5, CH8D OR CH14               38040020
         LA    R3,ZERO(R3)              CLEAR HI ORDER BYTE             38100020
         LA    R9,CH5                   ADDR OF CH5                     38160020
         CR    R3,R9                    TIC TO CH5                      38220020
         BE    APPCD428                 YES CH5                         38280020
         LA    R10,LCH8(R10)            ADD LENGTH OF COMMON            38340020
         USING CH8D,R10                                                 38400020
         LA    R9,CH8G                  ADDR OF CH8G                    38460020
         CR    R3,R9                    TIC TO CH8G                     38520020
         BE    APPCD429                 YES CH8G                        38580020
         LA    R10,LCH13(R10)           LENGTH OF COMMON                38640020
         USING CH14,R10                                                 38700020
         CLI   CH14,NOP                 IF CH14 IS A NOP - EXIT         38760020
         BNE   APPCD431                 BNE MEANS NO                    38820020
         B     APPNOMO                  YES - COMMON EXIT               38880020
APPCD428 EQU   *                        *                               38940020
         LA    R10,EIGHT(R10)           ADD ONE CCW LENGTH FOR CH5      39000020
         USING CH5,R10                                                  39060020
APPCD435 EQU   *                        *                               39120020
         CLI   CH5,SEEKHH               CH5 DOING A HEAD SEEK           39180020
         BE    APPCD436                 BE MEANS YES-NO CHANGE          39240020
         ST    R11,CH5                  PUT SECTOR ADDR IN CCW          39300020
         MVI   CH5,SETSECT              MOVE IN SET SECTOR CMD CODE     39360020
         L     R3,CH55                  GET CCHHR                       39420020
         MVC   HEAD(THREE),TWO(R3)      MOVE HHR TO HEAD                39480020
         BAL   R3,APPSUBX               SECTOR CONVERT ROUTINE          39540020
APPCD436 EQU   *                        *                               39600020
         LA    R10,LCH3C+LCH8+LCH8C(R10) ADD LENGTH OF COMMON SEGMENTS  39660020
         B     APPCD430                 GO FINISH PART1 IF NEEDED       39720020
         USING CH8D,R10                                                 39780020
APPCD429 EQU   *                        *                               39840020
         LA    R10,CH8G                 NEXT USING ON CH8G              39900020
         USING CH8G,R10                                                 39960020
APPCD42A EQU   *                        *                               40020020
         LA    R11,IOBSECT+ONE          SECTOR ADDR                     40080020
         BAL   R3,APPVF                 BRANCH TO SETUP CH8G OR CH9     40140020
         BAL   R3,APPSUBX               SECTOR CONVERT ROUTINE          40200020
         LA    R10,CH13+EIGHT-CH8G(R10) LENGTH OF COMMON                40260020
         USING CH14,R10                                                 40320020
APPCD430 EQU   *                        *                               40380020
         CLI   CH14,NOP                 IF CH14 IA A NOP - EXIT         40440020
         BE    APPNOMO                  BE MEANS YES - EXIT             40500020
APPCD431 EQU   *                        *                               40560020
         MVI   IDXOVFLO,OVFLO           TURN ON OVERFLOW                40620020
         LA    R11,IOBSECT+TWO          SECTOR ADDR                     40680020
         ST    R11,CH150                PUT SECTOR ADDR IN CCW          40740020
         MVI   CH150,SETSECT            MOVE IN SET SECTOR CMD CODE     40800020
         MVC   HEAD(THREE),CH23+FIVE    MOVE HHR TO HEAD         A43729 40830021
         BAL   R3,APPSUBX               SECTOR CONVERT ROUTINE          40860020
         LA    R10,LCH18+EIGHT(R10)     LENGTH OF COMMON                40920020
         B     APP124A                  GO FINISH PART1                 40980020
APP431A  EQU   *                        *                               41040020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    41100020
         BO    APPCD430                 BO MEANS RPS                    41160020
         B     APPCD414                 CONTINUE FOR NON-RPS INIT       41220020
         EJECT                                                          41280020
*                                                                       41340020
*              THIS ROUTINE DECIDES IF CP14 IS FIXED OR VLR             41400020
*              AND ADJUSTS THE CCWS ACCORDINGLY. IF IT IS VLR           41460020
*              THEN WE WANT TO SETUP CH8G BUT IF IT IS FIXED            41520020
*              WE WANT TO SETUP CH9 WHICH IS CH8G5 IN THE DESECT.       41580020
*                                                                       41640020
         USING CH8G,R10                                                 41700020
APPVF    EQU   *                        *                               41760020
         TM    DCBRECFM,VLR             TEST FOR VLR                    41820020
         BO    APPVFA                   IF VLR BRANCH AROUND ADDITION   41880020
         LA    R10,EIGHT(R10)           FIXED-ADD 8 TO GET TO CH9       41940020
APPVFA   EQU   *                        *                               42000020
*                                                                       42060020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    42120020
         BZ    APPVF10                  BZ MEANS NON-RPS                42180020
         ST    R11,CH8G                 PUT SECTOR ADDR IN CCW          42240020
         MVI   CH8G,SETSECT             MOVE IN SET SECTOR CMD CODE     42300020
         L     R9,CH8G5                 GET CCHHR                       42360020
APPVF000 EQU   *                        *                               42420020
         MVC   HEAD(THREE),TWO(R9)      MOVE HHR TO HEAD                42480020
         L     R9,CH8G5                 GET SEARCH ADDR                 42540020
         CLC   TWO(TWO,R9),IOBDADAD+FIVE SAME HEAD                      42600020
         BNE   APPVF01                  BNE MEANS NO                    42660020
         TM    CH8G5,MT                 TEST FOR MULTI TRACK            42720020
         BZ    APPVF01                  BZ MEANS NO                     42780020
         NI    CH8G5,MTOFF              TURN OFF MULTI TRACK            42840020
APPVF01  EQU   *                        *                               42900020
         TM    DCBRECFM,VLR             TEST FOR VLR                    42960020
         BO    APPVF1                   BO MEANS VLR RETURN             43020020
APPVF0   EQU   *                        *                               43080020
         LA    R9,EIGHT                 GET 8 FOR SUBTRACTING           43140020
         SR    R10,R9                   SUBTRACT OUT 8 FOR FIXED        43200020
APPVF1   EQU   *                        *                               43260020
         BR    R3                       RETURN                          43320020
APPVF10  EQU   *                        *                               43380020
         MVI   CH8G,NOP                 CHANGE SET SECTOR TO NOP        43440020
         TM    DCBRECFM,VLR             TEST FOR VLR                    43500020
         BO    APPVF1                   BO MEANS VLR RETURN             43560020
         B     APPVF0                   BRANCH TO SUBTRACT OUT 8        43620020
APPVF2   EQU   *                        *                               43680020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    43740020
         BZ    APPVF01                  NO - SUBTRACT 8 IF NECESSARY    43800020
         L     R9,0(R10)                SEARCH ADDR                     43860020
         B     APPVF000                 SETUP HEAD                      43920020
         EJECT                                                          43980020
*                                                                       44040020
*        APPENDAGE CODE 5, SET UP CP6 OR 6W                             44100020
*                                                                       44160020
APPCD5   EQU   *                        *                               44220020
         BAL   R3,APPSUB                CP PREFIX SUBROUTINE            44280020
*        ADDRESSIBILITY ON CP6 MUST BE ESTABLISHED.  (IOBSTART COULD    44340020
*        BE POINTING TO EITHER CA26 OR CA37.)                           44400020
         L     R10,IOBCCWAD             POINT TO CP4                    44460020
         LA    R10,SZ4+SZ5(R10)         ADD COMMON PART OF CP4 AND CP5  44520020
         TM    DCBRECFM,VLR             TEST FOR VLR                    44580020
         BO    APPCD502                 BO MEANS YES                    44640020
         TM    DCBOPTCD,WRTCHK          IF WRITE CHECKING SPECIFIED,    44700020
         BZ    APPCD500                 IT MUST BE ALLOWED FOR.         44760020
APPCD502 EQU   *                        *                               44820020
         LA    R10,SZ5W-SZ5(R10)        ADD WRITE CHECK SEGMENT OF CP5  44880020
APPCD500 EQU   *                        R10 NOW POINTS TO CA26          44940020
         USING CP6,R10                                                  45000020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    45060020
         BZ    APPCD51                  BZ MEANS NON-RPS                45120020
         ST    R11,CA31B                PUT IN SECTOR ADDR              45180020
         MVI   CA31B,RDSECT             MOVE IN READ SECT CMD CODE      45240020
         OI    CA31+FOUR,CC             TURN ON COMMAND CHAIN           45300020
         ST    R11,CA40A                SECTOR ADDR INTO CC             45360020
         MVI   CA40A,RDSECT             READ SECTOR                     45420020
         MVC   CA40B(FOUR),IOBCCW1      SET UP SET SECTOR CCW           45480020
         TM    DCBOPTCD,WRTCHK          TEST FOR WC                     45540020
         BZ    APPCD501                 BZ MEANS NOT WC                 45600020
         MVC   CA430(FOUR),IOBCCW1      SET UP SET SECTOR CCW           45660020
*                                                                       45720020
APPCD501 EQU   *                        *                               45780020
         MVI   IDXOVFLO,OVFLO           TURN ON OVERFLOW                45840020
         LA    R3,APPNOMO               COMMON EXIT                     45900020
         B     APPSUB1                  SECTOR CONVERT ROUTINE          45960020
*                                                                       46020020
APPCD51  EQU   *                        *                               46080020
         NI    CA31+FOUR,CCOFF          TURN OFF COMMAND CHAIN          46140020
         MVI   CA31B,NOP                CHANGE SET/READ SECTORS TO NOPS 46200020
         LA    R3,CA41                  ADDR OF CA41 FOR TIC            46260020
         ST    R3,CA40A                 SET UP CA40A TO                 46320020
         MVI   CA40A,TIC                TIC TO CA41                     46380020
         MVI   CA40B,NOP                CHANGE SET SECTOR TO NOP        46440020
         TM    DCBOPTCD,WRTCHK          TEST FOR WC                     46500020
         BZ    APPNOMO                  BRANCH MEANS NOT WC EXIT        46560020
         MVI   CA430,NOP                CHANGE SET SECTOR TO NOP        46620020
         B     APPNOMO                  COMMON EXIT                     46680020
         EJECT                                                          46740020
*                                                                       46800020
*        APPENDAGE CODE 8, SET-UP CP8                                   46860020
*                                                                       46920020
         USING CP8,R10                                                  46980020
APPCD8   EQU   *                        *                               47040020
         CLI   ZERO(R10),SIDEQ          CP8 START WITH SEARCH ID EQ     47092001
         BNE   APPRET                   NO, COMMON EXIT                 47094001
         BAL   R3,APPSUB                CP PREFIX ROUTINE               47100020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    47160020
         BZ    APPCD81                  BZ MEANS NON-RPS                47220020
         MVI   IOBSECT,ZERO             SET SECTOR TO ZERO FOR   M4967  47240020
*                                       COCR                     M4967  47260020
         MVI   CB16,SETSECT             MOVE IN SET SECTOR CMD CODE     47280020
         ST    R11,CB21                 PUT SECTOR ADDR IN CCW          47340020
         MVI   CB21,RDSECT              MOVE IN READ SECTOR CMD CODE    47400020
         B     APPNOMO                  COMMON EXIT                     47460020
*                                                                       47520020
APPCD81  EQU   *                        *                               47580020
         MVI   CB16,NOP                 CHANGE SET/READ SECTORS TO NOPS 47640020
         MVI   CB21,NOP                                                 47700020
         B     APPNOMO                  COMMON EXIT                     47760020
         EJECT                                                          47820020
*                                                                       47880020
*        APPENDAGE CODE 9, SET-UP CP10A FOR TRUE INSERT OR              47940020
*        CP14 PART 2 (VARIABLE LENGTH RECORDS) FOR EOF EXTENSION        48000020
*                                                                       48060020
         USING CP10A,R10                                                48120020
APPCD9   EQU   *                        *                               48180020
         BAL   R3,APPSUB                CP PREFIX ROUTINE               48240020
         TM    DCBRECFM,VLR             TEST FOR VLR                    48300020
         BO    APPCD92                  BO MEANS VLR                    48360020
         TM    DCBOPTCD,WRTCHK          TEST FOR WC                     48420020
         BZ    APPSUB0                  BZ MEANS NOT WC                 48480020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    48540020
         BZ    APPCD91                  BZ MEANS NON-RPS                48600020
         MVC   CB500(FOUR),IOBCCW1      SET UP SET SECTOR CCW           48660020
         B     APPSUB1                  SECTOR CONVERT ROUTINE          48720020
*                                                                       48780020
APPCD91  EQU   *                        *                               48840020
         MVI   CB500,NOP                CHANGE SET SECTOR TO NOP        48900020
         B     APPNOMO                  COMMON EXIT                     48960020
*                                                                       49020020
         USING CH25,R10                                                 49080020
APPCD92  EQU   *                        *                               49140020
         TM    DCBOPTCD,WRTCHK          TEST FOR WC                     49200020
         BZ    APPCD95                  BZ MEANS NOT WC                 49260020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    49320020
         BO    APPCD93                  BZ MEANS NON-RPS                49380020
         MVI   CH280,NOP                CHANGE SET SECTOR TO NOP        49440020
         B     APPNOMO                  COMMON EXIT                     49500020
*                                                                       49560020
APPCD93  EQU   *                        *                               49620020
         MVC   CH280(FOUR),IOBCCW1      SET UP SET SECTOR CCW           49680020
APPCD94  EQU   *                        *                               49740020
         MVC   HEAD(THREE),CH31+FIVE    MOVE HHR TO HEAD                49800020
         MVI   IDXOVFLO,OVFLO           TURN ON OVERFLOW                49860020
         LA    R3,APPNOMO               COMMON EXIT                     49920020
         B     APPSUBX                  SECTOR CONVERT ROUTINE          49980020
*                                                                       50040020
APPCD95  EQU   *                        *                               50100020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    50160020
         BZ    APPNOMO                  BZ MEANS NON RPS                50220020
         B     APPCD94                  CONVERT SECTOR                  50280020
         EJECT                                                          50340020
*                                                                       50400020
*        APPENDAGE CODE 10, SET-UP CP10B FOR TRUE INSERT OR             50460020
*        CP14 PART2 (VARIABLE LENGTH RECORDS) WHEN PART1 HAS            50520020
*        BEEN EXECUTED.                                                 50580020
*                                                                       50640020
         USING CP10B,R10                                                50700020
APPCD10  EQU   *                        *                               50760020
         TM    DCBRECFM,VLR             TEST FOR VLR                    50820020
         BO    APPCD4                   BO MEANS VLR                    50880020
         BAL   R3,APPSUB                CP PREFIX ROUTINE               50940020
         TM    CB53+FOUR,OVFLO          TEST FOR OVERFLOW        A43729 50950021
         BZ    APPCD10A                 NOT OVERFLOW             A43729 50960021
         MVI   IDXOVFLO,OVFLO           TURN ON OVERFLOW         A43729 50970021
APPCD10A EQU   *                        *                        A43729 50980021
         TM    DCBOPTCD,WRTCHK          TEST FOR WC - RPS CP10B WC ONLY 51000020
         BZ    APPSUB0                  BZ MEANS NOT WC-CONVERT SECTOR  51060020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    51120020
         BZ    APPCD101                 BZ MEANS NON-RPS                51180020
         MVC   CB540(FOUR),IOBCCW1      SET UP SET SECTOR CCW           51240020
         B     APPSUB1                  SECTOR CONVERT ROUTINE          51480020
*                                                                       51540020
APPCD101 EQU   *                        *                               51600020
         MVI   CB540,NOP                CHANGE SET SECTOR TO NOP        51660020
         B     APPNOMO                  COMMON EXIT                     51720020
         EJECT                                                          51780020
*                                                                       51840020
*        APPENDAGE CODE 12, SET-UP CP14 OR CP14 PART1 (FIXED LENGTH     51900020
*        RECORDS WITH USER WORD AREA AND VARIABLE LENGTH RECORDS)       51960020
*        FOR SET-UPS 1, 2, AND 5.                                       52020020
*                                                                       52080020
         USING CH15,R10                                                 52140020
APP12AA  EQU   *                        *                               52200020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    52260020
         BZ    APPCD121                 BZ MEANS NON-RPS                52320020
         MVC   HEAD(THREE),CH23+FIVE    MOVE HHR TO HEAD                52380020
         BAL   R3,APPSUBX               SECTOR CONVERT ROUTINE          52440020
*                                                                       52500020
APPCD120 EQU   *                        *                               52560020
         CLI   CH180,TIC                CH180 TIC TO CH19               52620020
         BE    APPTST18                 YES SKIP SECTOR CONVERSION      52680020
         TM    CH18+FOUR,CC             TEST FOR COMMAND CHAIN          52740020
         BZ    APPNOMO                  NO CC - EXIT                    52800020
         LA    R11,IOBSECT+TWO          SECTOR ADDR PLUS 2              52860020
         ST    R11,CH180                PUT SECTOR ADDR IN CCW          52920020
         MVI   CH180,SETSECT            MOVE IN SET SECTOR CMD CODE     52980020
         L     R3,CH18A                 SEARCH ADDR                     53040020
         MVC   HEAD(THREE),CH23+FIVE    MOVE HHR TO HEAD                53100020
         BAL   R3,APPSUBX               SECTOR CONVERT ROUTINE          53160020
APPTST18 EQU   *                        *                               53220020
         TM    CH18C+FOUR,CC            TEST FOR COMMAND CHAIN          53280020
         BZ    APPNOMO                  BNE MEANS NO - EXIT             53340020
APP122BB EQU   *                        *                               53400020
         LA    R11,IOBSECT+THREE        SECTOR ADDR PLUS 3              53460020
         ST    R11,CH200                PUT SECTOR ADDR IN CCW          53520020
         MVI   CH200,SETSECT            MOVE IN SET SECTOR CMD CODE     53580020
APP122DD EQU   *                        *                               53640020
         L     R3,CH20                  GET CCHHR               SA68845 53690002
         MVC   HEAD(THREE),TWO(R3)      MOVE HHR TO HEAD        SA68845 53692002
         TM    CH22+FOUR,CC             TEST FOR CMD CHAIN              53700020
         BZ    APP122EE                 NO - EXIT                       53760020
         ST    R11,CH220                                                53820020
         MVI   CH220,SETSECT                                            53880020
APP122EE EQU   *                        *                               54060020
         LA    R3,APPNOMO               COMMON EXIT                     54120020
         B     APPSUBX                  SECTOR CONVERT ROUTINE          54180020
*                                                                       54240020
APPCD121 EQU   *                        *                               54300020
         MVI   CH180,NOP                CHANGE SET SECTOR TO NOPS       54360020
APP122CC EQU   *                        *                               54420020
         MVI   CH200,NOP                CHANGE SET SECTORS TO NOPS      54480020
APP122CA EQU   *                        *                               54540020
         MVI   CH220,NOP                                                54600020
         B     APPNOMO                  COMMON EXIT                     54660020
*                                                                       54720020
APPCD122 EQU   *                        *                               54780020
         TM    RPS(R7),RPSTST           TEST FOR RPS             A45232 54781021
         BZ    APP122CB                 NO, NO PREFIX NEEDED     A45232 54782021
         L     R3,CH15                  SEARCH ADDR              MXXXX  54782400
         MVC   HEAD(THREE),TWO(R3)      SETUP HEAD AND REC NO.   A45232 54783000
         BAL   R3,APPSUBX               CALCULATE SECTOR FOR     A45232 54784021
*                                       PRFX                     A45232 54785021
APP122CB EQU   *                        *                        A45232 54786021
         TM    CH18+FOUR,CC             TEST FOR COMMAND CHAIN          54840020
         BZ    APPNOMO                  BZ MEANS NOT CMD CHAIN - EXIT   54900020
         LA    R10,LCH18-EIGHT(R10)     LENGTH OF COMMON                54960020
APP122AA EQU   *                        *                               55020020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    55080020
         BO    APP124A                  BO MEANS RPS                    55140000
*                                                                       55200020
*                                                                       55260020
         USING CH200,R10                                                55320020
         MVI   CH200,NOP                CHANGE SET SECTOR TO NOP        55380020
         B     APPNOMO                  COMMON EXIT                     55440020
*                                                                       55500020
APP124A  EQU   *                        *                               55740020
         LA    R11,IOBSECT+THREE        SECTOR ADDR PLUS 3              55800020
         ST    R11,CH200                PUT SECTOR ADDR IN CCW          55860020
         MVI   CH200,SETSECT            MOVE IN SET SECTOR CMD CODE     55920020
         L     R3,CH20                  SEARCH ADDR                     55980020
         MVC   HEAD(THREE),TWO(R3)      MOVE HHR TO HEAD                56040020
         LA    R3,APPNOMO               COMMON EXIT                     56100020
         B     APPSUBX                  SECTOR CONVERT ROUTINE          56160020
         EJECT                                                          56220020
*                                                                       56280020
*        APPENDAGE CODE 14, SET-UP CP15                                 56340020
*                                                                       56400020
         USING CP15,R10                                                 56460020
APPCD14  EQU   *                        *                               56520020
         BAL   R3,APPSUB                CP PREFIX ROUTINE               56580020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    56640020
         BZ    APPCD141                 BZ MEANS NON-RPS                56700020
         MVI   IOBSECT,ZERO             SET SECTOR TO 0 FOR COCR A50669 56750000
         MVI   IDXOVFLO,INDEX           USE INDEX CALCULATION           56760020
         LA    R11,ONE(R11)             SECTOR ADDR IS IOBSECT+1        56820020
         ST    R11,CI1D                 STORE SECTOR ADDR               56880020
         MVI   CI1D,SETSECT             MOVE IN SET SECTOR CMD CODE     56940020
         B     APPSUB1                  SECTOR CONVERT ROUTINE          57000020
*                                                                       57060020
APPCD141 EQU   *                        *                               57120020
         MVI   CI1D,NOP                 CHANGE SET SECTOR TO NOP        57180020
         B     APPNOMO                  COMMON EXIT                     57240020
         EJECT                                                          57300020
*                                                                       57360020
*        APPENDAGE CODES 15, 16, SET-UP CP16 FOR TRUE INSERT OR         57420020
*        ADDITION TO END OF DATA SET                                    57480020
*                                                                       57540020
         USING CP16,R10                                                 57600020
APPCD15  EQU   *                        *                               57660020
         BAL   R3,APPSUB                CP PREFIX ROUTINE               57720020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    57780020
         BZ    APPCD151                 BZ MEANS NON-RPS                57840020
         MVC   CJ4A(FOUR),IOBCCW1       SET UP SET SECTOR CCW           57900020
         MVI   IDXOVFLO,OVFLO           TURN ON OVERFLOW                57960020
         B     APPSUB1                  SECTOR CONVERT ROUTINE          58020020
*                                                                       58080020
APPCD151 EQU   *                        *                               58140020
         MVI   CJ4A,NOP                 CHANGE SECTOR TO NOP            58200020
         B     APPNOMO                  COMMON EXIT                     58260020
         EJECT                                                          58320020
*                                                                       58380020
*        APPENDAGE CODE 17, SET-UP CP17 FOR TRACK INDEX OR              58440020
*        CP14 PART 2 (VARIABLE LENGTH RECORDS) WHEN PART 1 HAS NOT      58500020
*        BEEN EXECUTED (NO OVERFLOW).                                   58560020
*        APPENDAGE CODES 18, 19, SET-UP CP17 FOR TRACK INDEX AND        58620020
*        WHEN IT IS TO BE STARTED OR CONTINUED FOR HIGHER LEVEL INDEXES 58680020
*                                                                       58740020
         USING CP17,R10                                                 58800020
APPCD17  EQU   *                        *                               58860020
         TM    DCBRECFM,VLR             TEST FOR VLR                    58920020
         BO    APPCD4                   B0 MEANS VLR - CP14             58980020
APPCD170 EQU   *                        *                               59040020
         BAL   R3,APPSUB                CP PREFIX ROUTINE               59100020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    59160020
         BZ    APPCD171                 BZ MEANS NON-RPS                59220020
         MVI   IDXOVFLO,INDEX           USE INDEX CALCULATION           59280020
         MVC   CK30(FOUR),IOBCCW1       SET UP SET SECTOR CCW           59340020
         TM    DCBOPTCD,WRTCHK          TEST FOR WC                     59400020
         BZ    APPSUB1                  BZ MEANS NOT-WC -CONVERT SECTOR 59460020
         MVC   CK70(FOUR),IOBCCW1       SET UP SET SECTOR CCW           59520020
         B     APPSUB1                  SECTOR CONVERT ROUTINE          59580020
*                                                                       59640020
APPCD171 EQU   *                        *                               59700020
         MVI   CK30,NOP                 CHANGE SET SECTOR TO NOP        59760020
         TM    DCBOPTCD,WRTCHK          TEST FOR WC                     59820020
         BZ    APPNOMO                  BZ MEANS NOT-WC                 59880020
         MVI   CK70,NOP                 CHANGE SET SECTOR TO NOP        59940020
         B     APPNOMO                  COMMON EXIT                     60000020
         EJECT                                                          60060020
*                                                                       60120020
*        APPENDAGE CODE 20, SET-UP CP9A, OR CP11A, OR CP12A,            60180020
*        OR CP13A, OR CP12AV.                                           60240020
*                                                                       60300020
APPCD20  EQU   *                        *                               60360020
         BAL   R3,APPSUB                CP PREFIX ROUTINE               60420020
         TM    DCBRECFM,VLR             TEST FOR VLR                    60480020
         BZ    APPCD202                 BRANCH MEANS NOT VLR            60540020
         LA    R9,IOBDADAD+THREE        CP12A SEARCH ADDRESS            60600020
         L     R3,ZERO(R10)             CP SEARCH ADDRESS               60660020
         LA    R3,ZERO(R3)              CLEAR HIGH ORDER BYTE           60720020
         CR    R9,R3                    IS SEARCH ADDRESS CP12A         60780020
         BNE   APPCD202                 BNE MEANS NO - USE CP12AV       60840020
*                                                                       60900020
         USING CD0A1,R10                                                60960020
         LA    R3,CD3                   TIC TO CD3                      61020020
         L     R9,CD0C                  IF TIC ADDR IN CD0C             61080020
         LA    R9,ZERO(R9)              EQUAL ADDR OF CD3               61140020
         CR    R9,R3                    THEN NO NEED TO SET UP SETSECT  61200020
         BE    APPCD202                 BRANCH MEANS YES                61260020
         CLI   LCD0D(R10),RDATA         DOES CP START AT CD1            61320020
         BE    APPCD202                 BRANCH MEANS YES                61380020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    61440020
         BZ    APPCD201                 BZ MEANS NON-RPS                61500020
         MVC   CD0D(FOUR),IOBCCW1       SET UP SET SECTOR CCW           61560020
         MVC   APPRECNO(ONE),HZERO      REC. NO. ALWAYS 0 FOR 12AV      61620020
         LA    R3,APPNOMO               RETURN TO COMMON EXIT           61680020
         B     APPSUBX                  SECTOR CONVERT ROUTINE          61740020
*                                                                       61800020
APPCD201 EQU   *                        *                               61860020
         MVI   CD0D,NOP                 CHANGE SET SECTOR TO NOP        61920020
         B     APPNOMO                  COMMON EXIT                     61980020
*                                                                       62040020
APPCD202 EQU   *                        *                               62100020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    62160020
         BZ    APPNOMO                  BRANCH MEANS NON-RPS - EXIT     62220020
         B     APPSUB1                  SECTOR CONVERT ROUTINE          62280020
         EJECT                                                          62340020
*                                                                       62400020
*        APPENDAGE CODE 21, SET-UP CP9B, OR CP11B, OR CP12B,            62460020
*        CP13B, OR CP12BV.                                              62520020
*                                                                       62580020
APPCD21  EQU   *                        *                               62640020
         BAL   R3,APPSUB                CP PREFIX ROUTINE               62700020
         TM    DCBRECFM,VLR             TEST FOR VLR                    62760020
         BZ    APPCD212                 BRANCH MEANS NOT VLR            62820020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    62880020
         BZ    APPCD211                 BZ MEANS NON-RPS                62940020
*                                                                       63000020
         USING CP12B,R10                                                63060020
         CLI   LCE0C(R10),SHAEQ         DOES CP START AT CE1            63120020
         BE    APPCD210                 BRANCH MEANS YES                63180020
         LA    R11,ONE(R11)             SECTOR ADDR = A(IOBSECT+1)      63240020
         ST    R11,CE0C                 PUT SECTOR ADDR IN CCW          63300020
         MVI   CE0C,SETSECT             MOVE IN SET SECTOR CMD CODE     63360020
APPCD210 EQU   *                        *                               63420020
         TM    DCBOPTCD,WRTCHK          TEST FOR WC                     63480020
         BZ    APPSUB1                  BZ MEANS NOT WC-CONVERT SECTOR  63540020
APPCD21W EQU   *                        *                               63600020
         L     R10,IOBCCWAD             ADDR OF CP8                     63660020
         USING CP8,R10                                                  63720020
         L     R10,CB2+FOUR             ADDR OF CP123                   63780020
         USING CP123,R10                                                63840020
         MVI   CEA00,SETSECT            MOVE IN SET SECTOR CMD CODE     63900020
         ST    R11,CEA3                 PUT SECTOR ADDR IN CCW          63960020
         MVI   CEA3,SETSECT             MOVE IN SET SECTOR CMD CODE     64020020
         B     APPSUB1                  SECTOR CONVERT ROUTINE          64080020
*                                                                       64140020
APPCD211 EQU   *                        *                               64200020
         USING CP12B,R10                                                64260020
         CLI   LCE0C(R10),SHAEQ         DOES CP START AT CE1            64320020
         BE    APPCD21X                 BRANCH MEANS YES                64380020
         MVI   CE0C,NOP                 CHANGE SET SECTORS TO NOPS      64440020
APPCD21X EQU   *                        *                               64500020
         TM    DCBOPTCD,WRTCHK          TEST FOR WC                     64560020
         BZ    APPNOMO                  BRANCH MEANS NOT WC - EXIT      64620020
APPCD21Y EQU   *                        *                               64680020
         L     R10,IOBCCWAD             ADDR OF CP8                     64740020
         USING CP8,R10                                                  64800020
         L     R10,CB2+FOUR             ADDR OF CP123                   64860020
         USING CP123,R10                                                64920020
         MVI   CEA00,NOP                CHANGE SET SECTORS TO NOPS      64980020
         MVI   CEA3,NOP                                                 65040020
         B     APPNOMO                  COMMON EXIT                     65100020
*                                                                       65160020
APPCD212 EQU   *                        *                               65220020
         TM    DCBOPTCD,WRTCHK          TEST FOR WC                     65280020
         BZ    APPSUB0                  BZ MEANS NOT WC-CONVERT SECTOR  65340020
         TM    DCBRECFM,BLOCKED         TEST FOR BLOCKED                65400020
         BZ    APPCD216                 BZ MEANS UNBLOCKED              65460020
         CLC   HZERO,DCBSMSW            TEST FOR USER WA                65520020
         BNE   APPCD218                 BE MEANS USER WA                65580020
*                                                                       65640020
         USING CP11B,R10                                                65700020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    65760020
         BZ    APPCD214                 BZ MEANS NON-RPS                65820020
         MVC   CC60(FOUR),IOBCCW1       SET UP SET SECTOR CCW           65880020
         B     APPSUB1                  SECTOR CONVERT ROUTINE          65940020
*                                                                       66000020
APPCD214 EQU   *                        *                               66060020
         MVI   CC60,NOP                 CHANGE SET SECTOR TO NOP        66120020
         B     APPNOMO                  COMMON EXIT                     66180020
*                                                                       66240020
APPCD216 EQU   *                        *                               66300020
         CLC   HZERO,DCBSMSW            TEST FOR USER WA                66360020
         BNE   APPCD218                 BNE MEANS USER WA               66420020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    66480020
         BZ    APPCD217                 BZ MEANS NON-RPS                66540020
         USING CP9B,R10                                                 66600020
         CLI   CB36-CB34(R10),WKD       CP START AT CB34                66660020
         BNE   APPSUB1                  NO-CONVERT SECTOR               66720020
         MVC   CB370(FOUR),IOBCCW1      SETUP SET SECTOR CCW            66780020
         B     APPSUB1                  SECTOR CONVERT ROUTINE          66840020
*                                                                       66900020
APPCD217 EQU   *                        *                               66960020
         CLI   CB36-CB34(R10),WKD       CP START AT CB34                67020020
         BNE   APPNOMO                  NO - EXIT                       67080020
         MVI   CB370,NOP                CHANGE SET SECTOR TO NOP        67140020
         B     APPNOMO                  COMMON EXIT                     67200020
*                                                                       67260020
APPCD218 EQU *                          *                               67320020
         L     R10,IOBCCWAD             ADDR OF CP8                     67380020
         USING CP8,R10                                                  67440020
         L     R10,CB2+FOUR             ADDR OF CP123                   67500020
         USING CP123,R10                                                67560020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    67620020
         BZ    APPCD219                 BZ MEANS NON-RPS                67680020
         ST    R11,CEA00                PUT SECTOR ADDR IN CCW   M5874  67710020
         MVI   CEA00,SETSECT            CHANGE SET SECTOR TO NOP        67740020
         B     APPNOMO                  COMMON EXIT                     67800020
*                                                                       67860020
APPCD219 EQU   *                        *                               67920020
         MVI   CEA00,NOP                CHANGE SET SECTOR TO NOP        67980020
         B     APPNOMO                  COMMON EXIT                     68040020
         EJECT                                                          68100020
*                                                                       68160020
*        APPENDAGE CODE 22, SET-UP CP9C, OR CP123W, OR CP123WV.         68220020
*                                                                       68280020
APPCD22  EQU   *                        *                               68340020
         TM    DCBRECFM,VLR             TEST FOR VLR                    68400020
         BO    APPCD222                 BO MEANS VLR - CP123            68460020
         CLC   HZERO,DCBSMSW            TEST FOR USER WA                68520020
         BNE   APPRET                   IF USER WA EXIT                 68580020
         BAL   R3,APPSUB                CP PREFIX ROUTINE               68640020
         TM    DCBOPTCD,WRTCHK          TEST FOR WC                     68700020
         BZ    APPSUB0                  BZ MEANS NOT WC-CONVERT SECTOR  68760020
         USING CP9C,R10                                                 68820020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    68880020
         BZ    APPCD221                 BZ MEANS NON-RPS                68940020
         CLI   CB43C-CB430(R10),RKD     DOES CP START AT CB43A          69000020
         BE    APPSUB0                  BE MEANS YES - CONVERT SECTOR   69060020
         MVC   CB430(FOUR),IOBCCW1      SET UP SET SECTOR CCW           69120020
         B     APPSUB1                  SECTOR CONVERT ROUTINE          69180020
*                                                                       69240020
APPCD221 EQU   *                        *                               69300020
         CLI   CB43C-CB430(R10),RKD     DOES CP START AT CB43A          69360020
         BE    APPNOMO                  BE MEANS YES - EXIT             69420020
         MVI   CB430,NOP                CHANGE SET SECTOR TO NOP        69480020
         B     APPNOMO                  COMMON EXIT                     69540020
APPCD222 EQU   *                        *                               69600020
         TM    DCBOPTCD,WRTCHK          TEST FOR WC                     69660020
         BZ    APPNOMO                  BZ MEANS NOT WC - EXIT          69720020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    69780020
         BO    APPCD21W                 BO MEANS RPS                    69840020
         B     APPCD21Y                 NON-RPS INIT                    69900020
         EJECT                                                          69960020
*                                                                       70020020
*        APPENDAGE CODE 23, SET-UP CP10A FOR ADDITION TO END OF         70080020
*        DATA SET                                                       70140020
*                                                                       70200020
         USING CP10A,R10                                                70260020
APPCD23  EQU   *                        *                               70320020
         BAL   R3,APPSUB                CP PREFIX ROUTINE               70380020
         TM    DCBOPTCD,WRTCHK          TEST FOR WC                     70440020
         BZ    APPSUB0                  BZ MEANS NOT WC-CONVERT SECTOR  70500020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    70560020
         BZ    APPCD231                 BZ MEANS NON-RPS                70620020
         MVC   CB500(FOUR),IOBCCW1      SET UP SET SECTOR CCW           70680020
         B     APPSUB1                  SECTOR CONVERT ROUTINE          70740020
*                                                                       70800020
APPCD231 EQU   *                        *                               70860020
         MVI   CB500,NOP                CHANGE SET SECTOR TO NOP        70920020
         B     APPNOMO                  COMMON EXIT                     70980020
         EJECT                                                          71040020
*                                                                       71100020
*        APPENDAGE CODE 24, SET-UP CP12C OR CP13C.                      71160020
*                                                                       71220020
APPCD24  EQU   *                        *                               71280020
         BAL   R3,APPSUB                CP PREFIX ROUTINE               71340020
         TM    DCBOPTCD,WRTCHK          TEST FOR WC                     71400020
         BZ    APPSUB0                  BZ MEANS NOT WC-CONVERT SECTOR  71460020
         TM    DCBRECFM,BLOCKED         TEST FOR BLOCKED                71520020
         BO    APPCD242                 BO MEANS BLOCKED                71580020
         USING CP12C,R10                                                71640020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    71700020
         BZ    APPCD241                 BZ MEANS NON-RPS                71760020
         MVC   CL30(FOUR),IOBCCW1       SET UP SET SECTOR CCW           71820020
         B     APPSUB1                  SECTOR CONVERT ROUTINE          71880020
*                                                                       71940020
APPCD241 EQU   *                        *                               72000020
         MVI   CL30,NOP                 CHANGE SET SECTOR TO NOP        72060020
         B     APPNOMO                  COMMON EXIT                     72120020
*                                                                       72180020
         USING CP13C,R10                                                72240020
APPCD242 EQU   *                        *                               72300020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    72360020
         BZ    APPCD243                 BZ MEANS NON-RPS                72420020
         MVC   CL70(FOUR),IOBCCW1       SET UP SECTOR CCW               72480020
         B     APPSUB1                  SECTOR CONVERT ROUTINE          72540020
*                                                                       72600020
APPCD243 EQU   *                        *                               72660020
         MVI   CL70,NOP                 CHANGE SECTOR TO NOP            72720020
         B     APPNOMO                  COMMON EXIT                     72780020
         EJECT                                                          72840020
*                                                                       72900020
*        THIS ROUTINE DETERMINES IF A CHANNEL PROGRAM PREFIX            72960020
*        IS NEEDED OR WANTED. IF NEEDED THE CHANNEL PROGRAM  PREFIX     73020020
*        ADDRESS IS PLACED IN IOBSTART AND THE CHANNEL PROGRAM          73080020
*        ADDRESS IS PLACED IN THE TIC ADDRESS OF THE CHANNEL            73140020
*        PROGRAM PREFIX. IF THE PREFIX IS UNWANTED THEN THE CHANNEL     73200020
*        ADDRESS IS PLACED IN IOBSTART. THE TWO PREFIX CCWS ARE:        73260020
*        IOBCCW1  CCW   SETSECT,A(IOBSECT),CC,1                         73320020
*        IOBCCW2  CCW   TIC,A(CP),0,0                                   73380020
*                                                                       73440020
*                                                                       73500020
APPSUB   EQU   *                        *                               73560020
         LA    R9,IOBCCW1               ADDR OF PREFIX INTO R9          73620020
         CR    R10,R9                   IOBSTART POINT TO PREFIX        73680020
         BE    APPPFXOK                 BE-YES PREFIX IS OK             73740020
         CLI   ZERO(R10),SIDEQ          CP START WITH SIDEQ             73800020
         BCR   7,R3                     NO-DON'T USE A PREFIX           73860020
*                                                                       73920020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    73980020
         BCR   8,R3                     IF NOT RPS RETURN               74040020
*                                                                       74100020
         ST    R10,IOBCCW2              CP ADDR INTO TIC ADDR           74160020
         MVI   IOBCCW2,TIC              MOVE IN TIC COMMAND CODE        74220020
         LA    R10,IOBCCW1              ADDR OF CHANNEL PROGRAM PREFIX  74280020
         STH   R10,IOBSTART+ONE         INTO IOBSTART                   74340020
         SRL   R10,16                   SHIFT TO LOW ORDER HALF         74400020
         STC   R10,IOBSTART             STORE REMAINING BYTE            74460020
         ST    R11,IOBCCW1              SECTOR ADDR INTO IOBCCW1        74613400
         MVI   IOBCCW1,SETSECT          MOVE IN SETSECT COM. CODE       74626700
         MVC   IOBCCW1+FOUR(FOUR),CCDL  TURN ON CC AND DATA LENGTH      74640020
         B     APPLD10                  BRANCH TO SETUP R10             74700020
APPPFXOK EQU   *                        *                               74760020
         TM    RPS(R7),RPSTST           PREFIX OK BUT IS IT WANTED      74820020
         BZ    APPNOPF1                 BZ MEANS NO IT'S NOT WANTED     74880020
         B     APPLD10                  BRANCH TO SETUP REG 10          74940020
APPNOPF1 EQU   *                        *                               75000020
         MVC   IOBSTART(THREE),IOBCCW2+ONE CP ADDRESS INTO IOBSTART     75105000
APPLD10  EQU   *                        *                               75120020
         L     R10,IOBCCW2              ADDR OF CP INTO R10             75180020
         LA    R10,ZERO(R10)            CLEAR HIGH ORDER BYTE           75240020
         BR    R3                       RETURN                          75300020
         EJECT                                                          75360020
*                                                                     * 75420020
*        THIS ROUTINE SETS UP REGISTES AND BRANCH TO A ROUTINE        * 75480020
*        THAT CONVERTS SECTOR VALUES                                  * 75540020
*                                                                     * 75600020
APPSUB0  EQU   *                        *                               75660020
         TM    RPS(R7),RPSTST           TEST FOR RPS                    75720020
         BZ    APPNOMO                  BRANCH MEANS NON-RPS - EXIT     75780020
*                                                                       75840020
APPSUB1  EQU   *                        *                               75900020
         MVC   HEAD(THREE),IOBDADAD+FIVE MOVE HHR TO HEAD               75960020
         LA    R3,APPNOMO               COMMON EXIT ADDR FOR RETURN     76020020
*                                                                       76080020
APPSUBX  EQU   *                        *                               76140020
         CLI   APPRECNO,TWO55           IS RECORD NO. 255        A43729 76150021
         BNE   APPNOTFF                 NO                       A43729 76160021
         MVI   ZERO(R11),TWO55          YES, NOP SET SECTOR      A43729 76170021
         BR    R3                       RETURN                   A43729 76180021
APPNOTFF EQU   *                        *                        A43729 76190021
         LR    R12,R14                  SAVE REG 14              Y02072 76200002
         LR    R14,R11                  R14 = ADDR OF AREA FOR SECTOR   76260020
         IC    R9,DEVCODE(R7)           UCB + 19 = DEVICE TYPE CODE     76320020
         SLL   R9,24                    HIGH ORDER BYTE OF R14 =        76380020
         OR    R14,R9                   DEVICE TYPE CODE                76440020
         ST    R10,DCBRELSE             SAVE CP PTR              M6178  76500020
         LR    R13,R0                   SAVE REG 0                      76560020
         SR    R0,R0                    CLEAR REG 0                     76620020
         TM    IDXOVFLO,INDEX           INDEX ENTRY                     76680020
         BZ    APPNOIDX                 NO, TEST FOR SHARED TRACK       76740020
         LH    R0,INDEXLEN              USE 10 AS BLKSIZE               76800020
         B     APPLINK1                 GO SETUP KEY LENGTH             76860020
APPNOIDX EQU   *                        *                               76920020
         SR    R10,R10                  CLEAR REG 10                    76980020
         SR    R11,R11                  CLEAR REG 11                    77040020
*                                                                       77090002
* CALCULATE BB FOR SHARED TRACK=(R-F)BLKSIZE+(F-1)(10)+KEYLENGTH(R-1)   77100020
* WHERE R IS THE TARGET REC NO AND F IS THE REC NO OF PRIME             77160020
*                                                                       77210002
         TM    IDXOVFLO,OVFLO           TEST FOR OVERFLOW               77220020
         BO    APPNOSHR                 BZ MEANS NO OVERFLOW            77280020
         CLC   HEAD(TWO),DCBFIRSH       SAME HEAD                       77340020
         BNE   APPLINK                  NO-CAN'T BE SHARED TRACK        77400020
         CLI   DCBFIRSH+TWO,ONE         SHR TRACK ONLY R NOT 1          77460020
         BE    APPLINK                  YES IT'S ONE - NOT SHARED       77520020
         IC    R10,APPRECNO             R10=R                           77580020
         IC    R11,DCBFIRSH+TWO         R11=F                           77640020
         CR    R10,R11                  R GREATER THAN F                77700020
         BNH   APPFHI                   NO USE ZERO                     77760020
         LR     R0,R10                  YES USE R-F                     77820020
         SR     R0,R11                  R0=R-F                          77880020
         MH     R0,DCBBLKSI             R0=(R-F)(BLKSIZE)               77940020
APPFHI   EQU    *                       *                               78000020
         BCTR   R11,R0                  R11=F-X,X=1                     78060020
         CR     R10,R11                 R=F-1                           78120020
         BNE    APPFHI1                 NO USE F-1                      78180020
         BCTR   R11,R0                  YES USE F-X,X=2                 78240020
APPFHI1  EQU   *                        *                               78300020
         LTR    R11,R11                 IS R11 MINUS                    78360020
         BM     APP1IDX                 YES USE ZERO                    78420020
         MH     R11,INDEXLEN            R11=(F-X)(10)                   78480020
         AR     R0,R11                  R0=(R-F)(BLKSIZE)+(F-1)(10)     78540020
APP1IDX  EQU    *                       *                               78600020
         SR     R11,R11                 R11=0                           78660020
         IC     R11,APPRECNO            R11=R                           78720020
         LTR    R11,R11                 R11=0                           78780020
         BZ     APPSETI                 YES R0 ALL SET                  78840020
         BCTR   R11,R0                  R11=R-1                         78900020
         IC     R10,DCBKEYLE            R10=KEYLENGTH                   78960020
         MR     R10,R10                 R11=(R-1)(KEYLENGTH)            79020020
         AR     R0,R11                  R0=(R-F)(BLKSIZE)+(F-1)(10)+    79080020
*                                       (R-1)(KEYLENGTH)                79140020
         B     APPSETI                  USE VLR CALCULATION             79200020
APPNOSHR EQU   *                        *                               79260020
         LH    R0,LINKLEN               LOAD LENGTH OF LINK FIELD       79320020
         TM    DCBRECFM,VLR             TEST FOR VLR                    79380020
         BO    APPVLR1                  BO MEANS VLR                    79440020
         AH    R0,DCBLRECL              FOR OVERFLOW DD=LRECL           79500020
         B     APPLINK1                 GO SETUP KEYLENGTH              79560020
APPLINK  EQU   *                        *                               79620020
         TM    DCBRECFM,VLR             TEST FOR VLR                    79680020
         BO    APPVLR                   BO MEANS VLR                    79740020
         AH    R0,DCBBLKSI              R0 = DDKR FOR FIXED             79800020
APPLINK1 EQU   *                        *                               79860020
         SLL   R0,8                     DD = BLOCK SIZE                 79920020
*                                                                       79980020
         IC    R0,DCBKEYLE              K = KEY LENGTH                  80040020
         B     APPSETR                  BRANCH TO SETUP R               80100020
*                                                                       80160020
APPVLR   EQU   *                        *                               80220020
         TM    DCBRECFM,BLOCKED         TEST FOR BLOCKED                80280020
         BO    APPVLRB                  BO MEANS BLOCKED                80340020
APPVLR1  EQU   *                        *                               80400020
         AH    R0,BDW                   R0 = BBIR FOR VLR               80460020
         SR    R9,R9                    CLEAR REG 9                     80520020
         IC    R9,DCBKEYLE              FOR UNBLOCKED                   80580020
         AR    R0,R9                    BB = 4 + KEY LENGTH             80640020
         AH    R0,DCBRKP                + RKP  ( 4 FOR THE BDW )        80700020
         B     APPSETI                  BRANCH TO SETUP I               80760020
*                                                                       80820020
APPVLRB  EQU   *                        *                               80880020
         AH    R0,DCBBLKSI              IF BLOCKED                      80940020
         SH    R0,DCBLRECL              BB = BLKSIZE - LRECL            81000020
*                                                                       81060020
APPSETI  EQU   *                        *                               81120020
         O     R0,HIBIT                 SET HIGH BIT OF R0 ON           81180020
         SLL   R0,8                     I= 0 FOR NON-KEYED RECORDS OR   81240020
         IC    R0,KEYED                 1 FOR KEYED - ISAM ALWAYS KEYED 81300020
APPSETR  EQU   *                        *                               81360020
         SLL   R0,8                     MAKE ROOM FOR R                 81420020
         IC    R0,APPRECNO              INSERT RECORD NO.               81480020
         LR    R4,R15                   SAVE BASE                       81540020
         L     R15,CVTPTR               C(R15)=A(CVT)                   81600020
         USING CVT,R15                                                  81660020
         L     R15,CVT0SCR1             C(R15)=A(SECTOR CONVERT RTN)    81720020
         LR    R2,R14                   SET UP SECTOR RECEIVE ADDR      81780020
         BALR  R14,R15                  BRANCH TO THAT ROUTINE          81840020
         LR    R15,R4                   RESTORE BASE                    81900020
         USING IGG019JH,R15                                             81960020
         L     R2,RQEIOB                RESTORE IOB POINTER             82200000
         LR    R14,R12                  RESTORE REG 14           Y02072 82260002
         LR    R0,R13                   RESTORE REG 0                   82320020
         L     R4,IOBDCBAD-ONE          RESTORE DCB POINTER             82380020
         LA    R4,ZERO(R4)              CLEAR HIGH ORDER BYTE           82440020
         L     R10,DCBRELSE             RESTOR CP PTR            M6178  82470020
         LA    R11,IOBSECT              RESTORE SECTOR ADDR             82500020
         BR    R3                       RETURN                          82560020
         EJECT                                                          82620020
*                                                                       82680020
**********************************************************************  82740020
***********************  EQUATES AND CONSTANTS  **********************  82800020
**********************************************************************  82860020
*                                                                       82920020
         DS    0F                       FULLWORD BOUNDARY               82980020
HIBIT    DC    X'00008000'              TURN ON HI ORDER BIT            83040020
HZERO    DC    H'0'                     X'0000'                         83100020
INDEXLEN DS    0H                       LENGTH OF INDEX ENTRIES         83160020
LINKLEN  DC    H'10'                    AND OVERFLOW LINK FIELD (10)    83220020
BDW      DC    X'0004'                  BLOCK DISCRIPTOR WORD LENGTH    83280020
CCDL     DC    X'40000001'              CC AND DATA LENGTH              83340020
KEYED    DC    X'01'                    I IN BBIR ALWAYS 1 FOR ISAM     83400020
INVAPPCD DC    H'0'                     PROGCHK FOR BAD APPCD  @ZA26522 83420037
TWOFOUR  DC    X'0018'                  MAX VALUE FOR APPCD    @ZA26522 83440037
ZERO     EQU   X'00'                    0                               83460020
ONE      EQU   X'01'                    1                               83520020
TWO      EQU   X'02'                    2                               83580020
THREE    EQU   X'03'                    3                               83640020
FOUR     EQU   X'04'                    4                               83700020
FIVE     EQU   X'05'                    5                               83760020
SEVEN    EQU   X'07'                    7                               83820020
EIGHT    EQU   X'08'                    8                               83880020
RPSTST   EQU   X'10'                    RPS MASK FOR RPS TESTING        83940020
INDEX    EQU   RPSTST                   INDEX ENTRY MASK                84000020
BLOCKED  EQU   RPSTST                   BLOCKED RECORDS MASK            84060020
WA11     EQU   11                       WORK AREA PLUS 11               84120020
RPS      EQU   17                       UCB + 17 = RPS BIT              84180020
DEC17    EQU   17                       OFFSET OF TIC IN CAW     A44446 84200021
CAW      EQU   X'48'                    LOCATION OF CAW          A44446 84220021
DEVCODE  EQU   19                       UCB + 19 = DEVICE TYPE CODE     84240020
OVFLO    EQU   X'20'                    OVERFLOW TEST MASK              84300020
VLR      EQU   X'40'                    MASK FOR VLR TEST               84360020
WRTCHK   EQU   X'80'                    WRITE VALIDITY CHECK MASK       84420020
CCOFF    EQU   X'BF'                    MASK FOR TURNING OFF CC         84480020
MTOFF    EQU   X'7F'                    TURN OFF MULTITRACK             84540020
TWO55    EQU   X'FF'                    255                      A43729 84570021
KEYZERO  EQU   HZERO                    STORAGE PROTECT KEY 0    Y02072 84580002
*                                                                       84590002
PATCH    DC    XL((*-IGG019JH)/20)'00'  ZEROED PATCH AREA        Y02072 84592002
*                                                                       84594002
         EJECT                                                          84600020
IHARQE   DSECT                                                          84650000
         IECDRQE                                                 Y02072 84650402
         EJECT                                                          84706600
CVT      DSECT                                                          84713300
         CVT                                                            84720020
         SPACE 4                                                        84780002
         DCBD  DSORG=(IS)                                               84840020
         EJECT                                                          84900020
IHADEB   IGGDEBD                                                        84960020
         EJECT                                                          85020020
IHAIOB   IGGIOBD                                                        85080020
SAVE14   EQU   IOBCSW                   SAVE RETURN ADDR REG            85140020
IDXOVFLO EQU   IOBCSW+FOUR              TEST INDEX AND OVERFLOW         85200020
HEAD     EQU   IOBCSW+FIVE              HH OF SEARCH ADDR               85260020
APPRECNO EQU   IOBCSW+SEVEN             R OF SEARCH ADDR                85320020
         EJECT                                                          85380020
IGGWKNCP DSECT                                                          85440020
         IGGCPOPS                                                       85500020
CP1      DS    0D                                                       85560020
         IGGCP1                                                         85620020
CP2      DS    0D                                                       85680020
         IGGCP2                                                         85740020
CP4      DS    0D                                                       85800020
         IGGCP4                                                         85860020
         IGGCP5 OPTCD=W                                                 85920020
CP6      DS    0D                                                       85980020
         IGGCP6 OPTCD=W                                                 86040020
CP7      DS    0D                                                       86100020
         IGGCP7 OPTCD=W                                                 86160020
CP8      DS    0D                                                       86220020
         IGGCP8 OPTCD=W                                                 86280020
CP9A     DS    0D                                                       86340020
         IGGCP9A                                                        86400020
CP9B     DS    0D                                                       86460020
         IGGCP9B  OPTCD=W                                               86520020
CP9C     DS    0D                                                       86580020
         IGGCP9C  OPTCD=W                                               86640020
CP10A    DS    0D                                                       86700020
         IGGCP10A OPTCD=W                                               86760020
CP10B    DS    0D                                                       86820020
         IGGCP10B OPTCD=W                                               86880020
CP11A    DS    0D                                                       86940020
         IGGCP11A                                                       87000020
CP11B    DS    0D                                                       87060020
         IGGCP11B OPTCD=W                                               87120020
CP12A    DS    0D                                                       87180020
         IGGCP12A OPTCD=V                                               87240020
LCD0D    EQU   CD0D-CD0A1                                               87300020
CP12B    DS    0D                                                       87360020
         IGGCP12B OPTCD=V                                               87420020
LCE0C    EQU   CE0C-CE0                                                 87480020
CP12C    DS    0D                                                       87540020
         IGGCP12C OPTCD=W                                               87600020
CP13A    DS    0D                                                       87660020
         IGGCP13A                                                       87720020
CP13B    DS    0D                                                       87780020
         IGGCP13B                                                       87840020
CP13C    DS    0D                                                       87900020
         IGGCP13C OPTCD=W                                               87960020
CP14     DS    0D                                                       88020020
         IGGCP14 OPTCD=VW                                               88080020
LCH4     EQU   LCH3C+LCH3                                               88140020
*                                                                       88200020
CP15     DS    0D                                                       88260020
         IGGCP15                                                        88320020
CP16     DS    0D                                                       88380020
         IGGCP16 OPTCD=VW                                               88440020
CP17     DS    0D                                                       88500020
         IGGCP17 OPTCD=VW                                               88560020
CP123    DS    0D                                                       88620020
         IGGCP123 OPTCD=V                                               88680020
         END                                                            88740020
