19RN TITLE  '''IGG019RN''   PCI APPENDAGE'                              00000110
IGG019RN CSECT                                                          00000210
         SPACE 3                                                        00400110
*CHANGE ACTIVITY= AS FOLLOWS:                                           00400210
******************** MICROFICHE FLAGS *********************** SUPT CODE 00400310
*A158200-159600,258200-259500,528000-690100                      S99228 00400510
*C235300-235600,241000                                           S99228 00400610
*A273100-273116                                                  S22029 00400710
*A197500,325300,325600,326500                                    S22025 00400810
*A150400-151600,224600-225200,244400-245600                      S22026 00400910
*A268200-269600,742500-743500,269500,385150                      S22026 00401010
*C200000-210000,213200-215300,228000-234000,240000-240500,       S22026 00401110
*C244000,252000,266000,274000-345000,376000-377000,              S22026 00401210
*C382000-386100,401000-426000,570000,718000-719000               S22026 00401310
*D212000-212400,346000-358000,360000-366000,428000-450000,       S22026 00401410
*D504000-514000                                                  S22026 00401510
*A391000                                                          M6126 00401610
*A588000                                                         S21101 00401710
*C186500                                                         S21101 00401810
*A618000                                                          M6293 00401910
*C187000                                                          M6293 00402010
*C068000-072000,158000,164000-168000,476000,487700-487900        S22025 00402210
*C710000-715000                                                  S22025 00402410
*A323540,323690                                                 SA54277 00402610
*A246000                                                        SA55927 00402810
*A008000,200000                                                  S21903 00403010
*C200000                                                         S21903 00403210
*D010000                                                         S21903 00403410
*D257000                                                        SA61761 00403610
*A258150                                                        SA61761 00403810
*A151600                                                        SA52947 00404010
*C203000-204000                                                 SA52947 00404210
*D257000                                                        SA61761 00404310
*A130400-131600,133000,134600-135200,136000-137000,142300-143500,Y02027 00404410
*A494000-501500,520200-520620,720200-720400,721500-721800        Y02027 00404510
*C521400                                                         Y02027 00404610
*D136000,154000,156700-156800,494000-502000,520200-520640        Y02027 00404710
*D431750-431760                                                @ZA02070 00464710
*A431940                                                       @ZA02070 00524710
*A518040                                                       @SA62375 00527710
*D151600                                                       @SA70322 00530710
*A163600,285000                                                @SA70322 00533710
*C517720,517840                                                @SA70322 00536710
*D517650,517680                                                @SA70322 00539710
*C517960,518000                                                @SA70322 00542710
*C517920                                                       @SA70322 00545710
*D434490,434510                                                @ZA03738 00548710
*C434340                                                       @ZA03738 00551710
*D451120                                                       @ZA03738 00554710
*A451060                                                       @ZA03738 00557710
*C452440                                                       @ZA03738 00560710
*A517520                                                       @SA70322 00563710
*A516320                                                       @YA08787 00566710
*D516280                                                       @YA08787 00569710
*A215300                                                        OZ07068 00572710
*D198220-199270                                                 OZ07068 00575710
*C433050-433110                                                @OS76474 00578710
*D458000                                                       @OZ07832 00578810
*A458600                                                       @OS76718 00578910
*C452120,A452380                                               @OZ09940 00579010
*C418000                                                       @OX12568 00579110
         SPACE 3                                                        00599010
*********************************************************************** 00600010
*                                                                     * 00800010
*MODULE-NAME= IGG019RN                                           S21903 01000010
*                                                                S21903 01040010
*DESCRIPTIVE-NAME= TCAM PCI APPENDAGE                            S21903 01080010
*                                                                S21903 01120010
*COPYRIGHT= 'NONE'                                               S21903 01160010
*                                                                     * 01200010
*STATUS -- CHANGE LEVEL 5                                        Y01004 01400010
*                                                                     * 01600010
*FUNCTION -- IF PCI ON A WRITE IDLE LOOP - TO POST INITIAL REQUESTED  * 01800010
*   BUFFERS TO MH.                                                    * 02000010
*   TO REMOVE BUFFERS FROM THE CHANNEL PROGRAM WHICH HAVE ALREADY     * 02200010
*   BEEN PROCESSED AND IF REQUIRED, TO REQUEST ADDITIONAL BUFFERS.    * 02400010
*                                                                     * 02600010
*ENTRY POINTS -- 'IGG019RN' TO PERFORM THE FUNCTIONS OUTLINED ABOVE.  * 02800010
*   ENTRY IS BY A BR R15.                                             * 03000010
*                                                                     * 03200010
*INPUT -- IOS WILL HAVE THE FOLLOWING REGISTERS INITIALIZED UPON      * 03400010
*   ENTRY TO AN APPENDAGE.                                            * 03600010
*   R1 - RQE ADDRESS                                                  * 03800010
*   R3 - DEB ADDRESS                                                  * 04200010
*   R4 - DCB ADDRESS                                                  * 04400010
*   REGISTERS 0 - 9 MUST REMAIN THE SAME UPON RETURN TO IOS           * 04600010
*   REGISTER 9 MAY BE CHANGED AND MADE ZERO UPON RETURN TO IOS        * 04800010
*                                                                     * 05200010
*OUTPUT -- BUFFERS WILL BE ON THE DISABLED READY QUEUE POSTED TO THE  * 05400010
*   BUFFER RETURN QCB OR TO MH.  FOR AOS, THE REAL TIC AND DATA AD-   * 05600010
*   DRESSES IN THE CCW'S IN THESE BUFFERS WILL HAVE BEEN TRANSLATED   * 05660010
*   TO VIRTUAL.                                                       * 05720010
*   IF ADD WAS SPECIFIED IN THE LINE GROUP DCB, THE ERB WILL BE       * 05800010
*   POSTED TO REQUEST ADDITIONAL BUFFERS (FROM BUFFER REQUEST OR      * 06000010
*   DISK I/O) WITH A COUNT OR IF THE ERB WAS ALREADY POSTED, THE      * 06200010
*   COUNT WILL BE INCREASED.                                          * 06400010
*                                                                     * 06600010
*EXTERNAL ROUTINES -- IEAPTRV - AOS REAL-TO-VIRTUAL SUBROUTINE.       * 06800010
*                  -- TNTDCODE -                                      * 06840010
*                  -- IGG019R0 - SCAN SUBROUTINE OF TCAM LINE END     * 06880010
*   APPENDAGE - TO SCAN BSC LINE CONTROL FOR A START SEQUENCE, WHEN   * 06920010
*   THE BSC LINE IS RECEIVING.                                        * 06960010
*                  -- IEA0PT011 - POST ROUTINE - TO CROSS MEMORY Y02027 06970010
*   POST  TCAM'S ECB COMPLETE.                                   Y02027 06980010
*                                                                     * 07000010
*EXITS-NORMAL -- RETURN TO IOS VIA BR R14                             * 07200010
*                                                                     * 07400010
*EXITS-ERROR -- NONE                                                  * 07600010
*                                                                     * 07800010
*TABLES/WORK AREAS -- TCCWD,TAVTD,DCBD,TPRIOR                         * 08000010
*   AVTREADD,AVTBFRTB,AVTDSIOB                                        * 08200010
*                                                                     * 08400010
*ATTRIBUTES -- REUSABLE,REFRESHABLE, DISABLED                         * 08600010
*                                                                     * 08800010
*NOTES -- THE OPERATION OF THIS MODULE DOES NOT DEPEND UPON A         * 09000010
*   PARTICULAR REPRESENTATION OF THE EXTERNAL CHARACTER SET.          * 09200010
*                                                                     * 09400010
*********************************************************************** 09600010
*                                                                     * 09800010
*        REGISTERS                                                    * 10200010
*                                                                     * 10400010
R0       EQU   0                                                        10600010
R1       EQU   1                                                        10800010
RLCB     EQU   2                        LCB ADDRESS                     11200010
RDEB     EQU   3                        DEB ADDRESS              Y01004 11400010
RDCB     EQU   4                        DCB ADDRESS                     11600010
R5       EQU   5                                                        11800010
R6       EQU   6                                                        12000010
RPREFIX  EQU   6                        BUFFER ADDRESS           Y01004 12100010
R7       EQU   7                                                        12200010
R8       EQU   8                                                        12400010
R9       EQU   9                                                        12600010
R10      EQU   10                                                Y01004 13000010
RCCODE   EQU   10                       CONDITION CODE FOR CROSS Y02027 13040010
*                                       MEMORY POST              Y02027 13080010
RTCX     EQU   10                       ADDR OF THE TCAM CVT     Y02027 13120010
*                                       EXTENTION                Y02027 13160010
R11      EQU   11                       WORK REG                        13200010
RECB     EQU   11                       ADDR OF ECB FOR XMPOST   Y02027 13300010
RBASE    EQU   12                       BASE REG                        13400010
RERRET   EQU   12                       ADDR OF ERROR ROUTINE   Y02027  13460010
*                                       FOR XMPOST FAILURE       Y02027 13520010
RASCB    EQU   13                       ADDR OF TCAM'S ADDRESS   Y02027 13600010
*                                       SPACE CONTROL BLOCK      Y02027 13700010
RAVT     EQU   13                       AVT BASE                 Y01004 13800010
RSAVE    EQU   13                       ADDRESS OF SAVE AREA     Y02027 13850010
*                                       PASSED BY IOS            Y02027 13900010
R14      EQU   14                       RETURN TO IOS                   14000010
R15      EQU   15                       WORK REG                        14200010
CURR     EQU   15                       ADDR OF CURRENT ELEMENT  Y02027 14230010
*                                       ON THE ASYNCHRONOUS      Y02027 14260010
*                                       READY QUEUE                     14290010
RCVT     EQU   15                       ADDR OF COMM VECTOR TBL  Y02027 14320010
RXMPOST  EQU   15                       ADDR OF XMPOST RTN       Y02027 14350010
*                                                                       14400010
*********************************************************************** 14600010
PCIADDR  EQU   X'20'                    PCI ADD FOR RCV                 14800010
PCIADDS  EQU   X'10'                    PCI ADD FOR SEND                15000010
PCIADDXR EQU   X'80'                    PCI = X FOR RVC          S22026 15040010
PCIADDXS EQU   X'40'                    PCI = X FOR SEND         S22026 15080010
NOTTIC   EQU   7                        TEST FOR TIC OP CODE    SA52947 15180010
POSTED   EQU   X'40'                                                    15600010
ALL      EQU   15                       MASK FOR 370 INSTRUCTION Y01004 15610010
AD       EQU   7                        MASK FOR 370 INSTRUCTION Y01004 15620010
LCIN     EQU   X'80'                    MASK FOR LINE CNTRL OPT  Y01004 15630010
CEAP     EQU   12                       INDEX TO CHANNEL END IN  Y01004 15640010
*                                       APPENDAGE VECTOR TABLE   Y01004 15650010
POSTAD   EQU   X'98'                    OFFSET IN CVT TO OS POST Y01004 15660010
NOTIC    EQU   X'07'                    OTHER THAN TIC OP CODE   A52947 15690010
VRTIC    EQU   X'FF'-X'80'              MASK TO TEST VIRTUAL TIC Y01004 15700010
REALTIC  EQU   X'88'                    TIC OP CODE, PLUS FLAG   Y01004 15800010
*                                       FOR REAL TIC-TO ADDRESS  Y01004 15820010
READ     EQU   X'02'                    CCW OP CODE FOR READ     Y02027 15840010
ESOHCH   EQU   26 .                                              S22026 15840910
RSOHCH   EQU   29                       OFFSET SOH%R SEQUENCE    S99228 15841810
CEDE     EQU   X'0C'                    STATUS=CHAN END, DEVICE END TSO 15842710
DLEEOTCH EQU   16                       OFFSET TO SEQUENCE              15843610
EOTCH    EQU   0                        OFFSET TO SEQUENCE IN SCT       15844510
TOTESOH  EQU   27                       SOH % / FOR TOTE         S21903 15845410
CSOHCH   EQU   28                       INDEX TO SOH % C         S99238 15846310
STXENQCH EQU   11                       OFFSET TO SEQUENCE IN SCT       15847210
IN       EQU   X'80'                    MASK FOR LCIN                   15848110
X80      EQU   X'80'                    MASK FOR TS SWITCH              15849010
DISDLEOT EQU   X'01'                    FLAG TO WRITE DLE EOT           15849910
STAT1    EQU   X'0A'                    DB, US, DE MASK          S99228 15850810
STAT2    EQU   X'3E'                    CR, IR, EC, DC, CC MASK  S99228 15851710
SS0      EQU   6                        SENSE 0 OFFSET           S99228 15852610
SS1      EQU   7                        SENSE 1 OFFSET           S99228 15853510
C3270    EQU   X'04'                    3270 DEVICE              S99228 15854410
CNOIDLES EQU   X'02'                    NO IDLES DEFINED         S99228 15855310
PCIFLAG  EQU   X'80'                    PCI STATUS IN CSW               15856210
INVSTART EQU   8                        OFFSET TO START OF       Y02027 15857110
*                                       INVITATION LIST          Y02027 15858010
LOOKOFF  EQU   X'08'                    LEA OFFSET LOOKER ADCON  S99228 15860010
CUMASK   EQU   X'01'                    DCT GENERAL POLL INDIC   S99228 15880010
SORCOFF  EQU   X'0C'                    LEA OFFSET SOURCER ADCON S99228 15920010
ZERO     EQU   0                                                 S99228 15960010
ONE      EQU   1                        BUMP PAST LENGTH         S22025 16000010
TWO      EQU   2                        OFFSET OF INVLIST ENTRY  S22025 16040010
*                                            SIZE                S22025 16080010
THREE    EQU   3                        OFFSET TO CSW STATUS IN  X02004 16090010
*                                       THE LCB                  X02004 16100010
FOUR     EQU   4                        NUM OF BITS IN HALFBYTE  S22025 16120010
LOOPCT   EQU   4                        COUNT FOR LOOP LOOKING   S22025 16160010
*                                            FOR EOT             S22025 16200010
CTLLEN   EQU   8                        LENGTH OF INVLIST CTL WD S22025 16240010
UCBOFF   EQU   28                       OFFSET TO UCB REGISTER   X02004 16280010
UCBTYPE  EQU   16                       OFFSET TO UCB TYPE FIELD X02004 16285010
AUTO     EQU   X'80'                    AUTOPOLL DEVICE - UCB           16290010
FIVE     EQU   5                        FOR USE IN               Y01004 16295010
SEVEN    EQU   7                        CONSTANT                 Y01004 16300010
THRTN    EQU   13                      LCBCPA OFFSET TO SIO CCW  Y01004 16305010
TWNTY4   EQU   24                       LCBCPA OFFSET TO POLL CCWY01004 16310010
TWNTY    EQU   20                       SCT OFFSET               Y01004 16315010
THIRTY2  EQU   32                       ADDRESSING               Y01004 16320010
HALF     EQU   3                        MASK FOR ICM HALF WORD   Y01004 16326010
CCNONZ   EQU   7                        NON ZERO CONDITION CODE  Y01004 16332010
CCZRO    EQU   8                        ZERO CONDITION CODE      Y01004 16338010
CHPGMCHK EQU   X'20'                    MASK TO CHK CHANNEL PROG Y01004 16344010
*                                       CHECK                    Y01004 16350010
HI       EQU   8                        MASK FOR ICM HI ORDER    Y02027 16353010
         EJECT                                                          16356010
EOA      EQU   X'16'                    S/S EOA CHARACTER        S22025 16360010
ENDOLIST EQU   X'FE'                    END OF INVLIST         @SA70322 16380010
         USING IEDQQCB,R6               QCB BASE                 S22025 16400010
         USING IEDQTNTD,R7              TERMNAME TABLE BASE      S22025 16600010
         USING IHADCB,RDCB              DCB BASE                 S22025 16800010
         USING IEDQLCB,RLCB             LCB ADDRESS                     17000010
         USING IEDQAVTD,RAVT                                            17200010
         USING IEDQPRF,RPREFIX                                          17400010
         USING DEBNMSUB,RDEB                                     Y01004 17600010
         USING LCBFLAG1,RLCB                                     Y01004 17660010
         DC    A(END19RN-IGG019RN)      LENGTH OF APPENDAGE      X02004 17720010
         USING *,R15                                             Y01004 17800010
         SPACE 1                                                 Y01004 17900010
         STM   R0,R15,ZERO(RSAVE)       SAVE REGISTERS           Y02027 19200010
         TM    LCBSTAT1,LCBSENDN        TEST LINE FOR SEND OR    Y01004 19206010
*                                       RECEIVE STATE USING THE  Y01004 19212010
*                                       IOB BASE TO SET THE      Y01004 19218010
*                                       CONDITION CODE FOR THE   Y01004 19224010
*                                       FOLLOWING BAL TO ENABLE  Y01004 19230010
*                                       SPM TO BE USED           Y01004 19236010
         BAL   RBASE,TAG                SET BASE AND BYPASS ID   Y01004 19242010
BASEQU   EQU   *                                                 Y02027 19245010
*                                                                Y01004 19248010
         DROP  R15                                               Y01004 19254010
         USING *,RBASE                                           Y01004 19260010
IGG019RN IEDHJN                                                         19266010
TAG      DS    0H                                                Y01004 19273010
         L     RCVT,CVTPTR              ADDR OF CVT              Y02027 19280010
         L     RTCX,AVTCVTPT(RCVT)      ADDR OF TCAM ADDRESSES   Y02027 19360010
         USING IEDQTCX,RTCX                                      Y02027 19440010
PCILOCK  EQU   *                                                 Y02027 19520010
         TS    TCXDSAVE                 PCI ACTIVE ON OTHER CPU  Y02027 19540010
         BNZ   PCILOCK                  YES, LOOP TILL DONE      Y02027 19560010
         STCM  RSAVE,AD,TCXDSAVE+ONE    SAVE ADDR OF SAVE AREA   Y02027 19580010
         L     RAVT,TCXAVT              PICKUP AVT ADDRESS       Y02027 19600010
         DROP  RTCX                                              Y02027 19680010
         LA    RLCB,0(RLCB)             CLEAR FOR FLAG           Y01004 19740010
         SH    RLCB,SIZE                SET TO LCB BASE                 19800010
         USING IEDQLCB,RLCB                                      Y01004 19812010
         TS    LCBPCILK                 IS LCB LOCKED FOR PCI    Y02027 19932010
         BNE   EXIT                     YES, IGNORE THIS PCI     Y02027 19952010
         SR    R11,R11                  CLEAR REGISTER           Y02027 20000010
         ICM   R11,SEVEN,LCBCSW         PICKUP CSW ADDRESS       Y02027 20050010
BACKUP   EQU   *                                                 S22026 20100010
         SH    R11,EIGHT                SUB EIGHT                S22026 20200010
         TM    PRFOPCDE-IEDQPRF(R11),NOTIC  WAS PCI ON TIC CCW   A52947 20300010
         BZ    BACKUP                   BRANCH YES               A52947 20400010
         SPACE 1                                                 S22026 20500010
*********************************************************************** 20600010
*        IF PCI IS RECEIVED ON A READ RESPONSE CCW IN TRANSPARENT     * 20700010
*        MODE THE CSW SHOULD BE RESET TO THE WRITE DLE ETB CCW        * 20800010
*********************************************************************** 20900010
         SPACE 1                                                 S22026 21000010
         LA    R11,0(R11)               CLEAR FOR COMPARE               21260010
         LA    R10,LCBCPA+THIRTY2       ADDRESS OF READ RESP CCW Y01004 21280010
         CLR   R10,R11                  PCI RECEIVED ON RESPONSE Y01004 21300010
*                                       CCW                      Y01004 21390010
         BE    BACKUP                   BR IF YES -- SUB EIGHT   Y01004 21460010
         STCM  R11,AD,LCBCSW            UPDATE CSW               Y02027 21530010
         SR    R15,R15                  CLEAR                  @G36XRIB 21566010
         BCTR  R15,0                    SET FF IN HIGH ORDER   @G36XRIB 21575010
         ICM   R15,AD,AVTIOT+1          IS I/O TRACE ACTIVE    @G36XRIB 21584010
         BZ    NOTRACE                  BRANCH NO               OZ07068 21593010
         BALR  R14,R15                  LINK TO I/O TRACE       OZ07068 21602010
         SPACE 1                                                OZ07068 21611010
NOTRACE  EQU   *                                                OZ07068 21620010
         SR    R10,R10                                           Y01004 21660010
         LR    R5,R10                                            Y01004 21720010
         LR    R9,R10                   CLEAR WORK REGISTER      Y01004 21800010
         ICM   RPREFIX,AD,LCBLSPCI      PICK UP LAST PCI         Y01004 21880010
         TM    LCBFLAG3,LCBOBRRD        TPER RECORD              Y01004 21960010
         BO    NOFREE                   YES, IGNORE THIS PCI     Y01004 22040010
NEXBFR   EQU   *                                                 Y01004 22120010
         IC    R5,PRFNBUNT              NUMBER OF UNITS          Y01004 22200010
         NI    PRFFLAGS,X'FF'-CCWPCI    RESET PCI FLAG           Y01004 22300010
COMPAR   EQU   *                                                 Y01004 22400010
         CLM   RPREFIX,AD,LCBCSW        THIS INTERRUPTING CCW    Y01004 22460010
         BE    FOUND                    BRANCH YES               Y01004 22520010
*                                                                Y01004 22600010
         ICM   R1,ALL,PRFTIC            TIC TO ADDRESS           Y01004 22700010
         BNM   NOCONV                   NO CONVERSION IF VIRTUAL Y01004 22800010
*                                                                Y01004 22850010
         BAL   R14,VIRTUAL              CONVERT ADDRESS          Y01004 22900010
*                                                                Y01004 23000010
NOCONV   EQU   *                                                 Y01004 23100010
         LR    RPREFIX,R1               SAVE UNIT ADDRESS        Y01004 23200010
         BCT   R5,COMPAR                CHECK NEXT UNIT          Y01004 23250010
*                                                                Y01004 23300010
         LA    R9,ONE(R9)               ADD TO BFRS TO FREE      Y01004 23400010
         TM    PRFFLAGS,CCWPCI           HAS REQUEST FOR BUFFER  Y01004 23500010
*                                       ALREADY BEEN MADE        Y01004 23600010
         BNO   NEXBFR                   YES - DON'T ADD TO COUNT Y01004 23660010
*                                                                Y01004 23720010
         BCT   R10,NEXBFR               COUNT BUFFERS AND BRANCH Y01004 23800010
*                                                                Y01004 23900010
FOUND    EQU   *                                                 Y01004 24000010
         LR    R0,R9                    SAVE NUMBER OF BUFFERS   Y01004 24050010
         L     R11,LCBSCBA-ONE          SCB ADDRESS              Y01004 24100010
         USING IEDQSCB,R11                                       Y01004 24200010
         SPM   RBASE                    IS LINE RECEIVING        Y01004 24300010
         BZ    CKAUTOPL                 BRANCH YES               Y01004 24400010
*                                                                Y01004 24480010
CONTINUE EQU   *                                                 Y01004 24560010
         LA    R15,EXIT                 ASSUME NO BUFFERS TO     Y01004 24600010
*                                       DEALLOCATE               Y01004 24720010
         LTR   R0,R0                    ANY BUFFERS              Y01004 24800010
         BZ    OKFREE                   BRANCH NONE TO DEALLOCATEY01004 24860010
*                                                                Y01004 24920010
         LA    R15,RETURN               SET TO DEALLOCATE BUFFERSY01004 25000010
         TM    LCBSTAT2,LCBSYNC         BSC LINE                 Y01004 25100010
         BNO   OKFREE                   BRANCH NO                Y01004 25200010
*                                                                Y01004 25260010
         SPM   RBASE                    LINE IN SEND STATE       Y01004 25320010
         BO    HOLDBFR                  BRANCH YES               Y01004 25400010
*                                                                Y01004 25500010
         TM    SCBSTATE,SCBTRANP        TRANSPARENT MODE         Y01004 25600010
         BO    OKFREE                   BRANCH YES               Y01004 25650010
*                                                                Y01004 25700010
HOLDBFR  EQU   *                                                 Y01004 25840010
         BCT   R0,OKFREE                DECREMENT BUFFERS TO FREEY01004 25920010
*                                       AND BRANCH IF NOT ZERO   Y01004 26000010
NOFREE   EQU   *                                                 Y01004 26060010
         LA    R15,EXIT                 SET TO NOT DEALLOCATE    Y01004 26120010
*                                       BUFFERS                  Y01004 26200010
OKFREE   EQU   *                                                 Y01004 26300010
         LPR   R10,R10                  SET COUNT POSITIVE       Y01004 26400010
         SPM   RBASE                    SEND STATE               Y01004 26460010
         BO    SNDCHK                   BRANCH YES               Y01004 26520010
*                                                                Y01004 26600010
         TM    DCBPCI,PCIADDR+PCIADDXR  ADD ON RECEIVE SPECIFIED Y01004 26700010
         BCR   CCZRO,R15                BRANCH NO                Y01004 26800010
*                                                                Y01004 26880010
         TM    LCBCSW+THREE,ONE         WAS EOT RECEIVED         Y02027 26960010
         BCR   CCNONZ,R15               BRANCH YES               Y01004 27000010
*                                                                Y01004 27100010
         TM    LCBCSW+FOUR,CHPGMCHK     CHANNEL PROGRAM CHECK    Y02027 27270010
         BZ    POSTST                   BRANCH NO                Y01004 27350010
*                                                                Y01004 27352010
         TM    LCBERBST,LCBDLNKN        IS ERB AVAILABLE         Y01004 27500010
         BCR   CCNONZ,R15               BRANCH NO                Y01004 27550010
*                                                                Y01004 27600010
POSTST   EQU   *                                                 Y01004 27700010
         LA    R9,LCBERBCT+ONE          ADDR OF DISABLED COUNT   Y01004 27800010
         TM    LCBERBST,LCBDLNKN        ERB AVAILABLE            Y01004 27900010
         BNO   SKIPPOST                 BRANCH IF NO             Y01004 27950010
         SR    R1,R1                                             Y01004 28000010
         LA    R5,ALL                   MASK TO CLEAR BUFIN      Y01004 28100010
         IC    R1,DCBBUFOU              BUFOUT REQUEST           Y01004 28200010
         NR    R1,R5                    CLEAR OUT BUFIN          Y01004 28300010
         LA    R7,AVTDSIOB              SET TO POST ERB TO IEDQFAY01004 28350010
         SPM   RBASE                    LINE IN SEND STATE       Y01004 28400010
         BO    USESEND                  BRANCH YES               Y01004 28500010
CONT     EQU   *                                               @SA70322 28550010
*                                                                Y01004 28600010
         LA    R7,AVTBFREB              SET TO REQUEST BUFFERS   Y01004 28700010
         IC    R1,DCBBUFIN              PICK UP BUFIN            Y01004 28750010
         SRL   R1,FOUR                  CLEAR OUT BUFOUT         Y01004 28800010
USESEND  EQU   *                                                 Y01004 28900010
         CLI   LCBERBPY,PRIINTRQ        FIRST PCI                Y01004 29000010
         MVI   LCBERBPY,PRISBPCI        SET PRIORITY             Y01004 29100010
         BNE   SETPOST                  BRANCH IF NO             Y01004 29150010
         MVI   LCBERBPY,PRIFSPCI        SET FIRST PCI            Y01004 29200010
         IC    R5,DCBBUFMA              BUFMAX REQUEST           Y01004 29300010
         SR    R5,R1                    GET DIFFERENCE           Y01004 29400010
         AR    R10,R5                   ADD TO BE DEQUEUED       Y01004 29500010
SETPOST  EQU   *                                                 Y01004 29550010
         LTR   R10,R10                  ANY BUFFERS TO REQUEST   Y01004 29600010
         BCR   CCZRO,R15                BRANCH NO - EXIT         Y01004 29700010
         LR    R14,R15                                           Y01004 29790010
         LA    R15,POST                 SET TO POST ERB          Y01004 29880010
         LA    RPREFIX,LCBERB           ELEMENT TO POST          Y01004 29970010
         BCTR  R9,ZERO                  SET TO ENABLED COUNT     Y01004 30060010
SKIPPOST EQU   *                                                 Y01004 30150010
         IC    R5,0(R9)                 GET COUNT                Y01004 30240010
         NI    LCBERBST,LCBDLNKF        MARK ERB POSTED          Y01004 30330010
         TM    LCBERBCT+ONE,LCBDCNT     DISABLED COUNT USED      Y01004 30420010
         BZ    NOLOCK                   BRANCH IF NO             Y01004 30510010
         LA    R9,LCBERBCT              ENABLED COUNT            Y01004 30600010
         IC    R5,0(R9)                 GET COUNT                Y01004 30690010
NOLOCK   EQU   *                                                 Y01004 30780010
         AR    R5,R10                   ADD COUNTS               Y01004 30870010
         STC   R5,0(R9)                 UPDATE COUNT             Y01004 30960010
         BR    R15                      RETURN                   Y01004 31050010
*                                                                Y01004 31140010
SNDCHK   EQU   *                                                 Y01004 31230010
         TM    DCBPCI,PCIADDS+PCIADDXS  PCI REQUEST SET          Y01004 31320010
         BCR   CCZRO,R15                BRANCH NO                Y01004 31410010
*                                                                Y01004 31500010
         L     R9,LCBSCBA-1             SCB ADDR                 S22026 31590010
         TM    SCBQTYPE-IEDQSCB(R9),SCBCONC                      S22026 31680010
*                                       CONC                     S22026 31770010
         BZ    CKERBST                  BRANCH IF NOT CONC       S22026 31860010
         L     R9,SCBDESTQ-1-IEDQSCB(R9) QCB ADDR                S22026 31950010
         AH    R9,QCBEXTO-IEDQQCB(R9)   QCBE ADDR                S22026 32400010
         L     R9,QCBECONC-1-IEDQQCBE(R9)                        S22026 32450010
*                                       CONC TERM ENTRY          S22026 32560010
         L     R9,TRMDESTQ-1-IEDQTRM(R9)                         S22026 32600010
         LA    R15,RETURN               SET REG TO RETURN        S22026 32650010
         LA    R11,DRQBUFCT-IEDQDRQ(R9) SET R11 TO DRQBUFCT      S22026 32800010
         TM    DRQFLAG3-IEDQDRQ(R9),DRQFSPCI                     S22026 32880010
*                                       FIRST PCI FOR CONC MSG   S22026 32885010
         BZ    NOTFRST                  BRANCH IF NO             S22026 33000010
         NI    DRQFLAG3-IEDQDRQ(R9),255-DRQFSPCI                 S22026 33100010
*                                       RESET FIRST PCI FLAG     S22026 33200010
         SR    R7,R7                                             Y01004 33250010
         LA    R5,ALL                                            Y01004 33300010
         IC    R7,DCBBUFOU              GET BUFOUT COUNT         Y01004 33400010
         NR    R7,R5                    CLEAR OUT BUFIN          Y01004 33500010
         IC    R5,DCBBUFMA                                       Y01004 33600010
         SR    R5,R7                    BUFMAX LESS BUFOUT       Y01004 33650010
         AR    R10,R5                                            Y01004 33700010
NOTFRST  EQU   *                                                 Y01004 33800010
         TM    DRQFLAG3-IEDQDRQ(R9),DRQERBAV  ERB AVAILABLE      S22026 33900010
         BO    CONCADD                  BRANCH IF NO             S22026 34000010
         TM    LCBERBST,LCBDLNKN        ERB AVAILABLE            S22026 34050010
         BZ    CONCADD                  BRANCH IF NO             S22026 34100010
         TM    LCBERBST,LCBEOMSG        ERB AVAILABLE            S22026 34200010
         BO    CONCADD                  BRANCH IF NO             S22026 34300010
         NI    LCBERBST,LCBDLNKF        MARK ERB NOT AVAILABLE   S22026 34400010
         MVI   LCBERBPY,PRIINTRQ-1      SET ERB PRIORITY         S22026 34450010
         LA    R15,POST                 SET RETURN REG           S22026 34500010
*                                                                S22026 34580010
CONCADD  EQU   *                                                 S22026 34660010
         IC    R7,0(R11)                GET COUNT                S22026 34740010
         AR    R7,R10                   ADD COUNTS               S22026 34820010
         STC   R7,0(R11)                UPDATE COUNT             S22026 34900010
         L     R7,AVTCSCH               CONC SCH ADDR+2          S22026 34980010
         BCTR  R7,0                    SUB ONE                   S22026 35060010
         BCTR  R7,0                    SUB ONE                   S22026 35140010
         LA    RPREFIX,LCBERB           SET POST REG             S22026 35220010
         LA    R14,RETURN               SET SUBROUTINE RETURN    S22026 35300010
         BR    R15                      EXIT TO POST OR RETURN   S22026 35380010
          SPACE 2                                                       35460010
CKERBST  EQU   *                                                 S22026 35540010
         TM    LCBERBST,LCBEOMSG        EOT READ FROM Q          Y01004 35620010
         BZ    POSTST                   BRANCH NO                Y01004 35700010
*                                                                Y01004 35780010
         BR    R15                      EXIT                     Y01004 35860010
*                                                                Y01004 35940010
RETURN   EQU   *                                                 Y01004 36020010
         LTR   R10,R0                   BUFFERS TO DEALLOCATE    Y01004 36100010
         BZ    EXIT                     EXIT - NO BUFFERS TO FREEY01004 36180010
         SPM   RBASE                    SENDING                  Y01004 36260010
         BO    CHKADDXS                 BRANCH IF YES            S22025 36340010
         TM    DCBPCI,PCIADDXR          PCI=X ON RECEIVE         S22025 36420010
         B     CHKCOND                  BRANCH TO CHK COND       S22025 36500010
CHKADDXS EQU   *                                                 S22025 36580010
         TM    DCBPCI,PCIADDXS          PCI=X ON SEND            S22025 36660010
CHKCOND  BO    EXIT                     BRANCH IF YES            S22025 36800010
         ICM   R11,AD,LCBLSPCI          FIRST BUFFER TO FREE     Y01004 36880010
BFRSCON  EQU   *                                                 Y01004 36960010
         SR    R7,R7                    CLEAR REGISTER           Y01004 37040010
         LR    RPREFIX,R11              NEXT BUFFER ADDRESS      Y01004 37120010
         IC    R5,PRFNBUNT              NUMBER OF UNITS IN BUFFERY01004 37200010
UNTSCON  EQU   *                                                 Y01004 37260010
         ICM   R1,ALL,PRFTIC-IEDQPRF(R11) REAL TIC ADDRESS       Y01004 37320010
         BNM   NOCONV2                  BRANCH IF VIRTUAL ADDRESSY01004 37400010
*                                                                Y01004 37500010
         BAL   R14,VIRTUAL              CONVERT TO VIRTUAL       Y01004 37600010
*                                                                Y01004 37650010
         STCM  R1,AD,PRFTIC+1-IEDQPRF(R11) STORE VIRTUAL ADDRESS Y01004 38350010
         NI    PRFTIC-IEDQPRF(R11),VRTIC SET VIRTUAL TIC OP CODE Y01004 38420010
NOCONV2  EQU   *                                                 Y01004 38490010
         SPM   RBASE                    LINE IN SEND STATE       Y01004 38560010
         BNZ   SNDLOOP                  BRANCH IF SEND           Y01004 38570010
*                                                                Y01004 38640010
         CLM   R11,AD,LCBCPA+THRTN      WAS SIO DONE ON THIS UNITY01004 38710010
         BNE   NOSIO                    NO                       Y01004 38800010
         LR    R7,R11                   INDICATE SCAN REQ'D ON   Y01004 38860010
*                                       THIS BUFFER              Y01004 38920010
NOSIO    EQU   *                                                 Y01004 39000010
         LR    R9,R1                    SAVE NEXT UNIT/BUFFER    Y01004 39100010
         BAL   R14,COMMON               USE COMMON CODE TO CHECK Y01004 39150010
*                                       I/O DATA ADDRESS         Y01004 39200010
*                                                                Y01004 39300010
         ST    R1,PRFIOADR-IEDQPRF-1(R11)  SET VIRTUAL ADDR AND  Y01004 39400010
*                                       CLEAR OP CODE FOR FLAG   Y01004 39460010
         LR    R0,R11                   SAVE CURRENT UNIT ADDRESSY01004 39520010
         LR    R11,R9                   SET UP NEXT UNIT ADDRESS Y01004 39600010
         BCT   R5,UNTSCON               CONVERT NEXT UNIT- IF ONEY01004 39680010
*                                       LAST IN THIS BUFFER      Y01004 39720010
         CLM   R9,AD,LCBCSW             IS THIS THE PCI BUFFER   Y01004 39760010
         LR    R9,R7                    SET SCAN REQUIRED FLAG   Y01004 39840010
         BNE   NOTEND                   BRANCH NO                Y01004 39920010
         LR    R7,R0                    RESET NEXT UNIT ADDRESS  Y01004 40000010
*                                                                Y01004 40100010
         AH    R1,PRFCOUNT-IEDQPRF(R7)  ADD CCW COUNT            Y01004 40150010
         BCTR  R1,ZERO                  POINT TO LAST CHARACTER  Y01004 40200010
*                                       RECEIVED                 Y01004 40300010
         IC    R7,0(,R1)                PICK UP DATA CHARACTER   Y01004 40350010
         L     R1,DCBSCTAD-1            SPECIAL CHARACTERS TABLE Y01004 40400010
         LA    R15,FOUR                 SET LOOP CONTROL         Y01004 40500010
CHECKCH  EQU   *                                                 Y01004 40550010
         SR    R14,R14                  CLEAR FOR ADDRESSING     Y01004 40600010
         IC    R14,TWNTY(R15,R1)        CHARACTER OFFSET         Y01004 40700010
         LTR   R14,R14                  SEQUENCE DEFINED         Y01004 40800010
         BZ    NEXT                     BRANCH NO                Y01004 40850010
*                                                                Y01004 40900010
         AR    R14,R1                   ADDRESS OF SEQUENCE      Y01004 41000010
         CLM   R7,ONE,ONE(R14)          IS THIS THE CHARACTER    Y01004 41050010
         BE    CONVREAL                 BRANCH YES               Y01004 41100010
*                                                                Y01004 41200010
NEXT     EQU   *                                                 Y01004 41290010
         BCT   R15,CHECKCH              CHECK NEXT SEQUENCE      Y01004 41320010
*                                                                Y01004 41380010
NOTEND   EQU   *                                                 Y01004 41500010
         LTR   R9,R9                    IS SCAN REQ'D ON THIS BFRY01004 41560010
         BZ    NOSCAN                   NO, POST                 Y01004 41620010
*                                                                Y01004 41680010
         TM    LCBSTAT2,LCBSYNC         BSC LINE                 Y01004 41740010
         BO    PREPSCAN                 BRANCH-YES             @OX12568 41800010
         STM   R0,R15,SAVEREG+FOUR      SAVE REGISTERS         @OX12568 41820010
         B     SCANEND                  BRANCH                 @OX12568 41840010
PREPSCAN EQU   *                                               @OX12568 41860010
*                                                                Y01004 41900010
         TM    LCBMSGFM,LCBVSTRT+LCBRSTRT VALID SEQUENCE RECEIVEDY01004 41950010
         BNZ   NOSCAN                   BRANCH YES               Y01004 42000010
*                                                                Y01004 42100010
         SPACE 1                                                 Y01004 42200010
*********************************************************************** 42250010
*        FOR BISYNC RECEIVE ONLY A SCAN ROUTINE MUST BE EXECUTED      * 42300010
*        PARAMETERS -- ADDRESSABILITY - R5  RETURN - R10  LCB - R2    * 42400010
*              DEB - R3                                               * 42450010
*        WORK -         R3, R6, R7, R8, R9, R11                       * 42500010
*********************************************************************** 42600010
*                                                                       42606010
*        REGISTER EQUATES                                               42612010
*                                                                       42618010
RWKA     EQU   3                                                        42624010
RA       EQU   7                        WORK REGISTER                   42630010
RB       EQU   8                        WORK REGISTER                   42636010
RC       EQU   9                        WORK REGISTER                   42642010
RD       EQU   10                       WORK REGISTER                   42648010
RE       EQU   11                       WORK REGISTER                   42654010
         USING IEDQLCBX,RE                                       S99228 42660010
         SPACE 1                                                 S22026 42670010
         BAL   R14,COMMON               USE COMMON CODE TO CHECK Y01004 42740010
*                                       I/O DATA ADDRESS         Y01004 42810010
         ST    R1,PRFIOADR-IEDQPRF-1(R11)   AND STORE            Y01004 42880010
         SPACE 1                                                 Y01004 42950010
         STM   R0,R15,SAVEREG+FOUR      SAVE REGISTERS           S99228 43020010
*                                       BUFFERS                  Y01004 43090010
SCAN     EQU   *                                                        43160010
*    SCBTRNSP OR SCBNONTR IS SET UPON RECEIPT OF FIRST BLOCK OF DATA    43161010
* AND RESET IN BUFFER DISPOSITION.  IT'S PURPOSE IS TO DETERMINE        43162010
* LCBISZE AND TYPE OF MSG RECEIVED FOR SUBSEQUNET CONTINUE SEQUENCES    43163010
* I/O GENERATOR MIGHT BUILD A READ OF COUNT 1 OR 2 AFTER WRITE ACK/NAK  43164010
* IF LCOUT IS IN USE.  ON SUBSEQUENT BLOCKS OF DATA THE SCAN ROUTINE    43165010
* LOOKS FOR LINE CONTROL CHARACTERS IN LCBERCCW+12 IF LCOUT IS IN USE.  43166010
*     LCBVSTRT OR LCBRSTRT IS SET BY SCAN TO INFORM PCI APPENDAGE       43167010
* ON SUBSEQUENT PCI'S AND LINE END THAT SCAN HAS COMPLETED.             43168010
*    WHEN LCBVSTRT IS SET, ONE OF THE FOLLOWING SILL ALSO BE SET:       43169010
* LCBTTD,LCBENQ,LCBEOT,LCBOLT.  LCBRSTRT IS SET WHEN AN INVALID         43170010
* START CHARACTER IS DETECTED OR IF USER IS NOT MAINTAINING             43171010
* TRANSPARENCY OR NON-TRANSPARENCY FOR THIS MESSAGE.  THESE BITS ARE    43172010
* RESET IN ACTIVATE.                                                    43173010
         SR    RB,RB                    CLEAR WORK REGISTER             43174010
         L     RD,DEBAPPAD-DEBNMSUB(,RWKA) APPENDAGE TABLE       Y02027 43177010
         TM    TWO(RD),X80              IS ALTMH SPECIFIED       Y02027 43178010
         BZ    DCBMHLC                  BRANCH NO                S22029 43179010
         TM    LCBSTAT2,LCBDIAL         DIAL LINE?               S22029 43180010
         BO    DCBMHLC                  BRANCH YES               S22029 43181010
         NC    LCBTTCIN,LCBTTCIN        IS CONNECTED INDEX ZERO  S22029 43182010
         BZ    DCBMHLC                  YES - USE OWNING MH LC   S22029 43183010
* THIS ROUTINE GETS THE ADDRESS OF THE DESTINATION QCB           S22029 43184010
         LH    RC,LCBTTCIN .            GET CONNECTED INDEX      S22029 43185010
         L     RA,AVTRNMPT .            GET TNT CODE BASE        S22029 43186010
         BAL   RPREFIX,TNTDCODE-IEDQTNTD(RA) .GO GET TERM TABLE  S22029 43187010
*                                       ENTRY                    S22029 43188010
         L     RE,AVTEZERO(RB) .        GET ADDR OF DEST QCB     Y02027 43189010
         TM    QCBDSFLG-IEDQQCB(RE),QCBALTMH IS TERMINAL         S22029 43190010
*                                       CONNECTED TO ALTMH       S22029 43191010
         BZ    DCBMHLC .                NO - USE OWNING MH LC    S22029 43192010
         LA    RD,ONE(,RD)              USE ALTMH OPTIONS        Y02027 43193010
DCBMHLC  EQU   * .                                               S22029 43194010
         L     RC,LCBSCBA-1             SCB ADDR               @ZA02070 43194310
         USING IEDQSCB,RC                                      @ZA02070 43194610
         MVC   LCBERCCW+1(ONE),0(RD)    SAVE STARTMH OPTIONS     Y02027 43195010
         SR    RB,RB                    CLEAR FOR IC             Y02027 43195510
         L     RPREFIX,LCBLSPCI-1 .     GET HEADER BUFFER        S21101 43196010
         TM    SCBBSCFM,SCBTRNSP+SCBNONTR TYPE MESSAGE DETERMINEDS21101 43197010
         IC    RB,LCBISZE .             GET IDLES RESERVED       S21101 43198010
         LA    RWKA,PRFSHDR(RB) .       SET INITIAL SCAN IF FIRSTS21101 43199010
         ST    RWKA,LCBERCCW+4 .        SAVE IT FOR LATER        S21101 43200010
         BZ    NOTSET .                 BRANCH VERY FIRST BLOCK  S21101 43201010
         SPACE 1                                                 S21101 43202010
         TM    PRFSTAT1,PRFNHDRN .      HEADER BUFFER            S21101 43203010
         BO    SET .                    BRANCH IF NO             S21101 43204010
         SPACE 1                                                 S21101 43205010
         TM    SCBQTYPE,SCBBFMM .       MIDDLE OF MESSAGE        S21101 43206010
         BZ    SET .                    BRANCH IF NO             S21101 43207010
*                                                                S21101 43208010
*        THE FOLLOWING CODE IS EXECUTED FOR INPUT BUFFERED       S21101 43209010
* TERMINAL SUPPORT SUCH AS ENQUIRY MODE ON 2770.  WE ARE READING S21101 43210010
* A SUBSEQUNET BLOCK OF A MESSAGE AND THE HEADER BUFFER MUST BE  S21101 43211010
* CONVERTED TO A TEXT BUFFER.  THE CCW IS REBUILT OR POSSIBLE    S21101 43212010
* ERROR RETRIES BY ERP AND FOR RECEPTION OF TTD, ENQ, ETC.  A    S21101 43213010
* FLAG IS SET IN THE TIC FIELD (PRFBFMM) TO INDICATE TO MH THAT  S21101 43214010
* IDLES FOR THIS BUFFER ARE SET IN LCBISZE.                      S21101 43215010
*                                                                S21101 43216010
         TM    PRFTIC,PRFBFMM .         MID MSG SITUATION        S22025 43217010
         BO    SET .                    BRANCH IF YES            S22025 43218010
*                                                                S22025 43219010
         OI    PRFTIC,PRFBFMM .         SET HEADER CONVERTED     S22025 43220010
*                                         TO TEXT                S22025 43221010
         NI    PRFFLAGS,AVTEFF-CCWSLI . RESET WRAP SWITCH        S21101 43222010
         TM    SCBBSCFM,SCBTRNSP .      RECEIVEING TRANSPARENT   S21101 43223010
         BZ    ITSNONTR .               BRANCH IF NO-TEST LCIN   S21101 43224010
         SPACE 1                                                 S21101 43225010
         BAL   RB,SETISZE .             BUMP IDLES  COUNT        S21101 43226010
ITSOUT   EQU   *                                                 S21101 43227010
         BAL   RB,SETISZE .             TWO FOR TRANSPARENT      S21101 43228010
         B     ADJBUF .                 NOW RESET BUFFER CCW FOR S21101 43229010
*                                         ERP AND OTHER -TTD,ENQ S21101 43230010
         SPACE 1                                                 S21101 43231010
ITSNONTR EQU   *                                                 S21101 43232010
         TM    LCBERCCW+ONE,IN          LINE CONTROL IN?         S99228 43233010
         BZ    ITSOUT .                 BRANCH IF LCOUT -BUMP IDLS21101 43234010
*                                         PAST STX               S21101 43235010
ADJBUF   EQU   *                                                 S21101 43236010
         BAL   RE,BLDBUFF1 .            REBUILD BUFFER USING NEW S21101 43237010
*                                         IDLES COUNT            S21101 43238010
         L     RC,LCBSCBA-1 .           RESET SCB BASE           S21101 43239010
NOTSET   EQU   *                                                 S21101 43240010
         L     RPREFIX,LCBERCCW+4 .     DATA ADDRESS IN BUFFER   S21101 43241010
*                                         TO SCAN FOR LINE CNTROLS21101 43242010
         B     SCANTEST .               START THE SCAN           S21101 43243010
SET      EQU   *                                                        43244010
         SPACE                                                          43245010
         L     RWKA,LCBCPA+12 .         GET CURRENT CCW          S21101 43246010
         LA    RPREFIX,LCBERCCW+12 .    SCAN AREA                S21101 43247010
         LA    RA,ONE(,RPREFIX) .       ASSUME TRANSPARENT       S21101 43248010
         TM    SCBBSCFM,SCBTRNSP .      TRANSPARENT MODE         S21101 43249010
         BO    TRCOM                    BRANCH IF YES                   43250010
         BCTR  RA,R0                    ADJUST-LCIN,LCOUT-NONTRANSP     43251010
         TM    LCBERCCW+ONE,IN          LINE CONTROL IN?         S99228 43252010
         BO    NOTR                     BRANCH IF LCIN                  43253010
         SPACE                                                          43254010
TRCOM   EQU   *                                                         43255010
         LR    RE,RWKA                  COPY CCW ADDRESS                43256010
         CLI   CCWCOUNT+1-CCW(RWKA),3   AT LEAST 3 CHARACTERS           43257010
        L     RWKA,CCWADDR-1-CCW(,RWKA) DATA ADDRESS                    43258010
         BH    MOVEIT                   YES                             43259010
         LH    RB,CCWCOUNT-CCW(RE)  GET COUNT                           43260010
         BCTR  RB,0                     FOR EXECUTE                     43261010
         EX    RB,MOVELC                MOVE                            43262010
         LA    RA,1(RA,RB)              ADJUST SCAN AREA                43263010
         TM    11(RE),X'03'             IS THERE NEXT UN IT             43264010
         BNZ   SCANTEST                 NO                              43265010
         L     RE,8(,RE)                GET NEXT UNIT                   43266010
         L     RE,CCWADDR-1-CCW(,RE)    GET DATA ADDRESS                43267010
         MVC   0(3,RA),0(RE)            MOVE DATA                       43268010
         B     SCANTEST                 SCAN DATA                       43269010
MOVEIT   EQU   *                                                        43270010
        MVC   1(2,RA),0(RWKA)          MOVE DATA FOR SCAN               43271010
         B     SCANTEST                 START SCAN                      43272010
         SPACE                                                          43273010
NOTR    EQU   *                                                         43274010
         LR    RPREFIX,RWKA             GET CURRENT CCW ADDRESS         43275010
         CLI   PRFCOUNT+1,3             AT LEAST 3 CHARCTERS            43276010
         BH    NOMOVE                   YES                             43277010
         LH    RWKA,PRFCOUNT            GET COUNT                       43278010
         L     RB,PRFIOADR-1            GET DATA ADDRSS                 43279010
         BCTR  RWKA,0                   FOR EXECUTE                     43280010
         EX    RWKA,MOVESCAN            MOVE REMANING COUNT             43281010
         LA    RA,1(RA,RWKA)            ADJUST SCAN AREA                43282010
         TM    PRFTIC+3,X'03'           IS THERE NEXT UNIT              43283010
         BNZ   STARTSCN                 NO                              43284010
         L     RPREFIX,PRFTIC           NEXT C W                        43285010
         L     RB,PRFIOADR-1            DATA DADDRESS                   43286010
         LA    RWKA,2                   MOVE AT LEAST 3                 43287010
         EX    RWKA,MOVESCAN            MOVE DATA                       43288010
STARTSCN EQU   *                                                        43289010
         LA    RPREFIX,LCBERCCW+12      SCAN AREA                       43290010
         B     SCANTEST                 SCAN THE DATA                   43291010
         SPACE                                                          43292010
NOMOVE   EQU   *                                                        43293010
         L     RPREFIX,PRFIOADR-1       FOR SCAN                        43294010
SCANTEST EQU  *                                                         43295010
         L     RE,DCBSCTAD-1            SCT ADDRESS                     43296010
         SR    RA,RA                    CLEAR EORK REGISTER             43297010
         IC    RA,STXENQCH(,RE)         TTD OOFFSET                     43298010
         LA    RWKA,1(RA,RE)            POINT TO SEQUENC                43299010
         CLC   1(2,RWKA),0(RPREFIX)     STX ENQ                         43300010
        BNE   NOTTTD                   NO                               43301010
         OI    SCBERR2,SCBABRTN         POSSIBLE ABORT                  43302010
         OI    SCBERR4,SCBTXTTN         SET TEXT ERROR                  43303010
         OI    LCBMSGFM,LCBTTD+LCBVSTRT . SAET STATUS            S21101 43304010
         TM    SCBBSCFM,SCBTRNSP+SCBNONTR TYPE MSG DETERMINED  @OS76474 43305010
         BNZ   SCANEND                  Y- NO NEED TO UPDTE CCW@OS76474 43308010
         SPACE 5                                                 S21101 43312010
BLDBUFF  EQU   *                                                        43313010
         LA    RE,SCANEND               SET FINAL EXIT ADDRESS   Y02027 43314010
BLDBUFF1 EQU   *                                                 S21101 43315010
*        REBUILD BUFFER IF FIRST BLOCK FROM POLLING                     43316010
         L     RPREFIX,LCBLSPCI-1       LAST SERVICED BUFFER            43317010
         SR    RWKA,RWKA                CLEAR WORK REGISTER             43318010
         IC    RWKA,LCBISZE             NO OF IDLES FOR HEADER          43319010
         LA    RWKA,PRFSHDR(RWKA)          PREIX PLUS IDLES             43320010
         L     RB,PRFIOADR-1            DATA ADDRESS                    43321010
         LR    RC,RB                    SAVE FOR UPDATE                 43322010
         LA    RB,0(,RB)                CLEAR HI ORDER BYTE             43323010
         SR    RB,RWKA                  FIND DIFFERNCE IN ADDRESS       43324010
         SR    RC,RB                    NEW LOWER DATA DADRESS          43325010
         AH    RB,PRFCOUNT              ADJUST COUNT                    43326010
         ST    RC,PRFIOADR-1            NEW DATA ADDRESS                43327010
         STH   RB,PRFCOUNT              SET NEW COUNT                   43328010
         BR    RE .                     REUTRN TO CALLER         S21101 43329010
NOTTTD   EQU   *                                                        43330010
         CLC   1(1,RWKA),0(RPREFIX)     STX RECEIVED                    43331010
         BNE   TRTTD                    NO TRY TRANSPARENT TTD          43332010
STXREC   EQU   *                                                        43333010
         TM    SCBBSCFM,SCBTRNSP .      TRANSPARENT              S21101 43334010
         BNZ   ERRSET                   YES, WRONAG FORMAT              43335010
         TM    SCBBSCFM,SCBNONTR .      NON-TRANSPARENT MODE     S21101 43336010
         BNZ   ITSET                    YES                             43337010
         TM    LCBERCCW+1,IN            LCIN                            43338010
         BO    ITSET                    YES                             43339010
         SPACE                                                          43340010
         BAL   RB,SETISZE               BUMP IDLES                      43341010
ITSET    EQU   *                                                        43342010
         OI    SCBBSCFM,SCBNONTR .      SET NONTRANSPARENT BIT   S21101 43343010
ALLSET   EQU   *                                                        43344010
         OI    LCBMSGFM,LCBVSTRT .      VALID START CHARACTER    S21101 43345010
         B     SCANEND                  SCAN COMPLETED.          Y02027 43346010
TRTTD    EQU   *                                                        43347010
         CLC   0(2,RWKA),0(RPREFIX) .  STX                      SA44892 43348010
         BNE   NOTRAN                                           SA44892 43349010
         TM    SCBBSCFM,SCBNONTR .    RECEIVING NONTRANSP       SA44892 43350010
         BNZ   SETERR                                           SA44892 43351010
         OI    LCBMSGFM,LCBVSTRT .     VALID START SEQUENCE.    SA44892 43352010
         TM    SCBBSCFM,SCBTRNSP .     ALREADY RECEIVE AT LEAST SA44892 43353010
*                                      ONE DATA SEQUENCE ?      SA44892 43354010
         BNZ   SCANEND                  YES,SCAN COMPLETED.      Y02027 43355010
         BAL   RB,SETISZE .            BUMP IDLES               SA44892 43356010
         BAL   RB,SETISZE .            BUMP IDLES               SA44892 43357010
         OI    SCBBSCFM,SCBTRNSP .     SET TRANSP . RECEIVE     SA44892 43358010
         B     BLDBUFF .               REBUILD BUFFER FOR CASE  SA44892 43359010
*                                      OF MULTIPOINT LINE .     SA44892 43360010
NOTRAN   EQU   *                                                        43361010
         CLC   2(1,RWKA),0(RPREFIX)     INQ RECEIVED                    43362010
         BNE   NOTENQ                   NO                              43363010
         SPACE                                                          43364010
         OI    LCBMSGFM,LCBVSTRT+LCBENQ SET ENQ START            S21101 43365010
         TM    SCBBSCFM,SCBTRNSP+SCBNONTR TYPE MSG DETERMINED    S21101 43366010
         BNZ   SCANEND                  YES,SCAN COMPLETED.      Y02027 43367010
         TM    LCBSTAT2,LCBDIAL         DIAL LINE                       43368010
         BZ    BLDBUFF                  BRANCH NO                       43369010
         SPACE                                                          43370010
         NI    LCBMSGFM,AVTEFF-(LCBENQ+LCBVSTRT) RESET ENQ AND STS21101 43371010
         B     TESTENT                  SEE IF ENTRY FROM PCI           43372010
         SPACE                                                          43373010
NOTENQ   EQU   *                                                        43374010
         IC    RA,EOTCH(,RE)            EOT SEQUENCE                    43375010
         LA    RWKA,1(RA,RE)            POINT TO EOT SEQUENCE           43376010
         CLC   0(1,RWKA),0(RPREFIX)     EOT RECEIVED                    43377010
         BNE   TRYSOH                   NOT EOT, TRY SOH                43378010
         OI    LCBMSGFM,LCBEOT+LCBVSTRT SET STATUS BITS          S21101 43379010
         B     SCANEND                  SCAN COMPLETED.          Y02027 43380010
TRYSOH   EQU   *                                                        43381010
         IC    RA,ESOHCH(,RE) .         SOH % E                  S22026 43382010
         LA    RWKA,1(RA,RE) .          POINT TO SEQUENCE        S22026 43383010
         CLC   0(3,RWKA),0(RPREFIX) .   SOH % E SEQUENCE         S22026 43384010
         BE    TPER .                   YES, SET TPER BIT        S99238 43385010
         SPACE                                                          43386010
         IC    RA,CSOHCH(,RE) .         SOH % C                  S99238 43387010
         LA    RWKA,1(RA,RE) .          POINT TO SEQUENCE        S99238 43388010
         CLC   0(3,RWKA),0(RPREFIX) .   SOH % C SEQUENCE         S99238 43389010
         BNE   TRYOLT .                 NO, TRY NEXT SEQUENCE    S22026 43390010
         OI    LCBFLAG3,LCBSOHC         SOH % C MESSAGE          S99238 43391010
TPER     EQU   * .                                               S99238 43392010
         OI    LCBFLAG3,LCBOBRRD .      SET TPER RECORD          S22026 43393010
         B     STXREC .                 GO TO COMMON CODE        S22026 43394010
TRYOLT   EQU   * .                                               S22026 43395010
         IC    RA,RSOHCH(,RE)           INSERT SOH%R OFFSET      S99228 43396010
         LA    RWKA,ONE(RA,RE)          POINT TO SOH%R CHARS     S99228 43397010
         CLC   ZERO(THREE,RWKA),ZERO(RPREFIX)  SOH%R?            S99228 43398010
         BNE   PROBOLT                  BRANCH NO                S99228 43399010
         OI    SCBERR2,SCBSOHE          SET SOH% MESSAGE FLAG    S99228 43400010
         OI    LCBFLAG3,LCBSOHR         SET SOH%R MSG INDICATOR  S99228 43401010
         TM    SS1(RPREFIX),STAT2       CR, IR, EC, DC, CC?      S99228 43402010
         BNZ   YESLOG                   YES, LOG SOH%R MESSAGE   S99228 43403010
         TM    SS0(RPREFIX),STAT1       DB, DE?                  S99228 43404010
         BNZ   STXREC                   BRANCH EITHER            S99228 43405010
YESLOG   EQU   *                                                 S99228 43406010
         TM    LCBTSOB,LCBTSBUF         IS THIS TIME SHARING BUF S99228 43407010
         BZ    YESLOG1                  BRANCH ON NO             S99228 43408010
         OI    SCBERR4,SCBTRMLN         SET TERMINAL ERROR FLAG  S99228 43409010
YESLOG1  EQU   *                                                 S99228 43410010
         OI    LCBFLAG3,LCBOBRRD        SET RECORDING FLAG       S99228 43411010
         B     STXREC                   RETURN TO COMMON CODE    S99228 43412010
PROBOLT  EQU   *                                                 S99228 43413010
         IC    RA,TOTESOH(,RE)          SOH % / FOR TOTE         S21903 43414010
         LA    RWKA,1(RA,RE)            POINT TO SEQUENCE        S21903 43415010
         CLC   0(3,RWKA),0(RPREFIX)     ON LINE TEST?            S21903 43416010
         BNE   SOHTRY                   TRY SOH                         43417010
         TM    SCBBSCFM,SCBTRNSP+SCBNONTR 1ST TIME               S21101 43418010
         BNZ   STXREC                   NO                              43419010
         OI    LCBMSGFM,LCBVSTRT+LCBOLT INDICATE OLT REQUEST     S21101 43420010
         OI    SCBBSCFM,SCBNONTR .      SET NONTRANSPARENT BIT   S21101 43421010
         B     SCANEND                  SCAN COMPLETED.          Y02027 43422010
SOHTRY   EQU   *                                                        43423010
         CLC   0(1,RWKA),0(RPREFIX)     SOH RECEIVED                    43424010
         BE    STXREC                   YES, USE COMMON CODE            43425010
         IC    RA,DLEEOTCH(,RE)         INDEX TO SEQUENCE               43426010
         LA    RWKA,1(RA,RE)            BUMP TO SEQUENCE                43427010
         CLC   0(2,RWKA),0(RPREFIX)     DLE EOT RECEVIED                43428010
         BNE   ERRSET                   NO                              43429010
         NI    LCBTPCD+11,AVTEFF-DISDLEOT DONT WRITE DLE EOT NEXT       43430010
         OI    LCBMSGFM,LCBEOT+LCBENQ+LCBVSTRT VALID START       S21101 43431010
*                                         SET DLE EOT RECEIVED   S21101 43432010
         OI    LCBSTAT2,LCBNEGRP        SET NEGATIVE RESPONSE           43433010
         B     SCANEND                  SCAN COMPLETED         @ZA03738 43434010
ERRSET   EQU   *                                                        43435010
         TM    LCBSTAT2,LCBDIAL         DIAL                            43436010
         BZ    SETERR                   NO                              43437010
         SPACE                                                          43438010
*        THIS MIGHT BE ID ENQ IF CPU ID WAS HIT ON LINE                 43439010
         TM    SCBBSCFM,SCBTRNSP+SCBNONTR 1ST TIME               S21101 43440010
         BNZ   SETERR                   NO, NOT FIRST BLOCK             43441010
         SPACE                                                          43442010
TESTENT  EQU   * .                                               S21101 43443010
         CLI   LCBCPA+24,CCWDISAB .     CONNECTION JUXT MADE     S21101 43444010
         BNE   SETERR .                 BRANCH IF NO             S21101 43445010
         SPACE                                                          43446010
         TM    LCBCSW+3,CEDE            PCI OR LINE END                 43447010
         B     SCANEND                  SCAN COMPLETED.          Y02027 43448010
SETERR   EQU   *                                                        43452010
         OI    SCBERR3,SCBFORMN         SET FORMAT ERROR                43453010
         OI    SCBERR4,SCBTXTTN         TEXT ERROR                      43454010
         OI    LCBMSGFM,LCBRSTRT .      SET INVALID START        S21101 43455010
         B     SCANEND                  SCAN COMPLETED.          Y02027 43456010
MOVELC   MVC   1(1,RA),0(RWKA)          'EXECUTED'                      43457010
MOVESCAN MVC   0(1,RA),0(RB)            'EXECUTED'                      43458010
SETISZE  EQU   *                                                        43459010
         ICM   RPREFIX,AD,LCBLSPCI .    FIRST BUFFER             X01004 43460010
         LH    RA,PRFSIZE .             PICK UP SIZE             X01004 43461010
         LA    RA,ONE(,RA) .            ADD ONE                  X01004 43462010
         STH   RA,PRFSIZE .             RESTORE NEW SIZE         X01004 43463010
         IC    RA,LCBISZE .             PICK UP IDLES COUNT      X01004 43464010
         LA    RA,ONE(,RA) .            ADD ONE                  X01004 43465010
         STC   RA,LCBISZE .             STORE NEW COUNT          X01004 43466010
         BR    RB                       RETURN                          43467010
         DROP  RC                                                       43468010
SCANEND  EQU   *                                                 Y02027 43469010
         SPACE 1                                                        43510010
         SR    R11,R11                  CLEAR LENGTH REGISTER    S99228 43580010
         IC    R11,DCBEIOBX             INSERT LCB LENGTH        S99228 43650010
         SH    R11,EIGHT                8 BYTES TO POINT TO EXT  S99228 43720010
         LA    R11,ZERO(R11,RLCB)       LOAD ADDR LCB EXTENSION  S99228 43790010
         USING IEDQLCBX,R11                                      S99228 43860010
         TM    LCBXFLAG,LCBSRCPF        SOURCE DETERMINATION     S99228 43930010
*                                       ALREADY PERFORMED?       S99228 44000010
         BO    NOSOURCE                 BRANCH YES               S99228 44070010
         L     R5,SAVEREG               LOAD ADDR APP VEC TABLE  X02004 44140010
LOOKER   EQU   *                                                 S99228 44210010
* THIS SUBROUTINE LOCATES THE INVITATION LIST AND DEVICE         S99228 44212010
* CHARACTERISTICS TABLE ENTRY FOR 2260  AND 3270 DEVICES         S99228 44214010
         SR    RB,RB                    CLEAR WORK REGISTER      S99228 44216010
         IC    RB,LCBUCBX               LOAD INVLIST INDEX       S99228 44218010
         SLL   RB,TWO                   MULTIPLY INDEX BY 4      S99228 44220010
         L     RC,DCBINVLI(RB)          LOAD ADDR INVLIST CWORD  S99228 44222010
         LR    R0,RC                    SAVE ADDR INVLIST CWORD  S99228 44224010
         LH    RC,LCBTTCIN .            LOAD TERM INDEX          S99228 44226010
         N     RC,AVTCLRHI .            CLEAR HI-ORDER HALF      S99228 44228010
         TM    LCBSTAT1,LCBSENDN        SEND STATE?              S99228 44230010
         BO    OUTBY                    YES, USE LCBTTCIN        S99228 44232010
         TM    LCBXFLAG,LCBSRCPF        SRC DETERM PERFORMED?    S99228 44234010
         BO    USEPTR                   YES, USE INVLIST PTR     S99228 44236010
         LTR   RC,RC .                  TTCIN ZERO               S99228 44238010
         BNZ   OUTBY                    NO, LCBTTCIN VALID       S99228 44240010
USEPTR   EQU   *                                                 S99228 44242010
         LR    RC,R0                    RESTORE REG              S99228 44244010
         L     RA,LCBINVPT-ONE          LOAD INVLIST ENTRY PTR   S99228 44246010
         SR    RB,RB                    CLEAR WORK REGISTER      S99228 44248010
         IC    RB,TWO(R0,RC)            LOAD INVLIST ENTRY LENGTHS99228 44250010
         AR    RA,RB                    SKIP TO END INVLIST ENT  S99228 44252010
         BCTR  RA,R0                    POINT TO ENTRY INDEX     S99228 44254010
         IC    RB,ZERO(R0,RA)           LOAD ENTRY INDEX VALUE   S99228 44256010
         SLL   RB,ONE                   DOUBLE INDEX VALUE       S99228 44258010
         SR    RC,RB                    POINT TO TNT INDEX       S99228 44260010
         LH    RC,ZERO(R0,RC)           LOAD TNT INDEX           S99228 44262010
OUTBY    EQU   *                                                 S99228 44264010
         BAL   RWKA,BOLOC               BRANCH TO DCT ENTRY LOC  S99228 44266010
         MVC   LCBXDCT(THREE),ONE(RA)   SAVE DCT BYTES 1, 2, 3   S99228 44268010
         LR    RC,R0                    LOAD INVLIST CWORD ADDR  Y02027 44270010
         B     LOOKEND                  LOOKUP COMPLETE.         Y02027 44272010
BOLOC    EQU   *                                                 S99228 44274010
* THIS SUBROUTINE LOCATES DEVICE CHARACTERISTICS TABLE ENTRIES   S99228 44276010
         N     RC,AVTCLRHI              CLEAR HI ORDER BYTES     S99228 44278010
         L     RA,AVTRNMPT              LOAD ADDR TERMNAME TABLE S99228 44280010
         USING IEDQTNTD,RA                                       S99228 44282010
         BAL   RPREFIX,TNTDCODE         BRANCH TO TRM ENT LOC RT S99228 44284010
         USING IEDQTRM,RB                                        S99228 44286010
         DROP  RA                                                S99228 44288010
         SR    RA,RA                    CLEAR INDEX REGISTER     S99228 44290010
         IC    RA,TRMCHCIN              LOAD DCT INDEX           S99228 44292010
         BCTR  RA,R0                    DECREMENT FOR ENTRY      S99228 44294010
         MH    RA,AVTDCTLN              MULTIPLY FOR OFFSET    @G36XRIB 44296010
         DROP  RB                                                S99228 44298010
         A     RA,AVTCSTCS              SET ADDR DCT ENTRY       S99228 44300010
         BR    RWKA                     RETURN TO CALLER         S99228 44302010
LOOKEND  EQU   *                                                 Y02027 44304010
         SPACE 2                                                        44350010
         TM    LCBDCT1,CUMASK           GENERAL POLL IN PROGRESS?S99228 44700010
         BNO   NOSOURCE                 BRANCH NO                X02004 44770010
         TM    LCBMSGFM,LCBOLT          TRM PRESENT?             S99228 44840010
         BO    SRCSET                   BRANCH YES               S99228 44910010
         L     RPREFIX,LCBLSPCI-1       LOAD BUFFER ADDRESS      Y02027 44980010
SOURCER  EQU   *                                                 S99228 45050010
* THIS SUBROUTINE CALCULATES TRANSMISSION SOURCES OF MESSAGES    S99228 45052010
* RECEIVED UNDER GENERAL POLL                                    S99228 45054010
         SR    RB,RB                    CLEAR IDLES REGISTER     S99228 45056010
         IC    RB,LCBISZE               INSERT IDLES COUNT       S99228 45058010
         TM    LCBERCCW+ONE,IN          LINE CONTROL IN?         S99228 45060010
         BO    LCPRES                   BRANCH YES               S99228 45062010
         BCTR  RB,R0                    SET TO POINT AT LC CHAR  S99228 45064010
LCPRES   EQU   *                                                 S99228 45066010
         LA    RE,PRFSHDR(RB)           LOAD DATA ADDRESS        S99228 45068010
         TM    LCBSTAT2,LCBSYNC         BISYNC LINE?             S99228 45070010
         BZ    REGMSG                   NO, SKIP SOH%R SEARCH    S99228 45072010
         L     RB,DCBSCTAD-ONE          LOAD ADDR SPEC CHARS TBL S99228 45074010
         SR    RA,RA                    CLEAR OFFSET REGISTER    S99228 45076010
         IC    RA,RSOHCH(R0,RB)         INSERT SOH%R OFFSET      S99228 45078010
         LA    RB,ONE(RA,RB)            LOAD ADDR SOH%R CHARS    S99228 45080010
         CLC   ZERO(ONE,RB),ZERO(RE)    SOH%R MESSAGE?           S99228 45082010
         BNE   USUMSG                   BRANCH NO                S99228 45084010
         LA    RE,THREE(R0,RE)          BYPASS SOH%R STX CHARS   S99228 45086010
USUMSG   EQU   *                                                 S99228 45088010
         LA    RE,ONE(R0,RE)            POINT TO CU ENTRY        S99228 45090010
REGMSG   EQU   *                                                 S99228 45092010
         LR    R0,RC                    SAVE INVLIST C WORD ADDR S99228 45094010
         SR    RA,RA                    CLEAR ENTRY COUNT REG    S99228 45096010
         SR    RB,RB                    CLEAR WORK REGISTER      S99228 45098010
         IC    RB,TWO(R0,RC)            LOAD INVLIST ENTRY LENGT S99228 45100010
         IC    RA,ONE(R0,RC)            SET ACTIVE INVLIST E CNT S99228 45102010
         LA    RC,INVSTART(R0,RC)       SET INVLIST START ADDR   Y02027 45104010
         LA    RPREFIX,TWO              SET ACTIVE-INACTIVE CON  S99228 45106010
SYNCTEST EQU   *                                               @ZA03738 45107010
         LTR   RA,RA                    TEST NUMBER ACTIVE ENT   S99228 45108010
         BZ    NOORG                    NO ACTIVE ENTRIES NO SRC S99228 45110010
         TM    LCBSTAT2,LCBSYNC         TEST FOR BSYNC LINE      S99228 45114010
         BZ    SLOLINE                  NO, NO SKIP OF 1ST CU    S99228 45116010
         LA    RC,ONE(R0,RC)            ADJ PTR TO COMPARE 2ND C S99228 45118010
SLOLINE  EQU   *                                                 S99228 45120010
         L     RWKA,LCBINVPT-ONE        LOAD INVLIST POINTER     S99228 45122010
CONCHECK EQU   *                                                 S99228 45124010
         CLC   ZERO(ONE,RWKA),ZERO(RC)  COMPARE CONTROL UNIT ADD S99228 45126010
         BE    DVCCHECK                 CU ADDRS EQUAL CHECK DVC S99228 45128010
CONTEST  EQU   *                                                 S99228 45130010
         AR    RC,RB                    SKIP TO NEXT INVLIST ENT S99228 45132010
         BCT   RA,CONCHECK              CONTINUE SEARCHING       S99228 45134010
         BCT   RPREFIX,FEINCRE          PROCESS INACTIVE ENTRIES S99228 45136010
         B     NOORG                    NO SRC FOUND SET NO SRC  S99228 45138010
DVCCHECK EQU   *                                                 S99228 45140010
         CLC   ONE(ONE,RC),ONE(RE)      COMPARE DEVICE ADDR      S99228 45142010
         BNE   CONTEST                  BRANCH DEVICE NOT FOUND  S99228 45144010
         STM   RPREFIX,RC,SRCREGS       SAVE REGISTERS           S99228 45146010
         LR    RA,R0                    LOAD INVLIST CWORD ADDR  S99228 45148010
         TM    LCBSTAT2,LCBSYNC         BYSNC INVLIST?           S99228 45150010
         BZ    RUNLOW                   BRANCH NO                S99228 45152010
         BCTR  RB,R0                    REDUCE ENTRY LENGTH      S99228 45154010
RUNLOW   EQU   *                                                 S99228 45156010
         BCTR  RB,R0                    REDUCE ENTRY SIZE        S99228 45158010
         IC    RB,ZERO(RB,RC)           INSERT ENTRY INDEX       S99228 45160010
         SLL   RB,ONE                   DOUBLE INDEX VALUE       S99228 45162010
         SR    RA,RB                    POINT TO TNT INDEX       S99228 45164010
         LH    RC,ZERO(R0,RA)           LOAD TNT INDEX           S99228 45166010
         BAL   RWKA,BOLOC               BRANCH TO DCT ENTRY LOC  S99228 45168010
         TM    ONE(RA),C3270            3270 DEVICE?             S99228 45170010
         BO    RELOAD                   BRANCH YES               S99228 45172010
         TM    THREE(RA),CNOIDLES       2260 DEVICE?             S99228 45174010
RELOAD   EQU   *                                                 S99228 45176010
         LM    RPREFIX,RC,SRCREGS       RESTORE REGISTERS        S99228 45178010
         BO    SETORG                   BRANCH IF GENPOLL DEVICE S99228 45180010
         B     CONTEST                  NOT GENPOLL DEVICE       S99228 45182010
FEINCRE  EQU   *                                                 S99228 45184010
         LA    RC,ONE(R0,RC)            ADJ PTR ADDR TO PASS FE  S99228 45186010
         LR    RWKA,R0                  RESTORE CONTROL WORD ADD S99228 45188010
         IC    RA,ZERO(R0,RWKA)         LOAD TOTAL ENTRIES       S99228 45190010
         SR    RB,RB                    CLEAR ACTIVE ENTRIES REG S99228 45192010
         IC    RB,ONE(R0,RWKA)          LOAD ACTIVE ENTIRES      S99228 45194010
         SR    RA,RB                    DERIVE INACTIVE ENTRIES  S99228 45196010
         IC    RB,TWO(R0,RWKA)          RESTORE LENGTH           S99228 45198010
         B     SYNCTEST                 CONT SRCH INACT ENTRIES  S99228 45200010
SETORG   EQU   *                                                 S99228 45202010
         TM    LCBSTAT2,LCBSYNC         BYSNC INVLIST?           S99228 45204010
         BZ    UNSYNC                   NO, NO RETARD INV PTR    S99228 45206010
         BCTR  RC,R0                    RETARD INV PTR TO CU ADD S99228 45208010
UNSYNC   EQU   *                                                 S99228 45210010
         SR    R11,R11                  CLEAR FOR IC           @OZ09940 45212010
         IC    R11,DCBEIOBX             GET IOB SIZE           @OZ09940 45212510
         SH    R11,EIGHT                GET OFFSET TO EXTENSION@OZ09940 45213010
         LA    R11,ZERO(R11,RLCB)       ADDR OF EXTENSION      @OZ09940 45213510
         ST    RC,LCBXRADR              SAVE ERP POLL ADDR       S99228 45214010
*                                       FOR ERP POLL             S99228 45216010
         BCTR  RC,R0                    RETARD INVLIST ENTRY PTR S99228 45218010
         AR    RC,RB                    PT TO INVLIST ENT INDEX  S99228 45220010
         SR    RWKA,RWKA                CLEAR WORK REGISTER      S99228 45222010
         IC    RWKA,ZERO(R0,RC)         LOAD INDEX VALUE         S99228 45224010
         SLL   RWKA,ONE                 DOUBLE INDEX VALUE       S99228 45226010
         LR    RC,R0                    RSTR INVLIST C WORD ADDR S99228 45228010
         SR    RC,RWKA                  POINT TO TNT INDEX       S99228 45230010
         LH    RWKA,ZERO(R0,RC)         LOAD TNT INDEX VALUE     S99228 45232010
         STH   RWKA,LCBTTCIN            SET SOURCE OF TRANS      S99228 45234010
         B     SRCSET                   SRC DETERM COMPLETE      Y02027 45236010
NOORG    EQU   *                                                 S99228 45238010
         SR    R11,R11                  CLEAR FOR IC           @OZ09940 45238410
         IC    R11,DCBEIOBX             GET IOB SIZE           @OZ09940 45238810
         SH    R11,EIGHT                GET OFFSET TO EXTENSION@OZ09940 45239210
         LA    R11,ZERO(R11,RLCB)       ADDR OF EXTENSION      @OZ09940 45239610
         NI    LCBXFLAG,LCBERSTP        PREVENT ERP POLL         S99228 45240010
         XC    LCBTTCIN(TWO),LCBTTCIN   INVALID SOURCE CLEAR SRC S99228 45242010
         B     NOSOURCE                 END OF SRC DETERMINATN @ZA03738 45244010
SRCSET   EQU   *                                                 S99228 45260010
         OI    LCBXFLAG,LCBSRCPF        SET SRC DETERM PERFORMED S99228 45320010
NOSOURCE EQU   *                                                 S99228 45400010
         LM    R0,R15,SAVEREG+FOUR      RESTORE REGISTERS        S99228 45460010
         DROP  R11                                               S99228 45520010
         SPACE 1                                                        45600010
*                                                                Y01004 45660010
         SR    R5,R5                    CLEAR FOR COUNT          Y01004 45720010
NOSCAN   EQU   *                                                 Y01004 45860010
         TM    LCBSTAT2,LCBSYNC         BSC LINE               @OS76718 45866010
         BNO   NOSCAN1                  BRANCH NO              @OS76718 45872010
         TM    LCBMSGFM,LCBVSTRT        VALID START            @OS76718 45878010
         BNO   NOSCAN1                  BRANCH NO              @OS76718 45884010
         L     R7,LCBSCBA-1             SCB ADDR               @OS76718 45890010
         NI    SCBERR2-IEDQSCB(R7),X'FF'-SCBABRTN  RESET ERR   @OS76718 45896010
         NI    SCBERR3-IEDQSCB(R7),X'FF'-SCBFORMN  RESET ERR   @OS76718 45902010
         NI    SCBERR4-IEDQSCB(R7),X'FF'-SCBTXTTN  RESET ERR   @OS76718 45908010
NOSCAN1  EQU   *                                               @OS76718 45914010
         OI    PRFSTAT1,PRFNLSTN        SET NOT LAST BUFFER      Y01004 45920010
         MVC   PRFSIZE,DCBBUFSI         SET BUFFER SIZE          Y01004 46000010
         L     R7,DCBMH-1               SET TO POST TO MH        Y01004 46060010
         MVI   PRFPRI,PRIMHBFR          SET PRIORITY             Y01004 46120010
         B     POSTLNK                  USE COMMON CODE          Y01004 46200010
*                                                                Y01004 46300010
SNDLOOP  EQU   *                                                 Y01004 46400010
         LR    R11,R1                   NEXT UNIT ADDRESS        Y01004 46460010
         BCT   R5,UNTSCON               CONTINUE IF MORE UNITS   Y01004 46520010
         LA    R7,AVTBFRTB              BUFFER RETURN QUEUE      Y01004 46600010
         MVI   PRFPRI,PRIBFRTB          SET RETURN PRIORITY      Y01004 46660010
POSTLNK  EQU   *                                                 Y01004 46720010
         BAL   R14,POST                 PUT BUFFER ON READY QUEUEY01004 46800010
*                                                                Y01004 46860010
         BCT   R10,BFRSCON              CONVERT NEXT BUFFER IF   Y01004 46920010
*                                       ONE                      Y01004 47000010
SETEXIT  EQU   *                                                 Y01004 47060010
         STCM  R11,AD,LCBLSPCI          SET NEXT BUFFER AS LSPCI Y01004 47120010
EXIT     EQU   *                                                 Y01004 47200010
         MVI   LCBPCILK,ZERO            CLEAR PCI LOCK FOR MP    Y02027 47210010
         L     RCVT,CVTPTR              PICKUP CVT ADDRESS       Y02027 47220010
         USING CVT,RCVT                                          Y02027 47240010
         L     RTCX,CVTAQAVT            PICKUP ADDR OF TCAM CVT  Y02027 47260010
*                                       EXTENSION                Y02027 47300010
         USING IEDQTCX,RTCX                                      Y02027 47340010
         L     R9,TCXDSAVE              ADDR OF IOS SAVE AREA    Y02027 47380010
         MVI   TCXDSAVE,AVTEZERO        CLEAR PCI LOCK FLAG      Y02027 47410010
         TM    AVTOSECB,POSTED          IS TCAM RUNNING          X02004 47450010
         BNZ   POSTRTN                  IF YES - DO NOT POST     Y02027 47500010
*                                                                Y01004 47550010
         LA    RECB,AVTOSECB            PICKUP ADDR OF ECB       Y02027 49400010
         SR    R14,R14                  CLEAR FOR OR             Y02027 49450010
         ICM   R14,HI,XMPOSTMK          PICK UP MASK             Y02027 49460010
         OR    RECB,R14                 INDICATE CROSS MEMORY    Y02027 49470010
*                                       POST REQUEST             Y02027 49500010
         LA    RERRET,CVTBRET           SETUP ERROR RETURN ADDR  Y02027 49650010
*                                       FOR XMPOST TO BR 14 INST Y02027 49700010
         OR    RERRET,R14               NOT MEMORY RELATED       Y02027 49800010
         L     RASCB,TCXASCB            PASS TCAM'S ADDRESS      Y02027 49900010
*                                       SPACE CTL BLOCK TO XMPST Y02027 49950010
         DROP  RTCX                                              Y02027 50000010
         L     RXMPOST,CVT0PT01         ADDR OF XMPOST RTN       Y02027 50050010
         SR    RCCODE,RCCODE            INDICATE CCODE OF ZERO   Y02027 50100010
         BALR  R14,RXMPOST              POST TCAM'S ECB COMPLETE Y02027 50150010
POSTRTN  EQU   *                                                 Y02027 50180010
         LM    R0,R15,ZERO(R9)          RESTORE REGISTERS        Y02027 50210010
         SR    R9,R9                    CLEAR FOR IOS            Y02027 50240010
         BR    R14                      RETURN TO IOS            Y02027 50270010
         SPACE 2                                                        50300010
COMMON   EQU   *                                                 Y01004 50400010
         SR    R1,R1                    INSURE 0 HIGH ORDER BYTE Y01004 50500010
         ICM   R1,AD,PRFIOADR-IEDQPRF(R11)  I/O DATA ADDR        Y01004 50600010
         CLI   PRFOPCDE-IEDQPRF(R11),ZERO HAS IT BEEN CONVERTED  Y01004 50700010
         BNE   VIRTUAL                  BRANCH NO - CONVERT      Y01004 50800010
         BR    R14                      RETURN                   Y01004 50900010
         SPACE 2                                                 S22025 51600010
CKAUTOPL EQU   *                                                 Y01004 51604010
         L     RPREFIX,LCBLSPCI-1       ADDRESS OF FIRST BUFFER  Y01004 51608010
         TM    PRFSTAT1,PRFNHDRN        IS THIS A HEADER BUFFER  Y01004 51612010
         BO    CONTINUE                 BRANCH NO - RETURN       Y01004 51616010
*                                                                Y01004 51620010
         CLI   LCBCPA+TWNTY4,CCWPOLL    POLL CCW                 Y01004 51624010
         BE    AUTOSRC                  YES,BRANCH             @YA08787 51628010
*                                       TIME                     Y01004 51632010
         CLI   DCBEIOBX,X'C8'           LCB TOO SMALL FOR AUTOP@YA08787 51632510
         BL    CONTINUE                 YES,BRANCH             @YA08787 51633010
         CLI   LCBCPA+53,AVTEFF         ERP AUTOPOLL DONE      @YA08787 51633510
         BNE   CONTINUE                 NO-NOT AUTOPOLL        @YA08787 51634010
AUTOSRC  EQU   *                                               @YA08787 51634510
         MVI   LCBCPA+53,AVTEZERO       TURN OFF ERP AUTOPOLL  @YA08787 51635010
         MVI   LCBCPA+TWNTY4,CCWNOP     SET FIRST TIME SWITCH    Y01004 51636010
         ICM   R1,AD,PRFIOADR           REAL DATA ADDRESS        Y01004 51640010
         BAL   R14,VIRTUAL              CONVERT TO VIRTUAL       Y01004 51644010
*                                                                Y01004 51648010
         BCTR  R1,ZERO                  DECREMENT ADDRESS        Y01004 51652010
         BCTR  R1,ZERO                  BY 2 BYTE READ IN LCB    Y01004 51656010
         IC    R5,LCBUCBX               RELATIVE LINE NUMBER-1   Y01004 51660010
         SLL   R5,TWO                   MULTIPLY BY 4 FOR INDEX  Y01004 51664010
         L     R7,DCBINVLI(R5)          INVITATION LIST FOR LINE Y01004 51668010
         SR    R5,R5                    CLEAR                    Y01004 51672010
         LR    R14,R5                   CLEAR                    Y01004 51676010
         IC    R14,0(R1)                INDEX BYTE RECEIVED      Y01004 51680010
         TM    LCBSTAT2,LCBSYNC         BSC LINE                 Y01004 51684010
         BO    RESTORE1                 BRANCH YES               X02004 51688010
*                                                                Y01004 51692010
         L     R9,DEBAPPAD              APPENDAGE VECTOR TABLE   Y01004 51696010
         TM    0(R9),LCIN               WAS LC IN SPECIFIED      Y01004 51700010
         BNO   LCOUT                    BRANCH NOT LC=IN         Y01004 51704010
*                                                                Y01004 51708010
         MVI   0(R1),EOA                REPLACE INDEX WITH EOA   Y01004 51712010
         B     LCOUT                    GET ADDR OF INVLIST      X02004 51716010
         SPACE 1                                                        51720010
RESTORE1 EQU   *                                                 S22028 51724010
         TM    LCBTSOB,LCBTSBUF         TSO TERMINAL             S22028 51728010
         BZ    LCOUT                    NO, BRANCH               X02004 51732010
         MVI   AVTEZERO(R1),ZERO        REPLACE INDEX BYTE WITH 0X02004 51736010
LCOUT    EQU   *                                                 Y01004 51740010
         LTR   R14,R14                  INDEX BYTE RECEIVED = 0  Y01004 51744010
         BZ    NOTVALID                 BRANCH YES - IGNORE      Y01004 51748010
*                                                                Y01004 51752010
         SR    R0,R0                                           @SA70322 51760010
         IC    R0,TWO(,R7)              SIZE OF EACH ENTRY     @SA70322 51772010
         LA    R9,SEVEN(,R7)            POINT TO FIRST ENTRY -1  Y01004 51776010
INVLOOP  EQU   *                                                 Y01004 51780010
         AR    R9,R0                    FIRST/NEXT ENTRY       @SA70322 51784010
         CLM   R14,ONE,0(R9)            IS THIS THE ENTRY        Y01004 51788010
         BE    INVFOUND                 BR, YES, INVLIST FOUND @SA70322 51792010
         CLI   ONE(R9),ENDOLIST         END OF LIST?           @SA70322 51793010
         BE    NOTVALID                 BR YES, INV NOT FOUND  @SA70322 51794010
         CLI   TWO(R9),ENDOLIST         END OF INVLIST?        @SA70322 51795010
         BE    NOTVALID                 BR YES, INV NOT FOUND  @SA70322 51796010
         B     INVLOOP                  CONTINUE SEARCH        @SA70322 51797010
INVFOUND EQU   *                                               @SA70322 51798010
         BCTR  R0,ZERO                  ACCOUNT FOR INDEX      @SA70322 51799010
         SR    R9,R0                    BACK UP TO CURRENT ENT @SA70322 51800010
         STCM  R9,AD,LCBINVPT           SET UP CURRENT ENTRY     Y01004 51804010
         SR    R11,R11                  CLEAR FOR IC           @SA62375 51804510
         IC    R11,DCBEIOBX             GET IOB SIZE           @SA62375 51805010
         SH    R11,EIGHT                GET OFFSET TO EXTENSION@SA62375 51805510
         LA    R11,ZERO(R11,RLCB)       ADDR OF EXTENSION      @SA62375 51806010
         USING IEDQLCBX,R11                                    @SA62375 51806510
         MVC   LCBERADR(THREE),LCBINVPT SET INVLIST ADDRESS    @SA62375 51807010
         DROP  R11                                             @SA62375 51807510
         LA    R1,0(R14,R14)            CLEAR R1 AND DOUBLE INDEXY01004 51808010
         SR    R7,R1                    POINT TO TNT INDEX       Y01004 51812010
         ICM   R1,HALF,0(R7)            PICK UP TNT INDEX        Y01004 51816010
         LR    R5,R1                    SAVE TNT OFFSET          Y01004 51820010
         L     R15,AVTRNMPT             ADDR OF CONVERSION ROUT. Y01004 51824010
         BALR  R14,R15                  LINK TO IT               Y01004 51828010
*                                                                Y01004 51832010
         L     RPREFIX,0(R1)            QCB ADDRESS              Y01004 51836010
         OI    LCBTSOB,LCBTSBUF         INDICATE TIME-SHARING    S22029 51840010
*                                       TERMINAL ON THIS LINE    S22029 51844010
         TM    QCBFLAG-IEDQQCB(RPREFIX),QCBTSSES  TIME-SHARING   X02004 51848010
*                                       TERMINAL CONNECTED NOW   X02004 51852010
         BO    MIX0270                  YES,LINE STATUS IS OK    S22029 51856010
         SPACE 1                                                        51860010
         NI    LCBTSOB,AVTEFF-LCBTSBUF  NO, INDICATE A TCAM      S22029 51864010
*                                       TERMINAL ON THIS LINE    S22029 51868010
MIX0270  EQU   *                                                 S22029 51872010
         SR    R0,R0                    CLEAR REGISTERS          Y01004 51876010
         LR    R1,R0                                             Y01004 51880010
         IC    R0,QCBSCBOF-IEDQQCB(RPREFIX) SCB OFFSET           Y01004 51884010
         IC    R1,AVTSCBSZ              SIZE OF AN SCB           Y01004 51888010
         MR    R0,R0                    CALCULATE SCB ADDRESS    Y01004 51892010
         AL    R1,LCBSCBDA-1            ADD DIRECTORY ADDRESS    Y01004 51896010
         LR    R11,R1                   SCB ADDRESS TO SCB REG.  Y01004 51900010
         STCM  R1,AD,LCBSCBA            SET SCB ADDRESS          Y01004 51904010
NOTVALID EQU   *                                                 Y01004 51908010
         STH   R5,LCBTTCIN              UNKNOWN CURRENTLY        Y01004 51912010
*                                       CONNECTED                Y01004 51916010
         SR    R0,R0                    SINCE ENTRY TO THIS ROUT Y01004 51920010
*                                       IS WITH HEADER BUFFER    Y01004 51924010
*                                       ONLY - INDICATE NO       Y01004 51928010
*                                       BUFFERS TO FREE          Y01004 51932010
         B     CONTINUE                 RETURN                   Y01004 51936010
*                                                                Y01004 51940010
CONVREAL EQU   *                                                 Y01004 51944010
         IC    R5,PRFNBUNT              NUMBER OF UNITS          Y01004 51948010
         LR    R11,RPREFIX              SET FOR COMMON EXIT      Y01004 51952010
REALOOP  EQU   *                                                 Y01004 51956010
         ICM   R1,AD,PRFIOADR           I/O ADDRESS              Y01004 51960010
         LRA   R1,0(,R1)                CONVERT TO REAL          Y01004 51964010
         STCM  R1,AD,PRFIOADR           STORE IN CCW             Y01004 51968010
         MVI   PRFOPCDE,READ            RESET READ OP CODE       Y02027 51972010
         ICM   R9,AD,PRFTIC+ONE         TIC TO ADDRESS           Y01004 51976010
         LRA   R1,0(,R9)                CONVERT TO REAL          Y01004 51980010
         STCM  R1,AD,PRFTIC+ONE         SET REAL TIC TO          Y01004 51984010
         OI    PRFTIC,REALTIC           RESET REAL TIC OP CODE   Y01004 51988010
         LR    RPREFIX,R9               NEXT UNIT ADDRESS        Y01004 51992010
         BCT   R5,REALOOP               CONVERT NEXT UNIT        Y01004 51996010
*                                                                Y01004 52000010
         B     SETEXIT                  USE COMMON CODE          Y01004 52004010
*                                                                Y01004 52008010
POST     EQU   *                                                 Y01004 52012010
         STCM  R7,AD,PRFQCBA            SET QCB ADDR. IN ELEMENT Y01004 52016010
         DROP  RAVT                                              Y02027 52020010
         L     RCVT,CVTPTR              PICKUP CVT ADDRESS       Y02027 52022010
         L     RAVT,CVTAQAVT           PICKUP ADDR OF TCAM'S     Y02027 52026010
*                                       CVT EXTENSION            Y02027 52028010
         USING IEDQTCX,RAVT                                      Y02027 52032010
         L     CURR,TCXREADY            PICKUP ADDR OF CURRENT   Y02027 52034010
*                                       ELEMENT ON AYNCHRONOUS   Y02027 52036010
*                                       READY QUEUE              Y02027 52038010
NEWCURR  STCM  CURR,SEVEN,PRFLINK       LINK NEW ELEMENT TO THE  Y02027 52040010
*                                       CURRENT ELEMENT          Y02027 52042010
         CS    CURR,RPREFIX,TCXREADY    WAS CURRENT ELEMENT      Y02027 52044010
*                                       UPDATED ASYNCHRONOUSLY   Y02027 52046010
         BNE   NEWCURR                  YES, LINK NEW ELEMENT    Y02027 52048010
*                                       TO NEW CURRENT ELEMENT   Y02027 52050010
*                                       NO, ASYNCHRONOUS RDY Q   Y02027 52052010
*                                       IS UPDATED WITH NEW ELEM Y02027 52054010
*                                       BY COMPARE-AND-SWAP INST Y02027 52056010
         L     RAVT,TCXAVT              RESTORE AVT ADDRESS      Y02027 52058010
         DROP  RAVT                                              Y02027 52060010
         USING IEDQAVTD,RAVT                                     Y02027 52062010
         BR    R14                      RETURN                   Y01004 52068010
*                                                                Y01004 52072010
*********************************************************************** 52076010
*                                                                     * 52080010
*        THE FOLLOWING SUBROUTINE IS ADDED FOR AOS TO CONVERT REAL    * 52084010
*        ADDRESSES TO VIRTUAL.  THE FOLLOWING REGISTERS ARE USED ON   * 52088010
*        EXIT TO IEAPTRV:                                             * 52092010
*              R1 = REAL ADDRESS TO BE TRANSLATED.                    * 52096010
*              R14 = RETURN ADDRESS IN IGG019RN.                      * 52100010
*              R15 = ENTRY POINT ADDRESS IN IEAPTRV.                  * 52104010
*        UPON RETURN FROM IEAPTRV, REGISTER CONTENTS ARE AS FOLLOWS:  * 52108010
*              R0 = CONTENTS DESTROYED BY IEAPTRV.                    * 52112010
*              R1 = VIRTUAL ADDRESS.                                  * 52116010
*              R14 = RETURN ADDRESS IN IGG019RN.                      * 52120010
*              R15 = RETURN CODE.                                     * 52124010
*                                                                     * 52128010
VIRTUAL  EQU   *                                                 Y01004 52132010
         L     R15,CVTPTR               R15 = CVT ADDRESS.       Y01004 52136010
         L     R15,CVTPTRV              R15 V ADDRESS OF AOS     Y02027 52140010
*                                       REAL TO VIRTUAL SUBROUT. Y01004 52144010
         LA    R1,ZERO(,R1)             CLEAR HIGH-ORDER BYTE OF Y01004 52148010
*                                       REGISTER CONTAINING REAL Y01004 52152010
*                                       ADDRESS TO ZERO          Y01004 52156010
         BR    R15                      LINK OUT TO IEAPTRV.     Y01004 52160010
*                                                                     * 52164010
*        END OF SUBROUTINE ADDED FOR AOS.                             * 52168010
*                                                                     * 52172010
*********************************************************************** 52176010
         SPACE 2                                                        68400010
SAVEREG  DS    17F                      GENERAL POLL SAVE AREA   S99228 69000010
SRCREGS  DS    4F                       SAVE AREA FOR SOURCE     S99228 69300010
*                                       DETERMINATION REGISTERS  S99228 69600010
SIZE     DC    AL2(LCBFLAG1-IEDQLCB)    OFFSET TO IOB FROM LCB   S22025 71300010
EIGHT    DC    H'8'                     HALFWORD OF EIGHT        S22025 71400010
SIXTEEN  DC    H'16'                    LCB EXTENSION            X02004 71500010
XMPOSTMK DC    X'80'                    MASK TO INDICATE CROSS   Y02027 71600010
*                                       MEMORY POST              Y02027 71700010
END19RN  EQU   *                        END OF LOAD MODULE       X02004 72070010
         EJECT                                                          72140010
         CVT   DSECT=YES                                                72150010
         EJECT                                                          72160010
         TTCXD                                                          72170010
         EJECT                                                          72180010
         TDEBD                                                   Y01004 72210010
         EJECT ,                                                 S22025 72300010
         TPRIOR                                                         72400010
         EJECT ,                                                 S22025 72500010
         TCCWD                                                          72600010
         EJECT ,                                                 S22025 72700010
         DCBD  DSORG=TX                                                 72800010
DCBILIST EQU   DCBINVLI                                                 73000010
         EJECT ,                                                 S22025 73100010
         TPRFD                                                          73200010
         EJECT ,                                                 S22025 73300010
         TLCBD                                                          73400010
         EJECT ,                                                 S22025 73500010
         TTNTD                                                          73600010
         EJECT ,                                                 S22025 73700010
         TQCBD                                                          73800010
         EJECT ,                                                 S22025 73850010
         TTCBD                                                          73900010
         EJECT ,                                                 S22025 73950010
         TSCBD                                                          74000010
         EJECT ,                                                 S22025 74100010
         TAVTD                                                          74200010
         TDRQD                                                   S22026 74250010
         EJECT ,                                                 S22025 74270010
         TTRMD                                                   S22026 74300010
         EJECT ,                                                 S22025 74320010
         TQCBED                                                  S22026 74350010
         END                                                            74400010
