         TITLE 'IGG0202B  ISAM FORCE/TASK CLOSE EXECUTOR'               00010002
IGG0202B CSECT                                                          00020002
         ENTRY IGG0202C                                                 00030002
*                                                                       00040002
*********************************************************************** 00050002
*                                                                     * 00060002
* MODULE-NAME = IGG0202B                                              * 00070002
*                                                                     * 00080002
* DESCRIPTIVE-NAME = ISAM FORCE/TASK CLOSE EXECUTOR                   * 00090002
*                                                                     * 00100002
* COPYRIGHT = NONE                                                    * 00110002
*                                                                     * 00120002
* STATUS = RELEASE OS/VS2-02, LEVEL 0                                 * 00130002
*                                                                     * 00140002
* FUNCTION = THIS ROUTINE IS ENTERED DURING NORMAL AND ABNORMAL       * 00150002
*            MEMORY TERMINATION, NORMAL AND ABNORMAL TASK             * 00160002
*            TERMINATION, AND DURING FORCE CLOSE PROCESSING TO        * 00170002
*            ENSURE THAT ALL DCB FIELD AREAS ARE FREED WHEN ALL OF    * 00180002
*            THE DCBS REFERENCING THEM ARE CLOSED.                    * 00190002
*                                                                     * 00200002
*            WHEN INVOKED DURING MEMORY TERMINATION (NORMAL OR        * 00210002
*            ABNORMAL), OR TASK TERMINATION (NORMAL OR ABNORMAL)      * 00220002
*            WHEN IT IS THE JOB STEP TASK, THE ADDRESS SPACE WILL     * 00230002
*            BE DISASSOCIATED FROM THE FIELD AREAS IT IS USING. THE   * 00240002
*            TOTAL USE COUNT OF EACH FIELD AREA WILL BE DECREMENTED   * 00250002
*            BY THE NUMBER OF USERS IN THE TERMINATING ADDRESS        * 00260002
*            SPACE (OR TASK).  IF THE TOTAL USE COUNT GOES TO ZERO,   * 00270002
*            THE FIELD AREA'S CORE WILL BE FREED.                     * 00280002
*                                                                     * 00290002
*            WHEN INVOKED DURING NORMAL OR ABNORMAL TASK TERMINATION, * 00300002
*            WHEN NOT THE JOB STEP TASK, OR FORCE CLOSE PROCESSING,   * 00310002
*            THE APPROPRIATE USE COUNTS WILL BE DECREMENTED BY ONE.   * 00320002
*            THE FIELD AREA WILL BE FREED IF ITS USE COUNT GOES TO    * 00330002
*            ZERO.                                                    * 00340002
*                                                                     * 00350002
*            IN ALL CASES, WHEN AN ADDRESS SPACE (ASID) USE COUNT     * 00360002
*            GOES TO ZERO, IT WILL BE REPLACED BY THE LAST ASID USE   * 00370002
*            COUNT ENTRY IN THE FIELD AREA OR FIELD AREA EXTENSION.   * 00380002
*            THE LAST ENTRY WILL THEN BE CLEARED.  IF THIS LAST       * 00390002
*            ENTRY WAS THE ONLY ASID USE COUNT ENTRY IN A FIELD AREA  * 00410002
*            EXTENSION, THE EXTENSIONS CORE WILL BE FREED.            * 00420002
*                                                                     * 00430002
* NOTES = SEE BELOW                                                   * 00440002
*                                                                     * 00450002
*    DEPENDENCIES = NONE                                              * 00460002
*                                                                     * 00500002
*    RESTRICTIONS = NONE                                              * 00510002
*                                                                     * 00520002
*    REGISTER-CONVENTIONS = SEE REGISTER EQUATES                      * 00530002
*                                                                     * 00540002
*    PATCH-LABEL = PATCH, A DC STATEMENT                              * 00550002
*                                                                     * 00560002
* MODULE-TYPE = RECOVERY ROUTINE                                      * 00570002
*                                                                     * 00580002
*    PROCESSOR = ASSEMXF-370R                                         * 00590002
*                                                                     * 00600002
*    MODULE-SIZE = 858 DECIMAL BYTES                                  * 00610002
*                                                                     * 00620002
*    ATTRIBUTES = REENTRANT, SUPERVISOR STATE, ENABLED                * 00630002
*                                                                     * 00640002
* ENTRY-POINT = IGG0202B, IGG0202C                                    * 00650002
*                                                                     * 00660002
*    PURPOSE = FOR ENTRY POINT IGG0202B, FORCE CLOSE PROCESSING.      * 00664002
*                                                                     * 00668002
*    LINKAGE = FOR ENTRY POINT IGG0202B, FORCE CLOSE ENTRY:           * 00670002
*              REGISTER  2 - ADDR OF COPIED DCB BEING FORCED CLOSED.  * 00680002
*              REGISTER  4 - ADDR OF O/C/E WORK AREA.                 * 00690002
*              REGISTER  5 - O/C/E RECOVERY ROUTINE WORK AREA ADDR.   * 00700002
*              REGISTER  6 - ADDR OF WHERE-TO-GO (WTG) TABLE.         * 00710002
*              REGISTER  7 - ADDR OF RECOVERY TERMINATION             * 00720002
*                            COMMUNICATION AREA (RTCA).               * 00722002
*              REGISTER  8 - ADDR OF PARAMETER LIST DEFINED BY O/C/E  * 00740002
*                            WHEN IT ISSUED ESTAE ESTABLISHING ITS    * 00750002
*                            RECOVERY ROUTINE.                        * 00760002
*              REGISTER  9 - ADDR OF DD ENTRY FOR DCB BEING FORCED    * 00770002
*                            CLOSED, OR ZERO.                         * 00780002
*              REGISTER 11 - ADDR OF DEB FOR DCB BEING FORCED         * 00790002
*                            CLOSED, OR ZERO.                         * 00800002
*              REGISTER 13 - ADDR OF 18 WORD REGISTER SAVE AREA,      * 00810002
*                            STORAGE PROTECT KEY 5.                   * 00820002
*              REGISTER 14 - RETURN ADDRESS.                          * 00830002
*              REGISTER 15 - ENTRY POINT IGG0202B ADDRESS.            * 00840002
*                                                                     * 00850002
*    PURPOSE = FOR ENTRY POINT IGG0202C, MEMORY OR TASK TERMINATION.  * 00860002
*                                                                     * 00870002
*    LINKAGE = FOR ENTRY POINT IGG0202C, TASK CLOSE:                  * 00880002
*              REGISTER  1 - POINTS TO PARAMETER LIST WHICH HAS       * 00890002
*                            POINTER TO RECOVERY WORK AREA (IHARMPL). * 00900002
*              REGISTER 13 - POINTS TO 18 WORD STANDARD SAVE AREA,    * 00910002
*                            STORAGE PROTECT KEY 0.                   * 00920002
*              REGISTER 14 - RETURN ADDRESS.                          * 00930002
*              REGISTER 15 - ENTRY POINT IGG0202C ADDRESS.            * 00940002
*              REGISTERS 0, 2-12 UNRELIABLE.                          * 00950002
*                                                                     * 00960002
* INPUT = SEE DESCRIPTION OF LINKAGES AS DEFINED FOR ENTRY POINTS     * 00970002
*         IGG0202B AND IGG0202C ABOVE.                                * 00980002
*                                                                     * 00990002
* OUTPUT = RESTORE REGISTERS UPON EXITING.                            * 01000002
*                                                                     * 01010002
* EXIT-NORMAL = REGISTER 15 WITH RETURN CODE TO CALLER:               * 01020002
*               00 - RETURN CODE TO TASK CLOSE.                       * 01030002
*               04 - RETURN CODE TO FORCE CLOSE                       * 01040002
*                                                                     * 01050002
* EXIT-ERROR = NONE                                                   * 01060002
*                                                                     * 01070002
* EXTERNAL REFERENCES = SEE BELOW                                     * 01080002
*                                                                     * 01090002
*    ROUTINES = SETLOCK                                               * 01100002
*               FREEMAIN                                              * 01110002
*                                                                     * 01120002
*    DATA-AREAS = PREFIXED SAVE AREA (PSA)                            * 01130002
*                 RECOVERY WORK AREA (IHARMPL)                        * 01130802
*                                                                     * 01132002
*    CONTROL-BLOCK = CVT                                              * 01140002
*                    DCBFA (DCB FIELD AREA)                           * 01150002
*                    DEB                                              * 01160002
*                    ASCB                                             * 01180002
*                    TCB                                              * 01190002
*                                                                     * 01210002
* TABLES = NONE                                                       * 01220002
*                                                                     * 01230002
* MACROS = SAVE, SAVE REGISTERS ON ENTRY.                             * 01240002
*          MODESET, CHANGE STORAGE PROTECT KEY.                       * 01250002
*          RETURN, TO RESTORE REGISTERS AND SET RETURN CODE FOR EXIT. * 01260002
*          SETLOCK, TO OBTAIN/RELEASE LOCAL AND CMS LOCKS.            * 01270002
*          FREEMAIN, BRANCH ENTRY TO FREE FIELD AREA OR EXTENSION.    * 01280002
*                                                                     * 01290002
* CHANGE-ACTIVITY = AS FOLLOWS:                                       * 01300002
*                                                                     * 01310002
*        OS/VS2-02 DELETIONS/CHANGES                                  * 01312002
*                                                               YM07088 01322002
* C483400,A493900                                               ZA01285 01324000
*              VS2 RELEASE 030 CHANGES                                  01326037
* C494400-495400                                                OZ04534 01327037
*              CHANGES SINCE VS2-3.7                                  * 01328037
* A162500-163000                                               @ZA08299 01333037
* C165320                                                      @ZA08299 01336037
*A183400,187600,194900,498400                                  @ZA19614 01337037
*C186900,188300                                                @ZA19614 01338037
*A058600-059100                                                @ZA31151 01339037
*********************************************************************** 01340002
         EJECT                                                          01440002
* REGISTER EQUATES                                                      01540002
*                                                                       01640002
RWRK1    EQU   0                        WORK REGISTER                   01740002
RWRK2    EQU   1                        WORK REGISTER                   01840002
RCURRID  EQU   2                        CURRENT MEMORY ASID             01940002
RWRK3    EQU   3                        WORK REGISTER                   02040002
RTCB     EQU   4                        TCB REGISTER                    02140002
RDCBFA   EQU   5                        DCB FIELD AREA (FA) REGISTER    02240002
RLINK    EQU   6                        SUBROUTINE LINKAGE REGISTER     02340002
RASCB    EQU   7                        ASCB REGISTER/WORK REGISTER     02440002
RDEB     EQU   8                        ADDR OF CURR DEB IN QUEUE       02540002
RBASE    EQU   9                        BASE REGISTER                   02640002
RSAVE    EQU   10                       SAVE SAVE AREA ADDR             02740002
RASID    EQU   11                       PTR TO ASID COUNT FIELDS        02840002
REXT     EQU   12                       FIELD AREA EXTENSION PTR        02940002
RCNTR    EQU   13                       SAVE AREA ADDR ON ENTRY, USED   03040002
*                                       AS COUNTER FOR ASID ENTRIES     03140002
RRETRN   EQU   14                       RETURN ADDR ON ENTRY, USED AS   03240002
*                                       WORK REGISTER                   03340002
RENTRY   EQU   15                       ENTRY POINT ADDR, USED AS WORK  03440002
*                                       REGISTER                        03540002
*********************************************************************** 03640002
*                                                                     * 03740002
*    IGG0202B - ISAM FORCE CLOSE EXECUTOR ENTRY POINT.  ON ENTRY WILL * 03840002
*               TEST FOR DEB ADDRESS BEING PASSED.  IF NONE PASSED,   * 03940002
*               WILL SET RETURN CODE OF 4 AND RETURN.  ENTERED IN     * 04040002
*               STORAGE PROTECT KEY 5, SUPERVISORY STATE.             * 04140002
*                                                                     * 04240002
*********************************************************************** 04340002
         SPACE 2                                                        04440002
         USING IGG0202B,RENTRY          ESTABLISH ADDRESSABILITY        04540002
         LTR   RASID,RASID              DEB ADDRESS PASSED              04640002
         BNZ   CONTINUE                 BR YES                          04740002
         LA    RENTRY,RCODE4            NO DEB ADDR, SET RTRN CODE 4    04840002
         BR    RRETRN                   RETURN TO FORCE CLOSE           04940002
*                                                                       05040002
CONTINUE SAVE  (14,12)                  SAVE REGISTERS                  05140002
         DROP  RENTRY                   END BASE USING                  05240002
         LR    RBASE,RENTRY             ESTABLISH NEW BASE REGISTER     05340002
         USING IGG0202B,RBASE           MODULE ADDRESSABILITY           05440002
         LR    RSAVE,RCNTR              SAVE SAVE AREA ADDRESS          05540002
*                                                                       05640002
         LR    RDEB,RASID               DEB ADDRESS                     05740002
         USING DEBBASIC,RDEB            DEB ADDRESSABILITY              05840002
         LR    RWRK3,RDEB               DEB ADDRESS            @ZA31151 05860037
         SH    RWRK3,NPFX               POINT TO DEB PREFIX    @ZA31151 05870037
         USING DEBPREFX,RWRK3           DEB PFX ADDRESSABILITY @ZA31151 05880037
         CLC   DEBAMTYP,ISAM            IS THIS AN ISAM DEB?   @ZA31151 05890037
         BNE   FCEXIT                   NO-RET TO FORCE CLOSE  @ZA31151 05900037
         DROP  RWRK3                    END USING ON DEB PRFX  @ZA31151 05910037
         L     RASCB,DEBEXPT            ADDR OF DEB EXTENSION           05940002
         USING DEBACSMD,RASCB           DEB EXTENSION ADDRESSABILITY    06040002
         TM    DEBDCBFA,SHR             DATA SET OPENED FOR DISP = SHR  06140002
         BNO   FCEXIT                   BR NO, RETURN TO FORCE CLOSE    06240002
*                                                                       06340002
         L     RDCBFA,DEBDCBFA          ADDRESS OF DCB FIELD AREA       06440002
         USING DCBFA,RDCBFA             FIELD AREA ADDRESSABILITY       06460002
         SR    RWRK1,RWRK1              ZERO REGISTER                   06640002
         ST    RWRK1,DEBDCBFA           CLEAR FIELD AREA PTR IN DEB     06740002
         DROP  RASCB                    END DEB EXTENSION USING         06860002
         LA    RDCBFA,0(RDCBFA)         CLEAR HIGH BYTE                 06880002
         L     RTCB,DEBTCBAD            TCB ADDRESS                     06940002
         SPACE 2                                                        06960002
         MODESET KEYADDR=KEY0,WORKREG=11  CHANGE TO PROTECT KEY ZERO    07040002
         SPACE 2                                                        07140002
*    OBTAIN LOCAL AND CMS LOCKS, WILL BE IN PROTECT KEY 5 UPON          07240002
*    RETURN FROM GETLOCKS SUBROUTINE.                                   07340002
*                                                                       07440002
         BAL   RLINK,GETLOCKS           OBTAIN LOCAL AND CMS LOCKS      07540002
*                                                                       07640002
*    OBTAIN ADDRESS SPACE ID                                            07740002
*                                                                       07840002
         USING PSA,0                    LOW CORE ADDRESSABILITY         07940002
         L     RCURRID,PSAAOLD          ASCB ADDRESS                    08040002
         USING ASCB,RCURRID             ASCB ADDRESSABILITY             08140002
         LH    RCURRID,ASCBASID         ADDRESS SPACE ID                08240002
         DROP  RCURRID                  END USING ON ASCB               08340002
         SPACE 2                                                        08440002
*    SEARCH FIELD AREA AND EXTENSION(S) FOR ENTRY FOR THIS              08540002
*    ADDRESS SPACE.                                                     08640002
*                                                                       08740002
         BAL   RLINK,ASIDSRCH           SEARCH FA FOR ASID ENTRY        08840002
*                                                                       08940002
         LTR   RASID,RASID              ASID FOUND IN FIELD AREA        09040002
         BZ    FREELCKS                 BR NO, FREE LOCKS AND RETURN    09140002
*                                                                       09240002
         LH    RWRK1,DFAUSE             TOTAL OF ALL ASID USE COUNTS    09340002
         BCT   RWRK1,STORUSE            LESS ONE, BR IF NOT ZERO        09440002
         SPACE 2                                                        09540002
*    TOTAL USE COUNT FOR FIELD AREA HAS GONE TO ZERO.  GO REMOVE        09640002
*    FROM FIELD AREA CHAIN AND FREE ITS CORE                            09740002
*                                                                       09840002
         BAL   RLINK,FREEFA             FREE FIELD AREA CORE            09940002
*                                                                       10040002
         B     FREELCKS                 FREE LOCKS AND RETURN           10140002
         SPACE 2                                                        10240002
*    STORE NEW USE COUNT.  DECREMENT CURRENT ASID USE COUNT AND IF      10340002
*    IT GOES TO ZERO, MOVE LAST ASID ENTRY IN FIELD AREA OR EXTENSION   10440002
*    TO REPLACE IT.  IF LAST ENTRY IS ONLY ENTRY IN AN EXTENSION,       10540002
*    FREE ITS CORE.                                                     10640002
*                                                                       10740002
STORUSE  STH   RWRK1,DFAUSE             STORE NEW TOTAL USE COUNT       10840002
         USING DFAASID,RASID            ASID ENTRY ADDRESSABILITY       10860002
         LH    RWRK1,DFAUSEX            ASID USE COUNT                  10940002
         BCT   RWRK1,STORCNT            ASID COUNT LESS ONE, BR NOT 0   11040002
*                                                                       11140002
         BAL   RLINK,ASIDUPDT           MOVE LAST ASID ENTRY            11240002
*                                                                       11340002
         B     FREELCKS                 FREE LOCKS AND RETURN           11440002
*                                                                       11540002
STORCNT  STH   RWRK1,DFAUSEX            STORE NEW ASID USE COUNT        11640002
         DROP  RASID                    END ASID ENTRY USING            11660002
         SPACE 2                                                        11740002
*    RELEASE THE CMS AND LOCAL LOCKS AND RETURN TO FORCE CLOSE.         11840002
*                                                                       11940002
FREELCKS BAL   RLINK,FREELOCK           RELEEASE LOCKS, RETURNS IN      12040002
*                                       PROTECT KEY 0.                  12140002
         SPACE 2                                                        12160002
         MODESET EXTKEY=DATAMGT         CHANGE TO DATA MGT KEY          12240002
         SPACE 2                                                        12260002
FCEXIT   LR    RCNTR,RSAVE              SAVE AREA ADDR                  12340002
         RETURN (14,12),RC=4            RETURN TO FORCE CLOSE           12440002
*                                       WITH RETURN CODE OF 4           12540002
         EJECT                                                          12640002
*********************************************************************** 12740002
*    IGG0202C - TASK CLOSE ROUTINE.  THIS ROUTINE IS ENTERED IN THE   * 12840002
*    EVENT OF A NORMAL OR ABNORMAL MEMORY OR TASK TERMINATION.  IN    * 12940002
*    THE EVENT OF A TASK TERMINATION, AND NOT THE JOB STEP TCB, THE   * 13040002
*    ROUTINE WILL SEARCH THE TCB'S DEB QUEUE FOR AN ISAM DEB.  IF     * 13140002
*    THAT DEB IS FOR A SHARED DATA SET, IT WILL BE DISASSOCIATED      * 13240002
*    FROM THE FIELD AREA AND THE APPROPRIATE USE COUNTS DECREMENTED.  * 13340002
*    IN ALL OTHER EVENTS THE TOTAL USE COUNT WILL BE DECREMENTED BY   * 13440002
*    THE ASID USE COUNT AND THEN THAT ASID USE COUNT SET TO ZERO.     * 13540002
*********************************************************************** 13640002
         SPACE 2                                                        13740002
IGG0202C DS    0F                       TASK CLOSE, IN PROTECT KEY 0    13840002
         SAVE  (14,12)                  SAVE REGISTERS                  13940002
         USING IGG0202C,RENTRY          ADDRESSABILITY                  14040002
         L     RBASE,COMMON             ADDR OF BEGINNING OF MODULE     14140002
         DROP  RENTRY                   END BASE USING                  14240002
         USING IGG0202B,RBASE           COMMON BASE ADDRESSABILITY      14340002
         LR    RSAVE,RCNTR              SAVE SAVE AREA ADDR             14440002
         SPACE 2                                                        14540002
*    DETERMINE IF THERE ARE ANY FIELD AREAS, RETURN TO TASK CLOSE       14640002
*    NO FIELD AREAS.                                                    14740002
*                                                                       14840002
         L     RASCB,CVTPTR             ADDRESS OF CVT                  14940002
         USING CVT,RASCB                CVT ADDRESSABILITY              15040002
         L     RASCB,CVTEXT1            ADDR OF CVT EXTENSION           15140002
         USING CVTXTNT1,RASCB           CVT EXTENSION ADDRESSABILITY    15240002
         L     RDCBFA,CVTFACHN          FIELD AREA POINTER              15340002
         DROP  RASCB                    END CVT EXTENSION USING         15440002
         LTR   RDCBFA,RDCBFA            ANY FIELD AREAS                 15540002
         BZ    TCEXIT                   BR NO, RETURN TO TASK CLOSE     15640002
         SPACE 2                                                        15740002
*    OBTAIN THE LOCAL AND CMS LOCKS.  GETLOCKS ROUTINE WILL OBTAIN      15840002
*    LOCKS AND RETURN IN DATA MGT PROTECT KEY (5)                       15940002
*                                                                       16040002
         L     RWRK3,0(RWRK2)           RECOVERY WORK AREA ADDR YM07088 16140002
         BAL   RLINK,GETLOCKS           OBTAIN LOCKS, WILL BE IN        16240002
         USING CVTXTNT1,RASCB           PROVIDE ADDRESSABILITY @ZA08299 16250037
         L     RDCBFA,CVTFACHN          POINTER TO FIELD AREA  @ZA08299 16260037
         DROP  RASCB                    NO LONGER NEEDED       @ZA08299 16270037
         LTR   RDCBFA,RDCBFA            DOES FIELD AREA EXIST? @ZA08299 16280037
         BNZ   FINDTERM                 IF YES - CONTINUE      @ZA08299 16290037
         B     KEYZRO                   ELSE RETURN            @ZA08299 16300037
*                                       PROTECT KEY 5 ON RETURN         16340002
         SPACE 2                                                        16440002
*    OBTAIN ADDRESS SPACE ID                                            16490002
*                                                                       16500002
         USING RMPL,RWRK3               RECOVERY WA ADDR        YM07088 16510002
FINDTERM LH    RCURRID,RMPLASID         ADDRESS SPACE ID       @ZA08299 16532037
         SPACE 2                                                        16536002
*    DETERMINE TYPE OF TERMINATION IN PROGRESS.                         16540002
*                                                                       16640002
         SR    RTCB,RTCB                NO TCB FOR MEMORY TERMINATION   16740002
         TM    RMPLFLG1,MEMTERM         MEMORY TERMINATION              16940002
         BO    FAADDR                   BR YES                          17040002
*                                                                       17140002
         L     RTCB,RMPLTCBA            TCB ADDRESS                     17240002
         TM    RMPLFLG1,JSTCB           THIS THE JOB STEP TCB           17340002
         BO    FAADDR                   BR YES                          17440002
         SPACE 2                                                        17540002
*********************************************************************** 17560002
*    SUBTASK TERMINATING - SEARCH TCB DEB QUEUE FOR ISAM DEBS.  IF    * 17640002
*    DATA SET OPENED FOR SHARE, DISASSOCIATE DEB FROM FIELD AREA,     * 17740002
*    DECREMENT APPROPRIATE USE COUNTS.                                * 17840002
*********************************************************************** 17940002
         SPACE 2                                                        17960002
         USING TCB,RTCB                 TCB ADDRESSABILITY              18040002
         DROP  RWRK3                    END RECOVERY WA USING           18140002
         L     RDEB,TCBDEB              ADDR OF FIRST DEB               18240002
         LA    RDEB,0(RDEB)             CLEAR THE HIGH BYTE    @ZA19614 18340037
         LTR   RDEB,RDEB                ANY DEBS IN QUEUE               18410037
         BZ    KEYZRO                   BR NO, RELEASE LOCKS            18480037
         USING DEBBASIC,RDEB            DEB ADDRESSABILITY              18550037
*                                                                       18620037
TSTAMTYP LR    RWRK3,RDEB               COPY DEB ADDRESS       @ZA19614 18690037
         SH    RWRK3,NPFX               POINT TO DEB PREFIX    @ZA19614 18760037
         USING DEBPREFX,RWRK3           DEB PREFIX ADDRESSABLE @ZA19614 18830037
*                                                                       18940002
         CLC   DEBAMTYP,ISAM            THIS AN ISAM DEB                19040002
         BE    SEARCH                   BR YES                          19140002
         DROP  RWRK3                    END USING ON DEB PREFIX         19240002
*                                                                       19340002
QUEUE    L     RDEB,DEBDEBAD            ADDR OF NEXT DEB IN QUEUE       19440002
         LA    RDEB,0(RDEB)             CLEAR THE HIGH BYTE    @ZA19614 19490037
         LTR   RDEB,RDEB                ANOTHER DEB                     19540002
         BNZ   TSTAMTYP                 BR YES                          19640002
         B     KEYZRO                   NO, END OF DEB QUEUE            19740002
         SPACE 2                                                        19840002
*    TEST FOR SHARED DATA SET.  IF SHARED SEARCH FIELD AREA AND         19940002
*    EXTENSION (IF PRESENT) FOR ASID ENTRY.                             20040002
*                                                                       20140002
SEARCH   EQU   *                        TEST FOR SHARED DISP.           20240002
         L     RWRK3,DEBEXPT            ADDR OF DEB EXTENSION           20340002
         USING DEBACSMD,RWRK3           EXTENSION ADDRESSABILITY        20440002
         TM    DEBDCBFA,SHR             THIS A SHARED DATA SET          20540002
         BZ    QUEUE                    BR NO, TEST NEXT DEB            20640002
         L     RDCBFA,DEBDCBFA          YES, FIELD AREA ADDRESS         20740002
         LA    RDCBFA,0(RDCBFA)         CLEAR HIGH BYTE                 20840002
*                                                                       20940002
         BAL   RLINK,ASIDSRCH           IS THIS ASID REF. IN FIELD      21040002
*                                       AREA POINTED TO BY DEB          21140002
         LTR   RASID,RASID              ASID FOUND                      21240002
         BZ    QUEUE                    BR NO, TEST FOR MORE DEBS       21340002
         SPACE 2                                                        21440002
*    ASID ENTRY FOUND IN FIELD AREA (OR EXTENSION).  SUBTRACT ONE       21540002
*    FROM TOTAL USE COUNT, IF ZERO FREE FIELD AREA CORE.                21640002
*                                                                       21740002
         LH    RWRK2,DFAUSE             TOTAL USE COUNT                 21840002
         BCT   RWRK2,STORECNT           LESS ONE, BR IF NOT 0           21940002
*                                                                       22040002
         SR    RWRK2,RWRK2              SET REGISTER TO ZERO            22140002
         ST    RWRK2,DEBDCBFA           CLEAR FIELD AREA POINTER        22240002
         DROP  RWRK3                    END DEB EXTENSION USING         22340002
         BAL   RLINK,FREEFA             FREEFIELD AREA CORE             22440002
         B     QUEUE                    TEST FOR MORE DEBS              22540002
         SPACE 2                                                        22640002
*    TOTAL USE COUNT OF FIELD AREA DID NOT GO TO ZERO.  STORE NEW       22660002
*    USE COUNT AND UPDATE ASID USE COUNT FIELDS.                        22680002
*                                                                       22700002
STORECNT STH   RWRK2,DFAUSE             STORE UPDATED USE COUNT         22720002
*                                                                       22724002
         USING DFAASID,RASID            ASID ENTRY ADDRESSABILITY       22726002
         LH    RWRK2,DFAUSEX            ASID USE COUNT                  22726402
         BCT   RWRK2,STIDCNT            ASID COUNT LESS ONE, BR NOT 0   22726802
*                                                                       22727202
         BAL   RLINK,ASIDUPDT           MOVE LAST ASID ENTRY TO         22728002
*                                       REPLACE THIS ASID'S ENTRY       22732002
         B     QUEUE                    TEST FOR MORE DEBS              22736002
*                                                                       22736402
STIDCNT  STH   RWRK2,DFAUSEX            STORE NEW ASID USE COUNT        22736502
         B     QUEUE                    TEST FOR MORE DEBS              22736602
         DROP  RASID                    END ASID ENTRY USING            22736702
         SPACE 4                                                        22736802
*********************************************************************** 22737602
*    MEMORY OR JOB STEP TERMINATION.  REMOVE ALL OF THIS ADDRESS      * 22740002
*    SPACES ENTRIES IN ALL FIELD AREAS.  THE TOTAL USE COUNT OF       * 22840002
*    EACH FIELD AREA IS TO BE DECREMENTED BY THE ASID USE COUNT.      * 22940002
*    IF THE TOTAL USE COUNT GOES TO ZERO, THE FIELD AREA CORE WILL    * 23040002
*    BE FREED.  RDCBFA CONTAINS ADDRESS OF FIRST FA IN CHAIN.         * 23140002
*********************************************************************** 23160002
         SPACE 2                                                        23240002
FAADDR   BAL   RLINK,ASIDSRCH           FA ENTRY FOR THIS ASID          23340002
         LTR   RASID,RASID              ASID IN THIS FIELD AREA         23440002
         BZ    NXTFA                    BR NO, TEST NEXT FIELD AREA     23540002
*                                                                       23640002
         LH    RWRK1,DFAUSE             TOTAL OF ASID USE COUNTS        23740002
         USING DFAASID,RASID            ASID ADDRESSABILITY             23840002
         SH    RWRK1,DFAUSEX            C(RWRK1)=(TOTAL)-(ASID COUNT)   23940002
         BNZ   IDUPDT                   BRANCH IF TOTAL USE COUNT       24040002
*                                       DID NOT GO TO ZERO              24140002
         DROP  RASID                    END USING ON ASID               24240002
*                                                                       24340002
*    TOTAL USE COUNT IS ZERO.  REMOVE FIELD AREA FROM CHAIN AND         24440002
*    FREE ITS CORE.                                                     24540002
*                                                                       24640002
         L     RCNTR,DFACHAIN           ADDR OF NEXT FA IN CHAIN        24740002
         BAL   RLINK,FREEFA             FREE FIELD AREA CORE            24840002
         C     RDCBFA,ENDCHN            WAS THAT LAST FA IN CHAIN       24940002
         BE    KEYZRO                   BR YES - FINISHED               25040002
         B     FAADDR                   TEST FA FOR ASID                25140002
*                                                                       25240002
NXTFA    L     RDCBFA,DFACHAIN          ADDR ON FEXT FIELD AREA         25340002
         C     RDCBFA,ENDCHN            REACHED END OF FA CHAIN         25440002
         BNE   FAADDR                   BR NO                           25540002
         B     KEYZRO                   BR YES, RELEASE LOCKS           25640002
*                                                                       25740002
*    MOVE LAST ASID ENTRY TO REPLACE CURRENT ENTRY, FREE EXTENSION      25840002
*    IF LAST ASID ENTRY ONLY ENTRY IN THE EXTENSION.                    25940002
*                                                                       26040002
IDUPDT   STH   RWRK1,DFAUSE             STORE NEW TOTAL USE COUNT       26090002
*                                                                       26100002
         BAL   RLINK,ASIDUPDT           MOVE LAST ASID ENTRY TO         26140002
*                                       REPLACE THIS ASID'S ENTRY       26240002
         B     NXTFA                    TEST FOR ANOTHER FIELD AREA     26340002
         SPACE 2                                                        26440002
*    CHANGE TO KEY 0 AND RELEASE CMS AND LOCAL LOCKS.  CONTROL WILL     26540002
*    BE RETURNED IN PROTECT KEY 0.                                      26640002
*                                                                       26740002
KEYZRO   BAL   RLINK,FREELOCK           RELEASE LOCKS                   26840002
*                                                                       26940002
TCEXIT   LR    RCNTR,RSAVE              SAVE AREA ADDRESS               27040002
         RETURN (14,12),RC=0            RESTORE REGS, RETURN CODE = 0   27140002
         EJECT                                                          27240002
*********************************************************************** 27340002
*                                                                     * 27440002
*    GETLOCKS - THIS SUBROUTINE OBTAINS THE LOCAL AND CROSS MEMORY    * 27540002
*               SERVICES (CMS) LOCKS.  ON ENTRY TO THIS ROUTINE MUST  * 27640002
*               BE IN PROTECT KEY 0.  UPON EXIT FROM THIS ROUTINE     * 27740002
*               THE LOCAL AND CMS LOCKS WILL BE HELD AND WILL BE IN   * 27840002
*               PROTECT KEY 5.  REGISTERS 11, 12, 13, 14 ARE ALTERED. * 27940002
*                                                                     * 28040002
*********************************************************************** 28140002
         SPACE 2                                                        28240002
*    OBTAIN LOCAL LOCK, RELEASED AT FLCL IN THIS MODULE.                28340002
*                                                                       28440002
GETLOCKS EQU   *                        OBTAIN LOCKS                    28540002
         SPACE 2                                                        28560002
GLCL     SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,   OBTAIN THE           *28640002
               RELATED=(DCBFA,IGG0202B(FLCL))     LOCAL LOCK            28740002
         SPACE 2                                                        28840002
*    OBTAIN CMS LOCK, RELEASED AT FCMS IN THIS MODULE                   28940002
*                                                                       29040002
GCMS     SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,     OBTAIN CROSS MEMORY  *29140002
               RELATED=(DCBFA,IGG0202B(FCMS))     SERVICES LOCK         29240002
         SPACE 2                                                        29340002
         MODESET EXTKEY=DATAMGT         CHANGE TO DATA MGT KEY          29440002
         SPACE 2                                                        29460002
         BR    RLINK                    RETURN                          29540002
         EJECT                                                          29640002
*********************************************************************** 29740002
*                                                                     * 29840002
*    FREELOCK - THIS SUBROUTINE RELEASES THE CMS AND LOCAL LOCKS.     * 29940002
*               ENTRY TO THIS ROUTINE ASSUMES THAT THE CMS AND LOCAL  * 30040002
*               LOCKS ARE HELD AND IN PROTECT KEY 5.  UPON EXIT FROM  * 30140002
*               THIS ROUTINE NO LOCKS WILL BE HELD AND WILL BE IN     * 30240002
*               KEY 0.  REGISTERS 11, 12, 13, 14 ARE ALTERED.         * 30340002
*                                                                     * 30440002
*********************************************************************** 30540002
         SPACE 2                                                        30640002
FREELOCK MODESET KEYADDR=KEY0,WORKREG=11  CHANGE TO PROTECT KEY 0       30740002
         SPACE 2                                                        30840002
*    RELEASE CMS LOCK WHICH WAS OBTAINED AT GCMS IN THIS MODULE.        30940002
*                                                                       31040002
FCMS     SETLOCK RELEASE,TYPE=CMS,              RELEASE CMS            *31140002
               RELATED=(DCBFA,IGG0202B(GCMS))   LOCK                    31240002
         SPACE 2                                                        31340002
*                                                                       31440002
*    RELEASE LOCK, OBTAINED AT GLCL IN THIS MODULE.                     31540002
*                                                                       31640002
FLCL     SETLOCK RELEASE,TYPE=LOCAL,            RELEASE LOCK           *31740002
               RELATED=(DCBFA,IGG0202B(GLCL))   LOCKS                   31840002
         SPACE 2                                                        31860002
         BR    RLINK                    RETURN                          31940002
         EJECT                                                          32040002
*********************************************************************** 32140002
*                                                                     * 32240002
*    ASIDSRCH - THIS ROUTINE SEARCHES THE ASID ENTRIES IN A FIELD     * 32340002
*               AREA AND ITS EXTENSIONS FOR THE ASID OF THE CURRENT   * 32440002
*               TASK (MEMORY).  ON ENTRY TO THIS ROUTINE REGISTER     * 32540002
*               DCBFA MUST CONTAIN THE ADDRESS OF THE FIELD AREA AND  * 32640002
*               RCURRID THE ASID OF THE TERMINATING TASK (MEMORY).    * 32740002
*               UPON EXIT RASID WILL CONTAIN THE ADDRESS OF THE ASID  * 32840002
*               ENTRY IN THE FIELD AREA OR ZERO (ASID NOT FOUND),     * 32940002
*               REXT (REG 12) WILL CONTAIN THE ADDRESS OF THE         * 33040002
*               EXTENSION OR ZERO (ASID IN FIELD AREA), AND RCNTR     * 33140002
*               (REG 13) CONTAINS THE NO. OF ASID ENTRIES REMAINING   * 33240002
*               PLUS ONE.                                             * 33340002
*                                                                     * 33440002
*********************************************************************** 33540002
         SPACE 2                                                        33640002
ASIDSRCH LA    RASID,DFAASID1           ADDR OF FIRST ASID ENTRY        33740002
         SR    REXT,REXT                IND. SEARCH IN FIELD AREA       33840002
         USING DFAASID,RASID            ASID ADDRESSABILITIES           33940002
NOASIDS  LA    RCNTR,DFANOIDS           NO. OF ASID ENTRIES IN DCBFA    34040002
TESTASID CH    RCURRID,DFAASID          ASID FOR THIS ADDR SPACE        34140002
         BE    FOUND                    BR YES                          34240002
         BCT   RCNTR,INCRPTR            BR IF MORE ENTRIES              34340002
         L     REXT,DFAPTR              ADDR OF EXTENSION               34440002
         LTR   REXT,REXT                IS THERE AN EXTENSION           34540002
         BZ    NOTFND                   BR NO, ASID NOT FOUND           34640002
         USING DCBFAEX,REXT             FA EXTENSION ADDRESSABILITY     34740002
         LA    RASID,DFAXSID1           ADDR OF FIRST ASID ENTRY IN     34840002
*                                       FIELD AREA EXTENSION            34940002
         B     NOASIDS                  SEARCH EXTENSION FOR ASID       35040002
         DROP  REXT                     END USING OF FA EXTENSION       35140002
*                                                                       35160002
INCRPTR  LA    RASID,DFANXPTR(RASID)    PT TO NEXT ASID ENTRY FIELD     35180002
         B     TESTASID                 TEST NEXT ASID                  35200002
*                                                                       35240002
NOTFND   SR    RASID,RASID              IND. ASID NOT FOUND IN FA       35340002
FOUND    EQU   *                        BR HERE IF ASID FOUND           35440002
         BR    RLINK                    RETURN                          35540002
         EJECT                                                          35640002
*********************************************************************** 35740002
*                                                                     * 35840002
*    ASIDUPDT - THIS ROUTINE FINDS THE LAST ASID ENTRY IN THE FIELD   * 35940002
*               AREA (OR EXTENSION) AND MOVES IT INTO THE ASID FIELD  * 36040002
*               THAT IS BEING DELETED.  IF THE LAST ASID IS FOUND TO  * 36140002
*               BE THE ONLY ENTRY IN A FIELD AREA EXTENSION, THIS     * 36240002
*               ROUTINE WILL BRANCH TO THE FREEFA ROUTINE TO FREE     * 36340002
*               THE EXTENSIONS CORE.  INPUT TO THIS ROUTINE ARE       * 36440002
*               REGISTERS RASID (11), REXT (12), AND RCNTR (13) AS    * 36540002
*               DEFINED IN ROUTINE ASIDSRCH.                          * 36640002
*                                                                     * 36740002
*********************************************************************** 36840002
         SPACE 2                                                        36940002
ASIDUPDT LR    RWRK2,RASID              PT TO DELETED ASID ENTRY        37040002
         LR    RWRK3,RASID              PTR TO LAST ASID ENTRY FOUND    37140002
         SR    RWRK1,RWRK1              ZERO FOR COMPARE                37240002
LOOP     BCT   RCNTR,NXTFLD             BR IF MORE ENTRIES              37340002
         L     REXT,DFAPTR              ADDR OF EXTENSION               37440002
         LTR   REXT,REXT                IS THERE AN EXTENSION           37540002
         BZ    MOVEID                   BR NO, MOVE LAST ENTRY          37640002
         USING DCBFAEX,REXT             FA EXTENSION ADDRESSABILITY     37740002
         LA    RASID,DFAXSID1           ADDR OF FIRST ASID ENTRY        37840002
         DROP  REXT                     END USING ON EXTENSION          37940002
         LA    RCNTR,DFANOIDS           NO. ASID ENTRIES IN EXTENSION   38040002
         B     TESTID                   TEST FOR ASID ENTRY             38140002
*                                                                       38240002
NXTFLD   EQU   *                        TEST NEXT ENTRY                 38340002
         LA    RASID,DFANXPTR(RASID)    PT TO NEXT ASID ENTRY           38440002
*                                                                       38540002
TESTID   CH    RWRK1,DFAASID            IS THERE AN ASID ENTRY          38640002
         BE    MOVEID                   BR IF NO ASID                   38740002
         LR    RWRK3,RASID              SAVE ADDR OF LAST ASID FOUND    38840002
         B     LOOP                     TEST FOR MORE ASID FIELDS       38940002
*                                                                       39040002
*    THE LAST ASID ENTRY HAS BEEN FOUND.  MOVE LAST ENTRY TO REPLACE    39140002
*    THE ASID ENTRY OF THIS ADDRESS SPACE.                              39240002
*                                                                       39340002
MOVEID   EQU   *                        MOVE LAST ENTRY                 39440002
         L     RENTRY,0(RWRK3)          LAST ASID ENTRY AND STORE       39540002
         ST    RENTRY,0(RWRK2)          IN DELETED ENTRY FIELD          39640002
         ST    RWRK1,0(RWRK3)           CLEAR LAST ENTRY                39740002
         CR    RWRK3,REXT               WAS LAST ENTRY THE ONLY ENTRY   39940002
*                                       IN A FIELD AREA EXTENSION       40040002
         BNE   0(RLINK)                 BR NO - RETURN                  40140002
*                                                                       40240002
*    FIELD AREA EXTENSION TO BE FREED.                                  40340002
*                                                                       40440002
         L     RENTRY,DFAASIDN          ADDR OF FIRST EXTENSION         40540002
         LA    RRETRN,DFAASIDN          ADDR OF EXTENSION PTR           40640002
FINDEXT  CR    RENTRY,REXT              THIS THE EXTENSION              40740002
*                                       TO BE FREED                     40840002
         BE    CLRPTR                   BR YES, CLEAR PTR TO EXTENSION  40940002
         USING DCBFAEX,RENTRY           EXTENSION ADDRESSABILITY        41040002
         LA    RRETRN,DFAEXN            ADDR OF PTR TO NEXT EXTENSION   41140002
         L     RENTRY,DFAEXN            ADDR OF NEXT EXTENSION          41240002
         DROP  RENTRY                   END EXTENSION USING             41340002
         B     FINDEXT                  TEST THIS EXTENSION             41440002
*                                                                       41540002
*    FIELD AREA OR EXTENSION POINTING TO EXTENSION TO BE FREED,         41640002
*    CLEAR POINTER                                                      41740002
*                                                                       41840002
CLRPTR   ST    RWRK1,0(RRETRN)          CLEAR PTR TO EXT. TO BE FREED   41940002
*                                                                       42040002
         L     RWRK1,EXTSP              SUBPOOL AND LENGTH OF EXT.      42140002
         LR    RWRK2,REXT               ADDR OF CORE TO BE FREE         42240002
         B     FREEEXT                  BR TO FREE FA EXTENSION,        42340002
*                                       FREEFA WILL RETURN TO CALLER    42440002
*                                       OF ASIDUPDT                     42540002
         EJECT                                                          42640002
*********************************************************************** 42740002
*                                                                     * 42840002
*    FREEFA - THIS ROUTINE FREES THE DCB FIELD AREA OR FIELD AREA     * 42940002
*             EXTENSION CORE.  IT USES THE BRANCH ENTRY TO FREEMAIN.  * 43040002
*             THE ENTRY TO FREE THE EXTENSION CORE IS FREEEXT.        * 43140002
*                                                                     * 43240002
*********************************************************************** 43340002
         SPACE 2                                                        43440002
FREEFA   L     RWRK3,CVTPTR             CVT ADDRESS                     43540002
         USING CVT,RWRK3                ADDRESSABILITY ON CVT           43640002
         L     RWRK3,CVTEXT1            ADDR OF CVT EXTENSION           43740002
         USING CVTXTNT1,RWRK3           CVT EXTENSION ADDRESSABILITY    43840002
         L     RWRK2,CVTFACHN           ADDR OF FIRST FA IN CHAIN       43940002
         LA    RWRK2,0(RWRK2)           CLEAR HIGH BYTE                 44040002
*                                                                       44140002
         LA    RENTRY,CVTFACHN          ADDR OF PTR TO FIELD AREA       44240002
         CLC   DFACHAIN,ENDCHN          FA LAST IN CHAIN                44340002
         BNE   UNCHAIN                  BR NO                           44440002
         CR    RWRK2,RDCBFA             FIRST AND LAST IN CHAIN         44540002
         BNE   UNCHAIN                  BR NO                           44640002
*                                                                       44740002
*    FIELD AREA IS ONLY ONE IN CHAIN, CLEAR POINTER IN CVT.             44840002
*                                                                       44940002
         SR    RWRK1,RWRK1              SET REGISTER TO ZERO            45040002
*                                                                       45060002
CHAINCVT EQU   *                        CVT FA PTR TO BE CHANGED        45080002
         SPACE 2                                                        45100002
         MODESET KEYADDR=KEY0,WORKREG=14  CHANGE TO KEY 0               45140002
         SPACE 2                                                        45160002
         ST    RWRK1,CVTFACHN           UPDATE FIELD AREA PTR IN CVT    45240002
         SPACE 2                                                        45260002
         MODESET EXTKEY=DATAMGT         CHANGE TO DATA MGT KEY          45340002
         SPACE 2                                                        45360002
         B     FREEFLD                  FREE FIELD AREA                 45440002
*                                                                       45540002
*    REMOVE FIELD AREA FROM CHAIN                                       45640002
*                                                                       45740002
         DROP  RDCBFA                   END USING ON CURR FA            45840002
         USING DCBFA,RWRK2              USING ON FIELD AREA             45940002
UNCHAIN  CR    RWRK2,RDCBFA             FIELD AREA FIRST IN CHAIN       46040002
         BNE   SRCHCHN                  NO, BR TEST NEXT FA IN CHAIN    46140002
         L     RWRK1,DFACHAIN           YES                             46240002
         B     CHAINCVT                 REMOVE FROM CHAIN               46340002
*                                                                       46440002
SRCHCHN  LA    RENTRY,DFACHAIN          ADDRESS OF NEXT DCBFA POINTER   46540002
         L     RWRK2,DFACHAIN           POINT TO NEXT FIELD AREA        46640002
         CR    RWRK2,RDCBFA             THIS THE FA TO FREE             46740002
         BNE   SRCHCHN                  BR NO                           46840002
         L     RWRK1,DFACHAIN           NEXT FIELD AREA ADDR FROM       46940002
*                                       DCBFA BEING FREED               46990002
*                                                                       47020002
         ST    RWRK1,0(RENTRY)          REMOVE FA FROM CHAIN            47040002
*                                                                       47140002
FREEFLD  EQU   *                        FREE FIELD AREA                 47240002
         L     RDCBFA,DFACHAIN          ADDR OF NEXT FA OR END IND.     47340002
         L     RWRK1,FASP               SUBPOOL AND LENGTH OF CORE      47440002
*                                                                       47540002
FREEEXT  EQU   *                        ENTRY TO FREE EXTENSION. REGS   47640002
*                                       RWRK1 AND RWRK2 WERE INIT.      47740002
*                                       IN ASIDUPDT                     47840002
*                                                                       47860002
         LR    RWRK3,RWRK1              LENGTH OF CORE TO CLEAR         47880002
         LA    RWRK3,0(,RWRK3)          CLEAR HIGH ORDER BYTE           47900002
         BCTR  RWRK3,0                  LENGTH LESS ONE FOR EXECUTE     47920002
         EX    RWRK3,CLEAR              CLEAR FIELD AREA CORE           47924002
*                                                                       47928002
         USING PSA,0                    LOW CORE ADDRESSABILITY         47940002
         L     RASCB,PSAAOLD            ASCB ADDRESS                    48040002
         SPACE 2                                                        48060002
         MODESET KEYADDR=KEY0,WORKREG=14  CHANGE TO PROTECT KEY 0       48140002
         SPACE 2                                                        48240002
*                                                                       48290000
*        FREE DCBFA OR FA EXTENSION                                     48300000
*                                                                       48310000
         FREEMAIN RU,LV=(0),A=(1),SP=CSA241,KEY=05,BRANCH=YES   ZA01285 48340000
         SPACE 2                                                        48440002
         MODESET EXTKEY=DATAMGT         CHANGE TO PROTECT KEY 5         48540002
         SPACE 2                                                        48560002
         BR    RLINK                    RETURN                          48640002
         SPACE 2                                                        48660002
CLEAR    XC    0(0,RWRK2),0(RWRK2)      CLEAR FIELD AREA CORE           48680002
         SPACE 5                                                        48740002
*    CONSTANTS AND EQUATES                                              48840002
*                                                                       48940002
COMMON   DC    A(IGG0202B)              ADDR OF BEGINNING OF MODULE     49040002
KEY0     DC    X'00'                    STORAGE PROTECT KEY 0           49140002
EOC      DC    X'FFFFFF'                END OF FA CHAIN, INC. KEY0.     49240002
ENDCHN   EQU   KEY0                     USID TO TEST END OF FA CHAIN    49340002
CSA241   EQU   241                      CSA SUBPOOL 241         ZA01285 49390000
FASP     DC    AL4(DFASIZE)             LNGTH OF FIELD AREA     OZ04534 49440037
EXTSP    DC    AL4(DFEXSIZE)            LNGTH OF EXTENSION      OZ04534 49540037
         SPACE 2                                                        49640002
ISAM     DEBCHK AM=ISAM,MF=L            ID FOR ISAM IN DEBAMTYP FIELD   49740002
NPFX     DC    H'16'                    NEG DISP TO DEB PREFIX @ZA19614 49840037
         SPACE 2                                                        49860037
*    MAINTENANCE WORK AREA                                              49880037
***************************************************************@ZA19614 49900037
* MODULE ID                                                    @ZA19614 49920037
*                                                              @ZA19614 49940037
NAME     DC    CL8'IGG0202B'             MODULE NAME           @ZA19614 49960037
SHIP     DC    CL8' OZ31151'             SHIP CODE             @ZA19614 49980037
DATE     DC    CL8'&SYSDATE'             DATE LAST CHANGED     @ZA19614 50000037
         DS    0F                                                       50020037
PATCH    DC    XL50'00'                 ZEROED PATCH AREA               50040037
***************************************************************@ZA19614 50060037
         SPACE 2                                                        50140002
JSTCB    EQU   X'04'                    JOB STEP TERMINATION            50240002
MEMTERM  EQU   X'40'                    MEMORY TERMINATION              50340002
RCODE4   EQU   4                        RETURN CODE FOR FORCE CLOSE     50440002
SHR      EQU   X'80'                    TEST FOR DISP EQ SHR            50540002
         EJECT                                                          50640002
DCBFA    IGGDCBFA                                                       50740002
         EJECT                                                          50840002
         IEZDEB                                                         50940002
         EJECT                                                          51040002
         IHARMPL                                                        51140002
         EJECT                                                          51240002
         CVT   DSECT=YES                                                51440002
         SPACE 2                                                        51540002
         IHAPSA                                                         51640002
         EJECT                                                          51740002
         IHAASCB                                                        51840002
         EJECT                                                          51940002
         IKJTCB                                                         52040002
         END                                                            52140002
