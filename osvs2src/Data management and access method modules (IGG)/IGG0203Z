         TITLE 'GRAPHICS TASK TERMINATION SECTION'                      00050002
*********************************************************************** 00100002
*                                                                       00150002
* MODULE NAME:            IGG0203Z (OS/VS2)                             00200002
*                                                                       00250002
* DESCRIPTIVE NAME:       GRAPHICS TASK TERMINATION                     00300002
*                                                                       00350002
* COPYRIGHT:              NONE                                          00400002
*                                                                       00450002
* STATUS:                 RELEASE 2.0                                   00500002
*                                                                       00550002
* FUNCTION:              THIS MODULE PERFORMS BOTH NORMAL AND ABNORMAL  00600002
*                        TASK TERMINATION FUNCTIONS FOR THE 2250S AND   00650002
*                        2260S SUPPORTED BY GPS.                        00700002
*                                                                       00750002
*                        THIS INCLUDES:                                 00800002
*                          1. NORMAL TERMINATION: DELETE ANY ATTENTION  00850002
*                             ROUTINES STILL ACTIVE BY ISSUING GPS      00900002
*                             MACRO DAR FOR ACTIVE TEB/REB CHAINS (DONE 00950002
*                             IN EARLIER RELEASES BY MODULE IFFGRTTR)   01000002
*                                                                       01050002
*                                                                       01100002
*                          2. ABNORMAL TERMINATION:                     01150002
*                                                                       01200002
*                            A. RECOVER THE UCB SO IT IS AVAILABLE FOR  01250002
*                               REALLOCATION (DONE IN EARLIER RELEASES  01300002
*                               BY THE FORCED CLOSE ABEND MACRO         01350002
*                               IGGIFF01) THE FIELDS RESET ARE:         01400002
*                                GCB   ZEROED SO ATTENTIONS ARE IGNORED 01450002
*                                OPEN  ZEROED TO INDICATE NO DCBS OPEN  01500002
*                                TEB   ZEROED TO PREVENT USING BAD CBS  01550002
*                                                                       01600002
*                            B. RELEASE 2250 ALLOCATED BUFFER FOR       01650002
*                               DEVICES ASSIGNED TO THE ABENDING MEMORY 01700002
*                                                                       01750002
******************* PROLOGUE*CONTINUED*NEXT*PAGE ********************** 01800002
         EJECT                                                          01850002
*********************************************************************** 01900002
*                                                                       01950002
* NOTES:                                                                02000002
*                                                                       02050002
*     DEPENDENCIES:      NORMAL TERMINATION: USER MEMORY ADDRESSABILITY 02100002
*                        ABNORMAL TERMINATIONS:                         02150002
*                          GRAPHIC DEVICES ARE NOT SHARABLE; THUS:      02200002
*                          1. TERMINATION ASSUMES THE PRIMARY GOAL IS   02250002
*                             SUCCESSFUL REALLOCATION OF THE DEVICES    02300002
*                          2. LOCAL LOCK IS NOT NEEDED FOR UCB RESETS   02350002
*                                                                       02400002
*     RESTRICTION:       NONE                                           02450002
*                                                                       02500002
*     RESISTERS:         SEE EQUATE DEFINITIONS FOLLOWING PROLOG        02550002
*                                                                       02600002
*     PATCH LABEL:       PATCH, A 50 BYTE DC AREA AT END OF MODULE      02650002
*                                                                       02700002
* MODULE TYPE:           EXECUTABLE CODE                                02750002
*                                                                       02800002
*    PROCESSOR:          ASSEMBLER XF                                   02850002
*                                                                       02900002
*    MODULE SIZE:        SEE PAGE 1 OF THIS LISTING                     02950002
*                                                                       03000002
*    ATTRIBUTES:                                                        03050002
*       AT ENTRY:        REENTRANT  ENABLED  SUPERVISOR STATE IN KEY 0  03100002
*                                                                       03150002
* ENTRY POINT:           IGG0203Z                                       03200002
*                                                                       03250002
*    PURPOSE:            SEE 'FUNCTION' HEADING ABOVE                   03300002
*                                                                       03350002
*    LINKAGE:            SEE 'INPUT', NEXT HEADING                      03400002
*                                                                       03450002
* INPUT:                 REGISTERS AS FOLLOWS:                          03500002
*                          1  ADDR OF: RMPL ADDRESS                     03550002
*                         13           SAVE AREA OF 18 WORDS            03600002
*                         14           RETURN ADDRESS TO TASK CLOSE     03650002
*                         15           IGG0203Z ENTRY POINT             03700002
*                                                                       03750002
* OUTPUT:                SEE 'FUNCTION' HEADING ABOVE                   03800002
*                                                                       03850002
* EXITS:                                                                03900002
*                                                                       03950002
*    NORMAL:             RETURN MACRO, RC=0                             04000002
*                                                                       04050002
*    ERROR:              NOT USED                                       04100002
*                                                                       04150002
******************* PROLOGUE*CONTINUED*NEXT*PAGE ********************** 04200002
         EJECT                                                          04250002
*********************************************************************** 04300002
*                                                                       04350002
* EXTERNAL REFERENCES:                                                  04400002
*                                                                       04450002
*     ROUTINES:          NORMAL TERMINATION:  IGC0007D                  04500002
*                                                                       04550002
*     DATA AREAS:        SEE DSECT SECTION AT END OF LISTING            04600002
*                                                                       04650002
*     CONTROL BLOCKS:    SEE DSECT SECTION AT END OF LISTING            04700002
*                                                                       04750002
* TABLES:                NONE                                           04800002
*                                                                       04850002
* MACROS:                FREEMAIN  GETMAIN   SAVE   RETURN              04900002
*                                                                       04950002
* CHANGE ACTIVITY:       MODULE IS NEW FOR VS2/R2                       05000002
*                                                                       05050002
*********************************************************************** 05100002
         SPACE 2                                                        05150002
IGG0203Z CSECT                                                          05200002
*   SEE LABEL 'MODID' FOR LAST CHANGE DATE; FORMAT:  NAME.SYSREL.DATE   05250002
*C106000-122000                                               LF YM8208 05300002
*D160000,A160100-160200                                      LG Z30AALG 05310000
*C160500-161500,A196096                                     LG @ZM30151 05312000
*C167000,C168000,A195500-195920                             L5 @ZA02832 05314000
*A161100-161200                                             L5 @ZA03950 05316000
*A114700-114900,A373400                                     D11 ZA11330 05318000
*A283700-283800                                             D11 ZA10028 05319000
*                                                                       05320000
         EJECT                                                          05350002
*********************************************************************** 05400002
*                                                                     * 05450002
*                        REGISTER ASSIGNMENTS                         * 05500002
*                                                                     * 05550002
*********************************************************************** 05600002
         SPACE 2                                                        05650002
RSIZE    EQU   0     TEMPORARY:         GETMAIN SIZES                   05700002
RADR     EQU   1                        ADDRESS WORK REGISTER           06100002
RCALC    EQU   1                        CALCULATIONS                    06110002
RCODE    EQU   15                       RETURN CODE                     06120002
         SPACE                                                          06130002
RBASE    EQU   2     CONVENTIONS:       BASE REGISTER                   06150002
         SPACE                                                          06160002
RDEV     EQU   4     CALCULATIONS:      DEVICE INDEX NUMBER FROM UCB    06170002
RLOC     EQU   7                        LOCATION REG FOR INDEXING       06172002
         SPACE                                                          06180002
RRMPL    EQU   8     INPUT ADDRESS:     RESOURCE MGR PARAMETER LIST     06190002
         SPACE                                                          06192002
RBTAB    EQU   3     ADDRESSES:         BUFFER TABLE (FROM 2250 UCBS)   06200002
RDSAB    EQU   4                        DSAB  (FROM QDB & ACTIVE JSCB)  06202002
RENTRY   EQU   5                        CURRENT ENTRY IN TABLE          06250002
RLAST    EQU   6                        LAST ENTRY IN TABLE             06252002
RLIST    EQU   7                        INPUT PARAMETER LIST FOR DAR    06260002
RREB     EQU   9                        ROUTINE ENTRY BLOCK (UCB & TEB) 06550002
RTEB     EQU   10                       TASK ENTRY BLOCK (FROM UCB)     06600002
RTCB     EQU   11                       TCB IN CONTROL (CURRENT)        06650002
RUCB     EQU   12                       UCB                             06700002
RSAVE    EQU   13                       SAVE AREA OF CALLER             06750002
RSCB1    EQU   14                       TEMP SYS CB ADDRESSES           06800002
RSCB2    EQU   15                       TEMP SYS CB ADDRESSES           06810002
         EJECT                                                          06900002
*********************************************************************** 06950002
*                                                                     * 07000002
*                        EQUATES                                      * 07050002
*                                                                     * 07100002
*********************************************************************** 07150002
ZERO     EQU   0        DECIMAL/HEX NUMBERS FOR GENERAL USE             07200002
ONE      EQU   1                                                        07210002
TWO      EQU   2                                                        07250002
THREE    EQU   3                                                        07260002
SEVEN    EQU   7                                                        07300002
         SPACE                                                          07350002
DAR      EQU   74       SVC NUMBERS                                     07750002
         EJECT                                                          08500002
*********************************************************************** 08550002
*                                                                     * 08600002
*                        INITIALIZATION                               * 08650002
*                                                                     * 08700002
*         1. USING STATEMENTS IDENTIFY DSECT BASE REGISTERS           * 08750002
*         2. REGISTERS SAVED IN CALLER'S AREA                         * 08800002
*         3. BASE ESTABLISHED FOR ADDRESSABILITY OF MODULE            * 08850002
*         4. MODULE EYECATCHER ID FOR RELEASE LEVEL VERIFICATION      * 08900002
*                                                                     * 08950002
*********************************************************************** 09000002
         SPACE 2                                                        09050002
         USING CVT,RSCB1         CVT DSECT INITZ FROM LOC 16            09100002
         USING REB,RREB          STD DSECTS, KEY 0:  REB (SEE IGC0007C) 09150002
         USING RMPL,RRMPL                            RMPL (INPUT LIST)  09200002
         USING TEB,RTEB                              TEB                09250002
         USING TCB,RTCB                              TCB                09300002
         USING TIOENTRY,RENTRY                       TIOT               09350002
         USING UCB,RUCB                              UCB                09400002
         USING UCBCMEXT,RSCB2                        UCB EXTENSION      09450002
         SPACE                                                          09500002
         SAVE  (14,12)                                                  09550002
         BALR  RBASE,0                                                  09600002
         USING *,RBASE                                                  09650002
         B     *+24                                                     09700002
MODID    DC    C'IGG0203Z.VS2R2.75092'          MODULE EYECATCHER ID    09750000
         EJECT                                                          09800002
*********************************************************************** 09810002
*                                                                     * 09820002
*                        INITIALIZATION                               * 09830002
*                                                                     * 09840002
*         5. DETERMINE TYPE OF PROCESSING REQUIRED; THEN IF:          * 09842002
*                                                                     * 09844002
*              NORMAL TERMINATION:                                    * 09846002
*                1.  DAR ANY REBS ASSOCIATED WITH CURRENT TCB.        * 09848002
*                                                                     * 09848402
*              ABNORMAL TERMINATION:                                  * 09848802
*                1.  RESET 2250 BUFFER TABLE FOR REALLOCATION         * 09849202
*                2.  RESET UCB FIELDS  (OPEN, GCB, TEB)               * 09849602
*                                                                     * 09849702
*********************************************************************** 09849802
         L     RRMPL,ZERO(RADR)   GET RESOURCE MANAGER'S INPUT LIST     09850002
         TM    RMPLFLG1,RMPLTYPE    CHECK IF ABNORMAL TERMINATION       09900002
         BO    GTT0080                IF YES, RECOVER UCB AND BFR TAB   09950002
         CLI   RMPLASID+1,ONE     CHECK IF MASTER SCHEDULER MEMORY      10000002
         BE    GTT0010              IF YES, NOTHING TO DO               10050002
         L     RTCB,RMPLTCBA        IF NO, GET TCB ADR                  10100002
         LTR   RTCB,RTCB              IS A TCB AVAILABLE                10150002
         BZ    GTT0010                  IF NO, NOTHING TO DO            10160002
         SR    RSCB1,RSCB1                CLEAR FOR ICM INSTRUCTION     10200002
         ICM   RSCB1,SEVEN,TCBJSTCB+1   IF YES, SEE IF P/P TCB AVAIL:   10300002
         CR    RTCB,RSCB1             DOES CURRENT TCB = JOBSTEP TCB    10350002
         BNE   GTT0020                  IF NO, OK TO PROCESS            10400002
GTT0010  SR    RCODE,RCODE              IF YES, NOTHING TO PROCESS      10450002
         RETURN (14,12),T,RC=(15)                                       10500002
         EJECT                                                          10550002
*********************************************************************** 10560002
*                                                                     * 10570002
*                    NORMAL TASK TERMINATION                          * 10580002
*                                                                     * 10590002
*        1. SCAN DSAB CHAIN FOR GRAPHIC DD ENTRIES IN TIOT   LF YM8202* 10592002
*        2. VALIDATE TIOT UCBS ARE FOR GAM SUPPORTED DEVICES          * 10594002
*                                                                     * 10596002
*********************************************************************** 10598002
GTT0020  SR    RENTRY,RENTRY           CLEAR REGS FOR ICM INSTRUCTIONS  10600002
         SR    RDSAB,RDSAB                                              10650002
         SR    RUCB,RUCB                                                10700002
         ICM   RSCB1,SEVEN,TCBJSCBB    IS JSCB AVAILABLE                10750002
         BZ    GTT0010                    IF NO, NOTHING TO PROCESS     10800002
         USING IEZJSCB,RSCB1                                            10850002
         ICM   RSCB1,SEVEN,JSCBACT+1   IS ACTIVE JSCB AVAILABLE         10900002
         BZ    GTT0010                    IF NO, NOTHING TO PROCESS     10950002
         ICM   RSCB1,SEVEN,JSCDSABQ+1  IS QDB AVAILABLE                 11000002
         BZ    GTT0010                    IF NO, NOTHING TO PROCESS     11050002
         USING QDB,RSCB1                                                11100002
         ICM   RDSAB,SEVEN,QDBFELMP+1  IS DSAB AVAILABLE                11150002
         BZ    GTT0010                    IF NO, NOTHING TO PROCESS     11200002
         USING DSAB,RDSAB                                               11250002
GTT0030  ICM   RENTRY,SEVEN,DSABTIOT+1 IS TIOT AVAILABLE                11400002
         BZ    GTT0040                    IF NO, CHECK IF MORE DSABS    11450002
         TM    TIOESTTA,DYNALLOC   IS/WAS IT DYNAMICALLOC?  D11 ZA11330 11460000
         BO    GTT0040             YES,GO SEE IF MORE DSABS D11 ZA11330 11470000
         ICM   RUCB,SEVEN,TIOESTTB+1   IS UCB AVAILABLE                 11500002
         BZ    GTT0040                    IF NO, CHECK IF MORE DSABS    11550002
         CLI   UCBID,UCBSTND           CHECK IF SUBUCB          SA15459 11600002
         BNE   GTT0040                    IF YES, NOT GRAPHIC   SA15459 11650002
         CLI   UCBTBYT3,UCB3DISP       CHECK IF A GRAPHICS DEVICE       11700002
         BNE   GTT0040                    IF NO, CHECK IF MORE DSABS    11750002
         CLI   UCBTBYT4,UCBT2250       IS DEVICE 2250 TYPE              11800002
         BE    GTT0050                    IF YES,  OK TO PROCESS        11850002
         CLI   UCBTBYT4,UCBT2260       IS DEVICE 2260 TYPE              11900002
         BE    GTT0050                    IF YES, OK TO PROCESS         11950002
         CLI   UCBTBYT4,UCBT1053       IS DEVICE 1053                   12000002
         BE    GTT0050                    IF YES, OK TO PROCESS         12050002
GTT0040  ICM   RDSAB,SEVEN,DSABFCHN+1  CHECK IF MORE DSABS              12100002
         BZ    GTT0010                    IF NO, NOTHING TO PROCESS     12150002
         B     GTT0030                    IF YES, CHECK FOR TIOT        12200002
         EJECT                                                          12250002
*********************************************************************** 13100002
*                                                                     * 13150002
*                    NORMAL TASK TERMINATION                          * 13200002
*                                                                     * 13250002
*         3. DAR ANY REB ASSOCIATED WITH CURRENT TCB                  * 13300002
*                                                                     * 13350002
*********************************************************************** 13400002
GTT0050  SR    RTEB,RTEB                    (CLEAR FOR ICM INSTRUCTION) 13500002
         ICM   RTEB,SEVEN,UCBTEB+1    IS TEB AVAILABLE                  13550002
         BZ    GTT0040                 IF NO, CHECK IF MORE DSABS       13600002
         SR    RREB,RREB                    (CLEAR FOR ICM INSTRUCTION) 13800002
         ICM   RREB,SEVEN,TEBREB+1    IS REB AVAILABLE                  13850002
         BZ    GTT0040                 IF NO, CHECK IF MORE DSABS       13900002
         SR    RADR,RADR                    (CLEAR FOR ICM INSTRUCTION) 13950002
GTT0060  ICM   RADR,SEVEN,REBTCB+1                                      14150002
         CR    RADR,RTCB               IF YES, IS REB TCB = CURRENT TCB 14250002
         BE    GTT0070                   IF YES, OK TO DEACTIVATE       14300002
         ICM   RREB,SEVEN,REBL+1         IF NO, ARE MORE REBS AVAILABLE 14350002
         BZ    GTT0040                     IF NO, CHECK IF MORE DSABS   14450002
         B     GTT0060                     IF YES, CHECK FOR TCB MATCH  14500002
GTT0070  L     RSIZE,DARPLIST         GET SAVE/WORK AREA FOR DAR USE    14750002
         GETMAIN R,LV=(0)                                               14800002
         L     RLIST,REBGACB          SET UP PLIST FOR DAR              14850002
         ST    RLIST,ADR(RADR)          1. ADDRESS OF GACB              14900002
         LA    RLIST,TWO                                                14950002
         ST    RLIST,ZERO(RADR)         2. LENGTH OF PLIST IN WORDS     15000002
         L     RREB,REBL              KEEP NEXT REB ADR (IF ANY)        15050002
         LR    RLIST,RADR             SAVE ADDR FOR FREEMAIN            15100002
         SVC   DAR                    ISSUE DAR  SVC                    15150002
         LR    RADR,RLIST             FREE PLIST AREA                   15200002
         L     RSIZE,DARPLIST                                           15250002
         FREEMAIN R,LV=(0),A=(1)                                        15300002
         LTR   RREB,RREB              ANY MORE REBS ON THIS TEB         15350002
         BZ    GTT0040                 IF NO, CHECK IF MORE DSABS       15400002
         B     GTT0060                 IF YES, CHECK FOR TCB MATCH      15450002
         EJECT                                                          15650002
*********************************************************************** 15660002
*                                                                     * 15670002
*                  ABNORMAL TASK TERMINATION                          * 15680002
*                                                                     * 15690002
*         1. SCAN LOOKUP TABLE UCBS FOR GAM SUPPORTED DEVICES         * 15692002
*                                                                     * 15694002
*********************************************************************** 15696002
GTT0080  EQU   *                                                        15700002
         USING CVT,RSCB1                                                15750002
         L     RSCB1,CVTPTR           GET CVT ADDR: FIXED LOCATION 16   15800002
         L     RSCB1,CVTILK2          GET UCB LOOKUP TABLE ADDR         15850002
         DROP  RSCB1                                                    15900002
GTT0090  EQU   *                                                        15950002
         SR    RUCB,RUCB               CLEAR REGISTER        LG Z30AALG 16010000
         ICM   RUCB,THREE,ZERO(RSCB1)  GET 1'ST ENTRY        LG Z30AALG 16020000
         C     RUCB,TBLEND            END OF LOOKUP TABLE?  LG @ZM30151 16050000
         BE    GTT0010                YES,NOTHING TO DO.    LG @ZM30151 16100000
         LTR   RUCB,RUCB           IS ENTRY 0?              L5 @ZA03950 16110000
         BZ    GTT0100             YES,GET NEXT ENTRY       L5 @ZA03950 16120000
         B     GTT0110                CK IF GRAPHICS DEVICE LG @ZM30151 16150000
GTT0100  EQU   *                                                        16200002
         LA    RSCB1,TWO(RSCB1)       ADJUST TO NEXT ENTRY              16250002
         B     GTT0090                   CONTINUE SCANNING              16300002
GTT0110  EQU   *                                                        16350002
         L     RSCB2,UCBEXTPT         GET UCB EXTENTION ADDRESS         16400002
         CLC   UCBASID,RMPLASID       DO MEMORIES MATCH                 16450002
         BNE   GTT0100                   IF NO, CONTINUE SEARCH         16500002
         CLI   UCBTBYT3,UCB3DISP      CHECK IF GRAPHIC UCB              16550002
         BNE   GTT0100                   IF NO, CONTINUE SEARCH         16600002
         CLI   UCBTBYT4,UCBT1053         IF YES, CK IF GRAPHIC DEVICE   16650002
         BE    GTT0113                 IF YES, RESET UCB    L5 @ZA02832 16700000
         CLI   UCBTBYT4,UCBT2260                                        16750002
         BE    GTT0113                                      L5 @ZA02832 16800000
         CLI   UCBTBYT4,UCBT2250                                        16850002
         BNE   GTT0100                     IF NO, CONTINUE SEARCH       16900002
         EJECT                                                          17000002
*********************************************************************** 17087902
*                                                                     * 17137902
*                  ABNORMAL TASK TERMINATION                          * 17187902
*                                                                     * 17237902
*         2. FOR 2250S, RESET BUFFER TABLE FOR REALLOCATION           * 17287902
*                                                                     * 17297902
*********************************************************************** 17299902
         USING BUFTAB,RBTAB       ESTABLISH UCB BUFFER TABLE ADDRESSING 17349902
GTT0113  TM    RMPLFLG1,RMPLTERM   MEM TERM?                L5 @ZA02832 17359900
         BZ    GTT0165             NO,CHK TCB TERM          L5 @ZA02832 17369900
GTT0115  CLI   UCBTBYT4,UCBT2250   2250?                    L5 @ZA02832 17379900
         BNE   GTT0160             NO,PURGE UCB             L5 @ZA02832 17389900
*                                  YES,RESET BUFFER TABLE   L5 @ZA02832 17391900
*                                  BEFORE PURGE             L5 @ZA02832 17393900
         SR    RBTAB,RBTAB        CLEAR FOR ICM INSTRUCTION             17399902
         ICM   RBTAB,SEVEN,UCBBTB      IS BUFFER TABLE AVAILABLE        17449902
         BZ    GTT0160                   IF NO, SKIP BUFFER RESET CODE  17499902
         SR    RDEV,RDEV                 IF YES, RESET FOR THIS UCB     17549902
         IC    RDEV,UCBDI              GET DEVICE INDEX NUMBER FOR BT   17599902
         LR    RLOC,RDEV               CALC DEVICE DISPLACEMENT INTO BT 17649902
         BCTR  RLOC,ZERO                 REDUCE DEVICE NBR BY ONE &     17699902
         SLL   RLOC,THREE                MULTIPLY BY EIGHT BYTES        17749902
         LH    RCALC,BTDVAS(RLOC)      GET SECTIONS ASSIGNED TO DEVICE  17799902
         AH    RCALC,BTTOTAVL            MAKE SECTIONS AVAIL FOR REUSE  17849902
         STH   RCALC,BTTOTAVL                                           17899902
         SR    RCALC,RCALC             INDICATE NO SECTIONS ASSIGNED TO 17949902
         STH   RCALC,BTDVAS(RLOC)        THIS DEVICE                    17999902
         LH    RLAST,BTTOTSEC          GET TOTAL NUMBER OF SECTIONS     18049902
         TM    UCBTBYT1,UCBTMOD3       IS DEVICE A 2250-3               18099902
         BO    GTT0120                   IF YES, BT HAS 40 BYTE HEADER  18149902
         LA    RENTRY,BTASGMT1           IF NO,  BT HAS 16 BYTE HEADER  18199902
         B     GTT0130                 PREPARE FOR BT SCAN OF ASGMENTS  18249902
GTT0120  LA    RENTRY,BTASGMT3         GET ADDR OF FIRST ENTRY, 2250-3  18349902
GTT0130  AR    RLAST,RENTRY            CALC LAST ENTRY ADDR             18399902
GTT0140  EX    RDEV,ASSIGNED           IS SECTION ASSIGNED TO THIS UCB  18449902
         BNE   GTT0150                   IF NO, DO NOT FREE SECTION     18499902
         MVI   ZERO(RENTRY),ZERO         IF YES, FREE BY RESET TO ZERO  18549902
GTT0150  LA    RENTRY,ONE(RENTRY)      ADJUST TO NEXT ENTRY ADDRESS     18599902
         CR    RENTRY,RLAST            IS LAST ENTRY PROCESSED          18649902
         BNH   GTT0140                   IF NO, REPEAT SCANNING         18699902
         DROP  RBTAB                                                    18749902
         EJECT                                                          19000002
*********************************************************************** 19050002
*                                                                     * 19100002
*                  ABNORMAL TASK TERMINATION                          * 19110002
*                                                                     * 19120002
*          3.  RESET UCB FIELDS:  OPEN, GCB, TEB                      * 19150002
*                                                                     * 19200002
*********************************************************************** 19250002
GTT0160  EQU   *                                                        19300002
         SR    RADR,RADR       GET ZEROS TO REINITIALIZE:               19350002
         STH   RADR,UCBOPEN       DCBS OPEN COUNT AND GCB               19400002
         ST    RADR,UCBTEB        TEB TO DEACTIVATE ATTN HANDLING       19450002
         B     GTT0100         GET NEXT UCB FOR PROCESSING              19500002
GTT0165  SR    RTEB,RTEB           CLR TEB REG              L5 @ZA02832 19550000
         ICM   RTEB,SEVEN,UCBTEB+1  GET TEB ADDR            L5 @ZA02832 19560000
         BZ    GTT0100              NO TEB, GET NEXT UCB    L5 @ZA02832 19570000
         CLC   TEBTCB+1(THREE),RMPLTCBA+1  TEBTCB=ABEND TCB?   @ZA02832 19580000
         BNE   GTT0100             NO,GET NEXT UCB          L5 @ZA02832 19590000
         B     GTT0115                                      L5 @ZA02832 19592000
         EJECT                                                          19600002
**********************************************************************  19602002
*                                                                    *  19604002
*                           CONSTANTS                                *  19606002
*                                                                    *  19608002
**********************************************************************  19608402
         DS    0F                                                       19608802
DARPLIST DC    X'FF000040'        SUBPOOL/SIZE FOR GETMAIN    LI SM1709 19609202
TBLEND   DC    X'0000FFFF'        LOOKUP TBL END INDICATOR  LG @ZM30151 19609600
ASSIGNED CLI   ZERO(RENTRY),ZERO  COMPARE UCBDI WITH BT ENTRY           19610000
         SPACE 5                                                        19620002
**********************************************************************  19650002
*                                                                    *  19700002
*                SPECIAL MAINTENANCE PATCH AREA FOR FIELD USE        *  19750002
*                                                                    *  19800002
**********************************************************************  19850002
PATCH    DS    0F                  50 BYTE PATCH AREA       D11         19900000
         DC    50X'FF'                                      D11         19950000
         TITLE 'GRAPHICS TASK RECOVERY SECTION'                         20000002
*********************************************************************** 20050002
*                                                                       20100002
* MODULE NAME:           IGG0213Z (OS/VS2)                              20150002
*                                                                       20200002
* DESCRIPTIVE NAME:      GRAPHICS TASK RECOVERY                         20250002
*                                                                       20300002
* COPYRIGHT:             NONE                                           20350002
*                                                                       20400002
* STATUS:                RELEASE 2.0                                    20450002
*                                                                       20500002
* FUNCTION:              THIS MODULE PERFORMS TASK RECOVERY FUNCTIONS   20550002
*                        FOR THE 2250S AND 2260S SUPPORTED BY GPS WHEN  20600002
*                        OPEN/CLOSE ABENDS.                             20650002
*                                                                       20700002
*                        THIS INCLUDES:                                 20750002
*                          1. RECOVER THE UCB SO IT IS AVAILABLE FOR    20800002
*                             REALLOCATION (DONE IN EARLIER RELEASES    20850002
*                             BY THE FORCED CLOSE ABEND MACRO IGGIFF01) 20900002
*                             THE FIELDS RESET ARE:                     20950002
*                                GCB   ZEROED SO ATTENTIONS ARE IGNORED 21000002
*                                OPEN  ZEROED TO INDICATE NO DCBS OPEN  21050002
*                                TEB   ZEROED TO PREVENT USING BAD CBS  21100002
*                                                                       21150002
*                          2. RESTORE CONTROL BLOCKS TO PREOPEN STATUS  21200002
*                             IF POSSIBLE, USING INFO ONLY IN PROTECTED 21250002
*                             STORAGE TO HELP SUCCESSFUL RECOVERY.      21300002
*                                A. RELEASE 2250 ALLOCATED BUFFER       21350002
*                                B. DEACTIVATE EXPRESS USER POLL LIST   21400002
*                                                                       21450002
******************* PROLOGUE*CONTINUED*NEXT*PAGE ********************** 21500002
         EJECT                                                          21550002
*********************************************************************** 21600002
* NOTES:                                                                21650002
*                                                                       21700002
*     DEPENDENCIES:      KEY 5 CONTROL IS RECEIVED FROM SYSTEM OPEN.    21750002
*                        USER DCB ADDRESS, KEY AVAIL FROM SYS WORKAREA. 21800002
*                        GRAPHIC DEVICES ARE NOT SHARABLE; THUS:        21850002
*                          1. RECOVERY ASSUMES SUCCESSFUL REALLOCATION  21900002
*                             IS THE PRIMARY GOAL                       21950002
*                          2. LOCAL LOCK IS NOT NEEDED FOR UCB RESETS   22000002
*                        SYSTEM CLOSE RESTORES DCB TO PREOPEN STATUS    22050002
*                          AND FREES DEB.                               22100002
*                                                                       22150002
*     RESTRICTION:       NONE                                           22200002
*                                                                       22250002
*     RESISTERS:         SEE EQUATE DEFINITIONS FOLLOWING PROLOG        22300002
*                                                                       22350002
*     PATCH LABEL:       PATCH1, A 50 BYTE DC AREA AT END OF MODULE     22400002
*                                                                       22450002
* MODULE TYPE:           EXECUTABLE CODE                                22500002
*                                                                       22550002
*    PROCESSOR:          ASSEMBLER XF                                   22600002
*                                                                       22650002
*    MODULE SIZE:        SEE PAGE 1 OF THIS LISTING                     22700002
*                                                                       22750002
*    ATTRIBUTES:                                                        22800002
*       AT ENTRY:        REENTRANT  ENABLED  SUPERVISOR STATE IN KEY 5  22850002
*       ASSUMED KEYS:    0, USER (AS RECORDED IN SYSTEM OPEN WORKAREA)  22900002
*                                                                       22950002
* ENTRY POINT:           IGG0213Z                                       23000002
*                                                                       23050002
*    PURPOSE:            SEE 'FUNCTION' HEADING ABOVE                   23100002
*                                                                       23150002
*    LINKAGE:            SEE 'INPUT', NEXT HEADING                      23200002
*                                                                       23250002
* INPUT:                 REGISTERS AS FOLLOWS:                          23300002
*                          2 ADDR OF: COPIED DCB IN WORK AREA           23350002
*                          4          WORK AREA                         23400002
*                          9          TIOT DD ENTRY, OR ZEROS           23450002
*                         11          DEB FOR DCB, OR ZEROS             23500002
*                         13          SAVE AREA OF 18 WORDS             23550002
*                         14          RETURN ADDRESS TO TASK RECOVERY   23600002
*                         15          IGG0213Z ENTRY POINT              23650002
*                                                                       23700002
* OUTPUT:                SEE 'FUNCTION' HEADING ABOVE                   23750002
*                                                                       23800002
******************* PROLOGUE*CONTINUED*NEXT*PAGE ********************** 23850002
         EJECT                                                          23900002
*********************************************************************** 23950002
* EXITS:                                                                24000002
*                                                                       24050002
*    NORMAL:             RETURN MACRO, RC=0                             24100002
*                                                                       24150002
*    ERROR:              RETURN MACRO, RC=4  NO RETRY                   24200002
*                                                                       24250002
*                                                                       24300002
* EXTERNAL REFERENCES:                                                  24350002
*                                                                       24400002
*     ROUTINES:          NONE                                           24450002
*                                                                       24500002
*     DATA AREAS:        SEE DSECT SECTION AT END OF LISTING            24550002
*                                                                       24600002
*     CONTROL BLOCKS:    SEE DSECT SECTION AT END OF LISTING            24650002
*                                                                       24700002
* TABLES:                NONE                                           24750002
*                                                                       24800002
* MACROS:                MODESET     SAVE       RESTORE                 24850002
*                                                                       24900002
* CHANGE ACTIVITY:       MODULE IS NEW FOR VS2/R2                       24950002
*                                                                       25000002
*********************************************************************** 25050002
         SPACE 3                                                        25100002
IGG0213Z CSECT                                                          25150002
         EJECT                                                          25200002
*********************************************************************** 25250002
*                                                                     * 25300002
*                 ADDITIONAL REGISTERS FOR IGG0213Z                   * 25350002
*                                                                     * 25400002
*********************************************************************** 25450002
RDCB     EQU   3          ADDR OF:     DCB BEING FORCED CLOSED          25500002
RCORE    EQU   4                       WORK AREA USED BY OPEN/CLOSE     25550002
REXT     EQU   5                       NUMBER OF EXTENTS (UCBS)         25600002
RRRPL    EQU   8                       RECOVERY ROUTINE PARM LIST       25700002
RTIOT    EQU   9                       DD ENTRY IN TIOT BEING PROCESSED 25750002
RDEB     EQU   11                      DEB                              25800002
RBACK    EQU   15                      NSI FOR SUBRTN RETURN            25850002
         SPACE 3                                                        25900002
*********************************************************************** 25950002
*                                                                     * 26000002
*                        EQUATES                                      * 26050002
*                                                                     * 26100002
*********************************************************************** 26150002
ADR      EQU   4                       INDEX FACTOR FOR ENTRIES         26200002
RC4      EQU   4                       RETURN CODE TO PREVENT RETRY     26250002
         EJECT                                                          26300002
*********************************************************************** 26350002
*                                                                     * 26400002
*                        INITIALIZATION                               * 26450002
*                                                                     * 26500002
*         1. USING STATEMENTS IDENTIFY DSECT BASE REGISTERS           * 26550002
*         2. REGISTERS SAVED IN CALLER'S AREA                         * 26600002
*         3. BASE ESTABLISHED FOR ADDRESSABILITY OF MODULE            * 26650002
*                                                                     * 26700002
*********************************************************************** 26750002
         USING IHADCB,RDCB                                              26800002
         USING FORCORE,RCORE                                            26850002
         USING IECRRPL,RRRPL                                            26900002
         USING DEBBASIC,RDEB                                            26950002
         USING TIOENTRY,RTIOT                                           27000002
         SAVE  (14,12)                                                  27050002
         LR    RDCB,RBASE     KEEP GAM OPEN/CLOSE CONVENTIONAL SETUPS   27100002
         BALR  RBASE,0                                                  27150002
         USING *,RBASE                                                  27200002
         EJECT                                                          27250002
*********************************************************************** 27300002
*                                                                     * 27350002
*                  CHECK FOR VALID INPUT TO PROCESS                   * 27400002
*                                                                     * 27450002
*          1.  TRY TO VERIFY UCBS ARE FOR 2250, 2260 OR 1053          * 27500002
*               A. USE TIOT AS SAFEST SOURCE OF INFO SINCE            * 27550002
*                  OPEN MAY HAVE ABENDED BEFORE DEB COMPLETED         * 27600002
*               B. USE DEB AS SECOND CHOICE FOR UCB INFO              * 27650002
*           2. IF GRAPHICS DEVICES CAN NOT BE VALIDATED:              * 27700002
*               A. USE RC=4+ TO PREVENT RETRIES FOR GAM               * 27750002
*               B. CK DCB AND DEACTIVATE POLL LIST IF A GAM           * 27800002
*                  DCB CAN BE VALIDATED.                              * 27850002
*                                                                     * 27900002
*********************************************************************** 27950002
         MODESET EXTKEY=ZERO                                            28000002
         LTR   RTIOT,RTIOT       IS A TIOT DD ENTRY AVAILABLE           28050002
         BZ    DEBCK               IF NO, CHECK FOR A DEB               28100002
         SR    REXT,REXT             CLEAR REG FOR LGH INSERT           28150002
TIOTOK   EQU   *                                                        28200002
         IC    REXT,TIOELNGH         GET LGH OF ENTRY TO CALC # OF UCBS 28250002
         LTR   REXT,REXT                IS THERE A DD ENTRY             28300002
         BZ    DEBCK                     IF NO, TRY TO USE DEB          28350002
         TM    TIOESTTA,DYNALLOC   THIS A DYNAMIC ENTRY?    D11 ZA10028 28360000
         BO    DEBCK               YES,NOGOOD,USE DEB       D11 ZA10028 28370000
         LA    RLOC,TIOESTTB             GET ADDR OF UCB DEVICE ENTRIES 28400002
         AR    RTIOT,REXT            ADJUST TO NEXT DD ENTRY            28450002
         SH    REXT,SIXTEEN              IF YES, CALC # ENTRIES         28500002
         BNP   DEBCK                        IF NEGATIVE, NO ENTRIES     28550002
         SRL   REXT,TWO                     IF POSITIVE, 4 BYTES/ENTRY  28600002
         BAL   RBACK,RESETUCB            CLEAR UCB FIELDS               28650002
         B     TIOTOK            CONTINUE WITH NEXT DD ENTRY            28700002
         EJECT                                                          28750002
*********************************************************************** 28800002
*                                                                     * 28850002
*                DEB USED AS SECOND CHOICE FOR UCB RESET INFO         * 28900002
*                                                                     * 28950002
*********************************************************************** 29000002
DEBCK    EQU   *                                                        29050002
         LTR   RDEB,RDEB       IS THERE A DEB                           29100002
         BZ    DCBCK             IF NO, CHECK IF A GAM DCB IS AVAILABLE 29150002
         SR    REXT,REXT         IF YES, CLEAR FOR NBR OF UCBS          29200002
         LA    RLOC,DEBSUCBA       GET ADDR OF UCB ENTRIES              29250002
         IC    REXT,DEBNMEXT       GET NBR OF UCBS                      29300002
         BAL   RBACK,RESETUCB     CLEAR UCB FIELDS                      29350002
         EJECT                                                          29400002
*********************************************************************** 29450002
*                                                                     * 29500002
*               DEACTIVATE POLL LIST OF DCBS IF:                      * 29550002
*                 1. DCB BEING RECOVERED IS FOR GRAPHICS              * 29600002
*                 2. EXPRESS ATTENTION HANDLING BEING USED            * 29650002
*                                                                     * 29700002
*           NOTE:  POLL LIST PROCESSING DONE IN USER'S KEY            * 29750002
*                                                                     * 29800002
*********************************************************************** 29850002
DCBCK    EQU   *                                                        29900002
         CLI   DCBDSRG2,DCBDSGGS     CK IF DCB IS GRAPHICS              29950002
         BE    DCBOK                    IF YES, OK TO CHECK POLL LIST   30000002
         LA    RCODE,RC4                IF NO, RETURN WITH RC, NO RETRY 30050002
         B     RETURN                                                   30100002
DCBOK    EQU   *                                                        30150002
         L     RADR,DCBPOLST         CK IF POLL LIST IS AVAILABLE       30200002
         LTR   RADR,RADR                IF NO, PROCESSING DONE          30250002
         BZ    DONE                                                     30300002
         CLI   DCBGTYPE,DCBGTEXP        IF YES, MUST BE EXPRESS         30350002
         BNE   DONE                        IF NOT, DON'T ZERO           30400002
         MODESET  KEYADDR=DXUKEY,WORKREG=15                             30450002
         SR    RLIST,RLIST              GET SOURCE OF ZEROS             30500002
         ST    RLIST,ZERO(RADR)         ZERO POLL LIST ACTIVE ENTRY     30550002
         MODESET  EXTKEY=DATAMGT                                        30600002
DONE     EQU   *                                                        30650002
         SR    RCODE,RCODE             INDICATE PROCESSING COMPLETED    30700002
RETURN   EQU   *                                                        30750002
         MODESET EXTKEY=DATAMGT                                         30800002
         RETURN (14,12),T,RC=(15)                                       30850002
         EJECT                                                          30900002
*********************************************************************** 30950002
*                                                                     * 31000002
*            RESET UCB FIELDS    (INTERNAL SUBROUTINE)                * 31050002
*                                                                     * 31100002
*        SEE PROLOG FUNCTION DESCRIPTION FOR DETAILS OF FIELDS        * 31150002
*                                                                     * 31200002
*********************************************************************** 31250002
RESETUCB EQU   *                                                        31300002
         L     RUCB,ZERO(RLOC)    LOAD FIRST/NEXT UCB ADDRESS           31350002
         CLI   UCBID,UCBSTND      CHECK FOR UCB VALIDITY                31400002
         BNE   NEXTUCB               IF INVALID, GET NEXT UCB           31450002
         CLI   UCBTBYT3,UCB3DISP     IS DEVICE GRAPHICS TYPE            31500002
         BNE   NEXTUCB                 IF NO, GET NEXT UCB              31550002
         CLI   UCBTBYT4,UCBT1053     IS DEVICE 1053 TYPE                31600002
         BE    UCBOK                   IF YES,  OK TO PROCESS           31650002
         CLI   UCBTBYT4,UCBT2260     IS DEVICE 2260 TYPE                31700002
         BE    UCBOK                   IF YES,  OK TO PROCESS           31750002
         CLI   UCBTBYT4,UCBT2250     IS DEVICE 2250 TYPE                31800002
         BNE   NEXTUCB                 IF NO, GET NEXT UCB              31850002
UCBOK    EQU   *                                                        31900002
         SR    RADR,RADR          GET SOURCE OF ZEROS                   31950002
         STH   RADR,UCBOPEN        RESET COUNTER AND CLEAR GCB          32000002
         ST    RADR,UCBTEB         PREVENT USE OF BAD CBS               32050002
NEXTUCB  EQU   *                                                        32100002
         LA    RLOC,ADR(RLOC)     ADJUST ADDR TO NEXT ENTRY             32150002
         BCT   REXT,RESETUCB       GET NEXT UCB ENTRY                   32200002
         BR    RBACK               RETURN FOR CONTINUED PROCESSING      32250002
SIXTEEN  DC    H'16'                                                    32300002
         SPACE 3                                                        32350002
**********************************************************************  32400002
*                                                                    *  32450002
*                SPECIAL MAINTENANCE PATCH AREA FOR FIELD USE        *  32500002
*                                                                    *  32550002
**********************************************************************  32600002
PATCH1   DS    0F         50 BYTE PATCH AREA.'              D11         32650000
         DC    50X'FF'                                      D11         32700000
         EJECT                                                          32750002
BUFTAB   DSECT                                                          32800002
*                                                                       32850002
BTTOTSEC DS    CL2  HEADER:  TOTAL NUMBER OF 256 BYTE SECTIONS          32900002
BTNUMDEV DS    CL2                           DEVICES SHARING BUFFER     32950002
BTEXPSIZ DS    CL2                           SECTIONS FOR EXPRESS       33000002
BTTOTAVL DS    CL2                           SECTIONS STILL AVAIL       33050002
*                                                                       33100002
BTDVAS   DS    CL2  DEVICES: CURRENT NBR OF SECTIONS ASGNED TO DEVICE   33150002
BTDVDZ   DS    CL2           DISPL INTO BT FOR THIS DEVICE'S ZONE       33200002
BTDVSZ   DS    CL2           NBR OF SECTIONS IN THIS DEVICE'S ZONE      33250002
BTDVGS   DS    CL2           NBR OF GUARANTEED SECTIONS FOR THIS DEVICE 33300002
*            START OF BUFFER ASSIGNMENTS FOR 2250-1S                    33350002
BTASGMT1 DS    CL56 ASGMT:   ASSIGNMENTS WILL CONTAIN DEVICE IDS        33400002
         SPACE 3                                                        33400102
         ORG   BTASGMT1                                                 33400402
*                                                                       33402002
BTDV2AS  DS    CL2  DEVICE2: CURRENT NBR OF SECTIONS ASGNED TO DEVICE   33404002
BTDV2DZ  DS    CL2           DISPL INTO BT FOR THIS DEVICE'S ZONE       33406002
BTDV2SZ  DS    CL2           NBR OF SECTIONS IN THIS DEVICE'S ZONE      33408002
BTDV2GS  DS    CL2           NBR OF GUARANTEED SECTIONS FOR THIS DEVICE 33408402
*                                                                       33408802
BTDV3AS  DS    CL2  DEVICE3: CURRENT NBR OF SECTIONS ASGNED TO DEVICE   33418802
BTDV3DZ  DS    CL2           DISPL INTO BT FOR THIS DEVICE'S ZONE       33428802
BTDV3SZ  DS    CL2           NBR OF SECTIONS IN THIS DEVICE'S ZONE      33438802
BTDV3GS  DS    CL2           NBR OF GUARANTEED SECTIONS FOR THIS DEVICE 33448802
*                                                                       33449202
BTDV4AS  DS    CL2  DEVICE4: CURRENT NBR OF SECTIONS ASGNED TO DEVICE   33449602
BTDV4DZ  DS    CL2           DISPL INTO BT FOR THIS DEVICE'S ZONE       33449702
BTDV4SZ  DS    CL2           NBR OF SECTIONS IN THIS DEVICE'S ZONE      33449802
BTDV4GS  DS    CL2           NBR OF GUARANTEED SECTIONS FOR THIS DEVICE 33449902
*            START OF BUFFER ASSIGNMENTS FOR 2250-3S                    33466602
BTASGMT3 DS    CL56 ASGMT:   ASSIGNMENTS WILL CONTAIN DEVICE IDS        33476602
         EJECT                                                          33483302
         CVT   DSECT=YES                                                33500002
         EJECT                                                          33550002
         DCBD  DSORG=GS                                                 33600002
         EJECT                                                          33650002
         IEZDEB                                                         33700002
         EJECT                                                          33750002
         IHADSAB                                                        33800002
         IECDSECS MAIN,EXPAND=YES                                       33850002
         IEZJSCB                                                        33900002
         EJECT                                                          33950002
         IHAQDB                                                         34000002
         EJECT                                                          34050002
*                  ROUTINE ENTRY BLOCK (REB)                            34100002
*                                                                       34150002
*       1.  CREATED BY USER WITH GRAPHICS SPAR MACRO                    34200002
*       2.  SEE SVC MODULE, IGC0007C FOR FURTHER DETAILS                34250002
*                                                                       34300002
REB      DSECT                                                          34350002
REBL     DS    F       ADDR OF:     NEXT LOWER PRIORITY REB, OR ZEROS   34400002
REBH     DS    F                     NEXT HIGHER PRIORITY REB, OR TEB   34450002
REBUCB   DS    F                     UCB, OR LIST OF UCBS               34500002
REBGACB  DS    F                     GACB                               34550002
REBGEIRB DS    F                     GEIR'S IRB                         34600002
REBFLGS  DS    H       FLAGS:                                           34650002
REBPRTY  DS    H                     PRIORTY INDICATED BY USER IN SPAR  34700002
REBQ1    DS    F       ADDR OF:      IQE TO BE PROCESSED IF EP=0        34750002
REBQ2    DS    F                     IQE NEXT TO BE PROCESSED           34800002
REBTCB   DS    F                     TCB                                34850002
REBRES   DS    F                     RESERVED                           34900002
         EJECT                                                          34950002
         IHARB                                                          35000002
         EJECT                                                          35050002
         IHARMPL                                                        35100002
         IECDSECS RRPL,EXPAND=YES                                       35150002
         IKJTCB DSECT=YES                                               35200002
         EJECT                                                          35250002
TEB      DSECT                                                          35300002
TEBCKRB  DS    F       ADDR OF:      IRB FOR CANCEL KEY (IFFCAN03)      35350002
TEBREB   DS    F                     GAM ROUTINE ENTRY BLOCK            35400002
TEBTCB   DS    F                     TCB                                35450002
TEBCKQE  DS    F                     LIST OF CANCEL KEY IQES            35500002
TEBUCBCT DS    F       USE COUNT:    NBR OF UCBS USING THIS TEB         35550002
TEBFLGS  DS    F       FLAG BYTES:                                      35600002
TEBFLAG  EQU   X'80'                 TEB ID FLAG                        35650002
TEBGARB  DS    F       ADDR OF:      IRB FOR GAR (IGG019OE)             35700002
TEBGEIR  DS    F                     ENTRY POINT FOR GEIR (IGG019OJ)    35750002
         EJECT                                                          35800002
TIOT     DSECT                                                          35850002
         IEFTIOT1                                                       35900002
         EJECT                                                          35950002
UCB      DSECT                                                          36000002
         IEFUCBOB                                                       36050002
**********************************************************************  36100002
*                                                                     * 36150002
*                    ADDITIONAL UCB EQUATES FOR DSECT                 * 36200002
*                                                                     * 36250002
*********************************************************************** 36300002
         SPACE 3                                                        36350002
*          UCBTYP, BYTE 1, BIT SETTINGS                                 36400002
         SPACE                                                          36450002
UCBTMOD3 EQU   X'33'           UNIT TYPE SETTING FOR 2250-3 MODEL       36500002
         SPACE 3                                                        36550002
*          UCBTYP, BYTE 2, BIT SETTINGS                                 36600002
         SPACE                                                          36650002
UCBTPFK  EQU   X'10'           UNIT TYPE BIT 3 FOR PFK FEATURE          36700002
         SPACE 3                                                        36750002
*          UCBTYP, BYTE 4, BIT SETTINGS                                 36800002
         SPACE                                                          36850002
UCBT2250 EQU   X'02'           UNIT TYPE ID FOR 2250 DEVICE             36900002
UCBT2260 EQU   X'03'                        FOR 2260                    36950002
UCBT1053 EQU   X'04'                        FOR 1053                    37000002
         SPACE 2                                                        37050002
*          UCBGCB, BIT SETTINGS                                         37100002
         SPACE                                                          37150002
UCBGINIT EQU   X'40'                   OK TO ACCEPT ATTNS NOW    A32068 37200002
UCBGBAS  EQU   X'08'                                                    37250002
UCBGSET  EQU   X'B7'                   RESET ABOVE BITS TO ZERO         37300002
*   END OF ADDITIONAL UCB BIT SETTINGS                      D11         37310000
DYNALLOC EQU   X'80'               TO TEST TIOTENTRY        D11 ZA11330 37320000
         END                                                            37350002
