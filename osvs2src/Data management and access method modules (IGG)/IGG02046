2046     TITLE '''IGG02046'' - TCAM/SAM CLOSE EXECUTOR'                 00100020
IGG02046 CSECT                                                          00200020
         SPACE 3                                                SA62364 00200151
*CHANGE-ACTIVITY = AS FOLLOWS:                                  SA21903 00200351
**************************** MICROFICHE FLAGS *************** SUPT CODE 00200651
*C212000                                                        SA55923 00201051
*A094300                                                         S22025 00201151
*A246000,538000                                                 SA53606 00201251
*A094000,334000,491000,510600,511500                             A47157 00201351
*D522000                                                         A47157 00201451
*A073000,074000,076000,078000,080000,082000,084000,089000,106000 CLUP21 00201551
*A112000,149000,165000,192000,196000,239000,268000,314000,317000 CLUP21 00201651
*A321000,357000,361000,369000,372000,491000                      CLUP21 00201751
*C094000,108000,129300-129600,130900,157000,194000-195000,237000 CLUP21 00201851
*C256000,316000,319000,324000,352000,359000-360000,371000,433000 CLUP21 00201951
*D138000,141000-143000,153000-155000,169000-171000,188000,224700 CLUP21 00202051
*D241000-243000,271000,273000-274000,299000,325000-328000        CLUP21 00202151
*D346000-349000,384000-385000,445000-449000,470000,471400-475000 CLUP21 00202251
*D491000,494000,497000,505000,508000-509000,511000               CLUP21 00202351
*A221000,227000                                                  A44869 00202451
*D470000,471400,236000-238000                                    CLUP21 00202551
*C224000                                                         CLUP21 00202651
*A136000                                                         A41028 00202751
*C231000,471700                                                  A41028 00202851
*D134000                                                         A41028 00202951
*C212000,213000,215000,216000                                    S21903 00203051
*C161000,254000,307000,391000-394000,427000,434000,437000,454000,S21903 00203151
*C468000,469000,471000,511500,511800,516000,517000               S21903 00203251
*D203000,211000,217000,221000                                  S21903   00203351
*D353300-353600                                                 SA51076 00203451
*D324000                                                        SA50090 00203551
*A224500                                                        SA59162 00203651
*D291000                                                        SA59162 00203751
*C148000                                                        SA60335 00203851
*D165000-187000                                                 SA60335 00203951
*A203500                                                        SA62364 00204051
*C006400,012000-024000,054000,085000,116000-268650,294000        Y02027 00204306
*C297000,397000,398000,451000,477500,498000-500100,511100        Y02027 00204606
*A073700,084200,297300-299700,313020-313800,374000-386000        Y02027 00204906
*A399000-411000,438160-438880,447000,456060,470000-475000,480500 Y02027 00205206
*A523300-523600,537030-538800                                    Y02027 00205506
*D050000,055000-056000,073000,074000-074500,078500,080500,082500 Y02027 00205806
*D084500,089500,096000-099000,104000,303000-308000,397500        Y02027 00206106
*D412000-414000,451090-456000,456200-461750,465000,476000,479500 Y02027 00206406
*D484000,486000,489000,491000,491060,491120,491200,491400,491600 Y02027 00206706
*D503000-506000,509500,511200-517000,525000-536000               Y02027 00207006
*A230000                                                        SA66366 00234054
*A120300,397500,510000                                          SA66747 00264054
*A042400-042800,166200-166800,182500,186300-186600,268900-268930,X01004 00294305
*A288500,289200,295500,305400-305800,477500,479500,481500,       X01004 00294605
*A482200-482600,509700                                           X01004 00294905
*C166000,181000-182000,183000,185000-186000,279000-280000,       X01004 00295205
*C283000-284000,289000,296000-297000,305000,306000,309000-310000 X01004 00295505
*D043000,172000-173000,184000,189000,281000,291000,298000        X01004 00295805
*A042100-042300,121060-121800,129500,129700-129900,130100,153000,Y01004 00296105
*A201800,202600,206100-206200,218100-218200,220500-221000,221500,Y01004 00296405
*A224200,294500,397500,451100-451910,452100,453800,454400-454900,Y01004 00296705
*A455100-458200,483500,491020-491110                             Y01004 00297005
*C024000,042000,108500,120000,136000,148000,158000,201000,       Y01004 00297305
*C204000-206000,220000,227200-227800,294000,307000,312000-313000,Y01004 00297605
*C397000,451000,452000,454000,455000                             Y01004 00297905
*D025000,105000,129300,129600,130000,130600,135000,136500,       Y01004 00298205
*D149000-152000,156000-157000,159000-165000,202000,216000-217500,Y01004 00298505
*D221200-221400,221600-221800,235000-264000,314000-369000,       Y01004 00298805
*D374000-396000,399000-411000,453000,469300-471200               Y01004 00299105
*A459050-459150                                                  X02004 00299405
*D461600-461700                                                  X02004 00299705
*A174030-174150,153050                                         @ZA00234 00299861
*D186220,186280                                                @ZA00234 00299961
*A103000,140200,190500,475000,522000                           @ZA01439 00300061
*D171200                                                       @ZA01439 00300161
*D179500-180000,182500-183000                                  @ZA00234 00300261
*A153000                                                       @ZA00234 00300561
*C146000                                                       @ZA00234 00300861
*A184350,186500                                                @ZA01567 00301161
*A161000,173000,185200,502000,537550,538800                    @ZA02601 00311161
*C137000-140264,140600,145600-159000,168000-169000             @ZA02601 00321161
*C174030-174150,385000                                         @ZA02601 00331161
*C386000,438160-438880                                         @ZA02601 00341161
*D179000,184200-184390,187200,188500-190900                    @ZA02601 00351161
*D118000                                                       @ZA02601 00361161
*C385000                                                       @ZA02601 00371161
*D120000,116000,438160-438660                                  @ZA04027 00371681
*C156400-156600,386000-402000                                  @ZA04027 00372181
*A192000                                                       @ZA04027 00372681
*C151000                                                       @ZA05047 00372781
*D193400                                                       @OZ07799 00372881
*A438000                                                       @OZ07799 00372981
*C174000                                                       @OZ07798 00373081
*C148600-148800                                                @OZ07819 00373181
*A156400                                                       @OZ07819 00373281
*D161000,438300-438500,410000                                  @OZ07819 00373381
*C313180                                PECB DSECT CHG         @OZ07830 00373481
*A149600,150000,151600,152200,468000                           @OZ17630 00373581
*D140280-140840                                                @OZ19756 00379500
*A148000                                                       @OZ19756 00385500
*C008200,171400,171600                                         @Z40X9TG 00391500
*C313240-313260                                                @OY16374 00392500
*D313320-313340                                                @OY16374 00393500
*A411000                                                       @OZ18749 00394500
*D148600-148800,438100-438700                                  @OZ18749 00395500
*                                       PECB DSECT CHG         @OZ18744 00395686
*********************************************************************** 00400020
*                                                                     * 00500020
*TITLE: 'IGG02046' TCAM APPLICATION PROGRAM CLOSE EXECUTOR            * 00600020
*                                                                     * 00610051
*DESCRIPTIVE NAME = TCAM APPL PROG CLOSE EXECUTOR                     * 00640006
*                                                                     * 00670051
*  DESCRIPTIVE NAME = TCAM APPLICATION PROGRAM CLOSE EXECUTOR ( LOAD 1  00700051
*                                                                     * 00730051
*  COPYRIGHT = 'NONE'                                                 * 00760051
*                                                                     * 00790051
*  STATUS CHANGE LEVEL 5                                              * 00820051
*                                                                     * 00900020
*FUNCTION: THIS MODULE DEACTIVATES A DATA TRANSFER COMMUNICATION LINK * 01000020
*   BETWEEN AN APPLICATION PROGRAM AND THE MCP.  IT EXECUTES IN       * 01100020
*   SUPERVISOR MODE AND, FOR THE MOST PART, IN KEY 5.                 * 01200006
*                                                                     * 01270006
*   IF CLOSE WAS ENTERED FOR ABEND, THE PEB IS INVALIDATED SO NO      * 01340006
*   MCP ROUTINE WILL POST BACK TO THE APPLICATION PROGRAM             * 01410006
*                                                                     * 01480006
*   IF THE MCP IS ACTIVE, OPEN SETS UP TO GIVE CONTROL TO THE         * 01550006
*   OPEN/CLOSE SUBTASK IN THE MCP.  ONCE PER CLOSE, CORE IS           * 01620006
*   GOTTEN FOR AN RCB. THE RCB IS INITIALIZE WITH INFORMATION         * 01690006
*   NEEDED BY IEDQEU.  FOR INPUT DCB, IF THE ERB IS BUSY, A WAIT      * 01760006
*   IS ISSUED. (WHEN ERB IS FREED,THE RCB WILL BE POSTED TO EU.)      * 01830006
*   AN SVC 102 IS ISSUED WITH POST CODE IN PARMLIST. IT IS            * 01900006
*   FOLLOWED BY A WAIT FOR IEDQEU.                                    * 01970006
*   UPON RETURN, ACCESS METHOD MODULES ARE DELETED AND CORE FOR       * 02040006
*   PECB AND LOCATE MODE WORK AREA IS FREED.                          * 02110006
*                                                                     * 02180006
*   ON A CLOSEDOWN, THE OPERATOR CONTROL ECB IS POSTED COMPLETE.      * 02250006
*                                                                     * 02320006
*   BEFORE THE EXECUTOR XCTLS TO THE NEXT ENTRY IN THE WHERE-TO       * 02390006
*   GO TABLE, THE CORE FOR THE RCB IS FREED.                          * 02460006
*                                                                     * 02600020
*ENTRY POINT:                                                         * 02700020
*        IGG02046                                                     * 02800020
*                                                                     * 02900020
*INPUT: REGISTERS 5,6,7 AND 8 CONTAIN THE FOLLOWING VALUES:           * 03000020
*   5 - ADDRESS OF FIRST ENTRY IN DCB PARAMETER LIST                  * 03100020
*   6 - ADDRESS OF BEGINNING OF WHERE-TO-GO TABLE                     * 03200020
*   7 - ADDRESS OF CURRENT ENTRY IN DCB PARAMETER LIST                * 03300020
*   8 - ADDRESS OF CURRENT ENTRY IN WHERE-TO-GO TABLE                 * 03400020
*                                                                     * 03500020
*OUTPUT: REGISTERS 5,6,7 AND 8 CONTAIN THE FOLLOWING VALUES:          * 03600020
*   5 - SEE 'INPUT'                                                   * 03700020
*   6 - SEE 'INPUT'                                                   * 03800020
*   7 - ADDRESS OF NEXT ENTRY IN DCB PARAMETER LIST                   * 03900020
*   8 - ADDRESS OF NEXT ENTRY IN WHERE-TO-GO TABLE                    * 04000020
*                                                                     * 04100020
*EXTERNAL ROUTINES: DEBCHK -- SVC 117                                 * 04200005
*                   DELETE -- SVC 9                                   * 04210005
*                   WAIT -- SVC 1                                     * 04220005
*                   XCTL -- SVC 7                                     * 04230005
*                   IEDQEB -- AQCTL SVC 102 ROUTINE -- TO TPOST A     * 04240005
*   SPECIAL ELEMENT TO THE OPEN/CLOSE SUBTASK.                        * 04250005
*                                                                     * 04260005
*EXITS-NORMAL: THIS MODULE XCTLS TO NEXT ENTRY IN WTG TABLE           * 04400020
*                                                                     * 04500020
*EXITS-ERROR                                                          * 04600020
*                                                                     * 04700020
*TABLES/WORK AREAS:                                                   * 04800020
*   CVT                                                               * 04900020
*   DCB                                                               * 05100020
*   TCB                                                               * 05200020
*   DEB                                                               * 05300020
*                                                                     * 05400006
*   OPEN/CLOSE WORK AREA                                              * 05700020
*                                                                     * 05800020
*ATTRIBUTES -- REUSABLE,REENTERANT.                                   * 05900051
*                                                                     * 06000020
*NOTES: THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL         * 06100020
*   REPRESENTATION OF THE EXTERNAL CHARACTER SET WHICH IS EQUIVALENT  * 06200020
*   TO THE ONE USED AT ASSEMBLY TIME.  THE CODING HAS BEEN ARRANGED   * 06300020
*   SO THAT REDEFINITION OF 'CHARACTER' CONSTANTS, BY REASSEMBLY,     * 06400020
*   WILL RESULT IN A CORRECT MODULE FOR THE NEW DEFINITIONS.          * 06500020
*                                                                     * 06600020
*********************************************************************** 06700020
         EJECT                                                          06800020
*                                                                     * 06900020
*              S Y M B O L I C    R E G I S T E R S                   * 07000020
*                                                                     * 07100020
RZERO    EQU   0                        GENERAL WORK REGISTER           07200020
RPARM    EQU   1                                                        07350022
RCORE    EQU   2                        DCB WORK AREA.           Y02027 07370006
RPEWA    EQU   3                        PROCESS ENTRY WORKAREA          07500020
RPENTRY  EQU   4                        PROCESS ENTRY                   07600020
RMACR    EQU   4                        ADDRESS OF APPROPRIATE BYTE     07630022
*                                       IN DCBMACR FIELD                07660022
RPAR     EQU   5                        ADDRESS OF FIRST ENTRY IN       07700020
*                                       DCB PARAMETER LIST              07800020
RWTG     EQU   6                        ADDRESS OF WHERE-TO-GO          07900020
*                                       (WTG) TABLE                     08000020
RPARC    EQU   7                        ADDRESS OF CURRENT ENTRY        08100020
*                                       IN DCB PARAMETER LIST           08200020
RWTGC    EQU   8                        ADDRESS OF CURRENT ENTRY        08300020
*                                       IN WHERE-TO-GO TABLE            08400020
RTCB     EQU   9                        TCB BASE REG.            Y02027 08420006
RTCX     EQU   9                        TCX ADDR                 Y02027 08510006
RDCB     EQU   10                       DATA CONTROL BLOCK              08600020
RDEB     EQU   11                       DATA EXTENT BLOCK               08700020
RBASE    EQU   12                       CSECT BASE REGISTER             08800020
RWORK    EQU   13                       ACCESS METHOD WORKAREA          08900020
RETURN   EQU   14                       RETURN ADDRESS                  09000020
RENTRY   EQU   15                       COMPLETION CODE REGISTER        09100020
         SPACE 3                                                        09200022
         BALR  RBASE,RZERO              ESTABLISH                       09300020
         USING *,RBASE                  ADDRESSIBILITY           CLUP21 09400022
IGG02046 IEDHJN BYPASS                  BRANCH AROUND ID AND DATES22025 09430022
         SPACE 3                                                        09460022
         USING IHADCB,RDCB              DATA CONTROL BLOCK              09500020
         USING IEDQPEWA,RPEWA           PROCESS ENTRY WORKAREA          10000020
         USING IEDQDEB,RDEB             DATA EXTENT BLOCK               10100020
         USING FORCORE,RCORE            DATA CONTROL BLOCK WORKAREA     10200020
         USING IEDQTCB,RTCB             TASK CONTROL BLOCK              10300020
         USING PSA,RZERO                PSA                    @ZA01439 10400061
         EJECT                                                          10600020
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *CLUP21 10650022
*                                                                     * 10700020
* THE FOLLOWING SECTION OF CODE IS EXECUTED FOR EACH DCB BEING   CLUP21 10800022
* CLOSED.  IT INITIALIZES CONTROL BLOCK BASE REGISTERS.          Y01004 10850005
*                                                                     * 10900020
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *CLUP21 11500022
START    EQU   *                                                 Y02027 11650006
         L     RCORE,FOUR(,RWTGC)       ADDRESS OF OPEN WORKAREA.       11700005
         L     RDCB,DXUDCBAD            ADDR OF REAL DCB         Y02027 11900006
         DEBCHK  (RDCB),TYPE=VERIFY,AM=TCAMAP  VALIDATE DEB      Y02027 12100006
         LR    RDEB,RPARM               LOAD DEB BASE REG.       Y02027 12200006
         L     RDCB,ZERO(,RPARC)        LOAD COPIED DCB ADDR.    Y02027 12300006
         TM    DEBPCBAD-ONE,FLGU        IS RECFM DEFAULT VALUE.  Y02027 12400006
         BNO   NOCLEAR                  RECFM IS NOT DEFUALT.    Y02027 12500006
         MVI   DCBRECFM,NULL            SET RECFM TO UNSPECIFIED.Y02027 12600006
NOCLEAR  EQU   *                                                 Y02027 12700006
         MODESET  EXTKEY=ZERO                                           13550006
         XC    DXCCW1,DXCCW1            CLEAR ECB.               Y02027 13600006
         ICM   RPEWA,AD,DEBPEWA         LOAD PEWA ADDRESS      @ZA02601 13700061
         BZ    NOEU                     BRANCH, NO PEWA        @ZA02601 13800061
         EJECT                                                   Y02027 14100006
*****************************************************************Y02027 14200006
***** SET UP RCB FOR IEDQEU(MCP MEMORY) AND POST RCB TO          Y02027 14300006
******   DISABLED READY QUEUE.                                   Y02027 14400006
*****************************************************************Y02027 14500006
         L     RTCX,CVTPTR              LOAD CVT PTR             Y02027 14530006
         ICM   RTCX,ALL,CVTAQAVT-CVT(RTCX) IS MCP ACTIVE       @ZA02601 14560061
         BZ    NOEU                     NO, BYPASS POST TO MCP @ZA02601 14580061
         TM    TCXFLAG1-IEDQTCX(RTCX),TCXMCPCD MCP TERMINATING @ZA02601 14600061
         BO    NOEU                     YES, BYPASS POST TO MCP@ZA02601 14620061
         L     RENTRY,PSAAOLD           ADDRESS OLD ASCB PTR   @ZA02601 14640061
         CLC   ASCBASID-ASCB(TWO,RENTRY),TCXASID-IEDQTCX(RTCX) @ZA02601 14660061
*                                       IS APPL A SUBTASK      @ZA02601 14680061
*                                       OF MCP                 @ZA02601 14700061
         BNE   MCPOK                    BR, NOT IN SAME MEMORY @ZA02601 14720061
         L     RENTRY,TCXTCB-IEDQTCX(RTCX) GET MCP TCB ADDRESS @ZA02601 14740061
         TM    TCBFLGS-IEDQTCB(RENTRY),TERM IS MCP TERMINATING @ZA02601 14760061
         BM    NOEU                     YES, BYPASS POST TO MCP@ZA02601 14780061
MCPOK    EQU   *                                               @ZA02601 14800061
***************** IF APPL PROG IS ABENDING INVALIDATE          @OZ19756 14801000
********       PEB TO PREVENT CROSS MEMORY POST                @OZ19756 14802000
         L     RTCB,DEBTCBAD-ONE        LOAD TCB ADDR          @OZ19756 14803000
         TM    TCBFLGS,ABND             IS APPL PROG ABENDING  @OZ19756 14804000
         BNO   NOTABEND                 BR NO                  @OZ19756 14805000
         ICM   RPARM,AD,DEBPEBAD        GET PEB ADDR           @OZ19756 14806000
         BZ    NOEU                     BR IF NO PEB           @OZ19756 14807000
         MVI   PEBASCB-IEDQPEB(RPARM),FF INVALIDATE THE PEB    @OZ19756 14808000
NOTABEND EQU   *                                               @OZ19756 14809000
         L     RTCX,CVTPTR              GET CVT PTR            @OZ19756 14810000
         ICM   RTCX,ALL,CVTAQAVT-CVT(RTCX)  GET TCX PTR        @OZ19756 14811000
         BZ    NOEU                     MCP NOT ACTIVE IF 0    @OZ19756 14812000
         ICM   RZERO,AD,TCXOCQ-IEDQTCX+ONE(RTCX) GET QCB ADDR  @ZA02601 14820061
         BZ    NOEU                     NO INTERFACE FOR APPL  @ZA02601 14840061
         LA    RPARM,TCXAIBC-IEDQTCX(RTCX) TCX AIB PTR         @ZA02601 14900061
AIBGET   EQU   *                                               @ZA02601 14920061
         ICM   RPARM,AD,AIBCHAIN-IEDQAIB(RPARM) ANY AIB'S AVAIL@ZA02601 14940061
         BNZ   GOTAIBS                  YES, GET ONE           @ZA02601 14960061
         LH    RZERO,TCXSZAIB-IEDQTCX(RTCX)   GET SIZE OF AIB  @OZ17630 14965081
         CH    RZERO,FOURK              SIZE GREATER THAN 4K   @OZ17630 14970081
         BH    GETCORE                  YES, BRANCH            @OZ17630 14975081
         LA    RZERO,HPAGE              2K VALUE               @ZA02601 14980061
         AR    RZERO,RZERO              DOUBLE TO PAGE SIZE    @ZA02601 15000061
GETCORE  EQU   *                                               @OZ17630 15010081
         LR    RCORE,RPARC              SAVE REG ACROSS GETMAIN@ZA02601 15020061
         ICM   RMACR,AD,DEBTCBAD        TCB ADDR FOR GETMAIN   @ZA02601 15040061
         L     RPARC,PSAAOLD            ASCB ADDR FOR GETMAIN  @ZA02601 15060061
*                                       GETMAIN CSA KEY6       @ZA02601 15080061
         MODESET   EXTKEY=TCAM          GET IN KEY 6           @ZA05047 15100081
         GETMAIN RU,LV=(0),SP=CSA,BNDRY=PAGE                   @ZA05047 15106081
         MODESET   EXTKEY=ZERO          GO BACK TO KEY 0       @ZA05047 15112081
         LR    RPARC,RCORE              RESTORE RPARC          @ZA02601 15120061
         L     RCORE,FOUR(,RWTGC)       RESTORE ADDR OF WRKAREA@ZA02601 15140061
         LH    RETURN,TCXSZAIB-IEDQTCX(RTCX) SIZE OF AIB       @ZA02601 15160061
         CH    RETURN,FOURK             SIZE GREATER THAN 4K   @OZ17630 15163081
         BNH   SMALLAIB                 NO, BRANCH             @OZ17630 15166081
         LR    RENTRY,RPARM             GET ADDR OF ONLY AIB   @OZ17630 15169081
         B     CLRBYTE                  BRANCH TO CLEAR BYTE   @OZ17630 15172081
SMALLAIB EQU   *                                               @OZ17630 15175081
         LA    RENTRY,HPAGE             2K VALUE               @ZA02601 15180061
         LA    RENTRY,HPAGE(RENTRY,RPARM) ADDR OF END OF AIBS  @ZA02601 15200061
         SR    RENTRY,RETURN            ADDR OF LAST AIB       @ZA02601 15220061
CLRBYTE  EQU   *                                               @OZ17630 15230081
         LA    RZERO,ZERO(RPARM)        CLEAR HI ORDER BYTE    @ZA02601 15240061
         B     BXLE                     BRANCH TO INITIALIZE   @ZA02601 15260061
CHAINAIB EQU   *                                               @ZA02601 15280061
         ST    RZERO,AIBCHAIN-ONE-IEDQAIB(RPARM) STORE AIB PTR @ZA02601 15300061
         LR    RPARM,RZERO              SAVE CURRENT PTR       @ZA02601 15320061
BXLE     EQU   *                                               @ZA02601 15340061
         BXLE  RZERO,RETURN,CHAINAIB    LOOP THRU NEW CORE     @ZA02601 15360061
*                                       TILL ALL AIBS LINKED   @ZA02601 15380061
         LR    RENTRY,RPARM             LAST AIB PTR           @ZA02601 15400061
         N     RPARM,CLRLOW             START OF GOTTEN CORE   @ZA02601 15420061
         L     RZERO,TCXAIBC-IEDQTCX(RTCX) GET CURRENT AIB PTR @ZA02601 15440061
AIBLOOP  EQU   *                                               @ZA02601 15460061
         ST    RZERO,AIBCHAIN-ONE-IEDQAIB(RENTRY) LINK AIBS    @ZA02601 15480061
         CS    RZERO,RPARM,TCXAIBC-IEDQTCX(RTCX) CHAIN AIBS    @ZA02601 15500061
         BNE   AIBLOOP                  RETRY IF CS FAILED     @ZA02601 15520061
GOTAIBS  EQU   *                                               @ZA02601 15540061
         TS    AIBSTATE-IEDQAIB(RPARM)  ALLOCATE AIB           @ZA02601 15560061
         BNZ   AIBGET                   IN USE, RETRY          @ZA02601 15580061
         MVC   AIBECBA-IEDQAIB(FOUR,RPARM),CLOS SET ID FOR     @ZA02601 15600061
*                                       FAILURE                @ZA02601 15620061
         ST    RPARM,DXCCW12            SAVE AIB ADDR          @ZA04027 15640081
HAVEAIB  EQU   *                                               @OZ07819 15740081
         LA    RPARM,AIBKEY-IEDQAIB(RPARM)  BUMP TO RCB        @ZA04027 15840081
         XC    ZERO(RCBSIZE,RPARM),ZERO(RPARM) CLEAR RCB       @ZA02601 16150061
         USING IEDQRECB,RPARM           SET UP RCB BASE.         Y02027 16200006
         MVI   RECBKEY,ZERO             SET KEY FOR CLOSE.       Y02027 16300006
         MVI   RECBPRI,CLOSEPRI         SET CLOSE PRIORITY.      Y02027 16400006
         MVC   RECBQCBA(3),TCXOCQ-IEDQTCX+ONE(RTCB) MOVE QCB ADDRY02027 16500006
         MVC   RCBTCB+ONE(THREE),DEBTCBAD MOVE TCB ADDR TO RCB.  Y02027 16600006
         MVC   RCBDCBMA,DCBMACRF        MOVE MACRF TO RCB.       Y02027 16700006
         L     RENTRY,DEBTCBAD-ONE      APPL TCB ADDR          @ZA02601 16800061
         MVC   RCBTCBFL,TCBFLGS-IEDQTCB(RENTRY) MOVE TCB FLAGS @ZA02601 16900061
         LA    RZERO,DXCCW1             LOAD CLOSE ECB ADDR.     Y02027 17000006
         ST    RZERO,RCBPECB            STORE ECB ADDR IN RCB.   Y02027 17100006
         L     RPEWA,PSAAOLD            GET PTR TO CURRENT ASCB@Z40X9TG 17108000
         LA    RPEWA,ZERO(,RPEWA)       CLEAR HIGH BYTE        @Z40X9TG 17116000
         ST    RPEWA,RCBASCB            SET ASCB IN RCB        @Z40X9TG 17124000
         MVC   RCBASID+TWO(TWO),ASCBASID-ASCB(RPEWA) SET       @Z40X9TG 17132000
*                                       ASID                   @Z40X9TG 17140000
         ICM   RPEWA,AD,DEBPEWA         LOAD PEWA ADDR.          Y02027 17200006
         ST    RPEWA,RCBDSNM            PASS PEWA ADDR. IN RCB.  Y02027 17300006
         STM   RDCB,RENTRY,RCBSAVE      SAVE REGS OVER SETLOCKS@ZA02601 17303061
LOCALGET SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                @ZA02601X17306061
               RELATED=(PEBPEWA,IEDQEU(LOCALREL),IEDQOT01(LOCALREL),IGGX17309061
               02046(LOCALREL))                                @ZA02601 17312061
CMSGET   SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,                  @ZA02601X17315061
               RELATED=(PEBPEWA,IEDQEU(CMSREL),IEDQOT01(CMSREL),IGG0204X17318061
               6(CMSREL))                                      @ZA02601 17321061
         LM    RDCB,RENTRY,RCBSAVE      RESTORE REGS           @ZA02601 17322061
         LA    RMACR,TCXPEWAC-IEDQTCX-PEWALINK+IEDQPEWA(RTCX)  @ZA02601 17324061
*                                       FIRST PEWA ADDRESS     @ZA02601 17327061
         LA    RPEWA,ZERO(RPEWA)        CLEAR HIGH BYTE        @ZA02601 17330061
LOOPPEWA EQU   *                                               @ZA02601 17333061
         ICM   RMACR,ALL,PEWALINK-IEDQPEWA(RMACR) GET PEWA     @ZA02601 17336061
         BZ    ENDPEWA                  END OF CHAIN           @ZA02601 17339061
         CR    RMACR,RPEWA              PEWA IN CHAIN          @ZA02601 17342061
         BNE   LOOPPEWA                 NO, CHECK NEXT PEWA    @ZA02601 17345061
ENDPEWA  EQU   *                                               @ZA02601 17348061
CMSREL   SETLOCK RELEASE,TYPE=CMS,                             @ZA02601X17351061
               RELATED=(PEBPEWA,IEDQEU(CMSGET),IEDQOT01(CMSGET),IGG0204X17354061
               6(CMSGET))                                      @ZA02601 17357061
LOCALREL SETLOCK RELEASE,TYPE=LOCAL,                           @ZA02601X17360061
               RELATED=(PEBPEWA,IEDQEU(LOCALGET),IEDQOT01(LOCALGET),IGGX17363061
               02046(LOCALGET))                                @ZA02601 17366061
         LM    RDCB,RENTRY,RCBSAVE      RETORE REGS            @ZA02601 17369061
         LTR   RMACR,RMACR              PEWA FOUND IN CHAIN    @ZA02601 17372061
         BZ    NOEU                     NO, BYPASS POST TO MCP @ZA02601 17375061
         ST    RPARM,PEWARCB            SAVE RCB ADDR IN PEWA  @OZ07798 17400081
         TM    PEWAFLG,CFLG             ALREADY REQUESTED CLOSE@ZA02601 17403061
         BO    NOEU                     YES, BYPASS POST TO MCP@ZA02601 17433061
         OI    PEWAFLG,CFLG             SET CLOSE FLAG         @ZA02601 17463061
         CLI   DCBMACRF,ZERO            TEST FOR OUTPUT.         Y02027 17500006
         BE    ERBFREED                 BRANCH IF OUTPUT.        Y02027 17600006
         TM    PEWAFLG,ERBBUSY          TEST FOR ERB BEING BUSY. Y02027 17700006
         BNO   ERBFREED                 BRANCH IF ERB NOT BUSY.  Y02027 17800006
         B     WAITX                    GO WAIT FOR EU.          Y02027 18100006
ERBFREED EQU   *                                                 Y02027 18200006
*              PUT RCB ON ASYCHRONOUS READY QUEUE TO ACTIVATE    Y02027 18400006
*              IEDQEU SUBTASK IN MCP                             Y02027 18410006
         L     RENTRY,TCXREADY-IEDQTCX(RTCX)  FIRST ELEMENT      Y02027 18440006
POSTLOOP STCM  RENTRY,AD,RECBLINK-IEDQRECB(RPARM) POINT NEW      Y02027 18450006
*                                       ELEMENT TO FIRST ELEMENT Y02027 18460006
         CS    RENTRY,RPARM,TCXREADY-IEDQTCX(RTCX) CURRENT       Y02027 18470006
*                                       ELEMENT UPDATED?         Y02027 18480006
         BNE   POSTLOOP                 BRANCH IF YES, TRY AGAIN Y02027 18490006
*                                       NO, ASYCN READY QUEUE    Y02027 18500006
*                                       UPDATED WITH ELEMENT     Y02027 18510006
*                                                                Y02027 18520006
         TS    RCBERR                   SET QEU POSTED         @ZA02601 18525061
*              POST MCP ECB COMPLETE                             Y02027 18530006
*                                                                Y02027 18540006
         L     RENTRY,TCXAVT-IEDQTCX(RTCX)  GET AVT ADDRESS      Y02027 18550006
         LA    RENTRY,AVTOSECB-IEDQAVTD(RENTRY) MCP-ECB ADDRESS  Y02027 18560006
         ST    RENTRY,DXCCW2            STORE IN PARAMETER LIST  Y02027 18570006
         L     RENTRY,CVTPTR            ADDRESS OF CVT           Y02027 18580006
         LA    RENTRY,CVTBRET-CVT(RENTRY) ERROR ADDRESS          Y02027 18590006
         ST    RENTRY,DXCCW2+EIGHT      AND STORE IN LIST        Y02027 18600006
         MVC   DXCCW2+FOUR(4),TCXASCB-IEDQTCX(RTCX) STORE ADDRESSY02027 18610006
*                                       OF ASCB IN LIST          Y02027 18620006
         SR    RZERO,RZERO              ZERO COMPLETION CODE     Y02027 18630006
         LA    RPARM,DXCCW2             ADDRESS OF LIST          Y02027 18640006
         POST  ,(0),MF=(E,(1))                                          18650006
WAITX    EQU   *                                                 Y02027 18800006
         MODESET   EXTKEY=ZERO                                 @ZA02601 18850061
         L     RTCB,DEBTCBAD-ONE  RELOAD TCB ADDR                Y02027 19100006
         WAIT  ECB=DXCCW1               WAIT ON EU               Y02027 19200006
         L     RPEWA,DXCCW12            AIB ADDR               @ZA04027 19220081
         LA    RPARM,AIBKEY-IEDQAIB     RCB OFFSET             @ZA04027 19240081
         AR    RPARM,RPEWA              BUMP TO RCB            @ZA04027 19260081
         MVC   DXCCW1+FIVE(3),RCBPEBAD   ASCB ADDR OF MCP      @ZA04027 19280081
         MVC   DXCCW1(1),RCBAVTBT       AVTBIT1 FROM EU        @ZA04027 19300081
         MVC   DXCCW1+ONE(3),RCBOPECB   MOVE ECB ADDR          @ZA04027 19320081
NOEU     EQU   *                        MCP ABENDING             Y02027 19400006
         EJECT                                                          26400020
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *CLUP21 26500022
*                                                                     * 26600020
* DETERMINE LOAD MODULES TO BE DELETED AND DELETE THEM                * 26700020
*                                                                     * 26800020
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *CLUP21 26830022
DELETE1  EQU   *                                                 Y02027 26860006
         NI    DEBDCBAD-ONE,FF-DEBID    CLEAR TCAM DEB I.D.      Y02027 26865006
         LA    RPEWA,DELE               RPEWA = ADDRESS OF SUB-  X01004 26870005
*                                       ROUTINE TO DELETE MODULES.      26880005
         CLI   DCBMACRF,OUT             IS THIS AN OUTPUT DCB           26900020
         BE    OUTDCB                   BRANCH IF YES                   27000020
         LA    RMACR,DCBMACRF           ADDRESS OF INPUT DCB            27500020
*                                       INSTRUCTION REFERENCE           27600020
         MVI   MNAME+SEVEN,RG           GET/READ MODULE ID.             28300005
         BALR  RETURN,RPEWA             DELETE GET/READ ROUTINE. X01004 28400005
         TM    0(RMACR),READFLG         BSAM LEVEL                      28500020
         BZ    POINT                    BRANCH IF NO                    28600020
CHECK    EQU   *                                                        28700020
         MVI   MNAME+SEVEN,RL           CHECK MODULE ID.                28800005
         XC    DCBCHECK+ONE(THREE),DCBCHECK+ONE  REMOVE CHECK    X01004 28850005
*                                       ROUTINE'S ENTRY POINT    X01004 28900005
*                                       ADDRESS FROM DCB.        X01004 28950005
         BALR  RETURN,RPEWA             DELETE CHECK ROUTINE     X02004 29000005
POINT    EQU   *                                                        29200020
         TM    0(RMACR),POINTFLG        POINT(RETRIEVE) SPECIFIED       29300020
         BZ    FREEWA                   BRANCH IF NO             Y02027 29400006
         MVI   MNAME+SEVEN,RM           POINT MODULE ID.                29500005
         XC    DCBPOINT(FOUR),DCBPOINT  REMOVE POINT ROUTINE'S   X01004 29550005
*                                       ADDRESS FROM DCB.        X01004 29600005
         BALR  RETURN,RPEWA             DELETE POINT MODULE      Y02027 29700006
         B     FREEWA                   BRANCH TO FREE STORAGE   Y02027 29730006
*****************************************************************CLUP21 29760006
*                                                                     * 29790006
* DELETE SPECIFIED ACCESS METHOD MODULE                          CLUP21 29820006
*                                                                     * 29850006
*****************************************************************CLUP21 29880006
DELE     EQU   *                                                        29910006
         DELETE EPLOC=MNAME                                      CLUP21 29940006
         BR RETURN                      RETURN TO CALLER         CLUP21 29970006
OUTDCB   EQU   *                                                        30000020
         LA    RMACR,DCBMACRF+ONE       ADDRESS OF OUTPUT DCB.          30100005
*                                       INSTRUCTION REFERENCE           30200020
         MVI   MNAME+SEVEN,RI           PUT/WRITE MODULE ID.            30900005
         BALR  RETURN,RPEWA             DELETE PUT/WRITE ROUTINE.X01004 31000005
         TM    0(RMACR),WRITEFLG        BSAM DCB                        31100020
         BNZ   CHECK                    BRANCH IF YES TO DELETE  Y01004 31200005
*                                       CHECK ROUTINE.           Y01004 31300005
*****************************************************************CLUP21 31302006
*                                                                CLUP21 31304006
* FREE DYNAMICALLY ALLOCATED MAIN STORAGE AND CLEAN UP THE DEB   CLUP21 31306006
*                                                                CLUP21 31308006
*****************************************************************CLUP21 31310006
FREEWA   EQU   *                                                        31312006
         XC    DCBREAD+1(3),DCBREAD+1                                   31314006
         L     RZERO,DCBPECB            ADDRESS OF PECB          Y02027 31316006
         LA    RPENTRY,PECBSIZE         SIZE OF PECB             Y02027 31318006
         BAL   RETURN,BLDLIST           FREE ACCESS METHOD WORKAREA     31322006
         ICM   RZERO,AD,DEBLCMWA        GET LOCATE MODE W/A    @OY16374 31324000
         BZ    FREEDEB                  BR, NOT LOCATE MODE    @OY16374 31326000
         LH    RPENTRY,DEBSOWA          SIZE OF LOCATE MODE      Y02027 31328006
*                                       WORKAREA                 Y02027 31330006
         BAL   RETURN,BLDLIST           FREE LOCATE MODE WORKAREA       31336006
FREEDEB  EQU   *                                                        31338006
         MVI   DEBTAMID,NULL                                     CLUP21 31342006
         XC    DEBLCMWA(3),DEBLCMWA                                     31344006
         XC    DEBPCBAD(3),DEBPCBAD     ZERO PCB PTR IN DEB      Y02027 31344506
         XC    DEBPEBAD(3),DEBPEBAD     ZERO PEB ADDR IN DEB     Y02027 31345006
         XC    DEBPEWA(3),DEBPEWA       ZERO PEWA ADDR IN DEB    Y02027 31345506
         B     EXITTST                  PREPARE TO EXIT                 31346006
*****************************************************************CLUP21 31348006
*                                                                CLUP21 31350006
* THIS SUBROUTINE SETS UP A PARAMETER LIST TO BE USED FOR        CLUP21 31352006
*  DEALLOCATION OF MAIN STORAGE ALLOCATED AT OPEN TIME           CLUP21 31354006
*                                                                CLUP21 31356006
*****************************************************************CLUP21 31358006
BLDLIST  EQU   *                                                        31360006
         LR    RPARM,RZERO              FREEMAIN ARB ADDRESS     Y02027 31362006
         LA    RPARM,0(0,RPARM)         CLEAR HIGH ORDER BYTE    Y02027 31364006
         LTR   RPARM,RPARM              AREA TO BE FREED         Y02027 31366006
         BCR   8,RETURN                 EXIT IF NO                      31368006
         LA    RZERO,0(0,RPENTRY)       FREEMAIN WORKAREA SIZE   Y02027 31370006
         O     RZERO,POOL               SET SUBPOOL VALUE IN REG        31372006
         L     RTCB,DEBTCBAD-ONE        GET TCB ADDRESS          Y02027 31372606
         MODESET  EXTKEY=RBT234,WORKREG=4                               31373206
         FREEMAIN R,LV=(0),A=(1)                                        31374006
         MODESET  EXTKEY=ZERO                                           31379006
         BR    RETURN                   RETURN TO CALLER                31380006
         EJECT                                                          31400020
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *CLUP21 36950022
*                                                                     * 37000020
* SET UP TO TRANSFER CONTROL TO THE NEXT LOAD OF OPEN            CLUP21 37100022
*                                                                     * 37200020
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *CLUP21 37250022
EXITTST  EQU   *                                                        37300020
         MODESET  KEYADDR=DXUKEY,WORKREG=15                      Y02027 37400006
*   RDCB=COPIED DCB, RENTRY=REAL DCB, RWORK=LEN OF PREFIX        Y02027 37500006
         L     RENTRY,DXUDCBAD          LOAD REAL DCB ADDR       Y02027 37600006
         SR    RWORK,RWORK              ZERO REG                 Y02027 37700006
         IC    RWORK,DXUDCBPL+ONE       LEN OF NULL PREFIX       Y02027 37800006
         LA    RENTRY,ZERO(RWORK,RENTRY) PT PAST NULL PREFIX REALY02027 37900006
         AH    RDCB,DXUDCBPL            PT PAST NULL PREFIX COPY Y02027 38000006
         IC    RWORK,DXUDCBML+ONE       LEN OF DCB TO MOVE       Y02027 38100006
         BCTR  RWORK,ZERO               DEC FOR MOVE             Y02027 38200006
         EX    RWORK,DCBMOVE            MOVE COPIED DCB TO REAL  Y02027 38300006
         SH    RDCB,DXUDCBPL            POINT TO PREFIX          Y02027 38400006
         MODESET  EXTKEY=ZERO                                  @ZA02601 38500061
         TM    DXCCW1,AVTCLOSN          IS IT CLOSEDOWN        @ZA04027 38600081
         BNO   NOTCLSDN                 BR, NO                 @ZA04027 39100081
         MVI   DXCCW1,ZERO              RESET FLAGS            @ZA04027 39600081
         L     RENTRY,CVTPTR            LOAD CVT ADDR            Y02027 40300006
         LA    RENTRY,CVTBRET-CVT(,RENTRY) LOAD ADDR OF BR 14    Y02027 40400006
         ST    RENTRY,DXCCW2            STORE ERRET ADDR IN LIST Y02027 40500006
         SR    RZERO,RZERO              CLEAR RETURN CODE.       Y02027 40600006
         LA    RPARM,DXCCW1             LOAD ADDR OF PARM LIST   Y02027 40700006
         POST ,(0),MF=(E,(1))           POST OP CTL CCOMPETE.    Y02027 40800006
NOTCLSDN EQU   *                                                 Y02027 40900006
         XC    NULL(TWO,RWTGC),NULL(RWTGC) CLEAR ID FOR THIS DCB.Y02027 41100006
         ICM   RENTRY,ALL,DXCCW12       AIB TO FREE?           @OZ18749 41150000
         BZ    NOAIB                    BR NO                  @OZ18749 41200000
         MVI   AIBSTATE-IEDQAIB(RENTRY),AIBFREE  FREE AIB      @OZ18749 41250000
NOAIB    EQU   *                                               @OZ18749 41300000
LOOP     EQU   *                                                        41500020
         LA    RWTGC,EIGHT(RWTGC)       BUMP TO NEXT ENTRY IN           41600020
*                                       WTG TABLE                       41700020
         LA    RPARC,FOUR(RPARC)        BUMP TO NEXT ENTRY IN           41800020
*                                       DCB LIST                        41900020
         CLC   NULL(TWO,RWTGC),MODID    ANOTHER TCAM DCB TO CLOSE       42000020
         BE    START                    BRANCH IF YES TO RESTART        42100020
*                                       THIS EXECUTOR                   42200020
         CLC   NULL(TWO,RWTGC),OSID     END OF WTG TABLE                42300020
         BL      LOOP                   BRANCH IF NO                    42400020
*                                                                       42500020
         CLC   NULL(TWO,RWTGC),OSIDH                                    42600005
         BH    LOOP                     CHECK NEXT ENTRY         S21903 42700022
         LR    RPARC,RPAR               RESET POINTER TO BEGINNING      42800020
*                                       OF DCB PARAMETER LIST           42900020
         LA    RWTGC,C32(RWTG)          RESET POINTER TO BEGINNING      43000020
*                                       OF WTG TABLE                    43100020
LABEL    EQU   *                                                        43200020
         CLI   0(RWTGC),NULL            THIS DCB PROCESSED       CLUP21 43300022
         BNE   XCTLRTN                  GO TO RETURN             S21903 43400022
         LA    RWTGC,EIGHT(,RWTGC)                                      43500005
         LA    RPARC,FOUR(,RPARC)                                       43600005
         B     LABEL                    GO TO CHECK NEXT DCB     S21903 43700022
XCTLRTN  EQU   *                                                        43800020
         LA    RENTRY,DXCCW12           GET ADDRESS OF A WORKAREA       43900020
*                                       FOR USE BY XCTL SVC             44000020
         MVC   SIX(TWO,RWTG),NULL(RWTGC) MOVE EXECUTOR ID TO THE        44100020
*                                       PARAMETER LIST                  44200020
         MVC   C14(THREE,RWTG),TWO(RWTGC) MOVE THE TTR TO THE           44300020
*                                       PARAMETER LIST                  44400020
         MODESET   EXTKEY=DATAMGT       BACK TO KEY 5            Y02027 44700006
         XCTL  DE=(RWTG),SF=(E,(15))                                    45000020
DCBMOVE  MVC   ZERO(ZERO,RENTRY),ZERO(RDCB)  MOVE COPIED DCB     Y02027 45106006
*                                       TO REAL DCB              Y02027 45606006
         EJECT                                                          46180005
*                                                                     * 46200020
*              C O N S T A N T S    A N D    E Q U A T E S            * 46300020
*                                                                     * 46400020
MODID    DC    C'46'                    ID OF THIS CLOSE EXECUTOR       46600020
OSID     DC    C'0B'                    ID OF O/S CLOSE EXECUTOR        46700020
OSIDH    DC    C'0G'                    CONSTANT                 S21903 46800022
FOURK    DC    H'4096'                  LENGTH OF A PAGE       @OZ17630 46850081
MNAME    DC    CL8'IGG019R '            CONSTANT                 S21903 46900022
KEY5     DC    X'50'                    KEY 5.                   Y02027 47000006
KEY6     DC    X'60'                    KEY 6.                   Y02027 47100006
SPCSANFP DC    AL1(241)                 USER KEY IN CSA,NOT FTCHPY02027 47200006
         DS    0F                       BOUNDARY ALINEMENT FOR          47300006
*                                       NEXT INSTRUCTION-POOL           47400006
POOL     DC    X'FB000000'              SUBPOOL 251              Y02027 47500006
TERM     EQU   X'C0'                    TCB TERMINATE FLAGS    @ZA01439 47600061
NULL     EQU   0                                                        47700020
ONE      EQU   1                        DISPLACEMENT             Y02027 47750006
TWO      EQU   2                                                        47800020
EIGHT    EQU   8                                                        47900020
FOUR     EQU   4                                                        48000020
NINE     EQU   9                        DISPLACEMENT             Y02027 48050006
C32      EQU   32                                                       48100020
FIVE     EQU   5                                                 X01004 48150005
SIX      EQU   6                                                        48200020
SEVEN    EQU   7                        3-BYTE ICM/STCM MASK.    X01004 48220005
ELEVEN   EQU   11                                                X01004 48240005
TWELVE   EQU   12                                                X01004 48260005
C14      EQU   14                                                       48300020
ALL      EQU   15                       MASK TO ICM/STCM 4 BYTES Y01004 48350005
RG       EQU   C'G'                                                     48500020
RL       EQU   C'L'                                                     48700020
RM       EQU   C'M'                                                     48800020
RI       EQU   C'I'                                                     49000020
POINTFLG EQU   X'04'                    DCBMACR FLAG (POINT)            49200020
LOCMFLG  EQU   X'08'                    DCBMACR FLAG (LOCATE MODE)      49300020
OUT      EQU   X'00'                    DCBMACR FLAG(PUT OR WRITE)      49600020
MOVER    EQU   X'8C'                    AQCTL ACTION CODE FOR-   Y02027 49800006
*                                       POST TO DISABLED QUEUE.  Y02027 49830006
FLGU     EQU   X'80'                    RECFM NOT SPECIFIED      Y02027 49860006
FF       EQU   X'FF'                    ALL BITS ON.             Y02027 49890006
DEBID    EQU   X'0F'                    TCAM DEB IDENTIFIER.     Y02027 49920006
ZERO     EQU   0                        CONSTANT OF ZERO.        Y02027 49950006
AD       EQU   7                        ICM MASK FOR ADDRS.      Y02027 49980006
FREETYPE EQU   X'20'                    FREEMAIN TYPE INDICATOR. Y02027 50010006
ABND     EQU   X'80'                    TCB FLAG FOR ABEND              50100020
THREE    EQU   3                                                        50200020
CSA      EQU   231                      COMMON SUBPOOL         @ZA02601 50270061
HPAGE    EQU   2048                     HALF PAGE SIZE         @ZA02601 50340061
KEY6X    EQU   6                        KEY 6                  @ZA02601 50410061
CLRLOW   DS    0F                       MASK USED TO           @ZA02601 50480061
         DC    X'FFFFF000'              CLEAR 3 LOW BYTES      @ZA02601 50550061
CLOS     DC    C'CLOS'                  CLOSE ID               @ZA02601 50620061
READFLG  EQU   X'20'                                                    50700020
CLOSEPRI EQU   X'C0'                    CLOSE ELEMENT PRIORITY.  X01004 50970005
WRITEFLG EQU   READFLG                                                  51000020
         EJECT                                                          51100022
LAST     EQU   *                        END OF CODE/CONSTANTS    A47157 51105022
         DC    XL50'00'                           PATCH AREA.    Y02027 51110006
         EJECT                                                          51800020
*                                                                     * 51900020
*                   D  S  E  C  T  S                                  * 52000020
*                                                                     * 52100020
         IHAPSA                                                  Y02027 52200006
          IHAASCB                                              @ZA01439 52230061
          EJECT                                                         52260061
         DCBD  DSORG=PS                 DATA CONTROL BLOCK              52300020
DCBPECB  EQU   DCBIOBAD                                          Y02027 52330006
         TPECBD                                                  Y02027 52360006
         TAVTD                          ADDRESS VECTOR TABLE            52400020
         TTCBD                          TASK CONTROL BLOCK              52600020
FORCORE  DSECT                                                          52700020
         IECDSECT                                                       52800020
         TDEBAPD                                                        53200020
         TPEWAD                                                         53500020
         TRECBD                                                         53700020
*****************************************************************Y02027 53703006
*****    RCB EXTENSION FOR TCAM APPLICATION OPEN/CLOSE.          Y02027 53706006
*****************************************************************Y02027 53709006
RCBPECB  DS    F                        APPLIC. PGM PECB ADDR.   Y02027 53712006
RCBASCB  DS    F                        APPLIC. PGM ASCB ADDR.   Y02027 53715006
RCBERRET DS    0F                       ERROR RTN ADDR           Y02027 53716006
RCBASID  DS    F                        APPLIC. PGM ASID ADDR.   Y02027 53718006
RCBTCB   DS    F                        APPLIC. PGM TCB ADDR.    Y02027 53721006
RCBDCBMA DS    H                        DCBMACRF FROM APPLIC.    Y02027 53724006
RCBTCBFL DS    0X                       APPLIC. TCB FLAGS.       Y02027 53727006
RCBDCBDS DS    H                        DCBDSORG FROM APPLIC.    Y02027 53730006
RCBDSNM  DS    CL8                      PROCESS QUEUE NAME.      Y02027 53733006
RCBDEBAD DS    F                        DEB ADDR FOR APPLIC. DCB.Y02027 53736006
RCBDCBBU DS    H                        DCBBUFL FROM APPLIC.     Y02027 53739006
RCBDCBLR DS    H                        DCBLRECL FROM APPLIC.    Y02027 53742006
RCBDCBOP DS    X                        DCBOPTCD FROM APPLIC.    Y02027 53745006
RCBDCBRF DS    X                        DCBRECFM FROM APPLICATIONY02027 53748006
RCBDCBF1 DS    X                        DCBFLAG1 FROM APPLICATIONY02027 53751006
RCBERR   DS    X                        ERROR INDICATOR          Y02027 53754006
RCBJOBNM DS    CL8                      JOBNAME                  Y02027 53755006
RCBSAVE  DS    18F                      SAVE AREA FOR IEDQEU   @ZA02601 53756061
RCBEND   DS    0X                       END OF DSECT.            Y02027 53757006
         ORG   RCBTCB                                                   53760006
RCBDEBTA DS    H                        OFFSET IN T.T. FOR ENTRY.Y02027 53763006
RCBOPECB DS    0AL3                     OPCTL ECB ADDRESS        Y02027 53766006
RCBDEBPW DS    AL3                      ADDR. OF PEWA.           Y02027 53769006
RCBDEBPC DS    AL3                      ADDR. OF PCB.            Y02027 53772006
         DS    2F                       QNAME                    Y02027 53775006
RCBSQ    DS    0X                       SECURE QUEUE FLAG        Y02027 53776006
RCBAVTBT DS    X                        AVTBIT1 ON RETURN FROM EUY02027 53777006
RCBPEBAD DS    AL3                      ADDR OF PEB IN CSA.      Y02027 53778006
RCBSIZE  EQU   RCBEND-RECBKEY           SIZE OF DSECT.           Y02027 53784006
         TPRIOR                                                         53800020
         IHARB                                                   Y02027 53820006
         TPEBD                                                   Y02027 53850006
         TTCXD                                                   Y02027 53860006
CVT      DSECT                                                   Y02027 53870006
         CVT                                                     Y02027 53880006
         EJECT                                                 @ZA02601 53886061
         TAIBD                                                 @ZA02601 53892061
         END                                                            53900020
