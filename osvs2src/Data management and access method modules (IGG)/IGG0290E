   TITLE 'IGG0290E - DADSM SCRATCH - LOCATE VOLUME TO BE PROCESSED'     00100002
IGG0290E CSECT                                                     DM0Q 00270018
*          RELEASE 16 DELETIONS                                         00340000
*1665                                                              AAAA 00370016
*          RELEASE 17 DELETIONS                                         00410000
*          RELEASE 18 DELETIONS                                         00480000
*0762284000-286000,322000,406000-418000                           8M603 00482018
*    002700,204000-206000,286000,356000,396000,400000,669000-670000DM0Q 00485018
*0762670000                                                       21488 00490018
*0762                                                             21421 00510018
*0762228000                                                       25512 00530018
*          RELEASE 19 DELETIONS                                         00550000
*2175                                                            A27090 00555019
*2175002000,267200-279200,288000-306000,324000-346000,384000-    S19028 00560019
*2175524000,530000-534000,540000-644000,652000,710000-718000,    S19028 00570019
*2175726000,870000                                               S19028 00580019
*2175276500,324000                                               M4900  00600019
*2175                                                            A28896 00605019
* 276300                                                          M3041 00610019
*2175                                                            A29244 00615019
*          RELEASE 20 DELETIONS                                         00620000
*0792232000,242000                                               S20201 00650020
*          RELEASE 21 DELETIONS                                         00690000
*1198148000,277700-278600,294000                                 A41439 00700021
*1198014000-046000,082000-098000,128000-144000,148000,158000,    A38841 00710021
*1198271400-271700,711000,726000,846000-852000                   A38841 00730021
*          RELEASE 21.7 DELETIONS                                       00760002
*0000007600-009000,532000,712000-725200,802000-814000           SA56400 00810002
*          VS2 RELEASE 02 DELETIONS/CHANGES                             00830002
*0000000100-000500,010000,050000,058000-072000,090000-095000,    Y02080 00830102
*0000136000-138000,148000-150000,186000,212000-214000,220000-    Y02080 00830202
*0000221000,271130-271160,271500-275000,278900,280000-282000,    Y02080 00830302
*0000294000-324000,350000-354900,355500-356500,360000,364000,    Y02080 00830402
*0000526000,526400,528000-538000,710000,712000,725800-838000,    Y02080 00830502
*0000842000-854000,860000-866000,869000                          Y02080 00830602
*0000                                                            Y02078 00830702
*0000014000-034000,052000-136600,148000-150000,154000-156000,    Y02082 00830802
*0000172000,176000,182000,197000,219800-221000,229200-230000,    Y02082 00830902
*0000246000-248000,266900-268400,275600,276400-276800,278100-    Y02082 00831002
*0000528000,656000-708000,712000-712500,725800-870000            Y02082 00831102
*0000                                                            Y02134 00831202
*0000                                                            Y02144 00831302
*0000266600,267690,275300,282200,302000,303200,328700            YM1337 00831402
*0000062000,294200-294500,712000-713000                          YM3997 00831502
*0000267660,275600                                               YM1063 00831602
*0000292700-293600                                               YM5371 00832002
*0000268260,350300                                               YM7036 00834002
*0000275600-275650                                               YM7377 00836002
*0000268460                                                      YM7515 00837002
*0000294600-294800                                               YM6546 00842002
*          VS2 RELEASE 03 DELETIONS/CHANGES                             00852002
*0000                                                           ZA00119 00854002
*0000269000                                                    @ZA01347 00855003
*                                                                       00860002
*          VS2 RELEASE 04 DELETIONS/CHANGES                             00860203
*0000269300-269600                                              ZA05225 00860403
*                                                                       00861002
*MODULE NAME - IGG0290E                                                 00862002
*                                                                       00863002
*DESCRIPTIVE NAME - DADSM SCRATCH - LOCATE VOLUME TO BE PROCESSED       00864002
*                                                                       00865002
*COPYRIGHT - NONE                                                       00866002
*                                                                       00867002
*CHANGE ACTIVITY - SEE DELETIONS/CHANGES FOLLOWING CSECT CARD           00868002
*                                                                       00869002
*STATUS CHANGE LEVEL 005                                                00950021
*                                                                       01000002
*ATTRIBUTES - REENTRANT                                                 01200002
*                                                                       01300002
*FUNCTION - AFTER BUILDING THE DEB/DCB AND THE IOB, THIS MODULE         01400002
*          SEARCHES THE TIOT TO SEE IF THE CURRENT VOLUME IN THE        01500002
*          VOLUME LIST IS MOUNTED ON A UNIT ALLOCATED TO THE JOB.       01600002
*          IF THE VOLUME IS NOT MOUNTED ON AN ALLOCATED UNIT, IT        01700002
*          SEARCHES THE UCB LOOKUP TABLE TO DETERMINE IF THE VOLUME     01800002
*          IS MOUNTED ANYWHERE.  IF IT IS MOUNTED, DYNAMIC ALLOCATION   01900002
*          IS CALLED TO TRY TO ALLOCATE THE UNIT.  IF THE VOLUME IS     02000002
*          NOT MOUNTED ANYWHERE OR IF THE UNIT CANNOT BE DYNAMICALLY    02100002
*          ALLOCATED, AND THERE IS A PRIMARY UCB, CONTROL IS GIVEN TO   02200002
*          THE SCRATCH/RENAME DEMOUNT/MOUNT/VERIFY ROUTINE TO MOUNT     02300002
*          THE VOLUME.  IF THERE IS NO PRIMARY UCB OR IF THE VOLUME     02400002
*          CANNOT BE MOUNTED, THE NEXT VOLUME IN THE VOLUME LIST IS     02500002
*          PROCESSED.  IF THE VOLUME WAS FOUND TO BE MOUNTED ON AN      02600002
*          ALLOCATED UNIT, BUT THE UNIT IS NOT READY AND THE    ZA00119 02750002
*          MOUNT BIT IS ON, THE VOLUME CAN NOT BE MOUNTED.      ZA00119 02770002
*          IF THE VOLUME WAS FOUND TO BE MOUNTED ON AN ALLOCATEDZA00119 02772002
*          UNIT AFTER THE UNIT CONTAINING THE VOLUME IS         ZA00119 02780002
*          DYNAMICALLY ALLOCATED, OR AFTER THE VOLUME IS MOUNTED ON     02800002
*          THE PRIMARY UCB, THIS MODULE INITIALIZES FOR RPS PROCESSING  02900002
*          IF THE DEVICE HAS THE RPS FEATURE.  IT THEN ENQ'S ON THE     03000002
*          VTOC BEFORE GIVING CONTROL TO THE NEXT LOAD OF SCRATCH.      03100002
*          IF ALL THE VOLUME LIST ENTRIES HAVE BEEN PROCESSED, CONTROL  03200002
*          IS GIVEN TO THE LAST LOAD OF SCRATCH.                        03300002
*                                                                       03600021
*ENTRIES - THE ONLY ENTRY POINT IS IGG0290E. ENTRY IS MADE FROM         03800021
*          IGC0002I, IGG0290F, OR IGG0290D.                             04000021
*                                                                       04800013
*SUPERVISOR CALLS AND EXTERNAL ROUTINES -                               05000002
*          RESERVE  - ENQ'S ON THE VTOC (SVC 56)                        05200002
*          DYNALLOC - DYNAMICALLY ALLOCATES THE UNIT (SVC 99)           05400002
*          MODESET  - SWITCHES TO THE CALLER'S KEY                      05600002
*          IECRES   - BRANCHES TO OTHER SCRATCH MODULES                 05800002
*          IECRPS   - USES IECRES TO OBTAIN THE RPS WORK AREA           06000002
*                   - LOCATES THE RPS SIO APPENDAGE IGG019EK            06200002
*                                                                       06400002
*OTHER MACROS ISSUED -                                                  06600002
*          IECDSECS - EXPANDS THE CVT, DSAB, QDB, RB, RRPL, TCB,        06800002
*                     TIOT, AND UCB DSECTS                              07000002
*          IECSCRWA - EXPANDS THE SCRATCH WORK AREA                     07200002
*          IEFZB4D0 - EXPANDS THE DYNAMIC ALLOCATION REQUEST BLOCK      07400002
*          IEFZB4D2 - EXPANDS THE DYNAMIC ALLOCATION TEST UNIT KEYS     07600002
*          XCTLTABL - BUILDS A LIST OF MODULE ID'S AND ADDRESSES        07800002
*                                                                       08000002
*INPUT -   AT ENTRY TO THIS MODULE REGISTER 9 POINTS TO THE CVT.        08200002
*          REGISTER 10 POINTS TO THE PARAMETER LIST.  REGISTER 13       08400002
*          POINTS TO THE WORK AREA, IN WHICH 'VOLNUM' CONTAINS THE      08600002
*          NUMBER OF VOLUMES REMAINING TO BE SCRATCHED, AND 'VOLPTR'    08800002
*          CONTAINS THE ADDRESS OF THE CURRENT ENTRY IN THE VOLUME      09000002
*          LIST.                                                        09200002
*          IF REENTRY FROM IGG0290F, REGISTER 14 CONTAINS ONE OF        09400002
*          THE FOLLOWING RETURN CODES:                                  09600002
*          00 - VOLUME WAS SUCCESSFULLY MOUNTED AND/OR VERIFIED         09800002
*          04 - VOLUME COUND NOT BE DEMOUNTED                           10000002
*          08 - VOLUME COULD NOT BE MOUNTED                             10200002
*          0C - I/O ERROR OCCURRED WHEN READING THE VOLUME LABEL        10400002
*          ALSO, REGISTER 5 CONTAINS THE NUMBER OF VOLUMES REMAINING    10600002
*          TO BE SCRATCHED, AND REGISTER 8 POINTS TO THE CURRENT ENTRY  10800002
*          IN THE VOLUME LIST.                                          11000002
*                                                                       11200002
*OUTPUT - REGISTER 8 POINTS TO THE CURRENT ENTRY IN THE VOLUME LIST.    11400002
*         REGISTER 9 POINTS TO THE CVT, AND REGISTER 10 POINTS TO       11600002
*         THE PARAMETER LIST.  REGISTER 13 POINTS TO THE WORK AREA,     11800002
*         IN WHICH THE DEB CONTAINS THE UCB ADDRESS OF THE VOLUME       12000002
*         WHOSE DATA SET IS TO BE SCRATCHED.                            12200002
*         THE FOLLOWING ADDITIONAL INFORMATION IS PASSED TO IGG0290F:   12400002
*         REGISTER 2 POINTS TO THE DEB.                                 12600002
*         REGISTER 3 POINTS TO THE VOLUME SERIAL NUMBER.                12800002
*         REGISTER 4 CONTAINS THE CHARACTERS '290E'.                    13000002
*         REGISTER 11 CONTAINS THE PRIMARY (DEMOUNTABLE) UCB ADDRESS.   13200002
*                                                                       14600013
*STORAGE - PROGRAM CODE CSECT = LESS THAN 2048 BYTES                    14800002
*          WORK AREA = 896 BYTES                                        15000002
*          RPS WORK AREA = 128 BYTES                                    15100002
*                                                                       15200013
*ERROR CONDITIONS - NO DEVICE AVAILABLE FOR MOUNTING THE VOLUME         15400002
*                                                                       16000013
*REGISTER USAGE:                                                        16200013
R0       EQU   0                                                        16400013
R1       EQU   1                                                        16600013
RPARM    EQU   2                        PTR TO SVC 99 PARM LIST  Y02082 16700002
R2       EQU   2                                                        16800013
RDSAB    EQU   2                        POINTER TO DSAB          Y02082 16900002
R3       EQU   3                                                        17000013
RWRK     EQU   3                        WORK REGISTER            Y02082 17100002
RTIOT    EQU   3                        POINTER TO TIOT          Y02082 17200002
RTEXT    EQU   4                        POINTER TO TEXT UNIT     Y02082 17300002
R4       EQU   4                                                        17400013
REND     EQU   4                        POINTER TO END OF ENTRY  Y02082 17600002
R5       EQU   5                                                        17800013
VOLCTR   EQU   5                                                        18000013
R6       EQU   6                        WORK REGISTER            Y02082 18200002
R7       EQU   7                                                 S19028 18300019
VOLISTX  EQU   8                                                        18400013
RCVT     EQU   9                                                        18800013
PL       EQU   10                                                       19000013
RUCB     EQU   11                                                       19200013
RBASE    EQU   12                                                       19400013
RWKAREA  EQU   13                                                       19600013
RETURN   EQU   14                                                       19800013
RTNCODE  EQU   15                       RETURN CODE REGISTER     Y02082 19900002
WORKREG  EQU   15                                                       20000013
*                                                                       20100002
         BALR  RBASE,R0                                                 20800013
         USING BLDBLKS,RBASE                                            21000013
         USING SCRTHWKA,RWKAREA         WORK AREA ADDRESSABILITY Y02080 21400002
         USING UCB,RUCB                                                 21600013
         USING CVT,RCVT                                                 21800013
*                                                                       21850021
*** OTHER EQUATES                                                       21900021
*                                                                       21950021
K3       EQU   3                        CONSTANT OF 3           SA56400 21960002
K4       EQU   4                        CONSTANT OF 4            Y02080 21970002
K0       EQU   0                        CONSTANT OF 0            Y02082 21972002
K1       EQU   1                        CONSTANT OF 1            Y02082 21974002
K2       EQU   2                        CONSTANT OF 2            Y02082 21976002
K6       EQU   6                        CONSTANT OF 6            Y02082 21978002
K7       EQU   7                        CONSTANT OF 7            Y02082 21980002
K8       EQU   8                        CONSTANT OF 8            Y02082 21982002
K12      EQU   12                       CONSTANT OF 12           Y02082 21984002
FW4      EQU   16                       LENGTH OF 4 FW'S         Y02082 21988002
STATEXTL EQU   8                        STATUS TEXT UNIT LENGTH  Y02082 21990002
UNITEXTL EQU   10                       UNIT TEXT UNIT LENGTH    Y02082 21992002
VOLTEXTL EQU   12                       VOLSER TEXT UNIT LENGTH  Y02082 21994002
RTNCODE4 EQU   4                        ERROR RETURN CODE OF 4   Y02082 21996002
RTNCODE8 EQU   8                        ERROR RETURN CODE OF 8   Y02082 21998002
SIODISP  EQU   4                        DISP: TO SIO APPENDAGE   Y02082 22000002
AVTDISP  EQU   28                       DISP: TO AVT IN DEB      Y02082 22002002
RPSIDLOC EQU   62                       RPS ID DISPLACEMENT      Y02082 22004002
VOLSER   EQU   4                        OFFSET TO VOLSER IN A    Y02082 22006002
*                                       VOLUME LIST ENTRY        Y02082 22008002
STATUS   EQU   11                       OFFSET TO STATUS BYTE    Y02082 22010002
ENTRYL   EQU   12                       VOL LIST ENTRY LENGTH    Y02082 22012002
UCBADDR  EQU   32                       DISP. TO UCB ADDR IN DEB Y02082 22014002
DEVMOD   EQU   X'C0'                    DEB DEVICE MODIFIER      Y02082 22016002
IOERR    EQU   X'04'                    I/O ERROR IN VOL LIST    Y02082 22018002
NODEVERR EQU   X'05'                    NO DEVICE ERROR          Y02082 22020002
NOMNTERR EQU   X'06'                    VOLUME NOT MOUNTED ERROR Y02082 22022002
STATOLD  EQU   X'01'                    DISP=OLD INDICATOR       Y02082 22024002
DYNUNALL EQU   X'80'                    DO NOT ISSUE SVC 99 BIT  YM1063 22026002
*                                                                       22200013
*** BUILD CONTROL BLOCKS                                                22400013
*                                                                       22600013
BLDBLKS  EQU   *                                                  25512 22680018
         TM    SISW2,DEMNTSW+MOUNTSW+VERIFYSW  TEST IF RETURN    Y02134 22690002
*                                       FROM DEMOUNT, MOUNT,     Y02134 22700002
*                                       AND/OR VERIFY FUNCTION   Y02134 22710002
         BNZ   RETURNPT                 BRANCH IF YES            Y02134 22720002
         XC    HOLENUM,HOLENUM          INITIALIZE HOLE COUNT FOR 25512 22760018
*                                       OTHER THAN 1ST VOLUME           22840018
         LA    R1,WKADEB                BUILD THE WORK AREA DEB  Y02082 22920002
         MVI   16(R1),X'01'                  NUM OF EXTS = 1            23400013
         LA    R2,DCB                                                   23600013
         ST    R2,24(R1)                     INSERT DCB ADDR            23800013
         MVI   24(R1),X'0F'                  INSERT DEB ID              24000013
         MVI   28(R1),X'04'                  INSERT EXT SCALE           24400013
         MVC   42(6,R1),EXTCONST             INSERT EXTS AND TK COUNT   25000013
         ST    R1,DEBPTR                BUILD DCB                       25200013
         LA    WORKREG,ECB              BUILD IOB                       25400013
         ST    WORKREG,IOB+4                 INSERT ECB ADDR            25600013
         LA    RETURN,CCW1              GET CCW POINTER FOR IOB.        25800013
         LA    WORKREG,DCB                                              26000013
         STM   RETURN,WORKREG,IOB+16    STORE DCB AND CCW PTR INTO IOB. 26200013
         OI    IOB,X'02'               SET UNRELATED BIT IN IOB  A29244 26300019
NEXTVOL  EQU   *                        NEXT VOLUME              Y02134 26350002
         LH    VOLCTR,VOLNUM            LOAD NUMBER OF VOLUMES LEFT     26400013
         L     VOLISTX,VOLPTR           LOAD VOLUME LIST INDEX          26600013
         L     R1,TCBADDR               LOAD TCB ADDRESS         Y02078 26605002
         USING TCB,R1                   TCB ADDRESSABILITY       Y02078 26610002
         MODESET EXTKEY=RBT234,WORKREG=2  SWITCH TO CALLER'S KEY Y02078 26615002
         MVI   11(VOLISTX),X'00'        CLEAR THIS VOL'S RET     A27090 26620019
*                                       CODE                     A27090 26640019
         MODESET EXTKEY=ZERO            RETURN TO KEY ZERO       Y02082 26645002
         DROP  R1                                                Y02078 26650002
         MVC   PVOLSER,VOLSER(VOLISTX)  SAVE VOLSER IN WRK AREA  YM1337 26655002
         OC    PVOLSER,PVOLSER          TEST FOR VALID VOLSER    YM1337 26660002
         BZ    NODEVICE                 NO UNIT IF ZERO          Y02082 26670002
*                                                                       26673002
* THE FOLLOWING SECTIONS TRY TO FIND THE UCB ADDRESS OF THE CURRENT     26676002
* VOLUME IN THE VOLUME LIST. FIRST, IT SEARCHES THE TIOT TO SEE IF      26679002
* THE VOLUME IS MOUNTED ON A UNIT ALLOCATED TO THE JOB. IF NOT, IT      26682002
* SEARCHES THE UCB LOOKUP TABLE TO DETERMINE IF THE VOLUME IS MOUNTED   26685002
* ANYWHERE. IF IT IS MOUNTED, DYNAMIC ALLOCATION IS CALLED TO TRY TO    26688002
* ALLOCATE THE UNIT. IF THE VOLUME IS NOT MOUNTED ANYWHERE OR IF IT     26691002
* CANNOT BE DYNAMICALLY ALLOCATED, THE VOLUME WILL BE MOUNTED ON THE    26694002
* PRIMARY UCB, IF ONE EXITS.                                            26697002
*                                                                       26700002
FINDUCB  EQU   *                        FIND UCB                 Y02082 26703002
         L     RDSAB,DSABQDB            LOAD DSAB QDB ADDRESS    Y02082 26706002
         USING QDB,RDSAB                QDB ADDRESSABILITY       Y02082 26709002
         L     RDSAB,QDBFELMP           GET FIRST DSAB ADDRESS   Y02082 26712002
         USING DSAB,RDSAB               DSAB ADDRESSABILITY      Y02082 26715002
DSABTEST EQU   *                        IS THERE ANOTHER DSAB    Y02082 26718002
         LTR   RDSAB,RDSAB              IS THERE ANOTHER DSAB    Y02082 26721002
         BZ    TABLSRCH                 BRANCH IF NOT            Y02082 26724002
         L     RTIOT,DSABTIOT           GET TIOT POINTER         Y02082 26727002
         USING TIOENTRY,RTIOT           TIOT ADDRESSABILITY      Y02082 26730002
         SR    REND,REND                ZERO REGISTER FOR IC     Y02082 26733002
         IC    REND,TIOELNGH            LENGTH OF TIOT ENTRY     Y02082 26736002
         AR    REND,RTIOT               ADDRESS OF FIRST BYTE    Y02082 26739002
*                                       PAST THE TIOT ENTRY      Y02082 26742002
         LA    RTIOT,TIOEFSRT-K1        ADDR OF FIRST UCB ADDR   Y02082 26745002
UCBTEST  EQU   *                        TEST IF AT END           Y02082 26748002
         CR    RTIOT,REND               TEST IF AT END OF ENTRY  Y02082 26751002
         BNL   NEXTDSAB                 BRANCH IF YES            Y02082 26754002
         L     RUCB,K0(,RTIOT)          GET UCB ADDRESS          Y02082 26757002
         LA    RUCB,K0(RUCB)            CLEAR HIGH BYTE          Y02082 26760002
         LTR   RUCB,RUCB                IS THERE A UCB ADDRESS   Y02082 26763002
         BZ    NXTENTRY                 BRANCH IF NOT            YM1063 26766002
         CLC   SRTEVOLI,PVOLSER         COMPARE VOL SER NUMBERS  YM1337 26769002
         BNE   NXTENTRY                 BRANCH IF NOT EQUAL      Y02082 26772002
         CLC   UCBTBYT3(K2),K2(VOLISTX)  COMPARE DEVICE TYPES    Y02082 26775002
         BNE   NXTENTRY                 BRANCH IF NOT EQUAL      Y02082 26778002
         TM    UCBTBYT3,UCB3DACC        TEST IF DIRECT ACCESS    Y02082 26781002
         BZ    NXTENTRY                 BRANCH IF NOT            Y02082 26784002
         TM    SRTESTAT,SRTEONLI        TEST IF ONLINE           Y02082 26787002
         BO    FOUNDUCB                 BRANCH IF ONLINE         Y02082 26790002
NXTENTRY EQU   *                        NEXT UCB ADDRESS IN TIOT Y02082 26793002
         LA    RTIOT,L'TIOESTTB+L'TIOEFSRT(,RTIOT)  INCREMENT TO Y02082 26796002
*                                       NEXT UCB ADDRESS IN TIOT Y02082 26799002
         B     UCBTEST                  GO TEST NEXT UCB ADDRESS Y02082 26802002
NEXTDSAB EQU   *                        NEXT DSAB                Y02082 26805002
         L     RDSAB,DSABFCHN           GET NEXT DSAB ADDRESS    Y02082 26808002
         B     DSABTEST                 GO TEST IT               Y02082 26811002
FOUNDUCB EQU   *                        FOUND IT                 Y02082 26814002
         ST    RDSAB,DSABADDR           SAVE DSAB ADDRESS        Y02082 26817002
         ST    RUCB,WKADEB+UCBADDR      SAVE UCB ADDRESS IN DEB  Y02082 26820002
         MVI   WKADEB+UCBADDR,DEVMOD    INSERT DEVICE MODIFIER   Y02082 26823002
         L     RETURN,DSABTIOT          LOAD TIOT ENTRY ADDRESS  YM7036 26823402
         LA    RETURN,TIOEJFCB-TIOENTRY(,RETURN)  POINT TO JFCB  YM7036X26823502
                                        PREFIX ADDRESS           YM7036 26824002
         IECRES LOCJFCB,(RETURN)        LOCATE THE JFCB          YM7036 26824502
         CLC   PDSNAME,JFCBDSNM-INFMJFCB(RETURN)  CHECK IF       YM7036X26825002
                                        THIS IS THE RIGHT TIOT   YM7036X26825502
                                        ENTRY FOR THIS DSNAME    YM7036 26826002
         BE    MOUNTED                  BRANCH IF CORRECT        YM7036 26826502
         OI    SISW2,UCBFNDSW           SET THE UCB FOUND SWITCH YM7036 26827002
         B     NXTENTRY                 GO TRY NEXT TIOT ENTRY   YM7036 26827502
*                                                                Y02082 26829002
* THIS SECTION SEARCHES THE UCB LOOKUP TABLE TO DETERMINE IF THE Y02082 26832002
* VOLUME IS MOUNTED ANYWHERE.                                    Y02082 26838002
*                                                                Y02082 26841002
TABLSRCH EQU   *                        UCB TABLE SEARCH         Y02082 26844002
         TM    SISW2,UCBFNDSW           TEST IF A UCB WAS FOUND  YM7036 26845002
         BNO   LDLOOKUP                 BRANCH IF NOT            YM7515 26845402
         L     RUCB,WKADEB+UCBADDR      LOAD FOUND UCB ADDRESS   YM7515 26845802
         LA    RUCB,K0(RUCB)            CLEAR HIGH BYTE          YM7515 26846202
         B     MOUNTED                  GO TEST IF VERIFIED      YM7515 26846602
LDLOOKUP EQU   *                        LOAD UCB LOOKUP TABL ADR YM7515 26846802
         L     R2,CVTILK2               UCB LOOKUP TABLE ADDRESS Y02082 26847002
UCBLOOP  EQU   *                                                 S19028 26870019
         SR    RUCB,RUCB                CLEAR REG              @ZA01347 26880003
         ICM   RUCB,K3,K0(R2)           GET UCB ADDR           @ZA01347 26890003
         CLM   RUCB,K3,EXTCONST         IS THIS THE END OF     @ZA05225 26930003
*                                       TABLE.                 @ZA05225 26960003
         BE    ENDADDR                                           S19028 26990019
         LTR   RUCB,RUCB                UCB TABLE MAY HAVE HOLES S19028 27020019
         BZ    NEXTADDR                                          S19028 27050019
         TM    UCBTBYT3,UCB3DACC        TEST FOR DIRECT ACCESS   S19028 27080019
         BZ    NEXTADDR                                          S19028 27110019
         TM    SRTESTAT,SRTEONLI        TEST FOR ONLINE DEVICE   A28896 27120019
         BZ    NEXTADDR                 BRANCH IF NOT ONLINE     A28896 27130019
         CLC   SRTEVOLI,PVOLSER         COMPARE VOL SER NUMBERS  YM1337 27530002
         BNE   NEXTADDR                 BRANCH IF NOT EQUAL      Y02082 27540002
         CLC   UCBTBYT3(K2),K2(VOLISTX)  COMPARE DEVICE TYPES    Y02082 27550002
         BNE   NEXTADDR                 BRANCH IF NOT EQUAL      YM1063 27555002
         TM    UCBSTAB,UCBBSVL          TEST IF NONSHAREABLE     YM7377 27560002
         BZ    ALLOCVOL                 BRANCH IF SHAREABLE TO   YM7377X27565002
                                        TRY TO ALLOCATE THE UNIT YM1063 27570002
         B     ENDADDR                  DON'T TRY TO DYNAMICALLY YM1063 27575002
*                                       ALLOCATE IF NONSHAREABLE YM1063 27580002
NEXTADDR LA    R2,2(R2)            TRY NEXT ADDR IN UCB TABLE    S19028 27590019
         B     UCBLOOP                                           S19028 27620019
*                                                                       27700002
ENDADDR  L     RUCB,PRUCBPTR            LOAD UCB POINTER         S19028 27710019
         LTR   RUCB,RUCB                TEST FOR PRIMARY UCB     S19028 27740019
         BZ    NODEVICE                 BRANCH IF NO PRIMARY UCB Y02082 27770002
         CLC   UCBTBYT3(K2),K2(VOLISTX)  COMPARE DEVICE TYPES    Y02082 27800002
         BNE   NODEVICE                 BRANCH IF NOT EQUAL      Y02082 27830002
*                                                                Y02082 27860002
* THIS SECTION PREPARES TO BRANCH TO IGG0290F TO DEMOUNT (IF REQUIRED)  27890002
* AND MOUNT AND/OR VERIFY THE NEXT VOLUME.                              27920002
*                                                                       27950002
MOUNTVOL EQU   *                        MOUNT VOLUME             Y02134 27980002
         ST    RUCB,WKADEB+UCBADDR      MODIFY UCB ADDR IN DEB   Y02134 28010002
         MVI   WKADEB+UCBADDR,DEVMOD    INSERT DEVICE MODIFIER   Y02134 28040002
         OI    SISW2,DEMNTSW+MOUNTSW    SET DEMOUNT & MOUNT SW   Y02134 28070002
         MVC   DSABADDR,PRDSABAD        INITIALIZE DSAB ADDRESS  Y02134 28100002
VERIFY   EQU   *                        SET ADDRESSES            Y02134 28130002
         LA    R2,WKADEB                DEB ADDR IN REGISTER 2   Y02134 28190002
         LA    R3,PVOLSER               VOLSER ADDR IN REG 3     YM1337 28220002
         L     R4,RETNAME               RETURN NAME IN REG 4     Y02134 28280002
         LA    R7,MNTLOAD               POINT TO ID OF IGG0290F  Y02134 28310002
         B     LOADEXIT                 GO BRANCH TO IGG0290F    Y02134 28340002
*                                                                Y02134 28370002
* THIS SECTION TESTS THE RETURN CODE FROM THE DEMOUNT/MOUNT ROUTINE.    28400002
*                                                                       28430002
RETURNPT EQU   *                        TEST RETURN CODE         Y02134 28460002
         NI    SISW2,X'FF'-DEMNTSW-MOUNTSW-VERIFYSW  RESET SW    Y02134 28490002
         B     TESTERR(RETURN)          RETURN CODE BRANCH TABLE Y02134 28520002
TESTERR  EQU   *                        VOLUME MOUNTED/VERIFIED  Y02134 28550002
         B     MOUNTED                  VOLUME MOUNTED/VERIFIED  Y02134 28580002
         B     NODEVICE                 UNSUCCESSFUL DEMOUNT     Y02134 28610002
         B     NOMOUNT                  MOUNT/VERIFY FAILED      Y02134 28640002
         B     PERMERR                  I/O ERROR OCCURRED       Y02134 28670002
*                                                                       28700002
* THIS SECTION INITIALIZES FOR RPS PROCESSING IF THE DEVICE HAS THE     28730002
* RPS FEATURE.                                                          28760002
*                                                                       28790002
MOUNTED  EQU   *                        TEST MOUNT BIT           Y02134 28820002
         NI    SISW2,X'FF'-UCBFNDSW     TURN OFF UCB FOUND SWTCH YM7036 28830002
         TM    UCBDMCT,UCBMOUNT         TEST MOUNT BIT           Y02134 28850002
         BNO   VERIFIED                 BRANCH IF VERIFIED       Y02134 28880002
         TM    UCBFL1,UCBNOTRD          IS UNIT NOT-READY       ZA00119 28882002
         BO    NODEVICE                 BRANCH IF NOT-READY     ZA00119 28884002
         OI    SISW2,VERIFYSW           SET VERIFY SWITCH        Y02134 28890002
         B     VERIFY                   GO VERIFY THE VOLUME     Y02134 28900002
VERIFIED EQU   *                        VERIFIED                 Y02134 28910002
         NI    STYPEFLG,X'FF'-NOMNTDEV  RESET THE 'NO DEVICE FOR Y02082 28940002
*                                       MOUNTING' SWITCH AS AT   Y02082 28970002
*                                       LEAST ONE VOL IS MOUNTED Y02082 29000002
         BCT   VOLCTR,MOREVOLS          TEST FOR LAST VOLUME     Y02134 29030002
         OI    STYPEFLG,EXITBIT         SET EXIT BIT IF LAST VOL Y02134 29060002
MOREVOLS EQU   *                        MOER VOLS TO PROCESS     Y02134 29090002
         LA    R1,ENTRYL(VOLISTX)       NEXT VOL LIST ENTRY ADDR Y02134 29120002
         ST    R1,VOLPTR                SAVE NEXT ENTRY ADDRESS  Y02134 29150002
         STH   VOLCTR,VOLNUM            SAVE UPDATED VOL COUNT   Y02134 29180002
         TM    UCBTBYT2,UCB2OPT3        TEST FOR RPS DEVICE      Y02134 29210002
         BZ    LOADTTR0                 BRANCH IF NOT            Y02134 29240002
         TM    DSMADTB1,DSMRPSAP        TEST IF IGG019EK LOADED  YM5371 29300002
         BO    LOADTTR0                 BRANCH IF YES            YM5371 29360002
         LA    R3,WKADEB                POINTER TO DEB           Y02134 29390002
         IECRPS RDEB=R3,WKREG1=R4,EXTPR=RWKAREA  INITIALIZE      YM3997X29420002
                                        FOR RPS PROCESSING       YM3997 29450002
         MVC   WTGMODNM,THISLOAD        RESTORE MODULE NAME      YM5371 29490002
*                                                                       29500002
* THIS SECTION INITIALIZES THE CCHHR'S OF THE FORMAT 4 AND 5 DSCB'S.    29510002
*                                                                       29540002
LOADTTR0 EQU   *                        INITIALIZE THE CCHHR'S   Y02134 29570002
         L     R0,SRTEFSCT              LOAD TTR0 OF F4 FROM UCB Y02134 29600002
         LA    R1,WKADEB                POINTER TO DEB           Y02134 29630002
         LA    R2,SEEK                  MBBCCHHR ADDRESS         Y02134 29660002
         LR    R3,RWKAREA               SAVE WORK AREA ADDRESS   Y02134 29690002
         STM   RCVT,RETURN,IECREGSV+K12 SAVE REGISTERS 9-14      Y02134 29720002
         L     WORKREG,CVTPCNVT         ADDRESS OF CONVERT RTN   Y02134 29750002
         BALR  RETURN,WORKREG           LINK TO CONVERT ROUTINE  Y02134 29780002
         LM    RCVT,RETURN,IECREGSV+K12-SCRTHWKA(R3)  RESTORE    Y02134 29810002
         MVC   VTOCADR,SEEK+K3          SET UP FORMAT 4 CCHHR    Y02134 29840002
         MVC   INCCHHR,VTOCADR          SET UP SEARCH ID CCHHR   Y02134 29870002
         MVC   DADSMADR,VTOCADR         SET UP FORMAT 5 CCHHR    Y02134 29900002
         SR    WORKREG,WORKREG          ZERO REGISTER            Y02134 29930002
         IC    WORKREG,DADSMADR+K4      LOAD F4 RECORD NUMBER    Y02134 29960002
         LA    WORKREG,K1(WORKREG)      INCREMENT BY ONE         Y02134 29990002
         STC   WORKREG,DADSMADR+K4      SAVE F5 RECORD NUMBER    Y02134 30020002
*                                                                       30050002
* THIS SECTION ENQ'S ON THE VTOC WITH THE SET-MUST-COMPLETE OPTION.     30080002
*                                                                       30110002
ISSUENQ  EQU   *                        ENQ ON THE VTOC          Y02134 30140002
         MVC   MJNAME(L'VTOCNAME),VTOCNAME  MAJOR RESOURCE NAME  Y02134 30170002
         MVI   ENQAREA,X'FF'            INDICATE LAST ENQ AREA   Y02134 30230002
         SR    R1,R1                    ZERO REGISTER            Y02134 30260002
         STH   R1,ENQAREA+K2            CLEAR FOR RESERVE MACRO  Y02134 30290002
         RESERVE (MJNAME,PVOLSER,E,6,SYSTEMS),SMC=STEP,          YM3022X30320002
               MF=(E,ENQAREA),UCB=WKADEB+32  ENQ ON SYSVTOC      Y02134 30350002
*                                                                       30360002
         OI    STYPEFLG,VTOCENQ         SET VTOC ENQ'ED SWITCH   Y02134 30370002
         OI    DSMADTB2,DSMVTOCR+DSMSMCE  SET VTOC ENQ'ED SMC    Y02144 30380002
         L     R1,IECRRPRM              RECOVERY RTN LIST ADDR   Y02144 30390002
         USING RRPLIST,R1               PARM LIST ADDRESSABILITY Y02144 30400002
         ST    RUCB,RRUCBPTR            SAVE THE UCB ADDRESS     Y02144 30410002
         DROP  R1                                                Y02144 30420002
*                                                                       30430002
         LA    R7,NEXTLOAD              POINT TO ID OF IGG0290A  Y02134 30440002
*                                                                       30460002
* THIS SECTION BRANCHES TO ANOTHER LOAD OF SCRATCH.                     30470002
*                                                                       30500002
LOADEXIT EQU   *                        EXIT TO NEXT LOAD        Y02134 30530002
         IECRES LOAD,EXTPR=(RWKAREA),MODID=(R7),BRANCH=DIRECT    Y02134 30560002
*                                                                       30590002
* THIS SECTION SETS AN APPROPRIATE ERROR CODE IN THE STATUS BYTE        30620002
* OF THE CURRENT VOLUME LIST ENTRY. IF THE LAST VOLUME HAS BEEN         30650002
* PROCESSED, CONTROL IS PASSED TO THE LAST LOAD OF SCRATCH. IF NOT,     30680002
* THE NEXT VOLUME LIST ENTRY IS PROCESSED.                              30710002
*                                                                       30740002
PERMERR  EQU   *                        I/O ERROR                Y02134 30770002
         LA    R3,IOERR                 I/O ERROR                Y02134 30800002
         B     SETCODE                  BRANCH TO SET ERROR CODE Y02134 30830002
NODEVICE EQU   *                        NO UNIT FOR MOUNTING     Y02134 30860002
         LA    R3,NODEVERR              NO UNIT FOR MOUNTING ERR Y02134 30890002
         B     SETCODE                  BRANCH TO SET ERROR CODE Y02134 30920002
NOMOUNT  EQU   *                        VOLUME NOT MOUNTED       Y02134 30950002
         LA    R3,NOMNTERR              VOLUME NOT MOUNTED ERROR Y02134 30980002
SETCODE  EQU   *                        SET CODE                 Y02134 31010002
         L     R1,TCBADDR               LOAD TCB ADDRESS         Y02078 31040002
         USING TCB,R1                   TCB ADDRESSABILITY       Y02078 31070002
         MODESET EXTKEY=RBT234,WORKREG=2  SWITCH TO CALLER'S KEY Y02078 31100002
         DROP  R1                                                Y02078 31130002
         STC   R3,STATUS(VOLISTX)       PUT ERROR CODE IN VOLIST Y02078 31160002
         MODESET EXTKEY=ZERO            RETURN TO KEY ZERO       Y02082 31190002
         BCT   VOLCTR,NOTLAST           TEST IF LAST VOLUME      Y02134 31220002
         OI    STYPEFLG,EXITBIT         SET EXIT BIT IF LAST VOL Y02134 31250002
NOTLAST  EQU   *                        NOT LAST VOL             Y02134 31280002
         LA    R1,ENTRYL(VOLISTX)       NEXT VOL LIST ENTRY ADDR Y02134 31310002
         ST    R1,VOLPTR                SAVE NEXT ENTRY ADDR     Y02134 31340002
         STH   VOLCTR,VOLNUM            SAVE UPDATED VOL COUNT   Y02134 31370002
         LA    RTNCODE,RTNCODE8         NORMAL ERROR RETURN CODE Y02134 31400002
         STH   RTNCODE,ERCODE           SAVE ERROR RETURN CODE   Y02134 31430002
         TM    STYPEFLG,EXITBIT         TEST IF LAST VOLUME      Y02134 31460002
         BZ    NEXTVOL                  BRANCH IF NOT TO PROCESS Y02134 31490002
*                                       THE NEXT VOLUME          Y02134 31520002
         TM    STYPEFLG,NOMNTDEV        TEST IF AN ERROR CODE OF Y02134 31550002
*                                       4 MUST BE RETURNED TO    Y02134 31580002
*                                       CALLER IN REGISTER 15    Y02134 31610002
         BZ    LEAVE                    BRANCH IF NOT            Y02134 31640002
         MVI   ERCODE+K1,RTNCODE4       SET RETURN CODE TO 4     Y02134 31670002
LEAVE    EQU   *                        GO TO IGG0290D           Y02134 31700002
         LA    R7,LASTLOAD              POINT TO ID OF IGG0290D  Y02134 31730002
         B     LOADEXIT                 GO BRANCH TO IGG0290D    Y02134 31760002
*                                                                       31770002
* THIS SECTION BUILDS THE REQUEST BLOCK TO INTERFACE WITH DYNAMIC       31780002
* ALLOCATION (SVC 99) TO TRY TO ALLOCATE THE UNIT ON WHICH THE          31790002
* CURRENT VOLUME IN THE VOLUME LIST IS MOUNTED, UNLESS SCRATCH HAS      31800002
* BEEN CALLED BY DYNAMIC UNALLOCATION OR JOB OR STEP TERMINATION        31810002
* (IF THE CALLER IS IN KEY ZERO AND BIT 0 OF THE SECOND OPTION BYTE     31820002
* IN THE FIRST WORD OF THE PARAMETER LIST IS SET).                      31830002
*                                                                       31840002
ALLOCVOL EQU   *                        TRY TO ALLOCATE THE UNIT Y02082 31850002
         TESTAUTH FCTN=1,KEY=YES,BRANCH=YES  TEST IF CALLER IS   YM1063X31860002
                                        AUTHORIZED OR KEY ZERO   YM1063 31870002
*                                                                YM1063 31880002
         LTR   RTNCODE,RTNCODE          TEST IF EITHER TRUE      YM1063 31890002
         BNZ   BUILDRB                  BRANCH IF NOT            YM1063 31900002
         TM    K1(PL),DYNUNALL          TEST IF ENTERED FROM     YM1063X31910002
                                        DYNAMIC UNALLOCATION OR  YM1063X31920002
                                        JOB OR STEP TERMINATION  YM1063 31930002
         BO    ENDADDR                  BRANCH IF YES            YM1063 31940002
*                                                                YM1063 31950002
BUILDRB  EQU   *                        BUILD THE REQUEST BLOCK  YM1063 31960002
         LA    RPARM,VTOCDSCB           PARAMETER LIST BASE      Y02082 31970002
         USING S99RBP,RPARM                                      Y02082 32000002
         LA    RWRK,K4(,RPARM)          INCREMENT BY FOUR        Y02082 32030002
         ST    RWRK,S99RBPTR            SET UP REQUEST BLOCK PTR Y02082 32060002
         OI    S99RBPTR,S99RBPND        TURN ON HIGH ORDER BIT   Y02082 32090002
         LR    RPARM,RWRK               ADDRESS OF REQUEST BLOCK Y02082 32120002
         USING S99RB,RPARM              REQ BLOCK ADDRESSABILITY Y02082 32150002
         XC    S99RB(S99RBEND-S99RB),S99RB  ZERO REQ BLOCK CORE  Y02082 32180002
         MVI   S99RBLN,S99RBEND-S99RB   LENGTH OF REQUEST BLOCK  Y02082 32210002
         MVI   S99VERB,S99VRBAL         INDICATE ALLOCATION      Y02082 32240002
         LA    RWRK,S99RBEND            ADDR OF TEXT POINTERS    Y02082 32270002
         ST    RWRK,S99TXTPP            PLACE IN REQUEST BLOCK   Y02082 32300002
         OI    S99FLG11,S99NOMNT        INDICATE THAT VOL MUST   Y02082 32330002
*                                       BE MOUNTED IF ALLOCATED  Y02082 32360002
         OI    S99FLG21,S99TIONQ+S99NORES  INDICATE TIOT ENQ'ED  Y02082 32390002
*                                       AND NO D/S RESERVATION   Y02082 32420002
         LR    RPARM,RWRK               ADDRESS OF TEXT POINTERS Y02082 32450002
         USING S99TUPL,RPARM            TEXT PTR ADDRESSABILITY  Y02082 32480002
*                                                                       32510002
* THIS SECTION BUILDS THE VOLSER TEXT UNIT.                             32540002
*                                                                       32570002
         LA    RTEXT,FW4(,RPARM)        BASE FOR TEXT UNIT       Y02082 32600002
         ST    RTEXT,S99TUPTR           PTR TO VOLSER TEXT UNIT  Y02082 32630002
         USING S99TUNIT,RTEXT           TEXT UNIT ADDRESSABILITY Y02082 32660002
         LH    RWRK,VOLSERKY            INDICATE VOLSER TEXT     Y02082 32690002
         STH   RWRK,S99TUKEY                                     Y02082 32720002
         LA    RWRK,K1                  ONE TEXT PARM            Y02082 32750002
         STH   RWRK,S99TUNUM                                     Y02082 32780002
         LA    RWRK,L'SRTEVOLI          LENGTH OF VOLSER         Y02082 32810002
         STH   RWRK,S99TULNG                                     Y02082 32840002
         MVC   S99TUPAR(L'SRTEVOLI),PVOLSER  GET VOLSER          YM1337 32870002
*                                                                       32900002
* THIS SECTION BUILDS THE UNIT TEXT UNIT.                               32930002
*                                                                       32960002
         LA    RTEXT,VOLTEXTL(,RTEXT)   INCREMENT BASE           Y02082 32990002
         ST    RTEXT,S99TUPTR+K4        POINT TO UNIT TEXT UNIT  Y02082 33020002
         LH    RWRK,UNITKEY             INDICATE UNIT SPECIFIED  Y02082 33050002
         STH   RWRK,S99TUKEY                                     Y02082 33080002
         LA    RWRK,K1                  ONE TEXT PARM            Y02082 33110002
         STH   RWRK,S99TUNUM                                     Y02082 33140002
         LA    RWRK,L'UCBNAME           LENGTH OF UCBNAME        Y02082 33170002
         STH   RWRK,S99TULNG                                     Y02082 33200002
         MVC   S99TUPAR(L'UCBNAME),UCBNAME  GET UNIT NUMBER      Y02082 33230002
*                                                                       33260002
* THIS SECTION BUILDS THE STATUS TEXT UNIT.                             33290002
*                                                                       33320002
         LA    RTEXT,UNITEXTL(,RTEXT)   UPDATE TEXT UNIT BASE    Y02082 33350002
         ST    RTEXT,S99TUPTR+K8        PTR TO STATUS TEXT UNIT  Y02082 33380002
         LH    RWRK,STATUSKY                                     Y02082 33410002
         STH   RWRK,S99TUKEY            INDICATE STATUS TEXT     Y02082 33440002
         LA    RWRK,K1                                           Y02082 33470002
         STH   RWRK,S99TUNUM            ONE TEXT PARM            Y02082 33500002
         STH   RWRK,S99TULNG            LENGTH OF TEXT PARM      Y02082 33530002
         MVI   S99TUPAR,STATOLD         INDICATE DISP=OLD        Y02082 33560002
*                                                                       33590002
* THIS SECTION BUILDS THE RETURN DDNAME TEXT UNIT.                      33620002
*                                                                       33650002
         LA    RTEXT,STATEXTL(,RTEXT)   INCREMENT TEXT UNIT BASE Y02082 33680002
         ST    RTEXT,S99TUPTR+K12       PTR TO DDNAME TEXT UNIT  Y02082 33710002
         LH    RWRK,RTNDDKEY            INDICATE RETURN DDNAME   Y02082 33740002
         STH   RWRK,S99TUKEY            SPECIFICATION            Y02082 33770002
         LA    RWRK,K1                  ONE TEXT PARM            Y02082 33800002
         STH   RWRK,S99TUNUM                                     Y02082 33830002
         LA    RWRK,L'TIOEDDNM                                   Y02082 33860002
         STH   RWRK,S99TULNG            LENGTH OF DDNAME         Y02082 33890002
         XC    S99TUPAR(L'TIOEDDNM),S99TUPAR  CLEAR FOR DDNAME   Y02082 33920002
         OI    S99TUPTR+K12,S99TUPLN    INDICATE END OF LIST     Y02082 33950002
         LA    R1,VTOCDSCB              POINT TO REQ BLOCK PTR   Y02082 33980002
         DYNALLOC                       ISSUE DYNAMIC ALLOCATION Y02082 34010002
         LTR   RTNCODE,RTNCODE          TEST IF SUCCESSFUL       Y02082 34040002
         BNZ   ENDADDR                  BRANCH IF NOT            Y02082 34070002
*                                                                       34340002
* THIS SECTION SEARCHES THE DSAB CHAIN TO FIND THE ADDRESS OF THE DSAB  34370002
* WHICH POINTS TO THE TIOT ENTRY CONTAINING THE DYNAMICALLY ALLOCATED   34400002
* DDNAME. RTEXT STILL POINTS TO THE DDNAME TEXT UNIT.                   34430002
*                                                                       34460002
         L     RDSAB,DSABQDB            LOAD DSAB QDB ADDRESS    Y02082 34490002
         USING QDB,RDSAB                QDB ADDRESSABILITY       Y02082 34520002
         L     RDSAB,QDBFELMP           GET FIRST DSAB ADDRESS   Y02082 34550002
         USING DSAB,RDSAB               DSAB ADDRESSABILITY      Y02082 34580002
FINDDSAB EQU   *                        IS THERE ANOTHER DSAB    Y02082 34610002
         LTR   RDSAB,RDSAB              IS THERE ANOTHER DSAB    Y02082 34640002
         BZ    ENDADDR                  BRANCH IF NOT            Y02082 34670002
         L     RTIOT,DSABTIOT           GET TIOT POINTER         Y02082 34700002
         USING TIOENTRY,RTIOT           TEST IF CORRECT DSAB     Y02082 34730002
         CLC   TIOEDDNM,S99TUPAR        TEST IF CORRECT DSAB     Y02082 34760002
         BE    FOUNDSAB                 BRANCH IF YES            Y02082 34790002
         L     RDSAB,DSABFCHN           GET NEXT DSAB ADDRESS    Y02082 34820002
         B     FINDDSAB                 CONTINUE SEARCH          Y02082 34850002
FOUNDSAB EQU   *                        FOUND IT                 Y02082 34880002
         OI    SISW1,UCBALLOC           SET UCB ALLOCATED BIT    Y02082 34910002
*                                                                       34940002
         OI    DSMADTB1,DSMUCBAL        SET UCB ALLOCATED BIT    Y02144 34970002
         ST    RDSAB,DSMADTW4           SAVE DSAB ADDRESS        Y02144 35000002
         ST    RDSAB,DSABADDR           SAVE DSAB ADDRESS        YM7036 35010002
         ST    RUCB,WKADEB+UCBADDR      SAVE UCB ADDRESS IN DEB  YM7036 35020002
         MVI   WKADEB+UCBADDR,DEVMOD    INSERT DEVICE MODIFIER   YM7036 35030002
         B     MOUNTED                  CONTINUE WITH SCRATCH    YM7036 35040002
*                                                                       64600013
*** PROGRAM CONSTANTS                                                   64800002
*                                                                       65000002
EXTCONST DC    X'FFFFFFFF7FFF'          LAST CCHH AND NBR OF TRACKS     65400002
         DS    0F                       FULLWORD BOUNDARY        Y02134 65500002
RETNAME  DC    CL4'290E'                RETURN NAME FOR IGG0290F Y02134 65600002
RPSID    DC    CL4'RPSA'                RPS APPENDAGE ID         Y02134 65700002
VTOCNAME DC    CL8'SYSVTOC'             SYSVTOC MAJOR ENQ NAME   Y02134 65900002
VOLSERKY DC    AL2(DALVLSER)            VOLSER TEXT UNIT KEY     Y02082 66000002
UNITKEY  DC    AL2(DALUNIT)             UNIT TEXT UNIT KEY       Y02082 66100002
STATUSKY DC    AL2(DALSTATS)            STATUS TEXT UNIT KEY     Y02082 66200002
RTNDDKEY DC    AL2(DALRTDDN)            RETURN DDNAME KEY        Y02082 66300002
*                                                                       70900021
*** TABLE OF MODULE IDS AND ENTRY POINT ADDRESSES                       71000002
*                                                                       71100021
         XCTLTABL ID=(NEXTLOAD,0A,LASTLOAD,0D,MNTLOAD,0F,        YM3997X71200002
               THISLOAD,IGG0290E,                                YM5371X71250002
               RPS19EK,IGG019EK),SVC=029,LENGTH=,BRT=YES         YM3997 71300002
         SPACE 2                                                        71400002
         IECDSECS CVT,DSAB,QDB,RB,RRPL,TCB,TIOT,UCB,EXPAND=YES   Y02144 71500002
WORKAREA IECSCRWA EP,ADT=YES            SCRATCH WORK AREA        Y02144 71600002
         EJECT                                                   Y02082 71700002
*                                                                       71800002
* DSECTS FOR INVOCATING DYNAMIC ALLOCATION (SVC 99)                     71900002
*                                                                       72000002
         IEFZB4D0                       DYNAMIC ALLOCATION DSECT Y02082 72100002
         EJECT                                                   Y02082 72200002
         IEFZB4D2                       DYNAMIC ALLOCATION KEYS  Y02082 72300002
         EJECT                                                   YM7036 72310002
         IEFJFCBN                       JFCB DSECT               YM7036 72320002
         END                                                            87200013
