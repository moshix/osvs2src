 TITLE 'IGG0325B - DADSM - ALLOCATE REQUEST CALCULATION'                00020000
IGG0325B CSECT                                                          00021021
*                                                                       00021402
*MODULE NAME = IGG0325B                                                 00021802
*                                                                       00021902
*DESCRIPTIVE NAME = DADSM - ALLOCATE REQUEST CALCULATION                00022902
*                                                                       00024902
*COPYRIGHT = NONE                                                       00025102
*                                                                       00025202
*CHANGE ACTIVITY = SEE BELOW                                            00025302
*                                                                       00025402
*          RELEASE 16 DELETIONS                                         00025502
*1028                                                             13559 00026002
*1028035000                                                       14112 00027002
*          RELEASE 17 DELETIONS                                         00028002
*1684000400,117200,120200.                                         UL17 00029002
*1684053800,058000                                                16866 00030002
*          RELEASE 18 DELETIONS                                         00031002
*2412                                                             OC058 00032002
*          RELEASE 19 DELETIONS                                         00033002
*1025035430                                                      A27563 00034002
*          RELEASE 20 DELETIONS                                         00035002
*3519                                                            A33097 00036002
*3519029000,072000-072600,077800-078800,097200-098000,100400,    S20201 00037002
*3519115600                                                      S20201 00038002
*          RELEASE 21 DELETIONS                                         00039002
*1192022000-022200,022800-023000,052200,073600,127400            A37199 00040002
*1192000210,001600,002000-004000,004600-004800,009600,011400-    S21016 00041002
*1192012200,020400,022800,028900,030000-030600,032660-033200,    S21016 00042002
*1192044520,066800-067000,116200-116400,117200,120200,144000     S21016 00043002
*0000065800,117200-120200                                       SA53163 00044002
*0000000280,001000,006400,033600-033800,035500,040200,040600-    A46776 00045002
*0000041200,041600,042000,059600,061200-062200,074600,118200,    A46776 00046002
*0000123200-123600                                               A46776 00047002
*          RELEASE 21.7 DELETIONS/CHANGES                               00048002
*0000000288,087400                                              SA59784 00049002
*          VS2 RELEASE 02 DELETIONS/CHANGES                             00050002
*0000000030-000150,000290-000300,001200,001800,004700,006200,    Y02080 00051002
*0000007000,007400-007800,008400,009200,009600-010600,011400-    Y02080 00052002
*0000011500,012600,020800,022600,022800-022900,028200,031800,    Y02080 00053002
*0000034600,042200,043600,044460,045200,049400,049610-049690,    Y02080 00054002
*0000050200-051400,052200,053000-061000,064000,067600-067800,    Y02080 00055002
*0000068200-068400,073200,073600-075200,092400-092600,100600,    Y02080 00056002
*0000105000,113300,114200,116800,117700,121400,123800-143800     Y02080 00057002
*0000                                                           SA65999 00057402
*          VS2 RELEASE 03.0 DELETIONS/CHANGES                           00057802
*0000102800,102900                                              ZA00010 00057902
*          VS2 RELEASE 03.7 CHANGES                                     00058037
*0000110800,111000                                             @ZA10233 00058337
*C102800,D102820-102900                                        @ZA16895 00058437
*                                                                       00058637
*STATUS CHANGE LEVEL 007                                                00059002
*FUNCTION/OPERATION: THIS MODULE DETERMINES THE TYPE OF REQUEST MADE  * 00060000
*   AND CALCULATES THE SPACE REQUIREMENTS IN TRACKS FOR ALL REQUESTS. * 00080000
*   IT ALSO CALCULATES THE 'TTRLL' FIELD FOR ANY BPAM DATA SETS. IT   * 00104021
*   DETERMINES TO WHICH ALLOCATE MODULE TO PASS CONTROL.  CONTROL     * 00120002
*   MAY BE PASSED TO A SUBSEQUENT MODULE OF DADSM ALLOCATE OR TO      * 00140000
*   SUBALLOCATE. A NEW CHANNEL PROGRAM IS RELOCATED TO THE WORK AREA  * 00160021
*   PRIOR TO A BRANCH TO A SUBSEQUENT DADSM ALLOCATE MODULE.          * 00180002
*                                                                     * 00420000
*ENTRY POINTS:                                                        * 00440000
*   IGG0325B - ENTRY IS MADE FROM IGG0325A VIA A BRANCH.              * 00470002
*                                                                     * 00500000
*INPUT: UPON ENTRY TO THIS MODULE THE WORK AREA WILL CONTAIN THE      * 00520000
*   DATA PORTION OF THE FORMAT 4 DSCB, THE KEY AND DATA OF THE FIRST  * 00540000
*   FORMAT 5 DSCB, AND THE ABSOLUTE ADDRESS OF THE FORMAT 4 AND       * 00560000
*   FORMAT 5 DSCB'S.                                                  * 00580000
*   THE WORK AREA WILL ALSO CONTAIN A DEB, AN IOB, AND AN ECB.        * 00600000
*   THE FIRST FORMAT 5 DSCB IN CORE SWITCH WILL BE SET.               * 00620002
*   REGISTER 11 WILL POINT TO THE JFCB OR PARTIAL DSCB.               * 00644021
*   REGISTER 13 WILL POINT TO THE WORK AREA.                          * 00660000
*                                                                     * 00680000
*OUTPUT: UPON TRANSFER OF CONTROL THE WORK AREA AND REGISTERS WILL BE * 00700002
*   AS AT INPUT WITH THE FOLLOWING ADDITIONS.  REGISTER 10 WILL       * 00720000
*   CONTAIN THE SPACE REQUESTED IN TRACKS.  FOR A DIRECTORY           * 00740002
*   REQUEST, FIELD 'TTRLL' WILL CONTAIN THE NUMBER OF TRACKS          * 00780002
*   AND RECORDS REQUIRED FOR THE DIRECTORY SPACE AND THE NUMBER       * 00800000
*   OF UNUSED BYTES REMAINING ON THE LAST DIRECTORY TRACK.  UPON      * 00820000
*   A BRANCH TO A SUBSEQUENT ALLOCATE MODULE, THE WORK AREA WILL      * 00840002
*   ALSO CONTAIN A NEW CHANNEL PROGRAM.                               * 00860000
*                                                                     * 00880000
*EXTERNAL ROUTINES:                                                   * 00900000
*        IECRES - BRANCH TO ANOTHER MODULE                            * 00920002
*                                                                     * 00940000
*EXITS:                                                               * 00950021
*   -NORMAL: BRANCH TO IGG0325C FOR ABSTR REQUESTS                    * 00960002
*   BRANCH TO IGG0325D FOR NON-ZERO QUANTITY REQUESTS.                * 00980002
*   BRANCH TO IGG0325E FOR ZERO QUANTITY REQUESTS.                    * 01020002
*   BRANCH TO IGG0325K FOR USER LABEL TRACK REQUESTS.                 * 01024002
*   -ERRORS: BRANCH TO IGG0325H WITH CODE IN ERROR CODE PASS REGISTER.* 01060002
*                                                                     * 01080000
*   ERROR CODES THAT CAN BE ISSUED BY 'ALLOCATE REQUEST CALCULATION'. * 01100000
*                                                                     * 01120000
*   08 - NO AVAILABLE DSCB'S IN THE VTOC                              * 01130021
*                                                                     * 01160021
*   38 - NOT ENOUGH SPACE ON VOLUME FOR DIRECTORY                     * 01170021
*                                                                     * 01180021
*   80 - DIRECTORY SPACE REQUESTED IS LARGER THAN PRIMARY SPACE       * 01190021
*                                                                     * 01240000
*TABLES/WORK AREAS: DADSM WORK AREA DESCRIBED BY MACRO 'IECALLWA'     * 01260002
*                                                                     * 01280000
*              ***************************************                * 01300000
*              *             DADSM TABLE             *                * 01320000
*              ***************************************                * 01340000
*                                                                     * 01360000
*              ***************************************                * 01380000
*              *        *         *                  *                * 01400000
*              *  TYPE  *  NO OF  *     USED HOLE    *                * 01420000
*              *  FLAG  * ENTRIES *      COUNTER     *                * 01440000
*              *        *         *                  *                * 01460000
*              ***************************************                * 01480000
*              *                  *                  *                * 01500000
*              *       RTA        *      RTA+1       *                * 01520000
*              *                  *                  *                * 01540000
*              ***************************************                * 01560000
*              *                  *                  *                * 01580000
*              *       RTA        *      RTA+1       *                * 01600000
*              *                  *                  *                * 01620000
*              ***************************************                * 01640000
*              *                  *                  *                * 01660000
*              *       RTA        *      RTA+1       *                * 01680000
*              *                  *                  *                * 01700000
*              ***************************************                * 01720000
*              *                  *                  *                * 01740000
*              *       RTA        *      RTA+1       *                * 01760000
*              *                  *                  *                * 01780000
*              ***************************************                * 01800000
*              *                  *                  *                * 01820000
*              *       RTA        *      RTA+1       *                * 01840000
*              *                  *                  *                * 01860000
*              ***************************************                * 01880000
*                                                                     * 01900000
*              TYPEFLG  =  02 - BPAM DIRECTORIES REQUESTED.           * 01920000
*                                                                     * 01940000
*                       =  40 - USER LABELS REQUESTED                 * 01944021
*                                                                     * 01948021
*                       =  80 - SET MUST COMPLETE IS ACTIVE           * 01952021
*                                                                     * 01956021
*              NO OF ENTRIES = NUMBER OF ENTRIES WITHIN DADSM TABLE.  * 01960000
*                                                                     * 01980000
*              RTA = THE STARTING TRACK OF THE ALLOCATED EXTENT.      * 02000000
*                                                                     * 02020000
*              RTA+1 = THE STARTING TRACK OF THE NEXT AVAILABLE EXTENT* 02040021
*                                                                     * 02060000
*ATTRIBUTES: REENTRANT                                                * 02080002
*                                                                     * 02100000
*NOTES:                                                               * 02120000
*   OTHER MACROS USED                                                 * 02140000
*   IECALLWA - ALLOCATE WORK AREA EXPANSION                           * 02150002
*   IECSDSL1 - BUILD DSCB'S                                           * 02160000
*   IEFJFCBN - BUILD JFCB                                             * 02180000
*   CVT - BUILD CVT                                                   * 02230002
*                                                                     * 02240000
*                                                                     * 02270021
*STORAGE: PROGRAM CODE - LESS THAN 1024 BYTES                         * 02280002
*   WORK AREA - AS DEFINED IN THE IECALLWA MACRO                      * 02290002
*   RPS WORK AREA - AS DEFINED IN THE IECRPS MACRO                    * 02300002
*                                                                     * 02320000
*                                                                       02340000
*REGISTER NAMES-                                                        02360000
*                                                                       02380000
R0       EQU   0                        CHANNEL PROGRAM RELOCATION      02400000
EXTRPAS1 EQU   0                        CONVERTED REGISTER              02420000
R1       EQU   1                        CHANNEL PROGRAM RELOCATION      02440000
R2       EQU   2                        CHANNEL PROGRAM RELOCATION      02460000
FREEREGE EQU   2                        EVEN WORK REGISTER              02480000
FREEREGO EQU   3                        ODD WORK REGISTER               02500000
R4       EQU   4                        CHANNEL PROGRAM RELOCATION      02520000
FREEREGA EQU   4                        WORK REGISTER                   02540000
FREEREGB EQU   5                        WORK REGISTER                   02560000
R6       EQU   6                        CHANNEL PROGRAM RELOCATION      02580000
FREEREGC EQU   6                        WORK REGISTER                   02600000
RTTRPTR  EQU   7                        PTR TO XCTL BY TTR TABLE ENTRY  02620000
R8       EQU   8                        CHANNEL PROGRAM RELOCATION      02640000
REGEIGHT EQU   8                        WORK REGISTER                   02660000
RERRPASS EQU   8                        ERROR CODE PASS REGISTER        02680000
R9       EQU   9                        CHANNEL PROGRAM RELOCATION      02700000
REGNINE  EQU   9                        WORK REGISTER                   02720000
REGTEN   EQU   10                       REQUEST PASS REGISTER           02740000
RJFCBPTR EQU   11                       JFCB POINTER                    02760000
BASEREG  EQU   12                       BASE REGISTER                   02780000
RWKA     EQU   13                       CHANNEL PROGRAM WORKAREA PTR    02800000
RETNREG  EQU   14                       RETURN REGISTER                 02840000
REGFTEN  EQU   15                       WORK REGISTER                   02860000
*                                                                       02880000
* OTHER EQUATES                                                         02882021
*                                                                       02884021
DSORGPO  EQU   X'02'                    DSORG = PO               A46776 02884821
TBOVHD   EQU   X'08'                    TWO BYTE OVERHEAD FLAG   S20201 02885020
TOOLARGE EQU   X'38'                    DIRECTORY SPACE REQUEST  S21016 02887021
*                                       IS TOO LARGE FOR VOLUME  S21016 02889021
GRTHPRIM EQU   X'80'                    DIRECTORY SPACE REQUEST  S21016 02891021
*                                       IS GREATER THAN PRIMARY  S21016 02893021
C0       EQU   0                        CONSTANT OF 0            S20201 02895020
C1       EQU   1                        CONSTANT OF 1            S20201 02900020
R5       EQU   5                        EQU FOR STM              S20201 02905020
THRE     EQU   3                        EQUATE FOR THREE         S20201 02910020
C8       EQU   8                        CONSTANT OF 8            S20201 02915020
K1       EQU   1                        CONSTANT OF 1           SA65999 02915402
K2       EQU   2                        EQUATE FOR 2            SA53163 02917021
K3       EQU   3                        CONSTANT OF 3            Y02080 02919002
K6       EQU   6                        CONSTANT OF 6            Y02080 02919402
K12      EQU   12                       CONSTANT OF 12           Y02080 02919802
*                                                                       02920000
*                                                                       02940000
* * * * * * * * * * * * *                                               02960000
*                                                                       02980000
*                                                                       03080000
*REGISTER USAGE-                                                        03100000
*                                                                       03120000
         BALR  BASEREG,0                                                03140000
         USING *,BASEREG                                           OC58 03160018
         USING ALLOCWKA,RWKA            WORK AREA ADDRESSABILITY Y02080 03180002
         USING JFCBKEN,RJFCBPTR                                         03200000
*                                                                       03220000
* INITIALIZE THE TTRLL FIELD TO RELATIVE TRACK = 0, ACTUAL RECORD = 0,  03240000
* AND BYTES REMAINING = DEVICE TRACK LENGTH.                            03260000
*                                                                       03280021
CYLTRKRC EQU   *                                                 S21016 03300021
         MVC   TTRLL+3(2),DS4DEVTK      SET LL TO TRACK LENGTH          03340000
         LTR   RJFCBPTR,RJFCBPTR        TEST FOR PARTIAL DSCB    A46776 03360021
         BM    PARTIAL                  BRANCH IF YES            A46776 03380021
         CLC   JFCBPQTY(3),ZEROS        TEST FOR ZERO QTY REQUEST       03400000
         BNE   NOTZQTY                  BRANCH IF NOT ZERO QTY          03420000
*                                                                       03440000
* ZERO QUANTITY - SET BRANCH TO BUILD FORMAT 1 DSCB.                    03460002
*                                                                       03480000
         TM    JFCBCTRI,X'C0'          CHECK IF ABSTR REQUESTED    8158 03520000
         BZ    CLEANUP                 BRANCH IF ABSTR REQUESTED   8158 03540000
DSCBTEST EQU   *                                                 A46776 03540121
         OC    DS4DSREC(2),DS4DSREC     ANY HOLES                A27563 03540619
         BNE   CONT                     YES, BRANCH              A27563 03541219
         LA    RERRPASS,X'08'           SET ERROR CODE           A27563 03541819
         B     ERREXIT                  GO XCTL                  A27563 03542419
CONT     TM    TYPEFLG,USRLBL           USER LABELS REQ.         A27563 03543419
         BO    USERZERO                 BRANCH IF YES              UL17 03546017
         LA    RTTRPTR,ALLOCA3          LOAD PTR TO F1/F3 TTR ENTRY     03560000
         B     XCTLHERE                                                 03580000
*                                                                       03600000
* A TEST OF THE FIELD JFCBDQTY IS MADE TO DETERMINE IF THE DATA SET IS  03620000
* A BPAM DATA SET                                                       03640000
*                                                                       03660000
NOTZQTY  L     FREEREGO,JFCBDQTY        GET DIRECTORY QUANTITY          03680000
         SRL   FREEREGO,8               POSITION                        03700000
         LTR   FREEREGO,FREEREGO        ARE DIRECTORIES REQUESTED       03720000
         BP    DIRCAL                   BRANCH IF YES                   03740000
*                                                                       03760000
* DATA SET IS NOT BPAM - TEST FOR PRIMARY QUANTITY IN RECORDS.          03780000
*                                                                       03800000
         L     EXTRPAS1,JFCBPQTY        GET REQ PRIMARY QUANTITY        03820000
         SRL   EXTRPAS1,8               POSITION                        03840000
         TM    JFCBCTRI,X'C0'           IS PRIMARY QTY IN CYLINDERS     03860000
         BC    1,MULT                   BRANCH IF YES                   03880000
         TM    JFCBCTRI,X'40'           IS PRIMARY QTY IN AVG RCD LGTH  03900000
         BC    1,NOCAL                  BRANCH IF YES                   03920000
         B     CLEANUP                  PRIMARY QUANTITY IS IN TRACKS   03940000
MULT     MH    EXTRPAS1,DS4DEVSZ+2      CONVERT CYLS TO TRKS            03960000
         B     CLEANUP                                                  03980000
*                                                                       04000000
* UTILITY SPACE REQUEST - TEST FOR DSORG = PO IN THE PARTIAL F1 DSCB    04020021
*                                                                       04040000
PARTIAL  EQU   *                                                 A46776 04060021
         CLC   PDPRIQTY,ZEROS           TEST IF ZERO QTY REQUEST A46776 04080021
         BE    DSCBTEST                 BRANCH IF ZERO QUANTITY  A46776 04100021
         TM    PD1DSORG,DSORGPO         TEST FOR DIRECTORIES     A46776 04120021
         BC    1,CALCDIR                BRANCH IF DIRECTORIES REQUESTED 04140000
GOOUT    EQU   *                                                 A46776 04144021
         L     REGTEN,PDPRIQTY          LOAD PRIMARY QUANTITY    A46776 04160021
         B     REGULAR                                                  04180000
CALCDIR  EQU   *                                                 A46776 04184021
         L     FREEREGO,PDDIRQTY        LOAD DIRECTORY QUANTITY  A46776 04200021
         OI    ASWITCH,PRCNTL           SET PROCESS CONTROL SW   Y02080 04220002
*                                                                       04240000
* DATA SET IS BPAM                                                      04260000
*                                                                       04280000
* THIS SECTION CALCULATES THE TOTAL NUMBER OF TRACKS AND RECORDS        04300000
* NEEDED TO FILL THE DIRECTORY QUANTITY REQUESTED.                      04320000
*                                                                       04340000
DIRCAL   EQU   *                        BRANCH LABEL             Y02080 04350002
         OI    TYPEFLG,DIRREQ           SET DIRECTORIES REQ FLAG Y02080 04360002
         SR    FREEREGE,FREEREGE        CLEAR HIGH DIVIDEND REGISTER    04380000
         SR    FREEREGA,FREEREGA                                        04400000
         IC    FREEREGA,DS4DEVDB        GET NBR OF DIR BLKS PER TRK     04420000
         DR    FREEREGE,FREEREGA        CALCULATE NBR OF TRKS REQUIRED  04440000
         CH    FREEREGO,MAXTRACK        TEST IF TOO MANY TRACKS  Y02080 04446002
         BH    TOOMANY                  BRANCH IF TOO MANY TRKS  S21016 04453021
         STH   FREEREGO,TTRLL           STORE NBR OF TRACKS             04460000
         LA    FREEREGE,1(FREEREGE)     ACCOUNT FOR EOD MARK            04480000
         STC   FREEREGE,TTRLL+2         STORE NBR OF ADDITIONAL RCDS    04500000
         TM    ASWITCH,PRCNTL           IS PROCESS CONTROL SW ON Y02080 04520002
         BO    MOVEBCK                  BRANCH IF YES                   04540000
*                                                                       04560000
* THIS SECTION CONVERTS THE PRIMARY QUANTITY TO TRACKS                  04580000
*                                                                       04600000
DIRCAL1  L     EXTRPAS1,JFCBPQTY        GET PRIMARY QUANTITY            04620000
         SRL   EXTRPAS1,8               POSITION                        04640000
         TM    JFCBCTRI,X'C0'           IS THIS A CYLINDER REQUEST      04660000
         BC    1,MULTA                  BRANCH IF YES                   04680000
         TM    JFCBCTRI,X'40'           IS THIS AN AVG RCD REQUEST      04700000
         BC    1,INRECRDS               BRANCH IF YES                   04720000
         B     MOVEBCK                  PRIMARY QUANTIRY IS IN TRACKS   04740000
MULTA    MH    EXTRPAS1,DS4DEVSZ+2      CONVERT CYL REQ TO TRACKS       04760000
*                                                                       04780000
* THIS SECTION CALCULATES IN BYTES THE LENGTH OF A DIRECTORY BLOCK.     04800000
* IT CALCULATES THE NUMBER OF BYTES REMAINING ON THE LAST DIRECTORY     04820000
* TRACK AND STORES THIS VALUE IN 'LL' OF THE TTRLL FIELD.               04840000
*                                                                       04860000
MOVEBCK  LA    FREEREGA,8               SET UP KL AND DL FOR            04880000
         LA    FREEREGB,256             DIRECTORY RECORD                04900000
         BAL   REGTEN,TTRCAL            GO CALCULATE DIR RECD LENGTH    04920000
         TM    ASWITCH,PRCNTL           IS PROCESS CONTROL SW ON Y02080 04940002
         BO    GOOUT                    BRANCH IF YES                   04960000
*                                                                       04970021
CLEANUP  LR    REGTEN,EXTRPAS1          LOAD COMMUNICATION REGISTER     04980000
*                                       WITH NUMBER OF TRACKS REQUIRED. 05000000
         TM    JFCBCTRI,X'C0'           IS THIS A CYL OF TRK REQUEST    05160000
         BC    5,REGULAR                BRANCH IF CYL OR TRK REQUEST    05180000
*                                                                       05200000
* ABSOLUTE TRACK REQUEST - SET UP BRANCH TO IGG0325C.                   05220002
*                                                                       05240000
         LA    RTTRPTR,ALLOCA1          LOAD PTR TO ABS/TRK TTR ENTRY   05260000
         B     XCTLHERE                                                 05280000
*                                                                       06240000
* TRANSFER CONTROL TO THE LAST MODULE OF SPACE ALLOCATION TO RELEASE    06260000
* THE WORK AREA,DEQ THE VTOC,PASS THE ERROR CODE,AND EXIT TO CALLER.    06280000
*                                                                       06300000
ERREXIT  LA    RTTRPTR,ALLOCD2          LOAD PTR TO LAST ALLOC ENTRY    06320000
         LR    REGFTEN,RERRPASS         HOLD ERROR CODE                 06340000
         B     XCTLH                                                    06360000
*                                                                       06380000
* THIS SECTION SETS UP A BRANCH TO MODULE IGG0325D.                     06400002
*                                                                       06420000
REGULAR  LA    RTTRPTR,ALLOCA2          LOAD PTR TO CYL/TRK TTR ENTRY   06440000
         TM    TYPEFLG,USRLBL           IS THIS USER LABEL         UL17 06445017
         BZ    XCTLHERE                 BRANCH IF NO               UL17 06450017
         LA    RTTRPTR,ALLOCA4          USER LABEL LOAD            UL17 06455017
*                                                                       06460000
* THIS SECTION DETERMINES IF THE PRIMARY QUANTITY REQUESTED IS          06480000
* SUFFICIENT TO FILL THE DIRECTORY QUANTITY REQUESTED.                  06500000
*                                                                       06520000
XCTLHERE SR    REGFTEN,REGFTEN          CLEAR ERROR HOLD REGISTER       06540000
         CH    REGTEN,TTRLL             IS PRI QTY EQ/GRTR THAN DIR QTY 06560000
         BH    XCTLH                    BRANCH IF YES           SA53163 06580021
         BL    DIRERR                   IF NOT, REQUEST IS IN   SA53163 06582021
*                                       ERROR                   SA53163 06584021
         CLI   TTRLL+2,C0               ARE THERE MORE DIR BLKS SA53163 06590021
*                                       THAN WILL FIT ON FULL   SA53163 06592021
*                                       TRACK(S) INDICATED BY   SA53163 06594021
*                                       TTRLL                   SA53163 06596021
         BE    XCTLH                    NO, CONTINUE NORMALLY   SA53163 06598021
*                                                                       06600000
* ERROR - PRIMARY QUANTITY REQUESTED IS LESS THAN THE DIRECTORY         06620000
* QUANTITY REQUESTED.                                                   06640000
*                                                                       06660000
DIRERR   EQU   *                                                 S21016 06680021
         LA    RERRPASS,GRTHPRIM        DIRECTORY ERROR CODE     S21016 06700021
         B     ERREXIT                                                  06720000
*                                                                       06722021
* ERROR - DIRECTORY SPACE REQUEST IS LARGER THAN THE AMOUNT             06724021
* AVAILABLE ON THE VOLUME.                                              06726021
*                                                                       06728021
TOOMANY  EQU   *                                                 S21016 06730021
         LA    RERRPASS,TOOLARGE        LOAD ERROR CODE          S21016 06732021
         B     ERREXIT                                           S21016 06734021
*                                                                       06740000
* SET UP THE WTG TABLE IN THE WORK AREA WITH THE ID AND ENTRY           06760002
* POINT ADDRESS OF THE NEXT CSECT.                                      06780002
*                                                                       06800000
USERZERO LA    RTTRPTR,ALLOCA4          POINTER TO USER LABEL LOAD UL17 06805017
         SR    REGFTEN,REGFTEN          CLEAR ERROR HOLD REGISTER  UL17 06810017
         SR    REGTEN,REGTEN            CLEAR QUANTITY REQUEST REG UL17 06815017
XCTLH    EQU   *                        BRANCH LABEL             Y02080 06817002
         MVC   WTGMODNM+K6(K2),0(RTTRPTR)  MOVE IN MODULE ID     Y02080 06820002
         MVC   WTGMODEP+C1(K3),K2(RTTRPTR)  MOVE IN MODULE ADDR  Y02080 06840002
*                                                                       06860000
* THIS SECTION INITIALIZES AND RELOCATED TO THE WORKAREA A NEW CHANNEL  06880000
* PROGRAM FOR SUBSEQUENT SPACE ALLOCATION MODULES.                      06900000
*                                                                       06920000
         LM    R0,R9,CCWORD1            LOAD FIRST 5 CCWS               06940000
         ALR   R0,RWKA                                                  06960000
         ALR   R2,RWKA                                                  06980000
        ALR   R4,RWKA                                                   07000000
         ALR   R6,RWKA                                                  07020000
         ALR   R8,RWKA                                                  07040000
         STM   R0,R9,CCW1               STORE FIRST 5 CCWS              07060000
         LM    R0,R9,CCWORD6            LOAD NEXT FIVE CCWS             07080000
         ALR   R0,RWKA                                                  07100000
         ALR   R2,RWKA                                                  07120000
         ALR   R4,RWKA                                                  07140000
         ALR   R6,RWKA                                                  07160000
         ALR   R8,RWKA                                                  07180000
         STM   R0,R5,CCW6               CCWS 6,7 AND 8           S20201 07200020
         STM   R0,R1,CCW9               CCW 9                    S20201 07220020
         STM   R6,R9,CCW10              CCWS 10 AND 11           S20201 07240020
         LR    RERRPASS,REGFTEN         LOAD ERROR PASS REGISTER        07280000
*                                                                       07300000
* THIS SECTION BRANCHES TO A SUBSEQUENT ALLOCATE MODULE.                07320002
*                                                                       07340000
EXITXCTL EQU   *                                                 A37199 07350021
         IECRES LOAD,EXTPR=(RWKA),BRANCH=DIRECT                  Y02080 07360002
*                                                                       07540000
* THIS AREA CHECKS FOR SPACE ON THE TRACK PARTIALLY FILLED BY THE       07560000
* DIRECTORY QUANTITY FOR ONE OR MORE DATA RECORDS.                      07580000
* A BRANCH IS MADE TO TTRCAL TO CALCULATE THE NEW TTRLL                 07600000
*                                                                       07620000
INRECRDS LA    FREEREGA,8               SET UP KL AND DL FOR            07640000
         LA    FREEREGB,256             DIRECTORY RECORD                07660000
         BAL   REGTEN,TTRCAL            GO CALCULATE AVG RCD LENGTH     07680000
*                                                                       07700000
* A BRANCH IS MADE TO RECCAL TO CALCULATE THE LENGTH IN BYTES           07720000
* OF AN AVERAGE RECORD NOT LAST AND LAST.                               07740000
*                                                                       07760000
*                                                                       07780020
         LA    RETNREG,RET1ADDR         SET UP RETURN REG        S20201 07800020
         B     RECCSET                  GO SET UP FOR CALC       S20201 07820020
*                                                                       07840020
RET1ADDR EQU   *                                                 S20201 07860020
*                                                                       07880020
         SR    FREEREGE,FREEREGE        CLEAR HIGH DIVIDEND REGISTER    07900000
         SR    FREEREGO,FREEREGO                                        07920000
         IC    FREEREGO,TTRLL+3         PICK UP NBR OF BYTES REMAINING  07940000
         SLL   FREEREGO,8               ON LAST                         07960000
         IC    FREEREGO,TTRLL+4         DIRECTORY TRACK                 07980000
         DR    FREEREGE,FREEREGA        CALCULATE THE NBR OF AVG RCDS   08000000
*                                       THAT WILL FIT ON LAST DIR TRK   08020000
         LR    RETNREG,FREEREGO         SAVE VALUE                      08040000
         LR    FREEREGO,FREEREGE        LOAD BYTES REMAINING            08060000
         SR    FREEREGE,FREEREGE        CLEAR HIGH DIVIDEND REGISTER    08080000
         DR    FREEREGE,FREEREGB        WILL AVG RCD LAST ON TRK        08100000
         LTR   FREEREGO,FREEREGO        FIT IN BYTES REMAINING          08120000
         BZ    LOADDIRT                 BRANCH IF NO                    08140000
         LA    RETNREG,1(RETNREG)       YES-INCREMENT NBR OF RCDS       08160000
LOADDIRT LA    EXTRPAS1,1               INITIALIZE NBR OF TRKS TO ONE   08180000
         AH    EXTRPAS1,TTRLL           ADD NBR OF TRKS REQUIRED        08200000
SUBTRACT L     FREEREGC,JFCBPQTY        GET PRIMARY QUANTITY            08220000
         SRL   FREEREGC,8               POSITION                        08240000
         CR    RETNREG,FREEREGC         CHECK TO SEE IF ROOM FOR PRI    08260000
*                                       QTY ON DIR TRACK                08280000
         BNL   CLEANUP                  BRANCH IF ROOM FOR ALL PRI QTY  08300000
         SR    FREEREGC,RETNREG         CALCULATE NBR OF AVG RCDS       08320000
*                                       THAT WILL NOT FIT ON DIR TRK    08340000
*                                                                       08360000
* TRKCAL ----  THIS ROUTINE CALCULATES HOW MANY RECORDS OF A GIVEN      08380000
* SIZE WILL FIT ON A TRACK.                                             08400000
* THE LENGTH IN BYTES OF AN AVERAGE RECORD AND OF A LAST RECORD ON A    08420000
* TRACK ARE TO BE IN REGISTERS 4(FREEREGA) AND 5(FREEREGB)              08440000
* RESPECTIVELY                                                          08460000
* THE NUMBER OF BYTES PER TRACK FOR THE DEVICE IS OBTAINED FROM THE     08480000
* DEVICE ENTRY OF THE FORMAT4 DSCB.                                     08500000
* RECORDS PER TRACK = 1 + (TRACK LENGTH-Y) / X                          08520000
*                                                                       08540000
* THE LENGTH OF A LAST RECORD ON A TRACK IS SUBTRACTED FROM THE TRACK   08560000
* LENGTH                                                                08580000
*                                                                       08600000
         LH    FREEREGO,DS4DEVTK        GET NBR OF BYTES PER TRACK      08620000
         SR    FREEREGO,FREEREGB        SUBTRACT Y FROM TRACK LENGTH    08640000
         BNL   SHORTREC                BRANCH IF REMAINDER IS NOT MINUS 08660000
*                                                                       08680000
* THIS SECTION SETS UP REGISTERS FOR THE AVG/RCD CALCULATION ROUTINE    08700000
* FOR AVG/RCD REQUESTS SPECIFYING AN AVG/RCD GREATER THAN A LAST RCD.   08720000
*                                                                       08721002
         SR    R1,R1                    CLEAR REGISTER          SA59784 08722002
         IC    R1,JFCKEYLE              GET KEY LENGTH          SA59784 08723002
         MVC   FULLWORD+C1(L'JFCBDRLH),JFCBDRLH  ALIGN LENGTH   SA59784 08724002
         L     FREEREGO,FULLWORD        LOAD DATA LENGTH        SA59784 08725002
         LA    FREEREGO,0(FREEREGO)     CLEAR HIGH BYTE         SA59784 08726002
         AR    FREEREGO,R1              ADD KEY AND DATA LENGTH SA59784 08727002
         IC    R1,DS4DEVI               GET OVERHEAD FOR KEYED  SA59784 08728002
*                                       NOT LAST RECORD         SA59784 08729002
         TM    DS4DEVFG,TBOVHD          TWO BYTE OVERHEAD       SA59784 08730002
         BZ    NOTTB00                  BRANCH IF NOT           SA59784 08731002
         LH    R1,DS4DEVI               GET TWO BYTE OVERHEAD   SA59784 08732002
NOTTB00  EQU   *                                                SA59784 08733002
         LH    REGEIGHT,DS4DEVTK        GET TRACK CAPACITY      SA59784 08734002
         SR    REGEIGHT,R1              SUBTRACT OVERHEAD       SA59784 08735002
         SR    FREEREGE,FREEREGE        CLEAR FOR DIVIDE        SA59784 08736002
         DR    FREEREGE,REGEIGHT        CALCULATE NUMBER OF     SA59784 08737002
*                                       TRACKS/RECORD           SA59784 08738002
         LTR   FREEREGE,FREEREGE        TEST FOR REMAINDER      SA59784 08739002
         BZ    DONTINCR                 BRANCH IF NONE          SA59784 08740002
         LA    FREEREGO,0(FREEREGO)     MAXIMUM NBR OF TRKS/RCD SA59784 08741002
DONTINCR EQU   *                                                SA59784 08742002
         MR    FREEREGE,R1              CALCULATE TOTAL OVER-   SA59784 08743002
*                                       HEAD FOR EACH RECORD    SA59784 08744002
         AR    FREEREGA,FREEREGO        ADD TO BLOCKSIZE        SA59784 08745002
         LR    FREEREGB,FREEREGA       LOAD NOT LAST RCD LENGTH         08760000
         MR    FREEREGA,FREEREGC       NBR OF RCD REQ TIMES NOT LAST    08780000
         LR    FREEREGO,FREEREGB       SET UP FOR AVG/RCD ROUTINE       08800000
         LH    FREEREGA,DS4DEVTK       GET NBR OF BYTES PER TRACK       08820000
         B     LONGREC                 REC LNGTH MORE THAN TRK/LNGTH    08840000
*                                                                       08860000
* THE RESULT IS DIVIDED BY THE LENGTH OF AN AVERAGE RECORD              08880000
*                                                                       08900000
SHORTREC SR    FREEREGE,FREEREGE       CLEAR HIGH DIVIDEND REGISTER     08920000
         DR    FREEREGE,FREEREGA        CALC NBR OF AVG RCDS PER TRK    08940000
         LR    FREEREGA,FREEREGO                                        08960000
         LA    FREEREGA,1(FREEREGA)     INCREMENT RESULT BY ONE         08980000
         LR    FREEREGO,FREEREGC        LOAD NBR OF RCDS REQUESTED      09000000
LONGREC  SR    FREEREGE,FREEREGE       CLEAR HIGH DIVIDEND REGISTER     09020000
         DR    FREEREGE,FREEREGA        DETERMINE NBR OF TRACKS NEEDED  09040000
         LTR   FREEREGE,FREEREGE        IS THERE A REMAINDER            09060000
         BZ    DONTINC                  BRANCH IF NO                    09080000
         LA    FREEREGO,1(FREEREGO)     ADD 1 IF REMAINDER EXISTS       09100000
DONTINC  AR    EXTRPAS1,FREEREGO        ADD PRI QTY TO DIR QTY          09120000
*                                                                       09140000
* A TEST IS MADE TO SEE IF THE ROUND TO CYLINDER OPTION IS SPECIFIED    09160000
*                                                                       09180000
         TM    JFCBCTRI,X'01'           IS ROUND OPTION REQUESTED       09200000
         BC    1,ROUNDUP                BRANCH IF YES                   09220000
         B     CLEANUP                                                  09280000
*                                                                       09300000
* WHEN THE ROUND TO FULL CYLINDERS OPTION IS GIVEN, THE NUMBER OF       09320000
* TRACKS IS DIVIDED BY THE NUMBER OF TRACKS PER CYLINDER TO SEE IF      09340000
* THERE ARE ANY EXCESS TRACKS, AND IF SO THE NUMBER OF CYLINDERS IS     09360000
* INCREMENTED BY ONE AND RECONVERT TO TRACKS.                           09380000
*                                                                       09400000
ROUNDUP  LR    FREEREGB,EXTRPAS1        LOAD NBR OF TRACKS REQUESTED    09420000
         SR    FREEREGA,FREEREGA        CLEAR HIGH DIVIDEND REGISTER    09440000
         LH    FREEREGE,DS4DEVSZ+2      GET THE NBR OF TRKS/CYL         09460000
         DR    FREEREGA,FREEREGE        CONVERT TRK QTY TO CYLS/TRKS    09480000
         LTR   FREEREGA,FREEREGA        IF THERE IS A TRACK REMAINDER   09500000
         BZ    DONOTINC                 BRANCH IF NO                    09520000
         LA    FREEREGB,1(FREEREGB)     INCREMENT THE NBR OF CYLS       09540000
DONOTINC MH    FREEREGB,DS4DEVSZ+2      RECONVERT CYLS TO TRKS          09560000
         LR    EXTRPAS1,FREEREGB        MOVE REQUEST TO COMM REGISTER   09580000
         B     CLEANUP                                                  09600000
*                                                                       09620000
* THIS SECTION SETS UP TO CALCULATE THE NUMBER OF BYTES REQUIRED        09640000
* FOR AN AVERAGE RECORD NOT LAST AND LAST ON A TRACK FOR NON            09660000
* DIRECTORY REQUESTS.                                                   09680000
*                                                                       09700000
*                                                                       09710020
NOCAL    EQU   *                                                 S20201 09720020
*                                                                       09730020
         LA    RETNREG,RET2ADDR         SETUP RETURN REG         S20201 09740020
         B     RECCSET                  GO SET UP FOR CALC       S20201 09750020
*                                                                       09760020
RET2ADDR EQU   *                                                 S20201 09770020
*                                                                       09780020
         SR    RETNREG,RETNREG          SET NBR OF AVG RCDS ON LAST     09820000
*                                       DIRECTORY TRK TO ZERO           09840000
         LR    EXTRPAS1,RETNREG         SET NBR OF DIR TRKS TO ZERO     09860000
         B     SUBTRACT                                                 09880000
*                                                                       09900000
* RECCAL - - - THIS SUBROUTINE CALCULATES THE LENGTH OF AN AVERAGE      09920000
* RECORD AND A RECORD TO BE LAST ON A TRACK                             09940000
* THE ROUTINE NEEDS THE KEYLENGTH AND DATA LENGTH OF A RECORD IN REGIS- 09960000
* TERS 4 (FREEREGA) AND 5 (FREEREGB) RESPECTIVELY                       09980000
* OVERHEAD CONSTANTS AND DEVICE CONSTANTS ARE ADDRESSED SYMBOLICALLY    10000000
* SO ADDRESSIBILITY MUST HAVE BEEN ESTABLISHED.                         10020000
*                                                                       10025020
RECCSET  EQU   *                                                 S20201 10030020
         SR    FREEREGA,FREEREGA        CLR REG                  S20201 10035020
         IC    FREEREGA,JFCKEYLE        PICK UP KEY LEN          S20201 10040020
         MVC   FULLWORD+C1(THRE),JFCBDRLH MOVE DATA LEN          S20201 10045020
         L     FREEREGB,FULLWORD        PUT IN REG               S20201 10050020
         LA    FREEREGB,C0(FREEREGB)    CLR HI BYTE              S20201 10055020
RECCAL   EQU   *                        BRANCH LABEL             Y02080 10057002
         STM   FREEREGE,FREEREGO,IECREGSV+K12  SAVE REGISTERS    Y02080 10060002
         SR    FREEREGO,FREEREGO        CLEAR WORK REGISTERS            10080000
         SR    REGEIGHT,REGEIGHT                                        10100000
         IC    FREEREGO,DS4DEVI         GET OVERHEAD FOR KEYED NOT LAST 10120000
         IC    REGEIGHT,DS4DEVL         GET OVERHEAD FOR KEYED LAST     10140000
         TM    DS4DEVFG,TBOVHD          TWO BYTE OVERHEAD        S20201 10142020
         BZ    NOTTB10                  BRANCH NO                S20201 10144020
         LH    FREEREGO,DS4DEVI         PICK UP TWO BYTES        S20201 10146020
         LR    REGEIGHT,FREEREGO        USE FOR LAST ALSO        S20201 10148020
NOTTB10  EQU   *                                                 S20201 10150020
*                                                                       10152020
         LTR   FREEREGA,FREEREGA        TEST FOR KEY LENGTH EQUAL TO 0  10160000
         BZ    CALOVHD                  BRANCH IF ZERO                  10180000
ADDKLDL  AR    FREEREGB,FREEREGA        ADD DATA LENGTH TO KEY LENGTH   10200000
         LR    REGNINE,FREEREGB         SAVE VALUE                      10220000
         LH    FREEREGE,DS4DEVTL        GET DEVICE TOLERANCE FACTOR     10240000
         MR    FREEREGA,FREEREGE        (KL+DL)TOL FACTOR - NOT LAST    10260000
         SRDA  FREEREGA,9               SHIFT OUT REMAINDER    @ZA16276 10280037
         AR    FREEREGB,FREEREGO        ADD IN OVERHEAD - NOT LAST      10300000
         LR    FREEREGA,FREEREGB        LOAD IN COMMUNICATION REGISTER  10320000
         B     COMPLETE                                                 10340000
CALOVHD  SR    FREEREGE,FREEREGE        CLEAR WORK REGISTER             10360000
         IC    FREEREGE,DS4DEVK         GET UNKEYED RECORD CONSTANT     10380000
         SR    FREEREGO,FREEREGE        ADJUST KEYED - NOT LAST         10400000
         SR    REGEIGHT,FREEREGE        ADJUST KEYED - LAST             10420000
         B     ADDKLDL                                                  10440000
COMPLETE AR    REGNINE,REGEIGHT         (KL+DL)  LAST RECORD            10460000
         LR    FREEREGB,REGNINE         LOAD IN COMMUNICATION REGISTER  10480000
         LM    FREEREGE,FREEREGO,IECREGSV+K12  RESTORE REGISTERS Y02080 10500002
         BR    RETNREG                                                  10520000
*                                                                       10540000
* TTRCAL ---- THIS ROUTINE UPDATES THE TTRLL OF FORMAT 1 DSCB. IT       10560000
* INCREMENTS TTR AND CALCULATES THE LL = TO THE NUMBER OF BYTES LEFT ON 10580000
* THE LAST USED TRACK.                                                  10600000
* INFORMATION IS PASSED AS FOLLOWS                                      10620000
*        1. NUMBER OF RECORDS USED ON LAST DIR TRACK - FREEREGE = 2     10640000
*        2. NUMBER OF FULL TRACKS - FREEREGO = 3                        10660000
*        3. KEYLENGTH - FREEREGA = 4                                    10680000
*        4. DATA LENGTH - FREEREGB = 5                                  10700000
* A BRANCH IS MADE TO RECCAL TO CALCULATE THE LENGTH IN BYTES OF AN     10720000
* AVERAGE RECORD AND A LAST RECORD ON A TRACK (FOR A DIRECTORY BLOCK)   10740000
*                                                                       10760000
TTRCAL   BAL   RETNREG,RECCAL           GO CALCULATE AVG RCD LENGTH     10780000
         LR    FREEREGO,FREEREGE        LOAD NBR OF RCDS USED ON        10800000
*                                       LAST DIRECTORY TRACK            10820000
*                                                                       10840000
* THE LENGTH OF AN AVERAGE RECORD IS MULTIPLIED TIMES THE NUMBER OF     10860000
* EXCESS RECORDS ON THIS PARTIALLY FILLED TRACK. THE NUMBER OF BYTES    10880000
* USED IS THEN SUBTRACTED FROM THE TOTAL TRACK LENGTH TO DETERMINE THE  10900000
* NUMBER OF AVAILABLE BYTES LEFT                                        10920000
*                                                                       10940000
         BCTR  FREEREGO,0               ACCOUNT FOR EOD                 10960000
         MR    FREEREGE,FREEREGA        MULT NBR OF RCDS BY AVG RCD     10980000
         LH    FREEREGA,DS4DEVTK        GET NBR OF BYTES PER TRACK      11000000
         SR    FREEREGA,FREEREGO        CALC NBR OF UNUSED BYTES        11020000
         SR    FREEREGO,FREEREGO                                        11040000
         IC    FREEREGO,DS4DEVI         PICK UP OVERHEAD                11060000
         TM    DS4DEVFG,TBOVHD          TWO BYTE OVERHEAD        S20201 11063020
         BZ    NOTTB40                  BRANCH NO                S20201 11066020
         LH    FREEREGO,DS4DEVI         GET TWO BYTES            S20201 11069020
*                                                                       11072020
NOTTB40  EQU   *                                                 S20201 11075020
         SR    FREEREGA,FREEREGO        ACCOUNT FOR OVERHEAD   @ZA10233 11080037
         SR    FREEREGO,FREEREGO        CLEAR WK REG           @ZA10233 11088037
         IC    FREEREGO,DS4DEVK         GET UNKEYED VALUE      @ZA10233 11096037
         AR    FREEREGA,FREEREGO        ADJUST FOR UNKEYED     @ZA10233 11104037
         BCTR  FREEREGA,0               ACCOUNT FOR EOF BYTE   @ZA10233 11112037
         STC   FREEREGA,TTRLL+4         SAVE BYTES REMAINING FOR        11120000
         SRL   FREEREGA,8               FORMAT 1 DSCB                   11140000
         STC   FREEREGA,TTRLL+3                                         11160000
         BR    REGTEN                                                   11180000
*                                                                       11200000
* * * * * * * * * * * * *                                               11220000
*                                                                       11240000
***   CONSTANTS                                                         11260000
*                                                                       11280000
* * * * * * * * * * * * *                                               11300000
*                                                                       11320000
MAXTRACK DC    H'32767'                 MAX POSITIVE NBR IN HW   Y02080 11330002
*                                                                       11340000
***   CHANNEL PROGRAM FOR SUBSEQUENT SPACE ALLOCATION MODULES.          11360000
*                                                                       11380000
CCWORD1  CCW   X'16',IDAREA-FIRST,X'70',5   READ R0                     11400000
CCWORD2  CCW   X'92',IDAREA-FIRST,X'60',5   READ COUNT           Y02080 11420002
CCWORD3  CCW   X'A9',CCW4+4-FIRST,X'60',4   SEARCH EQUAL KEY            11440000
CCWORD4  CCW   X'08',CCW2-FIRST,0,0         TIC TO READ COUNT           11460000
CCWORD5  CCW   X'03',0,X'20',1              END SEARCH WITH NOP   13559 11470016
*   BREAK CHANNEL PROGRAM TO PREVENT CREATION OF DUPLICATE DSCBS  13559 11480016
*   ON ERROR RETRIES.                                             13559 11490016
CCWORD6  CCW   X'31',IDAREA-FIRST,X'40',5   SEARCH ID EQUAL             11500000
CCWORD7  CCW   X'08',CCW6-FIRST,0,0         TIC TO SEARCH ID EQUAL      11520000
CCWORD8  CCW   X'0D',DSCBF1-FIRST,X'40',140 WRITE KEY AND DATA          11540000
CCWORD10 CCW   X'08',CCW9-FIRST,0,0         TIC TO SEARCH ID EQUAL      11580000
CCWORD11 CCW   X'0E',DSCBF5-FIRST,X'00',140 READ KEY AND DATA           11600000
ZEROS    EQU   CCWORD10+4               FOUR BYTES OF ZEROS      Y02080 11650002
*                                                                       11660000
* TABLE OF MODULE IDS AND ENTRY POINT ADDRESSES                         11680002
*                                                                       11700000
TTRTABLE XCTLTABL ID=(ALLOCA1,5C,ALLOCA2,5D,ALLOCA3,5E,         SA53163X11720021
               ALLOCD2,5H,ALLOCA4,5K),SVC=032,LENGTH=,BRT=YES    Y02080 11770002
         EJECT                                                   Y02080 11820002
*                                                                       12040000
* * * * * * * * * * * * *                                               12060000
*                                                                       12080000
*                                                                       12100000
JFCBKEN  DSECT                                                          12120000
         IEFJFCBN                                                       12160000
         EJECT                                                   Y02080 12170002
*                                                                       12180000
* * * * * * * * * * * * *                                               12200000
*                                                                       12220000
***   DSECT FOR THE PARTIAL DSCB PASSED TO ALLOCATE BY IEHMOVE   A46776 12222021
*                                                                       12240000
* * * * * * * * * * * * *                                               12260000
*                                                                       12280000
         ORG   INFMJFCB                                                 12300000
PD1DSNAM DS    CL44                DATA SET NAME                        12302021
PD1FMTID DS    CL1                 FORMAT IDENTIFIER                    12304021
PD1DSSN  DS    CL6                 DATA SET SERIAL NUMBER               12306021
PD1VOLSQ DS    XL2                 VOLUME SEQUENCE NUMBER               12308021
PD1CREDT DS    XL3                 CREATION DATE                        12310021
PD1EXPDT DS    XL3                 EXPIRATION DATE                      12312021
PD1NOEPV DS    XL1                 NUMBER OF EXTENTS ON VOLUME          12314021
PD1NOBDB DS    XL1                 NUMBER OF BYTES USED IN LAST         12316021
*                                     DIRECTORY BLOCK                   12318021
         DS    XL1                 RESERVED                             12320021
PD1SYSCD DS    CL13                SYSTEM CODE                          12322021
         DS    XL7                 RESERVED                             12324021
PD1DSORG DS    XL2                 DATA SET ORGANIZATION                12326021
PD1RECFM DS    XL1                 RECORD FORMAT                        12328021
PD1OPTCD DS    XL1                 OPTION CODE                          12330021
PD1BLKL  DS    XL2                 BLOCK LENGTH                         12332021
PD1LRECL DS    XL2                 RECORD LENGTH                        12334021
PD1KEYL  DS    XL1                 KEY LENGTH                           12336021
PD1RKP   DS    XL2                 RELATIVE KEY POSITION                12338021
PD1DSIND DS    XL1                 DATA SET INDICATORS                  12340021
PD1SCALO DS    XL4                 SECONDARY ALLOCATION                 12342021
PD1LSTAR DS    XL3                 LAST USED TRACK AND BLOCK ON TRACK   12344021
PD1TRBAL DS    XL2                 BYTES REMAINING ON LAST TRACK USED   12346021
         DS    XL2                 RESERVED                             12348021
PD1EXT1  DS    XL1                 EXTENT TYPE INDICATOR                12350021
         DS    XL2                 UNUSED                               12352021
PDPRIQTY DS    F                   PRIMARY SPACE REQUEST IN TRACKS      12354021
PDDIRQTY DS    F                   NUMBER OF DIRECTORY BLOCKS           12356021
         EJECT                                                   Y02080 12406002
DSCBWKAR IECALLWA EP,F4                 ALLOCATE WORK AREA       Y02080 12520002
         EJECT                                                   Y02080 12570002
CVT      DSECT                          CVT DSECT                Y02080 12620002
         CVT                                                     Y02080 12670002
         END   IGG0325B                                          S21016 54380021
