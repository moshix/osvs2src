      TITLE  'IFCECUA1 CUA THRESHOLDS AND PERM ERRROR SUMMARY MODULE'   00080042
*                                  THIS MODULE IS DESIGNED TO SUPPORT   00160042
*                                  THE DASDI/TAPE EREP ENHANCEMENTS.    00240042
*                                                              @Z40NIVS 00320042
         MACRO                                                          00400042
&NAME    DSGEN                                                          00480042
.*                            THIS MACRO GENERATES ONE DSECT WORD       00560042
.*                                 FORMATTED FOR THE SUBJECT LOG RECORD 00640042
.*                                 EACH OPERAND HAS TWO SUB LISTS. THE  00720042
.*                                 FIRST IS THE NAME OF THE LOG ITEM    00800042
.*                                 WHILE THE SECOND IS THE # OF BITS TO 00880042
.*                                 ALLOCATE FOR THIS ITEM. ITEMS MUST   00960042
.*                                 BE DEFINED CONTIGUOUSLY WITHOUT GAPS 01040042
.*                                 UNUSED BIT GROUPS MUST BE GIVEN      01120042
.*                                 DUMMY NAMES. THE NAMES PROVIDED FOR  01200042
.*                                 THE LOG ITEMS MAY THEN BE USED IN    01280042
.*                                 THE CONVERSION MACRO INSTRUCTIONS.   01360042
         GBLC &ITEM(1000)                                               01440042
         GBLA &ITEMNBR,&BITS(1000),&SHIFT(1000)                         01520042
         LCLB  &ONLY1,&CTIND                                            01600042
         LCLA  &START1,&START2,&END1,&END2                              01680042
         LCLC  &SYMBOL,&EQUSYM                                          01760042
         LCLA  &OP,&COUNT,&BYTE,&EQUCNT                                 01840042
         ACTR  100000                                                   01920042
.START   AIF   (N'&SYSLIST(&OP+1) LT 3).LOOP                            02000042
         AIF   ('&SYSLIST(&OP+1,3)' EQ 'EQU').LOOP     TEST FOR EQU     02080042
  AIF   ('&SYSLIST(&OP+1,3)' EQ '' AND '&SYSLIST(&OP+1,4)' EQ '').ERR1  02160042
  AIF   ('&SYSLIST(&OP+1,3)' EQ '' OR '&SYSLIST(&OP+1,4)' EQ '').ERR1   02240042
         AIF   ('&SYSLIST(&OP+1,3)' GT '&SYSLIST(&OP+1,4)').ERR3        02320042
&START1  SETA  &SYSLIST(&OP+1,3)        GET START COUNT OF ONE          02400042
&START2  SETA  &SYSLIST(&OP+1,4)        GET FIRST END COUNT             02480042
         AGO   .SET2A                   BRANCH AROUND                   02560042
.ERR1    MNOTE '**FIRST SYMBOL CONCATENATION INCOMPLETE**' @Z40NIVS     02640042
         MEXIT                                                          02720042
.SET2A   AIF   ('&SYSLIST(&OP+1,5)' EQ ''AND '&SYSLIST(&OP+1,6)' EQ '' X02800042
               ).SET2                   TEST FOR NO SECOND              02880042
  AIF   ('&SYSLIST(&OP+1,5)' EQ '' OR '&SYSLIST(&OP+1,6)' EQ '').ERR2   02960042
         AIF   ('&SYSLIST(&OP+1,5)' GT '&SYSLIST(&OP+1,6)').ERR3        03040042
&END1    SETA  &SYSLIST(&OP+1,5)        GET START COUNT OF 2            03120042
&END2    SETA  &SYSLIST(&OP+1,6)        GET END COUNT OF 2              03200042
         AGO   .LOOP                                                    03280042
.SET2    ANOP                                                           03360042
&ONLY1   SETB  1               INDICATE ONLY ONE CONCATENATION          03440042
         AGO   .LOOP                                                    03520042
.ERR2    MNOTE '**SECOND SYMBOL CONCATENATION INCOMPLETE**'             03600042
         MEXIT                                                          03680042
.ERR3    MNOTE '**START GREATER THAN END CONCATENATION**'               03760042
         MEXIT                                                          03840042
.LOOP    ANOP                                                           03920042
&OP      SETA  &OP+1                                                    04000042
         AIF   (&OP GT N'&SYSLIST).DONE      TEST IF ALL DONE           04080042
&ITEMNBR SETA  &ITEMNBR+1                                               04160042
         AIF   ('&SYSLIST(&OP,2)' NE '').OK1                            04240042
         MNOTE '**NULL BIT COUNT FIELD**'                               04320042
         MEXIT                                                          04400042
.OK1     ANOP                                                           04480042
&SYMBOL  SETC  '&SYSLIST(&OP,1)'                                        04560042
         AIF   ('&SYMBOL' NE '').OK                                     04640042
*              *****     LOG ITEM SYMBOL NOT PROVIDED     *****         04720042
         AIF   ('&SYSLIST(&OP,3)' NE 'EQU').CNT                         04800042
         AGO   .START                   GET NEXT                        04880042
.OK      AIF   (N'&SYSLIST(&OP) LT 3).NO3    TEST FOR OLD FORMAT        04960042
         AIF   ('&SYSLIST(&OP,3)' EQ 'EQU').EQU   TEST FOR EQU          05040042
         AIF   (&ONLY1).OK2             TEST FOR ONLY ONE CONCAT        05120042
&SYMBOL  SETC  '&SYMBOL.&START1.&END1'       GET 1 AND 2 CONCAT         05200042
         AGO   .NO3                     BRANCH AROUND                   05280042
.OK2     ANOP                                                           05360042
&SYMBOL  SETC  '&SYMBOL.&START1'        GET 1 CONCATENATED              05440042
.NO3     ANOP                                                           05520042
&SYMBOL  EQU   *+&BYTE                                                  05600042
&ITEM(&ITEMNBR) SETC '&SYMBOL'          GET LABEL IN GLOBAL             05680042
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2)                                    05760042
&SHIFT(&ITEMNBR) SETA &COUNT-&BYTE*8                                    05840042
.CNT     ANOP                                                           05920042
&CTIND   SETB  1                        SET COUNT INDICATOR             06000042
&COUNT   SETA  &COUNT+&SYSLIST(&OP,2)                                   06080042
&BYTE    SETA  &COUNT/8                                                 06160042
         AIF   (N'&SYSLIST(&OP) LT 3).START  TEST FOR OLD FORMAT        06240042
         AIF   (&ONLY1).TSTST           TEST FOR ONLY ONE CONCAT        06320042
         AIF   (&END1 EQ &END2).TSTST   TEST FOR SECOND END             06400042
&END1    SETA  &END1+1                  INCREMENT COUNT                 06480042
&OP      SETA  &OP-1                    DECREMENT INCREMENT             06560042
         AGO   .LOOP                    GENERATE NEXT                   06640042
.TSTST   ANOP                                                           06720042
         AIF   (&START1 EQ &START2).LPDONE   TEST FOR END               06800042
         AIF   (&ONLY1).NSET1           TEST FOR ONLY ONE CONCAT        06880042
&END1    SETA  &SYSLIST(&OP,5)          RE-INIT SECOND START COUNT      06960042
.NSET1   ANOP                                                           07040042
&OP      SETA  &OP-1                    DECREMENT INDEX                 07120042
&START1  SETA  &START1+1                INCREMENT FIRST COUNT           07200042
         AGO   .LOOP                    GO DO NEXT                      07280042
.LPDONE  ANOP                                                           07360042
&ONLY1   SETB  0                        CLEAR INDICATOR                 07440042
         AGO   .START                   GO TEST FOR MORE SUB-LISTS      07520042
.DONE    AIF   (&COUNT-&COUNT/8*8 NE 0).ERR  TEST FOR MULTIPLE OF EIGHT 07600042
         AIF   (&CTIND EQ 0).END        NO DS IF NO COUNT               07680042
&COUNT   SETA  &COUNT/8                 GET NUMBER OF BYTES             07760042
&NAME    DS    &COUNT.C                                                 07840042
.END     MEXIT                                                          07920042
.ERR     MNOTE '**BIT COUNT FLDS DO NOT TOTAL MULTIPLE OF 8**'          08000042
         MEXIT                                                          08080042
.EQU     AIF   ('&SYSLIST(&OP,4)' NE '').EQU1     TEST FOR NULL LABEL   08160042
.ERR4    MNOTE '**EQU OPERAND OMITTED OR NOT FOUND**'                   08240042
         MEXIT                                                          08320042
.EQU1    AIF   (&SYSLIST(&OP,2) LT 16).EQU2  COUNT OVER FIFTEEN         08400042
*****               THE FOLLOWING STATEMENT                *****        08480042
*****     NUMBER OF BITS EXCEED 15 - DO NOT USE AS BIN     *****        08560042
.EQU2    ANOP                                                           08640042
&EQUCNT  SETA  0                        CLEAR COUNTER                   08720042
&EQUSYM  SETC  '&SYSLIST(&OP,4)'        GET EQU OPERAND                 08800042
.EQULOP  ANOP                                                           08880042
&EQUCNT  SETA  &EQUCNT+1                INCREMENT INDEX                 08960042
         AIF   ('&ITEM(&EQUCNT)' EQ '&EQUSYM').EQUOUT  LABEL FOUND?     09040042
         AIF   (&EQUCNT EQ &ITEMNBR).ERR3    ALL TESTED?                09120042
         AGO   .EQULOP                  NO-GET NEXT                     09200042
.EQUOUT  ANOP                                                           09280042
&ITEM(&ITEMNBR) SETC '&SYMBOL'          GET LABEL NAME                  09360042
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2)    GET NUMBER OF BITS              09440042
&SHIFT(&ITEMNBR) SETA &SHIFT(&EQUCNT)   GET SHIFT COUNT                 09520042
&SYMBOL  EQU   &EQUSYM                  THIS SYMBOL EQUATED             09600042
         AGO   .START                   RETURN FOR NEXT                 09680042
         MEND                                                           09760042
*  LINE MACRO     LINE MACRO     LINE MACRO     LINE MACRO            * 09840042
         SPACE 2                                                        09920042
         MACRO                                                          10000042
&NAME    LINE  &DATA,&LABEL,&SKIP=                                      10080042
.*                            THIS MACRO ESTABLISHES THE MARGINS OR     10160042
.*                                 COLUMN SETTINGS FOR EACH LINE. IT    10240042
.*                                 GENERATES NECESSARY CARRIAGE CONTROL 10320042
.*                                 ENTRIES. LASTLY IT DETERMINES THE    10400042
.*                                 NUMBER OF ENTRIES ASSOCIATED WITH    10480042
.*                                 THE PREVIOUS LINE AND STORES THAT #  10560042
.*                                 INTO THE APPROPRIATE BYTE.           10640042
.*                            &DATA(1) - CHARACTER POSITION TO BEGIN    10720042
.*                                 DATA.                                10800042
.*                            &DATA(2) - # OF SPACES BETWEEN SUCCESSIVE 10880042
.*                                 DATA COLUMN STARTING CHARACTERS.     10960042
.*                            &LABEL(1) - CHAR. POS. TO BEGIN LABELS.   11040042
.*                            &LABEL(2) - # SPACES BETWEEN LINE'S LABEL 11120042
.*                                 STARTING CHARACTERS.                 11200042
.*                            &SKIP= - # OF LINES TO ADVANCE CARRIAGE   11280042
.*                                 TO BEGIN NEXT PRINTED LINE.          11360042
.*                            NEW ENTRIES ARE GENERATED ONLY WHEN       11440042
.*                                 NECESSARY. OMISSION OF ITEMS MEANS   11520042
.*                                 THEY HAVE NOT CHANGED SINCE PREVIOUS 11600042
.*                                 SETTINGS. A LINE MACRO IS REQUIRED   11680042
.*                                 FOR EACH PRINTED LINE. IF NO SETTING 11760042
.*                                 CHANGES ARE REQUIRED ALL OPERANDS    11840042
.*                                 ARE OMITTED IN WHICH CASE ONLY THE   11920042
.*                                 # OF ENTRIES FOR THE PREVIOUS LINE   12000042
.*                                 IS COMPUTED. THIS MACRO MUST BE THE  12080042
.*                                 FIRST MACRO INSTRUCTION ISSUED FOR   12160042
.*                                 THE SUBJECT LINE                     12240042
         GBLA  &DB,&DT,&LB,&LT,&NRENTS                                  12320042
         GBLA  &LASTCC,&INITIAL                                         12400042
         GBLC  &NRENTSX                                                 12480042
         GBLC  &CARRCON                                                 12560042
         GBLB  &TEST                                                    12640042
         LCLA  &S                                                       12720042
&NAME    DS    0C                                                       12800042
         AIF   (&INITIAL EQ 0).FIRSTLN                                  12880042
         LINEND                                                         12960042
         AGO   .NTFIRST                                                 13040042
.FIRSTLN ANOP                                                           13120042
&NRENTSX SETC  'N&SYSNDX'                                               13200042
&INITIAL SETA  1                                                        13280042
N&SYSNDX EQU   *                                                        13360042
.NTFIRST ANOP                                                           13440042
         DC    AL1(0)                                                   13520042
         AIF   ('&DATA(1)' EQ '').CKDTABS                               13600042
         AIF   (&DATA(1) EQ &DB).CKDTABS                                13680042
&DB      SETA  &DATA(1)                                                 13760042
         AGO   .AA                                                      13840042
.CKDTABS AIF   ('&DATA(2)' EQ '').NCDATA                                13920042
         AIF   (&DATA(2) EQ &DT).NCDATA                                 14000042
         AGO   .CC                                                      14080042
.AA      AIF   ('&DATA(2)' EQ '').BB                                    14160042
         AIF   (&DATA(2) EQ &DT).BB                                     14240042
.CC      ANOP                                                           14320042
&DT      SETA  &DATA(2)                                                 14400042
.BB      DC    XL2'FFFE'                                                14480042
         DC    FL1'&DB'                                                 14560042
         DC    FL1'&DT'                                                 14640042
&NRENTS  SETA  &NRENTS+1                                                14720042
.NCDATA  ANOP                                                           14800042
         AIF   ('&LABEL(1)' EQ '').CKLTABS                              14880042
         AIF   (&LABEL(1) EQ &LB).CKLTABS                               14960042
&LB      SETA  &LABEL(1)                                                15040042
         AGO   .AAA                                                     15120042
.CKLTABS AIF   ('&LABEL(2)' EQ '').NCLABEL                              15200042
         AIF   (&LABEL(2) EQ &LT).NCLABEL                               15280042
         AGO   .CCC                                                     15360042
.AAA     AIF   ('&LABEL(2)' EQ '').BBB                                  15440042
         AIF   (&LABEL(2) EQ &LT).BBB                                   15520042
.CCC     ANOP                                                           15600042
&LT      SETA  &LABEL(2)                                                15680042
.BBB     DC    XL2'FFFF'                                                15760042
         DC    FL1'&LB'                                                 15840042
         DC    FL1'&LT'                                                 15920042
&NRENTS  SETA  &NRENTS+1                                                16000042
.NCLABEL ANOP                                                           16080042
         AIF   ('&SKIP' NE '').CONT                                     16160042
         AIF   (&TEST EQ 0).NOCHANG                                     16240042
&S       SETA  &LASTCC                                                  16320042
         AGO   .DEFAULT                                                 16400042
.CONT    ANOP                                                           16480042
         AIF   (&TEST EQ 0).AB                                          16560042
&S       SETA  &SKIP                                                    16640042
.DEFAULT ANOP                                                           16720042
         ORG   &CARRCON+3                                               16800042
         DC    AL.3(0),AL.2(&S),AL.3(1)                                 16880042
         ORG                                                            16960042
&LASTCC  SETA  &S                                                       17040042
&TEST    SETB  0                                                        17120042
         AGO   .DD                                                      17200042
.AB      AIF   (&SKIP EQ &LASTCC).NOCHANG                               17280042
A&SYSNDX DC    XL2'FFFB'                                                17360042
         DC    AL.3(0),AL.2(&SKIP),AL.3(1)                              17440042
         DC    FL1'9'                                                   17520042
&LASTCC  SETA  &SKIP                                                    17600042
&TEST    SETB  1                                                        17680042
&CARRCON SETC  'A&SYSNDX'                                               17760042
&NRENTS  SETA  &NRENTS+1                                                17840042
.DD      ANOP                                                           17920042
.NOCHANG ANOP                                                           18000042
         MEND                                                           18080042
         EJECT                                                          18160042
*  BIN MACRO     BIN MACRO     BIN MACRO     BIN MACRO     BIN MACRO  * 18240042
         SPACE 2                                                        18320042
         MACRO                                                          18400042
         BIN   &LOGITEM,&SKIP$OR                                        18480042
.*                                 &LOGITEM - NAME OF ITEM IN LOG       18560042
.*                                      RECORD DSECT                    18640042
.*                                 &SKIP$OR - NBR OF SPACES TO SKIP ON  18720042
.*                                 MULTIPLE PRINT OR NBR OF SPACES      18800042
.*                                      TO BACK UP FROM COLUMN FOR      18880042
.*                                      START OF PRINTING. THE LETTER   18960042
.*                                      B PRECEEDS THE NUMBER (B5) IF   19040042
.*                                      THE LATTER IS DESIRED. OMISSION 19120042
.*                                      OF THIS OPERAND FORCES OPTION 2 19200042
.*                                      WITH BACKUP SPACING EQUAL TO    19280042
.*                                 THE NUMBER OF BITS IN THE ITEM       19360042
.*                                 DEFINITION (VIA MACRO 'DSGEN').      19440042
.*                            A LIMIT OF 15 BITS IS IMPOSED FOR THE     19520042
.*                                 TOTAL NUMBER OF BITS TO PRINT.       19600042
         GBLC &ITEM(1000)                                               19680042
         GBLA &ITEMNBR,&BITS(1000),&SHIFT(1000),&NRENTS                 19760042
         GBLC  &DSECT                                                   19840042
         LCLB  &B                                                       19920042
         LCLA  &IBITS,&NDX,&ISHIFT,&K                                   20000042
         LCLA  &TEMP,&T                                                 20080042
         LCLC  &S                                                       20160042
.LOOP    ANOP                                                           20240042
&NDX     SETA  &NDX+1                                                   20320042
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      20400042
         AIF   (&NDX LT &ITEMNBR).LOOP                                  20480042
         MNOTE *,'YOU BLEW IT'                                          20560042
         ROUTINE DUM,SKIPPER                                            20640042
         MEXIT                                                          20720042
.FOUND   ANOP                                                           20800042
&ISHIFT  SETA  &SHIFT(&NDX)                                             20880042
&IBITS   SETA  &BITS(&NDX)                                              20960042
&T       SETA  &IBITS-1                                                 21040042
&B       SETB  0                                                        21120042
         AIF   ('&SKIP$OR' EQ '').BACKUP                                21200042
&K       SETA  K'&SKIP$OR                                               21280042
&B       SETB  ('&SKIP$OR'(1,1) EQ 'B')                                 21360042
&S       SETC  '&SKIP$OR'(&B+1,&K-&B)                                   21440042
&T       SETA  &S                                                       21520042
.BACKUP  ANOP                                                           21600042
&NRENTS  SETA  &NRENTS+1                                                21680042
&TEMP    SETA  &ISHIFT                                                  21760042
A&SYSNDX DC    AL.12(&LOGITEM-&DSECT),XL.4'&TEMP'                       21840042
         AIF (&IBITS EQ 1 AND &B EQ 0).OUT                              21920042
         ORG   A&SYSNDX                                                 22000042
&B       SETB  1                                                        22080042
         DC    AL.12(&LOGITEM-&DSECT),XL.4'C'                           22160042
         DC    BL.1'&B',AL.7(&T),AL.4(&IBITS),FL.4'&ISHIFT'             22240042
.OUT     ANOP                                                           22320042
         MEND                                                           22400042
         EJECT                                                          22480042
*  HEX MACRO     HEX MACRO     HEX MACRO    HEXN MACRO     HEX MACRO  * 22560042
         SPACE 2                                                        22640042
         MACRO                                                          22720042
         HEX   &LOGITEM,&SKIP$OR,&BYTES                                 22800042
.*                            THIS MACRO FACILITATES GENERATION OF THE  22880042
.*                                 TABLE ENTRIES SPECIFYING HEX TYPE    22960042
.*                                 CONVERSIONS.                         23040042
.*                            &LOGITEM - NAME OF DATA ITEM TO BE        23120042
.*                                 CONVERTED                            23200042
.*                            &SKIP$OR - NUMBER OF SPACES TO SKIP ON    23280042
.*                                 MULTIPLE PRINT OR NBR OF SPACES TO   23360042
.*                                 BACK UP FROM COLUMN FOR START OF     23440042
.*                                 PRINTING. THE LETTER B PRECEEDS THE  23520042
.*                                 NUMBER (B8) IF THE LATTER OPTION IS  23600042
.*                                 DESIRED. OMISSION OF THIS OPERAND    23680042
.*                                 FORCES OPTION 2 WITH BACKUP SPACING  23760042
.*                                 EQUAL TO THE NUMBER OF BYTES SPECI-  23840042
.*                                 FIED BY THE NEXT OPERAND (TWICE THIS 23920042
.*                                 NUMBER IF SUFFIX IS EXPLICITLY OR    24000042
.*                                 IMPLICITLY B).                       24080042
.*                            &BYTES - NUMBER OF TOTAL INPUT BYTES TO   24160042
.*                                 PROCESS. THIS NUMBER IS SUFFIXED     24240042
.*                                 WITH AN L,R, OR B TO STIPULATE       24320042
.*                                 PRINTING OF THE LEFT HALF, RIGHT     24400042
.*                                 HALF, OR BOTH HALVES OF THE BYTE     24480042
.*                                 RESPECTIVELY. OMISSION OF THIS       24560042
.*                                 OPERAND DEFAULTS TO B WITH THE NUM-  24640042
.*                                 BER OF BYTES EQUAL TO THE ITEM LNGTH 24720042
.*                            A NEW ENTRY IS GENERATED ONLY WHEN NECES- 24800042
.*                                 SARY. THIS MACRO MUST BE THE FIRST   24880042
.*                                 MACRO INSTRUCTION ISSUED FOR THE     24960042
.*                                 SUBJECT LINE(S).                     25040042
         GBLC &ITEM(1000),&DSECT                                        25120042
         GBLA &ITEMNBR,&BITS(1000),&SHIFT(1000),&NRENTS                 25200042
         LCLB  &B                                                       25280042
         LCLA  &IBITS,&NDX,&ISHIFT,&K,&T,&CODE,&BYTESP                  25360042
         LCLC  &S,&LETTER                                               25440042
.LOOP    ANOP                                                           25520042
&NDX     SETA  &NDX+1                                                   25600042
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      25680042
         AIF   (&NDX LT &ITEMNBR).LOOP                                  25760042
         MNOTE *,'LOG ITEM NOT DEFINED'                                 25840042
         MEXIT                                                          25920042
.FOUND   ANOP                                                           26000042
&ISHIFT  SETA  &SHIFT(&NDX)                                             26080042
&IBITS   SETA  &BITS(&NDX)                                              26160042
&CODE    SETA  1                                                        26240042
&K       SETA  K'&BYTES                                                 26320042
         AIF   (&IBITS-(&IBITS/4)*4 EQ 0).OK                            26400042
         MNOTE *,'BIT LENGTH SPECIFICATION INCONSISTENT WITH CONTROL'   26480042
         MEXIT                                                          26560042
.OK      AIF   ('&BYTES' EQ '').USEDEFN                                 26640042
&LETTER  SETC  '&BYTES'(&K,1)                                           26720042
&S       SETC  '&BYTES'(1,&K-1)                                         26800042
&BYTESP  SETA  &S                                                       26880042
         AIF   ('&LETTER' EQ 'B').BOTH                                  26960042
         AIF   (&ISHIFT EQ 0 OR &ISHIFT EQ 4).OK2                       27040042
.ERR     MNOTE *,'DATA NOT ALLIGNED ON HEX OR BYTE BOUNDARY'            27120042
         MEXIT                                                          27200042
.USEDEFN ANOP                                                           27280042
&BYTESP  SETA  &IBITS/8                                                 27360042
.BOTH    AIF   (&ISHIFT NE 0).ERR                                       27440042
&CODE    SETA  3                                                        27520042
&T       SETA  &BYTESP*2-1                                              27600042
&S       SETC  '&T'                                                     27680042
.OK2     AIF   (&ISHIFT EQ 0).L                                         27760042
&CODE    SETA  2                                                        27840042
.L       ANOP                                                           27920042
&B       SETB  1                                                        28000042
         AIF   ('&SKIP$OR' EQ '').BACKUP                                28080042
&K       SETA  K'&SKIP$OR                                               28160042
&B       SETB  ('&SKIP$OR'(1,1) EQ 'B')                                 28240042
&S       SETC  '&SKIP$OR'(&B+1,&K-&B)                                   28320042
.BACKUP  ANOP                                                           28400042
&NRENTS  SETA  &NRENTS+1                                                28480042
         DC    AL.12(&LOGITEM-&DSECT),XL.4'A'                           28560042
         DC    BL.1'&B',FL.7'&S',FL.4'&BYTESP',FL.4'&CODE'              28640042
.OUT     ANOP                                                           28720042
         MEND                                                           28800042
         SPACE 2                                                        28880042
*  ROUTINE MACRO     ROUTINE MACRO     ROUTINE MACRO     ROUTINE MACRO* 28960042
         SPACE 2                                                        29040042
         MACRO                                                          29120042
&NAME    ROUTINE &LOGITEM,&RNAME                                        29200042
         GBLC  &DSECT,&CSECT                                            29280042
         GBLC  &ITEM(1000)                                              29360042
         GBLA  &SHIFT(1000),&ITEMNBR                                    29440042
         GBLA  &NRENTS                                                  29520042
         LCLA  &ISHIFT,&NDX                                             29600042
.LOOP    ANOP                                                           29680042
&NDX     SETA  &NDX+1                                                   29760042
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      29840042
         AIF   (&NDX LT &ITEMNBR).LOOP                                  29920042
         MNOTE *,'LOG ITEM NOT DEFINED'                                 30000042
         MEXIT                                                          30080042
.FOUND   ANOP                                                           30160042
&ISHIFT  SETA  &SHIFT(&NDX)                                             30240042
&NAME    DC    AL.12(&LOGITEM-&DSECT),XL.4'D'                           30320042
         DC    AL.4(&ISHIFT),AL.12(&RNAME-&CSECT)                       30400042
&NRENTS  SETA  &NRENTS+1                                                30480042
         MEND                                                           30560042
         EJECT                                                          30640042
*  LABEL MACRO     LABEL MACRO     LABEL MACRO     LABEL MACRO        * 30720042
         SPACE 2                                                        30800042
         MACRO                                                          30880042
&NAME    LABEL &LABEL1,&LABEL2,&LABEL3,&LABEL4,&LABEL5,&LABEL6,        C30960042
               &LABEL7,&LABEL8                                          31040042
.*                            THIS MACRO ALLOWS UP TO ACHT LABELS TO    31120042
.*                                 BE SPECIFIED FOR A GIVEN LINE. THE   31200042
.*                                 LABELS SHOULD BE ENCLOSED IN QUOTA-  31280042
.*                                 TION MARKS. THE COLUMN AND LINE END  31360042
.*                                 CONTROLS WILL BE INSERTED BY THE     31440042
.*                                 MACRO. OMITTED OPERANDS MEAN NO      31520042
.*                                 LABEL REQUIRED FOR RESPECTIVE        31600042
.*                                 COLUMN. THIS MACRO WILL ALSO ALERT   31680042
.*                                 THE PROGRAMMER TO EXACTLY WHERE THE  31760042
.*                                 TABLE MUST BE BROKEN IF NECESSARY    31840042
.*                                 TO AVOID EXCEEDING THE MAXIMUM LIMIT 31920042
         GBLC &LABELS(2000)                                             32000042
         GBLC  &LBL(100)                                                32080042
         GBLA  &LBLCTR(100)                                             32160042
         GBLA  &LABELNR                                                 32240042
         GBLA  &NRENTS,&LPTR                                            32320042
         LCLC  &MARGIN,&TACK                                            32400042
         LCLC  &TEXT                                                    32480042
         LCLA  &OP,&K,&START,&NRCHAR,&REMAIN                            32560042
&MARGIN  SETC  '*'                                                      32640042
         AIF   ('&NAME' EQ '').LOOPOUT                                  32720042
&LPTR    SETA  &LPTR+1                                                  32800042
&LBL(&LPTR) SETC '&NAME'                                                32880042
&LBLCTR(&LPTR) SETA &LABELNR+1                                          32960042
.LOOPOUT ANOP                                                           33040042
&OP      SETA  &OP+1                                                    33120042
&K       SETA  K'&SYSLIST(&OP)                                          33200042
         AIF (&K GE 2).NORM                                             33280042
&K       SETA  2                                                        33360042
.NORM    ANOP                                                           33440042
&START   SETA  2                                                        33520042
         AIF (&OP LT N'&SYSLIST).NOTLAST                                33600042
&MARGIN  SETC  '$'                                                      33680042
.NOTLAST ANOP                                                           33760042
&NRCHAR  SETA  8                                                        33840042
&TACK    SETC  ''                                                       33920042
.LOOPIN  ANOP                                                           34000042
&REMAIN  SETA  &K-&START                                                34080042
         AIF (&REMAIN GE 8).MORE                                        34160042
&TACK    SETC  '&MARGIN'                                                34240042
&NRCHAR  SETA  &REMAIN                                                  34320042
.MORE    ANOP                                                           34400042
&TEXT    SETC  ''                                                       34480042
         AIF (&REMAIN EQ 0).ENDTEXT                                     34560042
&TEXT    SETC  '&SYSLIST(&OP)'(&START,&NRCHAR)                          34640042
.ENDTEXT ANOP                                                           34720042
&LABELNR SETA  &LABELNR+1                                               34800042
&LABELS(&LABELNR) SETC '&TEXT'.'&TACK'                                  34880042
&START   SETA  &START+8                                                 34960042
         AIF ('&TACK' EQ '').LOOPIN                                     35040042
         AIF ('&TACK' EQ '*').LOOPOUT                                   35120042
         MEND                                                           35200042
         SPACE 2                                                        35280042
         MACRO                                                          35360042
         LSTART                                                         35440042
.*                            THIS MACRO IS ISSUED WHEN THE LABEL AREA  35520042
.*                                 OF THE TABLE IS TO BEGIN.            35600042
         GBLC &LABELS(2000)                                             35680042
         GBLA  &LABELNR                                                 35760042
         GBLC  &LBL(100)                                                35840042
         GBLA  &LBLCTR(100)                                             35920042
         LCLA  &NDX,&CTR                                                36000042
         LINEND                                                         36080042
&CTR     SETA  1                                                        36160042
.LOOP    ANOP                                                           36240042
&NDX     SETA  &NDX+1                                                   36320042
         AIF   (&LBLCTR(&CTR) NE &NDX).NOLBL                            36400042
&LBL(&CTR) DC  C'&LABELS(&NDX)'                                         36480042
&CTR     SETA  &CTR+1                                                   36560042
         AGO   .LOOPCTL                                                 36640042
.NOLBL   ANOP                                                           36720042
         DC    C'&LABELS(&NDX)'                                         36800042
.LOOPCTL AIF   (&NDX LT &LABELNR).LOOP                                  36880042
         MEND                                                           36960042
         SPACE 2                                                        37040042
         MACRO                                                          37120042
         LINEND                                                         37200042
.*                            THIS MACRO IS USED ONLY BY THE LINE       37280042
.*                                 MACRO TO SET THE NUMBER OF ENTRIES   37360042
.*                                 ASSOCIATED WITH EACH LINE.           37440042
         GBLA  &NRENTS                                                  37520042
         GBLC &NRENTSX                                                  37600042
         ORG   &NRENTSX                                                 37680042
         DC    FL1'&NRENTS'                                             37760042
         ORG                                                            37840042
&NRENTS  SETA  0                                                        37920042
B&SYSNDX EQU   *                                                        38000042
&NRENTSX SETC  'B&SYSNDX'                                               38080042
         MEND                                                           38160042
         GBLC  &DSECT,&CSECT                                   @Z40NIVS 38240042
IFCECUA1 CSECT                                                 @Z40NIVS 38320042
&CSECT   SETC  'IFCECUA1'                                      @Z40NIVS 38400042
&DSECT   SETC  'M3420'                                         @Z40NIVS 38480042
M3420    DSECT                                                 @Z40NIVS 38560042
         DSGEN (CLASSRC,8),(SYSREL,8),(SWITCH1,8),(SWITCH2,8), @Z40NIVSC38640042
               (SPARES,32)                                     @Z40NIVS 38720042
         DSGEN (BEGIN,16,EQU,CLASSRC)                          @Z40NIVS 38800042
         ORG   SPARES+1                                                 38820002
         DSGEN (SHRCUA,16)                                              38840002
         ORG                                                            38860002
         DSGEN (DUM1,8),(YEAR,8),(DAY,16),(TIME,32)            @Z40NIVS 38880042
         DSGEN (DUM2,8),(CPUSER,24),(CPUID,16),(DUM3,16)       @Z40NIVS 38960042
         DSGEN (JOBID,64),(FAILCCW1,32),(FAILCCW2,32),(,32),   @Z427VLSC39040042
               (CSW,32),(,8),(SECUA,24),(,32)                  @Z427VLS 39080042
         DSGEN (,8),(PRIMCUA,24),(IORETRY,16),(SNSCNT,16)      @Z40NIVS 39120042
         DSGEN (VOLID,48),(BLKLENG,16),(HDRSER,16),(,16),      @Z427VLSC39200042
               (TEMPRDS,8),                                    @Z427VLSC39240042
               (TEMPWRTS,8),(SIOCNT,16),(PERMRDS,8),           @Z40NIVSC39280042
               (PERMWRTS,8),                                   @Z40NIVSC39360042
               (NOISEBLK,8),(,8),(ERASEGPS,16),(CLNRACTS,16)   @Z40NIVS 39440042
         DSGEN (SPAR,8),(NOISE,8),(RWVRC,8),(MTELRCR,8)        @Z40NIVS 39520042
         DSGEN (EDCCRC,8),(ENVCKVRC,8),(OVERRUN,4),            @Z40NIVSC39600042
               (SKEWCHK,4),                                    @Z40NIVSC39680042
               (CCOMPARE,4),(WRTTRVRC,4)                       @Z40NIVS 39760042
         DSGEN (PEIDCHK,1),(MASKEXP,6),(PARITY,1),             @Z40NIVSC39840042
               (TRKINERR,8),                                   @Z40NIVSC39920042
               (WRTTMCHK,4),(STRDCHK,4),(PARTREC,4),           @Z40NIVSC40000042
               (EXCPAMB,4)                                     @Z40NIVS 40080042
         DSGEN (ORDROP,4),(FEEDTHRU,4),(EXP,4),(EARLBGRD,4),   @Z40NIVSC40160042
               (EARLNDRD,4),(SLBGRD,4),(SLWNDRD,4),            @Z40NIVSC40240042
               (VELRETRY,4),                                   @Z40NIVSC40320042
               (EXP2,4),(VELCHNG,4),(EXP3A,4),(EXP3,4),        @Z40NIVSC40400042
               (BACKWARD,8),                                   @Z40NIVSC40480042
               (BUSOCHK,4),(ALUHRDER,4)                        @Z40NIVS 40560042
         DSGEN (SNB,1,0,23,0,7)                                @Z40NIVS 40640042
         DSGEN (SENSEB,48,EQU,SNB00)                           @Z40NIVS 40720042
         DSGEN (SENSEB1,48,EQU,SNB60)                          @Z40NIVS 40800042
         DSGEN (SENSEB2,48,EQU,SNB120)                         @Z40NIVS 40880042
         DSGEN (SENSEB3,48,EQU,SNB180)                         @Z40NIVS 40960042
         DSGEN (TUSERIAL,24,EQU,SNB150)                        @Z40NIVS 41040042
IFCECUA1 CSECT                                                 @Z40NIVS 41120042
         USING *,R9                                            @Z40NIVS 41200042
         USING M3420,R2                                        @Z40NIVS 41280042
         DC    A(ENTRIES)                                      @Z40NIVS 41360042
         DC    CL8'IFCECUA1'                                   @Z40NIVS 41440042
LINE     DC    F'0'                                            @Z40NIVS 41520042
LABEL    DC    F'0'                                            @Z40NIVS 41600042
RETHRE   DS    CL3                 THESE TWO FIELDS MUST BE    @Z40NIVS 41680042
WRTHRE   DS    CL3                 CONTIGUOUSDEC 20 FROM BEGIN @Z40NIVS 41760042
RETHREH  DS    CL3                 READ THRESHOLD IN HEX       @Z40NIVS 41840042
WRTHREH  DS    CL3                 WRITE THRESHOLD IN HEX      @Z40NIVS 41920042
HIDATE   DC    F'0'                                            @Z40NIVS 42000042
LODATE   DC    X'7FFFFFFF'                                     @Z40NIVS 42080042
CHAINST  DC    F'0'                                            @Z40NIVS 42160042
CHAINEND DC    F'0'                                            @Z40NIVS 42240042
XSAVE    DS    4F                                              @Z40NIVS 42320042
X01SAVE  DS    2F                                              @Z40NIVS 42400042
PGCNT    DC    X'00'                                           @Z40NIVS 42480042
SWTCH    DC    X'00'                                           @Z40NIVS 42560042
L0       EQU   0                                               @Z40NIVS 42640042
L1       EQU   1                                               @Z40NIVS 42720042
L2       EQU   2                                               @Z40NIVS 42800042
L3       EQU   3                                               @Z40NIVS 42880042
L4       EQU   4                                               @Z40NIVS 42960042
L5       EQU   5                                               @Z40NIVS 43040042
L6       EQU   6                                               @Z40NIVS 43120042
L8       EQU   8                                               @Z40NIVS 43200042
L21      EQU   21                                              @Z40NIVS 43280042
L24      EQU   24                                              @Z40NIVS 43360042
L28      EQU   28                                              @Z40NIVS 43440042
L76      EQU   76                                              @Z40NIVS 43520042
L77      EQU   77                                              @Z40NIVS 43600042
L44      EQU   44                                              @Z40NIVS 43680042
L120     EQU   120                                             @Z40NIVS 43760042
L108     EQU   108                                             @Z40NIVS 43840042
L115     EQU   115                                             @Z40NIVS 43920042
L118     EQU   118                                             @Z40NIVS 44000042
L15      EQU   15                                              @Z40NIVS 44080042
L11      EQU   11                                              @Z40NIVS 44160042
R0       EQU   0                                               @Z40NIVS 44240042
R1       EQU   1                                               @Z40NIVS 44320042
R2       EQU   2                                               @Z40NIVS 44400042
R3       EQU   3                                               @Z40NIVS 44480042
R4       EQU   4                                               @Z40NIVS 44560042
R5       EQU   5                                               @Z40NIVS 44640042
R6       EQU   6                                               @Z40NIVS 44720042
R7       EQU   7                                               @Z40NIVS 44800042
R8       EQU   8                                               @Z40NIVS 44880042
R9       EQU   9                                               @Z40NIVS 44960042
R14      EQU   14                                              @Z40NIVS 45040042
R15      EQU   15                                              @Z40NIVS 45120042
CHAR0    EQU   X'F0'                                           @Z40NIVS 45200042
DENS16   EQU   X'04'                                           @Z40NIVS 45280042
BIRCH    EQU   X'08'                                           @Z40NIVS 45360042
DISMOUNT EQU   X'84'                                           @Z40NIVS 45440042
LONG     EQU   X'40'                                           @Z40NIVS 45520042
SHORT    EQU   X'30'                                           @Z40NIVS 45600042
HEADSW   EQU   X'20'                                           @Z40NIVS 45680042
DUMMYR   EQU   X'FE'                                           @Z40NIVS 45760042
DISMONT  EQU   X'04'                                           @Z40NIVS 45840042
HEADPRT  EQU   X'80'                                           @Z40NIVS 45920042
FIVE     EQU   5                                               @Z427VLS 45940042
SIX      EQU   6                                               @Z427VLS 45960042
FOUR     EQU   4                                               @Z40NIVS 46000042
TWELVE   EQU   12                                              @Z40NIVS 46080042
ONE      EQU   1                                               @Z40NIVS 46160042
TWO      EQU   2                                               @Z40NIVS 46240042
L16      EQU   16                                              @Z40NIVS 46320042
UNITCHK  EQU   X'02'                                           @Z40NIVS 46400042
PRINTED  EQU   X'40'                                           @Z40NIVS 46480042
FSTIME   EQU   X'10'                                           @Z40NIVS 46560042
EQUIP    EQU   X'10'                                           @Z40NIVS 46720042
E        EQU   C'E'                                            @Z40NIVS 46800042
B        EQU   C'B'                                            @Z40NIVS 46880042
P        EQU   C'P'                                            @Z40NIVS 46960042
R        EQU   C'R'                                            @Z40NIVS 47040042
T        EQU   C'T'                                            @Z40NIVS 47120042
V        EQU   C'V'                                            @Z40NIVS 47200042
C        EQU   C'C'                                            @Z40NIVS 47280042
W        EQU   C'W'                                            @Z40NIVS 47360042
TAPBOT   EQU   X'60'                                           @Z40NIVS 47440042
ERASE    EQU   X'04'                                           @Z40NIVS 47520042
LOAD     EQU   X'01'                                           @Z40NIVS 47600042
L        EQU   C'L'                                            @Z40NIVS 47680042
PRESS    EQU   X'02'                                           @Z40NIVS 47760042
RESETKY  EQU   X'10'                                           @Z40NIVS 47840042
TACH     EQU   X'04'                                           @Z40NIVS 47920042
VELOC    EQU   X'01'                                           @Z40NIVS 48000042
WRITE    EQU   X'04'                                           @Z40NIVS 48080042
HIGH     EQU   2                                               @Z40NIVS 48160042
ZERO     DC    XL2'0000'                                       @Z427VLS 48200042
         SPACE 2                                               @Z40NIVS 48240042
ROUTER   STM   R5,R8,XSAVE         SAVE THE REGISTERS          @Z40NIVS 48320042
HEADER   TM    SWTCH,HEADSW        HAS HEADER BEEN PRINTED     @Z40NIVS 48400042
         BZ    ROUT1               NO, GO PRINT IT             @Z40NIVS 48480042
         TM    L4(R2),DUMMYR       IS THIS DUMMY RECORD        @Z40NIVS 48560042
         BO    ANYTHR              YES, GO SEE IF ANY PRINTED  @Z40NIVS 48640042
DATE     CLC   L8(L4,R4),HIDATE    DATE HIGHER THAN PREV HIGH? @Z40NIVS 48720042
         BNH   CHKLO               NO,CHECK LOW DATE                    48800002
         MVC   HIDATE,L8(R4)       SET NEW HIGH DATE                    48840002
CHKLO    CLC   L8(L4,R4),LODATE    DATE LOWER THAN PREV LOW?   @Z40NIVS 48880042
         BNL   CHKTHR              NO CHECK THRESHOLD                   48960002
UPLO     MVC   LODATE,L8(R4)       SET NEW LOW DATE            @Z40NIVS 49280042
*        B     CKTHR               GO CHECK                    @Z40NIVS 49360042
*                                  THRESHOLD                   @Z40NIVS 49440042
         SPACE 2                                               @Z40NIVS 49520042
CHKTHR   TM    L3(R2),DISMOUNT     IS THIS A DISMOUNT?         @XA22537 49600001
         BZ    CHKUC               NO, GO SEE IF UNIT CHECK    @Z40NIVS 49680042
         CLC   L76(L1,R4),RETHREH+TWO  READS EXCEED THRESHOLD  @Z40NIVS 49760042
         BNL   PRCUAREC            YES, PRINT THIS RECORD      @Z40NIVS 49840042
         CLC   L77(L1,R4),WRTHREH+TWO  WRITES EXCEED THRESHOLD?@Z40NIVS 49920042
         BL    CHKUC               RETURN WITHOUT PRINT                 50000002
PRCUAREC TM    SWTCH,HEADPRT       HAS HEADER BEEN PRINTED     @Z40NIVS 50160042
         BZ    PRTHDR              NO, GO PRINT IT             @Z40NIVS 50240042
         LA    R5,DETLINE-FOUR     CUA LINE ADDRESS            @Z40NIVS 50320042
         LA    R6,DETLABEL-ONE     CUA LABEL ADDRESS           @Z40NIVS 50400042
         STM   R5,R6,LINE          MAKE THEM CURRENT           @Z40NIVS 50480042
*        B     SKIPPRNT            RETURN                      @Z40NIVS 50560042
*                                  WITHOUT PRINT               @Z40NIVS 50640042
SKIPPRNT SR    R15,R15             ZERO R15 FOR NO PRINT       @Z40NIVS 50720042
RETURN   LM    R5,R8,XSAVE         RESTORE THE REGS            @Z40NIVS 50800042
         BR    R14                 RETURN                      @Z40NIVS 50880042
ROUT1    OI    SWTCH,HEADSW        SET HEADER SWITCH           @Z40NIVS 50960042
         PACK  DECBYTES+L6(L2),RETHRE(L3)  PACK THRESHOLD      @Z40NIVS 51040042
         CVB   R5,DECBYTES         CONVERT TO HEX              @Z40NIVS 51120042
         ST    R5,DECBYTES         STORE FOR MOVE              @Z40NIVS 51200042
         MVC   RETHREH(L3),DECBYTES+ONE  MOVE TO HEX FIELD     @Z40NIVS 51280042
         XC    DECBYTES(L8),DECBYTES CLEAR FOR NEXT USE        @Z40NIVS 51360042
         PACK  DECBYTES+L6(L2),WRTHRE PACK WRITE THRESHOLD     @Z40NIVS 51440042
         CVB   R5,DECBYTES         CONVERT TO HEX              @Z40NIVS 51520042
         ST    R5,DECBYTES         STORE FOR MOVE              @Z40NIVS 51600042
         MVC   WRTHREH(L3),DECBYTES+ONE                        @Z40NIVS 51680042
         XC    DECBYTES(L8),DECBYTES                           @Z40NIVS 51760042
         LA    R5,RPTLINE-FOUR     GET REPORT HEADER LINE      @Z40NIVS 51840042
         LA    R6,RPTLABEL-ONE     GET REPORT LABEL ADDRESS    @Z40NIVS 51920042
         STM   R5,R6,LINE          MAKE THEM CURRENT           @Z40NIVS 52000042
         B     SKIPPRNT            RETURN WITHOUT PRINT        @Z40NIVS 52080042
         SPACE 2                                               @Z40NIVS 52160042
PRTHDR   OI    SWTCH,HEADPRT       INDICATE HEADER PRINTED     @Z40NIVS 52240042
         LA    R5,CUALINE-FOUR     GET CUA HEADER LINE         @Z40NIVS 52320042
         LA    R6,CUALABEL-ONE     GET CUA HEADER LABEL        @Z40NIVS 52400042
         STM   R5,R6,LINE          MAKE THEM CURRENT           @Z40NIVS 52480042
         B     SKIPPRNT            RETURN WITHOUT PRINT        @Z40NIVS 52560042
THRHDR   MVC   L0(L3,R3),RETHRE    MOVE IN RD THRESHOLD VALUE  @Z40NIVS 52640042
         MVC   L16(L3,R3),WRTHRE   MOVE IN WRITE THRESHOLD     @Z40NIVS 52720042
         BR    14                  RETURN                      @Z40NIVS 52800042
CHKUCSV  STM   R5,R8,XSAVE         SAVE REGS                   @Z40NIVS 52880042
CHKUC    TM    L44(R2),UNITCHK     UNIT CHECK RECORD?          @Z40NIVS 52960042
         BZ    SKIPPRTT            NO, RETURN WITHOUT PRINTING @Z40NIVS 53040042
         OI    SWTCH,PRINTED       AT LEAST ONE PRINTED        @Z40NIVS 53120042
         LA    R5,UCLINE-FOUR      GET UNIT CHECK LINE         @Z40NIVS 53200042
         LA    R6,UCLABEL-ONE      GET UNIT CHECK LABEL        @Z40NIVS 53280042
         STM   R5,R6,LINE          MAKE THEM CURRENT           @Z40NIVS 53360042
         B     SKIPPRNT            RETURN WITHOUT PRINT        @Z40NIVS 53440042
SKIPPRTT LA    R5,SKIPLINE-FOUR    GET NULL LINE               @Z40NIVS 53520042
         LA    R6,SKIPLABL-ONE     GET NULL LABLE              @Z40NIVS 53600042
         STM   R5,R6,LINE          MAKE THEM CURRENT           @Z40NIVS 53680042
         B     SKIPPRNT            RETURN WITHOUT PRINT        @Z40NIVS 53760042
CHAIN    STM   R0,R1,X01SAVE       SAVE REGS                   @Z40NIVS 53840042
         STM   R5,R8,XSAVE         SAVE REGS                   @Z40NIVS 53920042
         GETMAIN R,LV=128          GET STORAGE FOR RECORD      @Z40NIVS 54000042
         LM    R5,R6,CHAINST       GET CHAIN POINTERS          @Z40NIVS 54080042
         XC    L0(L4,R1),L0(R1)    ZERO FORWARD POINTER        @Z40NIVS 54160042
         LTR   R5,R5               DOES CHAIN EXIST YET?       @Z40NIVS 54240042
         BNZ   NOTNEW              YES, GO CHAIN NEW ENTRY     @Z40NIVS 54320042
         ST    R1,CHAINST          ESTABLISH CHAIN START       @Z40NIVS 54400042
         ST    R1,CHAINEND         AND END                     @Z40NIVS 54480042
         B     MOVEDATA            GO MOVE IN RECORD           @Z40NIVS 54560042
NOTNEW   ST    R1,CHAINEND         ESTABLISH NEW CHAIN END     @Z40NIVS 54640042
         ST    R1,L0(R6)           FORWARD CHAIN FROM LAST     @Z40NIVS 54720042
MOVEDATA L     R3,LINEADDR         GET DATA ADDRESS            @Z40NIVS 54800042
         MVC   L4(L120,R1),L0(R3)  MOVE IN RECORD              @Z40NIVS 54880042
         LM    R0,R1,X01SAVE       RESTORE REGS                @Z40NIVS 54960042
         B     SKIPPRNT            RETURN WITHOUT PRINT        @Z40NIVS 55040042
ANYTHR   STM   R5,R8,XSAVE         SAVE REGS                   @Z40NIVS 55120042
         TM    SWTCH,HEADPRT       ANY THRESHOLD RECORDS?      @Z40NIVS 55200042
         BO    SEPARATR            YES, BRANCH                 @Z40NIVS 55280042
         LA    R5,NOTHRLNE-FOUR    GET ADDRESS OF 'NONE' MSG   @Z40NIVS 55360042
         LA    R6,NOTHRLBL-ONE     GET ADDRESS OF LABEL        @Z40NIVS 55440042
         STM   R5,R6,LINE          MAKE THEM CURRENT           @Z40NIVS 55520042
         B     SKIPPRNT            RETURN WITHOUT PRINT        @Z40NIVS 55600042
ENTSEP   STM   R5,R8,XSAVE         SAVE THE REGS               @Z40NIVS 55680042
SEPARATR LA    R5,SEPLINE-FOUR     GET SEPARATOR LINE          @Z40NIVS 55760042
         LA    R6,SEPLABEL-ONE     GET SEPARATOR LABEL         @Z40NIVS 55840042
         STM   R5,R6,LINE          MAKE THEM CURRENT           @Z40NIVS 55920042
         B     SKIPPRNT            RETURN WITHOUT PRINT        @Z40NIVS 56000042
SEPDEC   STM   R5,R8,XSAVE         SAVE REGS                   @Z40NIVS 56080042
FIR      TM    SWTCH,FSTIME        FIRST TIME?                 @Z40NIVS 56160042
         BZ    UCDEC               YES, GO SEE IF SEP NEEDED   @Z40NIVS 56240042
         MVI   SWTCH,L0            ELSE GET READY TO EXIT      @Z427VLS 56320042
         LA    R5,SKIPLINE-FOUR    GET NULL LINE               @Z40NIVS 56400042
         LA    R6,SKIPLABL-ONE     GET NULL LABEL              @Z40NIVS 56480042
         STM   R5,R6,LINE          MAKE THEM CURRENT           @Z40NIVS 56560042
         B     SKIPPRNT            RETURN WITHOUT PRINT        @Z40NIVS 56640042
UCDEC    OI    SWTCH,FSTIME        SET FIRST TIME SWITCH       @Z40NIVS 56720042
         LA    R5,UCHLINE-FOUR     GET UNIT CHECK  LINE        @Z40NIVS 56800042
         LA    R6,UCHLABEL-ONE     GET UNIT CHECK LABEL        @Z40NIVS 56880042
         STM   R5,R6,LINE          MAKE THEM CURRENT           @Z40NIVS 56960042
         B     SKIPPRNT            RETURN WITHOUT PRINT        @Z40NIVS 57040042
NOUCRS   LA    R5,NOUCLINE-FOUR    GET 'NONE' LINE                      57120002
         LA    R6,NOUCLABL-ONE     GET 'NONE'LABEL             @Z40NIVS 57280042
         STM   R5,R6,LINE          MAKE THEM CURRENT           @Z40NIVS 57360042
         B     SKIPPRNT            RETURN WITHOUT PRINT        @Z40NIVS 57440042
CKNOUC   STM   R5,R8,XSAVE         SAVE THE REGS               @Z40NIVS 57520042
         TM    SWTCH,LONG              ANY UNIT CHECKS         @Z40NIVS 57600042
         BZ    NOUCRS              NO, BRANCH                  @Z40NIVS 57680042
         LA    R5,FIRUCLI-FOUR     GET UC HEADER LINE          @Z40NIVS 57760042
         LA    R6,FIRUCLA-ONE      GET UC HEADER LABEL         @Z40NIVS 57840042
         STM   R5,R6,LINE          MAKE THEM CURRENT           @Z40NIVS 57920042
         B     SKIPPRNT            RETURN WITHOUT PRINT        @Z40NIVS 58000042
UNCHAIN  STM   R5,R8,XSAVE         SAVE REGS                   @Z40NIVS 58080042
         L     R5,CHAINST          GET RECORD ADDRESS          @Z40NIVS 58160042
         LTR   R5,R5               DOES IT EXIST?              @Z40NIVS 58240042
         BZ    NOTES               NO, GO PUT OUT CE NOTES     @Z40NIVS 58320042
         MVC   L0(L120,R3),L4(R5)  MOVE IN RECORD              @Z40NIVS 58400042
         STM   R0,R1,X01SAVE       SAVE REGS                   @Z40NIVS 58480042
         MVC   CHAINST,L0(R5)      SET NEW CHAIN START         @Z40NIVS 58560042
         FREEMAIN R,LV=128,A=(R5)  FREE THIS RECORD            @Z40NIVS 58640042
         LM    R0,R1,X01SAVE       RESTORE REGS                @Z40NIVS 58720042
         LM    R5,R8,XSAVE         RESTORE REGS                @Z40NIVS 58800042
         LA    R15,ONE             SET R15 NON-ZERO            @Z40NIVS 58880042
         BR    R14                                             @Z40NIVS 58960042
NOTES    LA    R5,NOTELINE-FOUR    GET ADDRESS OF NOTE LINE    @Z40NIVS 59040042
         LA    R6,NOTELABL-ONE     AND LABEL                   @Z40NIVS 59120042
         STM   R5,R6,LINE          MAKE THEM CURRENT           @Z40NIVS 59200042
         B     SKIPPRNT            RETURN WITHOUT PRINTING     @Z40NIVS 59280042
RECHAIN  STM   R5,R8,XSAVE         SAVE REGS                   @Z40NIVS 59360042
         LA    R5,CHNLINE-FOUR     GET CHAIN LINE              @Z40NIVS 59440042
         LA    R6,CHNLABEL-ONE     GET CHAIN LABEL             @Z40NIVS 59520042
         STM   R5,R6,LINE          MAKE THEM CURRENT           @Z40NIVS 59600042
         B     SKIPPRNT            RETURN WITHOUT PRINT        @Z40NIVS 59680042
ERDECODE STM   R5,R8,XSAVE         SAVE REGS                   @Z40NIVS 59760042
         TM    L44(R4),UNITCHK     IS THIS UNIT CHECK?         @Z40NIVS 59840042
         BZ    NOTUC1              NO, BRANCH                  @Z40NIVS 59920042
         TM    L108(R4),EQUIP      EQUIPMENT CHECK?            @Z40NIVS 60000042
         BZ    NOTUC               NO, BRANCH                  @Z40NIVS 60080042
         MVI   L0(R3),E            MOVE IN THE E               @Z40NIVS 60160042
         MVI   L1(R3),B            MOVE IN THE B               @Z40NIVS 60240042
         TM    L115(R4),TAPBOT     IS IT TAPE BOTTOM?          @Z40NIVS 60320042
         BNZ   REPOSIT             YES, BRANCH                 @Z40NIVS 60400042
         MVI   L1(R3),E            INDICATE ERASE FAILURE      @Z40NIVS 60480042
         TM    L115(R4),ERASE      IS IT?                      @Z40NIVS 60560042
         BO    REPOSIT             YES, BRANCH                 @Z40NIVS 60640042
         MVI   L1(R3),L            INDICATE LOAD FAILURE       @Z40NIVS 60720042
         TM    L115(R4),LOAD       IS IT?                      @Z40NIVS 60800042
         BO    REPOSIT             YES, BRANCH                 @Z40NIVS 60880042
         MVI   L1(R3),P            AIR BEARING PRESSURE        @Z40NIVS 60960042
         TM    L115(R4),PRESS      IS IT?                      @Z40NIVS 61040042
         BO    REPOSIT             YES, BRANCH                 @Z40NIVS 61120042
         MVI   L1(R3),R            INDICATE RESET KEY          @Z40NIVS 61200042
         TM    L115(R4),RESETKY    IS IT?                      @Z40NIVS 61280042
         BO    REPOSIT             YES, BRANCH                 @Z40NIVS 61360042
         MVI   L1(R3),T            INDICATE TACH START FAILURE @Z40NIVS 61440042
         TM    L118(R4),TACH       IS IT?                      @Z40NIVS 61520042
         BO    REPOSIT             YES, BRANCH                 @Z40NIVS 61600042
         MVI   L1(R3),V            INDICATE VELOCITY CHECK     @Z40NIVS 61680042
         TM    L118(R4),VELOC      IS IT?                      @Z40NIVS 61760042
         BO    REPOSIT             YES, BRANCH                 @Z40NIVS 61840042
         MVI   L1(R3),C            INDICATE CAUSE UNKNOWN      @Z40NIVS 61920042
         B     REPOSIT             GO POSITION R3              @Z40NIVS 62000042
NOTUC1   MVI   L0(R3),P            MOVE IN P                   @Z40NIVS 62080042
         MVI   L1(R3),E            MOVE IN E                   @Z40NIVS 62160042
         B     REPOSIT             GO SET UP R3                @Z40NIVS 62240042
NOTUC    MVI   L0(R3),P            INDICATE PERMANENT ERROR    @Z40NIVS 62320042
         MVI   L1(R3),W            INDICATE PERMANENT WRITE    @Z40NIVS 62400042
         TM    SNB10,WRITE         IS IT?                      @Z40NIVS 62480042
         BO    REPOSIT             YES, BRANCH                 @Z40NIVS 62560042
         MVI   L1(R3),R            INDICATE PERMANENT READ     @Z40NIVS 62640042
REPOSIT  LA    R5,L3               CONSTANT THREE              @Z40NIVS 62720042
         SR    R3,R5               BACK UP THREE POSITIONS     @Z40NIVS 62800042
         LM    R5,R8,XSAVE         RESTORE REGS                @Z40NIVS 62880042
         BR    R14                 RETURN TO PRINT LINE        @Z40NIVS 62960042
MVVOL    MVC   L0(L6,R3),L0(R4)    MOVE IN VOL SER             @Z40NIVS 63040042
         BR    R14                 RETURN TO PRINT LINE        @Z40NIVS 63120042
MVJOB    MVC   L0(L8,R3),L0(R4)    MOVE IN JOBID               @Z40NIVS 63200042
         LA    R3,L3(R3)           BUMP THREE POSITIONS        @Z40NIVS 63280042
         BR    R14                 RETURN TO PRINT LINE        @Z40NIVS 63360042
MVHIDATE UNPK  L0(L5,R3),HIDATE    UNPACK DATE                          63440002
         BR    R14                                                      63540002
MVLODATE UNPK  L0(L5,R3),LODATE    UNPACK DATE                          63640002
         BR    R14                 RETURN                      @Z40NIVS 63760042
NOZEROES LA    R4,TWELVE           CONSTANT 12                 @Z40NIVS 63840042
         SR    R3,R4               BACKUP                      @Z40NIVS 63920042
         ST    R3,LINEADDR         SAVE LINE ADDRESS           @Z40NIVS 64000042
         MVC   L0(L3,R3),L3(R3)    OVERLAY THE ZEROES          @Z40NIVS 64080042
         MVC   L3(L3,R3),L8(R3)    MOVE IN BLANKS              @Z40NIVS 64160042
         LA    R4,ONE              CONSTANT ONE                @Z40NIVS 64240042
         SR    R3,R4               DECREMENT PRINT POINTER     @Z40NIVS 64320042
         BR    R14                 RETURN                      @Z40NIVS 64400042
CHECKSER LA    R4,TWELVE           CONSTANT 12                 @Z40NIVS 64480042
         SR    R3,R4               BACKUP                      @Z40NIVS 64560042
         CLC   L0(L6,R3),ZEROS     IS SERIAL ZEROES?           @Z40NIVS 64640042
         BNER  R14                 RETURN IF NOT               @Z40NIVS 64720042
         MVC   L0(L6,R3),NA1                                   @Z40NIVS 64800042
         BR    R14                 RETURN                      @Z40NIVS 64880042
BACK6    BCTR  R3,R0               DECREMENT BY 6                       64960002
BACK5    BCTR  R3,R0               DECREMENT BY 5                       65030002
BACK4    BCTR  R3,R0               DECREMENT BY 4                       65100002
BACK3    BCTR  R3,R0               DECREMENT BY 3                       65170002
         BCTR  R3,R0               DECREMENT BY 2                       65240002
         BCTR  R3,R0               DECREMENT BY 1                       65310002
         BR    R14                 RETURN                      @Z427VLS 65420042
SETBINA  STM   R5,R8,STOREREG      SAVE REGISTERS              @Z40NIVS 66000042
         LR    R8,R3               PUT LINE POINTER TO REGISTER@Z40NIVS 66080042
         LA    R5,L8               PUT COUNTER IN REGISTER     @Z40NIVS 66160042
         IC    R7,L0(R4)           GET THE BYTE TO PRINT       @Z40NIVS 66240042
         SLL   R7,L24              SHIFT TO LOW BIT POSITIONS  @Z40NIVS 66320042
CHNGBITS SR    R6,R6               CLEAR REGISTER              @Z40NIVS 66400042
         SLDL  R6,L1               MOVE ONE BIT INTO REG       @Z40NIVS 66480042
         STC   R6,L0(R8)           STORE THE BIT ON PRINT LINE @Z40NIVS 66560042
         OI    L0(R8),CHAR0       MOVE ZONE TO MAKE IT A PRINTABLE CHAR 66640042
         LA    R8,L1(R8)           INCREMENT PRINT LINE        @Z40NIVS 66720042
         BCT   R5,CHNGBITS         ALL BITS BEEN PRINTED       @Z40NIVS 66800042
         LM    R5,R8,STOREREG      RESTORE REGISTERS           @Z40NIVS 66880042
DONOTHNG BR    R14                 RETURN                      @Z40NIVS 66960042
PUTVOL   MVC   L21(L6,R3),VOLID    MOVE VOLID TO PRINT LINE    @Z40NIVS 67040042
         LA    R3,L6(R3)           SET PRINT BUFFER POINTER    @Z40NIVS 67120042
         CLC   SNSCNT(L2),NINER   IF MORE THAN NINE SENSE BYTES@Z40NIVS 67200042
*        THE COUNTER IS VALID AND PUT IN THE                   @Z40NIVS 67280042
*                                  PRINTOUT                    @Z40NIVS 67360042
         BNH   NOTAPP             ONLY 9 SENSE PUT N/A         @Z40NIVS 67440042
         CLC   TUSERIAL(L2),ZERO   IS THIS AN OLD STYLE RECORD?         67520042
         BH    TWOBYTES            YES, GO TO CONVERT IT       @Z427VLS 67600042
         B     NOTAPP              NO PUT IN N/A               @Z40NIVS 67680042
SERHDR   CLC   HDRSER(L2),ZERO     IS ZERO # IN HEADER 2 OF REC         67700042
         BH    TWOBYTES            YES, GO TO CONVER IT        @Z427VLS 67720042
         B     NOTAPP              NO, PUT IN N/A              @Z427VLS 67740042
*                                                                     * 67760042
*  THE NRZI NOISE COUNTER IS ONLY VALID FOR NRZI TAPES - - THE 1600   * 67840042
* BPI BIT IS CHECKED TO SEE IF IT IS A PE TAPE -- IF IT IS WE RETURN  * 67920042
* WITHOUT PRINTING THE COUNTER VALUE SINCE IT IS INVALID              * 68000042
*                                                                     * 68080042
CHKNRZI  LA    R4,NOISE            ADDRESS OF NOISE CTR FOR CONV        68160042
         CLC   TUSERIAL(L2),ZERO   IS THIS AN OLD STYLE RECORD @Z427VLS 68190042
         BNH   NOTAVAIL                                        @Z427VLS 68220042
         TM    SNB30,DENS16        1600 BPI?                   @Z427VLS 68250042
         BO    NOTAVAIL                                        @Z427VLS 68280042
         TM    SNB60,BIRCH         6250 BPI?                   @Z427VLS 68310042
         BNO   ONEBYTE             NO, PUT IN DENSITY          @Z427VLS 68340042
NOTAVAIL MVC   L1(L3,R3),NA        YES, PUT IN N/A IN PRINT BUFFER      68370042
         LA    R3,L4(R3)           INCREMENT PRINT BUFFER PTR  @Z427VLS 68400042
         BR    R14                 EXIT                        @Z427VLS 68430042
*                                                                     * 68640042
*                                                                     * 68720042
*                                                                     * 68800042
*THIS ROUTINE WILL TAKE A ONE BYTE COUNTER FROM THE LOGREC ENTRY AND  * 68880042
* CONVERT IT TO EBCDIC AND PUT IT INTO THE PRINT BUFFER               * 68960042
* IT IS ALSO USED TO CONVERT WHATEVER BINARY VALUE THAT IS IN R4 TO   * 69040042
* A PRINTABLE FORM.R6 MUST BE SET TO THE LENGTH OF THE RECEIVING FIELD* 69120042
* FOR THE EXECUTE INSTRUCTION                                         * 69200042
*                                                                     * 69280042
ONEBYTE  STM   R5,R8,STOREREG      STORE REGISTERS             @Z40NIVS 69360042
         SR    R5,R5               CLEAR REGISTER5             @Z40NIVS 69440042
         IC    R5,L0(R4)           GET THE BYTE TO BE CONVERTED@Z40NIVS 69520042
PROCDEC  LA    R8,INLINE           LOAD THE RETURN ADDRESS     @Z40NIVS 69600042
         LA    R6,SHORT            GET LENGTH FOR EXECUTE INSTRUCTION   69680042
CONVERT  CVD   R5,DECBYTES         CONVERT TO DECIMAL          @Z40NIVS 69760042
         EX    R6,UNPACK           UNPACK INTO THE PRINT BUFFER@Z40NIVS 69840042
         BR    R8                  RETURN TO INLINE PROCESSING @Z40NIVS 69920042
INLINE   OI    L3(R3),CHAR0        MAKE THE LAST CHAR A PRINTABLE NBR   70000042
         LM    R5,R8,STOREREG      RELOAD REGISTERS            @Z40NIVS 70080042
         LA    R3,L4(R3)           INCREMENT PRINT BUFFER PTR  @Z40NIVS 70160042
         BR    R14                 RETURN                      @Z40NIVS 70240042
UNPACK   UNPK  L0(L1,R3),DECBYTES(L8) UNPACK NUMBER5 TO PRINT LINE      70320042
*                                                                     * 70400042
* THIS ROUTINE IS USED TO ISOLATE THE RIGHT HALF OF A BYTE AND GOES   * 70480042
* TO HAVE IT CONVERTED TO PRINTABLE FORM                              * 70560042
*                                                                     * 70640042
RGHTHALF STM   R5,R8,STOREREG      STORE REGISTERS             @Z40NIVS 70720042
         SR    R5,R5               CLEAR REGISTER              @Z40NIVS 70800042
         IC    R5,L0(R4)           GET A BYTE FROM RECORD      @Z40NIVS 70880042
         SLL   R5,L28              GET RID OF LOW ORDER BITS   @Z40NIVS 70960042
         SRL   R5,L28              MOVE BACK                   @Z40NIVS 71040042
         B     PROCDEC             GO TO CONVERT IT            @Z40NIVS 71120042
*                                                                     * 71200042
NOTAPP   MVC   L1(L3,R3),NA        MOVE N/A TO PRINT BUFFER IF @Z40NIVS 71280042
         BR    R14                 COUNTER IS NOT VALID        @Z40NIVS 71360042
CHKDEV   CLC   SNSCNT(L2),NINER    IF MORE THAN 9 SENSE BYTES THE       71440042
*                                  COUNTER IS VALID AND PUT IN THE      71520042
*                                  PRINTOUT                    @Z40NIVS 71600042
         BC    HIGH,RGHTHALF       YES IT IS GO PUT IT OUT     @Z40NIVS 71680042
         MVC   L0(L3,R3),NA        MOVE NA TO PRINT BUFFER     @Z40NIVS 71760042
         LA    R3,L4(R3)           INCREMENT PRINT BUFFER PTR  @Z40NIVS 71840042
         BR    R14                 RETURN CONTROL              @Z40NIVS 71920042
*                                                                     * 72000042
* USED TO GET A HALFWORD COUNTER FROM THE RECORD AND GOES TO HAVE IT  * 72080042
* CONVERTED TO PRINTABLE FORM.RETURNS TO HAVE THE ZONE CHANGED BECAUSE* 72160042
* THIS WILL BE REPRESENTED AS A FIVE DIGIT NUMERAL RATHER THAN A FOUR * 72240042
* DIGIT AS THE SINGLE AND HALF BYTE COUNTERS.                         * 72320042
*                                                                     * 72400042
TWOBYTES STM   R5,R8,STOREREG      STORE REGISTERS             @Z40NIVS 72480042
         MVC   HALFCNTR(L2),L0(R4) MOVE THE COUNTER TO STORAGE @Z40NIVS 72560042
         L     R5,FULLCNTR         PUT THE COUNTER INTO A REGISTER      72640042
         LA    R6,LONG             GET LENGTH FOR EXECUTE INSTRUCTION   72720042
         BAL   R8,CONVERT          GO TO CONVERT THE NUMBER TO EBCDIC   72800042
         OI    L4(R3),CHAR0        MAKE LAST CHARACTER PRINTABLE        72880042
         LM    R5,R8,STOREREG      RESTORE REGISTERS           @Z40NIVS 72960042
         BR    R14                 RETURN                      @Z40NIVS 73040042
*                                                                     * 73120042
* THIS CODE WILL TAKE THE DATE FROM THE RECORD UNPACK IT AND PUT IT   * 73200042
* IN THE PRINT BUFFER.                                                * 73280042
*                                                                     * 73360042
SETDATE  UNPK  DECBYTES(L5),L0(L3,R4) UNPACK THE DATE          @Z40NIVS 73440042
         LA    R3,L6(R3)           BUMP PRINT POSITION         @Z40NIVS 73520042
         MVC   L0(L3,R3),DECBYTES+L2 MOVE IN DAY               @Z40NIVS 73600042
         OI    L2(R3),CHAR0        OR IN SIGN                  @Z40NIVS 73680042
         MVC   L4(L2,R3),DECBYTES  MOVE IN YEAR                @Z40NIVS 73760042
         LA    R3,L15(R3)          BUMP PRINT POSITION         @Z40NIVS 73840042
         BR    R14                 RETURN                      @Z40NIVS 73920042
SETDATE1 UNPK  DECBYTES(L5),L0(L3,R4) UNPACK THE DATE          @Z40NIVS 74000042
         MVC   L0(L5,R3),DECBYTES  MOVE TO PRINT POSITIONS     @Z40NIVS 74080042
         OI    L4(R3),CHAR0        OR IN SIGN                  @Z40NIVS 74160042
         BR    R14                 RETURN                      @Z40NIVS 74240042
*                                                                     * 74320042
* THE FOLLOWING ARE ROUTINES TO INCREMENT THE PRINT BUFFER POINTER.   * 74400042
*                                                                     * 74480042
*                                                                     * 74560042
ADD11    LA    R3,L5(R3)           ADD 11                               74580002
ADD6     LA    R3,L2(R3)           ADD 6                                74600002
ADD4     LA    R3,L1(R3)           ADD 4                                74620002
ADD3     LA    R3,L3(R3)          INCREMENT PRINT POSITION BY 3 BYTES   74640042
         BR    R14                                             @Z40NIVS 74720042
         BR    R14                                             @Z40NIVS 75040042
*                                                                     * 75120042
* THIS CODE INSPECTS THE SENSE BITS TO DETERMINE WHAT DENSITY IS TO   * 75200042
* BE PUT IN THE PRINT BUFFER..                                        * 75280042
*                                                                     * 75360042
*                                                                     * 75440042
*                                                                     * 75520042
WHATDENS CLC   TUSERIAL(L2),ZERO   IS THIS AN OLD STYLE RECORD?         75600042
         BNH   NOTAPP                                          @Z427VLS 75680042
CHKDENS  TM    SNB30,DENS16        IS THIS A 1600 BPI DRIVE    @Z40NIVS 75760042
         BO    PUT1600             YES PUT IT IN PRINTOUT      @Z40NIVS 75840042
         TM    SNB60,BIRCH         IS THIS A NEW DRIVE         @Z40NIVS 75920042
         BO    PUT6250             YES PUT IN 6250             @Z40NIVS 76000042
PUT800   MVC   L0(L3,R3),BPI800    PUT 800 IN PRINT BUFFER     @Z40NIVS 76080042
         BR    R14                 RETURN                      @Z40NIVS 76160042
PUT1600  MVC   L0(L4,R3),BPI1600   PUT 1600 IN PRINT BUFFER    @Z40NIVS 76240042
         BR    R14                 RETURN                      @Z40NIVS 76320042
PUT6250  MVC   L0(L4,R3),BPI6250   MOVE IN BPI                 @Z40NIVS 76400042
         BR    R14                                             @Z40NIVS 76480042
BPI800   DC    CL3'800'                                        @Z40NIVS 76560042
BPI1600  DC    CL4'1600'                                       @Z40NIVS 76640042
BPI6250  DC    CL4'6250'                                       @Z40NIVS 76720042
DECAREA  DC    CL5' '                                          @Z427VLS 76800042
NINER    DC    H'9'                                            @Z40NIVS 76880042
LINEADDR DS    F                                               @Z40NIVS 76960042
DECBYTES DC    D'0'                                            @Z40NIVS 77040042
STOREREG DC    6F'0'                                           @Z40NIVS 77120042
FULLCNTR EQU   STOREREG+20                                     @Z40NIVS 77200042
HALFCNTR EQU   STOREREG+22                                     @Z40NIVS 77280042
ZEROS    DC    C'000000'                                       @Z40NIVS 77360042
NA1      DC    C'  '                                                    77440042
NA       DC    CL3'N/A'                                        @Z40NIVS 77520042
         DC    C'  '                                                    77600042
SWIND    DC    X'00'                                           @Z40NIVS 77680042
*                                                                     * 77760042
*                                                                     * 77840042
ENTRIES  DS    0F                                              @Z40NIVS 77920042
         DC    XL4'00'                                         @Z40NIVS 78000042
         DC    XL4'00'                                         @Z40NIVS 78080042
         DC    A(LABELS)                                       @Z40NIVS 78160042
         DC    H'0'                                            @Z40NIVS 78240042
         LINE                                                           78320042
         ROUTINE BEGIN,ROUTER                                  @Z40NIVS 78400042
         LABEL ''                                              @Z40NIVS 78480042
RPTLINE  DC    X'01'                                           @Z40NIVS 78560042
         DC    X'000B8B00'                                     @Z40NIVS 78640042
RPTLABEL LABEL ''                                              @Z40NIVS 78720042
         LINE  (1,1),(40,1),SKIP=1                             @Z40NIVS 78800042
         LABEL 'XXXXX 34XX/3803 SUBSYSTEM SUMMARY XXXXX'                78880042
         LINE  (67,1),(40,27)                                           78900002
         HEX   SHRCUA                                                   78920002
         LABEL 'XXXXX      PRIMARY CUA - ','X      XXXXX'               78940002
         LINE  (49,16),(5,16),SKIP=1                           @Z40NIVS 78960042
         ROUTINE BEGIN,THRHDR                                  @Z40NIVS 79040042
         LABEL '            CUA',                              @Z40NIVSX79120042
               'STATISTICS - CUA',                             @Z40NIVSX79200042
               'S EXCEEDING',                                  @Z40NIVSX79280042
               'TEMP RDS OR',                                  @Z40NIVSX79360042
               'TEMP WRTS'                                     @Z40NIVS 79440042
         LINE  (49,16),(5,16),SKIP=1                           @Z40NIVS 79520042
         ROUTINE BEGIN,ROUTER                                  @Z40NIVS 79600042
SKIPLABL LABEL ''                                              @Z40NIVS 79680042
UCLINE   LINE  (6,7),(47,1),SKIP=1                             @Z40NIVS 79760042
         HEX   SECUA                                           @Z40NIVS 79840042
         ROUTINE BEGIN,NOZEROES                                @Z40NIVS 79920042
         ROUTINE TUSERIAL,TWOBYTES                             @Z40NIVS 80000042
         ROUTINE BEGIN,BACK3                                   @Z40NIVS 80080042
         ROUTINE BEGIN,CHECKSER                                @Z40NIVS 80160042
         ROUTINE BEGIN,ERDECODE                                @Z40NIVS 80240042
         ROUTINE VOLID,MVVOL                                   @Z40NIVS 80320042
         HEX   FAILCCW1,0,4B                                   @Z427VLS 80400042
         ROUTINE BEGIN,BACK6                                   @Z427VLS 80460042
         HEX   FAILCCW2,0,4B                                   @Z427VLS 80520042
         ROUTINE BEGIN,BACK5                                   @Z427VLS 80580042
         HEX   CSW,0,4B                                        @Z427VLS 80640042
         ROUTINE BEGIN,BACK5                                   @Z427VLS 80700042
         HEX   SENSEB,1,6B                                     @Z40NIVS 80800042
         ROUTINE BEGIN,ADD4                                             80880002
         HEX   SENSEB1,1,6B                                    @Z40NIVS 80960042
         ROUTINE BEGIN,ADD4                                             81040002
         HEX   SENSEB2,1,6B                                    @Z40NIVS 81120042
         ROUTINE BEGIN,ADD4                                             81200002
         HEX   SENSEB3,1,6B                                    @Z40NIVS 81280042
UCLABEL  LABEL '.'                                             @Z40NIVS 81360042
         ROUTINE BEGIN,CHAIN                                   @Z40NIVS 81440042
SKIPLINE DC    X'FF'                                           @Z40NIVS 81520042
         DC    XL6'000000000000'                               @Z40NIVS 81600042
NOTELINE LINE  ,(1,40),SKIP=1                                  @Z40NIVS 81680042
NOTELABL LABEL 'PW  PERMANENT WRITE','PR  PERMANENT READ',     @Z40NIVSX81760042
               'PE  CAUSE UNKNOWN'                             @Z40NIVS 81840042
         LINE  ,(1,40),SKIP=1                                  @Z40NIVS 81920042
         LABEL 'EC  EQUIPMENT CHECK, CAUSE UNKNOWN','EE  ERASE HEAD'    82000042
         LINE  ,(1,40),SKIP=1                                  @Z40NIVS 82080042
         LABEL 'EB  TAPE BOTTOM, LEFT OR RIGHT','EL  LOAD FAILURE'      82160042
         LINE  ,(1,40),SKIP=1                                  @Z40NIVS 82240042
         LABEL 'EP  AIR BEARING PRESSURE','ET  TACH START FAILURE'      82320042
         LINE  ,(1,40),SKIP=1                                  @Z40NIVS 82400042
         LABEL 'EV  VELOCITY CHECK','ER  RESET KEY'            @Z40NIVS 82480042
         LINE  ,(1,40),SKIP=1                                  @Z40NIVS 82560042
         ROUTINE BEGIN,ENTSEP                                  @Z40NIVS 82640042
         LABEL ''                                              @Z40NIVS 82720042
NOTHRLNE LINE  (68,9),(40,34),SKIP=1                                    82800002
         ROUTINE  BEGIN,MVLODATE                                        82880001
         ROUTINE  BEGIN,MVHIDATE                                        82980001
NOTHRLBL LABEL 'NO CUAS EXCEEDED THRESHOLD:',                  @Z40NIVSX83120042
               'TO'                                            @Z40NIVS 83200042
SEPLINE  LINE  ,(1,45),SKIP=2                                  @Z40NIVS 83280042
SEPLABEL LABEL 'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX',        X83360042
               'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX',        X83440042
               'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX'                83520002
         LINE  ,(1,45),SKIP=2                                  @Z40NIVS 83600042
         ROUTINE BEGIN,SEPDEC                                  @Z40NIVS 83680042
         LABEL ''                                              @Z40NIVS 83760042
UCHLINE  LINE  (1,1),(44,1),SKIP=1                             @Z40NIVS 83840042
UCHLABEL LABEL 'PERMANENT ERROR SUMMARY'                       @Z40NIVS 83920042
         LINE  (1,1),(44,1),SKIP=1                             @Z40NIVS 84000042
         ROUTINE BEGIN,CKNOUC                                  @Z40NIVS 84080042
         LABEL ''                                              @Z40NIVS 84160042
FIRUCLI  LINE  (1,1),(74,4),SKIP=1                             @Z40NIVS 84240042
FIRUCLA  LABEL '...SENSE...'                                   @Z40NIVS 84320042
         LINE  ,(78,2),SKIP=1                                  @Z40NIVS 84400042
         LABEL '   1  1  1  1  1  1  1  1  1  1  2  2  2  2'            84480042
         LINE  ,(1,40)                                         @Z40NIVS 84560042
         LABEL 'DEV  SERIAL ERR  VOLID     LAST CCW  ',        @Z427VLSX84640042
               'CSW44-47  0  1  2  3  4  5  6  7  8  9',       @Z427VLSX84720042
               '0  1  2  3  4  5  6  7  8  9  0  1  2  3'      @Z40NIVS 84800042
CHNLINE  LINE (1,1)                                            @Z40NIVS 84880042
         ROUTINE BEGIN,UNCHAIN                                 @Z40NIVS 84960042
CHNLABEL LABEL ''                                              @Z40NIVS 85040042
*                                                              @Z40NIVS 85120042
         LINE (1,1)                                            @Z40NIVS 85200042
         ROUTINE BEGIN,RECHAIN                                 @Z40NIVS 85280042
         LABEL ''                                              @Z40NIVS 85360042
*                                                              @Z40NIVS 85440042
NOUCLINE LINE  (73,9),(40,39),SKIP=1                                    85520002
         ROUTINE BEGIN,MVHIDATE                                         85600002
         ROUTINE BEGIN,MVLODATE                                         85700002
NOUCLABL LABEL 'NO PERMANENT ERRORS ENCOUNTERED:',             @Z40NIVSX85840042
               'TO'                                            @Z40NIVS 85920042
         LINE  (64,9),(40,39),SKIP=1                           @Z40NIVS 86000042
         ROUTINE BEGIN,ENTSEP                                  @Z40NIVS 86080042
*                                                              @Z40NIVS 86160042
         LABEL ''                                              @Z40NIVS 86240042
CUALINE  LINE  ,(11,50),SKIP=1                                 @Z40NIVS 86320042
         ROUTINE DUM1,DONOTHNG                                 @Z40NIVS 86400042
CUALABEL LABEL 'TU    DATE   VOLUME     TIME      --TEMP--  SIO',      C86480042
               'DEN- NRZI  R/W WR TG LRC  CRC  ECC  SKEW ERLY VEL',    X86560042
               ' ----CPU----   HDR'                                     86600002
         LINE  ,(3,52),SKIP=1                                  @Z40NIVS 86640042
         ROUTINE DUM1,DONOTHNG                                 @Z40NIVS 86720042
         LABEL 'CUA   SERIAL DAY YR  SERIAL  HH MM SS.TH  RDS  WRTS',  C86800042
               'COUNT SITY NOISE VRC  VRC  MTE  EDC  ENV  ERR  BOR',   C86880042
               'CHG   ID  SERIAL   SER'                                 86960002
         LINE  ,(3,52),SKIP=1                                  @Z40NIVS 87040042
         ROUTINE DUM1,DONOTHNG                                 @Z40NIVS 87120042
NOLAB    LABEL ''                                              @Z40NIVS 87200042
DETLINE  EQU   *                                               @Z40NIVS 87280042
ONLYENT  LINE  (2,1),,SKIP=1                                   @Z40NIVS 87360042
         HEX   PRIMCUA,0,3B                                    @Z40NIVS 87440042
         ROUTINE TUSERIAL,PUTVOL                               @Z40NIVS 87520042
         ROUTINE YEAR,SETDATE                                  @Z40NIVS 87600042
         HEX   TIME,1,4B                                       @Z40NIVS 87680042
         ROUTINE DUM1,ADD11                                    @Z40NIVS 87760042
         ROUTINE TEMPRDS,ONEBYTE                               @Z40NIVS 87840042
         ROUTINE TEMPWRTS,ONEBYTE                              @Z40NIVS 87920042
         ROUTINE SIOCNT,TWOBYTES                               @Z40NIVS 88000042
         ROUTINE DUM1,ADD4                                     @Z40NIVS 88080042
         ROUTINE SNB60,WHATDENS                                @Z40NIVS 88160042
         ROUTINE SPARES,ADD3                                   @Z40NIVS 88240042
         ROUTINE SNB30,CHKNRZI                                 @Z40NIVS 88320042
         ROUTINE DUM1,DONOTHNG                                 @Z40NIVS 88400042
         ROUTINE RWVRC,ONEBYTE                                 @Z40NIVS 88480042
         ROUTINE CCOMPARE,CHKDEV                               @Z40NIVS 88560042
         ROUTINE MTELRCR,ONEBYTE                               @Z40NIVS 88640042
         ROUTINE EDCCRC,ONEBYTE                                @Z40NIVS 88720042
         ROUTINE ENVCKVRC,ONEBYTE                              @Z40NIVS 88800042
         ROUTINE SKEWCHK,RGHTHALF                              @Z40NIVS 88880042
         ROUTINE EXP,CHKDEV                                    @Z40NIVS 88960042
         ROUTINE EXP2,CHKDEV                                   @Z40NIVS 89040042
         HEX   CPUID,0,2B                                               89060002
         ROUTINE DUM1,ADD3                                              89065002
         HEX   CPUSER,0,3B                                              89070002
         ROUTINE DUM1,ADD6                                              89075002
         ROUTINE HDRSER,SERHDR                                 @Z427VLS 89080042
DETLABEL EQU   *                                               @Z40NIVS 89120042
         LABEL ''                                              @Z40NIVS 89200042
         LINE                                                           89280042
         ROUTINE BEGIN,CHKUCSV                                 @Z40NIVS 89360042
         LABEL ''                                              @Z40NIVS 89440042
LABELS   DS    0F                                              @Z40NIVS 89520042
         LSTART                                                @Z40NIVS 89600042
         END                                                            89680042
