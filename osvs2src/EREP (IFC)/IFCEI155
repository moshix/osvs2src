         TITLE 'IFCEI155 MODEL 155 CHANNEL EDIT'                        00060020
         GBLC  &DSECT,&CSECT                                            25860020
&CSECT   SETC  'IFCEI155'                                               25920020
&DSECT   SETC  'CI155'                                                  25980020
IFCEI155 CSECT                                                          26040020
CI155    DSECT                                                          26100020
DUM      EQU   *                                                        26160020
         DSGEN (XKEY,8),(XRELN,8),(XSWS8,9),(XSWS9,1),(XSWS10,1),      C26200002
               (XSWS11,1),                                             C26240002
               (XSWS12,1),(XSWS13,1),(XSWS14,1),(XSWS15,1)              26280020
         DSGEN (XDUM1,32)                                               26340020
         DSGEN (XDATE,32)                                               26400020
         DSGEN (XTIME,32)                                               26460020
         DSGEN (XDUM2,8),(XSER,24)                                      26520020
         DSGEN (XMOD,16),(MCEL,16)                                      26580020
         DSGEN (XJOBN,64)                                               26640020
         DSGEN (XAIO1,16),(XAIO2,16),(XAIO3,16),(XAIO4,16)              26700020
         DSGEN (XAIO5,16),(XAIO6,16),(XAIO7,16),(XAIO8,16)              26760020
         DSGEN (XFCCWCC,8),(XFCCWDA,24),(XFCCWFL,8),(XFCCW0,8),        C26820020
               (XFCCWCT,16)                                             26880020
         DSGEN (XCSWK,8),(XCSWCA,24)                                    26940020
         DSGEN (XCSWUS0,1),(XCSWUS1,1),(XCSWUS2,1),(XCSWUS3,1),        *27000020
               (XCSWUS4,1),(XCSWUS5,1),(XCSWUS6,1),(XCSWUS7,1),        *27060020
               (XCSWCS0,1),(XCSWCS1,1),(XCSWCS2,1),(XCSWCS3,1),        *27120020
               (XCSWCS4,1),(XCSWCS5,1),(XCSWCS6,1),(XCSWCS7,1),        *27180020
               (XCSWCT,16)                                              27240020
         DSGEN (XECSW,32)                                               27300020
         DSGEN (XDEVT1,16),(XDEVT2,16)                                  27360020
         DSGEN (XCHID,8),(XCUA,24)                                      27420020
         DSGEN (XMPIN,32)                                               27480020
         ORG   XMPIN                                           @YL02021 27490002
         DSGEN (VCUA,16),(VLGSZ,16)                            @YL02021 27500002
         DSGEN (VCCHPR0,1,1,9),(VCCHPR,1,10,16)                @YM2954P 27513002
         DSGEN (VCCHPR1,16,EQU,VCCHPR01)                       @YM2954P 27514002
         DSGEN (VDUM,24),(VFLAG,8),(VNOPRO,16)                 @YM2954P 27515002
         DSGEN (VPROC01,16),(VCHST01,16),(VPROC02,16),(VCHST02,16),    X27516002
               (VPROC03,16),(VCHST03,16),(VPROC04,16),(VCHST04,16),    X27519002
               (VPROC05,16),(VCHST05,16),(VPROC06,16),(VCHST06,16),    X27522002
               (VPROC07,16),(VCHST07,16),(VPROC08,16),(VCHST08,16),    X27525002
               (VPROC09,16),(VCHST09,16),(VPROC10,16),(VCHST10,16),    X27528002
               (VPROC11,16),(VCHST11,16),(VPROC12,16),(VCHST12,16),    X27531002
               (VPROC13,16),(VCHST13,16),(VPROC14,16),(VCHST14,16),    X27534002
               (VPROC15,16),(VCHST15,16),(VPROC16,16),(VCHST16,16)      27537002
         EJECT                                                          27540020
*                                                                       27600020
IFCEP000 DSECT                                                          27660020
         DS    CL6                                                      27720020
         DS    CL1                                                      27780020
         DS    CL1                                                      27840020
XPRTBUF  DS    15CL8                                                    27900020
         DS    5CL8                                                     27960020
         DS    3CL8                                                     28020020
         DS    CL8                                                      28080020
XSWITCH  DS    CL4                                                      28140020
*                                                                       28200020
*      ROUTINE BRANCH TABLE                                             28260020
*                                                                       28320020
         DS    CL112                                                    28380020
*                                                                       28440020
*      LOAD MODULE ENTRYPOINT NAMES                                     28500020
*                                                                       28560020
         DS    CL56                                                     28620020
*                                                                       28680020
*      READ/WRITE BUFFER                                                28740020
*                                                                       28800020
XMCH     DC    XL2'00'                                                  28860020
XCNTBUF  DS    CL8                                                      28920020
XKEYBUF  DS    CL2                                                      28980020
XDADBUF  DS    197CL8                                                   29040020
XDUMMY   DS    CL1                                                      29100020
         SPACE 3                                                        29160020
ERPIB    DSECT                                                    19032 29220020
SOFWFLGS DS    CL1                 PROGRAM FLAGS FIELD IN ERPIB   19032 29280020
PROBERR  DS    CL1                 PROBABLE SOURCE OF ERROR FIELD 19032 29340020
VALFLAGS DS    CL1                 VALIDITY FLAGS FIELD           19032 29400020
CMPLBITS DS    CL1                 TERM AND RETRY CODES FIELD     19032 29460020
MPINFOFD DS    CL2                 MULTI-PROCESSING INFO FIELD    19032 29520020
CHSMS    DS    CL2                 CHANNEL STATUS FIELD           19032 29580020
         EJECT                                                          29640020
IFCEI155 CSECT                                                          29700020
ENTRYPTR DC    A(FORMAT1)                                               29760020
TABLNAME DC    CL8'IFCEI155'                                            29820020
REG9     DS    F                                                        29880020
LP       DS    F                                                        29940020
         SPACE 2                                                        30000020
SPCLCODE EQU   *                                                        30060020
SKIPPER  EQU   *                                                        30120020
         BR    14                                                       30180020
R0       EQU   0                                                        30240020
R1       EQU   1                                                        30300020
R2       EQU   2                                                        30360020
R3       EQU   3                                                        30420020
R4       EQU   4                                                        30480020
R5       EQU   5                                                        30540020
R6       EQU   6                                                        30600020
R7       EQU   7                                                        30660020
R8       EQU   8                                                        30720020
R9       EQU   9                                                        30780020
R10      EQU   10                                                       30840020
R11      EQU   11                                                       30900020
R12      EQU   12                                                       30960020
R13      EQU   13                                                       31020020
R14      EQU   14                                                       31080020
R15      EQU   15                                                       31140020
****    ADDRESS EQUATES                                                 31200020
AD0      EQU   0                                                        31260020
AD1      EQU   1                                                        31320020
AD4      EQU   4                                                        31380020
AD12     EQU   12                                                       31440020
AD13     EQU   13                                                       31500020
AD14     EQU   14                                                       31560020
AD15     EQU   15                                                       31620020
AD16     EQU   16                                                       31680020
AD20     EQU   20                                                       31740020
AD37     EQU   37                                                       31800020
AD41     EQU   41                                                       31860020
AD45     EQU   45                                                       31920020
AD55     EQU   55                                                       31980020
AD63     EQU   63                                                       32040020
AD69     EQU   69                                                       32100020
AD108    EQU   108                                                      32160020
***   LENGTH EQUATES                                                    32220020
L0       EQU   0                                                        32280020
L1       EQU   1                                                        32340020
L2       EQU   2                                                        32400020
L3       EQU   3                                                        32460020
L4       EQU   4                                                        32520020
L5       EQU   5                                                        32580020
L6       EQU   6                                                        32640020
L7       EQU   7                                                        32700020
L8       EQU   8                                                        32760020
L9       EQU   9                                                        32820020
L10      EQU   10                                                       32880020
L12      EQU   12                                                       32940020
L13      EQU   13                                                       33000020
L14      EQU   14                                                       33060020
L15      EQU   15                                                       33120020
L16      EQU   16                                                       33180020
L17      EQU   17                                              @YL02021 33210002
L19      EQU   19                                                       33240020
L20      EQU   20                                                       33300020
L21      EQU   21                                                       33360020
L22      EQU   22                                                       33420020
L24      EQU   24                                                       33480020
L25      EQU   25                                              @YL02021 33510002
L26      EQU   26                                                       33540020
L31      EQU   31                                                       33600020
L32      EQU   32                                                       33660020
L40      EQU   40                                                       33720020
L44      EQU   44                                              @YL02021 33750002
L27      EQU   27                                              @YM2954P 33757002
L46      EQU   46                                              @YM2954P 33764002
L47      EQU   47                                              @YM2954P 33771002
L60      EQU   60                                                       33780020
L66      EQU   66                                              @YL02021 33810002
***   CONDITION CODE EQUATES                                            33840020
CC1      EQU   1                                                        33900020
CC2      EQU   2                                                        33960020
CC4      EQU   4                                                        34020020
CC7      EQU   7                                                        34080020
CC8      EQU   8                                                        34140020
****    NUMERICAL EQUATES                                               34200020
X01      EQU   X'01'                                                    34260020
X02      EQU   X'02'                                                    34320020
X04      EQU   X'04'                                                    34380020
X08      EQU   X'08'                                                    34440020
X09      EQU   X'09'                                                    34470020
X10      EQU   X'10'                                                    34500020
X20      EQU   X'20'                                                    34560020
X30      EQU   X'30'                                                    34620020
X40      EQU   X'40'                                                    34680020
X80      EQU   X'80'                                                    34740020
HEXBF    EQU   X'BF'                                                    34800020
HEX48    EQU   X'48'                                                    34860020
HEX02    EQU   X'02'                                                    34920020
HEX04    EQU   X'04'                                                    34980020
HEX08    EQU   X'08'                                                    35040020
HEX10    EQU   X'10'                                                    35100020
HEX20    EQU   X'20'                                                    35160020
HEX40    EQU   X'40'                                                    35220020
H21      EQU   X'21'                                           @YL02021 35250002
HEX22    EQU   X'22'                                                    35280020
HEX28    EQU   X'28'                                                    35340020
HEX2A    EQU   X'2A'                                                    35400020
HEX29    EQU   X'29'                                                    35460020
HEX01    EQU   X'01'                                                    35520020
HEX00    EQU   X'00'                                                    35580020
DIV1     EQU   X'0A'                                                    35640020
DIV2     EQU   X'0C'                                                    35700020
K1       EQU   1                                                        35760020
K3       EQU   3                                                        35820020
*********************************************************************** 35880020
*                                                                     * 35940020
*                                                                     * 36000020
*    ROUTINE TO PICK UP THE CHANNEL ADDRESS WHICH IS NOT ON A BYTE    * 36060020
*   BOUNDRY, CONVERT IT TO HEX AND STORE IT IN THE PRINT BUFFER.      * 36120020
*                                                                     * 36180020
*                                                                     * 36240020
*********************************************************************** 36300020
         SPACE 2                                                        36360020
@CHANADR DS    0F                                                       36420020
         USING *,15                                                     36480020
         STM   14,12,12(13)        SAVE THE REGS                        36540020
         MVC   MYWORK(1),0(4)                                           36600020
         NI    MYWORK,X'07'                                             36660020
         OI    MYWORK,X'F0'                                             36720020
         S     3,ONE                                                    36780020
         MVC   0(1,3),MYWORK                                            36840020
         LM    14,12,12(13)        RESTORE THE REGS                     36900020
         BR    14                  RETURN                               36960020
*                                                                       37020020
         DROP  R15                                                      37080020
         USING IFCEI155,R9                                              37140020
SETSOURC STM   R5,R8,XSAVE              SAVE REGS                       37200020
         XC    NOPRO(4),NOPRO           CLEAR                  @YM2954P 37230002
         CLI   L0(R4),HEX20             TEST REC SOURCE                 37260020
         BE    SETCCH                   CCH NORMAL                      37320020
         CLI   L0(R4),H21               TEST SOURCE            @YM2954P 37340002
         BE    SETCCH                   CCH VS2(MVM)           @YM2954P 37360002
         CLI   L0(R4),HEX22                                             37380020
         BE    SETCCHC                  CHH CONVERTED                   37440020
         CLI   L0(R4),HEX28                                             37500020
         BE    SETSER1                  SER1 CHAN REC                   37560020
         CLI   L0(R4),HEX2A                                             37620020
         BE    SETSER1C                 SER1 CHAN REC CONVERTED         37680020
         CLI   L0(R4),HEX29                                             37740020
         BE    SETSER0                  SER0 CHAN REC                   37800020
SETSER0C MVC   CSER0A(L9),CONVERTD      SET CONVERTED MSG               37860020
SETSER0  LA    R5,CSER0                 SET SER0 MSG PTR                37920020
         B     SETSRC                                                   37980020
SETSER1C MVC   CSER1A(L9),CONVERTD      SET CONVERTED MSG               38040020
SETSER1  LA    R5,CSER1                 SET SERC MSG PTR                38100020
         B     SETSRC                                                   38160020
SETCCHC  MVC   CCCHA(L9),CONVERTD       SET CONV MSG                    38220020
SETCCH   LA    R5,CCCH                  SET CCH PTR                     38280020
SETSRC   MVC   L0(L14,R3),L0(R5)        MOVE SOURCE TO LINE             38340020
         B     RETURN                   RETURN                          38400020
*                                                                       38460020
SETPGMN  MVC   L0(L8,R3),L0(R4)         MOVE 8 CHAR NAME TO BUFF        38580020
         BR    R14                                                      38640020
*                                                                       38700020
SPACER2  LA    R3,L2(R3)                BUMP R3 PTR BY 2                38760020
         BR    R14                                                      38820020
*                                                                       38880020
SETHEX   STM   R5,R8,XSAVE              SAVE REGS                       38940020
         LA    R8,CHARS                 CHAR TABLE PTR                  39000020
         IC    R7,L0(R4)                PICK UP CHAR                    39060020
         SLL   R7,L24                   MOVE IT TO HI POS               39120020
         SR    R6,R6                                                    39180020
         SLDL  R6,L4                    MOVE 4 BITS TO R6               39240020
         AR    R6,R8                    INDEX FOR CHARS                 39300020
         MVC   L0(L1,R3),L0(R6)         MOVE CHAR TO BUFF               39360020
         SR    R6,R6                                                    39420020
         SLDL  R6,L4                    MOVE LAST 4 BITS TO R6          39480020
         AR    R6,R8                    INDEX INTO TABLE                39540020
         MVC   L1(L1,R3),L0(R6)         MOVE CHAR                       39600020
         B     RETURN                                                   39660020
*                                                                       39720020
*                                                                       39780020
*                                                                       39840020
*                              SET ACTIVE  I/O UNITS                    39900020
SETAIO   STM   R5,R8,XSAVE              SAVE REGS                       39960020
         LR    R5,R3                    SET R5 TO BUFFER                40020020
         SH    R5,H43                   POINT R5 TO BEGGIN OF DATA      40080020
         SR    R7,R7                                                    40140020
         LA    R6,L8                    LOOP COUNT                      40200020
SETAIOLP CLC   L0(L4,R5),CZEROS         TEST FOR ALL ZEROS              40260020
         BE    BLANKOUT                 BE-TO BLANK OUT ZEROS           40320020
SETAIOL1 LA    R5,L5(R5)                BUMP COUNT                      40380020
         BCT   R6,SETAIOLP              LOOP TILL 8 TESTS               40440020
         CH    R7,H8                    ARE ALL ACTIVE IO ZERO          40500020
         BNE   RETURN                   NO RETURN                       40560020
         LR    R5,R3                    YES                             40620020
         SH    R5,H43                   PUT IN NONE                     40680020
         MVC   L0(L4,R5),NONE           INTO PRINT BUFF                 40740020
         B     RETURN                                                   40800020
BLANKOUT MVC   L0(L4,R5),BLANKS         MOVE IN BLANKS                  40860020
         LA    R7,L1(R7)                COUNT # OF ZERO FLDS            40920020
         B     SETAIOL1                 LOOP                            40980020
RETURN   LM    R5,R8,XSAVE                                              41040020
         BR    R14                                                      41100020
*                                                                       41160020
*                                                                       41220020
CHKSW9   TM    L1(R4),HEX40             TEST SWITCHES                   41280020
CHECKCC  BZ    NOPRT                    IF SWITCHES OFF                 41340020
         BR    R14                      DONOT PRINT                     41400020
CHKSW10  TM    L1(R4),HEX20             R15 RETURNED ZERO               41460020
         B     CHECKCC                  STOPS PRINTING                  41520020
CHKSW11  TM    L1(R4),HEX10                                             41580020
         B     CHECKCC                                                  41640020
CHKSW12  TM    L1(R4),HEX08                                             41700020
         B     CHECKCC                                                  41760020
CHKSW13  TM    L1(R4),HEX04                                             41820020
         B     CHECKCC                                                  41880020
CHKSW14  TM    L1(R4),HEX02                                             41940020
         B     CHECKCC                                                  42000020
CHKSW15  TM    L1(R4),HEX01                                             42060020
         B     CHECKCC                                                  42120020
NOPRT    SR    R15,R15                                                  42180020
         BR    R14                                                      42240020
*                                                                       42300020
SETDATE  UNPK  XWORK(L8),L0(L4,R4)      UNPACL DATE                     42360020
         MVZ   XWORK+L7(L1),XWORK       SET ZONE                        42420020
         MVC   L0(L3,R3),XWORK+L5       MOVE DAY                        42480020
         MVC  L6(L2,R3),XWORK+L3                                        42540020
         BR    R14                      RETURN                          42600020
*                                                                       42660020
CONVTIME TM    L0(R4),HEX48             TEST FOR NS/BIN CLOCK           42720020
         BZ    BINCLOCK                 ZERO IS BINARY CLOCK            42780020
         BO    RETURNB                  ONES IS FOR CONV TIME           42840020
         TM    L0(R4),HEX40             IF ON IS N/S CLOCK              42900020
         BO    NSCLOCK                  IF OFF TIME OK                  42960020
RETURNB  BR    R14                      RETURN                          43020020
*                                                                       43080020
         USING CI155,R2                                                 43140020
ISITVS2  STM   R5,R8,XSAVE             SAVE REGS               @YL02021 43141002
         L     R5,DUMPIT                LOCATION OF DUMP PARMS @YM2954P 43141302
         MVC   L0(L2,R5),LOGSIZV2       VS 2 RECORD SIZE       @YM2954P 43141602
         CLI   XKEY,H21                TEST FOR VS2            @YL02021 43142002
         BE    RETURN                  NOT VS2                 @YL02021 43143002
         MVC   L0(L2,R5),LOGSIZV1       VS 1 RECORD SIZE       @YM2954P 43143502
         SR    R15,R15                 ELIM. LABEL             @YL02021 43144002
         B     RETURN                                          @YL02021 43145002
VS2TEST  STM   R5,R8,XSAVE             SAVE REGS               @YL02021 43146002
         CLI   XKEY,H21                IS IT VS2               @YL02021 43147002
         BNE   COMPL                    SET UP FOR DUMP AND RET         43148002
         B     RETURN                                          @YL02021 43149002
PROC     STM   R5,R8,XSAVE             SAVE REGS               @YL02021 43156002
         SR    R5,R5                   CLEAR REG 5             @YL02021 43157002
         L     R5,NOPRO                PLACE THE NO. OF PROC. IN REG 5  43158002
         LA    R5,1(R5)                ADD ONE TO REG. 5       @YL02021 43159002
         ST    R5,NOPRO                PLACE BACK IN CORE      @YL02021 43160002
         CLC   VNOPRO(2),NOPRO+2       COMP. WITH ACTUAL NO. OF PROC.   43161002
         BL    COMPL                   FINISHED                @YL02021 43162002
         LR    R5,R3                                           @YL02021 43163002
         LA    R6,L47                   ADJUST OFFSET          @YM2954P 43164002
         SR    R5,R6                                           @YL02021 43165002
         MVC   L0(L17,R5),MSG1                                 @YL02021 43166002
         MVC   L27(L16,R5),MSGBB                               @YM2954P 43167002
PROCBIN  LH    R4,L0(R4)           FETCH DATA                  @YM2954P 43167502
         SLL   R4,L15                   POSITION DATA          @YM2954P 43168002
         LA    R6,L46              LENGTH OF LABEL             @YM2954P 43168502
         AR    R5,R6               SET UP POINTER              @YM2954P 43169002
         LA    R6,L16                   CHANGE COUNT           @YM2954P 43169502
TESTIT   SLL   R4,L1                    POSITION CHANNEL IND   @YM2954P 43170002
         LTR   R4,R4                    TEST FOR ON LINE       @YM2954P 43170502
         BNM   CHANACT                  BRANCH ON LINE         @YM2954P 43171002
PRINT    LA    R5,L3(R5)                UPDATE PRT POINTER     @YM2954P 43171502
         BCT   R6,TESTIT           NEXT CHANNEL                @YM2954P 43172002
         B     RETURN                                          @YM2954P 43172502
CHANACT  MVI   L0(R5),C'X'         MOVE X TO PRINT             @YM2954P 43173002
         B     PRINT                    NEXT CHANNEL           @YM2954P 43173502
COMPL    SR    R15,R15                  CLEAR LABEL            @YM2954P 43174002
         L     R5,DUMP                  DUMP PARM LOCATION     @YM2954P 43174502
         ST    R5,REG9                  STORE IT FOR CONTROL   @YM2954P 43175002
         B     RETURN                   RETURN                 @YM2954P 43175502
         SPACE 1                                               @YM2954P 43176002
NOPRO    DC    F'00'                                           @YL02021 43177002
MSG1     DC    C'PROCESSOR ADDRESS'                            @YL02021 43178002
MSGBB    DC    C'CHANNELS ON LINE'                             @YM2954P 43179002
LOGSIZV1 DC    XL2'54'                                         @YM2954P 43182002
LOGSIZV2 DC    XL2'9C'                                         @YM2954P 43185002
DUMP     DC    A(DUMPCODE-4)                                   @YM2954P 43188002
DUMPIT   DC    A(DUMPSIZE)                                     @YM2954P 43191002
         SPACE 1                                               @YM2954P 43194002
NSCLOCK  STM   R14,R12,L12(R13)         SAVE REGS                       43200020
         NI    L0(R4),HEXBF                                             43260020
         MVC   XWORK(L8),XDATE          MOVE DATE                       43320020
         LM    R4,R5,XWORK                                              43380020
         SRDL  R4,L12                   POSITION FOR MICRO SECS         43440020
         D     R4,MILLION               CONVERT TO SECONDS              43500020
         SRA   R4,L19                   POSITION FOR ROUNDING           43560020
         AR    R5,R4                    UP TO NXT SECONDS               43620020
         SR    R4,R4                                                    43680020
         D     R4,SIXTY                 CONVERT TO NINS                 43740020
         CVD   R4,XWORK                 CONVERT IT                      43800020
         LH    R6,XWORK+L6              PICK UP SECONDS                 43860020
         SRL   R6,L4                    SHIFT OFF ZONE                  43920020
         STC   R6,XDATE+L6              STORE SECONDS IN  REC           43980020
         MVI   XDATE+L7,HEX00           ZERO OUT TH'S                   44040020
         SR    R4,R4                                                    44100020
         D     R4,SIXTY                 CONVERT TO HRS                  44160020
         CVD   R4,XWORK                 CONVERT REMAINDER MINUTES       44220020
         LH    R6,XWORK+L6              PICK UP                         44280020
         SRL   R6,L4                    DROP ZONE                       44340020
         STC   R6,XDATE+L5              STORE MINUTES                   44400020
         SR    R4,R4                                                    44460020
         D     R4,T24                   DIVIDE TO GET DAYS              44520020
         CVD   R4,XWORK                 CONV REM                        44580020
         LH    R6,XWORK+L6              PICK UP                         44640020
         SRL   R6,L4                    DROP ZONE                       44700020
         STC   R6,XDATE+L4              STORE HRS                       44760020
         LA    R4,L60                   STARTINY YEAR 1960              44820020
         LA    R6,L1                    INC OF 1                        44880020
LEAPYEAR LA    R7,L3(R4)                ADD 3 YRS                       44940020
         S     R5,LPYEAR                DAYS IN LEAP YEAR 366           45000020
         BZ    THISYEAR                 BR-THIS YR+1                    45060020
         BM    OVERSHOT                 BR-TOOFAR                       45120020
         BXLE  R4,R6,REGYEAR            UPDATE YEAR BY ONE              45180020
REGYEAR  S     R5,RGYEAR                DAYS IN RG YEAR 365             45240020
         BZ    THISYEAR                 BR-YEAR+1                       45300020
         BM    OVERSHT1                 BR-TOO FAR                      45360020
         BXLE  R4,R6,REGYEAR            UPDATE AND TRY AGAIN            45420020
         B     LEAPYEAR                                                 45480020
OVERSHOT A     R5,LPYEAR                ADD BACK LEAP YEAR              45540020
         B     THISYEAR                 & USE                           45600020
OVERSHT1 A     R5,RGYEAR                ADD BACK REG YEAR               45660020
         B     THISYER                  & USE                           45720020
THISYEAR AR    R4,R6                    ADD 1                           45780020
THISYER  AR    R5,R6                    ADD 1                           45840020
         CVD   R5,XWORK                 CONVERT DAYS                    45900020
         MVC   XDATE+L2(L2),XWORK+L6    MOVE DAYS                       45960020
         CVD   R4,XWORK                 CONVERT YEAR                    46020020
         LH    R6,XWORK+L6              PICK UP                         46080020
         SRL   R6,L4                    DROP ZONE                       46140020
         STC   R6,XDATE+L1              PUT YEAR                        46200020
         MVI   XDATE,HEX00              SET TO ZERO                     46260020
RETURNC  OI    XSWS8,HEX08              TURN ON PACKED SWITCH           46320020
         LM    R14,R12,L12(R13)         RETURN                          46380020
         BR    R14                                                      46440020
*                                                                       46500020
*                                                                       46560020
BINCLOCK STM   R14,R12,L12(R13)         SAVE REGS                       46620020
         L     R3,XTIME                 PICK UP TIME IN BIN             46680020
         LTR   R3,R3                    TEST FOR ZERO                   46740020
         BZ    RETURNC                  YES-RETURN                      46800020
         SRL   R3,L1                    CONVERT                         46860020
         M     R2,CONSTG                     TO                         46920020
         D     R2,CONSTH                       DECIMAL                  46980020
         LA    R4,L32                   BIT COUNTER                     47040020
         MVI   TIMDIV+L3,DIV1           INITIAL DIVISOR (0A)            47100020
BCLOCKA  SR    R2,R2                    CLEAR                           47160020
         D     R2,TIMDIV                DEVOLP DIGIT-REMAINDER          47220020
         LR    R0,R2                    SAVE REM                        47280020
         SRDL  R0,L4                    SHIFT 4BITS                     47340020
         SH    R4,H4                    DEC BY 4                        47400020
         LTR   R3,R3                    DONE                            47460020
         BZ    BCLOCKB                  BR-YES                          47520020
         CH    R4,H24                   BITS LESS 24                    47580020
         BNL   BCLOCKA                  BR-NO                           47640020
         XI    TIMDIV+L3,DIV2           ALT DIV (0A XI 0C=06)           47700020
         B     BCLOCKA                                                  47760020
BCLOCKB  SRL   R1,L0(R4)                MOVE TO FINAL POS               47820020
         L     R2,28(R13)                                        44065  47850002
         ST    R1,XTIME                 STORE BACK                      47880020
         B     RETURNC                                                  47940020
XWORK    DS    D                                                        48000020
XSAVE    DS    4F                                                       48060020
CONSTG   DC    X'00030D40'                                              48120020
CONSTH   DC    X'024AE062'                                              48180020
MILLION  DC    F'1000000'                                               48240020
SIXTY    DC    F'60'                                                    48300020
T24      DC    F'24'                                                    48360020
LPYEAR   DC    F'366'                                                   48420020
RGYEAR   DC    F'365'                                                   48480020
TIMDIV   DC    F'1'                                                     48540020
H4       DC    H'4'                                                     48600020
H8       DC    H'8'                                                     48660020
H24      DC    H'24'                                                    48720020
H43      DC    H'43'                                                    48780020
CHARS    DC    C'0123456789ABCDEF'                                      48840020
NONE     DC    C'NONE'                                                  48900020
CONVERTD DC    C'CONVERTED'                                             48960020
CZEROS   DC    C'0000'                                                  49020020
BLANKS   DC    C'    '                                                  49080020
CCCH     DC    CL5'CCH'                                                 49140020
CCCHA    DC    CL9' '                                                   49200020
CSER1    DC    CL5'SER1'                                                49260020
CSER1A   DC    CL9' '                                                   49320020
CSER0    DC    CL5'SER0'                                                49380020
CSER0A   DC    CL9' '                                                   49440020
MYWORK   DC    F'0'                                                     49500020
ONE      DC    F'1'                                                     49560020
         EJECT                                                          49620020
IFCASR01 DS    0H                                                       49680020
         USING *,R15                                                    49740020
         STM   R14,R12,12(R13)          SAVE REGISTERS                  49800020
         CLI   XKEY,H21                                        @YL02021 49860002
         BNE   CONTIN                                          @YL02021 49870002
         OI    VS2FLG,X01                                      @YL02021 49880002
CONTIN   ST    R13,SVR13                                       @YL02021 49890002
         L     R11,NXENTRY              LOAD SUBROUTINE RETURN ADR      49920020
         LTR   R11,R11                  TEST FOR INITIAL ENTRY          49980020
         BZ    IFCASR02                 BRANCH IF 0-INITIAL ENTRY       50040020
         LM    R12,R10,MYSAVE           RELOAD SUBROUTINE REGS          50100020
         BR    R11                      CONTINUE PROCESSING             50160020
IFCASR02 DS    0H                                                       50220020
         SH    R3,TWOX                  SUBTRACT 2 FROM PRNT BFR ADR    50280020
         MVC   L0(L1,R3),L1(R3)         MOVE PRINTER CNTRL CHAR         50340020
         LA    R3,L1(R3)                INCREMENT PRNT BFR ADR          50400020
         USING XDADBUF,R4                                               50460020
         USING XPRTBUF,R3                                               50520020
         USING XKEYBUF,R2                                               50550020
NEWMOVE  CLI   XKEYBUF+1,REL19          RELEASE 19                19E03 50580020
         BE    NEWMOVE1                 BRANCH--YES               19E03 50640020
         MVC   CSWORD(8),XDADBUF+54     MOVE CSW                  19E03 50700020
         MVC   ERPIBFLD(4),XDADBUF+62   MOVE ERPIB                19E03 50760020
         MVC   MULTISYS(4),XDADBUF+74   MOVE CHANSTAT INFO        19E03 50820020
         B     CONTINUE                 CONTINUE                  19E03 50880020
NEWMOVE1 MVC   CSWORD(8),XDADBUF+46     MOVE CSW                  19E03 50940020
         MVC   ERPIBFLD(4),XDADBUF+54   MOVE ERPIB                19E03 51000020
         MVC   MULTISYS(4),XDADBUF+66   MOVE CHANSTAT INFO        19E03 51060020
CONTINUE LA    R9,ERPIBFLD              DSECT ADDRESSIBILITY      19E03 51120020
         USING ERPIB,R9                                                 51180020
         MVI   SETUPBFR+1,C'*'                                     MP   51240020
         MVC   SETUPBFR+2(78),SETUPBFR+1                           MP   51300020
         BAL   BRANPRT,XWRTPRT    MOVE BORDER TO BUFFER AND WRITE  MP   51360020
         L     R6,VS2                                          @YL02021 51370002
         CLI   0(R6),X'01'                                     @YL02021 51380002
         BE    DUMMYTST                                        @YL02021 51390002
         MVI   SETUPBFR,C'-'           SKIP TWO SPACES             MP   51420020
         TM    MPINFOFD,MSBIT      IS MULTI-SYSTEM BIT SET        19032 51480020
         BZ    DUMMYTST      IFNOT,CKECK FOR ENTRANCE FROM ASR01   MP   51540020
         LA    SETUPADR,SETUPBFR       ADDRESS OF PRINT BUFFER     MP   51600020
         MVC   24(24,SETUPADR),MSHEAD   MOVE MULTI-SYSTEM HDR TO BUFMP  51660020
         BAL   BRANPRT,XWRTPRT     WRITE HEADER                    MP   51720020
         MVI   SETUPBFR+1,C'*'                                     MP   51780020
         MVI   VDSTAR,C'*'                                         MP   51840020
         BAL   BRANPRT,XWRTPRT     WRITE LINE DIVIDER              MP   51900020
*                                                                  MP   51960020
*                                                                  MP   52020020
*              THIS ROUTINE FORMATS AND PRINTS A MESSAGE           MP   52080020
*              CONTAINING THE ID OF THE FAILING CPU AND            MP   52140020
*              THE STATUS OF THE MULTI-PROCESSING SYSTEM           MP   52200020
*                                                                  MP   52260020
*                                                                  MP   52320020
         MVC   10(12,SETUPADR),MSCPUID  MOVE CPUID MESSAGE TO BUFFERMP  52380020
         MVC   30(15,SETUPADR),MSCPUST  MOVE CPU STATUS MESSAGE    MP   52440020
         MVI   0(SETUPADR),C'-'    SKIP TWO SPACES AFTER LINE      MP   52500020
         TM    MPINFOFD,ID         TEST FOR WHICH CPU             19032 52560020
         BZ    STATEST       SKIP CPU ID                           MP   52620020
         MVI   14(SETUPADR),C'2'   INSERT CPUID=CPU2               MP   52680020
STATEST  IC    R1,MPINFOFD         GET MS BYTE IN MPINFO          19032 52740020
         SLL   R1,30               CLEAR FOR CPUSTAT               MP   52800020
         LTR   R1,R1               TEST FOR ZERO,NEGATIVE OR POSITIVEMP 52860020
         BC    12,SHARED           IS STATUS NOT PARTITION         MP   52920020
         MVC   45(11,SETUPADR),PART     STATUS WAS PARTITIONED     MP   52980020
         B     CHANTEST      GO FOR CHANNEL STATUS                 MP   53040020
SHARED   MVC   45(6,SETUPADR),SHAR      SHARED STATUS              MP   53100020
         BE    CHANTEST                 WAS CPU RECONFIGURED OUT   MP   53160020
         MVC   51(21,SETUPADR),RECON    YES                        MP   53220020
         EJECT                                                          53280020
*                                                                  MP   53340020
*                                                                  MP   53400020
*              THIS ROUTINE TESTS A TWO BYTE FIELD                 MP   53460020
*              MPINFO FIELD                          TO DETERMINE       53520020
*              THE CHANNEL STATUS FOR BOTH CPUS AND FORMAT         MP   53580020
*              A MESSAGE TO INDICATE THAT STATUS                   MP   53640020
*                                                                  MP   53700020
*                                                                  MP   53760020
CHANTEST BAL   BRANPRT,XWRTPRT          PRINT INFORMATION          MP   53820020
         MVI   0(SETUPADR),C'-'         SKIP TWO SPACES            MP   53880020
         MVC   10(27,SETUPADR),CHCNFIG  CHANNEL CONFIGURATION MESSAGEMP 53940020
         LA    UPKREG,0                                            MP   54000020
         TM    MPINFOFD,ID         WAS CPUID=CPU2                 19032 54060020
         BZ    CCHMOVE                 NO                          MP   54120020
         MVI   14(SETUPADR),C'2'        YES, ENTER ID 2            MP   54180020
CCHMOVE  BAL   BRANPRT,XWRTPRT          PRINT MESSAGE              MP   54240020
         LA    R1,7                     LOOP CONTROL               MP   54300020
         LA    R2,14(SETUPADR)          PTR TO SLOT FOR 'OFF' MESSAGEMP 54360020
         IC    R5,CHSMS(UPKREG)         GET CHANNEL STATUS BYTE    MP   54420020
         MVC   10(55,SETUPADR),CHTAB    GET LIST OF CHANNELS       MP   54480020
         SLL   R5,24                    POSITION BYTE FOR BIT TESTINGMP 54540020
MSLOOP   LTR   R5,R5         IS BIT ON (NEGATIVE REG) OR OFF       MP   54600020
         BC    10,MSUPDT                NO                         MP   54660020
         MVC   0(3,R2),OFF              CHANNEL OFFLINE            MP   54720020
MSUPDT   SLL   R5,1                     MOVE TO NEXT CHANNEL BIT   MP   54780020
         LA    R2,8(R2)                 UPDATE MESSAGE POINTER     MP   54840020
         BCT   R1,MSLOOP                EXIT AFTER 7-BITS PROCESSED MP  54900020
MSREND   BAL   BRANPRT,XWRTPRT          WRITE CHANNEL STATUS MESSAGEMP  54960020
         LTR   UPKREG,UPKREG            TEST FOR SECOND TIME THROUGH MP 55020020
         BC    7,PRTHD                  BOTH BYTES OF CHANSTAT PRINTED  55080020
         LA    UPKREG,1(UPKREG)         PTR TO 2ND.BYTE OF CHANSTATMP   55140020
         MVC   10(27,SETUPADR),CHCNFIG  MOVE IN CHANNEL CONFIGURATIONMP 55200020
         TM    MPINFOFD,ID         ESTABLISH CPUID                19032 55260020
         BO    CCHMOVE                  BRANCH IF CPUID=CPU2       MP   55320020
         MVI   14(SETUPADR),C'2'        PUT CPU2 IN MESSAGE        MP   55380020
         B     CCHMOVE       PRINT MESSAGE                         MP   55440020
PRTHD    MVI   SETUPBFR+1,C'*'             SETUP TO PRINT DIVIDER       55500020
         MVC   2(78,SETUPADR),1(SETUPADR)                               55560020
         MVI   SETUPBFR,C'0'               SPACE FIRST                  55620020
         BAL   BRANPRT,XWRTPRT             PRINT DIVIDER                55680020
DUMMYTST LA    SETUPADR,SETUPBFR   GET ADDR OF BUFFER FOR PRINT    MP   55740020
*                                       MESSAGE                    MP   55800020
         MVI   0(SETUPADR),C'0'         SKIP SPACE AFTER NEXT MESSAGEMP 55860020
         OC    ERPIBFLD+1(3),ERPIBFLD+1  TEST FOR DUMMY ERPIB     19032 55920020
         BNE   MSCONT                   CONTINUE IF MEANINGFUL ERPIB MP 55980020
         MVC   10(39,SETUPADR),MSASR    PRINT ASR01 ENTRY MESSAGE  MP   56040020
         MVI   0(SETUPADR),C'-'         SKIP 2 LINES               MP   56100020
         BAL   BRANPRT,XWRTPRT          PRINT INFORAMATION         MP   56160020
         MVC   10(17,SETUPADR),MSNERPIB ERPIB NOT CREATED MESSAGE  MP   56220020
         BAL   BRANPRT,XWRTPRT          PRINT INFORMATION          MP   56280020
         B     RETCNTL       RETURN CONTROL                        MP   56340020
*                                                                  MP   56400020
         EJECT                                                          56460020
MSCONT   EQU   *                                                   MP   56520020
*   *    *    *    *    *    *    *    *    *    *    *    *    *    *  56580020
*                          INSTRUCTION ANALYSIS                       * 56640020
*        THIS PROGRAM SECTION WILL INSPECT THE FIRST FOUR(4) BITS IN  * 56700020
*        THE FIRST BYTE  OF THE              ERPIB AREA, TO DETERMINE * 56760020
*        THE INSTRUCTION CAUSING THE ERROR.                           * 56820020
         LA    SETUPADR,SETUPBFR       SET UP HEADER BOARDER.           56880020
         MVC   SETUPBFR+27(25),HEADER    SET UP HEADER MESSAGE          56940020
         MVI   0(SETUPADR),C'0'          SPACE ONE LINE                 57000020
         BAL   BRANPRT,XWRTPRT                                          57060020
*                                                                     * 57120020
*                            TEST FOR INTERRUPT                       * 57180020
*                                                                     * 57240020
         TM    SOFWFLGS,X'40'          INTERRUPT TEST.                  57300020
         BZ    INST                                                     57360020
         MVC   SETUPBFR(42),ERRINT     BUFFER INTERRUPT MESSAGE.        57420020
         B     RITEOUT                                                  57480020
*                                                                     * 57540020
*   *    *    *    *    *    *    *    *    *    *    *    *    *    *  57600020
*                                                                     * 57660020
*        BITS 32-35 WILL BE TESTED                                    * 57720020
*                                                                     * 57780020
INST     MVC   SETUPBFR(33),CAUSERR    TYPE-INST ERROR HEADER.          57840020
         TM    SOFWFLGS,X'80'          TEST FOR SIO INSTRUCTION ERROR.  57900020
         BO    PRTERSIO                BRANCH TO SETUP PRINT BUFFER.    57960020
         TM    SOFWFLGS,X'20'          TEST FOR TIO INSTRUCTION.        58020020
         BO    PRTERTIO                BRANCH TO SETUP PRINT BUFFER.    58080020
*                                                                     * 58140020
PRTERHIO MVC   SET1(3),ERRHIO          MOVE HIO LABEL INTO BUFFER.      58200020
         B     RITEOUT                 PREPARE TO WRITE MESSAGE.        58260020
*                                                                     * 58320020
PRTERSIO MVC   SET1(3),ERRSIO          MOVE SIO LABEL INTO BUFFER.      58380020
         B     RITEOUT                 PREPARE TO WRITE MESSAGE.        58440020
*                                                                     * 58500020
PRTERTIO MVC   SET1(3),ERRTIO          MOVE TIO LABEL INTO BUFFER.      58560020
*                                                                     * 58620020
RITEOUT  BAL   BRANPRT,XWRTPRT         WRITE OUT APPROPRIATE MESSAGE.   58680020
*   *    *    *    *    *    *    *    *    *    *    *    *    *    *  58740020
*        THE FOLLOWING PROGRAM SECTION WILL INSPECT THE ERPIBFLD        58800020
*        TO DETERMINE IF AN ERPIB IS PRESENT.   IF  ONE IS              58860020
*        NOT FOUND, CONTROL WILL BE RETURNED.                           58920020
*   *    *    *    *    *    *    *    *    *    *    *    *    *    *  58980020
         OC    ERPIBFLD+1(3),ERPIBFLD+1  TEST FOR  ERPIB PRESENT  19032 59040020
         BZ    NONEXIST                WRITE MSG TO INDICATE NONEXISTS. 59100020
         B     TEST1         TEST COMPLETION CODE                  MP   59160020
SETVD    EQU   XPRTBUF+33                                          MP   59220020
*                         UCB ADDRESS NON-EXISTANT                      59280020
NONEXIST MVC   SETUPBFR(45),NOUCB        SET UP MSG FOR NO UCB          59340020
         BAL   BRANPRT,XWRTPRT         WRITE MESSAGE.                   59400020
         B     RETCNTL                 RETURN TO CONTROL.               59460020
*   *    *    *    *    *    *    *    *    *    *    *    *    *    *  59520020
*        THE FOLLOWING PROGRAM SECTION WILL TEST  BYTE 5     OF THE     59580020
*        ERPIB FOR A NO RETRY BIT SETTING. IF ON, CONTROL IS RETURNED   59640020
*        AFTER MESSAGE IS PRINTED OUT.                                  59700020
*   *    *    *    *    *    *    *    *    *    *    *    *    *    *  59760020
*                       OUTPUT RETRY CODE VALUE                         59820020
*                                                                       59880020
*   *    *    *    *    *    *    *    *    *    *    *    *    *    *  59940020
*                            TEST SOFTWARE FLAGS                        60000020
TEST     MVC   SETUPBFR(32),RETCDVAL     BUFFER THE BASIC MESSAGE       60060020
         IC    REG,CMPLBITS        CONTENTS OF BYTE 8 INTO R3     19032 60120002
         TM    VALFLAGS,X'10'            TEST FOR VALID RETRY CODE      60180020
         BO    VALFLG              IF VALID, GO SETUP MESSAGE           60240020
         MVC   33(43,SETUPADR),NOTVM  SETUP NOT ASSESSABLE MESSAGE      60300020
         B     BUFITA           GO PRINT IT                             60360020
VALFLG   N     REG,MASK            GET RID OF UNNEED BITS               60420002
         STC   REG,RCMSG+12        STORE NO. IN RETRY CODE MSG          60480002
         OI    RCMSG+12,X'F0'      MAKE PRINTABLE                       60540020
         MH    REG,CONST                                                60600002
         LA    REG,MSGSTRT(REG)    SET UP MSG INDEX                     60660002
         MVC   33(44,SETUPADR),0(REG)  MOVE MSG TO BUFFER               60720002
BUFIT    BAL   BRANPRT,XWRTPRT     PRINT IT                             60780020
         MVC   34(14,SETUPADR),RCMSG  MOVE RETRY MSG TO BUFFER          60840020
BUFITA   BAL   BRANPRT,XWRTPRT                                          60900020
         TM    CMPLBITS,X'08'      IS DISCONNECT IN SET           19032 60960020
         BNO   NOTDISIN            NO, SKIP MSG                   19032 61020020
         MVC   SETUPBFR(23),DISCIN SET UP MSG                     19032 61080020
         BAL   BRANPRT,XWRTPRT     PRINT MSG                      19032 61140020
NOTDISIN EQU   *                                                  19032 61200020
*                                                                       61260020
*                                  TEST NO-RETRY BIT                    61320020
         TM    SOFWFLGS,X'01'          IF NORETRY BIT IS NOT ON,BRANCH  61380020
*                                      TO PRINT VALID INDICATOR MSG.    61440020
         BZ    VALIDIND                                                 61500020
         MVC   SETUPBFR(28),NORETRY    INDICATES THAT THE BIT WAS ON.   61560020
         BAL   BRANPRT,XWRTPRT         WRITE THE MESSAGE.               61620020
         B     RETCNTL                 RETURN CONTROL.                  61680020
VALIDIND MVC   SETUPBFR(29),VALIDITY   RECORDED DATA HEADING TO BUFFER  61740020
         BAL   BRANPRT,XWRTPRT         INDICATOR HEADER.                61800020
*                                                                       61860020
*                                  TEST VALID RETRY CODE                61920020
*                                                                       61980020
*                                                                       62040020
*                            TEST COUNT BIT                             62100020
         MVC   SETUPBFR(42),VALCOUNT   BUFFER THE BASIC MESSAGE.        62160020
         TM    SOFWFLGS,X'02'          TEST COUNT VALIDITY.             62220020
         BZ    INVCOUNT                IF OFF, PRINT INVALID MSG.       62280020
         MVC   33(9,SETUPADR),37(SETUPADR) MODIFY THE BASIC MESSAGE.    62340020
INVCOUNT BAL   BRANPRT,XWRTPRT         WRITE MESSAGE.                   62400020
*                                                                       62460020
*                            TEST FOR SENSE DATA STORED                 62520020
*                                                                       62580020
         MVC   SETUPBFR(43),SENSDATA   BUFFER THE BASIC MESSAGE.        62640020
         TM    SOFWFLGS,X'04'          TEST SENSE BIT.                  62700020
         BZ    NOSTORE                 IF OFF BRANCH TO WRITE NOSTORE.  62760020
         MVC   33(10,SETUPADR),37(SETUPADR) MODIFY THE BASIC MESSAGE.   62820020
NOSTORE  BAL   BRANPRT,XWRTPRT         WRITE THE MESSAGE.               62880020
*                            TEST UNIT STATUS BIT                       62940020
         MVC   SETUPBFR(42),INVALUN    BUFFER THE BASIC MESSAGE.        63000020
         TM    VALFLAGS,X'08'          TEST FOR VALID UNIT STATUS.      63060020
         BZ    WRTOUT                  UNIT STATUS INVALID.             63120020
         MVC   33(9,SETUPADR),37(SETUPADR) MODIFY THE BASIC MESSAGE.    63180020
WRTOUT   BAL   BRANPRT,XWRTPRT         WRITE MESSAGE.                   63240020
*                                                                       63300020
*                            TEST COMMAND ADDRESS BIT                   63360020
*                                                                       63420020
         MVC   SETUPBFR(42),INVALCAD   MOVE INVALID COM MSG TO BUFFER.  63480020
         TM    VALFLAGS,X'04'          TEST FOR VALID COMMAND ADDRESS.  63540020
         BZ    PTOUT                   COMMAND ADDRESS INVALID.         63600020
         MVC   33(9,SETUPADR),37(SETUPADR) MODIFY THE BASIC MESSAGE.    63660020
PTOUT    BAL   BRANPRT,XWRTPRT         WRITE THE MESSAGE.               63720020
*                                                                       63780020
*                            TEST CHANNEL ADDRESS BIT                   63840020
*                                                                       63900020
         MVC   SETUPBFR(42),INVALCHA   MOVE INVALID CHN MSG TO BFR.     63960020
         TM    VALFLAGS,X'02'          TEST FOR VALID CHANNEL ADDRESS.  64020020
         BZ    OUTWRT                  INVALID CHANNEL ADDRESS.         64080020
         MVC   33(9,SETUPADR),37(SETUPADR) MODIFY THE BASIC MESSAGE.    64140020
OUTWRT   BAL   BRANPRT,XWRTPRT         WRITE MESSAGE.                   64200020
*                                                                       64260020
*                            TEST FOR VALID DEVICE ADDRESS              64320020
*                                                                       64380020
         MVC   SETUPBFR(42),INVALDVA   MOVE INVALID DVC ADDR MSG TO BFR 64440020
         TM    VALFLAGS,X'01'          TEST FOR VALID DEVICE ADDRESS.   64500020
         BZ    OUTPRT                  INVALID DEVICE ADDRESS.          64560020
         MVC   33(9,SETUPADR),37(SETUPADR) MODIFY THE BASIC MESSAGE.    64620020
OUTPRT   BAL   BRANPRT,XWRTPRT         WRITE MESSAGE.                   64680020
*                                                                       64740020
*        PROBABLE SOURCE OF ERROR                                       64800020
*                                                                       64860020
         MVC   SETUPBFR(29),PSOERR      INSERT BASE MSG IN BUFFER       64920020
         CLI   PROBERR,X'80'            TEST FOR CPU ERROR              64980020
         BE    CPUER                    BRANCH TO SET UP CPU ERR MSG    65040020
         CLI   PROBERR,X'40'            TEST FOR CHANNEL ERROR          65100020
         BE    CHNER                    BRANCH TO SETUP CHANNEL ERROR   65160020
         CLI   PROBERR,X'20'       TEST FOR SCU ERROR             19032 65220020
         BE    SCUER               YES- GO SET UP FOR SCU ERRMSG  19032 65280020
         CLI   PROBERR,X'10'            TEST FOR STORAGE ERROR          65340020
         BE    STORGER                  GO SETUP STORAGE ERROR MSG      65400020
         CLI   PROBERR,X'08'            TEST FOR I/O INTERFACE ERROR    65460020
         BE    INFER                    GO SETUP I/O INTF ERROR MSG     65520020
         MVC   30(25,SETUPADR),NOTVM    SETUP NOT ASSESSABLE MESSAGE    65580020
         B     WPRMSG                   GO PRINT MSG                    65640020
CPUER    MVC   30(3,SETUPADR),CPUERMSG  BUFFER CPU ERROR MESSAGE        65700020
         B     WPRMSG                   GO PRINT                        65760020
CHNER    MVC   30(7,SETUPADR),CHANERMS  SETUP CHANNEL ERROR MESSAGE     65820020
         B     WPRMSG                   GO PRINT                        65880020
SCUER    MVC   30(20,SETUPADR),SCUERMS  SET UP SCU MSG            19032 65940020
         B     WPRMSG                   GO PRINT IT               19032 66000020
STORGER  MVC   30(7,SETUPADR),STOGERMS  SETUP STORAGE ERROR MESSAGE     66060020
         B     WPRMSG                   GO PRINT                        66120020
INFER    MVC   30(13,SETUPADR),IOINFER  SET UP INTERFACE ERROR MESSAGE  66180020
WPRMSG   BAL   BRANPRT,XWRTPRT          PRINT MESSAGE                   66240020
         B     RETCNTL                                                  66300020
*                                                                       66360020
*                            TEST COMPLETION CODE                       66420020
*                                                                       66480020
TEST1    MVC   SETUPBFR(23),COMCODE    INSERT COMPLETION CODE MESSAGE   66540020
*                                      IN PRINT BUFFER.                 66600020
         TM    CMPLBITS,X'C0'          TEST FOR COMPLETION CODE '3'.    66660020
         BO    SYSRET                  BRANCH FOR SYS RESET MSG OUTPUT. 66720020
         TM    CMPLBITS,X'80'          TEST FOR COMPLETION CODE '2'     66780020
         BO    SELRET                  BRANCH FOR SEL RESET MSG OUTPUT. 66840020
         TM    CMPLBITS,X'40'          TEST FOR COMPLETION CODE '1'     66900020
         BO    FORENDSQ                BRANCH FOR FORCED END MSG OUTPUT 66960020
*                                                                       67020020
*                            INTERFACE DISCONNECT                       67080020
*                                                                       67140020
         MVC   SET2(29),INTDISCN      SET UP INTERFACE DISCONNECT MSG   67200020
         B     WRITER                  MESSAGE AND WRITE IT OUT.        67260020
*                                                                       67320020
*                            SYSTEM RESET                               67380020
*                                                                       67440020
SYSRET   MVC   SET2(21),SYSRES        SETUP  THE SYSTEM RESET MSG AND   67500020
         B     WRITER                  WRITE IT OUT.                    67560020
*                                                                       67620020
*                            SELECTIVE RESET                            67680020
*                                                                       67740020
SELRET   MVC   SET2(24),SELRES          SETUP SELECTIVE RESET  MSG AND  67800020
         B     WRITER                  AND WRITE IT OUT.                67860020
*                                                                       67920020
*                            FORCED ENDING SEQUENCE                     67980020
*                                                                       68040020
FORENDSQ MVC   SET2(31),FORCEND         SETUP FORCE END MESSAGE AND     68100020
*                                      WRITE IT OUT.                    68160020
*                                                                       68220020
*                            OUTPUT OF COMPLETION                       68280020
*                              CODE MESSAGES                            68340020
*                                                                       68400020
WRITER   BAL   BRANPRT,XWRTPRT                                          68460020
         B     TEST                                                     68520020
*                                                                       68580020
*                                 RETURN CONTROL                        68640020
*                                                                       68700020
RETCNTL  EQU   *                                                  19032 68760020
         MVI   SETUPBFR+1,C'*'                                          68820020
         MVC   2(78,SETUPADR),1(SETUPADR)                               68880020
         MVI   0(SETUPADR),C'-'         SETUP TO SPACE TWICE            68940020
         BAL   BRANPRT,XWRTPRT                                          69000020
FIN1     DS    0C                                                       69300020
         LA    R0,0                     ZERO WORK REGISTER              69360020
         ST    R0,NXENTRY               CLEAR ENTRY POINTER             69420020
         L     R13,SVR13                RESTORE REG 13                  69480020
         LM    R14,R12,12(R13)          RESTORE REGISTERS               69540020
         BR    R14                      RETURN                          69600020
         SPACE                                                          72840020
****    ROUTINE TO RETURN CONTROL TO CONTROL MODULE                     72900020
XWRTPRT  DS    0C                                                       72960020
         ST    BRANPRT,NXENTRY          STORE LINK ADDRESS              73020020
         STM   R12,R10,MYSAVE           SAVE SUBROUTINE REGS            73080020
         L     R0,RTNPTR                LOAD ADCON FOR RETURN POINTER   73140020
         L     R1,RG9PTR                LOAD POINTER TO REG9            73200020
         ST    R0,AD0(R1)               STORE RETURN POINTER            73260020
         L     R0,LBLPTR                LOAD POINTER TO LABEL           73320020
         L     R1,LPPTR                 LOAD POINTER TO LP              73380020
         ST    R0,AD0(R1)               STORE LABEL POINTER             73440020
         MVI   AD0(R3),X09              SET CARRIAGE CTL CHARACTER      73470020
         L     R13,SVR13                RESTORE REG 13                  73500020
         LM    R14,R12,12(R13)          RESTORE REGISTERS               73560020
         BR    R14                      RETURN                          73620020
*                                                                       73680020
*                            STORAGE                                    73740020
*                                                                       73800020
XLABELP  EQU   LP                                                       73800202
WORK     EQU   XWORK                                                    73800402
TYPE     EQU   XDADBUF+5                                           MP   73920020
ENVCH    EQU   XDADBUF+56                                          MP   73980020
ENVMS    EQU   XDADBUF+63                                          MP   74040020
GPRMS    EQU   XDADBUF+248                                         MP   74100020
CPULOG   EQU   GPRMS+108                                           MP   74160020
CPULOGED EQU   CPULOG+8                                            MP   74220020
CPULOGJE EQU   CPULOG+2                FRAME SIX LOW BIT           2MEG 74280020
CPULOGPP EQU   CPULOG+12                                           MP   74340020
CPULOGG  EQU   CPULOG+65                                           MP   74400020
CPULOGVD EQU   CPULOG+66                                           MP   74460020
CPULOGMO EQU   CPULOG+70        FRAME 5-8 BITS                     2MEG 74520020
ONEVD    EQU   X'01'                                               MP   74580020
TWEN     EQU   X'20'                                               MP   74640020
EIGHTY   EQU   X'80'                                               MP   74700020
VDSTAR   EQU   XPRTBUF+79                                          MP   74760020
PLACE    EQU   ENVCH+32                                            MP   74820020
F252     EQU   252                                                 MP   74880020
FROMVD   EQU   GPRMS+32                                            MP   74940020
OCTVD    EQU     80                                                MP   75000020
AREAVD   EQU   GPRMS+92                                            MP   75060020
ID       EQU   X'08'                                               MP   75120020
MSBIT    EQU   X'10'                                                MP  75180020
K0       EQU   0                                                  19E03 75240020
K2       EQU   2                                                  19E03 75360020
K4       EQU   4                                                  19E03 75420020
K8       EQU   8                                                  19E03 75480020
K10      EQU   10                                                 19E03 75540020
K20      EQU   20                                                 19E02 75600020
K21      EQU   21                                                 19E02 75660020
K24      EQU   24                                                 19E03 75720020
FOXDOG   EQU   X'FD'                                              19E03 75780020
REL19    EQU   19                                                 19E02 75840020
XPRTBUF1 EQU   XPRTBUF+1                                          19E03 75900020
MODA48   DC    X'0155'                  MODEL 155 - NS A48        19E02 75960020
DECCOUNT DS    F                                                  19E03 76080020
*                                                                       76140020
SETUPBFR EQU   XPRTBUF                                                  76200020
CSWORD   DC    D'0'                CSW LOCATION                   19032 76260020
ERPIBFLD DC    F'0'                LAST HALF ERPIB                19032 76320020
MULTISYS DC    F'0'                MULTI-PROCESSING INFO          19032 76380020
MASK     DC    F'7'                                                     76440020
CONST    DC    H'44'                                                    76500020
TWOX     DC    H'2'                                                     76560020
SET1     EQU   SETUPBFR+22                                              76620020
SET2     EQU   SETUPBFR+21                                              76680020
*                                                                       76740020
*                            REGISTERS                                  76800020
REG      EQU   11                                                       76860002
UPKREG   EQU   6                       ADDRESSES UNPACK AREA.           76920020
SETUPADR EQU   7                       ADDRESSES PRINT BUFFER.          76980020
PRTABREG EQU   8                       ADDRESSES CONVERSION TABLE.      77040020
BASEREG  EQU   9                       BASE REGISTER.                   77100020
BRANPRT  EQU   11                      ADDRESSES PRINT ROUTINE.         77160020
CLEAREG  EQU   12                                                       77220020
SAVADDR  EQU   13                      ADDRESSES REGISTER SAVE AREA.    77280020
BRANADDR EQU   14                      BRANCH REGISTER.                 77340020
*                                                                       77400020
*                            MESSAGES                                   77460020
*                                                                       77520020
*                                                                       77580020
CAUSERR  DC    C'-  CSW STORED BY  --             '                     77640020
ERRINT   DC    C'-  CSW STORED BY  INTERRUPT               '            77700020
ERRSIO   DC    C'SIO'                                                   77760020
ERRTIO   DC    C'TIO'                                                   77820020
ERRHIO   DC    C'HIO'                                                   77880020
NOUCB    DC    C'   NO ADDITIONAL ERROR INFORMATION AVAILABLE.'         77940020
COMCODE  DC    C'   TERMINATION BY  --  '                               78000020
SYSRES   DC    C' SYSTEM RESET- CODE 3'                                 78060020
SELRES   DC    C' SELECTIVE RESET- CODE 2'                              78120020
FORCEND  DC    C' FORCED ENDING SEQUENCE- CODE 1'                       78180020
INTDISCN DC    C' INTERFACE DISCONNECT- CODE 0'                         78240020
RETCDVAL DC    C'   TIME CHANNEL DETECTED ERROR -'                      78300020
RCMSG    DC    C'RETRY CODE    '                                        78360020
MSGSTRT  DC    C' WHILE EXECUTING TIO                        '          78420020
         DC    C' BETWEEN COMMAND OUT AND UNIT STATUS RETURN '          78480020
         DC    C' COMMAND ACCEPTED BUT BEFORE DATA TRANSFER  '          78540020
         DC    C' SOME DATA TRANSFER-CSW COMMAND ADR UPDATED '          78600020
         DC    C' COMMAND REJECTED OR COMMAND OUT NOT SENT   '          78660020
         DC    C' COMMAND ACCEPTED-DATA TRANSFER UNDETERMINED'          78720020
         DC    C' COULD NOT BE ASSESSED                      '          78780020
NOTVM    DC    C' COULD NOT BE ASSESSED                      '          78840020
NORETRY  DC    C'0  PROGRAM ASSESSED NO RETRY'                          78900020
DISCIN   DC    C'   DISCONNECT IN ISSUED'                         19032 78960020
VALIDITY DC    C'0  VALIDITY OF RECORDED DATA '                         79020020
VALCOUNT DC    C'            COUNT              = NOT VALID'            79080020
SENSDATA DC    C'            SENSE DATA         = NOT STORED'           79140020
INVALUN  DC    C'            UNIT STATUS        = NOT VALID'            79200020
INVALCAD DC    C'            COMMAND ADDRESS    = NOT VALID'            79260020
INVALCHA DC    C'            CHANNEL ADDRESS    = NOT VALID'            79320020
INVALDVA DC    C'            DEVICE ADDRESS     = NOT VALID'            79380020
PSOERR   DC    C'0  PROBABLE SOURCE OF ERROR- '                         79440020
CPUERMSG DC    C'CPU'                                                   79500020
CHANERMS DC    C'CHANNEL'                                               79560020
SCUERMS  DC    C'STORAGE CONTROL UNIT'                            19032 79620020
STOGERMS DC    C'STORAGE'                                               79680020
IOINFER  DC    C'CONTROL UNIT '                                         79740020
HEADER   DC    C' CHANNEL  ERROR  ANALYSIS'                             79800020
MSHEAD   DC    C'MULTI-SYSTEM INFORMATION'              MESSAGES   MP   80100020
MSCPUID  DC    C'CPU 1 FAILED'                           FOR        MP  80160020
MSCPUST  DC    C'CPU STATUS WAS '              ONLY THE            MP   80220020
PART     DC    C'PARTITIONED'                           M65MP TO BE  MP 80280020
SHAR     DC    C'SHARED'                        ONLY                MP  80340020
RECON    DC    C' BUT RECONFIGURED OUT'                 WRITTEN ON  MP  80400020
CHCNFIG  DC    C'CPU 1 CHANNEL CONFIGURATION'            SEC       MP   80460020
CHTAB    DC    C'CH0--ON CH1--ON CH2--ON CH3--ON CH4--ON'  *       MP   80520020
         DC    C' CH5--ON CH6--ON'                    STORAGE  FOR   MP 80580020
MSASR    DC    C'INBOARD RECORD ENTRY CONSTRUCTED BY MCH'  *        MP  80640020
MSNERPIB DC    C'ERPIB NOT CREATED'         EREP RECORDS           MP   80700020
NXENTRY  DC    F'0'                                                     81060020
OFF      DC    C'OFF'                         CONSTANTS            MP   81180020
         DC    C'LINE   '                       MESSAGES            MP  81240020
RTNPTR   DC    A(PRTERPIB-4)                                            81780020
RG9PTR   DC    A(REG9)                                                  81840020
LBLPTR   DC    A(LABELEND-1)                                            81900020
LPPTR    DC    A(LP)                                                    81960020
MYSAVE   DS    15F                                                      82020020
SVR13    DS    1F                                                       82080020
VS2FLG   DC    X'00'                                           @YL02021 82280002
VS2      DC    A(VS2FLG)                                       @YL02021 82480002
CONTAB   DC    C'0123456789ABCDEF'     HEX CHARACTERS F0-F6        MP   82740020
LEVELVD  EQU    3            MODULE LEVEL INDICATOR                MP   82800020
         DROP  R15                                                      82860020
CHNTYPE  DS    0C                                                       82920020
         USING *,R15                                                    82980020
         MVC   AD1(L7,R3),MSGA          MOVE UNKNOWN TYPE MSG           83040020
         CLI   AD0(R4),K3               COMPARE CHN TYPE TO A 3         83100020
         BCR   CC2,R14                  BRANCH IF CHN TYPE HIGH         83160020
         BL    CHNTYPE0                 BRANCH IF CHN TYPE LOW          83220020
         MVC   AD1(L14,R3),MSGB         CHN TYPE IS INTGTD BLK MPX      83280020
         BR    R14                      RETURN                          83340020
CHNTYPE0 DS    0C                                                       83400020
         CLI   AD0(R4),K1               COMPARE CHN ID TO A 1           83460020
         BCR   CC4,R14                  BRANCH IF CHN TYPE LOW          83520020
         BH    CHNTYPE1                 BRANCH IF CHN TYPE HIGH         83580020
         MVC   AD1(L10,R3),MSGC         CHN TYPE IS INTGTD MPX          83640020
         BR    R14                      RETURN                          83700020
CHNTYPE1 DS    0C                                                       83760020
         MVC   AD1(L10,R3),MSGD         CHN TYPE IS INTGTD SEL          83820020
         BR    R14                      RETURN                          83880020
MSGA     DC    C'UNKNOWN'                                               83940020
MSGB     DC    C'INTGTD BLK MPX'                                        84000020
MSGC     DC    C'INTGTD MPX'                                            84060020
MSGD     DC    C'INTGTD SEL'                                            84120020
         DROP  R15                                                      84180020
         EJECT                                                          84240020
FORMAT1  DC    F'0'                                                     84300020
FORMAT2  DC    F'0'                                                     84360020
LABELPTR DC    A(LABLAREA)                                              84420020
DISP     DC    FL2'0'                                                   84480020
         SPACE 2                                                        84540020
         DC    X'01'                                                    84600020
         DC         X'000B8B00'         SKIP TO CHANNEL 1               84660020
         LABEL ' '                                                      84720020
*                                                                       84780020
         LINE       (9,40),(1,35),SKIP=2                                84840020
         HEX        XMOD,0,2B                                           84900020
         HEX        XSER,0,3B                                           84960020
         LABEL      'MODEL','SERIAL NO.'                                85020020
*                                                                       85080020
         LINE  (10,)                                                    85081002
         SYSRELN    XRELN,1                                    @D35UGFD 85082000
         LABEL      ''                                         @D35UGFD 85092000
         LINE       (21,40)                                             85140020
         ROUTINE    XKEY,SETSOURC                                       85200020
         LABEL      '--- RECORD SOURCE -','TYPE - INBOARD'              85260020
*                                                                       85320020
         LINE                                                           85380020
         ROUTINE    XJOBN,SETPGMN                                       85440020
         LABEL      'JOB NAME'                                          85500020
*                                                                       85560020
         LINE       ,(8,40),SKIP=1                                      85620020
         ROUTINE    XSWS8,CONVTIME                                      85680020
         LABEL      'DAY  YEAR','HH MM SS.TH'                           85740020
         LINE       (8,40),(1,40),SKIP=2                                85800020
         ROUTINE    XDATE,SETDATE                                       85860020
         HEX        XTIME,1,4B                                          85920020
         LABEL      'DATE _','TIME _'                                   85980020
*                                                                       86040020
         LINE       (23,1),(1,1)                                        86100020
         HEX        XCUA,0,3B                                           86160020
         LABEL      'CHANNEL/UNIT ADDRESS'                              86220020
         LINE  (30),(1)                                        @YL02021 86227002
         ROUTINE   XKEY,ISITVS2                                @YL02021 86234002
         HEX   VCUA                                            @YL02021 86241002
         LABEL 'ADDR.STORED IN LOC 184'                        @YL02021 86248002
*                                                                       86280020
         LINE       ,(14,1),SKIP=1                                      86340020
         ROUTINE    XKEY,SKIPPER                                        86400020
         LABEL      'CC   DA    FL     CT'                              86460020
         LINE       (14,3),(1,1),SKIP=2                                 86520020
         HEX        XFCCWCC,0,1B                                        86580020
         HEX        XFCCWDA,0,3B                                        86640020
         ROUTINE    XKEY,SPACER2                                        86700020
         HEX        XFCCWFL,0,1B                                        86760020
         HEX        XFCCW0,0,1B                                         86820020
         HEX        XFCCWCT,0,2B                                        86880020
         LABEL      'FAILING CCW'                                       86940020
*                                                                       87000020
         LINE       ,(14,1),SKIP=1                                      87060020
         ROUTINE    XKEY,SKIPPER                                        87120020
         LABEL      'K    CA    US CS  CT'                              87180020
         LINE       (14,3),(1,1),SKIP=2                                 87240020
         HEX        XCSWK,0,1B                                          87300020
         HEX        XCSWCA,0,3B                                         87360020
         ROUTINE    XKEY,SPACER2                                        87420020
         ROUTINE    XCSWUS0,SETHEX                                      87480020
         ROUTINE    XCSWCS0,SETHEX                                      87540020
         HEX        XCSWCT,0,2B                                         87600020
         LABEL      'CSW'                                               87660020
*                                                                       87720020
         LINE       ,(2,38),SKIP=1                                      87780020
         ROUTINE    XKEY,SKIPPER                                        87840020
         LABEL      'UNIT STATUS','CHANNEL STATUS'                      87900020
*                                                                       87960020
         LINE       (21,38),(3,38)                                      88020020
         BIN        XCSWUS0                                             88080020
         BIN        XCSWCS0                                             88140020
         LABEL      'ATTENTION','PRGM-CTLD IRPT'                        88200020
         LINE                                                           88260020
         BIN        XCSWUS1                                             88320020
         BIN        XCSWCS1                                             88380020
         LABEL      'STATUS MODIFIER','INCORRECT LENGTH'                88440020
         LINE                                                           88500020
         BIN        XCSWUS2                                             88560020
         BIN        XCSWCS2                                             88620020
         LABEL      'CONTROL UNIT END','PROGRAM CHECK'                  88680020
         LINE                                                           88740020
         BIN        XCSWUS3                                             88800020
         BIN        XCSWCS3                                             88860020
         LABEL      'BUSY','PROTECTION CHECK'                           88920020
         LINE                                                           88980020
         BIN        XCSWUS4                                             89040020
         BIN        XCSWCS4                                             89100020
         LABEL      'CHANNEL END','CHAN DATA CHECK'                     89160020
         LINE                                                           89220020
         BIN        XCSWUS5                                             89280020
         BIN        XCSWCS5                                             89340020
         LABEL      'DEVICE END','CHAN CTRL CHECK'                      89400020
         LINE                                                           89460020
         BIN        XCSWUS6                                             89520020
         BIN        XCSWCS6                                             89580020
         LABEL      'UNIT CHECK','I/F CTRL CHECK'                       89640020
         LINE       ,,SKIP=2                                            89700020
         BIN        XCSWUS7                                             89760020
         BIN        XCSWCS7                                             89820020
         LABEL      'UNIT EXCEPTION','CHAINING CHECK'                   89880020
*                                                                       89940020
         LINE       ,(1,1),SKIP=1                                       90000020
         ROUTINE    XKEY,SKIPPER                                        90060020
         LABEL      'I/O UNIT FOUND BUSY'                               90120020
         LINE       (27,5),(2,1),SKIP=2                                 90180020
         HEX        XAIO1                                               90240020
         HEX        XAIO2                                               90300020
         HEX        XAIO3                                               90360020
         HEX        XAIO4                                               90420020
         HEX        XAIO5                                               90480020
         HEX        XAIO6                                               90540020
         HEX        XAIO7                                               90600020
         HEX        XAIO8                                               90660020
         ROUTINE    XKEY,SETAIO                                         90720020
         LABEL      'CHANNEL/UNIT ADDR'                                 90780020
*                                                                       90840020
         LINE       ,(1,1),SKIP=1                                       90900020
         LABEL      '--- CHANNEL TYPE ---'                              90960020
         LINE       (2,1),,SKIP=2                                       91020020
         ROUTINE    XCHID,CHNTYPE                                       91080020
         LABEL      ''                                                  91140020
         LINE       ,(1,1),SKIP=1                                       91200020
         LABEL      'HEADER SENSE SWITCHES FOUND ON'                    91260020
         LINE       ,(2,1)                                              91320020
         ROUTINE    XSWS8,CHKSW9                                        91380020
         LABEL      'RECORD INCOMPLETE'                                 91440020
         LINE                                                           91500020
         ROUTINE    XSWS8,CHKSW10                                       91560020
         LABEL      'SYSTEM TERMINATED'                                 91620020
         LINE                                                           91680020
         ROUTINE    XSWS8,CHKSW11                                       91740020
         LABEL      'UNSUPPORTED CHANNEL'                               91800020
         LINE                                                           91860020
         ROUTINE    XSWS8,CHKSW12                                       91920020
         LABEL      'CUA ILLEGAL'                                       91980020
         LINE                                                           92040020
         ROUTINE    XSWS8,CHKSW13                                       92100020
         LABEL      'PORTION OF RECORD HAS BEEN DESTROYED'              92160020
         LINE                                                           92220020
         ROUTINE    XSWS8,CHKSW14                                       92280020
         LABEL      'ERP WERE IN PROGRESS'                              92340020
         LINE                                                           92400020
         ROUTINE    XKEY,SKIPPER                                 P0417  92460020
         LABEL      ' '                                          P0417  92520020
PRTERPIB LINE       (1,1),(1,1),SKIP=1                                  92580020
         ROUTINE    XSWS8,IFCASR01                                      92640020
LABELEND LABEL      ''                                                  92700020
         LINE                                                           92710020
         LABEL ''                                                       92720020
         LINE  (1,1),(1,1),SKIP=2                              @YM2954P 92800002
         LABEL 'NO CHANNEL LOGOUT RECORDED'                    @YM2954P 92850002
         LINE  ,,SKIP=1                                        @YM2954P 92900002
         ROUTINE XCHID,VS2TEST                                 @YM2954P 92950002
         LABEL ''                                              @YM2954P 93000002
         LINE  (30),(1),SKIP=2                                 @YM2954P 93050002
         HEX   VCCHPR1                                         @YM2954P 93100002
         LABEL 'CCH FOOTPRINTS'                                @YM2954P 93150002
         LINE  (50,1),(20,1),SKIP=1                            @YM2954P 93200002
         BIN   VCCHPR01                                        @YM2954P 93250002
         LABEL 'IOS GPRS SAVED'                                @YM2954P 93300002
         LINE  ,                                               @YM2954P 93350002
         BIN   VCCHPR02                                        @YM2954P 93400002
         LABEL 'UCB ADDRESS ZERO'                              @YM2954P 93450002
         LINE  ,                                               @YM2954P 93500002
         BIN   VCCHPR03                                        @YM2954P 93550002
         LABEL 'ERPIB EXISTS'                                  @YM2954P 93600002
         LINE  ,                                               @YM2954P 93650002
         BIN   VCCHPR04                                        @YM2954P 93700002
         LABEL 'IGFCCHSI ENTERED'                              @YM2954P 93750002
         LINE  ,                                               @YM2954P 93800002
         BIN   VCCHPR05                                        @YM2954P 93850002
         LABEL 'IGFCCHII ENTERED'                              @YM2954P 93900002
         LINE  ,                                               @YM2954P 93950002
         BIN   VCCHPR06                                        @YM2954P 94000002
         LABEL 'IGFCCHFE ENTERED'                              @YM2954P 94050002
         LINE  ,                                               @YM2954P 94100002
         BIN   VCCHPR07                                        @YM2954P 94150002
         LABEL 'IGFC60 ENTERED'                                @YM2954P 94200002
         LINE  ,                                               @YM2954P 94250002
         BIN   VCCHPR08                                        @YM2954P 94300002
         LABEL 'IGFC70 ENTERED'                                @YM2954P 94350002
         LINE  ,                                               @YM2954P 94400002
         BIN   VCCHPR09                                        @YM2954P 94450002
         LABEL 'IGDC80 ENTERED'                                @YM2954P 94500002
         LINE  ,                                               @YM2954P 94550002
         BIN   VCCHPR10                                        @YM2954P 94600002
         LABEL 'IGFCIC ENTERED'                                @YM2954P 94650002
         LINE  ,                                               @YM2954P 94700002
         BIN   VCCHPR11                                        @YM2954P 94750002
         LABEL 'IGFCCHRD ENTERED'                              @YM2954P 94800002
         LINE  ,                                               @YM2954P 94850002
         BIN   VCCHPR12                                        @YM2954P 94900002
         LABEL 'IGFCCHMP ENTERED'                              @YM2954P 94950002
         LINE  ,                                               @YM2954P 95000002
         BIN   VCCHPR13                                        @YM2954P 95050002
         LABEL 'IGFCCHUC ENTERED'                              @YM2954P 95100002
         LINE  ,                                               @YM2954P 95150002
         BIN   VCCHPR14                                        @YM2954P 95200002
         LABEL 'IGFCCHAS ENTERED'                              @YM2954P 95250002
         LINE  ,                                               @YM2954P 95300002
         BIN   VCCHPR15                                        @YM2954P 95350002
         LABEL 'IGFCCHIO ENTERED'                              @YM2954P 95400002
         LINE  ,,SKIP=2                                        @YM2954P 95450002
         BIN   VCCHPR16                                        @YM2954P 95500002
         LABEL 'IGFCCHEX ENTERED'                              @YM2954P 95550002
         LINE  ,(30,30),SKIP=2                                 @YM2954P 95600002
         ROUTINE    XCHID,SKIPPER                              @YM2954P 95650002
         LABEL 'MULTIPROCESSING INFORMATION'                   @YM2954P 95700002
         LINE  ,(49,1),SKIP=1                                  @YM2954P 95750002
         LABEL '0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15'         95800002
         LINE  (25,25),(30,30),SKIP=1                          @YM2954P 95850002
         HEX   (VPROC01)                                       @YM2954P 95900002
         ROUTINE    VCHST01,PROC                               @YM2954P 95950002
         LABEL ''                                              @YM2954P 96000002
         LINE  ,                                               @YM2954P 96050002
         HEX   (VPROC02)                                       @YM2954P 96100002
         ROUTINE    VCHST02,PROC                               @YM2954P 96150002
         LABEL ''                                              @YM2954P 96200002
         LINE  ,                                               @YM2954P 96250002
         HEX   (VPROC03)                                       @YM2954P 96300002
         ROUTINE    VCHST03,PROC                               @YM2954P 96350002
         LABEL ''                                              @YM2954P 96400002
         LINE  ,                                               @YM2954P 96450002
         HEX   (VPROC04)                                       @YM2954P 96500002
         ROUTINE    VCHST04,PROC                               @YM2954P 96550002
         LABEL ''                                              @YM2954P 96600002
         LINE  ,                                               @YM2954P 96650002
         HEX   (VPROC05)                                       @YM2954P 96700002
         ROUTINE    VCHST05,PROC                               @YM2954P 96750002
         LABEL ''                                              @YM2954P 96800002
         LINE  ,                                               @YM2954P 96850002
         HEX   (VPROC06)                                       @YM2954P 96900002
         ROUTINE    VCHST06,PROC                               @YM2954P 96950002
         LABEL ''                                              @YM2954P 97000002
         LINE  ,                                               @YM2954P 97050002
         HEX   (VPROC07)                                       @YM2954P 97100002
         ROUTINE    VCHST07,PROC                               @YM2954P 97150002
         LABEL ''                                              @YM2954P 97200002
         LINE  ,                                               @YM2954P 97250002
         HEX   (VPROC08)                                       @YM2954P 97300002
         ROUTINE    VCHST08,PROC                               @YM2954P 97350002
         LABEL ''                                              @YM2954P 97400002
         LINE  ,                                               @YM2954P 97450002
         HEX   (VPROC09)                                       @YM2954P 97500002
         ROUTINE    VCHST09,PROC                               @YM2954P 97550002
         LABEL ''                                              @YM2954P 97600002
         LINE  ,                                               @YM2954P 97650002
         HEX   (VPROC10)                                       @YM2954P 97700002
         ROUTINE    VCHST10,PROC                               @YM2954P 97750002
         LABEL ''                                              @YM2954P 97800002
         LINE  ,                                               @YM2954P 97850002
         HEX   (VPROC11)                                       @YM2954P 97900002
         ROUTINE    VCHST11,PROC                               @YM2954P 97950002
         LABEL ''                                              @YM2954P 98000002
         LINE  ,                                               @YM2954P 98050002
         HEX   (VPROC12)                                       @YM2954P 98100002
         ROUTINE    VCHST12,PROC                               @YM2954P 98150002
         LABEL ''                                              @YM2954P 98200002
         LINE  ,                                               @YM2954P 98250002
         HEX   (VPROC13)                                       @YM2954P 98300002
         ROUTINE    VCHST13,PROC                               @YM2954P 98350002
         LABEL ''                                              @YM2954P 98400002
         LINE  ,                                               @YM2954P 98450002
         HEX   (VPROC14)                                       @YM2954P 98500002
         ROUTINE    VCHST14,PROC                               @YM2954P 98550002
         LABEL ''                                              @YM2954P 98600002
         LINE  ,                                               @YM2954P 98650002
         HEX   (VPROC15)                                       @YM2954P 98700002
         ROUTINE    VCHST15,PROC                               @YM2954P 98750002
         LABEL ''                                              @YM2954P 98800002
         LINE  ,                                               @YM2954P 98850002
         HEX   (VPROC16)                                       @YM2954P 98900002
         ROUTINE    VCHST16,PROC                               @YM2954P 98950002
         LABEL ''                                              @YM2954P 99000002
         SPACE 2                                               @YM2954P 99050002
DUMPCODE DC    XL1'FF'                                         @YM2954P 99100002
DUMPSIZE DC    XL2'9C'                                         @YM2954P 99150002
         DC    XL2'18'                                         @YM2954P 99200002
ADDRLABL DC    XL2'0'                                          @YM2954P 99250002
LABLAREA EQU   *                                               @YM2954P 99300002
         LSTART ,                                              @YM2954P 99350002
         END   ENTRYPTR                                        @YM2954P 99400002
