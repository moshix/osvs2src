         TITLE 'I F C E M A D 1  EDIT TABLE FOR 3350 SNB''S 0-7 AND FMTC00090002
                1 8-23'                                                 00180002
***  DSGEN MACRO     DSGEN MACRO     DSGEN MACRO     DSGEN MACRO    *** 00270002
         SPACE                                                          00360002
         MACRO                                                          00450002
&NAME    DSGEN                                                          00540002
.*                            THIS MACRO GENERATES ONE DSECT WORD       00630002
.*                                 FORMATTED FOR THE SUBJECT LOG RECORD 00720002
.*                                 EACH OPERAND HAS TWO SUB LISTS. THE  00810002
.*                                 FIRST IS THE NAME OF THE LOG ITEM    00900002
.*                                 WHILE THE SECOND IS THE # OF BITS TO 00990002
.*                                 ALLOCATE FOR THIS ITEM. ITEMS MUST   01080002
.*                                 BE DEFINED CONTIGUOUSLY WITHOUT GAPS 01170002
.*                                 UNUSED BIT GROUPS MUST BE GIVEN      01260002
.*                                 DUMMY NAMES. THE NAMES PROVIDED FOR  01350002
.*                                 THE LOG ITEMS MAY THEN BE USED IN    01440002
.*                                 THE CONVERSION MACRO INSTRUCTIONS.   01530002
         GBLA  &BITS(3000),&ITEMNBR,&SHIFT(3000)                        01620002
         GBLC  &ITEM(3000)                                              01710002
         LCLB  &ONLY1,&CTIND                                            01800002
         LCLA  &START1,&START2,&END1,&END2                              01890002
         LCLC  &SYMBOL,&EQUSYM                                          01980002
         LCLA  &OP,&COUNT,&BYTE,&EQUCNT                                 02070002
         ACTR  100000                                                   02160002
.START   AIF   (N'&SYSLIST(&OP+1) LT 3).LOOP                            02250002
         AIF   ('&SYSLIST(&OP+1,3)' EQ 'EQU').LOOP     TEST FOR EQU     02340002
  AIF   ('&SYSLIST(&OP+1,3)' EQ '' OR '&SYSLIST(&OP+1,4)' EQ '').ERR1   02430002
         AIF   ('&SYSLIST(&OP+1,3)' GT '&SYSLIST(&OP+1,4)').ERR3        02520002
&START1  SETA  &SYSLIST(&OP+1,3)        GET START COUNT OF 1            02610002
&START2  SETA  &SYSLIST(&OP+1,4)        GET FIRST END COUNT             02700002
         AGO   .SET2A                   BRANCH AROUND                   02790002
.ERR1    MNOTE '**FIRST SYMBOL CONCATENATION INCOMPLETE**'              02880002
         MEXIT                                                          02970002
.SET2A   AIF   ('&SYSLIST(&OP+1,5)' EQ ''AND '&SYSLIST(&OP+1,6)' EQ '' X03060002
               ).SET2                   TEST FOR NO SECOND              03150002
  AIF   ('&SYSLIST(&OP+1,5)' EQ '' OR '&SYSLIST(&OP+1,6)' EQ '').ERR2   03240002
         AIF   ('&SYSLIST(&OP+1,5)' GT '&SYSLIST(&OP+1,6)').ERR3        03330002
&END1    SETA  &SYSLIST(&OP+1,5)        GET START COUNT OF 2            03420002
&END2    SETA  &SYSLIST(&OP+1,6)        GET END COUNT OF 2              03510002
         AGO   .LOOP                                                    03600002
.SET2    ANOP                                                           03690002
&ONLY1   SETB  1                        INDICATE ONLY ONE CONCATENATION 03780002
         AGO   .LOOP                                                    03870002
.ERR2    MNOTE '**SECOND SYMBOL CONCATENATION INCOMPLETE**'             03960002
         MEXIT                                                          04050002
.ERR3    MNOTE '**START GREATER THAN END CONCATENATION**'               04140002
         MEXIT                                                          04230002
.LOOP    ANOP                                                           04320002
&OP      SETA  &OP+1                                                    04410002
         AIF   (&OP GT N'&SYSLIST).DONE      TEST IF ALL DONE           04500002
&ITEMNBR SETA  &ITEMNBR+1                                               04590002
         AIF   ('&SYSLIST(&OP,2)' NE '').OK1                            04680002
         MNOTE '**NULL BIT COUNT FIELD**'                               04770002
         MEXIT                                                          04860002
.OK1     ANOP                                                           04950002
&SYMBOL  SETC  '&SYSLIST(&OP,1)'                                        05040002
         AIF   ('&SYMBOL' NE '').OK                                     05130002
*              *****     LOG ITEM SYMBOL NOT PROVIDED     *****         05220002
         AIF   ('&SYSLIST(&OP,3)' NE 'EQU').CNT                         05310002
         AGO   .START                   GET NEXT                        05400002
.OK      AIF   (N'&SYSLIST(&OP) LT 3).NO3    TEST FOR OLD FORMAT        05490002
         AIF   ('&SYSLIST(&OP,3)' EQ 'EQU').EQU   TEST FOR EQU          05580002
         AIF   (&ONLY1).OK2             TEST FOR ONLY ONE CONCAT        05670002
&SYMBOL  SETC  '&SYMBOL.&START1.&END1'       GET 1 AND 2 CONCAT         05760002
         AGO   .NO3                     BRANCH AROUND                   05850002
.OK2     ANOP                                                           05940002
&SYMBOL  SETC  '&SYMBOL.&START1'        GET 1 CONCATENATED              06030002
.NO3     ANOP                                                           06120002
&SYMBOL  EQU   *+&BYTE                                                  06210002
&ITEM(&ITEMNBR) SETC '&SYMBOL'          GET LABEL IN GLOBAL             06300002
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2)                                    06390002
&SHIFT(&ITEMNBR) SETA &COUNT-&BYTE*8                                    06480002
.CNT     ANOP                                                           06570002
&CTIND   SETB  1                        SET COUNT INDICATOR             06660002
&COUNT   SETA  &COUNT+&SYSLIST(&OP,2)                                   06750002
&BYTE    SETA  &COUNT/8                                                 06840002
         AIF   (N'&SYSLIST(&OP) LT 3).START  TEST FOR OLD FORMAT        06930002
         AIF   (&ONLY1).TSTST           TEST FOR ONLY ONE CONCAT        07020002
         AIF   (&END1 EQ &END2).TSTST   TEST FOR SECOND END             07110002
&END1    SETA  &END1+1                  INCREMENT COUNT                 07200002
&OP      SETA  &OP-1                    DECREMENT INCREMENT             07290002
         AGO   .LOOP                    GENERATE NEXT                   07380002
.TSTST   ANOP                                                           07470002
         AIF   (&START1 EQ &START2).LPDONE   TEST FOR END               07560002
         AIF   (&ONLY1).NSET1           TEST FOR ONLY ONE CONCAT        07650002
&END1    SETA  &SYSLIST(&OP,5)          RE-INIT SECOND START COUNT      07740002
.NSET1   ANOP                                                           07830002
&OP      SETA  &OP-1                    DECREMENT INDEX                 07920002
&START1  SETA  &START1+1                INCREMENT FIRST COUNT           08010002
         AGO   .LOOP                    GO DO NEXT                      08100002
.LPDONE  ANOP                                                           08190002
&ONLY1   SETB  0                        CLEAR INDICATOR                 08280002
         AGO   .START                   GO TEST FOR MORE SUB-LISTS      08370002
.DONE    AIF   (&COUNT-&COUNT/8*8 NE 0).ERR  TEST FOR MULTIPLE OF EIGHT 08460002
         AIF   (&CTIND EQ 0).END        NO DS IF NO COUNT               08550002
&COUNT   SETA  &COUNT/8                 GET NUMBER OF BYTES             08640002
&NAME    DS    &COUNT.C                                                 08730002
.END     MEXIT                                                          08820002
.ERR     MNOTE '**BIT COUNT FLDS DO NOT TOTAL MULTIPLE OF 8**'          08910002
         MEXIT                                                          09000002
.EQU     AIF   ('&SYSLIST(&OP,4)' NE '').EQU1     TEST FOR NULL LABEL   09090002
.ERR4    MNOTE '**EQU OPERAND OMITTED OR NOT FOUND**'                   09180002
         MEXIT                                                          09270002
.EQU1    AIF   (&SYSLIST(&OP,2) LT 16).EQU2  COUNT OVER FIFTEEN         09360002
*****               THE FOLLOWING STATEMENT                *****        09450002
*****     NUMBER OF BITS EXCEED 15 - DO NOT USE AS BIN     *****        09540002
.EQU2    ANOP                                                           09630002
&EQUCNT  SETA  0                        CLEAR COUNTER                   09720002
&EQUSYM  SETC  '&SYSLIST(&OP,4)'        GET EQU OPERAND                 09810002
.EQULOP  ANOP                                                           09900002
&EQUCNT  SETA  &EQUCNT+1                INCREMENT INDEX                 09990002
         AIF   ('&ITEM(&EQUCNT)' EQ '&EQUSYM').EQUOUT  LABEL FOUND?     10080002
         AIF   (&EQUCNT EQ &ITEMNBR).ERR4    ALL TESTED?                10170002
         AGO   .EQULOP                  NO-GET NEXT                     10260002
.EQUOUT  ANOP                                                           10350002
&ITEM(&ITEMNBR) SETC '&SYMBOL'          GET LABEL NAME                  10440002
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2)    GET NUMBER OF BITS              10530002
&SHIFT(&ITEMNBR) SETA &SHIFT(&EQUCNT)   GET SHIFT COUNT                 10620002
&SYMBOL  EQU   &EQUSYM                  THIS SYMBOL EQUATED             10710002
         AGO   .START                   RETURN FOR NEXT                 10800002
         MEND                                                           10890002
         EJECT                                                          10980002
***  BIN MACRO       BIN MACRO       BIN MACRO       BIN MACRO      *** 11070002
         SPACE                                                          11160002
         MACRO                                                          11250002
         BIN                                                            11340002
.*                                 &SYSLIST(&OP,1) - NAME OF LOG ITEM   11430002
.*                                      RECORD DSECT                    11520002
.*                                 $SYSLIST(&OP,2) - NBR OF SPACES      11610002
.*                                      TO SKIP ON MULTIPLE             11700002
.*                                      PRINT OR NBR OF SPACES          11790002
.*                                      TO BACK UP FROM COLUMN FOR      11880002
.*                                      START OF PRINTING. THE LETTER   11970002
.*                                      B PRECEEDS THE NUMBER (B5) IF   12060002
.*                                      THE LATTER IS DESIRED. OMISSION 12150002
.*                                      OF THIS OPERAND FORCES OPTION 2 12240002
.*                                      WITH BACKUP SPACING EQUAL TO    12330002
.*                                 THE NUMBER OF BITS IN THE ITEM       12420002
.*                                 DEFINITION (VIA MACRO 'DSGEN').      12510002
.*                            A LIMIT OF 15 BITS IS IMPOSED FOR THE     12600002
.*                                 TOTAL NUMBER OF BITS TO PRINT.       12690002
         GBLA  &INITIAL                                                 12780002
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN                               12870002
         GBLC  &ITEM(3000),&DSECT                                       12960002
         GBLA  &BITS(3000),&ITEMNBR,&SHIFT(3000),&NRENTS                13050002
         LCLB  &B,&SUB                                                  13140002
         LCLA  &IBITS,&NDX,&ISHIFT,&K                                   13230002
         LCLA  &TEMP,&T,&OP                                             13320002
         LCLC  &S                                                       13410002
         ACTR  500000                                                   13500002
         AIF   (&DIAGTST EQ 0).NOMSG                                    13590002
         AIF   (&INITIAL EQ 0).NOMSG                                    13680002
         AIF   (&DIAGLIN EQ 1).NOMSG                                    13770002
         MNOTE '**NO LINE ASSOCIATED WITH THIS DATA**'                  13860002
*****THE FOLLOWING GENERATED FOR TEST PURPOSES*****                     13950002
*        LINE                                                           14040002
         LINE                                                           14130002
.NOMSG   ANOP                                                           14220002
         AIF   (K'&SYSLIST(1) EQ K'&SYSLIST(1,1)).LOOP                  14310002
&SUB     SETB  1                                                        14400002
.LOOP    ANOP                                                           14490002
&OP      SETA  &OP+1                                                    14580002
.LOOP1   ANOP                                                           14670002
&NDX     SETA  &NDX+1                                                   14760002
         AIF   ('&ITEM(&NDX)' EQ '&SYSLIST(&OP,1)').FOUND               14850002
         AIF   (&NDX LT &ITEMNBR).LOOP1                                 14940002
         MNOTE '**LOG ITEM NOT DEFINED**'                               15030002
         MEXIT                                                          15120002
.FOUND   ANOP                                                           15210002
&ISHIFT  SETA  &SHIFT(&NDX)                                             15300002
&IBITS   SETA  &BITS(&NDX)                                              15390002
         AIF   (&SUB EQ 1).SUB00                                        15480002
         AIF   ('&SYSLIST(3)' EQ '').SETT                               15570002
&IBITS   SETA  &SYSLIST(3)                                              15660002
         AGO   .SETT                                                    15750002
.SUB00   AIF   ('&SYSLIST(&OP,3)' EQ '').SETT                           15840002
&IBITS   SETA  &SYSLIST(&OP,3)                                          15930002
.SETT    ANOP                                                           16020002
&T       SETA  &IBITS-1                                                 16110002
&B       SETB  0                                                        16200002
         AIF   (&IBITS GT 0 AND &IBITS LT 16).SUB0                      16290002
         MNOTE '**NO. OF BITS OUTSIDE RANGE OF 1-15**'                  16380002
         MEXIT                                                          16470002
.SUB0    AIF   (&SUB EQ 1).SUBA                                         16560002
         AIF   ('&SYSLIST(2)' EQ '').BACKUP                             16650002
&K       SETA  K'&SYSLIST(2)                                            16740002
&B       SETB  ('&SYSLIST(2)'(1,1) EQ 'B')                              16830002
&S       SETC  '&SYSLIST(2)'(&B+1,&K-&B)                                16920002
         AGO   .SUBB                                                    17010002
.SUBA    ANOP                                                           17100002
         AIF   ('&SYSLIST(&OP,2)' EQ '').BACKUP                         17190002
&K       SETA  K'&SYSLIST(&OP,2)                                        17280002
&B       SETB  ('&SYSLIST(&OP,2)'(1,1) EQ 'B')                          17370002
&S       SETC  '&SYSLIST(&OP,2)'(&B+1,&K-&B)                            17460002
.SUBB    ANOP                                                           17550002
&T       SETA  &S                                                       17640002
.BACKUP  ANOP                                                           17730002
&NRENTS  SETA  &NRENTS+1                                                17820002
&TEMP    SETA  &ISHIFT                                                  17910002
         AIF   (&IBITS NE 1 OR &B NE 0).BIN2                            18000002
         DC    AL.12(&SYSLIST(&OP,1)-&DSECT),XL.4'&TEMP'                18090002
         AGO   .OUT                                                     18180002
.BIN2    AIF   (&SUB EQ 1).BIN2A                                        18270002
         AIF   ('&SYSLIST(2)' NE '').BIN3                               18360002
         AGO   .BIN2B                                                   18450002
.BIN2A   AIF   ('&SYSLIST(&OP,2)' NE '').BIN3                           18540002
.BIN2B   ANOP                                                           18630002
&B       SETB  1                                                        18720002
.BIN3    ANOP                                                           18810002
         DC    AL.12(&SYSLIST(&OP,1)-&DSECT),XL.4'C'                    18900002
         DC    BL.1'&B',AL.7(&T),AL.4(&IBITS),FL.4'&ISHIFT'             18990002
.OUT     ANOP                                                           19080002
&NDX     SETA  0                                                        19170002
         AIF   (&SUB EQ 0).OUTA                                         19260002
         AIF   (&OP LT N'&SYSLIST).LOOP                                 19350002
.OUTA    ANOP                                                           19440002
         MEND                                                           19530002
         EJECT                                                          19620002
***  HEX MACRO       HEX MACRO       HEX MACRO       HEX MACRO      *** 19710002
         SPACE                                                          19800002
         MACRO                                                          19890002
         HEX                                                            19980002
.*                            THIS MACRO FACILITATES GENERATION OF THE  20070002
.*                                 TABLE ENTRIES SPECIFYING HEX TYPE    20160002
.*                                 CONVERSIONS.                         20250002
.*                            &SYSLIST(&OP,1) - NAME OF DATA ITEM TO BE 20340002
.*                                 CONVERTED                            20430002
.*                            &SYSLIST(&OP,2) - # OF SPACES TO SKIP ON  20520002
.*                                 MULTIPLE PRINT OR NBR OF SPACES TO   20610002
.*                                 BACK UP FROM COLUMN FOR START OF     20700002
.*                                 PRINTING. THE LETTER B PRECEEDS THE  20790002
.*                                 NUMBER (B8) IF THE LATTER OPTION IS  20880002
.*                                 DESIRED. OMISSION OF THIS OPERAND    20970002
.*                                 FORCES OPTION 2 WITH BACKUP SPACING  21060002
.*                                 EQUAL TO THE NUMBER OF BYTES SPECI-  21150002
.*                                 FIED BY THE NEXT OPERAND (TWICE THIS 21240002
.*                                 NUMBER IF SUFFIX IS EXPLICITLY OR    21330002
.*                                 IMPLICITLY B).                       21420002
.*                            &SYSLIST(&OP,3) - NUMBER OF BYTES TO      21510002
.*                                 PROCESS. THIS NUMBER IS SUFFIXED     21600002
.*                                 WITH AN L,R, OR B TO STIPULATE       21690002
.*                                 PRINTING OF THE LEFT HALF, RIGHT     21780002
.*                                 HALF, OR BOTH HALVES OF THE BYTE     21870002
.*                                 RESPECTIVELY. OMISSION OF THIS       21960002
.*                                 OPERAND DEFAULTS TO B WITH THE NUM-  22050002
.*                                 BER OF BYTES EQUAL TO THE ITEM LNGTH 22140002
.*                            A NEW ENTRY IS GENERATED ONLY WHEN NECES- 22230002
.*                                 SARY. THIS MACRO MUST BE THE FIRST   22320002
.*                                 MACRO INSTRUCTION ISSUED FOR THE     22410002
.*                                 SUBJECT LINE(S).                     22500002
         GBLA  &BITS(3000),&ITEMNBR,&SHIFT(3000),&NRENTS                22590002
         GBLC  &ITEM(3000),&DSECT                                       22680002
         GBLA  &INITIAL                                                 22770002
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN                               22860002
         LCLB  &B,&SUB                                                  22950002
         LCLA  &IBITS,&NDX,&ISHIFT,&K,&T,&CODE,&BYTESP,&OP              23040002
         LCLC  &S,&LETTER                                               23130002
         ACTR  500000                                                   23220002
         AIF   (&DIAGTST EQ 0).NOMSG                                    23310002
         AIF   (&INITIAL EQ 0).NOMSG                                    23400002
         AIF   (&DIAGLIN EQ 1).NOMSG                                    23490002
         MNOTE '**NO LINE ASSOCIATED WITH THIS DATA**'                  23580002
*****THE FOLLOWING GENERATED FOR TEST PURPOSES*****                     23670002
*        LINE                                                           23760002
         LINE                                                           23850002
.NOMSG   ANOP                                                           23940002
         AIF   (K'&SYSLIST(1) EQ K'&SYSLIST(1,1)).LOOP                  24030002
&SUB     SETB  1                                                        24120002
.LOOP    ANOP                                                           24210002
&OP      SETA  &OP+1                                                    24300002
.LOOP1   ANOP                                                           24390002
&NDX     SETA  &NDX+1                                                   24480002
         AIF   ('&ITEM(&NDX)' EQ '&SYSLIST(&OP,1)').FOUND               24570002
         AIF   (&NDX LT &ITEMNBR).LOOP1                                 24660002
         MNOTE '**LOG ITEM NOT DEFINED**'                               24750002
         MEXIT                                                          24840002
.FOUND   ANOP                                                           24930002
&ISHIFT  SETA  &SHIFT(&NDX)                                             25020002
&IBITS   SETA  &BITS(&NDX)                                              25110002
         AIF   (&ISHIFT EQ 0 OR &ISHIFT EQ 4).ALIGN                     25200002
.ERR     MNOTE '**DATA NOT ALLIGNED ON HEX OR BYTE BOUNDARY**'          25290002
         MEXIT                                                          25380002
.ALIGN   ANOP                                                           25470002
&CODE    SETA  1                                                        25560002
         AIF   (&SUB EQ 1).SUBA                                         25650002
&K       SETA  K'&SYSLIST(3)                                            25740002
         AGO   .SUBB                                                    25830002
.SUBA    ANOP                                                           25920002
&K       SETA  K'&SYSLIST(&OP,3)                                        26010002
.SUBB    ANOP                                                           26100002
         AIF   (&K EQ 1).ERR3                                           26190002
         AIF   (&IBITS-(&IBITS/4)*4 EQ 0).OK                            26280002
         MNOTE '**BIT LENGTH SPECIFICATION INCONSISTENT WITH CONTROL**' 26370002
         MEXIT                                                          26460002
.OK      AIF   (&SUB EQ 1).SUBC                                         26550002
         AIF   ('&SYSLIST(3)' EQ '').USEDEFN                            26640002
&LETTER  SETC  '&SYSLIST(3)'(&K,1)                                      26730002
&S       SETC  '&SYSLIST(3)'(1,&K-1)                                    26820002
         AGO   .SUBD                                                    26910002
.SUBC    ANOP                                                           27000002
         AIF   ('&SYSLIST(&OP,3)' EQ '').USEDEFN                        27090002
&LETTER  SETC  '&SYSLIST(&OP,3)'(&K,1)                                  27180002
&S       SETC  '&SYSLIST(&OP,3)'(1,&K-1)                                27270002
.SUBD    ANOP                                                           27360002
&BYTESP  SETA  &S                                                       27450002
         AIF   ('&LETTER' EQ 'B').BOTH                                  27540002
         AIF   ('&LETTER' EQ 'L').LEFT                                  27630002
         AIF   ('&LETTER' EQ 'R').RIGHT                                 27720002
.ERR3    MNOTE '**PARAMETER 3 INCOMPLETE-DSGEN DEFINITION USED**'       27810002
         AGO   .USEDEFN                                                 27900002
.RIGHT   ANOP                                                           27990002
&CODE    SETA  2                                                        28080002
         AGO   .L                                                       28170002
.LEFT    ANOP                                                           28260002
&CODE    SETA  1                                                        28350002
         AGO   .L                                                       28440002
.USEDEFN ANOP                                                           28530002
&BYTESP  SETA  &IBITS/8                                                 28620002
.BOTH    AIF   (&ISHIFT NE 0).ERR                                       28710002
&CODE    SETA  3                                                        28800002
&T       SETA  &BYTESP*2-1                                              28890002
&S       SETC  '&T'                                                     28980002
.OK2     AIF   (&ISHIFT EQ 0).L                                         29070002
&CODE    SETA  2                                                        29160002
.L       ANOP                                                           29250002
&B       SETB  1                                                        29340002
         AIF   (&SUB EQ 1).SUBE                                         29430002
         AIF   ('&SYSLIST(2)' EQ '').BACKUP                             29520002
&K       SETA  K'&SYSLIST(2)                                            29610002
&B       SETB  ('&SYSLIST(2)'(1,1) EQ 'B')                              29700002
&S       SETC  '&SYSLIST(2)'(&B+1,&K-&B)                                29790002
         AGO   .SUBF                                                    29880002
.SUBE    ANOP                                                           29970002
         AIF   ('&SYSLIST(&OP,2)' EQ '').BACKUP                         30060002
&K       SETA  K'&SYSLIST(&OP,2)                                        30150002
&B       SETB  ('&SYSLIST(&OP,2)'(1,1) EQ 'B')                          30240002
&S       SETC  '&SYSLIST(&OP,2)'(&B+1,&K-&B)                            30330002
.SUBF    ANOP                                                           30420002
.BACKUP  ANOP                                                           30510002
&NRENTS  SETA  &NRENTS+1                                                30600002
         AIF   (&BYTESP GT 0 AND &BYTESP LT 16).SUB0                    30690002
         MNOTE '**NO. OF BYTES OUTSIDE RANGE OF 1-15**'                 30780002
         MEXIT                                                          30870002
.SUB0    AIF   (&SUB EQ 1).SUBG                                         30960002
         DC    AL.12(&SYSLIST(1)-&DSECT),XL.4'A'                        31050002
         AGO   .SUBH                                                    31140002
.SUBG    ANOP                                                           31230002
         DC    AL.12(&SYSLIST(&OP,1)-&DSECT),XL.4'A'                    31320002
.SUBH    ANOP                                                           31410002
         DC    BL.1'&B',FL.7'&S',AL.4(&BYTESP),FL.4'&CODE'              31500002
.OUT     ANOP                                                           31590002
&NDX     SETA  0                                                        31680002
         AIF   (&SUB EQ 0).OUTA                                         31770002
         AIF   (&OP LT N'&SYSLIST).LOOP                                 31860002
.OUTA    ANOP                                                           31950002
         MEND                                                           32040002
         EJECT                                                          32130002
***  LINE MACRO      LINE MACRO      LINE MACRO      LINE MACRO     *** 32220002
         SPACE                                                          32310002
         MACRO                                                          32400002
&NAME    LINE  &DATA,&LABEL,&SKIP=                                      32490002
.*                            THIS MACRO ESTABLISHES THE MARGINS OR     32580002
.*                                 COLUMN SETTINGS FOR EACH LINE. IT    32670002
.*                                 GENERATES NECESSARY CARRIAGE CONTROL 32760002
.*                                 ENTRIES. LASTLY IT DETERMINES THE    32850002
.*                                 NUMBER OF ENTRIES ASSOCIATED WITH    32940002
.*                                 THE PREVIOUS LINE AND STORES THAT #  33030002
.*                                 INTO THE APPROPRIATE BYTE.           33120002
.*                            &DATA(1) - CHARACTER POSITION TO BEGIN    33210002
.*                                 DATA.                                33300002
.*                            &DATA(2) - # OF SPACES BETWEEN SUCCESSIVE 33390002
.*                                 DATA COLUMN STARTING CHARACTERS.     33480002
.*                            &LABEL(1) - CHAR. POS. TO BEGIN LABELS.   33570002
.*                            &LABEL(2) - # SPACES BETWEEN LINE'S LABEL 33660002
.*                                 STARTING CHARACTERS.                 33750002
.*                            &SKIP= - # OF LINES TO ADVANCE CARRIAGE   33840002
.*                                 TO BEGIN NEXT PRINTED LINE.          33930002
.*                            NEW ENTRIES ARE GENERATED ONLY WHEN       34020002
.*                                 NECESSARY. OMISSION OF ITEMS MEANS   34110002
.*                                 THEY HAVE NOT CHANGED SINCE PREVIOUS 34200002
.*                                 SETTINGS. A LINE MACRO IS REQUIRED   34290002
.*                                 FOR EACH PRINTED LINE. IF NO SETTING 34380002
.*                                 CHANGES ARE REQUIRED ALL OPERANDS    34470002
.*                                 ARE OMITTED IN WHICH CASE ONLY THE   34560002
.*                                 # OF ENTRIES FOR THE PREVIOUS LINE   34650002
.*                                 IS COMPUTED. THIS MACRO MUST BE THE  34740002
.*                                 FIRST MACRO INSTRUCTION ISSUED FOR   34830002
.*                                 THE SUBJECT LINE                     34920002
         GBLA  &DB,&DT,&LB,&LT,&NRENTS                                  35010002
         GBLA  &LASTCC,&INITIAL                                         35100002
         GBLC  &NRENTSX                                                 35190002
         GBLC  &CARRCON                                                 35280002
         GBLB  &TEST                                                    35370002
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN                               35460002
         LCLA  &S                                                       35550002
         AIF   (&INITIAL EQ 0 OR &DIAGTST EQ 0).DIAGSET                 35640002
         AIF   (&DIAGSET EQ 0).DIAGSET                                  35730002
         MNOTE '**NO LABEL ASSOCIATED WITH LAST SET**'                  35820002
***** THE FOLLOWING GENERATED FOR TEST PURPOSES *****                   35910002
*        LABEL '%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%'       36000002
               LABEL '%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%' 36090002
.DIAGSET ANOP                                                           36180002
&DIAGSET SETB  1                                                        36270002
&DIAGLIN SETB  1                                                        36360002
&NAME    DS    0C                                                       36450002
         AIF   (&INITIAL EQ 0).FIRSTLN                                  36540002
         LINEND                                                         36630002
         AGO   .NTFIRST                                                 36720002
.FIRSTLN ANOP                                                           36810002
&NRENTSX SETC  'N&SYSNDX'                                               36900002
&INITIAL SETA  1                                                        36990002
N&SYSNDX EQU   *                                                        37080002
.NTFIRST ANOP                                                           37170002
         DC    AL1(0)                                                   37260002
         AIF   ('&DATA(1)' EQ '').CKDTABS                               37350002
         AIF   (&DATA(1) EQ &DB).CKDTABS                                37440002
&DB      SETA  &DATA(1)                                                 37530002
         AGO   .AA                                                      37620002
.CKDTABS AIF   ('&DATA(2)' EQ '').NCDATA                                37710002
         AIF   (&DATA(2) EQ &DT).NCDATA                                 37800002
         AGO   .CC                                                      37890002
.AA      AIF   ('&DATA(2)' EQ '').BB                                    37980002
         AIF   (&DATA(2) EQ &DT).BB                                     38070002
.CC      ANOP                                                           38160002
&DT      SETA  &DATA(2)                                                 38250002
.BB      DC    XL2'FFFE'                                                38340002
         DC    FL1'&DB'                                                 38430002
         DC    FL1'&DT'                                                 38520002
&NRENTS  SETA  &NRENTS+1                                                38610002
.NCDATA  ANOP                                                           38700002
         AIF   ('&LABEL(1)' EQ '').CKLTABS                              38790002
         AIF   (&LABEL(1) EQ &LB).CKLTABS                               38880002
&LB      SETA  &LABEL(1)                                                38970002
         AGO   .AAA                                                     39060002
.CKLTABS AIF   ('&LABEL(2)' EQ '').NCLABEL                              39150002
         AIF   (&LABEL(2) EQ &LT).NCLABEL                               39240002
         AGO   .CCC                                                     39330002
.AAA     AIF   ('&LABEL(2)' EQ '').BBB                                  39420002
         AIF   (&LABEL(2) EQ &LT).BBB                                   39510002
.CCC     ANOP                                                           39600002
&LT      SETA  &LABEL(2)                                                39690002
.BBB     DC    XL2'FFFF'                                                39780002
         DC    FL1'&LB'                                                 39870002
         DC    FL1'&LT'                                                 39960002
&NRENTS  SETA  &NRENTS+1                                                40050002
.NCLABEL ANOP                                                           40140002
         AIF   ('&SKIP' NE '').CONT                                     40230002
         AIF   (&TEST EQ 0).NOCHANG                                     40320002
         AGO   .DEFALTA                                                 40410002
.CONT    ANOP                                                           40500002
         AIF   (&TEST EQ 0).AB                                          40590002
         AIF   ('&SKIP' EQ 'E').AB                                      40680002
&S       SETA  &SKIP                                                    40770002
.DEFAULT ANOP                                                           40860002
         AIF   (&SKIP EQ &LASTCC).DEFALTA                               40950002
         ORG   &CARRCON+3                                               41040002
         DC    AL.3(0),AL.2(&S),AL.3(1)                                 41130002
         ORG                                                            41220002
&LASTCC  SETA  &S                                                       41310002
.DEFALTA ANOP                                                           41400002
&TEST    SETB  0                                                        41490002
         AGO   .DD                                                      41580002
.AB      AIF   ('&SKIP' NE 'E').ABB                                     41670002
A&SYSNDX DC    X'FFFB8B00'              EJECT                           41760002
         AGO   .ABC                                                     41850002
.ABB     AIF   (&SKIP EQ &LASTCC).NOCHANG                               41940002
A&SYSNDX DC    XL2'FFFB'                                                42030002
         DC    AL.3(0),AL.2(&SKIP),AL.3(1)                              42120002
         DC    AL.3(0),AL.2(&SKIP),AL.3(1)                              42210002
&LASTCC  SETA  &SKIP                                                    42300002
&TEST    SETB  1                                                        42390002
.ABC     ANOP                                                           42480002
&CARRCON SETC  'A&SYSNDX'                                               42570002
&NRENTS  SETA  &NRENTS+1                                                42660002
.DD      ANOP                                                           42750002
.NOCHANG ANOP                                                           42840002
         MEND                                                           42930002
         SPACE 3                                                        43020002
***  ROUTINE MACRO   ROUTINE MACRO   ROUTINE MACRO   ROUTINE MACRO  *** 43110002
         SPACE                                                          43200002
         MACRO                                                          43290002
&NAME    ROUTINE &LOGITEM,&RNAME                                        43380002
         GBLA  &NRENTS                                                  43470002
         GBLC  &DSECT,&CSECT                                            43560002
         GBLA  &INITIAL                                                 43650002
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN                               43740002
         AIF   (&DIAGTST EQ 0).NOMSG                                    43830002
         AIF   (&INITIAL EQ 0).NOMSG                                    43920002
         AIF   (&DIAGLIN EQ 1).NOMSG                                    44010002
         MNOTE '**NO LINE ASSOCIATED WITH THIS ROUTINE**'               44100002
*****THE FOLLOWING GENERATED FOR TEST PURPOSES*****                     44190002
*        LINE                                                           44280002
         LINE                                                           44370002
.NOMSG   ANOP                                                           44460002
&NAME    DC    AL.12(&LOGITEM-&DSECT),XL.4'D'                           44550002
         DC    AL2(&RNAME-&CSECT)                                       44640002
&NRENTS  SETA  &NRENTS+1                                                44730002
         MEND                                                           44820002
         EJECT                                                          44910002
***  LABEL MACRO     LABEL MACRO     LABEL MACRO     LABEL MACRO    *** 45000002
         SPACE                                                          45090002
         MACRO                                                          45180002
&NAME    LABEL &LABEL1,&LABEL2,&LABEL3,&LABEL4,&LABEL5,&LABEL6,        C45270002
               &LABEL7,&LABEL8                                          45360002
.*                                 THIS MACRO ALLOWS LABELS TO          45450002
.*                                 BE SPECIFIED FOR A GIVEN LINE. THE   45540002
.*                                 LABELS SHOULD BE ENCLOSED IN QUOTA-  45630002
.*                                 TION MARKS. THE COLUMN AND LINE END  45720002
.*                                 CONTROLS WILL BE INSERTED BY THE     45810002
.*                                 MACRO. OMITTED OPERANDS MEAN NO      45900002
.*                                 LABEL REQUIRED FOR RESPECTIVE        45990002
.*                                 COLUMN.                              46080002
         GBLC &LABELS(2000)                                             46170002
         GBLC  &LBL(100)                                                46260002
         GBLA  &LBLCTR(100)                                             46350002
         GBLA  &LABELNR                                                 46440002
         GBLA  &NRENTS,&LPTR,&INITIAL                                   46530002
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN                               46620002
         LCLC  &MARGIN,&TACK                                            46710002
         LCLC  &TEXT                                                    46800002
         LCLA  &OP,&K,&START,&NRCHAR,&REMAIN                            46890002
         AIF   (&INITIAL EQ 0).DIAGCLR                                  46980002
         AIF   (&DIAGTST EQ 0).DIAGCLR                                  47070002
         AIF   (&DIAGLIN EQ 1).DIAGCLR                                  47160002
         MNOTE '**NO LINE ASSOCIATED WITH PREVIOUS LABEL**'             47250002
***** THE FOLLOWING GENERATED FOR TEST PURPOSES *****                   47340002
*        LINE                                                           47430002
         LINE                                                           47520002
.DIAGCLR ANOP                                                           47610002
&DIAGSET SETB  0                                                        47700002
&DIAGLIN SETB  0                                                        47790002
&MARGIN  SETC  '*'                                                      47880002
         AIF   ('&NAME' EQ '').LOOPOUT                                  47970002
&LPTR    SETA  &LPTR+1                                                  48060002
&LBL(&LPTR) SETC '&NAME'                                                48150002
&LBLCTR(&LPTR) SETA &LABELNR+1                                          48240002
.LOOPOUT ANOP                                                           48330002
&OP      SETA  &OP+1                                                    48420002
&K       SETA  K'&SYSLIST(&OP)                                          48510002
         AIF (&K GE 2).NORM                                             48600002
&K       SETA  2                                                        48690002
.NORM    ANOP                                                           48780002
&START   SETA  2                                                        48870002
         AIF (&OP LT N'&SYSLIST).NOTLAST                                48960002
&MARGIN  SETC  '$'                                                      49050002
.NOTLAST ANOP                                                           49140002
&NRCHAR  SETA  8                                                        49230002
&TACK    SETC  ''                                                       49320002
.LOOPIN  ANOP                                                           49410002
&REMAIN  SETA  &K-&START                                                49500002
         AIF (&REMAIN GE 8).MORE                                        49590002
&TACK    SETC  '&MARGIN'                                                49680002
&NRCHAR  SETA  &REMAIN                                                  49770002
.MORE    ANOP                                                           49860002
&TEXT    SETC  ''                                                       49950002
         AIF (&REMAIN EQ 0).ENDTEXT                                     50040002
&TEXT    SETC  '&SYSLIST(&OP)'(&START,&NRCHAR)                          50130002
.ENDTEXT ANOP                                                           50220002
&LABELNR SETA  &LABELNR+1                                               50310002
&LABELS(&LABELNR) SETC '&TEXT'.'&TACK'                                  50400002
&START   SETA  &START+8                                                 50490002
         AIF ('&TACK' EQ '').LOOPIN                                     50580002
         AIF ('&TACK' EQ '*').LOOPOUT                                   50670002
         MEND                                                           50760002
         EJECT                                                          50850002
***  LSTART MACRO    LSTART MACRO    LSTART MACRO    LSTART MACRO   *** 50940002
         SPACE                                                          51030002
         MACRO                                                          51120002
         LSTART                                                         51210002
.*                            THIS MACRO IS ISSUED WHEN THE LABEL AREA  51300002
.*                                 OF THE TABLE IS TO BEGIN.            51390002
         GBLA  &LABELNR                                                 51480002
         GBLC  &LBL(100)                                                51570002
         GBLC &LABELS(2000)                                             51660002
         GBLA  &LBLCTR(100)                                             51750002
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN                               51840002
         LCLA  &NDX,&CTR                                                51930002
         AIF   (&DIAGTST EQ 0).NODIAG                                   52020002
         AIF   (&DIAGSET EQ 0).NODIAG                                   52110002
         MNOTE '**NO LABEL ASSOCIATED WITH LAST SET**'                  52200002
***** THE FOLLOWING GENERATED FOR TEST PURPOSES *****                   52290002
*        LABEL '%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%'       52380002
               LABEL '%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%' 52470002
.NODIAG  ANOP                                                           52560002
         LINEND                                                         52650002
&CTR     SETA  1                                                        52740002
.LOOP    ANOP                                                           52830002
&NDX     SETA  &NDX+1                                                   52920002
         AIF   (&LBLCTR(&CTR) NE &NDX).NOLBL                            53010002
&LBL(&CTR) DC  C'&LABELS(&NDX)'                                         53100002
&CTR     SETA  &CTR+1                                                   53190002
         AGO   .LOOPCTL                                                 53280002
.NOLBL   ANOP                                                           53370002
         DC    C'&LABELS(&NDX)'                                         53460002
.LOOPCTL AIF   (&NDX LT &LABELNR).LOOP                                  53550002
         MEND                                                           53640002
         SPACE 3                                                        53730002
***  LINEND MACRO    LINEND MACRO    LINEND MACRO    LINEND MACRO   *** 53820002
         SPACE                                                          53910002
         MACRO                                                          54000002
         LINEND                                                         54090002
.*                            THIS MACRO IS USED ONLY BY THE LINE       54180002
.*                                 MACRO TO SET THE NUMBER OF ENTRIES   54270002
.*                                 ASSOCIATED WITH EACH LINE.           54360002
         GBLA  &NRENTS                                                  54450002
         GBLC &NRENTSX                                                  54540002
         AIF   (&NRENTS EQ 0).NORENTS   TEST FOR NO COUNT               54630002
         ORG   &NRENTSX                                                 54720002
         DC    FL1'&NRENTS'                                             54810002
         ORG                                                            54900002
&NRENTS  SETA  0                                                        54990002
.NORENTS ANOP                                                           55080002
B&SYSNDX EQU   *                                                        55170002
&NRENTSX SETC  'B&SYSNDX'                                               55260002
         MEND                                                           55350002
         EJECT                                                          55440002
         GBLC  &DSECT,&CSECT                                            55530002
IFCEMAD1 CSECT                                                          55620002
&CSECT   SETC  'IFCEMAD1'                                               55710002
&DSECT   SETC  'MAD1'                                                   55800002
*                                                                       55890002
*        SENSE 0-7 AND 8-23 FOR FORMAT 1                                55980002
*                                                                       56070002
MAD1     DSECT                                                          56160002
         DSGEN (CLASRC,8),(SYSREL,8),(SWITCHES,8),(SW1,8)               56250002
         DSGEN (SW2,8),(SW3,8),(SPARE1,16)                              56340002
         DSGEN (DAY,32),(HOUR,32)                                       56430002
         DSGEN (SPARE2,8),(CPUSERL,24),(CPUID,16),(SPARE3,16)           56520002
         DSGEN (JOBID,64)                                               56610002
         DSGEN (FAILCCW,64)                                             56700002
         DSGEN (CSW,64)                                                 56790002
         DSGEN (DEVDPD,8),(SECCUA,24),(DEVTYP1,16),(DEVTYP2,16)         56880002
         DSGEN (SDRCNT,8),(CUA,24),(IORET,16),(SBCNT,16)                56970002
         DSGEN (VOLLABL,48),(SPARE4,16)                                 57060002
         DSGEN (LASTSK,64)                                              57150002
         DSGEN (HOMEADR,32),(SPARE5,32)                                 57240002
         DSGEN (SNB,1,0,23,0,7)                                         57330002
         EJECT                                                          57420002
*********************************************************************** 57510002
*                                                                     * 57600002
*                                                                     * 57690002
*                THIS ENTIRE MODULE IS IN SUPPORT OF @Z30RSAG         * 57780002
*                                                                     * 57870002
*                                                                     * 57960002
*********************************************************************** 58050002
         SPACE                                                          58140002
IFCEMAD1 CSECT                                                          58230002
         USING *,R9                                                     58320002
         SPACE                                                          58410002
R0       EQU   0                       R                                58500002
R1       EQU   1                        E                               58590002
R2       EQU   2                         G                              58680002
R3       EQU   3                          I                             58770002
R4       EQU   4                           S                            58860002
R5       EQU   5                            T                           58950002
R6       EQU   6                             E                          59040002
R7       EQU   7                              R                         59130002
R8       EQU   8                                                        59220002
R9       EQU   9                                E                       59310002
R10      EQU   10                                Q                      59400002
R11      EQU   11                                 U                     59490002
R12      EQU   12                                  A                    59580002
R13      EQU   13                                   T                   59670002
R14      EQU   14                                    E                  59760002
R15      EQU   15                                     S                 59850002
         SPACE 2                                                        59940002
L0       EQU   0                       EQUATES                          60030002
L1       EQU   1                                                        60120002
L2       EQU   2                                                        60210002
L3       EQU   3                               FOR                      60300002
L4       EQU   4                                                        60390002
L5       EQU   5                                                        60480002
L6       EQU   6                                   LENGTHS              60570002
L7       EQU   7                                                        60660002
L8       EQU   8                                                        60750002
L9       EQU   9                               AND                      60840002
L10      EQU   10                                                       60930002
L11      EQU   11                                                       61020002
L12      EQU   12                                  DISPLACEMENTS        61110002
L13      EQU   13                                                       61200002
L14      EQU   14                                                       61290002
L15      EQU   15                                                       61380002
L24      EQU   24                                                       61470002
         EJECT                                                          61560002
H10      EQU   X'10'                   H                                61650002
H20      EQU   X'20'                    E                               61740002
H30      EQU   X'30'                     X                              61830000
H40      EQU   X'40'                                                    61920002
H50      EQU   X'50'                                                    62010002
H08      EQU   X'08'                        VALUES                      62100002
H80      EQU   X'80'                                                    62190002
         EJECT                                                          62280002
         DC    A(ENTRIES)                                               62370002
         DC    CL8'IFCEMAD1'                                            62460002
XR9PTR   DC    F'0'                                                     62550002
XLABELP  DC    F'0'                                                     62640002
         SPACE 2                                                        62730002
*                                                                       62820002
*        ALL THE FOLLOWING ROUTINES ARE EXECUTED                        62910002
*              VIA THE 'ROUTINE' MACRO - NOTE: R3=ADR OF PRINT POSITION 63000002
*                                              R4=ADR OF DATA IN RECORD 63090002
         SPACE                                                          63180002
*      SET HEX - PRINTS ONE CHARACTER HEX                               63270002
SETHEX   STM   R5,R8,XSAVE             SAVE REGS                        63360002
         LA    R8,CHARS                LOAD ADDR OF CHAR. TABLE         63450002
         IC    R7,L0(R4)               INSERT BYTE TO BE CONVERTED      63540002
         SLL   R7,L24                  SHIFT TO HIGH ORDER BYTE         63630002
         SR    R6,R6                   CLEAR REG                        63720002
         SLDL  R6,L4                   SHIFT IN 4 BITS                  63810002
         AR    R6,R8                   ADD ADDR TO OFFSET               63900002
         MVC   L0(L1,R3),L0(R6)        MOVE CHARACTER TO PRINT LINE     63990002
         SR    R6,R6                   CLEAR REG                        64080002
         SLDL  R6,L4                   SHIFT IN NEXT 4 BITS             64170002
         AR    R6,R8                   ADD ADDR OT OFFSET               64260002
         MVC   L1(L1,R3),L0(R6)        MOVE CHAR TO PRINT LINE          64350002
         B     RETURN                  RETURN                           64440002
*                                                                       64530002
*      THE FOLLOWING SETS BINARY DIGITS TO PRINTABLE HEX                64620002
*                                                                       64710002
SETBIN   STM   R5,R8,XSAVE             SAVE REGS                        64800002
         IC    R7,L0(R4)               INSERT BYTE                      64890002
         SLL   R7,L24                  SHIFT BYTE TO HIGH ORDER         64980002
         LR    R8,R3                   LOAD ADDR OF PRINT POSITION      65070002
         LA    R5,L8                   LOAD LOOP COUNT                  65160002
SETBINA  SR    R6,R6                   CLEAR REG                        65250002
         SLDL  R6,L1                   SHIFT ONE BIT TO REG             65340002
         STC   R6,L0(R8)               STORE BIT IN PRINT POSITION      65430002
         MVZ   L0(L1,R8),CHAR0         MOVE 'F' IN FRONT OF BIT         65520002
         LA    R8,L1(R8)               BUMP PRINT POS PTR               65610002
         BCT   R5,SETBINA              BR TO DO NEXT BIT                65700002
         B     RETURN                  RETURN                           65790002
         SPACE                                                          65880002
SETBIN2  STM   R5,R8,XSAVE             SAVE REGS                        65970002
         IC    R7,L0(R4)               INSERT BYTE                      66060002
         SLL   R7,L24                  SHIFT IT TO HIGH ORDER           66150002
         LR    R8,R3                   LOAD PRINT POSITION ADDR         66240002
         LA    R5,L8                   LOAD LOOP COUNT                  66330002
         S     R8,ELEVEN               SUBTRACT FROM PRINT POSITION     66420002
         B     SETBINA                 BR TO CONVERT                    66510002
         EJECT                                                          66600002
*                                                                       66690002
*      CHECK FORMAT OF RECORD - IF ITS FORMAT 1,CONTINUE                66780002
*                             - IF ITS FORMAT 0 OR 2-5 CALL A NEW MOD   66870002
*                                                                       66960002
CHKFMT   STM   R5,R8,XSAVE             SAVE REGS                        67050002
         SR    R15,R15                 DONT PRINT THIS LINE             67140002
         SR    R5,R5                   CLEAR REG                        67230002
         TM    L0(R4),H50              IS IT FORMAT 5                   67320002
         BO    CALLFMT5                YES - BR                         67410002
         SPACE                                                          67500002
         TM    L0(R4),H40              IS IT FORMAT 4                   67590002
         BO    CALLFMT4                YES - BR                         67680002
         SPACE                                                          67770002
         TM    L0(R4),H30              IS IT FORMAT 3                   67860000
         BO    CALLFMT3                YES - BR                         67910000
         SPACE                                                          68040002
         TM    L0(R4),H20              IS IT FORMAT 2                   68130002
         BO    CALLFMT2                YES - BR                         68220002
         SPACE                                                          68310002
         TM    L0(R4),H10              IS IT FORMAT 1                   68400002
         BO    RETURN                  YES - BR TO RETURN - CONTINUE    68490002
         SPACE 2                                                        68580002
CALLFMT0 LA    R5,FE0-L4               LOAD ADDR OF MODULE NAME         68670002
         ST    R5,XR9PTR               STORE ADDR FOR EREP              68760002
         B     RETURN                  RETURN TO CALL MODULE            68850002
         SPACE                                                          68940002
CALLFMT2 LA    R5,FE2-L4               LOAD ADDR OF MODULE NAME         69030002
         ST    R5,XR9PTR               STORE ADDR FOR EREP              69120002
         B     RETURN                  RETURN TO CALL MODULE            69210002
         SPACE                                                          69300002
CALLFMT3 LA    R5,FE3-L4               LOAD ADDR OF MODULE NAME         69390002
         ST    R5,XR9PTR               STORE ADDR FOR EREP              69480002
         B     RETURN                  RETURN TO CALL MODULE            69570002
         SPACE                                                          69660002
CALLFMT4 LA    R5,FE4-L4               LOAD ADDR OF MODULE NAME         69750002
         ST    R5,XR9PTR               STORE ADDR FOR EREP              69840002
         B     RETURN                  RETURN TO CALL MODULE            69930002
         SPACE                                                          70020002
CALLFMT5 LA    R5,FE5-L4               LOAD ADDR OF MODULE NAME         70110002
         ST    R5,XR9PTR               STORE ADDR FOR EREP              70200002
         B     RETURN                  RETURN TO CALL MODULE            70290002
         EJECT                                                          70380002
FE0      DC    X'FE'                                                    70470002
         DC    CL8'IFCEMER0'           FORMAT 0 EDIT TABLE              70560002
         SPACE                                                          70650002
FE2      DC    X'FE'                                                    70740002
         DC    CL8'IFCEMER2'           FORMAT 2 EDIT TABLE              70830002
         SPACE                                                          70920002
FE3      DC    X'FE'                                                    71010002
         DC    CL8'IFCEMER3'           FORMAT 3 EDIT TABLE              71100002
         SPACE                                                          71190002
FE4      DC    X'FE'                                                    71280002
         DC    CL8'IFCEMER4'           FORMAT 4 EDIT TABLE              71370002
         SPACE                                                          71460002
FE5      DC    X'FE'                                                    71550002
         DC    CL8'IFCEMER5'           FORMAT 5 EDIT TABLE              71640002
         SPACE                                                          71730002
*                                                                       71820002
*      THE FOLLOWING MOVES A UNIQUE LABEL FOR BYTE 8,BIT 5              71910002
*        DEPENDING ON THE SETTING OF BYTE 19 BIT 0.                     72000002
*                                                                       72090002
         SPACE                                                          72180002
SETLAB   S     R3,TOCOLONE             SUBTRACT TO PT TO COL ONE        72270002
         TM    L0(R4),H80              IS THE R/W BIT ON                72360002
         BO    MOVEWRSN                YES - BR TO MOVE LABEL           72450002
         MVC   L0(L11,R3),MODA         MOVE LABEL                       72540002
         BR    R14                     RETURN                           72630002
         SPACE                                                          72720002
MOVEWRSN MVC   L0(L11,R3),WRSN         MOVE LABEL                       72810002
         BR    R14                     RETURN                           72900002
         SPACE 2                                                        72990002
*                                                                       73080002
*      THE FOLLOWING MOVES A UNIQUE LABEL FOR BYTE 8,BIT 6              73170002
*        DEPENDING ON THE SETTING OF BYTE 19 BIT 0                      73260002
*                                                                       73350002
SETLAB1  S     R3,TOCOLONE             SUBTRACT TO PT TO COLUMN ONE     73440002
         TM    L0(R4),H80              IS THE R/W BIT ON                73530002
         BO    MOVEINMK                YES - BR TO MOVE LABEL           73620002
         MVC   L0(L11,R3),BUSY         MOVE LABEL                       73710002
         BR    R14                     RETURN                           73800002
         SPACE                                                          73890002
MOVEINMK MVC   L0(L11,R3),INMK         MOVE LABEL                       73980002
         BR    R14                     RETURN                           74070002
         EJECT                                                          74160002
*                                                                       74250002
*      THE FOLLOWING MOVES A UNIQUE LABEL FOR BYTE 8,BIT 7              74340002
*        DEPENDING ON THE SETTING OF BYTE 19 BIT 0                      74430002
*                                                                       74520002
SETLAB2  S     R3,TOCOLONE             SUBTRACT TO PT TO COLUMN ONE     74610002
         TM    L0(R4),H80              IS THE R/W BIT ON                74700002
         BO    MOVEACTK                YES - BR                         74790002
         MVC   L0(L11,R3),SSCM         MOVE LABEL                       74880002
         BR    R14                     RETURN                           74970002
         SPACE                                                          75060002
MOVEACTK MVC   L0(L11,R3),ACTK         MOVE LABEL                       75150002
         BR    R14                     RETURN                           75240002
         SPACE 2                                                        75330002
*                                                                       75420002
*      THE FOLLOWING RESTORES REGISTERS USED BY ROUTINES IN THIS        75510002
*        MODULE AND RETURNS TO EREP0                                    75600002
*                                                                       75690002
RETURN   LM    R5,R8,XSAVE             RESTORE REGS                     75780002
SKIPPER  BR    R14                     RETURN TO EREP                   75870002
         SPACE 5                                                        75960002
*                                                                       76050002
*      THE FOLLOWING STORAGE CONSTANTS ARE USED IN THE                  76140002
*        PREVIOUS ROUTINES                                              76230002
*                                                                       76320002
         SPACE                                                          76410002
         DS    0F                                                       76500002
XSAVE    DC    5F'0'                   REG SAVE AREA                    76590002
         SPACE                                                          76680002
ELEVEN   DC    F'11'                                                    76770002
TOCOLONE DC    F'132'                                                   76860002
         SPACE                                                          76950002
CHARS    DC    C'0123456789ABCDEF'     HEX CHARACTER TABLE              77040002
CHAR0    DC    C'0'                                                     77130002
         SPACE                                                          77220002
MODA     DC    CL11'MOD ATTENTN'                                        77310002
WRSN     DC    CL11'I WR SENSE'                                         77400002
BUSY     DC    CL11'BUSY'                                               77490002
INMK     DC    CL11'INDEX MARK'                                         77580002
SSCM     DC    CL11'SK/SCTR COM'                                        77670002
ACTK     DC    CL11'ACTIVE TRK'                                         77760002
         EJECT                                                          77850002
*                                                                     * 77940002
*   E D I T  T A B L E  F O R  S E N S E  B Y T E S  0 - 7            * 78030002
*                                                                     * 78120002
*        O N  A  3 3 5 0 ( M A D R I D )                              * 78210002
*                                                                     * 78300002
ENTRIES  DS    0F                                                       78390002
         DC    XL4'00010001'                                            78480002
         DC    XL4'00010001'                                            78570002
         DC    A(LABELS)               LABEL POINTER                    78660002
         DC    H'0'                                                     78750002
         SPACE                                                          78840002
*                                                                       78930002
*        SKIP TO CHANNEL 1                                              79020002
*                                                                       79110002
         DC    X'01'                                                    79200002
         DC    X'000B0B00'                                              79290002
         SPACE 2                                                        79380002
         LINE  (12,15),(3,15),SKIP=1                                    79470002
         ROUTINE   SNB00,SETHEX                                         79560002
         ROUTINE   SNB10,SETHEX                                         79650002
         ROUTINE   SNB20,SETHEX                                         79740002
         ROUTINE   SNB30,SETHEX                                         79830002
         ROUTINE   SNB40,SETHEX                                         79920002
         ROUTINE   SNB50,SETHEX                                         80010002
         ROUTINE   SNB60,SETHEX                                         80100002
         ROUTINE   SNB70,SETHEX                                         80190002
         LABEL 'BYTE 0','BYTE 1','BYTE 2','BYTE 3','BYTE 4','BYTE 5',  C80280002
               'BYTE 6','BYTE 7'                                        80370002
         LINE  ,(1,1),SKIP=2                                            80460002
         ROUTINE   SPARE1,SKIPPER                                       80550002
         LABEL '----------UNIT CHECK DESCRIPTION-----------  RESTART CMC80640002
               D    PHYSICAL ID    LOW CYLINDER   HI CYL/LOG TRK FORMATC80730002
               /MSG'                                                    80820002
         LINE  (13,15),(1,15),SKIP=1                                    80910002
         BIN   (SNB00),(SNB10),(SNB20)                                  81000002
         ROUTINE   SNB30,SETBIN2                                        81090002
         BIN   (SNB40),(SNB50),(SNB60),(SNB70)                          81180002
         LABEL 'COMMAND REJ','PERM ERROR','           ',' ','DRIVE A', C81270002
               'CYL 128','CYL 1024','FORMAT  8'                         81360002
         LINE  (13,15),(1,15)                                           81450002
         BIN   (SNB01),(SNB11),(SNB21),(SNB31)                          81540002
         BIN   (SNB41),(SNB51),(SNB61),(SNB71)                          81630002
         LABEL 'INTERVN REQ','INV TRK FMT','CORRECTABLE','             X81720002
               ','DRIVE B','CYL  64','CYL 512  ','FORMAT  4'   @XM09337 81810002
         LINE                                                           81900002
         BIN   (SNB02),(SNB12),(SNB22),(SNB32)                          81990002
         BIN   (SNB42),(SNB52),(SNB62),(SNB72)                          82080002
         LABEL 'BUS OUT PAR','END OF CYL','ALT. CNTLR','             ',C82170002
               'DRIVE C','CYL  32','CYL 256  ','FORMAT  2'     @XM09337 82260002
         LINE                                                           82350002
         BIN   (SNB03),(SNB13),(SNB23),(SNB33)                          82440002
         BIN   (SNB43),(SNB53),(SNB63),(SNB73)                          82530002
         LABEL 'EQUIPMNT CK',' ','ENV DATA PR','             ',        C82620002
               'DRIVE D','CYL  16','LOG TRK 16','FORMAT  1'             82710002
         LINE                                                           82800002
         BIN   (SNB04),(SNB14),(SNB24),(SNB34)                          82890002
         BIN   (SNB44),(SNB54),(SNB64),(SNB74)                          82980002
         LABEL 'DATA CHECK','NO REC FND','COMPAT MODE',       *@X12827WC83070000
               '             ',                               *@X12827WC83100000
               'DRIVE E','CYL   8','LOG TRK 8','MESSAGE 8'              83160002
         LINE                                                           83250002
         BIN   (SNB05),(SNB15),(SNB25),(SNB35)                          83340002
         BIN   (SNB45),(SNB55),(SNB65),(SNB75)                          83430002
         LABEL 'OVERRUN','FILE PROTCT','FIXED HEAD',          *@X12827WC83520000
               '             ','DRIVE F',                              *83610002
               'CYL   4','LOG TRK 4','MESSAGE 4'                        83700002
         LINE                                                           83790002
         BIN   (SNB06),(SNB16),(SNB26)                         @XA11914 83880002
         ROUTINE SNB36,SKIPPER                                 @XA11914 83920002
         BIN   (SNB46),(SNB56),(SNB66),(SNB76)                          83970002
         LABEL '           ','WRT INHIBIT','           ',              X84060002
               '           ',                                          C84100002
               'DRIVE G','CYL   2','LOG TRK 2','MESSAGE 2'              84150002
         LINE  ,,SKIP=3                                                 84240002
         BIN   (SNB07),(SNB17),(SNB27),(SNB37)                          84330002
         BIN   (SNB47),(SNB57),(SNB67),(SNB77)                          84420002
         LABEL '          ','OP INCOMPLT','           ',               X84510002
               '             ',                                        C84550002
               'DRIVE H','CYL   1','LOG TRK 1','MESSAGE 1'              84600002
         LINE  ,,SKIP=1                                                 84690002
         ROUTINE   SNB70,CHKFMT                                         84780002
         LABEL ' '                                                      84870002
         EJECT                                                          84960002
*                                                                       85050002
*   E D I T  T A B L E  F O R  S E N S E  B Y T E S  8 - 2 3            85140002
*                                                                       85230002
*        F O R  F O R M A T  1                                          85320002
*                                                                       85410002
         LINE  (12,15),(3,15),SKIP=1                                    85500002
         ROUTINE   SNB80,SETHEX                                         85590002
         ROUTINE   SNB90,SETHEX                                         85680002
         ROUTINE   SNB100,SETHEX                                        85770002
         ROUTINE   SNB110,SETHEX                                        85860002
         ROUTINE   SNB120,SETHEX                                        85950002
         ROUTINE   SNB130,SETHEX                                        86040002
         ROUTINE   SNB140,SETHEX                                        86130002
         ROUTINE   SNB150,SETHEX                                        86220002
         LABEL 'BYTE 8','BYTE 9','BYTE 10','BYTE 11','BYTE 12',        C86310002
               'BYTE 13','BYTE 14','BYTE 15'                            86400002
         LINE  ,(1,1),SKIP=2                                            86490002
         ROUTINE   SPARE1,SKIPPER                                       86580002
         LABEL 'DRIVE STATUS   DRIVE CK/STAT  SEQUENCE CNTRL LOAD SW STC86670002
               ATUS R/W SAFETY     DCI BUS OUT    DCI BUS IN     DCI TAC86760002
               G BUS'                                                   86850002
         LINE  (13,15),(1,15),SKIP=1                                    86940002
         BIN   (SNB80),(SNB90),(SNB100),(SNB110)                        87030002
         BIN   (SNB120),(SNB130),(SNB140),(SNB150)                      87120002
         LABEL 'CNTRLR CK','PAD-IN-PROG','HDA MODEPAR','DR START SW',  C87210002
               'MULTI-HD CK','BIT 0','BIT 0','BIT 0'           @XA11915 87300002
         LINE                                                           87390002
         BIN   (SNB81),(SNB91),(SNB101),(SNB111)                        87480002
         BIN   (SNB121),(SNB131),(SNB141),(SNB151)                      87570002
         LABEL 'INTRFACE CK','SECT COM CK','HDA 4 LATCH',      @XA11915C87660002
               'GUARD BAND','CAP/ENAB CK','BIT 1','BIT 1','BIT 1'       87750002
         LINE                                                           87840002
         BIN   (SNB82),(SNB92),(SNB102),(SNB112)                        87930002
         BIN   (SNB122),(SNB132),(SNB142),(SNB152)                      88020002
         LABEL 'DRIVE CHECK','MOT AT SP L','HDA 2 LATCH',      @XA11915C88110002
               'TARGET VELO','WRITE OVRUN','BIT 2','BIT 2','BIT 2'      88200002
         LINE                                                           88290002
         BIN   (SNB83),(SNB93),(SNB103),(SNB113)                        88380002
         BIN   (SNB123),(SNB133),(SNB143),(SNB153)                      88470002
         LABEL 'R/W CHECK','AIR BT SW L','HDA 1 LATCH',        @XA11915C88560002
               'TRACK CROSS','INDEX CHECK','BIT 3','BIT 3','BIT 3'      88650002
         LINE                                                           88740002
         BIN   (SNB84),(SNB94),(SNB104),(SNB114)                        88830002
         BIN   (SNB124),(SNB134),(SNB144),(SNB154)                      88920002
         LABEL 'ON LINE','WRT ENABLE','HDA TMR CHK','        ',        C89010002
               'R/W INTR CK','BIT 4','BIT 4','BIT 4'           @XA11915 89100002
         LINE                                                           89190002
         BIN   (SNB85),(SNB95),(SNB105),(SNB115)                        89280002
         BIN   (SNB125),(SNB135),(SNB145),(SNB155)                      89370002
         ROUTINE   SNB190,SETLAB                                        89460002
         LABEL 'HDA ATN PIP','FIX HD INST','HDA SEQ LAT',      @XA11915C89550002
               'AIR SW','CONTROL CK','BIT 5','BIT 5','BIT 5'   X12827MD 89640002
         LINE  (13,15),(1,15)                                           89730002
         BIN   (SNB86),(SNB96),(SNB106),(SNB116)                        89820002
         BIN   (SNB126),(SNB136),(SNB146),(SNB156)                      89910002
         ROUTINE   SNB190,SETLAB1                                       90000002
         LABEL 'BUSY','3330','   ','   ','TRANSINT CK',        @XA11915C90090002
               'BIT 6','BIT 6','BIT 6'                         @XA11915 90180002
         LINE  ,,SKIP=3                                                 90270002
         BIN   (SNB87),(SNB97),(SNB107),(SNB117)                        90360002
         BIN   (SNB127),(SNB137),(SNB147),(SNB157)                      90450002
         ROUTINE   SNB190,SETLAB2                                       90540002
         LABEL 'SK COMP','3350 NATIVE','ODD TRACK','MT AT SP SW',      C90630002
               'I WRT RD CK','BIT 7','BIT 7','BIT 7'           @XA11915 90720002
         LINE  (12,15),(3,15),SKIP=1                                    90810002
         ROUTINE   SNB160,SETHEX                                        90900002
         ROUTINE   SNB170,SETHEX                                        90990002
         ROUTINE   SNB180,SETHEX                                        91080002
         ROUTINE   SNB190,SETHEX                                        91170002
         ROUTINE   SNB200,SETHEX                                        91260002
         ROUTINE   SNB210,SETHEX                                        91350002
         ROUTINE   SNB220,SETHEX                                        91440002
         ROUTINE   SNB230,SETHEX                                        91530002
         LABEL 'BYTE 16','BYTE 17','BYTE 18','BYTE 19','BYTE 20',      C91620002
               'BYTE 21','BYTE 22','BYTE 23'                            91710002
         LINE  ,(1,15),SKIP=2                                           91800002
         ROUTINE   SPARE1,SKIPPER                                       91890002
         LABEL 'ACCESS STATUS','CNTRLR CHKS','MICRO DETCD ER',         C91980002
               'STATUS','INTERFACE CKS','DR INTF CK',                  *92070002
               '-----ERROR SYMPTOM CODE-----'                           92160002
         LINE  (13,15),(1,15),SKIP=1                                    92250002
         BIN   (SNB160),(SNB170),(SNB180),(SNB190),(SNB200)             92340002
         ROUTINE   SNB210,SETBIN2                                       92430002
         ROUTINE   SNB220,SETBIN2                                       92520002
         ROUTINE   SNB230,SETBIN2                                       92610002
         LABEL 'TIME-OUT CK','VFO PH CK','   ','SET R/W ON',   @XA11915C92700002
               'CTL TAG CK',' '                                         92790002
         LINE                                                           92880002
         BIN   (SNB161),(SNB171),(SNB181),(SNB191),(SNB201)             92970002
         LABEL 'OVRSHOOT CK','TR REOR CK ',' ',' ','CTL B/O CK',' '     93060002
         LINE                                                           93150002
         BIN   (SNB162),(SNB172),(SNB182),(SNB192),(SNB202)             93240002
         LABEL 'SERVO OFF TK','SER/DES CK',' ',' ',            X12827MDC93330002
               'DEV SEL CK ',' '                                        93420002
         LINE                                                           93510002
         BIN   (SNB163),(SNB173),(SNB183),(SNB193),(SNB203)             93600002
         LABEL 'REZERO MODE','COUNTER CHK',' ',' ','DEV B/I CK',' '     93690002
         LINE                                                           93780002
         BIN   (SNB164),(SNB174),(SNB184),(SNB194),(SNB204)             93870002
         LABEL 'SERVO LATCH','WRT DATA CK','MESSAGE  8','HD SHRT CK',  C93960002
               'CTL B/I CK',' '                                         94050002
         LINE                                                           94140002
         BIN   (SNB165),(SNB175),(SNB185),(SNB195),(SNB205)             94230002
         LABEL 'LIN MOD LAT','MONITOR CK','MESSAGE  4','PAD GATE CK',  *94320002
               'I WRT FAIL ',' '                                        94410002
         LINE                                                           94500002
         BIN   (SNB166),(SNB176),(SNB186),(SNB196),(SNB200)             94590002
         LABEL 'CONTROL LAT','ECC CHECK','MESSAGE 2','1.2 MB FILE',    C94680002
               '3330 IND CHK','BO PAR CK'                      @XA11915 94770002
         LINE  ,,SKIP=1                                                 94860002
         BIN   (SNB167),(SNB177),(SNB187),(SNB197),(SNB207)             94950002
         LABEL 'WAIT LATCH','ECC ZEROES','MESSAGE  1','FHF',           *95040002
               'REOR CTL CK','TAG PAR CK'                               95130002
         LINE                                                           95220002
         ROUTINE   SPARE1,SKIPPER                                       95310002
         LABEL ' '                                                      95400002
         SPACE 2                                                        95490002
         DC    X'FF'                                                    95580002
         DC    XL2'0070'                                                95670002
         DC    XL2'0018'                                                95760002
         DC    XL2'0000'                                                95850002
*                                                                       95940002
LABELS   DS    0F                                                       96030002
         DC    C'$'                                                     96120002
         LSTART                                                         96210002
         SPACE 2                                                        96300002
         END                                                            96390002
