         TITLE 'IFCESUMS-SUMMARY MODULE FOR IFCEREP0'                   00001000
IFCESUMS CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'IFCESUMS  79.010'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  ST    @14,12(,@13)                                        0001 00009000
         STM   @00,@04,20(@13)                                     0001 00010000
         STM   @06,@12,44(@13)                                     0001 00011000
         BALR  @11,0                                               0001 00012000
@PSTART  DS    0H                                                  0001 00013000
         USING @PSTART,@11                                         0001 00014000
         ST    @13,@SA00001+4                                      0001 00015000
         LA    @14,@SA00001                                        0001 00016000
         ST    @14,8(,@13)                                         0001 00017000
         LR    @13,@14                                             0001 00018000
*/********************************************************************/ 00019000
*/*                                                          @Z427VLS*/ 00020000
*/*      SECTION CONSTRUCTS A PART OF THE HEADER FROM THE RECORD     */ 00021000
*/*      AND CCHHR TABLE TO DETERMINE IF ANOTHER REC HAS BEEN SUMMED */ 00022000
*/*      AND MATCHES THIS REC. IF SO NO NEW AREA IS GOTTEN. IF NO    */ 00023000
*/*      MATCH A NEW AREA IS GOTTEN AND CHAINED TO THIS ONE  @Z427VLS*/ 00024000
*/*                                                          @Z427VLS*/ 00025000
*/********************************************************************/ 00026000
*   SAVE4 = R4;                                            /*@D3506GB*/ 00027000
         ST    R4,SAVE4                                            0090 00028000
*RETCODE = ZERO;                                           /*@Z427VLS*/ 00029000
         SLR   @12,@12                                             0091 00030000
         STH   @12,RETCODE                                         0091 00031000
* SWES = '00'X;                                            /*@Z427VLS*/ 00032000
         MVI   SWES,X'00'                                          0092 00033000
* IF LRTTYP = '34'X | LRTTYP = '32'X THEN  /* TCAM OR CONVERTED REC  */ 00034000
         CLI   LRTTYP(REG7),X'34'                                  0093 00035000
         BE    @RT00093                                            0093 00036000
         CLI   LRTTYP(REG7),X'32'                                  0093 00037000
         BNE   @RF00093                                            0093 00038000
@RT00093 DS    0H                                                  0094 00039000
*   IF LRDISMNT = OFF &                 /* MUST BE AN OBR(30) WITH   */ 00040000
*      SHRTSW  = OFF &                  /* SHORT SW & DISMOUNT SW OFF*/ 00041000
*      (LRTCAMID & '0F'X)='0F'X THEN    /* AND TCAM ID SW EQUAL TO 0F*/ 00042000
         TM    LRDISMNT(REG7),B'00100100'                          0094 00043000
         BNZ   @RF00094                                            0094 00044000
         MVC   @TS00001(1),LRTCAMID(REG7)                          0094 00045000
         NI    @TS00001,X'0F'                                      0094 00046000
         CLI   @TS00001,X'0F'                                      0094 00047000
         BNE   @RF00094                                            0094 00048000
*         TCAMSWIT = ON;                /* THEN TCAM SW IS SET       */ 00049000
         OI    TCAMSWIT,B'10000000'                                0095 00050000
* IF  LRTTYP='36'X THEN                 /* SEE IF VTAM       @Z427VLS*/ 00051000
@RF00094 DS    0H                                                  0096 00052000
@RF00093 CLI   LRTTYP(REG7),X'36'                                  0096 00053000
         BNE   @RF00096                                            0096 00054000
*   TCAMSWIT = ON;                      /* IF YES, TURN ON TCAM SWITC*/ 00055000
         OI    TCAMSWIT,B'10000000'                                0097 00056000
* SAVERTYP = LRTTYP & FOXZERO;                             /*@Z427VLS*/ 00057000
@RF00096 MVC   SAVERTYP(1),LRTTYP(REG7)                            0098 00058000
         NI    SAVERTYP,X'F0'                                      0098 00059000
* IF SAVERTYP = '90'X THEN              /* TEST FOR T-TYPE RECORD    */ 00060000
         CLI   SAVERTYP,X'90'                                      0099 00061000
         BNE   @RF00099                                            0099 00062000
*   DO;                                                    /*@Z427VLS*/ 00063000
*     /*                                                     @Z427VLS*/ 00064000
*     /* IF DEVICE ID IS ANY OF THE FOLLOWING, THEN THE RECORD IS    */ 00065000
*     /* TREATED AS AN OBR AND THE EXTRA 8 BYTES IS NOT NEEDED.      */ 00066000
*     /* OTHERWISE THE MDR-TYPE SWITCH IS SET.               @Z427VLS*/ 00067000
*     /*                                                     @Z427VLS*/ 00068000
*     IF LRTRECID = '03'X |            /* 3277               @D3503VS*/ 00069000
*        LRTRECID = '06'X |            /* 3670               @D3503VS*/ 00070000
*        LRTRECID = '07'X |            /* 3168               @D3503VS*/ 00071000
*        LRTRECID = '08'X |            /* 2715               @D3503VS*/ 00072000
*        LRTRECID = '0B'X |            /* 3277               @D3503VS*/ 00073000
*        LRTRECID = '13'X THEN         /* 3277               @D3503VS*/ 00074000
         CLI   LRTRECID(REG7),X'03'                                0101 00075000
         BE    @RT00101                                            0101 00076000
         CLI   LRTRECID(REG7),X'06'                                0101 00077000
         BE    @RT00101                                            0101 00078000
         CLI   LRTRECID(REG7),X'07'                                0101 00079000
         BE    @RT00101                                            0101 00080000
         CLI   LRTRECID(REG7),X'08'                                0101 00081000
         BE    @RT00101                                            0101 00082000
         CLI   LRTRECID(REG7),X'0B'                                0101 00083000
         BE    @RT00101                                            0101 00084000
         CLI   LRTRECID(REG7),X'13'                                0101 00085000
         BNE   @RF00101                                            0101 00086000
@RT00101 DS    0H                                                  0102 00087000
*          TTYPSWIT = ON;                                  /*@Z427VLS*/ 00088000
         OI    TTYPSWIT,B'01000000'                                0102 00089000
*   END;                                                   /*@Z427VLS*/ 00090000
@RF00101 DS    0H                                                  0104 00091000
* IF TTYPSWIT = ON |                    /* TEST FOR T TYPE OR TCAM   */ 00092000
*    TCAMSWIT = ON THEN                 /* RECORDS           @Z427VLS*/ 00093000
@RF00099 TM    TTYPSWIT,B'11000000'                                0104 00094000
         BZ    @RF00104                                            0104 00095000
*      IF TTYPSWIT = ON &               /* TEST FOR T TYPE & VAR SUB */ 00096000
*         LRVARIDS = ON THEN            /* ID FIELD.  IF VAR SUB ID  */ 00097000
         TM    TTYPSWIT,B'01000000'                                0105 00098000
         BNO   @RF00105                                            0105 00099000
         TM    LRVARIDS(REG7),B'10000000'                          0105 00100000
         BNO   @RF00105                                            0105 00101000
*           HDRBUMP=16;                 /* SET BUMP VALUE TO 16      */ 00102000
         MVC   HDRBUMP(4),@CF00086                                 0106 00103000
*      ELSE                             /* IF IT IS T TYPE OR TCAM   */ 00104000
*           HDRBUMP=8;                  /* SET VALUE TO 8    @Z427VLS*/ 00105000
         B     @RC00105                                            0107 00106000
@RF00105 MVC   HDRBUMP(4),@CF00063                                 0107 00107000
* ELSE                                  /* IF IT NEITHER T TYPE OR   */ 00108000
*    HDRBUMP = ZERO;                    /* TCAM SET VALUE TO ZERO    */ 00109000
         B     @RC00104                                            0108 00110000
@RF00104 SLR   @12,@12                                             0108 00111000
         ST    @12,HDRBUMP                                         0108 00112000
* HOLDTYPE=SMACCTAB;                    /* BUILD COMPARE VALUE FROM  */ 00113000
@RC00104 MVC   HOLDTYPE(5),SMACCTAB(REG4)                          0109 00114000
* HOLDCPUN=LRCPUNOS;               /* CCHHR TABLE(R4) AND CPUSER (R2)*/ 00115000
         MVC   HOLDCPUN(5),LRCPUNOS(REG7)                          0110 00116000
* /*                                                         @Z427VLS*/ 00117000
* /* CHECK FOR SHARED I/O AND CHANGE CUA AND CPU IF REQUIRED @Z427VLS*/ 00118000
* /*                                                         @Z427VLS*/ 00119000
* IF SHAREPTR ^= ZERO & (SAVERTYP = '30'X | SAVERTYP = '90'X) THEN 0111 00120000
         L     @12,SHAREPTR(,R2)                                   0111 00121000
         LTR   @12,@12                                             0111 00122000
         BZ    @RF00111                                            0111 00123000
         CLI   SAVERTYP,X'30'                                      0111 00124000
         BE    @RT00111                                            0111 00125000
         CLI   SAVERTYP,X'90'                                      0111 00126000
         BNE   @RF00111                                            0111 00127000
@RT00111 DS    0H                                                  0112 00128000
*   DO;                                                    /*@Z427VLS*/ 00129000
*     VALIDSHR = OFF;                        /* TURN OFF FOR SEARCH  */ 00130000
         NI    VALIDSHR,B'11101111'                                0113 00131000
*     IF SAVERTYP = '90'X THEN               /* MDR RECORD   @Z427VLS*/ 00132000
         CLI   SAVERTYP,X'90'                                      0114 00133000
         BNE   @RF00114                                            0114 00134000
*       SHR34CUA = LRTMCUA;                                /*@Z427VLS*/ 00135000
         MVC   SHR34CUA(2),LRTMCUA(REG7)                           0115 00136000
*     ELSE                                                         0116 00137000
*       IF SHRTSW = ON THEN                                        0116 00138000
         B     @RC00114                                            0116 00139000
@RF00114 TM    SHRTSW(REG7),B'00100000'                            0116 00140000
         BNO   @RF00116                                            0116 00141000
*         SHR34CUA = LRTSCUA;                /* CUA FOR SHORT OBR    */ 00142000
         MVC   SHR34CUA(2),LRTSCUA(REG7)                           0117 00143000
*       ELSE                                                       0118 00144000
*         SHR34CUA = LRTCUA;                 /* CUA FOR LONG OBR     */ 00145000
         B     @RC00116                                            0118 00146000
@RF00116 MVC   SHR34CUA(2),LRTCUA(REG7)                            0118 00147000
*     SHR34CPU = LRCPUNOS(1:3);              /* CPU FOR COMPARISON   */ 00148000
@RC00116 DS    0H                                                  0119 00149000
@RC00114 MVC   SHR34CPU(3),LRCPUNOS(REG7)                          0119 00150000
*     DO J = 1 TO SHARENUM BY 1 WHILE(VALIDSHR = OFF);     /*@Z427VLS*/ 00151000
         LA    @12,1                                               0120 00152000
         STH   @12,J                                               0120 00153000
         B     @DE00120                                            0120 00154000
@DL00120 TM    VALIDSHR,B'00010000'                                0120 00155000
         BNZ   @DC00120                                            0120 00156000
*       IF SHAREFLG(J)=LETTERS&SHARSERA(J)=SHR34CPU&               0121 00157000
*         SHR34CUA>=SHRCUAAL(J)&SHR34CUA<=SHRCUAAH(J)  THEN        0121 00158000
         SLA   @12,4                                               0121 00159000
         L     @10,SHAREPTR(,R2)                                   0121 00160000
         ST    @12,@TF00001                                        0121 00161000
         ALR   @12,@10                                             0121 00162000
         AL    @12,@CF00654                                        0121 00163000
         CLC   SHAREFLG-2(1,@12),LETTERS                           0121 00164000
         BNE   @RF00121                                            0121 00165000
         LR    @12,@10                                             0121 00166000
         AL    @12,@TF00001                                        0121 00167000
         AL    @12,@CF00655                                        0121 00168000
         CLC   SHARSERA-10(3,@12),SHR34CPU                         0121 00169000
         BNE   @RF00121                                            0121 00170000
         LR    @12,@10                                             0121 00171000
         AL    @12,@TF00001                                        0121 00172000
         AL    @12,@CF00656                                        0121 00173000
         CLC   SHR34CUA(2),SHRCUAAL-13(@12)                        0121 00174000
         BL    @RF00121                                            0121 00175000
         LR    @12,@10                                             0121 00176000
         AL    @12,@TF00001                                        0121 00177000
         BCTR  @12,0                                               0121 00178000
         CLC   SHR34CUA(2),SHRCUAAH-15(@12)                        0121 00179000
         BH    @RF00121                                            0121 00180000
*           DO;                              /* CUA ONLY.    @Z427VLS*/ 00181000
*             HOLDCPUN(4:5) = HOLDCPUN(4:5) && HOLDCPUN(4:5);      0123 00182000
         XC    HOLDCPUN+3(2),HOLDCPUN+3                            0123 00183000
*             HOLDCPUN(1:3) = SHARSERB(J);                 /*@Z427VLS*/ 00184000
         LR    @12,@10                                             0124 00185000
         AL    @12,@TF00001                                        0124 00186000
         AL    @12,@CF00657                                        0124 00187000
         MVC   HOLDCPUN(3),SHARSERB-3(@12)                         0124 00188000
*             VALIDSHR = ON;                               /*@Z427VLS*/ 00189000
         OI    VALIDSHR,B'00010000'                                0125 00190000
*             SHR34CUA=SHRCUABL(J)+SHR34CUA-SHRCUAAL(J);   /*@D3506GB*/ 00191000
         LR    @12,@10                                             0126 00192000
         AL    @12,@TF00001                                        0126 00193000
         AL    @12,@CF00659                                        0126 00194000
         SLR   @08,@08                                             0126 00195000
         ICM   @08,3,SHRCUABL-6(@12)                               0126 00196000
         SLR   @12,@12                                             0126 00197000
         ICM   @12,3,SHR34CUA                                      0126 00198000
         ALR   @08,@12                                             0126 00199000
         AL    @10,@TF00001                                        0126 00200000
         AL    @10,@CF00656                                        0126 00201000
         SLR   @12,@12                                             0126 00202000
         ICM   @12,3,SHRCUAAL-13(@10)                              0126 00203000
         SLR   @08,@12                                             0126 00204000
         STCM  @08,3,SHR34CUA                                      0126 00205000
*           END;                                           /*@Z427VLS*/ 00206000
*     END;                                                 /*@Z427VLS*/ 00207000
@RF00121 LA    @12,1                                               0128 00208000
         AH    @12,J                                               0128 00209000
         STH   @12,J                                               0128 00210000
@DE00120 L     @10,SHAREPTR(,R2)                                   0128 00211000
         CH    @12,SHARENUM(,@10)                                  0128 00212000
         BNH   @DL00120                                            0128 00213000
@DC00120 DS    0H                                                  0129 00214000
*     IF VALIDSHR = ON THEN                                        0129 00215000
         TM    VALIDSHR,B'00010000'                                0129 00216000
         BNO   @RF00129                                            0129 00217000
*       DO;                                                /*@Z427VLS*/ 00218000
*         IF SAVERTYP = '90'X THEN                                 0131 00219000
         CLI   SAVERTYP,X'90'                                      0131 00220000
         BNE   @RF00131                                            0131 00221000
*           LRTMCUA = SHR34CUA;           /* REPLACE IN RECORD       */ 00222000
         MVC   LRTMCUA(2,REG7),SHR34CUA                            0132 00223000
*         ELSE                                                     0133 00224000
*           IF SHRTSW = ON THEN                                    0133 00225000
         B     @RC00131                                            0133 00226000
@RF00131 TM    SHRTSW(REG7),B'00100000'                            0133 00227000
         BNO   @RF00133                                            0133 00228000
*             LRTSCUA = SHR34CUA;         /* REPLACE IN RECORD       */ 00229000
         MVC   LRTSCUA(2,REG7),SHR34CUA                            0134 00230000
*           ELSE                                                   0135 00231000
*             LRTCUA = SHR34CUA;          /* REPLACE IN RECORD       */ 00232000
         B     @RC00133                                            0135 00233000
@RF00133 MVC   LRTCUA(2,REG7),SHR34CUA                             0135 00234000
*       END;                                               /*@Z427VLS*/ 00235000
@RC00133 DS    0H                                                  0136 00236000
@RC00131 DS    0H                                                  0137 00237000
*   END;                                                   /*@Z427VLS*/ 00238000
@RF00129 DS    0H                                                  0138 00239000
* RESPECIFY (REG4) UNRESTRICTED;                           /*@Z427VLS*/ 00240000
@RF00111 DS    0H                                                  0139 00241000
*/********************************************************************/ 00242000
*/* SET UP FOR SEARCH ON MATCH.  FOUND SWITCH IS SET OFF.  IF A MATCH*/ 00243000
*/* IS FOUND THEN IT IS SET ON.  OTHERWISE, THE FORWARD POINTER IS   */ 00244000
*/* SET TO REG6.  THE SEARCH STOPS WHEN A MATCH IS FOUND OR REG6 = 0.*/ 00245000
*/********************************************************************/ 00246000
*RESPECIFY (REG6) RESTRICTED;                              /*@Z427VLS*/ 00247000
*FOUND = OFF;                                              /*@Z427VLS*/ 00248000
         NI    FOUND,B'11011111'                                   0140 00249000
*REG6 = REG5;                                              /*@Z427VLS*/ 00250000
         LR    REG6,REG5                                           0141 00251000
*DO WHILE (REG6 ^= ZERO & FOUND = OFF);                    /*@Z427VLS*/ 00252000
         B     @DE00142                                            0142 00253000
@DL00142 DS    0H                                                  0143 00254000
*  SAVER6 = REG6;                                          /*@Z427VLS*/ 00255000
         ST    REG6,SAVER6                                         0143 00256000
*  IF HOLDID = RECORDID THEN       /* DOES THIS REC MATCH PREV RECS  */ 00257000
         CLC   HOLDID(10),RECORDID(REG6)                           0144 00258000
         BNE   @RF00144                                            0144 00259000
*    DO;                                                   /*@Z427VLS*/ 00260000
*      IF TCAMSWIT = ON & SMCTCAM = ON THEN                        0146 00261000
         TM    TCAMSWIT,B'10000000'                                0146 00262000
         BNO   @RF00146                                            0146 00263000
         TM    SMCTCAM(REG6),B'10000000'                           0146 00264000
         BNO   @RF00146                                            0146 00265000
*        DO;                                               /*@Z427VLS*/ 00266000
*           IF (SHRTSW = ON & LRTTYPID ^= X3790) |                 0148 00267000
*              (SHRTSW = OFF & LRDEVTYP ^= X3790) THEN             0148 00268000
         TM    SHRTSW(REG7),B'00100000'                            0148 00269000
         BNO   @GL00015                                            0148 00270000
         CLC   LRTTYPID(2,REG7),X3790                              0148 00271000
         BNE   @RT00148                                            0148 00272000
@GL00015 TM    SHRTSW(REG7),B'00100000'                            0148 00273000
         BNZ   @RF00148                                            0148 00274000
         CLC   LRDEVTYP(2,REG7),X3790                              0148 00275000
         BE    @RF00148                                            0148 00276000
@RT00148 DS    0H                                                  0149 00277000
*              IF LRTERMNL = SMTERMNL THEN   /* SAME TERMINAL NAME   */ 00278000
         CLC   LRTERMNL(8,REG7),SMTERMNL(REG6)                     0149 00279000
         BNE   @RF00149                                            0149 00280000
*                 FOUND = ON;                              /*@Z427VLS*/ 00281000
         OI    FOUND,B'00100000'                                   0150 00282000
*              ELSE                                                0151 00283000
*                 REG6 = FWARDPTR;                         /*@Z427VLS*/ 00284000
         B     @RC00149                                            0151 00285000
@RF00149 L     REG6,FWARDPTR(,REG6)                                0151 00286000
*           ELSE                                                   0152 00287000
*              FOUND = ON;                                 /*@Z427VLS*/ 00288000
         B     @RC00148                                            0152 00289000
@RF00148 OI    FOUND,B'00100000'                                   0152 00290000
*        END;                                              /*@Z427VLS*/ 00291000
*      ELSE                                                        0154 00292000
*        IF TCAMSWIT = ON |                  /* TCAM OR 8 BYTE SW ON */ 00293000
*           SMCTCAM  = ON THEN               /* BOTH THEN NEXT AREA  */ 00294000
         B     @RC00146                                            0154 00295000
@RF00146 TM    TCAMSWIT,B'10000000'                                0154 00296000
         BO    @RT00154                                            0154 00297000
         TM    SMCTCAM(REG6),B'10000000'                           0154 00298000
         BNO   @RF00154                                            0154 00299000
@RT00154 DS    0H                                                  0155 00300000
*             REG6 = FWARDPTR;                             /*@Z427VLS*/ 00301000
         L     REG6,FWARDPTR(,REG6)                                0155 00302000
*        ELSE                                                      0156 00303000
*           IF TTYPSWIT = ON &               /* TEST FOR VAR SUB ID  */ 00304000
*              LRVARIDS = ON THEN                                  0156 00305000
         B     @RC00154                                            0156 00306000
@RF00154 TM    TTYPSWIT,B'01000000'                                0156 00307000
         BNO   @RF00156                                            0156 00308000
         TM    LRVARIDS(REG7),B'10000000'                          0156 00309000
         BNO   @RF00156                                            0156 00310000
*              DO;                           /* TEST VAR SUB ID FLDS */ 00311000
*                K = (LRVARIDF & '0F'X) + 1; /* PICK UP NO.  @Z427VLS*/ 00312000
         LA    @12,15                                              0158 00313000
         SLR   @10,@10                                             0158 00314000
         IC    @10,LRVARIDF(,REG7)                                 0158 00315000
         NR    @12,@10                                             0158 00316000
         AL    @12,@CF00052                                        0158 00317000
         ST    @12,K                                               0158 00318000
*                IF SMVARID(1:K) = LRVARID(1:K) THEN               0159 00319000
         BCTR  @12,0                                               0159 00320000
         EX    @12,@SC00662                                        0159 00321000
         BNE   @RF00159                                            0159 00322000
*                   FOUND = ON;                            /*@Z427VLS*/ 00323000
         OI    FOUND,B'00100000'                                   0160 00324000
*                ELSE                                              0161 00325000
*                   REG6 = FWARDPTR;                       /*@Z427VLS*/ 00326000
         B     @RC00159                                            0161 00327000
@RF00159 L     REG6,FWARDPTR(,REG6)                                0161 00328000
*              END;                                        /*@Z427VLS*/ 00329000
*           ELSE                                                   0163 00330000
*              /*                                            @Z427VLS*/ 00331000
*              /* IF BOTH ARE OFF, TEST FOR T-TYPE SW ON.  IF NOT ON */ 00332000
*              /* ON, SKIP TO NEXT AREA.  IF BOTH NOT OFF, TEST SUB  */ 00333000
*              /* IS FOR MATCH.  IF NO MATCH, TRY NEXT AREA. @Z427VLS*/ 00334000
*              /*                                            @Z427VLS*/ 00335000
*              IF TTYPSWIT = ON THEN                               0163 00336000
         B     @RC00156                                            0163 00337000
@RF00156 TM    TTYPSWIT,B'01000000'                                0163 00338000
         BNO   @RF00163                                            0163 00339000
*                 IF LRTTYPID = SMTTYPID THEN                      0164 00340000
         CLC   LRTTYPID(2,REG7),SMTTYPID(REG6)                     0164 00341000
         BNE   @RF00164                                            0164 00342000
*                    FOUND = ON;                           /*@Z427VLS*/ 00343000
         OI    FOUND,B'00100000'                                   0165 00344000
*                 ELSE                                             0166 00345000
*                    REG6 = FWARDPTR;                      /*@Z427VLS*/ 00346000
         B     @RC00164                                            0166 00347000
@RF00164 L     REG6,FWARDPTR(,REG6)                                0166 00348000
*              ELSE                                                0167 00349000
*                 FOUND = ON;                              /*@Z427VLS*/ 00350000
         B     @RC00163                                            0167 00351000
@RF00163 OI    FOUND,B'00100000'                                   0167 00352000
*    END;                                                  /*@Z427VLS*/ 00353000
*  ELSE                                                            0169 00354000
*    REG6 = FWARDPTR;                                      /*@Z427VLS*/ 00355000
         B     @RC00144                                            0169 00356000
@RF00144 L     REG6,FWARDPTR(,REG6)                                0169 00357000
*END;                                                      /*@Z427VLS*/ 00358000
@RC00144 DS    0H                                                  0170 00359000
@DE00142 LTR   REG6,REG6                                           0170 00360000
         BZ    @DC00142                                            0170 00361000
         TM    FOUND,B'00100000'                                   0170 00362000
         BZ    @DL00142                                            0170 00363000
@DC00142 DS    0H                                                  0171 00364000
*/*                                                          @Z427VLS*/ 00365000
*/*      BUILD A NEW COUNTER AREA, IF ONE DID NOT EXIST      @Z427VLS*/ 00366000
*/*                                                          @Z427VLS*/ 00367000
*RESPECIFY (REG3) RESTRICTED;                              /*@Z427VLS*/ 00368000
*IF REG6 = ZERO THEN                                               0172 00369000
         SLR   @12,@12                                             0172 00370000
         CR    REG6,@12                                            0172 00371000
         BNE   @RF00172                                            0172 00372000
*  DO;                                                     /*@Z427VLS*/ 00373000
*      IF SCNTSIZE ^= ZERO THEN              /* IF NO. CTRS ZERO EXIT*/ 00374000
         LH    @10,SCNTSIZE(,REG9)                                 0174 00375000
         CR    @10,@12                                             0174 00376000
         BE    @RF00174                                            0174 00377000
*        DO;                                               /*@Z427VLS*/ 00378000
*          REG3=HEADRLEN+(2*SCNTSIZE)+HDRBUMP; /* COMPUTE AREA SIZE  */ 00379000
         ALR   @10,@10                                             0176 00380000
         AL    @10,@CF00481                                        0176 00381000
         AL    @10,HDRBUMP                                         0176 00382000
         LR    REG3,@10                                            0176 00383000
*          RESPECIFY (REG15) RESTRICTED;                   /*@Z427VLS*/ 00384000
*          GEN(GETMAIN EC,LV=(REG3),A=SMWHERE); /* GET AREA CONDIT'AL*/ 00385000
         GETMAIN EC,LV=(REG3),A=SMWHERE                                 00386000
*          RETCODE = REG15;                  /* SAVE RETURN CODE     */ 00387000
         STH   REG15,RETCODE                                       0179 00388000
*          RESPECIFY (REG15) UNRESTRICTED;                 /*@Z427VLS*/ 00389000
*          IF RETCODE = ZERO THEN            /* IF R15 ZERO BUILD CTR*/ 00390000
         LH    @12,RETCODE                                         0181 00391000
         LTR   @12,@12                                             0181 00392000
         BNZ   @RF00181                                            0181 00393000
*            DO;                                           /*@Z427VLS*/ 00394000
*/*  THE FOLLOWING CODE WILL STORE IN THE COMM TABLE THE ADDRESS OF*/   00395000
*/*  GETMAIN AND THE LENGTH THES DATA WILL BE USED BY EDSUM TO DUMP*/   00396000
*/*  THE COUNTERS TO TOURIST DATA SET JUST PRIOR TO CALL IFCEEDIT TO*/  00397000
*/*  PRINT THE RESULTS SIZE SHOULD ALWAYS BE THE SAME IT IS SAVED   */  00398000
*/*  FOR EACH GETMAIN IN CASE THIS SHOULD CHANGE WE WILL AVOID A C4 */  00399000
*             IF DEBUG14 = ON & DUMPNUM ^= TWELVE THEN             0183 00400000
         TM    DEBUG14(R2),B'00000010'                             0183 00401000
         BNO   @RF00183                                            0183 00402000
         LH    @12,DUMPNUM(,R2)                                    0183 00403000
         C     @12,@CF00065                                        0183 00404000
         BE    @RF00183                                            0183 00405000
*               DO;                                        /*@Z427VLS*/ 00406000
*                 DUMPADR(DUMPNUM) = SMWHERE;              /*@Z427VLS*/ 00407000
         LR    @10,@12                                             0185 00408000
         SLA   @10,3                                               0185 00409000
         L     @08,SMWHERE                                         0185 00410000
         ST    @08,DUMPADR-8(@10,R2)                               0185 00411000
*                 DUMPSIZE(DUMPNUM) = REG3;                /*@Z427VLS*/ 00412000
         ST    REG3,DUMPSIZE-8(@10,R2)                             0186 00413000
*                 DUMPNUM = DUMPNUM + 1;                   /*@Z427VLS*/ 00414000
         AL    @12,@CF00052                                        0187 00415000
         STH   @12,DUMPNUM(,R2)                                    0187 00416000
*               END;                                       /*@Z427VLS*/ 00417000
*              /******************************************************/ 00418000
*              /*                                            @Z427VLS*/ 00419000
*              /*  IF NO CHAIN EXISTS BUILD A CHAIN WITH ONE ELEMENT */ 00420000
*              /*                                            @Z427VLS*/ 00421000
*              /******************************************************/ 00422000
*              IF REG5 = ZERO THEN           /* DOES CHAIN EXIST     */ 00423000
@RF00183 LTR   REG5,REG5                                           0189 00424000
         BNZ   @RF00189                                            0189 00425000
*                  REG5 = SMWHERE;           /* BUILD W/PTR TO FIRST */ 00426000
         L     REG5,SMWHERE                                        0190 00427000
*               ELSE                                               0191 00428000
*                  SAVER6 -> FWARDPTR = SMWHERE; /* SET FORWARD PTR  */ 00429000
         B     @RC00189                                            0191 00430000
@RF00189 L     @12,SMWHERE                                         0191 00431000
         L     @10,SAVER6                                          0191 00432000
         ST    @12,FWARDPTR(,@10)                                  0191 00433000
*               REG6 = SMWHERE;              /* PTR TO CHAIN AREAS   */ 00434000
@RC00189 L     REG6,SMWHERE                                        0192 00435000
*               EDTABPTR = REG9;             /* INITIALIZING HEADER  */ 00436000
         ST    REG9,EDTABPTR(,REG6)                                0193 00437000
*               FWARDPTR = ZERO;             /* ZERO FWARDPTR TO LAST*/ 00438000
         SLR   @12,@12                                             0194 00439000
         ST    @12,FWARDPTR(,REG6)                                 0194 00440000
*               SCCOUNT = ZERO;              /* SET COUNT TO 0       */ 00441000
         STH   @12,SCCOUNT(,REG6)                                  0195 00442000
*               RECORDID = HOLDID;           /* SET UP HEADER AREA   */ 00443000
         MVC   RECORDID(10,REG6),HOLDID                            0196 00444000
*                IF (RECORDID & FOXZERO) = '40'X THEN              0197 00445000
         MVC   @TS00001(1),RECORDID(REG6)                          0197 00446000
         NI    @TS00001,X'F0'                                      0197 00447000
         CLI   @TS00001,X'40'                                      0197 00448000
         BNE   @RF00197                                            0197 00449000
*                 RECORDID(1) = '40'X;                    /* @ZA17693*/ 00450000
         MVI   RECORDID(REG6),X'40'                                0198 00451000
*               SMCWITCH = SMCWITCH&&SMCWITCH;  /* SET SWITCHES TO 0 */ 00452000
@RF00197 XC    SMCWITCH(2,REG6),SMCWITCH(REG6)                     0199 00453000
*               /*                                           @Z427VLS*/ 00454000
*               /*      ZERO  COUNTERS. INITIALIZE TERM NAME AND     */ 00455000
*               /*      TCAM SWITCHES IN COUNTER.            @Z427VLS*/ 00456000
*               /*                                           @Z427VLS*/ 00457000
*               REG3 = REG6;                 /* SET WORK REG @Z427VLS*/ 00458000
         LR    REG3,REG6                                           0200 00459000
*               IF TCAMSWIT = ON THEN        /* IF TCAM INITIALIZE AS*/ 00460000
         TM    TCAMSWIT,B'10000000'                                0201 00461000
         BNO   @RF00201                                            0201 00462000
*                 DO;                                      /*@Z427VLS*/ 00463000
*                   SMCTCAM = ON;            /* SET TCAM SWITCH      */ 00464000
         OI    SMCTCAM(REG6),B'10000000'                           0203 00465000
*                   SMTERMNL = LRTERMNL;     /* BRING OVER TERM NAME */ 00466000
         MVC   SMTERMNL(8,REG6),LRTERMNL(REG7)                     0204 00467000
*                   REG3 = REG3+8;                         /*@Z427VLS*/ 00468000
         AL    REG3,@CF00063                                       0205 00469000
*                 END;                                     /*@Z427VLS*/ 00470000
*               ELSE                                               0207 00471000
*                 /*                                         @Z427VLS*/ 00472000
*                 /*    INITIALIZE FOR T-TYPE RECORD         @Z427VLS*/ 00473000
*                 /*                                         @Z427VLS*/ 00474000
*                 IF TTYPSWIT = ON THEN      /* IF T-TYPE REC        */ 00475000
         B     @RC00201                                            0207 00476000
@RF00201 TM    TTYPSWIT,B'01000000'                                0207 00477000
         BNO   @RF00207                                            0207 00478000
*                   DO;                                    /*@Z427VLS*/ 00479000
*                     SMTRECID = LRTRECID;   /* SET RECORD ID        */ 00480000
         MVC   SMTRECID(1,REG6),LRTRECID(REG7)                     0209 00481000
*                     SMTTYPID = LRTTYPID;   /* T-TYPE SUB ID        */ 00482000
         MVC   SMTTYPID(2,REG6),LRTTYPID(REG7)                     0210 00483000
*                     SMTTYP0 = SMTTYP0 && SMTTYP0;        /*@Z427VLS*/ 00484000
         XC    SMTTYP0(5,REG6),SMTTYP0(REG6)                       0211 00485000
*                     REG3 = REG3 + 8;                     /*@Z427VLS*/ 00486000
         LA    @12,8                                               0212 00487000
         ALR   REG3,@12                                            0212 00488000
*                     IF LRVARIDS = ON THEN   /* VAR SUB ID? @Z427VLS*/ 00489000
         TM    LRVARIDS(REG7),B'10000000'                          0213 00490000
         BNO   @RF00213                                            0213 00491000
*                       DO;                                /*@Z427VLS*/ 00492000
*                         K = (LRVARIDF & '0F'X) + 1; /* SET SIZE    */ 00493000
         LA    @10,15                                              0215 00494000
         SLR   @08,@08                                             0215 00495000
         IC    @08,LRVARIDF(,REG7)                                 0215 00496000
         NR    @10,@08                                             0215 00497000
         AL    @10,@CF00052                                        0215 00498000
         ST    @10,K                                               0215 00499000
*                         SMVARID(1:K) = LRVARID(1:K);     /*@Z427VLS*/ 00500000
         BCTR  @10,0                                               0216 00501000
         EX    @10,@SM00664                                        0216 00502000
*                         REG3 = REG3 + 8;    /* ADJUST CTR PTR      */ 00503000
         ALR   REG3,@12                                            0217 00504000
*                       END;                               /*@Z427VLS*/ 00505000
*                   END;                                   /*@Z427VLS*/ 00506000
@RF00213 DS    0H                                                  0220 00507000
*                 /*                                         @Z427VLS*/ 00508000
*                 /*  ZERO COUNTER LOOP                      @Z427VLS*/ 00509000
*                 /*                                         @Z427VLS*/ 00510000
*                 DO J=SCNTSIZE TO 1 BY -1 ;     /* ZERO NO. CTRS    */ 00511000
@RF00207 DS    0H                                                  0220 00512000
@RC00201 LH    @12,SCNTSIZE(,REG9)                                 0220 00513000
         STH   @12,J                                               0220 00514000
         B     @DE00220                                            0220 00515000
@DL00220 DS    0H                                                  0221 00516000
*                   REG3 -> SCCOUNTR(J) = ZERO;  /* FOUND IN TABLE   */ 00517000
         LR    @10,@12                                             0221 00518000
         ALR   @10,@10                                             0221 00519000
         SLR   @08,@08                                             0221 00520000
         STH   @08,SCCOUNTR-2(@10,REG3)                            0221 00521000
*                 END;                                     /*@Z427VLS*/ 00522000
         BCTR  @12,0                                               0222 00523000
         STH   @12,J                                               0222 00524000
@DE00220 LTR   @12,@12                                             0222 00525000
         BP    @DL00220                                            0222 00526000
*            END;                                          /*@Z427VLS*/ 00527000
*          ELSE                                                    0224 00528000
*            EXIT = ON;                      /* CAN'T BUILD CTRS,EXIT*/ 00529000
         B     @RC00181                                            0224 00530000
@RF00181 OI    EXIT,B'00001000'                                    0224 00531000
*        END;                                              /*@Z427VLS*/ 00532000
*      ELSE                                                        0226 00533000
*        DO;                                               /*@Z427VLS*/ 00534000
         B     @RC00174                                            0226 00535000
@RF00174 DS    0H                                                  0227 00536000
*           EXIT = ON;                       /* EXIT, NO COUNTERS    */ 00537000
         OI    EXIT,B'00001000'                                    0227 00538000
*           RETCODE = ZERO;                  /* GOOD RETURN CODE     */ 00539000
         SLR   @12,@12                                             0228 00540000
         STH   @12,RETCODE                                         0228 00541000
*        END;                                              /*@Z427VLS*/ 00542000
*  END;                                                    /*@Z427VLS*/ 00543000
@RC00174 DS    0H                                                  0231 00544000
*/********************************************************************/ 00545000
*/*                                                          @Z427VLS*/ 00546000
*/*      SUM RECORD SECTION                                  @Z427VLS*/ 00547000
*/*                                                          @Z427VLS*/ 00548000
*/********************************************************************/ 00549000
*IF EXIT = OFF THEN                                                0231 00550000
@RF00172 TM    EXIT,B'00001000'                                    0231 00551000
         BNZ   @RF00231                                            0231 00552000
*  DO;                                                     /*@Z427VLS*/ 00553000
*  RESPECIFY (R4,R8) RESTRICTED;                           /*@D3505GB*/ 00554000
*  R4 = R2;                  /*PASS THE COMM TABLE ADDRESS TO SUMMARY*/ 00555000
         LR    R4,R2                                               0234 00556000
*  R4 = R2;                  /*PASS THE COMM TABLE ADDRESS TO SUMMARY*/ 00557000
         LR    R4,R2                                               0235 00558000
*    R2 = REG7;   /*SET ADDRESSABILITY FOR SUM TABLE R2 WILL BE      */ 00559000
         LR    R2,REG7                                             0236 00560000
*                 /*RESTORED UPON EXIT FROM ESUMS            @Z427VLS*/ 00561000
*    SCCOUNT = SCCOUNT + 1;                                /*@Z427VLS*/ 00562000
         LA    @12,1                                               0237 00563000
         AH    @12,SCCOUNT(,REG6)                                  0237 00564000
         STH   @12,SCCOUNT(,REG6)                                  0237 00565000
*    DO REG8 = CONTRPTR BY 6 WHILE( STFLAG ^= 'FF'X);      /*@Z427VLS*/ 00566000
         L     REG8,CONTRPTR(,REG9)                                0238 00567000
         B     @DE00238                                            0238 00568000
@DL00238 DS    0H                                                  0239 00569000
*      IF SUMFLAG = ON THEN        /* IS THIS ENTRY A NORMAL SUM     */ 00570000
         TM    SUMFLAG(REG8),B'10000000'                           0239 00571000
         BNO   @RF00239                                            0239 00572000
*        DO;                                               /*@Z427VLS*/ 00573000
*          /*                                                @Z427VLS*/ 00574000
*          /*      SUM-SPECIAL ROUTINE ENTRY                 @Z427VLS*/ 00575000
*          /*      SETS REGS AS FOLLOWS                      @Z427VLS*/ 00576000
*          /*            R3   PTR TO COUNTER TO BE USED      @Z427VLS*/ 00577000
*          /*            R8   PTR TO CURRENT ELEMENT OF TABLE        */ 00578000
*          /*            R9   PTR TO SUMMARY TABLE           @Z427VLS*/ 00579000
*          /*            R14  TRN POINT                      @Z427VLS*/ 00580000
*          /*            R15  ENTRY POINT                    @Z427VLS*/ 00581000
*          /*                                                @Z427VLS*/ 00582000
*          SMTABELM=REG8 ;                   /* SAVE CURR ENTRY PTR  */ 00583000
         ST    REG8,SMTABELM(,REG9)                                0241 00584000
*          REG3=REG6+HEADRLEN+(2*SCOFFSET)+HDRBUMP;        /*@Z427VLS*/ 00585000
         LA    REG3,22                                             0242 00586000
         ALR   REG3,REG6                                           0242 00587000
         LH    @12,SCOFFSET(,REG8)                                 0242 00588000
         ALR   @12,@12                                             0242 00589000
         ALR   REG3,@12                                            0242 00590000
         AL    REG3,HDRBUMP                                        0242 00591000
*          SUMSPEC = REG9 + STSPCPTR;        /* SET ENTRY PTR R9+    */ 00592000
         LR    @12,REG9                                            0243 00593000
         AH    @12,STSPCPTR(,REG8)                                 0243 00594000
         ST    @12,SUMSPEC                                         0243 00595000
*          CALL SPECIAL;                     /* OFFSET FROM TAB ENTRY*/ 00596000
         LR    @15,@12                                             0244 00597000
         BALR  @14,@15                                             0244 00598000
*                            RESPECIFY (R4) UNRESTRICTED;          0245 00599000
*       IF SAVERTYP = '30'X THEN                                   0246 00600000
         CLI   SAVERTYP,X'30'                                      0246 00601000
         BNE   @RF00246                                            0246 00602000
*         DO;                                                      0247 00603000
*           IF LRDEVTYP =  '2102'X  THEN                           0248 00604000
         CLC   LRDEVTYP(2,REG7),@CB00609                           0248 00605000
         BNE   @RF00248                                            0248 00606000
*            DO;                                                   0249 00607000
*             R2 = R4;     /*RESET THE COMM TABLE ADDRESSABILITY*/ 0250 00608000
         LR    R2,R4                                               0250 00609000
*             RDTHRSH =    LRCPUNOS ;                              0251 00610000
         MVC   RDTHRSH(3,R2),LRCPUNOS(REG7)                        0251 00611000
*             ANALYSIS = ON;          /*TELL IFCEDSUM TO CALL IFCNFPDR* 00612000
         OI    ANALYSIS(R2),B'00001000'                            0252 00613000
*             CLEAR = CLEAR && CLEAR; /*CLEAR THE FIRST PART */    0253 00614000
         L     @12,SAVE4                                           0253 00615000
         XC    CLEAR(6,@12),CLEAR(@12)                             0253 00616000
*             IF VALIDSHR = ON THEN /*SHARE CARDS APPLY THIS REC*/ 0254 00617000
         TM    VALIDSHR,B'00010000'                                0254 00618000
         BNO   @RF00254                                            0254 00619000
*               ISSHARED = ON;        /*TELL IFCNFPDR ABOUT THIS*/ 0255 00620000
         OI    ISSHARED(@12),B'01000000'                           0255 00621000
*             IF (FSCCODE2&'F0'X)='10'X THEN                       0256 00622000
@RF00254 LR    @12,R7                                              0256 00623000
         AH    @12,RECLNGTH(,R2)                                   0256 00624000
         LR    @10,@12                                             0256 00625000
         AL    @10,@CF00667                                        0256 00626000
         MVC   @TS00001(1),FSCCODE2(@10)                           0256 00627000
         NI    @TS00001,X'F0'                                      0256 00628000
         CLI   @TS00001,X'10'                                      0256 00629000
         BNE   @RF00256                                            0256 00630000
*               DO;                                                0257 00631000
*                   IF FSCCODE = '9001'X |                         0258 00632000
*                      FSCCODE = '9002'X |                         0258 00633000
*                      FSCCODE = '9003'X |                         0258 00634000
*                      FSCCODE = '9006'X |                         0258 00635000
*                      FSCCODE = '9007'X |                         0258 00636000
*                      FSCCODE = '900E'X |                         0258 00637000
*                      FSCCODE1 = '93'X |                          0258 00638000
*                      FSCCODE1 = '9A'X  THEN                      0258 00639000
         BCTR  @12,0                                               0258 00640000
         BCTR  @12,0                                               0258 00641000
         CLC   FSCCODE(2,@12),@CB00611                             0258 00642000
         BE    @RT00258                                            0258 00643000
         CLC   FSCCODE(2,@12),@CB00612                             0258 00644000
         BE    @RT00258                                            0258 00645000
         CLC   FSCCODE(2,@12),@CB00613                             0258 00646000
         BE    @RT00258                                            0258 00647000
         CLC   FSCCODE(2,@12),@CB00614                             0258 00648000
         BE    @RT00258                                            0258 00649000
         CLC   FSCCODE(2,@12),@CB00615                             0258 00650000
         BE    @RT00258                                            0258 00651000
         CLC   FSCCODE(2,@12),@CB00616                             0258 00652000
         BE    @RT00258                                            0258 00653000
         CLI   FSCCODE1(@12),X'93'                                 0258 00654000
         BE    @RT00258                                            0258 00655000
         CLI   FSCCODE1(@12),X'9A'                                 0258 00656000
         BNE   @RF00258                                            0258 00657000
@RT00258 DS    0H                                                  0259 00658000
*                         GROUP = '01'X;                           0259 00659000
         L     @12,SAVE4                                           0259 00660000
         MVI   GROUP(@12),X'01'                                    0259 00661000
*                   ELSE                                           0260 00662000
*                        IF FSCCODE = '1901'X |                    0260 00663000
*                           FSCCODE = '1903'X |                    0260 00664000
*                           FSCCODE = '1905'X |                    0260 00665000
*                           FSCCODE = '1907'X |                    0260 00666000
*                           FSCCODE = '1908'X |                    0260 00667000
*                           FSCCODE = '900B'X |                    0260 00668000
*                           FSCCODE = '900F'X |                    0260 00669000
*                           FSCCODE1 = '10'X |                     0260 00670000
*                           FSCCODE1 = '94'X |                     0260 00671000
*                           FSCCODE1 = '96'X |                     0260 00672000
*                           FSCCODE1 = '98'X  THEN                 0260 00673000
         B     @RC00258                                            0260 00674000
@RF00258 LR    @12,R7                                              0260 00675000
         AH    @12,RECLNGTH(,R2)                                   0260 00676000
         BCTR  @12,0                                               0260 00677000
         BCTR  @12,0                                               0260 00678000
         CLC   FSCCODE(2,@12),@CB00620                             0260 00679000
         BE    @RT00260                                            0260 00680000
         CLC   FSCCODE(2,@12),@CB00621                             0260 00681000
         BE    @RT00260                                            0260 00682000
         CLC   FSCCODE(2,@12),@CB00622                             0260 00683000
         BE    @RT00260                                            0260 00684000
         CLC   FSCCODE(2,@12),@CB00623                             0260 00685000
         BE    @RT00260                                            0260 00686000
         CLC   FSCCODE(2,@12),@CB00624                             0260 00687000
         BE    @RT00260                                            0260 00688000
         CLC   FSCCODE(2,@12),@CB00625                             0260 00689000
         BE    @RT00260                                            0260 00690000
         CLC   FSCCODE(2,@12),@CB00626                             0260 00691000
         BE    @RT00260                                            0260 00692000
         CLI   FSCCODE1(@12),X'10'                                 0260 00693000
         BE    @RT00260                                            0260 00694000
         CLI   FSCCODE1(@12),X'94'                                 0260 00695000
         BE    @RT00260                                            0260 00696000
         CLI   FSCCODE1(@12),X'96'                                 0260 00697000
         BE    @RT00260                                            0260 00698000
         CLI   FSCCODE1(@12),X'98'                                 0260 00699000
         BNE   @RF00260                                            0260 00700000
@RT00260 DS    0H                                                  0261 00701000
*                             GROUP = '02'X;                       0261 00702000
         L     @12,SAVE4                                           0261 00703000
         MVI   GROUP(@12),X'02'                                    0261 00704000
*                        ELSE                                      0262 00705000
*                             IF FSCCODE = '191A'X THEN            0262 00706000
         B     @RC00260                                            0262 00707000
@RF00260 LR    @12,R7                                              0262 00708000
         AH    @12,RECLNGTH(,R2)                                   0262 00709000
         LR    @10,@12                                             0262 00710000
         BCTR  @10,0                                               0262 00711000
         BCTR  @10,0                                               0262 00712000
         CLC   FSCCODE(2,@10),@CB00631                             0262 00713000
         BNE   @RF00262                                            0262 00714000
*                                DO;                               0263 00715000
*                                   IF BYTE0304 = BYTE0809 THEN    0264 00716000
         LR    @10,@12                                             0264 00717000
         AL    @10,@CF00668                                        0264 00718000
         AL    @12,@CF00669                                        0264 00719000
         CLC   BYTE0304(2,@10),BYTE0809(@12)                       0264 00720000
         BNE   @RF00264                                            0264 00721000
*                                      EQUAL = ON;                 0265 00722000
         L     @12,SAVE4                                           0265 00723000
         OI    EQUAL(@12),B'00100000'                              0265 00724000
*                                      GROUP = '03'X;              0266 00725000
@RF00264 L     @12,SAVE4                                           0266 00726000
         MVI   GROUP(@12),X'03'                                    0266 00727000
*                                END;                              0267 00728000
*                             ELSE                                 0268 00729000
*                                IF FSCCODE = '1444'X |            0268 00730000
*                                   FSCCODE = '1448'X |            0268 00731000
*                                   FSCCODE = '152C'X |            0268 00732000
*                                   FSCCODE = '154E'X |            0268 00733000
*                                   FSCCODE = '162A'X |            0268 00734000
*                                   FSCCODE = '164A'X THEN         0268 00735000
         B     @RC00262                                            0268 00736000
@RF00262 LR    @12,R7                                              0268 00737000
         AH    @12,RECLNGTH(,R2)                                   0268 00738000
         BCTR  @12,0                                               0268 00739000
         BCTR  @12,0                                               0268 00740000
         CLC   FSCCODE(2,@12),@CB00632                             0268 00741000
         BE    @RT00268                                            0268 00742000
         CLC   FSCCODE(2,@12),@CB00633                             0268 00743000
         BE    @RT00268                                            0268 00744000
         CLC   FSCCODE(2,@12),@CB00634                             0268 00745000
         BE    @RT00268                                            0268 00746000
         CLC   FSCCODE(2,@12),@CB00635                             0268 00747000
         BE    @RT00268                                            0268 00748000
         CLC   FSCCODE(2,@12),@CB00636                             0268 00749000
         BE    @RT00268                                            0268 00750000
         CLC   FSCCODE(2,@12),@CB00637                             0268 00751000
         BNE   @RF00268                                            0268 00752000
@RT00268 DS    0H                                                  0269 00753000
*                                     GROUP = '04'X;               0269 00754000
         L     @12,SAVE4                                           0269 00755000
         MVI   GROUP(@12),X'04'                                    0269 00756000
*                                ELSE                              0270 00757000
*                                      IF FSCCODE1= '1A'X |        0270 00758000
*                                         FSCCODE1= '1B'X THEN     0270 00759000
         B     @RC00268                                            0270 00760000
@RF00268 LR    @12,R7                                              0270 00761000
         AH    @12,RECLNGTH(,R2)                                   0270 00762000
         BCTR  @12,0                                               0270 00763000
         BCTR  @12,0                                               0270 00764000
         CLI   FSCCODE1(@12),X'1A'                                 0270 00765000
         BE    @RT00270                                            0270 00766000
         CLI   FSCCODE1(@12),X'1B'                                 0270 00767000
         BNE   @RF00270                                            0270 00768000
@RT00270 DS    0H                                                  0271 00769000
*                                            GROUP = '05'X;        0271 00770000
         L     @12,SAVE4                                           0271 00771000
         MVI   GROUP(@12),X'05'                                    0271 00772000
*                                      ELSE                        0272 00773000
*                                            GROUP = 'FF'X;        0272 00774000
         B     @RC00270                                            0272 00775000
@RF00270 L     @12,SAVE4                                           0272 00776000
         MVI   GROUP(@12),X'FF'                                    0272 00777000
*                 END;                                             0273 00778000
*               ELSE                                               0274 00779000
*                    IF (FSCCODE&'FFF0'X)='4940'X THEN             0274 00780000
         B     @RC00256                                            0274 00781000
@RF00256 LR    @12,R7                                              0274 00782000
         AH    @12,RECLNGTH(,R2)                                   0274 00783000
         BCTR  @12,0                                               0274 00784000
         BCTR  @12,0                                               0274 00785000
         MVC   @TS00001(2),FSCCODE(@12)                            0274 00786000
         NC    @TS00001(2),@CB00642                                0274 00787000
         CLC   @TS00001(2),@CB00643                                0274 00788000
         BNE   @RF00274                                            0274 00789000
*                        DO;                                       0275 00790000
*                          GROUP = '06'X;                          0276 00791000
         L     @12,SAVE4                                           0276 00792000
         MVI   GROUP(@12),X'06'                                    0276 00793000
*                          FORMAT4 = ON;                           0277 00794000
         OI    FORMAT4(@12),B'00010000'                            0277 00795000
*                        END;                                      0278 00796000
*                    ELSE                                          0279 00797000
*                       IF (FSCCODE2&'F0'X)= '50'X THEN            0279 00798000
         B     @RC00274                                            0279 00799000
@RF00274 LR    @12,R7                                              0279 00800000
         AH    @12,RECLNGTH(,R2)                                   0279 00801000
         AL    @12,@CF00667                                        0279 00802000
         MVC   @TS00001(1),FSCCODE2(@12)                           0279 00803000
         NI    @TS00001,X'F0'                                      0279 00804000
         CLI   @TS00001,X'50'                                      0279 00805000
         BNE   @RF00279                                            0279 00806000
*                           GROUP = '06'X;                         0280 00807000
         L     @12,SAVE4                                           0280 00808000
         MVI   GROUP(@12),X'06'                                    0280 00809000
*                       ELSE                                       0281 00810000
*                           GROUP = 'FF'X;                         0281 00811000
         B     @RC00279                                            0281 00812000
@RF00279 L     @12,SAVE4                                           0281 00813000
         MVI   GROUP(@12),X'FF'                                    0281 00814000
*           CUA3  = LRTCUA;                                        0282 00815000
@RC00279 DS    0H                                                  0282 00816000
@RC00274 DS    0H                                                  0282 00817000
@RC00256 L     @12,SAVE4                                           0282 00818000
         MVC   CUA3(2,@12),LRTCUA(REG7)                            0282 00819000
*           FSCTAB = FSCCODE;                                      0283 00820000
         LR    @10,R7                                              0283 00821000
         AH    @10,RECLNGTH(,R2)                                   0283 00822000
         LR    @04,@10                                             0283 00823000
         BCTR  @04,0                                               0283 00824000
         BCTR  @04,0                                               0283 00825000
         MVC   FSCTAB(2,@12),FSCCODE(@04)                          0283 00826000
*           IF(BYT2BIT3 & '10'X ) = '10'X THEN                     0284 00827000
         AL    @10,@CF00670                                        0284 00828000
         MVC   @TS00001(1),BYT2BIT3(@10)                           0284 00829000
         NI    @TS00001,X'10'                                      0284 00830000
         CLI   @TS00001,X'10'                                      0284 00831000
         BNE   @RF00284                                            0284 00832000
*             EVD = ON;                                            0285 00833000
         OI    EVD(@12),B'10000000'                                0285 00834000
*             END;                                                 0286 00835000
*        END;                                                      0287 00836000
*      ELSE                                                        0288 00837000
*        IF SAVERTYP = '90'X & LRTRECID = '17'X THEN               0288 00838000
         B     @RC00246                                            0288 00839000
@RF00246 CLI   SAVERTYP,X'90'                                      0288 00840000
         BNE   @RF00288                                            0288 00841000
         CLI   LRTRECID(REG7),X'17'                                0288 00842000
         BNE   @RF00288                                            0288 00843000
*          GROUP = 'FF'X;                                          0289 00844000
         L     @12,SAVE4                                           0289 00845000
         MVI   GROUP(@12),X'FF'                                    0289 00846000
*  RESPECIFY (R4) UNRESTRICTED;                            /*@D3505GB*/ 00847000
@RF00288 DS    0H                                                  0290 00848000
@RC00246 DS    0H                                                  0291 00849000
*                            RESPECIFY (R4) UNRESTRICTED;  /*@D35UGGB*/ 00850000
*          REG8=SMTABELM;                    /* RESET REG 8  @Z427VLS*/ 00851000
         L     REG8,SMTABELM(,REG9)                                0292 00852000
*        END;                                              /*@Z427VLS*/ 00853000
*      ELSE                                                        0294 00854000
*        DO;                                               /*@Z427VLS*/ 00855000
         B     @RC00239                                            0294 00856000
@RF00239 DS    0H                                                  0295 00857000
*          /**********************************************************/ 00858000
*          /*                                                @Z427VLS*/ 00859000
*          /* NORMAL SUMMARY PROCESSING - A MASK IS USED.  IF THE    */ 00860000
*          /* FLAG IS OFF, NOTHING WILL BE DONE.  IF IT IS ON, ONE   */ 00861000
*          /* WILL BE ADDED TO THE INDICATED COUNTER.        @Z427VLS*/ 00862000
*          /*                                                @Z427VLS*/ 00863000
*          /**********************************************************/ 00864000
*          IF STFLAG = '00'X THEN       /* SUM TO ADD > ONE BIT?     */ 00865000
         CLI   STFLAG(REG8),X'00'                                  0295 00866000
         BNE   @RF00295                                            0295 00867000
*            DO;                                           /*@Z427VLS*/ 00868000
*              SUMSPEC = LROFFSET + R2;   /* OFFSET FROM ENTRY       */ 00869000
         LR    @12,R2                                              0297 00870000
         AH    @12,LROFFSET(,REG8)                                 0297 00871000
         ST    @12,SUMSPEC                                         0297 00872000
*              IF (SUMMARY & STMASK) = STMASK THEN                 0298 00873000
         MVC   @TS00001(1),SUMMARY(@12)                            0298 00874000
         NC    @TS00001(1),STMASK(REG8)                            0298 00875000
         CLC   @TS00001(1),STMASK(REG8)                            0298 00876000
         BNE   @RF00298                                            0298 00877000
*                DO;                                       /*@Z427VLS*/ 00878000
*                  REG3=REG6+HDRBUMP;   /* UP PTR BY COMPUTED VALUE  */ 00879000
         LR    REG3,REG6                                           0300 00880000
         AL    REG3,HDRBUMP                                        0300 00881000
*                  REG3 -> SCCOUNTR(SCOFFSET+1) =                  0301 00882000
*                          REG3 -> SCCOUNTR(SCOFFSET+1) + 1;       0301 00883000
         LH    @12,SCOFFSET(,REG8)                                 0301 00884000
         ALR   @12,@12                                             0301 00885000
         LA    @10,1                                               0301 00886000
         AH    @10,SCCOUNTR(@12,REG3)                              0301 00887000
         STH   @10,SCCOUNTR(@12,REG3)                              0301 00888000
*                END;                                      /*@Z427VLS*/ 00889000
*            END;                                          /*@Z427VLS*/ 00890000
*          ELSE                                                    0304 00891000
*            DO;                                           /*@Z427VLS*/ 00892000
         B     @RC00295                                            0304 00893000
@RF00295 DS    0H                                                  0305 00894000
*              RESPECIFY (REG12) RESTRICTED;               /*@Z427VLS*/ 00895000
*              SHIFT = REG8 -> SUMMARY; /*GET FIRST BYTE OF SUM ENTRY*/ 00896000
         SLR   @10,@10                                             0306 00897000
         IC    @10,SUMMARY(,REG8)                                  0306 00898000
         STH   @10,SHIFT                                           0306 00899000
*              SRL(SHIFT,4);            /* ISOLATE SHIFT BITS@ZA32228*/ 00900000
         LR    @04,@10                                             0307 00901000
         SRL   @04,4                                               0307 00902000
         STH   @04,SHIFT                                           0307 00903000
*              SHIFT = SHIFT + 24;      /* INCR TO ISOLATE BITS      */ 00904000
         LA    @04,24                                              0308 00905000
         AH    @04,SHIFT                                           0308 00906000
         STH   @04,SHIFT                                           0308 00907000
*              REG12 = LROFFSET + REG7; /* POINT TO LOGREC BYTE      */ 00908000
         LR    REG12,REG7                                          0309 00909000
         AH    REG12,LROFFSET(,REG8)                               0309 00910000
*              REG12 = REG12->SUMMARY;  /* PUT BYTE FROM LOGREC IN 12*/ 00911000
         SLR   @15,@15                                             0310 00912000
         IC    @15,SUMMARY(,REG12)                                 0310 00913000
         LR    REG12,@15                                           0310 00914000
*              SLL(REG12,SHIFT);        /* ISOLATE BITS TO BE ADDED  */ 00915000
         SLL   REG12,0(@04)                                        0311 00916000
*              SHIFT = 32 - ((REG8 -> SUMMARY) & '0F'X);   /*@Z427VLS*/ 00917000
         N     @10,@CF00597                                        0312 00918000
         LCR   @10,@10                                             0312 00919000
         AL    @10,@CF00648                                        0312 00920000
         STH   @10,SHIFT                                           0312 00921000
*                                       /* SUBTRACT THE LENGTH OF FLD*/ 00922000
*              SRL(REG12,SHIFT);        /* RIGHT ALIGN THE BITS      */ 00923000
         SRL   REG12,0(@10)                                        0313 00924000
*              REG3 = REG6 + HDRBUMP;   /* POINT TO CTRS TO BE UPDTED*/ 00925000
         LR    REG3,REG6                                           0314 00926000
         AL    REG3,HDRBUMP                                        0314 00927000
*              REG3 -> SCCOUNTR(SCOFFSET+1) =                      0315 00928000
*                      REG3 -> SCCOUNTR(SCOFFSET+1) + REG12;       0315 00929000
         LH    @10,SCOFFSET(,REG8)                                 0315 00930000
         ALR   @10,@10                                             0315 00931000
         LR    @04,REG12                                           0315 00932000
         AH    @04,SCCOUNTR(@10,REG3)                              0315 00933000
         STH   @04,SCCOUNTR(@10,REG3)                              0315 00934000
*              RESPECIFY (REG12) UNRESTRICTED;             /*@Z427VLS*/ 00935000
*            END;                                          /*@Z427VLS*/ 00936000
*        END;                                              /*@Z427VLS*/ 00937000
@RC00295 DS    0H                                                  0319 00938000
*    END;                                                  /*@Z427VLS*/ 00939000
@RC00239 AL    REG8,@CF00078                                       0319 00940000
@DE00238 CLI   STFLAG(REG8),X'FF'                                  0319 00941000
         BNE   @DL00238                                            0319 00942000
*    RETCODE = ZERO;                    /* SET RTN CODE SUCCESSFUL   */ 00943000
         SLR   @12,@12                                             0320 00944000
         STH   @12,RETCODE                                         0320 00945000
*    RESPECIFY (REG8) UNRESTRICTED;                        /*@Z427VLS*/ 00946000
*  END;                                                    /*@Z427VLS*/ 00947000
*RESPECIFY (REG15) RESTRICTED;                             /*@Z427VLS*/ 00948000
@RF00231 DS    0H                                                  0324 00949000
*REG15 = RETCODE;                                          /*@Z427VLS*/ 00950000
         LH    REG15,RETCODE                                       0324 00951000
*RETURN;                                                   /*@Z427VLS*/ 00952000
@EL00001 L     @13,4(,@13)                                         0325 00953000
@EF00001 DS    0H                                                  0325 00954000
@ER00001 L     @14,12(,@13)                                        0325 00955000
         LM    @00,@04,20(@13)                                     0325 00956000
         LM    @06,@12,44(@13)                                     0325 00957000
         BR    @14                                                 0325 00958000
*RESPECIFY (R2,REG7,REG3,REG5,REG6,REG8,REG9,REG15) UNRESTRICTED;  0326 00959000
*END   IFCESUMS                                            /*@Z427VLS*/ 00960000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 00961000
*/*%INCLUDE SYSLIB  (COMTABLE)                                        * 00962000
*;                                                                 0327 00963000
@DATA    DS    0H                                                       00964000
@SC00662 CLC   SMVARID(0,REG6),LRVARID(REG7)                            00965000
@SM00664 MVC   SMVARID(0,REG6),LRVARID(REG7)                            00966000
         DS    0F                                                       00967000
@SA00001 DS    18F                                                      00968000
@TF00001 DS    F                                                        00969000
         DS    0F                                                       00970000
@CF00052 DC    F'1'                                                     00971000
@CF00078 DC    F'6'                                                     00972000
@CF00063 DC    F'8'                                                     00973000
@CF00065 DC    F'12'                                                    00974000
@CF00086 DC    F'16'                                                    00975000
@CF00481 DC    F'22'                                                    00976000
@CF00648 DC    F'32'                                                    00977000
@CF00670 DC    F'-22'                                                   00978000
@CF00668 DC    F'-21'                                                   00979000
@CF00667 DC    F'-17'                                                   00980000
@CF00669 DC    F'-16'                                                   00981000
@CF00654 DC    F'-14'                                                   00982000
@CF00657 DC    F'-13'                                                   00983000
@CF00659 DC    F'-10'                                                   00984000
@CF00655 DC    F'-6'                                                    00985000
@CF00656 DC    F'-3'                                                    00986000
@CF00597 DC    XL4'0F'                                                  00987000
         DS    0D                                                       00988000
SAVER6   DS    A                                                        00989000
K        DS    F                                                        00990000
SUMSPEC  DS    A                                                        00991000
HDRBUMP  DS    F                                                        00992000
SMWHERE  DS    A                                                        00993000
SAVE4    DC    A(0)                                                     00994000
J        DS    H                                                        00995000
RETCODE  DS    H                                                        00996000
SHIFT    DS    H                                                        00997000
@TS00001 DS    CL2                                                      00998000
@CB00609 DC    X'2102'                                                  00999000
@CB00611 DC    X'9001'                                                  01000000
@CB00612 DC    X'9002'                                                  01001000
@CB00613 DC    X'9003'                                                  01002000
@CB00614 DC    X'9006'                                                  01003000
@CB00615 DC    X'9007'                                                  01004000
@CB00616 DC    X'900E'                                                  01005000
@CB00620 DC    X'1901'                                                  01006000
@CB00621 DC    X'1903'                                                  01007000
@CB00622 DC    X'1905'                                                  01008000
@CB00623 DC    X'1907'                                                  01009000
@CB00624 DC    X'1908'                                                  01010000
@CB00625 DC    X'900B'                                                  01011000
@CB00626 DC    X'900F'                                                  01012000
@CB00631 DC    X'191A'                                                  01013000
@CB00632 DC    X'1444'                                                  01014000
@CB00633 DC    X'1448'                                                  01015000
@CB00634 DC    X'152C'                                                  01016000
@CB00635 DC    X'154E'                                                  01017000
@CB00636 DC    X'162A'                                                  01018000
@CB00637 DC    X'164A'                                                  01019000
@CB00642 DC    X'FFF0'                                                  01020000
@CB00643 DC    X'4940'                                                  01021000
SWES     DC    X'00'                                                    01022000
         ORG   SWES                                                     01023000
TCAMSWIT DS    BL1                                                      01024000
TTYPSWIT EQU   SWES+0                                                   01025000
FOUND    EQU   SWES+0                                                   01026000
VALIDSHR EQU   SWES+0                                                   01027000
EXIT     EQU   SWES+0                                                   01028000
         ORG   SWES+1                                                   01029000
HOLDID   DS    CL10                                                     01030000
         ORG   HOLDID                                                   01031000
HOLDTYPE DS    CL5                                                      01032000
HOLDCPUN DS    CL5                                                      01033000
         ORG   HOLDID+10                                                01034000
X3790    DC    X'40F1'                                                  01035000
LETTERS  DC    CL1'S'                                                   01036000
@NM00012 DS    CL5                                                      01037000
         ORG   @NM00012                                                 01038000
SHR34XXX DS    CL5                                                      01039000
         ORG   SHR34XXX                                                 01040000
SHR34CUA DS    CL2                                                      01041000
SHR34CPU DS    CL3                                                      01042000
         ORG   @NM00012+5                                               01043000
SAVERTYP DS    CL1                                                      01044000
SAVECUA  DS    CL3                                                      01045000
SUPERZAP DC    3CL10'SUPERZAP'                                          01046000
         DS    CL1                                                      01047000
PATCH    DC    20H'0'                                                   01048000
IFCESUMS CSECT                                                          01049000
         DC    S(SUPERZAP)                                              01050000
IFCESUMS CSECT                                                          01051000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01052000
@01      EQU   01                                                       01053000
@02      EQU   02                                                       01054000
@03      EQU   03                                                       01055000
@04      EQU   04                                                       01056000
@05      EQU   05                                                       01057000
@06      EQU   06                                                       01058000
@07      EQU   07                                                       01059000
@08      EQU   08                                                       01060000
@09      EQU   09                                                       01061000
@10      EQU   10                                                       01062000
@11      EQU   11                                                       01063000
@12      EQU   12                                                       01064000
@13      EQU   13                                                       01065000
@14      EQU   14                                                       01066000
@15      EQU   15                                                       01067000
R2       EQU   @02                                                      01068000
R4       EQU   @04                                                      01069000
R7       EQU   @07                                                      01070000
R8       EQU   @08                                                      01071000
REG3     EQU   @03                                                      01072000
REG4     EQU   @04                                                      01073000
REG5     EQU   @05                                                      01074000
REG6     EQU   @06                                                      01075000
REG7     EQU   @07                                                      01076000
REG8     EQU   @08                                                      01077000
REG9     EQU   @09                                                      01078000
REG12    EQU   @12                                                      01079000
REG15    EQU   @15                                                      01080000
R0       EQU   @00                                                      01081000
R1       EQU   @01                                                      01082000
R10      EQU   @10                                                      01083000
R11      EQU   @11                                                      01084000
R12      EQU   @12                                                      01085000
R13      EQU   @13                                                      01086000
R14      EQU   @14                                                      01087000
R15      EQU   @15                                                      01088000
R3       EQU   @03                                                      01089000
R5       EQU   @05                                                      01090000
R6       EQU   @06                                                      01091000
R9       EQU   @09                                                      01092000
PARM     EQU   0                                                        01093000
RECTYPE  EQU   PARM                                                     01094000
SWITCHES EQU   PARM+2                                                   01095000
ANALYSIS EQU   SWITCHES+1                                               01096000
DEBUG    EQU   PARM+4                                                   01097000
DEBUG14  EQU   DEBUG+1                                                  01098000
DEBUGA   EQU   PARM+8                                                   01099000
MISC     EQU   PARM+12                                                  01100000
PRINTES  EQU   MISC                                                     01101000
OPENCLSE EQU   PARM+13                                                  01102000
OPENIO   EQU   OPENCLSE                                                 01103000
CLOSEIO  EQU   OPENCLSE+2                                               01104000
DATENOW  EQU   PARM+17                                                  01105000
STDT     EQU   PARM+23                                                  01106000
STDATE   EQU   STDT                                                     01107000
PSTD     EQU   STDATE+1                                                 01108000
ENDDT    EQU   PARM+31                                                  01109000
ENDDATE  EQU   ENDDT                                                    01110000
PEND     EQU   ENDDATE+1                                                01111000
STTIME1  EQU   PARM+39                                                  01112000
ENDTIME1 EQU   PARM+43                                                  01113000
STTIME2  EQU   PARM+47                                                  01114000
ENDTIME2 EQU   PARM+51                                                  01115000
STRTDATE EQU   PARM+55                                                  01116000
RDTHRSH  EQU   PARM+66                                                  01117000
@NM00006 EQU   PARM+72                                                  01118000
@NM00007 EQU   PARM+75                                                  01119000
ERRID    EQU   PARM+92                                                  01120000
IDTIMEA  EQU   ERRID+6                                                  01121000
IDTIME   EQU   IDTIMEA                                                  01122000
CCHHRLNG EQU   PARM+112                                                 01123000
RECLNGTH EQU   CCHHRLNG+6                                               01124000
ADIOHND  EQU   PARM+124                                                 01125000
ADIFCMSG EQU   PARM+128                                                 01126000
ADEDITB  EQU   PARM+132                                                 01127000
EVPTR    EQU   PARM+136                                                 01128000
SORTADR  EQU   PARM+140                                                 01129000
CUAPTR   EQU   PARM+152                                                 01130000
DEVPTR   EQU   PARM+156                                                 01131000
MODPTR   EQU   PARM+160                                                 01132000
SERPTR   EQU   PARM+164                                                 01133000
VOLPTR   EQU   PARM+168                                                 01134000
CPUPTR   EQU   PARM+172                                                 01135000
CPCUAPTR EQU   PARM+176                                                 01136000
LIBADPTR EQU   PARM+180                                                 01137000
SYMCDPTR EQU   PARM+184                                                 01138000
SYSUMPTR EQU   PARM+188                                                 01139000
TRENPTR  EQU   PARM+192                                                 01140000
SHAREPTR EQU   PARM+196                                                 01141000
MERDCPTR EQU   PARM+208                                                 01142000
DUMPTABL EQU   PARM+228                                                 01143000
DUMPNUM  EQU   DUMPTABL                                                 01144000
DUMPINFO EQU   DUMPTABL+4                                               01145000
DUMPADR  EQU   DUMPINFO                                                 01146000
DUMPSIZE EQU   DUMPINFO+4                                               01147000
TRENDONE EQU   0                                                        01148000
TREGEN   EQU   TRENDONE+8                                               01149000
TRECCH0  EQU   TREGEN+8                                                 01150000
TREND2   EQU   0                                                        01151000
TRENDKEY EQU   TREND2                                                   01152000
TRENDRT  EQU   TRENDKEY+1                                               01153000
TRENCPUS EQU   TRENDKEY+3                                               01154000
TRENDITM EQU   TRENDKEY+4                                               01155000
EVTABLE  EQU   0                                                        01156000
EVSTOP   EQU   EVTABLE                                                  01157000
EVKEY    EQU   EVTABLE+6                                                01158000
SORTABLE EQU   0                                                        01159000
SORTKEY  EQU   SORTABLE                                                 01160000
SORTCCHR EQU   SORTABLE+5                                               01161000
SYSUMONE EQU   0                                                        01162000
SYSUM2   EQU   0                                                        01163000
SYSUMKEY EQU   SYSUM2                                                   01164000
SYSRT    EQU   SYSUMKEY+1                                               01165000
SYSCPUS  EQU   SYSUMKEY+3                                               01166000
SYSITEM  EQU   SYSUMKEY+4                                               01167000
SHARE    EQU   0                                                        01168000
SHARENUM EQU   SHARE                                                    01169000
SHAREIO  EQU   SHARE+2                                                  01170000
SHAREFLG EQU   SHAREIO                                                  01171000
SHRBASE  EQU   SHAREIO+1                                                01172000
SHARSERB EQU   SHRBASE                                                  01173000
SHRCUABL EQU   SHRBASE+3                                                01174000
SHRCUCPU EQU   SHAREIO+8                                                01175000
SHARSERA EQU   SHRCUCPU                                                 01176000
SHRCUAAL EQU   SHRCUCPU+3                                               01177000
SHRCUAAH EQU   SHRCUCPU+5                                               01178000
EDITLOAD EQU   0                                                        01179000
EDITABLE EQU   EDITLOAD+4                                               01180000
CUA      EQU   0                                                        01181000
CUAVAL   EQU   CUA+2                                                    01182000
DEVICE   EQU   0                                                        01183000
MODELS   EQU   0                                                        01184000
DEVSERAL EQU   0                                                        01185000
VOLUME   EQU   0                                                        01186000
CPUS     EQU   0                                                        01187000
CPUCUAS  EQU   0                                                        01188000
CPUCUAV  EQU   CPUCUAS+2                                                01189000
LIBADR   EQU   0                                                        01190000
SYMCODE  EQU   0                                                        01191000
SYMVAL   EQU   SYMCODE+2                                                01192000
MERIDIAN EQU   0                                                        01193000
SPECIAL  EQU   0                                                        01194000
SUMMARY  EQU   0                                                        01195000
FSCCODE  EQU   0                                                        01196000
FSCCODE1 EQU   0                                                        01197000
FSCCODE2 EQU   0                                                        01198000
BYT2BIT3 EQU   0                                                        01199000
BYTE0304 EQU   0                                                        01200000
BYTE0809 EQU   0                                                        01201000
NEWTABLE EQU   0                                                        01202000
CLEAR    EQU   NEWTABLE                                                 01203000
CUAGP    EQU   CLEAR                                                    01204000
CUA3     EQU   CUAGP                                                    01205000
GROUP    EQU   CUAGP+2                                                  01206000
SWTCH    EQU   CUAGP+3                                                  01207000
EVD      EQU   SWTCH                                                    01208000
ISSHARED EQU   SWTCH                                                    01209000
EQUAL    EQU   SWTCH                                                    01210000
FORMAT4  EQU   SWTCH                                                    01211000
FSCTAB   EQU   CLEAR+4                                                  01212000
SMCOUNTS EQU   0                                                        01213000
EDTABPTR EQU   SMCOUNTS                                                 01214000
FWARDPTR EQU   SMCOUNTS+4                                               01215000
SCCOUNT  EQU   SMCOUNTS+8                                               01216000
RECORDID EQU   SMCOUNTS+10                                              01217000
SMCWITCH EQU   SMCOUNTS+20                                              01218000
SMCTCAM  EQU   SMCWITCH                                                 01219000
SCCOUNTR EQU   SMCOUNTS+22                                              01220000
@NM00015 EQU   0                                                        01221000
SMTERMNL EQU   @NM00015+22                                              01222000
@NM00017 EQU   0                                                        01223000
SMVARID  EQU   @NM00017+22                                              01224000
SMTRECID EQU   SMVARID                                                  01225000
SMTTYPID EQU   SMVARID+1                                                01226000
SMTTYP0  EQU   SMVARID+3                                                01227000
SMLOGREC EQU   0                                                        01228000
@NM00019 EQU   SMLOGREC                                                 01229000
LRTTYP   EQU   @NM00019                                                 01230000
LRSWITCH EQU   @NM00019+2                                               01231000
LRSWCH2  EQU   LRSWITCH+1                                               01232000
SHRTSW   EQU   LRSWCH2                                                  01233000
LRDISMNT EQU   LRSWCH2                                                  01234000
LRTRECID EQU   SMLOGREC+4                                               01235000
@NM00024 EQU   SMLOGREC+5                                               01236000
LRVARIDF EQU   @NM00024                                                 01237000
LRVARIDS EQU   LRVARIDF                                                 01238000
LRCPUNOS EQU   SMLOGREC+17                                              01239000
LRTMCUA  EQU   SMLOGREC+24                                              01240000
LRVARID  EQU   SMLOGREC+26                                              01241000
LRTTYPID EQU   LRVARID                                                  01242000
LRTSCUA  EQU   LRVARID+4                                                01243000
LRDEVTYP EQU   SMLOGREC+54                                              01244000
LRTCUA   EQU   SMLOGREC+58                                              01245000
LRTCAMID EQU   SMLOGREC+70                                              01246000
LRTERMNL EQU   SMLOGREC+72                                              01247000
SMACCTAB EQU   0                                                        01248000
SMSUMTAB EQU   0                                                        01249000
STHEADER EQU   SMSUMTAB                                                 01250000
CONTRPTR EQU   STHEADER                                                 01251000
SMTABELM EQU   STHEADER+8                                               01252000
SCNTSIZE EQU   STHEADER+12                                              01253000
STCNTROL EQU   0                                                        01254000
STFLAG   EQU   STCNTROL                                                 01255000
SUMFLAG  EQU   STFLAG                                                   01256000
STMASK   EQU   STCNTROL+1                                               01257000
LROFFSET EQU   STCNTROL+2                                               01258000
STSPCPTR EQU   LROFFSET                                                 01259000
SCOFFSET EQU   STCNTROL+4                                               01260000
IFCMSG   EQU   0                                                        01261000
IOHND    EQU   0                                                        01262000
TRECCH   EQU   TRECCH0                                                  01263000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01264000
@NM00031 EQU   STHEADER+4                                               01265000
@NM00030 EQU   SMLOGREC+71                                              01266000
@NM00029 EQU   SMLOGREC+60                                              01267000
@NM00028 EQU   SMLOGREC+56                                              01268000
@NM00027 EQU   SMLOGREC+42                                              01269000
@NM00026 EQU   LRVARID+2                                                01270000
@NM00025 EQU   SMLOGREC+22                                              01271000
@NM00023 EQU   LRSWCH2                                                  01272000
@NM00022 EQU   LRSWCH2                                                  01273000
@NM00021 EQU   LRSWITCH                                                 01274000
@NM00020 EQU   @NM00019+1                                               01275000
@NM00018 EQU   @NM00017                                                 01276000
@NM00016 EQU   @NM00015                                                 01277000
@NM00014 EQU   SMCWITCH                                                 01278000
@NM00013 EQU   NEWTABLE+6                                               01279000
MODEL    EQU   MERIDIAN+2                                               01280000
MRDNUMBR EQU   MERIDIAN                                                 01281000
SYMVAL2  EQU   SYMVAL+2                                                 01282000
SYMVAL1  EQU   SYMVAL                                                   01283000
SYMCDNUM EQU   SYMCODE                                                  01284000
LIBVAL   EQU   LIBADR+2                                                 01285000
LIBADNUM EQU   LIBADR                                                   01286000
CPUCUX3  EQU   CPUCUAV+5                                                01287000
CPUCUX2  EQU   CPUCUAV+3                                                01288000
CPUCUX1  EQU   CPUCUAV                                                  01289000
CPCUANUM EQU   CPUCUAS                                                  01290000
CPUVAL   EQU   CPUS+2                                                   01291000
CPUNUM   EQU   CPUS                                                     01292000
VOLVAL   EQU   VOLUME+2                                                 01293000
VOLNUM   EQU   VOLUME                                                   01294000
SERVAL   EQU   DEVSERAL+2                                               01295000
SERNUM   EQU   DEVSERAL                                                 01296000
MODVAL   EQU   MODELS+2                                                 01297000
MODNUM   EQU   MODELS                                                   01298000
MDRVAL   EQU   DEVICE+204                                               01299000
MDRNUM   EQU   DEVICE+202                                               01300000
DEVVAL   EQU   DEVICE+2                                                 01301000
DEVNUM   EQU   DEVICE                                                   01302000
CUA2     EQU   CUAVAL+2                                                 01303000
CUA1     EQU   CUAVAL                                                   01304000
CUANUM   EQU   CUA                                                      01305000
LOADPTR  EQU   EDITABLE+8                                               01306000
LOADNAME EQU   EDITABLE                                                 01307000
EDITNUM  EQU   EDITLOAD                                                 01308000
SHARLET  EQU   SHAREIO+15                                               01309000
SHRCUABH EQU   SHRBASE+5                                                01310000
SYSTEMP  EQU   SYSUM2+10                                                01311000
SYSPERM  EQU   SYSUM2+8                                                 01312000
SYSRANGE EQU   SYSUM2+7                                                 01313000
SYSDEV   EQU   SYSUM2+5                                                 01314000
SYSOLDA  EQU   SYSITEM                                                  01315000
SYS3705  EQU   SYSITEM                                                  01316000
SYSOLD   EQU   SYSCPUS                                                  01317000
SYSCPU   EQU   SYSCPUS                                                  01318000
SYSTROLL EQU   SYSRT+1                                                  01319000
SYSSPAN  EQU   SYSRT+1                                                  01320000
SYSCUA   EQU   SYSRT                                                    01321000
SYSGROUP EQU   SYSUMKEY                                                 01322000
SYSUMEOD EQU   SYSUMONE+96                                              01323000
SYSUMPER EQU   SYSUMONE+92                                              01324000
SYSUMPEA EQU   SYSUMONE+88                                              01325000
SYSUMPEI EQU   SYSUMONE+84                                              01326000
SYSUMCH  EQU   SYSUMONE+20                                              01327000
SYSUMMCN EQU   SYSUMONE+16                                              01328000
SYSUMMCR EQU   SYSUMONE+12                                              01329000
SYSUMNXT EQU   SYSUMONE+8                                               01330000
SYSUMIPL EQU   SYSUMONE+4                                               01331000
SYSUMNUM EQU   SYSUMONE                                                 01332000
SORTCORE EQU   SORTCCHR                                                 01333000
SORTTIME EQU   SORTKEY+1                                                01334000
SORTYEAR EQU   SORTKEY                                                  01335000
EVLETTER EQU   EVKEY+5                                                  01336000
EVSERIAL EQU   EVKEY+2                                                  01337000
EVMODEL  EQU   EVKEY                                                    01338000
EVNUM    EQU   EVTABLE+4                                                01339000
EVDAY    EQU   EVSTOP+1                                                 01340000
EVYEAR   EQU   EVSTOP                                                   01341000
TRETMP   EQU   TREND2+10                                                01342000
TREPRM   EQU   TREND2+8                                                 01343000
TRENDDEV EQU   TREND2+6                                                 01344000
TRENDDAT EQU   TRENDKEY+5                                               01345000
TRENDOD  EQU   TRENDITM                                                 01346000
TREND037 EQU   TRENDITM                                                 01347000
TRENDOLD EQU   TRENCPUS                                                 01348000
TRENDCPU EQU   TRENCPUS                                                 01349000
@NM00011 EQU   TRENDRT+1                                                01350000
TRENDCUA EQU   TRENDRT                                                  01351000
TRENDGRP EQU   TRENDKEY                                                 01352000
TREPRE   EQU   TREGEN+72                                                01353000
TRECCHF  EQU   TREGEN+68                                                01354000
TRECCHE  EQU   TREGEN+64                                                01355000
TRECCHD  EQU   TREGEN+60                                                01356000
TRECCHC  EQU   TREGEN+56                                                01357000
TRECCHB  EQU   TREGEN+52                                                01358000
TRECCHA  EQU   TREGEN+48                                                01359000
TRECCH9  EQU   TREGEN+44                                                01360000
TRECCH8  EQU   TREGEN+40                                                01361000
TRECCH7  EQU   TREGEN+36                                                01362000
TRECCH6  EQU   TREGEN+32                                                01363000
TRECCH5  EQU   TREGEN+28                                                01364000
TRECCH4  EQU   TREGEN+24                                                01365000
TRECCH3  EQU   TREGEN+20                                                01366000
TRECCH2  EQU   TREGEN+16                                                01367000
TRECCH1  EQU   TREGEN+12                                                01368000
TREMCH   EQU   TREGEN+4                                                 01369000
TREIPL   EQU   TREGEN                                                   01370000
TRENUM   EQU   TRENDONE+4                                               01371000
TRENEXT  EQU   TRENDONE                                                 01372000
@NM00010 EQU   PARM+212                                                 01373000
RECLNGT1 EQU   PARM+204                                                 01374000
FRAMEPTR EQU   PARM+200                                                 01375000
PRINTADR EQU   PARM+148                                                 01376000
ADCPUT   EQU   PARM+144                                                 01377000
LINECT   EQU   PARM+120                                                 01378000
@NM00009 EQU   CCHHRLNG+5                                               01379000
RECCCHHR EQU   CCHHRLNG                                                 01380000
USERPGM  EQU   PARM+102                                                 01381000
IDTSEC   EQU   IDTIME+3                                                 01382000
IDSEC    EQU   IDTIME+2                                                 01383000
IDMIN    EQU   IDTIME+1                                                 01384000
IDHOUR   EQU   IDTIME                                                   01385000
IDASID   EQU   ERRID+4                                                  01386000
IDCPU    EQU   ERRID+3                                                  01387000
@NM00008 EQU   ERRID+2                                                  01388000
IDVALUE  EQU   ERRID                                                    01389000
NUMDAYS  EQU   PARM+88                                                  01390000
SORTNUM  EQU   PARM+84                                                  01391000
TABSIZE  EQU   PARM+80                                                  01392000
SYSRETRN EQU   @NM00007                                                 01393000
NUMIN222 EQU   @NM00006                                                 01394000
WRTHRSH  EQU   PARM+69                                                  01395000
TERM     EQU   PARM+58                                                  01396000
EVSDAY   EQU   STRTDATE+1                                               01397000
EVSYEAR  EQU   STRTDATE                                                 01398000
PENSEC2  EQU   ENDTIME2+2                                               01399000
PENMIN2  EQU   ENDTIME2+1                                               01400000
PENHOUR2 EQU   ENDTIME2                                                 01401000
PSTSEC2  EQU   STTIME2+2                                                01402000
PSTMIN2  EQU   STTIME2+1                                                01403000
PSTHOUR2 EQU   STTIME2                                                  01404000
PENSEC1  EQU   ENDTIME1+2                                               01405000
PENMIN1  EQU   ENDTIME1+1                                               01406000
PENHOUR1 EQU   ENDTIME1                                                 01407000
PSTSEC1  EQU   STTIME1+2                                                01408000
PSTMIN1  EQU   STTIME1+1                                                01409000
PSTHOUR1 EQU   STTIME1                                                  01410000
@NM00005 EQU   ENDDT+4                                                  01411000
PENDY    EQU   PEND+1                                                   01412000
PENYR    EQU   PEND                                                     01413000
@NM00004 EQU   ENDDATE                                                  01414000
@NM00003 EQU   STDT+4                                                   01415000
PSTDY    EQU   PSTD+1                                                   01416000
PSTYR    EQU   PSTD                                                     01417000
@NM00002 EQU   STDATE                                                   01418000
YEARNOW  EQU   DATENOW+4                                                01419000
@NM00001 EQU   DATENOW+3                                                01420000
DAYNOW   EQU   DATENOW                                                  01421000
CSNAP    EQU   CLOSEIO                                                  01422000
CDRCTWRK EQU   CLOSEIO                                                  01423000
CSYSIN   EQU   CLOSEIO                                                  01424000
CACCDEV  EQU   CLOSEIO                                                  01425000
CACCIN   EQU   CLOSEIO                                                  01426000
CSERLOG  EQU   CLOSEIO                                                  01427000
CEREPPT  EQU   CLOSEIO                                                  01428000
CTOURIST EQU   CLOSEIO                                                  01429000
OSNAP    EQU   OPENIO                                                   01430000
ODRCTWRK EQU   OPENIO                                                   01431000
OSYSIN   EQU   OPENIO                                                   01432000
OACCDEV  EQU   OPENIO                                                   01433000
OACCIN   EQU   OPENIO                                                   01434000
OSERLOG  EQU   OPENIO                                                   01435000
OEREPPT  EQU   OPENIO                                                   01436000
OTOURIST EQU   OPENIO                                                   01437000
PASSFLAG EQU   MISC                                                     01438000
PLOGREC  EQU   MISC                                                     01439000
ERRORID  EQU   MISC                                                     01440000
PSUM     EQU   PRINTES                                                  01441000
PEDIT    EQU   PRINTES                                                  01442000
PHIST    EQU   MISC                                                     01443000
PACC     EQU   MISC                                                     01444000
PZERO    EQU   MISC                                                     01445000
DEBUG63  EQU   DEBUGA+3                                                 01446000
DEBUG62  EQU   DEBUGA+3                                                 01447000
DEBUG61  EQU   DEBUGA+3                                                 01448000
DEBUG60  EQU   DEBUGA+3                                                 01449000
DEBUG59  EQU   DEBUGA+3                                                 01450000
DEBUG58  EQU   DEBUGA+3                                                 01451000
DEBUG57  EQU   DEBUGA+3                                                 01452000
DEBUG56  EQU   DEBUGA+3                                                 01453000
DEBUG55  EQU   DEBUGA+2                                                 01454000
DEBUG54  EQU   DEBUGA+2                                                 01455000
DEBUG53  EQU   DEBUGA+2                                                 01456000
DEBUG52  EQU   DEBUGA+2                                                 01457000
DEBUG51  EQU   DEBUGA+2                                                 01458000
DEBUG50  EQU   DEBUGA+2                                                 01459000
DEBUG49  EQU   DEBUGA+2                                                 01460000
DEBUG48  EQU   DEBUGA+2                                                 01461000
DEBUG47  EQU   DEBUGA+1                                                 01462000
DEBUG46  EQU   DEBUGA+1                                                 01463000
DEBUG45  EQU   DEBUGA+1                                                 01464000
DEBUG44  EQU   DEBUGA+1                                                 01465000
DEBUG43  EQU   DEBUGA+1                                                 01466000
DEBUG42  EQU   DEBUGA+1                                                 01467000
DEBUG41  EQU   DEBUGA+1                                                 01468000
DEBUG40  EQU   DEBUGA+1                                                 01469000
DEBUG39  EQU   DEBUGA                                                   01470000
DEBUG38  EQU   DEBUGA                                                   01471000
DEBUG37  EQU   DEBUGA                                                   01472000
DEBUG36  EQU   DEBUGA                                                   01473000
DEBUG35  EQU   DEBUGA                                                   01474000
DEBUG34  EQU   DEBUGA                                                   01475000
DEBUG33  EQU   DEBUGA                                                   01476000
DEBUG32  EQU   DEBUGA                                                   01477000
DEBUG31  EQU   DEBUG+3                                                  01478000
DEBUG30  EQU   DEBUG+3                                                  01479000
DEBUG29  EQU   DEBUG+3                                                  01480000
DEBUG28  EQU   DEBUG+3                                                  01481000
DEBUG27  EQU   DEBUG+3                                                  01482000
DEBUG26  EQU   DEBUG+3                                                  01483000
DEBUG25  EQU   DEBUG+3                                                  01484000
DEBUG24  EQU   DEBUG+3                                                  01485000
DEBUG23  EQU   DEBUG+2                                                  01486000
DEBUG22  EQU   DEBUG+2                                                  01487000
DEBUG21  EQU   DEBUG+2                                                  01488000
DEBUG20  EQU   DEBUG+2                                                  01489000
DEBUG19  EQU   DEBUG+2                                                  01490000
DEBUG18  EQU   DEBUG+2                                                  01491000
DEBUG17  EQU   DEBUG+2                                                  01492000
DEBUG16  EQU   DEBUG+2                                                  01493000
DEBUG15  EQU   DEBUG+1                                                  01494000
DEBUG13  EQU   DEBUG+1                                                  01495000
DEBUG12  EQU   DEBUG+1                                                  01496000
DEBUG11  EQU   DEBUG+1                                                  01497000
DEBUG10  EQU   DEBUG+1                                                  01498000
DEBUG9   EQU   DEBUG+1                                                  01499000
DEBUG8   EQU   DEBUG+1                                                  01500000
DEBUG7   EQU   DEBUG                                                    01501000
DEBUG6   EQU   DEBUG                                                    01502000
DEBUG5   EQU   DEBUG                                                    01503000
DEBUG4   EQU   DEBUG                                                    01504000
DEBUG3   EQU   DEBUG                                                    01505000
DEBUG2   EQU   DEBUG                                                    01506000
DEBUG1   EQU   DEBUG                                                    01507000
DEBUG0   EQU   DEBUG                                                    01508000
SORTBRK  EQU   SWITCHES+1                                               01509000
COREFAIL EQU   SWITCHES+1                                               01510000
SHIFT3RD EQU   SWITCHES+1                                               01511000
DEVEXCL  EQU   SWITCHES+1                                               01512000
ZEROALL  EQU   SWITCHES+1                                               01513000
NOTALL   EQU   SWITCHES+1                                               01514000
NOSDR    EQU   SWITCHES                                                 01515000
TIMESEQ  EQU   SWITCHES                                                 01516000
SYSUM    EQU   SWITCHES                                                 01517000
PARMTHR  EQU   SWITCHES                                                 01518000
TREND    EQU   SWITCHES                                                 01519000
SHORTOBR EQU   SWITCHES                                                 01520000
PARMMES  EQU   SWITCHES                                                 01521000
RDESUM   EQU   SWITCHES                                                 01522000
PCCHFRAM EQU   RECTYPE+1                                                01523000
PMCHFRAM EQU   RECTYPE+1                                                01524000
PTTYP    EQU   RECTYPE+1                                                01525000
PEOD     EQU   RECTYPE                                                  01526000
PMIH     EQU   RECTYPE                                                  01527000
PDDR     EQU   RECTYPE                                                  01528000
PIPL     EQU   RECTYPE                                                  01529000
PSOFT    EQU   RECTYPE                                                  01530000
POBR     EQU   RECTYPE                                                  01531000
PCHAN    EQU   RECTYPE                                                  01532000
PMCH     EQU   RECTYPE                                                  01533000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01534000
@RC00105 EQU   @RC00104                                                 01535000
@RC00163 EQU   @RC00144                                                 01536000
@RC00156 EQU   @RC00144                                                 01537000
@RC00154 EQU   @RC00144                                                 01538000
@RC00146 EQU   @RC00144                                                 01539000
@RC00181 EQU   @RC00174                                                 01540000
@RC00270 EQU   @RC00256                                                 01541000
@RC00268 EQU   @RC00256                                                 01542000
@RC00262 EQU   @RC00256                                                 01543000
@RC00260 EQU   @RC00256                                                 01544000
@RC00258 EQU   @RC00256                                                 01545000
@RF00248 EQU   @RC00246                                                 01546000
@RF00284 EQU   @RC00246                                                 01547000
@RF00298 EQU   @RC00295                                                 01548000
@RC00148 EQU   @RC00146                                                 01549000
@RC00159 EQU   @RC00156                                                 01550000
@RC00164 EQU   @RC00163                                                 01551000
@RC00149 EQU   @RC00148                                                 01552000
@ENDDATA EQU   *                                                        01553000
         END   IFCESUMS                                                 01554000
