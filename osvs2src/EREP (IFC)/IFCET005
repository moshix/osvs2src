      TITLE   'IFCET005 27RN SUPPORT THIS IS CONTROL MOD'               00050002
         GBLC  &CSECT,&DSECT                                            29400002
IFCET005 CSECT                                                          29450002
&CSECT   SETC  'IFCET005'                                               29500002
&DSECT   SETC  'C3705'                                                  29550002
C3705    DSECT                                                          29600002
         DS    0F                                                       29650002
*                                                                       29700002
         DSGEN (RECT,8),(OPSYS,8),(SWITCH,24),(RCDID,8),(SPARE1,16)     29750002
         DSGEN (DATE,32),(TIME,32)                                      29800002
         DSGEN (SPARE2,8),(CPUSER,24),(MODEL,16),(SPARE3,16)            29850002
         DSGEN (CUA,16),(TERMN1,16),(TERMN2,32)                         29900002
         DSGEN (TERMN3,16),(RESID,16),(LINEADD,16),(RECMD,8),(RECID,8)  29950002
         DSGEN (ISBOX,8),(BTUMOD,8),(REG100,1),(REG101,1),(REG102,1),  C30000002
               (REG103,1),(REG104,1),(REG105,1),(REG106,1),(REG107,1), C30050002
               (REG108,1),(REG109,1),(REG110,1),(REG111,1),(REG112,1), C30100002
               (REG113,1),(REG114,1),(REG115,1),(REG200,1),(REG201,1), C30150002
               (REG202,1),(REG203,1),(REG204,1),(REG205,1),(REG206,1), C30200002
               (REG207,1),(REG208,1),(REG209,1),(REG210,1),(REG211,1), C30250002
               (REG212,1),(REG213,1),(REG214,1),(REG215,1),(REG300,1), C30300002
               (REG301,1),(REG302,1),(REG303,1),(REG304,1),(REG305,1), C30350002
               (REG306,1),(REG307,1),(REG308,1),(REG309,1),(REG310,1), C30400002
               (REG311,1),(REG312,1),(REG313,1),(REG314,1),(REG315,1)   30450002
         DSGEN (REG400,1),(REG401,1),(REG402,1),(REG403,1),(REG404,1), C30500002
               (REG405,1),(REG406,1),(REG407,1),(REG408,1),(REG409,1), C30550002
               (REG410,1),(REG411,1),(REG412,1),(REG413,1),(REG414,1), C30600002
               (REG415,1),(REG500,1),(REG501,1),(REG502,1),(REG503,1), C30650002
               (REG504,1),(REG505,1),(REG506,1),(REG507,1),(REG508,1), C30700002
               (REG509,1),(REG510,1),(REG511,1),(REG512,1),(REG513,1), C30750002
               (REG514,1),(REG515,1)                                    30800002
         DSGEN (REG600,1),(REG601,1),(REG602,1),(REG603,1),(REG604,1), C30850002
               (REG605,1),(REG606,1),(REG607,1),(REG608,1),(REG609,1), C30900002
               (REG610,1),(REG611,1),(REG612,1),(REG613,1),(REG614,1), C30950002
               (REG615,1),(REG700,1),(REG701,1),(REG702,1),(REG703,1), C31000002
               (REG704,1),(REG705,1),(REG706,1),(REG707,1),(REG708,1), C31050002
               (REG709,1),(REG710,1),(REG711,1),(REG712,1),(REG713,1), C31100002
               (REG714,1),(REG715,1)                                    31150002
         DSGEN (REG800,1),(REG801,1),(REG802,1),(REG803,1),(REG804,1), C31200002
               (REG805,1),(REG806,1),(REG807,1),(REG808,1),(REG809,1), C31250002
               (REG810,1),(REG811,1),(REG812,1),(REG813,1),(REG814,1), C31300002
               (REG815,1),(REG900,1),(REG901,1),(REG902,1),(REG903,1), C31350002
               (REG904,1),(REG905,1),(REG906,1),(REG907,1),(REG908,1), C31400002
               (REG909,1),(REG910,1),(REG911,1),(REG912,1),(REG913,1), C31450002
               (REG914,1),(REG915,1)                                    31500002
*                                                                       31550002
IFCET005 CSECT                                                          31600002
         USING *,R9                                                     31650002
         USING C3705,R2                                                 31700002
*                                                                       31750002
L0       EQU   0                                                        31800002
L1       EQU   1                                                        31850002
L2       EQU   2                                                        31900002
L3       EQU   3                                                        31950002
L4       EQU   4                                                        32000002
L5       EQU   5                                                        32050002
L6       EQU   6                                                        32100002
L7       EQU   7                                                        32150002
L8       EQU   8                                                        32200002
L9       EQU   9                                                        32250002
L10      EQU   10                                                       32300002
L11      EQU   11                                                       32350002
L12      EQU   12                                                       32400002
L13      EQU   13                                                       32450002
L14      EQU   14                                                       32500002
L15      EQU   15                                                       32550002
L29      EQU   29                                                       32600002
L36      EQU   36                                                       32650002
L46      EQU   46                                                       32700002
*                                                                       32750002
R0       EQU   0                                                        32800002
R1       EQU   1                                                        32850002
R2       EQU   2                                                        32900002
R3       EQU   3                                                        32950002
R4       EQU   4                                                        33000002
R5       EQU   5                                                        33050002
R6       EQU   6                                                        33100002
R7       EQU   7                                                        33150002
R8       EQU   8                                                        33200002
R9       EQU   9                                                        33250002
R10      EQU   10                                                       33300002
R11      EQU   11                                                       33350002
R12      EQU   12                                                       33400002
R13      EQU   13                                                       33450002
R14      EQU   14                                                       33500002
R15      EQU   15                                                       33550002
*                                                                       33600002
H02      EQU   X'02'                                           @YM8390P 33610002
H03      EQU   X'03'                                           @YM8390P 33620002
H10      EQU   X'10'                                                    33650002
H11      EQU   X'11'                                                    33700002
H12      EQU   X'12'                                                    33750002
H13      EQU   X'13'                                                    33800002
H14      EQU   X'14'                                                    33850002
H18      EQU   X'18'                                                    33900002
H40      EQU   X'40'                                                    33950002
*                                                                       34000002
         DC    A(ENTRIES)                                               34050002
         DC    CL8'IFCET005'                                            34100002
XR9PTR   DC    F'0'                                                     34150002
XLABELP  DC    F'0'                                                     34200002
*                                                                       34300000
UNIVERS  DC    C'UNIVERSAL'                                             34500002
SERNO    DC    C'SERIAL NO.'                                            34550002
WORK     DC    D'0'                                                     34600002
NONE     DC    C'NONE'                                                  34650002
         SPACE 2                                                        34700000
TRN0     ETCALL  IFCETRN0                                      @D3502BL 34750000
TRN1     ETCALL  IFCETRN1                                      @D3502BL 34800000
TRN2     ETCALL  IFCETRN2                                      @D3502BL 34850000
TRN3     ETCALL  IFCETRN3                                      @D3502BL 34900000
TRN4     ETCALL  IFCETRN4                                      @D3502BL 34950000
TRN5     ETCALL  IFCETRN5                                      @D3502BL 35000000
TRN6     ETCALL  IFCETRN6                                      @D3502BL 35050000
TRN7     ETCALL  IFCETRN7                                      @D3502BL 35100000
XSAVE    DC    4F'0'                                                    35150000
*                                                                       35200000
*        CHECK FOR CPU AND SERIAL NUMBER                                35250000
*                                                                       35300000
SETCPUNO STM   R5,R8,XSAVE                    SAVE REGISTERS            35350000
         SR    R5,R5                          CLEAR REG 5               35400000
         ICM   R5,H03,MODEL                   PICK UP MODEL NUMBER      35450000
         LTR   R5,R5                   NOW TEST FOR ZEROS               35800002
         LR    R5,R3                   PUT IN LINE ADDRESS THEN TEST CC 35850002
         BNZ   SETSER                  BRANC IF NOT ZEROS               35900002
         LA    R6,L46                  PUT OFFSET IN REGISTER 6         35950002
         SR    R5,R6                   AND SUBTRACT FROM LINE ADDRESS   36000002
         MVC   L0(L29,R5),UNIVERS      PUT IN UNIVERSAL WHEN ZEROS      36050002
         B     RETURN                  RETURN TOMAIN STREAM             36100002
*                                                                       36150002
SETSER   LA    R6,L36                  PUT OFFSET IN REGISTER 6         36200002
         SR    R5,R6                   AND SUBTRACT FROM LINE ADDRESS   36250002
         MVC   L0(L10,R5),SERNO        MOVE IN LABEL                    36300002
         B     RETURN                  RETURN TO MAIN STREAM            36350002
*                                                                       36400002
*        FIND OPERATING SYSTEM AND RELEASE                              36450002
*                                                                       36500002
*                                                                       37450002
*        SET THE DATE READY FOR PRINT                                   37500002
SETDATE  UNPK  XSAVE(L8),L1(L3,R4)     UNPACK THE DATE                  37550002
         MVC   L0(L3,R3),XSAVE+L5      MOVE DAY                         37600002
         MVC   L6(L2,R3),XSAVE+L3      MOVE YEAR                        37650002
         BR    R14                                                      37700002
*                                                                       37750002
*        DETERMINE IF ERROR IS BOX OR LINE ERROR & SELECT MODULE        37800002
*                                                                       37850002
BXOLN    STM   R5,R8,XSAVE                                              37900000
         SR    R5,R5                                                    37930000
         TM    0(R4),X'A0'          TEST FOR MODE X'AX'        @D3502BL 37960000
         BO    NOPRT                YES...HEXDUMP W/OUT ERROR MSG       37990000
         CLI   0(R4),X'84'          MODE X'84'?                @D3502BL 38020000
         BE    NOPRT                NO...CHECK FOR LINE ERROR  @D3502BL 38050000
         TM    L0(R4),H10              TEST FOR LINE ERROR              38080000
         BO    ISITBX                  NO, CK FOR BOX ERROR             38110000
         TM    0(R4),X'08'          THIS BIT BETTER BE OFF     @D3502BL 38140000
         BNZ   RETURN                INVALID                            38170000
         TM    0(R4),X'02'           TYPE 2 OR 3?                       38200000
         BO    CALLTRN5              YES                                38230000
CALLTRN4 LA    R5,TRN4-4             LOAD IFCETRN4                      38260000
         B     STARET                                                   38290000
ISITBX   TM    0(R4),X'0C'           THESE BITS BETTER BE OFF           38320000
         BNZ   RETURN                INVALID                            38350000
         TM    0(R4),X'03'           TYPE 13?                           38380000
         BO    CALLTRN3              YES                                38410000
         BZ    CALLTRN0              TYPE 10...                         38440000
         TM    0(R4),X'02'           TYPE 12?                           38470000
         BO    CALLTRN2              YES                                38500000
CALLTRN1 LA    R5,TRN1-4                                                38530000
         B     STARET                                                   38560000
CALLTRN0 LA    R5,TRN0-4                                                38590000
         B     STARET                                                   38620000
CALLTRN2 LA    R5,TRN2-4                                                38650000
         B     STARET                                                   38680000
CALLTRN3 LA    R5,TRN3-4                                                38710000
         B     STARET                                                   38740000
CALLTRN5 TM    0(R4),X'80'          MODE X'8X'?                @D3502BL 38770000
         BO    CALLTRN6             YES...                     @D3502BL 38800000
         LA    R5,TRN5-4            POINT TO TRN5              @D3502BL 38830000
         B     STARET                                          @D3502BL 38860000
CALLTRN6 TM    0(R4),X'06'          MODE X'86'?                @D3502BL 38890000
         BO    CALLTRN7             YES...                     @D3502BL 38920000
         LA    R5,TRN6-4            POINT TO TRN6              @D3502BL 38950000
         B     STARET                                          @D3502BL 38980000
CALLTRN7 LA    R5,TRN7-4            POINT TO TRN7              @D3502BL 39010000
STARET   ST    R5,XR9PTR            MOVE POINTER               @D3502BL 39040000
NOPRT    XR    R15,R15              DON'T PRINT LINE           @D3502BL 39070000
RETURN   LM    R5,R8,XSAVE                  RESTORE REGS                39100000
         BR    R14                          GO HOME                     39130000
*                                                                       39350002
*        GET TERMINAL NAME                                              39400002
*                                                                       39450002
*                                                                       39600002
*        EDIT ENTRIES                                                   39650002
*                                                                       39700002
ENTRIES  DS    0F                                                       39750002
         DC    XL4'00010001'                                            39800002
         DC    XL4'00010001'                                            39850002
         DC    A(LABELS)               LABEL POINTER                    39900002
         DC    H'0'                                                     39950002
         DC    X'01'                                                    40000002
         DC    X'000B8B00'                                              40050002
*                                                                       40100002
STARTA   LINE  (78,23),(1,35),SKIP=1                                    40150002
         HEX   MODEL,0,2B              GET MODEL NUMBER                 40200002
         HEX   CPUSER,0,3B             GET CPU SERIAL NUMBER            40250002
         ROUTINE   MODEL,SETCPUNO                                       40300002
         LABEL '---RECORD ENTRY TYPE - NCP MDR ','SOURCE - OUTBOARD','M*40350000
               ODEL-'                                                   40400002
*                                                                       40450002
         LINE  (16,38),(4,42)                                           40500002
         SYSRELN  OPSYS,4                                      @D35UGFD 40550000
         LABEL ''                                              @D35UGFD 40570000
*                                                                       40650002
         LINE  ,(27,29)                                                 40700002
         LABEL 'DAY YEAR','HH MM SS.TH'                                 40800002
*                                                                       40850002
         LINE  (27,29),(21,30),SKIP=2                                   40900002
         ROUTINE  DATE,SETDATE                                          40950002
         HEX   TIME,1,4B                                                41000002
         LABEL 'DATE-','TIME'                                           41050002
*                                                                       41100002
         LINE  (23,1),(2,21),SKIP=1                                     41150002
         LABEL 'DEVICE TYPE','3705'                                     41250002
*                                                                       41300002
         LINE  (23,1),(2,1)                                             41350002
         HEX   CUA,0,2B                                                 41400002
         LABEL 'CHANNEL UNIT ADDRESS'                                   41450002
*                                                                       41500002
         LINE  ,,SKIP=2                                                 41550002
         HEX   RESID,0,2B                                               41600002
         LABEL 'RESOURCE I.D.'                                          41650002
*                                                                       41700002
         LINE  (10,1),,SKIP=1                                           41950002
         ROUTINE  RECMD,BXOLN                                           42000002
         LABEL 'CANNOT DETERMINE TYPE OF ERROR RECORD-(005)'            42050002
         DC       X'FF'                                                 42100002
         DC    XL2'0040'                                                42150002
         DC    XL2'0018'                                                42200002
         DC    XL2'0018'                                                42250002
LABELS   DS    0F                                                       42300002
         DC    C'$'                                                     42350002
         LSTART                                                         42400002
         END                                                            42450002
