         TITLE 'IFCETRN0 FOR EREP SUPPORT OF 3705/27RN'                 00100001
*  DSGEN MACRO     DSGEN MACRO     DSGEN MACRO     DSGEN MACRO        * 00200001
         SPACE 2                                                        00300001
*  DSGEN MACRO     DSGEN MACRO     DSGEN MACRO     DSGEN MACRO        * 00400001
         SPACE 2                                                        00500001
         MACRO                                                          00600001
&NAME    DSGEN                                                          00700001
.*                            THIS MACRO GENERATES ONE DSECT WORD       00800001
.*                                 FORMATTED FOR THE SUBJECT LOG RECORD 00900001
.*                                 EACH OPERAND HAS TWO SUB LISTS. THE  01000001
.*                                 FIRST IS THE NAME OF THE LOG ITEM    01100001
.*                                 WHILE THE SECOND IS THE # OF BITS TO 01200001
.*                                 ALLOCATE FOR THIS ITEM. ITEMS MUST   01300001
.*                                 BE DEFINED CONTIGUOUSLY WITHOUT GAPS 01400001
.*                                 UNUSED BIT GROUPS MUST BE GIVEN      01500001
.*                                 DUMMY NAMES. THE NAMES PROVIDED FOR  01600001
.*                                 THE LOG ITEMS MAY THEN BE USED IN    01700001
.*                                 THE CONVERSION MACRO INSTRUCTIONS.   01800001
         GBLC &ITEM(1000)                                               01900001
         GBLA &ITEMNBR,&BITS(1000),&SHIFT(1000)                         02000001
         LCLB  &ONLY1,&CTIND                                            02100001
         LCLA  &START1,&START2,&END1,&END2                              02200001
         LCLC  &SYMBOL,&EQUSYM                                          02300001
         LCLA  &OP,&COUNT,&BYTE,&EQUCNT                                 02400001
         ACTR  100000                                                   02500001
.START   AIF   (N'&SYSLIST(&OP+1) LT 3).LOOP                            02600001
         AIF   ('&SYSLIST(&OP+1,3)' EQ 'EQU').LOOP     TEST FOR EQU     02700001
  AIF   ('&SYSLIST(&OP+1,3)' EQ '' OR '&SYSLIST(&OP+1,4)' EQ '').ERR1   02800001
         AIF   ('&SYSLIST(&OP+1,3)' GT '&SYSLIST(&OP+1,4)').ERR3        02900001
&START1  SETA  &SYSLIST(&OP+1,3)        GET START COUNT OF 1            03000001
&START2  SETA  &SYSLIST(&OP+1,4)        GET FIRST END COUNT             03100001
         AGO   .SET2A                   BRANCH AROUND                   03200001
.ERR1    MNOTE '**FIRST SYMBOL CONCATENATION INCOMPLETE**'              03300001
         MEXIT                                                          03400001
.SET2A   AIF   ('&SYSLIST(&OP+1,5)' EQ ''AND '&SYSLIST(&OP+1,6)' EQ '' X03500001
               ).SET2                   TEST FOR NO SECOND              03600001
  AIF   ('&SYSLIST(&OP+1,5)' EQ '' OR '&SYSLIST(&OP+1,6)' EQ '').ERR2   03700001
         AIF   ('&SYSLIST(&OP+1,5)' GT '&SYSLIST(&OP+1,6)').ERR3        03800001
&END1    SETA  &SYSLIST(&OP+1,5)        GET START COUNT OF 2            03900001
&END2    SETA  &SYSLIST(&OP+1,6)        GET END COUNT OF 2              04000001
         AGO   .LOOP                                                    04100001
.SET2    ANOP                                                           04200001
&ONLY1   SETB  1                        INDICATE ONLY ONE CONCATENATION 04300001
         AGO   .LOOP                                                    04400001
.ERR2    MNOTE '**SECOND SYMBOL CONCATENATION INCOMPLETE**'             04500001
         MEXIT                                                          04600001
.ERR3    MNOTE '**START GREATER THAN END CONCATENATION**'               04700001
         MEXIT                                                          04800001
.LOOP    ANOP                                                           04900001
&OP      SETA  &OP+1                                                    05000001
         AIF   (&OP GT N'&SYSLIST).DONE      TEST IF ALL DONE           05100001
&ITEMNBR SETA  &ITEMNBR+1                                               05200001
         AIF   ('&SYSLIST(&OP,2)' NE '').OK1                            05300001
         MNOTE '**NULL BIT COUNT FIELD**'                               05400001
         MEXIT                                                          05500001
.OK1     ANOP                                                           05600001
&SYMBOL  SETC  '&SYSLIST(&OP,1)'                                        05700001
         AIF   ('&SYMBOL' NE '').OK                                     05800001
*              *****     LOG ITEM SYMBOL NOT PROVIDED     *****         05900001
         AIF   ('&SYSLIST(&OP,3)' NE 'EQU').CNT                         06000001
         AGO   .START                   GET NEXT                        06100001
.OK      AIF   (N'&SYSLIST(&OP) LT 3).NO3    TEST FOR OLD FORMAT        06200001
         AIF   ('&SYSLIST(&OP,3)' EQ 'EQU').EQU   TEST FOR EQU          06300001
         AIF   (&ONLY1).OK2             TEST FOR ONLY ONE CONCAT        06400001
&SYMBOL  SETC  '&SYMBOL.&START1.&END1'       GET 1 AND 2 CONCAT         06500001
         AGO   .NO3                     BRANCH AROUND                   06600001
.OK2     ANOP                                                           06700001
&SYMBOL  SETC  '&SYMBOL.&START1'        GET 1 CONCATENATED              06800001
.NO3     ANOP                                                           06900001
&SYMBOL  EQU   *+&BYTE                                                  07000001
&ITEM(&ITEMNBR) SETC '&SYMBOL'          GET LABEL IN GLOBAL             07100001
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2)                                    07200001
&SHIFT(&ITEMNBR) SETA &COUNT-&BYTE*8                                    07300001
.CNT     ANOP                                                           07400001
&CTIND   SETB  1                        SET COUNT INDICATOR             07500001
&COUNT   SETA  &COUNT+&SYSLIST(&OP,2)                                   07600001
&BYTE    SETA  &COUNT/8                                                 07700001
         AIF   (N'&SYSLIST(&OP) LT 3).START  TEST FOR OLD FORMAT        07800001
         AIF   (&ONLY1).TSTST           TEST FOR ONLY ONE CONCAT        07900001
         AIF   (&END1 EQ &END2).TSTST   TEST FOR SECOND END             08000001
&END1    SETA  &END1+1                  INCREMENT COUNT                 08100001
&OP      SETA  &OP-1                    DECREMENT INCREMENT             08200001
         AGO   .LOOP                    GENERATE NEXT                   08300001
.TSTST   ANOP                                                           08400001
         AIF   (&START1 EQ &START2).LPDONE   TEST FOR END               08500001
         AIF   (&ONLY1).NSET1           TEST FOR ONLY ONE CONCAT        08600001
&END1    SETA  &SYSLIST(&OP,5)          RE-INIT SECOND START COUNT      08700001
.NSET1   ANOP                                                           08800001
&OP      SETA  &OP-1                    DECREMENT INDEX                 08900001
&START1  SETA  &START1+1                INCREMENT FIRST COUNT           09000001
         AGO   .LOOP                    GO DO NEXT                      09100001
.LPDONE  ANOP                                                           09200001
&ONLY1   SETB  0                        CLEAR INDICATOR                 09300001
         AGO   .START                   GO TEST FOR MORE SUB-LISTS      09400001
.DONE    AIF   (&COUNT-&COUNT/8*8 NE 0).ERR  TEST FOR MULTIPLE OF EIGHT 09500001
         AIF   (&CTIND EQ 0).END        NO DS IF NO COUNT               09600001
&COUNT   SETA  &COUNT/8                 GET NUMBER OF BYTES             09700001
&NAME    DS    &COUNT.C                                                 09800001
.END     MEXIT                                                          09900001
.ERR     MNOTE '**BIT COUNT FLDS DO NOT TOTAL MULTIPLE OF 8**'          10000001
         MEXIT                                                          10100001
.EQU     AIF   ('&SYSLIST(&OP,4)' NE '').EQU1     TEST FOR NULL LABEL   10200001
.ERR4    MNOTE '**EQU OPERAND OMITTED OR NOT FOUND**'                   10300001
         MEXIT                                                          10400001
.EQU1    AIF   (&SYSLIST(&OP,2) LT 16).EQU2  COUNT OVER FIFTEEN         10500001
*****               THE FOLLOWING STATEMENT                *****        10600001
*****     NUMBER OF BITS EXCEED 15 - DO NOT USE AS BIN     *****        10700001
.EQU2    ANOP                                                           10800001
&EQUCNT  SETA  0                        CLEAR COUNTER                   10900001
&EQUSYM  SETC  '&SYSLIST(&OP,4)'        GET EQU OPERAND                 11000001
.EQULOP  ANOP                                                           11100001
&EQUCNT  SETA  &EQUCNT+1                INCREMENT INDEX                 11200001
         AIF   ('&ITEM(&EQUCNT)' EQ '&EQUSYM').EQUOUT  LABEL FOUND?     11300001
         AIF   (&EQUCNT EQ &ITEMNBR).ERR4    ALL TESTED?                11400001
         AGO   .EQULOP                  NO-GET NEXT                     11500001
.EQUOUT  ANOP                                                           11600001
&ITEM(&ITEMNBR) SETC '&SYMBOL'          GET LABEL NAME                  11700001
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2)    GET NUMBER OF BITS              11800001
&SHIFT(&ITEMNBR) SETA &SHIFT(&EQUCNT)   GET SHIFT COUNT                 11900001
&SYMBOL  EQU   &EQUSYM                  THIS SYMBOL EQUATED             12000001
         AGO   .START                   RETURN FOR NEXT                 12100001
         MEND                                                           12200001
         EJECT                                                          12300001
         MACRO                                                          12400001
         LINEND                                                         12500001
.*                            THIS MACRO IS USED ONLY BY THE LINE       12600001
.*                                 MACRO TO SET THE NUMBER OF ENTRIES   12700001
.*                                 ASSOCIATED WITH EACH LINE.           12800001
         GBLA  &NRENTS                                                  12900001
         GBLC &NRENTSX                                                  13000001
         AIF   (&NRENTS EQ 0).NORENTS   TEST FOR NO COUNT               13100001
         ORG   &NRENTSX                                                 13200001
         DC    FL1'&NRENTS'                                             13300001
         ORG                                                            13400001
&NRENTS  SETA  0                                                        13500001
.NORENTS ANOP                                                           13600001
B&SYSNDX EQU   *                                                        13700001
&NRENTSX SETC  'B&SYSNDX'                                               13800001
         MEND                                                           13900001
         EJECT                                                          14000001
         MACRO                                                          14100001
         BIN                                                            14200001
.*                                 &SYSLIST(&OP,1) - NAME OF LOG ITEM   14300001
.*                                      RECORD DSECT                    14400001
.*                                 $SYSLIST(&OP,2) - NBR OF SPACES      14500001
.*                                      TO SKIP ON MULTIPLE             14600001
.*                                      PRINT OR NBR OF SPACES          14700001
.*                                      TO BACK UP FROM COLUMN FOR      14800001
.*                                      START OF PRINTING. THE LETTER   14900001
.*                                      B PRECEEDS THE NUMBER (B5) IF   15000001
.*                                      THE LATTER IS DESIRED. OMISSION 15100001
.*                                      OF THIS OPERAND FORCES OPTION 2 15200001
.*                                      WITH BACKUP SPACING EQUAL TO    15300001
.*                                 THE NUMBER OF BITS IN THE ITEM       15400001
.*                                 DEFINITION (VIA MACRO 'DSGEN').      15500001
.*                            A LIMIT OF 15 BITS IS IMPOSED FOR THE     15600001
.*                                 TOTAL NUMBER OF BITS TO PRINT.       15700001
         GBLA  &INITIAL                                                 15800001
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN                               15900001
         GBLC &ITEM(1000)                                               16000001
         GBLA &ITEMNBR,&BITS(1000),&SHIFT(1000),&NRENTS                 16100001
         GBLC  &DSECT                                                   16200001
         LCLB  &B,&SUB                                                  16300001
         LCLA  &IBITS,&NDX,&ISHIFT,&K                                   16400001
         LCLA  &TEMP,&T,&OP                                             16500001
         LCLC  &S                                                       16600001
         AIF   (&DIAGTST EQ 0).NOMSG                                    16700001
         AIF   (&INITIAL EQ 0).NOMSG                                    16800001
         AIF   (&DIAGLIN EQ 1).NOMSG                                    16900001
         MNOTE '**NO LINE ASSOCIATED WITH THIS DATA**'                  17000001
*****THE FOLLOWING GENERATED FOR TEST PURPOSES*****                     17100001
*        LINE                                                           17200001
         LINE                                                           17300001
.NOMSG   ANOP                                                           17400001
         AIF   (K'&SYSLIST(1) EQ K'&SYSLIST(1,1)).LOOP                  17500001
&SUB     SETB  1                                                        17600001
.LOOP    ANOP                                                           17700001
&OP      SETA  &OP+1                                                    17800001
.LOOP1   ANOP                                                           17900001
&NDX     SETA  &NDX+1                                                   18000001
         AIF   ('&ITEM(&NDX)' EQ '&SYSLIST(&OP,1)').FOUND               18100001
         AIF   (&NDX LT &ITEMNBR).LOOP1                                 18200001
         MNOTE '**LOG ITEM NOT DEFINED**'                               18300001
         MEXIT                                                          18400001
.FOUND   ANOP                                                           18500001
&ISHIFT  SETA  &SHIFT(&NDX)                                             18600001
&IBITS   SETA  &BITS(&NDX)                                              18700001
&T       SETA  &IBITS-1                                                 18800001
&B       SETB  0                                                        18900001
         AIF   (&IBITS GT 0 AND &IBITS LT 16).SUB0                      19000001
         MNOTE '**NO. OF BITS OUTSIDE RANGE OF 1-15**'                  19100001
         MEXIT                                                          19200001
.SUB0    AIF   (&SUB EQ 1).SUBA                                         19300001
         AIF   ('&SYSLIST(2)' EQ '').BACKUP                             19400001
&K       SETA  K'&SYSLIST(2)                                            19500001
&B       SETB  ('&SYSLIST(2)'(1,1) EQ 'B')                              19600001
&S       SETC  '&SYSLIST(2)'(&B+1,&K-&B)                                19700001
         AGO   .SUBB                                                    19800001
.SUBA    ANOP                                                           19900001
         AIF   ('&SYSLIST(&OP,2)' EQ '').BACKUP                         20000001
&K       SETA  K'&SYSLIST(&OP,2)                                        20100001
&B       SETB  ('&SYSLIST(&OP,2)'(1,1) EQ 'B')                          20200001
&S       SETC  '&SYSLIST(&OP,2)'(&B+1,&K-&B)                            20300001
.SUBB    ANOP                                                           20400001
&T       SETA  &S                                                       20500001
.BACKUP  ANOP                                                           20600001
&NRENTS  SETA  &NRENTS+1                                                20700001
&TEMP    SETA  &ISHIFT                                                  20800001
         AIF   (&IBITS NE 1 OR &B NE 0).BIN2                            20900001
         DC    AL.12(&SYSLIST(&OP,1)-&DSECT),XL.4'&TEMP'                21000001
         AGO   .OUT                                                     21100001
.BIN2    AIF   ('&SYSLIST(&OP,2)' NE '').BIN3                           21200001
&B       SETB  1                                                        21300001
.BIN3    ANOP                                                           21400001
         DC    AL.12(&SYSLIST(&OP,1)-&DSECT),XL.4'C'                    21500001
         DC    BL.1'&B',AL.7(&T),AL.4(&IBITS),FL.4'&ISHIFT'             21600001
.OUT     ANOP                                                           21700001
&NDX     SETA  0                                                        21800001
         AIF   (&SUB EQ 0).OUTA                                         21900001
         AIF   (&OP LT N'&SYSLIST).LOOP                                 22000001
.OUTA    ANOP                                                           22100001
         MEND                                                           22200001
         EJECT                                                          22300001
         MACRO                                                          22400001
         LSTART                                                         22500001
.*                            THIS MACRO IS ISSUED WHEN THE LABEL AREA  22600001
.*                                 OF THE TABLE IS TO BEGIN.            22700001
         GBLA  &LABELNR                                                 22800001
         GBLC  &LBL(100)                                                22900001
         GBLC &LABELS(2000)                                             23000001
         GBLA  &LBLCTR(100)                                             23100001
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN                               23200001
         LCLA  &NDX,&CTR                                                23300001
         AIF   (&DIAGTST EQ 0).NODIAG                                   23400001
         AIF   (&DIAGSET EQ 0).NODIAG                                   23500001
         MNOTE '**NO LABEL ASSOCIATED WITH LAST SET**'                  23600001
***** THE FOLLOWING GENERATED FOR TEST PURPOSES *****                   23700001
*        LABEL '%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%'       23800001
               LABEL '%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%' 23900001
.NODIAG  ANOP                                                           24000001
         LINEND                                                         24100001
&CTR     SETA  1                                                        24200001
.LOOP    ANOP                                                           24300001
&NDX     SETA  &NDX+1                                                   24400001
         AIF   (&LBLCTR(&CTR) NE &NDX).NOLBL                            24500001
&LBL(&CTR) DC  C'&LABELS(&NDX)'                                         24600001
&CTR     SETA  &CTR+1                                                   24700001
         AGO   .LOOPCTL                                                 24800001
.NOLBL   ANOP                                                           24900001
         DC    C'&LABELS(&NDX)'                                         25000001
.LOOPCTL AIF   (&NDX LT &LABELNR).LOOP                                  25100001
         MEND                                                           25200001
         EJECT                                                          25300001
         MACRO                                                          25400001
&NAME    ROUTINE &LOGITEM,&RNAME                                        25500001
         GBLA  &NRENTS                                                  25600001
         GBLC  &DSECT,&CSECT                                            25700001
         GBLA  &INITIAL                                                 25800001
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN                               25900001
         AIF   (&DIAGTST EQ 0).NOMSG                                    26000001
         AIF   (&INITIAL EQ 0).NOMSG                                    26100001
         AIF   (&DIAGLIN EQ 1).NOMSG                                    26200001
         MNOTE '**NO LINE ASSOCIATED WITH THIS ROUTINE**'               26300001
*****THE FOLLOWING GENERATED FOR TEST PURPOSES*****                     26400001
*        LINE                                                           26500001
         LINE                                                           26600001
.NOMSG   ANOP                                                           26700001
&NAME    DC    AL.12(&LOGITEM-&DSECT),XL.4'D'                           26800001
         DC    AL2(&RNAME-&CSECT)                                       26900001
&NRENTS  SETA  &NRENTS+1                                                27000001
         MEND                                                           27100001
         EJECT                                                          27200001
         MACRO                                                          27300001
&NAME    LINE  &DATA,&LABEL,&SKIP=                                      27400001
.*                            THIS MACRO ESTABLISHES THE MARGINS OR     27500001
.*                                 COLUMN SETTINGS FOR EACH LINE. IT    27600001
.*                                 GENERATES NECESSARY CARRIAGE CONTROL 27700001
.*                                 ENTRIES. LASTLY IT DETERMINES THE    27800001
.*                                 NUMBER OF ENTRIES ASSOCIATED WITH    27900001
.*                                 THE PREVIOUS LINE AND STORES THAT #  28000001
.*                                 INTO THE APPROPRIATE BYTE.           28100001
.*                            &DATA(1) - CHARACTER POSITION TO BEGIN    28200001
.*                                 DATA.                                28300001
.*                            &DATA(2) - # OF SPACES BETWEEN SUCCESSIVE 28400001
.*                                 DATA COLUMN STARTING CHARACTERS.     28500001
.*                            &LABEL(1) - CHAR. POS. TO BEGIN LABELS.   28600001
.*                            &LABEL(2) - # SPACES BETWEEN LINE'S LABEL 28700001
.*                                 STARTING CHARACTERS.                 28800001
.*                            &SKIP= - # OF LINES TO ADVANCE CARRIAGE   28900001
.*                                 TO BEGIN NEXT PRINTED LINE.          29000001
.*                            NEW ENTRIES ARE GENERATED ONLY WHEN       29100001
.*                                 NECESSARY. OMISSION OF ITEMS MEANS   29200001
.*                                 THEY HAVE NOT CHANGED SINCE PREVIOUS 29300001
.*                                 SETTINGS. A LINE MACRO IS REQUIRED   29400001
.*                                 FOR EACH PRINTED LINE. IF NO SETTING 29500001
.*                                 CHANGES ARE REQUIRED ALL OPERANDS    29600001
.*                                 ARE OMITTED IN WHICH CASE ONLY THE   29700001
.*                                 # OF ENTRIES FOR THE PREVIOUS LINE   29800001
.*                                 IS COMPUTED. THIS MACRO MUST BE THE  29900001
.*                                 FIRST MACRO INSTRUCTION ISSUED FOR   30000001
.*                                 THE SUBJECT LINE                     30100001
         GBLA  &DB,&DT,&LB,&LT,&NRENTS                                  30200001
         GBLA  &LASTCC,&INITIAL                                         30300001
         GBLC  &NRENTSX                                                 30400001
         GBLC  &CARRCON                                                 30500001
         GBLB  &TEST                                                    30600001
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN                               30700001
         LCLA  &S                                                       30800001
         AIF   (&INITIAL EQ 0 OR &DIAGTST EQ 0).DIAGSET                 30900001
         AIF   (&DIAGSET EQ 0).DIAGSET                                  31000001
         MNOTE '**NO LABEL ASSOCIATED WITH LAST SET**'                  31100001
***** THE FOLLOWING GENERATED FOR TEST PURPOSES *****                   31200001
*        LABEL '%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%'       31300001
               LABEL '%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%' 31400001
.DIAGSET ANOP                                                           31500001
&DIAGSET SETB  1                                                        31600001
&DIAGLIN SETB  1                                                        31700001
&NAME    DS    0C                                                       31800001
         AIF   (&INITIAL EQ 0).FIRSTLN                                  31900001
         LINEND                                                         32000001
         AGO   .NTFIRST                                                 32100001
.FIRSTLN ANOP                                                           32200001
&NRENTSX SETC  'N&SYSNDX'                                               32300001
&INITIAL SETA  1                                                        32400001
N&SYSNDX EQU   *                                                        32500001
.NTFIRST ANOP                                                           32600001
         DC    AL1(0)                                                   32700001
         AIF   ('&DATA(1)' EQ '').CKDTABS                               32800001
         AIF   (&DATA(1) EQ &DB).CKDTABS                                32900001
&DB      SETA  &DATA(1)                                                 33000001
         AGO   .AA                                                      33100001
.CKDTABS AIF   ('&DATA(2)' EQ '').NCDATA                                33200001
         AIF   (&DATA(2) EQ &DT).NCDATA                                 33300001
         AGO   .CC                                                      33400001
.AA      AIF   ('&DATA(2)' EQ '').BB                                    33500001
         AIF   (&DATA(2) EQ &DT).BB                                     33600001
.CC      ANOP                                                           33700001
&DT      SETA  &DATA(2)                                                 33800001
.BB      DC    XL2'FFFE'                                                33900001
         DC    FL1'&DB'                                                 34000001
         DC    FL1'&DT'                                                 34100001
&NRENTS  SETA  &NRENTS+1                                                34200001
.NCDATA  ANOP                                                           34300001
         AIF   ('&LABEL(1)' EQ '').CKLTABS                              34400001
         AIF   (&LABEL(1) EQ &LB).CKLTABS                               34500001
&LB      SETA  &LABEL(1)                                                34600001
         AGO   .AAA                                                     34700001
.CKLTABS AIF   ('&LABEL(2)' EQ '').NCLABEL                              34800001
         AIF   (&LABEL(2) EQ &LT).NCLABEL                               34900001
         AGO   .CCC                                                     35000001
.AAA     AIF   ('&LABEL(2)' EQ '').BBB                                  35100001
         AIF   (&LABEL(2) EQ &LT).BBB                                   35200001
.CCC     ANOP                                                           35300001
&LT      SETA  &LABEL(2)                                                35400001
.BBB     DC    XL2'FFFF'                                                35500001
         DC    FL1'&LB'                                                 35600001
         DC    FL1'&LT'                                                 35700001
&NRENTS  SETA  &NRENTS+1                                                35800001
.NCLABEL ANOP                                                           35900001
         AIF   ('&SKIP' NE '').CONT                                     36000001
         AIF   (&TEST EQ 0).NOCHANG                                     36100001
         AGO   .DEFALTA                                                 36200001
.CONT    ANOP                                                           36300001
         AIF   (&TEST EQ 0).AB                                          36400001
         AIF   ('&SKIP' EQ 'E').AB                                      36500001
&S       SETA  &SKIP                                                    36600001
.DEFAULT ANOP                                                           36700001
         AIF   (&SKIP EQ &LASTCC).DEFALTA                               36800001
         ORG   &CARRCON+3                                               36900001
         DC    AL.3(0),AL.2(&S),AL.3(1)                                 37000001
         ORG                                                            37100001
&LASTCC  SETA  &S                                                       37200001
.DEFALTA ANOP                                                           37300001
&TEST    SETB  0                                                        37400001
         AGO   .DD                                                      37500001
.AB      AIF   ('&SKIP' NE 'E').ABB                                     37600001
A&SYSNDX DC    X'FFFB8B00'              EJECT                           37700001
         AGO   .ABC                                                     37800001
.ABB     AIF   (&SKIP EQ &LASTCC).NOCHANG                               37900001
A&SYSNDX DC    XL2'FFFB'                                                38000001
         DC    AL.3(0),AL.2(&SKIP),AL.3(1)                              38100001
         DC    AL.3(0),AL.2(&SKIP),AL.3(1)                              38200001
&LASTCC  SETA  &SKIP                                                    38300001
&TEST    SETB  1                                                        38400001
.ABC     ANOP                                                           38500001
&CARRCON SETC  'A&SYSNDX'                                               38600001
&NRENTS  SETA  &NRENTS+1                                                38700001
.DD      ANOP                                                           38800001
.NOCHANG ANOP                                                           38900001
         MEND                                                           39000001
         EJECT                                                          39100001
         MACRO                                                          39200001
         HEX                                                            39300001
.*                            THIS MACRO FACILITATES GENERATION OF THE  39400001
.*                                 TABLE ENTRIES SPECIFYING HEX TYPE    39500001
.*                                 CONVERSIONS.                         39600001
.*                            &SYSLIST(&OP,1) - NAME OF DATA ITEM TO BE 39700001
.*                                 CONVERTED                            39800001
.*                            &SYSLIST(&OP,2) - # OF SPACES TO SKIP ON  39900001
.*                                 MULTIPLE PRINT OR NBR OF SPACES TO   40000001
.*                                 BACK UP FROM COLUMN FOR START OF     40100001
.*                                 PRINTING. THE LETTER B PRECEEDS THE  40200001
.*                                 NUMBER (B8) IF THE LATTER OPTION IS  40300001
.*                                 DESIRED. OMISSION OF THIS OPERAND    40400001
.*                                 FORCES OPTION 2 WITH BACKUP SPACING  40500001
.*                                 EQUAL TO THE NUMBER OF BYTES SPECI-  40600001
.*                                 FIED BY THE NEXT OPERAND (TWICE THIS 40700001
.*                                 NUMBER IF SUFFIX IS EXPLICITLY OR    40800001
.*                                 IMPLICITLY B).                       40900001
.*                            &SYSLIST(&OP,3) - NUMBER OF BYTES TO      41000001
.*                                 PROCESS. THIS NUMBER IS SUFFIXED     41100001
.*                                 WITH AN L,R, OR B TO STIPULATE       41200001
.*                                 PRINTING OF THE LEFT HALF, RIGHT     41300001
.*                                 HALF, OR BOTH HALVES OF THE BYTE     41400001
.*                                 RESPECTIVELY. OMISSION OF THIS       41500001
.*                                 OPERAND DEFAULTS TO B WITH THE NUM-  41600001
.*                                 BER OF BYTES EQUAL TO THE ITEM LNGTH 41700001
.*                            A NEW ENTRY IS GENERATED ONLY WHEN NECES- 41800001
.*                                 SARY. THIS MACRO MUST BE THE FIRST   41900001
.*                                 MACRO INSTRUCTION ISSUED FOR THE     42000001
.*                                 SUBJECT LINE(S).                     42100001
         GBLC &ITEM(1000),&DSECT                                        42200001
         GBLA &ITEMNBR,&BITS(1000),&SHIFT(1000),&NRENTS                 42300001
         GBLA  &INITIAL                                                 42400001
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN                               42500001
         LCLB  &B,&SUB                                                  42600001
         LCLA  &IBITS,&NDX,&ISHIFT,&K,&T,&CODE,&BYTESP,&OP              42700001
         LCLC  &S,&LETTER                                               42800001
         AIF   (&DIAGTST EQ 0).NOMSG                                    42900001
         AIF   (&INITIAL EQ 0).NOMSG                                    43000001
         AIF   (&DIAGLIN EQ 1).NOMSG                                    43100001
         MNOTE '**NO LINE ASSOCIATED WITH THIS DATA**'                  43200001
*****THE FOLLOWING GENERATED FOR TEST PURPOSES*****                     43300001
*        LINE                                                           43400001
         LINE                                                           43500001
.NOMSG   ANOP                                                           43600001
         AIF   (K'&SYSLIST(1) EQ K'&SYSLIST(1,1)).LOOP                  43700001
&SUB     SETB  1                                                        43800001
.LOOP    ANOP                                                           43900001
&OP      SETA  &OP+1                                                    44000001
.LOOP1   ANOP                                                           44100001
&NDX     SETA  &NDX+1                                                   44200001
         AIF   ('&ITEM(&NDX)' EQ '&SYSLIST(&OP,1)').FOUND               44300001
         AIF   (&NDX LT &ITEMNBR).LOOP1                                 44400001
         MNOTE '**LOG ITEM NOT DEFINED**'                               44500001
         MEXIT                                                          44600001
.FOUND   ANOP                                                           44700001
&ISHIFT  SETA  &SHIFT(&NDX)                                             44800001
&IBITS   SETA  &BITS(&NDX)                                              44900001
         AIF   (&ISHIFT EQ 0 OR &ISHIFT EQ 4).ALIGN                     45000001
.ERR     MNOTE '**DATA NOT ALLIGNED ON HEX OR BYTE BOUNDARY**'          45100001
         MEXIT                                                          45200001
.ALIGN   ANOP                                                           45300001
&CODE    SETA  1                                                        45400001
         AIF   (&SUB EQ 1).SUBA                                         45500001
&K       SETA  K'&SYSLIST(3)                                            45600001
         AGO   .SUBB                                                    45700001
.SUBA    ANOP                                                           45800001
&K       SETA  K'&SYSLIST(&OP,3)                                        45900001
.SUBB    ANOP                                                           46000001
         AIF   (&SUB EQ 1).SUBC                                         46100001
         AIF   ('&SYSLIST(3)' EQ '').USEDEFN                            46200001
&LETTER  SETC  '&SYSLIST(3)'(&K,1)                                      46300001
&S       SETC  '&SYSLIST(3)'(1,&K-1)                                    46400001
         AGO   .SUBD                                                    46500001
.SUBC    ANOP                                                           46600001
         AIF   ('&SYSLIST(&OP,3)' EQ '').USEDEFN                        46700001
&LETTER  SETC  '&SYSLIST(&OP,3)'(&K,1)                                  46800001
&S       SETC  '&SYSLIST(&OP,3)'(1,&K-1)                                46900001
.SUBD    ANOP                                                           47000001
&BYTESP  SETA  &S                                                       47100001
         AIF   ('&LETTER' EQ 'B').BOTH                                  47200001
         AIF   ('&LETTER' EQ 'L').LEFT                                  47300001
&CODE    SETA  2                                                        47400001
         AGO   .L                                                       47500001
.LEFT    ANOP                                                           47600001
&CODE    SETA  1                                                        47700001
         AGO   .L                                                       47800001
.USEDEFN ANOP                                                           47900001
         AIF   (&IBITS-(&IBITS/4)*4 EQ 0).OK                            48000001
         MNOTE '**BIT LENGTH SPECIFICATION INCONSISTENT WITH CONTROL**' 48100001
         MEXIT                                                          48200001
.OK      ANOP                                                           48300001
&BYTESP  SETA  &IBITS/8                                                 48400001
.BOTH    AIF   (&ISHIFT NE 0).ERR                                       48500001
&CODE    SETA  3                                                        48600001
&T       SETA  &BYTESP*2-1                                              48700001
&S       SETC  '&T'                                                     48800001
.OK2     AIF   (&ISHIFT EQ 0).L                                         48900001
&CODE    SETA  2                                                        49000001
.L       ANOP                                                           49100001
&B       SETB  1                                                        49200001
         AIF   (&SUB EQ 1).SUBE                                         49300001
         AIF   ('&SYSLIST(2)' EQ '').BACKUP                             49400001
&K       SETA  K'&SYSLIST(2)                                            49500001
&B       SETB  ('&SYSLIST(2)'(1,1) EQ 'B')                              49600001
&S       SETC  '&SYSLIST(2)'(&B+1,&K-&B)                                49700001
         AGO   .SUBF                                                    49800001
.SUBE    ANOP                                                           49900001
         AIF   ('&SYSLIST(&OP,2)' EQ '').BACKUP                         50000001
&K       SETA  K'&SYSLIST(&OP,2)                                        50100001
&B       SETB  ('&SYSLIST(&OP,2)'(1,1) EQ 'B')                          50200001
&S       SETC  '&SYSLIST(&OP,2)'(&B+1,&K-&B)                            50300001
.SUBF    ANOP                                                           50400001
.BACKUP  ANOP                                                           50500001
&NRENTS  SETA  &NRENTS+1                                                50600001
         AIF   (&BYTESP GT 0 AND &BYTESP LT 16).SUB0                    50700001
         MNOTE '**NO. OF BYTES OUTSIDE RANGE OF 1-15**'                 50800001
         MEXIT                                                          50900001
.SUB0    AIF   (&SUB EQ 1).SUBG                                         51000001
         DC    AL.12(&SYSLIST(1)-&DSECT),XL.4'A'                        51100001
         AGO   .SUBH                                                    51200001
.SUBG    ANOP                                                           51300001
         DC    AL.12(&SYSLIST(&OP,1)-&DSECT),XL.4'A'                    51400001
.SUBH    ANOP                                                           51500001
         DC    BL.1'&B',FL.7'&S',AL.4(&BYTESP),FL.4'&CODE'              51600001
.OUT     ANOP                                                           51700001
&NDX     SETA  0                                                        51800001
         AIF   (&SUB EQ 0).OUTA                                         51900001
         AIF   (&OP LT N'&SYSLIST).LOOP                                 52000001
.OUTA    ANOP                                                           52100001
         MEND                                                           52200001
         EJECT                                                          52300001
         MACRO                                                          52400001
&NAME    LABEL &LABEL1,&LABEL2,&LABEL3,&LABEL4,&LABEL5,&LABEL6,        C52500001
               &LABEL7,&LABEL8                                          52600001
.*                                 THIS MACRO ALLOWS LABELS TO          52700001
.*                                 BE SPECIFIED FOR A GIVEN LINE. THE   52800001
.*                                 LABELS SHOULD BE ENCLOSED IN QUOTA-  52900001
.*                                 TION MARKS. THE COLUMN AND LINE END  53000001
.*                                 CONTROLS WILL BE INSERTED BY THE     53100001
.*                                 MACRO. OMITTED OPERANDS MEAN NO      53200001
.*                                 LABEL REQUIRED FOR RESPECTIVE        53300001
.*                                 COLUMN.                              53400001
         GBLC &LABELS(2000)                                             53500001
         GBLC  &LBL(100)                                                53600001
         GBLA  &LBLCTR(100)                                             53700001
         GBLA  &LABELNR                                                 53800001
         GBLA  &NRENTS,&LPTR,&INITIAL                                   53900001
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN                               54000001
         LCLC  &MARGIN,&TACK                                            54100001
         LCLC  &TEXT                                                    54200001
         LCLA  &OP,&K,&START,&NRCHAR,&REMAIN                            54300001
         AIF   (&INITIAL EQ 0).DIAGCLR                                  54400001
         AIF   (&DIAGTST EQ 0).DIAGCLR                                  54500001
         AIF   (&DIAGLIN EQ 1).DIAGCLR                                  54600001
         MNOTE '**NO LINE ASSOCIATED WITH PREVIOUS LABEL**'             54700001
***** THE FOLLOWING GENERATED FOR TEST PURPOSES *****                   54800001
*        LINE                                                           54900001
         LINE                                                           55000001
.DIAGCLR ANOP                                                           55100001
&DIAGSET SETB  0                                                        55200001
&DIAGLIN SETB  0                                                        55300001
&MARGIN  SETC  '*'                                                      55400001
         AIF   ('&NAME' EQ '').LOOPOUT                                  55500001
&LPTR    SETA  &LPTR+1                                                  55600001
&LBL(&LPTR) SETC '&NAME'                                                55700001
&LBLCTR(&LPTR) SETA &LABELNR+1                                          55800001
.LOOPOUT ANOP                                                           55900001
&OP      SETA  &OP+1                                                    56000001
&K       SETA  K'&SYSLIST(&OP)                                          56100001
         AIF (&K GE 2).NORM                                             56200001
&K       SETA  2                                                        56300001
.NORM    ANOP                                                           56400001
&START   SETA  2                                                        56500001
         AIF (&OP LT N'&SYSLIST).NOTLAST                                56600001
&MARGIN  SETC  '$'                                                      56700001
.NOTLAST ANOP                                                           56800001
&NRCHAR  SETA  8                                                        56900001
&TACK    SETC  ''                                                       57000001
.LOOPIN  ANOP                                                           57100001
&REMAIN  SETA  &K-&START                                                57200001
         AIF (&REMAIN GE 8).MORE                                        57300001
&TACK    SETC  '&MARGIN'                                                57400001
&NRCHAR  SETA  &REMAIN                                                  57500001
.MORE    ANOP                                                           57600001
&TEXT    SETC  ''                                                       57700001
         AIF (&REMAIN EQ 0).ENDTEXT                                     57800001
&TEXT    SETC  '&SYSLIST(&OP)'(&START,&NRCHAR)                          57900001
.ENDTEXT ANOP                                                           58000001
&LABELNR SETA  &LABELNR+1                                               58100001
&LABELS(&LABELNR) SETC '&TEXT'.'&TACK'                                  58200001
&START   SETA  &START+8                                                 58300001
         AIF ('&TACK' EQ '').LOOPIN                                     58400001
         AIF ('&TACK' EQ '*').LOOPOUT                                   58500001
         MEND                                                           58600001
         GBLC  &CSECT,&DSECT                                            58700001
IFCETRN0 CSECT                                                          58800001
&CSECT   SETC  'IFCETRN0'                                               58900001
&DSECT   SETC  'C3705'                                                  59000001
C3705    DSECT                                                          59100001
         DS    0F                                                       59200001
         DSGEN (RECT,8),(OPSYS,8),(SWITCH,24),(RCDID,8),(SPARE1,16)     59300001
         DSGEN (DATE,32),(TIME,32)                                      59400001
         DSGEN (SPARE2,8),(CPUSER,24),(MODEL,16),(SPARE3,16)            59500001
         DSGEN (CUA,16),(TERMN1,16),(TERMN2,32)                         59600001
         DSGEN (TERMN3,16),(RESID,16),(LINEADD,16),(RECMD,8),(RECID,8)  59700001
         DSGEN (ISBOX,8),(BTUMOD,8),(REG100,1),(REG101,1),(REG102,1),  C59800001
               (REG103,1),(REG104,1),(REG105,1),(REG106,1),(REG107,1), C59900001
               (REG108,1),(REG109,1),(REG110,1),(REG111,1),(REG112,1), C60000001
               (REG113,1),(REG114,1),(REG115,1),(REG200,1),(REG201,1), C60100001
               (REG202,1),(REG203,1),(REG204,1),(REG205,1),(REG206,1), C60200001
               (REG207,1),(REG208,1),(REG209,1),(REG210,1),(REG211,1), C60300001
               (REG212,1),(REG213,1),(REG214,1),(REG215,1),(REG300,1), C60400001
               (REG301,1),(REG302,1),(REG303,1),(REG304,1),(REG305,1), C60500001
               (REG306,1),(REG307,1),(REG308,1),(REG309,1),(REG310,1), C60600001
               (REG311,1),(REG312,1),(REG313,1),(REG314,1),(REG315,1)   60700001
         DSGEN (REG400,1),(REG401,1),(REG402,1),(REG403,1),(REG404,1), C60800001
               (REG405,1),(REG406,1),(REG407,1),(REG408,1),(REG409,1), C60900001
               (REG410,1),(REG411,1),(REG412,1),(REG413,1),(REG414,1), C61000001
               (REG415,1),(REG500,1),(REG501,1),(REG502,1),(REG503,1), C61100001
               (REG504,1),(REG505,1),(REG506,1),(REG507,1),(REG508,1), C61200001
               (REG509,1),(REG510,1),(REG511,1),(REG512,1),(REG513,1), C61300001
               (REG514,1),(REG515,1)                                    61400001
         DSGEN (REG600,1),(REG601,1),(REG602,1),(REG603,1),(REG604,1), C61500001
               (REG605,1),(REG606,1),(REG607,1),(REG608,1),(REG609,1), C61600001
               (REG610,1),(REG611,1),(REG612,1),(REG613,1),(REG614,1), C61700001
               (REG615,1),(REG700,1),(REG701,1),(REG702,1),(REG703,1), C61800001
               (REG704,1),(REG705,1),(REG706,1),(REG707,1),(REG708,1), C61900001
               (REG709,1),(REG710,1),(REG711,1),(REG712,1),(REG713,1), C62000001
               (REG714,1),(REG715,1)                                    62100001
         DSGEN (REG800,1),(REG801,1),(REG802,1),(REG803,1),(REG804,1), C62200001
               (REG805,1),(REG806,1),(REG807,1),(REG808,1),(REG809,1), C62300001
               (REG810,1),(REG811,1),(REG812,1),(REG813,1),(REG814,1), C62400001
               (REG815,1),(REG900,1),(REG901,1),(REG902,1),(REG903,1), C62500001
               (REG904,1),(REG905,1),(REG906,1),(REG907,1),(REG908,1), C62600001
               (REG909,1),(REG910,1),(REG911,1),(REG912,1),(REG913,1), C62700001
               (REG914,1),(REG915,1)                                    62800001
         EJECT                                                          62900001
IFCETRN0 CSECT                                                          63000001
         USING *,R9                                                     63100001
         USING C3705,R2                                                 63200001
****** CONSTANTS *****                                                  63300001
R1       EQU   1                                                        63400001
R2       EQU   2                                                        63500001
R3       EQU   3                                                        63600001
R4       EQU   4                                                        63700001
R5       EQU   5                                                        63800001
R6       EQU   6                                                        63900001
R7       EQU   7                                                        64000001
R8       EQU   8                                                        64100001
R9       EQU   9                                                        64200001
R10      EQU   10                                                       64300001
R12      EQU   12                                                       64400001
R13      EQU   13                                                       64500001
R14      EQU   14                                                       64600001
R15      EQU   15                                                       64700001
H00      EQU   X'00'                                                    64800001
H01      EQU   X'01'                                                    64900001
H02      EQU   X'02'                                                    65000001
H04      EQU   X'04'                                                    65100001
H84      EQU   X'84'                                                    65200001
L0       EQU   0                                                        65300001
L8       EQU   8                                                        65400001
L17      EQU   17                                                       65500001
L15      EQU   15                                                       65600001
L30      EQU   30                                                       65700001
L3       EQU   3                                                        65800001
L4       EQU   4                                                        65900001
L19      EQU   19                                                       66000001
L2       EQU   2                                                        66100001
HEX3C    EQU   X'3C'                                                    66200001
HEX36    EQU   X'36'                                                    66300001
         EJECT                                                          66400001
         DC    A(ENTRIES)                                               66500001
         DC    CL8'IFCETRN0'                                            66600001
XR9PTR   DC    F'0'                                                     66700001
XLABELP  DC    F'0'                                                     66800001
XSAVE    DC    F'0'                                                     66900001
*********************************************************************** 67000001
**                           SPECIAL ROUTINES                        ** 67100001
*********************************************************************** 67200001
TYPE     MVI   LINC+L2,HEX3C                                            67300001
         CLI   ISBOX,H84           IS BOX TYPE1 PORT1?                  67400001
         BE    BOX84               YES                                  67500001
         CLI   ISBOX,H04           IS BOX TYPE2 PORT1?                  67600001
         BE    BOX04               YES                                  67700001
         CLI   ISBOX,H02           IS BOX TYPE2 PORT2?                  67800001
         BE    BOX02               YES                                  67900001
         MVC   XR9PTR(L8),LINEC                                         68000001
         B     RETURN                                                   68100001
BOX02    MVC   L0(L15,R3),MSGA     PRINT MESSAGE                        68200001
         BR    R14                                                      68300001
BOX04    MVC   L0(L15,R3),MSGB     PRINT MESSAGE                        68400001
         BR    R14                                                      68500001
BOX84    MVC   L0(L17,R3),MSGC     PRINT MESSAGE                        68600001
         BR    R14                                                      68700001
         SPACE 3                                                        68800001
TYPE1    CLI   ISBOX,H84                                                68900001
         BE    RETURN                                                   69000001
         MVC   XR9PTR(L8),LINEB                                         69100001
         B     RETURN                                                   69200001
         SPACE 3                                                        69300001
LINEA    DC    A(LINC-4)                                                69400001
LINEB    DC    A(LINE24-4)                                              69500001
LABB     DC    A(LAB24-1)                                               69600001
LINEC    DC    A(ERRLINE-4)                                             69700001
LABC     DC    A(ERRLBL-1)                                              69800001
         SPACE 3                                                        69900001
CHKREC   MVC   L0(L19,R3),CHKMSG   MOVE MESSAGE INTO LINE               70000001
         ST    R6,XSAVE            SAVE REGS                            70100001
         XR    R6,R6               CLEAR REG 6                          70200001
         IC    R6,BTUMOD           GET LOST CK REC CNT                  70300001
         CVD   R6,LCRCNT           CONVERT COUNT TO DECIMAL             70400001
         UNPK  L17(L3,R3),LCRCNT   UNPACK LOST CK COUNT                 70500001
         OI    L19(R3),ZONE        SET ZONE OF LAST DIGIT               70600001
         L     R6,XSAVE            RESTORE REG 6                        70700001
         BR    R14                                                      70800001
         SPACE 3                                                        70900001
TERM     MVI   LINC+L2,HEX36                                            71000001
         MVC   XR9PTR(L4),LINEA    STORE POINTER                        71100001
RETURN   XR    R15,R15             DON'T PRINT THIS LINE                71200001
         BR    R14                                                      71300001
         SPACE 3                                                        71400001
CSARSET  ST    R5,XSAVE            SAVE REG                             71500001
         IC    R4,L0(R4)           GET BITS                             71600001
         SRDL  R4,L2               MOVE INTO REG 5                      71700001
         SRL   R5,L30              SHIFT DOWN                           71800001
         STC   R5,L0(R3)           PUT IN PRINT LINE                    71900001
         OI    L0(R3),ZONE         ADD ZONE                             72000001
         L     R5,XSAVE            RESTORE REG                          72100001
         BR    R14                 RETURN                               72200001
         SPACE 3                                                        72300001
ZONE     EQU   X'F0'                                                    72400001
MSGA     DC    C'TYPE 2/3 PORT 2'                                       72500001
MSGB     DC    C'TYPE 2/3 PORT 1'                                       72600001
MSGC     DC    C'TYPE 1/4 FRME 1/2'                                     72700001
CHKMSG   DC    C'LOST CK REC CNT    '                                   72800001
LCRCNT   DS    D                                                        72900001
         EJECT                                                          73000001
***** EDIT ENTRIES *****                                                73100001
ENTRIES  DS    0F                                                       73200001
         DC    XL4'00010001'                                            73300001
         DC    XL4'00010001'                                            73400001
         DC    A(LABELS)                                                73500001
         DC    H'0'                                                     73600001
         DC    X'01'                                                    73700001
         DC    X'000B0B00'                                              73800001
         SPACE 3                                                        73900001
         LINE  (32,28),(2,47),SKIP=2                                    74000001
         ROUTINE ISBOX,TYPE                                             74100001
         LABEL ''                                              @XA21838 74130001
         LINE  ,                                               @XA21838 74160001
         HEX   LINEADD,0,2B                                             74200001
         ROUTINE BTUMOD,CHKREC                                          74300001
         LABEL 'RECORD TYPE - CHANNEL ADAPTER ','ABEND CODE'            74400001
         SPACE 3                                                        74500001
         LINE                                                           74600001
         ROUTINE ISBOX,TYPE1                                            74700001
         LABEL ''                                                       74800001
         SPACE 3                                                        74900001
         LINE  (34,56),(9,50)                                           75000001
         HEX   (REG600,0,1B),(REG608,0,1B)                              75100001
         LABEL 'NTVE SBCHNNL ADDRESS ','CHNNL ADPTR CNTRL (67) '        75200001
         SPACE 3                                                        75300001
         LINE  (35,56),(11,50),SKIP=1                                   75400001
         BIN   (REG100),(REG608)                                        75500001
         LABEL '                          ','CHANNEL BUS IN CHECK'      75600001
         SPACE 3                                                        75700001
         LINE                                                           75800001
         BIN   (REG100),(REG609)                                        75900001
         LABEL '                          ','I/O INST ACCEPT CHECK'     76000001
         SPACE 3                                                        76100001
         LINE                                                           76200001
         BIN   (REG100),(REG610)                                        76300001
         LABEL '                          ','CCU OUTBUS CHECK'          76400001
         SPACE 3                                                        76500001
         LINE                                                           76600001
         BIN   (REG100),(REG611)                                        76700001
         LABEL '                          ','LOCAL STORE CHECK'         76800001
         SPACE 3                                                        76900001
         LINE                                                           77000001
         BIN   (REG100),(REG612)                                        77100001
         LABEL '                          ','CHANNEL INTERFACE ENABLED' 77200001
         SPACE 3                                                        77300001
         LINE                                                           77400001
         BIN   (REG100),(REG613)                                        77500001
         LABEL '                          ','NATIVE SUBCHANNEL ADDR.ACT*77600001
               IVE'                                                     77700001
         SPACE 3                                                        77800001
         LINE                                                           77900001
         BIN   (REG100),(REG614)                                        78000001
         LABEL '                          ','UNUSED'                    78100001
         SPACE 3                                                        78200001
         LINE                                                           78300001
         BIN   (REG100),(REG615)                                        78400001
         LABEL '                          ','TYPE 4 CA 2'               78500001
         SPACE 3                                                        78600001
         LINE                                                           78700001
         ROUTINE REG100,TERM                                            78800001
         LABEL ''                                                       78900001
         SPACE 3                                                        79000001
LINE24   LINE  (34,1),(5),SKIP=3                                        79100001
         ROUTINE REG614,CSARSET                                         79200001
         HEX   REG700,0,2B                                              79300001
LAB24    LABEL 'CYCLE STEAL ADDRESS REGISTER'                           79400001
         SPACE 3                                                        79500001
         LINE  (22,38),(4,34),SKIP=2                                    79600001
         HEX   (REG100,0,2B),(REG200,0,2B),(REG300,0,2B)                79700001
         LABEL 'INCWAR (50) - ','OUTCWAR (51) - ','CW BYTE CNT (52) - ' 79800001
         SPACE 3                                                        79900001
         LINE  (20,24),(4,24),SKIP=1                                    80000001
         LABEL 'CHANNEL ADAPTER','CHANNEL ADAPTER','CHANNEL ADAPTER','CC80100001
               HANNEL ADAPTER'                                          80200001
         SPACE 3                                                        80300001
         LINE  ,,SKIP=2                                                 80400001
         HEX   (REG400,0,2B),(REG500,0,2B),(REG600,0,2B),(REG900,0,2B)  80500001
         LABEL 'CONTROL REG 55-','CHECKS  REG 56-','BUS OUT REG 58-','C*80600001
               OMMAND  REG 5C-'                                         80700001
         SPACE 3                                                        80800001
         LINE  (23,24),(2,24),SKIP=1                                    80900001
         BIN   (REG400),(REG500),(REG600),(REG900)                      81000001
         LABEL 'DIAGNOSTIC WRAP MODE','INVALID CWAR ADDRESS','CHNL BUS *81100001
               OUT BIT 0','TEST I/O HEX 00'                             81200001
         SPACE 3                                                        81300001
         LINE                                                           81400001
         BIN   (REG401),(REG501),(REG601),(REG901)                      81500001
         LABEL 'ZERO COUNT OVERRIDE','INVALID CW FORMAT','BIT 1','WRITE*81600001
                HEX 01'                                                 81700001
         SPACE 3                                                        81800001
         LINE                                                           81900001
         BIN   (REG402),(REG502),(REG602),(REG902)                      82000001
         LABEL 'INCWAR VALID','CYCLE STEAL ADDR CHK','BIT 2','READ  HEX*82100001
                02'                                                     82200001
         SPACE 3                                                        82300001
         LINE                                                           82400001
         BIN   (REG403),(REG503),(REG603),(REG903)                      82500001
         LABEL 'OUTCWAR VALID','CWAR/DATA BUFFER CHK','BIT 3','NO-OP HE*82600001
               X 03'                                                    82700001
         SPACE 3                                                        82800001
         LINE                                                           82900001
         BIN   (REG404),(REG504),(REG604),(REG904)                      83000001
         LABEL 'PROG REQD L3 INTRPT','CCU OUTBUS CHECK','BIT 4','SENSE *83100001
               HEX 04'                                                  83200001
         SPACE 3                                                        83300001
         LINE                                                           83400001
         BIN   (REG405),(REG505),(REG605),(REG905)                      83500001
         LABEL 'PG REQD ABORT L3 IPT','CCU INBUS CHECK','BIT 5','UNUSEDC83600001
               '                                                        83700001
         SPACE 3                                                        83800001
         LINE                                                           83900001
         BIN   (REG406),(REG506),(REG606),(REG906)                      84000001
         LABEL 'PROG REQ ATTENTION','CHANNEL BUS OUT CHK','BIT 6','WRT *84100001
               BREAK HEX 09'                                            84200001
         SPACE 3                                                        84300001
         LINE                                                           84400001
         BIN   (REG407),(REG507),(REG607),(REG907)                      84500001
         LABEL 'CHAN ADAPTER ACTIVE','UNUSED','BIT 7','UNUSED'          84600001
         SPACE 3                                                        84700001
         LINE                                                           84800001
         BIN   (REG408),(REG508),(REG608),(REG908)                      84900001
         LABEL 'COMMAND CHAINING','UNUSED','BIT P','OUT CONTROL WORD'   85000001
         SPACE 3                                                        85100001
         LINE                                                           85200001
         BIN   (REG409),(REG509),(REG609),(REG909)                      85300001
         LABEL 'WRT BRK CMND RMB','UNUSED','UNUSED','OUT STOP CTL WORD' 85400001
         SPACE 3                                                        85500001
         LINE                                                           85600001
         BIN   (REG410),(REG510),(REG610),(REG910)                      85700001
         LABEL 'CHAN STP/INTFC DISC','UNUSED','TRANSFER BYTE 1','IN CONC85800001
               TROL WORD'                                               85900001
         SPACE 3                                                        86000001
         LINE                                                           86100001
         BIN   (REG411),(REG511),(REG611),(REG911)                      86200001
         LABEL 'SEL SYSTEM RESET','UNUSED','TRANSFER BYTE 2','TIC CONTRC86300001
               OL WORD'                                                 86400001
         SPACE 3                                                        86500001
         LINE                                                           86600001
         BIN   (REG412),(REG512),(REG612),(REG912)                      86700001
         LABEL 'UNUSED','CHANNEL BUS IN CHK A','CHAN INTRFCE A ENABL','C86800001
               NON-STANDARD COMMAND'                                    86900001
         SPACE 3                                                        87000001
         LINE                                                           87100001
         BIN   (REG413),(REG513),(REG613),(REG913)                      87200001
         LABEL 'I/O RD CMMND REMEMBR','CHANNEL BUS IN CHK B','CHAN INTRC87300001
               FCE B ENABL','INTFC A (TYPE 3 CA)'                       87400001
         SPACE 3                                                        87500001
         LINE                                                           87600001
         BIN   (REG414),(REG514),(REG614),(REG914)                      87700001
         LABEL 'TYPE 2/3 CA 2 SEL','UNUSED','CSAR BYTE X BIT 6','INTFC *87800001
               A (TYPE 3 CA)'                                           87900001
         SPACE 3                                                        88000001
         LINE                                                           88100001
         BIN   (REG415),(REG515),(REG615),(REG915)                      88200001
         LABEL 'TYPE 2/3 CA 1 SEL','UNUSED','CSAR BYTE X BIT 7','WRT IP*88300001
               L HEX 05'                                                88400001
         SPACE 3                                                        88500001
LINC     DC    X'FF'                                                    88600001
         DC    XL2'003C'                                                88700001
         DC    XL2'0018'                                                88800001
         DC    XL2'0018'                                                88900001
         SPACE 3                                                        89000001
ERRLINE  LINE  ,(10,1),SKIP=1                                           89100001
ERRLBL   LABEL 'RECORD TYPE UNKNOWN -- IFCETRN0'                        89200001
         SPACE 3                                                        89300001
         DC    X'FF'                                                    89400001
         DC    XL2'003C'                                                89500001
         DC    XL2'0018'                                                89600001
         DC    XL2'0018'                                                89700001
         EJECT                                                          89800001
LABELS   DS    0F                                                       89900001
         DC    C'$'                                                     90000001
         LSTART                                                         90100001
         END                                                            90200001
