       TITLE   'IFCETRN5 FOR EREP SUPPORT OF 3705/27RN'                 00090002
         EJECT                                                          00180002
         MACRO                                                          00270002
         CONVT                                                          00360002
         GBLC  &ITEM(1000),&DSECT                                       00450002
         GBLA  &INITIAL                                                 00540002
         GBLA  &BITS(1000),&ITEMNBR,&SHIFT(1000)                        00630002
         GBLA  &NRENTS                                                  00720002
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN                               00810002
         LCLB  &SUB                                                     00900002
         LCLA  &OP                                                      00990002
         LCLA  &OFFSET,&OUT,&IN,&IND,&IBITS,&ISHIFT                     01080002
         ACTR  500000                                                   01170002
.*                                                                      01260002
.*       CONVERT BINARY TO DECIMAL                                      01350002
.*             &NAME IS THE REFERENCE INTO THE DSECT RECORD             01440002
.*             &OUT    IS THE NUMBER OF CHARS TO BE PUT ONTO PRINT LINE 01530002
.*                                      DEFAULT IS FOUR MAXIMUM IS 8    01620002
.*             &IN       IS THE NUMBER OF BYTES AS INPUT                01710002
.*                                      ERROR DEFAULT IS 2 MAXIMUM IS 4 01800002
.*                                                                      01890002
         AIF   (&DIAGTST EQ 0).NOMSG                                    01980002
         AIF   (&INITIAL EQ 0).NOMSG                                    02070002
         AIF   (&DIAGLIN EQ 1).NOMSG                                    02160002
         MNOTE '**NO LINE ASSOCIATED WITH THIS DATA**'                  02250002
*****THE FOLLOWING GENERATED FOR TEST PURPOSES*****                     02340002
*        LINE                                                           02430002
         LINE                                                           02520002
.NOMSG   ANOP                                                           02610002
         AIF   (K'&SYSLIST(1) EQ K'&SYSLIST(1,1)).LLOP                  02700002
&SUB     SETB  1                                                        02790002
.LLOP    ANOP                                                           02880002
&OP      SETA  &OP+1                                                    02970002
&OUT     SETA  4                        .BR NOT NULL ELSE SET TO 4      03060002
         AIF   (&SUB EQ 1).SUBA                                         03150002
         AIF   ('&SYSLIST(3)' EQ '').B  TEST FOR NULL INPUT             03240002
&OUT     SETA  &SYSLIST(3)             SET &OUT FROM INPUT              03330002
         AGO   .A                                                       03420002
.SUBA    AIF   ('&SYSLIST(&OP,3)' EQ '').B                              03510002
&OUT     SETA  &SYSLIST(&OP,3)          SET &OUT FROM INPUT             03600002
.A       AIF   (&OUT GT 0 AND &OUT LT 9).B   TEST RANGE                 03690002
.AERR    MNOTE '*** BYTES OUT INCORRECTLY SPECIFIED DEFAULT USED ***'   03780002
&OUT     SETA  4                                                        03870002
.B       AIF   (&SUB EQ 1).SUBB                                         03960002
         AIF   ('&SYSLIST(2)' EQ '').LOOP    BRANCH IF NULL             04050002
&IN      SETA  &SYSLIST(2)              .SET &IN FROM INPUT             04140002
         AGO   .BB                                                      04230002
.SUBB    AIF   ('&SYSLIST(&OP,2)' EQ '').LOOP                           04320002
&IN      SETA  &SYSLIST(&OP,2)          .SET &IN FROM INPUT             04410002
.BB      AIF   (&IN GT 0 AND &IN LT 5).D     TEST RANGE                 04500002
.BERR    MNOTE '*** BYTES IN INCORRECTLY SPECIFIED DEFAULT USED ***'    04590002
&IN      SETA  2                                                        04680002
         AGO   .D                                                       04770002
.LOOP    ANOP                           .LOOP TO FIND &NAME IN DSECT    04860002
&IND     SETA  &IND+1                   .SET UP LOOP COUNTER            04950002
         AIF   ('&ITEM(&IND)' EQ '&SYSLIST(&OP,1)').FOUND               05040002
         AIF   (&IND LT &ITEMNBR).LOOP  .TEST FOR END OF DSECT          05130002
         MNOTE '*** LOG ITEM NOT DEFINED ***'                           05220002
         MEXIT                                                          05310002
.FOUND   ANOP                                                           05400002
&IBITS   SETA  &BITS(&IND)              .SET UP NUMBER OF BITS SPEC     05490002
         AIF   (&IBITS-((&IBITS/8)*8) EQ 0).C  .TEST FOR MULTIPLE OF 8  05580002
         MNOTE '*** DATA NOT DEFINED A MULTIPLE OF 8 BITS ***'          05670002
         MEXIT                                                          05760002
.C       ANOP                                                           05850002
&IN      SETA  &IBITS/8                 .COMPUTE NUMBER OF BYTES        05940002
         AIF   (&IN LT 1 OR &IN GT 4).BERR  .TEST RANGE B IF IN ERROR   06030002
&ISHIFT  SETA  &SHIFT(&IND)             .SET UP FOR TEST OF BYTE BNDR   06120002
         AIF   (&ISHIFT EQ 0).D         .TEST FOR BYTE BNDRY  !R IF YES 06210002
         MNOTE '*** DATA NOT ALIGNED ON A BYTE BOUNDARY ***'            06300002
         MEXIT                                                          06390002
.*                                                                      06480002
.D       ANOP                                                           06570002
&NRENTS  SETA  &NRENTS+1                                                06660002
         DC    AL.12(&SYSLIST(&OP,1)-&DSECT),AL.4(9)                    06750002
         DC    X'&IN',X'&OUT'                                           06840002
&IND     SETA  0                                                        06930002
         AIF   (&SUB EQ 0).OUTA                                         07020002
         AIF   (&OP LT N'&SYSLIST).LLOP                                 07110002
.OUTA    ANOP                                                           07200002
         MEND                                                           07290002
*                                                                       07380002
*  DSGEN MACRO     DSGEN MACRO     DSGEN MACRO     DSGEN MACRO        * 07470002
         SPACE 2                                                        07560002
*  DSGEN MACRO     DSGEN MACRO     DSGEN MACRO     DSGEN MACRO        * 07650002
         SPACE 2                                                        07740002
         MACRO                                                          07830002
&NAME    DSGEN                                                          07920002
.*                            THIS MACRO GENERATES ONE DSECT WORD       08010002
.*                                 FORMATTED FOR THE SUBJECT LOG RECORD 08100002
.*                                 EACH OPERAND HAS TWO SUB LISTS. THE  08190002
.*                                 FIRST IS THE NAME OF THE LOG ITEM    08280002
.*                                 WHILE THE SECOND IS THE # OF BITS TO 08370002
.*                                 ALLOCATE FOR THIS ITEM. ITEMS MUST   08460002
.*                                 BE DEFINED CONTIGUOUSLY WITHOUT GAPS 08550002
.*                                 UNUSED BIT GROUPS MUST BE GIVEN      08640002
.*                                 DUMMY NAMES. THE NAMES PROVIDED FOR  08730002
.*                                 THE LOG ITEMS MAY THEN BE USED IN    08820002
.*                                 THE CONVERSION MACRO INSTRUCTIONS.   08910002
         GBLC &ITEM(1000)                                               09000002
         GBLA &ITEMNBR,&BITS(1000),&SHIFT(1000)                         09090002
         LCLB  &ONLY1,&CTIND                                            09180002
         LCLA  &START1,&START2,&END1,&END2                              09270002
         LCLC  &SYMBOL,&EQUSYM                                          09360002
         LCLA  &OP,&COUNT,&BYTE,&EQUCNT                                 09450002
         ACTR  100000                                                   09540002
.START   AIF   (N'&SYSLIST(&OP+1) LT 3).LOOP                            09630002
         AIF   ('&SYSLIST(&OP+1,3)' EQ 'EQU').LOOP     TEST FOR EQU     09720002
  AIF   ('&SYSLIST(&OP+1,3)' EQ '' OR '&SYSLIST(&OP+1,4)' EQ '').ERR1   09810002
         AIF   ('&SYSLIST(&OP+1,3)' GT '&SYSLIST(&OP+1,4)').ERR3        09900002
&START1  SETA  &SYSLIST(&OP+1,3)        GET START COUNT OF 1            09990002
&START2  SETA  &SYSLIST(&OP+1,4)        GET FIRST END COUNT             10080002
         AGO   .SET2A                   BRANCH AROUND                   10170002
.ERR1    MNOTE '**FIRST SYMBOL CONCATENATION INCOMPLETE**'              10260002
         MEXIT                                                          10350002
.SET2A   AIF   ('&SYSLIST(&OP+1,5)' EQ ''AND '&SYSLIST(&OP+1,6)' EQ '' X10440002
               ).SET2                   TEST FOR NO SECOND              10530002
  AIF   ('&SYSLIST(&OP+1,5)' EQ '' OR '&SYSLIST(&OP+1,6)' EQ '').ERR2   10620002
         AIF   ('&SYSLIST(&OP+1,5)' GT '&SYSLIST(&OP+1,6)').ERR3        10710002
&END1    SETA  &SYSLIST(&OP+1,5)        GET START COUNT OF 2            10800002
&END2    SETA  &SYSLIST(&OP+1,6)        GET END COUNT OF 2              10890002
         AGO   .LOOP                                                    10980002
.SET2    ANOP                                                           11070002
&ONLY1   SETB  1                        INDICATE ONLY ONE CONCATENATION 11160002
         AGO   .LOOP                                                    11250002
.ERR2    MNOTE '**SECOND SYMBOL CONCATENATION INCOMPLETE**'             11340002
         MEXIT                                                          11430002
.ERR3    MNOTE '**START GREATER THAN END CONCATENATION**'               11520002
         MEXIT                                                          11610002
.LOOP    ANOP                                                           11700002
&OP      SETA  &OP+1                                                    11790002
         AIF   (&OP GT N'&SYSLIST).DONE      TEST IF ALL DONE           11880002
&ITEMNBR SETA  &ITEMNBR+1                                               11970002
         AIF   ('&SYSLIST(&OP,2)' NE '').OK1                            12060002
         MNOTE '**NULL BIT COUNT FIELD**'                               12150002
         MEXIT                                                          12240002
.OK1     ANOP                                                           12330002
&SYMBOL  SETC  '&SYSLIST(&OP,1)'                                        12420002
         AIF   ('&SYMBOL' NE '').OK                                     12510002
*              *****     LOG ITEM SYMBOL NOT PROVIDED     *****         12600002
         AIF   ('&SYSLIST(&OP,3)' NE 'EQU').CNT                         12690002
         AGO   .START                   GET NEXT                        12780002
.OK      AIF   (N'&SYSLIST(&OP) LT 3).NO3    TEST FOR OLD FORMAT        12870002
         AIF   ('&SYSLIST(&OP,3)' EQ 'EQU').EQU   TEST FOR EQU          12960002
         AIF   (&ONLY1).OK2             TEST FOR ONLY ONE CONCAT        13050002
&SYMBOL  SETC  '&SYMBOL.&START1.&END1'       GET 1 AND 2 CONCAT         13140002
         AGO   .NO3                     BRANCH AROUND                   13230002
.OK2     ANOP                                                           13320002
&SYMBOL  SETC  '&SYMBOL.&START1'        GET 1 CONCATENATED              13410002
.NO3     ANOP                                                           13500002
&SYMBOL  EQU   *+&BYTE                                                  13590002
&ITEM(&ITEMNBR) SETC '&SYMBOL'          GET LABEL IN GLOBAL             13680002
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2)                                    13770002
&SHIFT(&ITEMNBR) SETA &COUNT-&BYTE*8                                    13860002
.CNT     ANOP                                                           13950002
&CTIND   SETB  1                        SET COUNT INDICATOR             14040002
&COUNT   SETA  &COUNT+&SYSLIST(&OP,2)                                   14130002
&BYTE    SETA  &COUNT/8                                                 14220002
         AIF   (N'&SYSLIST(&OP) LT 3).START  TEST FOR OLD FORMAT        14310002
         AIF   (&ONLY1).TSTST           TEST FOR ONLY ONE CONCAT        14400002
         AIF   (&END1 EQ &END2).TSTST   TEST FOR SECOND END             14490002
&END1    SETA  &END1+1                  INCREMENT COUNT                 14580002
&OP      SETA  &OP-1                    DECREMENT INCREMENT             14670002
         AGO   .LOOP                    GENERATE NEXT                   14760002
.TSTST   ANOP                                                           14850002
         AIF   (&START1 EQ &START2).LPDONE   TEST FOR END               14940002
         AIF   (&ONLY1).NSET1           TEST FOR ONLY ONE CONCAT        15030002
&END1    SETA  &SYSLIST(&OP,5)          RE-INIT SECOND START COUNT      15120002
.NSET1   ANOP                                                           15210002
&OP      SETA  &OP-1                    DECREMENT INDEX                 15300002
&START1  SETA  &START1+1                INCREMENT FIRST COUNT           15390002
         AGO   .LOOP                    GO DO NEXT                      15480002
.LPDONE  ANOP                                                           15570002
&ONLY1   SETB  0                        CLEAR INDICATOR                 15660002
         AGO   .START                   GO TEST FOR MORE SUB-LISTS      15750002
.DONE    AIF   (&COUNT-&COUNT/8*8 NE 0).ERR  TEST FOR MULTIPLE OF EIGHT 15840002
         AIF   (&CTIND EQ 0).END        NO DS IF NO COUNT               15930002
&COUNT   SETA  &COUNT/8                 GET NUMBER OF BYTES             16020002
&NAME    DS    &COUNT.C                                                 16110002
.END     MEXIT                                                          16200002
.ERR     MNOTE '**BIT COUNT FLDS DO NOT TOTAL MULTIPLE OF 8**'          16290002
         MEXIT                                                          16380002
.EQU     AIF   ('&SYSLIST(&OP,4)' NE '').EQU1     TEST FOR NULL LABEL   16470002
.ERR4    MNOTE '**EQU OPERAND OMITTED OR NOT FOUND**'                   16560002
         MEXIT                                                          16650002
.EQU1    AIF   (&SYSLIST(&OP,2) LT 16).EQU2  COUNT OVER FIFTEEN         16740002
*****               THE FOLLOWING STATEMENT                *****        16830002
*****     NUMBER OF BITS EXCEED 15 - DO NOT USE AS BIN     *****        16920002
.EQU2    ANOP                                                           17010002
&EQUCNT  SETA  0                        CLEAR COUNTER                   17100002
&EQUSYM  SETC  '&SYSLIST(&OP,4)'        GET EQU OPERAND                 17190002
.EQULOP  ANOP                                                           17280002
&EQUCNT  SETA  &EQUCNT+1                INCREMENT INDEX                 17370002
         AIF   ('&ITEM(&EQUCNT)' EQ '&EQUSYM').EQUOUT  LABEL FOUND?     17460002
         AIF   (&EQUCNT EQ &ITEMNBR).ERR4    ALL TESTED?                17550002
         AGO   .EQULOP                  NO-GET NEXT                     17640002
.EQUOUT  ANOP                                                           17730002
&ITEM(&ITEMNBR) SETC '&SYMBOL'          GET LABEL NAME                  17820002
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2)    GET NUMBER OF BITS              17910002
&SHIFT(&ITEMNBR) SETA &SHIFT(&EQUCNT)   GET SHIFT COUNT                 18000002
&SYMBOL  EQU   &EQUSYM                  THIS SYMBOL EQUATED             18090002
         AGO   .START                   RETURN FOR NEXT                 18180002
         MEND                                                           18270002
         EJECT                                                          18360002
         MACRO                                                          18450002
         LINEND                                                         18540002
.*                            THIS MACRO IS USED ONLY BY THE LINE       18630002
.*                                 MACRO TO SET THE NUMBER OF ENTRIES   18720002
.*                                 ASSOCIATED WITH EACH LINE.           18810002
         GBLA  &NRENTS                                                  18900002
         GBLC &NRENTSX                                                  18990002
         AIF   (&NRENTS EQ 0).NORENTS   TEST FOR NO COUNT               19080002
         ORG   &NRENTSX                                                 19170002
         DC    FL1'&NRENTS'                                             19260002
         ORG                                                            19350002
&NRENTS  SETA  0                                                        19440002
.NORENTS ANOP                                                           19530002
B&SYSNDX EQU   *                                                        19620002
&NRENTSX SETC  'B&SYSNDX'                                               19710002
         MEND                                                           19800002
         EJECT                                                          19890002
         MACRO                                                          19980002
         BIN                                                            20070002
.*                                 &SYSLIST(&OP,1) - NAME OF LOG ITEM   20160002
.*                                      RECORD DSECT                    20250002
.*                                 $SYSLIST(&OP,2) - NBR OF SPACES      20340002
.*                                      TO SKIP ON MULTIPLE             20430002
.*                                      PRINT OR NBR OF SPACES          20520002
.*                                      TO BACK UP FROM COLUMN FOR      20610002
.*                                      START OF PRINTING. THE LETTER   20700002
.*                                      B PRECEEDS THE NUMBER (B5) IF   20790002
.*                                      THE LATTER IS DESIRED. OMISSION 20880002
.*                                      OF THIS OPERAND FORCES OPTION 2 20970002
.*                                      WITH BACKUP SPACING EQUAL TO    21060002
.*                                 THE NUMBER OF BITS IN THE ITEM       21150002
.*                                 DEFINITION (VIA MACRO 'DSGEN').      21240002
.*                            A LIMIT OF 15 BITS IS IMPOSED FOR THE     21330002
.*                                 TOTAL NUMBER OF BITS TO PRINT.       21420002
         GBLA  &INITIAL                                                 21510002
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN                               21600002
         GBLC &ITEM(1000)                                               21690002
         GBLA &ITEMNBR,&BITS(1000),&SHIFT(1000),&NRENTS                 21780002
         GBLC  &DSECT                                                   21870002
         LCLB  &B,&SUB                                                  21960002
         LCLA  &IBITS,&NDX,&ISHIFT,&K                                   22050002
         LCLA  &TEMP,&T,&OP                                             22140002
         LCLC  &S                                                       22230002
         AIF   (&DIAGTST EQ 0).NOMSG                                    22320002
         AIF   (&INITIAL EQ 0).NOMSG                                    22410002
         AIF   (&DIAGLIN EQ 1).NOMSG                                    22500002
         MNOTE '**NO LINE ASSOCIATED WITH THIS DATA**'                  22590002
*****THE FOLLOWING GENERATED FOR TEST PURPOSES*****                     22680002
*        LINE                                                           22770002
         LINE                                                           22860002
.NOMSG   ANOP                                                           22950002
         AIF   (K'&SYSLIST(1) EQ K'&SYSLIST(1,1)).LOOP                  23040002
&SUB     SETB  1                                                        23130002
.LOOP    ANOP                                                           23220002
&OP      SETA  &OP+1                                                    23310002
.LOOP1   ANOP                                                           23400002
&NDX     SETA  &NDX+1                                                   23490002
         AIF   ('&ITEM(&NDX)' EQ '&SYSLIST(&OP,1)').FOUND               23580002
         AIF   (&NDX LT &ITEMNBR).LOOP1                                 23670002
         MNOTE '**LOG ITEM NOT DEFINED**'                               23760002
         MEXIT                                                          23850002
.FOUND   ANOP                                                           23940002
&ISHIFT  SETA  &SHIFT(&NDX)                                             24030002
&IBITS   SETA  &BITS(&NDX)                                              24120002
&T       SETA  &IBITS-1                                                 24210002
&B       SETB  0                                                        24300002
         AIF   (&IBITS GT 0 AND &IBITS LT 16).SUB0                      24390002
         MNOTE '**NO. OF BITS OUTSIDE RANGE OF 1-15**'                  24480002
         MEXIT                                                          24570002
.SUB0    AIF   (&SUB EQ 1).SUBA                                         24660002
         AIF   ('&SYSLIST(2)' EQ '').BACKUP                             24750002
&K       SETA  K'&SYSLIST(2)                                            24840002
&B       SETB  ('&SYSLIST(2)'(1,1) EQ 'B')                              24930002
&S       SETC  '&SYSLIST(2)'(&B+1,&K-&B)                                25020002
         AGO   .SUBB                                                    25110002
.SUBA    ANOP                                                           25200002
         AIF   ('&SYSLIST(&OP,2)' EQ '').BACKUP                         25290002
&K       SETA  K'&SYSLIST(&OP,2)                                        25380002
&B       SETB  ('&SYSLIST(&OP,2)'(1,1) EQ 'B')                          25470002
&S       SETC  '&SYSLIST(&OP,2)'(&B+1,&K-&B)                            25560002
.SUBB    ANOP                                                           25650002
&T       SETA  &S                                                       25740002
.BACKUP  ANOP                                                           25830002
&NRENTS  SETA  &NRENTS+1                                                25920002
&TEMP    SETA  &ISHIFT                                                  26010002
         AIF   (&IBITS NE 1 OR &B NE 0).BIN2                            26100002
         DC    AL.12(&SYSLIST(&OP,1)-&DSECT),XL.4'&TEMP'                26190002
         AGO   .OUT                                                     26280002
.BIN2    AIF   ('&SYSLIST(&OP,2)' NE '').BIN3                           26370002
&B       SETB  1                                                        26460002
.BIN3    ANOP                                                           26550002
         DC    AL.12(&SYSLIST(&OP,1)-&DSECT),XL.4'C'                    26640002
         DC    BL.1'&B',AL.7(&T),AL.4(&IBITS),FL.4'&ISHIFT'             26730002
.OUT     ANOP                                                           26820002
&NDX     SETA  0                                                        26910002
         AIF   (&SUB EQ 0).OUTA                                         27000002
         AIF   (&OP LT N'&SYSLIST).LOOP                                 27090002
.OUTA    ANOP                                                           27180002
         MEND                                                           27270002
         EJECT                                                          27360002
         MACRO                                                          27450002
         LSTART                                                         27540002
.*                            THIS MACRO IS ISSUED WHEN THE LABEL AREA  27630002
.*                                 OF THE TABLE IS TO BEGIN.            27720002
         GBLA  &LABELNR                                                 27810002
         GBLC  &LBL(100)                                                27900002
         GBLC &LABELS(2000)                                             27990002
         GBLA  &LBLCTR(100)                                             28080002
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN                               28170002
         LCLA  &NDX,&CTR                                                28260002
         AIF   (&DIAGTST EQ 0).NODIAG                                   28350002
         AIF   (&DIAGSET EQ 0).NODIAG                                   28440002
         MNOTE '**NO LABEL ASSOCIATED WITH LAST SET**'                  28530002
***** THE FOLLOWING GENERATED FOR TEST PURPOSES *****                   28620002
*        LABEL '%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%'       28710002
               LABEL '%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%' 28800002
.NODIAG  ANOP                                                           28890002
         LINEND                                                         28980002
&CTR     SETA  1                                                        29070002
.LOOP    ANOP                                                           29160002
&NDX     SETA  &NDX+1                                                   29250002
         AIF   (&LBLCTR(&CTR) NE &NDX).NOLBL                            29340002
&LBL(&CTR) DC  C'&LABELS(&NDX)'                                         29430002
&CTR     SETA  &CTR+1                                                   29520002
         AGO   .LOOPCTL                                                 29610002
.NOLBL   ANOP                                                           29700002
         DC    C'&LABELS(&NDX)'                                         29790002
.LOOPCTL AIF   (&NDX LT &LABELNR).LOOP                                  29880002
         MEND                                                           29970002
         EJECT                                                          30060002
         MACRO                                                          30150002
&NAME    ROUTINE &LOGITEM,&RNAME                                        30240002
         GBLA  &NRENTS                                                  30330002
         GBLC  &DSECT,&CSECT                                            30420002
         GBLA  &INITIAL                                                 30510002
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN                               30600002
         AIF   (&DIAGTST EQ 0).NOMSG                                    30690002
         AIF   (&INITIAL EQ 0).NOMSG                                    30780002
         AIF   (&DIAGLIN EQ 1).NOMSG                                    30870002
         MNOTE '**NO LINE ASSOCIATED WITH THIS ROUTINE**'               30960002
*****THE FOLLOWING GENERATED FOR TEST PURPOSES*****                     31050002
*        LINE                                                           31140002
         LINE                                                           31230002
.NOMSG   ANOP                                                           31320002
&NAME    DC    AL.12(&LOGITEM-&DSECT),XL.4'D'                           31410002
         DC    AL2(&RNAME-&CSECT)                                       31500002
&NRENTS  SETA  &NRENTS+1                                                31590002
         MEND                                                           31680002
         EJECT                                                          31770002
         MACRO                                                          31860002
&NAME    LINE  &DATA,&LABEL,&SKIP=                                      31950002
.*                            THIS MACRO ESTABLISHES THE MARGINS OR     32040002
.*                                 COLUMN SETTINGS FOR EACH LINE. IT    32130002
.*                                 GENERATES NECESSARY CARRIAGE CONTROL 32220002
.*                                 ENTRIES. LASTLY IT DETERMINES THE    32310002
.*                                 NUMBER OF ENTRIES ASSOCIATED WITH    32400002
.*                                 THE PREVIOUS LINE AND STORES THAT #  32490002
.*                                 INTO THE APPROPRIATE BYTE.           32580002
.*                            &DATA(1) - CHARACTER POSITION TO BEGIN    32670002
.*                                 DATA.                                32760002
.*                            &DATA(2) - # OF SPACES BETWEEN SUCCESSIVE 32850002
.*                                 DATA COLUMN STARTING CHARACTERS.     32940002
.*                            &LABEL(1) - CHAR. POS. TO BEGIN LABELS.   33030002
.*                            &LABEL(2) - # SPACES BETWEEN LINE'S LABEL 33120002
.*                                 STARTING CHARACTERS.                 33210002
.*                            &SKIP= - # OF LINES TO ADVANCE CARRIAGE   33300002
.*                                 TO BEGIN NEXT PRINTED LINE.          33390002
.*                            NEW ENTRIES ARE GENERATED ONLY WHEN       33480002
.*                                 NECESSARY. OMISSION OF ITEMS MEANS   33570002
.*                                 THEY HAVE NOT CHANGED SINCE PREVIOUS 33660002
.*                                 SETTINGS. A LINE MACRO IS REQUIRED   33750002
.*                                 FOR EACH PRINTED LINE. IF NO SETTING 33840002
.*                                 CHANGES ARE REQUIRED ALL OPERANDS    33930002
.*                                 ARE OMITTED IN WHICH CASE ONLY THE   34020002
.*                                 # OF ENTRIES FOR THE PREVIOUS LINE   34110002
.*                                 IS COMPUTED. THIS MACRO MUST BE THE  34200002
.*                                 FIRST MACRO INSTRUCTION ISSUED FOR   34290002
.*                                 THE SUBJECT LINE                     34380002
         GBLA  &DB,&DT,&LB,&LT,&NRENTS                                  34470002
         GBLA  &LASTCC,&INITIAL                                         34560002
         GBLC  &NRENTSX                                                 34650002
         GBLC  &CARRCON                                                 34740002
         GBLB  &TEST                                                    34830002
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN                               34920002
         LCLA  &S                                                       35010002
         AIF   (&INITIAL EQ 0 OR &DIAGTST EQ 0).DIAGSET                 35100002
         AIF   (&DIAGSET EQ 0).DIAGSET                                  35190002
         MNOTE '**NO LABEL ASSOCIATED WITH LAST SET**'                  35280002
***** THE FOLLOWING GENERATED FOR TEST PURPOSES *****                   35370002
*        LABEL '%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%'       35460002
               LABEL '%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%' 35550002
.DIAGSET ANOP                                                           35640002
&DIAGSET SETB  1                                                        35730002
&DIAGLIN SETB  1                                                        35820002
&NAME    DS    0C                                                       35910002
         AIF   (&INITIAL EQ 0).FIRSTLN                                  36000002
         LINEND                                                         36090002
         AGO   .NTFIRST                                                 36180002
.FIRSTLN ANOP                                                           36270002
&NRENTSX SETC  'N&SYSNDX'                                               36360002
&INITIAL SETA  1                                                        36450002
N&SYSNDX EQU   *                                                        36540002
.NTFIRST ANOP                                                           36630002
         DC    AL1(0)                                                   36720002
         AIF   ('&DATA(1)' EQ '').CKDTABS                               36810002
         AIF   (&DATA(1) EQ &DB).CKDTABS                                36900002
&DB      SETA  &DATA(1)                                                 36990002
         AGO   .AA                                                      37080002
.CKDTABS AIF   ('&DATA(2)' EQ '').NCDATA                                37170002
         AIF   (&DATA(2) EQ &DT).NCDATA                                 37260002
         AGO   .CC                                                      37350002
.AA      AIF   ('&DATA(2)' EQ '').BB                                    37440002
         AIF   (&DATA(2) EQ &DT).BB                                     37530002
.CC      ANOP                                                           37620002
&DT      SETA  &DATA(2)                                                 37710002
.BB      DC    XL2'FFFE'                                                37800002
         DC    FL1'&DB'                                                 37890002
         DC    FL1'&DT'                                                 37980002
&NRENTS  SETA  &NRENTS+1                                                38070002
.NCDATA  ANOP                                                           38160002
         AIF   ('&LABEL(1)' EQ '').CKLTABS                              38250002
         AIF   (&LABEL(1) EQ &LB).CKLTABS                               38340002
&LB      SETA  &LABEL(1)                                                38430002
         AGO   .AAA                                                     38520002
.CKLTABS AIF   ('&LABEL(2)' EQ '').NCLABEL                              38610002
         AIF   (&LABEL(2) EQ &LT).NCLABEL                               38700002
         AGO   .CCC                                                     38790002
.AAA     AIF   ('&LABEL(2)' EQ '').BBB                                  38880002
         AIF   (&LABEL(2) EQ &LT).BBB                                   38970002
.CCC     ANOP                                                           39060002
&LT      SETA  &LABEL(2)                                                39150002
.BBB     DC    XL2'FFFF'                                                39240002
         DC    FL1'&LB'                                                 39330002
         DC    FL1'&LT'                                                 39420002
&NRENTS  SETA  &NRENTS+1                                                39510002
.NCLABEL ANOP                                                           39600002
         AIF   ('&SKIP' NE '').CONT                                     39690002
         AIF   (&TEST EQ 0).NOCHANG                                     39780002
         AGO   .DEFALTA                                                 39870002
.CONT    ANOP                                                           39960002
         AIF   (&TEST EQ 0).AB                                          40050002
         AIF   ('&SKIP' EQ 'E').AB                                      40140002
&S       SETA  &SKIP                                                    40230002
.DEFAULT ANOP                                                           40320002
         AIF   (&SKIP EQ &LASTCC).DEFALTA                               40410002
         ORG   &CARRCON+3                                               40500002
         DC    AL.3(0),AL.2(&S),AL.3(1)                                 40590002
         ORG                                                            40680002
&LASTCC  SETA  &S                                                       40770002
.DEFALTA ANOP                                                           40860002
&TEST    SETB  0                                                        40950002
         AGO   .DD                                                      41040002
.AB      AIF   ('&SKIP' NE 'E').ABB                                     41130002
A&SYSNDX DC    X'FFFB8B00'              EJECT                           41220002
         AGO   .ABC                                                     41310002
.ABB     AIF   (&SKIP EQ &LASTCC).NOCHANG                               41400002
A&SYSNDX DC    XL2'FFFB'                                                41490002
         DC    AL.3(0),AL.2(&SKIP),AL.3(1)                              41580002
         DC    AL.3(0),AL.2(&SKIP),AL.3(1)                              41670002
&LASTCC  SETA  &SKIP                                                    41760002
&TEST    SETB  1                                                        41850002
.ABC     ANOP                                                           41940002
&CARRCON SETC  'A&SYSNDX'                                               42030002
&NRENTS  SETA  &NRENTS+1                                                42120002
.DD      ANOP                                                           42210002
.NOCHANG ANOP                                                           42300002
         MEND                                                           42390002
         EJECT                                                          42480002
         MACRO                                                          42570002
         HEX                                                            42660002
.*                            THIS MACRO FACILITATES GENERATION OF THE  42750002
.*                                 TABLE ENTRIES SPECIFYING HEX TYPE    42840002
.*                                 CONVERSIONS.                         42930002
.*                            &SYSLIST(&OP,1) - NAME OF DATA ITEM TO BE 43020002
.*                                 CONVERTED                            43110002
.*                            &SYSLIST(&OP,2) - # OF SPACES TO SKIP ON  43200002
.*                                 MULTIPLE PRINT OR NBR OF SPACES TO   43290002
.*                                 BACK UP FROM COLUMN FOR START OF     43380002
.*                                 PRINTING. THE LETTER B PRECEEDS THE  43470002
.*                                 NUMBER (B8) IF THE LATTER OPTION IS  43560002
.*                                 DESIRED. OMISSION OF THIS OPERAND    43650002
.*                                 FORCES OPTION 2 WITH BACKUP SPACING  43740002
.*                                 EQUAL TO THE NUMBER OF BYTES SPECI-  43830002
.*                                 FIED BY THE NEXT OPERAND (TWICE THIS 43920002
.*                                 NUMBER IF SUFFIX IS EXPLICITLY OR    44010002
.*                                 IMPLICITLY B).                       44100002
.*                            &SYSLIST(&OP,3) - NUMBER OF BYTES TO      44190002
.*                                 PROCESS. THIS NUMBER IS SUFFIXED     44280002
.*                                 WITH AN L,R, OR B TO STIPULATE       44370002
.*                                 PRINTING OF THE LEFT HALF, RIGHT     44460002
.*                                 HALF, OR BOTH HALVES OF THE BYTE     44550002
.*                                 RESPECTIVELY. OMISSION OF THIS       44640002
.*                                 OPERAND DEFAULTS TO B WITH THE NUM-  44730002
.*                                 BER OF BYTES EQUAL TO THE ITEM LNGTH 44820002
.*                            A NEW ENTRY IS GENERATED ONLY WHEN NECES- 44910002
.*                                 SARY. THIS MACRO MUST BE THE FIRST   45000002
.*                                 MACRO INSTRUCTION ISSUED FOR THE     45090002
.*                                 SUBJECT LINE(S).                     45180002
         GBLC &ITEM(1000),&DSECT                                        45270002
         GBLA &ITEMNBR,&BITS(1000),&SHIFT(1000),&NRENTS                 45360002
         GBLA  &INITIAL                                                 45450002
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN                               45540002
         LCLB  &B,&SUB                                                  45630002
         LCLA  &IBITS,&NDX,&ISHIFT,&K,&T,&CODE,&BYTESP,&OP              45720002
         LCLC  &S,&LETTER                                               45810002
         AIF   (&DIAGTST EQ 0).NOMSG                                    45900002
         AIF   (&INITIAL EQ 0).NOMSG                                    45990002
         AIF   (&DIAGLIN EQ 1).NOMSG                                    46080002
         MNOTE '**NO LINE ASSOCIATED WITH THIS DATA**'                  46170002
*****THE FOLLOWING GENERATED FOR TEST PURPOSES*****                     46260002
*        LINE                                                           46350002
         LINE                                                           46440002
.NOMSG   ANOP                                                           46530002
         AIF   (K'&SYSLIST(1) EQ K'&SYSLIST(1,1)).LOOP                  46620002
&SUB     SETB  1                                                        46710002
.LOOP    ANOP                                                           46800002
&OP      SETA  &OP+1                                                    46890002
.LOOP1   ANOP                                                           46980002
&NDX     SETA  &NDX+1                                                   47070002
         AIF   ('&ITEM(&NDX)' EQ '&SYSLIST(&OP,1)').FOUND               47160002
         AIF   (&NDX LT &ITEMNBR).LOOP1                                 47250002
         MNOTE '**LOG ITEM NOT DEFINED**'                               47340002
         MEXIT                                                          47430002
.FOUND   ANOP                                                           47520002
&ISHIFT  SETA  &SHIFT(&NDX)                                             47610002
&IBITS   SETA  &BITS(&NDX)                                              47700002
         AIF   (&ISHIFT EQ 0 OR &ISHIFT EQ 4).ALIGN                     47790002
.ERR     MNOTE '**DATA NOT ALLIGNED ON HEX OR BYTE BOUNDARY**'          47880002
         MEXIT                                                          47970002
.ALIGN   ANOP                                                           48060002
&CODE    SETA  1                                                        48150002
         AIF   (&SUB EQ 1).SUBA                                         48240002
&K       SETA  K'&SYSLIST(3)                                            48330002
         AGO   .SUBB                                                    48420002
.SUBA    ANOP                                                           48510002
&K       SETA  K'&SYSLIST(&OP,3)                                        48600002
.SUBB    ANOP                                                           48690002
         AIF   (&SUB EQ 1).SUBC                                         48780002
         AIF   ('&SYSLIST(3)' EQ '').USEDEFN                            48870002
&LETTER  SETC  '&SYSLIST(3)'(&K,1)                                      48960002
&S       SETC  '&SYSLIST(3)'(1,&K-1)                                    49050002
         AGO   .SUBD                                                    49140002
.SUBC    ANOP                                                           49230002
         AIF   ('&SYSLIST(&OP,3)' EQ '').USEDEFN                        49320002
&LETTER  SETC  '&SYSLIST(&OP,3)'(&K,1)                                  49410002
&S       SETC  '&SYSLIST(&OP,3)'(1,&K-1)                                49500002
.SUBD    ANOP                                                           49590002
&BYTESP  SETA  &S                                                       49680002
         AIF   ('&LETTER' EQ 'B').BOTH                                  49770002
         AIF   ('&LETTER' EQ 'L').LEFT                                  49860002
&CODE    SETA  2                                                        49950002
         AGO   .L                                                       50040002
.LEFT    ANOP                                                           50130002
&CODE    SETA  1                                                        50220002
         AGO   .L                                                       50310002
.USEDEFN ANOP                                                           50400002
         AIF   (&IBITS-(&IBITS/4)*4 EQ 0).OK                            50490002
         MNOTE '**BIT LENGTH SPECIFICATION INCONSISTENT WITH CONTROL**' 50580002
         MEXIT                                                          50670002
.OK      ANOP                                                           50760002
&BYTESP  SETA  &IBITS/8                                                 50850002
.BOTH    AIF   (&ISHIFT NE 0).ERR                                       50940002
&CODE    SETA  3                                                        51030002
&T       SETA  &BYTESP*2-1                                              51120002
&S       SETC  '&T'                                                     51210002
.OK2     AIF   (&ISHIFT EQ 0).L                                         51300002
&CODE    SETA  2                                                        51390002
.L       ANOP                                                           51480002
&B       SETB  1                                                        51570002
         AIF   (&SUB EQ 1).SUBE                                         51660002
         AIF   ('&SYSLIST(2)' EQ '').BACKUP                             51750002
&K       SETA  K'&SYSLIST(2)                                            51840002
&B       SETB  ('&SYSLIST(2)'(1,1) EQ 'B')                              51930002
&S       SETC  '&SYSLIST(2)'(&B+1,&K-&B)                                52020002
         AGO   .SUBF                                                    52110002
.SUBE    ANOP                                                           52200002
         AIF   ('&SYSLIST(&OP,2)' EQ '').BACKUP                         52290002
&K       SETA  K'&SYSLIST(&OP,2)                                        52380002
&B       SETB  ('&SYSLIST(&OP,2)'(1,1) EQ 'B')                          52470002
&S       SETC  '&SYSLIST(&OP,2)'(&B+1,&K-&B)                            52560002
.SUBF    ANOP                                                           52650002
.BACKUP  ANOP                                                           52740002
&NRENTS  SETA  &NRENTS+1                                                52830002
         AIF   (&BYTESP GT 0 AND &BYTESP LT 16).SUB0                    52920002
         MNOTE '**NO. OF BYTES OUTSIDE RANGE OF 1-15**'                 53010002
         MEXIT                                                          53100002
.SUB0    AIF   (&SUB EQ 1).SUBG                                         53190002
         DC    AL.12(&SYSLIST(1)-&DSECT),XL.4'A'                        53280002
         AGO   .SUBH                                                    53370002
.SUBG    ANOP                                                           53460002
         DC    AL.12(&SYSLIST(&OP,1)-&DSECT),XL.4'A'                    53550002
.SUBH    ANOP                                                           53640002
         DC    BL.1'&B',FL.7'&S',AL.4(&BYTESP),FL.4'&CODE'              53730002
.OUT     ANOP                                                           53820002
&NDX     SETA  0                                                        53910002
         AIF   (&SUB EQ 0).OUTA                                         54000002
         AIF   (&OP LT N'&SYSLIST).LOOP                                 54090002
.OUTA    ANOP                                                           54180002
         MEND                                                           54270002
         EJECT                                                          54360002
         MACRO                                                          54450002
&NAME    LABEL &LABEL1,&LABEL2,&LABEL3,&LABEL4,&LABEL5,&LABEL6,        C54540002
               &LABEL7,&LABEL8                                          54630002
.*                                 THIS MACRO ALLOWS LABELS TO          54720002
.*                                 BE SPECIFIED FOR A GIVEN LINE. THE   54810002
.*                                 LABELS SHOULD BE ENCLOSED IN QUOTA-  54900002
.*                                 TION MARKS. THE COLUMN AND LINE END  54990002
.*                                 CONTROLS WILL BE INSERTED BY THE     55080002
.*                                 MACRO. OMITTED OPERANDS MEAN NO      55170002
.*                                 LABEL REQUIRED FOR RESPECTIVE        55260002
.*                                 COLUMN.                              55350002
         GBLC &LABELS(2000)                                             55440002
         GBLC  &LBL(100)                                                55530002
         GBLA  &LBLCTR(100)                                             55620002
         GBLA  &LABELNR                                                 55710002
         GBLA  &NRENTS,&LPTR,&INITIAL                                   55800002
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN                               55890002
         LCLC  &MARGIN,&TACK                                            55980002
         LCLC  &TEXT                                                    56070002
         LCLA  &OP,&K,&START,&NRCHAR,&REMAIN                            56160002
         AIF   (&INITIAL EQ 0).DIAGCLR                                  56250002
         AIF   (&DIAGTST EQ 0).DIAGCLR                                  56340002
         AIF   (&DIAGLIN EQ 1).DIAGCLR                                  56430002
         MNOTE '**NO LINE ASSOCIATED WITH PREVIOUS LABEL**'             56520002
***** THE FOLLOWING GENERATED FOR TEST PURPOSES *****                   56610002
*        LINE                                                           56700002
         LINE                                                           56790002
.DIAGCLR ANOP                                                           56880002
&DIAGSET SETB  0                                                        56970002
&DIAGLIN SETB  0                                                        57060002
&MARGIN  SETC  '*'                                                      57150002
         AIF   ('&NAME' EQ '').LOOPOUT                                  57240002
&LPTR    SETA  &LPTR+1                                                  57330002
&LBL(&LPTR) SETC '&NAME'                                                57420002
&LBLCTR(&LPTR) SETA &LABELNR+1                                          57510002
.LOOPOUT ANOP                                                           57600002
&OP      SETA  &OP+1                                                    57690002
&K       SETA  K'&SYSLIST(&OP)                                          57780002
         AIF (&K GE 2).NORM                                             57870002
&K       SETA  2                                                        57960002
.NORM    ANOP                                                           58050002
&START   SETA  2                                                        58140002
         AIF (&OP LT N'&SYSLIST).NOTLAST                                58230002
&MARGIN  SETC  '$'                                                      58320002
.NOTLAST ANOP                                                           58410002
&NRCHAR  SETA  8                                                        58500002
&TACK    SETC  ''                                                       58590002
.LOOPIN  ANOP                                                           58680002
&REMAIN  SETA  &K-&START                                                58770002
         AIF (&REMAIN GE 8).MORE                                        58860002
&TACK    SETC  '&MARGIN'                                                58950002
&NRCHAR  SETA  &REMAIN                                                  59040002
.MORE    ANOP                                                           59130002
&TEXT    SETC  ''                                                       59220002
         AIF (&REMAIN EQ 0).ENDTEXT                                     59310002
&TEXT    SETC  '&SYSLIST(&OP)'(&START,&NRCHAR)                          59400002
.ENDTEXT ANOP                                                           59490002
&LABELNR SETA  &LABELNR+1                                               59580002
&LABELS(&LABELNR) SETC '&TEXT'.'&TACK'                                  59670002
&START   SETA  &START+8                                                 59760002
         AIF ('&TACK' EQ '').LOOPIN                                     59850002
         AIF ('&TACK' EQ '*').LOOPOUT                                   59940002
         MEND                                                           60030002
         EJECT                                                          60120002
         GBLC  &CSECT,&DSECT                                            60210002
IFCETRN5 CSECT                                                          60300002
&CSECT   SETC  'IFCETRN5'                                               60390002
&DSECT   SETC  'C3705'                                                  60480002
C3705    DSECT                                                          60570002
         DS    0F                                                       60660002
*                                                                       60750002
         DSGEN (RECT,8),(OPSYS,8),(SWITCH,24),(RCDID,8),(SPARE1,16)     60840002
         DSGEN (DATE,32),(TIME,32)                                      60930002
         DSGEN (SPARE2,8),(CPUSER,24),(MODEL,16),(SPARE3,16)            61020002
         DSGEN (CUA,16),(NETNAME,64)                                    61110002
         DSGEN  (NETADR,16),(LIBADR,16),(RECMD,8),(RECID,8)             61200002
         DSGEN (ISBOX,8),(BTUMOD,8),(REG100,1),(REG101,1),(REG102,1),  C61290002
               (REG103,1),(REG104,1),(REG105,1),(REG106,1),(REG107,1), C61380002
               (REG108,1),(REG109,1),(REG110,1),(REG111,1),(REG112,1), C61470002
               (REG113,1),(REG114,1),(REG115,1),(REG200,1),(REG201,1), C61560002
               (REG202,1),(REG203,1),(REG204,1),(REG205,1),(REG206,1), C61650002
               (REG207,1),(REG208,1),(REG209,1),(REG210,1),(REG211,1), C61740002
               (REG212,1),(REG213,1),(REG214,1),(REG215,1),(REG300,1), C61830002
               (REG301,1),(REG302,1),(REG303,1),(REG304,1),(REG305,1), C61920002
               (REG306,1),(REG307,1),(REG308,1),(REG309,1),(REG310,1), C62010002
               (REG311,1),(REG312,1),(REG313,1),(REG314,1),(REG315,1)   62100002
         DSGEN (REG400,1),(REG401,1),(REG402,1),(REG403,1),(REG404,1), C62190002
               (REG405,1),(REG406,1),(REG407,1),(REG408,1),(REG409,1), C62280002
               (REG410,1),(REG411,1),(REG412,1),(REG413,1),(REG414,1), C62370002
               (REG415,1),(REG500,1),(REG501,1),(REG502,1),(REG503,1), C62460002
               (REG504,1),(REG505,1),(REG506,1),(REG507,1),(REG508,1), C62550002
               (REG509,1),(REG510,1),(REG511,1),(REG512,1),(REG513,1), C62640002
               (REG514,1),(REG515,1)                                    62730002
         DSGEN (REG600,1),(REG601,1),(REG602,1),(REG603,1),(REG604,1), C62820002
               (REG605,1),(REG606,1),(REG607,1),(REG608,1),(REG609,1), C62910002
               (REG610,1),(REG611,1),(REG612,1),(REG613,1),(REG614,1), C63000002
               (REG615,1),(REG700,1),(REG701,1),(REG702,1),(REG703,1), C63090002
               (REG704,1),(REG705,1),(REG706,1),(REG707,1),(REG708,1), C63180002
               (REG709,1),(REG710,1),(REG711,1),(REG712,1),(REG713,1), C63270002
               (REG714,1),(REG715,1)                                    63360002
         DSGEN (REG800,1),(REG801,1),(REG802,1),(REG803,1),(REG804,1), C63450002
               (REG805,1),(REG806,1),(REG807,1),(REG808,1),(REG809,1), C63540002
               (REG810,1),(REG811,1),(REG812,1),(REG813,1),(REG814,1), C63630002
               (REG815,1),(REG900,1),(REG901,1),(REG902,1),(REG903,1), C63720002
               (REG904,1),(REG905,1),(REG906,1),(REG907,1),(REG908,1), C63810002
               (REG909,1),(REG910,1),(REG911,1),(REG912,1),(REG913,1), C63900002
               (REG914,1),(REG915,1)                                    63990002
         DSGEN (REG1000,1),(REG1001,1),(REG1002,1),(REG1003,1),        C64080002
               (REG1004,1),(REG1005,1),(REG1006,1),(REG1007,1),        C64170002
               (REG1008,1),(REG1009,1),(REG1010,1),(REG1011,1),        C64260002
               (REG1012,1),(REG1013,1),(REG1014,1),(REG1015,1)          64350002
         DSGEN (REG1100,1),(REG1101,1),(REG1102,1),(REG1103,1),        C64440002
               (REG1104,1),(REG1105,1),(REG1106,1),(REG1107,1),        C64530002
               (REG1108,1),(REG1109,1),(REG1110,1),(REG1111,1),        C64620002
               (REG1112,1),(REG1113,1),(REG1114,1),(REG1115,1)          64710002
         DSGEN (REG1200,1),(REG1201,1),(REG1202,1),(REG1203,1),        C64800002
               (REG1204,1),(REG1205,1),(REG1206,1),(REG1207,1),        C64890002
               (REG1208,1),(REG1209,1),(REG1210,1),(REG1211,1),        C64980002
               (REG1212,1),(REG1213,1),(REG1214,1),(REG1215,1)          65070002
         DSGEN (REG1300,1),(REG1301,1),(REG1302,1),(REG1303,1),        C65160002
               (REG1304,1),(REG1305,1),(REG1306,1),(REG1307,1),        C65250002
               (REG1308,1),(REG1309,1),(REG1310,1),(REG1311,1),        C65340002
               (REG1312,1),(REG1313,1),(REG1314,1),(REG1315,1)          65430002
         DSGEN (REG1400,1),(REG1401,1),(REG1402,1),(REG1403,1),        C65520002
               (REG1404,1),(REG1405,1),(REG1406,1),(REG1407,1),        C65610002
               (REG1408,1),(REG1409,1),(REG1410,1),(REG1411,1),        C65700002
               (REG1412,1),(REG1413,1),(REG1414,1),(REG1415,1)          65790002
         DSGEN (REG1500,1),(REG1501,1),(REG1502,1),(REG1503,1),        C65880002
               (REG1504,1),(REG1505,1),(REG1506,1),(REG1507,1)          65970002
         EJECT                                                          66060001
IFCETRN5 CSECT                                                          66150002
         USING *,R9                                                     66240002
         USING C3705,R2                                                 66330002
***** CONSTANTS ****                                                    66420002
*                                                                       66510002
         DC    A(ENTRIES)                                               66600002
         DC    CL8'IFCETRN5'                                            66690002
XR9PTR   DC    F'0'                                                     66780002
XLABELP  DC    F'0'                                                     66870002
XSAVE    DC    2F'0'                                                    66960001
ZERO     DC    X'000000'                                                67050002
WORK     DC    D'0'                                                     67140002
H00      EQU   X'00'                                                    67230002
H01      EQU   X'01'                                                    67320002
H02      EQU   X'02'                                                    67410002
H03      EQU   X'03'                                                    67500002
H04      EQU   X'04'                                                    67590002
H05      EQU   X'05'                                                    67680002
H07      EQU   X'07'                                                    67770002
H08      EQU   X'08'                                                    67860002
H10      EQU   X'10'                                                    67950002
H20      EQU   X'20'                                                    68040002
H40      EQU   X'40'                                                    68130002
H70      EQU   X'70'                                                    68220002
H80      EQU   X'80'                                                    68310002
HFF     EQU    X'FF'                                                    68400002
*                                                                       68490002
L0       EQU   0                                                        68580002
L1       EQU   1                                                        68670002
L2       EQU   2                                                        68760002
L3       EQU   3                                                        68850002
L4       EQU   4                                                        68940002
L5       EQU   5                                                        69030002
L6       EQU   6                                                        69120002
L7       EQU   7                                                        69210002
L8       EQU   8                                                        69300002
L9       EQU   9                                                        69390002
L10      EQU   10                                                       69480002
L11      EQU   11                                                       69570002
L12      EQU   12                                                       69660002
L13      EQU   13                                                       69750002
L14      EQU   14                                                       69840002
L15      EQU   15                                                       69930002
L16      EQU   16                                                       70020002
L17      EQU   17                                                       70110002
L18      EQU   18                                                       70200002
L19      EQU   19                                                       70290002
L20      EQU   20                                                       70380002
L21      EQU   21                                                       70470002
L23      EQU   23                                                       70560002
L24     EQU    24                                                       70650002
L25     EQU    25                                                       70740002
L26      EQU   26                                                       70830002
L27      EQU   27                                                       70920002
L28      EQU   28                                                       71010002
L29      EQU   29                                                       71100002
L33      EQU   23                                                       71190002
L31      EQU   31                                                       71220001
L35      EQU   35                                                       71250001
*                                                                       71280002
R1       EQU   1                                                        71370002
R2       EQU   2                                                        71460002
R3       EQU   3                                                        71550002
R4       EQU   4                                                        71640002
R5       EQU   5                                                        71730002
R6       EQU   6                                                        71820002
R7       EQU   7                                                        71910002
R8       EQU   8                                                        72000002
R9       EQU   9                                                        72090002
R10      EQU   10                                                       72180002
R11      EQU   11                                                       72270002
R12      EQU   12                                                       72360002
R13      EQU   13                                                       72450002
R14      EQU   14                                                       72540002
R15      EQU   15                                                       72630002
         EJECT                                                          72720001
*********************************************************************** 72760001
**                       SPECIAL ROUTINES                            ** 72800001
*********************************************************************** 72840001
HEXDUMP  ST    R5,XSAVE                                                 72880001
         LA    R5,L2                                                    72920001
         SR    R2,R5                                                    72960001
         MVC   LENGTH(L2),0(R2)                                         73000001
         AR    R2,R5                                                    73040001
         L     R5,XSAVE                                                 73080001
         BR    R14                                                      73120001
         SPACE 3                                                        73160001
CCBIT6   TM    REG1314,H02                                              73200001
         BO    SECOND                                                   73240001
         MVC   L0(L3,R3),PRI                                            73280001
         BR    R14                                                      73320001
SECOND   MVC   L0(L3,R3),SEC                                            73360001
         BR    R14                                                      73400001
         SPACE 3                                                        73440001
TEST2STA CLC   REG1400(L3),ZERO                                         73480001
         BER   R14                                                      73520001
         MVC   XR9PTR(L8),LIN0                                          73560001
         BR    R14                                                      73600001
LIN0     DC    A(LINZERO-4)                                             73640001
         DC    A(LABZERO-1)                                             73680001
         SPACE 3                                                        73720001
LINKERR  TM    RECMD,1                        LINK ERROR?               73760001
         BZR   R14                            YES...CARRY ON            73800001
         XR    R15,R15                        DON'T PRINT THIS LINE     73840001
         BR    R14                            RETURN                    73880001
         SPACE 3                                                        73920001
STNERR   TM    RECMD,1                        STATION ERROR?            73960001
         BOR   R14                            YES...CARRY ON            74000001
         XR    R15,R15                        DON'T PRINT THIS LINE     74040001
         BR    R14                            RETURN                    74080001
         SPACE 3                                                        74120001
LXBSTAT  TM    L0(R4),X'80'                                             74160001
         BO    TEST1                                                    74200001
         TM    L0(R4),X'9E'                                             74240001
         BZ    INCFM                                                    74280001
NOPRT    XR    R15,R15                                                  74320001
         BR    R14                                                      74360001
INCFM    MVC   L0(L35,R3),TOIFR                                         74400001
         BR    R14                                                      74440001
TEST1    TM    L0(R4),X'7E'                                             74480001
         BNZ   TEST2                                                    74520001
         MVC   L0(L26,R3),TONR                                          74560001
         BR    R14                                                      74600001
TEST2    TM    L0(R4),X'5E'                                             74640001
         BZ    INCFM                                                    74680001
         TM    L0(R4),X'F0'                                             74720001
         BNO   TEST3                                                    74760001
         MVC   L0(L31,R3),SMIE                                          74800001
         BR    R14                                                      74840001
TEST3    TM    L0(R4),X'E0'                                             74880001
         BNO   NOPRT                                                    74920001
         MVC   L0(L28,R3),STHE                                          74960001
         BR    R14                                                      75000001
TOIFR    DC    C'TIME-OUT, INCOMPLETE FRAME RECEIVED'                   75040001
TONR     DC    C'TIME-OUT, NOTHING RECEIVED'                            75080001
SMIE     DC    C'SUSPECTED MODEM INTERFACE ERROR'                       75120001
STHE     DC    C'SUSPECTED TCU HARDWARE ERROR'                          75160001
         SPACE 3                                                        75200001
BRFIN    STM   R5,R6,XSAVE                                              75240001
         B     FIN                                                      75330002
MOVNAME  MVC   L0(L8,R3),L0(R4)                                         75420002
        BR     R14                                                      75510002
         SPACE 3                                                        75600001
ISMOD03  STM   R5,R6,XSAVE                                              75640001
        TM     L0(R4),H03                                               75690002
         BOR   R14                                                      75780001
FIN      LA     R5,SKIPLN03-4                                           75870002
        LA      R6,SKIPLB03-1                                           75960002
         STM   R5,R6,XR9PTR                                             76050001
         LM    R5,R6,XSAVE                                              76140001
         BR    R14                                                      76230001
         SPACE 3                                                        76320001
RTNR     ST    R6,XSAVE                                                 76410001
         SR    R6,R6                                                    76500002
         IC    R6,L0(R4)                                                76590002
         SLL   R6,L28                                                   76680002
         SRL   R6,L29                                                   76770002
CONVRT   CVD   R6,WORK                                                  76860002
         UNPK  L0(L2,R3),WORK+L6(L2)                                    76950002
         MVZ   L1(L1,R3),L0(R3)                                         77040002
         L     R6,XSAVE                                                 77130001
         BR    R14                                                      77190001
         SPACE 3                                                        77250001
RTNS     ST    R6,XSAVE                                                 77310001
         SR    R6,R6                                                    77400002
         IC    R6,L0(R4)                                                77490002
         SRL   R6,L5                                                    77580001
         B     CONVRT                                                   77760002
*                                                                       77850002
PRI     DC     C'PRI'                                                   77940002
SEC     DC    C'SEC'                                                    78030002
        DC     X'01'                                                    78120002
        DC     X'000B0B00'                                              78210002
         EJECT                                                          78300001
ENTRIES DS     0F                                                       78390002
        DC     XL4'00010001'                                            78480002
        DC     XL4'00010001'                                            78570002
        DC     A(LABELS)                                                78660002
        DC     H'0'                                                     78750002
         DC     X'01'                                                   78840002
         DC     X'000B0B00'                                             78930002
*                                                                       79020002
        LINE   (23,23),(2,31),SKIP=2                                    79110002
        HEX    NETADR,0,2B                                              79200002
        ROUTINE    NETNAME,MOVNAME                                      79290002
         LABEL 'NETWORK ADDRESS','NETWORK NAME'                         79380002
*                                                                       79470002
         LINE                                                           79560002
         ROUTINE RECMD,LINKERR                                          79650001
         LABEL 'RECORD TYPE - PERMANENT SDLC LINK ERROR'                79740001
         SPACE 3                                                        79760001
         LINE                                                           79780001
         ROUTINE RECMD,STNERR                                           79800001
         LABEL 'RECORD TYPE - PERMANENT SDLC STATION ERROR'             79820001
         SPACE 3                                                        79840001
         LINE  (2,1)                                                    79860001
         ROUTINE REG408,LXBSTAT                                         79880001
         LABEL ''                                                       79900001
         SPACE 3                                                        79920001
         LINE  (23,23)                                                  79940001
         HEX   LIBADR,0,2B                                              80010002
         LABEL 'LIB ADDR'                                               80100002
*                                                                       80190002
         LINE  ,(3),SKIP=2                                              80280002
         LABEL 'LINK INFORMATION'                                       80460002
*                                                                       80550002
         LINE  (31,40),(4,37),SKIP=1                                    80640002
         HEX   (REG1300,0,1B),(REG200,0,1B),(REG400,0,2B)               80730002
         LABEL 'CCB CONTROL FLG','LXB COMMAND','LXB FINAL ERROR STATUS' 80820001
         SPACE 3                                                        80920001
         LINE                                                           81090002
         HEX   (REG1308,0,1B),(REG208,0,2B),(REG500,0,1B)               81180002
         LABEL 'CCB LINE TYPE','LXB MODIFIERS','LXB FINAL ERR EXT STATU*81270001
               S'                                                       81360001
         SPACE 3                                                        81450001
         LINE  (71,40),(41,37)                                          81540002
         HEX   (REG308,0,1B),(REG508,0,2B)                              81630002
         LABEL 'LXB IMMED. CTL CMD','LXB INITIAL ERROR STATUS'          81720001
         SPACE 3                                                        81810001
         LINE  (111),(78),SKIP=2                                        81900002
         HEX   (REG608,0,1B)                                            81990002
         LABEL 'LXB INITIAL ERR EXT STATUS'                             82080001
         SPACE 3                                                        82170001
         LINE  ,(4,27)                                                  82260002
         LABEL 'FINAL ERR BIT DECODE','FINAL ERR EXT STAT','INITIAL ERR*82440001
                BIT DECODE','INITIAL ERR EXT STAT'                      82530001
         SPACE 3                                                        82620001
         LINE  (26,27),(4,27),SKIP=1                                    82710002
         BIN   (REG400),(REG500),(REG508),(REG608)                      82800002
         LABEL 'EXTENDED ERR STAT FLG','OVERRUN/UNDERRUN FLAG','EXTENDEC82890002
               D ERR STAT FLG','OVERRUN/UNDERRUN FLAG'                  82980002
*                                                                       83070002
         LINE                                                           83160002
         BIN   (REG401),(REG504),(REG509),(REG612)                      83250002
         LABEL 'FORMAT EXCEPTION FLG','BLOCK OVERRUN','FORMAT EXCEPTIONC83340002
                FLG','BLOCK OVERRUN'                                    83430002
*                                                                       83520002
         LINE                                                           83610002
         BIN   (REG402),(REG506),(REG510),(REG614)                      83700002
         LABEL ,'ABORT',,'ABORT'                                        83790001
         SPACE 3                                                        83880001
         LINE                                                           83970002
         BIN   (REG403),(REG507),(REG511),(REG615)                      84060002
         LABEL 'DATA CHECK','MONITOR COUNT OVERFLO','DATA CHECK','MONITC84150002
               OR COUNT OVERFLO'                                        84240002
*                                                                       84330002
         LINE  (26,54),(4,54)                                           84420002
         BIN   (REG415),(REG607)                                        84510002
         LABEL 'SDLC POLL FINAL BIT','SDLC POLL FINAL BIT'              84600002
         LINE                                                           84690002
         ROUTINE   RECMD,ISMOD03                                        84780002
         LABEL ''                                                       84870002
*                                                                       84960002
*                                                                       85050002
         LINE  (8),(2,10),SKIP=2                                        85140002
         ROUTINE   REG1314,CCBIT6                                       85230002
         LABEL 'LOCAL','STATION INFORMATION'                            85320002
*                                                                       85410002
         LINE                                                           85500002
         ROUTINE   REG1400,TEST2STA                                     85590002
         LABEL ''                                                       85680002
*                                                                       85770002
*                                                                       85860002
         LINE  (31),(4),SKIP=1                                          85950002
         HEX   REG1000,0,1B                                             86040002
         LABEL 'SCB STATION TYPE'                                       86130001
         SPACE 3                                                        86220001
         LINE                                                           86310002
         HEX   ISBOX,0,2B                                               86400002
         LABEL 'SCB SERV. SEEKING CMD FLGS'                             86490001
         SPACE 3                                                        86580001
         LINE                                                           86670002
         HEX   REG100,0,1B                                              86760002
         LABEL 'SCB OUTPUT CONTROL FLAGS'                               86850002
*                                                                       86940002
         LINE                                                           87030002
         HEX   REG1008,0,1B                                             87120002
         LABEL 'XMTD BLU CMD FLD'                                       87210002
*                                                                       87300002
         LINE                                                           87390002
         HEX   REG808,0,1B                                              87480002
         LABEL 'RCVD BLU CMD FLD'                                       87570002
*                                                                       87660002
         LINE                                                           87750002
         ROUTINE   REG1200,RTNR                                         87840002
         LABEL 'N(R)'                                                   87930002
*                                                                       88020002
         LINE                                                           88110002
         ROUTINE   REG1208,RTNR                                         88200002
         LABEL 'N(S)'                                                   88290002
*                                                                       88380002
         LINE                                                           88470002
         CONVT REG1100,1,3                                              88560002
         LABEL 'SCB CRNT OUTSTANDING CNT'                               88650001
         SPACE 3                                                        88740001
         LINE                                                           88830002
         CONVT REG1108,1,3                                              88920002
         LABEL 'SCB PASS COUNT'                                         89010002
*                                                                       89100002
         LINE                                                           89190002
         CONVT REG700,2,6                                               89280002
         LABEL 'SCB I-FORMAT TRANSMIT CNT'                              89370002
*                                                                       89460002
         LINE                                                           89550002
         CONVT REG800,1,3                                               89640002
         LABEL 'SCB RETRY COUNT'                                        89730001
         SPACE 3                                                        89820001
         LINE                                                           89910002
         ROUTINE  REG100,BRFIN                                          90000002
         LABEL ''                                                       90090002
*                                                                       90180002
LINZERO  LINE  ,(58),SKIP=2                                             90270002
LABZERO  LABEL 'DOWN LINE SEC STATION INFORMATION'                      90450002
*                                                                       90540002
         LINE  (31,60),(4,56),SKIP=1                                    90630002
         HEX   (REG1000,0,1B),(REG1400,0,1B)                            90720002
         LABEL 'SCB DEVICE TYPE','SECONDARY STATION CMD FLD RCVD'       90810002
*                                                                       90900002
         LINE                                                           90990002
         HEX   ISBOX,0,2B                                               91080002
         ROUTINE   REG1408,RTNS                                         91170002
         LABEL 'SCB LINK SCHEDULING FLGS','N(R)'                        91260002
*                                                                       91350002
         LINE                                                           91440002
         HEX   REG100,0,1B                                              91530002
         ROUTINE   REG1408,RTNR                                         91620002
         LABEL 'SCB OUTPUT CONTROL FLAGS','N(S)'                        91710002
*                                                                       91800002
         LINE                                                           91890002
         HEX  (REG1008,0,1B),(REG1500,0,1B)                             91980002
         LABEL 'XMTD BLU CMD FLD','COMMAND REJECT REASON'               92070002
*                                                                       92160002
         LINE                                                           92250002
         HEX   REG808,0,1B                                              92340002
         LABEL 'RCVD BLU CMD FLD'                                       92430002
*                                                                       92520002
         LINE  (31,60),(4,58)                                           92610002
         ROUTINE   REG1200,RTNR                                         92700002
         BIN   REG1504                                                  92790002
         LABEL 'N(R)','INVALID N(R) OUT OF RANGE'                       92880002
*                                                                       92970002
         LINE                                                           93060002
         ROUTINE   REG1208,RTNR                                         93150002
         BIN   REG1505                                                  93240002
          LABEL 'N(S)','FRAME TOO LONG FOR BUFF'                        93330002
*                                                                       93420002
         LINE                                                           93510002
         CONVT REG1100,1,3                                              93600002
         BIN   REG1506                                                  93690002
         LABEL 'SCB BLKS OUTSTANDING CNT','DATA RCVD ON OR NS FORMAT'   93780002
*                                                                       93870002
         LINE                                                           93960002
         CONVT REG1108,1,3                                              94050002
         BIN   REG1507                                                  94140002
         LABEL 'SCB PASS COUNT','INVALID CMD OR NOT IMPL'               94230002
*                                                                       94320002
         LINE                                                           94410002
         CONVT REG700,2,6                                               94500002
         LABEL 'SCB I-FORMAT TRANSMIT CNT'                              94590002
*                                                                       94680002
         LINE  ,,SKIP=2                                                 94770002
         CONVT REG800,1,3                                               94860002
         LABEL 'SCB XMIT TEMP ERR COUNT'                                94950002
*                                                                       95040002
SKIPLN03 LINE  ,,SKIP=1                                                 95130002
         ROUTINE   REG100,HEXDUMP                                       95220002
SKIPLB03 LABEL ''                                                       95310002
*                                                                       95400002
         DC    X'FF'                                                    95490002
LENGTH   DC    XL2'003C'                                                95580002
         DC    XL2'0018'                                                95670002
         DC    XL2'0018'                                                95760002
LABELS   DS    0F                                                       95850002
         DC    C'$'                                                     95940002
         LSTART                                                         96030002
         END                                                            96120002
07610                                                                   96210002
L 74L 7431                                                              96300002
