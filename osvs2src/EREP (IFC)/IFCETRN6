         TITLE 'IFCETRN6 FOR EREP SUPPORT OF 3705/27RN'                 00050000
         GBLC  &CSECT,&DSECT                                            00100000
         PROLOG NAME=IFCETRN6                                           00150000
         DSGEN (RECT,8),(OPSYS,8),(SWITCH,24),(RCDID,8),(SPARE1,16)     00200000
         DSGEN (DATE,32),(TIME,32)                                      00250000
         DSGEN (SPARE2,8),(CPUSER,24),(MODEL,16),(SPARE3,16)            00300000
         DSGEN (CUA,16),(NETNAME,64)                                    00350000
         DSGEN (NETADR,16),(LIBADR,16),(RECMD,8),(RECID,8)              00400000
         DSGEN (ISBOX,8),(BTUMOD,8),(RSVD,32)                           00450000
         DSGEN (REG100,1),(REG101,1),(REG102,1),                       C00500000
               (REG103,1),(REG104,1),(REG105,1),(REG106,1),(REG107,1), C00550000
               (REG108,1),(REG109,1),(REG110,1),(REG111,1),(REG112,1), C00600000
               (REG113,1),(REG114,1),(REG115,1),(REG200,1),(REG201,1), C00650000
               (REG202,1),(REG203,1),(REG204,1),(REG205,1),(REG206,1), C00700000
               (REG207,1),(REG208,1),(REG209,1),(REG210,1),(REG211,1), C00750000
               (REG212,1),(REG213,1),(REG214,1),(REG215,1),(REG300,1), C00800000
               (REG301,1),(REG302,1),(REG303,1),(REG304,1),(REG305,1), C00850000
               (REG306,1),(REG307,1),(REG308,1),(REG309,1),(REG310,1), C00900000
               (REG311,1),(REG312,1),(REG313,1),(REG314,1),(REG315,1)   00950000
         DSGEN (REG400,1),(REG401,1),(REG402,1),(REG403,1),(REG404,1), C01000000
               (REG405,1),(REG406,1),(REG407,1),(REG408,1),(REG409,1), C01050000
               (REG410,1),(REG411,1),(REG412,1),(REG413,1),(REG414,1), C01100000
               (REG415,1),(REG500,1),(REG501,1),(REG502,1),(REG503,1), C01150000
               (REG504,1),(REG505,1),(REG506,1),(REG507,1),(REG508,1), C01200000
               (REG509,1),(REG510,1),(REG511,1),(REG512,1),(REG513,1), C01250000
               (REG514,1),(REG515,1)                           @D3502BL 01300000
         DSGEN (REG600,1),(REG601,1),(REG602,1),(REG603,1),(REG604,1), C01350000
               (REG605,1),(REG606,1),(REG607,1),(REG608,1),(REG609,1), C01400000
               (REG610,1),(REG611,1),(REG612,1),(REG613,1),(REG614,1), C01450000
               (REG615,1),(REG700,1),(REG701,1),(REG702,1),(REG703,1), C01500000
               (REG704,1),(REG705,1),(REG706,1),(REG707,1),(REG708,1), C01550000
               (REG709,1),(REG710,1),(REG711,1),(REG712,1),(REG713,1), C01600000
               (REG714,1),(REG715,1)                           @D3502BL 01650000
         DSGEN (REG800,1),(REG801,1),(REG802,1),(REG803,1),(REG804,1), C01700000
               (REG805,1),(REG806,1),(REG807,1),(REG808,1),(REG809,1), C01750000
               (REG810,1),(REG811,1),(REG812,1),(REG813,1),(REG814,1), C01800000
               (REG815,1),(REG900,1),(REG901,1),(REG902,1),(REG903,1), C01850000
               (REG904,1),(REG905,1),(REG906,1),(REG907,1),(REG908,1), C01900000
               (REG909,1),(REG910,1),(REG911,1),(REG912,1),(REG913,1), C01950000
               (REG914,1),(REG915,1)                           @D3502BL 02000000
         DSGEN (REG1000,1),(REG1001,1),(REG1002,1),(REG1003,1),        C02050000
               (REG1004,1),(REG1005,1),(REG1006,1),(REG1007,1),        C02100000
               (REG1008,1),(REG1009,1),(REG1010,1),(REG1011,1),        C02150000
               (REG1012,1),(REG1013,1),(REG1014,1),(REG1015,1) @D3502BL 02200000
         DSGEN (REG1100,1),(REG1101,1),(REG1102,1),(REG1103,1),        C02250000
               (REG1104,1),(REG1105,1),(REG1106,1),(REG1107,1),        C02300000
               (REG1108,1),(REG1109,1),(REG1110,1),(REG1111,1),        C02350000
               (REG1112,1),(REG1113,1),(REG1114,1),(REG1115,1) @D3502BL 02400000
         DSGEN (REG1200,1),(REG1201,1),(REG1202,1),(REG1203,1),        C02450000
               (REG1204,1),(REG1205,1),(REG1206,1),(REG1207,1),        C02500000
               (REG1208,1),(REG1209,1),(REG1210,1),(REG1211,1),        C02550000
               (REG1212,1),(REG1213,1),(REG1214,1),(REG1215,1) @D3502BL 02600000
         DSGEN (REG1300,1),(REG1301,1),(REG1302,1),(REG1303,1),        C02650000
               (REG1304,1),(REG1305,1),(REG1306,1),(REG1307,1),        C02700000
               (REG1308,1),(REG1309,1),(REG1310,1),(REG1311,1),        C02750000
               (REG1312,1),(REG1313,1),(REG1314,1),(REG1315,1) @D3502BL 02800000
         DSGEN (REG1400,1),(REG1401,1),(REG1402,1),(REG1403,1),        C02850000
               (REG1404,1),(REG1405,1),(REG1406,1),(REG1407,1),        C02900000
               (REG1408,1),(REG1409,1),(REG1410,1),(REG1411,1),        C02950000
               (REG1412,1),(REG1413,1),(REG1414,1),(REG1415,1) @D3502BL 03000000
         DSGEN (REG1500,1),(REG1501,1),(REG1502,1),(REG1503,1),        C03050000
               (REG1504,1),(REG1505,1),(REG1506,1),(REG1507,1),        C03100000
               (REG1508,1),(REG1509,1),(REG1510,1),(REG1511,1),        C03150000
               (REG1512,1),(REG1513,1),(REG1514,1),(REG1515,1) @D3502BL 03200000
         DSGEN (RMSSCBIE,16)                                   @D3502BL 03250000
         DSGEN (RMSSCBNT,16)                                   @D3502BL 03300000
         DSGEN (RMSSCBBI,16)                                   @D3502BL 03350000
         DSGEN (RMSSCBNR,16)                                   @D3502BL 03400000
         DSGEN (RMSSCBIA,16)                                   @D3502BL 03450000
         DSGEN (RMSSCBNI,16)                                   @D3502BL 03500000
         DSGEN (RMSSCBRY,16,EQU,REG900)                        @D3502BL 03550000
         EJECT                                                 @D3502BL 03600000
&CSECT   CSECT                                                 @D3502BL 03650000
XSAVE    DC    2F'0'                                           @D3502BL 03700000
ZERO     DC    X'000000'                                       @D3502BL 03750000
WORK     DC    D'0'                                            @D3502BL 03800000
H01      EQU   X'01'                                           @D3502BL 03850000
H02      EQU   X'02'                                           @D3502BL 03900000
H03      EQU   X'03'                                           @D3502BL 03950000
H04      EQU   X'04'                                           @D3502BL 04000000
H05      EQU   X'05'                                           @D3502BL 04050000
H07      EQU   X'07'                                           @D3502BL 04100000
H08      EQU   X'08'                                           @D3502BL 04150000
H10      EQU   X'10'                                           @D3502BL 04200000
H20      EQU   X'20'                                           @D3502BL 04250000
H40      EQU   X'40'                                           @D3502BL 04300000
H70      EQU   X'70'                                           @D3502BL 04350000
H80      EQU   X'80'                                           @D3502BL 04400000
L21      EQU   21                                              @D3502BL 04450000
L23      EQU   23                                              @D3502BL 04500000
L24      EQU   24                                              @D3502BL 04550000
L25      EQU   25                                              @D3502BL 04600000
L26      EQU   26                                              @D3502BL 04650000
L27      EQU   27                                              @D3502BL 04700000
L28      EQU   28                                              @D3502BL 04750000
L29      EQU   29                                              @D3502BL 04800000
L33      EQU   23                                              @D3502BL 04850000
L31      EQU   31                                              @D3502BL 04900000
L35      EQU   35                                              @D3502BL 04950000
         EJECT                                                 @D3502BL 05000000
*********************************************************************** 05050000
**                       SPECIAL ROUTINES                            ** 05100000
*********************************************************************** 05150000
CCBIT6   TM    REG1314,H02                                     @D3502BL 05200000
         BO    SECOND                                          @D3502BL 05250000
         MVC   L0(L3,R3),PRI                                   @D3502BL 05300000
         BR    R14                                             @D3502BL 05350000
SECOND   MVC   L0(L3,R3),SEC                                   @D3502BL 05400000
         BR    R14                                             @D3502BL 05450000
         SPACE 3                                               @D3502BL 05500000
LINKERR  TM    RECMD,1                        LINK ERROR?      @D3502BL 05550000
         BZR   R14                            YES...CARRY ON   @D3502BL 05600000
         XR    R15,R15                        DON'T PRINT THIS LINE     05650000
         BR    R14                            RETURN           @D3502BL 05700000
         SPACE 3                                               @D3502BL 05750000
STNERR   TM    RECMD,1                        STATION ERROR?   @D3502BL 05800000
         BOR   R14                            YES...CARRY ON   @D3502BL 05850000
         XR    R15,R15                        DON'T PRINT THIS LINE     05900000
         BR    R14                            RETURN           @D3502BL 05950000
         SPACE 3                                               @D3502BL 06000000
LXBSTAT  TM    L0(R4),X'80'                                    @D3502BL 06050000
         BO    TEST1                                           @D3502BL 06100000
         TM    L0(R4),X'9E'                                    @D3502BL 06150000
         BZ    INCFM                                           @D3502BL 06200000
NOPRT    XR    R15,R15                                         @D3502BL 06250000
         BR    R14                                             @D3502BL 06300000
INCFM    MVC   L0(L35,R3),TOIFR                                @D3502BL 06350000
         BR    R14                                             @D3502BL 06400000
TEST1    TM    L0(R4),X'7E'                                    @D3502BL 06450000
         BNZ   TEST2                                           @D3502BL 06500000
         MVC   L0(L26,R3),TONR                                 @D3502BL 06550000
         BR    R14                                             @D3502BL 06600000
TEST2    TM    L0(R4),X'5E'                                    @D3502BL 06650000
         BZ    INCFM                                           @D3502BL 06700000
         TM    L0(R4),X'F0'                                    @D3502BL 06750000
         BNO   TEST3                                           @D3502BL 06800000
         MVC   L0(L31,R3),SMIE                                 @D3502BL 06850000
         BR    R14                                             @D3502BL 06900000
TEST3    TM    L0(R4),X'E0'                                    @D3502BL 06950000
         BNO   NOPRT                                           @D3502BL 07000000
         MVC   L0(L28,R3),STHE                                 @D3502BL 07050000
         BR    R14                                             @D3502BL 07100000
TOIFR    DC    C'TIME-OUT, INCOMPLETE FRAME RECEIVED'          @D3502BL 07150000
TONR     DC    C'TIME-OUT, NOTHING RECEIVED'                   @D3502BL 07200000
SMIE     DC    C'SUSPECTED MODEM INTERFACE ERROR'              @D3502BL 07250000
STHE     DC    C'SUSPECTED TCU HARDWARE ERROR'                 @D3502BL 07300000
         SPACE 3                                               @D3502BL 07350000
MOVNAME  MVC   L0(L8,R3),L0(R4)                                @D3502BL 07400000
         BR    R14                                             @D3502BL 07450000
         SPACE 3                                               @D3502BL 07500000
ISMOD03  STM   R5,R6,XSAVE                                     @D3502BL 07550000
         TM    L0(R4),H03                                      @D3502BL 07600000
         BOR   R14                                             @D3502BL 07650000
         LA    R5,SKIPLN03-4                                   @D3502BL 07700000
         LA    R6,SKIPLB03-1                                   @D3502BL 07750000
         STM   R5,R6,XR9PTR                                    @D3502BL 07800000
RSTRREGS LM    R5,R6,XSAVE                                     @D3502BL 07850000
         BR    R14                                             @D3502BL 07900000
         SPACE 3                                               @D3502BL 07950000
RTNR     ST    R6,XSAVE                                        @D3502BL 08000000
         SR    R6,R6                                           @D3502BL 08050000
         IC    R6,L0(R4)                                       @D3502BL 08100000
         SLL   R6,L28                                          @D3502BL 08150000
         SRL   R6,L29                                          @D3502BL 08200000
CONVRT   CVD   R6,WORK                                         @D3502BL 08250000
         UNPK  L0(L2,R3),WORK+L6(L2)                           @D3502BL 08300000
         MVZ   L1(L1,R3),L0(R3)                                @D3502BL 08350000
         L     R6,XSAVE                                        @D3502BL 08400000
         BR    R14                                             @D3502BL 08450000
         SPACE 3                                               @D3502BL 08500000
RTNS     ST    R6,XSAVE                                        @D3502BL 08550000
         SR    R6,R6                                           @D3502BL 08600000
         IC    R6,L0(R4)                                       @D3502BL 08650000
         SRL   R6,L5                                           @D3502BL 08700000
         B     CONVRT                                          @D3502BL 08750000
*                                                              @D3502BL 08800000
PRI      DC    C'PRI'                                          @D3502BL 08850000
SEC      DC    C'SEC'                                          @D3502BL 08900000
         DC    X'01'                                           @D3502BL 08950000
         DC    X'000B0B00'                                     @D3502BL 09000000
         EJECT                                                 @D3502BL 09050000
         ENTRIES ,                                             @D3502BL 09100000
         LINE  (23,23),(2,31),SKIP=2                           @D3502BL 09150000
         HEX   NETADR,0,2B                                     @D3502BL 09200000
         ROUTINE  NETNAME,MOVNAME                              @D3502BL 09250000
         LABEL 'NETWORK ADDRESS','NETWORK NAME'                @D3502BL 09300000
         SPACE 3                                               @D3502BL 09350000
         LINE ,                                                @D3502BL 09400000
         ROUTINE RECMD,LINKERR                                 @D3502BL 09450000
         LABEL 'RECORD TYPE - PERMANENT SDLC LINK ERROR'       @D3502BL 09500000
         SPACE 3                                               @D3502BL 09550000
         LINE ,                                                @D3502BL 09600000
         ROUTINE RECMD,STNERR                                  @D3502BL 09650000
         LABEL 'RECORD TYPE - PERMANENT SDLC STATION ERROR'    @D3502BL 09700000
         SPACE 3                                               @D3502BL 09750000
         LINE  (2,1)                                           @D3502BL 09800000
         ROUTINE REG408,LXBSTAT                                @D3502BL 09850000
         LABEL ''                                              @D3502BL 09900000
         SPACE 3                                               @D3502BL 09950000
         LINE  (23,23)                                         @D3502BL 10000000
         HEX   LIBADR,0,2B                                     @D3502BL 10050000
         LABEL 'LIB ADDR'                                      @D3502BL 10100000
         SPACE 3                                               @D3502BL 10150000
         LINE  ,(3),SKIP=2                                     @D3502BL 10200000
         LABEL 'LINK INFORMATION'                              @D3502BL 10250000
         SPACE 3                                               @D3502BL 10300000
         LINE  (31,40),(4,37),SKIP=1                           @D3502BL 10350000
         HEX   (REG1300,0,1B),(REG200,0,1B),(REG400,0,2B)      @D3502BL 10400000
         LABEL 'CCB CONTROL FLG','LXB COMMAND','LXB FINAL ERROR STATUS' 10450000
         SPACE 3                                               @D3502BL 10500000
         LINE ,                                                @D3502BL 10550000
         HEX   (REG1308,0,1B),(REG208,0,2B),(REG500,0,1B)      @D3502BL 10600000
         LABEL 'CCB LINE TYPE','LXB MODIFIERS','LXB FINAL ERR EXT STATU*10650000
               S'                                              @D3502BL 10700000
         SPACE 3                                               @D3502BL 10750000
         LINE  (71,40),(41,37)                                 @D3502BL 10800000
         HEX   (REG308,0,1B),(REG508,0,2B)                     @D3502BL 10850000
         LABEL 'LXB IMMED. CTL CMD','LXB INITIAL ERROR STATUS' @D3502BL 10900000
         SPACE 3                                               @D3502BL 10950000
         LINE  (111),(78),SKIP=2                               @D3502BL 11000000
         HEX   (REG608,0,1B)                                   @D3502BL 11050000
         LABEL 'LXB INITIAL ERR EXT STATUS'                    @D3502BL 11100000
         SPACE 3                                               @D3502BL 11150000
         LINE  ,(4,27)                                         @D3502BL 11200000
         LABEL 'FINAL ERR BIT DECODE','FINAL ERR EXT STAT','INITIAL ERR*11250000
                BIT DECODE','INITIAL ERR EXT STAT'             @D3502BL 11300000
         SPACE 3                                               @D3502BL 11350000
         LINE  (26,27),(4,27),SKIP=1                           @D3502BL 11400000
         BIN   (REG400),(REG500),(REG508),(REG608)             @D3502BL 11450000
         LABEL 'EXTENDED ERR STAT FLG','OVERRUN/UNDERRUN FLAG','EXTENDEC11500000
               D ERR STAT FLG','OVERRUN/UNDERRUN FLAG'         @D3502BL 11550000
         SPACE 3                                               @D3502BL 11600000
         LINE ,                                                @D3502BL 11650000
         BIN   (REG401),(REG504),(REG509),(REG612)             @D3502BL 11700000
         LABEL 'FORMAT EXCEPTION FLG','BLOCK OVERRUN','FORMAT EXCEPTIONC11750000
                FLG','BLOCK OVERRUN'                           @D3502BL 11800000
         SPACE 3                                               @D3502BL 11850000
         LINE ,                                                @D3502BL 11900000
         BIN   (REG402),(REG506),(REG510),(REG614)             @D3502BL 11950000
         LABEL ,'ABORT',,'ABORT'                               @D3502BL 12000000
         SPACE 3                                               @D3502BL 12050000
         LINE ,                                                @D3502BL 12100000
         BIN   (REG403),(REG507),(REG511),(REG615)             @D3502BL 12150000
         LABEL 'DATA CHECK','MONITOR COUNT OVERFLO','DATA CHECK','MONITC12200000
               OR COUNT OVERFLO'                               @D3502BL 12250000
         SPACE 3                                               @D3502BL 12300000
         LINE  (26,54),(4,54)                                  @D3502BL 12350000
         BIN   (REG415),(REG607)                               @D3502BL 12400000
         LABEL 'SDLC POLL FINAL BIT','SDLC POLL FINAL BIT'     @D3502BL 12450000
         SPACE 3                                               @D3502BL 12500000
         LINE ,                                                @D3502BL 12550000
         ROUTINE   RECMD,ISMOD03                               @D3502BL 12600000
         LABEL ''                                              @D3502BL 12650000
         SPACE 3                                               @D3502BL 12700000
         LINE  (8),(2,10),SKIP=2                               @D3502BL 12750000
         ROUTINE   REG1314,CCBIT6                              @D3502BL 12800000
         LABEL 'LOCAL','STATION INFORMATION'                   @D3502BL 12850000
         SPACE 3                                               @D3502BL 12900000
         LINE  (31,40),(4,34),SKIP=1                           @D3502BL 12950000
         HEX   (REG1000,0,1B)                                  @D3502BL 13000000
         CONVT (RMSSCBNT,2,4)                                  @D3502BL 13050000
         LABEL 'SCB STATION TYPE','TOTAL TRANSMISSION CNT'     @D3502BL 13100000
         SPACE 3                                               @D3502BL 13150000
         LINE ,                                                @D3502BL 13200000
         HEX   (ISBOX,0,2B)                                    @D3502BL 13250000
         CONVT (RMSSCBBI,2,4)                                  @D3502BL 13300000
         LABEL 'SCB SERV. SEEKING CMD FLGS','I FORMAT RECEIVE CNT'      13350000
         SPACE 3                                               @D3502BL 13400000
         LINE ,                                                @D3502BL 13450000
         HEX   (REG100,0,1B)                                   @D3502BL 13500000
         CONVT (RMSSCBNR,2,4)                                  @D3502BL 13550000
         LABEL 'SCB OUTPUT CONTROL FLAGS','S FORMAT RECEIVE CNT'        13600000
         SPACE 3                                               @D3502BL 13650000
         LINE ,                                                @D3502BL 13700000
         HEX   (REG1008,0,1B)                                  @D3502BL 13750000
         CONVT (RMSSCBIE,2,4)                                  @D3502BL 13800000
         LABEL 'XMTD BLU CMD FLD','I FORMAT RECEIVE ERRORS'    @D3502BL 13850000
         SPACE 3                                               @D3502BL 13900000
         LINE ,                                                @D3502BL 13950000
         HEX   (REG808,0,1B)                                   @D3502BL 14000000
         CONVT (RMSSCBIA,2,4)                                  @D3502BL 14050000
         LABEL 'RCVD BLU CMD FLD','I FORMAT FRAMES ACKNOWLEDGED'        14100000
         SPACE 3                                               @D3502BL 14150000
         LINE ,                                                @D3502BL 14200000
         ROUTINE   REG1200,RTNR                                @D3502BL 14250000
         CONVT (RMSSCBNI,2,4)                                  @D3502BL 14300000
         LABEL 'N(R)','I FORMAT TOTAL RETRANSMISSIONS'         @D3502BL 14350000
         SPACE 3                                               @D3502BL 14400000
         LINE ,                                                @D3502BL 14450000
         ROUTINE   REG1208,RTNR                                @D3502BL 14500000
         CONVT (RMSSCBRY,2,4)                                  @D3502BL 14550000
         LABEL 'N(S)','TOTAL RETRY COUNT'                      @D3502BL 14600000
         SPACE 3                                               @D3502BL 14650000
         LINE ,                                                @D3502BL 14700000
         CONVT REG1100,1,3                                     @D3502BL 14750000
         LABEL 'SCB CRNT OUTSTANDING CNT'                      @D3502BL 14800000
         SPACE 3                                               @D3502BL 14850000
         LINE ,                                                @D3502BL 14900000
         CONVT REG1108,1,3                                     @D3502BL 14950000
         LABEL 'SCB PASS COUNT'                                @D3502BL 15000000
         SPACE 3                                               @D3502BL 15050000
         LINE ,                                                @D3502BL 15100000
         CONVT REG700,2,6                                      @D3502BL 15150000
         LABEL 'SCB I-FORMAT TRANSMIT CNT'                     @D3502BL 15200000
         SPACE 3                                               @D3502BL 15250000
SKIPLN03 LINE  ,,SKIP=1                                        @D3502BL 15300000
SKIPLB03 LABEL ''                                              @D3502BL 15350000
         SPACE 3                                               @D3502BL 15400000
         ETEPILOG RLEN=3C                                               15450000
         END                                                            15500000
