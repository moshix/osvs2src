         TITLE 'IFCEVENT-EVENT HISTORY PROCESSING'                      00001000
IFCEVENT CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'IFCEVENT  79.011'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  ST    @14,12(,@13)                                        0001 00009000
         STM   @00,@12,20(@13)                                     0001 00010000
         BALR  @10,0                                               0001 00011000
@PSTART  LA    @11,4095(,@10)                                      0001 00012000
         LA    @12,4095(,@11)                                      0001 00013000
         LA    @04,4095(,@12)                                      0001 00014000
         USING @PSTART,@10                                         0001 00015000
         USING @PSTART+4095,@11                                    0001 00016000
         USING @PSTART+8190,@12                                    0001 00017000
         USING @PSTART+12285,@04                                   0001 00018000
         ST    @13,@SA00001+4                                      0001 00019000
         LA    @14,@SA00001                                        0001 00020000
         ST    @14,8(,@13)                                         0001 00021000
         LR    @13,@14                                             0001 00022000
         B     @PB00002                                            0209 00023000
TEMPLATE STM   @14,@12,@SA00002                                    0209 00024000
*  SPACING = UPSPACE;                                      /*@Z427VLS*/ 00025000
         MVC   SPACING(1),UPSPACE                                  0210 00026000
*  CALL PRINTIT;                                           /*@Z427VLS*/ 00027000
         BAL   @14,PRINTIT                                         0211 00028000
*  SPACING = DOUBLE;                                       /*@Z427VLS*/ 00029000
         MVC   SPACING(1),DOUBLE                                   0212 00030000
*  TOPTEMP = LINE01;             /*MOVE THE TOP LINE OF TEMPLATE IN  */ 00031000
         MVC   TOPTEMP(23),LINE01                                  0213 00032000
*  CALL PRINTIT;                 /*PRINT OUT THE HEADING FOR TEMPLATE*/ 00033000
         BAL   @14,PRINTIT                                         0214 00034000
*  DO N = 1 BY 1 TO 9;           /*PRINT 9 PAIR OF LINES     @Z427VLS*/ 00035000
         LA    @06,1                                               0215 00036000
         ST    @06,N                                               0215 00037000
@DL00215 DS    0H                                                  0216 00038000
*    GEN(MVI  TIME1,X'40');                                /*@Z427VLS*/ 00039000
         MVI  TIME1,X'40'                                               00040000
*    GEN(MVC  TIME1+1(130),TIME1);                         /*@Z427VLS*/ 00041000
         MVC  TIME1+1(130),TIME1                                        00042000
*    SPACING = SINGLE;                                     /*@Z427VLS*/ 00043000
         MVC   SPACING(1),SINGLE                                   0218 00044000
*    CALL PRINTIT;               /*PRINT SEPT LINE           @Z427VLS*/ 00045000
         BAL   @14,PRINTIT                                         0219 00046000
*    LINE002 = LINE02;           /*MOVE COMMON PART OF LINE IN       */ 00047000
         MVC   LINE002(20),LINE02                                  0220 00048000
*    R8 = ADDRTAB1(N);           /*WHERE THE DATA IS AT      @Z427VLS*/ 00049000
         L     @06,N                                               0221 00050000
         SLA   @06,2                                               0221 00051000
         L     R8,ADDRTAB1-4(@06)                                  0221 00052000
*    R9 = NUMCHAR1(N);           /*NUMBER OF BYTES TO MOVE   @Z427VLS*/ 00053000
         L     R9,NUMCHAR1-4(@06)                                  0222 00054000
*    GEN(EX   R9,EXECMVC);       /*EXEC THE MOVE CHAR        @Z427VLS*/ 00055000
         EX   R9,EXECMVC                                                00056000
*    SPACING = DOUBLE;                                     /*@Z427VLS*/ 00057000
         MVC   SPACING(1),DOUBLE                                   0224 00058000
*    CALL PRINTIT;               /*GO PRINT THE DATA         @Z427VLS*/ 00059000
         BAL   @14,PRINTIT                                         0225 00060000
*    DUPLICAT  = LINE04;         /*MOVE IN THE COMMON PART OF MESSAGE*/ 00061000
         MVC   DUPLICAT(33),LINE04                                 0226 00062000
*    R8 = ADDRTAB2(N);           /*SET UP WHERE THE DATA IS  @Z427VLS*/ 00063000
         L     @06,N                                               0227 00064000
         SLA   @06,2                                               0227 00065000
         L     R8,ADDRTAB2-4(@06)                                  0227 00066000
*    R9 = NUMCHAR2(N);           /*NUMBER OF BYTES TO MOVE   @Z427VLS*/ 00067000
         L     R9,NUMCHAR2-4(@06)                                  0228 00068000
*    GEN(EX    R9,EXECMVC2);     /*EXEC THE MVC INSTRUCTION  @Z427VLS*/ 00069000
         EX    R9,EXECMVC2                                              00070000
*    SPACING = DOUBLE;           /*SET TO SINGLE SPACE ON THIS LINE  */ 00071000
         MVC   SPACING(1),DOUBLE                                   0230 00072000
*    CALL PRINTIT;               /*GO RPINT THE BUFFER       @Z427VLS*/ 00073000
         BAL   @14,PRINTIT                                         0231 00074000
*   END;                                                   /*@Z427VLS*/ 00075000
         LA    @06,1                                               0232 00076000
         AL    @06,N                                               0232 00077000
         ST    @06,N                                               0232 00078000
         C     @06,@CF00085                                        0232 00079000
         BNH   @DL00215                                            0232 00080000
*   SPACING = SINGLE;                                      /*@Z427VLS*/ 00081000
         MVC   SPACING(1),SINGLE                                   0233 00082000
*   MDROBRLN = MDRLINE;          /*SET UP SECOND HALF OF OUTPUT      */ 00083000
         MVC   MDROBRLN(35),MDRLINE                                0234 00084000
*   CALL PRINTIT;                /*GO PRINT THE THIRD LINE FOR THIS  */ 00085000
         BAL   @14,PRINTIT                                         0235 00086000
*    GENERATE DATA;                                        /*@Z427VLS*/ 00087000
*  END;                                                    /*@Z427VLS*/ 00088000
@EL00002 DS    0H                                                  0237 00089000
@EF00002 DS    0H                                                  0237 00090000
@ER00002 LM    @14,@12,@SA00002                                    0237 00091000
         BR    @14                                                 0237 00092000
*/********************************************************************/ 00093000
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */ 00094000
*/*    THIS PROC WILL CONVERT THE BINARY NUMBER IN ITEM BINWORD TO   */ 00095000
*/*    PRINTABLE IF THE NUMBER (CONVERTED) IS > THAN THE NUMBER OF   */ 00096000
*/*    CHARACTERS REQUESTED (IN ITEM BNDECNUM) A NINE WILL BE PLACED */ 00097000
*/*    IN EACH PRINT POSITION                                @Z427VLS*/ 00098000
*/*                                                          @Z427VLS*/ 00099000
*CONVBIN:  PROC;                                           /*@Z427VLS*/ 00100000
CONVBIN  STM   @14,@12,@SA00003                                    0238 00101000
* R8 = BINWORD;                  /*LOAD THE ITEM TO CONVERT  @Z427VLS*/ 00102000
         L     R8,BINWORD                                          0239 00103000
* GEN(CVD   R8,DBLWORD);         /*CONVERT THE NUMBER        @Z427VLS*/ 00104000
         CVD   R8,DBLWORD                                               00105000
* GEN(UNPK   WORK(8),DBLWORD);   /*UNPACK THE CONVERTED NUMBER       */ 00106000
         UNPK   WORK(8),DBLWORD                                         00107000
* GEN(OI    WORK+7,X'F0');       /*INSURE SIGN IS NO PROBLEM @Z427VLS*/ 00108000
         OI    WORK+7,X'F0'                                             00109000
* SWITCH2 = OFF;                 /*CLEAR THE SWITCH PRIOR TO START   */ 00110000
         NI    SWITCH2,B'10111111'                                 0243 00111000
* DO L = 1 BY 1 TO 7 WHILE (SWITCH2 = OFF);                /*@Z427VLS*/ 00112000
         LA    @06,1                                               0244 00113000
         ST    @06,L                                               0244 00114000
@DL00244 TM    SWITCH2,B'01000000'                                 0244 00115000
         BNZ   @DC00244                                            0244 00116000
*  IF WORKOVER(L)  = 'F0'X       /*IS IT A 0 IF SO MAKE IT A BLANK   */ 00117000
*    THEN                                                          0245 00118000
         LA    @05,WORKOVER-1(@06)                                 0245 00119000
         CLI   0(@05),X'F0'                                        0245 00120000
         BNE   @RF00245                                            0245 00121000
*      WORKOVER(L) = '40'X;      /*SET TO A BLANK            @Z427VLS*/ 00122000
         LA    @05,WORKOVER-1(@06)                                 0246 00123000
         MVI   0(@05),X'40'                                        0246 00124000
*    ELSE                                                          0247 00125000
*      SWITCH2 = ON;             /*SET SWITCH TO TERMINATE DO LOOP   */ 00126000
         B     @RC00245                                            0247 00127000
@RF00245 OI    SWITCH2,B'01000000'                                 0247 00128000
* END;                                                     /*@Z427VLS*/ 00129000
@RC00245 LA    @06,1                                               0248 00130000
         AL    @06,L                                               0248 00131000
         ST    @06,L                                               0248 00132000
         C     @06,@CF00082                                        0248 00133000
         BNH   @DL00244                                            0248 00134000
@DC00244 DS    0H                                                  0249 00135000
* IF (TEN   - L) > BNDECNUM      /*IS THE CONVERTED NUMBER TO LARGE  */ 00136000
*    THEN                                                          0249 00137000
         L     @06,TEN                                             0249 00138000
         SL    @06,L                                               0249 00139000
         C     @06,BNDECNUM                                        0249 00140000
         BNH   @RF00249                                            0249 00141000
*      DO;                                                 /*@Z427VLS*/ 00142000
*        GEN(MVI   WORKOVER,X'F9');  /*SET FIRST NINE IN THE MEASSAGE*/ 00143000
         MVI   WORKOVER,X'F9'                                           00144000
*        GEN(MVC   WORKOVER+1(7),WORKOVER);/*FILL WITH NINES @Z427VLS*/ 00145000
         MVC   WORKOVER+1(7),WORKOVER                                   00146000
*      END;                                                /*@Z427VLS*/ 00147000
* R8 = ADDR(WORKOVER) + (8-BNDECNUM);/*SET WHERE TO MOVE FROM ADDRESS*/ 00148000
@RF00249 LA    R8,WORKOVER                                         0254 00149000
         L     @06,BNDECNUM                                        0254 00150000
         LA    @05,8                                               0254 00151000
         SLR   @05,@06                                             0254 00152000
         ALR   R8,@05                                              0254 00153000
* R9 = BNDECNUM - ONE;           /*NUMBER OF BYTES TO MOVE   @Z427VLS*/ 00154000
         SL    @06,ONE                                             0255 00155000
         LR    R9,@06                                              0255 00156000
* RESPECIFY (R6) RESTRICTED;                               /*@Z427VLS*/ 00157000
* R6 = DECADDR;                  /*ADDRESS TO MOVE TO        @Z427VLS*/ 00158000
         L     R6,DECADDR                                          0257 00159000
* GEN(EX    R9,MVCDATA);         /*MOVE DATA TO REQUESTED LOCATION   */ 00160000
         EX    R9,MVCDATA                                               00161000
* GENERATE DATA;                                           /*@Z427VLS*/ 00162000
* RESPECIFY (R6) UNRESTRICTED;                             /*@Z427VLS*/ 00163000
*END;                                                      /*@Z427VLS*/ 00164000
@EL00003 DS    0H                                                  0261 00165000
@EF00003 DS    0H                                                  0261 00166000
@ER00003 LM    @14,@12,@SA00003                                    0261 00167000
         BR    @14                                                 0261 00168000
*/********************************************************************/ 00169000
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */ 00170000
*/*    THIS PROC WILL CONVERT THE HEX DATA INTO PRINTABLE    @Z427VLS*/ 00171000
*/*                                                          @Z427VLS*/ 00172000
*/*    IF IT IS NECESSARY TO CONVERT ONLY 1/2 OF FIRST BYTE(CUA FOR  */ 00173000
*/*    EXP. THEN THE USER SHOULD SET THE SWITCH1 TO THEON CONDITION  */ 00174000
*CONVERT: PROC;                                            /*@Z427VLS*/ 00175000
CONVERT  STM   @14,@12,12(@13)                                     0262 00176000
* DO P = NUMBER BY -1 TO 1;      /*# = # OF BYTES TO CONVERT TO PRINT*/ 00177000
         L     @06,NUMBER                                          0263 00178000
         ST    @06,P                                               0263 00179000
         B     @DE00263                                            0263 00180000
@DL00263 DS    0H                                                  0264 00181000
*   R8 = NEXTBYTE(P);            /*LOAD THE NEXT BYTE TO CONVERT     */ 00182000
         L     @05,NEXTBY                                          0264 00183000
         BCTR  @05,0                                               0264 00184000
         SLR   R8,R8                                               0264 00185000
         IC    R8,NEXTBYTE(@06,@05)                                0264 00186000
*   X =  TWO * P;                /*OUTPUT INDEX MUST BE TWICE INPUT  */ 00187000
         L     @01,TWO                                             0265 00188000
         MR    @00,@06                                             0265 00189000
         ST    @01,X                                               0265 00190000
*   SRDL  (R8,FOUR);             /*MOVE 1/2 IN TO NEXT REG   @Z427VLS*/ 00191000
         SRDL  R8,4                                                0266 00192000
*   SRL   (R9,TWOEIGHT);         /*SHIFT THE REG 28 BITS     @Z427VLS*/ 00193000
         L     @05,TWOEIGHT                                        0267 00194000
         SRL   R9,0(@05)                                           0267 00195000
*   R9  =  R9 + NUMBER1;         /*INSURE INDEX BY 0 DOES NOT AFFECT */ 00196000
         L     @05,NUMBER1                                         0268 00197000
         ALR   R9,@05                                              0268 00198000
*   R8  =  R8 + NUMBER1;         /*SAME                      @Z427VLS*/ 00199000
         ALR   R8,@05                                              0269 00200000
*   IF SWITCH1 = ON & P = ONE    /*DO WE NOT PUT THE HALF BYTE OUT   */ 00201000
*    THEN                                                          0270 00202000
         TM    SWITCH1,B'10000000'                                 0270 00203000
         BNO   @RF00270                                            0270 00204000
         C     @06,ONE                                             0270 00205000
         BNE   @RF00270                                            0270 00206000
*     SWITCH1 = OFF;             /*TURN OFF THE SWITCH       @Z427VLS*/ 00207000
         NI    SWITCH1,B'01111111'                                 0271 00208000
*    ELSE                                                          0272 00209000
*     ADDNUM(X-ONE) = CHARS(R8);/*PUT THE PRINT CHAR INTO THE OUTPUT*/  00210000
         B     @RC00270                                            0272 00211000
@RF00270 L     @06,X                                               0272 00212000
         SL    @06,ONE                                             0272 00213000
         L     @05,ADDNXT                                          0272 00214000
         ALR   @05,@06                                             0272 00215000
         BCTR  @05,0                                               0272 00216000
         LA    @06,CHARS-1(R8)                                     0272 00217000
         MVC   ADDNUM(1,@05),0(@06)                                0272 00218000
*     ADDNUM(X)  = CHARS(R9);   /*FINSH THE BYTE             @Z427VLS*/ 00219000
@RC00270 L     @06,ADDNXT                                          0273 00220000
         AL    @06,X                                               0273 00221000
         BCTR  @06,0                                               0273 00222000
         LA    @05,CHARS-1(R9)                                     0273 00223000
         MVC   ADDNUM(1,@06),0(@05)                                0273 00224000
* END;                                                     /*@Z427VLS*/ 00225000
         SLR   @06,@06                                             0274 00226000
         BCTR  @06,0                                               0274 00227000
         AL    @06,P                                               0274 00228000
         ST    @06,P                                               0274 00229000
@DE00263 LTR   @06,@06                                             0274 00230000
         BP    @DL00263                                            0274 00231000
*END;                                                      /*@Z427VLS*/ 00232000
@EL00004 DS    0H                                                  0275 00233000
@EF00004 DS    0H                                                  0275 00234000
@ER00004 LM    @14,@12,12(@13)                                     0275 00235000
         BR    @14                                                 0275 00236000
*/********************************************************************/ 00237000
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */ 00238000
*/*    THIS PROC WILL ADD TOTALS OF EACH TYPE RECORD AND PRINT THE   */ 00239000
*/*    TOTALS                                                @Z427VLS*/ 00240000
*/*    THIS PROC IS BASED ON THERE BEING 23 MINOR TYPES OF RECORDS   */ 00241000
*/*    (UNDER THE 9 MAIN) ANY CHANGE IN THE NUMBER OF TYPES WILL     */ 00242000
*/*    RESULT IN BAD THINGS                                  @Z427VLS*/ 00243000
*/*    ALL 23 LENGHT ITEMS WILL JUST NEED THERE LENGTH ADJUSTED ALSO */ 00244000
*/*    THE TYPES WILL NEED ADJUSTING AND THE TYPE COUNTERS THESE ARE */ 00245000
*/*    NOT IN A TABLE AND START AFTER ITEM NUMCHAR2          @Z427VLS*/ 00246000
*/*                                                          @Z427VLS*/ 00247000
*PRTTOTAL:  PROC;                                          /*@Z427VLS*/ 00248000
PRTTOTAL STM   @14,@12,@SA00005                                    0276 00249000
* SPACING = UPSPACE;             /*START ON A FRESH PAGE     @Z427VLS*/ 00250000
         MVC   SPACING(1),UPSPACE                                  0277 00251000
* CALL PRINTIT;                                            /*@Z427VLS*/ 00252000
         BAL   @14,PRINTIT                                         0278 00253000
*  SWITCH5 = ON;    /*SET TO UP SPACE DURING TOTALS IF REQ   @0001VLS*/ 00254000
         OI    SWITCH5,B'00001000'                                 0279 00255000
* SPACING = DOUBLE;              /*RESET TO SINGLE SPACING   @Z427VLS*/ 00256000
         MVC   SPACING(1),DOUBLE                                   0280 00257000
* Z = ONE;                       /*SET INDEX TO STEP THROUGH @Z427VLS*/ 00258000
         L     @06,ONE                                             0281 00259000
         ST    @06,Z                                               0281 00260000
* TOTALHD2 = TOTALHD1;           /*MOVE IN WORDS RECORD TYPES        */ 00261000
         MVC   TOTALHD2(12),TOTALHD1                               0282 00262000
* RESPECIFY (R6) RESTRICTED;                               /*@Z427VLS*/ 00263000
* R6 = ADDR(TOTALHD3) ;                                    /*@Z427VLS*/ 00264000
         LA    R6,TOTALHD3                                         0284 00265000
* R8 = ADDR(TIME1) + 26;                                   /*@Z427VLS*/ 00266000
         LA    R8,TIME1                                            0285 00267000
         AL    R8,@CF01168                                         0285 00268000
* R9 = 7     + SIX * EVNUM;                                /*@Z427VLS*/ 00269000
         L     @05,EVPTR(,R2)                                      0286 00270000
         L     R9,SIX                                              0286 00271000
         MH    R9,EVNUM(,@05)                                      0286 00272000
         AL    R9,@CF00082                                         0286 00273000
* GEN(EX  R9,MOVECHAR);                                    /*@Z427VLS*/ 00274000
         EX  R9,MOVECHAR                                                00275000
* RESPECIFY (R6) UNRESTRICTED;                             /*@Z427VLS*/ 00276000
* CALL PRINTIT;                  /*PRINT THE HEADING FOR THE TOTALS  */ 00277000
         BAL   @14,PRINTIT                                         0289 00278000
* SPACING = SINGLE;              /*PRINT THE HEADING FOR THE TOTALS  */ 00279000
         MVC   SPACING(1),SINGLE                                   0290 00280000
* DO J = 1 BY 1 TO 9 ;           /*MAIN LOOP FOR 9 TYPES OF RECORDS  */ 00281000
         LA    @06,1                                               0291 00282000
         ST    @06,J                                               0291 00283000
@DL00291 DS    0H                                                  0292 00284000
*  DO  WHILE(LETTER(Z) = LETTER1);                         /*@Z427VLS*/ 00285000
         B     @DE00292                                            0292 00286000
@DL00292 DS    0H                                                  0293 00287000
*   BNDECNUM = SIX;              /*SET FOR SIX CHARACTERS OUT        */ 00288000
         L     @06,SIX                                             0293 00289000
         ST    @06,BNDECNUM                                        0293 00290000
*   TOTALNME = NMETOTAL(Z);      /*WILL MOVE IN 7 CHAR SUBNAME       */ 00291000
         L     @06,Z                                               0294 00292000
         MH    @06,@CH00082                                        0294 00293000
         LA    @05,NMETOTAL-7(@06)                                 0294 00294000
         MVC   TOTALNME(7),0(@05)                                  0294 00295000
*   BINWORD = ZERO;              /*SET TO 0 PRIOR TO START   @Z427VLS*/ 00296000
         SLR   @06,@06                                             0295 00297000
         ST    @06,BINWORD                                         0295 00298000
*   DO K = 1 BY 1 TO EVNUM;   /*EVNUM# OF CPUS FOUND THIS JOB  */  0296 00299000
         LA    @06,1                                               0296 00300000
         ST    @06,K                                               0296 00301000
         B     @DE00296                                            0296 00302000
@DL00296 DS    0H                                                  0297 00303000
*    BINWORD = COUNT(Z,K) + BINWORD;/*ADD UP THE TOTAL THIS SUBTYPE  */ 00304000
         L     @05,Z                                               0297 00305000
         SLA   @05,4                                               0297 00306000
         ALR   @05,@06                                             0297 00307000
         SLA   @05,2                                               0297 00308000
         L     @05,COUNT-68(@05)                                   0297 00309000
         AL    @05,BINWORD                                         0297 00310000
         ST    @05,BINWORD                                         0297 00311000
*   END;                                                   /*@Z427VLS*/ 00312000
         AL    @06,@CF00055                                        0298 00313000
         ST    @06,K                                               0298 00314000
@DE00296 L     @05,EVPTR(,R2)                                      0298 00315000
         CH    @06,EVNUM(,@05)                                     0298 00316000
         BNH   @DL00296                                            0298 00317000
*   TOTAL = TOTAL + BINWORD;     /*SAVE TO HAVE THE TOTAL OF THIS LNE*/ 00318000
         L     @06,BINWORD                                         0299 00319000
         L     @05,TOTAL                                           0299 00320000
         ALR   @05,@06                                             0299 00321000
         ST    @05,TOTAL                                           0299 00322000
*   TOTOFTOT = TOTOFTOT + BINWORD;                         /*@Z427VLS*/ 00323000
         AL    @06,TOTOFTOT                                        0300 00324000
         ST    @06,TOTOFTOT                                        0300 00325000
*   DECADDR = ADDR(TOTALVAL);    /*SET WHERE TO PUT CONVERTED VALUE  */ 00326000
         LA    @06,TOTALVAL                                        0301 00327000
         ST    @06,DECADDR                                         0301 00328000
*   CALL CONVBIN;                /*GO CONVERT THE ITEM TO PRINTABLE  */ 00329000
         BAL   @14,CONVBIN                                         0302 00330000
*   BNDECNUM = FIVE;             /*CHANGE INDIVIDUAL ITEMS TO 5 CHAR */ 00331000
         L     @06,FIVE                                            0303 00332000
         ST    @06,BNDECNUM                                        0303 00333000
*   DECADDR = DECADDR + SEVEN;   /*MOVE DOWN THE PRINT LINE BY 7 CHAR*/ 00334000
         L     @06,DECADDR                                         0304 00335000
         AL    @06,SEVEN                                           0304 00336000
         ST    @06,DECADDR                                         0304 00337000
*   DO K = 1 BY 1 TO EVNUM;   /*SET BY FILTER 4 TO # OF CPUS @Z427VLS*/ 00338000
         LA    @06,1                                               0305 00339000
         ST    @06,K                                               0305 00340000
         B     @DE00305                                            0305 00341000
@DL00305 DS    0H                                                  0306 00342000
*    BINWORD = COUNT(Z,K);       /*PULL UP THE FIRST COUNT   @Z427VLS*/ 00343000
         L     @05,Z                                               0306 00344000
         SLA   @05,4                                               0306 00345000
         ALR   @05,@06                                             0306 00346000
         SLA   @05,2                                               0306 00347000
         L     @05,COUNT-68(@05)                                   0306 00348000
         ST    @05,BINWORD                                         0306 00349000
*    TOTALS(K) = TOTALS(K) + BINWORD;/*CPU TOTALS FOR THIS LINE      */ 00350000
         SLA   @06,2                                               0307 00351000
         L     @03,TOTALS-4(@06)                                   0307 00352000
         ALR   @03,@05                                             0307 00353000
         ST    @03,TOTALS-4(@06)                                   0307 00354000
*   SUBTOT(K) = SUBTOT(K) + BINWORD;/*FOR OVER ALL TOTAL     @Z427VLS*/ 00355000
         AL    @05,SUBTOT-4(@06)                                   0308 00356000
         ST    @05,SUBTOT-4(@06)                                   0308 00357000
*    CALL CONVBIN;               /*GO CONVERT TO PRINTABLE 5 CHARS   */ 00358000
         BAL   @14,CONVBIN                                         0309 00359000
*    DECADDR = DECADDR + SIX;    /*MOVE DOWN PRINT TO NEXT CPU       */ 00360000
         L     @06,DECADDR                                         0310 00361000
         AL    @06,SIX                                             0310 00362000
         ST    @06,DECADDR                                         0310 00363000
*   END;                                                   /*@Z427VLS*/ 00364000
         LA    @06,1                                               0311 00365000
         AL    @06,K                                               0311 00366000
         ST    @06,K                                               0311 00367000
@DE00305 L     @05,EVPTR(,R2)                                      0311 00368000
         CH    @06,EVNUM(,@05)                                     0311 00369000
         BNH   @DL00305                                            0311 00370000
*   CALL PRINTIT;                /*PRINT TOTAL AND INDIVIDULE COUNT  */ 00371000
         BAL   @14,PRINTIT                                         0312 00372000
*   Z = Z + ONE;                 /*MOVE TO THE NEXT SUB CASE @Z427VLS*/ 00373000
         L     @06,Z                                               0313 00374000
         AL    @06,ONE                                             0313 00375000
         ST    @06,Z                                               0313 00376000
*  END;                                                    /*@Z427VLS*/ 00377000
@DE00292 L     @06,Z                                               0314 00378000
         LA    @05,LETTER-1(@06)                                   0314 00379000
         CLC   0(1,@05),LETTER1                                    0314 00380000
         BE    @DL00292                                            0314 00381000
*  CPU12 = EVLETTER(PTR);                                  /*@Z427VLS*/ 00382000
         L     @05,PTR                                             0315 00383000
         MH    @05,@CH00080                                        0315 00384000
         L     @03,EVPTR(,R2)                                      0315 00385000
         ALR   @03,@05                                             0315 00386000
         MVC   CPU12(1),EVLETTER-6(@03)                            0315 00387000
*  LETTER1 = LETTER(Z);          /*CHANGE THE CONTROL CHARACTER      */ 00388000
         LA    @05,LETTER-1(@06)                                   0316 00389000
         MVC   LETTER1(1),0(@05)                                   0316 00390000
*  BINWORD = TOTAL;              /*SET TO CONVERT THE TOTAL FOR LINE */ 00391000
         L     @06,TOTAL                                           0317 00392000
         ST    @06,BINWORD                                         0317 00393000
*  BNDECNUM = SIX;               /*LET TOTAL HAVE SIX PLACES OUT     */ 00394000
         L     @06,SIX                                             0318 00395000
         ST    @06,BNDECNUM                                        0318 00396000
*  TOTALNM1 = TOTHEAD(J);        /*MOVE IN WORDS TO DESCRIBE THE LINE*/ 00397000
         L     @06,J                                               0319 00398000
         MH    @06,@CH00850                                        0319 00399000
         LA    @05,TOTHEAD-22(@06)                                 0319 00400000
         MVC   TOTALNM1(22),0(@05)                                 0319 00401000
*  DECADDR = ADDR(TOTALVAL);     /*WHERE TO PUT THE DATA     @Z427VLS*/ 00402000
         LA    @06,TOTALVAL                                        0320 00403000
         ST    @06,DECADDR                                         0320 00404000
*  CALL CONVBIN;                 /*CONVERT THE NUMBER TO PRINTABLE   */ 00405000
         BAL   @14,CONVBIN                                         0321 00406000
*  BNDECNUM = FIVE;              /*CHANGE BACK TO ONLY 5 CHARS OUT   */ 00407000
         L     @06,FIVE                                            0322 00408000
         ST    @06,BNDECNUM                                        0322 00409000
*  DECADDR = DECADDR + SEVEN;    /*MOVE DOWN THE PRINT LINE  @Z427VLS*/ 00410000
         L     @06,DECADDR                                         0323 00411000
         AL    @06,SEVEN                                           0323 00412000
         ST    @06,DECADDR                                         0323 00413000
*  DO K = 1 BY 1 TO EVNUM;    /*PROCESS THROUGH ALL CPUS     @Z427VLS*/ 00414000
         LA    @06,1                                               0324 00415000
         ST    @06,K                                               0324 00416000
         B     @DE00324                                            0324 00417000
@DL00324 DS    0H                                                  0325 00418000
*   BINWORD = TOTALS(K);         /*GET TOTAL FOR EACH CPU    @Z427VLS*/ 00419000
         SLA   @06,2                                               0325 00420000
         L     @06,TOTALS-4(@06)                                   0325 00421000
         ST    @06,BINWORD                                         0325 00422000
*   CALL CONVBIN;                /*CONVERT THIS TO PRINTABLE @Z427VLS*/ 00423000
         BAL   @14,CONVBIN                                         0326 00424000
*   DECADDR = DECADDR + SIX;     /*MOVE DOWN THE PRINT LINE FOR NEXT */ 00425000
         L     @06,DECADDR                                         0327 00426000
         AL    @06,SIX                                             0327 00427000
         ST    @06,DECADDR                                         0327 00428000
*  END;                                                    /*@Z427VLS*/ 00429000
         LA    @06,1                                               0328 00430000
         AL    @06,K                                               0328 00431000
         ST    @06,K                                               0328 00432000
@DE00324 L     @05,EVPTR(,R2)                                      0328 00433000
         CH    @06,EVNUM(,@05)                                     0328 00434000
         BNH   @DL00324                                            0328 00435000
*  CALL PRINTIT;                 /*GO PRINT THE TOTALS FOR EACH CPU  */ 00436000
         BAL   @14,PRINTIT                                         0329 00437000
*  TOTAL = ZERO;                 /*SET ITEM TO ZERO          @Z427VLS*/ 00438000
         SLR   @06,@06                                             0330 00439000
         ST    @06,TOTAL                                           0330 00440000
*  SPACING = DOUBLE;             /*MAKE THE OUTPTU LOOK BETTER       */ 00441000
         MVC   SPACING(1),DOUBLE                                   0331 00442000
*  CALL PRINTIT;                 /*WITH A GAP BETWEEN SECTIONS       */ 00443000
         BAL   @14,PRINTIT                                         0332 00444000
*  SPACING = SINGLE;             /*RETURN THE SPAVING TO 1 SPACE     */ 00445000
         MVC   SPACING(1),SINGLE                                   0333 00446000
*  GEN(MVI   TOTALS,X'00');      /*SET FIRST BYTE TO ZERO    @Z427VLS*/ 00447000
         MVI   TOTALS,X'00'                                             00448000
*  GEN(MVC   TOTALS+1(63),TOTALS);/*RIPPLE THE 0 THROUGH THE ARRAY   */ 00449000
         MVC   TOTALS+1(63),TOTALS                                      00450000
* END;                                                     /*@Z427VLS*/ 00451000
         LA    @06,1                                               0336 00452000
         AL    @06,J                                               0336 00453000
         ST    @06,J                                               0336 00454000
         C     @06,@CF00085                                        0336 00455000
         BNH   @DL00291                                            0336 00456000
* MVCOVER = OVERTOT;     /*MOVE IN THE WORDS DESCRIBING THIS GRAND   */ 00457000
         MVC   MVCOVER(16),OVERTOT                                 0337 00458000
* BINWORD = TOTOFTOT;    /*PICK UP OVER ALL TOTAL            @Z427VLS*/ 00459000
         L     @06,TOTOFTOT                                        0338 00460000
         ST    @06,BINWORD                                         0338 00461000
* BNDECNUM = SIX;        /*SET UP TO DO SIX BYTES OF PRINTABLE       */ 00462000
         L     @06,SIX                                             0339 00463000
         ST    @06,BNDECNUM                                        0339 00464000
* DECADDR = ADDR(TOTALVAL);/*ADDRESS OF WHERE TO PUT CONVERTED VALUE */ 00465000
         LA    @06,TOTALVAL                                        0340 00466000
         ST    @06,DECADDR                                         0340 00467000
* CALL CONVBIN;          /*GO CONVERT THE DATA TO PRINTABLE  @Z427VLS*/ 00468000
         BAL   @14,CONVBIN                                         0341 00469000
* BNDECNUM = FIVE;       /*RESET TO = LAST GROUP             @Z427VLS*/ 00470000
         L     @06,FIVE                                            0342 00471000
         ST    @06,BNDECNUM                                        0342 00472000
* DECADDR = DECADDR + SEVEN;/*ADJUST DOWN THE PRINT LINE     @Z427VLS*/ 00473000
         L     @06,DECADDR                                         0343 00474000
         AL    @06,SEVEN                                           0343 00475000
         ST    @06,DECADDR                                         0343 00476000
* DO K = 1 BY 1 TO EVNUM;                                  /*@Z427VLS*/ 00477000
         LA    @06,1                                               0344 00478000
         ST    @06,K                                               0344 00479000
         B     @DE00344                                            0344 00480000
@DL00344 DS    0H                                                  0345 00481000
*  BINWORD = SUBTOT(K);  /*PICK UP THE NEXT OVER ALL TOTAL   @Z427VLS*/ 00482000
         SLA   @06,2                                               0345 00483000
         L     @06,SUBTOT-4(@06)                                   0345 00484000
         ST    @06,BINWORD                                         0345 00485000
*  CALL CONVBIN;         /*GO AND CONVERT THE ITEM TO BINARY @Z427VLS*/ 00486000
         BAL   @14,CONVBIN                                         0346 00487000
*  DECADDR = DECADDR + SIX ;/* MOVE DOWN THE LINE FOR THE NEXT TOTAL */ 00488000
         L     @06,DECADDR                                         0347 00489000
         AL    @06,SIX                                             0347 00490000
         ST    @06,DECADDR                                         0347 00491000
* END;                                                     /*@Z427VLS*/ 00492000
         LA    @06,1                                               0348 00493000
         AL    @06,K                                               0348 00494000
         ST    @06,K                                               0348 00495000
@DE00344 L     @05,EVPTR(,R2)                                      0348 00496000
         CH    @06,EVNUM(,@05)                                     0348 00497000
         BNH   @DL00344                                            0348 00498000
* CALL PRINTIT;          /*AT LAST THE LAST TOTAL LINE       @Z427VLS*/ 00499000
         BAL   @14,PRINTIT                                         0349 00500000
* GENERATE DATA;                                           /*@Z427VLS*/ 00501000
*END;                                                      /*@Z427VLS*/ 00502000
@EL00005 DS    0H                                                  0351 00503000
@EF00005 DS    0H                                                  0351 00504000
@ER00005 LM    @14,@12,@SA00005                                    0351 00505000
         BR    @14                                                 0351 00506000
*/********************************************************************/ 00507000
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */ 00508000
*/*    THIS PROC WILL BUILD THE MAIN HEADING FOR THE OUTPUT  @Z427VLS*/ 00509000
*/*                                                          @Z427VLS*/ 00510000
*MAINHEAD: PROC;                                           /*@Z427VLS*/ 00511000
MAINHEAD STM   @14,@12,@SA00006                                    0352 00512000
*  SPACING = UPSPACE;         /*TIME FOR A NEW PAGE          @Z427VLS*/ 00513000
         MVC   SPACING(1),UPSPACE                                  0353 00514000
*  CALL PRINTIT;              /*SKIP TO CHANNEL ONE          @Z427VLS*/ 00515000
         BAL   @14,PRINTIT                                         0354 00516000
*  SPACING = SINGLE;          /*RETURN TO PRINT AND SKIP ONE LINE    */ 00517000
         MVC   SPACING(1),SINGLE                                   0355 00518000
*  HEAD01 = LINE01;           /*MOVE IN THE MAIN HEADING EVENT H--   */ 00519000
         MVC   HEAD01(13),LINE01                                   0356 00520000
*  DAYSDATE = DATENOW;        /*PARM PROCESSOR SHOULD HAVE FILLED THS*/ 00521000
         MVC   DAYSDATE(6),DATENOW(R2)                             0357 00522000
*  TODAYDT = REPORTDY;        /*MOVE WORDS 'REPORT DATE TO PRINT LINE*/ 00523000
         MVC   TODAYDT(12),REPORTDY                                0358 00524000
*  CALL PRINTIT;              /*GO PRINT THE FIRST LINE      @Z427VLS*/ 00525000
         BAL   @14,PRINTIT                                         0359 00526000
*  NUMBER = ONE;              /*SET FOR ONE BYTE TO BE CONVERTED     */ 00527000
         L     @06,ONE                                             0360 00528000
         ST    @06,NUMBER                                          0360 00529000
*  NEXTBY = ADDR(EVSYEAR);    /*SET UP THE ADDRESS OF THE DATE       */ 00530000
         LA    @06,EVSYEAR(,R2)                                    0361 00531000
         ST    @06,NEXTBY                                          0361 00532000
*  ADDNXT = ADDR(DATEYR);     /*SET UP WHERE TO PUT THE CONVERTED DAY*/ 00533000
         LA    @06,DATEYR                                          0362 00534000
         ST    @06,ADDNXT                                          0362 00535000
*  CALL CONVERT;              /*GO CONVERT THE DATE          @Z427VLS*/ 00536000
         BAL   @14,CONVERT                                         0363 00537000
*  NUMBER = TWO;              /*SET UP TO CONVERT TWO BYTES OF DATA  */ 00538000
         L     @06,TWO                                             0364 00539000
         ST    @06,NUMBER                                          0364 00540000
*  SWITCH1 = ON;              /*SET TO DROP THE 1/2 BYTE     @Z427VLS*/ 00541000
         OI    SWITCH1,B'10000000'                                 0365 00542000
*  SRL(EVSDAY,FOUR);          /*CHUCK THE F IN LAST 1/2 BYTE @Z427VLS*/ 00543000
         LH    @06,EVSDAY(,R2)                                     0366 00544000
         N     @06,@CF01587                                        0366 00545000
         SRL   @06,4                                               0366 00546000
         STH   @06,EVSDAY(,R2)                                     0366 00547000
*  NEXTBY = ADDR(EVSDAY);     /*SET UP WHERE TO GET THE DAY  @Z427VLS*/ 00548000
         LA    @06,EVSDAY(,R2)                                     0367 00549000
         ST    @06,NEXTBY                                          0367 00550000
*  ADDNXT = ADDR(DATEDAY)-1;  /*SET WHERE TO PUT CONVERTED DAY       */ 00551000
         LA    @06,DATEDAY                                         0368 00552000
         BCTR  @06,0                                               0368 00553000
         ST    @06,ADDNXT                                          0368 00554000
*  CALL CONVERT;              /*GO CONVERT THE DAY TO PRINTABLE      */ 00555000
         BAL   @14,CONVERT                                         0369 00556000
*  HEDDATE = HEADDATE;        /*MOVE IN THE DATA TO THE PRINT LINE   */ 00557000
         MVC   HEDDATE(18),HEADDATE                                0370 00558000
*  CALL PRINTIT;              /*GO PRINT THE FROM DAY YEAR   @Z427VLS*/ 00559000
         BAL   @14,PRINTIT                                         0371 00560000
*  FROMTO = TO;               /*CHANGE THE WORD (FROM) TO (TO)       */ 00561000
         MVC   FROMTO(5),TO                                        0372 00562000
*  SWITCH1 = ON;              /*SET SO ONE HALF OF A BYTE IS DROPPED */ 00563000
         OI    SWITCH1,B'10000000'                                 0373 00564000
*  NEXTBY = ADDR(EVDAY);      /*ADDRESS OF DATA              @Z427VLS*/ 00565000
         L     @06,EVPTR(,R2)                                      0374 00566000
         LA    @05,EVDAY(,@06)                                     0374 00567000
         ST    @05,NEXTBY                                          0374 00568000
*  ADDNXT = ADDR(DATEDAY)-1;  /*SET WHERE TO PUT CONVERTED DAY       */ 00569000
         LA    @05,DATEDAY                                         0375 00570000
         BCTR  @05,0                                               0375 00571000
         ST    @05,ADDNXT                                          0375 00572000
*  SRL(EVDAY,FOUR);           /*MOVE THE F OUT OF THE DAY FIELD      */ 00573000
         SLR   @05,@05                                             0376 00574000
         ICM   @05,3,EVDAY(@06)                                    0376 00575000
         SRL   @05,4                                               0376 00576000
         STCM  @05,3,EVDAY(@06)                                    0376 00577000
*  CALL CONVERT;              /*CHANGE THE LAST DAY TO PRINTABLE     */ 00578000
         BAL   @14,CONVERT                                         0377 00579000
*  NUMBER =  ONE;             /*SET UP TO DO JUST ONE BYTE   @Z427VLS*/ 00580000
         L     @06,ONE                                             0378 00581000
         ST    @06,NUMBER                                          0378 00582000
*  NEXTBY = ADDR(EVYEAR);     /*SET UP THE ADDRESS OF THE LAST YEAR  */ 00583000
         L     @06,EVPTR(,R2)                                      0379 00584000
         ST    @06,NEXTBY                                          0379 00585000
*  ADDNXT = ADDR(DATEYR);     /*SET UP ADDRESS WHERE TO PUT THE YEAR */ 00586000
         LA    @06,DATEYR                                          0380 00587000
         ST    @06,ADDNXT                                          0380 00588000
*  CALL CONVERT;              /*CONVERT THE LAST RECORD DATE TO PRINT*/ 00589000
         BAL   @14,CONVERT                                         0381 00590000
*  HEDDATE = HEADDATE;        /*MOVE THE DATA TO THE PRINT LINE      */ 00591000
         MVC   HEDDATE(18),HEADDATE                                0382 00592000
*  CALL PRINTIT;              /*GO PRINT THE TO DATE INFORMATION     */ 00593000
         BAL   @14,PRINTIT                                         0383 00594000
*END;                                                      /*@Z427VLS*/ 00595000
@EL00006 DS    0H                                                  0384 00596000
@EF00006 DS    0H                                                  0384 00597000
@ER00006 LM    @14,@12,@SA00006                                    0384 00598000
         BR    @14                                                 0384 00599000
*/********************************************************************/ 00600000
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */ 00601000
*/*    THIS PROC WILL PRINT THE NEW DATE WHEN CALLED,FROM THE RECORD */ 00602000
*/*                                                          @Z427VLS*/ 00603000
*NEWDATE: PROC;                                            /*@Z427VLS*/ 00604000
NEWDATE  STM   @14,@12,@SA00007                                    0385 00605000
*  IF DEBUG24 ^= ON THEN      /*IF SO DO NOT WANT SPACE      @Z427VLS*/ 00606000
         TM    DEBUG24(R2),B'10000000'                             0386 00607000
         BO    @RF00386                                            0386 00608000
*   CALL PRINTIT;             /*UPSPACE ONE LINE FOR LOOKS   @Z427VLS*/ 00609000
         BAL   @14,PRINTIT                                         0387 00610000
*  LASTDATE = LRTDATE;        /*CHANGE THE BREAKPOINT TO THE NEW DATE*/ 00611000
@RF00386 MVC   LASTDATE(4),LRTDATE(R7)                             0388 00612000
*  NUMBER = ONE;              /*SET UP TO CONVERT 1 BYTE OF HEX      */ 00613000
         L     @06,ONE                                             0389 00614000
         ST    @06,NUMBER                                          0389 00615000
*  NEXTBY = ADDR(LRTYEAR);    /*SET UP ADDRESS OF WHERE TO PUT IT    */ 00616000
         LA    @06,LRTYEAR(,R7)                                    0390 00617000
         ST    @06,NEXTBY                                          0390 00618000
*  ADDNXT = ADDR(YEARJUL);    /*SET UP ADDRESS OF THE YEAR IN RECORD */ 00619000
         LA    @06,YEARJUL                                         0391 00620000
         ST    @06,ADDNXT                                          0391 00621000
*  CALL CONVERT;              /*GO FORMATE THE YEAR FOR PRINTING     */ 00622000
         BAL   @14,CONVERT                                         0392 00623000
*  NUMBER= TWO;               /*SET UP TO CONVERT THE JULIAN DATE    */ 00624000
         L     @06,TWO                                             0393 00625000
         ST    @06,NUMBER                                          0393 00626000
*  SWITCH1 = ON;                                           /*@Z427VLS*/ 00627000
         OI    SWITCH1,B'10000000'                                 0394 00628000
*  TABLECHH = LRTDAY;         /*MOVE SO WE CAN SHIFT OUT THE 'F'X */    00629000
         MVC   TABLECHH(2),LRTDAY(R7)                              0395 00630000
*  SRL(TABLECHH,FOUR);        /*SHIFT OUT THE F IN THE DATE  @0001VLS*/ 00631000
         SLR   @06,@06                                             0396 00632000
         ICM   @06,3,TABLECHH                                      0396 00633000
         SRL   @06,4                                               0396 00634000
         STCM  @06,3,TABLECHH                                      0396 00635000
*  NEXTBY = ADDR(TABLECHH);   /*SET UP WHERE THE INFO TO CONVERT IS*/   00636000
         LA    @06,TABLECHH                                        0397 00637000
         ST    @06,NEXTBY                                          0397 00638000
*  ADDNXT = ADDR(DAYJUL);     /*SET UP ADDRESS OF WHERE TO PUT DATA  */ 00639000
         LA    @06,DAYJUL                                          0398 00640000
         ST    @06,ADDNXT                                          0398 00641000
*  CALL CONVERT;              /*CONVERT THE DATA TO PRINTABLE        */ 00642000
         BAL   @14,CONVERT                                         0399 00643000
*  NEWDATEO = NEWDATEH;       /*MOVE THE LINE TO THE PRINT BUFFER    */ 00644000
         MVC   NEWDATEO(12),NEWDATEH                               0400 00645000
*  IF DEBUG24 ^= ON THEN      /*IF TRUE ONLY ONE LINE OUT    @Z427VLS*/ 00646000
         TM    DEBUG24(R2),B'10000000'                             0401 00647000
         BO    @RF00401                                            0401 00648000
*  DO;                                                     /*@Z427VLS*/ 00649000
*  GEN(MVI  TIME1+13,X'40');                               /*@Z427VLS*/ 00650000
         MVI  TIME1+13,X'40'                                            00651000
*  GEN(MVC  TIME1+14(120),TIME1+13);                       /*@Z427VLS*/ 00652000
         MVC  TIME1+14(120),TIME1+13                                    00653000
*   SPACING = DOUBLE ;        /*SET SPACING TO DOUBLE FOR THIS LINE  */ 00654000
         MVC   SPACING(1),DOUBLE                                   0405 00655000
*  END;                                                    /*@Z427VLS*/ 00656000
*  MYLINECT = MYLINECT + ONE; /*ADJUST FOR THE DOUBLE SPACING        */ 00657000
@RF00401 LH    @06,MYLINECT                                        0407 00658000
         AL    @06,ONE                                             0407 00659000
         STH   @06,MYLINECT                                        0407 00660000
*  CALL PRINTIT;              /*GO PRINT THE NEW DAY YEAR    @Z427VLS*/ 00661000
         BAL   @14,PRINTIT                                         0408 00662000
*  SPACING = SINGLE;          /*RETURN THE SPACING TO NORMAL(ONE)    */ 00663000
         MVC   SPACING(1),SINGLE                                   0409 00664000
*END;                                                      /*@Z427VLS*/ 00665000
@EL00007 DS    0H                                                  0410 00666000
@EF00007 DS    0H                                                  0410 00667000
@ER00007 LM    @14,@12,@SA00007                                    0410 00668000
         BR    @14                                                 0410 00669000
*/********************************************************************/ 00670000
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */ 00671000
*/*    THIS PROC WILL SETUP LINKAGE TO ACCESS I/O SERVICE PRINT      */ 00672000
*/*                                                          @Z427VLS*/ 00673000
*PRINTIT: PROC;                                            /*@Z427VLS*/ 00674000
PRINTIT  STM   @14,@12,@SA00008                                    0411 00675000
*  PRINTADR = ADDR(PRTLINE);                               /*@Z427VLS*/ 00676000
         LA    @06,PRTLINE                                         0412 00677000
         ST    @06,PRINTADR(,R2)                                   0412 00678000
*  CALL IOHND(RITEPRTR);      /*PASS CONTROL TO I/O HANDLER  @Z427VLS*/ 00679000
         L     @15,ADIOHND(,R2)                                    0413 00680000
         LA    @01,@AL00413                                        0413 00681000
         BALR  @14,@15                                             0413 00682000
*  IF SPACING = SINGLE        /*SINGLE SPACING REQUESTED     @Z427VLS*/ 00683000
*   THEN                                                           0414 00684000
         CLC   SPACING(1),SINGLE                                   0414 00685000
         BNE   @RF00414                                            0414 00686000
*    MYLINECT = MYLINECT + ONE;                            /*@Z427VLS*/ 00687000
         LH    @06,MYLINECT                                        0415 00688000
         AL    @06,ONE                                             0415 00689000
         STH   @06,MYLINECT                                        0415 00690000
*   ELSE                                                           0416 00691000
*    IF SPACING = DOUBLE      /*DOUBLE SPACING REQUESTED     @Z427VLS*/ 00692000
*     THEN                                                         0416 00693000
         B     @RC00414                                            0416 00694000
@RF00414 CLC   SPACING(1),DOUBLE                                   0416 00695000
         BNE   @RF00416                                            0416 00696000
*      MYLINECT = MYLINECT + TWO;                          /*@Z427VLS*/ 00697000
         LH    @06,MYLINECT                                        0417 00698000
         AL    @06,TWO                                             0417 00699000
         STH   @06,MYLINECT                                        0417 00700000
*     ELSE                                                         0418 00701000
*      IF SPACING = TRIPLE    /*RIGHT U GUESSED TRIPLE SPACING REQUES*/ 00702000
*       THEN                                                       0418 00703000
         B     @RC00416                                            0418 00704000
@RF00416 CLC   SPACING(1),TRIPLE                                   0418 00705000
         BNE   @RF00418                                            0418 00706000
*        MYLINECT = MYLINECT + THREE;/*ELSE IT'S AN UPSPACE  @Z427VLS*/ 00707000
         LH    @06,MYLINECT                                        0419 00708000
         LA    @06,3(,@06)                                         0419 00709000
         STH   @06,MYLINECT                                        0419 00710000
*       ELSE                                                       0420 00711000
*        IF SPACING = UPSPACE     /*IF TRUE LINECT MUST BE RESET     */ 00712000
*           THEN                                                   0420 00713000
         B     @RC00418                                            0420 00714000
@RF00418 CLC   SPACING(1),UPSPACE                                  0420 00715000
         BNE   @RF00420                                            0420 00716000
*             MYLINECT = ZERO;                             /*@Z427VLS*/ 00717000
         SLR   @06,@06                                             0421 00718000
         STH   @06,MYLINECT                                        0421 00719000
* IF SWITCH5 = ON & MYLINECT=> LINECT THEN/*HEADING FOR SUMMARY*/  0422 00720000
@RF00420 DS    0H                                                  0422 00721000
@RC00418 DS    0H                                                  0422 00722000
@RC00416 DS    0H                                                  0422 00723000
@RC00414 TM    SWITCH5,B'00001000'                                 0422 00724000
         BNO   @RF00422                                            0422 00725000
         LH    @06,MYLINECT                                        0422 00726000
         CH    @06,LINECT(,R2)                                     0422 00727000
         BL    @RF00422                                            0422 00728000
*  DO;                                                     /*@Z427VLS*/ 00729000
*   KEEPSP = SPACING;                                      /*@Z427VLS*/ 00730000
         MVC   KEEPSP(1),SPACING                                   0424 00731000
*   SPACING = UPSPACE;                                     /*@Z427VLS*/ 00732000
         MVC   SPACING(1),UPSPACE                                  0425 00733000
*   PRINTADR = ADDR(PRTLINE);                              /*@Z427VLS*/ 00734000
         LA    @06,PRTLINE                                         0426 00735000
         ST    @06,PRINTADR(,R2)                                   0426 00736000
*   CALL IOHND(RITEPRTR);                                  /*@Z427VLS*/ 00737000
         L     @15,ADIOHND(,R2)                                    0427 00738000
         LA    @01,@AL00427                                        0427 00739000
         BALR  @14,@15                                             0427 00740000
*MYLINECT = THREE;                                         /*@0001VLS*/ 00741000
         MVC   MYLINECT(2),@CH00075                                0428 00742000
*RESPECIFY (R6) RESTRICTED;                                /*@0001VLS*/ 00743000
*  SPACING = SINGLE;                                       /*@0001VLS*/ 00744000
         MVC   SPACING(1),SINGLE                                   0430 00745000
*  TOTALHD2 = TOTALHD1;     /*MOVE IN THE FIRST PART OF THE HEADING  */ 00746000
         MVC   TOTALHD2(12),TOTALHD1                               0431 00747000
* R6 = ADDR(TOTALHD3);    /*WHERE THE HEADING IS AT          @0001VLS*/ 00748000
         LA    R6,TOTALHD3                                         0432 00749000
* R8 = ADDR(TIME1) + 26;  /*WHERE TO MOVE THE LINE TO        @0001VLS*/ 00750000
         LA    R8,TIME1                                            0433 00751000
         AL    R8,@CF01168                                         0433 00752000
* R9 = 7 + SIX * EVNUM;   /*HOW MANY BYTES TO MOVE INTO THE HEADING*/   00753000
         L     @05,EVPTR(,R2)                                      0434 00754000
         L     R9,SIX                                              0434 00755000
         MH    R9,EVNUM(,@05)                                      0434 00756000
         AL    R9,@CF00082                                         0434 00757000
* GEN(EX  R9,MOVECHAR);   /*MOVE THE CHARACTERS INTO THE PRINT BUFF*/   00758000
         EX  R9,MOVECHAR                                                00759000
*RESPECIFY (R6) UNRESTRICTED;                              /*@0001VLS*/ 00760000
*PRINTADR = ADDR(PRTLINE);    /*TELL I/O WHERE THE BUFFER IS AT*/  0437 00761000
         LA    @06,PRTLINE                                         0437 00762000
         ST    @06,PRINTADR(,R2)                                   0437 00763000
*CALL IOHND(RITEPRTR);        /*GO WRITE THE HEADING TO THE BUFFER*/    00764000
         L     @15,ADIOHND(,R2)                                    0438 00765000
         LA    @01,@AL00438                                        0438 00766000
         BALR  @14,@15                                             0438 00767000
*   SPACING = KEEPSP;                                      /*@Z427VLS*/ 00768000
         MVC   SPACING(1),KEEPSP                                   0439 00769000
*  END;                                                    /*@Z427VLS*/ 00770000
*END;                                                      /*@Z427VLS*/ 00771000
@EL00008 DS    0H                                                  0441 00772000
@EF00008 DS    0H                                                  0441 00773000
@ER00008 LM    @14,@12,@SA00008                                    0441 00774000
         BR    @14                                                 0441 00775000
*/********************************************************************/ 00776000
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */ 00777000
*/*    THIS PROC WILL CONVERT THE TIME IN THE RECORD TO PRINTABLE    */ 00778000
*/*                                                          @Z427VLS*/ 00779000
*TIME:  PROC;                                              /*@Z427VLS*/ 00780000
TIME     STM   @14,@12,@SA00009                                    0442 00781000
*  NEXTBY  =  ADDR(LRTTIME);     /*SET POINTER TO POINT TO TIME FIELD*/ 00782000
         LA    @06,LRTTIME(,R7)                                    0443 00783000
         ST    @06,NEXTBY                                          0443 00784000
*  NUMBER = ONE;                 /*CONVERT 1 TO ALLOW FOR SPACES     */ 00785000
         L     @06,ONE                                             0444 00786000
         ST    @06,NUMBER                                          0444 00787000
*  ADDNXT = ADDR(TIME1);         /*SET POINTER TO START OF OUTPUT    */ 00788000
         LA    @06,TIME1                                           0445 00789000
         ST    @06,ADDNXT                                          0445 00790000
*  DO R = 4 BY -1 TO 1;          /*CONV HR'S MINS SECONDS    @Z427VLS*/ 00791000
         LA    @06,4                                               0446 00792000
         ST    @06,R                                               0446 00793000
@DL00446 DS    0H                                                  0447 00794000
*    CALL CONVERT;               /*CONVERT THE BYTE OF DATA  @Z427VLS*/ 00795000
         BAL   @14,CONVERT                                         0447 00796000
*    NEXTBY = NEXTBY + ONE;      /*MOVE TO THE NEXT FIELD    @Z427VLS*/ 00797000
         L     @06,NEXTBY                                          0448 00798000
         AL    @06,ONE                                             0448 00799000
         ST    @06,NEXTBY                                          0448 00800000
*    ADDNXT = ADDNXT + THREE;    /*ALLOW FOR BLANK BETWEEN EACH FIELD*/ 00801000
         LA    @06,3                                               0449 00802000
         AL    @06,ADDNXT                                          0449 00803000
         ST    @06,ADDNXT                                          0449 00804000
*  END;                                                    /*@Z427VLS*/ 00805000
         SLR   @06,@06                                             0450 00806000
         BCTR  @06,0                                               0450 00807000
         AL    @06,R                                               0450 00808000
         ST    @06,R                                               0450 00809000
         LTR   @06,@06                                             0450 00810000
         BP    @DL00446                                            0450 00811000
*END;                                                      /*@Z427VLS*/ 00812000
@EL00009 DS    0H                                                  0451 00813000
@EF00009 DS    0H                                                  0451 00814000
@ER00009 LM    @14,@12,@SA00009                                    0451 00815000
         BR    @14                                                 0451 00816000
* /*******************************************************************/ 00817000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 00818000
* /*    THIS PROC WILL MOVE THE DATA FOR EACH TYPE OF RECORD INTO    */ 00819000
* /*    THE PRINT LINE                                       @Z427VLS*/ 00820000
*MOVEDATA:  PROC;                                          /*@Z427VLS*/ 00821000
MOVEDATA STM   @14,@12,@SA00010                                    0452 00822000
*/*EREPCASE (CURRENT) VALUES(1,2,3,4,5,6,7,8,9,10,11)*/            0453 00823000
* DCL  I0001   FIXED(15);                                          0453 00824000
* I0001 = 0;                                                       0454 00825000
         SLR   I0001,I0001                                         0454 00826000
* IF CURRENT = 1 THEN                                              0455 00827000
         CLC   CURRENT(4),@CF00055                                 0455 00828000
         BNE   @RF00455                                            0455 00829000
*      I0001 = 4 ;                                                 0456 00830000
         LA    I0001,4                                             0456 00831000
* IF CURRENT = 2 THEN                                              0457 00832000
@RF00455 CLC   CURRENT(4),@CF00073                                 0457 00833000
         BNE   @RF00457                                            0457 00834000
*      I0001 = 8 ;                                                 0458 00835000
         LA    I0001,8                                             0458 00836000
* IF CURRENT = 3 THEN                                              0459 00837000
@RF00457 CLC   CURRENT(4),@CF00075                                 0459 00838000
         BNE   @RF00459                                            0459 00839000
*      I0001 = 12 ;                                                0460 00840000
         LA    I0001,12                                            0460 00841000
* IF CURRENT = 4 THEN                                              0461 00842000
@RF00459 CLC   CURRENT(4),@CF00035                                 0461 00843000
         BNE   @RF00461                                            0461 00844000
*      I0001 = 16 ;                                                0462 00845000
         LA    I0001,16                                            0462 00846000
* IF CURRENT = 5 THEN                                              0463 00847000
@RF00461 CLC   CURRENT(4),@CF00078                                 0463 00848000
         BNE   @RF00463                                            0463 00849000
*      I0001 = 20 ;                                                0464 00850000
         LA    I0001,20                                            0464 00851000
* IF CURRENT = 6 THEN                                              0465 00852000
@RF00463 CLC   CURRENT(4),@CF00080                                 0465 00853000
         BNE   @RF00465                                            0465 00854000
*      I0001 = 24 ;                                                0466 00855000
         LA    I0001,24                                            0466 00856000
* IF CURRENT = 7 THEN                                              0467 00857000
@RF00465 CLC   CURRENT(4),@CF00082                                 0467 00858000
         BNE   @RF00467                                            0467 00859000
*      I0001 = 28 ;                                                0468 00860000
         LA    I0001,28                                            0468 00861000
* IF CURRENT = 8 THEN                                              0469 00862000
@RF00467 CLC   CURRENT(4),@CF00065                                 0469 00863000
         BNE   @RF00469                                            0469 00864000
*      I0001 = 32 ;                                                0470 00865000
         LA    I0001,32                                            0470 00866000
* IF CURRENT = 9 THEN                                              0471 00867000
@RF00469 CLC   CURRENT(4),@CF00085                                 0471 00868000
         BNE   @RF00471                                            0471 00869000
*      I0001 = 36 ;                                                0472 00870000
         LA    I0001,36                                            0472 00871000
* IF CURRENT = 10 THEN                                             0473 00872000
@RF00471 CLC   CURRENT(4),@CF00032                                 0473 00873000
         BNE   @RF00473                                            0473 00874000
*      I0001 = 40 ;                                                0474 00875000
         LA    I0001,40                                            0474 00876000
* IF CURRENT = 11 THEN                                             0475 00877000
@RF00473 CLC   CURRENT(4),@CF00033                                 0475 00878000
         BNE   @RF00475                                            0475 00879000
*      I0001 = 44 ;                                                0476 00880000
         LA    I0001,44                                            0476 00881000
* GENERATE;                                                        0477 00882000
@RF00475 DS    0H                                                  0477 00883000
    B    L00010(I0001)                                                  00884000
L00010 B    L000112                                                     00885000
    B    L00011                                                         00886000
    B    L00012                                                         00887000
    B    L00013                                                         00888000
    B    L00014                                                         00889000
    B    L00015                                                         00890000
    B    L00016                                                         00891000
    B    L00017                                                         00892000
    B    L00018                                                         00893000
    B    L00019                                                         00894000
    B    L000110                                                        00895000
    B    L000111                                                        00896000
* /*******************************************************************/ 00897000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 00898000
* /*    THIS CASE WILL HANDLE ALL MCH TYPE RECORDS           @Z427VLS*/ 00899000
*                                                                  0478 00900000
*/*EREPSUB  */                                                     0478 00901000
*L00011:                                                           0478 00902000
*     DO;                                               /*@Z427VLS*/    00903000
L00011   DS    0H                                                  0479 00904000
*    CALL TIME;                     /*MOVE THE TIME INTO THE PRINT L */ 00905000
         BAL   @14,TIME                                            0479 00906000
*    JOBNAME1 = MCHJOBID;           /*MOVE THE JOB NAME INTO PRINT L */ 00907000
         MVC   JOBNAME1(8),MCHJOBID(R7)                            0480 00908000
*    CPU12 = EVLETTER(PTR);    /*MOVE IN THE CPU LETTER      @0001VLS*/ 00909000
         L     @06,PTR                                             0481 00910000
         LR    @05,@06                                             0481 00911000
         MH    @05,@CH00080                                        0481 00912000
         L     @03,EVPTR(,R2)                                      0481 00913000
         ALR   @03,@05                                             0481 00914000
         MVC   CPU12(1),EVLETTER-6(@03)                            0481 00915000
*    IF MCHSYSTR = ON               /*DID IT TERMINATE THE SYSTEM    */ 00916000
*      THEN                         /*YES BIT IS ON          @Z427VLS*/ 00917000
         TM    MCHSYSTR(R7),B'10000000'                            0482 00918000
         BNO   @RF00482                                            0482 00919000
*       DO;                                                /*@Z427VLS*/ 00920000
*        RECTYP1 = MCHTRM;          /*SET TYPE = TO  MCH-TRM @Z427VLS*/ 00921000
         MVC   RECTYP1(7),MCHTRM                                   0484 00922000
*        MCHTRMCT(PTR) = MCHTRMCT(PTR) + ONE;              /*@Z427VLS*/ 00923000
         SLA   @06,2                                               0485 00924000
         L     @05,MCHTRMCT-4(@06)                                 0485 00925000
         AL    @05,ONE                                             0485 00926000
         ST    @05,MCHTRMCT-4(@06)                                 0485 00927000
*       END;                                               /*@Z427VLS*/ 00928000
*      ELSE                                                        0487 00929000
*       DO;                                                /*@Z427VLS*/ 00930000
         B     @RC00482                                            0487 00931000
@RF00482 DS    0H                                                  0488 00932000
*        RECTYP1 = MCH;             /*SET TO PLAIN   MCH     @Z427VLS*/ 00933000
         MVC   RECTYP1(7),MCH                                      0488 00934000
*        MCHCT(PTR) = MCHCT(PTR) + ONE;                    /*@Z427VLS*/ 00935000
         L     @06,PTR                                             0489 00936000
         SLA   @06,2                                               0489 00937000
         L     @05,MCHCT-4(@06)                                    0489 00938000
         AL    @05,ONE                                             0489 00939000
         ST    @05,MCHCT-4(@06)                                    0489 00940000
*       END;                                               /*@Z427VLS*/ 00941000
*    NUMBER = ONE;                  /*SET UP # OF BYTES TO CONVERT   */ 00942000
@RC00482 L     @06,ONE                                             0491 00943000
         ST    @06,NUMBER                                          0491 00944000
*    ADDNXT = ADDR(PSWMCH) ;        /*SET UP BASE FOR OUTPUT ADDRESS */ 00945000
         LA    @06,PSWMCH                                          0492 00946000
         ST    @06,ADDNXT                                          0492 00947000
*    NEXTBY = ADDR(MCHMOD);         /*SET BASE TO POINT TO MCH MODLE */ 00948000
         LA    @06,MCHMOD(,R7)                                     0493 00949000
         ST    @06,NEXTBY                                          0493 00950000
*    CALL CONVERT;                  /*GO CONVERT THE MODLE TO PRINT  */ 00951000
         BAL   @14,CONVERT                                         0494 00952000
*    NUMBER = EIGHT;                /*SET UP # OF BYTES TO CONVERT   */ 00953000
         MVC   NUMBER(4),@CF00065                                  0495 00954000
*    ADDNXT  = ADDR(PSWMCH);        /*SET BASE TO POINT TO START ADD */ 00955000
         LA    @06,PSWMCH                                          0496 00956000
         ST    @06,ADDNXT                                          0496 00957000
*    NEXTBY = ADDR(MCHOPSW);        /*SET BASE POINTER TO DATA ADDRES*/ 00958000
         LA    @06,MCHOPSW(,R7)                                    0497 00959000
         ST    @06,NEXTBY                                          0497 00960000
*    CALL CONVERT;                  /*CALL PROGRAM TO CONVERT DATA   */ 00961000
         BAL   @14,CONVERT                                         0498 00962000
*IF  LRTKEY1 = '13'X &                                             0499 00963000
*    (LRTERRID & '10'X) = '10'X THEN                               0499 00964000
         CLI   LRTKEY1(R7),X'13'                                   0499 00965000
         BNE   @RF00499                                            0499 00966000
         MVC   @TS00001(1),LRTERRID(R7)                            0499 00967000
         NI    @TS00001,X'10'                                      0499 00968000
         CLI   @TS00001,X'10'                                      0499 00969000
         BNE   @RF00499                                            0499 00970000
* DO;                                                      /*@0098VLS*/ 00971000
* NUMBER = 10;   /*ERRORID1 HAS 10 BYTES                     @0098VLS*/ 00972000
         LA    @06,10                                              0501 00973000
         ST    @06,NUMBER                                          0501 00974000
* ADDNXT = ADDR(ERRORID1); /*ADDRESS IN THE OUTPUT LINE TO PLACE IT*/   00975000
         LA    @05,ERRORID1                                        0502 00976000
         ST    @05,ADDNXT                                          0502 00977000
* NEXTBY = ADDR(RERR);/*ADDRESS OF ERRORID1(R7 + RECLNGTH  - 10*/  0503 00978000
         LR    @05,R7                                              0503 00979000
         AH    @05,RECLNGTH(,R2)                                   0503 00980000
         SLR   @05,@06                                             0503 00981000
         ST    @05,NEXTBY                                          0503 00982000
* CALL CONVERT; /*GO CONVERT THE ITEM TO PRINTABLE           @0098VLS*/ 00983000
         BAL   @14,CONVERT                                         0504 00984000
* END;                                                     /*@0098VLS*/ 00985000
* ELSE                                                             0506 00986000
* ERRORNA = NOTAPPLY; /*PUT IN THE WORDS NOT AVAIBLE         @0098VLS*/ 00987000
*                                                                  0506 00988000
         B     @RC00499                                            0506 00989000
@RF00499 MVC   ERRORNA(8),NOTAPPLY                                 0506 00990000
*/*EREPSEND  */                                                    0507 00991000
*       GO TO L000113;                                             0507 00992000
         B     L000113                                             0507 00993000
*     END;                                              /*@Z427VLS*/    00994000
* /*******************************************************************/ 00995000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 00996000
* /*    THIS CASE WILL HANDLE ALL CCH TYPE RECORDS           @Z427VLS*/ 00997000
*                                                                  0509 00998000
*/*EREPSUB  */                                                     0509 00999000
*L00012:                                                           0509 01000000
*     DO;                                               /*@Z427VLS*/    01001000
L00012   DS    0H                                                  0510 01002000
*      CALL TIME;                    /*GO CONVERT THIS RECORDS TIME  */ 01003000
         BAL   @14,TIME                                            0510 01004000
*     DO;                                                  /*@G64XXJS*/ 01005000
*/* ANY ONLINE PROCESSORS                                    @G64XXJS*/ 01006000
*      IF CCHMOD > '0168'X & CCHMOD ^= '3062'X & CCHNOCS ^= ZERO   0512 01007000
*         THEN                                                     0512 01008000
         CLC   CCHMOD(2,R7),@CB01420                               0512 01009000
         BNH   @RF00512                                            0512 01010000
         CLC   CCHMOD(2,R7),@CB01421                               0512 01011000
         BE    @RF00512                                            0512 01012000
         LA    @06,CCHLOG(,R7)                                     0512 01013000
         SLR   @05,@05                                             0512 01014000
         ICM   @05,3,CCHLOGLN(R7)                                  0512 01015000
         ALR   @06,@05                                             0512 01016000
         LH    @06,CCHNOCS(,@06)                                   0512 01017000
         LTR   @06,@06                                             0512 01018000
         BZ    @RF00512                                            0512 01019000
*          DO;                                             /*@G64XXJS*/ 01020000
*/* MOVE CSID INTO PRINTLINE                                 @G64XXJS*/ 01021000
*/* SET UP NUMBER OF BYTES TO CONVERT                        @G64XXJS*/ 01022000
*/* SET UP CHANNEL SET ID TO PRINT                           @G64XXJS*/ 01023000
*           SENSEA3(1:5) = CSID;                           /*@G64XXJS*/ 01024000
         MVC   SENSEA3(5),@CC01355                                 0514 01025000
*           NUMBER = 1;                                    /*@G64XXJS*/ 01026000
         LA    @06,1                                               0515 01027000
         ST    @06,NUMBER                                          0515 01028000
*           ADDNXT = ADDR(SENSEA3) + FIVE;                 /*@G64XXJS*/ 01029000
         LA    @05,SENSEA3                                         0516 01030000
         AL    @05,FIVE                                            0516 01031000
         ST    @05,ADDNXT                                          0516 01032000
*           DO J = 1 BY 1 TO CCHNOCS WHILE(J <= 16);       /*@G64XXJS*/ 01033000
         ST    @06,J                                               0517 01034000
         B     @DE00517                                            0517 01035000
@DL00517 C     @06,@CF00088                                        0517 01036000
         BH    @DC00517                                            0517 01037000
*/* FOR EACH ONLINE PROCESSOR, GET ADDRESS OF CHANNEL        @G64XXJS*/ 01038000
*/* SET ID. CONVERT CHANNEL SET ID TO PRINTABLE. PLACE       @G64XXJS*/ 01039000
*/* IN TRAILING COMMA. STEP TO NEXT CHANNEL SET ID           @G64XXJS*/ 01040000
*/* PRINT POSITION. BLANK OUT LAST COMMA.                    @G64XXJS*/ 01041000
*            NEXTBY = ADDR(CCHCSAD(J)) + ONE;              /*@G64XXJS*/ 01042000
         SLA   @06,2                                               0518 01043000
         LA    @05,CCHLOG(,R7)                                     0518 01044000
         SLR   @03,@03                                             0518 01045000
         ICM   @03,3,CCHLOGLN(R7)                                  0518 01046000
         ALR   @05,@03                                             0518 01047000
         LA    @06,CCHCSAD-4(@06,@05)                              0518 01048000
         AL    @06,ONE                                             0518 01049000
         ST    @06,NEXTBY                                          0518 01050000
*            CALL CONVERT;                                 /*@G64XXJS*/ 01051000
         BAL   @14,CONVERT                                         0519 01052000
*            ADDNUM(3) = COMMA;                            /*@G64XXJS*/ 01053000
         L     @06,ADDNXT                                          0520 01054000
         MVI   ADDNUM+2(@06),C','                                  0520 01055000
*            ADDNXT = ADDNXT + 3;                          /*@G64XXJS*/ 01056000
         AL    @06,@CF00075                                        0521 01057000
         ST    @06,ADDNXT                                          0521 01058000
*           END;                                           /*@G64XXJS*/ 01059000
         LA    @06,1                                               0522 01060000
         AL    @06,J                                               0522 01061000
         ST    @06,J                                               0522 01062000
@DE00517 LA    @05,CCHLOG(,R7)                                     0522 01063000
         SLR   @03,@03                                             0522 01064000
         ICM   @03,3,CCHLOGLN(R7)                                  0522 01065000
         ALR   @05,@03                                             0522 01066000
         CH    @06,CCHNOCS(,@05)                                   0522 01067000
         BNH   @DL00517                                            0522 01068000
@DC00517 DS    0H                                                  0523 01069000
*           ADDNXT = ADDNXT - 1;                           /*@G64XXJS*/ 01070000
         L     @06,ADDNXT                                          0523 01071000
         BCTR  @06,0                                               0523 01072000
         ST    @06,ADDNXT                                          0523 01073000
*           ADDNUM(1) = BLANK;                             /*@G64XXJS*/ 01074000
         MVC   ADDNUM(1,@06),BLANK                                 0524 01075000
*          END;                                            /*@G64XXJS*/ 01076000
*     END;                                                 /*@G64XXJS*/ 01077000
@RF00512 DS    0H                                                  0527 01078000
*      JOBNAME1 = CCHJOBID;          /*MOVE THE JOB NAME INTO PRINT  */ 01079000
         MVC   JOBNAME1(8),CCHJOBID(R7)                            0527 01080000
*      IF CCHRINC = ON                                             0528 01081000
*         THEN                                                     0528 01082000
         TM    CCHRINC(R7),B'10000000'                             0528 01083000
         BNO   @RF00528                                            0528 01084000
*          DO;                                             /*@Z427VLS*/ 01085000
*           RECTYP1 = CCHINC;        /*MAKE PRINT READ CCH-INC       */ 01086000
         MVC   RECTYP1(7),CCHINC                                   0530 01087000
*           CCHINCCT(PTR) = CCHINCCT(PTR) + ONE;           /*@Z427VLS*/ 01088000
         L     @06,PTR                                             0531 01089000
         SLA   @06,2                                               0531 01090000
         L     @05,CCHINCCT-4(@06)                                 0531 01091000
         AL    @05,ONE                                             0531 01092000
         ST    @05,CCHINCCT-4(@06)                                 0531 01093000
*          END;                                            /*@Z427VLS*/ 01094000
*         ELSE                                                     0533 01095000
*          DO;                                             /*@Z427VLS*/ 01096000
         B     @RC00528                                            0533 01097000
@RF00528 DS    0H                                                  0534 01098000
*            IF CCHRCRH = ON         /*IS IT A CCH-CRH TYPE RECORD   */ 01099000
*               THEN                                               0534 01100000
         TM    CCHRCRH(R7),B'00001000'                             0534 01101000
         BNO   @RF00534                                            0534 01102000
*                DO;                                       /*@Z427VLS*/ 01103000
*                  RECTYP1 = CCHCRH; /*MAKE PRINT READ CCH-CHR       */ 01104000
         MVC   RECTYP1(7),CCHCRH                                   0536 01105000
*                  CCHCRHCT(PTR) = CCHCRHCT(PTR) + ONE;    /*@Z427VLS*/ 01106000
         L     @06,PTR                                             0537 01107000
         SLA   @06,2                                               0537 01108000
         L     @05,CCHCRHCT-4(@06)                                 0537 01109000
         AL    @05,ONE                                             0537 01110000
         ST    @05,CCHCRHCT-4(@06)                                 0537 01111000
*                END;                                      /*@Z427VLS*/ 01112000
*               ELSE                                               0539 01113000
*                DO;                                       /*@Z427VLS*/ 01114000
         B     @RC00534                                            0539 01115000
@RF00534 DS    0H                                                  0540 01116000
*                  RECTYP1 = CCH;    /*MAKE IT PLAIN CCH     @Z427VLS*/ 01117000
         MVC   RECTYP1(7),CCH                                      0540 01118000
*                  CCHCT(PTR) = CCHCT(PTR) + ONE;          /*@Z427VLS*/ 01119000
         L     @06,PTR                                             0541 01120000
         SLA   @06,2                                               0541 01121000
         L     @05,CCHCT-4(@06)                                    0541 01122000
         AL    @05,ONE                                             0541 01123000
         ST    @05,CCHCT-4(@06)                                    0541 01124000
*                END;                                      /*@Z427VLS*/ 01125000
*          END;                                            /*@Z427VLS*/ 01126000
@RC00534 DS    0H                                                  0544 01127000
*      NUMBER = TWO;                  /*SET TO CONVERT 2 BYTES       */ 01128000
@RC00528 L     @06,TWO                                             0544 01129000
         ST    @06,NUMBER                                          0544 01130000
*      CPU12 = EVLETTER(PTR);         /*INSERT THE CPU LETTER SET BY */ 01131000
         L     @06,PTR                                             0545 01132000
         MH    @06,@CH00080                                        0545 01133000
         L     @05,EVPTR(,R2)                                      0545 01134000
         ALR   @05,@06                                             0545 01135000
         MVC   CPU12(1),EVLETTER-6(@05)                            0545 01136000
*                                     /*IFCFILT4 FOR THIS SERIAL MOD */ 01137000
*      ADDNXT = ADDR(CUA11);          /*SET UP THE CUA TO PRINT      */ 01138000
         LA    @06,CUA11                                           0546 01139000
         ST    @06,ADDNXT                                          0546 01140000
*      NEXTBY = ADDR(CCHCUA);         /*ADDRESS OF WHERE CUA IS      */ 01141000
         LA    @06,CCHCUA(,R7)                                     0547 01142000
         ST    @06,NEXTBY                                          0547 01143000
*      SWITCH1 = ON;                  /*SET NOT TO USE FIRST 1/2 BYTE*/ 01144000
         OI    SWITCH1,B'10000000'                                 0548 01145000
*      CALL CONVERT;                  /*GO CONVERT CUA TO PRINTABLE  */ 01146000
         BAL   @14,CONVERT                                         0549 01147000
*      DEVCOMP = CCHCODE2;            /*PUT DEVICE IN COMMON AREA    */ 01148000
         MVC   DEVCOMP(2),CCHCODE2(R7)                             0550 01149000
*      CALL DODEVICE;                 /*CALL PROC TO BUILD DEVICE NME*/ 01150000
         BAL   @14,DODEVICE                                        0551 01151000
*     NUMBER = EIGHT;      /*SET UP FOR THE CSW              @ZA19014*/ 01152000
         MVC   NUMBER(4),@CF00065                                  0552 01153000
*     ADDNXT = ADDR(CSW1); /*WHERE TO PLACE THE CONVER CSW   @ZA19014*/ 01154000
         LA    @06,CSW1                                            0553 01155000
         ST    @06,ADDNXT                                          0553 01156000
*     NEXTBY = ADDR(CCHCSW);/*WHERE TO GET THE CSW TO CONVE  @ZA19014*/ 01157000
         LA    @06,CCHCSW(,R7)                                     0554 01158000
         ST    @06,NEXTBY                                          0554 01159000
*     CALL CONVERT;       /*GO CONVERT THE CSW TO PRINTABLE  @ZA19014*/ 01160000
*                                                                  0555 01161000
         BAL   @14,CONVERT                                         0555 01162000
*/*EREPSEND  */                                                    0556 01163000
*       GO TO L000113;                                             0556 01164000
         B     L000113                                             0556 01165000
*     END;                                              /*@Z427VLS*/    01166000
* /*******************************************************************/ 01167000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 01168000
* /*    THIS CASE WILL HANDLE ALL OBR TYPE RECORDS           @Z427VLS*/ 01169000
* /*                                                         @Z427VLS*/ 01170000
*                                                                  0558 01171000
*/*EREPSUB  */                                                     0558 01172000
*L00013:                                                           0558 01173000
*     DO;                                               /*@Z427VLS*/    01174000
L00013   DS    0H                                                  0559 01175000
*   CALL TIME;                        /*GO CONVERT THIS RECORDS TIME */ 01176000
         BAL   @14,TIME                                            0559 01177000
*   JOBNAME1 = OBRJOBID;              /*MOVE THE NAME INTO PRINT LINE*/ 01178000
         MVC   JOBNAME1(8),OBRJOBID(R7)                            0560 01179000
*   NUMBER = TWO;                     /*SET # OF BYTES TO CONVERT    */ 01180000
         L     @06,TWO                                             0561 01181000
         ST    @06,NUMBER                                          0561 01182000
*   CPU12 = EVLETTER(PTR) ;           /*INSERT THE CPU LETTER        */ 01183000
         L     @06,PTR                                             0562 01184000
         MH    @06,@CH00080                                        0562 01185000
         L     @05,EVPTR(,R2)                                      0562 01186000
         ALR   @05,@06                                             0562 01187000
         MVC   CPU12(1),EVLETTER-6(@05)                            0562 01188000
*   SWITCH1 = ON;                     /*SET TO NOT DO FIRST 1/2 BYTE */ 01189000
         OI    SWITCH1,B'10000000'                                 0563 01190000
*   ADDNXT = ADDR(CUA11);             /*ADDRESS OF WHERE TO PUT DATA */ 01191000
         LA    @06,CUA11                                           0564 01192000
         ST    @06,ADDNXT                                          0564 01193000
*   IF SHORTSW = ON                   /*IS THIS A SHORT OBR  @Z427VLS*/ 01194000
*     THEN                                                         0565 01195000
         TM    SHORTSW(R7),B'00100000'                             0565 01196000
         BNO   @RF00565                                            0565 01197000
*      DO;                                                 /*@Z427VLS*/ 01198000
*    IF (OBRSDEV2 & 'F000'X) = '8000'X THEN                        0567 01199000
         MVC   @TS00001(2),OBRSDEV2(R7)                            0567 01200000
         NC    @TS00001(2),@CB01425                                0567 01201000
         CLC   @TS00001(2),@CB00198                                0567 01202000
         BNE   @RF00567                                            0567 01203000
*        VOLUME1 = OBRVOL;            /*MOVE IN THE OBR VOLUME ID    */ 01204000
         MVC   VOLUME1(6),OBRVOL(R7)                               0568 01205000
*       DEVICE1 = HH1;                /*WILL SET THE ITEM BACK TO    */ 01206000
@RF00567 MVC   DEVICE1(4),HH1                                      0569 01207000
*                                     /*BLANKS               @Z427VLS*/ 01208000
*       NEXTBY = ADDR(OBRSCUA) + ONE; /*ADDRESS OF CUA IN SHORT OBR  */ 01209000
         LA    @06,OBRSCUA(,R7)                                    0570 01210000
         AL    @06,ONE                                             0570 01211000
         ST    @06,NEXTBY                                          0570 01212000
*       DEVCOMP = OBRSDEV2;           /*SHORT OBR DEVICE     @Z427VLS*/ 01213000
         MVC   DEVCOMP(2),OBRSDEV2(R7)                             0571 01214000
*       JOBNAME1 = NOTAPPLY;                               /*@Z427VLS*/ 01215000
         MVC   JOBNAME1(8),NOTAPPLY                                0572 01216000
*      END;                                                /*@Z427VLS*/ 01217000
*     ELSE                                                         0574 01218000
*      DO;                                                 /*@Z427VLS*/ 01219000
         B     @RC00565                                            0574 01220000
@RF00565 DS    0H                                                  0575 01221000
*       IF OBRCLASS = '80'X THEN                                   0575 01222000
         CLI   OBRCLASS(R7),X'80'                                  0575 01223000
         BNE   @RF00575                                            0575 01224000
*        VOLUME1 = OBRVOL;                                 /*@Z427VLS*/ 01225000
         MVC   VOLUME1(6),OBRVOL(R7)                               0576 01226000
*       IF ((OBRDEV = '2009'X) | (OBRDEV = '200D'X)) &     /*@ZA36018*/ 01227000
*          ((OBRCODE2 & '08'X) = '08'X) THEN               /*@ZA36018*/ 01228000
@RF00575 CLC   OBRDEV(2,R7),@CB01427                               0577 01229000
         BE    @GL00006                                            0577 01230000
         CLC   OBRDEV(2,R7),@CB01428                               0577 01231000
         BNE   @RF00577                                            0577 01232000
@GL00006 MVC   @TS00001(1),OBRCODE2(R7)                            0577 01233000
         NI    @TS00001,X'08'                                      0577 01234000
         CLI   @TS00001,X'08'                                      0577 01235000
         BNE   @RF00577                                            0577 01236000
*          LETTERV = 'V';                                  /*@Z427VLS*/ 01237000
         MVI   LETTERV,C'V'                                        0578 01238000
*      IF DEBUG29 = ON THEN  /*USE SECONDARY CUA RATHER THAN PRIMARY*/  01239000
@RF00577 TM    DEBUG29(R2),B'00000100'                             0579 01240000
         BNO   @RF00579                                            0579 01241000
*       NEXTBY = ADDR(OBRSECUA) + 1;/*ADDRESS OF THE SECONDARY CUA*/    01242000
         LA    @06,OBRSECUA(,R7)                                   0580 01243000
         AL    @06,@CF00055                                        0580 01244000
         ST    @06,NEXTBY                                          0580 01245000
*      ELSE                                                        0581 01246000
*       NEXTBY = ADDR(OBRPCUA) + ONE; /*ADDRESS OF LONG OBR CUA      */ 01247000
         B     @RC00579                                            0581 01248000
@RF00579 LA    @06,OBRPCUA(,R7)                                    0581 01249000
         AL    @06,ONE                                             0581 01250000
         ST    @06,NEXTBY                                          0581 01251000
*       DEVCOMP = OBRDEV;             /*LONG OBR DEVICE TYPE @Z427VLS*/ 01252000
@RC00579 MVC   DEVCOMP(2),OBRDEV(R7)                               0582 01253000
*   JOBNAME1 = OBRJOBID;              /*MOVE THE NAME INTO PRINT LINE*/ 01254000
         MVC   JOBNAME1(8),OBRJOBID(R7)                            0583 01255000
*    IF LRTKEY1 ='36'X |   /*WILL ALWAYS HAVE A TERMINAL NAME    */     01256000
*     ((LRTKEY1 = '34'X | LRTKEY1 = '32'X) & OBRTCAM = '0F'X) THEN 0584 01257000
         CLI   LRTKEY1(R7),X'36'                                   0584 01258000
         BE    @RT00584                                            0584 01259000
         CLI   LRTKEY1(R7),X'34'                                   0584 01260000
         BE    @GL00009                                            0584 01261000
         CLI   LRTKEY1(R7),X'32'                                   0584 01262000
         BNE   @RF00584                                            0584 01263000
@GL00009 CLI   OBRTCAM(R7),X'0F'                                   0584 01264000
         BNE   @RF00584                                            0584 01265000
@RT00584 DS    0H                                                  0585 01266000
*       TERMNAME = OBRTERMN;    /*MOVE TERMINAL NAME TO PRT BUFFER*/    01267000
         MVC   TERMNAME(8),OBRTERMN(R7)                            0585 01268000
*      END;                                                /*@Z427VLS*/ 01269000
@RF00584 DS    0H                                                  0587 01270000
*   CALL CONVERT;                     /*GO CONVERT 1 & 1/2 BYTES     */ 01271000
@RC00565 BAL   @14,CONVERT                                         0587 01272000
*   CALL DODEVICE;                    /*GO PROCESS THE DEVICE        */ 01273000
         BAL   @14,DODEVICE                                        0588 01274000
*    IF (DEVTYPE1 = '3410' | DEVTYPE1 = '3420') THEN       /*@ZA34787*/ 01275000
         CLC   DEVTYPE1(4),@CC01435                                0589 01276000
         BE    @RT00589                                            0589 01277000
         CLC   DEVTYPE1(4),@CC01436                                0589 01278000
         BNE   @RF00589                                            0589 01279000
@RT00589 DS    0H                                                  0590 01280000
*        DEVTYPE1 = '34XX';    /*CHANGE 3410,3420 TO 34XX    @ZA34787*/ 01281000
         MVC   DEVTYPE1(4),@CC01437                                0590 01282000
* IF(SDRCOUNT = OFF &          /*END OF DAY COUNTER FLAG OFF @0001VLS*/ 01283000
*    OBRTEMP  = OFF &          /*IT IS NOT AN TEMP OBR       @0001VLS*/ 01284000
*    SHORTSW  = OFF &          /*IT IS NOT A SHORT OBR       @0001VLS*/ 01285000
*    DISMOUNT = OFF ) &        /*IT IS NOT A DISMOUNT RECORD @0001VLS*/ 01286000
*    OBRSEN1 ^= '40'X         /*AND NOT A INTERVENTION REQUIRED */ 0591 01287000
*    THEN                      /*IT MUST BE A OBR-PERM  ERROR   */ 0591 01288000
@RF00589 TM    SDRCOUNT(R7),B'11100100'                            0591 01289000
         BNZ   @RF00591                                            0591 01290000
         LA    @06,64                                              0591 01291000
         ALR   @06,R7                                              0591 01292000
         SLR   @05,@05                                             0591 01293000
         IC    @05,OBRDEVDC(,R7)                                   0591 01294000
         SLA   @05,3                                               0591 01295000
         ALR   @06,@05                                             0591 01296000
         SLR   @05,@05                                             0591 01297000
         IC    @05,OBRLSDRC(,R7)                                   0591 01298000
         ALR   @06,@05                                             0591 01299000
         CLI   OBRSEN1(@06),X'40'                                  0591 01300000
         BE    @RF00591                                            0591 01301000
*    DO;                                                   /*@ZA19014*/ 01302000
*     CALL OBRISPRM; /*CALL THE OBR PERM PROC TO BUILD  LINE @ZA19014*/ 01303000
         BAL   @14,OBRISPRM                                        0593 01304000
*     OBRPRMCT(PTR) = OBRPRMCT(PTR) + ONE;               /*  @ZA19014*/ 01305000
         L     @06,PTR                                             0594 01306000
         SLA   @06,2                                               0594 01307000
         L     @05,OBRPRMCT-4(@06)                                 0594 01308000
         AL    @05,ONE                                             0594 01309000
         ST    @05,OBRPRMCT-4(@06)                                 0594 01310000
*     RECTYP1 = OBRPRM; /*MOVE IN THE OBR IS PERMENT NAME    @ZA19014*/ 01311000
         MVC   RECTYP1(7),OBRPRM                                   0595 01312000
*    END;                                                  /*@ZA19014*/ 01313000
*    ELSE                                                          0597 01314000
*     IF SDRCOUNT = ON                /*IS IT AN OBR END OF DAY      */ 01315000
*      THEN                                                        0597 01316000
         B     @RC00591                                            0597 01317000
@RF00591 TM    SDRCOUNT(R7),B'10000000'                            0597 01318000
         BNO   @RF00597                                            0597 01319000
*       DO;                                                /*@Z427VLS*/ 01320000
*        RECTYP1 = OBREOD;            /*SET UP THE NAME FOR EOD      */ 01321000
         MVC   RECTYP1(7),OBREOD                                   0599 01322000
*        OBREODCT(PTR) = OBREODCT(PTR) + ONE;              /*@Z427VLS*/ 01323000
         L     @06,PTR                                             0600 01324000
         SLA   @06,2                                               0600 01325000
         L     @05,OBREODCT-4(@06)                                 0600 01326000
         AL    @05,ONE                                             0600 01327000
         ST    @05,OBREODCT-4(@06)                                 0600 01328000
*       END;                                               /*@Z427VLS*/ 01329000
*      ELSE                                                        0602 01330000
*      IF SHORTSW = ON THEN                                        0602 01331000
         B     @RC00597                                            0602 01332000
@RF00597 TM    SHORTSW(R7),B'00100000'                             0602 01333000
         BNO   @RF00602                                            0602 01334000
*       DO;                                                /*@ZA19014*/ 01335000
*        RECTYP1 = OBRSHT;     /*SET TYPE TO OBR SHORT       @ZA19014*/ 01336000
         MVC   RECTYP1(7),OBRSHT                                   0604 01337000
*        OBRSHTCT(PTR) = OBRSHTCT(PTR) + ONE;           /*   @ZA19014*/ 01338000
         L     @06,PTR                                             0605 01339000
         SLA   @06,2                                               0605 01340000
         L     @05,OBRSHTCT-4(@06)                                 0605 01341000
         AL    @05,ONE                                             0605 01342000
         ST    @05,OBRSHTCT-4(@06)                                 0605 01343000
*         END;                                             /*@Z427VLS*/ 01344000
*        ELSE                                                      0607 01345000
*         IF OBRTEMP = ON THEN                                     0607 01346000
         B     @RC00602                                            0607 01347000
@RF00602 TM    OBRTEMP(R7),B'01000000'                             0607 01348000
         BNO   @RF00607                                            0607 01349000
*          DO;                                             /*@ZA19014*/ 01350000
*           RECTYP1 = OBRTMP; /*MAKE THE LABLE A OBR TEMP    @ZA19014*/ 01351000
         MVC   RECTYP1(7),OBRTMP                                   0609 01352000
*           OBRTMPCT(PTR) = OBRTMPCT(PTR) + ONE;      /*     @ZA19014*/ 01353000
         L     @06,PTR                                             0610 01354000
         SLA   @06,2                                               0610 01355000
         L     @05,OBRTMPCT-4(@06)                                 0610 01356000
         AL    @05,ONE                                             0610 01357000
         ST    @05,OBRTMPCT-4(@06)                                 0610 01358000
*           END;                                           /*@Z427VLS*/ 01359000
*          ELSE                                                    0612 01360000
*           IF DISMOUNT = ON          /*WAS IT A DISMOUNT OBR        */ 01361000
*            THEN                                                  0612 01362000
         B     @RC00607                                            0612 01363000
@RF00607 TM    DISMOUNT(R7),B'00000100'                            0612 01364000
         BNO   @RF00612                                            0612 01365000
*             DO;                                          /*@Z427VLS*/ 01366000
*              RECTYP1 = OBRDMT ;                          /*@Z427VLS*/ 01367000
         MVC   RECTYP1(7),OBRDMT                                   0614 01368000
*              OBRDMTCT(PTR) = OBRDMTCT(PTR) + ONE;        /*@Z427VLS*/ 01369000
         L     @06,PTR                                             0615 01370000
         SLA   @06,2                                               0615 01371000
         L     @05,OBRDMTCT-4(@06)                                 0615 01372000
         AL    @05,ONE                                             0615 01373000
         ST    @05,OBRDMTCT-4(@06)                                 0615 01374000
*             END;                                         /*@Z427VLS*/ 01375000
*            ELSE                                                  0617 01376000
*             DO;                     /*IS A ODD OBR         @Z427VLS*/ 01377000
         B     @RC00612                                            0617 01378000
@RF00612 DS    0H                                                  0618 01379000
*              RECTYP1 = OBR;         /*SET NAME TO JUST PLAIN OBR   */ 01380000
         MVC   RECTYP1(7),OBR                                      0618 01381000
*              OBRCT(PTR) = OBRCT(PTR) + ONE;              /*@Z427VLS*/ 01382000
         L     @06,PTR                                             0619 01383000
         SLA   @06,2                                               0619 01384000
         L     @05,OBRCT-4(@06)                                    0619 01385000
         AL    @05,ONE                                             0619 01386000
         ST    @05,OBRCT-4(@06)                                    0619 01387000
*              ADDNXT = ADDR(CSW1);   /*SET UP FOR CSW OUTPUT        */ 01388000
         LA    @06,CSW1                                            0620 01389000
         ST    @06,ADDNXT                                          0620 01390000
*              NEXTBY = ADDR(OBRSTAT);/*SET UP WHERE TO GET THE DATA */ 01391000
         LA    @06,OBRSTAT(,R7)                                    0621 01392000
         ST    @06,NEXTBY                                          0621 01393000
*              CALL CONVERT;          /*GO CONVERT THE NUM # STILL 2 */ 01394000
         BAL   @14,CONVERT                                         0622 01395000
*              NUMBER = 1;            /*SET UP TO DO 1 BYTE  @Z427VLS*/ 01396000
         MVC   NUMBER(4),@CF00055                                  0623 01397000
*              ADDNXT = ADDR(CMD1);   /*SET UP FOR CCW FIRST BYTE    */ 01398000
         LA    @06,CMD1                                            0624 01399000
         ST    @06,ADDNXT                                          0624 01400000
*              NEXTBY = ADDR(OBRSRDS);/*ADDRESS OF WHERE THE DATA IS */ 01401000
         LA    @06,OBRSRDS(,R7)                                    0625 01402000
         ST    @06,NEXTBY                                          0625 01403000
*              CALL CONVERT;          /*GO CONVERT THE CCMDTTO PRINT */ 01404000
         BAL   @14,CONVERT                                         0626 01405000
*             END;                                         /*@Z427VLS*/ 01406000
*                                                                  0627 01407000
*/*EREPSEND  */                                                    0628 01408000
*       GO TO L000113;                                             0628 01409000
         B     L000113                                             0628 01410000
*     END;                                              /*@Z427VLS*/    01411000
* /*******************************************************************/ 01412000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 01413000
* /*    THIS CASE WILL HANDLE ALL SFT TYPE RECORDS           @Z427VLS*/ 01414000
* /*                                                         @Z427VLS*/ 01415000
*                                                                  0630 01416000
*/*EREPSUB  */                                                     0630 01417000
*L00014:                                                           0630 01418000
*     DO;                                               /*@Z427VLS*/    01419000
L00014   DS    0H                                                  0631 01420000
*   CALL TIME;                     /*GO AND SET UP THE TIME  FROM REC*/ 01421000
         BAL   @14,TIME                                            0631 01422000
*   JOBNAME1 = SFTJOBID;           /*MOVE IN THE JOB NAME    @Z427VLS*/ 01423000
         MVC   JOBNAME1(8),SFTJOBID(R7)                            0632 01424000
*   NUMBER = EIGHT;               /*NUMBER OF BYTES TO CHANGE       */  01425000
         MVC   NUMBER(4),@CF00065                                  0633 01426000
*   ADDNXT = ADDR(PSWMCH);        /*WHERE TO PUT THE CONVERTED DATA */  01427000
         LA    @06,PSWMCH                                          0634 01428000
         ST    @06,ADDNXT                                          0634 01429000
*   NEXTBY = ADDR(SFTPROGC);      /*WHERE IN THE RECORD TO GET DATA */  01430000
         LA    @06,SFTPROGC(,R7)                                   0635 01431000
         ST    @06,NEXTBY                                          0635 01432000
*   CALL CONVERT;                 /*GO AND CONVERT THE DATA  @Z427VLS*/ 01433000
         BAL   @14,CONVERT                                         0636 01434000
*   RCYRYXIT = SFTREXN;                                    /*@Z427VLS*/ 01435000
         MVC   RCYRYXIT(8),SFTREXN(R7)                             0637 01436000
*   COMPMOD = SFTMODN;                                     /*@Z427VLS*/ 01437000
         MVC   COMPMOD(8),SFTMODN(R7)                              0638 01438000
*   CSECTID = SFTCSECT;                                    /*@Z427VLS*/ 01439000
         MVC   CSECTID(8),SFTCSECT(R7)                             0639 01440000
* NUMBER = 4;                /*REASON CODE HAS 4 BYTES OF INFO*/   0640 01441000
         LA    @06,4                                               0640 01442000
         ST    @06,NUMBER                                          0640 01443000
* ADDNXT = ADDR(REASON) -2; /*LOCATION IN THE PRINT LINE     @0098VLS*/ 01444000
         LA    @05,REASON                                          0641 01445000
         BCTR  @05,0                                               0641 01446000
         BCTR  @05,0                                               0641 01447000
         ST    @05,ADDNXT                                          0641 01448000
* NEXTBY = ADDR(SFTABNDC) + 4;/*WHERE INFO IS                @0098VLS*/ 01449000
         LA    @05,SFTABNDC(,R7)                                   0642 01450000
         ALR   @05,@06                                             0642 01451000
         ST    @05,NEXTBY                                          0642 01452000
* CALL CONVERT;                                            /*@0098VLS*/ 01453000
         BAL   @14,CONVERT                                         0643 01454000
* IF (LRTERRID & '20'X) = '20'X THEN                               0644 01455000
         MVC   @TS00001(1),LRTERRID(R7)                            0644 01456000
         NI    @TS00001,X'20'                                      0644 01457000
         CLI   @TS00001,X'20'                                      0644 01458000
         BNE   @RF00644                                            0644 01459000
*  DO;                                                     /*@0098VLS*/ 01460000
*   NUMBER = 10;  /*ERROR ID IS TEN BYTES LONG               @0098VLS*/ 01461000
         LA    @06,10                                              0646 01462000
         ST    @06,NUMBER                                          0646 01463000
*   ADDNXT = ADDR(ERRORID1); /*WHERE IN THE LINE TO PUT IT   @0098VLS*/ 01464000
         LA    @05,ERRORID1                                        0647 01465000
         ST    @05,ADDNXT                                          0647 01466000
*   NEXTBY = ADDR(RERR);/*LOCATION OF THE ERROR ID(R7 + RECLNGTH + 10*/ 01467000
         LR    @05,R7                                              0648 01468000
         AH    @05,RECLNGTH(,R2)                                   0648 01469000
         SLR   @05,@06                                             0648 01470000
         ST    @05,NEXTBY                                          0648 01471000
*   CALL CONVERT;   /*CONVERT TO PRINTABLE                   @0098VLS*/ 01472000
         BAL   @14,CONVERT                                         0649 01473000
*  END;                                                    /*@0098VLS*/ 01474000
* ELSE                                                             0651 01475000
*  ERRORNA = NOTAPPLY;   /*PUT THE WORDS DOES NOT APPLY      @0098VLS*/ 01476000
         B     @RC00644                                            0651 01477000
@RF00644 MVC   ERRORNA(8),NOTAPPLY                                 0651 01478000
*   IF SFTKEY1 = '40'X                                             0652 01479000
*    THEN                                                          0652 01480000
@RC00644 CLI   SFTKEY1(R7),X'40'                                   0652 01481000
         BNE   @RF00652                                            0652 01482000
*     DO;                                                  /*@Z427VLS*/ 01483000
*      RECTYP1  = SFTABN;                                  /*@Z427VLS*/ 01484000
         MVC   RECTYP1(7),SFTABN                                   0654 01485000
*      SFTABNCT(PTR) = SFTABNCT(PTR) + ONE;                /*@Z427VLS*/ 01486000
         L     @06,PTR                                             0655 01487000
         SLA   @06,2                                               0655 01488000
         L     @05,SFTABNCT-4(@06)                                 0655 01489000
         AL    @05,ONE                                             0655 01490000
         ST    @05,SFTABNCT-4(@06)                                 0655 01491000
*     END;                                                 /*@Z427VLS*/ 01492000
*    ELSE                                                          0657 01493000
*     IF SFTKEY1 = '42'X                                           0657 01494000
*      THEN                                                        0657 01495000
         B     @RC00652                                            0657 01496000
@RF00652 CLI   SFTKEY1(R7),X'42'                                   0657 01497000
         BNE   @RF00657                                            0657 01498000
*       DO;                                                /*@Z427VLS*/ 01499000
*        RECTYP1 = SFTPI;                                  /*@Z427VLS*/ 01500000
         MVC   RECTYP1(7),SFTPI                                    0659 01501000
*        SFTPICT(PTR) = SFTPICT(PTR) + ONE;                /*@Z427VLS*/ 01502000
         L     @06,PTR                                             0660 01503000
         SLA   @06,2                                               0660 01504000
         L     @05,SFTPICT-4(@06)                                  0660 01505000
         AL    @05,ONE                                             0660 01506000
         ST    @05,SFTPICT-4(@06)                                  0660 01507000
*       END;                                               /*@Z427VLS*/ 01508000
*      ELSE                                                        0662 01509000
*       IF SFTKEY1 = '44'X                                         0662 01510000
*        THEN                                                      0662 01511000
         B     @RC00657                                            0662 01512000
@RF00657 CLI   SFTKEY1(R7),X'44'                                   0662 01513000
         BNE   @RF00662                                            0662 01514000
*         DO;                                              /*@Z427VLS*/ 01515000
*          RECTYP1 = SFTRST;                               /*@Z427VLS*/ 01516000
         MVC   RECTYP1(7),SFTRST                                   0664 01517000
*          SFTRSTCT(PTR) = SFTRSTCT(PTR) + ONE;            /*@Z427VLS*/ 01518000
         L     @06,PTR                                             0665 01519000
         SLA   @06,2                                               0665 01520000
         L     @05,SFTRSTCT-4(@06)                                 0665 01521000
         AL    @05,ONE                                             0665 01522000
         ST    @05,SFTRSTCT-4(@06)                                 0665 01523000
*         END;                                             /*@Z427VLS*/ 01524000
*        ELSE                                                      0667 01525000
*         IF SFTKEY1 = '48'X                                       0667 01526000
*          THEN                                                    0667 01527000
         B     @RC00662                                            0667 01528000
@RF00662 CLI   SFTKEY1(R7),X'48'                                   0667 01529000
         BNE   @RF00667                                            0667 01530000
*           DO;                                            /*@Z427VLS*/ 01531000
*            RECTYP1 = SFTMCH;                             /*@Z427VLS*/ 01532000
         MVC   RECTYP1(7),SFTMCH                                   0669 01533000
*            SFTMCHCT(PTR) = SFTMCHCT(PTR) + ONE;          /*@Z427VLS*/ 01534000
         L     @06,PTR                                             0670 01535000
         SLA   @06,2                                               0670 01536000
         L     @05,SFTMCHCT-4(@06)                                 0670 01537000
         AL    @05,ONE                                             0670 01538000
         ST    @05,SFTMCHCT-4(@06)                                 0670 01539000
*           END;                                           /*@Z427VLS*/ 01540000
*          ELSE                                                    0672 01541000
*            IF SFTKEY1 = '4F'X      /*SHORT RECORD SOFT     @ZA27247*/ 01542000
*             THEN                                                 0672 01543000
         B     @RC00667                                            0672 01544000
@RF00667 CLI   SFTKEY1(R7),X'4F'                                   0672 01545000
         BNE   @RF00672                                            0672 01546000
*              DO;                                         /*@ZA27247*/ 01547000
*               RECTYP1 = SFT;                             /*@ZA27247*/ 01548000
         MVC   RECTYP1(7),SFT                                      0674 01549000
*               SFTCT(PTR) = SFTCT(PTR) + ONE;             /*@ZA27247*/ 01550000
         L     @06,PTR                                             0675 01551000
         SLA   @06,2                                               0675 01552000
         L     @05,SFTCT-4(@06)                                    0675 01553000
         AL    @05,ONE                                             0675 01554000
         ST    @05,SFTCT-4(@06)                                    0675 01555000
*               GENERATE;                                  /*@ZA27247*/ 01556000
                 MVC JOBNAME1,=CL8' '                                   01557000
                 MVC LOSTSOFT(54),LOSTMSG                               01558000
*              END;                                        /*@ZA27247*/ 01559000
*             ELSE                                                 0678 01560000
*              DO;                                         /*@ZA27247*/ 01561000
         B     @RC00672                                            0678 01562000
@RF00672 DS    0H                                                  0679 01563000
*               RECTYP1 = SFT;                             /*@ZA27247*/ 01564000
         MVC   RECTYP1(7),SFT                                      0679 01565000
*               SFTCT(PTR) = SFTCT(PTR) + ONE;             /*@ZA27247*/ 01566000
         L     @06,PTR                                             0680 01567000
         SLA   @06,2                                               0680 01568000
         L     @05,SFTCT-4(@06)                                    0680 01569000
         AL    @05,ONE                                             0680 01570000
         ST    @05,SFTCT-4(@06)                                    0680 01571000
*              END;                                        /*@ZA27247*/ 01572000
*   CPU12 = EVLETTER(PTR);                                 /*@Z427VLS*/ 01573000
*                                                                  0682 01574000
@RC00672 DS    0H                                                  0682 01575000
@RC00667 DS    0H                                                  0682 01576000
@RC00662 DS    0H                                                  0682 01577000
@RC00657 DS    0H                                                  0682 01578000
@RC00652 L     @06,PTR                                             0682 01579000
         MH    @06,@CH00080                                        0682 01580000
         L     @05,EVPTR(,R2)                                      0682 01581000
         ALR   @05,@06                                             0682 01582000
         MVC   CPU12(1),EVLETTER-6(@05)                            0682 01583000
*/*EREPSEND  */                                                    0683 01584000
*       GO TO L000113;                                             0683 01585000
         B     L000113                                             0683 01586000
*     END;                                              /*@Z427VLS*/    01587000
* /*******************************************************************/ 01588000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 01589000
* /*    THIS CASE WILL HANDLE ALL IPL TYPE RECORDS           @Z427VLS*/ 01590000
*                                                                  0685 01591000
*/*EREPSUB  */                                                     0685 01592000
*L00015:                                                           0685 01593000
*     DO;                                               /*@Z427VLS*/    01594000
L00015   DS    0H                                                  0686 01595000
*     CALL TIME;                     /*CONVERT THE TIME FOR THIS REC */ 01596000
         BAL   @14,TIME                                            0686 01597000
*     RECTYP1 = IPL;                 /*PUT IN THE TYPE OF RECORD     */ 01598000
         MVC   RECTYP1(7),IPL                                      0687 01599000
*     IPLCT(PTR) = IPLCT(PTR) + ONE; /*ADD ONE TO THE IPL COUNTER    */ 01600000
         L     @06,PTR                                             0688 01601000
         LR    @05,@06                                             0688 01602000
         SLA   @05,2                                               0688 01603000
         L     @03,ONE                                             0688 01604000
         L     @15,IPLCT-4(@05)                                    0688 01605000
         ALR   @15,@03                                             0688 01606000
         ST    @15,IPLCT-4(@05)                                    0688 01607000
*     CPU12 = EVLETTER(PTR);         /*MOVE IN THE CPU  LETTER       */ 01608000
         MH    @06,@CH00080                                        0689 01609000
         L     @05,EVPTR(,R2)                                      0689 01610000
         ALR   @05,@06                                             0689 01611000
         MVC   CPU12(1),EVLETTER-6(@05)                            0689 01612000
*     REASON = IPLREAS;              /*MOVE IN THE IPL REASON@ZA24916*/ 01613000
         MVI   REASON+2,C' '                                       0690 01614000
         MVC   REASON+3(3),REASON+2                                0690 01615000
         MVC   REASON(2),IPLREAS(R7)                               0690 01616000
*     NUMBER = ONE;                  /*SET UP # OF BYTES TO CONVERT  */ 01617000
         ST    @03,NUMBER                                          0691 01618000
*     ADDNXT = ADDR(SSYS);           /*SET ADDRESS OF REASON CODE    */ 01619000
         LA    @06,SSYS                                            0692 01620000
         ST    @06,ADDNXT                                          0692 01621000
*     NEXTBY = ADDR(IPLSYSID);       /*SET ADD OF WHERE IN RECORD ID */ 01622000
         LA    @06,IPLSYSID(,R7)                                   0693 01623000
         ST    @06,NEXTBY                                          0693 01624000
*     CALL CONVERT;                  /*GO CONVERT TO PRINTABLE       */ 01625000
         BAL   @14,CONVERT                                         0694 01626000
*     JOBNAME1 = NOTAPPLY;                                 /*@Z427VLS*/ 01627000
*                                                                  0695 01628000
         MVC   JOBNAME1(8),NOTAPPLY                                0695 01629000
*/*EREPSEND  */                                                    0696 01630000
*       GO TO L000113;                                             0696 01631000
         B     L000113                                             0696 01632000
*     END;                                              /*@Z427VLS*/    01633000
* /*******************************************************************/ 01634000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 01635000
* /*    THIS CASE WILL HANDLE ALL DDR TYPE RECORDS           @Z427VLS*/ 01636000
*                                                                  0698 01637000
*/*EREPSUB  */                                                     0698 01638000
*L00016:                                                           0698 01639000
*     DO;                                               /*@Z427VLS*/    01640000
L00016   DS    0H                                                  0699 01641000
*    CALL TIME;                 /*MOVE THE TIME INTO THE LINE       */  01642000
         BAL   @14,TIME                                            0699 01643000
*     IF DDRDEPSW = '20'X        /*WAS IT AN OPERATOR REQUEST        */ 01644000
*        THEN                    /*YES IT WAS                @Z427VLS*/ 01645000
         CLI   DDRDEPSW(R7),X'20'                                  0700 01646000
         BNE   @RF00700                                            0700 01647000
*         DO;                                              /*@Z427VLS*/ 01648000
*          RECTYP1 = DDROPR;     /*MOVE DDR-OPR INTO THE PRINT LINE  */ 01649000
         MVC   RECTYP1(7),DDROPR                                   0702 01650000
*          DDROPRCT(PTR) = DDROPRCT(PTR) + ONE;            /*@Z427VLS*/ 01651000
         L     @06,PTR                                             0703 01652000
         SLA   @06,2                                               0703 01653000
         L     @05,DDROPRCT-4(@06)                                 0703 01654000
         AL    @05,ONE                                             0703 01655000
         ST    @05,DDROPRCT-4(@06)                                 0703 01656000
*          JOBNAME1 = DDRJOBID;  /*MOVE IN THE JOB NAME      @Z427VLS*/ 01657000
         MVC   JOBNAME1(8),DDRJOBID(R7)                            0704 01658000
*         END;                                             /*@Z427VLS*/ 01659000
*        ELSE                                                      0706 01660000
*         DO;                                              /*@Z427VLS*/ 01661000
         B     @RC00700                                            0706 01662000
@RF00700 DS    0H                                                  0707 01663000
*          IF DDRDEPSW = '10'X   /*WAS IT A SYSTEM REQUESTED IPL     */ 01664000
*            THEN                                                  0707 01665000
         CLI   DDRDEPSW(R7),X'10'                                  0707 01666000
         BNE   @RF00707                                            0707 01667000
*             DO;                                          /*@Z427VLS*/ 01668000
*              RECTYP1 = DDRSYS; /*MOVE DDR-SYS INTO THE PRINT LINE  */ 01669000
         MVC   RECTYP1(7),DDRSYS                                   0709 01670000
*              DDRSYSCT(PTR) = DDRSYSCT(PTR) + ONE;        /*@Z427VLS*/ 01671000
         L     @06,PTR                                             0710 01672000
         SLA   @06,2                                               0710 01673000
         L     @05,DDRSYSCT-4(@06)                                 0710 01674000
         AL    @05,ONE                                             0710 01675000
         ST    @05,DDRSYSCT-4(@06)                                 0710 01676000
*             END;                                         /*@Z427VLS*/ 01677000
*            ELSE                                                  0712 01678000
*             DO;                                          /*@Z427VLS*/ 01679000
         B     @RC00707                                            0712 01680000
@RF00707 DS    0H                                                  0713 01681000
*              RECTYP1 = DDR;    /*MOVE JUST PLAIN DDR IN TO PRINT   */ 01682000
         MVC   RECTYP1(7),DDR                                      0713 01683000
*              DDRCT(PTR) = DDRCT(PTR) + ONE;              /*@Z427VLS*/ 01684000
         L     @06,PTR                                             0714 01685000
         SLA   @06,2                                               0714 01686000
         L     @05,DDRCT-4(@06)                                    0714 01687000
         AL    @05,ONE                                             0714 01688000
         ST    @05,DDRCT-4(@06)                                    0714 01689000
*             END;                                         /*@Z427VLS*/ 01690000
*         END;                                             /*@Z427VLS*/ 01691000
@RC00707 DS    0H                                                  0717 01692000
*     IF(DDRDEPSW & 'F0'X) = '10'X THEN                            0717 01693000
@RC00700 MVC   @TS00001(1),DDRDEPSW(R7)                            0717 01694000
         NI    @TS00001,X'F0'                                      0717 01695000
         CLI   @TS00001,X'10'                                      0717 01696000
         BNE   @RF00717                                            0717 01697000
*      JOBNAME1 = DDRJOBID;      /*THEN MOVE IN THE JOB NAME @Z427VLS*/ 01698000
         MVC   JOBNAME1(8),DDRJOBID(R7)                            0718 01699000
*     CPU12 = EVLETTER(PTR);     /*MOVE IN CPU LETTER        @Z427VLS*/ 01700000
@RF00717 L     @06,PTR                                             0719 01701000
         MH    @06,@CH00080                                        0719 01702000
         L     @05,EVPTR(,R2)                                      0719 01703000
         ALR   @05,@06                                             0719 01704000
         MVC   CPU12(1),EVLETTER-6(@05)                            0719 01705000
*     DEVCOMP = DDRDEV2;         /*SET UP THE DEVICE TYPE    @Z427VLS*/ 01706000
         MVC   DEVCOMP(2),DDRDEV2(R7)                              0720 01707000
*     CALL DODEVICE;             /*PROCESS THE DEVICE NAME   @Z427VLS*/ 01708000
         BAL   @14,DODEVICE                                        0721 01709000
*     DEVSAVE = DEVTYPE1;        /*SAVE THIS TO MOVE INTO THE PRINT  */ 01710000
         MVC   DEVSAVE(4),DEVTYPE1                                 0722 01711000
*     DEVCOMP = DDRCODE2;        /*SET UP THE FROM DEVICE TYPE       */ 01712000
         MVC   DEVCOMP(2),DDRCODE2(R7)                             0723 01713000
*     CALL DODEVICE;             /*CONVERT THE FROM DEVICE   @Z427VLS*/ 01714000
         BAL   @14,DODEVICE                                        0724 01715000
*     SWITCH1 = ON;              /*SET FOR 1 & 1/2 BYTES OUT OF CONV */ 01716000
         OI    SWITCH1,B'10000000'                                 0725 01717000
*     NUMBER = 2;                /*SET UP TO PROCESS TWO BYTES       */ 01718000
         MVC   NUMBER(4),@CF00073                                  0726 01719000
*     NEXTBY = ADDR(DDRFCUA)+1; /*WHERE TO GET THE CUA       @Z427VLS*/ 01720000
         LA    @06,DDRFCUA(,R7)                                    0727 01721000
         AL    @06,@CF00055                                        0727 01722000
         ST    @06,NEXTBY                                          0727 01723000
*     ADDNXT = ADDR(CUA11);      /*WHERE TO PUT THE CUA      @Z427VLS*/ 01724000
         LA    @06,CUA11                                           0728 01725000
         ST    @06,ADDNXT                                          0728 01726000
*     CALL CONVERT;              /*PUT FROM CUA IN TO LINE   @Z427VLS*/ 01727000
         BAL   @14,CONVERT                                         0729 01728000
*     SWITCH1= ON;               /*SAME DO 1 & 1/2 BYTES     @Z427VLS*/ 01729000
         OI    SWITCH1,B'10000000'                                 0730 01730000
*     NEXTBY = ADDR(DDRTOCUA)+1; /*WHERE TO PUT TO CUA       @Z427VLS*/ 01731000
         LA    @06,DDRTOCUA(,R7)                                   0731 01732000
         AL    @06,@CF00055                                        0731 01733000
         ST    @06,NEXTBY                                          0731 01734000
*     ADDNXT = ADDR(TOCUA);                                /*@Z427VLS*/ 01735000
         LA    @06,TOCUA                                           0732 01736000
         ST    @06,ADDNXT                                          0732 01737000
*     CALL CONVERT;                                        /*@Z427VLS*/ 01738000
         BAL   @14,CONVERT                                         0733 01739000
*     GEN(MVC   CMD1(12),DDRSPEC);                         /*@Z427VLS*/ 01740000
         MVC   CMD1(12),DDRSPEC                                         01741000
*     VOLUME1 = DDRVOL1;/*VOLUME FROM ID                     @Z427VLS*/ 01742000
         MVC   VOLUME1(6),DDRVOL1(R7)                              0735 01743000
*     IF DDRVOL2 ^= BLANK1 THEN  /*WILL BE BLANK IF NOT ANY TO VOLUME*/ 01744000
         CLC   DDRVOL2(6,R7),BLANK1                                0736 01745000
         BE    @RF00736                                            0736 01746000
*     DO;                                                  /*@Z427VLS*/ 01747000
*     GEN(MVC   BB1(2),TOO);     /*MOVE WORD TO INTO THE LINE        */ 01748000
         MVC   BB1(2),TOO                                               01749000
*     R9 = ADDR(DDRVOL2);                                  /*@Z427VLS*/ 01750000
         LA    R9,DDRVOL2(,R7)                                     0739 01751000
*     GEN(MVC  BB1+3(6),0(R9));                            /*@Z427VLS*/ 01752000
         MVC  BB1+3(6),0(R9)                                            01753000
*     END;                                                 /*@Z427VLS*/ 01754000
*                                                                  0741 01755000
*/*EREPSEND  */                                                    0742 01756000
*       GO TO L000113;                                             0742 01757000
         B     L000113                                             0742 01758000
*     END;                                              /*@Z427VLS*/    01759000
* /*******************************************************************/ 01760000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 01761000
* /*    THIS CASE WILL HANDLE ALL MIH TYPE RECORDS           @Z427VLS*/ 01762000
*                                                                  0744 01763000
*/*EREPSUB  */                                                     0744 01764000
*L00017:                                                           0744 01765000
*     DO;                                               /*@Z427VLS*/    01766000
L00017   DS    0H                                                  0745 01767000
*     CALL TIME;                /*GO FORMAT THE TIME FROM THE RECORD */ 01768000
         BAL   @14,TIME                                            0745 01769000
*     IF MIHMOD > '0168'X & MIHMOD ^= '3062'X  /*303X CPU    @G64XXJS*/ 01770000
*       THEN                                                       0746 01771000
         CLC   MIHMOD(2,R7),@CB01420                               0746 01772000
         BNH   @RF00746                                            0746 01773000
         CLC   MIHMOD(2,R7),@CB01421                               0746 01774000
         BE    @RF00746                                            0746 01775000
*         DO;                                              /*@G64XXJS*/ 01776000
*          SENSEA1(1:5) = CSID;   /*MOVE CSID INTO PRINTLINE @G64XXJS*/ 01777000
         MVC   SENSEA1(5),@CC01355                                 0748 01778000
*          NUMBER = 1;    /*SET UP NUMBER OF BYTES TO CONVERT*/    0749 01779000
         MVC   NUMBER(4),@CF00055                                  0749 01780000
*          ADDNXT = ADDR(SENSEA1) + FIVE;  /*SET UP CSID TO PRINT*/     01781000
         LA    @06,SENSEA1                                         0750 01782000
         AL    @06,FIVE                                            0750 01783000
         ST    @06,ADDNXT                                          0750 01784000
*          NEXTBY = ADDR(MIHCSID);  /*ADDR OF CHANNEL SET ID @G64XXJS*/ 01785000
         LA    @06,MIHCSID(,R7)                                    0751 01786000
         ST    @06,NEXTBY                                          0751 01787000
*          CALL CONVERT;   /*CONVERT CHANNEL SET ID TO PRINTABLE*/ 0752 01788000
         BAL   @14,CONVERT                                         0752 01789000
*         END;                                             /*@G64XXJS*/ 01790000
*     JOBNAME1 = MIHJOBID;      /*SET UP THE TYPE OF RECORD ONLY 1   */ 01791000
@RF00746 MVC   JOBNAME1(8),MIHJOBID(R7)                            0754 01792000
*     CPU12 = EVLETTER(PTR);    /*MOVE IN THE CPU LETTER FILT4 BUILT */ 01793000
         L     @06,PTR                                             0755 01794000
         LR    @05,@06                                             0755 01795000
         MH    @05,@CH00080                                        0755 01796000
         L     @03,EVPTR(,R2)                                      0755 01797000
         ALR   @03,@05                                             0755 01798000
         MVC   CPU12(1),EVLETTER-6(@03)                            0755 01799000
*     VOLUME1 = MIHVOL;         /*MOVE IN THE VOLUME NAME    @Z427VLS*/ 01800000
         MVC   VOLUME1(6),MIHVOL(R7)                               0756 01801000
*     IF MIHCEBIT = ON          /*WAS RECORD CAUSED BY CONTROL END   */ 01802000
*       THEN                                                       0757 01803000
         TM    MIHCEBIT(R7),B'10000000'                            0757 01804000
         BNO   @RF00757                                            0757 01805000
*         DO;                                              /*@Z427VLS*/ 01806000
*          RECTYP1 = MIHCE;     /*MAKE THE RECORD TYPE MIH-CE        */ 01807000
         MVC   RECTYP1(7),MIHCE                                    0759 01808000
*          MIHCECT(PTR) = MIHCECT(PTR) + ONE;              /*@Z427VLS*/ 01809000
         SLA   @06,2                                               0760 01810000
         L     @05,MIHCECT-4(@06)                                  0760 01811000
         AL    @05,ONE                                             0760 01812000
         ST    @05,MIHCECT-4(@06)                                  0760 01813000
*         END;                                             /*@Z427VLS*/ 01814000
*       ELSE                                                       0762 01815000
*        DO;                                               /*@Z427VLS*/ 01816000
         B     @RC00757                                            0762 01817000
@RF00757 DS    0H                                                  0763 01818000
*         IF MIHDEBIT = ON      /*WAS RECORD FROM DEVICE END @Z427VLS*/ 01819000
*           THEN                                                   0763 01820000
         TM    MIHDEBIT(R7),B'01000000'                            0763 01821000
         BNO   @RF00763                                            0763 01822000
*            DO;                                           /*@Z427VLS*/ 01823000
*             RECTYP1 = MIHDE;  /*SET RECORD NAME TO MIH-DE  @Z427VLS*/ 01824000
         MVC   RECTYP1(7),MIHDE                                    0765 01825000
*             MIHDECT(PTR) = MIHDECT(PTR) + ONE;           /*@Z427VLS*/ 01826000
         L     @06,PTR                                             0766 01827000
         SLA   @06,2                                               0766 01828000
         L     @05,MIHDECT-4(@06)                                  0766 01829000
         AL    @05,ONE                                             0766 01830000
         ST    @05,MIHDECT-4(@06)                                  0766 01831000
*            END;                                          /*@Z427VLS*/ 01832000
*           ELSE                                                   0768 01833000
*            DO;                                           /*@Z427VLS*/ 01834000
         B     @RC00763                                            0768 01835000
@RF00763 DS    0H                                                  0769 01836000
*             RECTYP1 = MIH;    /*SET TO PLAIN MIH TYPE RECORD       */ 01837000
         MVC   RECTYP1(7),MIH                                      0769 01838000
*             MIHCT(PTR) = MIHCT(PTR) + ONE;               /*@Z427VLS*/ 01839000
         L     @06,PTR                                             0770 01840000
         SLA   @06,2                                               0770 01841000
         L     @05,MIHCT-4(@06)                                    0770 01842000
         AL    @05,ONE                                             0770 01843000
         ST    @05,MIHCT-4(@06)                                    0770 01844000
*            END;                                          /*@Z427VLS*/ 01845000
*        END;                                              /*@Z427VLS*/ 01846000
@RC00763 DS    0H                                                  0773 01847000
*     SWITCH1 = ON;             /*SET TO DROP LAST 1/2 BYTE  @Z427VLS*/ 01848000
@RC00757 OI    SWITCH1,B'10000000'                                 0773 01849000
*     NUMBER = 2 ;              /*SET UP TO PROCESS 2 BYTES OF DATA  */ 01850000
         MVC   NUMBER(4),@CF00073                                  0774 01851000
*     NEXTBY = ADDR(MIHCUA)+ONE;/*LOCATION OF CUA IN THE RECORD      */ 01852000
         LA    @06,MIHCUA(,R7)                                     0775 01853000
         AL    @06,ONE                                             0775 01854000
         ST    @06,NEXTBY                                          0775 01855000
*     ADDNXT = ADDR(CUA11);     /*ADDRESS OF WHERE TO PUT CONVERTED  */ 01856000
         LA    @06,CUA11                                           0776 01857000
         ST    @06,ADDNXT                                          0776 01858000
*     CALL CONVERT;             /*GO CHANGE THE FORMAT OF THE CUA    */ 01859000
         BAL   @14,CONVERT                                         0777 01860000
*     DEVCOMP = MIHCODE2;       /*SET UP THE DEVICE TO CHANGE        */ 01861000
         MVC   DEVCOMP(2),MIHCODE2(R7)                             0778 01862000
*     CALL DODEVICE;            /*PROCESS THE DEVICE NAME    @Z427VLS*/ 01863000
*                                                                  0779 01864000
         BAL   @14,DODEVICE                                        0779 01865000
*/*EREPSEND  */                                                    0780 01866000
*       GO TO L000113;                                             0780 01867000
         B     L000113                                             0780 01868000
*     END;                                              /*@Z427VLS*/    01869000
* /*******************************************************************/ 01870000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 01871000
* /*    THIS CASE WILL HANDLE ALL EOD TYPE RECORDS           @Z427VLS*/ 01872000
*                                                                  0782 01873000
*/*EREPSUB  */                                                     0782 01874000
*L00018:                                                           0782 01875000
*     DO;                                               /*@Z427VLS*/    01876000
L00018   DS    0H                                                  0783 01877000
*     CALL TIME;                /*GO FORMAT THE TIME FROM THE RECORD */ 01878000
         BAL   @14,TIME                                            0783 01879000
*     CPU12 = EVLETTER(PTR);    /*MOVE IN THE LETTER FILT4 ASSIGNED  */ 01880000
         L     @06,PTR                                             0784 01881000
         LR    @05,@06                                             0784 01882000
         MH    @05,@CH00080                                        0784 01883000
         L     @03,EVPTR(,R2)                                      0784 01884000
         ALR   @03,@05                                             0784 01885000
         MVC   CPU12(1),EVLETTER-6(@03)                            0784 01886000
*     RECTYP1 = EOD;            /*SET THE RECORD TYPE TO PLAIN EOD   */ 01887000
         MVC   RECTYP1(7),EOD                                      0785 01888000
*     EODCT(PTR) = EODCT(PTR) + ONE;                       /*@Z427VLS*/ 01889000
         SLA   @06,2                                               0786 01890000
         L     @05,EODCT-4(@06)                                    0786 01891000
         AL    @05,ONE                                             0786 01892000
         ST    @05,EODCT-4(@06)                                    0786 01893000
*     JOBNAME1 = NOTAPPLY;                                 /*@Z427VLS*/ 01894000
*                                                                  0787 01895000
         MVC   JOBNAME1(8),NOTAPPLY                                0787 01896000
*/*EREPSEND  */                                                    0788 01897000
*       GO TO L000113;                                             0788 01898000
         B     L000113                                             0788 01899000
*     END;                                              /*@Z427VLS*/    01900000
* /*******************************************************************/ 01901000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 01902000
* /*    THIS CASE WILL HANDLE ALL MDR TYPE RECORDS           @Z427VLS*/ 01903000
*                                                                  0790 01904000
*/*EREPSUB  */                                                     0790 01905000
*L00019:                                                           0790 01906000
*     DO;                                               /*@Z427VLS*/    01907000
L00019   DS    0H                                                  0791 01908000
*    CALL TIME;                     /*GO FORMAT THE TIME FROM RECORD */ 01909000
         BAL   @14,TIME                                            0791 01910000
*    CPU12 = EVLETTER(PTR);         /*MOVE IN THE LETTER FILT4 BUILT */ 01911000
         L     @06,PTR                                             0792 01912000
         MH    @06,@CH00080                                        0792 01913000
         L     @05,EVPTR(,R2)                                      0792 01914000
         ALR   @05,@06                                             0792 01915000
         MVC   CPU12(1),EVLETTER-6(@05)                            0792 01916000
*    SWITCH1 = ON;                  /*SET SWITCH SO 1/2 BYTE IS DROP */ 01917000
         OI    SWITCH1,B'10000000'                                 0793 01918000
*    NUMBER = TWO;                  /*SET TO PROCESS TWO BYTES       */ 01919000
         L     @06,TWO                                             0794 01920000
         ST    @06,NUMBER                                          0794 01921000
*    ADDNXT = ADDR(CUA11);          /*SET UP THE ADDRESS TO PUT IT   */ 01922000
         LA    @06,CUA11                                           0795 01923000
         ST    @06,ADDNXT                                          0795 01924000
*    NEXTBY = ADDR(TPRCUA);         /*SET UP WHERE TO FIND THE DATA  */ 01925000
         LA    @06,TPRCUA(,R7)                                     0796 01926000
         ST    @06,NEXTBY                                          0796 01927000
*    CALL CONVERT;                  /*GO CONVERT THE DATA TO PRINT   */ 01928000
         BAL   @14,CONVERT                                         0797 01929000
* DEVTYPE1 = UKNO;                                         /*@G51DGGB*/ 01930000
         MVC   DEVTYPE1(4),UKNO                                    0798 01931000
* CALL IFCDEVIC(32,TPRDEV,DEVTYPE1);                       /*@G51DGGB*/ 01932000
         MVC   @AL00001(12),@AL00799                               0799 01933000
         LA    @06,TPRDEV(,R7)                                     0799 01934000
         ST    @06,@AL00001+4                                      0799 01935000
         L     @15,@CV01456                                        0799 01936000
         LA    @01,@AL00001                                        0799 01937000
         BALR  @14,@15                                             0799 01938000
*    JOBNAME1 = NOTAPPLY;           /*DOES NOT APPLY FOR MDR RECORDS */ 01939000
         MVC   JOBNAME1(8),NOTAPPLY                                0800 01940000
*    IF TPRDEV = '01'X |            /*IS THIS A DASD DEVICE  @Z427VLS*/ 01941000
*       TPRDEV = '02'X |                                           0801 01942000
*       TPRDEV = '09'X |                                           0801 01943000
*       TPRDEV = '0A'X |                                           0801 01944000
*       TPRDEV = '0E'X |                                           0801 01945000
*       TPRDEV = '11'X |                                           0801 01946000
*       TPRDEV = '12'X                                             0801 01947000
*         THEN                                                     0801 01948000
         CLI   TPRDEV(R7),X'01'                                    0801 01949000
         BE    @RT00801                                            0801 01950000
         CLI   TPRDEV(R7),X'02'                                    0801 01951000
         BE    @RT00801                                            0801 01952000
         CLI   TPRDEV(R7),X'09'                                    0801 01953000
         BE    @RT00801                                            0801 01954000
         CLI   TPRDEV(R7),X'0A'                                    0801 01955000
         BE    @RT00801                                            0801 01956000
         CLI   TPRDEV(R7),X'0E'                                    0801 01957000
         BE    @RT00801                                            0801 01958000
         CLI   TPRDEV(R7),X'11'                                    0801 01959000
         BE    @RT00801                                            0801 01960000
         CLI   TPRDEV(R7),X'12'                                    0801 01961000
         BNE   @RF00801                                            0801 01962000
@RT00801 DS    0H                                                  0802 01963000
*           DO;                                            /*@Z427VLS*/ 01964000
*    VOLUME1 = TPRVOL;              /*PUT IN THE VOLID       @Z427VLS*/ 01965000
         MVC   VOLUME1(6),TPRVOL(R7)                               0803 01966000
*            RECTYP1 = MDRDAS;                             /*@Z427VLS*/ 01967000
         MVC   RECTYP1(7),MDRDAS                                   0804 01968000
*            MDRDASCT(PTR) = MDRDASCT(PTR) + ONE;          /*@Z427VLS*/ 01969000
         L     @06,PTR                                             0805 01970000
         SLA   @06,2                                               0805 01971000
         L     @05,MDRDASCT-4(@06)                                 0805 01972000
         AL    @05,ONE                                             0805 01973000
         ST    @05,MDRDASCT-4(@06)                                 0805 01974000
*            NUMBER = 16;            /*NUMBER OF BYTES TO DO @Z427VLS*/ 01975000
         MVC   NUMBER(4),@CF00088                                  0806 01976000
*            NEXTBY = ADDR(TPRVOL) + (TPRBUFC &'0F'X) + 14;/*@Z427VLS*/ 01977000
         LA    @06,TPRVOL(,R7)                                     0807 01978000
         LA    @05,15                                              0807 01979000
         SLR   @03,@03                                             0807 01980000
         IC    @03,TPRBUFC(,R7)                                    0807 01981000
         NR    @05,@03                                             0807 01982000
         ALR   @06,@05                                             0807 01983000
         AL    @06,@CF01462                                        0807 01984000
         ST    @06,NEXTBY                                          0807 01985000
*            ADDNXT = ADDR(TEMPSAVE);/*ADDRESS OF WHERE TO PUT IT    */ 01986000
         LA    @06,TEMPSAVE                                        0808 01987000
         ST    @06,ADDNXT                                          0808 01988000
*            CALL CONVERT;           /*GO CONVERT TO PRINTABLE       */ 01989000
         BAL   @14,CONVERT                                         0809 01990000
*            GENERATE;                                     /*@Z427VLS*/ 01991000
              MVC  SENSEA3(8),TEMPSAVE                                  01992000
              MVC  SENSEA4(8),TEMPSAVE+8                                01993000
              MVC  SENSEA5(8),TEMPSAVE+16                               01994000
              MVC  SENSEA6(8),TEMPSAVE+24                               01995000
*           END;                                           /*@Z427VLS*/ 01996000
*          ELSE                                                    0812 01997000
*           DO;                                            /*@Z427VLS*/ 01998000
         B     @RC00801                                            0812 01999000
@RF00801 DS    0H                                                  0813 02000000
*           MDRCT(PTR) = MDRCT(PTR) + ONE;                 /*@Z427VLS*/ 02001000
         L     @06,PTR                                             0813 02002000
         SLA   @06,2                                               0813 02003000
         L     @05,MDRCT-4(@06)                                    0813 02004000
         AL    @05,ONE                                             0813 02005000
         ST    @05,MDRCT-4(@06)                                    0813 02006000
*           RECTYP1 = MDR;                                 /*@Z427VLS*/ 02007000
         MVC   RECTYP1(7),MDR                                      0814 02008000
*           END;                                           /*@Z427VLS*/ 02009000
*                                                                  0815 02010000
*/*EREPSEND  */                                                    0816 02011000
*       GO TO L000113;                                             0816 02012000
         B     L000113                                             0816 02013000
*     END;                                              /*@Z427VLS*/    02014000
*/*EREPSUB  */                                                     0818 02015000
*L000110:                                                          0818 02016000
*   DO;                                                 /*@G51DGGB*/    02017000
L000110  DS    0H                                                  0819 02018000
* CALL FRAME;                                              /*@G51DGGB*/ 02019000
         BAL   @14,FRAME                                           0819 02020000
*/*EREPSEND  */                                                    0820 02021000
*     GO TO L000113;                                               0820 02022000
         B     L000113                                             0820 02023000
*   END;                                                /*@G51DGGB*/    02024000
*/*EREPSUB  */                                                     0822 02025000
*L000111:                                                          0822 02026000
*   DO;                                                 /*@G51DGGB*/    02027000
L000111  DS    0H                                                  0823 02028000
* CALL FRAME;                                              /*@G51DGGB*/ 02029000
         BAL   @14,FRAME                                           0823 02030000
*/*EREPSEND  */                                                    0824 02031000
*     GO TO L000113;                                               0824 02032000
         B     L000113                                             0824 02033000
*   END;                                                /*@G51DGGB*/    02034000
*/*EREPCEND  */                                                    0826 02035000
*L000112:;                                                         0826 02036000
*L000113:;                                                /*@Z427VLS*/  02037000
*END;                                                      /*@Z427VLS*/ 02038000
@EL00010 DS    0H                                                  0828 02039000
@EF00010 DS    0H                                                  0828 02040000
@ER00010 LM    @14,@12,@SA00010                                    0828 02041000
         BR    @14                                                 0828 02042000
*OBRISPRM: PROC;                                           /*@Z427VLS*/ 02043000
OBRISPRM STM   @14,@12,@SA00011                                    0829 02044000
* /*******************************************************************/ 02045000
*/** * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 02046000
* /*    THIS PROC WILL PROCESS ALL OBR RECORDS WITH PERM ERROR       */ 02047000
*       GEN(MVI  TEMPSAVE,X'40');                          /*@Z427VLS*/ 02048000
         MVI  TEMPSAVE,X'40'                                            02049000
*       GEN(MVC  TEMPSAVE+1(71),TEMPSAVE);                 /*@Z427VLS*/ 02050000
         MVC  TEMPSAVE+1(71),TEMPSAVE                                   02051000
*              NUMBER = 1;            /*SET UP TO DO 1 BYTE  @Z427VLS*/ 02052000
         MVC   NUMBER(4),@CF00055                                  0832 02053000
*              ADDNXT = ADDR(CMD1);   /*SET UP FOR CCW FIRST BYTE    */ 02054000
         LA    @06,CMD1                                            0833 02055000
         ST    @06,ADDNXT                                          0833 02056000
*              NEXTBY = ADDR(OBRSRDS);/*ADDRESS OF WHERE THE DATA IS */ 02057000
         LA    @06,OBRSRDS(,R7)                                    0834 02058000
         ST    @06,NEXTBY                                          0834 02059000
*              CALL CONVERT;          /*GO CONVERT THE CCMDTTO PRINT */ 02060000
         BAL   @14,CONVERT                                         0835 02061000
*       NUMBER = 2;                                        /*@Z427VLS*/ 02062000
         MVC   NUMBER(4),@CF00073                                  0836 02063000
*       ADDNXT = ADDR(CSW1);          /*SET UP TO CONVERT THE CSW    */ 02064000
         LA    @06,CSW1                                            0837 02065000
         ST    @06,ADDNXT                                          0837 02066000
*       NEXTBY = ADDR(OBRSTAT);       /*ADDRESS OF DATA TO CONVERT   */ 02067000
         LA    @06,OBRSTAT(,R7)                                    0838 02068000
         ST    @06,NEXTBY                                          0838 02069000
*       CALL CONVERT;                 /*CALL TO CONVERT THE DATA     */ 02070000
         BAL   @14,CONVERT                                         0839 02071000
*       NEXTBY = ADDR(OBRVOL) + EIGHT * OBRDEVDC  + OBRLSDRC;      0840 02072000
         LA    @06,OBRVOL(,R7)                                     0840 02073000
         SLR   @05,@05                                             0840 02074000
         IC    @05,OBRDEVDC(,R7)                                   0840 02075000
         SLA   @05,3                                               0840 02076000
         ALR   @06,@05                                             0840 02077000
         SLR   @05,@05                                             0840 02078000
         IC    @05,OBRLSDRC(,R7)                                   0840 02079000
         ALR   @06,@05                                             0840 02080000
         ST    @06,NEXTBY                                          0840 02081000
*       ADDNXT = ADDR(TEMPSAVE) ;     /*SET UP SPECIAL TO CONVERT TO */ 02082000
         LA    @06,TEMPSAVE                                        0841 02083000
         ST    @06,ADDNXT                                          0841 02084000
*       NUMBER = OBRSBCNT;            /*SET UP NUMBER OF SENSE BYTES */ 02085000
         SLR   @06,@06                                             0842 02086000
         ICM   @06,3,OBRSBCNT(R7)                                  0842 02087000
         ST    @06,NUMBER                                          0842 02088000
*       IF NUMBER > 40 THEN                                        0843 02089000
         LA    @05,40                                              0843 02090000
         CR    @06,@05                                             0843 02091000
         BNH   @RF00843                                            0843 02092000
*         NUMBER = 40;                                     /*@Z427VLS*/ 02093000
         ST    @05,NUMBER                                          0844 02094000
*       CALL CONVERT;                 /*GO AND CONVERT THE NUMBERS   */ 02095000
@RF00843 BAL   @14,CONVERT                                         0845 02096000
*       GENERATE;                                          /*@Z427VLS*/ 02097000
          MVC    SENSEA1(8),TEMPSAVE                                    02098000
          MVC    SENSEA2(8),TEMPSAVE+8                                  02099000
          MVC    SENSEA3(8),TEMPSAVE+16                                 02100000
          MVC    SENSEA4(8),TEMPSAVE+24                                 02101000
          MVC    SENSEA5(8),TEMPSAVE+32                                 02102000
          MVC    SENSEA6(8),TEMPSAVE+40                                 02103000
          MVC    SENSEA7(8),TEMPSAVE+48                                 02104000
          MVC    SENSEA8(8),TEMPSAVE+56                                 02105000
*       IF OBRSBCNT ^> 24 THEN       /*HAVE WE MESSED UP REST OF LINE*/ 02106000
         CLC   OBRSBCNT(2,R7),@CH00227                             0847 02107000
         BH    @RF00847                                            0847 02108000
*         DO;                                              /*@Z427VLS*/ 02109000
*          IF OBRDEVDC ^= ZERO THEN  /*IF NO DEV DEP INFO DONT MOVE  */ 02110000
         CLI   OBRDEVDC(R7),0                                      0849 02111000
         BE    @RF00849                                            0849 02112000
*           DO;                                            /*@Z427VLS*/ 02113000
*            IF OBRCLASS = '80'X |                                 0851 02114000
*                    OBRDEV = '0843'X |                            0851 02115000
*               OBRDEV   = '0842'X|                                0851 02116000
*               OBRCLASS = '20'X THEN                              0851 02117000
         CLI   OBRCLASS(R7),X'80'                                  0851 02118000
         BE    @RT00851                                            0851 02119000
         CLC   OBRDEV(2,R7),@CB01474                               0851 02120000
         BE    @RT00851                                            0851 02121000
         CLC   OBRDEV(2,R7),@CB01475                               0851 02122000
         BE    @RT00851                                            0851 02123000
         CLI   OBRCLASS(R7),X'20'                                  0851 02124000
         BNE   @RF00851                                            0851 02125000
@RT00851 DS    0H                                                  0852 02126000
*                 VOLUME1 = OBRVOL;                        /*@Z427VLS*/ 02127000
         MVC   VOLUME1(6),OBRVOL(R7)                               0852 02128000
*           END;                                           /*@Z427VLS*/ 02129000
@RF00851 DS    0H                                                  0854 02130000
*          IF OBRCLASS = '20'X THEN                                0854 02131000
@RF00849 CLI   OBRCLASS(R7),X'20'                                  0854 02132000
         BNE   @RF00854                                            0854 02133000
*           DO;                                            /*@Z427VLS*/ 02134000
*           TEMPSAVE = TEMPSAVE && TEMPSAVE;/*CLEAR AREA     @Z427VLS*/ 02135000
         XC    TEMPSAVE(84),TEMPSAVE                               0856 02136000
*           NUMBER = SEVEN;          /*SET UP TO CONVERT 7 BYTES     */ 02137000
         L     @06,SEVEN                                           0857 02138000
         ST    @06,NUMBER                                          0857 02139000
*           NEXTBY = ADDR(OBRSEEK)+3;/*ADDRESS OF WHERE TO PUT DATA  */ 02140000
         LA    @06,OBRSEEK(,R7)                                    0858 02141000
         AL    @06,@CF00075                                        0858 02142000
         ST    @06,NEXTBY                                          0858 02143000
*           ADDNXT = ADDR(TEMPSAVE); /*WHERE IT'S ALL AT     @Z427VLS*/ 02144000
         LA    @06,TEMPSAVE                                        0859 02145000
         ST    @06,ADDNXT                                          0859 02146000
*           CALL CONVERT;            /*GO CONVERT THE DATA TO PRINT  */ 02147000
         BAL   @14,CONVERT                                         0860 02148000
*           GENERATE;                                      /*@Z427VLS*/ 02149000
              MVC    BB1(4),TEMPSAVE                                    02150000
              MVC    CC1(4),TEMPSAVE+4                                  02151000
              MVC    HH1(4),TEMPSAVE+8                                  02152000
              MVC    R111(2),TEMPSAVE+12                                02153000
*           END;                                           /*@Z427VLS*/ 02154000
*          END;                                            /*@Z427VLS*/ 02155000
*   END;                                                   /*@Z427VLS*/ 02156000
@EL00011 DS    0H                                                  0864 02157000
@EF00011 DS    0H                                                  0864 02158000
@ER00011 LM    @14,@12,@SA00011                                    0864 02159000
         BR    @14                                                 0864 02160000
*DODEVICE: PROC;                                           /*@Z427VLS*/ 02161000
DODEVICE STM   @14,@12,@SA00012                                    0865 02162000
* DEVTYPE1 = UKNO;                  /*IF NO MATCH TELL EVERYONE      */ 02163000
         MVC   DEVTYPE1(4),UKNO                                    0866 02164000
* CALL IFCDEVIC(22,DEVCOMP,DEVTYPE1);                      /*@G51DGGB*/ 02165000
         L     @15,@CV01456                                        0867 02166000
         LA    @01,@AL00867                                        0867 02167000
         BALR  @14,@15                                             0867 02168000
*END;                                                      /*@Z427VLS*/ 02169000
@EL00012 DS    0H                                                  0868 02170000
@EF00012 DS    0H                                                  0868 02171000
@ER00012 LM    @14,@12,@SA00012                                    0868 02172000
         BR    @14                                                 0868 02173000
*FRAME: PROC;                                              /*@G51DGGB*/ 02174000
FRAME    STM   @14,@12,@SA00013                                    0869 02175000
* DCL FRAMEMCH  CHAR(7) INIT('FRM-MCH');                   /*@G51DGGB*/ 02176000
* DCL FRAMECCH  CHAR(7) INIT('FRM-CCH');                   /*@G51DGGB*/ 02177000
* DCL FRMTEMP  CHAR(7) INIT(' ');                          /*@G51DGGB*/ 02178000
* DCL LAST CHAR(1) BASED(R7+6);                            /*@G51DGGB*/ 02179000
* CALL TIME;            /*PUT THE TIME IN THE PRINTLINE      @G51DGGB*/ 02180000
         BAL   @14,TIME                                            0874 02181000
* CPU12  = EVLETTER(PTR);                                  /*@G51DGGB*/ 02182000
         L     @06,PTR                                             0875 02183000
         MH    @06,@CH00080                                        0875 02184000
         L     @05,EVPTR(,R2)                                      0875 02185000
         ALR   @05,@06                                             0875 02186000
         MVC   CPU12(1),EVLETTER-6(@05)                            0875 02187000
* IF CURRENT = 10 THEN                                             0876 02188000
         CLC   CURRENT(4),@CF00032                                 0876 02189000
         BNE   @RF00876                                            0876 02190000
*  RECTYP1 = FRAMEMCH;                                     /*@G51DGGB*/ 02191000
         MVC   RECTYP1(7),FRAMEMCH                                 0877 02192000
* ELSE                                                             0878 02193000
*  RECTYP1 = FRAMECCH;                                     /*@G51DGGB*/ 02194000
         B     @RC00876                                            0878 02195000
@RF00876 MVC   RECTYP1(7),FRAMECCH                                 0878 02196000
* NUMBER = THREE ;          /*SET FOR THREE BYTES TO BE CONVERTED*/     02197000
@RC00876 MVC   NUMBER(4),@CF00075                                  0879 02198000
* ADDNXT = ADDR(FRMTEMP);   /*ADDRESS OF THE TEMPORARY LOCATION  */     02199000
         LA    @06,FRMTEMP                                         0880 02200000
         ST    @06,ADDNXT                                          0880 02201000
* NEXTBY = R7 + 1865;       /*THE INFO IS IN THE LAST LINE OF THE */    02202000
         LA    @06,1865                                            0881 02203000
         ALR   @06,R7                                              0881 02204000
         ST    @06,NEXTBY                                          0881 02205000
* CALL CONVERT;             /*CONVERT THEE FRAME INFO TO PRINTABLE*/    02206000
         BAL   @14,CONVERT                                         0882 02207000
* GEN(MVC CUA12+2(2),FRMTEMP);/*MOVE THE GROUP NUMBER        @G51DGGB*/ 02208000
         MVC CUA12+2(2),FRMTEMP                                         02209000
* GEN(MVC CUA12+10(2),FRMTEMP+2);/*MOVE THE FRAME NUMBER     @G51DGGB*/ 02210000
         MVC CUA12+10(2),FRMTEMP+2                                      02211000
* GEN(MVC CUA12+19(2),FRMTEMP+4);/*MOVE THE EC LEVEL INTO THE PRINT L*/ 02212000
         MVC CUA12+19(2),FRMTEMP+4                                      02213000
* BNDECNUM = 2;                                            /*@G51DGGB*/ 02214000
         MVC   BNDECNUM(4),@CF00073                                0886 02215000
* BINWORD = LAST;                                          /*@G51DGGB*/ 02216000
         SLR   @06,@06                                             0887 02217000
         IC    @06,LAST+6(,R7)                                     0887 02218000
         ST    @06,BINWORD                                         0887 02219000
* DECADDR= ADDR(SENSEA2);                                  /*@G51DGGB*/ 02220000
         LA    @06,SENSEA2                                         0888 02221000
         ST    @06,DECADDR                                         0888 02222000
* CALL CONVBIN;                                            /*@G51DGGB*/ 02223000
         BAL   @14,CONVBIN                                         0889 02224000
* IF (LRTSMS & '80'X) = '00'X THEN                                 0890 02225000
         MVC   @TS00001(1),LRTSMS(R7)                              0890 02226000
         NI    @TS00001,X'80'                                      0890 02227000
         CLI   @TS00001,X'00'                                      0890 02228000
         BNE   @RF00890                                            0890 02229000
*  GEN(MVI  SENSEA3,X'5C');                                /*@G51DGGB*/ 02230000
         MVI  SENSEA3,X'5C'                                             02231000
*END;                                                      /*@G51DGGB*/ 02232000
@EL00013 DS    0H                                                  0892 02233000
@EF00013 DS    0H                                                  0892 02234000
@ER00013 LM    @14,@12,@SA00013                                    0892 02235000
         BR    @14                                                 0892 02236000
* /*******************************************************************/ 02237000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 02238000
* /*    THIS PROC WILL DETERMINE WHICH HEADING TO PRINT      @Z427VLS*/ 02239000
*HEADING:  PROC;                                           /*@Z427VLS*/ 02240000
HEADING  STM   @14,@12,@SA00014                                    0893 02241000
*  IF MYLINECT > LINECT - TWO THEN   /*IS IT TIME FOR A NEW HEADING  */ 02242000
         LH    @06,LINECT(,R2)                                     0894 02243000
         SL    @06,TWO                                             0894 02244000
         CH    @06,MYLINECT                                        0894 02245000
         BNL   @RF00894                                            0894 02246000
*      DO;                                                 /*@Z427VLS*/ 02247000
*       MYLINECT = MINUS1;           /*RESET THE COUNT TO -1 @Z427VLS*/ 02248000
         L     @06,MINUS1                                          0896 02249000
         STH   @06,MYLINECT                                        0896 02250000
*       SPACING = UPSPACE;           /*UP TO A NEW PAGE      @Z427VLS*/ 02251000
         MVC   SPACING(1),UPSPACE                                  0897 02252000
*       CALL PRINTIT;                /*SPACE TO A NEW PAGE   @Z427VLS*/ 02253000
         BAL   @14,PRINTIT                                         0898 02254000
*       SPACING = SINGLE;            /*RETURN TO NORMAL CC CONTROL   */ 02255000
         MVC   SPACING(1),SINGLE                                   0899 02256000
*      END;                                                /*@Z427VLS*/ 02257000
* IF DEBUG5 = ON                 /*DO THEY WANT HEADING FOR EACH REC */ 02258000
*   THEN                                                           0901 02259000
@RF00894 TM    DEBUG5(R2),B'00000100'                              0901 02260000
         BNO   @RF00901                                            0901 02261000
*     CALL BUGHEAD;              /*GO DETERMINE THE TYPE OF HEADING  */ 02262000
         BAL   @14,BUGHEAD                                         0902 02263000
*   ELSE                                                           0903 02264000
*     CALL TYPEHEAD;             /*GO OUTPUT THE NORMAL HEADING      */ 02265000
         B     @RC00901                                            0903 02266000
@RF00901 BAL   @14,TYPEHEAD                                        0903 02267000
* DUPLICAT = LINE04;                 /*THIS PART OF HEADING IS STAND */ 02268000
@RC00901 MVC   DUPLICAT(33),LINE04                                 0904 02269000
* CALL PRINTIT;                  /*PRINT OUT HEADING SELECTED        */ 02270000
         BAL   @14,PRINTIT                                         0905 02271000
*IF DEBUG5 = OFF &            /*PUT DATE AT THE TOP OF THE PAGE */ 0906 02272000
*   Y ^= ZERO THEN            /*NOT FIRST TIME THROUGH       @0001VLS*/ 02273000
         TM    DEBUG5(R2),B'00000100'                              0906 02274000
         BNZ   @RF00906                                            0906 02275000
         L     @06,Y                                               0906 02276000
         LTR   @06,@06                                             0906 02277000
         BZ    @RF00906                                            0906 02278000
* CALL NEWDATE;               /*PRINT THE DATE OF CURRENT RECORD*/ 0907 02279000
         BAL   @14,NEWDATE                                         0907 02280000
*END;                                                      /*@Z427VLS*/ 02281000
@EL00014 DS    0H                                                  0908 02282000
@EF00014 DS    0H                                                  0908 02283000
@ER00014 LM    @14,@12,@SA00014                                    0908 02284000
         BR    @14                                                 0908 02285000
* /*******************************************************************/ 02286000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 02287000
* /*    THIS PROC WILL HANDLE ALL MCH TYPE HEADERS           @Z427VLS*/ 02288000
*MCHHEDER:  PROC;                                          /*@Z427VLS*/ 02289000
MCHHEDER STM   @14,@12,12(@13)                                     0909 02290000
*DCL PSWMCH1 CHAR(77) DEFINED(PSWMCH);                     /*@0098VLS*/ 02291000
*PSWMCH1 = LINE8;                                          /*@0098VLS*/ 02292000
         MVC   PSWMCH1(77),LINE8                                   0911 02293000
*END;                                                      /*@Z427VLS*/ 02294000
@EL00015 DS    0H                                                  0912 02295000
@EF00015 DS    0H                                                  0912 02296000
@ER00015 LM    @14,@12,12(@13)                                     0912 02297000
         BR    @14                                                 0912 02298000
* /*******************************************************************/ 02299000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 02300000
* /*    THIS PROC WILL HANDLE ALL CHH TYPE HEADERS           @Z427VLS*/ 02301000
*CCHHEDER: PROC;                                           /*@Z427VLS*/ 02302000
CCHHEDER STM   @14,@12,12(@13)                                     0913 02303000
*   CCHFINSH = LINE1;             /*SET UP REST OF CCH HEADING       */ 02304000
         MVC   CCHFINSH(18),LINE1                                  0914 02305000
*END;                                                      /*@Z427VLS*/ 02306000
@EL00016 DS    0H                                                  0915 02307000
@EF00016 DS    0H                                                  0915 02308000
@ER00016 LM    @14,@12,12(@13)                                     0915 02309000
         BR    @14                                                 0915 02310000
* /*******************************************************************/ 02311000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 02312000
* /*    THIS PROC WILL HANDLE ALL OBR TYPE HEADERS           @Z427VLS*/ 02313000
*OBRHEDER: PROC;                                           /*@Z427VLS*/ 02314000
OBRHEDER STM   @14,@12,12(@13)                                     0916 02315000
*   OBRFINSH = LINE5;             /*SET UP THE REST OF OBR HEADING   */ 02316000
         MVC   OBRFINSH(98),LINE5                                  0917 02317000
*END;                                                      /*@Z427VLS*/ 02318000
@EL00017 DS    0H                                                  0918 02319000
@EF00017 DS    0H                                                  0918 02320000
@ER00017 LM    @14,@12,12(@13)                                     0918 02321000
         BR    @14                                                 0918 02322000
* /*******************************************************************/ 02323000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 02324000
* /*    THIS PROC WILL HANDLE ALL SFT TYPE HEADERS           @Z427VLS*/ 02325000
*SFTHEDER: PROC;                                           /*@Z427VLS*/ 02326000
SFTHEDER STM   @14,@12,12(@13)                                     0919 02327000
* SFTFINSH = LINE66;                                       /*@0098VLS*/ 02328000
         MVC   SFTFINSH(78),LINE66                                 0920 02329000
*END;                                                      /*@Z427VLS*/ 02330000
@EL00018 DS    0H                                                  0921 02331000
@EF00018 DS    0H                                                  0921 02332000
@ER00018 LM    @14,@12,12(@13)                                     0921 02333000
         BR    @14                                                 0921 02334000
* /*******************************************************************/ 02335000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 02336000
* /*    THIS PROC WILL HANDLE ALL IPL TYPE HEADERS           @Z427VLS*/ 02337000
*IPLHEDER: PROC;                                           /*@Z427VLS*/ 02338000
IPLHEDER STM   @14,@12,12(@13)                                     0922 02339000
*   IPLFINSH = LINE7;             /*SET UP THE REST OF IPL HEADING   */ 02340000
         MVC   IPLFINSH(17),LINE7                                  0923 02341000
*END;                                                      /*@Z427VLS*/ 02342000
@EL00019 DS    0H                                                  0924 02343000
@EF00019 DS    0H                                                  0924 02344000
@ER00019 LM    @14,@12,12(@13)                                     0924 02345000
         BR    @14                                                 0924 02346000
* /*******************************************************************/ 02347000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 02348000
* /*    THIS CASE WILL HANDLE ALL DDR TYPE HEADERS           @Z427VLS*/ 02349000
*DDRHEDER: PROC;                                           /*@Z427VLS*/ 02350000
DDRHEDER STM   @14,@12,@SA00020                                    0925 02351000
*   GEN(MVC  CUA12(104),LINE3);   /*SET UP THE REST OF IPL HEADING   */ 02352000
         MVC  CUA12(104),LINE3                                          02353000
*END;                                                      /*@Z427VLS*/ 02354000
@EL00020 DS    0H                                                  0927 02355000
@EF00020 DS    0H                                                  0927 02356000
@ER00020 LM    @14,@12,@SA00020                                    0927 02357000
         BR    @14                                                 0927 02358000
* /*******************************************************************/ 02359000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 02360000
* /*    THIS PROC WILL HANDLE ALL MIH TYPE HEADERS           @Z427VLS*/ 02361000
*MIHHEDER: PROC;                                           /*@Z427VLS*/ 02362000
MIHHEDER STM   @14,@12,@SA00021                                    0928 02363000
*   GEN(MVC  CUA12(104),LINE3);   /*SET UP THE REST OF DDR HEADING   */ 02364000
         MVC  CUA12(104),LINE3                                          02365000
*END;                                                      /*@Z427VLS*/ 02366000
@EL00021 DS    0H                                                  0930 02367000
@EF00021 DS    0H                                                  0930 02368000
@ER00021 LM    @14,@12,@SA00021                                    0930 02369000
         BR    @14                                                 0930 02370000
* /*******************************************************************/ 02371000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 02372000
* /*    THIS PROC WILL HANDLE ALL EOD TYPE HEADERS           @Z427VLS*/ 02373000
*EODHEDER: PROC;                                           /*@Z427VLS*/ 02374000
EODHEDER STM   @14,@12,12(@13)                                     0931 02375000
*    /*NOTHING IS REQUIRED AT THIS TIME                      @Z427VLS*/ 02376000
*END;                                                      /*@Z427VLS*/ 02377000
@EL00022 DS    0H                                                  0932 02378000
@EF00022 DS    0H                                                  0932 02379000
@ER00022 LM    @14,@12,12(@13)                                     0932 02380000
         BR    @14                                                 0932 02381000
* /*******************************************************************/ 02382000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 02383000
* /*    THIS PROC WILL HANDLE ALL MDR TYPE HEADERS           @Z427VLS*/ 02384000
*MDRHEDER: PROC;                                           /*@Z427VLS*/ 02385000
MDRHEDER STM   @14,@12,12(@13)                                     0933 02386000
*   NEWMDR   = LINE3;        /*SAME AS DDR TYPE RECORD       @Z427VLS*/ 02387000
         MVC   NEWMDR(104),LINE3                                   0934 02388000
*END;                                                      /*@Z427VLS*/ 02389000
@EL00023 DS    0H                                                  0935 02390000
@EF00023 DS    0H                                                  0935 02391000
@ER00023 LM    @14,@12,12(@13)                                     0935 02392000
         BR    @14                                                 0935 02393000
* /*******************************************************************/ 02394000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 02395000
* /*    THIS CASE WILL HANDLE ALL MDR & OBR TYPE HEADERS     @Z427VLS*/ 02396000
*MDROBRHD: PROC;                                           /*@Z427VLS*/ 02397000
MDROBRHD STM   @14,@12,@SA00024                                    0936 02398000
*   LINE44 = LINE4;                                        /*@Z427VLS*/ 02399000
         MVC   LINE44(82),LINE4                                    0937 02400000
*   CALL PRINTIT;            /*THIS ONE HAS AN EXTRA LINE    @Z427VLS*/ 02401000
         BAL   @14,PRINTIT                                         0938 02402000
*   MDROBRLN = MDRLINE;      /*SET UP THE SECOND LINE OF OUTPUT      */ 02403000
         MVC   MDROBRLN(35),MDRLINE                                0939 02404000
*END;                                                      /*@Z427VLS*/ 02405000
@EL00024 DS    0H                                                  0940 02406000
@EF00024 DS    0H                                                  0940 02407000
@ER00024 LM    @14,@12,@SA00024                                    0940 02408000
         BR    @14                                                 0940 02409000
* /*******************************************************************/ 02410000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 02411000
* /*    THIS CASE WILL HANDLE ALL STANDARD HEADERS           @Z427VLS*/ 02412000
*COMMONHD: PROC;                                           /*@Z427VLS*/ 02413000
COMMONHD STM   @14,@12,@SA00025                                    0941 02414000
*   LINE0006 = LINE6;        /*SET UP THE FIRST OF COMMON HEADER     */ 02415000
         MVC   LINE0006(78),LINE6                                  0942 02416000
*   CALL PRINTIT;            /*GO PRINT THE LINE             @Z427VLS*/ 02417000
         BAL   @14,PRINTIT                                         0943 02418000
*   OBRFINSH = LINE5;        /*SET UP THE SECOND LINE        @Z427VLS*/ 02419000
         MVC   OBRFINSH(98),LINE5                                  0944 02420000
*END;                                                      /*@Z427VLS*/ 02421000
@EL00025 DS    0H                                                  0945 02422000
@EF00025 DS    0H                                                  0945 02423000
@ER00025 LM    @14,@12,@SA00025                                    0945 02424000
         BR    @14                                                 0945 02425000
* /***************************************************************/     02426000
* /*    THIS PROC WILL OUTPUT THE FRAME HEADER               @G51DGGB*/ 02427000
*FRMHEDER: PROC;                                           /*@G51DGGB*/ 02428000
FRMHEDER STM   @14,@12,12(@13)                                     0946 02429000
*DCL LINEFRAM CHAR(43)                                             0947 02430000
* INIT('GROUP   FRAME   EC LEVEL    SEQ #  LASTFLAG');     /*@G51DGGB*/ 02431000
*DCL LINEFRM1 CHAR(43) DEFINED(CUA12);                     /*@G51DGGB*/ 02432000
* LINEFRM1 = LINEFRAM;      /*MOVE THE FRAME HEADER IN TO THE LINE*/    02433000
         MVC   LINEFRM1(43),LINEFRAM                               0949 02434000
*END;                                                      /*@G51DGGB*/ 02435000
@EL00026 DS    0H                                                  0950 02436000
@EF00026 DS    0H                                                  0950 02437000
@ER00026 LM    @14,@12,12(@13)                                     0950 02438000
         BR    @14                                                 0950 02439000
* /*******************************************************************/ 02440000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 02441000
* /*    THIS PROC WILL DETERMINE WHICH TYPE HEADING TO PRINT @Z427VLS*/ 02442000
* /*                                                         @Z427VLS*/ 02443000
*BUGHEAD: PROC;                                            /*@Z427VLS*/ 02444000
BUGHEAD  STM   @14,@12,@SA00027                                    0951 02445000
*  R8 = CURRENT;                       /*PICK UP THE RECORD TYPE     */ 02446000
         L     R8,CURRENT                                          0952 02447000
*  IF R8 = ONE                         /*IS IT A MCH RECORD  @Z427VLS*/ 02448000
*    THEN                                                          0953 02449000
         C     R8,ONE                                              0953 02450000
         BNE   @RF00953                                            0953 02451000
*      CALL MCHHEDER;                  /*GO SET UP MCH HEADER        */ 02452000
         BAL   @14,MCHHEDER                                        0954 02453000
*    ELSE                                                          0955 02454000
*     IF R8 = TWO                      /*IS IT A CCH TYPE RECORD     */ 02455000
*      THEN                                                        0955 02456000
         B     @RC00953                                            0955 02457000
@RF00953 C     R8,TWO                                              0955 02458000
         BNE   @RF00955                                            0955 02459000
*       CALL CCHHEDER;                 /*GO SET UP CCH HEADER        */ 02460000
         BAL   @14,CCHHEDER                                        0956 02461000
*      ELSE                                                        0957 02462000
*       IF R8 = THREE                  /*IS IT MCH TYPE RECORD       */ 02463000
*        THEN                                                      0957 02464000
         B     @RC00955                                            0957 02465000
@RF00955 C     R8,@CF00075                                         0957 02466000
         BNE   @RF00957                                            0957 02467000
*         CALL OBRHEDER;               /*GO FORMATE THE OBR HEADER   */ 02468000
         BAL   @14,OBRHEDER                                        0958 02469000
*        ELSE                                                      0959 02470000
*         IF R8 = FOUR                 /*IS IT A SOFTWARE RECORD     */ 02471000
*          THEN                                                    0959 02472000
         B     @RC00957                                            0959 02473000
@RF00957 C     R8,@CF00035                                         0959 02474000
         BNE   @RF00959                                            0959 02475000
*           CALL SFTHEDER;             /*FORMATE THE SOFTWARE HEADER */ 02476000
         BAL   @14,SFTHEDER                                        0960 02477000
*          ELSE                                                    0961 02478000
*           IF R8 = FIVE               /*IS THE RECORD AN IPL TYPE   */ 02479000
*            THEN                                                  0961 02480000
         B     @RC00959                                            0961 02481000
@RF00959 C     R8,FIVE                                             0961 02482000
         BNE   @RF00961                                            0961 02483000
*             CALL IPLHEDER;           /*FORMATE IPL HEADER  @Z427VLS*/ 02484000
         BAL   @14,IPLHEDER                                        0962 02485000
*            ELSE                                                  0963 02486000
*             IF R8 = SIX              /*IS THE RECORD AN DDR RECORD */ 02487000
*              THEN                                                0963 02488000
         B     @RC00961                                            0963 02489000
@RF00961 C     R8,SIX                                              0963 02490000
         BNE   @RF00963                                            0963 02491000
*               CALL DDRHEDER;         /*FORMAT HEADER FOR DDR RECORD*/ 02492000
         BAL   @14,DDRHEDER                                        0964 02493000
*              ELSE                                                0965 02494000
*               IF R8 = SEVEN          /*IS THE RECORD AN MIH RECORD */ 02495000
*                THEN                                              0965 02496000
         B     @RC00963                                            0965 02497000
@RF00963 C     R8,SEVEN                                            0965 02498000
         BNE   @RF00965                                            0965 02499000
*                 CALL MIHHEDER;       /*FORMAT TH HEADER FOR MIH REC*/ 02500000
         BAL   @14,MIHHEDER                                        0966 02501000
*                ELSE                                              0967 02502000
*                 IF R8 = EIGHT        /*IS THE RECORD AN EOD RECORD */ 02503000
*                  THEN                                            0967 02504000
         B     @RC00965                                            0967 02505000
@RF00965 C     R8,@CF00065                                         0967 02506000
         BNE   @RF00967                                            0967 02507000
*                   CALL EODHEDER;     /*FORMAT FOR EOD RRECORD      */ 02508000
         BAL   @14,EODHEDER                                        0968 02509000
*                  ELSE                                            0969 02510000
*                   IF R8 = NINE       /*IS RECORD AN MDR TYPE       */ 02511000
*                    THEN                                          0969 02512000
         B     @RC00967                                            0969 02513000
@RF00967 C     R8,@CF00085                                         0969 02514000
         BNE   @RF00969                                            0969 02515000
*                     CALL MDRHEDER;   /*FORMAT FOR AN MDR TYPE      */ 02516000
         BAL   @14,MDRHEDER                                        0970 02517000
*                     ELSE                                         0971 02518000
*                      IF R8 = TEN | /*REC IS A MCF TYPE RECORD*/  0971 02519000
*                         R8 = 11     THEN/*IS A CCF TYPE OF RECORD*/   02520000
         B     @RC00969                                            0971 02521000
@RF00969 C     R8,TEN                                              0971 02522000
         BE    @RT00971                                            0971 02523000
         C     R8,@CF00033                                         0971 02524000
         BNE   @RF00971                                            0971 02525000
@RT00971 DS    0H                                                  0972 02526000
*                          CALL FRMHEDER; /*PRINT THE FRAME HEADER*/    02527000
         BAL   @14,FRMHEDER                                        0972 02528000
*                    ELSE                                          0973 02529000
*                     CALL COMMONHD;   /*SHOULD NOT OCCUR BUT JUST IN*/ 02530000
         B     @RC00971                                            0973 02531000
@RF00971 BAL   @14,COMMONHD                                        0973 02532000
*END;                                                      /*@Z427VLS*/ 02533000
@EL00027 DS    0H                                                  0974 02534000
@EF00027 DS    0H                                                  0974 02535000
@ER00027 LM    @14,@12,@SA00027                                    0974 02536000
         BR    @14                                                 0974 02537000
* /*******************************************************************/ 02538000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 02539000
* /*    THIS PROC WILL DETERMINE THE HEADING TO USE IN NORMAL OPERATI*/ 02540000
*TYPEHEAD: PROC;                                           /*@Z427VLS*/ 02541000
TYPEHEAD STM   @14,@12,@SA00028                                    0975 02542000
*  RTYP =(RECTYPE & 'FF80'X);                              /*@G51DGGB*/ 02543000
         L     @06,@CF01557                                        0976 02544000
         LH    @05,RECTYPE(,R2)                                    0976 02545000
         N     @05,@CF01587                                        0976 02546000
         NR    @06,@05                                             0976 02547000
         ST    @06,RTYP                                            0976 02548000
*  IF RTYP = '8000'X                   /*IS IT AN MDR TYPE   @Z427VLS*/ 02549000
*   THEN                                                           0977 02550000
         C     @06,@CF00198                                        0977 02551000
         BNE   @RF00977                                            0977 02552000
*    CALL MCHHEDER;                    /*FORMAT FOR AN MCH RECORD    */ 02553000
         BAL   @14,MCHHEDER                                        0978 02554000
*   ELSE                                                           0979 02555000
*    IF RTYP = '4000'X                 /*IS THE RECORD AN CCH TYPE   */ 02556000
*     THEN                                                         0979 02557000
         B     @RC00977                                            0979 02558000
@RF00977 CLC   RTYP(4),@CF01558                                    0979 02559000
         BNE   @RF00979                                            0979 02560000
*      CALL CCHHEDER;                  /*FORMAT HEADER FOR AN CCH    */ 02561000
         BAL   @14,CCHHEDER                                        0980 02562000
*     ELSE                                                         0981 02563000
*      IF RTYP = '2000'X               /*IS THE RECORD TYPE AN OBR   */ 02564000
*       THEN                                                       0981 02565000
         B     @RC00979                                            0981 02566000
@RF00979 CLC   RTYP(4),@CF01559                                    0981 02567000
         BNE   @RF00981                                            0981 02568000
*        CALL OBRHEDER;                /*FORMAT FOR AN OBR RECORD    */ 02569000
         BAL   @14,OBRHEDER                                        0982 02570000
*       ELSE                                                       0983 02571000
*        IF RTYP = '1000'X                                         0983 02572000
*         THEN                                                     0983 02573000
         B     @RC00981                                            0983 02574000
@RF00981 CLC   RTYP(4),@CF01560                                    0983 02575000
         BNE   @RF00983                                            0983 02576000
*          CALL SFTHEDER;              /*FORMAT FOR SFT TYPE @Z427VLS*/ 02577000
         BAL   @14,SFTHEDER                                        0984 02578000
*         ELSE                                                     0985 02579000
*          IF RTYP = '0800'X                                       0985 02580000
*           THEN                                                   0985 02581000
         B     @RC00983                                            0985 02582000
@RF00983 CLC   RTYP(4),@CF01561                                    0985 02583000
         BNE   @RF00985                                            0985 02584000
*            CALL IPLHEDER;            /*FORMAT FOR IPL RECORD       */ 02585000
         BAL   @14,IPLHEDER                                        0986 02586000
*           ELSE                                                   0987 02587000
*            IF RTYP = '0400'X         /*IS THE RECORD SELECTION DDR */ 02588000
*             THEN                                                 0987 02589000
         B     @RC00985                                            0987 02590000
@RF00985 CLC   RTYP(4),@CF01562                                    0987 02591000
         BNE   @RF00987                                            0987 02592000
*              CALL DDRHEDER;          /*FORMAT FOR AN DDR TYPE      */ 02593000
         BAL   @14,DDRHEDER                                        0988 02594000
*             ELSE                                                 0989 02595000
*              IF RTYP = '0200'X       /*IS THE RECORD SELECTION MIH */ 02596000
*               THEN                                               0989 02597000
         B     @RC00987                                            0989 02598000
@RF00987 CLC   RTYP(4),@CF01563                                    0989 02599000
         BNE   @RF00989                                            0989 02600000
*                CALL MIHHEDER;        /*FORMAT FOR AN MIH TYPE      */ 02601000
         BAL   @14,MIHHEDER                                        0990 02602000
*               ELSE                                               0991 02603000
*                IF RTYP = '0100'X     /*IS THE RECORD SELECTION EOD */ 02604000
*                 THEN                                             0991 02605000
         B     @RC00989                                            0991 02606000
@RF00989 CLC   RTYP(4),@CF00102                                    0991 02607000
         BNE   @RF00991                                            0991 02608000
*                  CALL EODHEDER;      /*FORMAT FOR AN EOD TYPE      */ 02609000
         BAL   @14,EODHEDER                                        0992 02610000
*                 ELSE                                             0993 02611000
*                  IF RTYP = '0080'X                               0993 02612000
*                   THEN                                           0993 02613000
         B     @RC00991                                            0993 02614000
@RF00991 CLC   RTYP(4),@CF01564                                    0993 02615000
         BNE   @RF00993                                            0993 02616000
*                    CALL MDRHEDER;    /*FORMAT FOR AN MDR TYPE      */ 02617000
         BAL   @14,MDRHEDER                                        0994 02618000
*                   ELSE                                           0995 02619000
*                    IF RTYP = '2080'X                             0995 02620000
*                     THEN                                         0995 02621000
         B     @RC00993                                            0995 02622000
@RF00993 CLC   RTYP(4),@CF01565                                    0995 02623000
         BNE   @RF00995                                            0995 02624000
*                      CALL MDROBRHD;  /*FORMAT FOR COMB MDR-OBR TYPE*/ 02625000
         BAL   @14,MDROBRHD                                        0996 02626000
*                     ELSE                                         0997 02627000
*                      IF DEBUG47 = ON |                           0997 02628000
*                         DEBUG46 = ON THEN                        0997 02629000
         B     @RC00995                                            0997 02630000
@RF00995 TM    DEBUG47(R2),B'00000011'                             0997 02631000
         BZ    @RF00997                                            0997 02632000
*                          CALL FRMHEDER;                  /*@G51DGGB*/ 02633000
         BAL   @14,FRMHEDER                                        0998 02634000
*                     ELSE                                         0999 02635000
*                      CALL COMMONHD;  /*JUST COMMON OLD HEADING     */ 02636000
         B     @RC00997                                            0999 02637000
@RF00997 BAL   @14,COMMONHD                                        0999 02638000
*END;                                                      /*@Z427VLS*/ 02639000
*                                                                  1000 02640000
@EL00028 DS    0H                                                  1000 02641000
@EF00028 DS    0H                                                  1000 02642000
@ER00028 LM    @14,@12,@SA00028                                    1000 02643000
         BR    @14                                                 1000 02644000
*/********************************************************************/ 02645000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * **/ 02646000
*/*    THIS PROC WILL DEVELOPE THE TABLE OF CPU SERIAL AND MODEL     */ 02647000
*/*    NUMBERS AND PRINT IT. THIS WILL BE THE LAST THING PRINTED     */ 02648000
*/*                                                          @Z427VLS*/ 02649000
*CPUINFO: PROC;                                            /*@Z427VLS*/ 02650000
CPUINFO  STM   @14,@12,@SA00029                                    1001 02651000
*  SPACING = DOUBLE ;                                      /*@Z427VLS*/ 02652000
         MVC   SPACING(1),DOUBLE                                   1002 02653000
*  CALL PRINTIT;                                           /*@Z427VLS*/ 02654000
         BAL   @14,PRINTIT                                         1003 02655000
*  CPULINE1 = CPULINE;           /*SET UP THE HEADING FOR CPU SERIAL */ 02656000
         MVC   CPULINE1(24),CPULINE                                1004 02657000
*  CALL PRINTIT;                 /*GO AND PRINT IT           @Z427VLS*/ 02658000
         BAL   @14,PRINTIT                                         1005 02659000
*  SPACING = SINGLE;                                       /*@Z427VLS*/ 02660000
         MVC   SPACING(1),SINGLE                                   1006 02661000
*  DO I = 1 BY 1 TO EVNUM;    /*SET UP TO PROCESS ALL CPUS   @Z427VLS*/ 02662000
         LA    @06,1                                               1007 02663000
         ST    @06,I                                               1007 02664000
         B     @DE01007                                            1007 02665000
@DL01007 DS    0H                                                  1008 02666000
*   CPUTYPE = EVLETTER(I);       /*SET IN ACTUAL LETTER      @Z427VLS*/ 02667000
         MH    @06,@CH00080                                        1008 02668000
         L     @05,EVPTR(,R2)                                      1008 02669000
         ST    @06,@TF00001                                        1008 02670000
         ALR   @06,@05                                             1008 02671000
         MVC   CPUTYPE(1),EVLETTER-6(@06)                          1008 02672000
*   NUMBER= TWO;                 /*SET FOR TWO BYTES         @Z427VLS*/ 02673000
         L     @06,TWO                                             1009 02674000
         ST    @06,NUMBER                                          1009 02675000
*   ADDNXT = ADDR(CPUMODEL);     /*WHERE THE INFO IS TO BE PLACED    */ 02676000
         LA    @06,CPUMODEL                                        1010 02677000
         ST    @06,ADDNXT                                          1010 02678000
*   NEXTBY = ADDR(EVMODEL(I));   /*ADDRESS WHERE THE DATA IS @Z427VLS*/ 02679000
         L     @06,@TF00001                                        1011 02680000
         LA    @06,EVMODEL-6(@06,@05)                              1011 02681000
         ST    @06,NEXTBY                                          1011 02682000
*   CALL CONVERT;                /*GO AND CONVERT THE DATA   @Z427VLS*/ 02683000
         BAL   @14,CONVERT                                         1012 02684000
*   ADDNXT = ADDR(CPUSERAL);     /*WHERE TO PUT THE SERIAL DATA      */ 02685000
         LA    @06,CPUSERAL                                        1013 02686000
         ST    @06,ADDNXT                                          1013 02687000
*   NEXTBY = ADDR(EVSERIAL(I));  /*WHERE THE SERIAL INFO IS KEPT     */ 02688000
         L     @06,I                                               1014 02689000
         MH    @06,@CH00080                                        1014 02690000
         L     @05,EVPTR(,R2)                                      1014 02691000
         LA    @06,EVSERIAL-6(@06,@05)                             1014 02692000
         ST    @06,NEXTBY                                          1014 02693000
*   NUMBER = THREE;              /*SET UP FOR THREE IN SIX OUT       */ 02694000
         MVC   NUMBER(4),@CF00075                                  1015 02695000
*   CALL CONVERT ;               /*GO CONVERT THE SERIAL TO PRINTABLE*/ 02696000
         BAL   @14,CONVERT                                         1016 02697000
*   PRTLINE1 = CPUDATA;          /*MOVE CPU DATA TO THE PRINT LINE   */ 02698000
         MVI   PRTLINE1+22,C' '                                    1017 02699000
         MVC   PRTLINE1+23(79),PRTLINE1+22                         1017 02700000
         MVC   PRTLINE1(22),CPUDATA                                1017 02701000
*   CALL PRINTIT;                /*GO PRINT WHAT WE FOUND    @Z427VLS*/ 02702000
         BAL   @14,PRINTIT                                         1018 02703000
*  END;                                                    /*@Z427VLS*/ 02704000
         LA    @06,1                                               1019 02705000
         AL    @06,I                                               1019 02706000
         ST    @06,I                                               1019 02707000
@DE01007 L     @05,EVPTR(,R2)                                      1019 02708000
         CH    @06,EVNUM(,@05)                                     1019 02709000
         BNH   @DL01007                                            1019 02710000
*  SPACING = SINGLE;             /*RESTORE SPACING CONTROL TO 1      */ 02711000
         MVC   SPACING(1),SINGLE                                   1020 02712000
* END;                                                     /*@Z427VLS*/ 02713000
@EL00029 DS    0H                                                  1021 02714000
@EF00029 DS    0H                                                  1021 02715000
@ER00029 LM    @14,@12,@SA00029                                    1021 02716000
         BR    @14                                                 1021 02717000
*/********************************************************************/ 02718000
*/*       THIS PROC WILL DETERMINE THE INDEX FOR ALL FOLLOWING WORK  */ 02719000
*/*       IT IS BASED ON MATCHING THE SERIAL AND CPU WITH EV TABLE   */ 02720000
* CPULETER: PROC;                                          /*@Z427VLS*/ 02721000
CPULETER STM   @14,@12,12(@13)                                     1022 02722000
*   SWITCH3 = OFF;               /*TURN THE SWITCH OFF PRIOR TO START*/ 02723000
         NI    SWITCH3,B'11011111'                                 1023 02724000
*   PTR = ZERO;                  /*START AT ZERO             @Z427VLS*/ 02725000
         SLR   @06,@06                                             1024 02726000
         ST    @06,PTR                                             1024 02727000
*   DO S = 1 BY 1 TO 16 WHILE(SWITCH3 = OFF);          /*    @ZA19014*/ 02728000
         LA    @06,1                                               1025 02729000
         ST    @06,S                                               1025 02730000
@DL01025 TM    SWITCH3,B'00100000'                                 1025 02731000
         BNZ   @DC01025                                            1025 02732000
*     IF EVSERIAL(S) = LRTCPUS   /*DO THE SERIALS MATCH      @Z427VLS*/ 02733000
*        &  EVMODEL(S) = LRTMODEL/*AND THE MODEL # MATCHES   @Z427VLS*/ 02734000
*          THEN                                                    1026 02735000
         LR    @05,@06                                             1026 02736000
         MH    @05,@CH00080                                        1026 02737000
         L     @03,EVPTR(,R2)                                      1026 02738000
         ST    @05,@TF00001                                        1026 02739000
         ALR   @05,@03                                             1026 02740000
         CLC   EVSERIAL-6(3,@05),LRTCPUS(R7)                       1026 02741000
         BNE   @RF01026                                            1026 02742000
         AL    @03,@TF00001                                        1026 02743000
         CLC   EVMODEL-6(2,@03),LRTMODEL(R7)                       1026 02744000
         BNE   @RF01026                                            1026 02745000
*           DO;                                            /*@Z427VLS*/ 02746000
*            PTR = S;            /*SET THE INDEX FOR FOLLOWING PROCS */ 02747000
         ST    @06,PTR                                             1028 02748000
*            SWITCH3 = ON;       /* SET TO EXIT THE LOOP     @Z427VLS*/ 02749000
         OI    SWITCH3,B'00100000'                                 1029 02750000
*           END;                                           /*@Z427VLS*/ 02751000
*   END;                                                   /*@Z427VLS*/ 02752000
@RF01026 LA    @06,1                                               1031 02753000
         AL    @06,S                                               1031 02754000
         ST    @06,S                                               1031 02755000
         C     @06,@CF00088                                        1031 02756000
         BNH   @DL01025                                            1031 02757000
@DC01025 DS    0H                                                  1032 02758000
*                                /*FILT4 DROPS THE BALL BUT JUST IN -*/ 02759000
* END;                                                     /*@Z427VLS*/ 02760000
@EL00030 DS    0H                                                  1032 02761000
@EF00030 DS    0H                                                  1032 02762000
@ER00030 LM    @14,@12,12(@13)                                     1032 02763000
         BR    @14                                                 1032 02764000
@PB00030 DS    0H                                                  1033 02765000
*/********************************************************************/ 02766000
*/********************************************************************/ 02767000
*/*******************PRIME LOOP***************************************/ 02768000
*/*                                                          @Z427VLS*/ 02769000
* IF DEBUG4 = ON THEN           /*PRINT NAME AND COMPILE DATE        */ 02770000
         TM    DEBUG4(R2),B'00001000'                              1033 02771000
         BNO   @RF01033                                            1033 02772000
* DO;                                                      /*@Z427VLS*/ 02773000
*  R9 = R10 -27;                                           /*@Z427VLS*/ 02774000
         LR    R9,R10                                              1035 02775000
         SL    R9,@CF01574                                         1035 02776000
*  GEN(MVC  TIME1(16),0(R9));    /*MOVE IN NAME & COMPILE DATE      */  02777000
         MVC  TIME1(16),0(R9)                                           02778000
*  CALL PRINTIT;                                           /*@Z427VLS*/ 02779000
         BAL   @14,PRINTIT                                         1037 02780000
* END;                                                     /*@Z427VLS*/ 02781000
* DDNAME = '0';                 /*DIRECT BACK TO NORMAL DD SET      */  02782000
@RF01033 MVI   DDNAME,C'0'                                         1039 02783000
* IF DEBUG6 ^= ON & DEBUG24 ^= ON THEN                             1040 02784000
         TM    DEBUG6(R2),B'00000010'                              1040 02785000
         BO    @RF01040                                            1040 02786000
         TM    DEBUG24(R2),B'10000000'                             1040 02787000
         BO    @RF01040                                            1040 02788000
* DO;                                                      /*@Z427VLS*/ 02789000
*IF DEBUG47 ^= ON THEN                                             1042 02790000
         TM    DEBUG47(R2),B'00000001'                             1042 02791000
         BO    @RF01042                                            1042 02792000
* CALL TEMPLATE;                /*GO PRINT OUT THE TEMPLATE  @Z427VLS*/ 02793000
         BAL   @14,TEMPLATE                                        1043 02794000
* CALL MAINHEAD;                /*GO PRINT MAIN HEADING      @Z427VLS*/ 02795000
@RF01042 BAL   @14,MAINHEAD                                        1044 02796000
* IF DEBUG5 ^= ON THEN                                             1045 02797000
         TM    DEBUG5(R2),B'00000100'                              1045 02798000
         BO    @RF01045                                            1045 02799000
*  CALL HEADING;                                           /*@Z427VLS*/ 02800000
         BAL   @14,HEADING                                         1046 02801000
* END;                                                     /*@Z427VLS*/ 02802000
@RF01045 DS    0H                                                  1048 02803000
* DO Y = 1 BY 1 TO SORTNUM;     /*SET UP INDEX TO PROCESS ALL ITEMS  */ 02804000
@RF01040 LA    @06,1                                               1048 02805000
         ST    @06,Y                                               1048 02806000
         B     @DE01048                                            1048 02807000
@DL01048 DS    0H                                                  1049 02808000
*  RECCCHHR = SORTCCHR(Y);      /*SET UP FOR THE DIRECT READ @Z427VLS*/ 02809000
         MH    @06,@CH00032                                        1049 02810000
         L     @05,SORTADR(,R2)                                    1049 02811000
         ALR   @05,@06                                             1049 02812000
         AL    @05,@CF01590                                        1049 02813000
         MVC   RECCCHHR(5,R2),SORTCCHR-5(@05)                      1049 02814000
*  CALL IOHND(READIRCT);                                   /*@Z427VLS*/ 02815000
         L     @15,ADIOHND(,R2)                                    1050 02816000
         LA    @01,@AL01050                                        1050 02817000
         BALR  @14,@15                                             1050 02818000
*  IF R15 = ZERO THEN           /*DON'T PROCESS IF READ ERROR        */ 02819000
         LTR   R15,R15                                             1051 02820000
         BNZ   @RF01051                                            1051 02821000
*   DO;                                                    /*@Z427VLS*/ 02822000
*    R8 = LRTKEY1;              /*PICK UP THE RECORD TYPE    @Z427VLS*/ 02823000
         SLR   R8,R8                                               1053 02824000
         IC    R8,LRTKEY1(,R7)                                     1053 02825000
*    SRL (R8,FOUR);             /*DROP THE UNWANTED BITS FROM THE TYP*/ 02826000
         SRL   R8,4                                                1054 02827000
*    CURRENT = R8;              /*SAVE FOR AN INDEX VALUE    @Z427VLS*/ 02828000
         ST    R8,CURRENT                                          1055 02829000
*  IF(DEBUG5 = ON |             /*PRINT HEADING FOR EACH RECORD      */ 02830000
*  MYLINECT > LINECT) &         /*CHECK IF NEW PAGE IS REQUIRED*/  1056 02831000
*     DEBUG24 ^= ON                                                1056 02832000
*     THEN                                                         1056 02833000
         TM    DEBUG5(R2),B'00000100'                              1056 02834000
         BO    @GL00027                                            1056 02835000
         LH    @06,MYLINECT                                        1056 02836000
         CH    @06,LINECT(,R2)                                     1056 02837000
         BNH   @RF01056                                            1056 02838000
@GL00027 TM    DEBUG24(R2),B'10000000'                             1056 02839000
         BO    @RF01056                                            1056 02840000
*       CALL HEADING;           /*GO PRINT THE HEADING       @Z427VLS*/ 02841000
         BAL   @14,HEADING                                         1057 02842000
*  CALL CPULETER;                                          /*@Z427VLS*/ 02843000
@RF01056 BAL   @14,CPULETER                                        1058 02844000
*  IF LASTDATE ^= LRTDATE & DEBUG6 = OFF                           1059 02845000
*     THEN                                                         1059 02846000
         CLC   LASTDATE(4),LRTDATE(R7)                             1059 02847000
         BE    @RF01059                                            1059 02848000
         TM    DEBUG6(R2),B'00000010'                              1059 02849000
         BNZ   @RF01059                                            1059 02850000
*       CALL NEWDATE;           /*GO PRINT THE NEW DATE      @Z427VLS*/ 02851000
         BAL   @14,NEWDATE                                         1060 02852000
*  IF PTR ^= ZERO THEN          /*DON'T LET A ZERO INDEX SLIP BY     */ 02853000
@RF01059 L     @06,PTR                                             1061 02854000
         LTR   @06,@06                                             1061 02855000
         BZ    @RF01061                                            1061 02856000
*   DO;                                                    /*@Z427VLS*/ 02857000
*    CALL MOVEDATA;             /*MOVE THE DATA INTO THE PRINT LINE  */ 02858000
         BAL   @14,MOVEDATA                                        1063 02859000
*    IF DEBUG6 = OFF & DEBUG24 = OFF THEN  /* IF TRUE DON'T PRINT    */ 02860000
         TM    DEBUG6(R2),B'00000010'                              1064 02861000
         BNZ   @RF01064                                            1064 02862000
         TM    DEBUG24(R2),B'10000000'                             1064 02863000
         BNZ   @RF01064                                            1064 02864000
*      CALL PRINTIT;            /*GO PRINT OUT THE DATA LINE @Z427VLS*/ 02865000
         BAL   @14,PRINTIT                                         1065 02866000
*   END;                                                   /*@Z427VLS*/ 02867000
* END;                                                     /*@Z427VLS*/ 02868000
* ELSE                                                             1068 02869000
*  BADRECRD = BADRECRD + ONE;   /*ADD 1 TO NUMBER OF READ FAILURES   */ 02870000
         B     @RC01051                                            1068 02871000
@RF01051 L     @06,BADRECRD                                        1068 02872000
         AL    @06,ONE                                             1068 02873000
         ST    @06,BADRECRD                                        1068 02874000
* IF DEBUG17 = ON &R15 = ZERO THEN/*   WANTS A HEX DUMP OF EACH REC. */ 02875000
@RC01051 TM    DEBUG17(R2),B'01000000'                             1069 02876000
         BNO   @RF01069                                            1069 02877000
         SLR   @14,@14                                             1069 02878000
         CR    R15,@14                                             1069 02879000
         BNE   @RF01069                                            1069 02880000
*  DO;                                                     /*@Z427VLS*/ 02881000
*   MYLINECT = ZERO;            /*DON'T LET UP SPACE GET IN ACTION   */ 02882000
         STH   @14,MYLINECT                                        1071 02883000
*   NUMBER = 66;                                           /*@Z427VLS*/ 02884000
         LA    @06,66                                              1072 02885000
         ST    @06,NUMBER                                          1072 02886000
*   ADDNXT = ADDR(TIME1);                                  /*@Z427VLS*/ 02887000
         LA    @05,TIME1                                           1073 02888000
         ST    @05,ADDNXT                                          1073 02889000
*   NEXTBY = R7;                                           /*@Z427VLS*/ 02890000
         ST    R7,NEXTBY                                           1074 02891000
*   DO T = 66 BY 66 TO RECLNGTH;                           /*@Z427VLS*/ 02892000
         ST    @06,T                                               1075 02893000
         B     @DE01075                                            1075 02894000
@DL01075 DS    0H                                                  1076 02895000
*    CALL CONVERT;                                         /*@Z427VLS*/ 02896000
         BAL   @14,CONVERT                                         1076 02897000
*    NEXTBY = NEXTBY + 66;                                 /*@Z427VLS*/ 02898000
         LA    @06,66                                              1077 02899000
         AL    @06,NEXTBY                                          1077 02900000
         ST    @06,NEXTBY                                          1077 02901000
*    CALL PRINTIT;                                         /*@Z427VLS*/ 02902000
         BAL   @14,PRINTIT                                         1078 02903000
*   END;                                                   /*@Z427VLS*/ 02904000
         LA    @06,66                                              1079 02905000
         AL    @06,T                                               1079 02906000
         ST    @06,T                                               1079 02907000
@DE01075 CH    @06,RECLNGTH(,R2)                                   1079 02908000
         BNH   @DL01075                                            1079 02909000
*   NUMBER = RECLNGTH - (T-66);                            /*@Z427VLS*/ 02910000
         L     @06,T                                               1080 02911000
         SL    @06,@CF01576                                        1080 02912000
         LCR   @06,@06                                             1080 02913000
         AH    @06,RECLNGTH(,R2)                                   1080 02914000
         ST    @06,NUMBER                                          1080 02915000
*   IF NUMBER > ZERO THEN                                          1081 02916000
         LTR   @06,@06                                             1081 02917000
         BNP   @RF01081                                            1081 02918000
*    DO;                                                   /*@Z427VLS*/ 02919000
*     CALL CONVERT;                                        /*@Z427VLS*/ 02920000
         BAL   @14,CONVERT                                         1083 02921000
*     CALL PRINTIT;                                        /*@Z427VLS*/ 02922000
         BAL   @14,PRINTIT                                         1084 02923000
*    END;                                                  /*@Z427VLS*/ 02924000
*   CALL PRINTIT;               /*BLANK LINE TO MAKE MORE READABLE   */ 02925000
@RF01081 BAL   @14,PRINTIT                                         1086 02926000
*  END;                                                    /*@Z427VLS*/ 02927000
* END;                                                     /*@Z427VLS*/ 02928000
@RF01069 LA    @06,1                                               1088 02929000
         AL    @06,Y                                               1088 02930000
         ST    @06,Y                                               1088 02931000
@DE01048 C     @06,SORTNUM(,R2)                                    1088 02932000
         BNH   @DL01048                                            1088 02933000
*IF DEBUG47 ^= ON THEN                                             1089 02934000
         TM    DEBUG47(R2),B'00000001'                             1089 02935000
         BO    @RF01089                                            1089 02936000
* CALL PRTTOTAL;         /*GO  PRINT THE SUMMRY TABLE        @G51DGGB*/ 02937000
         BAL   @14,PRTTOTAL                                        1090 02938000
*CALL CPUINFO;                  /*GO PRINT THE CUP SERIAL LETTER TAB */ 02939000
@RF01089 BAL   @14,CPUINFO                                         1091 02940000
* IF BADRECRD ^= ZERO THEN                                         1092 02941000
         L     @06,BADRECRD                                        1092 02942000
         LTR   @06,@06                                             1092 02943000
         BZ    @RF01092                                            1092 02944000
*  DO;                                                     /*@Z427VLS*/ 02945000
*   CALL IFCMSG(63,ADDR(BADREC));                          /*@Z427VLS*/ 02946000
         LA    @06,BADREC                                          1094 02947000
         ST    @06,@AFTEMPS                                        1094 02948000
         L     @15,ADIFCMSG(,R2)                                   1094 02949000
         LA    @01,@AL01094                                        1094 02950000
         BALR  @14,@15                                             1094 02951000
*   BINWORD = BADRECRD;         /*SET UP THE BINARY COUNT TO CONVERT */ 02952000
         L     @06,BADRECRD                                        1095 02953000
         ST    @06,BINWORD                                         1095 02954000
*   DECADDR = ADDR(NUMFAIL);    /*SET UP ADDRESS OF WHERE TO PUT IT  */ 02955000
         LA    @06,NUMFAIL                                         1096 02956000
         ST    @06,DECADDR                                         1096 02957000
*   BNDECNUM = SIX;             /*NUMBER OF CHARS TO PRINT   @Z427VLS*/ 02958000
         L     @06,SIX                                             1097 02959000
         ST    @06,BNDECNUM                                        1097 02960000
*   CALL CONVBIN;               /*GO CONVERT THE NUMBER TO PRINTABLE */ 02961000
         BAL   @14,CONVBIN                                         1098 02962000
*   CALL PRINTIT;               /*PRINT THE BAD RECORD COUNT MESSAGE */ 02963000
         BAL   @14,PRINTIT                                         1099 02964000
*  END;                                                    /*@Z427VLS*/ 02965000
* IF DEBUG12 = ON THEN          /*USER WANTS TO ABEND        @Z427VLS*/ 02966000
@RF01092 TM    DEBUG12(R2),B'00001000'                             1101 02967000
         BNO   @RF01101                                            1101 02968000
* GEN(ABEND 444,DUMP);                                     /*@Z427VLS*/ 02969000
         ABEND 444,DUMP                                                 02970000
*/********************************************************************/ 02971000
*/********************************************************************/ 02972000
*RETURN;                                                   /*@Z427VLS*/ 02973000
@EL00001 L     @13,4(,@13)                                         1103 02974000
@EF00001 DS    0H                                                  1103 02975000
@ER00001 L     @14,12(,@13)                                        1103 02976000
         LM    @00,@12,20(@13)                                     1103 02977000
         BR    @14                                                 1103 02978000
*END                                                       /*@Z427VLS*/ 02979000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 02980000
*/*%INCLUDE SYSLIB  (COMTABLE)                                        * 02981000
*;                                                                 1104 02982000
         B     @EL00001                                            1104 02983000
@DATA    DS    0H                                                       02984000
@CH00227 DC    H'24'                                                    02985000
         DS    0F                                                       02986000
@AL00413 EQU   *                       LIST WITH   1 ARGUMENT(S)        02987000
@AL00427 EQU   *                       LIST WITH   1 ARGUMENT(S)        02988000
@AL00438 DC    A(@CF00073+2)           LIST WITH   1 ARGUMENT(S)        02989000
@AL00799 DC    A(@CF01409)             LIST WITH   3 ARGUMENT(S)        02990000
@AL01050 DC    A(@CF00080+2)           LIST WITH   1 ARGUMENT(S)        02991000
         DC    A(DEVTYPE1)                                              02992000
@AL00867 DC    A(@CF00850)             LIST WITH   3 ARGUMENT(S)        02993000
         DC    A(DEVCOMP)                                               02994000
         DC    A(DEVTYPE1)                                              02995000
@AL01094 DC    A(@CF01577)             LIST WITH   2 ARGUMENT(S)        02996000
         DC    A(@AFTEMPS)                                              02997000
         DS    0F                                                       02998000
@SA00001 DS    18F                                                      02999000
@SA00002 DS    15F                                                      03000000
@SA00008 DS    15F                                                      03001000
@SA00003 DS    15F                                                      03002000
@SA00005 DS    15F                                                      03003000
@SA00006 DS    15F                                                      03004000
@SA00007 DS    15F                                                      03005000
@SA00009 DS    15F                                                      03006000
@SA00010 DS    15F                                                      03007000
@SA00011 DS    15F                                                      03008000
@SA00013 DS    15F                                                      03009000
@SA00014 DS    15F                                                      03010000
@SA00027 DS    15F                                                      03011000
@SA00028 DS    15F                                                      03012000
@SA00020 DS    15F                                                      03013000
@SA00021 DS    15F                                                      03014000
@SA00024 DS    15F                                                      03015000
@SA00025 DS    15F                                                      03016000
@SA00029 DS    15F                                                      03017000
@SA00012 DS    0F                                                       03018000
         DS    15F                                                      03019000
@AL00001 DS    3A                                                       03020000
@TF00001 DS    F                                                        03021000
@AFTEMPS DS    1F                                                       03022000
         DS    0F                                                       03023000
@CF00055 DC    F'1'                                                     03024000
@CF00073 DC    F'2'                                                     03025000
@CH00073 EQU   @CF00073+2                                               03026000
@CF00075 DC    F'3'                                                     03027000
@CH00075 EQU   @CF00075+2                                               03028000
@CF00035 DC    F'4'                                                     03029000
@CF00078 DC    F'5'                                                     03030000
@CF00080 DC    F'6'                                                     03031000
@CH00080 EQU   @CF00080+2                                               03032000
@CF00082 DC    F'7'                                                     03033000
@CH00082 EQU   @CF00082+2                                               03034000
@CF00065 DC    F'8'                                                     03035000
@CF00085 DC    F'9'                                                     03036000
@CF00032 DC    F'10'                                                    03037000
@CH00032 EQU   @CF00032+2                                               03038000
@CF00033 DC    F'11'                                                    03039000
@CF01462 DC    F'14'                                                    03040000
@CF00088 DC    F'16'                                                    03041000
@CF00850 DC    F'22'                                                    03042000
@CH00850 EQU   @CF00850+2                                               03043000
@CF01168 DC    F'26'                                                    03044000
@CF01574 DC    F'27'                                                    03045000
@CF01409 DC    F'32'                                                    03046000
@CF01577 DC    F'63'                                                    03047000
@CF01576 DC    F'66'                                                    03048000
@CF01590 DC    F'-5'                                                    03049000
@CF01587 DC    XL4'0000FFFF'                                            03050000
@CF00102 DC    XL4'0100'                                                03051000
@CF00198 DC    XL4'8000'                                                03052000
@CF01557 DC    XL4'FF80'                                                03053000
@CF01558 DC    XL4'4000'                                                03054000
@CF01559 DC    XL4'2000'                                                03055000
@CF01560 DC    XL4'1000'                                                03056000
@CF01561 DC    XL4'0800'                                                03057000
@CF01562 DC    XL4'0400'                                                03058000
@CF01563 DC    XL4'0200'                                                03059000
@CF01564 DC    XL4'0080'                                                03060000
@CF01565 DC    XL4'2080'                                                03061000
@CV01456 DC    V(IFCDEVIC)                                              03062000
         DS    0D                                                       03063000
PTR      DC    F'0'                                                     03064000
L8       DC    F'8'                                                     03065000
J        DC    F'0'                                                     03066000
TOTOFTOT DC    F'0'                                                     03067000
BADRECRD DC    F'0'                                                     03068000
TEN      DC    F'10'                                                    03069000
FIVE     DC    F'5'                                                     03070000
ONE      DC    F'1'                                                     03071000
TWOEIGHT DC    F'28'                                                    03072000
NEXTBY   DC    F'0'                                                     03073000
ADDNXT   DC    F'0'                                                     03074000
BINWORD  DC    F'0'                                                     03075000
NUMBER1  DC    F'1'                                                     03076000
BNDECNUM DC    F'0'                                                     03077000
DECADDR  DC    F'0'                                                     03078000
I        DC    F'0'                                                     03079000
NUMBER   DC    F'0'                                                     03080000
TWO      DC    F'2'                                                     03081000
CURRENT  DC    F'0'                                                     03082000
MINUS1   DC    F'-1'                                                    03083000
TOTAL    DC    F'0'                                                     03084000
X        DC    F'0'                                                     03085000
K        DC    F'0'                                                     03086000
Z        DC    F'0'                                                     03087000
SIX      DC    F'6'                                                     03088000
M        DC    F'0'                                                     03089000
N        DC    F'0'                                                     03090000
L        DC    F'0'                                                     03091000
P        DC    F'0'                                                     03092000
R        DC    F'0'                                                     03093000
S        DC    F'0'                                                     03094000
T        DC    F'0'                                                     03095000
Y        DC    F'0'                                                     03096000
SEVEN    DC    F'7'                                                     03097000
RTYP     DC    F'0'                                                     03098000
MYLINECT DC    H'1000'                                                  03099000
@TS00001 DS    CL2                                                      03100000
@CC01355 DC    C'CSID='                                                 03101000
@CC01435 DC    C'3410'                                                  03102000
@CC01436 DC    C'3420'                                                  03103000
@CC01437 DC    C'34XX'                                                  03104000
@CB00198 DC    X'8000'                                                  03105000
@CB01420 DC    X'0168'                                                  03106000
@CB01421 DC    X'3062'                                                  03107000
@CB01425 DC    X'F000'                                                  03108000
@CB01427 DC    X'2009'                                                  03109000
@CB01428 DC    X'200D'                                                  03110000
@CB01474 DC    X'0843'                                                  03111000
@CB01475 DC    X'0842'                                                  03112000
LINE01   DC    CL23'EVENT HISTORY TEMPLATE '                            03113000
LINE02   DC    CL20'FOR RECORD TYPES:  '                                03114000
LINE03   DC    CL12'MCH, MCH-TRM'                                       03115000
LINE04   DC    CL33'   TIME     JOBNAME  RECTYP  CPU '                  03116000
LINE06   DC    CL21'CCH, CCH-INC, CCH-CRH'                              03117000
LINE08   DC    CL3'OBR'                                                 03118000
LINE10   DC    CL74'OBR-DMT, OBR-EOD, DDR, DDR-OPR, DDR-SYS, MIH MIH-CEC03119000
               , MIH-DE, MDR         '                                  03120000
LINE12   DC    CL16'OBR-PRM, OBR-TMP'                                   03121000
LINE14   DC    CL38'SFT, SFT-ABN, SFT-MCH, SFT-PI, SFT-RST'             03122000
LINE16   DC    CL3'IPL'                                                 03123000
LINE18   DC    CL3'EOD'                                                 03124000
DEVCOMP  DC    CL2'  '                                                  03125000
LOSTMSG  DC    CL54'LOST RECORD SUMMARY  TYPE=4F (SHORT SOFT RECORD)   C03126000
                  '                                                     03127000
PRTLINE  DC    CL154' '                                                 03128000
         ORG   PRTLINE                                                  03129000
DDNAME   DC    CL1'1'                                                   03130000
SPACING  DC    X'09'                                                    03131000
TIME1    DS    CL11                                                     03132000
@NM00085 DS    CL1                                                      03133000
JOBNAME1 DS    CL8                                                      03134000
@NM00086 DS    CL1                                                      03135000
RECTYP1  DS    CL7                                                      03136000
@NM00087 DS    CL1                                                      03137000
CPU11    DS    CL1                                                      03138000
CPU12    DS    CL1                                                      03139000
@NM00088 DS    CL1                                                      03140000
CUA11    DS    CL1                                                      03141000
CUA12    DS    CL1                                                      03142000
@NM00089 DS    CL2                                                      03143000
@NM00090 DS    CL1                                                      03144000
LETTERV  DS    CL1                                                      03145000
DEVICE1  DS    CL4                                                      03146000
@NM00091 DS    CL2                                                      03147000
CMD1     DS    CL2                                                      03148000
@NM00092 DS    CL1                                                      03149000
CSW1     DS    CL4                                                      03150000
VLETTER  DS    CL1                                                      03151000
@NM00093 DS    CL1                                                      03152000
SENSEA1  DS    CL8                                                      03153000
@NM00094 DS    CL1                                                      03154000
SENSEA2  DS    CL8                                                      03155000
@NM00095 DS    CL1                                                      03156000
SENSEA3  DS    CL8                                                      03157000
@NM00096 DS    CL1                                                      03158000
SENSEA4  DS    CL8                                                      03159000
@NM00097 DS    CL1                                                      03160000
SENSEA5  DS    CL8                                                      03161000
@NM00098 DS    CL1                                                      03162000
SENSEA6  DS    CL8                                                      03163000
@NM00099 DS    CL1                                                      03164000
VOLUME1  DS    CL6                                                      03165000
         ORG   VOLUME1                                                  03166000
SENSEA7  DS    CL1                                                      03167000
         ORG   PRTLINE+115                                              03168000
@NM00100 DS    CL1                                                      03169000
BB1      DS    CL4                                                      03170000
         ORG   BB1                                                      03171000
@NM00101 DS    CL2                                                      03172000
SENSEA8  DS    CL2                                                      03173000
         ORG   PRTLINE+120                                              03174000
@NM00102 DS    CL1                                                      03175000
CC1      DS    CL4                                                      03176000
@NM00103 DS    CL1                                                      03177000
HH1      DS    CL4                                                      03178000
         ORG   HH1                                                      03179000
@NM00104 DS    CL2                                                      03180000
SENSEA9  DS    CL2                                                      03181000
         ORG   PRTLINE+130                                              03182000
@NM00105 DS    CL1                                                      03183000
R111     DS    CL2                                                      03184000
         ORG   PRTLINE+154                                              03185000
UPSPACE  DC    X'89'                                                    03186000
SINGLE   DC    X'09'                                                    03187000
DOUBLE   DC    X'11'                                                    03188000
TRIPLE   DC    X'19'                                                    03189000
DDRSPEC  DS    CL12                                                     03190000
         ORG   DDRSPEC                                                  03191000
@NM00106 DC    CL3'TO '                                                 03192000
TOCUA    DC    CL3'   '                                                 03193000
@NM00107 DC    CL2'  '                                                  03194000
DEVSAVE  DS    CL4                                                      03195000
         ORG   DDRSPEC+12                                               03196000
TOO      DC    CL2'TO'                                                  03197000
UKNO     DC    CL4'UKNO'                                                03198000
REPORTDY DC    CL12'REPORT DATE '                                       03199000
HEADDATE DS    CL18                                                     03200000
         ORG   HEADDATE                                                 03201000
@NM00109 DC    CL7'PERIOD '                                             03202000
FROMTO   DC    CL5'FROM '                                               03203000
DATE     DS    CL6                                                      03204000
         ORG   DATE                                                     03205000
DATEDAY  DC    CL3'   '                                                 03206000
@NM00110 DC    CL1' '                                                   03207000
DATEYR   DC    CL2'  '                                                  03208000
         ORG   HEADDATE+18                                              03209000
TO       DC    CL5'  TO '                                               03210000
NOTAPPLY DC    CL8'  N/A   '                                            03211000
BLANK    DC    CL6'      '                                              03212000
BLANK1   DC    X'000000000000'                                          03213000
KEEPSP   DC    CL1' '                                                   03214000
LINE8    DC    CL78'                     PSW-MCH /PROG-EC              C03215000
                                 ERROR-ID '                             03216000
LINE1    DC    CL18'CUA DEVICE     CSW'                                 03217000
LINE2    DC    CL18'CUA DEVICE CMD CSW'                                 03218000
LINE3    DC    CL104'CUA DEVICE                                        C03219000
                                       VOLUME/TERMINAL NAME        '    03220000
LINE5    DC    CL98'CUA DEVICE CMD CSW  SENSE    04  06   08  10   12  C03221000
               14   16  18   20  22   VOLUME B B  C C  H H  R'          03222000
LINE66   DC    CL78'          REASON     PSW-MCH /PROG-EC   RCYRYXIT  CC03223000
               OMP/MOD  CSECTID  ERROR-ID '                             03224000
LINE7    DC    CL17'   SSYS ID REASON'                                  03225000
LINE6    DC    CL78'   SSYS ID  REASON   PSW-MCH /PROG-EC   RCYRYXIT  CC03226000
               OMP/MOD  CSECTID  ERROR-ID'                              03227000
LINE4    DC    CL87'CUA DEVICE                             BYTES    DATC03228000
               A CK  SEEKS  OVERRUN   VOLUME'                           03229000
@NM00122 DS    CL182                                                    03230000
         ORG   @NM00122                                                 03231000
MCH      DC    CL7'MCH    '                                             03232000
MCHTRM   DC    CL7'MCH-TRM'                                             03233000
CCH      DC    CL7'CCH    '                                             03234000
CCHINC   DC    CL7'CCH-INC'                                             03235000
CCHCRH   DC    CL7'CCH-CRH'                                             03236000
OBR      DC    CL7'OBR    '                                             03237000
OBRSHT   DC    CL7'OBR-SHT'                                             03238000
OBRDMT   DC    CL7'OBR-DMT'                                             03239000
OBREOD   DC    CL7'OBR-EOD'                                             03240000
OBRTMP   DC    CL7'OBR-TMP'                                             03241000
OBRPRM   DC    CL7'OBR-PRM'                                             03242000
SFT      DC    CL7'SFT    '                                             03243000
SFTABN   DC    CL7'SFT-ABN'                                             03244000
SFTMCH   DC    CL7'SFT-MCH'                                             03245000
SFTPI    DC    CL7'SFT-PI '                                             03246000
SFTRST   DC    CL7'SFT-RST'                                             03247000
IPL      DC    CL7'IPL    '                                             03248000
DDR      DC    CL7'DDR    '                                             03249000
DDROPR   DC    CL7'DDR-OPR'                                             03250000
DDRSYS   DC    CL7'DDR-SYS'                                             03251000
MIH      DC    CL7'MIH    '                                             03252000
MIHCE    DC    CL7'MIH-CE '                                             03253000
MIHDE    DC    CL7'MIH-DE '                                             03254000
EOD      DC    CL7'EOD    '                                             03255000
MDR      DC    CL7'MDR    '                                             03256000
MDRDAS   DC    CL7'MDR-DAS'                                             03257000
         ORG   @NM00122+182                                             03258000
         DS    CL3                                                      03259000
ALLCTS   DS    CL1664                                                   03260000
         ORG   ALLCTS                                                   03261000
MCHCT    DC    16F'0'                                                   03262000
MCHTRMCT DC    16F'0'                                                   03263000
CCHCT    DC    16F'0'                                                   03264000
CCHINCCT DC    16F'0'                                                   03265000
CCHCRHCT DC    16F'0'                                                   03266000
OBRCT    DC    16F'0'                                                   03267000
OBRSHTCT DC    16F'0'                                                   03268000
OBRDMTCT DC    16F'0'                                                   03269000
OBREODCT DC    16F'0'                                                   03270000
OBRTMPCT DC    16F'0'                                                   03271000
OBRPRMCT DC    16F'0'                                                   03272000
SFTCT    DC    16F'0'                                                   03273000
SFTABNCT DC    16F'0'                                                   03274000
SFTMCHCT DC    16F'0'                                                   03275000
SFTPICT  DC    16F'0'                                                   03276000
SFTRSTCT DC    16F'0'                                                   03277000
IPLCT    DC    16F'0'                                                   03278000
DDRCT    DC    16F'0'                                                   03279000
DDROPRCT DC    16F'0'                                                   03280000
DDRSYSCT DC    16F'0'                                                   03281000
MIHCT    DC    16F'0'                                                   03282000
MIHCECT  DC    16F'0'                                                   03283000
MIHDECT  DC    16F'0'                                                   03284000
EODCT    DC    16F'0'                                                   03285000
MDRCT    DC    16F'0'                                                   03286000
MDRDASCT DC    16F'0'                                                   03287000
         ORG   ALLCTS+1664                                              03288000
LASTDATE DC    CL4'    '                                                03289000
TABLECHH DC    CL2'  '                                                  03290000
TOTALHD1 DC    CL12'RECORD TYPES'                                       03291000
TOTALHD3 DC    CL107' TOTAL  CPU-A CPU-B CPU-C CPU-D CPU-E CPU-F CPU-G C03292000
               CPU-H CPU-I CPU-J CPU-K CPU-L CPU-M CPU-N CPU-O CPU-P   C03293000
                '                                                       03294000
CHARS    DC    CL16'0123456789ABCDEF'                                   03295000
         DS    CL3                                                      03296000
WORK     DS    CL8                                                      03297000
TEMPSAVE DC    CL84' '                                                  03298000
SWITCHE  DC    AL1(0)                                                   03299000
         ORG   SWITCHE                                                  03300000
SWITCH1  DS    BL1                                                      03301000
SWITCH2  EQU   SWITCHE+0                                                03302000
SWITCH3  EQU   SWITCHE+0                                                03303000
SWITCH4  EQU   SWITCHE+0                                                03304000
SWITCH5  EQU   SWITCHE+0                                                03305000
         ORG   SWITCHE+1                                                03306000
LETTER1  DC    CL1'M'                                                   03307000
CPULINE  DC    CL24'CPU   MODEL   SERIAL NO.'                           03308000
CPUDATA  DC    CL22' '                                                  03309000
         ORG   CPUDATA                                                  03310000
@NM00126 DS    CL1                                                      03311000
CPUTYPE  DS    CL1                                                      03312000
@NM00127 DS    CL5                                                      03313000
CPUMODEL DS    CL3                                                      03314000
@NM00128 DS    CL6                                                      03315000
CPUSERAL DS    CL6                                                      03316000
         ORG   CPUDATA+22                                               03317000
NEWDATEH DS    CL12                                                     03318000
         ORG   NEWDATEH                                                 03319000
@NM00129 DC    CL5'DATE '                                               03320000
DAYJUL   DC    CL3'   '                                                 03321000
@NM00130 DC    CL2'  '                                                  03322000
YEARJUL  DC    CL2'  '                                                  03323000
         ORG   NEWDATEH+12                                              03324000
OVERTOT  DC    CL16' OVER ALL TOTALS'                                   03325000
MDRLINE  DC    CL35'RD/SRCHD COR/RTRY  CNT/ERR COM/DATA'                03326000
FRAMEMCH DC    CL7'FRM-MCH'                                             03327000
FRAMECCH DC    CL7'FRM-CCH'                                             03328000
FRMTEMP  DC    CL7' '                                                   03329000
LINEFRAM DC    CL43'GROUP   FRAME   EC LEVEL    SEQ #  LASTFLAG'        03330000
         DS    CL5                                                      03331000
DBLWORD  DS    CL8                                                      03332000
SUPERZAP DC    3CL10'SUPERZAP'                                          03333000
TOTHEAD  DC    CL22'MACHINE CHECK         '                             03334000
         DC    CL22'CHANNEL CHECK         '                             03335000
         DC    CL22'OUTBOARD              '                             03336000
         DC    CL22'SOFTWARE              '                             03337000
         DC    CL22'SYSTEM INITIALIZATION '                             03338000
         DC    CL22'SYSTEM RECONFIGURATION'                             03339000
         DC    CL22'MISSING INTERRUPT     '                             03340000
         DC    CL22'SYSTEM TERMINATION    '                             03341000
         DC    CL22'BUFFER OFFLOAD        '                             03342000
ADDRTAB1 DC    AL4(LINE03)                                              03343000
         DC    AL4(LINE06)                                              03344000
         DC    AL4(LINE08)                                              03345000
         DC    AL4(LINE10)                                              03346000
         DC    AL4(LINE12)                                              03347000
         DC    AL4(LINE14)                                              03348000
         DC    AL4(LINE16)                                              03349000
         DC    AL4(LINE18)                                              03350000
         DC    AL4(MDRDAS)                                              03351000
NUMCHAR1 DC    A(11)                                                    03352000
         DC    A(20)                                                    03353000
         DC    A(2)                                                     03354000
         DC    A(73)                                                    03355000
         DC    A(15)                                                    03356000
         DC    A(37)                                                    03357000
         DC    A(2)                                                     03358000
         DC    A(2)                                                     03359000
         DC    A(6)                                                     03360000
ADDRTAB2 DC    AL4(LINE8)                                               03361000
         DC    AL4(LINE1)                                               03362000
         DC    AL4(LINE2)                                               03363000
         DC    AL4(LINE3)                                               03364000
         DC    AL4(LINE5)                                               03365000
         DC    AL4(LINE66)                                              03366000
         DC    AL4(LINE7)                                               03367000
         DC    AL4(LINE6)                                               03368000
         DC    AL4(LINE4)                                               03369000
NUMCHAR2 DC    A(77)                                                    03370000
         DC    A(17)                                                    03371000
         DC    A(17)                                                    03372000
         DC    A(103)                                                   03373000
         DC    A(97)                                                    03374000
         DC    A(77)                                                    03375000
         DC    A(16)                                                    03376000
         DC    A(0)                                                     03377000
         DC    A(79)                                                    03378000
SUBTOT   DC    16F'0'                                                   03379000
PATCH    DC    20F'0'                                                   03380000
TOTALS   DC    16F'0'                                                   03381000
LETTER   DC    CL1'M'                                                   03382000
         DC    CL1'M'                                                   03383000
         DC    CL1'C'                                                   03384000
         DC    CL1'C'                                                   03385000
         DC    CL1'C'                                                   03386000
         DC    CL1'O'                                                   03387000
         DC    CL1'O'                                                   03388000
         DC    CL1'O'                                                   03389000
         DC    CL1'O'                                                   03390000
         DC    CL1'O'                                                   03391000
         DC    CL1'O'                                                   03392000
         DC    CL1'S'                                                   03393000
         DC    CL1'S'                                                   03394000
         DC    CL1'S'                                                   03395000
         DC    CL1'S'                                                   03396000
         DC    CL1'S'                                                   03397000
         DC    CL1'I'                                                   03398000
         DC    CL1'D'                                                   03399000
         DC    CL1'D'                                                   03400000
         DC    CL1'D'                                                   03401000
         DC    CL1'M'                                                   03402000
         DC    CL1'M'                                                   03403000
         DC    CL1'M'                                                   03404000
         DC    CL1'E'                                                   03405000
         DC    CL1'M'                                                   03406000
         DC    CL1'M'                                                   03407000
IFCEVENT CSECT                                                          03408000
         DC    S(SUPERZAP)                                              03409000
IFCEVENT CSECT                                                          03410000
     DC  S(PATCH)    SET UP THE ADDRESSABILITY FOR THE PATCH AREA       03411000
IFCEVENT CSECT                                                          03412000
EXECMVC  MVC RECTYP1(0),0(R8)                                           03413000
EXECMVC2 MVC   CUA12(0),0(R8)                                           03414000
IFCEVENT CSECT                                                          03415000
MVCDATA  MVC   R0(R0,R6),0(R8)                                          03416000
IFCEVENT CSECT                                                          03417000
MOVECHAR   MVC  R0(0,R8),0(R6)                                          03418000
IFCEVENT CSECT                                                          03419000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       03420000
@01      EQU   01                                                       03421000
@02      EQU   02                                                       03422000
@03      EQU   03                                                       03423000
@04      EQU   04                                                       03424000
@05      EQU   05                                                       03425000
@06      EQU   06                                                       03426000
@07      EQU   07                                                       03427000
@08      EQU   08                                                       03428000
@09      EQU   09                                                       03429000
@10      EQU   10                                                       03430000
@11      EQU   11                                                       03431000
@12      EQU   12                                                       03432000
@13      EQU   13                                                       03433000
@14      EQU   14                                                       03434000
@15      EQU   15                                                       03435000
I0001    EQU   @03                                                      03436000
R2       EQU   @02                                                      03437000
R5       EQU   @05                                                      03438000
R6       EQU   @06                                                      03439000
R7       EQU   @07                                                      03440000
R8       EQU   @08                                                      03441000
R9       EQU   @09                                                      03442000
R10      EQU   @10                                                      03443000
R11      EQU   @11                                                      03444000
R12      EQU   @12                                                      03445000
R15      EQU   @15                                                      03446000
R0       EQU   @00                                                      03447000
R1       EQU   @01                                                      03448000
R13      EQU   @13                                                      03449000
R14      EQU   @14                                                      03450000
R3       EQU   @03                                                      03451000
R4       EQU   @04                                                      03452000
IOHND    EQU   0                                                        03453000
IFCMSG   EQU   0                                                        03454000
PARM     EQU   0                                                        03455000
RECTYPE  EQU   PARM                                                     03456000
SWITCHES EQU   PARM+2                                                   03457000
DEBUG    EQU   PARM+4                                                   03458000
DEBUG4   EQU   DEBUG                                                    03459000
DEBUG5   EQU   DEBUG                                                    03460000
DEBUG6   EQU   DEBUG                                                    03461000
DEBUG12  EQU   DEBUG+1                                                  03462000
DEBUG17  EQU   DEBUG+2                                                  03463000
DEBUG24  EQU   DEBUG+3                                                  03464000
DEBUG29  EQU   DEBUG+3                                                  03465000
DEBUGA   EQU   PARM+8                                                   03466000
DEBUG46  EQU   DEBUGA+1                                                 03467000
DEBUG47  EQU   DEBUGA+1                                                 03468000
MISC     EQU   PARM+12                                                  03469000
PRINTES  EQU   MISC                                                     03470000
OPENCLSE EQU   PARM+13                                                  03471000
OPENIO   EQU   OPENCLSE                                                 03472000
CLOSEIO  EQU   OPENCLSE+2                                               03473000
DATENOW  EQU   PARM+17                                                  03474000
STDT     EQU   PARM+23                                                  03475000
STDATE   EQU   STDT                                                     03476000
PSTD     EQU   STDATE+1                                                 03477000
ENDDT    EQU   PARM+31                                                  03478000
ENDDATE  EQU   ENDDT                                                    03479000
PEND     EQU   ENDDATE+1                                                03480000
STTIME1  EQU   PARM+39                                                  03481000
ENDTIME1 EQU   PARM+43                                                  03482000
STTIME2  EQU   PARM+47                                                  03483000
ENDTIME2 EQU   PARM+51                                                  03484000
STRTDATE EQU   PARM+55                                                  03485000
EVSYEAR  EQU   STRTDATE                                                 03486000
EVSDAY   EQU   STRTDATE+1                                               03487000
@NM00006 EQU   PARM+72                                                  03488000
@NM00007 EQU   PARM+75                                                  03489000
SORTNUM  EQU   PARM+84                                                  03490000
ERRID    EQU   PARM+92                                                  03491000
IDTIMEA  EQU   ERRID+6                                                  03492000
IDTIME   EQU   IDTIMEA                                                  03493000
CCHHRLNG EQU   PARM+112                                                 03494000
RECCCHHR EQU   CCHHRLNG                                                 03495000
RECLNGTH EQU   CCHHRLNG+6                                               03496000
LINECT   EQU   PARM+120                                                 03497000
ADIOHND  EQU   PARM+124                                                 03498000
ADIFCMSG EQU   PARM+128                                                 03499000
ADEDITB  EQU   PARM+132                                                 03500000
EVPTR    EQU   PARM+136                                                 03501000
SORTADR  EQU   PARM+140                                                 03502000
PRINTADR EQU   PARM+148                                                 03503000
CUAPTR   EQU   PARM+152                                                 03504000
DEVPTR   EQU   PARM+156                                                 03505000
MODPTR   EQU   PARM+160                                                 03506000
SERPTR   EQU   PARM+164                                                 03507000
VOLPTR   EQU   PARM+168                                                 03508000
CPUPTR   EQU   PARM+172                                                 03509000
CPCUAPTR EQU   PARM+176                                                 03510000
LIBADPTR EQU   PARM+180                                                 03511000
SYMCDPTR EQU   PARM+184                                                 03512000
SYSUMPTR EQU   PARM+188                                                 03513000
TRENPTR  EQU   PARM+192                                                 03514000
SHAREPTR EQU   PARM+196                                                 03515000
MERDCPTR EQU   PARM+208                                                 03516000
DUMPTABL EQU   PARM+228                                                 03517000
DUMPINFO EQU   DUMPTABL+4                                               03518000
TRENDONE EQU   0                                                        03519000
TREGEN   EQU   TRENDONE+8                                               03520000
TRECCH0  EQU   TREGEN+8                                                 03521000
TREND2   EQU   0                                                        03522000
TRENDKEY EQU   TREND2                                                   03523000
TRENDRT  EQU   TRENDKEY+1                                               03524000
TRENCPUS EQU   TRENDKEY+3                                               03525000
TRENDITM EQU   TRENDKEY+4                                               03526000
EVTABLE  EQU   0                                                        03527000
EVSTOP   EQU   EVTABLE                                                  03528000
EVYEAR   EQU   EVSTOP                                                   03529000
EVDAY    EQU   EVSTOP+1                                                 03530000
EVNUM    EQU   EVTABLE+4                                                03531000
EVKEY    EQU   EVTABLE+6                                                03532000
EVMODEL  EQU   EVKEY                                                    03533000
EVSERIAL EQU   EVKEY+2                                                  03534000
EVLETTER EQU   EVKEY+5                                                  03535000
SORTABLE EQU   0                                                        03536000
SORTKEY  EQU   SORTABLE                                                 03537000
SORTCCHR EQU   SORTABLE+5                                               03538000
SYSUMONE EQU   0                                                        03539000
SYSUM2   EQU   0                                                        03540000
SYSUMKEY EQU   SYSUM2                                                   03541000
SYSRT    EQU   SYSUMKEY+1                                               03542000
SYSCPUS  EQU   SYSUMKEY+3                                               03543000
SYSITEM  EQU   SYSUMKEY+4                                               03544000
SHARE    EQU   0                                                        03545000
SHAREIO  EQU   SHARE+2                                                  03546000
SHRBASE  EQU   SHAREIO+1                                                03547000
SHRCUCPU EQU   SHAREIO+8                                                03548000
EDITLOAD EQU   0                                                        03549000
EDITABLE EQU   EDITLOAD+4                                               03550000
CUA      EQU   0                                                        03551000
CUAVAL   EQU   CUA+2                                                    03552000
DEVICE   EQU   0                                                        03553000
MODELS   EQU   0                                                        03554000
DEVSERAL EQU   0                                                        03555000
VOLUME   EQU   0                                                        03556000
CPUS     EQU   0                                                        03557000
CPUCUAS  EQU   0                                                        03558000
CPUCUAV  EQU   CPUCUAS+2                                                03559000
LIBADR   EQU   0                                                        03560000
SYMCODE  EQU   0                                                        03561000
SYMVAL   EQU   SYMCODE+2                                                03562000
MERIDIAN EQU   0                                                        03563000
LRTREC   EQU   0                                                        03564000
LRTKEY   EQU   LRTREC                                                   03565000
LRTKEY1  EQU   LRTKEY                                                   03566000
LRTSMS   EQU   LRTREC+2                                                 03567000
LRTERRID EQU   LRTREC+3                                                 03568000
@NM00016 EQU   LRTREC+4                                                 03569000
LRTDT    EQU   LRTREC+8                                                 03570000
LRTDATE  EQU   LRTDT                                                    03571000
LRTYRDAY EQU   LRTDATE+1                                                03572000
LRTYEAR  EQU   LRTYRDAY                                                 03573000
LRTDAY   EQU   LRTYRDAY+1                                               03574000
LRTTIME  EQU   LRTDT+4                                                  03575000
LRTCPU   EQU   LRTREC+16                                                03576000
LRTCPMOD EQU   LRTCPU+1                                                 03577000
LRTCPUS  EQU   LRTCPMOD                                                 03578000
LRTMODEL EQU   LRTCPMOD+3                                               03579000
MCHREC   EQU   0                                                        03580000
MCHHEAD  EQU   MCHREC                                                   03581000
MCHKEY   EQU   MCHHEAD                                                  03582000
MCHSMS   EQU   MCHHEAD+2                                                03583000
MCHSYSTR EQU   MCHSMS+1                                                 03584000
MCHCPUID EQU   MCHHEAD+16                                               03585000
MCHMOD   EQU   MCHCPUID+4                                               03586000
MCHJOBID EQU   MCHREC+32                                                03587000
MCHOPSW  EQU   MCHREC+40                                                03588000
CCHREC   EQU   0                                                        03589000
CCHHEAD  EQU   CCHREC                                                   03590000
CCHKEY   EQU   CCHHEAD                                                  03591000
CCHSMS   EQU   CCHHEAD+2                                                03592000
CCHRCRH  EQU   CCHSMS                                                   03593000
CCHRINC  EQU   CCHSMS+1                                                 03594000
CCHCPUID EQU   CCHHEAD+16                                               03595000
CCHMOD   EQU   CCHCPUID+4                                               03596000
CCHJOBID EQU   CCHREC+24                                                03597000
CCHCSW   EQU   CCHREC+56                                                03598000
CCHCODE  EQU   CCHREC+68                                                03599000
CCHCODE2 EQU   CCHCODE+2                                                03600000
CCHCUA   EQU   CCHREC+74                                                03601000
CCHMP    EQU   CCHREC+76                                                03602000
CCHLOG   EQU   CCHREC+80                                                03603000
OBRREC   EQU   0                                                        03604000
OBRHEAD  EQU   OBRREC                                                   03605000
OBRKEY   EQU   OBRHEAD                                                  03606000
OBRSMS   EQU   OBRHEAD+2                                                03607000
MISCSW   EQU   OBRSMS                                                   03608000
OBRSUBTP EQU   OBRSMS+1                                                 03609000
SDRCOUNT EQU   OBRSUBTP                                                 03610000
OBRTEMP  EQU   OBRSUBTP                                                 03611000
SHORTSW  EQU   OBRSUBTP                                                 03612000
DISMOUNT EQU   OBRSUBTP                                                 03613000
OBRCPUID EQU   OBRHEAD+16                                               03614000
OBRJOBID EQU   OBRREC+24                                                03615000
OBRSDEV2 EQU   OBRJOBID+2                                               03616000
OBRSCUA  EQU   OBRJOBID+5                                               03617000
OBRFCCW  EQU   OBRREC+32                                                03618000
OBRSRDS  EQU   OBRFCCW                                                  03619000
OBRCSW   EQU   OBRREC+40                                                03620000
OBRSTAT  EQU   OBRCSW+4                                                 03621000
OBRDEVDC EQU   OBRREC+48                                                03622000
OBRSECUA EQU   OBRREC+49                                                03623000
OBRCODE  EQU   OBRREC+52                                                03624000
OBRDEV   EQU   OBRCODE+2                                                03625000
OBRCLASS EQU   OBRDEV                                                   03626000
OBRLSDRC EQU   OBRREC+56                                                03627000
OBRPCUA  EQU   OBRREC+57                                                03628000
OBRSBCNT EQU   OBRREC+62                                                03629000
OBRVOL   EQU   OBRREC+64                                                03630000
OBRSEEK  EQU   OBRREC+70                                                03631000
OBRTCAM  EQU   OBRSEEK                                                  03632000
OBRTERMN EQU   OBRSEEK+2                                                03633000
SFTREC   EQU   0                                                        03634000
SFTHEAD  EQU   SFTREC                                                   03635000
SFTKEY   EQU   SFTHEAD                                                  03636000
SFTKEY1  EQU   SFTKEY                                                   03637000
SFTCPUID EQU   SFTHEAD+16                                               03638000
SFTJOBID EQU   SFTREC+24                                                03639000
SFTSDWA  EQU   SFTREC+32                                                03640000
SFTABNDC EQU   SFTSDWA                                                  03641000
SFTAEC1  EQU   SFTSDWA+96                                               03642000
SFTPROGC EQU   SFTAEC1+8                                                03643000
SFTFLGS  EQU   SFTSDWA+232                                              03644000
SFTRECP  EQU   SFTSDWA+292                                              03645000
SFTMODN  EQU   SFTRECP                                                  03646000
SFTCSECT EQU   SFTRECP+8                                                03647000
SFTREXN  EQU   SFTRECP+16                                               03648000
IPLREC   EQU   0                                                        03649000
IPLHEAD  EQU   IPLREC                                                   03650000
IPLKEY   EQU   IPLHEAD                                                  03651000
IPLCPUID EQU   IPLHEAD+16                                               03652000
IPLSYSID EQU   IPLREC+24                                                03653000
IPLREAS  EQU   IPLREC+28                                                03654000
IPLSTIME EQU   IPLREC+52                                                03655000
DDRREC   EQU   0                                                        03656000
DDRHEAD  EQU   DDRREC                                                   03657000
DDRKEY   EQU   DDRHEAD                                                  03658000
DDRSMS   EQU   DDRHEAD+2                                                03659000
DDRDEPSW EQU   DDRSMS+1                                                 03660000
DDRCPUID EQU   DDRHEAD+16                                               03661000
@NM00051 EQU   DDRREC+24                                                03662000
DDRJOBID EQU   @NM00051                                                 03663000
DDRVOL1  EQU   @NM00051+8                                               03664000
DDRVOL2  EQU   @NM00051+14                                              03665000
DDRFCUA  EQU   DDRREC+45                                                03666000
DDRFDEV  EQU   DDRREC+48                                                03667000
DDRCODE2 EQU   DDRFDEV+2                                                03668000
DDRTOCUA EQU   DDRREC+53                                                03669000
DDRTODEV EQU   DDRREC+56                                                03670000
DDRDEV2  EQU   DDRTODEV+2                                               03671000
MIHREC   EQU   0                                                        03672000
MIHHEAD  EQU   MIHREC                                                   03673000
MIHKEY   EQU   MIHHEAD                                                  03674000
@NM00053 EQU   MIHHEAD+4                                                03675000
MIHCEBIT EQU   @NM00053                                                 03676000
MIHDEBIT EQU   @NM00053                                                 03677000
MIHCSID  EQU   MIHHEAD+5                                                03678000
MIHCPUID EQU   MIHHEAD+16                                               03679000
MIHMOD   EQU   MIHCPUID+4                                               03680000
@NM00056 EQU   MIHREC+24                                                03681000
MIHJOBID EQU   @NM00056                                                 03682000
MIHCUA   EQU   MIHREC+35                                                03683000
MIHVOL   EQU   MIHREC+38                                                03684000
MIHDEV   EQU   MIHREC+44                                                03685000
MIHCODE2 EQU   MIHDEV+2                                                 03686000
EODREC   EQU   0                                                        03687000
EODHEAD  EQU   EODREC                                                   03688000
EODKEY   EQU   EODHEAD                                                  03689000
EODCPUID EQU   EODHEAD+16                                               03690000
TPRREC   EQU   0                                                        03691000
TPRHEAD  EQU   TPRREC                                                   03692000
TPRKEY   EQU   TPRHEAD                                                  03693000
TPRDEV   EQU   TPRHEAD+4                                                03694000
TPRBUFC  EQU   TPRHEAD+5                                                03695000
TPRCPUID EQU   TPRHEAD+16                                               03696000
TPRCUA   EQU   TPRREC+24                                                03697000
@NM00064 EQU   TPRREC+26                                                03698000
TPRVOL   EQU   @NM00064                                                 03699000
MCFREC   EQU   0                                                        03700000
MCFHEAD  EQU   MCFREC                                                   03701000
MCFKEY   EQU   MCFHEAD                                                  03702000
MCFSMS   EQU   MCFHEAD+2                                                03703000
@NM00072 EQU   MCFHEAD+16                                               03704000
MCFSMO   EQU   MCFHEAD+17                                               03705000
CCFREC   EQU   0                                                        03706000
CCFHEAD  EQU   CCFREC                                                   03707000
CCFKEY   EQU   CCFHEAD                                                  03708000
CCFSMS   EQU   CCFHEAD+2                                                03709000
@NM00080 EQU   CCFHEAD+16                                               03710000
CCFSMO   EQU   CCFHEAD+17                                               03711000
RERR     EQU   0                                                        03712000
OBRSENSE EQU   0                                                        03713000
OBRSEN1  EQU   OBRSENSE+1                                               03714000
NEXTBYTE EQU   0                                                        03715000
ADDNUM   EQU   0                                                        03716000
@NM00133 EQU   0                                                        03717000
CCHNOCS  EQU   @NM00133+6                                               03718000
CCHMPIF  EQU   @NM00133+8                                               03719000
CCHCSAD  EQU   CCHMPIF                                                  03720000
LAST     EQU   0                                                        03721000
@NM00083 EQU   OBRCODE                                                  03722000
OBRCODE2 EQU   @NM00083+1                                               03723000
NEWMDR   EQU   TIME1                                                    03724000
LINE002  EQU   TIME1                                                    03725000
TOPTEMP  EQU   TIME1+53                                                 03726000
DUPLICAT EQU   TIME1                                                    03727000
CCHFINSH EQU   CUA12                                                    03728000
OBRFINSH EQU   CUA12                                                    03729000
SFTFINSH EQU   CUA12                                                    03730000
IPLFINSH EQU   CUA12                                                    03731000
HEAD01   EQU   TIME1                                                    03732000
TODAYDT  EQU   CUA11                                                    03733000
TERMNAME EQU   VOLUME1                                                  03734000
DEVTYPE1 EQU   DEVICE1                                                  03735000
DAYSDATE EQU   TIME1+44                                                 03736000
HEDDATE  EQU   CUA11                                                    03737000
TOTALNM1 EQU   TIME1                                                    03738000
PRTLINE1 EQU   TIME1                                                    03739000
SSYS     EQU   PRTLINE1+37                                              03740000
REASON   EQU   PRTLINE1+46                                              03741000
PSWMCH   EQU   PRTLINE1+53                                              03742000
RCYRYXIT EQU   PRTLINE1+72                                              03743000
COMPMOD  EQU   PRTLINE1+82                                              03744000
CSECTID  EQU   PRTLINE1+92                                              03745000
ERRORID1 EQU   PRTLINE1+102                                             03746000
LINE0006 EQU   TIME1+32                                                 03747000
BADREC   EQU   TIME1                                                    03748000
NUMFAIL  EQU   TIME1+8                                                  03749000
LINE44   EQU   CUA12                                                    03750000
ERRORNA  EQU   ERRORID1                                                 03751000
TOTALHD2 EQU   TIME1                                                    03752000
WORKOVER EQU   WORK                                                     03753000
HEADTOTL EQU   TIME1                                                    03754000
RECNAME  EQU   HEADTOTL                                                 03755000
TOTALVAL EQU   HEADTOTL+26                                              03756000
NMETOTAL EQU   MCH                                                      03757000
TOTALNME EQU   RECNAME+4                                                03758000
COUNT    EQU   MCHCT                                                    03759000
CPULINE1 EQU   TIME1                                                    03760000
MVCOVER  EQU   TIME1                                                    03761000
NEWDATEO EQU   TIME1                                                    03762000
MDROBRLN EQU   TIME1+71                                                 03763000
@NM00131 EQU   CCHMP                                                    03764000
CCHLOGLN EQU   @NM00131+2                                               03765000
PSWMCH1  EQU   PSWMCH                                                   03766000
LINEFRM1 EQU   CUA12                                                    03767000
BADCOUNT EQU   TIME1                                                    03768000
DDRFINSH EQU   CUA12                                                    03769000
HEAD1    EQU   LINE01                                                   03770000
LINE004  EQU   CUA12                                                    03771000
LINE006  EQU   TIME1+54                                                 03772000
LOSTSOFT EQU   SENSEA1                                                  03773000
ODDMOVE  EQU   TIME1                                                    03774000
RECCOUNT EQU   MCHCT                                                    03775000
TOTALHD4 EQU   TOTALVAL                                                 03776000
TRECCH   EQU   TRECCH0                                                  03777000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    03778000
@NM00132 EQU   @NM00131                                                 03779000
@NM00125 EQU   HEADTOTL+36                                              03780000
CPUA1    EQU   HEADTOTL+32                                              03781000
FORTOTAL EQU   TOTALVAL+1                                               03782000
@NM00124 EQU   TOTALVAL                                                 03783000
@NM00123 EQU   HEADTOTL+22                                              03784000
RTYPE    EQU   RECNAME                                                  03785000
@NM00121 EQU   PRTLINE1+100                                             03786000
@NM00120 EQU   PRTLINE1+90                                              03787000
@NM00119 EQU   PRTLINE1+80                                              03788000
@NM00118 EQU   PRTLINE1+70                                              03789000
PROGEC   EQU   PRTLINE1+62                                              03790000
@NM00117 EQU   PRTLINE1+61                                              03791000
@NM00116 EQU   PRTLINE1+52                                              03792000
@NM00115 EQU   PRTLINE1+41                                              03793000
@NM00114 EQU   PRTLINE1+30                                              03794000
RECTYP2  EQU   PRTLINE1+23                                              03795000
@NM00113 EQU   PRTLINE1+22                                              03796000
JOBNAME2 EQU   PRTLINE1+14                                              03797000
@NM00112 EQU   PRTLINE1+13                                              03798000
TIME2    EQU   PRTLINE1+2                                               03799000
@NM00111 EQU   PRTLINE1                                                 03800000
YR       EQU   DAYSDATE+4                                               03801000
@NM00108 EQU   DAYSDATE+3                                               03802000
DAY      EQU   DAYSDATE                                                 03803000
@NM00084 EQU   @NM00083                                                 03804000
@NM00135 EQU   CCHMPIF+2                                                03805000
@NM00134 EQU   @NM00133+2                                               03806000
CCHFOOTS EQU   @NM00133                                                 03807000
OBRSEN0  EQU   OBRSENSE                                                 03808000
CCFFRAME EQU   CCFREC+24                                                03809000
@NM00082 EQU   CCFHEAD+22                                               03810000
CCFMOD   EQU   CCFSMO+3                                                 03811000
CCFSER   EQU   CCFSMO                                                   03812000
CCFVER   EQU   @NM00080                                                 03813000
@NM00081 EQU   @NM00080                                                 03814000
CCFTIMD  EQU   CCFHEAD+12                                               03815000
CCFDAT   EQU   CCFHEAD+8                                                03816000
@NM00079 EQU   CCFHEAD+7                                                03817000
CCFCNT   EQU   CCFHEAD+6                                                03818000
@NM00078 EQU   CCFHEAD+4                                                03819000
@NM00077 EQU   CCFSMS+1                                                 03820000
CCFCPU   EQU   CCFSMS+1                                                 03821000
CCFMP    EQU   CCFSMS+1                                                 03822000
@NM00076 EQU   CCFSMS                                                   03823000
CCFTIM   EQU   CCFSMS                                                   03824000
@NM00075 EQU   CCFSMS                                                   03825000
CCFTRU   EQU   CCFSMS                                                   03826000
CCFTOD   EQU   CCFSMS                                                   03827000
CCFLST   EQU   CCFSMS                                                   03828000
CCFKEY2  EQU   CCFKEY+1                                                 03829000
CCFKEY1  EQU   CCFKEY                                                   03830000
MCFFRAME EQU   MCFREC+24                                                03831000
@NM00074 EQU   MCFHEAD+22                                               03832000
MCFMOD   EQU   MCFSMO+3                                                 03833000
MCFSER   EQU   MCFSMO                                                   03834000
MCFVER   EQU   @NM00072                                                 03835000
@NM00073 EQU   @NM00072                                                 03836000
MCFTIMD  EQU   MCFHEAD+12                                               03837000
MCFDAT   EQU   MCFHEAD+8                                                03838000
@NM00071 EQU   MCFHEAD+7                                                03839000
MCFCNT   EQU   MCFHEAD+6                                                03840000
@NM00070 EQU   MCFHEAD+4                                                03841000
@NM00069 EQU   MCFSMS+1                                                 03842000
MCFCPU   EQU   MCFSMS+1                                                 03843000
MCFMP    EQU   MCFSMS+1                                                 03844000
@NM00068 EQU   MCFSMS                                                   03845000
MCFTIM   EQU   MCFSMS                                                   03846000
@NM00067 EQU   MCFSMS                                                   03847000
MCFTRU   EQU   MCFSMS                                                   03848000
MCFTOD   EQU   MCFSMS                                                   03849000
MCFLST   EQU   MCFSMS                                                   03850000
MCFKEY2  EQU   MCFKEY+1                                                 03851000
MCFKEY1  EQU   MCFKEY                                                   03852000
RMSSCBRY EQU   TPRREC+58                                                03853000
DVBSDRE  EQU   TPRREC+56                                                03854000
@NM00066 EQU   TPRREC+39                                                03855000
TPRMODE  EQU   TPRREC+38                                                03856000
TPRLINAD EQU   TPRREC+36                                                03857000
@NM00065 EQU   TPRREC+34                                                03858000
TPRCEL   EQU   TPRCPUID+6                                               03859000
TPRMODEL EQU   TPRCPUID+4                                               03860000
TPRSER   EQU   TPRCPUID+1                                               03861000
@NM00063 EQU   TPRCPUID                                                 03862000
TPRTIME  EQU   TPRHEAD+12                                               03863000
TPRDATE  EQU   TPRHEAD+8                                                03864000
@NM00062 EQU   TPRHEAD+6                                                03865000
TPRLENGT EQU   TPRBUFC                                                  03866000
@NM00061 EQU   TPRBUFC                                                  03867000
TPRSMS   EQU   TPRHEAD+2                                                03868000
TPRKEY2  EQU   TPRKEY+1                                                 03869000
TPRKEY1  EQU   TPRKEY                                                   03870000
EODCEL   EQU   EODCPUID+6                                               03871000
EODMODEL EQU   EODCPUID+4                                               03872000
EODSER   EQU   EODCPUID+1                                               03873000
@NM00060 EQU   EODCPUID                                                 03874000
EODTIME  EQU   EODHEAD+12                                               03875000
EODDATE  EQU   EODHEAD+8                                                03876000
@NM00059 EQU   EODHEAD+5                                                03877000
EODDEV   EQU   EODHEAD+4                                                03878000
EODSMS   EQU   EODHEAD+2                                                03879000
EODKEY2  EQU   EODKEY+1                                                 03880000
EODKEY1  EQU   EODKEY                                                   03881000
MIHTYPE  EQU   MIHCODE2+1                                               03882000
MIHCLASS EQU   MIHCODE2                                                 03883000
@NM00058 EQU   MIHDEV                                                   03884000
@NM00057 EQU   @NM00056+8                                               03885000
MIHCEL   EQU   MIHCPUID+6                                               03886000
MIHSER   EQU   MIHCPUID+1                                               03887000
@NM00055 EQU   MIHCPUID                                                 03888000
MIHTIME  EQU   MIHHEAD+12                                               03889000
MIHDATE  EQU   MIHHEAD+8                                                03890000
@NM00054 EQU   MIHHEAD+6                                                03891000
MIHSMS   EQU   MIHHEAD+2                                                03892000
MIHKEY2  EQU   MIHKEY+1                                                 03893000
MIHKEY1  EQU   MIHKEY                                                   03894000
DDRDEV1  EQU   DDRTODEV                                                 03895000
@NM00052 EQU   DDRREC+52                                                03896000
DDRTYPE  EQU   DDRCODE2+1                                               03897000
DDRCLASS EQU   DDRCODE2                                                 03898000
DDRCODE1 EQU   DDRFDEV                                                  03899000
DDRPHD   EQU   @NM00051+20                                              03900000
DDRCEL   EQU   DDRCPUID+6                                               03901000
DDRMOD   EQU   DDRCPUID+4                                               03902000
DDRSER   EQU   DDRCPUID+1                                               03903000
@NM00050 EQU   DDRCPUID                                                 03904000
DDRTIME  EQU   DDRHEAD+12                                               03905000
DDRDATE  EQU   DDRHEAD+8                                                03906000
@NM00049 EQU   DDRHEAD+4                                                03907000
@NM00048 EQU   DDRSMS                                                   03908000
DDRKEY2  EQU   DDRKEY+1                                                 03909000
DDRKEY1  EQU   DDRKEY                                                   03910000
IPLSHSEC EQU   IPLSTIME+3                                               03911000
IPLSSEC  EQU   IPLSTIME+2                                               03912000
IPLSMIN  EQU   IPLSTIME+1                                               03913000
IPLSHOUR EQU   IPLSTIME                                                 03914000
IPLSDATE EQU   IPLREC+48                                                03915000
IPLTEMP  EQU   IPLREC+46                                                03916000
IPLHIGH  EQU   IPLREC+42                                                03917000
IPLCHAN  EQU   IPLREC+32                                                03918000
@NM00047 EQU   IPLREC+30                                                03919000
@NM00046 EQU   IPLREC+25                                                03920000
IPLCEL   EQU   IPLCPUID+6                                               03921000
IPLMOD   EQU   IPLCPUID+4                                               03922000
IPLSER   EQU   IPLCPUID+1                                               03923000
@NM00045 EQU   IPLCPUID                                                 03924000
IPLTIME  EQU   IPLHEAD+12                                               03925000
IPLDATE  EQU   IPLHEAD+8                                                03926000
@NM00044 EQU   IPLHEAD+4                                                03927000
IPLSMS   EQU   IPLHEAD+2                                                03928000
IPLKEY2  EQU   IPLKEY+1                                                 03929000
IPLKEY1  EQU   IPLKEY                                                   03930000
SFTXDATA EQU   SFTREC+434                                               03931000
SFTLVARA EQU   SFTREC+432                                               03932000
@NM00043 EQU   SFTSDWA+238                                              03933000
SFTLCPUA EQU   SFTSDWA+236                                              03934000
SFTERRD  EQU   SFTFLGS+3                                                03935000
SFTERRC  EQU   SFTFLGS+2                                                03936000
SFTERRB  EQU   SFTFLGS+1                                                03937000
SFTERRA  EQU   SFTFLGS                                                  03938000
@NM00042 EQU   SFTSDWA+136                                              03939000
SFTAAEC1 EQU   SFTSDWA+120                                              03940000
@NM00041 EQU   SFTSDWA+112                                              03941000
@NM00040 EQU   SFTAEC1                                                  03942000
@NM00039 EQU   SFTSDWA+88                                               03943000
SFTGRSV  EQU   SFTSDWA+24                                               03944000
SFTCEL   EQU   SFTCPUID+6                                               03945000
SFTMOD   EQU   SFTCPUID+4                                               03946000
SFTSER   EQU   SFTCPUID+1                                               03947000
@NM00038 EQU   SFTCPUID                                                 03948000
SFTTIME  EQU   SFTHEAD+12                                               03949000
SFTDATE  EQU   SFTHEAD+8                                                03950000
@NM00037 EQU   SFTHEAD+4                                                03951000
SFTSMS   EQU   SFTHEAD+2                                                03952000
SFTKEY2  EQU   SFTKEY+1                                                 03953000
OBR34CT2 EQU   OBRTERMN+5                                               03954000
OBR34CT1 EQU   OBRTERMN+4                                               03955000
@NM00036 EQU   OBRTERMN                                                 03956000
@NM00035 EQU   OBRSEEK+1                                                03957000
OBRRETRY EQU   OBRREC+60                                                03958000
OBRTYPE  EQU   OBRDEV+1                                                 03959000
OBRCODE1 EQU   OBRCODE                                                  03960000
@NM00034 EQU   OBRCSW                                                   03961000
OBRSDRS2 EQU   OBRSRDS                                                  03962000
OBRSDRS1 EQU   OBRSRDS                                                  03963000
OBRSSDRC EQU   OBRJOBID+4                                               03964000
OBRSDEV1 EQU   OBRJOBID                                                 03965000
OBRCEL   EQU   OBRCPUID+6                                               03966000
OBRMOD   EQU   OBRCPUID+4                                               03967000
OBRSER   EQU   OBRCPUID+1                                               03968000
@NM00033 EQU   OBRCPUID                                                 03969000
OBRTIME  EQU   OBRHEAD+12                                               03970000
OBRDATE  EQU   OBRHEAD+8                                                03971000
@NM00032 EQU   OBRHEAD+4                                                03972000
@NM00031 EQU   OBRSUBTP                                                 03973000
@NM00030 EQU   OBRSUBTP                                                 03974000
@NM00029 EQU   MISCSW                                                   03975000
TRUNC    EQU   MISCSW                                                   03976000
@NM00028 EQU   MISCSW                                                   03977000
OBRKEY2  EQU   OBRKEY+1                                                 03978000
OBRKEY1  EQU   OBRKEY                                                   03979000
@NM00027 EQU   CCHREC+73                                                03980000
CCHID    EQU   CCHREC+72                                                03981000
CCHTYPE  EQU   CCHCODE2+1                                               03982000
CCHCLASS EQU   CCHCODE2                                                 03983000
CCHCODE1 EQU   CCHCODE                                                  03984000
CCHECSW  EQU   CCHREC+64                                                03985000
CCHFCCW  EQU   CCHREC+48                                                03986000
CCHATIO  EQU   CCHREC+32                                                03987000
CCHCEL   EQU   CCHCPUID+6                                               03988000
CCHSER   EQU   CCHCPUID+1                                               03989000
@NM00026 EQU   CCHCPUID                                                 03990000
CCHTIME  EQU   CCHHEAD+12                                               03991000
CCHDATE  EQU   CCHHEAD+8                                                03992000
@NM00025 EQU   CCHHEAD+4                                                03993000
@NM00024 EQU   CCHSMS                                                   03994000
@NM00023 EQU   CCHSMS                                                   03995000
CCHKEY2  EQU   CCHKEY+1                                                 03996000
CCHKEY1  EQU   CCHKEY                                                   03997000
MCHLOG   EQU   MCHREC+48                                                03998000
MCHPGMID EQU   MCHREC+24                                                03999000
MCHCEL   EQU   MCHCPUID+6                                               04000000
MCHSER   EQU   MCHCPUID+1                                               04001000
@NM00022 EQU   MCHCPUID                                                 04002000
MCHTIME  EQU   MCHHEAD+12                                               04003000
MCHDATE  EQU   MCHHEAD+8                                                04004000
@NM00021 EQU   MCHHEAD+4                                                04005000
@NM00020 EQU   MCHSMS                                                   04006000
MCHKEY2  EQU   MCHKEY+1                                                 04007000
MCHKEY1  EQU   MCHKEY                                                   04008000
LRTMCEL  EQU   LRTCPU+6                                                 04009000
@NM00019 EQU   LRTCPU                                                   04010000
LRTHSECS EQU   LRTTIME+3                                                04011000
LRTSEC   EQU   LRTTIME+2                                                04012000
LRTMIN   EQU   LRTTIME+1                                                04013000
LRTHOUR  EQU   LRTTIME                                                  04014000
LRTDATE0 EQU   LRTDATE                                                  04015000
@NM00018 EQU   @NM00016+3                                               04016000
LRTCNT   EQU   @NM00016+2                                               04017000
@NM00017 EQU   @NM00016                                                 04018000
LRTDSMNT EQU   LRTERRID                                                 04019000
@NM00015 EQU   LRTERRID                                                 04020000
LRTSHRT  EQU   LRTERRID                                                 04021000
@NM00014 EQU   LRTERRID                                                 04022000
@NM00013 EQU   LRTSMS                                                   04023000
LRTIMCNV EQU   LRTSMS                                                   04024000
@NM00012 EQU   LRTSMS                                                   04025000
LRTRUNC  EQU   LRTSMS                                                   04026000
LRNS     EQU   LRTSMS                                                   04027000
LRTNLAST EQU   LRTSMS                                                   04028000
LRTKEY2  EQU   LRTKEY+1                                                 04029000
MODEL    EQU   MERIDIAN+2                                               04030000
MRDNUMBR EQU   MERIDIAN                                                 04031000
SYMVAL2  EQU   SYMVAL+2                                                 04032000
SYMVAL1  EQU   SYMVAL                                                   04033000
SYMCDNUM EQU   SYMCODE                                                  04034000
LIBVAL   EQU   LIBADR+2                                                 04035000
LIBADNUM EQU   LIBADR                                                   04036000
CPUCUX3  EQU   CPUCUAV+5                                                04037000
CPUCUX2  EQU   CPUCUAV+3                                                04038000
CPUCUX1  EQU   CPUCUAV                                                  04039000
CPCUANUM EQU   CPUCUAS                                                  04040000
CPUVAL   EQU   CPUS+2                                                   04041000
CPUNUM   EQU   CPUS                                                     04042000
VOLVAL   EQU   VOLUME+2                                                 04043000
VOLNUM   EQU   VOLUME                                                   04044000
SERVAL   EQU   DEVSERAL+2                                               04045000
SERNUM   EQU   DEVSERAL                                                 04046000
MODVAL   EQU   MODELS+2                                                 04047000
MODNUM   EQU   MODELS                                                   04048000
MDRVAL   EQU   DEVICE+204                                               04049000
MDRNUM   EQU   DEVICE+202                                               04050000
DEVVAL   EQU   DEVICE+2                                                 04051000
DEVNUM   EQU   DEVICE                                                   04052000
CUA2     EQU   CUAVAL+2                                                 04053000
CUA1     EQU   CUAVAL                                                   04054000
CUANUM   EQU   CUA                                                      04055000
LOADPTR  EQU   EDITABLE+8                                               04056000
LOADNAME EQU   EDITABLE                                                 04057000
EDITNUM  EQU   EDITLOAD                                                 04058000
SHARLET  EQU   SHAREIO+15                                               04059000
SHRCUAAH EQU   SHRCUCPU+5                                               04060000
SHRCUAAL EQU   SHRCUCPU+3                                               04061000
SHARSERA EQU   SHRCUCPU                                                 04062000
SHRCUABH EQU   SHRBASE+5                                                04063000
SHRCUABL EQU   SHRBASE+3                                                04064000
SHARSERB EQU   SHRBASE                                                  04065000
SHAREFLG EQU   SHAREIO                                                  04066000
SHARENUM EQU   SHARE                                                    04067000
SYSTEMP  EQU   SYSUM2+10                                                04068000
SYSPERM  EQU   SYSUM2+8                                                 04069000
SYSRANGE EQU   SYSUM2+7                                                 04070000
SYSDEV   EQU   SYSUM2+5                                                 04071000
SYSOLDA  EQU   SYSITEM                                                  04072000
SYS3705  EQU   SYSITEM                                                  04073000
SYSOLD   EQU   SYSCPUS                                                  04074000
SYSCPU   EQU   SYSCPUS                                                  04075000
SYSTROLL EQU   SYSRT+1                                                  04076000
SYSSPAN  EQU   SYSRT+1                                                  04077000
SYSCUA   EQU   SYSRT                                                    04078000
SYSGROUP EQU   SYSUMKEY                                                 04079000
SYSUMEOD EQU   SYSUMONE+96                                              04080000
SYSUMPER EQU   SYSUMONE+92                                              04081000
SYSUMPEA EQU   SYSUMONE+88                                              04082000
SYSUMPEI EQU   SYSUMONE+84                                              04083000
SYSUMCH  EQU   SYSUMONE+20                                              04084000
SYSUMMCN EQU   SYSUMONE+16                                              04085000
SYSUMMCR EQU   SYSUMONE+12                                              04086000
SYSUMNXT EQU   SYSUMONE+8                                               04087000
SYSUMIPL EQU   SYSUMONE+4                                               04088000
SYSUMNUM EQU   SYSUMONE                                                 04089000
SORTCORE EQU   SORTCCHR                                                 04090000
SORTTIME EQU   SORTKEY+1                                                04091000
SORTYEAR EQU   SORTKEY                                                  04092000
TRETMP   EQU   TREND2+10                                                04093000
TREPRM   EQU   TREND2+8                                                 04094000
TRENDDEV EQU   TREND2+6                                                 04095000
TRENDDAT EQU   TRENDKEY+5                                               04096000
TRENDOD  EQU   TRENDITM                                                 04097000
TREND037 EQU   TRENDITM                                                 04098000
TRENDOLD EQU   TRENCPUS                                                 04099000
TRENDCPU EQU   TRENCPUS                                                 04100000
@NM00011 EQU   TRENDRT+1                                                04101000
TRENDCUA EQU   TRENDRT                                                  04102000
TRENDGRP EQU   TRENDKEY                                                 04103000
TREPRE   EQU   TREGEN+72                                                04104000
TRECCHF  EQU   TREGEN+68                                                04105000
TRECCHE  EQU   TREGEN+64                                                04106000
TRECCHD  EQU   TREGEN+60                                                04107000
TRECCHC  EQU   TREGEN+56                                                04108000
TRECCHB  EQU   TREGEN+52                                                04109000
TRECCHA  EQU   TREGEN+48                                                04110000
TRECCH9  EQU   TREGEN+44                                                04111000
TRECCH8  EQU   TREGEN+40                                                04112000
TRECCH7  EQU   TREGEN+36                                                04113000
TRECCH6  EQU   TREGEN+32                                                04114000
TRECCH5  EQU   TREGEN+28                                                04115000
TRECCH4  EQU   TREGEN+24                                                04116000
TRECCH3  EQU   TREGEN+20                                                04117000
TRECCH2  EQU   TREGEN+16                                                04118000
TRECCH1  EQU   TREGEN+12                                                04119000
TREMCH   EQU   TREGEN+4                                                 04120000
TREIPL   EQU   TREGEN                                                   04121000
TRENUM   EQU   TRENDONE+4                                               04122000
TRENEXT  EQU   TRENDONE                                                 04123000
DUMPSIZE EQU   DUMPINFO+4                                               04124000
DUMPADR  EQU   DUMPINFO                                                 04125000
DUMPNUM  EQU   DUMPTABL                                                 04126000
@NM00010 EQU   PARM+212                                                 04127000
RECLNGT1 EQU   PARM+204                                                 04128000
FRAMEPTR EQU   PARM+200                                                 04129000
ADCPUT   EQU   PARM+144                                                 04130000
@NM00009 EQU   CCHHRLNG+5                                               04131000
USERPGM  EQU   PARM+102                                                 04132000
IDTSEC   EQU   IDTIME+3                                                 04133000
IDSEC    EQU   IDTIME+2                                                 04134000
IDMIN    EQU   IDTIME+1                                                 04135000
IDHOUR   EQU   IDTIME                                                   04136000
IDASID   EQU   ERRID+4                                                  04137000
IDCPU    EQU   ERRID+3                                                  04138000
@NM00008 EQU   ERRID+2                                                  04139000
IDVALUE  EQU   ERRID                                                    04140000
NUMDAYS  EQU   PARM+88                                                  04141000
TABSIZE  EQU   PARM+80                                                  04142000
SYSRETRN EQU   @NM00007                                                 04143000
NUMIN222 EQU   @NM00006                                                 04144000
WRTHRSH  EQU   PARM+69                                                  04145000
RDTHRSH  EQU   PARM+66                                                  04146000
TERM     EQU   PARM+58                                                  04147000
PENSEC2  EQU   ENDTIME2+2                                               04148000
PENMIN2  EQU   ENDTIME2+1                                               04149000
PENHOUR2 EQU   ENDTIME2                                                 04150000
PSTSEC2  EQU   STTIME2+2                                                04151000
PSTMIN2  EQU   STTIME2+1                                                04152000
PSTHOUR2 EQU   STTIME2                                                  04153000
PENSEC1  EQU   ENDTIME1+2                                               04154000
PENMIN1  EQU   ENDTIME1+1                                               04155000
PENHOUR1 EQU   ENDTIME1                                                 04156000
PSTSEC1  EQU   STTIME1+2                                                04157000
PSTMIN1  EQU   STTIME1+1                                                04158000
PSTHOUR1 EQU   STTIME1                                                  04159000
@NM00005 EQU   ENDDT+4                                                  04160000
PENDY    EQU   PEND+1                                                   04161000
PENYR    EQU   PEND                                                     04162000
@NM00004 EQU   ENDDATE                                                  04163000
@NM00003 EQU   STDT+4                                                   04164000
PSTDY    EQU   PSTD+1                                                   04165000
PSTYR    EQU   PSTD                                                     04166000
@NM00002 EQU   STDATE                                                   04167000
YEARNOW  EQU   DATENOW+4                                                04168000
@NM00001 EQU   DATENOW+3                                                04169000
DAYNOW   EQU   DATENOW                                                  04170000
CSNAP    EQU   CLOSEIO                                                  04171000
CDRCTWRK EQU   CLOSEIO                                                  04172000
CSYSIN   EQU   CLOSEIO                                                  04173000
CACCDEV  EQU   CLOSEIO                                                  04174000
CACCIN   EQU   CLOSEIO                                                  04175000
CSERLOG  EQU   CLOSEIO                                                  04176000
CEREPPT  EQU   CLOSEIO                                                  04177000
CTOURIST EQU   CLOSEIO                                                  04178000
OSNAP    EQU   OPENIO                                                   04179000
ODRCTWRK EQU   OPENIO                                                   04180000
OSYSIN   EQU   OPENIO                                                   04181000
OACCDEV  EQU   OPENIO                                                   04182000
OACCIN   EQU   OPENIO                                                   04183000
OSERLOG  EQU   OPENIO                                                   04184000
OEREPPT  EQU   OPENIO                                                   04185000
OTOURIST EQU   OPENIO                                                   04186000
PASSFLAG EQU   MISC                                                     04187000
PLOGREC  EQU   MISC                                                     04188000
ERRORID  EQU   MISC                                                     04189000
PSUM     EQU   PRINTES                                                  04190000
PEDIT    EQU   PRINTES                                                  04191000
PHIST    EQU   MISC                                                     04192000
PACC     EQU   MISC                                                     04193000
PZERO    EQU   MISC                                                     04194000
DEBUG63  EQU   DEBUGA+3                                                 04195000
DEBUG62  EQU   DEBUGA+3                                                 04196000
DEBUG61  EQU   DEBUGA+3                                                 04197000
DEBUG60  EQU   DEBUGA+3                                                 04198000
DEBUG59  EQU   DEBUGA+3                                                 04199000
DEBUG58  EQU   DEBUGA+3                                                 04200000
DEBUG57  EQU   DEBUGA+3                                                 04201000
DEBUG56  EQU   DEBUGA+3                                                 04202000
DEBUG55  EQU   DEBUGA+2                                                 04203000
DEBUG54  EQU   DEBUGA+2                                                 04204000
DEBUG53  EQU   DEBUGA+2                                                 04205000
DEBUG52  EQU   DEBUGA+2                                                 04206000
DEBUG51  EQU   DEBUGA+2                                                 04207000
DEBUG50  EQU   DEBUGA+2                                                 04208000
DEBUG49  EQU   DEBUGA+2                                                 04209000
DEBUG48  EQU   DEBUGA+2                                                 04210000
DEBUG45  EQU   DEBUGA+1                                                 04211000
DEBUG44  EQU   DEBUGA+1                                                 04212000
DEBUG43  EQU   DEBUGA+1                                                 04213000
DEBUG42  EQU   DEBUGA+1                                                 04214000
DEBUG41  EQU   DEBUGA+1                                                 04215000
DEBUG40  EQU   DEBUGA+1                                                 04216000
DEBUG39  EQU   DEBUGA                                                   04217000
DEBUG38  EQU   DEBUGA                                                   04218000
DEBUG37  EQU   DEBUGA                                                   04219000
DEBUG36  EQU   DEBUGA                                                   04220000
DEBUG35  EQU   DEBUGA                                                   04221000
DEBUG34  EQU   DEBUGA                                                   04222000
DEBUG33  EQU   DEBUGA                                                   04223000
DEBUG32  EQU   DEBUGA                                                   04224000
DEBUG31  EQU   DEBUG+3                                                  04225000
DEBUG30  EQU   DEBUG+3                                                  04226000
DEBUG28  EQU   DEBUG+3                                                  04227000
DEBUG27  EQU   DEBUG+3                                                  04228000
DEBUG26  EQU   DEBUG+3                                                  04229000
DEBUG25  EQU   DEBUG+3                                                  04230000
DEBUG23  EQU   DEBUG+2                                                  04231000
DEBUG22  EQU   DEBUG+2                                                  04232000
DEBUG21  EQU   DEBUG+2                                                  04233000
DEBUG20  EQU   DEBUG+2                                                  04234000
DEBUG19  EQU   DEBUG+2                                                  04235000
DEBUG18  EQU   DEBUG+2                                                  04236000
DEBUG16  EQU   DEBUG+2                                                  04237000
DEBUG15  EQU   DEBUG+1                                                  04238000
DEBUG14  EQU   DEBUG+1                                                  04239000
DEBUG13  EQU   DEBUG+1                                                  04240000
DEBUG11  EQU   DEBUG+1                                                  04241000
DEBUG10  EQU   DEBUG+1                                                  04242000
DEBUG9   EQU   DEBUG+1                                                  04243000
DEBUG8   EQU   DEBUG+1                                                  04244000
DEBUG7   EQU   DEBUG                                                    04245000
DEBUG3   EQU   DEBUG                                                    04246000
DEBUG2   EQU   DEBUG                                                    04247000
DEBUG1   EQU   DEBUG                                                    04248000
DEBUG0   EQU   DEBUG                                                    04249000
SORTBRK  EQU   SWITCHES+1                                               04250000
COREFAIL EQU   SWITCHES+1                                               04251000
ANALYSIS EQU   SWITCHES+1                                               04252000
SHIFT3RD EQU   SWITCHES+1                                               04253000
DEVEXCL  EQU   SWITCHES+1                                               04254000
ZEROALL  EQU   SWITCHES+1                                               04255000
NOTALL   EQU   SWITCHES+1                                               04256000
NOSDR    EQU   SWITCHES                                                 04257000
TIMESEQ  EQU   SWITCHES                                                 04258000
SYSUM    EQU   SWITCHES                                                 04259000
PARMTHR  EQU   SWITCHES                                                 04260000
TREND    EQU   SWITCHES                                                 04261000
SHORTOBR EQU   SWITCHES                                                 04262000
PARMMES  EQU   SWITCHES                                                 04263000
RDESUM   EQU   SWITCHES                                                 04264000
PCCHFRAM EQU   RECTYPE+1                                                04265000
PMCHFRAM EQU   RECTYPE+1                                                04266000
PTTYP    EQU   RECTYPE+1                                                04267000
PEOD     EQU   RECTYPE                                                  04268000
PMIH     EQU   RECTYPE                                                  04269000
PDDR     EQU   RECTYPE                                                  04270000
PIPL     EQU   RECTYPE                                                  04271000
PSOFT    EQU   RECTYPE                                                  04272000
POBR     EQU   RECTYPE                                                  04273000
PCHAN    EQU   RECTYPE                                                  04274000
PMCH     EQU   RECTYPE                                                  04275000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      04276000
@RF00422 EQU   @EL00008                                                 04277000
L000113  EQU   @EL00010                                                 04278000
L000112  EQU   @EL00010                                                 04279000
@RF00847 EQU   @EL00011                                                 04280000
@RF00854 EQU   @EL00011                                                 04281000
@RF00890 EQU   @EL00013                                                 04282000
@RF00906 EQU   @EL00014                                                 04283000
@RC00971 EQU   @EL00027                                                 04284000
@RC00969 EQU   @EL00027                                                 04285000
@RC00967 EQU   @EL00027                                                 04286000
@RC00965 EQU   @EL00027                                                 04287000
@RC00963 EQU   @EL00027                                                 04288000
@RC00961 EQU   @EL00027                                                 04289000
@RC00959 EQU   @EL00027                                                 04290000
@RC00957 EQU   @EL00027                                                 04291000
@RC00955 EQU   @EL00027                                                 04292000
@RC00953 EQU   @EL00027                                                 04293000
@RC00997 EQU   @EL00028                                                 04294000
@RC00995 EQU   @EL00028                                                 04295000
@RC00993 EQU   @EL00028                                                 04296000
@RC00991 EQU   @EL00028                                                 04297000
@RC00989 EQU   @EL00028                                                 04298000
@RC00987 EQU   @EL00028                                                 04299000
@RC00985 EQU   @EL00028                                                 04300000
@RC00983 EQU   @EL00028                                                 04301000
@RC00981 EQU   @EL00028                                                 04302000
@RC00979 EQU   @EL00028                                                 04303000
@RC00977 EQU   @EL00028                                                 04304000
@PB00029 EQU   @PB00030                                                 04305000
@RF01061 EQU   @RC01051                                                 04306000
@RF01064 EQU   @RC01051                                                 04307000
@RF01101 EQU   @EL00001                                                 04308000
@RC00499 EQU   L000113                                                  04309000
@RC00612 EQU   L000113                                                  04310000
@RC00607 EQU   L000113                                                  04311000
@RC00602 EQU   L000113                                                  04312000
@RC00597 EQU   L000113                                                  04313000
@RC00591 EQU   L000113                                                  04314000
@RF00736 EQU   L000113                                                  04315000
@RC00801 EQU   L000113                                                  04316000
@PB00028 EQU   @PB00029                                                 04317000
@PB00027 EQU   @PB00028                                                 04318000
@PB00026 EQU   @PB00027                                                 04319000
@PB00025 EQU   @PB00026                                                 04320000
@PB00024 EQU   @PB00025                                                 04321000
@PB00023 EQU   @PB00024                                                 04322000
@PB00022 EQU   @PB00023                                                 04323000
@PB00021 EQU   @PB00022                                                 04324000
@PB00020 EQU   @PB00021                                                 04325000
@PB00019 EQU   @PB00020                                                 04326000
@PB00018 EQU   @PB00019                                                 04327000
@PB00017 EQU   @PB00018                                                 04328000
@PB00016 EQU   @PB00017                                                 04329000
@PB00015 EQU   @PB00016                                                 04330000
@PB00014 EQU   @PB00015                                                 04331000
@PB00013 EQU   @PB00014                                                 04332000
@PB00012 EQU   @PB00013                                                 04333000
@PB00011 EQU   @PB00012                                                 04334000
@PB00010 EQU   @PB00011                                                 04335000
@PB00009 EQU   @PB00010                                                 04336000
@PB00008 EQU   @PB00009                                                 04337000
@PB00007 EQU   @PB00008                                                 04338000
@PB00006 EQU   @PB00007                                                 04339000
@PB00005 EQU   @PB00006                                                 04340000
@PB00004 EQU   @PB00005                                                 04341000
@PB00003 EQU   @PB00004                                                 04342000
@PB00002 EQU   @PB00003                                                 04343000
@ENDDATA EQU   *                                                        04344000
         END   IFCEVENT                                                 04345000
