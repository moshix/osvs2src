         TITLE 'IFCFILT2-RECORD FILTER FOR SYSTEM SUMMARY REPORT'       00001000
IFCFILT2 CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'IFCFILT2  79.011'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  ST    @14,12(,@13)                                        0001 00009000
         STM   @00,@12,20(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  LA    @11,4095(,@12)                                      0001 00012000
         LA    @10,4095(,@11)                                      0001 00013000
         LA    @09,4095(,@10)                                      0001 00014000
         USING @PSTART,@12                                         0001 00015000
         USING @PSTART+4095,@11                                    0001 00016000
         USING @PSTART+8190,@10                                    0001 00017000
         USING @PSTART+12285,@09                                   0001 00018000
         ST    @13,@SA00001+4                                      0001 00019000
         LA    @14,@SA00001                                        0001 00020000
         ST    @14,8(,@13)                                         0001 00021000
         LR    @13,@14                                             0001 00022000
* IF DEBUG4 = ON THEN    /*PRINT THE NAME AND COMPILE DATE   @Z427VLS*/ 00023000
         TM    DEBUG4(R2),B'00001000'                              0208 00024000
         BNO   @RF00208                                            0208 00025000
*  DO;                                                     /*@Z427VLS*/ 00026000
*   R15 = R12 - 27;                                        /*@Z427VLS*/ 00027000
         LR    R15,R12                                             0210 00028000
         SL    R15,@CF01125                                        0210 00029000
*   GEN(MVC  PRINTBDY(16),0(R15));                         /*@Z427VLS*/ 00030000
         MVC  PRINTBDY(16),0(R15)                                       00031000
*   PRINTADR = ADDR(PRINTLIN);  /*SET UP IOHND COMM          @Z427VLS*/ 00032000
         LA    @14,PRINTLIN                                        0212 00033000
         ST    @14,PRINTADR(,R2)                                   0212 00034000
*   CALL  IOHND(RITEPRTR);                                 /*@Z427VLS*/ 00035000
         L     @15,ADIOHND(,R2)                                    0213 00036000
         LA    @01,@AL00213                                        0213 00037000
         BALR  @14,@15                                             0213 00038000
*   R15 = ZERO;                                            /*@Z427VLS*/ 00039000
         SLR   R15,R15                                             0214 00040000
*  END;                                                    /*@Z427VLS*/ 00041000
*  ZERO5 = ZERO5 && ZERO5;/*COMPAR WILL ALWAYS WORK NO MATTER LENG*/    00042000
@RF00208 XC    ZERO5(5),ZERO5                                      0216 00043000
*                         /* OF A SORT TABLE ENTRY           @Z427VLS*/ 00044000
*                  /*PROCESS ERROR RECORDS SEQUENTIALLY      @Z427VLS*/ 00045000
*  CALL INITAB;    /*GET CORE FOR SYSUM2, EVTABLE, AND ONE ENTRY  */    00046000
         BAL   @14,INITAB                                          0217 00047000
*                  /*OF SYSUMONE AND STSUMONE.               @Z427VLS*/ 00048000
*  R15 = ERROR; /*GET RETURN CODES FROM INITAB               @Z427VLS*/ 00049000
         L     R15,ERROR                                           0218 00050000
*DO WHILE R15 = SUCCESS & ENTRIES < MAXENT;                /*@0099VLS*/ 00051000
         B     @DE00219                                            0219 00052000
@DL00219 DS    0H                                                  0220 00053000
*                                     /*DONT SET LAST ENTRY  @Z427VLS*/ 00054000
*    CALL IOHND(READSEQ);                        /*GET A RECORD*/  0220 00055000
         L     @15,ADIOHND(,R2)                                    0220 00056000
         LA    @01,@AL00220                                        0220 00057000
         BALR  @14,@15                                             0220 00058000
*    IF R15 = SUCCESS THEN  /*CONTINUE IF NOT EOF OR UNREADABLE*/  0221 00059000
         LTR   R15,R15                                             0221 00060000
         BNZ   @RF00221                                            0221 00061000
*      DO;                                                 /*@Z427VLS*/ 00062000
*        BUG(21) = BUG(21) + 1; /*NUMBER OF RECORDS RETRIEVED*/    0223 00063000
         LA    @14,1                                               0223 00064000
         AL    @14,BUG+80                                          0223 00065000
         ST    @14,BUG+80                                          0223 00066000
*IF ((LRTKEY1 & GENREC) = HEXA0)|   /* IF MCH OR CCH FRAME RECORD */    00067000
*   ((LRTKEY1 & GENREC) = HEXB0) THEN                              0224 00068000
         MVC   @TS00001(1),LRTKEY1(R7)                             0224 00069000
         NI    @TS00001,X'F0'                                      0224 00070000
         CLI   @TS00001,X'A0'                                      0224 00071000
         BE    @RT00224                                            0224 00072000
         MVC   @TS00001(1),LRTKEY1(R7)                             0224 00073000
         NI    @TS00001,X'F0'                                      0224 00074000
         CLI   @TS00001,X'B0'                                      0224 00075000
         BNE   @RF00224                                            0224 00076000
@RT00224 DS    0H                                                  0225 00077000
* DO;                                                      /*@G51DGBB*/ 00078000
*  CALL FLIMFRAM; /*PROCESS FRAME RECORDS                    @G51DGBB*/ 00079000
         BAL   @14,FLIMFRAM                                        0226 00080000
*  R15 = ERROR; /*GET FRAME PROCESSING ERROR CONDITIONS      @G51DGBB*/ 00081000
         L     R15,ERROR                                           0227 00082000
* END;                                                     /*@G51DGBB*/ 00083000
*ELSE  /*NORMAL ERROR RECORD PROCESSING                      @G51DGBB*/ 00084000
*  DO; /*NON FRAME RECORDS                                   @G51DGBB*/ 00085000
         B     @RC00224                                            0229 00086000
@RF00224 DS    0H                                                  0230 00087000
*        CALL ALLREC;          /*SELECT BY RECORD HEADER CRITERIA*/     00088000
         BAL   @14,ALLREC                                          0230 00089000
*        IF PASSFLAG = YES THEN                                    0231 00090000
         TM    PASSFLAG(R2),B'00000001'                            0231 00091000
         BNO   @RF00231                                            0231 00092000
*          DO;                                             /*@Z427VLS*/ 00093000
*            BUG(22) = BUG(22) + 1; /*PASS DATE, TIME FILTER COUNT*/    00094000
         LA    @14,1                                               0233 00095000
         AL    @14,BUG+84                                          0233 00096000
         ST    @14,BUG+84                                          0233 00097000
*            CALL RECDEP; /*ADD TO SYSUMONE,SYSUM2 IF PASS   @Z427VLS*/ 00098000
         BAL   @14,RECDEP                                          0234 00099000
*              EVSTOP = LRTYRDAY;  /*THEN CHANGE LAST DAY FOR REPORT */ 00100000
         L     @14,EVPTR(,R2)                                      0235 00101000
         MVC   EVSTOP(3,@14),LRTYRDAY(R7)                          0235 00102000
*            IF LRTYRDAY < STRTDATE THEN /*CHK START DATE FOR NEW LOW*/ 00103000
         CLC   LRTYRDAY(3,R7),STRTDATE(R2)                         0236 00104000
         BNL   @RF00236                                            0236 00105000
*              STRTDATE = LRTYRDAY;      /*CHANGE START DATE OF DATA */ 00106000
         MVC   STRTDATE(3,R2),LRTYRDAY(R7)                         0237 00107000
*            IF PACC = YES THEN    /*HISTORY D.S. TO BE CREATED*/  0238 00108000
@RF00236 TM    PACC(R2),B'01000000'                                0238 00109000
         BNO   @RF00238                                            0238 00110000
*                CALL IOHND(RITEHIST);  /*WRITE TO ACCDEV    @Z427VLS*/ 00111000
         L     @15,ADIOHND(,R2)                                    0239 00112000
         LA    @01,@AL00239                                        0239 00113000
         BALR  @14,@15                                             0239 00114000
*               IF R15 = SUCCESS & SYSUMKEY  ^= ZERO5              0240 00115000
*               THEN DO; /*NO ERRORS PLUS ENTRY FOR NON 0 CPU CREATED*/ 00116000
@RF00238 LTR   R15,R15                                             0240 00117000
         BNZ   @RF00240                                            0240 00118000
         CLC   SYSUMKEY(5),ZERO5                                   0240 00119000
         BE    @RF00240                                            0240 00120000
*               /*IF IF RECORD HAS BEEN SAVED IN SYSUM2 THEN MUST UP*/  00121000
*                CALL ADDVALUE;   /*BUILD THE SORT TABLE ENTRY*/   0242 00122000
         BAL   @14,ADDVALUE                                        0242 00123000
*                    SYSUM2  = (SYSUM2  && SYSUM2 ); /*CLEAR @0099VLS*/ 00124000
         XC    SYSUM2(14),SYSUM2                                   0243 00125000
*               END;                                       /*@Z427VLS*/ 00126000
*            ELSE                                                  0245 00127000
*              IF R15 ^= SUCCESS THEN                              0245 00128000
         B     @RC00240                                            0245 00129000
@RF00240 LTR   R15,R15                                             0245 00130000
         BZ    @RF00245                                            0245 00131000
*                ZEROALL = NO; /*DONT RESET LOGREC HEADER OF ALL */     00132000
         NI    ZEROALL(R2),B'10111111'                             0246 00133000
*                             /*RECORDS NOT PROCESSED        @Z427VLS*/ 00134000
*          END;                                            /*@Z427VLS*/ 00135000
@RF00245 DS    0H                                                  0247 00136000
@RC00240 DS    0H                                                  0248 00137000
*   END; /*END OF NON-FRAME ERROR RECORD SEQUENTIAL PROCESSING*/   0248 00138000
@RF00231 DS    0H                                                  0249 00139000
*      END;                                                /*@Z427VLS*/ 00140000
@RC00224 DS    0H                                                  0250 00141000
*  END;                                                    /*@Z427VLS*/ 00142000
@RF00221 DS    0H                                                  0250 00143000
@DE00219 LTR   R15,R15                                             0250 00144000
         BNZ   @DC00219                                            0250 00145000
         L     @14,ENTRIES                                         0250 00146000
         C     @14,MAXENT                                          0250 00147000
         BL    @DL00219                                            0250 00148000
@DC00219 DS    0H                                                  0251 00149000
*  ERROR = R15; /*TELL ENDOFILE IF THERE ARE ERRORS          @Z427VLS*/ 00150000
         ST    R15,ERROR                                           0251 00151000
*PASSNUM = ENTRIES - 1;                                    /*@0099VLS*/ 00152000
         L     @14,ENTRIES                                         0252 00153000
         BCTR  @14,0                                               0252 00154000
         ST    @14,PASSNUM                                         0252 00155000
*  CALL ENDOFILE; /*SORT SORTABLE, FREE EXCESS CORE, HANDLE  @Z427VLS*/ 00156000
         BAL   @14,ENDOFILE                                        0253 00157000
*                 /*ERROR CONDITIONS                         @Z427VLS*/ 00158000
*  R15 = ERROR; /*PRESERVE R.C. ALTERATION FROM ENDOFILE PROC*/    0254 00159000
         L     R15,ERROR                                           0254 00160000
*  IF DEBUG16 = ON THEN                                            0255 00161000
         TM    DEBUG16(R2),B'10000000'                             0255 00162000
         BNO   @RF00255                                            0255 00163000
*    CALL BUGCNTS; /*PRINT COUNTS OF DIFFERENT RECORD TYPES PROCESSED*/ 00164000
         BAL   @14,BUGCNTS                                         0256 00165000
*  IF DEBUG11 = ON THEN                                            0257 00166000
@RF00255 TM    DEBUG11(R2),B'00010000'                             0257 00167000
         BNO   @RF00257                                            0257 00168000
*    GEN(ABEND 220,DUMP); /*SHOW STATUS IF TESTING SITUATION @Z427VLS*/ 00169000
         ABEND 220,DUMP                                                 00170000
*RESPECIFY (R15) UNRESTRICTED;                             /*@Z427VLS*/ 00171000
*INITAB: PROC;                                             /*@Z427VLS*/ 00172000
@EL00001 L     @13,4(,@13)                                         0260 00173000
@EF00001 DS    0H                                                  0260 00174000
@ER00001 L     @14,12(,@13)                                        0260 00175000
         LM    @00,@12,20(@13)                                     0260 00176000
         BR    @14                                                 0260 00177000
INITAB   STM   @14,@12,@SA00002                                    0260 00178000
*RESPECIFY(R0,R15) RESTRICTED;                             /*@Z427VLS*/ 00179000
*/*CORE IS ALLOCATED FOR SYSUM2, EVTABLE, THE SUMMARY COLUMN ENTRY OF*/ 00180000
*/*SYSUMONE. IF SHARE TABLE EXISTS, EXTRA ENTRIES OF SYSUMONE ARE  */   00181000
*/* ALLOCATED FOR EVERY UNIQUE CPU SERIAL ENCOUNTERED IN SHARE     */   00182000
*/* TABLE. ERROR MESSAGES ARE ISSUED AND A SERIOUS RETURN CODE     */   00183000
*/*     ISSUED IF CORE IS NOT AVAILABLE                      @Z427VLS*/ 00184000
*R0 = TABSIZE + EVSIZE + SUMSIZE1; /*GET CORE FOR ALL TABLES @Z427VLS*/ 00185000
         LA    R0,256                                              0262 00186000
         AL    R0,TABSIZE(,R2)                                     0262 00187000
*GEN(GETMAIN EC,LV=(R0),A=EVPTR1);                         /*@Z427VLS*/ 00188000
         GETMAIN EC,LV=(R0),A=EVPTR1                                    00189000
*IF R15 ^= SUCCESS THEN                                            0264 00190000
         LTR   R15,R15                                             0264 00191000
         BZ    @RF00264                                            0264 00192000
*  DO;                                                     /*@Z427VLS*/ 00193000
*    MSGNO = 2;                                            /*@Z427VLS*/ 00194000
         MVI   MSGNO,X'02'                                         0266 00195000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 00196000
         BAL   @14,ERRMSG                                          0267 00197000
*    R15 = NOSRTABL;                                       /*@0001VLS*/ 00198000
         LA    R15,12                                              0268 00199000
*    GETFAIL = YES;                                        /*@0001VLS*/ 00200000
         OI    GETFAIL,B'00001000'                                 0269 00201000
*  END;                                                    /*@Z427VLS*/ 00202000
*ELSE                                                              0271 00203000
*  DO;                                                     /*@Z427VLS*/ 00204000
         B     @RC00264                                            0271 00205000
@RF00264 DS    0H                                                  0272 00206000
*  MAXENT = TABSIZE/14;    /*DETERMINE MAX # OF ENTRIES      @D3506GB*/ 00207000
         L     @04,TABSIZE(,R2)                                    0272 00208000
         SRDA  @04,32                                              0272 00209000
         D     @04,@CF01057                                        0272 00210000
         ST    @05,MAXENT                                          0272 00211000
*    EVPTR = EVPTR1; /*ESTABLISH EVTABLE ADDRESSIBILITY      @Z427VLS*/ 00212000
         L     @14,EVPTR1                                          0273 00213000
         ST    @14,EVPTR(,R2)                                      0273 00214000
*    EVSTOP = '00000F'X; /*INSURE VALUE ALWAYS SET FROM FIRST RECORD*/  00215000
         MVC   EVSTOP(3,@14),@CB00228                              0274 00216000
*    STRTDATE = '99366F'X; /*LIKEWISE FOR START DATE         @Z427VLS*/ 00217000
         MVC   STRTDATE(3,R2),@CB01361                             0275 00218000
*    EVTABLE = (EVTABLE && EVTABLE); /*CLEAR TO HEX ZEROS    @Z427VLS*/ 00219000
         XC    EVTABLE(102,@14),EVTABLE(@14)                       0276 00220000
*    STSUMPTR = EVPTR1 + EVSIZE; /*LOCATION JUST BEYOND EVTABLE*/  0277 00221000
         LA    @08,128                                             0277 00222000
         ALR   @14,@08                                             0277 00223000
         ST    @14,STSUMPTR                                        0277 00224000
*    SORTADR = STSUMPTR + SUMSIZE1;                        /*@Z427VLS*/ 00225000
         ALR   @08,@14                                             0278 00226000
         ST    @08,SORTADR(,R2)                                    0278 00227000
*    SYSUM2(1) = (SYSUM2(1) && SYSUM2(1));                 /*@Z427VLS*/ 00228000
         XC    SYSUM2(1),SYSUM2                                    0279 00229000
*    STSUMONE = (STSUMONE && STSUMONE);                    /*@Z427VLS*/ 00230000
         XC    STSUMONE(100,@14),STSUMONE(@14)                     0280 00231000
*    IF SHAREPTR ^= ZERO THEN                                      0281 00232000
         L     @14,SHAREPTR(,R2)                                   0281 00233000
         LTR   @14,@14                                             0281 00234000
         BZ    @RF00281                                            0281 00235000
*      DO;                                              /* @ZA17692 */  00236000
*        CALL SORTSHAR;   /* SORT SHARE TABLE CPU LETTER   @ZA17692 */  00237000
         BAL   @14,SORTSHAR                                        0283 00238000
*        DO J = 1 BY 1 TO SHARENUM WHILE R15 = SUCCESS;    /*@Z427VLS*/ 00239000
         LA    @14,1                                               0284 00240000
         ST    @14,J                                               0284 00241000
         B     @DE00284                                            0284 00242000
@DL00284 LTR   R15,R15                                             0284 00243000
         BNZ   @DC00284                                            0284 00244000
*          UNIQUE = YES;                                   /*@Z427VLS*/ 00245000
         OI    UNIQUE,B'00100000'                                  0285 00246000
*          DO K = 1 BY 1 TO EVMAX WHILE UNIQUE = YES;      /*@Z427VLS*/ 00247000
         LA    @14,1                                               0286 00248000
         ST    @14,K                                               0286 00249000
@DL00286 TM    UNIQUE,B'00100000'                                  0286 00250000
         BNO   @DC00286                                            0286 00251000
*            IF SHARSERA(J) = EVSERIAL(K) THEN                     0287 00252000
         L     @08,J                                               0287 00253000
         SLA   @08,4                                               0287 00254000
         L     @01,SHAREPTR(,R2)                                   0287 00255000
         MH    @14,@CH00081                                        0287 00256000
         L     @06,EVPTR(,R2)                                      0287 00257000
         ALR   @01,@08                                             0287 00258000
         AL    @01,@CF01560                                        0287 00259000
         ALR   @06,@14                                             0287 00260000
         CLC   SHARSERA-10(3,@01),EVSERIAL-6(@06)                  0287 00261000
         BNE   @RF00287                                            0287 00262000
*              UNIQUE = NO;                                /*@Z427VLS*/ 00263000
         NI    UNIQUE,B'11011111'                                  0288 00264000
*            ELSE IF EVSERIAL(K) = ZERO THEN                       0289 00265000
         B     @RC00287                                            0289 00266000
@RF00287 L     @14,K                                               0289 00267000
         MH    @14,@CH00081                                        0289 00268000
         L     @08,EVPTR(,R2)                                      0289 00269000
         L     @06,EVSERIAL-7(@14,@08)                             0289 00270000
         LA    @06,0(,@06)                                         0289 00271000
         LTR   @06,@06                                             0289 00272000
         BNZ   @RF00289                                            0289 00273000
*              DO;                                         /*@Z427VLS*/ 00274000
*                UNIQUE = NO;                              /*@Z427VLS*/ 00275000
         NI    UNIQUE,B'11011111'                                  0291 00276000
*                EVSERIAL(K) = SHARSERA(J);                /*@Z427VLS*/ 00277000
         ST    @14,@TF00001                                        0292 00278000
         ALR   @14,@08                                             0292 00279000
         L     @06,J                                               0292 00280000
         SLA   @06,4                                               0292 00281000
         L     @03,SHAREPTR(,R2)                                   0292 00282000
         ST    @06,@TF00002                                        0292 00283000
         ALR   @06,@03                                             0292 00284000
         AL    @06,@CF01560                                        0292 00285000
         MVC   EVSERIAL-6(3,@14),SHARSERA-10(@06)                  0292 00286000
*                EVLETTER(K) = SHARLET(J);                 /*@Z427VLS*/ 00287000
         LR    @14,@08                                             0293 00288000
         AL    @14,@TF00001                                        0293 00289000
         AL    @03,@TF00002                                        0293 00290000
         MVC   EVLETTER-6(1,@14),SHARLET-16(@03)                   0293 00291000
*                EVNUM = EVNUM + 1;                        /*@Z427VLS*/ 00292000
         LA    @14,1                                               0294 00293000
         AH    @14,EVNUM(,@08)                                     0294 00294000
         STH   @14,EVNUM(,@08)                                     0294 00295000
*                    R0 = SUMSIZE1; /*SYSUMONE TABLE SIZE    @Z427VLS*/ 00296000
         LA    R0,128                                              0295 00297000
*                    GEN(GETMAIN EC,LV=(R0),A=COMPLINK);   /*@Z427VLS*/ 00298000
         GETMAIN EC,LV=(R0),A=COMPLINK                                  00299000
*                    IF R15  = SUCCESS THEN                        0297 00300000
         LTR   R15,R15                                             0297 00301000
         BNZ   @RF00297                                            0297 00302000
*                      DO;                                 /*@Z427VLS*/ 00303000
*                        IF K > 1 THEN /*IF ALREADY SYSUMONE ENTRY*/    00304000
         CLC   K(4),@CF00055                                       0299 00305000
         BNH   @RF00299                                            0299 00306000
*                          SYSUMNXT = COMPLINK; /*POINT TO NEW ENTRY*/  00307000
         L     @01,SYSUMPTR(,R2)                                   0300 00308000
         L     @14,COMPLINK                                        0300 00309000
         ST    @14,SYSUMNXT(,@01)                                  0300 00310000
*                                               /*FROM OLD ENTRY*/ 0301 00311000
*                          SYSUMPTR = COMPLINK; /*ADDRESS NEW ENTRY*/   00312000
@RF00299 L     @14,COMPLINK                                        0301 00313000
         ST    @14,SYSUMPTR(,R2)                                   0301 00314000
*                          SAVEADR(K) = COMPLINK; /*SAVE ADDRESS*/ 0302 00315000
         L     @08,K                                               0302 00316000
         SLA   @08,2                                               0302 00317000
         ST    @14,SAVEADR-4(@08)                                  0302 00318000
*                          SYSUMONE = (SYSUMONE && SYSUMONE); /*CLEAR*/ 00319000
         XC    SYSUMONE(100,@14),SYSUMONE(@14)                     0303 00320000
*                      END;                                /*@Z427VLS*/ 00321000
*                    ELSE  /*IF GETMAIN FAILURE THEN         @Z427VLS*/ 00322000
*                      DO;                                 /*@Z427VLS*/ 00323000
         B     @RC00297                                            0305 00324000
@RF00297 DS    0H                                                  0306 00325000
*                        MSGNO = 1; /*SELECT ERROR TEXT      @Z427VLS*/ 00326000
         MVI   MSGNO,X'01'                                         0306 00327000
*                        CALL ERRMSG; /*GO PRINT MESSAGE TO TOURIST*/   00328000
         BAL   @14,ERRMSG                                          0307 00329000
*                        R15 = NOSRTABL;                   /*@0001VLS*/ 00330000
         LA    R15,12                                              0308 00331000
*                        GETFAIL = YES;                    /*@0001VLS*/ 00332000
         OI    GETFAIL,B'00001000'                                 0309 00333000
*                      END;                                /*@Z427VLS*/ 00334000
*              END;                                        /*@Z427VLS*/ 00335000
@RC00297 DS    0H                                                  0312 00336000
*          END;                                          /* @Z427VLS */ 00337000
@RF00289 DS    0H                                                  0312 00338000
@RC00287 LA    @14,1                                               0312 00339000
         AL    @14,K                                               0312 00340000
         ST    @14,K                                               0312 00341000
         C     @14,@CF00034                                        0312 00342000
         BNH   @DL00286                                            0312 00343000
@DC00286 DS    0H                                                  0313 00344000
*        END;                                            /* @Z427VLS */ 00345000
         LA    @14,1                                               0313 00346000
         AL    @14,J                                               0313 00347000
         ST    @14,J                                               0313 00348000
@DE00284 L     @01,SHAREPTR(,R2)                                   0313 00349000
         CH    @14,SHARENUM(,@01)                                  0313 00350000
         BNH   @DL00284                                            0313 00351000
@DC00284 DS    0H                                                  0314 00352000
*      END;                                             /* @ZA17692 */  00353000
*  END;                                                    /*@Z427VLS*/ 00354000
@RF00281 DS    0H                                                  0316 00355000
*  NUMUNSHR = EVNUM + 1;                                   /*@Z427VLS*/ 00356000
@RC00264 L     @01,EVPTR(,R2)                                      0316 00357000
         LH    @01,EVNUM(,@01)                                     0316 00358000
         LA    @01,1(,@01)                                         0316 00359000
         STH   @01,NUMUNSHR                                        0316 00360000
*IF R15 = SUCCESS &  /*IF OTHER GETMAINS HAVE BEEN SUCCESSFULL  */ 0317 00361000
*         PACC = ON &  /*ONLY CHECK FRAMES IF WRITTEN TO ACCDEV*/  0317 00362000
*         (PMCH = ON | PCHAN = ON) THEN /*IF MCH OR CCH SELECTED*/ 0317 00363000
         LTR   R15,R15                                             0317 00364000
         BNZ   @RF00317                                            0317 00365000
         TM    PACC(R2),B'01000000'                                0317 00366000
         BNO   @RF00317                                            0317 00367000
         TM    PMCH(R2),B'11000000'                                0317 00368000
         BZ    @RF00317                                            0317 00369000
*  DO;                                                     /*@G51DGBB*/ 00370000
* RESPECIFY (R1) RESTRICTED;                               /*@G51DGBB*/ 00371000
*    R0 = FRAMBENT * EVMAX; /*NUMBER OF ENTRIES TIMES BYTES PER ENTRY*/ 00372000
         LA    R0,240                                              0320 00373000
*    R0 = R0 + 4;           /*ADD FRAMENUM LENGTH            @G51DGBB*/ 00374000
         AL    R0,@CF00064                                         0321 00375000
*    GEN(GETMAIN EC,LV=(R0),A=LINKPTR,SP=21); /*GET THE STORAGE*/  0322 00376000
         GETMAIN EC,LV=(R0),A=LINKPTR,SP=21                             00377000
*    RESPECIFY (R0) UNRESTRICTED;                          /*@G51DGBB*/ 00378000
*    IF R15 = SUCCESS THEN   /*IF GETMAIN SUCCESSFULL        @G51DGBB*/ 00379000
         LTR   R15,R15                                             0324 00380000
         BNZ   @RF00324                                            0324 00381000
*      DO;                                                 /*@G51DGBB*/ 00382000
*        FRAMEPTR = LINKPTR;  /*ESTABLISH FRAMETAB BASE ADDRESS*/  0326 00383000
         L     @14,LINKPTR                                         0326 00384000
         ST    @14,FRAMEPTR(,R2)                                   0326 00385000
*        DO Y = 1 BY 1 TO EVMAX; /*CLEAR FRAMETAB TO ZEROS   @G51DGBB*/ 00386000
         LA    @14,1                                               0327 00387000
         ST    @14,Y                                               0327 00388000
@DL00327 DS    0H                                                  0328 00389000
*          FRAMEDTA(Y) = (FRAMEDTA(Y) && FRAMEDTA(Y));     /*@G51DGBB*/ 00390000
         LR    @08,@14                                             0328 00391000
         MH    @08,@CH00227                                        0328 00392000
         L     @06,FRAMEPTR(,R2)                                   0328 00393000
         ALR   @06,@08                                             0328 00394000
         AL    @06,@CF01562                                        0328 00395000
         XC    FRAMEDTA-4(24,@06),FRAMEDTA-4(@06)                  0328 00396000
*        END;                                              /*@G51DGBB*/ 00397000
         AL    @14,@CF00055                                        0329 00398000
         ST    @14,Y                                               0329 00399000
         C     @14,@CF00034                                        0329 00400000
         BNH   @DL00327                                            0329 00401000
*        FRAMENUM = ZEROS;                                 /*@G51DGBB*/ 00402000
         L     @14,FRAMEPTR(,R2)                                   0330 00403000
         SLR   @08,@08                                             0330 00404000
         ST    @08,FRAMENUM(,@14)                                  0330 00405000
*      END;                                                /*@G51DGBB*/ 00406000
*  ELSE  /*UNSUCCESSFULL GETMAIN                             @G51DGBB*/ 00407000
*    DO;                                                   /*@G51DGBB*/ 00408000
         B     @RC00324                                            0332 00409000
@RF00324 DS    0H                                                  0333 00410000
*      R15 = TWELVE;  /*DONT CONTINUE RETURN CODE            @G51DGBB*/ 00411000
         LA    R15,12                                              0333 00412000
*      MSGNO = 40;   /*CORE NOT AVAILABLE MESSAGE            @G51DGBB*/ 00413000
         MVI   MSGNO,X'28'                                         0334 00414000
*      CALL ERRMSG;  /*PRINT ERROR MESSAGE                   @G51DGBB*/ 00415000
         BAL   @14,ERRMSG                                          0335 00416000
*    END;                                                  /*@G51DGBB*/ 00417000
* END; /*END OF FRAMETAB GETMAIN                             @G51DGBB*/ 00418000
@RC00324 DS    0H                                                  0338 00419000
*  ERROR = R15; /*COMMUNICATE ERROR CONDITIONS TO CALLING PROC*/   0338 00420000
@RF00317 ST    R15,ERROR                                           0338 00421000
*RESPECIFY(R0,R15) UNRESTRICTED;                           /*@Z427VLS*/ 00422000
*END; /*END OF PROC INITAB                                   @Z427VLS*/ 00423000
@EL00002 DS    0H                                                  0340 00424000
@EF00002 DS    0H                                                  0340 00425000
@ER00002 LM    @14,@12,@SA00002                                    0340 00426000
         BR    @14                                                 0340 00427000
*CONVERT: PROC;                                            /*@Z427VLS*/ 00428000
CONVERT  STM   @14,@12,12(@13)                                     0341 00429000
*   RESPECIFY (R4,R5) RESTRICTED;                          /*@0099VLS*/ 00430000
* DCL  T      FIXED(31) INIT(0);                           /*@Z427VLS*/ 00431000
*DCL P    FIXED(31) INIT(0);                               /*@G51DGBB*/ 00432000
*DCL Q    FIXED(31) INIT(0);                               /*@G51DGBB*/ 00433000
* DCL  NEXTBYTE(1) CHAR(1) BASED(NEXTBY);                  /*@Z427VLS*/ 00434000
* DCL  ADDNUM(1)   CHAR(1) BASED(ADDNXT);                  /*@Z427VLS*/ 00435000
* DCL  CHARS       CHAR(16) INIT('0123456789ABCDEF');      /*@Z427VLS*/ 00436000
*DO Q = NUMBER BY -1 TO 1;                                 /*@G51DGBB*/ 00437000
         L     @08,NUMBER                                          0349 00438000
         ST    @08,Q                                               0349 00439000
         B     @DE00349                                            0349 00440000
@DL00349 DS    0H                                                  0350 00441000
* R4 = NEXTBYTE(Q);                                        /*@G51DGBB*/ 00442000
         L     @06,NEXTBY                                          0350 00443000
         BCTR  @06,0                                               0350 00444000
         SLR   R4,R4                                               0350 00445000
         IC    R4,NEXTBYTE(@08,@06)                                0350 00446000
* P = 2 * Q;                                               /*@G51DGBB*/ 00447000
         LR    @06,@08                                             0351 00448000
         ALR   @06,@06                                             0351 00449000
         ST    @06,P                                               0351 00450000
*  SRDL(R4,4);                                             /*@Z427VLS*/ 00451000
         SRDL  R4,4                                                0352 00452000
*  SRL(R5,28);                                             /*@Z427VLS*/ 00453000
         SRL   R5,28                                               0353 00454000
*  R5 = R5 + 1;                                            /*@Z427VLS*/ 00455000
         LA    @03,1                                               0354 00456000
         ALR   R5,@03                                              0354 00457000
*  R4 = R4 + 1;                                            /*@Z427VLS*/ 00458000
         ALR   R4,@03                                              0355 00459000
* ADDNUM(P-1) = CHARS(R4);                                 /*@G51DGBB*/ 00460000
         L     @03,ADDNXT                                          0356 00461000
         ALR   @06,@03                                             0356 00462000
         BCTR  @06,0                                               0356 00463000
         BCTR  @06,0                                               0356 00464000
         LA    @15,CHARS-1(R4)                                     0356 00465000
         MVC   ADDNUM(1,@06),0(@15)                                0356 00466000
* ADDNUM(P) = CHARS(R5);                                   /*@G51DGBB*/ 00467000
         L     @06,P                                               0357 00468000
         ALR   @03,@06                                             0357 00469000
         BCTR  @03,0                                               0357 00470000
         LA    @06,CHARS-1(R5)                                     0357 00471000
         MVC   ADDNUM(1,@03),0(@06)                                0357 00472000
* END;                                                     /*@Z427VLS*/ 00473000
         BCTR  @08,0                                               0358 00474000
         ST    @08,Q                                               0358 00475000
@DE00349 LTR   @08,@08                                             0358 00476000
         BP    @DL00349                                            0358 00477000
*END;                                                      /*@Z427VLS*/ 00478000
@EL00003 DS    0H                                                  0359 00479000
@EF00003 DS    0H                                                  0359 00480000
@ER00003 LM    @14,@12,12(@13)                                     0359 00481000
         BR    @14                                                 0359 00482000
*RESPECIFY (R4,R5) UNRESTRICTED;                           /*@Z427VLS*/ 00483000
*/*******************************************************************/  00484000
*/*    THIS PROC WILL SEARCH THE SORT TABLE FOR A ENTRY WITH THE SAME*/ 00485000
*/*    KEY AS THIS ONE THEN SUM THE PERM AND TEMP ERRORS WITH THIS REC* 00486000
*/*    IF NO MATCH CAN BE FOUND THEN CREATE A NEW ONE        @0099VLS*/ 00487000
*/*                                                          @0099VLS*/ 00488000
*ADDVALUE: PROC;                                           /*@0099VLS*/ 00489000
ADDVALUE STM   @14,@12,@SA00004                                    0361 00490000
* DCL ZZ PTR(31)  INIT(0);                                 /*@0099VLS*/ 00491000
* DCL Z1 FIXED(31)  INIT(0);                               /*@0099VLS*/ 00492000
* DCL Z2 FIXED(31)  INIT(0);                               /*@0099VLS*/ 00493000
* DCL Z3 FIXED(31)  INIT(0);                               /*@0099VLS*/ 00494000
*DCL ZZ3 FIXED(31) INIT(0);                                /*@G51DGBB*/ 00495000
* DCL  1  TMPA  BASED(ZZ),                                         0367 00496000
*        2 TMPKEYA   CHAR(8),                                      0367 00497000
*       2 TMPPERMA FIXED(15) BDY(BYTE),                            0367 00498000
*       2 TMPTEMPA FIXED(31) BDY(BYTE);                    /*@0099VLS*/ 00499000
* FOUND = NO;        /*SET FLAG TO ASSUME THE WORST          @0099VLS*/ 00500000
         NI    FOUND,B'01111111'                                   0368 00501000
* ZZ3 = ZZ3 + 1;     /*NUMBER OF RECORDS FOR PART 2          @0099VLS*/ 00502000
         LA    @08,1                                               0369 00503000
         AL    @08,ZZ3                                             0369 00504000
         ST    @08,ZZ3                                             0369 00505000
*DO ZZ = SORTADR + (ENTRIES-1)*14 BY -14 TO SORTADR WHILE(         0370 00506000
*          FOUND = NO);                                    /*@D3506GB*/ 00507000
         L     @08,ENTRIES                                         0370 00508000
         BCTR  @08,0                                               0370 00509000
         MH    @08,@CH01057                                        0370 00510000
         AL    @08,SORTADR(,R2)                                    0370 00511000
         ST    @08,ZZ                                              0370 00512000
         B     @DE00370                                            0370 00513000
@DL00370 TM    FOUND,B'10000000'                                   0370 00514000
         BNZ   @DC00370                                            0370 00515000
*  IF TMPKEYA = SYSUMKEY THEN                                      0371 00516000
         CLC   TMPKEYA(7,@08),SYSUMKEY                             0371 00517000
         BNE   @RF00371                                            0371 00518000
*   DO;                                                    /*@0099VLS*/ 00519000
*    TMPPERMA = TMPPERMA + SYSPERM1;                       /*@0099VLS*/ 00520000
         ICM   @06,12,TMPPERMA(@08)                                0373 00521000
         SRA   @06,16                                              0373 00522000
         ICM   @03,12,SYSPERM1                                     0373 00523000
         SRA   @03,16                                              0373 00524000
         ALR   @06,@03                                             0373 00525000
         STCM  @06,3,TMPPERMA(@08)                                 0373 00526000
*    TMPTEMPA = TMPTEMPA + SYSTEMP;                        /*@0099VLS*/ 00527000
         ICM   @06,15,TMPTEMPA(@08)                                0374 00528000
         ICM   @03,15,SYSTEMP                                      0374 00529000
         ALR   @06,@03                                             0374 00530000
         STCM  @06,15,TMPTEMPA(@08)                                0374 00531000
*    FOUND = YES;                                          /*@0099VLS*/ 00532000
         OI    FOUND,B'10000000'                                   0375 00533000
*   END;                                                   /*@0099VLS*/ 00534000
* END;                                                     /*@0099VLS*/ 00535000
@RF00371 L     @08,@CF01392                                        0377 00536000
         AL    @08,ZZ                                              0377 00537000
         ST    @08,ZZ                                              0377 00538000
@DE00370 C     @08,SORTADR(,R2)                                    0377 00539000
         BNL   @DL00370                                            0377 00540000
@DC00370 DS    0H                                                  0378 00541000
* IF FOUND = NO THEN                                               0378 00542000
         TM    FOUND,B'10000000'                                   0378 00543000
         BNZ   @RF00378                                            0378 00544000
*  DO;                                                     /*@0099VLS*/ 00545000
*   TMP2(ENTRIES) = SYSUM2;                                /*@0099VLS*/ 00546000
         L     @08,ENTRIES                                         0380 00547000
         LR    @06,@08                                             0380 00548000
         MH    @06,@CH01057                                        0380 00549000
         L     @03,SORTADR(,R2)                                    0380 00550000
         ALR   @03,@06                                             0380 00551000
         AL    @03,@CF01392                                        0380 00552000
         MVC   TMP2(14,@03),SYSUM2                                 0380 00553000
*   ENTRIES = ENTRIES + 1;                                 /*@0099VLS*/ 00554000
         AL    @08,@CF00055                                        0381 00555000
         ST    @08,ENTRIES                                         0381 00556000
*  END;                                                    /*@0099VLS*/ 00557000
*IF DEBUG50 = ON THEN                                              0383 00558000
@RF00378 TM    DEBUG50(R2),B'00100000'                             0383 00559000
         BNO   @RF00383                                            0383 00560000
* DO;                                                      /*@0099VLS*/ 00561000
* NUMBER = 14;                                             /*@D3506GB*/ 00562000
         MVC   NUMBER(4),@CF01057                                  0385 00563000
*  NEXTBY = ADDR(SYSUM2);                                  /*@0099VLS*/ 00564000
         LA    @08,SYSUM2                                          0386 00565000
         ST    @08,NEXTBY                                          0386 00566000
*  ADDNXT = ADDR(PRINTBDY);                                /*@0099VLS*/ 00567000
         LA    @08,PRINTBDY                                        0387 00568000
         ST    @08,ADDNXT                                          0387 00569000
*  CALL CONVERT;                                           /*@0099VLS*/ 00570000
         BAL   @14,CONVERT                                         0388 00571000
*  IF FOUND = YES THEN                                             0389 00572000
         TM    FOUND,B'10000000'                                   0389 00573000
         BNO   @RF00389                                            0389 00574000
*  DO;                                                     /*@0099VLS*/ 00575000
* NEXTBY = ZZ + 14;                                        /*@D3506GB*/ 00576000
         LA    @08,14                                              0391 00577000
         AL    @08,ZZ                                              0391 00578000
         ST    @08,NEXTBY                                          0391 00579000
*  ADDNXT = ADDR(PRINTBDY) + 40;                           /*@0099VLS*/ 00580000
         LA    @08,PRINTBDY                                        0392 00581000
         AL    @08,@CF01236                                        0392 00582000
         ST    @08,ADDNXT                                          0392 00583000
*  CALL CONVERT;                                           /*@0099VLS*/ 00584000
         BAL   @14,CONVERT                                         0393 00585000
*  END;                                                    /*@0099VLS*/ 00586000
*  PRINTADR = ADDR(PRINTLIN);                              /*@0099VLS*/ 00587000
@RF00389 LA    @08,PRINTLIN                                        0395 00588000
         ST    @08,PRINTADR(,R2)                                   0395 00589000
*  CALL IOHND(RITEPRTR);                                   /*@0099VLS*/ 00590000
         L     @15,ADIOHND(,R2)                                    0396 00591000
         LA    @01,@AL00396                                        0396 00592000
         BALR  @14,@15                                             0396 00593000
* END;                                                     /*@0099VLS*/ 00594000
*SYSUM2  = SYSUM2  && SYSUM2;    /*CLEAR FOR THE NEXT ENTRY  @0099VLS*/ 00595000
@RF00383 XC    SYSUM2(14),SYSUM2                                   0398 00596000
*END;                                                      /*@0099VLS*/ 00597000
@EL00004 DS    0H                                                  0399 00598000
@EF00004 DS    0H                                                  0399 00599000
@ER00004 LM    @14,@12,@SA00004                                    0399 00600000
         BR    @14                                                 0399 00601000
*CUASELCT: PROC;                                           /*@Z427VLS*/ 00602000
CUASELCT STM   @14,@12,12(@13)                                     0400 00603000
*CUAOK = NO;                                               /*@Z427VLS*/ 00604000
         NI    CUAOK,B'10111111'                                   0401 00605000
*DO Z = 1 BY 1 TO CUANUM WHILE(CUAOK = NO);                /*@Z427VLS*/ 00606000
         LA    @08,1                                               0402 00607000
         ST    @08,Z                                               0402 00608000
         B     @DE00402                                            0402 00609000
@DL00402 TM    CUAOK,B'01000000'                                   0402 00610000
         BNZ   @DC00402                                            0402 00611000
* IF WORKDEV >= CUA1(Z) & WORKDEV <= CUA2(Z) THEN                  0403 00612000
         SLA   @08,2                                               0403 00613000
         L     @06,CUAPTR(,R2)                                     0403 00614000
         ST    @08,@TF00001                                        0403 00615000
         ALR   @08,@06                                             0403 00616000
         BCTR  @08,0                                               0403 00617000
         BCTR  @08,0                                               0403 00618000
         CLC   WORKDEV(2),CUA1-2(@08)                              0403 00619000
         BL    @RF00403                                            0403 00620000
         AL    @06,@TF00001                                        0403 00621000
         CLC   WORKDEV(2),CUA2-4(@06)                              0403 00622000
         BH    @RF00403                                            0403 00623000
*  CUAOK = YES;                                            /*@Z427VLS*/ 00624000
         OI    CUAOK,B'01000000'                                   0404 00625000
*END;                                                      /*@Z427VLS*/ 00626000
@RF00403 LA    @08,1                                               0405 00627000
         AL    @08,Z                                               0405 00628000
         ST    @08,Z                                               0405 00629000
@DE00402 L     @06,CUAPTR(,R2)                                     0405 00630000
         CH    @08,CUANUM(,@06)                                    0405 00631000
         BNH   @DL00402                                            0405 00632000
@DC00402 DS    0H                                                  0406 00633000
*IF CUAOK = NO THEN                                                0406 00634000
         TM    CUAOK,B'01000000'                                   0406 00635000
         BNZ   @RF00406                                            0406 00636000
*  DO;                                                     /*@D35UGGB*/ 00637000
*    PASSFLAG = NO;                                        /*@D35UGGB*/ 00638000
         NI    PASSFLAG(R2),B'11111110'                            0408 00639000
*    BUG(32) = BUG(32) + 1;                                /*@D35UGGB*/ 00640000
         LA    @08,1                                               0409 00641000
         AL    @08,BUG+124                                         0409 00642000
         ST    @08,BUG+124                                         0409 00643000
*  END;                                                    /*@D35UGGB*/ 00644000
*END;                                                      /*@Z427VLS*/ 00645000
@EL00005 DS    0H                                                  0411 00646000
@EF00005 DS    0H                                                  0411 00647000
@ER00005 LM    @14,@12,12(@13)                                     0411 00648000
         BR    @14                                                 0411 00649000
*DEVSEL: PROC;                                             /*@Z427VLS*/ 00650000
DEVSEL   STM   @14,@12,12(@13)                                     0412 00651000
*IF WORKTYPE = HEX90 THEN                                          0413 00652000
         CLI   WORKTYPE,X'90'                                      0413 00653000
         BNE   @RF00413                                            0413 00654000
*  DO;                                                     /*@Z427VLS*/ 00655000
*    IF DEVEXCL = ON THEN                                          0415 00656000
         TM    DEVEXCL(R2),B'00100000'                             0415 00657000
         BNO   @RF00415                                            0415 00658000
*      DO;                                                 /*@Z427VLS*/ 00659000
*        DEVOK = YES;                                      /*@Z427VLS*/ 00660000
         OI    DEVOK,B'01000000'                                   0417 00661000
*        DO Z = 1 BY 1 TO MDRNUM WHILE DEVOK = YES;        /*@Z427VLS*/ 00662000
         LA    @08,1                                               0418 00663000
         ST    @08,Z                                               0418 00664000
         B     @DE00418                                            0418 00665000
@DL00418 TM    DEVOK,B'01000000'                                   0418 00666000
         BNO   @DC00418                                            0418 00667000
*        IF TPRDEV = MDRVAL(Z) THEN                                0419 00668000
         L     @06,DEVPTR(,R2)                                     0419 00669000
         ALR   @06,@08                                             0419 00670000
         CLC   TPRDEV(1,R7),MDRVAL-1(@06)                          0419 00671000
         BNE   @RF00419                                            0419 00672000
*          DO;                                             /*@Z427VLS*/ 00673000
*            DEVOK = NO;                                   /*@Z427VLS*/ 00674000
         NI    DEVOK,B'10111111'                                   0421 00675000
*            PASSFLAG = NO;                                /*@Z427VLS*/ 00676000
         NI    PASSFLAG(R2),B'11111110'                            0422 00677000
*          END;                                            /*@Z427VLS*/ 00678000
*        END;                                              /*@Z427VLS*/ 00679000
@RF00419 LA    @08,1                                               0424 00680000
         AL    @08,Z                                               0424 00681000
         ST    @08,Z                                               0424 00682000
@DE00418 L     @06,DEVPTR(,R2)                                     0424 00683000
         CH    @08,MDRNUM(,@06)                                    0424 00684000
         BNH   @DL00418                                            0424 00685000
@DC00418 DS    0H                                                  0425 00686000
*      END;                                                /*@Z427VLS*/ 00687000
*    ELSE                                                          0426 00688000
*      DO;                                                 /*@Z427VLS*/ 00689000
         B     @RC00415                                            0426 00690000
@RF00415 DS    0H                                                  0427 00691000
*        DEVOK = NO;                                       /*@Z427VLS*/ 00692000
         NI    DEVOK,B'10111111'                                   0427 00693000
*        DO Z = 1 BY 1 TO MDRNUM WHILE DEVOK = NO;         /*@Z427VLS*/ 00694000
         LA    @08,1                                               0428 00695000
         ST    @08,Z                                               0428 00696000
         B     @DE00428                                            0428 00697000
@DL00428 TM    DEVOK,B'01000000'                                   0428 00698000
         BNZ   @DC00428                                            0428 00699000
*        IF TPRDEV = MDRVAL(Z) THEN                                0429 00700000
         L     @06,DEVPTR(,R2)                                     0429 00701000
         ALR   @06,@08                                             0429 00702000
         CLC   TPRDEV(1,R7),MDRVAL-1(@06)                          0429 00703000
         BNE   @RF00429                                            0429 00704000
*          DEVOK = YES;                                    /*@Z427VLS*/ 00705000
         OI    DEVOK,B'01000000'                                   0430 00706000
*        END;                                              /*@Z427VLS*/ 00707000
@RF00429 LA    @08,1                                               0431 00708000
         AL    @08,Z                                               0431 00709000
         ST    @08,Z                                               0431 00710000
@DE00428 L     @06,DEVPTR(,R2)                                     0431 00711000
         CH    @08,MDRNUM(,@06)                                    0431 00712000
         BNH   @DL00428                                            0431 00713000
@DC00428 DS    0H                                                  0432 00714000
*        IF DEVOK = NO THEN                                        0432 00715000
         TM    DEVOK,B'01000000'                                   0432 00716000
         BNZ   @RF00432                                            0432 00717000
*          PASSFLAG = NO;                                  /*@Z427VLS*/ 00718000
         NI    PASSFLAG(R2),B'11111110'                            0433 00719000
*       END;                                               /*@Z427VLS*/ 00720000
*    END;                                                  /*@Z427VLS*/ 00721000
*  ELSE                                                            0436 00722000
*    IF DEVEXCL = ON THEN                                          0436 00723000
         B     @RC00413                                            0436 00724000
@RF00413 TM    DEVEXCL(R2),B'00100000'                             0436 00725000
         BNO   @RF00436                                            0436 00726000
*      DO;                                                 /*@Z427VLS*/ 00727000
*        DEVOK = YES;                                      /*@Z427VLS*/ 00728000
         OI    DEVOK,B'01000000'                                   0438 00729000
*        DO Z = 1 BY 1 TO DEVNUM WHILE DEVOK = YES;        /*@Z427VLS*/ 00730000
         LA    @08,1                                               0439 00731000
         ST    @08,Z                                               0439 00732000
         B     @DE00439                                            0439 00733000
@DL00439 TM    DEVOK,B'01000000'                                   0439 00734000
         BNO   @DC00439                                            0439 00735000
*          IF WORKDEV = DEVVAL(Z) THEN                             0440 00736000
         ALR   @08,@08                                             0440 00737000
         L     @06,DEVPTR(,R2)                                     0440 00738000
         ALR   @06,@08                                             0440 00739000
         CLC   WORKDEV(2),DEVVAL-2(@06)                            0440 00740000
         BNE   @RF00440                                            0440 00741000
*            DO;                                           /*@Z427VLS*/ 00742000
*              DEVOK = NO;                                 /*@Z427VLS*/ 00743000
         NI    DEVOK,B'10111111'                                   0442 00744000
*              PASSFLAG = NO;                              /*@Z427VLS*/ 00745000
         NI    PASSFLAG(R2),B'11111110'                            0443 00746000
*            END;                                          /*@Z427VLS*/ 00747000
*        END;                                              /*@Z427VLS*/ 00748000
@RF00440 LA    @08,1                                               0445 00749000
         AL    @08,Z                                               0445 00750000
         ST    @08,Z                                               0445 00751000
@DE00439 L     @06,DEVPTR(,R2)                                     0445 00752000
         CH    @08,DEVNUM(,@06)                                    0445 00753000
         BNH   @DL00439                                            0445 00754000
@DC00439 DS    0H                                                  0446 00755000
*      END;                                                /*@Z427VLS*/ 00756000
*  ELSE                                                            0447 00757000
*   DO;                                                    /*@Z427VLS*/ 00758000
         B     @RC00436                                            0447 00759000
@RF00436 DS    0H                                                  0448 00760000
*     DEVOK = NO;                                          /*@Z427VLS*/ 00761000
         NI    DEVOK,B'10111111'                                   0448 00762000
*     DO Z =  1 BY 1 TO DEVNUM WHILE DEVOK = NO;           /*@Z427VLS*/ 00763000
         LA    @08,1                                               0449 00764000
         ST    @08,Z                                               0449 00765000
         B     @DE00449                                            0449 00766000
@DL00449 TM    DEVOK,B'01000000'                                   0449 00767000
         BNZ   @DC00449                                            0449 00768000
*       IF WORKDEV = DEVVAL(Z) THEN                                0450 00769000
         ALR   @08,@08                                             0450 00770000
         L     @06,DEVPTR(,R2)                                     0450 00771000
         ALR   @06,@08                                             0450 00772000
         CLC   WORKDEV(2),DEVVAL-2(@06)                            0450 00773000
         BNE   @RF00450                                            0450 00774000
*         DEVOK = YES;                                     /*@Z427VLS*/ 00775000
         OI    DEVOK,B'01000000'                                   0451 00776000
*     END;                                                 /*@Z427VLS*/ 00777000
@RF00450 LA    @08,1                                               0452 00778000
         AL    @08,Z                                               0452 00779000
         ST    @08,Z                                               0452 00780000
@DE00449 L     @06,DEVPTR(,R2)                                     0452 00781000
         CH    @08,DEVNUM(,@06)                                    0452 00782000
         BNH   @DL00449                                            0452 00783000
@DC00449 DS    0H                                                  0453 00784000
*     IF DEVOK = NO THEN                                           0453 00785000
         TM    DEVOK,B'01000000'                                   0453 00786000
         BNZ   @RF00453                                            0453 00787000
*       PASSFLAG = OFF;                                    /*@Z427VLS*/ 00788000
         NI    PASSFLAG(R2),B'11111110'                            0454 00789000
*   END;                                                   /*@Z427VLS*/ 00790000
@RF00453 DS    0H                                                  0456 00791000
*  IF PASSFLAG = OFF THEN                                  /*@D35UGGB*/ 00792000
@RC00436 DS    0H                                                  0456 00793000
@RC00413 TM    PASSFLAG(R2),B'00000001'                            0456 00794000
         BNZ   @RF00456                                            0456 00795000
*   BUG(31) = BUG(31) + 1;                                         0457 00796000
         LA    @08,1                                               0457 00797000
         AL    @08,BUG+120                                         0457 00798000
         ST    @08,BUG+120                                         0457 00799000
*END;                                                      /*@Z427VLS*/ 00800000
@EL00006 DS    0H                                                  0458 00801000
@EF00006 DS    0H                                                  0458 00802000
@ER00006 LM    @14,@12,12(@13)                                     0458 00803000
         BR    @14                                                 0458 00804000
*SUMONADR: PROC;                                           /*@Z427VLS*/ 00805000
SUMONADR STM   @14,@12,@SA00007                                    0459 00806000
*RESPECIFY(R3,R15) RESTRICTED;                             /*@Z427VLS*/ 00807000
*/*ADDRESS THE SYSUMONE ENTRY THAT RELATES TO THE RECORD CPU @Z427VLS*/ 00808000
*/*SERIAL NUMBER. IF THE ENTRY DOES NOT EXIST, CREATE IT AND @Z427VLS*/ 00809000
*/*ADDRESS IT. SYSUMONE ENTRY NUMBER IS EQUAL TO EVTABLE     @Z427VLS*/ 00810000
*/*ENTRY NUMBER AT THIS STAGE OF IFCFILT2 EXECUTION. IF MORE @Z427VLS*/ 00811000
*/*THAN 16 CPUS ARE IDENTIFIED, AN ERROR MESSAGE IS ISSUED   @Z427VLS*/ 00812000
*/*THE FIRST TIME, AND THE RECORDS FOR THE EXCESS CPUS ARE   @Z427VLS*/ 00813000
*/*SUMMED INTO THE 16TH CPU BUCKET BEFORE THE BUCKETS ARE IN @Z427VLS*/ 00814000
*/*CPU SERIAL ORDER.                                         @Z427VLS*/ 00815000
*    SYSUMPTR = SAVEADR(1); /*ADDRESS 1ST ENTRY IN SYSUMONE CHAIN*/     00816000
         L     @14,SAVEADR                                         0461 00817000
         ST    @14,SYSUMPTR(,R2)                                   0461 00818000
*                           /*MAY BE ZERO IF NO ENTRIES EXIST*/    0462 00819000
*    GETOUT = NO;                                          /*@Z427VLS*/ 00820000
         NI    GETOUT,B'11110111'                                  0462 00821000
*    DO K = 1 BY 1 TO EVMAX WHILE GETOUT = NO;             /*@Z427VLS*/ 00822000
         LA    @14,1                                               0463 00823000
         ST    @14,K                                               0463 00824000
@DL00463 TM    GETOUT,B'00001000'                                  0463 00825000
         BNZ   @DC00463                                            0463 00826000
*      IF EVSERIAL(K) = LRTCPUS THEN                               0464 00827000
         MH    @14,@CH00081                                        0464 00828000
         L     @08,EVPTR(,R2)                                      0464 00829000
         ST    @14,@TF00001                                        0464 00830000
         ALR   @14,@08                                             0464 00831000
         CLC   EVSERIAL-6(3,@14),LRTCPUS(R7)                       0464 00832000
         BNE   @RF00464                                            0464 00833000
*        DO;                                               /*@Z427VLS*/ 00834000
*          EVMODEL(K) = LRTMODEL; /*SET IN CASE THIS ENTRY CREATED*/    00835000
         AL    @08,@TF00001                                        0466 00836000
         MVC   EVMODEL-6(2,@08),LRTMODEL(R7)                       0466 00837000
*          GETOUT = YES;          /*FROM EVTABLE ENTRY WHICH IS   */    00838000
         OI    GETOUT,B'00001000'                                  0467 00839000
*        END;                     /*MISSING MODEL NUMBER     @Z427VLS*/ 00840000
*      ELSE                                                        0469 00841000
*        DO;                                               /*@Z427VLS*/ 00842000
         B     @RC00464                                            0469 00843000
@RF00464 DS    0H                                                  0470 00844000
*          IF SYSUMNXT ^= ZERO & SYSUMPTR ^= ZERO THEN /*IF ANOTHER*/   00845000
         SLR   @14,@14                                             0470 00846000
         L     @08,SYSUMPTR(,R2)                                   0470 00847000
         L     @06,SYSUMNXT(,@08)                                  0470 00848000
         CR    @06,@14                                             0470 00849000
         BE    @RF00470                                            0470 00850000
         CR    @08,@14                                             0470 00851000
         BE    @RF00470                                            0470 00852000
*          /*ENTRY OF SYSUMONE AND ANOTHER ENTRY OF EVTABLE EXIST.*/    00853000
*          /*ALSO, IF AN ENTRY OF SYSUMONE HAS BEE N CREATED @Z427VLS*/ 00854000
*                  SYSUMPTR = SYSUMNXT; /*RESET BASE TO NEXT ENTRY*/    00855000
         ST    @06,SYSUMPTR(,R2)                                   0471 00856000
*          ELSE /*IMPLIES WE HAVE SCANNED ALL EV ENTRIES WITH NO MATCH* 00857000
*            DO;                                           /*@Z427VLS*/ 00858000
         B     @RC00470                                            0472 00859000
@RF00470 DS    0H                                                  0473 00860000
*              GETOUT = YES; /*EXIT LOOP IF CREATE AN ENTRY  @Z427VLS*/ 00861000
         OI    GETOUT,B'00001000'                                  0473 00862000
*              IF K < EVMAX | /*IF ROOM TO CREATE EXTRA ENTRY*/    0474 00863000
*                 (K = EVMAX & EVSERIAL(K) = ZERO) THEN /*IF LAST */    00864000
         L     @14,K                                               0474 00865000
         LA    @08,10                                              0474 00866000
         CR    @14,@08                                             0474 00867000
         BL    @RT00474                                            0474 00868000
         CR    @14,@08                                             0474 00869000
         BNE   @RF00474                                            0474 00870000
         MH    @14,@CH00081                                        0474 00871000
         L     @08,EVPTR(,R2)                                      0474 00872000
         L     @14,EVSERIAL-7(@14,@08)                             0474 00873000
         LA    @14,0(,@14)                                         0474 00874000
         LTR   @14,@14                                             0474 00875000
         BNZ   @RF00474                                            0474 00876000
@RT00474 DS    0H                                                  0475 00877000
*                 /*ENTRY BUT IT REMAINS UNSET THEN          @Z427VLS*/ 00878000
*                DO;                                       /*@Z427VLS*/ 00879000
*                  L = EVNUM + 1; /*BUILD NEXT EVTABLE ENTRY @Z427VLS*/ 00880000
         L     @14,EVPTR(,R2)                                      0476 00881000
         LA    @08,1                                               0476 00882000
         AH    @08,EVNUM(,@14)                                     0476 00883000
         ST    @08,L                                               0476 00884000
*                  R3 = SUMSIZE1; /*LENGTH OF SYSUMONE TABLE IN BYTES*/ 00885000
         LA    R3,128                                              0477 00886000
*                  GEN(GETMAIN EC,LV=(R3),A=COMPLINK); /*GET CORE FOR*/ 00887000
         GETMAIN EC,LV=(R3),A=COMPLINK                                  00888000
*                                           /*NEW SYSUMONE ENTRY*/ 0479 00889000
*                  IF R15 = SUCCESS THEN /*IF GOOD GETMAIN   @Z427VLS*/ 00890000
         SLR   @14,@14                                             0479 00891000
         CR    R15,@14                                             0479 00892000
         BNE   @RF00479                                            0479 00893000
*                  DO;                                     /*@Z427VLS*/ 00894000
*                  IF EVNUM > ZERO THEN /*DONT SET PTR IF ONLY ENTRY*/  00895000
         L     @08,EVPTR(,R2)                                      0481 00896000
         CH    @14,EVNUM(,@08)                                     0481 00897000
         BNL   @RF00481                                            0481 00898000
*                    SYSUMNXT = COMPLINK; /*SET PTR IN OLD ENT TO NEW*/ 00899000
         L     @14,SYSUMPTR(,R2)                                   0482 00900000
         L     @08,COMPLINK                                        0482 00901000
         ST    @08,SYSUMNXT(,@14)                                  0482 00902000
*                  SYSUMPTR = COMPLINK; /*ADDRESS NEW ENTRY OF SYSUMON* 00903000
@RF00481 L     @14,COMPLINK                                        0483 00904000
         ST    @14,SYSUMPTR(,R2)                                   0483 00905000
*                  SYSUMONE = (SYSUMONE && SYSUMONE); /*CLEAR ENTRY*/   00906000
         XC    SYSUMONE(100,@14),SYSUMONE(@14)                     0484 00907000
*                  EVMODEL(L) = LRTMODEL; /*SET NEW EVTABLE ENTRY FOR*/ 00908000
         L     @14,L                                               0485 00909000
         LR    @08,@14                                             0485 00910000
         MH    @08,@CH00081                                        0485 00911000
         L     @06,EVPTR(,R2)                                      0485 00912000
         ST    @08,@TF00001                                        0485 00913000
         ALR   @08,@06                                             0485 00914000
         MVC   EVMODEL-6(2,@08),LRTMODEL(R7)                       0485 00915000
*                  EVSERIAL(L) = LRTCPUS; /*CPU IDENTIFIED AS UNIQUE*/  00916000
         LR    @08,@06                                             0486 00917000
         AL    @08,@TF00001                                        0486 00918000
         MVC   EVSERIAL-6(3,@08),LRTCPUS(R7)                       0486 00919000
*                  SAVEADR(L) = SYSUMPTR; /*SAVE ADDRESS FOR SORTING*/  00920000
         SLA   @14,2                                               0487 00921000
         L     @08,SYSUMPTR(,R2)                                   0487 00922000
         ST    @08,SAVEADR-4(@14)                                  0487 00923000
*                  EVNUM = EVNUM + 1; /*ADD 1 TO NUMBER OF ENTRIES*/    00924000
         LA    @14,1                                               0488 00925000
         AH    @14,EVNUM(,@06)                                     0488 00926000
         STH   @14,EVNUM(,@06)                                     0488 00927000
*                  END;                                    /*@Z427VLS*/ 00928000
*                  ELSE  /*IF UNSUCCESSFUL GETMAIN THEN      @Z427VLS*/ 00929000
*                    DO;                                   /*@Z427VLS*/ 00930000
         B     @RC00479                                            0490 00931000
@RF00479 DS    0H                                                  0491 00932000
*                      MSGNO = 1; /*REPORT LACK OF CORE FOR SYSTB*/     00933000
         MVI   MSGNO,X'01'                                         0491 00934000
*                      CALL ERRMSG;                        /*@Z427VLS*/ 00935000
         BAL   @14,ERRMSG                                          0492 00936000
*                      R15 = NOSRTABL;                     /*@0001VLS*/ 00937000
         LA    R15,12                                              0493 00938000
*                      GETFAIL = YES;                      /*@0001VLS*/ 00939000
         OI    GETFAIL,B'00001000'                                 0494 00940000
*                    END;                                  /*@Z427VLS*/ 00941000
*                END;                                      /*@Z427VLS*/ 00942000
*              ELSE  /*HERE WE HAVE NEW CPU WITH NO ROOM IN EVTABLE*/   00943000
*                DO;                                       /*@Z427VLS*/ 00944000
         B     @RC00474                                            0497 00945000
@RF00474 DS    0H                                                  0498 00946000
*                  BUG(13) = BUG(13) + 1; /*COUNT NMBER OF TIMES*/ 0498 00947000
         LA    @14,1                                               0498 00948000
         AL    @14,BUG+48                                          0498 00949000
         ST    @14,BUG+48                                          0498 00950000
*                  IF FIRSTIME = OFF   THEN /*PRINT ERROR MESSAGE ONLY* 00951000
         TM    FIRSTIME,B'00000100'                                0499 00952000
         BNZ   @RF00499                                            0499 00953000
*                    DO;                    /*FOR FIRST EXCESS CPU*/    00954000
*                      MSGNO = 6;                          /*@Z427VLS*/ 00955000
         MVI   MSGNO,X'06'                                         0501 00956000
*                      CALL ERRMSG;                        /*@Z427VLS*/ 00957000
         BAL   @14,ERRMSG                                          0502 00958000
*                      EVSERIAL(K) = 'FFFFFF'X;            /*@Z427VLS*/ 00959000
         L     @14,K                                               0503 00960000
         MH    @14,@CH00081                                        0503 00961000
         L     @08,EVPTR(,R2)                                      0503 00962000
         ST    @14,@TF00001                                        0503 00963000
         ALR   @14,@08                                             0503 00964000
         MVC   EVSERIAL-6(3,@14),@CB00237                          0503 00965000
*                      EVMODEL(K) = 'FFFF'X;               /*@Z427VLS*/ 00966000
         AL    @08,@TF00001                                        0504 00967000
         MVC   EVMODEL-6(2,@08),@CB00261                           0504 00968000
*                      FIRSTIME = ON;       /*NEVER TO RETURN*/    0505 00969000
         OI    FIRSTIME,B'00000100'                                0505 00970000
*                    END;                                  /*@Z427VLS*/ 00971000
*                 END;                                     /*@Z427VLS*/ 00972000
@RF00499 DS    0H                                                  0508 00973000
*               END;                                       /*@Z427VLS*/ 00974000
@RC00474 DS    0H                                                  0509 00975000
*             END;                                         /*@Z427VLS*/ 00976000
@RC00470 DS    0H                                                  0510 00977000
*         END;                                             /*@Z427VLS*/ 00978000
@RC00464 LA    @14,1                                               0510 00979000
         AL    @14,K                                               0510 00980000
         ST    @14,K                                               0510 00981000
         C     @14,@CF00034                                        0510 00982000
         BNH   @DL00463                                            0510 00983000
@DC00463 DS    0H                                                  0511 00984000
* ERROR = R15; /*COMMUNICATE BAD TIDINGS TO CALLING PROC     @Z427VLS*/ 00985000
         ST    R15,ERROR                                           0511 00986000
*RESPECIFY(R3,R15) UNRESTRICTED;                           /*@Z427VLS*/ 00987000
* END; /*CLOSING END FOR SUMONADR                            @Z427VLS*/ 00988000
@EL00007 DS    0H                                                  0513 00989000
@EF00007 DS    0H                                                  0513 00990000
@ER00007 LM    @14,@12,@SA00007                                    0513 00991000
         BR    @14                                                 0513 00992000
*SORTONE: PROC; /*SORT EVTABLE IN DESCENDING ORDER BY MODEL, SERIAL*/   00993000
SORTONE  STM   @14,@12,@SA00008                                    0514 00994000
*               /*NUMBER FOR UNSHARED CPUS AND RELINK THE NEXT     */   00995000
*               /*ENTRY POINTERS FOR TABLE SYSUMONE.         @Z427VLS*/ 00996000
*               /*SET EVLETTER FOR UNSHARED CPUS             @Z427VLS*/ 00997000
*IF NUMUNSHR < EVNUM THEN  /*IF TWO OR MORE CPUS IDENTIFIED AND    */   00998000
         LH    @08,NUMUNSHR                                        0515 00999000
         L     @06,EVPTR(,R2)                                      0515 01000000
         CH    @08,EVNUM(,@06)                                     0515 01001000
         BNL   @RF00515                                            0515 01002000
*                          /*NOT IN SHARE TABLE THEN SORT.   @Z427VLS*/ 01003000
*    DO J = NUMUNSHR BY 1 TO EVNUM - 1; /*SORT IN DESCENDING ORDER */   01004000
         ST    @08,J                                               0516 01005000
         B     @DE00516                                            0516 01006000
@DL00516 DS    0H                                                  0517 01007000
*      DO K = J+1 BY 1 TO EVNUM;                           /*@Z427VLS*/ 01008000
         AL    @08,@CF00055                                        0517 01009000
         ST    @08,K                                               0517 01010000
         B     @DE00517                                            0517 01011000
@DL00517 DS    0H                                                  0518 01012000
*        IF EVKEY(J) < EVKEY(K) THEN                               0518 01013000
         L     @06,J                                               0518 01014000
         LA    @03,6                                               0518 01015000
         LR    @05,@06                                             0518 01016000
         MR    @04,@03                                             0518 01017000
         L     @04,EVPTR(,R2)                                      0518 01018000
         LR    @15,@03                                             0518 01019000
         MR    @14,@08                                             0518 01020000
         ST    @05,@TF00001                                        0518 01021000
         ALR   @05,@04                                             0518 01022000
         ST    @15,@TF00002                                        0518 01023000
         ALR   @15,@04                                             0518 01024000
         CLC   EVKEY-6(6,@05),EVKEY-6(@15)                         0518 01025000
         BNL   @RF00518                                            0518 01026000
*          DO;                                             /*@Z427VLS*/ 01027000
*            EVKEY(J) = (EVKEY(J)   &&   EVKEY(K));        /*@Z427VLS*/ 01028000
         LR    @03,@04                                             0520 01029000
         AL    @03,@TF00001                                        0520 01030000
         LR    @05,@04                                             0520 01031000
         AL    @05,@TF00001                                        0520 01032000
         MVC   @TS00001(6),EVKEY-6(@05)                            0520 01033000
         LR    @05,@04                                             0520 01034000
         AL    @05,@TF00002                                        0520 01035000
         XC    @TS00001(6),EVKEY-6(@05)                            0520 01036000
         MVC   EVKEY-6(6,@03),@TS00001                             0520 01037000
*            EVKEY(K) = (EVKEY(K)   &&   EVKEY(J));        /*@Z427VLS*/ 01038000
         LR    @03,@04                                             0521 01039000
         AL    @03,@TF00002                                        0521 01040000
         LR    @05,@04                                             0521 01041000
         AL    @05,@TF00002                                        0521 01042000
         MVC   @TS00001(6),EVKEY-6(@05)                            0521 01043000
         LR    @05,@04                                             0521 01044000
         AL    @05,@TF00001                                        0521 01045000
         XC    @TS00001(6),EVKEY-6(@05)                            0521 01046000
         MVC   EVKEY-6(6,@03),@TS00001                             0521 01047000
*            EVKEY(J) = (EVKEY(J)   &&   EVKEY(K));        /*@Z427VLS*/ 01048000
         LR    @03,@04                                             0522 01049000
         AL    @03,@TF00001                                        0522 01050000
         LR    @05,@04                                             0522 01051000
         AL    @05,@TF00001                                        0522 01052000
         MVC   @TS00001(6),EVKEY-6(@05)                            0522 01053000
         AL    @04,@TF00002                                        0522 01054000
         XC    @TS00001(6),EVKEY-6(@04)                            0522 01055000
         MVC   EVKEY-6(6,@03),@TS00001                             0522 01056000
*            SAVEADR(J) = (SAVEADR(J)  &&  SAVEADR(K));    /*@Z427VLS*/ 01057000
         LR    @03,@06                                             0523 01058000
         SLA   @03,2                                               0523 01059000
         LR    @15,@08                                             0523 01060000
         SLA   @15,2                                               0523 01061000
         L     @00,SAVEADR-4(@03)                                  0523 01062000
         X     @00,SAVEADR-4(@15)                                  0523 01063000
         ST    @00,SAVEADR-4(@03)                                  0523 01064000
*            SAVEADR(K) = (SAVEADR(K)  &&  SAVEADR(J));    /*@Z427VLS*/ 01065000
         X     @00,SAVEADR-4(@15)                                  0524 01066000
         ST    @00,SAVEADR-4(@15)                                  0524 01067000
*            SAVEADR(J) = (SAVEADR(J)  &&  SAVEADR(K));    /*@Z427VLS*/ 01068000
         X     @00,SAVEADR-4(@03)                                  0525 01069000
         ST    @00,SAVEADR-4(@03)                                  0525 01070000
*            /*MUST NOW SHOW HOW EVTABLE HAS BEEN SORTED IN ORDER TO*/  01071000
*            /*ADJUST ENTRY POINTERS TO EVTABLE IN TABLE SYSUM2*/  0526 01072000
*            FLIP(J) = (FLIP(J) && FLIP(K));               /*@Z427VLS*/ 01073000
         SLR   @15,@15                                             0526 01074000
         IC    @15,FLIP-1(@06)                                     0526 01075000
         SLR   @14,@14                                             0526 01076000
         IC    @14,FLIP-1(@08)                                     0526 01077000
         XR    @15,@14                                             0526 01078000
         STC   @15,FLIP-1(@06)                                     0526 01079000
*            FLIP(K) = (FLIP(K) && FLIP(J));               /*@Z427VLS*/ 01080000
         SLR   @14,@14                                             0527 01081000
         IC    @14,FLIP-1(@08)                                     0527 01082000
         XR    @15,@14                                             0527 01083000
         STC   @15,FLIP-1(@08)                                     0527 01084000
*            FLIP(J) = (FLIP(J) && FLIP(K));               /*@Z427VLS*/ 01085000
         SLR   @08,@08                                             0528 01086000
         IC    @08,FLIP-1(@06)                                     0528 01087000
         XR    @15,@08                                             0528 01088000
         STC   @15,FLIP-1(@06)                                     0528 01089000
*            IF J > 1 THEN                                         0529 01090000
         C     @06,@CF00055                                        0529 01091000
         BNH   @RF00529                                            0529 01092000
*             DO;                                          /*@Z427VLS*/ 01093000
*               SYSUMPTR = SAVEADR(J-1);                   /*@Z427VLS*/ 01094000
         L     @08,SAVEADR-8(@03)                                  0531 01095000
         ST    @08,SYSUMPTR(,R2)                                   0531 01096000
*               SYSUMNXT = SAVEADR(J);                     /*@Z427VLS*/ 01097000
         ST    @00,SYSUMNXT(,@08)                                  0532 01098000
*             END;                                         /*@Z427VLS*/ 01099000
*            SYSUMPTR = SAVEADR(J);                        /*@Z427VLS*/ 01100000
@RF00529 L     @08,J                                               0534 01101000
         SLA   @08,2                                               0534 01102000
         L     @06,SAVEADR-4(@08)                                  0534 01103000
         ST    @06,SYSUMPTR(,R2)                                   0534 01104000
*            SYSUMNXT = SAVEADR(J+1);                      /*@Z427VLS*/ 01105000
         L     @08,SAVEADR(@08)                                    0535 01106000
         ST    @08,SYSUMNXT(,@06)                                  0535 01107000
*            SYSUMPTR = SAVEADR(K-1);                      /*@Z427VLS*/ 01108000
         L     @08,K                                               0536 01109000
         LR    @06,@08                                             0536 01110000
         SLA   @06,2                                               0536 01111000
         L     @03,SAVEADR-8(@06)                                  0536 01112000
         ST    @03,SYSUMPTR(,R2)                                   0536 01113000
*            SYSUMNXT = SAVEADR(K);                        /*@Z427VLS*/ 01114000
         L     @15,SAVEADR-4(@06)                                  0537 01115000
         ST    @15,SYSUMNXT(,@03)                                  0537 01116000
*            IF K < EVNUM THEN                                     0538 01117000
         L     @03,EVPTR(,R2)                                      0538 01118000
         CH    @08,EVNUM(,@03)                                     0538 01119000
         BNL   @RF00538                                            0538 01120000
*              DO;                                         /*@Z427VLS*/ 01121000
*                SYSUMPTR = SAVEADR(K);                    /*@Z427VLS*/ 01122000
         ST    @15,SYSUMPTR(,R2)                                   0540 01123000
*                SYSUMNXT = SAVEADR(K+1);                  /*@Z427VLS*/ 01124000
         L     @08,SAVEADR(@06)                                    0541 01125000
         ST    @08,SYSUMNXT(,@15)                                  0541 01126000
*              END;                                        /*@Z427VLS*/ 01127000
*            IF K = EVNUM THEN /*DONT RESET LAST ENTRY FORWARD PTR*/    01128000
@RF00538 L     @08,K                                               0543 01129000
         L     @06,EVPTR(,R2)                                      0543 01130000
         CH    @08,EVNUM(,@06)                                     0543 01131000
         BNE   @RF00543                                            0543 01132000
*              DO;                                         /*@Z427VLS*/ 01133000
*                SYSUMPTR = SAVEADR(K);                    /*@Z427VLS*/ 01134000
         SLA   @08,2                                               0545 01135000
         L     @08,SAVEADR-4(@08)                                  0545 01136000
         ST    @08,SYSUMPTR(,R2)                                   0545 01137000
*                SYSUMNXT = 0; /*LAST ENTRY CANT POINT TO ANOTHER*/     01138000
         SLR   @06,@06                                             0546 01139000
         ST    @06,SYSUMNXT(,@08)                                  0546 01140000
*              END;                                        /*@Z427VLS*/ 01141000
*          END;                                            /*@Z427VLS*/ 01142000
@RF00543 DS    0H                                                  0549 01143000
*        END;                                              /*@Z427VLS*/ 01144000
@RF00518 LA    @08,1                                               0549 01145000
         AL    @08,K                                               0549 01146000
         ST    @08,K                                               0549 01147000
@DE00517 L     @06,EVPTR(,R2)                                      0549 01148000
         CH    @08,EVNUM(,@06)                                     0549 01149000
         BNH   @DL00517                                            0549 01150000
*     END;                                                 /*@Z427VLS*/ 01151000
         LA    @08,1                                               0550 01152000
         AL    @08,J                                               0550 01153000
         ST    @08,J                                               0550 01154000
@DE00516 L     @06,EVPTR(,R2)                                      0550 01155000
         LH    @06,EVNUM(,@06)                                     0550 01156000
         BCTR  @06,0                                               0550 01157000
         CR    @08,@06                                             0550 01158000
         BNH   @DL00516                                            0550 01159000
* CALL SUMTHEM; /*ADD TO SUMMARY COLUMN OF SYSUMONE          @Z427VLS*/ 01160000
@RF00515 BAL   @14,SUMTHEM                                         0551 01161000
*END; /*CLOSING END TO PROC SORTONE                          @Z427VLS*/ 01162000
@EL00008 DS    0H                                                  0552 01163000
@EF00008 DS    0H                                                  0552 01164000
@ER00008 LM    @14,@12,@SA00008                                    0552 01165000
         BR    @14                                                 0552 01166000
*SUMTHEM: PROC; /*SET SUMMARY COLUMN OF SYSUMONE AND LINK IT AS THE*/   01167000
SUMTHEM  STM   @14,@12,12(@13)                                     0553 01168000
*               /*FIRST ENTRY OF THE TABLE. SET EVLETTER FOR THOSE*/    01169000
*               /*ENTRIES IN WHICH IT IS UNSET               @Z427VLS*/ 01170000
*IF NUMUNSHR < EVNUM + 1 THEN  /*IF SOME EVLETTERS REMAIN UNSET*/  0554 01171000
         LH    @08,NUMUNSHR                                        0554 01172000
         L     @06,EVPTR(,R2)                                      0554 01173000
         LA    @03,1                                               0554 01174000
         AH    @03,EVNUM(,@06)                                     0554 01175000
         CR    @08,@03                                             0554 01176000
         BNL   @RF00554                                            0554 01177000
*  DO J = NUMUNSHR BY 1 TO EVNUM;                          /*@Z427VLS*/ 01178000
         ST    @08,J                                               0555 01179000
         B     @DE00555                                            0555 01180000
@DL00555 DS    0H                                                  0556 01181000
*    EVLETTER(J) = EVCON(J); /*GET APPROPRIATE NEXT CONSECUTIVE LETTR*/ 01182000
         LR    @06,@08                                             0556 01183000
         MH    @06,@CH00081                                        0556 01184000
         L     @03,EVPTR(,R2)                                      0556 01185000
         ALR   @03,@06                                             0556 01186000
         LA    @06,EVCON-1(@08)                                    0556 01187000
         MVC   EVLETTER-6(1,@03),0(@06)                            0556 01188000
*  END;                                                    /*@Z427VLS*/ 01189000
         AL    @08,@CF00055                                        0557 01190000
         ST    @08,J                                               0557 01191000
@DE00555 L     @06,EVPTR(,R2)                                      0557 01192000
         CH    @08,EVNUM(,@06)                                     0557 01193000
         BNH   @DL00555                                            0557 01194000
*/* ADD ALL CPU ENTRIES TO THE SUMMARY COLUMN ENTRY          @Z427VLS*/ 01195000
*  SYSUMPTR = SAVEADR(1); /*ADDRESS 1ST SYSUMONE ENTRY       @Z427VLS*/ 01196000
@RF00554 L     @08,SAVEADR                                         0558 01197000
         ST    @08,SYSUMPTR(,R2)                                   0558 01198000
*DO J = 1 BY 1 TO EVNUM;                                   /*@Z427VLS*/ 01199000
         LA    @08,1                                               0559 01200000
         ST    @08,J                                               0559 01201000
         B     @DE00559                                            0559 01202000
@DL00559 DS    0H                                                  0560 01203000
*  SYSUMNUM = EVNUM + 1; /*NUMBER OF ENTRIES INTO PARTICULAR ENTRY*/    01204000
         L     @08,SYSUMPTR(,R2)                                   0560 01205000
         LA    @06,1                                               0560 01206000
         L     @03,EVPTR(,R2)                                      0560 01207000
         LH    @03,EVNUM(,@03)                                     0560 01208000
         ALR   @03,@06                                             0560 01209000
         ST    @03,SYSUMNUM(,@08)                                  0560 01210000
*  STSUMIPL = STSUMIPL + SYSUMIPL; /*ADD IPL COUNTER         @Z427VLS*/ 01211000
         L     @03,STSUMPTR                                        0561 01212000
         L     @00,STSUMIPL(,@03)                                  0561 01213000
         AL    @00,SYSUMIPL(,@08)                                  0561 01214000
         ST    @00,STSUMIPL(,@03)                                  0561 01215000
*  STSUMMCR = STSUMMCR + SYSUMMCR; /*ADD MCH RECOVERABLE COUNTER*/ 0562 01216000
         L     @00,STSUMMCR(,@03)                                  0562 01217000
         AL    @00,SYSUMMCR(,@08)                                  0562 01218000
         ST    @00,STSUMMCR(,@03)                                  0562 01219000
*  STSUMMCN = STSUMMCN + SYSUMMCN; /*ADD MCH NON-RECOVERABLE COUNTER*/  01220000
         L     @00,STSUMMCN(,@03)                                  0563 01221000
         AL    @00,SYSUMMCN(,@08)                                  0563 01222000
         ST    @00,STSUMMCN(,@03)                                  0563 01223000
*  STSUMPEI = STSUMPEI + SYSUMPEI; /*ADD PGM INTERRUPT COUNTER*/   0564 01224000
         L     @00,STSUMPEI(,@03)                                  0564 01225000
         AL    @00,SYSUMPEI(,@08)                                  0564 01226000
         ST    @00,STSUMPEI(,@03)                                  0564 01227000
*  STSUMPEA = STSUMPEA + SYSUMPEA; /*ADD PGM ABEND COUNTER   @Z427VLS*/ 01228000
         L     @00,STSUMPEA(,@03)                                  0565 01229000
         AL    @00,SYSUMPEA(,@08)                                  0565 01230000
         ST    @00,STSUMPEA(,@03)                                  0565 01231000
*  STSUMPER = STSUMPER + SYSUMPER; /*ADD PGM RESTART COUNTER @Z427VLS*/ 01232000
         L     @00,STSUMPER(,@03)                                  0566 01233000
         AL    @00,SYSUMPER(,@08)                                  0566 01234000
         ST    @00,STSUMPER(,@03)                                  0566 01235000
*  STSUMEOD = STSUMEOD + SYSUMEOD; /*ADD EOD COUNTER         @Z427VLS*/ 01236000
         L     @00,STSUMEOD(,@03)                                  0567 01237000
         AL    @00,SYSUMEOD(,@08)                                  0567 01238000
         ST    @00,STSUMEOD(,@03)                                  0567 01239000
*  DO K = 1 BY 1 TO 16; /*LOOP THROUGH ALL POSSIBLE CHANNELS @Z427VLS*/ 01240000
         ST    @06,K                                               0568 01241000
@DL00568 DS    0H                                                  0569 01242000
*    STSUMCH(K) = STSUMCH(K) + SYSUMCH(K); /*ADD CHANNEL X TO CTR*/     01243000
         L     @08,STSUMPTR                                        0569 01244000
         LR    @03,@06                                             0569 01245000
         SLA   @03,2                                               0569 01246000
         L     @15,SYSUMPTR(,R2)                                   0569 01247000
         L     @00,STSUMCH-4(@03,@08)                              0569 01248000
         AL    @00,SYSUMCH-4(@03,@15)                              0569 01249000
         ST    @00,STSUMCH-4(@03,@08)                              0569 01250000
*  END;                                                    /*@Z427VLS*/ 01251000
         AL    @06,@CF00055                                        0570 01252000
         ST    @06,K                                               0570 01253000
         C     @06,@CF00088                                        0570 01254000
         BNH   @DL00568                                            0570 01255000
*  SYSUMPTR = SYSUMNXT; /*UPDATE SYSUMONE ENTRY ADDRESS      @Z427VLS*/ 01256000
         L     @08,SYSUMPTR(,R2)                                   0571 01257000
         L     @08,SYSUMNXT(,@08)                                  0571 01258000
         ST    @08,SYSUMPTR(,R2)                                   0571 01259000
*END;                                                      /*@Z427VLS*/ 01260000
         LA    @08,1                                               0572 01261000
         AL    @08,J                                               0572 01262000
         ST    @08,J                                               0572 01263000
@DE00559 L     @06,EVPTR(,R2)                                      0572 01264000
         CH    @08,EVNUM(,@06)                                     0572 01265000
         BNH   @DL00559                                            0572 01266000
*/* LINK STSUMONE, SUMMARY COLUMN TO THE FIRST ENTRY OF SYSUMONE*/ 0573 01267000
*SYSUMPTR = STSUMPTR; /*ADDRESS SUMMARY COLUMN AS FIRST SYSUMONE ENTRY* 01268000
         L     @08,STSUMPTR                                        0573 01269000
         ST    @08,SYSUMPTR(,R2)                                   0573 01270000
*SYSUMNXT = SAVEADR(1); /*POINT TO FIRST CPU ENTRY           @Z427VLS*/ 01271000
         L     @06,SAVEADR                                         0574 01272000
         ST    @06,SYSUMNXT(,@08)                                  0574 01273000
*SYSUMNUM = EVNUM + 1; /*NUMBER OF CPUS PLUS SUMMARY COLUMN  @Z427VLS*/ 01274000
         L     @06,EVPTR(,R2)                                      0575 01275000
         LA    @03,1                                               0575 01276000
         AH    @03,EVNUM(,@06)                                     0575 01277000
         ST    @03,SYSUMNUM(,@08)                                  0575 01278000
*END; /*CLOSING END FOR SUMTHEM                              @Z427VLS*/ 01279000
@EL00009 DS    0H                                                  0576 01280000
@EF00009 DS    0H                                                  0576 01281000
@ER00009 LM    @14,@12,12(@13)                                     0576 01282000
         BR    @14                                                 0576 01283000
*SORTSHAR: PROC;        /* SORT SHARE TABLE CPU BY LETTER  @ZA17692 */  01284000
SORTSHAR STM   @14,@12,12(@13)                                     0577 01285000
*  DO J=1 BY 1 TO SHARENUM-1;                           /* @ZA17692 */  01286000
         LA    @08,1                                               0578 01287000
         ST    @08,J                                               0578 01288000
         B     @DE00578                                            0578 01289000
@DL00578 DS    0H                                                  0579 01290000
*    DO K= J+1 BY 1 TO SHARENUM;                        /* @ZA17692 */  01291000
         AL    @08,@CF00055                                        0579 01292000
         ST    @08,K                                               0579 01293000
         B     @DE00579                                            0579 01294000
@DL00579 DS    0H                                                  0580 01295000
*      IF SHARLET(J) > SHARLET(K)  THEN               /* @ZA17692 */    01296000
         L     @06,J                                               0580 01297000
         SLA   @06,4                                               0580 01298000
         L     @03,SHAREPTR(,R2)                                   0580 01299000
         SLA   @08,4                                               0580 01300000
         ST    @06,@TF00001                                        0580 01301000
         ALR   @06,@03                                             0580 01302000
         ST    @08,@TF00002                                        0580 01303000
         ALR   @08,@03                                             0580 01304000
         CLC   SHARLET-16(1,@06),SHARLET-16(@08)                   0580 01305000
         BNH   @RF00580                                            0580 01306000
*        DO;                                            /* @ZA17692 */  01307000
*          SHAREIO(J)=(SHAREIO(J)&&SHAREIO(K));         /* @ZA17692 */  01308000
         LR    @08,@03                                             0582 01309000
         AL    @08,@TF00001                                        0582 01310000
         AL    @08,@CF01392                                        0582 01311000
         LR    @06,@03                                             0582 01312000
         AL    @06,@TF00001                                        0582 01313000
         AL    @06,@CF01392                                        0582 01314000
         MVC   @TS00001(16),SHAREIO-2(@06)                         0582 01315000
         LR    @06,@03                                             0582 01316000
         AL    @06,@TF00002                                        0582 01317000
         AL    @06,@CF01392                                        0582 01318000
         XC    @TS00001(16),SHAREIO-2(@06)                         0582 01319000
         MVC   SHAREIO-2(16,@08),@TS00001                          0582 01320000
*          SHAREIO(K)=(SHAREIO(K)&&SHAREIO(J));         /* @ZA17692 */  01321000
         LR    @08,@03                                             0583 01322000
         AL    @08,@TF00002                                        0583 01323000
         AL    @08,@CF01392                                        0583 01324000
         LR    @06,@03                                             0583 01325000
         AL    @06,@TF00002                                        0583 01326000
         AL    @06,@CF01392                                        0583 01327000
         MVC   @TS00001(16),SHAREIO-2(@06)                         0583 01328000
         LR    @06,@03                                             0583 01329000
         AL    @06,@TF00001                                        0583 01330000
         AL    @06,@CF01392                                        0583 01331000
         XC    @TS00001(16),SHAREIO-2(@06)                         0583 01332000
         MVC   SHAREIO-2(16,@08),@TS00001                          0583 01333000
*          SHAREIO(J)=(SHAREIO(J)&&SHAREIO(K));         /* @ZA17692 */  01334000
         LR    @08,@03                                             0584 01335000
         AL    @08,@TF00001                                        0584 01336000
         AL    @08,@CF01392                                        0584 01337000
         LR    @06,@03                                             0584 01338000
         AL    @06,@TF00001                                        0584 01339000
         AL    @06,@CF01392                                        0584 01340000
         MVC   @TS00001(16),SHAREIO-2(@06)                         0584 01341000
         AL    @03,@TF00002                                        0584 01342000
         AL    @03,@CF01392                                        0584 01343000
         XC    @TS00001(16),SHAREIO-2(@03)                         0584 01344000
         MVC   SHAREIO-2(16,@08),@TS00001                          0584 01345000
*        END;                                           /* @ZA17692 */  01346000
*     END;                                              /* @ZA17692 */  01347000
@RF00580 LA    @08,1                                               0586 01348000
         AL    @08,K                                               0586 01349000
         ST    @08,K                                               0586 01350000
@DE00579 L     @06,SHAREPTR(,R2)                                   0586 01351000
         CH    @08,SHARENUM(,@06)                                  0586 01352000
         BNH   @DL00579                                            0586 01353000
*  END;                                                 /* @ZA17692 */  01354000
         LA    @08,1                                               0587 01355000
         AL    @08,J                                               0587 01356000
         ST    @08,J                                               0587 01357000
@DE00578 L     @06,SHAREPTR(,R2)                                   0587 01358000
         LH    @06,SHARENUM(,@06)                                  0587 01359000
         BCTR  @06,0                                               0587 01360000
         CR    @08,@06                                             0587 01361000
         BNH   @DL00578                                            0587 01362000
*END;                       /*  CLOSING END FOR SORTSHAR   @ZA17692 */  01363000
@EL00010 DS    0H                                                  0588 01364000
@EF00010 DS    0H                                                  0588 01365000
@ER00010 LM    @14,@12,12(@13)                                     0588 01366000
         BR    @14                                                 0588 01367000
* RECDEP: PROC; /*IDENTIFY RECORD TYPE AND ACCUMULATE RECORD OR*/  0589 01368000
RECDEP   STM   @14,@12,@SA00011                                    0589 01369000
*               /*APPROPRIATE ERRORS IN SYSUMONE OR SYSUM2   @Z427VLS*/ 01370000
* WORKTYPE = (LRTKEY1 & GENREC);                           /*@Z427VLS*/ 01371000
         MVC   WORKTYPE(1),LRTKEY1(R7)                             0590 01372000
         NI    WORKTYPE,X'F0'                                      0590 01373000
* IF LRTRUNC = ON | (WORKTYPE < HEX10)                             0591 01374000
*                 | (WORKTYPE > HEX90) THEN                        0591 01375000
         TM    LRTRUNC(R7),B'00100000'                             0591 01376000
         BO    @RT00591                                            0591 01377000
         CLI   WORKTYPE,X'10'                                      0591 01378000
         BL    @RT00591                                            0591 01379000
         CLI   WORKTYPE,X'90'                                      0591 01380000
         BNH   @RF00591                                            0591 01381000
@RT00591 DS    0H                                                  0592 01382000
*   BUG(1) = BUG(1) + 1;                                   /*@Z427VLS*/ 01383000
         LA    @08,1                                               0592 01384000
         AL    @08,BUG                                             0592 01385000
         ST    @08,BUG                                             0592 01386000
* ELSE                                                             0593 01387000
*   DO;                                                    /*@Z427VLS*/ 01388000
         B     @RC00591                                            0593 01389000
@RF00591 DS    0H                                                  0594 01390000
*     IF WORKTYPE = HEX30 | WORKTYPE = HEX90 THEN /*OBR OR MDR REC.*/   01391000
         CLI   WORKTYPE,X'30'                                      0594 01392000
         BE    @RT00594                                            0594 01393000
         CLI   WORKTYPE,X'90'                                      0594 01394000
         BNE   @RF00594                                            0594 01395000
@RT00594 DS    0H                                                  0595 01396000
*       CALL CONTERR;                                      /*@Z427VLS*/ 01397000
         BAL   @14,CONTERR                                         0595 01398000
*     ELSE                                                         0596 01399000
*       DO;                                                /*@Z427VLS*/ 01400000
         B     @RC00594                                            0596 01401000
@RF00594 DS    0H                                                  0597 01402000
*         IF WORKTYPE = HEX40 THEN                                 0597 01403000
         CLI   WORKTYPE,X'40'                                      0597 01404000
         BNE   @RF00597                                            0597 01405000
*           DO;                                            /*@Z427VLS*/ 01406000
*             CALL SUMONADR;                               /*@Z427VLS*/ 01407000
         BAL   @14,SUMONADR                                        0599 01408000
*             CALL SOFTFILT;                               /*@Z427VLS*/ 01409000
         BAL   @14,SOFTFILT                                        0600 01410000
*           END;                                           /*@Z427VLS*/ 01411000
*         ELSE                                                     0602 01412000
*           DO;                                            /*@Z427VLS*/ 01413000
         B     @RC00597                                            0602 01414000
@RF00597 DS    0H                                                  0603 01415000
*             IF WORKTYPE = HEX10 THEN                             0603 01416000
         CLI   WORKTYPE,X'10'                                      0603 01417000
         BNE   @RF00603                                            0603 01418000
*               DO;                                        /*@Z427VLS*/ 01419000
*                 CALL SUMONADR;                           /*@Z427VLS*/ 01420000
         BAL   @14,SUMONADR                                        0605 01421000
*                 CALL MCHFILT;                            /*@Z427VLS*/ 01422000
         BAL   @14,MCHFILT                                         0606 01423000
*                 BUG(3) = BUG(3) + 1;                     /*@Z427VLS*/ 01424000
         LA    @08,1                                               0607 01425000
         AL    @08,BUG+8                                           0607 01426000
         ST    @08,BUG+8                                           0607 01427000
*               END;                                       /*@Z427VLS*/ 01428000
*             ELSE                                                 0609 01429000
*               DO;                                        /*@Z427VLS*/ 01430000
         B     @RC00603                                            0609 01431000
@RF00603 DS    0H                                                  0610 01432000
*                 IF WORKTYPE = HEX20 THEN                         0610 01433000
         CLI   WORKTYPE,X'20'                                      0610 01434000
         BNE   @RF00610                                            0610 01435000
*                   DO;                                    /*@Z427VLS*/ 01436000
*                     CALL SUMONADR;                       /*@Z427VLS*/ 01437000
         BAL   @14,SUMONADR                                        0612 01438000
*                     SYSUMCH(WORKCHAN+1) = SYSUMCH(WORKCHAN+1) + 1;    01439000
         SLR   @08,@08                                             0613 01440000
         IC    @08,WORKCHAN(,R7)                                   0613 01441000
         SLA   @08,2                                               0613 01442000
         L     @06,SYSUMPTR(,R2)                                   0613 01443000
         LA    @03,1                                               0613 01444000
         L     @00,SYSUMCH(@08,@06)                                0613 01445000
         ALR   @00,@03                                             0613 01446000
         ST    @00,SYSUMCH(@08,@06)                                0613 01447000
*                     BUG(4) = BUG(4) + 1;                 /*@Z427VLS*/ 01448000
         L     @08,BUG+12                                          0614 01449000
         ALR   @08,@03                                             0614 01450000
         ST    @08,BUG+12                                          0614 01451000
*                      IF FRAMEPTR ^= ZERO THEN /*IF FRAMETAB ALLOC*/   01452000
         L     @08,FRAMEPTR(,R2)                                   0615 01453000
         LTR   @08,@08                                             0615 01454000
         BZ    @RF00615                                            0615 01455000
*                      DO;                                 /*@G51DGBB*/ 01456000
*                      GETOUT = NO;                        /*@G51DGBB*/ 01457000
         NI    GETOUT,B'11110111'                                  0617 01458000
*                      DO A = 1 BY 1 TO MRDNUMBR WHILE GETOUT = NO;     01459000
         ST    @03,A                                               0618 01460000
         B     @DE00618                                            0618 01461000
@DL00618 TM    GETOUT,B'00001000'                                  0618 01462000
         BNZ   @DC00618                                            0618 01463000
*                      /*LOOP THROUGH LIST OF MERIDIAN-LIKE CPUS*/ 0619 01464000
*                      IF MODEL(A) = LRTMODEL THEN /*IF MERID-LIKE */   01465000
         ALR   @03,@03                                             0619 01466000
         L     @08,MERDCPTR(,R2)                                   0619 01467000
         ALR   @08,@03                                             0619 01468000
         CLC   MODEL-2(2,@08),LRTMODEL(R7)                         0619 01469000
         BNE   @RF00619                                            0619 01470000
*                        DO;                               /*@G51DGBB*/ 01471000
*                          CALL BUILDFTB; /*SEE IF UNIQUE,BUILD IF IS*/ 01472000
         BAL   @14,BUILDFTB                                        0621 01473000
*                          GETOUT = YES;  /*EXIT LOOP        @G51DGBB*/ 01474000
         OI    GETOUT,B'00001000'                                  0622 01475000
*                        END;                              /*@G51DGBB*/ 01476000
*                      END;                                /*@G51DGBB*/ 01477000
@RF00619 LA    @03,1                                               0624 01478000
         AL    @03,A                                               0624 01479000
         ST    @03,A                                               0624 01480000
@DE00618 L     @08,MERDCPTR(,R2)                                   0624 01481000
         CH    @03,MRDNUMBR(,@08)                                  0624 01482000
         BNH   @DL00618                                            0624 01483000
@DC00618 DS    0H                                                  0625 01484000
*                      END;                                /*@G51DGBB*/ 01485000
*                   END;                                   /*@Z427VLS*/ 01486000
*                 ELSE                                             0627 01487000
*                   DO;                                    /*@Z427VLS*/ 01488000
         B     @RC00610                                            0627 01489000
@RF00610 DS    0H                                                  0628 01490000
*                     IF WORKTYPE = HEX50 THEN                     0628 01491000
         CLI   WORKTYPE,X'50'                                      0628 01492000
         BNE   @RF00628                                            0628 01493000
*                       DO;                                /*@Z427VLS*/ 01494000
*                         CALL SUMONADR;                   /*@Z427VLS*/ 01495000
         BAL   @14,SUMONADR                                        0630 01496000
*                         SYSUMIPL = SYSUMIPL + 1;         /*@Z427VLS*/ 01497000
         L     @08,SYSUMPTR(,R2)                                   0631 01498000
         LA    @06,1                                               0631 01499000
         L     @03,SYSUMIPL(,@08)                                  0631 01500000
         ALR   @03,@06                                             0631 01501000
         ST    @03,SYSUMIPL(,@08)                                  0631 01502000
*                         BUG(5) = BUG(5) + 1;             /*@Z427VLS*/ 01503000
         AL    @06,BUG+16                                          0632 01504000
         ST    @06,BUG+16                                          0632 01505000
*                       END;                               /*@Z427VLS*/ 01506000
*                     ELSE                                         0634 01507000
*                       DO;                                /*@Z427VLS*/ 01508000
         B     @RC00628                                            0634 01509000
@RF00628 DS    0H                                                  0635 01510000
*                         IF WORKTYPE = HEX80 THEN                 0635 01511000
         CLI   WORKTYPE,X'80'                                      0635 01512000
         BNE   @RF00635                                            0635 01513000
*                           DO;                            /*@Z427VLS*/ 01514000
*                             CALL SUMONADR;               /*@Z427VLS*/ 01515000
         BAL   @14,SUMONADR                                        0637 01516000
*                             SYSUMEOD = SYSUMEOD + 1;     /*@Z427VLS*/ 01517000
         L     @08,SYSUMPTR(,R2)                                   0638 01518000
         LA    @06,1                                               0638 01519000
         L     @03,SYSUMEOD(,@08)                                  0638 01520000
         ALR   @03,@06                                             0638 01521000
         ST    @03,SYSUMEOD(,@08)                                  0638 01522000
*                             BUG(6) = BUG(6) + 1;         /*@Z427VLS*/ 01523000
         AL    @06,BUG+20                                          0639 01524000
         ST    @06,BUG+20                                          0639 01525000
*                           END;                           /*@Z427VLS*/ 01526000
*                         ELSE /*VALID RECORD BUT NOT USED   @Z427VLS*/ 01527000
*                           BUG(8) = BUG(8) + 1;           /*@Z427VLS*/ 01528000
         B     @RC00635                                            0641 01529000
@RF00635 LA    @08,1                                               0641 01530000
         AL    @08,BUG+28                                          0641 01531000
         ST    @08,BUG+28                                          0641 01532000
*                       END;                               /*@Z427VLS*/ 01533000
*                   END;                                   /*@Z427VLS*/ 01534000
*               END;                                       /*@Z427VLS*/ 01535000
*           END;                                           /*@Z427VLS*/ 01536000
*       END;                                               /*@Z427VLS*/ 01537000
*   END;                                                   /*@Z427VLS*/ 01538000
*END; /*CLOSING END FOR RECDEP                               @Z427VLS*/ 01539000
@EL00011 DS    0H                                                  0648 01540000
@EF00011 DS    0H                                                  0648 01541000
@ER00011 LM    @14,@12,@SA00011                                    0648 01542000
         BR    @14                                                 0648 01543000
*CONTERR: PROC; /*DETERMINE IF OBR OR MDR REPRESENTS PERMANENT */  0649 01544000
CONTERR  STM   @14,@12,@SA00012                                    0649 01545000
*               /*AND/OR TEMPORARY ERRORS. IF YES, SAVE ERROR  */  0650 01546000
*               /*COUNTS IN SYSUM2                           @Z427VLS*/ 01547000
* IF PASSFLAG = ON THEN                                            0650 01548000
         TM    PASSFLAG(R2),B'00000001'                            0650 01549000
         BNO   @RF00650                                            0650 01550000
*   DO;                                                    /*@D3506GB*/ 01551000
* IF CUAPTR ^= ZERO THEN                                           0652 01552000
         L     @08,CUAPTR(,R2)                                     0652 01553000
         LTR   @08,@08                                             0652 01554000
         BZ    @RF00652                                            0652 01555000
*   CALL CUASELCT;                                         /*@D35UGGB*/ 01556000
         BAL   @14,CUASELCT                                        0653 01557000
* IF DEVPTR ^= ZERO THEN                                           0654 01558000
@RF00652 L     @08,DEVPTR(,R2)                                     0654 01559000
         LTR   @08,@08                                             0654 01560000
         BZ    @RF00654                                            0654 01561000
*   CALL DEVSEL;                                           /*@D35UGGB*/ 01562000
         BAL   @14,DEVSEL                                          0655 01563000
* IF PASSFLAG = ON THEN                                            0656 01564000
@RF00654 TM    PASSFLAG(R2),B'00000001'                            0656 01565000
         BNO   @RF00656                                            0656 01566000
*   DO;                                                    /*@D35UGGB*/ 01567000
*IF WORKTYPE = HEX30 THEN                                          0658 01568000
         CLI   WORKTYPE,X'30'                                      0658 01569000
         BNE   @RF00658                                            0658 01570000
*  CALL COUNTOBR;                                          /*@Z427VLS*/ 01571000
         BAL   @14,COUNTOBR                                        0659 01572000
*ELSE                                                              0660 01573000
*  DO;                                                     /*@Z427VLS*/ 01574000
         B     @RC00658                                            0660 01575000
@RF00658 DS    0H                                                  0661 01576000
*    IF LRTKEY1 = HEX91 & (TPRDEV = DV3705 | TPRDEV = DV3705A) THEN     01577000
         CLI   LRTKEY1(R7),X'91'                                   0661 01578000
         BNE   @RF00661                                            0661 01579000
         CLI   TPRDEV(R7),X'05'                                    0661 01580000
         BE    @RT00661                                            0661 01581000
         CLI   TPRDEV(R7),X'15'                                    0661 01582000
         BNE   @RF00661                                            0661 01583000
@RT00661 DS    0H                                                  0662 01584000
*      CALL CONTMDR;                                       /*@Z427VLS*/ 01585000
         BAL   @14,CONTMDR                                         0662 01586000
*    ELSE /*MDR NOT TYPE 91 AND DEVICE TYPE 3705             @Z427VLS*/ 01587000
*      DO;                                                 /*@Z427VLS*/ 01588000
         B     @RC00661                                            0663 01589000
@RF00661 DS    0H                                                  0664 01590000
*        BUG(23) = BUG(23) + 1;                            /*@Z427VLS*/ 01591000
         LA    @08,1                                               0664 01592000
         AL    @08,BUG+88                                          0664 01593000
         ST    @08,BUG+88                                          0664 01594000
*        IF TPRDEV = DV3330 |                                      0665 01595000
*           TPRDEV = DV3340 |                                      0665 01596000
*    (TPRDEV >='16'X & TPRDEV <= '1F'X) |  /*FBA RANGE       @D35UGGB*/ 01597000
*           TPRDEV = DV33302 |                                     0665 01598000
*           TPRDEV = DV3350 THEN                                   0665 01599000
         CLI   TPRDEV(R7),X'01'                                    0665 01600000
         BE    @RT00665                                            0665 01601000
         CLI   TPRDEV(R7),X'09'                                    0665 01602000
         BE    @RT00665                                            0665 01603000
         CLI   TPRDEV(R7),X'16'                                    0665 01604000
         BL    @GL00016                                            0665 01605000
         CLI   TPRDEV(R7),X'1F'                                    0665 01606000
         BNH   @RT00665                                            0665 01607000
@GL00016 CLI   TPRDEV(R7),X'0A'                                    0665 01608000
         BE    @RT00665                                            0665 01609000
         CLI   TPRDEV(R7),X'11'                                    0665 01610000
         BNE   @RF00665                                            0665 01611000
@RT00665 DS    0H                                                  0666 01612000
* DO;                                                      /*@D35UGGB*/ 01613000
*   IF TPRDEV < '16'X  | TPRDEV  > '1F'X THEN /*FBA RANGE    @D35UGGB*/ 01614000
         CLI   TPRDEV(R7),X'16'                                    0667 01615000
         BL    @RT00667                                            0667 01616000
         CLI   TPRDEV(R7),X'1F'                                    0667 01617000
         BNH   @RF00667                                            0667 01618000
@RT00667 DS    0H                                                  0668 01619000
*            SYSTEMP  = SYSTEMP  /*ADD CORRECTIBLE DATA CHECKS*/   0668 01620000
*                       + TPRS1213   /*AND RETRY DATA CHECKS AND*/ 0668 01621000
*                       + TPRS1415   /*SEEK CHECKS           @Z427VLS*/ 01622000
*                       + TPRS19;                          /*@Z427VLS*/ 01623000
         LA    @08,TPRVOL(,R7)                                     0668 01624000
         LA    @06,15                                              0668 01625000
         SLR   @03,@03                                             0668 01626000
         IC    @03,TPRBUFC(,R7)                                    0668 01627000
         NR    @06,@03                                             0668 01628000
         ALR   @08,@06                                             0668 01629000
         AL    @08,@CF01185                                        0668 01630000
         ICM   @06,15,SYSTEMP                                      0668 01631000
         SLR   @03,@03                                             0668 01632000
         ICM   @03,3,TPRS1213(@08)                                 0668 01633000
         ALR   @06,@03                                             0668 01634000
         SLR   @03,@03                                             0668 01635000
         ICM   @03,3,TPRS1415(@08)                                 0668 01636000
         ALR   @06,@03                                             0668 01637000
         SLR   @03,@03                                             0668 01638000
         IC    @03,TPRS19(,@08)                                    0668 01639000
         ALR   @06,@03                                             0668 01640000
         STCM  @06,15,SYSTEMP                                      0668 01641000
* ELSE                                                             0669 01642000
*   SYSTEMP = SYSTEMP + BYTE21 + BYTE13+ BYT1112 + BYTE18; /*@D3505GB*/ 01643000
         B     @RC00667                                            0669 01644000
@RF00667 LA    @08,TPRVOL(,R7)                                     0669 01645000
         LA    @06,15                                              0669 01646000
         SLR   @03,@03                                             0669 01647000
         IC    @03,TPRBUFC(,R7)                                    0669 01648000
         NR    @06,@03                                             0669 01649000
         ALR   @08,@06                                             0669 01650000
         AL    @08,@CF00786                                        0669 01651000
         ICM   @06,15,SYSTEMP                                      0669 01652000
         SLR   @03,@03                                             0669 01653000
         IC    @03,BYTE21(,@08)                                    0669 01654000
         ALR   @06,@03                                             0669 01655000
         SLR   @03,@03                                             0669 01656000
         IC    @03,BYTE13(,@08)                                    0669 01657000
         ALR   @06,@03                                             0669 01658000
         SLR   @03,@03                                             0669 01659000
         ICM   @03,3,BYT1112(@08)                                  0669 01660000
         ALR   @06,@03                                             0669 01661000
         SLR   @03,@03                                             0669 01662000
         IC    @03,BYTE18(,@08)                                    0669 01663000
         ALR   @06,@03                                             0669 01664000
         STCM  @06,15,SYSTEMP                                      0669 01665000
*            IF SYSTEMP  > ZERO THEN                               0670 01666000
@RC00667 ICM   @08,15,SYSTEMP                                      0670 01667000
         BNP   @RF00670                                            0670 01668000
*              DO;                                         /*@Z427VLS*/ 01669000
*                WORKCUA = (TPRCUA & ONLYCUA2);            /*@Z427VLS*/ 01670000
         MVC   WORKCUA(2),TPRCUA(R7)                               0672 01671000
         NC    WORKCUA(2),@CB00951                                 0672 01672000
*                BUG(24) = BUG(24) + 1;                    /*@Z427VLS*/ 01673000
         LA    @08,1                                               0673 01674000
         AL    @08,BUG+92                                          0673 01675000
         ST    @08,BUG+92                                          0673 01676000
*                SYSGROUP  = TWO; /*DASDI DEVICE GROUP     @Z427VLS*/   01677000
         MVI   SYSGROUP,X'02'                                      0674 01678000
*                SYSRT  = (TPRCUA & ONLYCUA2);           /*@Z427VLS*/   01679000
         MVC   SYSRT(2),TPRCUA(R7)                                 0675 01680000
         NC    SYSRT(2),@CB00951                                   0675 01681000
*           RECCPU=LRTCPUS;            /*SAVE CPU ID NUMBER  @D3506GB*/ 01682000
         MVC   RECCPU(3),LRTCPUS(R7)                               0676 01683000
*           LINKDEV = LINKDEV && LINKDEV;                  /*@D3506GB*/ 01684000
         XC    LINKDEV(4),LINKDEV                                  0677 01685000
*           CALL IFCDEVIC (13,TPRDEV,LINKDEV);             /*@D3506GB*/ 01686000
         MVC   @AL00001(12),@AL00678                               0678 01687000
         LA    @08,TPRDEV(,R7)                                     0678 01688000
         ST    @08,@AL00001+4                                      0678 01689000
         L     @15,@CV01431                                        0678 01690000
         LA    @01,@AL00001                                        0678 01691000
         BALR  @14,@15                                             0678 01692000
*           SYSDEV = DEVLABEL;                             /*@D3506GB*/ 01693000
         MVC   SYSDEV(2),DEVLABEL                                  0679 01694000
*                CALL SETCPU;                              /*@Z427VLS*/ 01695000
         BAL   @14,SETCPU                                          0680 01696000
*                CALL CONVCNTR;  /* SHARE/CONTROLLER       /*@D3506GB*/ 01697000
         BAL   @14,CONVCNTR                                        0681 01698000
*              END;                                        /*@Z427VLS*/ 01699000
*          END;                                            /*@Z427VLS*/ 01700000
*        ELSE /*NOT 33XX OR OR 3705 VALID MDR                @Z427VLS*/ 01701000
*          IF TPRDEV = '40'X THEN                                  0684 01702000
         B     @RC00665                                            0684 01703000
@RF00665 CLI   TPRDEV(R7),X'40'                                    0684 01704000
         BNE   @RF00684                                            0684 01705000
*            DO WORKCUA = (TPRCUA & ONLYCUA2);             /*@D3503VS*/ 01706000
         LA    @08,4095                                            0685 01707000
         LH    @06,TPRCUA(,R7)                                     0685 01708000
         N     @06,@CF01568                                        0685 01709000
         NR    @08,@06                                             0685 01710000
         STH   @08,WORKCUA                                         0685 01711000
*              SYSGROUP = THREE;                           /*@D3503VS*/ 01712000
         MVI   SYSGROUP,X'03'                                      0686 01713000
*              SYSTEMP = SYSTEMP + TPRTMPR + TPRTMPW;      /*@D3503VS*/ 01714000
         LA    @08,TPRVOL(,R7)                                     0687 01715000
         LA    @06,15                                              0687 01716000
         SLR   @03,@03                                             0687 01717000
         IC    @03,TPRBUFC(,R7)                                    0687 01718000
         NR    @06,@03                                             0687 01719000
         ALR   @08,@06                                             0687 01720000
         ICM   @06,15,SYSTEMP                                      0687 01721000
         SLR   @03,@03                                             0687 01722000
         IC    @03,TPRTMPR(,@08)                                   0687 01723000
         ALR   @06,@03                                             0687 01724000
         SLR   @03,@03                                             0687 01725000
         IC    @03,TPRTMPW(,@08)                                   0687 01726000
         ALR   @06,@03                                             0687 01727000
         STCM  @06,15,SYSTEMP                                      0687 01728000
*              SYSRT = WORKCUA & NOU;                      /*@D3503VS*/ 01729000
         MVC   SYSRT(2),WORKCUA                                    0688 01730000
         NC    SYSRT(2),@CB00949                                   0688 01731000
*              SYSDEV = '8809'X;                           /*@D3503VS*/ 01732000
         MVC   SYSDEV(2),@CB01434                                  0689 01733000
*              CALL SETCPU;                                /*@D3503VS*/ 01734000
         BAL   @14,SETCPU                                          0690 01735000
*            END;                                          /*@D3503VS*/ 01736000
*        ELSE                                                      0692 01737000
*          BUG(10) = BUG(10) + 1;                          /*@Z427VLS*/ 01738000
         B     @RC00684                                            0692 01739000
@RF00684 LA    @08,1                                               0692 01740000
         AL    @08,BUG+36                                          0692 01741000
         ST    @08,BUG+36                                          0692 01742000
*       END;                                               /*@Z427VLS*/ 01743000
* END;                                                     /*@D3506GB*/ 01744000
* END;                                                     /*@D35UGGB*/ 01745000
*  END;                                                    /*@Z427VLS*/ 01746000
*END; /*CLOSING END FOR CONTERR                              @Z427VLS*/ 01747000
@EL00012 DS    0H                                                  0697 01748000
@EF00012 DS    0H                                                  0697 01749000
@ER00012 LM    @14,@12,@SA00012                                    0697 01750000
         BR    @14                                                 0697 01751000
*CONTMDR: PROC; /*COUNT TEMPORARY ERRORS AND INDICATE PERMANENT */ 0698 01752000
CONTMDR  STM   @14,@12,@SA00013                                    0698 01753000
*               /*ERROR IF RECORD REPRESENTS SUCH.           @Z427VLS*/ 01754000
*BUG(9) = BUG(9) + 1;                                      /*@Z427VLS*/ 01755000
         LA    @08,1                                               0699 01756000
         AL    @08,BUG+32                                          0699 01757000
         ST    @08,BUG+32                                          0699 01758000
*IF TPRMODE = LINSTAT0 THEN                                        0700 01759000
         CLI   TPRMODE(R7),X'00'                                   0700 01760000
         BNE   @RF00700                                            0700 01761000
*  DO;                                                     /*@Z427VLS*/ 01762000
*    SYSTEMP  = SYSTEMP  + ERRCT1;                     /*@Z427VLS*/     01763000
         ICM   @08,15,SYSTEMP                                      0702 01764000
         SLR   @06,@06                                             0702 01765000
         IC    @06,ERRCT1(,R7)                                     0702 01766000
         ALR   @08,@06                                             0702 01767000
         STCM  @08,15,SYSTEMP                                      0702 01768000
*    SYSPERM  = ON; /*IDENTIFY ERROR AS PERMANENT          @Z427VLS*/   01769000
         OI    SYSPERM,B'00000001'                                 0703 01770000
*  END;                                                    /*@Z427VLS*/ 01771000
*ELSE                                                              0705 01772000
*  DO;                                                     /*@Z427VLS*/ 01773000
         B     @RC00700                                            0705 01774000
@RF00700 DS    0H                                                  0706 01775000
*    IF TPRMODE = LINSTAT1 THEN                                    0706 01776000
         CLI   TPRMODE(R7),X'01'                                   0706 01777000
         BNE   @RF00706                                            0706 01778000
*       SYSTEMP = SYSTEMP + ERRCT1;                        /*@D3502BL*/ 01779000
         ICM   @08,15,SYSTEMP                                      0707 01780000
         SLR   @06,@06                                             0707 01781000
         IC    @06,ERRCT1(,R7)                                     0707 01782000
         ALR   @08,@06                                             0707 01783000
         STCM  @08,15,SYSTEMP                                      0707 01784000
*   ELSE                                                           0708 01785000
*    IF TPRMODE = MODE86 THEN                                      0708 01786000
         B     @RC00706                                            0708 01787000
@RF00706 CLI   TPRMODE(R7),X'86'                                   0708 01788000
         BNE   @RF00708                                            0708 01789000
*       SYSTEMP = SYSTEMP + RMSSCBRY;                      /*@D3502BL*/ 01790000
         ICM   @08,15,SYSTEMP                                      0709 01791000
         LH    @06,RMSSCBRY(,R7)                                   0709 01792000
         N     @06,@CF01568                                        0709 01793000
         ALR   @08,@06                                             0709 01794000
         STCM  @08,15,SYSTEMP                                      0709 01795000
*  ELSE                                                            0710 01796000
*    DO;                                                   /*@Z427VLS*/ 01797000
         B     @RC00708                                            0710 01798000
@RF00708 DS    0H                                                  0711 01799000
*      IF TPRMODE = CHANADAP | /*CHANNEL ADAPTER ERROR       @Z427VLS*/ 01800000
*         TPRMODE = COMSCAN  | /*COMMUNICATION SCANNER ERROR @Z427VLS*/ 01801000
*         TPRMODE = IOERROR  | /*I/O INSTRUCTION EXCEPTION   @Z427VLS*/ 01802000
*         TPRMODE = UNRESOLV | /*UNRESOLVED PROGRAM LEVEL ONE */   0711 01803000
*                              /*INTERRUPT                   @Z427VLS*/ 01804000
*         TPRMODE = LINKERR |   /* LINK ERROR                @D3502BL*/ 01805000
*         TPRMODE = MODE82 THEN /* LONG FORMAT LINK ERROR    @D3502BL*/ 01806000
         CLI   TPRMODE(R7),X'10'                                   0711 01807000
         BE    @RT00711                                            0711 01808000
         CLI   TPRMODE(R7),X'11'                                   0711 01809000
         BE    @RT00711                                            0711 01810000
         CLI   TPRMODE(R7),X'12'                                   0711 01811000
         BE    @RT00711                                            0711 01812000
         CLI   TPRMODE(R7),X'13'                                   0711 01813000
         BE    @RT00711                                            0711 01814000
         CLI   TPRMODE(R7),X'02'                                   0711 01815000
         BE    @RT00711                                            0711 01816000
         CLI   TPRMODE(R7),X'82'                                   0711 01817000
         BNE   @RF00711                                            0711 01818000
@RT00711 DS    0H                                                  0712 01819000
*           SYSPERM  = ON;                               /*@Z427VLS*/   01820000
         OI    SYSPERM,B'00000001'                                 0712 01821000
*      ELSE                                                        0713 01822000
*      DO;                                                 /*@Z427VLS*/ 01823000
         B     @RC00711                                            0713 01824000
@RF00711 DS    0H                                                  0714 01825000
*      IF TPRMODE = LINSTAT3 THEN /*IF MODE IS 03            @Z427VLS*/ 01826000
         CLI   TPRMODE(R7),X'03'                                   0714 01827000
         BNE   @RF00714                                            0714 01828000
*         DO;                                              /*@Z427VLS*/ 01829000
*           SYSTEMP  = SYSTEMP  + ERRCT1;              /*@Z427VLS*/     01830000
         ICM   @08,15,SYSTEMP                                      0716 01831000
         SLR   @06,@06                                             0716 01832000
         IC    @06,ERRCT1(,R7)                                     0716 01833000
         ALR   @08,@06                                             0716 01834000
         STCM  @08,15,SYSTEMP                                      0716 01835000
*           SYSPERM  = ON; /*ALWAYS SET TEMP BEFORE PERM   @Z427VLS*/   01836000
         OI    SYSPERM,B'00000001'                                 0717 01837000
*         END;                                             /*@Z427VLS*/ 01838000
*      ELSE                                                        0719 01839000
*        IF TPRMODE = MODE83 THEN /* IF MODE IS 83           @D3502BL*/ 01840000
         B     @RC00714                                            0719 01841000
@RF00714 CLI   TPRMODE(R7),X'83'                                   0719 01842000
         BNE   @RF00719                                            0719 01843000
*          DO;                                             /*@D3502BL*/ 01844000
*            SYSTEMP = SYSTEMP + RMSSCBRY;                 /*@D3502BL*/ 01845000
         ICM   @08,15,SYSTEMP                                      0721 01846000
         LH    @06,RMSSCBRY(,R7)                                   0721 01847000
         N     @06,@CF01568                                        0721 01848000
         ALR   @08,@06                                             0721 01849000
         STCM  @08,15,SYSTEMP                                      0721 01850000
*            SYSPERM = ON;                                 /*@D3502BL*/ 01851000
         OI    SYSPERM,B'00000001'                                 0722 01852000
*          END;                                            /*@D3502BL*/ 01853000
*       END;                                               /*@Z427VLS*/ 01854000
@RF00719 DS    0H                                                  0724 01855000
@RC00714 DS    0H                                                  0725 01856000
*       END;                                               /*@Z427VLS*/ 01857000
@RC00711 DS    0H                                                  0726 01858000
*    END;                                                  /*@Z427VLS*/ 01859000
@RC00708 DS    0H                                                  0726 01860000
@RC00706 DS    0H                                                  0727 01861000
*IF SYSPERM  = ON | SYSTEMP  > ZERO THEN                           0727 01862000
@RC00700 TM    SYSPERM,B'00000001'                                 0727 01863000
         BO    @RT00727                                            0727 01864000
         ICM   @08,15,SYSTEMP                                      0727 01865000
         BNP   @RF00727                                            0727 01866000
@RT00727 DS    0H                                                  0728 01867000
*  DO;                                                     /*@Z427VLS*/ 01868000
*    WORKCUA = (TPRCUA & ONLYCUA2);                        /*@Z427VLS*/ 01869000
         MVC   WORKCUA(2),TPRCUA(R7)                               0729 01870000
         NC    WORKCUA(2),@CB00951                                 0729 01871000
*    BUG(11) = BUG(11) + 1;                                /*@Z427VLS*/ 01872000
         LA    @08,1                                               0730 01873000
         L     @06,BUG+40                                          0730 01874000
         ALR   @06,@08                                             0730 01875000
         ST    @06,BUG+40                                          0730 01876000
*    BUG(19) = BUG(19) + 1;                                /*@Z427VLS*/ 01877000
         AL    @08,BUG+72                                          0731 01878000
         ST    @08,BUG+72                                          0731 01879000
*    SYSGROUP  = FIVE; /*SET GROUP TO TP CNTRL             @Z427VLS*/   01880000
         MVI   SYSGROUP,X'05'                                      0732 01881000
*    SYSRT  = (TPRCUA & ONLYCUA2);                       /*@Z427VLS*/   01882000
         MVC   SYSRT(2),TPRCUA(R7)                                 0733 01883000
         NC    SYSRT(2),@CB00951                                   0733 01884000
*    /*SYSCUA IS 4 BITS TOO FAR TO THE RIGHT FOR NOW         @Z427VLS*/ 01885000
*    SYSDEV  = '3705'X;                                  /*@Z427VLS*/   01886000
         MVC   SYSDEV(2),@CB01439                                  0734 01887000
*     RECCPU=LRTCPUS;                  /*SAVE CPU SERIAL NUMBER       * 01888000
         MVC   RECCPU(3),LRTCPUS(R7)                               0735 01889000
*    CALL SETCPU;                                          /*@Z427VLS*/ 01890000
         BAL   @14,SETCPU                                          0736 01891000
*    CALL SET3705;                                         /*@Z427VLS*/ 01892000
         BAL   @14,SET3705                                         0737 01893000
*  END;                                                    /*@Z427VLS*/ 01894000
*END; /*END FOR PROC COUNTMDR                                @Z427VLS*/ 01895000
@EL00013 DS    0H                                                  0739 01896000
@EF00013 DS    0H                                                  0739 01897000
@ER00013 LM    @14,@12,@SA00013                                    0739 01898000
         BR    @14                                                 0739 01899000
*COUNTOBR:PROC; /*IDENTIFY AND SUM PERMANENT AND TEMPORARY ERRORS*/     01900000
COUNTOBR STM   @14,@12,@SA00014                                    0740 01901000
*               /*FROM OBR RECORDS IN SYSUM2                 @Z427VLS*/ 01902000
*BUG(7) = BUG(7) + 1;                                      /*@Z427VLS*/ 01903000
         LA    @08,1                                               0741 01904000
         AL    @08,BUG+24                                          0741 01905000
         ST    @08,BUG+24                                          0741 01906000
*IF SHORTSW = ON THEN /*IF SHORT OBR                         @Z427VLS*/ 01907000
         TM    SHORTSW(R7),B'00100000'                             0742 01908000
         BNO   @RF00742                                            0742 01909000
*  DO;                                                     /*@Z427VLS*/ 01910000
*    CUA3 = (OBRSCUA & ONLYCUA3);                          /*@Z427VLS*/ 01911000
         MVC   CUA3(3),OBRSCUA(R7)                                 0744 01912000
         NC    CUA3(3),@CB00953                                    0744 01913000
*    WORKDEV = OBRSDEV2;                                   /*@Z427VLS*/ 01914000
         MVC   WORKDEV(2),OBRSDEV2(R7)                             0745 01915000
*  END;                                                    /*@Z427VLS*/ 01916000
*ELSE  /*LONG OBR BY DEFAULT                                 @Z427VLS*/ 01917000
*  DO;                                                     /*@Z427VLS*/ 01918000
         B     @RC00742                                            0747 01919000
@RF00742 DS    0H                                                  0748 01920000
*    WORKDEV = OBRDEV;                                     /*@Z427VLS*/ 01921000
         MVC   WORKDEV(2),OBRDEV(R7)                               0748 01922000
*    CUA3 = (OBRPCUA & ONLYCUA3);                          /*@Z427VLS*/ 01923000
         MVC   CUA3(3),OBRPCUA(R7)                                 0749 01924000
         NC    CUA3(3),@CB00953                                    0749 01925000
*  END;                                                    /*@Z427VLS*/ 01926000
*IF WORKDEV = DEV3410 |                                            0751 01927000
*   WORKDEV = DEV3420 |                                            0751 01928000
*   WORKDEV = DEV34XX THEN                                         0751 01929000
@RC00742 CLC   WORKDEV(2),@CB00910                                 0751 01930000
         BE    @RT00751                                            0751 01931000
         CLC   WORKDEV(2),@CB00912                                 0751 01932000
         BE    @RT00751                                            0751 01933000
         CLC   WORKDEV(2),@CB00914                                 0751 01934000
         BNE   @RF00751                                            0751 01935000
@RT00751 DS    0H                                                  0752 01936000
*  CALL CHECK34X; /*IF 34XX TAPE THEN USE ANOTHER ALGORITM   @Z427VLS*/ 01937000
         BAL   @14,CHECK34X                                        0752 01938000
*ELSE /*OTHER THAN 34XX RECORD                               @Z427VLS*/ 01939000
*  DO;                                                     /*@Z427VLS*/ 01940000
         B     @RC00751                                            0753 01941000
@RF00751 DS    0H                                                  0754 01942000
*   IF WORKDEV = DEV3330  |                                        0754 01943000
*      WORKDEV = DEV3340  |                                        0754 01944000
*      WORKDEV = DEV3350  |                                        0754 01945000
*     OBRCLASS = '21'X |                                           0754 01946000
*      WORKDEV = DEV33301 |                                        0754 01947000
*      WORKDEV = DEV23051 |                                        0754 01948000
*      WORKDEV = DEV23052 THEN /*33XX OR 2305 DEVICE TYPE    @Z427VLS*/ 01949000
         CLC   WORKDEV(2),@CB00902                                 0754 01950000
         BE    @RT00754                                            0754 01951000
         CLC   WORKDEV(2),@CB00904                                 0754 01952000
         BE    @RT00754                                            0754 01953000
         CLC   WORKDEV(2),@CB00906                                 0754 01954000
         BE    @RT00754                                            0754 01955000
         CLI   OBRCLASS(R7),X'21'                                  0754 01956000
         BE    @RT00754                                            0754 01957000
         CLC   WORKDEV(2),@CB00908                                 0754 01958000
         BE    @RT00754                                            0754 01959000
         CLC   WORKDEV(2),@CB00898                                 0754 01960000
         BE    @RT00754                                            0754 01961000
         CLC   WORKDEV(2),@CB00900                                 0754 01962000
         BNE   @RF00754                                            0754 01963000
@RT00754 DS    0H                                                  0755 01964000
*     CALL CHECK33X;                                       /*@Z427VLS*/ 01965000
         BAL   @14,CHECK33X                                        0755 01966000
*    ELSE /*IF NOT 33XX OR 34XX DEVICE THEN                  @Z427VLS*/ 01967000
*      DO;                                                 /*@Z427VLS*/ 01968000
         B     @RC00754                                            0756 01969000
@RF00754 DS    0H                                                  0757 01970000
*         IF SHORTSW = YES THEN                                    0757 01971000
         TM    SHORTSW(R7),B'00100000'                             0757 01972000
         BNO   @RF00757                                            0757 01973000
*           DO;                                            /*@Z427VLS*/ 01974000
*             IF OBRSSDRC > ZERO THEN /*IF STAT COUNTERS EXIST*/   0759 01975000
         CLI   OBRSSDRC(R7),0                                      0759 01976000
         BNH   @RF00759                                            0759 01977000
*               DO;                                        /*@Z427VLS*/ 01978000
*                 ERRNUM = NULLIT;                         /*@Z427VLS*/ 01979000
         MVI   ERRNUM,X'00'                                        0761 01980000
*                 ERRPLACE = (ERRPLACE | OBRSRDS); /*GET R,R ERRORS*/   01981000
         OC    ERRPLACE(1),OBRSRDS(R7)                             0762 01982000
*                 SRL(ERRPLACE,4); /*SHIFT TO ACCESS AS NUMERIC*/  0763 01983000
         SLR   @08,@08                                             0763 01984000
         IC    @08,ERRPLACE                                        0763 01985000
         SRL   @08,4                                               0763 01986000
         STC   @08,ERRPLACE                                        0763 01987000
*                 SYSTEMP  = SYSTEMP  + ERRNUM;        /*@Z427VLS*/     01988000
         ICM   @08,15,SYSTEMP                                      0764 01989000
         SLR   @06,@06                                             0764 01990000
         IC    @06,ERRNUM                                          0764 01991000
         ALR   @08,@06                                             0764 01992000
         STCM  @08,15,SYSTEMP                                      0764 01993000
*                 ERRNUM = NULLIT;                         /*@Z427VLS*/ 01994000
         MVI   ERRNUM,X'00'                                        0765 01995000
*                 ERRPLACE = OBRSRDS; /*GET BOTH READ AND WRITE*/  0766 01996000
         MVC   ERRPLACE(1),OBRSRDS(R7)                             0766 01997000
*                 ERRPLACE = (ERRPLACE & NOREAD); /*REMOVE READS*/ 0767 01998000
         NI    ERRPLACE,X'0F'                                      0767 01999000
*                 SYSTEMP  = SYSTEMP  + ERRNUM;        /*@Z427VLS*/     02000000
         SLR   @06,@06                                             0768 02001000
         IC    @06,ERRNUM                                          0768 02002000
         ALR   @08,@06                                             0768 02003000
         STCM  @08,15,SYSTEMP                                      0768 02004000
*               END;                                       /*@Z427VLS*/ 02005000
*           END;                                           /*@Z427VLS*/ 02006000
*         ELSE /*LONG OBR BY DEFAULT                         @Z427VLS*/ 02007000
*           DO;                                            /*@Z427VLS*/ 02008000
         B     @RC00757                                            0771 02009000
@RF00757 DS    0H                                                  0772 02010000
*             IF DISMOUNT = ON | /*IF A DISMOUNT RECORD WITH STAT DTA*/ 02011000
*                SDRCOUNT = ON | /*SDR COUNTER DUMPED AT EOD @Z427VLS*/ 02012000
*                OBRTEMP = ON THEN /*OBR TEMPORARY ERROR FLAG ON     */ 02013000
         TM    DISMOUNT(R7),B'11000100'                            0772 02014000
         BZ    @RF00772                                            0772 02015000
*              DO;                     /*                    @ZA29956*/ 02016000
*              IF OBRLSDRC > ZERO THEN /*IF STAT CNTRS EXIST @ZA29956*/ 02017000
         CLI   OBRLSDRC(R7),0                                      0774 02018000
         BNH   @RF00774                                            0774 02019000
*               DO;  /*ACCUMULATE READ WRITE ERRORS          @Z427VLS*/ 02020000
*                 ERRNUM = NULLIT;                         /*@Z427VLS*/ 02021000
         MVI   ERRNUM,X'00'                                        0776 02022000
*                 ERRPLACE = (ERRPLACE | OBRLSDR); /*GET LNG R,R ERR*/  02023000
         LA    @08,64                                              0777 02024000
         ALR   @08,R7                                              0777 02025000
         SLR   @06,@06                                             0777 02026000
         IC    @06,OBRDEVDC(,R7)                                   0777 02027000
         SLA   @06,3                                               0777 02028000
         ALR   @08,@06                                             0777 02029000
         OC    ERRPLACE(1),OBRLSDR(@08)                            0777 02030000
*                 SRL(ERRPLACE,4); /*SHIFT TO ACCESS AS NUMERIC*/  0778 02031000
         SLR   @06,@06                                             0778 02032000
         IC    @06,ERRPLACE                                        0778 02033000
         SRL   @06,4                                               0778 02034000
         STC   @06,ERRPLACE                                        0778 02035000
*                 SYSTEMP  = SYSTEMP  + ERRNUM;        /*@Z427VLS*/     02036000
         ICM   @06,15,SYSTEMP                                      0779 02037000
         SLR   @03,@03                                             0779 02038000
         IC    @03,ERRNUM                                          0779 02039000
         ALR   @06,@03                                             0779 02040000
         STCM  @06,15,SYSTEMP                                      0779 02041000
*                 ERRNUM = NULLIT;                         /*@Z427VLS*/ 02042000
         MVI   ERRNUM,X'00'                                        0780 02043000
*                 ERRPLACE = OBRLSDR; /*GET READ, WRITE ERRORS*/   0781 02044000
         MVC   ERRPLACE(1),OBRLSDR(@08)                            0781 02045000
*                 ERRPLACE = (ERRPLACE & NOREAD); /*ELIM READ ERRORS*/  02046000
         NI    ERRPLACE,X'0F'                                      0782 02047000
*                 SYSTEMP  = SYSTEMP  + ERRNUM;        /*@Z427VLS*/     02048000
         SLR   @08,@08                                             0783 02049000
         IC    @08,ERRNUM                                          0783 02050000
         ALR   @06,@08                                             0783 02051000
         STCM  @06,15,SYSTEMP                                      0783 02052000
*               END;                                       /*@Z427VLS*/ 02053000
*              END;                    /*                    @ZA29956*/ 02054000
*             ELSE /*CONTINUE CHECKING TO FIND PERM ERRORS   @Z427VLS*/ 02055000
*               DO;                                        /*@Z427VLS*/ 02056000
         B     @RC00772                                            0786 02057000
@RF00772 DS    0H                                                  0787 02058000
*                 IF OBRSENS0 ^= '40'X THEN    /* IF NOT INTERV REQ */  02059000
         LA    @08,64                                              0787 02060000
         ALR   @08,R7                                              0787 02061000
         SLR   @06,@06                                             0787 02062000
         IC    @06,OBRDEVDC(,R7)                                   0787 02063000
         SLA   @06,3                                               0787 02064000
         ALR   @08,@06                                             0787 02065000
         SLR   @06,@06                                             0787 02066000
         IC    @06,OBRLSDRC(,R7)                                   0787 02067000
         ALR   @08,@06                                             0787 02068000
         CLI   OBRSENS0(@08),X'40'                                 0787 02069000
         BE    @RF00787                                            0787 02070000
*                   SYSPERM  = ON;                       /*@Z427VLS*/   02071000
         OI    SYSPERM,B'00000001'                                 0788 02072000
*               END;                                       /*@Z427VLS*/ 02073000
@RF00787 DS    0H                                                  0790 02074000
*            END;                                          /*@Z427VLS*/ 02075000
@RC00772 DS    0H                                                  0791 02076000
*         END;                                             /*@Z427VLS*/ 02077000
@RC00757 DS    0H                                                  0792 02078000
* END;                                                     /*@D35UGGB*/ 02079000
@RC00754 DS    0H                                                  0793 02080000
* IF SYSPERM = ON | SYSTEMP ^= 0 THEN                              0793 02081000
@RC00751 TM    SYSPERM,B'00000001'                                 0793 02082000
         BO    @RT00793                                            0793 02083000
         ICM   @08,15,SYSTEMP                                      0793 02084000
         BZ    @RF00793                                            0793 02085000
@RT00793 DS    0H                                                  0794 02086000
*      CALL SETSYS2;                                       /*@Z427VLS*/ 02087000
         BAL   @14,SETSYS2                                         0794 02088000
*  END; /*CLOSING END FOR PROC COUNTOBR                      @Z427VLS*/ 02089000
@EL00014 DS    0H                                                  0795 02090000
@EF00014 DS    0H                                                  0795 02091000
@ER00014 LM    @14,@12,@SA00014                                    0795 02092000
         BR    @14                                                 0795 02093000
*SETSYS2: PROC; /*CREATE SYSUM2 SORT KEY                     @Z427VLS*/ 02094000
SETSYS2  STM   @14,@12,@SA00015                                    0796 02095000
*        BUG(12) = BUG(12) + 1;                            /*@Z427VLS*/ 02096000
         LA    @08,1                                               0797 02097000
         AL    @08,BUG+44                                          0797 02098000
         ST    @08,BUG+44                                          0797 02099000
*        CALL GROUPASN;                                    /*@Z427VLS*/ 02100000
         BAL   @14,GROUPASN                                        0798 02101000
*        SYSRT  = WORKCUA; /*CUA IS 4 BITS RIGHT OF CORRECT POS NOW*/   02102000
         MVC   SYSRT(2),WORKCUA                                    0799 02103000
*        LINKDEV = (LINKDEV && LINKDEV); /*ZERO TO ELIMINATE PREV SET*/ 02104000
         XC    LINKDEV(4),LINKDEV                                  0800 02105000
*        CALL IFCDEVIC(3,WORKDEV,LINKDEV); /*GET DEVICE LABEL*/    0801 02106000
         L     @15,@CV01431                                        0801 02107000
         LA    @01,@AL00801                                        0801 02108000
         BALR  @14,@15                                             0801 02109000
*        /*IFCDEVIC IS AN EXTERNAL PROGRAM, MUST BE LINKEDITED TO FLT2* 02110000
*        SYSDEV = DEVLABEL;  /* PUT DEVICE LABEL IN SORT TABLE   */     02111000
         MVC   SYSDEV(2),DEVLABEL                                  0802 02112000
*        RECCPU=LRTCPUS;               /*SAVE CPU SERIAL NUMBER       * 02113000
         MVC   RECCPU(3),LRTCPUS(R7)                               0803 02114000
*        CALL SETCPU;                                      /*@Z427VLS*/ 02115000
         BAL   @14,SETCPU                                          0804 02116000
*        IF SYSGROUP  = TWO |                                      0805 02117000
*           SYSGROUP  = THREE |                                    0805 02118000
*           SYSGROUP  = FOUR THEN                                  0805 02119000
         CLI   SYSGROUP,2                                          0805 02120000
         BE    @RT00805                                            0805 02121000
         CLI   SYSGROUP,3                                          0805 02122000
         BE    @RT00805                                            0805 02123000
         CLI   SYSGROUP,4                                          0805 02124000
         BNE   @RF00805                                            0805 02125000
@RT00805 DS    0H                                                  0806 02126000
*          CALL CONVCNTR;              /* CONVERT TO CONTROLLER LEVEL * 02127000
         BAL   @14,CONVCNTR                                        0806 02128000
*      END;                                                /*@Z427VLS*/ 02129000
@EL00015 DS    0H                                                  0807 02130000
@EF00015 DS    0H                                                  0807 02131000
@ER00015 LM    @14,@12,@SA00015                                    0807 02132000
         BR    @14                                                 0807 02133000
*CHECK34X: PROC; /*FIND PERM, TEMP ERRORS IN 34XX DEVICES    @Z427VLS*/ 02134000
CHECK34X STM   @14,@12,12(@13)                                     0808 02135000
*/*TEMPORARY READ, WRITE ERRORS ARE FOUND AT LOCATION 76 INTO OBR*/     02136000
*/*RECORDS FOR 34XX DEVICES. TEMPORARY ERRORS ARE IN RECORDS WHICH*/    02137000
*/*HAVE EITHER THE DISMOUNT OR SDR COUNTER FLAG ON. SHORT OBRS ARE*/    02138000
*/*NEVER GENERATED FOR 34XX DEVICES BUT LONG RECORDS MAY MASQUERADE*/   02139000
*/*AS SHORT RECORDS SOMETIMES. PERMANENT RECORDS ARE DEFINED BY */ 0809 02140000
*/*DEFAULT AS THOSE RECORDS THAT ARENT TEMPORARY, EXCEPT THAT*/    0809 02141000
*/*INVALID RECORDS MAY BE CREATED WITH THE TEMP BIT ON BUT NEITHER*/    02142000
*/*THE DISMOUNT OR SDR COUNTER FLAG ON WHICH MUST BE ELIMINATED*/  0809 02143000
*BUG(27) = BUG(27) + 1;                                    /*@Z427VLS*/ 02144000
         LA    @08,1                                               0809 02145000
         AL    @08,BUG+104                                         0809 02146000
         ST    @08,BUG+104                                         0809 02147000
*IF SHORTSW = NO THEN /*IF NOT A SHORT OBR THEN              @Z427VLS*/ 02148000
         TM    SHORTSW(R7),B'00100000'                             0810 02149000
         BNZ   @RF00810                                            0810 02150000
*  DO;                                                     /*@Z427VLS*/ 02151000
*  IF DISMOUNT = ON | SDRCOUNT = ON THEN /*IF IS EITHER A DISMOUNT*/    02152000
         TM    DISMOUNT(R7),B'10000100'                            0812 02153000
         BZ    @RF00812                                            0812 02154000
*                         /*RECORD OR A SDR COUNTER RECORD THEN*/  0813 02155000
*    SYSTEMP  = SYSTEMP  + OBR34CT1 + OBR34CT2; /*ADD R,W ERRORS*/ 0813 02156000
         ICM   @08,15,SYSTEMP                                      0813 02157000
         SLR   @06,@06                                             0813 02158000
         IC    @06,OBR34CT1(,R7)                                   0813 02159000
         ALR   @08,@06                                             0813 02160000
         SLR   @06,@06                                             0813 02161000
         IC    @06,OBR34CT2(,R7)                                   0813 02162000
         ALR   @08,@06                                             0813 02163000
         STCM  @08,15,SYSTEMP                                      0813 02164000
*  ELSE /*PERMANENT ERROR BY DEFAULT                         @Z427VLS*/ 02165000
*   IF OBRTEMP = OFF THEN /*IF NOT INVALID TEMPORARY ERROR THEN*/  0814 02166000
         B     @RC00812                                            0814 02167000
@RF00812 TM    OBRTEMP(R7),B'01000000'                             0814 02168000
         BNZ   @RF00814                                            0814 02169000
*    SYSPERM  = ON;                                      /*@Z427VLS*/   02170000
         OI    SYSPERM,B'00000001'                                 0815 02171000
*  END;                                                    /*@Z427VLS*/ 02172000
@RF00814 DS    0H                                                  0816 02173000
@RC00812 DS    0H                                                  0817 02174000
* IF SYSPERM = ON | SYSTEMP ^= 0 THEN                              0817 02175000
@RF00810 TM    SYSPERM,B'00000001'                                 0817 02176000
         BO    @RT00817                                            0817 02177000
         ICM   @08,15,SYSTEMP                                      0817 02178000
         BZ    @RF00817                                            0817 02179000
@RT00817 DS    0H                                                  0818 02180000
*    BUG(28) = BUG(28) + 1;                                /*@Z427VLS*/ 02181000
         LA    @08,1                                               0818 02182000
         AL    @08,BUG+108                                         0818 02183000
         ST    @08,BUG+108                                         0818 02184000
*END; /*END OF 34XX PROC                                     @Z427VLS*/ 02185000
@EL00016 DS    0H                                                  0819 02186000
@EF00016 DS    0H                                                  0819 02187000
@ER00016 LM    @14,@12,12(@13)                                     0819 02188000
         BR    @14                                                 0819 02189000
*CHECK33X: PROC; /*LOCATE 33XX AND 2305 OBR PERM, TEMP ERRORS*/    0820 02190000
CHECK33X STM   @14,@12,12(@13)                                     0820 02191000
*             /*SET SYSGROUP IN TABLE SYSUM2 TO THE ENTRY NUMBER*/ 0821 02192000
*             /*IN TABLE DEVGROUP RELATING TO THIS DEVICE GROUP */ 0821 02193000
*BUG(25) = BUG(25) + 1;                                    /*@Z427VLS*/ 02194000
         LA    @08,1                                               0821 02195000
         AL    @08,BUG+96                                          0821 02196000
         ST    @08,BUG+96                                          0821 02197000
*    IF (OBRSENS1 & PERMBIT) = PERMBIT THEN                        0822 02198000
         LA    @08,64                                              0822 02199000
         ALR   @08,R7                                              0822 02200000
         SLR   @06,@06                                             0822 02201000
         IC    @06,OBRDEVDC(,R7)                                   0822 02202000
         SLA   @06,3                                               0822 02203000
         ALR   @08,@06                                             0822 02204000
         SLR   @06,@06                                             0822 02205000
         IC    @06,OBRLSDRC(,R7)                                   0822 02206000
         ALR   @08,@06                                             0822 02207000
         MVC   @TS00001(1),OBRSENS1(@08)                           0822 02208000
         NI    @TS00001,B'10000000'                                0822 02209000
         CLI   @TS00001,B'10000000'                                0822 02210000
         BNE   @RF00822                                            0822 02211000
*      SYSPERM  = ON;                                    /*@Z427VLS*/   02212000
         OI    SYSPERM,B'00000001'                                 0823 02213000
*    ELSE                                                          0824 02214000
*      DO;                                                 /*@Z427VLS*/ 02215000
         B     @RC00822                                            0824 02216000
@RF00822 DS    0H                                                  0825 02217000
*        IF OBRTEMP = ON THEN                                      0825 02218000
         TM    OBRTEMP(R7),B'01000000'                             0825 02219000
         BNO   @RF00825                                            0825 02220000
*          SYSTEMP  = SYSTEMP  + 1;                    /*@Z427VLS*/     02221000
         LA    @08,1                                               0826 02222000
         ICM   @06,15,SYSTEMP                                      0826 02223000
         ALR   @08,@06                                             0826 02224000
         STCM  @08,15,SYSTEMP                                      0826 02225000
*        ELSE                                                      0827 02226000
*          SYSPERM  = ON;                                /*@Z427VLS*/   02227000
         B     @RC00825                                            0827 02228000
@RF00825 OI    SYSPERM,B'00000001'                                 0827 02229000
*      END;                                                /*@Z427VLS*/ 02230000
@RC00825 DS    0H                                                  0829 02231000
* IF SYSPERM = ON | SYSTEMP ^= 0 THEN                              0829 02232000
@RC00822 TM    SYSPERM,B'00000001'                                 0829 02233000
         BO    @RT00829                                            0829 02234000
         ICM   @08,15,SYSTEMP                                      0829 02235000
         BZ    @RF00829                                            0829 02236000
@RT00829 DS    0H                                                  0830 02237000
*  BUG(26) = BUG(26) + 1;                                  /*@Z427VLS*/ 02238000
         LA    @08,1                                               0830 02239000
         AL    @08,BUG+100                                         0830 02240000
         ST    @08,BUG+100                                         0830 02241000
*END;                                                      /*@Z427VLS*/ 02242000
@EL00017 DS    0H                                                  0831 02243000
@EF00017 DS    0H                                                  0831 02244000
@ER00017 LM    @14,@12,12(@13)                                     0831 02245000
         BR    @14                                                 0831 02246000
*GROUPASN: PROC; /*DETERMINE DEVICE GROUP FOR SYSTEM SUMMARY REPORT*/   02247000
GROUPASN STM   @14,@12,12(@13)                                     0832 02248000
*                /*SET SYSGROUP IN TABLE SYSUM2 TO THE ENTRY NUMBER*/   02249000
*                /*IN TABLE DEVGROUP RELATING TO THIS DEVICE GROUP*/    02250000
*IF (WORKDEV1 = HEX08 & WORKDEV2 ^= HEX42) |                       0833 02251000
*   WORKDEV  = HEX100C |                                           0833 02252000
*   WORKDEV  = HEX1008 THEN                                        0833 02253000
         CLI   WORKDEV1,X'08'                                      0833 02254000
         BNE   @GL00041                                            0833 02255000
         CLI   WORKDEV2,X'42'                                      0833 02256000
         BNE   @RT00833                                            0833 02257000
@GL00041 CLC   WORKDEV(2),@CB00916                                 0833 02258000
         BE    @RT00833                                            0833 02259000
         CLC   WORKDEV(2),@CB00918                                 0833 02260000
         BNE   @RF00833                                            0833 02261000
@RT00833 DS    0H                                                  0834 02262000
*  DO;                                                     /*@Z427VLS*/ 02263000
*   BUG(15) = BUG(15) + 1;                                 /*@Z427VLS*/ 02264000
         LA    @08,1                                               0835 02265000
         AL    @08,BUG+56                                          0835 02266000
         ST    @08,BUG+56                                          0835 02267000
*   SYSGROUP  = ONE;                                     /*@Z427VLS*/   02268000
         MVI   SYSGROUP,X'01'                                      0836 02269000
*  END;                                                    /*@Z427VLS*/ 02270000
*ELSE                                                              0838 02271000
*  DO;                                                     /*@Z427VLS*/ 02272000
         B     @RC00833                                            0838 02273000
@RF00833 DS    0H                                                  0839 02274000
*    IF WORKDEV1 = HEX10 THEN                                      0839 02275000
         CLI   WORKDEV1,X'10'                                      0839 02276000
         BNE   @RF00839                                            0839 02277000
*     DO;                                                  /*@Z427VLS*/ 02278000
*      BUG(18) = BUG(18) + 1;                              /*@Z427VLS*/ 02279000
         LA    @08,1                                               0841 02280000
         AL    @08,BUG+68                                          0841 02281000
         ST    @08,BUG+68                                          0841 02282000
*      SYSGROUP  = FOUR;                                 /*@Z427VLS*/   02283000
         MVI   SYSGROUP,X'04'                                      0842 02284000
*     END;                                                 /*@Z427VLS*/ 02285000
*    ELSE                                                          0844 02286000
*      DO;                                                 /*@Z427VLS*/ 02287000
         B     @RC00839                                            0844 02288000
@RF00839 DS    0H                                                  0845 02289000
*   IF WORKDEV1 = HEX20 |                                          0845 02290000
*      WORKDEV1 = HEX21 |                                          0845 02291000
*           WORKDEV = HEX0842 THEN                                 0845 02292000
         CLI   WORKDEV1,X'20'                                      0845 02293000
         BE    @RT00845                                            0845 02294000
         CLI   WORKDEV1,X'21'                                      0845 02295000
         BE    @RT00845                                            0845 02296000
         CLC   WORKDEV(2),@CB00920                                 0845 02297000
         BNE   @RF00845                                            0845 02298000
@RT00845 DS    0H                                                  0846 02299000
*         DO;                                              /*@Z427VLS*/ 02300000
*          BUG(16) = BUG(16) + 1;                          /*@Z427VLS*/ 02301000
         LA    @08,1                                               0847 02302000
         AL    @08,BUG+60                                          0847 02303000
         ST    @08,BUG+60                                          0847 02304000
*          SYSGROUP  = TWO;                              /*@Z427VLS*/   02305000
         MVI   SYSGROUP,X'02'                                      0848 02306000
*         END;                                             /*@Z427VLS*/ 02307000
*        ELSE                                                      0850 02308000
*         DO;                                              /*@Z427VLS*/ 02309000
         B     @RC00845                                            0850 02310000
@RF00845 DS    0H                                                  0851 02311000
*           IF WORKDEV1 = HEX40 THEN                               0851 02312000
         CLI   WORKDEV1,X'40'                                      0851 02313000
         BNE   @RF00851                                            0851 02314000
*             DO;                                          /*@Z427VLS*/ 02315000
*               SYSGROUP  = FIVE;                        /*@Z427VLS*/   02316000
         MVI   SYSGROUP,X'05'                                      0853 02317000
*               BUG(19) = BUG(19) + 1;                     /*@Z427VLS*/ 02318000
         LA    @08,1                                               0854 02319000
         AL    @08,BUG+72                                          0854 02320000
         ST    @08,BUG+72                                          0854 02321000
*             END;                                         /*@Z427VLS*/ 02322000
*           ELSE                                                   0856 02323000
*             DO;                                          /*@Z427VLS*/ 02324000
         B     @RC00851                                            0856 02325000
@RF00851 DS    0H                                                  0857 02326000
*               IF WORKDEV1 = HEX42 |                              0857 02327000
*                  WORKDEV1 = HEX44 THEN                           0857 02328000
         CLI   WORKDEV1,X'42'                                      0857 02329000
         BE    @RT00857                                            0857 02330000
         CLI   WORKDEV1,X'44'                                      0857 02331000
         BNE   @RF00857                                            0857 02332000
@RT00857 DS    0H                                                  0858 02333000
*                DO;                                       /*@Z427VLS*/ 02334000
*                 BUG(20) = BUG(20) + 1;                   /*@Z427VLS*/ 02335000
         LA    @08,1                                               0859 02336000
         AL    @08,BUG+76                                          0859 02337000
         ST    @08,BUG+76                                          0859 02338000
*                 SYSGROUP  = SIX;                       /*@Z427VLS*/   02339000
         MVI   SYSGROUP,X'06'                                      0860 02340000
*                END;                                      /*@Z427VLS*/ 02341000
*               ELSE                                               0862 02342000
*                 DO;                                      /*@Z427VLS*/ 02343000
         B     @RC00857                                            0862 02344000
@RF00857 DS    0H                                                  0863 02345000
*                   IF WORKDEV1 = HEX80 THEN                       0863 02346000
         CLI   WORKDEV1,X'80'                                      0863 02347000
         BNE   @RF00863                                            0863 02348000
*                    DO;                                   /*@Z427VLS*/ 02349000
*                     BUG(17) = BUG(17) + 1;               /*@Z427VLS*/ 02350000
         LA    @08,1                                               0865 02351000
         AL    @08,BUG+64                                          0865 02352000
         ST    @08,BUG+64                                          0865 02353000
*                     SYSGROUP  = THREE;                 /*@Z427VLS*/   02354000
         MVI   SYSGROUP,X'03'                                      0866 02355000
*                    END;                                  /*@Z427VLS*/ 02356000
*                 END;                                     /*@Z427VLS*/ 02357000
*             END;                                         /*@Z427VLS*/ 02358000
*          END;                                            /*@Z427VLS*/ 02359000
*      END;                                                /*@Z427VLS*/ 02360000
*     END;                                                 /*@Z427VLS*/ 02361000
*    END; /*CLOSING END TO GROUPASN PROC                     @Z427VLS*/ 02362000
@EL00018 DS    0H                                                  0873 02363000
@EF00018 DS    0H                                                  0873 02364000
@ER00018 LM    @14,@12,12(@13)                                     0873 02365000
         BR    @14                                                 0873 02366000
*SET3705: PROC;                                            /*@Z427VLS*/ 02367000
SET3705  STM   @14,@12,12(@13)                                     0874 02368000
*  IF TPRMODE = LINKERR |                                          0875 02369000
*     TPRMODE = MODE82 |                                           0875 02370000
*     TPRMODE = MODE83 |                                           0875 02371000
*     TPRMODE = MODE86 |                                           0875 02372000
*     TPRMODE = LINSTAT1 |                                         0875 02373000
*     TPRMODE = LINSTAT0 |                                         0875 02374000
*     TPRMODE = LINSTAT3 THEN                                      0875 02375000
         CLI   TPRMODE(R7),X'02'                                   0875 02376000
         BE    @RT00875                                            0875 02377000
         CLI   TPRMODE(R7),X'82'                                   0875 02378000
         BE    @RT00875                                            0875 02379000
         CLI   TPRMODE(R7),X'83'                                   0875 02380000
         BE    @RT00875                                            0875 02381000
         CLI   TPRMODE(R7),X'86'                                   0875 02382000
         BE    @RT00875                                            0875 02383000
         CLI   TPRMODE(R7),X'01'                                   0875 02384000
         BE    @RT00875                                            0875 02385000
         CLI   TPRMODE(R7),X'00'                                   0875 02386000
         BE    @RT00875                                            0875 02387000
         CLI   TPRMODE(R7),X'03'                                   0875 02388000
         BNE   @RF00875                                            0875 02389000
@RT00875 DS    0H                                                  0876 02390000
*    SYSITEM  = (SYSITEM  |   '20'X);                  /*@Z427VLS*/     02391000
         OI    SYSITEM,X'20'                                       0876 02392000
*  ELSE                                                            0877 02393000
*      IF  TPRMODE = IOERROR |                                     0877 02394000
*          TPRMODE = UNRESOLV THEN                                 0877 02395000
         B     @RC00875                                            0877 02396000
@RF00875 CLI   TPRMODE(R7),X'12'                                   0877 02397000
         BE    @RT00877                                            0877 02398000
         CLI   TPRMODE(R7),X'13'                                   0877 02399000
         BNE   @RF00877                                            0877 02400000
@RT00877 DS    0H                                                  0878 02401000
*          SYSITEM  = (SYSITEM  |   '10'X);            /*@Z427VLS*/     02402000
         OI    SYSITEM,X'10'                                       0878 02403000
*  /*IF TPRMODE IS EQUAL TO DEFAULT OF COMSCAN OR CHANADAP ERRORS*/     02404000
*  /*TREN37 NEED NOT BE SET AS ITS CORRECT VALUE IS ZERO. SYSRT */ 0879 02405000
*  /*IS SET HERE AS THE STUPID COMPILER WILL NOT ACCESS TREN37*/   0879 02406000
*END;    /*CLOSING END TO SET3705 PROC                       @Z427VLS*/ 02407000
@EL00019 DS    0H                                                  0879 02408000
@EF00019 DS    0H                                                  0879 02409000
@ER00019 LM    @14,@12,12(@13)                                     0879 02410000
         BR    @14                                                 0879 02411000
*SETCPU: PROC;                                             /*@Z427VLS*/ 02412000
SETCPU   STM   @14,@12,@SA00020                                    0880 02413000
*/* SET NEW AND OLD CPUS IN SYSUM2. CHECK AND SEE IF THE DEVICE*/  0881 02414000
*/* IS SHARED. IF SO, RESET THE NEW CPU AND ALSO THE CUA. GO TO*/  0881 02415000
*/*SUMONADR TO CREATE NEW ENTRIES OF EVTABLE AND SYSUMONE IF NEED BE*/  02416000
*CALL SUMONADR; /* IF TOO MANY CPUS ENCOUNTERED, NEW ENTRY OF EVTABLE*/ 02417000
         BAL   @14,SUMONADR                                        0881 02418000
*               /* IS NOT CREATED, AND THIS SYSUM2 ENTRY WILL NOT BE*/  02419000
*               /* CREATED                                   @Z427VLS*/ 02420000
*MISSW = OFF; /*PRESET LOOP KICKOUT SWITCH                   @Z427VLS*/ 02421000
         NI    MISSW,B'11101111'                                   0882 02422000
*DO J = 1 BY 1 TO EVNUM WHILE MISSW = OFF;                 /*@Z427VLS*/ 02423000
         LA    @08,1                                               0883 02424000
         ST    @08,J                                               0883 02425000
         B     @DE00883                                            0883 02426000
@DL00883 TM    MISSW,B'00010000'                                   0883 02427000
         BNZ   @DC00883                                            0883 02428000
*  IF EVSERIAL(J) = LRTCPUS | EVSERIAL(J) = 'FFFFFF'X THEN         0884 02429000
         MH    @08,@CH00081                                        0884 02430000
         L     @06,EVPTR(,R2)                                      0884 02431000
         ST    @08,@TF00001                                        0884 02432000
         ALR   @08,@06                                             0884 02433000
         CLC   EVSERIAL-6(3,@08),LRTCPUS(R7)                       0884 02434000
         BE    @RT00884                                            0884 02435000
         AL    @06,@TF00001                                        0884 02436000
         CLC   EVSERIAL-6(3,@06),@CB00237                          0884 02437000
         BNE   @RF00884                                            0884 02438000
@RT00884 DS    0H                                                  0885 02439000
*         /*EVSERIAL ONLY = FOXES IF 11TH OR HIGHER CPU IN INPUT*/ 0885 02440000
*    DO;                                                   /*@Z427VLS*/ 02441000
*      MISSW = ON; /*KICK OUT OF LOOP AFTER PROCESSING       @Z427VLS*/ 02442000
         OI    MISSW,B'00010000'                                   0886 02443000
*      WORKNM = J - 1; /*SET TO EVTABLE ENTRY NUMBER MINUS ONE*/   0887 02444000
         L     @08,J                                               0887 02445000
         BCTR  @08,0                                               0887 02446000
         STC   @08,WORKNM                                          0887 02447000
*      SYSCPUS  = WORKBYTE; /*REFERENCE WORKNM VIA BIT STRING AND*/     02448000
         MVC   SYSCPUS(1),WORKBYTE                                 0888 02449000
*                             /*SET SYSOLD EQUAL TO IT       @Z427VLS*/ 02450000
*      IF SHAREPTR ^= ZERO THEN                                    0889 02451000
         L     @08,SHAREPTR(,R2)                                   0889 02452000
         LTR   @08,@08                                             0889 02453000
         BZ    @RF00889                                            0889 02454000
*        DO;                                               /*@Z427VLS*/ 02455000
*          SHAREYES = NO;                                  /*@Z427VLS*/ 02456000
         NI    SHAREYES,B'01111111'                                0891 02457000
*          DO K = 1 BY 1 TO SHARENUM WHILE SHAREYES = NO;  /*@Z427VLS*/ 02458000
         LA    @08,1                                               0892 02459000
         ST    @08,K                                               0892 02460000
         B     @DE00892                                            0892 02461000
@DL00892 TM    SHAREYES,B'10000000'                                0892 02462000
         BNZ   @DC00892                                            0892 02463000
*            IF SHAREFLG(K)=LETTERS&LRTCPUS=SHARSERA(K) THEN       0893 02464000
         SLA   @08,4                                               0893 02465000
         L     @06,SHAREPTR(,R2)                                   0893 02466000
         ST    @08,@TF00001                                        0893 02467000
         ALR   @08,@06                                             0893 02468000
         AL    @08,@CF01392                                        0893 02469000
         CLC   SHAREFLG-2(1,@08),LETTERS                           0893 02470000
         BNE   @RF00893                                            0893 02471000
         LR    @08,@06                                             0893 02472000
         AL    @08,@TF00001                                        0893 02473000
         AL    @08,@CF01560                                        0893 02474000
         CLC   LRTCPUS(3,R7),SHARSERA-10(@08)                      0893 02475000
         BNE   @RF00893                                            0893 02476000
*              DO;                                         /*@Z427VLS*/ 02477000
*                  IF WORKCUA >=SHRCUAAL(K)&WORKCUA<=SHRCUAAH(K) THEN   02478000
         LR    @08,@06                                             0895 02479000
         AL    @08,@TF00001                                        0895 02480000
         AL    @08,@CF01570                                        0895 02481000
         CLC   WORKCUA(2),SHRCUAAL-13(@08)                         0895 02482000
         BL    @RF00895                                            0895 02483000
         LR    @08,@06                                             0895 02484000
         AL    @08,@TF00001                                        0895 02485000
         BCTR  @08,0                                               0895 02486000
         CLC   WORKCUA(2),SHRCUAAH-15(@08)                         0895 02487000
         BH    @RF00895                                            0895 02488000
*                      DO;                                 /*@Z427VLS*/ 02489000
*                        SYSRT=SHRCUABL(K)+WORKCUA-SHRCUAAL(K);    0897 02490000
         LR    @08,@06                                             0897 02491000
         AL    @08,@TF00001                                        0897 02492000
         AL    @08,@CF01571                                        0897 02493000
         SLR   @03,@03                                             0897 02494000
         ICM   @03,3,SHRCUABL-6(@08)                               0897 02495000
         LH    @08,WORKCUA                                         0897 02496000
         N     @08,@CF01568                                        0897 02497000
         ALR   @03,@08                                             0897 02498000
         LR    @08,@06                                             0897 02499000
         AL    @08,@TF00001                                        0897 02500000
         AL    @08,@CF01570                                        0897 02501000
         SLR   @00,@00                                             0897 02502000
         ICM   @00,3,SHRCUAAL-13(@08)                              0897 02503000
         SLR   @03,@00                                             0897 02504000
         STCM  @03,3,SYSRT                                         0897 02505000
*                        RECCPU=SHARSERB(K);/* SAVE CONVERTED CPU     * 02506000
         AL    @06,@TF00001                                        0898 02507000
         AL    @06,@CF01572                                        0898 02508000
         MVC   RECCPU(3),SHARSERB-3(@06)                           0898 02509000
*                        LOWCUA=SYSRT; /* SAVE LOW END OF CUA RANGE   * 02510000
         MVC   LOWCUA(2),SYSRT                                     0899 02511000
*                        MISSW1 = OFF;                     /*@Z427VLS*/ 02512000
         NI    MISSW1,B'11111101'                                  0900 02513000
*                        DO L = 1 BY 1 TO EVNUM WHILE MISSW1 = OFF;     02514000
         LA    @08,1                                               0901 02515000
         ST    @08,L                                               0901 02516000
         B     @DE00901                                            0901 02517000
@DL00901 TM    MISSW1,B'00000010'                                  0901 02518000
         BNZ   @DC00901                                            0901 02519000
*                          IF EVSERIAL(L) = SHARSERB(K) |          0902 02520000
*                             EVSERIAL(L) = 'FFFFFF'X THEN         0902 02521000
         MH    @08,@CH00081                                        0902 02522000
         L     @06,EVPTR(,R2)                                      0902 02523000
         L     @03,K                                               0902 02524000
         SLA   @03,4                                               0902 02525000
         L     @15,SHAREPTR(,R2)                                   0902 02526000
         ST    @08,@TF00001                                        0902 02527000
         ALR   @08,@06                                             0902 02528000
         ALR   @15,@03                                             0902 02529000
         AL    @15,@CF01572                                        0902 02530000
         CLC   EVSERIAL-6(3,@08),SHARSERB-3(@15)                   0902 02531000
         BE    @RT00902                                            0902 02532000
         AL    @06,@TF00001                                        0902 02533000
         CLC   EVSERIAL-6(3,@06),@CB00237                          0902 02534000
         BNE   @RF00902                                            0902 02535000
@RT00902 DS    0H                                                  0903 02536000
*                            DO;                           /*@Z427VLS*/ 02537000
*                              WORKNM = L - 1; /*SET TO EVTABLE ENT.*/  02538000
         L     @08,L                                               0904 02539000
         BCTR  @08,0                                               0904 02540000
         STC   @08,WORKNM                                          0904 02541000
*                                             /*NUMBER MINUS ONE*/ 0905 02542000
*                              MISSW1 = ON;                /*@Z427VLS*/ 02543000
         OI    MISSW1,B'00000010'                                  0905 02544000
*                            END;                          /*@Z427VLS*/ 02545000
*                        END;                              /*@Z427VLS*/ 02546000
@RF00902 LA    @08,1                                               0907 02547000
         AL    @08,L                                               0907 02548000
         ST    @08,L                                               0907 02549000
@DE00901 L     @06,EVPTR(,R2)                                      0907 02550000
         CH    @08,EVNUM(,@06)                                     0907 02551000
         BNH   @DL00901                                            0907 02552000
@DC00901 DS    0H                                                  0908 02553000
*                        SHAREYES = ON;                    /*@Z427VLS*/ 02554000
         OI    SHAREYES,B'10000000'                                0908 02555000
*                    END;                                  /*@Z427VLS*/ 02556000
*              END;                                        /*@Z427VLS*/ 02557000
@RF00895 DS    0H                                                  0911 02558000
*           END;                                           /*@Z427VLS*/ 02559000
@RF00893 LA    @08,1                                               0911 02560000
         AL    @08,K                                               0911 02561000
         ST    @08,K                                               0911 02562000
@DE00892 L     @06,SHAREPTR(,R2)                                   0911 02563000
         CH    @08,SHARENUM(,@06)                                  0911 02564000
         BNH   @DL00892                                            0911 02565000
@DC00892 DS    0H                                                  0912 02566000
*        END;                                              /*@Z427VLS*/ 02567000
*         IF SHAREYES=NO THEN                                      0913 02568000
@RF00889 TM    SHAREYES,B'10000000'                                0913 02569000
         BNZ   @RF00913                                            0913 02570000
*           LOWCUA=WORKCUA;                                /*@D3506GB*/ 02571000
         MVC   LOWCUA(2),WORKCUA                                   0914 02572000
*        SLL(SYSRT ,4); /*SHIFT TO SYSCUA FROM SYSRT       @Z427VLS*/   02573000
@RF00913 SLR   @08,@08                                             0915 02574000
         ICM   @08,3,SYSRT                                         0915 02575000
         SLL   @08,4                                               0915 02576000
         STCM  @08,3,SYSRT                                         0915 02577000
*        SLL(WORKNM,4); /*SHIFT BASE CPU INDEX TO BYTE BOUNDARY*/  0916 02578000
         SLR   @08,@08                                             0916 02579000
         IC    @08,WORKNM                                          0916 02580000
         SLL   @08,4                                               0916 02581000
         STC   @08,WORKNM                                          0916 02582000
*        SYSCPUS  = (SYSCPUS  | WORKBYTE); /*SET SYSCPU  @Z427VLS*/     02583000
         OC    SYSCPUS(1),WORKBYTE                                 0917 02584000
*     END;                                                 /*@Z427VLS*/ 02585000
*   END;                                                   /*@Z427VLS*/ 02586000
@RF00884 LA    @08,1                                               0919 02587000
         AL    @08,J                                               0919 02588000
         ST    @08,J                                               0919 02589000
@DE00883 L     @06,EVPTR(,R2)                                      0919 02590000
         CH    @08,EVNUM(,@06)                                     0919 02591000
         BNH   @DL00883                                            0919 02592000
@DC00883 DS    0H                                                  0920 02593000
*END;/*CLOSING END TO SETCPU                                 @Z427VLS*/ 02594000
@EL00020 DS    0H                                                  0920 02595000
@EF00020 DS    0H                                                  0920 02596000
@ER00020 LM    @14,@12,@SA00020                                    0920 02597000
         BR    @14                                                 0920 02598000
*/* CONVERT THE INPUT CUA TO THE CONTROLLER LEVEL. SEARCH THE         * 02599000
*/* SHARE/CONTROLLER TABLE FOR A MATCHING ENTRY. IF A MATCH IS FOUND  * 02600000
*/* THEN CONVERT THE CUA ACCORDING TO THE ENTRY. IF NO MATCH IS FOUND * 02601000
*/* THEN ASSUME THE CONTROL UNIT HAS DEVICE ADDRESS FROM 0-F.         * 02602000
*CONVCNTR: PROC;                                           /*@D3506GB*/ 02603000
CONVCNTR STM   @14,@12,@SA00021                                    0921 02604000
*  SHAREYES=NO;                                            /*@D3506GB*/ 02605000
         NI    SHAREYES,B'01111111'                                0922 02606000
*  IF SHAREPTR ^= 0 THEN                                           0923 02607000
         L     @08,SHAREPTR(,R2)                                   0923 02608000
         LTR   @08,@08                                             0923 02609000
         BZ    @RF00923                                            0923 02610000
*  DO K = 1 BY 1 TO SHARENUM WHILE(SHAREYES=NO);           /*@D3506GB*/ 02611000
         LA    @08,1                                               0924 02612000
         ST    @08,K                                               0924 02613000
         B     @DE00924                                            0924 02614000
@DL00924 TM    SHAREYES,B'10000000'                                0924 02615000
         BNZ   @DC00924                                            0924 02616000
*    IF SHAREFLG(K)=LETTERC&RECCPU=SHARSERB(K)&                    0925 02617000
*      LOWCUA>=SHRCUABL(K)&LOWCUA<=SHRCUABH(K) THEN                0925 02618000
         SLA   @08,4                                               0925 02619000
         L     @06,SHAREPTR(,R2)                                   0925 02620000
         ST    @08,@TF00001                                        0925 02621000
         ALR   @08,@06                                             0925 02622000
         AL    @08,@CF01392                                        0925 02623000
         CLC   SHAREFLG-2(1,@08),LETTERC                           0925 02624000
         BNE   @RF00925                                            0925 02625000
         LR    @08,@06                                             0925 02626000
         AL    @08,@TF00001                                        0925 02627000
         AL    @08,@CF01572                                        0925 02628000
         CLC   RECCPU(3),SHARSERB-3(@08)                           0925 02629000
         BNE   @RF00925                                            0925 02630000
         LR    @08,@06                                             0925 02631000
         AL    @08,@TF00001                                        0925 02632000
         AL    @08,@CF01571                                        0925 02633000
         CLC   LOWCUA(2),SHRCUABL-6(@08)                           0925 02634000
         BL    @RF00925                                            0925 02635000
         LR    @08,@06                                             0925 02636000
         AL    @08,@TF00001                                        0925 02637000
         AL    @08,@CF01575                                        0925 02638000
         CLC   LOWCUA(2),SHRCUABH-8(@08)                           0925 02639000
         BH    @RF00925                                            0925 02640000
*      DO;                                                 /*@D3506GB*/ 02641000
*        LOWCUA=SHRCUABL(K);           /*SAVE LOW END OF CUA RANGE    * 02642000
         LR    @08,@06                                             0927 02643000
         AL    @08,@TF00001                                        0927 02644000
         AL    @08,@CF01571                                        0927 02645000
         MVC   LOWCUA(2),SHRCUABL-6(@08)                           0927 02646000
*        HIGHCUA=SHRCUABH(K);          /*SAVE HIGH END OF CUA RANGE   * 02647000
         AL    @06,@TF00001                                        0928 02648000
         AL    @06,@CF01575                                        0928 02649000
         MVC   HIGHCUA(2),SHRCUABH-8(@06)                          0928 02650000
*        SYSRT=LOWCUA;                 /*SET LOW CUA IN SORT TABLE    * 02651000
         MVC   SYSRT(2),LOWCUA                                     0929 02652000
*        SLL(SYSRT,4);                 /*SHIFT CUA INTO SYSCUA FIELD  * 02653000
         SLR   @08,@08                                             0930 02654000
         ICM   @08,3,SYSRT                                         0930 02655000
         SLL   @08,4                                               0930 02656000
         STCM  @08,3,SYSRT                                         0930 02657000
*        SYSTROLL=ON;                  /*FLAG THAT CONTROL ENTRY EXIST* 02658000
         OI    SYSTROLL,B'00000100'                                0931 02659000
*        CALL BOUNDCRO;                /*SEE IF BOUNDARY CROSSED      * 02660000
         BAL   @14,BOUNDCRO                                        0932 02661000
*        SYSRANGE=HIGHCUA(2);          /*SAVE CU PART OF CUA @D3506GB*/ 02662000
         MVC   SYSRANGE(1),HIGHCUA+1                               0933 02663000
*        SHAREYES=ON;                                      /*@D3506GB*/ 02664000
         OI    SHAREYES,B'10000000'                                0934 02665000
*      END;                                                /*@D3506GB*/ 02666000
*    ELSE;                             /*ENTRY MATCH NOT FOUND        * 02667000
@RF00925 DS    0H                                                  0937 02668000
*  END;                                                    /*@D3506GB*/ 02669000
         LA    @08,1                                               0937 02670000
         AL    @08,K                                               0937 02671000
         ST    @08,K                                               0937 02672000
@DE00924 L     @06,SHAREPTR(,R2)                                   0937 02673000
         CH    @08,SHARENUM(,@06)                                  0937 02674000
         BNH   @DL00924                                            0937 02675000
@DC00924 DS    0H                                                  0938 02676000
*  IF SHAREYES=NO THEN                 /*CONTROLLER ENTRY NOT FOUND   * 02677000
@RF00923 TM    SHAREYES,B'10000000'                                0938 02678000
         BNZ   @RF00938                                            0938 02679000
*    DO;                                                   /*@D3506GB*/ 02680000
*      SYSRT=SYSRT&NOU;                /*UNIT ADDRESS TO 0   @D3506GB*/ 02681000
         NC    SYSRT(2),@CB00949                                   0940 02682000
*      SYSTROLL=NO;                    /*NO CONTROLLER CARD  @D3506GB*/ 02683000
*      SYSSPAN=NO;                     /* NO BOUNDARY CROSSED BY CUA  * 02684000
         NI    SYSTROLL,B'11110011'                                0942 02685000
*      SYSRANGE=LOWCUA(2)|ONLYCHAN;    /*TURN ON LAST 4 BITS @D3506GB*/ 02686000
         MVC   SYSRANGE(1),LOWCUA+1                                0943 02687000
         OI    SYSRANGE,X'0F'                                      0943 02688000
*    END;                                                  /*@D3506GB*/ 02689000
*  ELSE;                               /* CONTROLLER CARD FOUND       * 02690000
@RF00938 DS    0H                                                  0946 02691000
*END CONVCNTR;                                             /*@D3506GB*/ 02692000
@EL00021 DS    0H                                                  0946 02693000
@EF00021 DS    0H                                                  0946 02694000
@ER00021 LM    @14,@12,@SA00021                                    0946 02695000
         BR    @14                                                 0946 02696000
*/* DETERMINE IF THE CUA RANGE SPECIFIED IN A CONTROLLER CARD CROSSES * 02697000
*/* A BOUNDARY. IF IT DOES SET FLAG SYSSPAN.                 @D3506GB*/ 02698000
*BOUNDCRO: PROC;                                           /*@D3506GB*/ 02699000
BOUNDCRO STM   @14,@12,12(@13)                                     0947 02700000
*  LOWDIGIT=LOWCUA(2);                 /*GET LAST BYTE OF LOW CUA     * 02701000
         MVC   LOWDIGIT(1),LOWCUA+1                                0948 02702000
*  SRL(LOWDIGIT,4);                    /*GET 'U' PORITON OF CUA       * 02703000
         SLR   @08,@08                                             0949 02704000
         IC    @08,LOWDIGIT                                        0949 02705000
         SRL   @08,4                                               0949 02706000
         STC   @08,LOWDIGIT                                        0949 02707000
*  HIGDIGIT=HIGHCUA(2);                /*GET LAST BYTE OF HIGH CUA    * 02708000
         MVC   HIGDIGIT(1),HIGHCUA+1                               0950 02709000
*  SRL(HIGDIGIT,4);                    /*GET 'U' PORITON OF CUA       * 02710000
         SLR   @08,@08                                             0951 02711000
         IC    @08,HIGDIGIT                                        0951 02712000
         SRL   @08,4                                               0951 02713000
         STC   @08,HIGDIGIT                                        0951 02714000
*  IF LOWDIGIT ^= HIGDIGIT THEN                                    0952 02715000
         CLC   LOWDIGIT(1),HIGDIGIT                                0952 02716000
         BE    @RF00952                                            0952 02717000
*    SYSSPAN=ON;                       /*RANGE CROSSES A BOUNDARY     * 02718000
         OI    SYSSPAN,B'00001000'                                 0953 02719000
*  ELSE                                                            0954 02720000
*    SYSSPAN=NO;                       /*RANGE DOES NOT CROSS         * 02721000
         B     @RC00952                                            0954 02722000
@RF00952 NI    SYSSPAN,B'11110111'                                 0954 02723000
*END BOUNDCRO;                                             /*@D3506GB*/ 02724000
@EL00022 DS    0H                                                  0955 02725000
@EF00022 DS    0H                                                  0955 02726000
@ER00022 LM    @14,@12,12(@13)                                     0955 02727000
         BR    @14                                                 0955 02728000
*ENDOFILE: PROC; /*SORT SORTABLE AND PASS RETURN CODE TO EREP1*/   0956 02729000
ENDOFILE STM   @14,@12,@SA00023                                    0956 02730000
*RESPECIFY(R15) RESTRICTED;                                /*@Z427VLS*/ 02731000
*IF ERROR = OVERFLOW & PHIST = ON THEN                             0958 02732000
         CLC   ERROR(4),@CF00066                                   0958 02733000
         BNE   @RF00958                                            0958 02734000
         TM    PHIST(R2),B'00100000'                               0958 02735000
         BNO   @RF00958                                            0958 02736000
*  DO;                                                     /*@0001VLS*/ 02737000
*    CLOSEIO = (CLOSEIO && CLOSEIO);                       /*@0001VLS*/ 02738000
         XC    CLOSEIO(2,R2),CLOSEIO(R2)                           0960 02739000
*    CACCIN = ON;                                          /*@0001VLS*/ 02740000
         OI    CACCIN(R2),B'00010000'                              0961 02741000
*    CALL IOHND(IOCLOSE);                                  /*@0001VLS*/ 02742000
         L     @15,ADIOHND(,R2)                                    0962 02743000
         LA    @01,@AL00962                                        0962 02744000
         BALR  @14,@15                                             0962 02745000
*  END;                                                    /*@0001VLS*/ 02746000
*IF MAXENT <= I & ERROR ^= ENDFILE & GETFAIL = OFF THEN            0964 02747000
@RF00958 L     @14,MAXENT                                          0964 02748000
         C     @14,I                                               0964 02749000
         BH    @RF00964                                            0964 02750000
         CLC   ERROR(4),@CF00064                                   0964 02751000
         BE    @RF00964                                            0964 02752000
         TM    GETFAIL,B'00001000'                                 0964 02753000
         BNZ   @RF00964                                            0964 02754000
*  DO;            /*WORLD, DONT TELL EREP1, DONT LET LOGREC BE*/   0965 02755000
*    ZEROALL = NO;       /*RESET.                            @Z427VLS*/ 02756000
         NI    ZEROALL(R2),B'10111111'                             0966 02757000
*    MSGNO = 3;                                            /*@Z427VLS*/ 02758000
         MVI   MSGNO,X'03'                                         0967 02759000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 02760000
         BAL   @14,ERRMSG                                          0968 02761000
*    ERROR = ZERO;                                         /*@0001VLS*/ 02762000
         SLR   @14,@14                                             0969 02763000
         ST    @14,ERROR                                           0969 02764000
*    IF PHIST = ON THEN                                            0970 02765000
         TM    PHIST(R2),B'00100000'                               0970 02766000
         BNO   @RF00970                                            0970 02767000
*      DO;                                                 /*@Z427VLS*/ 02768000
*        CLOSEIO = (CLOSEIO && CLOSEIO);                   /*@Z427VLS*/ 02769000
         XC    CLOSEIO(2,R2),CLOSEIO(R2)                           0972 02770000
*        CACCIN = ON;                                      /*@Z427VLS*/ 02771000
         OI    CACCIN(R2),B'00010000'                              0973 02772000
*        CALL IOHND(IOCLOSE);                              /*@Z427VLS*/ 02773000
         L     @15,ADIOHND(,R2)                                    0974 02774000
         LA    @01,@AL00974                                        0974 02775000
         BALR  @14,@15                                             0974 02776000
*     END;                                                 /*@G51DGBB*/ 02777000
* END;                                                     /*@G51DGBB*/ 02778000
@RF00970 DS    0H                                                  0977 02779000
* IF ERROR = FOUR THEN                                             0977 02780000
@RF00964 CLC   ERROR(4),@CF00064                                   0977 02781000
         BNE   @RF00977                                            0977 02782000
*   DO;                                                    /*@G51DGBB*/ 02783000
*     R15 = ZERO;                                          /*@G51DGBB*/ 02784000
         SLR   R15,R15                                             0979 02785000
*     ERROR = ZERO;                                        /*@G51DGBB*/ 02786000
         SLR   @14,@14                                             0980 02787000
         ST    @14,ERROR                                           0980 02788000
*   END;                                                   /*@G51DGBB*/ 02789000
*/*THE FOLLOWING CODE MUST BE ADDED TO THE END OF FILE PROC BEFORE*/    02790000
*/*CLOSING ACCDEV TO WRITE FRAMES TO ACCDEV, IF NECESSARY    @G51DGBB*/ 02791000
*IF R15 < TWELVE &             /*IF NON TERMINATE RETURN CODE */   0982 02792000
*   FRAMEPTR ^= ZERO THEN      /*IF FRAME TABLE WAS ALLOCATED */   0982 02793000
@RF00977 C     R15,@CF00032                                        0982 02794000
         BNL   @RF00982                                            0982 02795000
         SLR   @14,@14                                             0982 02796000
         L     @08,FRAMEPTR(,R2)                                   0982 02797000
         CR    @08,@14                                             0982 02798000
         BE    @RF00982                                            0982 02799000
* DO;                                                      /*@G51DGBB*/ 02800000
*    IF  FRAMENUM > ZERO THEN /* IF ENTRIES IN FRAMTAB HAVE BEEN BUILT* 02801000
         C     @14,FRAMENUM(,@08)                                  0984 02802000
         BNL   @RF00984                                            0984 02803000
*      DO;                                                 /*@G51DGBB*/ 02804000
*         IF PHIST = ON THEN /*IF DIRECTWK WAS USED TO STORE FRAMES */  02805000
         TM    PHIST(R2),B'00100000'                               0986 02806000
         BNO   @RF00986                                            0986 02807000
*           DO;                                            /*@G51DGBB*/ 02808000
*             CLOSEIO = (CLOSEIO && CLOSEIO); /*ZERO CLOSE FLAGS*/ 0988 02809000
         XC    CLOSEIO(2,R2),CLOSEIO(R2)                           0988 02810000
*             CDRCTWRK = ON;      /*INDICATE CLOSE OF DIRECTWK FOR  */  02811000
         OI    CDRCTWRK(R2),B'00000010'                            0989 02812000
*             CALL IOHND(IOCLOSE); /*WRITING, IMPLICITLY OPENED FOR RD* 02813000
         L     @15,ADIOHND(,R2)                                    0990 02814000
         LA    @01,@AL00990                                        0990 02815000
         BALR  @14,@15                                             0990 02816000
*           END;                                           /*@G51DGBB*/ 02817000
*         DO A = 1 BY 1 TO FRAMENUM WHILE R15 < FOUR;       /*SETS. */  02818000
@RF00986 LA    @14,1                                               0992 02819000
         ST    @14,A                                               0992 02820000
         B     @DE00992                                            0992 02821000
@DL00992 C     R15,@CF00064                                        0992 02822000
         BNL   @DC00992                                            0992 02823000
*           IF FRAMETYP(A) = ALLALL THEN /*IF COMPLETE SET   @G51DGBB*/ 02824000
         MH    @14,@CH00227                                        0993 02825000
         L     @08,FRAMEPTR(,R2)                                   0993 02826000
         ST    @14,@TF00001                                        0993 02827000
         ALR   @14,@08                                             0993 02828000
         AL    @14,@CF01576                                        0993 02829000
         CLI   FRAMETYP-17(@14),X'FF'                              0993 02830000
         BNE   @RF00993                                            0993 02831000
*             DO;                                          /*@G51DGBB*/ 02832000
*               LISTPTR = FRAMLOCM(A);   /*ESTABLISH LISTLOC ADDR.*/    02833000
         L     @14,@TF00001                                        0995 02834000
         AL    @08,@CF01577                                        0995 02835000
         L     @14,FRAMLOCM-20(@14,@08)                            0995 02836000
         ST    @14,LISTPTR                                         0995 02837000
*               DO Z = 1 BY 1 TO LISTNUM WHILE R15 < FOUR ;/*@G51DGBB*/ 02838000
         LA    @14,1                                               0996 02839000
         ST    @14,Z                                               0996 02840000
         B     @DE00996                                            0996 02841000
@DL00996 C     R15,@CF00064                                        0996 02842000
         BNL   @DC00996                                            0996 02843000
*                 RECCCHHR = LISTCCHR(Z);  /*GET ALL MCH FRAMES*/  0997 02844000
         MH    @14,@CH00079                                        0997 02845000
         L     @08,LISTPTR                                         0997 02846000
         ALR   @08,@14                                             0997 02847000
         BCTR  @08,0                                               0997 02848000
         MVC   RECCCHHR(5,R2),LISTCCHR-4(@08)                      0997 02849000
*                 CALL IOHND(READIRCT);    /*READ FRAME FROM DIRECTWK*/ 02850000
         L     @15,ADIOHND(,R2)                                    0998 02851000
         LA    @01,@AL00998                                        0998 02852000
         BALR  @14,@15                                             0998 02853000
*                 IF R15 = ZERO THEN       /*WRITE FRAME TO ACCDEV*/    02854000
         LTR   R15,R15                                             0999 02855000
         BNZ   @RF00999                                            0999 02856000
*                   CALL IOHND(RITEHIST);                  /*@G51DGBB*/ 02857000
         L     @15,ADIOHND(,R2)                                    1000 02858000
         LA    @01,@AL01000                                        1000 02859000
         BALR  @14,@15                                             1000 02860000
*              END;                                        /*@G51DGBB*/ 02861000
@RF00999 LA    @14,1                                               1001 02862000
         AL    @14,Z                                               1001 02863000
         ST    @14,Z                                               1001 02864000
@DE00996 L     @08,LISTPTR                                         1001 02865000
         C     @14,LISTNUM(,@08)                                   1001 02866000
         BNH   @DL00996                                            1001 02867000
@DC00996 DS    0H                                                  1002 02868000
*              IF R15 = ZERO THEN /*IF NO ACCDEV WRITE ERROR @G51DGBB*/ 02869000
         LTR   R15,R15                                             1002 02870000
         BNZ   @RF01002                                            1002 02871000
*                DO;                                       /*@G51DGBB*/ 02872000
*                  LISTPTR = FRAMLOCC(A); /*GET CCH FRAMES   @G51DGBB*/ 02873000
         L     @14,A                                               1004 02874000
         MH    @14,@CH00227                                        1004 02875000
         L     @08,FRAMEPTR(,R2)                                   1004 02876000
         L     @14,FRAMLOCC-24(@14,@08)                            1004 02877000
         ST    @14,LISTPTR                                         1004 02878000
*                  DO Z = 1 BY 1 TO LISTNUM WHILE R15 < FOUR;      1005 02879000
         LA    @14,1                                               1005 02880000
         ST    @14,Z                                               1005 02881000
         B     @DE01005                                            1005 02882000
@DL01005 C     R15,@CF00064                                        1005 02883000
         BNL   @DC01005                                            1005 02884000
*                    RECCCHHR = LISTCCHR(Z);               /*@G51DGBB*/ 02885000
         MH    @14,@CH00079                                        1006 02886000
         L     @08,LISTPTR                                         1006 02887000
         ALR   @08,@14                                             1006 02888000
         BCTR  @08,0                                               1006 02889000
         MVC   RECCCHHR(5,R2),LISTCCHR-4(@08)                      1006 02890000
*                      CALL IOHND(READIRCT); /*READ FRAME OFF DRCTWK*/  02891000
         L     @15,ADIOHND(,R2)                                    1007 02892000
         LA    @01,@AL01007                                        1007 02893000
         BALR  @14,@15                                             1007 02894000
*                      IF R15 = ZERO THEN    /*IF SUCCESS THEN WRITE*/  02895000
         LTR   R15,R15                                             1008 02896000
         BNZ   @RF01008                                            1008 02897000
*                        CALL IOHND(RITEHIST); /*TO ACCDEV   @G51DGBB*/ 02898000
         L     @15,ADIOHND(,R2)                                    1009 02899000
         LA    @01,@AL01009                                        1009 02900000
         BALR  @14,@15                                             1009 02901000
*                    END;                                  /*@G51DGBB*/ 02902000
@RF01008 LA    @14,1                                               1010 02903000
         AL    @14,Z                                               1010 02904000
         ST    @14,Z                                               1010 02905000
@DE01005 L     @08,LISTPTR                                         1010 02906000
         C     @14,LISTNUM(,@08)                                   1010 02907000
         BNH   @DL01005                                            1010 02908000
@DC01005 DS    0H                                                  1011 02909000
*                 END;                                     /*@G51DGBB*/ 02910000
*             END;                                         /*@G51DGBB*/ 02911000
*           ELSE  /*INCOMPLETE FRAME SET                     @G51DGBB*/ 02912000
*             DO;                                          /*@G51DGBB*/ 02913000
         B     @RC00993                                            1013 02914000
@RF00993 DS    0H                                                  1014 02915000
*               MSGNO = 78; /*MISSING FRAME SET MESSAGE      @G51DGBB*/ 02916000
         MVI   MSGNO,X'4E'                                         1014 02917000
*               CCHINDX = A;   /*CORRECT DEBUG FRAME COUNTS BY */  1015 02918000
         L     @14,A                                               1015 02919000
         ST    @14,CCHINDX                                         1015 02920000
*               CALL ERRMSG;                               /*@G51DGBB*/ 02921000
         BAL   @14,ERRMSG                                          1016 02922000
*               CALL FIXENTRY; /*PASSING ENTRY INDEX TO FIXENTRY*/ 1017 02923000
         BAL   @14,FIXENTRY                                        1017 02924000
*             END;                                         /*@G51DGBB*/ 02925000
*         END;                                             /*@G51DGBB*/ 02926000
@RC00993 LA    @14,1                                               1019 02927000
         AL    @14,A                                               1019 02928000
         ST    @14,A                                               1019 02929000
@DE00992 L     @08,FRAMEPTR(,R2)                                   1019 02930000
         C     @14,FRAMENUM(,@08)                                  1019 02931000
         BNH   @DL00992                                            1019 02932000
@DC00992 DS    0H                                                  1020 02933000
*      END;                                                /*@G51DGBB*/ 02934000
*     GEN(FREEMAIN R,SP=21);                               /*@G51DGBB*/ 02935000
@RF00984 DS    0H                                                  1021 02936000
         FREEMAIN R,SP=21                                               02937000
* END;                                                     /*@G51DGBB*/ 02938000
*IF ERROR = OVERFLOW | ERROR = ENDFILE THEN                        1023 02939000
@RF00982 L     @14,ERROR                                           1023 02940000
         C     @14,@CF00066                                        1023 02941000
         BE    @RT01023                                            1023 02942000
         C     @14,@CF00064                                        1023 02943000
         BNE   @RF01023                                            1023 02944000
@RT01023 DS    0H                                                  1024 02945000
*  ERROR = ZERO;                                           /*@0001VLS*/ 02946000
         SLR   @14,@14                                             1024 02947000
         ST    @14,ERROR                                           1024 02948000
*BUG(40) = BUG(2) + BUG(3) + BUG(4) + BUG(5) + BUG(6); /*ADD SAVED*/    02949000
@RF01023 L     @14,BUG+4                                           1025 02950000
         AL    @14,BUG+8                                           1025 02951000
         AL    @14,BUG+12                                          1025 02952000
         AL    @14,BUG+16                                          1025 02953000
         AL    @14,BUG+20                                          1025 02954000
         ST    @14,BUG+156                                         1025 02955000
*/*SOFT, MCH, CCH, IPL, AND EOD RECORDS USED IN SYSUM PART ONE*/   1026 02956000
*NUMREC = BUG(40);                                         /*@G51DGBB*/ 02957000
         ST    @14,NUMREC                                          1026 02958000
*CVD(NUMREC,PACKPAS); /*PRINT NUMBER OF RECORDS PASSED FILTERING*/ 1027 02959000
         CVD   @14,@TS00001                                        1027 02960000
         MVC   PACKPAS(4),@TS00001+4                               1027 02961000
*PACKPAS = (PACKPAS | '0000000F'X); /*CHANGE SIGN FROM C TO F*/    1028 02962000
         OC    PACKPAS(4),@CB01482                                 1028 02963000
*UNPK(EDFLD,PACKPAS);                                      /*@Z427VLS*/ 02964000
         UNPK  EDFLD(9),PACKPAS(4)                                 1029 02965000
*NONBLANK = OFF; /*INITIALIZE TO NO LEADING ZEROS            @G51DGBB*/ 02966000
         NI    NONBLANK,B'01111111'                                1030 02967000
*DO J = 1 BY 1 TO 8 WHILE NONBLANK = OFF;                  /*@Z427VLS*/ 02968000
         LA    @14,1                                               1031 02969000
         ST    @14,J                                               1031 02970000
@DL01031 TM    NONBLANK,B'10000000'                                1031 02971000
         BNZ   @DC01031                                            1031 02972000
*  IF EDIFILD(J) = CHARZERO THEN                                   1032 02973000
         LA    @08,EDIFILD-1(@14)                                  1032 02974000
         CLI   0(@08),X'F0'                                        1032 02975000
         BNE   @RF01032                                            1032 02976000
*    EDIFILD(J) = BLANK;                                   /*@Z427VLS*/ 02977000
         LA    @08,EDIFILD-1(@14)                                  1033 02978000
         MVI   0(@08),X'40'                                        1033 02979000
*  ELSE                                                            1034 02980000
*    NONBLANK = ON;                                        /*@Z427VLS*/ 02981000
         B     @RC01032                                            1034 02982000
@RF01032 OI    NONBLANK,B'10000000'                                1034 02983000
*END;                                                      /*@Z427VLS*/ 02984000
@RC01032 LA    @14,1                                               1035 02985000
         AL    @14,J                                               1035 02986000
         ST    @14,J                                               1035 02987000
         C     @14,@CF00066                                        1035 02988000
         BNH   @DL01031                                            1035 02989000
@DC01031 DS    0H                                                  1036 02990000
*PRINTADR = ADDR(PRINTLIN);                                /*@Z427VLS*/ 02991000
         LA    @14,PRINTLIN                                        1036 02992000
         ST    @14,PRINTADR(,R2)                                   1036 02993000
*CALL IFCMSG(75,ADDR(PRINTBDY));                           /*@Z427VLS*/ 02994000
         LA    @14,PRINTBDY                                        1037 02995000
         ST    @14,@AFTEMPS                                        1037 02996000
         L     @15,ADIFCMSG(,R2)                                   1037 02997000
         LA    @01,@AL01037                                        1037 02998000
         BALR  @14,@15                                             1037 02999000
*PRINTED=EDFLD;                                            /*@Z427VLS*/ 03000000
         MVC   PRINTED(9),EDFLD                                    1038 03001000
*CALL IOHND(RITEPRTR);                                     /*@Z427VLS*/ 03002000
         L     @15,ADIOHND(,R2)                                    1039 03003000
         LA    @01,@AL01039                                        1039 03004000
         BALR  @14,@15                                             1039 03005000
*CVD(ZZ3,PACKPAS);                                         /*@0099VLS*/ 03006000
         L     @14,ZZ3                                             1040 03007000
         CVD   @14,@TS00001                                        1040 03008000
         MVC   PACKPAS(4),@TS00001+4                               1040 03009000
*PACKPAS = (PACKPAS | '0000000F'X); /*CHANGE SIGN TO F       @Z427VLS*/ 03010000
         OC    PACKPAS(4),@CB01482                                 1041 03011000
*UNPK(EDFLD,PACKPAS); /*CONVERT PACK TO PRINTABLE            @Z427VLS*/ 03012000
         UNPK  EDFLD(9),PACKPAS(4)                                 1042 03013000
*NONBLANK = OFF; /*REINITIALIZE SWITCH                       @Z427VLS*/ 03014000
         NI    NONBLANK,B'01111111'                                1043 03015000
*DO J = 1 BY 1 TO 8 WHILE NONBLANK = OFF;                  /*@Z427VLS*/ 03016000
         LA    @14,1                                               1044 03017000
         ST    @14,J                                               1044 03018000
@DL01044 TM    NONBLANK,B'10000000'                                1044 03019000
         BNZ   @DC01044                                            1044 03020000
*  IF EDIFILD(J) = CHARZERO THEN                                   1045 03021000
         LA    @08,EDIFILD-1(@14)                                  1045 03022000
         CLI   0(@08),X'F0'                                        1045 03023000
         BNE   @RF01045                                            1045 03024000
*    EDIFILD(J) = BLANK;                                   /*@Z427VLS*/ 03025000
         LA    @08,EDIFILD-1(@14)                                  1046 03026000
         MVI   0(@08),X'40'                                        1046 03027000
*  ELSE                                                            1047 03028000
*    NONBLANK = ON;                                        /*@Z427VLS*/ 03029000
         B     @RC01045                                            1047 03030000
@RF01045 OI    NONBLANK,B'10000000'                                1047 03031000
*END;                                                      /*@Z427VLS*/ 03032000
@RC01045 LA    @14,1                                               1048 03033000
         AL    @14,J                                               1048 03034000
         ST    @14,J                                               1048 03035000
         C     @14,@CF00066                                        1048 03036000
         BNH   @DL01044                                            1048 03037000
@DC01044 DS    0H                                                  1049 03038000
*PRINTADR = ADDR(PRINTLIN);                                /*@Z427VLS*/ 03039000
         LA    @14,PRINTLIN                                        1049 03040000
         ST    @14,PRINTADR(,R2)                                   1049 03041000
*CALL IFCMSG(76,ADDR(PRINTBDY));                           /*@Z427VLS*/ 03042000
         LA    @14,PRINTBDY                                        1050 03043000
         ST    @14,@AFTEMPS                                        1050 03044000
         L     @15,ADIFCMSG(,R2)                                   1050 03045000
         LA    @01,@AL01050                                        1050 03046000
         BALR  @14,@15                                             1050 03047000
*PRINTED=EDFLD;                                            /*@Z427VLS*/ 03048000
         MVC   PRINTED(9),EDFLD                                    1051 03049000
*CALL IOHND(RITEPRTR);                                     /*@0001VLS*/ 03050000
         L     @15,ADIOHND(,R2)                                    1052 03051000
         LA    @01,@AL01052                                        1052 03052000
         BALR  @14,@15                                             1052 03053000
*IF ERROR ^= NOSRTABL THEN                                         1053 03054000
         CLC   ERROR(4),@CF00032                                   1053 03055000
         BE    @RF01053                                            1053 03056000
* DO;                                                      /*@Z427VLS*/ 03057000
*   SORTNUM = PASSNUM; /*TELL EREP1 HOW MANY RECORDS IN SORTABLE*/ 1055 03058000
         L     @14,PASSNUM                                         1055 03059000
         ST    @14,SORTNUM(,R2)                                    1055 03060000
*   EXCESS = TABSIZE - (SORTNUM * LENGTH(SYSUM2));         /*@D3506GB*/ 03061000
         L     @08,TABSIZE(,R2)                                    1056 03062000
         MH    @14,@CH01057                                        1056 03063000
         LCR   @14,@14                                             1056 03064000
         ALR   @14,@08                                             1056 03065000
         ST    @14,EXCESS                                          1056 03066000
*   IF EXCESS > 16 THEN /*IF AT LEAST A DOUBLEWORD TO FREE AFTER*/ 1057 03067000
         C     @14,@CF00088                                        1057 03068000
         BNH   @RF01057                                            1057 03069000
*     DO;               /*ROUNDING THE BYTE COUNT            @Z427VLS*/ 03070000
*       EXCESS = (EXCESS & DBWRD); /*ROUND DOWN TO DOUBLEWORD AMMOUNT*/ 03071000
         N     @14,@CF00893                                        1059 03072000
         ST    @14,EXCESS                                          1059 03073000
*       RESPECIFY (R0,R1) RESTRICTED;                      /*@Z427VLS*/ 03074000
*       R0 = EXCESS;                                       /*@Z427VLS*/ 03075000
         LR    R0,@14                                              1061 03076000
*       R1 = SORTADR + TABSIZE - EXCESS; /*POINT TO BEGINNING OF UNUSE* 03077000
         AL    @08,SORTADR(,R2)                                    1062 03078000
         SLR   @08,@14                                             1062 03079000
         LR    R1,@08                                              1062 03080000
*       GEN(FREEMAIN  R,LV=(0),A=(1));                     /*@Z427VLS*/ 03081000
         FREEMAIN  R,LV=(0),A=(1)                                       03082000
*       RESPECIFY (R0,R1) UNRESTRICTED;                    /*@Z427VLS*/ 03083000
*     END;                                                 /*@Z427VLS*/ 03084000
*     RESPECIFY(R1) UNRESTRICTED;                          /*@Z427VLS*/ 03085000
@RF01057 DS    0H                                                  1067 03086000
*  END;                                                    /*@Z427VLS*/ 03087000
*IF SORTNUM = ZERO & NUMREC = ZERO THEN                            1068 03088000
@RF01053 SLR   @14,@14                                             1068 03089000
         C     @14,SORTNUM(,R2)                                    1068 03090000
         BNE   @RF01068                                            1068 03091000
         C     @14,NUMREC                                          1068 03092000
         BNE   @RF01068                                            1068 03093000
*  ERROR = TERMINAT;                                       /*@0001VLS*/ 03094000
         MVC   ERROR(4),@CF00032                                   1069 03095000
*IF ERROR = SUCCESS THEN                                           1070 03096000
@RF01068 SLR   @14,@14                                             1070 03097000
         C     @14,ERROR                                           1070 03098000
         BNE   @RF01070                                            1070 03099000
* DO;                                                      /*@Z427VLS*/ 03100000
*  IF NUMREC > ZERO | SORTNUM > ZERO THEN /*IF SOME PART1 RECORDS*/     03101000
         C     @14,NUMREC                                          1072 03102000
         BL    @RT01072                                            1072 03103000
         C     @14,SORTNUM(,R2)                                    1072 03104000
         BNL   @RF01072                                            1072 03105000
@RT01072 DS    0H                                                  1073 03106000
*    CALL SORTONE; /*SORT EVTABLE,SYSUMONE,SET EVLETTER IF UNSET*/ 1073 03107000
         BAL   @14,SORTONE                                         1073 03108000
*  IF SORTNUM > ZERO THEN /*IF SOME OBR,MDR RECS SAVED IN SYSUM2*/ 1074 03109000
@RF01072 L     @14,SORTNUM(,R2)                                    1074 03110000
         LTR   @14,@14                                             1074 03111000
         BNP   @RF01074                                            1074 03112000
*    CALL SORTWO; /*SORT SYSUM2                              @Z427VLS*/ 03113000
         BAL   @14,SORTWO                                          1075 03114000
* END;                                                     /*@Z427VLS*/ 03115000
*RESPECIFY (R15) UNRESTRICTED;                             /*@Z427VLS*/ 03116000
*END; /*CLOSING END TO PROC ENDOFILE                         @Z427VLS*/ 03117000
@EL00023 DS    0H                                                  1078 03118000
@EF00023 DS    0H                                                  1078 03119000
@ER00023 LM    @14,@12,@SA00023                                    1078 03120000
         BR    @14                                                 1078 03121000
*ALLREC: PROC;  /*RECORD DEPENDENT SELECTION CRITTERIA       @Z427VLS*/ 03122000
ALLREC   STM   @14,@12,@SA00024                                    1079 03123000
*               /*COMPARE RECORD ITEMS PRECEEDED BY          @Z427VLS*/ 03124000
*               /* LRT TO PARAMETER TABLE SELECTION          @Z427VLS*/ 03125000
*               /*VALUES AND RANGES                          @Z427VLS*/ 03126000
*PASSFLAG = YES; /*RECORD SELECTED IF PASSFLAG NOT SET TO NO @Z427VLS*/ 03127000
         OI    PASSFLAG(R2),B'00000001'                            1080 03128000
*IF LRTDATE >= STDATE & LRTDATE <= ENDDATE THEN                    1081 03129000
         CLC   LRTDATE(4,R7),STDATE(R2)                            1081 03130000
         BL    @RF01081                                            1081 03131000
         CLC   LRTDATE(4,R7),ENDDATE(R2)                           1081 03132000
         BH    @RF01081                                            1081 03133000
*  DO;                                                     /*@Z427VLS*/ 03134000
*    IF (LRTTIME >= STTIME1 & LRTTIME <= ENDTIME1) |               1083 03135000
*       (LRTTIME >= STTIME2 & LRTTIME <= ENDTIME2) THEN            1083 03136000
         CLC   LRTTIME(4,R7),STTIME1(R2)                           1083 03137000
         BL    @GL00068                                            1083 03138000
         CLC   LRTTIME(4,R7),ENDTIME1(R2)                          1083 03139000
         BNH   @RT01083                                            1083 03140000
@GL00068 CLC   LRTTIME(4,R7),STTIME2(R2)                           1083 03141000
         BL    @RF01083                                            1083 03142000
         CLC   LRTTIME(4,R7),ENDTIME2(R2)                          1083 03143000
         BH    @RF01083                                            1083 03144000
@RT01083 DS    0H                                                  1084 03145000
*      DO;                                                 /*@Z427VLS*/ 03146000
*        IF CPUPTR ^= ZERO THEN                                    1085 03147000
         L     @08,CPUPTR(,R2)                                     1085 03148000
         LTR   @08,@08                                             1085 03149000
         BZ    @RF01085                                            1085 03150000
*         DO;                                              /*@Z427VLS*/ 03151000
*          CPUOK = NO;                                     /*@Z427VLS*/ 03152000
         NI    CPUOK,B'11011111'                                   1087 03153000
*          DO Z = 1 BY 1 TO CPUNUM WHILE CPUOK = NO;       /*@Z427VLS*/ 03154000
         LA    @08,1                                               1088 03155000
         ST    @08,Z                                               1088 03156000
         B     @DE01088                                            1088 03157000
@DL01088 TM    CPUOK,B'00100000'                                   1088 03158000
         BNZ   @DC01088                                            1088 03159000
*           IF CPUVAL(Z) = LRTCPMOD THEN CPUOK = YES;      /*@Z427VLS*/ 03160000
         MH    @08,@CH00079                                        1089 03161000
         L     @06,CPUPTR(,R2)                                     1089 03162000
         ALR   @06,@08                                             1089 03163000
         AL    @06,@CF01570                                        1089 03164000
         CLC   CPUVAL-2(5,@06),LRTCPMOD(R7)                        1089 03165000
         BNE   @RF01089                                            1089 03166000
         OI    CPUOK,B'00100000'                                   1090 03167000
*          END;                                            /*@Z427VLS*/ 03168000
@RF01089 LA    @08,1                                               1091 03169000
         AL    @08,Z                                               1091 03170000
         ST    @08,Z                                               1091 03171000
@DE01088 L     @06,CPUPTR(,R2)                                     1091 03172000
         CH    @08,CPUNUM(,@06)                                    1091 03173000
         BNH   @DL01088                                            1091 03174000
@DC01088 DS    0H                                                  1092 03175000
*          IF CPUOK = NO THEN                                      1092 03176000
         TM    CPUOK,B'00100000'                                   1092 03177000
         BNZ   @RF01092                                            1092 03178000
*           DO;                                            /*@Z427VLS*/ 03179000
*            PASSFLAG = NO;                                /*@Z427VLS*/ 03180000
         NI    PASSFLAG(R2),B'11111110'                            1094 03181000
*           END;                                           /*@Z427VLS*/ 03182000
*         END;                                             /*@Z427VLS*/ 03183000
@RF01092 DS    0H                                                  1097 03184000
*        IF PASSFLAG = YES THEN                                    1097 03185000
@RF01085 TM    PASSFLAG(R2),B'00000001'                            1097 03186000
         BNO   @RF01097                                            1097 03187000
*        DO;                                               /*@Z427VLS*/ 03188000
*        IF SHIFT3RD = ON &                                        1099 03189000
*          ((LRTDATE = STDATE & LRTTIME < STTIME1) |               1099 03190000
*           (LRTDATE = ENDDATE & LRTTIME > ENDTIME2))              1099 03191000
*           THEN                                                   1099 03192000
         TM    SHIFT3RD(R2),B'00010000'                            1099 03193000
         BNO   @RF01099                                            1099 03194000
         CLC   LRTDATE(4,R7),STDATE(R2)                            1099 03195000
         BNE   @GL00072                                            1099 03196000
         CLC   LRTTIME(4,R7),STTIME1(R2)                           1099 03197000
         BL    @RT01099                                            1099 03198000
@GL00072 CLC   LRTDATE(4,R7),ENDDATE(R2)                           1099 03199000
         BNE   @RF01099                                            1099 03200000
         CLC   LRTTIME(4,R7),ENDTIME2(R2)                          1099 03201000
         BNH   @RF01099                                            1099 03202000
@RT01099 DS    0H                                                  1100 03203000
*              PASSFLAG = NO;                              /*@Z427VLS*/ 03204000
         NI    PASSFLAG(R2),B'11111110'                            1100 03205000
*        END;                                              /*@Z427VLS*/ 03206000
@RF01099 DS    0H                                                  1102 03207000
*      IF PASSFLAG = YES & LRTCPUS = ZERO THEN                     1102 03208000
@RF01097 TM    PASSFLAG(R2),B'00000001'                            1102 03209000
         BNO   @RF01102                                            1102 03210000
         ICM   @08,7,LRTCPUS(R7)                                   1102 03211000
         BNZ   @RF01102                                            1102 03212000
*       DO;                                                /*@Z427VLS*/ 03213000
*        MSGNO = 5;                                        /*@Z427VLS*/ 03214000
         MVI   MSGNO,X'05'                                         1104 03215000
*        CALL ERRMSG;                                      /*@Z427VLS*/ 03216000
         BAL   @14,ERRMSG                                          1105 03217000
*        PASSFLAG = NO;                                    /*@Z427VLS*/ 03218000
         NI    PASSFLAG(R2),B'11111110'                            1106 03219000
*       END;                                               /*@Z427VLS*/ 03220000
*      END;                                                /*@Z427VLS*/ 03221000
*    ELSE                                                          1109 03222000
*      PASSFLAG = NO;                                      /*@Z427VLS*/ 03223000
         B     @RC01083                                            1109 03224000
@RF01083 NI    PASSFLAG(R2),B'11111110'                            1109 03225000
*   END;                                                   /*@Z427VLS*/ 03226000
*  ELSE                                                            1111 03227000
*   PASSFLAG = NO;                                         /*@Z427VLS*/ 03228000
         B     @RC01081                                            1111 03229000
@RF01081 NI    PASSFLAG(R2),B'11111110'                            1111 03230000
*END;                                                      /*@Z427VLS*/ 03231000
@EL00024 DS    0H                                                  1112 03232000
@EF00024 DS    0H                                                  1112 03233000
@ER00024 LM    @14,@12,@SA00024                                    1112 03234000
         BR    @14                                                 1112 03235000
*SORTWO  : PROC;                                           /*@Z427VLS*/ 03236000
SORTWO   STM   @14,@12,@SA00025                                    1113 03237000
*  /*MUST ADJUST POINTERS TO EVTABLE, SYSCPU AND SYSOLD, AS A RESULT*/  03238000
*  /*OF SORT OF EVTABLE                                      @Z427VLS*/ 03239000
*  /* INVERT 'FLIPFLOP' FOR ADJUSTING CPU INDICES           @ZA36003 */ 03240000
*    RESPECIFY(R8) RESTRICTED;                           /* @ZA36003 */ 03241000
*    DO I = 1 TO 16 WHILE I <= EVNUM;  /* INTERCHANGE       @ZA36003 */ 03242000
         LA    @06,1                                               1115 03243000
         ST    @06,I                                               1115 03244000
@DL01115 L     @03,EVPTR(,R2)                                      1115 03245000
         CH    @06,EVNUM(,@03)                                     1115 03246000
         BH    @DC01115                                            1115 03247000
*      R8 = FLIPFLOP(I);               /*  FLIPFLOP VALUES  @ZA36003 */ 03248000
         SLR   R8,R8                                               1116 03249000
         IC    R8,FLIPFLOP-1(@06)                                  1116 03250000
*      FLIPCPUS(R8+1) = I-1;           /*  AND INDICES      @ZA36003 */ 03251000
         LR    @03,@06                                             1117 03252000
         BCTR  @03,0                                               1117 03253000
         STC   @03,FLIPCPUS(R8)                                    1117 03254000
*    END; /* INVERSION OF 'FLIPFLOP'.                       @ZA36003 */ 03255000
         AL    @06,@CF00055                                        1118 03256000
         ST    @06,I                                               1118 03257000
         C     @06,@CF00088                                        1118 03258000
         BNH   @DL01115                                            1118 03259000
@DC01115 DS    0H                                                  1119 03260000
*    RESPECIFY(R8) UNRESTRICTED;                         /* @ZA36003 */ 03261000
*  DO J = 1 BY 1 TO PASSNUM; /*EXAMINE ALL ENTRIES OF SYSUM2 @Z427VLS*/ 03262000
         LA    @08,1                                               1120 03263000
         ST    @08,J                                               1120 03264000
         B     @DE01120                                            1120 03265000
@DL01120 DS    0H                                                  1121 03266000
*    WORKBYTE = TMPCPUS(J); /*GET CPU,OLD FROM PARTICULAR ENTRY*/  1121 03267000
         LR    @06,@08                                             1121 03268000
         MH    @06,@CH01057                                        1121 03269000
         L     @03,SORTADR(,R2)                                    1121 03270000
         ST    @06,@TF00001                                        1121 03271000
         ALR   @06,@03                                             1121 03272000
         AL    @06,@CF01578                                        1121 03273000
         MVC   WORKBYTE(1),TMPCPUS-3(@06)                          1121 03274000
*    WORKTWO  = WORKBYTE; /*DITTO                            @Z427VLS*/ 03275000
         MVC   WORKTWO(1),WORKBYTE                                 1122 03276000
*    SRL(WORKBYTE,4); /*WORKBYTE, WORKNUM NOW ARE TMPCPU     @Z427VLS*/ 03277000
         SLR   @06,@06                                             1123 03278000
         IC    @06,WORKBYTE                                        1123 03279000
         SRL   @06,4                                               1123 03280000
         STC   @06,WORKBYTE                                        1123 03281000
*    WORKTWO = (WORKTWO & '0F'X);   /*WORKTWO, WORKNM2 NOW ARE TMPOLD*/ 03282000
         NI    WORKTWO,X'0F'                                       1124 03283000
*    WORKNM2 = WORKNM2 + 1; /*ADJUST INDEX TO START AT ONE, NOT ZERO*/  03284000
         LA    @06,1                                               1125 03285000
         SLR   @15,@15                                             1125 03286000
         IC    @15,WORKNM2                                         1125 03287000
         ALR   @15,@06                                             1125 03288000
         STC   @15,WORKNM2                                         1125 03289000
*    TMPCPUS(J) = FLIPCPUS(WORKNM2);    /*SET SORTED TMPOLD @ZA36003 */ 03290000
         LR    @01,@03                                             1126 03291000
         AL    @01,@TF00001                                        1126 03292000
         AL    @01,@CF01578                                        1126 03293000
         LA    @14,FLIPCPUS-1(@15)                                 1126 03294000
         MVC   TMPCPUS-3(1,@01),0(@14)                             1126 03295000
*    WORKNM = WORKNM + 1; /*ADJUST INDEX TO START AT ONE, NOT ZERO*/    03296000
         SLR   @15,@15                                             1127 03297000
         IC    @15,WORKNM                                          1127 03298000
         ALR   @06,@15                                             1127 03299000
         STC   @06,WORKNM                                          1127 03300000
*    WORKTWO = FLIPCPUS(WORKNM);     /*SET SORTED TMPCPU    @ZA36003 */ 03301000
         LA    @01,FLIPCPUS-1(@06)                                 1128 03302000
         MVC   WORKTWO(1),0(@01)                                   1128 03303000
*    SLL(WORKTWO,4); /*SET SORTED TMPCPU TO FIRST FOUR BITS  @Z427VLS*/ 03304000
         SLR   @06,@06                                             1129 03305000
         IC    @06,WORKTWO                                         1129 03306000
         SLL   @06,4                                               1129 03307000
         STC   @06,WORKTWO                                         1129 03308000
*    TMPCPUS(J) = (TMPCPUS(J) | WORKTWO); /*PUT VALUE BACK IN RECORD*/  03309000
         LR    @06,@03                                             1130 03310000
         AL    @06,@TF00001                                        1130 03311000
         AL    @06,@CF01578                                        1130 03312000
         OC    TMPCPUS-3(1,@06),WORKTWO                            1130 03313000
*    /*CODE ADDED TO SHIFT 3705 ERROR TYPE PAST TMPCPU INDEX FOR*/ 1131 03314000
*    /*PROPER SORTING. LAST SECOND CHANGE OCT 13, 1976       @Z427VLS*/ 03315000
*    WORKTWO = (TMPCPUS(J) & '0F'X); /*GET OLD CPU INDEX     @Z427VLS*/ 03316000
         LR    @06,@03                                             1131 03317000
         AL    @06,@TF00001                                        1131 03318000
         AL    @06,@CF01578                                        1131 03319000
         MVC   WORKTWO(1),TMPCPUS-3(@06)                           1131 03320000
         NI    WORKTWO,X'0F'                                       1131 03321000
*    TMPCPUS(J) = (TMPCPUS(J) & 'F0'X); /*ZERO OLD CPU INDEX @Z427VLS*/ 03322000
         LR    @06,@03                                             1132 03323000
         AL    @06,@TF00001                                        1132 03324000
         AL    @06,@CF01578                                        1132 03325000
         NI    TMPCPUS-3(@06),X'F0'                                1132 03326000
*    TMPITEM(J) = (TMPITEM(J) | WORKTWO); /*REPLACE OLD INDEX AT TMPOD* 03327000
         AL    @03,@TF00001                                        1133 03328000
         AL    @03,@CF01571                                        1133 03329000
         OC    TMPITEM-4(1,@03),WORKTWO                            1133 03330000
*  END;                                                    /*@Z427VLS*/ 03331000
         AL    @08,@CF00055                                        1134 03332000
         ST    @08,J                                               1134 03333000
@DE01120 C     @08,PASSNUM                                         1134 03334000
         BNH   @DL01120                                            1134 03335000
*/* SORT THAT ONLY EXAMINES AN ENTRY ONCE IF DATA IS IN ORDER*/    1135 03336000
*RESPECIFY (R15,R3,R4,R6,R1) RESTRICTED;                   /*@Z427VLS*/ 03337000
*IF SORTNUM > 1 & DEBUG23 = OFF THEN /*IF AT LEAST TWO RECORDS AND*/    03338000
         L     @14,SORTNUM(,R2)                                    1136 03339000
         C     @14,@CF00055                                        1136 03340000
         BNH   @RF01136                                            1136 03341000
         TM    DEBUG23(R2),B'00000001'                             1136 03342000
         BNZ   @RF01136                                            1136 03343000
*  DO;     /*DEBUG OPTION DOESNT SAY DONT SORT THEN          @Z427VLS*/ 03344000
* SRTCONT = ((PASSNUM-1)*14) + SORTADR;                    /*@D3506GB*/ 03345000
         L     @14,PASSNUM                                         1138 03346000
         BCTR  @14,0                                               1138 03347000
         MH    @14,@CH01057                                        1138 03348000
         AL    @14,SORTADR(,R2)                                    1138 03349000
         ST    @14,SRTCONT                                         1138 03350000
*GENERATE REFS(TMP2,TMPKEY);                               /*@0099VLS*/ 03351000
    LA    R15,14                                                        03352000
    L    R3,SORTADR(R2)                                                 03353000
    L    R4,SRTCONT                                                     03354000
    LR   R1,R3                                                          03355000
    B    DOIT                                                           03356000
LOOPBCK1 ALR  R3,R15                                                    03357000
         CR   R3,R4                                                     03358000
         BNL  DONE                                                      03359000
DOIT   CLC   TMPKEY(6,R3),TMPKEY+14(R3)                                 03360000
         BNH  LOOPBCK1                                                  03361000
       XC    TMP2(14,R3),TMP2+14(R3)                                    03362000
       XC    TMP2+14(14,R3),TMP2(R3)                                    03363000
       XC    TMP2(14,R3),TMP2+14(R3)                                    03364000
         LR   R6,R3                                                     03365000
LOOPBCK2 SR   R6,R15                                                    03366000
         CR   R6,R1                                                     03367000
         BL   LOOPBCK1                                                  03368000
       CLC   TMPKEY(6,R6),TMPKEY+14(R6)                                 03369000
         BNH  LOOPBCK1                                                  03370000
       XC    TMP2+14(14,R6),TMP2(R6)                                    03371000
       XC    TMP2(14,R6),TMP2+14(R6)                                    03372000
       XC    TMP2+14(14,R6),TMP2(R6)                                    03373000
          B     LOOPBCK2           TRY COMPARE UP ONE MORE IN TABLE     03374000
DONE      EQU   *                                                       03375000
*END;                                                      /*@Z427VLS*/ 03376000
* RESPECIFY (R1,R3,R4,R6,R15) UNRESTRICTED;                /*@Z427VLS*/ 03377000
*END; /*CLOSING END TO PROC SORTWO                           @Z427VLS*/ 03378000
@EL00025 DS    0H                                                  1142 03379000
@EF00025 DS    0H                                                  1142 03380000
@ER00025 LM    @14,@12,@SA00025                                    1142 03381000
         BR    @14                                                 1142 03382000
*/*                                                          @Z427VLS*/ 03383000
*MCHFILT: PROC;                                            /*@Z427VLS*/ 03384000
MCHFILT  STM   @14,@12,@SA00026                                    1143 03385000
*IF MCHSYSTR = ON THEN /*IF NON-RECOVERABLE MCH              @Z427VLS*/ 03386000
         TM    MCHSYSTR(R7),B'10000000'                            1144 03387000
         BNO   @RF01144                                            1144 03388000
*  SYSUMMCN = SYSUMMCN + 1;                                /*@Z427VLS*/ 03389000
         L     @08,SYSUMPTR(,R2)                                   1145 03390000
         LA    @06,1                                               1145 03391000
         AL    @06,SYSUMMCN(,@08)                                  1145 03392000
         ST    @06,SYSUMMCN(,@08)                                  1145 03393000
*ELSE            /*IF RECOVERABLE MCH                        @Z427VLS*/ 03394000
*  SYSUMMCR = SYSUMMCR + 1;                                /*@Z427VLS*/ 03395000
         B     @RC01144                                            1146 03396000
@RF01144 L     @08,SYSUMPTR(,R2)                                   1146 03397000
         LA    @06,1                                               1146 03398000
         AL    @06,SYSUMMCR(,@08)                                  1146 03399000
         ST    @06,SYSUMMCR(,@08)                                  1146 03400000
*IF FRAMEPTR ^= ZERO THEN /*IF FRAMETAB HAS BEEN ALLOCATED   @G51DGBB*/ 03401000
@RC01144 L     @08,FRAMEPTR(,R2)                                   1147 03402000
         LTR   @08,@08                                             1147 03403000
         BZ    @RF01147                                            1147 03404000
*DO;                                                       /*@G51DGBB*/ 03405000
*GETOUT = NO;                                              /*@G51DGBB*/ 03406000
         NI    GETOUT,B'11110111'                                  1149 03407000
*DO A = 1 BY 1 TO MRDNUMBR WHILE GETOUT = NO; /*LOOP THROUGH LIST OF */ 03408000
         LA    @08,1                                               1150 03409000
         ST    @08,A                                               1150 03410000
         B     @DE01150                                            1150 03411000
@DL01150 TM    GETOUT,B'00001000'                                  1150 03412000
         BNZ   @DC01150                                            1150 03413000
*                                           /*MERIDIAN-LIKE CPUS   */   03414000
*  IF MODEL(A) = LRTMODEL THEN             /*IF MERIDIAN-LIKE CPU */    03415000
         ALR   @08,@08                                             1151 03416000
         L     @06,MERDCPTR(,R2)                                   1151 03417000
         ALR   @06,@08                                             1151 03418000
         CLC   MODEL-2(2,@06),LRTMODEL(R7)                         1151 03419000
         BNE   @RF01151                                            1151 03420000
*    DO;                                                   /*@G51DGBB*/ 03421000
*      CALL BUILDFTB; /*SEE IF UNIQUE, BUILD FRAMTAB ENTRY IF IT IS */  03422000
         BAL   @14,BUILDFTB                                        1153 03423000
*      GETOUT = YES;  /*EXIT LOOP                            @G51DGBB*/ 03424000
         OI    GETOUT,B'00001000'                                  1154 03425000
*    END;                                                  /*@G51DGBB*/ 03426000
*END;                                                      /*@G51DGBB*/ 03427000
@RF01151 LA    @08,1                                               1156 03428000
         AL    @08,A                                               1156 03429000
         ST    @08,A                                               1156 03430000
@DE01150 L     @06,MERDCPTR(,R2)                                   1156 03431000
         CH    @08,MRDNUMBR(,@06)                                  1156 03432000
         BNH   @DL01150                                            1156 03433000
@DC01150 DS    0H                                                  1157 03434000
*END;                                                      /*@G51DGBB*/ 03435000
*END;                                                      /*@Z427VLS*/ 03436000
@EL00026 DS    0H                                                  1158 03437000
@EF00026 DS    0H                                                  1158 03438000
@ER00026 LM    @14,@12,@SA00026                                    1158 03439000
         BR    @14                                                 1158 03440000
*/*                                                          @Z427VLS*/ 03441000
*/*                                                          @Z427VLS*/ 03442000
*SOFTFILT: PROC;                                           /*@Z427VLS*/ 03443000
SOFTFILT STM   @14,@12,12(@13)                                     1159 03444000
*IF SFTKEY1 = HEX40 THEN /*IF PROGRAM ABEND                  @Z427VLS*/ 03445000
         CLI   SFTKEY1(R7),X'40'                                   1160 03446000
         BNE   @RF01160                                            1160 03447000
* DO;                                                      /*@0001VLS*/ 03448000
*  SYSUMPEA = SYSUMPEA + ONE;                              /*@Z427VLS*/ 03449000
         L     @08,SYSUMPTR(,R2)                                   1162 03450000
         LA    @06,1                                               1162 03451000
         L     @03,SYSUMPEA(,@08)                                  1162 03452000
         ALR   @03,@06                                             1162 03453000
         ST    @03,SYSUMPEA(,@08)                                  1162 03454000
*  BUG(2) = BUG(2) + ONE;                                  /*@0001VLS*/ 03455000
         AL    @06,BUG+4                                           1163 03456000
         ST    @06,BUG+4                                           1163 03457000
* END;                                                     /*@0001VLS*/ 03458000
*ELSE                                                              1165 03459000
*  DO;                                                     /*@Z427VLS*/ 03460000
         B     @RC01160                                            1165 03461000
@RF01160 DS    0H                                                  1166 03462000
*    IF SFTKEY1 = HEX42 THEN /*IF PROGRAM INTERRUPT          @Z427VLS*/ 03463000
         CLI   SFTKEY1(R7),X'42'                                   1166 03464000
         BNE   @RF01166                                            1166 03465000
*     DO;                                                  /*@0001VLS*/ 03466000
*      SYSUMPEI = SYSUMPEI + ONE;                          /*@Z427VLS*/ 03467000
         L     @08,SYSUMPTR(,R2)                                   1168 03468000
         LA    @06,1                                               1168 03469000
         L     @03,SYSUMPEI(,@08)                                  1168 03470000
         ALR   @03,@06                                             1168 03471000
         ST    @03,SYSUMPEI(,@08)                                  1168 03472000
*      BUG(2) = BUG(2) + ONE;                              /*@0001VLS*/ 03473000
         AL    @06,BUG+4                                           1169 03474000
         ST    @06,BUG+4                                           1169 03475000
*     END;                                                 /*@0001VLS*/ 03476000
*    ELSE                                                          1171 03477000
*      DO;                                                 /*@Z427VLS*/ 03478000
         B     @RC01166                                            1171 03479000
@RF01166 DS    0H                                                  1172 03480000
*        IF SFTKEY1 = HEX44 THEN /*IF PROGRAM RESTART        @Z427VLS*/ 03481000
         CLI   SFTKEY1(R7),X'44'                                   1172 03482000
         BNE   @RF01172                                            1172 03483000
*          DO;                                             /*@0001VLS*/ 03484000
*          SYSUMPER = SYSUMPER + ONE;                      /*@Z427VLS*/ 03485000
         L     @08,SYSUMPTR(,R2)                                   1174 03486000
         LA    @06,1                                               1174 03487000
         L     @03,SYSUMPER(,@08)                                  1174 03488000
         ALR   @03,@06                                             1174 03489000
         ST    @03,SYSUMPER(,@08)                                  1174 03490000
*           BUG(2) = BUG(2) + ONE;                         /*@0001VLS*/ 03491000
         AL    @06,BUG+4                                           1175 03492000
         ST    @06,BUG+4                                           1175 03493000
*          END;                                            /*@0001VLS*/ 03494000
*      END;                                                /*@Z427VLS*/ 03495000
*  END;                                                    /*@Z427VLS*/ 03496000
*                                                                  1178 03497000
*END;                                                      /*@Z427VLS*/ 03498000
@EL00027 DS    0H                                                  1179 03499000
@EF00027 DS    0H                                                  1179 03500000
@ER00027 LM    @14,@12,12(@13)                                     1179 03501000
         BR    @14                                                 1179 03502000
*ERRMSG: PROC;                                             /*@Z427VLS*/ 03503000
ERRMSG   STM   @14,@12,@SA00028                                    1180 03504000
*RESPECIFY(R3) RESTRICTED;                                 /*@Z427VLS*/ 03505000
*PRINTADR = ADDR(PRINTLIN);                                /*@Z427VLS*/ 03506000
         LA    @08,PRINTLIN                                        1182 03507000
         ST    @08,PRINTADR(,R2)                                   1182 03508000
*IF MSGNO=1  |                                           /* @XA19728 */ 03509000
*   MSGNO=2  THEN                                        /* @XA19728 */ 03510000
         CLI   MSGNO,1                                             1183 03511000
         BE    @RT01183                                            1183 03512000
         CLI   MSGNO,2                                             1183 03513000
         BNE   @RF01183                                            1183 03514000
@RT01183 DS    0H                                                  1184 03515000
*  DO;                                                     /*@GZZDGVS*/ 03516000
*    ZEROALL=NO;         /* DONT RESET LOGREC HEADER OF ALL  @GZZDGVS*/ 03517000
         NI    ZEROALL(R2),B'10111111'                             1185 03518000
*                        /* RECORDS NOT PROCESSED           @XA19728 */ 03519000
*    CALL IFCMSG(55,ADDR(PRINTBDY));  /*GET FAILED SORT TBL @Z427VLS */ 03520000
         LA    @08,PRINTBDY                                        1186 03521000
         ST    @08,@AFTEMPS+4                                      1186 03522000
         L     @15,ADIFCMSG(,R2)                                   1186 03523000
         LA    @01,@AL01186                                        1186 03524000
         BALR  @14,@15                                             1186 03525000
*  END;                                                    /*@GZZDGVS*/ 03526000
*IF MSGNO = 3 THEN                                                 1188 03527000
@RF01183 CLI   MSGNO,3                                             1188 03528000
         BNE   @RF01188                                            1188 03529000
*   CALL IFCMSG(53,ADDR(PRINTBDY));                        /*@Z427VLS*/ 03530000
         LA    @08,PRINTBDY                                        1189 03531000
         ST    @08,@AFTEMPS+4                                      1189 03532000
         L     @15,ADIFCMSG(,R2)                                   1189 03533000
         LA    @01,@AL01189                                        1189 03534000
         BALR  @14,@15                                             1189 03535000
*IF MSGNO = 6 THEN  /*TOO MANY CPU SERIAL NUMBERS IN INPUT STREAM*/     03536000
@RF01188 CLI   MSGNO,6                                             1190 03537000
         BNE   @RF01190                                            1190 03538000
*  DO;                                                     /*@Z427VLS*/ 03539000
*   CALL IFCMSG(74,ADDR(PRINTBDY));                        /*@Z427VLS*/ 03540000
         LA    @08,PRINTBDY                                        1192 03541000
         ST    @08,@AFTEMPS+4                                      1192 03542000
         L     @15,ADIFCMSG(,R2)                                   1192 03543000
         LA    @01,@AL01192                                        1192 03544000
         BALR  @14,@15                                             1192 03545000
*    ER3 = EVSERIAL(K);                                    /*@Z427VLS*/ 03546000
         L     @08,K                                               1193 03547000
         MH    @08,@CH00081                                        1193 03548000
         L     @06,EVPTR(,R2)                                      1193 03549000
         ALR   @06,@08                                             1193 03550000
         MVC   ER3(3),EVSERIAL-6(@06)                              1193 03551000
*    SLL(ERSER,4); /*SHIFT SERIAL IN ORDER TO ADD PACKED SIGN*/    1194 03552000
         L     @08,ERSER                                           1194 03553000
         SLL   @08,4                                               1194 03554000
         ST    @08,ERSER                                           1194 03555000
*    ER3 = (ER3 | '00000F'X); /*ADD SIGN FOR UNPACKING OPERATION*/ 1195 03556000
         OC    ER3(3),@CB00228                                     1195 03557000
*    UNPK(PRNTSER,ERSER);                                  /*@Z427VLS*/ 03558000
         UNPK  PRNTSER(7),ERSER(4)                                 1196 03559000
*  END;                                                    /*@Z427VLS*/ 03560000
*IF MSGNO = 5   THEN                                               1198 03561000
@RF01190 CLI   MSGNO,5                                             1198 03562000
         BNE   @RF01198                                            1198 03563000
*   CALL IFCMSG(72,ADDR(PRINTBDY));                        /*@Z427VLS*/ 03564000
         LA    @08,PRINTBDY                                        1199 03565000
         ST    @08,@AFTEMPS+4                                      1199 03566000
         L     @15,ADIFCMSG(,R2)                                   1199 03567000
         LA    @01,@AL01199                                        1199 03568000
         BALR  @14,@15                                             1199 03569000
*IF MSGNO = 78 THEN                                                1200 03570000
@RF01198 CLI   MSGNO,78                                            1200 03571000
         BNE   @RF01200                                            1200 03572000
* DO;                                                      /*@G51DGBB*/ 03573000
*   CALL IFCMSG(78,ADDR(PRINTBDY));                        /*@G51DGBB*/ 03574000
         LA    @08,PRINTBDY                                        1202 03575000
         ST    @08,@AFTEMPS+4                                      1202 03576000
         L     @15,ADIFCMSG(,R2)                                   1202 03577000
         LA    @01,@AL01202                                        1202 03578000
         BALR  @14,@15                                             1202 03579000
*   NUMBER = 3;                                            /*@G51DGBB*/ 03580000
         MVC   NUMBER(4),@CF00076                                  1203 03581000
*   ADDNXT = ADDR(PFRAMSER);                               /*@G51DGBB*/ 03582000
         LA    @08,PFRAMSER                                        1204 03583000
         ST    @08,ADDNXT                                          1204 03584000
*   NEXTBY = ADDR(FRAMESER(CCHINDX));                      /*@G51DGBB*/ 03585000
         L     @08,CCHINDX                                         1205 03586000
         MH    @08,@CH00227                                        1205 03587000
         L     @06,FRAMEPTR(,R2)                                   1205 03588000
         AL    @06,@CF01562                                        1205 03589000
         LA    @08,FRAMESER-4(@08,@06)                             1205 03590000
         ST    @08,NEXTBY                                          1205 03591000
*   CALL CONVERT;                                          /*@G51DGBB*/ 03592000
         BAL   @14,CONVERT                                         1206 03593000
*   NUMBER = 2;                                            /*@G51DGBB*/ 03594000
         MVC   NUMBER(4),@CF00074                                  1207 03595000
*   ADDNXT = ADDR(PFRAMMOD);                               /*@G51DGBB*/ 03596000
         LA    @08,PFRAMMOD                                        1208 03597000
         ST    @08,ADDNXT                                          1208 03598000
*   NEXTBY = ADDR(FRAMEMOD(CCHINDX));                      /*@G51DGBB*/ 03599000
         L     @08,CCHINDX                                         1209 03600000
         MH    @08,@CH00227                                        1209 03601000
         L     @06,FRAMEPTR(,R2)                                   1209 03602000
         AL    @06,@CF01579                                        1209 03603000
         LA    @08,FRAMEMOD-7(@08,@06)                             1209 03604000
         ST    @08,NEXTBY                                          1209 03605000
*   CALL CONVERT;                                          /*@G51DGBB*/ 03606000
         BAL   @14,CONVERT                                         1210 03607000
*  END;                                                    /*@G51DGBB*/ 03608000
*IF MSGNO = 79 & DEBUG16 = ON THEN /*IF PARTIAL FRAME SET AND DEBUG16*/ 03609000
@RF01200 CLI   MSGNO,79                                            1212 03610000
         BNE   @RF01212                                            1212 03611000
         TM    DEBUG16(R2),B'10000000'                             1212 03612000
         BNO   @RF01212                                            1212 03613000
*  DO;                                                     /*@G51DGBB*/ 03614000
*    NUMBER = 3;                                           /*@G51DGBB*/ 03615000
         MVC   NUMBER(4),@CF00076                                  1214 03616000
*    ADDNXT = ADDR(PARSER);                                /*@G51DGBB*/ 03617000
         LA    @08,PARSER                                          1215 03618000
         ST    @08,ADDNXT                                          1215 03619000
*    NEXTBY = ADDR(FRAMESER(CCHINDX));                     /*@G51DGBB*/ 03620000
         L     @08,CCHINDX                                         1216 03621000
         MH    @08,@CH00227                                        1216 03622000
         L     @06,FRAMEPTR(,R2)                                   1216 03623000
         AL    @06,@CF01562                                        1216 03624000
         LA    @08,FRAMESER-4(@08,@06)                             1216 03625000
         ST    @08,NEXTBY                                          1216 03626000
*    CALL CONVERT;                                         /*@G51DGBB*/ 03627000
         BAL   @14,CONVERT                                         1217 03628000
*    NUMBER = 2;                                           /*@G51DGBB*/ 03629000
         MVC   NUMBER(4),@CF00074                                  1218 03630000
*    ADDNXT = ADDR(PARMOD);                                /*@G51DGBB*/ 03631000
         LA    @08,PARMOD                                          1219 03632000
         ST    @08,ADDNXT                                          1219 03633000
*    NEXTBY = ADDR(FRAMEMOD(CCHINDX));                     /*@G51DGBB*/ 03634000
         L     @08,CCHINDX                                         1220 03635000
         MH    @08,@CH00227                                        1220 03636000
         L     @06,FRAMEPTR(,R2)                                   1220 03637000
         AL    @06,@CF01579                                        1220 03638000
         LA    @08,FRAMEMOD-7(@08,@06)                             1220 03639000
         ST    @08,NEXTBY                                          1220 03640000
*    CALL CONVERT;                                         /*@G51DGBB*/ 03641000
         BAL   @14,CONVERT                                         1221 03642000
*    NUMBER = 1;                                           /*@G51DGBB*/ 03643000
         MVC   NUMBER(4),@CF00055                                  1222 03644000
*    ADDNXT = ADDR(PARREP);                                /*@G51DGBB*/ 03645000
         LA    @08,PARREP                                          1223 03646000
         ST    @08,ADDNXT                                          1223 03647000
*    NEXTBY = ADDR(FRAMETYP(CCHINDX));                     /*@G51DGBB*/ 03648000
         L     @08,CCHINDX                                         1224 03649000
         MH    @08,@CH00227                                        1224 03650000
         L     @06,FRAMEPTR(,R2)                                   1224 03651000
         AL    @06,@CF01576                                        1224 03652000
         LA    @08,FRAMETYP-17(@08,@06)                            1224 03653000
         ST    @08,NEXTBY                                          1224 03654000
*    CALL CONVERT;                                         /*@G51DGBB*/ 03655000
         BAL   @14,CONVERT                                         1225 03656000
*    PRINTBDY(1:58) = PARTIAL;                             /*@G51DGBB*/ 03657000
         MVC   PRINTBDY(58),PARTIAL                                1226 03658000
*  END;                                                    /*@G51DGBB*/ 03659000
*IF MSGNO = 40 THEN                                                1228 03660000
@RF01212 CLI   MSGNO,40                                            1228 03661000
         BNE   @RF01228                                            1228 03662000
* CALL IFCMSG(40,ADDR(PRINTBDY));                          /*@G51DGBB*/ 03663000
         LA    @08,PRINTBDY                                        1229 03664000
         ST    @08,@AFTEMPS+4                                      1229 03665000
         L     @15,ADIFCMSG(,R2)                                   1229 03666000
         LA    @01,@AL01229                                        1229 03667000
         BALR  @14,@15                                             1229 03668000
*IF MSGNO = 24 THEN                                                1230 03669000
@RF01228 CLI   MSGNO,24                                            1230 03670000
         BNE   @RF01230                                            1230 03671000
* CALL IFCMSG(24,ADDR(PRINTBDY));                          /*@G51DGBB*/ 03672000
         LA    @08,PRINTBDY                                        1231 03673000
         ST    @08,@AFTEMPS+4                                      1231 03674000
         L     @15,ADIFCMSG(,R2)                                   1231 03675000
         LA    @01,@AL01231                                        1231 03676000
         BALR  @14,@15                                             1231 03677000
*CALL IOHND(RITEPRTR);                                     /*@Z427VLS*/ 03678000
@RF01230 L     @15,ADIOHND(,R2)                                    1232 03679000
         LA    @01,@AL01232                                        1232 03680000
         BALR  @14,@15                                             1232 03681000
*END;                                                      /*@Z427VLS*/ 03682000
@EL00028 DS    0H                                                  1233 03683000
@EF00028 DS    0H                                                  1233 03684000
@ER00028 LM    @14,@12,@SA00028                                    1233 03685000
         BR    @14                                                 1233 03686000
*BUGCNTS: PROC;                                            /*@Z427VLS*/ 03687000
BUGCNTS  STM   @14,@12,@SA00029                                    1234 03688000
*/*PRINT OUT COUNTS OF RECORDS PROCESSED IF DEBUG16 IS ON    @Z427VLS*/ 03689000
*PRINTADR = ADDR(PRINTLIN); /*ADDRESS OF PRINT LINE TO IFCIOND*/   1235 03690000
         LA    @08,PRINTLIN                                        1235 03691000
         ST    @08,PRINTADR(,R2)                                   1235 03692000
* PRINTLIN = ERRLINE(33);                                  /*@D35UGGB*/ 03693000
         MVI   PRINTLIN+63,C' '                                    1236 03694000
         MVC   PRINTLIN+64(70),PRINTLIN+63                         1236 03695000
         MVC   PRINTLIN(63),ERRLINE+2016                           1236 03696000
*CALL IOHND(RITEPRTR);                                     /*@Z427VLS*/ 03697000
         L     @15,ADIOHND(,R2)                                    1237 03698000
         LA    @01,@AL01237                                        1237 03699000
         BALR  @14,@15                                             1237 03700000
*   DO J = 1 BY 1 TO 32;                                   /*@D35UGGB*/ 03701000
         LA    @08,1                                               1238 03702000
         ST    @08,J                                               1238 03703000
@DL01238 DS    0H                                                  1239 03704000
*  NUMREC = BUG(J);                                        /*@Z427VLS*/ 03705000
         SLA   @08,2                                               1239 03706000
         L     @08,BUG-4(@08)                                      1239 03707000
         ST    @08,NUMREC                                          1239 03708000
*  CVD(NUMREC,PACKPAS);                                    /*@Z427VLS*/ 03709000
         CVD   @08,@TS00001                                        1240 03710000
         MVC   PACKPAS(4),@TS00001+4                               1240 03711000
*  PACKPAS = (PACKPAS | '0000000F'X);                      /*@Z427VLS*/ 03712000
         OC    PACKPAS(4),@CB01482                                 1241 03713000
*  UNPK(EDFLD,PACKPAS);                                    /*@Z427VLS*/ 03714000
         UNPK  EDFLD(9),PACKPAS(4)                                 1242 03715000
*  NONBLANK = OFF;                                         /*@Z427VLS*/ 03716000
         NI    NONBLANK,B'01111111'                                1243 03717000
*  DO K = 1 BY 1 TO 8 WHILE NONBLANK = OFF;                /*@Z427VLS*/ 03718000
         LA    @08,1                                               1244 03719000
         ST    @08,K                                               1244 03720000
@DL01244 TM    NONBLANK,B'10000000'                                1244 03721000
         BNZ   @DC01244                                            1244 03722000
*    IF EDIFILD(K) = CHARZERO THEN                                 1245 03723000
         LA    @06,EDIFILD-1(@08)                                  1245 03724000
         CLI   0(@06),X'F0'                                        1245 03725000
         BNE   @RF01245                                            1245 03726000
*      EDIFILD(K) = BLANK;                                 /*@Z427VLS*/ 03727000
         LA    @06,EDIFILD-1(@08)                                  1246 03728000
         MVI   0(@06),X'40'                                        1246 03729000
*    ELSE                                                          1247 03730000
*      NONBLANK = ON;                                      /*@Z427VLS*/ 03731000
         B     @RC01245                                            1247 03732000
@RF01245 OI    NONBLANK,B'10000000'                                1247 03733000
*  END;                                                    /*@Z427VLS*/ 03734000
@RC01245 LA    @08,1                                               1248 03735000
         AL    @08,K                                               1248 03736000
         ST    @08,K                                               1248 03737000
         C     @08,@CF00066                                        1248 03738000
         BNH   @DL01244                                            1248 03739000
@DC01244 DS    0H                                                  1249 03740000
*  ERXNUM(J) = EDFLD;                                      /*@Z427VLS*/ 03741000
         L     @08,J                                               1249 03742000
         MH    @08,@CH01548                                        1249 03743000
         LA    @06,ERXNUM-63(@08)                                  1249 03744000
         MVC   0(9,@06),EDFLD                                      1249 03745000
*  PRINTLIN = ERRLINE(J);                                  /*@Z427VLS*/ 03746000
         MVI   PRINTLIN+63,C' '                                    1250 03747000
         MVC   PRINTLIN+64(70),PRINTLIN+63                         1250 03748000
         LA    @06,ERRLINE-63(@08)                                 1250 03749000
         MVC   PRINTLIN(63),0(@06)                                 1250 03750000
*  PRINTADR = ADDR(PRINTLIN);                              /*@Z427VLS*/ 03751000
         LA    @08,PRINTLIN                                        1251 03752000
         ST    @08,PRINTADR(,R2)                                   1251 03753000
*  CALL IOHND(RITEPRTR);                                   /*@Z427VLS*/ 03754000
         L     @15,ADIOHND(,R2)                                    1252 03755000
         LA    @01,@AL01252                                        1252 03756000
         BALR  @14,@15                                             1252 03757000
* END;                                                     /*@Z427VLS*/ 03758000
         LA    @08,1                                               1253 03759000
         AL    @08,J                                               1253 03760000
         ST    @08,J                                               1253 03761000
         C     @08,@CF00892                                        1253 03762000
         BNH   @DL01238                                            1253 03763000
*END; /*CLOSING END TO PROC BUGCNTS                          @Z427VLS*/ 03764000
@EL00029 DS    0H                                                  1254 03765000
@EF00029 DS    0H                                                  1254 03766000
@ER00029 LM    @14,@12,@SA00029                                    1254 03767000
         BR    @14                                                 1254 03768000
*/*THIS PROC WILL EXAMINE THE MERIDIAN MCH OR CCH IN ORDER TO BUILD*/   03769000
*/*FRAMTAB ENTRIES FOR UNIQUE RECORDS                        @G51DGBB*/ 03770000
*BUILDFTB: PROC; /*BUILD NEW ENTRY IF CPU IS UNIQUE          @G51DGBB*/ 03771000
BUILDFTB STM   @14,@12,@SA00030                                    1255 03772000
*LOOPOUT = NO;                                             /*@G51DGBB*/ 03773000
         NI    LOOPOUT,B'11111011'                                 1256 03774000
*DO Y = 1 BY 1 TO EVMAX WHILE LOOPOUT = NO; /*EXAMINE ALL FRAMETAB*/    03775000
         LA    @08,1                                               1257 03776000
         ST    @08,Y                                               1257 03777000
@DL01257 TM    LOOPOUT,B'00000100'                                 1257 03778000
         BNZ   @DC01257                                            1257 03779000
*  IF FRAMECPU(Y) = LRTCPMOD THEN  /*IF CPU ALREADY IN TABLE THEN*/     03780000
         MH    @08,@CH00227                                        1258 03781000
         L     @06,FRAMEPTR(,R2)                                   1258 03782000
         ALR   @06,@08                                             1258 03783000
         AL    @06,@CF01562                                        1258 03784000
         CLC   FRAMECPU-4(5,@06),LRTCPMOD(R7)                      1258 03785000
         BNE   @RF01258                                            1258 03786000
*    LOOPOUT = YES; /*EXIT LOOP                              @G51DGBB*/ 03787000
         OI    LOOPOUT,B'00000100'                                 1259 03788000
*  ELSE     /*IF ENTRY DOESNT MATCH THE FRAME                @G51DGBB*/ 03789000
*    DO;                                                   /*@G51DGBB*/ 03790000
         B     @RC01258                                            1260 03791000
@RF01258 DS    0H                                                  1261 03792000
*      IF FRAMECPU(Y) = '0000000000'X THEN /*NO MATCH ,ALL ENTS CHKED*/ 03793000
         L     @08,Y                                               1261 03794000
         MH    @08,@CH00227                                        1261 03795000
         L     @06,FRAMEPTR(,R2)                                   1261 03796000
         ST    @08,@TF00001                                        1261 03797000
         ALR   @08,@06                                             1261 03798000
         AL    @08,@CF01562                                        1261 03799000
         CLC   FRAMECPU-4(5,@08),@CB00290                          1261 03800000
         BNE   @RF01261                                            1261 03801000
*        DO;                                               /*@G51DGBB*/ 03802000
*          FRAMECPU(Y) = LRTCPMOD;                         /*@G51DGBB*/ 03803000
         LR    @08,@06                                             1263 03804000
         AL    @08,@TF00001                                        1263 03805000
         AL    @08,@CF01562                                        1263 03806000
         MVC   FRAMECPU-4(5,@08),LRTCPMOD(R7)                      1263 03807000
*          FRAMENUM = FRAMENUM + 1; /*ADD 1 TO SET ENTRY COUNT*/   1264 03808000
         LA    @08,1                                               1264 03809000
         AL    @08,FRAMENUM(,@06)                                  1264 03810000
         ST    @08,FRAMENUM(,@06)                                  1264 03811000
*          LOOPOUT = YES;                                  /*@G51DGBB*/ 03812000
         OI    LOOPOUT,B'00000100'                                 1265 03813000
*        END;                                              /*@G51DGBB*/ 03814000
*      ELSE                                                        1267 03815000
*        IF Y = EVMAX THEN /*UNIQUE ENTRY BUT NOT ROOM IN TABLE*/  1267 03816000
         B     @RC01261                                            1267 03817000
@RF01261 CLC   Y(4),@CF00034                                       1267 03818000
         BNE   @RF01267                                            1267 03819000
*          DO;                                             /*@G51DGBB*/ 03820000
*            IF ONETIME = NO THEN   /*ISSUE MESSAGE ONLY ONCE*/    1269 03821000
         TM    ONETIME,B'00000001'                                 1269 03822000
         BNZ   @RF01269                                            1269 03823000
*              DO;                                         /*@G51DGBB*/ 03824000
*                MSGNO = 24;                               /*@G51DGBB*/ 03825000
         MVI   MSGNO,X'18'                                         1271 03826000
*                CALL ERRMSG;                              /*@G51DGBB*/ 03827000
         BAL   @14,ERRMSG                                          1272 03828000
*                ONETIME = YES;                            /*@G51DGBB*/ 03829000
         OI    ONETIME,B'00000001'                                 1273 03830000
*              END;                                        /*@G51DGBB*/ 03831000
*          END;                                            /*@G51DGBB*/ 03832000
@RF01269 DS    0H                                                  1276 03833000
*   END;                                                   /*@G51DGBB*/ 03834000
@RF01267 DS    0H                                                  1276 03835000
@RC01261 DS    0H                                                  1277 03836000
* END;                                                     /*@G51DGBB*/ 03837000
@RC01258 LA    @08,1                                               1277 03838000
         AL    @08,Y                                               1277 03839000
         ST    @08,Y                                               1277 03840000
         C     @08,@CF00034                                        1277 03841000
         BNH   @DL01257                                            1277 03842000
@DC01257 DS    0H                                                  1278 03843000
*END; /*END OF PROC BUILDFTB                                 @G51DGBB*/ 03844000
@EL00030 DS    0H                                                  1278 03845000
@EF00030 DS    0H                                                  1278 03846000
@ER00030 LM    @14,@12,@SA00030                                    1278 03847000
         BR    @14                                                 1278 03848000
*FRAMEREP: PROC; /*REPLACE FRAME IF MORE CURRENT FRAME FOUND @G51DGBB*/ 03849000
FRAMEREP STM   @14,@12,@SA00031                                    1279 03850000
*                /*COMPLETE ENTRY IF NO DATE ETC.            @G51DGBB*/ 03851000
*                /*APPEND LOCATION OF FRAME EXTERNAL LOCATION LIST*/    03852000
*GETOUT = NO;                                              /*@G51DGBB*/ 03853000
         NI    GETOUT,B'11110111'                                  1280 03854000
*DO X = 1 BY 1 TO FRAMENUM WHILE GETOUT = NO; /*LOOP THROUGH ALL SET*/  03855000
         LA    @08,1                                               1281 03856000
         ST    @08,X                                               1281 03857000
         B     @DE01281                                            1281 03858000
@DL01281 TM    GETOUT,B'00001000'                                  1281 03859000
         BNZ   @DC01281                                            1281 03860000
*                                             /*ENTRIES OF FRAMETAB */  03861000
*  IF FRAMECPU(X) = LRTCPMOD THEN             /*IF RECORD CPU MODEL */  03862000
         LR    @06,@08                                             1282 03863000
         MH    @06,@CH00227                                        1282 03864000
         L     @15,FRAMEPTR(,R2)                                   1282 03865000
         ST    @06,@TF00001                                        1282 03866000
         ALR   @06,@15                                             1282 03867000
         AL    @06,@CF01562                                        1282 03868000
         CLC   FRAMECPU-4(5,@06),LRTCPMOD(R7)                      1282 03869000
         BNE   @RF01282                                            1282 03870000
*    DO;                                      /*SERIAL MATCHES THOSE*/  03871000
*      CCHINDX = X;  /*SAVE INDEX*/           /*OF THE ENTRY @G51DGBB*/ 03872000
         ST    @08,CCHINDX                                         1284 03873000
*      IF FRAMEDT(X) < LRTDT THEN             /*IF REC DATE GREATER */  03874000
         AL    @15,@TF00001                                        1285 03875000
         AL    @15,@CF01581                                        1285 03876000
         CLC   FRAMEDT-9(8,@15),LRTDT(R7)                          1285 03877000
         BNL   @RF01285                                            1285 03878000
*        DO;                                  /*THAN ENTRY DATE     */  03879000
*              CALL FIXENTRY;               /*DELETE OLD FRAME SET*/    03880000
         BAL   @14,FIXENTRY                                        1287 03881000
*              FRAMEDT(X) = LRTDT;           /*SAVE HIGH DATE*/    1288 03882000
         L     @08,X                                               1288 03883000
         MH    @08,@CH00227                                        1288 03884000
         L     @06,FRAMEPTR(,R2)                                   1288 03885000
         ALR   @06,@08                                             1288 03886000
         AL    @06,@CF01581                                        1288 03887000
         MVC   FRAMEDT-9(8,@06),LRTDT(R7)                          1288 03888000
*              CALL BUILDTTR;                /*SAVE FRAME LOCATION*/    03889000
         BAL   @14,BUILDTTR                                        1289 03890000
*               FRAMEYES = YES;/*SAVE SUCCEEDING FRAMES OF THIS    */   03891000
         OI    FRAMEYES,B'00000010'                                1290 03892000
*                              /*LOGICAL SET                 @G51DGBB*/ 03893000
*         END;                                             /*@G51DGBB*/ 03894000
*       ELSE  /*IMPLIES DATE IS LOW OR EQUAL                 @G51DGBB*/ 03895000
*        DO;                                               /*@G51DGBB*/ 03896000
         B     @RC01285                                            1292 03897000
@RF01285 DS    0H                                                  1293 03898000
*         IF FRAMEDT(X) = LRTDT THEN /*IF TABLE DATE EQUALS RECORD DAT* 03899000
         L     @08,X                                               1293 03900000
         MH    @08,@CH00227                                        1293 03901000
         L     @06,FRAMEPTR(,R2)                                   1293 03902000
         ST    @08,@TF00001                                        1293 03903000
         ALR   @08,@06                                             1293 03904000
         AL    @08,@CF01581                                        1293 03905000
         CLC   FRAMEDT-9(8,@08),LRTDT(R7)                          1293 03906000
         BNE   @RF01293                                            1293 03907000
*           DO;                                            /*@G51DGBB*/ 03908000
*            IF FRAMETYP(X) ^= ALLALL THEN                         1295 03909000
         AL    @06,@TF00001                                        1295 03910000
         AL    @06,@CF01576                                        1295 03911000
         CLI   FRAMETYP-17(@06),X'FF'                              1295 03912000
         BE    @RF01295                                            1295 03913000
*             DO;                                          /*@G51DGBB*/ 03914000
*                      CALL FIXENTRY; /*DELETE INCOMPLETE SET       */  03915000
         BAL   @14,FIXENTRY                                        1297 03916000
*                      MSGNO = 79; /*ISSUE FRAME SET INCOMPLETE MESS*/  03917000
         MVI   MSGNO,X'4F'                                         1298 03918000
*                      CALL ERRMSG;                        /*@G51DGBB*/ 03919000
         BAL   @14,ERRMSG                                          1299 03920000
*                      CALL BUILDTTR; /*SAVE THIS FRAME      @G51DGBB*/ 03921000
         BAL   @14,BUILDTTR                                        1300 03922000
*                      FRAMEYES = YES; /*SAVE SUCCEEDING MEMBERS */     03923000
         OI    FRAMEYES,B'00000010'                                1301 03924000
*             END;                                         /*@G51DGBB*/ 03925000
*            ELSE  /*COMPLETE SET FOR THIS DATE ALREADY EXISTS      */  03926000
*               DO; /*FRAMETYP IS EQUAL TO ALLALL            @G51DGBB*/ 03927000
         B     @RC01295                                            1303 03928000
@RF01295 DS    0H                                                  1304 03929000
*                   FRAMEYES = NO;/*DELETE SUCCEEDING FRAMES OF SET */  03930000
         NI    FRAMEYES,B'11111101'                                1304 03931000
*                   BUG(30) = BUG(30) + 1; /*COUNT FRAME AS NOT USED*/  03932000
         LA    @08,1                                               1305 03933000
         AL    @08,BUG+116                                         1305 03934000
         ST    @08,BUG+116                                         1305 03935000
*               END;                                       /*@G51DGBB*/ 03936000
*        END; /*END OF CODE IF DATE IN RECORD EQUALS DATE IN TABLE*/    03937000
*       ELSE /*DATE IN TABLE GREATER THAN FRAME RECORD DATE  @G51DGBB*/ 03938000
*        BUG(30) = BUG(30)  + 1;                           /*@G51DGBB*/ 03939000
         B     @RC01293                                            1308 03940000
@RF01293 LA    @08,1                                               1308 03941000
         AL    @08,BUG+116                                         1308 03942000
         ST    @08,BUG+116                                         1308 03943000
*    END; /*END OF CODE IF DATE IN RECORD IS LOW OR EQUAL    @G51DGBB*/ 03944000
@RC01293 DS    0H                                                  1310 03945000
*  GETOUT = YES; /*GET OUT OF LOOP AFTER CPU MATCH           @G51DGBB*/ 03946000
@RC01285 OI    GETOUT,B'00001000'                                  1310 03947000
* END; /*END OF CODE FOR A RECORD TO ENTRY CPU MATCH         @G51DGBB*/ 03948000
*END; /*END OF FRAMETAB LOOP                                 @G51DGBB*/ 03949000
@RF01282 LA    @08,1                                               1312 03950000
         AL    @08,X                                               1312 03951000
         ST    @08,X                                               1312 03952000
@DE01281 L     @06,FRAMEPTR(,R2)                                   1312 03953000
         C     @08,FRAMENUM(,@06)                                  1312 03954000
         BNH   @DL01281                                            1312 03955000
@DC01281 DS    0H                                                  1313 03956000
*IF GETOUT = NO THEN /*MERIDIAN FRAME BUT NO ROOM IN TABLE   @G51DGBB*/ 03957000
         TM    GETOUT,B'00001000'                                  1313 03958000
         BNZ   @RF01313                                            1313 03959000
*  BUG(30) = BUG(30) + 1;                                  /*@G51DGBB*/ 03960000
         LA    @08,1                                               1314 03961000
         AL    @08,BUG+116                                         1314 03962000
         ST    @08,BUG+116                                         1314 03963000
*END; /*END OF PROC FRAMEREP                                 @G51DGBB*/ 03964000
@EL00031 DS    0H                                                  1315 03965000
@EF00031 DS    0H                                                  1315 03966000
@ER00031 LM    @14,@12,@SA00031                                    1315 03967000
         BR    @14                                                 1315 03968000
*BUILDTTR: PROC; /*SAVE LOCATION OF A FRAME IN LISTLOC       @G51DGBB*/ 03969000
BUILDTTR STM   @14,@12,@SA00032                                    1316 03970000
*RESPECIFY (R0,R1,R4,R15) RESTRICTED;                      /*@G51DGBB*/ 03971000
*IF (LRTKEY1 & GENREC) = HEXA0 THEN /* IF MCH FRAME          @G51DGBB*/ 03972000
         MVC   @TS00001(1),LRTKEY1(R7)                             1318 03973000
         NI    @TS00001,X'F0'                                      1318 03974000
         CLI   @TS00001,X'A0'                                      1318 03975000
         BNE   @RF01318                                            1318 03976000
*  DO;                                                     /*@G51DGBB*/ 03977000
*    IF FRAMLOCM(CCHINDX) = ZERO THEN /*IF LISTLOC CORE FOR A CPU*/     03978000
         L     @14,CCHINDX                                         1320 03979000
         MH    @14,@CH00227                                        1320 03980000
         L     @08,FRAMEPTR(,R2)                                   1320 03981000
         AL    @08,@CF01577                                        1320 03982000
         L     @14,FRAMLOCM-20(@14,@08)                            1320 03983000
         LTR   @14,@14                                             1320 03984000
         BNZ   @RF01320                                            1320 03985000
*      DO;                            /*IS UNALLOCATED       @G51DGBB*/ 03986000
*        R0 = LISTBENT * LISTMAX * 2; /*ALLOCATE CORE FOR BOTH CCH*/    03987000
         LA    R0,500                                              1322 03988000
*        R0 = R0 + 12;                /*AND MCH FRAME LOCATIONS   */    03989000
         AL    R0,@CF00032                                         1323 03990000
*        GEN(GETMAIN EC,LV=(0),A=TMPSTORE,SP=21); /*GET STORAGE*/  1324 03991000
         GETMAIN EC,LV=(0),A=TMPSTORE,SP=21                             03992000
*        IF R15 = SUCCESS THEN                                     1325 03993000
         LTR   R15,R15                                             1325 03994000
         BNZ   @RF01325                                            1325 03995000
*          DO;                                             /*@G51DGBB*/ 03996000
*            R1 = TMPSTORE;           /*SET STORAGE ADDRESS IN REG 1*/  03997000
         L     R1,TMPSTORE                                         1327 03998000
*            FRAMLOCM(CCHINDX) = R1;  /*SET POINTERS TO LISTLOC   */    03999000
         L     @14,CCHINDX                                         1328 04000000
         MH    @14,@CH00227                                        1328 04001000
         L     @08,FRAMEPTR(,R2)                                   1328 04002000
         AL    @08,@CF01577                                        1328 04003000
         ST    R1,FRAMLOCM-20(@14,@08)                             1328 04004000
*            R1 = R1+LISTBENT *       /*TABLES FOR BOTH CCL AND MCH*/   04005000
*                LISTMAX+4;           /*FRAMES               @G51DGBB*/ 04006000
         AL    R1,@CF01552                                         1329 04007000
*            R0 = ZERO;          /*ENSURE THAT TABLE ON WORD BOUNDARY*/ 04008000
         SLR   R0,R0                                               1330 04009000
*            R4 = 4;             /*DIVIDE BY NUMBER OF BYTES IN WORD*/  04010000
         LA    R4,4                                                1331 04011000
*            GEN(DR R0,R4);                                /*@G51DGBB*/ 04012000
         DR R0,R4                                                       04013000
*            IF R0 > ZERO THEN /*REMAINDER MEANS NOT INTEGRAL NUMBER*/  04014000
         LTR   R0,R0                                               1333 04015000
         BNP   @RF01333                                            1333 04016000
*                              /*NUMBER OF DOUBLEWORDS.      @G51DGBB*/ 04017000
*              R1 = R1 + 1; /*ADD ONE EXTRA FULL WORD        @G51DGBB*/ 04018000
         AL    R1,@CF00055                                         1334 04019000
*            R1 = R1 * FOUR; /*RESET ONE TO NUMBER OF BYTES  @G51DGBB*/ 04020000
@RF01333 SLL   R1,2                                                1335 04021000
*            FRAMLOCC(CCHINDX) = R1; /*SET POINTER TO CCH CCHHR TABLE*/ 04022000
         L     @14,CCHINDX                                         1336 04023000
         MH    @14,@CH00227                                        1336 04024000
         L     @08,FRAMEPTR(,R2)                                   1336 04025000
         ST    R1,FRAMLOCC-24(@14,@08)                             1336 04026000
*            LISTPTR = R1;      /*ESTABLISH ADDRESSABILITY FOR CCH TB*/ 04027000
         ST    R1,LISTPTR                                          1337 04028000
*            LISTNUM = ZERO;    /*ZERO CCH LISTLOC TABLE     @G51DGBB*/ 04029000
         L     @14,LISTPTR                                         1338 04030000
         SLR   @08,@08                                             1338 04031000
         ST    @08,LISTNUM(,@14)                                   1338 04032000
*            DO Y = 1 BY 1 TO LISTMAX;                     /*@G51DGBB*/ 04033000
         LA    @14,1                                               1339 04034000
         ST    @14,Y                                               1339 04035000
@DL01339 DS    0H                                                  1340 04036000
*              LISTCCHR(Y) = LISTCCHR(Y) &&                        1340 04037000
*                            LISTCCHR(Y);                  /*@G51DGBB*/ 04038000
         LR    @08,@14                                             1340 04039000
         MH    @08,@CH00079                                        1340 04040000
         L     @06,LISTPTR                                         1340 04041000
         ALR   @06,@08                                             1340 04042000
         BCTR  @06,0                                               1340 04043000
         XC    LISTCCHR-4(5,@06),LISTCCHR-4(@06)                   1340 04044000
*            END;                                          /*@G51DGBB*/ 04045000
         AL    @14,@CF00055                                        1341 04046000
         ST    @14,Y                                               1341 04047000
         C     @14,@CF00295                                        1341 04048000
         BNH   @DL01339                                            1341 04049000
*            LISTPTR = FRAMLOCM(CCHINDX); /*ADDRESS OF MCH LISTLOC */   04050000
         L     @14,CCHINDX                                         1342 04051000
         MH    @14,@CH00227                                        1342 04052000
         L     @08,FRAMEPTR(,R2)                                   1342 04053000
         AL    @08,@CF01577                                        1342 04054000
         L     @14,FRAMLOCM-20(@14,@08)                            1342 04055000
         ST    @14,LISTPTR                                         1342 04056000
*            DO Y = 1 BY 1 TO LISTMAX;   /* ZERO MCH LISTLOC TABLE  */  04057000
         LA    @14,1                                               1343 04058000
         ST    @14,Y                                               1343 04059000
@DL01343 DS    0H                                                  1344 04060000
*            LISTCCHR(Y) = LISTCCHR(Y) &&                          1344 04061000
*                          LISTCCHR(Y);                    /*@G51DGBB*/ 04062000
         LR    @08,@14                                             1344 04063000
         MH    @08,@CH00079                                        1344 04064000
         L     @06,LISTPTR                                         1344 04065000
         ALR   @06,@08                                             1344 04066000
         BCTR  @06,0                                               1344 04067000
         XC    LISTCCHR-4(5,@06),LISTCCHR-4(@06)                   1344 04068000
*            END;                                          /*@G51DGBB*/ 04069000
         AL    @14,@CF00055                                        1345 04070000
         ST    @14,Y                                               1345 04071000
         C     @14,@CF00295                                        1345 04072000
         BNH   @DL01343                                            1345 04073000
*            LISTNUM = ZERO;                               /*@G51DGBB*/ 04074000
         L     @14,LISTPTR                                         1346 04075000
         SLR   @08,@08                                             1346 04076000
         ST    @08,LISTNUM(,@14)                                   1346 04077000
*          END;                                            /*@G51DGBB*/ 04078000
*        ELSE /*UNSUCCESSFUL GETMAIN                         @G51DGBB*/ 04079000
*          DO;                                             /*@G51DGBB*/ 04080000
         B     @RC01325                                            1348 04081000
@RF01325 DS    0H                                                  1349 04082000
*            MSGNO = 40;                                   /*@G51DGBB*/ 04083000
         MVI   MSGNO,X'28'                                         1349 04084000
*            CALL ERRMSG;                                  /*@G51DGBB*/ 04085000
         BAL   @14,ERRMSG                                          1350 04086000
*            R15 = TWELVE;                                 /*@G51DGBB*/ 04087000
         LA    @08,12                                              1351 04088000
         LR    R15,@08                                             1351 04089000
*            ERROR = TWELVE;                               /*@G51DGBB*/ 04090000
         ST    @08,ERROR                                           1352 04091000
*          END;                                            /*@G51DGBB*/ 04092000
*      END;                                                /*@G51DGBB*/ 04093000
@RC01325 DS    0H                                                  1355 04094000
*    IF R15 = ZERO THEN /*IF GETMAIN WAS SUCCESSFUL OR NO GETMAIN*/     04095000
@RF01320 LTR   R15,R15                                             1355 04096000
         BNZ   @RF01355                                            1355 04097000
*      LISTPTR = FRAMLOCM(CCHINDX);/*ESTABLISH LISTLOC ADDRESS   */     04098000
         L     @14,CCHINDX                                         1356 04099000
         MH    @14,@CH00227                                        1356 04100000
         L     @08,FRAMEPTR(,R2)                                   1356 04101000
         AL    @08,@CF01577                                        1356 04102000
         L     @14,FRAMLOCM-20(@14,@08)                            1356 04103000
         ST    @14,LISTPTR                                         1356 04104000
*  END;                                                    /*@G51DGBB*/ 04105000
*ELSE /* IS A CCH FRAME                                      @G51DGBB*/ 04106000
*    LISTPTR = FRAMLOCC(CCHINDX);  /*ESTABLISH CCH LISTLOC ADDRESS*/    04107000
         B     @RC01318                                            1358 04108000
@RF01318 L     @14,CCHINDX                                         1358 04109000
         MH    @14,@CH00227                                        1358 04110000
         L     @08,FRAMEPTR(,R2)                                   1358 04111000
         L     @14,FRAMLOCC-24(@14,@08)                            1358 04112000
         ST    @14,LISTPTR                                         1358 04113000
*IF ERROR = ZERO THEN                                              1359 04114000
@RC01318 L     @14,ERROR                                           1359 04115000
         LTR   @14,@14                                             1359 04116000
         BNZ   @RF01359                                            1359 04117000
*  DO;                                                     /*@G51DGBB*/ 04118000
*    IF LISTNUM + 1 <= LISTMAX THEN /*IF ROOM IN LISTLOC     @G51DGBB*/ 04119000
         LA    @14,1                                               1361 04120000
         L     @08,LISTPTR                                         1361 04121000
         AL    @14,LISTNUM(,@08)                                   1361 04122000
         C     @14,@CF00295                                        1361 04123000
         BH    @RF01361                                            1361 04124000
*      DO;                                                 /*@G51DGBB*/ 04125000
*        RESPECIFY (R1) UNRESTRICTED;                      /*@G51DGBB*/ 04126000
*        IF PHIST = ON THEN        /*IF HISTORY INPUT        @G51DGBB*/ 04127000
         TM    PHIST(R2),B'00100000'                               1364 04128000
         BNO   @RF01364                                            1364 04129000
*          CALL IOHND(RITESCRT);   /*WRITE TO SCRATCH DATA SET*/   1365 04130000
         L     @15,ADIOHND(,R2)                                    1365 04131000
         LA    @01,@AL01365                                        1365 04132000
         BALR  @14,@15                                             1365 04133000
*        IF R15 = SUCCESS THEN     /*IF SUCCESSFULL WRITE    @G51DGBB*/ 04134000
@RF01364 LTR   R15,R15                                             1366 04135000
         BNZ   @RF01366                                            1366 04136000
*          DO;                                             /*@G51DGBB*/ 04137000
*            LISTCCHR(LISTNUM+1) = RECCCHHR;/*SAVE FRAME EXTERNAL LOC*/ 04138000
         L     @14,LISTPTR                                         1368 04139000
         L     @08,LISTNUM(,@14)                                   1368 04140000
         LR    @06,@08                                             1368 04141000
         MH    @06,@CH00079                                        1368 04142000
         ALR   @06,@14                                             1368 04143000
         MVC   LISTCCHR(5,@06),RECCCHHR(R2)                        1368 04144000
*            LISTNUM = LISTNUM + 1; /*INCREMENT NO OF BUILT ENTRIES*/   04145000
         LA    @06,1                                               1369 04146000
         ALR   @08,@06                                             1369 04147000
         ST    @08,LISTNUM(,@14)                                   1369 04148000
*            BUG(29) = BUG(29) + 1; /*COUNT NUMBER OF USED FRAMES*/     04149000
         AL    @06,BUG+112                                         1370 04150000
         ST    @06,BUG+112                                         1370 04151000
*          END;                                            /*@G51DGBB*/ 04152000
*        ELSE  /*UNSUCCESSFUL WRITE TO SCRATCH D.S.          @G51DGBB*/ 04153000
*          R15 = TWELVE; /*TERMINATE FURTHER PROCESSING      @G51DGBB*/ 04154000
         B     @RC01366                                            1372 04155000
@RF01366 LA    R15,12                                              1372 04156000
*      END;                                                /*@G51DGBB*/ 04157000
@RC01366 DS    0H                                                  1374 04158000
*  END;                                                    /*@G51DGBB*/ 04159000
@RF01361 DS    0H                                                  1375 04160000
*ERROR = R15;                                              /*@G51DGBB*/ 04161000
@RF01359 ST    R15,ERROR                                           1375 04162000
*RESPECIFY (R0,R4,R15) UNRESTRICTED;                       /*@G51DGBB*/ 04163000
*END; /*END OF BUILDTTR PROC                                 @G51DGBB*/ 04164000
@EL00032 DS    0H                                                  1377 04165000
@EF00032 DS    0H                                                  1377 04166000
@ER00032 LM    @14,@12,@SA00032                                    1377 04167000
         BR    @14                                                 1377 04168000
*FIXENTRY: PROC;  /*RESET LISTLOC TABLE TO ZEROS BUT DONT FREE CORE*/   04169000
FIXENTRY STM   @14,@12,12(@13)                                     1378 04170000
*                 /*RESET DATE,TYPE TO ZEROS                 @G51DGBB*/ 04171000
*FRAMEDT(CCHINDX) = '0000000000000000'X; /*ZERO DATE,TIME    @G51DGBB*/ 04172000
         L     @08,CCHINDX                                         1379 04173000
         MH    @08,@CH00227                                        1379 04174000
         L     @06,FRAMEPTR(,R2)                                   1379 04175000
         ST    @08,@TF00001                                        1379 04176000
         ALR   @08,@06                                             1379 04177000
         AL    @08,@CF01581                                        1379 04178000
         MVC   FRAMEDT-9(8,@08),@CB01527                           1379 04179000
*FRAMETYP(CCHINDX) = '00'X; /*RESET TO NO TYPES OF FRAMES STORED*/ 1380 04180000
         LR    @08,@06                                             1380 04181000
         AL    @08,@TF00001                                        1380 04182000
         AL    @08,@CF01576                                        1380 04183000
         MVI   FRAMETYP-17(@08),X'00'                              1380 04184000
*IF FRAMLOCM(CCHINDX) > ZERO THEN /*IF MCH FRAME LOC. TAB. ALLOCATED*/  04185000
         L     @08,@TF00001                                        1381 04186000
         AL    @06,@CF01577                                        1381 04187000
         L     @08,FRAMLOCM-20(@08,@06)                            1381 04188000
         LTR   @08,@08                                             1381 04189000
         BNP   @RF01381                                            1381 04190000
*  DO;                                                     /*@G51DGBB*/ 04191000
*    LISTPTR = FRAMLOCM(CCHINDX); /*SET TABLE BASE ADDRESS   @G51DGBB*/ 04192000
         ST    @08,LISTPTR                                         1383 04193000
*    DO Y = 1 BY 1 TO LISTNUM; /*CLEAR ALL STORED CCHHRS TO ZERO*/ 1384 04194000
         LA    @08,1                                               1384 04195000
         ST    @08,Y                                               1384 04196000
         B     @DE01384                                            1384 04197000
@DL01384 DS    0H                                                  1385 04198000
*      LISTCCHR(Y) = (LISTCCHR(Y) && LISTCCHR(Y));         /*@G51DGBB*/ 04199000
         LR    @06,@08                                             1385 04200000
         MH    @06,@CH00079                                        1385 04201000
         L     @01,LISTPTR                                         1385 04202000
         ALR   @01,@06                                             1385 04203000
         BCTR  @01,0                                               1385 04204000
         XC    LISTCCHR-4(5,@01),LISTCCHR-4(@01)                   1385 04205000
*      BUG(30) = BUG(30) + 1; /*ADD TO COUNT OF REJECTED FRAMES*/  1386 04206000
         LA    @06,1                                               1386 04207000
         AL    @06,BUG+116                                         1386 04208000
         ST    @06,BUG+116                                         1386 04209000
*      BUG(29) = BUG(29) - 1; /*SUBTRACT FROM COUNT OF ACCEPTED FRMES*/ 04210000
         L     @06,BUG+112                                         1387 04211000
         BCTR  @06,0                                               1387 04212000
         ST    @06,BUG+112                                         1387 04213000
*    END;                                                  /*@G51DGBB*/ 04214000
         AL    @08,@CF00055                                        1388 04215000
         ST    @08,Y                                               1388 04216000
@DE01384 L     @06,LISTPTR                                         1388 04217000
         C     @08,LISTNUM(,@06)                                   1388 04218000
         BNH   @DL01384                                            1388 04219000
*    LISTNUM = ZERO; /*SET NUMBER OF STORED CCHHRS TO ZERO   @G51DGBB*/ 04220000
         L     @08,LISTPTR                                         1389 04221000
         SLR   @06,@06                                             1389 04222000
         ST    @06,LISTNUM(,@08)                                   1389 04223000
*  END;                                                    /*@G51DGBB*/ 04224000
*IF FRAMLOCC(CCHINDX) > ZERO THEN /*IF CCH FRAM LOC TABLE ALLOCATED*/   04225000
@RF01381 L     @08,CCHINDX                                         1391 04226000
         MH    @08,@CH00227                                        1391 04227000
         L     @06,FRAMEPTR(,R2)                                   1391 04228000
         L     @08,FRAMLOCC-24(@08,@06)                            1391 04229000
         LTR   @08,@08                                             1391 04230000
         BNP   @RF01391                                            1391 04231000
*  DO;                                                     /*@G51DGBB*/ 04232000
*    LISTPTR = FRAMLOCC(CCHINDX); /*SET BASE ADDRESS OF LISTLOC*/  1393 04233000
         ST    @08,LISTPTR                                         1393 04234000
*    DO Y = 1 BY 1 TO LISTNUM; /*ZERO ALL SAVED CCHHRS       @G51DGBB*/ 04235000
         LA    @08,1                                               1394 04236000
         ST    @08,Y                                               1394 04237000
         B     @DE01394                                            1394 04238000
@DL01394 DS    0H                                                  1395 04239000
*      LISTCCHR(Y) = (LISTCCHR(Y) && LISTCCHR(Y));         /*@G51DGBB*/ 04240000
         LR    @06,@08                                             1395 04241000
         MH    @06,@CH00079                                        1395 04242000
         L     @01,LISTPTR                                         1395 04243000
         ALR   @01,@06                                             1395 04244000
         BCTR  @01,0                                               1395 04245000
         XC    LISTCCHR-4(5,@01),LISTCCHR-4(@01)                   1395 04246000
*      BUG(30) = BUG(30) + 1; /*ADD TO COUNT OF REJECTED FRAMES*/  1396 04247000
         LA    @06,1                                               1396 04248000
         AL    @06,BUG+116                                         1396 04249000
         ST    @06,BUG+116                                         1396 04250000
*      BUG(29) = BUG(29) - 1; /*SUBTRACT FROM COUNT OF ACCEPTED FRAMES* 04251000
         L     @06,BUG+112                                         1397 04252000
         BCTR  @06,0                                               1397 04253000
         ST    @06,BUG+112                                         1397 04254000
*    END;                                                  /*@G51DGBB*/ 04255000
         AL    @08,@CF00055                                        1398 04256000
         ST    @08,Y                                               1398 04257000
@DE01394 L     @06,LISTPTR                                         1398 04258000
         C     @08,LISTNUM(,@06)                                   1398 04259000
         BNH   @DL01394                                            1398 04260000
*    LISTNUM = ZERO; /*SET NUMBER OF  CCHHRS SAVED TO ZERO   @G51DGBB*/ 04261000
         L     @08,LISTPTR                                         1399 04262000
         SLR   @06,@06                                             1399 04263000
         ST    @06,LISTNUM(,@08)                                   1399 04264000
*  END;                                                    /*@G51DGBB*/ 04265000
*END;                                                      /*@G51DGBB*/ 04266000
@EL00033 DS    0H                                                  1401 04267000
@EF00033 DS    0H                                                  1401 04268000
@ER00033 LM    @14,@12,12(@13)                                     1401 04269000
         BR    @14                                                 1401 04270000
*FLIMFRAM: PROC; /*PROCESS FRAME RECORDS SEQUENTIALLY        @G51DGBB*/ 04271000
FLIMFRAM STM   @14,@12,@SA00034                                    1402 04272000
*RESPECIFY (R15) RESTRICTED;                               /*@G51DGBB*/ 04273000
*   IF PACC = ON &                 /* IF NO ACCUMULATION OR NO  */ 1404 04274000
*     (PMCH = ON | PCHAN = ON) THEN /* MCH OR CCH SELECTION THEN */     04275000
         TM    PACC(R2),B'01000000'                                1404 04276000
         BNO   @RF01404                                            1404 04277000
         TM    PMCH(R2),B'11000000'                                1404 04278000
         BZ    @RF01404                                            1404 04279000
*    DO;                            /* DONT SELECT FRAMES    @G51DGBB*/ 04280000
*      IF LRTCNT = ONE &            /* IF FIRST PHYSICAL FRAME   */     04281000
*         (LRTKEY1 & GENREC) = HEXA0 THEN /*IS MCH FRAME WHICH MUST*/   04282000
         CLI   LRTCNT(R7),1                                        1406 04283000
         BNE   @RF01406                                            1406 04284000
         MVC   @TS00001(1),LRTKEY1(R7)                             1406 04285000
         NI    @TS00001,X'F0'                                      1406 04286000
         CLI   @TS00001,X'A0'                                      1406 04287000
         BNE   @RF01406                                            1406 04288000
*        DO;                         /*BE INPUT BEFORE CCH FRAMES*/     04289000
*          SAVESEQ = ONE;           /* RESET SEQUENCE CHECK  @G51DGBB*/ 04290000
         MVI   SAVESEQ,X'01'                                       1408 04291000
*          CALL FRAMEREP;           /* SEE IF THIS FRAME SET MUST*/     04292000
         BAL   @14,FRAMEREP                                        1409 04293000
*          R15 = ERROR;             /* BE SAVED              @G51DGBB*/ 04294000
         L     R15,ERROR                                           1410 04295000
*          IF LRTNLAST = OFF &      /*IF ONLY ONE MCH FRAME  @G51DGBB*/ 04296000
*             FRAMEYES = ON  &      /*FRAME SET TO BE SAVED  @G51DGBB*/ 04297000
*             R15 = ZERO THEN       /*NO ERROR CONDITIONS    @G51DGBB*/ 04298000
         TM    LRTNLAST(R7),B'10000000'                            1411 04299000
         BNZ   @RF01411                                            1411 04300000
         TM    FRAMEYES,B'00000010'                                1411 04301000
         BNO   @RF01411                                            1411 04302000
         LTR   R15,R15                                             1411 04303000
         BNZ   @RF01411                                            1411 04304000
*            DO;                                           /*@G51DGBB*/ 04305000
*              FRAMETYP(CCHINDX) = ALLMCH; /*ALL MCH FRAMES ARE IN*/    04306000
         L     @14,CCHINDX                                         1413 04307000
         MH    @14,@CH00227                                        1413 04308000
         L     @08,FRAMEPTR(,R2)                                   1413 04309000
         ALR   @08,@14                                             1413 04310000
         AL    @08,@CF01576                                        1413 04311000
         MVI   FRAMETYP-17(@08),X'02'                              1413 04312000
*              SAVESEQ = ZERO;      /*REINITIALIZE FOR CCH S @G51DGBB*/ 04313000
         MVI   SAVESEQ,X'00'                                       1414 04314000
*            END;                                          /*@G51DGBB*/ 04315000
*        END;                                              /*@G51DGBB*/ 04316000
*      ELSE                         /* NON-FIRST FRAME       @G51DGBB*/ 04317000
*        DO;                                               /*@G51DGBB*/ 04318000
         B     @RC01406                                            1417 04319000
@RF01406 DS    0H                                                  1418 04320000
*          IF FRAMEYES = ON THEN    /* IF FRAME IS TO BE SAVED  */ 1418 04321000
         TM    FRAMEYES,B'00000010'                                1418 04322000
         BNO   @RF01418                                            1418 04323000
*            DO;                                           /*@G51DGBB*/ 04324000
*              SAVESEQ = SAVESEQ + 1;  /* UP SEQ CHECK       @G51DGBB*/ 04325000
         IC    @14,SAVESEQ                                         1420 04326000
         LA    @14,1(,@14)                                         1420 04327000
         STC   @14,SAVESEQ                                         1420 04328000
*              IF SAVESEQ = LRTCNT THEN /* IF RECORD NOT MISSING */     04329000
         CLC   SAVESEQ(1),LRTCNT(R7)                               1421 04330000
         BNE   @RF01421                                            1421 04331000
*                DO;                                       /*@G51DGBB*/ 04332000
*                  CALL BUILDTTR;    /* BUILD EXTERNAL LOCATION */ 1423 04333000
         BAL   @14,BUILDTTR                                        1423 04334000
*                  R15 = ERROR;                            /*@G51DGBB*/ 04335000
         L     R15,ERROR                                           1424 04336000
*                  IF R15 = ZERO THEN  /* IF FRAME EXTERNAL LOC  */     04337000
         LTR   R15,R15                                             1425 04338000
         BNZ   @RF01425                                            1425 04339000
*                    DO;               /* SUCCESSFULLY SAVED @G51DGBB*/ 04340000
*                      IF LRTNLAST = OFF THEN /* IF LAST FRAME  */ 1427 04341000
         TM    LRTNLAST(R7),B'10000000'                            1427 04342000
         BNZ   @RF01427                                            1427 04343000
*                        DO;                               /*@G51DGBB*/ 04344000
*                          IF (LRTKEY1 & GENREC) = HEXA0 THEN      1429 04345000
         MVC   @TS00001(1),LRTKEY1(R7)                             1429 04346000
         NI    @TS00001,X'F0'                                      1429 04347000
         CLI   @TS00001,X'A0'                                      1429 04348000
         BNE   @RF01429                                            1429 04349000
*                           DO;                            /*@G51DGBB*/ 04350000
*                            SAVESEQ = ZERO;               /*@G51DGBB*/ 04351000
         MVI   SAVESEQ,X'00'                                       1431 04352000
*                            FRAMETYP(CCHINDX) = ALLMCH;   /*@G51DGBB*/ 04353000
         L     @14,CCHINDX                                         1432 04354000
         MH    @14,@CH00227                                        1432 04355000
         L     @08,FRAMEPTR(,R2)                                   1432 04356000
         ALR   @08,@14                                             1432 04357000
         AL    @08,@CF01576                                        1432 04358000
         MVI   FRAMETYP-17(@08),X'02'                              1432 04359000
*                           END;                           /*@G51DGBB*/ 04360000
*                          /*IF ALL MCH FRAMES HAVE BEEN SAVED,  */     04361000
*                          /*THEN INDICATE SUCH              @G51DGBB*/ 04362000
*                           ELSE                  /*IS CCH FRAME */     04363000
*                            DO;                           /*@G51DGBB*/ 04364000
         B     @RC01429                                            1434 04365000
@RF01429 DS    0H                                                  1435 04366000
*                            FRAMEYES = OFF;               /*@G51DGBB*/ 04367000
         NI    FRAMEYES,B'11111101'                                1435 04368000
*                            IF FRAMETYP(CCHINDX) ^= ALLMCH THEN   1436 04369000
         L     @14,CCHINDX                                         1436 04370000
         MH    @14,@CH00227                                        1436 04371000
         L     @08,FRAMEPTR(,R2)                                   1436 04372000
         ALR   @08,@14                                             1436 04373000
         AL    @08,@CF01576                                        1436 04374000
         CLI   FRAMETYP-17(@08),X'02'                              1436 04375000
         BE    @RF01436                                            1436 04376000
*                              DO; /*IF MISSING LAST MCH FRAME   */     04377000
*                                MSGNO = 79; /*FRAME SET INCOMPLET MSG* 04378000
         MVI   MSGNO,X'4F'                                         1438 04379000
*                                CALL ERRMSG;              /*@G51DGBB*/ 04380000
         BAL   @14,ERRMSG                                          1439 04381000
*                                CALL FIXENTRY; /*DELETE INCOM-  */     04382000
         BAL   @14,FIXENTRY                                        1440 04383000
*                              END;             /*PLETE SET. @G51DGBB*/ 04384000
*                            ELSE   /*IS COMPLETE SET -INDICATE  */     04385000
*                              FRAMETYP(CCHINDX) = ALLALL; /*IT IS*/    04386000
         B     @RC01436                                            1442 04387000
@RF01436 L     @14,CCHINDX                                         1442 04388000
         MH    @14,@CH00227                                        1442 04389000
         L     @08,FRAMEPTR(,R2)                                   1442 04390000
         ALR   @08,@14                                             1442 04391000
         AL    @08,@CF01576                                        1442 04392000
         MVI   FRAMETYP-17(@08),X'FF'                              1442 04393000
*                            END;                          /*@G51DGBB*/ 04394000
*                        END;                              /*@G51DGBB*/ 04395000
*                   END;                                   /*@G51DGBB*/ 04396000
*              END;                                        /*@G51DGBB*/ 04397000
*            ELSE   /*MISSING MIDDLE FRAME                   @G51DGBB*/ 04398000
*              DO;                                         /*@G51DGBB*/ 04399000
         B     @RC01421                                            1447 04400000
@RF01421 DS    0H                                                  1448 04401000
*                MSGNO = 79; /*FRAME SET INCOMPLETE          @G51DGBB*/ 04402000
         MVI   MSGNO,X'4F'                                         1448 04403000
*                CALL ERRMSG;                              /*@G51DGBB*/ 04404000
         BAL   @14,ERRMSG                                          1449 04405000
*                FRAMEYES = OFF; /*DONT SAVE INCOMPLETE SET  @G51DGBB*/ 04406000
         NI    FRAMEYES,B'11111101'                                1450 04407000
*                CALL FIXENTRY; /*DELETE REFS TO INCOMPLETE SET*/  1451 04408000
         BAL   @14,FIXENTRY                                        1451 04409000
*                BUG(30) = BUG(30) + 1;                    /*@G51DGBB*/ 04410000
         LA    @14,1                                               1452 04411000
         AL    @14,BUG+116                                         1452 04412000
         ST    @14,BUG+116                                         1452 04413000
*              END;                                        /*@G51DGBB*/ 04414000
*       END;                                               /*@G51DGBB*/ 04415000
*          ELSE      /*FRAME NOT TO BE SAVED                 @G51DGBB*/ 04416000
*            BUG(30) = BUG(30) + 1;                        /*@G51DGBB*/ 04417000
         B     @RC01418                                            1455 04418000
@RF01418 LA    @14,1                                               1455 04419000
         AL    @14,BUG+116                                         1455 04420000
         ST    @14,BUG+116                                         1455 04421000
*      END;                                                /*@G51DGBB*/ 04422000
*   END;                                                   /*@G51DGBB*/ 04423000
*  ELSE   /*NOT ACCUMULATING OR SELECTING MCH OR CCH RECORDS @G51DGBB*/ 04424000
*    BUG(30) = BUG(30) + 1; /*COUNT FRAMES REJECTED          @G51DGBB*/ 04425000
         B     @RC01404                                            1458 04426000
@RF01404 LA    @14,1                                               1458 04427000
         AL    @14,BUG+116                                         1458 04428000
         ST    @14,BUG+116                                         1458 04429000
*RESPECIFY (R15) UNRESTRICTED;                             /*@G51DGBB*/ 04430000
*END;  /*END OF PROC FLIMFRAM                                @G51DGBB*/ 04431000
@EL00034 DS    0H                                                  1460 04432000
@EF00034 DS    0H                                                  1460 04433000
@ER00034 LM    @14,@12,@SA00034                                    1460 04434000
         BR    @14                                                 1460 04435000
*END  /*CLOSING END TO IFCFILT2 EXTERNAL PROC                @Z427VLS*/ 04436000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 04437000
*/*%INCLUDE SYSLIB  (COMTABLE)                                        * 04438000
*;                                                                 1461 04439000
@DATA    DS    0H                                                       04440000
@CH00079 DC    H'5'                                                     04441000
@CH00081 DC    H'6'                                                     04442000
@CH00083 DC    H'7'                                                     04443000
@CH01548 DC    H'63'                                                    04444000
         DS    0F                                                       04445000
@AL00213 EQU   *                       LIST WITH   1 ARGUMENT(S)        04446000
@AL00396 EQU   *                       LIST WITH   1 ARGUMENT(S)        04447000
@AL01039 EQU   *                       LIST WITH   1 ARGUMENT(S)        04448000
@AL01052 EQU   *                       LIST WITH   1 ARGUMENT(S)        04449000
@AL01232 EQU   *                       LIST WITH   1 ARGUMENT(S)        04450000
@AL01237 EQU   *                       LIST WITH   1 ARGUMENT(S)        04451000
@AL01252 DC    A(@CF00074+2)           LIST WITH   1 ARGUMENT(S)        04452000
@AL00220 DC    A(@CF00076+2)           LIST WITH   1 ARGUMENT(S)        04453000
@AL00239 EQU   *                       LIST WITH   1 ARGUMENT(S)        04454000
@AL01000 EQU   *                       LIST WITH   1 ARGUMENT(S)        04455000
@AL01009 DC    A(@CF00064+2)           LIST WITH   1 ARGUMENT(S)        04456000
@AL00678 DC    A(@CF00981)             LIST WITH   3 ARGUMENT(S)        04457000
@AL00962 EQU   *                       LIST WITH   1 ARGUMENT(S)        04458000
@AL00974 EQU   *                       LIST WITH   1 ARGUMENT(S)        04459000
@AL00990 DC    A(@CH00083)             LIST WITH   1 ARGUMENT(S)        04460000
         DC    A(LINKDEV)                                               04461000
@AL00801 DC    A(@CF00076)             LIST WITH   3 ARGUMENT(S)        04462000
         DC    A(WORKDEV)                                               04463000
         DC    A(LINKDEV)                                               04464000
@AL00998 EQU   *                       LIST WITH   1 ARGUMENT(S)        04465000
@AL01007 DC    A(@CH00081)             LIST WITH   1 ARGUMENT(S)        04466000
@AL01037 DC    A(@CF01484)             LIST WITH   2 ARGUMENT(S)        04467000
         DC    A(@AFTEMPS)                                              04468000
@AL01050 DC    A(@CF01485)             LIST WITH   2 ARGUMENT(S)        04469000
         DC    A(@AFTEMPS)                                              04470000
@AL01186 DC    A(@CF01503)             LIST WITH   2 ARGUMENT(S)        04471000
         DC    A(@AFTEMPS+4)                                            04472000
@AL01189 DC    A(@CF01504)             LIST WITH   2 ARGUMENT(S)        04473000
         DC    A(@AFTEMPS+4)                                            04474000
@AL01192 DC    A(@CF01505)             LIST WITH   2 ARGUMENT(S)        04475000
         DC    A(@AFTEMPS+4)                                            04476000
@AL01199 DC    A(@CF01506)             LIST WITH   2 ARGUMENT(S)        04477000
         DC    A(@AFTEMPS+4)                                            04478000
@AL01202 DC    A(@CF01479)             LIST WITH   2 ARGUMENT(S)        04479000
         DC    A(@AFTEMPS+4)                                            04480000
@AL01229 DC    A(@CF01236)             LIST WITH   2 ARGUMENT(S)        04481000
         DC    A(@AFTEMPS+4)                                            04482000
@AL01231 DC    A(@CF00227)             LIST WITH   2 ARGUMENT(S)        04483000
         DC    A(@AFTEMPS+4)                                            04484000
@AL01365 DC    A(@CH00079)             LIST WITH   1 ARGUMENT(S)        04485000
         DS    0F                                                       04486000
@SA00001 DS    18F                                                      04487000
@SA00002 DS    15F                                                      04488000
@SA00034 DS    15F                                                      04489000
@SA00024 DS    15F                                                      04490000
@SA00011 DS    15F                                                      04491000
@SA00004 DS    15F                                                      04492000
@SA00023 DS    15F                                                      04493000
@SA00029 DS    15F                                                      04494000
@SA00028 DS    15F                                                      04495000
@SA00007 DS    15F                                                      04496000
@SA00008 DS    15F                                                      04497000
@SA00012 DS    15F                                                      04498000
@SA00026 DS    15F                                                      04499000
@SA00030 DS    15F                                                      04500000
@SA00014 DS    15F                                                      04501000
@SA00013 DS    15F                                                      04502000
@SA00020 DS    15F                                                      04503000
@SA00021 DS    15F                                                      04504000
@SA00015 DS    15F                                                      04505000
@SA00025 DS    15F                                                      04506000
@SA00031 DS    15F                                                      04507000
@SA00032 DS    15F                                                      04508000
@AL00001 DS    3A                                                       04509000
@TF00001 DS    F                                                        04510000
@TF00002 DS    F                                                        04511000
@AFTEMPS DS    2F                                                       04512000
         DS    0F                                                       04513000
@CF00055 DC    F'1'                                                     04514000
@CF00074 DC    F'2'                                                     04515000
@CH00074 EQU   @CF00074+2                                               04516000
@CF00076 DC    F'3'                                                     04517000
@CH00076 EQU   @CF00076+2                                               04518000
@CF00064 DC    F'4'                                                     04519000
@CH00064 EQU   @CF00064+2                                               04520000
@CF00066 DC    F'8'                                                     04521000
@CF00034 DC    F'10'                                                    04522000
@CF00032 DC    F'12'                                                    04523000
@CF00981 DC    F'13'                                                    04524000
@CF01057 DC    F'14'                                                    04525000
@CH01057 EQU   @CF01057+2                                               04526000
@CF00088 DC    F'16'                                                    04527000
@CF00786 DC    F'17'                                                    04528000
@CF01185 DC    F'18'                                                    04529000
@CF00227 DC    F'24'                                                    04530000
@CH00227 EQU   @CF00227+2                                               04531000
@CF01125 DC    F'27'                                                    04532000
@CF00892 DC    F'32'                                                    04533000
@CF01236 DC    F'40'                                                    04534000
@CF00295 DC    F'50'                                                    04535000
@CF01504 DC    F'53'                                                    04536000
@CF01503 DC    F'55'                                                    04537000
@CF01506 DC    F'72'                                                    04538000
@CF01505 DC    F'74'                                                    04539000
@CF01484 DC    F'75'                                                    04540000
@CF01485 DC    F'76'                                                    04541000
@CF01479 DC    F'78'                                                    04542000
@CF01552 DC    F'254'                                                   04543000
@CF01562 DC    F'-20'                                                   04544000
@CF01579 DC    F'-17'                                                   04545000
@CF01581 DC    F'-15'                                                   04546000
@CF01392 DC    F'-14'                                                   04547000
@CF01572 DC    F'-13'                                                   04548000
@CF01578 DC    F'-11'                                                   04549000
@CF01571 DC    F'-10'                                                   04550000
@CF01575 DC    F'-8'                                                    04551000
@CF01576 DC    F'-7'                                                    04552000
@CF01560 DC    F'-6'                                                    04553000
@CF01577 DC    F'-4'                                                    04554000
@CF01570 DC    F'-3'                                                    04555000
@CF00893 DC    XL4'FFFFFFF8'                                            04556000
@CF01568 DC    XL4'0000FFFF'                                            04557000
@CV01431 DC    V(IFCDEVIC)                                              04558000
         DS    0D                                                       04559000
ENTRIES  DC    F'1'                                                     04560000
ADDNXT   DC    F'0'                                                     04561000
NEXTBY   DC    F'0'                                                     04562000
LISTPTR  DC    A(0)                                                     04563000
T        DC    F'0'                                                     04564000
P        DC    F'0'                                                     04565000
Q        DC    F'0'                                                     04566000
NUMBER   DS    F                                                        04567000
ZZ       DC    A(0)                                                     04568000
Z1       DC    F'0'                                                     04569000
Z2       DC    F'0'                                                     04570000
Z3       DC    F'0'                                                     04571000
ZZ3      DC    F'0'                                                     04572000
         DS    0D                                                       04573000
@TS00001 DS    CL16                                                     04574000
@CB01527 DC    X'0000000000000000'                                      04575000
@CB00290 EQU   @CB01527                                                 04576000
@CB01482 DC    X'0000000F'                                              04577000
@CB00228 DC    X'00000F'                                                04578000
@CB00237 DC    X'FFFFFF'                                                04579000
@CB00953 DC    X'000FFF'                                                04580000
@CB01361 DC    X'99366F'                                                04581000
@CB00261 EQU   @CB00237                                                 04582000
@CB00898 DC    X'2006'                                                  04583000
@CB00900 DC    X'2007'                                                  04584000
@CB00902 DC    X'2009'                                                  04585000
@CB00904 DC    X'200A'                                                  04586000
@CB00906 DC    X'200B'                                                  04587000
@CB00908 DC    X'200D'                                                  04588000
@CB00910 DC    X'8004'                                                  04589000
@CB00912 DC    X'8005'                                                  04590000
@CB00914 DC    X'8003'                                                  04591000
@CB00916 DC    X'100C'                                                  04592000
@CB00918 DC    X'1008'                                                  04593000
@CB00920 DC    X'0842'                                                  04594000
@CB00949 DC    X'FF00'                                                  04595000
@CB00951 DC    X'0FFF'                                                  04596000
@CB01434 DC    X'8809'                                                  04597000
@CB01439 DC    X'3705'                                                  04598000
LETTERS  DC    CL1'S'                                                   04599000
LETTERC  DC    CL1'C'                                                   04600000
LOWDIGIT DS    BL1                                                      04601000
HIGDIGIT DS    BL1                                                      04602000
RECCPU   DS    CL3                                                      04603000
LOWCUA   DS    CL2                                                      04604000
HIGHCUA  DS    CL2                                                      04605000
         DS    CL1                                                      04606000
FILT1ITM DS    CL131                                                    04607000
         ORG   FILT1ITM                                                 04608000
MAXENT   DC    F'0'                                                     04609000
FREEADR  DC    A(0)                                                     04610000
I        DC    A(1)                                                     04611000
J        DC    A(0)                                                     04612000
K        DC    A(0)                                                     04613000
L        DC    A(0)                                                     04614000
A        DC    A(0)                                                     04615000
X        DC    A(0)                                                     04616000
Y        DC    A(0)                                                     04617000
Z        DC    A(0)                                                     04618000
TMPSTORE DC    A(0)                                                     04619000
LINKPTR  DC    A(0)                                                     04620000
CCHINDX  DC    A(0)                                                     04621000
SAVESEQ  DC    AL1(0)                                                   04622000
         DS    CL3                                                      04623000
UNKNWN   DC    F'0'                                                     04624000
ALLCORE  DC    F'0'                                                     04625000
STSUMPTR DC    A(0)                                                     04626000
COMPLINK DC    A(0)                                                     04627000
M        DC    A(0)                                                     04628000
SRTCONT  DC    F'0'                                                     04629000
SRTCONT1 DC    F'0'                                                     04630000
ERROR    DC    F'0'                                                     04631000
EVPTR1   DC    A(0)                                                     04632000
ERSER    DC    X'00000000'                                              04633000
         ORG   ERSER                                                    04634000
@NM00084 DS    CL1                                                      04635000
ER3      DS    CL3                                                      04636000
         ORG   FILT1ITM+96                                              04637000
NUMUNSHR DC    H'1'                                                     04638000
PACKPAS  DC    CL4'    '                                                04639000
CHARPAS  DC    CL8'        '                                            04640000
         DS    CL2                                                      04641000
PASSNUM  DC    F'0'                                                     04642000
NUMREC   DC    F'0'                                                     04643000
EXCESS   DC    F'0'                                                     04644000
WORKDEV  DC    X'0000'                                                  04645000
         ORG   WORKDEV                                                  04646000
WORKDEV1 DS    CL1                                                      04647000
WORKDEV2 DS    CL1                                                      04648000
         ORG   FILT1ITM+126                                             04649000
WORKTYPE DC    X'00'                                                    04650000
CUA3     DC    X'000000'                                                04651000
         ORG   CUA3                                                     04652000
@NM00085 DS    BL1                                                      04653000
WORKCUA  DS    BL2                                                      04654000
         ORG   WORKCUA                                                  04655000
WRKCUA   DS    BL2                                                      04656000
         ORG   FILT1ITM+130                                             04657000
MSGNO    DC    AL1(0)                                                   04658000
         ORG   FILT1ITM+131                                             04659000
LINKDEV  DS    CL4                                                      04660000
         ORG   LINKDEV                                                  04661000
DEVLABEL DS    CL2                                                      04662000
@NM00086 DS    CL2                                                      04663000
         ORG   LINKDEV+4                                                04664000
ERRPLACE DS    BL1                                                      04665000
         ORG   ERRPLACE                                                 04666000
ERRP1    DS    BL1                                                      04667000
ERRP2    EQU   ERRPLACE+0                                               04668000
         ORG   ERRPLACE+1                                               04669000
PRINTLIN DS    CL134                                                    04670000
         ORG   PRINTLIN                                                 04671000
PRINTDS  DC    X'F1'                                                    04672000
PRINTCC  DC    X'09'                                                    04673000
PRINTBDY DC    CL132' '                                                 04674000
         ORG   PRINTBDY                                                 04675000
@NM00087 DS    CL8                                                      04676000
PRINTED  DS    CL9                                                      04677000
@NM00088 DS    CL24                                                     04678000
PRNTSER  DS    CL7                                                      04679000
         ORG   PRINTLIN+134                                             04680000
PARTIAL  DS    CL58                                                     04681000
         ORG   PARTIAL                                                  04682000
@NM00091 DC    CL29'DEBUG16 FRAME SET INCOMPLETE '                      04683000
PARMOD   DS    CL4                                                      04684000
@NM00092 DC    CL1' '                                                   04685000
PARSER   DS    CL6                                                      04686000
@NM00093 DC    CL17' FRAMEREP SET TO '                                  04687000
PARREP   DS    CL1                                                      04688000
         ORG   PARTIAL+58                                               04689000
BITSWIT  DC    X'000000'                                                04690000
         ORG   BITSWIT                                                  04691000
NONBLANK DS    BL1                                                      04692000
SORTSW   EQU   BITSWIT+0                                                04693000
UNIQUE   EQU   BITSWIT+0                                                04694000
MISSW    EQU   BITSWIT+0                                                04695000
GETOUT   EQU   BITSWIT+0                                                04696000
FIRSTIME EQU   BITSWIT+0                                                04697000
MISSW1   EQU   BITSWIT+0                                                04698000
ONBOUND  EQU   BITSWIT+0                                                04699000
SHAREYES DS    BL1                                                      04700000
CUAOK    EQU   BITSWIT+1                                                04701000
CPUOK    EQU   BITSWIT+1                                                04702000
CPU0FLG  EQU   BITSWIT+1                                                04703000
GETFAIL  EQU   BITSWIT+1                                                04704000
LOOPOUT  EQU   BITSWIT+1                                                04705000
FRAMEYES EQU   BITSWIT+1                                                04706000
ONETIME  EQU   BITSWIT+1                                                04707000
FOUND    DS    BL1                                                      04708000
DEVOK    EQU   BITSWIT+2                                                04709000
         ORG   BITSWIT+3                                                04710000
WORKBYTE DS    BL1                                                      04711000
         ORG   WORKBYTE                                                 04712000
WORKBYT4 DS    BL1                                                      04713000
         ORG   WORKBYTE+1                                               04714000
WORKTWO  DS    BL1                                                      04715000
ZERO5    DC    X'0000000000'                                            04716000
SYSUM2   DC    X'0000000000000000000000000000'                          04717000
         ORG   SYSUM2                                                   04718000
SYSUMKEY DS    CL7                                                      04719000
         ORG   SYSUMKEY                                                 04720000
SYSGROUP DS    FL1                                                      04721000
SYSRT    DS    BL2                                                      04722000
         ORG   SYSRT                                                    04723000
SYSCUA   DS    BL2                                                      04724000
SYSSPAN  EQU   SYSRT+1                                                  04725000
SYSTROLL EQU   SYSRT+1                                                  04726000
         ORG   SYSUMKEY+3                                               04727000
SYSCPUS  DS    BL1                                                      04728000
         ORG   SYSCPUS                                                  04729000
SYSCPU   DS    BL1                                                      04730000
SYSOLD   EQU   SYSCPUS+0                                                04731000
         ORG   SYSUMKEY+4                                               04732000
SYSITEM  DS    BL1                                                      04733000
         ORG   SYSITEM                                                  04734000
SYS3705  DS    BL1                                                      04735000
SYSOLDA  EQU   SYSITEM+0                                                04736000
         ORG   SYSUMKEY+5                                               04737000
SYSDEV   DS    CL2                                                      04738000
         ORG   SYSUM2+7                                                 04739000
SYSRANGE DS    CL1                                                      04740000
SYSPERM1 DS    FL2                                                      04741000
         ORG   SYSPERM1                                                 04742000
@NM00098 DS    BL2                                                      04743000
SYSPERM  EQU   SYSPERM1+1                                               04744000
         ORG   SYSUM2+10                                                04745000
SYSTEMP  DS    FL4                                                      04746000
         ORG   SYSUM2+14                                                04747000
CHARS    DC    CL16'0123456789ABCDEF'                                   04748000
SUPERZAP DC    3CL10'SUPERZAP'                                          04749000
         DS    CL2                                                      04750000
SAVEADR  DC    A(0)                                                     04751000
         DS    15XL4                                                    04752000
EVCON    DC    CL1'A'                                                   04753000
         DC    CL1'B'                                                   04754000
         DC    CL1'C'                                                   04755000
         DC    CL1'D'                                                   04756000
         DC    CL1'E'                                                   04757000
         DC    CL1'F'                                                   04758000
         DC    CL1'G'                                                   04759000
         DC    CL1'H'                                                   04760000
         DC    CL1'I'                                                   04761000
         DC    CL1'J'                                                   04762000
         DC    CL1'K'                                                   04763000
         DC    CL1'L'                                                   04764000
         DC    CL1'M'                                                   04765000
         DC    CL1'N'                                                   04766000
         DC    CL1'O'                                                   04767000
         DC    CL1'P'                                                   04768000
FLIP     DC    AL1(0)                                                   04769000
         DC    AL1(1)                                                   04770000
         DC    AL1(2)                                                   04771000
         DC    AL1(3)                                                   04772000
         DC    AL1(4)                                                   04773000
         DC    AL1(5)                                                   04774000
         DC    AL1(6)                                                   04775000
         DC    AL1(7)                                                   04776000
         DC    AL1(8)                                                   04777000
         DC    AL1(9)                                                   04778000
         DC    AL1(10)                                                  04779000
         DC    AL1(11)                                                  04780000
         DC    AL1(12)                                                  04781000
         DC    AL1(13)                                                  04782000
         DC    AL1(14)                                                  04783000
         DC    AL1(15)                                                  04784000
FLIPCPUS DS    16BL1                                                    04785000
EDIFILD  DS    9CL1                                                     04786000
         DS    CL3                                                      04787000
PATCH    DC    25F'0'                                                   04788000
BUG      DC    40F'0'                                                   04789000
ERRLINE  DS    CL63                                                     04790000
         ORG   ERRLINE+0                                                04791000
ERRDS    DC    CL1'1'                                                   04792000
ERCC     DC    X'09'                                                    04793000
ERRMES   DC    CL10'DEBUG16   '                                         04794000
ERXNUM   DC    CL9'         '                                           04795000
@NM00099 DC    CL2'  '                                                  04796000
ERRTXT   DC    CL40'UNKNOWN RECORDS IDENTIFIED              '           04797000
         ORG   ERRLINE+63                                               04798000
         ORG   ERRLINE+63                                               04799000
         DC    CL1'1'                                                   04800000
         DC    X'09'                                                    04801000
         DC    CL10'DEBUG16   '                                         04802000
         DC    CL9'         '                                           04803000
         DC    CL2'  '                                                  04804000
         DC    CL40'SOFT    RECORDS IDENTIFIED              '           04805000
         ORG   ERRLINE+126                                              04806000
         ORG   ERRLINE+126                                              04807000
         DC    CL1'1'                                                   04808000
         DC    X'09'                                                    04809000
         DC    CL10'DEBUG16   '                                         04810000
         DC    CL9'         '                                           04811000
         DC    CL2'  '                                                  04812000
         DC    CL40'MCH     RECORDS IDENTIFIED              '           04813000
         ORG   ERRLINE+189                                              04814000
         ORG   ERRLINE+189                                              04815000
         DC    CL1'1'                                                   04816000
         DC    X'09'                                                    04817000
         DC    CL10'DEBUG16   '                                         04818000
         DC    CL9'         '                                           04819000
         DC    CL2'  '                                                  04820000
         DC    CL40'CCH     RECORDS IDENTIFIED              '           04821000
         ORG   ERRLINE+252                                              04822000
         ORG   ERRLINE+252                                              04823000
         DC    CL1'1'                                                   04824000
         DC    X'09'                                                    04825000
         DC    CL10'DEBUG16   '                                         04826000
         DC    CL9'         '                                           04827000
         DC    CL2'  '                                                  04828000
         DC    CL40'IPL     RECORDS IDENTIFIED              '           04829000
         ORG   ERRLINE+315                                              04830000
         ORG   ERRLINE+315                                              04831000
         DC    CL1'1'                                                   04832000
         DC    X'09'                                                    04833000
         DC    CL10'DEBUG16   '                                         04834000
         DC    CL9'         '                                           04835000
         DC    CL2'  '                                                  04836000
         DC    CL40'EOD     RECORDS IDENTIFIED              '           04837000
         ORG   ERRLINE+378                                              04838000
         ORG   ERRLINE+378                                              04839000
         DC    CL1'1'                                                   04840000
         DC    X'09'                                                    04841000
         DC    CL10'DEBUG16   '                                         04842000
         DC    CL9'         '                                           04843000
         DC    CL2'  '                                                  04844000
         DC    CL40'OBR     RECORDS IDENTIFIED              '           04845000
         ORG   ERRLINE+441                                              04846000
         ORG   ERRLINE+441                                              04847000
         DC    CL1'1'                                                   04848000
         DC    X'09'                                                    04849000
         DC    CL10'DEBUG16   '                                         04850000
         DC    CL9'         '                                           04851000
         DC    CL2'  '                                                  04852000
         DC    CL40'OTHER VALID RECORDS IDENTIFIED          '           04853000
         ORG   ERRLINE+504                                              04854000
         ORG   ERRLINE+504                                              04855000
         DC    CL1'1'                                                   04856000
         DC    X'09'                                                    04857000
         DC    CL10'DEBUG16   '                                         04858000
         DC    CL9'         '                                           04859000
         DC    CL2'  '                                                  04860000
         DC    CL40'MDR TYPE 91 DEVICE TYPE 3705 RECORDS    '           04861000
         ORG   ERRLINE+567                                              04862000
         ORG   ERRLINE+567                                              04863000
         DC    CL1'1'                                                   04864000
         DC    X'09'                                                    04865000
         DC    CL10'DEBUG16   '                                         04866000
         DC    CL9'         '                                           04867000
         DC    CL2'  '                                                  04868000
         DC    CL40'MDR NOT DEVICE 3705 OR 33XX             '           04869000
         ORG   ERRLINE+630                                              04870000
         ORG   ERRLINE+630                                              04871000
         DC    CL1'1'                                                   04872000
         DC    X'09'                                                    04873000
         DC    CL10'DEBUG16   '                                         04874000
         DC    CL9'         '                                           04875000
         DC    CL2'  '                                                  04876000
         DC    CL40'MDR RECORDS SAVED IN SYSUM2             '           04877000
         ORG   ERRLINE+693                                              04878000
         ORG   ERRLINE+693                                              04879000
         DC    CL1'1'                                                   04880000
         DC    X'09'                                                    04881000
         DC    CL10'DEBUG16   '                                         04882000
         DC    CL9'         '                                           04883000
         DC    CL2'  '                                                  04884000
         DC    CL40'OBR RECORDS SAVED IN SYSUM2             '           04885000
         ORG   ERRLINE+756                                              04886000
         ORG   ERRLINE+756                                              04887000
         DC    CL1'1'                                                   04888000
         DC    X'09'                                                    04889000
         DC    CL10'DEBUG16   '                                         04890000
         DC    CL9'         '                                           04891000
         DC    CL2'  '                                                  04892000
         DC    CL40'RECORDS SAVED WITH CPU SERIAL NO. FFFFFF'           04893000
         ORG   ERRLINE+819                                              04894000
         ORG   ERRLINE+819                                              04895000
         DC    CL1'1'                                                   04896000
         DC    X'09'                                                    04897000
         DC    CL10'DEBUG16   '                                         04898000
         DC    CL9'         '                                           04899000
         DC    CL2'  '                                                  04900000
         DC    CL40'SORTWO FLIPS DONE                       '           04901000
         ORG   ERRLINE+882                                              04902000
         ORG   ERRLINE+882                                              04903000
         DC    CL1'1'                                                   04904000
         DC    X'09'                                                    04905000
         DC    CL10'DEBUG16   '                                         04906000
         DC    CL9'         '                                           04907000
         DC    CL2'  '                                                  04908000
         DC    CL40'DEVICE GROUP 1 RECORDS SAVED            '           04909000
         ORG   ERRLINE+945                                              04910000
         ORG   ERRLINE+945                                              04911000
         DC    CL1'1'                                                   04912000
         DC    X'09'                                                    04913000
         DC    CL10'DEBUG16   '                                         04914000
         DC    CL9'         '                                           04915000
         DC    CL2'  '                                                  04916000
         DC    CL40'DEVICE GROUP 2 RECORDS SAVED            '           04917000
         ORG   ERRLINE+1008                                             04918000
         ORG   ERRLINE+1008                                             04919000
         DC    CL1'1'                                                   04920000
         DC    X'09'                                                    04921000
         DC    CL10'DEBUG16   '                                         04922000
         DC    CL9'         '                                           04923000
         DC    CL2'  '                                                  04924000
         DC    CL40'DEVICE GROUP 3 RECORDS SAVED            '           04925000
         ORG   ERRLINE+1071                                             04926000
         ORG   ERRLINE+1071                                             04927000
         DC    CL1'1'                                                   04928000
         DC    X'09'                                                    04929000
         DC    CL10'DEBUG16   '                                         04930000
         DC    CL9'         '                                           04931000
         DC    CL2'  '                                                  04932000
         DC    CL40'DEVICE GROUP 4 RECORDS SAVED            '           04933000
         ORG   ERRLINE+1134                                             04934000
         ORG   ERRLINE+1134                                             04935000
         DC    CL1'1'                                                   04936000
         DC    X'09'                                                    04937000
         DC    CL10'DEBUG16   '                                         04938000
         DC    CL9'         '                                           04939000
         DC    CL2'  '                                                  04940000
         DC    CL40'DEVICE GROUP 5 RECORDS SAVED            '           04941000
         ORG   ERRLINE+1197                                             04942000
         ORG   ERRLINE+1197                                             04943000
         DC    CL1'1'                                                   04944000
         DC    X'09'                                                    04945000
         DC    CL10'DEBUG16   '                                         04946000
         DC    CL9'         '                                           04947000
         DC    CL2'  '                                                  04948000
         DC    CL40'DEVICE GROUP 6 RECORDS SAVED            '           04949000
         ORG   ERRLINE+1260                                             04950000
         ORG   ERRLINE+1260                                             04951000
         DC    CL1'1'                                                   04952000
         DC    X'09'                                                    04953000
         DC    CL10'DEBUG16   '                                         04954000
         DC    CL9'         '                                           04955000
         DC    CL2'  '                                                  04956000
         DC    CL40'RECORDS RETRIEVED VIA READSEQ           '           04957000
         ORG   ERRLINE+1323                                             04958000
         ORG   ERRLINE+1323                                             04959000
         DC    CL1'1'                                                   04960000
         DC    X'09'                                                    04961000
         DC    CL10'DEBUG16   '                                         04962000
         DC    CL9'         '                                           04963000
         DC    CL2'  '                                                  04964000
         DC    CL40'RECORDS PASSED DATE,TIME FILTERING      '           04965000
         ORG   ERRLINE+1386                                             04966000
         ORG   ERRLINE+1386                                             04967000
         DC    CL1'1'                                                   04968000
         DC    X'09'                                                    04969000
         DC    CL10'DEBUG16   '                                         04970000
         DC    CL9'         '                                           04971000
         DC    CL2'  '                                                  04972000
         DC    CL40'MDR 33XX RECORDS IDENTIFIED             '           04973000
         ORG   ERRLINE+1449                                             04974000
         ORG   ERRLINE+1449                                             04975000
         DC    CL1'1'                                                   04976000
         DC    X'09'                                                    04977000
         DC    CL10'DEBUG16   '                                         04978000
         DC    CL9'         '                                           04979000
         DC    CL2'  '                                                  04980000
         DC    CL40'MDR 33XX RECORDS SAVED                  '           04981000
         ORG   ERRLINE+1512                                             04982000
         ORG   ERRLINE+1512                                             04983000
         DC    CL1'1'                                                   04984000
         DC    X'09'                                                    04985000
         DC    CL10'DEBUG16   '                                         04986000
         DC    CL9'         '                                           04987000
         DC    CL2'  '                                                  04988000
         DC    CL40'OBR 33XX RECORDS IDENTIFIED             '           04989000
         ORG   ERRLINE+1575                                             04990000
         ORG   ERRLINE+1575                                             04991000
         DC    CL1'1'                                                   04992000
         DC    X'09'                                                    04993000
         DC    CL10'DEBUG16   '                                         04994000
         DC    CL9'         '                                           04995000
         DC    CL2'  '                                                  04996000
         DC    CL40'OBR 33XX RECORDS SAVED                  '           04997000
         ORG   ERRLINE+1638                                             04998000
         ORG   ERRLINE+1638                                             04999000
         DC    CL1'1'                                                   05000000
         DC    X'09'                                                    05001000
         DC    CL10'DEBUG16   '                                         05002000
         DC    CL9'         '                                           05003000
         DC    CL2'  '                                                  05004000
         DC    CL40'34XX     RECORDS FOUND                  '           05005000
         ORG   ERRLINE+1701                                             05006000
         ORG   ERRLINE+1701                                             05007000
         DC    CL1'1'                                                   05008000
         DC    X'09'                                                    05009000
         DC    CL10'DEBUG16   '                                         05010000
         DC    CL9'         '                                           05011000
         DC    CL2'  '                                                  05012000
         DC    CL40'34XX     RECORDS SAVED                  '           05013000
         ORG   ERRLINE+1764                                             05014000
         ORG   ERRLINE+1764                                             05015000
         DC    CL1'1'                                                   05016000
         DC    X'09'                                                    05017000
         DC    CL10'DEBUG16   '                                         05018000
         DC    CL9'         '                                           05019000
         DC    CL2'  '                                                  05020000
         DC    CL40'FRAMES USED IN PROCESSING               '           05021000
         ORG   ERRLINE+1827                                             05022000
         ORG   ERRLINE+1827                                             05023000
         DC    CL1'1'                                                   05024000
         DC    X'09'                                                    05025000
         DC    CL10'DEBUG16   '                                         05026000
         DC    CL9'         '                                           05027000
         DC    CL2'  '                                                  05028000
         DC    CL40'FRAMES NOT USED IN PROCESSING           '           05029000
         ORG   ERRLINE+1890                                             05030000
         ORG   ERRLINE+1890                                             05031000
         DC    CL1'1'                                                   05032000
         DC    X'09'                                                    05033000
         DC    CL10'DEBUG16   '                                         05034000
         DC    CL9'         '                                           05035000
         DC    CL2'  '                                                  05036000
         DC    CL40'RECORDS DROPPED DUE TO DEVICE FILTERING '           05037000
         ORG   ERRLINE+1953                                             05038000
         ORG   ERRLINE+1953                                             05039000
         DC    CL1'1'                                                   05040000
         DC    X'09'                                                    05041000
         DC    CL10'DEBUG16   '                                         05042000
         DC    CL9'         '                                           05043000
         DC    CL2'  '                                                  05044000
         DC    CL40'RECORDS DROPPED DUE TO CUA FILTERING    '           05045000
         ORG   ERRLINE+2016                                             05046000
         ORG   ERRLINE+2016                                             05047000
         DC    CL1'1'                                                   05048000
         DC    X'09'                                                    05049000
         DC    CL10'DEBUG16   '                                         05050000
         DC    CL9'         '                                           05051000
         DC    CL2'  '                                                  05052000
         DC    CL40'****IFCFILT2 DEBUG16 RECORD COUNTS******'           05053000
         ORG   ERRLINE+2079                                             05054000
         ORG   ERRLINE+2079                                             05055000
         DC    CL1'1'                                                   05056000
         DC    X'09'                                                    05057000
         DC    CL10'DEBUG16   '                                         05058000
         DC    CL9'         '                                           05059000
         DC    CL2'  '                                                  05060000
         ORG   ERRLINE+2142                                             05061000
         ORG   ERRLINE+2142                                             05062000
         DC    CL1'1'                                                   05063000
         DC    X'09'                                                    05064000
         DC    CL10'DEBUG16   '                                         05065000
         DC    CL9'         '                                           05066000
         DC    CL2'  '                                                  05067000
         ORG   ERRLINE+2205                                             05068000
         ORG   ERRLINE+2205                                             05069000
         DC    CL1'1'                                                   05070000
         DC    X'09'                                                    05071000
         DC    CL10'DEBUG16   '                                         05072000
         DC    CL9'         '                                           05073000
         DC    CL2'  '                                                  05074000
         ORG   ERRLINE+2268                                             05075000
         ORG   ERRLINE+2268                                             05076000
         DC    CL1'1'                                                   05077000
         DC    X'09'                                                    05078000
         DC    CL10'DEBUG16   '                                         05079000
         DC    CL9'         '                                           05080000
         DC    CL2'  '                                                  05081000
         ORG   ERRLINE+2331                                             05082000
         ORG   ERRLINE+2331                                             05083000
         DC    CL1'1'                                                   05084000
         DC    X'09'                                                    05085000
         DC    CL10'DEBUG16   '                                         05086000
         DC    CL9'         '                                           05087000
         DC    CL2'  '                                                  05088000
         ORG   ERRLINE+2394                                             05089000
         ORG   ERRLINE+2394                                             05090000
         DC    CL1'1'                                                   05091000
         DC    X'09'                                                    05092000
         DC    CL10'DEBUG16   '                                         05093000
         DC    CL9'         '                                           05094000
         DC    CL2'  '                                                  05095000
         ORG   ERRLINE+2457                                             05096000
         ORG   ERRLINE+2457                                             05097000
         DC    CL1'1'                                                   05098000
         DC    X'09'                                                    05099000
         DC    CL10'DEBUG16   '                                         05100000
         DC    CL9'         '                                           05101000
         DC    CL2'  '                                                  05102000
         ORG   ERRLINE+2520                                             05103000
IFCFILT2 CSECT                                                          05104000
         DC    S(SUPERZAP)                                              05105000
IFCFILT2 CSECT                                                          05106000
         DC    S(PATCH)   BASE DISPLACEMENT ADDRESS OF PATCH AREA       05107000
IFCFILT2 CSECT                                                          05108000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       05109000
@01      EQU   01                                                       05110000
@02      EQU   02                                                       05111000
@03      EQU   03                                                       05112000
@04      EQU   04                                                       05113000
@05      EQU   05                                                       05114000
@06      EQU   06                                                       05115000
@07      EQU   07                                                       05116000
@08      EQU   08                                                       05117000
@09      EQU   09                                                       05118000
@10      EQU   10                                                       05119000
@11      EQU   11                                                       05120000
@12      EQU   12                                                       05121000
@13      EQU   13                                                       05122000
@14      EQU   14                                                       05123000
@15      EQU   15                                                       05124000
R2       EQU   @02                                                      05125000
R7       EQU   @07                                                      05126000
R0       EQU   @00                                                      05127000
R1       EQU   @01                                                      05128000
R3       EQU   @03                                                      05129000
R4       EQU   @04                                                      05130000
R5       EQU   @05                                                      05131000
R6       EQU   @06                                                      05132000
R8       EQU   @08                                                      05133000
R12      EQU   @12                                                      05134000
R15      EQU   @15                                                      05135000
R10      EQU   @10                                                      05136000
R11      EQU   @11                                                      05137000
R13      EQU   @13                                                      05138000
R14      EQU   @14                                                      05139000
R9       EQU   @09                                                      05140000
IOHND    EQU   0                                                        05141000
IFCMSG   EQU   0                                                        05142000
PARM     EQU   0                                                        05143000
RECTYPE  EQU   PARM                                                     05144000
PMCH     EQU   RECTYPE                                                  05145000
PCHAN    EQU   RECTYPE                                                  05146000
SWITCHES EQU   PARM+2                                                   05147000
ZEROALL  EQU   SWITCHES+1                                               05148000
DEVEXCL  EQU   SWITCHES+1                                               05149000
SHIFT3RD EQU   SWITCHES+1                                               05150000
DEBUG    EQU   PARM+4                                                   05151000
DEBUG4   EQU   DEBUG                                                    05152000
DEBUG11  EQU   DEBUG+1                                                  05153000
DEBUG16  EQU   DEBUG+2                                                  05154000
DEBUG23  EQU   DEBUG+2                                                  05155000
DEBUGA   EQU   PARM+8                                                   05156000
DEBUG50  EQU   DEBUGA+2                                                 05157000
MISC     EQU   PARM+12                                                  05158000
PACC     EQU   MISC                                                     05159000
PHIST    EQU   MISC                                                     05160000
PRINTES  EQU   MISC                                                     05161000
PASSFLAG EQU   MISC                                                     05162000
OPENCLSE EQU   PARM+13                                                  05163000
OPENIO   EQU   OPENCLSE                                                 05164000
CLOSEIO  EQU   OPENCLSE+2                                               05165000
CACCIN   EQU   CLOSEIO                                                  05166000
CDRCTWRK EQU   CLOSEIO                                                  05167000
DATENOW  EQU   PARM+17                                                  05168000
STDT     EQU   PARM+23                                                  05169000
STDATE   EQU   STDT                                                     05170000
PSTD     EQU   STDATE+1                                                 05171000
ENDDT    EQU   PARM+31                                                  05172000
ENDDATE  EQU   ENDDT                                                    05173000
PEND     EQU   ENDDATE+1                                                05174000
STTIME1  EQU   PARM+39                                                  05175000
ENDTIME1 EQU   PARM+43                                                  05176000
STTIME2  EQU   PARM+47                                                  05177000
ENDTIME2 EQU   PARM+51                                                  05178000
STRTDATE EQU   PARM+55                                                  05179000
@NM00006 EQU   PARM+72                                                  05180000
@NM00007 EQU   PARM+75                                                  05181000
TABSIZE  EQU   PARM+80                                                  05182000
SORTNUM  EQU   PARM+84                                                  05183000
ERRID    EQU   PARM+92                                                  05184000
IDTIMEA  EQU   ERRID+6                                                  05185000
IDTIME   EQU   IDTIMEA                                                  05186000
CCHHRLNG EQU   PARM+112                                                 05187000
RECCCHHR EQU   CCHHRLNG                                                 05188000
ADIOHND  EQU   PARM+124                                                 05189000
ADIFCMSG EQU   PARM+128                                                 05190000
ADEDITB  EQU   PARM+132                                                 05191000
EVPTR    EQU   PARM+136                                                 05192000
SORTADR  EQU   PARM+140                                                 05193000
PRINTADR EQU   PARM+148                                                 05194000
CUAPTR   EQU   PARM+152                                                 05195000
DEVPTR   EQU   PARM+156                                                 05196000
MODPTR   EQU   PARM+160                                                 05197000
SERPTR   EQU   PARM+164                                                 05198000
VOLPTR   EQU   PARM+168                                                 05199000
CPUPTR   EQU   PARM+172                                                 05200000
CPCUAPTR EQU   PARM+176                                                 05201000
LIBADPTR EQU   PARM+180                                                 05202000
SYMCDPTR EQU   PARM+184                                                 05203000
SYSUMPTR EQU   PARM+188                                                 05204000
TRENPTR  EQU   PARM+192                                                 05205000
SHAREPTR EQU   PARM+196                                                 05206000
FRAMEPTR EQU   PARM+200                                                 05207000
MERDCPTR EQU   PARM+208                                                 05208000
DUMPTABL EQU   PARM+228                                                 05209000
DUMPINFO EQU   DUMPTABL+4                                               05210000
TRENDONE EQU   0                                                        05211000
TREGEN   EQU   TRENDONE+8                                               05212000
EVTABLE  EQU   0                                                        05213000
EVSTOP   EQU   EVTABLE                                                  05214000
EVNUM    EQU   EVTABLE+4                                                05215000
EVKEY    EQU   EVTABLE+6                                                05216000
EVMODEL  EQU   EVKEY                                                    05217000
EVSERIAL EQU   EVKEY+2                                                  05218000
EVLETTER EQU   EVKEY+5                                                  05219000
SORTABLE EQU   0                                                        05220000
SORTKEY  EQU   SORTABLE                                                 05221000
SORTCCHR EQU   SORTABLE+5                                               05222000
SYSUMONE EQU   0                                                        05223000
SYSUMNUM EQU   SYSUMONE                                                 05224000
SYSUMIPL EQU   SYSUMONE+4                                               05225000
SYSUMNXT EQU   SYSUMONE+8                                               05226000
SYSUMMCR EQU   SYSUMONE+12                                              05227000
SYSUMMCN EQU   SYSUMONE+16                                              05228000
SYSUMCH  EQU   SYSUMONE+20                                              05229000
SYSUMPEI EQU   SYSUMONE+84                                              05230000
SYSUMPEA EQU   SYSUMONE+88                                              05231000
SYSUMPER EQU   SYSUMONE+92                                              05232000
SYSUMEOD EQU   SYSUMONE+96                                              05233000
SHARE    EQU   0                                                        05234000
SHARENUM EQU   SHARE                                                    05235000
SHAREIO  EQU   SHARE+2                                                  05236000
SHAREFLG EQU   SHAREIO                                                  05237000
SHRBASE  EQU   SHAREIO+1                                                05238000
SHARSERB EQU   SHRBASE                                                  05239000
SHRCUABL EQU   SHRBASE+3                                                05240000
SHRCUABH EQU   SHRBASE+5                                                05241000
SHRCUCPU EQU   SHAREIO+8                                                05242000
SHARSERA EQU   SHRCUCPU                                                 05243000
SHRCUAAL EQU   SHRCUCPU+3                                               05244000
SHRCUAAH EQU   SHRCUCPU+5                                               05245000
SHARLET  EQU   SHAREIO+15                                               05246000
EDITLOAD EQU   0                                                        05247000
EDITABLE EQU   EDITLOAD+4                                               05248000
CUA      EQU   0                                                        05249000
CUANUM   EQU   CUA                                                      05250000
CUAVAL   EQU   CUA+2                                                    05251000
CUA1     EQU   CUAVAL                                                   05252000
CUA2     EQU   CUAVAL+2                                                 05253000
DEVICE   EQU   0                                                        05254000
DEVNUM   EQU   DEVICE                                                   05255000
DEVVAL   EQU   DEVICE+2                                                 05256000
MDRNUM   EQU   DEVICE+202                                               05257000
MDRVAL   EQU   DEVICE+204                                               05258000
MODELS   EQU   0                                                        05259000
DEVSERAL EQU   0                                                        05260000
VOLUME   EQU   0                                                        05261000
CPUS     EQU   0                                                        05262000
CPUNUM   EQU   CPUS                                                     05263000
CPUVAL   EQU   CPUS+2                                                   05264000
CPUCUAS  EQU   0                                                        05265000
CPUCUAV  EQU   CPUCUAS+2                                                05266000
LIBADR   EQU   0                                                        05267000
SYMCODE  EQU   0                                                        05268000
SYMVAL   EQU   SYMCODE+2                                                05269000
TMT2     EQU   0                                                        05270000
TMTKEY   EQU   TMT2                                                     05271000
TMTSRT   EQU   TMTKEY+1                                                 05272000
TMTCPUS  EQU   TMTKEY+3                                                 05273000
TMTITEM  EQU   TMTKEY+4                                                 05274000
TMTPERM1 EQU   TMT2+8                                                   05275000
TMP2     EQU   0                                                        05276000
TMPKEY   EQU   TMP2                                                     05277000
TMPSRT   EQU   TMPKEY+1                                                 05278000
TMPCPUS  EQU   TMPKEY+3                                                 05279000
TMPITEM  EQU   TMPKEY+4                                                 05280000
TMPPERM1 EQU   TMP2+8                                                   05281000
MERIDIAN EQU   0                                                        05282000
MRDNUMBR EQU   MERIDIAN                                                 05283000
MODEL    EQU   MERIDIAN+2                                               05284000
LRTREC   EQU   0                                                        05285000
LRTKEY   EQU   LRTREC                                                   05286000
LRTKEY1  EQU   LRTKEY                                                   05287000
LRTSMS   EQU   LRTREC+2                                                 05288000
LRTNLAST EQU   LRTSMS                                                   05289000
LRTRUNC  EQU   LRTSMS                                                   05290000
LRTERRID EQU   LRTREC+3                                                 05291000
@NM00017 EQU   LRTREC+4                                                 05292000
LRTCNT   EQU   @NM00017+2                                               05293000
LRTDT    EQU   LRTREC+8                                                 05294000
LRTDATE  EQU   LRTDT                                                    05295000
LRTYRDAY EQU   LRTDATE+1                                                05296000
LRTTIME  EQU   LRTDT+4                                                  05297000
LRTCPU   EQU   LRTREC+16                                                05298000
LRTCPMOD EQU   LRTCPU+1                                                 05299000
LRTCPUS  EQU   LRTCPMOD                                                 05300000
LRTMODEL EQU   LRTCPMOD+3                                               05301000
MCHREC   EQU   0                                                        05302000
MCHHEAD  EQU   MCHREC                                                   05303000
MCHKEY   EQU   MCHHEAD                                                  05304000
MCHSMS   EQU   MCHHEAD+2                                                05305000
MCHSYSTR EQU   MCHSMS+1                                                 05306000
MCHCPUID EQU   MCHHEAD+16                                               05307000
CCHREC   EQU   0                                                        05308000
CCHHEAD  EQU   CCHREC                                                   05309000
CCHKEY   EQU   CCHHEAD                                                  05310000
CCHSMS   EQU   CCHHEAD+2                                                05311000
CCHCPUID EQU   CCHHEAD+16                                               05312000
CCHCODE  EQU   CCHREC+68                                                05313000
CCHCODE2 EQU   CCHCODE+2                                                05314000
CCHCUA   EQU   CCHREC+74                                                05315000
OBRREC   EQU   0                                                        05316000
OBRHEAD  EQU   OBRREC                                                   05317000
OBRKEY   EQU   OBRHEAD                                                  05318000
OBRSMS   EQU   OBRHEAD+2                                                05319000
MISCSW   EQU   OBRSMS                                                   05320000
OBRSUBTP EQU   OBRSMS+1                                                 05321000
SDRCOUNT EQU   OBRSUBTP                                                 05322000
OBRTEMP  EQU   OBRSUBTP                                                 05323000
SHORTSW  EQU   OBRSUBTP                                                 05324000
DISMOUNT EQU   OBRSUBTP                                                 05325000
OBRCPUID EQU   OBRHEAD+16                                               05326000
OBRJOBID EQU   OBRREC+24                                                05327000
OBRSDEV2 EQU   OBRJOBID+2                                               05328000
OBRSSDRC EQU   OBRJOBID+4                                               05329000
OBRSCUA  EQU   OBRJOBID+5                                               05330000
OBRFCCW  EQU   OBRREC+32                                                05331000
OBRSRDS  EQU   OBRFCCW                                                  05332000
OBRCSW   EQU   OBRREC+40                                                05333000
OBRDEVDC EQU   OBRREC+48                                                05334000
OBRCODE  EQU   OBRREC+52                                                05335000
OBRDEV   EQU   OBRCODE+2                                                05336000
OBRCLASS EQU   OBRDEV                                                   05337000
OBRLSDRC EQU   OBRREC+56                                                05338000
OBRPCUA  EQU   OBRREC+57                                                05339000
OBRSEEK  EQU   OBRREC+70                                                05340000
OBRTERMN EQU   OBRSEEK+2                                                05341000
OBR34CT1 EQU   OBRTERMN+4                                               05342000
OBR34CT2 EQU   OBRTERMN+5                                               05343000
SFTREC   EQU   0                                                        05344000
SFTHEAD  EQU   SFTREC                                                   05345000
SFTKEY   EQU   SFTHEAD                                                  05346000
SFTKEY1  EQU   SFTKEY                                                   05347000
SFTCPUID EQU   SFTHEAD+16                                               05348000
SFTSDWA  EQU   SFTREC+32                                                05349000
SFTAEC1  EQU   SFTSDWA+96                                               05350000
SFTFLGS  EQU   SFTSDWA+232                                              05351000
SFTRECP  EQU   SFTSDWA+292                                              05352000
IPLREC   EQU   0                                                        05353000
IPLHEAD  EQU   IPLREC                                                   05354000
IPLKEY   EQU   IPLHEAD                                                  05355000
IPLCPUID EQU   IPLHEAD+16                                               05356000
IPLSTIME EQU   IPLREC+52                                                05357000
DDRREC   EQU   0                                                        05358000
DDRHEAD  EQU   DDRREC                                                   05359000
DDRKEY   EQU   DDRHEAD                                                  05360000
DDRSMS   EQU   DDRHEAD+2                                                05361000
DDRCPUID EQU   DDRHEAD+16                                               05362000
@NM00052 EQU   DDRREC+24                                                05363000
DDRFDEV  EQU   DDRREC+48                                                05364000
DDRCODE2 EQU   DDRFDEV+2                                                05365000
DDRTODEV EQU   DDRREC+56                                                05366000
MIHREC   EQU   0                                                        05367000
MIHHEAD  EQU   MIHREC                                                   05368000
MIHKEY   EQU   MIHHEAD                                                  05369000
@NM00054 EQU   MIHHEAD+4                                                05370000
MIHCPUID EQU   MIHHEAD+16                                               05371000
@NM00057 EQU   MIHREC+24                                                05372000
MIHDEV   EQU   MIHREC+44                                                05373000
MIHCODE2 EQU   MIHDEV+2                                                 05374000
EODREC   EQU   0                                                        05375000
EODHEAD  EQU   EODREC                                                   05376000
EODKEY   EQU   EODHEAD                                                  05377000
EODCPUID EQU   EODHEAD+16                                               05378000
TPRREC   EQU   0                                                        05379000
TPRHEAD  EQU   TPRREC                                                   05380000
TPRKEY   EQU   TPRHEAD                                                  05381000
TPRDEV   EQU   TPRHEAD+4                                                05382000
TPRBUFC  EQU   TPRHEAD+5                                                05383000
TPRCPUID EQU   TPRHEAD+16                                               05384000
TPRCUA   EQU   TPRREC+24                                                05385000
@NM00065 EQU   TPRREC+26                                                05386000
TPRVOL   EQU   @NM00065                                                 05387000
TPRMODE  EQU   TPRREC+38                                                05388000
DVBSDRE  EQU   TPRREC+56                                                05389000
RMSSCBRY EQU   TPRREC+58                                                05390000
MCFREC   EQU   0                                                        05391000
MCFHEAD  EQU   MCFREC                                                   05392000
MCFKEY   EQU   MCFHEAD                                                  05393000
MCFSMS   EQU   MCFHEAD+2                                                05394000
@NM00073 EQU   MCFHEAD+16                                               05395000
MCFSMO   EQU   MCFHEAD+17                                               05396000
CCFREC   EQU   0                                                        05397000
CCFHEAD  EQU   CCFREC                                                   05398000
CCFKEY   EQU   CCFHEAD                                                  05399000
CCFSMS   EQU   CCFHEAD+2                                                05400000
@NM00081 EQU   CCFHEAD+16                                               05401000
CCFSMO   EQU   CCFHEAD+17                                               05402000
STSUMONE EQU   0                                                        05403000
STSUMIPL EQU   STSUMONE+4                                               05404000
STSUMMCR EQU   STSUMONE+12                                              05405000
STSUMMCN EQU   STSUMONE+16                                              05406000
STSUMCH  EQU   STSUMONE+20                                              05407000
STSUMPEI EQU   STSUMONE+84                                              05408000
STSUMPEA EQU   STSUMONE+88                                              05409000
STSUMPER EQU   STSUMONE+92                                              05410000
STSUMEOD EQU   STSUMONE+96                                              05411000
OBRLSDR  EQU   0                                                        05412000
OBRSENSE EQU   0                                                        05413000
OBRSENS0 EQU   OBRSENSE                                                 05414000
OBRSENS1 EQU   OBRSENSE+1                                               05415000
TPRTEMP  EQU   0                                                        05416000
TPRTMPR  EQU   TPRTEMP                                                  05417000
TPRTMPW  EQU   TPRTEMP+1                                                05418000
@NM00094 EQU   0                                                        05419000
BYT1112  EQU   @NM00094                                                 05420000
BYTE13   EQU   @NM00094+2                                               05421000
BYTE18   EQU   @NM00094+7                                               05422000
BYTE21   EQU   @NM00094+10                                              05423000
TPRSENSE EQU   0                                                        05424000
TPRS1213 EQU   TPRSENSE                                                 05425000
TPRS1415 EQU   TPRSENSE+2                                               05426000
TPRS19   EQU   TPRSENSE+7                                               05427000
FRAMETAB EQU   0                                                        05428000
FRAMENUM EQU   FRAMETAB                                                 05429000
FRAMEDTA EQU   FRAMETAB+4                                               05430000
FRAMEKEY EQU   FRAMEDTA                                                 05431000
FRAMECPU EQU   FRAMEKEY                                                 05432000
FRAMESER EQU   FRAMECPU                                                 05433000
FRAMEMOD EQU   FRAMECPU+3                                               05434000
FRAMEDT  EQU   FRAMEKEY+5                                               05435000
FRAMETYP EQU   FRAMEKEY+13                                              05436000
FRAMLOCM EQU   FRAMEDTA+16                                              05437000
FRAMLOCC EQU   FRAMEDTA+20                                              05438000
LISTLOC  EQU   0                                                        05439000
LISTNUM  EQU   LISTLOC                                                  05440000
LISTCCHR EQU   LISTLOC+4                                                05441000
NEXTBYTE EQU   0                                                        05442000
ADDNUM   EQU   0                                                        05443000
TMPA     EQU   0                                                        05444000
TMPKEYA  EQU   TMPA                                                     05445000
TMPPERMA EQU   TMPA+8                                                   05446000
TMPTEMPA EQU   TMPA+10                                                  05447000
WORKCHAN EQU   CCHCUA                                                   05448000
FLIPFLOP EQU   FLIP                                                     05449000
EDFLD    EQU   EDIFILD                                                  05450000
ERRCT1   EQU   DVBSDRE                                                  05451000
ERRNUM   EQU   ERRPLACE                                                 05452000
ERR78    EQU   PRINTBDY                                                 05453000
PFRAMMOD EQU   ERR78+27                                                 05454000
PFRAMSER EQU   ERR78+32                                                 05455000
WORKNM   EQU   WORKBYTE                                                 05456000
WORKNM2  EQU   WORKTWO                                                  05457000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    05458000
@NM00090 EQU   ERR78+31                                                 05459000
@NM00089 EQU   ERR78                                                    05460000
FRAMETIM EQU   FRAMEDT+4                                                05461000
FRAMEDAT EQU   FRAMEDT                                                  05462000
@NM00097 EQU   TPRSENSE+4                                               05463000
@NM00096 EQU   @NM00094+8                                               05464000
@NM00095 EQU   @NM00094+3                                               05465000
OBRLSDR2 EQU   OBRLSDR                                                  05466000
OBRLSDR1 EQU   OBRLSDR                                                  05467000
STSUMNXT EQU   STSUMONE+8                                               05468000
STSUMNUM EQU   STSUMONE                                                 05469000
CCFFRAME EQU   CCFREC+24                                                05470000
@NM00083 EQU   CCFHEAD+22                                               05471000
CCFMOD   EQU   CCFSMO+3                                                 05472000
CCFSER   EQU   CCFSMO                                                   05473000
CCFVER   EQU   @NM00081                                                 05474000
@NM00082 EQU   @NM00081                                                 05475000
CCFTIMD  EQU   CCFHEAD+12                                               05476000
CCFDAT   EQU   CCFHEAD+8                                                05477000
@NM00080 EQU   CCFHEAD+7                                                05478000
CCFCNT   EQU   CCFHEAD+6                                                05479000
@NM00079 EQU   CCFHEAD+4                                                05480000
@NM00078 EQU   CCFSMS+1                                                 05481000
CCFCPU   EQU   CCFSMS+1                                                 05482000
CCFMP    EQU   CCFSMS+1                                                 05483000
@NM00077 EQU   CCFSMS                                                   05484000
CCFTIM   EQU   CCFSMS                                                   05485000
@NM00076 EQU   CCFSMS                                                   05486000
CCFTRU   EQU   CCFSMS                                                   05487000
CCFTOD   EQU   CCFSMS                                                   05488000
CCFLST   EQU   CCFSMS                                                   05489000
CCFKEY2  EQU   CCFKEY+1                                                 05490000
CCFKEY1  EQU   CCFKEY                                                   05491000
MCFFRAME EQU   MCFREC+24                                                05492000
@NM00075 EQU   MCFHEAD+22                                               05493000
MCFMOD   EQU   MCFSMO+3                                                 05494000
MCFSER   EQU   MCFSMO                                                   05495000
MCFVER   EQU   @NM00073                                                 05496000
@NM00074 EQU   @NM00073                                                 05497000
MCFTIMD  EQU   MCFHEAD+12                                               05498000
MCFDAT   EQU   MCFHEAD+8                                                05499000
@NM00072 EQU   MCFHEAD+7                                                05500000
MCFCNT   EQU   MCFHEAD+6                                                05501000
@NM00071 EQU   MCFHEAD+4                                                05502000
@NM00070 EQU   MCFSMS+1                                                 05503000
MCFCPU   EQU   MCFSMS+1                                                 05504000
MCFMP    EQU   MCFSMS+1                                                 05505000
@NM00069 EQU   MCFSMS                                                   05506000
MCFTIM   EQU   MCFSMS                                                   05507000
@NM00068 EQU   MCFSMS                                                   05508000
MCFTRU   EQU   MCFSMS                                                   05509000
MCFTOD   EQU   MCFSMS                                                   05510000
MCFLST   EQU   MCFSMS                                                   05511000
MCFKEY2  EQU   MCFKEY+1                                                 05512000
MCFKEY1  EQU   MCFKEY                                                   05513000
@NM00067 EQU   TPRREC+39                                                05514000
TPRLINAD EQU   TPRREC+36                                                05515000
@NM00066 EQU   TPRREC+34                                                05516000
TPRCEL   EQU   TPRCPUID+6                                               05517000
TPRMODEL EQU   TPRCPUID+4                                               05518000
TPRSER   EQU   TPRCPUID+1                                               05519000
@NM00064 EQU   TPRCPUID                                                 05520000
TPRTIME  EQU   TPRHEAD+12                                               05521000
TPRDATE  EQU   TPRHEAD+8                                                05522000
@NM00063 EQU   TPRHEAD+6                                                05523000
TPRLENGT EQU   TPRBUFC                                                  05524000
@NM00062 EQU   TPRBUFC                                                  05525000
TPRSMS   EQU   TPRHEAD+2                                                05526000
TPRKEY2  EQU   TPRKEY+1                                                 05527000
TPRKEY1  EQU   TPRKEY                                                   05528000
EODCEL   EQU   EODCPUID+6                                               05529000
EODMODEL EQU   EODCPUID+4                                               05530000
EODSER   EQU   EODCPUID+1                                               05531000
@NM00061 EQU   EODCPUID                                                 05532000
EODTIME  EQU   EODHEAD+12                                               05533000
EODDATE  EQU   EODHEAD+8                                                05534000
@NM00060 EQU   EODHEAD+5                                                05535000
EODDEV   EQU   EODHEAD+4                                                05536000
EODSMS   EQU   EODHEAD+2                                                05537000
EODKEY2  EQU   EODKEY+1                                                 05538000
EODKEY1  EQU   EODKEY                                                   05539000
MIHTYPE  EQU   MIHCODE2+1                                               05540000
MIHCLASS EQU   MIHCODE2                                                 05541000
@NM00059 EQU   MIHDEV                                                   05542000
MIHVOL   EQU   MIHREC+38                                                05543000
MIHCUA   EQU   MIHREC+35                                                05544000
@NM00058 EQU   @NM00057+8                                               05545000
MIHJOBID EQU   @NM00057                                                 05546000
MIHCEL   EQU   MIHCPUID+6                                               05547000
MIHMOD   EQU   MIHCPUID+4                                               05548000
MIHSER   EQU   MIHCPUID+1                                               05549000
@NM00056 EQU   MIHCPUID                                                 05550000
MIHTIME  EQU   MIHHEAD+12                                               05551000
MIHDATE  EQU   MIHHEAD+8                                                05552000
@NM00055 EQU   MIHHEAD+6                                                05553000
MIHCSID  EQU   MIHHEAD+5                                                05554000
MIHDEBIT EQU   @NM00054                                                 05555000
MIHCEBIT EQU   @NM00054                                                 05556000
MIHSMS   EQU   MIHHEAD+2                                                05557000
MIHKEY2  EQU   MIHKEY+1                                                 05558000
MIHKEY1  EQU   MIHKEY                                                   05559000
DDRDEV2  EQU   DDRTODEV+2                                               05560000
DDRDEV1  EQU   DDRTODEV                                                 05561000
DDRTOCUA EQU   DDRREC+53                                                05562000
@NM00053 EQU   DDRREC+52                                                05563000
DDRTYPE  EQU   DDRCODE2+1                                               05564000
DDRCLASS EQU   DDRCODE2                                                 05565000
DDRCODE1 EQU   DDRFDEV                                                  05566000
DDRFCUA  EQU   DDRREC+45                                                05567000
DDRPHD   EQU   @NM00052+20                                              05568000
DDRVOL2  EQU   @NM00052+14                                              05569000
DDRVOL1  EQU   @NM00052+8                                               05570000
DDRJOBID EQU   @NM00052                                                 05571000
DDRCEL   EQU   DDRCPUID+6                                               05572000
DDRMOD   EQU   DDRCPUID+4                                               05573000
DDRSER   EQU   DDRCPUID+1                                               05574000
@NM00051 EQU   DDRCPUID                                                 05575000
DDRTIME  EQU   DDRHEAD+12                                               05576000
DDRDATE  EQU   DDRHEAD+8                                                05577000
@NM00050 EQU   DDRHEAD+4                                                05578000
DDRDEPSW EQU   DDRSMS+1                                                 05579000
@NM00049 EQU   DDRSMS                                                   05580000
DDRKEY2  EQU   DDRKEY+1                                                 05581000
DDRKEY1  EQU   DDRKEY                                                   05582000
IPLSHSEC EQU   IPLSTIME+3                                               05583000
IPLSSEC  EQU   IPLSTIME+2                                               05584000
IPLSMIN  EQU   IPLSTIME+1                                               05585000
IPLSHOUR EQU   IPLSTIME                                                 05586000
IPLSDATE EQU   IPLREC+48                                                05587000
IPLTEMP  EQU   IPLREC+46                                                05588000
IPLHIGH  EQU   IPLREC+42                                                05589000
IPLCHAN  EQU   IPLREC+32                                                05590000
@NM00048 EQU   IPLREC+30                                                05591000
IPLREAS  EQU   IPLREC+28                                                05592000
@NM00047 EQU   IPLREC+25                                                05593000
IPLSYSID EQU   IPLREC+24                                                05594000
IPLCEL   EQU   IPLCPUID+6                                               05595000
IPLMOD   EQU   IPLCPUID+4                                               05596000
IPLSER   EQU   IPLCPUID+1                                               05597000
@NM00046 EQU   IPLCPUID                                                 05598000
IPLTIME  EQU   IPLHEAD+12                                               05599000
IPLDATE  EQU   IPLHEAD+8                                                05600000
@NM00045 EQU   IPLHEAD+4                                                05601000
IPLSMS   EQU   IPLHEAD+2                                                05602000
IPLKEY2  EQU   IPLKEY+1                                                 05603000
IPLKEY1  EQU   IPLKEY                                                   05604000
SFTXDATA EQU   SFTREC+434                                               05605000
SFTLVARA EQU   SFTREC+432                                               05606000
SFTREXN  EQU   SFTRECP+16                                               05607000
SFTCSECT EQU   SFTRECP+8                                                05608000
SFTMODN  EQU   SFTRECP                                                  05609000
@NM00044 EQU   SFTSDWA+238                                              05610000
SFTLCPUA EQU   SFTSDWA+236                                              05611000
SFTERRD  EQU   SFTFLGS+3                                                05612000
SFTERRC  EQU   SFTFLGS+2                                                05613000
SFTERRB  EQU   SFTFLGS+1                                                05614000
SFTERRA  EQU   SFTFLGS                                                  05615000
@NM00043 EQU   SFTSDWA+136                                              05616000
SFTAAEC1 EQU   SFTSDWA+120                                              05617000
@NM00042 EQU   SFTSDWA+112                                              05618000
SFTPROGC EQU   SFTAEC1+8                                                05619000
@NM00041 EQU   SFTAEC1                                                  05620000
@NM00040 EQU   SFTSDWA+88                                               05621000
SFTGRSV  EQU   SFTSDWA+24                                               05622000
SFTABNDC EQU   SFTSDWA                                                  05623000
SFTJOBID EQU   SFTREC+24                                                05624000
SFTCEL   EQU   SFTCPUID+6                                               05625000
SFTMOD   EQU   SFTCPUID+4                                               05626000
SFTSER   EQU   SFTCPUID+1                                               05627000
@NM00039 EQU   SFTCPUID                                                 05628000
SFTTIME  EQU   SFTHEAD+12                                               05629000
SFTDATE  EQU   SFTHEAD+8                                                05630000
@NM00038 EQU   SFTHEAD+4                                                05631000
SFTSMS   EQU   SFTHEAD+2                                                05632000
SFTKEY2  EQU   SFTKEY+1                                                 05633000
@NM00037 EQU   OBRTERMN                                                 05634000
@NM00036 EQU   OBRSEEK+1                                                05635000
OBRTCAM  EQU   OBRSEEK                                                  05636000
OBRVOL   EQU   OBRREC+64                                                05637000
OBRSBCNT EQU   OBRREC+62                                                05638000
OBRRETRY EQU   OBRREC+60                                                05639000
OBRTYPE  EQU   OBRDEV+1                                                 05640000
OBRCODE1 EQU   OBRCODE                                                  05641000
OBRSECUA EQU   OBRREC+49                                                05642000
OBRSTAT  EQU   OBRCSW+4                                                 05643000
@NM00035 EQU   OBRCSW                                                   05644000
OBRSDRS2 EQU   OBRSRDS                                                  05645000
OBRSDRS1 EQU   OBRSRDS                                                  05646000
OBRSDEV1 EQU   OBRJOBID                                                 05647000
OBRCEL   EQU   OBRCPUID+6                                               05648000
OBRMOD   EQU   OBRCPUID+4                                               05649000
OBRSER   EQU   OBRCPUID+1                                               05650000
@NM00034 EQU   OBRCPUID                                                 05651000
OBRTIME  EQU   OBRHEAD+12                                               05652000
OBRDATE  EQU   OBRHEAD+8                                                05653000
@NM00033 EQU   OBRHEAD+4                                                05654000
@NM00032 EQU   OBRSUBTP                                                 05655000
@NM00031 EQU   OBRSUBTP                                                 05656000
@NM00030 EQU   MISCSW                                                   05657000
TRUNC    EQU   MISCSW                                                   05658000
@NM00029 EQU   MISCSW                                                   05659000
OBRKEY2  EQU   OBRKEY+1                                                 05660000
OBRKEY1  EQU   OBRKEY                                                   05661000
CCHLOG   EQU   CCHREC+80                                                05662000
CCHMP    EQU   CCHREC+76                                                05663000
@NM00028 EQU   CCHREC+73                                                05664000
CCHID    EQU   CCHREC+72                                                05665000
CCHTYPE  EQU   CCHCODE2+1                                               05666000
CCHCLASS EQU   CCHCODE2                                                 05667000
CCHCODE1 EQU   CCHCODE                                                  05668000
CCHECSW  EQU   CCHREC+64                                                05669000
CCHCSW   EQU   CCHREC+56                                                05670000
CCHFCCW  EQU   CCHREC+48                                                05671000
CCHATIO  EQU   CCHREC+32                                                05672000
CCHJOBID EQU   CCHREC+24                                                05673000
CCHCEL   EQU   CCHCPUID+6                                               05674000
CCHMOD   EQU   CCHCPUID+4                                               05675000
CCHSER   EQU   CCHCPUID+1                                               05676000
@NM00027 EQU   CCHCPUID                                                 05677000
CCHTIME  EQU   CCHHEAD+12                                               05678000
CCHDATE  EQU   CCHHEAD+8                                                05679000
@NM00026 EQU   CCHHEAD+4                                                05680000
CCHRINC  EQU   CCHSMS+1                                                 05681000
@NM00025 EQU   CCHSMS                                                   05682000
CCHRCRH  EQU   CCHSMS                                                   05683000
@NM00024 EQU   CCHSMS                                                   05684000
CCHKEY2  EQU   CCHKEY+1                                                 05685000
CCHKEY1  EQU   CCHKEY                                                   05686000
MCHLOG   EQU   MCHREC+48                                                05687000
MCHOPSW  EQU   MCHREC+40                                                05688000
MCHJOBID EQU   MCHREC+32                                                05689000
MCHPGMID EQU   MCHREC+24                                                05690000
MCHCEL   EQU   MCHCPUID+6                                               05691000
MCHMOD   EQU   MCHCPUID+4                                               05692000
MCHSER   EQU   MCHCPUID+1                                               05693000
@NM00023 EQU   MCHCPUID                                                 05694000
MCHTIME  EQU   MCHHEAD+12                                               05695000
MCHDATE  EQU   MCHHEAD+8                                                05696000
@NM00022 EQU   MCHHEAD+4                                                05697000
@NM00021 EQU   MCHSMS                                                   05698000
MCHKEY2  EQU   MCHKEY+1                                                 05699000
MCHKEY1  EQU   MCHKEY                                                   05700000
LRTMCEL  EQU   LRTCPU+6                                                 05701000
@NM00020 EQU   LRTCPU                                                   05702000
LRTHSECS EQU   LRTTIME+3                                                05703000
LRTSEC   EQU   LRTTIME+2                                                05704000
LRTMIN   EQU   LRTTIME+1                                                05705000
LRTHOUR  EQU   LRTTIME                                                  05706000
LRTDAY   EQU   LRTYRDAY+1                                               05707000
LRTYEAR  EQU   LRTYRDAY                                                 05708000
LRTDATE0 EQU   LRTDATE                                                  05709000
@NM00019 EQU   @NM00017+3                                               05710000
@NM00018 EQU   @NM00017                                                 05711000
LRTDSMNT EQU   LRTERRID                                                 05712000
@NM00016 EQU   LRTERRID                                                 05713000
LRTSHRT  EQU   LRTERRID                                                 05714000
@NM00015 EQU   LRTERRID                                                 05715000
@NM00014 EQU   LRTSMS                                                   05716000
LRTIMCNV EQU   LRTSMS                                                   05717000
@NM00013 EQU   LRTSMS                                                   05718000
LRNS     EQU   LRTSMS                                                   05719000
LRTKEY2  EQU   LRTKEY+1                                                 05720000
TMPTEMP  EQU   TMP2+10                                                  05721000
TMPPERM  EQU   TMPPERM1+1                                               05722000
@NM00012 EQU   TMPPERM1                                                 05723000
TMPRANGE EQU   TMP2+7                                                   05724000
TMPDEV   EQU   TMPKEY+5                                                 05725000
TMPOLDA  EQU   TMPITEM                                                  05726000
TMP3705  EQU   TMPITEM                                                  05727000
TMPOLD   EQU   TMPCPUS                                                  05728000
TMPCPU   EQU   TMPCPUS                                                  05729000
TMPCUA   EQU   TMPSRT                                                   05730000
TMPGROUP EQU   TMPKEY                                                   05731000
TMTTEMP  EQU   TMT2+10                                                  05732000
TMTPERM  EQU   TMTPERM1+1                                               05733000
@NM00011 EQU   TMTPERM1                                                 05734000
TMTDEV   EQU   TMTKEY+6                                                 05735000
TMTDAT   EQU   TMTKEY+5                                                 05736000
TMTOLDA  EQU   TMTITEM                                                  05737000
TMT3705  EQU   TMTITEM                                                  05738000
TMTOLD   EQU   TMTCPUS                                                  05739000
TMTCPU   EQU   TMTCPUS                                                  05740000
TMTCUA   EQU   TMTSRT                                                   05741000
TMTGROUP EQU   TMTKEY                                                   05742000
SYMVAL2  EQU   SYMVAL+2                                                 05743000
SYMVAL1  EQU   SYMVAL                                                   05744000
SYMCDNUM EQU   SYMCODE                                                  05745000
LIBVAL   EQU   LIBADR+2                                                 05746000
LIBADNUM EQU   LIBADR                                                   05747000
CPUCUX3  EQU   CPUCUAV+5                                                05748000
CPUCUX2  EQU   CPUCUAV+3                                                05749000
CPUCUX1  EQU   CPUCUAV                                                  05750000
CPCUANUM EQU   CPUCUAS                                                  05751000
VOLVAL   EQU   VOLUME+2                                                 05752000
VOLNUM   EQU   VOLUME                                                   05753000
SERVAL   EQU   DEVSERAL+2                                               05754000
SERNUM   EQU   DEVSERAL                                                 05755000
MODVAL   EQU   MODELS+2                                                 05756000
MODNUM   EQU   MODELS                                                   05757000
LOADPTR  EQU   EDITABLE+8                                               05758000
LOADNAME EQU   EDITABLE                                                 05759000
EDITNUM  EQU   EDITLOAD                                                 05760000
SORTCORE EQU   SORTCCHR                                                 05761000
SORTTIME EQU   SORTKEY+1                                                05762000
SORTYEAR EQU   SORTKEY                                                  05763000
EVDAY    EQU   EVSTOP+1                                                 05764000
EVYEAR   EQU   EVSTOP                                                   05765000
TREPRE   EQU   TREGEN+72                                                05766000
TRECCHF  EQU   TREGEN+68                                                05767000
TRECCHE  EQU   TREGEN+64                                                05768000
TRECCHD  EQU   TREGEN+60                                                05769000
TRECCHC  EQU   TREGEN+56                                                05770000
TRECCHB  EQU   TREGEN+52                                                05771000
TRECCHA  EQU   TREGEN+48                                                05772000
TRECCH9  EQU   TREGEN+44                                                05773000
TRECCH8  EQU   TREGEN+40                                                05774000
TRECCH7  EQU   TREGEN+36                                                05775000
TRECCH6  EQU   TREGEN+32                                                05776000
TRECCH5  EQU   TREGEN+28                                                05777000
TRECCH4  EQU   TREGEN+24                                                05778000
TRECCH3  EQU   TREGEN+20                                                05779000
TRECCH2  EQU   TREGEN+16                                                05780000
TRECCH1  EQU   TREGEN+12                                                05781000
TRECCH0  EQU   TREGEN+8                                                 05782000
TREMCH   EQU   TREGEN+4                                                 05783000
TREIPL   EQU   TREGEN                                                   05784000
TRENUM   EQU   TRENDONE+4                                               05785000
TRENEXT  EQU   TRENDONE                                                 05786000
DUMPSIZE EQU   DUMPINFO+4                                               05787000
DUMPADR  EQU   DUMPINFO                                                 05788000
DUMPNUM  EQU   DUMPTABL                                                 05789000
@NM00010 EQU   PARM+212                                                 05790000
RECLNGT1 EQU   PARM+204                                                 05791000
ADCPUT   EQU   PARM+144                                                 05792000
LINECT   EQU   PARM+120                                                 05793000
RECLNGTH EQU   CCHHRLNG+6                                               05794000
@NM00009 EQU   CCHHRLNG+5                                               05795000
USERPGM  EQU   PARM+102                                                 05796000
IDTSEC   EQU   IDTIME+3                                                 05797000
IDSEC    EQU   IDTIME+2                                                 05798000
IDMIN    EQU   IDTIME+1                                                 05799000
IDHOUR   EQU   IDTIME                                                   05800000
IDASID   EQU   ERRID+4                                                  05801000
IDCPU    EQU   ERRID+3                                                  05802000
@NM00008 EQU   ERRID+2                                                  05803000
IDVALUE  EQU   ERRID                                                    05804000
NUMDAYS  EQU   PARM+88                                                  05805000
SYSRETRN EQU   @NM00007                                                 05806000
NUMIN222 EQU   @NM00006                                                 05807000
WRTHRSH  EQU   PARM+69                                                  05808000
RDTHRSH  EQU   PARM+66                                                  05809000
TERM     EQU   PARM+58                                                  05810000
EVSDAY   EQU   STRTDATE+1                                               05811000
EVSYEAR  EQU   STRTDATE                                                 05812000
PENSEC2  EQU   ENDTIME2+2                                               05813000
PENMIN2  EQU   ENDTIME2+1                                               05814000
PENHOUR2 EQU   ENDTIME2                                                 05815000
PSTSEC2  EQU   STTIME2+2                                                05816000
PSTMIN2  EQU   STTIME2+1                                                05817000
PSTHOUR2 EQU   STTIME2                                                  05818000
PENSEC1  EQU   ENDTIME1+2                                               05819000
PENMIN1  EQU   ENDTIME1+1                                               05820000
PENHOUR1 EQU   ENDTIME1                                                 05821000
PSTSEC1  EQU   STTIME1+2                                                05822000
PSTMIN1  EQU   STTIME1+1                                                05823000
PSTHOUR1 EQU   STTIME1                                                  05824000
@NM00005 EQU   ENDDT+4                                                  05825000
PENDY    EQU   PEND+1                                                   05826000
PENYR    EQU   PEND                                                     05827000
@NM00004 EQU   ENDDATE                                                  05828000
@NM00003 EQU   STDT+4                                                   05829000
PSTDY    EQU   PSTD+1                                                   05830000
PSTYR    EQU   PSTD                                                     05831000
@NM00002 EQU   STDATE                                                   05832000
YEARNOW  EQU   DATENOW+4                                                05833000
@NM00001 EQU   DATENOW+3                                                05834000
DAYNOW   EQU   DATENOW                                                  05835000
CSNAP    EQU   CLOSEIO                                                  05836000
CSYSIN   EQU   CLOSEIO                                                  05837000
CACCDEV  EQU   CLOSEIO                                                  05838000
CSERLOG  EQU   CLOSEIO                                                  05839000
CEREPPT  EQU   CLOSEIO                                                  05840000
CTOURIST EQU   CLOSEIO                                                  05841000
OSNAP    EQU   OPENIO                                                   05842000
ODRCTWRK EQU   OPENIO                                                   05843000
OSYSIN   EQU   OPENIO                                                   05844000
OACCDEV  EQU   OPENIO                                                   05845000
OACCIN   EQU   OPENIO                                                   05846000
OSERLOG  EQU   OPENIO                                                   05847000
OEREPPT  EQU   OPENIO                                                   05848000
OTOURIST EQU   OPENIO                                                   05849000
PLOGREC  EQU   MISC                                                     05850000
ERRORID  EQU   MISC                                                     05851000
PSUM     EQU   PRINTES                                                  05852000
PEDIT    EQU   PRINTES                                                  05853000
PZERO    EQU   MISC                                                     05854000
DEBUG63  EQU   DEBUGA+3                                                 05855000
DEBUG62  EQU   DEBUGA+3                                                 05856000
DEBUG61  EQU   DEBUGA+3                                                 05857000
DEBUG60  EQU   DEBUGA+3                                                 05858000
DEBUG59  EQU   DEBUGA+3                                                 05859000
DEBUG58  EQU   DEBUGA+3                                                 05860000
DEBUG57  EQU   DEBUGA+3                                                 05861000
DEBUG56  EQU   DEBUGA+3                                                 05862000
DEBUG55  EQU   DEBUGA+2                                                 05863000
DEBUG54  EQU   DEBUGA+2                                                 05864000
DEBUG53  EQU   DEBUGA+2                                                 05865000
DEBUG52  EQU   DEBUGA+2                                                 05866000
DEBUG51  EQU   DEBUGA+2                                                 05867000
DEBUG49  EQU   DEBUGA+2                                                 05868000
DEBUG48  EQU   DEBUGA+2                                                 05869000
DEBUG47  EQU   DEBUGA+1                                                 05870000
DEBUG46  EQU   DEBUGA+1                                                 05871000
DEBUG45  EQU   DEBUGA+1                                                 05872000
DEBUG44  EQU   DEBUGA+1                                                 05873000
DEBUG43  EQU   DEBUGA+1                                                 05874000
DEBUG42  EQU   DEBUGA+1                                                 05875000
DEBUG41  EQU   DEBUGA+1                                                 05876000
DEBUG40  EQU   DEBUGA+1                                                 05877000
DEBUG39  EQU   DEBUGA                                                   05878000
DEBUG38  EQU   DEBUGA                                                   05879000
DEBUG37  EQU   DEBUGA                                                   05880000
DEBUG36  EQU   DEBUGA                                                   05881000
DEBUG35  EQU   DEBUGA                                                   05882000
DEBUG34  EQU   DEBUGA                                                   05883000
DEBUG33  EQU   DEBUGA                                                   05884000
DEBUG32  EQU   DEBUGA                                                   05885000
DEBUG31  EQU   DEBUG+3                                                  05886000
DEBUG30  EQU   DEBUG+3                                                  05887000
DEBUG29  EQU   DEBUG+3                                                  05888000
DEBUG28  EQU   DEBUG+3                                                  05889000
DEBUG27  EQU   DEBUG+3                                                  05890000
DEBUG26  EQU   DEBUG+3                                                  05891000
DEBUG25  EQU   DEBUG+3                                                  05892000
DEBUG24  EQU   DEBUG+3                                                  05893000
DEBUG22  EQU   DEBUG+2                                                  05894000
DEBUG21  EQU   DEBUG+2                                                  05895000
DEBUG20  EQU   DEBUG+2                                                  05896000
DEBUG19  EQU   DEBUG+2                                                  05897000
DEBUG18  EQU   DEBUG+2                                                  05898000
DEBUG17  EQU   DEBUG+2                                                  05899000
DEBUG15  EQU   DEBUG+1                                                  05900000
DEBUG14  EQU   DEBUG+1                                                  05901000
DEBUG13  EQU   DEBUG+1                                                  05902000
DEBUG12  EQU   DEBUG+1                                                  05903000
DEBUG10  EQU   DEBUG+1                                                  05904000
DEBUG9   EQU   DEBUG+1                                                  05905000
DEBUG8   EQU   DEBUG+1                                                  05906000
DEBUG7   EQU   DEBUG                                                    05907000
DEBUG6   EQU   DEBUG                                                    05908000
DEBUG5   EQU   DEBUG                                                    05909000
DEBUG3   EQU   DEBUG                                                    05910000
DEBUG2   EQU   DEBUG                                                    05911000
DEBUG1   EQU   DEBUG                                                    05912000
DEBUG0   EQU   DEBUG                                                    05913000
SORTBRK  EQU   SWITCHES+1                                               05914000
COREFAIL EQU   SWITCHES+1                                               05915000
ANALYSIS EQU   SWITCHES+1                                               05916000
NOTALL   EQU   SWITCHES+1                                               05917000
NOSDR    EQU   SWITCHES                                                 05918000
TIMESEQ  EQU   SWITCHES                                                 05919000
SYSUM    EQU   SWITCHES                                                 05920000
PARMTHR  EQU   SWITCHES                                                 05921000
TREND    EQU   SWITCHES                                                 05922000
SHORTOBR EQU   SWITCHES                                                 05923000
PARMMES  EQU   SWITCHES                                                 05924000
RDESUM   EQU   SWITCHES                                                 05925000
PCCHFRAM EQU   RECTYPE+1                                                05926000
PMCHFRAM EQU   RECTYPE+1                                                05927000
PTTYP    EQU   RECTYPE+1                                                05928000
PEOD     EQU   RECTYPE                                                  05929000
PMIH     EQU   RECTYPE                                                  05930000
PDDR     EQU   RECTYPE                                                  05931000
PIPL     EQU   RECTYPE                                                  05932000
PSOFT    EQU   RECTYPE                                                  05933000
POBR     EQU   RECTYPE                                                  05934000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      05935000
@RF00406 EQU   @EL00005                                                 05936000
@RC00415 EQU   @RC00413                                                 05937000
@RF00432 EQU   @RC00413                                                 05938000
@RF00456 EQU   @EL00006                                                 05939000
@RC00479 EQU   @RC00474                                                 05940000
@RC00591 EQU   @EL00011                                                 05941000
@RC00594 EQU   @EL00011                                                 05942000
@RC00597 EQU   @EL00011                                                 05943000
@RC00603 EQU   @EL00011                                                 05944000
@RC00610 EQU   @EL00011                                                 05945000
@RC00628 EQU   @EL00011                                                 05946000
@RC00635 EQU   @EL00011                                                 05947000
@RF00650 EQU   @EL00012                                                 05948000
@RF00656 EQU   @EL00012                                                 05949000
@RC00658 EQU   @EL00012                                                 05950000
@RC00661 EQU   @EL00012                                                 05951000
@RC00684 EQU   @EL00012                                                 05952000
@RC00665 EQU   @EL00012                                                 05953000
@RF00727 EQU   @EL00013                                                 05954000
@RF00759 EQU   @RC00757                                                 05955000
@RF00774 EQU   @RC00772                                                 05956000
@RF00793 EQU   @EL00014                                                 05957000
@RF00805 EQU   @EL00015                                                 05958000
@RF00817 EQU   @EL00016                                                 05959000
@RF00829 EQU   @EL00017                                                 05960000
@RC00833 EQU   @EL00018                                                 05961000
@RC00839 EQU   @EL00018                                                 05962000
@RC00845 EQU   @EL00018                                                 05963000
@RC00851 EQU   @EL00018                                                 05964000
@RC00857 EQU   @EL00018                                                 05965000
@RF00863 EQU   @EL00018                                                 05966000
@RF00877 EQU   @EL00019                                                 05967000
@RC00875 EQU   @EL00019                                                 05968000
@RC00952 EQU   @EL00022                                                 05969000
@RF01002 EQU   @RC00993                                                 05970000
@RF01070 EQU   @EL00023                                                 05971000
@RF01074 EQU   @EL00023                                                 05972000
@RC01081 EQU   @EL00024                                                 05973000
@RF01136 EQU   @EL00025                                                 05974000
@RF01147 EQU   @EL00026                                                 05975000
@RC01160 EQU   @EL00027                                                 05976000
@RC01166 EQU   @EL00027                                                 05977000
@RF01172 EQU   @EL00027                                                 05978000
@RC01295 EQU   @RC01293                                                 05979000
@RF01313 EQU   @EL00031                                                 05980000
@RF01355 EQU   @RC01318                                                 05981000
@RF01391 EQU   @EL00033                                                 05982000
@RC01404 EQU   @EL00034                                                 05983000
@PB00034 EQU   @EL00001                                                 05984000
@RF00615 EQU   @RC00610                                                 05985000
@RF00670 EQU   @RC00665                                                 05986000
@RC01083 EQU   @RC01081                                                 05987000
@PB00033 EQU   @PB00034                                                 05988000
@RC01406 EQU   @RC01404                                                 05989000
@RC01418 EQU   @RC01404                                                 05990000
@RF01102 EQU   @RC01083                                                 05991000
@PB00032 EQU   @PB00033                                                 05992000
@RF01411 EQU   @RC01406                                                 05993000
@RC01421 EQU   @RC01418                                                 05994000
@PB00031 EQU   @PB00032                                                 05995000
@RF01425 EQU   @RC01421                                                 05996000
@RF01427 EQU   @RC01421                                                 05997000
@RC01429 EQU   @RC01421                                                 05998000
@RC01436 EQU   @RC01421                                                 05999000
@PB00030 EQU   @PB00031                                                 06000000
@PB00029 EQU   @PB00030                                                 06001000
@PB00028 EQU   @PB00029                                                 06002000
@PB00027 EQU   @PB00028                                                 06003000
@PB00026 EQU   @PB00027                                                 06004000
@PB00025 EQU   @PB00026                                                 06005000
@PB00024 EQU   @PB00025                                                 06006000
@PB00023 EQU   @PB00024                                                 06007000
@PB00022 EQU   @PB00023                                                 06008000
@PB00021 EQU   @PB00022                                                 06009000
@PB00020 EQU   @PB00021                                                 06010000
@PB00019 EQU   @PB00020                                                 06011000
@PB00018 EQU   @PB00019                                                 06012000
@PB00017 EQU   @PB00018                                                 06013000
@PB00016 EQU   @PB00017                                                 06014000
@PB00015 EQU   @PB00016                                                 06015000
@PB00014 EQU   @PB00015                                                 06016000
@PB00013 EQU   @PB00014                                                 06017000
@PB00012 EQU   @PB00013                                                 06018000
@PB00011 EQU   @PB00012                                                 06019000
@PB00010 EQU   @PB00011                                                 06020000
@PB00009 EQU   @PB00010                                                 06021000
@PB00008 EQU   @PB00009                                                 06022000
@PB00007 EQU   @PB00008                                                 06023000
@PB00006 EQU   @PB00007                                                 06024000
@PB00005 EQU   @PB00006                                                 06025000
@PB00004 EQU   @PB00005                                                 06026000
@PB00003 EQU   @PB00004                                                 06027000
@PB00002 EQU   @PB00003                                                 06028000
@RF00257 EQU   @PB00002                                                 06029000
@ENDDATA EQU   *                                                        06030000
         END   IFCFILT2                                                 06031000
