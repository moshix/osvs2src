         TITLE 'IFCFILT3-RECORD FILTER FOR TREND REPORT'                00001000
IFCFILT3 CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'IFCFILT3  79.011'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  ST    @14,12(,@13)                                        0001 00009000
         STM   @00,@12,20(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  LA    @11,4095(,@12)                                      0001 00012000
         LA    @10,4095(,@11)                                      0001 00013000
         LA    @09,4095(,@10)                                      0001 00014000
         LA    @08,4095(,@09)                                      0001 00015000
         USING @PSTART,@12                                         0001 00016000
         USING @PSTART+4095,@11                                    0001 00017000
         USING @PSTART+8190,@10                                    0001 00018000
         USING @PSTART+12285,@09                                   0001 00019000
         USING @PSTART+16380,@08                                   0001 00020000
         ST    @13,@SA00001+4                                      0001 00021000
         LA    @14,@SA00001                                        0001 00022000
         ST    @14,8(,@13)                                         0001 00023000
         LR    @13,@14                                             0001 00024000
*IF DEBUG4 = ON THEN                                               0194 00025000
         TM    DEBUG4(R2),B'00001000'                              0194 00026000
         BNO   @RF00194                                            0194 00027000
* DO;                                                      /*@Z427VLS*/ 00028000
*  R15 = R12 - 27;                                         /*@Z427VLS*/ 00029000
         LR    R15,R12                                             0196 00030000
         SL    R15,@CF01130                                        0196 00031000
*  GEN(MVC PRINTBDY(16),0(R15));                           /*@Z427VLS*/ 00032000
         MVC PRINTBDY(16),0(R15)                                        00033000
*  PRINTADR = ADDR(PRINTLIN);                              /*@Z427VLS*/ 00034000
         LA    @14,PRINTLIN                                        0198 00035000
         ST    @14,PRINTADR(,R2)                                   0198 00036000
*  CALL IOHND(RITEPRTR);                                   /*@Z427VLS*/ 00037000
         L     @15,ADIOHND(,R2)                                    0199 00038000
         LA    @01,@AL00199                                        0199 00039000
         BALR  @14,@15                                             0199 00040000
*  R15 = ZERO;                                             /*@Z427VLS*/ 00041000
         SLR   R15,R15                                             0200 00042000
* END;                                                     /*@Z427VLS*/ 00043000
*/*PROCESS ERROR RECORDS SEQUENTIALLY                        @Z427VLS*/ 00044000
*CALL INITIATE; /*ALLOCATE INITIAL TABLES                    @Z427VLS*/ 00045000
@RF00194 BAL   @14,INITIATE                                        0202 00046000
*R15 = ERROR; /*GET ERROR CONDITIONS FROM INITIATE           @Z427VLS*/ 00047000
         L     R15,ERROR                                           0203 00048000
*DO WHILE R15 = SUCCESS & ENTRIES < MAXENT;                /*@0099VLS*/ 00049000
         B     @DE00204                                            0204 00050000
@DL00204 DS    0H                                                  0205 00051000
*  CALL IOHND(READSEQ); /*GET A RECORD FROM ACCDEV OR SERLOG @Z427VLS*/ 00052000
         L     @15,ADIOHND(,R2)                                    0205 00053000
         LA    @01,@AL00205                                        0205 00054000
         BALR  @14,@15                                             0205 00055000
*  IF R15 = SUCCESS THEN /*CONTINUE IF NOT EOF OR UNREADABLE @Z427VLS*/ 00056000
         LTR   R15,R15                                             0206 00057000
         BNZ   @RF00206                                            0206 00058000
*    DO;                                                   /*@Z427VLS*/ 00059000
*      BUG(1) = BUG(1) + 1; /*NUMBER OF RECORDS RETRIEVED    @Z427VLS*/ 00060000
         LA    @14,1                                               0208 00061000
         AL    @14,BUG                                             0208 00062000
         ST    @14,BUG                                             0208 00063000
*IF ((LRTKEY1 & GENREC) = HEXA0)|   /* IF MCH OR CCH FRAME RECORD */    00064000
*   ((LRTKEY1 & GENREC) = HEXB0) THEN                              0209 00065000
         MVC   @TS00001(1),LRTKEY1(R7)                             0209 00066000
         NI    @TS00001,X'F0'                                      0209 00067000
         CLI   @TS00001,X'A0'                                      0209 00068000
         BE    @RT00209                                            0209 00069000
         MVC   @TS00001(1),LRTKEY1(R7)                             0209 00070000
         NI    @TS00001,X'F0'                                      0209 00071000
         CLI   @TS00001,X'B0'                                      0209 00072000
         BNE   @RF00209                                            0209 00073000
@RT00209 DS    0H                                                  0210 00074000
* DO;                                                      /*@G51DGBB*/ 00075000
*  CALL FLIMFRAM; /*PROCESS FRAME RECORDS SEQUENTIALLY       @G51DGBB*/ 00076000
         BAL   @14,FLIMFRAM                                        0211 00077000
*  R15 = ERROR; /*PASS ERROR CONDITIONS FROM FRAME PROCESSING*/    0212 00078000
         L     R15,ERROR                                           0212 00079000
* END;                                                     /*@G51DGBB*/ 00080000
*ELSE  /*NORMAL ERROR RECORD PROCESSING                      @G51DGBB*/ 00081000
*  DO;                                                     /*@G51DGBB*/ 00082000
         B     @RC00209                                            0214 00083000
@RF00209 DS    0H                                                  0215 00084000
*      CALL ALLREC; /*PERFORM TIME, DATE FILTERING           @Z427VLS*/ 00085000
         BAL   @14,ALLREC                                          0215 00086000
*      IF PASSFLAG = YES THEN                                      0216 00087000
         TM    PASSFLAG(R2),B'00000001'                            0216 00088000
         BNO   @RF00216                                            0216 00089000
*        DO;                                               /*@Z427VLS*/ 00090000
*          BUG(2) = BUG(2) + 1; /*NUM REC PASS DATE,TIME FILTERING*/    00091000
         LA    @14,1                                               0218 00092000
         AL    @14,BUG+4                                           0218 00093000
         ST    @14,BUG+4                                           0218 00094000
*          CALL RECDEP; /*FILTER BY DEVICE, STORE IN TABLE IF PASS*/    00095000
         BAL   @14,RECDEP                                          0219 00096000
*          IF PASSFLAG = ON THEN                                   0220 00097000
         TM    PASSFLAG(R2),B'00000001'                            0220 00098000
         BNO   @RF00220                                            0220 00099000
*            DO;                                           /*@Z427VLS*/ 00100000
*              BUG(3) = BUG(3) + ONE; /*NUMBER OF RECORDS PASS FILT*/   00101000
         LA    @14,1                                               0222 00102000
         AL    @14,BUG+8                                           0222 00103000
         ST    @14,BUG+8                                           0222 00104000
*             IF LRTYRDAY > EVSTOP THEN /*LATEST DAY IN DATA @Z427VLS*/ 00105000
         L     @14,EVPTR(,R2)                                      0223 00106000
         CLC   LRTYRDAY(3,R7),EVSTOP(@14)                          0223 00107000
         BNH   @RF00223                                            0223 00108000
*               EVSTOP = LRTYRDAY; /*SAVE FOR LATER COMPARES @Z427VLS*/ 00109000
         MVC   EVSTOP(3,@14),LRTYRDAY(R7)                          0224 00110000
*             IF LRTYRDAY < STRTDATE THEN /*IF EARLIEST DAY IN DATA*/   00111000
@RF00223 CLC   LRTYRDAY(3,R7),STRTDATE(R2)                         0225 00112000
         BNL   @RF00225                                            0225 00113000
*               STRTDATE = LRTYRDAY; /*SAVE FOR LATER COMPARES*/   0226 00114000
         MVC   STRTDATE(3,R2),LRTYRDAY(R7)                         0226 00115000
*              IF PACC = YES THEN /*HISTORY D.S. TO BE CREATED*/   0227 00116000
@RF00225 TM    PACC(R2),B'01000000'                                0227 00117000
         BNO   @RF00227                                            0227 00118000
*                CALL IOHND(RITEHIST); /*WRITE TO ACCDEV     @Z427VLS*/ 00119000
         L     @15,ADIOHND(,R2)                                    0228 00120000
         LA    @01,@AL00228                                        0228 00121000
         BALR  @14,@15                                             0228 00122000
*              IF R15 = SUCCESS & TRENDGRP  ^= ZERO & /*IF SUCCESS */   00123000
*                       CPU0FLG = OFF THEN /*NO ERRORS FOUND, CPU OK */ 00124000
@RF00227 LTR   R15,R15                                             0229 00125000
         BNZ   @RF00229                                            0229 00126000
         CLI   TRENDGRP,0                                          0229 00127000
         BE    @RF00229                                            0229 00128000
         TM    CPU0FLG,B'00001000'                                 0229 00129000
         BNZ   @RF00229                                            0229 00130000
*               DO;                                        /*@Z427VLS*/ 00131000
*                CALL ADDVALUE;   /*BUILD THE SORT TABLE ENTRY*/   0231 00132000
         BAL   @14,ADDVALUE                                        0231 00133000
*                TREND2  = (TREND2  && TREND2 ); /*CLEAR TREND2*/  0232 00134000
         XC    TREND2(14),TREND2                                   0232 00135000
*               END;                                       /*@Z427VLS*/ 00136000
*              ELSE                                                0234 00137000
*               IF R15 ^= SUCCESS THEN                             0234 00138000
         B     @RC00229                                            0234 00139000
@RF00229 LTR   R15,R15                                             0234 00140000
         BZ    @RF00234                                            0234 00141000
*                 ZEROALL = NO; /*DONT CLEAR LOGREC IF DONT PROCESS*/   00142000
         NI    ZEROALL(R2),B'10111111'                             0235 00143000
*                               /*ALL RECORDS                @Z427VLS*/ 00144000
*            END;                                          /*@Z427VLS*/ 00145000
@RF00234 DS    0H                                                  0236 00146000
@RC00229 DS    0H                                                  0237 00147000
*         END;                                             /*@Z427VLS*/ 00148000
@RF00220 DS    0H                                                  0238 00149000
*   END;                                                   /*@G51DGBB*/ 00150000
@RF00216 DS    0H                                                  0239 00151000
*      END;                                                /*@Z427VLS*/ 00152000
@RC00209 DS    0H                                                  0240 00153000
*    END;                                                  /*@Z427VLS*/ 00154000
@RF00206 DS    0H                                                  0240 00155000
@DE00204 LTR   R15,R15                                             0240 00156000
         BNZ   @DC00204                                            0240 00157000
         L     @14,ENTRIES                                         0240 00158000
         C     @14,MAXENT                                          0240 00159000
         BL    @DL00204                                            0240 00160000
@DC00204 DS    0H                                                  0241 00161000
* ERROR = R15; /*TELL ENDOFILE IF ERRORS                     @Z427VLS*/ 00162000
         ST    R15,ERROR                                           0241 00163000
*PASSNUM = ENTRIES - 1;                                    /*@0099VLS*/ 00164000
         L     @14,ENTRIES                                         0242 00165000
         BCTR  @14,0                                               0242 00166000
         ST    @14,PASSNUM                                         0242 00167000
* CALL ENDOFILE; /*SORT EVTABLE,TRENDONE, AND TREND2. HANDLE ERROR*/    00168000
         BAL   @14,ENDOFILE                                        0243 00169000
*                /*CONDITIONS, FREE EXCESS TREND2 CORE.      @Z427VLS*/ 00170000
* R15 = ERROR; /*RETURN CODE MAY HAVE BEEN MODIFIED BY ENDOFILE*/  0244 00171000
         L     R15,ERROR                                           0244 00172000
* IF DEBUG16 = ON THEN                                             0245 00173000
         TM    DEBUG16(R2),B'10000000'                             0245 00174000
         BNO   @RF00245                                            0245 00175000
*   CALL BUGCNTS; /*PRINT COUNT OF DIFFERENT RECORD TYPES    @Z427VLS*/ 00176000
         BAL   @14,BUGCNTS                                         0246 00177000
* IF DEBUG11 = ON THEN                                             0247 00178000
@RF00245 TM    DEBUG11(R2),B'00010000'                             0247 00179000
         BNO   @RF00247                                            0247 00180000
*   GEN(ABEND 320,DUMP); /*SHOW STATUS IF TESTING SITUATION  @Z427VLS*/ 00181000
         ABEND 320,DUMP                                                 00182000
*RESPECIFY(R15) UNRESTRICTED;                              /*@Z427VLS*/ 00183000
*/*******************************************************************/  00184000
*/*    THIS PROC WILL SEARCH THE SORT TABLE FOR A ENTRY WITH THE SAME*/ 00185000
*/*    KEY AS THIS ONE THEN SUM THE PERM AND TEMP ERRORS WITH THIS REC* 00186000
*/*    IF NO MATCH CAN BE FOUND THEN CREATE A NEW ONE        @0099VLS*/ 00187000
*/*                                                          @0099VLS*/ 00188000
*ADDVALUE: PROC;                                           /*@0099VLS*/ 00189000
@EL00001 L     @13,4(,@13)                                         0250 00190000
@EF00001 DS    0H                                                  0250 00191000
@ER00001 L     @14,12(,@13)                                        0250 00192000
         LM    @00,@12,20(@13)                                     0250 00193000
         BR    @14                                                 0250 00194000
ADDVALUE STM   @14,@12,@SA00002                                    0250 00195000
* DCL ZZ PTR(31)  INIT(0);                                 /*@0099VLS*/ 00196000
* DCL Z1 FIXED(31)  INIT(0);                               /*@0099VLS*/ 00197000
* DCL Z2 FIXED(31)  INIT(0);                               /*@0099VLS*/ 00198000
* DCL Z3 FIXED(31)  INIT(0);                               /*@0099VLS*/ 00199000
*DCL ZZ3 FIXED(31) INIT(0);                                /*@G51DGBB*/ 00200000
* DCL  1  TMTA  BASED(ZZ),                                         0256 00201000
*       2 TMTKEYA  CHAR(8),                                        0256 00202000
*       2 TMTPERMA FIXED(15) BDY(BYTE),                            0256 00203000
*       2 TMTTEMPA FIXED(31) BDY(BYTE);                    /*@0099VLS*/ 00204000
* ZZ3 = ZZ3 + 1;  /*NUMBER OF ENTRIES IN PART 2              @0099VLS*/ 00205000
         LA    @06,1                                               0257 00206000
         AL    @06,ZZ3                                             0257 00207000
         ST    @06,ZZ3                                             0257 00208000
* FOUND = NO;        /*SET FLAG TO ASSUME THE WORST          @0099VLS*/ 00209000
         NI    FOUND,B'01111111'                                   0258 00210000
* DO ZZ = SORTADR + (ENTRIES - 1) * 14 BY -14 TO SORTADR WHILE(    0259 00211000
*                                   FOUND = NO);           /*@0099VLS*/ 00212000
         L     @06,ENTRIES                                         0259 00213000
         BCTR  @06,0                                               0259 00214000
         MH    @06,@CH00952                                        0259 00215000
         AL    @06,SORTADR(,R2)                                    0259 00216000
         ST    @06,ZZ                                              0259 00217000
         B     @DE00259                                            0259 00218000
@DL00259 TM    FOUND,B'10000000'                                   0259 00219000
         BNZ   @DC00259                                            0259 00220000
*  IF TMTKEYA = TRENDKEY THEN                                      0260 00221000
         CLC   TMTKEYA(8,@06),TRENDKEY                             0260 00222000
         BNE   @RF00260                                            0260 00223000
*   DO;                                                    /*@0099VLS*/ 00224000
*    TMTPERMA = TMTPERMA + TRENDPR1;                       /*@0099VLS*/ 00225000
         ICM   @03,12,TMTPERMA(@06)                                0262 00226000
         SRA   @03,16                                              0262 00227000
         ICM   @15,12,TRENDPR1                                     0262 00228000
         SRA   @15,16                                              0262 00229000
         ALR   @03,@15                                             0262 00230000
         STCM  @03,3,TMTPERMA(@06)                                 0262 00231000
*    TMTTEMPA = TMTTEMPA + TRENDTMP;                       /*@0099VLS*/ 00232000
         ICM   @03,15,TMTTEMPA(@06)                                0263 00233000
         ICM   @15,15,TRENDTMP                                     0263 00234000
         ALR   @03,@15                                             0263 00235000
         STCM  @03,15,TMTTEMPA(@06)                                0263 00236000
*    FOUND = YES;                                          /*@0099VLS*/ 00237000
         OI    FOUND,B'10000000'                                   0264 00238000
*   END;                                                   /*@0099VLS*/ 00239000
* END;                                                     /*@0099VLS*/ 00240000
@RF00260 L     @06,@CF01375                                        0266 00241000
         AL    @06,ZZ                                              0266 00242000
         ST    @06,ZZ                                              0266 00243000
@DE00259 C     @06,SORTADR(,R2)                                    0266 00244000
         BNL   @DL00259                                            0266 00245000
@DC00259 DS    0H                                                  0267 00246000
* IF FOUND = NO THEN                                               0267 00247000
         TM    FOUND,B'10000000'                                   0267 00248000
         BNZ   @RF00267                                            0267 00249000
*  DO;                                                     /*@0099VLS*/ 00250000
*   TMT2(ENTRIES) = TREND2;                                /*@0099VLS*/ 00251000
         L     @06,ENTRIES                                         0269 00252000
         LR    @03,@06                                             0269 00253000
         MH    @03,@CH00952                                        0269 00254000
         L     @01,SORTADR(,R2)                                    0269 00255000
         ALR   @01,@03                                             0269 00256000
         AL    @01,@CF01375                                        0269 00257000
         MVC   TMT2(14,@01),TREND2                                 0269 00258000
*   ENTRIES = ENTRIES + 1;                                 /*@0099VLS*/ 00259000
         AL    @06,@CF00056                                        0270 00260000
         ST    @06,ENTRIES                                         0270 00261000
*  END;                                                    /*@0099VLS*/ 00262000
*IF DEBUG50 = ON THEN                                              0272 00263000
@RF00267 TM    DEBUG50(R2),B'00100000'                             0272 00264000
         BNO   @RF00272                                            0272 00265000
* DO;                                                      /*@0099VLS*/ 00266000
*  NUMBER = 14;                                            /*@0099VLS*/ 00267000
         MVC   NUMBER(4),@CF00952                                  0274 00268000
*  NEXTBY = ADDR(TREND2);                                  /*@0099VLS*/ 00269000
         LA    @06,TREND2                                          0275 00270000
         ST    @06,NEXTBY                                          0275 00271000
*  ADDNXT = ADDR(PRINTBDY);                                /*@0099VLS*/ 00272000
         LA    @06,PRINTBDY                                        0276 00273000
         ST    @06,ADDNXT                                          0276 00274000
*  CALL CONVERT;                                           /*@0099VLS*/ 00275000
         BAL   @14,CONVERT                                         0277 00276000
*  IF FOUND = YES THEN                                             0278 00277000
         TM    FOUND,B'10000000'                                   0278 00278000
         BNO   @RF00278                                            0278 00279000
*  DO;                                                     /*@0099VLS*/ 00280000
*  NEXTBY = ZZ + 14;                                       /*@0099VLS*/ 00281000
         LA    @06,14                                              0280 00282000
         AL    @06,ZZ                                              0280 00283000
         ST    @06,NEXTBY                                          0280 00284000
*  ADDNXT = ADDR(PRINTBDY) + 40;                           /*@0099VLS*/ 00285000
         LA    @06,PRINTBDY                                        0281 00286000
         AL    @06,@CF01380                                        0281 00287000
         ST    @06,ADDNXT                                          0281 00288000
*  CALL CONVERT;                                           /*@0099VLS*/ 00289000
         BAL   @14,CONVERT                                         0282 00290000
*  END;                                                    /*@0099VLS*/ 00291000
*  PRINTADR = ADDR(PRINTLIN);                              /*@0099VLS*/ 00292000
@RF00278 LA    @06,PRINTLIN                                        0284 00293000
         ST    @06,PRINTADR(,R2)                                   0284 00294000
*  CALL IOHND(RITEPRTR);                                   /*@0099VLS*/ 00295000
         L     @15,ADIOHND(,R2)                                    0285 00296000
         LA    @01,@AL00285                                        0285 00297000
         BALR  @14,@15                                             0285 00298000
* END;                                                     /*@0099VLS*/ 00299000
*TREND2 = TREND2  && TREND2;    /*CLEAR FOR THE NEXT ENTRY   @0099VLS*/ 00300000
@RF00272 XC    TREND2(14),TREND2                                   0287 00301000
*END;                                                      /*@0099VLS*/ 00302000
@EL00002 DS    0H                                                  0288 00303000
@EF00002 DS    0H                                                  0288 00304000
@ER00002 LM    @14,@12,@SA00002                                    0288 00305000
         BR    @14                                                 0288 00306000
*INITIATE: PROC;                                           /*@Z427VLS*/ 00307000
INITIATE STM   @14,@12,@SA00003                                    0289 00308000
*RESPECIFY(R3,R15) RESTRICTED;                             /*@Z427VLS*/ 00309000
*/*CORE IS ALLOCATED FOR TREND2  , EVTABLE, THE INITIAL ENTRIES OF */   00310000
*/*TRENDONE. IF SHARE TABLE EXISTS, EXTRA ENTRIES OF TRENDONE ARE  */   00311000
*/* ALLOCATED FOR EVERY UNIQUE CPU SERIAL ENCOUNTERED IN SHARE     */   00312000
*/* TABLE. ERROR MESSAGES ARE ISSUED AND A SERIOUS RETURN CODE     */   00313000
*/* ISSUED IF CORE IS NOT AVAILABLE. THE LENGTH  OF A TRENDONE     */   00314000
*/* GETMAIN IS DETERMINED.                                   @Z427VLS*/ 00315000
*CALL CALCRANG; /*FIND NUMBER OF DAYS IN DAY RANGE           @Z427VLS*/ 00316000
         BAL   @14,CALCRANG                                        0291 00317000
*TREN1SIZ = (NUMDAYS * 76) + 8;                            /*@0099VLS*/ 00318000
         L     @14,NUMDAYS(,R2)                                    0292 00319000
         MH    @14,@CH01385                                        0292 00320000
         AL    @14,@CF00036                                        0292 00321000
         ST    @14,TREN1SIZ                                        0292 00322000
* TREN1SIZ = TREN1SIZ + 127;  /*ROUND TO 128 BYTE BOUNDARY   @D35UGGB*/ 00323000
         AL    @14,@CF01386                                        0293 00324000
         ST    @14,TREN1SIZ                                        0293 00325000
* TREN1SIZ = TREN1SIZ / 128;  /*FOR DOS GETVIS COMPATABILITY @D35UGGB*/ 00326000
         LA    @06,128                                             0294 00327000
         LR    @00,@14                                             0294 00328000
         SRDA  @00,32                                              0294 00329000
         DR    @00,@06                                             0294 00330000
         ST    @01,TREN1SIZ                                        0294 00331000
* TREN1SIZ = TREN1SIZ * 128;                               /*@D35UGGB*/ 00332000
         SLA   @01,7                                               0295 00333000
         ST    @01,TREN1SIZ                                        0295 00334000
*R3 = TABSIZE + EVSIZE; /*LENGTH OF TREND2 PLUS EVTABLE      @Z427VLS*/ 00335000
         AL    @06,TABSIZE(,R2)                                    0296 00336000
         LR    R3,@06                                              0296 00337000
*GEN(GETMAIN EC,LV=(R3),A=COMPLINK); /*ISSUE REQUEST FOR CORE*/    0297 00338000
         GETMAIN EC,LV=(R3),A=COMPLINK                                  00339000
*IF R15 ^= SUCCESS THEN /*IF GETMAIN NOT SUCCESSFULL         @Z427VLS*/ 00340000
         LTR   R15,R15                                             0298 00341000
         BZ    @RF00298                                            0298 00342000
*  DO;                                                     /*@Z427VLS*/ 00343000
*    MSGNO = 2;                                            /*@Z427VLS*/ 00344000
         MVI   MSGNO,X'02'                                         0300 00345000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 00346000
         BAL   @14,ERRMSG                                          0301 00347000
*    R15 =NOSRTABL;                                        /*@0001VLS*/ 00348000
         LA    R15,12                                              0302 00349000
*    GETFAIL = YES;                                        /*@0001VLS*/ 00350000
         OI    GETFAIL,B'00000100'                                 0303 00351000
*  END;                                                    /*@Z427VLS*/ 00352000
*ELSE /*IF GETMAIN IS SUCCESSFULL                            @Z427VLS*/ 00353000
*  DO;                                                     /*@Z427VLS*/ 00354000
         B     @RC00298                                            0305 00355000
@RF00298 DS    0H                                                  0306 00356000
*    EVPTR = COMPLINK; /*ESTABLISH BASE ADDRESS OF EVTABLE   @Z427VLS*/ 00357000
         L     @14,COMPLINK                                        0306 00358000
         ST    @14,EVPTR(,R2)                                      0306 00359000
*    EVSTOP = '00000F'X; /*GRAB FIRST RECORDS DATE           @Z427VLS*/ 00360000
         MVC   EVSTOP(3,@14),@CB00228                              0307 00361000
*    STRTDATE = '99366F'X; /*LIKEWISE                        @Z427VLS*/ 00362000
         MVC   STRTDATE(3,R2),@CB01388                             0308 00363000
*    MAXENT = TABSIZE/14;      /*DETERMINE MAX NUMBER OF ENTRIES*/ 0309 00364000
         L     @00,TABSIZE(,R2)                                    0309 00365000
         SRDA  @00,32                                              0309 00366000
         D     @00,@CF00952                                        0309 00367000
         ST    @01,MAXENT                                          0309 00368000
*    SORTADR = EVPTR + EVSIZE; /*SET TREND2 BASE PAST EVTABLE*/    0310 00369000
         LA    @06,128                                             0310 00370000
         ALR   @06,@14                                             0310 00371000
         ST    @06,SORTADR(,R2)                                    0310 00372000
*    TREND2(1) = (TREND2(1) && TREND2(1)); /*CLEAR TREND2 ENT ONE*/     00373000
         XC    TREND2(1),TREND2                                    0311 00374000
*    EVTABLE  = (EVTABLE  && EVTABLE); /*CLEAR EVTABLE TO ZEROS*/  0312 00375000
         XC    EVTABLE(102,@14),EVTABLE(@14)                       0312 00376000
*    IF SHAREPTR ^= ZERO THEN                                      0313 00377000
         L     @14,SHAREPTR(,R2)                                   0313 00378000
         LTR   @14,@14                                             0313 00379000
         BZ    @RF00313                                            0313 00380000
*      DO;                                              /* @ZA17692 */  00381000
*        CALL SORTSHAR;      /* SORT SHARE TABLE CPU LETER @ZA17692 */  00382000
         BAL   @14,SORTSHAR                                        0315 00383000
*        DO J = 1 BY 1 TO SHARENUM WHILE R15 = SUCCESS;    /*@Z427VLS*/ 00384000
         LA    @14,1                                               0316 00385000
         ST    @14,J                                               0316 00386000
         B     @DE00316                                            0316 00387000
@DL00316 LTR   R15,R15                                             0316 00388000
         BNZ   @DC00316                                            0316 00389000
*          UNIQUE = YES;                                   /*@Z427VLS*/ 00390000
         OI    UNIQUE,B'00000100'                                  0317 00391000
*          DO K = 1 BY 1 TO EVMAX WHILE UNIQUE = YES;      /*@Z427VLS*/ 00392000
         LA    @14,1                                               0318 00393000
         ST    @14,K                                               0318 00394000
@DL00318 TM    UNIQUE,B'00000100'                                  0318 00395000
         BNO   @DC00318                                            0318 00396000
*            IF SHARSERA(J) = EVSERIAL(K) THEN                     0319 00397000
         L     @06,J                                               0319 00398000
         SLA   @06,4                                               0319 00399000
         L     @01,SHAREPTR(,R2)                                   0319 00400000
         MH    @14,@CH00081                                        0319 00401000
         L     @05,EVPTR(,R2)                                      0319 00402000
         ALR   @01,@06                                             0319 00403000
         AL    @01,@CF01599                                        0319 00404000
         ALR   @05,@14                                             0319 00405000
         CLC   SHARSERA-10(3,@01),EVSERIAL-6(@05)                  0319 00406000
         BNE   @RF00319                                            0319 00407000
*              UNIQUE = NO;                                /*@Z427VLS*/ 00408000
         NI    UNIQUE,B'11111011'                                  0320 00409000
*            ELSE IF EVSERIAL(K) = ZERO THEN                       0321 00410000
         B     @RC00319                                            0321 00411000
@RF00319 L     @14,K                                               0321 00412000
         MH    @14,@CH00081                                        0321 00413000
         L     @06,EVPTR(,R2)                                      0321 00414000
         L     @05,EVSERIAL-7(@14,@06)                             0321 00415000
         LA    @05,0(,@05)                                         0321 00416000
         LTR   @05,@05                                             0321 00417000
         BNZ   @RF00321                                            0321 00418000
*              DO;                                         /*@Z427VLS*/ 00419000
*                UNIQUE = NO; /*ONLY BUILD ONE ENTRY PER CPU @Z427VLS*/ 00420000
         NI    UNIQUE,B'11111011'                                  0323 00421000
*                EVSERIAL(K) = SHARSERA(J);                /*@Z427VLS*/ 00422000
         ST    @14,@TF00001                                        0324 00423000
         ALR   @14,@06                                             0324 00424000
         L     @05,J                                               0324 00425000
         SLA   @05,4                                               0324 00426000
         L     @04,SHAREPTR(,R2)                                   0324 00427000
         ST    @05,@TF00002                                        0324 00428000
         ALR   @05,@04                                             0324 00429000
         AL    @05,@CF01599                                        0324 00430000
         MVC   EVSERIAL-6(3,@14),SHARSERA-10(@05)                  0324 00431000
*                EVLETTER(K) = SHARLET(J);                 /*@Z427VLS*/ 00432000
         LR    @14,@06                                             0325 00433000
         AL    @14,@TF00001                                        0325 00434000
         AL    @04,@TF00002                                        0325 00435000
         MVC   EVLETTER-6(1,@14),SHARLET-16(@04)                   0325 00436000
*                EVNUM = EVNUM + 1;                        /*@Z427VLS*/ 00437000
         LA    @14,1                                               0326 00438000
         AH    @14,EVNUM(,@06)                                     0326 00439000
         STH   @14,EVNUM(,@06)                                     0326 00440000
*                    R3 = TREN1SIZ; /*LENGTH OF TRENDONE TABLE*/   0327 00441000
         L     R3,TREN1SIZ                                         0327 00442000
*                    GEN(GETMAIN EC,LV=(R3),A=COMPLINK);   /*@Z427VLS*/ 00443000
         GETMAIN EC,LV=(R3),A=COMPLINK                                  00444000
*                    IF R15  ^= SUCCESS THEN                       0329 00445000
         LTR   R15,R15                                             0329 00446000
         BZ    @RF00329                                            0329 00447000
*                      DO;                                 /*@Z427VLS*/ 00448000
*                        MSGNO = 1;                        /*@Z427VLS*/ 00449000
         MVI   MSGNO,X'01'                                         0331 00450000
*                        CALL ERRMSG;                      /*@Z427VLS*/ 00451000
         BAL   @14,ERRMSG                                          0332 00452000
*                    R15 = NOSRTABL; /*RET.CODE OF 12        @0001VLS*/ 00453000
         LA    R15,12                                              0333 00454000
*                    GETFAIL = YES; /*STOP FURTHER PROCESSING*/    0334 00455000
         OI    GETFAIL,B'00000100'                                 0334 00456000
*                      END;                                /*@Z427VLS*/ 00457000
*                    ELSE                                          0336 00458000
*                      DO;                                 /*@Z427VLS*/ 00459000
         B     @RC00329                                            0336 00460000
@RF00329 DS    0H                                                  0337 00461000
*                        IF K > 1 THEN /*IF NOT 1ST CREATED ENTRY*/     00462000
         CLC   K(4),@CF00056                                       0337 00463000
         BNH   @RF00337                                            0337 00464000
*                          TRENEXT = COMPLINK; /*POINT TO THIS NEW*/    00465000
         L     @14,TRENPTR(,R2)                                    0338 00466000
         L     @06,COMPLINK                                        0338 00467000
         ST    @06,TRENEXT(,@14)                                   0338 00468000
*                                         /*ENTRY IN THE OLD ENTRY*/    00469000
*                        TRENPTR = COMPLINK; /*ADDRESS NEW ENTRY*/ 0339 00470000
@RF00337 L     @14,COMPLINK                                        0339 00471000
         ST    @14,TRENPTR(,R2)                                    0339 00472000
*                        SAVEADR(K) = COMPLINK; /*SAVE ENTRY ADDRESS*/  00473000
         L     @06,K                                               0340 00474000
         SLA   @06,2                                               0340 00475000
         ST    @14,SAVEADR-4(@06)                                  0340 00476000
*                        DO Q = 1 BY 1 TO NUMDAYS;         /*@Z427VLS*/ 00477000
         LA    @14,1                                               0341 00478000
         ST    @14,Q                                               0341 00479000
         B     @DE00341                                            0341 00480000
@DL00341 DS    0H                                                  0342 00481000
*                          TREGEN(Q) = (TREGEN(Q) && TREGEN(Q));   0342 00482000
         LR    @06,@14                                             0342 00483000
         MH    @06,@CH01385                                        0342 00484000
         L     @01,TRENPTR(,R2)                                    0342 00485000
         ALR   @01,@06                                             0342 00486000
         AL    @01,@CF01601                                        0342 00487000
         XC    TREGEN-8(76,@01),TREGEN-8(@01)                      0342 00488000
*                        END;                              /*@Z427VLS*/ 00489000
         AL    @14,@CF00056                                        0343 00490000
         ST    @14,Q                                               0343 00491000
@DE00341 C     @14,NUMDAYS(,R2)                                    0343 00492000
         BNH   @DL00341                                            0343 00493000
*                        TRENEXT = (TRENEXT && TRENEXT);   /*@Z427VLS*/ 00494000
         L     @14,TRENPTR(,R2)                                    0344 00495000
         L     @06,TRENEXT(,@14)                                   0344 00496000
         LR    @05,@06                                             0344 00497000
         XR    @05,@06                                             0344 00498000
         ST    @05,TRENEXT(,@14)                                   0344 00499000
*                        TRENUM  = (TRENUM && TRENUM);     /*@Z427VLS*/ 00500000
         L     @06,TRENUM(,@14)                                    0345 00501000
         LR    @05,@06                                             0345 00502000
         XR    @05,@06                                             0345 00503000
         ST    @05,TRENUM(,@14)                                    0345 00504000
*                          /*SET NEW ENTRY TO ZEROS          @Z427VLS*/ 00505000
*                      END;                                /*@Z427VLS*/ 00506000
*              END;                                        /*@Z427VLS*/ 00507000
@RC00329 DS    0H                                                  0348 00508000
*          END;                                          /* @Z427VLS */ 00509000
@RF00321 DS    0H                                                  0348 00510000
@RC00319 LA    @14,1                                               0348 00511000
         AL    @14,K                                               0348 00512000
         ST    @14,K                                               0348 00513000
         C     @14,@CF00088                                        0348 00514000
         BNH   @DL00318                                            0348 00515000
@DC00318 DS    0H                                                  0349 00516000
*        END;                                            /* @Z427VLS */ 00517000
         LA    @14,1                                               0349 00518000
         AL    @14,J                                               0349 00519000
         ST    @14,J                                               0349 00520000
@DE00316 L     @06,SHAREPTR(,R2)                                   0349 00521000
         CH    @14,SHARENUM(,@06)                                  0349 00522000
         BNH   @DL00316                                            0349 00523000
@DC00316 DS    0H                                                  0350 00524000
*      END;                                             /* @ZA17692 */  00525000
*  END;                                                    /*@Z427VLS*/ 00526000
@RF00313 DS    0H                                                  0352 00527000
*  NUMUNSHR = EVNUM + 1;                                   /*@Z427VLS*/ 00528000
@RC00298 L     @14,EVPTR(,R2)                                      0352 00529000
         LH    @14,EVNUM(,@14)                                     0352 00530000
         LA    @14,1(,@14)                                         0352 00531000
         STH   @14,NUMUNSHR                                        0352 00532000
*IF R15 = SUCCESS &  /*IF OTHER GETMAINS HAVE BEEN SUCCESSFULL  */ 0353 00533000
*         PACC = ON &  /*ONLY CHECK FRAMES IF WRITTEN TO ACCDEV*/  0353 00534000
*         (PMCH = ON | PCHAN = ON) THEN /*IF MCH OR CCH SELECTED*/ 0353 00535000
         LTR   R15,R15                                             0353 00536000
         BNZ   @RF00353                                            0353 00537000
         TM    PACC(R2),B'01000000'                                0353 00538000
         BNO   @RF00353                                            0353 00539000
         TM    PMCH(R2),B'11000000'                                0353 00540000
         BZ    @RF00353                                            0353 00541000
*  DO;                                                     /*@G51DGBB*/ 00542000
*    RESPECIFY (R1) RESTRICTED;                            /*@G51DGBB*/ 00543000
*    R0 = FRAMBENT * EVMAX; /*NUMBER OF ENTRIES TIMES BYTES PER ENTRY*/ 00544000
         LA    R0,384                                              0356 00545000
*    R0 = R0 + 4;           /*ADD FRAMENUM LENGTH            @G51DGBB*/ 00546000
         AL    R0,@CF00065                                         0357 00547000
*    GEN(GETMAIN EC,LV=(R0),A=LINKITM,SP=21); /*GET THE STORAGE*/  0358 00548000
         GETMAIN EC,LV=(R0),A=LINKITM,SP=21                             00549000
*    RESPECIFY (R0) UNRESTRICTED;                          /*@G51DGBB*/ 00550000
*    IF R15 = SUCCESS THEN   /*IF GETMAIN SUCCESSFULL        @G51DGBB*/ 00551000
         LTR   R15,R15                                             0360 00552000
         BNZ   @RF00360                                            0360 00553000
*      DO;                                                 /*@G51DGBB*/ 00554000
*        FRAMEPTR = LINKITM;  /*ESTABLISH FRAMETAB BASE ADDRESS*/  0362 00555000
         L     @14,LINKITM                                         0362 00556000
         ST    @14,FRAMEPTR(,R2)                                   0362 00557000
*        DO Y = 1 BY 1 TO EVMAX; /*CLEAR FRAMETAB TO ZEROS   @G51DGBB*/ 00558000
         LA    @14,1                                               0363 00559000
         ST    @14,Y                                               0363 00560000
@DL00363 DS    0H                                                  0364 00561000
*          FRAMEDTA(Y) = (FRAMEDTA(Y) && FRAMEDTA(Y));     /*@G51DGBB*/ 00562000
         LR    @06,@14                                             0364 00563000
         MH    @06,@CH00227                                        0364 00564000
         L     @05,FRAMEPTR(,R2)                                   0364 00565000
         ALR   @05,@06                                             0364 00566000
         AL    @05,@CF01602                                        0364 00567000
         XC    FRAMEDTA-4(24,@05),FRAMEDTA-4(@05)                  0364 00568000
*        END;                                              /*@G51DGBB*/ 00569000
         AL    @14,@CF00056                                        0365 00570000
         ST    @14,Y                                               0365 00571000
         C     @14,@CF00088                                        0365 00572000
         BNH   @DL00363                                            0365 00573000
*        FRAMENUM = ZEROS;                                 /*@G51DGBB*/ 00574000
         L     @14,FRAMEPTR(,R2)                                   0366 00575000
         SLR   @06,@06                                             0366 00576000
         ST    @06,FRAMENUM(,@14)                                  0366 00577000
*      END;                                                /*@G51DGBB*/ 00578000
*  ELSE  /*UNSUCCESSFULL GETMAIN                             @G51DGBB*/ 00579000
*    DO;                                                   /*@G51DGBB*/ 00580000
         B     @RC00360                                            0368 00581000
@RF00360 DS    0H                                                  0369 00582000
*      R15 = TWELVE;  /*DONT CONTINUE RETURN CODE            @G51DGBB*/ 00583000
         LA    R15,12                                              0369 00584000
*      MSGNO = 40;   /*CORE NOT AVAILABLE MESSAGE            @G51DGBB*/ 00585000
         MVI   MSGNO,X'28'                                         0370 00586000
*      CALL ERRMSG;  /*PRINT ERROR MESSAGE                   @G51DGBB*/ 00587000
         BAL   @14,ERRMSG                                          0371 00588000
*    END;                                                  /*@G51DGBB*/ 00589000
* END; /*END OF FRAMETAB GETMAIN                             @G51DGBB*/ 00590000
@RC00360 DS    0H                                                  0374 00591000
*  ERROR = R15; /*COMMUNICATE ERROR CONDITIONS TO CALLING PROC*/   0374 00592000
@RF00353 ST    R15,ERROR                                           0374 00593000
*RESPECIFY(R3,R15) UNRESTRICTED;                           /*@Z427VLS*/ 00594000
*END; /*END OF PROC INITAB                                   @Z427VLS*/ 00595000
@EL00003 DS    0H                                                  0376 00596000
@EF00003 DS    0H                                                  0376 00597000
@ER00003 LM    @14,@12,@SA00003                                    0376 00598000
         BR    @14                                                 0376 00599000
*CONVERT: PROC;                                            /*@Z427VLS*/ 00600000
CONVERT  STM   @14,@12,12(@13)                                     0377 00601000
* DCL  T      FIXED(31) INIT(0);                           /*@Z427VLS*/ 00602000
*DCL  P FIXED(31) INIT(0);                                 /*@G51DGBB*/ 00603000
*DCL  R FIXED(31) INIT(0);                                 /*@G51DGBB*/ 00604000
* DCL  NUMBER FIXED(31) INIT(0);                           /*@Z427VLS*/ 00605000
* DCL  NEXTBYTE(1) CHAR(1) BASED(NEXTBY);                  /*@Z427VLS*/ 00606000
* DCL  ADDNUM(1)   CHAR(1) BASED(ADDNXT);                  /*@Z427VLS*/ 00607000
* DCL  CHARS       CHAR(16) INIT('0123456789ABCDEF');      /*@Z427VLS*/ 00608000
* DCL  NEXTBY FIXED(31) INIT(0);                           /*@Z427VLS*/ 00609000
* DCL  ADDNXT FIXED(31) INIT(0);                           /*@Z427VLS*/ 00610000
*   RESPECIFY (R4,R5) RESTRICTED;                          /*@0099VLS*/ 00611000
*DO R = NUMBER BY -1 TO 1;                                 /*@G51DGBB*/ 00612000
         L     @06,NUMBER                                          0388 00613000
         ST    @06,R                                               0388 00614000
         B     @DE00388                                            0388 00615000
@DL00388 DS    0H                                                  0389 00616000
* R4 = NEXTBYTE(R);                                        /*@G51DGBB*/ 00617000
         L     @03,NEXTBY                                          0389 00618000
         BCTR  @03,0                                               0389 00619000
         SLR   R4,R4                                               0389 00620000
         IC    R4,NEXTBYTE(@06,@03)                                0389 00621000
* P = 2 * R;                                               /*@G51DGBB*/ 00622000
         LR    @03,@06                                             0390 00623000
         ALR   @03,@03                                             0390 00624000
         ST    @03,P                                               0390 00625000
*  SRDL(R4,4);                                             /*@Z427VLS*/ 00626000
         SRDL  R4,4                                                0391 00627000
*  SRL(R5,28);                                             /*@Z427VLS*/ 00628000
         SRL   R5,28                                               0392 00629000
*  R5 = R5 + 1;                                            /*@Z427VLS*/ 00630000
         LA    @15,1                                               0393 00631000
         ALR   R5,@15                                              0393 00632000
*  R4 = R4 + 1;                                            /*@Z427VLS*/ 00633000
         ALR   R4,@15                                              0394 00634000
* ADDNUM(P-1) = CHARS(R4);                                 /*@G51DGBB*/ 00635000
         L     @15,ADDNXT                                          0395 00636000
         ALR   @03,@15                                             0395 00637000
         BCTR  @03,0                                               0395 00638000
         BCTR  @03,0                                               0395 00639000
         LA    @14,CHARS-1(R4)                                     0395 00640000
         MVC   ADDNUM(1,@03),0(@14)                                0395 00641000
* ADDNUM(P)  = CHARS(R5);                                  /*@G51DGBB*/ 00642000
         L     @03,P                                               0396 00643000
         ALR   @15,@03                                             0396 00644000
         BCTR  @15,0                                               0396 00645000
         LA    @03,CHARS-1(R5)                                     0396 00646000
         MVC   ADDNUM(1,@15),0(@03)                                0396 00647000
* END;                                                     /*@Z427VLS*/ 00648000
         BCTR  @06,0                                               0397 00649000
         ST    @06,R                                               0397 00650000
@DE00388 LTR   @06,@06                                             0397 00651000
         BP    @DL00388                                            0397 00652000
*END;                                                      /*@Z427VLS*/ 00653000
@EL00004 DS    0H                                                  0398 00654000
@EF00004 DS    0H                                                  0398 00655000
@ER00004 LM    @14,@12,12(@13)                                     0398 00656000
         BR    @14                                                 0398 00657000
*RESPECIFY (R4,R5) UNRESTRICTED;                           /*@Z427VLS*/ 00658000
*SORTONE: PROC; /*SORT EVTABLE IN DESCENDING ORDER BY MODEL, SERIAL*/   00659000
SORTONE  STM   @14,@12,12(@13)                                     0400 00660000
*               /*NUMBER FOR UNSHARED CPUS AND RELINK THE NEXT     */   00661000
*               /*ENTRY POINTERS FOR TABLE TRENDONE.         @Z427VLS*/ 00662000
*               /*SET EVLETTER FOR UNSHARED CPUS             @Z427VLS*/ 00663000
*IF NUMUNSHR < EVNUM THEN  /*IF TWO OR MORE CPUS IDENTIFIED AND    */   00664000
         LH    @06,NUMUNSHR                                        0401 00665000
         L     @03,EVPTR(,R2)                                      0401 00666000
         CH    @06,EVNUM(,@03)                                     0401 00667000
         BNL   @RF00401                                            0401 00668000
*  DO;   /*NOT IN SHARE TABLE THEN SORT, RELINK POINTERS.    @Z427VLS*/ 00669000
*    DO J = NUMUNSHR BY 1 TO EVNUM - 1; /*SORT IN DESCENDING ORDER */   00670000
         ST    @06,J                                               0403 00671000
         B     @DE00403                                            0403 00672000
@DL00403 DS    0H                                                  0404 00673000
*      DO K = J+1 BY 1 TO EVNUM;                           /*@Z427VLS*/ 00674000
         AL    @06,@CF00056                                        0404 00675000
         ST    @06,K                                               0404 00676000
         B     @DE00404                                            0404 00677000
@DL00404 DS    0H                                                  0405 00678000
*        IF EVKEY(J) < EVKEY(K) THEN                               0405 00679000
         L     @03,J                                               0405 00680000
         LA    @15,6                                               0405 00681000
         LR    @05,@03                                             0405 00682000
         MR    @04,@15                                             0405 00683000
         L     @04,EVPTR(,R2)                                      0405 00684000
         MR    @14,@06                                             0405 00685000
         ST    @05,@TF00001                                        0405 00686000
         ALR   @05,@04                                             0405 00687000
         ST    @15,@TF00002                                        0405 00688000
         ALR   @15,@04                                             0405 00689000
         CLC   EVKEY-6(6,@05),EVKEY-6(@15)                         0405 00690000
         BNL   @RF00405                                            0405 00691000
*          DO;                                             /*@Z427VLS*/ 00692000
*            EVKEY(J) = (EVKEY(J)   &&   EVKEY(K)); /*FLIP ENTRIES*/    00693000
         LR    @05,@04                                             0407 00694000
         AL    @05,@TF00001                                        0407 00695000
         LR    @15,@04                                             0407 00696000
         AL    @15,@TF00001                                        0407 00697000
         MVC   @TS00001(6),EVKEY-6(@15)                            0407 00698000
         LR    @15,@04                                             0407 00699000
         AL    @15,@TF00002                                        0407 00700000
         XC    @TS00001(6),EVKEY-6(@15)                            0407 00701000
         MVC   EVKEY-6(6,@05),@TS00001                             0407 00702000
*            EVKEY(K) = (EVKEY(K)   &&   EVKEY(J));        /*@Z427VLS*/ 00703000
         LR    @05,@04                                             0408 00704000
         AL    @05,@TF00002                                        0408 00705000
         LR    @15,@04                                             0408 00706000
         AL    @15,@TF00002                                        0408 00707000
         MVC   @TS00001(6),EVKEY-6(@15)                            0408 00708000
         LR    @15,@04                                             0408 00709000
         AL    @15,@TF00001                                        0408 00710000
         XC    @TS00001(6),EVKEY-6(@15)                            0408 00711000
         MVC   EVKEY-6(6,@05),@TS00001                             0408 00712000
*            EVKEY(J) = (EVKEY(J)   &&   EVKEY(K));        /*@Z427VLS*/ 00713000
         LR    @05,@04                                             0409 00714000
         AL    @05,@TF00001                                        0409 00715000
         LR    @15,@04                                             0409 00716000
         AL    @15,@TF00001                                        0409 00717000
         MVC   @TS00001(6),EVKEY-6(@15)                            0409 00718000
         AL    @04,@TF00002                                        0409 00719000
         XC    @TS00001(6),EVKEY-6(@04)                            0409 00720000
         MVC   EVKEY-6(6,@05),@TS00001                             0409 00721000
*            SAVEADR(J) = (SAVEADR(J)  &&  SAVEADR(K));    /*@Z427VLS*/ 00722000
         LR    @15,@03                                             0410 00723000
         SLA   @15,2                                               0410 00724000
         LR    @14,@06                                             0410 00725000
         SLA   @14,2                                               0410 00726000
         L     @00,SAVEADR-4(@15)                                  0410 00727000
         X     @00,SAVEADR-4(@14)                                  0410 00728000
         ST    @00,SAVEADR-4(@15)                                  0410 00729000
*            SAVEADR(K) = (SAVEADR(K)  &&  SAVEADR(J));    /*@Z427VLS*/ 00730000
         X     @00,SAVEADR-4(@14)                                  0411 00731000
         ST    @00,SAVEADR-4(@14)                                  0411 00732000
*            SAVEADR(J) = (SAVEADR(J)  &&  SAVEADR(K));    /*@Z427VLS*/ 00733000
         X     @00,SAVEADR-4(@15)                                  0412 00734000
         ST    @00,SAVEADR-4(@15)                                  0412 00735000
*            /*MUST SAVE ALTERATIONS TO EVTABLE SO THAT I CAN FIX*/     00736000
*            /*ENTRY POINTERS TO EVTABLE IN SYSUM2 AT END OF JOB*/ 0413 00737000
*            FLIP(J)    = (FLIP(J) && FLIP(K));            /*@Z427VLS*/ 00738000
         SLR   @00,@00                                             0413 00739000
         IC    @00,FLIP-1(@03)                                     0413 00740000
         SLR   @15,@15                                             0413 00741000
         IC    @15,FLIP-1(@06)                                     0413 00742000
         XR    @00,@15                                             0413 00743000
         STC   @00,FLIP-1(@03)                                     0413 00744000
*            FLIP(K)    = (FLIP(K) && FLIP(J));            /*@Z427VLS*/ 00745000
         SLR   @15,@15                                             0414 00746000
         IC    @15,FLIP-1(@06)                                     0414 00747000
         XR    @00,@15                                             0414 00748000
         STC   @00,FLIP-1(@06)                                     0414 00749000
*            FLIP(J)    = (FLIP(J) && FLIP(K));            /*@Z427VLS*/ 00750000
         SLR   @06,@06                                             0415 00751000
         IC    @06,FLIP-1(@03)                                     0415 00752000
         XR    @00,@06                                             0415 00753000
         STC   @00,FLIP-1(@03)                                     0415 00754000
*          END;                                            /*@Z427VLS*/ 00755000
*        END;                                              /*@Z427VLS*/ 00756000
@RF00405 LA    @06,1                                               0417 00757000
         AL    @06,K                                               0417 00758000
         ST    @06,K                                               0417 00759000
@DE00404 L     @03,EVPTR(,R2)                                      0417 00760000
         CH    @06,EVNUM(,@03)                                     0417 00761000
         BNH   @DL00404                                            0417 00762000
*     END;                                                 /*@Z427VLS*/ 00763000
         LA    @06,1                                               0418 00764000
         AL    @06,J                                               0418 00765000
         ST    @06,J                                               0418 00766000
@DE00403 L     @03,EVPTR(,R2)                                      0418 00767000
         LH    @03,EVNUM(,@03)                                     0418 00768000
         BCTR  @03,0                                               0418 00769000
         CR    @06,@03                                             0418 00770000
         BNH   @DL00403                                            0418 00771000
*DO J = NUMUNSHR BY 1 TO EVNUM; /*RELINK ALL TRENDONE ENTRIES*/    0419 00772000
         LH    @06,NUMUNSHR                                        0419 00773000
         ST    @06,J                                               0419 00774000
         B     @DE00419                                            0419 00775000
@DL00419 DS    0H                                                  0420 00776000
*  IF J > 1 THEN  /*IF 1ST ENTRY, CANT CHANGE PREVIOUS FORWARD PTR*/    00777000
         C     @06,@CF00056                                        0420 00778000
         BNH   @RF00420                                            0420 00779000
*    DO;                                                   /*@Z427VLS*/ 00780000
*      TRENPTR = SAVEADR(J-1); /*ADDRESS PREVIOUS ENTRY      @Z427VLS*/ 00781000
         SLA   @06,2                                               0422 00782000
         L     @03,SAVEADR-8(@06)                                  0422 00783000
         ST    @03,TRENPTR(,R2)                                    0422 00784000
*      TRENEXT = SAVEADR(J); /*CHANGE PREVIOUS FORWARD PTR   @Z427VLS*/ 00785000
         L     @06,SAVEADR-4(@06)                                  0423 00786000
         ST    @06,TRENEXT(,@03)                                   0423 00787000
*    END;                                                  /*@Z427VLS*/ 00788000
*  IF J = EVNUM THEN /*IF LAST ENTRY IN CHAIN, DONT POINT TO NEXT*/     00789000
@RF00420 L     @06,J                                               0425 00790000
         L     @03,EVPTR(,R2)                                      0425 00791000
         CH    @06,EVNUM(,@03)                                     0425 00792000
         BNE   @RF00425                                            0425 00793000
*    DO;                                                   /*@Z427VLS*/ 00794000
*      TRENPTR = SAVEADR(J); /*ADDRESS LAST ENTRY            @Z427VLS*/ 00795000
         SLA   @06,2                                               0427 00796000
         L     @06,SAVEADR-4(@06)                                  0427 00797000
         ST    @06,TRENPTR(,R2)                                    0427 00798000
*      TRENEXT = 0; /*SET LAST ENTRY FORWARD POINTER TO ZERO @Z427VLS*/ 00799000
         SLR   @03,@03                                             0428 00800000
         ST    @03,TRENEXT(,@06)                                   0428 00801000
*    END;                                                  /*@Z427VLS*/ 00802000
*  END;                                                    /*@Z427VLS*/ 00803000
@RF00425 LA    @06,1                                               0430 00804000
         AL    @06,J                                               0430 00805000
         ST    @06,J                                               0430 00806000
@DE00419 L     @03,EVPTR(,R2)                                      0430 00807000
         CH    @06,EVNUM(,@03)                                     0430 00808000
         BNH   @DL00419                                            0430 00809000
* END;                                                     /*@Z427VLS*/ 00810000
*IF NUMUNSHR < EVNUM + 1 THEN  /*IF SOME EVLETTERS REMAIN UNSET*/  0432 00811000
@RF00401 LH    @06,NUMUNSHR                                        0432 00812000
         L     @03,EVPTR(,R2)                                      0432 00813000
         LA    @00,1                                               0432 00814000
         AH    @00,EVNUM(,@03)                                     0432 00815000
         CR    @06,@00                                             0432 00816000
         BNL   @RF00432                                            0432 00817000
*  DO J = NUMUNSHR BY 1 TO EVNUM;                          /*@Z427VLS*/ 00818000
         ST    @06,J                                               0433 00819000
         B     @DE00433                                            0433 00820000
@DL00433 DS    0H                                                  0434 00821000
*    EVLETTER(J) = EVCON(J); /*GET NEXT CONSECUTIVE LETTER FOR CPU*/    00822000
         LR    @03,@06                                             0434 00823000
         MH    @03,@CH00081                                        0434 00824000
         L     @15,EVPTR(,R2)                                      0434 00825000
         ALR   @15,@03                                             0434 00826000
         LA    @03,EVCON-1(@06)                                    0434 00827000
         MVC   EVLETTER-6(1,@15),0(@03)                            0434 00828000
*  END;                                                    /*@Z427VLS*/ 00829000
         AL    @06,@CF00056                                        0435 00830000
         ST    @06,J                                               0435 00831000
@DE00433 L     @03,EVPTR(,R2)                                      0435 00832000
         CH    @06,EVNUM(,@03)                                     0435 00833000
         BNH   @DL00433                                            0435 00834000
*TRENPTR = SAVEADR(1); /*SET TRENPTR TO FIRST TABLE IN CHAIN @Z427VLS*/ 00835000
@RF00432 L     @06,SAVEADR                                         0436 00836000
         ST    @06,TRENPTR(,R2)                                    0436 00837000
*END; /*CLOSING END FOR SORTONE                              @Z427VLS*/ 00838000
@EL00005 DS    0H                                                  0437 00839000
@EF00005 DS    0H                                                  0437 00840000
@ER00005 LM    @14,@12,12(@13)                                     0437 00841000
         BR    @14                                                 0437 00842000
*SORTWO: PROC;                                             /*@Z427VLS*/ 00843000
SORTWO   STM   @14,@12,@SA00006                                    0438 00844000
*/*ADJUST POINTERS TO EVTABLE, TRENDCPU,TRENDOLD AS A RESULT OF SORT*/  00845000
*/*OF EVTABLE. MUST DO BEFORE SORTING TREND2                 @Z427VLS*/ 00846000
*  DO J = 1 BY 1 TO PASSNUM;                               /*@Z427VLS*/ 00847000
         LA    @06,1                                               0439 00848000
         ST    @06,J                                               0439 00849000
         B     @DE00439                                            0439 00850000
@DL00439 DS    0H                                                  0440 00851000
*    WORKBYTE = TMTCPUS(J);                                /*@0099VLS*/ 00852000
         LR    @03,@06                                             0440 00853000
         MH    @03,@CH00952                                        0440 00854000
         L     @15,SORTADR(,R2)                                    0440 00855000
         ST    @03,@TF00001                                        0440 00856000
         ALR   @03,@15                                             0440 00857000
         AL    @03,@CF01603                                        0440 00858000
         MVC   WORKBYTE(1),TMTCPUS-3(@03)                          0440 00859000
*    WORKTWO  = WORKBYTE; /*DITTO                            @Z427VLS*/ 00860000
         MVC   WORKTWO(1),WORKBYTE                                 0441 00861000
*    SRL(WORKBYTE,4); /*WORKBYTE,WORKNM NOW SET TO TRENDCPU  @Z427VLS*/ 00862000
         SLR   @03,@03                                             0442 00863000
         IC    @03,WORKBYTE                                        0442 00864000
         SRL   @03,4                                               0442 00865000
         STC   @03,WORKBYTE                                        0442 00866000
*    WORKTWO = (WORKTWO & '0F'X); /*WORKTWO,WORKNM2 NOW TRENDOLD*/ 0443 00867000
         NI    WORKTWO,X'0F'                                       0443 00868000
*    WORKNM2 = WORKNM2 + 1; /*REFERENCE 1ST ENTRY AS 1, NOT 0*/    0444 00869000
         LA    @03,1                                               0444 00870000
         SLR   @00,@00                                             0444 00871000
         IC    @00,WORKNM2                                         0444 00872000
         ALR   @00,@03                                             0444 00873000
         STC   @00,WORKNM2                                         0444 00874000
*    TMTCPUS(J) = FLIPFLOP(WORKNM2);                       /*@0099VLS*/ 00875000
         LR    @14,@15                                             0445 00876000
         AL    @14,@TF00001                                        0445 00877000
         AL    @14,@CF01603                                        0445 00878000
         LR    @05,@00                                             0445 00879000
         LA    @04,FLIPFLOP-1(@05)                                 0445 00880000
         MVC   TMTCPUS-3(1,@14),0(@04)                             0445 00881000
*    WORKNM = WORKNM + 1; /*REFERENCE 1ST ENTRY AS 1, NOT 0  @Z427VLS*/ 00882000
         SLR   @00,@00                                             0446 00883000
         IC    @00,WORKNM                                          0446 00884000
         ALR   @03,@00                                             0446 00885000
         STC   @03,WORKNM                                          0446 00886000
*    WORKTWO = FLIPFLOP(WORKNM);    /*TRENDCPU AFTER SORTING @Z427VLS*/ 00887000
         LA    @14,FLIPFLOP-1(@03)                                 0447 00888000
         MVC   WORKTWO(1),0(@14)                                   0447 00889000
*    SLL(WORKTWO,4); /*SORTED TRENDCPU NOW IN FIRST FOUR BITS*/    0448 00890000
         SLR   @03,@03                                             0448 00891000
         IC    @03,WORKTWO                                         0448 00892000
         SLL   @03,4                                               0448 00893000
         STC   @03,WORKTWO                                         0448 00894000
*    TMTCPUS(J) = (TMTCPUS(J) | WORKTWO);                  /*@0099VLS*/ 00895000
         LR    @03,@15                                             0449 00896000
         AL    @03,@TF00001                                        0449 00897000
         AL    @03,@CF01603                                        0449 00898000
         OC    TMTCPUS-3(1,@03),WORKTWO                            0449 00899000
*    /*FOLLOWING IS A LAST MINUTE MANIPULATION, OCT 13, 1976, TO*/ 0450 00900000
*    /*GET 3705 ERROR TYPE TO FOLLOW TRENDCPU FOR PROPER SORTING*/ 0450 00901000
*    WORKTWO = (TMTCPUS(J) & '0F'X);                       /*@0099VLS*/ 00902000
         LR    @03,@15                                             0450 00903000
         AL    @03,@TF00001                                        0450 00904000
         AL    @03,@CF01603                                        0450 00905000
         MVC   WORKTWO(1),TMTCPUS-3(@03)                           0450 00906000
         NI    WORKTWO,X'0F'                                       0450 00907000
*    TMTCPUS(J) = (TMTCPUS(J) & 'F0'X);                    /*@0099VLS*/ 00908000
         LR    @03,@15                                             0451 00909000
         AL    @03,@TF00001                                        0451 00910000
         AL    @03,@CF01603                                        0451 00911000
         NI    TMTCPUS-3(@03),X'F0'                                0451 00912000
*    TMTITEM(J) = (TMTITEM(J) | WORKTWO);                  /*@0099VLS*/ 00913000
         AL    @15,@TF00001                                        0452 00914000
         AL    @15,@CF01604                                        0452 00915000
         OC    TMTITEM-4(1,@15),WORKTWO                            0452 00916000
*                                           /*PLACE          @Z427VLS*/ 00917000
*  END;                                                    /*@Z427VLS*/ 00918000
         AL    @06,@CF00056                                        0453 00919000
         ST    @06,J                                               0453 00920000
@DE00439 C     @06,PASSNUM                                         0453 00921000
         BNH   @DL00439                                            0453 00922000
*  IF DEBUG23 ^= ON & SORTNUM > 1 THEN /*ONLY SORT IS AT LEAST TWO*/    00923000
         TM    DEBUG23(R2),B'00000001'                             0454 00924000
         BO    @RF00454                                            0454 00925000
         L     @06,SORTNUM(,R2)                                    0454 00926000
         C     @06,@CF00056                                        0454 00927000
         BNH   @RF00454                                            0454 00928000
*  DO;  /*ENTRIES AND DEBUG DOESNT SPECIFY ORIGINAL INPUT ORDER*/  0455 00929000
*/* SORT THAT ONLY EXAMINES AN ENTRY ONCE IF DATA IS IN ORDER*/    0456 00930000
* SRTCONT = ((PASSNUM-1)*14) + SORTADR;                    /*@0099VLS*/ 00931000
         L     @06,PASSNUM                                         0456 00932000
         BCTR  @06,0                                               0456 00933000
         MH    @06,@CH00952                                        0456 00934000
         AL    @06,SORTADR(,R2)                                    0456 00935000
         ST    @06,SRTCONT                                         0456 00936000
*GENERATE REFS(TMT2,TMTKEY);                               /*@0099VLS*/ 00937000
    LA   R15,14                                                         00938000
    L    R3,SORTADR(R2)                                                 00939000
    L    R4,SRTCONT                                                     00940000
    LR   R1,R3                                                          00941000
    B    DOIT                                                           00942000
LOOPBCK1 ALR  R3,R15                                                    00943000
         CR   R3,R4                                                     00944000
         BNL  DONE                                                      00945000
DOIT     CLC  TMTKEY(7,R3),TMTKEY+14(R3)                                00946000
         BNH  LOOPBCK1                                                  00947000
         XC   TMT2(14,R3),TMT2+14(R3)                                   00948000
         XC   TMT2+14(14,R3),TMT2(R3)                                   00949000
         XC   TMT2(14,R3),TMT2+14(R3)                                   00950000
         LR   R6,R3                                                     00951000
LOOPBCK2 SR   R6,R15                                                    00952000
         CR   R6,R1                                                     00953000
         BL   LOOPBCK1                                                  00954000
         CLC  TMTKEY(7,R6),TMTKEY+14(R6)                                00955000
         BNH  LOOPBCK1                                                  00956000
         XC   TMT2+14(14,R6),TMT2(R6)                                   00957000
         XC   TMT2(14,R6),TMT2+14(R6)                                   00958000
         XC   TMT2+14(14,R6),TMT2(R6)                                   00959000
          B      LOOPBCK2            DOES IT NEED TO BE MOVED AGAIN     00960000
DONE      EQU    *                                                      00961000
* END;                                                     /*@Z427VLS*/ 00962000
*END; /*CLOSING END TO PROC SORTWO                           @Z427VLS*/ 00963000
@EL00006 DS    0H                                                  0459 00964000
@EF00006 DS    0H                                                  0459 00965000
@ER00006 LM    @14,@12,@SA00006                                    0459 00966000
         BR    @14                                                 0459 00967000
*CONTMDR: PROC; /*COUNT TEMPORARY ERRORS AND INDICATE PERMANENT */ 0460 00968000
CONTMDR  STM   @14,@12,@SA00007                                    0460 00969000
*               /*ERROR IF RECORD REPRESENTS SUCH.           @Z427VLS*/ 00970000
*BUG(4) = BUG(4) + 1; /*COUNT NUMBER OF MDR 91, 3705 RECORDS @Z427VLS*/ 00971000
         LA    @06,1                                               0461 00972000
         AL    @06,BUG+12                                          0461 00973000
         ST    @06,BUG+12                                          0461 00974000
*IF TPRMODE = LINSTAT0 THEN                                        0462 00975000
         CLI   TPRMODE(R7),X'00'                                   0462 00976000
         BNE   @RF00462                                            0462 00977000
*  DO;                                                     /*@Z427VLS*/ 00978000
*    TRENDTMP  = TRENDTMP  + ERRCT1;                   /*@Z427VLS*/     00979000
         ICM   @06,15,TRENDTMP                                     0464 00980000
         SLR   @03,@03                                             0464 00981000
         IC    @03,ERRCT1(,R7)                                     0464 00982000
         ALR   @06,@03                                             0464 00983000
         STCM  @06,15,TRENDTMP                                     0464 00984000
*    TRENDPRM  = ON; /*RECORD REPRESENTS ONE PERMANENT ERROR @0099VLS*/ 00985000
         OI    TRENDPRM,B'00000001'                                0465 00986000
*  END;                                                    /*@Z427VLS*/ 00987000
*ELSE                                                              0467 00988000
*  DO;                                                     /*@Z427VLS*/ 00989000
         B     @RC00462                                            0467 00990000
@RF00462 DS    0H                                                  0468 00991000
*    IF TPRMODE = LINSTAT1 THEN                                    0468 00992000
         CLI   TPRMODE(R7),X'01'                                   0468 00993000
         BNE   @RF00468                                            0468 00994000
* TRENDTMP = TRENDTMP + ERRCT1;                            /*@D35UGGB*/ 00995000
         ICM   @06,15,TRENDTMP                                     0469 00996000
         SLR   @03,@03                                             0469 00997000
         IC    @03,ERRCT1(,R7)                                     0469 00998000
         ALR   @06,@03                                             0469 00999000
         STCM  @06,15,TRENDTMP                                     0469 01000000
*   ELSE                                                           0470 01001000
*    IF TPRMODE = MODE86 THEN                                      0470 01002000
         B     @RC00468                                            0470 01003000
@RF00468 CLI   TPRMODE(R7),X'86'                                   0470 01004000
         BNE   @RF00470                                            0470 01005000
*       TRENDTMP = TRENDTMP + RMSSCBRY;                    /*@D3502BL*/ 01006000
         ICM   @06,15,TRENDTMP                                     0471 01007000
         LH    @03,RMSSCBRY(,R7)                                   0471 01008000
         N     @03,@CF01606                                        0471 01009000
         ALR   @06,@03                                             0471 01010000
         STCM  @06,15,TRENDTMP                                     0471 01011000
*  ELSE                                                            0472 01012000
*    DO;                                                   /*@Z427VLS*/ 01013000
         B     @RC00470                                            0472 01014000
@RF00470 DS    0H                                                  0473 01015000
*      IF TPRMODE = CHANADAP | /*CHANNEL ADAPTER ERROR       @Z427VLS*/ 01016000
*         TPRMODE = COMSCAN  | /*COMMUNICATION SCANNER ERROR @Z427VLS*/ 01017000
*         TPRMODE = IOERROR  | /*I/O INSTRUCTION EXCEPTION   @Z427VLS*/ 01018000
*         TPRMODE = UNRESOLV | /*UNRESOLVED PROGRAM LEVEL ONE */   0473 01019000
*                              /*INTERRUPT                   @Z427VLS*/ 01020000
*         TPRMODE = LINKERR |   /* LINK ERROR                @D3502BL*/ 01021000
*         TPRMODE = MODE82 THEN /* LONG FORMAT LINK ERROR    @D3502BL*/ 01022000
         CLI   TPRMODE(R7),X'10'                                   0473 01023000
         BE    @RT00473                                            0473 01024000
         CLI   TPRMODE(R7),X'11'                                   0473 01025000
         BE    @RT00473                                            0473 01026000
         CLI   TPRMODE(R7),X'12'                                   0473 01027000
         BE    @RT00473                                            0473 01028000
         CLI   TPRMODE(R7),X'13'                                   0473 01029000
         BE    @RT00473                                            0473 01030000
         CLI   TPRMODE(R7),X'02'                                   0473 01031000
         BE    @RT00473                                            0473 01032000
         CLI   TPRMODE(R7),X'82'                                   0473 01033000
         BNE   @RF00473                                            0473 01034000
@RT00473 DS    0H                                                  0474 01035000
*           TRENDPRM  = ON;                              /*@Z427VLS*/   01036000
         OI    TRENDPRM,B'00000001'                                0474 01037000
*      ELSE                                                        0475 01038000
*      DO;                                                 /*@Z427VLS*/ 01039000
         B     @RC00473                                            0475 01040000
@RF00473 DS    0H                                                  0476 01041000
*      IF TPRMODE = LINSTAT3 THEN /*IF MODE IS 03            @Z427VLS*/ 01042000
         CLI   TPRMODE(R7),X'03'                                   0476 01043000
         BNE   @RF00476                                            0476 01044000
*         DO;                                              /*@Z427VLS*/ 01045000
*           TRENDTMP  = TRENDTMP  + ERRCT1;            /*@Z427VLS*/     01046000
         ICM   @06,15,TRENDTMP                                     0478 01047000
         SLR   @03,@03                                             0478 01048000
         IC    @03,ERRCT1(,R7)                                     0478 01049000
         ALR   @06,@03                                             0478 01050000
         STCM  @06,15,TRENDTMP                                     0478 01051000
*           TRENDPRM  = ON;                              /*@Z427VLS*/   01052000
         OI    TRENDPRM,B'00000001'                                0479 01053000
*         END;                                             /*@Z427VLS*/ 01054000
*      ELSE                                                        0481 01055000
*        IF TPRMODE = MODE83 THEN /* IF MODE IS 83           @D3502BL*/ 01056000
         B     @RC00476                                            0481 01057000
@RF00476 CLI   TPRMODE(R7),X'83'                                   0481 01058000
         BNE   @RF00481                                            0481 01059000
*          DO;                                             /*@D3502BL*/ 01060000
*            TRENDTMP = TRENDTMP + RMSSCBRY;               /*@D3502BL*/ 01061000
         ICM   @06,15,TRENDTMP                                     0483 01062000
         LH    @03,RMSSCBRY(,R7)                                   0483 01063000
         N     @03,@CF01606                                        0483 01064000
         ALR   @06,@03                                             0483 01065000
         STCM  @06,15,TRENDTMP                                     0483 01066000
*            TRENDPRM = ON;                                /*@D3502BL*/ 01067000
         OI    TRENDPRM,B'00000001'                                0484 01068000
*          END;                                            /*@D3502BL*/ 01069000
*       END;                                               /*@Z427VLS*/ 01070000
@RF00481 DS    0H                                                  0486 01071000
@RC00476 DS    0H                                                  0487 01072000
*       END;                                               /*@Z427VLS*/ 01073000
@RC00473 DS    0H                                                  0488 01074000
*    END;                                                  /*@Z427VLS*/ 01075000
@RC00470 DS    0H                                                  0488 01076000
@RC00468 DS    0H                                                  0489 01077000
*IF TRENDPRM  = ON | TRENDTMP  > ZERO THEN                         0489 01078000
@RC00462 TM    TRENDPRM,B'00000001'                                0489 01079000
         BO    @RT00489                                            0489 01080000
         ICM   @06,15,TRENDTMP                                     0489 01081000
         BNP   @RF00489                                            0489 01082000
@RT00489 DS    0H                                                  0490 01083000
*  DO;                                                     /*@Z427VLS*/ 01084000
*    BUG(5) = BUG(5) + 1; /*MDRS SAVED IN TREND2             @Z427VLS*/ 01085000
         LA    @06,1                                               0491 01086000
         L     @03,BUG+16                                          0491 01087000
         ALR   @03,@06                                             0491 01088000
         ST    @03,BUG+16                                          0491 01089000
*    BUG(13) = BUG(13) + 1; /*DEVICE GROUP FIVE COUNT        @Z427VLS*/ 01090000
         AL    @06,BUG+48                                          0492 01091000
         ST    @06,BUG+48                                          0492 01092000
*    TRENDGRP  = FIVE; /*SET GROUP TO TP CNTRL             @Z427VLS*/   01093000
         MVI   TRENDGRP,X'05'                                      0493 01094000
*    WORKCUA  = (TPRCUA & ONLYCUA2);                       /*@Z427VLS*/ 01095000
         MVC   WORKCUA(2),TPRCUA(R7)                               0494 01096000
         NC    WORKCUA(2),@CB00922                                 0494 01097000
*    TRENDRT  = (TPRCUA & ONLYCUA2);                     /*@Z427VLS*/   01098000
         MVC   TRENDRT(2),TPRCUA(R7)                               0495 01099000
         NC    TRENDRT(2),@CB00922                                 0495 01100000
*    /*TRENDCUA IS 4 BITS TOO FAR TO THE RIGHT FOR NOW       @Z427VLS*/ 01101000
*    TRENDDEV  = '3705'X;                                /*@Z427VLS*/   01102000
         MVC   TRENDDEV(2),@CB01418                                0496 01103000
*    CALL SETCPU;                                          /*@Z427VLS*/ 01104000
         BAL   @14,SETCPU                                          0497 01105000
*    CALL SET3705;                                         /*@Z427VLS*/ 01106000
         BAL   @14,SET3705                                         0498 01107000
*    TRENDDAT  = TREIDX; /*SET RELATIVE DATE FOR SORTING   @Z427VLS*/   01108000
         IC    @06,TREIDX                                          0499 01109000
         STC   @06,TRENDDAT                                        0499 01110000
*  END;                                                    /*@Z427VLS*/ 01111000
*END; /*END FOR PROC COUNTMDR                                @Z427VLS*/ 01112000
@EL00007 DS    0H                                                  0501 01113000
@EF00007 DS    0H                                                  0501 01114000
@ER00007 LM    @14,@12,@SA00007                                    0501 01115000
         BR    @14                                                 0501 01116000
*COUNTOBR:PROC; /*IDENTIFY AND SUM PERMANENT AND TEMPORARY ERRORS*/     01117000
COUNTOBR STM   @14,@12,@SA00008                                    0502 01118000
*               /*FROM OBR RECORDS IN TREND2                 @Z427VLS*/ 01119000
*BUG(7) = BUG(7) + 1; /*OBR RECORDS PASSED FILTERING         @Z427VLS*/ 01120000
         LA    @06,1                                               0503 01121000
         AL    @06,BUG+24                                          0503 01122000
         ST    @06,BUG+24                                          0503 01123000
*IF WORKDEV = DEV3410 |                                            0504 01124000
*   WORKDEV = DEV3420 |                                            0504 01125000
*   WORKDEV = DEV34XX THEN                                         0504 01126000
         CLC   WORKDEV(2),@CB00896                                 0504 01127000
         BE    @RT00504                                            0504 01128000
         CLC   WORKDEV(2),@CB00898                                 0504 01129000
         BE    @RT00504                                            0504 01130000
         CLC   WORKDEV(2),@CB00900                                 0504 01131000
         BNE   @RF00504                                            0504 01132000
@RT00504 DS    0H                                                  0505 01133000
*  CALL CHECK34X; /*IF 34XX TAPE THEN USE ANOTHER ALGORITHM  @Z427VLS*/ 01134000
         BAL   @14,CHECK34X                                        0505 01135000
*ELSE /*IF NON 34XX DEVICE RECORD                            @Z427VLS*/ 01136000
*   DO;                                                    /*@Z427VLS*/ 01137000
         B     @RC00504                                            0506 01138000
@RF00504 DS    0H                                                  0507 01139000
*     IF WORKDEV = DEV3330 |                                       0507 01140000
*        WORKDEV = DEV3340 |                                       0507 01141000
*        WORKDEV = DEV3350 |                                       0507 01142000
*        WORKDEV = DEV33301 |                                      0507 01143000
*        WORKDEV = DEV23051 |                                      0507 01144000
*     OBRCLASS = '21'X |                                           0507 01145000
*        WORKDEV = DEV23052 THEN                                   0507 01146000
         CLC   WORKDEV(2),@CB00980                                 0507 01147000
         BE    @RT00507                                            0507 01148000
         CLC   WORKDEV(2),@CB00982                                 0507 01149000
         BE    @RT00507                                            0507 01150000
         CLC   WORKDEV(2),@CB00984                                 0507 01151000
         BE    @RT00507                                            0507 01152000
         CLC   WORKDEV(2),@CB00986                                 0507 01153000
         BE    @RT00507                                            0507 01154000
         CLC   WORKDEV(2),@CB00976                                 0507 01155000
         BE    @RT00507                                            0507 01156000
         CLI   OBRCLASS(R7),X'21'                                  0507 01157000
         BE    @RT00507                                            0507 01158000
         CLC   WORKDEV(2),@CB00978                                 0507 01159000
         BNE   @RF00507                                            0507 01160000
@RT00507 DS    0H                                                  0508 01161000
*       CALL CHECK33X;                                     /*@Z427VLS*/ 01162000
         BAL   @14,CHECK33X                                        0508 01163000
*     ELSE                                                         0509 01164000
*       DO;                                                /*@Z427VLS*/ 01165000
         B     @RC00507                                            0509 01166000
@RF00507 DS    0H                                                  0510 01167000
*         IF SHORTSW = YES THEN                                    0510 01168000
         TM    SHORTSW(R7),B'00100000'                             0510 01169000
         BNO   @RF00510                                            0510 01170000
*           DO;                                            /*@Z427VLS*/ 01171000
*             IF OBRSSDRC > ZERO THEN /*IF STAT COUNTERS EXIST*/   0512 01172000
         CLI   OBRSSDRC(R7),0                                      0512 01173000
         BNH   @RF00512                                            0512 01174000
*               DO;                                        /*@Z427VLS*/ 01175000
*                 ERRNUM = NULLIT; /*CLEAR WORK AREA TO ZERO @Z427VLS*/ 01176000
         MVI   ERRNUM,X'00'                                        0514 01177000
*                 ERRPLACE = (ERRPLACE | OBRSRDS); /*GET R,R ERRORS*/   01178000
         OC    ERRPLACE(1),OBRSRDS(R7)                             0515 01179000
*                 SRL(ERRPLACE,4); /*SHIFT OUT WRITE ERRORS  @Z427VLS*/ 01180000
         SLR   @06,@06                                             0516 01181000
         IC    @06,ERRPLACE                                        0516 01182000
         SRL   @06,4                                               0516 01183000
         STC   @06,ERRPLACE                                        0516 01184000
*                 TRENDTMP  = TRENDTMP  + ERRNUM;      /*@Z427VLS*/     01185000
         ICM   @06,15,TRENDTMP                                     0517 01186000
         SLR   @03,@03                                             0517 01187000
         IC    @03,ERRNUM                                          0517 01188000
         ALR   @06,@03                                             0517 01189000
         STCM  @06,15,TRENDTMP                                     0517 01190000
*                 ERRNUM = NULLIT;                         /*@Z427VLS*/ 01191000
         MVI   ERRNUM,X'00'                                        0518 01192000
*                 ERRPLACE = OBRSRDS; /*GET BOTH READ AND WRITE*/  0519 01193000
         MVC   ERRPLACE(1),OBRSRDS(R7)                             0519 01194000
*                 ERRPLACE = (ERRPLACE & NOREAD); /*REMOVE READS*/ 0520 01195000
         NI    ERRPLACE,X'0F'                                      0520 01196000
*                 TRENDTMP  = TRENDTMP  + ERRNUM;      /*@Z427VLS*/     01197000
         SLR   @03,@03                                             0521 01198000
         IC    @03,ERRNUM                                          0521 01199000
         ALR   @06,@03                                             0521 01200000
         STCM  @06,15,TRENDTMP                                     0521 01201000
*               END;                                       /*@Z427VLS*/ 01202000
*           END;                                           /*@Z427VLS*/ 01203000
*         ELSE /*LONG OBR BY DEFAULT                         @Z427VLS*/ 01204000
*           DO;                                            /*@Z427VLS*/ 01205000
         B     @RC00510                                            0524 01206000
@RF00510 DS    0H                                                  0525 01207000
*             IF DISMOUNT = ON | /*IF A DISMOUNT RECORD WITH STAT DTA*/ 01208000
*                SDRCOUNT = ON | /*SDR COUNTER DUMPED AT EOD @Z427VLS*/ 01209000
*                OBRTEMP = ON THEN /*OBR TEMPORARY ERROR FLAG ON     */ 01210000
         TM    DISMOUNT(R7),B'11000100'                            0525 01211000
         BZ    @RF00525                                            0525 01212000
*              DO;                     /*                    @ZA29956*/ 01213000
*              IF OBRLSDRC > ZERO THEN /*IF STAT CNTRS EXIST @ZA29956*/ 01214000
         CLI   OBRLSDRC(R7),0                                      0527 01215000
         BNH   @RF00527                                            0527 01216000
*               DO;                                        /*@Z427VLS*/ 01217000
*                 ERRNUM = NULLIT;                         /*@Z427VLS*/ 01218000
         MVI   ERRNUM,X'00'                                        0529 01219000
*                 ERRPLACE = (ERRPLACE | OBRLSDR); /*GET LNG R,R ERR*/  01220000
         LA    @06,64                                              0530 01221000
         ALR   @06,R7                                              0530 01222000
         SLR   @03,@03                                             0530 01223000
         IC    @03,OBRDEVDC(,R7)                                   0530 01224000
         SLA   @03,3                                               0530 01225000
         ALR   @06,@03                                             0530 01226000
         OC    ERRPLACE(1),OBRLSDR(@06)                            0530 01227000
*                 SRL(ERRPLACE,4); /*SHIFT TO ACCESS AS NUMERIC*/  0531 01228000
         SLR   @03,@03                                             0531 01229000
         IC    @03,ERRPLACE                                        0531 01230000
         SRL   @03,4                                               0531 01231000
         STC   @03,ERRPLACE                                        0531 01232000
*                 TRENDTMP  = TRENDTMP  + ERRNUM;      /*@Z427VLS*/     01233000
         ICM   @03,15,TRENDTMP                                     0532 01234000
         SLR   @00,@00                                             0532 01235000
         IC    @00,ERRNUM                                          0532 01236000
         ALR   @03,@00                                             0532 01237000
         STCM  @03,15,TRENDTMP                                     0532 01238000
*                 ERRNUM = NULLIT;                         /*@Z427VLS*/ 01239000
         MVI   ERRNUM,X'00'                                        0533 01240000
*                 ERRPLACE = OBRLSDR; /*GET READ, WRITE ERRORS*/   0534 01241000
         MVC   ERRPLACE(1),OBRLSDR(@06)                            0534 01242000
*                 ERRPLACE = (ERRPLACE & NOREAD); /*ELIM READ ERRORS*/  01243000
         NI    ERRPLACE,X'0F'                                      0535 01244000
*                 TRENDTMP  = TRENDTMP  + ERRNUM;      /*@Z427VLS*/     01245000
         SLR   @06,@06                                             0536 01246000
         IC    @06,ERRNUM                                          0536 01247000
         ALR   @03,@06                                             0536 01248000
         STCM  @03,15,TRENDTMP                                     0536 01249000
*               END;                                       /*@Z427VLS*/ 01250000
*              END;                    /*                    @ZA29956*/ 01251000
*             ELSE /*CONTINUE CHECKING TO FIND PERM ERRORS   @Z427VLS*/ 01252000
*               DO;                                        /*@Z427VLS*/ 01253000
         B     @RC00525                                            0539 01254000
@RF00525 DS    0H                                                  0540 01255000
*                 IF OBRSENS0 ^= '40'X THEN   /* IF NOT INTERV. REQ  */ 01256000
         LA    @06,64                                              0540 01257000
         ALR   @06,R7                                              0540 01258000
         SLR   @03,@03                                             0540 01259000
         IC    @03,OBRDEVDC(,R7)                                   0540 01260000
         SLA   @03,3                                               0540 01261000
         ALR   @06,@03                                             0540 01262000
         SLR   @03,@03                                             0540 01263000
         IC    @03,OBRLSDRC(,R7)                                   0540 01264000
         ALR   @06,@03                                             0540 01265000
         CLI   OBRSENS0(@06),X'40'                                 0540 01266000
         BE    @RF00540                                            0540 01267000
*                   TRENDPRM  = ON;                      /*@Z427VLS*/   01268000
         OI    TRENDPRM,B'00000001'                                0541 01269000
*               END;                                       /*@Z427VLS*/ 01270000
@RF00540 DS    0H                                                  0543 01271000
*            END;                                          /*@Z427VLS*/ 01272000
@RC00525 DS    0H                                                  0544 01273000
*         END;                                             /*@Z427VLS*/ 01274000
@RC00510 DS    0H                                                  0545 01275000
*       END;                                               /*@Z427VLS*/ 01276000
@RC00507 DS    0H                                                  0546 01277000
*    IF TRENDPRM  = ON | TRENDTMP  > ZERO THEN                     0546 01278000
@RC00504 TM    TRENDPRM,B'00000001'                                0546 01279000
         BO    @RT00546                                            0546 01280000
         ICM   @06,15,TRENDTMP                                     0546 01281000
         BNP   @RF00546                                            0546 01282000
@RT00546 DS    0H                                                  0547 01283000
*      DO;                                                 /*@Z427VLS*/ 01284000
*        BUG(8) = BUG(8) + 1; /*OBRS STORED IN TREND2        @Z427VLS*/ 01285000
         LA    @06,1                                               0548 01286000
         AL    @06,BUG+28                                          0548 01287000
         ST    @06,BUG+28                                          0548 01288000
*        CALL GROUPASN;                                    /*@Z427VLS*/ 01289000
         BAL   @14,GROUPASN                                        0549 01290000
*        TRENDRT  = WORKCUA; /*CUA IS 4 BITS RIGHT OF CORRECT POS*/     01291000
         MVC   TRENDRT(2),WORKCUA                                  0550 01292000
*      LINKDEV = (LINKDEV && LINKDEV); /*CLEAR ITEM FROM LAST VALUE*/   01293000
         XC    LINKDEV(4),LINKDEV                                  0551 01294000
*      CALL IFCDEVIC(4,WORKDEV,LINKDEV); /*GET DEVICE LABEL  @G51DGBB*/ 01295000
         L     @15,@CV01429                                        0552 01296000
         LA    @01,@AL00552                                        0552 01297000
         BALR  @14,@15                                             0552 01298000
*       TRENDDEV = DEVLABEL;  /* SET TREND2 ENTRY WITH DEVICE LABEL */  01299000
         MVC   TRENDDEV(2),DEVLABEL                                0553 01300000
*        CALL SETCPU;                                      /*@Z427VLS*/ 01301000
         BAL   @14,SETCPU                                          0554 01302000
*        TRENDDAT  = TREIDX; /*SET RELATIVE DATE FOR SORTING @0099VLS*/ 01303000
         IC    @06,TREIDX                                          0555 01304000
         STC   @06,TRENDDAT                                        0555 01305000
*      END;                                                /*@Z427VLS*/ 01306000
*  END; /*CLOSING END FOR PROC COUNTOBR                      @Z427VLS*/ 01307000
@EL00008 DS    0H                                                  0557 01308000
@EF00008 DS    0H                                                  0557 01309000
@ER00008 LM    @14,@12,@SA00008                                    0557 01310000
         BR    @14                                                 0557 01311000
*CHECK34X: PROC; /*FIND PERM, TEMP ERRORS IN 34XX DEVICES    @Z427VLS*/ 01312000
CHECK34X STM   @14,@12,12(@13)                                     0558 01313000
*     BUG(38) = BUG(38) + 1;                               /*@Z427VLS*/ 01314000
         LA    @06,1                                               0559 01315000
         AL    @06,BUG+148                                         0559 01316000
         ST    @06,BUG+148                                         0559 01317000
*     IF SHORTSW = NO THEN                                         0560 01318000
         TM    SHORTSW(R7),B'00100000'                             0560 01319000
         BNZ   @RF00560                                            0560 01320000
*       DO;                                                /*@Z427VLS*/ 01321000
*         IF DISMOUNT = ON | SDRCOUNT = ON THEN /*IF IS EITHER A */     01322000
         TM    DISMOUNT(R7),B'10000100'                            0562 01323000
         BZ    @RF00562                                            0562 01324000
*           TRENDTMP  = TRENDTMP  + OBR34CT1 + OBR34CT2;   /*@0099VLS*/ 01325000
         ICM   @06,15,TRENDTMP                                     0563 01326000
         SLR   @03,@03                                             0563 01327000
         IC    @03,OBR34CT1(,R7)                                   0563 01328000
         ALR   @06,@03                                             0563 01329000
         SLR   @03,@03                                             0563 01330000
         IC    @03,OBR34CT2(,R7)                                   0563 01331000
         ALR   @06,@03                                             0563 01332000
         STCM  @06,15,TRENDTMP                                     0563 01333000
*         ELSE /*PERM ERROR BY DEFAULT                       @Z427VLS*/ 01334000
*          IF OBRTEMP = OFF THEN /*TEMP GARBAGE RECORDS MAY EXIST*/     01335000
         B     @RC00562                                            0564 01336000
@RF00562 TM    OBRTEMP(R7),B'01000000'                             0564 01337000
         BNZ   @RF00564                                            0564 01338000
*           TRENDPRM  = ON;                              /*@Z427VLS*/   01339000
         OI    TRENDPRM,B'00000001'                                0565 01340000
*        END;                                              /*@Z427VLS*/ 01341000
@RF00564 DS    0H                                                  0566 01342000
@RC00562 DS    0H                                                  0567 01343000
*  IF TRENDTMP ^= ZERO | TRENDPRM = ON THEN                        0567 01344000
@RF00560 ICM   @06,15,TRENDTMP                                     0567 01345000
         BNZ   @RT00567                                            0567 01346000
         TM    TRENDPRM,B'00000001'                                0567 01347000
         BNO   @RF00567                                            0567 01348000
@RT00567 DS    0H                                                  0568 01349000
*        BUG(39) = BUG(39) + 1;                            /*@Z427VLS*/ 01350000
         LA    @06,1                                               0568 01351000
         AL    @06,BUG+152                                         0568 01352000
         ST    @06,BUG+152                                         0568 01353000
*END; /*CLOSING END TO CHECK34X                              @Z427VLS*/ 01354000
@EL00009 DS    0H                                                  0569 01355000
@EF00009 DS    0H                                                  0569 01356000
@ER00009 LM    @14,@12,12(@13)                                     0569 01357000
         BR    @14                                                 0569 01358000
*CHECK33X: PROC;                                           /*@Z427VLS*/ 01359000
CHECK33X STM   @14,@12,12(@13)                                     0570 01360000
*BUG(36) = BUG(36) + 1;                                    /*@Z427VLS*/ 01361000
         LA    @06,1                                               0571 01362000
         AL    @06,BUG+140                                         0571 01363000
         ST    @06,BUG+140                                         0571 01364000
*IF (OBRSENS1 & PERMBIT) = PERMBIT THEN                            0572 01365000
         LA    @06,64                                              0572 01366000
         ALR   @06,R7                                              0572 01367000
         SLR   @03,@03                                             0572 01368000
         IC    @03,OBRDEVDC(,R7)                                   0572 01369000
         SLA   @03,3                                               0572 01370000
         ALR   @06,@03                                             0572 01371000
         SLR   @03,@03                                             0572 01372000
         IC    @03,OBRLSDRC(,R7)                                   0572 01373000
         ALR   @06,@03                                             0572 01374000
         MVC   @TS00001(1),OBRSENS1(@06)                           0572 01375000
         NI    @TS00001,B'10000000'                                0572 01376000
         CLI   @TS00001,B'10000000'                                0572 01377000
         BNE   @RF00572                                            0572 01378000
*  TRENDPRM  = ON;                                       /*@Z427VLS*/   01379000
         OI    TRENDPRM,B'00000001'                                0573 01380000
*ELSE                                                              0574 01381000
*  DO;                                                     /*@Z427VLS*/ 01382000
         B     @RC00572                                            0574 01383000
@RF00572 DS    0H                                                  0575 01384000
*    IF OBRTEMP = ON THEN                                          0575 01385000
         TM    OBRTEMP(R7),B'01000000'                             0575 01386000
         BNO   @RF00575                                            0575 01387000
*      TRENDTMP  = TRENDTMP  + 1;                      /*@Z427VLS*/     01388000
         LA    @06,1                                               0576 01389000
         ICM   @03,15,TRENDTMP                                     0576 01390000
         ALR   @06,@03                                             0576 01391000
         STCM  @06,15,TRENDTMP                                     0576 01392000
*    ELSE                                                          0577 01393000
*      TRENDPRM  = ON;                                   /*@Z427VLS*/   01394000
         B     @RC00575                                            0577 01395000
@RF00575 OI    TRENDPRM,B'00000001'                                0577 01396000
*   END;                                                   /*@Z427VLS*/ 01397000
@RC00575 DS    0H                                                  0579 01398000
*IF TRENDTMP  = 1 | TRENDPRM  = ON THEN                            0579 01399000
@RC00572 CLC   TRENDTMP(4),@CF00056                                0579 01400000
         BE    @RT00579                                            0579 01401000
         TM    TRENDPRM,B'00000001'                                0579 01402000
         BNO   @RF00579                                            0579 01403000
@RT00579 DS    0H                                                  0580 01404000
*  BUG(37) = BUG(37) + 1;                                  /*@Z427VLS*/ 01405000
         LA    @06,1                                               0580 01406000
         AL    @06,BUG+144                                         0580 01407000
         ST    @06,BUG+144                                         0580 01408000
*END; /*CLOSING END TO CHECK33X                              @Z427VLS*/ 01409000
@EL00010 DS    0H                                                  0581 01410000
@EF00010 DS    0H                                                  0581 01411000
@ER00010 LM    @14,@12,12(@13)                                     0581 01412000
         BR    @14                                                 0581 01413000
*GROUPASN: PROC; /*DETERMINE DEVICE GROUP FOR TREND REPORT   @Z427VLS*/ 01414000
GROUPASN STM   @14,@12,12(@13)                                     0582 01415000
*                /*SET TRENDGRP IN TABLE TREND2 TO THE ENTRY NUMBER*/   01416000
*                /*IN TABLE DEVGROUP RELATING TO THIS DEVICE GROUP*/    01417000
*IF (WORKDEV1 = HEX08 & WORKDEV2 ^= HEX42) |                       0583 01418000
*   WORKDEV  = HEX100C |                                           0583 01419000
*   WORKDEV  = HEX1008 THEN                                        0583 01420000
         CLI   WORKDEV1,X'08'                                      0583 01421000
         BNE   @GL00026                                            0583 01422000
         CLI   WORKDEV2,X'42'                                      0583 01423000
         BNE   @RT00583                                            0583 01424000
@GL00026 CLC   WORKDEV(2),@CB00902                                 0583 01425000
         BE    @RT00583                                            0583 01426000
         CLC   WORKDEV(2),@CB00904                                 0583 01427000
         BNE   @RF00583                                            0583 01428000
@RT00583 DS    0H                                                  0584 01429000
*  DO;                                                     /*@Z427VLS*/ 01430000
*    BUG(9) = BUG(9) + 1;                                  /*@Z427VLS*/ 01431000
         LA    @06,1                                               0585 01432000
         AL    @06,BUG+32                                          0585 01433000
         ST    @06,BUG+32                                          0585 01434000
*    TRENDGRP  = ONE;  /*CONSOLE AND UNIT RECORD GROUP     @Z427VLS*/   01435000
         MVI   TRENDGRP,X'01'                                      0586 01436000
*  END;                                                    /*@Z427VLS*/ 01437000
*ELSE                                                              0588 01438000
*  DO;                                                     /*@Z427VLS*/ 01439000
         B     @RC00583                                            0588 01440000
@RF00583 DS    0H                                                  0589 01441000
*    IF WORKDEV1 = HEX10 THEN                                      0589 01442000
         CLI   WORKDEV1,X'10'                                      0589 01443000
         BNE   @RF00589                                            0589 01444000
*      DO;                                                 /*@Z427VLS*/ 01445000
*        TRENDGRP  = FOUR;                               /*@Z427VLS*/   01446000
         MVI   TRENDGRP,X'04'                                      0591 01447000
*        BUG(12) = BUG(12) + 1;                            /*@Z427VLS*/ 01448000
         LA    @06,1                                               0592 01449000
         AL    @06,BUG+44                                          0592 01450000
         ST    @06,BUG+44                                          0592 01451000
*      END;                                                /*@Z427VLS*/ 01452000
*    ELSE                                                          0594 01453000
*      DO;                                                 /*@Z427VLS*/ 01454000
         B     @RC00589                                            0594 01455000
@RF00589 DS    0H                                                  0595 01456000
*        IF WORKDEV1 = HEX20 | WORKDEV1 = '21'X |          /*@D35UGGB*/ 01457000
*           WORKDEV = HEX0842 THEN                                 0595 01458000
         CLI   WORKDEV1,X'20'                                      0595 01459000
         BE    @RT00595                                            0595 01460000
         CLI   WORKDEV1,X'21'                                      0595 01461000
         BE    @RT00595                                            0595 01462000
         CLC   WORKDEV(2),@CB00906                                 0595 01463000
         BNE   @RF00595                                            0595 01464000
@RT00595 DS    0H                                                  0596 01465000
*          DO;                                             /*@Z427VLS*/ 01466000
*            TRENDGRP  = TWO;                            /*@Z427VLS*/   01467000
         MVI   TRENDGRP,X'02'                                      0597 01468000
*            BUG(10) = BUG(10) + 1;                        /*@Z427VLS*/ 01469000
         LA    @06,1                                               0598 01470000
         AL    @06,BUG+36                                          0598 01471000
         ST    @06,BUG+36                                          0598 01472000
*          END;                                            /*@Z427VLS*/ 01473000
*        ELSE                                                      0600 01474000
*         DO;                                              /*@Z427VLS*/ 01475000
         B     @RC00595                                            0600 01476000
@RF00595 DS    0H                                                  0601 01477000
*           IF WORKDEV1 = HEX40 THEN                               0601 01478000
         CLI   WORKDEV1,X'40'                                      0601 01479000
         BNE   @RF00601                                            0601 01480000
*             DO;                                          /*@Z427VLS*/ 01481000
*               TRENDGRP  = FIVE;                        /*@Z427VLS*/   01482000
         MVI   TRENDGRP,X'05'                                      0603 01483000
*               BUG(13) = BUG(13) + 1;                     /*@Z427VLS*/ 01484000
         LA    @06,1                                               0604 01485000
         AL    @06,BUG+48                                          0604 01486000
         ST    @06,BUG+48                                          0604 01487000
*             END;                                         /*@Z427VLS*/ 01488000
*           ELSE                                                   0606 01489000
*             DO;                                          /*@Z427VLS*/ 01490000
         B     @RC00601                                            0606 01491000
@RF00601 DS    0H                                                  0607 01492000
*               IF WORKDEV1 = HEX42 |                              0607 01493000
*                  WORKDEV1 = HEX44 THEN                           0607 01494000
         CLI   WORKDEV1,X'42'                                      0607 01495000
         BE    @RT00607                                            0607 01496000
         CLI   WORKDEV1,X'44'                                      0607 01497000
         BNE   @RF00607                                            0607 01498000
@RT00607 DS    0H                                                  0608 01499000
*                 DO;                                      /*@Z427VLS*/ 01500000
*                   TRENDGRP  = SIX;                     /*@Z427VLS*/   01501000
         MVI   TRENDGRP,X'06'                                      0609 01502000
*                   BUG(14) = BUG(14) + 1;                 /*@Z427VLS*/ 01503000
         LA    @06,1                                               0610 01504000
         AL    @06,BUG+52                                          0610 01505000
         ST    @06,BUG+52                                          0610 01506000
*                 END;                                     /*@Z427VLS*/ 01507000
*               ELSE                                               0612 01508000
*                 DO;                                      /*@Z427VLS*/ 01509000
         B     @RC00607                                            0612 01510000
@RF00607 DS    0H                                                  0613 01511000
*                   IF WORKDEV1 = HEX80 THEN                       0613 01512000
         CLI   WORKDEV1,X'80'                                      0613 01513000
         BNE   @RF00613                                            0613 01514000
*                     DO;                                  /*@Z427VLS*/ 01515000
*                       TRENDGRP  = THREE;               /*@Z427VLS*/   01516000
         MVI   TRENDGRP,X'03'                                      0615 01517000
*                       BUG(11) = BUG(11) + 1;             /*@Z427VLS*/ 01518000
         LA    @06,1                                               0616 01519000
         AL    @06,BUG+40                                          0616 01520000
         ST    @06,BUG+40                                          0616 01521000
*                     END;                                 /*@Z427VLS*/ 01522000
*                 END;                                     /*@Z427VLS*/ 01523000
*             END;                                         /*@Z427VLS*/ 01524000
*          END;                                            /*@Z427VLS*/ 01525000
*      END;                                                /*@Z427VLS*/ 01526000
*     END;                                                 /*@Z427VLS*/ 01527000
*    END; /*CLOSING END TO GROUPASN PROC                     @Z427VLS*/ 01528000
@EL00011 DS    0H                                                  0623 01529000
@EF00011 DS    0H                                                  0623 01530000
@ER00011 LM    @14,@12,12(@13)                                     0623 01531000
         BR    @14                                                 0623 01532000
*SET3705: PROC;                                            /*@Z427VLS*/ 01533000
SET3705  STM   @14,@12,12(@13)                                     0624 01534000
*  IF TPRMODE = LINKERR |                                          0625 01535000
*     TPRMODE = MODE82 |                                           0625 01536000
*     TPRMODE = MODE83 |                                           0625 01537000
*     TPRMODE = MODE86 |                                           0625 01538000
*     TPRMODE = LINSTAT1 |                                         0625 01539000
*     TPRMODE = LINSTAT0 |                                         0625 01540000
*     TPRMODE = LINSTAT3 THEN                                      0625 01541000
         CLI   TPRMODE(R7),X'02'                                   0625 01542000
         BE    @RT00625                                            0625 01543000
         CLI   TPRMODE(R7),X'82'                                   0625 01544000
         BE    @RT00625                                            0625 01545000
         CLI   TPRMODE(R7),X'83'                                   0625 01546000
         BE    @RT00625                                            0625 01547000
         CLI   TPRMODE(R7),X'86'                                   0625 01548000
         BE    @RT00625                                            0625 01549000
         CLI   TPRMODE(R7),X'01'                                   0625 01550000
         BE    @RT00625                                            0625 01551000
         CLI   TPRMODE(R7),X'00'                                   0625 01552000
         BE    @RT00625                                            0625 01553000
         CLI   TPRMODE(R7),X'03'                                   0625 01554000
         BNE   @RF00625                                            0625 01555000
@RT00625 DS    0H                                                  0626 01556000
*    TRENDITM = (TRENDITM |   '20'X);                  /*@Z427VLS*/     01557000
         OI    TRENDITM,X'20'                                      0626 01558000
*  ELSE IF TPRMODE = IOERROR |                                     0627 01559000
*          TPRMODE = UNRESOLV THEN                                 0627 01560000
         B     @RC00625                                            0627 01561000
@RF00625 CLI   TPRMODE(R7),X'12'                                   0627 01562000
         BE    @RT00627                                            0627 01563000
         CLI   TPRMODE(R7),X'13'                                   0627 01564000
         BNE   @RF00627                                            0627 01565000
@RT00627 DS    0H                                                  0628 01566000
*          TRENDITM = (TRENDITM |   '10'X);            /*@Z427VLS*/     01567000
         OI    TRENDITM,X'10'                                      0628 01568000
*  /*IF TPRMODE IS EQUAL TO DEFAULT OF COMSCAN OR CHANADAP ERRORS*/     01569000
*  /*TREN37 NEED NOT BE SET AS ITS CORRECT VALUE IS ZERO. TRENDRT */    01570000
*  /*IS SET HERE AS THE STUPID COMPILER WILL NOT ACCESS TREN37*/   0629 01571000
*END;                                                      /*@Z427VLS*/ 01572000
@EL00012 DS    0H                                                  0629 01573000
@EF00012 DS    0H                                                  0629 01574000
@ER00012 LM    @14,@12,12(@13)                                     0629 01575000
         BR    @14                                                 0629 01576000
*SETCPU: PROC;                                             /*@Z427VLS*/ 01577000
SETCPU   STM   @14,@12,@SA00013                                    0630 01578000
*/* SET NEW AND OLD CPUS IN TREND2. IF SHARED IO, ADJUST TRENCPU AND*/  01579000
*/*AND TRENCUA TO THE RESPECTIVE BASE ITEMS.                 @Z427VLS*/ 01580000
*CALL TREADR;   /*CREATE EVTABLE, TRENDONE ENTRIES IF UNIQUE CPU    */  01581000
         BAL   @14,TREADR                                          0631 01582000
*MISSW = OFF;                                              /*@Z427VLS*/ 01583000
         NI    MISSW,B'11111101'                                   0632 01584000
*DO J = 1 BY 1 TO EVNUM WHILE MISSW = OFF;                 /*@Z427VLS*/ 01585000
         LA    @06,1                                               0633 01586000
         ST    @06,J                                               0633 01587000
         B     @DE00633                                            0633 01588000
@DL00633 TM    MISSW,B'00000010'                                   0633 01589000
         BNZ   @DC00633                                            0633 01590000
*  IF EVSERIAL(J) = LRTCPUS | EVSERIAL(J) = 'FFFFFF'X THEN         0634 01591000
         MH    @06,@CH00081                                        0634 01592000
         L     @03,EVPTR(,R2)                                      0634 01593000
         ST    @06,@TF00001                                        0634 01594000
         ALR   @06,@03                                             0634 01595000
         CLC   EVSERIAL-6(3,@06),LRTCPUS(R7)                       0634 01596000
         BE    @RT00634                                            0634 01597000
         AL    @03,@TF00001                                        0634 01598000
         CLC   EVSERIAL-6(3,@03),@CB00237                          0634 01599000
         BNE   @RF00634                                            0634 01600000
@RT00634 DS    0H                                                  0635 01601000
*      /*EVSERIAL ONLY = FOXES IF 16TH OR HIGHER CPU IN INPUT*/    0635 01602000
*    DO;                                                   /*@Z427VLS*/ 01603000
*      MISSW = ON; /*LOOK KICK OUT FLAG IF A MATCH IS FOUND  @Z427VLS*/ 01604000
         OI    MISSW,B'00000010'                                   0636 01605000
*      WORKNM = J - 1; /*SET TO EVTABLE ENTRY NUMBER MINUS ONE*/   0637 01606000
         L     @06,J                                               0637 01607000
         BCTR  @06,0                                               0637 01608000
         STC   @06,WORKNM                                          0637 01609000
*      TRENCPUS  = WORKBYTE; /*REFERENCE WORKNM VIA BIT STRING AND*/    01610000
         MVC   TRENCPUS(1),WORKBYTE                                0638 01611000
*                             /*SET SYSOLD EQUAL TO IT       @Z427VLS*/ 01612000
*      IF SHAREPTR ^= ZERO THEN                                    0639 01613000
         L     @06,SHAREPTR(,R2)                                   0639 01614000
         LTR   @06,@06                                             0639 01615000
         BZ    @RF00639                                            0639 01616000
*        DO;                                               /*@Z427VLS*/ 01617000
*          SHAREYES = NO;                                  /*@Z427VLS*/ 01618000
         NI    SHAREYES,B'10111111'                                0641 01619000
*          DO K = 1 BY 1 TO SHARENUM WHILE SHAREYES = NO;  /*@Z427VLS*/ 01620000
         LA    @06,1                                               0642 01621000
         ST    @06,K                                               0642 01622000
         B     @DE00642                                            0642 01623000
@DL00642 TM    SHAREYES,B'01000000'                                0642 01624000
         BNZ   @DC00642                                            0642 01625000
*            IF SHAREFLG(K)=LETTERS&LRTCPUS=SHARSERA(K) THEN       0643 01626000
         SLA   @06,4                                               0643 01627000
         L     @03,SHAREPTR(,R2)                                   0643 01628000
         ST    @06,@TF00001                                        0643 01629000
         ALR   @06,@03                                             0643 01630000
         AL    @06,@CF01375                                        0643 01631000
         CLC   SHAREFLG-2(1,@06),LETTERS                           0643 01632000
         BNE   @RF00643                                            0643 01633000
         LR    @06,@03                                             0643 01634000
         AL    @06,@TF00001                                        0643 01635000
         AL    @06,@CF01599                                        0643 01636000
         CLC   LRTCPUS(3,R7),SHARSERA-10(@06)                      0643 01637000
         BNE   @RF00643                                            0643 01638000
*              IF WORKCUA>=SHRCUAAL(K)&WORKCUA<=SHRCUAAH(K) THEN   0644 01639000
         LR    @06,@03                                             0644 01640000
         AL    @06,@TF00001                                        0644 01641000
         AL    @06,@CF01609                                        0644 01642000
         CLC   WORKCUA(2),SHRCUAAL-13(@06)                         0644 01643000
         BL    @RF00644                                            0644 01644000
         LR    @06,@03                                             0644 01645000
         AL    @06,@TF00001                                        0644 01646000
         BCTR  @06,0                                               0644 01647000
         CLC   WORKCUA(2),SHRCUAAH-15(@06)                         0644 01648000
         BH    @RF00644                                            0644 01649000
*                DO;                                       /*@D3506GB*/ 01650000
*                   TRENDRT=SHRCUABL(K)+WORKCUA-SHRCUAAL(K);       0646 01651000
         LR    @06,@03                                             0646 01652000
         AL    @06,@TF00001                                        0646 01653000
         AL    @06,@CF01604                                        0646 01654000
         SLR   @00,@00                                             0646 01655000
         ICM   @00,3,SHRCUABL-6(@06)                               0646 01656000
         LH    @06,WORKCUA                                         0646 01657000
         N     @06,@CF01606                                        0646 01658000
         ALR   @00,@06                                             0646 01659000
         AL    @03,@TF00001                                        0646 01660000
         AL    @03,@CF01609                                        0646 01661000
         SLR   @06,@06                                             0646 01662000
         ICM   @06,3,SHRCUAAL-13(@03)                              0646 01663000
         SLR   @00,@06                                             0646 01664000
         STCM  @00,3,TRENDRT                                       0646 01665000
*                        MISSW1 = OFF;                     /*@Z427VLS*/ 01666000
         NI    MISSW1,B'11111110'                                  0647 01667000
*                        DO L = 1 BY 1 TO EVNUM WHILE MISSW1 = OFF;     01668000
         LA    @06,1                                               0648 01669000
         ST    @06,L                                               0648 01670000
         B     @DE00648                                            0648 01671000
@DL00648 TM    MISSW1,B'00000001'                                  0648 01672000
         BNZ   @DC00648                                            0648 01673000
*                          IF EVSERIAL(L) = SHARSERB(K) |          0649 01674000
*                             EVSERIAL(L) = 'FFFFFF'X THEN         0649 01675000
         MH    @06,@CH00081                                        0649 01676000
         L     @03,EVPTR(,R2)                                      0649 01677000
         L     @15,K                                               0649 01678000
         SLA   @15,4                                               0649 01679000
         L     @14,SHAREPTR(,R2)                                   0649 01680000
         ST    @06,@TF00001                                        0649 01681000
         ALR   @06,@03                                             0649 01682000
         ALR   @14,@15                                             0649 01683000
         AL    @14,@CF01611                                        0649 01684000
         CLC   EVSERIAL-6(3,@06),SHARSERB-3(@14)                   0649 01685000
         BE    @RT00649                                            0649 01686000
         AL    @03,@TF00001                                        0649 01687000
         CLC   EVSERIAL-6(3,@03),@CB00237                          0649 01688000
         BNE   @RF00649                                            0649 01689000
@RT00649 DS    0H                                                  0650 01690000
*                            DO;                           /*@Z427VLS*/ 01691000
*                              WORKNM = L - 1; /*SET TO EVTABLE ENT.*/  01692000
         L     @06,L                                               0651 01693000
         BCTR  @06,0                                               0651 01694000
         STC   @06,WORKNM                                          0651 01695000
*                                             /*NUMBER MINUS ONE*/ 0652 01696000
*                              MISSW1 = ON;                /*@Z427VLS*/ 01697000
         OI    MISSW1,B'00000001'                                  0652 01698000
*                            END;                          /*@Z427VLS*/ 01699000
*                        END;                              /*@Z427VLS*/ 01700000
@RF00649 LA    @06,1                                               0654 01701000
         AL    @06,L                                               0654 01702000
         ST    @06,L                                               0654 01703000
@DE00648 L     @03,EVPTR(,R2)                                      0654 01704000
         CH    @06,EVNUM(,@03)                                     0654 01705000
         BNH   @DL00648                                            0654 01706000
@DC00648 DS    0H                                                  0655 01707000
*                        SHAREYES = ON;                    /*@Z427VLS*/ 01708000
         OI    SHAREYES,B'01000000'                                0655 01709000
*                 END;                                     /*@Z427VLS*/ 01710000
*           END;                                           /*@Z427VLS*/ 01711000
@RF00644 DS    0H                                                  0657 01712000
@RF00643 LA    @06,1                                               0657 01713000
         AL    @06,K                                               0657 01714000
         ST    @06,K                                               0657 01715000
@DE00642 L     @03,SHAREPTR(,R2)                                   0657 01716000
         CH    @06,SHARENUM(,@03)                                  0657 01717000
         BNH   @DL00642                                            0657 01718000
@DC00642 DS    0H                                                  0658 01719000
*        END;                                              /*@Z427VLS*/ 01720000
*        SLL(TRENDRT ,4); /*SHIFT INTO TRENDCUA            @Z427VLS*/   01721000
@RF00639 SLR   @06,@06                                             0659 01722000
         ICM   @06,3,TRENDRT                                       0659 01723000
         SLL   @06,4                                               0659 01724000
         STCM  @06,3,TRENDRT                                       0659 01725000
*        SLL(WORKNM,4); /*SHIFT BASE CPU INDEX TO BYTE BOUNDARY*/  0660 01726000
         SLR   @06,@06                                             0660 01727000
         IC    @06,WORKNM                                          0660 01728000
         SLL   @06,4                                               0660 01729000
         STC   @06,WORKNM                                          0660 01730000
*        TRENCPUS  = (TRENCPUS  | WORKBYTE); /*SET TRENCPU   @0099VLS*/ 01731000
         OC    TRENCPUS(1),WORKBYTE                                0661 01732000
*     END;                                                 /*@Z427VLS*/ 01733000
*   END;                                                   /*@Z427VLS*/ 01734000
@RF00634 LA    @06,1                                               0663 01735000
         AL    @06,J                                               0663 01736000
         ST    @06,J                                               0663 01737000
@DE00633 L     @03,EVPTR(,R2)                                      0663 01738000
         CH    @06,EVNUM(,@03)                                     0663 01739000
         BNH   @DL00633                                            0663 01740000
@DC00633 DS    0H                                                  0664 01741000
*END;/*CLOSING END TO SETCPU                                 @Z427VLS*/ 01742000
@EL00013 DS    0H                                                  0664 01743000
@EF00013 DS    0H                                                  0664 01744000
@ER00013 LM    @14,@12,@SA00013                                    0664 01745000
         BR    @14                                                 0664 01746000
*ENDOFILE: PROC; /*SORT EVTABLE, TRENDONE, TREND2, FREE EXCESS*/   0665 01747000
ENDOFILE STM   @14,@12,@SA00014                                    0665 01748000
*                /*TREND2 CORE, PRINT TOURIST INFO, SET RETURN CODES*/  01749000
*RESPECIFY(R15) RESTRICTED;                                /*@Z427VLS*/ 01750000
*IF R15 = OVERFLOW & PHIST = ON THEN /*IF DIRECTWK OVERFLOW AND */ 0667 01751000
         C     R15,@CF00036                                        0667 01752000
         BNE   @RF00667                                            0667 01753000
         TM    PHIST(R2),B'00100000'                               0667 01754000
         BNO   @RF00667                                            0667 01755000
*  DO; /*HISTORY INPUT THEN IFCIOHND HAS NOT CLOSED HISTORY INPUT*/     01756000
*    CLOSEIO = (CLOSEIO && CLOSEIO); /*DONT CLOSE OTHER DATA SETS*/     01757000
         XC    CLOSEIO(2,R2),CLOSEIO(R2)                           0669 01758000
*    CACCIN = ON; /*SET ACCIN CLOSE REQUESTED FLAG           @Z427VLS*/ 01759000
         OI    CACCIN(R2),B'00010000'                              0670 01760000
*    CALL IOHND(IOCLOSE); /*REQUEST CLOSE                    @Z427VLS*/ 01761000
         L     @15,ADIOHND(,R2)                                    0671 01762000
         LA    @01,@AL00671                                        0671 01763000
         BALR  @14,@15                                             0671 01764000
*  END;                                                    /*@Z427VLS*/ 01765000
*IF MAXENT <= ENTRIES & ERROR ^= ENDFILE & GETFAIL = NO    /*@ZA34166*/ 01766000
*  THEN                                                    /*@ZA34166*/ 01767000
@RF00667 L     @14,MAXENT                                          0673 01768000
         C     @14,ENTRIES                                         0673 01769000
         BH    @RF00673                                            0673 01770000
         CLC   ERROR(4),@CF00065                                   0673 01771000
         BE    @RF00673                                            0673 01772000
         TM    GETFAIL,B'00000100'                                 0673 01773000
         BNZ   @RF00673                                            0673 01774000
*  DO;            /*WORLD, DONT TELL EREP1, DONT LET LOGREC BE RESET*/  01775000
*     ZEROALL = NO;                                        /*@Z427VLS*/ 01776000
         NI    ZEROALL(R2),B'10111111'                             0675 01777000
*     MSGNO = 3;                                           /*@Z427VLS*/ 01778000
         MVI   MSGNO,X'03'                                         0676 01779000
*     CALL ERRMSG;                                         /*@Z427VLS*/ 01780000
         BAL   @14,ERRMSG                                          0677 01781000
*     ERROR = ZERO;                                        /*@0001VLS*/ 01782000
         SLR   @14,@14                                             0678 01783000
         ST    @14,ERROR                                           0678 01784000
*     IF PHIST = ON THEN /*IF HISTORY INPUT                  @Z427VLS*/ 01785000
         TM    PHIST(R2),B'00100000'                               0679 01786000
         BNO   @RF00679                                            0679 01787000
*       DO;                                                /*@Z427VLS*/ 01788000
*         CLOSEIO = (CLOSEIO && CLOSEIO);                  /*@Z427VLS*/ 01789000
         XC    CLOSEIO(2,R2),CLOSEIO(R2)                           0681 01790000
*         CACCIN = ON;                                     /*@Z427VLS*/ 01791000
         OI    CACCIN(R2),B'00010000'                              0682 01792000
*         CALL IOHND(IOCLOSE);                             /*@Z427VLS*/ 01793000
         L     @15,ADIOHND(,R2)                                    0683 01794000
         LA    @01,@AL00683                                        0683 01795000
         BALR  @14,@15                                             0683 01796000
*       END;                                               /*@G51DGBB*/ 01797000
* END;                                                     /*@G51DGBB*/ 01798000
@RF00679 DS    0H                                                  0686 01799000
* IF ERROR = FOUR THEN                                             0686 01800000
@RF00673 CLC   ERROR(4),@CF00065                                   0686 01801000
         BNE   @RF00686                                            0686 01802000
*   DO;                                                    /*@G51DGBB*/ 01803000
*     R15 = ZERO;                                          /*@G51DGBB*/ 01804000
         SLR   R15,R15                                             0688 01805000
*     ERROR = ZERO;                                        /*@G51DGBB*/ 01806000
         SLR   @14,@14                                             0689 01807000
         ST    @14,ERROR                                           0689 01808000
*   END;                                                   /*@G51DGBB*/ 01809000
*/*THE FOLLOWING CODE MUST BE ADDED TO THE END OF FILE PROC BEFORE*/    01810000
*/*CLOSING ACCDEV TO WRITE FRAMES TO ACCDEV, IF NECESSARY    @G51DGBB*/ 01811000
*IF R15 < TWELVE &             /*IF NON TERMINATE RETURN CODE */   0691 01812000
*   FRAMEPTR ^= ZERO THEN      /*IF FRAMETAB IS ALLOCATED    @G51DGBB*/ 01813000
@RF00686 C     R15,@CF00032                                        0691 01814000
         BNL   @RF00691                                            0691 01815000
         SLR   @14,@14                                             0691 01816000
         L     @06,FRAMEPTR(,R2)                                   0691 01817000
         CR    @06,@14                                             0691 01818000
         BE    @RF00691                                            0691 01819000
* DO;                                                      /*@G51DGBB*/ 01820000
*    IF  FRAMENUM > ZERO THEN /* IF FRAMETAB ENTRIES BUILD.  @G51DGBB*/ 01821000
         C     @14,FRAMENUM(,@06)                                  0693 01822000
         BNL   @RF00693                                            0693 01823000
*      DO;                                                 /*@G51DGBB*/ 01824000
*         IF PHIST = ON THEN /*IF DIRECTWK WAS USED TO STORE FRAMES */  01825000
         TM    PHIST(R2),B'00100000'                               0695 01826000
         BNO   @RF00695                                            0695 01827000
*           DO;                                            /*@G51DGBB*/ 01828000
*             CLOSEIO = (CLOSEIO && CLOSEIO); /*ZERO CLOSE FLAGS*/ 0697 01829000
         XC    CLOSEIO(2,R2),CLOSEIO(R2)                           0697 01830000
*             CDRCTWRK = ON;      /*INDICATE CLOSE OF DIRECTWK FOR  */  01831000
         OI    CDRCTWRK(R2),B'00000010'                            0698 01832000
*             CALL IOHND(IOCLOSE); /*WRITING, IMPLICITLY OPENED FOR RD* 01833000
         L     @15,ADIOHND(,R2)                                    0699 01834000
         LA    @01,@AL00699                                        0699 01835000
         BALR  @14,@15                                             0699 01836000
*           END;                                           /*@G51DGBB*/ 01837000
*         DO A = 1 BY 1 TO FRAMENUM WHILE R15 < FOUR;       /*SETS. */  01838000
@RF00695 LA    @14,1                                               0701 01839000
         ST    @14,A                                               0701 01840000
         B     @DE00701                                            0701 01841000
@DL00701 C     R15,@CF00065                                        0701 01842000
         BNL   @DC00701                                            0701 01843000
*           IF FRAMETYP(A) = ALLALL THEN /*IF COMPLETE SET   @G51DGBB*/ 01844000
         MH    @14,@CH00227                                        0702 01845000
         L     @06,FRAMEPTR(,R2)                                   0702 01846000
         ST    @14,@TF00001                                        0702 01847000
         ALR   @14,@06                                             0702 01848000
         AL    @14,@CF01614                                        0702 01849000
         CLI   FRAMETYP-17(@14),X'FF'                              0702 01850000
         BNE   @RF00702                                            0702 01851000
*             DO;                                          /*@G51DGBB*/ 01852000
*               LISTPTR = FRAMLOCM(A);   /*ESTABLISH LISTLOC ADDR.*/    01853000
         L     @14,@TF00001                                        0704 01854000
         AL    @06,@CF01615                                        0704 01855000
         L     @14,FRAMLOCM-20(@14,@06)                            0704 01856000
         ST    @14,LISTPTR                                         0704 01857000
*               DO Z = 1 BY 1 TO LISTNUM WHILE R15 < FOUR ;/*@G51DGBB*/ 01858000
         LA    @14,1                                               0705 01859000
         ST    @14,Z                                               0705 01860000
         B     @DE00705                                            0705 01861000
@DL00705 C     R15,@CF00065                                        0705 01862000
         BNL   @DC00705                                            0705 01863000
*                 RECCCHHR = LISTCCHR(Z);  /*GET ALL MCH FRAMES*/  0706 01864000
         MH    @14,@CH00079                                        0706 01865000
         L     @06,LISTPTR                                         0706 01866000
         ALR   @06,@14                                             0706 01867000
         BCTR  @06,0                                               0706 01868000
         MVC   RECCCHHR(5,R2),LISTCCHR-4(@06)                      0706 01869000
*                 CALL IOHND(READIRCT);    /*READ FRAME FROM DIRECTWK*/ 01870000
         L     @15,ADIOHND(,R2)                                    0707 01871000
         LA    @01,@AL00707                                        0707 01872000
         BALR  @14,@15                                             0707 01873000
*                 IF R15 = ZERO THEN       /*WRITE FRAME TO ACCDEV*/    01874000
         LTR   R15,R15                                             0708 01875000
         BNZ   @RF00708                                            0708 01876000
*                   CALL IOHND(RITEHIST);                  /*@G51DGBB*/ 01877000
         L     @15,ADIOHND(,R2)                                    0709 01878000
         LA    @01,@AL00709                                        0709 01879000
         BALR  @14,@15                                             0709 01880000
*              END;                                        /*@G51DGBB*/ 01881000
@RF00708 LA    @14,1                                               0710 01882000
         AL    @14,Z                                               0710 01883000
         ST    @14,Z                                               0710 01884000
@DE00705 L     @06,LISTPTR                                         0710 01885000
         C     @14,LISTNUM(,@06)                                   0710 01886000
         BNH   @DL00705                                            0710 01887000
@DC00705 DS    0H                                                  0711 01888000
*              IF R15 = ZERO THEN /*IF NO ACCDEV WRITE ERROR @G51DGBB*/ 01889000
         LTR   R15,R15                                             0711 01890000
         BNZ   @RF00711                                            0711 01891000
*                DO;                                       /*@G51DGBB*/ 01892000
*                  LISTPTR = FRAMLOCC(A); /*GET CCH FRAMES   @G51DGBB*/ 01893000
         L     @14,A                                               0713 01894000
         MH    @14,@CH00227                                        0713 01895000
         L     @06,FRAMEPTR(,R2)                                   0713 01896000
         L     @14,FRAMLOCC-24(@14,@06)                            0713 01897000
         ST    @14,LISTPTR                                         0713 01898000
*                  DO Z = 1 BY 1 TO LISTNUM WHILE R15 < FOUR;      0714 01899000
         LA    @14,1                                               0714 01900000
         ST    @14,Z                                               0714 01901000
         B     @DE00714                                            0714 01902000
@DL00714 C     R15,@CF00065                                        0714 01903000
         BNL   @DC00714                                            0714 01904000
*                    RECCCHHR = LISTCCHR(Z);               /*@G51DGBB*/ 01905000
         MH    @14,@CH00079                                        0715 01906000
         L     @06,LISTPTR                                         0715 01907000
         ALR   @06,@14                                             0715 01908000
         BCTR  @06,0                                               0715 01909000
         MVC   RECCCHHR(5,R2),LISTCCHR-4(@06)                      0715 01910000
*                      CALL IOHND(READIRCT); /*READ FRAME OFF DRCTWK*/  01911000
         L     @15,ADIOHND(,R2)                                    0716 01912000
         LA    @01,@AL00716                                        0716 01913000
         BALR  @14,@15                                             0716 01914000
*                      IF R15 = ZERO THEN    /*IF SUCCESS THEN WRITE*/  01915000
         LTR   R15,R15                                             0717 01916000
         BNZ   @RF00717                                            0717 01917000
*                        CALL IOHND(RITEHIST); /*TO ACCDEV   @G51DGBB*/ 01918000
         L     @15,ADIOHND(,R2)                                    0718 01919000
         LA    @01,@AL00718                                        0718 01920000
         BALR  @14,@15                                             0718 01921000
*                    END;                                  /*@G51DGBB*/ 01922000
@RF00717 LA    @14,1                                               0719 01923000
         AL    @14,Z                                               0719 01924000
         ST    @14,Z                                               0719 01925000
@DE00714 L     @06,LISTPTR                                         0719 01926000
         C     @14,LISTNUM(,@06)                                   0719 01927000
         BNH   @DL00714                                            0719 01928000
@DC00714 DS    0H                                                  0720 01929000
*                 END;                                     /*@G51DGBB*/ 01930000
*             END;                                         /*@G51DGBB*/ 01931000
*           ELSE  /*INCOMPLETE FRAME SET                     @G51DGBB*/ 01932000
*             DO;                                          /*@G51DGBB*/ 01933000
         B     @RC00702                                            0722 01934000
@RF00702 DS    0H                                                  0723 01935000
*               MSGNO = 78; /*MISSING FRAME SET MESSAGE      @G51DGBB*/ 01936000
         MVI   MSGNO,X'4E'                                         0723 01937000
*               CCHINDX = A;   /*CORRECT DEBUG FRAME COUNTS BY */  0724 01938000
         L     @14,A                                               0724 01939000
         ST    @14,CCHINDX                                         0724 01940000
*               CALL ERRMSG;                               /*@G51DGBB*/ 01941000
         BAL   @14,ERRMSG                                          0725 01942000
*               CALL FIXENTRY; /*PASSING ENTRY INDEX TO FIXENTRY*/ 0726 01943000
         BAL   @14,FIXENTRY                                        0726 01944000
*             END;                                         /*@G51DGBB*/ 01945000
*         END;                                             /*@G51DGBB*/ 01946000
@RC00702 LA    @14,1                                               0728 01947000
         AL    @14,A                                               0728 01948000
         ST    @14,A                                               0728 01949000
@DE00701 L     @06,FRAMEPTR(,R2)                                   0728 01950000
         C     @14,FRAMENUM(,@06)                                  0728 01951000
         BNH   @DL00701                                            0728 01952000
@DC00701 DS    0H                                                  0729 01953000
*      END;                                                /*@G51DGBB*/ 01954000
*     GEN(FREEMAIN R,SP=21);                               /*@G51DGBB*/ 01955000
@RF00693 DS    0H                                                  0730 01956000
         FREEMAIN R,SP=21                                               01957000
* END;                                                     /*@G51DGBB*/ 01958000
*IF ERROR = OVERFLOW | ERROR = ENDFILE THEN                        0732 01959000
@RF00691 L     @14,ERROR                                           0732 01960000
         C     @14,@CF00036                                        0732 01961000
         BE    @RT00732                                            0732 01962000
         C     @14,@CF00065                                        0732 01963000
         BNE   @RF00732                                            0732 01964000
@RT00732 DS    0H                                                  0733 01965000
*  ERROR = ZERO;                                           /*@0001VLS*/ 01966000
         SLR   @14,@14                                             0733 01967000
         ST    @14,ERROR                                           0733 01968000
*BUG(50) = BUG(23) + BUG(17) + BUG(19) + BUG(21);          /*@G51DGBB*/ 01969000
@RF00732 L     @14,BUG+88                                          0734 01970000
         AL    @14,BUG+64                                          0734 01971000
         AL    @14,BUG+72                                          0734 01972000
         AL    @14,BUG+80                                          0734 01973000
         ST    @14,BUG+196                                         0734 01974000
*NUMREC = BUG(50);                                         /*@G51DGBB*/ 01975000
         ST    @14,NUMREC                                          0735 01976000
*CVD(NUMREC,PACKPAS); /*PRINT NUMBER OF RECORDS PASSED FILTERING*/ 0736 01977000
         CVD   @14,@TS00001                                        0736 01978000
         MVC   PACKPAS(4),@TS00001+4                               0736 01979000
*PACKPAS = (PACKPAS | '0000000F'X); /*CHANGE SIGN FROM C TO F*/    0737 01980000
         OC    PACKPAS(4),@CB01458                                 0737 01981000
*UNPK(EDFLD,PACKPAS);                                      /*@Z427VLS*/ 01982000
         UNPK  EDFLD(9),PACKPAS(4)                                 0738 01983000
*NONBLANK = OFF; /*INITIALIZE TO NO LEADING BLANKS           @G51DGBB*/ 01984000
         NI    NONBLANK,B'10111111'                                0739 01985000
*DO J = 1 BY 1 TO 8 WHILE NONBLANK = OFF;                  /*@Z427VLS*/ 01986000
         LA    @14,1                                               0740 01987000
         ST    @14,J                                               0740 01988000
@DL00740 TM    NONBLANK,B'01000000'                                0740 01989000
         BNZ   @DC00740                                            0740 01990000
*  IF EDIFILD(J) = CHARZERO THEN                                   0741 01991000
         LA    @06,EDIFILD-1(@14)                                  0741 01992000
         CLI   0(@06),X'F0'                                        0741 01993000
         BNE   @RF00741                                            0741 01994000
*    EDIFILD(J) = BLANK;                                   /*@Z427VLS*/ 01995000
         LA    @06,EDIFILD-1(@14)                                  0742 01996000
         MVI   0(@06),X'40'                                        0742 01997000
*  ELSE                                                            0743 01998000
*    NONBLANK = ON;                                        /*@Z427VLS*/ 01999000
         B     @RC00741                                            0743 02000000
@RF00741 OI    NONBLANK,B'01000000'                                0743 02001000
*END;                                                      /*@Z427VLS*/ 02002000
@RC00741 LA    @14,1                                               0744 02003000
         AL    @14,J                                               0744 02004000
         ST    @14,J                                               0744 02005000
         C     @14,@CF00036                                        0744 02006000
         BNH   @DL00740                                            0744 02007000
@DC00740 DS    0H                                                  0745 02008000
*PRINTADR = ADDR(PRINTLIN);                                /*@Z427VLS*/ 02009000
         LA    @14,PRINTLIN                                        0745 02010000
         ST    @14,PRINTADR(,R2)                                   0745 02011000
*CALL IFCMSG(70,ADDR(PRINTBDY));                           /*@Z427VLS*/ 02012000
         LA    @14,PRINTBDY                                        0746 02013000
         ST    @14,@AFTEMPS                                        0746 02014000
         L     @15,ADIFCMSG(,R2)                                   0746 02015000
         LA    @01,@AL00746                                        0746 02016000
         BALR  @14,@15                                             0746 02017000
*PRINTED = EDFLD;                                          /*@Z427VLS*/ 02018000
         MVC   PRINTED(9),EDFLD                                    0747 02019000
*CALL IOHND(RITEPRTR);                                     /*@Z427VLS*/ 02020000
         L     @15,ADIOHND(,R2)                                    0748 02021000
         LA    @01,@AL00748                                        0748 02022000
         BALR  @14,@15                                             0748 02023000
*CVD(ZZ3,PACKPAS);                                         /*@0099VLS*/ 02024000
         L     @14,ZZ3                                             0749 02025000
         CVD   @14,@TS00001                                        0749 02026000
         MVC   PACKPAS(4),@TS00001+4                               0749 02027000
*PACKPAS = (PACKPAS | '0000000F'X); /*CHANGE SIGN FROM C TO F*/    0750 02028000
         OC    PACKPAS(4),@CB01458                                 0750 02029000
*UNPK(EDFLD,PACKPAS); /*CONVERT PACKED TO PRINTABLE          @Z427VLS*/ 02030000
         UNPK  EDFLD(9),PACKPAS(4)                                 0751 02031000
*NONBLANK = OFF; /*REINITIALIZE THE SWITCH                   @Z427VLS*/ 02032000
         NI    NONBLANK,B'10111111'                                0752 02033000
*DO J = 1 BY 1 TO 8 WHILE NONBLANK = OFF;                  /*@Z427VLS*/ 02034000
         LA    @14,1                                               0753 02035000
         ST    @14,J                                               0753 02036000
@DL00753 TM    NONBLANK,B'01000000'                                0753 02037000
         BNZ   @DC00753                                            0753 02038000
*  IF EDIFILD(J) = CHARZERO THEN                                   0754 02039000
         LA    @06,EDIFILD-1(@14)                                  0754 02040000
         CLI   0(@06),X'F0'                                        0754 02041000
         BNE   @RF00754                                            0754 02042000
*    EDIFILD(J) = BLANK;                                   /*@Z427VLS*/ 02043000
         LA    @06,EDIFILD-1(@14)                                  0755 02044000
         MVI   0(@06),X'40'                                        0755 02045000
*  ELSE /*NON BLANK BY DEFAULT                               @Z427VLS*/ 02046000
*    NONBLANK = ON;                                        /*@Z427VLS*/ 02047000
         B     @RC00754                                            0756 02048000
@RF00754 OI    NONBLANK,B'01000000'                                0756 02049000
*END;                                                      /*@Z427VLS*/ 02050000
@RC00754 LA    @14,1                                               0757 02051000
         AL    @14,J                                               0757 02052000
         ST    @14,J                                               0757 02053000
         C     @14,@CF00036                                        0757 02054000
         BNH   @DL00753                                            0757 02055000
@DC00753 DS    0H                                                  0758 02056000
*PRINTADR = ADDR(PRINTLIN);                                /*@Z427VLS*/ 02057000
         LA    @14,PRINTLIN                                        0758 02058000
         ST    @14,PRINTADR(,R2)                                   0758 02059000
*CALL IFCMSG(71,ADDR(PRINTBDY));                           /*@Z427VLS*/ 02060000
         LA    @14,PRINTBDY                                        0759 02061000
         ST    @14,@AFTEMPS                                        0759 02062000
         L     @15,ADIFCMSG(,R2)                                   0759 02063000
         LA    @01,@AL00759                                        0759 02064000
         BALR  @14,@15                                             0759 02065000
*PRINTED = EDFLD;                                          /*@Z427VLS*/ 02066000
         MVC   PRINTED(9),EDFLD                                    0760 02067000
*CALL IOHND(RITEPRTR);                                     /*@Z427VLS*/ 02068000
         L     @15,ADIOHND(,R2)                                    0761 02069000
         LA    @01,@AL00761                                        0761 02070000
         BALR  @14,@15                                             0761 02071000
*IF PACC = YES THEN                                                0762 02072000
         TM    PACC(R2),B'01000000'                                0762 02073000
         BNO   @RF00762                                            0762 02074000
*  DO;                                                     /*@Z427VLS*/ 02075000
*    CLOSEIO = CLOSEIO && CLOSEIO;                         /*@Z427VLS*/ 02076000
         XC    CLOSEIO(2,R2),CLOSEIO(R2)                           0764 02077000
*    CACCDEV = ON;                                         /*@Z427VLS*/ 02078000
         OI    CACCDEV(R2),B'00001000'                             0765 02079000
*    CALL IOHND(IOCLOSE);                                  /*@Z427VLS*/ 02080000
         L     @15,ADIOHND(,R2)                                    0766 02081000
         LA    @01,@AL00766                                        0766 02082000
         BALR  @14,@15                                             0766 02083000
*  END;                                                    /*@Z427VLS*/ 02084000
*IF ERROR ^= NOSRTABL THEN                                         0768 02085000
@RF00762 CLC   ERROR(4),@CF00032                                   0768 02086000
         BE    @RF00768                                            0768 02087000
* DO;                                                      /*@Z427VLS*/ 02088000
*   SORTNUM = PASSNUM; /*TELL EREP1 HOW MANY RECORDS IN TREND2  */ 0770 02089000
         L     @14,PASSNUM                                         0770 02090000
         ST    @14,SORTNUM(,R2)                                    0770 02091000
*   EXCESS = TABSIZE - (PASSNUM * SORTELNT); /*CORE UNUSED BY TREND2*/  02092000
         L     @06,TABSIZE(,R2)                                    0771 02093000
         MH    @14,@CH00952                                        0771 02094000
         LCR   @14,@14                                             0771 02095000
         ALR   @14,@06                                             0771 02096000
         ST    @14,EXCESS                                          0771 02097000
*   IF EXCESS > 16 THEN /*IF ONE DOUBLEWORD TO FREE AFTER ROUNDING*/    02098000
         C     @14,@CF00088                                        0772 02099000
         BNH   @RF00772                                            0772 02100000
*     DO;                                                  /*@Z427VLS*/ 02101000
*       EXCESS = (EXCESS & DBWRD1); /*ROUND DOWN TO DBWORD AMOUNT*/     02102000
         N     @14,@CF00893                                        0774 02103000
         ST    @14,EXCESS                                          0774 02104000
*       RESPECIFY (R0,R1) RESTRICTED;                      /*@Z427VLS*/ 02105000
*       R0 = EXCESS;                                       /*@Z427VLS*/ 02106000
         LR    R0,@14                                              0776 02107000
*       R1 = SORTADR + TABSIZE - EXCESS;                   /*@Z427VLS*/ 02108000
         AL    @06,SORTADR(,R2)                                    0777 02109000
         SLR   @06,@14                                             0777 02110000
         LR    R1,@06                                              0777 02111000
*       GEN(FREEMAIN R,LV=(0),A=(1));                      /*@Z427VLS*/ 02112000
         FREEMAIN R,LV=(0),A=(1)                                        02113000
*     END;                                                 /*@Z427VLS*/ 02114000
*     RESPECIFY(R1) UNRESTRICTED;                          /*@Z427VLS*/ 02115000
@RF00772 DS    0H                                                  0781 02116000
*  END;                                                    /*@Z427VLS*/ 02117000
*IF SORTNUM = ZERO & NUMREC = ZERO THEN  /*IF NO RECDS, EREP1 QUIT*/    02118000
@RF00768 SLR   @14,@14                                             0782 02119000
         C     @14,SORTNUM(,R2)                                    0782 02120000
         BNE   @RF00782                                            0782 02121000
         C     @14,NUMREC                                          0782 02122000
         BNE   @RF00782                                            0782 02123000
*  ERROR = TERMINAT;                                       /*@0001VLS*/ 02124000
         MVC   ERROR(4),@CF00032                                   0783 02125000
*IF ERROR = SUCCESS THEN                                           0784 02126000
@RF00782 L     @14,ERROR                                           0784 02127000
         LTR   @14,@14                                             0784 02128000
         BNZ   @RF00784                                            0784 02129000
* DO;                                                      /*@Z427VLS*/ 02130000
*  CALL SORTONE; /*SORT EVTABLE,TRENDONE,SET EVLETTER IF UNSET*/   0786 02131000
         BAL   @14,SORTONE                                         0786 02132000
*  IF SORTNUM > ZERO THEN /*IF ANY SAVED OBR, MDR RECORDS    @Z427VLS*/ 02133000
         L     @14,SORTNUM(,R2)                                    0787 02134000
         LTR   @14,@14                                             0787 02135000
         BNP   @RF00787                                            0787 02136000
*    CALL SORTWO;                                          /*@Z427VLS*/ 02137000
         BAL   @14,SORTWO                                          0788 02138000
* END;                                                     /*@Z427VLS*/ 02139000
*RESPECIFY (R0,R1,R15) UNRESTRICTED;                       /*@Z427VLS*/ 02140000
*END; /*CLOSING END TO ENDOFILE                              @Z427VLS*/ 02141000
@EL00014 DS    0H                                                  0791 02142000
@EF00014 DS    0H                                                  0791 02143000
@ER00014 LM    @14,@12,@SA00014                                    0791 02144000
         BR    @14                                                 0791 02145000
*ALLREC: PROC;  /*RECORD DEPENDENT SELECTION CRITTERIA       @Z427VLS*/ 02146000
ALLREC   STM   @14,@12,12(@13)                                     0792 02147000
*               /*COMPARE RECORD ITEMS PRECEEDED BY          @Z427VLS*/ 02148000
*               /* LRT TO PARAMETER TABLE SELECTION          @Z427VLS*/ 02149000
*               /*VALUES AND RANGES                          @Z427VLS*/ 02150000
*PASSFLAG = YES; /*RECORD SELECTED IF PASSFLAG NOT SET TO NO @Z427VLS*/ 02151000
         OI    PASSFLAG(R2),B'00000001'                            0793 02152000
*IF LRTDATE >= STDATE & LRTDATE <= ENDDATE THEN                    0794 02153000
         CLC   LRTDATE(4,R7),STDATE(R2)                            0794 02154000
         BL    @RF00794                                            0794 02155000
         CLC   LRTDATE(4,R7),ENDDATE(R2)                           0794 02156000
         BH    @RF00794                                            0794 02157000
*  DO;                                                     /*@Z427VLS*/ 02158000
*    IF (LRTTIME >= STTIME1 & LRTTIME <= ENDTIME1) |               0796 02159000
*       (LRTTIME >= STTIME2 & LRTTIME <= ENDTIME2) THEN            0796 02160000
         CLC   LRTTIME(4,R7),STTIME1(R2)                           0796 02161000
         BL    @GL00049                                            0796 02162000
         CLC   LRTTIME(4,R7),ENDTIME1(R2)                          0796 02163000
         BNH   @RT00796                                            0796 02164000
@GL00049 CLC   LRTTIME(4,R7),STTIME2(R2)                           0796 02165000
         BL    @RF00796                                            0796 02166000
         CLC   LRTTIME(4,R7),ENDTIME2(R2)                          0796 02167000
         BH    @RF00796                                            0796 02168000
@RT00796 DS    0H                                                  0797 02169000
*      DO;                                                 /*@Z427VLS*/ 02170000
*        IF SHIFT3RD = ON &                                        0798 02171000
*          ((LRTDATE = STDATE & LRTTIME < STTIME1) |               0798 02172000
*           (LRTDATE = ENDDATE & LRTTIME > ENDTIME2))              0798 02173000
*           THEN                                                   0798 02174000
         TM    SHIFT3RD(R2),B'00010000'                            0798 02175000
         BNO   @RF00798                                            0798 02176000
         CLC   LRTDATE(4,R7),STDATE(R2)                            0798 02177000
         BNE   @GL00053                                            0798 02178000
         CLC   LRTTIME(4,R7),STTIME1(R2)                           0798 02179000
         BL    @RT00798                                            0798 02180000
@GL00053 CLC   LRTDATE(4,R7),ENDDATE(R2)                           0798 02181000
         BNE   @RF00798                                            0798 02182000
         CLC   LRTTIME(4,R7),ENDTIME2(R2)                          0798 02183000
         BNH   @RF00798                                            0798 02184000
@RT00798 DS    0H                                                  0799 02185000
*              PASSFLAG = NO;                              /*@Z427VLS*/ 02186000
         NI    PASSFLAG(R2),B'11111110'                            0799 02187000
*      END;                                                /*@Z427VLS*/ 02188000
*    ELSE                                                          0801 02189000
*      PASSFLAG = NO;                                      /*@Z427VLS*/ 02190000
         B     @RC00796                                            0801 02191000
@RF00796 NI    PASSFLAG(R2),B'11111110'                            0801 02192000
*   END;                                                   /*@Z427VLS*/ 02193000
*  ELSE                                                            0803 02194000
*   PASSFLAG = NO;                                         /*@Z427VLS*/ 02195000
         B     @RC00794                                            0803 02196000
@RF00794 NI    PASSFLAG(R2),B'11111110'                            0803 02197000
*END;                                                      /*@Z427VLS*/ 02198000
@EL00015 DS    0H                                                  0804 02199000
@EF00015 DS    0H                                                  0804 02200000
@ER00015 LM    @14,@12,12(@13)                                     0804 02201000
         BR    @14                                                 0804 02202000
*RECDEP: PROC; /*IDENTIFY RECORD TYPE, SET SORT TABLE KEY    @Z427VLS*/ 02203000
RECDEP   STM   @14,@12,@SA00016                                    0805 02204000
*              /*PERFORM FILTERING                           @Z427VLS*/ 02205000
*WORKTYPE = (LRTKEY1 & GENREC);                            /*@Z427VLS*/ 02206000
         MVC   WORKTYPE(1),LRTKEY1(R7)                             0806 02207000
         NI    WORKTYPE,X'F0'                                      0806 02208000
*IF LRTRUNC = ON | (WORKTYPE < HEX10)                              0807 02209000
*                | (WORKTYPE > HEX90) THEN                         0807 02210000
         TM    LRTRUNC(R7),B'00100000'                             0807 02211000
         BO    @RT00807                                            0807 02212000
         CLI   WORKTYPE,X'10'                                      0807 02213000
         BL    @RT00807                                            0807 02214000
         CLI   WORKTYPE,X'90'                                      0807 02215000
         BNH   @RF00807                                            0807 02216000
@RT00807 DS    0H                                                  0808 02217000
*  BUG(15) = BUG(15) + ONE;                                /*@Z427VLS*/ 02218000
         LA    @06,1                                               0808 02219000
         AL    @06,BUG+56                                          0808 02220000
         ST    @06,BUG+56                                          0808 02221000
*ELSE                                                              0809 02222000
*  DO;                                                     /*@Z427VLS*/ 02223000
         B     @RC00807                                            0809 02224000
@RF00807 DS    0H                                                  0810 02225000
*    IF WORKTYPE = HEX30 THEN                                      0810 02226000
         CLI   WORKTYPE,X'30'                                      0810 02227000
         BNE   @RF00810                                            0810 02228000
*      DO;                                                 /*@Z427VLS*/ 02229000
*        CALL OBRFILT;                                     /*@Z427VLS*/ 02230000
         BAL   @14,OBRFILT                                         0812 02231000
*        BUG(6) = BUG(6) + 1; /*NUMBER OF OBRS IDENTIFIED    @Z427VLS*/ 02232000
         LA    @06,1                                               0813 02233000
         AL    @06,BUG+20                                          0813 02234000
         ST    @06,BUG+20                                          0813 02235000
*      END;                                                /*@Z427VLS*/ 02236000
*    ELSE                                                          0815 02237000
*      DO;                                                 /*@Z427VLS*/ 02238000
         B     @RC00810                                            0815 02239000
@RF00810 DS    0H                                                  0816 02240000
*        IF WORKTYPE = HEX90 THEN                                  0816 02241000
         CLI   WORKTYPE,X'90'                                      0816 02242000
         BNE   @RF00816                                            0816 02243000
*          CALL MDRFILT;                                   /*@Z427VLS*/ 02244000
         BAL   @14,MDRFILT                                         0817 02245000
*        ELSE                                                      0818 02246000
*          DO;                                             /*@Z427VLS*/ 02247000
         B     @RC00816                                            0818 02248000
@RF00816 DS    0H                                                  0819 02249000
*            IF WORKTYPE = HEX10 THEN                              0819 02250000
         CLI   WORKTYPE,X'10'                                      0819 02251000
         BNE   @RF00819                                            0819 02252000
*              CALL MCHFILT;                               /*@Z427VLS*/ 02253000
         BAL   @14,MCHFILT                                         0820 02254000
*            ELSE                                                  0821 02255000
*             DO;                                          /*@Z427VLS*/ 02256000
         B     @RC00819                                            0821 02257000
@RF00819 DS    0H                                                  0822 02258000
*               IF WORKTYPE = HEX20 THEN                           0822 02259000
         CLI   WORKTYPE,X'20'                                      0822 02260000
         BNE   @RF00822                                            0822 02261000
*                 CALL CCHFILT;                            /*@Z427VLS*/ 02262000
         BAL   @14,CCHFILT                                         0823 02263000
*               ELSE                                               0824 02264000
*                DO;                                       /*@Z427VLS*/ 02265000
         B     @RC00822                                            0824 02266000
@RF00822 DS    0H                                                  0825 02267000
*                   IF WORKTYPE = HEX40 THEN                       0825 02268000
         CLI   WORKTYPE,X'40'                                      0825 02269000
         BNE   @RF00825                                            0825 02270000
*                     CALL SOFTFILT;                       /*@Z427VLS*/ 02271000
         BAL   @14,SOFTFILT                                        0826 02272000
*                   ELSE                                           0827 02273000
*                     DO;                                  /*@Z427VLS*/ 02274000
         B     @RC00825                                            0827 02275000
@RF00825 DS    0H                                                  0828 02276000
*                       IF WORKTYPE = HEX50 THEN                   0828 02277000
         CLI   WORKTYPE,X'50'                                      0828 02278000
         BNE   @RF00828                                            0828 02279000
*                         CALL IPLFILT;                    /*@Z427VLS*/ 02280000
         BAL   @14,IPLFILT                                         0829 02281000
*                       ELSE                                       0830 02282000
*                         DO;                              /*@Z427VLS*/ 02283000
         B     @RC00828                                            0830 02284000
@RF00828 DS    0H                                                  0831 02285000
*                           IF WORKTYPE = HEX60 THEN               0831 02286000
         CLI   WORKTYPE,X'60'                                      0831 02287000
         BNE   @RF00831                                            0831 02288000
*                             CALL DDRFILT;                /*@Z427VLS*/ 02289000
         BAL   @14,DDRFILT                                         0832 02290000
*                           ELSE                                   0833 02291000
*                             DO;                          /*@Z427VLS*/ 02292000
         B     @RC00831                                            0833 02293000
@RF00831 DS    0H                                                  0834 02294000
*                               IF WORKTYPE = HEX70 THEN           0834 02295000
         CLI   WORKTYPE,X'70'                                      0834 02296000
         BNE   @RF00834                                            0834 02297000
*                                 CALL MIHFILT;            /*@Z427VLS*/ 02298000
         BAL   @14,MIHFILT                                         0835 02299000
*                               ELSE                               0836 02300000
*                                 CALL EODFILT;            /*@Z427VLS*/ 02301000
         B     @RC00834                                            0836 02302000
@RF00834 BAL   @14,EODFILT                                         0836 02303000
*                             END;                         /*@Z427VLS*/ 02304000
*                         END;                             /*@Z427VLS*/ 02305000
*                     END;                                 /*@Z427VLS*/ 02306000
*                 END;                                     /*@Z427VLS*/ 02307000
*             END;                                         /*@Z427VLS*/ 02308000
*         END;                                             /*@Z427VLS*/ 02309000
*     END;                                                 /*@Z427VLS*/ 02310000
*   END;                                                   /*@Z427VLS*/ 02311000
*END;                                                      /*@Z427VLS*/ 02312000
@EL00016 DS    0H                                                  0845 02313000
@EF00016 DS    0H                                                  0845 02314000
@ER00016 LM    @14,@12,@SA00016                                    0845 02315000
         BR    @14                                                 0845 02316000
*TREADR: PROC;                                             /*@Z427VLS*/ 02317000
TREADR   STM   @14,@12,@SA00017                                    0846 02318000
*RESPECIFY(R3,R15) RESTRICTED;                             /*@Z427VLS*/ 02319000
*/*ADDRESS THE TRENDONE ENTRY THAT RELATES TO THE RECORD CPU @Z427VLS*/ 02320000
*/*SERIAL NUMBER. IF THE ENTRY DOES NOT EXIST, CREATE IT AND @Z427VLS*/ 02321000
*/*ADDRESS IT. TRENDONE ENTRY NUMBER IS EQUAL TO EVTABLE     @Z427VLS*/ 02322000
*/*ENTRY NUMBER.                                     IF MORE @Z427VLS*/ 02323000
*/*THAN 16 CPUS ARE IDENTIFIED, AN ERROR MESSAGE IS ISSUED   @Z427VLS*/ 02324000
*/*THE FIRST TIME, AND THE RECORDS FOR THE EXCESS CPUS ARE   @Z427VLS*/ 02325000
*/*SUMMED INTO THE 16TH CPU BUCKET BEFORE THE BUCKETS ARE IN @Z427VLS*/ 02326000
*/*CPU SERIAL ORDER. AN INDEX TO THE BUCKETS FOR THE RELATIVE*/    0848 02327000
*/*DATE IN TRENDONE IS CREATED.                              @Z427VLS*/ 02328000
*CPU0FLG = OFF; /*CPU INNOCENT UNTIL PROVEN GUILTY           @Z427VLS*/ 02329000
         NI    CPU0FLG,B'11110111'                                 0848 02330000
*CVB(BINDAY,LRTDAY); /*CONVERT RECORD DAY TO BINARY FROM PACKED*/  0849 02331000
         XC    @TS00001(8),@TS00001                                0849 02332000
         MVC   @TS00001+6(2),LRTDAY(R7)                            0849 02333000
         CVB   @14,@TS00001                                        0849 02334000
         ST    @14,BINDAY                                          0849 02335000
*IF CROSSFLG = YES THEN /*IF YEAR BOUNDARY IS CROSSED        @Z427VLS*/ 02336000
         TM    CROSSFLG,B'10000000'                                0850 02337000
         BNO   @RF00850                                            0850 02338000
*  DO;                                                     /*@Z427VLS*/ 02339000
*    IF BINDAY >  DEC335 THEN  /*IS DAY FROM OLD YEAR        @Z427VLS*/ 02340000
         C     @14,@CF00972                                        0852 02341000
         BNH   @RF00852                                            0852 02342000
*      TREIDX = BINDAY - DSTART + ONE; /*SET RELATIVE INDEX  @Z427VLS*/ 02343000
         SL    @14,DSTART                                          0853 02344000
         LA    @14,1(,@14)                                         0853 02345000
         STC   @14,TREIDX                                          0853 02346000
*    ELSE  /*DAY FROM NEW YEAR                               @Z427VLS*/ 02347000
*      TREIDX = BINDAY + ADDAFT; /*ADD OLD YEAR DAYS FOR PROPER INDEX*/ 02348000
         B     @RC00852                                            0854 02349000
@RF00852 L     @14,BINDAY                                          0854 02350000
         AL    @14,ADDAFT                                          0854 02351000
         STC   @14,TREIDX                                          0854 02352000
*  END;                                                    /*@Z427VLS*/ 02353000
*ELSE /*IF ALL DAYS IN SAME YEAR                             @Z427VLS*/ 02354000
*  TREIDX = BINDAY - DSTART + ONE;                         /*@Z427VLS*/ 02355000
         B     @RC00850                                            0856 02356000
@RF00850 L     @14,BINDAY                                          0856 02357000
         SL    @14,DSTART                                          0856 02358000
         LA    @14,1(,@14)                                         0856 02359000
         STC   @14,TREIDX                                          0856 02360000
*IF LRTCPUS = ZEROS THEN /*PROTECT AGAINST ZERO SERIAL NO. IN RECORD*/  02361000
@RC00850 CLC   LRTCPUS(3,R7),@CB00956                              0857 02362000
         BNE   @RF00857                                            0857 02363000
*  DO;                                                     /*@Z427VLS*/ 02364000
*    CPU0FLG = ON; /*DONT SAVE THIS RECORD                   @Z427VLS*/ 02365000
         OI    CPU0FLG,B'00001000'                                 0859 02366000
*    MSGNO = 5;                                            /*@Z427VLS*/ 02367000
         MVI   MSGNO,X'05'                                         0860 02368000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 02369000
         BAL   @14,ERRMSG                                          0861 02370000
*  END;                                                    /*@Z427VLS*/ 02371000
*ELSE                                                              0863 02372000
*  DO;                                                     /*@Z427VLS*/ 02373000
         B     @RC00857                                            0863 02374000
@RF00857 DS    0H                                                  0864 02375000
*    TRENPTR = SAVEADR(1);                                 /*@Z427VLS*/ 02376000
         L     @14,SAVEADR                                         0864 02377000
         ST    @14,TRENPTR(,R2)                                    0864 02378000
*    GETOUT = NO;                                          /*@Z427VLS*/ 02379000
         NI    GETOUT,B'10111111'                                  0865 02380000
*    DO K = 1 BY 1 TO EVMAX WHILE GETOUT = NO;             /*@Z427VLS*/ 02381000
         LA    @14,1                                               0866 02382000
         ST    @14,K                                               0866 02383000
@DL00866 TM    GETOUT,B'01000000'                                  0866 02384000
         BNZ   @DC00866                                            0866 02385000
*      IF EVSERIAL(K) = LRTCPUS THEN                               0867 02386000
         MH    @14,@CH00081                                        0867 02387000
         L     @06,EVPTR(,R2)                                      0867 02388000
         ST    @14,@TF00001                                        0867 02389000
         ALR   @14,@06                                             0867 02390000
         CLC   EVSERIAL-6(3,@14),LRTCPUS(R7)                       0867 02391000
         BNE   @RF00867                                            0867 02392000
*        DO;                                               /*@Z427VLS*/ 02393000
*          EVMODEL(K) = LRTMODEL; /*SET IN CASE THIS ENTRY CREATED*/    02394000
         AL    @06,@TF00001                                        0869 02395000
         MVC   EVMODEL-6(2,@06),LRTMODEL(R7)                       0869 02396000
*          GETOUT = YES;          /*FROM EVTABLE ENTRY WHICH IS   */    02397000
         OI    GETOUT,B'01000000'                                  0870 02398000
*        END;                     /*MISSING MODEL NUMBER     @Z427VLS*/ 02399000
*      ELSE                                                        0872 02400000
*        DO;                                               /*@Z427VLS*/ 02401000
         B     @RC00867                                            0872 02402000
@RF00867 DS    0H                                                  0873 02403000
*          IF TRENEXT ^= ZERO & TRENPTR ^= ZERO THEN /*IF ANOTHER*/     02404000
         SLR   @14,@14                                             0873 02405000
         L     @06,TRENPTR(,R2)                                    0873 02406000
         L     @05,TRENEXT(,@06)                                   0873 02407000
         CR    @05,@14                                             0873 02408000
         BE    @RF00873                                            0873 02409000
         CR    @06,@14                                             0873 02410000
         BE    @RF00873                                            0873 02411000
*          /*ENTRY OF TRENDONE AND ANOTHER ENTRY OF EVTABLE EXIST.*/    02412000
*          /*ALSO, IF AN ENTRY OS TRENDONE HAS BEEN CREATED  @Z427VLS*/ 02413000
*                TRENPTR = TRENEXT; /*RESET BASE TO NEXT ENTRY*/   0874 02414000
         ST    @05,TRENPTR(,R2)                                    0874 02415000
*          ELSE                                                    0875 02416000
*            DO;                                           /*@Z427VLS*/ 02417000
         B     @RC00873                                            0875 02418000
@RF00873 DS    0H                                                  0876 02419000
*              GETOUT = YES; /*ONLY CREATE ONE ENTRY PER CPU @Z427VLS*/ 02420000
         OI    GETOUT,B'01000000'                                  0876 02421000
*              IF K < EVMAX | /*IF ROOM FOR ANOTHER EVTABLE ENTRY OR*/  02422000
*                (K = EVMAX & EVSERIAL(K) = ZERO) THEN /*LAST ENTRY*/   02423000
         L     @14,K                                               0877 02424000
         LA    @06,16                                              0877 02425000
         CR    @14,@06                                             0877 02426000
         BL    @RT00877                                            0877 02427000
         CR    @14,@06                                             0877 02428000
         BNE   @RF00877                                            0877 02429000
         MH    @14,@CH00081                                        0877 02430000
         L     @06,EVPTR(,R2)                                      0877 02431000
         L     @14,EVSERIAL-7(@14,@06)                             0877 02432000
         LA    @14,0(,@14)                                         0877 02433000
         LTR   @14,@14                                             0877 02434000
         BNZ   @RF00877                                            0877 02435000
@RT00877 DS    0H                                                  0878 02436000
*                  /*OF EVTABLE BUT IT HAS NOT BEEN SET THEN @Z427VLS*/ 02437000
*                DO;                                       /*@Z427VLS*/ 02438000
*                  L = EVNUM + 1; /*INDEX TO UNBUILT ENTRY   @Z427VLS*/ 02439000
         L     @14,EVPTR(,R2)                                      0879 02440000
         LA    @06,1                                               0879 02441000
         AH    @06,EVNUM(,@14)                                     0879 02442000
         ST    @06,L                                               0879 02443000
*                  R3 = TREN1SIZ; /*LENGTH OF TRENDONE IN BYTES*/  0880 02444000
         L     R3,TREN1SIZ                                         0880 02445000
*                  GEN(GETMAIN EC,LV=(R3),A=COMPLINK); /*GET CORE FOR*/ 02446000
         GETMAIN EC,LV=(R3),A=COMPLINK                                  02447000
*                                           /*NEW TRENDONE ENTRY*/ 0882 02448000
*                  IF R15 = ZERO THEN /*IF GETMAIN IS SUCCESSFUL*/ 0882 02449000
         SLR   @14,@14                                             0882 02450000
         CR    R15,@14                                             0882 02451000
         BNE   @RF00882                                            0882 02452000
*                  DO;                                     /*@Z427VLS*/ 02453000
*                  IF EVNUM > ZERO THEN /*IF NOT ONLY ENTRY EXISTANT*/  02454000
         L     @06,EVPTR(,R2)                                      0884 02455000
         CH    @14,EVNUM(,@06)                                     0884 02456000
         BNL   @RF00884                                            0884 02457000
*                    TRENEXT = COMPLINK; /*FORWARD PTR TO CREATED ENT*/ 02458000
         L     @14,TRENPTR(,R2)                                    0885 02459000
         L     @06,COMPLINK                                        0885 02460000
         ST    @06,TRENEXT(,@14)                                   0885 02461000
*                  TRENPTR = COMPLINK; /*ADDRESS NEW ENTRY OF TRENDONE* 02462000
@RF00884 L     @14,COMPLINK                                        0886 02463000
         ST    @14,TRENPTR(,R2)                                    0886 02464000
*                  DO Q = 1 BY 1 TO NUMDAYS; /*CLEAR NEW ENTRY*/   0887 02465000
         LA    @14,1                                               0887 02466000
         ST    @14,Q                                               0887 02467000
         B     @DE00887                                            0887 02468000
@DL00887 DS    0H                                                  0888 02469000
*                    TREGEN(Q) = (TREGEN(Q) && TREGEN(Q)); /*@Z427VLS*/ 02470000
         LR    @06,@14                                             0888 02471000
         MH    @06,@CH01385                                        0888 02472000
         L     @01,TRENPTR(,R2)                                    0888 02473000
         ALR   @01,@06                                             0888 02474000
         AL    @01,@CF01601                                        0888 02475000
         XC    TREGEN-8(76,@01),TREGEN-8(@01)                      0888 02476000
*                  END;                                    /*@Z427VLS*/ 02477000
         AL    @14,@CF00056                                        0889 02478000
         ST    @14,Q                                               0889 02479000
@DE00887 C     @14,NUMDAYS(,R2)                                    0889 02480000
         BNH   @DL00887                                            0889 02481000
*                  TRENEXT = (TRENEXT && TRENEXT);         /*@Z427VLS*/ 02482000
         L     @14,TRENPTR(,R2)                                    0890 02483000
         L     @06,TRENEXT(,@14)                                   0890 02484000
         LR    @05,@06                                             0890 02485000
         XR    @05,@06                                             0890 02486000
         ST    @05,TRENEXT(,@14)                                   0890 02487000
*                  TRENUM = (TRENUM && TRENUM);            /*@Z427VLS*/ 02488000
         L     @06,TRENUM(,@14)                                    0891 02489000
         LR    @05,@06                                             0891 02490000
         XR    @05,@06                                             0891 02491000
         ST    @05,TRENUM(,@14)                                    0891 02492000
*                  EVMODEL(L) = LRTMODEL; /*SET NEW EVTABLE ENTRY FOR*/ 02493000
         L     @06,L                                               0892 02494000
         LR    @05,@06                                             0892 02495000
         MH    @05,@CH00081                                        0892 02496000
         L     @04,EVPTR(,R2)                                      0892 02497000
         ST    @05,@TF00001                                        0892 02498000
         ALR   @05,@04                                             0892 02499000
         MVC   EVMODEL-6(2,@05),LRTMODEL(R7)                       0892 02500000
*                  EVSERIAL(L) = LRTCPUS; /*CPU IDENTIFIED AS UNIQUE*/  02501000
         LR    @05,@04                                             0893 02502000
         AL    @05,@TF00001                                        0893 02503000
         MVC   EVSERIAL-6(3,@05),LRTCPUS(R7)                       0893 02504000
*                  SAVEADR(L) = TRENPTR; /*SAVE ADDRESS FOR SORTING*/   02505000
         SLA   @06,2                                               0894 02506000
         ST    @14,SAVEADR-4(@06)                                  0894 02507000
*                  EVNUM = EVNUM + 1; /*ADD 1 TO NUMBER OF ENTRIES*/    02508000
         LA    @14,1                                               0895 02509000
         AH    @14,EVNUM(,@04)                                     0895 02510000
         STH   @14,EVNUM(,@04)                                     0895 02511000
*                  END;                                    /*@Z427VLS*/ 02512000
*                  ELSE                                            0897 02513000
*                    DO;                                   /*@Z427VLS*/ 02514000
         B     @RC00882                                            0897 02515000
@RF00882 DS    0H                                                  0898 02516000
*                      MSGNO = ONE; /*TELL NOT ENOUGH CORE FOR TABLE*/  02517000
         MVI   MSGNO,X'01'                                         0898 02518000
*                      CALL ERRMSG;                        /*@Z427VLS*/ 02519000
         BAL   @14,ERRMSG                                          0899 02520000
*                      R15 = NOSRTABL;                     /*@0001VLS*/ 02521000
         LA    R15,12                                              0900 02522000
*                      GETFAIL = YES;                      /*@0001VLS*/ 02523000
         OI    GETFAIL,B'00000100'                                 0901 02524000
*                    END;                                  /*@Z427VLS*/ 02525000
*                END;                                      /*@Z427VLS*/ 02526000
*              ELSE  /*HERE WE HAVE NEW CPU WITH NO ROOM IN EVTABLE*/   02527000
*                DO;                                       /*@Z427VLS*/ 02528000
         B     @RC00877                                            0904 02529000
@RF00877 DS    0H                                                  0905 02530000
*                  BUG(30) = BUG(30) + 1; /*RECORD FOR EXCESS CPU*/     02531000
         LA    @14,1                                               0905 02532000
         AL    @14,BUG+116                                         0905 02533000
         ST    @14,BUG+116                                         0905 02534000
*                  IF FIRSTIME = OFF   THEN /*PRINT ERROR MESSAGE ONLY* 02535000
         TM    FIRSTIME,B'00100000'                                0906 02536000
         BNZ   @RF00906                                            0906 02537000
*                    DO;                    /*FOR FIRST EXCESS CPU*/    02538000
*                      MSGNO = 6;                          /*@Z427VLS*/ 02539000
         MVI   MSGNO,X'06'                                         0908 02540000
*                      CALL ERRMSG;                        /*@Z427VLS*/ 02541000
         BAL   @14,ERRMSG                                          0909 02542000
*                      FIRSTIME = ON;       /*NEVER TO RETURN*/    0910 02543000
         OI    FIRSTIME,B'00100000'                                0910 02544000
*                      EVSERIAL(K) = 'FFFFFF'X; /*RESET TO NO ROOM ID*/ 02545000
         L     @14,K                                               0911 02546000
         MH    @14,@CH00081                                        0911 02547000
         L     @06,EVPTR(,R2)                                      0911 02548000
         ST    @14,@TF00001                                        0911 02549000
         ALR   @14,@06                                             0911 02550000
         MVC   EVSERIAL-6(3,@14),@CB00237                          0911 02551000
*                      EVMODEL(K) = 'FFFF'X; /*WILL SORT 1ST @Z427VLS*/ 02552000
         AL    @06,@TF00001                                        0912 02553000
         MVC   EVMODEL-6(2,@06),@CB00261                           0912 02554000
*                    END;                                  /*@Z427VLS*/ 02555000
*                 END;                                     /*@Z427VLS*/ 02556000
@RF00906 DS    0H                                                  0915 02557000
*               END;                                       /*@Z427VLS*/ 02558000
@RC00877 DS    0H                                                  0916 02559000
*             END;                                         /*@Z427VLS*/ 02560000
@RC00873 DS    0H                                                  0917 02561000
*         END;                                             /*@Z427VLS*/ 02562000
@RC00867 LA    @14,1                                               0917 02563000
         AL    @14,K                                               0917 02564000
         ST    @14,K                                               0917 02565000
         C     @14,@CF00088                                        0917 02566000
         BNH   @DL00866                                            0917 02567000
@DC00866 DS    0H                                                  0918 02568000
*      END;                                                /*@Z427VLS*/ 02569000
*ERROR = R15; /*COMMUNICATE ERROR CONDITIONS TO CALLING PROC @Z427VLS*/ 02570000
@RC00857 ST    R15,ERROR                                           0919 02571000
*RESPECIFY(R3,R15) UNRESTRICTED;                           /*@Z427VLS*/ 02572000
* END; /*CLOSING END FOR SUMONADR                            @Z427VLS*/ 02573000
@EL00017 DS    0H                                                  0921 02574000
@EF00017 DS    0H                                                  0921 02575000
@ER00017 LM    @14,@12,@SA00017                                    0921 02576000
         BR    @14                                                 0921 02577000
*CALCRANG: PROC; /*CALCULATE NUMBER OF DAYS IN DATE RANGE    @Z427VLS*/ 02578000
CALCRANG STM   @14,@12,12(@13)                                     0922 02579000
*CVB(DSTART,PSTDY); /*CHANGE PACKED START DAY TO BINARY      @Z427VLS*/ 02580000
         XC    @TS00001(8),@TS00001                                0923 02581000
         MVC   @TS00001+6(2),PSTDY(R2)                             0923 02582000
         CVB   @06,@TS00001                                        0923 02583000
         ST    @06,DSTART                                          0923 02584000
*CVB(DEND,PENDY); /*CHANGE PACKED END DAY TO BINARY          @Z427VLS*/ 02585000
         XC    @TS00001(8),@TS00001                                0924 02586000
         MVC   @TS00001+6(2),PENDY(R2)                             0924 02587000
         CVB   @03,@TS00001                                        0924 02588000
         ST    @03,DEND                                            0924 02589000
*IF DSTART > DEND THEN /*IF CROSS YEAR BOUNDARY              @Z427VLS*/ 02590000
         CR    @06,@03                                             0925 02591000
         BNH   @RF00925                                            0925 02592000
*  DO;                                                     /*@Z427VLS*/ 02593000
*    CROSSFLG = YES; /*YEAR BOUNDARY CROSSED FLAG            @Z427VLS*/ 02594000
         OI    CROSSFLG,B'10000000'                                0927 02595000
*    ADDAFT = DEC366 - DSTART; /*CREATE RELATIVE INDEX IF AFTER END*/   02596000
         LCR   @06,@06                                             0928 02597000
         AL    @06,@CF00948                                        0928 02598000
         ST    @06,ADDAFT                                          0928 02599000
*                              /*OF YEAR                     @Z427VLS*/ 02600000
*    NUMDAYS = DEC366 - DSTART + DEND;                     /*@Z427VLS*/ 02601000
         ALR   @03,@06                                             0929 02602000
         ST    @03,NUMDAYS(,R2)                                    0929 02603000
*    YRSAVE1 = (YRSAVE1 && YRSAVE1); /*ZERO HIGH BYTE        @Z427VLS*/ 02604000
         XC    YRSAVE1(1),YRSAVE1                                  0930 02605000
*    YRSAVE2 = PSTYR; /*GET DECIMAL YEAR FROM RECORD         @Z427VLS*/ 02606000
         MVC   YRSAVE2(1),PSTYR(R2)                                0931 02607000
*    SLL(YRSAVE,4); /*SHIFT 4 BITS TO MAKE ROOM FOR SIGN     @Z427VLS*/ 02608000
         SLR   @15,@15                                             0932 02609000
         ICM   @15,3,YRSAVE                                        0932 02610000
         SLL   @15,4                                               0932 02611000
         STCM  @15,3,YRSAVE                                        0932 02612000
*    YRSAVE2 = (YRSAVE2 | '0F'X); /*INSERT SIGN, NUMBER NOW PACKED*/    02613000
         OI    YRSAVE2,X'0F'                                       0933 02614000
*    CVB(YEAR,YRSAVE); /*CHANGE PACKED TO BINARY             @Z427VLS*/ 02615000
         XC    @TS00001(8),@TS00001                                0934 02616000
         MVC   @TS00001+6(2),YRSAVE                                0934 02617000
         CVB   @15,@TS00001                                        0934 02618000
         STH   @15,YEAR                                            0934 02619000
*    IF (YEARC & LEAPMASK) = HEX0000 THEN /*IF LEAP YEARC THEN*/   0935 02620000
         MVC   @TS00001(2),YEARC                                   0935 02621000
         NC    @TS00001(2),@CB01007                                0935 02622000
         CLC   @TS00001(2),@CB00208                                0935 02623000
         BNE   @RF00935                                            0935 02624000
*     DO;                                                  /*@Z427VLS*/ 02625000
*      NUMDAYS = NUMDAYS + ONE;                            /*@Z427VLS*/ 02626000
         LA    @15,1                                               0937 02627000
         ALR   @03,@15                                             0937 02628000
         ST    @03,NUMDAYS(,R2)                                    0937 02629000
*      ADDAFT = ADDAFT + ONE; /*ONE MORE DAT IN LEAPYEAR     @Z427VLS*/ 02630000
         ALR   @06,@15                                             0938 02631000
         ST    @06,ADDAFT                                          0938 02632000
*     END;                                                 /*@Z427VLS*/ 02633000
*  END;                                                    /*@Z427VLS*/ 02634000
*ELSE /*IF SAME YEAR                                         @Z427VLS*/ 02635000
*  NUMDAYS = DEND - DSTART + ONE;                          /*@Z427VLS*/ 02636000
         B     @RC00925                                            0941 02637000
@RF00925 L     @06,DEND                                            0941 02638000
         SL    @06,DSTART                                          0941 02639000
         AL    @06,@CF00056                                        0941 02640000
         ST    @06,NUMDAYS(,R2)                                    0941 02641000
*END; /*CLOSING END TO CALCRANGE                             @Z427VLS*/ 02642000
@EL00018 DS    0H                                                  0942 02643000
@EF00018 DS    0H                                                  0942 02644000
@ER00018 LM    @14,@12,12(@13)                                     0942 02645000
         BR    @14                                                 0942 02646000
*OBRFILT: PROC;                                            /*@Z427VLS*/ 02647000
OBRFILT  STM   @14,@12,@SA00019                                    0943 02648000
*IF POBR = OFF THEN                                                0944 02649000
         TM    POBR(R2),B'00100000'                                0944 02650000
         BNZ   @RF00944                                            0944 02651000
*  PASSFLAG=OFF;                                           /*@Z427VLS*/ 02652000
         NI    PASSFLAG(R2),B'11111110'                            0945 02653000
*ELSE                                                              0946 02654000
*  DO;                                                     /*@Z427VLS*/ 02655000
         B     @RC00944                                            0946 02656000
@RF00944 DS    0H                                                  0947 02657000
*    IF SHORTSW = ON THEN /*IF SHORT OBR THEN                @Z427VLS*/ 02658000
         TM    SHORTSW(R7),B'00100000'                             0947 02659000
         BNO   @RF00947                                            0947 02660000
*      DO;                                                 /*@Z427VLS*/ 02661000
*         WORKDEV = OBRSDEV2; /*GET DEVICE CODE FROM SHORT LOCATION*/   02662000
         MVC   WORKDEV(2),OBRSDEV2(R7)                             0949 02663000
*         WWCUA = (OBRSCUA & ONLYCUA3);                    /*@Z427VLS*/ 02664000
         MVC   WWCUA(3),OBRSCUA(R7)                                0950 02665000
         NC    WWCUA(3),@CB00924                                   0950 02666000
*         CUA3 = WWCUA;                                    /*@Z427VLS*/ 02667000
         MVC   CUA3(3),WWCUA                                       0951 02668000
*      END;                                                /*@Z427VLS*/ 02669000
*    ELSE /*LONG OBR BY DEFAULT                              @Z427VLS*/ 02670000
*      DO;                                                 /*@Z427VLS*/ 02671000
         B     @RC00947                                            0953 02672000
@RF00947 DS    0H                                                  0954 02673000
*        WORKDEV = OBRDEV; /*GET DEVICE CODE FROM LONG LOCATION*/  0954 02674000
         MVC   WORKDEV(2),OBRDEV(R7)                               0954 02675000
*        WWCUA = (OBRPCUA & ONLYCUA3);                     /*@Z427VLS*/ 02676000
         MVC   WWCUA(3),OBRPCUA(R7)                                0955 02677000
         NC    WWCUA(3),@CB00924                                   0955 02678000
*        CUA3 = WWCUA;                                     /*@Z427VLS*/ 02679000
         MVC   CUA3(3),WWCUA                                       0956 02680000
*      END;                                                /*@Z427VLS*/ 02681000
*    IF CUAPTR ^= ZERO THEN /*IF CUA SELECTION SPECIFIED THEN*/    0958 02682000
@RC00947 L     @06,CUAPTR(,R2)                                     0958 02683000
         LTR   @06,@06                                             0958 02684000
         BZ    @RF00958                                            0958 02685000
*      CALL CUASELCT; /*EXAMINE LIST OF VALID CUAS           @Z427VLS*/ 02686000
         BAL   @14,CUASELCT                                        0959 02687000
*    IF PASSFLAG = YES THEN                                        0960 02688000
@RF00958 TM    PASSFLAG(R2),B'00000001'                            0960 02689000
         BNO   @RF00960                                            0960 02690000
*      DO;                                                 /*@Z427VLS*/ 02691000
*        IF DEVPTR ^= ZERO THEN /*IF DEVICE SELECTION SPECIFIED THEN*/  02692000
         L     @06,DEVPTR(,R2)                                     0962 02693000
         LTR   @06,@06                                             0962 02694000
         BZ    @RF00962                                            0962 02695000
*          CALL DEVSEL; /*EXAMINE LIST OF VALID DEVICES      @Z427VLS*/ 02696000
         BAL   @14,DEVSEL                                          0963 02697000
*        IF PASSFLAG = YES THEN                                    0964 02698000
@RF00962 TM    PASSFLAG(R2),B'00000001'                            0964 02699000
         BNO   @RF00964                                            0964 02700000
*          CALL COUNTOBR; /*COUNT PERM,TEMP ERRS IF IN RECORD*/    0965 02701000
         BAL   @14,COUNTOBR                                        0965 02702000
*      END;                                                /*@Z427VLS*/ 02703000
*  END;                                                    /*@Z427VLS*/ 02704000
*END; /*CLOSING END OF OBRFILT                               @Z427VLS*/ 02705000
@EL00019 DS    0H                                                  0968 02706000
@EF00019 DS    0H                                                  0968 02707000
@ER00019 LM    @14,@12,@SA00019                                    0968 02708000
         BR    @14                                                 0968 02709000
*MDRFILT: PROC;   /*MISCELLANEOUS DATA RECORD FILTER.        @Z427VLS*/ 02710000
MDRFILT  STM   @14,@12,@SA00020                                    0969 02711000
*                 /*PASSFLAG IS TURNED OFF IF RECORD FAILS   @Z427VLS*/ 02712000
*IF PTTYP = OFF THEN  /*ARE MDR RECORDS SELECTED             @Z427VLS*/ 02713000
         TM    PTTYP(R2),B'10000000'                               0970 02714000
         BNZ   @RF00970                                            0970 02715000
*  PASSFLAG = OFF;                                         /*@Z427VLS*/ 02716000
         NI    PASSFLAG(R2),B'11111110'                            0971 02717000
*ELSE /*IF MDR RECORDS HAVE BEEN SELECTED THEN               @Z427VLS*/ 02718000
*  DO;                                                     /*@Z427VLS*/ 02719000
         B     @RC00970                                            0972 02720000
@RF00970 DS    0H                                                  0973 02721000
*    WWCUA2 = (TPRCUA & ONLYCUA2);                         /*@ZA34484*/ 02722000
         MVC   WWCUA2(2),TPRCUA(R7)                                0973 02723000
         NC    WWCUA2(2),@CB00922                                  0973 02724000
*    WORKDEV = TPRDEV; /*SET WORK ITEM TO RECORD DEVICE CODE @Z427VLS*/ 02725000
         MVI   WORKDEV+1,C' '                                      0974 02726000
         MVC   WORKDEV(1),TPRDEV(R7)                               0974 02727000
*    IF CUAPTR ^= ZERO THEN /*IF CUA SELECTION SPECIFIED THEN*/    0975 02728000
         L     @06,CUAPTR(,R2)                                     0975 02729000
         LTR   @06,@06                                             0975 02730000
         BZ    @RF00975                                            0975 02731000
*      CALL CUASELCT; /*EXAMINE LIST OF VALID CUAS           @Z427VLS*/ 02732000
         BAL   @14,CUASELCT                                        0976 02733000
*    IF PASSFLAG = YES THEN                                        0977 02734000
@RF00975 TM    PASSFLAG(R2),B'00000001'                            0977 02735000
         BNO   @RF00977                                            0977 02736000
*      DO;                                                 /*@Z427VLS*/ 02737000
*         IF DEVPTR ^= ZERO THEN /*IF DEVICE SELECTION SPECIFIED*/ 0979 02738000
         L     @06,DEVPTR(,R2)                                     0979 02739000
         LTR   @06,@06                                             0979 02740000
         BZ    @RF00979                                            0979 02741000
*           CALL DEVSEL; /*EXAMINE DEVICE SELECTION LIST     @Z427VLS*/ 02742000
         BAL   @14,DEVSEL                                          0980 02743000
*         IF PASSFLAG = YES THEN /*IF VALID DEVICE TYPE THEN @Z427VLS*/ 02744000
@RF00979 TM    PASSFLAG(R2),B'00000001'                            0981 02745000
         BNO   @RF00981                                            0981 02746000
*           DO;                                            /*@Z427VLS*/ 02747000
*    IF LRTKEY1 = HEX91 & (TPRDEV = DV3705 | TPRDEV = DV3705A) THEN     02748000
         CLI   LRTKEY1(R7),X'91'                                   0983 02749000
         BNE   @RF00983                                            0983 02750000
         CLI   TPRDEV(R7),X'05'                                    0983 02751000
         BE    @RT00983                                            0983 02752000
         CLI   TPRDEV(R7),X'15'                                    0983 02753000
         BNE   @RF00983                                            0983 02754000
@RT00983 DS    0H                                                  0984 02755000
*               CALL CONTMDR; /*PERM,TEMP ERRORS IF FROM MVS SYSTEM*/   02756000
         BAL   @14,CONTMDR                                         0984 02757000
*             ELSE                                                 0985 02758000
*               DO;                                        /*@Z427VLS*/ 02759000
         B     @RC00983                                            0985 02760000
@RF00983 DS    0H                                                  0986 02761000
*                 IF TPRDEV = DV3330 |                             0986 02762000
*                    TPRDEV = DV3340 |                             0986 02763000
*                (TPRDEV =>'16'X & TPRDEV =< '1F'X ) | /*FBA RANGE*/    02764000
*                    TPRDEV = DV33302 |                            0986 02765000
*                    TPRDEV = DV3350 THEN                          0986 02766000
         CLI   TPRDEV(R7),X'01'                                    0986 02767000
         BE    @RT00986                                            0986 02768000
         CLI   TPRDEV(R7),X'09'                                    0986 02769000
         BE    @RT00986                                            0986 02770000
         CLI   TPRDEV(R7),X'16'                                    0986 02771000
         BL    @GL00064                                            0986 02772000
         CLI   TPRDEV(R7),X'1F'                                    0986 02773000
         BNH   @RT00986                                            0986 02774000
@GL00064 CLI   TPRDEV(R7),X'0A'                                    0986 02775000
         BE    @RT00986                                            0986 02776000
         CLI   TPRDEV(R7),X'11'                                    0986 02777000
         BNE   @RF00986                                            0986 02778000
@RT00986 DS    0H                                                  0987 02779000
*                   DO;                                    /*@Z427VLS*/ 02780000
*                   IF(TPRDEV < '16'X | TPRDEV > '1F'X) THEN/*FBA */    02781000
         CLI   TPRDEV(R7),X'16'                                    0988 02782000
         BL    @RT00988                                            0988 02783000
         CLI   TPRDEV(R7),X'1F'                                    0988 02784000
         BNH   @RF00988                                            0988 02785000
@RT00988 DS    0H                                                  0989 02786000
*                     TRENDTMP  = TRENDTMP                         0989 02787000
*                                 + TPRS1213                       0989 02788000
*                                 + TPRS1415                       0989 02789000
*                                 + TPRS19;                /*@Z427VLS*/ 02790000
         LA    @06,TPRVOL(,R7)                                     0989 02791000
         LA    @03,15                                              0989 02792000
         SLR   @15,@15                                             0989 02793000
         IC    @15,TPRBUFC(,R7)                                    0989 02794000
         NR    @03,@15                                             0989 02795000
         ALR   @06,@03                                             0989 02796000
         AL    @06,@CF01191                                        0989 02797000
         ICM   @03,15,TRENDTMP                                     0989 02798000
         SLR   @15,@15                                             0989 02799000
         ICM   @15,3,TPRS1213(@06)                                 0989 02800000
         ALR   @03,@15                                             0989 02801000
         SLR   @15,@15                                             0989 02802000
         ICM   @15,3,TPRS1415(@06)                                 0989 02803000
         ALR   @03,@15                                             0989 02804000
         SLR   @15,@15                                             0989 02805000
         IC    @15,TPRS19(,@06)                                    0989 02806000
         ALR   @03,@15                                             0989 02807000
         STCM  @03,15,TRENDTMP                                     0989 02808000
* ELSE                                                             0990 02809000
*  TRENDTMP = TRENDTMP + BYTE1112 + BYTE18 + BYTE21 + BYTE13;      0990 02810000
         B     @RC00988                                            0990 02811000
@RF00988 LA    @06,TPRVOL(,R7)                                     0990 02812000
         LA    @03,15                                              0990 02813000
         SLR   @15,@15                                             0990 02814000
         IC    @15,TPRBUFC(,R7)                                    0990 02815000
         NR    @03,@15                                             0990 02816000
         ALR   @06,@03                                             0990 02817000
         AL    @06,@CF00786                                        0990 02818000
         ICM   @03,15,TRENDTMP                                     0990 02819000
         SLR   @15,@15                                             0990 02820000
         ICM   @15,3,BYTE1112(@06)                                 0990 02821000
         ALR   @03,@15                                             0990 02822000
         SLR   @15,@15                                             0990 02823000
         IC    @15,BYTE18(,@06)                                    0990 02824000
         ALR   @03,@15                                             0990 02825000
         SLR   @15,@15                                             0990 02826000
         IC    @15,BYTE21(,@06)                                    0990 02827000
         ALR   @03,@15                                             0990 02828000
         SLR   @15,@15                                             0990 02829000
         IC    @15,BYTE13(,@06)                                    0990 02830000
         ALR   @03,@15                                             0990 02831000
         STCM  @03,15,TRENDTMP                                     0990 02832000
*                     BUG(34) = BUG(34) + 1;               /*@Z427VLS*/ 02833000
@RC00988 LA    @06,1                                               0991 02834000
         L     @03,BUG+132                                         0991 02835000
         ALR   @03,@06                                             0991 02836000
         ST    @03,BUG+132                                         0991 02837000
*                     IF TRENDTMP   > ZERO THEN                    0992 02838000
         ICM   @03,15,TRENDTMP                                     0992 02839000
         BNP   @RF00992                                            0992 02840000
*                       DO;                                /*@Z427VLS*/ 02841000
*                         BUG(35) = BUG(35) + 1;           /*@Z427VLS*/ 02842000
         AL    @06,BUG+136                                         0994 02843000
         ST    @06,BUG+136                                         0994 02844000
*                         TRENDGRP  = TWO;               /*@Z427VLS*/   02845000
         MVI   TRENDGRP,X'02'                                      0995 02846000
*                         TRENDRT   = (TPRCUA & ONLYCUA2); /*@0099VLS*/ 02847000
         MVC   TRENDRT(2),TPRCUA(R7)                               0996 02848000
         NC    TRENDRT(2),@CB00922                                 0996 02849000
*                         WORKCUA = (TPRCUA & ONLYCUA2);   /*@Z427VLS*/ 02850000
         MVC   WORKCUA(2),TPRCUA(R7)                               0997 02851000
         NC    WORKCUA(2),@CB00922                                 0997 02852000
*                  LINKDEV = LINKDEV && LINKDEV;           /*@D35UGGB*/ 02853000
         XC    LINKDEV(4),LINKDEV                                  0998 02854000
*                  CALL IFCDEVIC(14,TPRDEV,LINKDEV);       /*@D35UGGB*/ 02855000
         MVC   @AL00001(12),@AL00999                               0999 02856000
         LA    @06,TPRDEV(,R7)                                     0999 02857000
         ST    @06,@AL00001+4                                      0999 02858000
         L     @15,@CV01429                                        0999 02859000
         LA    @01,@AL00001                                        0999 02860000
         BALR  @14,@15                                             0999 02861000
*                  TRENDDEV = DEVLABEL;                    /*@D35UGGB*/ 02862000
         MVC   TRENDDEV(2),DEVLABEL                                1000 02863000
*                         CALL SETCPU;                     /*@Z427VLS*/ 02864000
         BAL   @14,SETCPU                                          1001 02865000
*                         TRENDDAT  = TREIDX;            /*@Z427VLS*/   02866000
         IC    @06,TREIDX                                          1002 02867000
         STC   @06,TRENDDAT                                        1002 02868000
*                       END;                               /*@Z427VLS*/ 02869000
*                     END;                                 /*@Z427VLS*/ 02870000
*                   ELSE                                           1005 02871000
*                    IF TPRDEV = '40'X THEN                        1005 02872000
         B     @RC00986                                            1005 02873000
@RF00986 CLI   TPRDEV(R7),X'40'                                    1005 02874000
         BNE   @RF01005                                            1005 02875000
*                      DO WORKCUA = (TPRCUA & ONLYCUA2);   /*@D3503VS*/ 02876000
         LA    @06,4095                                            1006 02877000
         LH    @03,TPRCUA(,R7)                                     1006 02878000
         N     @03,@CF01606                                        1006 02879000
         NR    @06,@03                                             1006 02880000
         STH   @06,WORKCUA                                         1006 02881000
*                        TRENDGRP = THREE;                 /*@D3503VS*/ 02882000
         MVI   TRENDGRP,X'03'                                      1007 02883000
*                        TRENDTMP = TRENDTMP + TPRTMPR + TPRTMPW;  1008 02884000
         LA    @06,TPRVOL(,R7)                                     1008 02885000
         LA    @03,15                                              1008 02886000
         SLR   @15,@15                                             1008 02887000
         IC    @15,TPRBUFC(,R7)                                    1008 02888000
         NR    @03,@15                                             1008 02889000
         ALR   @06,@03                                             1008 02890000
         ICM   @03,15,TRENDTMP                                     1008 02891000
         SLR   @15,@15                                             1008 02892000
         IC    @15,TPRTMPR(,@06)                                   1008 02893000
         ALR   @03,@15                                             1008 02894000
         SLR   @15,@15                                             1008 02895000
         IC    @15,TPRTMPW(,@06)                                   1008 02896000
         ALR   @03,@15                                             1008 02897000
         STCM  @03,15,TRENDTMP                                     1008 02898000
*                        TRENDRT = WORKCUA;                /*@D3503VS*/ 02899000
         MVC   TRENDRT(2),WORKCUA                                  1009 02900000
*                        TRENDDEV = '8809'X;               /*@D3503VS*/ 02901000
         MVC   TRENDDEV(2),@CB01497                                1010 02902000
*                        CALL SETCPU;                      /*@D3503VS*/ 02903000
         BAL   @14,SETCPU                                          1011 02904000
*                        TRENDDAT = TREIDX;                /*@D3503VS*/ 02905000
         IC    @06,TREIDX                                          1012 02906000
         STC   @06,TRENDDAT                                        1012 02907000
*                       END;                               /*@D3503VS*/ 02908000
*                   ELSE                                           1014 02909000
*                     BUG(31) = BUG(31) +1;                /*@Z427VLS*/ 02910000
         B     @RC01005                                            1014 02911000
@RF01005 LA    @06,1                                               1014 02912000
         AL    @06,BUG+120                                         1014 02913000
         ST    @06,BUG+120                                         1014 02914000
*                 END;                                     /*@Z427VLS*/ 02915000
*           END;                                           /*@Z427VLS*/ 02916000
*       END;                                               /*@Z427VLS*/ 02917000
*  END;                                                    /*@Z427VLS*/ 02918000
*END;/*CLOSING END FOR MDRFILT PROC                          @Z427VLS*/ 02919000
@EL00020 DS    0H                                                  1019 02920000
@EF00020 DS    0H                                                  1019 02921000
@ER00020 LM    @14,@12,@SA00020                                    1019 02922000
         BR    @14                                                 1019 02923000
*DDRFILT: PROC;                                            /*@Z427VLS*/ 02924000
DDRFILT  STM   @14,@12,@SA00021                                    1020 02925000
*BUG(24) = BUG(24) + 1; /*DDRS IDENTIFIED                    @Z427VLS*/ 02926000
         LA    @06,1                                               1021 02927000
         AL    @06,BUG+92                                          1021 02928000
         ST    @06,BUG+92                                          1021 02929000
*IF PDDR = OFF THEN                                                1022 02930000
         TM    PDDR(R2),B'00000100'                                1022 02931000
         BNZ   @RF01022                                            1022 02932000
*  PASSFLAG = OFF;                                         /*@Z427VLS*/ 02933000
         NI    PASSFLAG(R2),B'11111110'                            1023 02934000
*ELSE                                                              1024 02935000
*  DO;                                                     /*@Z427VLS*/ 02936000
         B     @RC01022                                            1024 02937000
@RF01022 DS    0H                                                  1025 02938000
*    IF CUAPTR ^= ZERO THEN /*IF CUA SELECTION SPECIFIED THEN*/    1025 02939000
         L     @06,CUAPTR(,R2)                                     1025 02940000
         LTR   @06,@06                                             1025 02941000
         BZ    @RF01025                                            1025 02942000
*      DO;                                                 /*@Z427VLS*/ 02943000
*      WWCUA = DDRFCUA; /*GET FROM CUA FROM RECORD           @Z427VLS*/ 02944000
         MVC   WWCUA(3),DDRFCUA(R7)                                1027 02945000
*      CALL CUASELCT; /*EXAMINE LIST OF VALID CUA RANGES     @Z427VLS*/ 02946000
         BAL   @14,CUASELCT                                        1028 02947000
*      END;                                                /*@Z427VLS*/ 02948000
*    IF PASSFLAG = YES THEN /*IF CUA ON LIST THEN            @Z427VLS*/ 02949000
@RF01025 TM    PASSFLAG(R2),B'00000001'                            1030 02950000
         BNO   @RF01030                                            1030 02951000
*      DO;                                                 /*@Z427VLS*/ 02952000
*        IF DEVPTR ^= ZERO THEN                                    1032 02953000
         L     @06,DEVPTR(,R2)                                     1032 02954000
         LTR   @06,@06                                             1032 02955000
         BZ    @RF01032                                            1032 02956000
*          DO;                                             /*@Z427VLS*/ 02957000
*          WORKDEV = DDRCODE2;                             /*@Z427VLS*/ 02958000
         MVC   WORKDEV(2),DDRCODE2(R7)                             1034 02959000
*          CALL DEVSEL;                                    /*@Z427VLS*/ 02960000
         BAL   @14,DEVSEL                                          1035 02961000
*          END;                                            /*@Z427VLS*/ 02962000
*        IF PASSFLAG = YES THEN                                    1037 02963000
@RF01032 TM    PASSFLAG(R2),B'00000001'                            1037 02964000
         BNO   @RF01037                                            1037 02965000
*          BUG(25) = BUG(25) + 1;                          /*@Z427VLS*/ 02966000
         LA    @06,1                                               1038 02967000
         AL    @06,BUG+96                                          1038 02968000
         ST    @06,BUG+96                                          1038 02969000
*      END;                                                /*@Z427VLS*/ 02970000
*  END;                                                    /*@Z427VLS*/ 02971000
*END;                                                      /*@Z427VLS*/ 02972000
@EL00021 DS    0H                                                  1041 02973000
@EF00021 DS    0H                                                  1041 02974000
@ER00021 LM    @14,@12,@SA00021                                    1041 02975000
         BR    @14                                                 1041 02976000
*MIHFILT: PROC;                                            /*@Z427VLS*/ 02977000
MIHFILT  STM   @14,@12,@SA00022                                    1042 02978000
*BUG(26) = BUG(26) + 1; /*NUMBER OF MIH RECORDS IDENTIFIED   @Z427VLS*/ 02979000
         LA    @06,1                                               1043 02980000
         AL    @06,BUG+100                                         1043 02981000
         ST    @06,BUG+100                                         1043 02982000
*IF PMIH = OFF THEN                                                1044 02983000
         TM    PMIH(R2),B'00000010'                                1044 02984000
         BNZ   @RF01044                                            1044 02985000
*  PASSFLAG = OFF;                                         /*@Z427VLS*/ 02986000
         NI    PASSFLAG(R2),B'11111110'                            1045 02987000
*ELSE                                                              1046 02988000
*  DO;                                                     /*@Z427VLS*/ 02989000
         B     @RC01044                                            1046 02990000
@RF01044 DS    0H                                                  1047 02991000
*    IF CUAPTR ^= ZERO THEN                                        1047 02992000
         L     @06,CUAPTR(,R2)                                     1047 02993000
         LTR   @06,@06                                             1047 02994000
         BZ    @RF01047                                            1047 02995000
*      DO;                                                 /*@Z427VLS*/ 02996000
*        WWCUA = MIHCUA;                                   /*@Z427VLS*/ 02997000
         MVC   WWCUA(3),MIHCUA(R7)                                 1049 02998000
*        CALL CUASELCT;                                    /*@Z427VLS*/ 02999000
         BAL   @14,CUASELCT                                        1050 03000000
*      END;                                                /*@Z427VLS*/ 03001000
*    IF PASSFLAG = YES THEN                                        1052 03002000
@RF01047 TM    PASSFLAG(R2),B'00000001'                            1052 03003000
         BNO   @RF01052                                            1052 03004000
*      DO;                                                 /*@Z427VLS*/ 03005000
*        IF DEVPTR ^= ZERO THEN /*IF DEVICE SELECTION SPECIFIED*/  1054 03006000
         L     @06,DEVPTR(,R2)                                     1054 03007000
         LTR   @06,@06                                             1054 03008000
         BZ    @RF01054                                            1054 03009000
*          DO;                                             /*@Z427VLS*/ 03010000
*            WORKDEV = MIHCODE2;                           /*@Z427VLS*/ 03011000
         MVC   WORKDEV(2),MIHCODE2(R7)                             1056 03012000
*            CALL DEVSEL; /*EXAMINE LIST OF VALID DEVICES    @Z427VLS*/ 03013000
         BAL   @14,DEVSEL                                          1057 03014000
*           END;                                           /*@Z427VLS*/ 03015000
*        IF PASSFLAG = YES THEN                                    1059 03016000
@RF01054 TM    PASSFLAG(R2),B'00000001'                            1059 03017000
         BNO   @RF01059                                            1059 03018000
*          BUG(27) = BUG(27) + 1;                          /*@Z427VLS*/ 03019000
         LA    @06,1                                               1060 03020000
         AL    @06,BUG+104                                         1060 03021000
         ST    @06,BUG+104                                         1060 03022000
*       END;                                               /*@Z427VLS*/ 03023000
*   END;                                                   /*@Z427VLS*/ 03024000
*END;                                                      /*@Z427VLS*/ 03025000
@EL00022 DS    0H                                                  1063 03026000
@EF00022 DS    0H                                                  1063 03027000
@ER00022 LM    @14,@12,@SA00022                                    1063 03028000
         BR    @14                                                 1063 03029000
*CCHFILT: PROC;                                            /*@Z427VLS*/ 03030000
CCHFILT  STM   @14,@12,@SA00023                                    1064 03031000
*DCL  INDEX   FIXED(31);                                   /*@0099VLS*/ 03032000
*BUG(18) = BUG(18) + 1; /*NUMBER OF CCH RECORDS IDENTIFIED   @Z427VLS*/ 03033000
         LA    @06,1                                               1066 03034000
         AL    @06,BUG+68                                          1066 03035000
         ST    @06,BUG+68                                          1066 03036000
*IF PCHAN = OFF THEN                                               1067 03037000
         TM    PCHAN(R2),B'01000000'                               1067 03038000
         BNZ   @RF01067                                            1067 03039000
*  PASSFLAG = OFF;                                         /*@Z427VLS*/ 03040000
         NI    PASSFLAG(R2),B'11111110'                            1068 03041000
*ELSE                                                              1069 03042000
*  DO;                                                     /*@Z427VLS*/ 03043000
         B     @RC01067                                            1069 03044000
@RF01067 DS    0H                                                  1070 03045000
*    IF CUAPTR ^= ZERO THEN /*IF CUA SELECTION SPECIFIED THEN*/    1070 03046000
         L     @06,CUAPTR(,R2)                                     1070 03047000
         LTR   @06,@06                                             1070 03048000
         BZ    @RF01070                                            1070 03049000
*      DO;                                                 /*@Z427VLS*/ 03050000
*        WWCUA2 = (WWCUA2 & ONLYCUA2);                     /*@Z427VLS*/ 03051000
         NC    WWCUA2(2),@CB00922                                  1072 03052000
*        CALL CUASELCT;                                    /*@Z427VLS*/ 03053000
         BAL   @14,CUASELCT                                        1073 03054000
*      END;                                                /*@Z427VLS*/ 03055000
*        IF PASSFLAG = YES THEN                                    1075 03056000
@RF01070 TM    PASSFLAG(R2),B'00000001'                            1075 03057000
         BNO   @RF01075                                            1075 03058000
*          DO;                                             /*@Z427VLS*/ 03059000
*            CALL TREADR;  /*ADDR CCH ENT REL TO  CPU SER   @ZA27824 */ 03060000
         BAL   @14,TREADR                                          1077 03061000
*           IF CPU0FLG = OFF THEN                                  1078 03062000
         TM    CPU0FLG,B'00001000'                                 1078 03063000
         BNZ   @RF01078                                            1078 03064000
*            DO;                                           /*@Z427VLS*/ 03065000
*    INDEX = CCHCUA;                                       /*@0099VLS*/ 03066000
         SLR   @06,@06                                             1080 03067000
         ICM   @06,3,CCHCUA(R7)                                    1080 03068000
         ST    @06,INDEX                                           1080 03069000
*    SRL(INDEX,8);                                         /*@0001VLS*/ 03070000
         SRL   @06,8                                               1081 03071000
         ST    @06,INDEX                                           1081 03072000
*    IF INDEX = 0 THEN                                             1082 03073000
         L     @06,INDEX                                           1082 03074000
         LTR   @06,@06                                             1082 03075000
         BNZ   @RF01082                                            1082 03076000
*       TRECCH0(TREIDX) = TRECCH0(TREIDX) + 1;             /*@G51DGVS*/ 03077000
         SLR   @06,@06                                             1083 03078000
         IC    @06,TREIDX                                          1083 03079000
         MH    @06,@CH01385                                        1083 03080000
         L     @03,TRENPTR(,R2)                                    1083 03081000
         LA    @15,1                                               1083 03082000
         LA    @14,0(@06,@03)                                      1083 03083000
         AL    @14,@CF01619                                        1083 03084000
         AL    @15,TRECCH0-16(,@14)                                1083 03085000
         AL    @03,@CF01619                                        1083 03086000
         ST    @15,TRECCH0-16(@06,@03)                             1083 03087000
*    ELSE                                                          1084 03088000
*     IF INDEX = 1 THEN                                            1084 03089000
         B     @RC01082                                            1084 03090000
@RF01082 LA    @06,1                                               1084 03091000
         C     @06,INDEX                                           1084 03092000
         BNE   @RF01084                                            1084 03093000
*        TRECCH1(TREIDX) = TRECCH1(TREIDX) + 1;            /*@G51DGVS*/ 03094000
         SLR   @03,@03                                             1085 03095000
         IC    @03,TREIDX                                          1085 03096000
         MH    @03,@CH01385                                        1085 03097000
         L     @15,TRENPTR(,R2)                                    1085 03098000
         LA    @01,0(@03,@15)                                      1085 03099000
         AL    @01,@CF01620                                        1085 03100000
         AL    @06,TRECCH1-20(,@01)                                1085 03101000
         AL    @15,@CF01620                                        1085 03102000
         ST    @06,TRECCH1-20(@03,@15)                             1085 03103000
*     ELSE                                                         1086 03104000
*      IF INDEX = 2 THEN                                           1086 03105000
         B     @RC01084                                            1086 03106000
@RF01084 CLC   INDEX(4),@CF00074                                   1086 03107000
         BNE   @RF01086                                            1086 03108000
*         TRECCH2(TREIDX) = TRECCH2(TREIDX) + 1;           /*@G51DGVS*/ 03109000
         SLR   @06,@06                                             1087 03110000
         IC    @06,TREIDX                                          1087 03111000
         MH    @06,@CH01385                                        1087 03112000
         L     @03,TRENPTR(,R2)                                    1087 03113000
         LA    @15,1                                               1087 03114000
         LA    @14,0(@06,@03)                                      1087 03115000
         AL    @14,@CF01621                                        1087 03116000
         AL    @15,TRECCH2-24(,@14)                                1087 03117000
         AL    @03,@CF01621                                        1087 03118000
         ST    @15,TRECCH2-24(@06,@03)                             1087 03119000
*      ELSE                                                        1088 03120000
*       IF INDEX = 3 THEN                                          1088 03121000
         B     @RC01086                                            1088 03122000
@RF01086 CLC   INDEX(4),@CF00076                                   1088 03123000
         BNE   @RF01088                                            1088 03124000
*          TRECCH3(TREIDX) = TRECCH3(TREIDX) + 1;          /*@G51DGVS*/ 03125000
         SLR   @06,@06                                             1089 03126000
         IC    @06,TREIDX                                          1089 03127000
         MH    @06,@CH01385                                        1089 03128000
         L     @03,TRENPTR(,R2)                                    1089 03129000
         LA    @15,1                                               1089 03130000
         LA    @14,0(@06,@03)                                      1089 03131000
         AL    @14,@CF01622                                        1089 03132000
         AL    @15,TRECCH3-28(,@14)                                1089 03133000
         AL    @03,@CF01622                                        1089 03134000
         ST    @15,TRECCH3-28(@06,@03)                             1089 03135000
*       ELSE                                                       1090 03136000
*        IF INDEX = 4 THEN                                         1090 03137000
         B     @RC01088                                            1090 03138000
@RF01088 CLC   INDEX(4),@CF00065                                   1090 03139000
         BNE   @RF01090                                            1090 03140000
*           TRECCH4(TREIDX) = TRECCH4(TREIDX) + 1;         /*@G51DGVS*/ 03141000
         SLR   @06,@06                                             1091 03142000
         IC    @06,TREIDX                                          1091 03143000
         MH    @06,@CH01385                                        1091 03144000
         L     @03,TRENPTR(,R2)                                    1091 03145000
         LA    @15,1                                               1091 03146000
         LA    @14,0(@06,@03)                                      1091 03147000
         AL    @14,@CF01623                                        1091 03148000
         AL    @15,TRECCH4-32(,@14)                                1091 03149000
         AL    @03,@CF01623                                        1091 03150000
         ST    @15,TRECCH4-32(@06,@03)                             1091 03151000
*        ELSE                                                      1092 03152000
*         IF INDEX = 5 THEN                                        1092 03153000
         B     @RC01090                                            1092 03154000
@RF01090 CLC   INDEX(4),@CF00079                                   1092 03155000
         BNE   @RF01092                                            1092 03156000
*            TRECCH5(TREIDX) = TRECCH5(TREIDX) + 1;        /*@G51DGVS*/ 03157000
         SLR   @06,@06                                             1093 03158000
         IC    @06,TREIDX                                          1093 03159000
         MH    @06,@CH01385                                        1093 03160000
         L     @03,TRENPTR(,R2)                                    1093 03161000
         LA    @15,1                                               1093 03162000
         LA    @14,0(@06,@03)                                      1093 03163000
         AL    @14,@CF01624                                        1093 03164000
         AL    @15,TRECCH5-36(,@14)                                1093 03165000
         AL    @03,@CF01624                                        1093 03166000
         ST    @15,TRECCH5-36(@06,@03)                             1093 03167000
*         ELSE                                                     1094 03168000
*          IF INDEX = 6 THEN                                       1094 03169000
         B     @RC01092                                            1094 03170000
@RF01092 CLC   INDEX(4),@CF00081                                   1094 03171000
         BNE   @RF01094                                            1094 03172000
*             TRECCH6(TREIDX) = TRECCH6(TREIDX) + 1;       /*@G51DGVS*/ 03173000
         SLR   @06,@06                                             1095 03174000
         IC    @06,TREIDX                                          1095 03175000
         MH    @06,@CH01385                                        1095 03176000
         L     @03,TRENPTR(,R2)                                    1095 03177000
         LA    @15,1                                               1095 03178000
         LA    @14,0(@06,@03)                                      1095 03179000
         AL    @14,@CF01625                                        1095 03180000
         AL    @15,TRECCH6-40(,@14)                                1095 03181000
         AL    @03,@CF01625                                        1095 03182000
         ST    @15,TRECCH6-40(@06,@03)                             1095 03183000
*          ELSE                                                    1096 03184000
*           IF INDEX = 7 THEN                                      1096 03185000
         B     @RC01094                                            1096 03186000
@RF01094 CLC   INDEX(4),@CF00083                                   1096 03187000
         BNE   @RF01096                                            1096 03188000
*              TRECCH7(TREIDX) = TRECCH7(TREIDX) + 1;      /*@G51DGVS*/ 03189000
         SLR   @06,@06                                             1097 03190000
         IC    @06,TREIDX                                          1097 03191000
         MH    @06,@CH01385                                        1097 03192000
         L     @03,TRENPTR(,R2)                                    1097 03193000
         LA    @15,1                                               1097 03194000
         LA    @14,0(@06,@03)                                      1097 03195000
         AL    @14,@CF01626                                        1097 03196000
         AL    @15,TRECCH7-44(,@14)                                1097 03197000
         AL    @03,@CF01626                                        1097 03198000
         ST    @15,TRECCH7-44(@06,@03)                             1097 03199000
*           ELSE                                                   1098 03200000
*            IF INDEX = 8 THEN                                     1098 03201000
         B     @RC01096                                            1098 03202000
@RF01096 CLC   INDEX(4),@CF00036                                   1098 03203000
         BNE   @RF01098                                            1098 03204000
*               TRECCH8(TREIDX) = TRECCH8(TREIDX) + 1;     /*@G51DGVS*/ 03205000
         SLR   @06,@06                                             1099 03206000
         IC    @06,TREIDX                                          1099 03207000
         MH    @06,@CH01385                                        1099 03208000
         L     @03,TRENPTR(,R2)                                    1099 03209000
         LA    @15,1                                               1099 03210000
         LA    @14,0(@06,@03)                                      1099 03211000
         AL    @14,@CF01627                                        1099 03212000
         AL    @15,TRECCH8-48(,@14)                                1099 03213000
         AL    @03,@CF01627                                        1099 03214000
         ST    @15,TRECCH8-48(@06,@03)                             1099 03215000
*            ELSE                                                  1100 03216000
*             IF INDEX = 9 THEN                                    1100 03217000
         B     @RC01098                                            1100 03218000
@RF01098 CLC   INDEX(4),@CF00035                                   1100 03219000
         BNE   @RF01100                                            1100 03220000
*                TRECCH9(TREIDX) = TRECCH9(TREIDX) + 1;    /*@G51DGVS*/ 03221000
         SLR   @06,@06                                             1101 03222000
         IC    @06,TREIDX                                          1101 03223000
         MH    @06,@CH01385                                        1101 03224000
         L     @03,TRENPTR(,R2)                                    1101 03225000
         LA    @15,1                                               1101 03226000
         LA    @14,0(@06,@03)                                      1101 03227000
         AL    @14,@CF01628                                        1101 03228000
         AL    @15,TRECCH9-52(,@14)                                1101 03229000
         AL    @03,@CF01628                                        1101 03230000
         ST    @15,TRECCH9-52(@06,@03)                             1101 03231000
*             ELSE                                                 1102 03232000
*              IF INDEX = 10 THEN                                  1102 03233000
         B     @RC01100                                            1102 03234000
@RF01100 CLC   INDEX(4),@CF00034                                   1102 03235000
         BNE   @RF01102                                            1102 03236000
*                 TRECCHA(TREIDX) = TRECCHA(TREIDX) + 1;   /*@G51DGVS*/ 03237000
         SLR   @06,@06                                             1103 03238000
         IC    @06,TREIDX                                          1103 03239000
         MH    @06,@CH01385                                        1103 03240000
         L     @03,TRENPTR(,R2)                                    1103 03241000
         LA    @15,1                                               1103 03242000
         LA    @14,0(@06,@03)                                      1103 03243000
         AL    @14,@CF01602                                        1103 03244000
         AL    @15,TRECCHA-56(,@14)                                1103 03245000
         AL    @03,@CF01602                                        1103 03246000
         ST    @15,TRECCHA-56(@06,@03)                             1103 03247000
*               IF INDEX = 11 THEN /*TO MANY IFS HAVE TO GO THIS WAY*/  03248000
@RF01102 DS    0H                                                  1104 03249000
@RC01100 DS    0H                                                  1104 03250000
@RC01098 DS    0H                                                  1104 03251000
@RC01096 DS    0H                                                  1104 03252000
@RC01094 DS    0H                                                  1104 03253000
@RC01092 DS    0H                                                  1104 03254000
@RC01090 DS    0H                                                  1104 03255000
@RC01088 DS    0H                                                  1104 03256000
@RC01086 DS    0H                                                  1104 03257000
@RC01084 DS    0H                                                  1104 03258000
@RC01082 CLC   INDEX(4),@CF00033                                   1104 03259000
         BNE   @RF01104                                            1104 03260000
*                  TRECCHB(TREIDX) = TRECCHB(TREIDX) + 1;  /*@G51DGVS*/ 03261000
         SLR   @06,@06                                             1105 03262000
         IC    @06,TREIDX                                          1105 03263000
         MH    @06,@CH01385                                        1105 03264000
         L     @03,TRENPTR(,R2)                                    1105 03265000
         LA    @15,1                                               1105 03266000
         LA    @14,0(@06,@03)                                      1105 03267000
         AL    @14,@CF01629                                        1105 03268000
         AL    @15,TRECCHB-60(,@14)                                1105 03269000
         AL    @03,@CF01629                                        1105 03270000
         ST    @15,TRECCHB-60(@06,@03)                             1105 03271000
*               ELSE                                               1106 03272000
*                IF INDEX = 12 THEN                                1106 03273000
         B     @RC01104                                            1106 03274000
@RF01104 CLC   INDEX(4),@CF00032                                   1106 03275000
         BNE   @RF01106                                            1106 03276000
*                   TRECCHC(TREIDX) = TRECCHC(TREIDX) + 1; /*@G51DGVS*/ 03277000
         SLR   @06,@06                                             1107 03278000
         IC    @06,TREIDX                                          1107 03279000
         MH    @06,@CH01385                                        1107 03280000
         L     @03,TRENPTR(,R2)                                    1107 03281000
         LA    @15,1                                               1107 03282000
         LA    @14,0(@06,@03)                                      1107 03283000
         AL    @14,@CF01630                                        1107 03284000
         AL    @15,TRECCHC-64(,@14)                                1107 03285000
         AL    @03,@CF01630                                        1107 03286000
         ST    @15,TRECCHC-64(@06,@03)                             1107 03287000
*                ELSE                                              1108 03288000
*                 IF INDEX = 13 THEN                               1108 03289000
         B     @RC01106                                            1108 03290000
@RF01106 CLC   INDEX(4),@CF01029                                   1108 03291000
         BNE   @RF01108                                            1108 03292000
*                    TRECCHD(TREIDX) = TRECCHD(TREIDX) + 1;/*@G51DGVS*/ 03293000
         SLR   @06,@06                                             1109 03294000
         IC    @06,TREIDX                                          1109 03295000
         MH    @06,@CH01385                                        1109 03296000
         L     @03,TRENPTR(,R2)                                    1109 03297000
         LA    @15,1                                               1109 03298000
         LA    @14,0(@06,@03)                                      1109 03299000
         AL    @14,@CF01631                                        1109 03300000
         AL    @15,TRECCHD-68(,@14)                                1109 03301000
         AL    @03,@CF01631                                        1109 03302000
         ST    @15,TRECCHD-68(@06,@03)                             1109 03303000
*                 ELSE                                             1110 03304000
*                  IF INDEX = 14 THEN                              1110 03305000
         B     @RC01108                                            1110 03306000
@RF01108 CLC   INDEX(4),@CF00952                                   1110 03307000
         BNE   @RF01110                                            1110 03308000
*                     TRECCHE(TREIDX) = TRECCHE(TREIDX) + 1;       1111 03309000
         SLR   @06,@06                                             1111 03310000
         IC    @06,TREIDX                                          1111 03311000
         MH    @06,@CH01385                                        1111 03312000
         L     @03,TRENPTR(,R2)                                    1111 03313000
         LA    @15,1                                               1111 03314000
         LA    @14,0(@06,@03)                                      1111 03315000
         AL    @14,@CF01615                                        1111 03316000
         AL    @15,TRECCHE-72(,@14)                                1111 03317000
         AL    @03,@CF01615                                        1111 03318000
         ST    @15,TRECCHE-72(@06,@03)                             1111 03319000
*                  ELSE                                            1112 03320000
*          IF INDEX = 15 THEN                                      1112 03321000
         B     @RC01110                                            1112 03322000
@RF01110 CLC   INDEX(4),@CF00037                                   1112 03323000
         BNE   @RF01112                                            1112 03324000
*                      TRECCHF(TREIDX) = TRECCHF(TREIDX) + 1;      1113 03325000
         SLR   @06,@06                                             1113 03326000
         IC    @06,TREIDX                                          1113 03327000
         MH    @06,@CH01385                                        1113 03328000
         L     @03,TRENPTR(,R2)                                    1113 03329000
         LA    @15,1                                               1113 03330000
         AL    @15,TRECCHF-76(@06,@03)                             1113 03331000
         ST    @15,TRECCHF-76(@06,@03)                             1113 03332000
*            BUG(19) = BUG(19) + 1;                        /*@Z427VLS*/ 03333000
@RF01112 DS    0H                                                  1114 03334000
@RC01110 DS    0H                                                  1114 03335000
@RC01108 DS    0H                                                  1114 03336000
@RC01106 DS    0H                                                  1114 03337000
@RC01104 LA    @06,1                                               1114 03338000
         L     @03,BUG+72                                          1114 03339000
         ALR   @03,@06                                             1114 03340000
         ST    @03,BUG+72                                          1114 03341000
*           IF FRAMEPTR ^= ZERO THEN /*IF FRAMETAB IS ALLOCATED*/  1115 03342000
         L     @03,FRAMEPTR(,R2)                                   1115 03343000
         LTR   @03,@03                                             1115 03344000
         BZ    @RF01115                                            1115 03345000
*            DO;                                           /*@G51DGBB*/ 03346000
*           GETOUT = NO;                                   /*@G51DGBB*/ 03347000
         NI    GETOUT,B'10111111'                                  1117 03348000
*            DO A = 1 BY 1 TO MRDNUMBR WHILE GETOUT = NO;  /*@G51DGBB*/ 03349000
         ST    @06,A                                               1118 03350000
         B     @DE01118                                            1118 03351000
@DL01118 TM    GETOUT,B'01000000'                                  1118 03352000
         BNZ   @DC01118                                            1118 03353000
*              IF MODEL(A) = LRTMODEL THEN                         1119 03354000
         ALR   @06,@06                                             1119 03355000
         L     @03,MERDCPTR(,R2)                                   1119 03356000
         ALR   @03,@06                                             1119 03357000
         CLC   MODEL-2(2,@03),LRTMODEL(R7)                         1119 03358000
         BNE   @RF01119                                            1119 03359000
*                DO;                                       /*@G51DGBB*/ 03360000
*                  CALL BUILDFTB; /*IF UNIQUE,BUILD FRAMTAB ENTRY*/     03361000
         BAL   @14,BUILDFTB                                        1121 03362000
*                  GETOUT = YES;  /*EXIT LOOP                @G51DGBB*/ 03363000
         OI    GETOUT,B'01000000'                                  1122 03364000
*                END;                                      /*@G51DGBB*/ 03365000
*            END;                                          /*@G51DGBB*/ 03366000
@RF01119 LA    @06,1                                               1124 03367000
         AL    @06,A                                               1124 03368000
         ST    @06,A                                               1124 03369000
@DE01118 L     @03,MERDCPTR(,R2)                                   1124 03370000
         CH    @06,MRDNUMBR(,@03)                                  1124 03371000
         BNH   @DL01118                                            1124 03372000
@DC01118 DS    0H                                                  1125 03373000
*            END;                                          /*@G51DGBB*/ 03374000
*            END;                                          /*@Z427VLS*/ 03375000
*           END;                                           /*@Z427VLS*/ 03376000
*   END;                                                   /*@Z427VLS*/ 03377000
*END;                                                      /*@Z427VLS*/ 03378000
@EL00023 DS    0H                                                  1129 03379000
@EF00023 DS    0H                                                  1129 03380000
@ER00023 LM    @14,@12,@SA00023                                    1129 03381000
         BR    @14                                                 1129 03382000
*IPLFILT: PROC;                                            /*@Z427VLS*/ 03383000
IPLFILT  STM   @14,@12,@SA00024                                    1130 03384000
*BUG(22) = BUG(22) + 1;                                    /*@Z427VLS*/ 03385000
         LA    @06,1                                               1131 03386000
         AL    @06,BUG+84                                          1131 03387000
         ST    @06,BUG+84                                          1131 03388000
*IF PIPL = OFF THEN                                                1132 03389000
         TM    PIPL(R2),B'00001000'                                1132 03390000
         BNZ   @RF01132                                            1132 03391000
*  PASSFLAG = OFF;                                         /*@Z427VLS*/ 03392000
         NI    PASSFLAG(R2),B'11111110'                            1133 03393000
*ELSE                                                              1134 03394000
*  DO;                                                     /*@Z427VLS*/ 03395000
         B     @RC01132                                            1134 03396000
@RF01132 DS    0H                                                  1135 03397000
*   CALL TREADR;  /*ADDRESS IPL ENT RELATING TO REC CPU SER @ZA27824 */ 03398000
         BAL   @14,TREADR                                          1135 03399000
*   IF CPU0FLG = OFF THEN                                          1136 03400000
         TM    CPU0FLG,B'00001000'                                 1136 03401000
         BNZ   @RF01136                                            1136 03402000
*    DO;                                                   /*@Z427VLS*/ 03403000
*    BUG(23) = BUG(23) + 1;                                /*@Z427VLS*/ 03404000
         LA    @06,1                                               1138 03405000
         L     @03,BUG+88                                          1138 03406000
         ALR   @03,@06                                             1138 03407000
         ST    @03,BUG+88                                          1138 03408000
*    TREIPL(TREIDX) = TREIPL(TREIDX) + ONE; /*ADD TO MCH REC. COUNT*/   03409000
         SLR   @03,@03                                             1139 03410000
         IC    @03,TREIDX                                          1139 03411000
         MH    @03,@CH01385                                        1139 03412000
         L     @15,TRENPTR(,R2)                                    1139 03413000
         LA    @01,0(@03,@15)                                      1139 03414000
         AL    @01,@CF01601                                        1139 03415000
         AL    @06,TREIPL-8(,@01)                                  1139 03416000
         AL    @15,@CF01601                                        1139 03417000
         ST    @06,TREIPL-8(@03,@15)                               1139 03418000
*    END;                                                  /*@Z427VLS*/ 03419000
*  END;                                                    /*@Z427VLS*/ 03420000
*END;                                                      /*@Z427VLS*/ 03421000
@EL00024 DS    0H                                                  1142 03422000
@EF00024 DS    0H                                                  1142 03423000
@ER00024 LM    @14,@12,@SA00024                                    1142 03424000
         BR    @14                                                 1142 03425000
*EODFILT: PROC;                                            /*@Z427VLS*/ 03426000
EODFILT  STM   @14,@12,12(@13)                                     1143 03427000
*BUG(28) = BUG(28) + 1;                                    /*@Z427VLS*/ 03428000
         LA    @06,1                                               1144 03429000
         AL    @06,BUG+108                                         1144 03430000
         ST    @06,BUG+108                                         1144 03431000
*IF PEOD = OFF THEN                                                1145 03432000
         TM    PEOD(R2),B'00000001'                                1145 03433000
         BNZ   @RF01145                                            1145 03434000
*  PASSFLAG = OFF;                                         /*@Z427VLS*/ 03435000
         NI    PASSFLAG(R2),B'11111110'                            1146 03436000
*ELSE /*IF PASSED FILTERING                                  @Z427VLS*/ 03437000
*  BUG(29) = BUG(29) + 1;                                  /*@Z427VLS*/ 03438000
         B     @RC01145                                            1147 03439000
@RF01145 LA    @06,1                                               1147 03440000
         AL    @06,BUG+112                                         1147 03441000
         ST    @06,BUG+112                                         1147 03442000
*END;                                                      /*@Z427VLS*/ 03443000
@EL00025 DS    0H                                                  1148 03444000
@EF00025 DS    0H                                                  1148 03445000
@ER00025 LM    @14,@12,12(@13)                                     1148 03446000
         BR    @14                                                 1148 03447000
*MCHFILT: PROC;                                            /*@Z427VLS*/ 03448000
MCHFILT  STM   @14,@12,@SA00026                                    1149 03449000
*BUG(16) = BUG(16) + 1;                                    /*@Z427VLS*/ 03450000
         LA    @06,1                                               1150 03451000
         AL    @06,BUG+60                                          1150 03452000
         ST    @06,BUG+60                                          1150 03453000
*IF PMCH = OFF THEN                                                1151 03454000
         TM    PMCH(R2),B'10000000'                                1151 03455000
         BNZ   @RF01151                                            1151 03456000
*  PASSFLAG = OFF;                                         /*@Z427VLS*/ 03457000
         NI    PASSFLAG(R2),B'11111110'                            1152 03458000
*ELSE                                                              1153 03459000
*  DO;                                                     /*@Z427VLS*/ 03460000
         B     @RC01151                                            1153 03461000
@RF01151 DS    0H                                                  1154 03462000
*   CALL TREADR;  /*ADDRESS MCH ENT RELATING TO REC CPU SER @ZA27824 */ 03463000
         BAL   @14,TREADR                                          1154 03464000
*   IF CPU0FLG = OFF THEN                                          1155 03465000
         TM    CPU0FLG,B'00001000'                                 1155 03466000
         BNZ   @RF01155                                            1155 03467000
*    DO;                                                   /*@Z427VLS*/ 03468000
*    TREMCH(TREIDX) = TREMCH(TREIDX) + ONE; /*ADD 1 TO MCH REC. CNT*/   03469000
         SLR   @06,@06                                             1157 03470000
         IC    @06,TREIDX                                          1157 03471000
         MH    @06,@CH01385                                        1157 03472000
         L     @03,TRENPTR(,R2)                                    1157 03473000
         LA    @15,1                                               1157 03474000
         LA    @01,0(@06,@03)                                      1157 03475000
         AL    @01,@CF01632                                        1157 03476000
         L     @14,TREMCH-12(,@01)                                 1157 03477000
         ALR   @14,@15                                             1157 03478000
         AL    @03,@CF01632                                        1157 03479000
         ST    @14,TREMCH-12(@06,@03)                              1157 03480000
*    BUG(17) = BUG(17) + 1;                                /*@Z427VLS*/ 03481000
         L     @06,BUG+64                                          1158 03482000
         ALR   @06,@15                                             1158 03483000
         ST    @06,BUG+64                                          1158 03484000
*IF FRAMEPTR ^= ZERO THEN /*IF FRAMETAB IS ALLOCATED         @G51DGBB*/ 03485000
         L     @06,FRAMEPTR(,R2)                                   1159 03486000
         LTR   @06,@06                                             1159 03487000
         BZ    @RF01159                                            1159 03488000
*DO;                                                       /*@G51DGBB*/ 03489000
*    GETOUT = NO;                                          /*@G51DGBB*/ 03490000
         NI    GETOUT,B'10111111'                                  1161 03491000
*DO A = 1 BY 1 TO MRDNUMBR WHILE GETOUT = NO; /*LOOP THROUGH LIST OF */ 03492000
         ST    @15,A                                               1162 03493000
         B     @DE01162                                            1162 03494000
@DL01162 TM    GETOUT,B'01000000'                                  1162 03495000
         BNZ   @DC01162                                            1162 03496000
*                                           /*MERIDIAN-LIKE CPUS   */   03497000
*  IF MODEL(A) = LRTMODEL THEN             /*IF MERIDIAN-LIKE CPU */    03498000
         ALR   @15,@15                                             1163 03499000
         L     @06,MERDCPTR(,R2)                                   1163 03500000
         ALR   @06,@15                                             1163 03501000
         CLC   MODEL-2(2,@06),LRTMODEL(R7)                         1163 03502000
         BNE   @RF01163                                            1163 03503000
*    DO;                                                   /*@G51DGBB*/ 03504000
*      CALL BUILDFTB; /*SEE IF UNIQUE, BUILD FRAMTAB ENTRY IF IT IS */  03505000
         BAL   @14,BUILDFTB                                        1165 03506000
*      GETOUT = YES;  /*EXIT LOOP                            @G51DGBB*/ 03507000
         OI    GETOUT,B'01000000'                                  1166 03508000
*    END;                                                  /*@G51DGBB*/ 03509000
*END;                                                      /*@G51DGBB*/ 03510000
@RF01163 LA    @15,1                                               1168 03511000
         AL    @15,A                                               1168 03512000
         ST    @15,A                                               1168 03513000
@DE01162 L     @06,MERDCPTR(,R2)                                   1168 03514000
         CH    @15,MRDNUMBR(,@06)                                  1168 03515000
         BNH   @DL01162                                            1168 03516000
@DC01162 DS    0H                                                  1169 03517000
*END;                                                      /*@G51DGBB*/ 03518000
*    END;                                                  /*@Z427VLS*/ 03519000
*  END;                                                    /*@Z427VLS*/ 03520000
*END;                                                      /*@Z427VLS*/ 03521000
@EL00026 DS    0H                                                  1172 03522000
@EF00026 DS    0H                                                  1172 03523000
@ER00026 LM    @14,@12,@SA00026                                    1172 03524000
         BR    @14                                                 1172 03525000
*SOFTFILT: PROC;                                           /*@Z427VLS*/ 03526000
SOFTFILT STM   @14,@12,@SA00027                                    1173 03527000
*BUG(20) = BUG(20) + 1;                                    /*@Z427VLS*/ 03528000
         LA    @06,1                                               1174 03529000
         AL    @06,BUG+76                                          1174 03530000
         ST    @06,BUG+76                                          1174 03531000
*IF PSOFT = OFF THEN                                               1175 03532000
         TM    PSOFT(R2),B'00010000'                               1175 03533000
         BNZ   @RF01175                                            1175 03534000
*  PASSFLAG = OFF;                                         /*@Z427VLS*/ 03535000
         NI    PASSFLAG(R2),B'11111110'                            1176 03536000
*ELSE                                                              1177 03537000
*  DO;                                                     /*@Z427VLS*/ 03538000
         B     @RC01175                                            1177 03539000
@RF01175 DS    0H                                                  1178 03540000
*   CALL TREADR;  /*ADDRESS SOFT ENT RELATING TO REC CPU SER @ZA27824*/ 03541000
         BAL   @14,TREADR                                          1178 03542000
*   IF CPU0FLG = OFF THEN                                          1179 03543000
         TM    CPU0FLG,B'00001000'                                 1179 03544000
         BNZ   @RF01179                                            1179 03545000
*    DO;                                                   /*@Z427VLS*/ 03546000
*    TREPRE(TREIDX) = TREPRE(TREIDX) + ONE; /*ADD 1 TO SOFT REC. CT */  03547000
         SLR   @06,@06                                             1181 03548000
         IC    @06,TREIDX                                          1181 03549000
         MH    @06,@CH01385                                        1181 03550000
         L     @03,TRENPTR(,R2)                                    1181 03551000
         LA    @15,1                                               1181 03552000
         L     @14,TREPRE-76(@06,@03)                              1181 03553000
         ALR   @14,@15                                             1181 03554000
         ST    @14,TREPRE-76(@06,@03)                              1181 03555000
*    BUG(21) = BUG(21) + 1;                                /*@Z427VLS*/ 03556000
         AL    @15,BUG+80                                          1182 03557000
         ST    @15,BUG+80                                          1182 03558000
*    END;                                                  /*@Z427VLS*/ 03559000
*  END;                                                    /*@Z427VLS*/ 03560000
*END;                                                      /*@Z427VLS*/ 03561000
@EL00027 DS    0H                                                  1185 03562000
@EF00027 DS    0H                                                  1185 03563000
@ER00027 LM    @14,@12,@SA00027                                    1185 03564000
         BR    @14                                                 1185 03565000
*DEVSEL: PROC;                                             /*@Z427VLS*/ 03566000
DEVSEL   STM   @14,@12,12(@13)                                     1186 03567000
*IF WORKTYPE = HEX90 THEN                                          1187 03568000
         CLI   WORKTYPE,X'90'                                      1187 03569000
         BNE   @RF01187                                            1187 03570000
*  DO;                                                     /*@Z427VLS*/ 03571000
*    IF DEVEXCL = ON THEN                                          1189 03572000
         TM    DEVEXCL(R2),B'00100000'                             1189 03573000
         BNO   @RF01189                                            1189 03574000
*      DO;                                                 /*@Z427VLS*/ 03575000
*        DEVOK = YES;                                      /*@Z427VLS*/ 03576000
         OI    DEVOK,B'00100000'                                   1191 03577000
*        DO J = 1 BY 1 TO MDRNUM WHILE DEVOK = YES;        /*@Z427VLS*/ 03578000
         LA    @06,1                                               1192 03579000
         ST    @06,J                                               1192 03580000
         B     @DE01192                                            1192 03581000
@DL01192 TM    DEVOK,B'00100000'                                   1192 03582000
         BNO   @DC01192                                            1192 03583000
*        IF TPRDEV = MDRVAL(J) THEN                                1193 03584000
         L     @03,DEVPTR(,R2)                                     1193 03585000
         ALR   @03,@06                                             1193 03586000
         CLC   TPRDEV(1,R7),MDRVAL-1(@03)                          1193 03587000
         BNE   @RF01193                                            1193 03588000
*          DO;                                             /*@Z427VLS*/ 03589000
*            DEVOK = NO;                                   /*@Z427VLS*/ 03590000
         NI    DEVOK,B'11011111'                                   1195 03591000
*            PASSFLAG = NO;                                /*@Z427VLS*/ 03592000
         NI    PASSFLAG(R2),B'11111110'                            1196 03593000
*            BUG(32) = BUG(32) + 1;                        /*@Z427VLS*/ 03594000
         LA    @06,1                                               1197 03595000
         AL    @06,BUG+124                                         1197 03596000
         ST    @06,BUG+124                                         1197 03597000
*          END;                                            /*@Z427VLS*/ 03598000
*        END;                                              /*@Z427VLS*/ 03599000
@RF01193 LA    @06,1                                               1199 03600000
         AL    @06,J                                               1199 03601000
         ST    @06,J                                               1199 03602000
@DE01192 L     @03,DEVPTR(,R2)                                     1199 03603000
         CH    @06,MDRNUM(,@03)                                    1199 03604000
         BNH   @DL01192                                            1199 03605000
@DC01192 DS    0H                                                  1200 03606000
*      END;                                                /*@Z427VLS*/ 03607000
*    ELSE                                                          1201 03608000
*      DO;                                                 /*@Z427VLS*/ 03609000
         B     @RC01189                                            1201 03610000
@RF01189 DS    0H                                                  1202 03611000
*        DEVOK = NO;                                       /*@Z427VLS*/ 03612000
         NI    DEVOK,B'11011111'                                   1202 03613000
*        DO J = 1 BY 1 TO MDRNUM WHILE DEVOK = NO;         /*@Z427VLS*/ 03614000
         LA    @06,1                                               1203 03615000
         ST    @06,J                                               1203 03616000
         B     @DE01203                                            1203 03617000
@DL01203 TM    DEVOK,B'00100000'                                   1203 03618000
         BNZ   @DC01203                                            1203 03619000
*        IF TPRDEV = MDRVAL(J) THEN                                1204 03620000
         L     @03,DEVPTR(,R2)                                     1204 03621000
         ALR   @03,@06                                             1204 03622000
         CLC   TPRDEV(1,R7),MDRVAL-1(@03)                          1204 03623000
         BNE   @RF01204                                            1204 03624000
*          DEVOK = YES;                                    /*@Z427VLS*/ 03625000
         OI    DEVOK,B'00100000'                                   1205 03626000
*        END;                                              /*@Z427VLS*/ 03627000
@RF01204 LA    @06,1                                               1206 03628000
         AL    @06,J                                               1206 03629000
         ST    @06,J                                               1206 03630000
@DE01203 L     @03,DEVPTR(,R2)                                     1206 03631000
         CH    @06,MDRNUM(,@03)                                    1206 03632000
         BNH   @DL01203                                            1206 03633000
@DC01203 DS    0H                                                  1207 03634000
*        IF DEVOK = NO THEN                                        1207 03635000
         TM    DEVOK,B'00100000'                                   1207 03636000
         BNZ   @RF01207                                            1207 03637000
*          DO;                                             /*@Z427VLS*/ 03638000
*            PASSFLAG = NO;                                /*@Z427VLS*/ 03639000
         NI    PASSFLAG(R2),B'11111110'                            1209 03640000
*            BUG(32) = BUG(32) + 1;                        /*@Z427VLS*/ 03641000
         LA    @06,1                                               1210 03642000
         AL    @06,BUG+124                                         1210 03643000
         ST    @06,BUG+124                                         1210 03644000
*          END;                                            /*@Z427VLS*/ 03645000
*       END;                                               /*@Z427VLS*/ 03646000
*    END;                                                  /*@Z427VLS*/ 03647000
*  ELSE                                                            1214 03648000
*    IF DEVEXCL = ON THEN                                          1214 03649000
         B     @RC01187                                            1214 03650000
@RF01187 TM    DEVEXCL(R2),B'00100000'                             1214 03651000
         BNO   @RF01214                                            1214 03652000
*      DO;                                                 /*@Z427VLS*/ 03653000
*        DEVOK = YES;                                      /*@Z427VLS*/ 03654000
         OI    DEVOK,B'00100000'                                   1216 03655000
*        DO J = 1 BY 1 TO DEVNUM WHILE DEVOK = YES;        /*@Z427VLS*/ 03656000
         LA    @06,1                                               1217 03657000
         ST    @06,J                                               1217 03658000
         B     @DE01217                                            1217 03659000
@DL01217 TM    DEVOK,B'00100000'                                   1217 03660000
         BNO   @DC01217                                            1217 03661000
*          IF WORKDEV = DEVVAL(J) THEN                             1218 03662000
         ALR   @06,@06                                             1218 03663000
         L     @03,DEVPTR(,R2)                                     1218 03664000
         ALR   @03,@06                                             1218 03665000
         CLC   WORKDEV(2),DEVVAL-2(@03)                            1218 03666000
         BNE   @RF01218                                            1218 03667000
*            DO;                                           /*@Z427VLS*/ 03668000
*              DEVOK = NO;                                 /*@Z427VLS*/ 03669000
         NI    DEVOK,B'11011111'                                   1220 03670000
*              PASSFLAG = NO;                              /*@Z427VLS*/ 03671000
         NI    PASSFLAG(R2),B'11111110'                            1221 03672000
*              BUG(32) = BUG(32) + 1;                      /*@Z427VLS*/ 03673000
         LA    @06,1                                               1222 03674000
         AL    @06,BUG+124                                         1222 03675000
         ST    @06,BUG+124                                         1222 03676000
*            END;                                          /*@Z427VLS*/ 03677000
*        END;                                              /*@Z427VLS*/ 03678000
@RF01218 LA    @06,1                                               1224 03679000
         AL    @06,J                                               1224 03680000
         ST    @06,J                                               1224 03681000
@DE01217 L     @03,DEVPTR(,R2)                                     1224 03682000
         CH    @06,DEVNUM(,@03)                                    1224 03683000
         BNH   @DL01217                                            1224 03684000
@DC01217 DS    0H                                                  1225 03685000
*      END;                                                /*@Z427VLS*/ 03686000
*  ELSE                                                            1226 03687000
*   DO;                                                    /*@Z427VLS*/ 03688000
         B     @RC01214                                            1226 03689000
@RF01214 DS    0H                                                  1227 03690000
*     DEVOK = NO;                                          /*@Z427VLS*/ 03691000
         NI    DEVOK,B'11011111'                                   1227 03692000
*     DO J =  1 BY 1 TO DEVNUM WHILE DEVOK = NO;           /*@Z427VLS*/ 03693000
         LA    @06,1                                               1228 03694000
         ST    @06,J                                               1228 03695000
         B     @DE01228                                            1228 03696000
@DL01228 TM    DEVOK,B'00100000'                                   1228 03697000
         BNZ   @DC01228                                            1228 03698000
*       IF WORKDEV = DEVVAL(J) THEN                                1229 03699000
         ALR   @06,@06                                             1229 03700000
         L     @03,DEVPTR(,R2)                                     1229 03701000
         ALR   @03,@06                                             1229 03702000
         CLC   WORKDEV(2),DEVVAL-2(@03)                            1229 03703000
         BNE   @RF01229                                            1229 03704000
*         DEVOK = YES;                                     /*@Z427VLS*/ 03705000
         OI    DEVOK,B'00100000'                                   1230 03706000
*     END;                                                 /*@Z427VLS*/ 03707000
@RF01229 LA    @06,1                                               1231 03708000
         AL    @06,J                                               1231 03709000
         ST    @06,J                                               1231 03710000
@DE01228 L     @03,DEVPTR(,R2)                                     1231 03711000
         CH    @06,DEVNUM(,@03)                                    1231 03712000
         BNH   @DL01228                                            1231 03713000
@DC01228 DS    0H                                                  1232 03714000
*     IF DEVOK = NO THEN                                           1232 03715000
         TM    DEVOK,B'00100000'                                   1232 03716000
         BNZ   @RF01232                                            1232 03717000
*       DO;                                                /*@Z427VLS*/ 03718000
*         PASSFLAG = OFF;                                  /*@Z427VLS*/ 03719000
         NI    PASSFLAG(R2),B'11111110'                            1234 03720000
*         BUG(32) = BUG(32) + 1;                           /*@Z427VLS*/ 03721000
         LA    @06,1                                               1235 03722000
         AL    @06,BUG+124                                         1235 03723000
         ST    @06,BUG+124                                         1235 03724000
*       END;                                               /*@Z427VLS*/ 03725000
*    END;                                                  /*@Z427VLS*/ 03726000
*END;                                                      /*@Z427VLS*/ 03727000
@EL00028 DS    0H                                                  1238 03728000
@EF00028 DS    0H                                                  1238 03729000
@ER00028 LM    @14,@12,12(@13)                                     1238 03730000
         BR    @14                                                 1238 03731000
*CUASELCT: PROC; /*CHECK RECORD CUA AGAINST LIST OF VALID CUAS*/   1239 03732000
CUASELCT STM   @14,@12,12(@13)                                     1239 03733000
*CUAOK = NO;                                               /*@Z427VLS*/ 03734000
         NI    CUAOK,B'11101111'                                   1240 03735000
*DO M = 1 BY 1 TO CUANUM WHILE CUAOK = NO;                 /*@Z427VLS*/ 03736000
         LA    @06,1                                               1241 03737000
         ST    @06,M                                               1241 03738000
         B     @DE01241                                            1241 03739000
@DL01241 TM    CUAOK,B'00010000'                                   1241 03740000
         BNZ   @DC01241                                            1241 03741000
*  IF WWCUA2 >= CUA1(M) & WWCUA2 <= CUA2(M) THEN                   1242 03742000
         SLA   @06,2                                               1242 03743000
         L     @03,CUAPTR(,R2)                                     1242 03744000
         ST    @06,@TF00001                                        1242 03745000
         ALR   @06,@03                                             1242 03746000
         BCTR  @06,0                                               1242 03747000
         BCTR  @06,0                                               1242 03748000
         CLC   WWCUA2(2),CUA1-2(@06)                               1242 03749000
         BL    @RF01242                                            1242 03750000
         AL    @03,@TF00001                                        1242 03751000
         CLC   WWCUA2(2),CUA2-4(@03)                               1242 03752000
         BH    @RF01242                                            1242 03753000
*    CUAOK = YES;                                          /*@Z427VLS*/ 03754000
         OI    CUAOK,B'00010000'                                   1243 03755000
*END;                                                      /*@Z427VLS*/ 03756000
@RF01242 LA    @06,1                                               1244 03757000
         AL    @06,M                                               1244 03758000
         ST    @06,M                                               1244 03759000
@DE01241 L     @03,CUAPTR(,R2)                                     1244 03760000
         CH    @06,CUANUM(,@03)                                    1244 03761000
         BNH   @DL01241                                            1244 03762000
@DC01241 DS    0H                                                  1245 03763000
*IF CUAOK = NO THEN                                                1245 03764000
         TM    CUAOK,B'00010000'                                   1245 03765000
         BNZ   @RF01245                                            1245 03766000
*  DO;                                                     /*@Z427VLS*/ 03767000
*    PASSFLAG = NO;                                        /*@Z427VLS*/ 03768000
         NI    PASSFLAG(R2),B'11111110'                            1247 03769000
*    BUG(33) = BUG(33) + 1;                                /*@Z427VLS*/ 03770000
         LA    @06,1                                               1248 03771000
         AL    @06,BUG+128                                         1248 03772000
         ST    @06,BUG+128                                         1248 03773000
*  END;                                                    /*@Z427VLS*/ 03774000
*END; /*CLOSING END OF PROC CUASELCT                         @Z427VLS*/ 03775000
@EL00029 DS    0H                                                  1250 03776000
@EF00029 DS    0H                                                  1250 03777000
@ER00029 LM    @14,@12,12(@13)                                     1250 03778000
         BR    @14                                                 1250 03779000
*ERRMSG: PROC;                                             /*@Z427VLS*/ 03780000
ERRMSG   STM   @14,@12,@SA00030                                    1251 03781000
*PRINTADR = ADDR(PRINTLIN);                                /*@Z427VLS*/ 03782000
         LA    @06,PRINTLIN                                        1252 03783000
         ST    @06,PRINTADR(,R2)                                   1252 03784000
*IF MSGNO=1  |                                           /* @XA19728 */ 03785000
*   MSGNO=2  THEN                                        /* @XA19728 */ 03786000
         CLI   MSGNO,1                                             1253 03787000
         BE    @RT01253                                            1253 03788000
         CLI   MSGNO,2                                             1253 03789000
         BNE   @RF01253                                            1253 03790000
@RT01253 DS    0H                                                  1254 03791000
*  DO;                                                     /*@GZZDGVS*/ 03792000
*    ZEROALL=NO;         /* DONT RESET LOGREC HEADER OF ALL  @GZZDGVS*/ 03793000
         NI    ZEROALL(R2),B'10111111'                             1255 03794000
*                        /* RECORDS NOT PROCESSED           @XA19728 */ 03795000
*    CALL IFCMSG(55,ADDR(PRINTBDY));  /*GET FAILED SORT TBL @Z427VLS */ 03796000
         LA    @06,PRINTBDY                                        1256 03797000
         ST    @06,@AFTEMPS+4                                      1256 03798000
         L     @15,ADIFCMSG(,R2)                                   1256 03799000
         LA    @01,@AL01256                                        1256 03800000
         BALR  @14,@15                                             1256 03801000
*  END;                                                    /*@GZZDGVS*/ 03802000
*IF MSGNO = 3 THEN                                                 1258 03803000
@RF01253 CLI   MSGNO,3                                             1258 03804000
         BNE   @RF01258                                            1258 03805000
*   CALL IFCMSG(53,ADDR(PRINTBDY));                        /*@Z427VLS*/ 03806000
         LA    @06,PRINTBDY                                        1259 03807000
         ST    @06,@AFTEMPS+4                                      1259 03808000
         L     @15,ADIFCMSG(,R2)                                   1259 03809000
         LA    @01,@AL01259                                        1259 03810000
         BALR  @14,@15                                             1259 03811000
*IF MSGNO = 6 THEN                                                 1260 03812000
@RF01258 CLI   MSGNO,6                                             1260 03813000
         BNE   @RF01260                                            1260 03814000
*  DO;                                                     /*@Z427VLS*/ 03815000
*    CALL IFCMSG(73,ADDR(PRINTBDY));                       /*@Z427VLS*/ 03816000
         LA    @06,PRINTBDY                                        1262 03817000
         ST    @06,@AFTEMPS+4                                      1262 03818000
         L     @15,ADIFCMSG(,R2)                                   1262 03819000
         LA    @01,@AL01262                                        1262 03820000
         BALR  @14,@15                                             1262 03821000
*    ER3 = EVSERIAL(K);                                    /*@Z427VLS*/ 03822000
         L     @06,K                                               1263 03823000
         MH    @06,@CH00081                                        1263 03824000
         L     @03,EVPTR(,R2)                                      1263 03825000
         ALR   @03,@06                                             1263 03826000
         MVC   ER3(3),EVSERIAL-6(@03)                              1263 03827000
*    SLL(ERSER,4); /*SHIFT SERIAL IN ORDER TO ADD PACKED SIGN*/    1264 03828000
         L     @06,ERSER                                           1264 03829000
         SLL   @06,4                                               1264 03830000
         ST    @06,ERSER                                           1264 03831000
*    ER3 = (ER3 | '00000F'X);   /*ADD SIGN FOR PROPER UNPACKING*/  1265 03832000
         OC    ER3(3),@CB00228                                     1265 03833000
*    UNPK(PRNTSER,ERSER);                                  /*@Z427VLS*/ 03834000
         UNPK  PRNTSER(7),ERSER(4)                                 1266 03835000
*  END;                                                    /*@Z427VLS*/ 03836000
*IF MSGNO = FIVE THEN                                              1268 03837000
@RF01260 CLI   MSGNO,5                                             1268 03838000
         BNE   @RF01268                                            1268 03839000
*  CALL IFCMSG(72,ADDR(PRINTBDY));                         /*@Z427VLS*/ 03840000
         LA    @06,PRINTBDY                                        1269 03841000
         ST    @06,@AFTEMPS+4                                      1269 03842000
         L     @15,ADIFCMSG(,R2)                                   1269 03843000
         LA    @01,@AL01269                                        1269 03844000
         BALR  @14,@15                                             1269 03845000
*IF MSGNO = 78 THEN                                                1270 03846000
@RF01268 CLI   MSGNO,78                                            1270 03847000
         BNE   @RF01270                                            1270 03848000
* DO;                                                      /*@G51DGBB*/ 03849000
*   CALL IFCMSG(78,ADDR(PRINTBDY));                        /*@G51DGBB*/ 03850000
         LA    @06,PRINTBDY                                        1272 03851000
         ST    @06,@AFTEMPS+4                                      1272 03852000
         L     @15,ADIFCMSG(,R2)                                   1272 03853000
         LA    @01,@AL01272                                        1272 03854000
         BALR  @14,@15                                             1272 03855000
*   NUMBER = 3;                                            /*@G51DGBB*/ 03856000
         MVC   NUMBER(4),@CF00076                                  1273 03857000
*   ADDNXT = ADDR(PFRAMSER);                               /*@G51DGBB*/ 03858000
         LA    @06,PFRAMSER                                        1274 03859000
         ST    @06,ADDNXT                                          1274 03860000
*   NEXTBY = ADDR(FRAMESER(CCHINDX));                      /*@G51DGBB*/ 03861000
         L     @06,CCHINDX                                         1275 03862000
         MH    @06,@CH00227                                        1275 03863000
         L     @03,FRAMEPTR(,R2)                                   1275 03864000
         AL    @03,@CF01602                                        1275 03865000
         LA    @06,FRAMESER-4(@06,@03)                             1275 03866000
         ST    @06,NEXTBY                                          1275 03867000
*   CALL CONVERT;                                          /*@G51DGBB*/ 03868000
         BAL   @14,CONVERT                                         1276 03869000
*   NUMBER = 2;                                            /*@G51DGBB*/ 03870000
         MVC   NUMBER(4),@CF00074                                  1277 03871000
*   ADDNXT = ADDR(PFRAMMOD);                               /*@G51DGBB*/ 03872000
         LA    @06,PFRAMMOD                                        1278 03873000
         ST    @06,ADDNXT                                          1278 03874000
*   NEXTBY = ADDR(FRAMEMOD(CCHINDX));                      /*@G51DGBB*/ 03875000
         L     @06,CCHINDX                                         1279 03876000
         MH    @06,@CH00227                                        1279 03877000
         L     @03,FRAMEPTR(,R2)                                   1279 03878000
         AL    @03,@CF01635                                        1279 03879000
         LA    @06,FRAMEMOD-7(@06,@03)                             1279 03880000
         ST    @06,NEXTBY                                          1279 03881000
*   CALL CONVERT;                                          /*@G51DGBB*/ 03882000
         BAL   @14,CONVERT                                         1280 03883000
* END;                                                     /*@G51DGBB*/ 03884000
*IF MSGNO = 79  &   /*IF MISSING FRAME SET MESSAGE           @G51DGBB*/ 03885000
*   DEBUG16 = ON THEN  /*IF DEBUG16 ERROR MESSAGES TO BE PRINTED*/ 1282 03886000
@RF01270 CLI   MSGNO,79                                            1282 03887000
         BNE   @RF01282                                            1282 03888000
         TM    DEBUG16(R2),B'10000000'                             1282 03889000
         BNO   @RF01282                                            1282 03890000
*  DO;                                                     /*@G51DGBB*/ 03891000
*    NUMBER = 3;                                           /*@G51DGBB*/ 03892000
         MVC   NUMBER(4),@CF00076                                  1284 03893000
*    ADDNXT = ADDR(PARSER);                                /*@G51DGBB*/ 03894000
         LA    @06,PARSER                                          1285 03895000
         ST    @06,ADDNXT                                          1285 03896000
*    NEXTBY = ADDR(FRAMESER(CCHINDX));                     /*@G51DGBB*/ 03897000
         L     @06,CCHINDX                                         1286 03898000
         MH    @06,@CH00227                                        1286 03899000
         L     @03,FRAMEPTR(,R2)                                   1286 03900000
         AL    @03,@CF01602                                        1286 03901000
         LA    @06,FRAMESER-4(@06,@03)                             1286 03902000
         ST    @06,NEXTBY                                          1286 03903000
*    CALL CONVERT;                                         /*@G51DGBB*/ 03904000
         BAL   @14,CONVERT                                         1287 03905000
*    NUMBER = 2;                                           /*@G51DGBB*/ 03906000
         MVC   NUMBER(4),@CF00074                                  1288 03907000
*    ADDNXT = ADDR(PARMOD);                                /*@G51DGBB*/ 03908000
         LA    @06,PARMOD                                          1289 03909000
         ST    @06,ADDNXT                                          1289 03910000
*    NEXTBY = ADDR(FRAMEMOD(CCHINDX));                     /*@G51DGBB*/ 03911000
         L     @06,CCHINDX                                         1290 03912000
         MH    @06,@CH00227                                        1290 03913000
         L     @03,FRAMEPTR(,R2)                                   1290 03914000
         AL    @03,@CF01635                                        1290 03915000
         LA    @06,FRAMEMOD-7(@06,@03)                             1290 03916000
         ST    @06,NEXTBY                                          1290 03917000
*    CALL CONVERT;                                         /*@G51DGBB*/ 03918000
         BAL   @14,CONVERT                                         1291 03919000
*    NUMBER = 1;                                           /*@G51DGBB*/ 03920000
         MVC   NUMBER(4),@CF00056                                  1292 03921000
*    ADDNXT = ADDR(PARREP);                                /*@G51DGBB*/ 03922000
         LA    @06,PARREP                                          1293 03923000
         ST    @06,ADDNXT                                          1293 03924000
*    NEXTBY = ADDR(FRAMETYP(CCHINDX));                     /*@G51DGBB*/ 03925000
         L     @06,CCHINDX                                         1294 03926000
         MH    @06,@CH00227                                        1294 03927000
         L     @03,FRAMEPTR(,R2)                                   1294 03928000
         AL    @03,@CF01614                                        1294 03929000
         LA    @06,FRAMETYP-17(@06,@03)                            1294 03930000
         ST    @06,NEXTBY                                          1294 03931000
*    CALL CONVERT;                                         /*@G51DGBB*/ 03932000
         BAL   @14,CONVERT                                         1295 03933000
*    PRINTBDY(1:58) = PARTIAL;                             /*@G51DGBB*/ 03934000
         MVC   PRINTBDY(58),PARTIAL                                1296 03935000
*  END;                                                    /*@G51DGBB*/ 03936000
*IF MSGNO = 40 THEN                                                1298 03937000
@RF01282 CLI   MSGNO,40                                            1298 03938000
         BNE   @RF01298                                            1298 03939000
* CALL IFCMSG(40,ADDR(PRINTBDY));                          /*@G51DGBB*/ 03940000
         LA    @06,PRINTBDY                                        1299 03941000
         ST    @06,@AFTEMPS+4                                      1299 03942000
         L     @15,ADIFCMSG(,R2)                                   1299 03943000
         LA    @01,@AL01299                                        1299 03944000
         BALR  @14,@15                                             1299 03945000
*IF MSGNO = 24 THEN                                                1300 03946000
@RF01298 CLI   MSGNO,24                                            1300 03947000
         BNE   @RF01300                                            1300 03948000
* CALL IFCMSG(24,ADDR(PRINTBDY));                          /*@G51DGBB*/ 03949000
         LA    @06,PRINTBDY                                        1301 03950000
         ST    @06,@AFTEMPS+4                                      1301 03951000
         L     @15,ADIFCMSG(,R2)                                   1301 03952000
         LA    @01,@AL01301                                        1301 03953000
         BALR  @14,@15                                             1301 03954000
*CALL IOHND(RITEPRTR); /*CALL IFCIOHND TO WRITE TO TOURIST D.S.*/  1302 03955000
@RF01300 L     @15,ADIOHND(,R2)                                    1302 03956000
         LA    @01,@AL01302                                        1302 03957000
         BALR  @14,@15                                             1302 03958000
*END;  /*CLOSING END FOR PROC ERRMSG                         @Z427VLS*/ 03959000
@EL00030 DS    0H                                                  1303 03960000
@EF00030 DS    0H                                                  1303 03961000
@ER00030 LM    @14,@12,@SA00030                                    1303 03962000
         BR    @14                                                 1303 03963000
*SORTSHAR: PROC;        /* SORT SHARE TABLE CPU BY LETTER  @ZA17692 */  03964000
SORTSHAR STM   @14,@12,12(@13)                                     1304 03965000
*  DO J=1 BY 1 TO SHARENUM-1;                           /* @ZA17692 */  03966000
         LA    @06,1                                               1305 03967000
         ST    @06,J                                               1305 03968000
         B     @DE01305                                            1305 03969000
@DL01305 DS    0H                                                  1306 03970000
*    DO K= J+1 BY 1 TO SHARENUM;                        /* @ZA17692 */  03971000
         AL    @06,@CF00056                                        1306 03972000
         ST    @06,K                                               1306 03973000
         B     @DE01306                                            1306 03974000
@DL01306 DS    0H                                                  1307 03975000
*      IF SHARLET(J) > SHARLET(K)  THEN                 /* @ZA17692 */  03976000
         L     @03,J                                               1307 03977000
         SLA   @03,4                                               1307 03978000
         L     @15,SHAREPTR(,R2)                                   1307 03979000
         SLA   @06,4                                               1307 03980000
         ST    @03,@TF00001                                        1307 03981000
         ALR   @03,@15                                             1307 03982000
         ST    @06,@TF00002                                        1307 03983000
         ALR   @06,@15                                             1307 03984000
         CLC   SHARLET-16(1,@03),SHARLET-16(@06)                   1307 03985000
         BNH   @RF01307                                            1307 03986000
*        DO;                                            /* @ZA17692 */  03987000
*          SHAREIO(J)=(SHAREIO(J)&&SHAREIO(K));         /* @ZA17692 */  03988000
         LR    @06,@15                                             1309 03989000
         AL    @06,@TF00001                                        1309 03990000
         AL    @06,@CF01375                                        1309 03991000
         LR    @03,@15                                             1309 03992000
         AL    @03,@TF00001                                        1309 03993000
         AL    @03,@CF01375                                        1309 03994000
         MVC   @TS00001(16),SHAREIO-2(@03)                         1309 03995000
         LR    @03,@15                                             1309 03996000
         AL    @03,@TF00002                                        1309 03997000
         AL    @03,@CF01375                                        1309 03998000
         XC    @TS00001(16),SHAREIO-2(@03)                         1309 03999000
         MVC   SHAREIO-2(16,@06),@TS00001                          1309 04000000
*          SHAREIO(K)=(SHAREIO(K)&&SHAREIO(J));         /* @ZA17692 */  04001000
         LR    @06,@15                                             1310 04002000
         AL    @06,@TF00002                                        1310 04003000
         AL    @06,@CF01375                                        1310 04004000
         LR    @03,@15                                             1310 04005000
         AL    @03,@TF00002                                        1310 04006000
         AL    @03,@CF01375                                        1310 04007000
         MVC   @TS00001(16),SHAREIO-2(@03)                         1310 04008000
         LR    @03,@15                                             1310 04009000
         AL    @03,@TF00001                                        1310 04010000
         AL    @03,@CF01375                                        1310 04011000
         XC    @TS00001(16),SHAREIO-2(@03)                         1310 04012000
         MVC   SHAREIO-2(16,@06),@TS00001                          1310 04013000
*          SHAREIO(J)=(SHAREIO(J)&&SHAREIO(K));         /* @ZA17692 */  04014000
         LR    @06,@15                                             1311 04015000
         AL    @06,@TF00001                                        1311 04016000
         AL    @06,@CF01375                                        1311 04017000
         LR    @03,@15                                             1311 04018000
         AL    @03,@TF00001                                        1311 04019000
         AL    @03,@CF01375                                        1311 04020000
         MVC   @TS00001(16),SHAREIO-2(@03)                         1311 04021000
         AL    @15,@TF00002                                        1311 04022000
         AL    @15,@CF01375                                        1311 04023000
         XC    @TS00001(16),SHAREIO-2(@15)                         1311 04024000
         MVC   SHAREIO-2(16,@06),@TS00001                          1311 04025000
*        END;                                           /* @ZA17692 */  04026000
*     END;                                              /* @ZA17692 */  04027000
@RF01307 LA    @06,1                                               1313 04028000
         AL    @06,K                                               1313 04029000
         ST    @06,K                                               1313 04030000
@DE01306 L     @03,SHAREPTR(,R2)                                   1313 04031000
         CH    @06,SHARENUM(,@03)                                  1313 04032000
         BNH   @DL01306                                            1313 04033000
*  END;                                                 /* @ZA17692 */  04034000
         LA    @06,1                                               1314 04035000
         AL    @06,J                                               1314 04036000
         ST    @06,J                                               1314 04037000
@DE01305 L     @03,SHAREPTR(,R2)                                   1314 04038000
         LH    @03,SHARENUM(,@03)                                  1314 04039000
         BCTR  @03,0                                               1314 04040000
         CR    @06,@03                                             1314 04041000
         BNH   @DL01305                                            1314 04042000
*END;                       /*  CLOSING END FOR SORTSHAR   @ZA17692 */  04043000
@EL00031 DS    0H                                                  1315 04044000
@EF00031 DS    0H                                                  1315 04045000
@ER00031 LM    @14,@12,12(@13)                                     1315 04046000
         BR    @14                                                 1315 04047000
*BUGCNTS: PROC;                                            /*@Z427VLS*/ 04048000
BUGCNTS  STM   @14,@12,@SA00032                                    1316 04049000
*/*PRINT COUNTS OF RECORDS PROCESSED IF DEBUG16 IS ON        @Z427VLS*/ 04050000
*PRINTADR = ADDR(PRINTLIN);                                /*@Z427VLS*/ 04051000
         LA    @06,PRINTLIN                                        1317 04052000
         ST    @06,PRINTADR(,R2)                                   1317 04053000
*M = 46; /*DONT SET ERRLINE EXPLICITLY OR COMPILER WILL CHOKE*/    1318 04054000
         LA    @06,46                                              1318 04055000
         ST    @06,M                                               1318 04056000
*BUG(43) = SORTNUM;                                        /*@D3506GB*/ 04057000
         L     @03,SORTNUM(,R2)                                    1319 04058000
         ST    @03,BUG+168                                         1319 04059000
*PRINTLIN = ERRLINE(M);  /*PLACE DEBUG COUNTS HEADER MESSAGE IN PRINT*/ 04060000
         MVI   PRINTLIN+73,C' '                                    1320 04061000
         MVC   PRINTLIN+74(60),PRINTLIN+73                         1320 04062000
         MH    @06,@CH01536                                        1320 04063000
         LA    @03,ERRLINE-73(@06)                                 1320 04064000
         MVC   PRINTLIN(73),0(@03)                                 1320 04065000
*CALL IOHND(RITEPRTR);                                     /*@Z427VLS*/ 04066000
         L     @15,ADIOHND(,R2)                                    1321 04067000
         LA    @01,@AL01321                                        1321 04068000
         BALR  @14,@15                                             1321 04069000
* DO M = 1 BY 1 TO 44;   /*PRINT ALL DEBUG COUNTS            @G51DGBB*/ 04070000
         LA    @06,1                                               1322 04071000
         ST    @06,M                                               1322 04072000
@DL01322 DS    0H                                                  1323 04073000
*  NUMREC = BUG(M);                                        /*@Z427VLS*/ 04074000
         SLA   @06,2                                               1323 04075000
         L     @06,BUG-4(@06)                                      1323 04076000
         ST    @06,NUMREC                                          1323 04077000
*  CVD(NUMREC,PACKPAS);                                    /*@Z427VLS*/ 04078000
         CVD   @06,@TS00001                                        1324 04079000
         MVC   PACKPAS(4),@TS00001+4                               1324 04080000
*  PACKPAS = (PACKPAS | '0000000F'X);                      /*@Z427VLS*/ 04081000
         OC    PACKPAS(4),@CB01458                                 1325 04082000
*  UNPK(EDFLD,PACKPAS);                                    /*@Z427VLS*/ 04083000
         UNPK  EDFLD(9),PACKPAS(4)                                 1326 04084000
*  NONBLANK = OFF;                                         /*@Z427VLS*/ 04085000
         NI    NONBLANK,B'10111111'                                1327 04086000
*  DO L = 1 BY 1 TO 8 WHILE NONBLANK = OFF;                /*@Z427VLS*/ 04087000
         LA    @06,1                                               1328 04088000
         ST    @06,L                                               1328 04089000
@DL01328 TM    NONBLANK,B'01000000'                                1328 04090000
         BNZ   @DC01328                                            1328 04091000
*    IF EDIFILD(L) = CHARZERO THEN                                 1329 04092000
         LA    @03,EDIFILD-1(@06)                                  1329 04093000
         CLI   0(@03),X'F0'                                        1329 04094000
         BNE   @RF01329                                            1329 04095000
*      EDIFILD(L) = BLANK;                                 /*@Z427VLS*/ 04096000
         LA    @03,EDIFILD-1(@06)                                  1330 04097000
         MVI   0(@03),X'40'                                        1330 04098000
*    ELSE                                                          1331 04099000
*      NONBLANK = ON;                                      /*@Z427VLS*/ 04100000
         B     @RC01329                                            1331 04101000
@RF01329 OI    NONBLANK,B'01000000'                                1331 04102000
*  END;                                                    /*@Z427VLS*/ 04103000
@RC01329 LA    @06,1                                               1332 04104000
         AL    @06,L                                               1332 04105000
         ST    @06,L                                               1332 04106000
         C     @06,@CF00036                                        1332 04107000
         BNH   @DL01328                                            1332 04108000
@DC01328 DS    0H                                                  1333 04109000
*  ERXNUM(M) = EDFLD;                                      /*@Z427VLS*/ 04110000
         L     @06,M                                               1333 04111000
         MH    @06,@CH01536                                        1333 04112000
         LA    @03,ERXNUM-73(@06)                                  1333 04113000
         MVC   0(9,@03),EDFLD                                      1333 04114000
*  PRINTLIN = ERRLINE(M);                                  /*@Z427VLS*/ 04115000
         MVI   PRINTLIN+73,C' '                                    1334 04116000
         MVC   PRINTLIN+74(60),PRINTLIN+73                         1334 04117000
         LA    @03,ERRLINE-73(@06)                                 1334 04118000
         MVC   PRINTLIN(73),0(@03)                                 1334 04119000
*  PRINTADR = ADDR(PRINTLIN);                              /*@Z427VLS*/ 04120000
         LA    @06,PRINTLIN                                        1335 04121000
         ST    @06,PRINTADR(,R2)                                   1335 04122000
*  CALL IOHND(RITEPRTR);                                   /*@Z427VLS*/ 04123000
         L     @15,ADIOHND(,R2)                                    1336 04124000
         LA    @01,@AL01336                                        1336 04125000
         BALR  @14,@15                                             1336 04126000
*END; /*END OF M LOOP                                        @Z427VLS*/ 04127000
         LA    @06,1                                               1337 04128000
         AL    @06,M                                               1337 04129000
         ST    @06,M                                               1337 04130000
         C     @06,@CF01547                                        1337 04131000
         BNH   @DL01322                                            1337 04132000
*END; /*CLOSING END TO PROC BUGCNTS                          @Z427VLS*/ 04133000
@EL00032 DS    0H                                                  1338 04134000
@EF00032 DS    0H                                                  1338 04135000
@ER00032 LM    @14,@12,@SA00032                                    1338 04136000
         BR    @14                                                 1338 04137000
*/*THIS PROC WILL EXAMINE THE MERIDIAN MCH OR CCH IN ORDER TO BUILD*/   04138000
*/*FRAMTAB ENTRIES FOR UNIQUE RECORDS                        @G51DGBB*/ 04139000
*BUILDFTB: PROC; /*BUILD NEW ENTRY IF CPU IS UNIQUE          @G51DGBB*/ 04140000
BUILDFTB STM   @14,@12,@SA00033                                    1339 04141000
*LOOPOUT = NO;                                             /*@G51DGBB*/ 04142000
         NI    LOOPOUT,B'11111101'                                 1340 04143000
*DO Y = 1 BY 1 TO EVMAX WHILE LOOPOUT = NO; /*EXAMINE ALL FRAMETAB*/    04144000
         LA    @06,1                                               1341 04145000
         ST    @06,Y                                               1341 04146000
@DL01341 TM    LOOPOUT,B'00000010'                                 1341 04147000
         BNZ   @DC01341                                            1341 04148000
*  IF FRAMECPU(Y) = LRTCPMOD THEN  /*IF CPU ALREADY IN TABLE THEN*/     04149000
         MH    @06,@CH00227                                        1342 04150000
         L     @03,FRAMEPTR(,R2)                                   1342 04151000
         ALR   @03,@06                                             1342 04152000
         AL    @03,@CF01602                                        1342 04153000
         CLC   FRAMECPU-4(5,@03),LRTCPMOD(R7)                      1342 04154000
         BNE   @RF01342                                            1342 04155000
*    LOOPOUT = YES; /*EXIT LOOP                              @G51DGBB*/ 04156000
         OI    LOOPOUT,B'00000010'                                 1343 04157000
*  ELSE     /*IF ENTRY DOESNT MATCH THE FRAME                @G51DGBB*/ 04158000
*    DO;                                                   /*@G51DGBB*/ 04159000
         B     @RC01342                                            1344 04160000
@RF01342 DS    0H                                                  1345 04161000
*      IF FRAMECPU(Y) = '0000000000'X THEN /*NO MATCH, ALL SET */  1345 04162000
         L     @06,Y                                               1345 04163000
         MH    @06,@CH00227                                        1345 04164000
         L     @03,FRAMEPTR(,R2)                                   1345 04165000
         ST    @06,@TF00001                                        1345 04166000
         ALR   @06,@03                                             1345 04167000
         AL    @06,@CF01602                                        1345 04168000
         CLC   FRAMECPU-4(5,@06),@CB00290                          1345 04169000
         BNE   @RF01345                                            1345 04170000
*        DO;                              /*ENTRIES EXAMINED @G51DGBB*/ 04171000
*          FRAMECPU(Y) = LRTCPMOD;                         /*@G51DGBB*/ 04172000
         LR    @06,@03                                             1347 04173000
         AL    @06,@TF00001                                        1347 04174000
         AL    @06,@CF01602                                        1347 04175000
         MVC   FRAMECPU-4(5,@06),LRTCPMOD(R7)                      1347 04176000
*          FRAMENUM = FRAMENUM + 1; /*COUNT NUMBER OF ENTRIES BUILT*/   04177000
         LA    @06,1                                               1348 04178000
         AL    @06,FRAMENUM(,@03)                                  1348 04179000
         ST    @06,FRAMENUM(,@03)                                  1348 04180000
*          LOOPOUT = YES;                                  /*@G51DGBB*/ 04181000
         OI    LOOPOUT,B'00000010'                                 1349 04182000
*        END;                                              /*@G51DGBB*/ 04183000
*      ELSE                                                        1351 04184000
*        IF Y = EVMAX THEN /*UNIQUE ENTRY BUT NOT ROOM IN TABLE*/  1351 04185000
         B     @RC01345                                            1351 04186000
@RF01345 CLC   Y(4),@CF00088                                       1351 04187000
         BNE   @RF01351                                            1351 04188000
*          DO;                                             /*@G51DGBB*/ 04189000
*            IF ONETIME = NO THEN   /*ISSUE MESSAGE ONLY ONCE*/    1353 04190000
         TM    ONETIME,B'10000000'                                 1353 04191000
         BNZ   @RF01353                                            1353 04192000
*              DO;                                         /*@G51DGBB*/ 04193000
*                MSGNO = 24;                               /*@G51DGBB*/ 04194000
         MVI   MSGNO,X'18'                                         1355 04195000
*                CALL ERRMSG;                              /*@G51DGBB*/ 04196000
         BAL   @14,ERRMSG                                          1356 04197000
*                ONETIME = YES;                            /*@G51DGBB*/ 04198000
         OI    ONETIME,B'10000000'                                 1357 04199000
*              END;                                        /*@G51DGBB*/ 04200000
*          END;                                            /*@G51DGBB*/ 04201000
@RF01353 DS    0H                                                  1360 04202000
*   END;                                                   /*@G51DGBB*/ 04203000
@RF01351 DS    0H                                                  1360 04204000
@RC01345 DS    0H                                                  1361 04205000
*  END;                                                    /*@G51DGBB*/ 04206000
@RC01342 LA    @06,1                                               1361 04207000
         AL    @06,Y                                               1361 04208000
         ST    @06,Y                                               1361 04209000
         C     @06,@CF00088                                        1361 04210000
         BNH   @DL01341                                            1361 04211000
@DC01341 DS    0H                                                  1362 04212000
*END; /*END OF PROC BUILDFTB                                 @G51DGBB*/ 04213000
@EL00033 DS    0H                                                  1362 04214000
@EF00033 DS    0H                                                  1362 04215000
@ER00033 LM    @14,@12,@SA00033                                    1362 04216000
         BR    @14                                                 1362 04217000
*FRAMEREP: PROC; /*REPLACE FRAME IF MORE CURRENT FRAME FOUND @G51DGBB*/ 04218000
FRAMEREP STM   @14,@12,@SA00034                                    1363 04219000
*                /*COMPLETE ENTRY IF NO DATE ETC.            @G51DGBB*/ 04220000
*                /*APPEND LOCATION OF FRAME EXTERNAL LOCATION LIST*/    04221000
*GETOUT = NO;                                              /*@G51DGBB*/ 04222000
         NI    GETOUT,B'10111111'                                  1364 04223000
*DO X = 1 BY 1 TO FRAMENUM WHILE GETOUT = NO; /*LOOP THROUGH ALL SET*/  04224000
         LA    @06,1                                               1365 04225000
         ST    @06,X                                               1365 04226000
         B     @DE01365                                            1365 04227000
@DL01365 TM    GETOUT,B'01000000'                                  1365 04228000
         BNZ   @DC01365                                            1365 04229000
*                                             /*ENTRIES OF FRAMETAB */  04230000
*  IF FRAMECPU(X) = LRTCPMOD THEN             /*IF RECORD CPU MODEL */  04231000
         LR    @03,@06                                             1366 04232000
         MH    @03,@CH00227                                        1366 04233000
         L     @15,FRAMEPTR(,R2)                                   1366 04234000
         ST    @03,@TF00001                                        1366 04235000
         ALR   @03,@15                                             1366 04236000
         AL    @03,@CF01602                                        1366 04237000
         CLC   FRAMECPU-4(5,@03),LRTCPMOD(R7)                      1366 04238000
         BNE   @RF01366                                            1366 04239000
*    DO;                                      /*SERIAL MATCHES THOSE*/  04240000
*      CCHINDX = X;  /*SAVE INDEX*/           /*OF THE ENTRY @G51DGBB*/ 04241000
         ST    @06,CCHINDX                                         1368 04242000
*      IF FRAMEDT(X) < LRTDT THEN             /*IF REC DATE GREATER */  04243000
         AL    @15,@TF00001                                        1369 04244000
         AL    @15,@CF01636                                        1369 04245000
         CLC   FRAMEDT-9(8,@15),LRTDT(R7)                          1369 04246000
         BNL   @RF01369                                            1369 04247000
*        DO;                                  /*THAN ENTRY DATE     */  04248000
*              CALL FIXENTRY;               /*DELETE OLD FRAME SET*/    04249000
         BAL   @14,FIXENTRY                                        1371 04250000
*              FRAMEDT(X) = LRTDT;           /*SAVE HIGH DATE*/    1372 04251000
         L     @06,X                                               1372 04252000
         MH    @06,@CH00227                                        1372 04253000
         L     @03,FRAMEPTR(,R2)                                   1372 04254000
         ALR   @03,@06                                             1372 04255000
         AL    @03,@CF01636                                        1372 04256000
         MVC   FRAMEDT-9(8,@03),LRTDT(R7)                          1372 04257000
*              CALL BUILDTTR;                /*SAVE FRAME LOCATION*/    04258000
         BAL   @14,BUILDTTR                                        1373 04259000
*               FRAMEYES = YES;/*SAVE SUCCEEDING FRAMES OF THIS    */   04260000
         OI    FRAMEYES,B'00000001'                                1374 04261000
*                              /*LOGICAL SET                 @G51DGBB*/ 04262000
*         END;                                             /*@G51DGBB*/ 04263000
*       ELSE  /*IMPLIES DATE IS LOW OR EQUAL                 @G51DGBB*/ 04264000
*        DO;                                               /*@G51DGBB*/ 04265000
         B     @RC01369                                            1376 04266000
@RF01369 DS    0H                                                  1377 04267000
*         IF FRAMEDT(X) = LRTDT THEN /*IF TABLE DATE EQUALS RECORD DAT* 04268000
         L     @06,X                                               1377 04269000
         MH    @06,@CH00227                                        1377 04270000
         L     @03,FRAMEPTR(,R2)                                   1377 04271000
         ST    @06,@TF00001                                        1377 04272000
         ALR   @06,@03                                             1377 04273000
         AL    @06,@CF01636                                        1377 04274000
         CLC   FRAMEDT-9(8,@06),LRTDT(R7)                          1377 04275000
         BNE   @RF01377                                            1377 04276000
*           DO;                                            /*@G51DGBB*/ 04277000
*            IF FRAMETYP(X) ^= ALLALL THEN                         1379 04278000
         AL    @03,@TF00001                                        1379 04279000
         AL    @03,@CF01614                                        1379 04280000
         CLI   FRAMETYP-17(@03),X'FF'                              1379 04281000
         BE    @RF01379                                            1379 04282000
*             DO;                                          /*@G51DGBB*/ 04283000
*                      CALL FIXENTRY; /*DELETE INCOMPLETE SET       */  04284000
         BAL   @14,FIXENTRY                                        1381 04285000
*                      MSGNO = 79; /*INCOMPLETE FRAME SET MESSAGE*/     04286000
         MVI   MSGNO,X'4F'                                         1382 04287000
*                      CALL ERRMSG;                        /*@G51DGBB*/ 04288000
         BAL   @14,ERRMSG                                          1383 04289000
*                      CALL BUILDTTR; /*SAVE NEW FIRST GOOD FRAME*/     04290000
         BAL   @14,BUILDTTR                                        1384 04291000
*                      FRAMEYES = YES; /*SAVE SUCCEEDING MEMBERS */     04292000
         OI    FRAMEYES,B'00000001'                                1385 04293000
*             END;                                         /*@G51DGBB*/ 04294000
*            ELSE  /*COMPLETE SET FOR THIS DATE ALREADY EXISTS      */  04295000
*               DO; /*FRAMETYP IS EQUAL TO ALLALL            @G51DGBB*/ 04296000
         B     @RC01379                                            1387 04297000
@RF01379 DS    0H                                                  1388 04298000
*                   FRAMEYES = NO;/*DELETE SUCCEEDING FRAMES OF SET */  04299000
         NI    FRAMEYES,B'11111110'                                1388 04300000
*                   BUG(41) = BUG(41) + 1; /*COUNT FRAME AS NOT USED*/  04301000
         LA    @06,1                                               1389 04302000
         AL    @06,BUG+160                                         1389 04303000
         ST    @06,BUG+160                                         1389 04304000
*               END;                                       /*@G51DGBB*/ 04305000
*        END; /*END OF CODE IF DATE IN RECORD EQUALS DATE IN TABLE*/    04306000
*       ELSE /*DATE IN TABLE GREATER THAN FRAME RECORD DATE  @G51DGBB*/ 04307000
*        BUG(41) = BUG(41)  + 1;                           /*@G51DGBB*/ 04308000
         B     @RC01377                                            1392 04309000
@RF01377 LA    @06,1                                               1392 04310000
         AL    @06,BUG+160                                         1392 04311000
         ST    @06,BUG+160                                         1392 04312000
*    END; /*END OF CODE IF DATE IN RECORD IS LOW OR EQUAL    @G51DGBB*/ 04313000
@RC01377 DS    0H                                                  1394 04314000
*  GETOUT = YES; /*GET OUT OF LOOP AFTER CPU MATCH           @G51DGBB*/ 04315000
@RC01369 OI    GETOUT,B'01000000'                                  1394 04316000
* END; /*END OF CODE FOR A RECORD TO ENTRY CPU MATCH         @G51DGBB*/ 04317000
*END; /*END OF FRAMETAB LOOP                                 @G51DGBB*/ 04318000
@RF01366 LA    @06,1                                               1396 04319000
         AL    @06,X                                               1396 04320000
         ST    @06,X                                               1396 04321000
@DE01365 L     @03,FRAMEPTR(,R2)                                   1396 04322000
         C     @06,FRAMENUM(,@03)                                  1396 04323000
         BNH   @DL01365                                            1396 04324000
@DC01365 DS    0H                                                  1397 04325000
*IF GETOUT = NO THEN /*MERIDIAN FRAME BUT NO ROOM IN TABLE   @G51DGBB*/ 04326000
         TM    GETOUT,B'01000000'                                  1397 04327000
         BNZ   @RF01397                                            1397 04328000
*  BUG(41) = BUG(41) + 1;                                  /*@G51DGBB*/ 04329000
         LA    @06,1                                               1398 04330000
         AL    @06,BUG+160                                         1398 04331000
         ST    @06,BUG+160                                         1398 04332000
*END; /*END OF PROC FRAMEREP                                 @G51DGBB*/ 04333000
@EL00034 DS    0H                                                  1399 04334000
@EF00034 DS    0H                                                  1399 04335000
@ER00034 LM    @14,@12,@SA00034                                    1399 04336000
         BR    @14                                                 1399 04337000
*BUILDTTR: PROC; /*SAVE LOCATION OF A FRAME IN LISTLOC       @G51DGBB*/ 04338000
BUILDTTR STM   @14,@12,@SA00035                                    1400 04339000
*RESPECIFY (R0,R1,R4,R15) RESTRICTED;                      /*@G51DGBB*/ 04340000
*IF (LRTKEY1 & GENREC) = HEXA0 THEN /* IF MCH FRAME          @G51DGBB*/ 04341000
         MVC   @TS00001(1),LRTKEY1(R7)                             1402 04342000
         NI    @TS00001,X'F0'                                      1402 04343000
         CLI   @TS00001,X'A0'                                      1402 04344000
         BNE   @RF01402                                            1402 04345000
*  DO;                                                     /*@G51DGBB*/ 04346000
*    IF FRAMLOCM(CCHINDX) = ZERO THEN /*IF LISTLOC CORE FOR A CPU*/     04347000
         L     @14,CCHINDX                                         1404 04348000
         MH    @14,@CH00227                                        1404 04349000
         L     @06,FRAMEPTR(,R2)                                   1404 04350000
         AL    @06,@CF01615                                        1404 04351000
         L     @14,FRAMLOCM-20(@14,@06)                            1404 04352000
         LTR   @14,@14                                             1404 04353000
         BNZ   @RF01404                                            1404 04354000
*      DO;                            /*IS UNALLOCATED       @G51DGBB*/ 04355000
*        R0 = LISTBENT * LISTMAX * 2; /*ALLOCATE CORE FOR BOTH CCH*/    04356000
         LA    R0,500                                              1406 04357000
*        R0 = R0 + 12;                /*AND MCH FRAME LOCATIONS   */    04358000
         AL    R0,@CF00032                                         1407 04359000
*        GEN(GETMAIN EC,LV=(R0),A=LINKITM,SP=21);          /*@G51DGBB*/ 04360000
         GETMAIN EC,LV=(R0),A=LINKITM,SP=21                             04361000
*        IF R15 = SUCCESS THEN                                     1409 04362000
         LTR   R15,R15                                             1409 04363000
         BNZ   @RF01409                                            1409 04364000
*          DO;                                             /*@G51DGBB*/ 04365000
*            R1 = LINKITM;  /*GRAB GOTTEN CORE ADDRESS FROM GETMAIN*/   04366000
         L     R1,LINKITM                                          1411 04367000
*            FRAMLOCM(CCHINDX) = R1;  /*SET POINTERS TO LISTLOC   */    04368000
         L     @14,CCHINDX                                         1412 04369000
         MH    @14,@CH00227                                        1412 04370000
         L     @06,FRAMEPTR(,R2)                                   1412 04371000
         AL    @06,@CF01615                                        1412 04372000
         ST    R1,FRAMLOCM-20(@14,@06)                             1412 04373000
*            R1 = R1+LISTBENT *       /*TABLES FOR BOTH CCL AND MCH*/   04374000
*                LISTMAX+4;           /*FRAMES               @G51DGBB*/ 04375000
         AL    R1,@CF01591                                         1413 04376000
*            R0 = ZERO;          /*ENSURE THAT TABLE ON WORD BOUNDARY*/ 04377000
         SLR   R0,R0                                               1414 04378000
*            R4 = 4;             /*DIVIDE BY NUMBER OF BYTES IN WORD*/  04379000
         LA    R4,4                                                1415 04380000
*            GEN(DR R0,R4);                                /*@G51DGBB*/ 04381000
         DR R0,R4                                                       04382000
*            IF R0 > ZERO THEN /*REMAINDER MEANS NOT INTEGRAL NUMBER*/  04383000
         LTR   R0,R0                                               1417 04384000
         BNP   @RF01417                                            1417 04385000
*                              /*NUMBER OF DOUBLEWORDS.      @G51DGBB*/ 04386000
*              R1 = R1 + 1; /*ADD ONE EXTRA FULL WORD        @G51DGBB*/ 04387000
         AL    R1,@CF00056                                         1418 04388000
*            R1 = R1 * FOUR; /*RESET ONE TO NUMBER OF BYTES  @G51DGBB*/ 04389000
@RF01417 SLL   R1,2                                                1419 04390000
*            FRAMLOCC(CCHINDX) = R1; /*SET POINTER TO CCH CCHHR TABLE*/ 04391000
         L     @14,CCHINDX                                         1420 04392000
         MH    @14,@CH00227                                        1420 04393000
         L     @06,FRAMEPTR(,R2)                                   1420 04394000
         ST    R1,FRAMLOCC-24(@14,@06)                             1420 04395000
*            LISTPTR = R1;      /*ESTABLISH ADDRESSABILITY FOR CCH TB*/ 04396000
         ST    R1,LISTPTR                                          1421 04397000
*            LISTNUM = ZERO;    /*ZERO CCH LISTLOC TABLE     @G51DGBB*/ 04398000
         L     @14,LISTPTR                                         1422 04399000
         SLR   @06,@06                                             1422 04400000
         ST    @06,LISTNUM(,@14)                                   1422 04401000
*            DO Y = 1 BY 1 TO LISTMAX;                     /*@G51DGBB*/ 04402000
         LA    @14,1                                               1423 04403000
         ST    @14,Y                                               1423 04404000
@DL01423 DS    0H                                                  1424 04405000
*              LISTCCHR(Y) = LISTCCHR(Y) &&                        1424 04406000
*                            LISTCCHR(Y);                  /*@G51DGBB*/ 04407000
         LR    @06,@14                                             1424 04408000
         MH    @06,@CH00079                                        1424 04409000
         L     @05,LISTPTR                                         1424 04410000
         ALR   @05,@06                                             1424 04411000
         BCTR  @05,0                                               1424 04412000
         XC    LISTCCHR-4(5,@05),LISTCCHR-4(@05)                   1424 04413000
*            END;                                          /*@G51DGBB*/ 04414000
         AL    @14,@CF00056                                        1425 04415000
         ST    @14,Y                                               1425 04416000
         C     @14,@CF00295                                        1425 04417000
         BNH   @DL01423                                            1425 04418000
*            LISTPTR = FRAMLOCM(CCHINDX); /*ADDRESS OF MCH LISTLOC */   04419000
         L     @14,CCHINDX                                         1426 04420000
         MH    @14,@CH00227                                        1426 04421000
         L     @06,FRAMEPTR(,R2)                                   1426 04422000
         AL    @06,@CF01615                                        1426 04423000
         L     @14,FRAMLOCM-20(@14,@06)                            1426 04424000
         ST    @14,LISTPTR                                         1426 04425000
*            DO Y = 1 BY 1 TO LISTMAX;   /* ZERO MCH LISTLOC TABLE  */  04426000
         LA    @14,1                                               1427 04427000
         ST    @14,Y                                               1427 04428000
@DL01427 DS    0H                                                  1428 04429000
*            LISTCCHR(Y) = LISTCCHR(Y) &&                          1428 04430000
*                          LISTCCHR(Y);                    /*@G51DGBB*/ 04431000
         LR    @06,@14                                             1428 04432000
         MH    @06,@CH00079                                        1428 04433000
         L     @05,LISTPTR                                         1428 04434000
         ALR   @05,@06                                             1428 04435000
         BCTR  @05,0                                               1428 04436000
         XC    LISTCCHR-4(5,@05),LISTCCHR-4(@05)                   1428 04437000
*            END;                                          /*@G51DGBB*/ 04438000
         AL    @14,@CF00056                                        1429 04439000
         ST    @14,Y                                               1429 04440000
         C     @14,@CF00295                                        1429 04441000
         BNH   @DL01427                                            1429 04442000
*            LISTNUM = ZERO;                               /*@G51DGBB*/ 04443000
         L     @14,LISTPTR                                         1430 04444000
         SLR   @06,@06                                             1430 04445000
         ST    @06,LISTNUM(,@14)                                   1430 04446000
*          END;                                            /*@G51DGBB*/ 04447000
*        ELSE /*UNSUCCESSFUL GETMAIN                         @G51DGBB*/ 04448000
*          DO;                                             /*@G51DGBB*/ 04449000
         B     @RC01409                                            1432 04450000
@RF01409 DS    0H                                                  1433 04451000
*            MSGNO = 40;                                   /*@G51DGBB*/ 04452000
         MVI   MSGNO,X'28'                                         1433 04453000
*            CALL ERRMSG;                                  /*@G51DGBB*/ 04454000
         BAL   @14,ERRMSG                                          1434 04455000
*            R15 = TWELVE;                                 /*@G51DGBB*/ 04456000
         LA    @06,12                                              1435 04457000
         LR    R15,@06                                             1435 04458000
*            ERROR = TWELVE;                               /*@G51DGBB*/ 04459000
         ST    @06,ERROR                                           1436 04460000
*          END;                                            /*@G51DGBB*/ 04461000
*      END;                                                /*@G51DGBB*/ 04462000
@RC01409 DS    0H                                                  1439 04463000
*    IF R15 = ZERO THEN /*IF GETMAIN WAS SUCCESSFUL OR NO GETMAIN*/     04464000
@RF01404 LTR   R15,R15                                             1439 04465000
         BNZ   @RF01439                                            1439 04466000
*      LISTPTR = FRAMLOCM(CCHINDX);/*ESTABLISH LISTLOC ADDRESS   */     04467000
         L     @14,CCHINDX                                         1440 04468000
         MH    @14,@CH00227                                        1440 04469000
         L     @06,FRAMEPTR(,R2)                                   1440 04470000
         AL    @06,@CF01615                                        1440 04471000
         L     @14,FRAMLOCM-20(@14,@06)                            1440 04472000
         ST    @14,LISTPTR                                         1440 04473000
*  END;                                                    /*@G51DGBB*/ 04474000
*ELSE /* IS A CCH FRAME                                      @G51DGBB*/ 04475000
*    LISTPTR = FRAMLOCC(CCHINDX);  /*ESTABLISH CCH LISTLOC ADDRESS*/    04476000
         B     @RC01402                                            1442 04477000
@RF01402 L     @14,CCHINDX                                         1442 04478000
         MH    @14,@CH00227                                        1442 04479000
         L     @06,FRAMEPTR(,R2)                                   1442 04480000
         L     @14,FRAMLOCC-24(@14,@06)                            1442 04481000
         ST    @14,LISTPTR                                         1442 04482000
*IF ERROR = ZERO THEN                                              1443 04483000
@RC01402 L     @14,ERROR                                           1443 04484000
         LTR   @14,@14                                             1443 04485000
         BNZ   @RF01443                                            1443 04486000
*  DO;                                                     /*@G51DGBB*/ 04487000
*    IF LISTNUM + 1 <= LISTMAX THEN /*IF ROOM IN LISTLOC     @G51DGBB*/ 04488000
         LA    @14,1                                               1445 04489000
         L     @06,LISTPTR                                         1445 04490000
         AL    @14,LISTNUM(,@06)                                   1445 04491000
         C     @14,@CF00295                                        1445 04492000
         BH    @RF01445                                            1445 04493000
*      DO;                                                 /*@G51DGBB*/ 04494000
*        RESPECIFY (R1) UNRESTRICTED; /*FOR PARM LIST        @G51DGBB*/ 04495000
*        IF PHIST = ON THEN        /*IF HISTORY INPUT        @G51DGBB*/ 04496000
         TM    PHIST(R2),B'00100000'                               1448 04497000
         BNO   @RF01448                                            1448 04498000
*          CALL IOHND(RITESCRT);   /*WRITE TO SCRATCH DATA SET*/   1449 04499000
         L     @15,ADIOHND(,R2)                                    1449 04500000
         LA    @01,@AL01449                                        1449 04501000
         BALR  @14,@15                                             1449 04502000
*        IF R15 = SUCCESS THEN     /*IF SUCCESSFULL WRITE    @G51DGBB*/ 04503000
@RF01448 LTR   R15,R15                                             1450 04504000
         BNZ   @RF01450                                            1450 04505000
*          DO;                                             /*@G51DGBB*/ 04506000
*            LISTCCHR(LISTNUM+1) = RECCCHHR;/*SAVE FRAME EXTERNAL LOC*/ 04507000
         L     @14,LISTPTR                                         1452 04508000
         L     @06,LISTNUM(,@14)                                   1452 04509000
         LR    @05,@06                                             1452 04510000
         MH    @05,@CH00079                                        1452 04511000
         ALR   @05,@14                                             1452 04512000
         MVC   LISTCCHR(5,@05),RECCCHHR(R2)                        1452 04513000
*            LISTNUM = LISTNUM + 1; /*INCREMENT NO OF BUILT ENTRIES*/   04514000
         LA    @05,1                                               1453 04515000
         ALR   @06,@05                                             1453 04516000
         ST    @06,LISTNUM(,@14)                                   1453 04517000
*            BUG(40) = BUG(40) + 1;                        /*@G51DGBB*/ 04518000
         AL    @05,BUG+156                                         1454 04519000
         ST    @05,BUG+156                                         1454 04520000
*          END;                                            /*@G51DGBB*/ 04521000
*        ELSE  /*UNSUCCESSFUL WRITE TO SCRATCH D.S.          @G51DGBB*/ 04522000
*          R15 = TWELVE; /*TERMINATE FURTHER PROCESSING      @G51DGBB*/ 04523000
         B     @RC01450                                            1456 04524000
@RF01450 LA    R15,12                                              1456 04525000
*      END;                                                /*@G51DGBB*/ 04526000
@RC01450 DS    0H                                                  1458 04527000
*  END;                                                    /*@G51DGBB*/ 04528000
@RF01445 DS    0H                                                  1459 04529000
*ERROR = R15;                                              /*@G51DGBB*/ 04530000
@RF01443 ST    R15,ERROR                                           1459 04531000
*RESPECIFY (R0,R4,R15) UNRESTRICTED;                       /*@G51DGBB*/ 04532000
*END; /*END OF BUILDTTR PROC                                 @G51DGBB*/ 04533000
@EL00035 DS    0H                                                  1461 04534000
@EF00035 DS    0H                                                  1461 04535000
@ER00035 LM    @14,@12,@SA00035                                    1461 04536000
         BR    @14                                                 1461 04537000
*FIXENTRY: PROC;  /*RESET LISTLOC TABLE TO ZEROS BUT DONT FREE CORE*/   04538000
FIXENTRY STM   @14,@12,12(@13)                                     1462 04539000
*                 /*RESET DATE,TYPE TO ZEROS                 @G51DGBB*/ 04540000
*FRAMEDT(CCHINDX) = '0000000000000000'X; /*ZERO DATE,TIME    @G51DGBB*/ 04541000
         L     @06,CCHINDX                                         1463 04542000
         MH    @06,@CH00227                                        1463 04543000
         L     @03,FRAMEPTR(,R2)                                   1463 04544000
         ST    @06,@TF00001                                        1463 04545000
         ALR   @06,@03                                             1463 04546000
         AL    @06,@CF01636                                        1463 04547000
         MVC   FRAMEDT-9(8,@06),@CB01563                           1463 04548000
*FRAMETYP(CCHINDX) = '00'X; /*RESET TO NO TYPES OF FRAMES STORED*/ 1464 04549000
         LR    @06,@03                                             1464 04550000
         AL    @06,@TF00001                                        1464 04551000
         AL    @06,@CF01614                                        1464 04552000
         MVI   FRAMETYP-17(@06),X'00'                              1464 04553000
*IF FRAMLOCM(CCHINDX) > ZERO THEN /*IF MCH FRAME LOC. TAB. ALLOCATED*/  04554000
         L     @06,@TF00001                                        1465 04555000
         AL    @03,@CF01615                                        1465 04556000
         L     @06,FRAMLOCM-20(@06,@03)                            1465 04557000
         LTR   @06,@06                                             1465 04558000
         BNP   @RF01465                                            1465 04559000
*  DO;                                                     /*@G51DGBB*/ 04560000
*    LISTPTR = FRAMLOCM(CCHINDX); /*SET TABLE BASE ADDRESS   @G51DGBB*/ 04561000
         ST    @06,LISTPTR                                         1467 04562000
*    DO Y = 1 BY 1 TO LISTNUM; /*CLEAR ALL STORED CCHHRS TO ZERO*/ 1468 04563000
         LA    @06,1                                               1468 04564000
         ST    @06,Y                                               1468 04565000
         B     @DE01468                                            1468 04566000
@DL01468 DS    0H                                                  1469 04567000
*      LISTCCHR(Y) = (LISTCCHR(Y) && LISTCCHR(Y));         /*@G51DGBB*/ 04568000
         LR    @03,@06                                             1469 04569000
         MH    @03,@CH00079                                        1469 04570000
         L     @01,LISTPTR                                         1469 04571000
         ALR   @01,@03                                             1469 04572000
         BCTR  @01,0                                               1469 04573000
         XC    LISTCCHR-4(5,@01),LISTCCHR-4(@01)                   1469 04574000
*      BUG(41) = BUG(41) + 1; /*ADD TO COUNT OF REJECTED FRAMES*/  1470 04575000
         LA    @03,1                                               1470 04576000
         AL    @03,BUG+160                                         1470 04577000
         ST    @03,BUG+160                                         1470 04578000
*      BUG(40) = BUG(40) - 1; /*SUBTRACT FROM COUNT OF ACCEPTED FRMES*/ 04579000
         L     @03,BUG+156                                         1471 04580000
         BCTR  @03,0                                               1471 04581000
         ST    @03,BUG+156                                         1471 04582000
*    END;                                                  /*@G51DGBB*/ 04583000
         AL    @06,@CF00056                                        1472 04584000
         ST    @06,Y                                               1472 04585000
@DE01468 L     @03,LISTPTR                                         1472 04586000
         C     @06,LISTNUM(,@03)                                   1472 04587000
         BNH   @DL01468                                            1472 04588000
*    LISTNUM = ZERO; /*SET NUMBER OF STORED CCHHRS TO ZERO   @G51DGBB*/ 04589000
         L     @06,LISTPTR                                         1473 04590000
         SLR   @03,@03                                             1473 04591000
         ST    @03,LISTNUM(,@06)                                   1473 04592000
*  END;                                                    /*@G51DGBB*/ 04593000
*IF FRAMLOCC(CCHINDX) > ZERO THEN /*IF CCH FRAM LOC TABLE ALLOCATED*/   04594000
@RF01465 L     @06,CCHINDX                                         1475 04595000
         MH    @06,@CH00227                                        1475 04596000
         L     @03,FRAMEPTR(,R2)                                   1475 04597000
         L     @06,FRAMLOCC-24(@06,@03)                            1475 04598000
         LTR   @06,@06                                             1475 04599000
         BNP   @RF01475                                            1475 04600000
*  DO;                                                     /*@G51DGBB*/ 04601000
*    LISTPTR = FRAMLOCC(CCHINDX); /*SET BASE ADDRESS OF LISTLOC*/  1477 04602000
         ST    @06,LISTPTR                                         1477 04603000
*    DO Y = 1 BY 1 TO LISTNUM; /*ZERO ALL SAVED CCHHRS       @G51DGBB*/ 04604000
         LA    @06,1                                               1478 04605000
         ST    @06,Y                                               1478 04606000
         B     @DE01478                                            1478 04607000
@DL01478 DS    0H                                                  1479 04608000
*      LISTCCHR(Y) = (LISTCCHR(Y) && LISTCCHR(Y));         /*@G51DGBB*/ 04609000
         LR    @03,@06                                             1479 04610000
         MH    @03,@CH00079                                        1479 04611000
         L     @01,LISTPTR                                         1479 04612000
         ALR   @01,@03                                             1479 04613000
         BCTR  @01,0                                               1479 04614000
         XC    LISTCCHR-4(5,@01),LISTCCHR-4(@01)                   1479 04615000
*      BUG(41) = BUG(41) + 1; /*ADD TO COUNT OF REJECTED FRAMES*/  1480 04616000
         LA    @03,1                                               1480 04617000
         AL    @03,BUG+160                                         1480 04618000
         ST    @03,BUG+160                                         1480 04619000
*      BUG(40) = BUG(40) - 1; /*SUBTRACT FROM COUNT OF ACCEPTED FRAMES* 04620000
         L     @03,BUG+156                                         1481 04621000
         BCTR  @03,0                                               1481 04622000
         ST    @03,BUG+156                                         1481 04623000
*    END;                                                  /*@G51DGBB*/ 04624000
         AL    @06,@CF00056                                        1482 04625000
         ST    @06,Y                                               1482 04626000
@DE01478 L     @03,LISTPTR                                         1482 04627000
         C     @06,LISTNUM(,@03)                                   1482 04628000
         BNH   @DL01478                                            1482 04629000
*    LISTNUM = ZERO; /*SET NUMBER OF  CCHHRS SAVED TO ZERO   @G51DGBB*/ 04630000
         L     @06,LISTPTR                                         1483 04631000
         SLR   @03,@03                                             1483 04632000
         ST    @03,LISTNUM(,@06)                                   1483 04633000
*  END;                                                    /*@G51DGBB*/ 04634000
*END;                                                      /*@G51DGBB*/ 04635000
@EL00036 DS    0H                                                  1485 04636000
@EF00036 DS    0H                                                  1485 04637000
@ER00036 LM    @14,@12,12(@13)                                     1485 04638000
         BR    @14                                                 1485 04639000
*FLIMFRAM: PROC; /*PROCESS FRAME RECORDS SEQUENTIALLY        @G51DGBB*/ 04640000
FLIMFRAM STM   @14,@12,@SA00037                                    1486 04641000
* RESPECIFY (R15) RESTRICTED;                              /*@G51DGBB*/ 04642000
*   IF PACC = ON &                 /* IF NO ACCUMULATION OR NO  */ 1488 04643000
*     (PMCH = ON | PCHAN = ON) THEN /* MCH OR CCH SELECTION THEN */     04644000
         TM    PACC(R2),B'01000000'                                1488 04645000
         BNO   @RF01488                                            1488 04646000
         TM    PMCH(R2),B'11000000'                                1488 04647000
         BZ    @RF01488                                            1488 04648000
*    DO;                            /* DONT SELECT FRAMES    @G51DGBB*/ 04649000
*      IF LRTCNT = ONE &            /* IF FIRST PHYSICAL FRAME   */     04650000
*         (LRTKEY1 & GENREC) = HEXA0 THEN /*IS MCF           @G51DGBB*/ 04651000
         CLI   LRTCNT(R7),1                                        1490 04652000
         BNE   @RF01490                                            1490 04653000
         MVC   @TS00001(1),LRTKEY1(R7)                             1490 04654000
         NI    @TS00001,X'F0'                                      1490 04655000
         CLI   @TS00001,X'A0'                                      1490 04656000
         BNE   @RF01490                                            1490 04657000
*        DO;                                               /*@G51DGBB*/ 04658000
*          SAVESEQ = ONE;           /* RESET SEQUENCE CHECK  @G51DGBB*/ 04659000
         MVI   SAVESEQ,X'01'                                       1492 04660000
*          CALL FRAMEREP;           /* SEE IF THIS FRAME SET MUST*/     04661000
         BAL   @14,FRAMEREP                                        1493 04662000
*          R15 = ERROR;             /* BE SAVED              @G51DGBB*/ 04663000
         L     R15,ERROR                                           1494 04664000
*          IF LRTNLAST = OFF &      /*IF FIRST FRAME IS LAST OF SET*/   04665000
*             FRAMEYES = YES &     /*IF FRAME SET TO BE SAVED   */ 1495 04666000
*             R15 = ZERO THEN      /*NO ERROR CONDITIONS     @G51DGBB*/ 04667000
         TM    LRTNLAST(R7),B'10000000'                            1495 04668000
         BNZ   @RF01495                                            1495 04669000
         TM    FRAMEYES,B'00000001'                                1495 04670000
         BNO   @RF01495                                            1495 04671000
         LTR   R15,R15                                             1495 04672000
         BNZ   @RF01495                                            1495 04673000
*            DO;                                           /*@G51DGBB*/ 04674000
*              SAVESEQ = ZERO;    /*INITIALIZE SEQUENCE CHECK*/    1497 04675000
         MVI   SAVESEQ,X'00'                                       1497 04676000
*              FRAMETYP(CCHINDX) = ALLMCH; /*ONLY ONE BUT ALL IN*/ 1498 04677000
         L     @14,CCHINDX                                         1498 04678000
         MH    @14,@CH00227                                        1498 04679000
         L     @06,FRAMEPTR(,R2)                                   1498 04680000
         ALR   @06,@14                                             1498 04681000
         AL    @06,@CF01614                                        1498 04682000
         MVI   FRAMETYP-17(@06),X'02'                              1498 04683000
*            END;                                          /*@G51DGBB*/ 04684000
*        END;                                              /*@G51DGBB*/ 04685000
*      ELSE                         /* NON-FIRST FRAME       @G51DGBB*/ 04686000
*        DO;                                               /*@G51DGBB*/ 04687000
         B     @RC01490                                            1501 04688000
@RF01490 DS    0H                                                  1502 04689000
*          IF FRAMEYES = ON THEN    /* IF FRAME IS TO BE SAVED  */ 1502 04690000
         TM    FRAMEYES,B'00000001'                                1502 04691000
         BNO   @RF01502                                            1502 04692000
*            DO;                                           /*@G51DGBB*/ 04693000
*              SAVESEQ = SAVESEQ + 1;  /* UP SEQ CHECK       @G51DGBB*/ 04694000
         IC    @14,SAVESEQ                                         1504 04695000
         LA    @14,1(,@14)                                         1504 04696000
         STC   @14,SAVESEQ                                         1504 04697000
*              IF SAVESEQ = LRTCNT THEN /* IF RECORD NOT MISSING */     04698000
         CLC   SAVESEQ(1),LRTCNT(R7)                               1505 04699000
         BNE   @RF01505                                            1505 04700000
*                DO;                                       /*@G51DGBB*/ 04701000
*                  CALL BUILDTTR;    /* BUILD EXTERNAL LOCATION */ 1507 04702000
         BAL   @14,BUILDTTR                                        1507 04703000
*                  R15 = ERROR;                            /*@G51DGBB*/ 04704000
         L     R15,ERROR                                           1508 04705000
*                  IF R15 = ZERO THEN  /* IF FRAME EXTERNAL LOC  */     04706000
         LTR   R15,R15                                             1509 04707000
         BNZ   @RF01509                                            1509 04708000
*                    DO;               /* SUCCESSFULLY SAVED @G51DGBB*/ 04709000
*                      IF LRTNLAST = OFF THEN /* IF LAST FRAME  */ 1511 04710000
         TM    LRTNLAST(R7),B'10000000'                            1511 04711000
         BNZ   @RF01511                                            1511 04712000
*                        DO;                               /*@G51DGBB*/ 04713000
*                          IF (LRTKEY1 & GENREC) = HEXA0 THEN      1513 04714000
         MVC   @TS00001(1),LRTKEY1(R7)                             1513 04715000
         NI    @TS00001,X'F0'                                      1513 04716000
         CLI   @TS00001,X'A0'                                      1513 04717000
         BNE   @RF01513                                            1513 04718000
*                            DO;                           /*@G51DGBB*/ 04719000
*                              SAVESEQ = ZERO; /*REINITIALIZE SEQ CNT*/ 04720000
         MVI   SAVESEQ,X'00'                                       1515 04721000
*                              FRAMETYP(CCHINDX) = ALLMCH; /*@G51DGBB*/ 04722000
         L     @14,CCHINDX                                         1516 04723000
         MH    @14,@CH00227                                        1516 04724000
         L     @06,FRAMEPTR(,R2)                                   1516 04725000
         ALR   @06,@14                                             1516 04726000
         AL    @06,@CF01614                                        1516 04727000
         MVI   FRAMETYP-17(@06),X'02'                              1516 04728000
*                            END;                          /*@G51DGBB*/ 04729000
*                          /*IF ALL MCH FRAMES HAVE BEEN SAVED,  */     04730000
*                          /*THEN INDICATE SUCH              @G51DGBB*/ 04731000
*                           ELSE                  /*IS CCH FRAME */     04732000
*                            DO;                           /*@G51DGBB*/ 04733000
         B     @RC01513                                            1518 04734000
@RF01513 DS    0H                                                  1519 04735000
*                            FRAMEYES = OFF; /*RESET FRAME ACCEPT SW*/  04736000
         NI    FRAMEYES,B'11111110'                                1519 04737000
*                            IF FRAMETYP(CCHINDX) ^= ALLMCH THEN   1520 04738000
         L     @14,CCHINDX                                         1520 04739000
         MH    @14,@CH00227                                        1520 04740000
         L     @06,FRAMEPTR(,R2)                                   1520 04741000
         ALR   @06,@14                                             1520 04742000
         AL    @06,@CF01614                                        1520 04743000
         CLI   FRAMETYP-17(@06),X'02'                              1520 04744000
         BE    @RF01520                                            1520 04745000
*                              DO; /*IF MISSING LAST MCH FRAME   */     04746000
*                                MSGNO = 79; /*INCOMPLETE FRAME SET*/   04747000
         MVI   MSGNO,X'4F'                                         1522 04748000
*                                CALL ERRMSG;              /*@G51DGBB*/ 04749000
         BAL   @14,ERRMSG                                          1523 04750000
*                                CALL FIXENTRY; /*DELETE INCOM-  */     04751000
         BAL   @14,FIXENTRY                                        1524 04752000
*                              END;             /*PLETE SET. @G51DGBB*/ 04753000
*                            ELSE   /*IS COMPLETE SET -INDICATE  */     04754000
*                              FRAMETYP(CCHINDX) = ALLALL; /*IT IS*/    04755000
         B     @RC01520                                            1526 04756000
@RF01520 L     @14,CCHINDX                                         1526 04757000
         MH    @14,@CH00227                                        1526 04758000
         L     @06,FRAMEPTR(,R2)                                   1526 04759000
         ALR   @06,@14                                             1526 04760000
         AL    @06,@CF01614                                        1526 04761000
         MVI   FRAMETYP-17(@06),X'FF'                              1526 04762000
*                            END;                          /*@G51DGBB*/ 04763000
*                        END;                              /*@G51DGBB*/ 04764000
*                   END;                                   /*@G51DGBB*/ 04765000
*              END;                                        /*@G51DGBB*/ 04766000
*            ELSE   /*MISSING MIDDLE FRAME                   @G51DGBB*/ 04767000
*              DO;                                         /*@G51DGBB*/ 04768000
         B     @RC01505                                            1531 04769000
@RF01505 DS    0H                                                  1532 04770000
*                MSGNO = 79; /*INCOMPLETE FRAME SET MESSAGE  @G51DGBB*/ 04771000
         MVI   MSGNO,X'4F'                                         1532 04772000
*                CALL ERRMSG;                              /*@G51DGBB*/ 04773000
         BAL   @14,ERRMSG                                          1533 04774000
*                FRAMEYES = OFF; /*DONT SAVE INCOMPLETE SET  @G51DGBB*/ 04775000
         NI    FRAMEYES,B'11111110'                                1534 04776000
*                CALL FIXENTRY; /*DELETE REFS TO INCOMPLETE SET*/  1535 04777000
         BAL   @14,FIXENTRY                                        1535 04778000
*                BUG(41) = BUG(41) + 1;                    /*@G51DGBB*/ 04779000
         LA    @14,1                                               1536 04780000
         AL    @14,BUG+160                                         1536 04781000
         ST    @14,BUG+160                                         1536 04782000
*              END;                                        /*@G51DGBB*/ 04783000
*       END;                                               /*@G51DGBB*/ 04784000
*          ELSE      /*FRAME NOT TO BE SAVED                 @G51DGBB*/ 04785000
*            BUG(41) = BUG(41) + 1;                        /*@G51DGBB*/ 04786000
         B     @RC01502                                            1539 04787000
@RF01502 LA    @14,1                                               1539 04788000
         AL    @14,BUG+160                                         1539 04789000
         ST    @14,BUG+160                                         1539 04790000
*      END;                                                /*@G51DGBB*/ 04791000
*   END;                                                   /*@G51DGBB*/ 04792000
*  ELSE   /*NOT ACCUMULATING OR SELECTING MCH OR CCH RECORDS @G51DGBB*/ 04793000
*    BUG(41) = BUG(41) + 1; /*COUNT FRAMES REJECTED          @G51DGBB*/ 04794000
         B     @RC01488                                            1542 04795000
@RF01488 LA    @14,1                                               1542 04796000
         AL    @14,BUG+160                                         1542 04797000
         ST    @14,BUG+160                                         1542 04798000
*RESPECIFY (R15) UNRESTRICTED;                             /*@G51DGBB*/ 04799000
*END; /*CLOSING END TO PROC FLIMFRAM                         @G51DGBB*/ 04800000
@EL00037 DS    0H                                                  1544 04801000
@EF00037 DS    0H                                                  1544 04802000
@ER00037 LM    @14,@12,@SA00037                                    1544 04803000
         BR    @14                                                 1544 04804000
*END  /*CLOSING END TO EXTERNAL PROC, IFCFILT3               @Z427VLS*/ 04805000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 04806000
*/*%INCLUDE SYSLIB  (COMTABLE)                                        * 04807000
*;                                                                 1545 04808000
@DATA    DS    0H                                                       04809000
@CH01385 DC    H'76'                                                    04810000
         DS    0F                                                       04811000
@AL00199 EQU   *                       LIST WITH   1 ARGUMENT(S)        04812000
@AL00285 EQU   *                       LIST WITH   1 ARGUMENT(S)        04813000
@AL00748 EQU   *                       LIST WITH   1 ARGUMENT(S)        04814000
@AL00761 EQU   *                       LIST WITH   1 ARGUMENT(S)        04815000
@AL01302 EQU   *                       LIST WITH   1 ARGUMENT(S)        04816000
@AL01321 EQU   *                       LIST WITH   1 ARGUMENT(S)        04817000
@AL01336 DC    A(@CF00074+2)           LIST WITH   1 ARGUMENT(S)        04818000
@AL00205 DC    A(@CF00076+2)           LIST WITH   1 ARGUMENT(S)        04819000
@AL00228 EQU   *                       LIST WITH   1 ARGUMENT(S)        04820000
@AL00709 EQU   *                       LIST WITH   1 ARGUMENT(S)        04821000
@AL00718 DC    A(@CF00065+2)           LIST WITH   1 ARGUMENT(S)        04822000
@AL00552 DC    A(@CF00065)             LIST WITH   3 ARGUMENT(S)        04823000
         DC    A(WORKDEV)                                               04824000
         DC    A(LINKDEV)                                               04825000
@AL00671 EQU   *                       LIST WITH   1 ARGUMENT(S)        04826000
@AL00683 EQU   *                       LIST WITH   1 ARGUMENT(S)        04827000
@AL00699 EQU   *                       LIST WITH   1 ARGUMENT(S)        04828000
@AL00766 DC    A(@CF00083+2)           LIST WITH   1 ARGUMENT(S)        04829000
@AL00707 EQU   *                       LIST WITH   1 ARGUMENT(S)        04830000
@AL00716 DC    A(@CF00081+2)           LIST WITH   1 ARGUMENT(S)        04831000
@AL00746 DC    A(@CF01460)             LIST WITH   2 ARGUMENT(S)        04832000
         DC    A(@AFTEMPS)                                              04833000
@AL00759 DC    A(@CF01461)             LIST WITH   2 ARGUMENT(S)        04834000
         DC    A(@AFTEMPS)                                              04835000
@AL00999 DC    A(@CF00952)             LIST WITH   3 ARGUMENT(S)        04836000
@AL01449 DC    A(@CF00079+2)           LIST WITH   1 ARGUMENT(S)        04837000
         DC    A(LINKDEV)                                               04838000
@AL01256 DC    A(@CF01534)             LIST WITH   2 ARGUMENT(S)        04839000
         DC    A(@AFTEMPS+4)                                            04840000
@AL01259 DC    A(@CF01535)             LIST WITH   2 ARGUMENT(S)        04841000
         DC    A(@AFTEMPS+4)                                            04842000
@AL01262 DC    A(@CF01536)             LIST WITH   2 ARGUMENT(S)        04843000
         DC    A(@AFTEMPS+4)                                            04844000
@AL01269 DC    A(@CF01537)             LIST WITH   2 ARGUMENT(S)        04845000
         DC    A(@AFTEMPS+4)                                            04846000
@AL01272 DC    A(@CF01453)             LIST WITH   2 ARGUMENT(S)        04847000
         DC    A(@AFTEMPS+4)                                            04848000
@AL01299 DC    A(@CF01380)             LIST WITH   2 ARGUMENT(S)        04849000
         DC    A(@AFTEMPS+4)                                            04850000
@AL01301 DC    A(@CF00227)             LIST WITH   2 ARGUMENT(S)        04851000
         DC    A(@AFTEMPS+4)                                            04852000
         DS    0F                                                       04853000
@SA00001 DS    18F                                                      04854000
@SA00003 DS    15F                                                      04855000
@SA00037 DS    15F                                                      04856000
@SA00016 DS    15F                                                      04857000
@SA00002 DS    15F                                                      04858000
@SA00014 DS    15F                                                      04859000
@SA00032 DS    15F                                                      04860000
@SA00030 DS    15F                                                      04861000
@SA00006 DS    15F                                                      04862000
@SA00007 DS    15F                                                      04863000
@SA00013 DS    15F                                                      04864000
@SA00008 DS    15F                                                      04865000
@SA00017 DS    15F                                                      04866000
@SA00019 DS    15F                                                      04867000
@SA00020 DS    15F                                                      04868000
@SA00026 DS    15F                                                      04869000
@SA00023 DS    15F                                                      04870000
@SA00027 DS    15F                                                      04871000
@SA00024 DS    15F                                                      04872000
@SA00021 DS    15F                                                      04873000
@SA00022 DS    15F                                                      04874000
@SA00033 DS    15F                                                      04875000
@SA00034 DS    15F                                                      04876000
@SA00035 DS    15F                                                      04877000
@AL00001 DS    3A                                                       04878000
@TF00001 DS    F                                                        04879000
@TF00002 DS    F                                                        04880000
@AFTEMPS DS    2F                                                       04881000
         DS    0F                                                       04882000
@CF00056 DC    F'1'                                                     04883000
@CF00074 DC    F'2'                                                     04884000
@CH00074 EQU   @CF00074+2                                               04885000
@CF00076 DC    F'3'                                                     04886000
@CH00076 EQU   @CF00076+2                                               04887000
@CF00065 DC    F'4'                                                     04888000
@CH00065 EQU   @CF00065+2                                               04889000
@CF00079 DC    F'5'                                                     04890000
@CH00079 EQU   @CF00079+2                                               04891000
@CF00081 DC    F'6'                                                     04892000
@CH00081 EQU   @CF00081+2                                               04893000
@CF00083 DC    F'7'                                                     04894000
@CH00083 EQU   @CF00083+2                                               04895000
@CF00036 DC    F'8'                                                     04896000
@CF00035 DC    F'9'                                                     04897000
@CF00034 DC    F'10'                                                    04898000
@CF00033 DC    F'11'                                                    04899000
@CF00032 DC    F'12'                                                    04900000
@CF01029 DC    F'13'                                                    04901000
@CF00952 DC    F'14'                                                    04902000
@CH00952 EQU   @CF00952+2                                               04903000
@CF00037 DC    F'15'                                                    04904000
@CF00088 DC    F'16'                                                    04905000
@CF00786 DC    F'17'                                                    04906000
@CF01191 DC    F'18'                                                    04907000
@CF00227 DC    F'24'                                                    04908000
@CH00227 EQU   @CF00227+2                                               04909000
@CF01130 DC    F'27'                                                    04910000
@CF01380 DC    F'40'                                                    04911000
@CF01547 DC    F'44'                                                    04912000
@CF00295 DC    F'50'                                                    04913000
@CF01535 DC    F'53'                                                    04914000
@CF01534 DC    F'55'                                                    04915000
@CF01460 DC    F'70'                                                    04916000
@CF01461 DC    F'71'                                                    04917000
@CF01537 DC    F'72'                                                    04918000
@CF01536 DC    F'73'                                                    04919000
@CH01536 EQU   @CF01536+2                                               04920000
@CF01453 DC    F'78'                                                    04921000
@CF01386 DC    F'127'                                                   04922000
@CF01591 DC    F'254'                                                   04923000
@CF00972 DC    F'335'                                                   04924000
@CF00948 DC    F'366'                                                   04925000
@CF01601 DC    F'-68'                                                   04926000
@CF01632 DC    F'-64'                                                   04927000
@CF01619 DC    F'-60'                                                   04928000
@CF01620 DC    F'-56'                                                   04929000
@CF01621 DC    F'-52'                                                   04930000
@CF01622 DC    F'-48'                                                   04931000
@CF01623 DC    F'-44'                                                   04932000
@CF01624 DC    F'-40'                                                   04933000
@CF01625 DC    F'-36'                                                   04934000
@CF01626 DC    F'-32'                                                   04935000
@CF01627 DC    F'-28'                                                   04936000
@CF01628 DC    F'-24'                                                   04937000
@CF01602 DC    F'-20'                                                   04938000
@CF01635 DC    F'-17'                                                   04939000
@CF01629 DC    F'-16'                                                   04940000
@CF01636 DC    F'-15'                                                   04941000
@CF01375 DC    F'-14'                                                   04942000
@CF01611 DC    F'-13'                                                   04943000
@CF01630 DC    F'-12'                                                   04944000
@CF01603 DC    F'-11'                                                   04945000
@CF01604 DC    F'-10'                                                   04946000
@CF01631 DC    F'-8'                                                    04947000
@CF01614 DC    F'-7'                                                    04948000
@CF01599 DC    F'-6'                                                    04949000
@CF01615 DC    F'-4'                                                    04950000
@CF01609 DC    F'-3'                                                    04951000
@CF00893 DC    XL4'FFFFFFF8'                                            04952000
@CF01606 DC    XL4'0000FFFF'                                            04953000
@CV01429 DC    V(IFCDEVIC)                                              04954000
         DS    0D                                                       04955000
ENTRIES  DC    F'1'                                                     04956000
LISTPTR  DC    A(0)                                                     04957000
ZZ       DC    A(0)                                                     04958000
Z1       DC    F'0'                                                     04959000
Z2       DC    F'0'                                                     04960000
Z3       DC    F'0'                                                     04961000
ZZ3      DC    F'0'                                                     04962000
NUMBER   DC    F'0'                                                     04963000
NEXTBY   DC    F'0'                                                     04964000
ADDNXT   DC    F'0'                                                     04965000
T        DC    F'0'                                                     04966000
P        DC    F'0'                                                     04967000
R        DC    F'0'                                                     04968000
INDEX    DS    F                                                        04969000
YEAR     DC    H'0'                                                     04970000
         DS    0D                                                       04971000
@TS00001 DS    CL16                                                     04972000
@CB01563 DC    X'0000000000000000'                                      04973000
@CB00290 EQU   @CB01563                                                 04974000
@CB01458 DC    X'0000000F'                                              04975000
@CB00228 DC    X'00000F'                                                04976000
@CB00237 DC    X'FFFFFF'                                                04977000
@CB00924 DC    X'000FFF'                                                04978000
@CB00956 EQU   @CB01563                                                 04979000
@CB01388 DC    X'99366F'                                                04980000
@CB00208 EQU   @CB01563                                                 04981000
@CB00261 EQU   @CB00237                                                 04982000
@CB00896 DC    X'8004'                                                  04983000
@CB00898 DC    X'8005'                                                  04984000
@CB00900 DC    X'8003'                                                  04985000
@CB00902 DC    X'100C'                                                  04986000
@CB00904 DC    X'1008'                                                  04987000
@CB00906 DC    X'0842'                                                  04988000
@CB00922 DC    X'0FFF'                                                  04989000
@CB00976 DC    X'2006'                                                  04990000
@CB00978 DC    X'2007'                                                  04991000
@CB00980 DC    X'2009'                                                  04992000
@CB00982 DC    X'200A'                                                  04993000
@CB00984 DC    X'200B'                                                  04994000
@CB00986 DC    X'200D'                                                  04995000
@CB01007 DC    X'0003'                                                  04996000
@CB01418 DC    X'3705'                                                  04997000
@CB01497 DC    X'8809'                                                  04998000
LETTERS  DC    CL1'S'                                                   04999000
TREND2   DC    X'0000000000000000000000000000'                          05000000
         ORG   TREND2                                                   05001000
TRENDKEY DS    CL8                                                      05002000
         ORG   TRENDKEY                                                 05003000
TRENDGRP DS    FL1                                                      05004000
TRENDRT  DS    BL2                                                      05005000
         ORG   TRENDRT                                                  05006000
TRENDCUA DS    BL2                                                      05007000
         ORG   TRENDKEY+3                                               05008000
TRENCPUS DS    BL1                                                      05009000
         ORG   TRENCPUS                                                 05010000
TRENDCPU DS    BL1                                                      05011000
TRENDOLD EQU   TRENCPUS+0                                               05012000
         ORG   TRENDKEY+4                                               05013000
TRENDITM DS    BL1                                                      05014000
         ORG   TRENDITM                                                 05015000
TREND037 DS    BL1                                                      05016000
TRENDOD  EQU   TRENDITM+0                                               05017000
         ORG   TRENDKEY+5                                               05018000
TRENDDAT DS    FL1                                                      05019000
TRENDDEV DS    CL2                                                      05020000
         ORG   TREND2+8                                                 05021000
TRENDPR1 DS    FL2                                                      05022000
         ORG   TRENDPR1                                                 05023000
@NM00084 DS    BL2                                                      05024000
TRENDPRM EQU   TRENDPR1+1                                               05025000
         ORG   TREND2+10                                                05026000
TRENDTMP DS    FL4                                                      05027000
         ORG   TREND2+14                                                05028000
         DS    CL1                                                      05029000
FILT1ITM DS    CL139                                                    05030000
         ORG   FILT1ITM                                                 05031000
MAXENT   DC    F'0'                                                     05032000
FREEADR  DC    A(0)                                                     05033000
I        DC    A(1)                                                     05034000
J        DC    A(0)                                                     05035000
K        DC    A(0)                                                     05036000
L        DC    A(0)                                                     05037000
M        DC    A(0)                                                     05038000
Q        DC    A(0)                                                     05039000
A        DC    A(0)                                                     05040000
X        DC    A(0)                                                     05041000
Y        DC    A(0)                                                     05042000
Z        DC    A(0)                                                     05043000
LINKITM  DC    A(0)                                                     05044000
CCHINDX  DC    A(0)                                                     05045000
SAVESEQ  DS    FL1                                                      05046000
         DS    CL3                                                      05047000
ADDAFT   DC    F'0'                                                     05048000
SRTCONT  DC    F'0'                                                     05049000
SRTCONT1 DC    F'0'                                                     05050000
DSTART   DC    F'0'                                                     05051000
DEND     DC    F'0'                                                     05052000
UNKNWN   DC    F'0'                                                     05053000
COMPLINK DC    F'0'                                                     05054000
ALLCORE  DC    F'0'                                                     05055000
TREN1SIZ DC    F'0'                                                     05056000
BINDAY   DC    F'0'                                                     05057000
ERROR    DC    F'0'                                                     05058000
ERSER    DC    X'00000000'                                              05059000
         ORG   ERSER                                                    05060000
@NM00085 DS    CL1                                                      05061000
ER3      DS    CL3                                                      05062000
         ORG   FILT1ITM+108                                             05063000
NUMUNSHR DC    H'1'                                                     05064000
PACKPAS  DC    CL4'    '                                                05065000
         DS    CL2                                                      05066000
PASSNUM  DC    F'0'                                                     05067000
NUMREC   DC    F'0'                                                     05068000
EXCESS   DC    F'0'                                                     05069000
WORKDEV  DC    X'0000'                                                  05070000
         ORG   WORKDEV                                                  05071000
WORKDEV1 DS    CL1                                                      05072000
WORKDEV2 DS    CL1                                                      05073000
         ORG   FILT1ITM+130                                             05074000
WORKTYPE DC    X'00'                                                    05075000
CUA3     DC    X'000000'                                                05076000
         ORG   CUA3                                                     05077000
@NM00086 DS    BL1                                                      05078000
WORKCUA  DS    BL2                                                      05079000
         ORG   WORKCUA                                                  05080000
WRKCUA   DS    BL2                                                      05081000
         ORG   FILT1ITM+134                                             05082000
WWCUA    DS    CL3                                                      05083000
         ORG   WWCUA                                                    05084000
@NM00087 DS    CL1                                                      05085000
WWCUA2   DS    CL2                                                      05086000
         ORG   FILT1ITM+137                                             05087000
TREIDX   DC    AL1(0)                                                   05088000
MSGNO    DC    AL1(0)                                                   05089000
         ORG   FILT1ITM+139                                             05090000
LINKDEV  DS    CL4                                                      05091000
         ORG   LINKDEV                                                  05092000
DEVLABEL DS    CL2                                                      05093000
@NM00088 DS    CL2                                                      05094000
         ORG   LINKDEV+4                                                05095000
YRSAVE   DC    X'0000'                                                  05096000
         ORG   YRSAVE                                                   05097000
YRSAVE1  DS    BL1                                                      05098000
YRSAVE2  DS    BL1                                                      05099000
         ORG   YRSAVE+2                                                 05100000
ERRPLACE DS    BL1                                                      05101000
         ORG   ERRPLACE                                                 05102000
ERRP1    DS    BL1                                                      05103000
ERRP2    EQU   ERRPLACE+0                                               05104000
         ORG   ERRPLACE+1                                               05105000
PRINTLIN DS    CL134                                                    05106000
         ORG   PRINTLIN                                                 05107000
PRINTDS  DC    X'F1'                                                    05108000
PRINTCC  DC    X'09'                                                    05109000
PRINTBDY DC    CL132' '                                                 05110000
         ORG   PRINTBDY                                                 05111000
@NM00089 DS    CL8                                                      05112000
PRINTED  DS    CL9                                                      05113000
@NM00090 DS    CL24                                                     05114000
PRNTSER  DS    CL7                                                      05115000
         ORG   PRINTLIN+134                                             05116000
PARTIAL  DS    CL58                                                     05117000
         ORG   PARTIAL                                                  05118000
@NM00093 DC    CL29'DEBUG16 FRAME SET INCOMPLETE '                      05119000
PARMOD   DS    CL4                                                      05120000
@NM00094 DC    CL1' '                                                   05121000
PARSER   DS    CL6                                                      05122000
@NM00095 DC    CL17' FRAMEREP SET TO '                                  05123000
PARREP   DS    CL1                                                      05124000
         ORG   PARTIAL+58                                               05125000
BITSWIT  DC    X'000000'                                                05126000
         ORG   BITSWIT                                                  05127000
FOUND    DS    BL1                                                      05128000
NONBLANK EQU   BITSWIT+0                                                05129000
DEVOK    EQU   BITSWIT+0                                                05130000
CUAOK    EQU   BITSWIT+0                                                05131000
SORTSW   EQU   BITSWIT+0                                                05132000
UNIQUE   EQU   BITSWIT+0                                                05133000
MISSW    EQU   BITSWIT+0                                                05134000
MISSW1   EQU   BITSWIT+0                                                05135000
CROSSFLG DS    BL1                                                      05136000
GETOUT   EQU   BITSWIT+1                                                05137000
FIRSTIME EQU   BITSWIT+1                                                05138000
ONBOUND  EQU   BITSWIT+1                                                05139000
CPU0FLG  EQU   BITSWIT+1                                                05140000
GETFAIL  EQU   BITSWIT+1                                                05141000
LOOPOUT  EQU   BITSWIT+1                                                05142000
FRAMEYES EQU   BITSWIT+1                                                05143000
ONETIME  DS    BL1                                                      05144000
SHAREYES EQU   BITSWIT+2                                                05145000
         ORG   BITSWIT+3                                                05146000
WORKBYTE DS    BL1                                                      05147000
         ORG   WORKBYTE                                                 05148000
WORKBYT4 DS    BL1                                                      05149000
         ORG   WORKBYTE+1                                               05150000
WORKTWO  DS    BL1                                                      05151000
DEVCDLNK DC    X'00000000'                                              05152000
         ORG   DEVCDLNK                                                 05153000
DEVLINK  DS    CL2                                                      05154000
@NM00100 DS    CL2                                                      05155000
         ORG   DEVCDLNK+4                                               05156000
CHARS    DC    CL16'0123456789ABCDEF'                                   05157000
SUPERZAP DC    3CL10'SUPERZAP'                                          05158000
         DS    CL3                                                      05159000
SAVEADR  DC    A(0)                                                     05160000
         DS    15XL4                                                    05161000
EVCON    DC    CL1'A'                                                   05162000
         DC    CL1'B'                                                   05163000
         DC    CL1'C'                                                   05164000
         DC    CL1'D'                                                   05165000
         DC    CL1'E'                                                   05166000
         DC    CL1'F'                                                   05167000
         DC    CL1'G'                                                   05168000
         DC    CL1'H'                                                   05169000
         DC    CL1'I'                                                   05170000
         DC    CL1'J'                                                   05171000
         DC    CL1'K'                                                   05172000
         DC    CL1'L'                                                   05173000
         DC    CL1'M'                                                   05174000
         DC    CL1'N'                                                   05175000
         DC    CL1'O'                                                   05176000
         DC    CL1'P'                                                   05177000
FLIP     DC    AL1(0)                                                   05178000
         DC    AL1(1)                                                   05179000
         DC    AL1(2)                                                   05180000
         DC    AL1(3)                                                   05181000
         DC    AL1(4)                                                   05182000
         DC    AL1(5)                                                   05183000
         DC    AL1(6)                                                   05184000
         DC    AL1(7)                                                   05185000
         DC    AL1(8)                                                   05186000
         DC    AL1(9)                                                   05187000
         DC    AL1(10)                                                  05188000
         DC    AL1(11)                                                  05189000
         DC    AL1(12)                                                  05190000
         DC    AL1(13)                                                  05191000
         DC    AL1(14)                                                  05192000
         DC    AL1(15)                                                  05193000
PATCH    DC    25F'0'                                                   05194000
EDIFILD  DS    9CL1                                                     05195000
         DS    CL3                                                      05196000
BUG      DC    50F'0'                                                   05197000
ERRLINE  DS    CL73                                                     05198000
         ORG   ERRLINE+0                                                05199000
ERRDS    DC    CL1'1'                                                   05200000
ERCC     DC    X'09'                                                    05201000
ERRMES   DC    CL10'DEBUG16   '                                         05202000
ERXNUM   DC    CL9'         '                                           05203000
@NM00101 DC    CL2'  '                                                  05204000
ERRTXT   DC    CL50'RECORDS RETRIEVED VIA READSEQ           '           05205000
         ORG   ERRLINE+73                                               05206000
         ORG   ERRLINE+73                                               05207000
         DC    CL1'1'                                                   05208000
         DC    X'09'                                                    05209000
         DC    CL10'DEBUG16   '                                         05210000
         DC    CL9'         '                                           05211000
         DC    CL2'  '                                                  05212000
         DC    CL50'RECORDS PASSED DATE, TIME FILTERING     '           05213000
         ORG   ERRLINE+146                                              05214000
         ORG   ERRLINE+146                                              05215000
         DC    CL1'1'                                                   05216000
         DC    X'09'                                                    05217000
         DC    CL10'DEBUG16   '                                         05218000
         DC    CL9'         '                                           05219000
         DC    CL2'  '                                                  05220000
         DC    CL50'RECORDS PASSED ALL FILTERING            '           05221000
         ORG   ERRLINE+219                                              05222000
         ORG   ERRLINE+219                                              05223000
         DC    CL1'1'                                                   05224000
         DC    X'09'                                                    05225000
         DC    CL10'DEBUG16   '                                         05226000
         DC    CL9'         '                                           05227000
         DC    CL2'  '                                                  05228000
         DC    CL50'MDR TYPE 91 DEVICE TYPE 3705 RECS FOUND '           05229000
         ORG   ERRLINE+292                                              05230000
         ORG   ERRLINE+292                                              05231000
         DC    CL1'1'                                                   05232000
         DC    X'09'                                                    05233000
         DC    CL10'DEBUG16   '                                         05234000
         DC    CL9'         '                                           05235000
         DC    CL2'  '                                                  05236000
         DC    CL50'MDR TYPE 91, DV3705 RECS SAVED IN TREND2'           05237000
         ORG   ERRLINE+365                                              05238000
         ORG   ERRLINE+365                                              05239000
         DC    CL1'1'                                                   05240000
         DC    X'09'                                                    05241000
         DC    CL10'DEBUG16   '                                         05242000
         DC    CL9'         '                                           05243000
         DC    CL2'  '                                                  05244000
         DC    CL50'OBR RECORDS IDENTIFIED                  '           05245000
         ORG   ERRLINE+438                                              05246000
         ORG   ERRLINE+438                                              05247000
         DC    CL1'1'                                                   05248000
         DC    X'09'                                                    05249000
         DC    CL10'DEBUG16   '                                         05250000
         DC    CL9'         '                                           05251000
         DC    CL2'  '                                                  05252000
         DC    CL50'OBR RECORDS PASSED FILTERING            '           05253000
         ORG   ERRLINE+511                                              05254000
         ORG   ERRLINE+511                                              05255000
         DC    CL1'1'                                                   05256000
         DC    X'09'                                                    05257000
         DC    CL10'DEBUG16   '                                         05258000
         DC    CL9'         '                                           05259000
         DC    CL2'  '                                                  05260000
         DC    CL50'OBR RECORDS STORED IN TREND2            '           05261000
         ORG   ERRLINE+584                                              05262000
         ORG   ERRLINE+584                                              05263000
         DC    CL1'1'                                                   05264000
         DC    X'09'                                                    05265000
         DC    CL10'DEBUG16   '                                         05266000
         DC    CL9'         '                                           05267000
         DC    CL2'  '                                                  05268000
         DC    CL50'GROUP 1 RECORDS IDENTIFIED              '           05269000
         ORG   ERRLINE+657                                              05270000
         ORG   ERRLINE+657                                              05271000
         DC    CL1'1'                                                   05272000
         DC    X'09'                                                    05273000
         DC    CL10'DEBUG16   '                                         05274000
         DC    CL9'         '                                           05275000
         DC    CL2'  '                                                  05276000
         DC    CL50'GROUP 2 RECORDS IDENTIFIED              '           05277000
         ORG   ERRLINE+730                                              05278000
         ORG   ERRLINE+730                                              05279000
         DC    CL1'1'                                                   05280000
         DC    X'09'                                                    05281000
         DC    CL10'DEBUG16   '                                         05282000
         DC    CL9'         '                                           05283000
         DC    CL2'  '                                                  05284000
         DC    CL50'GROUP 3 RECORDS IDENTIFIED              '           05285000
         ORG   ERRLINE+803                                              05286000
         ORG   ERRLINE+803                                              05287000
         DC    CL1'1'                                                   05288000
         DC    X'09'                                                    05289000
         DC    CL10'DEBUG16   '                                         05290000
         DC    CL9'         '                                           05291000
         DC    CL2'  '                                                  05292000
         DC    CL50'GROUP 4 RECORDS IDENTIFIED              '           05293000
         ORG   ERRLINE+876                                              05294000
         ORG   ERRLINE+876                                              05295000
         DC    CL1'1'                                                   05296000
         DC    X'09'                                                    05297000
         DC    CL10'DEBUG16   '                                         05298000
         DC    CL9'         '                                           05299000
         DC    CL2'  '                                                  05300000
         DC    CL50'GROUP 5 RECORDS IDENTIFIED              '           05301000
         ORG   ERRLINE+949                                              05302000
         ORG   ERRLINE+949                                              05303000
         DC    CL1'1'                                                   05304000
         DC    X'09'                                                    05305000
         DC    CL10'DEBUG16   '                                         05306000
         DC    CL9'         '                                           05307000
         DC    CL2'  '                                                  05308000
         DC    CL50'GROUP 6 RECORDS IDENTIFIED              '           05309000
         ORG   ERRLINE+1022                                             05310000
         ORG   ERRLINE+1022                                             05311000
         DC    CL1'1'                                                   05312000
         DC    X'09'                                                    05313000
         DC    CL10'DEBUG16   '                                         05314000
         DC    CL9'         '                                           05315000
         DC    CL2'  '                                                  05316000
         DC    CL50'RECORDS IDENTIFIED FOR CPU FFFFFF       '           05317000
         ORG   ERRLINE+1095                                             05318000
         ORG   ERRLINE+1095                                             05319000
         DC    CL1'1'                                                   05320000
         DC    X'09'                                                    05321000
         DC    CL10'DEBUG16   '                                         05322000
         DC    CL9'         '                                           05323000
         DC    CL2'  '                                                  05324000
         DC    CL50'MCH RECORDS IDENTIFIED                  '           05325000
         ORG   ERRLINE+1168                                             05326000
         ORG   ERRLINE+1168                                             05327000
         DC    CL1'1'                                                   05328000
         DC    X'09'                                                    05329000
         DC    CL10'DEBUG16   '                                         05330000
         DC    CL9'         '                                           05331000
         DC    CL2'  '                                                  05332000
         DC    CL50'MCH RECORDS PASSED FILTERING            '           05333000
         ORG   ERRLINE+1241                                             05334000
         ORG   ERRLINE+1241                                             05335000
         DC    CL1'1'                                                   05336000
         DC    X'09'                                                    05337000
         DC    CL10'DEBUG16   '                                         05338000
         DC    CL9'         '                                           05339000
         DC    CL2'  '                                                  05340000
         DC    CL50'CCH RECORDS IDENTIFIED                  '           05341000
         ORG   ERRLINE+1314                                             05342000
         ORG   ERRLINE+1314                                             05343000
         DC    CL1'1'                                                   05344000
         DC    X'09'                                                    05345000
         DC    CL10'DEBUG16   '                                         05346000
         DC    CL9'         '                                           05347000
         DC    CL2'  '                                                  05348000
         DC    CL50'CCH RECORDS PASSED FILTERING            '           05349000
         ORG   ERRLINE+1387                                             05350000
         ORG   ERRLINE+1387                                             05351000
         DC    CL1'1'                                                   05352000
         DC    X'09'                                                    05353000
         DC    CL10'DEBUG16   '                                         05354000
         DC    CL9'         '                                           05355000
         DC    CL2'  '                                                  05356000
         DC    CL50'SOFTWARE RECORDS IDENTIFIED             '           05357000
         ORG   ERRLINE+1460                                             05358000
         ORG   ERRLINE+1460                                             05359000
         DC    CL1'1'                                                   05360000
         DC    X'09'                                                    05361000
         DC    CL10'DEBUG16   '                                         05362000
         DC    CL9'         '                                           05363000
         DC    CL2'  '                                                  05364000
         DC    CL50'SOFTWARE RECORDS PASSED FILTERING       '           05365000
         ORG   ERRLINE+1533                                             05366000
         ORG   ERRLINE+1533                                             05367000
         DC    CL1'1'                                                   05368000
         DC    X'09'                                                    05369000
         DC    CL10'DEBUG16   '                                         05370000
         DC    CL9'         '                                           05371000
         DC    CL2'  '                                                  05372000
         DC    CL50'IPL RECORDS IDENTIFIED                  '           05373000
         ORG   ERRLINE+1606                                             05374000
         ORG   ERRLINE+1606                                             05375000
         DC    CL1'1'                                                   05376000
         DC    X'09'                                                    05377000
         DC    CL10'DEBUG16   '                                         05378000
         DC    CL9'         '                                           05379000
         DC    CL2'  '                                                  05380000
         DC    CL50'IPL RECORDS PASSED FILTERING            '           05381000
         ORG   ERRLINE+1679                                             05382000
         ORG   ERRLINE+1679                                             05383000
         DC    CL1'1'                                                   05384000
         DC    X'09'                                                    05385000
         DC    CL10'DEBUG16   '                                         05386000
         DC    CL9'         '                                           05387000
         DC    CL2'  '                                                  05388000
         DC    CL50'DDR RECORDS IDENTIFIED                  '           05389000
         ORG   ERRLINE+1752                                             05390000
         ORG   ERRLINE+1752                                             05391000
         DC    CL1'1'                                                   05392000
         DC    X'09'                                                    05393000
         DC    CL10'DEBUG16   '                                         05394000
         DC    CL9'         '                                           05395000
         DC    CL2'  '                                                  05396000
         DC    CL50'DDR RECORDS PASSED FILTERING            '           05397000
         ORG   ERRLINE+1825                                             05398000
         ORG   ERRLINE+1825                                             05399000
         DC    CL1'1'                                                   05400000
         DC    X'09'                                                    05401000
         DC    CL10'DEBUG16   '                                         05402000
         DC    CL9'         '                                           05403000
         DC    CL2'  '                                                  05404000
         DC    CL50'MIH RECORDS IDENTIFIED                  '           05405000
         ORG   ERRLINE+1898                                             05406000
         ORG   ERRLINE+1898                                             05407000
         DC    CL1'1'                                                   05408000
         DC    X'09'                                                    05409000
         DC    CL10'DEBUG16   '                                         05410000
         DC    CL9'         '                                           05411000
         DC    CL2'  '                                                  05412000
         DC    CL50'MIH RECORDS PASSED FILTERING            '           05413000
         ORG   ERRLINE+1971                                             05414000
         ORG   ERRLINE+1971                                             05415000
         DC    CL1'1'                                                   05416000
         DC    X'09'                                                    05417000
         DC    CL10'DEBUG16   '                                         05418000
         DC    CL9'         '                                           05419000
         DC    CL2'  '                                                  05420000
         DC    CL50'EOD RECORDS IDENTIFIED                  '           05421000
         ORG   ERRLINE+2044                                             05422000
         ORG   ERRLINE+2044                                             05423000
         DC    CL1'1'                                                   05424000
         DC    X'09'                                                    05425000
         DC    CL10'DEBUG16   '                                         05426000
         DC    CL9'         '                                           05427000
         DC    CL2'  '                                                  05428000
         DC    CL50'EOD RECORDS PASSED FILTERING            '           05429000
         ORG   ERRLINE+2117                                             05430000
         ORG   ERRLINE+2117                                             05431000
         DC    CL1'1'                                                   05432000
         DC    X'09'                                                    05433000
         DC    CL10'DEBUG16   '                                         05434000
         DC    CL9'         '                                           05435000
         DC    CL2'  '                                                  05436000
         DC    CL50'RECORDS SAVED FROM CPU FFFFFF MODEL FFFF'           05437000
         ORG   ERRLINE+2190                                             05438000
         ORG   ERRLINE+2190                                             05439000
         DC    CL1'1'                                                   05440000
         DC    X'09'                                                    05441000
         DC    CL10'DEBUG16   '                                         05442000
         DC    CL9'         '                                           05443000
         DC    CL2'  '                                                  05444000
         DC    CL50'MDRS NOT TYPE 91 NOT DEVICE TYPE 3705   '           05445000
         ORG   ERRLINE+2263                                             05446000
         ORG   ERRLINE+2263                                             05447000
         DC    CL1'1'                                                   05448000
         DC    X'09'                                                    05449000
         DC    CL10'DEBUG16   '                                         05450000
         DC    CL9'         '                                           05451000
         DC    CL2'  '                                                  05452000
         DC    CL50'RECORDS FAILED DEVICE SELECTION         '           05453000
         ORG   ERRLINE+2336                                             05454000
         ORG   ERRLINE+2336                                             05455000
         DC    CL1'1'                                                   05456000
         DC    X'09'                                                    05457000
         DC    CL10'DEBUG16   '                                         05458000
         DC    CL9'         '                                           05459000
         DC    CL2'  '                                                  05460000
         DC    CL50'RECORDS FAILED CUA SELECTION            '           05461000
         ORG   ERRLINE+2409                                             05462000
         ORG   ERRLINE+2409                                             05463000
         DC    CL1'1'                                                   05464000
         DC    X'09'                                                    05465000
         DC    CL10'DEBUG16   '                                         05466000
         DC    CL9'         '                                           05467000
         DC    CL2'  '                                                  05468000
         DC    CL50'MDR 33XX RECORDS IDENTIFIED             '           05469000
         ORG   ERRLINE+2482                                             05470000
         ORG   ERRLINE+2482                                             05471000
         DC    CL1'1'                                                   05472000
         DC    X'09'                                                    05473000
         DC    CL10'DEBUG16   '                                         05474000
         DC    CL9'         '                                           05475000
         DC    CL2'  '                                                  05476000
         DC    CL50'MDR 33XX RECORDS SAVED                  '           05477000
         ORG   ERRLINE+2555                                             05478000
         ORG   ERRLINE+2555                                             05479000
         DC    CL1'1'                                                   05480000
         DC    X'09'                                                    05481000
         DC    CL10'DEBUG16   '                                         05482000
         DC    CL9'         '                                           05483000
         DC    CL2'  '                                                  05484000
         DC    CL50'OBR 33XX, 2305 RECORDS IDENTIFIED       '           05485000
         ORG   ERRLINE+2628                                             05486000
         ORG   ERRLINE+2628                                             05487000
         DC    CL1'1'                                                   05488000
         DC    X'09'                                                    05489000
         DC    CL10'DEBUG16   '                                         05490000
         DC    CL9'         '                                           05491000
         DC    CL2'  '                                                  05492000
         DC    CL50'OBR 33XX, 2305 RECORDS SAVED            '           05493000
         ORG   ERRLINE+2701                                             05494000
         ORG   ERRLINE+2701                                             05495000
         DC    CL1'1'                                                   05496000
         DC    X'09'                                                    05497000
         DC    CL10'DEBUG16   '                                         05498000
         DC    CL9'         '                                           05499000
         DC    CL2'  '                                                  05500000
         DC    CL50'OBR 34XX RECORDS IDENTIFIED             '           05501000
         ORG   ERRLINE+2774                                             05502000
         ORG   ERRLINE+2774                                             05503000
         DC    CL1'1'                                                   05504000
         DC    X'09'                                                    05505000
         DC    CL10'DEBUG16   '                                         05506000
         DC    CL9'         '                                           05507000
         DC    CL2'  '                                                  05508000
         DC    CL50'OBR 34XX RECORDS SAVED                  '           05509000
         ORG   ERRLINE+2847                                             05510000
         ORG   ERRLINE+2847                                             05511000
         DC    CL1'1'                                                   05512000
         DC    X'09'                                                    05513000
         DC    CL10'DEBUG16   '                                         05514000
         DC    CL9'         '                                           05515000
         DC    CL2'  '                                                  05516000
         DC    CL50'FRAMES USED IN PROCESSING               '           05517000
         ORG   ERRLINE+2920                                             05518000
         ORG   ERRLINE+2920                                             05519000
         DC    CL1'1'                                                   05520000
         DC    X'09'                                                    05521000
         DC    CL10'DEBUG16   '                                         05522000
         DC    CL9'         '                                           05523000
         DC    CL2'  '                                                  05524000
         DC    CL50'FRAMES NOT USED IN PROCESSING           '           05525000
         ORG   ERRLINE+2993                                             05526000
         ORG   ERRLINE+2993                                             05527000
         DC    CL1'1'                                                   05528000
         DC    X'09'                                                    05529000
         DC    CL10'DEBUG16   '                                         05530000
         DC    CL9'         '                                           05531000
         DC    CL2'  '                                                  05532000
         DC    CL50'****IFCFILT3 DEBUG16 RECORD COUNTS******'           05533000
         ORG   ERRLINE+3066                                             05534000
         ORG   ERRLINE+3066                                             05535000
         DC    CL1'1'                                                   05536000
         DC    X'09'                                                    05537000
         DC    CL10'DEBUG16   '                                         05538000
         DC    CL9'         '                                           05539000
         DC    CL2'  '                                                  05540000
         ORG   ERRLINE+3139                                             05541000
         ORG   ERRLINE+3139                                             05542000
         DC    CL1'1'                                                   05543000
         DC    X'09'                                                    05544000
         DC    CL10'DEBUG16   '                                         05545000
         DC    CL9'         '                                           05546000
         DC    CL2'  '                                                  05547000
         ORG   ERRLINE+3212                                             05548000
         ORG   ERRLINE+3212                                             05549000
         DC    CL1'1'                                                   05550000
         DC    X'09'                                                    05551000
         DC    CL10'DEBUG16   '                                         05552000
         DC    CL9'         '                                           05553000
         DC    CL2'  '                                                  05554000
         ORG   ERRLINE+3285                                             05555000
         ORG   ERRLINE+3285                                             05556000
         DC    CL1'1'                                                   05557000
         DC    X'09'                                                    05558000
         DC    CL10'DEBUG16   '                                         05559000
         DC    CL9'         '                                           05560000
         DC    CL2'  '                                                  05561000
         ORG   ERRLINE+3358                                             05562000
         ORG   ERRLINE+3358                                             05563000
         DC    CL1'1'                                                   05564000
         DC    X'09'                                                    05565000
         DC    CL10'DEBUG16   '                                         05566000
         DC    CL9'         '                                           05567000
         DC    CL2'  '                                                  05568000
         ORG   ERRLINE+3431                                             05569000
         ORG   ERRLINE+3431                                             05570000
         DC    CL1'1'                                                   05571000
         DC    X'09'                                                    05572000
         DC    CL10'DEBUG16   '                                         05573000
         DC    CL9'         '                                           05574000
         DC    CL2'  '                                                  05575000
         ORG   ERRLINE+3504                                             05576000
         ORG   ERRLINE+3504                                             05577000
         DC    CL1'1'                                                   05578000
         DC    X'09'                                                    05579000
         DC    CL10'DEBUG16   '                                         05580000
         DC    CL9'         '                                           05581000
         DC    CL2'  '                                                  05582000
         ORG   ERRLINE+3577                                             05583000
         ORG   ERRLINE+3577                                             05584000
         DC    CL1'1'                                                   05585000
         DC    X'09'                                                    05586000
         DC    CL10'DEBUG16   '                                         05587000
         DC    CL9'         '                                           05588000
         DC    CL2'  '                                                  05589000
         ORG   ERRLINE+3650                                             05590000
IFCFILT3 CSECT                                                          05591000
         DC    S(SUPERZAP)                                              05592000
IFCFILT3 CSECT                                                          05593000
         DC    S(PATCH)     BASE DISPLACEMENT OF PATCH AREA             05594000
IFCFILT3 CSECT                                                          05595000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       05596000
@01      EQU   01                                                       05597000
@02      EQU   02                                                       05598000
@03      EQU   03                                                       05599000
@04      EQU   04                                                       05600000
@05      EQU   05                                                       05601000
@06      EQU   06                                                       05602000
@07      EQU   07                                                       05603000
@08      EQU   08                                                       05604000
@09      EQU   09                                                       05605000
@10      EQU   10                                                       05606000
@11      EQU   11                                                       05607000
@12      EQU   12                                                       05608000
@13      EQU   13                                                       05609000
@14      EQU   14                                                       05610000
@15      EQU   15                                                       05611000
R2       EQU   @02                                                      05612000
R7       EQU   @07                                                      05613000
R0       EQU   @00                                                      05614000
R1       EQU   @01                                                      05615000
R3       EQU   @03                                                      05616000
R4       EQU   @04                                                      05617000
R5       EQU   @05                                                      05618000
R12      EQU   @12                                                      05619000
R15      EQU   @15                                                      05620000
R10      EQU   @10                                                      05621000
R11      EQU   @11                                                      05622000
R13      EQU   @13                                                      05623000
R14      EQU   @14                                                      05624000
R6       EQU   @06                                                      05625000
R8       EQU   @08                                                      05626000
R9       EQU   @09                                                      05627000
IOHND    EQU   0                                                        05628000
IFCMSG   EQU   0                                                        05629000
PARM     EQU   0                                                        05630000
RECTYPE  EQU   PARM                                                     05631000
PMCH     EQU   RECTYPE                                                  05632000
PCHAN    EQU   RECTYPE                                                  05633000
POBR     EQU   RECTYPE                                                  05634000
PSOFT    EQU   RECTYPE                                                  05635000
PIPL     EQU   RECTYPE                                                  05636000
PDDR     EQU   RECTYPE                                                  05637000
PMIH     EQU   RECTYPE                                                  05638000
PEOD     EQU   RECTYPE                                                  05639000
PTTYP    EQU   RECTYPE+1                                                05640000
SWITCHES EQU   PARM+2                                                   05641000
ZEROALL  EQU   SWITCHES+1                                               05642000
DEVEXCL  EQU   SWITCHES+1                                               05643000
SHIFT3RD EQU   SWITCHES+1                                               05644000
DEBUG    EQU   PARM+4                                                   05645000
DEBUG4   EQU   DEBUG                                                    05646000
DEBUG11  EQU   DEBUG+1                                                  05647000
DEBUG16  EQU   DEBUG+2                                                  05648000
DEBUG23  EQU   DEBUG+2                                                  05649000
DEBUGA   EQU   PARM+8                                                   05650000
DEBUG50  EQU   DEBUGA+2                                                 05651000
MISC     EQU   PARM+12                                                  05652000
PACC     EQU   MISC                                                     05653000
PHIST    EQU   MISC                                                     05654000
PRINTES  EQU   MISC                                                     05655000
PASSFLAG EQU   MISC                                                     05656000
OPENCLSE EQU   PARM+13                                                  05657000
OPENIO   EQU   OPENCLSE                                                 05658000
CLOSEIO  EQU   OPENCLSE+2                                               05659000
CACCIN   EQU   CLOSEIO                                                  05660000
CACCDEV  EQU   CLOSEIO                                                  05661000
CDRCTWRK EQU   CLOSEIO                                                  05662000
DATENOW  EQU   PARM+17                                                  05663000
STDT     EQU   PARM+23                                                  05664000
STDATE   EQU   STDT                                                     05665000
PSTD     EQU   STDATE+1                                                 05666000
PSTYR    EQU   PSTD                                                     05667000
PSTDY    EQU   PSTD+1                                                   05668000
ENDDT    EQU   PARM+31                                                  05669000
ENDDATE  EQU   ENDDT                                                    05670000
PEND     EQU   ENDDATE+1                                                05671000
PENDY    EQU   PEND+1                                                   05672000
STTIME1  EQU   PARM+39                                                  05673000
ENDTIME1 EQU   PARM+43                                                  05674000
STTIME2  EQU   PARM+47                                                  05675000
ENDTIME2 EQU   PARM+51                                                  05676000
STRTDATE EQU   PARM+55                                                  05677000
@NM00006 EQU   PARM+72                                                  05678000
@NM00007 EQU   PARM+75                                                  05679000
TABSIZE  EQU   PARM+80                                                  05680000
SORTNUM  EQU   PARM+84                                                  05681000
NUMDAYS  EQU   PARM+88                                                  05682000
ERRID    EQU   PARM+92                                                  05683000
IDTIMEA  EQU   ERRID+6                                                  05684000
IDTIME   EQU   IDTIMEA                                                  05685000
CCHHRLNG EQU   PARM+112                                                 05686000
RECCCHHR EQU   CCHHRLNG                                                 05687000
ADIOHND  EQU   PARM+124                                                 05688000
ADIFCMSG EQU   PARM+128                                                 05689000
ADEDITB  EQU   PARM+132                                                 05690000
EVPTR    EQU   PARM+136                                                 05691000
SORTADR  EQU   PARM+140                                                 05692000
PRINTADR EQU   PARM+148                                                 05693000
CUAPTR   EQU   PARM+152                                                 05694000
DEVPTR   EQU   PARM+156                                                 05695000
MODPTR   EQU   PARM+160                                                 05696000
SERPTR   EQU   PARM+164                                                 05697000
VOLPTR   EQU   PARM+168                                                 05698000
CPUPTR   EQU   PARM+172                                                 05699000
CPCUAPTR EQU   PARM+176                                                 05700000
LIBADPTR EQU   PARM+180                                                 05701000
SYMCDPTR EQU   PARM+184                                                 05702000
SYSUMPTR EQU   PARM+188                                                 05703000
TRENPTR  EQU   PARM+192                                                 05704000
SHAREPTR EQU   PARM+196                                                 05705000
FRAMEPTR EQU   PARM+200                                                 05706000
MERDCPTR EQU   PARM+208                                                 05707000
DUMPTABL EQU   PARM+228                                                 05708000
DUMPINFO EQU   DUMPTABL+4                                               05709000
TRENDONE EQU   0                                                        05710000
TRENEXT  EQU   TRENDONE                                                 05711000
TRENUM   EQU   TRENDONE+4                                               05712000
TREGEN   EQU   TRENDONE+8                                               05713000
TREIPL   EQU   TREGEN                                                   05714000
TREMCH   EQU   TREGEN+4                                                 05715000
TRECCH0  EQU   TREGEN+8                                                 05716000
TRECCH1  EQU   TREGEN+12                                                05717000
TRECCH2  EQU   TREGEN+16                                                05718000
TRECCH3  EQU   TREGEN+20                                                05719000
TRECCH4  EQU   TREGEN+24                                                05720000
TRECCH5  EQU   TREGEN+28                                                05721000
TRECCH6  EQU   TREGEN+32                                                05722000
TRECCH7  EQU   TREGEN+36                                                05723000
TRECCH8  EQU   TREGEN+40                                                05724000
TRECCH9  EQU   TREGEN+44                                                05725000
TRECCHA  EQU   TREGEN+48                                                05726000
TRECCHB  EQU   TREGEN+52                                                05727000
TRECCHC  EQU   TREGEN+56                                                05728000
TRECCHD  EQU   TREGEN+60                                                05729000
TRECCHE  EQU   TREGEN+64                                                05730000
TRECCHF  EQU   TREGEN+68                                                05731000
TREPRE   EQU   TREGEN+72                                                05732000
EVTABLE  EQU   0                                                        05733000
EVSTOP   EQU   EVTABLE                                                  05734000
EVNUM    EQU   EVTABLE+4                                                05735000
EVKEY    EQU   EVTABLE+6                                                05736000
EVMODEL  EQU   EVKEY                                                    05737000
EVSERIAL EQU   EVKEY+2                                                  05738000
EVLETTER EQU   EVKEY+5                                                  05739000
SORTABLE EQU   0                                                        05740000
SORTKEY  EQU   SORTABLE                                                 05741000
SORTCCHR EQU   SORTABLE+5                                               05742000
SYSUMONE EQU   0                                                        05743000
SHARE    EQU   0                                                        05744000
SHARENUM EQU   SHARE                                                    05745000
SHAREIO  EQU   SHARE+2                                                  05746000
SHAREFLG EQU   SHAREIO                                                  05747000
SHRBASE  EQU   SHAREIO+1                                                05748000
SHARSERB EQU   SHRBASE                                                  05749000
SHRCUABL EQU   SHRBASE+3                                                05750000
SHRCUCPU EQU   SHAREIO+8                                                05751000
SHARSERA EQU   SHRCUCPU                                                 05752000
SHRCUAAL EQU   SHRCUCPU+3                                               05753000
SHRCUAAH EQU   SHRCUCPU+5                                               05754000
SHARLET  EQU   SHAREIO+15                                               05755000
EDITLOAD EQU   0                                                        05756000
EDITABLE EQU   EDITLOAD+4                                               05757000
CUA      EQU   0                                                        05758000
CUANUM   EQU   CUA                                                      05759000
CUAVAL   EQU   CUA+2                                                    05760000
CUA1     EQU   CUAVAL                                                   05761000
CUA2     EQU   CUAVAL+2                                                 05762000
DEVICE   EQU   0                                                        05763000
DEVNUM   EQU   DEVICE                                                   05764000
DEVVAL   EQU   DEVICE+2                                                 05765000
MDRNUM   EQU   DEVICE+202                                               05766000
MDRVAL   EQU   DEVICE+204                                               05767000
MODELS   EQU   0                                                        05768000
DEVSERAL EQU   0                                                        05769000
VOLUME   EQU   0                                                        05770000
CPUS     EQU   0                                                        05771000
CPUCUAS  EQU   0                                                        05772000
CPUCUAV  EQU   CPUCUAS+2                                                05773000
LIBADR   EQU   0                                                        05774000
SYMCODE  EQU   0                                                        05775000
SYMVAL   EQU   SYMCODE+2                                                05776000
TMT2     EQU   0                                                        05777000
TMTKEY   EQU   TMT2                                                     05778000
TMTSRT   EQU   TMTKEY+1                                                 05779000
TMTCPUS  EQU   TMTKEY+3                                                 05780000
TMTITEM  EQU   TMTKEY+4                                                 05781000
TMTPERM1 EQU   TMT2+8                                                   05782000
TMP2     EQU   0                                                        05783000
TMPKEY   EQU   TMP2                                                     05784000
TMPSRT   EQU   TMPKEY+1                                                 05785000
TMPCPUS  EQU   TMPKEY+3                                                 05786000
TMPITEM  EQU   TMPKEY+4                                                 05787000
TMPPERM1 EQU   TMP2+8                                                   05788000
MERIDIAN EQU   0                                                        05789000
MRDNUMBR EQU   MERIDIAN                                                 05790000
MODEL    EQU   MERIDIAN+2                                               05791000
LRTREC   EQU   0                                                        05792000
LRTKEY   EQU   LRTREC                                                   05793000
LRTKEY1  EQU   LRTKEY                                                   05794000
LRTSMS   EQU   LRTREC+2                                                 05795000
LRTNLAST EQU   LRTSMS                                                   05796000
LRTRUNC  EQU   LRTSMS                                                   05797000
LRTERRID EQU   LRTREC+3                                                 05798000
@NM00017 EQU   LRTREC+4                                                 05799000
LRTCNT   EQU   @NM00017+2                                               05800000
LRTDT    EQU   LRTREC+8                                                 05801000
LRTDATE  EQU   LRTDT                                                    05802000
LRTYRDAY EQU   LRTDATE+1                                                05803000
LRTDAY   EQU   LRTYRDAY+1                                               05804000
LRTTIME  EQU   LRTDT+4                                                  05805000
LRTCPU   EQU   LRTREC+16                                                05806000
LRTCPMOD EQU   LRTCPU+1                                                 05807000
LRTCPUS  EQU   LRTCPMOD                                                 05808000
LRTMODEL EQU   LRTCPMOD+3                                               05809000
MCHREC   EQU   0                                                        05810000
MCHHEAD  EQU   MCHREC                                                   05811000
MCHKEY   EQU   MCHHEAD                                                  05812000
MCHSMS   EQU   MCHHEAD+2                                                05813000
MCHCPUID EQU   MCHHEAD+16                                               05814000
CCHREC   EQU   0                                                        05815000
CCHHEAD  EQU   CCHREC                                                   05816000
CCHKEY   EQU   CCHHEAD                                                  05817000
CCHSMS   EQU   CCHHEAD+2                                                05818000
CCHCPUID EQU   CCHHEAD+16                                               05819000
CCHCODE  EQU   CCHREC+68                                                05820000
CCHCODE2 EQU   CCHCODE+2                                                05821000
CCHCUA   EQU   CCHREC+74                                                05822000
OBRREC   EQU   0                                                        05823000
OBRHEAD  EQU   OBRREC                                                   05824000
OBRKEY   EQU   OBRHEAD                                                  05825000
OBRSMS   EQU   OBRHEAD+2                                                05826000
MISCSW   EQU   OBRSMS                                                   05827000
OBRSUBTP EQU   OBRSMS+1                                                 05828000
SDRCOUNT EQU   OBRSUBTP                                                 05829000
OBRTEMP  EQU   OBRSUBTP                                                 05830000
SHORTSW  EQU   OBRSUBTP                                                 05831000
DISMOUNT EQU   OBRSUBTP                                                 05832000
OBRCPUID EQU   OBRHEAD+16                                               05833000
OBRJOBID EQU   OBRREC+24                                                05834000
OBRSDEV2 EQU   OBRJOBID+2                                               05835000
OBRSSDRC EQU   OBRJOBID+4                                               05836000
OBRSCUA  EQU   OBRJOBID+5                                               05837000
OBRFCCW  EQU   OBRREC+32                                                05838000
OBRSRDS  EQU   OBRFCCW                                                  05839000
OBRCSW   EQU   OBRREC+40                                                05840000
OBRDEVDC EQU   OBRREC+48                                                05841000
OBRCODE  EQU   OBRREC+52                                                05842000
OBRDEV   EQU   OBRCODE+2                                                05843000
OBRCLASS EQU   OBRDEV                                                   05844000
OBRLSDRC EQU   OBRREC+56                                                05845000
OBRPCUA  EQU   OBRREC+57                                                05846000
OBRSEEK  EQU   OBRREC+70                                                05847000
OBRTERMN EQU   OBRSEEK+2                                                05848000
OBR34CT1 EQU   OBRTERMN+4                                               05849000
OBR34CT2 EQU   OBRTERMN+5                                               05850000
SFTREC   EQU   0                                                        05851000
SFTHEAD  EQU   SFTREC                                                   05852000
SFTKEY   EQU   SFTHEAD                                                  05853000
SFTCPUID EQU   SFTHEAD+16                                               05854000
SFTSDWA  EQU   SFTREC+32                                                05855000
SFTAEC1  EQU   SFTSDWA+96                                               05856000
SFTFLGS  EQU   SFTSDWA+232                                              05857000
SFTRECP  EQU   SFTSDWA+292                                              05858000
IPLREC   EQU   0                                                        05859000
IPLHEAD  EQU   IPLREC                                                   05860000
IPLKEY   EQU   IPLHEAD                                                  05861000
IPLCPUID EQU   IPLHEAD+16                                               05862000
IPLSTIME EQU   IPLREC+52                                                05863000
DDRREC   EQU   0                                                        05864000
DDRHEAD  EQU   DDRREC                                                   05865000
DDRKEY   EQU   DDRHEAD                                                  05866000
DDRSMS   EQU   DDRHEAD+2                                                05867000
DDRCPUID EQU   DDRHEAD+16                                               05868000
@NM00052 EQU   DDRREC+24                                                05869000
DDRFCUA  EQU   DDRREC+45                                                05870000
DDRFDEV  EQU   DDRREC+48                                                05871000
DDRCODE2 EQU   DDRFDEV+2                                                05872000
DDRTODEV EQU   DDRREC+56                                                05873000
MIHREC   EQU   0                                                        05874000
MIHHEAD  EQU   MIHREC                                                   05875000
MIHKEY   EQU   MIHHEAD                                                  05876000
@NM00054 EQU   MIHHEAD+4                                                05877000
MIHCPUID EQU   MIHHEAD+16                                               05878000
@NM00057 EQU   MIHREC+24                                                05879000
MIHCUA   EQU   MIHREC+35                                                05880000
MIHDEV   EQU   MIHREC+44                                                05881000
MIHCODE2 EQU   MIHDEV+2                                                 05882000
EODREC   EQU   0                                                        05883000
EODHEAD  EQU   EODREC                                                   05884000
EODKEY   EQU   EODHEAD                                                  05885000
EODCPUID EQU   EODHEAD+16                                               05886000
TPRREC   EQU   0                                                        05887000
TPRHEAD  EQU   TPRREC                                                   05888000
TPRKEY   EQU   TPRHEAD                                                  05889000
TPRDEV   EQU   TPRHEAD+4                                                05890000
TPRBUFC  EQU   TPRHEAD+5                                                05891000
TPRCPUID EQU   TPRHEAD+16                                               05892000
TPRCUA   EQU   TPRREC+24                                                05893000
@NM00065 EQU   TPRREC+26                                                05894000
TPRVOL   EQU   @NM00065                                                 05895000
TPRMODE  EQU   TPRREC+38                                                05896000
DVBSDRE  EQU   TPRREC+56                                                05897000
RMSSCBRY EQU   TPRREC+58                                                05898000
MCFREC   EQU   0                                                        05899000
MCFHEAD  EQU   MCFREC                                                   05900000
MCFKEY   EQU   MCFHEAD                                                  05901000
MCFSMS   EQU   MCFHEAD+2                                                05902000
@NM00073 EQU   MCFHEAD+16                                               05903000
MCFSMO   EQU   MCFHEAD+17                                               05904000
CCFREC   EQU   0                                                        05905000
CCFHEAD  EQU   CCFREC                                                   05906000
CCFKEY   EQU   CCFHEAD                                                  05907000
CCFSMS   EQU   CCFHEAD+2                                                05908000
@NM00081 EQU   CCFHEAD+16                                               05909000
CCFSMO   EQU   CCFHEAD+17                                               05910000
OBRLSDR  EQU   0                                                        05911000
OBRSENSE EQU   0                                                        05912000
OBRSENS0 EQU   OBRSENSE                                                 05913000
OBRSENS1 EQU   OBRSENSE+1                                               05914000
TPRTEMP  EQU   0                                                        05915000
TPRTMPR  EQU   TPRTEMP                                                  05916000
TPRTMPW  EQU   TPRTEMP+1                                                05917000
@NM00096 EQU   0                                                        05918000
BYTE1112 EQU   @NM00096                                                 05919000
BYTE13   EQU   @NM00096+2                                               05920000
BYTE18   EQU   @NM00096+7                                               05921000
BYTE21   EQU   @NM00096+10                                              05922000
TPRSENSE EQU   0                                                        05923000
TPRS1213 EQU   TPRSENSE                                                 05924000
TPRS1415 EQU   TPRSENSE+2                                               05925000
TPRS19   EQU   TPRSENSE+7                                               05926000
FRAMETAB EQU   0                                                        05927000
FRAMENUM EQU   FRAMETAB                                                 05928000
FRAMEDTA EQU   FRAMETAB+4                                               05929000
FRAMEKEY EQU   FRAMEDTA                                                 05930000
FRAMECPU EQU   FRAMEKEY                                                 05931000
FRAMESER EQU   FRAMECPU                                                 05932000
FRAMEMOD EQU   FRAMECPU+3                                               05933000
FRAMEDT  EQU   FRAMEKEY+5                                               05934000
FRAMETYP EQU   FRAMEKEY+13                                              05935000
FRAMLOCM EQU   FRAMEDTA+16                                              05936000
FRAMLOCC EQU   FRAMEDTA+20                                              05937000
LISTLOC  EQU   0                                                        05938000
LISTNUM  EQU   LISTLOC                                                  05939000
LISTCCHR EQU   LISTLOC+4                                                05940000
TMTA     EQU   0                                                        05941000
TMTKEYA  EQU   TMTA                                                     05942000
TMTPERMA EQU   TMTA+8                                                   05943000
TMTTEMPA EQU   TMTA+10                                                  05944000
NEXTBYTE EQU   0                                                        05945000
ADDNUM   EQU   0                                                        05946000
FLIPFLOP EQU   FLIP                                                     05947000
YEARC    EQU   YEAR                                                     05948000
EDFLD    EQU   EDIFILD                                                  05949000
ERRCT1   EQU   DVBSDRE                                                  05950000
ERRNUM   EQU   ERRPLACE                                                 05951000
ERR78    EQU   PRINTBDY                                                 05952000
PFRAMMOD EQU   ERR78+27                                                 05953000
PFRAMSER EQU   ERR78+32                                                 05954000
WORKNM   EQU   WORKBYTE                                                 05955000
WORKNM2  EQU   WORKTWO                                                  05956000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    05957000
@NM00092 EQU   ERR78+31                                                 05958000
@NM00091 EQU   ERR78                                                    05959000
FRAMETIM EQU   FRAMEDT+4                                                05960000
FRAMEDAT EQU   FRAMEDT                                                  05961000
@NM00099 EQU   TPRSENSE+4                                               05962000
@NM00098 EQU   @NM00096+8                                               05963000
@NM00097 EQU   @NM00096+3                                               05964000
OBRLSDR2 EQU   OBRLSDR                                                  05965000
OBRLSDR1 EQU   OBRLSDR                                                  05966000
CCFFRAME EQU   CCFREC+24                                                05967000
@NM00083 EQU   CCFHEAD+22                                               05968000
CCFMOD   EQU   CCFSMO+3                                                 05969000
CCFSER   EQU   CCFSMO                                                   05970000
CCFVER   EQU   @NM00081                                                 05971000
@NM00082 EQU   @NM00081                                                 05972000
CCFTIMD  EQU   CCFHEAD+12                                               05973000
CCFDAT   EQU   CCFHEAD+8                                                05974000
@NM00080 EQU   CCFHEAD+7                                                05975000
CCFCNT   EQU   CCFHEAD+6                                                05976000
@NM00079 EQU   CCFHEAD+4                                                05977000
@NM00078 EQU   CCFSMS+1                                                 05978000
CCFCPU   EQU   CCFSMS+1                                                 05979000
CCFMP    EQU   CCFSMS+1                                                 05980000
@NM00077 EQU   CCFSMS                                                   05981000
CCFTIM   EQU   CCFSMS                                                   05982000
@NM00076 EQU   CCFSMS                                                   05983000
CCFTRU   EQU   CCFSMS                                                   05984000
CCFTOD   EQU   CCFSMS                                                   05985000
CCFLST   EQU   CCFSMS                                                   05986000
CCFKEY2  EQU   CCFKEY+1                                                 05987000
CCFKEY1  EQU   CCFKEY                                                   05988000
MCFFRAME EQU   MCFREC+24                                                05989000
@NM00075 EQU   MCFHEAD+22                                               05990000
MCFMOD   EQU   MCFSMO+3                                                 05991000
MCFSER   EQU   MCFSMO                                                   05992000
MCFVER   EQU   @NM00073                                                 05993000
@NM00074 EQU   @NM00073                                                 05994000
MCFTIMD  EQU   MCFHEAD+12                                               05995000
MCFDAT   EQU   MCFHEAD+8                                                05996000
@NM00072 EQU   MCFHEAD+7                                                05997000
MCFCNT   EQU   MCFHEAD+6                                                05998000
@NM00071 EQU   MCFHEAD+4                                                05999000
@NM00070 EQU   MCFSMS+1                                                 06000000
MCFCPU   EQU   MCFSMS+1                                                 06001000
MCFMP    EQU   MCFSMS+1                                                 06002000
@NM00069 EQU   MCFSMS                                                   06003000
MCFTIM   EQU   MCFSMS                                                   06004000
@NM00068 EQU   MCFSMS                                                   06005000
MCFTRU   EQU   MCFSMS                                                   06006000
MCFTOD   EQU   MCFSMS                                                   06007000
MCFLST   EQU   MCFSMS                                                   06008000
MCFKEY2  EQU   MCFKEY+1                                                 06009000
MCFKEY1  EQU   MCFKEY                                                   06010000
@NM00067 EQU   TPRREC+39                                                06011000
TPRLINAD EQU   TPRREC+36                                                06012000
@NM00066 EQU   TPRREC+34                                                06013000
TPRCEL   EQU   TPRCPUID+6                                               06014000
TPRMODEL EQU   TPRCPUID+4                                               06015000
TPRSER   EQU   TPRCPUID+1                                               06016000
@NM00064 EQU   TPRCPUID                                                 06017000
TPRTIME  EQU   TPRHEAD+12                                               06018000
TPRDATE  EQU   TPRHEAD+8                                                06019000
@NM00063 EQU   TPRHEAD+6                                                06020000
TPRLENGT EQU   TPRBUFC                                                  06021000
@NM00062 EQU   TPRBUFC                                                  06022000
TPRSMS   EQU   TPRHEAD+2                                                06023000
TPRKEY2  EQU   TPRKEY+1                                                 06024000
TPRKEY1  EQU   TPRKEY                                                   06025000
EODCEL   EQU   EODCPUID+6                                               06026000
EODMODEL EQU   EODCPUID+4                                               06027000
EODSER   EQU   EODCPUID+1                                               06028000
@NM00061 EQU   EODCPUID                                                 06029000
EODTIME  EQU   EODHEAD+12                                               06030000
EODDATE  EQU   EODHEAD+8                                                06031000
@NM00060 EQU   EODHEAD+5                                                06032000
EODDEV   EQU   EODHEAD+4                                                06033000
EODSMS   EQU   EODHEAD+2                                                06034000
EODKEY2  EQU   EODKEY+1                                                 06035000
EODKEY1  EQU   EODKEY                                                   06036000
MIHTYPE  EQU   MIHCODE2+1                                               06037000
MIHCLASS EQU   MIHCODE2                                                 06038000
@NM00059 EQU   MIHDEV                                                   06039000
MIHVOL   EQU   MIHREC+38                                                06040000
@NM00058 EQU   @NM00057+8                                               06041000
MIHJOBID EQU   @NM00057                                                 06042000
MIHCEL   EQU   MIHCPUID+6                                               06043000
MIHMOD   EQU   MIHCPUID+4                                               06044000
MIHSER   EQU   MIHCPUID+1                                               06045000
@NM00056 EQU   MIHCPUID                                                 06046000
MIHTIME  EQU   MIHHEAD+12                                               06047000
MIHDATE  EQU   MIHHEAD+8                                                06048000
@NM00055 EQU   MIHHEAD+6                                                06049000
MIHCSID  EQU   MIHHEAD+5                                                06050000
MIHDEBIT EQU   @NM00054                                                 06051000
MIHCEBIT EQU   @NM00054                                                 06052000
MIHSMS   EQU   MIHHEAD+2                                                06053000
MIHKEY2  EQU   MIHKEY+1                                                 06054000
MIHKEY1  EQU   MIHKEY                                                   06055000
DDRDEV2  EQU   DDRTODEV+2                                               06056000
DDRDEV1  EQU   DDRTODEV                                                 06057000
DDRTOCUA EQU   DDRREC+53                                                06058000
@NM00053 EQU   DDRREC+52                                                06059000
DDRTYPE  EQU   DDRCODE2+1                                               06060000
DDRCLASS EQU   DDRCODE2                                                 06061000
DDRCODE1 EQU   DDRFDEV                                                  06062000
DDRPHD   EQU   @NM00052+20                                              06063000
DDRVOL2  EQU   @NM00052+14                                              06064000
DDRVOL1  EQU   @NM00052+8                                               06065000
DDRJOBID EQU   @NM00052                                                 06066000
DDRCEL   EQU   DDRCPUID+6                                               06067000
DDRMOD   EQU   DDRCPUID+4                                               06068000
DDRSER   EQU   DDRCPUID+1                                               06069000
@NM00051 EQU   DDRCPUID                                                 06070000
DDRTIME  EQU   DDRHEAD+12                                               06071000
DDRDATE  EQU   DDRHEAD+8                                                06072000
@NM00050 EQU   DDRHEAD+4                                                06073000
DDRDEPSW EQU   DDRSMS+1                                                 06074000
@NM00049 EQU   DDRSMS                                                   06075000
DDRKEY2  EQU   DDRKEY+1                                                 06076000
DDRKEY1  EQU   DDRKEY                                                   06077000
IPLSHSEC EQU   IPLSTIME+3                                               06078000
IPLSSEC  EQU   IPLSTIME+2                                               06079000
IPLSMIN  EQU   IPLSTIME+1                                               06080000
IPLSHOUR EQU   IPLSTIME                                                 06081000
IPLSDATE EQU   IPLREC+48                                                06082000
IPLTEMP  EQU   IPLREC+46                                                06083000
IPLHIGH  EQU   IPLREC+42                                                06084000
IPLCHAN  EQU   IPLREC+32                                                06085000
@NM00048 EQU   IPLREC+30                                                06086000
IPLREAS  EQU   IPLREC+28                                                06087000
@NM00047 EQU   IPLREC+25                                                06088000
IPLSYSID EQU   IPLREC+24                                                06089000
IPLCEL   EQU   IPLCPUID+6                                               06090000
IPLMOD   EQU   IPLCPUID+4                                               06091000
IPLSER   EQU   IPLCPUID+1                                               06092000
@NM00046 EQU   IPLCPUID                                                 06093000
IPLTIME  EQU   IPLHEAD+12                                               06094000
IPLDATE  EQU   IPLHEAD+8                                                06095000
@NM00045 EQU   IPLHEAD+4                                                06096000
IPLSMS   EQU   IPLHEAD+2                                                06097000
IPLKEY2  EQU   IPLKEY+1                                                 06098000
IPLKEY1  EQU   IPLKEY                                                   06099000
SFTXDATA EQU   SFTREC+434                                               06100000
SFTLVARA EQU   SFTREC+432                                               06101000
SFTREXN  EQU   SFTRECP+16                                               06102000
SFTCSECT EQU   SFTRECP+8                                                06103000
SFTMODN  EQU   SFTRECP                                                  06104000
@NM00044 EQU   SFTSDWA+238                                              06105000
SFTLCPUA EQU   SFTSDWA+236                                              06106000
SFTERRD  EQU   SFTFLGS+3                                                06107000
SFTERRC  EQU   SFTFLGS+2                                                06108000
SFTERRB  EQU   SFTFLGS+1                                                06109000
SFTERRA  EQU   SFTFLGS                                                  06110000
@NM00043 EQU   SFTSDWA+136                                              06111000
SFTAAEC1 EQU   SFTSDWA+120                                              06112000
@NM00042 EQU   SFTSDWA+112                                              06113000
SFTPROGC EQU   SFTAEC1+8                                                06114000
@NM00041 EQU   SFTAEC1                                                  06115000
@NM00040 EQU   SFTSDWA+88                                               06116000
SFTGRSV  EQU   SFTSDWA+24                                               06117000
SFTABNDC EQU   SFTSDWA                                                  06118000
SFTJOBID EQU   SFTREC+24                                                06119000
SFTCEL   EQU   SFTCPUID+6                                               06120000
SFTMOD   EQU   SFTCPUID+4                                               06121000
SFTSER   EQU   SFTCPUID+1                                               06122000
@NM00039 EQU   SFTCPUID                                                 06123000
SFTTIME  EQU   SFTHEAD+12                                               06124000
SFTDATE  EQU   SFTHEAD+8                                                06125000
@NM00038 EQU   SFTHEAD+4                                                06126000
SFTSMS   EQU   SFTHEAD+2                                                06127000
SFTKEY2  EQU   SFTKEY+1                                                 06128000
SFTKEY1  EQU   SFTKEY                                                   06129000
@NM00037 EQU   OBRTERMN                                                 06130000
@NM00036 EQU   OBRSEEK+1                                                06131000
OBRTCAM  EQU   OBRSEEK                                                  06132000
OBRVOL   EQU   OBRREC+64                                                06133000
OBRSBCNT EQU   OBRREC+62                                                06134000
OBRRETRY EQU   OBRREC+60                                                06135000
OBRTYPE  EQU   OBRDEV+1                                                 06136000
OBRCODE1 EQU   OBRCODE                                                  06137000
OBRSECUA EQU   OBRREC+49                                                06138000
OBRSTAT  EQU   OBRCSW+4                                                 06139000
@NM00035 EQU   OBRCSW                                                   06140000
OBRSDRS2 EQU   OBRSRDS                                                  06141000
OBRSDRS1 EQU   OBRSRDS                                                  06142000
OBRSDEV1 EQU   OBRJOBID                                                 06143000
OBRCEL   EQU   OBRCPUID+6                                               06144000
OBRMOD   EQU   OBRCPUID+4                                               06145000
OBRSER   EQU   OBRCPUID+1                                               06146000
@NM00034 EQU   OBRCPUID                                                 06147000
OBRTIME  EQU   OBRHEAD+12                                               06148000
OBRDATE  EQU   OBRHEAD+8                                                06149000
@NM00033 EQU   OBRHEAD+4                                                06150000
@NM00032 EQU   OBRSUBTP                                                 06151000
@NM00031 EQU   OBRSUBTP                                                 06152000
@NM00030 EQU   MISCSW                                                   06153000
TRUNC    EQU   MISCSW                                                   06154000
@NM00029 EQU   MISCSW                                                   06155000
OBRKEY2  EQU   OBRKEY+1                                                 06156000
OBRKEY1  EQU   OBRKEY                                                   06157000
CCHLOG   EQU   CCHREC+80                                                06158000
CCHMP    EQU   CCHREC+76                                                06159000
@NM00028 EQU   CCHREC+73                                                06160000
CCHID    EQU   CCHREC+72                                                06161000
CCHTYPE  EQU   CCHCODE2+1                                               06162000
CCHCLASS EQU   CCHCODE2                                                 06163000
CCHCODE1 EQU   CCHCODE                                                  06164000
CCHECSW  EQU   CCHREC+64                                                06165000
CCHCSW   EQU   CCHREC+56                                                06166000
CCHFCCW  EQU   CCHREC+48                                                06167000
CCHATIO  EQU   CCHREC+32                                                06168000
CCHJOBID EQU   CCHREC+24                                                06169000
CCHCEL   EQU   CCHCPUID+6                                               06170000
CCHMOD   EQU   CCHCPUID+4                                               06171000
CCHSER   EQU   CCHCPUID+1                                               06172000
@NM00027 EQU   CCHCPUID                                                 06173000
CCHTIME  EQU   CCHHEAD+12                                               06174000
CCHDATE  EQU   CCHHEAD+8                                                06175000
@NM00026 EQU   CCHHEAD+4                                                06176000
CCHRINC  EQU   CCHSMS+1                                                 06177000
@NM00025 EQU   CCHSMS                                                   06178000
CCHRCRH  EQU   CCHSMS                                                   06179000
@NM00024 EQU   CCHSMS                                                   06180000
CCHKEY2  EQU   CCHKEY+1                                                 06181000
CCHKEY1  EQU   CCHKEY                                                   06182000
MCHLOG   EQU   MCHREC+48                                                06183000
MCHOPSW  EQU   MCHREC+40                                                06184000
MCHJOBID EQU   MCHREC+32                                                06185000
MCHPGMID EQU   MCHREC+24                                                06186000
MCHCEL   EQU   MCHCPUID+6                                               06187000
MCHMOD   EQU   MCHCPUID+4                                               06188000
MCHSER   EQU   MCHCPUID+1                                               06189000
@NM00023 EQU   MCHCPUID                                                 06190000
MCHTIME  EQU   MCHHEAD+12                                               06191000
MCHDATE  EQU   MCHHEAD+8                                                06192000
@NM00022 EQU   MCHHEAD+4                                                06193000
MCHSYSTR EQU   MCHSMS+1                                                 06194000
@NM00021 EQU   MCHSMS                                                   06195000
MCHKEY2  EQU   MCHKEY+1                                                 06196000
MCHKEY1  EQU   MCHKEY                                                   06197000
LRTMCEL  EQU   LRTCPU+6                                                 06198000
@NM00020 EQU   LRTCPU                                                   06199000
LRTHSECS EQU   LRTTIME+3                                                06200000
LRTSEC   EQU   LRTTIME+2                                                06201000
LRTMIN   EQU   LRTTIME+1                                                06202000
LRTHOUR  EQU   LRTTIME                                                  06203000
LRTYEAR  EQU   LRTYRDAY                                                 06204000
LRTDATE0 EQU   LRTDATE                                                  06205000
@NM00019 EQU   @NM00017+3                                               06206000
@NM00018 EQU   @NM00017                                                 06207000
LRTDSMNT EQU   LRTERRID                                                 06208000
@NM00016 EQU   LRTERRID                                                 06209000
LRTSHRT  EQU   LRTERRID                                                 06210000
@NM00015 EQU   LRTERRID                                                 06211000
@NM00014 EQU   LRTSMS                                                   06212000
LRTIMCNV EQU   LRTSMS                                                   06213000
@NM00013 EQU   LRTSMS                                                   06214000
LRNS     EQU   LRTSMS                                                   06215000
LRTKEY2  EQU   LRTKEY+1                                                 06216000
TMPTEMP  EQU   TMP2+10                                                  06217000
TMPPERM  EQU   TMPPERM1+1                                               06218000
@NM00012 EQU   TMPPERM1                                                 06219000
TMPRANGE EQU   TMP2+7                                                   06220000
TMPDEV   EQU   TMPKEY+5                                                 06221000
TMPOLDA  EQU   TMPITEM                                                  06222000
TMP3705  EQU   TMPITEM                                                  06223000
TMPOLD   EQU   TMPCPUS                                                  06224000
TMPCPU   EQU   TMPCPUS                                                  06225000
TMPCUA   EQU   TMPSRT                                                   06226000
TMPGROUP EQU   TMPKEY                                                   06227000
TMTTEMP  EQU   TMT2+10                                                  06228000
TMTPERM  EQU   TMTPERM1+1                                               06229000
@NM00011 EQU   TMTPERM1                                                 06230000
TMTDEV   EQU   TMTKEY+6                                                 06231000
TMTDAT   EQU   TMTKEY+5                                                 06232000
TMTOLDA  EQU   TMTITEM                                                  06233000
TMT3705  EQU   TMTITEM                                                  06234000
TMTOLD   EQU   TMTCPUS                                                  06235000
TMTCPU   EQU   TMTCPUS                                                  06236000
TMTCUA   EQU   TMTSRT                                                   06237000
TMTGROUP EQU   TMTKEY                                                   06238000
SYMVAL2  EQU   SYMVAL+2                                                 06239000
SYMVAL1  EQU   SYMVAL                                                   06240000
SYMCDNUM EQU   SYMCODE                                                  06241000
LIBVAL   EQU   LIBADR+2                                                 06242000
LIBADNUM EQU   LIBADR                                                   06243000
CPUCUX3  EQU   CPUCUAV+5                                                06244000
CPUCUX2  EQU   CPUCUAV+3                                                06245000
CPUCUX1  EQU   CPUCUAV                                                  06246000
CPCUANUM EQU   CPUCUAS                                                  06247000
CPUVAL   EQU   CPUS+2                                                   06248000
CPUNUM   EQU   CPUS                                                     06249000
VOLVAL   EQU   VOLUME+2                                                 06250000
VOLNUM   EQU   VOLUME                                                   06251000
SERVAL   EQU   DEVSERAL+2                                               06252000
SERNUM   EQU   DEVSERAL                                                 06253000
MODVAL   EQU   MODELS+2                                                 06254000
MODNUM   EQU   MODELS                                                   06255000
LOADPTR  EQU   EDITABLE+8                                               06256000
LOADNAME EQU   EDITABLE                                                 06257000
EDITNUM  EQU   EDITLOAD                                                 06258000
SHRCUABH EQU   SHRBASE+5                                                06259000
SYSUMEOD EQU   SYSUMONE+96                                              06260000
SYSUMPER EQU   SYSUMONE+92                                              06261000
SYSUMPEA EQU   SYSUMONE+88                                              06262000
SYSUMPEI EQU   SYSUMONE+84                                              06263000
SYSUMCH  EQU   SYSUMONE+20                                              06264000
SYSUMMCN EQU   SYSUMONE+16                                              06265000
SYSUMMCR EQU   SYSUMONE+12                                              06266000
SYSUMNXT EQU   SYSUMONE+8                                               06267000
SYSUMIPL EQU   SYSUMONE+4                                               06268000
SYSUMNUM EQU   SYSUMONE                                                 06269000
SORTCORE EQU   SORTCCHR                                                 06270000
SORTTIME EQU   SORTKEY+1                                                06271000
SORTYEAR EQU   SORTKEY                                                  06272000
EVDAY    EQU   EVSTOP+1                                                 06273000
EVYEAR   EQU   EVSTOP                                                   06274000
DUMPSIZE EQU   DUMPINFO+4                                               06275000
DUMPADR  EQU   DUMPINFO                                                 06276000
DUMPNUM  EQU   DUMPTABL                                                 06277000
@NM00010 EQU   PARM+212                                                 06278000
RECLNGT1 EQU   PARM+204                                                 06279000
ADCPUT   EQU   PARM+144                                                 06280000
LINECT   EQU   PARM+120                                                 06281000
RECLNGTH EQU   CCHHRLNG+6                                               06282000
@NM00009 EQU   CCHHRLNG+5                                               06283000
USERPGM  EQU   PARM+102                                                 06284000
IDTSEC   EQU   IDTIME+3                                                 06285000
IDSEC    EQU   IDTIME+2                                                 06286000
IDMIN    EQU   IDTIME+1                                                 06287000
IDHOUR   EQU   IDTIME                                                   06288000
IDASID   EQU   ERRID+4                                                  06289000
IDCPU    EQU   ERRID+3                                                  06290000
@NM00008 EQU   ERRID+2                                                  06291000
IDVALUE  EQU   ERRID                                                    06292000
SYSRETRN EQU   @NM00007                                                 06293000
NUMIN222 EQU   @NM00006                                                 06294000
WRTHRSH  EQU   PARM+69                                                  06295000
RDTHRSH  EQU   PARM+66                                                  06296000
TERM     EQU   PARM+58                                                  06297000
EVSDAY   EQU   STRTDATE+1                                               06298000
EVSYEAR  EQU   STRTDATE                                                 06299000
PENSEC2  EQU   ENDTIME2+2                                               06300000
PENMIN2  EQU   ENDTIME2+1                                               06301000
PENHOUR2 EQU   ENDTIME2                                                 06302000
PSTSEC2  EQU   STTIME2+2                                                06303000
PSTMIN2  EQU   STTIME2+1                                                06304000
PSTHOUR2 EQU   STTIME2                                                  06305000
PENSEC1  EQU   ENDTIME1+2                                               06306000
PENMIN1  EQU   ENDTIME1+1                                               06307000
PENHOUR1 EQU   ENDTIME1                                                 06308000
PSTSEC1  EQU   STTIME1+2                                                06309000
PSTMIN1  EQU   STTIME1+1                                                06310000
PSTHOUR1 EQU   STTIME1                                                  06311000
@NM00005 EQU   ENDDT+4                                                  06312000
PENYR    EQU   PEND                                                     06313000
@NM00004 EQU   ENDDATE                                                  06314000
@NM00003 EQU   STDT+4                                                   06315000
@NM00002 EQU   STDATE                                                   06316000
YEARNOW  EQU   DATENOW+4                                                06317000
@NM00001 EQU   DATENOW+3                                                06318000
DAYNOW   EQU   DATENOW                                                  06319000
CSNAP    EQU   CLOSEIO                                                  06320000
CSYSIN   EQU   CLOSEIO                                                  06321000
CSERLOG  EQU   CLOSEIO                                                  06322000
CEREPPT  EQU   CLOSEIO                                                  06323000
CTOURIST EQU   CLOSEIO                                                  06324000
OSNAP    EQU   OPENIO                                                   06325000
ODRCTWRK EQU   OPENIO                                                   06326000
OSYSIN   EQU   OPENIO                                                   06327000
OACCDEV  EQU   OPENIO                                                   06328000
OACCIN   EQU   OPENIO                                                   06329000
OSERLOG  EQU   OPENIO                                                   06330000
OEREPPT  EQU   OPENIO                                                   06331000
OTOURIST EQU   OPENIO                                                   06332000
PLOGREC  EQU   MISC                                                     06333000
ERRORID  EQU   MISC                                                     06334000
PSUM     EQU   PRINTES                                                  06335000
PEDIT    EQU   PRINTES                                                  06336000
PZERO    EQU   MISC                                                     06337000
DEBUG63  EQU   DEBUGA+3                                                 06338000
DEBUG62  EQU   DEBUGA+3                                                 06339000
DEBUG61  EQU   DEBUGA+3                                                 06340000
DEBUG60  EQU   DEBUGA+3                                                 06341000
DEBUG59  EQU   DEBUGA+3                                                 06342000
DEBUG58  EQU   DEBUGA+3                                                 06343000
DEBUG57  EQU   DEBUGA+3                                                 06344000
DEBUG56  EQU   DEBUGA+3                                                 06345000
DEBUG55  EQU   DEBUGA+2                                                 06346000
DEBUG54  EQU   DEBUGA+2                                                 06347000
DEBUG53  EQU   DEBUGA+2                                                 06348000
DEBUG52  EQU   DEBUGA+2                                                 06349000
DEBUG51  EQU   DEBUGA+2                                                 06350000
DEBUG49  EQU   DEBUGA+2                                                 06351000
DEBUG48  EQU   DEBUGA+2                                                 06352000
DEBUG47  EQU   DEBUGA+1                                                 06353000
DEBUG46  EQU   DEBUGA+1                                                 06354000
DEBUG45  EQU   DEBUGA+1                                                 06355000
DEBUG44  EQU   DEBUGA+1                                                 06356000
DEBUG43  EQU   DEBUGA+1                                                 06357000
DEBUG42  EQU   DEBUGA+1                                                 06358000
DEBUG41  EQU   DEBUGA+1                                                 06359000
DEBUG40  EQU   DEBUGA+1                                                 06360000
DEBUG39  EQU   DEBUGA                                                   06361000
DEBUG38  EQU   DEBUGA                                                   06362000
DEBUG37  EQU   DEBUGA                                                   06363000
DEBUG36  EQU   DEBUGA                                                   06364000
DEBUG35  EQU   DEBUGA                                                   06365000
DEBUG34  EQU   DEBUGA                                                   06366000
DEBUG33  EQU   DEBUGA                                                   06367000
DEBUG32  EQU   DEBUGA                                                   06368000
DEBUG31  EQU   DEBUG+3                                                  06369000
DEBUG30  EQU   DEBUG+3                                                  06370000
DEBUG29  EQU   DEBUG+3                                                  06371000
DEBUG28  EQU   DEBUG+3                                                  06372000
DEBUG27  EQU   DEBUG+3                                                  06373000
DEBUG26  EQU   DEBUG+3                                                  06374000
DEBUG25  EQU   DEBUG+3                                                  06375000
DEBUG24  EQU   DEBUG+3                                                  06376000
DEBUG22  EQU   DEBUG+2                                                  06377000
DEBUG21  EQU   DEBUG+2                                                  06378000
DEBUG20  EQU   DEBUG+2                                                  06379000
DEBUG19  EQU   DEBUG+2                                                  06380000
DEBUG18  EQU   DEBUG+2                                                  06381000
DEBUG17  EQU   DEBUG+2                                                  06382000
DEBUG15  EQU   DEBUG+1                                                  06383000
DEBUG14  EQU   DEBUG+1                                                  06384000
DEBUG13  EQU   DEBUG+1                                                  06385000
DEBUG12  EQU   DEBUG+1                                                  06386000
DEBUG10  EQU   DEBUG+1                                                  06387000
DEBUG9   EQU   DEBUG+1                                                  06388000
DEBUG8   EQU   DEBUG+1                                                  06389000
DEBUG7   EQU   DEBUG                                                    06390000
DEBUG6   EQU   DEBUG                                                    06391000
DEBUG5   EQU   DEBUG                                                    06392000
DEBUG3   EQU   DEBUG                                                    06393000
DEBUG2   EQU   DEBUG                                                    06394000
DEBUG1   EQU   DEBUG                                                    06395000
DEBUG0   EQU   DEBUG                                                    06396000
SORTBRK  EQU   SWITCHES+1                                               06397000
COREFAIL EQU   SWITCHES+1                                               06398000
ANALYSIS EQU   SWITCHES+1                                               06399000
NOTALL   EQU   SWITCHES+1                                               06400000
NOSDR    EQU   SWITCHES                                                 06401000
TIMESEQ  EQU   SWITCHES                                                 06402000
SYSUM    EQU   SWITCHES                                                 06403000
PARMTHR  EQU   SWITCHES                                                 06404000
TREND    EQU   SWITCHES                                                 06405000
SHORTOBR EQU   SWITCHES                                                 06406000
PARMMES  EQU   SWITCHES                                                 06407000
RDESUM   EQU   SWITCHES                                                 06408000
PCCHFRAM EQU   RECTYPE+1                                                06409000
PMCHFRAM EQU   RECTYPE+1                                                06410000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      06411000
@RF00454 EQU   @EL00006                                                 06412000
@RF00489 EQU   @EL00007                                                 06413000
@RF00512 EQU   @RC00510                                                 06414000
@RF00527 EQU   @RC00525                                                 06415000
@RF00546 EQU   @EL00008                                                 06416000
@RF00567 EQU   @EL00009                                                 06417000
@RF00579 EQU   @EL00010                                                 06418000
@RC00583 EQU   @EL00011                                                 06419000
@RC00589 EQU   @EL00011                                                 06420000
@RC00595 EQU   @EL00011                                                 06421000
@RC00601 EQU   @EL00011                                                 06422000
@RC00607 EQU   @EL00011                                                 06423000
@RF00613 EQU   @EL00011                                                 06424000
@RF00627 EQU   @EL00012                                                 06425000
@RC00625 EQU   @EL00012                                                 06426000
@RF00711 EQU   @RC00702                                                 06427000
@RF00784 EQU   @EL00014                                                 06428000
@RF00787 EQU   @EL00014                                                 06429000
@RC00794 EQU   @EL00015                                                 06430000
@RC00807 EQU   @EL00016                                                 06431000
@RC00810 EQU   @EL00016                                                 06432000
@RC00816 EQU   @EL00016                                                 06433000
@RC00819 EQU   @EL00016                                                 06434000
@RC00822 EQU   @EL00016                                                 06435000
@RC00825 EQU   @EL00016                                                 06436000
@RC00828 EQU   @EL00016                                                 06437000
@RC00831 EQU   @EL00016                                                 06438000
@RC00834 EQU   @EL00016                                                 06439000
@RC00852 EQU   @RC00850                                                 06440000
@RC00882 EQU   @RC00877                                                 06441000
@RC00925 EQU   @EL00018                                                 06442000
@RC00944 EQU   @EL00019                                                 06443000
@RF00960 EQU   @EL00019                                                 06444000
@RF00964 EQU   @EL00019                                                 06445000
@RC00970 EQU   @EL00020                                                 06446000
@RF00977 EQU   @EL00020                                                 06447000
@RF00981 EQU   @EL00020                                                 06448000
@RC00983 EQU   @EL00020                                                 06449000
@RC01005 EQU   @EL00020                                                 06450000
@RC00986 EQU   @EL00020                                                 06451000
@RC01022 EQU   @EL00021                                                 06452000
@RF01030 EQU   @EL00021                                                 06453000
@RF01037 EQU   @EL00021                                                 06454000
@RC01044 EQU   @EL00022                                                 06455000
@RF01052 EQU   @EL00022                                                 06456000
@RF01059 EQU   @EL00022                                                 06457000
@RC01067 EQU   @EL00023                                                 06458000
@RF01075 EQU   @EL00023                                                 06459000
@RF01078 EQU   @EL00023                                                 06460000
@RF01115 EQU   @EL00023                                                 06461000
@RC01132 EQU   @EL00024                                                 06462000
@RF01136 EQU   @EL00024                                                 06463000
@RC01145 EQU   @EL00025                                                 06464000
@RC01151 EQU   @EL00026                                                 06465000
@RF01155 EQU   @EL00026                                                 06466000
@RF01159 EQU   @EL00026                                                 06467000
@RC01175 EQU   @EL00027                                                 06468000
@RF01179 EQU   @EL00027                                                 06469000
@RC01214 EQU   @EL00028                                                 06470000
@RC01187 EQU   @EL00028                                                 06471000
@RF01232 EQU   @EL00028                                                 06472000
@RF01245 EQU   @EL00029                                                 06473000
@RC01379 EQU   @RC01377                                                 06474000
@RF01397 EQU   @EL00034                                                 06475000
@RF01439 EQU   @RC01402                                                 06476000
@RF01475 EQU   @EL00036                                                 06477000
@RC01488 EQU   @EL00037                                                 06478000
@PB00037 EQU   @EL00001                                                 06479000
@RC00796 EQU   @RC00794                                                 06480000
@RF00935 EQU   @RC00925                                                 06481000
@RF00992 EQU   @RC00986                                                 06482000
@RC01189 EQU   @RC01187                                                 06483000
@RF01207 EQU   @RC01187                                                 06484000
@PB00036 EQU   @PB00037                                                 06485000
@RC01490 EQU   @RC01488                                                 06486000
@RC01502 EQU   @RC01488                                                 06487000
@RF00798 EQU   @RC00796                                                 06488000
@PB00035 EQU   @PB00036                                                 06489000
@RF01495 EQU   @RC01490                                                 06490000
@RC01505 EQU   @RC01502                                                 06491000
@PB00034 EQU   @PB00035                                                 06492000
@RF01509 EQU   @RC01505                                                 06493000
@RF01511 EQU   @RC01505                                                 06494000
@RC01513 EQU   @RC01505                                                 06495000
@RC01520 EQU   @RC01505                                                 06496000
@PB00033 EQU   @PB00034                                                 06497000
@PB00032 EQU   @PB00033                                                 06498000
@PB00031 EQU   @PB00032                                                 06499000
@PB00030 EQU   @PB00031                                                 06500000
@PB00029 EQU   @PB00030                                                 06501000
@PB00028 EQU   @PB00029                                                 06502000
@PB00027 EQU   @PB00028                                                 06503000
@PB00026 EQU   @PB00027                                                 06504000
@PB00025 EQU   @PB00026                                                 06505000
@PB00024 EQU   @PB00025                                                 06506000
@PB00023 EQU   @PB00024                                                 06507000
@PB00022 EQU   @PB00023                                                 06508000
@PB00021 EQU   @PB00022                                                 06509000
@PB00020 EQU   @PB00021                                                 06510000
@PB00019 EQU   @PB00020                                                 06511000
@PB00018 EQU   @PB00019                                                 06512000
@PB00017 EQU   @PB00018                                                 06513000
@PB00016 EQU   @PB00017                                                 06514000
@PB00015 EQU   @PB00016                                                 06515000
@PB00014 EQU   @PB00015                                                 06516000
@PB00013 EQU   @PB00014                                                 06517000
@PB00012 EQU   @PB00013                                                 06518000
@PB00011 EQU   @PB00012                                                 06519000
@PB00010 EQU   @PB00011                                                 06520000
@PB00009 EQU   @PB00010                                                 06521000
@PB00008 EQU   @PB00009                                                 06522000
@PB00007 EQU   @PB00008                                                 06523000
@PB00006 EQU   @PB00007                                                 06524000
@PB00005 EQU   @PB00006                                                 06525000
@PB00004 EQU   @PB00005                                                 06526000
@PB00003 EQU   @PB00004                                                 06527000
@PB00002 EQU   @PB00003                                                 06528000
@RF00247 EQU   @PB00002                                                 06529000
@ENDDATA EQU   *                                                        06530000
         END   IFCFILT3                                                 06531000
