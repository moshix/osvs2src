         TITLE 'IFCFILT4-RECORD FILTER FOR EVENT HISTORY REPORT        *00001000
                        '                                               00002000
IFCFILT4 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IFCFILT4  78.209'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  ST    @14,12(,@13)                                        0001 00010000
         STM   @00,@12,20(@13)                                     0001 00011000
         BALR  @12,0                                               0001 00012000
@PSTART  LA    @11,4095(,@12)                                      0001 00013000
         LA    @10,4095(,@11)                                      0001 00014000
         LA    @09,4095(,@10)                                      0001 00015000
         USING @PSTART,@12                                         0001 00016000
         USING @PSTART+4095,@11                                    0001 00017000
         USING @PSTART+8190,@10                                    0001 00018000
         USING @PSTART+12285,@09                                   0001 00019000
         ST    @13,@SA00001+4                                      0001 00020000
         LA    @14,@SA00001                                        0001 00021000
         ST    @14,8(,@13)                                         0001 00022000
         LR    @13,@14                                             0001 00023000
*                  /*PROCESS ERROR RECORDS SEQUENTIALLY      @Z427VLS*/ 00024000
* CALL DBUGSET;            /*SET ITEMS REQUESTED VIA DEBUG   @G51DGGB*/ 00025000
         BAL   @14,DBUGSET                                         0253 00026000
* IF DEBUG16 = ON                THEN  /*SPECIAL CASE COMMING UP*/ 0254 00027000
         TM    DEBUG16(R2),B'10000000'                             0254 00028000
         BNO   @RF00254                                            0254 00029000
*  DO;                                                     /*@0099VLS*/ 00030000
*   IF VOLPTR ^= ZERO THEN      /*USER ASK FOR VOLUME SELECTION*/  0256 00031000
         L     @14,VOLPTR(,R2)                                     0256 00032000
         LTR   @14,@14                                             0256 00033000
         BZ    @RF00256                                            0256 00034000
*    VOLTRY = ONE;              /*SET FOR USE IN DEBUG OUT SECTION*/    00035000
         MVC   VOLTRY(2),@CH00055                                  0257 00036000
*                               /*BE THE INDEX FOR THE OUTPUT    */     00037000
*   IF CPUPTR ^= ZERO THEN      /*USER ASK FOR CPU SELECTION @0099VLS*/ 00038000
@RF00256 L     @14,CPUPTR(,R2)                                     0258 00039000
         LTR   @14,@14                                             0258 00040000
         BZ    @RF00258                                            0258 00041000
*    CPUTRY = ONE;              /*SET OUTPUT INDEX FOR CPUS  @0099VLS*/ 00042000
         MVC   CPUTRY(2),@CH00055                                  0259 00043000
*   IF TERM ^= '        ' THEN  /*USER ASK FOR TERMINAL FILTERING  */   00044000
@RF00258 CLC   TERM(8,R2),@CC01004                                 0260 00045000
         BE    @RF00260                                            0260 00046000
*    TERMTRY = ONE;             /*SET THE TERMINAL OUT INDEX @0099VLS*/ 00047000
         MVC   TERMTRY(4),@CF00055                                 0261 00048000
*  END;                                                    /*@0099VLS*/ 00049000
@RF00260 DS    0H                                                  0263 00050000
*  CALL GETCORE;   /*GET CORE FOR SORTABLE AND EVTABLE       @Z427VLS*/ 00051000
@RF00254 BAL   @14,GETCORE                                         0263 00052000
*  R15 = ERROR; /*SEE WHAT HAPPENED IN GETCORE               @Z427VLS*/ 00053000
         L     R15,ERROR                                           0264 00054000
*  DO WHILE R15 = SUCCESS & I <= MAXENT; /*DO IF ROOM I SORTABLE*/ 0265 00055000
         B     @DE00265                                            0265 00056000
@DL00265 DS    0H                                                  0266 00057000
*    CALL IOHND(READSEQ);                        /*GET A RECORD*/  0266 00058000
         L     @15,ADIOHND(,R2)                                    0266 00059000
         LA    @01,@AL00266                                        0266 00060000
         BALR  @14,@15                                             0266 00061000
*    IF R15 = SUCCESS THEN  /*CONTINUE IF NOT EOF OR UNREADABLE*/  0267 00062000
         LTR   R15,R15                                             0267 00063000
         BNZ   @RF00267                                            0267 00064000
*      DO;                                                 /*@Z427VLS*/ 00065000
*        BYTECT = BYTECT + RECLNGTH;                       /*@Z427VLS*/ 00066000
         LH    @14,RECLNGTH(,R2)                                   0269 00067000
         AL    @14,BYTECT                                          0269 00068000
         ST    @14,BYTECT                                          0269 00069000
*        NUMREC = NUMREC + ONE;              /*NUMBER OF RECORDS READ*/ 00070000
         LA    @14,1                                               0270 00071000
         L     @08,NUMREC                                          0270 00072000
         ALR   @08,@14                                             0270 00073000
         ST    @08,NUMREC                                          0270 00074000
*RESPECIFY (R0) RESTRICTED;                                /*@0099VLS*/ 00075000
*        R0 = LRTKEY1;          /*LOAD THE RECORD TYPE       @Z427VLS*/ 00076000
         SLR   R0,R0                                               0272 00077000
         IC    R0,LRTKEY1(,R7)                                     0272 00078000
*      SRL(R0,FOUR);            /*REMOVE UNWANTED BITS       @0099VLS*/ 00079000
         SRL   R0,4                                                0273 00080000
*   IF R0 < 1 | R0 > 11           /* IF NOT A VALID TYPE MUST CHANGE */ 00081000
*       THEN                                                       0274 00082000
         CR    R0,@14                                              0274 00083000
         BL    @RT00274                                            0274 00084000
         C     R0,@CF00033                                         0274 00085000
         BNH   @RF00274                                            0274 00086000
@RT00274 DS    0H                                                  0275 00087000
*        DO;                                               /*@0099VLS*/ 00088000
*        ODDREC = ON;           /*TURN ON SWITCH FOR DEBUG   @0099VLS*/ 00089000
         OI    ODDREC,B'00000010'                                  0276 00090000
*       RTYP1 = 10;                                        /*@0099VLS*/ 00091000
         LA    @14,10                                              0277 00092000
         ST    @14,RTYP1                                           0277 00093000
*       R0 = 10;                                           /*@0099VLS*/ 00094000
         LR    R0,@14                                              0278 00095000
*                               /*ARRAYS                     @0099VLS*/ 00096000
*        END;                                              /*@0099VLS*/ 00097000
*       ELSE                                                       0280 00098000
*        RTYP1 = R0;                                       /*@Z427VLS*/ 00099000
         B     @RC00274                                            0280 00100000
@RF00274 ST    R0,RTYP1                                            0280 00101000
*      IF LRTKEY1 ^= 'A0'X & LRTKEY1 ^= 'B0'X THEN         /*@VS48726*/ 00102000
@RC00274 CLI   LRTKEY1(R7),X'A0'                                   0281 00103000
         BE    @RF00281                                            0281 00104000
         CLI   LRTKEY1(R7),X'B0'                                   0281 00105000
         BE    @RF00281                                            0281 00106000
*        INCOUNT(R0) = INCOUNT(R0) + ONE;                  /*@Z427VLS*/ 00107000
         LR    @14,R0                                              0282 00108000
         SLA   @14,2                                               0282 00109000
         LA    @08,1                                               0282 00110000
         AL    @08,INCOUNT-4(@14)                                  0282 00111000
         ST    @08,INCOUNT-4(@14)                                  0282 00112000
*      IF DEBUG47 ^= ON THEN /*DO THEY ONLY WANT FRAMES OUTPUT*/   0283 00113000
@RF00281 TM    DEBUG47(R2),B'00000001'                             0283 00114000
         BO    @RF00283                                            0283 00115000
*        PASSFLAG = YES;   /*SET THE FLAG TO ON PRIOR TO CALL*/    0284 00116000
         OI    PASSFLAG(R2),B'00000001'                            0284 00117000
*      ELSE                                                        0285 00118000
*       DO;                                                /*@G51DGGB*/ 00119000
         B     @RC00283                                            0285 00120000
@RF00283 DS    0H                                                  0286 00121000
*        PASSFLAG = OFF;   /*DO NOT ALLOW RECORD TO PASS     @G51DGGB*/ 00122000
         NI    PASSFLAG(R2),B'11111110'                            0286 00123000
*      IF LRTKEY1 ^= 'A0'X & LRTKEY1 ^= 'B0'X THEN         /*@VS48726*/ 00124000
         CLI   LRTKEY1(R7),X'A0'                                   0287 00125000
         BE    @RF00287                                            0287 00126000
         CLI   LRTKEY1(R7),X'B0'                                   0287 00127000
         BE    @RF00287                                            0287 00128000
*        RDEPCT(R0) = RDEPCT(R0) + 1;/*KEEP TRACK OF DROPPED RECORDS*/  00129000
         LR    @14,R0                                              0288 00130000
         SLA   @14,2                                               0288 00131000
         LA    @08,1                                               0288 00132000
         AL    @08,RDEPCT-4(@14)                                   0288 00133000
         ST    @08,RDEPCT-4(@14)                                   0288 00134000
*       END;                                               /*@G51DGGB*/ 00135000
@RF00287 DS    0H                                                  0290 00136000
*           IF RTYP1 = TEN |  /*IS IT A MCF TYPE RECORD      @G51DGGB*/ 00137000
*           RTYP1 = ELEVEN THEN /*IS IT A CCF TYPE OF RECORD @G51DGGB*/ 00138000
@RC00283 L     @14,RTYP1                                           0290 00139000
         C     @14,@CF00034                                        0290 00140000
         BE    @RT00290                                            0290 00141000
         C     @14,@CF00033                                        0290 00142000
         BNE   @RF00290                                            0290 00143000
@RT00290 DS    0H                                                  0291 00144000
*           DO;                                            /*@G51DGGB*/ 00145000
*            FRINDEX = RTYP1 - 9; /*SET INDEX TO 1 OR 2      @G51DGGB*/ 00146000
         L     @14,RTYP1                                           0292 00147000
         SL    @14,@CF00035                                        0292 00148000
         ST    @14,FRINDEX                                         0292 00149000
*            FRMREAD(FRINDEX) = FRMREAD(FRINDEX) + 1;      /*@G51DGGB*/ 00150000
         ALR   @14,@14                                             0293 00151000
         LA    @08,1                                               0293 00152000
         AH    @08,FRMREAD-2(@14)                                  0293 00153000
         STH   @08,FRMREAD-2(@14)                                  0293 00154000
*           IF DEBUG47 = ON THEN                                   0294 00155000
         TM    DEBUG47(R2),B'00000001'                             0294 00156000
         BNO   @RF00294                                            0294 00157000
*            DO;                                           /*@G51DGGB*/ 00158000
*            IF PHIST = ON THEN                                    0296 00159000
         TM    PHIST(R2),B'00100000'                               0296 00160000
         BNO   @RF00296                                            0296 00161000
*             CALL IOHND(RITESCRT);                        /*@G51DGGB*/ 00162000
         L     @15,ADIOHND(,R2)                                    0297 00163000
         LA    @01,@AL00297                                        0297 00164000
         BALR  @14,@15                                             0297 00165000
*             IF R15 = ZERO THEN                                   0298 00166000
@RF00296 LTR   R15,R15                                             0298 00167000
         BNZ   @RF00298                                            0298 00168000
*             DO;                                          /*@G51DGGB*/ 00169000
*             CALL ADDTABLE;     /*ADD TO THE SORT TABLE     @G51DGGB*/ 00170000
         BAL   @14,ADDTABLE                                        0300 00171000
*             CALL EVSET;        /*ADD TO EVTABLE            @G51DGGB*/ 00172000
         BAL   @14,EVSET                                           0301 00173000
*             KEPT(FRINDEX) = KEPT(FRINDEX) + 1;           /*@G51DGGB*/ 00174000
         L     @14,FRINDEX                                         0302 00175000
         ALR   @14,@14                                             0302 00176000
         LA    @08,1                                               0302 00177000
         AH    @08,KEPT-2(@14)                                     0302 00178000
         STH   @08,KEPT-2(@14)                                     0302 00179000
*             END;                                         /*@G51DGGB*/ 00180000
*             PASSFLAG = OFF;    /*SET FLAG SO RECORD PROCESSING STOPS* 00181000
@RF00298 NI    PASSFLAG(R2),B'11111110'                            0304 00182000
*            END;                                          /*@G51DGGB*/ 00183000
*            ELSE                                                  0306 00184000
*            CALL CKFRAMES;      /*IF FRAME MAY WANT TO KEEP @G51DGGB*/ 00185000
         B     @RC00294                                            0306 00186000
@RF00294 BAL   @14,CKFRAMES                                        0306 00187000
*                                /*PASSFLAG WILL RETURN IN NO CONDITON* 00188000
*           END;                                           /*@G51DGGB*/ 00189000
@RC00294 DS    0H                                                  0308 00190000
*RESPECIFY (R0) UNRESTRICTED;                              /*@G51DGGB*/ 00191000
@RF00290 DS    0H                                                  0309 00192000
*      IF PASSFLAG = ON THEN    /*STOP PROCESSING THIS REC IF OFF*/     00193000
         TM    PASSFLAG(R2),B'00000001'                            0309 00194000
         BNO   @RF00309                                            0309 00195000
*        CALL ALLREC; /*PERFORM SELECTIONS FROM RECORD HEADER*/    0310 00196000
         BAL   @14,ALLREC                                          0310 00197000
*        IF PASSFLAG = ON THEN                                     0311 00198000
@RF00309 TM    PASSFLAG(R2),B'00000001'                            0311 00199000
         BNO   @RF00311                                            0311 00200000
*         DO;                                              /*@Z427VLS*/ 00201000
*           MIDCOUNT(RTYP1) = MIDCOUNT(RTYP1) + ONE;       /*@Z427VLS*/ 00202000
         L     @14,RTYP1                                           0313 00203000
         SLA   @14,2                                               0313 00204000
         LA    @08,1                                               0313 00205000
         AL    @08,MIDCOUNT-4(@14)                                 0313 00206000
         ST    @08,MIDCOUNT-4(@14)                                 0313 00207000
*  IF CPUPTR ^= ZERO THEN                                          0314 00208000
         L     @14,CPUPTR(,R2)                                     0314 00209000
         LTR   @14,@14                                             0314 00210000
         BZ    @RF00314                                            0314 00211000
*   CALL CPUSELCT  ;                                       /*@0099VLS*/ 00212000
         BAL   @14,CPUSELCT                                        0315 00213000
*  IF PASSFLAG = ON THEN                                           0316 00214000
@RF00314 TM    PASSFLAG(R2),B'00000001'                            0316 00215000
         BNO   @RF00316                                            0316 00216000
*   CALL RECDEP;                                           /*@0099VLS*/ 00217000
         BAL   @14,RECDEP                                          0317 00218000
*          IF PASSFLAG = ON THEN /*INSERT IN EVTABLE IF YES  @0001VLS*/ 00219000
@RF00316 TM    PASSFLAG(R2),B'00000001'                            0318 00220000
         BNO   @RF00318                                            0318 00221000
*           CALL EVSET;          /*WILL INSERT IF NEW CPU    @0001VLS*/ 00222000
         BAL   @14,EVSET                                           0319 00223000
*           IF PASSFLAG = ON THEN                                  0320 00224000
@RF00318 TM    PASSFLAG(R2),B'00000001'                            0320 00225000
         BNO   @RF00320                                            0320 00226000
*            DO;                                           /*@Z427VLS*/ 00227000
*           OUTCOUNT(RTYP1) = OUTCOUNT(RTYP1) + ONE;       /*@Z427VLS*/ 00228000
         L     @14,RTYP1                                           0322 00229000
         SLA   @14,2                                               0322 00230000
         LA    @08,1                                               0322 00231000
         AL    @08,OUTCOUNT-4(@14)                                 0322 00232000
         ST    @08,OUTCOUNT-4(@14)                                 0322 00233000
*            IF PACC = YES THEN    /*HISTORY D.S. TO BE CREATED*/  0323 00234000
         TM    PACC(R2),B'01000000'                                0323 00235000
         BNO   @RF00323                                            0323 00236000
*                CALL IOHND(RITEHIST);  /*WRITE TO ACCDEV    @Z427VLS*/ 00237000
         L     @15,ADIOHND(,R2)                                    0324 00238000
         LA    @01,@AL00324                                        0324 00239000
         BALR  @14,@15                                             0324 00240000
*            IF R15 = SUCCESS                                      0325 00241000
*              THEN DO;                                    /*@Z427VLS*/ 00242000
@RF00323 LTR   R15,R15                                             0325 00243000
         BNZ   @RF00325                                            0325 00244000
*                IF PHIST = ON THEN /*IF HISTORY INPUT, MUST SAVE*/     00245000
         TM    PHIST(R2),B'00100000'                               0327 00246000
         BNO   @RF00327                                            0327 00247000
*                  DO;              /*RECORDS ON D.A.D.S.    @Z427VLS*/ 00248000
*                    CALL IOHND(RITESCRT);                 /*@Z427VLS*/ 00249000
         L     @15,ADIOHND(,R2)                                    0329 00250000
         LA    @01,@AL00329                                        0329 00251000
         BALR  @14,@15                                             0329 00252000
*                    IF R15 = OVERFLOW THEN                        0330 00253000
         C     R15,@CF00066                                        0330 00254000
         BNE   @RF00330                                            0330 00255000
*                     DO;                                  /*@Z427VLS*/ 00256000
*                      ZEROALL = NO; /*DONT CLEAR SERLOG IF ALL*/  0332 00257000
         NI    ZEROALL(R2),B'10111111'                             0332 00258000
*                      PASSNUM = PASSNUM - ONE;/*REC.NOT PROCESSED*/    00259000
         L     @14,PASSNUM                                         0333 00260000
         BCTR  @14,0                                               0333 00261000
         ST    @14,PASSNUM                                         0333 00262000
*                     END;                                 /*@Z427VLS*/ 00263000
*                  END;                                    /*@Z427VLS*/ 00264000
@RF00330 DS    0H                                                  0336 00265000
*                IF R15 = SUCCESS THEN  /*SAVE RECORD LOCATION AND*/    00266000
@RF00327 LTR   R15,R15                                             0336 00267000
         BNZ   @RF00336                                            0336 00268000
*                 CALL ADDTABLE;  /*ADD THIS ENTRY TO SORT TABLE*/ 0337 00269000
         BAL   @14,ADDTABLE                                        0337 00270000
*              END;                                        /*@Z427VLS*/ 00271000
*           ELSE                                                   0339 00272000
*            ZEROALL = NO;   /*MAKE SURE WE DONT ZERO        @Z427VLS*/ 00273000
         B     @RC00325                                            0339 00274000
@RF00325 NI    ZEROALL(R2),B'10111111'                             0339 00275000
*           END;                                           /*@Z427VLS*/ 00276000
@RC00325 DS    0H                                                  0341 00277000
*          END;                                            /*@Z427VLS*/ 00278000
@RF00320 DS    0H                                                  0342 00279000
*      END;                                                /*@Z427VLS*/ 00280000
@RF00311 DS    0H                                                  0343 00281000
*  END;                                                    /*@Z427VLS*/ 00282000
@RF00267 DS    0H                                                  0343 00283000
@DE00265 LTR   R15,R15                                             0343 00284000
         BNZ   @DC00265                                            0343 00285000
         L     @14,I                                               0343 00286000
         C     @14,MAXENT                                          0343 00287000
         BNH   @DL00265                                            0343 00288000
@DC00265 DS    0H                                                  0344 00289000
*                    RESPECIFY(R1,R0) UNRESTRICTED;        /*@Z427VLS*/ 00290000
*  ERROR = R15; /*TELL ENDOFILE THE ERROR STATUS             @Z427VLS*/ 00291000
         ST    R15,ERROR                                           0345 00292000
*  CALL ENDOFILE; /*SORT SORTABLE, FREE EXCESS CORE, HANDLE  @Z427VLS*/ 00293000
         BAL   @14,ENDOFILE                                        0346 00294000
*                 /*ERROR CONDITIONS                         @Z427VLS*/ 00295000
*  IF EXCESSCT ^= ZERO THEN             /*TO MANY CPU'S IN INPUT DATA*/ 00296000
         L     @14,EXCESSCT                                        0347 00297000
         LTR   @14,@14                                             0347 00298000
         BZ    @RF00347                                            0347 00299000
*    DO;                                                   /*@Z427VLS*/ 00300000
*     CVD(EXCESSCT,PACKPAS);                               /*@Z427VLS*/ 00301000
         CVD   @14,@TS00001                                        0349 00302000
         MVC   PACKPAS(4),@TS00001+4                               0349 00303000
*     UNPK(CT,PACKPAS);                                    /*@Z427VLS*/ 00304000
         UNPK  CT(8),PACKPAS(4)                                    0350 00305000
*     GEN(OI  CT+7,X'F0');                                 /*@Z427VLS*/ 00306000
         OI  CT+7,X'F0'                                                 00307000
*     NONBLANK = OFF;                                      /*@Z427VLS*/ 00308000
         NI    NONBLANK,B'01111111'                                0352 00309000
*     DO J = 1 BY 1 TO 9 ;                                 /*@Z427VLS*/ 00310000
         LA    @14,1                                               0353 00311000
         ST    @14,J                                               0353 00312000
@DL00353 DS    0H                                                  0354 00313000
*      IF CTARRAY(J) = CHARZERO                                    0354 00314000
*       THEN                                                       0354 00315000
         LA    @08,CTARRAY-1(@14)                                  0354 00316000
         CLI   0(@08),X'F0'                                        0354 00317000
         BNE   @RF00354                                            0354 00318000
*        CTARRAY(J) = BLANK;                               /*@Z427VLS*/ 00319000
         LA    @08,CTARRAY-1(@14)                                  0355 00320000
         MVI   0(@08),X'40'                                        0355 00321000
*       ELSE                                                       0356 00322000
*        NONBLANK = ON;                                    /*@Z427VLS*/ 00323000
         B     @RC00354                                            0356 00324000
@RF00354 OI    NONBLANK,B'10000000'                                0356 00325000
*     END;                                                 /*@Z427VLS*/ 00326000
@RC00354 LA    @14,1                                               0357 00327000
         AL    @14,J                                               0357 00328000
         ST    @14,J                                               0357 00329000
         C     @14,@CF00035                                        0357 00330000
         BNH   @DL00353                                            0357 00331000
*     MSGNO = 5;                                           /*@Z427VLS*/ 00332000
         MVC   MSGNO(4),@CF00079                                   0358 00333000
*     CALL ERRMSG;                                         /*@Z427VLS*/ 00334000
         BAL   @14,ERRMSG                                          0359 00335000
*    END;                                                  /*@Z427VLS*/ 00336000
*IF DEBUG11 = ON                                                   0361 00337000
* THEN                                                             0361 00338000
@RF00347 TM    DEBUG11(R2),B'00010000'                             0361 00339000
         BNO   @RF00361                                            0361 00340000
*  GEN(ABEND  420,DUMP);                                   /*@Z427VLS*/ 00341000
         ABEND  420,DUMP                                                00342000
*R15 = ERROR;                                              /*@Z427VLS*/ 00343000
@RF00361 L     R15,ERROR                                           0363 00344000
*RESPECIFY (R15) UNRESTRICTED;                             /*@Z427VLS*/ 00345000
*GETCORE: PROC; /* GET CORE FOR SORTABLE AND EVTABLE         @Z427VLS*/ 00346000
@EL00001 L     @13,4(,@13)                                         0365 00347000
@EF00001 DS    0H                                                  0365 00348000
@ER00001 L     @14,12(,@13)                                        0365 00349000
         LM    @00,@12,20(@13)                                     0365 00350000
         BR    @14                                                 0365 00351000
GETCORE  STM   @14,@12,@SA00002                                    0365 00352000
*RESPECIFY(R0,R1,R15)RESTRICTED;                           /*@Z427VLS*/ 00353000
*  R15 = ZERO;                                             /*@Z427VLS*/ 00354000
         SLR   R15,R15                                             0367 00355000
*          TABSIZE = TABSIZE + EVSIZE;                     /*@Z427VLS*/ 00356000
         LA    @14,104                                             0368 00357000
         AL    @14,TABSIZE(,R2)                                    0368 00358000
         ST    @14,TABSIZE(,R2)                                    0368 00359000
*          R0 =  TABSIZE; /*HELP COMPILER ACCESS TABSIZE     @Z427VLS*/ 00360000
         LR    R0,@14                                              0369 00361000
*          GEN(GETMAIN EC,LV=(R0),A=EVPTR1);               /*@Z427VLS*/ 00362000
         GETMAIN EC,LV=(R0),A=EVPTR1                                    00363000
*          ERROR = R15;                                    /*@0001VLS*/ 00364000
         ST    R15,ERROR                                           0371 00365000
*          IF R15  = ZERO THEN                                     0372 00366000
         LTR   R15,R15                                             0372 00367000
         BNZ   @RF00372                                            0372 00368000
*            DO;                                           /*@Z427VLS*/ 00369000
*              EVPTR = EVPTR1;                             /*@Z427VLS*/ 00370000
         L     @14,EVPTR1                                          0374 00371000
         ST    @14,EVPTR(,R2)                                      0374 00372000
*              SORTADR = EVPTR1 +  EVSIZE ;                /*@Z427VLS*/ 00373000
         LA    @08,104                                             0375 00374000
         LR    @06,@14                                             0375 00375000
         ALR   @06,@08                                             0375 00376000
         ST    @06,SORTADR(,R2)                                    0375 00377000
*              MAXENT =(TABSIZE- EVSIZE) / 10;             /*@Z427VLS*/ 00378000
         LR    @04,@08                                             0376 00379000
         LCR   @04,@04                                             0376 00380000
         AL    @04,TABSIZE(,R2)                                    0376 00381000
         SRDA  @04,32                                              0376 00382000
         D     @04,@CF00034                                        0376 00383000
         ST    @05,MAXENT                                          0376 00384000
*              EVTABLE = (EVTABLE && EVTABLE);/*EVNUM IMPLICITLY 0.*/   00385000
         XC    EVTABLE(102,@14),EVTABLE(@14)                       0377 00386000
*            END;                                          /*@Z427VLS*/ 00387000
*          ELSE                                                    0379 00388000
*            DO;                                           /*@Z427VLS*/ 00389000
         B     @RC00372                                            0379 00390000
@RF00372 DS    0H                                                  0380 00391000
*              MSGNO = 2;                                  /*@Z427VLS*/ 00392000
         MVC   MSGNO(4),@CF00074                                   0380 00393000
*              CALL ERRMSG;                                /*@Z427VLS*/ 00394000
         BAL   @14,ERRMSG                                          0381 00395000
*            END;                                          /*@Z427VLS*/ 00396000
*IF ERROR =  SUCCESS THEN/*  OTHER GETMAINS HAVE BEEN SUCCESSFULL*/     00397000
@RC00372 L     @14,ERROR                                           0383 00398000
         LTR   @14,@14                                             0383 00399000
         BNZ   @RF00383                                            0383 00400000
*  DO;                                                     /*@G51DGGB*/ 00401000
*    R0 = FRAMBENT * EVMAXENT;/* # OF ENTRIES * BYTES/ENTRY  @G51DGGB*/ 00402000
         LA    R0,384                                              0385 00403000
*    R0 = R0 + 4;           /*ADD FRAMENUM LENGTH            @G51DGGB*/ 00404000
         AL    R0,@CF00064                                         0386 00405000
*    GEN(GETMAIN EC,LV=(0),A=TEMP11,SP=21);                /*@G51DGGB*/ 00406000
         GETMAIN EC,LV=(0),A=TEMP11,SP=21                               00407000
*    FRAMEPTR = TEMP11;      /*SET IN THE ADDRESS OF THE TABLE*/   0388 00408000
         L     @14,TEMP11                                          0388 00409000
         ST    @14,FRAMEPTR(,R2)                                   0388 00410000
*    IF R15 = SUCCESS THEN   /*IF GETMAIN SUCCESSFULL        @G51DGGB*/ 00411000
         LTR   R15,R15                                             0389 00412000
         BNZ   @RF00389                                            0389 00413000
*      DO;                                                 /*@G51DGGB*/ 00414000
*        DO Y = 1 BY 1 TO EVMAXENT; /*CLEAR FRAMETAB TO ZERO @G51DGGB*/ 00415000
         LA    @14,1                                               0391 00416000
         ST    @14,Y                                               0391 00417000
@DL00391 DS    0H                                                  0392 00418000
*          FRAMEDTA(Y) = (FRAMEDTA(Y) && FRAMEDTA(Y));     /*@G51DGGB*/ 00419000
         LR    @08,@14                                             0392 00420000
         MH    @08,@CH00227                                        0392 00421000
         L     @06,FRAMEPTR(,R2)                                   0392 00422000
         ALR   @06,@08                                             0392 00423000
         AL    @06,@CF01618                                        0392 00424000
         XC    FRAMEDTA-4(24,@06),FRAMEDTA-4(@06)                  0392 00425000
*        END;                                              /*@G51DGGB*/ 00426000
         AL    @14,@CF00055                                        0393 00427000
         ST    @14,Y                                               0393 00428000
         C     @14,@CF00088                                        0393 00429000
         BNH   @DL00391                                            0393 00430000
*        FRAMENUM = ZERO;  /*SET NEW CORE TO ZERO            @G51DGGB*/ 00431000
         L     @14,FRAMEPTR(,R2)                                   0394 00432000
         SLR   @08,@08                                             0394 00433000
         ST    @08,FRAMENUM(,@14)                                  0394 00434000
*      END;                                                /*@G51DGGB*/ 00435000
*  ELSE  /*UNSUCCESSFULL GETMAIN                             @G51DGGB*/ 00436000
*    DO;                                                   /*@G51DGGB*/ 00437000
         B     @RC00389                                            0396 00438000
@RF00389 DS    0H                                                  0397 00439000
*      R15 = TWELVE;  /*DONT CONTINUE RETURN CODE            @G51DGGB*/ 00440000
         LA    R15,12                                              0397 00441000
*      MSGNO = XX;   /*ERROR MESSAGE NUMBER                  @G51DGGB*/ 00442000
         MVC   MSGNO(4),@CF00081                                   0398 00443000
*      CALL ERRMSG;  /*PRINT ERROR MESSAGE                   @G51DGGB*/ 00444000
         BAL   @14,ERRMSG                                          0399 00445000
*    END;                                                  /*@G51DGGB*/ 00446000
* END; /*END OF FRAMETAB GETMAIN                             @G51DGGB*/ 00447000
*DCL EVPTR1 FIXED(31) INIT(0);                             /*@Z427VLS*/ 00448000
*RESPECIFY(R0,R1,R15) UNRESTRICTED;                        /*@Z427VLS*/ 00449000
*END;                                                      /*@Z427VLS*/ 00450000
@EL00002 DS    0H                                                  0404 00451000
@EF00002 DS    0H                                                  0404 00452000
@ER00002 LM    @14,@12,@SA00002                                    0404 00453000
         BR    @14                                                 0404 00454000
*HEXDUMP: PROC; /*HEXDUMP THE CURRENT RECORD                 @0099VLS*/ 00455000
HEXDUMP  STM   @14,@12,@SA00003                                    0405 00456000
* NUMBER = 66;                    /*SET UP FOR 132 BYTES/LINE    */     00457000
         LA    @08,66                                              0406 00458000
         ST    @08,NUMBER                                          0406 00459000
* ADDNXT = ADDR(PRINTBDY);        /*ADDRESS OF WHERE TO PUT THE DATA*/  00460000
         LA    @06,PRINTBDY                                        0407 00461000
         ST    @06,ADDNXT                                          0407 00462000
* DO M = 66 BY 66 TO RECLNGTH;    /*DO ENTIRE RECORD         @0099VLS*/ 00463000
         ST    @08,M                                               0408 00464000
         B     @DE00408                                            0408 00465000
@DL00408 DS    0H                                                  0409 00466000
*  CALL CONVERT;/*GO CONVERT THE RECORD TO PRINTABLE         @0099VLS*/ 00467000
         BAL   @14,CONVERT                                         0409 00468000
*  NEXTBY = NEXTBY + 66;      /*MOVE TO THE NEXT 66 BYTES    @0099VLS*/ 00469000
         LA    @08,66                                              0410 00470000
         AL    @08,NEXTBY                                          0410 00471000
         ST    @08,NEXTBY                                          0410 00472000
*  CALL PRINTIT;                /*GO AND PRINT THE LINE      @0099VLS*/ 00473000
         BAL   @14,PRINTIT                                         0411 00474000
* END;                                                     /*@0099VLS*/ 00475000
         LA    @08,66                                              0412 00476000
         AL    @08,M                                               0412 00477000
         ST    @08,M                                               0412 00478000
@DE00408 CH    @08,RECLNGTH(,R2)                                   0412 00479000
         BNH   @DL00408                                            0412 00480000
* NUMBER = RECLNGTH - (M - 66); /*SEE IF ANY BYTES LEFT      @0099VLS*/ 00481000
         L     @08,M                                               0413 00482000
         SL    @08,@CF01439                                        0413 00483000
         LCR   @08,@08                                             0413 00484000
         AH    @08,RECLNGTH(,R2)                                   0413 00485000
         ST    @08,NUMBER                                          0413 00486000
* IF NUMBER > ZERO THEN         /*IF ANY BYTES LEFT PRINT THEM    */    00487000
         LTR   @08,@08                                             0414 00488000
         BNP   @RF00414                                            0414 00489000
*  DO;                                                     /*@0099VLS*/ 00490000
*   CALL CONVERT;              /*GO AND CONVERT THE REST OF BYTES */    00491000
         BAL   @14,CONVERT                                         0416 00492000
*   CALL PRINTIT;             /*GO PRINT THE DATA LINE       @0099VLS*/ 00493000
         BAL   @14,PRINTIT                                         0417 00494000
*  END;                                                    /*@0099VLS*/ 00495000
* END;                                                     /*@0099VLS*/ 00496000
@EL00003 DS    0H                                                  0419 00497000
@EF00003 DS    0H                                                  0419 00498000
@ER00003 LM    @14,@12,@SA00003                                    0419 00499000
         BR    @14                                                 0419 00500000
*/********************************************************************/ 00501000
*/*      THIS PROC WILL DETERMINE IF THE RECORD HAS A VOLID ASSOC */    00502000
*/*      WITH THIS RECORD(BY DEVICE) KEEP TRACK  OF THE # OF SAMPLES*/  00503000
*/*      (DEBUG16) AND THEN DETERMINE IF THE VOLID MATCHES THE ONE(S)*/ 00504000
*/*      IN THE COMM TABLE BUILT BY IFCEPARM                 @0099VLS*/ 00505000
*VOLID:  PROC;                                             /*@0099VLS*/ 00506000
VOLID    STM   @14,@12,@SA00004                                    0420 00507000
*PASSFLAG = NO;                                            /*@0099VLS*/ 00508000
         NI    PASSFLAG(R2),B'11111110'                            0421 00509000
*VOLFLAG = ZERO;                      /*SET UP FOR NOT FOUND @0099VLS*/ 00510000
         SLR   @08,@08                                             0422 00511000
         STH   @08,VOLFLAG                                         0422 00512000
*SPCCOUNT = SPCCOUNT + ONE;  /*COUNT OF RECORDS PROCESSED BY THIS PRO*/ 00513000
         LA    @08,1                                               0423 00514000
         AL    @08,SPCCOUNT                                        0423 00515000
         ST    @08,SPCCOUNT                                        0423 00516000
*/*    FIRST TEST FOR MDR RECORDS THEN OBR USE VOLFLAG AS A FLAG*/ 0424 00517000
*/*    TO INDICATE A RECORD WITH A VOLID & AN INDEX FOR DEBUG16   */    00518000
*/*    IF NEITHER O OR T THEN MUST BE A DDR WITH VOILD IN 2 PLACES*/    00519000
*IF RTYP1 = NINE THEN                 /*IS IT AN MDR RECORD  @0099VLS*/ 00520000
         CLC   RTYP1(4),@CF00035                                   0424 00521000
         BNE   @RF00424                                            0424 00522000
* DO;                                                      /*@0099VLS*/ 00523000
* IF TPRDEV = '01'X | TPRDEV = '09'X | TPRDEV = '11'X |            0426 00524000
*    TPRDEV = '0A'X THEN                                           0426 00525000
         CLI   TPRDEV(R7),X'01'                                    0426 00526000
         BE    @RT00426                                            0426 00527000
         CLI   TPRDEV(R7),X'09'                                    0426 00528000
         BE    @RT00426                                            0426 00529000
         CLI   TPRDEV(R7),X'11'                                    0426 00530000
         BE    @RT00426                                            0426 00531000
         CLI   TPRDEV(R7),X'0A'                                    0426 00532000
         BNE   @RF00426                                            0426 00533000
@RT00426 DS    0H                                                  0427 00534000
*  VOLFLAG = 1;                                            /*@0099VLS*/ 00535000
         MVC   VOLFLAG(2),@CH00055                                 0427 00536000
* END;                                                     /*@0099VLS*/ 00537000
* ELSE                                                             0429 00538000
* IF RTYP1 = THREE THEN               /*IS IT AN OBR RECORD  @0099VLS*/ 00539000
         B     @RC00424                                            0429 00540000
@RF00424 CLC   RTYP1(4),@CF00076                                   0429 00541000
         BNE   @RF00429                                            0429 00542000
*  DO;                                                     /*@0099VLS*/ 00543000
* IF OBRCLASS = '20'X THEN                                         0431 00544000
         CLI   OBRCLASS(R7),X'20'                                  0431 00545000
         BNE   @RF00431                                            0431 00546000
*  VOLFLAG = 2;                                            /*@0099VLS*/ 00547000
         MVC   VOLFLAG(2),@CH00074                                 0432 00548000
* ELSE                                                             0433 00549000
*  IF OBRCLASS = '80'X THEN                                        0433 00550000
         B     @RC00431                                            0433 00551000
@RF00431 CLI   OBRCLASS(R7),X'80'                                  0433 00552000
         BNE   @RF00433                                            0433 00553000
*   VOLFLAG = 3;                                           /*@0099VLS*/ 00554000
         MVC   VOLFLAG(2),@CH00076                                 0434 00555000
*  ELSE                                                            0435 00556000
*   IF OBRDEV = '0844'X | OBRDEV = '0843'X THEN                    0435 00557000
         B     @RC00433                                            0435 00558000
@RF00433 CLC   OBRDEV(2,R7),@CB01447                               0435 00559000
         BE    @RT00435                                            0435 00560000
         CLC   OBRDEV(2,R7),@CB01448                               0435 00561000
         BNE   @RF00435                                            0435 00562000
@RT00435 DS    0H                                                  0436 00563000
*    VOLFLAG = 2;                                          /*@0099VLS*/ 00564000
         MVC   VOLFLAG(2),@CH00074                                 0436 00565000
*  END;                                                    /*@0099VLS*/ 00566000
*     ELSE                                                         0438 00567000
*    VOLFLAG = 4;  /*FOR A DDR RECORD                        @0099VLS*/ 00568000
         B     @RC00429                                            0438 00569000
@RF00429 MVC   VOLFLAG(2),@CH00064                                 0438 00570000
*IF VOLFLAG ^= ZERO THEN              /*DID WE HAVE ANY MATCH*/    0439 00571000
@RC00429 DS    0H                                                  0439 00572000
@RC00424 LH    @08,VOLFLAG                                         0439 00573000
         LTR   @08,@08                                             0439 00574000
         BZ    @RF00439                                            0439 00575000
* DO;                                                      /*@0099VLS*/ 00576000
*  NOTYPECT = ON;                     /*TELL WORLD WE FOUND SOMEONE*/   00577000
         OI    NOTYPECT,B'00001000'                                0441 00578000
*  VOLCOUNT(VOLFLAG) = VOLCOUNT(VOLFLAG) + ONE; /*ONES FOUND @0099VLS*/ 00579000
         SLA   @08,2                                               0442 00580000
         LA    @06,1                                               0442 00581000
         AL    @06,VOLCOUNT-4(@08)                                 0442 00582000
         ST    @06,VOLCOUNT-4(@08)                                 0442 00583000
*  CALL VOLSEL;                       /*SEE IF REC IS ANY GOOD*/   0443 00584000
         BAL   @14,VOLSEL                                          0443 00585000
*  IF PASSFLAG = YES THEN             /*ALLOW RECORD TO PASS @0099VLS*/ 00586000
         TM    PASSFLAG(R2),B'00000001'                            0444 00587000
         BNO   @RF00444                                            0444 00588000
*   VOLPASS(VOLFLAG) = VOLPASS(VOLFLAG) + ONE; /*ONES THAT FAIL*/  0445 00589000
         LH    @08,VOLFLAG                                         0445 00590000
         SLA   @08,2                                               0445 00591000
         LA    @06,1                                               0445 00592000
         AL    @06,VOLPASS-4(@08)                                  0445 00593000
         ST    @06,VOLPASS-4(@08)                                  0445 00594000
* END;                                                     /*@0099VLS*/ 00595000
*END;/*END OF VOL PROC                                       @0099VLS*/ 00596000
@EL00004 DS    0H                                                  0447 00597000
@EF00004 DS    0H                                                  0447 00598000
@ER00004 LM    @14,@12,@SA00004                                    0447 00599000
         BR    @14                                                 0447 00600000
*/*******************************************************************/  00601000
*/*    THIS PROC WILL COMPARE THE COMM TABLE VOLID WITH THE ONE IN  */  00602000
*/*    THE RECORD FOR DDR HAS TO CHECK IN 2 PLACES           @0099VLS*/ 00603000
*VOLSEL: PROC;  /*DETERMINE IF RECORD MATCHES SELECTED VOLID @0099VLS*/ 00604000
VOLSEL   STM   @14,@12,12(@13)                                     0448 00605000
* VOLOK = NO;                     /*FLAG TO CONTROL LOOP     @0099VLS*/ 00606000
         NI    VOLOK,B'11111110'                                   0449 00607000
* PASSFLAG = NO;                  /*ASSUME WILL FAIL         @0099VLS*/ 00608000
         NI    PASSFLAG(R2),B'11111110'                            0450 00609000
* IF RTYP1 = SIX THEN             /*IS AN DDR TYPE RECORD    @0099VLS*/ 00610000
         CLC   RTYP1(4),@CF00081                                   0451 00611000
         BNE   @RF00451                                            0451 00612000
*  DO J = 1 BY 1 TO VOLNUM WHILE(VOLOK = NO);              /*@0099VLS*/ 00613000
         LA    @08,1                                               0452 00614000
         ST    @08,J                                               0452 00615000
         B     @DE00452                                            0452 00616000
@DL00452 TM    VOLOK,B'00000001'                                   0452 00617000
         BNZ   @DC00452                                            0452 00618000
*   IF VOLVAL(J) = DDRVOL1 | VOLVAL(J) = DDRVOL2 THEN              0453 00619000
         MH    @08,@CH00081                                        0453 00620000
         L     @06,VOLPTR(,R2)                                     0453 00621000
         ST    @08,@TF00001                                        0453 00622000
         ALR   @08,@06                                             0453 00623000
         AL    @08,@CF01620                                        0453 00624000
         CLC   VOLVAL-2(6,@08),DDRVOL1(R7)                         0453 00625000
         BE    @RT00453                                            0453 00626000
         AL    @06,@TF00001                                        0453 00627000
         AL    @06,@CF01620                                        0453 00628000
         CLC   VOLVAL-2(6,@06),DDRVOL2(R7)                         0453 00629000
         BNE   @RF00453                                            0453 00630000
@RT00453 DS    0H                                                  0454 00631000
*    VOLOK = YES;                                          /*@0099VLS*/ 00632000
         OI    VOLOK,B'00000001'                                   0454 00633000
*  END;                                                    /*@0099VLS*/ 00634000
@RF00453 LA    @08,1                                               0455 00635000
         AL    @08,J                                               0455 00636000
         ST    @08,J                                               0455 00637000
@DE00452 L     @06,VOLPTR(,R2)                                     0455 00638000
         CH    @08,VOLNUM(,@06)                                    0455 00639000
         BNH   @DL00452                                            0455 00640000
@DC00452 DS    0H                                                  0456 00641000
* ELSE                                                             0456 00642000
* DO;                                                      /*@0099VLS*/ 00643000
         B     @RC00451                                            0456 00644000
@RF00451 DS    0H                                                  0457 00645000
* IF RTYP1 = NINE THEN             /*RECORD IS AN MDR        @0099VLS*/ 00646000
         CLC   RTYP1(4),@CF00035                                   0457 00647000
         BNE   @RF00457                                            0457 00648000
*   VOLCOMP = TPRVOL;                                      /*@0099VLS*/ 00649000
         MVC   VOLCOMP(6),TPRVOL(R7)                               0458 00650000
*  ELSE                                                            0459 00651000
*   VOLCOMP = OBRVOL ;   /*HAS T BE AN OBR RECORD            @0099VLS*/ 00652000
         B     @RC00457                                            0459 00653000
@RF00457 MVC   VOLCOMP(6),OBRVOL(R7)                               0459 00654000
* DO J = 1 BY 1 TO VOLNUM WHILE (VOLOK = NO);              /*@0099VLS*/ 00655000
@RC00457 LA    @08,1                                               0460 00656000
         ST    @08,J                                               0460 00657000
         B     @DE00460                                            0460 00658000
@DL00460 TM    VOLOK,B'00000001'                                   0460 00659000
         BNZ   @DC00460                                            0460 00660000
*  IF VOLVAL(J) = VOLCOMP THEN                                     0461 00661000
         MH    @08,@CH00081                                        0461 00662000
         L     @06,VOLPTR(,R2)                                     0461 00663000
         ALR   @06,@08                                             0461 00664000
         AL    @06,@CF01620                                        0461 00665000
         CLC   VOLVAL-2(6,@06),VOLCOMP                             0461 00666000
         BNE   @RF00461                                            0461 00667000
*     VOLOK = YES;                                         /*@0099VLS*/ 00668000
         OI    VOLOK,B'00000001'                                   0462 00669000
* END;                                                     /*@0099VLS*/ 00670000
@RF00461 LA    @08,1                                               0463 00671000
         AL    @08,J                                               0463 00672000
         ST    @08,J                                               0463 00673000
@DE00460 L     @06,VOLPTR(,R2)                                     0463 00674000
         CH    @08,VOLNUM(,@06)                                    0463 00675000
         BNH   @DL00460                                            0463 00676000
@DC00460 DS    0H                                                  0464 00677000
* END;                                                     /*@0099VLS*/ 00678000
* IF VOLOK = YES                                                   0465 00679000
*  THEN                                                            0465 00680000
@RC00451 TM    VOLOK,B'00000001'                                   0465 00681000
         BNO   @RF00465                                            0465 00682000
*   PASSFLAG = YES;               /*SET FLAG TO ACCEPT THE RECORD*/     00683000
         OI    PASSFLAG(R2),B'00000001'                            0466 00684000
*END;  /*END OF VOLSEL PROC                                  @0099VLS*/ 00685000
@EL00005 DS    0H                                                  0467 00686000
@EF00005 DS    0H                                                  0467 00687000
@ER00005 LM    @14,@12,12(@13)                                     0467 00688000
         BR    @14                                                 0467 00689000
*/******************************************************************/   00690000
*/*    THIS PROC WILL SELECT RECORDS BY TERMINAL NAME        @0099VLS*/ 00691000
*TERMID:  PROC;                                            /*@0099VLS*/ 00692000
TERMID   STM   @14,@12,12(@13)                                     0468 00693000
* OBRFLAG = ZERO;                 /*SET FLAG TO NO PASS      @0099VLS*/ 00694000
         SLR   @08,@08                                             0469 00695000
         STH   @08,OBRFLAG                                         0469 00696000
* PASSFLAG = NO ;                 /*ASSUME THAT THE RECORD WILL FAIL*/  00697000
         NI    PASSFLAG(R2),B'11111110'                            0470 00698000
* IF LRTKEY1 = OBRVTAM THEN                                        0471 00699000
         CLI   LRTKEY1(R7),X'36'                                   0471 00700000
         BNE   @RF00471                                            0471 00701000
*   OBRFLAG = ONE;                /*INDEX TO REFLECT    VTAM REC */     00702000
         MVC   OBRFLAG(2),@CH00055                                 0472 00703000
*  ELSE                                                            0473 00704000
*  IF LRTKEY1 = OBRCONV & OBRTCAM = TCAMYES THEN                   0473 00705000
         B     @RC00471                                            0473 00706000
@RF00471 CLI   LRTKEY1(R7),X'32'                                   0473 00707000
         BNE   @RF00473                                            0473 00708000
         CLI   OBRTCAM(R7),X'0F'                                   0473 00709000
         BNE   @RF00473                                            0473 00710000
*    OBRFLAG = TWO;               /*SET THE INDEX TO CONV TYPE    */    00711000
         MVC   OBRFLAG(2),@CH00074                                 0474 00712000
*   ELSE                                                           0475 00713000
*    IF LRTKEY1 = OBRTCM & OBRTCAM = TCAMYES THEN                  0475 00714000
         B     @RC00473                                            0475 00715000
@RF00473 CLI   LRTKEY1(R7),X'34'                                   0475 00716000
         BNE   @RF00475                                            0475 00717000
         CLI   OBRTCAM(R7),X'0F'                                   0475 00718000
         BNE   @RF00475                                            0475 00719000
*      OBRFLAG = THREE ;          /*SET THE INDEX TO A TCAM TYPE  */    00720000
         MVC   OBRFLAG(2),@CH00076                                 0476 00721000
* IF OBRFLAG ^= ZERO THEN         /*MUST HAVE THE CORRECT TERM NAME*/   00722000
@RF00475 DS    0H                                                  0477 00723000
@RC00473 DS    0H                                                  0477 00724000
@RC00471 LH    @08,OBRFLAG                                         0477 00725000
         LTR   @08,@08                                             0477 00726000
         BZ    @RF00477                                            0477 00727000
*  DO;                                                     /*@0099VLS*/ 00728000
*   PASSFLAG = NO;                /*ASSUME WILL NOT MAKE IT  @0099VLS*/ 00729000
         NI    PASSFLAG(R2),B'11111110'                            0479 00730000
*   TERMTYPE(OBRFLAG) = TERMTYPE(OBRFLAG) + ONE;           /*@0099VLS*/ 00731000
         SLA   @08,2                                               0480 00732000
         LA    @06,1                                               0480 00733000
         L     @03,TERMTYPE-4(@08)                                 0480 00734000
         ALR   @03,@06                                             0480 00735000
         ST    @03,TERMTYPE-4(@08)                                 0480 00736000
*   IF  TERM  = OBRTERMN THEN                                      0481 00737000
         CLC   TERM(8,R2),OBRTERMN(R7)                             0481 00738000
         BNE   @RF00481                                            0481 00739000
*    DO;                                                   /*@0099VLS*/ 00740000
*     PASSFLAG = YES;             /*ALLOW RECORD TO PASS     @0099VLS*/ 00741000
         OI    PASSFLAG(R2),B'00000001'                            0483 00742000
*     TERMKEPT(OBRFLAG) = TERMKEPT(OBRFLAG) + ONE;         /*@0099VLS*/ 00743000
         AL    @06,TERMKEPT-4(@08)                                 0484 00744000
         ST    @06,TERMKEPT-4(@08)                                 0484 00745000
*    END;                                                  /*@0099VLS*/ 00746000
*  END;                                                    /*@0099VLS*/ 00747000
*END;                                                      /*@0099VLS*/ 00748000
@EL00006 DS    0H                                                  0487 00749000
@EF00006 DS    0H                                                  0487 00750000
@ER00006 LM    @14,@12,12(@13)                                     0487 00751000
         BR    @14                                                 0487 00752000
*/****************************************************************/     00753000
*/*   THIS PROC WILL SELECT RECORDS BY CPU IF REQUESTED      @0099VLS*/ 00754000
*/*                                                          @0099VLS*/ 00755000
*CPUSELCT: PROC;  /*SELECT RECORD IF CORRECT CPU             @0099VLS*/ 00756000
CPUSELCT STM   @14,@12,12(@13)                                     0488 00757000
* PASSFLAG = OFF;                 /*ASSUME IT WILL FAIL      @0099VLS*/ 00758000
         NI    PASSFLAG(R2),B'11111110'                            0489 00759000
* DO P = 1 BY 1 TO CPUNUM WHILE(PASSFLAG = OFF);           /*@0099VLS*/ 00760000
         LA    @08,1                                               0490 00761000
         ST    @08,P                                               0490 00762000
         B     @DE00490                                            0490 00763000
@DL00490 TM    PASSFLAG(R2),B'00000001'                            0490 00764000
         BNZ   @DC00490                                            0490 00765000
*  IF CPUVAL(P) = LRTCPMOD  THEN  /*DOES IT MATCH INPUT PARM DATA*/     00766000
         MH    @08,@CH00079                                        0491 00767000
         L     @06,CPUPTR(,R2)                                     0491 00768000
         ALR   @06,@08                                             0491 00769000
         AL    @06,@CF01621                                        0491 00770000
         CLC   CPUVAL-2(5,@06),LRTCPMOD(R7)                        0491 00771000
         BNE   @RF00491                                            0491 00772000
*    DO;                                                   /*@0099VLS*/ 00773000
*    PASSFLAG = YES;              /*SET FLAG TO ACCEPT THE RECORD*/     00774000
         OI    PASSFLAG(R2),B'00000001'                            0493 00775000
*    CPUOUT(RTYP1) = CPUOUT(RTYP1) + ONE;  /*ADD TO THE COUNT OF THIS*/ 00776000
         L     @08,RTYP1                                           0494 00777000
         SLA   @08,2                                               0494 00778000
         LA    @06,1                                               0494 00779000
         AL    @06,CPUOUT-4(@08)                                   0494 00780000
         ST    @06,CPUOUT-4(@08)                                   0494 00781000
*/* # OF GOOD RECORDS                                        @0099VLS*/ 00782000
*    END;                                                  /*@0099VLS*/ 00783000
*    ELSE                                                          0496 00784000
*    CPUIN(RTYP1) = CPUIN(RTYP1) + ONE;  /*ADD TO THE COUNT OF THIS*/   00785000
         B     @RC00491                                            0496 00786000
@RF00491 L     @08,RTYP1                                           0496 00787000
         SLA   @08,2                                               0496 00788000
         LA    @06,1                                               0496 00789000
         AL    @06,CPUIN-4(@08)                                    0496 00790000
         ST    @06,CPUIN-4(@08)                                    0496 00791000
*/* # OF ONES THAT FAILED                                    @0099VLS*/ 00792000
*  END;                                                    /*@0099VLS*/ 00793000
@RC00491 LA    @08,1                                               0497 00794000
         AL    @08,P                                               0497 00795000
         ST    @08,P                                               0497 00796000
@DE00490 L     @06,CPUPTR(,R2)                                     0497 00797000
         CH    @08,CPUNUM(,@06)                                    0497 00798000
         BNH   @DL00490                                            0497 00799000
@DC00490 DS    0H                                                  0498 00800000
* END;                                                     /*@0099VLS*/ 00801000
@EL00007 DS    0H                                                  0498 00802000
@EF00007 DS    0H                                                  0498 00803000
@ER00007 LM    @14,@12,12(@13)                                     0498 00804000
         BR    @14                                                 0498 00805000
*ENDOFILE: PROC; /*SORT SORTABLE, EVTABLE AND SET R.C. FOR EREP1*/ 0499 00806000
ENDOFILE STM   @14,@12,@SA00008                                    0499 00807000
*RESPECIFY (R0,R15) RESTRICTED;                            /*@G51DGGB*/ 00808000
*R15 = ERROR; /*GET ERROR STATUS FROM MAIN PROC              @Z427VLS*/ 00809000
         L     R15,ERROR                                           0501 00810000
*CLOSEIO = CLOSEIO && CLOSEIO;     /*CLEAR AREA TO AVOID PROBLEMS  */   00811000
         XC    CLOSEIO(2,R2),CLOSEIO(R2)                           0502 00812000
*IF R15 = OVERFLOW & PHIST = ON THEN /*DROP BUFFERS FOR ACCIN      */   00813000
         C     R15,@CF00066                                        0503 00814000
         BNE   @RF00503                                            0503 00815000
         TM    PHIST(R2),B'00100000'                               0503 00816000
         BNO   @RF00503                                            0503 00817000
*  CACCIN = ON;                                            /*@Z427VLS*/ 00818000
         OI    CACCIN(R2),B'00010000'                              0504 00819000
*  IF ERROR = OVERFLOW | ERROR = ENDFILE THEN                      0505 00820000
@RF00503 L     @14,ERROR                                           0505 00821000
         C     @14,@CF00066                                        0505 00822000
         BE    @RT00505                                            0505 00823000
         C     @14,@CF00064                                        0505 00824000
         BNE   @RF00505                                            0505 00825000
@RT00505 DS    0H                                                  0506 00826000
* DO;                                                      /*@Z427VLS*/ 00827000
*  ERROR = ZERO;               /*RESET THE ERROR INDICATOR   @Z427VLS*/ 00828000
         SLR   @14,@14                                             0507 00829000
         ST    @14,ERROR                                           0507 00830000
*    R15 = ZERO;                                           /*@0099VLS*/ 00831000
         SLR   R15,R15                                             0508 00832000
* END;                                                     /*@Z427VLS*/ 00833000
*  IF MAXENT < I & ERROR ^= ENDFILE THEN                           0510 00834000
@RF00505 L     @14,MAXENT                                          0510 00835000
         C     @14,I                                               0510 00836000
         BNL   @RF00510                                            0510 00837000
         CLC   ERROR(4),@CF00064                                   0510 00838000
         BE    @RF00510                                            0510 00839000
*  DO;             /*WORLD,DONT TELL EREP1, DONT LET LOGREC BE*/   0511 00840000
*    ZEROALL = NO;       /*RESET.                            @Z427VLS*/ 00841000
         NI    ZEROALL(R2),B'10111111'                             0512 00842000
*    MSGNO = 3;                                            /*@Z427VLS*/ 00843000
         MVC   MSGNO(4),@CF00076                                   0513 00844000
*    IF PHIST = ON THEN                                            0514 00845000
         TM    PHIST(R2),B'00100000'                               0514 00846000
         BNO   @RF00514                                            0514 00847000
*     CACCIN = ON;                                         /*@Z427VLS*/ 00848000
         OI    CACCIN(R2),B'00010000'                              0515 00849000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 00850000
@RF00514 BAL   @14,ERRMSG                                          0516 00851000
*  ERROR = ZERO;                                           /*@Z427VLS*/ 00852000
         SLR   @14,@14                                             0517 00853000
         ST    @14,ERROR                                           0517 00854000
*  END;                                                    /*@Z427VLS*/ 00855000
* IF CLOSEIO ^= '0000'X THEN                                       0519 00856000
@RF00510 CLC   CLOSEIO(2,R2),@CB00208                              0519 00857000
         BE    @RF00519                                            0519 00858000
*   CALL IOHND(IOCLOSE);                                   /*@G51DGBB*/ 00859000
         L     @15,ADIOHND(,R2)                                    0520 00860000
         LA    @01,@AL00520                                        0520 00861000
         BALR  @14,@15                                             0520 00862000
*IF PHIST = ON THEN                                                0521 00863000
@RF00519 TM    PHIST(R2),B'00100000'                               0521 00864000
         BNO   @RF00521                                            0521 00865000
* DO;                                                      /*@G51DGGB*/ 00866000
*  CLOSEIO = CLOSEIO && CLOSEIO;  /*MAKE SURE ALL CLOSE FLAGS ARE 0*/   00867000
         XC    CLOSEIO(2,R2),CLOSEIO(R2)                           0523 00868000
*  CDRCTWRK = ON;       /*CLOSE DIRECTWK FOR WRITE SO CAN READ*/   0524 00869000
         OI    CDRCTWRK(R2),B'00000010'                            0524 00870000
*  CALL IOHND(IOCLOSE); /*ASK I/O TO CLOSE THE DATA SET      @G51DGGB*/ 00871000
         L     @15,ADIOHND(,R2)                                    0525 00872000
         LA    @01,@AL00525                                        0525 00873000
         BALR  @14,@15                                             0525 00874000
* END;                                                     /*@G51DGGB*/ 00875000
*IF ERROR < TWELVE  & FRAMEPTR ^= 0 &                              0527 00876000
* (PACC = YES & FRAMENUM > ZERO)THEN /* IF ACCUMULATION AND FRAMES*/    00877000
@RF00521 L     @14,ERROR                                           0527 00878000
         C     @14,@CF00032                                        0527 00879000
         BNL   @RF00527                                            0527 00880000
         SLR   @14,@14                                             0527 00881000
         L     @08,FRAMEPTR(,R2)                                   0527 00882000
         CR    @08,@14                                             0527 00883000
         BE    @RF00527                                            0527 00884000
         TM    PACC(R2),B'01000000'                                0527 00885000
         BNO   @RF00527                                            0527 00886000
         C     @14,FRAMENUM(,@08)                                  0527 00887000
         BNL   @RF00527                                            0527 00888000
*     CALL WRITEFRM;             /*GO WRITE TO ACCDEV        @G51DGGB*/ 00889000
         BAL   @14,WRITEFRM                                        0528 00890000
*     ELSE                                                         0529 00891000
*      IF ERROR  < TWELVE &   DEBUG46 = ON & FRAMENUM ^= 0 THEN    0529 00892000
         B     @RC00527                                            0529 00893000
@RF00527 L     @14,ERROR                                           0529 00894000
         C     @14,@CF00032                                        0529 00895000
         BNL   @RF00529                                            0529 00896000
         TM    DEBUG46(R2),B'00000010'                             0529 00897000
         BNO   @RF00529                                            0529 00898000
         L     @01,FRAMEPTR(,R2)                                   0529 00899000
         L     @14,FRAMENUM(,@01)                                  0529 00900000
         LTR   @14,@14                                             0529 00901000
         BZ    @RF00529                                            0529 00902000
*             CALL WRITEFRM;    /*ADD KEPT FRAMES TO SORT TABLE*/  0530 00903000
         BAL   @14,WRITEFRM                                        0530 00904000
*IF DEBUG16 = ON THEN                                              0531 00905000
@RF00529 DS    0H                                                  0531 00906000
@RC00527 TM    DEBUG16(R2),B'10000000'                             0531 00907000
         BNO   @RF00531                                            0531 00908000
* DO;                                                      /*@0099VLS*/ 00909000
*CALL IFCMSG(83,ADDR(PRINTBDY));                           /*@G51DGGB*/ 00910000
         LA    @14,PRINTBDY                                        0533 00911000
         ST    @14,@AFTEMPS                                        0533 00912000
         L     @15,ADIFCMSG(,R2)                                   0533 00913000
         LA    @01,@AL00533                                        0533 00914000
         BALR  @14,@15                                             0533 00915000
* GEN(MVC PRINTBDY(7),BUGS16);                             /*@0099VLS*/ 00916000
         MVC PRINTBDY(7),BUGS16                                         00917000
*BINWORD = NUMREC;                                         /*@G51DGGB*/ 00918000
         L     @14,NUMREC                                          0535 00919000
         ST    @14,BINWORD                                         0535 00920000
*DECADDR = ADDR(EDIFILD);                                  /*@G51DGGB*/ 00921000
         LA    @14,EDIFILD                                         0536 00922000
         ST    @14,DECADDR                                         0536 00923000
*CALL CONVBIN;                                             /*@G51DGGB*/ 00924000
         BAL   @14,CONVBIN                                         0537 00925000
*CALL PRINTIT;                                             /*@G51DGGB*/ 00926000
         BAL   @14,PRINTIT                                         0538 00927000
* END;                                                     /*@0099VLS*/ 00928000
*SORTNUM = PASSNUM;   /*SET THE NUMBER OF RECORDS THAT PASSED*/    0540 00929000
@RF00531 L     @14,PASSNUM                                         0540 00930000
         ST    @14,SORTNUM(,R2)                                    0540 00931000
*CALL IFCMSG(54,ADDR(PRINTBDY));                           /*@G51DGGB*/ 00932000
         LA    @14,PRINTBDY                                        0541 00933000
         ST    @14,@AFTEMPS                                        0541 00934000
         L     @15,ADIFCMSG(,R2)                                   0541 00935000
         LA    @01,@AL00541                                        0541 00936000
         BALR  @14,@15                                             0541 00937000
* DECADDR = ADDR(EDIFILD);                                 /*@0099VLS*/ 00938000
         LA    @14,EDIFILD                                         0542 00939000
         ST    @14,DECADDR                                         0542 00940000
*BINWORD = PASSNUM;           /*PICK UP NUMBER OF RECORDS READ*/   0543 00941000
         L     @14,PASSNUM                                         0543 00942000
         ST    @14,BINWORD                                         0543 00943000
*CALL CONVBIN;                /*CONVERT # RECORDS READ TO PRINTABLE*/   00944000
         BAL   @14,CONVBIN                                         0544 00945000
*CALL PRINTIT;                                             /*@G51DGGB*/ 00946000
         BAL   @14,PRINTIT                                         0545 00947000
*CLOSEIO = CLOSEIO && CLOSEIO;                             /*@G51DGGB*/ 00948000
         XC    CLOSEIO(2,R2),CLOSEIO(R2)                           0546 00949000
*IF PACC = YES THEN  /*IF WROTE RECORDS TO ACCDEV, THEN BETTER CLOSE*/  00950000
         TM    PACC(R2),B'01000000'                                0547 00951000
         BNO   @RF00547                                            0547 00952000
*   CACCDEV  = ON;                                         /*@Z427VLS*/ 00953000
         OI    CACCDEV(R2),B'00001000'                             0548 00954000
*IF PACC = ON THEN                                                 0549 00955000
@RF00547 TM    PACC(R2),B'01000000'                                0549 00956000
         BNO   @RF00549                                            0549 00957000
* CALL IOHND(IOCLOSE);                                     /*@G51DGGB*/ 00958000
         L     @15,ADIOHND(,R2)                                    0550 00959000
         LA    @01,@AL00550                                        0550 00960000
         BALR  @14,@15                                             0550 00961000
*IF TRUNCT ^= ZERO THEN        /*DID WE DROP ANY TRUNCATED RECORDS  */  00962000
@RF00549 L     @14,TRUNCT                                          0551 00963000
         LTR   @14,@14                                             0551 00964000
         BZ    @RF00551                                            0551 00965000
* DO;                                                      /*@Z427VLS*/ 00966000
*  CALL IFCMSG(56,ADDR(PRINTBDY));                         /*@Z427VLS*/ 00967000
         LA    @14,PRINTBDY                                        0553 00968000
         ST    @14,@AFTEMPS                                        0553 00969000
         L     @15,ADIFCMSG(,R2)                                   0553 00970000
         LA    @01,@AL00553                                        0553 00971000
         BALR  @14,@15                                             0553 00972000
*  BINWORD = TRUNCT;        /*LOAD # OF RECORDS FAILED FOR CONVERT  */  00973000
         L     @14,TRUNCT                                          0554 00974000
         ST    @14,BINWORD                                         0554 00975000
*  DECADDR =  ADDR(CT1);    /*WHERE IN THE MESSAGE TO PUT PRINTABLE */  00976000
         LA    @14,CT1                                             0555 00977000
         ST    @14,DECADDR                                         0555 00978000
*  CALL CONVBIN;            /*GO CONVERT TO PRINTABLE        @Z427VLS*/ 00979000
         BAL   @14,CONVBIN                                         0556 00980000
*  CALL PRINTIT;                                           /*@Z427VLS*/ 00981000
         BAL   @14,PRINTIT                                         0557 00982000
* END;                                                     /*@Z427VLS*/ 00983000
*IF WHATYPE ^= ZERO THEN       /*DID WE DROP ANY UNKNOWN   RECORDS  */  00984000
@RF00551 L     @14,WHATYPE                                         0559 00985000
         LTR   @14,@14                                             0559 00986000
         BZ    @RF00559                                            0559 00987000
* DO;                                                      /*@Z427VLS*/ 00988000
*  CALL IFCMSG(57,ADDR(PRINTBDY));                         /*@Z427VLS*/ 00989000
         LA    @14,PRINTBDY                                        0561 00990000
         ST    @14,@AFTEMPS                                        0561 00991000
         L     @15,ADIFCMSG(,R2)                                   0561 00992000
         LA    @01,@AL00561                                        0561 00993000
         BALR  @14,@15                                             0561 00994000
*  BINWORD = WHATYPE;       /*LOAD # OF RECORDS FAILED FOR CONVERT  */  00995000
         L     @14,WHATYPE                                         0562 00996000
         ST    @14,BINWORD                                         0562 00997000
*  DECADDR =  ADDR(CT2);    /*WHERE IN THE MESSAGE TO PUT PRINTABLE */  00998000
         LA    @14,CT2                                             0563 00999000
         ST    @14,DECADDR                                         0563 01000000
*  CALL CONVBIN;            /*GO CONVERT TO PRINTABLE        @Z427VLS*/ 01001000
         BAL   @14,CONVBIN                                         0564 01002000
*  CALL PRINTIT;                                           /*@Z427VLS*/ 01003000
         BAL   @14,PRINTIT                                         0565 01004000
* END;                                                     /*@Z427VLS*/ 01005000
*IF SORTNUM = ZERO THEN     /*IF NO RECORDS, EREP1 SHOULD QUIT*/   0567 01006000
@RF00559 L     @14,SORTNUM(,R2)                                    0567 01007000
         LTR   @14,@14                                             0567 01008000
         BNZ   @RF00567                                            0567 01009000
*  ERROR = TERMINAT;                                       /*@Z427VLS*/ 01010000
         MVC   ERROR(4),@CF00032                                   0568 01011000
*IF BADTIME ^= ZERO THEN       /*DID WE HAVE ANY BAD TIMES   @Z427VLS*/ 01012000
@RF00567 L     @14,BADTIME                                         0569 01013000
         LTR   @14,@14                                             0569 01014000
         BZ    @RF00569                                            0569 01015000
* DO;                                                      /*@Z427VLS*/ 01016000
* END;                                                     /*@Z427VLS*/ 01017000
* IF DEBUG48 = ON THEN                                             0572 01018000
@RF00569 TM    DEBUG48(R2),B'10000000'                             0572 01019000
         BNO   @RF00572                                            0572 01020000
*  DO;                                                     /*@G51DGGB*/ 01021000
*   PRINTBDY = BUG48;                                      /*@G51DGGB*/ 01022000
         MVI   PRINTBDY+33,C' '                                    0574 01023000
         MVC   PRINTBDY+34(98),PRINTBDY+33                         0574 01024000
         MVC   PRINTBDY(33),BUG48                                  0574 01025000
*   CALL PRINTIT;                                          /*@G51DGGB*/ 01026000
         BAL   @14,PRINTIT                                         0575 01027000
*   RECLNGTH = 384;                                        /*@G51DGGB*/ 01028000
         MVC   RECLNGTH(2,R2),@CH01468                             0576 01029000
*   NEXTBY = FRAMEPTR;                                     /*@G51DGGB*/ 01030000
         L     @14,FRAMEPTR(,R2)                                   0577 01031000
         ST    @14,NEXTBY                                          0577 01032000
*   CALL HEXDUMP;                                          /*@G51DGGB*/ 01033000
         BAL   @14,HEXDUMP                                         0578 01034000
*  END;                                                    /*@G51DGGB*/ 01035000
* IF EXCESS ^= ZERO THEN      /*PRINT IF REC DROPPED DUE TO EXCESS*/    01036000
@RF00572 L     @14,EXCESS                                          0580 01037000
         LTR   @14,@14                                             0580 01038000
         BZ    @RF00580                                            0580 01039000
*  DO;                                                     /*@0001VLS*/ 01040000
*    CALL IFCMSG(73,ADDR(PRINTBDY)); /*GET MESSAGE TEXT FOR MODULE*/    01041000
         LA    @14,PRINTBDY                                        0582 01042000
         ST    @14,@AFTEMPS                                        0582 01043000
         L     @15,ADIFCMSG(,R2)                                   0582 01044000
         LA    @01,@AL00582                                        0582 01045000
         BALR  @14,@15                                             0582 01046000
*    BINWORD = EXCESS;               /*GET # TO CONVERT TO PRINT  */    01047000
         L     @14,EXCESS                                          0583 01048000
         ST    @14,BINWORD                                         0583 01049000
*    DECADDR = ADDR(PRINTBDY) + 38;  /*WHERE TO PUT THE NUMBER    */    01050000
         LA    @14,PRINTBDY                                        0584 01051000
         AL    @14,@CF01470                                        0584 01052000
         ST    @14,DECADDR                                         0584 01053000
*    CALL CONVBIN;                   /*CONVERT TO PRINTABLE  @0001VLS*/ 01054000
         BAL   @14,CONVBIN                                         0585 01055000
*    GEN(MVC  PRINTBDY+45(16),DROP);/*FINISH MESSAGE         @0001VLS*/ 01056000
         MVC  PRINTBDY+45(16),DROP                                      01057000
*    CALL PRINTIT;                   /*GO TELL THEM ABOUT IT @0001VLS*/ 01058000
         BAL   @14,PRINTIT                                         0587 01059000
*   END;                                                   /*@0001VLS*/ 01060000
*  IF (ERROR = ENDFILE | ERROR = SUCCESS) & I > 1 THEN             0589 01061000
@RF00580 L     @14,ERROR                                           0589 01062000
         C     @14,@CF00064                                        0589 01063000
         BE    @GL00021                                            0589 01064000
         LTR   @14,@14                                             0589 01065000
         BNZ   @RF00589                                            0589 01066000
@GL00021 CLC   I(4),@CF00055                                       0589 01067000
         BNH   @RF00589                                            0589 01068000
*  CALL SIFTSORT; /*SORT EVTABLE AND SORTABLE, ASSIGN LETTERS TO CPUS*/ 01069000
         BAL   @14,SIFTSORT                                        0590 01070000
* IF DEBUG16 = ON & NUMREC ^= 0 THEN                               0591 01071000
@RF00589 TM    DEBUG16(R2),B'10000000'                             0591 01072000
         BNO   @RF00591                                            0591 01073000
         L     @14,NUMREC                                          0591 01074000
         LTR   @14,@14                                             0591 01075000
         BZ    @RF00591                                            0591 01076000
*  CALL DBUG16;                                            /*@0099VLS*/ 01077000
         BAL   @14,DBUG16                                          0592 01078000
*RESPECIFY (R0,R15) UNRESTRICTED;                          /*@Z427VLS*/ 01079000
*END;                                                      /*@Z427VLS*/ 01080000
@EL00008 DS    0H                                                  0594 01081000
@EF00008 DS    0H                                                  0594 01082000
@ER00008 LM    @14,@12,@SA00008                                    0594 01083000
         BR    @14                                                 0594 01084000
*/********************************************************************/ 01085000
*/*    THIS PROC WILL PRINT OUT THE COUNTS OF THE # OF RECORDS THAT  */ 01086000
*/*    WERE READ AND THE NUMBER THAT FALL BY THE WAY SIDE AS THE    */  01087000
*/*    RECORDS ARE FILTERED USER SHOULD BE ABLE TO TELL WHERE THE   */  01088000
*/*    RECORDS ARE GOING BASED ON THESE COUNTS               @0099VLS*/ 01089000
*DBUG16: PROC;                                             /*@0099VLS*/ 01090000
DBUG16   STM   @14,@12,@SA00009                                    0595 01091000
*PRINTBDY = BUGS16;         /*MOVE IN THE BUG16 HEADING      @0099VLS*/ 01092000
         MVI   PRINTBDY+31,C' '                                    0596 01093000
         MVC   PRINTBDY+32(100),PRINTBDY+31                        0596 01094000
         MVC   PRINTBDY(31),BUGS16                                 0596 01095000
*CALL PRINTIT;              /*PRINT THE HEADER               @0099VLS*/ 01096000
         BAL   @14,PRINTIT                                         0597 01097000
*BNDECNUM = 6;              /*ALL OUTPUT WILL BE 6 FIGURES LONG*/  0598 01098000
         MVC   BNDECNUM(4),@CF00081                                0598 01099000
*DO P = 1 BY 1 TO RECTYPES; /*ONE LINE FOR EACH REC          @0099VLS*/ 01100000
         LA    @08,1                                               0599 01101000
         ST    @08,P                                               0599 01102000
@DL00599 DS    0H                                                  0600 01103000
* BINWORD = INCOUNT(P);     /*LOAD THE # READ OF THIS RECORD @0099VLS*/ 01104000
         SLA   @08,2                                               0600 01105000
         L     @08,INCOUNT-4(@08)                                  0600 01106000
         ST    @08,BINWORD                                         0600 01107000
* DECADDR = ADDR(RECNUM);   /*WHERE TO PUT THE CONVERTED VALUE*/   0601 01108000
         LA    @08,RECNUM                                          0601 01109000
         ST    @08,DECADDR                                         0601 01110000
* CALL CONVBIN;             /*GO CONVERT THE BINARY TO PRINTABLE*/ 0602 01111000
         BAL   @14,CONVBIN                                         0602 01112000
* RECTYP2 = RECNAME(P);     /*MOVE IN THE RECORD TYPE TO PRINT LINE*/   01113000
         L     @08,P                                               0603 01114000
         LR    @06,@08                                             0603 01115000
         MH    @06,@CH00076                                        0603 01116000
         LA    @03,RECNAME-3(@06)                                  0603 01117000
         MVC   RECTYP2(3),0(@03)                                   0603 01118000
* BINWORD = MIDCOUNT(P);    /* THE # OF RECORDS THAT PASS THE TIME*/    01119000
         SLA   @08,2                                               0604 01120000
         L     @08,MIDCOUNT-4(@08)                                 0604 01121000
         ST    @08,BINWORD                                         0604 01122000
* DECADDR = ADDR(RECPASS);  /*LOCATION OF WHERE TO PUT CONVERTED ITEM*/ 01123000
         LA    @08,RECPASS                                         0605 01124000
         ST    @08,DECADDR                                         0605 01125000
* CALL CONVBIN;             /*GO CONVERT THE ITEM TO PRINTABLE      */  01126000
         BAL   @14,CONVBIN                                         0606 01127000
* BINWORD = DEVCT(P);       /*# THAT PASSED THE DEVICE FILTER*/    0607 01128000
         L     @08,P                                               0607 01129000
         SLA   @08,2                                               0607 01130000
         L     @08,DEVCT-4(@08)                                    0607 01131000
         ST    @08,BINWORD                                         0607 01132000
* DECADDR = ADDR(DEVPASS);  /*WHERE IN THE LINE TO MOVE IT   @0099VLS*/ 01133000
         LA    @08,DEVPASS                                         0608 01134000
         ST    @08,DECADDR                                         0608 01135000
* CALL CONVBIN;             /*CHANGE TO A PRINTABLE FORM     @0099VLS*/ 01136000
         BAL   @14,CONVBIN                                         0609 01137000
* BINWORD = CUACT(P);       /*# THAT PASS THE CUA SELECTION  @0099VLS*/ 01138000
         L     @08,P                                               0610 01139000
         SLA   @08,2                                               0610 01140000
         L     @08,CUACT-4(@08)                                    0610 01141000
         ST    @08,BINWORD                                         0610 01142000
* DECADDR= ADDR(CUAPASS);   /*WHERE TO PUT THE CONVERTED VALUE*/   0611 01143000
         LA    @08,CUAPASS                                         0611 01144000
         ST    @08,DECADDR                                         0611 01145000
* CALL CONVBIN;             /*CHANGE TO A READABLE FORMAT    @0099VLS*/ 01146000
         BAL   @14,CONVBIN                                         0612 01147000
* BINWORD = RDEPCT(P);      /*NUMBER THAT WERE DROPPED       @0099VLS*/ 01148000
         L     @08,P                                               0613 01149000
         SLA   @08,2                                               0613 01150000
         L     @08,RDEPCT-4(@08)                                   0613 01151000
         ST    @08,BINWORD                                         0613 01152000
* DECADDR = ADDR(TYPEFAIL); /*WHERE TO PUT VALUE IN THE MESSAGE*/  0614 01153000
         LA    @08,TYPEFAIL                                        0614 01154000
         ST    @08,DECADDR                                         0614 01155000
* CALL CONVBIN;             /*GO CONVERT THE VALUE           @0099VLS*/ 01156000
         BAL   @14,CONVBIN                                         0615 01157000
* PRINTBDY = RECINFO;       /*MOVE ALL THIS GOOD INFO TO PRINT LINE*/   01158000
         MVC   PRINTBDY(132),RECINFO                               0616 01159000
* CALL PRINTIT;             /*PRINT ON THE TOURIST DATA SET  @0099VLS*/ 01160000
         BAL   @14,PRINTIT                                         0617 01161000
*END;                                                      /*@0099VLS*/ 01162000
         LA    @08,1                                               0618 01163000
         AL    @08,P                                               0618 01164000
         ST    @08,P                                               0618 01165000
         C     @08,@CF00034                                        0618 01166000
         BNH   @DL00599                                            0618 01167000
*CALL BUG13;                /*DEBUG COUNTS USED WITH DEBUG13 @0099VLS*/ 01168000
         BAL   @14,BUG13                                           0619 01169000
*DO P = 1 BY 1 TO RECTYPES;                                /*@0099VLS*/ 01170000
         LA    @08,1                                               0620 01171000
         ST    @08,P                                               0620 01172000
@DL00620 DS    0H                                                  0621 01173000
* PTYP = RECNAME(P);        /*MOVE IN THE RECORD             @0099VLS*/ 01174000
         LR    @06,@08                                             0621 01175000
         MH    @06,@CH00076                                        0621 01176000
         LA    @03,RECNAME-3(@06)                                  0621 01177000
         MVC   PTYP(3),0(@03)                                      0621 01178000
* BINWORD = EXCPUCT(P);   /*# OF EXTRA CPU COUNTS            @0099VLS*/ 01179000
         SLA   @08,2                                               0622 01180000
         L     @08,EXCPUCT-4(@08)                                  0622 01181000
         ST    @08,BINWORD                                         0622 01182000
* DECADDR = ADDR(EXCPU);    /*WHERE IN OUTPUT MESSAGE TO PLACE #*/ 0623 01183000
         LA    @08,EXCPU                                           0623 01184000
         ST    @08,DECADDR                                         0623 01185000
* CALL CONVBIN;             /*GO CONVERT THE ITEM            @0099VLS*/ 01186000
         BAL   @14,CONVBIN                                         0624 01187000
* BINWORD = OUTCOUNT(P);    /*# OF RECORDS THAT PASS ALL FILTERING*/    01188000
         L     @08,P                                               0625 01189000
         SLA   @08,2                                               0625 01190000
         L     @08,OUTCOUNT-4(@08)                                 0625 01191000
         ST    @08,BINWORD                                         0625 01192000
* DECADDR = ADDR(RECKEPT);  /*WHERE IN OUTPUT MESSAGE TO PLACE #*/ 0626 01193000
         LA    @08,RECKEPT                                         0626 01194000
         ST    @08,DECADDR                                         0626 01195000
* CALL CONVBIN;             /*GO CONVERT THE # TO PRINTABLE  @0099VLS*/ 01196000
         BAL   @14,CONVBIN                                         0627 01197000
* PRINTBDY = RECINFO1;      /*MOVE THE MESSAGE TO THE PRINT LINE*/ 0628 01198000
         MVI   PRINTBDY+61,C' '                                    0628 01199000
         MVC   PRINTBDY+62(70),PRINTBDY+61                         0628 01200000
         MVC   PRINTBDY(61),RECINFO1                               0628 01201000
* CALL PRINTIT;             /*PRINT DROPPED DUE TO EXCESS CPUS   */     01202000
         BAL   @14,PRINTIT                                         0629 01203000
*                           /*& COUNT OF NUMBER THAT PASS ALL FILTER*/  01204000
*END;                                                      /*@0099VLS*/ 01205000
         LA    @08,1                                               0630 01206000
         AL    @08,P                                               0630 01207000
         ST    @08,P                                               0630 01208000
         C     @08,@CF00034                                        0630 01209000
         BNH   @DL00620                                            0630 01210000
*CALL PRINTIT;              /*IMPROVE THE LOOKS WITH A BLANK LINE*/     01211000
         BAL   @14,PRINTIT                                         0631 01212000
*BINWORD = OUTDATE;         /*CONVERT THE # DROPPED DUE TO THE DATE*/   01213000
         L     @08,OUTDATE                                         0632 01214000
         ST    @08,BINWORD                                         0632 01215000
*DECADDR = ADDR(DAYFAIL);   /*WHERE TO PUT THE VALUE         @0099VLS*/ 01216000
         LA    @08,DAYFAIL                                         0633 01217000
         ST    @08,DECADDR                                         0633 01218000
*CALL CONVBIN;              /*CONVERT THE # THAT FAILED DAY FILTERING*/ 01219000
         BAL   @14,CONVBIN                                         0634 01220000
*BINWORD = OUTTIME;         /*LOAD THE # THAT FAILED THE TIME CHECK*/   01221000
         L     @08,OUTTIME                                         0635 01222000
         ST    @08,BINWORD                                         0635 01223000
*DECADDR = ADDR(TIMEFAIL);  /*WHERE IN THE MESSAGE TO PLACE THE VALUE*/ 01224000
         LA    @08,TIMEFAIL                                        0636 01225000
         ST    @08,DECADDR                                         0636 01226000
*CALL CONVBIN;              /*CONVERT THE ITEM TO PRINTABLE  @0099VLS*/ 01227000
         BAL   @14,CONVBIN                                         0637 01228000
*BINWORD = OUTTHIRD;        /*LOAD THE # THAT FAILED 3RD SHIFT CHECK*/  01229000
         L     @08,OUTTHIRD                                        0638 01230000
         ST    @08,BINWORD                                         0638 01231000
*DECADDR = ADDR(THIRDROP);  /*DUE TO THE DATE/TIME FILTERING @0099VLS*/ 01232000
         LA    @08,THIRDROP                                        0639 01233000
         ST    @08,DECADDR                                         0639 01234000
*CALL CONVBIN;              /*CONVERT THIS TO PRINTABLE      @0099VLS*/ 01235000
         BAL   @14,CONVBIN                                         0640 01236000
*PRINTBDY = TIMEMSG;        /*MOVE TO THE PRINT LINE         @0099VLS*/ 01237000
         MVI   PRINTBDY+87,C' '                                    0641 01238000
         MVC   PRINTBDY+88(44),PRINTBDY+87                         0641 01239000
         MVC   PRINTBDY(87),TIMEMSG                                0641 01240000
*CALL PRINTIT;              /*PRINT THE # DROPPED MESSAGE    @0099VLS*/ 01241000
         BAL   @14,PRINTIT                                         0642 01242000
*IF NUMREC ^= ZERO THEN     /*MAKE SURE NO ERROR             @0099VLS*/ 01243000
         L     @08,NUMREC                                          0643 01244000
         LTR   @08,@08                                             0643 01245000
         BZ    @RF00643                                            0643 01246000
* DO;                                                      /*@0099VLS*/ 01247000
*  BINWORD = BYTECT/NUMREC; /*FIND THE AVERAGE BYTE COUNT    @0099VLS*/ 01248000
         L     @00,BYTECT                                          0645 01249000
         SRDA  @00,32                                              0645 01250000
         DR    @00,@08                                             0645 01251000
         ST    @01,BINWORD                                         0645 01252000
*  DECADDR = ADDR(AVERAGE); /*WHERE THE VALUE GOES           @0099VLS*/ 01253000
         LA    @08,AVERAGE                                         0646 01254000
         ST    @08,DECADDR                                         0646 01255000
*  CALL CONVBIN;            /*GO CONVERT TO PRINTABLE        @0099VLS*/ 01256000
         BAL   @14,CONVBIN                                         0647 01257000
*  PRINTBDY = AVEBYTE;      /*MOVE THE MESSAGE TO THE PRINT LINE*/ 0648 01258000
         MVI   PRINTBDY+27,C' '                                    0648 01259000
         MVC   PRINTBDY+28(104),PRINTBDY+27                        0648 01260000
         MVC   PRINTBDY(27),AVEBYTE                                0648 01261000
*  CALL PRINTIT;            /*GO PRINT THE MESSAGE           @0099VLS*/ 01262000
         BAL   @14,PRINTIT                                         0649 01263000
* END;                                                     /*@0099VLS*/ 01264000
* IF (FRAMEPTR ^= ZERO & FRAMENUM ^= ZERO) | DEBUG47 = ON THEN     0651 01265000
@RF00643 SLR   @08,@08                                             0651 01266000
         L     @06,FRAMEPTR(,R2)                                   0651 01267000
         CR    @06,@08                                             0651 01268000
         BE    @GL00024                                            0651 01269000
         C     @08,FRAMENUM(,@06)                                  0651 01270000
         BNE   @RT00651                                            0651 01271000
@GL00024 TM    DEBUG47(R2),B'00000001'                             0651 01272000
         BNO   @RF00651                                            0651 01273000
@RT00651 DS    0H                                                  0652 01274000
*   CALL FRAMINFO;                                         /*@G51DGBB*/ 01275000
         BAL   @14,FRAMINFO                                        0652 01276000
*END;                                                      /*@0099VLS*/ 01277000
@EL00009 DS    0H                                                  0653 01278000
@EF00009 DS    0H                                                  0653 01279000
@ER00009 LM    @14,@12,@SA00009                                    0653 01280000
         BR    @14                                                 0653 01281000
*/*******************************************************************/  01282000
*/*******************************************************************/  01283000
*/*   THIS PROC WILL PRINT THE RESULT OF EXTRA FILTERING DUE TO     */  01284000
*/*   DEBUG 13 BEENING USED                                  @0099VLS*/ 01285000
*BUG13: PROC;                                              /*@0099VLS*/ 01286000
BUG13    STM   @14,@12,@SA00010                                    0654 01287000
*      CALL PRINTIT;          /*ADD A BLANK LINE TO OUTPUT   @0099VLS*/ 01288000
         BAL   @14,PRINTIT                                         0655 01289000
*       IF VOLTRY ^> 4 | CPUTRY ^> NINE |   TERMTRY ^> THREE THEN  0656 01290000
         LH    @08,VOLTRY                                          0656 01291000
         C     @08,@CF00064                                        0656 01292000
         BNH   @RT00656                                            0656 01293000
         LH    @08,CPUTRY                                          0656 01294000
         C     @08,@CF00035                                        0656 01295000
         BNH   @RT00656                                            0656 01296000
         L     @08,TERMTRY                                         0656 01297000
         C     @08,@CF00076                                        0656 01298000
         BH    @RF00656                                            0656 01299000
@RT00656 DS    0H                                                  0657 01300000
*        DO UNTIL (VOLTRY >4 & CPUTRY > NINE & TERMTRY > THREE );  0657 01301000
@DL00657 DS    0H                                                  0658 01302000
*        IF CPUTRY ^> NINE THEN                                    0658 01303000
         LH    @08,CPUTRY                                          0658 01304000
         C     @08,@CF00035                                        0658 01305000
         BH    @RF00658                                            0658 01306000
*         DO;                                              /*@0099VLS*/ 01307000
*          BINWORD = CPUIN(CPUTRY) - CPUOUT(CPUTRY);       /*@0099VLS*/ 01308000
         SLA   @08,2                                               0660 01309000
         L     @06,CPUIN-4(@08)                                    0660 01310000
         SL    @06,CPUOUT-4(@08)                                   0660 01311000
         ST    @06,BINWORD                                         0660 01312000
*          DECADDR = ADDR(CPUIN1);         /*WHERE TO PUT NUM IN    */  01313000
         LA    @08,CPUIN1                                          0661 01314000
         ST    @08,DECADDR                                         0661 01315000
*          CALL CONVBIN;                   /*CONVERT THE #   @0099VLS*/ 01316000
         BAL   @14,CONVBIN                                         0662 01317000
*          BINWORD = CPUOUT(CPUTRY);       /*#REC KEPT THIS REC     */  01318000
         LH    @08,CPUTRY                                          0663 01319000
         SLA   @08,2                                               0663 01320000
         L     @08,CPUOUT-4(@08)                                   0663 01321000
         ST    @08,BINWORD                                         0663 01322000
*          DECADDR = ADDR(CPUOUT1);        /*WHERE TO PUT IN THE LINE*/ 01323000
         LA    @08,CPUOUT1                                         0664 01324000
         ST    @08,DECADDR                                         0664 01325000
*          CALL CONVBIN;                   /*CONVERT TO PRINTABLE   */  01326000
         BAL   @14,CONVBIN                                         0665 01327000
*          CPUR = RECNAME(CPUTRY);         /*MOVE IN RECORD TYPE    */  01328000
         LH    @08,CPUTRY                                          0666 01329000
         MH    @08,@CH00076                                        0666 01330000
         LA    @06,RECNAME-3(@08)                                  0666 01331000
         MVC   CPUR(3),0(@06)                                      0666 01332000
*         END;                                             /*@0099VLS*/ 01333000
*         ELSE                                                     0668 01334000
*          CPUDATA = ' ';             /*NO CPU FILTERING SO BLANK LI*/  01335000
         B     @RC00658                                            0668 01336000
@RF00658 MVI   CPUDATA+1,C' '                                      0668 01337000
         MVC   CPUDATA+2(39),CPUDATA+1                             0668 01338000
         MVI   CPUDATA,C' '                                        0668 01339000
*          IF VOLTRY ^> 4 THEN                                     0669 01340000
@RC00658 LH    @08,VOLTRY                                          0669 01341000
         C     @08,@CF00064                                        0669 01342000
         BH    @RF00669                                            0669 01343000
*           DO;                                            /*@0099VLS*/ 01344000
*            BINWORD = VOLCOUNT(VOLTRY); /*# FOUND THIS DEV  @0099VLS*/ 01345000
         SLA   @08,2                                               0671 01346000
         L     @08,VOLCOUNT-4(@08)                                 0671 01347000
         ST    @08,BINWORD                                         0671 01348000
*            DECADDR = ADDR(VOLIN);      /* WHERE IN LINE TO PUT IT*/   01349000
         LA    @08,VOLIN                                           0672 01350000
         ST    @08,DECADDR                                         0672 01351000
*            CALL CONVBIN;               /*GO CONVERT IT TO PRINT*/     01352000
         BAL   @14,CONVBIN                                         0673 01353000
*            BINWORD = VOLPASS(VOLTRY);  /*# KEPT  FOR THIS DEV  */     01354000
         LH    @08,VOLTRY                                          0674 01355000
         SLA   @08,2                                               0674 01356000
         L     @08,VOLPASS-4(@08)                                  0674 01357000
         ST    @08,BINWORD                                         0674 01358000
*            DECADDR = ADDR(VOLOUT);     /* WHERE IN LINE TO PUT IT*/   01359000
         LA    @08,VOLOUT                                          0675 01360000
         ST    @08,DECADDR                                         0675 01361000
*            CALL CONVBIN;               /*GO CONVERT IT TO PRINT*/     01362000
         BAL   @14,CONVBIN                                         0676 01363000
*            VOLTYPE = VOLDEV(VOLTRY);   /*MOVE IN THE TYPE OF DEV*/    01364000
         LH    @08,VOLTRY                                          0677 01365000
         SLA   @08,3                                               0677 01366000
         LA    @06,VOLDEV-8(@08)                                   0677 01367000
         MVC   VOLTYPE(8),0(@06)                                   0677 01368000
*           END;                                           /*@0099VLS*/ 01369000
*           ELSE                                                   0679 01370000
*           VOLDATA = ' '; /*NO VOLID FILTERING MAKE THIS PART BLANK*/  01371000
         B     @RC00669                                            0679 01372000
@RF00669 MVI   VOLDATA+1,C' '                                      0679 01373000
         MVC   VOLDATA+2(47),VOLDATA+1                             0679 01374000
         MVI   VOLDATA,C' '                                        0679 01375000
*           IF TERMTRY ^> THREE THEN     /*WILL BE 1 IF HAD TERM F-*/   01376000
@RC00669 L     @08,TERMTRY                                         0680 01377000
         C     @08,@CF00076                                        0680 01378000
         BH    @RF00680                                            0680 01379000
*            DO;                                           /*@0099VLS*/ 01380000
*            BINWORD = TERMTYPE(TERMTRY);/*# FOUND FOR THIS REC  */     01381000
         SLA   @08,2                                               0682 01382000
         L     @08,TERMTYPE-4(@08)                                 0682 01383000
         ST    @08,BINWORD                                         0682 01384000
*            DECADDR = ADDR(TERMIN);     /*PLACE IN LINE TO PUT IT*/    01385000
         LA    @08,TERMIN                                          0683 01386000
         ST    @08,DECADDR                                         0683 01387000
*            CALL CONVBIN;               /*PUT IT IN TO PRINT LINE*/    01388000
         BAL   @14,CONVBIN                                         0684 01389000
*            BINWORD = TERMKEPT(TERMTRY);/*# KEPT THIS REC   @0099VLS*/ 01390000
         L     @08,TERMTRY                                         0685 01391000
         SLA   @08,2                                               0685 01392000
         L     @08,TERMKEPT-4(@08)                                 0685 01393000
         ST    @08,BINWORD                                         0685 01394000
*            DECADDR = ADDR(TERMOUT);    /*LOCATION WHERE TO PUT IT*/   01395000
         LA    @08,TERMOUT                                         0686 01396000
         ST    @08,DECADDR                                         0686 01397000
*            CALL CONVBIN;               /*CONVERT TO PRINTABLE*/  0687 01398000
         BAL   @14,CONVBIN                                         0687 01399000
*            TERMTYP = TRMTYPE(TERMTRY);/*MOVE IN THE TYPE OF OBR*/     01400000
         L     @08,TERMTRY                                         0688 01401000
         ALR   @08,@08                                             0688 01402000
         LA    @06,TRMTYPE-2(@08)                                  0688 01403000
         MVC   TERMTYP(2),0(@06)                                   0688 01404000
*            END;                                          /*@0099VLS*/ 01405000
*            ELSE                                                  0690 01406000
*            TERMDATA = ' ';           /*BLANK OUT THIS PART OF LINE*/  01407000
         B     @RC00680                                            0690 01408000
@RF00680 MVI   TERMDATA+1,C' '                                     0690 01409000
         MVC   TERMDATA+2(39),TERMDATA+1                           0690 01410000
         MVI   TERMDATA,C' '                                       0690 01411000
*            TERMTRY = TERMTRY + ONE ;   /*INCREMENT THE INDEX BY 1*/   01412000
@RC00680 LA    @08,1                                               0691 01413000
         L     @06,TERMTRY                                         0691 01414000
         ALR   @06,@08                                             0691 01415000
         ST    @06,TERMTRY                                         0691 01416000
*            VOLTRY = VOLTRY + ONE;  /*IJNCREMENT THE VOLUME CONTROL*/  01417000
         LH    @06,VOLTRY                                          0692 01418000
         ALR   @06,@08                                             0692 01419000
         STH   @06,VOLTRY                                          0692 01420000
*            CPUTRY = CPUTRY + ONE;  /*INCREMENT THE CPU CONTROL*/ 0693 01421000
         AH    @08,CPUTRY                                          0693 01422000
         STH   @08,CPUTRY                                          0693 01423000
*           PRINTBDY = NEWFILT;                            /*@0099VLS*/ 01424000
         MVC   PRINTBDY(132),NEWFILT                               0694 01425000
*           CALL PRINTIT;                                  /*@0099VLS*/ 01426000
         BAL   @14,PRINTIT                                         0695 01427000
*         END;                                             /*@0099VLS*/ 01428000
@DE00657 LH    @08,VOLTRY                                          0696 01429000
         C     @08,@CF00064                                        0696 01430000
         BNH   @DL00657                                            0696 01431000
         LH    @08,CPUTRY                                          0696 01432000
         C     @08,@CF00035                                        0696 01433000
         BNH   @DL00657                                            0696 01434000
         L     @08,TERMTRY                                         0696 01435000
         C     @08,@CF00076                                        0696 01436000
         BNH   @DL00657                                            0696 01437000
*   CALL PRINTIT;                        /*ADD SPACE BETWEEN @0099VLS*/ 01438000
@RF00656 BAL   @14,PRINTIT                                         0697 01439000
*END;                                                      /*@0099VLS*/ 01440000
@EL00010 DS    0H                                                  0698 01441000
@EF00010 DS    0H                                                  0698 01442000
@ER00010 LM    @14,@12,@SA00010                                    0698 01443000
         BR    @14                                                 0698 01444000
*/********************************************************************/ 01445000
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */ 01446000
*/*    THIS PROC WILL CONVERT THE BINARY NUMBER IN ITEM BINWORD TO   */ 01447000
*/*    PRINTABLE IF THE NUMBER (CONVERTED) IS > THAN THE NUMBER OF   */ 01448000
*/*    CHARACTERS REQUESTED (IN ITEM BNDECNUM) A NINE WILL BE PLACED */ 01449000
*/*    IN EACH PRINT POSITION                                @Z427VLS*/ 01450000
*/*                                                          @Z427VLS*/ 01451000
*CONVBIN:  PROC;                                           /*@Z427VLS*/ 01452000
CONVBIN  STM   @14,@12,@SA00011                                    0699 01453000
*RESPECIFY (R4,R5) RESTRICTED;                             /*@0099VLS*/ 01454000
* R4 = BINWORD;                                            /*@G51DGGB*/ 01455000
         L     R4,BINWORD                                          0701 01456000
* GEN(CVD  R4,DBLWORD);                                    /*@G51DGGB*/ 01457000
         CVD  R4,DBLWORD                                                01458000
* GEN(UNPK  WORK(8),DBLWORD);                              /*@G51DGGB*/ 01459000
         UNPK  WORK(8),DBLWORD                                          01460000
* GEN(OI  WORK+7,X'F0');                                   /*@G51DGGB*/ 01461000
         OI  WORK+7,X'F0'                                               01462000
* SWITCH1 = OFF;                                           /*@G51DGGB*/ 01463000
         NI    SWITCH1,B'10111111'                                 0705 01464000
* DO L = 1 BY 1 TO 7 WHILE(SWITCH1 = OFF );                /*@G51DGGB*/ 01465000
         LA    @08,1                                               0706 01466000
         ST    @08,L                                               0706 01467000
@DL00706 TM    SWITCH1,B'01000000'                                 0706 01468000
         BNZ   @DC00706                                            0706 01469000
*  IF WORKOVER(L) = 'F0'X THEN                                     0707 01470000
         LA    @06,WORKOVER-1(@08)                                 0707 01471000
         CLI   0(@06),X'F0'                                        0707 01472000
         BNE   @RF00707                                            0707 01473000
*   WORKOVER(L) = '40'X;                                   /*@G51DGGB*/ 01474000
         LA    @06,WORKOVER-1(@08)                                 0708 01475000
         MVI   0(@06),X'40'                                        0708 01476000
*  ELSE                                                            0709 01477000
*   SWITCH1 = ON;                                          /*@G51DGGB*/ 01478000
         B     @RC00707                                            0709 01479000
@RF00707 OI    SWITCH1,B'01000000'                                 0709 01480000
* END;                                                     /*@G51DGGB*/ 01481000
@RC00707 LA    @08,1                                               0710 01482000
         AL    @08,L                                               0710 01483000
         ST    @08,L                                               0710 01484000
         C     @08,@CF00083                                        0710 01485000
         BNH   @DL00706                                            0710 01486000
@DC00706 DS    0H                                                  0711 01487000
* R4 = ADDR(WORKOVER) + 8 - BNDECNUM;                      /*@G51DGGB*/ 01488000
         L     @08,BNDECNUM                                        0711 01489000
         LA    R4,WORKOVER                                         0711 01490000
         AL    R4,@CF00066                                         0711 01491000
         SLR   R4,@08                                              0711 01492000
* R5 = BNDECNUM - ONE;                                     /*@G51DGGB*/ 01493000
         BCTR  @08,0                                               0712 01494000
         LR    R5,@08                                              0712 01495000
* RESPECIFY (R6) RESTRICTED;                               /*@G51DGGB*/ 01496000
* R6 = DECADDR;                                            /*@G51DGGB*/ 01497000
         L     R6,DECADDR                                          0714 01498000
* GEN(EX  R5,MVCINS);                                      /*@G51DGGB*/ 01499000
         EX  R5,MVCINS                                                  01500000
* GENERATE DATA;                                           /*@G51DGGB*/ 01501000
*RESPECIFY (R4,R5,R6) UNRESTRICTED;                        /*@G51DGGB*/ 01502000
*END;                                                      /*@Z427VLS*/ 01503000
@EL00011 DS    0H                                                  0718 01504000
@EF00011 DS    0H                                                  0718 01505000
@ER00011 LM    @14,@12,@SA00011                                    0718 01506000
         BR    @14                                                 0718 01507000
*PRINTIT: PROC;                                            /*@Z427VLS*/ 01508000
PRINTIT  STM   @14,@12,@SA00012                                    0719 01509000
* PRINTADR = ADDR(PRINTLIN);                               /*@Z427VLS*/ 01510000
         LA    @08,PRINTLIN                                        0720 01511000
         ST    @08,PRINTADR(,R2)                                   0720 01512000
* CALL IOHND(RITEPRTR);                                    /*@Z427VLS*/ 01513000
         L     @15,ADIOHND(,R2)                                    0721 01514000
         LA    @01,@AL00721                                        0721 01515000
         BALR  @14,@15                                             0721 01516000
*END;                                                      /*@Z427VLS*/ 01517000
@EL00012 DS    0H                                                  0722 01518000
@EF00012 DS    0H                                                  0722 01519000
@ER00012 LM    @14,@12,@SA00012                                    0722 01520000
         BR    @14                                                 0722 01521000
*/********************************************************************/ 01522000
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */ 01523000
*/*    THIS PROC WILL CONVERT THE HEX DATA INTO PRINTABLE    @Z427VLS*/ 01524000
*/*                                                          @Z427VLS*/ 01525000
*/*    IF IT IS NECESSARY TO CONVERT ONLY 1/2 OF FIRST BYTE(CUA FOR  */ 01526000
*/*    EXP. THEN THE USER SHOULD SET THE SWITCH1 TO THEON CONDITION  */ 01527000
*CONVERT: PROC;                                            /*@Z427VLS*/ 01528000
CONVERT  STM   @14,@12,12(@13)                                     0723 01529000
* RESPECIFY (R4,R5) RESTRICTED;                            /*@Z427VLS*/ 01530000
* DO P = NUMBER BY -1 TO 1;      /*# = # OF BYTES TO CONVERT TO PRINT*/ 01531000
         L     @08,NUMBER                                          0725 01532000
         ST    @08,P                                               0725 01533000
         B     @DE00725                                            0725 01534000
@DL00725 DS    0H                                                  0726 01535000
*   R4 = NEXTBYTE(P);            /*LOAD THE NEXT BYTE TO CONVERT     */ 01536000
         L     @06,NEXTBY                                          0726 01537000
         BCTR  @06,0                                               0726 01538000
         SLR   R4,R4                                               0726 01539000
         IC    R4,NEXTBYTE(@08,@06)                                0726 01540000
*   X =  TWO * P;                /*OUTPUT INDEX MUST BE TWICE INPUT  */ 01541000
         LR    @06,@08                                             0727 01542000
         ALR   @06,@06                                             0727 01543000
         ST    @06,X                                               0727 01544000
*   SRDL  (R4,FOUR);             /*MOVE 1/2 IN TO NEXT REG   @Z427VLS*/ 01545000
         SRDL  R4,4                                                0728 01546000
*   SRL   (R5,TWOEIGHT);         /*SHIFT THE REG 28 BITS     @Z427VLS*/ 01547000
         L     @06,TWOEIGHT                                        0729 01548000
         SRL   R5,0(@06)                                           0729 01549000
*   R5  =  R5 + NUMBER1;         /*INSURE INDEX BY 0 DOES NOT AFFECT */ 01550000
         L     @06,NUMBER1                                         0730 01551000
         ALR   R5,@06                                              0730 01552000
*   R4  =  R4 + NUMBER1;         /*SAME                      @Z427VLS*/ 01553000
         ALR   R4,@06                                              0731 01554000
*   IF SWITCH1 = ON & P = ONE    /*DO WE NOT PUT THE HALF BYTE OUT   */ 01555000
*    THEN                                                          0732 01556000
         TM    SWITCH1,B'01000000'                                 0732 01557000
         BNO   @RF00732                                            0732 01558000
         C     @08,@CF00055                                        0732 01559000
         BNE   @RF00732                                            0732 01560000
*     SWITCH1 = OFF;             /*TURN OFF THE SWITCH       @Z427VLS*/ 01561000
         NI    SWITCH1,B'10111111'                                 0733 01562000
*    ELSE                                                          0734 01563000
*     ADDNUM(X-ONE) = CHARS(R4);/*PUT THE PRINT CHAR INTO THE OUTPUT*/  01564000
         B     @RC00732                                            0734 01565000
@RF00732 L     @08,ADDNXT                                          0734 01566000
         AL    @08,X                                               0734 01567000
         BCTR  @08,0                                               0734 01568000
         BCTR  @08,0                                               0734 01569000
         LA    @06,CHARS-1(R4)                                     0734 01570000
         MVC   ADDNUM(1,@08),0(@06)                                0734 01571000
*     ADDNUM(X)  = CHARS(R5);   /*FINSH THE BYTE             @Z427VLS*/ 01572000
@RC00732 L     @08,ADDNXT                                          0735 01573000
         AL    @08,X                                               0735 01574000
         BCTR  @08,0                                               0735 01575000
         LA    @06,CHARS-1(R5)                                     0735 01576000
         MVC   ADDNUM(1,@08),0(@06)                                0735 01577000
* END;                                                     /*@Z427VLS*/ 01578000
         SLR   @08,@08                                             0736 01579000
         BCTR  @08,0                                               0736 01580000
         AL    @08,P                                               0736 01581000
         ST    @08,P                                               0736 01582000
@DE00725 LTR   @08,@08                                             0736 01583000
         BP    @DL00725                                            0736 01584000
* END;                                                     /*@Z427VLS*/ 01585000
@EL00013 DS    0H                                                  0737 01586000
@EF00013 DS    0H                                                  0737 01587000
@ER00013 LM    @14,@12,12(@13)                                     0737 01588000
         BR    @14                                                 0737 01589000
* RESPECIFY (R4,R5) UNRESTRICTED;                          /*@Z427VLS*/ 01590000
*/*******************************************************************/  01591000
*/*    THIS PROC WILL PRINT THE DEBUG INFORMATION ABOUT FRAMES      */  01592000
*FRAMINFO: PROC;                                           /*@G51DGGB*/ 01593000
FRAMINFO STM   @14,@12,@SA00014                                    0739 01594000
*    BINWORD = FRMREAD(1) ; /*PICK UP THE NUMBER OF FRAMES READ*/  0740 01595000
         LH    @08,FRMREAD                                         0740 01596000
         ST    @08,BINWORD                                         0740 01597000
*    DECADDR = ADDR(MCFNUMB); /*ADDRESS IN DATA LINE TO PLACE VALUE*/   01598000
         LA    @08,MCFNUMB                                         0741 01599000
         ST    @08,DECADDR                                         0741 01600000
*    CALL CONVBIN;  /*CONVERT THE ITEM TO PRINTABLE          @G51DGGB*/ 01601000
         BAL   @14,CONVBIN                                         0742 01602000
*    BINWORD = NOMATCH(1); /*# OF FRAMES WITH OUT A MATCHING CPU*/ 0743 01603000
         LH    @08,NOMATCH                                         0743 01604000
         ST    @08,BINWORD                                         0743 01605000
*    DECADDR = ADDR(MCFNOMCH);/*LOCATION IN MESSAGE OF NO-MATCH ON CPU* 01606000
         LA    @08,MCFNOMCH                                        0744 01607000
         ST    @08,DECADDR                                         0744 01608000
*    CALL CONVBIN;  /*CONVERT THE ITEM TO PRINTABLE          @G51DGGB*/ 01609000
         BAL   @14,CONVBIN                                         0745 01610000
*    BINWORD = KEPT(1); /* # OF MCF FRAMES KEPT              @G51DGGB*/ 01611000
         LH    @08,KEPT                                            0746 01612000
         ST    @08,BINWORD                                         0746 01613000
*    DECADDR = ADDR(MCFKEPT); /*ADDRESS OF WHERE TO PLACE THE NUMBER*/  01614000
         LA    @08,MCFKEPT                                         0747 01615000
         ST    @08,DECADDR                                         0747 01616000
*    CALL CONVBIN;  /*CONVERT THE ITEM TO PRINTABLE          @G51DGGB*/ 01617000
         BAL   @14,CONVBIN                                         0748 01618000
*    BINWORD = SETREJCT(1) + NOMATCH(1);                   /*@G51DGGB*/ 01619000
         LH    @08,SETREJCT                                        0749 01620000
         AH    @08,NOMATCH                                         0749 01621000
         ST    @08,BINWORD                                         0749 01622000
*    DECADDR = ADDR(MCFREJ); /*ADDRESS OF WHERE IN THE DATA LINE*/ 0750 01623000
         LA    @08,MCFREJ                                          0750 01624000
         ST    @08,DECADDR                                         0750 01625000
*    CALL CONVBIN;  /*CONVERT THE ITEM TO PRINTABLE          @G51DGGB*/ 01626000
         BAL   @14,CONVBIN                                         0751 01627000
*    BINWORD = DUPLICAT(1); /* # OF SETS THAT WERE A DUPLICATE*/   0752 01628000
         LH    @08,DUPLICAT                                        0752 01629000
         ST    @08,BINWORD                                         0752 01630000
*    DECADDR = ADDR(MCFDUP);                               /*@G51DGGB*/ 01631000
         LA    @08,MCFDUP                                          0753 01632000
         ST    @08,DECADDR                                         0753 01633000
*    CALL CONVBIN;  /*CONVERT THE ITEM TO PRINTABLE          @G51DGGB*/ 01634000
         BAL   @14,CONVBIN                                         0754 01635000
*    BINWORD = TOACCDEV(1);  /* # OF MCF THAT WERE WRITTEN TO ACCDEV*/  01636000
         LH    @08,TOACCDEV                                        0755 01637000
         ST    @08,BINWORD                                         0755 01638000
*    DECADDR = ADDR(MFACCDEV);                             /*@G51DGGB*/ 01639000
         LA    @08,MFACCDEV                                        0756 01640000
         ST    @08,DECADDR                                         0756 01641000
*    CALL CONVBIN;  /*CONVERT THE ITEM TO PRINTABLE          @G51DGGB*/ 01642000
         BAL   @14,CONVBIN                                         0757 01643000
*    PRINTBDY = MCF; /*MOVE THE ITEM INTO THE PRINT LINE     @G51DGGB*/ 01644000
         MVI   PRINTBDY+131,C' '                                   0758 01645000
         MVC   PRINTBDY(131),MCF                                   0758 01646000
*    CALL PRINTIT;   /*GO PRINT THE MCF DEBUG DATA           @G51DGGB*/ 01647000
         BAL   @14,PRINTIT                                         0759 01648000
*    BINWORD = FRMREAD(2) ; /* # OF CCF RECORDS READ         @G51DGGB*/ 01649000
         LH    @08,FRMREAD+2                                       0760 01650000
         ST    @08,BINWORD                                         0760 01651000
*    DECADDR = ADDR(CCFNUMB); /* ADDRESS OF WHERE IN THE PRINT LINE*/   01652000
         LA    @08,CCFNUMB                                         0761 01653000
         ST    @08,DECADDR                                         0761 01654000
*    CALL CONVBIN;  /*CONVERT THE ITEM TO PRINTABLE          @G51DGGB*/ 01655000
         BAL   @14,CONVBIN                                         0762 01656000
*    BINWORD = KEPT(2);  /* # OF CCF FRAMES THAT WERE KEPT   @G51DGGB*/ 01657000
         LH    @08,KEPT+2                                          0763 01658000
         ST    @08,BINWORD                                         0763 01659000
*    DECADDR = ADDR(CCFKEPT);                              /*@G51DGGB*/ 01660000
         LA    @08,CCFKEPT                                         0764 01661000
         ST    @08,DECADDR                                         0764 01662000
*    CALL CONVBIN;  /*CONVERT THE ITEM TO PRINTABLE          @G51DGGB*/ 01663000
         BAL   @14,CONVBIN                                         0765 01664000
*    BINWORD = SETREJCT(2) + NOMATCH(2);                   /*@G51DGGB*/ 01665000
         LH    @08,SETREJCT+2                                      0766 01666000
         AH    @08,NOMATCH+2                                       0766 01667000
         ST    @08,BINWORD                                         0766 01668000
*    DECADDR = ADDR(CCFREJ);                               /*@G51DGGB*/ 01669000
         LA    @08,CCFREJ                                          0767 01670000
         ST    @08,DECADDR                                         0767 01671000
*    CALL CONVBIN;  /*CONVERT THE ITEM TO PRINTABLE          @G51DGGB*/ 01672000
         BAL   @14,CONVBIN                                         0768 01673000
*    BINWORD = TOACCDEV(2); /*NUMBER OF CCF WRITTEN TO ACCDEV*/    0769 01674000
         LH    @08,TOACCDEV+2                                      0769 01675000
         ST    @08,BINWORD                                         0769 01676000
*    DECADDR = ADDR(CFACCDEV);                             /*@G51DGGB*/ 01677000
         LA    @08,CFACCDEV                                        0770 01678000
         ST    @08,DECADDR                                         0770 01679000
*    CALL CONVBIN;  /*CONVERT THE ITEM TO PRINTABLE          @G51DGGB*/ 01680000
         BAL   @14,CONVBIN                                         0771 01681000
*    PRINTBDY = CCF; /*MOVE THE CCF INFO TO THE PRINT LINE   @G51DGGB*/ 01682000
         MVI   PRINTBDY+131,C' '                                   0772 01683000
         MVC   PRINTBDY(131),CCF                                   0772 01684000
*    CALL PRINTIT;  /*GO PRINT THE CCF DEBUG DATA            @G51DGGB*/ 01685000
         BAL   @14,PRINTIT                                         0773 01686000
*    BINWORD = 0;   /* SET NUMBER FOUND TO 0 FIRST           @G51DGGB*/ 01687000
         SLR   @08,@08                                             0774 01688000
         ST    @08,BINWORD                                         0774 01689000
*    DO P = 1 BY 1 TO FRAMENUM; /*CHECK EACH TO SEE IF COMPLETE*/  0775 01690000
         LA    @08,1                                               0775 01691000
         ST    @08,P                                               0775 01692000
         B     @DE00775                                            0775 01693000
@DL00775 DS    0H                                                  0776 01694000
*     IF FRAMETYP(P) = ALLALL THEN  /* = TO 'FF'X IF COMPLETE*/    0776 01695000
         MH    @08,@CH00227                                        0776 01696000
         L     @06,FRAMEPTR(,R2)                                   0776 01697000
         ALR   @06,@08                                             0776 01698000
         AL    @06,@CF01624                                        0776 01699000
         CLI   FRAMETYP-17(@06),X'FF'                              0776 01700000
         BNE   @RF00776                                            0776 01701000
*       BINWORD = BINWORD + 1; /*COUNT THE NUMBER OF COMPLETE ONES*/    01702000
         LA    @08,1                                               0777 01703000
         AL    @08,BINWORD                                         0777 01704000
         ST    @08,BINWORD                                         0777 01705000
*    END;                                                  /*@G51DGGB*/ 01706000
@RF00776 LA    @08,1                                               0778 01707000
         AL    @08,P                                               0778 01708000
         ST    @08,P                                               0778 01709000
@DE00775 L     @06,FRAMEPTR(,R2)                                   0778 01710000
         C     @08,FRAMENUM(,@06)                                  0778 01711000
         BNH   @DL00775                                            0778 01712000
*    DECADDR = ADDR(FFNUMD);/*WHERE IN MESSAGE FOR CONVERTED VALUE*/    01713000
         LA    @08,FFNUMD                                          0779 01714000
         ST    @08,DECADDR                                         0779 01715000
*    CALL CONVBIN;/*CONVERT THE HEX VALUE TO PRINTABLE       @G51DGGB*/ 01716000
         BAL   @14,CONVBIN                                         0780 01717000
*    PRINTBDY = FFSETS; /*MOVE THE MESSAGE TO PRINT LINE     @G51DGGB*/ 01718000
         MVI   PRINTBDY+37,C' '                                    0781 01719000
         MVC   PRINTBDY+38(94),PRINTBDY+37                         0781 01720000
         MVC   PRINTBDY(37),FFSETS                                 0781 01721000
*    CALL PRINTIT; /*GO AND PRINT THE MESSAGE                @G51DGGB*/ 01722000
         BAL   @14,PRINTIT                                         0782 01723000
*    BINWORD = BUILDCT;        /*ENTRIES THROUGH THE PROC    @G51DGGB*/ 01724000
         L     @08,BUILDCT                                         0783 01725000
         ST    @08,BINWORD                                         0783 01726000
*    DECADDR = ADDR(BUILDNUM); /*LOCATION IN THE PRINT LINE  @G51DGGB*/ 01727000
         LA    @08,BUILDNUM                                        0784 01728000
         ST    @08,DECADDR                                         0784 01729000
*    CALL CONVBIN;             /*CONVERT TO PRINTABLE        @G51DGGB*/ 01730000
         BAL   @14,CONVBIN                                         0785 01731000
*    BINWORD = LASTCT;         /*NUMBER OF FRAMES WITH LAST FLAG OFF*/  01732000
         L     @08,LASTCT                                          0786 01733000
         ST    @08,BINWORD                                         0786 01734000
*    DECADDR = ADDR(LASTCTS);  /*ADDRESS IN THE PRINT LINE   @G51DGGB*/ 01735000
         LA    @08,LASTCTS                                         0787 01736000
         ST    @08,DECADDR                                         0787 01737000
*    CALL CONVBIN;             /*CONVERT BINARY COUNT TO PRINTABLE*/    01738000
         BAL   @14,CONVBIN                                         0788 01739000
*    PRINTBDY = EXTRACT;       /*MOVE THE MESSAGE TO PRINT LINE*/  0789 01740000
         MVI   PRINTBDY+49,C' '                                    0789 01741000
         MVC   PRINTBDY+50(82),PRINTBDY+49                         0789 01742000
         MVC   PRINTBDY(49),EXTRACT                                0789 01743000
*    CALL PRINTIT;             /*GO PRINT THE DEBUG MESSAGE  @G51DGGB*/ 01744000
         BAL   @14,PRINTIT                                         0790 01745000
*END;                                                      /*@G51DGGB*/ 01746000
@EL00014 DS    0H                                                  0791 01747000
@EF00014 DS    0H                                                  0791 01748000
@ER00014 LM    @14,@12,@SA00014                                    0791 01749000
         BR    @14                                                 0791 01750000
*ALLREC: PROC;  /*FILTER BY DATE, TIME.                      @Z427VLS*/ 01751000
ALLREC   STM   @14,@12,12(@13)                                     0792 01752000
*PASSFLAG = YES; /*RECORD SELECTED IF PASSFLAG NOT SET TO NO @Z427VLS*/ 01753000
         OI    PASSFLAG(R2),B'00000001'                            0793 01754000
*IF (LRTDAY & '000F'X) = '000F'X THEN  /*PROTECT CVD FROM POSSIBLE  */  01755000
         MVC   @TS00001(2),LRTDAY(R7)                              0794 01756000
         NC    @TS00001(2),@CB01061                                0794 01757000
         CLC   @TS00001(2),@CB01061                                0794 01758000
         BNE   @RF00794                                            0794 01759000
*DO;                                   /*ABEND IF DATA IS BAD       */  01760000
*IF LRTDATE >= STDATE & LRTDATE <= ENDDATE THEN                    0796 01761000
         CLC   LRTDATE(4,R7),STDATE(R2)                            0796 01762000
         BL    @RF00796                                            0796 01763000
         CLC   LRTDATE(4,R7),ENDDATE(R2)                           0796 01764000
         BH    @RF00796                                            0796 01765000
*  DO;                                                     /*@Z427VLS*/ 01766000
*    IF (LRTTIME >= STTIME1 & LRTTIME <= ENDTIME1) |               0798 01767000
*       (LRTTIME >= STTIME2 & LRTTIME <= ENDTIME2) THEN            0798 01768000
         CLC   LRTTIME(4,R7),STTIME1(R2)                           0798 01769000
         BL    @GL00032                                            0798 01770000
         CLC   LRTTIME(4,R7),ENDTIME1(R2)                          0798 01771000
         BNH   @RT00798                                            0798 01772000
@GL00032 CLC   LRTTIME(4,R7),STTIME2(R2)                           0798 01773000
         BL    @RF00798                                            0798 01774000
         CLC   LRTTIME(4,R7),ENDTIME2(R2)                          0798 01775000
         BH    @RF00798                                            0798 01776000
@RT00798 DS    0H                                                  0799 01777000
*      DO;                                                 /*@Z427VLS*/ 01778000
*        IF SHIFT3RD = ON &                                        0800 01779000
*        /*IF CROSS MIDNIGHT BOUNDARY, ELIMINATE NON-THIRD SHIFT*/ 0800 01780000
*        /*INTERVALS                                         @Z427VLS*/ 01781000
*          ((LRTDATE = STDATE & LRTTIME < STTIME1) |               0800 01782000
*           (LRTDATE = ENDDATE & LRTTIME > ENDTIME2))              0800 01783000
*           THEN                                                   0800 01784000
         TM    SHIFT3RD(R2),B'00010000'                            0800 01785000
         BNO   @RF00800                                            0800 01786000
         CLC   LRTDATE(4,R7),STDATE(R2)                            0800 01787000
         BNE   @GL00036                                            0800 01788000
         CLC   LRTTIME(4,R7),STTIME1(R2)                           0800 01789000
         BL    @RT00800                                            0800 01790000
@GL00036 CLC   LRTDATE(4,R7),ENDDATE(R2)                           0800 01791000
         BNE   @RF00800                                            0800 01792000
         CLC   LRTTIME(4,R7),ENDTIME2(R2)                          0800 01793000
         BNH   @RF00800                                            0800 01794000
@RT00800 DS    0H                                                  0801 01795000
*             DO;                                          /*@Z427VLS*/ 01796000
*              PASSFLAG = NO;                              /*@Z427VLS*/ 01797000
         NI    PASSFLAG(R2),B'11111110'                            0802 01798000
*              OUTTHIRD = OUTTHIRD + ONE;                  /*@Z427VLS*/ 01799000
         LA    @08,1                                               0803 01800000
         AL    @08,OUTTHIRD                                        0803 01801000
         ST    @08,OUTTHIRD                                        0803 01802000
*             END;                                         /*@Z427VLS*/ 01803000
*      END;                                                /*@Z427VLS*/ 01804000
*    ELSE                                                          0806 01805000
*     DO;                                                  /*@Z427VLS*/ 01806000
         B     @RC00798                                            0806 01807000
@RF00798 DS    0H                                                  0807 01808000
*      PASSFLAG = NO;                                      /*@Z427VLS*/ 01809000
         NI    PASSFLAG(R2),B'11111110'                            0807 01810000
*      OUTTIME = OUTTIME + ONE;                            /*@Z427VLS*/ 01811000
         LA    @08,1                                               0808 01812000
         AL    @08,OUTTIME                                         0808 01813000
         ST    @08,OUTTIME                                         0808 01814000
*     END;                                                 /*@Z427VLS*/ 01815000
*   END;                                                   /*@Z427VLS*/ 01816000
*  ELSE                                                            0811 01817000
*  DO;                                                     /*@Z427VLS*/ 01818000
         B     @RC00796                                            0811 01819000
@RF00796 DS    0H                                                  0812 01820000
*   PASSFLAG = NO;                                         /*@Z427VLS*/ 01821000
         NI    PASSFLAG(R2),B'11111110'                            0812 01822000
*   OUTDATE = OUTDATE + ONE;                               /*@Z427VLS*/ 01823000
         LA    @08,1                                               0813 01824000
         AL    @08,OUTDATE                                         0813 01825000
         ST    @08,OUTDATE                                         0813 01826000
*  IF DEBUG38 = ON & LRTDATE > ENDDATE THEN  /*DOES THE USER WANT TO*/  01827000
         TM    DEBUG38(R2),B'00000010'                             0814 01828000
         BNO   @RF00814                                            0814 01829000
         CLC   LRTDATE(4,R7),ENDDATE(R2)                           0814 01830000
         BNH   @RF00814                                            0814 01831000
*   WEAREFIN = ON;    /*STOP WHEN WE ARE PAST THE STOP DATE ON THE */   01832000
         OI    WEAREFIN,B'00000010'                                0815 01833000
*                     /*INPUT DATA SET AFTER READ WILL ACT AS IF EOF*/  01834000
*                     /*HAS BEEN FOUND ON INPUT DATA SET     @0099VLS*/ 01835000
*  END;                                                    /*@Z427VLS*/ 01836000
*END;                                                      /*@Z427VLS*/ 01837000
*ELSE                                                              0818 01838000
*DO;                                                       /*@Z427VLS*/ 01839000
         B     @RC00794                                            0818 01840000
@RF00794 DS    0H                                                  0819 01841000
*PASSFLAG = NO;                                            /*@Z427VLS*/ 01842000
         NI    PASSFLAG(R2),B'11111110'                            0819 01843000
*BADTIME = BADTIME + ONE;                                  /*@Z427VLS*/ 01844000
         LA    @08,1                                               0820 01845000
         AL    @08,BADTIME                                         0820 01846000
         ST    @08,BADTIME                                         0820 01847000
*END;                                                      /*@Z427VLS*/ 01848000
*END;                                                      /*@Z427VLS*/ 01849000
@EL00015 DS    0H                                                  0822 01850000
@EF00015 DS    0H                                                  0822 01851000
@ER00015 LM    @14,@12,12(@13)                                     0822 01852000
         BR    @14                                                 0822 01853000
*RECDEP: PROC; /*IDENTIFY RECORD TYPE, SET SORT TABLE KEY    @Z427VLS*/ 01854000
RECDEP   STM   @14,@12,@SA00016                                    0823 01855000
*              /*PERFORM FILTERING                           @Z427VLS*/ 01856000
*IF LRTRUNC = ON THEN                                              0824 01857000
         TM    LRTRUNC(R7),B'00100000'                             0824 01858000
         BNO   @RF00824                                            0824 01859000
*  DO;                                                     /*@Z427VLS*/ 01860000
*   TRUNCT = TRUNCT + 1  ;                                 /*@Z427VLS*/ 01861000
         LA    @08,1                                               0826 01862000
         AL    @08,TRUNCT                                          0826 01863000
         ST    @08,TRUNCT                                          0826 01864000
*   PASSFLAG = OFF;                                        /*@Z427VLS*/ 01865000
         NI    PASSFLAG(R2),B'11111110'                            0827 01866000
*  END;                                                    /*@Z427VLS*/ 01867000
* ELSE                                                             0829 01868000
*  DO;                                                     /*@Z427VLS*/ 01869000
         B     @RC00824                                            0829 01870000
@RF00824 DS    0H                                                  0830 01871000
*IF  (RTYP1 < ONE  )                                               0830 01872000
*                | (RTYP1 > NINE ) THEN                            0830 01873000
         L     @08,RTYP1                                           0830 01874000
         LTR   @08,@08                                             0830 01875000
         BNP   @RT00830                                            0830 01876000
         C     @08,@CF00035                                        0830 01877000
         BNH   @RF00830                                            0830 01878000
@RT00830 DS    0H                                                  0831 01879000
*   DO;                                                    /*@Z427VLS*/ 01880000
*     WHATYPE = WHATYPE + 1;                               /*@Z427VLS*/ 01881000
         LA    @08,1                                               0832 01882000
         AL    @08,WHATYPE                                         0832 01883000
         ST    @08,WHATYPE                                         0832 01884000
*     PASSFLAG = OFF;                                      /*@Z427VLS*/ 01885000
         NI    PASSFLAG(R2),B'11111110'                            0833 01886000
*   END;                                                   /*@Z427VLS*/ 01887000
*ELSE                                                              0835 01888000
*  DO;                                                     /*@Z427VLS*/ 01889000
         B     @RC00830                                            0835 01890000
@RF00830 DS    0H                                                  0836 01891000
*    IF RTYP1 = THREE THEN                                         0836 01892000
         CLC   RTYP1(4),@CF00076                                   0836 01893000
         BNE   @RF00836                                            0836 01894000
*      CALL OBRFILT;                                       /*@Z427VLS*/ 01895000
         BAL   @14,OBRFILT                                         0837 01896000
*    ELSE                                                          0838 01897000
*      DO;                                                 /*@Z427VLS*/ 01898000
         B     @RC00836                                            0838 01899000
@RF00836 DS    0H                                                  0839 01900000
*        IF RTYP1 = NINE  THEN                                     0839 01901000
         CLC   RTYP1(4),@CF00035                                   0839 01902000
         BNE   @RF00839                                            0839 01903000
*          CALL MDRFILT;                                   /*@Z427VLS*/ 01904000
         BAL   @14,MDRFILT                                         0840 01905000
*        ELSE                                                      0841 01906000
*          DO;                                             /*@Z427VLS*/ 01907000
         B     @RC00839                                            0841 01908000
@RF00839 DS    0H                                                  0842 01909000
*            IF RTYP1 = ONE   THEN                                 0842 01910000
         CLC   RTYP1(4),@CF00055                                   0842 01911000
         BNE   @RF00842                                            0842 01912000
*              CALL MCHFILT;                               /*@Z427VLS*/ 01913000
         BAL   @14,MCHFILT                                         0843 01914000
*            ELSE                                                  0844 01915000
*             DO;                                          /*@Z427VLS*/ 01916000
         B     @RC00842                                            0844 01917000
@RF00842 DS    0H                                                  0845 01918000
*               IF RTYP1 = TWO   THEN                              0845 01919000
         CLC   RTYP1(4),@CF00074                                   0845 01920000
         BNE   @RF00845                                            0845 01921000
*                 CALL CCHFILT;                            /*@Z427VLS*/ 01922000
         BAL   @14,CCHFILT                                         0846 01923000
*               ELSE                                               0847 01924000
*                DO;                                       /*@Z427VLS*/ 01925000
         B     @RC00845                                            0847 01926000
@RF00845 DS    0H                                                  0848 01927000
*                   IF RTYP1 = FOUR  THEN                          0848 01928000
         CLC   RTYP1(4),@CF00064                                   0848 01929000
         BNE   @RF00848                                            0848 01930000
*                     CALL SOFTFILT;                       /*@Z427VLS*/ 01931000
         BAL   @14,SOFTFILT                                        0849 01932000
*                   ELSE                                           0850 01933000
*                     DO;                                  /*@Z427VLS*/ 01934000
         B     @RC00848                                            0850 01935000
@RF00848 DS    0H                                                  0851 01936000
*                       IF RTYP1 = FIVE  THEN                      0851 01937000
         CLC   RTYP1(4),@CF00079                                   0851 01938000
         BNE   @RF00851                                            0851 01939000
*                         CALL IPLFILT;                    /*@Z427VLS*/ 01940000
         BAL   @14,IPLFILT                                         0852 01941000
*                       ELSE                                       0853 01942000
*                         DO;                              /*@Z427VLS*/ 01943000
         B     @RC00851                                            0853 01944000
@RF00851 DS    0H                                                  0854 01945000
*                           IF RTYP1 = SIX   THEN                  0854 01946000
         CLC   RTYP1(4),@CF00081                                   0854 01947000
         BNE   @RF00854                                            0854 01948000
*                             CALL DDRFILT;                /*@Z427VLS*/ 01949000
         BAL   @14,DDRFILT                                         0855 01950000
*                           ELSE                                   0856 01951000
*                             DO;                          /*@Z427VLS*/ 01952000
         B     @RC00854                                            0856 01953000
@RF00854 DS    0H                                                  0857 01954000
*                               IF RTYP1 = SEVEN THEN              0857 01955000
         CLC   RTYP1(4),@CF00083                                   0857 01956000
         BNE   @RF00857                                            0857 01957000
*                                 CALL MIHFILT;            /*@Z427VLS*/ 01958000
         BAL   @14,MIHFILT                                         0858 01959000
*                               ELSE                               0859 01960000
*                                 CALL EODFILT;            /*@Z427VLS*/ 01961000
         B     @RC00857                                            0859 01962000
@RF00857 BAL   @14,EODFILT                                         0859 01963000
*                             END;                         /*@Z427VLS*/ 01964000
*                         END;                             /*@Z427VLS*/ 01965000
*                     END;                                 /*@Z427VLS*/ 01966000
*                 END;                                     /*@Z427VLS*/ 01967000
*             END;                                         /*@Z427VLS*/ 01968000
*         END;                                             /*@Z427VLS*/ 01969000
*     END;                                                 /*@Z427VLS*/ 01970000
*   END;                                                   /*@Z427VLS*/ 01971000
*  END;                                                    /*@Z427VLS*/ 01972000
*END;                                                      /*@Z427VLS*/ 01973000
@EL00016 DS    0H                                                  0869 01974000
@EF00016 DS    0H                                                  0869 01975000
@ER00016 LM    @14,@12,@SA00016                                    0869 01976000
         BR    @14                                                 0869 01977000
*SIFTSORT: PROC;                                           /*@Z427VLS*/ 01978000
SIFTSORT STM   @14,@12,@SA00017                                    0870 01979000
*/* SORT THAT ONLY EXAMINES AN ENTRY ONCE IF DATA IS IN ORDER*/    0871 01980000
* IF DEBUG23^= ON & I > TWO THEN /*NO SORT IF ONLY 1         @Z427VLS*/ 01981000
         TM    DEBUG23(R2),B'00000001'                             0871 01982000
         BO    @RF00871                                            0871 01983000
         CLC   I(4),@CF00074                                       0871 01984000
         BNH   @RF00871                                            0871 01985000
* DO;                                                      /*@Z427VLS*/ 01986000
*SRTCONT =((PASSNUM-1) * 10)  + SORTADR;                   /*@Z427VLS*/ 01987000
         L     @08,PASSNUM                                         0873 01988000
         BCTR  @08,0                                               0873 01989000
         MH    @08,@CH00034                                        0873 01990000
         AL    @08,SORTADR(,R2)                                    0873 01991000
         ST    @08,SRTCONT                                         0873 01992000
*/* THIS SORT IS DONE IN BAL IN ORDER TO GET MIN PROCESSING TIME    */  01993000
*/* SOME 35 INSTRUCTIONS WERE CUT FROM THE BEST THAT PLS WOULD DO   */  01994000
*/* THIS CUT THE RUN TIME DOWN BY APP. 50 PERCENT            @Z427VLS*/ 01995000
*         GENERATE REFS(SORTKEY,SORTABLE);                 /*@Z427VLS*/ 01996000
          LA     R15,10              LOAD THE INCREMENT VALUE           01997000
          L      R3,SORTADR(R2)      LOAD THE START OF THE TABLE        01998000
          L      R4,SRTCONT          LOAD THE MAX LIMIT                 01999000
          LR     R1,R3               SET UP THE STOP LIMIT ON BACK UP   02000000
          B      DOIT                GO AROUND THIS CODE FIRST TIME     02001000
LOOPBCK1  ALR    R3,R15              MOVE THE POINTER TO NEXT ENTRY     02002000
          CR     R3,R4               ARE WE POINTING TO LAST ENTRY      02003000
          BNL    DONE                FINISHED WITH THE SORT SO EXIT     02004000
DOIT      CLC    SORTKEY(5,R3),SORTABLE+10(R3)                          02005000
          BNH    LOOPBCK1            DONT NEED TO SORT ITEM             02006000
          XC     SORTABLE(10,R3),SORTABLE+10(R3)                        02007000
          XC     SORTABLE+10(10,R3),SORTABLE(R3)                        02008000
          XC     SORTABLE(10,R3),SORTABLE+10(R3)                        02009000
          LR     R6,R3               SET NEW POINTER(BACKWARD)          02010000
LOOPBCK2  SR     R6,R15              POINT TO LAST ENTRY                02011000
          CR     R6,R1               DONT BACK OUT OF THE TABLE         02012000
          BL     LOOPBCK1            START WITH NEXT ENTRY              02013000
          CLC    SORTABLE(10,R6),SORTABLE+10(R6)                        02014000
          BNH    LOOPBCK1            NO FUTHER SHUFFEL THIS SAMPLE      02015000
          XC     SORTABLE+10(10,R6),SORTABLE(R6)                        02016000
          XC     SORTABLE(10,R6),SORTABLE+10(R6)                        02017000
          XC     SORTABLE+10(10,R6),SORTABLE(R6)                        02018000
          B      LOOPBCK2            DOES IT NEED TO BE MOVED AGAIN     02019000
DONE      EQU    *                                                      02020000
*SORTSW = OFF; /*SORT EVTABLE BY CPU MODEL, SERIAL IN DESCENDING ORDR*/ 02021000
         NI    SORTSW,B'10111111'                                  0875 02022000
*DO J = 1 BY 1 TO EVNUM - 1;                               /*@Z427VLS*/ 02023000
         LA    @08,1                                               0876 02024000
         ST    @08,J                                               0876 02025000
         B     @DE00876                                            0876 02026000
@DL00876 DS    0H                                                  0877 02027000
*  IF EVKEY(J) < EVKEY(J+1) THEN                                   0877 02028000
         LR    @06,@08                                             0877 02029000
         MH    @06,@CH00081                                        0877 02030000
         L     @03,EVPTR(,R2)                                      0877 02031000
         ST    @06,@TF00001                                        0877 02032000
         ALR   @06,@03                                             0877 02033000
         LR    @01,@03                                             0877 02034000
         AL    @01,@TF00001                                        0877 02035000
         CLC   EVKEY-6(6,@06),EVKEY(@01)                           0877 02036000
         BNL   @RF00877                                            0877 02037000
*    DO;                                                   /*@Z427VLS*/ 02038000
*      EVKEY(J) = (EVKEY(J)    &&   EVKEY(J+1));           /*@Z427VLS*/ 02039000
         LR    @06,@03                                             0879 02040000
         AL    @06,@TF00001                                        0879 02041000
         LR    @01,@03                                             0879 02042000
         AL    @01,@TF00001                                        0879 02043000
         XC    EVKEY-6(6,@06),EVKEY(@01)                           0879 02044000
*      EVKEY(J+1) = (EVKEY(J+1) &&  EVKEY(J));             /*@Z427VLS*/ 02045000
         LR    @06,@03                                             0880 02046000
         AL    @06,@TF00001                                        0880 02047000
         LR    @01,@03                                             0880 02048000
         AL    @01,@TF00001                                        0880 02049000
         XC    EVKEY(6,@06),EVKEY-6(@01)                           0880 02050000
*      EVKEY(J) = (EVKEY(J)    &&   EVKEY(J+1));           /*@Z427VLS*/ 02051000
         LR    @06,@03                                             0881 02052000
         AL    @06,@TF00001                                        0881 02053000
         AL    @03,@TF00001                                        0881 02054000
         XC    EVKEY-6(6,@06),EVKEY(@03)                           0881 02055000
*  SORTSW = OFF;                                           /*@Z427VLS*/ 02056000
         NI    SORTSW,B'10111111'                                  0882 02057000
*  DO K = J BY -1 TO 2 WHILE (SORTSW = OFF);               /*@Z427VLS*/ 02058000
         ST    @08,K                                               0883 02059000
         B     @DE00883                                            0883 02060000
@DL00883 TM    SORTSW,B'01000000'                                  0883 02061000
         BNZ   @DC00883                                            0883 02062000
*  IF EVKEY(K) > EVKEY(K-1) THEN /*DO WE NEED TO BACK UP     @0001VLS*/ 02063000
         MH    @08,@CH00081                                        0884 02064000
         L     @06,EVPTR(,R2)                                      0884 02065000
         ST    @08,@TF00001                                        0884 02066000
         ALR   @08,@06                                             0884 02067000
         LR    @03,@06                                             0884 02068000
         AL    @03,@TF00001                                        0884 02069000
         AL    @03,@CF01625                                        0884 02070000
         CLC   EVKEY-6(6,@08),EVKEY-6(@03)                         0884 02071000
         BNH   @RF00884                                            0884 02072000
*      DO;                                                 /*@Z427VLS*/ 02073000
*        EVKEY(K)    = (EVKEY(K)   &&    EVKEY(K-1));      /*@Z427VLS*/ 02074000
         LR    @08,@06                                             0886 02075000
         AL    @08,@TF00001                                        0886 02076000
         LR    @03,@06                                             0886 02077000
         AL    @03,@TF00001                                        0886 02078000
         AL    @03,@CF01625                                        0886 02079000
         XC    EVKEY-6(6,@08),EVKEY-6(@03)                         0886 02080000
*        EVKEY(K-1)  = (EVKEY(K-1) &&    EVKEY(K));        /*@Z427VLS*/ 02081000
         LR    @08,@06                                             0887 02082000
         AL    @08,@TF00001                                        0887 02083000
         AL    @08,@CF01625                                        0887 02084000
         LR    @03,@06                                             0887 02085000
         AL    @03,@TF00001                                        0887 02086000
         XC    EVKEY-6(6,@08),EVKEY-6(@03)                         0887 02087000
*        EVKEY(K)    = (EVKEY(K)   &&    EVKEY(K-1));      /*@Z427VLS*/ 02088000
         LR    @08,@06                                             0888 02089000
         AL    @08,@TF00001                                        0888 02090000
         AL    @06,@TF00001                                        0888 02091000
         AL    @06,@CF01625                                        0888 02092000
         XC    EVKEY-6(6,@08),EVKEY-6(@06)                         0888 02093000
*      END;                                                /*@Z427VLS*/ 02094000
*    ELSE SORTSW = ON;                                     /*@Z427VLS*/ 02095000
         B     @RC00884                                            0890 02096000
@RF00884 OI    SORTSW,B'01000000'                                  0890 02097000
*  END;                                                    /*@Z427VLS*/ 02098000
@RC00884 SLR   @08,@08                                             0891 02099000
         BCTR  @08,0                                               0891 02100000
         AL    @08,K                                               0891 02101000
         ST    @08,K                                               0891 02102000
@DE00883 C     @08,@CF00074                                        0891 02103000
         BNL   @DL00883                                            0891 02104000
@DC00883 DS    0H                                                  0892 02105000
*  END;                                                    /*@Z427VLS*/ 02106000
* END;                                                     /*@Z427VLS*/ 02107000
@RF00877 LA    @08,1                                               0893 02108000
         AL    @08,J                                               0893 02109000
         ST    @08,J                                               0893 02110000
@DE00876 L     @06,EVPTR(,R2)                                      0893 02111000
         LH    @06,EVNUM(,@06)                                     0893 02112000
         BCTR  @06,0                                               0893 02113000
         CR    @08,@06                                             0893 02114000
         BNH   @DL00876                                            0893 02115000
* END;                                                     /*@Z427VLS*/ 02116000
*DO I = 1 BY 1 TO EVNUM;                                   /*@Z427VLS*/ 02117000
@RF00871 LA    @08,1                                               0895 02118000
         ST    @08,I                                               0895 02119000
         B     @DE00895                                            0895 02120000
@DL00895 DS    0H                                                  0896 02121000
* EVLETTER(I) = LETTERS(I);                                /*@Z427VLS*/ 02122000
         LR    @06,@08                                             0896 02123000
         MH    @06,@CH00081                                        0896 02124000
         L     @03,EVPTR(,R2)                                      0896 02125000
         ALR   @03,@06                                             0896 02126000
         LA    @06,LETTERS-1(@08)                                  0896 02127000
         MVC   EVLETTER-6(1,@03),0(@06)                            0896 02128000
*END;                                                      /*@Z427VLS*/ 02129000
         AL    @08,@CF00055                                        0897 02130000
         ST    @08,I                                               0897 02131000
@DE00895 L     @06,EVPTR(,R2)                                      0897 02132000
         CH    @08,EVNUM(,@06)                                     0897 02133000
         BNH   @DL00895                                            0897 02134000
*  END;                                                    /*@Z427VLS*/ 02135000
@EL00017 DS    0H                                                  0898 02136000
@EF00017 DS    0H                                                  0898 02137000
@ER00017 LM    @14,@12,@SA00017                                    0898 02138000
         BR    @14                                                 0898 02139000
*OBRFILT: PROC;                                            /*@Z427VLS*/ 02140000
OBRFILT  STM   @14,@12,@SA00018                                    0899 02141000
*IF POBR = OFF THEN                                                0900 02142000
         TM    POBR(R2),B'00100000'                                0900 02143000
         BNZ   @RF00900                                            0900 02144000
*  DO;                                                     /*@0099VLS*/ 02145000
*  RDEPCT(RTYP1) = RDEPCT(RTYP1) + ONE;  /*ADD TO THE COUNT OF THIS*/   02146000
         L     @08,RTYP1                                           0902 02147000
         SLA   @08,2                                               0902 02148000
         LA    @06,1                                               0902 02149000
         AL    @06,RDEPCT-4(@08)                                   0902 02150000
         ST    @06,RDEPCT-4(@08)                                   0902 02151000
*  PASSFLAG=OFF;                                           /*@Z427VLS*/ 02152000
         NI    PASSFLAG(R2),B'11111110'                            0903 02153000
*  END;                                                    /*@0099VLS*/ 02154000
*ELSE                                                              0905 02155000
*  DO;                                                     /*@Z427VLS*/ 02156000
         B     @RC00900                                            0905 02157000
@RF00900 DS    0H                                                  0906 02158000
*    IF SHORTSW = ON THEN                                          0906 02159000
         TM    SHORTSW(R7),B'00100000'                             0906 02160000
         BNO   @RF00906                                            0906 02161000
*      DO;                                                 /*@Z427VLS*/ 02162000
*        WORKCUA = (OBRSCUA & ONLYCUA3);                   /*@Z427VLS*/ 02163000
         MVC   WORKCUA(3),OBRSCUA(R7)                              0908 02164000
         NC    WORKCUA(3),@CB01043                                 0908 02165000
*        WORKDEV = OBRSDEV2;                               /*@Z427VLS*/ 02166000
         MVC   WORKDEV(2),OBRSDEV2(R7)                             0909 02167000
*      END;                                                /*@Z427VLS*/ 02168000
*    ELSE                                                          0911 02169000
*      DO;                                                 /*@Z427VLS*/ 02170000
         B     @RC00906                                            0911 02171000
@RF00906 DS    0H                                                  0912 02172000
*        WORKCUA = (OBRPCUA & ONLYCUA3);                   /*@Z427VLS*/ 02173000
         MVC   WORKCUA(3),OBRPCUA(R7)                              0912 02174000
         NC    WORKCUA(3),@CB01043                                 0912 02175000
*        WORKDEV = OBRDEV;                                 /*@Z427VLS*/ 02176000
         MVC   WORKDEV(2),OBRDEV(R7)                               0913 02177000
*        IF WORKDEV = DEV23051 |                                   0914 02178000
*           WORKDEV = DEV23052 THEN                                0914 02179000
         CLC   WORKDEV(2),@CB01007                                 0914 02180000
         BE    @RT00914                                            0914 02181000
         CLC   WORKDEV(2),@CB01009                                 0914 02182000
         BNE   @RF00914                                            0914 02183000
@RT00914 DS    0H                                                  0915 02184000
*           WORKCUA = (WORKCUA & NOUNIT3);                 /*@Z427VLS*/ 02185000
         NC    WORKCUA(3),@CB01037                                 0915 02186000
*      END;                                                /*@Z427VLS*/ 02187000
@RF00914 DS    0H                                                  0917 02188000
*    IF CUAPTR ^= ZERO THEN                                        0917 02189000
@RC00906 L     @08,CUAPTR(,R2)                                     0917 02190000
         LTR   @08,@08                                             0917 02191000
         BZ    @RF00917                                            0917 02192000
*      CALL CUASELCT;                                      /*@Z427VLS*/ 02193000
         BAL   @14,CUASELCT                                        0918 02194000
*    IF PASSFLAG = YES  &  DEVPTR ^= ZERO THEN                     0919 02195000
@RF00917 TM    PASSFLAG(R2),B'00000001'                            0919 02196000
         BNO   @RF00919                                            0919 02197000
         L     @08,DEVPTR(,R2)                                     0919 02198000
         LTR   @08,@08                                             0919 02199000
         BZ    @RF00919                                            0919 02200000
*      CALL DEVSEL;                                        /*@Z427VLS*/ 02201000
         BAL   @14,DEVSEL                                          0920 02202000
*   IF PASSFLAG = YES & VOLPTR ^= ZERO THEN                        0921 02203000
@RF00919 TM    PASSFLAG(R2),B'00000001'                            0921 02204000
         BNO   @RF00921                                            0921 02205000
         L     @08,VOLPTR(,R2)                                     0921 02206000
         LTR   @08,@08                                             0921 02207000
         BZ    @RF00921                                            0921 02208000
*      CALL VOLID;                  /*DO VOLUME SELECTION    @0099VLS*/ 02209000
         BAL   @14,VOLID                                           0922 02210000
*   IF PASSFLAG = YES & TERMTRY = ONE  THEN                        0923 02211000
@RF00921 TM    PASSFLAG(R2),B'00000001'                            0923 02212000
         BNO   @RF00923                                            0923 02213000
         CLC   TERMTRY(4),@CF00055                                 0923 02214000
         BNE   @RF00923                                            0923 02215000
*      CALL TERMID;                 /*DO TERMINAL SELECTION  @0099VLS*/ 02216000
         BAL   @14,TERMID                                          0924 02217000
*   END;                                                   /*@Z427VLS*/ 02218000
* END;                                                     /*@Z427VLS*/ 02219000
@EL00018 DS    0H                                                  0926 02220000
@EF00018 DS    0H                                                  0926 02221000
@ER00018 LM    @14,@12,@SA00018                                    0926 02222000
         BR    @14                                                 0926 02223000
*MDRFILT: PROC;   /*MISCELLANEOUS DATA RECORD FILTER.        @Z427VLS*/ 02224000
MDRFILT  STM   @14,@12,@SA00019                                    0927 02225000
*                 /*PASSFLAG IS TURNED OFF IF RECORD FAILS   @Z427VLS*/ 02226000
*IF PTTYP = OFF THEN  /*ARE MDR RECORDS SELECTED             @Z427VLS*/ 02227000
         TM    PTTYP(R2),B'10000000'                               0928 02228000
         BNZ   @RF00928                                            0928 02229000
*  DO;                                                     /*@0099VLS*/ 02230000
*  RDEPCT(RTYP1) = RDEPCT(RTYP1) + ONE;  /*ADD TO THE COUNT OF THIS*/   02231000
         L     @08,RTYP1                                           0930 02232000
         SLA   @08,2                                               0930 02233000
         LA    @06,1                                               0930 02234000
         AL    @06,RDEPCT-4(@08)                                   0930 02235000
         ST    @06,RDEPCT-4(@08)                                   0930 02236000
*  PASSFLAG = OFF;                                         /*@Z427VLS*/ 02237000
         NI    PASSFLAG(R2),B'11111110'                            0931 02238000
*  END;                                                    /*@0099VLS*/ 02239000
*ELSE                                                              0933 02240000
*  DO;                                                     /*@Z427VLS*/ 02241000
         B     @RC00928                                            0933 02242000
@RF00928 DS    0H                                                  0934 02243000
*    WORKMOD = (TPRCUA & ONLYCUA2);                        /*@Z427VLS*/ 02244000
         MVC   WORKMOD(2),TPRCUA(R7)                               0934 02245000
         NC    WORKMOD(2),@CB01041                                 0934 02246000
*    IF TPRDEV = DV23051 | TPRDEV = DV23052 THEN                   0935 02247000
         CLI   TPRDEV(R7),X'12'                                    0935 02248000
         BE    @RT00935                                            0935 02249000
         CLI   TPRDEV(R7),X'02'                                    0935 02250000
         BNE   @RF00935                                            0935 02251000
@RT00935 DS    0H                                                  0936 02252000
*      WORKMOD = (WORKMOD & NOUNIT2); /*HEAVEN ONLY KNOWS WHY*/    0936 02253000
         NC    WORKMOD(2),@CB01039                                 0936 02254000
*    IF CUAPTR ^= ZERO THEN                                        0937 02255000
@RF00935 L     @08,CUAPTR(,R2)                                     0937 02256000
         LTR   @08,@08                                             0937 02257000
         BZ    @RF00937                                            0937 02258000
*      CALL CUASELCT;                                      /*@Z427VLS*/ 02259000
         BAL   @14,CUASELCT                                        0938 02260000
*    IF PASSFLAG = YES & DEVPTR ^= ZERO THEN                       0939 02261000
@RF00937 TM    PASSFLAG(R2),B'00000001'                            0939 02262000
         BNO   @RF00939                                            0939 02263000
         L     @08,DEVPTR(,R2)                                     0939 02264000
         LTR   @08,@08                                             0939 02265000
         BZ    @RF00939                                            0939 02266000
*      CALL DEVSEL;                                        /*@Z427VLS*/ 02267000
         BAL   @14,DEVSEL                                          0940 02268000
*   IF PASSFLAG = YES & VOLPTR ^= ZERO THEN                        0941 02269000
@RF00939 TM    PASSFLAG(R2),B'00000001'                            0941 02270000
         BNO   @RF00941                                            0941 02271000
         L     @08,VOLPTR(,R2)                                     0941 02272000
         LTR   @08,@08                                             0941 02273000
         BZ    @RF00941                                            0941 02274000
*      CALL VOLID;                 /*DO VOLUME SELECTION     @0099VLS*/ 02275000
         BAL   @14,VOLID                                           0942 02276000
*  END;                                                    /*@Z427VLS*/ 02277000
*END;                                                      /*@Z427VLS*/ 02278000
@EL00019 DS    0H                                                  0944 02279000
@EF00019 DS    0H                                                  0944 02280000
@ER00019 LM    @14,@12,@SA00019                                    0944 02281000
         BR    @14                                                 0944 02282000
*DDRFILT: PROC;                                            /*@Z427VLS*/ 02283000
DDRFILT  STM   @14,@12,@SA00020                                    0945 02284000
*IF PDDR = OFF THEN                                                0946 02285000
         TM    PDDR(R2),B'00000100'                                0946 02286000
         BNZ   @RF00946                                            0946 02287000
*  DO;                                                     /*@0099VLS*/ 02288000
*  RDEPCT(RTYP1) = RDEPCT(RTYP1) + ONE;  /*ADD TO THE COUNT OF THIS*/   02289000
         L     @08,RTYP1                                           0948 02290000
         SLA   @08,2                                               0948 02291000
         LA    @06,1                                               0948 02292000
         AL    @06,RDEPCT-4(@08)                                   0948 02293000
         ST    @06,RDEPCT-4(@08)                                   0948 02294000
*  PASSFLAG = OFF;                                         /*@Z427VLS*/ 02295000
         NI    PASSFLAG(R2),B'11111110'                            0949 02296000
*  END;                                                    /*@0099VLS*/ 02297000
*ELSE                                                              0951 02298000
*  DO;                                                     /*@Z427VLS*/ 02299000
         B     @RC00946                                            0951 02300000
@RF00946 DS    0H                                                  0952 02301000
*    WORKDEV = DDRFCUA;                                    /*@Z427VLS*/ 02302000
         MVC   WORKDEV(2),DDRFCUA(R7)                              0952 02303000
*    WORKMOD = DDRCODE2;                                   /*@Z427VLS*/ 02304000
         MVC   WORKMOD(2),DDRCODE2(R7)                             0953 02305000
*    IF CUAPTR ^= ZERO THEN                                        0954 02306000
         L     @08,CUAPTR(,R2)                                     0954 02307000
         LTR   @08,@08                                             0954 02308000
         BZ    @RF00954                                            0954 02309000
*      CALL CUASELCT;                                      /*@Z427VLS*/ 02310000
         BAL   @14,CUASELCT                                        0955 02311000
*    IF PASSFLAG = YES  &  DEVPTR ^= ZERO THEN                     0956 02312000
@RF00954 TM    PASSFLAG(R2),B'00000001'                            0956 02313000
         BNO   @RF00956                                            0956 02314000
         L     @08,DEVPTR(,R2)                                     0956 02315000
         LTR   @08,@08                                             0956 02316000
         BZ    @RF00956                                            0956 02317000
*      CALL DEVSEL;                                        /*@Z427VLS*/ 02318000
         BAL   @14,DEVSEL                                          0957 02319000
*    IF PASSFLAG = YES & VOLPTR ^= ZERO THEN                       0958 02320000
@RF00956 TM    PASSFLAG(R2),B'00000001'                            0958 02321000
         BNO   @RF00958                                            0958 02322000
         L     @08,VOLPTR(,R2)                                     0958 02323000
         LTR   @08,@08                                             0958 02324000
         BZ    @RF00958                                            0958 02325000
*       CALL VOLID;               /*GO AND DO THE VOLUME SELECTION*/    02326000
         BAL   @14,VOLID                                           0959 02327000
*  END;                                                    /*@Z427VLS*/ 02328000
*END;                                                      /*@Z427VLS*/ 02329000
@EL00020 DS    0H                                                  0961 02330000
@EF00020 DS    0H                                                  0961 02331000
@ER00020 LM    @14,@12,@SA00020                                    0961 02332000
         BR    @14                                                 0961 02333000
*/*                                                          @Z427VLS*/ 02334000
*/*                                                          @Z427VLS*/ 02335000
*MIHFILT: PROC;                                            /*@Z427VLS*/ 02336000
MIHFILT  STM   @14,@12,@SA00021                                    0962 02337000
*IF PMIH = OFF THEN                                                0963 02338000
         TM    PMIH(R2),B'00000010'                                0963 02339000
         BNZ   @RF00963                                            0963 02340000
*  DO;                                                     /*@0099VLS*/ 02341000
*  RDEPCT(RTYP1) = RDEPCT(RTYP1) + ONE;  /*ADD TO THE COUNT OF THIS*/   02342000
         L     @08,RTYP1                                           0965 02343000
         SLA   @08,2                                               0965 02344000
         LA    @06,1                                               0965 02345000
         AL    @06,RDEPCT-4(@08)                                   0965 02346000
         ST    @06,RDEPCT-4(@08)                                   0965 02347000
*  PASSFLAG = OFF;                                         /*@Z427VLS*/ 02348000
         NI    PASSFLAG(R2),B'11111110'                            0966 02349000
*  END;                                                    /*@0099VLS*/ 02350000
*ELSE                                                              0968 02351000
*  DO;                                                     /*@Z427VLS*/ 02352000
         B     @RC00963                                            0968 02353000
@RF00963 DS    0H                                                  0969 02354000
*    WORKCUA = MIHCUA;                                     /*@Z427VLS*/ 02355000
         MVC   WORKCUA(3),MIHCUA(R7)                               0969 02356000
*    WORKDEV = MIHCODE2;                                   /*@Z427VLS*/ 02357000
         MVC   WORKDEV(2),MIHCODE2(R7)                             0970 02358000
*    IF CUAPTR ^= ZERO THEN                                        0971 02359000
         L     @08,CUAPTR(,R2)                                     0971 02360000
         LTR   @08,@08                                             0971 02361000
         BZ    @RF00971                                            0971 02362000
*      CALL CUASELCT;                                      /*@Z427VLS*/ 02363000
         BAL   @14,CUASELCT                                        0972 02364000
*    IF PASSFLAG = YES & DEVPTR ^= ZERO THEN                       0973 02365000
@RF00971 TM    PASSFLAG(R2),B'00000001'                            0973 02366000
         BNO   @RF00973                                            0973 02367000
         L     @08,DEVPTR(,R2)                                     0973 02368000
         LTR   @08,@08                                             0973 02369000
         BZ    @RF00973                                            0973 02370000
*      CALL DEVSEL;                                        /*@Z427VLS*/ 02371000
         BAL   @14,DEVSEL                                          0974 02372000
*   END;                                                   /*@Z427VLS*/ 02373000
*END;                                                      /*@Z427VLS*/ 02374000
@EL00021 DS    0H                                                  0976 02375000
@EF00021 DS    0H                                                  0976 02376000
@ER00021 LM    @14,@12,@SA00021                                    0976 02377000
         BR    @14                                                 0976 02378000
*CCHFILT: PROC;                                            /*@Z427VLS*/ 02379000
CCHFILT  STM   @14,@12,@SA00022                                    0977 02380000
*IF PCHAN = OFF THEN                                               0978 02381000
         TM    PCHAN(R2),B'01000000'                               0978 02382000
         BNZ   @RF00978                                            0978 02383000
*  DO;                                                     /*@0099VLS*/ 02384000
*  RDEPCT(RTYP1) = RDEPCT(RTYP1) + ONE;  /*ADD TO THE COUNT OF THIS*/   02385000
         L     @08,RTYP1                                           0980 02386000
         SLA   @08,2                                               0980 02387000
         LA    @06,1                                               0980 02388000
         AL    @06,RDEPCT-4(@08)                                   0980 02389000
         ST    @06,RDEPCT-4(@08)                                   0980 02390000
*  PASSFLAG = OFF;                                         /*@Z427VLS*/ 02391000
         NI    PASSFLAG(R2),B'11111110'                            0981 02392000
*  END;                                                    /*@0099VLS*/ 02393000
*ELSE                                                              0983 02394000
*  DO;                                                     /*@Z427VLS*/ 02395000
         B     @RC00978                                            0983 02396000
@RF00978 DS    0H                                                  0984 02397000
*    WORKMOD = (CCHCUA & ONLYCUA2);                        /*@Z427VLS*/ 02398000
         MVC   WORKMOD(2),CCHCUA(R7)                               0984 02399000
         NC    WORKMOD(2),@CB01041                                 0984 02400000
*    IF CUAPTR ^= ZERO THEN                                        0985 02401000
         L     @08,CUAPTR(,R2)                                     0985 02402000
         LTR   @08,@08                                             0985 02403000
         BZ    @RF00985                                            0985 02404000
*      CALL CUASELCT;                                      /*@Z427VLS*/ 02405000
         BAL   @14,CUASELCT                                        0986 02406000
*    IF PASSFLAG = YES THEN      /*MAKE SURE KEEPING THIS RECORD*/ 0987 02407000
@RF00985 TM    PASSFLAG(R2),B'00000001'                            0987 02408000
         BNO   @RF00987                                            0987 02409000
*      CALL MERIDCK;             /*IS THIS A MERDIAN CPU     @G51DGGB*/ 02410000
         BAL   @14,MERIDCK                                         0988 02411000
*   END;                                                   /*@Z427VLS*/ 02412000
*END;                                                      /*@Z427VLS*/ 02413000
@EL00022 DS    0H                                                  0990 02414000
@EF00022 DS    0H                                                  0990 02415000
@ER00022 LM    @14,@12,@SA00022                                    0990 02416000
         BR    @14                                                 0990 02417000
*/*                                                          @Z427VLS*/ 02418000
*IPLFILT: PROC;                                            /*@Z427VLS*/ 02419000
IPLFILT  STM   @14,@12,12(@13)                                     0991 02420000
*IF PIPL = OFF THEN                                                0992 02421000
         TM    PIPL(R2),B'00001000'                                0992 02422000
         BNZ   @RF00992                                            0992 02423000
*  DO;                                                     /*@0099VLS*/ 02424000
*  RDEPCT(RTYP1) = RDEPCT(RTYP1) + ONE;  /*ADD TO THE COUNT OF THIS*/   02425000
         L     @08,RTYP1                                           0994 02426000
         SLA   @08,2                                               0994 02427000
         LA    @06,1                                               0994 02428000
         AL    @06,RDEPCT-4(@08)                                   0994 02429000
         ST    @06,RDEPCT-4(@08)                                   0994 02430000
*  PASSFLAG = OFF;                                         /*@Z427VLS*/ 02431000
         NI    PASSFLAG(R2),B'11111110'                            0995 02432000
*  END;                                                    /*@0099VLS*/ 02433000
*END;                                                      /*@Z427VLS*/ 02434000
@EL00023 DS    0H                                                  0997 02435000
@EF00023 DS    0H                                                  0997 02436000
@ER00023 LM    @14,@12,12(@13)                                     0997 02437000
         BR    @14                                                 0997 02438000
*/*                                                          @Z427VLS*/ 02439000
*/*                                                          @Z427VLS*/ 02440000
*EODFILT: PROC;                                            /*@Z427VLS*/ 02441000
EODFILT  STM   @14,@12,12(@13)                                     0998 02442000
*IF PEOD = OFF THEN                                                0999 02443000
         TM    PEOD(R2),B'00000001'                                0999 02444000
         BNZ   @RF00999                                            0999 02445000
*  DO;                                                     /*@0099VLS*/ 02446000
*  RDEPCT(RTYP1) = RDEPCT(RTYP1) + ONE;  /*ADD TO THE COUNT OF THIS*/   02447000
         L     @08,RTYP1                                           1001 02448000
         SLA   @08,2                                               1001 02449000
         LA    @06,1                                               1001 02450000
         AL    @06,RDEPCT-4(@08)                                   1001 02451000
         ST    @06,RDEPCT-4(@08)                                   1001 02452000
*  PASSFLAG = OFF;                                         /*@Z427VLS*/ 02453000
         NI    PASSFLAG(R2),B'11111110'                            1002 02454000
*  END;                                                    /*@0099VLS*/ 02455000
*END;                                                      /*@Z427VLS*/ 02456000
@EL00024 DS    0H                                                  1004 02457000
@EF00024 DS    0H                                                  1004 02458000
@ER00024 LM    @14,@12,12(@13)                                     1004 02459000
         BR    @14                                                 1004 02460000
*MCHFILT: PROC;                                            /*@Z427VLS*/ 02461000
MCHFILT  STM   @14,@12,@SA00025                                    1005 02462000
*IF PMCH = OFF THEN                                                1006 02463000
         TM    PMCH(R2),B'10000000'                                1006 02464000
         BNZ   @RF01006                                            1006 02465000
*  DO;                                                     /*@0099VLS*/ 02466000
*  RDEPCT(RTYP1) = RDEPCT(RTYP1) + ONE;  /*ADD TO THE COUNT OF THIS*/   02467000
         L     @08,RTYP1                                           1008 02468000
         SLA   @08,2                                               1008 02469000
         LA    @06,1                                               1008 02470000
         AL    @06,RDEPCT-4(@08)                                   1008 02471000
         ST    @06,RDEPCT-4(@08)                                   1008 02472000
*  PASSFLAG = OFF;                                         /*@Z427VLS*/ 02473000
         NI    PASSFLAG(R2),B'11111110'                            1009 02474000
*  END;                                                    /*@0099VLS*/ 02475000
* ELSE                                                             1011 02476000
*   CALL MERIDCK;     /*GO SEE IF THIS IS AN MERDIAN CPU     @G51DGGB*/ 02477000
         B     @RC01006                                            1011 02478000
@RF01006 BAL   @14,MERIDCK                                         1011 02479000
*END;                                                      /*@Z427VLS*/ 02480000
@EL00025 DS    0H                                                  1012 02481000
@EF00025 DS    0H                                                  1012 02482000
@ER00025 LM    @14,@12,@SA00025                                    1012 02483000
         BR    @14                                                 1012 02484000
*/*                                                          @Z427VLS*/ 02485000
*/*                                                          @Z427VLS*/ 02486000
*SOFTFILT: PROC;                                           /*@Z427VLS*/ 02487000
SOFTFILT STM   @14,@12,12(@13)                                     1013 02488000
*IF PSOFT = OFF THEN                                               1014 02489000
         TM    PSOFT(R2),B'00010000'                               1014 02490000
         BNZ   @RF01014                                            1014 02491000
*  DO;                                                     /*@0099VLS*/ 02492000
*  RDEPCT(RTYP1) = RDEPCT(RTYP1) + ONE;  /*ADD TO THE COUNT OF THIS*/   02493000
         L     @08,RTYP1                                           1016 02494000
         SLA   @08,2                                               1016 02495000
         LA    @06,1                                               1016 02496000
         AL    @06,RDEPCT-4(@08)                                   1016 02497000
         ST    @06,RDEPCT-4(@08)                                   1016 02498000
*  PASSFLAG = OFF;                                         /*@Z427VLS*/ 02499000
         NI    PASSFLAG(R2),B'11111110'                            1017 02500000
*  END;                                                    /*@0099VLS*/ 02501000
*END;                                                      /*@Z427VLS*/ 02502000
@EL00026 DS    0H                                                  1019 02503000
@EF00026 DS    0H                                                  1019 02504000
@ER00026 LM    @14,@12,12(@13)                                     1019 02505000
         BR    @14                                                 1019 02506000
*CUASELCT: PROC;                                           /*@Z427VLS*/ 02507000
CUASELCT STM   @14,@12,12(@13)                                     1020 02508000
*CUAOK = NO;                                               /*@Z427VLS*/ 02509000
         NI    CUAOK,B'11011111'                                   1021 02510000
*DO J = 1 BY 1 TO CUANUM WHILE CUAOK = NO;                 /*@Z427VLS*/ 02511000
         LA    @08,1                                               1022 02512000
         ST    @08,J                                               1022 02513000
         B     @DE01022                                            1022 02514000
@DL01022 TM    CUAOK,B'00100000'                                   1022 02515000
         BNZ   @DC01022                                            1022 02516000
*  IF WORKMOD >= CUA1(J) & WORKMOD <= CUA2(J) THEN                 1023 02517000
         SLA   @08,2                                               1023 02518000
         L     @06,CUAPTR(,R2)                                     1023 02519000
         ST    @08,@TF00001                                        1023 02520000
         ALR   @08,@06                                             1023 02521000
         BCTR  @08,0                                               1023 02522000
         BCTR  @08,0                                               1023 02523000
         CLC   WORKMOD(2),CUA1-2(@08)                              1023 02524000
         BL    @RF01023                                            1023 02525000
         AL    @06,@TF00001                                        1023 02526000
         CLC   WORKMOD(2),CUA2-4(@06)                              1023 02527000
         BH    @RF01023                                            1023 02528000
*    CUAOK = YES;                                          /*@Z427VLS*/ 02529000
         OI    CUAOK,B'00100000'                                   1024 02530000
*END;                                                      /*@Z427VLS*/ 02531000
@RF01023 LA    @08,1                                               1025 02532000
         AL    @08,J                                               1025 02533000
         ST    @08,J                                               1025 02534000
@DE01022 L     @06,CUAPTR(,R2)                                     1025 02535000
         CH    @08,CUANUM(,@06)                                    1025 02536000
         BNH   @DL01022                                            1025 02537000
@DC01022 DS    0H                                                  1026 02538000
*IF CUAOK = NO THEN                                                1026 02539000
         TM    CUAOK,B'00100000'                                   1026 02540000
         BNZ   @RF01026                                            1026 02541000
* DO;                                                      /*@Z427VLS*/ 02542000
*  PASSFLAG = NO;                                          /*@Z427VLS*/ 02543000
         NI    PASSFLAG(R2),B'11111110'                            1028 02544000
*  CUACT(RTYP1) = CUACT(RTYP1) + ONE;                      /*@Z427VLS*/ 02545000
         L     @08,RTYP1                                           1029 02546000
         SLA   @08,2                                               1029 02547000
         LA    @06,1                                               1029 02548000
         AL    @06,CUACT-4(@08)                                    1029 02549000
         ST    @06,CUACT-4(@08)                                    1029 02550000
* END;                                                     /*@Z427VLS*/ 02551000
*END;                                                      /*@Z427VLS*/ 02552000
@EL00027 DS    0H                                                  1031 02553000
@EF00027 DS    0H                                                  1031 02554000
@ER00027 LM    @14,@12,12(@13)                                     1031 02555000
         BR    @14                                                 1031 02556000
*/*                                                          @Z427VLS*/ 02557000
*/*                                                          @Z427VLS*/ 02558000
*/********************************************************************/ 02559000
*/*    THIS PROC WILL SET THE FLAG IF THIS CPU IS A MERDIAN TYPE    */  02560000
*MERIDCK: PROC;                                            /*@G51DGGB*/ 02561000
MERIDCK  STM   @14,@12,@SA00028                                    1032 02562000
*DCL A   FIXED(31) INIT(0);                                /*@G51DGGB*/ 02563000
*ISMERD = NO;                     /*SET THE FLAG PRIOR TO START*/  1034 02564000
         NI    ISMERD,B'11111101'                                  1034 02565000
*DO A = 1 BY 1 TO MRDNUMBR WHILE(ISMERD = NO);             /*@G51DGGB*/ 02566000
         LA    @08,1                                               1035 02567000
         ST    @08,A                                               1035 02568000
         B     @DE01035                                            1035 02569000
@DL01035 TM    ISMERD,B'00000010'                                  1035 02570000
         BNZ   @DC01035                                            1035 02571000
* IF LRTMODEL = MODEL(A) THEN /*COMPARE AGAINST THE MERDIAN CPUS*/ 1036 02572000
         ALR   @08,@08                                             1036 02573000
         L     @06,MERDCPTR(,R2)                                   1036 02574000
         ALR   @06,@08                                             1036 02575000
         CLC   LRTMODEL(2,R7),MODEL-2(@06)                         1036 02576000
         BNE   @RF01036                                            1036 02577000
*  DO;                                                     /*@G51DGGB*/ 02578000
*  ISMERD = YES;      /*SET TO EXIT FROM THE LOOP            @G51DGGB*/ 02579000
         OI    ISMERD,B'00000010'                                  1038 02580000
*  CALL BUILDFTB;     /*BUILD ENTRY IN FRAME TABLE IF REQUIRED*/   1039 02581000
         BAL   @14,BUILDFTB                                        1039 02582000
*  END;                                                    /*@G51DGGB*/ 02583000
*END;                                                      /*@G51DGGB*/ 02584000
@RF01036 LA    @08,1                                               1041 02585000
         AL    @08,A                                               1041 02586000
         ST    @08,A                                               1041 02587000
@DE01035 L     @06,MERDCPTR(,R2)                                   1041 02588000
         CH    @08,MRDNUMBR(,@06)                                  1041 02589000
         BNH   @DL01035                                            1041 02590000
@DC01035 DS    0H                                                  1042 02591000
*END;                                                      /*@G51DGGB*/ 02592000
@EL00028 DS    0H                                                  1042 02593000
@EF00028 DS    0H                                                  1042 02594000
@ER00028 LM    @14,@12,@SA00028                                    1042 02595000
         BR    @14                                                 1042 02596000
*/********************************************************************/ 02597000
*/*    THIS PROC WILL WRITE ALL SAVED MCF & CCF TYPE RECORDS TO THE  */ 02598000
*/*    ACCDEV DATA SET                                       @G51DGGB*/ 02599000
*WRITEFRM: PROC;                                           /*@G51DGGB*/ 02600000
WRITEFRM STM   @14,@12,@SA00029                                    1043 02601000
*RESPECIFY (R15) RESTRICTED;                               /*@G51DGGB*/ 02602000
*DCL YY1 FIXED(31) INIT(0);                                /*@G51DGGB*/ 02603000
*         DO YY1 = 1 BY 1 TO FRAMENUM WHILE R15 < FOUR;     /*SETS. */  02604000
         LA    @14,1                                               1046 02605000
         ST    @14,YY1                                             1046 02606000
         B     @DE01046                                            1046 02607000
@DL01046 C     R15,@CF00064                                        1046 02608000
         BNL   @DC01046                                            1046 02609000
*           IF FRAMETYP(YY1) = ALLALL THEN /*IF COMPLETE SET @G51DGGB*/ 02610000
         MH    @14,@CH00227                                        1047 02611000
         L     @08,FRAMEPTR(,R2)                                   1047 02612000
         ST    @14,@TF00001                                        1047 02613000
         ALR   @14,@08                                             1047 02614000
         AL    @14,@CF01624                                        1047 02615000
         CLI   FRAMETYP-17(@14),X'FF'                              1047 02616000
         BNE   @RF01047                                            1047 02617000
*             DO;                                          /*@G51DGGB*/ 02618000
*               LISTPTR = FRAMLOCM(YY1);   /*ESTABLISH LISTLOC ADDR.*/  02619000
         L     @14,@TF00001                                        1049 02620000
         AL    @08,@CF01620                                        1049 02621000
         L     @14,FRAMLOCM-20(@14,@08)                            1049 02622000
         ST    @14,LISTPTR                                         1049 02623000
*               DO Z = 1 BY 1 TO LISTNUM WHILE R15 < FOUR ;/*@G51DGGB*/ 02624000
         LA    @14,1                                               1050 02625000
         ST    @14,Z                                               1050 02626000
         B     @DE01050                                            1050 02627000
@DL01050 C     R15,@CF00064                                        1050 02628000
         BNL   @DC01050                                            1050 02629000
*                 RECCCHHR = LISTCCHR(Z);  /*GET ALL MCH FRAMES*/  1051 02630000
         MH    @14,@CH00079                                        1051 02631000
         L     @08,LISTPTR                                         1051 02632000
         ALR   @08,@14                                             1051 02633000
         BCTR  @08,0                                               1051 02634000
         MVC   RECCCHHR(5,R2),LISTCCHR-4(@08)                      1051 02635000
*                 CALL IOHND(READIRCT);    /*READ FRAME FROM DIRECTWK*/ 02636000
         L     @15,ADIOHND(,R2)                                    1052 02637000
         LA    @01,@AL01052                                        1052 02638000
         BALR  @14,@15                                             1052 02639000
*                 IF R15 = ZERO THEN       /*WRITE FRAME TO ACCDEV*/    02640000
         LTR   R15,R15                                             1053 02641000
         BNZ   @RF01053                                            1053 02642000
*                  DO;                                     /*@G51DGGB*/ 02643000
*                   IF DEBUG46 ^= ON THEN  /*NORMAL WRITE TO HIST*/     02644000
         TM    DEBUG46(R2),B'00000010'                             1055 02645000
         BO    @RF01055                                            1055 02646000
*                    DO;                                   /*@G51DGGB*/ 02647000
*                    CALL IOHND(RITEHIST); /*ADD TO HISTORY FILE*/ 1057 02648000
         L     @15,ADIOHND(,R2)                                    1057 02649000
         LA    @01,@AL01057                                        1057 02650000
         BALR  @14,@15                                             1057 02651000
*                     TOACCDEV(1) = TOACCDEV(1) + 1;       /*@G51DGGB*/ 02652000
         LA    @14,1                                               1058 02653000
         AH    @14,TOACCDEV                                        1058 02654000
         STH   @14,TOACCDEV                                        1058 02655000
*                    END;                                  /*@G51DGGB*/ 02656000
*                   ELSE                                           1060 02657000
*                   CALL ADDTABLE;  /*PASS ON TO EVENT THE FRAME REC*/  02658000
         B     @RC01055                                            1060 02659000
@RF01055 BAL   @14,ADDTABLE                                        1060 02660000
*                  END;                                    /*@G51DGGB*/ 02661000
*                 ELSE                     /*IDENTIFY MISSING FRAME*/   02662000
*                   ERROR = 12;                            /*@G51DGGB*/ 02663000
         B     @RC01053                                            1062 02664000
@RF01053 MVC   ERROR(4),@CF00032                                   1062 02665000
*              END;                                        /*@G51DGGB*/ 02666000
@RC01053 LA    @14,1                                               1063 02667000
         AL    @14,Z                                               1063 02668000
         ST    @14,Z                                               1063 02669000
@DE01050 L     @08,LISTPTR                                         1063 02670000
         C     @14,LISTNUM(,@08)                                   1063 02671000
         BNH   @DL01050                                            1063 02672000
@DC01050 DS    0H                                                  1064 02673000
*              IF ERROR = ZERO THEN /*IF NO ACCDEV WRITE ERROR*/   1064 02674000
         L     @14,ERROR                                           1064 02675000
         LTR   @14,@14                                             1064 02676000
         BNZ   @RF01064                                            1064 02677000
*                DO;                                       /*@G51DGGB*/ 02678000
*                  LISTPTR = FRAMLOCC(YY1); /*GET CCH FRAMES @G51DGGB*/ 02679000
         L     @14,YY1                                             1066 02680000
         MH    @14,@CH00227                                        1066 02681000
         L     @08,FRAMEPTR(,R2)                                   1066 02682000
         L     @14,FRAMLOCC-24(@14,@08)                            1066 02683000
         ST    @14,LISTPTR                                         1066 02684000
*                  DO Z = 1 BY 1 TO LISTNUM WHILE R15 < FOUR;      1067 02685000
         LA    @14,1                                               1067 02686000
         ST    @14,Z                                               1067 02687000
         B     @DE01067                                            1067 02688000
@DL01067 C     R15,@CF00064                                        1067 02689000
         BNL   @DC01067                                            1067 02690000
*                    RECCCHHR = LISTCCHR(Z);               /*@G51DGGB*/ 02691000
         MH    @14,@CH00079                                        1068 02692000
         L     @08,LISTPTR                                         1068 02693000
         ALR   @08,@14                                             1068 02694000
         BCTR  @08,0                                               1068 02695000
         MVC   RECCCHHR(5,R2),LISTCCHR-4(@08)                      1068 02696000
*                      CALL IOHND(READIRCT); /*READ FRAME OFF DRCTWK*/  02697000
         L     @15,ADIOHND(,R2)                                    1069 02698000
         LA    @01,@AL01069                                        1069 02699000
         BALR  @14,@15                                             1069 02700000
*                      IF R15 = ZERO THEN    /*IF SUCCESS THEN WRITE*/  02701000
         LTR   R15,R15                                             1070 02702000
         BNZ   @RF01070                                            1070 02703000
*                       DO;                                /*@G51DGGB*/ 02704000
*                        IF DEBUG46 ^= ON THEN                     1072 02705000
         TM    DEBUG46(R2),B'00000010'                             1072 02706000
         BO    @RF01072                                            1072 02707000
*                         DO;                              /*@G51DGGB*/ 02708000
*                          CALL IOHND(RITEHIST); /*WRITE TO ACCDEV*/    02709000
         L     @15,ADIOHND(,R2)                                    1074 02710000
         LA    @01,@AL01074                                        1074 02711000
         BALR  @14,@15                                             1074 02712000
*                           TOACCDEV(2) = TOACCDEV(2) + 1; /*@G51DGGB*/ 02713000
         LA    @14,1                                               1075 02714000
         AH    @14,TOACCDEV+2                                      1075 02715000
         STH   @14,TOACCDEV+2                                      1075 02716000
*                         END;                             /*@G51DGGB*/ 02717000
*                          ELSE /*USER WANTS EVENT TO RECEIVE RECORD*/  02718000
*                        CALL ADDTABLE;  /*ADD REC TO THE SORT TABLE*/  02719000
         B     @RC01072                                            1077 02720000
@RF01072 BAL   @14,ADDTABLE                                        1077 02721000
*                        END;                              /*@G51DGGB*/ 02722000
@RC01072 DS    0H                                                  1079 02723000
*                    END;                                  /*@G51DGGB*/ 02724000
@RF01070 LA    @14,1                                               1079 02725000
         AL    @14,Z                                               1079 02726000
         ST    @14,Z                                               1079 02727000
@DE01067 L     @08,LISTPTR                                         1079 02728000
         C     @14,LISTNUM(,@08)                                   1079 02729000
         BNH   @DL01067                                            1079 02730000
@DC01067 DS    0H                                                  1080 02731000
*                 END;                                     /*@G51DGGB*/ 02732000
*             END;                                         /*@G51DGGB*/ 02733000
*           ELSE  /*INCOMPLETE FRAME SET                     @G51DGGB*/ 02734000
*             DO;                                          /*@G51DGGB*/ 02735000
         B     @RC01047                                            1082 02736000
@RF01047 DS    0H                                                  1083 02737000
*               MSGNO = QQ1;/*MISSING FRAME SET MESSAGE      @G51DGGB*/ 02738000
         MVC   MSGNO(4),@CF00083                                   1083 02739000
*               CCHINDX = YY1; /*CORRECT DEBUG FRAME COUNTS BY */  1084 02740000
         L     @14,YY1                                             1084 02741000
         ST    @14,CCHINDX                                         1084 02742000
*               CALL ERRMSG;  /*GO AND BUILD ERROR MESSAGE   @G51DGGB*/ 02743000
         BAL   @14,ERRMSG                                          1085 02744000
*               CALL FIXENTRY; /*PASSING ENTRY INDEX TO FIXENTRY*/ 1086 02745000
         BAL   @14,FIXENTRY                                        1086 02746000
*             END;                                         /*@G51DGGB*/ 02747000
*         END;                                             /*@G51DGGB*/ 02748000
@RC01047 LA    @14,1                                               1088 02749000
         AL    @14,YY1                                             1088 02750000
         ST    @14,YY1                                             1088 02751000
@DE01046 L     @08,FRAMEPTR(,R2)                                   1088 02752000
         C     @14,FRAMENUM(,@08)                                  1088 02753000
         BNH   @DL01046                                            1088 02754000
@DC01046 DS    0H                                                  1089 02755000
*RESPECIFY (R15) UNRESTRICTED;                             /*@G51DGGB*/ 02756000
* END;                                                     /*@G51DGGB*/ 02757000
@EL00029 DS    0H                                                  1090 02758000
@EF00029 DS    0H                                                  1090 02759000
@ER00029 LM    @14,@12,@SA00029                                    1090 02760000
         BR    @14                                                 1090 02761000
*DEVSEL: PROC;                                             /*@Z427VLS*/ 02762000
DEVSEL   STM   @14,@12,12(@13)                                     1091 02763000
*IF RTYP1 = NINE THEN                                              1092 02764000
         CLC   RTYP1(4),@CF00035                                   1092 02765000
         BNE   @RF01092                                            1092 02766000
*  DO;                                                     /*@Z427VLS*/ 02767000
*    IF DEVEXCL = ON THEN                                          1094 02768000
         TM    DEVEXCL(R2),B'00100000'                             1094 02769000
         BNO   @RF01094                                            1094 02770000
*      DO;                                                 /*@Z427VLS*/ 02771000
*        DEVOK = YES;                                      /*@Z427VLS*/ 02772000
         OI    DEVOK,B'00100000'                                   1096 02773000
*        DO J = 1 BY 1 TO MDRNUM WHILE DEVOK = YES;        /*@Z427VLS*/ 02774000
         LA    @08,1                                               1097 02775000
         ST    @08,J                                               1097 02776000
         B     @DE01097                                            1097 02777000
@DL01097 TM    DEVOK,B'00100000'                                   1097 02778000
         BNO   @DC01097                                            1097 02779000
*        IF TPRDEV = MDRVAL(J) THEN                                1098 02780000
         L     @06,DEVPTR(,R2)                                     1098 02781000
         ALR   @06,@08                                             1098 02782000
         CLC   TPRDEV(1,R7),MDRVAL-1(@06)                          1098 02783000
         BNE   @RF01098                                            1098 02784000
*          DO;                                             /*@Z427VLS*/ 02785000
*            DEVOK = NO;                                   /*@Z427VLS*/ 02786000
         NI    DEVOK,B'11011111'                                   1100 02787000
*            PASSFLAG = NO;                                /*@Z427VLS*/ 02788000
         NI    PASSFLAG(R2),B'11111110'                            1101 02789000
*          END;                                            /*@Z427VLS*/ 02790000
*        END;                                              /*@Z427VLS*/ 02791000
@RF01098 LA    @08,1                                               1103 02792000
         AL    @08,J                                               1103 02793000
         ST    @08,J                                               1103 02794000
@DE01097 L     @06,DEVPTR(,R2)                                     1103 02795000
         CH    @08,MDRNUM(,@06)                                    1103 02796000
         BNH   @DL01097                                            1103 02797000
@DC01097 DS    0H                                                  1104 02798000
*      END;                                                /*@Z427VLS*/ 02799000
*    ELSE                                                          1105 02800000
*      DO;                                                 /*@Z427VLS*/ 02801000
         B     @RC01094                                            1105 02802000
@RF01094 DS    0H                                                  1106 02803000
*        DEVOK = NO;                                       /*@Z427VLS*/ 02804000
         NI    DEVOK,B'11011111'                                   1106 02805000
*        DO J = 1 BY 1 TO MDRNUM WHILE DEVOK = NO;         /*@Z427VLS*/ 02806000
         LA    @08,1                                               1107 02807000
         ST    @08,J                                               1107 02808000
         B     @DE01107                                            1107 02809000
@DL01107 TM    DEVOK,B'00100000'                                   1107 02810000
         BNZ   @DC01107                                            1107 02811000
*        IF TPRDEV = MDRVAL(J) THEN                                1108 02812000
         L     @06,DEVPTR(,R2)                                     1108 02813000
         ALR   @06,@08                                             1108 02814000
         CLC   TPRDEV(1,R7),MDRVAL-1(@06)                          1108 02815000
         BNE   @RF01108                                            1108 02816000
*          DEVOK = YES;                                    /*@Z427VLS*/ 02817000
         OI    DEVOK,B'00100000'                                   1109 02818000
*        END;                                              /*@Z427VLS*/ 02819000
@RF01108 LA    @08,1                                               1110 02820000
         AL    @08,J                                               1110 02821000
         ST    @08,J                                               1110 02822000
@DE01107 L     @06,DEVPTR(,R2)                                     1110 02823000
         CH    @08,MDRNUM(,@06)                                    1110 02824000
         BNH   @DL01107                                            1110 02825000
@DC01107 DS    0H                                                  1111 02826000
*        IF DEVOK = NO THEN                                        1111 02827000
         TM    DEVOK,B'00100000'                                   1111 02828000
         BNZ   @RF01111                                            1111 02829000
*          PASSFLAG = NO;                                  /*@Z427VLS*/ 02830000
         NI    PASSFLAG(R2),B'11111110'                            1112 02831000
*       END;                                               /*@Z427VLS*/ 02832000
*    END;                                                  /*@Z427VLS*/ 02833000
*  ELSE                    /*OBR,MIH DDR TYPES OF RECORDS    @Z427VLS*/ 02834000
*    IF DEVEXCL = ON THEN                                          1115 02835000
         B     @RC01092                                            1115 02836000
@RF01092 TM    DEVEXCL(R2),B'00100000'                             1115 02837000
         BNO   @RF01115                                            1115 02838000
*      DO;                                                 /*@Z427VLS*/ 02839000
*        DEVOK = YES;                                      /*@Z427VLS*/ 02840000
         OI    DEVOK,B'00100000'                                   1117 02841000
*        DO J = 1 BY 1 TO DEVNUM WHILE DEVOK = YES;        /*@Z427VLS*/ 02842000
         LA    @08,1                                               1118 02843000
         ST    @08,J                                               1118 02844000
         B     @DE01118                                            1118 02845000
@DL01118 TM    DEVOK,B'00100000'                                   1118 02846000
         BNO   @DC01118                                            1118 02847000
*          IF WORKDEV = DEVVAL(J) THEN                             1119 02848000
         ALR   @08,@08                                             1119 02849000
         L     @06,DEVPTR(,R2)                                     1119 02850000
         ALR   @06,@08                                             1119 02851000
         CLC   WORKDEV(2),DEVVAL-2(@06)                            1119 02852000
         BNE   @RF01119                                            1119 02853000
*            DO;                                           /*@Z427VLS*/ 02854000
*              DEVOK = NO;                                 /*@Z427VLS*/ 02855000
         NI    DEVOK,B'11011111'                                   1121 02856000
*              PASSFLAG = NO;                              /*@Z427VLS*/ 02857000
         NI    PASSFLAG(R2),B'11111110'                            1122 02858000
*            END;                                          /*@Z427VLS*/ 02859000
*        END;                                              /*@Z427VLS*/ 02860000
@RF01119 LA    @08,1                                               1124 02861000
         AL    @08,J                                               1124 02862000
         ST    @08,J                                               1124 02863000
@DE01118 L     @06,DEVPTR(,R2)                                     1124 02864000
         CH    @08,DEVNUM(,@06)                                    1124 02865000
         BNH   @DL01118                                            1124 02866000
@DC01118 DS    0H                                                  1125 02867000
*      END;                                                /*@Z427VLS*/ 02868000
*  ELSE                                                            1126 02869000
*   DO;                                                    /*@Z427VLS*/ 02870000
         B     @RC01115                                            1126 02871000
@RF01115 DS    0H                                                  1127 02872000
*     DEVOK = NO;                                          /*@Z427VLS*/ 02873000
         NI    DEVOK,B'11011111'                                   1127 02874000
*     DO J =  1 BY 1 TO DEVNUM WHILE DEVOK = NO;           /*@Z427VLS*/ 02875000
         LA    @08,1                                               1128 02876000
         ST    @08,J                                               1128 02877000
         B     @DE01128                                            1128 02878000
@DL01128 TM    DEVOK,B'00100000'                                   1128 02879000
         BNZ   @DC01128                                            1128 02880000
*       IF WORKDEV = DEVVAL(J) THEN                                1129 02881000
         ALR   @08,@08                                             1129 02882000
         L     @06,DEVPTR(,R2)                                     1129 02883000
         ALR   @06,@08                                             1129 02884000
         CLC   WORKDEV(2),DEVVAL-2(@06)                            1129 02885000
         BNE   @RF01129                                            1129 02886000
*         DEVOK = YES;                                     /*@Z427VLS*/ 02887000
         OI    DEVOK,B'00100000'                                   1130 02888000
*     END;                                                 /*@Z427VLS*/ 02889000
@RF01129 LA    @08,1                                               1131 02890000
         AL    @08,J                                               1131 02891000
         ST    @08,J                                               1131 02892000
@DE01128 L     @06,DEVPTR(,R2)                                     1131 02893000
         CH    @08,DEVNUM(,@06)                                    1131 02894000
         BNH   @DL01128                                            1131 02895000
@DC01128 DS    0H                                                  1132 02896000
*     IF DEVOK = NO THEN                                           1132 02897000
         TM    DEVOK,B'00100000'                                   1132 02898000
         BNZ   @RF01132                                            1132 02899000
*       PASSFLAG = OFF;                                    /*@Z427VLS*/ 02900000
         NI    PASSFLAG(R2),B'11111110'                            1133 02901000
*    END;                                                  /*@Z427VLS*/ 02902000
@RF01132 DS    0H                                                  1135 02903000
* IF PASSFLAG = OFF THEN                                           1135 02904000
@RC01115 DS    0H                                                  1135 02905000
@RC01092 TM    PASSFLAG(R2),B'00000001'                            1135 02906000
         BNZ   @RF01135                                            1135 02907000
*  DEVCT(RTYP1) = DEVCT(RTYP1) + ONE;                      /*@Z427VLS*/ 02908000
         L     @08,RTYP1                                           1136 02909000
         SLA   @08,2                                               1136 02910000
         LA    @06,1                                               1136 02911000
         AL    @06,DEVCT-4(@08)                                    1136 02912000
         ST    @06,DEVCT-4(@08)                                    1136 02913000
*END;                                                      /*@Z427VLS*/ 02914000
@EL00030 DS    0H                                                  1137 02915000
@EF00030 DS    0H                                                  1137 02916000
@ER00030 LM    @14,@12,12(@13)                                     1137 02917000
         BR    @14                                                 1137 02918000
*/********************************************************************/ 02919000
*/*    THIS PROC DETERMINE IF THE FRAMES ARE TO BE PROCESSED AND IF  */ 02920000
*/*     THERE ARE ANY ERROR WITH THE LOGICAL FRAME SET       @G51DGGB*/ 02921000
*CKFRAMES: PROC;                                           /*@G51DGGB*/ 02922000
CKFRAMES STM   @14,@12,@SA00031                                    1138 02923000
* RESPECIFY (R15)  RESTRICTED;                             /*@G51DGGB*/ 02924000
*   IF PMCH = ON | PCHAN = ON  THEN /* MCH OR CCH SELECTION THEN */     02925000
         TM    PMCH(R2),B'11000000'                                1140 02926000
         BZ    @RF01140                                            1140 02927000
*    DO;                            /* DONT SELECT FRAMES    @G51DGGB*/ 02928000
*      IF LRTCNT = ONE & (LRTKEY1 & 'F0'X) = 'A0'X THEN            1142 02929000
         CLI   LRTCNT(R7),1                                        1142 02930000
         BNE   @RF01142                                            1142 02931000
         MVC   @TS00001(1),LRTKEY1(R7)                             1142 02932000
         NI    @TS00001,X'F0'                                      1142 02933000
         CLI   @TS00001,X'A0'                                      1142 02934000
         BNE   @RF01142                                            1142 02935000
*        DO;                                               /*@G51DGGB*/ 02936000
*          SAVESEQ = ONE;           /* RESET SEQUENCE CHECK  @G51DGGB*/ 02937000
         MVC   SAVESEQ(2),@CH00055                                 1144 02938000
*          CALL FRAMEREP;           /*IS THIS SET TO BE SAVED    */     02939000
         BAL   @14,FRAMEREP                                        1145 02940000
*                                   /*IF YES THEN FRAMEREP WILL  */     02941000
*                                   /*SAVE ONLY THE FIRST RECORD */     02942000
*          R15 = ERROR;             /* BE SAVED              @G51DGGB*/ 02943000
         L     R15,ERROR                                           1146 02944000
*          IF LRTNLAST = OFF & R15 = ZERO THEN                     1147 02945000
         TM    LRTNLAST(R7),B'10000000'                            1147 02946000
         BNZ   @RF01147                                            1147 02947000
         SLR   @14,@14                                             1147 02948000
         CR    R15,@14                                             1147 02949000
         BNE   @RF01147                                            1147 02950000
*           DO;                                            /*@G51DGGB*/ 02951000
*            FRAMETYP(CCHINDX) = ALLMCH;                   /*@G51DGGB*/ 02952000
         L     @08,CCHINDX                                         1149 02953000
         MH    @08,@CH00227                                        1149 02954000
         L     @06,FRAMEPTR(,R2)                                   1149 02955000
         ALR   @06,@08                                             1149 02956000
         AL    @06,@CF01624                                        1149 02957000
         MVI   FRAMETYP-17(@06),X'02'                              1149 02958000
*            SAVESEQ = 0;                                  /*@G51DGGB*/ 02959000
         STH   @14,SAVESEQ                                         1150 02960000
*           END;                                           /*@G51DGGB*/ 02961000
*        END;                                              /*@G51DGGB*/ 02962000
*      ELSE                         /* NON-FIRST FRAME       @G51DGGB*/ 02963000
*        DO;                                               /*@G51DGGB*/ 02964000
         B     @RC01142                                            1153 02965000
@RF01142 DS    0H                                                  1154 02966000
*          IF FRAMEYES = ON THEN    /* IF FRAME IS TO BE SAVED  */ 1154 02967000
         TM    FRAMEYES,B'00000001'                                1154 02968000
         BNO   @RF01154                                            1154 02969000
*            DO;                                           /*@G51DGGB*/ 02970000
*              SAVESEQ = SAVESEQ + 1;  /* UP SEQ CHECK       @G51DGGB*/ 02971000
         LA    @14,1                                               1156 02972000
         AH    @14,SAVESEQ                                         1156 02973000
         STH   @14,SAVESEQ                                         1156 02974000
*              IF SAVESEQ = LRTCNT THEN /* IF RECORD NOT MISSING */     02975000
         SLR   @08,@08                                             1157 02976000
         IC    @08,LRTCNT(,R7)                                     1157 02977000
         CR    @14,@08                                             1157 02978000
         BNE   @RF01157                                            1157 02979000
*                DO;                                       /*@G51DGGB*/ 02980000
*                  CALL BUILDTTR;    /* SAVE EXTERNAL LOCATION */  1159 02981000
         BAL   @14,BUILDTTR                                        1159 02982000
*                  R15 = ERROR;     /*LOAD ERROR IF THERE WAS ONE*/     02983000
         L     R15,ERROR                                           1160 02984000
*                  IF R15 = ZERO THEN  /* IF FRAME EXTERNAL LOC  */     02985000
         SLR   @14,@14                                             1161 02986000
         CR    R15,@14                                             1161 02987000
         BNE   @RF01161                                            1161 02988000
*                    DO;               /* SUCCESSFULLY SAVED @G51DGGB*/ 02989000
*                      IF LRTNLAST = OFF THEN /* IF LAST FRAME  */ 1163 02990000
         TM    LRTNLAST(R7),B'10000000'                            1163 02991000
         BNZ   @RF01163                                            1163 02992000
*                        DO;                               /*@G51DGGB*/ 02993000
*                          LASTCT = LASTCT + 1;            /*@G51DGGB*/ 02994000
         LA    @08,1                                               1165 02995000
         AL    @08,LASTCT                                          1165 02996000
         ST    @08,LASTCT                                          1165 02997000
*                          IF(LRTKEY1 & GENREC)= HEXA0 THEN        1166 02998000
         MVC   @TS00001(1),LRTKEY1(R7)                             1166 02999000
         NI    @TS00001,X'F0'                                      1166 03000000
         CLI   @TS00001,X'A0'                                      1166 03001000
         BNE   @RF01166                                            1166 03002000
*                            DO;                           /*@G51DGGB*/ 03003000
*                            FRAMETYP(CCHINDX) = ALLMCH;   /*@G51DGGB*/ 03004000
         L     @08,CCHINDX                                         1168 03005000
         MH    @08,@CH00227                                        1168 03006000
         L     @06,FRAMEPTR(,R2)                                   1168 03007000
         ALR   @06,@08                                             1168 03008000
         AL    @06,@CF01624                                        1168 03009000
         MVI   FRAMETYP-17(@06),X'02'                              1168 03010000
*                            SAVESEQ = 0;                  /*@G51DGGB*/ 03011000
         STH   @14,SAVESEQ                                         1169 03012000
*                            END;                          /*@G51DGGB*/ 03013000
*                          /*IF ALL MCH FRAMES HAVE BEEN SAVED,  */     03014000
*                          /*THEN INDICATE SUCH              @G51DGGB*/ 03015000
*                           ELSE                  /*IS CCH FRAME */     03016000
*                            DO;                           /*@G51DGGB*/ 03017000
         B     @RC01166                                            1171 03018000
@RF01166 DS    0H                                                  1172 03019000
*                            FRAMEYES = OFF;               /*@G51DGGB*/ 03020000
         NI    FRAMEYES,B'11111110'                                1172 03021000
*                            IF FRAMETYP(CCHINDX) ^= ALLMCH THEN   1173 03022000
         L     @14,CCHINDX                                         1173 03023000
         MH    @14,@CH00227                                        1173 03024000
         L     @08,FRAMEPTR(,R2)                                   1173 03025000
         ALR   @08,@14                                             1173 03026000
         AL    @08,@CF01624                                        1173 03027000
         CLI   FRAMETYP-17(@08),X'02'                              1173 03028000
         BE    @RF01173                                            1173 03029000
*                              DO; /*IF MISSING LAST MCH FRAME   */     03030000
*                                MSGNO = QQ; /*SET FLAG FOR CORRECT M*/ 03031000
         MVC   MSGNO(4),@CF00032                                   1175 03032000
*                                CALL ERRMSG;  /*PRINT OUT MESSAGE*/    03033000
         BAL   @14,ERRMSG                                          1176 03034000
*                                SETREJCT(FRINDEX) =               1177 03035000
*                                SETREJCT(FRINDEX) + 1;    /*@G51DGGB*/ 03036000
         L     @14,FRINDEX                                         1177 03037000
         ALR   @14,@14                                             1177 03038000
         LA    @08,1                                               1177 03039000
         AH    @08,SETREJCT-2(@14)                                 1177 03040000
         STH   @08,SETREJCT-2(@14)                                 1177 03041000
*                                CALL FIXENTRY; /*DELETE INCOM-  */     03042000
         BAL   @14,FIXENTRY                                        1178 03043000
*                              END;             /*PLETE SET. @G51DGGB*/ 03044000
*                            ELSE   /*IS COMPLETE SET -INDICATE  */     03045000
*                              FRAMETYP(CCHINDX) = ALLALL; /*IT IS*/    03046000
         B     @RC01173                                            1180 03047000
@RF01173 L     @14,CCHINDX                                         1180 03048000
         MH    @14,@CH00227                                        1180 03049000
         L     @08,FRAMEPTR(,R2)                                   1180 03050000
         ALR   @08,@14                                             1180 03051000
         AL    @08,@CF01624                                        1180 03052000
         MVI   FRAMETYP-17(@08),X'FF'                              1180 03053000
*                             END;                         /*@G51DGGB*/ 03054000
*                        END;                              /*@G51DGGB*/ 03055000
*                   END;                                   /*@G51DGGB*/ 03056000
*              END;                                        /*@G51DGGB*/ 03057000
*            ELSE   /*MISSING MIDDLE FRAME                   @G51DGGB*/ 03058000
*              DO;                                         /*@G51DGGB*/ 03059000
         B     @RC01157                                            1185 03060000
@RF01157 DS    0H                                                  1186 03061000
*                MSGNO = QQ;  /*TELL ERROR WHICH MESSAGE     @G51DGGB*/ 03062000
         MVC   MSGNO(4),@CF00032                                   1186 03063000
*                CALL ERRMSG; /*GO AND PRINT THE MISSING FRAME MSG*/    03064000
         BAL   @14,ERRMSG                                          1187 03065000
*                SETREJCT(FRINDEX) = SETREJCT(FRINDEX) + 1;/*@G51DGGB*/ 03066000
         L     @14,FRINDEX                                         1188 03067000
         ALR   @14,@14                                             1188 03068000
         LA    @08,1                                               1188 03069000
         AH    @08,SETREJCT-2(@14)                                 1188 03070000
         STH   @08,SETREJCT-2(@14)                                 1188 03071000
*                FRAMEYES = OFF; /*DONT SAVE INCOMPLETE SET  @G51DGGB*/ 03072000
         NI    FRAMEYES,B'11111110'                                1189 03073000
*                CALL FIXENTRY; /*DELETE REFS TO INCOMPLETE SET*/  1190 03074000
         BAL   @14,FIXENTRY                                        1190 03075000
*              END;                                        /*@G51DGGB*/ 03076000
*            END;                                          /*@G51DGGB*/ 03077000
*          ELSE      /*FRAME NOT TO BE SAVED                 @G51DGGB*/ 03078000
*            SETREJCT(FRINDEX) = SETREJCT(FRINDEX) + 1;    /*@G51DGGB*/ 03079000
         B     @RC01154                                            1193 03080000
@RF01154 L     @14,FRINDEX                                         1193 03081000
         ALR   @14,@14                                             1193 03082000
         LA    @08,1                                               1193 03083000
         AH    @08,SETREJCT-2(@14)                                 1193 03084000
         STH   @08,SETREJCT-2(@14)                                 1193 03085000
*      END;                                                /*@G51DGGB*/ 03086000
*   END;                                                   /*@G51DGGB*/ 03087000
*  ELSE   /*NOT ACCUMULATING OR SELECTING MCH OR CCH RECORDS @G51DGGB*/ 03088000
*    SETREJCT(FRINDEX) = SETREJCT(FRINDEX) + 1; /*COUNT FRAMES DROPPED* 03089000
         B     @RC01140                                            1196 03090000
@RF01140 L     @14,FRINDEX                                         1196 03091000
         ALR   @14,@14                                             1196 03092000
         LA    @08,1                                               1196 03093000
         AH    @08,SETREJCT-2(@14)                                 1196 03094000
         STH   @08,SETREJCT-2(@14)                                 1196 03095000
*PASSFLAG = NO;         /*STOP IT FRAOM GETTING IN TO NORMAL PROCESS*/  03096000
@RC01140 NI    PASSFLAG(R2),B'11111110'                            1197 03097000
*END; /*END OF CKFRAMES                                      @G51DGGB*/ 03098000
@EL00031 DS    0H                                                  1198 03099000
@EF00031 DS    0H                                                  1198 03100000
@ER00031 LM    @14,@12,@SA00031                                    1198 03101000
         BR    @14                                                 1198 03102000
*/********************************************************************/ 03103000
*/*    THIS PROC WILL SERVICE CERTAIN DEBUG REQUEST          @G51DGGB*/ 03104000
*/*     DEBUG4 - PRINT THE NAME AND THE COMPILE DATE OF THIS ROUTINE */ 03105000
*DBUGSET: PROC;                                            /*@G51DGGB*/ 03106000
DBUGSET  STM   @14,@12,@SA00032                                    1199 03107000
*DCL  BUG4 CHAR(9) INIT('DEBUG4 - ');                      /*@G51DGGB*/ 03108000
* IF DEBUG4 = ON THEN        /*DID USER REQUEST COMPILE DATE PRINTED*/  03109000
         TM    DEBUG4(R2),B'00001000'                              1201 03110000
         BNO   @RF01201                                            1201 03111000
*  DO;                                                     /*@G51DGGB*/ 03112000
*   RESPECIFY (R15) RESTRICTED;                            /*@G51DGGB*/ 03113000
*   R15 = R12 - 27;    /*SET REG TO WHERE ID & COMPILE DATE ARE AT*/    03114000
         LR    R15,R12                                             1204 03115000
         SL    R15,@CF01331                                        1204 03116000
*   PRINTBDY = BUG4;   /*MOVE THE DEBUG4 LABEL INTO THE PRINT LINE*/    03117000
         MVI   PRINTBDY+9,C' '                                     1205 03118000
         MVC   PRINTBDY+10(122),PRINTBDY+9                         1205 03119000
         MVC   PRINTBDY(9),BUG4                                    1205 03120000
*   GEN(MVC   PRINTBDY+10(16),0(R15));/*MOVE THIS TO THE PRINT LINE*/   03121000
         MVC   PRINTBDY+10(16),0(R15)                                   03122000
*   CALL PRINTIT;         /*GO PRINT THE MESSAGE             @G51DGGB*/ 03123000
         BAL   @14,PRINTIT                                         1207 03124000
*   R15 = ZERO;         /*SET THE REG BACK TO ZERO           @G51DGGB*/ 03125000
         SLR   R15,R15                                             1208 03126000
*   RESPECIFY (R15) UNRESTRICTED;                          /*@G51DGGB*/ 03127000
*  END;                                                    /*@G51DGGB*/ 03128000
*END;                                                      /*@G51DGGB*/ 03129000
@EL00032 DS    0H                                                  1211 03130000
@EF00032 DS    0H                                                  1211 03131000
@ER00032 LM    @14,@12,@SA00032                                    1211 03132000
         BR    @14                                                 1211 03133000
*/********************************************************************/ 03134000
*/*                                                          @G51DGGB*/ 03135000
*/*THIS PROC WILL EXAMINE THE MERIDIAN MCH OR CCH IN ORDER TO BUILD*/   03136000
*/*FRAMTAB ENTRIES FOR UNIQUE RECORDS                        @G51DGGB*/ 03137000
*BUILDFTB: PROC; /*BUILD NEW ENTRY IF CPU IS UNIQUE          @G51DGGB*/ 03138000
BUILDFTB STM   @14,@12,@SA00033                                    1212 03139000
*LOOPOUT = NO;                                             /*@G51DGGB*/ 03140000
         NI    LOOPOUT,B'11101111'                                 1213 03141000
*DO Y = 1 BY 1 TO EVMAXENT WHILE LOOPOUT = NO; /*EXAMINE ALL FRAMETAB*/ 03142000
         LA    @08,1                                               1214 03143000
         ST    @08,Y                                               1214 03144000
@DL01214 TM    LOOPOUT,B'00010000'                                 1214 03145000
         BNZ   @DC01214                                            1214 03146000
*  IF FRAMECPU(Y) = LRTCPMOD THEN  /*IF CPU ALREADY IN TABLE THEN*/     03147000
         MH    @08,@CH00227                                        1215 03148000
         L     @06,FRAMEPTR(,R2)                                   1215 03149000
         ALR   @06,@08                                             1215 03150000
         AL    @06,@CF01618                                        1215 03151000
         CLC   FRAMECPU-4(5,@06),LRTCPMOD(R7)                      1215 03152000
         BNE   @RF01215                                            1215 03153000
*    LOOPOUT = YES; /*EXIT LOOP                              @G51DGGB*/ 03154000
         OI    LOOPOUT,B'00010000'                                 1216 03155000
*  ELSE     /*IF ENTRY DOESNT MATCH THE FRAME                @G51DGGB*/ 03156000
*    DO;                                                   /*@G51DGGB*/ 03157000
         B     @RC01215                                            1217 03158000
@RF01215 DS    0H                                                  1218 03159000
*      IF FRAMECPU(Y) = ZERO1 THEN/*NO MATCH,ALL SET ENTRIES EXAMINED*/ 03160000
         L     @08,Y                                               1218 03161000
         MH    @08,@CH00227                                        1218 03162000
         L     @06,FRAMEPTR(,R2)                                   1218 03163000
         ST    @08,@TF00001                                        1218 03164000
         ALR   @08,@06                                             1218 03165000
         AL    @08,@CF01618                                        1218 03166000
         CLC   FRAMECPU-4(5,@08),ZERO1                             1218 03167000
         BNE   @RF01218                                            1218 03168000
*        DO;                                               /*@G51DGGB*/ 03169000
*          FRAMECPU(Y) = LRTCPMOD;  /*SET THE MODLE AND SERIAL # */     03170000
         LR    @08,@06                                             1220 03171000
         AL    @08,@TF00001                                        1220 03172000
         AL    @08,@CF01618                                        1220 03173000
         MVC   FRAMECPU-4(5,@08),LRTCPMOD(R7)                      1220 03174000
*          LOOPOUT = YES;              /*SET TO EXIT FROM THE LOOP*/    03175000
         OI    LOOPOUT,B'00010000'                                 1221 03176000
*          FRAMENUM = FRAMENUM + ONE;  /*KEEP TRACK OF NUMBER ENTRIES*/ 03177000
         LA    @08,1                                               1222 03178000
         AL    @08,FRAMENUM(,@06)                                  1222 03179000
         ST    @08,FRAMENUM(,@06)                                  1222 03180000
*        END;                                              /*@G51DGGB*/ 03181000
*      ELSE                                                        1224 03182000
*        IF Y = EVMAXENT THEN /*UNIQUE ENTRY BUT NOT ROOM IN TABLE*/    03183000
         B     @RC01218                                            1224 03184000
@RF01218 CLC   Y(4),@CF00088                                       1224 03185000
         BNE   @RF01224                                            1224 03186000
*          DO;                                             /*@G51DGGB*/ 03187000
*            IF ONETIME = NO THEN   /*ISSUE MESSAGE ONLY ONCE*/    1226 03188000
         TM    ONETIME,B'00000100'                                 1226 03189000
         BNZ   @RF01226                                            1226 03190000
*              DO;                                         /*@G51DGGB*/ 03191000
*                MSGNO = YY;   /*TELL THE ERROR PROC WHICH MESSAGE*/    03192000
         MVC   MSGNO(4),@CF00066                                   1228 03193000
*                CALL ERRMSG;  /*PRINT OUT THE ERROR MESSAGE @G51DGGB*/ 03194000
         BAL   @14,ERRMSG                                          1229 03195000
*                ONETIME = YES; /*SET TO NOT RETURN          @G51DGGB*/ 03196000
         OI    ONETIME,B'00000100'                                 1230 03197000
*              END;                                        /*@G51DGGB*/ 03198000
*          END;                                            /*@G51DGGB*/ 03199000
@RF01226 DS    0H                                                  1233 03200000
*     END;                                                 /*@G51DGGB*/ 03201000
@RF01224 DS    0H                                                  1233 03202000
@RC01218 DS    0H                                                  1234 03203000
*   END;                                                   /*@G51DGGB*/ 03204000
@RC01215 LA    @08,1                                               1234 03205000
         AL    @08,Y                                               1234 03206000
         ST    @08,Y                                               1234 03207000
         C     @08,@CF00088                                        1234 03208000
         BNH   @DL01214                                            1234 03209000
@DC01214 DS    0H                                                  1235 03210000
*END; /*END OF PROC BUILDFTB                                 @G51DGGB*/ 03211000
@EL00033 DS    0H                                                  1235 03212000
@EF00033 DS    0H                                                  1235 03213000
@ER00033 LM    @14,@12,@SA00033                                    1235 03214000
         BR    @14                                                 1235 03215000
*/********************************************************************/ 03216000
*/*    THIS PROC WILL TAKE THE FRAMES NOW FOUND AND REPLACE THE ONES */ 03217000
*/*    ALREADY FOUND IF THE DATE IS LATER OR IF NONE HAVE BEEN FOUND */ 03218000
*/*    FOR THIS CPU THEN KEEP THEM AND FILL IN THE TABLE     @G51DGGB*/ 03219000
*FRAMEREP: PROC; /*REPLACE FRAME IF MORE CURRENT FRAME FOUND @G51DGGB*/ 03220000
FRAMEREP STM   @14,@12,@SA00034                                    1236 03221000
*                /*COMPLETE ENTRY IF NO DATE ETC.            @G51DGGB*/ 03222000
*                /*APPEND LOCATION OF FRAME EXTERNAL LOCATION LIST*/    03223000
*DCL Q FIXED(31) INIT(0);                                  /*@G51DGGB*/ 03224000
*GETOUT = NO;                                              /*@G51DGGB*/ 03225000
         NI    GETOUT,B'11110111'                                  1238 03226000
*DO Q = 1 BY 1 TO FRAMENUM WHILE GETOUT = NO; /*LOOP THROUGH  SET*/     03227000
         LA    @08,1                                               1239 03228000
         ST    @08,Q                                               1239 03229000
         B     @DE01239                                            1239 03230000
@DL01239 TM    GETOUT,B'00001000'                                  1239 03231000
         BNZ   @DC01239                                            1239 03232000
*                                             /*ENTRIES OF FRAMETAB */  03233000
*  IF FRAMECPU(Q) = LRTCPMOD THEN             /*IF RECORD CPU MODEL */  03234000
         MH    @08,@CH00227                                        1240 03235000
         L     @06,FRAMEPTR(,R2)                                   1240 03236000
         ST    @08,@TF00001                                        1240 03237000
         ALR   @08,@06                                             1240 03238000
         AL    @08,@CF01618                                        1240 03239000
         CLC   FRAMECPU-4(5,@08),LRTCPMOD(R7)                      1240 03240000
         BNE   @RF01240                                            1240 03241000
*    DO;                                      /*SERIAL MATCHES THOSE*/  03242000
*  IF FRAMETYP(Q) ^= '00'X THEN                                    1242 03243000
         AL    @06,@TF00001                                        1242 03244000
         AL    @06,@CF01624                                        1242 03245000
         CLI   FRAMETYP-17(@06),X'00'                              1242 03246000
         BE    @RF01242                                            1242 03247000
*    DUPLICAT(FRINDEX) = DUPLICAT(FRINDEX) + 1;            /*@G51DGGB*/ 03248000
         L     @08,FRINDEX                                         1243 03249000
         ALR   @08,@08                                             1243 03250000
         LA    @06,1                                               1243 03251000
         AH    @06,DUPLICAT-2(@08)                                 1243 03252000
         STH   @06,DUPLICAT-2(@08)                                 1243 03253000
*      CCHINDX = Q;  /*SAVE INDEX*/           /*OF THE ENTRY @G51DGGB*/ 03254000
@RF01242 L     @08,Q                                               1244 03255000
         ST    @08,CCHINDX                                         1244 03256000
*      IF FRAMEDT(Q) < LRTDT THEN             /*IF REC DATE GREATER */  03257000
         MH    @08,@CH00227                                        1245 03258000
         L     @06,FRAMEPTR(,R2)                                   1245 03259000
         ST    @08,@TF00001                                        1245 03260000
         ALR   @08,@06                                             1245 03261000
         AL    @08,@CF01632                                        1245 03262000
         CLC   FRAMEDT-9(8,@08),LRTDT(R7)                          1245 03263000
         BNL   @RF01245                                            1245 03264000
*        DO;                                  /*THAN ENTRY DATE     */  03265000
*         IF DEBUG16 = ON & FRAMEDT(Q) ^= '0000000000000000'X THEN 1247 03266000
         TM    DEBUG16(R2),B'10000000'                             1247 03267000
         BNO   @RF01247                                            1247 03268000
         AL    @06,@TF00001                                        1247 03269000
         AL    @06,@CF01632                                        1247 03270000
         CLC   FRAMEDT-9(8,@06),@CB01577                           1247 03271000
         BE    @RF01247                                            1247 03272000
*          CALL FRAMMORE; /*PRINT THE INFO ABOUT THE NEW & DROPPED*/    03273000
         BAL   @14,FRAMMORE                                        1248 03274000
*           ELSE                                                   1249 03275000
*            DO;                                           /*@G51DGGB*/ 03276000
         B     @RC01247                                            1249 03277000
@RF01247 DS    0H                                                  1250 03278000
*              CALL FIXENTRY;               /*DELETE OLD FRAME SET*/    03279000
         BAL   @14,FIXENTRY                                        1250 03280000
*              FRAMEDT(Q) = LRTDT;           /*SAVE HIGH DATE*/    1251 03281000
         L     @08,Q                                               1251 03282000
         MH    @08,@CH00227                                        1251 03283000
         L     @06,FRAMEPTR(,R2)                                   1251 03284000
         ALR   @06,@08                                             1251 03285000
         AL    @06,@CF01632                                        1251 03286000
         MVC   FRAMEDT-9(8,@06),LRTDT(R7)                          1251 03287000
*            END;                                          /*@G51DGGB*/ 03288000
*              CALL BUILDTTR;                /*SAVE FRAME LOCATION*/    03289000
@RC01247 BAL   @14,BUILDTTR                                        1253 03290000
*               FRAMEYES = YES;/*SAVE SUCCEEDING FRAMES OF THIS    */   03291000
         OI    FRAMEYES,B'00000001'                                1254 03292000
*                              /*LOGICAL SET                 @G51DGGB*/ 03293000
*         END;                                             /*@G51DGGB*/ 03294000
*       ELSE  /*IMPLIES DATE IS LOW OR EQUAL                 @G51DGGB*/ 03295000
*        DO;                                               /*@G51DGGB*/ 03296000
         B     @RC01245                                            1256 03297000
@RF01245 DS    0H                                                  1257 03298000
*         IF FRAMEDT(Q) = LRTDT THEN /*IF TABLE DATE EQUALS RECORD DAT* 03299000
         L     @08,Q                                               1257 03300000
         MH    @08,@CH00227                                        1257 03301000
         L     @06,FRAMEPTR(,R2)                                   1257 03302000
         ST    @08,@TF00001                                        1257 03303000
         ALR   @08,@06                                             1257 03304000
         AL    @08,@CF01632                                        1257 03305000
         CLC   FRAMEDT-9(8,@08),LRTDT(R7)                          1257 03306000
         BNE   @RF01257                                            1257 03307000
*           DO;                                            /*@G51DGGB*/ 03308000
*            IF FRAMETYP(Q) ^= ALLALL THEN                         1259 03309000
         AL    @06,@TF00001                                        1259 03310000
         AL    @06,@CF01624                                        1259 03311000
         CLI   FRAMETYP-17(@06),X'FF'                              1259 03312000
         BE    @RF01259                                            1259 03313000
*             DO;                                          /*@G51DGGB*/ 03314000
*                      MSGNO = QQ; /*ISSUE FRAME SET INCOMPLETE MESS*/  03315000
         MVC   MSGNO(4),@CF00032                                   1261 03316000
*                      CALL ERRMSG;                        /*@G51DGGB*/ 03317000
         BAL   @14,ERRMSG                                          1262 03318000
*                      CALL FIXENTRY; /*DELETE INCOMPLETE SET       */  03319000
         BAL   @14,FIXENTRY                                        1263 03320000
*                      CALL BUILDTTR; /*SAVE THIS FRAME      @G51DGGB*/ 03321000
         BAL   @14,BUILDTTR                                        1264 03322000
*                      FRAMEYES = YES; /*SAVE SUCCEEDING MEMBERS */     03323000
         OI    FRAMEYES,B'00000001'                                1265 03324000
*             END;                                         /*@G51DGGB*/ 03325000
*            ELSE  /*COMPLETE SET FOR THIS DATE ALREADY EXISTS      */  03326000
*               DO; /*FRAMETYP IS EQUAL TO ALLALL            @G51DGGB*/ 03327000
         B     @RC01259                                            1267 03328000
@RF01259 DS    0H                                                  1268 03329000
*                   FRAMEYES = NO;/*DELETE SUCCEEDING FRAMES OF SET */  03330000
         NI    FRAMEYES,B'11111110'                                1268 03331000
*                   SETREJCT(FRINDEX) = SETREJCT(FRINDEX) + 1;     1269 03332000
         L     @08,FRINDEX                                         1269 03333000
         ALR   @08,@08                                             1269 03334000
         LA    @06,1                                               1269 03335000
         AH    @06,SETREJCT-2(@08)                                 1269 03336000
         STH   @06,SETREJCT-2(@08)                                 1269 03337000
*               END;                                       /*@G51DGGB*/ 03338000
*        END; /*END OF CODE IF DATE IN RECORD EQUALS DATE IN TABLE*/    03339000
*       ELSE /*DATE IN TABLE GREATER THAN FRAME RECORD DATE  @G51DGGB*/ 03340000
*        SETREJCT(FRINDEX) = SETREJCT(FRINDEX) + 1;        /*@G51DGGB*/ 03341000
         B     @RC01257                                            1272 03342000
@RF01257 L     @08,FRINDEX                                         1272 03343000
         ALR   @08,@08                                             1272 03344000
         LA    @06,1                                               1272 03345000
         AH    @06,SETREJCT-2(@08)                                 1272 03346000
         STH   @06,SETREJCT-2(@08)                                 1272 03347000
*    END; /*END OF CODE IF DATE IN RECORD IS LOW OR EQUAL    @G51DGGB*/ 03348000
@RC01257 DS    0H                                                  1274 03349000
*  GETOUT = YES; /*GET OUT OF LOOP AFTER CPU MATCH           @G51DGGB*/ 03350000
@RC01245 OI    GETOUT,B'00001000'                                  1274 03351000
* END; /*END OF CODE FOR A RECORD TO ENTRY CPU MATCH         @G51DGGB*/ 03352000
*END; /*END OF FRAMETAB LOOP                                 @G51DGGB*/ 03353000
@RF01240 LA    @08,1                                               1276 03354000
         AL    @08,Q                                               1276 03355000
         ST    @08,Q                                               1276 03356000
@DE01239 L     @06,FRAMEPTR(,R2)                                   1276 03357000
         C     @08,FRAMENUM(,@06)                                  1276 03358000
         BNH   @DL01239                                            1276 03359000
@DC01239 DS    0H                                                  1277 03360000
*IF GETOUT = NO THEN /*MERIDIAN FRAME BUT NO ROOM IN TABLE   @G51DGGB*/ 03361000
         TM    GETOUT,B'00001000'                                  1277 03362000
         BNZ   @RF01277                                            1277 03363000
*  NOMATCH(FRINDEX) = NOMATCH(FRINDEX) + 1;                /*@G51DGGB*/ 03364000
         L     @08,FRINDEX                                         1278 03365000
         ALR   @08,@08                                             1278 03366000
         LA    @06,1                                               1278 03367000
         AH    @06,NOMATCH-2(@08)                                  1278 03368000
         STH   @06,NOMATCH-2(@08)                                  1278 03369000
*END; /*END OF PROC FRAMEREP                                 @G51DGGB*/ 03370000
@EL00034 DS    0H                                                  1279 03371000
@EF00034 DS    0H                                                  1279 03372000
@ER00034 LM    @14,@12,@SA00034                                    1279 03373000
         BR    @14                                                 1279 03374000
*BUILDTTR: PROC; /*SAVE LOCATION OF A FRAME IN LISTLOC       @G51DGGB*/ 03375000
BUILDTTR STM   @14,@12,@SA00035                                    1280 03376000
*RESPECIFY (R15) RESTRICTED;                               /*@G51DGGB*/ 03377000
*DCL TEMP FIXED(31) INIT(0);                               /*@G51DGGB*/ 03378000
*BUILDCT = BUILDCT + 1;                                    /*@G51DGGB*/ 03379000
         LA    @14,1                                               1283 03380000
         AL    @14,BUILDCT                                         1283 03381000
         ST    @14,BUILDCT                                         1283 03382000
*IF (LRTKEY1 & GENREC) = HEXA0 THEN /* IF MCH FRAME          @G51DGGB*/ 03383000
         MVC   @TS00001(1),LRTKEY1(R7)                             1284 03384000
         NI    @TS00001,X'F0'                                      1284 03385000
         CLI   @TS00001,X'A0'                                      1284 03386000
         BNE   @RF01284                                            1284 03387000
*  DO;                                                     /*@G51DGGB*/ 03388000
*    IF FRAMLOCM(CCHINDX) = ZERO THEN /*IF LISTLOC CORE FOR A CPU*/     03389000
         L     @14,CCHINDX                                         1286 03390000
         MH    @14,@CH00227                                        1286 03391000
         L     @08,FRAMEPTR(,R2)                                   1286 03392000
         AL    @08,@CF01620                                        1286 03393000
         L     @14,FRAMLOCM-20(@14,@08)                            1286 03394000
         LTR   @14,@14                                             1286 03395000
         BNZ   @RF01286                                            1286 03396000
*      DO;                            /*IS UNALLOCATED       @G51DGGB*/ 03397000
*        RESPECIFY (R0) RESTRICTED;                        /*@G51DGGB*/ 03398000
*        R0 = LISTBENT * LISTMAX * 2; /*ALLOCATE CORE FOR BOTH CCH*/    03399000
         LA    R0,500                                              1289 03400000
*        R0 = R0 + 12;                /*AND MCH FRAME LOCATIONS   */    03401000
         AL    R0,@CF00032                                         1290 03402000
*        GEN(GETMAIN EC,LV=(0),A=TEMP,SP=21);              /*@G51DGGB*/ 03403000
         GETMAIN EC,LV=(0),A=TEMP,SP=21                                 03404000
*        RESPECIFY (R0) UNRESTRICTED;                      /*@G51DGGB*/ 03405000
*        IF R15 = SUCCESS THEN    /*DID WE GET THE CORE      @G51DGGB*/ 03406000
         LTR   R15,R15                                             1293 03407000
         BNZ   @RF01293                                            1293 03408000
*          DO;                                             /*@G51DGGB*/ 03409000
*            RESPECIFY (R0,R1,R4) RESTRICTED;              /*@G51DGGB*/ 03410000
*            R1 = TEMP;               /*LOAD THE LOCATION OF THE CORE*/ 03411000
         L     R1,TEMP                                             1296 03412000
*            FRAMLOCM(CCHINDX) = R1;  /*SET POINTERS TO LISTLOC   */    03413000
         L     @14,CCHINDX                                         1297 03414000
         MH    @14,@CH00227                                        1297 03415000
         L     @08,FRAMEPTR(,R2)                                   1297 03416000
         AL    @08,@CF01620                                        1297 03417000
         ST    R1,FRAMLOCM-20(@14,@08)                             1297 03418000
*            R1 = R1+LISTBENT *       /*TABLES FOR BOTH CCL AND MCH*/   03419000
*                LISTMAX+4;           /*FRAMES               @G51DGGB*/ 03420000
         AL    R1,@CF01610                                         1298 03421000
*            R0 = ZERO;          /*ENSURE THAT TABLE ON WORD BOUNDARY*/ 03422000
         SLR   R0,R0                                               1299 03423000
*            R4 = 4;             /*DIVIDE BY NUMBER OF BYTES IN WORD*/  03424000
         LA    R4,4                                                1300 03425000
*            GEN(DR R0,R4);                                /*@G51DGGB*/ 03426000
         DR R0,R4                                                       03427000
*            IF R0 > ZERO THEN /*REMAINDER MEANS NOT INTEGRAL NUMBER*/  03428000
         LTR   R0,R0                                               1302 03429000
         BNP   @RF01302                                            1302 03430000
*                              /*NUMBER OF DOUBLEWORDS.      @G51DGGB*/ 03431000
*              R1 = R1 + 1; /*ADD ONE EXTRA FULL WORD        @G51DGGB*/ 03432000
         AL    R1,@CF00055                                         1303 03433000
*            R1 = R1 * FOUR; /*RESET ONE TO NUMBER OF BYTES  @G51DGGB*/ 03434000
@RF01302 SLL   R1,2                                                1304 03435000
*            FRAMLOCC(CCHINDX) = R1; /*SET POINTER TO CCH CCHHR TABLE*/ 03436000
         L     @14,CCHINDX                                         1305 03437000
         MH    @14,@CH00227                                        1305 03438000
         L     @08,FRAMEPTR(,R2)                                   1305 03439000
         ST    R1,FRAMLOCC-24(@14,@08)                             1305 03440000
*            LISTPTR = R1;      /*ESTABLISH ADDRESSABILITY FOR CCH TB*/ 03441000
         ST    R1,LISTPTR                                          1306 03442000
*            RESPECIFY (R0,R1,R4) UNRESTRICTED;            /*@G51DGGB*/ 03443000
*            LISTNUM = ZERO;    /*ZERO CCH LISTLOC TABLE     @G51DGGB*/ 03444000
         L     @14,LISTPTR                                         1308 03445000
         SLR   @08,@08                                             1308 03446000
         ST    @08,LISTNUM(,@14)                                   1308 03447000
*            DO Y = 1 BY 1 TO LISTMAX;                     /*@G51DGGB*/ 03448000
         LA    @14,1                                               1309 03449000
         ST    @14,Y                                               1309 03450000
@DL01309 DS    0H                                                  1310 03451000
*              LISTCCHR(Y) = LISTCCHR(Y) &&                        1310 03452000
*                            LISTCCHR(Y);                  /*@G51DGGB*/ 03453000
         LR    @08,@14                                             1310 03454000
         MH    @08,@CH00079                                        1310 03455000
         L     @06,LISTPTR                                         1310 03456000
         ALR   @06,@08                                             1310 03457000
         BCTR  @06,0                                               1310 03458000
         XC    LISTCCHR-4(5,@06),LISTCCHR-4(@06)                   1310 03459000
*            END;                                          /*@G51DGGB*/ 03460000
         AL    @14,@CF00055                                        1311 03461000
         ST    @14,Y                                               1311 03462000
         C     @14,@CF00293                                        1311 03463000
         BNH   @DL01309                                            1311 03464000
*            LISTPTR = FRAMLOCM(CCHINDX); /*ADDRESS OF MCH LISTLOC */   03465000
         L     @14,CCHINDX                                         1312 03466000
         MH    @14,@CH00227                                        1312 03467000
         L     @08,FRAMEPTR(,R2)                                   1312 03468000
         AL    @08,@CF01620                                        1312 03469000
         L     @14,FRAMLOCM-20(@14,@08)                            1312 03470000
         ST    @14,LISTPTR                                         1312 03471000
*            DO Y = 1 BY 1 TO LISTMAX;   /* ZERO MCH LISTLOC TABLE  */  03472000
         LA    @14,1                                               1313 03473000
         ST    @14,Y                                               1313 03474000
@DL01313 DS    0H                                                  1314 03475000
*            LISTCCHR(Y) = LISTCCHR(Y) &&                          1314 03476000
*                          LISTCCHR(Y);                    /*@G51DGGB*/ 03477000
         LR    @08,@14                                             1314 03478000
         MH    @08,@CH00079                                        1314 03479000
         L     @06,LISTPTR                                         1314 03480000
         ALR   @06,@08                                             1314 03481000
         BCTR  @06,0                                               1314 03482000
         XC    LISTCCHR-4(5,@06),LISTCCHR-4(@06)                   1314 03483000
*            END;                                          /*@G51DGGB*/ 03484000
         AL    @14,@CF00055                                        1315 03485000
         ST    @14,Y                                               1315 03486000
         C     @14,@CF00293                                        1315 03487000
         BNH   @DL01313                                            1315 03488000
*            LISTNUM = ZERO;                               /*@G51DGGB*/ 03489000
         L     @14,LISTPTR                                         1316 03490000
         SLR   @08,@08                                             1316 03491000
         ST    @08,LISTNUM(,@14)                                   1316 03492000
*          END;                                            /*@G51DGGB*/ 03493000
*        ELSE /*UNSUCCESSFUL GETMAIN                         @G51DGGB*/ 03494000
*          DO;                                             /*@G51DGGB*/ 03495000
         B     @RC01293                                            1318 03496000
@RF01293 DS    0H                                                  1319 03497000
*            MSGNO = ZZ;     /*SET THE MESSAGE TYPE          @G51DGGB*/ 03498000
         MVC   MSGNO(4),@CF00034                                   1319 03499000
*            CALL ERRMSG;    /*FIND THE MESSAGE AND PRINT IT @G51DGGB*/ 03500000
         BAL   @14,ERRMSG                                          1320 03501000
*            ERROR = TWELVE;   /*STOP THIS HERE              @G51DGGB*/ 03502000
         MVC   ERROR(4),@CF00032                                   1321 03503000
*          END;                                            /*@G51DGGB*/ 03504000
*      END;                                                /*@G51DGGB*/ 03505000
@RC01293 DS    0H                                                  1324 03506000
*    IF ERROR = ZERO THEN /*IF GETMAIN WAS SUCCESSFUL OR NO GETMAIN*/   03507000
@RF01286 L     @14,ERROR                                           1324 03508000
         LTR   @14,@14                                             1324 03509000
         BNZ   @RF01324                                            1324 03510000
*      LISTPTR = FRAMLOCM(CCHINDX);/*ESTABLISH LISTLOC ADDRESS   */     03511000
         L     @14,CCHINDX                                         1325 03512000
         MH    @14,@CH00227                                        1325 03513000
         L     @08,FRAMEPTR(,R2)                                   1325 03514000
         AL    @08,@CF01620                                        1325 03515000
         L     @14,FRAMLOCM-20(@14,@08)                            1325 03516000
         ST    @14,LISTPTR                                         1325 03517000
*  END;                                                    /*@G51DGGB*/ 03518000
*ELSE /* IS A CCH FRAME                                      @G51DGGB*/ 03519000
*  IF ERROR = ZERO THEN                                            1327 03520000
         B     @RC01284                                            1327 03521000
@RF01284 L     @14,ERROR                                           1327 03522000
         LTR   @14,@14                                             1327 03523000
         BNZ   @RF01327                                            1327 03524000
*    LISTPTR = FRAMLOCC(CCHINDX);  /*ESTABLISH CCH LISTLOC ADDRESS*/    03525000
         L     @14,CCHINDX                                         1328 03526000
         MH    @14,@CH00227                                        1328 03527000
         L     @08,FRAMEPTR(,R2)                                   1328 03528000
         L     @14,FRAMLOCC-24(@14,@08)                            1328 03529000
         ST    @14,LISTPTR                                         1328 03530000
*IF ERROR = ZERO THEN   /*KEEP OUT IF ANY ERRORS             @G51DGGB*/ 03531000
@RF01327 DS    0H                                                  1329 03532000
@RC01284 L     @14,ERROR                                           1329 03533000
         LTR   @14,@14                                             1329 03534000
         BNZ   @RF01329                                            1329 03535000
*  DO;                                                     /*@G51DGGB*/ 03536000
*    IF LISTNUM + 1 <= LISTMAX THEN /*IF ROOM IN LISTLOC     @G51DGGB*/ 03537000
         LA    @14,1                                               1331 03538000
         L     @08,LISTPTR                                         1331 03539000
         AL    @14,LISTNUM(,@08)                                   1331 03540000
         C     @14,@CF00293                                        1331 03541000
         BH    @RF01331                                            1331 03542000
*      DO;                                                 /*@G51DGGB*/ 03543000
*        IF PHIST = ON THEN        /*IF HISTORY INPUT        @G51DGGB*/ 03544000
         TM    PHIST(R2),B'00100000'                               1333 03545000
         BNO   @RF01333                                            1333 03546000
*          CALL IOHND(RITESCRT);   /*WRITE TO SCRATCH DATA SET*/   1334 03547000
         L     @15,ADIOHND(,R2)                                    1334 03548000
         LA    @01,@AL01334                                        1334 03549000
         BALR  @14,@15                                             1334 03550000
*        IF R15 = SUCCESS THEN     /*IF SUCCESSFULL WRITE    @G51DGGB*/ 03551000
@RF01333 LTR   R15,R15                                             1335 03552000
         BNZ   @RF01335                                            1335 03553000
*          DO;                                             /*@G51DGGB*/ 03554000
*            LISTCCHR(LISTNUM+1) = RECCCHHR;/*SAVE FRAME EXTERNAL LOC*/ 03555000
         L     @14,LISTPTR                                         1337 03556000
         L     @08,LISTNUM(,@14)                                   1337 03557000
         LR    @06,@08                                             1337 03558000
         MH    @06,@CH00079                                        1337 03559000
         ALR   @06,@14                                             1337 03560000
         MVC   LISTCCHR(5,@06),RECCCHHR(R2)                        1337 03561000
*            LISTNUM = LISTNUM + 1; /*INCREMENT NO OF BUILT ENTRIES*/   03562000
         LA    @06,1                                               1338 03563000
         ALR   @08,@06                                             1338 03564000
         ST    @08,LISTNUM(,@14)                                   1338 03565000
*            KEPT(FRINDEX) = KEPT(FRINDEX) + 1;            /*@G51DGGB*/ 03566000
         L     @14,FRINDEX                                         1339 03567000
         ALR   @14,@14                                             1339 03568000
         AH    @06,KEPT-2(@14)                                     1339 03569000
         STH   @06,KEPT-2(@14)                                     1339 03570000
*          END;                                            /*@G51DGGB*/ 03571000
*        ELSE  /*UNSUCCESSFUL WRITE TO SCRATCH D.S.          @G51DGGB*/ 03572000
*         ERROR= TWELVE; /*TERMINATE FURTHER PROCESSING      @G51DGGB*/ 03573000
         B     @RC01335                                            1341 03574000
@RF01335 MVC   ERROR(4),@CF00032                                   1341 03575000
*      END;                                                /*@G51DGGB*/ 03576000
*    ELSE     /*NO ROOM IN LISTLOC                           @G51DGGB*/ 03577000
*      DO;                                                 /*@G51DGGB*/ 03578000
         B     @RC01331                                            1343 03579000
@RF01331 DS    0H                                                  1344 03580000
*        MSGNO = PP;  /*MORE THAN 35 FRAMES                  @G51DGGB*/ 03581000
         MVC   MSGNO(4),@CF00035                                   1344 03582000
*        CALL ERRMSG; /*TELL THE WORLD THAT THERE ARE TOO MANY*/   1345 03583000
         BAL   @14,ERRMSG                                          1345 03584000
*        ERROR = TWELVE;/*SET THE RETURN CODE TO AN ERROR CONDITION*/   03585000
         MVC   ERROR(4),@CF00032                                   1346 03586000
*      END;                                                /*@G51DGGB*/ 03587000
*  END;                                                    /*@G51DGGB*/ 03588000
*END; /*END OF BUILDTTR PROC                                 @G51DGGB*/ 03589000
@EL00035 DS    0H                                                  1349 03590000
@EF00035 DS    0H                                                  1349 03591000
@ER00035 LM    @14,@12,@SA00035                                    1349 03592000
         BR    @14                                                 1349 03593000
*FIXENTRY: PROC;  /*RESET LISTLOC TABLE TO ZERO BUT DONT FREE CORE*/    03594000
FIXENTRY STM   @14,@12,12(@13)                                     1350 03595000
*                 /*RESET DATE,TYPE TO ZERO                  @G51DGGB*/ 03596000
*FRAMEDT(CCHINDX) = '0000000000000000'X; /*ZERO DATE,TIME    @G51DGGB*/ 03597000
         L     @14,CCHINDX                                         1351 03598000
         MH    @14,@CH00227                                        1351 03599000
         L     @08,FRAMEPTR(,R2)                                   1351 03600000
         ST    @14,@TF00001                                        1351 03601000
         ALR   @14,@08                                             1351 03602000
         AL    @14,@CF01632                                        1351 03603000
         MVC   FRAMEDT-9(8,@14),@CB01577                           1351 03604000
*FRAMETYP(CCHINDX) = '00'X; /*RESET TO NO TYPES OF FRAMES STORED*/ 1352 03605000
         LR    @14,@08                                             1352 03606000
         AL    @14,@TF00001                                        1352 03607000
         AL    @14,@CF01624                                        1352 03608000
         MVI   FRAMETYP-17(@14),X'00'                              1352 03609000
*IF FRAMLOCM(CCHINDX) > ZERO THEN /*IF MCH FRAME LOC. TAB. ALLOCATED*/  03610000
         L     @14,@TF00001                                        1353 03611000
         AL    @08,@CF01620                                        1353 03612000
         L     @14,FRAMLOCM-20(@14,@08)                            1353 03613000
         LTR   @14,@14                                             1353 03614000
         BNP   @RF01353                                            1353 03615000
*  DO;                                                     /*@G51DGGB*/ 03616000
*    LISTPTR = FRAMLOCM(CCHINDX); /*SET TABLE BASE ADDRESS   @G51DGGB*/ 03617000
         ST    @14,LISTPTR                                         1355 03618000
*    DO Y = 1 BY 1 TO LISTNUM; /*CLEAR ALL STORED CCHHRS TO ZERO*/ 1356 03619000
         LA    @14,1                                               1356 03620000
         ST    @14,Y                                               1356 03621000
         B     @DE01356                                            1356 03622000
@DL01356 DS    0H                                                  1357 03623000
*      LISTCCHR(Y) = (LISTCCHR(Y) && LISTCCHR(Y));         /*@G51DGGB*/ 03624000
         LR    @08,@14                                             1357 03625000
         MH    @08,@CH00079                                        1357 03626000
         L     @06,LISTPTR                                         1357 03627000
         ALR   @06,@08                                             1357 03628000
         BCTR  @06,0                                               1357 03629000
         XC    LISTCCHR-4(5,@06),LISTCCHR-4(@06)                   1357 03630000
*      SETREJCT(1) = SETREJCT(1) + 1; /*ADD TO COUNT OF REJECTED FRMS*/ 03631000
         LA    @08,1                                               1358 03632000
         AH    @08,SETREJCT                                        1358 03633000
         STH   @08,SETREJCT                                        1358 03634000
*      KEPT(1) = KEPT(1) - 1; /*CHANGE THE COUNT OF KEPT FRAMES*/  1359 03635000
         LH    @08,KEPT                                            1359 03636000
         BCTR  @08,0                                               1359 03637000
         STH   @08,KEPT                                            1359 03638000
*    END;                                                  /*@G51DGGB*/ 03639000
         AL    @14,@CF00055                                        1360 03640000
         ST    @14,Y                                               1360 03641000
@DE01356 L     @08,LISTPTR                                         1360 03642000
         C     @14,LISTNUM(,@08)                                   1360 03643000
         BNH   @DL01356                                            1360 03644000
*    LISTNUM = ZERO; /*SET NUMBER OF STORED CCHHRS TO ZERO   @G51DGGB*/ 03645000
         L     @14,LISTPTR                                         1361 03646000
         SLR   @08,@08                                             1361 03647000
         ST    @08,LISTNUM(,@14)                                   1361 03648000
*  END;                                                    /*@G51DGGB*/ 03649000
*IF FRAMLOCC(CCHINDX) > ZERO THEN /*IF CCH FRAM LOC TABLE ALLOCATED*/   03650000
@RF01353 L     @14,CCHINDX                                         1363 03651000
         MH    @14,@CH00227                                        1363 03652000
         L     @08,FRAMEPTR(,R2)                                   1363 03653000
         L     @14,FRAMLOCC-24(@14,@08)                            1363 03654000
         LTR   @14,@14                                             1363 03655000
         BNP   @RF01363                                            1363 03656000
*  DO;                                                     /*@G51DGGB*/ 03657000
*    LISTPTR = FRAMLOCC(CCHINDX); /*SET BASE ADDRESS OF LISTLOC*/  1365 03658000
         ST    @14,LISTPTR                                         1365 03659000
*    DO Y = 1 BY 1 TO LISTNUM; /*ZERO ALL SAVED CCHHRS       @G51DGGB*/ 03660000
         LA    @14,1                                               1366 03661000
         ST    @14,Y                                               1366 03662000
         B     @DE01366                                            1366 03663000
@DL01366 DS    0H                                                  1367 03664000
*      LISTCCHR(Y) = (LISTCCHR(Y) && LISTCCHR(Y));         /*@G51DGGB*/ 03665000
         LR    @08,@14                                             1367 03666000
         MH    @08,@CH00079                                        1367 03667000
         L     @06,LISTPTR                                         1367 03668000
         ALR   @06,@08                                             1367 03669000
         BCTR  @06,0                                               1367 03670000
         XC    LISTCCHR-4(5,@06),LISTCCHR-4(@06)                   1367 03671000
*      SETREJCT(2) = SETREJCT(2) + 1; /*ADD TO COUNT OF REJECTED FRMS*/ 03672000
         LA    @08,1                                               1368 03673000
         AH    @08,SETREJCT+2                                      1368 03674000
         STH   @08,SETREJCT+2                                      1368 03675000
*      KEPT(2) = KEPT(2) - 1; /*CHANGE THE COUNT OF KEPT FRAMES*/  1369 03676000
         LH    @08,KEPT+2                                          1369 03677000
         BCTR  @08,0                                               1369 03678000
         STH   @08,KEPT+2                                          1369 03679000
*    END;                                                  /*@G51DGGB*/ 03680000
         AL    @14,@CF00055                                        1370 03681000
         ST    @14,Y                                               1370 03682000
@DE01366 L     @08,LISTPTR                                         1370 03683000
         C     @14,LISTNUM(,@08)                                   1370 03684000
         BNH   @DL01366                                            1370 03685000
*    LISTNUM = ZERO; /*SET NUMBER OF  CCHHRS SAVED TO ZERO   @G51DGGB*/ 03686000
         L     @14,LISTPTR                                         1371 03687000
         SLR   @08,@08                                             1371 03688000
         ST    @08,LISTNUM(,@14)                                   1371 03689000
*  END;                                                    /*@G51DGGB*/ 03690000
*END;                                                      /*@G51DGGB*/ 03691000
@EL00036 DS    0H                                                  1373 03692000
@EF00036 DS    0H                                                  1373 03693000
@ER00036 LM    @14,@12,12(@13)                                     1373 03694000
         BR    @14                                                 1373 03695000
*/********************************************************************/ 03696000
*/*    THIS PROC WILL CONVERT THE RECORD DATE & TIME INTO HUNDREDS   */ 03697000
*/*     AND APPEND THIS TO THE YEAR IN THE CURRENT SORT TABLE ENTRY  */ 03698000
*ADDTABLE: PROC;                                           /*@G51DGGB*/ 03699000
ADDTABLE STM   @14,@12,12(@13)                                     1374 03700000
*RESPECIFY (R0,R1) RESTRICTED;                             /*@G51DGGB*/ 03701000
*SORTYEAR(I) = LRTYEAR;   /*SET THE YEAR INTO THE SORT TABLE @G51DGGB*/ 03702000
         L     @14,I                                               1376 03703000
         LA    @08,10                                              1376 03704000
         LR    @05,@14                                             1376 03705000
         MR    @04,@08                                             1376 03706000
         L     @06,SORTADR(,R2)                                    1376 03707000
         ST    @05,@TF00001                                        1376 03708000
         ALR   @05,@06                                             1376 03709000
         AL    @05,@CF01633                                        1376 03710000
         MVC   SORTYEAR(1,@05),LRTYEAR(R7)                         1376 03711000
*CVB(R1,LRTDAY);          /*CONVERT THE DATE FROM HEX REP TO BINARY*/   03712000
         XC    @TS00001(8),@TS00001                                1377 03713000
         MVC   @TS00001+6(2),LRTDAY(R7)                            1377 03714000
         CVB   R1,@TS00001                                         1377 03715000
*TEMPSAVE = R1 * N8MIL64H;/*8640000 HUNDREDTS IN ONE DAY     @G51DGGB*/ 03716000
         LR    @05,R1                                              1378 03717000
         M     @04,@CF00864                                        1378 03718000
         ST    @05,TEMPSAVE                                        1378 03719000
*R0 = LRTHOUR;            /*LOAD THE RECORD S HOUR           @G51DGGB*/ 03720000
         SLR   R0,R0                                               1379 03721000
         IC    R0,LRTHOUR(,R7)                                     1379 03722000
*SRDL(R0,FOUR);           /*SPLIT THE BYTE IN HALF           @G51DGGB*/ 03723000
         SRDL  R0,4                                                1380 03724000
*SRL(R1,28);              /*RIGHT JUSTIFY THE VALUE          @G51DGGB*/ 03725000
         SRL   R1,28                                               1381 03726000
*TEMPSAVE = (R0 * TEN + R1) * N36000 + TEMPSAVE;           /*@G51DGGB*/ 03727000
         ST    @05,@TF00002                                        1382 03728000
         LR    @05,R0                                              1382 03729000
         MR    @04,@08                                             1382 03730000
         ALR   @05,R1                                              1382 03731000
         M     @04,@CF00866                                        1382 03732000
         AL    @05,@TF00002                                        1382 03733000
         ST    @05,TEMPSAVE                                        1382 03734000
*R0 = LRTMIN;             /*LOAD THE MIN VALUE INTO THE REG  @G51DGGB*/ 03735000
         SLR   R0,R0                                               1383 03736000
         IC    R0,LRTMIN(,R7)                                      1383 03737000
*SRDL(R0,FOUR);           /*SPLIT THE BYTE IN HALF           @G51DGGB*/ 03738000
         SRDL  R0,4                                                1384 03739000
*SRL(R1,28);              /*RIGHT JUSTIFY THE VALUE          @G51DGGB*/ 03740000
         SRL   R1,28                                               1385 03741000
*TEMPSAVE = (R0*10 + R1) * N6000 + TEMPSAVE; /*CONVERT TO USEABLE */    03742000
         ST    @05,@TF00002                                        1386 03743000
         LR    @05,R0                                              1386 03744000
         MR    @04,@08                                             1386 03745000
         ALR   @05,R1                                              1386 03746000
         MH    @05,@CH00868                                        1386 03747000
         AL    @05,@TF00002                                        1386 03748000
         ST    @05,TEMPSAVE                                        1386 03749000
*R0 = LRTSEC;             /*LOAD THE SEC VALUE INTO THE REG  @XA22531*/ 03750000
         SLR   R0,R0                                               1387 03751000
         IC    R0,LRTSEC(,R7)                                      1387 03752000
*SRDL(R0,FOUR);           /*SPLIT THE BYTE IN HALF           @XA22531*/ 03753000
         SRDL  R0,4                                                1388 03754000
*SRL(R1,28);              /*RIGHT JUSTIFY THE VALUE          @XA22531*/ 03755000
         SRL   R1,28                                               1389 03756000
*TEMPSAVE = (R0*10 + R1) *   100 + TEMPSAVE; /*CONVERT TO USEABLE */    03757000
         ST    @05,@TF00002                                        1390 03758000
         LR    @05,R0                                              1390 03759000
         MR    @04,@08                                             1390 03760000
         ALR   @05,R1                                              1390 03761000
         MH    @05,@CH00392                                        1390 03762000
         AL    @05,@TF00002                                        1390 03763000
         ST    @05,TEMPSAVE                                        1390 03764000
*R0 = LRTHSECS;           /*PICK UP THE HUNSECS VALUE        @XA22531*/ 03765000
         SLR   R0,R0                                               1391 03766000
         IC    R0,LRTHSECS(,R7)                                    1391 03767000
*SRDL(R0,FOUR);           /*SPLIT THE BYTE IN HALF           @G51DGGB*/ 03768000
         SRDL  R0,4                                                1392 03769000
*SRL(R1,28);              /*RIGHT JUSTIFY                    @G51DGGB*/ 03770000
         SRL   R1,28                                               1393 03771000
*SORTTIME(I) = TEMPSAVE + R0*10 +  R1; /*MOVE TOTAL VALUE TO SORT TAB*/ 03772000
         ST    @05,@TF00002                                        1394 03773000
         LR    @05,@08                                             1394 03774000
         MR    @04,R0                                              1394 03775000
         AL    @05,@TF00002                                        1394 03776000
         ALR   @05,R1                                              1394 03777000
         LR    @08,@06                                             1394 03778000
         AL    @08,@TF00001                                        1394 03779000
         AL    @08,@CF01634                                        1394 03780000
         STCM  @05,15,SORTTIME-1(@08)                              1394 03781000
*SORTCCHR(I) = RECCCHHR;  /*MOVE IN THE LOCATION OF THE RECORD*/   1395 03782000
         AL    @06,@TF00001                                        1395 03783000
         AL    @06,@CF01635                                        1395 03784000
         MVC   SORTCCHR-5(5,@06),RECCCHHR(R2)                      1395 03785000
*I = I + 1;               /*BUMP THE INDEX FOR THE RECORD THAT PASSES*/ 03786000
         LA    @08,1                                               1396 03787000
         ALR   @14,@08                                             1396 03788000
         ST    @14,I                                               1396 03789000
* PASSNUM = PASSNUM + ONE;/*ADD 1 TO THE NUMBER OF RECORDS KEPT*/  1397 03790000
         AL    @08,PASSNUM                                         1397 03791000
         ST    @08,PASSNUM                                         1397 03792000
*RESPECIFY (R0,R1) UNRESTRICTED;                           /*@G51DGGB*/ 03793000
*END;                                                      /*@G51DGGB*/ 03794000
@EL00037 DS    0H                                                  1399 03795000
@EF00037 DS    0H                                                  1399 03796000
@ER00037 LM    @14,@12,12(@13)                                     1399 03797000
         BR    @14                                                 1399 03798000
*ERRMSG: PROC;                                             /*@Z427VLS*/ 03799000
ERRMSG   STM   @14,@12,@SA00038                                    1400 03800000
*PRINTADR = ADDR(PRINTLIN);                                /*@Z427VLS*/ 03801000
         LA    @14,PRINTLIN                                        1401 03802000
         ST    @14,PRINTADR(,R2)                                   1401 03803000
*IF MSGNO = 2 THEN                                                 1402 03804000
         CLC   MSGNO(4),@CF00074                                   1402 03805000
         BNE   @RF01402                                            1402 03806000
* CALL IFCMSG(55,ADDR(PRINTBDY));                          /*@Z427VLS*/ 03807000
         LA    @14,PRINTBDY                                        1403 03808000
         ST    @14,@AFTEMPS+4                                      1403 03809000
         L     @15,ADIFCMSG(,R2)                                   1403 03810000
         LA    @01,@AL01403                                        1403 03811000
         BALR  @14,@15                                             1403 03812000
*IF MSGNO = 3 THEN                                                 1404 03813000
@RF01402 CLC   MSGNO(4),@CF00076                                   1404 03814000
         BNE   @RF01404                                            1404 03815000
* CALL IFCMSG(53,ADDR(PRINTBDY));                          /*@Z427VLS*/ 03816000
         LA    @14,PRINTBDY                                        1405 03817000
         ST    @14,@AFTEMPS+4                                      1405 03818000
         L     @15,ADIFCMSG(,R2)                                   1405 03819000
         LA    @01,@AL01405                                        1405 03820000
         BALR  @14,@15                                             1405 03821000
*  IF MSGNO = 5                                                    1406 03822000
*   THEN                                                           1406 03823000
@RF01404 CLC   MSGNO(4),@CF00079                                   1406 03824000
         BNE   @RF01406                                            1406 03825000
*    PRINTBDY = EXCESCPU;                                  /*@Z427VLS*/ 03826000
         MVI   PRINTBDY+16,C' '                                    1407 03827000
         MVC   PRINTBDY+17(115),PRINTBDY+16                        1407 03828000
         MVC   PRINTBDY(16),EXCESCPU                               1407 03829000
*NOMESAGE = OFF;                                           /*@G51DGGB*/ 03830000
@RF01406 NI    NOMESAGE,B'01111111'                                1408 03831000
* IF MSGNO = YY THEN                                               1409 03832000
         CLC   MSGNO(4),@CF00066                                   1409 03833000
         BNE   @RF01409                                            1409 03834000
*  CALL IFCMSG(24,ADDR(PRINTBDY));                         /*@G51DGGB*/ 03835000
         LA    @14,PRINTBDY                                        1410 03836000
         ST    @14,@AFTEMPS+4                                      1410 03837000
         L     @15,ADIFCMSG(,R2)                                   1410 03838000
         LA    @01,@AL01410                                        1410 03839000
         BALR  @14,@15                                             1410 03840000
* IF MSGNO = QQ THEN                                               1411 03841000
@RF01409 CLC   MSGNO(4),@CF00032                                   1411 03842000
         BNE   @RF01411                                            1411 03843000
*  DO;                                                     /*@G51DGGB*/ 03844000
*  IF DEBUG16 = ON THEN                                            1413 03845000
         TM    DEBUG16(R2),B'10000000'                             1413 03846000
         BNO   @RF01413                                            1413 03847000
*   CALL FRAMDROP;                                         /*@G51DGGB*/ 03848000
         BAL   @14,FRAMDROP                                        1414 03849000
*  ELSE                                                            1415 03850000
*  NOMESAGE = ON;                                          /*@G51DGGB*/ 03851000
         B     @RC01413                                            1415 03852000
@RF01413 OI    NOMESAGE,B'10000000'                                1415 03853000
*  END;                                                    /*@G51DGGB*/ 03854000
@RC01413 DS    0H                                                  1417 03855000
* IF MSGNO = QQ1 THEN                                              1417 03856000
@RF01411 CLC   MSGNO(4),@CF00083                                   1417 03857000
         BNE   @RF01417                                            1417 03858000
*  DO;                                                     /*@G51DGGB*/ 03859000
*  CALL IFCMSG(78,ADDR(PRINTBDY));                         /*@G51DGGB*/ 03860000
         LA    @14,PRINTBDY                                        1419 03861000
         ST    @14,@AFTEMPS+4                                      1419 03862000
         L     @15,ADIFCMSG(,R2)                                   1419 03863000
         LA    @01,@AL01419                                        1419 03864000
         BALR  @14,@15                                             1419 03865000
*   NUMBER = 3;                                            /*@G51DGGB*/ 03866000
         MVC   NUMBER(4),@CF00076                                  1420 03867000
*   ADDNXT = ADDR(PFRAMSER);  /*WHERE TO PUT THE CONVERTED BYTES*/ 1421 03868000
         LA    @14,PFRAMSER                                        1421 03869000
         ST    @14,ADDNXT                                          1421 03870000
*   NEXTBY = ADDR(FRAMESER(CCHINDX)); /*WHERE TO GET THE BYTES FROM*/   03871000
         L     @14,CCHINDX                                         1422 03872000
         MH    @14,@CH00227                                        1422 03873000
         L     @08,FRAMEPTR(,R2)                                   1422 03874000
         AL    @08,@CF01618                                        1422 03875000
         LA    @14,FRAMESER-4(@14,@08)                             1422 03876000
         ST    @14,NEXTBY                                          1422 03877000
*   CALL CONVERT;                                          /*@G51DGGB*/ 03878000
         BAL   @14,CONVERT                                         1423 03879000
*   NUMBER = 2;                                            /*@G51DGGB*/ 03880000
         MVC   NUMBER(4),@CF00074                                  1424 03881000
*   ADDNXT = ADDR(PFRAMMOD);  /*DISPLACEMENT FOR THE MODEL   @G51DGGB*/ 03882000
         LA    @14,PFRAMMOD                                        1425 03883000
         ST    @14,ADDNXT                                          1425 03884000
*   NEXTBY = ADDR(FRAMEMOD(CCHINDX)); /*LOCATION OF MODEL    @G51DGGB*/ 03885000
         L     @14,CCHINDX                                         1426 03886000
         MH    @14,@CH00227                                        1426 03887000
         L     @08,FRAMEPTR(,R2)                                   1426 03888000
         AL    @08,@CF01636                                        1426 03889000
         LA    @14,FRAMEMOD-7(@14,@08)                             1426 03890000
         ST    @14,NEXTBY                                          1426 03891000
*   CALL CONVERT;                                          /*@G51DGGB*/ 03892000
         BAL   @14,CONVERT                                         1427 03893000
*  END;                                                    /*@G51DGGB*/ 03894000
* IF MSGNO = ZZ THEN                                               1429 03895000
@RF01417 CLC   MSGNO(4),@CF00034                                   1429 03896000
         BNE   @RF01429                                            1429 03897000
*  CALL IFCMSG(40,ADDR(PRINTBDY));                         /*@G51DGGB*/ 03898000
         LA    @14,PRINTBDY                                        1430 03899000
         ST    @14,@AFTEMPS+4                                      1430 03900000
         L     @15,ADIFCMSG(,R2)                                   1430 03901000
         LA    @01,@AL01430                                        1430 03902000
         BALR  @14,@15                                             1430 03903000
* IF MSGNO = PP THEN                                               1431 03904000
@RF01429 CLC   MSGNO(4),@CF00035                                   1431 03905000
         BNE   @RF01431                                            1431 03906000
*  CALL IFCMSG(5,ADDR(PRINTBDY));                          /*@G51DGGB*/ 03907000
         LA    @14,PRINTBDY                                        1432 03908000
         ST    @14,@AFTEMPS+4                                      1432 03909000
         L     @15,ADIFCMSG(,R2)                                   1432 03910000
         LA    @01,@AL01432                                        1432 03911000
         BALR  @14,@15                                             1432 03912000
* IF MSGNO = XX THEN                                               1433 03913000
@RF01431 CLC   MSGNO(4),@CF00081                                   1433 03914000
         BNE   @RF01433                                            1433 03915000
*  CALL IFCMSG(40,ADDR(PRINTBDY));                         /*@G51DGGB*/ 03916000
         LA    @14,PRINTBDY                                        1434 03917000
         ST    @14,@AFTEMPS+4                                      1434 03918000
         L     @15,ADIFCMSG(,R2)                                   1434 03919000
         LA    @01,@AL01434                                        1434 03920000
         BALR  @14,@15                                             1434 03921000
* IF NOMESAGE = OFF THEN                                           1435 03922000
@RF01433 TM    NOMESAGE,B'10000000'                                1435 03923000
         BNZ   @RF01435                                            1435 03924000
*CALL IOHND(RITEPRTR);                                     /*@Z427VLS*/ 03925000
         L     @15,ADIOHND(,R2)                                    1436 03926000
         LA    @01,@AL01436                                        1436 03927000
         BALR  @14,@15                                             1436 03928000
*END;                                                      /*@Z427VLS*/ 03929000
@EL00038 DS    0H                                                  1437 03930000
@EF00038 DS    0H                                                  1437 03931000
@ER00038 LM    @14,@12,@SA00038                                    1437 03932000
         BR    @14                                                 1437 03933000
*FRAMDROP: PROC;                                           /*@G51DGGB*/ 03934000
FRAMDROP STM   @14,@12,@SA00039                                    1438 03935000
*  PRINTBDY = ERR7816;                                     /*@G51DGGB*/ 03936000
         MVI   PRINTBDY+18,C' '                                    1439 03937000
         MVC   PRINTBDY+19(113),PRINTBDY+18                        1439 03938000
         MVC   PRINTBDY(18),ERR7816                                1439 03939000
*  TYPERROR= INCOMP;                                       /*@G51DGGB*/ 03940000
         MVC   TYPERROR(10),INCOMP                                 1440 03941000
*   NUMBER = 3;                                            /*@G51DGGB*/ 03942000
         MVC   NUMBER(4),@CF00076                                  1441 03943000
*   ADDNXT = ADDR(ZFRAMSER);  /*WHERE TO PUT THE CONVERTED BYTES*/ 1442 03944000
         LA    @14,ZFRAMSER                                        1442 03945000
         ST    @14,ADDNXT                                          1442 03946000
*   NEXTBY = ADDR(FRAMESER(CCHINDX)); /*WHERE TO GET THE BYTES FROM*/   03947000
         L     @14,CCHINDX                                         1443 03948000
         MH    @14,@CH00227                                        1443 03949000
         L     @08,FRAMEPTR(,R2)                                   1443 03950000
         AL    @08,@CF01618                                        1443 03951000
         LA    @14,FRAMESER-4(@14,@08)                             1443 03952000
         ST    @14,NEXTBY                                          1443 03953000
*   CALL CONVERT;                                          /*@G51DGGB*/ 03954000
         BAL   @14,CONVERT                                         1444 03955000
*   NUMBER = 2;                                            /*@G51DGGB*/ 03956000
         MVC   NUMBER(4),@CF00074                                  1445 03957000
*   ADDNXT = ADDR(ZFRAMMOD);  /*DISPLACEMENT FOR THE MODEL   @G51DGGB*/ 03958000
         LA    @14,ZFRAMMOD                                        1446 03959000
         ST    @14,ADDNXT                                          1446 03960000
*   NEXTBY = ADDR(FRAMEMOD(CCHINDX)); /*LOCATION OF MODEL    @G51DGGB*/ 03961000
         L     @14,CCHINDX                                         1447 03962000
         MH    @14,@CH00227                                        1447 03963000
         L     @08,FRAMEPTR(,R2)                                   1447 03964000
         AL    @08,@CF01636                                        1447 03965000
         LA    @14,FRAMEMOD-7(@14,@08)                             1447 03966000
         ST    @14,NEXTBY                                          1447 03967000
*   CALL CONVERT;                                          /*@G51DGGB*/ 03968000
         BAL   @14,CONVERT                                         1448 03969000
*   NUMBER = 14;                                           /*@G51DGGB*/ 03970000
         MVC   NUMBER(4),@CF01286                                  1449 03971000
*   NEXTBY = ADDR(FRAMEKEY(CCHINDX));                      /*@G51DGGB*/ 03972000
         L     @14,CCHINDX                                         1450 03973000
         MH    @14,@CH00227                                        1450 03974000
         L     @08,FRAMEPTR(,R2)                                   1450 03975000
         AL    @08,@CF01618                                        1450 03976000
         LA    @14,FRAMEKEY-4(@14,@08)                             1450 03977000
         ST    @14,NEXTBY                                          1450 03978000
*   ADDNXT = ADDR(ZFRAMKEY);                               /*@G51DGGB*/ 03979000
         LA    @14,ZFRAMKEY                                        1451 03980000
         ST    @14,ADDNXT                                          1451 03981000
*   CALL CONVERT;                                          /*@G51DGGB*/ 03982000
         BAL   @14,CONVERT                                         1452 03983000
*END;                                                      /*@G51DGGB*/ 03984000
@EL00039 DS    0H                                                  1453 03985000
@EF00039 DS    0H                                                  1453 03986000
@ER00039 LM    @14,@12,@SA00039                                    1453 03987000
         BR    @14                                                 1453 03988000
*FRAMMORE: PROC;                                           /*@G51DGGB*/ 03989000
FRAMMORE STM   @14,@12,@SA00040                                    1454 03990000
*  CALL FRAMDROP;                                          /*@G51DGGB*/ 03991000
         BAL   @14,FRAMDROP                                        1455 03992000
*  CALL FIXENTRY;                                          /*@G51DGGB*/ 03993000
         BAL   @14,FIXENTRY                                        1456 03994000
*  FRAMEDT(CCHINDX) = LRTDT;           /*SAVE HIGH DATE      @G51DGGB*/ 03995000
         L     @14,CCHINDX                                         1457 03996000
         MH    @14,@CH00227                                        1457 03997000
         L     @08,FRAMEPTR(,R2)                                   1457 03998000
         ST    @14,@TF00001                                        1457 03999000
         ALR   @14,@08                                             1457 04000000
         AL    @14,@CF01632                                        1457 04001000
         MVC   FRAMEDT-9(8,@14),LRTDT(R7)                          1457 04002000
*  TYPERROR= REPLACED;                                     /*@G51DGGB*/ 04003000
         MVI   TYPERROR+8,C' '                                     1458 04004000
         MVI   TYPERROR+9,C' '                                     1458 04005000
         MVC   TYPERROR(8),REPLACED                                1458 04006000
*   NUMBER = 3;                                            /*@G51DGGB*/ 04007000
         MVC   NUMBER(4),@CF00076                                  1459 04008000
*   ADDNXT = ADDR(YFRAMSER);  /*WHERE TO PUT THE CONVERTED BYTES*/ 1460 04009000
         LA    @14,YFRAMSER                                        1460 04010000
         ST    @14,ADDNXT                                          1460 04011000
*   NEXTBY = ADDR(FRAMESER(CCHINDX)); /*WHERE TO GET THE BYTES FROM*/   04012000
         L     @14,@TF00001                                        1461 04013000
         AL    @08,@CF01618                                        1461 04014000
         LA    @14,FRAMESER-4(@14,@08)                             1461 04015000
         ST    @14,NEXTBY                                          1461 04016000
*   CALL CONVERT;                                          /*@G51DGGB*/ 04017000
         BAL   @14,CONVERT                                         1462 04018000
*   NUMBER = 2;                                            /*@G51DGGB*/ 04019000
         MVC   NUMBER(4),@CF00074                                  1463 04020000
*   ADDNXT = ADDR(YFRAMMOD);  /*DISPLACEMENT FOR THE MODEL   @G51DGGB*/ 04021000
         LA    @14,YFRAMMOD                                        1464 04022000
         ST    @14,ADDNXT                                          1464 04023000
*   NEXTBY = ADDR(FRAMEMOD(CCHINDX)); /*LOCATION OF MODEL    @G51DGGB*/ 04024000
         L     @14,CCHINDX                                         1465 04025000
         MH    @14,@CH00227                                        1465 04026000
         L     @08,FRAMEPTR(,R2)                                   1465 04027000
         AL    @08,@CF01636                                        1465 04028000
         LA    @14,FRAMEMOD-7(@14,@08)                             1465 04029000
         ST    @14,NEXTBY                                          1465 04030000
*   CALL CONVERT;                                          /*@G51DGGB*/ 04031000
         BAL   @14,CONVERT                                         1466 04032000
*   NUMBER = 14;                                           /*@G51DGGB*/ 04033000
         MVC   NUMBER(4),@CF01286                                  1467 04034000
*   NEXTBY = ADDR(FRAMEKEY(CCHINDX));                      /*@G51DGGB*/ 04035000
         L     @14,CCHINDX                                         1468 04036000
         MH    @14,@CH00227                                        1468 04037000
         L     @08,FRAMEPTR(,R2)                                   1468 04038000
         AL    @08,@CF01618                                        1468 04039000
         LA    @14,FRAMEKEY-4(@14,@08)                             1468 04040000
         ST    @14,NEXTBY                                          1468 04041000
*   ADDNXT = ADDR(YFRAMKEY);                               /*@G51DGGB*/ 04042000
         LA    @14,YFRAMKEY                                        1469 04043000
         ST    @14,ADDNXT                                          1469 04044000
*   CALL CONVERT;                                          /*@G51DGGB*/ 04045000
         BAL   @14,CONVERT                                         1470 04046000
*   CALL PRINTIT;                                          /*@G51DGGB*/ 04047000
         BAL   @14,PRINTIT                                         1471 04048000
*END;                                                      /*@G51DGGB*/ 04049000
@EL00040 DS    0H                                                  1472 04050000
@EF00040 DS    0H                                                  1472 04051000
@ER00040 LM    @14,@12,@SA00040                                    1472 04052000
         BR    @14                                                 1472 04053000
*EVSET: PROC; /*SAVE UNIQUE CPUS AND END DATE IN EVTABLE     @Z427VLS*/ 04054000
EVSET    STM   @14,@12,12(@13)                                     1473 04055000
*EVFLAG = NO;                                              /*@Z427VLS*/ 04056000
         NI    EVFLAG,B'11101111'                                  1474 04057000
*DO J = 1 BY 1 TO EVMAXENT WHILE EVFLAG = NO;              /*@Z427VLS*/ 04058000
         LA    @14,1                                               1475 04059000
         ST    @14,J                                               1475 04060000
@DL01475 TM    EVFLAG,B'00010000'                                  1475 04061000
         BNZ   @DC01475                                            1475 04062000
*  IF J > EVNUM THEN                                               1476 04063000
         L     @08,EVPTR(,R2)                                      1476 04064000
         LH    @06,EVNUM(,@08)                                     1476 04065000
         CR    @14,@06                                             1476 04066000
         BNH   @RF01476                                            1476 04067000
*   DO;                                                    /*@Z427VLS*/ 04068000
*     EVMODEL(J) = LRTMODEL;                               /*@Z427VLS*/ 04069000
         MH    @14,@CH00081                                        1478 04070000
         ST    @14,@TF00001                                        1478 04071000
         ALR   @14,@08                                             1478 04072000
         MVC   EVMODEL-6(2,@14),LRTMODEL(R7)                       1478 04073000
*     EVSERIAL(J) = LRTCPUS;                               /*@Z427VLS*/ 04074000
         LR    @14,@08                                             1479 04075000
         AL    @14,@TF00001                                        1479 04076000
         MVC   EVSERIAL-6(3,@14),LRTCPUS(R7)                       1479 04077000
*     EVNUM = EVNUM + 1;                                   /*@Z427VLS*/ 04078000
         AL    @06,@CF00055                                        1480 04079000
         STH   @06,EVNUM(,@08)                                     1480 04080000
*     EVFLAG = ON;                                         /*@Z427VLS*/ 04081000
         OI    EVFLAG,B'00010000'                                  1481 04082000
*   END;                                                   /*@Z427VLS*/ 04083000
*   ELSE                                                           1483 04084000
*  IF LRTMODEL = EVMODEL(J) & LRTCPUS = EVSERIAL(J) THEN           1483 04085000
         B     @RC01476                                            1483 04086000
@RF01476 L     @14,J                                               1483 04087000
         MH    @14,@CH00081                                        1483 04088000
         L     @08,EVPTR(,R2)                                      1483 04089000
         ST    @14,@TF00001                                        1483 04090000
         ALR   @14,@08                                             1483 04091000
         CLC   LRTMODEL(2,R7),EVMODEL-6(@14)                       1483 04092000
         BNE   @RF01483                                            1483 04093000
         AL    @08,@TF00001                                        1483 04094000
         CLC   LRTCPUS(3,R7),EVSERIAL-6(@08)                       1483 04095000
         BNE   @RF01483                                            1483 04096000
*    EVFLAG = ON;                                          /*@Z427VLS*/ 04097000
         OI    EVFLAG,B'00010000'                                  1484 04098000
*END;                                                      /*@Z427VLS*/ 04099000
@RF01483 DS    0H                                                  1485 04100000
@RC01476 LA    @14,1                                               1485 04101000
         AL    @14,J                                               1485 04102000
         ST    @14,J                                               1485 04103000
         C     @14,@CF00088                                        1485 04104000
         BNH   @DL01475                                            1485 04105000
@DC01475 DS    0H                                                  1486 04106000
*  IF EVFLAG = NO THEN            /*ONLY HAPPEN IF TOO MANY CPUS */     04107000
         TM    EVFLAG,B'00010000'                                  1486 04108000
         BNZ   @RF01486                                            1486 04109000
*   DO;                                                    /*@0001VLS*/ 04110000
*    EXCESS = EXCESS + ONE;       /*KEEP TRACK OF # RECORDS DROPPED*/   04111000
         LA    @14,1                                               1488 04112000
         L     @08,EXCESS                                          1488 04113000
         ALR   @08,@14                                             1488 04114000
         ST    @08,EXCESS                                          1488 04115000
*    PASSFLAG = NO;               /*TELL PRIME ROUTINE TO CHUCK    */   04116000
         NI    PASSFLAG(R2),B'11111110'                            1489 04117000
*    EXCPUCT(RTYP1) = EXCPUCT(RTYP1) + ONE;  /*ADD TO THE COUNT OF  */  04118000
         L     @08,RTYP1                                           1490 04119000
         SLA   @08,2                                               1490 04120000
         AL    @14,EXCPUCT-4(@08)                                  1490 04121000
         ST    @14,EXCPUCT-4(@08)                                  1490 04122000
*       /*EXCESSS CPU REC TYPE DROPPED                       @0099VLS*/ 04123000
*   END;                                                   /*@0001VLS*/ 04124000
*   ELSE                                                           1492 04125000
*   DO;                                                    /*@0001VLS*/ 04126000
         B     @RC01486                                            1492 04127000
@RF01486 DS    0H                                                  1493 04128000
*IF LRTYRDAY > EVSTOP THEN            /*FIND THE LAST DATE ON DATA */   04129000
         L     @14,EVPTR(,R2)                                      1493 04130000
         CLC   LRTYRDAY(3,R7),EVSTOP(@14)                          1493 04131000
         BNH   @RF01493                                            1493 04132000
*  EVSTOP = LRTYRDAY;                                      /*@Z427VLS*/ 04133000
         MVC   EVSTOP(3,@14),LRTYRDAY(R7)                          1494 04134000
*IF LRTYRDAY < STRTDATE THEN          /*IS THIS EARLY START DATE  */    04135000
@RF01493 CLC   LRTYRDAY(3,R7),STRTDATE(R2)                         1495 04136000
         BNL   @RF01495                                            1495 04137000
*  STRTDATE = LRTYRDAY;                /*SET TO NEW EARLY DATE     */   04138000
         MVC   STRTDATE(3,R2),LRTYRDAY(R7)                         1496 04139000
*   END;                                                   /*@0001VLS*/ 04140000
*END;                                                      /*@Z427VLS*/ 04141000
@EL00041 DS    0H                                                  1498 04142000
@EF00041 DS    0H                                                  1498 04143000
@ER00041 LM    @14,@12,12(@13)                                     1498 04144000
         BR    @14                                                 1498 04145000
*END   /*CLOSING END FOR IFCFILT4 EXTERNAL PROC              @Z427VLS*/ 04146000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 04147000
*/*%INCLUDE SYSLIB  (COMTABLE)                                        * 04148000
*;                                                                 1499 04149000
@DATA    DS    0H                                                       04150000
@CH00392 DC    H'100'                                                   04151000
@CH01468 DC    H'384'                                                   04152000
@CH00868 DC    H'6000'                                                  04153000
         DS    0F                                                       04154000
@AL00266 DC    A(@CF00076+2)           LIST WITH   1 ARGUMENT(S)        04155000
@AL00297 EQU   *                       LIST WITH   1 ARGUMENT(S)        04156000
@AL00329 EQU   *                       LIST WITH   1 ARGUMENT(S)        04157000
@AL01334 DC    A(@CF00079+2)           LIST WITH   1 ARGUMENT(S)        04158000
@AL00324 EQU   *                       LIST WITH   1 ARGUMENT(S)        04159000
@AL01057 EQU   *                       LIST WITH   1 ARGUMENT(S)        04160000
@AL01074 DC    A(@CF00064+2)           LIST WITH   1 ARGUMENT(S)        04161000
@AL00520 EQU   *                       LIST WITH   1 ARGUMENT(S)        04162000
@AL00525 EQU   *                       LIST WITH   1 ARGUMENT(S)        04163000
@AL00550 DC    A(@CF00083+2)           LIST WITH   1 ARGUMENT(S)        04164000
@AL00533 DC    A(@CF01464)             LIST WITH   2 ARGUMENT(S)        04165000
         DC    A(@AFTEMPS)                                              04166000
@AL00541 DC    A(@CF00643)             LIST WITH   2 ARGUMENT(S)        04167000
         DC    A(@AFTEMPS)                                              04168000
@AL00553 DC    A(@CF01466)             LIST WITH   2 ARGUMENT(S)        04169000
         DC    A(@AFTEMPS)                                              04170000
@AL00561 DC    A(@CF01467)             LIST WITH   2 ARGUMENT(S)        04171000
         DC    A(@AFTEMPS)                                              04172000
@AL00582 DC    A(@CF01469)             LIST WITH   2 ARGUMENT(S)        04173000
         DC    A(@AFTEMPS)                                              04174000
@AL00721 EQU   *                       LIST WITH   1 ARGUMENT(S)        04175000
@AL01436 DC    A(@CF00074+2)           LIST WITH   1 ARGUMENT(S)        04176000
@AL01052 EQU   *                       LIST WITH   1 ARGUMENT(S)        04177000
@AL01069 DC    A(@CF00081+2)           LIST WITH   1 ARGUMENT(S)        04178000
@AL01403 DC    A(@CF01594)             LIST WITH   2 ARGUMENT(S)        04179000
         DC    A(@AFTEMPS+4)                                            04180000
@AL01405 DC    A(@CF01595)             LIST WITH   2 ARGUMENT(S)        04181000
         DC    A(@AFTEMPS+4)                                            04182000
@AL01410 DC    A(@CF00227)             LIST WITH   2 ARGUMENT(S)        04183000
         DC    A(@AFTEMPS+4)                                            04184000
@AL01419 DC    A(@CF01597)             LIST WITH   2 ARGUMENT(S)        04185000
         DC    A(@AFTEMPS+4)                                            04186000
@AL01430 EQU   *                       LIST WITH   2 ARGUMENT(S)        04187000
@AL01434 DC    A(@CF01598)             LIST WITH   2 ARGUMENT(S)        04188000
         DC    A(@AFTEMPS+4)                                            04189000
@AL01432 DC    A(@CF00079)             LIST WITH   2 ARGUMENT(S)        04190000
         DC    A(@AFTEMPS+4)                                            04191000
         DS    0F                                                       04192000
@SA00001 DS    18F                                                      04193000
@SA00032 DS    15F                                                      04194000
@SA00002 DS    15F                                                      04195000
@SA00031 DS    15F                                                      04196000
@SA00016 DS    15F                                                      04197000
@SA00008 DS    15F                                                      04198000
@SA00038 DS    15F                                                      04199000
@SA00003 DS    15F                                                      04200000
@SA00012 DS    15F                                                      04201000
@SA00004 DS    15F                                                      04202000
@SA00029 DS    15F                                                      04203000
@SA00011 DS    15F                                                      04204000
@SA00017 DS    15F                                                      04205000
@SA00009 DS    15F                                                      04206000
@SA00010 DS    15F                                                      04207000
@SA00014 DS    15F                                                      04208000
@SA00018 DS    15F                                                      04209000
@SA00019 DS    15F                                                      04210000
@SA00025 DS    15F                                                      04211000
@SA00022 DS    15F                                                      04212000
@SA00020 DS    15F                                                      04213000
@SA00021 DS    15F                                                      04214000
@SA00028 DS    15F                                                      04215000
@SA00033 DS    15F                                                      04216000
@SA00034 DS    15F                                                      04217000
@SA00035 DS    15F                                                      04218000
@SA00040 DS    15F                                                      04219000
@SA00039 DS    15F                                                      04220000
@TF00001 DS    F                                                        04221000
@TF00002 DS    F                                                        04222000
@AFTEMPS DS    2F                                                       04223000
         DS    0F                                                       04224000
@CF00055 DC    F'1'                                                     04225000
@CH00055 EQU   @CF00055+2                                               04226000
@CF00074 DC    F'2'                                                     04227000
@CH00074 EQU   @CF00074+2                                               04228000
@CF00076 DC    F'3'                                                     04229000
@CH00076 EQU   @CF00076+2                                               04230000
@CF00064 DC    F'4'                                                     04231000
@CH00064 EQU   @CF00064+2                                               04232000
@CF00079 DC    F'5'                                                     04233000
@CH00079 EQU   @CF00079+2                                               04234000
@CF00081 DC    F'6'                                                     04235000
@CH00081 EQU   @CF00081+2                                               04236000
@CF00083 DC    F'7'                                                     04237000
@CH00083 EQU   @CF00083+2                                               04238000
@CF00066 DC    F'8'                                                     04239000
@CF00035 DC    F'9'                                                     04240000
@CF00034 DC    F'10'                                                    04241000
@CH00034 EQU   @CF00034+2                                               04242000
@CF00033 DC    F'11'                                                    04243000
@CF00032 DC    F'12'                                                    04244000
@CF01286 DC    F'14'                                                    04245000
@CF00088 DC    F'16'                                                    04246000
@CF00227 DC    F'24'                                                    04247000
@CH00227 EQU   @CF00227+2                                               04248000
@CF01331 DC    F'27'                                                    04249000
@CF01470 DC    F'38'                                                    04250000
@CF01598 DC    F'40'                                                    04251000
@CF00293 DC    F'50'                                                    04252000
@CF01595 DC    F'53'                                                    04253000
@CF00643 DC    F'54'                                                    04254000
@CF01594 DC    F'55'                                                    04255000
@CF01466 DC    F'56'                                                    04256000
@CF01467 DC    F'57'                                                    04257000
@CF01439 DC    F'66'                                                    04258000
@CF01469 DC    F'73'                                                    04259000
@CF01597 DC    F'78'                                                    04260000
@CF01464 DC    F'83'                                                    04261000
@CF01610 DC    F'254'                                                   04262000
@CF00866 DC    F'360000'                                                04263000
@CF00864 DC    F'8640000'                                               04264000
@CF01618 DC    F'-20'                                                   04265000
@CF01636 DC    F'-17'                                                   04266000
@CF01632 DC    F'-15'                                                   04267000
@CF01633 DC    F'-10'                                                   04268000
@CF01634 DC    F'-9'                                                    04269000
@CF01624 DC    F'-7'                                                    04270000
@CF01625 DC    F'-6'                                                    04271000
@CF01635 DC    F'-5'                                                    04272000
@CF01620 DC    F'-4'                                                    04273000
@CF01621 DC    F'-3'                                                    04274000
         DS    0D                                                       04275000
SPCCOUNT DC    F'0'                                                     04276000
BYTECT   DC    F'0'                                                     04277000
EXCESSCT DC    F'0'                                                     04278000
BADTIME  DC    F'0'                                                     04279000
TERMTRY  DC    F'5'                                                     04280000
X        DC    F'0'                                                     04281000
M        DC    F'0'                                                     04282000
P        DC    F'0'                                                     04283000
L        DC    F'0'                                                     04284000
TEMPSAVE DC    A(0)                                                     04285000
NUMBER   DC    F'0'                                                     04286000
RTYP1    DC    F'0'                                                     04287000
OUTTHIRD DC    F'0'                                                     04288000
OUTTIME  DC    F'0'                                                     04289000
OUTDATE  DC    F'0'                                                     04290000
NUMBER1  DC    F'1'                                                     04291000
TWOEIGHT DC    F'28'                                                    04292000
NEXTBY   DC    F'0'                                                     04293000
ADDNXT   DC    F'0'                                                     04294000
BINWORD  DC    F'0'                                                     04295000
BNDECNUM DC    F'6'                                                     04296000
DECADDR  DC    F'0'                                                     04297000
SRTCONT  DC    F'0'                                                     04298000
FLIPFLOP DC    F'0'                                                     04299000
TRUNCT   DC    F'0'                                                     04300000
LISTPTR  DC    A(0)                                                     04301000
Y        DC    A(0)                                                     04302000
Z        DC    A(0)                                                     04303000
CCHINDX  DC    A(0)                                                     04304000
TEMP11   DC    F'0'                                                     04305000
FRINDEX  DC    F'0'                                                     04306000
BUILDCT  DC    F'0'                                                     04307000
LASTCT   DC    F'0'                                                     04308000
EVPTR1   DC    F'0'                                                     04309000
A        DC    F'0'                                                     04310000
YY1      DC    F'0'                                                     04311000
Q        DC    F'0'                                                     04312000
TEMP     DC    F'0'                                                     04313000
VOLFLAG  DC    H'0'                                                     04314000
OBRFLAG  DC    H'0'                                                     04315000
VOLTRY   DC    H'13'                                                    04316000
CPUTRY   DC    H'10'                                                    04317000
SAVESEQ  DC    H'0'                                                     04318000
         DS    0D                                                       04319000
@TS00001 DS    CL8                                                      04320000
@CC01004 DC    C'        '                                              04321000
@CB01577 DC    X'0000000000000000'                                      04322000
@CB01037 DC    X'000FF0'                                                04323000
@CB01043 DC    X'000FFF'                                                04324000
@CB00208 EQU   @CB01577                                                 04325000
@CB01007 DC    X'2006'                                                  04326000
@CB01009 DC    X'2007'                                                  04327000
@CB01039 DC    X'0FF0'                                                  04328000
@CB01041 DC    X'0FFF'                                                  04329000
@CB01061 EQU   @CB01037                                                 04330000
@CB01447 DC    X'0844'                                                  04331000
@CB01448 DC    X'0843'                                                  04332000
DROP     DC    CL16' RECORDS DROPPED'                                   04333000
BUGS16   DC    CL31'DEBUG16 - FILTERING INFORMATION'                    04334000
NEWFILT  DC    CL132' '                                                 04335000
         ORG   NEWFILT                                                  04336000
CPUDATA  DS    CL41                                                     04337000
         ORG   CPUDATA                                                  04338000
CPUIN1   DS    CL6                                                      04339000
@NM00084 DS    CL1                                                      04340000
CPUR     DS    CL3                                                      04341000
@NM00085 DS    CL1                                                      04342000
@NM00086 DC    CL12' FAILED CPU '                                       04343000
CPUOUT1  DS    CL6                                                      04344000
@NM00087 DC    CL12' PASSED,    '                                       04345000
         ORG   NEWFILT+41                                               04346000
VOLDATA  DS    CL49                                                     04347000
         ORG   VOLDATA                                                  04348000
VOLIN    DS    CL6                                                      04349000
@NM00088 DC    CL17' VOLID FOUND FOR '                                  04350000
VOLTYPE  DS    CL8                                                      04351000
@NM00089 DC    CL12' # SAVED IS '                                       04352000
VOLOUT   DS    CL6                                                      04353000
         ORG   NEWFILT+90                                               04354000
TERMDATA DS    CL41                                                     04355000
         ORG   TERMDATA                                                 04356000
TERMIN   DS    CL6                                                      04357000
@NM00090 DC    CL6' TYPE '                                              04358000
TERMTYP  DS    CL2                                                      04359000
@NM00091 DC    CL16' TERMINAL FOUND '                                   04360000
TERMOUT  DS    CL6                                                      04361000
@NM00092 DC    CL5' KEPT'                                               04362000
         ORG   NEWFILT+132                                              04363000
NOVOLOT  DC    CL32' '                                                  04364000
         ORG   NOVOLOT                                                  04365000
NUMNOVOL DS    CL6                                                      04366000
@NM00093 DS    CL1                                                      04367000
RHERE    DS    CL3                                                      04368000
@NM00094 DC    CL22' DID NOT HAVE A VOLUME'                             04369000
         ORG   NOVOLOT+32                                               04370000
RECINFO  DS    CL132                                                    04371000
         ORG   RECINFO                                                  04372000
RECNUM   DS    CL6                                                      04373000
@NM00095 DC    CL1' '                                                   04374000
RECTYP2  DS    CL3                                                      04375000
@NM00096 DC    CL1' '                                                   04376000
@NM00097 DC    CL16' RECORDS READ,  '                                   04377000
RECPASS  DS    CL6                                                      04378000
@NM00098 DC    CL2'  '                                                  04379000
@NM00099 DC    CL20'PASSED TIME FILTER, '                               04380000
CUAPASS  DS    CL6                                                      04381000
@NM00100 DC    CL2'  '                                                  04382000
@NM00101 DC    CL20'FAILED CUA  FILTER, '                               04383000
DEVPASS  DS    CL6                                                      04384000
@NM00102 DC    CL2'  '                                                  04385000
@NM00103 DC    CL21'FAILED DEV FILTERING '                              04386000
TYPEFAIL DS    CL6                                                      04387000
@NM00104 DC    CL2'  '                                                  04388000
@NM00105 DC    CL12' FAILED TYPE'                                       04389000
         ORG   RECINFO+132                                              04390000
RECINFO1 DC    CL61' '                                                  04391000
         ORG   RECINFO1                                                 04392000
EXCPU    DS    CL6                                                      04393000
@NM00106 DC    CL2'  '                                                  04394000
@NM00107 DC    CL20'FAILED EXCESS CPUS, '                               04395000
RECKEPT  DC    CL6' '                                                   04396000
@NM00108 DC    CL2'  '                                                  04397000
PTYP     DC    CL3'   '                                                 04398000
@NM00109 DC    CL1' '                                                   04399000
@NM00110 DC    CL21' PASSED ALL FILTERING'                              04400000
         ORG   RECINFO1+61                                              04401000
         DS    CL2                                                      04402000
FILT1ITM DS    CL68                                                     04403000
         ORG   FILT1ITM                                                 04404000
MAXENT   DC    F'0'                                                     04405000
EXCESS   DC    F'0'                                                     04406000
CORSIZE  DC    A(0)                                                     04407000
ERROR    DC    F'0'                                                     04408000
FREEADR  DC    A(0)                                                     04409000
I        DC    A(1)                                                     04410000
J        DC    A(0)                                                     04411000
K        DC    A(0)                                                     04412000
WHATYPE  DC    F'0'                                                     04413000
PACKPAS  DC    CL4'    '                                                04414000
CHARPAS  DC    CL8'        '                                            04415000
PASSNUM  DC    F'0'                                                     04416000
NUMREC   DC    F'0'                                                     04417000
WORKDEV  DC    X'0000'                                                  04418000
WORKCUA  DC    X'000000'                                                04419000
         ORG   WORKCUA                                                  04420000
WORKCU   DS    CL1                                                      04421000
WORKMOD  DS    CL2                                                      04422000
         ORG   FILT1ITM+64                                              04423000
MSGNO    DC    F'0'                                                     04424000
         ORG   FILT1ITM+68                                              04425000
PRINTLIN DS    CL134                                                    04426000
         ORG   PRINTLIN                                                 04427000
PRINTDS  DC    X'F1'                                                    04428000
PRINTCC  DC    X'40'                                                    04429000
PRINTBDY DC    CL132' '                                                 04430000
         ORG   PRINTLIN+134                                             04431000
BITSWIT  DC    X'000000'                                                04432000
         ORG   BITSWIT                                                  04433000
NONBLANK DS    BL1                                                      04434000
SORTSW   EQU   BITSWIT+0                                                04435000
CUAOK    EQU   BITSWIT+0                                                04436000
LOOPOUT  EQU   BITSWIT+0                                                04437000
GETOUT   EQU   BITSWIT+0                                                04438000
ONETIME  EQU   BITSWIT+0                                                04439000
ISMERD   EQU   BITSWIT+0                                                04440000
FRAMEYES EQU   BITSWIT+0                                                04441000
NOMESAGE DS    BL1                                                      04442000
SWITCH1  EQU   BITSWIT+1                                                04443000
DEVOK    EQU   BITSWIT+1                                                04444000
EVFLAG   EQU   BITSWIT+1                                                04445000
ONBOUND  EQU   BITSWIT+1                                                04446000
CPUEXCES EQU   BITSWIT+1                                                04447000
ODDREC   EQU   BITSWIT+1                                                04448000
VOLOK    EQU   BITSWIT+1                                                04449000
TERMOK   DS    BL1                                                      04450000
LIBOK    EQU   BITSWIT+2                                                04451000
CPUOK    EQU   BITSWIT+2                                                04452000
FIRSTIME EQU   BITSWIT+2                                                04453000
NOTYPECT EQU   BITSWIT+2                                                04454000
BADREC   EQU   BITSWIT+2                                                04455000
WEAREFIN EQU   BITSWIT+2                                                04456000
         ORG   BITSWIT+3                                                04457000
VOLCOMP  DC    CL6' '                                                   04458000
BUG38    DC    CL51'DEBUG38 - HEX DUMP OF RECORD(S) THAT FAIL FILTERINGC04459000
               '                                                        04460000
BUG42    DC    CL65'DEBUG42 - PROCESSING INPUT DATA STOPPED PRIOR TO EOC04461000
               F AS REQUESTED'                                          04462000
         DS    CL1                                                      04463000
WORK     DS    CL8                                                      04464000
EXCESCPU DS    CL16                                                     04465000
         ORG   EXCESCPU                                                 04466000
@NM00111 DS    CL8                                                      04467000
CT       DC    CL8'        '                                            04468000
         ORG   EXCESCPU+16                                              04469000
MCF      DC    CL131' '                                                 04470000
         ORG   MCF                                                      04471000
MCFNUMB  DS    CL6                                                      04472000
@NM00112 DC    CL10' MCF READ '                                         04473000
MCFNOMCH DS    CL6                                                      04474000
@NM00113 DC    CL21' NO MATCHING MCH REC'                               04475000
MCFDUP   DS    CL6                                                      04476000
@NM00114 DC    CL22' DUPLICAT FRAME SETS '                              04477000
MCFREJ   DS    CL6                                                      04478000
@NM00115 DC    CL20' MCF FRAMES REJECTED'                               04479000
MCFKEPT  DS    CL6                                                      04480000
@NM00116 DC    CL12' FRAMES KEPT'                                       04481000
MFACCDEV DS    CL6                                                      04482000
@NM00117 DC    CL10' TO ACCDEV'                                         04483000
         ORG   MCF+131                                                  04484000
CCF      DC    CL131' '                                                 04485000
         ORG   CCF                                                      04486000
CCFNUMB  DS    CL6                                                      04487000
@NM00118 DC    CL10' CCF READ '                                         04488000
CCFNOCCH DS    CL6                                                      04489000
@NM00119 DC    CL21'                    '                               04490000
CCFDUP   DS    CL6                                                      04491000
@NM00120 DC    CL22'                     '                              04492000
CCFREJ   DS    CL6                                                      04493000
@NM00121 DC    CL20' CCF FRAMES REJECTED'                               04494000
CCFKEPT  DS    CL6                                                      04495000
@NM00122 DC    CL12' FRAMES KEPT'                                       04496000
CFACCDEV DS    CL6                                                      04497000
@NM00123 DC    CL10' TO ACCDEV'                                         04498000
         ORG   CCF+131                                                  04499000
FFSETS   DS    CL37                                                     04500000
         ORG   FFSETS                                                   04501000
FFNUMD   DS    CL6                                                      04502000
@NM00124 DC    CL31'  NUMBER OF COMPLETE FRAME SETS'                    04503000
         ORG   FFSETS+37                                                04504000
GETSOK   DC    CL38' '                                                  04505000
         ORG   GETSOK                                                   04506000
GETNUM   DS    CL6                                                      04507000
@NM00125 DC    CL32'  SUCCESSFUL SUBPOOL 21 GETMAINS'                   04508000
         ORG   GETSOK+38                                                04509000
EXTRACT  DC    CL49' '                                                  04510000
         ORG   EXTRACT                                                  04511000
BUILDNUM DS    CL6                                                      04512000
@NM00126 DC    CL18'  BUILDTTR ENTRIES'                                 04513000
LASTCTS  DS    CL6                                                      04514000
@NM00127 DC    CL19'  LAST FRAMES FOUND'                                04515000
         ORG   EXTRACT+49                                               04516000
BUG48    DC    CL33'DEBUG48 -  HEXDUMP OF FRAME TABLE'                  04517000
CHARS    DC    CL16'0123456789ABCDEF'                                   04518000
BYTES1   DS    CL22                                                     04519000
         ORG   BYTES1                                                   04520000
BYTCT    DS    CL8                                                      04521000
@NM00128 DC    CL14'  # BYTES READ'                                     04522000
         ORG   BYTES1+22                                                04523000
RECCT    DS    CL66                                                     04524000
         ORG   RECCT                                                    04525000
RECCTS   DC    CL6'      '                                              04526000
NAME     DC    CL3'   '                                                 04527000
@NM00129 DC    CL13'RECORDS READ'                                       04528000
@NM00130 DC    CL44'RECORDS DROPPED DO TO EXCESS NUMBER OF CPUS'        04529000
         ORG   RECCT+66                                                 04530000
TIMEMSG  DS    CL87                                                     04531000
         ORG   TIMEMSG                                                  04532000
DAYFAIL  DS    CL6                                                      04533000
@NM00131 DC    CL2'  '                                                  04534000
@NM00132 DC    CL16'OUT OF DAY RANGE'                                   04535000
@NM00133 DC    CL2'  '                                                  04536000
TIMEFAIL DS    CL6                                                      04537000
@NM00134 DC    CL2'  '                                                  04538000
@NM00135 DC    CL17'OUT OF TIME RANGE'                                  04539000
@NM00136 DC    CL2'  '                                                  04540000
THIRDROP DS    CL6                                                      04541000
@NM00137 DC    CL2'  '                                                  04542000
@NM00138 DC    CL26'DROPPED DUE TO THIRD SHIFT'                         04543000
         ORG   TIMEMSG+87                                               04544000
AVEBYTE  DS    CL27                                                     04545000
         ORG   AVEBYTE                                                  04546000
AVERAGE  DC    CL6'      '                                              04547000
@NM00139 DC    CL21' AVERAGE BYTES/RECORD'                              04548000
         ORG   AVEBYTE+27                                               04549000
ERR7816  DC    CL18' '                                                  04550000
         ORG   ERR7816                                                  04551000
@NM00143 DC    CL18'DEBUG16 FRAME SET '                                 04552000
         ORG   ERR7816+18                                               04553000
INCOMP   DC    CL10'INCOMPLETE'                                         04554000
REPLACED DC    CL8'REPLACED'                                            04555000
ZERO1    DC    X'0000000000'                                            04556000
BUG4     DC    CL9'DEBUG4 - '                                           04557000
         DS    CL1                                                      04558000
DBLWORD  DS    CL8                                                      04559000
SUPERZAP DC    3CL10'SUPERZAP'                                          04560000
         DS    CL2                                                      04561000
INCOUNT  DC    12F'0'                                                   04562000
MIDCOUNT DC    12F'0'                                                   04563000
OUTCOUNT DC    12F'0'                                                   04564000
CUACT    DC    12F'0'                                                   04565000
DEVCT    DC    12F'0'                                                   04566000
RDEPCT   DC    12F'0'                                                   04567000
EXCPUCT  DC    12F'0'                                                   04568000
TERMTYPE DC    3F'0'                                                    04569000
TERMKEPT DC    3F'0'                                                    04570000
VOLCOUNT DC    13F'0'                                                   04571000
VOLPASS  DC    11F'0'                                                   04572000
CPUIN    DC    16F'0'                                                   04573000
CPUOUT   DC    16F'0'                                                   04574000
LETTERS  DC    CL1'A'                                                   04575000
         DC    CL1'B'                                                   04576000
         DC    CL1'C'                                                   04577000
         DC    CL1'D'                                                   04578000
         DC    CL1'E'                                                   04579000
         DC    CL1'F'                                                   04580000
         DC    CL1'G'                                                   04581000
         DC    CL1'H'                                                   04582000
         DC    CL1'I'                                                   04583000
         DC    CL1'J'                                                   04584000
         DC    CL1'K'                                                   04585000
         DC    CL1'L'                                                   04586000
         DC    CL1'M'                                                   04587000
         DC    CL1'N'                                                   04588000
         DC    CL1'O'                                                   04589000
         DC    CL1'P'                                                   04590000
TRMTYPE  DC    CL2'36'                                                  04591000
         DC    CL2'32'                                                  04592000
         DC    CL2'34'                                                  04593000
VOLDEV   DC    CL8'MDR-DASD'                                            04594000
         DC    CL8'OBR-DASD'                                            04595000
         DC    CL8'OBR-TAPE'                                            04596000
         DC    CL8'DDR-REC '                                            04597000
         DS    CL2                                                      04598000
PATCH    DC    15F'0'                                                   04599000
RECNAME  DC    CL3'MCH'                                                 04600000
         DC    CL3'CCH'                                                 04601000
         DC    CL3'OBR'                                                 04602000
         DC    CL3'SFT'                                                 04603000
         DC    CL3'IPL'                                                 04604000
         DC    CL3'DDR'                                                 04605000
         DC    CL3'MIH'                                                 04606000
         DC    CL3'EOD'                                                 04607000
         DC    CL3'MDR'                                                 04608000
         DC    CL3'UKN'                                                 04609000
NEWCPUS  DS    CL2                                                      04610000
         ORG   NEWCPUS+0                                                04611000
NEWMOD   DS    CL2                                                      04612000
         ORG   NEWCPUS+6                                                04613000
NOMATCH  DC    2H'0'                                                    04614000
FRMREAD  DC    2H'0'                                                    04615000
DUPLICAT DC    2H'0'                                                    04616000
KEPT     DC    2H'0'                                                    04617000
TOACCDEV DC    2H'0'                                                    04618000
SETREJCT DC    2H'0'                                                    04619000
IFCFILT4 CSECT                                                          04620000
         DC    S(SUPERZAP)                                              04621000
IFCFILT4 CSECT                                                          04622000
          DC    S(PATCH)                                                04623000
IFCFILT4 CSECT                                                          04624000
MVCINS  MVC  R0(R0,R6),0(R4)                                            04625000
IFCFILT4 CSECT                                                          04626000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       04627000
@01      EQU   01                                                       04628000
@02      EQU   02                                                       04629000
@03      EQU   03                                                       04630000
@04      EQU   04                                                       04631000
@05      EQU   05                                                       04632000
@06      EQU   06                                                       04633000
@07      EQU   07                                                       04634000
@08      EQU   08                                                       04635000
@09      EQU   09                                                       04636000
@10      EQU   10                                                       04637000
@11      EQU   11                                                       04638000
@12      EQU   12                                                       04639000
@13      EQU   13                                                       04640000
@14      EQU   14                                                       04641000
@15      EQU   15                                                       04642000
R2       EQU   @02                                                      04643000
R7       EQU   @07                                                      04644000
R0       EQU   @00                                                      04645000
R1       EQU   @01                                                      04646000
R4       EQU   @04                                                      04647000
R5       EQU   @05                                                      04648000
R6       EQU   @06                                                      04649000
R12      EQU   @12                                                      04650000
R15      EQU   @15                                                      04651000
R10      EQU   @10                                                      04652000
R11      EQU   @11                                                      04653000
R13      EQU   @13                                                      04654000
R14      EQU   @14                                                      04655000
R3       EQU   @03                                                      04656000
R8       EQU   @08                                                      04657000
R9       EQU   @09                                                      04658000
IOHND    EQU   0                                                        04659000
IFCMSG   EQU   0                                                        04660000
PARM     EQU   0                                                        04661000
RECTYPE  EQU   PARM                                                     04662000
PMCH     EQU   RECTYPE                                                  04663000
PCHAN    EQU   RECTYPE                                                  04664000
POBR     EQU   RECTYPE                                                  04665000
PSOFT    EQU   RECTYPE                                                  04666000
PIPL     EQU   RECTYPE                                                  04667000
PDDR     EQU   RECTYPE                                                  04668000
PMIH     EQU   RECTYPE                                                  04669000
PEOD     EQU   RECTYPE                                                  04670000
PTTYP    EQU   RECTYPE+1                                                04671000
SWITCHES EQU   PARM+2                                                   04672000
ZEROALL  EQU   SWITCHES+1                                               04673000
DEVEXCL  EQU   SWITCHES+1                                               04674000
SHIFT3RD EQU   SWITCHES+1                                               04675000
DEBUG    EQU   PARM+4                                                   04676000
DEBUG4   EQU   DEBUG                                                    04677000
DEBUG11  EQU   DEBUG+1                                                  04678000
DEBUG16  EQU   DEBUG+2                                                  04679000
DEBUG23  EQU   DEBUG+2                                                  04680000
DEBUGA   EQU   PARM+8                                                   04681000
DEBUG38  EQU   DEBUGA                                                   04682000
DEBUG46  EQU   DEBUGA+1                                                 04683000
DEBUG47  EQU   DEBUGA+1                                                 04684000
DEBUG48  EQU   DEBUGA+2                                                 04685000
MISC     EQU   PARM+12                                                  04686000
PACC     EQU   MISC                                                     04687000
PHIST    EQU   MISC                                                     04688000
PRINTES  EQU   MISC                                                     04689000
PASSFLAG EQU   MISC                                                     04690000
OPENCLSE EQU   PARM+13                                                  04691000
OPENIO   EQU   OPENCLSE                                                 04692000
CLOSEIO  EQU   OPENCLSE+2                                               04693000
CACCIN   EQU   CLOSEIO                                                  04694000
CACCDEV  EQU   CLOSEIO                                                  04695000
CDRCTWRK EQU   CLOSEIO                                                  04696000
DATENOW  EQU   PARM+17                                                  04697000
STDT     EQU   PARM+23                                                  04698000
STDATE   EQU   STDT                                                     04699000
PSTD     EQU   STDATE+1                                                 04700000
ENDDT    EQU   PARM+31                                                  04701000
ENDDATE  EQU   ENDDT                                                    04702000
PEND     EQU   ENDDATE+1                                                04703000
STTIME1  EQU   PARM+39                                                  04704000
ENDTIME1 EQU   PARM+43                                                  04705000
STTIME2  EQU   PARM+47                                                  04706000
ENDTIME2 EQU   PARM+51                                                  04707000
STRTDATE EQU   PARM+55                                                  04708000
TERM     EQU   PARM+58                                                  04709000
@NM00007 EQU   PARM+75                                                  04710000
TABSIZE  EQU   PARM+80                                                  04711000
SORTNUM  EQU   PARM+84                                                  04712000
ERRID    EQU   PARM+92                                                  04713000
IDTIMEA  EQU   ERRID+6                                                  04714000
IDTIME   EQU   IDTIMEA                                                  04715000
CCHHRLNG EQU   PARM+112                                                 04716000
RECCCHHR EQU   CCHHRLNG                                                 04717000
RECLNGTH EQU   CCHHRLNG+6                                               04718000
ADIOHND  EQU   PARM+124                                                 04719000
ADIFCMSG EQU   PARM+128                                                 04720000
ADEDITB  EQU   PARM+132                                                 04721000
EVPTR    EQU   PARM+136                                                 04722000
SORTADR  EQU   PARM+140                                                 04723000
PRINTADR EQU   PARM+148                                                 04724000
CUAPTR   EQU   PARM+152                                                 04725000
DEVPTR   EQU   PARM+156                                                 04726000
MODPTR   EQU   PARM+160                                                 04727000
SERPTR   EQU   PARM+164                                                 04728000
VOLPTR   EQU   PARM+168                                                 04729000
CPUPTR   EQU   PARM+172                                                 04730000
CPCUAPTR EQU   PARM+176                                                 04731000
LIBADPTR EQU   PARM+180                                                 04732000
SYMCDPTR EQU   PARM+184                                                 04733000
SYSUMPTR EQU   PARM+188                                                 04734000
TRENPTR  EQU   PARM+192                                                 04735000
SHAREPTR EQU   PARM+196                                                 04736000
FRAMEPTR EQU   PARM+200                                                 04737000
MERDCPTR EQU   PARM+208                                                 04738000
DUMPTABL EQU   PARM+228                                                 04739000
DUMPINFO EQU   DUMPTABL+4                                               04740000
TRENDONE EQU   0                                                        04741000
TREGEN   EQU   TRENDONE+8                                               04742000
EVTABLE  EQU   0                                                        04743000
EVSTOP   EQU   EVTABLE                                                  04744000
EVNUM    EQU   EVTABLE+4                                                04745000
EVKEY    EQU   EVTABLE+6                                                04746000
EVMODEL  EQU   EVKEY                                                    04747000
EVSERIAL EQU   EVKEY+2                                                  04748000
EVLETTER EQU   EVKEY+5                                                  04749000
SORTABLE EQU   0                                                        04750000
SORTKEY  EQU   SORTABLE                                                 04751000
SORTYEAR EQU   SORTKEY                                                  04752000
SORTTIME EQU   SORTKEY+1                                                04753000
SORTCCHR EQU   SORTABLE+5                                               04754000
SYSUMONE EQU   0                                                        04755000
SHARE    EQU   0                                                        04756000
SHAREIO  EQU   SHARE+2                                                  04757000
SHRCUCPU EQU   SHAREIO                                                  04758000
SHARECUA EQU   SHRCUCPU                                                 04759000
EDITLOAD EQU   0                                                        04760000
EDITABLE EQU   EDITLOAD+4                                               04761000
CUA      EQU   0                                                        04762000
CUANUM   EQU   CUA                                                      04763000
CUAVAL   EQU   CUA+2                                                    04764000
CUA1     EQU   CUAVAL                                                   04765000
CUA2     EQU   CUAVAL+2                                                 04766000
DEVICE   EQU   0                                                        04767000
DEVNUM   EQU   DEVICE                                                   04768000
DEVVAL   EQU   DEVICE+2                                                 04769000
MDRNUM   EQU   DEVICE+202                                               04770000
MDRVAL   EQU   DEVICE+204                                               04771000
MODELS   EQU   0                                                        04772000
DEVSERAL EQU   0                                                        04773000
VOLUME   EQU   0                                                        04774000
VOLNUM   EQU   VOLUME                                                   04775000
VOLVAL   EQU   VOLUME+2                                                 04776000
CPUS     EQU   0                                                        04777000
CPUNUM   EQU   CPUS                                                     04778000
CPUVAL   EQU   CPUS+2                                                   04779000
CPUCUAS  EQU   0                                                        04780000
CPUCUAV  EQU   CPUCUAS+2                                                04781000
LIBADR   EQU   0                                                        04782000
SYMCODE  EQU   0                                                        04783000
SYMVAL   EQU   SYMCODE+2                                                04784000
TMT2     EQU   0                                                        04785000
TMTKEY   EQU   TMT2                                                     04786000
TMTSRT   EQU   TMTKEY+1                                                 04787000
TMTCPUS  EQU   TMTKEY+3                                                 04788000
TMTITEM  EQU   TMTKEY+4                                                 04789000
TMTPERM1 EQU   TMT2+8                                                   04790000
TMP2     EQU   0                                                        04791000
TMPKEY   EQU   TMP2                                                     04792000
TMPSRT   EQU   TMPKEY+1                                                 04793000
TMPCPUS  EQU   TMPKEY+3                                                 04794000
TMPITEM  EQU   TMPKEY+4                                                 04795000
TMPPERM1 EQU   TMP2+7                                                   04796000
MERIDIAN EQU   0                                                        04797000
MRDNUMBR EQU   MERIDIAN                                                 04798000
MODEL    EQU   MERIDIAN+2                                               04799000
LRTREC   EQU   0                                                        04800000
LRTKEY   EQU   LRTREC                                                   04801000
LRTKEY1  EQU   LRTKEY                                                   04802000
LRTSMS   EQU   LRTREC+2                                                 04803000
LRTNLAST EQU   LRTSMS                                                   04804000
LRTRUNC  EQU   LRTSMS                                                   04805000
LRTERRID EQU   LRTREC+3                                                 04806000
@NM00017 EQU   LRTREC+4                                                 04807000
LRTCNT   EQU   @NM00017+2                                               04808000
LRTDT    EQU   LRTREC+8                                                 04809000
LRTDATE  EQU   LRTDT                                                    04810000
LRTYRDAY EQU   LRTDATE+1                                                04811000
LRTYEAR  EQU   LRTYRDAY                                                 04812000
LRTDAY   EQU   LRTYRDAY+1                                               04813000
LRTTIME  EQU   LRTDT+4                                                  04814000
LRTHOUR  EQU   LRTTIME                                                  04815000
LRTMIN   EQU   LRTTIME+1                                                04816000
LRTSEC   EQU   LRTTIME+2                                                04817000
LRTHSECS EQU   LRTTIME+3                                                04818000
LRTCPU   EQU   LRTREC+16                                                04819000
LRTCPMOD EQU   LRTCPU+1                                                 04820000
LRTCPUS  EQU   LRTCPMOD                                                 04821000
LRTMODEL EQU   LRTCPMOD+3                                               04822000
MCHREC   EQU   0                                                        04823000
MCHHEAD  EQU   MCHREC                                                   04824000
MCHKEY   EQU   MCHHEAD                                                  04825000
MCHSMS   EQU   MCHHEAD+2                                                04826000
MCHCPUID EQU   MCHHEAD+16                                               04827000
CCHREC   EQU   0                                                        04828000
CCHHEAD  EQU   CCHREC                                                   04829000
CCHKEY   EQU   CCHHEAD                                                  04830000
CCHSMS   EQU   CCHHEAD+2                                                04831000
CCHCPUID EQU   CCHHEAD+16                                               04832000
CCHCODE  EQU   CCHREC+68                                                04833000
CCHCODE2 EQU   CCHCODE+2                                                04834000
CCHCUA   EQU   CCHREC+74                                                04835000
OBRREC   EQU   0                                                        04836000
OBRHEAD  EQU   OBRREC                                                   04837000
OBRKEY   EQU   OBRHEAD                                                  04838000
OBRSMS   EQU   OBRHEAD+2                                                04839000
MISCSW   EQU   OBRSMS                                                   04840000
OBRSUBTP EQU   OBRSMS+1                                                 04841000
SHORTSW  EQU   OBRSUBTP                                                 04842000
OBRCPUID EQU   OBRHEAD+16                                               04843000
OBRJOBID EQU   OBRREC+24                                                04844000
OBRSDEV2 EQU   OBRJOBID+2                                               04845000
OBRSCUA  EQU   OBRJOBID+5                                               04846000
OBRFCCW  EQU   OBRREC+32                                                04847000
OBRSRDS  EQU   OBRFCCW                                                  04848000
OBRCSW   EQU   OBRREC+40                                                04849000
OBRCODE  EQU   OBRREC+52                                                04850000
OBRDEV   EQU   OBRCODE+2                                                04851000
OBRCLASS EQU   OBRDEV                                                   04852000
OBRPCUA  EQU   OBRREC+57                                                04853000
OBRVOL   EQU   OBRREC+64                                                04854000
OBRSEEK  EQU   OBRREC+70                                                04855000
OBRTCAM  EQU   OBRSEEK                                                  04856000
OBRTERMN EQU   OBRSEEK+2                                                04857000
SFTREC   EQU   0                                                        04858000
SFTHEAD  EQU   SFTREC                                                   04859000
SFTKEY   EQU   SFTHEAD                                                  04860000
SFTCPUID EQU   SFTHEAD+16                                               04861000
SFTSDWA  EQU   SFTREC+32                                                04862000
SFTAEC1  EQU   SFTSDWA+96                                               04863000
SFTFLGS  EQU   SFTSDWA+232                                              04864000
SFTRECP  EQU   SFTSDWA+292                                              04865000
IPLREC   EQU   0                                                        04866000
IPLHEAD  EQU   IPLREC                                                   04867000
IPLKEY   EQU   IPLHEAD                                                  04868000
IPLCPUID EQU   IPLHEAD+16                                               04869000
IPLSTIME EQU   IPLREC+52                                                04870000
DDRREC   EQU   0                                                        04871000
DDRHEAD  EQU   DDRREC                                                   04872000
DDRKEY   EQU   DDRHEAD                                                  04873000
DDRSMS   EQU   DDRHEAD+2                                                04874000
DDRCPUID EQU   DDRHEAD+16                                               04875000
@NM00052 EQU   DDRREC+24                                                04876000
DDRVOL1  EQU   @NM00052+8                                               04877000
DDRVOL2  EQU   @NM00052+14                                              04878000
DDRFCUA  EQU   DDRREC+45                                                04879000
DDRFDEV  EQU   DDRREC+48                                                04880000
DDRCODE2 EQU   DDRFDEV+2                                                04881000
DDRTODEV EQU   DDRREC+56                                                04882000
MIHREC   EQU   0                                                        04883000
MIHHEAD  EQU   MIHREC                                                   04884000
MIHKEY   EQU   MIHHEAD                                                  04885000
@NM00054 EQU   MIHHEAD+4                                                04886000
MIHCPUID EQU   MIHHEAD+16                                               04887000
@NM00057 EQU   MIHREC+24                                                04888000
MIHCUA   EQU   MIHREC+35                                                04889000
MIHDEV   EQU   MIHREC+44                                                04890000
MIHCODE2 EQU   MIHDEV+2                                                 04891000
EODREC   EQU   0                                                        04892000
EODHEAD  EQU   EODREC                                                   04893000
EODKEY   EQU   EODHEAD                                                  04894000
EODCPUID EQU   EODHEAD+16                                               04895000
TPRREC   EQU   0                                                        04896000
TPRHEAD  EQU   TPRREC                                                   04897000
TPRKEY   EQU   TPRHEAD                                                  04898000
TPRDEV   EQU   TPRHEAD+4                                                04899000
TPRBUFC  EQU   TPRHEAD+5                                                04900000
TPRCPUID EQU   TPRHEAD+16                                               04901000
TPRCUA   EQU   TPRREC+24                                                04902000
@NM00065 EQU   TPRREC+26                                                04903000
TPRVOL   EQU   @NM00065                                                 04904000
MCFREC   EQU   0                                                        04905000
MCFHEAD  EQU   MCFREC                                                   04906000
MCFKEY   EQU   MCFHEAD                                                  04907000
MCFSMS   EQU   MCFHEAD+2                                                04908000
@NM00073 EQU   MCFHEAD+16                                               04909000
MCFSMO   EQU   MCFHEAD+17                                               04910000
CCFREC   EQU   0                                                        04911000
CCFHEAD  EQU   CCFREC                                                   04912000
CCFKEY   EQU   CCFHEAD                                                  04913000
CCFSMS   EQU   CCFHEAD+2                                                04914000
@NM00081 EQU   CCFHEAD+16                                               04915000
CCFSMO   EQU   CCFHEAD+17                                               04916000
NEXTBYTE EQU   0                                                        04917000
ADDNUM   EQU   0                                                        04918000
FRAMETAB EQU   0                                                        04919000
FRAMENUM EQU   FRAMETAB                                                 04920000
FRAMEDTA EQU   FRAMETAB+4                                               04921000
FRAMEKEY EQU   FRAMEDTA                                                 04922000
FRAMECPU EQU   FRAMEKEY                                                 04923000
FRAMESER EQU   FRAMECPU                                                 04924000
FRAMEMOD EQU   FRAMECPU+3                                               04925000
FRAMEDT  EQU   FRAMEKEY+5                                               04926000
FRAMETYP EQU   FRAMEKEY+13                                              04927000
FRAMLOCM EQU   FRAMEDTA+16                                              04928000
FRAMLOCC EQU   FRAMEDTA+20                                              04929000
LISTLOC  EQU   0                                                        04930000
LISTNUM  EQU   LISTLOC                                                  04931000
LISTCCHR EQU   LISTLOC+4                                                04932000
WORKOVER EQU   WORK                                                     04933000
EDIFILD  EQU   PRINTBDY+8                                               04934000
CT1      EQU   PRINTBDY+8                                               04935000
CT2      EQU   PRINTBDY+8                                               04936000
CTARRAY  EQU   CT                                                       04937000
ERR78    EQU   PRINTBDY                                                 04938000
PFRAMMOD EQU   ERR78+27                                                 04939000
PFRAMSER EQU   ERR78+32                                                 04940000
ERR78161 EQU   PRINTBDY+19                                              04941000
TYPERROR EQU   ERR78161                                                 04942000
ZFRAMMOD EQU   ERR78161+11                                              04943000
ZFRAMSER EQU   ERR78161+16                                              04944000
ZFRAMKEY EQU   ERR78161+24                                              04945000
YFRAMMOD EQU   ERR78161+58                                              04946000
YFRAMSER EQU   ERR78161+63                                              04947000
YFRAMKEY EQU   ERR78161+71                                              04948000
CHAR1    EQU   CHARS                                                    04949000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    04950000
@NM00149 EQU   ERR78161+69                                              04951000
@NM00148 EQU   ERR78161+62                                              04952000
@NM00147 EQU   ERR78161+52                                              04953000
@NM00146 EQU   ERR78161+22                                              04954000
@NM00145 EQU   ERR78161+15                                              04955000
@NM00144 EQU   ERR78161+10                                              04956000
PFRAMKEY EQU   ERR78+44                                                 04957000
@NM00142 EQU   ERR78+38                                                 04958000
@NM00141 EQU   ERR78+31                                                 04959000
@NM00140 EQU   ERR78                                                    04960000
FRAMETIM EQU   FRAMEDT+4                                                04961000
FRAMEDAT EQU   FRAMEDT                                                  04962000
CCFFRAME EQU   CCFREC+24                                                04963000
@NM00083 EQU   CCFHEAD+22                                               04964000
CCFMOD   EQU   CCFSMO+3                                                 04965000
CCFSER   EQU   CCFSMO                                                   04966000
CCFVER   EQU   @NM00081                                                 04967000
@NM00082 EQU   @NM00081                                                 04968000
CCFTIMD  EQU   CCFHEAD+12                                               04969000
CCFDAT   EQU   CCFHEAD+8                                                04970000
@NM00080 EQU   CCFHEAD+7                                                04971000
CCFCNT   EQU   CCFHEAD+6                                                04972000
@NM00079 EQU   CCFHEAD+4                                                04973000
@NM00078 EQU   CCFSMS+1                                                 04974000
CCFCPU   EQU   CCFSMS+1                                                 04975000
CCFMP    EQU   CCFSMS+1                                                 04976000
@NM00077 EQU   CCFSMS                                                   04977000
CCFTIM   EQU   CCFSMS                                                   04978000
@NM00076 EQU   CCFSMS                                                   04979000
CCFTRU   EQU   CCFSMS                                                   04980000
CCFTOD   EQU   CCFSMS                                                   04981000
CCFLST   EQU   CCFSMS                                                   04982000
CCFKEY2  EQU   CCFKEY+1                                                 04983000
CCFKEY1  EQU   CCFKEY                                                   04984000
MCFFRAME EQU   MCFREC+24                                                04985000
@NM00075 EQU   MCFHEAD+22                                               04986000
MCFMOD   EQU   MCFSMO+3                                                 04987000
MCFSER   EQU   MCFSMO                                                   04988000
MCFVER   EQU   @NM00073                                                 04989000
@NM00074 EQU   @NM00073                                                 04990000
MCFTIMD  EQU   MCFHEAD+12                                               04991000
MCFDAT   EQU   MCFHEAD+8                                                04992000
@NM00072 EQU   MCFHEAD+7                                                04993000
MCFCNT   EQU   MCFHEAD+6                                                04994000
@NM00071 EQU   MCFHEAD+4                                                04995000
@NM00070 EQU   MCFSMS+1                                                 04996000
MCFCPU   EQU   MCFSMS+1                                                 04997000
MCFMP    EQU   MCFSMS+1                                                 04998000
@NM00069 EQU   MCFSMS                                                   04999000
MCFTIM   EQU   MCFSMS                                                   05000000
@NM00068 EQU   MCFSMS                                                   05001000
MCFTRU   EQU   MCFSMS                                                   05002000
MCFTOD   EQU   MCFSMS                                                   05003000
MCFLST   EQU   MCFSMS                                                   05004000
MCFKEY2  EQU   MCFKEY+1                                                 05005000
MCFKEY1  EQU   MCFKEY                                                   05006000
DVBSDRE  EQU   TPRREC+56                                                05007000
@NM00067 EQU   TPRREC+39                                                05008000
TPRMODE  EQU   TPRREC+38                                                05009000
TPRLINAD EQU   TPRREC+36                                                05010000
@NM00066 EQU   TPRREC+34                                                05011000
TPRCEL   EQU   TPRCPUID+6                                               05012000
TPRMODEL EQU   TPRCPUID+4                                               05013000
TPRSER   EQU   TPRCPUID+1                                               05014000
@NM00064 EQU   TPRCPUID                                                 05015000
TPRTIME  EQU   TPRHEAD+12                                               05016000
TPRDATE  EQU   TPRHEAD+8                                                05017000
@NM00063 EQU   TPRHEAD+6                                                05018000
TPRLENGT EQU   TPRBUFC                                                  05019000
@NM00062 EQU   TPRBUFC                                                  05020000
TPRSMS   EQU   TPRHEAD+2                                                05021000
TPRKEY2  EQU   TPRKEY+1                                                 05022000
TPRKEY1  EQU   TPRKEY                                                   05023000
EODCEL   EQU   EODCPUID+6                                               05024000
EODMODEL EQU   EODCPUID+4                                               05025000
EODSER   EQU   EODCPUID+1                                               05026000
@NM00061 EQU   EODCPUID                                                 05027000
EODTIME  EQU   EODHEAD+12                                               05028000
EODDATE  EQU   EODHEAD+8                                                05029000
@NM00060 EQU   EODHEAD+5                                                05030000
EODDEV   EQU   EODHEAD+4                                                05031000
EODSMS   EQU   EODHEAD+2                                                05032000
EODKEY2  EQU   EODKEY+1                                                 05033000
EODKEY1  EQU   EODKEY                                                   05034000
MIHTYPE  EQU   MIHCODE2+1                                               05035000
MIHCLASS EQU   MIHCODE2                                                 05036000
@NM00059 EQU   MIHDEV                                                   05037000
MIHVOL   EQU   MIHREC+38                                                05038000
@NM00058 EQU   @NM00057+8                                               05039000
MIHJOBID EQU   @NM00057                                                 05040000
MIHCEL   EQU   MIHCPUID+6                                               05041000
MIHMOD   EQU   MIHCPUID+4                                               05042000
MIHSER   EQU   MIHCPUID+1                                               05043000
@NM00056 EQU   MIHCPUID                                                 05044000
MIHTIME  EQU   MIHHEAD+12                                               05045000
MIHDATE  EQU   MIHHEAD+8                                                05046000
@NM00055 EQU   MIHHEAD+6                                                05047000
MIHCSID  EQU   MIHHEAD+5                                                05048000
MIHDEBIT EQU   @NM00054                                                 05049000
MIHCEBIT EQU   @NM00054                                                 05050000
MIHSMS   EQU   MIHHEAD+2                                                05051000
MIHKEY2  EQU   MIHKEY+1                                                 05052000
MIHKEY1  EQU   MIHKEY                                                   05053000
DDRDEV2  EQU   DDRTODEV+2                                               05054000
DDRDEV1  EQU   DDRTODEV                                                 05055000
DDRTOCUA EQU   DDRREC+53                                                05056000
@NM00053 EQU   DDRREC+52                                                05057000
DDRTYPE  EQU   DDRCODE2+1                                               05058000
DDRCLASS EQU   DDRCODE2                                                 05059000
DDRCODE1 EQU   DDRFDEV                                                  05060000
DDRPHD   EQU   @NM00052+20                                              05061000
DDRJOBID EQU   @NM00052                                                 05062000
DDRCEL   EQU   DDRCPUID+6                                               05063000
DDRMOD   EQU   DDRCPUID+4                                               05064000
DDRSER   EQU   DDRCPUID+1                                               05065000
@NM00051 EQU   DDRCPUID                                                 05066000
DDRTIME  EQU   DDRHEAD+12                                               05067000
DDRDATE  EQU   DDRHEAD+8                                                05068000
@NM00050 EQU   DDRHEAD+4                                                05069000
DDRDEPSW EQU   DDRSMS+1                                                 05070000
@NM00049 EQU   DDRSMS                                                   05071000
DDRKEY2  EQU   DDRKEY+1                                                 05072000
DDRKEY1  EQU   DDRKEY                                                   05073000
IPLSHSEC EQU   IPLSTIME+3                                               05074000
IPLSSEC  EQU   IPLSTIME+2                                               05075000
IPLSMIN  EQU   IPLSTIME+1                                               05076000
IPLSHOUR EQU   IPLSTIME                                                 05077000
IPLSDATE EQU   IPLREC+48                                                05078000
IPLTEMP  EQU   IPLREC+46                                                05079000
IPLHIGH  EQU   IPLREC+42                                                05080000
IPLCHAN  EQU   IPLREC+32                                                05081000
@NM00048 EQU   IPLREC+30                                                05082000
IPLREAS  EQU   IPLREC+28                                                05083000
@NM00047 EQU   IPLREC+25                                                05084000
IPLSYSID EQU   IPLREC+24                                                05085000
IPLCEL   EQU   IPLCPUID+6                                               05086000
IPLMOD   EQU   IPLCPUID+4                                               05087000
IPLSER   EQU   IPLCPUID+1                                               05088000
@NM00046 EQU   IPLCPUID                                                 05089000
IPLTIME  EQU   IPLHEAD+12                                               05090000
IPLDATE  EQU   IPLHEAD+8                                                05091000
@NM00045 EQU   IPLHEAD+4                                                05092000
IPLSMS   EQU   IPLHEAD+2                                                05093000
IPLKEY2  EQU   IPLKEY+1                                                 05094000
IPLKEY1  EQU   IPLKEY                                                   05095000
SFTXDATA EQU   SFTREC+434                                               05096000
SFTLVARA EQU   SFTREC+432                                               05097000
SFTREXN  EQU   SFTRECP+16                                               05098000
SFTCSECT EQU   SFTRECP+8                                                05099000
SFTMODN  EQU   SFTRECP                                                  05100000
@NM00044 EQU   SFTSDWA+238                                              05101000
SFTLCPUA EQU   SFTSDWA+236                                              05102000
SFTERRD  EQU   SFTFLGS+3                                                05103000
SFTERRC  EQU   SFTFLGS+2                                                05104000
SFTERRB  EQU   SFTFLGS+1                                                05105000
SFTERRA  EQU   SFTFLGS                                                  05106000
@NM00043 EQU   SFTSDWA+136                                              05107000
SFTAAEC1 EQU   SFTSDWA+120                                              05108000
@NM00042 EQU   SFTSDWA+112                                              05109000
SFTPROGC EQU   SFTAEC1+8                                                05110000
@NM00041 EQU   SFTAEC1                                                  05111000
@NM00040 EQU   SFTSDWA+88                                               05112000
SFTGRSV  EQU   SFTSDWA+24                                               05113000
SFTABNDC EQU   SFTSDWA                                                  05114000
SFTJOBID EQU   SFTREC+24                                                05115000
SFTCEL   EQU   SFTCPUID+6                                               05116000
SFTMOD   EQU   SFTCPUID+4                                               05117000
SFTSER   EQU   SFTCPUID+1                                               05118000
@NM00039 EQU   SFTCPUID                                                 05119000
SFTTIME  EQU   SFTHEAD+12                                               05120000
SFTDATE  EQU   SFTHEAD+8                                                05121000
@NM00038 EQU   SFTHEAD+4                                                05122000
SFTSMS   EQU   SFTHEAD+2                                                05123000
SFTKEY2  EQU   SFTKEY+1                                                 05124000
SFTKEY1  EQU   SFTKEY                                                   05125000
OBR34CT2 EQU   OBRTERMN+5                                               05126000
OBR34CT1 EQU   OBRTERMN+4                                               05127000
@NM00037 EQU   OBRTERMN                                                 05128000
@NM00036 EQU   OBRSEEK+1                                                05129000
OBRSBCNT EQU   OBRREC+62                                                05130000
OBRRETRY EQU   OBRREC+60                                                05131000
OBRLSDRC EQU   OBRREC+56                                                05132000
OBRTYPE  EQU   OBRDEV+1                                                 05133000
OBRCODE1 EQU   OBRCODE                                                  05134000
OBRSECUA EQU   OBRREC+49                                                05135000
OBRDEVDC EQU   OBRREC+48                                                05136000
OBRSTAT  EQU   OBRCSW+4                                                 05137000
@NM00035 EQU   OBRCSW                                                   05138000
OBRSDRS2 EQU   OBRSRDS                                                  05139000
OBRSDRS1 EQU   OBRSRDS                                                  05140000
OBRSSDRC EQU   OBRJOBID+4                                               05141000
OBRSDEV1 EQU   OBRJOBID                                                 05142000
OBRCEL   EQU   OBRCPUID+6                                               05143000
OBRMOD   EQU   OBRCPUID+4                                               05144000
OBRSER   EQU   OBRCPUID+1                                               05145000
@NM00034 EQU   OBRCPUID                                                 05146000
OBRTIME  EQU   OBRHEAD+12                                               05147000
OBRDATE  EQU   OBRHEAD+8                                                05148000
@NM00033 EQU   OBRHEAD+4                                                05149000
@NM00032 EQU   OBRSUBTP                                                 05150000
DISMOUNT EQU   OBRSUBTP                                                 05151000
@NM00031 EQU   OBRSUBTP                                                 05152000
OBRTEMP  EQU   OBRSUBTP                                                 05153000
SDRCOUNT EQU   OBRSUBTP                                                 05154000
@NM00030 EQU   MISCSW                                                   05155000
TRUNC    EQU   MISCSW                                                   05156000
@NM00029 EQU   MISCSW                                                   05157000
OBRKEY2  EQU   OBRKEY+1                                                 05158000
OBRKEY1  EQU   OBRKEY                                                   05159000
CCHLOG   EQU   CCHREC+80                                                05160000
CCHMP    EQU   CCHREC+76                                                05161000
@NM00028 EQU   CCHREC+73                                                05162000
CCHID    EQU   CCHREC+72                                                05163000
CCHTYPE  EQU   CCHCODE2+1                                               05164000
CCHCLASS EQU   CCHCODE2                                                 05165000
CCHCODE1 EQU   CCHCODE                                                  05166000
CCHECSW  EQU   CCHREC+64                                                05167000
CCHCSW   EQU   CCHREC+56                                                05168000
CCHFCCW  EQU   CCHREC+48                                                05169000
CCHATIO  EQU   CCHREC+32                                                05170000
CCHJOBID EQU   CCHREC+24                                                05171000
CCHCEL   EQU   CCHCPUID+6                                               05172000
CCHMOD   EQU   CCHCPUID+4                                               05173000
CCHSER   EQU   CCHCPUID+1                                               05174000
@NM00027 EQU   CCHCPUID                                                 05175000
CCHTIME  EQU   CCHHEAD+12                                               05176000
CCHDATE  EQU   CCHHEAD+8                                                05177000
@NM00026 EQU   CCHHEAD+4                                                05178000
CCHRINC  EQU   CCHSMS+1                                                 05179000
@NM00025 EQU   CCHSMS                                                   05180000
CCHRCRH  EQU   CCHSMS                                                   05181000
@NM00024 EQU   CCHSMS                                                   05182000
CCHKEY2  EQU   CCHKEY+1                                                 05183000
CCHKEY1  EQU   CCHKEY                                                   05184000
MCHLOG   EQU   MCHREC+48                                                05185000
MCHOPSW  EQU   MCHREC+40                                                05186000
MCHJOBID EQU   MCHREC+32                                                05187000
MCHPGMID EQU   MCHREC+24                                                05188000
MCHCEL   EQU   MCHCPUID+6                                               05189000
MCHMOD   EQU   MCHCPUID+4                                               05190000
MCHSER   EQU   MCHCPUID+1                                               05191000
@NM00023 EQU   MCHCPUID                                                 05192000
MCHTIME  EQU   MCHHEAD+12                                               05193000
MCHDATE  EQU   MCHHEAD+8                                                05194000
@NM00022 EQU   MCHHEAD+4                                                05195000
MCHSYSTR EQU   MCHSMS+1                                                 05196000
@NM00021 EQU   MCHSMS                                                   05197000
MCHKEY2  EQU   MCHKEY+1                                                 05198000
MCHKEY1  EQU   MCHKEY                                                   05199000
LRTMCEL  EQU   LRTCPU+6                                                 05200000
@NM00020 EQU   LRTCPU                                                   05201000
LRTDATE0 EQU   LRTDATE                                                  05202000
@NM00019 EQU   @NM00017+3                                               05203000
@NM00018 EQU   @NM00017                                                 05204000
LRTDSMNT EQU   LRTERRID                                                 05205000
@NM00016 EQU   LRTERRID                                                 05206000
LRTSHRT  EQU   LRTERRID                                                 05207000
@NM00015 EQU   LRTERRID                                                 05208000
@NM00014 EQU   LRTSMS                                                   05209000
LRTIMCNV EQU   LRTSMS                                                   05210000
@NM00013 EQU   LRTSMS                                                   05211000
LRNS     EQU   LRTSMS                                                   05212000
LRTKEY2  EQU   LRTKEY+1                                                 05213000
TMPTEMP  EQU   TMP2+9                                                   05214000
TMPPERM  EQU   TMPPERM1+1                                               05215000
@NM00012 EQU   TMPPERM1                                                 05216000
TMPDEV   EQU   TMPKEY+5                                                 05217000
TMPOLDA  EQU   TMPITEM                                                  05218000
TMP3705  EQU   TMPITEM                                                  05219000
TMPOLD   EQU   TMPCPUS                                                  05220000
TMPCPU   EQU   TMPCPUS                                                  05221000
TMPCUA   EQU   TMPSRT                                                   05222000
TMPGROUP EQU   TMPKEY                                                   05223000
TMTTEMP  EQU   TMT2+10                                                  05224000
TMTPERM  EQU   TMTPERM1+1                                               05225000
@NM00011 EQU   TMTPERM1                                                 05226000
TMTDEV   EQU   TMTKEY+6                                                 05227000
TMTDAT   EQU   TMTKEY+5                                                 05228000
TMTOLDA  EQU   TMTITEM                                                  05229000
TMT3705  EQU   TMTITEM                                                  05230000
TMTOLD   EQU   TMTCPUS                                                  05231000
TMTCPU   EQU   TMTCPUS                                                  05232000
TMTCUA   EQU   TMTSRT                                                   05233000
TMTGROUP EQU   TMTKEY                                                   05234000
SYMVAL2  EQU   SYMVAL+2                                                 05235000
SYMVAL1  EQU   SYMVAL                                                   05236000
SYMCDNUM EQU   SYMCODE                                                  05237000
LIBVAL   EQU   LIBADR+2                                                 05238000
LIBADNUM EQU   LIBADR                                                   05239000
CPUCUX3  EQU   CPUCUAV+5                                                05240000
CPUCUX2  EQU   CPUCUAV+3                                                05241000
CPUCUX1  EQU   CPUCUAV                                                  05242000
CPCUANUM EQU   CPUCUAS                                                  05243000
SERVAL   EQU   DEVSERAL+2                                               05244000
SERNUM   EQU   DEVSERAL                                                 05245000
MODVAL   EQU   MODELS+2                                                 05246000
MODNUM   EQU   MODELS                                                   05247000
LOADPTR  EQU   EDITABLE+8                                               05248000
LOADNAME EQU   EDITABLE                                                 05249000
EDITNUM  EQU   EDITLOAD                                                 05250000
SHARLET  EQU   SHAREIO+10                                               05251000
SHARSERB EQU   SHAREIO+7                                                05252000
SHARECUB EQU   SHAREIO+5                                                05253000
SHARSERA EQU   SHRCUCPU+2                                               05254000
SHAREDX  EQU   SHARECUA                                                 05255000
SHARENUM EQU   SHARE                                                    05256000
SYSUMEOD EQU   SYSUMONE+96                                              05257000
SYSUMPER EQU   SYSUMONE+92                                              05258000
SYSUMPEA EQU   SYSUMONE+88                                              05259000
SYSUMPEI EQU   SYSUMONE+84                                              05260000
SYSUMCH  EQU   SYSUMONE+20                                              05261000
SYSUMMCN EQU   SYSUMONE+16                                              05262000
SYSUMMCR EQU   SYSUMONE+12                                              05263000
SYSUMNXT EQU   SYSUMONE+8                                               05264000
SYSUMIPL EQU   SYSUMONE+4                                               05265000
SYSUMNUM EQU   SYSUMONE                                                 05266000
SORTCORE EQU   SORTCCHR                                                 05267000
EVDAY    EQU   EVSTOP+1                                                 05268000
EVYEAR   EQU   EVSTOP                                                   05269000
TREPRE   EQU   TREGEN+72                                                05270000
TRECCHF  EQU   TREGEN+68                                                05271000
TRECCHE  EQU   TREGEN+64                                                05272000
TRECCHD  EQU   TREGEN+60                                                05273000
TRECCHC  EQU   TREGEN+56                                                05274000
TRECCHB  EQU   TREGEN+52                                                05275000
TRECCHA  EQU   TREGEN+48                                                05276000
TRECCH9  EQU   TREGEN+44                                                05277000
TRECCH8  EQU   TREGEN+40                                                05278000
TRECCH7  EQU   TREGEN+36                                                05279000
TRECCH6  EQU   TREGEN+32                                                05280000
TRECCH5  EQU   TREGEN+28                                                05281000
TRECCH4  EQU   TREGEN+24                                                05282000
TRECCH3  EQU   TREGEN+20                                                05283000
TRECCH2  EQU   TREGEN+16                                                05284000
TRECCH1  EQU   TREGEN+12                                                05285000
TRECCH0  EQU   TREGEN+8                                                 05286000
TREMCH   EQU   TREGEN+4                                                 05287000
TREIPL   EQU   TREGEN                                                   05288000
TRENUM   EQU   TRENDONE+4                                               05289000
TRENEXT  EQU   TRENDONE                                                 05290000
DUMPSIZE EQU   DUMPINFO+4                                               05291000
DUMPADR  EQU   DUMPINFO                                                 05292000
DUMPNUM  EQU   DUMPTABL                                                 05293000
@NM00010 EQU   PARM+212                                                 05294000
RECLNGT1 EQU   PARM+204                                                 05295000
ADCPUT   EQU   PARM+144                                                 05296000
LINECT   EQU   PARM+120                                                 05297000
@NM00009 EQU   CCHHRLNG+5                                               05298000
USERPGM  EQU   PARM+102                                                 05299000
IDTSEC   EQU   IDTIME+3                                                 05300000
IDSEC    EQU   IDTIME+2                                                 05301000
IDMIN    EQU   IDTIME+1                                                 05302000
IDHOUR   EQU   IDTIME                                                   05303000
IDASID   EQU   ERRID+4                                                  05304000
IDCPU    EQU   ERRID+3                                                  05305000
@NM00008 EQU   ERRID+2                                                  05306000
IDVALUE  EQU   ERRID                                                    05307000
NUMDAYS  EQU   PARM+88                                                  05308000
SYSRETRN EQU   @NM00007                                                 05309000
@NM00006 EQU   PARM+72                                                  05310000
WRTHRSH  EQU   PARM+69                                                  05311000
RDTHRSH  EQU   PARM+66                                                  05312000
EVSDAY   EQU   STRTDATE+1                                               05313000
EVSYEAR  EQU   STRTDATE                                                 05314000
PENSEC2  EQU   ENDTIME2+2                                               05315000
PENMIN2  EQU   ENDTIME2+1                                               05316000
PENHOUR2 EQU   ENDTIME2                                                 05317000
PSTSEC2  EQU   STTIME2+2                                                05318000
PSTMIN2  EQU   STTIME2+1                                                05319000
PSTHOUR2 EQU   STTIME2                                                  05320000
PENSEC1  EQU   ENDTIME1+2                                               05321000
PENMIN1  EQU   ENDTIME1+1                                               05322000
PENHOUR1 EQU   ENDTIME1                                                 05323000
PSTSEC1  EQU   STTIME1+2                                                05324000
PSTMIN1  EQU   STTIME1+1                                                05325000
PSTHOUR1 EQU   STTIME1                                                  05326000
@NM00005 EQU   ENDDT+4                                                  05327000
PENDY    EQU   PEND+1                                                   05328000
PENYR    EQU   PEND                                                     05329000
@NM00004 EQU   ENDDATE                                                  05330000
@NM00003 EQU   STDT+4                                                   05331000
PSTDY    EQU   PSTD+1                                                   05332000
PSTYR    EQU   PSTD                                                     05333000
@NM00002 EQU   STDATE                                                   05334000
YEARNOW  EQU   DATENOW+4                                                05335000
@NM00001 EQU   DATENOW+3                                                05336000
DAYNOW   EQU   DATENOW                                                  05337000
CSNAP    EQU   CLOSEIO                                                  05338000
CSYSIN   EQU   CLOSEIO                                                  05339000
CSERLOG  EQU   CLOSEIO                                                  05340000
CEREPPT  EQU   CLOSEIO                                                  05341000
CTOURIST EQU   CLOSEIO                                                  05342000
OSNAP    EQU   OPENIO                                                   05343000
ODRCTWRK EQU   OPENIO                                                   05344000
OSYSIN   EQU   OPENIO                                                   05345000
OACCDEV  EQU   OPENIO                                                   05346000
OACCIN   EQU   OPENIO                                                   05347000
OSERLOG  EQU   OPENIO                                                   05348000
OEREPPT  EQU   OPENIO                                                   05349000
OTOURIST EQU   OPENIO                                                   05350000
PLOGREC  EQU   MISC                                                     05351000
ERRORID  EQU   MISC                                                     05352000
PSUM     EQU   PRINTES                                                  05353000
PEDIT    EQU   PRINTES                                                  05354000
PZERO    EQU   MISC                                                     05355000
DEBUG63  EQU   DEBUGA+3                                                 05356000
DEBUG62  EQU   DEBUGA+3                                                 05357000
DEBUG61  EQU   DEBUGA+3                                                 05358000
DEBUG60  EQU   DEBUGA+3                                                 05359000
DEBUG59  EQU   DEBUGA+3                                                 05360000
DEBUG58  EQU   DEBUGA+3                                                 05361000
DEBUG57  EQU   DEBUGA+3                                                 05362000
DEBUG56  EQU   DEBUGA+3                                                 05363000
DEBUG55  EQU   DEBUGA+2                                                 05364000
DEBUG54  EQU   DEBUGA+2                                                 05365000
DEBUG53  EQU   DEBUGA+2                                                 05366000
DEBUG52  EQU   DEBUGA+2                                                 05367000
DEBUG51  EQU   DEBUGA+2                                                 05368000
DEBUG50  EQU   DEBUGA+2                                                 05369000
DEBUG49  EQU   DEBUGA+2                                                 05370000
DEBUG45  EQU   DEBUGA+1                                                 05371000
DEBUG44  EQU   DEBUGA+1                                                 05372000
DEBUG43  EQU   DEBUGA+1                                                 05373000
DEBUG42  EQU   DEBUGA+1                                                 05374000
DEBUG41  EQU   DEBUGA+1                                                 05375000
DEBUG40  EQU   DEBUGA+1                                                 05376000
DEBUG39  EQU   DEBUGA                                                   05377000
DEBUG37  EQU   DEBUGA                                                   05378000
DEBUG36  EQU   DEBUGA                                                   05379000
DEBUG35  EQU   DEBUGA                                                   05380000
DEBUG34  EQU   DEBUGA                                                   05381000
DEBUG33  EQU   DEBUGA                                                   05382000
DEBUG32  EQU   DEBUGA                                                   05383000
DEBUG31  EQU   DEBUG+3                                                  05384000
DEBUG30  EQU   DEBUG+3                                                  05385000
DEBUG29  EQU   DEBUG+3                                                  05386000
DEBUG28  EQU   DEBUG+3                                                  05387000
DEBUG27  EQU   DEBUG+3                                                  05388000
DEBUG26  EQU   DEBUG+3                                                  05389000
DEBUG25  EQU   DEBUG+3                                                  05390000
DEBUG24  EQU   DEBUG+3                                                  05391000
DEBUG22  EQU   DEBUG+2                                                  05392000
DEBUG21  EQU   DEBUG+2                                                  05393000
DEBUG20  EQU   DEBUG+2                                                  05394000
DEBUG19  EQU   DEBUG+2                                                  05395000
DEBUG18  EQU   DEBUG+2                                                  05396000
DEBUG17  EQU   DEBUG+2                                                  05397000
DEBUG15  EQU   DEBUG+1                                                  05398000
DEBUG14  EQU   DEBUG+1                                                  05399000
DEBUG13  EQU   DEBUG+1                                                  05400000
DEBUG12  EQU   DEBUG+1                                                  05401000
DEBUG10  EQU   DEBUG+1                                                  05402000
DEBUG9   EQU   DEBUG+1                                                  05403000
DEBUG8   EQU   DEBUG+1                                                  05404000
DEBUG7   EQU   DEBUG                                                    05405000
DEBUG6   EQU   DEBUG                                                    05406000
DEBUG5   EQU   DEBUG                                                    05407000
DEBUG3   EQU   DEBUG                                                    05408000
DEBUG2   EQU   DEBUG                                                    05409000
DEBUG1   EQU   DEBUG                                                    05410000
DEBUG0   EQU   DEBUG                                                    05411000
SORTBRK  EQU   SWITCHES+1                                               05412000
COREFAIL EQU   SWITCHES+1                                               05413000
ANALYSIS EQU   SWITCHES+1                                               05414000
NOTALL   EQU   SWITCHES+1                                               05415000
NOSDR    EQU   SWITCHES                                                 05416000
TIMESEQ  EQU   SWITCHES                                                 05417000
SYSUM    EQU   SWITCHES                                                 05418000
PARMTHR  EQU   SWITCHES                                                 05419000
TREND    EQU   SWITCHES                                                 05420000
SHORTOBR EQU   SWITCHES                                                 05421000
PARMMES  EQU   SWITCHES                                                 05422000
RDESUM   EQU   SWITCHES                                                 05423000
PCCHFRAM EQU   RECTYPE+1                                                05424000
PMCHFRAM EQU   RECTYPE+1                                                05425000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      05426000
@RF00336 EQU   @RC00325                                                 05427000
@RF00383 EQU   @EL00002                                                 05428000
@RC00389 EQU   @EL00002                                                 05429000
@RF00414 EQU   @EL00003                                                 05430000
@RF00426 EQU   @RC00424                                                 05431000
@RF00435 EQU   @RC00429                                                 05432000
@RC00433 EQU   @RC00429                                                 05433000
@RC00431 EQU   @RC00429                                                 05434000
@RF00439 EQU   @EL00004                                                 05435000
@RF00444 EQU   @EL00004                                                 05436000
@RF00465 EQU   @EL00005                                                 05437000
@RF00477 EQU   @EL00006                                                 05438000
@RF00481 EQU   @EL00006                                                 05439000
@RF00591 EQU   @EL00008                                                 05440000
@RF00651 EQU   @EL00009                                                 05441000
@RC00794 EQU   @EL00015                                                 05442000
@RC00824 EQU   @EL00016                                                 05443000
@RC00830 EQU   @EL00016                                                 05444000
@RC00836 EQU   @EL00016                                                 05445000
@RC00839 EQU   @EL00016                                                 05446000
@RC00842 EQU   @EL00016                                                 05447000
@RC00845 EQU   @EL00016                                                 05448000
@RC00848 EQU   @EL00016                                                 05449000
@RC00851 EQU   @EL00016                                                 05450000
@RC00854 EQU   @EL00016                                                 05451000
@RC00857 EQU   @EL00016                                                 05452000
@RC00900 EQU   @EL00018                                                 05453000
@RF00923 EQU   @EL00018                                                 05454000
@RC00928 EQU   @EL00019                                                 05455000
@RF00941 EQU   @EL00019                                                 05456000
@RC00946 EQU   @EL00020                                                 05457000
@RF00958 EQU   @EL00020                                                 05458000
@RC00963 EQU   @EL00021                                                 05459000
@RF00973 EQU   @EL00021                                                 05460000
@RC00978 EQU   @EL00022                                                 05461000
@RF00987 EQU   @EL00022                                                 05462000
@RF00992 EQU   @EL00023                                                 05463000
@RF00999 EQU   @EL00024                                                 05464000
@RC01006 EQU   @EL00025                                                 05465000
@RF01014 EQU   @EL00026                                                 05466000
@RF01026 EQU   @EL00027                                                 05467000
@RC01055 EQU   @RC01053                                                 05468000
@RF01064 EQU   @RC01047                                                 05469000
@RC01094 EQU   @RC01092                                                 05470000
@RF01111 EQU   @RC01092                                                 05471000
@RF01135 EQU   @EL00030                                                 05472000
@RC01142 EQU   @RC01140                                                 05473000
@RC01154 EQU   @RC01140                                                 05474000
@RF01201 EQU   @EL00032                                                 05475000
@RC01259 EQU   @RC01257                                                 05476000
@RF01277 EQU   @EL00034                                                 05477000
@RF01324 EQU   @RC01284                                                 05478000
@RF01329 EQU   @EL00035                                                 05479000
@RC01331 EQU   @EL00035                                                 05480000
@RF01363 EQU   @EL00036                                                 05481000
@RF01435 EQU   @EL00038                                                 05482000
@RC01486 EQU   @EL00041                                                 05483000
@RF01495 EQU   @EL00041                                                 05484000
@PB00041 EQU   @EL00001                                                 05485000
@RC00796 EQU   @RC00794                                                 05486000
@RF00814 EQU   @RC00794                                                 05487000
@RF01147 EQU   @RC01142                                                 05488000
@RC01157 EQU   @RC01154                                                 05489000
@RC01335 EQU   @RC01331                                                 05490000
@PB00040 EQU   @PB00041                                                 05491000
@RC00798 EQU   @RC00796                                                 05492000
@RF01161 EQU   @RC01157                                                 05493000
@RF01163 EQU   @RC01157                                                 05494000
@RC01166 EQU   @RC01157                                                 05495000
@RC01173 EQU   @RC01157                                                 05496000
@PB00039 EQU   @PB00040                                                 05497000
@RF00800 EQU   @RC00798                                                 05498000
@PB00038 EQU   @PB00039                                                 05499000
@PB00037 EQU   @PB00038                                                 05500000
@PB00036 EQU   @PB00037                                                 05501000
@PB00035 EQU   @PB00036                                                 05502000
@PB00034 EQU   @PB00035                                                 05503000
@PB00033 EQU   @PB00034                                                 05504000
@PB00032 EQU   @PB00033                                                 05505000
@PB00031 EQU   @PB00032                                                 05506000
@PB00030 EQU   @PB00031                                                 05507000
@PB00029 EQU   @PB00030                                                 05508000
@PB00028 EQU   @PB00029                                                 05509000
@PB00027 EQU   @PB00028                                                 05510000
@PB00026 EQU   @PB00027                                                 05511000
@PB00025 EQU   @PB00026                                                 05512000
@PB00024 EQU   @PB00025                                                 05513000
@PB00023 EQU   @PB00024                                                 05514000
@PB00022 EQU   @PB00023                                                 05515000
@PB00021 EQU   @PB00022                                                 05516000
@PB00020 EQU   @PB00021                                                 05517000
@PB00019 EQU   @PB00020                                                 05518000
@PB00018 EQU   @PB00019                                                 05519000
@PB00017 EQU   @PB00018                                                 05520000
@PB00016 EQU   @PB00017                                                 05521000
@PB00015 EQU   @PB00016                                                 05522000
@PB00014 EQU   @PB00015                                                 05523000
@PB00013 EQU   @PB00014                                                 05524000
@PB00012 EQU   @PB00013                                                 05525000
@PB00011 EQU   @PB00012                                                 05526000
@PB00010 EQU   @PB00011                                                 05527000
@PB00009 EQU   @PB00010                                                 05528000
@PB00008 EQU   @PB00009                                                 05529000
@PB00007 EQU   @PB00008                                                 05530000
@PB00006 EQU   @PB00007                                                 05531000
@PB00005 EQU   @PB00006                                                 05532000
@PB00004 EQU   @PB00005                                                 05533000
@PB00003 EQU   @PB00004                                                 05534000
@PB00002 EQU   @PB00003                                                 05535000
@ENDDATA EQU   *                                                        05536000
         END   IFCFILT4                                                 05537000
