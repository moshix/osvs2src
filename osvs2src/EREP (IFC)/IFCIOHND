         TITLE 'IFCIOHND-IO SERVICES MODULE FOR IFCEREP1'               00001000
IFCIOHND CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'IFCIOHND  79.011'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  ST    @14,12(,@13)                                        0001 00009000
         STM   @00,@06,20(@13)                                     0001 00010000
         STM   @08,@12,52(@13)                                     0001 00011000
         BALR  @11,0                                               0001 00012000
@PSTART  LA    @10,4095(,@11)                                      0001 00013000
         LA    @09,4095(,@10)                                      0001 00014000
         LA    @08,4095(,@09)                                      0001 00015000
         USING @PSTART,@11                                         0001 00016000
         USING @PSTART+4095,@10                                    0001 00017000
         USING @PSTART+8190,@09                                    0001 00018000
         USING @PSTART+12285,@08                                   0001 00019000
         ST    @13,@SA00001+4                                      0001 00020000
         LA    @14,@SA00001                                        0001 00021000
         ST    @14,8(,@13)                                         0001 00022000
         LR    @13,@14                                             0001 00023000
*DCL ADDNUM(1) CHAR(1) BASED(ADDNXT);                      /*@Z427VLS*/ 00024000
*DCL NEXTBY FIXED(31) INIT(0);                             /*@Z427VLS*/ 00025000
*DCL ADDNXT FIXED(31) INIT(0);                             /*@Z427VLS*/ 00026000
*DCL NUMBER FIXED(31) INIT(0);                             /*@Z427VLS*/ 00027000
*DCL GETTIT CHAR(4) DEFINED(GETHIS); /*ALPHA ACCESS OF GETHIS*/    0070 00028000
*DCL LISTPTR PTR(31) BASED(PTRSPOT); /*POINTER TO LIST PARAMETER*/ 0071 00029000
*DCL INARG  FIXED(15) BASED(LISTPTR); /*INPUT PARAMETER WITH @Z427VLS*/ 00030000
*                                     /*SERVICE REQUESTED CODE*/   0073 00031000
*DCL LINECTT FIXED(15) INIT(0); /*RUNNING LINE COUNT FOR PAGE SKIPIN */ 00032000
*DCL LINEMAX FIXED(15) INIT(0); /*MAXIMUM LINES PER PAGE, TOURIST*/     00033000
*DCL CCSAVE  CHAR(1) INIT(' '); /*CARRIAGE CONTROL CHAR SAVE SPOT*/     00034000
*DCL BLANKS CHAR(134) INIT(' '); /*BLANKS FOR PRINT LINE     @Z427VLS*/ 00035000
*DCL MSGNO  FIXED(31)  INIT(0); /*MESSAGE TEXT INDEX         @Z427VLS*/ 00036000
*DCL BADNEWS FIXED(31) INIT(0); /*RETURN CODE SAVE ITEM      @Z427VLS*/ 00037000
*DCL PACKPAS  CHAR(4) INIT('    ');                        /*@Z427VLS*/ 00038000
*DCL CHARPAS  CHAR(8) INIT('        ');                    /*@Z427VLS*/ 00039000
*DCL PASSNUM  FIXED(31) INIT(0);                           /*@Z427VLS*/ 00040000
*DCL EDIFILD(9) CHAR(1);                                   /*@Z427VLS*/ 00041000
*DCL EDFLD CHAR(9) DEFINED(EDIFILD);                       /*@Z427VLS*/ 00042000
*DCL CTPTR(10) FIXED(31) DEFINED(CONTPTR);                 /*@Z427VLS*/ 00043000
*DCL CHARS CHAR(16) INIT('0123456789ABCDEF');              /*@Z427VLS*/ 00044000
*/********************************************************************/ 00045000
*DCL CLOSEALL BIT(16) CONSTANT('FFFF'X); /*EOF ALL CLOSED MASK*/   0086 00046000
*DCL SKIPNEW BIT(8) CONSTANT('8B'X);          /* SKIP TO CHANNEL ONE*/  00047000
*DCL NODSETS BIT(16) CONSTANT('0000'X); /*NO DATA SETS ASKED OPEN*/     00048000
*DCL DBLWORD BIT(32) CONSTANT('00000007'X); /*NO DOUBLE WORD MASK*/     00049000
*DCL NULL    BIT(32) CONSTANT('00000000'X);                /*@Z427VLS*/ 00050000
*DCL CHARZERO BIT(8) CONSTANT('F0'X);                      /*@Z427VLS*/ 00051000
*DCL BLANK    BIT(8) CONSTANT('40'X);                      /*@Z427VLS*/ 00052000
*/********************************************************************/ 00053000
*DCL  1  IOPLINE  CHAR(134)  BASED(PRINTADR), /*PRINT WORK AREA DSECT*/ 00054000
*      2 PRINTDS  CHAR(1), /*DATA SET IS ERREPT IF F0        @Z427VLS*/ 00055000
*                          /*DATA SET IS TOURIST IF F1       @Z427VLS*/ 00056000
*      2 PRINTCC  CHAR(1), /*CARRIAGE CONTROL CHARACTER, IGNORED*/ 0093 00057000
*                          /*IF FROM USER FOR TOURIST DATA SET*/   0093 00058000
*      2 PRINTBDY CHAR(132); /*LINE TO BE PRINTED, WILL BE CLEARED*/    00059000
*                            /*TO BLANKS BEFORE RETURN TO USER*/   0094 00060000
*DCL 1 ERRLINE(29), /*INTERNAL DEBUG15 MESSAGES              @G51DGBB*/ 00061000
*    2 ERRDS CHAR(1) INIT((29)'1'),                                0094 00062000
*    2 ERRCS CHAR(1) INIT((29)' '),                                0094 00063000
*    2 PRINTNM CHAR(9) INIT((29)'DEBUG15  '),                      0094 00064000
*    2 PRNTXT CHAR(40)                                             0094 00065000
*INIT('SERLOG OPEN ATTEMPTED                   ',  /*53      @Z427VLS*/ 00066000
*     'CHECK HEADER FOR MORE RECORDS ATTEMPTED ', /*54       @Z427VLS*/ 00067000
*     'RESET OF SERLOG HEADER ATTEMPTED        ', /*55       @Z427VLS*/ 00068000
*     'SERLOG CLOSE ATTEMPTED                  ', /*56       @Z427VLS*/ 00069000
*     'ZEROALL ATTEMPTED                       ', /*57       @Z427VLS*/ 00070000
*     'SDR COUNTER DUMP ATTEMPTED              ', /*58       @Z427VLS*/ 00071000
*     'SYSIN OPEN ATTEMPTED                    ', /*59       @Z427VLS*/ 00072000
*     'SYSIN CLOSE ATTEMPTED                   ', /*60       @Z427VLS*/ 00073000
*     'DIRECTWK CLOSE FOR WRITING ATTEMPTED    ', /*61       @Z427VLS*/ 00074000
*     'DIRECTWK CLOSE FOR READING ATTEMPTED    ', /*62       @Z427VLS*/ 00075000
*     'DIRECTWK OPEN FOR WRITE ATTEMPTED      ', /*63        @Z427VLS*/ 00076000
*     'ACCIN OPEN ATTEMPTED                    ', /*64       @Z427VLS*/ 00077000
*     'ACCIN CLOSE ATTEMPTED                   ', /*65       @Z427VLS*/ 00078000
*     'ACCDEV CLOSE ATTEMPTED                  ', /*66       @Z427VLS*/ 00079000
*     'EREPPT OPEN ATTEMPTED                   ', /*67       @Z427VLS*/ 00080000
*     'EREPPT CLOSE ATTEMPTED                  ', /*68       @Z427VLS*/ 00081000
*     'ACCDEV OPEN ATTEMPTED                   ',  /*69TH ENTRY*/  0094 00082000
*     'FIRST FRAME READ ATTEMPT                ',                  0094 00083000
*     'TIMES IFCIOHND EXITED WITH R.C.12       ', /*70       @Z427VLS*/ 00084000
*     'SERLOG SEQUENTIAL READ ATTEMPTS         ', /*71       @Z427VLS*/ 00085000
*     'SERLOG DIRECT READ ATTEMPTS             ', /*72       @Z427VLS*/ 00086000
*     'TIME CONVERSION NECESSARY NUM. TIMES    ', /*73       @Z427VLS*/ 00087000
*     'RECORDS SAVED DURING ZEROALL PROCESSING ', /*74       @Z427VLS*/ 00088000
*     'SYSIN READ ATTEMPTS                     ', /*75       @Z427VLS*/ 00089000
*     'DIRECTWK WRITE ATTEMPTS                 ', /*76       @Z427VLS*/ 00090000
*     'DIRECTWK READ ATTEMPTS                  ', /*77       @Z427VLS*/ 00091000
*     'ACCIN SEQUENTIAL READ ATTEMPTS          ', /*78       @Z427VLS*/ 00092000
*     'ACCDEV WRITE ATTEMPTS                   ',                  0094 00093000
*     'FRAME READ ATTEMPTS OF SYS1.LOGREC      ');         /*@G51DGBB*/ 00094000
*DCL MACHCODE(256) CHAR(1) /* ENSURE VALID MACHINE CODE      @ZA18999*/ 00095000
*INIT('09'X,'01'X,(9)'09'X,'0B'X,(5)'09'X,'11'X,'09'X,'13'X,       0095 00096000
*     (5)'09'X,                                                    0095 00097000
*      '19'X,'09'X,'1B'X,(109)'09'X,'89'X,'09'X,'8B'X,             0095 00098000
*       (5)'09'X,'91'X,'09'X,'93'X,(5)'09'X,'99'X,                 0095 00099000
*       '09'X,'9B'X,(5)'09'X,'A1'X,'09'X,'A3'X,                    0095 00100000
*       (7)'09'X,'AB'X,(5)'09'X,'B1'X,                             0095 00101000
*       '09'X,'B3'X,(5)'09'X,'B9'X,'09'X,'BB'X,(5)'09'X,           0095 00102000
*       'C1'X,'09'X,'C3'X,(5)'09'X,'C9'X,'09'X,'CB'X,              0095 00103000
*       (5)'09'X,'D1'X,'09'X,'D3'X,(5)'09'X,'D9'X,                 0095 00104000
*        '09'X,'DB'X,(5)'09'X,'E1'X,'09'X,'E3'X,(20)'09'X);/*@ZA18999*/ 00105000
*/********************************************************************/ 00106000
*DCL PRNTBF CHAR(134) BDY(DWORD); /*INTERNAL PRINT LINE BUFFER*/   0096 00107000
*/********************************************************************/ 00108000
*DCL 1  BUF1 BDY(DWORD), /*WORK AREA FOR QSAM RECORDS        @Z427VLS*/ 00109000
*     2 BUF1RDW, /*RECORD DESCRIPTOR WORD                    @Z427VLS*/ 00110000
*     3 BUF1RDWL FIXED(15) INIT(0), /*QSAM RECORD LENGTH     @Z427VLS*/ 00111000
*     3 BUF1L    FIXED(15) INIT(0), /*QSAM ZEROS             @Z427VLS*/ 00112000
*     2 BUF1DTA  CHAR(2000);    /*MAXIMUM SYS1.LOGREC RECORD LENGTH*/   00113000
*/*******************************************************************/  00114000
*DCL  1 RECTB BASED(RUNPTR), /*ZEROALL RECORD SAVE AREA DSECT*/    0098 00115000
*     2 FORPTR  PTR(31),                                           0098 00116000
*     2 JUNK,                                                      0098 00117000
*     3 JUNK1   CHAR(5),                                           0098 00118000
*     3 JUNK2   CHAR(1),                                           0098 00119000
*     3 JUNK3   FIXED(15),                                         0098 00120000
*     2 RECSPT  CHAR(1894);                                /*@Z427VLS*/ 00121000
*/*******************************************************************/  00122000
* DCL 1 IOSWTCH CHAR(3) INIT('000000'X), /*NEW SWITCHES      @Z427VLS*/ 00123000
*     2 HISTOPN BIT(1), /*OUTPUT HIST IS OPENED FLAG         @Z427VLS*/ 00124000
*     2 SECGET   BIT(1), /*ZEROALL GETMAIN SWITCH            @Z427VLS*/ 00125000
*     2 FLIPFLOP BIT(1), /*OFF SERLOG READSEQ, ON ACCIN READSEQ*/  0099 00126000
*     2 HISTYES BIT(1), /*INDICATES ACCIN INPUT SPECIFIED    @Z427VLS*/ 00127000
*     2 DBLYES  BIT(1), /*DOUBLE WORD CREATION LOOP EXIT SWITCH*/  0099 00128000
*     2 LASTLOOP BIT(1),  /*ZEROALL PROCESSING               @Z427VLS*/ 00129000
*     2 TOURERR BIT(1), /*ERROR WITH TOURIST DATA SET        @Z427VLS*/ 00130000
*     2 INHISO  BIT(1), /*INPUT HIST IS IPENED FLAG          @Z427VLS*/ 00131000
*     2 SERLO   BIT(1), /*SERLOG IS OPENED FLAG              @Z427VLS*/ 00132000
*     2 TWOTRY  BIT(1), /*OFF IMPLIES 1ST EOF READING SERLOG SEQ.*/     00133000
*     2 INDIR   BIT(1), /*DIRECTWK IS OPENED FOR SEQ WRITE   @Z427VLS*/ 00134000
*     2 NONBLANK BIT(1), /*NONBLANK LOOP FINDER SWITCH       @Z427VLS*/ 00135000
*     2 CLOSE2  BIT(1), /*DIRECTWK IS OPENED FOR DIR WRITE   @Z427VLS*/ 00136000
*     2 SYSOPN  BIT(1), /*SYSIN IS OPENED SWITCH             @Z427VLS*/ 00137000
*     2 TOUROPN  BIT(1), /*TOURIST DS IS OPENED SWITCH       @Z427VLS*/ 00138000
*     2 ERPTOPN  BIT(1), /*REGULAR PRINT D.S. HAS BEEN OPENED*/    0099 00139000
*    2 READFR   BIT(1), /*FRAMES ARE BEING READ SWITCH       @G51DGBB*/ 00140000
*    2 SCRATCH  BIT(1), /*LAST OPERATION WAS READ DIRECT     @G51DGBB*/ 00141000
*     2 SNAPOP  BIT(1); /*SNAP DS HAS BEEN OPENED SWITCH     @Z427VLS*/ 00142000
*/********************************************************************/ 00143000
*DCL    1   HDRBUFF   CHAR(64) BDY(DWORD),   /* EXTRACTOR WORK AREA  */ 00144000
*          2   HDRSEEK             CHAR(8),  /* SEEK FIELD FOR I/O   */ 00145000
*             3   HDRM             CHAR(1) INIT('00'X),            0100 00146000
*             3   HDRBB            CHAR(2) INIT('0000'X),          0100 00147000
*             3   HDRCC            CHAR(2) INIT('0000'X),          0100 00148000
*             3   HDRHH            CHAR(2) INIT('0000'X),          0100 00149000
*             3   HDRR             CHAR(1) INIT('00'X),            0100 00150000
*          2   HEADER              CHAR(40), /* HEADER REC - LOGREC  */ 00151000
*             3   HDRKEY           CHAR(2),  /* FF00-HDR SOURCE FLD  */ 00152000
*             3   HDRSCC           CHAR(2),  /* START OF     @Z427VLS*/ 00153000
*             3   HDRSHH           CHAR(2),  /* SYS1.LOGREC  @Z427VLS*/ 00154000
*             3   HDRECC           CHAR(2),  /* END OF       @Z427VLS*/ 00155000
*             3   HDREHH           CHAR(2),  /* SYS1.LOGREC  @Z427VLS*/ 00156000
*             3   HDRCOUNT         CHAR(1),  /* COUNT OF FULL MSG */    00157000
*             3   HDRREC1          CHAR(7),  /* CCHHR OF 1ST REC     */ 00158000
*                4   HDR1BB        CHAR(2),                        0100 00159000
*                4   HDR1CC        CHAR(2),                        0100 00160000
*                4   HDR1HH        CHAR(2),                        0100 00161000
*                4   HDR1R         CHAR(1),                        0100 00162000
*             3   HDRREM           CHAR(2),  /* NO. OF BYTES REMAING */ 00163000
*             3   HDRTRKCP         CHAR(2),  /* TRK CAPACITY @Z427VLS*/ 00164000
*             3   HDRREC2          CHAR(7),  /* LAST ACTIVE RECORD   */ 00165000
*                4   HDR2BB        CHAR(2),                        0100 00166000
*                4   HDR2CC        CHAR(2),                        0100 00167000
*                4   HDR2HH        CHAR(2),                        0100 00168000
*                4   HDR2R         CHAR(1),                        0100 00169000
*             3   HDRUCBNO         CHAR(2),  /* NO. OF UCB'S @Z427VLS*/ 00170000
*             3   HDREXSZE         CHAR(2),  /* NO. OF TRK'S @Z427VLS*/ 00171000
*             3   HDRTYPE          CHAR(1),  /* RES TYPE     @Z427VLS*/ 00172000
*             3   *                CHAR(4),                        0100 00173000
*             3   *                CHAR(1),                        0100 00174000
*                4   HDRWNGBT       BIT(1),  /* 90% FULL SWITCH      */ 00175000
*                4   *              BIT(1),                        0100 00176000
*                4   FRAMES         BIT(1), /*FRAMES EXIST FLAG*/  0100 00177000
*                4   *              BIT(4),                        0100 00178000
*             3   HDRSAFE          CHAR(1),  /* X'FF' INDICATES RECOK*/ 00179000
*          2   PREVSEEK            CHAR(8),  /* PREVIOUS SEEK FIELD  */ 00180000
*             3   PREVM            CHAR(1) INIT('FF'X), /* FF=CLOSED */ 00181000
*             3   PREVBB           CHAR(2),                        0100 00182000
*             3   PREVCC           CHAR(2),                        0100 00183000
*             3   PREVHH           CHAR(2),                        0100 00184000
*             3   PREVR            CHAR(1);                /*@G51DGBB*/ 00185000
*DCL     LOGRECA    CHAR(11) INIT('SYS1.LOGREC'); /* ENQUE/DEQUE     */ 00186000
*DCL     LOGRECB    CHAR(8)  INIT('RECORDER');    /* NAMES FOR SYSTEM*/ 00187000
*DCL     RESID      CHAR(8)  INIT('SERLOG');      /* & STEP ENQ/DEQ  */ 00188000
*DCL     RESIDII    CHAR(8)  INIT('LOGREC');      /*         @Z427VLS*/ 00189000
*DCL     SDRK  FIXED(15) INIT(0);                          /*@Z427VLS*/ 00190000
*DCL     ZEROA CHAR(24);                                   /*@Z427VLS*/ 00191000
*DCL 1 SEEKSAVE CHAR(8) INIT('0000000000000000'X), /*BEGINNING OF LOG*/ 00192000
*    2 *      CHAR(7),                                             0107 00193000
*    2 SKSAVREC CHAR(1); /*R PORTION OF MBBCCHHR             @G51DGBB*/ 00194000
*DCL     BYTESREM(14) FIXED(15)                             /*XL03145*/ 00195000
*                        INIT(00000,    /* SPARE  CODE 00    @Z427VLS*/ 00196000
*                             03419,    /* 2311   CODE 01    @Z427VLS*/ 00197000
*                             20137,    /* 2301   CODE 02    @Z427VLS*/ 00198000
*                             04596,    /* 2303   CODE 03    @Z427VLS*/ 00199000
*                             04778,    /* 2302   CODE 04    @Z427VLS*/ 00200000
*                             00000,    /* SPARE  CODE 05    @Z427VLS*/ 00201000
*                             13192,    /* 2305-1 CODE 06    @Z427VLS*/ 00202000
*                             14184,    /* 2305-2 CODE 07    @Z427VLS*/ 00203000
*                             07008,    /* 2314   CODE 08    @Z427VLS*/ 00204000
*                             12680,    /* 3330   CODE 09    @Z427VLS*/ 00205000
*                             07954,    /* 3340   CODE 0A    @Z427VLS*/ 00206000
*                             18800,    /* 3350   CODE 0B    @Z40RIVS*/ 00207000
*                             00000,    /* SPARE  CODE 0C    @Z427VLS*/ 00208000
*                             12680);   /* 3330-1 CODE 0D    @Z427VLS*/ 00209000
*/********************************************************************/ 00210000
*/*                                                          @Z427VLS*/ 00211000
*/*      ECB,IOB,& CCW'S FOR EXCP                            @Z427VLS*/ 00212000
*/*                                                          @Z427VLS*/ 00213000
*/********************************************************************/ 00214000
*DCL    1   XWRECB  FIXED(31) INIT(0),  /* ECB               @Z427VLS*/ 00215000
*          2   POST      CHAR(1),                                  0109 00216000
*          2   *         CHAR(3);                          /*@Z427VLS*/ 00217000
*DCL    1   XIOB    CHAR(40) BDY(DWORD),                           0110 00218000
*          2   XIOBFL1   CHAR(1) INIT('42'X),                      0110 00219000
*          2   XIOBFL2   CHAR(1) INIT('00'X),                      0110 00220000
*          2   XIOBSNS0  CHAR(1) INIT('00'X),                      0110 00221000
*          2   XIOBSNS1  CHAR(1) INIT('00'X),                      0110 00222000
*          2   XIOBECB   PTR(31) INIT(ADDR(XWRECB)),               0110 00223000
*          2   XIOBCSW   CHAR(8) INIT('0000000000000000'X),        0110 00224000
*          2   XIOBCCW   PTR(31) INIT(ADDR(SEQ)),                  0110 00225000
*          2   XIOBDCB   PTR(31),                                  0110 00226000
*          2   XIOBRA    PTR(31) INIT(0),                          0110 00227000
*          2   XIOBBEC   FIXED(31) INIT(0),                        0110 00228000
*          2   XIOBSEEK  CHAR(8),                                  0110 00229000
*             3   XIOBM  CHAR(1)  INIT('00'X),                     0110 00230000
*             3   XIOBBB CHAR(2)  INIT('0000'X),                   0110 00231000
*             3   XIOBCC CHAR(2)  INIT('0000'X),                   0110 00232000
*             3   XIOBHH CHAR(2)  INIT('0000'X),                   0110 00233000
*             3   XIOBR  CHAR(1)  INIT('00'X);             /*@Z427VLS*/ 00234000
*DCL    1   SWITCH  BIT(8) INIT('00'X), /* INTERNAL SWITCH   @Z427VLS*/ 00235000
*          2   SBT0      BIT(1),        /* DISK OPEN         @Z427VLS*/ 00236000
*          2   SBT2      BIT(1),        /* WRITE REQUIRED    @Z427VLS*/ 00237000
*          2   SBT3      BIT(1),        /*                   @Z427VLS*/ 00238000
*          2   SBT4      BIT(1),        /* HEADER RECORD I/O @Z427VLS*/ 00239000
*          2   SBT7      BIT(1);        /* INTERNAL ENQ ISSUED       */ 00240000
*DCL    1   SEQ     CHAR(24) BDY(DWORD),/* CCW STRING        @Z427VLS*/ 00241000
*          2   SID1       CHAR(8),                /* SEARCH ID EQUAL */ 00242000
*             3   *       CHAR(1) INIT('31'X),                     0112 00243000
*             3   AREAADR PTR(24) BDY(BYTE),      /* PTR TO COUNT FLD*/ 00244000
*             3   *       CHAR(2) INIT('4000'X),                   0112 00245000
*             3   *       FIXED(15) BDY(BYTE) INIT(5),             0112 00246000
*          2   TIC1       CHAR(8),                /* TRANSFER IN CHAN*/ 00247000
*            3    *       CHAR(1) INIT('08'X),                     0112 00248000
*             3   *       PTR(24) BDY(BYTE) INIT(ADDR(SID1)),      0112 00249000
*             3   *       CHAR(2) INIT('4000'X),                   0112 00250000
*             3   *       FIXED(15) BDY(BYTE) INIT(1),             0112 00251000
*          2   CKD1       CHAR(8),                /* R/W COUNT KEY & */ 00252000
*             3   CKDCOM  CHAR(1),                /* DATA    @Z427VLS*/ 00253000
*             3   CKDAREA  PTR(24) BDY(BYTE),     /* DATA PTR        */ 00254000
*             3   CKDCHAIN CHAR(1) INIT('20'X),                    0112 00255000
*             3   *        CHAR(1) INIT('00'X),                    0112 00256000
*             3   CKDCOUNT FIXED(15) BDY(BYTE);   /* SIZE OF RECORD  */ 00257000
*/********************************************************************/ 00258000
*/*                                                          @Z427VLS*/ 00259000
*/*      CONSTANTS & WORK AREAS FOR TIME/DATE CONVERSION     @Z427VLS*/ 00260000
*/*                                                          @Z427VLS*/ 00261000
*/********************************************************************/ 00262000
*DCL    1   WORK8   CHAR(8) BDY(DWORD),                            0113 00263000
*          2   WORK         FIXED(31),                             0113 00264000
*          2   WORKB        FIXED(31),                             0113 00265000
*             3   WHOURS     CHAR(1),                              0113 00266000
*             3   WMINS      CHAR(1),                              0113 00267000
*             3   WDAYS      CHAR(2),                              0113 00268000
*                4   WSECS   CHAR(1),                              0113 00269000
*                4   WTNTHS  CHAR(1);                      /*@Z427VLS*/ 00270000
*DCL     TIMDIV     FIXED(31);                             /*@Z427VLS*/ 00271000
*DCL     MILLION    FIXED(31) INIT(1000000);               /*@Z427VLS*/ 00272000
*DCL     TWENTY4    FIXED(31) INIT(24);                    /*@Z427VLS*/ 00273000
*DCL     SIXTY      FIXED(31) INIT(60);                    /*@Z427VLS*/ 00274000
*DCL     CONSTG     FIXED(31) INIT('30040'X);              /*@Z427VLS*/ 00275000
*DCL     CONSTH     FIXED(31) INIT('24AE062'X);            /*@Z427VLS*/ 00276000
*DCL     SIXTYMIL   FIXED(31) INIT(60000000);              /*@Z427VLS*/ 00277000
*DCL     PATCH(20) FIXED(15) INIT((20)0);    /* PATCH AREA   @Z427VLS*/ 00278000
*GENERATE DATA;                                            /*@Z427VLS*/ 00279000
*/********************************************************************/ 00280000
*/*                                                          @Z427VLS*/ 00281000
*/*      BASED DCL'S                                         @Z427VLS*/ 00282000
*/*                                                          @Z427VLS*/ 00283000
*/********************************************************************/ 00284000
*/*                                                          @Z427VLS*/ 00285000
*/*      DSECT OF HEADER                                     @Z427VLS*/ 00286000
*/*                                                          @Z427VLS*/ 00287000
*DCL    1   OHEADER           CHAR(40) BASED(R4),                  0123 00288000
*          2   OHDRKEY        CHAR(2),                             0123 00289000
*          2   OHDRSCC        CHAR(2),                             0123 00290000
*          2   OHDRSHH        CHAR(2),                             0123 00291000
*          2   OHDRECC        CHAR(2),                             0123 00292000
*          2   OHDREHH        CHAR(2),                             0123 00293000
*          2   OHDRHI         CHAR(1),                             0123 00294000
*          2   OHDRREC1       CHAR(7),                             0123 00295000
*             3   OHDR1BB     CHAR(2),                             0123 00296000
*             3   OHDR1CC     CHAR(2),                             0123 00297000
*             3   OHDR1HH     CHAR(2),                             0123 00298000
*             3   OHDR1R      CHAR(1),                             0123 00299000
*          2   OHDRREM        CHAR(2),                             0123 00300000
*          2   OHDRTRXC       CHAR(2),                             0123 00301000
*          2   OHDRREC2       CHAR(7),                             0123 00302000
*             3   OHDR2BB     CHAR(2),                             0123 00303000
*             3   OHDR2CC     CHAR(2),                             0123 00304000
*             3   OHDR2HH     CHAR(2),                             0123 00305000
*             3   OHDR2R      CHAR(1),                             0123 00306000
*          2   OHDRUCBN       CHAR(2),                             0123 00307000
*          2   OHDREXSZ       CHAR(2),                             0123 00308000
*          2   OHDRTYP        CHAR(1),                             0123 00309000
*          2   *              CHAR(5),                             0123 00310000
*          2   OHDRSAFE       CHAR(1);                     /*@Z427VLS*/ 00311000
*/*                                                          @Z427VLS*/ 00312000
*/*      DSECT OF INPUT BUFFER                               @Z427VLS*/ 00313000
*/*                                                          @Z427VLS*/ 00314000
*DCL    1   BUFFER  DEFINED(BUF1), /*USE FOR SERLOP EXCP READS*/   0124 00315000
*          2   BCOUNT              CHAR(8),  /* COUNT AREA   @Z427VLS*/ 00316000
*             3   BCCHHR           CHAR(5),  /* COUNT FROM REC       */ 00317000
*             3   BKEYL            CHAR(1),  /* KEY LENGTH=0 @Z427VLS*/ 00318000
*             3   BSIZE            CHAR(2),  /* SIZE OF RECORD READ  */ 00319000
*          2   BDATA                 CHAR(1900);           /*@G51DGBB*/ 00320000
*DCL  BSZ FIXED(15) DEFINED(BSIZE); /*ACCESS BSIZE AS NUMERIC*/    0125 00321000
*DCL SAVELENT FIXED(15) INIT(0); /*DATA LENGTH + 4 FROM READSEQ*/  0126 00322000
*DCL  BBRDW CHAR(2) DEFINED(BCCHHR) POSITION(5); /*USE TO SHUFFLE*/     00323000
*                                /*LOGREC RECORD INTO V FORMAT*/   0128 00324000
*/*                                                          @Z427VLS*/ 00325000
*/*      DSCECT OF AN INPUT RECORD                           @Z427VLS*/ 00326000
*/*                                                          @Z427VLS*/ 00327000
*DCL    1   RECAREA              BASED(TIMEBASE),                  0128 00328000
*          2   RECKEY              CHAR(1),                        0128 00329000
*          2   *                   CHAR(1),                        0128 00330000
*          2   *                   CHAR(6),                        0128 00331000
*             3   *                 BIT(1),                        0128 00332000
*             3   NSSWITCH          BIT(1),  /* NS TIME INDICATOR    */ 00333000
*             3   *                 BIT(2),                        0128 00334000
*             3   LCSWITCH          BIT(1),  /* LOCAL TIME  INDICATOR*/ 00335000
*             3   *                 BIT(3),                        0128 00336000
*          2   DATETIME            CHAR(8),                        0128 00337000
*             3   DATE             CHAR(4),                        0128 00338000
*                4   DATE0         CHAR(1),                        0128 00339000
*                   5   GMTSW       BIT(1),                        0128 00340000
*                   5   *           BIT(7),                        0128 00341000
*                4   YEAR          CHAR(1),                        0128 00342000
*                4   DAYS          CHAR(2),                        0128 00343000
*             3   TIME             CHAR(4),                        0128 00344000
*                4   HOURS         CHAR(1),                        0128 00345000
*                4   MINS          CHAR(1),                        0128 00346000
*                4   SECS          CHAR(1),                        0128 00347000
*                4   TNTHS         CHAR(1);                /*@Z427VLS*/ 00348000
*/********************************************************************/ 00349000
*/*                                                          @Z427VLS*/ 00350000
*/*      EQUATES                                             @Z427VLS*/ 00351000
*/*                                                          @Z427VLS*/ 00352000
*/********************************************************************/ 00353000
*GENERATE ;                                                /*@Z427VLS*/ 00354000
L0       EQU   0                                                        00355000
L1       EQU   1                                                        00356000
L2       EQU   2                                                        00357000
L4       EQU   4                                                        00358000
L6       EQU   6                                                        00359000
L8       EQU   8                                                        00360000
L10      EQU   10                                                       00361000
L12      EQU   12                                                       00362000
L19      EQU   19                                                       00363000
L20      EQU   20                                                       00364000
L24      EQU   24                                                       00365000
L36      EQU   36                                                       00366000
L38      EQU   38                                                       00367000
L256     EQU   256                                                      00368000
OPENOK   EQU   X'10'                                                    00369000
ZR0      EQU   8                                                        00370000
*DCL THCONV FIXED(31) INIT(10000);                         /*@Z427VLS*/ 00371000
*/********************************************************************/ 00372000
*/*                                                          @Z427VLS*/ 00373000
*/*      STARTING LOCATION FOR IFCIOHND                      @Z427VLS*/ 00374000
*/*                                                          @Z427VLS*/ 00375000
*                                      /*R2 HAS COMTABLE ADDRESS*/ 0131 00376000
*PTRSPOT = R1; /*GET PARAMETER LIST ADDRESS OF ADDRESS       @Z427VLS*/ 00377000
         ST    R1,PTRSPOT                                          0131 00378000
*SAVER2 = R2; /*PRESUME THAT R2 HAS ADDRESS OF COMTABLE AT THIS POINT*/ 00379000
         ST    R2,SAVER2                                           0132 00380000
*GENERATE;                                                 /*@Z427VLS*/ 00381000
         USING IHADCB,R12      USE R12 FOR ADDRESSING DCBS              00382000
*BADNEWS = ZERO; /*RETURN CODE SAVE ITEM                     @Z427VLS*/ 00383000
         SLR   @12,@12                                             0134 00384000
         ST    @12,BADNEWS                                         0134 00385000
*RESPECIFY (R2,R1) UNRESTRICTED;                           /*@Z427VLS*/ 00386000
*/*DETERMINE SERVICE CALLER HAS REQUESTED AND BRANCH TO APPROPRIATE*/   00387000
*/*ROUTINE                                                   @Z427VLS*/ 00388000
*IF INARG = READSEQ THEN /*IF READ OF SERLOG OR ACCIN REQUESTED*/  0136 00389000
         L     @12,PTRSPOT                                         0136 00390000
         L     @12,LISTPTR(,@12)                                   0136 00391000
         CLC   INARG(2,@12),@CH00077                               0136 00392000
         BNE   @RF00136                                            0136 00393000
*  CALL READSIT;                                           /*@Z427VLS*/ 00394000
         BAL   @14,READSIT                                         0137 00395000
*ELSE                                                              0138 00396000
*  DO;                                                     /*@Z427VLS*/ 00397000
         B     @RC00136                                            0138 00398000
@RF00136 DS    0H                                                  0139 00399000
*    IF INARG = READIRCT THEN                                      0139 00400000
         L     @12,PTRSPOT                                         0139 00401000
         L     @12,LISTPTR(,@12)                                   0139 00402000
         CLC   INARG(2,@12),@CH00082                               0139 00403000
         BNE   @RF00139                                            0139 00404000
*      CALL DIRECTIT; /*EXCP READ OF SERLOG OR POINT SEQ. READ OF WORK* 00405000
         BAL   @14,DIRECTIT                                        0140 00406000
*    ELSE                                                          0141 00407000
*      DO;                                                 /*@Z427VLS*/ 00408000
         B     @RC00139                                            0141 00409000
@RF00139 DS    0H                                                  0142 00410000
*        IF INARG = RITEHIST THEN                                  0142 00411000
         L     @12,PTRSPOT                                         0142 00412000
         L     @12,LISTPTR(,@12)                                   0142 00413000
         CLC   INARG(2,@12),@CH00065                               0142 00414000
         BNE   @RF00142                                            0142 00415000
*          CALL HISTIT; /*QSAM WRITE TO ACCDEV, HISTORY OUTPUT*/   0143 00416000
         BAL   @14,HISTIT                                          0143 00417000
*        ELSE                                                      0144 00418000
*          DO;                                             /*@Z427VLS*/ 00419000
         B     @RC00142                                            0144 00420000
@RF00142 DS    0H                                                  0145 00421000
*            IF INARG = RITESCRT THEN /*SEQUENTIAL NOTE WRITE TO WORK*/ 00422000
         L     @12,PTRSPOT                                         0145 00423000
         L     @12,LISTPTR(,@12)                                   0145 00424000
         CLC   INARG(2,@12),@CH00080                               0145 00425000
         BNE   @RF00145                                            0145 00426000
*              CALL SCRCHIT;                               /*@Z427VLS*/ 00427000
         BAL   @14,SCRCHIT                                         0146 00428000
*            ELSE                                                  0147 00429000
*              DO;                                         /*@Z427VLS*/ 00430000
         B     @RC00145                                            0147 00431000
@RF00145 DS    0H                                                  0148 00432000
*                IF INARG = RITEPRTR THEN                          0148 00433000
         L     @12,PTRSPOT                                         0148 00434000
         L     @12,LISTPTR(,@12)                                   0148 00435000
         CLC   INARG(2,@12),@CH00075                               0148 00436000
         BNE   @RF00148                                            0148 00437000
*                  CALL PRINTIT;                           /*@Z427VLS*/ 00438000
         BAL   @14,PRINTIT                                         0149 00439000
*                ELSE                                              0150 00440000
*                  DO;                                     /*@Z427VLS*/ 00441000
         B     @RC00148                                            0150 00442000
@RF00148 DS    0H                                                  0151 00443000
*                    IF INARG = IOOPEN THEN                        0151 00444000
         L     @12,PTRSPOT                                         0151 00445000
         L     @12,LISTPTR(,@12)                                   0151 00446000
         CLC   INARG(2,@12),@CH00056                               0151 00447000
         BNE   @RF00151                                            0151 00448000
*                      CALL OPENIT;                        /*@Z427VLS*/ 00449000
         BAL   @14,OPENIT                                          0152 00450000
*                    ELSE                                          0153 00451000
*                      DO;                                 /*@Z427VLS*/ 00452000
         B     @RC00151                                            0153 00453000
@RF00151 DS    0H                                                  0154 00454000
*                        IF INARG = IOCLOSE THEN                   0154 00455000
         L     @12,PTRSPOT                                         0154 00456000
         L     @12,LISTPTR(,@12)                                   0154 00457000
         CLC   INARG(2,@12),@CH00037                               0154 00458000
         BNE   @RF00154                                            0154 00459000
*                          CALL CLOSIT;                    /*@Z427VLS*/ 00460000
         BAL   @14,CLOSIT                                          0155 00461000
*                        ELSE                                      0156 00462000
*                          DO;                             /*@Z427VLS*/ 00463000
         B     @RC00154                                            0156 00464000
@RF00154 DS    0H                                                  0157 00465000
*                                IF INARG = READCARD THEN          0157 00466000
         L     @12,PTRSPOT                                         0157 00467000
         L     @12,LISTPTR(,@12)                                   0157 00468000
         CLC   INARG(2,@12),@CH00034                               0157 00469000
         BNE   @RF00157                                            0157 00470000
*                                  CALL REEDSYS;           /*@Z427VLS*/ 00471000
         BAL   @14,REEDSYS                                         0158 00472000
*                                ELSE                              0159 00473000
*                                  DO;                     /*@Z427VLS*/ 00474000
         B     @RC00157                                            0159 00475000
@RF00157 DS    0H                                                  0160 00476000
*                                     MSGNO = 1;           /*@Z427VLS*/ 00477000
         MVC   MSGNO(4),@CF00056                                   0160 00478000
*                                     CALL ERRMSG;         /*@Z427VLS*/ 00479000
         BAL   @14,ERRMSG                                          0161 00480000
*                                  END;                    /*@Z427VLS*/ 00481000
*                           END;                           /*@Z427VLS*/ 00482000
@RC00157 DS    0H                                                  0164 00483000
*                       END;                               /*@Z427VLS*/ 00484000
@RC00154 DS    0H                                                  0165 00485000
*                    END;                                  /*@Z427VLS*/ 00486000
@RC00151 DS    0H                                                  0166 00487000
*                END;                                      /*@Z427VLS*/ 00488000
@RC00148 DS    0H                                                  0167 00489000
*             END;                                         /*@Z427VLS*/ 00490000
@RC00145 DS    0H                                                  0168 00491000
*          END;                                            /*@Z427VLS*/ 00492000
@RC00142 DS    0H                                                  0169 00493000
*       END;                                               /*@Z427VLS*/ 00494000
@RC00139 DS    0H                                                  0170 00495000
*GOBACK: ;                                                 /*@Z427VLS*/ 00496000
@RC00136 DS    0H                                                  0170 00497000
GOBACK   DS    0H                                                  0171 00498000
*RESPECIFY(R15) RESTRICTED;                                /*@Z427VLS*/ 00499000
*R15 = BADNEWS;                                            /*@Z427VLS*/ 00500000
         L     R15,BADNEWS                                         0172 00501000
*IF R15 > FOUR THEN /*FIND OUT IF USER CHECKING RETURN CODE  @Z427VLS*/ 00502000
         C     R15,@CF00065                                        0173 00503000
         BNH   @RF00173                                            0173 00504000
*  ERRORENT = ERRORENT + 1; /*USER BUNGLE IF MORE THAN ONE   @Z427VLS*/ 00505000
         LA    @14,1                                               0174 00506000
         AL    @14,ERRORENT                                        0174 00507000
         ST    @14,ERRORENT                                        0174 00508000
*RETURN;                                                   /*@Z427VLS*/ 00509000
@EL00001 L     @13,4(,@13)                                         0175 00510000
@EF00001 DS    0H                                                  0175 00511000
@ER00001 L     @14,12(,@13)                                        0175 00512000
         LM    @00,@06,20(@13)                                     0175 00513000
         LM    @08,@12,52(@13)                                     0175 00514000
         BR    @14                                                 0175 00515000
*     /*THIS IS A STRUCTURED PROC TO REPLACE EXCPLOOP        @G51DGBB*/ 00516000
*     /*OTHERWISE, THE ONLY CHANGES ARE THAT ALL REFERENCES  @G51DGBB*/ 00517000
*     /*TO ZEROING INDIVIDUAL RECORDS HAVE BEEN REMOVED AND  @G51DGBB*/ 00518000
*     /*THE LOCATION OF THE BEGINNING OF LOGREC FROM THE DEB @G51DGBB*/ 00519000
*     /*IS SAVED FOR INITIALIZATION TO READ FRAMES           @G51DGBB*/ 00520000
*/*EXCP LOOP THAT PERFORMS ALL IO OPERATIONS TO LOGREC. ONE CCW CHAIN*/ 00521000
*/*IS USE FOR ALL THREE TYPES OF I-O PERFORMED. IN ALL CASES, THE   */  00522000
*/*FIRST CCW  IS A SEARCH FOR A PARTICULAR MBBCCHHR ACTUAL PHYSICAL */  00523000
*/*LOCATION OF A RECORD ON LOGREC ACCROSS THE ENTIRE EXTENT ALLO-   */  00524000
*/*CATED TO LOGREC. THE NEXT CCW IS A TIC WHICH LOOPS BACK TO THE   */  00525000
*/*SEARCH IF THE SEARCH FOR A PARTICULAR RECORD WAS UNSUCCESSFUL    */  00526000
*/*THE TYPES OF OPERATIONS WHICH ARE PERFORMED ARE:          @G51DGBB*/ 00527000
*/* 1. CC= 6, READ LOGREC HEADER BY GIVING MBBCCHHR OF HEADER       */  00528000
*/* 2. CC= 5, WRITE HEADER OF SAME LENGTH BACK TO EXACT LOCATION    */  00529000
*/*           SPECIFIED IN GIVEN MBBCCHHR.                   @G51DGBB*/ 00530000
*/* 3. CC= 158, READ THE NEXT ERROR RECORD AFTER THE RECORD WHOSE   */  00531000
*/*             MBBCCHHR IS GIVEN IN THE SEARCH              @G51DGBB*/ 00532000
*/* R7 = ADDRESS OF AREA IN CORE TO PLACE THE RECORD READ    @G51DGBB*/ 00533000
*RESPECIFY (R7,R5,R12) RESTRICTED;                         /*@G51DGBB*/ 00534000
*EXCPLOOP: PROC;                                           /*@G51DGBB*/ 00535000
EXCPLOOP STM   @14,@12,@SA00002                                    0177 00536000
*CKDAREA = R7; /*SET UP CCW3 CORE ADDRESS TO READ RECORD TO  @G51DGBB*/ 00537000
         STCM  R7,7,CKDAREA                                        0178 00538000
*AREAADR = ADDR(HDRCC); /*SEARCH ID FOR FIRST CCW            @G51DGBB*/ 00539000
         LA    @14,HDRCC                                           0179 00540000
         STCM  @14,7,AREAADR                                       0179 00541000
*IF SBT4 = ON THEN     /*IF HEADER I/O HAS BEEN REQUESTED    @G51DGBB*/ 00542000
         TM    SBT4,B'00010000'                                    0180 00543000
         BNO   @RF00180                                            0180 00544000
*  DO;                                                     /*@G51DGBB*/ 00545000
*    CKDCOUNT = 40;   /*3RD CCW NUMBER OF BYTES IN HEADER TO BE READ*/  00546000
         MVC   CKDCOUNT(2),@CH00471                                0182 00547000
*    IF SBT2 = ON THEN /*IF HEADER IS TO BE WRITTEN THEN     @G51DGBB*/ 00548000
         TM    SBT2,B'01000000'                                    0183 00549000
         BNO   @RF00183                                            0183 00550000
*      CKDCOM = '05'X; /*SET 3RD CCW CHANNEL COMMAND TO WRITE IN PLACE* 00551000
         MVI   CKDCOM,X'05'                                        0184 00552000
*    ELSE              /*IF HEADER IS TO BE READ             @G51DGBB*/ 00553000
*      CKDCOM = '06'X; /*SET 3RD CCW CHANNEL COMMAND TO READ SAME */    00554000
         B     @RC00183                                            0185 00555000
@RF00183 MVI   CKDCOM,X'06'                                        0185 00556000
*                      /*RECORD AS SEARCH ID EQUAL HAS FOUND @G51DGBB*/ 00557000
*    HDRM = '00'X;                                         /*@G51DGBB*/ 00558000
@RC00183 MVI   HDRM,X'00'                                          0186 00559000
*    HDRR = '01'X;    /*HEADER RECORD IS RECORD 1            @G51DGBB*/ 00560000
         MVI   HDRR,X'01'                                          0187 00561000
*    GEN(LA R12,LOGREC); /*SET LOGREC DCB DSECT BASE ADDRESS @G51DGBB*/ 00562000
         LA R12,LOGREC                                                  00563000
*    GEN(L  R5,DCBDEBAD); /*LOAD ADDRESS OF DEB FROM DCB FOR LOGREC*/   00564000
         L  R5,DCBDEBAD                                                 00565000
*    GEN(MVC HDRBB(L6),L36(R5)); /*GET BBCCHH OF BEGINNING OF LOGREC*/  00566000
         MVC HDRBB(L6),L36(R5)                                          00567000
*      /*FROM FIRST EXTENT DIRECT ACCESS EXTENSION TO THE DEB*/    0191 00568000
*    SEEKSAVE = HDRSEEK; /*SAVE FOR USE WHEN READING FRAMES  @G51DGBB*/ 00569000
         MVC   SEEKSAVE(8),HDRSEEK                                 0191 00570000
*    SKSAVREC = '02'X; /*INDICATE TIME STAMP AS RECORD BEFORE 1ST FRM*/ 00571000
         MVI   SKSAVREC,X'02'                                      0192 00572000
*  END;                                                    /*@G51DGBB*/ 00573000
*ELSE  /*IF NORMAL, NON HEADER, READ OF LOGREC               @G51DGBB*/ 00574000
*  DO;                                                     /*@G51DGBB*/ 00575000
         B     @RC00180                                            0194 00576000
@RF00180 DS    0H                                                  0195 00577000
*    HDRSEEK = PREVSEEK; /*SET ADDRESS TO SEEK FROM COUNT FIELD OF */   00578000
         MVC   HDRSEEK(8),PREVSEEK                                 0195 00579000
*                        /*PREVIOUS RECORD                   @G51DGBB*/ 00580000
*    CKDCOM = '9E'X;  /*SET THIRD CCW CHANNEL COMMAND TO SEEK NEXT */   00581000
         MVI   CKDCOM,X'9E'                                        0196 00582000
*                     /*RECORD AFTER RECORD WHOSE SEEK ID EQUAL IS */   00583000
*                     /*FOUND AS RESULT OF CCW1. DONE FOR SPEED*/  0197 00584000
*    CKDCOUNT = 1944; /*SET NUMBER OF BYTES TO READ. INCORRECT LENGTH*/ 00585000
         MVC   CKDCOUNT(2),@CH00925                                0197 00586000
*                     /*ERRORS ARE SUPPRESSED                @G51DGBB*/ 00587000
*  END;                                                    /*@G51DGBB*/ 00588000
*XIOBSEEK = HDRSEEK; /*SET IOB SEEK ADDRESS                  @G51DGBB*/ 00589000
@RC00180 MVC   XIOBSEEK(8),HDRSEEK                                 0199 00590000
*XWRECB = 0;         /*ZERO THE EVENT CONTROL BLOCK          @G51DGBB*/ 00591000
         SLR   @14,@14                                             0200 00592000
         ST    @14,XWRECB                                          0200 00593000
*DO UNTIL POST ^= '44'X; /*LOOP UNTIL IO REQUEST NOT INTERCEPTED*/ 0201 00594000
@DL00201 DS    0H                                                  0202 00595000
*  GEN(EXCP XIOB); /*ISSUE SVC 0                             @G51DGBB*/ 00596000
         EXCP XIOB                                                      00597000
*  GEN(WAIT ECB=XWRECB); /*WAIT FOR COMPLETION OF IO         @G51DGBB*/ 00598000
         WAIT ECB=XWRECB                                                00599000
*END;                                                      /*@G51DGBB*/ 00600000
@DE00201 CLI   POST,X'44'                                          0204 00601000
         BE    @DL00201                                            0204 00602000
*RESPECIFY (R7,R5,R12) UNRESTRICTED;                       /*@G51DGBB*/ 00603000
*END;                                                      /*@G51DGBB*/ 00604000
@EL00002 DS    0H                                                  0206 00605000
@EF00002 DS    0H                                                  0206 00606000
@ER00002 LM    @14,@12,@SA00002                                    0206 00607000
         BR    @14                                                 0206 00608000
*READSER: PROC OPTIONS (DONTSAVE(7)); /*READ SYS1.LOGREC SEQUENTIALLY*/ 00609000
READSER  STM   @14,@06,@SA00003                                    0207 00610000
         STM   @08,@12,@SA00003+36                                 0207 00611000
*  /*PROC HAS BEEN REWRITTEN TO HANDLE READING OF FRAMES AT END OF   */ 00612000
*  /*OF FILE FOR ERROR RECORDS, IF FRAMES EXIST. THE PROC IS NOW     */ 00613000
*  /*STRUCTURED.                                             @G51DGBB*/ 00614000
*RESPECIFY (R7) RESTRICTED;                                /*@G51DGBB*/ 00615000
*RSEQCNT = RSEQCNT + 1; /*COUNT NUMBER OF READ ATTEMPTS      @G51DGBB*/ 00616000
         LA    @14,1                                               0209 00617000
         AL    @14,RSEQCNT                                         0209 00618000
         ST    @14,RSEQCNT                                         0209 00619000
*IF SERLO = YES THEN    /*IF SYS1.LOGREC IS OPEN THEN        @G51DGBB*/ 00620000
         TM    SERLO,B'10000000'                                   0210 00621000
         BNO   @RF00210                                            0210 00622000
*  DO;                                                     /*@G51DGBB*/ 00623000
*    IF READFR = OFF THEN /*IF READING ERROR RECORDS         @G51DGBB*/ 00624000
         TM    READFR,B'10000000'                                  0212 00625000
         BNZ   @RF00212                                            0212 00626000
*      DO;                                                 /*@G51DGBB*/ 00627000
*        IF PREVSEEK(2:8) = HDRREC2 THEN /*IF CURRENT SEEK ADDRESS IS*/ 00628000
         CLC   PREVSEEK+1(7),HDRREC2                               0214 00629000
         BNE   @RF00214                                            0214 00630000
*         /*EQUAL TO LAST ACTIVE RECORD SEEK ADDRESS, IMPLICATION IS */ 00631000
*         /*THAT THIS LAST RECORD HAS ALREADY BEEN READ      @G51DGBB*/ 00632000
*          DO;                                             /*@G51DGBB*/ 00633000
*            IF TWOTRY = NO & /*SECOND TRY FOR EOF ON SEQUENTIAL INPT*/ 00634000
*               LASTLOOP = NO THEN /*NOT AN END OF FILE SAVING OF    */ 00635000
         TM    TWOTRY,B'01000000'                                  0216 00636000
         BNZ   @RF00216                                            0216 00637000
         TM    LASTLOOP,B'00000100'                                0216 00638000
         BNZ   @RF00216                                            0216 00639000
*                                  /*RECORDS DURING ZERO ALL PROCESS*/  00640000
*              DO;                                         /*@G51DGBB*/ 00641000
*                TWOTRY = YES; /*SET SECOND SEQUENTIAL READ TRY FLAG*/  00642000
         OI    TWOTRY,B'01000000'                                  0218 00643000
*                CALL CHECKHDR; /*ANY RECORDS WRITTEN WHILE READING?*/  00644000
         BAL   @14,CHECKHDR                                        0219 00645000
*                IF BADNEWS = FOUR &    /*IF NO NEW RECORDS WRITTEN*/   00646000
*                   FRAMES  = YES THEN  /*AND FRAMES EXIST ON LOGREC*/  00647000
         CLC   BADNEWS(4),@CF00065                                 0220 00648000
         BNE   @RF00220                                            0220 00649000
         TM    FRAMES,B'00100000'                                  0220 00650000
         BNO   @RF00220                                            0220 00651000
*                  DO;                                     /*@G51DGBB*/ 00652000
*                    BADNEWS = ZERO; /*INDICATE NO END OF FILE YET*/    00653000
         SLR   @14,@14                                             0222 00654000
         ST    @14,BADNEWS                                         0222 00655000
*                    READFR = YES; /*SET READ FRAME SWITCH   @G51DGBB*/ 00656000
         OI    READFR,B'10000000'                                  0223 00657000
*                    IF DEBUG15 = ON THEN /*IF DEBUG 15 MONITORING*/    00658000
         L     @14,SAVER2                                          0224 00659000
         TM    DEBUG15(@14),B'00000001'                            0224 00660000
         BNO   @RF00224                                            0224 00661000
*                      DO;                                 /*@G51DGBB*/ 00662000
*                        MSGNO = 70; /*START OF FRAME READ MONITOR*/    00663000
         MVC   MSGNO(4),@CF00932                                   0226 00664000
*                        CALL ERRMSG; /*PRINT MESSAGE TO TOURIST*/ 0227 00665000
         BAL   @14,ERRMSG                                          0227 00666000
*                      END;                                /*@G51DGBB*/ 00667000
*                    PREVSEEK = SEEKSAVE; /*GET TIME STAMP LOCATION*/   00668000
@RF00224 MVC   PREVSEEK(8),SEEKSAVE                                0229 00669000
*                  END;                                    /*@G51DGBB*/ 00670000
*              END;                                        /*@G51DGBB*/ 00671000
*            ELSE  /*EITHER SECOND END OF FILE OR ZEROALL PROCESSING*/  00672000
*              DO;                                         /*@G51DGBB*/ 00673000
         B     @RC00216                                            0232 00674000
@RF00216 DS    0H                                                  0233 00675000
*                IF FRAMES = YES &    /*DO FRAMES EXIST ON SERLOG*/     00676000
*                   LASTLOOP = NO THEN /*NOT ZEROALL PROCESSING  */     00677000
         TM    FRAMES,B'00100000'                                  0233 00678000
         BNO   @RF00233                                            0233 00679000
         TM    LASTLOOP,B'00000100'                                0233 00680000
         BNZ   @RF00233                                            0233 00681000
*                  DO;                                     /*@G51DGBB*/ 00682000
*                    READFR = YES; /*SET READING FRAMES SWITCH*/   0235 00683000
         OI    READFR,B'10000000'                                  0235 00684000
*                    IF DEBUG15 = ON THEN /*IF DEBUG15 MONITORING*/     00685000
         L     @14,SAVER2                                          0236 00686000
         TM    DEBUG15(@14),B'00000001'                            0236 00687000
         BNO   @RF00236                                            0236 00688000
*                      DO;                                 /*@G51DGBB*/ 00689000
*                        MSGNO = 70; /*START OF FRAME READ MESSAGE*/    00690000
         MVC   MSGNO(4),@CF00932                                   0238 00691000
*                        CALL ERRMSG; /*WRITE MESSAGE TO TOURIST*/ 0239 00692000
         BAL   @14,ERRMSG                                          0239 00693000
*                      END;                                /*@G51DGBB*/ 00694000
*                    PREVSEEK = SEEKSAVE; /*GET STARTING LOCATION*/     00695000
@RF00236 MVC   PREVSEEK(8),SEEKSAVE                                0241 00696000
*                    /*OF LOGREC FROM DEB. IMPLICATION IS THAT   */     00697000
*                    /*1ST FRAME MUST BE ON SAME TRACK AS HEADER */     00698000
*                   END;                                   /*@G51DGBB*/ 00699000
*                 ELSE  /*LEGITIMATE END OF FILE             @G51DGBB*/ 00700000
*                   BADNEWS = FOUR; /*INDICATE EOF TO WORLD  @G51DGBB*/ 00701000
         B     @RC00233                                            0243 00702000
@RF00233 MVC   BADNEWS(4),@CF00065                                 0243 00703000
*               END;                                       /*@G51DGBB*/ 00704000
*           END;                                           /*@G51DGBB*/ 00705000
*      END;                                                /*@G51DGBB*/ 00706000
*    ELSE  /*FRAMES ARE BEING READ                           @G51DGBB*/ 00707000
*      DO;                                                 /*@G51DGBB*/ 00708000
         B     @RC00212                                            0247 00709000
@RF00212 DS    0H                                                  0248 00710000
*        IF PREVSEEK(2:8) = HDRREC1 THEN /*IF SEEK ADDRESS FOR */  0248 00711000
         CLC   PREVSEEK+1(7),HDRREC1                               0248 00712000
         BNE   @RF00248                                            0248 00713000
*          /*PREVIOUS RECORD IS EQUAL TO SEEK ADDRESS OF LAST FRAME*/   00714000
*          /*THEN END OF FILE ON LOGREC HAS BEEN REACHED     @G51DGBB*/ 00715000
*          BADNEWS = FOUR; /*INDICATE END OF FILE            @G51DGBB*/ 00716000
         MVC   BADNEWS(4),@CF00065                                 0249 00717000
*        ELSE  /*NOT LAST FRAME                              @G51DGBB*/ 00718000
*          RFRCOUNT = RFRCOUNT + 1; /*COUNT FRAMES FOR DEBUG16 TOTAL*/  00719000
         B     @RC00248                                            0250 00720000
@RF00248 LA    @14,1                                               0250 00721000
         AL    @14,RFRCOUNT                                        0250 00722000
         ST    @14,RFRCOUNT                                        0250 00723000
*      END;                                                /*@G51DGBB*/ 00724000
@RC00248 DS    0H                                                  0252 00725000
*    IF BADNEWS = ZERO THEN /*IF NO EOF OR ERROR CONDITIONS THEN*/ 0252 00726000
@RC00212 L     @14,BADNEWS                                         0252 00727000
         LTR   @14,@14                                             0252 00728000
         BNZ   @RF00252                                            0252 00729000
*      DO;                                                 /*@G51DGBB*/ 00730000
*        R7 = ADDR(BUF1); /*ADDRESS READ BUFFER              @G51DGBB*/ 00731000
         LA    R7,BUF1                                             0254 00732000
*        CALL EXCPLOOP; /*ISSUE EXCP READ                    @G51DGBB*/ 00733000
         BAL   @14,EXCPLOOP                                        0255 00734000
*        IF POST ^= '7F'X THEN /*IF UNSUCCESSFULL READ       @G51DGBB*/ 00735000
         CLI   POST,X'7F'                                          0256 00736000
         BE    @RF00256                                            0256 00737000
*          DO;                                             /*@G51DGBB*/ 00738000
*            IF POST = '42'X THEN /*OUT OF LOGREC EXTENT ERROR*/   0258 00739000
         CLI   POST,X'42'                                          0258 00740000
         BNE   @RF00258                                            0258 00741000
*              MSGNO = 14;                                 /*@G51DGBB*/ 00742000
         MVC   MSGNO(4),@CF00768                                   0259 00743000
*            ELSE   /* HARD I-O ERROR                        @G51DGBB*/ 00744000
*              MSGNO = 39;                                 /*@G51DGBB*/ 00745000
         B     @RC00258                                            0260 00746000
@RF00258 MVC   MSGNO(4),@CF00933                                   0260 00747000
*            CALL ERRMSG;                                  /*@G51DGBB*/ 00748000
@RC00258 BAL   @14,ERRMSG                                          0261 00749000
*            BADNEWS = TWELVE;                             /*@G51DGBB*/ 00750000
         MVC   BADNEWS(4),@CF00068                                 0262 00751000
*          END;                                            /*@G51DGBB*/ 00752000
*        ELSE /*SUCCESSFUL READ                              @G51DGBB*/ 00753000
*          DO;                                             /*@G51DGBB*/ 00754000
         B     @RC00256                                            0264 00755000
@RF00256 DS    0H                                                  0265 00756000
*            PREVCC(1:5) = BCOUNT; /*DIRECT ACCESS ADDRESS,CCHHR,*/     00757000
         MVC   PREVCC(5),BCOUNT                                    0265 00758000
*           /*OF RECORD LAST READ FROM COUNT RECORD PRECEEDING DATA*/   00759000
*           /*RECORD ON COUNT,DATA FORMATTED DIRECT ACCESS FILE*/  0266 00760000
*            FLIPFLOP = NO; /*INDICATE SEQUENTIAL INPUT FROM LOGREC,*/  00761000
         NI    FLIPFLOP,B'11011111'                                0266 00762000
*                           /* AND NOT FROM HISTORY INPUT    @G51DGBB*/ 00763000
*            RECCCHHR = BCOUNT; /*PASS SAME VALUE TO USER VIA PARM*/    00764000
         L     @14,SAVER2                                          0267 00765000
         MVC   RECCCHHR(5,@14),BCOUNT                              0267 00766000
*            RECLNGTH = BSIZE; /*PASS RECORD LENGTH FROM COUNT RECRD*/  00767000
         LH    @12,BSIZE                                           0268 00768000
         N     @12,@CF01180                                        0268 00769000
         STH   @12,RECLNGTH(,@14)                                  0268 00770000
*            SAVELENT = BSIZE + 4; /*SAVE RECORD QSAM LENGTH FOR */     00771000
         LA    @12,4(,@12)                                         0269 00772000
         STH   @12,SAVELENT                                        0269 00773000
*                                  /*RITESCRT,RITEHIST       @G51DGBB*/ 00774000
*            R7 = ADDR(BDATA); /*BKEY IS DATA PORTION OF RECORD SINCE*/ 00775000
         LA    R7,BDATA                                            0270 00776000
*            TIMEBASE = R7; /*TELL TIME CONVERSION WHERE RECORD IS*/    00777000
         ST    R7,TIMEBASE                                         0271 00778000
*            CALL CONVTIME; /*CONVERT TIME, IF NECESSARY     @G51DGBB*/ 00779000
         BAL   @14,CONVTIME                                        0272 00780000
*          END;                                            /*@G51DGBB*/ 00781000
*      END;                                                /*@G51DGBB*/ 00782000
*  END;                                                    /*@G51DGBB*/ 00783000
*ELSE /*IF LOGREC HAS NOT BEEN OPENED                        @G51DGBB*/ 00784000
*  DO;                                                     /*@G51DGBB*/ 00785000
         B     @RC00210                                            0276 00786000
@RF00210 DS    0H                                                  0277 00787000
*    MSGNO = 47;                                           /*@G51DGBB*/ 00788000
         MVC   MSGNO(4),@CF00935                                   0277 00789000
*    CALL ERRMSG;                                          /*@G51DGBB*/ 00790000
         BAL   @14,ERRMSG                                          0278 00791000
*    BADNEWS = TWELVE;                                     /*@G51DGBB*/ 00792000
         MVC   BADNEWS(4),@CF00068                                 0279 00793000
*  END;                                                    /*@G51DGBB*/ 00794000
*END; /*END OF PROC READSER                                  @G51DGBB*/ 00795000
@EL00003 DS    0H                                                  0281 00796000
@EF00003 DS    0H                                                  0281 00797000
@ER00003 LM    @14,@06,@SA00003                                    0281 00798000
         LM    @08,@12,@SA00003+36                                 0281 00799000
         BR    @14                                                 0281 00800000
*DIRRDSER: PROC OPTIONS(DONTSAVE(R7)); /*READ SERLOG DIRECTLY*/    0282 00801000
DIRRDSER STM   @14,@06,@SA00004                                    0282 00802000
         STM   @08,@12,@SA00004+36                                 0282 00803000
*RESPECIFY (R7) RESTRICTED;                                /*@Z427VLS*/ 00804000
*IF SERLO = YES THEN /*DO ONLY IF SERLOG IS OPEN             @Z427VLS*/ 00805000
         TM    SERLO,B'10000000'                                   0284 00806000
         BNO   @RF00284                                            0284 00807000
*  DO;                                                     /*@Z427VLS*/ 00808000
*    RSERDCNT = RSERDCNT + 1; /*COUNT NUMBER OF READ ATTEMPTS*/    0286 00809000
         LA    @14,1                                               0286 00810000
         AL    @14,RSERDCNT                                        0286 00811000
         ST    @14,RSERDCNT                                        0286 00812000
*    PREVCC(1:5) = RECCCHHR;                               /*@Z427VLS*/ 00813000
         L     @14,SAVER2                                          0287 00814000
         MVC   PREVCC(5),RECCCHHR(@14)                             0287 00815000
*    R7 = ADDR(BUF1);                                      /*@Z427VLS*/ 00816000
         LA    R7,BUF1                                             0288 00817000
*    PREVR = PREVR - 1;                                    /*@Z427VLS*/ 00818000
         SLR   @14,@14                                             0289 00819000
         IC    @14,PREVR                                           0289 00820000
         BCTR  @14,0                                               0289 00821000
         STC   @14,PREVR                                           0289 00822000
*    CALL EXCPLOOP;                                        /*@Z427VLS*/ 00823000
         BAL   @14,EXCPLOOP                                        0290 00824000
*    IF POST ^= '7F'X THEN                                         0291 00825000
         CLI   POST,X'7F'                                          0291 00826000
         BE    @RF00291                                            0291 00827000
*      DO;                                                 /*@Z427VLS*/ 00828000
*        MSGNO = 25;                                       /*@Z427VLS*/ 00829000
         MVC   MSGNO(4),@CF00940                                   0293 00830000
*        CALL ERRMSG;                                      /*@Z427VLS*/ 00831000
         BAL   @14,ERRMSG                                          0294 00832000
*        BADNEWS = TWELVE;                                 /*@Z427VLS*/ 00833000
         MVC   BADNEWS(4),@CF00068                                 0295 00834000
*        RETURN;                                           /*@Z427VLS*/ 00835000
@EL00004 DS    0H                                                  0296 00836000
@EF00004 DS    0H                                                  0296 00837000
@ER00004 LM    @14,@06,@SA00004                                    0296 00838000
         LM    @08,@12,@SA00004+36                                 0296 00839000
         BR    @14                                                 0296 00840000
*      END;                                                /*@Z427VLS*/ 00841000
*     PREVCC(1:5) = BCOUNT;                                /*@Z427VLS*/ 00842000
@RF00291 MVC   PREVCC(5),BCOUNT                                    0298 00843000
*     RECLNGTH = BSZ;                                      /*@Z427VLS*/ 00844000
         LH    @14,BSZ                                             0299 00845000
         L     @12,SAVER2                                          0299 00846000
         STH   @14,RECLNGTH(,@12)                                  0299 00847000
*     R7 = ADDR(BDATA);                                    /*@G51DGBB*/ 00848000
         LA    R7,BDATA                                            0300 00849000
*     TIMEBASE = R7;                                       /*@Z427VLS*/ 00850000
         ST    R7,TIMEBASE                                         0301 00851000
*     CALL CONVTIME;                                       /*@Z427VLS*/ 00852000
         BAL   @14,CONVTIME                                        0302 00853000
*  END;                                                    /*@Z427VLS*/ 00854000
*ELSE /*SERLOG NOT OPEN                                      @Z427VLS*/ 00855000
*  DO;                                                     /*@Z427VLS*/ 00856000
         B     @RC00284                                            0304 00857000
@RF00284 DS    0H                                                  0305 00858000
*    MSGNO = 47;                                           /*@Z427VLS*/ 00859000
         MVC   MSGNO(4),@CF00935                                   0305 00860000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 00861000
         BAL   @14,ERRMSG                                          0306 00862000
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/ 00863000
         MVC   BADNEWS(4),@CF00068                                 0307 00864000
*  END;                                                    /*@Z427VLS*/ 00865000
*RESPECIFY (R7) UNRESTRICTED;                              /*@Z427VLS*/ 00866000
*END; /*CLOSING END TO DIRRDSER PROC                         @Z427VLS*/ 00867000
         B     @EL00004                                            0310 00868000
*/********************************************************************/ 00869000
*/*                                                          @Z427VLS*/ 00870000
*/*      RESET HEADER TO INDICATE AN EMPTY DATA SET          @Z427VLS*/ 00871000
*/*                                                          @Z427VLS*/ 00872000
*/********************************************************************/ 00873000
*RESETHDR: PROC;                                           /*@Z427VLS*/ 00874000
RESETHDR STM   @14,@12,@SA00005                                    0311 00875000
*RESPECIFY (R7,R6) RESTRICTED;                             /*@Z427VLS*/ 00876000
*        IF DEBUG15 = ON THEN                                      0313 00877000
         L     @14,SAVER2                                          0313 00878000
         TM    DEBUG15(@14),B'00000001'                            0313 00879000
         BNO   @RF00313                                            0313 00880000
*          DO; /*PRINT TO TOURIST ATTEMPT TO RESET HEADER    @Z427VLS*/ 00881000
*            MSGNO = 55;                                   /*@Z427VLS*/ 00882000
         MVC   MSGNO(4),@CF00945                                   0315 00883000
*            CALL ERRMSG;                                  /*@Z427VLS*/ 00884000
         BAL   @14,ERRMSG                                          0316 00885000
*          END;                                            /*@Z427VLS*/ 00886000
*        R7=ADDR(HEADER);               /* POINT TO HEADER AREA      */ 00887000
@RF00313 LA    R7,HEADER                                           0318 00888000
*        SBT2='1'B;                     /* SET HEADER & WRITE        */ 00889000
*        SBT4='1'B;                     /* SWITCHES ON       @Z427VLS*/ 00890000
         OI    SBT2,B'01010000'                                    0320 00891000
*        HDRREC2=HDRREC1;               /* RESET LAST REC WRITTEN    */ 00892000
         MVC   HDRREC2(7),HDRREC1                                  0321 00893000
*        R6=HDRTYPE;                    /* PICK UP DEV TYPE  @Z427VLS*/ 00894000
         SLR   R6,R6                                               0322 00895000
         IC    R6,HDRTYPE                                          0322 00896000
*        GEN(SLL   R6,L1);              /* MULTIPLY BY 2     @Z427VLS*/ 00897000
         SLL   R6,L1                                                    00898000
*        GEN(LA    R6,BYTESREM(R6));    /* INDEX INTO TABLE  @Z427VLS*/ 00899000
         LA    R6,BYTESREM(R6)                                          00900000
*        GEN(MVC   HDRREM(L2),L0(R6));  /* MOVE BYTES REM TO FLD     */ 00901000
         MVC   HDRREM(L2),L0(R6)                                        00902000
*       IF FRAMES = YES THEN /*IF FRAMES TO BE SAVED FOR MERIDIAN*/     00903000
         TM    FRAMES,B'00100000'                                  0326 00904000
         BNO   @RF00326                                            0326 00905000
*         HDRREM = 20; /*DONT LET RECORDS ON LAST FRAME TRACK*/    0327 00906000
         MVC   HDRREM(2),@CH00671                                  0327 00907000
*        HDRWNGBT='0'B;                 /* TURN OFF EARLY WARN SWITCH*/ 00908000
@RF00326 NI    HDRWNGBT,B'01111111'                                0328 00909000
*        HDRCOUNT = '00'X;             /* RESET THE MSG FIELD */   0329 00910000
         MVI   HDRCOUNT,X'00'                                      0329 00911000
*        CALL EXCPLOOP;                                    /*@Z427VLS*/ 00912000
         BAL   @14,EXCPLOOP                                        0330 00913000
*        IF POST^='7F'X THEN            /* TEST FOR NORMAL   @Z427VLS*/ 00914000
         CLI   POST,X'7F'                                          0331 00915000
         BE    @RF00331                                            0331 00916000
*          DO;                                             /*@Z427VLS*/ 00917000
*            MSGNO = 48;                                   /*@Z427VLS*/ 00918000
         MVC   MSGNO(4),@CF00946                                   0333 00919000
*            CALL ERRMSG;                                  /*@Z427VLS*/ 00920000
         BAL   @14,ERRMSG                                          0334 00921000
*            BADNEWS = TWELVE;                             /*@Z427VLS*/ 00922000
         MVC   BADNEWS(4),@CF00068                                 0335 00923000
*            R2 = SAVER2;    /*INSURE COMTBL ADDR. BY R2     @ZA31549*/ 00924000
         L     @14,SAVER2                                          0336 00925000
         LR    R2,@14                                              0336 00926000
*            CALL IFCMSG(201,ADDR(PRNTBF));                /*@Z427VLS*/ 00927000
         LA    @12,PRNTBF                                          0337 00928000
         ST    @12,@AFTEMPS                                        0337 00929000
         L     @15,ADIFCMSG(,@14)                                  0337 00930000
         LA    @01,@AL00337                                        0337 00931000
         BALR  @14,@15                                             0337 00932000
*            RETURN;                                       /*@Z427VLS*/ 00933000
@EL00005 DS    0H                                                  0338 00934000
@EF00005 DS    0H                                                  0338 00935000
@ER00005 LM    @14,@12,@SA00005                                    0338 00936000
         BR    @14                                                 0338 00937000
*          END;                                            /*@Z427VLS*/ 00938000
*RESPECIFY (R7,R6)  UNRESTRICTED;                          /*@Z427VLS*/ 00939000
*END; /*CLOSING END TO PROC RESETHDR                         @Z427VLS*/ 00940000
         B     @EL00005                                            0341 00941000
*/********************************************************************/ 00942000
*/*                                                          @Z427VLS*/ 00943000
*/*      OPEN  SYS1.LOGREC                                   @Z427VLS*/ 00944000
*/*                                                          @Z427VLS*/ 00945000
*/********************************************************************/ 00946000
*OPENSERL: PROC;                                           /*@Z427VLS*/ 00947000
OPENSERL STM   @14,@12,@SA00006                                    0342 00948000
*RESPECIFY(R1,R0,R7,R12) RESTRICTED;                       /*@Z427VLS*/ 00949000
*IF DEBUG15 = ON THEN                                              0344 00950000
         L     @14,SAVER2                                          0344 00951000
         TM    DEBUG15(@14),B'00000001'                            0344 00952000
         BNO   @RF00344                                            0344 00953000
*  DO;                                                     /*@Z427VLS*/ 00954000
*    MSGNO = 53;                                           /*@Z427VLS*/ 00955000
         MVC   MSGNO(4),@CF00952                                   0346 00956000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 00957000
         BAL   @14,ERRMSG                                          0347 00958000
*  END;                                                    /*@Z427VLS*/ 00959000
*GENERATE;                                                 /*@Z427VLS*/ 00960000
@RF00344 DS    0H                                                  0349 00961000
         LA    R1,LOGREC                                                00962000
         ST    R1,XIOBDCB                                               00963000
*IF SERLO = YES THEN /*IF SERLOG ALREADY OPEN THEN           @Z427VLS*/ 00964000
         TM    SERLO,B'10000000'                                   0350 00965000
         BNO   @RF00350                                            0350 00966000
*  DO;                                                     /*@Z427VLS*/ 00967000
*    MSGNO = 41;                                           /*@Z427VLS*/ 00968000
         MVC   MSGNO(4),@CF00953                                   0352 00969000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 00970000
         BAL   @14,ERRMSG                                          0353 00971000
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/ 00972000
         MVC   BADNEWS(4),@CF00068                                 0354 00973000
*    RETURN;                                               /*@Z427VLS*/ 00974000
@EL00006 DS    0H                                                  0355 00975000
@EF00006 DS    0H                                                  0355 00976000
@ER00006 LM    @14,@12,@SA00006                                    0355 00977000
         BR    @14                                                 0355 00978000
*  END;                                                    /*@Z427VLS*/ 00979000
*/*                                                          @Z427VLS*/ 00980000
*/*      BLOCK  GENERATE TO INTERFACE WITH SYSTEM MACROS & CONTROL   */ 00981000
*/*                                                          @Z427VLS*/ 00982000
*ZEROA = (ZEROA && ZEROA); /*CLEAR FIELD                     @Z427VLS*/ 00983000
@RF00350 XC    ZEROA(24),ZEROA                                     0357 00984000
*IF NOSDR = NO THEN /*IF USER WANTS SDR COUNTERS DUMPED      @Z427VLS*/ 00985000
         L     @14,SAVER2                                          0358 00986000
         TM    NOSDR(@14),B'00000001'                              0358 00987000
         BNZ   @RF00358                                            0358 00988000
*DO;                                                       /*@Z427VLS*/ 00989000
*GENERATE;                                                 /*@Z427VLS*/ 00990000
         LA    R0,4                     CODE TO DUMP SDR'S              00991000
         SVC   76                       ISSUE SVC TO DUMP SDR'S         00992000
*END;                                                      /*@Z427VLS*/ 00993000
*GENERATE;                                                 /*@Z427VLS*/ 00994000
@RF00358 DS    0H                                                  0362 00995000
         ENQ   (RESID,LOGRECA,E,11,STEP) ENQ TO PREVENT OTHER ACCESS    00996000
         OPEN  (LOGREC,(OUTPUT))         FROM ANOTHER IFCEREP0 TASK     00997000
         LA    R12,LOGREC               PICK UP ADDR FOR DSECT BASE     00998000
         TM    DCBOFLGS,OPENOK          DID OPEN GO OK                  00999000
         BZ    BADOPENA                 BR-NO BAD OPEN                  01000000
*        SERLO = YES;                   /* TURN ON OPEN DISK IND     */ 01001000
         OI    SERLO,B'10000000'                                   0363 01002000
*        SBT4='1'B;                     /* TURN ON HDR READ SW       */ 01003000
         OI    SBT4,B'00010000'                                    0364 01004000
*        R7=ADDR(HEADER);               /* POINT TO HEADER AREA      */ 01005000
         LA    R7,HEADER                                           0365 01006000
*        CALL EXCPLOOP;                 /* GO DO I/O TO READ HDR     */ 01007000
         BAL   @14,EXCPLOOP                                        0366 01008000
*        SBT4='0'B;                     /* TURN OFF HDR READ SW      */ 01009000
         NI    SBT4,B'11101111'                                    0367 01010000
*        IF POST^='7F'X                 /* TEST FOR NORMAL   @Z427VLS*/ 01011000
*              THEN                     /* RETURN FROM I/O   @Z427VLS*/ 01012000
         CLI   POST,X'7F'                                          0368 01013000
         BNE   @RT00368                                            0368 01014000
*                   GOTO HDRERR0;       /* IF NOT GOTO ERROR EXIT    */ 01015000
*        IF HDRSAFE^='FF'X              /* TEST FOR SAFETY BYTE      */ 01016000
*              THEN                     /* IN HEADER RECORD  @Z427VLS*/ 01017000
         CLI   HDRSAFE,X'FF'                                       0370 01018000
         BNE   @RT00370                                            0370 01019000
*                   GOTO HDRERR1;       /* IF NOT TAKE ERROR EXIT    */ 01020000
*        GENERATE;                                         /*@Z427VLS*/ 01021000
         MVC   DCBFDAD+L3(L4),HDRECC    SET DCB HIGH EXTENT FIELD       01022000
         XC    DCBTRBAL(L2),DCBTRBAL    ZERO THE TRACK BALANCE FIELD    01023000
L3       EQU   3                                                        01024000
*PREVSEEK(2:8) = HDRREC1; /*SET START SEEK AT LAST FRAME LOCATION*/     01025000
         MVC   PREVSEEK+1(7),HDRREC1                               0373 01026000
*PREVM = '00'X; /*INDICATE DATA SET OPEN                     @G51DGBB*/ 01027000
         MVI   PREVM,X'00'                                         0374 01028000
*        RETURN;                        /* TAKE NORMAL EXIT  @Z427VLS*/ 01029000
         B     @EL00006                                            0375 01030000
*HDRERR0:     ;                                            /*@Z427VLS*/ 01031000
HDRERR0  DS    0H                                                  0377 01032000
*        IF POST='42'X                  /* TEST FOR OUT OF EXTENT    */ 01033000
*              THEN                     /* IF YES            @Z427VLS*/ 01034000
         CLI   POST,X'42'                                          0377 01035000
         BNE   @RF00377                                            0377 01036000
*                MSGNO = 14;                               /*@Z427VLS*/ 01037000
         MVC   MSGNO(4),@CF00768                                   0378 01038000
*              ELSE                                                0379 01039000
*                MSGNO = 15;                               /*@Z427VLS*/ 01040000
         B     @RC00377                                            0379 01041000
@RF00377 MVC   MSGNO(4),@CF00036                                   0379 01042000
*         CALL ERRMSG;                                     /*@Z427VLS*/ 01043000
@RC00377 BAL   @14,ERRMSG                                          0380 01044000
*         BADNEWS = TWELVE;                                /*@Z427VLS*/ 01045000
         MVC   BADNEWS(4),@CF00068                                 0381 01046000
*         RETURN;                                          /*@Z427VLS*/ 01047000
         B     @EL00006                                            0382 01048000
*HDRERR1:     ;                                            /*@Z427VLS*/ 01049000
HDRERR1  DS    0H                                                  0384 01050000
*      MSGNO = 16;                                         /*@Z427VLS*/ 01051000
         MVC   MSGNO(4),@CF00089                                   0384 01052000
*      CALL ERRMSG;                                        /*@Z427VLS*/ 01053000
         BAL   @14,ERRMSG                                          0385 01054000
*      BADNEWS = TWELVE;                                   /*@Z427VLS*/ 01055000
         MVC   BADNEWS(4),@CF00068                                 0386 01056000
*RESPECIFY (R1,R0,R7,R12) UNRESTRICTED;                    /*@Z427VLS*/ 01057000
*END; /*CLOSING END TO PROC OPENSERL, OPEN SERLOG DATA SET   @Z427VLS*/ 01058000
         B     @EL00006                                            0388 01059000
*/********************************************************************/ 01060000
*/*                                                          @Z427VLS*/ 01061000
*/*      CHECK HEADER FOR MORE RECORDS WRITTEN WHILE PROCESSING      */ 01062000
*/*                                                          @Z427VLS*/ 01063000
*/********************************************************************/ 01064000
*CHECKHDR: PROC;                                           /*@Z427VLS*/ 01065000
CHECKHDR STM   @14,@12,@SA00007                                    0389 01066000
*RESPECIFY(R1,R4,R7) RESTRICTED;                           /*@Z427VLS*/ 01067000
*        IF DEBUG15 = ON THEN                                      0391 01068000
         L     @14,SAVER2                                          0391 01069000
         TM    DEBUG15(@14),B'00000001'                            0391 01070000
         BNO   @RF00391                                            0391 01071000
*          DO;                                             /*@Z427VLS*/ 01072000
*            MSGNO = 54;                                   /*@Z427VLS*/ 01073000
         MVC   MSGNO(4),@CF00961                                   0393 01074000
*            CALL ERRMSG;                                  /*@Z427VLS*/ 01075000
         BAL   @14,ERRMSG                                          0394 01076000
*          END;                                            /*@Z427VLS*/ 01077000
*        IF SERLO = NO THEN             /* TEST FOR DISK OPEN        */ 01078000
@RF00391 TM    SERLO,B'10000000'                                   0396 01079000
         BNZ   @RF00396                                            0396 01080000
*          DO;                                             /*@Z427VLS*/ 01081000
*            MSGNO = 49;                                   /*@Z427VLS*/ 01082000
         MVC   MSGNO(4),@CF00962                                   0398 01083000
*            CALL ERRMSG;                                  /*@Z427VLS*/ 01084000
         BAL   @14,ERRMSG                                          0399 01085000
*            BADNEWS = TWELVE;                             /*@Z427VLS*/ 01086000
         MVC   BADNEWS(4),@CF00068                                 0400 01087000
*            RETURN;                                       /*@Z427VLS*/ 01088000
@EL00007 DS    0H                                                  0401 01089000
@EF00007 DS    0H                                                  0401 01090000
@ER00007 LM    @14,@12,@SA00007                                    0401 01091000
         BR    @14                                                 0401 01092000
*          END;                                            /*@Z427VLS*/ 01093000
*        GEN(GETMAIN R,LV=40);          /* GET STORAGE TO HOLD HEADER*/ 01094000
@RF00396 DS    0H                                                  0403 01095000
         GETMAIN R,LV=40                                                01096000
*        R4=R1;                         /* SET BASE FOR OLD HEADER   */ 01097000
         LR    R4,R1                                               0404 01098000
*        OHEADER=HEADER;                /* MOVE HEADER TO GOTTEN CORE*/ 01099000
         MVC   OHEADER(40,R4),HEADER                               0405 01100000
*        R7=ADDR(HEADER);               /* POINT TO BUFF FOR READ    */ 01101000
         LA    R7,HEADER                                           0406 01102000
*        SBT4='1'B;                     /* TURN ON READ HEADER       */ 01103000
         OI    SBT4,B'00010000'                                    0407 01104000
*        IF LASTLOOP = YES THEN /*DONT ENQUEUE EXCEPT FOR ZEROALL PRO*/ 01105000
         TM    LASTLOOP,B'00000100'                                0408 01106000
         BNO   @RF00408                                            0408 01107000
*        DO; /*CESSING. MAYBE EXTRA RECORD WRITTEN AT EOF FOR READSEQ*/ 01108000
*        SBT7='1'B;                     /* TURN ON INTERNAL ENQ SW   */ 01109000
         OI    SBT7,B'00001000'                                    0410 01110000
*        GEN(ENQ  (RESIDII,LOGRECB,E,8,SYSTEM));           /*@Z427VLS*/ 01111000
         ENQ  (RESIDII,LOGRECB,E,8,SYSTEM)                              01112000
*        END;                                              /*@Z427VLS*/ 01113000
*        CALL EXCPLOOP;                 /* GO DO I/O READ HEADER     */ 01114000
@RF00408 BAL   @14,EXCPLOOP                                        0413 01115000
*CHK01  :     ;                                            /*@Z427VLS*/ 01116000
CHK01    DS    0H                                                  0415 01117000
*        IF POST^='7F'X                 /* TEST POST CODE FOR NORMAL */ 01118000
*              THEN                     /* RETURN IF NOT     @Z427VLS*/ 01119000
         CLI   POST,X'7F'                                          0415 01120000
         BNE   @RT00415                                            0415 01121000
*                   GOTO CHK03;         /* TAKE ERROR EXIT   @Z427VLS*/ 01122000
*        IF HDRSAFE^='FF'X              /* TEST HDR REC JUST READ FOR*/ 01123000
*              THEN                     /* SAFETY BYTE       @Z427VLS*/ 01124000
         CLI   HDRSAFE,X'FF'                                       0417 01125000
         BNE   @RT00417                                            0417 01126000
*                   GOTO CHK04;         /* IF NOT FF TAKE ERR EXIT   */ 01127000
*        IF HDRREC2=OHDRREC2            /* TEST LAST REC WRITTEN FLDS*/ 01128000
*              THEN                     /* IF THEY MATCH     @Z427VLS*/ 01129000
         CLC   HDRREC2(7),OHDRREC2(R4)                             0419 01130000
         BNE   @RF00419                                            0419 01131000
*                   DO;                 /* THEN              @Z427VLS*/ 01132000
*                        BADNEWS = FOUR; /*INDICATE REAL END OF FILE */ 01133000
         MVC   BADNEWS(4),@CF00065                                 0421 01134000
*                        GOTO CHK02;    /* GO ON             @Z427VLS*/ 01135000
         B     CHK02                                               0422 01136000
*                   END;                                   /*@Z427VLS*/ 01137000
*        PREVSEEK(2:8)=OHDRREC2  ;                          /*YM01498*/ 01138000
@RF00419 MVC   PREVSEEK+1(7),OHDRREC2(R4)                          0424 01139000
*CHK02  :     ;                                            /*@Z427VLS*/ 01140000
CHK02    DS    0H                                                  0426 01141000
*        SBT4='0'B;                     /* TURN OF HEADER SW @Z427VLS*/ 01142000
         NI    SBT4,B'11101111'                                    0426 01143000
*        R1=R4;                         /* SET R1 FOR FREE MAIN      */ 01144000
         LR    R1,R4                                               0427 01145000
*        GEN(FREEMAIN R,LV=40,A=(1));   /* FREE MAIN OF GOTTEN CORE  */ 01146000
         FREEMAIN R,LV=40,A=(1)                                         01147000
*          RETURN; /*GO BACK TO CALLER                       @Z427VLS*/ 01148000
         B     @EL00007                                            0429 01149000
*CHK03  :     ;                                            /*@Z427VLS*/ 01150000
CHK03    DS    0H                                                  0431 01151000
*        IF POST = '42'X THEN /*42 MEANS OUT OF EXTENT       @Z427VLS*/ 01152000
         CLI   POST,X'42'                                          0431 01153000
         BNE   @RF00431                                            0431 01154000
*          MSGNO = 14;                                     /*@Z427VLS*/ 01155000
         MVC   MSGNO(4),@CF00768                                   0432 01156000
*        ELSE                                                      0433 01157000
*          MSGNO = 15;   /*NOT 42 MEANS IO ERROR             @Z427VLS*/ 01158000
         B     @RC00431                                            0433 01159000
@RF00431 MVC   MSGNO(4),@CF00036                                   0433 01160000
*        CALL ERRMSG;                                      /*@Z427VLS*/ 01161000
@RC00431 BAL   @14,ERRMSG                                          0434 01162000
*        BADNEWS = TWELVE;                                 /*@Z427VLS*/ 01163000
         MVC   BADNEWS(4),@CF00068                                 0435 01164000
*        GOTO  CHK02;     /*GO BACK TO FREE EXCESS CORE      @Z427VLS*/ 01165000
         B     CHK02                                               0436 01166000
*CHK04  :     ;                                            /*@Z427VLS*/ 01167000
CHK04    DS    0H                                                  0438 01168000
*        MSGNO = 16; /*HEADER CHECK BYTE BAD                 @Z427VLS*/ 01169000
         MVC   MSGNO(4),@CF00089                                   0438 01170000
*        CALL ERRMSG;                                      /*@Z427VLS*/ 01171000
         BAL   @14,ERRMSG                                          0439 01172000
*        BADNEWS = TWELVE;                                 /*@Z427VLS*/ 01173000
         MVC   BADNEWS(4),@CF00068                                 0440 01174000
*        GOTO CHK02;                     /*GO BACK TO DEQ    @Z427VLS*/ 01175000
         B     CHK02                                               0441 01176000
*RESPECIFY(R1,R4,R7) UNRESTRICTED;                         /*@Z427VLS*/ 01177000
*END; /*CLOSING END TO PROC CHECK HEADER                     @Z427VLS*/ 01178000
*/********************************************************************/ 01179000
*/*                                                          @Z427VLS*/ 01180000
*/*      CONVERT TIME ROUTINE                                @Z427VLS*/ 01181000
*/*                                                          @Z427VLS*/ 01182000
*/********************************************************************/ 01183000
*CONVTIME: PROC;                                           /*@Z427VLS*/ 01184000
CONVTIME STM   @14,@12,@SA00008                                    0444 01185000
*RESPECIFY(R3,R4,R5,R6,R7) RESTRICTED;                     /*@Z427VLS*/ 01186000
*        R7SAVE = R7;  /*SAVE RECORD ADDRESS                 @Z427VLS*/ 01187000
         ST    R7,R7SAVE                                           0446 01188000
*        IF LCSWITCH='1'B               /*  HAS TIME BEEN CONVERTED  */ 01189000
*              THEN                     /*  OR IS IT IN PROPER FORM  */ 01190000
         L     @14,TIMEBASE                                        0447 01191000
         TM    LCSWITCH(@14),B'00001000'                           0447 01192000
         BO    @RT00447                                            0447 01193000
*                   RETURN;               /*  YES EXIT TO CALLER   */   01194000
*        CONVTCT = CONVTCT + 1;         /*NUMBER OF CONVERSIONS DONE*/  01195000
         LA    @14,1                                               0449 01196000
         AL    @14,CONVTCT                                         0449 01197000
         ST    @14,CONVTCT                                         0449 01198000
*/********************************************************************/ 01199000
*/*      NEW SYSTEM - TO YYDDD & HHMMSS                      @Z427VLS*/ 01200000
*/********************************************************************/ 01201000
*CONVNS :     ;                                            /*@Z427VLS*/ 01202000
CONVNS   DS    0H                                                  0451 01203000
*        WORK8=DATETIME;                /* MOVE DATE & TIME TO WORK  */ 01204000
         L     @14,TIMEBASE                                        0451 01205000
         MVC   WORK8(8),DATETIME(@14)                              0451 01206000
*        NSSWITCH='0'B;                 /* TURN OFF NS SWITCH        */ 01207000
*        LCSWITCH='1'B ;                /* TURN ON LOCAL SW  @Z427VLS*/ 01208000
         OI    LCSWITCH(@14),B'00001000'                           0453 01209000
         NI    NSSWITCH(@14),B'10111111'                           0453 01210000
*        IF WORK=0 &                    /* TEST FOR          @Z427VLS*/ 01211000
*           WORKB=0                     /* ZERO FIELD        @Z427VLS*/ 01212000
*              THEN                     /* IF YES EXIT TO CALLER     */ 01213000
         SLR   @14,@14                                             0454 01214000
         C     @14,WORK                                            0454 01215000
         BNE   @RF00454                                            0454 01216000
         C     @14,WORKB                                           0454 01217000
         BNE   @RF00454                                            0454 01218000
*                DO;                                       /*@Z427VLS*/ 01219000
*                  R7 = R7SAVE;                            /*@Z427VLS*/ 01220000
         L     R7,R7SAVE                                           0456 01221000
*                   RETURN;                                /*@Z427VLS*/ 01222000
@EL00008 DS    0H                                                  0457 01223000
@EF00008 DS    0H                                                  0457 01224000
@ER00008 LM    @14,@12,@SA00008                                    0457 01225000
         BR    @14                                                 0457 01226000
*                END;                                      /*@Z427VLS*/ 01227000
*        R4=WORK ;                      /* PICK UP DATE/TIME @Z427VLS*/ 01228000
@RF00454 L     R4,WORK                                             0459 01229000
*        R5=WORKB;                      /* INTO WORK REGS    @Z427VLS*/ 01230000
         L     R5,WORKB                                            0460 01231000
*        GEN(SRDL  R4,L12);             /* CONVERT FROM NANO TO MICRO*/ 01232000
         SRDL  R4,L12                                                   01233000
*        GEN(D     R4,SIXTYMIL);        /* DIVIDE TO GET # OF MINUTES*/ 01234000
         D     R4,SIXTYMIL                                              01235000
*        R6=0 ;                         /*                   @Z427VLS*/ 01236000
         SLR   R6,R6                                               0463 01237000
*        R7=R4;                         /* MOVE REMAINDER TO OTHER RG*/ 01238000
         LR    R7,R4                                               0464 01239000
*        GEN(D    R6,MILLION);          /* DIVIDE TO GET SECONDS     */ 01240000
         D    R6,MILLION                                                01241000
*        GEN(CVD   R7,WORK8);           /* CONVERT # OF SECONDS      */ 01242000
         CVD   R7,WORK8                                                 01243000
*        R4=WORKB;                      /* PICK IT UP TO WORK REG    */ 01244000
         L     R4,WORKB                                            0467 01245000
*        SRL(R4,FOUR);                  /* MOVE IT TO HI ORDER       */ 01246000
         SRL   R4,4                                                0468 01247000
*        SECS=R4;                       /* PUT BYTE INTO RECORD      */ 01248000
         L     @14,TIMEBASE                                        0469 01249000
         STC   R4,SECS(,@14)                                       0469 01250000
*        R4=0 ;                         /*                   @Z427VLS*/ 01251000
         SLR   R4,R4                                               0470 01252000
*        R7=R6 ;                                            /*YM6362*/  01253000
         LR    R7,R6                                               0471 01254000
*        R6= 0 ;                                            /*YM6362*/  01255000
         SLR   R6,R6                                               0472 01256000
*        GEN( D  R6,THCONV);                                /*YM6362*/  01257000
          D  R6,THCONV                                                  01258000
*        GEN( CVD R7,WORK8) ;                               /*YM6362*/  01259000
          CVD R7,WORK8                                                  01260000
*        R6=WORKB ;                                         /*YM6362*/  01261000
         L     R6,WORKB                                            0475 01262000
*        SRL (R6,FOUR);                                    /*@Z427VLS*/ 01263000
         SRL   R6,4                                                0476 01264000
*        TNTHS=R6 ;                                         /*YM6362*/  01265000
         L     @14,TIMEBASE                                        0477 01266000
         STC   R6,TNTHS(,@14)                                      0477 01267000
*        GEN(D     R4,SIXTY);           /* DIVIDE MIN TO GET HOURS   */ 01268000
         D     R4,SIXTY                                                 01269000
*        GEN(CVD   R4,WORK8);           /* CONVERT # MINUTES @Z427VLS*/ 01270000
         CVD   R4,WORK8                                                 01271000
*        R4=WORKB;                      /* PICK UP CONVERTED #       */ 01272000
         L     R4,WORKB                                            0480 01273000
*        SRL (R4,FOUR);                 /* POSITION IT       @Z427VLS*/ 01274000
         SRL   R4,4                                                0481 01275000
*        MINS=R4;                       /* SET IT INTO REC AS # MINS */ 01276000
         L     @14,TIMEBASE                                        0482 01277000
         STC   R4,MINS(,@14)                                       0482 01278000
*        R4=0 ;                         /*                   @Z427VLS*/ 01279000
         SLR   R4,R4                                               0483 01280000
*        GEN(D     R4,TWENTY4);         /* DIVIDE TO GET HOURS       */ 01281000
         D     R4,TWENTY4                                               01282000
*        GEN(CVD   R4,WORK8);           /* CONVERT # OF HOURS        */ 01283000
         CVD   R4,WORK8                                                 01284000
*        R4=WORKB;                      /* PICK UP VALUE     @Z427VLS*/ 01285000
         L     R4,WORKB                                            0486 01286000
*        SRL (R4,FOUR);                 /* POSITION IT IN REG        */ 01287000
         SRL   R4,4                                                0487 01288000
*        HOURS=R4;                      /* PUT VALUE INTO RECORD     */ 01289000
         L     @14,TIMEBASE                                        0488 01290000
         STC   R4,HOURS(,@14)                                      0488 01291000
*        IF GMTSW='1'B                  /* TEST FOR BASE VALUE TO BE */ 01292000
*              THEN                     /* 1900 OR 1960      @Z427VLS*/ 01293000
         TM    GMTSW(@14),B'10000000'                              0489 01294000
         BNO   @RF00489                                            0489 01295000
*                DO;                                       /*@Z427VLS*/ 01296000
*                  R4 = 0;              /* BIT ON BASE IS 00   YM3662*/ 01297000
         SLR   R4,R4                                               0491 01298000
*                  R5 = R5 + 1;         /* INCREMENT DAY COUNT YM3662   01299000
*                                          SINCE 1900 IS NOT   YM3662   01300000
*                                          A LEAP YEAR AND     YM3662   01301000
*                                          LOOP ASSUMES IT IS  YM3662*/ 01302000
         AL    R5,@CF00056                                         0492 01303000
*                END;                                      /*@Z427VLS*/ 01304000
*              ELSE                     /* IF BIT OFF SET BASE TO 60 */ 01305000
*                   R4=60;              /*                   @Z427VLS*/ 01306000
         B     @RC00489                                            0494 01307000
@RF00489 LA    R4,60                                               0494 01308000
*LEAPYEAR:    ;                         /* R5 HAS NUMBER OF DAYS     */ 01309000
@RC00489 DS    0H                                                  0495 01310000
LEAPYEAR DS    0H                                                  0496 01311000
*        R5=R5-366;                     /* DECREMENT BY A LEAP YEAR  */ 01312000
         LA    @14,366                                             0496 01313000
         SLR   R5,@14                                              0496 01314000
*        IF R5 < ZERO                   /* IF TOO MUCH       @Z427VLS*/ 01315000
*              THEN                     /* THEN DO THE FOLLOWING     */ 01316000
         LTR   R5,R5                                               0497 01317000
         BNM   @RF00497                                            0497 01318000
*                   DO;                 /*                   @Z427VLS*/ 01319000
*                        R5=R5+366;     /* BUMP BACK # OF DAYS BY 366*/ 01320000
         ALR   R5,@14                                              0499 01321000
*                        GOTO CONVNSDN; /* EXIT CONVERSION DONE      */ 01322000
         B     CONVNSDN                                            0500 01323000
*                   END;                /*                   @Z427VLS*/ 01324000
*        R4=R4+1;                       /* ADD 1 FOR YEAR    @Z427VLS*/ 01325000
@RF00497 LA    @14,1                                               0502 01326000
         ALR   R4,@14                                              0502 01327000
*                                       /*                   @Z427VLS*/ 01328000
*                                       /*  DO LOOP FOR REG YEARS    */ 01329000
*        DO A=1 TO 3 BY 1;                                 /*@Z427VLS*/ 01330000
         ST    @14,A                                               0503 01331000
@DL00503 DS    0H                                                  0504 01332000
*              R5=R5-365;               /* DECREMENT BY 365 DAYS     */ 01333000
         LA    @14,365                                             0504 01334000
         SLR   R5,@14                                              0504 01335000
*              IF R5 < ZERO                  /* HAS VALUE    @Z427VLS*/ 01336000
*                   THEN                /* GON NEGATIVE      @Z427VLS*/ 01337000
         LTR   R5,R5                                               0505 01338000
         BNM   @RF00505                                            0505 01339000
*                        DO;            /* IF YES THEN       @Z427VLS*/ 01340000
*                             R5=R5+365;     /* ADD BACK 365 DAYS    */ 01341000
         ALR   R5,@14                                              0507 01342000
*                             GOTO CONVNSDN; /* & EXIT TO FINISH UP  */ 01343000
         B     CONVNSDN                                            0508 01344000
*                        END;                              /*@Z427VLS*/ 01345000
*              R4=R4+1;                 /* ADD 1 YEAR        @Z427VLS*/ 01346000
@RF00505 AL    R4,@CF00056                                         0510 01347000
*        END ;                          /* END OF DO LOOP REPEAT 3X  */ 01348000
         LA    @14,1                                               0511 01349000
         AL    @14,A                                               0511 01350000
         ST    @14,A                                               0511 01351000
         C     @14,@CF00077                                        0511 01352000
         BNH   @DL00503                                            0511 01353000
*        GOTO LEAPYEAR;                                    /*@Z427VLS*/ 01354000
         B     LEAPYEAR                                            0512 01355000
*CONVNSDN:    ;                         /* R4 HAS YEAR       @Z427VLS*/ 01356000
CONVNSDN DS    0H                                                  0514 01357000
*        R5=R5+1;                       /* R5 HAS DAYS ADD 1 TO YEAR */ 01358000
         AL    R5,@CF00056                                         0514 01359000
*        GEN(CVD   R4,WORK8);           /* CONVERT YEARS TO DEC      */ 01360000
         CVD   R4,WORK8                                                 01361000
*        R4=WORKB;                      /* PICK UP VALUE     @Z427VLS*/ 01362000
         L     R4,WORKB                                            0516 01363000
*        SRL (R4,FOUR);                 /* & POSITION IT IN A REG    */ 01364000
         SRL   R4,4                                                0517 01365000
*        YEAR=R4;                       /* PUT YEAR IN RECORD        */ 01366000
         L     @14,TIMEBASE                                        0518 01367000
         STC   R4,YEAR(,@14)                                       0518 01368000
*        GEN(CVD   R5,WORK8);           /* CONVERT THE NO OF DAYS    */ 01369000
         CVD   R5,WORK8                                                 01370000
*        DAYS=(WDAYS | '000F'X);        /* PUT DAYS INTO REC WTH SIGN*/ 01371000
         L     @14,TIMEBASE                                        0520 01372000
         MVC   DAYS(2,@14),WDAYS                                   0520 01373000
         OC    DAYS(2,@14),@CB00983                                0520 01374000
*        DATE0='00'X;                   /* SET HI DIGITS TO ZERO     */ 01375000
         MVI   DATE0(@14),X'00'                                    0521 01376000
*        R7 = R7SAVE;                                      /*@Z427VLS*/ 01377000
         L     R7,R7SAVE                                           0522 01378000
*RESPECIFY (R3,R4,R5,R6,R7) UNRESTRICTED;                  /*@Z427VLS*/ 01379000
* END; /*CLOSING END TO PROC CONVTIME                        @Z427VLS*/ 01380000
         B     @EL00008                                            0524 01381000
*OPENIT: PROC;                                             /*@Z427VLS*/ 01382000
OPENIT   STM   @14,@12,@SA00009                                    0525 01383000
*IF OTOURIST = YES THEN                                            0526 01384000
         L     @14,SAVER2                                          0526 01385000
         TM    OTOURIST(@14),B'10000000'                           0526 01386000
         BNO   @RF00526                                            0526 01387000
*  CALL OPENTOUR;                                          /*@Z427VLS*/ 01388000
         BAL   @14,OPENTOUR                                        0527 01389000
*IF OEREPPT = YES THEN                                             0528 01390000
@RF00526 L     @14,SAVER2                                          0528 01391000
         TM    OEREPPT(@14),B'01000000'                            0528 01392000
         BNO   @RF00528                                            0528 01393000
*  CALL OPENERPT;                                          /*@Z427VLS*/ 01394000
         BAL   @14,OPENERPT                                        0529 01395000
*IF OSERLOG = YES THEN                                             0530 01396000
@RF00528 L     @14,SAVER2                                          0530 01397000
         TM    OSERLOG(@14),B'00100000'                            0530 01398000
         BNO   @RF00530                                            0530 01399000
*  CALL OPENSERL;                                          /*@Z427VLS*/ 01400000
         BAL   @14,OPENSERL                                        0531 01401000
*IF OACCIN = YES THEN                                              0532 01402000
@RF00530 L     @14,SAVER2                                          0532 01403000
         TM    OACCIN(@14),B'00010000'                             0532 01404000
         BNO   @RF00532                                            0532 01405000
*  CALL OPENHIST;                                          /*@Z427VLS*/ 01406000
         BAL   @14,OPENHIST                                        0533 01407000
*IF OACCDEV = YES THEN                                             0534 01408000
@RF00532 L     @14,SAVER2                                          0534 01409000
         TM    OACCDEV(@14),B'00001000'                            0534 01410000
         BNO   @RF00534                                            0534 01411000
*  CALL OPENDEV;                                           /*@Z427VLS*/ 01412000
         BAL   @14,OPENDEV                                         0535 01413000
*IF OSYSIN = YES THEN                                              0536 01414000
@RF00534 L     @14,SAVER2                                          0536 01415000
         TM    OSYSIN(@14),B'00000100'                             0536 01416000
         BNO   @RF00536                                            0536 01417000
*  CALL OPENSYS;                                           /*@Z427VLS*/ 01418000
         BAL   @14,OPENSYS                                         0537 01419000
*IF ODRCTWRK = YES THEN                                            0538 01420000
@RF00536 L     @14,SAVER2                                          0538 01421000
         TM    ODRCTWRK(@14),B'00000010'                           0538 01422000
         BNO   @RF00538                                            0538 01423000
*  CALL OPENDIR;                                           /*@Z427VLS*/ 01424000
         BAL   @14,OPENDIR                                         0539 01425000
*IF OPENIO = NODSETS THEN                                          0540 01426000
@RF00538 L     @14,SAVER2                                          0540 01427000
         CLC   OPENIO(2,@14),@CB00209                              0540 01428000
         BNE   @RF00540                                            0540 01429000
*  DO;                                                     /*@Z427VLS*/ 01430000
*    MSGNO = 17;                                           /*@Z427VLS*/ 01431000
         MVC   MSGNO(4),@CF00993                                   0542 01432000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 01433000
         BAL   @14,ERRMSG                                          0543 01434000
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/ 01435000
         MVC   BADNEWS(4),@CF00068                                 0544 01436000
*  END;                                                    /*@Z427VLS*/ 01437000
*END; /*CLOSING END TO PROC OPENIT                           @Z427VLS*/ 01438000
@EL00009 DS    0H                                                  0546 01439000
@EF00009 DS    0H                                                  0546 01440000
@ER00009 LM    @14,@12,@SA00009                                    0546 01441000
         BR    @14                                                 0546 01442000
*CLOSIT: PROC; /*SELECT DATA SET SPECIFIED AND CLOSE IT      @Z427VLS*/ 01443000
CLOSIT   STM   @14,@12,@SA00010                                    0547 01444000
*IF CEREPPT = YES THEN                                             0548 01445000
         L     @14,SAVER2                                          0548 01446000
         TM    CEREPPT(@14),B'01000000'                            0548 01447000
         BNO   @RF00548                                            0548 01448000
*  CALL CLOSERPT;                                          /*@Z427VLS*/ 01449000
         BAL   @14,CLOSERPT                                        0549 01450000
*IF CACCIN = YES THEN                                              0550 01451000
@RF00548 L     @14,SAVER2                                          0550 01452000
         TM    CACCIN(@14),B'00010000'                             0550 01453000
         BNO   @RF00550                                            0550 01454000
*  CALL CLOSHIST;                                          /*@Z427VLS*/ 01455000
         BAL   @14,CLOSHIST                                        0551 01456000
*IF CACCDEV = YES THEN                                             0552 01457000
@RF00550 L     @14,SAVER2                                          0552 01458000
         TM    CACCDEV(@14),B'00001000'                            0552 01459000
         BNO   @RF00552                                            0552 01460000
*  CALL CLOSEDEV;                                          /*@Z427VLS*/ 01461000
         BAL   @14,CLOSEDEV                                        0553 01462000
*IF CSYSIN = ON THEN                                               0554 01463000
@RF00552 L     @14,SAVER2                                          0554 01464000
         TM    CSYSIN(@14),B'00000100'                             0554 01465000
         BNO   @RF00554                                            0554 01466000
*  CALL CLOSSYS;                                           /*@Z427VLS*/ 01467000
         BAL   @14,CLOSSYS                                         0555 01468000
*IF CDRCTWRK = YES THEN                                            0556 01469000
@RF00554 L     @14,SAVER2                                          0556 01470000
         TM    CDRCTWRK(@14),B'00000010'                           0556 01471000
         BNO   @RF00556                                            0556 01472000
*  CALL CLOSDIR;                                           /*@Z427VLS*/ 01473000
         BAL   @14,CLOSDIR                                         0557 01474000
*IF CSERLOG = YES THEN                                             0558 01475000
@RF00556 L     @14,SAVER2                                          0558 01476000
         TM    CSERLOG(@14),B'00100000'                            0558 01477000
         BNO   @RF00558                                            0558 01478000
*  CALL CLOSSERL;                                          /*@Z427VLS*/ 01479000
         BAL   @14,CLOSSERL                                        0559 01480000
*IF CTOURIST = YES THEN                                            0560 01481000
@RF00558 L     @14,SAVER2                                          0560 01482000
         TM    CTOURIST(@14),B'10000000'                           0560 01483000
         BNO   @RF00560                                            0560 01484000
*  CALL CLOSTOUR;                                          /*@Z427VLS*/ 01485000
         BAL   @14,CLOSTOUR                                        0561 01486000
*/*MUST CLOSE TOURIST LAST TO GET ALL POSSIBLE ERROR MESSAGES*/    0562 01487000
*/*MUST CLOSE SERLOG SECOND TO LAST IN ORDER TO FREE UP AS MUCH*/  0562 01488000
*/*BUFFER SPACE IN ORDER TO DO A POTENTIAL ZEROALL, WHICH IMPLIES*/     01489000
*/*RECORDS WRITTEN WHILE PROCESSING MUST BE SAVED IN CORE. I HOPE*/     01490000
*/*THAT EREP1 HAD ENOUGH SENSE TO FREE UP THE SORTABLE OR ITS */   0562 01491000
*/*EQUIVALENT                                                @Z427VLS*/ 01492000
*IF CLOSEIO = NODSETS THEN                                         0562 01493000
@RF00560 L     @14,SAVER2                                          0562 01494000
         CLC   CLOSEIO(2,@14),@CB00209                             0562 01495000
         BNE   @RF00562                                            0562 01496000
*  DO;                                                     /*@Z427VLS*/ 01497000
*    MSGNO = 32;                                           /*@Z427VLS*/ 01498000
         MVC   MSGNO(4),@CF00531                                   0564 01499000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 01500000
         BAL   @14,ERRMSG                                          0565 01501000
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/ 01502000
         MVC   BADNEWS(4),@CF00068                                 0566 01503000
*  END;                                                    /*@Z427VLS*/ 01504000
*END; /*CLOSING END TO CLOSIT                                @Z427VLS*/ 01505000
@EL00010 DS    0H                                                  0568 01506000
@EF00010 DS    0H                                                  0568 01507000
@ER00010 LM    @14,@12,@SA00010                                    0568 01508000
         BR    @14                                                 0568 01509000
*CLOSSERL: PROC; /*CLOSE THE SERLOG DATA SET AND ALL THAT IMPLIES*/     01510000
CLOSSERL STM   @14,@12,@SA00011                                    0569 01511000
*RESPECIFY (R15,R1,R0) RESTRICTED;                         /*@Z427VLS*/ 01512000
*IF SERLO = ON THEN /*ONLY ATTEMPT TO CLOSE LOGREC IF ALREADY OPEN*/    01513000
         TM    SERLO,B'10000000'                                   0571 01514000
         BNO   @RF00571                                            0571 01515000
*DO;                                                       /*@Z427VLS*/ 01516000
*IF DEBUG15 = ON THEN                                              0573 01517000
         L     @14,SAVER2                                          0573 01518000
         TM    DEBUG15(@14),B'00000001'                            0573 01519000
         BNO   @RF00573                                            0573 01520000
*  DO;                                                     /*@Z427VLS*/ 01521000
*    MSGNO = 56;                                           /*@Z427VLS*/ 01522000
         MVC   MSGNO(4),@CF01007                                   0575 01523000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 01524000
         BAL   @14,ERRMSG                                          0576 01525000
*  END;                                                    /*@Z427VLS*/ 01526000
*IF ZEROALL = YES  /*ZEROALL MEANS RESET THE HEADER TO INDICATE NO*/    01527000
*                  /*DATA. FIRST, ANY RECORDS WRITTEN WHILE PROCESS-*/  01528000
*               /*ING ARE READ INTO CORE. SECOND, THE HEADER IS */ 0578 01529000
*               /*RESET. THIRD, SVC 76 IS ISSUED TO REWRITE THE*/  0578 01530000
*               /*RECORDS BACK TO THE NEW SERLOG             @Z427VLS*/ 01531000
*  THEN DO;                                                /*@Z427VLS*/ 01532000
@RF00573 L     @14,SAVER2                                          0578 01533000
         TM    ZEROALL(@14),B'01000000'                            0578 01534000
         BNO   @RF00578                                            0578 01535000
*    IF DEBUG15 = ON THEN                                          0580 01536000
         TM    DEBUG15(@14),B'00000001'                            0580 01537000
         BNO   @RF00580                                            0580 01538000
*      DO;                                                 /*@Z427VLS*/ 01539000
*        MSGNO = 57;                                       /*@Z427VLS*/ 01540000
         MVC   MSGNO(4),@CF01008                                   0582 01541000
*        CALL ERRMSG;                                      /*@Z427VLS*/ 01542000
         BAL   @14,ERRMSG                                          0583 01543000
*      END;                                                /*@Z427VLS*/ 01544000
*    LASTLOOP = YES; /*INDICATE ZEROALL PROCESSING           @Z427VLS*/ 01545000
@RF00580 OI    LASTLOOP,B'00000100'                                0585 01546000
*    READFR = OFF;  /* DO NOT READ FRAMES DURING ZEROALL     @ZA34610*/ 01547000
         NI    READFR,B'01111111'                                  0586 01548000
*    CALL CHECKHDR; /*SET UP TO READ RECORDS WRITTEN TO LOGREC WHILE*/  01549000
         BAL   @14,CHECKHDR                                        0587 01550000
*                   /*EREP HAS BEEN PROCESSING               @Z427VLS*/ 01551000
*    IF BADNEWS = ZERO THEN /*NO PROBLEMS, YES THERE ARE MORE RECORDS*/ 01552000
         L     @14,BADNEWS                                         0588 01553000
         LTR   @14,@14                                             0588 01554000
         BNZ   @RF00588                                            0588 01555000
*      DO;                                                 /*@Z427VLS*/ 01556000
*        CALL SAVEM; /*READ RECORDS INTO CORE                @Z427VLS*/ 01557000
         BAL   @14,SAVEM                                           0590 01558000
*        CALL RESETHDR;                                    /*@Z427VLS*/ 01559000
         BAL   @14,RESETHDR                                        0591 01560000
*        GEN(DEQ  (RESIDII,LOGRECB,8,SYSTEM));             /*@Z427VLS*/ 01561000
         DEQ  (RESIDII,LOGRECB,8,SYSTEM)                                01562000
*        RUNPTR = FRSPTR;                                  /*@Z427VLS*/ 01563000
         L     @14,FRSPTR                                          0593 01564000
         ST    @14,RUNPTR                                          0593 01565000
*        IF FRSPTR ^= ZERO THEN                                    0594 01566000
         LTR   @14,@14                                             0594 01567000
         BZ    @RF00594                                            0594 01568000
*         DO UNTIL RUNPTR = ZERO;                          /*@Z427VLS*/ 01569000
@DL00595 DS    0H                                                  0596 01570000
*           CALL ISSUE76;                                  /*@Z427VLS*/ 01571000
         BAL   @14,ISSUE76                                         0596 01572000
*           RUNPTR = FORPTR;                               /*@Z427VLS*/ 01573000
         L     @14,RUNPTR                                          0597 01574000
         L     @14,FORPTR(,@14)                                    0597 01575000
         ST    @14,RUNPTR                                          0597 01576000
*         END;                                             /*@Z427VLS*/ 01577000
@DE00595 L     @14,RUNPTR                                          0598 01578000
         LTR   @14,@14                                             0598 01579000
         BNZ   @DL00595                                            0598 01580000
*      END;                                                /*@Z427VLS*/ 01581000
*    ELSE                                                          0600 01582000
*      DO;     /* NO RECORDS WRITTEN WHILE PROCESSING?       @Z427VLS*/ 01583000
         B     @RC00588                                            0600 01584000
@RF00588 DS    0H                                                  0601 01585000
*        IF BADNEWS = FOUR THEN                                    0601 01586000
         CLC   BADNEWS(4),@CF00065                                 0601 01587000
         BNE   @RF00601                                            0601 01588000
*          DO;                                             /*@ZA18998*/ 01589000
*            BADNEWS=ZERO;                /* RESET RTN CODE  @ZA19017*/ 01590000
         SLR   @14,@14                                             0603 01591000
         ST    @14,BADNEWS                                         0603 01592000
*            CALL RESETHDR;               /* RESET HEADER    @Z427VLS*/ 01593000
         BAL   @14,RESETHDR                                        0604 01594000
*          END;                                            /*@ZA18998*/ 01595000
*        GEN(DEQ  (RESIDII,LOGRECB,8,SYSTEM));             /*@Z427VLS*/ 01596000
@RF00601 DS    0H                                                  0606 01597000
         DEQ  (RESIDII,LOGRECB,8,SYSTEM)                                01598000
*      END;                                                /*@Z427VLS*/ 01599000
*  END;                                                    /*@Z427VLS*/ 01600000
@RC00588 DS    0H                                                  0609 01601000
*GEN(DEQ   (RESID,LOGRECA,11,STEP)); /*LET OTHER EREPS AT LOGREC*/ 0609 01602000
@RF00578 DS    0H                                                  0609 01603000
         DEQ   (RESID,LOGRECA,11,STEP)                                  01604000
*GEN(CLOSE (LOGREC));  /*CLOSE THE DCB                       @Z427VLS*/ 01605000
         CLOSE (LOGREC)                                                 01606000
*SERLO = OFF; /*INDICATE THAT SERLOG IS CLOSED               @Z427VLS*/ 01607000
         NI    SERLO,B'01111111'                                   0611 01608000
*END;                                                      /*@Z427VLS*/ 01609000
*ELSE /*IF SERLOG WAS NOT OPEN                               @Z427VLS*/ 01610000
*  DO;                                                     /*@Z427VLS*/ 01611000
         B     @RC00571                                            0613 01612000
@RF00571 DS    0H                                                  0614 01613000
*    IF CLOSEIO ^= CLOSEALL THEN /*END OF JOB WRAPUP CLOSEALL ALLOWED*/ 01614000
         L     @14,SAVER2                                          0614 01615000
         CLC   CLOSEIO(2,@14),@CB00262                             0614 01616000
         BE    @RF00614                                            0614 01617000
*      DO;                                                 /*@Z427VLS*/ 01618000
*        MSGNO = 51;                                       /*@Z427VLS*/ 01619000
         MVC   MSGNO(4),@CF01011                                   0616 01620000
*        CALL ERRMSG;                                      /*@Z427VLS*/ 01621000
         BAL   @14,ERRMSG                                          0617 01622000
*        BADNEWS = TWELVE;                                 /*@Z427VLS*/ 01623000
         MVC   BADNEWS(4),@CF00068                                 0618 01624000
*      END;                                                /*@Z427VLS*/ 01625000
*  END;                                                    /*@Z427VLS*/ 01626000
*RESPECIFY (R15,R0,R1) UNRESTRICTED;                       /*@Z427VLS*/ 01627000
*END; /*CLOSING END TO PROC CLOSSERL                         @Z427VLS*/ 01628000
@EL00011 DS    0H                                                  0622 01629000
@EF00011 DS    0H                                                  0622 01630000
@ER00011 LM    @14,@12,@SA00011                                    0622 01631000
         BR    @14                                                 0622 01632000
*ISSUE76: PROC;                                            /*@Z427VLS*/ 01633000
ISSUE76  STM   @14,@12,@SA00012                                    0623 01634000
*RESPECIFY (R0,R1) RESTRICTED;                             /*@Z427VLS*/ 01635000
*IF DEBUG15 = ON THEN                                              0625 01636000
         L     @12,SAVER2                                          0625 01637000
         TM    DEBUG15(@12),B'00000001'                            0625 01638000
         BNO   @RF00625                                            0625 01639000
*  DO;                                                     /*@Z427VLS*/ 01640000
*    MSGNO = 58;                                           /*@Z427VLS*/ 01641000
         MVC   MSGNO(4),@CF01015                                   0627 01642000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 01643000
         BAL   @14,ERRMSG                                          0628 01644000
*  END;                                                    /*@Z427VLS*/ 01645000
*R0 =JUNK3;                                                /*@Z427VLS*/ 01646000
@RF00625 L     @12,RUNPTR                                          0630 01647000
         LH    R0,JUNK3(,@12)                                      0630 01648000
*R1 = ADDR(RECSPT);                                        /*@Z427VLS*/ 01649000
         LA    R1,RECSPT(,@12)                                     0631 01650000
*R0 = R0 * (-1);                                           /*@Z427VLS*/ 01651000
         LR    @12,R0                                              0632 01652000
         MH    @12,@CH01016                                        0632 01653000
         LR    R0,@12                                              0632 01654000
*SVC(76);                                                  /*@Z427VLS*/ 01655000
         SVC   76                                                  0633 01656000
*RESPECIFY (R0,R1) UNRESTRICTED;                           /*@Z427VLS*/ 01657000
*END; /*CLOSING END TO PROC ISSUE76                          @Z427VLS*/ 01658000
@EL00012 DS    0H                                                  0635 01659000
@EF00012 DS    0H                                                  0635 01660000
@ER00012 LM    @14,@12,@SA00012                                    0635 01661000
         BR    @14                                                 0635 01662000
*SAVEM: PROC;                                              /*@Z427VLS*/ 01663000
SAVEM    STM   @14,@12,@SA00013                                    0636 01664000
*RESPECIFY (R2,R3,R4,R5,R6,R15) RESTRICTED;                /*@Z427VLS*/ 01665000
*DO WHILE BADNEWS = ZERO;                                  /*@Z427VLS*/ 01666000
         B     @DE00638                                            0638 01667000
@DL00638 DS    0H                                                  0639 01668000
*  CALL READSER;                                           /*@Z427VLS*/ 01669000
         BAL   @14,READSER                                         0639 01670000
*  IF BADNEWS = ZERO THEN                                          0640 01671000
         L     @14,BADNEWS                                         0640 01672000
         LTR   @14,@14                                             0640 01673000
         BNZ   @RF00640                                            0640 01674000
*    DO;                                                   /*@Z427VLS*/ 01675000
*      DBLYES = NO;                                        /*@Z427VLS*/ 01676000
         NI    DBLYES,B'11110111'                                  0642 01677000
*      GETHIS = BSZ;                                       /*@Z427VLS*/ 01678000
         LH    @14,BSZ                                             0643 01679000
         ST    @14,GETHIS                                          0643 01680000
*      GETHIS = GETHIS + 12;                               /*@Z427VLS*/ 01681000
         AL    @14,@CF00068                                        0644 01682000
         ST    @14,GETHIS                                          0644 01683000
*      DO WHILE DBLYES = NO;                               /*@Z427VLS*/ 01684000
         B     @DE00645                                            0645 01685000
@DL00645 DS    0H                                                  0646 01686000
*        IF (GETTIT & DBLWORD) ^= NULL THEN                        0646 01687000
         MVC   @TS00001(4),GETTIT                                  0646 01688000
         NC    @TS00001(4),@CB00532                                0646 01689000
         CLC   @TS00001(4),@CB00120                                0646 01690000
         BE    @RF00646                                            0646 01691000
*          GETHIS = GETHIS + 1;                            /*@Z427VLS*/ 01692000
         LA    @14,1                                               0647 01693000
         AL    @14,GETHIS                                          0647 01694000
         ST    @14,GETHIS                                          0647 01695000
*        ELSE                                                      0648 01696000
*          DBLYES = YES;                                   /*@Z427VLS*/ 01697000
         B     @RC00646                                            0648 01698000
@RF00646 OI    DBLYES,B'00001000'                                  0648 01699000
*      END;                                                /*@Z427VLS*/ 01700000
@RC00646 DS    0H                                                  0649 01701000
@DE00645 TM    DBLYES,B'00001000'                                  0649 01702000
         BZ    @DL00645                                            0649 01703000
*      R6 = GETTIT; /*NUMBER OF BYTES NEEDED IN R6           @Z427VLS*/ 01704000
         L     R6,GETTIT                                           0650 01705000
*      GEN(GETMAIN  EC,LV=(R6),A=SAVEPTR); /*STORAGE FOR RECORD*/  0651 01706000
         GETMAIN  EC,LV=(R6),A=SAVEPTR                                  01707000
*      NUMRECSV = NUMRECSV + 1;                            /*@Z427VLS*/ 01708000
         LA    @14,1                                               0652 01709000
         AL    @14,NUMRECSV                                        0652 01710000
         ST    @14,NUMRECSV                                        0652 01711000
*      IF R15 = ZERO THEN                                          0653 01712000
         LTR   R15,R15                                             0653 01713000
         BNZ   @RF00653                                            0653 01714000
*        DO;                                               /*@Z427VLS*/ 01715000
*          IF SECGET = NO THEN /*IF FIRST RECORD SAVED THEN  @Z427VLS*/ 01716000
         TM    SECGET,B'01000000'                                  0655 01717000
         BNZ   @RF00655                                            0655 01718000
*            DO;                                           /*@Z427VLS*/ 01719000
*              SECGET = YES;                               /*@Z427VLS*/ 01720000
         OI    SECGET,B'01000000'                                  0657 01721000
*              FRSPTR = SAVEPTR; /*POINTER TO FIRST RECORD SAVED*/ 0658 01722000
         L     @14,SAVEPTR                                         0658 01723000
         ST    @14,FRSPTR                                          0658 01724000
*              RUNPTR = SAVEPTR; /*ESTABLISH ADDRESSABILITY  @Z427VLS*/ 01725000
         ST    @14,RUNPTR                                          0659 01726000
*            END;                                          /*@Z427VLS*/ 01727000
*           ELSE /*IF SAVING SECOND RECORD THEN              @Z427VLS*/ 01728000
*            DO;                                           /*@Z427VLS*/ 01729000
         B     @RC00655                                            0661 01730000
@RF00655 DS    0H                                                  0662 01731000
*              FORPTR = SAVEPTR; /*SET FORWARD POINTER FROM OLD REC*/   01732000
         L     @14,SAVEPTR                                         0662 01733000
         L     @12,RUNPTR                                          0662 01734000
         ST    @14,FORPTR(,@12)                                    0662 01735000
*                                /*TO LOCATION OF NEW RECORD SAVE ARR*/ 01736000
*              RUNPTR = SAVEPTR; /*ESTABLISH ADDRESS OF NEW RECORD*/    01737000
         ST    @14,RUNPTR                                          0663 01738000
*            END;                                          /*@Z427VLS*/ 01739000
*          R2 = ADDR(JUNK);                                /*@Z427VLS*/ 01740000
@RC00655 L     R2,RUNPTR                                           0665 01741000
         LA    R2,JUNK(,R2)                                        0665 01742000
*          R3 = GETHIS - 4;                                /*@Z427VLS*/ 01743000
         L     R3,GETHIS                                           0666 01744000
         SL    R3,@CF00065                                         0666 01745000
*          R4 = ADDR(BCOUNT); /*MAY BE WRONG                 @Z427VLS*/ 01746000
         LA    R4,BCOUNT                                           0667 01747000
*          R5 = R3;                                        /*@Z427VLS*/ 01748000
         LR    R5,R3                                               0668 01749000
*          MVCL(R2,R4);                                    /*@Z427VLS*/ 01750000
         MVCL  R2,R4                                               0669 01751000
*          FORPTR = ZERO;                                  /*@Z427VLS*/ 01752000
         L     @14,RUNPTR                                          0670 01753000
         SLR   @12,@12                                             0670 01754000
         ST    @12,FORPTR(,@14)                                    0670 01755000
*        END;                                              /*@Z427VLS*/ 01756000
*      ELSE                                                        0672 01757000
*        DO;                                               /*@Z427VLS*/ 01758000
         B     @RC00653                                            0672 01759000
@RF00653 DS    0H                                                  0673 01760000
*          MSGNO = 50;                                     /*@Z427VLS*/ 01761000
         MVC   MSGNO(4),@CF00296                                   0673 01762000
*          CALL ERRMSG;                                    /*@Z427VLS*/ 01763000
         BAL   @14,ERRMSG                                          0674 01764000
*          BADNEWS = TWELVE;                               /*@Z427VLS*/ 01765000
         MVC   BADNEWS(4),@CF00068                                 0675 01766000
*        END;                                              /*@Z427VLS*/ 01767000
*     END;                                                 /*@Z427VLS*/ 01768000
@RC00653 DS    0H                                                  0678 01769000
*   END;                                                   /*@Z427VLS*/ 01770000
@RF00640 DS    0H                                                  0678 01771000
@DE00638 L     @14,BADNEWS                                         0678 01772000
         LTR   @14,@14                                             0678 01773000
         BZ    @DL00638                                            0678 01774000
*RESPECIFY (R2,R3,R4,R5,R6,R15) UNRESTRICTED;              /*@Z427VLS*/ 01775000
*END; /*CLOSING END TO PROC SAVEM                            @Z427VLS*/ 01776000
@EL00013 DS    0H                                                  0680 01777000
@EF00013 DS    0H                                                  0680 01778000
@ER00013 LM    @14,@12,@SA00013                                    0680 01779000
         BR    @14                                                 0680 01780000
*ERRMSG: PROC; /*WRITE ERROR MESSAGES TO THE TOURIST DATA SET*/    0681 01781000
ERRMSG   STM   @14,@12,@SA00014                                    0681 01782000
*              /*IF THE PROBLEM EXISTS WITH THE TOURIST DATA SET*/ 0682 01783000
*              /*THEN WRITE TO THE OPERATOR. IF THE OPERATOR @Z427VLS*/ 01784000
*              /*CANNOT BE REACHED, THEN YOU ARE ASKING TOO MUCH*/ 0682 01785000
*              /*OF THIS PROGRAM                             @Z427VLS*/ 01786000
*RESPECIFY (R7,R12,R5) RESTRICTED;                         /*@Z427VLS*/ 01787000
*GEN(MVC PRNTBF(134),BLANKS); /*CLEAR INTERNAL PRINT BUFFER  @Z427VLS*/ 01788000
         MVC PRNTBF(134),BLANKS                                         01789000
*IF MSGNO <= 52 THEN            /* SYSTEM ERROR MESSAGE ?    @Z427VLS*/ 01790000
         L     @06,MSGNO                                           0684 01791000
         C     @06,@CF01026                                        0684 01792000
         BH    @RF00684                                            0684 01793000
*  DO;                                                     /*@Z427VLS*/ 01794000
*    R2 = SAVER2;    /*INSURE COMTABLE ADDRESSED BY R2       @ZA31549*/ 01795000
         L     @06,SAVER2                                          0686 01796000
         LR    R2,@06                                              0686 01797000
*    CALL IFCMSG(MSGNO,ADDR(PRNTBF)+2);                    /*@Z427VLS*/ 01798000
         LA    @04,PRNTBF                                          0687 01799000
         AL    @04,@CF00075                                        0687 01800000
         ST    @04,@AFTEMPS+4                                      0687 01801000
         L     @15,ADIFCMSG(,@06)                                  0687 01802000
         LA    @01,@AL00687                                        0687 01803000
         BALR  @14,@15                                             0687 01804000
*    PRNTBF(1:2) = '1 ';                                   /*@Z427VLS*/ 01805000
         MVC   PRNTBF(2),@CC01027                                  0688 01806000
*  END;                                                    /*@Z427VLS*/ 01807000
*ELSE                                                              0690 01808000
*  DO;                                                     /*@Z427VLS*/ 01809000
         B     @RC00684                                            0690 01810000
@RF00684 DS    0H                                                  0691 01811000
*    MSGNO = MSGNO - 52;                                   /*@Z427VLS*/ 01812000
         L     @06,MSGNO                                           0691 01813000
         SL    @06,@CF01026                                        0691 01814000
         ST    @06,MSGNO                                           0691 01815000
*    R5 = ADDR(ERRLINE) + (51 * (MSGNO - 1)); /*POINT TO MESSAGE TEXT*/ 01816000
         LA    R5,ERRLINE                                          0692 01817000
         BCTR  @06,0                                               0692 01818000
         MH    @06,@CH01011                                        0692 01819000
         ALR   R5,@06                                              0692 01820000
*    GEN(MVC PRNTBF(51),0(R5)); /*MOVE TEXT TO INTERNAL PRINT BUFFER*/  01821000
         MVC PRNTBF(51),0(R5)                                           01822000
*  END;                                                    /*@Z427VLS*/ 01823000
*PRINTADR = ADDR(PRNTBF); /*ADDRESS THE DATA SET TYPE        @Z427VLS*/ 01824000
@RC00684 LA    @06,PRNTBF                                          0695 01825000
         L     @04,SAVER2                                          0695 01826000
         ST    @06,PRINTADR(,@04)                                  0695 01827000
*IF TOUROPN = YES                 THEN /*IF TOURIST DATA SET IS OPEN*/  01828000
         TM    TOUROPN,B'00000010'                                 0696 01829000
         BNO   @RF00696                                            0696 01830000
*  DO;                                                     /*@Z427VLS*/ 01831000
*     R7 = PRINTADR + 1; /*POINT PAST DATA SET INDICATOR     @Z427VLS*/ 01832000
         LA    R7,1                                                0698 01833000
         ALR   R7,@06                                              0698 01834000
*     CCSAVE = PRINTCC; /*SAVE CARRIAGE CONTROL FROM CALLER  @Z427VLS*/ 01835000
         MVC   CCSAVE(1),PRINTCC(@06)                              0699 01836000
*     PRINTCC = '09'X; /*CARRIAGE CONTROL TO PRINT ONE LINE  @Z427VLS*/ 01837000
         MVI   PRINTCC(@06),X'09'                                  0700 01838000
*     GEN(LA R12,TOURDCB); /*ADDRESS TOURIST DCB             @Z427VLS*/ 01839000
         LA R12,TOURDCB                                                 01840000
*     GEN(PUT (12),(R7));                                  /*@Z427VLS*/ 01841000
         PUT (12),(R7)                                                  01842000
*     PRINTCC = CCSAVE; /*RESTORE CALLERS CARRIAGE CONTROL   @Z427VLS*/ 01843000
         L     @06,SAVER2                                          0703 01844000
         L     @04,PRINTADR(,@06)                                  0703 01845000
         MVC   PRINTCC(1,@04),CCSAVE                               0703 01846000
*     PRINTBDY = BLANKS; /*CLEAR PRINT LINE FOR CALLER       @Z427VLS*/ 01847000
         MVC   PRINTBDY(132,@04),BLANKS                            0704 01848000
*     LINECTT = LINECTT + 1;                               /*@Z427VLS*/ 01849000
         LA    @15,1                                               0705 01850000
         AH    @15,LINECTT                                         0705 01851000
         STH   @15,LINECTT                                         0705 01852000
*     IF LINECTT = LINECT THEN                                     0706 01853000
         CH    @15,LINECT(,@06)                                    0706 01854000
         BNE   @RF00706                                            0706 01855000
*       DO;                                                /*@Z427VLS*/ 01856000
*         LINECTT = 0;                                     /*@Z427VLS*/ 01857000
         SLR   @06,@06                                             0708 01858000
         STH   @06,LINECTT                                         0708 01859000
*         CCSAVE = PRINTCC;                                /*@Z427VLS*/ 01860000
         MVC   CCSAVE(1),PRINTCC(@04)                              0709 01861000
*         PRINTCC = SKIPNEW;                               /*@Z427VLS*/ 01862000
         MVI   PRINTCC(@04),X'8B'                                  0710 01863000
*         GEN(PUT (R12),(R7));                             /*@Z427VLS*/ 01864000
         PUT (R12),(R7)                                                 01865000
*         PRINTCC = CCSAVE;                                /*@Z427VLS*/ 01866000
         L     @06,SAVER2                                          0712 01867000
         L     @06,PRINTADR(,@06)                                  0712 01868000
         MVC   PRINTCC(1,@06),CCSAVE                               0712 01869000
*       END;                                               /*@Z427VLS*/ 01870000
*  END;                                                    /*@Z427VLS*/ 01871000
* ELSE /*IF TOURIST NOT OPEN THEN GO TO OPERATOR             @ZA28682*/ 01872000
*   DO;                                                    /*@ZA35725*/ 01873000
         B     @RC00696                                            0715 01874000
@RF00696 DS    0H                                                  0716 01875000
*    R2 = SAVER2;    /*INSURE COMTABLE ADDRESSED BY R2       @ZA31549*/ 01876000
         L     @06,SAVER2                                          0716 01877000
         LR    R2,@06                                              0716 01878000
*    CALL IFCMSG(203,ADDR(PRNTBF));                        /*@ZA28682*/ 01879000
         LA    @04,PRNTBF                                          0717 01880000
         ST    @04,@AFTEMPS+4                                      0717 01881000
         L     @15,ADIFCMSG(,@06)                                  0717 01882000
         LA    @01,@AL00717                                        0717 01883000
         BALR  @14,@15                                             0717 01884000
*   END;                                                   /*@ZA35725*/ 01885000
*RESPECIFY (R7,R12,R5) UNRESTRICTED;                       /*@Z427VLS*/ 01886000
* END; /*CLOSING END TO ERRMSG PROC                          @Z427VLS*/ 01887000
@EL00014 DS    0H                                                  0720 01888000
@EF00014 DS    0H                                                  0720 01889000
@ER00014 LM    @14,@12,@SA00014                                    0720 01890000
         BR    @14                                                 0720 01891000
*PRINTIT: PROC; /*SELECT PRINT DATA SET AND PRINT LINE REQUESTED*/ 0721 01892000
PRINTIT  STM   @14,@12,@SA00015                                    0721 01893000
*RESPECIFY (R7,R12) RESTRICTED;                            /*@Z427VLS*/ 01894000
*IF PRINTDS = 'F0'X THEN /*IF PRINT TO ERREPT THEN           @Z427VLS*/ 01895000
         L     @06,SAVER2                                          0723 01896000
         L     @06,PRINTADR(,@06)                                  0723 01897000
         CLI   PRINTDS(@06),X'F0'                                  0723 01898000
         BNE   @RF00723                                            0723 01899000
*  DO;                                                     /*@Z427VLS*/ 01900000
*    IF ERPTOPN = ON THEN /*IF ERREPT HAS BEEN OPENED THEN   @Z427VLS*/ 01901000
         TM    ERPTOPN,B'00000001'                                 0725 01902000
         BNO   @RF00725                                            0725 01903000
*      DO;                                                 /*@Z427VLS*/ 01904000
*        GEN(LA R12,EREPTDCB); /*ADDRESS ERREPT DCB          @Z427VLS*/ 01905000
         LA R12,EREPTDCB                                                01906000
*        R7 = PRINTADR + 1; /*POINT PAST THE DATA SET DEFINER*/    0728 01907000
         LA    R7,1                                                0728 01908000
         L     @06,SAVER2                                          0728 01909000
         AL    R7,PRINTADR(,@06)                                   0728 01910000
*        GEN(TR 0(1,R7),MACHCODE); /* ENSURE VALID CODE      @ZA18999*/ 01911000
         TR 0(1,R7),MACHCODE                                            01912000
*        GEN(PUT (12),(7));                                /*@Z427VLS*/ 01913000
         PUT (12),(7)                                                   01914000
*        PRINTBDY = BLANKS; /*CLEAR PRINT LINE FOR CALLER    @Z427VLS*/ 01915000
         L     @06,SAVER2                                          0731 01916000
         L     @06,PRINTADR(,@06)                                  0731 01917000
         MVC   PRINTBDY(132,@06),BLANKS                            0731 01918000
*      END;                                                /*@Z427VLS*/ 01919000
*    ELSE /*REQUEST TO WRITE TO DATA SET NOT OPEN            @Z427VLS*/ 01920000
*      DO;                                                 /*@Z427VLS*/ 01921000
         B     @RC00725                                            0733 01922000
@RF00725 DS    0H                                                  0734 01923000
*        BADNEWS = TWELVE;                                 /*@Z427VLS*/ 01924000
         MVC   BADNEWS(4),@CF00068                                 0734 01925000
*        MSGNO = 19;                                       /*@Z427VLS*/ 01926000
         MVC   MSGNO(4),@CF01032                                   0735 01927000
*        CALL ERRMSG;                                      /*@Z427VLS*/ 01928000
         BAL   @14,ERRMSG                                          0736 01929000
*      END;                                                /*@Z427VLS*/ 01930000
*  END;                                                    /*@Z427VLS*/ 01931000
*ELSE /*REQUEST FOR WRITE TO TOURIST DATA SET                @Z427VLS*/ 01932000
*  DO;                                                     /*@Z427VLS*/ 01933000
         B     @RC00723                                            0739 01934000
@RF00723 DS    0H                                                  0740 01935000
*    IF TOUROPN = YES THEN /*IF TOURIST DATA SET IS OPEN THEN*/    0740 01936000
         TM    TOUROPN,B'00000010'                                 0740 01937000
         BNO   @RF00740                                            0740 01938000
*      DO;                                                 /*@Z427VLS*/ 01939000
*        R7 = PRINTADR + 1; /* POINT PAST DATA SET ID        @Z427VLS*/ 01940000
         L     @01,SAVER2                                          0742 01941000
         L     @15,PRINTADR(,@01)                                  0742 01942000
         LA    R7,1                                                0742 01943000
         ALR   R7,@15                                              0742 01944000
*        CCSAVE = PRINTCC;                                 /*@Z427VLS*/ 01945000
         MVC   CCSAVE(1),PRINTCC(@15)                              0743 01946000
*        PRINTCC = '09'X; /*SET TO PRINT AND SKIP ONE        @Z427VLS*/ 01947000
         MVI   PRINTCC(@15),X'09'                                  0744 01948000
*        GEN(LA R12,TOURDCB); /*ADDRESS TOURIST DCB          @Z427VLS*/ 01949000
         LA R12,TOURDCB                                                 01950000
*        GEN(PUT (12),(7)); /*PUT TO TOURIST                 @Z427VLS*/ 01951000
         PUT (12),(7)                                                   01952000
*        PRINTCC = CCSAVE; /*RESTORE USERS CARRIAGE CONTROL  @Z427VLS*/ 01953000
         L     @06,SAVER2                                          0747 01954000
         L     @15,PRINTADR(,@06)                                  0747 01955000
         MVC   PRINTCC(1,@15),CCSAVE                               0747 01956000
*        PRINTBDY = BLANKS; /*BLANKS TO CALLERS LINE         @Z427VLS*/ 01957000
         MVC   PRINTBDY(132,@15),BLANKS                            0748 01958000
*        LINECTT = LINECTT + 1;                            /*@Z427VLS*/ 01959000
         LA    @14,1                                               0749 01960000
         AH    @14,LINECTT                                         0749 01961000
         STH   @14,LINECTT                                         0749 01962000
*        IF LINECTT = LINECT THEN                                  0750 01963000
         CH    @14,LINECT(,@06)                                    0750 01964000
         BNE   @RF00750                                            0750 01965000
*          DO;                                             /*@Z427VLS*/ 01966000
*            LINECTT = 0;                                  /*@Z427VLS*/ 01967000
         SLR   @06,@06                                             0752 01968000
         STH   @06,LINECTT                                         0752 01969000
*            CCSAVE = PRINTCC;                             /*@Z427VLS*/ 01970000
         MVC   CCSAVE(1),PRINTCC(@15)                              0753 01971000
*            PRINTCC = SKIPNEW;                            /*@Z427VLS*/ 01972000
         MVI   PRINTCC(@15),X'8B'                                  0754 01973000
*            GEN(PUT (R12),(R7));                          /*@Z427VLS*/ 01974000
         PUT (R12),(R7)                                                 01975000
*            PRINTCC = CCSAVE;                             /*@Z427VLS*/ 01976000
         L     @06,SAVER2                                          0756 01977000
         L     @06,PRINTADR(,@06)                                  0756 01978000
         MVC   PRINTCC(1,@06),CCSAVE                               0756 01979000
*          END;                                            /*@Z427VLS*/ 01980000
*     END;                                                 /*@Z427VLS*/ 01981000
*   ELSE  /*IMPLIES TOURIST DATA SET NOT OPEN                @Z427VLS*/ 01982000
*     DO;                                                  /*@Z427VLS*/ 01983000
         B     @RC00740                                            0759 01984000
@RF00740 DS    0H                                                  0760 01985000
*       R2 = SAVER2;    /*INSURE COMTABLE ADDRESSED BY R2    @ZA31549*/ 01986000
         L     @06,SAVER2                                          0760 01987000
         LR    R2,@06                                              0760 01988000
*       CALL IFCMSG(203,ADDR(PRNTBF));                     /*@Z427VLS*/ 01989000
         LA    @15,PRNTBF                                          0761 01990000
         ST    @15,@AFTEMPS+8                                      0761 01991000
         L     @15,ADIFCMSG(,@06)                                  0761 01992000
         LA    @01,@AL00761                                        0761 01993000
         BALR  @14,@15                                             0761 01994000
*       BADNEWS = TWELVE;                                  /*@Z427VLS*/ 01995000
         MVC   BADNEWS(4),@CF00068                                 0762 01996000
*     END;                                                 /*@Z427VLS*/ 01997000
*  END;                                                    /*@Z427VLS*/ 01998000
*RESPECIFY (R7,R12) UNRESTRICTED;                          /*@Z427VLS*/ 01999000
*END; /*CLOSING END TO PROC PRINTIT                          @Z427VLS*/ 02000000
@EL00015 DS    0H                                                  0766 02001000
@EF00015 DS    0H                                                  0766 02002000
@ER00015 LM    @14,@12,@SA00015                                    0766 02003000
         BR    @14                                                 0766 02004000
*OPENSYS: PROC; /*OPEN SYSIN DATA SET TO READ CARDS          @Z427VLS*/ 02005000
OPENSYS  STM   @14,@12,@SA00016                                    0767 02006000
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/ 02007000
*IF SYSOPN = NO THEN /* IF ALREADY OPEN IS NO NO             @Z427VLS*/ 02008000
         TM    SYSOPN,B'00000100'                                  0769 02009000
         BNZ   @RF00769                                            0769 02010000
*  DO;                                                     /*@Z427VLS*/ 02011000
*    IF DEBUG15 = ON THEN                                          0771 02012000
         L     @01,SAVER2                                          0771 02013000
         TM    DEBUG15(@01),B'00000001'                            0771 02014000
         BNO   @RF00771                                            0771 02015000
*      DO;                                                 /*@Z427VLS*/ 02016000
*        MSGNO = 59;                                       /*@Z427VLS*/ 02017000
         MVC   MSGNO(4),@CF01036                                   0773 02018000
*        CALL ERRMSG;                                      /*@Z427VLS*/ 02019000
         BAL   @14,ERRMSG                                          0774 02020000
*      END;                                                /*@Z427VLS*/ 02021000
*    GENERATE;                                             /*@Z427VLS*/ 02022000
@RF00771 DS    0H                                                  0776 02023000
         LA    R12,SYSDCB                                               02024000
         OPEN  ((R12),(INPUT))                                          02025000
         TM    DCBOFLGS,OPENOK                                          02026000
         BZ    SYSOBAD                                                  02027000
*   SYSOPN = YES;                                          /*@Z427VLS*/ 02028000
         OI    SYSOPN,B'00000100'                                  0777 02029000
*  END;                                                    /*@Z427VLS*/ 02030000
*ELSE                                                              0779 02031000
*  DO;                                                     /*@Z427VLS*/ 02032000
         B     @RC00769                                            0779 02033000
@RF00769 DS    0H                                                  0780 02034000
*    MSGNO = 33;                                           /*@Z427VLS*/ 02035000
         MVC   MSGNO(4),@CF01037                                   0780 02036000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 02037000
         BAL   @14,ERRMSG                                          0781 02038000
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/ 02039000
         MVC   BADNEWS(4),@CF00068                                 0782 02040000
*  END;                                                    /*@Z427VLS*/ 02041000
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/ 02042000
*END; /*CLOSING END TO PROC OPENSYS                          @Z427VLS*/ 02043000
@EL00016 DS    0H                                                  0785 02044000
@EF00016 DS    0H                                                  0785 02045000
@ER00016 LM    @14,@12,@SA00016                                    0785 02046000
         BR    @14                                                 0785 02047000
*CLOSSYS: PROC; /*CLOSE SYSIN DATA SET FOR READING CARDS     @Z427VLS*/ 02048000
CLOSSYS  STM   @14,@12,@SA00017                                    0786 02049000
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/ 02050000
*IF SYSOPN = YES THEN                                              0788 02051000
         TM    SYSOPN,B'00000100'                                  0788 02052000
         BNO   @RF00788                                            0788 02053000
*  DO;                                                     /*@Z427VLS*/ 02054000
*    IF DEBUG15 = ON THEN                                          0790 02055000
         L     @01,SAVER2                                          0790 02056000
         TM    DEBUG15(@01),B'00000001'                            0790 02057000
         BNO   @RF00790                                            0790 02058000
*      DO;                                                 /*@Z427VLS*/ 02059000
*        MSGNO = 60;                                       /*@Z427VLS*/ 02060000
         MVC   MSGNO(4),@CF00841                                   0792 02061000
*        CALL ERRMSG;                                      /*@Z427VLS*/ 02062000
         BAL   @14,ERRMSG                                          0793 02063000
*      END;                                                /*@Z427VLS*/ 02064000
*    GENERATE;                                             /*@Z427VLS*/ 02065000
@RF00790 DS    0H                                                  0795 02066000
         CLOSE (SYSDCB)                                                 02067000
*    SYSOPN = NO;                                          /*@Z427VLS*/ 02068000
         NI    SYSOPN,B'11111011'                                  0796 02069000
*  END;                                                    /*@Z427VLS*/ 02070000
*ELSE                                                              0798 02071000
*  DO;                                                     /*@Z427VLS*/ 02072000
         B     @RC00788                                            0798 02073000
@RF00788 DS    0H                                                  0799 02074000
*    IF CLOSEIO ^= CLOSEALL THEN                                   0799 02075000
         L     @01,SAVER2                                          0799 02076000
         CLC   CLOSEIO(2,@01),@CB00262                             0799 02077000
         BE    @RF00799                                            0799 02078000
*      DO;                                                 /*@Z427VLS*/ 02079000
*        MSGNO = 34;                                       /*@Z427VLS*/ 02080000
         MVC   MSGNO(4),@CF01041                                   0801 02081000
*        CALL ERRMSG;                                      /*@Z427VLS*/ 02082000
         BAL   @14,ERRMSG                                          0802 02083000
*        BADNEWS = 12;                                     /*@Z427VLS*/ 02084000
         MVC   BADNEWS(4),@CF00068                                 0803 02085000
*      END;                                                /*@Z427VLS*/ 02086000
*   END;                                                   /*@Z427VLS*/ 02087000
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/ 02088000
*END; /*CLOSING END TO PROC CLOSSYS                          @Z427VLS*/ 02089000
@EL00017 DS    0H                                                  0807 02090000
@EF00017 DS    0H                                                  0807 02091000
@ER00017 LM    @14,@12,@SA00017                                    0807 02092000
         BR    @14                                                 0807 02093000
*REEDSYS: PROC OPTIONS(DONTSAVE(R7)); /*READ THE SYSIN CARDS @Z427VLS*/ 02094000
REEDSYS  STM   @14,@06,@SA00018                                    0808 02095000
         STM   @08,@12,@SA00018+36                                 0808 02096000
*RESPECIFY (R7,R12) RESTRICTED;                            /*@Z427VLS*/ 02097000
*IF SYSOPN = YES THEN                                              0810 02098000
         TM    SYSOPN,B'00000100'                                  0810 02099000
         BNO   @RF00810                                            0810 02100000
*  DO;                                                     /*@Z427VLS*/ 02101000
*    SYSRDCT = SYSRDCT + 1; /*NUMBER OF READS ATTEMPTED      @Z427VLS*/ 02102000
         LA    @06,1                                               0812 02103000
         AL    @06,SYSRDCT                                         0812 02104000
         ST    @06,SYSRDCT                                         0812 02105000
*    GENERATE;                                             /*@Z427VLS*/ 02106000
         LA    R7,CARDSPOT                                              02107000
         LA    R12,SYSDCB                                               02108000
         GET   (12),(7)                                                 02109000
*  END;                                                    /*@Z427VLS*/ 02110000
*ELSE                                                              0815 02111000
*  DO;                                                     /*@Z427VLS*/ 02112000
         B     @RC00810                                            0815 02113000
@RF00810 DS    0H                                                  0816 02114000
*    MSGNO = 35;                                           /*@Z427VLS*/ 02115000
         MVC   MSGNO(4),@CF01045                                   0816 02116000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 02117000
         BAL   @14,ERRMSG                                          0817 02118000
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/ 02119000
         MVC   BADNEWS(4),@CF00068                                 0818 02120000
*  END;                                                    /*@Z427VLS*/ 02121000
*RESPECIFY (R7,R12) UNRESTRICTED;                          /*@Z427VLS*/ 02122000
*END; /*CLOSING END TO REEDSYS PROC                          @Z427VLS*/ 02123000
@EL00018 DS    0H                                                  0821 02124000
@EF00018 DS    0H                                                  0821 02125000
@ER00018 LM    @14,@06,@SA00018                                    0821 02126000
         LM    @08,@12,@SA00018+36                                 0821 02127000
         BR    @14                                                 0821 02128000
*SCRCHIT: PROC; /*WRITE TO DIRECTWK DATA SET SEQUENTIALLY    @Z427VLS*/ 02129000
SCRCHIT  STM   @14,@12,@SA00019                                    0822 02130000
*RESPECIFY (R7,R12,R1) RESTRICTED;                         /*@Z427VLS*/ 02131000
*IF INDIR = YES & /*IF DATA SET IS OPEN AND OPEN FOR SEQUENTIAL*/  0824 02132000
*   CLOSE2 = NO THEN /*WRITING THEN                          @Z427VLS*/ 02133000
         TM    INDIR,B'00100000'                                   0824 02134000
         BNO   @RF00824                                            0824 02135000
         TM    CLOSE2,B'00001000'                                  0824 02136000
         BNZ   @RF00824                                            0824 02137000
*  DO;                                                     /*@Z427VLS*/ 02138000
*    RITEWKCT = RITEWKCT + 1; /*NUMBER OF WRITE ATTEMPTS     @Z427VLS*/ 02139000
         LA    @06,1                                               0826 02140000
         AL    @06,RITEWKCT                                        0826 02141000
         ST    @06,RITEWKCT                                        0826 02142000
*GENERATE;                                                 /*@Z427VLS*/ 02143000
         LA    R7,BUF1     GET ADDRESS OF RECORD                        02144000
*        IF FLIPFLOP = OFF THEN /*MUST REARRANGE SERLOG PRE RECORD*/    02145000
         TM    FLIPFLOP,B'00100000'                                0828 02146000
         BNZ   @RF00828                                            0828 02147000
*          DO;                                             /*@Z427VLS*/ 02148000
*            BBRDW = SAVELENT; /*GET UNMODIFIED QSAM RECORD LENGTH*/    02149000
         LH    @06,SAVELENT                                        0830 02150000
         STH   @06,BBRDW                                           0830 02151000
*            BSIZE = '0000'X;                              /*@Z427VLS*/ 02152000
         MVC   BSIZE(2),@CB00209                                   0831 02153000
*            R7 = ADDR(BBRDW);                             /*@Z427VLS*/ 02154000
         LA    R7,BBRDW                                            0832 02155000
*          END;                                            /*@Z427VLS*/ 02156000
*         GENERATE;                                        /*@Z427VLS*/ 02157000
@RF00828 DS    0H                                                  0834 02158000
         LA    R12,WORKWDCB   GET DCB ADDRESS                           02159000
         WRITE WORKWDEC,SF,(12),(7)  ISSUE WRITE SVC                    02160000
         CHECK WORKWDEC     MAKE SURE WRITE COMPLETES BEFORE PROCEED    02161000
         NOTE  (12)     RETRIEVE RELATIVE RECORD LOCATION ON DIRECTWK   02162000
         ST    R1,TTRSAVE  SAVE TTR FOR SORTABLE                        02163000
         CLC   TTRSAVE(2),MAXTRK  ARE WE ON LAST TRACK OF DATA SET      02164000
         BNL   OVERFLOW    GO TELL OF OVERFLOW CONDITION                02165000
*RECCCHHR = TTRSAVE; /*PUT IN COMTABLE FOR USER ACCESS       @Z427VLS*/ 02166000
         L     @06,SAVER2                                          0835 02167000
         MVI   RECCCHHR+4(@06),C' '                                0835 02168000
         MVC   RECCCHHR(4,@06),TTRSAVE                             0835 02169000
*END;                                                      /*@Z427VLS*/ 02170000
*ELSE /*IF DATA SET IS NOT OPEN                              @Z427VLS*/ 02171000
*  DO;                                                     /*@Z427VLS*/ 02172000
         B     @RC00824                                            0837 02173000
@RF00824 DS    0H                                                  0838 02174000
*    MSGNO = 28;                                           /*@Z427VLS*/ 02175000
         MVC   MSGNO(4),@CF01049                                   0838 02176000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 02177000
         BAL   @14,ERRMSG                                          0839 02178000
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/ 02179000
         MVC   BADNEWS(4),@CF00068                                 0840 02180000
*  END;                                                    /*@Z427VLS*/ 02181000
*RESPECIFY (R7,R12,R1) UNRESTRICTED;                       /*@Z427VLS*/ 02182000
*END; /*CLOSING END TO SCRSCHT PROC                          @Z427VLS*/ 02183000
@EL00019 DS    0H                                                  0843 02184000
@EF00019 DS    0H                                                  0843 02185000
@ER00019 LM    @14,@12,@SA00019                                    0843 02186000
         BR    @14                                                 0843 02187000
*DIRRDSCR: PROC OPTIONS(DONTSAVE(R7)); /*READ DIRECTWK SEQUENTIALLY*/   02188000
DIRRDSCR STM   @14,@06,@SA00020                                    0844 02189000
         STM   @08,@12,@SA00020+36                                 0844 02190000
*                                     /*USING POINT          @Z427VLS*/ 02191000
*RESPECIFY (R7,R6,R12) RESTRICTED;                         /*@Z427VLS*/ 02192000
*IF INDIR = YES &  /*IF DATA SET OPEN AND OPEN FOR SEQUENTIAL*/    0846 02193000
*   CLOSE2 = YES THEN /*POINT READING                        @Z427VLS*/ 02194000
         TM    INDIR,B'00101000'                                   0846 02195000
         BNO   @RF00846                                            0846 02196000
*  DO;                                                     /*@Z427VLS*/ 02197000
*    READWKCT = READWKCT + 1;                              /*@Z427VLS*/ 02198000
         LA    @15,1                                               0848 02199000
         AL    @15,READWKCT                                        0848 02200000
         ST    @15,READWKCT                                        0848 02201000
*    GENERATE;                                             /*@Z427VLS*/ 02202000
         LA    R7,BUF1                                                  02203000
         LA    R12,WORKRDCB                                             02204000
         LA    R6,RECCCHHR                                              02205000
         A     R6,SAVER2                                                02206000
         POINT (12),(6)                                                 02207000
         READ  WORKRDEC,SF,(12),(7)                                     02208000
         CHECK WORKRDEC                                                 02209000
*        R7 = R7 + 4; /*POINT PAST RDW FOR RETURN TO CALLER  @Z427VLS*/ 02210000
         LA    @15,4                                               0850 02211000
         ALR   R7,@15                                              0850 02212000
*        BUF1L = BUF1RDWL; /*MOVE RECORD LENGTH TO 2 BYTES BEFORE REC*/ 02213000
         LH    @14,BUF1RDWL                                        0851 02214000
         STH   @14,BUF1L                                           0851 02215000
*        BUF1L = BUF1L - 4; /*RECORD DATA LENGTH ONLY        @0001VLS*/ 02216000
         SLR   @14,@15                                             0852 02217000
         STH   @14,BUF1L                                           0852 02218000
*        SCRATCH = YES; /*JUST READ CURRENT RECORD OFF DIRECTWK*/  0853 02219000
         OI    SCRATCH,B'01000000'                                 0853 02220000
*        RECLNGTH = BUF1L;                                 /*@Z427VLS*/ 02221000
         L     @15,SAVER2                                          0854 02222000
         STH   @14,RECLNGTH(,@15)                                  0854 02223000
*  END;                                                    /*@Z427VLS*/ 02224000
*ELSE /*DATA SET NOT OPEN                                    @Z427VLS*/ 02225000
*  DO;                                                     /*@Z427VLS*/ 02226000
         B     @RC00846                                            0856 02227000
@RF00846 DS    0H                                                  0857 02228000
*    MSGNO = 46;                                           /*@Z427VLS*/ 02229000
         MVC   MSGNO(4),@CF01054                                   0857 02230000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 02231000
         BAL   @14,ERRMSG                                          0858 02232000
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/ 02233000
         MVC   BADNEWS(4),@CF00068                                 0859 02234000
*  END;                                                    /*@Z427VLS*/ 02235000
*RESPECIFY (R7,R6,R12) UNRESTRICTED;                       /*@Z427VLS*/ 02236000
*END; /*CLOSING END TO PROC DIRRDSER                         @Z427VLS*/ 02237000
@EL00020 DS    0H                                                  0862 02238000
@EF00020 DS    0H                                                  0862 02239000
@ER00020 LM    @14,@06,@SA00020                                    0862 02240000
         LM    @08,@12,@SA00020+36                                 0862 02241000
         BR    @14                                                 0862 02242000
*DIRECTIT: PROC OPTIONS(DONTSAVE(R7)); /*CHOOSE DIRECT READ OF SERLOG*/ 02243000
DIRECTIT STM   @14,@06,@SA00021                                    0863 02244000
         STM   @08,@12,@SA00021+36                                 0863 02245000
*                                     /*OR DIRECTWK          @Z427VLS*/ 02246000
*RESPECIFY (R7) RESTRICTED;                                /*@Z427VLS*/ 02247000
*IF HISTYES = YES THEN /*IS DIRECTWK DATA SET                @Z427VLS*/ 02248000
         TM    HISTYES,B'00010000'                                 0865 02249000
         BNO   @RF00865                                            0865 02250000
*  CALL DIRRDSCR;                                          /*@Z427VLS*/ 02251000
         BAL   @14,DIRRDSCR                                        0866 02252000
*ELSE /*IS SERLOG BY DEFAULT                                 @Z427VLS*/ 02253000
*  CALL DIRRDSER;                                          /*@Z427VLS*/ 02254000
         B     @RC00865                                            0867 02255000
@RF00865 BAL   @14,DIRRDSER                                        0867 02256000
*RESPECIFY (R7) UNRESTRICTED;                              /*@Z427VLS*/ 02257000
*END; /*CLOSING END TO DIRECTIT                              @Z427VLS*/ 02258000
@EL00021 DS    0H                                                  0869 02259000
@EF00021 DS    0H                                                  0869 02260000
@ER00021 LM    @14,@06,@SA00021                                    0869 02261000
         LM    @08,@12,@SA00021+36                                 0869 02262000
         BR    @14                                                 0869 02263000
*CLOSDIR: PROC; /*CLOSE DIRECTWK DATA SET                    @Z427VLS*/ 02264000
CLOSDIR  STM   @14,@12,@SA00022                                    0870 02265000
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/ 02266000
*IF INDIR = YES THEN /*IF DATA SET IS OPEN THEN              @Z427VLS*/ 02267000
         TM    INDIR,B'00100000'                                   0872 02268000
         BNO   @RF00872                                            0872 02269000
*  DO;                                                     /*@Z427VLS*/ 02270000
*    IF CLOSE2 = NO THEN /*IF CLOSING DIRECTWK FOR WRITING   @Z427VLS*/ 02271000
         TM    CLOSE2,B'00001000'                                  0874 02272000
         BNZ   @RF00874                                            0874 02273000
*      DO;                                                 /*@Z427VLS*/ 02274000
*        IF DEBUG15 = ON THEN                                      0876 02275000
         L     @01,SAVER2                                          0876 02276000
         TM    DEBUG15(@01),B'00000001'                            0876 02277000
         BNO   @RF00876                                            0876 02278000
*          DO;                                             /*@Z427VLS*/ 02279000
*            MSGNO = 61;                                   /*@Z427VLS*/ 02280000
         MVC   MSGNO(4),@CF01061                                   0878 02281000
*            CALL ERRMSG;                                  /*@Z427VLS*/ 02282000
         BAL   @14,ERRMSG                                          0879 02283000
*          END;                                            /*@Z427VLS*/ 02284000
*        CLOSE2 = YES; /*INDICATE CLOSED FOR WRITING         @Z427VLS*/ 02285000
@RF00876 OI    CLOSE2,B'00001000'                                  0881 02286000
*        GENERATE;                                         /*@Z427VLS*/ 02287000
         CLOSE (WORKWDCB) CLOSE WRITE DCB                               02288000
         LA    R12,WORKRDCB  GET READING DCB                            02289000
         OPEN  ((R12),(INPUT))     OPEN FOR READING DIRECTWK            02290000
         TM    DCBOFLGS,OPENOK   IF OPEN SUCCESSFUL                     02291000
         BZ    BADBRSEQ     IF FAILS,GO PRINT MESSAGE;     /*@Z427VLS*/ 02292000
*    INDIR = YES; /*INDICATE OPEN SUCCESSFUL                 @Z427VLS*/ 02293000
         OI    INDIR,B'00100000'                                   0883 02294000
*   END;                                                   /*@Z427VLS*/ 02295000
*  ELSE /*CLOSE FOR SEQUENTIAL POINT READING                 @Z427VLS*/ 02296000
*    DO;                                                   /*@Z427VLS*/ 02297000
         B     @RC00874                                            0885 02298000
@RF00874 DS    0H                                                  0886 02299000
*      IF DEBUG15 = ON THEN                                        0886 02300000
         L     @01,SAVER2                                          0886 02301000
         TM    DEBUG15(@01),B'00000001'                            0886 02302000
         BNO   @RF00886                                            0886 02303000
*        DO;                                               /*@Z427VLS*/ 02304000
*          MSGNO = 62;                                     /*@Z427VLS*/ 02305000
         MVC   MSGNO(4),@CF01062                                   0888 02306000
*          CALL ERRMSG;                                    /*@Z427VLS*/ 02307000
         BAL   @14,ERRMSG                                          0889 02308000
*        END;                                              /*@Z427VLS*/ 02309000
*      GEN(CLOSE (WORKRDCB)); /*ISSUE CLOSE SVC              @Z427VLS*/ 02310000
@RF00886 DS    0H                                                  0891 02311000
         CLOSE (WORKRDCB)                                               02312000
*    END;                                                  /*@Z427VLS*/ 02313000
*   END;                                                   /*@Z427VLS*/ 02314000
* ELSE  /*CLOSE REQUESTED WHEN NOT OPEN                      @Z427VLS*/ 02315000
*   DO;                                                    /*@Z427VLS*/ 02316000
         B     @RC00872                                            0894 02317000
@RF00872 DS    0H                                                  0895 02318000
*     IF CLOSEIO ^= CLOSEALL THEN /*END OF JOB WRAPUP IS ALLOWED*/ 0895 02319000
         L     @01,SAVER2                                          0895 02320000
         CLC   CLOSEIO(2,@01),@CB00262                             0895 02321000
         BE    @RF00895                                            0895 02322000
*       DO;                                                /*@Z427VLS*/ 02323000
*         MSGNO = 29;                                      /*@Z427VLS*/ 02324000
         MVC   MSGNO(4),@CF00544                                   0897 02325000
*         CALL ERRMSG;                                     /*@Z427VLS*/ 02326000
         BAL   @14,ERRMSG                                          0898 02327000
*         BADNEWS = TWELVE;                                /*@Z427VLS*/ 02328000
         MVC   BADNEWS(4),@CF00068                                 0899 02329000
*       END;                                               /*@Z427VLS*/ 02330000
*   END;                                                   /*@Z427VLS*/ 02331000
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/ 02332000
*END; /*CLOSING END TO PROC CLOSDIR                          @Z427VLS*/ 02333000
@EL00022 DS    0H                                                  0903 02334000
@EF00022 DS    0H                                                  0903 02335000
@ER00022 LM    @14,@12,@SA00022                                    0903 02336000
         BR    @14                                                 0903 02337000
*READSIT: PROC OPTIONS(DONTSAVE(R7)); /*READ FROM SERLOG OR ACCIN*/     02338000
READSIT  STM   @14,@06,@SA00023                                    0904 02339000
         STM   @08,@12,@SA00023+36                                 0904 02340000
*RESPECIFY (R7) RESTRICTED;           /*SEQUENTIALLY         @Z427VLS*/ 02341000
*IF INHISO = YES THEN /*IF ACCIN IS OPEN, READ IT. IF BOTH SERLOG */    02342000
         TM    INHISO,B'00000001'                                  0906 02343000
         BNO   @RF00906                                            0906 02344000
*  CALL READHIST;     /*AND ACCIN ARE OPEN, READ ACCIN FIRST @Z427VLS*/ 02345000
         BAL   @14,READHIST                                        0907 02346000
*ELSE           /*IMPLIES HISTORY NOT OPEN                   @Z427VLS*/ 02347000
*  DO;                                                     /*@Z427VLS*/ 02348000
         B     @RC00906                                            0908 02349000
@RF00906 DS    0H                                                  0909 02350000
*    IF SERLO = YES THEN /*IF SERLOG IS OPEN THEN IMPLIES ACCIN*/  0909 02351000
         TM    SERLO,B'10000000'                                   0909 02352000
         BNO   @RF00909                                            0909 02353000
*      CALL READSER;    /*NEVER OPEN OR ACCIN HAS BEEN READ, CLOSED*/   02354000
         BAL   @14,READSER                                         0910 02355000
*    ELSE                /*NEITHER DATA SET OPEN IMPLIED     @Z427VLS*/ 02356000
*      DO;                                                 /*@Z427VLS*/ 02357000
         B     @RC00909                                            0911 02358000
@RF00909 DS    0H                                                  0912 02359000
*        BADNEWS = TWELVE; /*SET BAD RETURN CODE             @Z427VLS*/ 02360000
         MVC   BADNEWS(4),@CF00068                                 0912 02361000
*        MSGNO = 21;     /*INDICATE ERROR MESSAGE TEXT NUMBER*/    0913 02362000
         MVC   MSGNO(4),@CF01067                                   0913 02363000
*        CALL ERRMSG; /*PRINT THE ERROR TO TOURIST           @Z427VLS*/ 02364000
         BAL   @14,ERRMSG                                          0914 02365000
*      END;                                                /*@Z427VLS*/ 02366000
*   END;                                                   /*@Z427VLS*/ 02367000
*RESPECIFY (R7) UNRESTRICTED;                              /*@Z427VLS*/ 02368000
* END; /*CLOSING END TO READSIT PROC                         @Z427VLS*/ 02369000
@EL00023 DS    0H                                                  0918 02370000
@EF00023 DS    0H                                                  0918 02371000
@ER00023 LM    @14,@06,@SA00023                                    0918 02372000
         LM    @08,@12,@SA00023+36                                 0918 02373000
         BR    @14                                                 0918 02374000
*READHIST: PROC OPTIONS(DONTSAVE(R7)); /*READ ACCIN SEQUENTIALLY*/ 0919 02375000
READHIST STM   @14,@06,@SA00024                                    0919 02376000
         STM   @08,@12,@SA00024+36                                 0919 02377000
*RESPECIFY (R7,R12) RESTRICTED;                            /*@Z427VLS*/ 02378000
*    ACIRDCT = ACIRDCT + 1; /*ACCIN READ ATTEMPTS            @Z427VLS*/ 02379000
         LA    @06,1                                               0921 02380000
         AL    @06,ACIRDCT                                         0921 02381000
         ST    @06,ACIRDCT                                         0921 02382000
*    R7 = ADDR(BUF1RDW); /*GET ADDRESS OF WORKAREA           @Z427VLS*/ 02383000
         LA    R7,BUF1RDW                                          0922 02384000
*    GEN(LA R12,INHIST); /*GET ADDRESS OF DCB                @Z427VLS*/ 02385000
         LA R12,INHIST                                                  02386000
*    GEN(GET (R12),(R7)); /*RETRIEVE A RECORD. NOTE THAT RECORD WILL*/  02387000
         GET (R12),(R7)                                                 02388000
*                       /*WILL BE HERE FOR RITE TO SCRATCH AND FOR*/    02389000
*                       /*WRITE TO ACCDEV                    @Z427VLS*/ 02390000
*    R7 = R7 + 4; /*POINT PAST RDW FOR RETURN TO CALLER      @Z427VLS*/ 02391000
         LA    @06,4                                               0925 02392000
         ALR   R7,@06                                              0925 02393000
*    FLIPFLOP = YES;  /*TELL READIRCT WHAT STORY IS          @Z427VLS*/ 02394000
         OI    FLIPFLOP,B'00100000'                                0926 02395000
*    RECCCHHR = (RECCCHHR && RECCCHHR); /*SET TO ACCIN INPUT IN PARM*/  02396000
         L     @15,SAVER2                                          0927 02397000
         XC    RECCCHHR(5,@15),RECCCHHR(@15)                       0927 02398000
*    RECLNGTH = BUF1RDWL-4;  /*SET REC LTH IN PARM TABLE     @ZA32483*/ 02399000
         LCR   @06,@06                                             0928 02400000
         AH    @06,BUF1RDWL                                        0928 02401000
         STH   @06,RECLNGTH(,@15)                                  0928 02402000
*RESPECIFY (R7,R12) UNRESTRICTED;                          /*@Z427VLS*/ 02403000
*END; /*CLOSING END TO READHIST PROC                         @Z427VLS*/ 02404000
@EL00024 DS    0H                                                  0930 02405000
@EF00024 DS    0H                                                  0930 02406000
@ER00024 LM    @14,@06,@SA00024                                    0930 02407000
         LM    @08,@12,@SA00024+36                                 0930 02408000
         BR    @14                                                 0930 02409000
*OPENDIR : PROC; /*OPEN DIRECTWK DATA SET FOR SEQUENTIAL LOAD*/    0931 02410000
OPENDIR  STM   @14,@12,@SA00025                                    0931 02411000
*RESPECIFY (R1,R2,R12,R3) RESTRICTED;                      /*@Z427VLS*/ 02412000
*IF INDIR  = NO THEN /*IF IT HASNT BEEN OPENED BEFORE        @Z427VLS*/ 02413000
         TM    INDIR,B'00100000'                                   0933 02414000
         BNZ   @RF00933                                            0933 02415000
*  DO;                                                     /*@Z427VLS*/ 02416000
*    IF DEBUG15 = ON THEN                                          0935 02417000
         L     @15,SAVER2                                          0935 02418000
         TM    DEBUG15(@15),B'00000001'                            0935 02419000
         BNO   @RF00935                                            0935 02420000
*      DO;                                                 /*@Z427VLS*/ 02421000
*        MSGNO = 63;                                       /*@Z427VLS*/ 02422000
         MVC   MSGNO(4),@CF01074                                   0937 02423000
*        CALL ERRMSG;                                      /*@Z427VLS*/ 02424000
         BAL   @14,ERRMSG                                          0938 02425000
*      END;                                                /*@Z427VLS*/ 02426000
*    GEN(LA R12,WORKWDCB); /*GET ADDRESS OF DCB              @Z427VLS*/ 02427000
@RF00935 DS    0H                                                  0940 02428000
         LA R12,WORKWDCB                                                02429000
*    GEN(OPEN ((R12),(OUTPUT))); /*OPEN DIRECTWK TO LOAD SEQUENTIALLY*/ 02430000
         OPEN ((R12),(OUTPUT))                                          02431000
*    GEN(TM DCBOFLGS,OPENOK); /*WAS OPEN SUCCESSFUL          @Z427VLS*/ 02432000
         TM DCBOFLGS,OPENOK                                             02433000
*    GEN(BZ BADBWSEQ);  /*SET BAD RETURN CODE AND PRINT ERRMSG*/   0943 02434000
         BZ BADBWSEQ                                                    02435000
*  GENERATE;                                               /*@Z427VLS*/ 02436000
         L     R1,DCBIFLGS  FLGS NOT SET, ACTUALLY LOAD DCBEBAD         02437000
         LH    R1,46(R1) LOAD NUMBER OF TRACKS IN THIS EXTENT           02438000
         BCTR  R1,R0        SUBTRACT ONE FOR RELATIVE TRACK NUMBER      02439000
         STH   R1,MAXTRK   SAVE NUMBER OF TRACKS OF OVERFLOW CHECK      02440000
*INDIR = YES; /*SET SUCCESSFUL OPEN OF DIRECTWK FLAG         @Z427VLS*/ 02441000
         OI    INDIR,B'00100000'                                   0945 02442000
*END;                                                      /*@Z427VLS*/ 02443000
*ELSE /*IF DATA SET IS ALREADY OPEN                          @Z427VLS*/ 02444000
*  DO;                                                     /*@Z427VLS*/ 02445000
         B     @RC00933                                            0947 02446000
@RF00933 DS    0H                                                  0948 02447000
*    BADNEWS = TWELVE; /*SET RETURN CODE TO ERROR            @Z427VLS*/ 02448000
         MVC   BADNEWS(4),@CF00068                                 0948 02449000
*    MSGNO = 31;                                           /*@Z427VLS*/ 02450000
         MVC   MSGNO(4),@CF00042                                   0949 02451000
*    CALL ERRMSG; /*WRITE MESSAGE TO TOURIST DATA SET        @Z427VLS*/ 02452000
         BAL   @14,ERRMSG                                          0950 02453000
*  END;                                                    /*@Z427VLS*/ 02454000
*RESPECIFY (R1,R12,R2,R3) UNRESTRICTED;                    /*@Z427VLS*/ 02455000
*END; /*CLOSING END TO OPENDIR PROC                          @Z427VLS*/ 02456000
@EL00025 DS    0H                                                  0953 02457000
@EF00025 DS    0H                                                  0953 02458000
@ER00025 LM    @14,@12,@SA00025                                    0953 02459000
         BR    @14                                                 0953 02460000
*OPENHIST: PROC; /*OPEN ACCIN DATA SET                       @Z427VLS*/ 02461000
OPENHIST STM   @14,@12,@SA00026                                    0954 02462000
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/ 02463000
*IF INHISO = NO THEN /*IF IT HASNT BEEN OPENED BEFORE        @Z427VLS*/ 02464000
         TM    INHISO,B'00000001'                                  0956 02465000
         BNZ   @RF00956                                            0956 02466000
*  DO;                                                     /*@Z427VLS*/ 02467000
*    IF DEBUG15 = ON THEN                                          0958 02468000
         L     @01,SAVER2                                          0958 02469000
         TM    DEBUG15(@01),B'00000001'                            0958 02470000
         BNO   @RF00958                                            0958 02471000
*      DO;                                                 /*@Z427VLS*/ 02472000
*        MSGNO = 64;                                       /*@Z427VLS*/ 02473000
         MVC   MSGNO(4),@CF00709                                   0960 02474000
*        CALL ERRMSG;                                      /*@Z427VLS*/ 02475000
         BAL   @14,ERRMSG                                          0961 02476000
*      END;                                                /*@Z427VLS*/ 02477000
*    GEN(LA R12,INHIST); /*GET ADDRESS OF DCB                @Z427VLS*/ 02478000
@RF00958 DS    0H                                                  0963 02479000
         LA R12,INHIST                                                  02480000
*    GEN(OPEN ((R12),(INPUT))); /*OPEN ACCIN                 @Z427VLS*/ 02481000
         OPEN ((R12),(INPUT))                                           02482000
*    GEN(TM DCBOFLGS,OPENOK); /*WAS OPEN SUCCESSFUL          @Z427VLS*/ 02483000
         TM DCBOFLGS,OPENOK                                             02484000
*    GEN(BZ BDOIHST);  /*SET BAD RETURN CODE AND PRINT ERRMSG*/    0966 02485000
         BZ BDOIHST                                                     02486000
*    GEN(TM DCBRECFM,DCBRECV); /*IS CORRECT FORMAT           @Z427VLS*/ 02487000
         TM DCBRECFM,DCBRECV                                            02488000
*    GEN(BZ BDIST);    /*IF NOT, GO TELL WORLD, SET BAD R.C. @Z427VLS*/ 02489000
         BZ BDIST                                                       02490000
*    GEN(TM DCBRECFM,DCBRECU); /*IS RECFM U                  @Z427VLS*/ 02491000
         TM DCBRECFM,DCBRECU                                            02492000
*    GEN(BO BDIST);                                        /*@Z427VLS*/ 02493000
         BO BDIST                                                       02494000
*    INHISO = YES; /*TELL OF SUCCESSFUL OPEN OF ACCIN        @Z427VLS*/ 02495000
*    HISTYES = YES;                                        /*@Z427VLS*/ 02496000
         OI    INHISO,B'00010001'                                  0972 02497000
*  END;                                                    /*@Z427VLS*/ 02498000
*ELSE /*IF OPEN ASKED WHEN ALREADY OPEN                      @Z427VLS*/ 02499000
*  DO;                                                     /*@Z427VLS*/ 02500000
         B     @RC00956                                            0974 02501000
@RF00956 DS    0H                                                  0975 02502000
*    MSGNO = 11; /*TELL WHAT MESSAGE NUMBER TO PRINT         @Z427VLS*/ 02503000
         MVC   MSGNO(4),@CF00032                                   0975 02504000
*    CALL ERRMSG; /*GO SELECT MESSAGE AND PRINT TO TOURIST   @Z427VLS*/ 02505000
         BAL   @14,ERRMSG                                          0976 02506000
*    BADNEWS = TWELVE; /*TELL USER BAD NEWS                  @Z427VLS*/ 02507000
         MVC   BADNEWS(4),@CF00068                                 0977 02508000
*  END;                                                    /*@Z427VLS*/ 02509000
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/ 02510000
*END; /*CLOSING END TO OPEN HISTORY INPUT DATA SET PROC      @Z427VLS*/ 02511000
@EL00026 DS    0H                                                  0980 02512000
@EF00026 DS    0H                                                  0980 02513000
@ER00026 LM    @14,@12,@SA00026                                    0980 02514000
         BR    @14                                                 0980 02515000
*CLOSHIST: PROC; /*CLOSE ACCIN DATA SET                      @Z427VLS*/ 02516000
CLOSHIST STM   @14,@12,@SA00027                                    0981 02517000
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/ 02518000
*IF INHISO = YES THEN /*IF DATA SET IS OPEN THEN             @Z427VLS*/ 02519000
         TM    INHISO,B'00000001'                                  0983 02520000
         BNO   @RF00983                                            0983 02521000
*  DO;                                                     /*@Z427VLS*/ 02522000
*    IF DEBUG15 = ON THEN                                          0985 02523000
         L     @01,SAVER2                                          0985 02524000
         TM    DEBUG15(@01),B'00000001'                            0985 02525000
         BNO   @RF00985                                            0985 02526000
*      DO;                                                 /*@Z427VLS*/ 02527000
*        MSGNO = 65;                                       /*@Z427VLS*/ 02528000
         MVC   MSGNO(4),@CF01081                                   0987 02529000
*        CALL ERRMSG;                                      /*@Z427VLS*/ 02530000
         BAL   @14,ERRMSG                                          0988 02531000
*      END;                                                /*@Z427VLS*/ 02532000
*    GEN(LA  R12,INHIST); /*GET ACCIN DCB ADDRESS            @Z427VLS*/ 02533000
@RF00985 DS    0H                                                  0990 02534000
         LA  R12,INHIST                                                 02535000
*    GEN(CLOSE  (INHIST));         /*ISSUE CLOSE SVC         @Z427VLS*/ 02536000
         CLOSE  (INHIST)                                                02537000
*    GEN(FREEPOOL  (R12)); /*GET RID OF ACCIN BUFFERS        @Z427VLS*/ 02538000
         FREEPOOL  (R12)                                                02539000
*    INHISO = NO; /*SAY THAT ACCIN IS CLOSED                 @Z427VLS*/ 02540000
         NI    INHISO,B'11111110'                                  0993 02541000
*  END;                                                    /*@Z427VLS*/ 02542000
*ELSE  /*IF DATA SET IS ALREADY CLOSED                       @Z427VLS*/ 02543000
*  DO;                                                     /*@Z427VLS*/ 02544000
         B     @RC00983                                            0995 02545000
@RF00983 DS    0H                                                  0996 02546000
*    IF CLOSEIO ^= CLOSEALL THEN                                   0996 02547000
         L     @01,SAVER2                                          0996 02548000
         CLC   CLOSEIO(2,@01),@CB00262                             0996 02549000
         BE    @RF00996                                            0996 02550000
*    DO;                                                   /*@Z427VLS*/ 02551000
*    MSGNO = 12;                                           /*@Z427VLS*/ 02552000
         LA    @15,12                                              0998 02553000
         ST    @15,MSGNO                                           0998 02554000
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/ 02555000
         ST    @15,BADNEWS                                         0999 02556000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 02557000
         BAL   @14,ERRMSG                                          1000 02558000
*    END;                                                  /*@Z427VLS*/ 02559000
*  END;                                                    /*@Z427VLS*/ 02560000
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/ 02561000
*END; /*CLOSING END TO CLOSE ACCIN DATA SET PROC             @Z427VLS*/ 02562000
@EL00027 DS    0H                                                  1004 02563000
@EF00027 DS    0H                                                  1004 02564000
@ER00027 LM    @14,@12,@SA00027                                    1004 02565000
         BR    @14                                                 1004 02566000
*CLOSEDEV: PROC; /*PROC TO CLOSE ACCDEV DATA SET             @Z427VLS*/ 02567000
CLOSEDEV STM   @14,@12,@SA00028                                    1005 02568000
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/ 02569000
*IF HISTOPN = YES THEN                                             1007 02570000
         TM    HISTOPN,B'10000000'                                 1007 02571000
         BNO   @RF01007                                            1007 02572000
*  DO;                                                     /*@Z427VLS*/ 02573000
*    IF DEBUG15 = ON THEN                                          1009 02574000
         L     @01,SAVER2                                          1009 02575000
         TM    DEBUG15(@01),B'00000001'                            1009 02576000
         BNO   @RF01009                                            1009 02577000
*      DO;                                                 /*@Z427VLS*/ 02578000
*        MSGNO = 66;                                       /*@Z427VLS*/ 02579000
         MVC   MSGNO(4),@CF01085                                   1011 02580000
*        CALL ERRMSG;                                      /*@Z427VLS*/ 02581000
         BAL   @14,ERRMSG                                          1012 02582000
*      END;                                                /*@Z427VLS*/ 02583000
*    GEN(LA R12,OUTHIST); /*FIND ADDRESS OF DCB              @Z427VLS*/ 02584000
@RF01009 DS    0H                                                  1014 02585000
         LA R12,OUTHIST                                                 02586000
*    GEN(CLOSE (OUTHIST));       /*ISSUE CLOSE SVC           @Z427VLS*/ 02587000
         CLOSE (OUTHIST)                                                02588000
*    GEN(FREEPOOL  (R12)); /*GET RID OF ACCDEV BUFFERS       @Z427VLS*/ 02589000
         FREEPOOL  (R12)                                                02590000
*    HISTOPN = NO; /*SAY THAT DATA SET IS CLOSED             @Z427VLS*/ 02591000
         NI    HISTOPN,B'01111111'                                 1017 02592000
*  END;                                                    /*@Z427VLS*/ 02593000
*ELSE /*IF ACCDEV IS ALREADY CLOSED                          @Z427VLS*/ 02594000
* DO;                                                      /*@Z427VLS*/ 02595000
         B     @RC01007                                            1019 02596000
@RF01007 DS    0H                                                  1020 02597000
*   IF CLOSEIO ^= CLOSEALL /*END OF JOB STEP VALID REQUEST   @Z427VLS*/ 02598000
*     THEN DO;                                             /*@Z427VLS*/ 02599000
         L     @01,SAVER2                                          1020 02600000
         CLC   CLOSEIO(2,@01),@CB00262                             1020 02601000
         BE    @RF01020                                            1020 02602000
*       MSGNO = 8;                                         /*@Z427VLS*/ 02603000
         MVC   MSGNO(4),@CF00035                                   1022 02604000
*       BADNEWS = TWELVE;                                  /*@Z427VLS*/ 02605000
         MVC   BADNEWS(4),@CF00068                                 1023 02606000
*       CALL ERRMSG;                                       /*@Z427VLS*/ 02607000
         BAL   @14,ERRMSG                                          1024 02608000
*     END;                                                 /*@Z427VLS*/ 02609000
* END;                                                     /*@Z427VLS*/ 02610000
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/ 02611000
*END; /*CLOSING END TO PROC CLOSEDEV                         @Z427VLS*/ 02612000
@EL00028 DS    0H                                                  1028 02613000
@EF00028 DS    0H                                                  1028 02614000
@ER00028 LM    @14,@12,@SA00028                                    1028 02615000
         BR    @14                                                 1028 02616000
*OPENTOUR : PROC; /*OPEN THE TOURIST DATA SET                @Z427VLS*/ 02617000
OPENTOUR STM   @14,@12,@SA00029                                    1029 02618000
*RESPECIFY (R12,R7) RESTRICTED;                            /*@Z427VLS*/ 02619000
*  IF TOUROPN = NO THEN /*ILLEGAL TO OPEN AN OPEN DATA SET   @Z427VLS*/ 02620000
         TM    TOUROPN,B'00000010'                                 1031 02621000
         BNZ   @RF01031                                            1031 02622000
*    DO;                                                   /*@Z427VLS*/ 02623000
*      GENERATE;                                           /*@Z427VLS*/ 02624000
         LA    R12,TOURDCB                                              02625000
         OPEN  ((R12),(OUTPUT))                                         02626000
         TM    DCBOFLGS,OPENOK    CHECK FOR SUCCESS                     02627000
         BZ    BADOTOUR                                                 02628000
*      TOUROPN = YES; /*HURRAY FOR SUCCESSFUL OPEN           @Z427VLS*/ 02629000
         OI    TOUROPN,B'00000010'                                 1034 02630000
*      PRINTADR = ADDR(PRNTBF);                            /*@Z427VLS*/ 02631000
         LA    @06,PRNTBF                                          1035 02632000
         L     @01,SAVER2                                          1035 02633000
         ST    @06,PRINTADR(,@01)                                  1035 02634000
*      R7 = PRINTADR + 1;                                  /*@Z427VLS*/ 02635000
         LA    R7,1                                                1036 02636000
         ALR   R7,@06                                              1036 02637000
*      PRINTCC = SKIPNEW;                                  /*@Z427VLS*/ 02638000
         MVI   PRINTCC(@06),X'8B'                                  1037 02639000
*      GEN(PUT  (R12),(R7)); /*INITIAL SKIP TO NEW PAGE      @Z427VLS*/ 02640000
         PUT  (R12),(R7)                                                02641000
*    END;                                                  /*@Z427VLS*/ 02642000
* ELSE  /*IF TOURIST ALREADY OPEN THEN                       @Z427VLS*/ 02643000
*   DO;                                                    /*@Z427VLS*/ 02644000
         B     @RC01031                                            1040 02645000
@RF01031 DS    0H                                                  1041 02646000
*     MSGNO = 23;                                          /*@Z427VLS*/ 02647000
         MVC   MSGNO(4),@CF01089                                   1041 02648000
*     CALL ERRMSG;                                         /*@Z427VLS*/ 02649000
         BAL   @14,ERRMSG                                          1042 02650000
*     BADNEWS = TWELVE;                                    /*@Z427VLS*/ 02651000
         MVC   BADNEWS(4),@CF00068                                 1043 02652000
*   END;                                                   /*@Z427VLS*/ 02653000
*RESPECIFY (R12,R7) UNRESTRICTED;                          /*@Z427VLS*/ 02654000
*END; /*CLOSING END TO PROC OPENTOUR                         @Z427VLS*/ 02655000
@EL00029 DS    0H                                                  1046 02656000
@EF00029 DS    0H                                                  1046 02657000
@ER00029 LM    @14,@12,@SA00029                                    1046 02658000
         BR    @14                                                 1046 02659000
*CLOSTOUR: PROC; /*CLOSE THE TOURIST DATA SET                @Z427VLS*/ 02660000
CLOSTOUR STM   @14,@12,@SA00030                                    1047 02661000
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/ 02662000
*IF TOUROPN = YES THEN /*IF REALLY NEEDS CLOSING             @Z427VLS*/ 02663000
         TM    TOUROPN,B'00000010'                                 1049 02664000
         BNO   @RF01049                                            1049 02665000
*  DO;                                                     /*@Z427VLS*/ 02666000
*    IF DEBUG15 = ON THEN /*PRINT SUMMARY OF IO OPERATIONS DURING RUN*/ 02667000
         L     @01,SAVER2                                          1051 02668000
         TM    DEBUG15(@01),B'00000001'                            1051 02669000
         BNO   @RF01051                                            1051 02670000
*             DO J = 1 TO 11; /*PRINT ALL DEBUG15 TOTALS     @G51DGBB*/ 02671000
         LA    @15,1                                               1052 02672000
         ST    @15,J                                               1052 02673000
@DL01052 DS    0H                                                  1053 02674000
*           MSGNO = J + 70; /*INCREMENT PAST SYSTEM MESSAGES @G51DGBB*/ 02675000
         AL    @15,@CF00932                                        1053 02676000
         ST    @15,MSGNO                                           1053 02677000
*          CALL ERRMSG; /*PRINT OUT SUMMARY MESSAGE TEXT     @Z427VLS*/ 02678000
         BAL   @14,ERRMSG                                          1054 02679000
*          PASSNUM = CTPTR(J); /*ACCESS PARTICULAR COUNT     @Z427VLS*/ 02680000
         L     @15,J                                               1055 02681000
         SLA   @15,2                                               1055 02682000
         L     @15,CTPTR-4(@15)                                    1055 02683000
         ST    @15,PASSNUM                                         1055 02684000
*          CVD(PASSNUM,PACKPAS); /*CONVERT BINARY TO PACKED  @Z427VLS*/ 02685000
         CVD   @15,@TS00001                                        1056 02686000
         MVC   PACKPAS(4),@TS00001+4                               1056 02687000
*          PACKPAS = (PACKPAS | '0000000F'X); /*TURN C TO F  @Z427VLS*/ 02688000
         OC    PACKPAS(4),@CB01094                                 1057 02689000
*          UNPK(EDFLD,PACKPAS); /*CHANGE PACKED TO PRINTABLE @Z427VLS*/ 02690000
         UNPK  EDFLD(9),PACKPAS(4)                                 1058 02691000
*          NONBLANK = OFF;                                 /*@Z427VLS*/ 02692000
         NI    NONBLANK,B'11101111'                                1059 02693000
*          DO K = 1 BY 1 TO 8 WHILE NONBLANK = OFF;        /*@Z427VLS*/ 02694000
         LA    @15,1                                               1060 02695000
         ST    @15,K                                               1060 02696000
@DL01060 TM    NONBLANK,B'00010000'                                1060 02697000
         BNZ   @DC01060                                            1060 02698000
*            IF EDIFILD(K) = CHARZERO THEN                         1061 02699000
         LA    @14,EDIFILD-1(@15)                                  1061 02700000
         CLI   0(@14),X'F0'                                        1061 02701000
         BNE   @RF01061                                            1061 02702000
*              EDIFILD(K) = BLANK;                         /*@Z427VLS*/ 02703000
         LA    @14,EDIFILD-1(@15)                                  1062 02704000
         MVI   0(@14),X'40'                                        1062 02705000
*            ELSE                                                  1063 02706000
*              NONBLANK = ON;                              /*@Z427VLS*/ 02707000
         B     @RC01061                                            1063 02708000
@RF01061 OI    NONBLANK,B'00010000'                                1063 02709000
*          END;                                            /*@Z427VLS*/ 02710000
@RC01061 LA    @15,1                                               1064 02711000
         AL    @15,K                                               1064 02712000
         ST    @15,K                                               1064 02713000
         C     @15,@CF00035                                        1064 02714000
         BNH   @DL01060                                            1064 02715000
@DC01060 DS    0H                                                  1065 02716000
*          PRINTADR = ADDR(PRNTBF);                        /*@Z427VLS*/ 02717000
         LA    @15,PRNTBF                                          1065 02718000
         L     @14,SAVER2                                          1065 02719000
         ST    @15,PRINTADR(,@14)                                  1065 02720000
*          PRINTDS = '1'; /*INDICATE PRINT TO TOURIST        @Z427VLS*/ 02721000
         MVI   PRINTDS(@15),C'1'                                   1066 02722000
*          PRINTBDY = (PRINTBDY && PRINTBDY);              /*@Z427VLS*/ 02723000
         XC    PRINTBDY(132,@15),PRINTBDY(@15)                     1067 02724000
*          GEN(MVC PRNTBF+10(9),EDFLD);                    /*@Z427VLS*/ 02725000
         MVC PRNTBF+10(9),EDFLD                                         02726000
*          CALL PRINTIT;                                   /*@Z427VLS*/ 02727000
         BAL   @14,PRINTIT                                         1069 02728000
*        END;                                              /*@Z427VLS*/ 02729000
         LA    @15,1                                               1070 02730000
         AL    @15,J                                               1070 02731000
         ST    @15,J                                               1070 02732000
         C     @15,@CF00032                                        1070 02733000
         BNH   @DL01052                                            1070 02734000
*    GENERATE;                                             /*@Z427VLS*/ 02735000
@RF01051 DS    0H                                                  1071 02736000
         LA    R12,TOURDCB                                              02737000
         CLOSE (TOURDCB)                                                02738000
         FREEPOOL (12)                                                  02739000
*    TOUROPN = NO; /*INDICATE CLOSE                          @Z427VLS*/ 02740000
         NI    TOUROPN,B'11111101'                                 1072 02741000
* END;                                                     /*@Z427VLS*/ 02742000
*ELSE /*IF ALREADY CLOSED THEN                               @Z427VLS*/ 02743000
* DO;                                                      /*@Z427VLS*/ 02744000
         B     @RC01049                                            1074 02745000
@RF01049 DS    0H                                                  1075 02746000
*   IF CLOSEIO ^= CLOSEALL THEN /*LEGAL TO DO END OF JOB WRAPUP*/  1075 02747000
         L     @15,SAVER2                                          1075 02748000
         CLC   CLOSEIO(2,@15),@CB00262                             1075 02749000
         BE    @RF01075                                            1075 02750000
*     DO;                                                  /*@Z427VLS*/ 02751000
*       R2 = SAVER2;    /*INSURE COMTABLE ADDRESSED BY R2    @ZA31549*/ 02752000
         LR    R2,@15                                              1077 02753000
*       CALL IFCMSG(204,ADDR(PRNTBF));                     /*@Z427VLS*/ 02754000
         LA    @14,PRNTBF                                          1078 02755000
         ST    @14,@AFTEMPS+12                                     1078 02756000
         L     @15,ADIFCMSG(,@15)                                  1078 02757000
         LA    @01,@AL01078                                        1078 02758000
         BALR  @14,@15                                             1078 02759000
*       BADNEWS = TWELVE;                                  /*@Z427VLS*/ 02760000
         MVC   BADNEWS(4),@CF00068                                 1079 02761000
*     END;                                                 /*@Z427VLS*/ 02762000
* END;                                                     /*@Z427VLS*/ 02763000
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/ 02764000
*END; /*CLOSING END TO CLOSTOUR PROCEDURE                    @Z427VLS*/ 02765000
@EL00030 DS    0H                                                  1083 02766000
@EF00030 DS    0H                                                  1083 02767000
@ER00030 LM    @14,@12,@SA00030                                    1083 02768000
         BR    @14                                                 1083 02769000
*OPENERPT: PROC; /*OPEN THE ERREPT D.S. FOR PRINTING         @Z427VLS*/ 02770000
OPENERPT STM   @14,@12,@SA00031                                    1084 02771000
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/ 02772000
*IF ERPTOPN = NO THEN                                              1086 02773000
         TM    ERPTOPN,B'00000001'                                 1086 02774000
         BNZ   @RF01086                                            1086 02775000
*  DO;                                                     /*@Z427VLS*/ 02776000
*    IF DEBUG15 = ON THEN                                          1088 02777000
         L     @01,SAVER2                                          1088 02778000
         TM    DEBUG15(@01),B'00000001'                            1088 02779000
         BNO   @RF01088                                            1088 02780000
*      DO;                                                 /*@Z427VLS*/ 02781000
*        MSGNO = 67;                                       /*@Z427VLS*/ 02782000
         MVC   MSGNO(4),@CF01100                                   1090 02783000
*        CALL ERRMSG;                                      /*@Z427VLS*/ 02784000
         BAL   @14,ERRMSG                                          1091 02785000
*      END;                                                /*@Z427VLS*/ 02786000
*    GENERATE;                                             /*@Z427VLS*/ 02787000
@RF01088 DS    0H                                                  1093 02788000
         LA    R12,EREPTDCB                                             02789000
         OPEN  ((R12),(OUTPUT))                                         02790000
         TM    DCBOFLGS,OPENOK                                          02791000
         BZ    BADORPT                                                  02792000
*    ERPTOPN = YES; /*INDICATE SUCCESSFUL OPEN               @Z427VLS*/ 02793000
         OI    ERPTOPN,B'00000001'                                 1094 02794000
*  END;                                                    /*@Z427VLS*/ 02795000
*ELSE /*IF OPEN REQUESTED WHEN DATA SET ALREADY OPEN         @Z427VLS*/ 02796000
*  DO;                                                     /*@Z427VLS*/ 02797000
         B     @RC01086                                            1096 02798000
@RF01086 DS    0H                                                  1097 02799000
*    MSGNO = 45;                                           /*@Z427VLS*/ 02800000
         MVC   MSGNO(4),@CF01101                                   1097 02801000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 02802000
         BAL   @14,ERRMSG                                          1098 02803000
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/ 02804000
         MVC   BADNEWS(4),@CF00068                                 1099 02805000
*  END;                                                    /*@Z427VLS*/ 02806000
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/ 02807000
*END; /*CLOSING END TO PROC OPENERPT                         @Z427VLS*/ 02808000
@EL00031 DS    0H                                                  1102 02809000
@EF00031 DS    0H                                                  1102 02810000
@ER00031 LM    @14,@12,@SA00031                                    1102 02811000
         BR    @14                                                 1102 02812000
*CLOSERPT : PROC; /*OPEN ERREPT DATA SET                     @Z427VLS*/ 02813000
CLOSERPT STM   @14,@12,@SA00032                                    1103 02814000
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/ 02815000
*IF ERPTOPN = YES THEN /*MUST BE OPEN IN ORDER TO CLOSE      @Z427VLS*/ 02816000
         TM    ERPTOPN,B'00000001'                                 1105 02817000
         BNO   @RF01105                                            1105 02818000
*  DO;                                                     /*@Z427VLS*/ 02819000
*    IF DEBUG15 = ON THEN                                          1107 02820000
         L     @01,SAVER2                                          1107 02821000
         TM    DEBUG15(@01),B'00000001'                            1107 02822000
         BNO   @RF01107                                            1107 02823000
*      DO;                                                 /*@Z427VLS*/ 02824000
*        MSGNO = 68;                                       /*@Z427VLS*/ 02825000
         MVC   MSGNO(4),@CF01105                                   1109 02826000
*        CALL ERRMSG;                                      /*@Z427VLS*/ 02827000
         BAL   @14,ERRMSG                                          1110 02828000
*      END;                                                /*@Z427VLS*/ 02829000
*    GENERATE;                                             /*@Z427VLS*/ 02830000
@RF01107 DS    0H                                                  1112 02831000
         LA    R12,EREPTDCB                                             02832000
         CLOSE (EREPTDCB)                                               02833000
         FREEPOOL (R12)                                                 02834000
*    ERPTOPN = NO; /*INDICATE ERREPT IS CLOSED               @Z427VLS*/ 02835000
         NI    ERPTOPN,B'11111110'                                 1113 02836000
*  END;                                                    /*@Z427VLS*/ 02837000
*ELSE /*IF CLOSE REQUESTED WHEN NOT OPEN THEN                @Z427VLS*/ 02838000
* DO;                                                      /*@Z427VLS*/ 02839000
         B     @RC01105                                            1115 02840000
@RF01105 DS    0H                                                  1116 02841000
*   IF CLOSEIO ^= CLOSEALL THEN  /*VALID POTPOURI OF CLOSES  @Z427VLS*/ 02842000
         L     @01,SAVER2                                          1116 02843000
         CLC   CLOSEIO(2,@01),@CB00262                             1116 02844000
         BE    @RF01116                                            1116 02845000
*     DO;                                                  /*@Z427VLS*/ 02846000
*       MSGNO = 22;                                        /*@Z427VLS*/ 02847000
         MVC   MSGNO(4),@CF01106                                   1118 02848000
*       CALL ERRMSG;                                       /*@Z427VLS*/ 02849000
         BAL   @14,ERRMSG                                          1119 02850000
*       BADNEWS = TWELVE;                                  /*@Z427VLS*/ 02851000
         MVC   BADNEWS(4),@CF00068                                 1120 02852000
*     END;                                                 /*@Z427VLS*/ 02853000
*   END;                                                   /*@Z427VLS*/ 02854000
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/ 02855000
*END; /*CLOSING END TO CLOSERPT PROC                         @Z427VLS*/ 02856000
@EL00032 DS    0H                                                  1124 02857000
@EF00032 DS    0H                                                  1124 02858000
@ER00032 LM    @14,@12,@SA00032                                    1124 02859000
         BR    @14                                                 1124 02860000
*OPENDEV: PROC; /*OPEN ACCDEV DATA SET                       @Z427VLS*/ 02861000
OPENDEV  STM   @14,@12,@SA00033                                    1125 02862000
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/ 02863000
*IF HISTOPN = NO THEN /*IF DATA SET HAS NOT ALREADY BEEN OPENED*/  1127 02864000
         TM    HISTOPN,B'10000000'                                 1127 02865000
         BNZ   @RF01127                                            1127 02866000
*  DO;                                                     /*@Z427VLS*/ 02867000
*    IF DEBUG15 = ON THEN                                          1129 02868000
         L     @01,SAVER2                                          1129 02869000
         TM    DEBUG15(@01),B'00000001'                            1129 02870000
         BNO   @RF01129                                            1129 02871000
*      DO;                                                 /*@Z427VLS*/ 02872000
*        MSGNO = 69;                                       /*@Z427VLS*/ 02873000
         MVC   MSGNO(4),@CF01110                                   1131 02874000
*        CALL ERRMSG;                                      /*@Z427VLS*/ 02875000
         BAL   @14,ERRMSG                                          1132 02876000
*      END;                                                /*@Z427VLS*/ 02877000
*    GEN(LA (R12),OUTHIST); /*FIND ADDRESS OF DCB            @Z427VLS*/ 02878000
@RF01129 DS    0H                                                  1134 02879000
         LA (R12),OUTHIST                                               02880000
*    GEN(OPEN ((R12),(OUTPUT,DISP))); /*ISSUE OPEN SVC       @Z427VLS*/ 02881000
         OPEN ((R12),(OUTPUT,DISP))                                     02882000
*    GEN(TM DCBOFLGS,OPENOK); /*WAS OPEN SUCCESSFULL         @Z427VLS*/ 02883000
         TM DCBOFLGS,OPENOK                                             02884000
*    GEN(BZ BADOOHST); /*GO TO ERROR ROUTINE                 @Z427VLS*/ 02885000
         BZ BADOOHST                                                    02886000
*    HISTOPN = YES;                                        /*@Z427VLS*/ 02887000
         OI    HISTOPN,B'10000000'                                 1138 02888000
*  END;                                                    /*@Z427VLS*/ 02889000
*ELSE                                                              1140 02890000
*  DO;                                                     /*@Z427VLS*/ 02891000
         B     @RC01127                                            1140 02892000
@RF01127 DS    0H                                                  1141 02893000
*    MSGNO = 2;                                            /*@Z427VLS*/ 02894000
         MVC   MSGNO(4),@CF00075                                   1141 02895000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 02896000
         BAL   @14,ERRMSG                                          1142 02897000
*    BADNEWS = TWELVE; /*ABORT RETURN CODE                   @Z427VLS*/ 02898000
         MVC   BADNEWS(4),@CF00068                                 1143 02899000
*  END;                                                    /*@Z427VLS*/ 02900000
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/ 02901000
*END; /*CLOSING END TO PROC OPENDEV                          @Z427VLS*/ 02902000
@EL00033 DS    0H                                                  1146 02903000
@EF00033 DS    0H                                                  1146 02904000
@ER00033 LM    @14,@12,@SA00033                                    1146 02905000
         BR    @14                                                 1146 02906000
*HISTIT: PROC; /*WRITE TO ACCDEV USING QSAM                  @Z427VLS*/ 02907000
HISTIT   STM   @14,@12,@SA00034                                    1147 02908000
*RESPECIFY (R12,R7) RESTRICTED;                            /*@Z427VLS*/ 02909000
*IF HISTOPN = YES THEN                                             1149 02910000
         TM    HISTOPN,B'10000000'                                 1149 02911000
         BNO   @RF01149                                            1149 02912000
*  DO;                                                     /*@Z427VLS*/ 02913000
*    DEVCT = DEVCT + 1;                                    /*@Z427VLS*/ 02914000
         LA    @06,1                                               1151 02915000
         AL    @06,DEVCT                                           1151 02916000
         ST    @06,DEVCT                                           1151 02917000
*    GEN(LA (R12),OUTHIST); /*GET DCB ADDRESS                @Z427VLS*/ 02918000
         LA (R12),OUTHIST                                               02919000
*    R7 = ADDR(BUF1RDW); /*ADDRESS THE RECORD DESCRIPTOR WORD*/    1153 02920000
         LA    R7,BUF1RDW                                          1153 02921000
*    IF SCRATCH = YES THEN /*IF FRAMES FROM DIRECTWK, MUST FIX REC*/    02922000
         TM    SCRATCH,B'01000000'                                 1154 02923000
         BNO   @RF01154                                            1154 02924000
*      DO;                 /*ORD DESCRIPTOR WORD BECAUSE IT WAS   */    02925000
*                          /*MANGLED FOR EDSUM MODULES       @G51DGBB*/ 02926000
*        BUF1RDWL = BUF1L + 4; /*RE-ADD RDW LENGTH, MOVE TO RDW   */    02927000
         LH    @06,BUF1L                                           1156 02928000
         LA    @06,4(,@06)                                         1156 02929000
         STH   @06,BUF1RDWL                                        1156 02930000
*        BUF1L = '0000'X;      /*FINISH RDW RIGHTMOST TWO BYTES   */    02931000
         SLR   @06,@06                                             1157 02932000
         STH   @06,BUF1L                                           1157 02933000
*        R7 = ADDR(BUF1);      /*POINT TO RECORD FOR QSAM PUT     */    02934000
         LA    R7,BUF1                                             1158 02935000
*      END;                                                /*@G51DGBB*/ 02936000
*    ELSE   /*RECORD NOT RETRIEVED FROM DIRECTWK             @G51DGBB*/ 02937000
*      IF FLIPFLOP = OFF THEN /*IF RECORD FROM READSEQ OF LOGREC*/ 1160 02938000
         B     @RC01154                                            1160 02939000
@RF01154 TM    FLIPFLOP,B'00100000'                                1160 02940000
         BNZ   @RF01160                                            1160 02941000
*        DO;                                               /*@G51DGBB*/ 02942000
*          BBRDW = SAVELENT; /*GET UNMODIFIED QSAM LENGTH    @G51DGBB*/ 02943000
         LH    @06,SAVELENT                                        1162 02944000
         STH   @06,BBRDW                                           1162 02945000
*          BSIZE = '0000'X; /*COMPLETE RDW                   @G51DGBB*/ 02946000
         MVC   BSIZE(2),@CB00209                                   1163 02947000
*          R7 = ADDR(BBRDW);                               /*@G51DGBB*/ 02948000
         LA    R7,BBRDW                                            1164 02949000
*        END;                                              /*@G51DGBB*/ 02950000
*    GEN(PUT  (R12),(R7)); /*ISSUE WRITE SVC USING QSAM      @Z427VLS*/ 02951000
@RF01160 DS    0H                                                  1166 02952000
@RC01154 DS    0H                                                  1166 02953000
         PUT  (R12),(R7)                                                02954000
*  END;                                                    /*@Z427VLS*/ 02955000
*ELSE                                                              1168 02956000
*  DO;                                                     /*@Z427VLS*/ 02957000
         B     @RC01149                                            1168 02958000
@RF01149 DS    0H                                                  1169 02959000
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/ 02960000
         MVC   BADNEWS(4),@CF00068                                 1169 02961000
*    MSGNO = 4;                                            /*@Z427VLS*/ 02962000
         MVC   MSGNO(4),@CF00065                                   1170 02963000
*    CALL ERRMSG;                                          /*@Z427VLS*/ 02964000
         BAL   @14,ERRMSG                                          1171 02965000
*  END;                                                    /*@Z427VLS*/ 02966000
*RESPECIFY (R7,R12) UNRESTRICTED;                          /*@Z427VLS*/ 02967000
*END; /*CLOSING END TO PROC HISTIT                           @Z427VLS*/ 02968000
@EL00034 DS    0H                                                  1174 02969000
@EF00034 DS    0H                                                  1174 02970000
@ER00034 LM    @14,@12,@SA00034                                    1174 02971000
         BR    @14                                                 1174 02972000
*/*PROC TO CONVERT HEX DAT INTO PRINTABLE FORMAT             @Z427VLS*/ 02973000
*/* ITEM NUMBER IS NUMBER OF BYTES TO BE CONVERTED           @Z427VLS*/ 02974000
*/* ITEM NEXTBY IS THE ADDRESS OF THE DATA TO BE CONVERTED   @Z427VLS*/ 02975000
*/* ITEM ADDNXT IS THE LOCATION WHERE THE CONVERTED DATA IS TO BE PUT*/ 02976000
*CONVERT: PROC;                                            /*@Z427VLS*/ 02977000
CONVERT  STM   @14,@12,12(@13)                                     1175 02978000
*RESPECIFY (R2,R3) RESTRICTED;                             /*@Z427VLS*/ 02979000
*DO J = NUMBER BY -1 TO 1;                                 /*@Z427VLS*/ 02980000
         L     @12,NUMBER                                          1177 02981000
         ST    @12,J                                               1177 02982000
         B     @DE01177                                            1177 02983000
@DL01177 DS    0H                                                  1178 02984000
*  R2 = NEXTBYTE(J);                                       /*@Z427VLS*/ 02985000
         L     @01,NEXTBY                                          1178 02986000
         BCTR  @01,0                                               1178 02987000
         SLR   R2,R2                                               1178 02988000
         IC    R2,NEXTBYTE(@12,@01)                                1178 02989000
*  K  = 2 * J;                                             /*@Z427VLS*/ 02990000
         LR    @15,@12                                             1179 02991000
         ALR   @15,@15                                             1179 02992000
         ST    @15,K                                               1179 02993000
*  SRDL(R2,4);                                             /*@Z427VLS*/ 02994000
         SRDL  R2,4                                                1180 02995000
*  SRL(R3,28);                                             /*@Z427VLS*/ 02996000
         SRL   R3,28                                               1181 02997000
*  R3 = R3 + 1;                                            /*@Z427VLS*/ 02998000
         LA    @14,1                                               1182 02999000
         ALR   R3,@14                                              1182 03000000
*  R2 = R2 + 1;                                            /*@Z427VLS*/ 03001000
         ALR   R2,@14                                              1183 03002000
*  ADDNUM(K-1) = CHARS(R2);                                /*@Z427VLS*/ 03003000
         L     @14,ADDNXT                                          1184 03004000
         ALR   @15,@14                                             1184 03005000
         BCTR  @15,0                                               1184 03006000
         BCTR  @15,0                                               1184 03007000
         LA    @01,CHARS-1(R2)                                     1184 03008000
         MVC   ADDNUM(1,@15),0(@01)                                1184 03009000
*  ADDNUM(K) = CHARS(R3);                                  /*@Z427VLS*/ 03010000
         L     @15,K                                               1185 03011000
         ALR   @14,@15                                             1185 03012000
         BCTR  @14,0                                               1185 03013000
         LA    @15,CHARS-1(R3)                                     1185 03014000
         MVC   ADDNUM(1,@14),0(@15)                                1185 03015000
*END;                                                      /*@Z427VLS*/ 03016000
         BCTR  @12,0                                               1186 03017000
         ST    @12,J                                               1186 03018000
@DE01177 LTR   @12,@12                                             1186 03019000
         BP    @DL01177                                            1186 03020000
*RESPECIFY (R2,R3) UNRESTRICTED;                           /*@Z427VLS*/ 03021000
*END; /*CLOSING END TO PROC CONVERT                          @Z427VLS*/ 03022000
@EL00035 DS    0H                                                  1188 03023000
@EF00035 DS    0H                                                  1188 03024000
@ER00035 LM    @14,@12,12(@13)                                     1188 03025000
         BR    @14                                                 1188 03026000
*BADORPT:  ; /*ERREPT  UNSUCCESSFUL OPEN                     @Z427VLS*/ 03027000
BADORPT  DS    0H                                                  1190 03028000
*MSGNO = 44;                                               /*@Z427VLS*/ 03029000
         MVC   MSGNO(4),@CF01121                                   1190 03030000
*CALL ERRMSG;                                              /*@Z427VLS*/ 03031000
         BAL   @14,ERRMSG                                          1191 03032000
*BADNEWS = TWELVE;                                         /*@Z427VLS*/ 03033000
         MVC   BADNEWS(4),@CF00068                                 1192 03034000
*GOTO GOBACK;                                              /*@Z427VLS*/ 03035000
         B     GOBACK                                              1193 03036000
*BADOTOUR: ; /*TOURIST UNSUCCESSFUL OPEN                     @Z427VLS*/ 03037000
BADOTOUR DS    0H                                                  1195 03038000
*R2 = SAVER2;    /*INSURE COMTABLE ADDRESSED BY R2           @ZA31549*/ 03039000
         L     @12,SAVER2                                          1195 03040000
         LR    R2,@12                                              1195 03041000
* CALL IFCMSG(205,ADDR(PRNTBF));                           /*@Z427VLS*/ 03042000
         LA    @15,PRNTBF                                          1196 03043000
         ST    @15,@AFTEMPS+16                                     1196 03044000
         L     @15,ADIFCMSG(,@12)                                  1196 03045000
         LA    @01,@AL01196                                        1196 03046000
         BALR  @14,@15                                             1196 03047000
*BADNEWS = TWELVE;                                         /*@Z427VLS*/ 03048000
         MVC   BADNEWS(4),@CF00068                                 1197 03049000
*GOTO GOBACK;                                              /*@Z427VLS*/ 03050000
         B     GOBACK                                              1198 03051000
*HISTBAD:  ; /*ERROR EXIT WRITING TO ACCDEV                  @Z427VLS*/ 03052000
HISTBAD  DS    0H                                                  1200 03053000
* GEN(SYNADAF  ACSMETH=QSAM);       /* GET OWN SAVE AREA     @ZA28682*/ 03054000
         SYNADAF  ACSMETH=QSAM                                          03055000
* SAVER14 = R14;                    /* SAVE RETURN ADDRESS   @ZA28682*/ 03056000
         ST    R14,SAVER14                                         1201 03057000
*MSGNO = 6;                                                /*@Z427VLS*/ 03058000
         MVC   MSGNO(4),@CF00082                                   1202 03059000
*CALL ERRMSG;                                              /*@Z427VLS*/ 03060000
         BAL   @14,ERRMSG                                          1203 03061000
*BADNEWS = TWELVE;                                         /*@Z427VLS*/ 03062000
         MVC   BADNEWS(4),@CF00068                                 1204 03063000
* GOTO GOOUT;                       /* RETURN TO SUPERVISOR  @ZA28682*/ 03064000
         B     GOOUT                                               1205 03065000
*HISTEND:  ; /*EOF EXIT FOR READING ACCIN                    @Z427VLS*/ 03066000
HISTEND  DS    0H                                                  1207 03067000
*CALL CLOSHIST;                                            /*@Z427VLS*/ 03068000
         BAL   @14,CLOSHIST                                        1207 03069000
*IF SERLO = ON THEN /*IF SERLOG IS ALSO ON WE MUST READ IT ALSO*/  1208 03070000
         TM    SERLO,B'10000000'                                   1208 03071000
         BNO   @RF01208                                            1208 03072000
* DO;                                                      /*@Z427VLS*/ 03073000
*  CALL READSER; /*WILL START READING SERLOG SEQUENTIALLY THERE*/  1210 03074000
         BAL   @14,READSER                                         1210 03075000
*  GOTO GOBACK;   /*RETURN TO CALLER                         @Z427VLS*/ 03076000
         B     GOBACK                                              1211 03077000
* END;                                                     /*@Z427VLS*/ 03078000
*ELSE                                                              1213 03079000
*  DO;                                                     /*@Z427VLS*/ 03080000
@RF01208 DS    0H                                                  1214 03081000
*    BADNEWS = FOUR; /*INDICATE EOF ON SEQUENTIAL DATA       @Z427VLS*/ 03082000
         MVC   BADNEWS(4),@CF00065                                 1214 03083000
*    GOTO GOBACK;                                          /*@Z427VLS*/ 03084000
         B     GOBACK                                              1215 03085000
*  END;                                                    /*@Z427VLS*/ 03086000
*HISTINBD:  ; /*ERROR EXIT FOR READING ACCIN                 @Z427VLS*/ 03087000
HISTINBD DS    0H                                                  1218 03088000
* GEN(SYNADAF  ACSMETH=QSAM);       /* GET OWN SAVE AREA     @ZA28682*/ 03089000
         SYNADAF  ACSMETH=QSAM                                          03090000
* SAVER14 = R14;                    /* SAVE RETURN ADDRESS   @ZA28682*/ 03091000
         ST    R14,SAVER14                                         1219 03092000
*BADNEWS = TWELVE;                                         /*@Z427VLS*/ 03093000
         MVC   BADNEWS(4),@CF00068                                 1220 03094000
*MSGNO =7;                                                 /*@Z427VLS*/ 03095000
         MVC   MSGNO(4),@CF00037                                   1221 03096000
*CALL ERRMSG;                                              /*@Z427VLS*/ 03097000
         BAL   @14,ERRMSG                                          1222 03098000
* GOTO GOOUT;                       /* RETURN TO SUPERVISOR  @ZA28682*/ 03099000
         B     GOOUT                                               1223 03100000
*BADBRSEQ: ; /*CANT OPEN DIRECTWK FOR READ EXIT              @Z427VLS*/ 03101000
BADBRSEQ DS    0H                                                  1225 03102000
*MSGNO = 30;                                               /*@Z427VLS*/ 03103000
         MVC   MSGNO(4),@CF01134                                   1225 03104000
*CALL ERRMSG;                                              /*@Z427VLS*/ 03105000
         BAL   @14,ERRMSG                                          1226 03106000
*BADNEWS = TWELVE;                                         /*@Z427VLS*/ 03107000
         MVC   BADNEWS(4),@CF00068                                 1227 03108000
*GOTO GOBACK;                                              /*@Z427VLS*/ 03109000
         B     GOBACK                                              1228 03110000
*BADOPENA: ; /*SERLOG OPEN FAILED EXIT                       @Z427VLS*/ 03111000
BADOPENA DS    0H                                                  1230 03112000
*GEN(DEQ   (RESID,LOGRECA,11,STEP)); /*STEP DEQUEUE          @Z427VLS*/ 03113000
         DEQ   (RESID,LOGRECA,11,STEP)                                  03114000
*MSGNO = 13;                                               /*@Z427VLS*/ 03115000
         MVC   MSGNO(4),@CF01137                                   1231 03116000
*CALL ERRMSG;                                              /*@Z427VLS*/ 03117000
         BAL   @14,ERRMSG                                          1232 03118000
*BADNEWS = TWELVE;                                         /*@Z427VLS*/ 03119000
         MVC   BADNEWS(4),@CF00068                                 1233 03120000
*GOTO GOBACK;                                              /*@Z427VLS*/ 03121000
         B     GOBACK                                              1234 03122000
*BADBWSEQ:  ; /*ERROR EXIT IF CANT OPEN DIRECTWK FOR WRITING @Z427VLS*/ 03123000
BADBWSEQ DS    0H                                                  1236 03124000
*BADNEWS = TWELVE;                                         /*@Z427VLS*/ 03125000
         MVC   BADNEWS(4),@CF00068                                 1236 03126000
*MSGNO = 27;                                               /*@Z427VLS*/ 03127000
         MVC   MSGNO(4),@CF01140                                   1237 03128000
*CALL ERRMSG;                                              /*@Z427VLS*/ 03129000
         BAL   @14,ERRMSG                                          1238 03130000
*GOTO GOBACK;                                              /*@Z427VLS*/ 03131000
         B     GOBACK                                              1239 03132000
*BDIST: ; /*IMPROPER RECORD FORMAT EXIT FOR ACCIN            @Z427VLS*/ 03133000
BDIST    DS    0H                                                  1241 03134000
*BADNEWS = TWELVE;                                         /*@Z427VLS*/ 03135000
         MVC   BADNEWS(4),@CF00068                                 1241 03136000
*MSGNO = 10;                                               /*@Z427VLS*/ 03137000
         MVC   MSGNO(4),@CF00033                                   1242 03138000
*CALL ERRMSG;                                              /*@Z427VLS*/ 03139000
         BAL   @14,ERRMSG                                          1243 03140000
*GOTO GOBACK;                                              /*@Z427VLS*/ 03141000
         B     GOBACK                                              1244 03142000
*BDOIHST: ;  /*CANT OPEN ACCIN EXIT                          @Z427VLS*/ 03143000
BDOIHST  DS    0H                                                  1246 03144000
*MSGNO = 9;                                                /*@Z427VLS*/ 03145000
         MVC   MSGNO(4),@CF00034                                   1246 03146000
*CALL ERRMSG;                                              /*@Z427VLS*/ 03147000
         BAL   @14,ERRMSG                                          1247 03148000
*BADNEWS = TWELVE;                                         /*@Z427VLS*/ 03149000
         MVC   BADNEWS(4),@CF00068                                 1248 03150000
*GOTO GOBACK;                                              /*@Z427VLS*/ 03151000
         B     GOBACK                                              1249 03152000
*BADRDIR: ; /*SYNAD FOR READING DIRECTWK D.S. SEQUENTIALLY WITH POINT*/ 03153000
BADRDIR  DS    0H                                                  1251 03154000
* GEN(SYNADAF  ACSMETH=BSAM);       /* GET OWN SAVE AREA     @ZA28682*/ 03155000
         SYNADAF  ACSMETH=BSAM                                          03156000
* SAVER14 = R14;                    /* SAVE RETURN ADDRESS   @ZA28682*/ 03157000
         ST    R14,SAVER14                                         1252 03158000
*MSGNO = 42;                                               /*@Z427VLS*/ 03159000
         MVC   MSGNO(4),@CF01147                                   1253 03160000
*CALL ERRMSG;                                              /*@Z427VLS*/ 03161000
         BAL   @14,ERRMSG                                          1254 03162000
*BADNEWS = TWELVE;                                         /*@Z427VLS*/ 03163000
         MVC   BADNEWS(4),@CF00068                                 1255 03164000
* GOTO GOOUT;                       /* RETURN TO SUPERVISOR  @ZA28682*/ 03165000
         B     GOOUT                                               1256 03166000
*BADOOHST: ; /*CANT OPEN ACCDEV EXIT                         @Z427VLS*/ 03167000
BADOOHST DS    0H                                                  1258 03168000
*MSGNO = 3;                                                /*@Z427VLS*/ 03169000
         MVC   MSGNO(4),@CF00077                                   1258 03170000
*CALL ERRMSG;                                              /*@Z427VLS*/ 03171000
         BAL   @14,ERRMSG                                          1259 03172000
*BADNEWS = TWELVE;                                         /*@Z427VLS*/ 03173000
         MVC   BADNEWS(4),@CF00068                                 1260 03174000
*GOTO GOBACK;                                              /*@Z427VLS*/ 03175000
         B     GOBACK                                              1261 03176000
*SYSOBAD: ;                                                /*@Z427VLS*/ 03177000
SYSOBAD  DS    0H                                                  1263 03178000
*BADNEWS = TWELVE;                                         /*@Z427VLS*/ 03179000
         MVC   BADNEWS(4),@CF00068                                 1263 03180000
*GOTO GOBACK;                                              /*@Z427VLS*/ 03181000
         B     GOBACK                                              1264 03182000
*SYSBAD: ;                                                 /*@Z427VLS*/ 03183000
SYSBAD   DS    0H                                                  1266 03184000
* GEN(SYNADAF  ACSMETH=QSAM);       /* GET OWN SAVE AREA     @ZA28682*/ 03185000
         SYNADAF  ACSMETH=QSAM                                          03186000
* SAVER14 = R14;                    /* SAVE RETURN ADDRESS   @ZA28682*/ 03187000
         ST    R14,SAVER14                                         1267 03188000
*MSGNO = 36; /*SYSIN READ ERROR                              @Z427VLS*/ 03189000
         MVC   MSGNO(4),@CF01154                                   1268 03190000
*CALL ERRMSG;                                              /*@Z427VLS*/ 03191000
         BAL   @14,ERRMSG                                          1269 03192000
* GOTO GOOUT;                       /* RETURN TO SUPERVISOR  @ZA28682*/ 03193000
         B     GOOUT                                               1270 03194000
*GOTO GOBACK;                                              /*@Z427VLS*/ 03195000
*OVERFLOW: ;                                               /*@Z427VLS*/ 03196000
OVERFLOW DS    0H                                                  1273 03197000
*MSGNO = 37;                                               /*@Z427VLS*/ 03198000
         MVC   MSGNO(4),@CF01157                                   1273 03199000
*CALL ERRMSG;                                              /*@Z427VLS*/ 03200000
         BAL   @14,ERRMSG                                          1274 03201000
*MSGNO = 38;                                               /*@Z427VLS*/ 03202000
         MVC   MSGNO(4),@CF01158                                   1275 03203000
*CALL ERRMSG;                                              /*@Z427VLS*/ 03204000
         BAL   @14,ERRMSG                                          1276 03205000
*PRINTADR = ADDR(PRNTBF);                                  /*@Z427VLS*/ 03206000
         LA    @12,PRNTBF                                          1277 03207000
         L     @01,SAVER2                                          1277 03208000
         ST    @12,PRINTADR(,@01)                                  1277 03209000
*PRINTDS = 'F1'X;                                          /*@Z427VLS*/ 03210000
         MVI   PRINTDS(@12),X'F1'                                  1278 03211000
*PRINTCC = '09'X;                                          /*@Z427VLS*/ 03212000
         MVI   PRINTCC(@12),X'09'                                  1279 03213000
*NUMBER = 40; /*NUMBER OF BYTES OF LAST RECORD WRITTEN TO BE PRINTED*/  03214000
         MVC   NUMBER(4),@CF00471                                  1280 03215000
*NEXTBY = R7 + 4; /*ADDRESS OF RECORD PAST RECORD LENGTH     @Z427VLS*/ 03216000
         LA    @06,4                                               1281 03217000
         ALR   @06,R7                                              1281 03218000
         ST    @06,NEXTBY                                          1281 03219000
*ADDNXT = PRINTADR + 2; /*PUT PRINTABLE NUMBER HERE IN PRINT BUFFER*/   03220000
         AL    @12,@CF00075                                        1282 03221000
         ST    @12,ADDNXT                                          1282 03222000
*CALL CONVERT; /*CONVERT HEXIDECIMAL RECORD HEADER TO PRINTABLE*/  1283 03223000
         BAL   @14,CONVERT                                         1283 03224000
*CALL PRINTIT; /*WRITE RECORD LAST PROCESSED TO THE TOURIST DATA SET*/  03225000
         BAL   @14,PRINTIT                                         1284 03226000
*BADNEWS = 8;                                              /*@Z427VLS*/ 03227000
         MVC   BADNEWS(4),@CF00035                                 1285 03228000
*GOTO GOBACK;                                              /*@Z427VLS*/ 03229000
         B     GOBACK                                              1286 03230000
*SYSEOF: ;                                                 /*@Z427VLS*/ 03231000
SYSEOF   DS    0H                                                  1288 03232000
*BADNEWS = FOUR;                                           /*@Z427VLS*/ 03233000
         MVC   BADNEWS(4),@CF00065                                 1288 03234000
*GOTO GOBACK;                                              /*@Z427VLS*/ 03235000
         B     GOBACK                                              1289 03236000
*PRINTBAD: ;                                               /*@Z427VLS*/ 03237000
PRINTBAD DS    0H                                                  1291 03238000
* GEN(SYNADAF  ACSMETH=QSAM);       /* GET OWN SAVE AREA     @ZA28682*/ 03239000
         SYNADAF  ACSMETH=QSAM                                          03240000
* SAVER14 = R14;                    /* SAVE RETURN ADDRESS   @ZA28682*/ 03241000
         ST    R14,SAVER14                                         1292 03242000
*MSGNO = 18;                                               /*@Z427VLS*/ 03243000
         MVC   MSGNO(4),@CF01164                                   1293 03244000
*CALL ERRMSG;                                              /*@Z427VLS*/ 03245000
         BAL   @14,ERRMSG                                          1294 03246000
*BADNEWS = TWELVE;                                         /*@Z427VLS*/ 03247000
         MVC   BADNEWS(4),@CF00068                                 1295 03248000
* GOTO GOOUT;                       /* RETURN TO SUPERVISOR  @ZA28682*/ 03249000
         B     GOOUT                                               1296 03250000
*TOURBAD: ;                                                /*@Z427VLS*/ 03251000
TOURBAD  DS    0H                                                  1298 03252000
* GEN(SYNADAF  ACSMETH=QSAM);       /* GET OWN SAVE AREA     @ZA28682*/ 03253000
         SYNADAF  ACSMETH=QSAM                                          03254000
* SAVER14 = R14;                    /* SAVE RETURN ADDRESS   @ZA28682*/ 03255000
         ST    R14,SAVER14                                         1299 03256000
*BADNEWS = TWELVE;                                         /*@Z427VLS*/ 03257000
         MVC   BADNEWS(4),@CF00068                                 1300 03258000
*R2 = SAVER2;    /*INSURE COMTABLE ADDRESSED BY R2           @ZA31549*/ 03259000
         L     @12,SAVER2                                          1301 03260000
         LR    R2,@12                                              1301 03261000
*CALL IFCMSG(202,ADDR(PRNTBF));                            /*@Z427VLS*/ 03262000
         LA    @15,PRNTBF                                          1302 03263000
         ST    @15,@AFTEMPS+16                                     1302 03264000
         L     @15,ADIFCMSG(,@12)                                  1302 03265000
         LA    @01,@AL01302                                        1302 03266000
         BALR  @14,@15                                             1302 03267000
* GOTO GOOUT;                       /* RETURN TO SUPERVISOR  @ZA28682*/ 03268000
         B     GOOUT                                               1303 03269000
*WRITEERR:;                                                /*@Z427VLS*/ 03270000
WRITEERR DS    0H                                                  1305 03271000
* GEN(SYNADAF  ACSMETH=BSAM);       /* GET OWN SAVE AREA     @ZA28682*/ 03272000
         SYNADAF  ACSMETH=BSAM                                          03273000
* SAVER14 = R14;                    /* SAVE RETURN ADDRESS   @ZA28682*/ 03274000
         ST    R14,SAVER14                                         1306 03275000
* GOOUT:;                           /* RETURN TO SUPERVISOR  @ZA28682*/ 03276000
GOOUT    DS    0H                                                  1308 03277000
*  RESPECIFY(R15) RESTRICTED;       /* USE R15 FOR RET CODE  @ZA28682*/ 03278000
*  R15 = BADNEWS;                   /* GET RETURN CODE       @ZA28682*/ 03279000
         L     R15,BADNEWS                                         1309 03280000
*  IF  R15 > FOUR THEN              /* MORE THAN ONE REQ     @ZA28682*/ 03281000
         C     R15,@CF00065                                        1310 03282000
         BNH   @RF01310                                            1310 03283000
*   ERRORENT = ERRORENT + 1;        /* CAN NOT DO            @ZA28682*/ 03284000
         LA    @14,1                                               1311 03285000
         AL    @14,ERRORENT                                        1311 03286000
         ST    @14,ERRORENT                                        1311 03287000
*  R14 = SAVER14;                   /* RESTORE SPVR RET ADR  @ZA28682*/ 03288000
@RF01310 L     R14,SAVER14                                         1312 03289000
*  GEN(SYNADRLS );                  /* RSTR SPVR REGS        @ZA28682*/ 03290000
         SYNADRLS                                                       03291000
* RETURN;                           /* RETURN TO SUPERVISOR  @ZA28682*/ 03292000
         B     @EL00001                                            1314 03293000
*MSGNO = 26;                                               /*@Z427VLS*/ 03294000
*CALL ERRMSG;                                              /*@Z427VLS*/ 03295000
*BADNEWS = TWELVE;                                         /*@Z427VLS*/ 03296000
*GO TO GOBACK;                                             /*@Z427VLS*/ 03297000
*/*                                                          @Z427VLS*/ 03298000
*/*      BLOCK GENERATE FOR CONTROL BLOCKS & DSECT           @Z427VLS*/ 03299000
*/*                                                          @Z427VLS*/ 03300000
*GENERATE ;                                                /*@Z427VLS*/ 03301000
OUTHIST  DCB   MACRF=(PM),SYNAD=HISTBAD,LRECL=2000,                    C03302000
               DSORG=PS,DDNAME=ACCDEV,BUFNO=2                           03303000
INHIST   DCB   MACRF=(GM),DSORG=PS,DDNAME=ACCIN,LRECL=2000,            C03304000
               EODAD=HISTEND,SYNAD=HISTINBD,BUFNO=2                     03305000
LOGREC   DCB   MACRF=(E),IOBAD=XIOB,DSORG=DA,DEVD=DA,RECFM=U,          C03306000
               DDNAME=SERLOG                                            03307000
* DIRECTWK IS READ WITH THE FIRST DCB USING NOTE LOGIC AND READ WITH    03308000
* THE SECOND DCB USING POINT LOGIC                                      03309000
* A CLOSE TO THE FIRST DCB MUST BE ISSUED BEFORE USING THE SECOND       03310000
WORKWDCB DCB   DDNAME=DIRECTWK,DEVD=DA,DSORG=PS,BLKSIZE=2000,          C03311000
               MACRF=(WP),RECFM=V,SYNAD=WRITEERR                        03312000
WORKRDCB DCB   DDNAME=DIRECTWK,DEVD=DA,DSORG=PS,BLKSIZE=2000,          C03313000
               MACRF=(RP),RECFM=V,SYNAD=BADRDIR                         03314000
SYSDCB   DCB   DDNAME=SYSIN,DEVD=DA,DSORG=PS,EODAD=SYSEOF,             C03315000
               LRECL=80,MACRF=GM,SYNAD=SYSBAD,EXLST=BLKEXIT             03316000
* NOTE THAT EREPPT COMMAND CHARACTERS HAVE FLUCTUATED BETWEEN ANSI AND  03317000
* MACHINE CHARACTERS.                                                   03318000
EREPTDCB DCB   MACRF=(PM),SYNAD=PRINTBAD,LRECL=133,DDNAME=EREPPT,      C03319000
               DEVD=DA,DSORG=PS,RECFM=FBM,EXLST=BLKEXIT                 03320000
TOURDCB  DCB   MACRF=(PM),SYNAD=TOURBAD,LRECL=133,DDNAME=TOURIST,      C03321000
               DEVD=DA,DSORG=PS,RECFM=FBM,EXLST=BLKEXIT                 03322000
BLKEXIT  DS    0F                         ALIGN ON A FULLWORD           03323000
         DC    AL1(128+5),AL3(ADDBLKSZ)   DCB OPEN EXIT                 03324000
ADDBLKSZ EQU   *                                                        03325000
         USING IHADCB,1                                                 03326000
         OC    DCBBLKSI(2),DCBBLKSI   BLKSIZE SPECIFIED                 03327000
         BNZR  R14                    YES...RETURN                      03328000
         MVC   DCBBLKSI(2),DCBLRECL   DEFAULT BLKSIZE = LRECL           03329000
         BR    R14                    RETURN                            03330000
         DROP  1                                                        03331000
*GENERATE DATA ;                                           /*@Z427VLS*/ 03332000
*/********************************************************************/ 03333000
*RESPECIFY (R7,R15) UNRESTRICTED;                          /*@Z427VLS*/ 03334000
*        END  /*CLOSING END TO EXTERNAL PROC IFCIOHND        @Z427VLS*/ 03335000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 03336000
*/*%INCLUDE SYSLIB  (COMTABLE)                                        * 03337000
*;                                                                 1322 03338000
         B     @EL00001                                            1322 03339000
@DATA    DS    0H                                                       03340000
@CH00080 DC    H'5'                                                     03341000
@CH00671 DC    H'20'                                                    03342000
@CH00925 DC    H'1944'                                                  03343000
@CH01016 DC    H'-1'                                                    03344000
         DS    0F                                                       03345000
@AL00337 DC    A(@CF00947)             LIST WITH   2 ARGUMENT(S)        03346000
         DC    A(@AFTEMPS)                                              03347000
@AL00687 DC    A(MSGNO)                LIST WITH   2 ARGUMENT(S)        03348000
         DC    A(@AFTEMPS+4)                                            03349000
@AL00717 DC    A(@CF01028)             LIST WITH   2 ARGUMENT(S)        03350000
         DC    A(@AFTEMPS+4)                                            03351000
@AL00761 DC    A(@CF01028)             LIST WITH   2 ARGUMENT(S)        03352000
         DC    A(@AFTEMPS+8)                                            03353000
@AL01078 DC    A(@CF01096)             LIST WITH   2 ARGUMENT(S)        03354000
         DC    A(@AFTEMPS+12)                                           03355000
@AL01196 DC    A(@CF01124)             LIST WITH   2 ARGUMENT(S)        03356000
         DC    A(@AFTEMPS+16)                                           03357000
@AL01302 DC    A(@CF01167)             LIST WITH   2 ARGUMENT(S)        03358000
         DC    A(@AFTEMPS+16)                                           03359000
         DS    0F                                                       03360000
@SA00001 DS    18F                                                      03361000
@SA00023 DS    14F                                                      03362000
@SA00021 DS    14F                                                      03363000
@SA00034 DS    15F                                                      03364000
@SA00019 DS    15F                                                      03365000
@SA00015 DS    15F                                                      03366000
@SA00009 DS    15F                                                      03367000
@SA00010 DS    15F                                                      03368000
@SA00018 DS    14F                                                      03369000
@SA00014 DS    15F                                                      03370000
@SA00002 DS    15F                                                      03371000
@SA00003 DS    14F                                                      03372000
@SA00007 DS    15F                                                      03373000
@SA00008 DS    15F                                                      03374000
@SA00004 DS    14F                                                      03375000
@SA00005 DS    15F                                                      03376000
@SA00006 DS    15F                                                      03377000
@SA00029 DS    15F                                                      03378000
@SA00031 DS    15F                                                      03379000
@SA00026 DS    15F                                                      03380000
@SA00033 DS    15F                                                      03381000
@SA00016 DS    15F                                                      03382000
@SA00025 DS    15F                                                      03383000
@SA00032 DS    15F                                                      03384000
@SA00027 DS    15F                                                      03385000
@SA00028 DS    15F                                                      03386000
@SA00017 DS    15F                                                      03387000
@SA00022 DS    15F                                                      03388000
@SA00011 DS    15F                                                      03389000
@SA00030 DS    15F                                                      03390000
@SA00013 DS    15F                                                      03391000
@SA00012 DS    15F                                                      03392000
@SA00020 DS    14F                                                      03393000
@SA00024 DS    14F                                                      03394000
@AFTEMPS DS    5F                                                       03395000
         DS    0F                                                       03396000
@CF00056 DC    F'1'                                                     03397000
@CH00056 EQU   @CF00056+2                                               03398000
@CF00075 DC    F'2'                                                     03399000
@CH00075 EQU   @CF00075+2                                               03400000
@CF00077 DC    F'3'                                                     03401000
@CH00077 EQU   @CF00077+2                                               03402000
@CF00065 DC    F'4'                                                     03403000
@CH00065 EQU   @CF00065+2                                               03404000
@CF00082 DC    F'6'                                                     03405000
@CH00082 EQU   @CF00082+2                                               03406000
@CF00037 DC    F'7'                                                     03407000
@CH00037 EQU   @CF00037+2                                               03408000
@CF00035 DC    F'8'                                                     03409000
@CF00034 DC    F'9'                                                     03410000
@CH00034 EQU   @CF00034+2                                               03411000
@CF00033 DC    F'10'                                                    03412000
@CF00032 DC    F'11'                                                    03413000
@CF00068 DC    F'12'                                                    03414000
@CF01137 DC    F'13'                                                    03415000
@CF00768 DC    F'14'                                                    03416000
@CF00036 DC    F'15'                                                    03417000
@CF00089 DC    F'16'                                                    03418000
@CF00993 DC    F'17'                                                    03419000
@CF01164 DC    F'18'                                                    03420000
@CF01032 DC    F'19'                                                    03421000
@CF01067 DC    F'21'                                                    03422000
@CF01106 DC    F'22'                                                    03423000
@CF01089 DC    F'23'                                                    03424000
@CF00940 DC    F'25'                                                    03425000
@CF01140 DC    F'27'                                                    03426000
@CF01049 DC    F'28'                                                    03427000
@CF00544 DC    F'29'                                                    03428000
@CF01134 DC    F'30'                                                    03429000
@CF00042 DC    F'31'                                                    03430000
@CF00531 DC    F'32'                                                    03431000
@CF01037 DC    F'33'                                                    03432000
@CF01041 DC    F'34'                                                    03433000
@CF01045 DC    F'35'                                                    03434000
@CF01154 DC    F'36'                                                    03435000
@CF01157 DC    F'37'                                                    03436000
@CF01158 DC    F'38'                                                    03437000
@CF00933 DC    F'39'                                                    03438000
@CF00471 DC    F'40'                                                    03439000
@CH00471 EQU   @CF00471+2                                               03440000
@CF00953 DC    F'41'                                                    03441000
@CF01147 DC    F'42'                                                    03442000
@CF01121 DC    F'44'                                                    03443000
@CF01101 DC    F'45'                                                    03444000
@CF01054 DC    F'46'                                                    03445000
@CF00935 DC    F'47'                                                    03446000
@CF00946 DC    F'48'                                                    03447000
@CF00962 DC    F'49'                                                    03448000
@CF00296 DC    F'50'                                                    03449000
@CF01011 DC    F'51'                                                    03450000
@CH01011 EQU   @CF01011+2                                               03451000
@CF01026 DC    F'52'                                                    03452000
@CF00952 DC    F'53'                                                    03453000
@CF00961 DC    F'54'                                                    03454000
@CF00945 DC    F'55'                                                    03455000
@CF01007 DC    F'56'                                                    03456000
@CF01008 DC    F'57'                                                    03457000
@CF01015 DC    F'58'                                                    03458000
@CF01036 DC    F'59'                                                    03459000
@CF00841 DC    F'60'                                                    03460000
@CF01061 DC    F'61'                                                    03461000
@CF01062 DC    F'62'                                                    03462000
@CF01074 DC    F'63'                                                    03463000
@CF00709 DC    F'64'                                                    03464000
@CF01081 DC    F'65'                                                    03465000
@CF01085 DC    F'66'                                                    03466000
@CF01100 DC    F'67'                                                    03467000
@CF01105 DC    F'68'                                                    03468000
@CF01110 DC    F'69'                                                    03469000
@CF00932 DC    F'70'                                                    03470000
@CF00947 DC    F'201'                                                   03471000
@CF01167 DC    F'202'                                                   03472000
@CF01028 DC    F'203'                                                   03473000
@CF01096 DC    F'204'                                                   03474000
@CF01124 DC    F'205'                                                   03475000
@CF01180 DC    XL4'0000FFFF'                                            03476000
         DS    0D                                                       03477000
SAVER2   DC    A(0)                                                     03478000
PTRSPOT  DC    A(0)                                                     03479000
SAVEPTR  DC    A(0)                                                     03480000
FRSPTR   DC    A(0)                                                     03481000
RUNPTR   DC    A(0)                                                     03482000
SAVER14  DC    A(0)                                                     03483000
A        DC    F'0'                                                     03484000
K        DC    F'0'                                                     03485000
J        DC    F'0'                                                     03486000
GETHIS   DC    F'0'                                                     03487000
R7SAVE   DC    F'0'                                                     03488000
TIMEBASE DC    A(0)                                                     03489000
NEXTBY   DC    F'0'                                                     03490000
ADDNXT   DC    F'0'                                                     03491000
NUMBER   DC    F'0'                                                     03492000
MSGNO    DC    F'0'                                                     03493000
BADNEWS  DC    F'0'                                                     03494000
PASSNUM  DC    F'0'                                                     03495000
XWRECB   DC    F'0'                                                     03496000
         ORG   XWRECB                                                   03497000
POST     DS    CL1                                                      03498000
@NM00017 DS    CL3                                                      03499000
         ORG   XWRECB+4                                                 03500000
MILLION  DC    F'1000000'                                               03501000
TWENTY4  DC    F'24'                                                    03502000
SIXTY    DC    F'60'                                                    03503000
CONSTG   DC    XL4'30040'                                               03504000
CONSTH   DC    XL4'24AE062'                                             03505000
SIXTYMIL DC    F'60000000'                                              03506000
THCONV   DC    F'10000'                                                 03507000
TIMDIV   DS    F                                                        03508000
SAVELNGT DC    H'0'                                                     03509000
LINECTT  DC    H'0'                                                     03510000
LINEMAX  DC    H'0'                                                     03511000
SDRK     DC    H'0'                                                     03512000
SAVELENT DC    H'0'                                                     03513000
         DS    0D                                                       03514000
@TS00001 DS    CL8                                                      03515000
@CC01027 DC    C'1 '                                                    03516000
@CB00120 DC    X'00000000'                                              03517000
@CB00532 DC    X'00000007'                                              03518000
@CB01094 DC    X'0000000F'                                              03519000
@CB00209 EQU   @CB00120                                                 03520000
@CB00262 DC    X'FFFF'                                                  03521000
@CB00983 DC    X'000F'                                                  03522000
CARDSPOT DC    CL80' '                                                  03523000
         DS    CL2                                                      03524000
MAXTRK   DC    X'00000000'                                              03525000
LOOKATIT DC    CL40'XXXXXXXXOPERATION COUNTS IFCEREP1XXXXXXX'           03526000
CONTPTR  DS    CL44                                                     03527000
         ORG   CONTPTR                                                  03528000
ERRORENT DC    F'0'                                                     03529000
RSEQCNT  DC    F'0'                                                     03530000
RSERDCNT DC    F'0'                                                     03531000
CONVTCT  DC    F'0'                                                     03532000
NUMRECSV DC    F'0'                                                     03533000
SYSRDCT  DC    F'0'                                                     03534000
RITEWKCT DC    F'0'                                                     03535000
READWKCT DC    F'0'                                                     03536000
ACIRDCT  DC    F'0'                                                     03537000
DEVCT    DC    F'0'                                                     03538000
RFRCOUNT DC    F'0'                                                     03539000
         ORG   CONTPTR+44                                               03540000
TTRSAVE  DC    X'00000000'                                              03541000
CCSAVE   DC    CL1' '                                                   03542000
BLANKS   DC    CL134' '                                                 03543000
PACKPAS  DC    CL4'    '                                                03544000
CHARPAS  DC    CL8'        '                                            03545000
CHARS    DC    CL16'0123456789ABCDEF'                                   03546000
         DS    CL5                                                      03547000
PRNTBF   DS    CL134                                                    03548000
         DS    CL2                                                      03549000
BUF1     DS    CL2004                                                   03550000
         ORG   BUF1                                                     03551000
BUF1RDW  DS    CL4                                                      03552000
         ORG   BUF1RDW                                                  03553000
BUF1RDWL DC    H'0'                                                     03554000
BUF1L    DC    H'0'                                                     03555000
         ORG   BUF1+4                                                   03556000
BUF1DTA  DS    CL2000                                                   03557000
         ORG   BUF1+2004                                                03558000
IOSWTCH  DC    X'000000'                                                03559000
         ORG   IOSWTCH                                                  03560000
HISTOPN  DS    BL1                                                      03561000
SECGET   EQU   IOSWTCH+0                                                03562000
FLIPFLOP EQU   IOSWTCH+0                                                03563000
HISTYES  EQU   IOSWTCH+0                                                03564000
DBLYES   EQU   IOSWTCH+0                                                03565000
LASTLOOP EQU   IOSWTCH+0                                                03566000
TOURERR  EQU   IOSWTCH+0                                                03567000
INHISO   EQU   IOSWTCH+0                                                03568000
SERLO    DS    BL1                                                      03569000
TWOTRY   EQU   IOSWTCH+1                                                03570000
INDIR    EQU   IOSWTCH+1                                                03571000
NONBLANK EQU   IOSWTCH+1                                                03572000
CLOSE2   EQU   IOSWTCH+1                                                03573000
SYSOPN   EQU   IOSWTCH+1                                                03574000
TOUROPN  EQU   IOSWTCH+1                                                03575000
ERPTOPN  EQU   IOSWTCH+1                                                03576000
READFR   DS    BL1                                                      03577000
SCRATCH  EQU   IOSWTCH+2                                                03578000
SNAPOP   EQU   IOSWTCH+2                                                03579000
         ORG   IOSWTCH+3                                                03580000
         DS    CL1                                                      03581000
HDRBUFF  DS    CL64                                                     03582000
         ORG   HDRBUFF                                                  03583000
HDRSEEK  DS    CL8                                                      03584000
         ORG   HDRSEEK                                                  03585000
HDRM     DC    X'00'                                                    03586000
HDRBB    DC    X'0000'                                                  03587000
HDRCC    DC    X'0000'                                                  03588000
HDRHH    DC    X'0000'                                                  03589000
HDRR     DC    X'00'                                                    03590000
         ORG   HDRBUFF+8                                                03591000
HEADER   DS    CL40                                                     03592000
         ORG   HEADER                                                   03593000
HDRKEY   DS    CL2                                                      03594000
HDRSCC   DS    CL2                                                      03595000
HDRSHH   DS    CL2                                                      03596000
HDRECC   DS    CL2                                                      03597000
HDREHH   DS    CL2                                                      03598000
HDRCOUNT DS    CL1                                                      03599000
HDRREC1  DS    CL7                                                      03600000
         ORG   HDRREC1                                                  03601000
HDR1BB   DS    CL2                                                      03602000
HDR1CC   DS    CL2                                                      03603000
HDR1HH   DS    CL2                                                      03604000
HDR1R    DS    CL1                                                      03605000
         ORG   HEADER+18                                                03606000
HDRREM   DS    CL2                                                      03607000
HDRTRKCP DS    CL2                                                      03608000
HDRREC2  DS    CL7                                                      03609000
         ORG   HDRREC2                                                  03610000
HDR2BB   DS    CL2                                                      03611000
HDR2CC   DS    CL2                                                      03612000
HDR2HH   DS    CL2                                                      03613000
HDR2R    DS    CL1                                                      03614000
         ORG   HEADER+29                                                03615000
HDRUCBNO DS    CL2                                                      03616000
HDREXSZE DS    CL2                                                      03617000
HDRTYPE  DS    CL1                                                      03618000
@NM00012 DS    CL4                                                      03619000
@NM00013 DS    CL1                                                      03620000
         ORG   @NM00013                                                 03621000
HDRWNGBT DS    BL1                                                      03622000
@NM00014 EQU   @NM00013+0                                               03623000
FRAMES   EQU   @NM00013+0                                               03624000
@NM00015 EQU   @NM00013+0                                               03625000
         ORG   HEADER+39                                                03626000
HDRSAFE  DS    CL1                                                      03627000
         ORG   HDRBUFF+48                                               03628000
PREVSEEK DS    CL8                                                      03629000
         ORG   PREVSEEK                                                 03630000
PREVM    DC    X'FF'                                                    03631000
PREVBB   DS    CL2                                                      03632000
PREVCC   DS    CL2                                                      03633000
PREVHH   DS    CL2                                                      03634000
PREVR    DS    CL1                                                      03635000
         ORG   HDRBUFF+64                                               03636000
LOGRECA  DC    CL11'SYS1.LOGREC'                                        03637000
LOGRECB  DC    CL8'RECORDER'                                            03638000
RESID    DC    CL8'SERLOG'                                              03639000
RESIDII  DC    CL8'LOGREC'                                              03640000
ZEROA    DS    CL24                                                     03641000
SEEKSAVE DC    X'0000000000000000'                                      03642000
         ORG   SEEKSAVE                                                 03643000
@NM00016 DS    CL7                                                      03644000
SKSAVREC DS    CL1                                                      03645000
         ORG   SEEKSAVE+8                                               03646000
         DS    CL5                                                      03647000
XIOB     DS    CL40                                                     03648000
         ORG   XIOB                                                     03649000
XIOBFL1  DC    X'42'                                                    03650000
XIOBFL2  DC    X'00'                                                    03651000
XIOBSNS0 DC    X'00'                                                    03652000
XIOBSNS1 DC    X'00'                                                    03653000
XIOBECB  DC    AL4(XWRECB)                                              03654000
XIOBCSW  DC    X'0000000000000000'                                      03655000
XIOBCCW  DC    AL4(SEQ)                                                 03656000
XIOBDCB  DS    AL4                                                      03657000
XIOBRA   DC    A(0)                                                     03658000
XIOBBEC  DC    F'0'                                                     03659000
XIOBSEEK DS    CL8                                                      03660000
         ORG   XIOBSEEK                                                 03661000
XIOBM    DC    X'00'                                                    03662000
XIOBBB   DC    X'0000'                                                  03663000
XIOBCC   DC    X'0000'                                                  03664000
XIOBHH   DC    X'0000'                                                  03665000
XIOBR    DC    X'00'                                                    03666000
         ORG   XIOB+40                                                  03667000
SEQ      DS    CL24                                                     03668000
         ORG   SEQ                                                      03669000
SID1     DS    CL8                                                      03670000
         ORG   SID1                                                     03671000
@NM00018 DC    X'31'                                                    03672000
AREAADR  DS    AL3                                                      03673000
@NM00019 DC    X'4000'                                                  03674000
@NM00020 DC    H'5'                                                     03675000
         ORG   SEQ+8                                                    03676000
TIC1     DS    CL8                                                      03677000
         ORG   TIC1                                                     03678000
@NM00021 DC    X'08'                                                    03679000
@NM00022 DC    AL3(SID1)                                                03680000
@NM00023 DC    X'4000'                                                  03681000
@NM00024 DC    H'1'                                                     03682000
         ORG   SEQ+16                                                   03683000
CKD1     DS    CL8                                                      03684000
         ORG   CKD1                                                     03685000
CKDCOM   DS    CL1                                                      03686000
CKDAREA  DS    AL3                                                      03687000
CKDCHAIN DC    X'20'                                                    03688000
@NM00025 DC    X'00'                                                    03689000
CKDCOUNT DS    FL2                                                      03690000
         ORG   SEQ+24                                                   03691000
SWITCH   DC    X'00'                                                    03692000
         ORG   SWITCH                                                   03693000
SBT0     DS    BL1                                                      03694000
SBT2     EQU   SWITCH+0                                                 03695000
SBT3     EQU   SWITCH+0                                                 03696000
SBT4     EQU   SWITCH+0                                                 03697000
SBT7     EQU   SWITCH+0                                                 03698000
         ORG   SWITCH+1                                                 03699000
         DS    CL7                                                      03700000
WORK8    DS    CL8                                                      03701000
         ORG   WORK8                                                    03702000
WORK     DS    FL4                                                      03703000
WORKB    DS    FL4                                                      03704000
         ORG   WORKB                                                    03705000
WHOURS   DS    CL1                                                      03706000
WMINS    DS    CL1                                                      03707000
WDAYS    DS    CL2                                                      03708000
         ORG   WDAYS                                                    03709000
WSECS    DS    CL1                                                      03710000
WTNTHS   DS    CL1                                                      03711000
         ORG   WORK8+8                                                  03712000
SUPERZAP DC    3CL10'SUPERZAP'                                          03713000
EDIFILD  DS    9CL1                                                     03714000
ERRLINE  DS    CL51                                                     03715000
         ORG   ERRLINE+0                                                03716000
ERRDS    DC    CL1'1'                                                   03717000
ERRCS    DC    CL1' '                                                   03718000
PRINTNM  DC    CL9'DEBUG15  '                                           03719000
PRNTXT   DC    CL40'SERLOG OPEN ATTEMPTED                   '           03720000
         ORG   ERRLINE+51                                               03721000
         ORG   ERRLINE+51                                               03722000
         DC    CL1'1'                                                   03723000
         DC    CL1' '                                                   03724000
         DC    CL9'DEBUG15  '                                           03725000
         DC    CL40'CHECK HEADER FOR MORE RECORDS ATTEMPTED '           03726000
         ORG   ERRLINE+102                                              03727000
         ORG   ERRLINE+102                                              03728000
         DC    CL1'1'                                                   03729000
         DC    CL1' '                                                   03730000
         DC    CL9'DEBUG15  '                                           03731000
         DC    CL40'RESET OF SERLOG HEADER ATTEMPTED        '           03732000
         ORG   ERRLINE+153                                              03733000
         ORG   ERRLINE+153                                              03734000
         DC    CL1'1'                                                   03735000
         DC    CL1' '                                                   03736000
         DC    CL9'DEBUG15  '                                           03737000
         DC    CL40'SERLOG CLOSE ATTEMPTED                  '           03738000
         ORG   ERRLINE+204                                              03739000
         ORG   ERRLINE+204                                              03740000
         DC    CL1'1'                                                   03741000
         DC    CL1' '                                                   03742000
         DC    CL9'DEBUG15  '                                           03743000
         DC    CL40'ZEROALL ATTEMPTED                       '           03744000
         ORG   ERRLINE+255                                              03745000
         ORG   ERRLINE+255                                              03746000
         DC    CL1'1'                                                   03747000
         DC    CL1' '                                                   03748000
         DC    CL9'DEBUG15  '                                           03749000
         DC    CL40'SDR COUNTER DUMP ATTEMPTED              '           03750000
         ORG   ERRLINE+306                                              03751000
         ORG   ERRLINE+306                                              03752000
         DC    CL1'1'                                                   03753000
         DC    CL1' '                                                   03754000
         DC    CL9'DEBUG15  '                                           03755000
         DC    CL40'SYSIN OPEN ATTEMPTED                    '           03756000
         ORG   ERRLINE+357                                              03757000
         ORG   ERRLINE+357                                              03758000
         DC    CL1'1'                                                   03759000
         DC    CL1' '                                                   03760000
         DC    CL9'DEBUG15  '                                           03761000
         DC    CL40'SYSIN CLOSE ATTEMPTED                   '           03762000
         ORG   ERRLINE+408                                              03763000
         ORG   ERRLINE+408                                              03764000
         DC    CL1'1'                                                   03765000
         DC    CL1' '                                                   03766000
         DC    CL9'DEBUG15  '                                           03767000
         DC    CL40'DIRECTWK CLOSE FOR WRITING ATTEMPTED    '           03768000
         ORG   ERRLINE+459                                              03769000
         ORG   ERRLINE+459                                              03770000
         DC    CL1'1'                                                   03771000
         DC    CL1' '                                                   03772000
         DC    CL9'DEBUG15  '                                           03773000
         DC    CL40'DIRECTWK CLOSE FOR READING ATTEMPTED    '           03774000
         ORG   ERRLINE+510                                              03775000
         ORG   ERRLINE+510                                              03776000
         DC    CL1'1'                                                   03777000
         DC    CL1' '                                                   03778000
         DC    CL9'DEBUG15  '                                           03779000
         DC    CL40'DIRECTWK OPEN FOR WRITE ATTEMPTED      '            03780000
         ORG   ERRLINE+561                                              03781000
         ORG   ERRLINE+561                                              03782000
         DC    CL1'1'                                                   03783000
         DC    CL1' '                                                   03784000
         DC    CL9'DEBUG15  '                                           03785000
         DC    CL40'ACCIN OPEN ATTEMPTED                    '           03786000
         ORG   ERRLINE+612                                              03787000
         ORG   ERRLINE+612                                              03788000
         DC    CL1'1'                                                   03789000
         DC    CL1' '                                                   03790000
         DC    CL9'DEBUG15  '                                           03791000
         DC    CL40'ACCIN CLOSE ATTEMPTED                   '           03792000
         ORG   ERRLINE+663                                              03793000
         ORG   ERRLINE+663                                              03794000
         DC    CL1'1'                                                   03795000
         DC    CL1' '                                                   03796000
         DC    CL9'DEBUG15  '                                           03797000
         DC    CL40'ACCDEV CLOSE ATTEMPTED                  '           03798000
         ORG   ERRLINE+714                                              03799000
         ORG   ERRLINE+714                                              03800000
         DC    CL1'1'                                                   03801000
         DC    CL1' '                                                   03802000
         DC    CL9'DEBUG15  '                                           03803000
         DC    CL40'EREPPT OPEN ATTEMPTED                   '           03804000
         ORG   ERRLINE+765                                              03805000
         ORG   ERRLINE+765                                              03806000
         DC    CL1'1'                                                   03807000
         DC    CL1' '                                                   03808000
         DC    CL9'DEBUG15  '                                           03809000
         DC    CL40'EREPPT CLOSE ATTEMPTED                  '           03810000
         ORG   ERRLINE+816                                              03811000
         ORG   ERRLINE+816                                              03812000
         DC    CL1'1'                                                   03813000
         DC    CL1' '                                                   03814000
         DC    CL9'DEBUG15  '                                           03815000
         DC    CL40'ACCDEV OPEN ATTEMPTED                   '           03816000
         ORG   ERRLINE+867                                              03817000
         ORG   ERRLINE+867                                              03818000
         DC    CL1'1'                                                   03819000
         DC    CL1' '                                                   03820000
         DC    CL9'DEBUG15  '                                           03821000
         DC    CL40'FIRST FRAME READ ATTEMPT                '           03822000
         ORG   ERRLINE+918                                              03823000
         ORG   ERRLINE+918                                              03824000
         DC    CL1'1'                                                   03825000
         DC    CL1' '                                                   03826000
         DC    CL9'DEBUG15  '                                           03827000
         DC    CL40'TIMES IFCIOHND EXITED WITH R.C.12       '           03828000
         ORG   ERRLINE+969                                              03829000
         ORG   ERRLINE+969                                              03830000
         DC    CL1'1'                                                   03831000
         DC    CL1' '                                                   03832000
         DC    CL9'DEBUG15  '                                           03833000
         DC    CL40'SERLOG SEQUENTIAL READ ATTEMPTS         '           03834000
         ORG   ERRLINE+1020                                             03835000
         ORG   ERRLINE+1020                                             03836000
         DC    CL1'1'                                                   03837000
         DC    CL1' '                                                   03838000
         DC    CL9'DEBUG15  '                                           03839000
         DC    CL40'SERLOG DIRECT READ ATTEMPTS             '           03840000
         ORG   ERRLINE+1071                                             03841000
         ORG   ERRLINE+1071                                             03842000
         DC    CL1'1'                                                   03843000
         DC    CL1' '                                                   03844000
         DC    CL9'DEBUG15  '                                           03845000
         DC    CL40'TIME CONVERSION NECESSARY NUM. TIMES    '           03846000
         ORG   ERRLINE+1122                                             03847000
         ORG   ERRLINE+1122                                             03848000
         DC    CL1'1'                                                   03849000
         DC    CL1' '                                                   03850000
         DC    CL9'DEBUG15  '                                           03851000
         DC    CL40'RECORDS SAVED DURING ZEROALL PROCESSING '           03852000
         ORG   ERRLINE+1173                                             03853000
         ORG   ERRLINE+1173                                             03854000
         DC    CL1'1'                                                   03855000
         DC    CL1' '                                                   03856000
         DC    CL9'DEBUG15  '                                           03857000
         DC    CL40'SYSIN READ ATTEMPTS                     '           03858000
         ORG   ERRLINE+1224                                             03859000
         ORG   ERRLINE+1224                                             03860000
         DC    CL1'1'                                                   03861000
         DC    CL1' '                                                   03862000
         DC    CL9'DEBUG15  '                                           03863000
         DC    CL40'DIRECTWK WRITE ATTEMPTS                 '           03864000
         ORG   ERRLINE+1275                                             03865000
         ORG   ERRLINE+1275                                             03866000
         DC    CL1'1'                                                   03867000
         DC    CL1' '                                                   03868000
         DC    CL9'DEBUG15  '                                           03869000
         DC    CL40'DIRECTWK READ ATTEMPTS                  '           03870000
         ORG   ERRLINE+1326                                             03871000
         ORG   ERRLINE+1326                                             03872000
         DC    CL1'1'                                                   03873000
         DC    CL1' '                                                   03874000
         DC    CL9'DEBUG15  '                                           03875000
         DC    CL40'ACCIN SEQUENTIAL READ ATTEMPTS          '           03876000
         ORG   ERRLINE+1377                                             03877000
         ORG   ERRLINE+1377                                             03878000
         DC    CL1'1'                                                   03879000
         DC    CL1' '                                                   03880000
         DC    CL9'DEBUG15  '                                           03881000
         DC    CL40'ACCDEV WRITE ATTEMPTS                   '           03882000
         ORG   ERRLINE+1428                                             03883000
         ORG   ERRLINE+1428                                             03884000
         DC    CL1'1'                                                   03885000
         DC    CL1' '                                                   03886000
         DC    CL9'DEBUG15  '                                           03887000
         DC    CL40'FRAME READ ATTEMPTS OF SYS1.LOGREC      '           03888000
         ORG   ERRLINE+1479                                             03889000
MACHCODE DC    X'09'                                                    03890000
         DC    X'01'                                                    03891000
         DC    9X'09'                                                   03892000
         DC    X'0B'                                                    03893000
         DC    5X'09'                                                   03894000
         DC    X'11'                                                    03895000
         DC    X'09'                                                    03896000
         DC    X'13'                                                    03897000
         DC    5X'09'                                                   03898000
         DC    X'19'                                                    03899000
         DC    X'09'                                                    03900000
         DC    X'1B'                                                    03901000
         DC    109X'09'                                                 03902000
         DC    X'89'                                                    03903000
         DC    X'09'                                                    03904000
         DC    X'8B'                                                    03905000
         DC    5X'09'                                                   03906000
         DC    X'91'                                                    03907000
         DC    X'09'                                                    03908000
         DC    X'93'                                                    03909000
         DC    5X'09'                                                   03910000
         DC    X'99'                                                    03911000
         DC    X'09'                                                    03912000
         DC    X'9B'                                                    03913000
         DC    5X'09'                                                   03914000
         DC    X'A1'                                                    03915000
         DC    X'09'                                                    03916000
         DC    X'A3'                                                    03917000
         DC    7X'09'                                                   03918000
         DC    X'AB'                                                    03919000
         DC    5X'09'                                                   03920000
         DC    X'B1'                                                    03921000
         DC    X'09'                                                    03922000
         DC    X'B3'                                                    03923000
         DC    5X'09'                                                   03924000
         DC    X'B9'                                                    03925000
         DC    X'09'                                                    03926000
         DC    X'BB'                                                    03927000
         DC    5X'09'                                                   03928000
         DC    X'C1'                                                    03929000
         DC    X'09'                                                    03930000
         DC    X'C3'                                                    03931000
         DC    5X'09'                                                   03932000
         DC    X'C9'                                                    03933000
         DC    X'09'                                                    03934000
         DC    X'CB'                                                    03935000
         DC    5X'09'                                                   03936000
         DC    X'D1'                                                    03937000
         DC    X'09'                                                    03938000
         DC    X'D3'                                                    03939000
         DC    5X'09'                                                   03940000
         DC    X'D9'                                                    03941000
         DC    X'09'                                                    03942000
         DC    X'DB'                                                    03943000
         DC    5X'09'                                                   03944000
         DC    X'E1'                                                    03945000
         DC    X'09'                                                    03946000
         DC    X'E3'                                                    03947000
         DC    20X'09'                                                  03948000
         DS    8XL1                                                     03949000
BYTESREM DC    H'0'                                                     03950000
         DC    H'3419'                                                  03951000
         DC    H'20137'                                                 03952000
         DC    H'4596'                                                  03953000
         DC    H'4778'                                                  03954000
         DC    H'0'                                                     03955000
         DC    H'13192'                                                 03956000
         DC    H'14184'                                                 03957000
         DC    H'7008'                                                  03958000
         DC    H'12680'                                                 03959000
         DC    H'7954'                                                  03960000
         DC    H'18800'                                                 03961000
         DC    H'0'                                                     03962000
         DC    H'12680'                                                 03963000
PATCH    DC    20H'0'                                                   03964000
IFCIOHND CSECT                                                          03965000
         DC    S(SUPERZAP)                                              03966000
IFCIOHND CSECT                                                          03967000
         DC    S(PATCH)                                                 03968000
IFCIOHND CSECT                                                          03969000
         DCBD  DSORG=PS,DEVD=DA         DCB DSECT                       03970000
IFCIOHND CSECT                                                          03971000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       03972000
@01      EQU   01                                                       03973000
@02      EQU   02                                                       03974000
@03      EQU   03                                                       03975000
@04      EQU   04                                                       03976000
@05      EQU   05                                                       03977000
@06      EQU   06                                                       03978000
@07      EQU   07                                                       03979000
@08      EQU   08                                                       03980000
@09      EQU   09                                                       03981000
@10      EQU   10                                                       03982000
@11      EQU   11                                                       03983000
@12      EQU   12                                                       03984000
@13      EQU   13                                                       03985000
@14      EQU   14                                                       03986000
@15      EQU   15                                                       03987000
R2       EQU   @02                                                      03988000
R1       EQU   @01                                                      03989000
R7       EQU   @07                                                      03990000
R0       EQU   @00                                                      03991000
R3       EQU   @03                                                      03992000
R4       EQU   @04                                                      03993000
R5       EQU   @05                                                      03994000
R6       EQU   @06                                                      03995000
R12      EQU   @12                                                      03996000
R14      EQU   @14                                                      03997000
R15      EQU   @15                                                      03998000
R10      EQU   @10                                                      03999000
R11      EQU   @11                                                      04000000
R13      EQU   @13                                                      04001000
R8       EQU   @08                                                      04002000
R9       EQU   @09                                                      04003000
IFCMSG   EQU   0                                                        04004000
PARM     EQU   0                                                        04005000
RECTYPE  EQU   PARM                                                     04006000
SWITCHES EQU   PARM+2                                                   04007000
NOSDR    EQU   SWITCHES                                                 04008000
ZEROALL  EQU   SWITCHES+1                                               04009000
DEBUG    EQU   PARM+4                                                   04010000
DEBUG15  EQU   DEBUG+1                                                  04011000
DEBUGA   EQU   PARM+8                                                   04012000
MISC     EQU   PARM+12                                                  04013000
PRINTES  EQU   MISC                                                     04014000
OPENCLSE EQU   PARM+13                                                  04015000
OPENIO   EQU   OPENCLSE                                                 04016000
OTOURIST EQU   OPENIO                                                   04017000
OEREPPT  EQU   OPENIO                                                   04018000
OSERLOG  EQU   OPENIO                                                   04019000
OACCIN   EQU   OPENIO                                                   04020000
OACCDEV  EQU   OPENIO                                                   04021000
OSYSIN   EQU   OPENIO                                                   04022000
ODRCTWRK EQU   OPENIO                                                   04023000
CLOSEIO  EQU   OPENCLSE+2                                               04024000
CTOURIST EQU   CLOSEIO                                                  04025000
CEREPPT  EQU   CLOSEIO                                                  04026000
CSERLOG  EQU   CLOSEIO                                                  04027000
CACCIN   EQU   CLOSEIO                                                  04028000
CACCDEV  EQU   CLOSEIO                                                  04029000
CSYSIN   EQU   CLOSEIO                                                  04030000
CDRCTWRK EQU   CLOSEIO                                                  04031000
DATENOW  EQU   PARM+17                                                  04032000
STDT     EQU   PARM+23                                                  04033000
STDATE   EQU   STDT                                                     04034000
PSTD     EQU   STDATE+1                                                 04035000
ENDDT    EQU   PARM+31                                                  04036000
ENDDATE  EQU   ENDDT                                                    04037000
PEND     EQU   ENDDATE+1                                                04038000
STTIME1  EQU   PARM+39                                                  04039000
ENDTIME1 EQU   PARM+43                                                  04040000
STTIME2  EQU   PARM+47                                                  04041000
ENDTIME2 EQU   PARM+51                                                  04042000
STRTDATE EQU   PARM+55                                                  04043000
@NM00006 EQU   PARM+72                                                  04044000
@NM00007 EQU   PARM+75                                                  04045000
ERRID    EQU   PARM+92                                                  04046000
IDTIMEA  EQU   ERRID+6                                                  04047000
IDTIME   EQU   IDTIMEA                                                  04048000
CCHHRLNG EQU   PARM+112                                                 04049000
RECCCHHR EQU   CCHHRLNG                                                 04050000
RECLNGTH EQU   CCHHRLNG+6                                               04051000
LINECT   EQU   PARM+120                                                 04052000
ADIOHND  EQU   PARM+124                                                 04053000
ADIFCMSG EQU   PARM+128                                                 04054000
ADEDITB  EQU   PARM+132                                                 04055000
EVPTR    EQU   PARM+136                                                 04056000
SORTADR  EQU   PARM+140                                                 04057000
PRINTADR EQU   PARM+148                                                 04058000
CUAPTR   EQU   PARM+152                                                 04059000
DEVPTR   EQU   PARM+156                                                 04060000
MODPTR   EQU   PARM+160                                                 04061000
SERPTR   EQU   PARM+164                                                 04062000
VOLPTR   EQU   PARM+168                                                 04063000
CPUPTR   EQU   PARM+172                                                 04064000
CPCUAPTR EQU   PARM+176                                                 04065000
LIBADPTR EQU   PARM+180                                                 04066000
SYMCDPTR EQU   PARM+184                                                 04067000
SYSUMPTR EQU   PARM+188                                                 04068000
TRENPTR  EQU   PARM+192                                                 04069000
SHAREPTR EQU   PARM+196                                                 04070000
MERDCPTR EQU   PARM+208                                                 04071000
DUMPTABL EQU   PARM+228                                                 04072000
DUMPINFO EQU   DUMPTABL+4                                               04073000
TRENDONE EQU   0                                                        04074000
TREGEN   EQU   TRENDONE+8                                               04075000
TRECCH0  EQU   TREGEN+8                                                 04076000
TREND2   EQU   0                                                        04077000
TRENDKEY EQU   TREND2                                                   04078000
TRENDRT  EQU   TRENDKEY+1                                               04079000
TRENCPUS EQU   TRENDKEY+3                                               04080000
TRENDITM EQU   TRENDKEY+4                                               04081000
EVTABLE  EQU   0                                                        04082000
EVSTOP   EQU   EVTABLE                                                  04083000
EVKEY    EQU   EVTABLE+6                                                04084000
SORTABLE EQU   0                                                        04085000
SORTKEY  EQU   SORTABLE                                                 04086000
SORTCCHR EQU   SORTABLE+5                                               04087000
SYSUMONE EQU   0                                                        04088000
SYSUM2   EQU   0                                                        04089000
SYSUMKEY EQU   SYSUM2                                                   04090000
SYSRT    EQU   SYSUMKEY+1                                               04091000
SYSCPUS  EQU   SYSUMKEY+3                                               04092000
SYSITEM  EQU   SYSUMKEY+4                                               04093000
SHARE    EQU   0                                                        04094000
SHAREIO  EQU   SHARE+2                                                  04095000
SHRBASE  EQU   SHAREIO+1                                                04096000
SHRCUCPU EQU   SHAREIO+8                                                04097000
EDITLOAD EQU   0                                                        04098000
EDITABLE EQU   EDITLOAD+4                                               04099000
CUA      EQU   0                                                        04100000
CUAVAL   EQU   CUA+2                                                    04101000
DEVICE   EQU   0                                                        04102000
MODELS   EQU   0                                                        04103000
DEVSERAL EQU   0                                                        04104000
VOLUME   EQU   0                                                        04105000
CPUS     EQU   0                                                        04106000
CPUCUAS  EQU   0                                                        04107000
CPUCUAV  EQU   CPUCUAS+2                                                04108000
LIBADR   EQU   0                                                        04109000
SYMCODE  EQU   0                                                        04110000
SYMVAL   EQU   SYMCODE+2                                                04111000
MERIDIAN EQU   0                                                        04112000
NEXTBYTE EQU   0                                                        04113000
ADDNUM   EQU   0                                                        04114000
LISTPTR  EQU   0                                                        04115000
INARG    EQU   0                                                        04116000
IOPLINE  EQU   0                                                        04117000
PRINTDS  EQU   IOPLINE                                                  04118000
PRINTCC  EQU   IOPLINE+1                                                04119000
PRINTBDY EQU   IOPLINE+2                                                04120000
RECTB    EQU   0                                                        04121000
FORPTR   EQU   RECTB                                                    04122000
JUNK     EQU   RECTB+4                                                  04123000
JUNK3    EQU   JUNK+6                                                   04124000
RECSPT   EQU   RECTB+12                                                 04125000
OHEADER  EQU   0                                                        04126000
OHDRREC1 EQU   OHEADER+11                                               04127000
OHDRREC2 EQU   OHEADER+22                                               04128000
RECAREA  EQU   0                                                        04129000
@NM00028 EQU   RECAREA+2                                                04130000
NSSWITCH EQU   @NM00028                                                 04131000
LCSWITCH EQU   @NM00028                                                 04132000
DATETIME EQU   RECAREA+8                                                04133000
DATE     EQU   DATETIME                                                 04134000
DATE0    EQU   DATE                                                     04135000
GMTSW    EQU   DATE0                                                    04136000
YEAR     EQU   DATE+1                                                   04137000
DAYS     EQU   DATE+2                                                   04138000
TIME     EQU   DATETIME+4                                               04139000
HOURS    EQU   TIME                                                     04140000
MINS     EQU   TIME+1                                                   04141000
SECS     EQU   TIME+2                                                   04142000
TNTHS    EQU   TIME+3                                                   04143000
IOHND    EQU   0                                                        04144000
GETTIT   EQU   GETHIS                                                   04145000
EDFLD    EQU   EDIFILD                                                  04146000
CTPTR    EQU   CONTPTR                                                  04147000
BUFFER   EQU   BUF1                                                     04148000
BCOUNT   EQU   BUFFER                                                   04149000
BCCHHR   EQU   BCOUNT                                                   04150000
BSIZE    EQU   BCOUNT+6                                                 04151000
BDATA    EQU   BUFFER+8                                                 04152000
BSZ      EQU   BSIZE                                                    04153000
BBRDW    EQU   BCCHHR+4                                                 04154000
TRECCH   EQU   TRECCH0                                                  04155000
TRKNUM   EQU   MAXTRK                                                   04156000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    04157000
BKEYL    EQU   BCOUNT+5                                                 04158000
@NM00032 EQU   DATE0                                                    04159000
@NM00031 EQU   @NM00028                                                 04160000
@NM00030 EQU   @NM00028                                                 04161000
@NM00029 EQU   @NM00028                                                 04162000
@NM00027 EQU   RECAREA+1                                                04163000
RECKEY   EQU   RECAREA                                                  04164000
OHDRSAFE EQU   OHEADER+39                                               04165000
@NM00026 EQU   OHEADER+34                                               04166000
OHDRTYP  EQU   OHEADER+33                                               04167000
OHDREXSZ EQU   OHEADER+31                                               04168000
OHDRUCBN EQU   OHEADER+29                                               04169000
OHDR2R   EQU   OHDRREC2+6                                               04170000
OHDR2HH  EQU   OHDRREC2+4                                               04171000
OHDR2CC  EQU   OHDRREC2+2                                               04172000
OHDR2BB  EQU   OHDRREC2                                                 04173000
OHDRTRXC EQU   OHEADER+20                                               04174000
OHDRREM  EQU   OHEADER+18                                               04175000
OHDR1R   EQU   OHDRREC1+6                                               04176000
OHDR1HH  EQU   OHDRREC1+4                                               04177000
OHDR1CC  EQU   OHDRREC1+2                                               04178000
OHDR1BB  EQU   OHDRREC1                                                 04179000
OHDRHI   EQU   OHEADER+10                                               04180000
OHDREHH  EQU   OHEADER+8                                                04181000
OHDRECC  EQU   OHEADER+6                                                04182000
OHDRSHH  EQU   OHEADER+4                                                04183000
OHDRSCC  EQU   OHEADER+2                                                04184000
OHDRKEY  EQU   OHEADER                                                  04185000
JUNK2    EQU   JUNK+5                                                   04186000
JUNK1    EQU   JUNK                                                     04187000
MODEL    EQU   MERIDIAN+2                                               04188000
MRDNUMBR EQU   MERIDIAN                                                 04189000
SYMVAL2  EQU   SYMVAL+2                                                 04190000
SYMVAL1  EQU   SYMVAL                                                   04191000
SYMCDNUM EQU   SYMCODE                                                  04192000
LIBVAL   EQU   LIBADR+2                                                 04193000
LIBADNUM EQU   LIBADR                                                   04194000
CPUCUX3  EQU   CPUCUAV+5                                                04195000
CPUCUX2  EQU   CPUCUAV+3                                                04196000
CPUCUX1  EQU   CPUCUAV                                                  04197000
CPCUANUM EQU   CPUCUAS                                                  04198000
CPUVAL   EQU   CPUS+2                                                   04199000
CPUNUM   EQU   CPUS                                                     04200000
VOLVAL   EQU   VOLUME+2                                                 04201000
VOLNUM   EQU   VOLUME                                                   04202000
SERVAL   EQU   DEVSERAL+2                                               04203000
SERNUM   EQU   DEVSERAL                                                 04204000
MODVAL   EQU   MODELS+2                                                 04205000
MODNUM   EQU   MODELS                                                   04206000
MDRVAL   EQU   DEVICE+204                                               04207000
MDRNUM   EQU   DEVICE+202                                               04208000
DEVVAL   EQU   DEVICE+2                                                 04209000
DEVNUM   EQU   DEVICE                                                   04210000
CUA2     EQU   CUAVAL+2                                                 04211000
CUA1     EQU   CUAVAL                                                   04212000
CUANUM   EQU   CUA                                                      04213000
LOADPTR  EQU   EDITABLE+8                                               04214000
LOADNAME EQU   EDITABLE                                                 04215000
EDITNUM  EQU   EDITLOAD                                                 04216000
SHARLET  EQU   SHAREIO+15                                               04217000
SHRCUAAH EQU   SHRCUCPU+5                                               04218000
SHRCUAAL EQU   SHRCUCPU+3                                               04219000
SHARSERA EQU   SHRCUCPU                                                 04220000
SHRCUABH EQU   SHRBASE+5                                                04221000
SHRCUABL EQU   SHRBASE+3                                                04222000
SHARSERB EQU   SHRBASE                                                  04223000
SHAREFLG EQU   SHAREIO                                                  04224000
SHARENUM EQU   SHARE                                                    04225000
SYSTEMP  EQU   SYSUM2+10                                                04226000
SYSPERM  EQU   SYSUM2+8                                                 04227000
SYSRANGE EQU   SYSUM2+7                                                 04228000
SYSDEV   EQU   SYSUM2+5                                                 04229000
SYSOLDA  EQU   SYSITEM                                                  04230000
SYS3705  EQU   SYSITEM                                                  04231000
SYSOLD   EQU   SYSCPUS                                                  04232000
SYSCPU   EQU   SYSCPUS                                                  04233000
SYSTROLL EQU   SYSRT+1                                                  04234000
SYSSPAN  EQU   SYSRT+1                                                  04235000
SYSCUA   EQU   SYSRT                                                    04236000
SYSGROUP EQU   SYSUMKEY                                                 04237000
SYSUMEOD EQU   SYSUMONE+96                                              04238000
SYSUMPER EQU   SYSUMONE+92                                              04239000
SYSUMPEA EQU   SYSUMONE+88                                              04240000
SYSUMPEI EQU   SYSUMONE+84                                              04241000
SYSUMCH  EQU   SYSUMONE+20                                              04242000
SYSUMMCN EQU   SYSUMONE+16                                              04243000
SYSUMMCR EQU   SYSUMONE+12                                              04244000
SYSUMNXT EQU   SYSUMONE+8                                               04245000
SYSUMIPL EQU   SYSUMONE+4                                               04246000
SYSUMNUM EQU   SYSUMONE                                                 04247000
SORTCORE EQU   SORTCCHR                                                 04248000
SORTTIME EQU   SORTKEY+1                                                04249000
SORTYEAR EQU   SORTKEY                                                  04250000
EVLETTER EQU   EVKEY+5                                                  04251000
EVSERIAL EQU   EVKEY+2                                                  04252000
EVMODEL  EQU   EVKEY                                                    04253000
EVNUM    EQU   EVTABLE+4                                                04254000
EVDAY    EQU   EVSTOP+1                                                 04255000
EVYEAR   EQU   EVSTOP                                                   04256000
TRETMP   EQU   TREND2+10                                                04257000
TREPRM   EQU   TREND2+8                                                 04258000
TRENDDEV EQU   TREND2+6                                                 04259000
TRENDDAT EQU   TRENDKEY+5                                               04260000
TRENDOD  EQU   TRENDITM                                                 04261000
TREND037 EQU   TRENDITM                                                 04262000
TRENDOLD EQU   TRENCPUS                                                 04263000
TRENDCPU EQU   TRENCPUS                                                 04264000
@NM00011 EQU   TRENDRT+1                                                04265000
TRENDCUA EQU   TRENDRT                                                  04266000
TRENDGRP EQU   TRENDKEY                                                 04267000
TREPRE   EQU   TREGEN+72                                                04268000
TRECCHF  EQU   TREGEN+68                                                04269000
TRECCHE  EQU   TREGEN+64                                                04270000
TRECCHD  EQU   TREGEN+60                                                04271000
TRECCHC  EQU   TREGEN+56                                                04272000
TRECCHB  EQU   TREGEN+52                                                04273000
TRECCHA  EQU   TREGEN+48                                                04274000
TRECCH9  EQU   TREGEN+44                                                04275000
TRECCH8  EQU   TREGEN+40                                                04276000
TRECCH7  EQU   TREGEN+36                                                04277000
TRECCH6  EQU   TREGEN+32                                                04278000
TRECCH5  EQU   TREGEN+28                                                04279000
TRECCH4  EQU   TREGEN+24                                                04280000
TRECCH3  EQU   TREGEN+20                                                04281000
TRECCH2  EQU   TREGEN+16                                                04282000
TRECCH1  EQU   TREGEN+12                                                04283000
TREMCH   EQU   TREGEN+4                                                 04284000
TREIPL   EQU   TREGEN                                                   04285000
TRENUM   EQU   TRENDONE+4                                               04286000
TRENEXT  EQU   TRENDONE                                                 04287000
DUMPSIZE EQU   DUMPINFO+4                                               04288000
DUMPADR  EQU   DUMPINFO                                                 04289000
DUMPNUM  EQU   DUMPTABL                                                 04290000
@NM00010 EQU   PARM+212                                                 04291000
RECLNGT1 EQU   PARM+204                                                 04292000
FRAMEPTR EQU   PARM+200                                                 04293000
ADCPUT   EQU   PARM+144                                                 04294000
@NM00009 EQU   CCHHRLNG+5                                               04295000
USERPGM  EQU   PARM+102                                                 04296000
IDTSEC   EQU   IDTIME+3                                                 04297000
IDSEC    EQU   IDTIME+2                                                 04298000
IDMIN    EQU   IDTIME+1                                                 04299000
IDHOUR   EQU   IDTIME                                                   04300000
IDASID   EQU   ERRID+4                                                  04301000
IDCPU    EQU   ERRID+3                                                  04302000
@NM00008 EQU   ERRID+2                                                  04303000
IDVALUE  EQU   ERRID                                                    04304000
NUMDAYS  EQU   PARM+88                                                  04305000
SORTNUM  EQU   PARM+84                                                  04306000
TABSIZE  EQU   PARM+80                                                  04307000
SYSRETRN EQU   @NM00007                                                 04308000
NUMIN222 EQU   @NM00006                                                 04309000
WRTHRSH  EQU   PARM+69                                                  04310000
RDTHRSH  EQU   PARM+66                                                  04311000
TERM     EQU   PARM+58                                                  04312000
EVSDAY   EQU   STRTDATE+1                                               04313000
EVSYEAR  EQU   STRTDATE                                                 04314000
PENSEC2  EQU   ENDTIME2+2                                               04315000
PENMIN2  EQU   ENDTIME2+1                                               04316000
PENHOUR2 EQU   ENDTIME2                                                 04317000
PSTSEC2  EQU   STTIME2+2                                                04318000
PSTMIN2  EQU   STTIME2+1                                                04319000
PSTHOUR2 EQU   STTIME2                                                  04320000
PENSEC1  EQU   ENDTIME1+2                                               04321000
PENMIN1  EQU   ENDTIME1+1                                               04322000
PENHOUR1 EQU   ENDTIME1                                                 04323000
PSTSEC1  EQU   STTIME1+2                                                04324000
PSTMIN1  EQU   STTIME1+1                                                04325000
PSTHOUR1 EQU   STTIME1                                                  04326000
@NM00005 EQU   ENDDT+4                                                  04327000
PENDY    EQU   PEND+1                                                   04328000
PENYR    EQU   PEND                                                     04329000
@NM00004 EQU   ENDDATE                                                  04330000
@NM00003 EQU   STDT+4                                                   04331000
PSTDY    EQU   PSTD+1                                                   04332000
PSTYR    EQU   PSTD                                                     04333000
@NM00002 EQU   STDATE                                                   04334000
YEARNOW  EQU   DATENOW+4                                                04335000
@NM00001 EQU   DATENOW+3                                                04336000
DAYNOW   EQU   DATENOW                                                  04337000
CSNAP    EQU   CLOSEIO                                                  04338000
OSNAP    EQU   OPENIO                                                   04339000
PASSFLAG EQU   MISC                                                     04340000
PLOGREC  EQU   MISC                                                     04341000
ERRORID  EQU   MISC                                                     04342000
PSUM     EQU   PRINTES                                                  04343000
PEDIT    EQU   PRINTES                                                  04344000
PHIST    EQU   MISC                                                     04345000
PACC     EQU   MISC                                                     04346000
PZERO    EQU   MISC                                                     04347000
DEBUG63  EQU   DEBUGA+3                                                 04348000
DEBUG62  EQU   DEBUGA+3                                                 04349000
DEBUG61  EQU   DEBUGA+3                                                 04350000
DEBUG60  EQU   DEBUGA+3                                                 04351000
DEBUG59  EQU   DEBUGA+3                                                 04352000
DEBUG58  EQU   DEBUGA+3                                                 04353000
DEBUG57  EQU   DEBUGA+3                                                 04354000
DEBUG56  EQU   DEBUGA+3                                                 04355000
DEBUG55  EQU   DEBUGA+2                                                 04356000
DEBUG54  EQU   DEBUGA+2                                                 04357000
DEBUG53  EQU   DEBUGA+2                                                 04358000
DEBUG52  EQU   DEBUGA+2                                                 04359000
DEBUG51  EQU   DEBUGA+2                                                 04360000
DEBUG50  EQU   DEBUGA+2                                                 04361000
DEBUG49  EQU   DEBUGA+2                                                 04362000
DEBUG48  EQU   DEBUGA+2                                                 04363000
DEBUG47  EQU   DEBUGA+1                                                 04364000
DEBUG46  EQU   DEBUGA+1                                                 04365000
DEBUG45  EQU   DEBUGA+1                                                 04366000
DEBUG44  EQU   DEBUGA+1                                                 04367000
DEBUG43  EQU   DEBUGA+1                                                 04368000
DEBUG42  EQU   DEBUGA+1                                                 04369000
DEBUG41  EQU   DEBUGA+1                                                 04370000
DEBUG40  EQU   DEBUGA+1                                                 04371000
DEBUG39  EQU   DEBUGA                                                   04372000
DEBUG38  EQU   DEBUGA                                                   04373000
DEBUG37  EQU   DEBUGA                                                   04374000
DEBUG36  EQU   DEBUGA                                                   04375000
DEBUG35  EQU   DEBUGA                                                   04376000
DEBUG34  EQU   DEBUGA                                                   04377000
DEBUG33  EQU   DEBUGA                                                   04378000
DEBUG32  EQU   DEBUGA                                                   04379000
DEBUG31  EQU   DEBUG+3                                                  04380000
DEBUG30  EQU   DEBUG+3                                                  04381000
DEBUG29  EQU   DEBUG+3                                                  04382000
DEBUG28  EQU   DEBUG+3                                                  04383000
DEBUG27  EQU   DEBUG+3                                                  04384000
DEBUG26  EQU   DEBUG+3                                                  04385000
DEBUG25  EQU   DEBUG+3                                                  04386000
DEBUG24  EQU   DEBUG+3                                                  04387000
DEBUG23  EQU   DEBUG+2                                                  04388000
DEBUG22  EQU   DEBUG+2                                                  04389000
DEBUG21  EQU   DEBUG+2                                                  04390000
DEBUG20  EQU   DEBUG+2                                                  04391000
DEBUG19  EQU   DEBUG+2                                                  04392000
DEBUG18  EQU   DEBUG+2                                                  04393000
DEBUG17  EQU   DEBUG+2                                                  04394000
DEBUG16  EQU   DEBUG+2                                                  04395000
DEBUG14  EQU   DEBUG+1                                                  04396000
DEBUG13  EQU   DEBUG+1                                                  04397000
DEBUG12  EQU   DEBUG+1                                                  04398000
DEBUG11  EQU   DEBUG+1                                                  04399000
DEBUG10  EQU   DEBUG+1                                                  04400000
DEBUG9   EQU   DEBUG+1                                                  04401000
DEBUG8   EQU   DEBUG+1                                                  04402000
DEBUG7   EQU   DEBUG                                                    04403000
DEBUG6   EQU   DEBUG                                                    04404000
DEBUG5   EQU   DEBUG                                                    04405000
DEBUG4   EQU   DEBUG                                                    04406000
DEBUG3   EQU   DEBUG                                                    04407000
DEBUG2   EQU   DEBUG                                                    04408000
DEBUG1   EQU   DEBUG                                                    04409000
DEBUG0   EQU   DEBUG                                                    04410000
SORTBRK  EQU   SWITCHES+1                                               04411000
COREFAIL EQU   SWITCHES+1                                               04412000
ANALYSIS EQU   SWITCHES+1                                               04413000
SHIFT3RD EQU   SWITCHES+1                                               04414000
DEVEXCL  EQU   SWITCHES+1                                               04415000
NOTALL   EQU   SWITCHES+1                                               04416000
TIMESEQ  EQU   SWITCHES                                                 04417000
SYSUM    EQU   SWITCHES                                                 04418000
PARMTHR  EQU   SWITCHES                                                 04419000
TREND    EQU   SWITCHES                                                 04420000
SHORTOBR EQU   SWITCHES                                                 04421000
PARMMES  EQU   SWITCHES                                                 04422000
RDESUM   EQU   SWITCHES                                                 04423000
PCCHFRAM EQU   RECTYPE+1                                                04424000
PMCHFRAM EQU   RECTYPE+1                                                04425000
PTTYP    EQU   RECTYPE+1                                                04426000
PEOD     EQU   RECTYPE                                                  04427000
PMIH     EQU   RECTYPE                                                  04428000
PDDR     EQU   RECTYPE                                                  04429000
PIPL     EQU   RECTYPE                                                  04430000
PSOFT    EQU   RECTYPE                                                  04431000
POBR     EQU   RECTYPE                                                  04432000
PCHAN    EQU   RECTYPE                                                  04433000
PMCH     EQU   RECTYPE                                                  04434000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      04435000
@RF00173 EQU   @EL00001                                                 04436000
@RF00214 EQU   @RC00212                                                 04437000
@RC00216 EQU   @RC00212                                                 04438000
@RC00233 EQU   @RC00212                                                 04439000
@RC00210 EQU   @EL00003                                                 04440000
@RC00284 EQU   @EL00004                                                 04441000
@RF00331 EQU   @EL00005                                                 04442000
@RT00368 EQU   HDRERR0                                                  04443000
@RT00370 EQU   HDRERR1                                                  04444000
@RT00415 EQU   CHK03                                                    04445000
@RT00417 EQU   CHK04                                                    04446000
@RT00447 EQU   @EL00008                                                 04447000
@RF00540 EQU   @EL00009                                                 04448000
@RF00562 EQU   @EL00010                                                 04449000
@RF00594 EQU   @RC00588                                                 04450000
@RC00571 EQU   @EL00011                                                 04451000
@RF00614 EQU   @EL00011                                                 04452000
@RC00696 EQU   @EL00014                                                 04453000
@RC00723 EQU   @EL00015                                                 04454000
@RC00740 EQU   @EL00015                                                 04455000
@RC00769 EQU   @EL00016                                                 04456000
@RC00788 EQU   @EL00017                                                 04457000
@RF00799 EQU   @EL00017                                                 04458000
@RC00810 EQU   @EL00018                                                 04459000
@RC00824 EQU   @EL00019                                                 04460000
@RC00846 EQU   @EL00020                                                 04461000
@RC00865 EQU   @EL00021                                                 04462000
@RC00872 EQU   @EL00022                                                 04463000
@RF00895 EQU   @EL00022                                                 04464000
@RC00906 EQU   @EL00023                                                 04465000
@RC00909 EQU   @EL00023                                                 04466000
@RC00933 EQU   @EL00025                                                 04467000
@RC00956 EQU   @EL00026                                                 04468000
@RC00983 EQU   @EL00027                                                 04469000
@RF00996 EQU   @EL00027                                                 04470000
@RC01007 EQU   @EL00028                                                 04471000
@RF01020 EQU   @EL00028                                                 04472000
@RC01031 EQU   @EL00029                                                 04473000
@RC01049 EQU   @EL00030                                                 04474000
@RF01075 EQU   @EL00030                                                 04475000
@RC01086 EQU   @EL00031                                                 04476000
@RC01105 EQU   @EL00032                                                 04477000
@RF01116 EQU   @EL00032                                                 04478000
@RC01127 EQU   @EL00033                                                 04479000
@RC01149 EQU   @EL00034                                                 04480000
@RF00220 EQU   @RC00216                                                 04481000
@RF00252 EQU   @RC00210                                                 04482000
@RC00256 EQU   @RC00210                                                 04483000
@RF00706 EQU   @RC00696                                                 04484000
@RC00725 EQU   @RC00723                                                 04485000
@RF00750 EQU   @RC00740                                                 04486000
@RC00874 EQU   @RC00872                                                 04487000
@ENDDATA EQU   *                                                        04488000
         END   IFCIOHND                                                 04489000
