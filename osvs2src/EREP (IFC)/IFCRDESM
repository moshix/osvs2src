         TITLE 'IFCRDESM - RDE SUMMARY                                 *00001000
                        '                                               00002000
IFCRDESM CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IFCRDESM  78.039'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  ST    @14,12(,@13)                                        0001 00010000
         STM   @00,@12,20(@13)                                     0001 00011000
         BALR  @10,0                                               0001 00012000
@PSTART  LA    @11,4095(,@10)                                      0001 00013000
         LA    @12,4095(,@11)                                      0001 00014000
         USING @PSTART,@10                                         0001 00015000
         USING @PSTART+4095,@11                                    0001 00016000
         USING @PSTART+8190,@12                                    0001 00017000
         ST    @13,@SA00001+4                                      0001 00018000
         LA    @14,@SA00001                                        0001 00019000
         ST    @14,8(,@13)                                         0001 00020000
         LR    @13,@14                                             0001 00021000
*********************************************************************** 00022000
*                                                                     * 00023000
* NAME - RELIABILITY DATA EXTRACTOR SUMMARY PROGRAM - IFCRDESM        * 00024000
*                                                                     * 00025000
* FUNCTION -   THIS MODULE PRODUCES TWO REPORTS. AN IPL REPORT AND    * 00026000
*              A  HARDWARE ERROR REPORT. THE FUNCTION OF THIS MODULE  * 00027000
*              IS ACHIEVED BY EXECUTING THE IFCEREP0 SERVICE AID USING* 00028000
*              THE RDESUM=Y PARAMETER.                                * 00029000
*                                                                     * 00030000
*               A.THE IPL SUMMARY REPORT PROVIDES THE USER WITH A LIST* 00031000
*                 OF IPLS  WITHIN A SPECIFIED TIME FRAME, THE DATE AND* 00032000
*                 TIME OF EACH IPL, THE REASON FOR IPL, AND THE       * 00033000
*                 SUBSYSTEM RESPONSIBLE FOR EACH IPL.                 * 00034000
*                                                                     * 00035000
*                  NOTE: THE REASON FOR IPL AND THE SUBSYSTEM TO WHICH* 00036000
*                        THE IPL IS ATTRIBUTED ARE PROVIDED BY THE    * 00037000
*                        OPERATOR DURING THE IPL SEQUENCE.            * 00038000
*                                                                     * 00039000
*               B.THE HARDWARE ERROR REPORT PROVIDES STATISTICS ON NON* 00040000
*                 TRANSPARENT SYSTEM ERRORS. THESE STATISTICS ARE     * 00041000
*                 BROKEN DOWN BY SUBSYSTEM AND DEVICE ADDRESS WHENEVER* 00042000
*                 POSSIBLE. THESE STATISTICS ARE ALSO SUBDIVIDED BY   * 00043000
*                 SEVERITY INTO TWO CATEGORIES:                       * 00044000
*                                                                     * 00045000
*                  1.SYSTEM CONTINUED TO OPERATE.                     * 00046000
*                                                                     * 00047000
*                  2.SYSTEM STOPPED.                                  * 00048000
*                                                                     * 00049000
* ENTRY POINT - IFCRDESM                                              * 00050000
*                                                                     * 00051000
* INPUT - THE ONLY VALID INPUT TO THIS PROGRAM IS THE MEASUREMENT DATA* 00052000
*         SET CREATED BY THE EREP MODULE IFCRDE03. THIS DATA SET IS   * 00053000
*         CREATED ONLY IF RDE HAS BEEN SELECTED AT SYSGEN TIME. THE   * 00054000
*         DSNAME IS EREPTAPE. THE DD NAME FOR INPUT PURPOSES IS RDETP.* 00055000
*                                                                     * 00056000
* OUTPUT - THE OUTPUT OF THIS PROGRAM CONSISTS OF THE TWO REPORTS     * 00057000
*         PREVIOUSLY DESCRIBED UNDER FUNCTION. THEY GO TO SYSOUT.     * 00058000
*                                                                     * 00059000
* EXTERNAL REFERENCES - THE FOLLOWING ARE USED BY THIS MODULE:        * 00060000
*                        OPEN - INPUT AND OUTPUT DATA SETS            * 00061000
*                        CLOSE - INPUT AND OUTPUT DATA SETS           * 00062000
*                        GET - TO READ INPUT DATA SET                 * 00063000
*                        PUT - TO WRITE OUTPUT DATA SET               * 00064000
*                                                                     * 00065000
* EXITS,NORMAL - NORMAL EXIT TO R14 WITH RETURN CODE IN R15.          * 00066000
*                                                                     * 00067000
* EXITS,ERROR  - ERROR EXIT TO R14 WITH RETURN CODE IN R15.           * 00068000
*                                                                     * 00069000
* TABLES/WORK AREAS - NO EXTERNAL TABLES OR WORK AREAS ARE USED.ALL   * 00070000
*                     WORK AREAS ARE INTERNAL TO THE MODULE.          * 00071000
*                                                                     * 00072000
* ATTRIBUTES - PROBLEM PROGRAM, NON RESIDENT, NON-REUSABLE.           * 00073000
*                                                                     * 00074000
* CHARACTER CODE DEPENDENCY - THIS MODULE IS CHARACTER CODE DEPENDENT * 00075000
*                             AND MUST BE REASSEMBLED IF MODE CHANGED * 00076000
*                             FROM EBCDIC.                            * 00077000
*                                                                     * 00078000
* NOTES - IN ORDER TO INSURE THE ACCURACY OF THIS REPORT, Z EOD SHOULD* 00079000
*         BE USED WHEN ENDING OPERATION.                              * 00080000
*                                                                     * 00081000
*              RELIABILITY  DATA  EXTRACTOR  SUMMARY  PROGRAM         * 00082000
*                                                                     * 00083000
*    PHASE 1 :    STATISTICS OF IPLS  DUE TO ALL CAUSES               * 00084000
*                                                                     * 00085000
*    PHASE 2 :    STATISTICS OF ERRORS FROM  HARDWARE UNITS           * 00086000
*                                                                     * 00087000
*********************************************************************** 00088000
*                                                                       00089000
*        SAVER2 = R2;                                      /*@Z427VLS*/ 00090000
         ST    R2,SAVER2                                           0058 00091000
*        IF DEBUG4 = ON THEN       /*PRINT NAME AND COMPILE DATE     */ 00092000
         L     @15,SAVER2                                          0059 00093000
         TM    DEBUG4(@15),B'00001000'                             0059 00094000
         BNO   @RF00059                                            0059 00095000
*         DO;                                              /*@Z427VLS*/ 00096000
*          R0 = R10 - 27;                                  /*@Z427VLS*/ 00097000
         LR    R0,R10                                              0061 00098000
         SL    R0,@CF00763                                         0061 00099000
*          GEN(MVC  IPLRPT+1(16),0(R0));                   /*@Z427VLS*/ 00100000
         MVC  IPLRPT+1(16),0(R0)                                        00101000
*          PRINTADR = ADDR(PRINTER);                       /*@Z427VLS*/ 00102000
         L     @15,SAVER2                                          0063 00103000
         LA    @14,PRINTER                                         0063 00104000
         ST    @14,PRINTADR(,@15)                                  0063 00105000
*          CALL IOHND(RITEPRTR);                           /*@Z427VLS*/ 00106000
         L     @15,ADIOHND(,@15)                                   0064 00107000
         LA    @01,@AL00064                                        0064 00108000
         BALR  @14,@15                                             0064 00109000
*          R0 = ZERO;                                      /*@Z427VLS*/ 00110000
         SLR   R0,R0                                               0065 00111000
*         END;                                             /*@Z427VLS*/ 00112000
*        CALL  IOHND(READCARD);    /* READ CONTROL CARD      @Z427VLS*/ 00113000
@RF00059 L     @14,SAVER2                                          0067 00114000
         L     @15,ADIOHND(,@14)                                   0067 00115000
         LA    @01,@AL00067                                        0067 00116000
         BALR  @14,@15                                             0067 00117000
*GENERATE REFS(PRINTADR);                                  /*@Z427VLS*/ 00118000
         LTR   R15,R15             ANY ERROR.                           00119000
         BNZ   NOCRDMSG            YES, EXIT.                           00120000
         MVC   CTLCRD,N0(R7)       MOVE CONTROL CARD                    00121000
*********************************************************************** 00122000
*                                                                     * 00123000
*              INTREPRET CONTROL CARD                                 * 00124000
*                                                                     * 00125000
*********************************************************************** 00126000
         MVC   CTLCRLIN(N80),CTLCRD PRINT CONTROL CARD                  00127000
         BAL   R14,PRINT           PRINT CONTROL CARD                   00128000
         CLC   CCLEDGEN(N6),CTLCRDTS VALID CONTROL CARD                 00129000
         BNE   NOCRDMSG            PRINT ERROR                          00130000
         LA    R2,CCSTART          GET ADDR OF DATE FOR                 00131000
         BAL   R14,PACKHEX         CONVERT DATE                         00132000
         LTR   R15,R15             COND CODE 0  START DATE              00133000
         BNZ   STRDTMSG            PRODUCE ERROR MSG AND STOP           00134000
         ST    R9,STRTIME          SAVE JULIAN START TIME SEC           00135000
         ST    R9,STRTIMEP          SAVE CTL CD STARTIME       @XA16800 00136000
         CLC   CCEND(N5),BLANKS    END DATE AVAILABLE                   00137000
         BE    CKCLUSTR            NO CHECK IPL CLUSTER VALUE           00138000
         LA    R2,CCEND            GO CONVERT JULIAN DATE TO            00139000
         BAL   R14,PACKHEX         CONVERT DATE                         00140000
         LTR   R15,R15             RETURN CODE 0 END DATE               00141000
         BNZ   ENDDTMSG            OTHERWISE LEAVE BLANK                00142000
         A     R9,TWENFOUR         ADD 24 HRS TO END DATE               00143000
         ST    R9,ENDTIME          SAVE END TIME + 24 HRS               00144000
         CLC   STRTIME(N4),ENDTIME IS END TIME LOWER THAN               00145000
         BNL   ENDDTMSG            BRANCH TO ERROR ROUTINE              00146000
CKCLUSTR CLC   CCCLUST(N2),BLANKS  CLUSTER TIME AVAILABLE               00147000
         BE    STARTRUN            START RDE SUMMARY PROCESS            00148000
         XC    BWORK(N8),BWORK     ZERO OUT WORK AREA                   00149000
         TM    CCCLUST,XF0         IS CLUSTER TIME NUMERIC              00150000
          BNO   CLUSTMSG            ED MUST BE VALID           @XA16800 00151000
         TM    CCCLUST+N1,XF0      IS SECOND BYTE OK                    00152000
         BNO   CLUSTMSG            ED MUST BE VALID                     00153000
         PACK  INVALUE(N2),CCCLUST(N2) PACK CLUSTER TIME                00154000
         XR    R8,R8               CLEAR REG 8                          00155000
         CVB   R9,BWORK            CONVERT TO BINARY                    00156000
         M     R8,SIXTY            COMPUTE SECONDS                      00157000
         ST    R9,CLUSTIME         SAVE                                 00158000
         EJECT                               SKIP PAGE                  00159000
*********************************************************************** 00160000
*   THIS ROUTINE READS THE HISTORY TAPE - CONVERTS TIME TO SEC AND    * 00161000
*   PASSES ONLY RECORDS WITHIN THE SPECIFIED REPORTING TIME PERIOD.   * 00162000
*********************************************************************** 00163000
*                                                                       00164000
STARTRUN MVI   SW,X00              CLEAR SWITCH INITIALLY               00165000
READ     EQU   *                                                        00166000
*        R2 = SAVER2;                                      /*@Z427VLS*/ 00167000
         L     @15,SAVER2                                          0069 00168000
         LR    R2,@15                                              0069 00169000
*        CALL  IOHND(READSEQ);     /* READ HISTORY INPUT TAPE        */ 00170000
         L     @15,ADIOHND(,@15)                                   0070 00171000
         LA    @01,@AL00070                                        0070 00172000
         BALR  @14,@15                                             0070 00173000
*GENERATE REFS(LRTKEY1,LOGCODE,MCHLOG,CCHCUA,OBRCSW,OBRPCUA,       0071 00174000
*              PRINTADR,IPLREAS,IPLSYSID,LRTMODEL);        /*@Z427VLS*/ 00175000
         MVI   PRINTER,C'0'        INDICATE EREPPT DATA SET OUTPUT      00176000
         LTR   R15,R15             EOF/ERROR                            00177000
         BNZ   WRAPUP              END REPORT                           00178000
         LR    R1,R7               LOAD RECORD ENTRY                    00179000
         ST    R7,SAVERDE          SAVE RECORD PTR                      00180000
         TM    SW,X01              BYPASS THIS RECORD                   00181000
         BO    CHKMORE             YES                         @XA16800 00182000
         B     SKIPEDIT            DONT CHECK FURTHER          @XA16800 00183000
CHKMORE  CLI   LRTKEY(R1),X'10'    IS RECORD MACHINE TYPE      @XA16800 00184000
         BE    READ                 SKIP THIS RECORD           @XA16800 00185000
SKIPEDIT DS    0H                                              @XA16800 00186000
         NI    SW,XFE              CLEAR SWITCH                         00187000
         LA    R2,LRTDATE(R1)      GO EDIT AND CONVERT THET             00188000
         MVC   BNDRY(4),0(R2)       PREVENT 0C6                @XA16800 00189000
         L     R9,BNDRY             GET LOGDATE DATA           @XA16800 00190000
         LTR   R9,R9                TEST FOR ZERO              @XA16800 00191000
         BZ    HOLDSEC0             USE ZERO DATA FOR REPORT   @XA16800 00192000
         CLI  0(R2),X'00'        IS DATE VALID                 @XA16800 00193000
         BNE   HOLDSEC0            USE BAD DATA BUT ABBR RPT   @XA16800 00194000
         LA    R0,4                SET # BYTES TO CHECK PACK   @XA16800 00195000
         LA    R1,BNDRY            SET ADDR OF PCK DEC FIELD   @XA16800 00196000
         BAL   R14,CHKDEC          GO CHK FOR VALID PCK DEC    @XA16800 00197000
         LTR   R15,R15             IS IT A VALID PCK DEC FLD   @XA16800 00198000
         BNZ   HOLDSEC0            YES--CONTINUE               @XA16800 00199000
         BAL   R14,CONVDATE        JULIAN DATE TO SECONDS               00200000
         LTR   R15,R15             RETURN CODE OF 0                     00201000
         BZ    HOLDSEC            DATE IS LEGAL NON-ZERO       @XA16800 00202000
HOLDSEC0 OI    SW1,XC0             SET ABBR RPT SW AND BAD TM  @XA16800 00203000
         B     RECIDENT             CHECK REC TYPE             @XA16800 00204000
HOLDSEC  EQU   *                  HOLD TIME IN SECONDS         @XA16800 00205000
         BAL   R14,CONVTIME        GO CONVERT TIME TO SEC               00206000
         L     R3,STRTIMEP         GET USER CTRL CD STRT TIME  @XA16800 00207000
         CR    R9,R3               CMP LOG TIME TO START TIME           00208000
         BL    READ                LOG TIME LOW GET NEXT RCD            00209000
         A     R3,MONTH            ONE MONTH OF START TIME              00210000
         CR    R9,R3                                                    00211000
         BH    READ                NOT WITHIN ONE MONTH LIMIT           00212000
         TM    SW,X02              IS START TIME STORED                 00213000
         BO    ENDPEROI            YES                                  00214000
         ST    R9,STRTIME          SET ACTUAL START TIME.               00215000
         OI    SW,X02              START TIME STORED                    00216000
         CLC   FRSTTIME(N4),FULLZERO FIRST RECORD PROCESSED             00217000
         BNE   ENDPEROI            BRANCH-- NOT FIRST                   00218000
         ST    R9,FRSTTIME         YES - SAVE TIME                      00219000
ENDPEROI L     R4,ENDTIME          WAS END OF REPORT TIME               00220000
         LTR   R4,R4               SUPPLIED BY THE USER                 00221000
         BZ    RECIDENT            NO CONT TILL EOF                     00222000
         CR    R9,R4               YES IS TIME GREATER THAN             00223000
         BH    READ                READ NEXT RECORD                     00224000
RECIDENT MVC   SAVEDATE(N4),LRTDATE(R1) SAVE DATE LAST ACCEPTED RCD     00225000
         ST    R9,CURRTIME         TIME BECOMES CURRENT TIME            00226000
         NI    PH2SW,X00           TURN LAST INCIDENT SWS  OFF          00227000
         CLI   LRTKEY1(R1),X'10'   IS RECORD TYPE HEX 0X                00228000
         BL    OTHERID             YES, GO TO OTHER                     00229000
         CLI   LRTKEY1(R1),X'20'   IS RECORD TYPE HEX 1X                00230000
         BL    MCH                 YES, GO TO MACH CK                   00231000
         CLI   LRTKEY1(R1),X'30'   IS RECORD TYPE HEX 2X                00232000
         BL    CCH                 YES, GO TO CHANNEL CK                00233000
         CLI   LRTKEY1(R1),X'40'   IS RECORD TYPE HEX 3X                00234000
         BL    OBR                 YES, GO TO OBR ROUTINE               00235000
         CLI   LRTKEY1(R1),X'50'   IS RECORD TYPE HEX 4X                00236000
         BL    OTHERID             YES, GO TO OTHER ID                  00237000
         CLI   LRTKEY1(R1),X'60'   IS RECORD TYPE HEX 5X                00238000
         BL    IPL                 YES, GO TO IPL                       00239000
         CLI   LRTKEY1(R1),X'80'   IS RECORD TYPE HEX 6X OR 7X          00240000
         BL    OTHERID             YES, GO TO OTHER ID                  00241000
         CLI   LRTKEY1(R1),X'90'   IS RECORD TYPE HEX 8X                00242000
         BL    EOD                 YES, GO TO END OF DAY                00243000
         EJECT                                                          00244000
*********************************************************************** 00245000
*      RECORD  TYPE EQ OTHER                                          * 00246000
*********************************************************************** 00247000
*                                                                       00248000
OTHERID  NI    SW,X7F              TURN OFF CCH SWITCH                  00249000
         ST    R9,PH2TIME          ASSIGN TIME TO LAST INCID            00250000
         B     READ                RETURN FOR NEXT RECORD               00251000
         EJECT                                                          00252000
*********************************************************************** 00253000
*    RECORD TYPE EQU MACHINE CHECK                                    * 00254000
*********************************************************************** 00255000
*                                                                       00256000
MCH      NI    SW,X7F              TURN OFF CCH SWITCH                  00257000
         TM    LOGCODE(R1),X10     IS RECORD 1ST OF TWO                 00258000
         BZ    MCHGO               NO, GO ON.                           00259000
         OI    SW,X01              SET TO BYPASS 2ND RECORD             00260000
MCHGO    MVI   PH2INCID,X01        INCIDENT TYPE EQ SI                  00261000
         TM    LOGCODE(R1),X60     SYS TERM OR REC INCOMPL ON           00262000
         BM    COMPPH2             YES, SI TYPE                         00263000
         MVI   PH2INCID,X02        NO INCIDENT TYPE = SRI               00264000
         TM    MCHLOG(R1),XC0      BIT 0 OR 1 OF MCI CODE ON            00265000
         BNZ   COMPPH2             LAST INCID = SRI                     00266000
         ST    R9,PH2TIME          ASIGN TIME TO LAST INCID.            00267000
         MVI   PH2INCID,X04        SET OTHER FOR LAST INCIDENT          00268000
         B     READ                GO READ NEXT RECORD                  00269000
COMPPH2  MVI   PH2DEV,N1           CODE DEVICE AS CPU                   00270000
         TM    MCHLOG+2(R1),XA0    BITS 16 - 18 OFF = CPU               00271000
         BZ    ENDMCH              DEVICE = CPU                         00272000
         MVI   PH2DEV,N2           CODE DEVICE AS STORAGE               00273000
         BM    ENDMCH              DEVICE = STORAGE                     00274000
         MVI   PH2DEV,N3           CODE DEVICE CHANNEL                  00275000
         TM    LOGCODE(R1),X08     IS LOGCODE CHANNEL CODE              00276000
         BO    ENDMCH              DEVICE EQ CHANNEL                    00277000
         MVI   PH2DEV,N4           NONE OF ABOVE,CODE OTHER             00278000
ENDMCH   ST    R9,PH2TIME          ASSIGN TIME TO LAST INCID            00279000
         B     RDEPH2              DATA READY GO TO PHASE 2             00280000
         EJECT                                                          00281000
*********************************************************************** 00282000
*    RECORD TYPE EQ CHANNEL CHECK                                     * 00283000
*********************************************************************** 00284000
*                                                                       00285000
CCH      NI    SW,X7F              TURN OFF CCH SWITCH                  00286000
         TM    LOGCODE(R1),X70     SYS TERM OR REC INCOMPL OR           00287000
         BM    CCHSI               CHAN UNSUPPORTED BIT ON              00288000
         OI    SW,X80              NO TURN ON CCH SWITCH                00289000
         MVI   PH2SW,N0            LAST INCIDENT TYP = OTHER            00290000
ENDCCH   MVC   PH2DEV,CCHCODE+2(R1)  DEVICE TYPE               @XA16800 00291000
         MVC   PH2CUA,CCHCUA(R1)   CONTROL UNIT ADDRESS                 00292000
         ST    R9,PH2TIME          ASSIGN TIME                          00293000
         TM    SW,X80              CCH SWITCH ON                        00294000
         BO    READ                READ NEXT RECORD                     00295000
         B     RDEPH2              REG 4 =4 GO TO PHASE 2               00296000
CCHSI    MVI   PH2INCID,X01        LAST INCIDENT = SI                   00297000
         B     ENDCCH              GO END CCH PROCESS                   00298000
         EJECT                                                          00299000
**********************************************************************  00300000
*     RECORD TYPE EQU OBR                                             * 00301000
**********************************************************************  00302000
*                                                                       00303000
OBR      TM    LOGCODE(R1),X80     IS SDR DUMP BIT ON                   00304000
         BO    OBROTHER            YES INCIDENT TYPE = OTHER            00305000
         TM    SW,X80              IS CCH SW ON                         00306000
         BZ    OBRUCB              NO-CONTINUE                          00307000
         NI    SW,X7F              TURN OFF CCH SW                      00308000
         CLC   OBRCODE+2(N1,R1),PH2DEV  DEVICE DOE THE SAME-CCH@XA16800 00309000
         BE    OBRSRI              YES INC TYPE = SRI                   00310000
OBRUCB   TM    OBRCSW+4(R1),X02    BIT 38 IS UNIT CHECK                 00311000
         BZ    OBROTHER            YES INCIDENT TYPE = OTHER            00312000
         TM    LOGCODE(R1),X40     IS TEMP ERROR BIT OFF                00313000
         BZ    OBRSRI              YES INCIDENT TYPE = SRI              00314000
OBROTHER MVI   PH2INCID,X04        INCIDENT TYPE = OTHER                00315000
         ST    R9,PH2TIME          ASSIGN TIME LAST INCIDENT            00316000
         B     READ                READ NEXT RECORD                     00317000
OBRSRI   MVI   PH2INCID,X02        INCIDENT TYPE EQ SRI                 00318000
         ST    R9,PH2TIME          ASSIGN TIME                          00319000
         MVC   PH2DEV,OBRCODE+2(R1)  DEVICE TYPE               @XA16800 00320000
         MVC   PH2CUA,OBRPCUA(R1)  *CONTROL UNIT ADDRESS                00321000
         B     RDEPH2              GO TO PHASE 2                        00322000
         EJECT                                                          00323000
**********************************************************************  00324000
*    RECORD TYPE EQU IPL                                              * 00325000
**********************************************************************  00326000
*                                                                       00327000
IPL      NI    SW,X77              TURN OFF CCH SW & CLUSTER TBL SHIFT  00328000
         L     R4,SEQNO            GET SEQ NO                           00329000
         LA    R4,N1(R4)           ADD 1 TO SEQ NO                      00330000
         ST    R4,SEQNO            SEQ NO = SEQ NO +1                   00331000
         CLI   PH2INCID,X01        IS LAST INCIDENT TYPE SI             00332000
         BE    LASTSI              YES GO TURN ON SI BIT                00333000
         CLI   PH2INCID,X02        IS LAST INCIDENT TYPE SRI            00334000
         BE    LASTSRI             YES GO TURN ON SRI BIT               00335000
         OI    PH2SW,X20           LAST INCIDENT TYPE = IPL             00336000
         B     INCIDIPL            NO MAKE LAST INCIDENT IPL            00337000
LASTSI   OI    PH2SW,X80                                                00338000
         B     INCIDIPL            BRANCH TO INCIDIPL                   00339000
LASTSRI  OI    PH2SW,X40                                                00340000
INCIDIPL MVI   PH2INCID,N53        SET LAST INCID TO IPL.               00341000
         MVC   PH2DEV(N4),FULLZERO ZERO OUT DEV TYPE AND CUA            00342000
         ST    R9,PH2TIME          ASSIGN TIME                          00343000
         ST    R9,LASTINCT         SAVE LAST INCIDENT TIME              00344000
         MVC   PH2REA(N2),IPLREAS(R1)  IPL REASON CODE                  00345000
         MVC   PH2SSID,IPLSYSID(R1)  USE SSID IN IPL RECORD             00346000
         TM    SW,X10              IPL HEADING REQUIRED                 00347000
         BO    PRTLINE             NO- NOT REQUIRED                     00348000
         OI    SW,X10              INDICATE HEADING FINISHED            00349000
         MVC   RPTCUS(N55),CCCUST  CUSTOMER NAME                        00350000
         MVI   PRT,SKIP            SKIP A PAGE                          00351000
         BAL   R14,PRINT           GO PRINT LINE                        00352000
         L     R1,SAVERDE          RESTORE RDE POINTER.                 00353000
         MVO   JULIAN(N4),LRTMODEL(N2,R1)  OFFSET MODEL NO.    @XA16800 00354000
         OI    JULIAN3,X0F         SETUP UP FOR EDIT                    00355000
         LA    R0,2                CHECK 2 BYTES FOR MDL NO    @XA16800 00356000
         LA    R1,JULIAN2          STARTING AT JULIAN2         @XA16800 00357000
         BAL   R14,CHKDEC          CHECK FOR DEC NUMBERS       @XA16800 00358000
         LTR   R15,R15             CHK RETURN CODE             @XA16800 00359000
         BZ    MDLNUMOK            CANT GET MDL NO.FR 1ST REC  @XA16800 00360000
         OI    SW1,X04             SET SW FOR 1ST REC BAD      @XA16800 00361000
         B     MDLNUMNG            SKIP MDL NO. INSERTION      @XA16800 00362000
MDLNUMOK EQU   *                                               @XA16800 00363000
         MVC   HDMODEL(N3),MDPATRN                                      00364000
         ED    HDMODEL(N3),JULIAN2 EDIT MODEL NUMBER                    00365000
MDLNUMNG EQU   *                                               @XA16800 00366000
         MVC   RPTHDLN1(N61),HEADLIN1 HEADING                           00367000
         MVI   PRT,SPACE2          DOUBLE SPACE                         00368000
         BAL   R14,PRINT           PRINT LINE                           00369000
         MVC   HDDATE(N7),DTPATRN  DATE PATTERN 202048202020            00370000
         PACK  JULIAN(N4),CCSTART(N5) PACK CC DATE                      00371000
         ED    HDDATE(N7),JULIAN1  EDIT CC START DATE                   00372000
         MVC   RPTHDLN2(N31),HEADLIN2 PRINT                             00373000
         MVI   PRT,SPACE2          DOUBLE SPACE                         00374000
         BAL   R14,PRINT           HEADING LINE                         00375000
         MVC   RPTHDLN3(N11),HEADLIN3 PRINT                             00376000
         MVI   PRT,SPACE2          DOUBLE SPACE REPORT                  00377000
         BAL   R14,PRINT           REPORT                               00378000
         MVC   RPTHDLN4(N112),HEADLIN4 HEADING                          00379000
         BAL   R14,PRINT           PRINT LINE                           00380000
         MVI   PRT,SPACE2          DOUBLE SPACE FIRST DETAIL            00381000
         XC    LINES,LINES         SET LINE COUNT                       00382000
         MVI   LINES+1,X'09'       INITIALLY FOR HEADER                 00383000
         L     R1,SAVERDE          RESTORE RDE POINTER                  00384000
PRTLINE  L     R2,SEQNO            IPL SEQ NO IN BINARY                 00385000
         CVD   R2,BWORK            CONVERT TO DEC                       00386000
         OI    BWORK7,X0F          CORRECT SIGN                         00387000
         MVC   RPTSEQ(N4),EDITSEQ  EDIT PATTERN TO PRINT AREA  @XA16800 00388000
         ED    RPTSEQ(N4),BWORK6   EDIT IPL SEQUENCE NUMBER    @XA16800 00389000
         TM    SW1,X04             TEST SW FOR BAD MDL NO.     @XA16800 00390000
         BNO   PRTOKLIN            NO SET - NORMAL PRINT       @XA16800 00391000
         NI    SW1,XFB             CLEAR BAD MDL NO SW         @XA16800 00392000
         OI    SW1,X90             SET SWS FOR ABBR RPT,WNLNOTE@XA16800 00393000
         MVI   PRT7,C'*'                                       @XA16800 00394000
         MVI   PRT8,C'*'                                       @XA16800 00395000
         MVC   RPTLOST(N10),WNLNOTE SET WARNING FOR PRINT      @XA16800 00396000
         B     PRTLIN10            PRINT LINE AS IS - NO DATA  @XA16800 00397000
PRTOKLIN L     R3,PREVSTRT         GET PREVIOUS IPL TIME SAVED @XA16800 00398000
         CR    R9,R3               COMPARE NEW WITH PREVIOUS   @XA16800 00399000
         BH    PREVTMOK            PREVIOUS TIME LOWER - O.K.  @XA16800 00400000
         OI    SW1,X80             SET ABBR REPORT IND         @XA16800 00401000
         MVI   PRT7,C'*'           FLAG ALL LOWER              @XA16800 00402000
         MVI   PRT8,C'*'           IPL RECORDS                 @XA16800 00403000
         B     NOSAVIPL            DO NOT SAVE THIS IPL DATE   @XA16800 00404000
PREVTMOK ST    R9,PREVSTRT         SAVE LATEST IPL TIME        @XA16800 00405000
NOSAVIPL EQU   *                                               @XA16800 00406000
         TM    SW1,X40             TEST FOR BAD DATE DATA PRT  @XA16800 00407000
         BNO   PRTNORLN            DO NORMAL PRINT LINE        @XA16800 00408000
         STM   R5,R8,BDDRSV        SAVE REGS5-8                @XA16800 00409000
         MVI   PRT7,X'5C'          INSERT FLAGS AFTER          @XA16800 00410000
         MVI   PRT8,X'5C'          SEQUENCE NUMBER             @XA16800 00411000
         L     R7,LRTDATE(R1)      GET LOGREC YR-DAY DATA      @XA16800 00412000
PRTLINE1 SR    R6,R6               CLEAR REG6                  @XA16800 00413000
PRTLINE2 L     R5,MASK0F           MASK INTO REG5              @XA16800 00414000
         SLDL  R6,N4               POSITION DIGIT FOR TEST     @XA16800 00415000
         NR    R5,R6               LIMIT TEST TO LOW 4 BITS    @XA16800 00416000
         C     R5,NINE             CHK FOR HEX CHARS A-F       @XA16800 00417000
         BH    PRTLINE3            EQUAL OR HIGH BRANCH        @XA16800 00418000
         A     R6,ZONEF0           ADD ZONE FOR NUMERIC DIGIT  @XA16800 00419000
         B     PRTLINE4            GO PRINT                    @XA16800 00420000
PRTLINE3 A     R6,CONSTB7          FORMS ALPHABETIC CHAR CODE  @XA16800 00421000
PRTLINE4 LTR   R6,R6               CHK FOR FULL REG            @XA16800 00422000
         BM    PRTLINE5            YES FULL                    @XA16800 00423000
         SLL   R6,N4               NO, SHIFT AND GO BACK       @XA16800 00424000
         B     PRTLINE2            REPEAT ABOVE ROUTINE        @XA16800 00425000
PRTLINE5 TM    SW1,X20             TEST FOR 1ST TIME THRU SW   @XA16800 00426000
         BO    PRTLINE6            NO - SECOND TIME            @XA16800 00427000
         OI    SW1,X20             YES BUT SET INDICATOR       @XA16800 00428000
         ST    R6,PRTWRKA          PUT IN WORK AREA            @XA16800 00429000
         MVC   PRT10(4),PRTWRKA    MOVE INTO PRT BFR           @XA16800 00430000
         MVI   PRT14,C'.'          SET PERIOD AFTER YEAR DATA  @XA16800 00431000
         B     PRTLINE1            DO LOOP AGAIN FOR DAY DATA  @XA16800 00432000
PRTLINE6 ST    R6,PRTWRKA          PUT DAY DATA IN WRK AREA    @XA16800 00433000
         MVC   PRT15(4),PRTWRKA    MOVE INTO PRT BFR           @XA16800 00434000
         NI    SW1,X9F             CLEAR SWS EXCEPT ABBR RPT   @XA16800 00435000
         LM    R5,R8,BDDRSV        RESTORE REGS                @XA16800 00436000
         B     PRTLINE7            GO CHK EDITTIME AND PNT     @XA16800 00437000
PRTNORLN EQU   *                                               @XA16800 00438000
         MVC   RPTDATE(N7),DTPATRN EDIT AND MOVE DATE                   00439000
         ED    RPTDATE(N7),LRTDATE+1(R1) TO REPORT AREA                 00440000
PRTLINE7 EQU   *                                               @XA16800 00441000
         MVC   EDITTIME(N4),LRTTIME(R1)     EDIT TIME          @XA16800 00442000
         OI    EDITIME3,X0F        ASSURE VALID DEC FIELD IND  @XA16800 00443000
         MVC   RPTTIME(N9),DTPATTN        EDIT AND MOVE TIME   @XA16800 00444000
         LA    R0,4                SET # BYTES TO CHECK        @XA16800 00445000
         LA    R1,EDITTIME         LOAD ADDR OF EDITTIME       @XA16800 00446000
         BAL   R14,CHKDEC          IS IT VALID PACK DEC FIELD  @XA16800 00447000
         LTR   R15,R15             TEST RETURN CODE            @XA16800 00448000
         BZ    PRTLINE8            YES--VALID PACK DEC FIELD   @XA16800 00449000
         MVI   PRT7,C'*'           NO---SET TIME ERROR FLAGS   @XA16800 00450000
         MVI   PRT8,C'*'           TIME ERROR FLAG             @XA16800 00451000
         B     PRTLINE9            GO PRINT IPL DETAIL LINE    @XA16800 00452000
PRTLINE8 EQU   *                                               @XA16800 00453000
         ED    RPTTIME(N9),EDITTIME                                     00454000
PRTLINE9 EQU   *                                               @XA16800 00455000
         BAL   R14,LOOKDESC        DESC,SUB-SYS,AND                     00456000
PRTLIN10 EQU   *                                               @XA16800 00457000
         BAL   R14,PRINT           GO PRINT IPL DETAIL LINE             00458000
         LH    R6,LINES            ADD                                  00459000
         LA    R6,N1(R6)           ONE                                  00460000
         STH   R6,LINES            LINE COUNT                           00461000
         CLC   LINES(N2),MAXLINCT  LINE COUNT EQ MAXIMUM                00462000
         BL    PROCCLUS            CONTINUE TO CLUSTER                  00463000
         NI    SW,XEF              PRINT HEADER NEXT TIME               00464000
         XC    LINES(N2),LINES     CLEAR LINE COUNT                     00465000
PROCCLUS L     R4,CLUSTIME         CHECK IF USER HAS REQ                00466000
         LTR   R4,R4               IPL CLUSTERING                       00467000
         BZ    RDEPH2              NO GO TO RDE PHASE 2                 00468000
         TM    SW,X04              CLUSTER TABLE FULL                   00469000
         BNZ   RDEPH2              YES-GO TO RDE PHASE 2 IF FULL..      00470000
         EJECT                                                          00471000
*********************************************************************** 00472000
*     THIS ROUTINE MAINTAINS AN IPL CLUSTER TABLE ONLY IF USER HAS    * 00473000
*      PROVIDED THE CLUSTER VALUE IN MINUTES IN THE CONTROL CARD.     * 00474000
*           THE CLUSTER TABLE IS PRINTED AT THE END OF THE IPL REPORT * 00475000
*********************************************************************** 00476000
*                                                                       00477000
         USING IPLTABLE,R5         IPL TABLE ADDRESSIBILITY             00478000
         USING SEQTABLE,R7         SEQ TABLE ADDRESSIBILITY             00479000
GENCLUS  DS    0H                                              @XA16800 00480000
         TM    SW1,X80              TEST FOR FULL REPORT       @XA16800 00481000
         BO    RDEPH2               NO DO PHASE 2 REPORT       @XA16800 00482000
         LA    R3,SEQTABE           END OF CLUSTER TABLE       @XA16800 00483000
         L     R4,SEQINDX          PTR TO NEXT CLUSTER ENTRY.           00484000
         CR    R3,R4               IS CLUSTER TABLE FULL                00485000
         BNE   ENTRY1              NO,CONTINUE.                         00486000
STOPCLUS OI    SW,X04              SET TABLE FULL                       00487000
         B     RDEPH2              GO TO PHASE 2 PROCESSING.            00488000
ENTRY1   L     R6,CLUSTIME         GET USER CLUSTER REQ IN R6           00489000
         L     R5,IPLINDX          GET ADDR OF IPL TABLE                00490000
         L     R7,SEQINDX          GET ADDR OF SEQ TABLE                00491000
         L     R4,IPLTIME          LOWEST IPL TIME IN 4                 00492000
         L     R3,LASTINCT         LAST INDICENT TIME IN 3              00493000
         SR    R3,R4               INTERVAL TIME IN R3                  00494000
         CR    R3,R6               IS INTERVAL GR THAN CLUSTER          00495000
         BH    ENTRY2              YES GO CHECK NEXT ENTRY              00496000
         L     R5,IPLHIDX          HI ELEMENT ADDR IN R5                00497000
         LA    R5,N8(R5)           INCREMENT TO NEXT ENTRY              00498000
         MVC   IPLTIME,LASTINCT    LAST INCIDENT TIME IN TABLE          00499000
         MVC   IPLSEQ,SEQNO        IPL SEQ NO IN TABLE                  00500000
         ST    R5,IPLHIDX          SAVE HI IPL INDEX PTR                00501000
         LA    R3,IPLTBEND         IS IPL TABLE                         00502000
         CR    R3,R5               FULL                                 00503000
         BE    STOPCLUS            YES STOP CLUSTERING                  00504000
         OI    SW,X40              CHECK CLUSTER DURING WRAPUP          00505000
         B     RDEPH2              GO TO RDE PHASE 2                    00506000
ENTRY2   LA    R5,N8(R5)           CHECK IF SECOND ENTRY IS 0           00507000
         L     R3,IPLTIME          GET IPL TIME                         00508000
         LTR   R3,R3               IS ENTRY = 0                         00509000
         BZ    FILLIPL             YES GO TO ENTER ENTRY IN TABLE       00510000
         TM    SW,X08              IS TABLE SHIFT REQUIRED              00511000
         BO    SHIFTTAB            YES-SHIFT IT                         00512000
         OI    SW,X08              SHIFT NEXT TIME                      00513000
         L     R5,IPLINDX          GET LOW SEQ NO IN IPL TABLE          00514000
         MVC   LOWSEQ,IPLSEQ2      MOVE TO SEQ TABLE LOW                00515000
         L     R5,IPLHIDX          GET HI SEQ NO IN IPL TABLE           00516000
         MVC   HISEQ,IPLSEQ2       MOVE TO SEQ TABLE HI                 00517000
         LA    R7,N4(R7)           INCREMENT TO NEXT ENTRY SEQ TAB      00518000
         ST    R7,SEQINDX          SAVE SEQ TABLE PTR                   00519000
SHIFTTAB L     R5,IPLINDX          LOAD BEGINING IPL TABLE ADDR         00520000
         L     R3,IPLHIDX          LOAD LAST ENTRY ADDR                 00521000
         SR    R3,R5               CALC THE LENGTH OF MOVE IN R3        00522000
         BCTR  R3,R0               DECREMENT FOR MVC INST               00523000
         EX    R3,SHIFTMVC         SHIFT TABLE DOWN ONE ENTRY           00524000
         L     R5,IPLHIDX          GET ADDR OF HI ELEMENT               00525000
         XC    0(8,R5),0(R5)       ZERO HI ENTRY/IPL TIME IN IPL TABLE  00526000
         S     R5,CONST8           BACK UP ONE ELEMENT                  00527000
         ST    R5,IPLHIDX          ADJUST HI INDEX PTR                  00528000
         B     GENCLUS             RETURN TO PROCESS NXT INTERVAL       00529000
FILLIPL  L     R5,IPLINDX          LOWEST IPL = LAST INCIDENT           00530000
         MVC   IPLTIME,LASTINCT    LOWEST SEQ = SEQ NUMBER              00531000
         MVC   IPLSEQ,SEQNO        GO TO                                00532000
         NI    SW,XBF              BYPASS CLUSTER DURING WRAPUP         00533000
         B     RDEPH2              PHASE 2 PROCESSING                   00534000
*                                                                       00535000
SHIFTMVC MVC   N0(N0,R5),N8(R5)    EX- SHIFT IPL TABLE DOWN             00536000
*                                                                       00537000
         EJECT                                                          00538000
*********************************************************************** 00539000
*  THIS ROUTINE CHECKS VARIABLE LENGTH PACKED DECIMAL FIELDS UP TO  4 * 00540000
*  BYTES TO ENSURE VALID PACKED DECIMAL DATA.                         * 00541000
*        R0 =  NUMBER OF BYTES TO BE CHECKED                          * 00542000
*        R1 =  ADDR OF DATA                                           * 00543000
*        R15= RETURN CODE                                             * 00544000
*********************************************************************** 00545000
CHKDEC   DS    0H                                              @XA16800 00546000
         STM   R4,R5,CHKDECSV      SAVE WORK REGS              @XA16800 00547000
         SR    R15,R15             CLEAR RETURN REG            @XA16800 00548000
         MVC   CHKDECWA(4),0(R1)   MOVE IN DATA                @XA16800 00549000
         L     R4,CHKDECWA         SET UP OTHER CHECK          @XA16800 00550000
         CH    R0,=H'4'            IS LEN 4 BYTES              @XA16800 00551000
         BE    NOSHIFT             NO SHIFTING REQUIRED        @XA16800 00552000
         CH    R0,=H'3'            IS LEN 3 BYTES              @XA16800 00553000
         BNE   SHIFT16             ASSUME 2 BYTE CHECK         @XA16800 00554000
         SRL   R4,8                GET RID OF LOW ORDER BYTE   @XA16800 00555000
         B     NOSHIFT             START CHECK                 @XA16800 00556000
SHIFT16  SRL   R4,16               GET RID OF LOW TWO BYTES    @XA16800 00557000
NOSHIFT  SLA   R0,1                MULTIPLY R0 BY 2            @XA16800 00558000
         BCTR  R0,0                DECR LOOP COUNTER BY ONE    @XA16800 00559000
         SR    R5,R5               CLEAR R5                    @XA16800 00560000
         SRDL  R4,4                SHIFT SIGN INTO R5          @XA16800 00561000
         SRL   R5,28               PLACE IN LOW ORDER POS.     @XA16800 00562000
         STC   R5,CHKBYT           STORE IN CHECK BYTE         @XA16800 00563000
         CLI   CHKBYT,X'0A'        LAST 4 BITS HIGHER THAN 9   @XA16800 00564000
         BL    NOTPKD              INVALID                     @XA16800 00565000
         SR    R5,R5               CLEAR R5                    @XA16800 00566000
CHKDEC1  DS    0H                                              @XA16800 00567000
         SRDL  R4,4                CHECK 4 BITS AT A TIME      @XA16800 00568000
         SRL   R5,28               PLACE IN LOW ORDER POS.     @XA16800 00569000
         STC   R5,CHKBYT           STORE IN CHECK BYTE         @XA16800 00570000
         CLI   CHKBYT,X'09'        SEE IF VALID                @XA16800 00571000
         BH    NOTPKD              NOT VALID                   @XA16800 00572000
         SR    R5,R5               CLEAR R5                    @XA16800 00573000
         BCT   R0,CHKDEC1          CHECK NEXT BITS             @XA16800 00574000
         B     NORMRET             NORMAL RETURN               @XA16800 00575000
NOTPKD   LA    R15,4               BAD RETURN CODE             @XA16800 00576000
NORMRET  LM    R4,R5,CHKDECSV      RESET REGISTERS FOR RETURN  @XA16800 00577000
         L     R1,SAVERDE          RESTORE RDE POINTER         @XA16800 00578000
         BR    R14                 RETURN TO CALLER            @XA16800 00579000
CHKDECSV DS    2F                  REGISTER SAVE AREA          @XA16800 00580000
CHKDECWA DC    F'0'                TEMP WORK AREA              @XA16800 00581000
CHKBYT   DC    X'00'               TEMP WORK AREA              @XA16800 00582000
         EJECT                                                 @XA16800 00583000
*********************************************************************** 00584000
*                                  END OF DAY RECORD                    00585000
*                                  *                                    00586000
*********************************************************************** 00587000
*                                                                       00588000
EOD      LR    R5,R9               LENGTH OF DAY =                      00589000
         S     R5,STRTIME          TIME MINUS START TIME                00590000
         A     R5,ELAPTIME         PLUS ELAPSED TIME                    00591000
         ST    R5,ELAPTIME         SAVE ELAPSED TIME                    00592000
         ST    R9,STRTIME          NO STARTING TIME BECOMES TIME        00593000
         NI    SW,XFD               CLEAR START TIME STORED    @XA16800 00594000
         B     READ                GO GET NEXT RECORD                   00595000
*                                                                       00596000
         EJECT                                                          00597000
**********************************************************************  00598000
*  END OF IPL REPORT PROCESSING:  PRODUCE FOOTINGS                   *  00599000
*                                 PRINT IPL CLUSTER TABLE            *  00600000
**********************************************************************  00601000
*                                                                       00602000
WRAPUP   OC    SEQNO(N4),SEQNO     ANY IPL RECORDS                      00603000
         BZ    NOIPLS              BRANCH--NO                           00604000
         L     R5,CURRTIME          CURRENT TIME               @XA16800 00605000
         S     R5,FRSTTIME          MINUS FIRST TIME           @XA16800 00606000
         BNH   WRAPUPB              TESTED FOR PLUS VALUE      @XA16800 00607000
         ST    R5,FRSTTIME          AND SAVED IF PLUS          @XA16800 00608000
         L     R5,CURRTIME         LAST RECORD TIME                     00609000
         S     R5,STRTIME          MINUS START TIME                     00610000
         BNM   WRAPUPA              TEST FOR NEG. TIME         @XA16800 00611000
WRAPUPB  OI    SW1,X80              SET SW1 BIT FOR ABBR RPT   @XA16800 00612000
         B     WRAPUPC                                         @XA16800 00613000
WRAPUPA  DS    0H                   ADD ELAPSED TIME           @XA16800 00614000
         A     R5,ELAPTIME         ADD ELAPSED TIME                     00615000
         ST    R5,ELAPTIME         NEW ELAPSED TIME                     00616000
         SPACE 1                                                        00617000
         MVI   PRT,SPACE2          DOUBLE SPACE                         00618000
         LH    R6,LINES            LINE COUNT                           00619000
         LA    R6,N5(R6)           ADD IN 5 FOR CLOSING                 00620000
         CH    R6,MAXLINCT         WILL IT FIT                          00621000
         BL    WRAPUP1             BRANCH--YES                          00622000
         MVI   PRT,SKIP            EJECT TO NEXT PAGE                   00623000
         SR    R6,R6               ZERO LINE COUNT                      00624000
WRAPUP1  STH   R6,LINES            SAVE LINE COUNT                      00625000
WRAPUPC  TM    SW1,X80              TEST FOR ABBR REPORT       @XA16800 00626000
         BZ    WRAPUP2A             O.K. FOR STD REPORT        @XA16800 00627000
         MVC   RPTFTLN3(N77),FOOTLIN3       ABBR REPORT MSG    @XA16800 00628000
         BAL   R14,PRINT            PRINT IT                   @XA16800 00629000
         TM    SW1,X10             TEST WNLNOTE SW             @XA16800 00630000
         BNO   WRAPUPD             BRANCH TO SKIP              @XA16800 00631000
         MVC   RPTFTLN3(N50),WNLNOTE1    MOVE IN MSG           @XA16800 00632000
         BAL   R14,PRINT           PRINT                       @XA16800 00633000
WRAPUPD  EQU   *                                               @XA16800 00634000
         MVI   PRT,SKIP             EJECT TO NEXT PAGE         @XA16800 00635000
         B     WRAPUPED             PHASE 1 DONE               @XA16800 00636000
WRAPUP2A DS    0H                                              @XA16800 00637000
         SPACE 1                                                        00638000
* CHECK FOR CLUSTER TABLE PROCESSING                                    00639000
         TM    SW,X40              CHECK CLUSTER                        00640000
         BZ    WRAPUP2             NO-BYPASS                            00641000
         L     R7,SEQINDX          SEQ TABLE POINTER                    00642000
         L     R5,IPLINDX          IPL LOW POINTER                      00643000
         MVC   LOWSEQ(N2),IPLSEQ2  LOW CLUSTER TO SEQ TABLE             00644000
         L     R5,IPLHIDX          IPL HIGH POINTER                     00645000
         MVC   HISEQ(N2),IPLSEQ2   HI CLUSTER TO SEQ TABLE              00646000
         LA    R7,N4(R7)           UPDATE SEQ POINTER                   00647000
         ST    R7,SEQINDX          SAVE IT                              00648000
         SPACE 1                                                        00649000
WRAPUP2  MVC   RPTFTNOT(N56),FOOTLIN1 PRODUCE NOTE                      00650000
         BAL   R14,PRINT           GO PRINT LINE                        00651000
*********************************************************************** 00652000
*  ROUTINE TO PRINT IPL CLUSTER REPORT                                * 00653000
*********************************************************************** 00654000
         CLC   CCCLUST(N2),BLANKS  TEST FOR CLUSTER REQUEST             00655000
         BE    NOCLUST             BRANCH--NOT REQUESTED                00656000
         MVC   FOOTIPL(N2),CCCLUST PRINT CLUSTER SPAN                   00657000
         MVI   PRT,SPACE2          DOUBLE SPACE                         00658000
         LA    R7,SEQTAB           SEQ TABLE BASE                       00659000
         LA    R4,N1               START GROUP CT AT ONE                00660000
         L     R5,SEQINDX          LAST ENTRY IN SEQ TABLE              00661000
         OC    HISEQ(N2),HISEQ     ANY IPL CLUSTERING                   00662000
         BZ    NOCLUST             BRANCH--NONE PRESENT                 00663000
CLUST1   MVC   RPTFTLN3(N49),FOOTLIN4 CLUSTER PRINT HEADING             00664000
         BAL   R14,PRINT           PRINT LINE                           00665000
         MVI   PRT,SPACE2          DOUBLE SPACE                         00666000
CLUST2   CVD   R4,BWORK            COUNT TO DECIMAL                     00667000
         OI    BWORK7,X0F          ZONE                                 00668000
         UNPK  FOOTGRUP(N2),BWORK6(N2) REPORT AREA                      00669000
         LH    R3,LOWSEQ           LOW SEQ #                            00670000
         CVD   R3,BWORK            CONVERT IT TO DECIMAL                00671000
         OI    BWORK7,X0F          ZONE                                 00672000
         UNPK  LOWCLUST(N2),BWORK6(2) REPORT AREA                       00673000
         LH    R3,HISEQ            HIGH SEQ #                           00674000
         CVD   R3,BWORK            CONVERT TO DECIMAL                   00675000
         OI    BWORK7,X0F          ZONE                                 00676000
         UNPK  HICLUST(N2),BWORK6(N2) REPORT AREA                       00677000
         MVC   RPTGROUP(N16),FOOTLIN5 REPORT TO PRINT                   00678000
         BAL   R14,PRINT           PRINT LINE                           00679000
         LA    R7,N4(R7)           UPDATE SEQ                           00680000
         LA    R4,N1(R4)           NEXT GROUP                           00681000
         CR    R7,R5               IS THIS THE LAST ENTRY               00682000
         BE    NOCLUST             BRANCH--ALL DONE                     00683000
         LH    R6,LINES            LINE CT                              00684000
         LA    R6,N1(R6)           ADD ONE                              00685000
         STH   R6,LINES            SAVE LINE CT                         00686000
         CH    R6,MAXLINCT         WILL IT FIT                          00687000
         BL    CLUST2              BRANCH--YES                          00688000
         XC    LINES(N2),LINES     ZERO COUNT                           00689000
         MVI   PRT,SKIP            NEXT PAGE                            00690000
         B     CLUST1              REDO HEADING                         00691000
*********************************************************************** 00692000
*   LOST TIME SUMMARY REPORT                                          * 00693000
*********************************************************************** 00694000
NOCLUST  LH    R6,LINES            LINE CT                              00695000
         LA    R6,N25(R6)          ADD 25 LINES                         00696000
         STH   R6,LINES            SAVE LINE CT                         00697000
         CH    R6,MAXLINCT         WILL IT FIT                          00698000
         BL    WRAPUP3             BRANCH--YES                          00699000
         XC    LINES(N2),LINES     ZERO LINE CT                         00700000
         MVI   PRT,SKIP            EJECT                                00701000
WRAPUP3  TM    SW1,X01             TEST TO BYPASS LOST SUMMARY @XA16800 00702000
         BZ    WRAPUP3A            NO  DO IT                   @XA16800 00703000
         MVI   PRT,SKIP            YES BUT SKIP TO NEW PAGE    @XA16800 00704000
         B     WRAPUPED            PHASE 1 PORTION COMPLETE    @XA16800 00705000
WRAPUP3A MVC   RPTLTSUM(N17),SUMHEAD  LOST TIME SUMMARY HEADING@XA16800 00706000
         MVI   PRT,SPACE3          TRIPLE SPACE                         00707000
         BAL   R14,PRINT           PRINT IT                             00708000
         MVC   RPTLTSM1(N60),SUMHEAD1 MORE HEADING                      00709000
         MVI   PRT,SPACE2          DOUBLE SPACE                         00710000
         BAL   R14,PRINT           PRINT IT                             00711000
         MVC   RPTLTSM2(N54),SUMHEAD2 LAST HEADING                      00712000
         BAL   R14,PRINT           PRINT IT                             00713000
         MVI   PRT,SPACE2          DOUBLE SPACE                         00714000
         LA    R8,IPLLOST          LOST TIME LABELS                     00715000
WRAPUP4  LA    R1,RPTLTHR1         REPORT POSITION HOURS                00716000
         LA    R7,RPTLTCT1         REPORT POSITION CT                   00717000
         SR    R4,R4               CLEAR                                00718000
         SR    R5,R5               REGS                                 00719000
         IC    R4,N0(R8)           SUMMARY OFFSET                       00720000
         IC    R5,N1(R8)           LABEL LENGTH                         00721000
         EX    R5,MOVLSTLB         LABEL TO REPORT                      00722000
         LA    R8,N3(R8,R5)        UPDATE LABEL PTR                     00723000
         SR    R5,R5               CLEAR                                00724000
         SR    R6,R6               REGS                                 00725000
WRAPUP5  L     R2,LOSTSUM(R4)      ENTRY                                00726000
         LTR   R2,R2               ZERO                                 00727000
         BZ    WRAPUP6             BRANCH--YES BYPASS                   00728000
         L     R2,LOSTTIME(R4)     LOST TIME                            00729000
         AR    R5,R2               SAVE FRO TOTAL                       00730000
         BAL   R14,PRINTIME        PLACE TIME IN REPORT                 00731000
         MVC   N7(N3,R1),BLANKS    BLANK OUT SECONDS                    00732000
         L     R2,LOSTSUM(R4)      LOST COUNT                           00733000
         AR    R6,R2               SAVE FOR TOTAL                       00734000
         CVD   R2,BWORK            CONVERT TO DECIMAL                   00735000
         OI    BWORK7,X0F          ZONE                                 00736000
         MVC   N0(N4,R7),EDITSEQ   PATTERN                              00737000
         ED    N0(N4,R7),BWORK6    PLACE CT IN REPORT                   00738000
WRAPUP6  LA    R4,N32(R4)          NEXT ENTRY                           00739000
         LA    R1,N20(R1)          REPORT POINTER                       00740000
         LA    R7,N20(R7)          REPORT POINTER                       00741000
         LA    R2,N64              LAST ENTRY IN TABLE                  00742000
         CR    R4,R2               ARE WE THERE                         00743000
         BL    WRAPUP5             BRANCH--NO CONTINUE                  00744000
         LA    R2,N31(R2)          UPDATE AGAIN                         00745000
         CR    R4,R2               ABOVE THE END                        00746000
         BH    WRAPUP7             BRANCH--YES                          00747000
         ST    R5,LOSTTIME(R4)     STORE TIME FOR TOTAL                 00748000
         ST    R6,LOSTSUM(R4)      STORE COUNT FOR TOTAL                00749000
         B     WRAPUP5             DO TOTAL                             00750000
WRAPUP7  BAL   R14,PRINT           PRINT LINE COMPLETED                 00751000
         CLI   N0(R8),XFF          SUMMARY FINISHED                     00752000
         BNE   WRAPUP4             BRANCH--NO                           00753000
         MVC   RPTLTSM1(N5),TOTALLAB LABEL TO REPORT                    00754000
         MVI   PRT,SPACE2          DOUBLE SPACE                         00755000
         LA    R1,RPTLTHR1         REPORT AREA                          00756000
         LA    R8,RPTLTCT1         REPORT AREA                          00757000
         SR    R4,R4               CLEAR                                00758000
WRAPUP10 LA    R7,N4               SET INDEX TO FOUR                    00759000
         SR    R2,R2               CLEAR                                00760000
         SR    R3,R3               REGS                                 00761000
WRAPUP11 L     R5,LOSTTIME(R4)     LOST TIME                            00762000
         AR    R2,R5               TOTAL IT                             00763000
         L     R5,LOSTSUM(R4)      LOST CT                              00764000
         AR    R3,R5               TOTAL IT                             00765000
         LA    R4,N8(R4)           NEXT                                 00766000
         BCT   R7,WRAPUP11         ENTRY                                00767000
         ST    R2,LOSTTOT          STORE LOST TOTAL                     00768000
         CVD   R3,BWORK            CONVERT CT TO DECIMAL                00769000
         OI    BWORK7,X0F          ZONE                                 00770000
         MVC   N0(N4,R8),EDITSEQ   PATTERN                              00771000
         ED    N0(N4,R8),BWORK6    PLACE CT IN REPORT                   00772000
         BAL   R14,PRINTIME        PLACE TIME IN REPORT                 00773000
         MVC   N7(N3,R1),BLANKS    BLANK OUT SECONDS                    00774000
         LA    R1,N20(R1)          REPORT POINTER                       00775000
         LA    R8,N20(R8)          REPORT POINTER                       00776000
         LA    R2,N64              HIGH SUMMARY ENTRY                   00777000
         CR    R4,R2               FINISHED                             00778000
         BNH   WRAPUP10            BRANCH--NO CONTINUE                  00779000
         BAL   R14,PRINT           PRINT LINE WHEN DONE                 00780000
         MVI   PRT,SPACE2          DOUBLE SPACE                         00781000
         MVC   FOOTDATE(N7),DTPATRN DATE PATTERN                        00782000
         ED    FOOTDATE(N7),SAVEDAT1 PLACE IN REPORT                    00783000
         MVC   RPTFTLN1(N29),FOOTLIN2 PLACE IN REPORT                   00784000
         BAL   R14,PRINT           PRINT IT                             00785000
         MVI   PRT,SPACE2          DOUBLE SPACE                         00786000
         MVC   RPTLTFT1(N12),TOTALLAB TOTAL TIME                        00787000
         LA    R1,RPTLTFT2         REPORT AREA                          00788000
         L     R2,FRSTTIME          LOAD R2 FOR PRINT          @XA16800 00789000
         BAL   R14,PRINTIME        EQUALS TOTAL TIME                    00790000
         MVC   N7(N3,R1),BLANKS    BLANK OUT SECONDS                    00791000
         BAL   R14,PRINT           PRINT IT                             00792000
         MVC   RPTLTFT1(N14),PROCTM PROCESS TIME                        00793000
         LA    R1,RPTLTFT2         REPORT AREA                          00794000
         L     R2,ELAPTIME         PROCESS TIME                         00795000
         CLC   ELAPTIME(N4),FRSTTIME ELAPSED TIME TO TOTAL TIME         00796000
         BL    WRAPUP12            BRANCH -ELAPSED LOW                  00797000
         S     R2,LOSTTOT          SUBTRACT LOST TIME                   00798000
         ST    R2,ELAPTIME         NEW PROCESS TIME                     00799000
WRAPUP12 BAL   R14,PRINTIME        PRINT IT                             00800000
         MVC   N7(N3,R1),BLANKS    BLANK OUT SECONDS                    00801000
         BAL   R14,PRINT           PRINT IT                             00802000
         SR    R4,R4               CLEAR                                00803000
         L     R5,ELAPTIME         PROCESS TIME                         00804000
         LTR   R5,R5                TEST FOR NEG ELAPTIME      @XA16800 00805000
         BP    WRAPUP13             POSITIVE                   @XA16800 00806000
         L     R4,ALLONES           NEGATIVE                   @XA16800 00807000
WRAPUP13 DS    0H                                              @XA16800 00808000
         D     R4,SEQNO            SECONDS/IPL                          00809000
         MVC   RPTLTFT1(N22),AVRUNTIM AVERAGE RUN TIME                  00810000
         LA    R1,RPTLTFT2         REPORT AREA                          00811000
         LR    R2,R5               TIME                                 00812000
         LTR   R5,R5                TEST AVG RUNTIME FOR NEG.  @XA16800 00813000
         BM    WRAPUP14             YES IT IS NEG              @XA16800 00814000
         BAL   R14,PRINTIME        PLACE TIME IN REPORT                 00815000
         MVC   N7(N3,R1),BLANKS    BLANK OUT SECONDS                    00816000
         BAL   R14,PRINT           PRINT IT                             00817000
         B     WRAPUP15                                        @XA16800 00818000
WRAPUP14 LCR   R2,R5                LOAD COMPL OF RUN TIME     @XA16800 00819000
         BAL   R14,PRINTIME         PRINT NEG RUN TIME AMT     @XA16800 00820000
         MVC   N7(N3,R1),NEGIND     INDICATE NEG RUN TIME      @XA16800 00821000
         BAL   R14,PRINT            PRINT IT                   @XA16800 00822000
WRAPUP15 DS    0H                                              @XA16800 00823000
         MVC   RPTLTFT1(N22),PRODAV PRODUCT AVAIL.                      00824000
         L     R3,ELAPTIME         PROCESS TIME                         00825000
         M     R2,ONEHUND          MULT BY 100                          00826000
         D     R2,FRSTTIME         TOTAL TIME                           00827000
         CVD   R3,BWORK            CONVERT PERCENT TO DECIMAL           00828000
         OI    BWORK7,X0F          ZONE                                 00829000
         MVC   RPTLTFT3(N4),MNPATRN PATTERN                             00830000
         ED    RPTLTFT3(N4),BWORK6 PLACE IN REPORT                      00831000
         BAL   R14,PRINT           PRINT IT                             00832000
         MVC   RPTLTFT1(N19),AVLOSTTM AVERAGE LOST TIME                 00833000
         LA    R1,RPTLTFT2         REPORT AREA                          00834000
         L     R3,LOSTTOT          TOTAL LOST TIME                      00835000
         SR    R2,R2               CLEAR                                00836000
         D     R2,SEQNO            NUMBER OF IPLS                       00837000
         LR    R2,R3               LOST TIME / IPL                      00838000
         BAL   R14,PRINTIME        PLACE IT IN REPORT                   00839000
         MVC   N7(N3,R1),BLANKS    BLANK OUT SECONDS                    00840000
         BAL   R14,PRINT           PRINT IT                             00841000
         MVC   RPTFTLN2(N66),WARNLINE WARNING USE EOD                   00842000
         MVI   PRT,SPACE2          DOUBLE SPACE                         00843000
         BAL   R14,PRINT           PRINT IT                             00844000
*WRAPUPED: ;                                               /*@Z427VLS*/ 00845000
WRAPUPED DS    0H                                                  0073 00846000
*GENERATE;                                                 /*@Z427VLS*/ 00847000
*                                                                       00848000
         MVI   PRINTER,C'0'        INDICATE EREPPT DATA SET OUTPUT      00849000
         XC    LINES(N2),LINES     ZERO OUT LINE COUNT         @XA21049 00850000
         B     PHS2PRT             GO PRINT PHASE 2 REPORT              00851000
*                                                                       00852000
*                                                                       00853000
MOVLSTLB MVC   RPTLTSM1(N0),N2(R8) EX-MOVE LOST TIME LABEL              00854000
*                                                                       00855000
         EJECT                                                          00856000
*********************************************************************** 00857000
*          THE PRINT ROUTINE PRINTS A LINE CLEARS PRINT AREA          * 00858000
*              AND RETURNS TO THE REQUESTOR                           * 00859000
*        EXIT    R14  RETURN ADDRESS                                  * 00860000
*********************************************************************** 00861000
*                                                                       00862000
PRINT    ST    R14,SAVERET         SAVE RETURN POINTER                  00863000
         CLI   PRT,SKIP            EJECT TO NEW PAGE                    00864000
         BNE   NOEJECT                                                  00865000
*        PRINTADR = ADDR(ELINE);                           /*@Z427VLS*/ 00866000
         L     @15,SAVER2                                          0074 00867000
         LA    @14,ELINE                                           0074 00868000
         ST    @14,PRINTADR(,@15)                                  0074 00869000
*        R2 = SAVER2;                                      /*@Z427VLS*/ 00870000
         LR    R2,@15                                              0075 00871000
*        CALL  IOHND(RITEPRTR);                            /*@Z427VLS*/ 00872000
         L     @15,ADIOHND(,@15)                                   0076 00873000
         LA    @01,@AL00076                                        0076 00874000
         BALR  @14,@15                                             0076 00875000
*GENERATE;                                                 /*@Z427VLS*/ 00876000
         BAL   R14,SPCNCNT         SPACE AND COUNT 1 LINE      @XA21049 00877000
NOEJECT  CLI   PRT,SPACE2          SPACE TWO LINES                      00878000
         BNE   NOSP2               NO, BYPASS                           00879000
*        PRINTADR = ADDR(LINETWO);                         /*@Z427VLS*/ 00880000
         L     @15,SAVER2                                          0078 00881000
         LA    @14,LINETWO                                         0078 00882000
         ST    @14,PRINTADR(,@15)                                  0078 00883000
*        R2 = SAVER2;                                      /*@Z427VLS*/ 00884000
         LR    R2,@15                                              0079 00885000
*        CALL IOHND(RITEPRTR);                             /*@Z427VLS*/ 00886000
         L     @15,ADIOHND(,@15)                                   0080 00887000
         LA    @01,@AL00080                                        0080 00888000
         BALR  @14,@15                                             0080 00889000
*GENERATE;                                                 /*@Z427VLS*/ 00890000
         BAL   R14,SPCNCNT         SPACE AND COUNT 1 LINE      @XA21049 00891000
NOSP2    CLI   PRT,SPACE3          SPACE THREE LINES                    00892000
         BNE   NOSP3               NO, BYPASS                           00893000
*        PRINTADR = ADDR(LINETHR);                         /*@Z427VLS*/ 00894000
         L     @15,SAVER2                                          0082 00895000
         LA    @14,LINETHR                                         0082 00896000
         ST    @14,PRINTADR(,@15)                                  0082 00897000
*        R2 = SAVER2;                                      /*@Z427VLS*/ 00898000
         LR    R2,@15                                              0083 00899000
*        CALL IOHND(RITEPRTR);                             /*@Z427VLS*/ 00900000
         L     @15,ADIOHND(,@15)                                   0084 00901000
         LA    @01,@AL00084                                        0084 00902000
         BALR  @14,@15                                             0084 00903000
*GENERATE;                                                 /*@Z427VLS*/ 00904000
         BAL   R14,SPCNCNT         SPACE AND COUNT 1 LINE      @XA21049 00905000
NOSP3    EQU  *                                                         00906000
*        PRINTADR = ADDR(PRINTER);                         /*@Z427VLS*/ 00907000
         L     @15,SAVER2                                          0086 00908000
         LA    @14,PRINTER                                         0086 00909000
         ST    @14,PRINTADR(,@15)                                  0086 00910000
*        R2 = SAVER2;                                      /*@Z427VLS*/ 00911000
         LR    R2,@15                                              0087 00912000
*        CALL  IOHND(RITEPRTR);    /* WRITE A LINE           @Z427VLS*/ 00913000
         L     @15,ADIOHND(,@15)                                   0088 00914000
         LA    @01,@AL00088                                        0088 00915000
         BALR  @14,@15                                             0088 00916000
*GENERATE REFS(LOGCODE,PRINTADR,IPLREAS,IPLSYSID,IPLTEMP,IPLSTIME, 0089 00917000
*              IPLSDATE);                                 /* @XA16800*/ 00918000
         MVI   PRT,X'09'           SKIP TO NEXT LINE                    00919000
         MVI   PRT+1,X40           BLANK                                00920000
         MVC   CTLCRLIN+1(N119),PRT+1  PRINT BUFFER                     00921000
         L     R14,SAVERET         RETURN POINTER                       00922000
         BR    R14                 RETURN                               00923000
         EJECT                                                          00924000
*                                                                       00925000
*********************************************************************** 00926000
*     THIS ROUTINE PRODUCES THE IPL REASON DESCRIPTION FOR THE IPL    * 00927000
*     REPORT.                                                         * 00928000
*                EXIT :    REPORT AREA WILL CONTAIN IPL REASON        * 00929000
*                          DESCRIPTION ASSOCIATED WITH THE IPL REASON * 00930000
*                          CODE FROM THE IPL RECORD OR  UN-UNKNOWN.   * 00931000
*********************************************************************** 00932000
*                                                                       00933000
LOOKDESC SR    R5,R5               REG 5  WORK REG                      00934000
         LA    R4,IPLDESC          ADDR OF IPL DESC TABLE IN R4         00935000
         MVC   RPTREA(N10),REAUN1  ASSUME AN UNKNOWN IPL DESC           00936000
         MVI   IPLTEMP(R1),X08     LOST TIME IND. - UNKNOWN             00937000
TABLITEM IC    R5,0(R4)            GET LENGTH OF DESC IN R5             00938000
         CLC   N2(N2,R4),IPLREAS(R1)   COMPARE TABLE ITEM TO RECORD     00939000
         BE    FOUNDREA            EQ COND ITEM FOUND                   00940000
         CLI   N0(R4),XFF          END OF TABLE                         00941000
         BE    LOOKSUB             YES GO PRODUCE UNKNOWN VALUE         00942000
         LA    R4,N3(R4,R5)        INCREMENT TO NEXT ENTRY              00943000
         B     TABLITEM            GO CHECK NEXT ITEM IN THE TABLE      00944000
FOUNDREA EX    R5,MOVEDESC         MOVE DESC OR UNKNOWN TO RPT          00945000
         MVC   IPLTEMP(N1,R1),N1(R4) SAVE LOST TIME INDICATOR           00946000
         SPACE 3                                                        00947000
*********************************************************************** 00948000
*     THIS ROUTINE PRODUCES THE SUB-SYSTEM DESCRIPTION FOR IPL REPORT   00949000
*     EXIT :   REPORT AREA WILL CONTAIN THE SUB-SYSTEM DESC. ASSOCIATED 00950000
*              WITH THE SUB-SYSTEM CODE IN IPL RECORD OR UNKNOWN.       00951000
*********************************************************************** 00952000
*                                                                       00953000
LOOKSUB  SR    R5,R5               SUB-SYSTEM DESC LENGTH               00954000
         LA    R4,SUBTABLE         GET START ADDR OF TABLE              00955000
         MVC   RPTSUB(N7),IPLNUL   ASSUME 00-NULL                       00956000
SUBITEM  IC    R5,N1(R4)           GET LENGTH                           00957000
         CLC   N0(N1,R4),IPLSYSID(R1)  COMP SUB-SYS TABLE CODE TO RCD   00958000
         BE    FOUNDSUB            EQ COND GO PRODUCE DESC              00959000
         CLI   0(R4),X'FF'         IS IT END OF TABLE                   00960000
         BE    LOOKLOST            YES PRODUCE UNKNOWN DESC             00961000
         LA    R4,N3(R4,R5)        INCREMENT TO NEXT ENTRY              00962000
         B     SUBITEM             CHECK NEXT CODE IN TABLE             00963000
FOUNDSUB EX    R5,MOVESUB          MOVE SUB-SYS DESC TO RPT AREA        00964000
         EJECT                                                          00965000
*********************************************************************** 00966000
*    THIS ROUTINE PRODUCES THE LOST TIME REPORT FOR THE IPL REPORT    * 00967000
*         EXIT: REPORT AREA WILL CONTAIN THE LOST TIME AND ITS        * 00968000
*               CATEGORY -MAINT.,IBM RESP.,OTHER,OR IDLE.             * 00969000
*********************************************************************** 00970000
*                                                                       00971000
LOOKLOST TM    LOGCODE(R1),X80     LOST TIME DATA IN RECORD-DATE        00972000
         BO    LOOKLST1            MVS RECORD WITH TIME STAMP  @XA19764 00973000
         OI    SW1,X01             SET SW FOR NON-MVS RECORD   @XA16800 00974000
         B     NOTAVAIL            PRINTS NOT AVAILABLE FOR NON-MVS     00975000
LOOKLST1 EQU   *                                               @XA16800 00976000
         SR    R5,R5               CLEAR R5                             00977000
         LA    R4,IPLLOST          LOST TIME CATEGORY TABLE             00978000
CATITEM  IC    R5,N1(R4)           GET LENGTH                           00979000
         CLC   N0(N1,R4),IPLTEMP(R1) COMPARE FOR CATEGORY IND.          00980000
         BE    FOUNDCAT            BRACNH-FOUND                         00981000
         CLI   N0(R4),XFF          END OF TABLE                         00982000
         BE    NOTAVAIL            NOT AVAILABLE                        00983000
         LA    R4,N3(R4,R5)        INCREMENT TO NEXT ENTRY              00984000
         B     CATITEM             TRY AGAIN                            00985000
FOUNDCAT EX    R5,MOVECAT          MOVE CATEGORY TO REPORT              00986000
         IC    R5,N0(R4)           SAVE OFFSET                          00987000
         CLC  FULLZERO(N4),IPLSDATE(R1)    IS DATE ZERO        @XA16800 00988000
         BE    MVSNODTE            ZERO - NOT AVAILABLE        @XA16800 00989000
         ST    R14,SAVER14         SAVE RETURN ADDRESS                  00990000
         LA    R2,IPLSDATE(R1)  GO EDIT AND CONVERT THE LOST   @XA16800 00991000
         LA    R0,4                SET # BYTES TO CHK IN PACK  @XA16800 00992000
         LA    R1,IPLSDATE(R1)     SET ADDR OF PACK DEC FIELD  @XA16800 00993000
         BAL   R14,CHKDEC          GO CHK FOR VALID PCK DEC FLD@XA16800 00994000
         LTR   R15,R15             IS THIS A VALID PCK DEC FLD @XA16800 00995000
         BZ    OKIPLDT             YES--OK IPL DATE            @XA16800 00996000
         B     IPLNOTE1            TIME STAMP HAS INVALID DATA @XA16800 00997000
OKIPLDT  EQU   *                                               @XA16800 00998000
         BAL   R14,CONVDATE        TIME DATE TO SECONDS                 00999000
         LA    R2,IPLSTIME(R1)     GO EDIT AND CONVERT THE LOST         01000000
         BAL   R14,CONVTIM1        TIME TIME TO SECONDS                 01001000
         LTR   R9,R9                                           @XA16800 01002000
         BZ    IPLNOTE1            TIME STAMP RESULTS IN ZERO VALUE     01003000
         CLI   IPLSYSID(R1),X8F    HARDWARE/SOFTWARE                    01004000
         BNH   LSTTIME             HARDWARE                             01005000
         LA    R5,N32(R5)          SOFTWARE OFFSET                      01006000
LSTTIME  L     R2,CURRTIME         CURRENT TIME                         01007000
         CR    R2,R9               COMPARE TIMES                        01008000
         BH    OKTIME              OUTAGE OK                            01009000
         B     IPLNOTE1            TIME STAMP CAUSES NEGATIVE LOST TIME 01010000
OKTIME   SR    R2,R9               LOST TIME                            01011000
         L     R9,LOSTTIME(R5)     LOST TIME SUMMARY                    01012000
USEZERO  AR    R9,R2               ADD IN THIS RECORD                   01013000
         ST    R9,LOSTTIME(R5)     SAVE IT                              01014000
         L     R9,LOSTSUM(R5)      LOST TIME COUNT                      01015000
         LA    R9,N1(R9)           ADD ONE                              01016000
         ST    R9,LOSTSUM(R5)      SAVE IT                              01017000
         LA    R1,RPTLOST          PRINT POSITION                       01018000
         BAL   R14,PRINTIME        SET TIME FOR PRINT                   01019000
         L     R14,SAVER14         RESTORE RETURN ADDRESS               01020000
         BR    R14                 RETURN TO CALLER                     01021000
         SPACE 1                                                        01022000
IPLNOTE1 MVC   RPTLOST(N10),WNLNOTE    SET WARNING FOR PRINT   @XA16800 01023000
         OI    SW1,X90             SET ABBR RPT AND WNLNOTE SW @XA16800 01024000
         MVI   PRT7,C'*'           SET ERROR                   @XA16800 01025000
         MVI   PRT8,C'*'           INDICATOR                   @XA16800 01026000
         L     R14,SAVER14         RESTORE RETURN ADDRESS      @XA16800 01027000
         BR    R14                 RETURN                      @XA16800 01028000
MVSNODTE MVI   PRT7,C'*'           SET ERROR                   @XA16800 01029000
         MVI   PRT8,C'*'           INDICATOR                   @XA16800 01030000
         OI    SW1,X80             SET ABBR RPT INDICATOR      @XA16800 01031000
NOTAVAIL MVC   RPTLOST(N13),NOAVA                                       01032000
         BR    R14                 RETURN                               01033000
*                                                                       01034000
MOVECAT  MVC   RPTCAT(N0),N2(R4)   EX-MOVE CATEGORY                     01035000
*                                                                       01036000
MOVEDESC MVC   RPTREA(N0),N2(R4)   EX-MOVE IPL REASON CODE              01037000
*                                                                       01038000
MOVESUB  MVC   RPTSUB(N0),N2(R4)   EX-MOVE SUB-SYSTEM TO REPORT         01039000
         EJECT                                                          01040000
*********************************************************************** 01041000
*    THIS ROUTINE CONVERTS A JULIAN DATE TO SECONDS SINCE 1960        * 01042000
*                                                                     * 01043000
*        AT ENTRY :  R2 MUST CONTAIN THE ADDRESS OF THE DATE          * 01044000
*                    FIELD TO BE CONVERTED.                           * 01045000
*        EXIT :      R9  CONTAINS ANSR IN SECONDS SINCE 1960.         * 01046000
*                    R15 CONDITION CODE  0 = GOOD, 4 = ERROR          * 01047000
*********************************************************************** 01048000
PACKHEX  XR    R9,R9               CLEAR                                01049000
         LA    R15,N4              SET DATE IS BAD.                     01050000
PACKHEX1 CLI   N0(R2),XEF          VERFIY THAT                          01051000
         BCR   13,R14              NOT-HIGH, THE DATE FIELD             01052000
         CLI   N0(R2),XF9          BEING PASSED                         01053000
         BCR   2,R14               HIGH-IS NUMBERIC                     01054000
         C     R9,CONST4           ALL DONE                             01055000
         BE    PACKIT              YES                                  01056000
         LA    R9,N1(R9)           ADD ONE                              01057000
         LA    R2,N1(R2)           NEXT CHARACTER                       01058000
         B     PACKHEX1            DO IT                                01059000
PACKIT   SR    R2,R9               SET ADDRESS BACK                     01060000
         PACK  JULIAN(N4),N0(N5,R2) PACK INTO WORK AREA                 01061000
         B     CONVPACK            CONTINUE                             01062000
CONVDATE SR    R9,R9               CLEAR                                01063000
         MVC   JULIAN(N4),N0(R2)   MOVE PACKED DATE TO WORK.            01064000
CONVPACK IC    R9,JULIAN1          MOVE YEARS TO REGISTER,              01065000
         SLA   R9,N4               SHIFT LEFT AND                       01066000
         STC   R9,PACKYR1          STORE UNITS OF YEAR,                 01067000
         SRA   R9,N8               SHIFT RIGHT AND                      01068000
         STC   R9,PACKYR           STORE TENS OF YEAR,                  01069000
         OI    PACKYR1,X0F         THEN SET SIGN.                       01070000
         NI    JULIAN1,X00         ZERO OUT YEAR.                       01071000
         XC    BWORK(N4),BWORK     CLEAR HIGH ORDER                     01072000
         CVB   R2,BWORK            CONVERT DAYS ONLY TO BINARY          01073000
         MVC   JULIAN2(N2),PACKYR  MOVE YEAR.                           01074000
         CVB   R9,BWORK            CONVERT YEAR TO BINARY.              01075000
         S     R9,SIXTY            SUBTRACT 60 YEARS.                   01076000
         LTR   R9,R9                                                    01077000
         BCR   4,R14               MINUS-BR IF DATE PRIOR TO 1960.      01078000
         BZ    ALLDAYS             BR IF 1960.                          01079000
         XR    R8,R8                                                    01080000
         M     R8,DAYSYR           MULTIPLY YEARS BY 365.               01081000
         AR    R2,R9               AND ADD TO DAYS.                     01082000
         CVB   R9,BWORK            CONVERT YEAR TO BINARY.              01083000
         S     R9,SIXTY            SUBTRACT 60 YEARS.                   01084000
         D     R8,CONST4           DIVIDE BY FOUR                       01085000
         AR    R2,R9               AND ADD TO DAYS.                     01086000
ALLDAYS  LR    R9,R2               MOVE TOTAL DAYS TO REG. 9.           01087000
         XR    R8,R8               MULTIPLY DAYS BY SECONDS             01088000
         M     R8,TWENFOUR         PER/DAY - RESULT IN R9               01089000
         XR    R15,R15             SET DATE IS O.K.                     01090000
         BR    R14                 AND RETURN TO CALLER.                01091000
         EJECT                                                          01092000
**********************************************************************  01093000
*   THIS ROUTINE CONVERTS THE TIME FIELD IN THE RDE RECORD TO SEC.   *  01094000
**********************************************************************  01095000
*                                                                       01096000
CONVTIME LA    R2,LRTTIME(R1)      STANDARD TIME FIELD                  01097000
CONVTIM1 MVC   WORKTIME(N4),N0(R2) MOVE INTO WORK AREA                  01098000
         TR    WORKTIME(N4),HEXTOBIN CONVERT HEX TO BINARY              01099000
         SR    R2,R2               CLEAR R2                             01100000
         SR    R3,R3               CLEAR R3                             01101000
         IC    R3,LOGHRS           INSERT HRS IN R3                     01102000
         M     R2,THRTYSIX         CONVERT HRS TO SEC                   01103000
         AR    R9,R3               ADD TO TOTAL TIME                    01104000
         SR    R3,R3                                                    01105000
         IC    R3,LOGMIN           MULTIPLIER  IN R3                    01106000
         M     R2,SIXTY            CONVERT MIN TO SEC                   01107000
         AR    R9,R3               ADD SEC TO TOTAL TIME                01108000
         SR    R3,R3               CLEAR R3                             01109000
         IC    R3,LOGSEC           GET SEC                              01110000
         AR    R9,R3               ADD SEC TO TOTAL TIME                01111000
         BR    R14                 RETURN                               01112000
*                                                                       01113000
         EJECT                                                          01114000
*********************************************************************** 01115000
*        THIS ROUTINE PRODUCES PRINTABLE TIME IN THE FORM HH.MM.SS    * 01116000
*        FROM SECONDS.                                                * 01117000
*        ENTRY: R1 ADDRESS OF THE REPORT AREA                         * 01118000
*               R2 TIME IN SECONDS                                    * 01119000
*        EXIT : REPORT AREA WILL CONTAIN TIME READY FOR PRINT         * 01120000
*********************************************************************** 01121000
*                                                                       01122000
PRINTIME STM   R8,R9,REGSAVE       SAVE REGS                            01123000
         LR    R3,R2               TIME IN SECONDS                      01124000
         XR    R2,R2               CLEAR                                01125000
         D     R2,SIXTY            DIVIDE BY SIXTY                      01126000
         CVD   R2,BWORK            SECONDS TO DECIMAL                   01127000
         LH    R8,BWORK6           SECONDS                              01128000
         SRDL  R8,N12              POSITIONED                           01129000
         XR    R2,R2               CLEAR                                01130000
         D     R2,SIXTY            DIVIDE BY SIXTY                      01131000
         CVD   R2,BWORK            MINUTES TO DECIMAL                   01132000
         LH    R8,BWORK6           MINUTES                              01133000
         SRL   R8,N4               POSITIONED                           01134000
         SRDL  R8,N8                                                    01135000
         CVD   R3,BWORK            HOURS TO DECIMAL                     01136000
         LH    R8,BWORK6           HOURS                                01137000
         SRL   R8,N4               POSITIONED                           01138000
         SRDL  R8,N12                                                   01139000
         O     R9,CONSTF           ZONE                                 01140000
         ST    R9,BWORK            STORE IT IN WORK AREA                01141000
         MVC   N0(N10,R1),LSPATRN  PATTERN                              01142000
         ED    N0(N10,R1),BWORK    EDIT                                 01143000
         LM    R8,R9,REGSAVE       RESTORE REGS                         01144000
         BR    R14                 RETURN                               01145000
*                                                                       01146000
*                                                                       01147000
HEXTOBIN DS    0CL90                                                    01148000
         DC    XL25'000102030405060708090000000000000A0B0C0D0E0F101112' 01149000
         DC    XL25'130000000000001415161718191A1B1C1D0000000000001E1F' 01150000
         DC    XL25'202122232425262700000000000028292A2B2C2D2E2F303100' 01151000
         DC    XL15'000000000032333435363738393A3B' CONV. TABLE         01152000
*                                                                       01153000
         EJECT                                                          01154000
*********************************************************************** 01155000
*    PHASE 2 BEGINS HERE. PHASE 2 COUNTS SIS  AND SRIS  USING THE     * 01156000
*    BASIC 10 MIN. RULE, 30 MINUTE RULE, AND SI 10 MIN. RULE.         * 01157000
*********************************************************************** 01158000
*                                                                       01159000
RDEPH2   CLI   PH2INCID,X'02'      IS LAST INCIDENT SRI                 01160000
         BL    PH2SI               BR IF SI.                            01161000
         BH    PH2IPL              IF IPL.                              01162000
         BAL   P2RETURN,SRCHSRI    GO SEARCH SRI-SI TABLE ON DEV-CUA.   01163000
         TM    PH2SWS,X40+X20      FIND IN TABLE OR IS TABLE FULL       01164000
         BNE   SRIINTAB             BR IF NO                   @XA16800 01165000
         MVC   N0(N8,R3),PH2DEV    MOVE DEV-CUA-TIME TO TABLE           01166000
         MVC   N8(N4,R3),FULLZERO  AND SET SI-SRI COUNTS TO ZERO.       01167000
         MVC   PH2LSRI(N12),PH2DEV SAVE THIS SRI IN LAST SRI HOLD.      01168000
         B     READ                BRANCH TO READ                       01169000
SRIINTAB L     R5,N4(,R3)          LOAD TIME OF THE TABLE SRI.          01170000
         LTR   R5,R5               TEST TIME FOR ZERO.                  01171000
         L     R4,PH2TIME          LOAD TIME OF THIS SRI.               01172000
         SR    R4,R5               FIND TIME SINCE TABLE SRI.           01173000
         L     R5,MIN10            LOAD 10 MIN. OF SECONDS.             01174000
         CR    R4,R5               IS ELAPSED TIME GREATER THAN 10 MIN. 01175000
         BL    SRIUTIME            IF NO, UPDATE TIME AND RETURN.       01176000
         LH    R4,N8(,R3)          LOAD SRI COUNT,                      01177000
         LA    R4,N1(,R4)          ADD 1,                               01178000
         STH   R4,N8(,R3)          AND MOVE BACK TO TABLE.              01179000
SRIUTIME MVC   N4(N4,R3),PH2TIME   SET TABLE TIME TO THIS SRI.          01180000
         MVC   PH2LSRI(N12),PH2DEV SAVE THIS SRI IN LAST SRI HOLD.      01181000
         B     READ               RETURN TO PHASE 1.                    01182000
         EJECT                                                          01183000
*********************************************************************** 01184000
*    COME HERE IF RECORD FROM PHASE 1 IS AN SI.                       * 01185000
*      ROUTINE TESTS FOR SI 10 MINUTE RULE AND COUNTS SI IF REQUIRED. * 01186000
*      NOTE: THE SI 10 MINUTE RULE IS APPLIED ONLY IF AN SI-IPL       * 01187000
*            COMBINATION HAS OCCURRED WITHIN THE LAST 10 MINUTES.     * 01188000
*********************************************************************** 01189000
*                                                                       01190000
PH2SI    TM    PH2SWS,X80          IS SI-IPL SWITCH ON                  01191000
         BNO   PH2SITAB            BR IF NO.                            01192000
         NI    PH2SWS,X7F          TURN SI-IPL SWITCH 0FF.              01193000
         L     R4,PH2TIME          LOAD THIS SI TIME.                   01194000
         L     R5,PH2LIPL4         LOAD LAST IPL TIME.                  01195000
         SR    R4,R5               FIND TIME ELAPSED.                   01196000
         L     R5,MIN10            LOAD 10 MIN. OF SECONDS.             01197000
         CR    R4,R5               ELAPSED TIME GREATER THAN 10 MIN.    01198000
         BH    PH2SITAB            BR IF YES.                           01199000
         BAL   P2RETURN,SRISITO0   GO SET ALL SRI TIMES TO ZERO.        01200000
*                                                                       01201000
PH2SILAS MVC   PH2LSI(N12),PH2DEV  SET LAST SI HOLD TO THIS SI.         01202000
         B     READ                RETURN TO PHASE 1.                   01203000
PH2SITAB BAL   P2RETURN,SRCHSRI    GO SEARCH SRI-SI TABLE ON DEV-CUA.   01204000
         TM    PH2SWS,X40+X20      FIND IN TABLE OR TABLE FULL          01205000
         BO    SIINTAB             BR IF YES,                           01206000
         MVC   N0(N4,R3),PH2DEV   MOVE DEV-CUA TO TABLE, SET TIME       01207000
         MVC   N4(N8,R3),FULLZERO       ZERO TIME & COUNT               01208000
SIINTAB  LH    R4,N10(,R3)         LOAD SI COUNT,                       01209000
         LA    R4,N1(,R4)             ADD 1,                            01210000
         STH   R4,N10(,R3)               AND MOVE BACK TO TABLE.        01211000
         B     PH2SILAS                    BRANCH TO PH2SILAS           01212000
         EJECT                                                          01213000
*********************************************************************** 01214000
*    COME HERE IF RECORD FROM PHASE 1 IS AN IPL.                      * 01215000
*      ROUTINE TESTS FOR AN SI-IPL COMBINATION, THE 30 MINUTE RULE,   * 01216000
*      AND THE SI 10 MINUTE RULE.                                     * 01217000
*      NOTE: AN SRI MAY BE RECLASSIFIED TO AN SI, WHICH RESULTS IN AN * 01218000
*            SI-IPL COMBINATION(30 MIN. RULE).                        * 01219000
*********************************************************************** 01220000
*                                                                       01221000
PH2IPL   LA    R3,SSIDTAB          LOAD ADDR OF SSID CONVERSION TABLE.  01222000
         LA    R4,N2               LOAD TABLE ENTRY LENGTH.             01223000
         LA    R5,SSIDTABT         LOAD ADDR OF SSID CONVER. TABLE TOP. 01224000
PH2IPL1  CLC   PH2SSID,0(R3)       IS SSID IN CONVERSION TABLE          01225000
         BE    PH2IPL2             BR IF YES.                           01226000
         BXLE  R3,R4,PH2IPL1       CLOSE LOOP.                          01227000
         LA    R3,SSIDTAB          SET TO UNKNOWN.                      01228000
PH2IPL2  MVC   TEMPSSID,N1(R3)     STORE CONVERTED SSID                 01229000
         TM    PH2SW,X40           WAS IPL PRECEEDED BY AN SRI          01230000
         BZ    PH2IPL20            BR IF NO.                            01231000
         L     R4,PH2TIME          LOAD THIS IPL TIME.                  01232000
         L     R5,PH2LSRI4         LOAD LAST SRI TIME.                  01233000
         SR    R4,R5               FIND DIFFERENCE IN TIME.             01234000
         L     R5,MIN30            LOAD 30 MIN. OF SECONDS.             01235000
         CR    R4,R5               ELAPSED TIME GREATER THAN 30 MIN.    01236000
         BH    PH2IPL7             BR IF YES.                           01237000
         CLC   PH2REA(N2),REAIE1   REASON CODE 'IE'                     01238000
         BE    PH2IPL3             BRANCH--YES                          01239000
         CLC   PH2REA(N2),REAIM1   REASON CODE 'IM'                     01240000
         BE    PH2IPL3             BRANCH--YES                          01241000
         CLC   PH2REA(N2),REAUN1   REASON CODE 'UN'                     01242000
         BE    PH2IPL3             BRANCH--YES                          01243000
         CLC   PH2REA(N2),REAME1   REASON CODE 'ME'                     01244000
         BNE   PH2IPL7             BRANCH--NO - NONE OF THEM            01245000
PH2IPL3  CLI   PH2SSID,X'00'       IS SSID UNKNOWN                      01246000
         BE    PH2IPL4             BR IF YES.                           01247000
         CLC   TEMPSSID,PH2LSRI    IPL SSID SAME AS LAST SRI SSID       01248000
         BNE   PH2IPL7             BR IF NO.                            01249000
         MVC   PH2LSI,PH2LSRI      MOVE LAST SRI TO LAST SI.            01250000
         TM    PH2SWS,X80          IS SI-IPL SWITCH ON                  01251000
         BO    PH2IPL4             BR IF YES.                           01252000
PH2IPL5  MVC   PH2DEV(N4),PH2LSRI  MOVE SRI DEV-CUA TO LAST INCI.       01253000
         BAL   P2RETURN,SRCHSRI    GO SEARCH SRI-SI TABLE ON DEV-CUA.   01254000
         LH    R4,N10(,R3)         LOAD SI COUNT,                       01255000
         LA    R4,N1(,R4)          ADD 1 TO COUNT,                      01256000
         STH   R4,N10(,R3)         AND MOVE BACK TO TABLE.              01257000
         MVC   N4(N4,R3),FULLZERO  ZERO TABLE TIME.                     01258000
         OI    PH2SWS,X80          TURN SI-IPL SWITCH ONN.              01259000
PH2IPL9  BAL   P2RETURN,COUNTSRI   GO COUNT ALL SRIS .                  01260000
PH2IPL6  MVC   PH2LIPL,PH2DEV      SET LAST IPL TO THIS IPL.            01261000
         B     READ                RETURN TO PHASE 1.                   01262000
PH2IPL4  L     R3,PH2LSRI4         LOAD LAST SRI TIME.                  01263000
         L     R4,PH2LIPL4         LOAD LAST IPL TIME                   01264000
         SR    R3,R4               FIND TIME ELAPSED SINCE LAST IPL.    01265000
         L     R4,MIN10            LOAD 10 MIN. OF SECONDS.             01266000
         CR    R3,R4               ELAPSED TIME GREATER THAN 10 MIN.    01267000
         BH    PH2IPL5             BR IF YES.                           01268000
         BAL   P2RETURN,SRISITO0   GO SET ALL SRI TIMES TO ZERO.        01269000
         NI    PH2SWS,X7F          SET SI-IPL SWITCH OFF.               01270000
         B     PH2IPL6             GO TO RETURN.                        01271000
PH2IPL7  NI    PH2SWS,X7F          SET SI-IPL SWITCH OFF.               01272000
         MVC   PH2LSI4(N4),PH2TIME SET LAST SI TIME TO THIS IPL         01273000
         CLC   PH2REA(N2),REAIE1   REASON CODE 'IE'                     01274000
         BE    PH2IPL8             BRANCH--YES                          01275000
         CLC   PH2REA(N2),REAIM1   REASON CODE 'IM'                     01276000
         BE    PH2IPL8             BRANCH--YES                          01277000
         CLC   PH2REA(N2),REAUN1   REASON CODE 'UN'                     01278000
         BE    PH2IPL8             BRANCH--YES                          01279000
         CLC   PH2REA(N2),REAME1   REASON CODE 'ME'                     01280000
         BNE   PH2IPL9             BRANCH--NO - NONE OF THEM            01281000
PH2IPL8  CLI   TEMPSSID,X'99'                                           01282000
         BE    PH2IPL9             BR IF IBM SOFTWARRE.                 01283000
         CLI   TEMPSSID,X'10'                                           01284000
         BNE   PH2IPL10            BRANCH IF EQUAL TO PH2IPL10          01285000
         MVI   PH2DEV,X04          SET LAST INCI. TO UNKNOWN PROCESSOR. 01286000
         MVC   PH2CUA,FULLZERO     SET LAST INCI. CUA TO 0.             01287000
         B     PH2IPL12            GO TO COUNT SI.                      01288000
PH2IPL10 CLI   TEMPSSID,X'00'                                           01289000
         BNE   PH2IPL11            BR IF SSID KNOWN.                    01290000
         MVI   PH2DEV,X99          SET UNKNOWN                          01291000
         MVC   PH2CUA,FULLZERO     SUBSYSTEM.                           01292000
         B     PH2IPL12            GO TO COUNT SI.                      01293000
PH2IPL11 MVC   PH2DEV,TEMPSSID     SET UNKOWN                           01294000
         MVC   PH2CUA,ALL9S        UNIT IN PROPER SUBSYSTEM.            01295000
PH2IPL12 BAL   P2RETURN,SRCHSRI    GO SEARCH SRI-SI TABLE ON DEV-CUA.   01296000
         TM    PH2SWS,X40+X20      FIND IN TABLE OR TABLE FULL          01297000
         BO    PH2IPL13            BR IF YES                            01298000
         MVC   N0(N4,R3),PH2DEV    PUT SI IN TABLE,                     01299000
         MVC   N4(N8,R3),FULLZERO  ZERO TIME & COUNT                    01300000
         LA    R4,N1               SET SI COUNT                         01301000
         STH   R4,N10(,R3)         TO 1.                                01302000
         B     PH2IPL9             GO TO COUNT SRIS                     01303000
PH2IPL13 LH    R4,N10(,R3)         LOAD SI COUNT,                       01304000
         LA    R4,N1(R4)           ADD 1 TO COUNT,                      01305000
         STH   R4,N10(,R3)         AND PLACE BACK IN TABLE.             01306000
         B     PH2IPL9             GO TO COUNT SRIS                     01307000
PH2IPL20 TM    PH2SW,X80           WAS IPL PRECEEDED BY SI              01308000
         BNO   PH2IPL22            BR IF NO.                            01309000
         OI    PH2SWS,X80          SET SI-IPL SWITCH ON.                01310000
         BAL   P2RETURN,COUNTSRI   GO COUNT ALL SRIS .                  01311000
PH2IPL21 MVC   PH2LIPL,PH2DEV      SET LAST IPL HOLD TO THIS IPL        01312000
         B     READ                RETURN TO PHASE 1.                   01313000
PH2IPL22 TM    PH2SW,X20           WAS IPL PRECEEDED BY IPL             01314000
         BNO   PH2IPL7             BR IF NO.                            01315000
         L     R3,PH2TIME          LOAD TIME OF THIS IPL.               01316000
         L     R4,PH2LIPL4         LOAD TIME OF LAST IPL.               01317000
         SR    R3,R4               FIND TIME DIFFERENCE.                01318000
         L     R4,MIN10            LOAD 10 MIN OF SECONDS.              01319000
         CR    R3,R4               ELAPSED TIME GREATER THAN 10         01320000
*                                  MINUTES.                             01321000
         BH    PH2IPL7             BR IF YES.                           01322000
         BAL   P2RETURN,SRISITO0   GO SET ALL SRI TIMES TO ZERO.        01323000
         B     PH2IPL21            GO TO SET LAST IPL HOLD AND RETURN.  01324000
*                                                                       01325000
         EJECT                                                          01326000
*********************************************************************** 01327000
*    THIS ROUTINE SEARCHES THE SRI-SI TABLE USING THE DEVICE TYPE,    * 01328000
*      CONTROL UNIT ADDRESS AS A SEARCH ARGUMENT. SWITCHES ARE SET TO * 01329000
*        INDICATE TO CALLER, A FIND, NO FIND, AND TABLE IS FULL.      * 01330000
*      IF A FIND OCCURRS REGISTER R3 POINTS TO THE FIND.              * 01331000
*      IF NO FIND OCCURRS REGISTER R3 POINTS TO THE FIRST VACCANT     * 01332000
*        ELEMENT.                                                     * 01333000
*      IF THE TABLE IS FULL, REGISTER R3 POINTS TO THE LAST TABLE     * 01334000
*        ELEMENT.                                                     * 01335000
*********************************************************************** 01336000
*                                                                       01337000
SRCHSRI  LA    R3,SRISITAB         SET TABLE BOTTOM                     01338000
         LA    R4,N12              SET TABLE ENTRY LENGTH               01339000
         LA    R5,SRSITLOW         TOP OF TABLE - TWO ENTRIES           01340000
         NI    PH2SWS,X9F          SET TABLE FIND AND TABLE FULL OFF    01341000
SRCHSRI1 CLC   PH2DEV(N4),N0(R3)   DEV. AND CUA IN TABLE                01342000
         BE    SRCHSRI2            BR IF YES                            01343000
         CLC   FULLZERO(N4),N0(R3) TABLE ENTRY ZERO                     01344000
         BER   P2RETURN            RETURN TO CALLING POINT              01345000
         BXLE  R3,R4,SRCHSRI1      CLOSE LOOP                           01346000
         OI    PH2SWS,X20          TURN ON TABLE FULL                   01347000
         BR    P2RETURN            RETURN TO CALLING POINT.             01348000
SRCHSRI2 OI    PH2SWS,X40          TURN ON FIND                         01349000
         BR    P2RETURN            RETURN TO CALLING POINT.             01350000
         EJECT                                                          01351000
*********************************************************************** 01352000
*    THIS ROUTINE SETS ALL SRI TIMES IN THE SRI-SI TABLE TO ZERO.     * 01353000
*********************************************************************** 01354000
*                                                                       01355000
SRISITO0 LA    R3,SRISITAB         SET TABLE BOTTOM                     01356000
         LA    R4,N12              SET TABLE ENTRY LENGTH               01357000
         LA    R5,SRSITP12         SET TABLE TOP                        01358000
SRISIT0R MVC   N4(N4,R3),FULLZERO  SET TABLE TIME TO 0.                 01359000
         BXLE  R3,R4,SRISIT0R      BR UNTIL TABLE ZEROED.               01360000
         BR    P2RETURN           RETURN TO CALLING POINT.              01361000
*                                                                       01362000
*********************************************************************** 01363000
*    THIS ROUTINE ADDS ONE TO THE SRI COUNT IN THE SRI-SI TABLE FOR   * 01364000
*      ALL ELEMENTS WHICH DO NOT HAVE A ZERO TIME.                    * 01365000
*      NOTE: AN ELEMENT WHICH HAS A ZERO TIME IS ONE WHICH HAS NOT    * 01366000
*            HAD AN SRI OCCURR SINCE THE LAST IPL RECORD.             * 01367000
*********************************************************************** 01368000
*                                                                       01369000
COUNTSRI LA    R3,SRISITAB         SET TABLE BOTTOM.                    01370000
         LA    R4,N12              SET TABLE ENTRY                      01371000
         LA    R5,SRISITOP         SET TABLE TOP.                       01372000
CNTSRI1  L     R6,N4(,R3)          LOAD TIME.                           01373000
         LTR   R6,R6               TEST TIME.                           01374000
         BZ    CNTSRI2             BR IF ZERO.                          01375000
         LH    R6,N8(,R3)          LOAD SRI COUNT,                      01376000
         LA    R6,N1(,R6)          ADD 1 TO COUNT,                      01377000
         STH   R6,N8(,R3)          AND MOVE BACK TO TABLE.              01378000
         MVC   N4(N4,R3),FULLZERO  ZERO OUT TIME.                       01379000
CNTSRI2  BXLE  R3,R4,CNTSRI1       CLOSE LOOP.                          01380000
         BR    P2RETURN            RETURN TO CALLING POINT.             01381000
*                                                                       01382000
         EJECT                                                          01383000
*********************************************************************** 01384000
*    COME HERE AFTER ALL RDE TAPE RECORDS HAVE BEEN READ AND PROCESSED* 01385000
*      ALL OF THE RECORD COUNTS ARE THEN SORTED                       * 01386000
*      INTO DEVICE TYPE(SUBSYSTEM ID.), CONTROL UNIT ADDRESS ORDER,   * 01387000
*      THEN PRINTS THE PHASE 2 REPORT FROM THE INFORMATION IN THE     * 01388000
*      TABLE.                                                         * 01389000
*********************************************************************** 01390000
*                                                                       01391000
PHS2PRT  BAL   P2RETURN,COUNTSRI   GO COUNT ALL SRIS .                  01392000
         LA    R3,SRISITAB         SET TABLE BOTTOM.                    01393000
         LA    R4,N12              SET TABLE ENTRY LENGTH.              01394000
         LA    R5,SRISITOP         SET TABLE TOP.                       01395000
P2EJ2    CLC   N8(N4,R3),FULLZERO  TEST SRI AND SI COUNTS FOR ZERO.     01396000
         BNE   P2EJ3               BR IF EITHER NON-ZERO.               01397000
         MVI   N0(R3),XFF          SET NON-PRINTABLE ENTRY,             01398000
         B     P2EJ4               GO TRY NEXT ENTRY.                   01399000
P2EJ3    LA    R6,SUBSTAB          SET SUBSYSTEM TABLE BOTTOM.          01400000
         LA    R7,SUBSTBE3         SET SUBSYSTEM TABLE TOP.             01401000
P2EJ3A   CLC   N0(N1,R3),N0(R6)    IS TABLE SSID IN SUBSYSTEM TABLE     01402000
         BNE   P2EJ8               NO, GO TO NEXT ENTRY                 01403000
         L     R6,N0(R6)           YES, GET ROUTINE ADDRESS             01404000
         B     0(R6)               GO TO EDIT SRI-SI TABLE ENTRY        01405000
P2EJ8    LA    R6,N4(R6)           RAISE SUBSYSTEM TABLE BOTTOM BY 4.   01406000
         CR    R6,R7               END OF SUBSYSTEM TABLE               01407000
         BL    P2EJ3A              BR IF NO.                            01408000
         MVI   N0(R3),X99          SET UNKNOWN SUBSYSTEM.               01409000
P2EJ6    NI    N3(R3),X00          ZERO OUT LOW ORDER BYTE OF CUA.      01410000
P2EJ7    NC    N1(N2,R3),CUAMASK   AND OUT CUA UNUSED DATA              01411000
         B     P2EJ4               TRY NEXT.                            01412000
P2EJ5    MVC   N1(N3,R3),FULLZERO  ZERO OUT CUA.                        01413000
P2EJ4    BXLE  R3,R4,P2EJ2         CLOSE SRI-SI TABLE LOOP.             01414000
*                                                                       01415000
         LA    R3,SRISITAB         SET TABLE BOTTOM.                    01416000
         LA    R4,N12              SET TABLE ENTRY LENGTH.              01417000
         LA    R5,SRSIT            SET TABLE TOP MINUS ONE.             01418000
         LA    R8,N12              SET TABLE ENTRY LENGTH.              01419000
         LA    R9,SRISITOP         SET TABLE TOP.                       01420000
P2EJ9    LA    R7,N12(R3)          SET TABLE BOTTOM PLUS ONE.           01421000
P2EJ10   CLC   N0(N4,R3),N0(R7)    IS BOTTOM ENTRY LESS THAN NEXT ONE.  01422000
         BL    P2EJ11              BR IF YES.                           01423000
         MVC   PH2DEV(N12),N0(R3)  REVERSE                              01424000
         MVC   N0(N12,R3),N0(R7)   THE TWO                              01425000
         MVC   N0(N12,R7),PH2DEV   ENTRIES.                             01426000
P2EJ11   BXLE  R7,R8,P2EJ10        CLOSE INSIDE LOOP.                   01427000
         BXLE  R3,R4,P2EJ9         CLOSE OUTSIDE LOOP.                  01428000
*                                                                       01429000
         BAL   R1,HEADING          GO TO PRINT PAGE HEADINGS.           01430000
*                                                                       01431000
         LA    R3,SRISITAB         SET TABLE BOTTOM.                    01432000
         LA    R4,N12              SET TABLE ENTRY LENGTH.              01433000
         LA    R5,SRISITOP         SET TABLE TOP.                       01434000
         MVI   PRT,SPACE2          PRINT                                01435000
         MVC   PRT1(N9),PROCLAB    PROCESSOR                            01436000
         MVC   PRT11(N9),SUBLAB    SUBSYSTEM                            01437000
         BAL   P2RETURN,PRTLIN     GO TO PRINT IT.                      01438000
         MVI   PH2DEV,X01          SET CPU.                             01439000
         MVC   PH2CUA,FULLZERO     SET CUA TO ZERO.                     01440000
         BAL   P2RETURN,SETSUBHD   GO SET SUB-HEADER IN PRINT LINE.     01441000
         XR    R8,R8               ZERO SUBSYSTEM                       01442000
         XR    R9,R9               ACCUMULATORS.                        01443000
         BAL   P2RETURN,COUNTTAB   GO COUNT SRIS  AND SIS .             01444000
         BAL   P2RETURN,PRTLIN     GO TO PRINT IT.                      01445000
         MVI   PH2DEV,X02          SET STORAGE.                         01446000
         BAL   P2RETURN,SETSUBHD   GO SET SUB-HEADER IN PRINT LINE.     01447000
         BAL   P2RETURN,COUNTTAB   GO COUNT SRIS  AND SIS .             01448000
         BAL   P2RETURN,PRTLIN     GO TO PRINT IT.                      01449000
         MVI   PH2DEV,X03          SET CHANNELS SUBSYSTEM.              01450000
         BAL   P2RETURN,SETSUBHD   GO SET SUB-HEADER IN PRINT LINE.     01451000
         BAL   P2RETURN,PRTLIN     GO TO PRINT IT.                      01452000
         XR    R1,R1               ZERO REG. 1.                         01453000
         ST    R1,SAVER1                                                01454000
         ST    R1,CHANACCU         ZERO OUT                             01455000
         ST    R1,CHANACU4         CHANNEL ACCUMULATORS.                01456000
P2EJ13   L     R1,SAVER1           MOVE CHANNEL NUMBER TO R1.           01457000
         STC   R1,PH2CUA1          MOVE CHANNEL NUMBER TO SEARCH ARG.   01458000
         STC   R1,PRT6             MOVE CHANNEL NUMBER TO PRINT LINE.   01459000
         LA    R1,N1(,R1)          BUMP CHANNEL NUMBER BY ONE.          01460000
         ST    R1,SAVER1           SAVE CHANNEL NUMBER.                 01461000
         CLI   PH2CUA1,X0F         ALL CHANNELS DONE                    01462000
         BH    P2EJ14              BR IF YES.                           01463000
         TR    PRT6(N1),CHANTAB    TRANSLATE HEX CHANNEL NUMBER TO      01464000
*                                  EBDIC                                01465000
         BAL   P2RETURN,COUNTTAB   GO COUNT SRIS  AND SIS .             01466000
         LM    R1,R2,CHANACCU      LOAD CHANNEL TOTALS.                 01467000
         AR    R1,R6               ADD CHANNEL X SRIS                   01468000
         AR    R2,R7               AND SIS  TO TOTAL.                   01469000
         STM   R1,R2,CHANACCU      SAVE CHANNEL TOTALS.                 01470000
         AR    R6,R7               COMBINE CHANNEL X SRIS  AND SIS .    01471000
         LTR   R6,R6               TEST CHANNEL X ERRORS                01472000
         BZ    P2EJ13              AND BYPASS PRINTING IF ZERO.         01473000
         BAL   P2RETURN,PRTLIN     GO TO PRINT IT.                      01474000
         B     P2EJ13              GO TO DO NEXT CHANNEL.               01475000
P2EJ14   MVI   PRT,SPACE2          SET TOTALS                           01476000
         MVC   PRT6(N5),TOTALLAB   TOTAL                                01477000
         LM    R6,R7,CHANACCU      MOVE TOTALS FOR ALL CHANNELS.        01478000
         BAL   P2RETURN,CNTTAB2A   GO SET SRI-SI TOTALS IN PRINT LINE.  01479000
         BAL   P2RETURN,PRTLIN     GO TO PRINT IT.                      01480000
         MVI   PH2DEV,X04          SET UNKNOWN                          01481000
         MVC   PH2CUA,FULLZERO     PROCESSOR                            01482000
         BAL   P2RETURN,SETSUBHD   GO SET SUB-HEADER IN PRINT LINE.     01483000
         BAL   P2RETURN,COUNTTAB   GO COUNT SRIS  AND SIS .             01484000
         AR    R6,R7               COMBINE SRIS  AND SIS ,              01485000
         LTR   R6,R6               AND TES FOR ZERO ERRORS.             01486000
         BZ    P2EJ15              BR IF ZERO.                          01487000
         BAL   P2RETURN,PRTLIN     GO TO PRINT IT.                      01488000
P2EJ15   MVC   PRT2(N18),PRT1      CLEAR PRINT LINE.                    01489000
         MVI   PRT,SPACE2          SET TOTAL                            01490000
         MVC   PRT2(N5),TOTALLAB   TOTAL                                01491000
         LR    R6,R8               MOVE SUBSYSTEM TOTALS                01492000
         LR    R7,R9               TO REGS. R6-R7.                      01493000
         BAL   P2RETURN,CNTTAB2A   GO SET SRI-SI TOTALS IN PRINT LINE.  01494000
         BAL   P2RETURN,PRTLIN     GO TO PRINT IT.                      01495000
P2EJ15A  XR    R8,R8               ZERO SUBSYSTEM                       01496000
         XR    R9,R9               ACCUMULATORS.                        01497000
         MVI   PRT,SPACE2          SET DOUBLE SPACE IN PRINT LINE.      01498000
         CLI   0(R3),X'FF'         END OF PRINTABLE ENTRIES             01499000
         BE    P2EJ30              BR IF YES                            01500000
         MVC   PH2DEV(N4),N0(R3)   MOVE SSID-CUA TO COMPARE AREA.       01501000
         BAL   P2RETURN,SETSUBHD   GO SET SUB-HEADER IN PRINT LINE.     01502000
         BAL   P2RETURN,PRTLIN     GO PRINT IT.                         01503000
         MVI   PRT,SPACE2          DOUBLE SPACE                         01504000
P2EJ25   CLC   PH2CUA(N3),ALL99S   UNKNOWN CUA - '000999'               01505000
         BNE   P2EJ26              BR IF NO.                            01506000
         MVC   PRT6(N7),UNKNOW     UNKNOWN                              01507000
         B     P2EJ27              BYPASS DEVICE TRANSLATION.           01508000
P2EJ26   MVC   PRT6(N1),PH2CUA1                                         01509000
         IC    R1,PH2CUA2                                               01510000
         SRA   R1,N4                                                    01511000
         STC   R1,PRT7                                                  01512000
         NI    PRT7,X0F                                                 01513000
         MVC   PRT8(N1),PH2CUA2                                         01514000
         NI    PRT8,X0F                                                 01515000
         TR    PRT6(N3),CHANTAB                                         01516000
P2EJ27   BAL   P2RETURN,COUNTTAB   GO COUNT SRIS  AND SIS .             01517000
         AR    R6,R7               ADD SIS  TO SRIS .                   01518000
         LTR   R6,R6               ARE BOTH ZERO                        01519000
         BZ    P2EJ28              BR IF YES.                           01520000
         BAL   P2RETURN,PRTLIN     GO TO PRINT IT.                      01521000
P2EJ28   CLC   N0(N1,R3),PH2DEV    NEXT IS SAME SSID AS LAST            01522000
         BNE   P2EJ29              BR IF NO.                            01523000
         MVC   PH2CUA,N1(R3)       MOVE NEXT DEVICE ADDRESS TO SEARCH.  01524000
         B     P2EJ25              GO TO PROCESS NEXT.                  01525000
P2EJ29   MVI   PRT,SPACE2          SET TOTALS FOR                       01526000
         MVC   PRT6(N5),TOTALLAB   TOTAL                                01527000
         LR    R6,R8               IN PRINT                             01528000
         LR    R7,R9               LINE                                 01529000
         BAL   P2RETURN,CNTTAB2A   GO SET SRI-SI TOTALS IN PRINT LINE.  01530000
         BAL   P2RETURN,PRTLIN     GO TO PRINT IT.                      01531000
         B     P2EJ15A             GO START NEXT SUBSYSTEM.             01532000
*                                                                       01533000
P2EJ30   MVI   PRT,SPACE3          SET TRIPLE SPACE.                    01534000
         MVC   PRT9(N13),RPTEND    END OF REPORT                        01535000
         BAL   P2RETURN,PRINT      GO PRINT END OF REPORT.              01536000
         B     PHASE2ND            RETURN TO END JOB ROUTINE.           01537000
*                                                                       01538000
SETSUBHD MVI   PRT,SPACE2          SET DOUBLE SPACE IN PRINT LINE.      01539000
         LA    R1,SUBHDRT          LOAD TABLE START.                    01540000
         LA    R2,SUBHDRTE         LOAD TABLE END.                      01541000
SUBHDR1  CLC   PH2DEV,0(R1)                                             01542000
         BE    SUBHDR2             BR IF FIND SUB-HEADER.               01543000
         LA    R1,N22(R1)          BUMP ADDRESS TO NEXT SUBSYSTEM.      01544000
         CR    R1,R2                                                    01545000
         BL    SUBHDR1             BR IF NOT TABLE END.                 01546000
         LA    R1,SBHDRTE          SET TO UNKNOWN SUBSYSTEM.            01547000
SUBHDR2  MVC   PRT1(N21),N1(R1)    MOVE SUB-HEADER TO PRINT LINE.       01548000
         BR    P2RETURN            RETURN TO CALLER.                    01549000
         EJECT                                                          01550000
*********************************************************************** 01551000
*    THIS ROUTINE COUNTS THE SRIS  AND SIS  FOR A GIVEN SUBSYSTEM,    * 01552000
*      CONTROL UNIT ADDRESS.                                          * 01553000
*      NOTE: SRI AND SI COUNTS ARE MOVED TO THE PRINT LINE, CONVERTED * 01554000
*            TO EBDIC, HIGH ORDER ZEROS ARE SURPRESSED, AND THE COUNTS* 01555000
*            ARE ALSO ADDED TO THE SUBSYSTEM TOTALS.                  * 01556000
*            IF ENTRY OCCURRS AT CNTTAB2A THEN THE PRINT LINE IS      * 01557000
*            LOADED FROM THE CONTENTS OF REGISTERS R6 AND R7 (THIS    * 01558000
*            ENTRY IS USED TO PRINT SUBSYSTEM TOTALS).                * 01559000
*********************************************************************** 01560000
*                                                                       01561000
COUNTTAB XR    R6,R6               ZERO REGISTERS R6,                   01562000
         XR    R7,R7               AND R7.                              01563000
CNTTAB1  CLC   N0(N4,R3),PH2DEV    SEE IF DEV-CUA IS PROPER.            01564000
         BNE   CNTTAB2             BR IF NO.                            01565000
         AH    R6,N8(,R3)          ADD SRIS  TO REG. 6,                 01566000
         AH    R7,N10(,R3)         SIS  TO REG. 7.                      01567000
         BXLE  R3,R4,CNTTAB1       CLOSE ADD LOOP.                      01568000
CNTTAB2  AR    R8,R6               ACCUMULATE                           01569000
         AR    R9,R7               SUBSYSTEM TOTALS.                    01570000
CNTTAB2A CVD   R6,BWORK            CONVERT                              01571000
         UNPK  PRT35(N5),BWORK5(N3) SRI                                 01572000
         OI    PRT39,XF0           AND                                  01573000
         CVD   R7,BWORK            SI                                   01574000
         UNPK  PRT60(N5),BWORK5(N3) COUNTS                              01575000
         OI    PRT64,XF0           TO EBDIC.                            01576000
         STM   R1,R2,SAVER1R2      SAVE R1 AND R2 TEMP.                 01577000
         LA    R1,PRT35            SET START AND                        01578000
         LA    R2,PRT39            STOP ADDRESSES.                      01579000
CNTTAB3  CLI   0(R1),X'F0'         HI ORDER ZERO                        01580000
         BNE   CNTTAB4             BR IF NO.                            01581000
         MVI   N0(R1),C' '         BLANK HIGH ORDER BYTE                01582000
         LA    R1,N1(,R1)          BUMP ADDRESS BY ONE                  01583000
         CR    R1,R2               DONE                                 01584000
         BL    CNTTAB3             BR IF NO.                            01585000
CNTTAB4  LA    R2,PRT40            SET FIRST COUNT ADDRESS.             01586000
         CR    R1,R2               SEE IF SECOND COUNT ADDRESS.         01587000
         BH    CNTTAB5             BR IF YES.                           01588000
         LA    R1,PRT60            SET START AND STOP                   01589000
         LA    R2,PRT64            ADDRESSES FOR SECOND.                01590000
         B     CNTTAB3             GO TO EDIT SECOND COUNT.             01591000
CNTTAB5  LM    R1,R2,SAVER1R2      RETURN R1 AND R2 VALUES.             01592000
         BR    P2RETURN            RETURN TO CALLING POINT.             01593000
         EJECT                                                          01594000
*********************************************************************** 01595000
*    COME HERE TO PRINT HEADINGS ON THE PHASE 2 REPORT.               * 01596000
*********************************************************************** 01597000
*                                                                       01598000
HEADING  ST    R1,SAVER1           SAVE REG.1 FOR LATER RETURN.         01599000
         MVI   PRT,SKIP            SET RESTORE FORM.                    01600000
         MVC   PRT10(N55),CCCUST   MOVE CUSTOMER NAME TO FIRST LINE.    01601000
         BAL   P2RETURN,PRTLIN     GO TO PRINT IT.                      01602000
         MVI   PRT,SPACE2          SET DOUBLE SPACE.                    01603000
         MVC   PRT24(N27),P2HEAD1  HEADING TO REPORT                    01604000
         BAL   P2RETURN,PRTLIN     PRINT IT                             01605000
         MVI   PRT,SPACE3          TRIPLE SPACE                         01606000
         MVC   PRT1(N72),P2HEAD2   HEADING TO REPORT                    01607000
         BAL   P2RETURN,PRTLIN     PRINT IT                             01608000
         MVI   PRT,SPACE2          SET DOUBLE SPACE ON FIRST LINE.      01609000
         L     R1,SAVER1           RETURN ADDRESS TO REG. 1.            01610000
         BR    R1                  BRANCH TO READ                       01611000
         EJECT                                                          01612000
*********************************************************************** 01613000
*    COME HERE PRIOR TO PRINTING ALL LINES ON THE PHASE 2 REPORT.     * 01614000
*      PRINT LINES INCLUDING PRINTER SPACING ARE COUNTED.             * 01615000
*      A COMMON PRINT ROUTINE FOR PHASE 1 AND PHASE 2 IS USED.        * 01616000
*      IF A PAGE OVERFLOW OCCURRS, THE HEADING WILL BE PRINTED AT THE * 01617000
*        TOP OF THE NEW PAGE.                                         * 01618000
*********************************************************************** 01619000
*                                                                       01620000
PRTLIN   ST    P2RETURN,SAVER14    SAVE RETURN ADDRESS.                 01621000
         LH    R1,LINES            LOAD LINE COUNT.                     01622000
         LA    R1,N1(,R1)          BUMP LINE COUNT BY ONE.              01623000
         CLI   PRT,X'09'                                       @XA21049 01624000
         BE    PRTLIN1             BR IF SPACE 1 LINE.                  01625000
         LA    R1,N1(,R1)          BUMP LINE COUNT ONE MORE.            01626000
         CLI   PRT,X'11'                                       @XA21049 01627000
         BE    PRTLIN1             BR IF SPACE 2 LINES.                 01628000
         LA    R1,N1(,R1)          BUMP LINE COUNT ONE MORE.            01629000
         CLI   PRT,X'19'                                       @XA21049 01630000
         BE    PRTLIN1             BR IF SPACE 3 LINES.                 01631000
         XR    R1,R1               ZERO LINE COUNT.                     01632000
PRTLIN1  STH   R1,LINES            STORE LINE COUNT.                    01633000
         BAL   P2RETURN,PRINT      GO TO COMMON PRINT ROUTINE.          01634000
         CLC   LINES(N2),MAXLINCT  MAXIMUM LINES REACHED       @XA21049 01635000
         BL    PRTLIN3             BR IF NO.                            01636000
         L     R1,SAVER14          RETURN ADDRESS IN REG 1              01637000
         B     HEADING             DO HEADING                           01638000
PRTLIN3  L     P2RETURN,SAVER14    SET RETURN ADDRESS.                  01639000
         BR    P2RETURN            RETURN TO CALLING POINT.             01640000
*                                                                       01641000
SPCNCNT  MVI   PRT,X'09'           SPACE 1 LINE                @XA21049 01642000
         LH    R1,LINES            LOAD LINE COUNT             @XA21049 01643000
         LA    R1,N1(,R1)          BUMP LINE COUNT ONCE        @XA21049 01644000
         STH   R1,LINES            STORE LINE COUNT            @XA21049 01645000
         BR    R14                                             @XA21049 01646000
         EJECT                                                          01647000
*NOIPLS:   R2 = SAVER2;                                    /*@Z427VLS*/ 01648000
NOIPLS   L     @15,SAVER2                                          0090 01649000
         LR    R2,@15                                              0090 01650000
*        CALL  IFCMSG(62,ADDR(PRINTER)+2);                 /*@Z427VLS*/ 01651000
         LA    @14,PRINTER                                         0091 01652000
         AL    @14,@CF00073                                        0091 01653000
         ST    @14,@AFTEMPS                                        0091 01654000
         L     @15,ADIFCMSG(,@15)                                  0091 01655000
         LA    @01,@AL00091                                        0091 01656000
         BALR  @14,@15                                             0091 01657000
*        PRINTADR = ADDR(PRINTER);                         /*@Z427VLS*/ 01658000
         L     @15,SAVER2                                          0092 01659000
         LA    @14,PRINTER                                         0092 01660000
         ST    @14,PRINTADR(,@15)                                  0092 01661000
*        CALL  IOHND(RITEPRTR);    /* WRITE A LINE           @Z427VLS*/ 01662000
         L     @15,ADIOHND(,@15)                                   0093 01663000
         LA    @01,@AL00093                                        0093 01664000
         BALR  @14,@15                                             0093 01665000
*        GO TO WRAPUPED;                                   /*@Z427VLS*/ 01666000
         B     WRAPUPED                                            0094 01667000
*NOCRDMSG: R2 = SAVER2;                                    /*@Z427VLS*/ 01668000
NOCRDMSG L     @15,SAVER2                                          0095 01669000
         LR    R2,@15                                              0095 01670000
*        CALL  IFCMSG(58,ADDR(PRINTER)+2);                 /*@Z427VLS*/ 01671000
         LA    @14,PRINTER                                         0096 01672000
         AL    @14,@CF00073                                        0096 01673000
         ST    @14,@AFTEMPS                                        0096 01674000
         L     @15,ADIFCMSG(,@15)                                  0096 01675000
         LA    @01,@AL00096                                        0096 01676000
         BALR  @14,@15                                             0096 01677000
*        PRINTADR = ADDR(PRINTER);                         /*@Z427VLS*/ 01678000
         L     @15,SAVER2                                          0097 01679000
         LA    @14,PRINTER                                         0097 01680000
         ST    @14,PRINTADR(,@15)                                  0097 01681000
*        CALL  IOHND(RITEPRTR);    /* WRITE A LINE           @Z427VLS*/ 01682000
         L     @15,ADIOHND(,@15)                                   0098 01683000
         LA    @01,@AL00098                                        0098 01684000
         BALR  @14,@15                                             0098 01685000
*        GO TO CCERROR;                                    /*@Z427VLS*/ 01686000
         B     CCERROR                                             0099 01687000
*STRDTMSG: R2 = SAVER2;                                    /*@Z427VLS*/ 01688000
STRDTMSG L     @15,SAVER2                                          0100 01689000
         LR    R2,@15                                              0100 01690000
*        CALL  IFCMSG(59,ADDR(PRINTER)+2);                 /*@Z427VLS*/ 01691000
         LA    @14,PRINTER                                         0101 01692000
         AL    @14,@CF00073                                        0101 01693000
         ST    @14,@AFTEMPS                                        0101 01694000
         L     @15,ADIFCMSG(,@15)                                  0101 01695000
         LA    @01,@AL00101                                        0101 01696000
         BALR  @14,@15                                             0101 01697000
*        PRINTADR = ADDR(PRINTER);                         /*@Z427VLS*/ 01698000
         L     @15,SAVER2                                          0102 01699000
         LA    @14,PRINTER                                         0102 01700000
         ST    @14,PRINTADR(,@15)                                  0102 01701000
*        CALL  IOHND(RITEPRTR);    /* WRITE A LINE           @Z427VLS*/ 01702000
         L     @15,ADIOHND(,@15)                                   0103 01703000
         LA    @01,@AL00103                                        0103 01704000
         BALR  @14,@15                                             0103 01705000
*        GO TO CCERROR;                                    /*@Z427VLS*/ 01706000
         B     CCERROR                                             0104 01707000
*ENDDTMSG: R2 = SAVER2;                                    /*@Z427VLS*/ 01708000
ENDDTMSG L     @15,SAVER2                                          0105 01709000
         LR    R2,@15                                              0105 01710000
*        CALL  IFCMSG(60,ADDR(PRINTER)+2);                 /*@Z427VLS*/ 01711000
         LA    @14,PRINTER                                         0106 01712000
         AL    @14,@CF00073                                        0106 01713000
         ST    @14,@AFTEMPS                                        0106 01714000
         L     @15,ADIFCMSG(,@15)                                  0106 01715000
         LA    @01,@AL00106                                        0106 01716000
         BALR  @14,@15                                             0106 01717000
*        PRINTADR = ADDR(PRINTER);                         /*@Z427VLS*/ 01718000
         L     @15,SAVER2                                          0107 01719000
         LA    @14,PRINTER                                         0107 01720000
         ST    @14,PRINTADR(,@15)                                  0107 01721000
*        CALL  IOHND(RITEPRTR);    /* WRITE A LINE           @Z427VLS*/ 01722000
         L     @15,ADIOHND(,@15)                                   0108 01723000
         LA    @01,@AL00108                                        0108 01724000
         BALR  @14,@15                                             0108 01725000
*        GO TO CCERROR;                                    /*@Z427VLS*/ 01726000
         B     CCERROR                                             0109 01727000
*CLUSTMSG: R2 = SAVER2;                                    /*@Z427VLS*/ 01728000
CLUSTMSG L     @15,SAVER2                                          0110 01729000
         LR    R2,@15                                              0110 01730000
*        CALL  IFCMSG(61,ADDR(PRINTER)+2);                 /*@Z427VLS*/ 01731000
         LA    @14,PRINTER                                         0111 01732000
         AL    @14,@CF00073                                        0111 01733000
         ST    @14,@AFTEMPS                                        0111 01734000
         L     @15,ADIFCMSG(,@15)                                  0111 01735000
         LA    @01,@AL00111                                        0111 01736000
         BALR  @14,@15                                             0111 01737000
*        PRINTADR = ADDR(PRINTER);                         /*@Z427VLS*/ 01738000
         L     @15,SAVER2                                          0112 01739000
         LA    @14,PRINTER                                         0112 01740000
         ST    @14,PRINTADR(,@15)                                  0112 01741000
*        CALL  IOHND(RITEPRTR);    /* WRITE A LINE           @Z427VLS*/ 01742000
         L     @15,ADIOHND(,@15)                                   0113 01743000
         LA    @01,@AL00113                                        0113 01744000
         BALR  @14,@15                                             0113 01745000
*CCERROR: ;                                                /*@Z427VLS*/ 01746000
CCERROR  DS    0H                                                  0115 01747000
*GENERATE;                                                 /*@Z427VLS*/ 01748000
         LA    R15,4               RETURN CODE                          01749000
*********************************************************************** 01750000
*                                                                     * 01751000
*        END OF PROGRAM - CLOSE DATA SETS AND RETURN                  * 01752000
*********************************************************************** 01753000
*                                                                     * 01754000
*                                                                     * 01755000
PHASE2ND EQU   *                                                        01756000
P2RETURN EQU   14                                                       01757000
*RETURN;                                                   /*@Z427VLS*/ 01758000
@EL00001 L     @13,4(,@13)                                         0116 01759000
@EF00001 DS    0H                                                  0116 01760000
@ER00001 L     @14,12(,@13)                                        0116 01761000
         LM    @00,@12,20(@13)                                     0116 01762000
         BR    @14                                                 0116 01763000
*GENERATE DATA;                                            /*@Z427VLS*/ 01764000
*END;                                                      /*@Z427VLS*/ 01765000
         B     @EL00001                                            0118 01766000
@DATA    DS    0H                                                       01767000
@CH00075 DC    H'3'                                                     01768000
@CH00085 DC    H'9'                                                     01769000
         DS    0F                                                       01770000
@AL00064 EQU   *                       LIST WITH   1 ARGUMENT(S)        01771000
@AL00076 EQU   *                       LIST WITH   1 ARGUMENT(S)        01772000
@AL00080 EQU   *                       LIST WITH   1 ARGUMENT(S)        01773000
@AL00084 EQU   *                       LIST WITH   1 ARGUMENT(S)        01774000
@AL00088 EQU   *                       LIST WITH   1 ARGUMENT(S)        01775000
@AL00093 EQU   *                       LIST WITH   1 ARGUMENT(S)        01776000
@AL00098 EQU   *                       LIST WITH   1 ARGUMENT(S)        01777000
@AL00103 EQU   *                       LIST WITH   1 ARGUMENT(S)        01778000
@AL00108 EQU   *                       LIST WITH   1 ARGUMENT(S)        01779000
@AL00113 DC    A(@CF00073+2)           LIST WITH   1 ARGUMENT(S)        01780000
@AL00067 DC    A(@CH00085)             LIST WITH   1 ARGUMENT(S)        01781000
@AL00070 DC    A(@CH00075)             LIST WITH   1 ARGUMENT(S)        01782000
@AL00091 DC    A(@CF00769)             LIST WITH   2 ARGUMENT(S)        01783000
         DC    A(@AFTEMPS)                                              01784000
@AL00096 DC    A(@CF00772)             LIST WITH   2 ARGUMENT(S)        01785000
         DC    A(@AFTEMPS)                                              01786000
@AL00101 DC    A(@CF00776)             LIST WITH   2 ARGUMENT(S)        01787000
         DC    A(@AFTEMPS)                                              01788000
@AL00106 DC    A(@CF00779)             LIST WITH   2 ARGUMENT(S)        01789000
         DC    A(@AFTEMPS)                                              01790000
@AL00111 DC    A(@CF00782)             LIST WITH   2 ARGUMENT(S)        01791000
         DC    A(@AFTEMPS)                                              01792000
         DS    0F                                                       01793000
@SA00001 DS    18F                                                      01794000
@AFTEMPS DS    1F                                                       01795000
         DS    0F                                                       01796000
@CF00073 DC    F'2'                                                     01797000
@CH00073 EQU   @CF00073+2                                               01798000
@CF00763 DC    F'27'                                                    01799000
@CF00772 DC    F'58'                                                    01800000
@CF00776 DC    F'59'                                                    01801000
@CF00779 DC    F'60'                                                    01802000
@CF00782 DC    F'61'                                                    01803000
@CF00769 DC    F'62'                                                    01804000
         DS    0D                                                       01805000
SAVER2   DS    F                                                        01806000
PRINTER  DC    CL134' '                                                 01807000
         ORG   PRINTER                                                  01808000
@NM00067 DC    CL1'1'                                                   01809000
IPLRPT   DS    CL121                                                    01810000
         ORG   PRINTER+134                                              01811000
ELINE    DC    CL134' '                                                 01812000
         ORG   ELINE                                                    01813000
@NM00068 DC    CL1'0'                                                   01814000
@NM00069 DC    X'89'                                                    01815000
         ORG   ELINE+134                                                01816000
LINETWO  DC    CL134' '                                                 01817000
         ORG   LINETWO                                                  01818000
@NM00070 DC    CL1'0'                                                   01819000
@NM00071 DC    X'13'                                                    01820000
         ORG   LINETWO+134                                              01821000
LINETHR  DC    CL134' '                                                 01822000
         ORG   LINETHR                                                  01823000
@NM00072 DC    CL1'0'                                                   01824000
@NM00073 DC    X'1B'                                                    01825000
         ORG   LINETHR+134                                              01826000
IFCRDESM CSECT                                                          01827000
         EJECT                                                          01828000
*********************************************************************** 01829000
*    THE SRI-SI TABLE IS USED TO ACCUMULATE COUNTS WHILE THE RDE TAPE * 01830000
*      IS BEING READ. WHEN THE RDE TAPE REACHES END OF FILE, THE TABLE* 01831000
*      CONTAINS THE DATA NEEDED TO PRINT THE PHASE 2 REPORT.          * 01832000
*      NOTE: THE TABLE ELEMENTS ARE 12 BYTES LONG AND CONTAIN         * 01833000
*            ONE BYTE DEVICE TYPE(SUBSYSTEM ID.) IN HEX.,             * 01834000
*            THREE BYTE CONTROL UNIT ADDRESS IN HEX.,                 * 01835000
*            ONE WORD TIME(IN SECONDS SINCE JAN. 1, 1960) IN BINARY,  * 01836000
*            HALF WORD SRI COUNT  IN BINARY,                          * 01837000
*            HALF WORD SI COUNT  IN BINARY.                           * 01838000
*********************************************************************** 01839000
*                                                                       01840000
         DS    0F                                                       01841000
SRISITAB DC    100XL12'00'               WORD OF ZEROS.                 01842000
SRISITOP EQU   *-12                                                     01843000
SRSITP12 EQU   SRISITOP+12                                              01844000
SRSIT    EQU   SRISITOP-12                                              01845000
SRSITLOW EQU   SRISITOP-24                                              01846000
         SPACE 2                                                        01847000
PH2LSRI  DC    XL12'00'           AREA TO HOLD LAST SRI RECORD.         01848000
PH2LSRI4 EQU   PH2LSRI+4                                                01849000
PH2LSI   DC    XL12'00'           AREA TO HOLD LAST SI RECORD.          01850000
PH2LSI4  EQU   PH2LSI+4                                                 01851000
PH2LIPL  DC    XL12'00'           AREA TO HOLD LAST IPL RECORD.         01852000
PH2LIPL4 EQU   PH2LIPL+4                                                01853000
MIN10    DC    XL4'00000258'      TEN MINUTES = 600 SECONDS.            01854000
MIN30    DC    XL4'00000708'      THIRTY MINUTES = 1800 SECONDS.        01855000
SAVER1   DC    XL4'00'            TEMPORARY SAVE AREA FOR REGISTER 1.   01856000
SAVER1R2 DC    XL8'00'            TEMPORARY SAVE AREA FOR REG.S  1&2.   01857000
SAVER14  DC    XL4'00'            TEMPORARY SAVE AREA FOR REGISTER 14.  01858000
CHANACCU DC    XL8'00'            CHANNEL TOTALS FOR SRIS  AND SIS .    01859000
CHANACU4 EQU   CHANACCU+4                                               01860000
         EJECT                                                          01861000
*********************************************************************** 01862000
*    THE FOLLOWING TABLE CONTAINS ALL LEGITAMATE SUBSYSTEM IDS        * 01863000
*      (DEVICE TYPES) AND THE ADDRESS OF THE ASSOCIATED EDIT FOR THE  * 01864000
*      SRI-SI TABLE ELEMENT.                                          * 01865000
*********************************************************************** 01866000
*                                                                       01867000
SUBSTAB  DC    X'01'              CPU SUBSYSTEM ID.                     01868000
         DC    AL3(P2EJ5)                                               01869000
         DC    X'02'              STORAGE SUBSYSTEM ID.                 01870000
         DC    AL3(P2EJ5)                                               01871000
         DC    X'03'              CHANNELS SUBSYSTEM ID,                01872000
         DC    AL3(P2EJ6)                                               01873000
         DC    X'04'              UNKNOWN PROCESSOR SUBSYSTEM ID.       01874000
         DC    AL3(P2EJ5)                                               01875000
         DC    X'08'              UNIT RECORD SUBSYSTEM ID.             01876000
         DC    AL3(P2EJ7)                                               01877000
         DC    X'10'              GRAPHICIS SUBSYSTEM ID.               01878000
         DC    AL3(P2EJ7)                                               01879000
         DC    X'20'              DASD SUBSYSTEM ID.                    01880000
         DC    AL3(P2EJ7)                                               01881000
         DC    X'40'              TELEPROCESSING SUBSYSTEM ID.          01882000
         DC    AL3(P2EJ7)                                               01883000
         DC    X'80'              TAPE SUBSYSTEM ID.                    01884000
         DC    AL3(P2EJ7)                                               01885000
         DC    X'99'              UNKNOWN SUBSYSTEM ID.                 01886000
SUBSTABE DC    AL3(P2EJ6)                                               01887000
SUBSTBE3 EQU   SUBSTABE+2                                               01888000
*                                                                       01889000
*********************************************************************** 01890000
*    THE FOLLOWING TABLE IS USED TO CONVERT THE IPL SUBSYSTEM ID. TO  * 01891000
*      THE PROPER DEVICE TYPE(SUBSYSTEM ID.) AS IN THE UCB.           * 01892000
*      NOTE: THE FIRST BYTE IS THE IPL SUBSYSTEM ID., THE SECOND BYTE * 01893000
*            IS ITS  CORRESPONDING UCB DEVICE TYPE.                   * 01894000
*********************************************************************** 01895000
*                                                                       01896000
SSIDTAB  DC    XL2'0000'                                                01897000
         DC    XL2'1010'                                                01898000
         DC    XL2'2020'                                                01899000
         DC    XL2'3099'                                                01900000
         DC    XL2'4080'                                                01901000
         DC    XL2'5008'                                                01902000
         DC    XL2'6008'                                                01903000
         DC    XL2'7040'                                                01904000
         DC    XL2'8010'                                                01905000
         DC    XL2'9099'                                                01906000
SSIDTABT DC    XL2'9199'                                                01907000
         EJECT                                                          01908000
*********************************************************************** 01909000
*       THE FOLLOWING TABLE CONTAINS PHASE 2 SUBHEADINGS              * 01910000
*********************************************************************** 01911000
*                                                                       01912000
SUBHDRT  DC    X'01'                                                    01913000
         DC    CL21' CPU                 '                              01914000
         DC    X'02'                                                    01915000
         DC    CL21' STORAGE             '                              01916000
         DC    X'03'                                                    01917000
         DC    CL21' CHANNELS            '                              01918000
         DC    X'04'                                                    01919000
PROC     DC    C' UNKNOWN PROCESSOR   '                                 01920000
         DC    X'08'                                                    01921000
         DC    CL21'UNIT RECORD SUBSYSTEM'                              01922000
         DC    X'10'                                                    01923000
         DC    CL21'GRAPHICS SUBSYSTEM   '                              01924000
         DC    X'20'                                                    01925000
         DC    CL21'DASD SUBSYSTEM       '                              01926000
         DC    X'40'                                                    01927000
         DC    CL21'TELEPROC SUBSYSTEM   '                              01928000
         DC    X'80'                                                    01929000
         DC    CL21'TAPE SUBSYSTEM       '                              01930000
         DC    X'99'                                                    01931000
         DC    CL21'UNKNOWN SUBSYSTEM    '                              01932000
SUBHDRTE DC    C' '                                                     01933000
UNKNOW   EQU   PROC+1                                                   01934000
PROCLAB  EQU   PROC+9                                                   01935000
SBHDRTE  EQU   SUBHDRTE-22                                              01936000
*                                                                       01937000
*********************************************************************** 01938000
*    THE FOLLOWING CONSTANTS ARE THE PHASE 2 REPORT HEADING LINES.    * 01939000
*********************************************************************** 01940000
*                                                                       01941000
P2HEAD1  DC    C'STATISTICS OF SYSTEM ERRORS'                           01942000
P2HEAD2  DC    C'SUBSYSTEM                     IPL NOT REQUIRED        C01943000
                     IPL REQUIRED'                                      01944000
SUBLAB   EQU   P2HEAD2                                                  01945000
*                                                                       01946000
         EJECT                                                          01947000
*********************************************************************** 01948000
*        TABLE:        SUB-SYSTEM  RESPONSIBLE DESCRIPTIONS           * 01949000
*********************************************************************** 01950000
*                                                                       01951000
SUBTABLE DC    XL2'0006',C'00-NULL'                                     01952000
         DC    XL2'100B',C'10-PROCESSOR'                                01953000
         DC    XL2'200F',C'20-DIRECT ACCESS'                            01954000
         DC    XL2'3012',C'30-AUXILIARY EQUIP.'                         01955000
         DC    XL2'4006',C'40-TAPE'                                     01956000
         DC    XL2'500C',C'50-CARD/PRINT'                               01957000
         DC    XL2'600A',C'60-MICR/OCR'                                 01958000
         DC    XL2'7010',C'70-TELEPROCESSING'                           01959000
         DC    XL2'8010',C'80-GRAPHICS/AUDIO'                           01960000
         DC    XL2'9013',C'90-IBM CONTROL PROG.'                        01961000
         DC    XL2'9113',C'91-IBM PROGRAM PRODUCT'             @XA16800 01962000
IPLNUL   EQU   SUBTABLE+2                                               01963000
         DC    XL1'FF'                                                  01964000
*                                                                       01965000
*********************************************************************** 01966000
*              IPL REASON CODE TABLE, CODE IS ENTERED BY OPERATOR     * 01967000
*               AND BECOMES A FIELD WITHIN THE IPL RECORD             * 01968000
*********************************************************************** 01969000
*                                                                       01970000
IPLDESC  DC    XL2'0C18',C'NM-NORMAL IPL'                               01971000
REAIE    DC    XL2'1E08',C'IE-IBM PROBLEM-NO CE/SE SUPPORT'             01972000
REAIM    DC    XL2'1B00',C'IM-IBM PROBLEM-CE/SE SUPPORT'                01973000
         DC    XL2'2010',C'OP-OPERATIONAL/PROCEDURAL PROBLEM'           01974000
         DC    XL2'1A10',C'UP-USER PROGRAMMING PROBLEM'                 01975000
         DC    XL2'2210',C'EN-ENVIRONMENTAL- POWER FAILURE ETC'         01976000
         DC    XL2'2008',C'CE-CE/SE PLANNED-UNPLANNED MAINT.'           01977000
REAME    DC    XL2'2010',C'ME-FAULTY MEDIA (TAPES,DISK,ETC.)'           01978000
         DC    XL2'1418',C'DF-DEFAULT NORMAL IPL'                       01979000
REAUN    DC    XL2'0908',C'UN-UNKNOWN'                                  01980000
REAIE1   EQU   REAIE+2                                                  01981000
REAIM1   EQU   REAIM+2                                                  01982000
REAME1   EQU   REAME+2                                                  01983000
REAUN1   EQU   REAUN+2                                                  01984000
         DC    XL1'FF'                  END OF TABLE                    01985000
*                                                                       01986000
*********************************************************************** 01987000
*        IPL LOST TIME CATEGORY TABLE, CODE IS ENTERED BY OPERATOR    * 01988000
*         AS IPL REASON CODE IN IPL RECORD                            * 01989000
*********************************************************************** 01990000
*                                                                       01991000
IPLLOST  DC    XL2'0008',C'IBM MAINT'                                   01992000
         DC    XL2'0808',C'IBM RESP.'                                   01993000
         DC    XL2'1004',C'OTHER'                                       01994000
         DC    XL2'1803',C'IDLE'                                        01995000
         DC    X'FF'               END OF TABLE                         01996000
NOAVA    DC    C'NOT AVAILABLE'                                         01997000
WNLNOTE  DC    C' SEE NOTE1'                                   @XA16800 01998000
WNLNOTE1 DC    C'NOTE1 - IPL RECORD TIME STAMP OR DATA DISCREPANCY.'    01999000
*                                                                       02000000
*********************************************************************** 02001000
*     THIS AREA RESERVED FOR OUTPUT FROM PHASE 1  AND USED AS INPUT   * 02002000
*     TO PHASE 2                                                      * 02003000
*********************************************************************** 02004000
*                                                                       02005000
         DS    0F                                                       02006000
         DC    CL3'   '                                                 02007000
PH2INCID DC    XL1'00'            INCIDENT 1=SI,2=SRI,3=IPL,4=OTHER     02008000
PH2DEV   DC    XL1'00'            DEVICE TYPE                           02009000
PH2CUA   DC    XL3'000000'        CONTROL UNIT ADDRESS                  02010000
PH2CUA1  EQU   PH2CUA+1                                                 02011000
PH2CUA2  EQU   PH2CUA+2                                                 02012000
PH2TIME  DC    XL4'00000000'      TIME IN SEC SINCE 1960                02013000
PH2SW    DC    XL1'00'            BIT 0=LSI, BIT 1=LSRI, BIT 2=LIPL     02014000
PH2REA   DC    XL2'0000'          IPL REASON CODE                       02015000
PH2SSID  DC    XL1'00'            IPL SSID                              02016000
*                                                                       02017000
*********************************************************************** 02018000
*        IPL CLUSTER TABLES CONTAIN ELEMENTS IN THE FOLLOWING FORMAT  * 02019000
*                     IPL TABLE (20)            SEQ  TABLE (250)      * 02020000
*                  SEQUENCE NO   4 BYTES        LOW SEQ NO  2 BYTES   * 02021000
*                  TIME IN SEC   4 BYTES        HI  SEQ NO  2 BYTES   * 02022000
*********************************************************************** 02023000
*                                                                       02024000
IPLTAB   DC    160X'0'            RESERVE 160 BYTES FOR CLUSTER TABLE   02025000
IPLTBEND EQU   *                            END OF IPL CLUSTER TABLE    02026000
*                                                                       02027000
SEQTAB   DC    1000X'0'           SEQUENCE NO TABLE 1000 BYTES          02028000
SEQTABE  EQU   *                                                        02029000
         EJECT                                                          02030000
*********************************************************************** 02031000
*        PRINT AREA - 121 BYTES -                                     * 02032000
*********************************************************************** 02033000
*                                                                       02034000
*                                                                       02035000
SKIP     EQU   X'89'                                                    02036000
SPACE2   EQU   X'11'                                                    02037000
SPACE3   EQU   X'19'                                                    02038000
*                                                                       02039000
CTLCRLIN EQU   IPLRPT+1            MESSAGE OFFSET                       02040000
CTLCRLN1 EQU   IPLRPT+6                                                 02041000
CTLCRLN2 EQU   IPLRPT+17                                                02042000
*                                                                       02043000
PRT      EQU   IPLRPT                                                   02044000
PRT1     EQU   IPLRPT+1                                                 02045000
PRT2     EQU   IPLRPT+2                                                 02046000
PRT6     EQU   IPLRPT+6                                                 02047000
PRT7     EQU   IPLRPT+7                                                 02048000
PRT8     EQU   IPLRPT+8                                                 02049000
PRT9     EQU   IPLRPT+9                                                 02050000
PRT10    EQU   IPLRPT+10                                                02051000
PRT11    EQU   IPLRPT+11                                                02052000
PRT14    EQU   IPLRPT+14                                       @XA16800 02053000
PRT15    EQU   IPLRPT+15                                       @XA16800 02054000
PRT24    EQU   IPLRPT+24                                                02055000
PRT35    EQU   IPLRPT+35                                                02056000
PRT39    EQU   IPLRPT+39                                                02057000
PRT40    EQU   IPLRPT+40                                                02058000
PRT60    EQU   IPLRPT+60                                                02059000
PRT64    EQU   IPLRPT+64                                                02060000
*                                                                       02061000
RPTSEQ   EQU   IPLRPT+3                 SEQUENCE #                      02062000
RPTDATE  EQU   IPLRPT+11                DATE                            02063000
RPTTIME  EQU   IPLRPT+19                TIME                            02064000
RPTREA   EQU   IPLRPT+30                REASON FOR IPL                  02065000
RPTSUB   EQU   IPLRPT+67                SUBSYSTEM RESPONSIBLE           02066000
RPTLOST  EQU   IPLRPT+91                LOST TIME                       02067000
RPTCAT   EQU   IPLRPT+104               CATEGORY                        02068000
*                                                                       02069000
RPTCUS   EQU   IPLRPT+40                CUSTOMER NAME                   02070000
*                                       HEADING LINES                   02071000
RPTHDLN1 EQU   IPLRPT+30                 STATISTICS OF ERROR            02072000
RPTHDLN2 EQU   IPLRPT+1                  STARTING DATE OF REPORT        02073000
RPTHDLN3 EQU   IPLRPT+41                 IPL REPORT                     02074000
RPTHDLN4 EQU   IPLRPT+1                  SEQ#,DATE,ETC                  02075000
*                                       FOOTING LINES                   02076000
RPTFTNOT EQU   IPLRPT+1                  * PLEASE NOTE                  02077000
RPTFTLN1 EQU   IPLRPT+1                  ENDING DATE                    02078000
RPTFTLN2 EQU   IPLRPT+6                  MEAN TIME                      02079000
RPTFTLN3 EQU   IPLRPT+6                  IPL CLUSTERING                 02080000
*                                                                       02081000
RPTGROUP EQU   IPLRPT+18                CLUSTER GROUPING                02082000
*                                                                       02083000
RPTLTSUM EQU   IPLRPT+22                LOST SUMMARY                    02084000
RPTLTSM1 EQU   IPLRPT+1                  HEADING                        02085000
RPTLTSM2 EQU   IPLRPT+12                  REPORT                        02086000
RPTLTCT1 EQU   IPLRPT+11                                                02087000
RPTLTHR1 EQU   IPLRPT+19                                                02088000
*                                                                       02089000
RPTLTFT1 EQU   IPLRPT+14                LOST SUM FOOTING 1              02090000
RPTLTFT2 EQU   IPLRPT+38                LOST SUM FOOTING 2              02091000
RPTLTFT3 EQU   IPLRPT+41                                                02092000
*                                                                       02093000
         SPACE 2                                                        02094000
SW       DC    XL1'0'                   CONTROL SWITCH                  02095000
*  BIT 0 -     CCH RECORD BEING PROCESSED                               02096000
*  BIT 1 -     CHECK CLUSTER DUDING WRAPUP                              02097000
*  BIT 2 -     INITIAL CLUSTER SET UP COMPLETE                          02098000
*  BIT 3 -     IPL HEADING PRINT NOT REQUIRED                           02099000
*  BIT 4 -     CLUSTER TABLE SHIFT                                      02100000
*  BIT 5 -     CLUSTER TABLE FULL                                       02101000
*  BIT 6 -     START TIME STORED IN 'STRTIME'                           02102000
*  BIT 7 -     BYPASS NEXT RECORD READ                                  02103000
*                                                                       02104000
*                                                                       02105000
SW1      DC    XL1'0'                   CONTROL SWITCH                  02106000
*  BIT 0 -                                                              02107000
*  BIT 1 -                                                              02108000
*  BIT 2 -                                                              02109000
*  BIT 3 -                                                              02110000
*  BIT 4 -                                                              02111000
*  BIT 5 -                                                              02112000
*  BIT 6 -                                                              02113000
*  BIT 7 -                                                              02114000
         SPACE 2                                                        02115000
PH2SWS   DC    X'00'                                                    02116000
*  BIT 0 -     SI-IPL INCIDENT                                          02117000
*  BIT 1 -     FOUND IN TABLE                                           02118000
*  BIT 2 -     TABLE FULL                                               02119000
*  BIT 3 -                                                              02120000
*  BIT 4 -                                                              02121000
*  BIT 5 -                                                              02122000
*  BIT 6 -                                                              02123000
*  BIT 7 -                                                              02124000
         SPACE 3                                                        02125000
DTPATRN  DC    X'4020204B202020'            EDIT DATE YYDDD             02126000
DTPATTN  DC    X'4021204B20204B2020'         EDIT TIME                  02127000
LSPATRN  DC    X'402021204B20204B2020'                                  02128000
MNPATRN  DC    X'4020202020'            EDIT MEAN IPL                   02129000
MDPATRN  EQU   MNPATRN+1                EDIT MODEL #                    02130000
EDITSEQ  EQU   MNPATRN                  EDIT SEQUENCE #                 02131000
         EJECT                                                          02132000
*********************************************************************** 02133000
*        IPL REPORT  HEADING AND FOOTING CONSTANT AREA                * 02134000
*********************************************************************** 02135000
*                                                                       02136000
HEADLIN1 DC    C'STATISTICS OF IPL''S DUE TO ALL CAUSES ON THE MODEL '  02137000
HDMODEL  DC    C'XXX SYSTEM'                                            02138000
*                                                                       02139000
*                                                                       02140000
HEADLIN2 DC    C'STARTING DATE OF REPORT='                              02141000
HDDATE   DC    C' XX.XXX'                                               02142000
*                                                                       02143000
HEADLIN3 DC    C'IPL  RECORD'                                           02144000
*                                                                       02145000
HEADLIN4 DC    C'SEQUENCE#   DATE     TIME             REASON FOR IPL*' 02146000
         DC    C'             SUBSYSTEM RESPONSIBLE*   LOST TIME   '    02147000
         DC    C'CATEGORY*'                                             02148000
*                                                                       02149000
FOOTLIN1 DC    C'* PLEASE NOTE THIS INFORMATION WAS PROVIDED BY OPERAT' 02150000
         DC    C'OR.'                                                   02151000
*                                                                       02152000
FOOTLIN2 DC    C'ENDING DATE OF REPORT='                                02153000
FOOTDATE DC    C' XX.XXX'                                      @XA16800 02154000
FOOTLIN3 DC    C'REPORT IS ABBREVIATED DUE TO ERRONEOUS IPL RECORDS WH' 02155000
         DC    C'ICH ARE FLAGGED WITH **.'                     @XA16800 02156000
*                                                                       02157000
FOOTLIN4 DC    C'IPL CLUSTERING, MULTIPLE IPL''S BETWEEN '              02158000
FOOTIPL  DC    C'XX MINUTES'                                            02159000
*                                                                       02160000
FOOTLIN5 DC    C'GROUP '                                                02161000
FOOTGRUP DC    C' X = '                 CLUSTER GROUP #                 02162000
LOWCLUST DC    C'XX-'                   LOW SEQ                         02163000
HICLUST  DC    C'XX'                    HIGH SEQ                        02164000
*                                                                       02165000
WARNLINE DC    C'WARNING: ACCURACY DEPENDS ON USE OF HALT EOD WHEN '    02166000
         DC    C'ENDING OPERATION'                                      02167000
*                                                                       02168000
RPTEND   DC    C'END OF REPORT'                                         02169000
*                                                                       02170000
SUMHEAD  DC    C'LOST TIME SUMMARY'                                     02171000
*                                                                       02172000
SUMHEAD1 DC    C'CATEGORY      HARDWARE            SOFTWARE'            02173000
         DC    C'            '                                          02174000
TOTALLAB DC    C'TOTAL TIME -'                                          02175000
*                                                                       02176000
SUMHEAD2 DC    C'CNT    HRS/MIN      CNT    HRS/MIN      CNT    HRS/MINC02177000
               '                                                        02178000
*                                                                       02179000
PROCTM   DC    C'PROCESS TIME -'                                        02180000
AVRUNTIM DC    C'AVERAGE RUN TIME/IPL -'                                02181000
PRODAV   DC    C'PROD AVAILABILITY(',X'6C',C') -'                       02182000
AVLOSTTM DC    C'AVERAGE LOST TIME -'                                   02183000
         EJECT                                                          02184000
*********************************************************************** 02185000
*            LOST TIME SUMMARY AREA                                   * 02186000
*********************************************************************** 02187000
*                                                                       02188000
LOSTSUM  DC    24F'0'                   AREA RESERVED FOR               02189000
LOSTTIME EQU   LOSTSUM+4                 LOST TIME SUMMARY              02190000
         SPACE 3                                                        02191000
*********************************************************************** 02192000
*              CONTROL CARD BUFFER                                    * 02193000
*********************************************************************** 02194000
*                                                                       02195000
CTLCRD   DC    CL80' '                  CONTROL CARD                    02196000
         SPACE 1                                                        02197000
CCLEDGEN EQU   CTLCRD                   LEDGEN         CTLCRD           02198000
CCSTART  EQU   CTLCRD+10                START DATE     YYDDD            02199000
CCEND    EQU   CTLCRD+16                END DATE       YYDDD            02200000
CCCLUST  EQU   CTLCRD+22                IPL CLUSTER TIME                02201000
CCCUST   EQU   CTLCRD+25                CUSTOMER NAME                   02202000
         EJECT                                                          02203000
*********************************************************************** 02204000
*     WORK AREA --  USED BY PHASE 1 OF THIS PROGRAM                   * 02205000
*********************************************************************** 02206000
*                                                                       02207000
         DS    0F                                                       02208000
STRTIME  DC    F'0'               START TIME SEC                        02209000
NEGIND   DC   C'***'                                           @XA16800 02210000
STRTIMEP DC   F'0'                                             @XA16800 02211000
BNDRY    DC   F'0'                                             @XA16800 02212000
ALLONES  DC   X'FFFFFFFF'                                      @XA16800 02213000
ENDTIME  DC    XL4'7FFFFFFF'      END TIME SEC                          02214000
CLUSTIME DC    F'0'               CLUSTER TIME SEC                      02215000
CURRTIME DC    F'0'               CURRENT TIME IN SEC                   02216000
ELAPTIME DC    F'0'               ELAPSED TIME IN SEC                   02217000
FRSTTIME DC    F'0'                                                     02218000
LOSTTOT  DC    F'0'                                                     02219000
PREVSTRT DC    F'0'                HIGHEST PREVIOUS IPL TIME   @XA16800 02220000
SAVEDATE DC    F'0'                                                     02221000
SAVEDAT1 EQU   SAVEDATE+1                                               02222000
CONST4   DC    F'4'                                                     02223000
CONST8   DC    F'8'                                                     02224000
CONSTF   DC    F'15'                                                    02225000
CUAMASK  EQU   CONSTF+2                                                 02226000
ONEHUND  DC    F'100'                                                   02227000
FULLZERO DC    2F'0'                                                    02228000
BLANKS   DC    C'        '                                              02229000
REGSAVE  DC    2F'0'                                                    02230000
SEQNO    DC    F'0'               IPL SEQ NUMBER                        02231000
LASTINCT DC    F'0'               LAST INCIDENT TIME                    02232000
IPLINDX  DC    A(IPLTAB)          IPL TABLE PTR                         02233000
IPLHIDX  DC    A(IPLTAB)          IPL HI INDEX TABLE PTR                02234000
SEQINDX  DC    A(SEQTAB)          SEQ TABLE PTR                         02235000
SAVERDE  DC    F'0'                                                     02236000
SAVERET  DC    F'0'          SAVE  AREA FOR RETURN ADDRESS              02237000
MONTH    DC    F'2592000'                                               02238000
TWENFOUR DC    F'86400'                     TWENTYFOUR HRS IN SEC       02239000
SIXTY    DC    F'60'                        TIME BASED ON YR 1960       02240000
THRTYSIX DC    F'3600'                 NO OF SEC PER HOUR               02241000
DAYSYR   DC    F'365'                      REGULER YR                   02242000
PACKYR   DC    PL2'0'                                                   02243000
PACKYR1  EQU   PACKYR+1                                                 02244000
*                                                                       02245000
BWORK    DS    D'0'                     WORK AREA USED TO               02246000
BWORK5   EQU   BWORK+5                                                  02247000
BWORK6   EQU   BWORK+6                                                  02248000
BWORK7   EQU   BWORK+7                                                  02249000
*                                                                       02250000
JULIAN   EQU   BWORK+4                                                  02251000
JULIAN1  EQU   BWORK+5                                                  02252000
JULIAN2  EQU   BWORK+6                                                  02253000
JULIAN3  EQU   BWORK+7                                                  02254000
*                                                                       02255000
INVALUE  EQU   BWORK+6                                                  02256000
*                                                                       02257000
WORKTIME EQU   BWORK                                                    02258000
LOGHRS   EQU   BWORK                                                    02259000
LOGMIN   EQU   BWORK+1                                                  02260000
LOGSEC   EQU   BWORK+2                                                  02261000
*                                                                       02262000
EDITTIME EQU   BWORK                                                    02263000
EDITIME3 EQU   BWORK+3                                                  02264000
PRTWRKA  DC    F'0'                WORK AREA                   @XA16800 02265000
MASK0F   DC    X'0000000F'         MASK PCK DEC FIELD IND      @XA16800 02266000
ZONEF0   DC    X'000000F0'         MASK UNITS PCK DEC FIELD    @XA16800 02267000
CONSTB7  DC    X'000000B7'         FORMS ALPHA CHAR CODE       @XA16800 02268000
NINE     DC    F'9'                SET CONSTANT OF 9           @XA16800 02269000
BDDRSV   DS    4F'0'               SAVE AREA FOR REGS5-8       @XA16800 02270000
MAXLINCT DC    H'59'                                                    02271000
LINES    DC    XL2'0'                   LINE COUNT                      02272000
ALL9S    DC    X'999999'                                                02273000
ALL99S   DC    X'000999'                                                02274000
TEMPSSID DC    X'00'                    TEMP SAVE AREA-CONV SSID        02275000
CHANTAB  DC    C'0123456789ABCDEF'                                      02276000
*                                                                       02277000
CTLCRDTS DC    C'CTLCRD'                                                02278000
PTCHAREA DC    20F'0'                                                   02279000
ADDPATCH DC    S(PTCHAREA)                                              02280000
         SPACE 3                                                        02281000
IPLTABLE DSECT                    20 ELEMENTS                           02282000
IPLSEQ   DS    XL4                4 BYTE SEQ NO                         02283000
IPLSEQ2  EQU   IPLSEQ+2                                                 02284000
IPLTIME  DS    XL4                4 BYTE TIME  IN SECONDS               02285000
*                                                                       02286000
SEQTABLE DSECT                   250 ELEMENTS                           02287000
LOWSEQ   DS    XL2                LOW SEQ NO IN TABLE                   02288000
HISEQ    DS    XL2                HI  SEQ NO IN TABLE                   02289000
*                                                                       02290000
         DROP  R5                                                       02291000
         DROP  R7                                                       02292000
N0       EQU   0                                                        02293000
N1       EQU   1                                                        02294000
N2       EQU   2                                                        02295000
N3       EQU   3                                                        02296000
N4       EQU   4                                                        02297000
N5       EQU   5                                                        02298000
N6       EQU   6                                                        02299000
N7       EQU   7                                                        02300000
N8       EQU   8                                                        02301000
N9       EQU   9                                                        02302000
N10      EQU   10                                                       02303000
N11      EQU   11                                                       02304000
N12      EQU   12                                                       02305000
N13      EQU   13                                                       02306000
N14      EQU   14                                                       02307000
N16      EQU   16                                                       02308000
N17      EQU   17                                                       02309000
N18      EQU   18                                                       02310000
N19      EQU   19                                                       02311000
N20      EQU   20                                                       02312000
N21      EQU   21                                                       02313000
N22      EQU   22                                                       02314000
N25      EQU   25                                                       02315000
N27      EQU   27                                                       02316000
N29      EQU   29                                                       02317000
N31      EQU   31                                                       02318000
N32      EQU   32                                                       02319000
N49      EQU   49                                                       02320000
N50      EQU   50                                              @XA16800 02321000
N53      EQU   53                                                       02322000
N54      EQU   54                                                       02323000
N55      EQU   55                                                       02324000
N56      EQU   56                                                       02325000
N60      EQU   60                                                       02326000
N61      EQU   61                                                       02327000
N64      EQU   64                                                       02328000
N66      EQU   66                                                       02329000
N72      EQU   72                                                       02330000
N77      EQU   77                                              @XA16800 02331000
N80      EQU   80                                                       02332000
N112     EQU   112                                                      02333000
N119     EQU   119                                                      02334000
N120     EQU   120                                                      02335000
*                                                                       02336000
*                                                                       02337000
X00      EQU   X'00'                                                    02338000
X01      EQU   X'01'                                                    02339000
X02      EQU   X'02'                                                    02340000
X03      EQU   X'03'                                                    02341000
X04      EQU   X'04'                                                    02342000
X08      EQU   X'08'                                                    02343000
X0F      EQU   X'0F'                                                    02344000
X10      EQU   X'10'                                                    02345000
X20      EQU   X'20'                                                    02346000
X40      EQU   X'40'                                                    02347000
X60      EQU   X'60'                                                    02348000
X77      EQU   X'77'                                                    02349000
X70      EQU   X'70'                                                    02350000
X7F      EQU   X'7F'                                                    02351000
X80      EQU   X'80'                                                    02352000
X8F      EQU   X'8F'                                                    02353000
X90      EQU   X'90'                                           @XA16800 02354000
X99      EQU   X'99'                                                    02355000
X9F      EQU   X'9F'                                                    02356000
XA0      EQU   X'A0'                                                    02357000
XBF      EQU   X'BF'                                                    02358000
XC0      EQU   X'C0'                                                    02359000
XEF      EQU   X'EF'                                                    02360000
XF0      EQU   X'F0'                                                    02361000
XF7      EQU   X'F7'                                                    02362000
XF9      EQU   X'F9'                                                    02363000
XFB      EQU   X'FB'                                                    02364000
XFD      EQU   X'FD'                                           @XA16800 02365000
XFE      EQU   X'FE'                                                    02366000
XFF      EQU   X'FF'                                                    02367000
*                                                                       02368000
IFCRDESM CSECT                                                          02369000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02370000
@01      EQU   01                                                       02371000
@02      EQU   02                                                       02372000
@03      EQU   03                                                       02373000
@04      EQU   04                                                       02374000
@05      EQU   05                                                       02375000
@06      EQU   06                                                       02376000
@07      EQU   07                                                       02377000
@08      EQU   08                                                       02378000
@09      EQU   09                                                       02379000
@10      EQU   10                                                       02380000
@11      EQU   11                                                       02381000
@12      EQU   12                                                       02382000
@13      EQU   13                                                       02383000
@14      EQU   14                                                       02384000
@15      EQU   15                                                       02385000
R0       EQU   @00                                                      02386000
R1       EQU   @01                                                      02387000
R2       EQU   @02                                                      02388000
R3       EQU   @03                                                      02389000
R4       EQU   @04                                                      02390000
R5       EQU   @05                                                      02391000
R6       EQU   @06                                                      02392000
R7       EQU   @07                                                      02393000
R8       EQU   @08                                                      02394000
R9       EQU   @09                                                      02395000
R10      EQU   @10                                                      02396000
R12      EQU   @12                                                      02397000
R11      EQU   @11                                                      02398000
R13      EQU   @13                                                      02399000
R14      EQU   @14                                                      02400000
R15      EQU   @15                                                      02401000
IOHND    EQU   0                                                        02402000
IFCMSG   EQU   0                                                        02403000
PARM     EQU   0                                                        02404000
RECTYPE  EQU   PARM                                                     02405000
SWITCHES EQU   PARM+2                                                   02406000
DEBUG    EQU   PARM+4                                                   02407000
DEBUG4   EQU   DEBUG                                                    02408000
DEBUGA   EQU   PARM+8                                                   02409000
MISC     EQU   PARM+12                                                  02410000
PRINTES  EQU   MISC                                                     02411000
OPENCLSE EQU   PARM+13                                                  02412000
OPENIO   EQU   OPENCLSE                                                 02413000
CLOSEIO  EQU   OPENCLSE+2                                               02414000
DATENOW  EQU   PARM+17                                                  02415000
STDT     EQU   PARM+23                                                  02416000
STDATE   EQU   STDT                                                     02417000
PSTD     EQU   STDATE+1                                                 02418000
ENDDT    EQU   PARM+31                                                  02419000
ENDDATE  EQU   ENDDT                                                    02420000
PEND     EQU   ENDDATE+1                                                02421000
STTIME1  EQU   PARM+39                                                  02422000
ENDTIME1 EQU   PARM+43                                                  02423000
STTIME2  EQU   PARM+47                                                  02424000
ENDTIME2 EQU   PARM+51                                                  02425000
STRTDATE EQU   PARM+55                                                  02426000
ERRID    EQU   PARM+92                                                  02427000
IDTIMEA  EQU   ERRID+6                                                  02428000
IDTIME   EQU   IDTIMEA                                                  02429000
CCHHRLNG EQU   PARM+112                                                 02430000
ADIOHND  EQU   PARM+124                                                 02431000
ADIFCMSG EQU   PARM+128                                                 02432000
ADEDITB  EQU   PARM+132                                                 02433000
EVPTR    EQU   PARM+136                                                 02434000
SORTADR  EQU   PARM+140                                                 02435000
PRINTADR EQU   PARM+148                                                 02436000
CUAPTR   EQU   PARM+152                                                 02437000
DEVPTR   EQU   PARM+156                                                 02438000
MODPTR   EQU   PARM+160                                                 02439000
SERPTR   EQU   PARM+164                                                 02440000
VOLPTR   EQU   PARM+168                                                 02441000
CPUPTR   EQU   PARM+172                                                 02442000
CPCUAPTR EQU   PARM+176                                                 02443000
LIBADPTR EQU   PARM+180                                                 02444000
SYMCDPTR EQU   PARM+184                                                 02445000
SYSUMPTR EQU   PARM+188                                                 02446000
TRENPTR  EQU   PARM+192                                                 02447000
SHAREPTR EQU   PARM+196                                                 02448000
DUMPTABL EQU   PARM+200                                                 02449000
DUMPINFO EQU   DUMPTABL+4                                               02450000
TRENDONE EQU   0                                                        02451000
TREGEN   EQU   TRENDONE+8                                               02452000
TREND2   EQU   0                                                        02453000
TRENDKEY EQU   TREND2                                                   02454000
TRENDRT  EQU   TRENDKEY+1                                               02455000
TRENCPUS EQU   TRENDKEY+3                                               02456000
TRENDITM EQU   TRENDKEY+4                                               02457000
TRENDTMP EQU   TREND2+8                                                 02458000
EVTABLE  EQU   0                                                        02459000
EVSTOP   EQU   EVTABLE                                                  02460000
EVKEY    EQU   EVTABLE+6                                                02461000
SORTABLE EQU   0                                                        02462000
SORTKEY  EQU   SORTABLE                                                 02463000
SORTCCHR EQU   SORTABLE+5                                               02464000
SYSUMONE EQU   0                                                        02465000
SYSUM2   EQU   0                                                        02466000
SYSUMKEY EQU   SYSUM2                                                   02467000
SYSRT    EQU   SYSUMKEY+1                                               02468000
SYSCPUS  EQU   SYSUMKEY+3                                               02469000
SYSITEM  EQU   SYSUMKEY+4                                               02470000
SYSTEMP  EQU   SYSUM2+7                                                 02471000
SHARE    EQU   0                                                        02472000
SHAREIO  EQU   SHARE+2                                                  02473000
SHRCUCPU EQU   SHAREIO                                                  02474000
SHARECUA EQU   SHRCUCPU                                                 02475000
EDITLOAD EQU   0                                                        02476000
EDITABLE EQU   EDITLOAD+4                                               02477000
CUA      EQU   0                                                        02478000
CUAVAL   EQU   CUA+2                                                    02479000
DEVICE   EQU   0                                                        02480000
MODELS   EQU   0                                                        02481000
DEVSERAL EQU   0                                                        02482000
VOLUME   EQU   0                                                        02483000
CPUS     EQU   0                                                        02484000
CPUCUAS  EQU   0                                                        02485000
LIBADR   EQU   0                                                        02486000
SYMCODE  EQU   0                                                        02487000
SYMVAL   EQU   SYMCODE+2                                                02488000
LRTREC   EQU   0                                                        02489000
LRTKEY   EQU   LRTREC                                                   02490000
LRTKEY1  EQU   LRTKEY                                                   02491000
LRTSMS   EQU   LRTREC+2                                                 02492000
LRTERRID EQU   LRTREC+3                                                 02493000
LRTDATE  EQU   LRTREC+8                                                 02494000
LRTYRDAY EQU   LRTDATE+1                                                02495000
LRTTIME  EQU   LRTREC+12                                                02496000
LRTCPU   EQU   LRTREC+16                                                02497000
LRTCPMOD EQU   LRTCPU+1                                                 02498000
LRTMODEL EQU   LRTCPMOD+3                                               02499000
MCHREC   EQU   0                                                        02500000
MCHHEAD  EQU   MCHREC                                                   02501000
MCHKEY   EQU   MCHHEAD                                                  02502000
MCHSMS   EQU   MCHHEAD+2                                                02503000
MCHCPUID EQU   MCHHEAD+16                                               02504000
MCHLOG   EQU   MCHREC+48                                                02505000
CCHREC   EQU   0                                                        02506000
CCHHEAD  EQU   CCHREC                                                   02507000
CCHKEY   EQU   CCHHEAD                                                  02508000
CCHSMS   EQU   CCHHEAD+2                                                02509000
CCHCPUID EQU   CCHHEAD+16                                               02510000
CCHCODE  EQU   CCHREC+68                                                02511000
CCHCODE2 EQU   CCHCODE+2                                                02512000
CCHCUA   EQU   CCHREC+74                                                02513000
OBRREC   EQU   0                                                        02514000
OBRHEAD  EQU   OBRREC                                                   02515000
OBRKEY   EQU   OBRHEAD                                                  02516000
OBRSMS   EQU   OBRHEAD+2                                                02517000
MISCSW   EQU   OBRSMS                                                   02518000
OBRSUBTP EQU   OBRSMS+1                                                 02519000
OBRCPUID EQU   OBRHEAD+16                                               02520000
OBRJOBID EQU   OBRREC+24                                                02521000
OBRFCCW  EQU   OBRREC+32                                                02522000
OBRSRDS  EQU   OBRFCCW                                                  02523000
OBRCSW   EQU   OBRREC+40                                                02524000
OBRCODE  EQU   OBRREC+52                                                02525000
OBRDEV   EQU   OBRCODE+2                                                02526000
OBRPCUA  EQU   OBRREC+57                                                02527000
OBRSEEK  EQU   OBRREC+70                                                02528000
OBRTERMN EQU   OBRSEEK+2                                                02529000
SFTREC   EQU   0                                                        02530000
SFTHEAD  EQU   SFTREC                                                   02531000
SFTKEY   EQU   SFTHEAD                                                  02532000
SFTCPUID EQU   SFTHEAD+16                                               02533000
SFTSDWA  EQU   SFTREC+32                                                02534000
SFTAEC1  EQU   SFTSDWA+96                                               02535000
SFTFLGS  EQU   SFTSDWA+232                                              02536000
SFTRECP  EQU   SFTSDWA+292                                              02537000
IPLREC   EQU   0                                                        02538000
IPLHEAD  EQU   IPLREC                                                   02539000
IPLKEY   EQU   IPLHEAD                                                  02540000
IPLCPUID EQU   IPLHEAD+16                                               02541000
IPLSYSID EQU   IPLREC+24                                                02542000
IPLREAS  EQU   IPLREC+28                                                02543000
IPLTEMP  EQU   IPLREC+46                                                02544000
IPLSDATE EQU   IPLREC+48                                                02545000
IPLSTIME EQU   IPLREC+52                                                02546000
DDRREC   EQU   0                                                        02547000
DDRHEAD  EQU   DDRREC                                                   02548000
DDRKEY   EQU   DDRHEAD                                                  02549000
DDRSMS   EQU   DDRHEAD+2                                                02550000
DDRCPUID EQU   DDRHEAD+16                                               02551000
@NM00050 EQU   DDRREC+24                                                02552000
DDRFDEV  EQU   DDRREC+48                                                02553000
DDRCODE2 EQU   DDRFDEV+2                                                02554000
DDRTODEV EQU   DDRREC+56                                                02555000
MIHREC   EQU   0                                                        02556000
MIHHEAD  EQU   MIHREC                                                   02557000
MIHKEY   EQU   MIHHEAD                                                  02558000
MIHCPUID EQU   MIHHEAD+16                                               02559000
@NM00056 EQU   MIHREC+24                                                02560000
MIHDEV   EQU   MIHREC+44                                                02561000
MIHCODE2 EQU   MIHDEV+2                                                 02562000
EODREC   EQU   0                                                        02563000
EODHEAD  EQU   EODREC                                                   02564000
EODKEY   EQU   EODHEAD                                                  02565000
EODCPUID EQU   EODHEAD+16                                               02566000
TPRREC   EQU   0                                                        02567000
TPRHEAD  EQU   TPRREC                                                   02568000
TPRKEY   EQU   TPRHEAD                                                  02569000
TPRBUFC  EQU   TPRHEAD+5                                                02570000
TPRCPUID EQU   TPRHEAD+16                                               02571000
@NM00064 EQU   TPRREC+26                                                02572000
LOGCODE  EQU   LRTSMS+1                                                 02573000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02574000
DVBSDRE  EQU   TPRREC+56                                                02575000
@NM00066 EQU   TPRREC+39                                                02576000
TPRMODE  EQU   TPRREC+38                                                02577000
TPRLINAD EQU   TPRREC+36                                                02578000
@NM00065 EQU   TPRREC+34                                                02579000
TPRVOL   EQU   @NM00064                                                 02580000
TPRCUA   EQU   TPRREC+24                                                02581000
TPRCEL   EQU   TPRCPUID+6                                               02582000
TPRMODEL EQU   TPRCPUID+4                                               02583000
TPRSER   EQU   TPRCPUID+1                                               02584000
@NM00063 EQU   TPRCPUID                                                 02585000
TPRTIME  EQU   TPRHEAD+12                                               02586000
TPRDATE  EQU   TPRHEAD+8                                                02587000
@NM00062 EQU   TPRHEAD+6                                                02588000
TPRLENGT EQU   TPRBUFC                                                  02589000
@NM00061 EQU   TPRBUFC                                                  02590000
TPRDEV   EQU   TPRHEAD+4                                                02591000
TPRSMS   EQU   TPRHEAD+2                                                02592000
TPRKEY2  EQU   TPRKEY+1                                                 02593000
TPRKEY1  EQU   TPRKEY                                                   02594000
EODCEL   EQU   EODCPUID+6                                               02595000
EODMODEL EQU   EODCPUID+4                                               02596000
EODSER   EQU   EODCPUID+1                                               02597000
@NM00060 EQU   EODCPUID                                                 02598000
EODTIME  EQU   EODHEAD+12                                               02599000
EODDATE  EQU   EODHEAD+8                                                02600000
@NM00059 EQU   EODHEAD+5                                                02601000
EODDEV   EQU   EODHEAD+4                                                02602000
EODSMS   EQU   EODHEAD+2                                                02603000
EODKEY2  EQU   EODKEY+1                                                 02604000
EODKEY1  EQU   EODKEY                                                   02605000
MIHTYPE  EQU   MIHCODE2+1                                               02606000
MIHCLASS EQU   MIHCODE2                                                 02607000
@NM00058 EQU   MIHDEV                                                   02608000
MIHVOL   EQU   MIHREC+38                                                02609000
MIHCUA   EQU   MIHREC+35                                                02610000
@NM00057 EQU   @NM00056+8                                               02611000
MIHJOBID EQU   @NM00056                                                 02612000
MIHCEL   EQU   MIHCPUID+6                                               02613000
MIHMOD   EQU   MIHCPUID+4                                               02614000
MIHSER   EQU   MIHCPUID+1                                               02615000
@NM00055 EQU   MIHCPUID                                                 02616000
MIHTIME  EQU   MIHHEAD+12                                               02617000
MIHDATE  EQU   MIHHEAD+8                                                02618000
@NM00054 EQU   MIHHEAD+6                                                02619000
@NM00053 EQU   MIHHEAD+5                                                02620000
MIHDEBIT EQU   MIHHEAD+5                                                02621000
MIHCEBIT EQU   MIHHEAD+5                                                02622000
@NM00052 EQU   MIHHEAD+4                                                02623000
MIHSMS   EQU   MIHHEAD+2                                                02624000
MIHKEY2  EQU   MIHKEY+1                                                 02625000
MIHKEY1  EQU   MIHKEY                                                   02626000
DDRDEV2  EQU   DDRTODEV+2                                               02627000
DDRDEV1  EQU   DDRTODEV                                                 02628000
DDRTOCUA EQU   DDRREC+53                                                02629000
@NM00051 EQU   DDRREC+52                                                02630000
DDRTYPE  EQU   DDRCODE2+1                                               02631000
DDRCLASS EQU   DDRCODE2                                                 02632000
DDRCODE1 EQU   DDRFDEV                                                  02633000
DDRFCUA  EQU   DDRREC+45                                                02634000
DDRPHD   EQU   @NM00050+20                                              02635000
DDRVOL2  EQU   @NM00050+14                                              02636000
DDRVOL1  EQU   @NM00050+8                                               02637000
DDRJOBID EQU   @NM00050                                                 02638000
DDRCEL   EQU   DDRCPUID+6                                               02639000
DDRMOD   EQU   DDRCPUID+4                                               02640000
DDRSER   EQU   DDRCPUID+1                                               02641000
@NM00049 EQU   DDRCPUID                                                 02642000
DDRTIME  EQU   DDRHEAD+12                                               02643000
DDRDATE  EQU   DDRHEAD+8                                                02644000
@NM00048 EQU   DDRHEAD+4                                                02645000
DDRDEPSW EQU   DDRSMS+1                                                 02646000
@NM00047 EQU   DDRSMS                                                   02647000
DDRKEY2  EQU   DDRKEY+1                                                 02648000
DDRKEY1  EQU   DDRKEY                                                   02649000
IPLSHSEC EQU   IPLSTIME+3                                               02650000
IPLSSEC  EQU   IPLSTIME+2                                               02651000
IPLSMIN  EQU   IPLSTIME+1                                               02652000
IPLSHOUR EQU   IPLSTIME                                                 02653000
IPLHIGH  EQU   IPLREC+42                                                02654000
IPLCHAN  EQU   IPLREC+32                                                02655000
@NM00046 EQU   IPLREC+30                                                02656000
@NM00045 EQU   IPLREC+25                                                02657000
IPLCEL   EQU   IPLCPUID+6                                               02658000
IPLMOD   EQU   IPLCPUID+4                                               02659000
IPLSER   EQU   IPLCPUID+1                                               02660000
@NM00044 EQU   IPLCPUID                                                 02661000
IPLTIME  EQU   IPLHEAD+12                                               02662000
IPLDATE  EQU   IPLHEAD+8                                                02663000
@NM00043 EQU   IPLHEAD+4                                                02664000
IPLSMS   EQU   IPLHEAD+2                                                02665000
IPLKEY2  EQU   IPLKEY+1                                                 02666000
IPLKEY1  EQU   IPLKEY                                                   02667000
SFTXDATA EQU   SFTREC+434                                               02668000
SFTLVARA EQU   SFTREC+432                                               02669000
SFTREXN  EQU   SFTRECP+16                                               02670000
SFTCSECT EQU   SFTRECP+8                                                02671000
SFTMODN  EQU   SFTRECP                                                  02672000
@NM00042 EQU   SFTSDWA+238                                              02673000
SFTLCPUA EQU   SFTSDWA+236                                              02674000
SFTERRD  EQU   SFTFLGS+3                                                02675000
SFTERRC  EQU   SFTFLGS+2                                                02676000
SFTERRB  EQU   SFTFLGS+1                                                02677000
SFTERRA  EQU   SFTFLGS                                                  02678000
@NM00041 EQU   SFTSDWA+136                                              02679000
SFTAAEC1 EQU   SFTSDWA+120                                              02680000
@NM00040 EQU   SFTSDWA+112                                              02681000
SFTPROGC EQU   SFTAEC1+8                                                02682000
@NM00039 EQU   SFTAEC1                                                  02683000
@NM00038 EQU   SFTSDWA+88                                               02684000
SFTGRSV  EQU   SFTSDWA+24                                               02685000
SFTABNDC EQU   SFTSDWA                                                  02686000
SFTJOBID EQU   SFTREC+24                                                02687000
SFTCEL   EQU   SFTCPUID+6                                               02688000
SFTMOD   EQU   SFTCPUID+4                                               02689000
SFTSER   EQU   SFTCPUID+1                                               02690000
@NM00037 EQU   SFTCPUID                                                 02691000
SFTTIME  EQU   SFTHEAD+12                                               02692000
SFTDATE  EQU   SFTHEAD+8                                                02693000
@NM00036 EQU   SFTHEAD+4                                                02694000
SFTSMS   EQU   SFTHEAD+2                                                02695000
SFTKEY2  EQU   SFTKEY+1                                                 02696000
SFTKEY1  EQU   SFTKEY                                                   02697000
OBR34CT2 EQU   OBRTERMN+5                                               02698000
OBR34CT1 EQU   OBRTERMN+4                                               02699000
@NM00035 EQU   OBRTERMN                                                 02700000
@NM00034 EQU   OBRSEEK+1                                                02701000
OBRTCAM  EQU   OBRSEEK                                                  02702000
OBRVOL   EQU   OBRREC+64                                                02703000
OBRSBCNT EQU   OBRREC+62                                                02704000
OBRRETRY EQU   OBRREC+60                                                02705000
OBRLSDRC EQU   OBRREC+56                                                02706000
OBRTYPE  EQU   OBRDEV+1                                                 02707000
OBRCLASS EQU   OBRDEV                                                   02708000
OBRCODE1 EQU   OBRCODE                                                  02709000
OBRSECUA EQU   OBRREC+49                                                02710000
OBRDEVDC EQU   OBRREC+48                                                02711000
OBRSTAT  EQU   OBRCSW+4                                                 02712000
@NM00033 EQU   OBRCSW                                                   02713000
OBRSDRS2 EQU   OBRSRDS                                                  02714000
OBRSDRS1 EQU   OBRSRDS                                                  02715000
OBRSCUA  EQU   OBRJOBID+5                                               02716000
OBRSSDRC EQU   OBRJOBID+4                                               02717000
OBRSDEV2 EQU   OBRJOBID+2                                               02718000
OBRSDEV1 EQU   OBRJOBID                                                 02719000
OBRCEL   EQU   OBRCPUID+6                                               02720000
OBRMOD   EQU   OBRCPUID+4                                               02721000
OBRSER   EQU   OBRCPUID+1                                               02722000
@NM00032 EQU   OBRCPUID                                                 02723000
OBRTIME  EQU   OBRHEAD+12                                               02724000
OBRDATE  EQU   OBRHEAD+8                                                02725000
@NM00031 EQU   OBRHEAD+4                                                02726000
@NM00030 EQU   OBRSUBTP                                                 02727000
DISMOUNT EQU   OBRSUBTP                                                 02728000
@NM00029 EQU   OBRSUBTP                                                 02729000
SHORTSW  EQU   OBRSUBTP                                                 02730000
OBRTEMP  EQU   OBRSUBTP                                                 02731000
SDRCOUNT EQU   OBRSUBTP                                                 02732000
@NM00028 EQU   MISCSW                                                   02733000
TRUNC    EQU   MISCSW                                                   02734000
@NM00027 EQU   MISCSW                                                   02735000
OBRKEY2  EQU   OBRKEY+1                                                 02736000
OBRKEY1  EQU   OBRKEY                                                   02737000
CCHLOG   EQU   CCHREC+80                                                02738000
CCHMP    EQU   CCHREC+76                                                02739000
@NM00026 EQU   CCHREC+73                                                02740000
CCHID    EQU   CCHREC+72                                                02741000
CCHTYPE  EQU   CCHCODE2+1                                               02742000
CCHCLASS EQU   CCHCODE2                                                 02743000
CCHCODE1 EQU   CCHCODE                                                  02744000
CCHECSW  EQU   CCHREC+64                                                02745000
CCHCSW   EQU   CCHREC+56                                                02746000
CCHFCCW  EQU   CCHREC+48                                                02747000
CCHATIO  EQU   CCHREC+32                                                02748000
CCHJOBID EQU   CCHREC+24                                                02749000
CCHCEL   EQU   CCHCPUID+6                                               02750000
CCHMOD   EQU   CCHCPUID+4                                               02751000
CCHSER   EQU   CCHCPUID+1                                               02752000
@NM00025 EQU   CCHCPUID                                                 02753000
CCHTIME  EQU   CCHHEAD+12                                               02754000
CCHDATE  EQU   CCHHEAD+8                                                02755000
@NM00024 EQU   CCHHEAD+4                                                02756000
CCHRINC  EQU   CCHSMS+1                                                 02757000
@NM00023 EQU   CCHSMS                                                   02758000
CCHRCRH  EQU   CCHSMS                                                   02759000
@NM00022 EQU   CCHSMS                                                   02760000
CCHKEY2  EQU   CCHKEY+1                                                 02761000
CCHKEY1  EQU   CCHKEY                                                   02762000
MCHOPSW  EQU   MCHREC+40                                                02763000
MCHJOBID EQU   MCHREC+32                                                02764000
MCHPGMID EQU   MCHREC+24                                                02765000
MCHCEL   EQU   MCHCPUID+6                                               02766000
MCHMOD   EQU   MCHCPUID+4                                               02767000
MCHSER   EQU   MCHCPUID+1                                               02768000
@NM00021 EQU   MCHCPUID                                                 02769000
MCHTIME  EQU   MCHHEAD+12                                               02770000
MCHDATE  EQU   MCHHEAD+8                                                02771000
@NM00020 EQU   MCHHEAD+4                                                02772000
MCHSYSTR EQU   MCHSMS+1                                                 02773000
@NM00019 EQU   MCHSMS                                                   02774000
MCHKEY2  EQU   MCHKEY+1                                                 02775000
MCHKEY1  EQU   MCHKEY                                                   02776000
LRTMCEL  EQU   LRTCPU+6                                                 02777000
LRTCPUS  EQU   LRTCPMOD                                                 02778000
@NM00018 EQU   LRTCPU                                                   02779000
LRTHSECS EQU   LRTTIME+3                                                02780000
LRTSEC   EQU   LRTTIME+2                                                02781000
LRTMIN   EQU   LRTTIME+1                                                02782000
LRTHOUR  EQU   LRTTIME                                                  02783000
LRTDAY   EQU   LRTYRDAY+1                                               02784000
LRTYEAR  EQU   LRTYRDAY                                                 02785000
LRTDATE0 EQU   LRTDATE                                                  02786000
@NM00017 EQU   LRTREC+4                                                 02787000
LRTDSMNT EQU   LRTERRID                                                 02788000
@NM00016 EQU   LRTERRID                                                 02789000
LRTSHRT  EQU   LRTERRID                                                 02790000
@NM00015 EQU   LRTERRID                                                 02791000
@NM00014 EQU   LRTSMS                                                   02792000
LRTIMCNV EQU   LRTSMS                                                   02793000
@NM00013 EQU   LRTSMS                                                   02794000
LRTRUNC  EQU   LRTSMS                                                   02795000
LRNS     EQU   LRTSMS                                                   02796000
@NM00012 EQU   LRTSMS                                                   02797000
LRTKEY2  EQU   LRTKEY+1                                                 02798000
SYMVAL2  EQU   SYMVAL+2                                                 02799000
SYMVAL1  EQU   SYMVAL                                                   02800000
SYMCDNUM EQU   SYMCODE                                                  02801000
LIBVAL   EQU   LIBADR+2                                                 02802000
LIBADNUM EQU   LIBADR                                                   02803000
CPUCUAV  EQU   CPUCUAS+2                                                02804000
CPCUANUM EQU   CPUCUAS                                                  02805000
CPUVAL   EQU   CPUS+2                                                   02806000
CPUNUM   EQU   CPUS                                                     02807000
VOLVAL   EQU   VOLUME+2                                                 02808000
VOLNUM   EQU   VOLUME                                                   02809000
SERVAL   EQU   DEVSERAL+2                                               02810000
SERNUM   EQU   DEVSERAL                                                 02811000
MODVAL   EQU   MODELS+2                                                 02812000
MODNUM   EQU   MODELS                                                   02813000
MDRVAL   EQU   DEVICE+36                                                02814000
MDRNUM   EQU   DEVICE+34                                                02815000
DEVVAL   EQU   DEVICE+2                                                 02816000
DEVNUM   EQU   DEVICE                                                   02817000
CUA2     EQU   CUAVAL+2                                                 02818000
CUA1     EQU   CUAVAL                                                   02819000
CUANUM   EQU   CUA                                                      02820000
LOADPTR  EQU   EDITABLE+8                                               02821000
LOADNAME EQU   EDITABLE                                                 02822000
EDITNUM  EQU   EDITLOAD                                                 02823000
SHARLET  EQU   SHAREIO+10                                               02824000
SHARSERB EQU   SHAREIO+7                                                02825000
SHARECUB EQU   SHAREIO+5                                                02826000
SHARSERA EQU   SHRCUCPU+2                                               02827000
SHAREDX  EQU   SHARECUA                                                 02828000
SHARENUM EQU   SHARE                                                    02829000
@NM00011 EQU   SYSTEMP                                                  02830000
SYSPERM  EQU   SYSTEMP                                                  02831000
SYSDEV   EQU   SYSUM2+5                                                 02832000
SYSOLDA  EQU   SYSITEM                                                  02833000
SYS3705  EQU   SYSITEM                                                  02834000
SYSOLD   EQU   SYSCPUS                                                  02835000
SYSCPU   EQU   SYSCPUS                                                  02836000
SYSCUA   EQU   SYSRT                                                    02837000
SYSGROUP EQU   SYSUMKEY                                                 02838000
SYSUMEOD EQU   SYSUMONE+96                                              02839000
SYSUMPER EQU   SYSUMONE+92                                              02840000
SYSUMPEA EQU   SYSUMONE+88                                              02841000
SYSUMPEI EQU   SYSUMONE+84                                              02842000
SYSUMCH  EQU   SYSUMONE+20                                              02843000
SYSUMMCN EQU   SYSUMONE+16                                              02844000
SYSUMMCR EQU   SYSUMONE+12                                              02845000
SYSUMNXT EQU   SYSUMONE+8                                               02846000
SYSUMIPL EQU   SYSUMONE+4                                               02847000
SYSUMNUM EQU   SYSUMONE                                                 02848000
SORTCORE EQU   SORTCCHR                                                 02849000
SORTTIME EQU   SORTKEY+1                                                02850000
SORTYEAR EQU   SORTKEY                                                  02851000
EVLETTER EQU   EVKEY+5                                                  02852000
EVSERIAL EQU   EVKEY+2                                                  02853000
EVMODEL  EQU   EVKEY                                                    02854000
EVNUM    EQU   EVTABLE+4                                                02855000
EVDAY    EQU   EVSTOP+1                                                 02856000
EVYEAR   EQU   EVSTOP                                                   02857000
TRENDPRM EQU   TRENDTMP                                                 02858000
TRENDDEV EQU   TREND2+6                                                 02859000
TRENDDAT EQU   TRENDKEY+5                                               02860000
TRENDOD  EQU   TRENDITM                                                 02861000
TREND037 EQU   TRENDITM                                                 02862000
TRENDOLD EQU   TRENCPUS                                                 02863000
TRENDCPU EQU   TRENCPUS                                                 02864000
@NM00010 EQU   TRENDRT+1                                                02865000
TRENDCUA EQU   TRENDRT                                                  02866000
TRENDGRP EQU   TRENDKEY                                                 02867000
TREPRE   EQU   TREGEN+12                                                02868000
TRECCH   EQU   TREGEN+8                                                 02869000
TREMCH   EQU   TREGEN+4                                                 02870000
TREIPL   EQU   TREGEN                                                   02871000
TRENUM   EQU   TRENDONE+4                                               02872000
TRENEXT  EQU   TRENDONE                                                 02873000
DUMPSIZE EQU   DUMPINFO+4                                               02874000
DUMPADR  EQU   DUMPINFO                                                 02875000
DUMPNUM  EQU   DUMPTABL                                                 02876000
ADCPUT   EQU   PARM+144                                                 02877000
LINECT   EQU   PARM+120                                                 02878000
RECLNGTH EQU   CCHHRLNG+6                                               02879000
@NM00009 EQU   CCHHRLNG+5                                               02880000
RECCCHHR EQU   CCHHRLNG                                                 02881000
USERPGM  EQU   PARM+102                                                 02882000
IDTSEC   EQU   IDTIME+3                                                 02883000
IDSEC    EQU   IDTIME+2                                                 02884000
IDMIN    EQU   IDTIME+1                                                 02885000
IDHOUR   EQU   IDTIME                                                   02886000
IDASID   EQU   ERRID+4                                                  02887000
IDCPU    EQU   ERRID+3                                                  02888000
@NM00008 EQU   ERRID+2                                                  02889000
IDVALUE  EQU   ERRID                                                    02890000
NUMDAYS  EQU   PARM+88                                                  02891000
SORTNUM  EQU   PARM+84                                                  02892000
TABSIZE  EQU   PARM+80                                                  02893000
@NM00007 EQU   PARM+75                                                  02894000
@NM00006 EQU   PARM+72                                                  02895000
WRTHRSH  EQU   PARM+69                                                  02896000
RDTHRSH  EQU   PARM+66                                                  02897000
TERM     EQU   PARM+58                                                  02898000
EVSDAY   EQU   STRTDATE+1                                               02899000
EVSYEAR  EQU   STRTDATE                                                 02900000
PENSEC2  EQU   ENDTIME2+2                                               02901000
PENMIN2  EQU   ENDTIME2+1                                               02902000
PENHOUR2 EQU   ENDTIME2                                                 02903000
PSTSEC2  EQU   STTIME2+2                                                02904000
PSTMIN2  EQU   STTIME2+1                                                02905000
PSTHOUR2 EQU   STTIME2                                                  02906000
PENSEC1  EQU   ENDTIME1+2                                               02907000
PENMIN1  EQU   ENDTIME1+1                                               02908000
PENHOUR1 EQU   ENDTIME1                                                 02909000
PSTSEC1  EQU   STTIME1+2                                                02910000
PSTMIN1  EQU   STTIME1+1                                                02911000
PSTHOUR1 EQU   STTIME1                                                  02912000
@NM00005 EQU   ENDDT+4                                                  02913000
PENDY    EQU   PEND+1                                                   02914000
PENYR    EQU   PEND                                                     02915000
@NM00004 EQU   ENDDATE                                                  02916000
@NM00003 EQU   STDT+4                                                   02917000
PSTDY    EQU   PSTD+1                                                   02918000
PSTYR    EQU   PSTD                                                     02919000
@NM00002 EQU   STDATE                                                   02920000
YEARNOW  EQU   DATENOW+4                                                02921000
@NM00001 EQU   DATENOW+3                                                02922000
DAYNOW   EQU   DATENOW                                                  02923000
CSNAP    EQU   CLOSEIO                                                  02924000
CDRCTWRK EQU   CLOSEIO                                                  02925000
CSYSIN   EQU   CLOSEIO                                                  02926000
CACCDEV  EQU   CLOSEIO                                                  02927000
CACCIN   EQU   CLOSEIO                                                  02928000
CSERLOG  EQU   CLOSEIO                                                  02929000
CEREPPT  EQU   CLOSEIO                                                  02930000
CTOURIST EQU   CLOSEIO                                                  02931000
OSNAP    EQU   OPENIO                                                   02932000
ODRCTWRK EQU   OPENIO                                                   02933000
OSYSIN   EQU   OPENIO                                                   02934000
OACCDEV  EQU   OPENIO                                                   02935000
OACCIN   EQU   OPENIO                                                   02936000
OSERLOG  EQU   OPENIO                                                   02937000
OEREPPT  EQU   OPENIO                                                   02938000
OTOURIST EQU   OPENIO                                                   02939000
PASSFLAG EQU   MISC                                                     02940000
PLOGREC  EQU   MISC                                                     02941000
ERRORID  EQU   MISC                                                     02942000
PSUM     EQU   PRINTES                                                  02943000
PEDIT    EQU   PRINTES                                                  02944000
PHIST    EQU   MISC                                                     02945000
PACC     EQU   MISC                                                     02946000
PZERO    EQU   MISC                                                     02947000
DEBUG63  EQU   DEBUGA+3                                                 02948000
DEBUG62  EQU   DEBUGA+3                                                 02949000
DEBUG61  EQU   DEBUGA+3                                                 02950000
DEBUG60  EQU   DEBUGA+3                                                 02951000
DEBUG59  EQU   DEBUGA+3                                                 02952000
DEBUG58  EQU   DEBUGA+3                                                 02953000
DEBUG57  EQU   DEBUGA+3                                                 02954000
DEBUG56  EQU   DEBUGA+3                                                 02955000
DEBUG55  EQU   DEBUGA+2                                                 02956000
DEBUG54  EQU   DEBUGA+2                                                 02957000
DEBUG53  EQU   DEBUGA+2                                                 02958000
DEBUG52  EQU   DEBUGA+2                                                 02959000
DEBUG51  EQU   DEBUGA+2                                                 02960000
DEBUG50  EQU   DEBUGA+2                                                 02961000
DEBUG49  EQU   DEBUGA+2                                                 02962000
DEBUG48  EQU   DEBUGA+2                                                 02963000
DEBUG47  EQU   DEBUGA+1                                                 02964000
DEBUG46  EQU   DEBUGA+1                                                 02965000
DEBUG45  EQU   DEBUGA+1                                                 02966000
DEBUG44  EQU   DEBUGA+1                                                 02967000
DEBUG43  EQU   DEBUGA+1                                                 02968000
DEBUG42  EQU   DEBUGA+1                                                 02969000
DEBUG41  EQU   DEBUGA+1                                                 02970000
DEBUG40  EQU   DEBUGA+1                                                 02971000
DEBUG39  EQU   DEBUGA                                                   02972000
DEBUG38  EQU   DEBUGA                                                   02973000
DEBUG37  EQU   DEBUGA                                                   02974000
DEBUG36  EQU   DEBUGA                                                   02975000
DEBUG35  EQU   DEBUGA                                                   02976000
DEBUG34  EQU   DEBUGA                                                   02977000
DEBUG33  EQU   DEBUGA                                                   02978000
DEBUG32  EQU   DEBUGA                                                   02979000
DEBUG31  EQU   DEBUG+3                                                  02980000
DEBUG30  EQU   DEBUG+3                                                  02981000
DEBUG29  EQU   DEBUG+3                                                  02982000
DEBUG28  EQU   DEBUG+3                                                  02983000
DEBUG27  EQU   DEBUG+3                                                  02984000
DEBUG26  EQU   DEBUG+3                                                  02985000
DEBUG25  EQU   DEBUG+3                                                  02986000
DEBUG24  EQU   DEBUG+3                                                  02987000
DEBUG23  EQU   DEBUG+2                                                  02988000
DEBUG22  EQU   DEBUG+2                                                  02989000
DEBUG21  EQU   DEBUG+2                                                  02990000
DEBUG20  EQU   DEBUG+2                                                  02991000
DEBUG19  EQU   DEBUG+2                                                  02992000
DEBUG18  EQU   DEBUG+2                                                  02993000
DEBUG17  EQU   DEBUG+2                                                  02994000
DEBUG16  EQU   DEBUG+2                                                  02995000
DEBUG15  EQU   DEBUG+1                                                  02996000
DEBUG14  EQU   DEBUG+1                                                  02997000
DEBUG13  EQU   DEBUG+1                                                  02998000
DEBUG12  EQU   DEBUG+1                                                  02999000
DEBUG11  EQU   DEBUG+1                                                  03000000
DEBUG10  EQU   DEBUG+1                                                  03001000
DEBUG9   EQU   DEBUG+1                                                  03002000
DEBUG8   EQU   DEBUG+1                                                  03003000
DEBUG7   EQU   DEBUG                                                    03004000
DEBUG6   EQU   DEBUG                                                    03005000
DEBUG5   EQU   DEBUG                                                    03006000
DEBUG3   EQU   DEBUG                                                    03007000
DEBUG2   EQU   DEBUG                                                    03008000
DEBUG1   EQU   DEBUG                                                    03009000
DEBUG0   EQU   DEBUG                                                    03010000
SHIFT3RD EQU   SWITCHES+1                                               03011000
DEVEXCL  EQU   SWITCHES+1                                               03012000
ZEROALL  EQU   SWITCHES+1                                               03013000
NOTALL   EQU   SWITCHES+1                                               03014000
NOSDR    EQU   SWITCHES                                                 03015000
TIMESEQ  EQU   SWITCHES                                                 03016000
SYSUM    EQU   SWITCHES                                                 03017000
PARMTHR  EQU   SWITCHES                                                 03018000
TREND    EQU   SWITCHES                                                 03019000
SHORTOBR EQU   SWITCHES                                                 03020000
PARMMES  EQU   SWITCHES                                                 03021000
RDESUM   EQU   SWITCHES                                                 03022000
PTTYP    EQU   RECTYPE+1                                                03023000
PEOD     EQU   RECTYPE                                                  03024000
PMIH     EQU   RECTYPE                                                  03025000
PDDR     EQU   RECTYPE                                                  03026000
PIPL     EQU   RECTYPE                                                  03027000
PSOFT    EQU   RECTYPE                                                  03028000
POBR     EQU   RECTYPE                                                  03029000
PCHAN    EQU   RECTYPE                                                  03030000
PMCH     EQU   RECTYPE                                                  03031000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      03032000
@ENDDATA EQU   *                                                        03033000
         END   IFCRDESM,(C'PLS1816',0701,78039)                         03034000
