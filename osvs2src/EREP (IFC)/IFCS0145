         TITLE 'IFCS0145 MODEL  145 MACHINE CHECK SUMMARY'              00090002
*                                                                       00180002
*                                                                       00270002
*  LINE MACRO     LINE MACRO     LINE MACRO     LINE MACRO            * 00360004
         MACRO                                                          00430004
&NAME    LINE  &DATA,&LABEL,&SKIP=                                      00500004
.*                            THIS MACRO ESTABLISHES THE MARGINS OR     00570004
.*                                 COLUMN SETTINGS FOR EACH LINE. IT    00640004
.*                                 GENERATES NECESSARY CARRIAGE CONTROL 00710004
.*                                 ENTRIES. LASTLY IT DETERMINES THE    00780004
.*                                 NUMBER OF ENTRIES ASSOCIATED WITH    00850004
.*                                 THE PREVIOUS LINE AND STORES THAT #  00920004
.*                                 INTO THE APPROPRIATE BYTE.           00990004
.*                                 &DATA(1) - CHARACTER POSITION TO     01060004
.*                                 BEGIN DATA.                          01130004
.*                                                                      01200004
.*                                 &DATA(2) - # OF SPACES BETWEEN       01270004
.*                                 SUCCESSIVE DATA COLUMN STARTING      01340004
.*                                 CHARACTERS.                          01410004
.*                                                                      01480004
.*                                 &LABEL(1) - CHARACTER POSITION       01550004
.*                                 TO BEGIN LABELS.                     01620004
.*                                                                      01690004
.*                                 &LABEL(2) - # OF SPACES BETWEEN      01760004
.*                                 LINE'S LABEL STARTING CHARACTERS.    01830004
.*                                                                      01900004
.*                                 &SKIP= - # OF LINES TO ADVANCE       01970004
.*                                 CARRIAGE TO BEGIN NEXT PRINTED LINE. 02040004
.*                                                                      02110004
.*                                 NEW ENTRIES ARE GENERATED ONLY WHEN  02180004
.*                                 NECESSARY. OMISSION OF ITEMS MEANS   02250004
.*                                 THEY HAVE NOT CHANGED SINCE PREVIOUS 02320004
.*                                 SETTINGS. A LINE MACRO IS REQUIRED   02390004
.*                                 FOR EACH PRINTED LINE. IF NO SETTING 02460004
.*                                 CHANGES ARE REQUIRED ALL OPERANDS    02530004
.*                                 ARE OMITTED IN WHICH CASE ONLY THE   02600004
.*                                 # OF ENTRIES FOR THE PREVIOUS LINE   02670004
.*                                 FIRST MACRO INSTRUCTION ISSUED FOR   02740004
.*                                 THE SUBJECT LINE.                    02810004
         GBLA  &DB,&DT,&LB,&LT,&NRENTS                                  02880004
         GBLA  &LASTCC,&INITIAL                                         02950004
         GBLC  &NRENTSX                                                 03020004
         GBLC  &CARRCON                                                 03090004
         GBLB  &TEST                                                    03160004
         LCLA  &S                                                       03230004
&NAME    DS    0C                                                       03300004
         AIF   (&INITIAL EQ 0).FIRSTLN                                  03370004
         LINEND                                                         03440004
         AGO   .NTFIRST                                                 03510004
.FIRSTLN ANOP                                                           03580004
&NRENTSX SETC  'N&SYSNDX'                                               03650004
&INITIAL SETA  1                                                        03720004
&LASTCC  SETA  1                                                        03790004
N&SYSNDX EQU   *                                                        03860004
.NTFIRST ANOP                                                           03930004
         DC    AL1(0)                                                   04000004
         AIF   ('&DATA(1)' EQ '').CKDTABS                               04070004
         AIF   ('&DATA'(1,1) NE '(').SLABEL                             04140004
         AIF   (&DATA(1) EQ &DB).CKDTABS                                04210004
&DB      SETA  &DATA(1)                                                 04280004
         AGO   .AA                                                      04350004
.CKDTABS AIF   ('&DATA(2)' EQ '').NCDATA                                04420004
         AIF   (&DATA(2) EQ &DT).NCDATA                                 04490004
         AGO   .CC                                                      04560004
.AA      AIF   ('&DATA(2)' EQ '').BB                                    04630004
         AIF   (&DATA(2) EQ &DT).BB                                     04700004
.CC      ANOP                                                           04770004
&DT      SETA  &DATA(2)                                                 04840004
.BB      DC    XL2'FFFE'                                                04910004
         DC    FL1'&DB'                                                 04980004
         DC    FL1'&DT'                                                 05050004
&NRENTS  SETA  &NRENTS+1                                                05120004
.NCDATA  ANOP                                                           05190004
         AIF   ('&LABEL(1)' EQ '').CKLTABS                              05260004
         AIF   ('&LABEL'(1,1) NE '(').SLABEL                            05330004
         AIF   (&LABEL(1) EQ &LB).CKLTABS                               05400004
&LB      SETA  &LABEL(1)                                                05470004
         AGO   .AAA                                                     05540004
.CKLTABS AIF   ('&LABEL(2)' EQ '').NCLABEL                              05610004
         AIF   (&LABEL(2) EQ &LT).NCLABEL                               05680004
         AGO   .CCC                                                     05750004
.AAA     AIF   ('&LABEL(2)' EQ '').BBB                                  05820004
         AIF   (&LABEL(2) EQ &LT).BBB                                   05890004
.CCC     ANOP                                                           05960004
&LT      SETA  &LABEL(2)                                                06030004
.BBB     DC    XL2'FFFF'                                                06100004
         DC    FL1'&LB'                                                 06170004
         DC    FL1'&LT'                                                 06240004
&NRENTS  SETA  &NRENTS+1                                                06310004
.NCLABEL ANOP                                                           06380004
         AIF   ('&SKIP' EQ 'E').EJECT                                   06450004
         AIF   ('&SKIP' EQ '').TESTOFF                                  06520004
.CONT    ANOP                                                           06590004
         AIF   (&TEST EQ 0).AB                                          06660004
         AIF   (&SKIP EQ &LASTCC).TESTOFF                               06730004
&S       SETA  &SKIP                                                    06800004
         ORG   &CARRCON+3                                               06870004
         DC    AL.3(0),AL.2(&S),AL.3(1)                                 06940004
         ORG                                                            07010004
&LASTCC  SETA  &S                                                       07080004
.SLABEL  ANOP                                                           07150004
.TESTOFF ANOP                                                           07220004
&TEST    SETB  0                                                        07290004
         AGO   .DD                                                      07360004
.EJECT   DC    XL2'FFFB'                                                07430004
&NRENTS  SETA  &NRENTS+1                                                07500004
         DC    X'8B'              SKIP TO CHANNEL 1                     07570004
         DC    AL.3(0),AL.2(&LASTCC),AL.3(1)                            07640004
&TEST    SETB  1                                                        07710004
         AGO   .DD                                                      07780004
.AB      AIF   (&SKIP EQ &LASTCC).NOCHANG                               07850004
A&SYSNDX DC    XL2'FFFB'                                                07920004
         DC    AL.3(0),AL.2(&SKIP),AL.3(1)                              07990004
         DC    AL.3(0),AL.2(&SKIP),AL.3(1)                              08060004
&LASTCC  SETA  &SKIP                                                    08130004
&TEST    SETB  1                                                        08200004
&CARRCON SETC  'A&SYSNDX'                                               08270004
&NRENTS  SETA  &NRENTS+1                                                08340004
.DD      ANOP                                                           08410004
.NOCHANG ANOP                                                           08480004
         MEND                                                           08550004
         EJECT                                                          08620004
         SPACE 2                                                        08690004
*  ROUTINE MACRO     ROUTINE MACRO     ROUTINE MACRO     ROUTINE MACRO* 08760004
         MACRO                                                          08830004
&NAME    ROUTINE &LOGITEM,&RNAME                                        08900004
         GBLC  &DSECT,&CSECT                                            08970004
         GBLC  &ITEM(1000)                                              09040004
         GBLA  &SHIFT(1000),&ITEMNBR                                    09110004
         GBLA  &NRENTS                                                  09180004
         LCLA  &ISHIFT,&NDX                                             09250004
.LOOP    ANOP                                                           09320004
&NDX     SETA  &NDX+1                                                   09390004
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      09460004
         AIF   (&NDX LT &ITEMNBR).LOOP                                  09530004
         MNOTE *,'LOG ITEM NOT DEFINED'                                 09600004
         MEXIT                                                          09670004
.FOUND   ANOP                                                           09740004
&ISHIFT  SETA  &SHIFT(&NDX)                                             09810004
&NAME    DC    AL.12(&LOGITEM-&DSECT),XL.4'D'                           09880004
         DC    AL.4(&ISHIFT),AL.12(&RNAME-&CSECT)                       09950004
&NRENTS  SETA  &NRENTS+1                                                10020004
         MEND                                                           10090004
*  DSGEN MACRO     DSGEN MACRO     DSGEN MACRO     DSGEN MACRO        * 10160004
         SPACE 2                                                        10230004
         MACRO                                                          10300004
&NAME    DSGEN &X1,&X2,&X3,&X4,&X5,&X6,&X7,&X8,&X9,&X10,&X11,&X12,&X13,X10370004
               &X14,&X15,&X16,&X17,&X18,&X19,&X20,&X21,&X22,&X23,&X24, X10440004
               &X25,&X26,&X27,&X28,&X29,&X30,&X31,&X32                  10510004
.*                            THIS MACRO GENERATES ONE DSECT WORD       10580004
.*                                 FORMATTED FOR THE SUBJECT LOG RECORD 10650004
.*                                 EACH OPERAND HAS TWO SUB LISTS. THE  10720004
.*                                 FIRST IS THE NAME OF THE LOG ITEM    10790004
.*                                 WHILE THE SECOND IS THE # OF BITS TO 10860004
.*                                 ALLOCATE FOR THIS ITEM. ITEMS MUST   10930004
.*                                 BE DEFINED CONTIGUOUSLY WITHOUT GAPS 11000004
.*                                 UNUSED BIT GROUPS MUST BE GIVEN      11070004
.*                                 DUMMY NAMES. THE NAMES PROVIDED FOR  11140004
.*                                 THE LOG ITEMS MAY THEN BE USED IN    11210004
.*                                 THE CONVERSION MACRO INSTRUCTIONS.   11280004
         GBLC &ITEM(1000)                                               11350004
         GBLA &ITEMNBR,&BITS(1000),&SHIFT(1000)                         11420004
         LCLC  &SYMBOL                                                  11490004
         LCLA  &OP,&COUNT,&BYTE                                         11560004
.LOOP    ANOP                                                           11630004
&OP      SETA  &OP+1                                                    11700004
&ITEMNBR SETA  &ITEMNBR+1                                               11770004
&SYMBOL  SETC  '&SYSLIST(&OP,1)'                                        11840004
         AIF   ('&SYSLIST(&OP,2)' NE '').OK1                            11910004
         MNOTE *,'NULL BIT COUNT FIELD'                                 11980004
         MEXIT                                                          12050004
.OK1     ANOP                                                           12120004
         AIF   ('&SYMBOL' NE '').OK                                     12190004
         MNOTE 'LOG ITEM SYMBOL NOT PROVIDED'                           12260004
         AGO   .CNT                                                     12330004
.OK      ANOP                                                           12400004
         AIF   ('&SYMBOL'(1,1) EQ '''').CNT                *TEMP*       12470004
&SYMBOL  EQU   *+&BYTE                                                  12540004
&ITEM(&ITEMNBR)  SETC '&SYSLIST(&OP,1)'                                 12610004
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2)                                    12680004
&SHIFT(&ITEMNBR) SETA &COUNT-&BYTE*8                                    12750004
.CNT     ANOP                                                           12820004
&COUNT   SETA  &COUNT+&SYSLIST(&OP,2)                                   12890004
&BYTE    SETA  &COUNT/8                                                 12960004
         AIF (&OP LT N'&SYSLIST).LOOP                                   13030004
         AIF   (&COUNT NE 32).NOT32                                     13100004
&NAME    DS    4C                                                       13170004
         MEXIT                                                          13240004
.NOT32   AIF   (&COUNT NE 64).ERR                                       13310004
&NAME    DS    8C                                                       13380004
         MEXIT                                                          13450004
.ERR     MNOTE '**BIT COUNT FIELDS DO NOT TOTAL 32 OR 64**'             13520004
         MEND                                                           13590004
         MACRO                                                          13660004
         LINEND                                                         13730004
.*                            THIS MACRO IS USED ONLY BY THE LINE       13800004
.*                                 MACRO TO SET THE NUMBER OF ENTRIES   13870004
.*                                 ASSOCIATED WITH EACH LINE.           13940004
         GBLA  &NRENTS                                                  14010004
         GBLC &NRENTSX                                                  14080004
         ORG   &NRENTSX                                                 14150004
         DC    FL1'&NRENTS'                                             14220004
         ORG                                                            14290004
&NRENTS  SETA  0                                                        14360004
B&SYSNDX EQU   *                                                        14430004
&NRENTSX SETC  'B&SYSNDX'                                               14500004
         MEND                                                           14570004
         SPACE 2                                                        14640004
         EJECT                                                          14710004
*  LABEL MACRO     LABEL MACRO     LABEL MACRO     LABEL MACRO        * 14780004
         SPACE 2                                                        14850004
         MACRO                                                          14920004
&NAME    LABEL &LABEL1,&LABEL2,&LABEL3,&LABEL4,&LABEL5,&LABEL6,        C14990004
               &LABEL7,&LABEL8                                          15060004
.*                            THIS MACRO ALLOWS UP TO ACHT LABELS TO    15130004
.*                                 BE SPECIFIED FOR A GIVEN LINE. THE   15200004
.*                                 LABELS SHOULD BE ENCLOSED IN QUOTA-  15270004
.*                                 TION MARKS. THE COLUMN AND LINE END  15340004
.*                                 CONTROLS WILL BE INSERTED BY THE     15410004
.*                                 MACRO. OMITTED OPERANDS MEAN NO      15480004
.*                                 LABEL REQUIRED FOR RESPECTIVE        15550004
.*                                 COLUMN. THIS MACRO WILL ALSO ALERT   15620004
.*                                 THE PROGRAMMER TO EXACTLY WHERE THE  15690004
.*                                 TABLE MUST BE BROKEN IF NECESSARY    15760004
.*                                 TO AVOID EXCEEDING THE MAXIMUM LIMIT 15830004
         GBLC &LABELS(2000)                                             15900004
         GBLC  &LBL(100)                                                15970004
         GBLA  &LBLCTR(100)                                             16040004
         GBLA  &LABELNR                                                 16110004
         GBLA  &NRENTS,&LPTR                                            16180004
         LCLC  &MARGIN,&TACK                                            16250004
         LCLC  &TEXT                                                    16320004
         LCLA  &OP,&K,&START,&NRCHAR,&REMAIN                            16390004
&MARGIN  SETC  '*'                                                      16460004
         AIF   ('&NAME' EQ '').LOOPOUT                                  16530004
&LPTR    SETA  &LPTR+1                                                  16600004
&LBL(&LPTR) SETC '&NAME'                                                16670004
&LBLCTR(&LPTR) SETA &LABELNR+1                                          16740004
.LOOPOUT ANOP                                                           16810004
&OP      SETA  &OP+1                                                    16880004
&K       SETA  K'&SYSLIST(&OP)                                          16950004
         AIF (&K GE 2).NORM                                             17020004
&K       SETA  2                                                        17090004
.NORM    ANOP                                                           17160004
&START   SETA  2                                                        17230004
         AIF (&OP LT N'&SYSLIST).NOTLAST                                17300004
&MARGIN  SETC  '$'                                                      17370004
.NOTLAST ANOP                                                           17440004
&NRCHAR  SETA  8                                                        17510004
&TACK    SETC  ''                                                       17580004
.LOOPIN  ANOP                                                           17650004
&REMAIN  SETA  &K-&START                                                17720004
         AIF (&REMAIN GE 8).MORE                                        17790004
&TACK    SETC  '&MARGIN'                                                17860004
&NRCHAR  SETA  &REMAIN                                                  17930004
.MORE    ANOP                                                           18000004
&TEXT    SETC  ''                                                       18070004
         AIF (&REMAIN EQ 0).ENDTEXT                                     18140004
&TEXT    SETC  '&SYSLIST(&OP)'(&START,&NRCHAR)                          18210004
.ENDTEXT ANOP                                                           18280004
&LABELNR SETA  &LABELNR+1                                               18350004
&LABELS(&LABELNR) SETC '&TEXT'.'&TACK'                                  18420004
&START   SETA  &START+8                                                 18490004
         AIF ('&TACK' EQ '').LOOPIN                                     18560004
         AIF ('&TACK' EQ '*').LOOPOUT                                   18630004
         MEND                                                           18700004
         SPACE 2                                                        18770004
         MACRO                                                          18840004
         LSTART                                                         18910004
.*                            THIS MACRO IS ISSUED WHEN THE LABEL AREA  18980004
.*                                 OF THE TABLE IS TO BEGIN.            19050004
         GBLC &LABELS(2000)                                             19120004
         GBLA  &LABELNR                                                 19190004
         GBLC  &LBL(100)                                                19260004
         GBLA  &LBLCTR(100)                                             19330004
         LCLA  &NDX,&CTR                                                19400004
         LINEND                                                         19470004
&CTR     SETA  1                                                        19540004
.LOOP    ANOP                                                           19610004
&NDX     SETA  &NDX+1                                                   19680004
         AIF   (&LBLCTR(&CTR) NE &NDX).NOLBL                            19750004
&LBL(&CTR) DC  C'&LABELS(&NDX)'                                         19820004
&CTR     SETA  &CTR+1                                                   19890004
         AGO   .LOOPCTL                                                 19960004
.NOLBL   ANOP                                                           20030004
         DC    C'&LABELS(&NDX)'                                         20100004
.LOOPCTL AIF   (&NDX LT &LABELNR).LOOP                                  20170004
         MEND                                                           20240004
         SPACE 2                                                        20310004
*  BIN MACRO     BIN MACRO     BIN MACRO     BIN MACRO     BIN MACRO  * 20380004
         SPACE 2                                                        20450004
         MACRO                                                          20520004
         BIN   &LOGITEM,&SKIP$OR                                        20590004
.*                                 &LOGITEM - NAME OF ITEM IN LOG       20660004
.*                                      RECORD DSECT                    20730004
.*                                 &SKIP$OR - NBR OF SPACES TO SKIP ON  20800004
.*                                 MULTIPLE PRINT OR NBR OF SPACES      20870004
.*                                      TO BACK UP FROM COLUMN FOR      20940004
.*                                      START OF PRINTING. THE LETTER   21010004
.*                                      B PRECEEDS THE NUMBER (B5) IF   21080004
.*                                      THE LATTER IS DESIRED. OMISSION 21150004
.*                                      OF THIS OPERAND FORCES OPTION 2 21220004
.*                                      WITH BACKUP SPACING EQUAL TO    21290004
.*                                 THE NUMBER OF BITS IN THE ITEM       21360004
.*                                 DEFINITION (VIA MACRO 'DSGEN').      21430004
.*                            A LIMIT OF 15 BITS IS IMPOSED FOR THE     21500004
.*                                 TOTAL NUMBER OF BITS TO PRINT.       21570004
         GBLC &ITEM(1000)                                               21640004
         GBLA &ITEMNBR,&BITS(1000),&SHIFT(1000),&NRENTS                 21710004
         GBLC  &DSECT                                                   21780004
         LCLB  &B                                                       21850004
         LCLA  &IBITS,&NDX,&ISHIFT,&K                                   21920004
         LCLA  &TEMP,&T                                                 21990004
         LCLC  &S                                                       22060004
.LOOP    ANOP                                                           22130004
&NDX     SETA  &NDX+1                                                   22200004
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      22270004
         AIF   (&NDX LT &ITEMNBR).LOOP                                  22340004
         MNOTE *,'YOU BLEW IT'                                          22410004
         ROUTINE DUM,SKIPPER                                            22480004
         MEXIT                                                          22550004
.FOUND   ANOP                                                           22620004
&ISHIFT  SETA  &SHIFT(&NDX)                                             22690004
&IBITS   SETA  &BITS(&NDX)                                              22760004
&T       SETA  &IBITS-1                                                 22830004
&B       SETB  0                                                        22900004
         AIF   ('&SKIP$OR' EQ '').BACKUP                                22970004
&K       SETA  K'&SKIP$OR                                               23040004
&B       SETB  ('&SKIP$OR'(1,1) EQ 'B')                                 23110004
&S       SETC  '&SKIP$OR'(&B+1,&K-&B)                                   23180004
&T       SETA  &S                                                       23250004
.BACKUP  ANOP                                                           23320004
&NRENTS  SETA  &NRENTS+1                                                23390004
&TEMP    SETA  &ISHIFT                                                  23460004
A&SYSNDX DC    AL.12(&LOGITEM-&DSECT),XL.4'&TEMP'                       23530004
         AIF (&IBITS EQ 1 AND &B EQ 0).OUT                              23600004
         ORG   A&SYSNDX                                                 23670004
&B       SETB  1                                                        23740004
         DC    AL.12(&LOGITEM-&DSECT),XL.4'C'                           23810004
         DC    BL.1'&B',AL.7(&T),AL.4(&IBITS),FL.4'&ISHIFT'             23880004
.OUT     ANOP                                                           23950004
         MEND                                                           24020004
         EJECT                                                          24090004
*  HEX MACRO     HEX MACRO     HEX MACRO    HEXN MACRO     HEX MACRO  * 24160004
         SPACE 2                                                        24230004
         MACRO                                                          24300004
         HEX   &LOGITEM,&SKIP$OR,&BYTES                                 24370004
.*                            THIS MACRO FACILITATES GENERATION OF THE  24440004
.*                                 TABLE ENTRIES SPECIFYING HEX TYPE    24510004
.*                                 CONVERSIONS.                         24580004
.*                            &LOGITEM - NAME OF DATA ITEM TO BE        24650004
.*                                 CONVERTED                            24720004
.*                            &SKIP$OR - NUMBER OF SPACES TO SKIP ON    24790004
.*                                 MULTIPLE PRINT OR NBR OF SPACES TO   24860004
.*                                 BACK UP FROM COLUMN FOR START OF     24930004
.*                                 PRINTING. THE LETTER B PRECEEDS THE  25000004
.*                                 NUMBER (B8) IF THE LATTER OPTION IS  25070004
.*                                 DESIRED. OMISSION OF THIS OPERAND    25140004
.*                                 FORCES OPTION 2 WITH BACKUP SPACING  25210004
.*                                 EQUAL TO THE NUMBER OF BYTES SPECI-  25280004
.*                                 FIED BY THE NEXT OPERAND (TWICE THIS 25350004
.*                                 NUMBER IF SUFFIX IS EXPLICITLY OR    25420004
.*                                 IMPLICITLY B).                       25490004
.*                            &BYTES - NUMBER OF TOTAL INPUT BYTES TO   25560004
.*                                 PROCESS. THIS NUMBER IS SUFFIXED     25630004
.*                                 WITH AN L,R, OR B TO STIPULATE       25700004
.*                                 PRINTING OF THE LEFT HALF, RIGHT     25770004
.*                                 HALF, OR BOTH HALVES OF THE BYTE     25840004
.*                                 RESPECTIVELY. OMISSION OF THIS       25910004
.*                                 OPERAND DEFAULTS TO B WITH THE NUM-  25980004
.*                                 BER OF BYTES EQUAL TO THE ITEM LNGTH 26050004
.*                            A NEW ENTRY IS GENERATED ONLY WHEN NECES- 26120004
.*                                 SARY. THIS MACRO MUST BE THE FIRST   26190004
.*                                 MACRO INSTRUCTION ISSUED FOR THE     26260004
.*                                 SUBJECT LINE(S).                     26330004
         GBLC &ITEM(1000),&DSECT                                        26400004
         GBLA &ITEMNBR,&BITS(1000),&SHIFT(1000),&NRENTS                 26470004
         LCLB  &B                                                       26540004
         LCLA  &IBITS,&NDX,&ISHIFT,&K,&T,&CODE,&BYTESP                  26610004
         LCLC  &S,&LETTER                                               26680004
.LOOP    ANOP                                                           26750004
&NDX     SETA  &NDX+1                                                   26820004
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      26890004
         AIF   (&NDX LT &ITEMNBR).LOOP                                  26960004
         MNOTE *,'LOG ITEM NOT DEFINED'                                 27030004
         MEXIT                                                          27100004
.FOUND   ANOP                                                           27170004
&ISHIFT  SETA  &SHIFT(&NDX)                                             27240004
&IBITS   SETA  &BITS(&NDX)                                              27310004
&CODE    SETA  1                                                        27380004
&K       SETA  K'&BYTES                                                 27450004
         AIF   (&IBITS-(&IBITS/4)*4 EQ 0).OK                            27520004
         MNOTE *,'BIT LENGTH SPECIFICATION INCONSISTENT WITH CONTROL'   27590004
         MEXIT                                                          27660004
.OK      AIF   ('&BYTES' EQ '').USEDEFN                                 27730004
&LETTER  SETC  '&BYTES'(&K,1)                                           27800004
&S       SETC  '&BYTES'(1,&K-1)                                         27870004
&BYTESP  SETA  &S                                                       27940004
         AIF   ('&LETTER' EQ 'B').BOTH                                  28010004
         AIF   (&ISHIFT EQ 0 OR &ISHIFT EQ 4).OK2                       28080004
.ERR     MNOTE *,'DATA NOT ALLIGNED ON HEX OR BYTE BOUNDARY'            28150004
         MEXIT                                                          28220004
.USEDEFN ANOP                                                           28290004
&BYTESP  SETA  &IBITS/8                                                 28360004
.BOTH    AIF   (&ISHIFT NE 0).ERR                                       28430004
&CODE    SETA  3                                                        28500004
&T       SETA  &BYTESP*2-1                                              28570004
&S       SETC  '&T'                                                     28640004
.OK2     AIF   (&ISHIFT EQ 0).L                                         28710004
&CODE    SETA  2                                                        28780004
.L       ANOP                                                           28850004
&B       SETB  1                                                        28920004
         AIF   ('&SKIP$OR' EQ '').BACKUP                                28990004
&K       SETA  K'&SKIP$OR                                               29060004
&B       SETB  ('&SKIP$OR'(1,1) EQ 'B')                                 29130004
&S       SETC  '&SKIP$OR'(&B+1,&K-&B)                                   29200004
.BACKUP  ANOP                                                           29270004
&NRENTS  SETA  &NRENTS+1                                                29340004
         DC    AL.12(&LOGITEM-&DSECT),XL.4'A'                           29410004
         DC    BL.1'&B',FL.7'&S',FL.4'&BYTESP',FL.4'&CODE'              29480004
.OUT     ANOP                                                           29550004
         MEND                                                           29620004
         MACRO                                                          29690004
         SPECIAL  &ROUTINE,&PARAM,&SPACE=                               29760004
.*                            THIS MACRO GENERATES A SPECIAL ROUTINE    29830004
.*                                 ENTRY TO BE PROCESSED BY THE SUM. M. 29900004
.*                            &ROUTINE - SYMBOL ON SPECIAL ROUTINE EWT. 29970004
.*                            &PARAM - AN 8 BIT BINARY REPRESENTATION   30040004
.*                                 TO OCCUPY THE 'MASK' FIELD BUT TO BE 30110004
.*                                 INTERPRETED AS AN ARGUMENT OF THE    30180004
.*                                 SPECIAL ROUTINE.                     30250004
.*                            &SPACE - THE NUMBER OF 2BYTE COUNTERS TO  30320004
.*                                 ALLOCATE FOR REQUIRED PROCESSING.    30390004
         GBLC  &CSECT                                                   30460004
         GBLA  &COUNTR                                                  30530004
         LCLA  &ADD                                                     30600004
         DC    AL1(128)                                                 30670004
         DC    BL.8'&PARAM'                                             30740004
         DC    AL2(&ROUTINE-&CSECT)                                     30810004
         DC    AL2(&COUNTR)                                             30880004
&ADD     SETA  1                                                        30950004
         AIF   ('&SPACE' EQ '').NORM                                    31020004
&ADD     SETA  &SPACE                                                   31090004
.NORM    ANOP                                                           31160004
&COUNTR  SETA  &COUNTR+&ADD                                             31230004
         MEND                                                           31300004
         MACRO                                                          31370004
         SUM   &LOGITEM,&MASK                                           31440004
.*                            THIS MACRO GENERATES A NORMAL EDIT ENTRY  31510004
.*                                 FOR PROCESSING BY THE SUMMARY MODULE 31580004
.*                            &LOGITEM - NAME OF DATA ITEM TO BE SUMMED 31650004
.*                            &MASK - BYTE MASK FOR BITS TO BE TESTED.  31720004
.*                                 THIS OPERAND SHOULD BE OMITTED FOR   31790004
.*                                 SINGLE BIT ITEMS IN WHICH CASE THE   31860004
.*                                 MASK WILL BE SET ACCORDING TO THE    31930004
.*                                 OFF BYTE BIT DISPLACEMENT OF THE     32000004
.*                                ITEM AS DEFINED BY THE MACRO 'DSGEN'  32070004
         GBLA  &COUNTR,&ITEMNBR,&BITS(1000),&SHIFT(1000)                32140004
         GBLC  &ITEM(1000),&DSECT                                       32210004
         LCLA  &IBITS,&NDX,&ISHIFT,&M,&BITNBR                           32280004
.LOOP    ANOP                                                           32350004
&NDX     SETA  &NDX+1                                                   32420004
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      32490004
         AIF   (&NDX LT &ITEMNBR).LOOP                                  32560004
         MNOTE *,'LOGITEM NOT FOUND'                                    32630004
         MEXIT                                                          32700004
.FOUND   ANOP                                                           32770004
         DC    AL1(0)                                                   32840004
&ISHIFT  SETA  &SHIFT(&NDX)                                             32910004
&IBITS   SETA  &BITS(&NDX)                                              32980004
         AIF   ('&MASK' EQ '').FORM                                     33050004
         DC    B'&MASK'                                                 33120004
         AGO   .ITEM                                                    33190004
.FORM    ANOP                                                           33260004
&BITNBR  SETA  &ISHIFT-7                                                33330004
&BITNBR  SETA  0-&BITNBR                                                33400004
&M       SETA  1                                                        33470004
.LOOP2   ANOP                                                           33540004
         AIF   (&BITNBR EQ 0).GOTIT                                     33610004
&M       SETA  &M*2                                                     33680004
&BITNBR  SETA  &BITNBR-1                                                33750004
         AGO   .LOOP2                                                   33820004
.GOTIT   ANOP                                                           33890004
         DC    AL1(&M)                                                  33960004
.ITEM    DC    AL2(&LOGITEM-&DSECT)                                     34030004
         DC    AL2(&COUNTR)                                             34100004
&COUNTR  SETA  &COUNTR+1                                                34170004
         MEND                                                           34240004
         GBLC  &DSECT,&CSECT                                            34310004
&CSECT   SETC  'IFCS0145'                                               38880002
&DSECT   SETC  'S0002'                                                  38970002
IFCS0145 CSECT                                                          39060002
         USING *,R9                                                     39150002
S0002    DSECT                                                          39240002
         DSGEN (CLASRC,8),(SYSREL,8),(SWITCHES,16)                      39330002
         DSGEN (SPARE1,32)                                              39420002
         DSGEN (DATE,32)                                                39510002
         DSGEN (HOUR,32)                                                39600002
         DSGEN (SPARE2,8),(CPUSERL,24)                                  39690002
         DSGEN (CPUID,16),(XDUM1,16)                                    39780002
         DS    77F                                               A45391 39870002
         DSGEN (MCHRG00,1),(MCHRG01,1),(MCHRG02,1),(MCHRG03,1),        X39960002
               (MCHRG04,1),(MCHRG05,1),(MCHRG06,1),(MCHRG07,1),        X40050002
               (MCHRG08,1),(MCHRG09,1),(MCHRG10,1),(MCHRG11,1),        X40140002
               (MCHRG12,1),(MCHRG13,1),(MCHRG14,1),(MCHRG15,1),        X40230002
               (MCHRG16,1),(MCHRG17,1),(MCHRG18,1),(MCHRG19,1),        X40320002
               (MCHRG20,1),(MCHRG21,1),(MCHRG22,1),(MCHRG23,1),        X40410002
               (MCHRG24,1),(MCHRG25,1),(MCHRG26,1),(MCHRG27,1),        X40500002
               (MCHRG28,1),(MCHRG29,1),(MCHRG30,1),(MCHRG31,1)          40590002
         DSGEN (MCHRGB00,1),(MCHRGB01,1),(MCHRGB02,1),(MCHRGB03,1),    X40680002
               (MCHRGB04,1),(MCHRGB05,1),(MCHRGB06,1),(MCHRGB07,1),    X40770002
               (MCHRGB08,1),(MCHRGB09,1),(MCHRGB10,1),(MCHRGB11,1),    X40860002
               (MCHRGB12,1),(MCHRGB13,1),(MCHRGB14,1),(MCHRGB15,1),    X40950002
               (MCHRGB16,1),(MCHRGB17,1),(MCHRGB18,1),(MCHRGB19,1),    X41040002
               (MCHRGB20,1),(MCHRGB21,1),(MCHRGB22,1),(MCHRGB23,1),    X41130002
               (MCHRGB24,1),(MCHRGB25,1),(MCHRGB26,1),(MCHRGB27,1),    X41220002
               (MCHRGB28,1),(MCHRGB29,1),(MCHRGB30,1),(MCHRGB31,1)      41310002
         DSGEN (RTYREG1,32),(RTYREG2,32)                                41400002
         DSGEN (REGUNU,8),                                             X41490002
               (HREG0,1),(HREG1,1),(HREG2,1),(HREG3,1),(HREG4,1),      X41580002
               (HREG5,1),(HREG6,1),(HREG7,1),(RETRG23,16)               41670002
         DSGEN (RTYRG400,1),(RTYRG401,1),(RTYRG402,1),(RTYRG403,1),    X41760002
               (RTYRG404,1),(RTYRG405,1),(RTYRG406,1),(RTYRG407,1),    X41850002
               (RTYRG408,1),(RTYRG409,1),(RTYRG410,1),(RTYRG411,1),    X41940002
               (RTYRG412,1),(RTYRG413,1),(RTYRG414,1),(RTYRG415,1),    X42030002
               (RTRUNSED,1),(RTYRG417,3),(RTYRG420,3),(RTYUNSD,2),     X42120002
               (RTYRG425,3),(RTYRG428,3),(RTYNOTUS,1)                   42210002
         DSGEN (CTRLDWD,32)                                             42300002
         DSGEN (SYSREG00,1),(SYSREG01,1),(SYSREG02,1),(SYSREG03,1),    X42390002
               (SYSREG04,1),(SYSREG05,1),(SYSREG06,1),(SYSREG07,1),    X42480002
               (SYSREG08,1),(SYSREG09,1),(SYSREG10,1),(SYSREG11,1),    X42570002
               (SYSREG12,1),(SYSREG13,1),(SYSREG14,1),(SYSREG15,1),    X42660002
               (SYSREG16,1),(SYSREG17,1),(SYSREG18,1),(SYSREG19,1),    X42750002
               (SYSREG20,1),(SYSREG21,1),(SYSREG22,1),(SYSREG23,1),    X42840002
               (SYSREG24,1),(SYSREG25,1),(SYSREG26,1),(SYSREG27,1),    X42930002
               (SYSREG28,1),(SYSREG29,1),(SYSREG30,1),(SYSREG31,1)      43020002
IFCS0145 CSECT                                                          43110002
         USING S0002,R2                                                 43200002
         DC    A(ENTRIES)                                               43290002
         DC    A(PEDIT)                                                 43380002
         DC    F'0'                                                     43470002
         DC    H'310'                                                   43560002
R0       EQU   0                                                        43650002
R1       EQU   1                                                        43740002
R2       EQU   2                                                        43830002
R3       EQU   3                                                        43920002
R4       EQU   4                                                        44010002
R5       EQU   5                                                        44100002
R6       EQU   6                                                        44190002
R7       EQU   7                                                        44280002
R8       EQU   8                                                        44370002
R9       EQU   9                                                        44460002
R10      EQU   10                                                       44550002
R11      EQU   11                                                       44640002
R12      EQU   12                                                       44730002
R13      EQU   13                                                       44820002
R14      EQU   14                                                       44910002
R15      EQU   15                                                       45000002
L0       EQU   0                                                        45090002
L1       EQU   1                                                        45180002
L2       EQU   2                                                        45270002
L3       EQU   3                                                        45360002
L4       EQU   4                                                        45450002
L5       EQU   5                                                        45540002
L6       EQU   6                                                        45630002
L7       EQU   7                                                        45720002
L8       EQU   8                                                        45810002
L10      EQU   10                                                       45900002
L12      EQU   12                                                       45990002
L13      EQU   13                                                       46080002
L18      EQU   18                                                       46170002
L28      EQU   28                                                       46260002
XSAVE    DS    6F                                                       46350002
HEX00    DC    F'0'                                                     46440002
*                                                                       46530002
*        SPECIAL ROUTINES                                               46620002
*                                                                       46710002
XDATE1   STM   R4,R8,XSAVE              SAVE REGS                       46800002
         LA    R5,L0(R3)                GET OUTDSELT POINTER RIGHT      46890002
         CLC   DATE(L4),HEX00           IS DATE ZERO                    46980002
         BE    RETURN                                                   47070002
         CLC   L0(L4,R3),HEX00          IS LOW DATE ZERO                47160002
         BNE   XDATE2                   BR-NO                           47250002
         MVC      L0(L4,R3),DATE                 MOVE IN DATE           47340002
XDATE2   CLC   DATE(L4),L0(R3)          CHECK FOR LOW DATE              47430002
         BL    SAVELOW                  LOWER SAVE IT                   47520002
         CLC   DATE(L4),L4(R3)          CHECK FOR HI                    47610002
         BNH   RETURN                   BR-NOT HI                       47700002
SAVEHI   MVC   L4(L4,R3),DATE           MOVE HI DATE                    47790002
         B     RETURN                                                   47880002
SAVELOW  MVC   L0(L4,R3),DATE           MOVE LOW DATE                   47970002
         B     RETURN                                                   48060002
RETURN   LM    R4,R8,XSAVE              RESTORE REGS                    48150002
         BR    R14                      GO BACK                         48240002
ENTRIES  EQU   *                                                        48330002
         SPECIAL XDATE1,00000000,SPACE=4                                48420002
         SUM   MCHRG00                                                  48510002
         SUM   MCHRG01                                                  48600002
         SUM   MCHRG02                                                  48690002
         SUM   MCHRG03                                                  48780002
         SUM   MCHRG04                                                  48870002
         SUM   MCHRG05                                                  48960002
         SUM   MCHRG06                                                  49050002
         SUM   MCHRG07                                                  49140002
         SUM   MCHRG08                                                  49230002
         SUM   MCHRG09                                                  49320002
         SUM   MCHRG10                                                  49410002
         SUM   MCHRG11                                                  49500002
         SUM   MCHRG12                                                  49590002
         SUM   MCHRG13                                                  49680002
         SUM   MCHRG14                                                  49770002
         SUM   MCHRG15                                                  49860002
         SUM   MCHRG16                                                  49950002
         SUM   MCHRG17                                                  50040002
         SUM   MCHRG18                                                  50130002
         SUM   MCHRG19                                                  50220002
         SUM   MCHRG20                                                  50310002
         SUM   MCHRG21                                                  50400002
         SUM   MCHRG22                                                  50490002
         SUM   MCHRG23                                                  50580002
         SUM   MCHRG24                                                  50670002
         SUM   MCHRG25                                                  50760002
         SUM   MCHRG26                                                  50850002
         SUM   MCHRG27                                                  50940002
         SUM   MCHRG28                                                  51030002
         SUM   MCHRG29                                                  51120002
         SUM   MCHRG30                                                  51210002
         SUM   MCHRG31                                                  51300002
         SUM   MCHRGB00                                                 51390002
         SUM   MCHRGB01                                                 51480002
         SUM   MCHRGB02                                                 51570002
         SUM   MCHRGB03                                                 51660002
         SUM   MCHRGB04                                                 51750002
         SUM   MCHRGB05                                                 51840002
         SUM   MCHRGB06                                                 51930002
         SUM   MCHRGB07                                                 52020002
         SUM   MCHRGB08                                                 52110002
         SUM   MCHRGB09                                                 52200002
         SUM   MCHRGB10                                                 52290002
         SUM   MCHRGB11                                                 52380002
         SUM   MCHRGB12                                                 52470002
         SUM   MCHRGB13                                                 52560002
         SUM   MCHRGB14                                                 52650002
         SUM   MCHRGB15                                                 52740002
         SUM   MCHRGB16                                                 52830002
         SUM   MCHRGB17                                                 52920002
         SUM   MCHRGB18                                                 53010002
         SUM   MCHRGB19                                                 53100002
         SUM   MCHRGB20                                                 53190002
         SUM   MCHRGB21                                                 53280002
         SUM   MCHRGB22                                                 53370002
         SUM   MCHRGB23                                                 53460002
         SUM   MCHRGB24                                                 53550002
         SUM   MCHRGB25                                                 53640002
         SUM   MCHRGB26                                                 53730002
         SUM   MCHRGB27                                                 53820002
         SUM   MCHRGB28                                                 53910002
         SUM   MCHRGB29                                                 54000002
         SUM   MCHRGB30                                                 54090002
         SUM   MCHRGB31                                                 54180002
         SUM   HREG0                                                    54270002
         SUM   HREG1                                                    54360002
         SUM   HREG2                                                    54450002
         SUM   HREG3                                                    54540002
         SUM   HREG4                                                    54630002
         SUM   HREG5                                                    54720002
         SUM   HREG6                                                    54810002
         SUM   HREG7                                             A45391 54900002
         SUM   RTYRG408                                                 54990002
         SUM   RTYRG409                                                 55080002
         SUM   RTYRG410                                                 55170002
         SUM   RTYRG411                                                 55260002
         SUM   RTYRG412                                                 55350002
         SUM   RTYRG413                                                 55440002
         SUM   RTYRG414                                                 55530002
         SUM   RTYRG415                                                 55620002
         SUM   SYSREG00                                                 55710002
         SUM   SYSREG01                                                 55800002
         SUM   SYSREG02                                                 55890002
         SUM   SYSREG03                                                 55980002
         SUM   SYSREG04                                                 56070002
         SUM   SYSREG05                                                 56160002
         SUM   SYSREG06                                                 56250002
         SUM   SYSREG07                                                 56340002
         SUM   SYSREG08                                                 56430002
         SUM   SYSREG09                                                 56520002
         SUM   SYSREG10                                                 56610002
         SUM   SYSREG11                                                 56700002
         SUM   SYSREG12                                                 56790002
         SUM   SYSREG13                                                 56880002
         SUM   SYSREG14                                                 56970002
         SUM   SYSREG15                                                 57060002
         SUM   SYSREG16                                                 57150002
         SUM   SYSREG17                                                 57240002
         SUM   SYSREG18                                                 57330002
         SUM   SYSREG19                                                 57420002
         SUM   SYSREG20                                                 57510002
         SUM   SYSREG21                                                 57600002
         SUM   SYSREG22                                                 57690002
         SUM   SYSREG23                                                 57780002
         SUM   SYSREG24                                                 57870002
         SUM   SYSREG25                                                 57960002
         SUM   SYSREG26                                                 58050002
         SUM   SYSREG27                                                 58140002
         SUM   SYSREG28                                                 58230002
         SUM   SYSREG29                                                 58320002
         SUM   SYSREG30                                                 58410002
         SUM   SYSREG31                                                 58500002
QUIT     DC    X'FF'                                                    58590002
PEDIT    DS    0F                                                       58680002
&DSECT   SETC  'YYYY2'                                                  58770002
&CSECT   SETC  'PEDIT'                                                  58860002
         USING *,R9                                                     58950002
         USING YYYY2,R2                                                 59040002
*                                                                       59130002
*        EDIT AND PRINT SECTION                                         59220002
*                                                                       59310002
         DC    A(PENTRY)                                                59400002
         DC    C'IFCS0145'                                              59490002
YR9PTR   DS    F                                                        59580002
YLABEL   DS    F                                                        59670002
YYYY2    DSECT                                                          59760002
         DS    3H                                                       59850002
         DSGEN (YDUMA,16),(YNOREC,16)                                   59940002
         DSGEN (YTYPE,8),(YCHAN,8),(YCUA,24),(YSER,24)                  60030002
         DSGEN (YCPU,16),(YSMSW,16)                                     60120002
         DSGEN (YDATES,64)                                              60210002
         DSGEN (CTR100,16),(CTR101,16),(CTR102,16),(CTR103,16)          60300002
         DSGEN (CTR104,16),(CTR105,16),(CTR106,16),(CTR107,16)          60390002
         DSGEN (CTR108,16),(CTR109,16),(CTR110,16),(CTR111,16)          60480002
         DSGEN (CTR112,16),(CTR113,16),(CTR114,16),(CTR115,16)          60570002
         DSGEN (CTR116,16),(CTR117,16),(CTR118,16),(CTR119,16)          60660002
         DSGEN (CTR120,16),(CTR121,16),(CTR122,16),(CTR123,16)          60750002
         DSGEN (CTR124,16),(CTR125,16),(CTR126,16),(CTR127,16)          60840002
         DSGEN (CTR128,16),(CTR129,16),(CTR130,16),(CTR131,16)          60930002
         DSGEN (CTR200,16),(CTR201,16),(CTR202,16),(CTR203,16)          61020002
         DSGEN (CTR204,16),(CTR205,16),(CTR206,16),(CTR207,16)          61110002
         DSGEN (CTR208,16),(CTR209,16),(CTR210,16),(CTR211,16)          61200002
         DSGEN (CTR212,16),(CTR213,16),(CTR214,16),(CTR215,16)          61290002
         DSGEN (CTR216,16),(CTR217,16),(CTR218,16),(CTR219,16)          61380002
         DSGEN (CTR220,16),(CTR221,16),(CTR222,16),(CTR223,16)          61470002
         DSGEN (CTR224,16),(CTR225,16),(CTR226,16),(CTR227,16)          61560002
         DSGEN (CTR228,16),(CTR229,16),(CTR230,16),(CTR231,16)          61650002
         DSGEN (CTR300,16),(CTR301,16),(CTR302,16),(CTR303,16)          61740002
         DSGEN (CTR304,16),(CTR305,16),(CTR306,16),(CTR307,16)          61830002
         DSGEN (CTR308,16),(CTR309,16),(CTR310,16),(CTR311,16)          61920002
         DSGEN (CTR312,16),(CTR313,16),(CTR314,16),(CTR315,16)          62010002
         DSGEN (CTR400,16),(CTR401,16),(CTR402,16),(CTR403,16)          62100002
         DSGEN (CTR404,16),(CTR405,16),(CTR406,16),(CTR407,16)          62190002
         DSGEN (CTR408,16),(CTR409,16),(CTR410,16),(CTR411,16)          62280002
         DSGEN (CTR412,16),(CTR413,16),(CTR414,16),(CTR415,16)          62370002
         DSGEN (CTR416,16),(CTR417,16),(CTR418,16),(CTR419,16)          62460002
         DSGEN (CTR420,16),(CTR421,16),(CTR422,16),(CTR423,16)          62550002
         DSGEN (CTR424,16),(CTR425,16),(CTR426,16),(CTR427,16)          62640002
         DSGEN (CTR428,16),(CTR429,16),(CTR430,16),(CTR431,16)          62730002
IFCS0145 CSECT                                                          62820002
WORK     DS    D                                                        62910002
XSAVE1   DC    5F'0'                                                    63000002
SIZE     DC    H'310'                                                   63090002
FSAVE    DS    18F                                                      63180002
*                                                                       63270002
*        SPECIAL ROUTINES                                               63360002
*                                                                       63450002
CONVERT  STM   R5,R8,XSAVE1             SAVE REGS                       63540002
         LH    R5,L0(R4)                PICK UP COUNT                   63630002
         CVD   R5,WORK                  CONVERT TO DECIMAL              63720002
         UNPK  L0(L5,R3),WORK+L5(L3)    UNPACK TO PRINT BUFF            63810002
         MVZ   L4(L1,R3),L0(R3)         PUT IN TIGHT ZONE               63900002
         B     RETURNA                  RETURN                          63990002
RETURNA  LM    R5,R8,XSAVE1             RESTORE REGS                    64080002
         BR    R14                      RETURN                          64170002
FREECTR  STM   R14,R12,L12(R13)                                         64260002
         LR    R12,R13                                                  64350002
         LA    R13,FSAVE                                                64440002
         ST    R12,L4(R13)                                              64530002
         ST    R13,L8(R12)                                              64620002
         L     R3,L4(R2)                PICK UP NXT CTR POINTER         64710002
         ST    R3,L28(R12)              SET IT IN SAVED REG 2           64800002
         LH    R0,SIZE                  PICK UP SIZE                    64890002
         LR    R1,R2                    SET POINTER                     64980002
         FREEMAIN R,LV=(0),A=(1)                                        65070002
         LTR   R3,R3                    ANY MORE AREAS TO PRINT         65160002
         BZ    RETURNO                  BR-NO                           65250002
         LA    R5,PENTRY+L10            SET POINTERS                    65340002
         LA    R6,LABELS-L1             TO RELLOOP                      65430002
         ST    R5,YR9PTR                                                65520002
         ST    R6,YLABEL                                                65610002
RETURNO  L     R13,L4(R13)              RESET TO CALLRS REGS            65700002
         LM    R14,R12,L12(R13)         RESET REGS                      65790002
         BR    R14                                                      65880002
SETDATES UNPK  WORK(L8),L0(L4,R4)       UNPACK LOW DATE                 65970002
         MVZ   WORK+L7(L1),WORK         MOVE IN RIGHT ZONE              66060002
         MVC   L0(L3,R3),WORK+L5        PUT DATE IN PTR BUFF            66150002
         MVC   L5(L2,R3),WORK+L3        PUT YEAR IN PTR BUFF            66240002
         UNPK  WORK(L8),L4(L4,R4)       UNPACK HIGH DATE                66330002
         MVZ   WORK+L7(L1),WORK         MOVE IN RIGHT ZONE              66420002
         MVC   L13(L3,R3),WORK+L5       PUT DATE IN PTR BUFF            66510002
         MVC   L18(L2,R3),WORK+L3       PUT YEAR IN PTR BUFF            66600002
         BR    R14                                                      66690002
CHKMOD   CLI   1(R4),X'48'         IS THIS A 148                        66700004
         BNER  R14                 NO                                   66710004
         MVC   MODLAB1+7(2),X48    MOVE IN 148                          66720004
         MVC   MODLAB2+20(2),X48   MOVE IN 148                          66730004
         MVC   MODLAB3+14(21),INCDEC                                    66732004
         MVC   MODLAB4+14(4),MULTIPLY                                   66734004
         MVC   MODLAB5(29),CNTSHIFT                                     66736004
         BR    R14                                                      66740004
INCDEC   DC    CL21'INCR/DECR CHK        '                              66742004
MULTIPLY DC    CL4'MULT'                                                66744004
CNTSHIFT DC    CL29'COUNT CHK   *SHIFT LOAD CHK  '                      66746004
X48      DC    C'48'                                                    66750004
PENTRY   DS    0F                                                       66780002
         DC    X'00010001'                                              66870002
         DC    X'00010001'                                              66960002
         DC    A(LABELS)                                                67050002
         DC    H'0'                                                     67140002
         DC    X'01'                                                    67230002
         DC    X'000B8B00'                                              67320002
         LABEL ''                                                       67410002
         LINE  (1,1),(15,35),SKIP=1                                     67500004
         ROUTINE YCPU,CHKMOD                                            67560004
MODLAB1  LABEL 'MODEL 145 MACHINE CHECK RECORDS',                      X67620004
               'DAY YEAR     DAY YEAR'                                  67680002
         LINE  (50,60),(31,28),SKIP=2                                   67770002
         ROUTINE YDATES,SETDATES                                        67860002
         LABEL 'DATE RANGE - FROM','TO'                                 67950002
         LINE  (72,1),(51,1)                                            68040002
         HEX   YSER,0,3B                                                68130002
         LABEL   'SERIAL'                                               68220002
         LINE  (72,10),(51,),SKIP=3                                     68310002
         ROUTINE YNOREC,CONVERT                                         68400002
         LABEL 'NO.OF RECORDS'                                          68490002
         LINE  ,(43,1),SKIP=3                                           68580002
MODLAB2  LABEL '- SUMMARY OF MODEL 145 MACHINE CHECK RECORDS -'         68670004
         LINE  ,(43,1),SKIP=2                                           68760002
         LABEL 'MACHINE CHECK REGISTER A'                               68850002
         LINE  ,(10,65),SKIP=2                                          68940002
         LABEL 'BYTE 0','BYTE 2'                                        69030002
         LINE  (38,60),(1,59),SKIP=1                                    69120002
         ROUTINE    CTR100,CONVERT                                      69210002
         ROUTINE    CTR116,CONVERT                               A45391 69300002
         LABEL 'LOCAL STORAGE A SOURCE ADDR CHK','ALU 2 HALF SUM CHK'   69390002
         LINE                                                           69480002
         ROUTINE    CTR101,CONVERT                               A45391 69570002
         ROUTINE    CTR117,CONVERT                               A45391 69660002
         LABEL 'LOCAL STORAGE B SOURCE ADDR CHK','ALU 3 HALF SUM CHK'   69750002
         LINE                                                           69840002
         ROUTINE    CTR102,CONVERT                               A45391 69930002
         ROUTINE    CTR118,CONVERT                               A45391 70020002
         LABEL 'LOCAL STORAGE A DEST ADDR CHK','ALU LOGICAL CHK'        70110002
         LINE                                                           70200002
         ROUTINE    CTR103,CONVERT                               A45391 70290002
         ROUTINE    CTR119,CONVERT                               A45391 70380002
         LABEL 'LOCAL STORAGE B DEST ADDR CHK','B REG SHIFT CHK'        70470002
         LINE                                                           70560002
         ROUTINE    CTR104,CONVERT                               A45391 70650002
         ROUTINE    CTR120,CONVERT                               A45391 70740002
         LABEL 'DEST BYTE CTRL CHK','A REG PTY CHK'                     70830002
         LINE                                                           70920002
         ROUTINE    CTR105,CONVERT                               A45391 71010002
         ROUTINE    CTR121,CONVERT                               A45391 71100002
         LABEL 'LOCAL STORAGE A-B DEST ADDR COMPARE','B REG PTY CHK'    71190002
         LINE                                                           71280002
         ROUTINE    CTR106,CONVERT                               A45391 71370002
         ROUTINE    CTR122,CONVERT                               A45391 71460002
         LABEL 'LOCAL STORAGE CTRL ASSM CHK','Z REG PTY CHK'            71550002
         LINE  (38,60),(1,59),SKIP=2                                    71640002
         ROUTINE    CTR107,CONVERT                               A45391 71730002
         ROUTINE    CTR123,CONVERT                               A45391 71820002
         LABEL 'CTRL REG PTY CHK','D REG PTY CHK'                       71910002
         LINE  ,(10,65),SKIP=2                                          72000002
         LABEL 'BYTE 1','BYTE 3'                                        72090002
         LINE  (38,60),(1,59),SKIP=1                                    72180002
         ROUTINE    CTR108,CONVERT                               A45391 72270002
         ROUTINE    CTR124,CONVERT                               A45391 72360002
         LABEL 'ADDR CHK BOUND REC CHK','EXT REG DEST X COMP CHK'       72450002
         LINE                                                           72540002
         ROUTINE    CTR109,CONVERT                               A45391 72630002
         ROUTINE    CTR125,CONVERT                               A45391 72720002
         LABEL 'LOCAL STORAGE COMP CHK','EXT REG DEST Y COMP CHK'       72810002
         LINE                                                           72900002
         ROUTINE    CTR110,CONVERT                               A45391 72990002
         ROUTINE    CTR126,CONVERT                               A45391 73080002
         LABEL 'FLUSH THRU CHK','EXT REG SOURCE Y CHK'                  73170002
         LINE                                                           73260002
         ROUTINE    CTR111,CONVERT                               A45391 73350002
         ROUTINE    CTR127,CONVERT                               A45391 73440002
         LABEL 'H REG PTY CHK','EXT CTRL ASSM PTY CHK'                  73530002
         LINE                                                           73620002
         ROUTINE    CTR112,CONVERT                               A45391 73710002
         ROUTINE    CTR128,CONVERT                               A45391 73800002
         LABEL 'CLOCK COMPARATOR-CPU TIMER CHK','INTERV TIMER PTY CHK'  73890002
         LINE                                                           73980002
         ROUTINE    CTR113,CONVERT                               A45391 74070002
         ROUTINE    CTR129,CONVERT                               A45391 74160002
         LABEL 'P REG PTY CHK','S REC DUP CHK'                          74250002
         LINE                                                           74340002
         ROUTINE    CTR114,CONVERT                               A45391 74430002
         ROUTINE    CTR130,CONVERT                               A45391 74520002
         LABEL 'T REG PTY CHK','TIME OF DAY CLOCK CHK'                  74610002
         LINE  (38,60),(1,59),SKIP=2                                    74700002
         ROUTINE    CTR115,CONVERT                               A45391 74790002
         ROUTINE    CTR131,CONVERT                               A45391 74880002
MODLAB3  LABEL 'L REG PTY CHK','CTRL STORAGE ADDR CHK'                  74970004
         LINE  ,(43,1),SKIP=2                                           75060002
         LABEL 'MACHINE CHECK REGISTER B'                               75150002
         LINE  ,(10,65),SKIP=2                                          75240002
         LABEL 'BYTE 0','BYTE 2'                                        75330002
         LINE  (38,60),(1,59),SKIP=1                                    75420002
         ROUTINE    CTR200,CONVERT                                      75510002
         ROUTINE    CTR216,CONVERT                               A45391 75600002
         LABEL 'STORAGE ADD CHK','I CYCLE HARD ERROR'                   75690002
         LINE                                                           75780002
         ROUTINE    CTR201,CONVERT                               A45391 75870002
         ROUTINE    CTR217,CONVERT                               A45391 75960002
         LABEL 'SDBI PTY CHK','DOUBLE ECC ERROR'                        76050002
         LINE                                                           76140002
         ROUTINE    CTR202,CONVERT                               A45391 76230002
         ROUTINE    CTR218,CONVERT                               A45391 76320002
         LABEL 'SDBO PTY CHK','02I CTRL LINE PTY CHK'                   76410002
         LINE                                                           76500002
         ROUTINE    CTR203,CONVERT                               A45391 76590002
         ROUTINE    CTR219,CONVERT                               A45391 76680002
MODLAB4  LABEL 'STORE PTY CHK','BUSY CHK'                               76770004
         LINE                                                           76860002
         ROUTINE    CTR204,CONVERT                               A45391 76950002
         ROUTINE    CTR220,CONVERT                               A45391 77040002
MODLAB5  LABEL 'TIME OUT CHK','ECC HARDWARE CHK'                        77130004
         LINE                                                           77220002
         ROUTINE    CTR205,CONVERT                               A45391 77310002
         ROUTINE    CTR221,CONVERT                               A45391 77400002
         LABEL 'STORAGE PROT STACK PTY CHK','DOUBLE ECC ERROR'          77490002
         LINE                                                           77580002
         ROUTINE    CTR206,CONVERT                               A45391 77670002
         ROUTINE    CTR222,CONVERT                               A45391 77760002
         LABEL 'CLOCK SYN CHK A','SINGLE ECC ERROR'                     77850002
         LINE  (38,60),(1,59),SKIP=2                                    77940002
         ROUTINE    CTR207,CONVERT                               A45391 78030002
         ROUTINE    CTR223,CONVERT                               A45391 78120002
         LABEL 'CLOCK SYN CHK B','SINGLE DATA BIT CORRCT'               78210002
         LINE  ,(10,65),SKIP=2                                          78300002
         LABEL 'BYTE 1','BYTE 3'                                        78390002
         LINE  (38,60),(1,59),SKIP=1                                    78480002
         ROUTINE    CTR208,CONVERT                               A45391 78570002
         ROUTINE    CTR224,CONVERT                               A45391 78660002
         LABEL 'M REG COMP A CHK','02I CT ERROR CORRCT'                 78750002
         LINE                                                           78840002
         ROUTINE    CTR209,CONVERT                               A45391 78930002
         ROUTINE    CTR225,CONVERT                               A45391 79020002
         LABEL 'M REG COMP B CHK','C32 DATA BIT CORRCT'                 79110002
         LINE                                                           79200002
         ROUTINE    CTR210,CONVERT                               A45391 79290002
         ROUTINE    CTR226,CONVERT                               A45391 79380002
         LABEL 'M REG COMP C CHK','C16 DATA BIT CORRCT'                 79470002
         LINE                                                           79560002
         ROUTINE    CTR211,CONVERT                               A45391 79650002
         ROUTINE    CTR227,CONVERT                               A45391 79740002
         LABEL 'M REG COMP D CHK','C8 DATA BIT CORRCT'                  79830002
         LINE                                                           79920002
         ROUTINE    CTR212,CONVERT                               A45391 80010002
         ROUTINE    CTR228,CONVERT                               A45391 80100002
         LABEL 'NO RELOCATE REGISTER MATCH','C4 DATA BIT CORRCT'        80190002
         LINE                                                           80280002
         ROUTINE    CTR213,CONVERT                               A45391 80370002
         ROUTINE    CTR229,CONVERT                               A45391 80460002
         LABEL 'MULT RELOCATE REG MATCH','C2 DATA BIT CORRCT'           80550002
         LINE                                                           80640002
         ROUTINE    CTR214,CONVERT                               A45391 80730002
         ROUTINE    CTR230,CONVERT                               A45391 80820002
         LABEL 'RELOCATE LRU INVALID','C1 DATA BIT CORRCT'              80910002
         LINE  (38,60),(1,59),SKIP=2                                    81000002
         ROUTINE    CTR215,CONVERT                               A45391 81090002
         ROUTINE    CTR231,CONVERT                               A45391 81180002
         LABEL 'ANY MACH CHK ON','C0 DATA BIT CORRCT'                   81270002
         DC    X'01000B8B00'                                            81360002
         LABEL ''                                                       81450002
         LINE  ,(10,65),SKIP=2                                          81540002
         LABEL 'RETRY REG 3 ERRORS  HMRTY','RETRY REG 4 ERRORS  CPURTY' 81630002
         LINE  (38,60),(1,59),SKIP=1                                    81720002
         ROUTINE    CTR300,CONVERT                                      81810002
         ROUTINE    CTR308,CONVERT                               A45391 81900002
         LABEL 'MACHINE CHECK TRAP','STORAGE 2 CYCLE ERROR'             81990002
         LINE                                                           82080002
         ROUTINE    CTR301,CONVERT                               A45391 82170002
         ROUTINE    CTR309,CONVERT                               A45391 82260002
         LABEL 'RETRY TRAP','TYPE 1 ERROR'                              82350002
         LINE                                                           82440002
         ROUTINE    CTR302,CONVERT                               A45391 82530002
         ROUTINE    CTR310,CONVERT                               A45391 82620002
         LABEL 'CPU HIGH TRAP','TYPE 2 ERROR'                           82710002
         LINE                                                           82800002
         ROUTINE    CTR303,CONVERT                               A45391 82890002
         ROUTINE    CTR311,CONVERT                               A45391 82980002
         LABEL 'INT FILE ADPTR OR SEL CHN 1,2 OR 3','TYPE 3 ERROR'      83070002
         LINE                                                           83160002
         ROUTINE    CTR304,CONVERT                               A45391 83250002
         ROUTINE    CTR312,CONVERT                               A45391 83340002
         LABEL 'SEL CHN 1,2,3(IF IFA) OR SEL CHN 4','LOCAL OR EXT STORAC83430002
               GE DEST'                                                 83470002
         LINE                                                           83520002
         ROUTINE    CTR305,CONVERT                               A45391 83610002
         ROUTINE    CTR313,CONVERT                               A45391 83700002
         LABEL 'MPX TRAP','STORAGE WORD IN ERROR'                       83790002
         LINE                                                           83880002
         ROUTINE    CTR306,CONVERT                               A45391 83970002
         ROUTINE    CTR314,CONVERT                               A45391 84060002
         LABEL 'INT FILE ADAPTR TRAP','ERROR IN TRAP 2 CYCLE'           84150002
         LINE  (38,60),(1,59),SKIP=2                                    84240002
         ROUTINE    CTR307,CONVERT                               A45391 84330002
         ROUTINE    CTR315,CONVERT                               A45391 84420002
         LABEL 'STORE DISPLAY','SPARE'                                  84510002
         SPACE 2                                                        84600002
         LINE  ,(43,1),SKIP=2                                           84690002
         LABEL 'SYSTEM REGISTER'                                        84780002
         LINE  ,(10,65),SKIP=2                                          84870002
         LABEL 'BYTE 0','BYTE 2'                                        84960002
         LINE  (38,60),(1,59),SKIP=1                                    85050002
         ROUTINE    CTR400,CONVERT                                      85140002
         ROUTINE    CTR416,CONVERT                               A45391 85230002
         LABEL 'MACHINE CHK INTERPT PENDING','ENABLE CLEAR SWITCH'      85320002
         LINE                                                           85410002
         ROUTINE    CTR401,CONVERT                               A45391 85500002
         ROUTINE    CTR417,CONVERT                               A45391 85590002
         LABEL 'RETRY ROUTINE','TMPL'                                   85680002
         LINE                                                           85770002
         ROUTINE    CTR402,CONVERT                               A45391 85860002
         ROUTINE    CTR418,CONVERT                               A45391 85950002
         LABEL 'MACHINE CHK ROUTINE','LOAD FILE WAIT'                   86040002
         LINE                                                           86130002
         ROUTINE    CTR403,CONVERT                               A45391 86220002
         ROUTINE    CTR419,CONVERT                               A45391 86310002
         LABEL 'DOCUMENTARY CONSOLE 2','CE KEY IN CE MODE'              86400002
         LINE                                                           86490002
         ROUTINE    CTR404,CONVERT                               A45391 86580002
         ROUTINE    CTR420,CONVERT                               A45391 86670002
         LABEL 'LOG PRESENT','IPL'                                      86760002
         LINE                                                           86850002
         ROUTINE    CTR405,CONVERT                               A45391 86940002
         ROUTINE    CTR421,CONVERT                               A45391 87030002
         LABEL 'SPARE','POWER ON RESET'                                 87120002
         LINE                                                           87210002
         ROUTINE    CTR406,CONVERT                               A45391 87300002
         ROUTINE    CTR422,CONVERT                               A45391 87390002
         LABEL 'I/O INSTN LATCH','SPARE'                                87480002
         LINE  (38,60),(1,59),SKIP=2                                    87570002
         ROUTINE    CTR407,CONVERT                               A45391 87660002
         ROUTINE    CTR423,CONVERT                               A45391 87750002
         LABEL 'FORCE MODULE 0 TO LSCS','INSTR PROC LATCH'              87840002
         LINE  ,(10,65),SKIP=2                                          87930002
         LABEL 'BYTE 1','BYTE 3'                                        88020002
         LINE  (38,60),(1,59),SKIP=1                                    88110002
         ROUTINE    CTR408,CONVERT                               A45391 88200002
         ROUTINE    CTR424,CONVERT                               A45391 88290002
         LABEL 'ADDR CONTENTS','MACHINE CHECK TRAP'                     88380002
         LINE                                                           88470002
         ROUTINE    CTR409,CONVERT                               A45391 88560002
         ROUTINE    CTR425,CONVERT                               A45391 88650002
         LABEL 'CPU INTRPT FORCE','RETRY TRAP'                          88740002
         LINE                                                           88830002
         ROUTINE    CTR410,CONVERT                               A45391 88920002
         ROUTINE    CTR426,CONVERT                               A45391 89010002
         LABEL 'SAR INTRPT FORCE','CPU HIGH TRAP'                       89100002
         LINE                                                           89190002
         ROUTINE    CTR411,CONVERT                               A45391 89280002
         ROUTINE    CTR427,CONVERT                               A45391 89370002
         LABEL 'PSW RESTART','INT FILE ADAPTR OR SEL CHN 1,2 OR 3'      89460002
         LINE                                                           89550002
         ROUTINE    CTR412,CONVERT                               A45391 89640002
         ROUTINE    CTR428,CONVERT                               A45391 89730002
         LABEL 'EC MODE','SEL CHN 1,2,3(IF IFA) OR SEL CHN 4'           89820002
         LINE                                                           89910002
         ROUTINE    CTR413,CONVERT                               A45391 90000002
         ROUTINE    CTR429,CONVERT                               A45391 90090002
         LABEL 'SYS CTRL INTRPT','MPX TRAP'                             90180002
         LINE                                                           90270002
         ROUTINE    CTR414,CONVERT                               A45391 90360002
         ROUTINE    CTR430,CONVERT                               A45391 90450002
         LABEL 'TIMER INTRPT FORCE','INT FILE ADAPTR TRAP'              90540002
         LINE                                                           90630002
         ROUTINE    CTR415,CONVERT                               A45391 90720002
         ROUTINE    CTR431,CONVERT                               A45391 90810002
         LABEL 'PRTY INTRUPT','STORE-DISPLAY'                           90900002
         LINE                                                           90990002
         ROUTINE   YDUMA,FREECTR                                        91080002
         LABEL ' '                                                      91170002
         DC    X'FF'                                                    91260002
         DC    XL6'00'                                                  91350002
         DC    C'$'                                                     91440002
LABELS   EQU   *                                                        91530002
         LSTART                                                         91620002
         END                                                            91710002
