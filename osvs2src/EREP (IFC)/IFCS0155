*                                                                       00200020
*                                                                       00400020
*  DSGEN MACRO     DSGEN MACRO     DSGEN MACRO     DSGEN MACRO        * 00600020
         SPACE 2                                                        00800020
         MACRO                                                          01000020
&NAME    DSGEN &X1,&X2,&X3,&X4,&X5,&X6,&X7,&X8,&X9,&X10,&X11,&X12,&X13,X01200020
               &X14,&X15,&X16,&X17,&X18,&X19,&X20,&X21,&X22,&X23,&X24, X01400020
               &X25,&X26,&X27,&X28,&X29,&X30,&X31,&X32                  01600020
.*                            THIS MACRO GENERATES ONE DSECT WORD       01800020
.*                                 FORMATTED FOR THE SUBJECT LOG RECORD 02000020
.*                                 EACH OPERAND HAS TWO SUB LISTS. THE  02200020
.*                                 FIRST IS THE NAME OF THE LOG ITEM    02400020
.*                                 WHILE THE SECOND IS THE # OF BITS TO 02600020
.*                                 ALLOCATE FOR THIS ITEM. ITEMS MUST   02800020
.*                                 BE DEFINED CONTIGUOUSLY WITHOUT GAPS 03000020
.*                                 UNUSED BIT GROUPS MUST BE GIVEN      03200020
.*                                 DUMMY NAMES. THE NAMES PROVIDED FOR  03400020
.*                                 THE LOG ITEMS MAY THEN BE USED IN    03600020
.*                                 THE CONVERSION MACRO INSTRUCTIONS.   03800020
         GBLC  &ITEM(1000)                                              04000020
         GBLA  &ITEMNBR,&BITS(1000),&SHIFT(1000)                        04200020
         LCLC  &SYMBOL                                                  04400020
         LCLA  &OP,&COUNT,&BYTE                                         04600020
.LOOP    ANOP                                                           04800020
&OP      SETA  &OP+1                                                    05000020
&ITEMNBR SETA  &ITEMNBR+1                                               05200020
&SYMBOL  SETC  '&SYSLIST(&OP,1)'                                        05400020
         AIF   ('&SYSLIST(&OP,2)' NE '').OK1                            05600020
         MNOTE 'NULL BIT COUNT FIELD'                                   05800020
         MEXIT                                                          06000020
.OK1     ANOP                                                           06200020
         AIF   ('&SYMBOL' NE '').OK                                     06400020
         MNOTE 'LOG ITEM SYMBOL NOT PROVIDED'                           06600020
         AGO   .CNT                                                     06800020
.OK      ANOP                                                           07000020
         AIF   ('&SYMBOL'(1,1) EQ '''').CNT                *TEMP*       07200020
&SYMBOL  EQU   *+&BYTE                                                  07400020
&ITEM(&ITEMNBR)  SETC '&SYSLIST(&OP,1)'                                 07600020
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2)                                    07800020
&SHIFT(&ITEMNBR) SETA &COUNT-&BYTE*8                                    08000020
.CNT     ANOP                                                           08200020
&COUNT   SETA  &COUNT+&SYSLIST(&OP,2)                                   08400020
&BYTE    SETA  &COUNT/8                                                 08600020
         AIF (&OP LT N'&SYSLIST).LOOP                                   08800020
         AIF   (&COUNT NE 32).NOT32                                     09000020
&NAME    DS    4C                                                       09200020
         MEXIT                                                          09400020
.NOT32   AIF   (&COUNT NE 64).ERR                                       09600020
&NAME    DS    8C                                                       09800020
         MEXIT                                                          10000020
.ERR     MNOTE '**BIT COUNT FIELDS DO NOT TOTAL 32 OR 64**'             10200020
         MEND                                                           10400020
*  HEX MACRO     HEX MACRO     HEX MACRO    HEXN MACRO     HEX MACRO  * 10450002
         SPACE 2                                                        10500002
         MACRO                                                          10550002
         HEX   &LOGITEM,&SKIP$OR,&BYTES                                 10560002
.*                            THIS MACRO FACILITATES GENERATION OF THE  10570002
.*                                 TABLE ENTRIES SPECIFYING HEX TYPE    10580002
.*                                 CONVERSIONS.                         10590002
.*                            &LOGITEM - NAME OF DATA ITEM TO BE        10592002
.*                                 CONVERTED                            10594002
.*                            &SKIP$OR - NUMBER OF SPACES TO SKIP ON    10596002
.*                                 MULTIPLE PRINT OR NBR OF SPACES TO   10598002
.*                                 BACK UP FROM COLUMN FOR START OF     10598402
.*                                 PRINTING. THE LETTER B PRECEEDS THE  10598802
.*                                 NUMBER (B8) IF THE LATTER OPTION IS  10599202
.*                                 DESIRED. OMISSION OF THIS OPERAND    10599602
.*                                 FORCES OPTION 2 WITH BACKUP SPACING  10599702
.*                                 EQUAL TO THE NUMBER OF BYTES SPECI-  10599802
.*                                 FIED BY THE NEXT OPERAND (TWICE THIS 10599902
.*                                 NUMBER IF SUFFIX IS EXPLICITLY OR    10649902
.*                                 IMPLICITLY B).                       10659902
.*                            &BYTES - NUMBER OF TOTAL INPUT BYTES TO   10669902
.*                                 PROCESS. THIS NUMBER IS SUFFIXED     10679902
.*                                 WITH AN L,R, OR B TO STIPULATE       10689902
.*                                 PRINTING OF THE LEFT HALF, RIGHT     10691902
.*                                 HALF, OR BOTH HALVES OF THE BYTE     10693902
.*                                 RESPECTIVELY. OMISSION OF THIS       10695902
.*                                 OPERAND DEFAULTS TO B WITH THE NUM-  10697902
.*                                 BER OF BYTES EQUAL TO THE ITEM LNGTH 10698302
.*                            A NEW ENTRY IS GENERATED ONLY WHEN NECES- 10698702
.*                                 SARY. THIS MACRO MUST BE THE FIRST   10699102
.*                                 MACRO INSTRUCTION ISSUED FOR THE     10699502
.*                                 SUBJECT LINE(S).                     10699602
         GBLC &ITEM(1000),&DSECT                                        10699702
         GBLA &ITEMNBR,&BITS(1000),&SHIFT(1000),&NRENTS                 10699802
         LCLB  &B                                                       10733202
         LCLA  &IBITS,&NDX,&ISHIFT,&K,&T,&CODE,&BYTESP                  10743202
         LCLC  &S,&LETTER                                               10753202
.LOOP    ANOP                                                           10763202
&NDX     SETA  &NDX+1                                                   10765202
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      10765602
         AIF   (&NDX LT &ITEMNBR).LOOP                                  10766002
         MNOTE *,'LOG ITEM NOT DEFINED'                                 10766402
         MEXIT                                                          10766502
.FOUND   ANOP                                                           10777602
&ISHIFT  SETA  &SHIFT(&NDX)                                             10787602
&IBITS   SETA  &BITS(&NDX)                                              10788002
&CODE    SETA  1                                                        10788402
&K       SETA  K'&BYTES                                                 10788802
         AIF   (&IBITS-(&IBITS/4)*4 EQ 0).OK                            10792502
         MNOTE *,'BIT LENGTH SPECIFICATION INCONSISTENT WITH CONTROL'   10794502
         MEXIT                                                          10794902
.OK      AIF   ('&BYTES' EQ '').USEDEFN                                 10795302
&LETTER  SETC  '&BYTES'(&K,1)                                           10795702
&S       SETC  '&BYTES'(1,&K-1)                                         10796102
&BYTESP  SETA  &S                                                       10796202
         AIF   ('&LETTER' EQ 'B').BOTH                                  10846202
         AIF   (&ISHIFT EQ 0 OR &ISHIFT EQ 4).OK2                       10856202
.ERR     MNOTE *,'DATA NOT ALLIGNED ON HEX OR BYTE BOUNDARY'            10866202
         MEXIT                                                          10876202
.USEDEFN ANOP                                                           10886202
&BYTESP  SETA  &IBITS/8                                                 10888202
.BOTH    AIF   (&ISHIFT NE 0).ERR                                       10890202
&CODE    SETA  3                                                        10892202
&T       SETA  &BYTESP*2-1                                              10894202
&S       SETC  '&T'                                                     10894602
.OK2     AIF   (&ISHIFT EQ 0).L                                         10895002
&CODE    SETA  2                                                        10895402
.L       ANOP                                                           10895802
&B       SETB  1                                                        10895902
         AIF   ('&SKIP$OR' EQ '').BACKUP                                10896002
&K       SETA  K'&SKIP$OR                                               10896102
&B       SETB  ('&SKIP$OR'(1,1) EQ 'B')                                 10912802
&S       SETC  '&SKIP$OR'(&B+1,&K-&B)                                   10922802
.BACKUP  ANOP                                                           10924802
&NRENTS  SETA  &NRENTS+1                                                10926802
         DC    AL.12(&LOGITEM-&DSECT),XL.4'A'                           10928802
         DC    BL.1'&B',FL.7'&S',FL.4'&BYTESP',FL.4'&CODE'              10929202
         MEND                                                           10929302
*                                                                       10929502
         MACRO                                                          10946202
&NAME    LINE  &DATA,&LABEL,&SKIP=                                      11000020
.*                            THIS MACRO ESTABLISHES THE MARGINS OR     11200020
.*                                 COLUMN SETTINGS FOR EACH LINE. IT    11400020
.*                                 GENERATES NECESSARY CARRIAGE CONTROL 11600020
.*                                 ENTRIES. LASTLY IT DETERMINES THE    11800020
.*                                 NUMBER OF ENTRIES ASSOCIATED WITH    12000020
.*                                 THE PREVIOUS LINE AND STORES THAT #  12200020
.*                                 INTO THE APPROPRIATE BYTE.           12400020
.*                                                                      12600020
.*                                 &DATA(1) - CHARACTER POSITION TO     12800020
.*                                 BEGIN DATA.                          13000020
.*                                                                      13200020
.*                                 &DATA(2) - # OF SPACES BETWEEN       13400020
.*                                 SUCCESSIVE DATA COLUMN STARTING      13600020
.*                                 CHARACTERS.                          13800020
.*                                                                      14000020
.*                                 &LABEL(1) - CHARACTER POSITION       14200020
.*                                 TO BEGIN LABELS.                     14400020
.*                                                                      14600020
.*                                 &LABEL(2) - # OF SPACES BETWEEN      14800020
.*                                 LINE'S LABEL STARTING CHARACTERS.    15000020
.*                                                                      15200020
.*                                 &SKIP= - # OF LINES TO ADVANCE       15400020
.*                                 CARRIAGE TO BEGIN NEXT PRINTED LINE. 15600020
.*                                                                      15800020
.*                                 NEW ENTRIES ARE GENERATED ONLY WHEN  16000020
.*                                 NECESSARY. OMISSION OF ITEMS MEANS   16200020
.*                                 THEY HAVE NOT CHANGED SINCE PREVIOUS 16400020
.*                                 SETTINGS. A LINE MACRO IS REQUIRED   16600020
.*                                 FOR EACH PRINTED LINE. IF NO SETTING 16800020
.*                                 CHANGES ARE REQUIRED ALL OPERANDS    17000020
.*                                 ARE OMITTED IN WHICH CASE ONLY THE   17200020
.*                                 # OF ENTRIES FOR THE PREVIOUS LINE   17400020
.*                                 IS COMPUTED. THIS MACRO MUST BE THE  17600020
.*                                 FIRST MACRO INSTRUCTION ISSUED FOR   17800020
.*                                 THE SUBJECT LINE.                    18000020
         GBLA  &DB,&DT,&LB,&LT,&NRENTS                                  18200020
         GBLA  &LASTCC,&INITIAL                                         18400020
         GBLC  &NRENTSX                                                 18600020
         GBLC  &CARRCON                                                 18800020
         GBLB  &TEST                                                    19000020
         LCLA  &S                                                       19200020
&NAME    DS    0C                                                       19400020
         AIF   (&INITIAL EQ 0).FIRSTLN                                  19600020
         LINEND                                                         19800020
         AGO   .NTFIRST                                                 20000020
.FIRSTLN ANOP                                                           20200020
&NRENTSX SETC  'N&SYSNDX'                                               20400020
&INITIAL SETA  1                                                        20600020
N&SYSNDX EQU   *                                                        20800020
.NTFIRST ANOP                                                           21000020
         DC    AL1(0)                                                   21200020
         AIF   ('&DATA(1)' EQ '').CKDTABS                               21400020
         AIF   (&DATA(1) EQ &DB).CKDTABS                                21600020
&DB      SETA  &DATA(1)                                                 21800020
         AGO   .AA                                                      22000020
.CKDTABS AIF   ('&DATA(2)' EQ '').NCDATA                                22200020
         AIF   (&DATA(2) EQ &DT).NCDATA                                 22400020
         AGO   .CC                                                      22600020
.AA      AIF   ('&DATA(2)' EQ '').BB                                    22800020
         AIF   (&DATA(2) EQ &DT).BB                                     23000020
.CC      ANOP                                                           23200020
&DT      SETA  &DATA(2)                                                 23400020
.BB      DC    XL2'FFFE'                                                23600020
         DC    FL1'&DB'                                                 23800020
         DC    FL1'&DT'                                                 24000020
&NRENTS  SETA  &NRENTS+1                                                24200020
.NCDATA  ANOP                                                           24400020
         AIF   ('&LABEL(1)' EQ '').CKLTABS                              24600020
         AIF   (&LABEL(1) EQ &LB).CKLTABS                               24800020
&LB      SETA  &LABEL(1)                                                25000020
         AGO   .AAA                                                     25200020
.CKLTABS AIF   ('&LABEL(2)' EQ '').NCLABEL                              25400020
         AIF   (&LABEL(2) EQ &LT).NCLABEL                               25600020
         AGO   .CCC                                                     25800020
.AAA     AIF   ('&LABEL(2)' EQ '').BBB                                  26000020
         AIF   (&LABEL(2) EQ &LT).BBB                                   26200020
.CCC     ANOP                                                           26400020
&LT      SETA  &LABEL(2)                                                26600020
.BBB     DC    XL2'FFFF'                                                26800020
         DC    FL1'&LB'                                                 27000020
         DC    FL1'&LT'                                                 27200020
&NRENTS  SETA  &NRENTS+1                                                27400020
.NCLABEL ANOP                                                           27600020
         AIF   ('&SKIP' NE '').CONT                                     27800020
         AIF   (&TEST EQ 0).NOCHANG                                     28000020
&S       SETA  &LASTCC                                                  28200020
         AGO   .DEFAULT                                                 28400020
.CONT    ANOP                                                           28600020
         AIF   (&TEST EQ 0).AB                                          28800020
&S       SETA  &SKIP                                                    29000020
.DEFAULT ANOP                                                           29200020
         ORG   &CARRCON+3                                               29400020
         DC    AL.3(0),AL.2(&S),AL.3(1)                                 29600020
         ORG                                                            29800020
&LASTCC  SETA  &S                                                       30000020
&TEST    SETB  0                                                        30200020
         AGO   .DD                                                      30400020
.AB      AIF   (&SKIP EQ &LASTCC).NOCHANG                               30600020
A&SYSNDX DC    XL2'FFFB'                                                30800020
         DC    AL.3(0),AL.2(&SKIP),AL.3(1)                              31000020
         DC    FL1'9'                                                   31200020
&LASTCC  SETA  &SKIP                                                    31400020
&TEST    SETB  1                                                        31600020
&CARRCON SETC  'A&SYSNDX'                                               31800020
&NRENTS  SETA  &NRENTS+1                                                32000020
.DD      ANOP                                                           32200020
.NOCHANG ANOP                                                           32400020
         MEND                                                           32600020
*                                                                       32800020
*                                                                       33000020
*********************************************************************** 33200020
*                                                                       33400020
*                                                                       33600020
         MACRO                                                          33800020
&NAME    LABEL &LABEL1,&LABEL2,&LABEL3,&LABEL4,&LABEL5,&LABEL6,        C34000020
               &LABEL7,&LABEL8                                          34200020
.*                            THIS MACRO ALLOWS UP TO ACHT LABELS TO    34400020
.*                                 BE SPECIFIED FOR A GIVEN LINE. THE   34600020
.*                                 LABELS SHOULD BE ENCLOSED IN QUOTA-  34800020
.*                                 TION MARKS. THE COLUMN AND LINE END  35000020
.*                                 CONTROLS WILL BE INSERTED BY THE     35200020
.*                                 MACRO. OMITTED OPERANDS MEAN NO      35400020
.*                                 LABEL REQUIRED FOR RESPECTIVE        35600020
.*                                 COLUMN. THIS MACRO WILL ALSO ALERT   35800020
.*                                 THE PROGRAMMER TO EXACTLY WHERE THE  36000020
.*                                 TABLE MUST BE BROKEN IF NECESSARY    36200020
.*                                 TO AVOID EXCEEDING THE MAXIMUM LIMIT 36400020
         GBLC &LABELS(2000)                                             36600020
         GBLC  &LBL(100)                                                36800020
         GBLA  &LBLCTR(100)                                             37000020
         GBLA  &LABELNR                                                 37200020
         GBLA  &NRENTS,&LPTR                                            37400020
         LCLC  &MARGIN,&TACK                                            37600020
         LCLC  &TEXT                                                    37800020
         LCLA  &OP,&K,&START,&NRCHAR,&REMAIN                            38000020
&MARGIN  SETC  '*'                                                      38200020
         AIF   ('&NAME' EQ '').LOOPOUT                                  38400020
&LPTR    SETA  &LPTR+1                                                  38600020
&LBL(&LPTR) SETC '&NAME'                                                38800020
&LBLCTR(&LPTR) SETA &LABELNR+1                                          39000020
.LOOPOUT ANOP                                                           39200020
&OP      SETA  &OP+1                                                    39400020
&K       SETA  K'&SYSLIST(&OP)                                          39600020
         AIF (&K GE 2).NORM                                             39800020
&K       SETA  2                                                        40000020
.NORM    ANOP                                                           40200020
&START   SETA  2                                                        40400020
         AIF (&OP LT N'&SYSLIST).NOTLAST                                40600020
&MARGIN  SETC  '$'                                                      40800020
.NOTLAST ANOP                                                           41000020
&NRCHAR  SETA  8                                                        41200020
&TACK    SETC  ''                                                       41400020
.LOOPIN  ANOP                                                           41600020
&REMAIN  SETA  &K-&START                                                41800020
         AIF (&REMAIN GE 8).MORE                                        42000020
&TACK    SETC  '&MARGIN'                                                42200020
&NRCHAR  SETA  &REMAIN                                                  42400020
.MORE    ANOP                                                           42600020
&TEXT    SETC  ''                                                       42800020
         AIF (&REMAIN EQ 0).ENDTEXT                                     43000020
&TEXT    SETC  '&SYSLIST(&OP)'(&START,&NRCHAR)                          43200020
.ENDTEXT ANOP                                                           43400020
&LABELNR SETA  &LABELNR+1                                               43600020
&LABELS(&LABELNR) SETC '&TEXT'.'&TACK'                                  43800020
&START   SETA  &START+8                                                 44000020
         AIF ('&TACK' EQ '').LOOPIN                                     44200020
         AIF ('&TACK' EQ '*').LOOPOUT                                   44400020
         MEND                                                           44600020
         SPACE 2                                                        44800020
         MACRO                                                          45000020
         LSTART                                                         45200020
.*                            THIS MACRO IS ISSUED WHEN THE LABEL AREA  45400020
.*                                 OF THE TABLE IS TO BEGIN.            45600020
         GBLC &LABELS(2000)                                             45800020
         GBLA  &LABELNR                                                 46000020
         GBLC  &LBL(100)                                                46200020
         GBLA  &LBLCTR(100)                                             46400020
         LCLA  &NDX,&CTR                                                46600020
         LINEND                                                         46800020
&CTR     SETA  1                                                        47000020
.LOOP    ANOP                                                           47200020
&NDX     SETA  &NDX+1                                                   47400020
         AIF   (&LBLCTR(&CTR) NE &NDX).NOLBL                            47600020
&LBL(&CTR) DC  C'&LABELS(&NDX)'                                         47800020
&CTR     SETA  &CTR+1                                                   48000020
         AGO   .LOOPCTL                                                 48200020
.NOLBL   ANOP                                                           48400020
         DC    C'&LABELS(&NDX)'                                         48600020
.LOOPCTL AIF   (&NDX LT &LABELNR).LOOP                                  48800020
         MEND                                                           49000020
*                                                                       49200020
*                                                                       49400020
*********************************************************************** 49600020
*                                                                       49800020
*                                                                       50000020
         MACRO                                                          50200020
         LINEND                                                         50400020
.*                                 THIS MACRO IS USED ONLY BY THE LINE  50600020
.*                                 MACRO TO SET THE NUMBER OF ENTRIES   50800020
.*                                 ASSOCIATED WITH EACH LINE.           51000020
         GBLA  &NRENTS                                                  51200020
         GBLC  &NRENTSX                                                 51400020
         ORG   &NRENTSX                                                 51600020
         DC    FL1'&NRENTS'                                             51800020
         ORG                                                            52000020
&NRENTS  SETA  0                                                        52200020
B&SYSNDX EQU   *                                                        52400020
&NRENTSX SETC  'B&SYSNDX'                                               52600020
         MEND                                                           52800020
*                                                                       53000020
*                                                                       53200020
*********************************************************************** 53400020
         MACRO                                                          53600020
         SPECIAL  &ROUTINE,&PARAM,&SPACE=                               53800020
.*                            THIS MACRO GENERATES A SPECIAL ROUTINE    54000020
.*                                 ENTRY TO BE PROCESSED BY THE SUM. M. 54200020
.*                            &ROUTINE - SYMBOL ON SPECIAL ROUTINE EWT. 54400020
.*                            &PARAM - AN 8 BIT BINARY REPRESENTATION   54600020
.*                                 TO OCCUPY THE 'MASK' FIELD BUT TO BE 54800020
.*                                 INTERPRETED AS AN ARGUMENT OF THE    55000020
.*                                 SPECIAL ROUTINE.                     55200020
.*                            &SPACE - THE NUMBER OF 2BYTE COUNTERS TO  55400020
.*                                 ALLOCATE FOR REQUIRED PROCESSING.    55600020
         GBLC  &CSECT                                                   55800020
         GBLA  &COUNTR                                                  56000020
         LCLA  &ADD                                                     56200020
         DC    AL1(128)                                                 56400020
         DC    BL.8'&PARAM'                                             56600020
         DC    AL2(&ROUTINE-&CSECT)                                     56800020
         DC    AL2(&COUNTR)                                             57000020
&ADD     SETA  1                                                        57200020
         AIF   ('&SPACE' EQ '').NORM                                    57400020
&ADD     SETA  &SPACE                                                   57600020
.NORM    ANOP                                                           57800020
&COUNTR  SETA  &COUNTR+&ADD                                             58000020
         MEND                                                           58200020
         MACRO                                                          58400020
&NAME    ROUTINE &LOGITEM,&RNAME                                        58600020
         GBLC  &DSECT,&CSECT                                            58800020
         GBLC  &ITEM(1000)                                              59000020
         GBLA  &SHIFT(1000),&ITEMNBR                                    59200020
         GBLA  &NRENTS                                                  59400020
         LCLA  &ISHIFT,&NDX                                             59600020
.LOOP    ANOP                                                           59800020
&NDX     SETA  &NDX+1                                                   60000020
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      60200020
         AIF   (&NDX LT &ITEMNBR).LOOP                                  60400020
         MNOTE *,'LOG ITEM NOT DEFINED'                                 60600020
         MEXIT                                                          60800020
.FOUND   ANOP                                                           61000020
&ISHIFT  SETA  &SHIFT(&NDX)                                             61200020
&NAME    DC    AL.12(&LOGITEM-&DSECT),XL.4'D'                           61400020
         DC    AL.4(&ISHIFT),AL.12(&RNAME-&CSECT)                       61600020
&NRENTS  SETA  &NRENTS+1                                                61800020
         MEND                                                           62000020
         GBLC  &DSECT,&CSECT                                            62200020
&CSECT   SETC  'IFCS0155'                                               62400020
&DSECT   SETC  'S0002'                                                  62600020
IFCS0155 CSECT                                                          62800020
S0002    DSECT                                                          63000020
         DSGEN (CLASRC,8),(SYSREL,8),(SWITCHES,16)                      63200020
         DSGEN (SPARE1,32)                                              63400020
         DSGEN (DATE,32)                                                63600020
         DSGEN (HOUR,32)                                                63800020
         DSGEN (SPARE2,8),(CPUSERL,24)                                  64000020
         DSGEN (CPUID,16),(SPARE3,16)                                   64200020
IFCS0155 CSECT                                                          64400020
         USING S0002,R2                                                 64600020
         USING *,R9                                                     64800020
         DC    A(ENTRIES)                                               65000020
         DC    A(PEDIT)                                                 65200020
         DC    F'0'                                                     65400020
         DC    H'10'                                                    65600020
R0       EQU   0                                                        65800020
R1       EQU   1                                                        66000020
R2       EQU   2                                                        66200020
R3       EQU   3                                                        66400020
R4       EQU   4                                                        66600020
R5       EQU   5                                                        66800020
R6       EQU   6                                                        67000020
R7       EQU   7                                                        67200020
R8       EQU   8                                                        67400020
R9       EQU   9                                                        67600020
R10      EQU   10                                                       67800020
R11      EQU   11                                                       68000020
R12      EQU   12                                                       68200020
R13      EQU   13                                                       68400020
R14      EQU   14                                                       68600020
R15      EQU   15                                                       68800020
L0       EQU   0                                                        69000020
L1       EQU   1                                                        69200020
L2       EQU   2                                                        69400020
L3       EQU   3                                                        69600020
L4       EQU   4                                                        69800020
L5       EQU   5                                                        70000020
L6       EQU   6                                                        70200020
L7       EQU   7                                                        70400020
L8       EQU   8                                                        70600020
L10      EQU   10                                                       70800020
L12      EQU   12                                                       71000020
L13      EQU   13                                                       71200020
L18      EQU   18                                                       71400020
XSAVE    DS    6F                                                       71600020
HEX00    DC    F'0'                                                     71800020
*                                                                       72000020
*        SPECIAL ROUTINES                                               72200020
*                                                                       72400020
XDATE1   STM   R4,R8,XSAVE              SAVE REGS                       72600020
         LA    R5,L0(R3)                GET OUTDSELT POINTER RIGHT      72800020
         CLC   DATE(L4),HEX00           IS DATE ZERO                    73000020
         BE    RETURN                                                   73200020
         CLC   L0(L4,R3),HEX00          IS LOW DATE ZERO                73400020
         BNE   XDATE2                   BR-NO                           73600020
         MVC      L0(L4,R3),DATE                 MOVE IN DATE           73800020
XDATE2   CLC   DATE(L4),L0(R3)          CHECK FOR LOW DATE              74000020
         BL    SAVELOW                  LOWER SAVE IT                   74200020
         CLC   DATE(L4),L4(R3)          CHECK FOR HI                    74400020
         BNH   RETURN                   BR-NOT HI                       74600020
SAVEHI   MVC   L4(L4,R3),DATE           MOVE HI DATE                    74800020
         B     RETURN                                                   75000020
SAVELOW  MVC   L0(L4,R3),DATE           MOVE LOW DATE                   75200020
         B     RETURN                                                   75400020
RETURN   LM    R4,R8,XSAVE              RESTORE REGS                    75600020
         BR    R14                      GO BACK                         75800020
ENTRIES  EQU   *                                                        76000020
         SPECIAL XDATE1,00000000,SPACE=4                                76200020
QUIT     DC    X'FF'                                                    76400020
PEDIT    DS    0F                                                       76600020
&DSECT   SETC  'YYYY2'                                                  76800020
&CSECT   SETC  'PEDIT'                                                  77000020
         USING *,R9                                                     77200020
         USING YYYY2,R2                                                 77400020
*                                                                       77600020
*        EDIT AND PRINT SECTION                                         77800020
*                                                                       78000020
         DC    A(PENTRY)                                                78200020
         DC    C'IFCS0155'                                              78400020
YR9PTR   DS    F                                                        78600020
YLABEL   DS    F                                                        78800020
YYYY2    DSECT                                                          79000020
         DS    3H                                                       79200020
         DSGEN (YDUMA,16),(YNOREC,16)                                   79400020
         DSGEN (YTYPE,8),(YCHAN,8),(YCUA,24),(YSER,24)                  79600020
         DSGEN (YCPU,16),(YSMSW,16)                                     79800020
         DSGEN (YDATES,64)                                              80000020
IFCS0155 CSECT                                                          80200020
WORK     DS    D                                                        80400020
XSAVE1   DC    5F'0'                                                    80600020
L28      EQU   28                                                       80650002
FSAVE    DS    18F                                                      80700002
SIZE     DC    H'32'                                                    80800020
*                                                                       81000020
*        SPECIAL ROUTINES                                               81200020
*                                                                       81400020
CONVERT  STM   R5,R8,XSAVE1             SAVE REGS                       81600020
         LH    R5,L0(R4)                PICK UP COUNT                   81800020
         CVD   R5,WORK                  CONVERT TO DECIMAL              82000020
         UNPK  L0(L5,R3),WORK+L5(L3)    UNPACK TO PRINT BUFF            82200020
         MVZ   L4(L1,R3),L0(R3)         PUT IN TIGHT ZONE               82400020
         B     RETURNA                  RETURN                          82600020
RETURNA  LM    R5,R8,XSAVE1             RESTORE REGS                    82800020
         BR    R14                      RETURN                          83000020
FREECTR  STM   R14,R12,L12(R13)        SAVE ALL REGS                    83200002
         LR    R12,R13                 SAVE SAVE AREA ADDR              83250002
         LA    R13,FSAVE               POINT TO MY SAVE                 83300002
         ST    R12,L4(R13)             SET CHAINING POINTERS            83350002
         ST    R13,L8(R12)                                              83400002
         L     R3,L4(R2)               PICK UP POINTER TO NEXT COUNTER  83450002
         ST    R3,L28(R12)             SAVE POINTER IN REG SAVE         83500002
         LH    R0,SIZE                 PICK UP SAZE OF AREA             83550002
         LR    R1,R2                   SET ADDRESS                      83600002
         FREEMAIN R,LV=(0),A=(1)                                        83650002
         LTR   R3,R3                   ANY MORE COUNTERS                83700002
         BZ    RETURN0                 NO RETURN                        83750002
         LA    R5,PENTRY+L10           POINT TO TOP ENTRY - 4           83800002
         ST    R5,YR9PTR                                                83850002
         LA    R5,LABELS-L1            POINT TO FIRST LABEL -1          83900002
         ST    R5,YLABEL               STORE IT IN TABLE                83950002
RETURN0  L     R13,L4(R13)             PICK UP &                        84000002
         LM    R14,R12,L12(R13)        RESTORE REGS                     84050002
         BR    R14                                                      84100002
SETDATES UNPK  WORK(L8),L0(L4,R4)       UNPACK LOW DATE                 84400020
         MVZ   WORK+L7(L1),WORK         MOVE IN RIGHT ZONE              84600020
         MVC   L0(L3,R3),WORK+L5        PUT DATE IN PTR BUFF            84800020
         MVC   L5(L2,R3),WORK+L3        PUT YEAR IN PTR BUFF            85000020
         UNPK  WORK(L8),L4(L4,R4)       UNPACK HIGH DATE                85200020
         MVZ   WORK+L7(L1),WORK         MOVE IN RIGHT ZONE              85400020
         MVC   L13(L3,R3),WORK+L5       PUT DATE IN PTR BUFF            85600020
         MVC   L18(L2,R3),WORK+L3       PUT YEAR IN PTR BUFF            85800020
         BR    R14                                                      86000020
PENTRY   DS    0F                                                       86200020
         DC    X'00010001'                                              86400020
         DC    X'00010001'                                              86600020
         DC    A(LABELS)                                                86800020
         DC    H'0'                                                     87000020
         DC    X'01'                                                    87200020
         DC    X'000B8B00'                                              87400020
         LABEL ''                                                       87600020
         LINE  (23,60),(25,25),SKIP=1                                   87800002
         HEX   YCPU                                                     87900002
         LABEL 'MACHINE CHECK RECORDS',                                X88000002
               'DAY YEAR     DAY YEAR'                                  88200020
         LINE  (50,60),(31,28),SKIP=2                                   88400020
         ROUTINE YDATES,SETDATES                                        88600020
         LABEL 'DATE RANGE - FROM','TO'                                 88800020
         LINE  (56,)                                                    88850002
         HEX   YSER                                                     88900002
         LABEL '---- SERIAL NO. - '                                     88950002
         LINE  (72,10),(51,),SKIP=3                                     89000020
         ROUTINE YNOREC,CONVERT                                         89200020
         LABEL 'NO.OF RECORDS'                                          89400020
         LINE  (64,10),(43,23),SKIP=1                                   89600002
         HEX   YCPU                                                     89700002
         LABEL '- SUMMARY OF MODEL ','MACHINE   -'                      89800002
         LINE                                                           90000020
         LABEL     '- CHECK RECORDS NOT PROVIDED BY  -'                 90200020
         LINE                                                           90400020
         LABEL '- EREP...                        -'                     90600002
         LINE                                                           90800020
         LABEL     '- FOR SUMMARY OF LOG INFORMATION -'                 91000020
         LINE                                                           91200020
         LABEL     '- RUN LOG OUT ANALYSIS PROGRAM.  -'                 91400020
         LINE                                                           91450002
         ROUTINE YDUMA,FREECTR                                          91500002
         LABEL ''                                                       91550002
DUMPCODE DC    X'FF'                                                    91600020
DUMPSIZE DC    XL2'0'                                                   91800020
DUMPBEGN DC    XL2'0'                                                   92000020
ADDRLABL DC    XL2'0'                                                   92200020
         DC    C'$'                                                     92250002
LABELS   EQU   *                                                        92400020
         LSTART                                                         92600020
         END                                                            92800020
