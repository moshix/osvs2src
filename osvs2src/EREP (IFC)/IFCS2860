         TITLE 'IFCS2860 - SUM TABLE - LINKNAME=IFCS2860'               00090020
         MACRO                                                          00180020
&NAME    DSGEN &X1,&X2,&X3,&X4,&X5,&X6,&X7,&X8,&X9,&X10,&X11,&X12,&X13,X00270020
               &X14,&X15,&X16,&X17,&X18,&X19,&X20,&X21,&X22,&X23,&X24, X00360020
               &X25,&X26,&X27,&X28,&X29,&X30,&X31,&X32                  00450020
.*                            THIS MACRO GENERATES ONE DSECT WORD       00540020
.*                                 FORMATTED FOR THE SUBJECT LOG RECORD 00630020
.*                                 EACH OPERAND HAS TWO SUB LISTS. THE  00720020
.*                                 FIRST IS THE NAME OF THE LOG ITEM    00810020
.*                                 WHILE THE SECOND IS THE # OF BITS TO 00900020
.*                                 ALLOCATE FOR THIS ITEM. ITEMS MUST   00990020
.*                                 BE DEFINED CONTIGUOUSLY WITHOUT GAPS 01080020
.*                                 UNUSED BIT GROUPS MUST BE GIVEN      01170020
.*                                 DUMMY NAMES. THE NAMES PROVIDED FOR  01260020
.*                                 THE LOG ITEMS MAY THEN BE USED IN    01350020
.*                                 THE CONVERSION MACRO INSTRUCTIONS.   01440020
         GBLC &ITEM(1000)                                               01530020
         GBLA &ITEMNBR,&BITS(1000),&SHIFT(1000)                         01620020
         LCLC  &SYMBOL                                                  01710020
         LCLA  &OP,&COUNT,&BYTE                                         01800020
.LOOP    ANOP                                                           01890020
&OP      SETA  &OP+1                                                    01980020
&ITEMNBR SETA  &ITEMNBR+1                                               02070020
&SYMBOL  SETC  '&SYSLIST(&OP,1)'                                        02160020
         AIF   ('&SYSLIST(&OP,2)' NE '').OK1                            02250020
         MNOTE *,'NULL BIT COUNT FIELD'                                 02340020
         MEXIT                                                          02430020
.OK1     ANOP                                                           02520020
         AIF   ('&SYMBOL' NE '').OK                                     02610020
         MNOTE 'LOG ITEM SYMBOL NOT PROVIDED'                           02700020
         AGO   .CNT                                                     02790020
.OK      ANOP                                                           02880020
         AIF   ('&SYMBOL'(1,1) EQ '''').CNT                *TEMP*       02970020
&SYMBOL  EQU   *+&BYTE                                                  03060020
&ITEM(&ITEMNBR)  SETC '&SYSLIST(&OP,1)'                                 03150020
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2)                                    03240020
&SHIFT(&ITEMNBR) SETA &COUNT-&BYTE*8                                    03330020
.CNT     ANOP                                                           03420020
&COUNT   SETA  &COUNT+&SYSLIST(&OP,2)                                   03510020
&BYTE    SETA  &COUNT/8                                                 03600020
         AIF (&OP LT N'&SYSLIST).LOOP                                   03690020
         AIF   (&COUNT NE 32).NOT32                                     03780020
&NAME    DS    4C                                                       03870020
         MEXIT                                                          03960020
.NOT32   AIF   (&COUNT NE 64).ERR                                       04050020
&NAME    DS    8C                                                       04140020
         MEXIT                                                          04230020
.ERR     MNOTE '**BIT COUNT FIELDS DO NOT TOTAL 32 OR 64**'             04320020
         MEND                                                           04410020
         MACRO                                                          04500020
&NAME    LINE  &DATA,&LABEL,&SKIP=                                      04590020
.*                            THIS MACRO ESTABLISHES THE MARGINS OR     04680020
.*                                 COLUMN SETTINGS FOR EACH LINE. IT    04770020
.*                                 GENERATES NECESSARY CARRIAGE CONTROL 04860020
.*                                 ENTRIES. LASTLY IT DETERMINES THE    04950020
.*                                 NUMBER OF ENTRIES ASSOCIATED WITH    05040020
.*                                 THE PREVIOUS LINE AND STORES THAT #  05130020
.*                                 INTO THE APPROPRIATE BYTE.           05220020
.*                            &DATA(1) - CHARACTER POSITION TO BEGIN    05310020
.*                                 DATA.                                05400020
.*                            &DATA(2) - # OF SPACES BETWEEN SUCCESSIVE 05490020
.*                                 DATA COLUMN STARTING CHARACTERS.     05580020
.*                            &LABEL(1) - CHAR. POS. TO BEGIN LABELS.   05670020
.*                            &LABEL(2) - # SPACES BETWEEN LINE'S LABEL 05760020
.*                                 STARTING CHARACTERS.                 05850020
.*                            &SKIP= - # OF LINES TO ADVANCE CARRIAGE   05940020
.*                                 TO BEGIN NEXT PRINTED LINE.          06030020
.*                            NEW ENTRIES ARE GENERATED ONLY WHEN       06120020
.*                                 NECESSARY. OMISSION OF ITEMS MEANS   06210020
.*                                 THEY HAVE NOT CHANGED SINCE PREVIOUS 06300020
.*                                 SETTINGS. A LINE MACRO IS REQUIRED   06390020
.*                                 FOR EACH PRINTED LINE. IF NO SETTING 06480020
.*                                 CHANGES ARE REQUIRED ALL OPERANDS    06570020
.*                                 ARE OMITTED IN WHICH CASE ONLY THE   06660020
.*                                 # OF ENTRIES FOR THE PREVIOUS LINE   06750020
.*                                 IS COMPUTED. THIS MACRO MUST BE THE  06840020
.*                                 FIRST MACRO INSTRUCTION ISSUED FOR   06930020
.*                                 THE SUBJECT LINE                     07020020
         GBLA  &DB,&DT,&LB,&LT,&NRENTS                                  07110020
         GBLA  &LASTCC,&INITIAL                                         07200020
         GBLC  &NRENTSX                                                 07290020
         GBLC  &CARRCON                                                 07380020
         GBLB  &TEST                                                    07470020
         LCLA  &S                                                       07560020
&NAME    DS    0C                                                       07650020
         AIF   (&INITIAL EQ 0).FIRSTLN                                  07740020
         LINEND                                                         07830020
         AGO   .NTFIRST                                                 07920020
.FIRSTLN ANOP                                                           08010020
&NRENTSX SETC  'N&SYSNDX'                                               08100020
&INITIAL SETA  1                                                        08190020
N&SYSNDX EQU   *                                                        08280020
.NTFIRST ANOP                                                           08370020
         DC    AL1(0)                                                   08460020
         AIF   ('&DATA(1)' EQ '').CKDTABS                               08550020
         AIF   (&DATA(1) EQ &DB).CKDTABS                                08640020
&DB      SETA  &DATA(1)                                                 08730020
         AGO   .AA                                                      08820020
.CKDTABS AIF   ('&DATA(2)' EQ '').NCDATA                                08910020
         AIF   (&DATA(2) EQ &DT).NCDATA                                 09000020
         AGO   .CC                                                      09090020
.AA      AIF   ('&DATA(2)' EQ '').BB                                    09180020
         AIF   (&DATA(2) EQ &DT).BB                                     09270020
.CC      ANOP                                                           09360020
&DT      SETA  &DATA(2)                                                 09450020
.BB      DC    XL2'FFFE'                                                09540020
         DC    FL1'&DB'                                                 09630020
         DC    FL1'&DT'                                                 09720020
&NRENTS  SETA  &NRENTS+1                                                09810020
.NCDATA  ANOP                                                           09900020
         AIF   ('&LABEL(1)' EQ '').CKLTABS                              09990020
         AIF   (&LABEL(1) EQ &LB).CKLTABS                               10080020
&LB      SETA  &LABEL(1)                                                10170020
         AGO   .AAA                                                     10260020
.CKLTABS AIF   ('&LABEL(2)' EQ '').NCLABEL                              10350020
         AIF   (&LABEL(2) EQ &LT).NCLABEL                               10440020
         AGO   .CCC                                                     10530020
.AAA     AIF   ('&LABEL(2)' EQ '').BBB                                  10620020
         AIF   (&LABEL(2) EQ &LT).BBB                                   10710020
.CCC     ANOP                                                           10800020
&LT      SETA  &LABEL(2)                                                10890020
.BBB     DC    XL2'FFFF'                                                10980020
         DC    FL1'&LB'                                                 11070020
         DC    FL1'&LT'                                                 11160020
&NRENTS  SETA  &NRENTS+1                                                11250020
.NCLABEL ANOP                                                           11340020
         AIF   ('&SKIP' NE '').CONT                                     11430020
         AIF   (&TEST EQ 0).NOCHANG                                     11520020
&S       SETA  &LASTCC                                                  11610020
         AGO   .DEFAULT                                                 11700020
.CONT    ANOP                                                           11790020
         AIF   (&TEST EQ 0).AB                                          11880020
&S       SETA  &SKIP                                                    11970020
.DEFAULT ANOP                                                           12060020
         ORG   &CARRCON+3                                               12150020
         DC    AL.3(0),AL.2(&S),AL.3(1)                                 12240020
         ORG                                                            12330020
&LASTCC  SETA  &S                                                       12420020
&TEST    SETB  0                                                        12510020
         AGO   .DD                                                      12600020
.AB      AIF   (&SKIP EQ &LASTCC).NOCHANG                               12690020
A&SYSNDX DC    XL2'FFFB'                                                12780020
         DC    AL.3(0),AL.2(&SKIP),AL.3(1)                              12870020
         DC    FL1'9'                                                   12960020
&LASTCC  SETA  &SKIP                                                    13050020
&TEST    SETB  1                                                        13140020
&CARRCON SETC  'A&SYSNDX'                                               13230020
&NRENTS  SETA  &NRENTS+1                                                13320020
.DD      ANOP                                                           13410020
.NOCHANG ANOP                                                           13500020
         MEND                                                           13590020
         MACRO                                                          13680020
         BIN   &LOGITEM,&SKIP$OR                                        13770020
.*                                 &LOGITEM - NAME OF ITEM IN LOG       13860020
.*                                      RECORD DSECT                    13950020
.*                                 &SKIP$OR - NBR OF SPACES TO SKIP ON  14040020
.*                                 MULTIPLE PRINT OR NBR OF SPACES      14130020
.*                                      TO BACK UP FROM COLUMN FOR      14220020
.*                                      START OF PRINTING. THE LETTER   14310020
.*                                      B PRECEEDS THE NUMBER (B5) IF   14400020
.*                                      THE LATTER IS DESIRED. OMISSION 14490020
.*                                      OF THIS OPERAND FORCES OPTION 2 14580020
.*                                      WITH BACKUP SPACING EQUAL TO    14670020
.*                                 THE NUMBER OF BITS IN THE ITEM       14760020
.*                                 DEFINITION (VIA MACRO 'DSGEN').      14850020
.*                            A LIMIT OF 15 BITS IS IMPOSED FOR THE     14940020
.*                                 TOTAL NUMBER OF BITS TO PRINT.       15030020
         GBLC &ITEM(1000)                                               15120020
         GBLA &ITEMNBR,&BITS(1000),&SHIFT(1000),&NRENTS                 15210020
         GBLC  &DSECT                                                   15300020
         LCLB  &B                                                       15390020
         LCLA  &IBITS,&NDX,&ISHIFT,&K                                   15480020
         LCLA  &TEMP                                                    15570020
         LCLC  &S                                                       15660020
.LOOP    ANOP                                                           15750020
&NDX     SETA  &NDX+1                                                   15840020
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      15930020
         AIF   (&NDX LT &ITEMNBR).LOOP                                  16020020
         MNOTE *,'YOU BLEW IT'                                          16110020
         ROUTINE DUM,SKIPPER                                            16200020
         MEXIT                                                          16290020
.FOUND   ANOP                                                           16380020
&ISHIFT  SETA  &SHIFT(&NDX)                                             16470020
&IBITS   SETA  &BITS(&NDX)                                              16560020
&S       SETC  '&IBITS'                                                 16650020
&B       SETB  1                                                        16740020
         AIF   ('&SKIP$OR' EQ '').BACKUP                                16830020
&K       SETA  K'&SKIP$OR                                               16920020
&B       SETB  ('&SKIP$OR'(1,1) EQ 'B')                                 17010020
&S       SETC  '&SKIP$OR'(&B+1,&K-&B)                                   17100020
.BACKUP  ANOP                                                           17190020
&NRENTS  SETA  &NRENTS+1                                                17280020
&TEMP    SETA  &ISHIFT+1                                                17370020
A&SYSNDX DC    AL.12(&LOGITEM-&DSECT),XL.4'&TEMP'                       17460020
         AIF (&IBITS EQ 1 AND &B EQ 0).OUT                              17550020
         ORG   A&SYSNDX                                                 17640020
         DC    AL.12(&LOGITEM-&DSECT),XL.4'C'                           17730020
         DC    BL.1'&B',AL.7(&S),AL.4(&IBITS),FL.4'&ISHIFT'             17820020
.OUT     ANOP                                                           17910020
         MEND                                                           18000020
         MACRO                                                          18090020
         HEX   &LOGITEM,&SKIP$OR,&BYTES                                 18180020
.*                            THIS MACRO FACILITATES GENERATION OF THE  18270020
.*                                 TABLE ENTRIES SPECIFYING HEX TYPE    18360020
.*                                 CONVERSIONS.                         18450020
.*                            &LOGITEM - NAME OF DATA ITEM TO BE        18540020
.*                                 CONVERTED                            18630020
.*                            &SKIP$OR - NUMBER OF SPACES TO SKIP ON    18720020
.*                                 MULTIPLE PRINT OR NBR OF SPACES TO   18810020
.*                                 BACK UP FROM COLUMN FOR START OF     18900020
.*                                 PRINTING. THE LETTER B PRECEEDS THE  18990020
.*                                 NUMBER (B8) IF THE LATTER OPTION IS  19080020
.*                                 DESIRED. OMISSION OF THIS OPERAND    19170020
.*                                 FORCES OPTION 2 WITH BACKUP SPACING  19260020
.*                                 EQUAL TO THE NUMBER OF BYTES SPECI-  19350020
.*                                 FIED BY THE NEXT OPERAND (TWICE THIS 19440020
.*                                 NUMBER IF SUFFIX IS EXPLICITLY OR    19530020
.*                                 IMPLICITLY B).                       19620020
.*                            &BYTES - NUMBER OF TOTAL INPUT BYTES TO   19710020
.*                                 PROCESS. THIS NUMBER IS SUFFIXED     19800020
.*                                 WITH AN L,R, OR B TO STIPULATE       19890020
.*                                 PRINTING OF THE LEFT HALF, RIGHT     19980020
.*                                 HALF, OR BOTH HALVES OF THE BYTE     20070020
.*                                 RESPECTIVELY. OMISSION OF THIS       20160020
.*                                 OPERAND DEFAULTS TO B WITH THE NUM-  20250020
.*                                 BER OF BYTES EQUAL TO THE ITEM LNGTH 20340020
.*                            A NEW ENTRY IS GENERATED ONLY WHEN NECES- 20430020
.*                                 SARY. THIS MACRO MUST BE THE FIRST   20520020
.*                                 MACRO INSTRUCTION ISSUED FOR THE     20610020
.*                                 SUBJECT LINE(S).                     20700020
         GBLC &ITEM(1000),&DSECT                                        20790020
         GBLA &ITEMNBR,&BITS(1000),&SHIFT(1000),&NRENTS                 20880020
         LCLB  &B                                                       20970020
         LCLA  &IBITS,&NDX,&ISHIFT,&K,&T,&CODE,&BYTESP                  21060020
         LCLC  &S,&LETTER                                               21150020
.LOOP    ANOP                                                           21240020
&NDX     SETA  &NDX+1                                                   21330020
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      21420020
         AIF   (&NDX LT &ITEMNBR).LOOP                                  21510020
         MNOTE *,'LOG ITEM NOT DEFINED'                                 21600020
         MEXIT                                                          21690020
.FOUND   ANOP                                                           21780020
&ISHIFT  SETA  &SHIFT(&NDX)                                             21870020
&IBITS   SETA  &BITS(&NDX)                                              21960020
&CODE    SETA  1                                                        22050020
&K       SETA  K'&BYTES                                                 22140020
         AIF   (&IBITS-(&IBITS/4)*4 EQ 0).OK                            22230020
         MNOTE *,'BIT LENGTH SPECIFICATION INCONSISTENT WITH CONTROL'   22320020
         MEXIT                                                          22410020
.OK      AIF   ('&BYTES' EQ '').USEDEFN                                 22500020
&LETTER  SETC  '&BYTES'(&K,1)                                           22590020
&S       SETC  '&BYTES'(1,&K-1)                                         22680020
&BYTESP  SETA  &S                                                       22770020
         AIF   ('&LETTER' EQ 'B').BOTH                                  22860020
         AIF   (&ISHIFT EQ 0 OR &ISHIFT EQ 4).OK2                       22950020
.ERR     MNOTE *,'DATA NOT ALLIGNED ON HEX OR BYTE BOUNDARY'            23040020
         MEXIT                                                          23130020
.USEDEFN ANOP                                                           23220020
&BYTESP  SETA  &IBITS/8                                                 23310020
.BOTH    AIF   (&ISHIFT NE 0).ERR                                       23400020
&CODE    SETA  3                                                        23490020
&T       SETA  &BYTESP*2                                                23580020
&S       SETC  '&T'                                                     23670020
.OK2     AIF   (&ISHIFT EQ 0).L                                         23760020
&CODE    SETA  2                                                        23850020
.L       ANOP                                                           23940020
&B       SETB  1                                                        24030020
         AIF   ('&SKIP$OR' EQ '').BACKUP                                24120020
&K       SETA  K'&SKIP$OR                                               24210020
&B       SETB  ('&SKIP$OR'(1,1) EQ 'B')                                 24300020
&S       SETC  '&SKIP$OR'(&B+1,&K-&B)                                   24390020
.BACKUP  ANOP                                                           24480020
&NRENTS  SETA  &NRENTS+1                                                24570020
         DC    AL.12(&LOGITEM-&DSECT),XL.4'A'                           24660020
         DC    BL.1'&B',FL.7'&S',FL.4'&BYTESP',FL.4'&CODE'              24750020
.OUT     ANOP                                                           24840020
         MEND                                                           24930020
         MACRO                                                          25020020
&NAME    ROUTINE &LOGITEM,&RNAME                                        25110020
         GBLA  &NRENTS                                                  25200020
         GBLC  &DSECT,&CSECT                                            25290020
&NAME    DC    AL.12(&LOGITEM-&DSECT),XL.4'D'                           25380020
         DC    AL2(&RNAME-&CSECT)                                       25470020
&NRENTS  SETA  &NRENTS+1                                                25560020
         MEND                                                           25650020
         MACRO                                                          25740020
         LABEL &LABEL1,&LABEL2,&LABEL3,&LABEL4                          25830020
.*                            THIS MACRO ALLOWS UP TO FOUR LABELS TO    25920020
.*                                 BE SPECIFIED FOR A GIVEN LINE. THE   26010020
.*                                 LABELS SHOULD BE ENCLOSED IN QUOTA-  26100020
.*                                 TION MARKS. THE COLUMN AND LINE END  26190020
.*                                 CONTROLS WILL BE INSERTED BY THE     26280020
.*                                 MACRO. OMITTED OPERANDS MEAN NO      26370020
.*                                 LABEL REQUIRED FOR RESPECTIVE        26460020
.*                                 COLUMN. THIS MACRO WILL ALSO ALERT   26550020
.*                                 THE PROGRAMMER TO EXACTLY WHERE THE  26640020
.*                                 TABLE MUST BE BROKEN IF NECESSARY    26730020
.*                                 TO AVOID EXCEEDING THE MAXIMUM LIMIT 26820020
         GBLC &LABELS(1000)                                             26910020
         GBLA  &LABELNR                                                 27000020
         GBLA  &NRENTS                                                  27090020
         LCLC  &MARGIN,&TACK                                            27180020
         LCLC  &TEXT                                                    27270020
         LCLA  &OP,&K,&START,&NRCHAR,&REMAIN                            27360020
&MARGIN  SETC  '*'                                                      27450020
.LOOPOUT ANOP                                                           27540020
&OP      SETA  &OP+1                                                    27630020
&K       SETA  K'&SYSLIST(&OP)                                          27720020
         AIF (&K GE 2).NORM                                             27810020
&K       SETA  2                                                        27900020
.NORM    ANOP                                                           27990020
&START   SETA  2                                                        28080020
         AIF (&OP LT N'&SYSLIST).NOTLAST                                28170020
&MARGIN  SETC  '$'                                                      28260020
.NOTLAST ANOP                                                           28350020
&NRCHAR  SETA  8                                                        28440020
&TACK    SETC  ''                                                       28530020
.LOOPIN  ANOP                                                           28620020
&REMAIN  SETA  &K-&START                                                28710020
         AIF (&REMAIN GE 8).MORE                                        28800020
&TACK    SETC  '&MARGIN'                                                28890020
&NRCHAR  SETA  &REMAIN                                                  28980020
.MORE    ANOP                                                           29070020
&TEXT    SETC  ''                                                       29160020
         AIF (&REMAIN EQ 0).ENDTEXT                                     29250020
&TEXT    SETC  '&SYSLIST(&OP)'(&START,&NRCHAR)                          29340020
.ENDTEXT ANOP                                                           29430020
&LABELNR SETA  &LABELNR+1                                               29520020
&LABELS(&LABELNR) SETC '&TEXT'.'&TACK'                                  29610020
&START   SETA  &START+8                                                 29700020
         AIF ('&TACK' EQ '').LOOPIN                                     29790020
         AIF ('&TACK' EQ '*').LOOPOUT                                   29880020
         MEND                                                           29970020
         MACRO                                                          30060020
         LSTART                                                         30150020
.*                            THIS MACRO IS ISSUED WHEN THE LABEL AREA  30240020
.*                                 OF THE TABLE IS TO BEGIN.            30330020
         GBLC &LABELS(1000)                                             30420020
         GBLA  &LABELNR                                                 30510020
         LCLA  &NDX                                                     30600020
         LINEND                                                         30690020
.LOOP    ANOP                                                           30780020
&NDX     SETA  &NDX+1                                                   30870020
         DC    C'&LABELS(&NDX)'                                         30960020
         AIF   (&NDX LT &LABELNR).LOOP                                  31050020
         MEND                                                           31140020
         MACRO                                                          31230020
         LINEND                                                         31320020
.*                            THIS MACRO IS USED ONLY BY THE LINE       31410020
.*                                 MACRO TO SET THE NUMBER OF ENTRIES   31500020
.*                                 ASSOCIATED WITH EACH LINE.           31590020
         GBLA  &NRENTS                                                  31680020
         GBLC &NRENTSX                                                  31770020
         ORG   &NRENTSX                                                 31860020
         DC    FL1'&NRENTS'                                             31950020
         ORG                                                            32040020
&NRENTS  SETA  0                                                        32130020
B&SYSNDX EQU   *                                                        32220020
&NRENTSX SETC  'B&SYSNDX'                                               32310020
         MEND                                                           32400020
         MACRO                                                          32490020
         SUM   &LOGITEM,&MASK                                           32580020
.*                            THIS MACRO GENERATES A NORMAL EDIT ENTRY  32670020
.*                                 FOR PROCESSING BY THE SUMMARY MODULE 32760020
.*                            &LOGITEM - NAME OF DATA ITEM TO BE SUMMED 32850020
.*                            &MASK - BYTE MASK FOR BITS TO BE TESTED.  32940020
.*                                 THIS OPERAND SHOULD BE OMITTED FOR   33030020
.*                                 SINGLE BIT ITEMS IN WHICH CASE THE   33120020
.*                                 MASK WILL BE SET ACCORDING TO THE    33210020
.*                                 OFF BYTE BIT DISPLACEMENT OF THE     33300020
.*                                ITEM AS DEFINED BY THE MACRO 'DSGEN'  33390020
         GBLA  &COUNTR,&ITEMNBR,&BITS(1000),&SHIFT(1000)                33480020
         GBLC  &ITEM(1000),&DSECT                                       33570020
         LCLA  &IBITS,&NDX,&ISHIFT,&M,&BITNBR                           33660020
.LOOP    ANOP                                                           33750020
&NDX     SETA  &NDX+1                                                   33840020
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      33930020
         AIF   (&NDX LT &ITEMNBR).LOOP                                  34020020
         MNOTE *,'LOGITEM NOT FOUND'                                    34110020
         MEXIT                                                          34200020
.FOUND   ANOP                                                           34290020
         DC    AL1(0)                                                   34380020
&ISHIFT  SETA  &SHIFT(&NDX)                                             34470020
&IBITS   SETA  &BITS(&NDX)                                              34560020
         AIF   ('&MASK' EQ '').FORM                                     34650020
         DC    B'&MASK'                                                 34740020
         AGO   .ITEM                                                    34830020
.FORM    ANOP                                                           34920020
&BITNBR  SETA  &ISHIFT-7                                                35010020
&BITNBR  SETA  0-&BITNBR                                                35100020
&M       SETA  1                                                        35190020
.LOOP2   ANOP                                                           35280020
         AIF   (&BITNBR EQ 0).GOTIT                                     35370020
&M       SETA  &M*2                                                     35460020
&BITNBR  SETA  &BITNBR-1                                                35550020
         AGO   .LOOP2                                                   35640020
.GOTIT   ANOP                                                           35730020
         DC    AL1(&M)                                                  35820020
.ITEM    DC    AL2(&LOGITEM-&DSECT)                                     35910020
         DC    AL2(&COUNTR)                                             36000020
&COUNTR  SETA  &COUNTR+1                                                36090020
         MEND                                                           36180020
         MACRO                                                          36270020
         SPECIAL  &ROUTINE,&PARAM,&SPACE=                               36360020
.*                            THIS MACRO GENERATES A SPECIAL ROUTINE    36450020
.*                                 ENTRY TO BE PROCESSED BY THE SUM. M. 36540020
.*                            &ROUTINE - SYMBOL ON SPECIAL ROUTINE EWT. 36630020
.*                            &PARAM - AN 8 BIT BINARY REPRESENTATION   36720020
.*                                 TO OCCUPY THE 'MASK' FIELD BUT TO BE 36810020
.*                                 INTERPRETED AS AN ARGUMENT OF THE    36900020
.*                                 SPECIAL ROUTINE.                     36990020
.*                            &SPACE - THE NUMBER OF 2BYTE COUNTERS TO  37080020
.*                                 ALLOCATE FOR REQUIRED PROCESSING.    37170020
         GBLC  &CSECT                                                   37260020
         GBLA  &COUNTR                                                  37350020
         LCLA  &ADD                                                     37440020
         DC    AL1(128)                                                 37530020
         DC    BL.8'&PARAM'                                             37620020
         DC    AL2(&ROUTINE-&CSECT)                                     37710020
         DC    AL2(&COUNTR)                                             37800020
&ADD     SETA  1                                                        37890020
         AIF   ('&SPACE' EQ '').NORM                                    37980020
&ADD     SETA  &SPACE                                                   38070020
.NORM    ANOP                                                           38160020
&COUNTR  SETA  &COUNTR+&ADD                                             38250020
         MEND                                                           38340020
         GBLC  &DSECT,&CSECT                                            38430020
IFCS2860 CSECT                                                          38520020
&CSECT   SETC  'IFCS2860'                                               38610020
&DSECT   SETC  'C2860'                                                  38700020
C2860    DSECT                                                          38790020
DUM      EQU   *                                                        38880020
         DSGEN (XKEY,16),(XSWS,16),(XDUM1,32)                           38970020
         DSGEN (XDATE,32),(XTIME,32)                                    39060020
         DSGEN (XDUM2,8),(XSER,24),(XMOD,16),(MCEL,16)                  39150020
         DSGEN (XPGMN,64)                                               39240020
         DSGEN (XAIO1,64)                                               39330020
         DSGEN (XAIO5,64)                                               39420020
         DSGEN (XFCCW,64)                                               39510020
         DSGEN (XCSW,32),(XCSWS,12),(XCDC,1),(XCCC,1),(XIFC,1),(XD,17)  39600020
         DSGEN (XECSW,32)                                               39690020
         DSGEN (XDEVT1,16),(XDEVT2,16)                                  39780020
         DSGEN (XCHID,8),(XCUA,24)                                      39870020
         DSGEN (XMPIN,32)                                               39960020
DATA     EQU   *                                                 43068  40010002
SL130    DSGEN (CLWKEY1,4),(DUM61,4),(CLWCADR,24)                       40050020
         SPACE 2                                                        40140020
SL130A   DSGEN (DUM62,8),(CLWSTAT,8),(CLWCOUNT,16)                      40230020
         SPACE 2                                                        40320020
SL138    DSGEN (CLWBREG,8),(CLWCREG,8),(CLWFREG,5),(CLWCHAD,3),        X40410020
               (CLWUARG,8)                                              40500020
         SPACE 2                                                        40590020
SL138A   DSGEN (CLWDARG,24),(CLWSIMRG,8)                                40680020
         SPACE 2                                                        40770020
SL140    DSGEN (CLWARGFL,1),(CLWBRGFL,1),(CLWCHCML,1),(CLWSEQ1,1),     X40860020
               (CLWSEQ2,1),(CLWSEQ3,1),(CLWSEQ4,1),(CLWSEQ5,1),        X40950020
               (CLWCCWV,1),(CLWREAD,1),(CLWWRITE,1),(CLWSETUP,1),      X41040020
               (CLWTIC,1),(CLWTICHZ,1),(CLWPIRPT,1),(CLWCDALT,1),      X41130020
               (CLWLWT,1),(CLWBCCBT,1),(CLWBCOLT,1),(CLWBCTGR,1),      X41220020
               (CLWBCREG,1),(CLWBIT3,1),(CLWBIT2,1),                   X41310020
               (CLWBIT1,1),(CLWCLOCK,8)                                 41400020
         SPACE 2                                                        41490020
SL140A   DSGEN (CLWOPIN,1),(DUM63,1),                                  X41580020
               (CLWADOLT,1),(CLWSLOLT,1),(CLWSEROT,1),(CLWCOMOT,1),    X41670020
               (CLWSTIO,1),(CLWHTIO,1),                        @YM6454PX41760002
               (CLWIDA00,1),(CLWDIN00,1),(CLWSTO00,1),         @YM6454PX41800002
               (DUM64,2),(CLWSTOCK,1),(DUM65,2),               @YM6454PX41840002
               (CLWPSPR,1),(CLWPOCAR,1),(CLWP1CAR,1),(CLWP2CAR,1),     X41880002
               (CLWPDIB,1),(CLWPOCRG,1),(CLWP1CRG,1),(CLWP2CRG,1),     X41940020
               (CLWPUAR,1),(CLWP0DAR,1),(CLWP1DAR,1),(CLWP2DAR,1),     X42030020
               (CLWPMBR,1),(CLWPCOMR,1),(CLWPFLAG,1),(CLWPSIMR,1)       42120020
         EJECT                                                          42210020
IFCS2860 CSECT                                                          42300020
ENTRYPTR DC    A(EDIT)                                                  42390020
         DC    A(PEDIT)            POINTER TO EDIT SECTION              42480020
REG9     DS    F                                                        42570020
SCSIZE   DC    H'300'                                                   42660020
ROUTINES EQU   *                                                        42750020
LOGREG   EQU   2                                                        42840020
@FAILCCW DS    0F                                                       42930020
         USING *,15                                                     43020020
         STM   14,12,12(13)                                             43110020
         SR    7,7                                                      43200020
         IC    7,FCCW(LOGREG)                                           43290020
FCCW     EQU   48                                                       43380020
         B     COMMON                                                   43470020
@UNIT    DS    0F                                                       43560020
         USING *,15                                                     43650020
         STM   14,12,12(13)                                             43740020
         SR    7,7                                                      43830020
         IC    7,91(LOGREG)                                             43920020
         B     COMMON                                                   44010020
@DEVADR  DS    0F                                                       44100020
         USING *,15                                                     44190020
         STM   14,12,12(13)                                             44280020
         SR    7,7                 LOAD DEVICE ADDRESS                  44370020
         IC    7,74(LOGREG)                                             44460020
         SLL   7,8                                                      44550020
         IC    7,75(LOGREG)                                             44640020
COMMON   EQU   *                                                        44730020
         BALR  12,0                                                     44820020
         USING *,12                                                     44910020
         L     1,R9ADR                                                  45000020
         L     9,0(1)                                                   45090020
         SR    1,1                                                      45180020
         IC    1,1(9)              ITERATIONS                           45270020
         LR    5,1                                                      45360020
         SLL   5,2                                                      45450020
         AR    5,3                 COMPUTE COUNTER ADDRESS PAST TEXT    45540020
         LH    4,=X'FFFF'                                               45630020
LOOP1    CH    4,0(3)              TEST FOR EMPTY/FULL                  45720020
         BNE   STORE                                                    45810020
         CH    7,2(3)              FULL - COMPARE WITH STORED DATA      45900020
         BE    BUMP                                                     45990020
         LA    3,4(3)              NOT SAME - GO TO NEXT TEXT CELL      46080020
         LA    5,2(5)                                                   46170020
         BCT   1,LOOP1                                                  46260020
         B     FULL                ALL CELLS FULL - NO MATCH            46350020
STORE    EQU   *                                                        46440020
         STH   4,0(3)              STORE NEW TEXT DATA                  46530020
         STH   7,2(3)                                                   46620020
BUMP     EQU   *                                                        46710020
         LH    6,0(5)              BUMP COUNTER BY ONE                  46800020
         AH    6,=H'1'                                                  46890020
         STH   6,0(5)                                                   46980020
FULL     EQU   *                                                        47070020
         LM    14,12,12(13)                                             47160020
         BR    14                                                       47250020
*                                                                       47340020
*        SAVE  DATE RANGE                                               47430020
*                                                                       47520020
         DROP  15                                                       47610020
         DROP  12                                                       47700020
         USING C2860,R2                                                 47790020
         USING IFCS2860,R9                                              47880020
*                                                                       47970020
XDATE1   CLC   XDATE(L4),HEX00          IS DATE ZERO                    48060020
         BE    EXIT                                                     48150020
         CLC   L0(L4,R3),HEX00    IS LOW DATE = ZERO ?                  48240020
         BNE   XDATE2                                                   48330020
         MVC   L0(L4,R3),XDATE    IF YES MOVE IN DATE                   48420020
XDATE2   EQU   *                                                        48510020
         CLC   XDATE(L4),L0(R3)         CHECK AGAINST LOW DATE          48600020
         BL    SAVELO                   BR-THIS IS LOWER                48690020
         CLC   XDATE(L4),L4(R3)         CHECK AGAIN HI                  48780020
         BH    SAVEHI                                                   48870020
EXIT     BR    R14                      RETURN                          48960020
SAVEHI   MVC   L4(L4,R3),XDATE          SAVE HI DATE IN COUNTER         49050020
         B     EXIT                                                     49140020
SAVELO   MVC   L0(L4,R3),XDATE          SAVE LO                         49230020
         B     EXIT                                                     49320020
ALLFFF   STM   R5,R8,SSAVE              SAVE REGS                43068  49370002
         LA    R4,DATA                  POINT TO DATA            43068  49380002
AG       CLC   L0(L4,R4),HFFF           IS WORD ALL FF"S         43068  49390002
         BNE   OK                       BR - NO                  43068  49400002
         LA    R5,QUIT-L6               POINT TO END             43068  49402002
         ST    R5,REG9                  STORE IN LIST            43068  49404002
OK       LM    R5,R8,SSAVE              RESTORE REGS             43068  49406002
         BR    R14                      EXIT                     43068  49408002
SSAVE    DC    4F'0'                    SMALL SAVE AREA          43068  49408402
HFFF     DC    X'FFFFFFFF'                                       43068  49408802
HEX00    DC    F'0'                                                     49410020
R9ADR    DC    A(REG9)                                                  49500020
EDIT     EQU   *                                                        49590020
*                        SPECIAL ROUTINES REQUIRED                      49680020
         SPECIAL XDATE1,00000000,SPACE=4                                49770020
*                                                                       49860020
*        LABELS NEEDED FOR HEADER                                       49950020
*                                                                       50040020
         LABEL ' '            SKIP TO CH 1                              50130020
         LABEL 'DAY YEAR   DAY YEAR'                                    50220020
         LABEL 'INBOARD DATE RANGE','TO'                                50310020
         LABEL      '---MODEL--','SERIAL NO'                     S21021 50400002
         LABEL '---CHANNEL NUMBER--'                                    50490020
         LABEL 'CHANNEL INBOARD SUMMARY FOR  2860 CHANNEL'              50580020
         LABEL 'NUMBER OF RECORDS EXAMINED ='                           50670020
         LABEL '--------TITLE--------','TOTAL'                          50760020
*                                                                       50850020
         LABEL 'DEVICE ADDRESS SUMMARY (MAX- 10 VALUES)'                50940020
         LABEL ' '                                                      51030020
         LABEL ' '                                                      51120020
         LABEL ' '                                                      51210020
         LABEL ' '                                                      51300020
         LABEL ' '                                                      51390020
         LABEL ' '                                                      51480020
         LABEL ' '                                                      51570020
         LABEL ' '                                                      51660020
         LABEL ' '                                                      51750020
         LABEL ' '                                                      51840020
         LABEL 'FAILING CCW SUMMARY(MAX-10 VALUES)'                     51930020
         LABEL 'CMND CODE'                                              52020020
         LABEL ' '                                                      52110020
         LABEL ' '                                                      52200020
         LABEL ' '                                                      52290020
         LABEL ' '                                                      52380020
         LABEL ' '                                                      52470020
         LABEL ' '                                                      52560020
         LABEL ' '                                                      52650020
         LABEL ' '                                                      52740020
         LABEL ' '                                                      52830020
         LABEL ' '                                                      52920020
         LABEL '--------TITLE--------                TOTAL',           C53010020
               '--------TITLE--------                TOTAL'             53100020
         SPECIAL @DEVADR,00001010,SPACE=30                              53190020
         SPECIAL @FAILCCW,00001010,SPACE=30                             53280020
         SUM        XCDC                                                53370020
         SUM        XCCC                                                53460020
         SUM        XIFC                                                53550020
         LABEL 'CHAN DATA CHK'                                          53640020
         LABEL 'CHAN CTRL CHK'                                          53730020
         LABEL 'IF CTRL CHK'                                            53820020
         SPECIAL ALLFFF,0,SPACE=0                                43068  53870002
         LABEL 'CONTROL TRIGGER SUMMARY'                                53910020
         SUM   CLWARGFL                                                 54000020
         SUM   CLWWRITE                                                 54090020
         LABEL 'A REG FULL','WR'                                        54180020
         SUM   CLWBRGFL                                                 54270020
         SUM   CLWSETUP                                                 54360020
         LABEL 'B REG FULL','SET UP'                                    54450020
         SUM   CLWCHCML                                                 54540020
         SUM   CLWTIC                                                   54630020
         LABEL 'CHAIN CMND LATCH','TIC'                                 54720020
         SUM   CLWSEQ1                                                  54810020
         SUM   CLWTICHZ                                                 54900020
         LABEL 'SEQ 1','TIC CYCLE'                                      54990020
         SUM   CLWSEQ2                                                  55080020
         SUM   CLWPIRPT                                                 55170020
         LABEL 'SEQ 2','POLLING INTERRUPT'                              55260020
         SUM   CLWSEQ3                                                  55350020
         SUM   CLWCDALT                                                 55440020
         LABEL 'SEQ 3','CDA LATCH'                                      55530020
         SUM   CLWSEQ4                                                  55620020
         SUM   CLWLWT                                                   55710020
         LABEL 'SEQ 4','LAST WORD TRG'                                  55800020
         SUM   CLWSEQ5                                                  55890020
         SUM   CLWBCCBT                                                 55980020
         LABEL 'SEQ 5','BC EQ CTB TRG'                                  56070020
         SUM   CLWCCWV                                                  56160020
         SUM   CLWBCOLT                                                 56250020
         LABEL 'CCW VALID','BC EQ 0 LATCH'                              56340020
         SUM   CLWREAD                                                  56430020
         SUM   CLWBCTGR                                                 56520020
         LABEL 'RD','BC EQ 0 TRG'                                       56610020
         LABEL 'I.F. TAGS SUMMARY'                                      56700020
         SUM   CLWOPIN                                                  56790020
         SUM   CLWADOLT                                                 56880020
         LABEL 'OP-I','AD-0 LATCH'                                      56970020
         SUM   CLWSLOLT                                                 57060020
         SUM   CLWSEROT                                                 57150020
         LABEL 'SL-0 LATCH','SR-0 LATCH'                                57240020
         SUM   CLWCOMOT                                                 57330020
         SUM   CLWSTIO                                                  57420020
         LABEL 'CM-0','SIO LATCH'                                       57510020
         SUM   CLWHTIO                                                  57600020
         SUM   CLWSTOCK                                                 57690020
         LABEL 'HALT I/O LATCH','STG CHECK'                             57780020
         SUM   CLWIDA00                                        @YM6454P 57790002
         SUM   CLWIDA00                                        @YM6454P 57800002
         SUM   CLWDIN00                                        @YM6454P 57810002
         SUM   CLWSTO00                                        @YM6454P 57820002
         LABEL  'IDA FETCH','DISCONNECT IN'                    @YM6454P 57830002
         LABEL  'STORAGE TIMEOUT'                              @YM6454P 57840002
         LABEL 'REGISTER PARITY CHECK SUMMARY'                          57870020
         SUM   CLWPSPR                                                  57960020
         SUM   CLWPOCAR                                                 58050020
         LABEL 'STG PROTECT','P0 CMND ADDR'                             58140020
         SUM   CLWPCOMR                                                 58230020
         SUM   CLWP1CAR                                                 58320020
         LABEL 'COMMAND','P1 CMND ADDR'                                 58410020
         SUM   CLWP0DAR                                                 58500020
         SUM   CLWP2CAR                                                 58590020
         LABEL 'P0 DATA ADDR','P2 CMND ADDR'                            58680020
         SUM   CLWP1DAR                                                 58770020
         SUM   CLWPOCRG                                                 58860020
         LABEL 'P1 DATA ADDR','P0 COUNT'                                58950020
         SUM   CLWP2DAR                                                 59040020
         SUM   CLWP1CRG                                                 59130020
         LABEL 'P2 DATA ADDR','P1 COUNT'                                59220020
         SUM   CLWPUAR                                                  59310020
         SUM   CLWP2CRG                                                 59400020
         LABEL 'UNIT ADDR','P2 COUNT'                                   59490020
*                        UNIT NUMBER SUMMARY ???                        59580020
         SPECIAL @UNIT,0001010,SPACE=30                                 59670020
QUIT     DC    XL1'FF'                                                  59760020
PEDIT    DS    0F                                                       59850020
         USING *,R9                                                     59940020
         DC    A(PENTRY)                                                60030020
         DC    C'IFCS2860'                                              60120020
YR9PTR   DC    F'0'                                                     60210020
YLABELP  DC    F'0'                                                     60300020
&CSECT   SETC  'PEDIT'                                                  60390020
&DSECT   SETC  'D2860'                                                  60480020
*                                                                       60570020
D2860    DSECT                                                          60660020
         DS    3H                                                       60750020
         DSGEN (YDUMA,16),(YNOREC,16)                                   60840020
         DSGEN (YTYPE,8),(YCHAN,8),(YCUA,24),(YSER,24)                  60930020
         DSGEN (YCPU,16),(YSMSW,16)                                     61020020
         DSGEN (YLOD,32),(YHID,32)                                      61110020
         DSGEN (YFFF01,16),(YCC01,16),(YFFF02,16),(YCC02,16)            61200020
         DSGEN (YFFF03,16),(YCC03,16),(YFFF04,16),(YCC04,16)            61290020
         DSGEN (YFFF05,16),(YCC05,16),(YFFF06,16),(YCC06,16)            61380020
         DSGEN (YFFF07,16),(YCC07,16),(YFFF08,16),(YCC08,16)            61470020
         DSGEN (YFFF09,16),(YCC09,16),(YFFF10,16),(YCC10,16)            61560020
         DSGEN (YSC01,16),(YSC02,16)                                    61650020
         DSGEN (YSC03,16),(YSC04,16)                                    61740020
         DSGEN (YSC05,16),(YSC06,16)                                    61830020
         DSGEN (YSC07,16),(YSC08,16)                                    61920020
         DSGEN (YSC09,16),(YSC10,16)                                    62010020
         DSGEN (YFFF11,16),(YNC11,8),(YCC11,8)                          62100020
         DSGEN (YFFF12,16),(YNC12,8),(YCC12,8)                          62190020
         DSGEN (YFFF13,16),(YNC13,8),(YCC13,8)                          62280020
         DSGEN (YFFF14,16),(YNC14,8),(YCC14,8)                          62370020
         DSGEN (YFFF15,16),(YNC15,8),(YCC15,8)                          62460020
         DSGEN (YFFF16,16),(YNC16,8),(YCC16,8)                          62550020
         DSGEN (YFFF17,16),(YNC17,8),(YCC17,8)                          62640020
         DSGEN (YFFF18,16),(YNC18,8),(YCC18,8)                          62730020
         DSGEN (YFFF19,16),(YNC19,8),(YCC19,8)                          62820020
         DSGEN (YFFF20,16),(YNC20,8),(YCC20,8)                          62910020
         DSGEN (YSC11,16),(YSC12,16)                                    63000020
         DSGEN (YSC13,16),(YSC14,16)                                    63090020
         DSGEN (YSC15,16),(YSC16,16)                                    63180020
         DSGEN (YSC17,16),(YSC18,16)                                    63270020
         DSGEN (YSC19,16),(YSC20,16)                                    63360020
         DSGEN (YCDC,16),(YCCC,16),(YIFC,16),(YARGFL,16)                63450020
         DSGEN (YWR,16),(YBRGFL,16),(YSETUP,16),(YCHCML,16)             63540020
         DSGEN (YTIC,16),(YSEQ1,16),(YTICHZ,16),(YSEQ2,16)              63630020
         DSGEN (YPIRPT,16),(YSEQ3,16),(YCDALT,16),(YSEQ4,16)            63720020
         DSGEN (YLWT,16),(YSEQ5,16),(YBCCPT,16),(YCCWV,16)              63810020
         DSGEN (YBCOLT,16),(YREAD,16),(YBCTGR,16),(YOPIN,16)            63900020
         DSGEN (YADOLT,16),(YSLOLT,16),(YSEROT,16),(YCOMOT,16)          63990020
         DSGEN (YSTIO,16),(YHTIO,16),(YSTOCK,16),(RWL01,16)    @YM6454P 64080002
         DSGEN (YIDA00,16),(YDIN00,16),(YSTO00,16),(YPSPR,16)  @YM6454P 64120002
         DSGEN (YPOCAR,16),(YPCOMR,16),(YP1CAR,16),(YP0DAR,16)          64170020
         DSGEN (YP2CAR,16),(YP1DAR,16),(YPOCRG,16),(YP2DAR,16)          64260020
         DSGEN (YP1CRG,16),(YPUAR,16),(YP2CRG,16),(YFFF21,16)           64350020
         DSGEN (YNC21,8),(YCC21,8),(YFFF22,16),(YNC22,8),(YCC22,8),    C64440020
               (YFFF23,16)                                              64530020
         DSGEN (YNC23,8),(YCC23,8),(YFFF24,16),(YNC24,8),(YCC24,8),    C64620020
               (YFFF25,16)                                              64710020
         DSGEN (YNC25,8),(YCC25,8),(YFFF26,16),(YNC26,8),(YCC26,8),    C64800020
               (YFFF27,16)                                              64890020
         DSGEN (YNC27,8),(YCC27,8),(YFFF28,16),(YNC28,8),(YCC28,8),    C64980020
               (YFFF29,16)                                              65070020
         DSGEN (YNC29,8),(YCC29,8),(YFFF30,16),(YNC30,8),(YCC30,8),    C65160020
               (YSC21,16)                                               65250020
         DSGEN (YSC22,16),(YSC23,16),(YSC24,16),(YSC25,16)              65340020
         DSGEN (YSC26,16),(YSC27,16),(YSC28,16),(YSC29,16)              65430020
         DSGEN (YSC30,16),(YSC31,16),(YSC32,16),(YSC33,16)              65520020
IFCS2860 CSECT                                                          65610020
         DS    0F                                                       65700020
CONVERT  STM   R5,R8,XSAVE              SAVE REGS                       65790020
         LH    R5,L0(R4)                PICK UP COUNT                   65880020
         CVD   R5,WORK                  CONVERT IT                      65970020
         UNPK  L0(L4,R3),WORK+L4(L4)    UNPACK IT TO PRINT LINE         66060020
         MVZ   L3(L1,R3),L0(R3)         MOVE ON ZONE                    66150020
RETURNA  LM    R5,R8,XSAVE              RESTORE                         66240020
RETURNB  BR    R14                      RETURN                          66330020
*                                                                       66420020
SKIPPER  BR    R14                                                      66510020
*                                                                       66600020
CONVCC1  CLC   L0(L2,R4),HEXFFFF        IS COUNTER IN USE               66690020
         BE    RETURNB                  YES                             66780020
         SR    R15,R15                  NO STOP PRINTING                66870020
         BR    R14                                                      66960020
*                                                                       67050020
SETDATE  OI    L3(R4),HEX0F             PUT ON PROPER SIGN              67140020
         UNPK  WORK(L8),L0(L4,R4)       UNPACK DATE                     67230020
         MVZ   WORK+L7(L1),WORK         SET ZONE                        67320020
         MVC   L0(L3,R3),WORK+L5        MOVE DAY                        67410020
         MVC   L5(L2,R3),WORK+L3        MOVE YEAR                       67500020
         BR    R14                                                      67590020
*                                                                       67680020
*              FREE COUNTERS                                            67770020
*                                                                       67860020
FREECORE STM   R14,R12,L12(R13)         SAVE REGS                       67950020
         LR    R12,R13                  SAVE SAVE PTR                   68040020
         LA    R13,FSAVE                SET ADDRESS MYSAVE              68130020
         ST    R12,L4(R13)              CHAIN SAVE AREAS TOGETHER       68220020
         ST    R13,L8(R12)                                              68310020
         L     R3,L4(R2)                PICK UP NXT COUNTER PTR         68400020
         ST    R3,L28(R12)              PRESET REG IN CALLERS AREA      68490020
         LH    R0,SIZE                  PICK UP COUNTER LENGTH          68580020
         LR    R1,R2                    SET ADDRESS TO COUNTER          68670020
*                                                                       68760020
         FREEMAIN R,LV=(0),A=(1)        FREE COUNTER                    68850020
*                                                                       68940020
         LTR   R3,R3                    TEST FOR LAST COUNTER IN        69030020
         BZ    RETURN0                  BR-LAST                         69120020
         LA    R5,PENTRY+L10            RESET R9 &                      69210020
         LA    R6,LABLAREA-L1           LABEL POINTER TO START          69300020
         ST    R5,YR9PTR                                                69390020
         ST    R6,YLABELP                                               69480020
RETURN0  L     R13,L4(R13)              RESET TO CALLERS REGS           69570020
         LM    R14,R12,L12(R13)         RESTORE REGS                    69660020
         BR    R14                      RETURN                          69750020
WORK     DS    D                                                        69840020
XSAVE    DS    4F                                                       69930020
*                                                                       70020020
FSAVE    DS    18F                                                      70110020
L28      EQU   28                                                       70200020
HEXFFFF  DC    X'FFFF'                                                  70290020
SIZE     DC    H'622'                                                   70380020
HEX0F    EQU   X'0F'                                                    70470020
L0       EQU   0                                                        70560020
L1       EQU   1                                                        70650020
L2       EQU   2                                                        70740020
L3       EQU   3                                                        70830020
L4       EQU   4                                                        70920020
L5       EQU   5                                                        71010020
L6       EQU   6                                                        71100020
L7       EQU   7                                                        71190020
L8       EQU   8                                                        71280020
L9       EQU   9                                                        71370020
L10      EQU   10                                                       71460020
L12      EQU   12                                                       71550020
*                                                                       71640020
*                                                                       71730020
R0       EQU   0                                                        71820020
R1       EQU   1                                                        71910020
R2       EQU   2                                                        72000020
R3       EQU   3                                                        72090020
R4       EQU   4                                                        72180020
R5       EQU   5                                                        72270020
R6       EQU   6                                                        72360020
R7       EQU   7                                                        72450020
R8       EQU   8                                                        72540020
R9       EQU   9                                                        72630020
R10      EQU   10                                                       72720020
R11      EQU   11                                                       72810020
R12      EQU   12                                                       72900020
R13      EQU   13                                                       72990020
R14      EQU   14                                                       73080020
R15      EQU   15                                                       73170020
*                                                                       73260020
*                                                                       73350020
PENTRY   DS    0F                                                       73440020
         DC    X'00010001'                                              73530020
         DC    X'00010001'                                              73620020
         DC    A(LABLAREA)                                              73710020
         DC    H'0'                                                     73800020
*                                                                       73890020
         DC    X'01'                                                    73980020
         DC         X'000B8B00'         SKIP TO CHANNEL 1               74070020
*                                                                       74160020
         LINE  ,(23,11)                                                 74250020
         ROUTINE    YDUMA,SKIPPER                                       74340020
         LINE       (23,11),(1,30)                                      74430020
         ROUTINE    YLOD,SETDATE                                        74520020
         ROUTINE    YHID,SETDATE                                        74610020
*                                                                       74700020
         LINE       (56,20),(35,30),SKIP=2                       S21021 74790002
         HEX        YCPU,0,2B                                    P0417  74880020
         HEX        YSER,0,3B                                    S21021 74930002
         LINE                                                           74970020
         HEX        YCHAN,0,1B                                          75060020
         LINE                                                           75150020
         ROUTINE    YDUMA,SKIPPER                                       75240020
*                                                                       75330020
         LINE       (70,1)                                              75420020
         ROUTINE    YNOREC,CONVERT                                      75510020
*                                                                       75600020
         LINE       (16,24),(2,38)                                      75690020
         ROUTINE    YDUMA,SKIPPER                                       75780020
*                                                                       75870020
         LINE                                                           75960020
         ROUTINE    YDUMA,SKIPPER                                       76050020
*                                                                       76140020
         LINE       ,,SKIP=1                                            76230020
         HEX        YCC01                                               76320020
         ROUTINE    YSC01,CONVERT                                       76410020
         ROUTINE    YFFF01,CONVCC1                                      76500020
         LINE                                                           76590020
         HEX        YCC02                                               76680020
         ROUTINE    YSC02,CONVERT                                       76770020
         ROUTINE    YFFF02,CONVCC1                                      76860020
         LINE                                                           76950020
         HEX        YCC03                                               77040020
         ROUTINE    YSC03,CONVERT                                       77130020
         ROUTINE    YFFF03,CONVCC1                                      77220020
         LINE                                                           77310020
         HEX        YCC04                                               77400020
         ROUTINE    YSC04,CONVERT                                       77490020
         ROUTINE    YFFF04,CONVCC1                                      77580020
         LINE                                                           77670020
         HEX        YCC05                                               77760020
         ROUTINE    YSC05,CONVERT                                       77850020
         ROUTINE    YFFF05,CONVCC1                                      77940020
         LINE                                                           78030020
         HEX        YCC06                                               78120020
         ROUTINE    YSC06,CONVERT                                       78210020
         ROUTINE    YFFF06,CONVCC1                                      78300020
         LINE                                                           78390020
         HEX        YCC07                                               78480020
         ROUTINE    YSC07,CONVERT                                       78570020
         ROUTINE    YFFF07,CONVCC1                                      78660020
         LINE                                                           78750020
         HEX        YCC08                                               78840020
         ROUTINE    YSC08,CONVERT                                       78930020
         ROUTINE    YFFF08,CONVCC1                                      79020020
         LINE                                                           79110020
         HEX        YCC09                                               79200020
         ROUTINE    YSC09,CONVERT                                       79290020
         ROUTINE    YFFF09,CONVCC1                                      79380020
         LINE       ,,SKIP=2                                            79470020
         HEX        YCC10                                               79560020
         ROUTINE    YSC10,CONVERT                                       79650020
         ROUTINE    YFFF10,CONVCC1                                      79740020
         LINE                                                           79830020
         ROUTINE    YDUMA,SKIPPER                                       79920020
*                                                                       80010020
         LINE       ,(11,1),SKIP=2                                      80100020
         ROUTINE    YDUMA,SKIPPER                                       80190020
         LINE       ,,SKIP=1                                            80280020
         HEX        YCC11                                               80370020
         ROUTINE    YSC11,CONVERT                                       80460020
         ROUTINE    YFFF11,CONVCC1                                      80550020
         LINE                                                           80640020
         HEX        YCC12                                               80730020
         ROUTINE    YSC12,CONVERT                                       80820020
         ROUTINE    YFFF12,CONVCC1                                      80910020
         LINE                                                           81000020
         HEX        YCC13                                               81090020
         ROUTINE    YSC13,CONVERT                                       81180020
         ROUTINE    YFFF13,CONVCC1                                      81270020
         LINE                                                           81360020
         HEX        YCC14                                               81450020
         ROUTINE    YSC14,CONVERT                                       81540020
         ROUTINE    YFFF14,CONVCC1                                      81630020
         LINE                                                           81720020
         HEX        YCC15                                               81810020
         ROUTINE    YSC15,CONVERT                                       81900020
         ROUTINE    YFFF15,CONVCC1                                      81990020
         LINE                                                           82080020
         HEX        YCC16                                               82170020
         ROUTINE    YSC16,CONVERT                                       82260020
         ROUTINE    YFFF16,CONVCC1                                      82350020
         LINE                                                           82440020
         HEX        YCC17                                               82530020
         ROUTINE    YSC17,CONVERT                                       82620020
         ROUTINE    YFFF17,CONVCC1                                      82710020
         LINE                                                           82800020
         HEX        YCC18                                               82890020
         ROUTINE    YSC18,CONVERT                                       82980020
         ROUTINE    YFFF18,CONVCC1                                      83070020
         LINE                                                           83160020
         HEX        YCC19                                               83250020
         ROUTINE    YSC19,CONVERT                                       83340020
         ROUTINE    YFFF19,CONVCC1                                      83430020
         LINE       ,,SKIP=2                                            83520020
         HEX        YCC20                                               83610020
         ROUTINE    YSC20,CONVERT                                       83700020
         ROUTINE    YFFF20,CONVCC1                                      83790020
         LINE       ,(2,56),SKIP=2                                      83880020
         ROUTINE    YDUMA,SKIPPER                                       83970020
*                                                                       84060020
         LINE       (40,55),(3,55),SKIP=1                               84150020
         ROUTINE    YCDC,CONVERT                                        84240020
         LINE                                                           84330020
         ROUTINE    YCCC,CONVERT                                        84420020
         LINE       ,,SKIP=2                                            84510020
         ROUTINE    YIFC,CONVERT                                        84600020
*                                                                       84690020
*                                                                       84780020
         LINE       ,(2,55),SKIP=2                                      84870020
         ROUTINE    YDUMA,SKIPPER                                       84960020
*                                                                       85050020
         LINE       ,(3,55),SKIP=1                                      85140020
         ROUTINE    YARGFL,CONVERT                                      85230020
         ROUTINE    YWR,CONVERT                                         85320020
         LINE                                                           85410020
         ROUTINE    YBRGFL,CONVERT                                      85500020
         ROUTINE    YSETUP,CONVERT                                      85590020
         LINE                                                           85680020
         ROUTINE    YCHCML,CONVERT                                      85770020
         ROUTINE    YTIC,CONVERT                                        85860020
         LINE                                                           85950020
         ROUTINE    YSEQ1,CONVERT                                       86040020
         ROUTINE    YTICHZ,CONVERT                                      86130020
         LINE                                                           86220020
         ROUTINE    YSEQ2,CONVERT                                       86310020
         ROUTINE    YPIRPT,CONVERT                                      86400020
         LINE                                                           86490020
         ROUTINE    YSEQ3,CONVERT                                       86580020
         ROUTINE    YCDALT,CONVERT                                      86670020
         LINE                                                           86760020
         ROUTINE    YSEQ4,CONVERT                                       86850020
         ROUTINE    YLWT,CONVERT                                        86940020
         LINE                                                           87030020
         ROUTINE    YSEQ5,CONVERT                                       87120020
         ROUTINE    YBCCPT,CONVERT                                      87210020
         LINE                                                           87300020
         ROUTINE    YCCWV,CONVERT                                       87390020
         ROUTINE    YBCOLT,CONVERT                                      87480020
         LINE       ,,SKIP=2                                            87570020
         ROUTINE    YREAD,CONVERT                                       87660020
         ROUTINE    YBCTGR,CONVERT                                      87750020
         LINE       ,(2,55),SKIP=2                                      87840020
         ROUTINE    YDUMA,SKIPPER                                       87930020
         LINE       ,(3,55),SKIP=1                                      88020020
         ROUTINE    YOPIN,CONVERT                                       88110020
         ROUTINE    YADOLT,CONVERT                                      88200020
         LINE                                                           88290020
         ROUTINE    YSLOLT,CONVERT                                      88380020
         ROUTINE    YSEROT,CONVERT                                      88470020
         LINE                                                           88560020
         ROUTINE    YCOMOT,CONVERT                                      88650020
         ROUTINE    YSTIO,CONVERT                                       88740020
         LINE  ,                                               @YM6454P 88830002
         ROUTINE    YHTIO,CONVERT                                       88920020
         ROUTINE    YSTOCK,CONVERT                                      89010020
*                                                                       89100020
         LINE  ,                                               @YM6454P 89110002
         ROUTINE YIDA00,CONVERT                                @YM6454P 89120002
         ROUTINE YDIN00,CONVERT                                @YM6454P 89130002
         LINE   ,,SKIP=2                                       @YM6454P 89140002
         ROUTINE YSTO00,CONVERT                                @YM6454P 89150002
         LINE       ,(2,55),SKIP=2                                      89190020
         ROUTINE    YDUMA,SKIPPER                                       89280020
*                                                                       89370020
         LINE       ,(3,55),SKIP=1                                      89460020
         ROUTINE    YPSPR,CONVERT                                       89550020
         ROUTINE    YPOCAR,CONVERT                                      89640020
         LINE                                                           89730020
         ROUTINE    YPCOMR,CONVERT                                      89820020
         ROUTINE    YP1CAR,CONVERT                                      89910020
         LINE                                                           90000020
         ROUTINE    YP0DAR,CONVERT                                      90090020
         ROUTINE    YP2CAR,CONVERT                                      90180020
         LINE                                                           90270020
         ROUTINE    YP1DAR,CONVERT                                      90360020
         ROUTINE    YPOCRG,CONVERT                                      90450020
         LINE                                                           90540020
         ROUTINE    YP2DAR,CONVERT                                      90630020
         ROUTINE    YP1CRG,CONVERT                                      90720020
         LINE       ,,SKIP=3                                            90810020
         ROUTINE    YPUAR,CONVERT                                       90900020
         ROUTINE    YP2CRG,CONVERT                                      90990020
*                                                                       91080020
         LINE       ,(2,1),SKIP=2                                       91170020
         LABEL      'UNIT NUMBER SUMMARY'                        P0417  91260020
         ROUTINE    YDUMA,SKIPPER                                       91350020
         LINE       (15,25),,SKIP=1                                     91440020
         HEX        YCC21                                               91530020
         ROUTINE    YSC21,CONVERT                                       91620020
         ROUTINE    YFFF21,CONVCC1                                      91710020
         LABEL ' '                                                      91800020
         LINE                                                           91890020
         HEX        YCC22                                               91980020
         ROUTINE    YSC22,CONVERT                                       92070020
         ROUTINE    YFFF22,CONVCC1                                      92160020
         LABEL ' '                                                      92250020
         LINE                                                           92340020
         HEX        YCC23                                               92430020
         ROUTINE    YSC23,CONVERT                                       92520020
         ROUTINE    YFFF23,CONVCC1                                      92610020
         LABEL ' '                                                      92700020
         LINE                                                           92790020
         HEX        YCC24                                               92880020
         ROUTINE    YSC24,CONVERT                                       92970020
         ROUTINE    YFFF24,CONVCC1                                      93060020
         LABEL ' '                                                      93150020
         LINE                                                           93240020
         HEX        YCC25                                               93330020
         ROUTINE    YSC25,CONVERT                                       93420020
         ROUTINE    YFFF25,CONVCC1                                      93510020
         LABEL ' '                                                      93600020
         LINE                                                           93690020
         HEX        YCC26                                               93780020
         ROUTINE    YSC26,CONVERT                                       93870020
         ROUTINE    YFFF26,CONVCC1                                      93960020
         LABEL ' '                                                      94050020
         LINE                                                           94140020
         HEX        YCC27                                               94230020
         ROUTINE    YSC27,CONVERT                                       94320020
         ROUTINE    YFFF27,CONVCC1                                      94410020
         LABEL ' '                                                      94500020
         LINE                                                           94590020
         HEX        YCC28                                               94680020
         ROUTINE    YSC28,CONVERT                                       94770020
         ROUTINE    YFFF28,CONVCC1                                      94860020
         LABEL ' '                                                      94950020
         LINE                                                           95040020
         HEX        YCC29                                               95130020
         ROUTINE    YSC29,CONVERT                                       95220020
         ROUTINE    YFFF29,CONVCC1                                      95310020
         LABEL ' '                                                      95400020
         LINE       ,,SKIP=3                                            95490020
         HEX        YCC30                                               95580020
         ROUTINE    YSC30,CONVERT                                       95670020
         ROUTINE    YFFF30,CONVCC1                                      95760020
         LABEL ' '                                                      95850020
         LINE                                                           95940020
         ROUTINE    YDUMA,FREECORE                                      96030020
         LABEL ' '                                                      96120020
         DC    X'FF0000000000'                                          96210020
         DC    C'$'                                                     96300020
LABLAREA EQU   *                                                        96390020
         LSTART                                                         96480020
         END                                                            96570020
