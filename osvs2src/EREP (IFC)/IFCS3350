         TITLE 'IFCS3350 - 3350 SUMMARY TABLE MODULE'          @XM09337 00050042
*  LINE MACRO     LINE MACRO     LINE MACRO     LINE MACRO            * 00100042
         MACRO                                                          00150042
&NAME    LINE  &DATA,&LABEL,&SKIP=                                      00200042
.*                            THIS MACRO ESTABLISHES THE MARGINS OR     00250042
.*                                 COLUMN SETTINGS FOR EACH LINE. IT    00300042
.*                                 GENERATES NECESSARY CARRIAGE CONTROL 00350042
.*                                 ENTRIES. LASTLY IT DETERMINES THE    00400042
.*                                 NUMBER OF ENTRIES ASSOCIATED WITH    00450042
.*                                 THE PREVIOUS LINE AND STORES THAT #  00500042
.*                                 INTO THE APPROPRIATE BYTE.           00550042
.*                            &DATA(1) - CHARACTER POSITION TO BEGIN    00600042
.*                                 DATA.                                00650042
.*                            &DATA(2) - # OF SPACES BETWEEN SUCCESSIVE 00700042
.*                                 DATA COLUMN STARTING CHARACTERS.     00750042
.*                            &LABEL(1) - CHAR. POS. TO BEGIN LABELS.   00800042
.*                            &LABEL(2) - # SPACES BETWEEN LINE'S LABEL 00850042
.*                                 STARTING CHARACTERS.                 00900042
.*                            &SKIP= - # OF LINES TO ADVANCE CARRIAGE   00950042
.*                                 TO BEGIN NEXT PRINTED LINE.          01000042
.*                            NEW ENTRIES ARE GENERATED ONLY WHEN       01050042
.*                                 NECESSARY. OMISSION OF ITEMS MEANS   01100042
.*                                 THEY HAVE NOT CHANGED SINCE PREVIOUS 01150042
.*                                 SETTINGS. A LINE MACRO IS REQUIRED   01200042
.*                                 FOR EACH PRINTED LINE. IF NO SETTING 01250042
.*                                 CHANGES ARE REQUIRED ALL OPERANDS    01300042
.*                                 ARE OMITTED IN WHICH CASE ONLY THE   01350042
.*                                 # OF ENTRIES FOR THE PREVIOUS LINE   01400042
.*                                 IS COMPUTED. THIS MACRO MUST BE THE  01450042
.*                                 FIRST MACRO INSTRUCTION ISSUED FOR   01500042
.*                                 THE SUBJECT LINE                     01550042
         GBLA  &DB,&DT,&LB,&LT,&NRENTS                                  01600042
         GBLA  &LASTCC,&INITIAL                                         01650042
         GBLC  &NRENTSX                                                 01700042
         GBLC  &CARRCON                                                 01750042
         GBLB  &TEST                                                    01800042
         LCLA  &S                                                       01850042
&NAME    DS    0C                                                       01900042
         AIF   (&INITIAL EQ 0).FIRSTLN                                  01950042
         LINEND                                                         02000042
         AGO   .NTFIRST                                                 02050042
.FIRSTLN ANOP                                                           02100042
&NRENTSX SETC  'N&SYSNDX'                                               02150042
&INITIAL SETA  1                                                        02200042
N&SYSNDX EQU   *                                                        02250042
.NTFIRST ANOP                                                           02300042
         DC    AL1(0)                                                   02350042
         AIF   ('&DATA(1)' EQ '').CKDTABS                               02400042
         AIF   (&DATA(1) EQ &DB).CKDTABS                                02450042
&DB      SETA  &DATA(1)                                                 02500042
         AGO   .AA                                                      02550042
.CKDTABS AIF   ('&DATA(2)' EQ '').NCDATA                                02600042
         AIF   (&DATA(2) EQ &DT).NCDATA                                 02650042
         AGO   .CC                                                      02700042
.AA      AIF   ('&DATA(2)' EQ '').BB                                    02750042
         AIF   (&DATA(2) EQ &DT).BB                                     02800042
.CC      ANOP                                                           02850042
&DT      SETA  &DATA(2)                                                 02900042
.BB      DC    XL2'FFFE'                                                02950042
         DC    FL1'&DB'                                                 03000042
         DC    FL1'&DT'                                                 03050042
&NRENTS  SETA  &NRENTS+1                                                03100042
.NCDATA  ANOP                                                           03150042
         AIF   ('&LABEL(1)' EQ '').CKLTABS                              03200042
         AIF   (&LABEL(1) EQ &LB).CKLTABS                               03250042
&LB      SETA  &LABEL(1)                                                03300042
         AGO   .AAA                                                     03350042
.CKLTABS AIF   ('&LABEL(2)' EQ '').NCLABEL                              03400042
         AIF   (&LABEL(2) EQ &LT).NCLABEL                               03450042
         AGO   .CCC                                                     03500042
.AAA     AIF   ('&LABEL(2)' EQ '').BBB                                  03550042
         AIF   (&LABEL(2) EQ &LT).BBB                                   03600042
.CCC     ANOP                                                           03650042
&LT      SETA  &LABEL(2)                                                03700042
.BBB     DC    XL2'FFFF'                                                03750042
         DC    FL1'&LB'                                                 03800042
         DC    FL1'&LT'                                                 03850042
&NRENTS  SETA  &NRENTS+1                                                03900042
.NCLABEL ANOP                                                           03950042
         AIF   ('&SKIP' NE '').CONT                                     04000042
         AIF   (&TEST EQ 0).NOCHANG                                     04050042
&S       SETA  &LASTCC                                                  04100042
         AGO   .DEFAULT                                                 04150042
.CONT    ANOP                                                           04200042
         AIF   (&TEST EQ 0).AB                                          04250042
&S       SETA  &SKIP                                                    04300042
.DEFAULT ANOP                                                           04350042
         ORG   &CARRCON+3                                               04400042
         DC    AL.3(0),AL.2(&S),AL.3(1)                                 04450042
         ORG                                                            04500042
&LASTCC  SETA  &S                                                       04550042
&TEST    SETB  0                                                        04600042
         AGO   .DD                                                      04650042
.AB      AIF   (&SKIP EQ &LASTCC).NOCHANG                               04700042
A&SYSNDX DC    XL2'FFFB'                                                04750042
         DC    AL.3(0),AL.2(&SKIP),AL.3(1)                              04800042
         DC    FL1'9'                                                   04850042
&LASTCC  SETA  &SKIP                                                    04900042
&TEST    SETB  1                                                        04950042
&CARRCON SETC  'A&SYSNDX'                                               05000042
&NRENTS  SETA  &NRENTS+1                                                05050042
.DD      ANOP                                                           05100042
.NOCHANG ANOP                                                           05150042
         MEND                                                           05200042
         EJECT                                                          05250042
         SPACE 2                                                        05300042
*  ROUTINE MACRO     ROUTINE MACRO     ROUTINE MACRO     ROUTINE MACRO* 05350042
         MACRO                                                          05400042
&NAME    ROUTINE &LOGITEM,&RNAME                                        05450042
         GBLC  &DSECT,&CSECT                                            05500042
         GBLC  &ITEM(1000)                                              05550042
         GBLA  &SHIFT(1000),&ITEMNBR                                    05600042
         GBLA  &NRENTS                                                  05650042
         LCLA  &ISHIFT,&NDX                                             05700042
.LOOP    ANOP                                                           05750042
&NDX     SETA  &NDX+1                                                   05800042
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      05850042
         AIF   (&NDX LT &ITEMNBR).LOOP                                  05900042
         MNOTE *,'LOG ITEM NOT DEFINED'                                 05950042
         MEXIT                                                          06000042
.FOUND   ANOP                                                           06050042
&ISHIFT  SETA  &SHIFT(&NDX)                                             06100042
&NAME    DC    AL.12(&LOGITEM-&DSECT),XL.4'D'                           06150042
         DC    AL.4(&ISHIFT),AL.12(&RNAME-&CSECT)                       06200042
&NRENTS  SETA  &NRENTS+1                                                06250042
         MEND                                                           06300042
         EJECT                                                          06350042
*        DSGEN  MACRO        D S G E N  M A C R O          DSGEN MACRO  06400042
         MACRO                                                          06450042
&NAME    DSGEN                                                          06500042
.*                            THIS MACRO GENERATES ONE DSECT WORD       06550042
.*                                 FORMATTED FOR THE SUBJECT LOG RECORD 06600042
.*                                 EACH OPERAND HAS TWO SUB LISTS. THE  06650042
.*                                 FIRST IS THE NAME OF THE LOG ITEM    06700042
.*                                 WHILE THE SECOND IS THE # OF BITS TO 06750042
.*                                 ALLOCATE FOR THIS ITEM. ITEMS MUST   06800042
.*                                 BE DEFINED CONTIGUOUSLY WITHOUT GAPS 06850042
.*                                 UNUSED BIT GROUPS MUST BE GIVEN      06900042
.*                                 DUMMY NAMES. THE NAMES PROVIDED FOR  06950042
.*                                 THE LOG ITEMS MAY THEN BE USED IN    07000042
.*                                 THE CONVERSION MACRO INSTRUCTIONS.   07050042
         GBLA  &BITS(1000),&ITEMNBR,&SHIFT(1000)                        07100042
         GBLC  &ITEM(1000)                                              07150042
         LCLB  &ONLY1,&CTIND                                            07200042
         LCLA  &START1,&START2,&END1,&END2                              07250042
         LCLC  &SYMBOL,&EQUSYM                                          07300042
         LCLA  &OP,&COUNT,&BYTE,&EQUCNT                                 07350042
         ACTR  500000                                                   07400042
.START   AIF   (N'&SYSLIST(&OP+1) LT 3).LOOP                            07450042
         AIF   ('&SYSLIST(&OP+1,3)' EQ 'EQU').LOOP     TEST FOR EQU     07500042
  AIF   ('&SYSLIST(&OP+1,3)' EQ '' OR '&SYSLIST(&OP+1,4)' EQ '').ERR1   07550042
         AIF   ('&SYSLIST(&OP+1,3)' GT '&SYSLIST(&OP+1,4)').ERR3        07600042
&START1  SETA  &SYSLIST(&OP+1,3)        GET START COUNT OF 1            07650042
&START2  SETA  &SYSLIST(&OP+1,4)        GET FIRST END COUNT             07700042
         AGO   .SET2A                   BRANCH AROUND                   07750042
.ERR1    MNOTE '**FIRST SYMBOL CONCATENATION INCOMPLETE**'              07800042
         MEXIT                                                          07850042
.SET2A   AIF   ('&SYSLIST(&OP+1,5)' EQ ''AND '&SYSLIST(&OP+1,6)' EQ '' X07900042
               ).SET2                   TEST FOR NO SECOND              07950042
  AIF   ('&SYSLIST(&OP+1,5)' EQ '' OR '&SYSLIST(&OP+1,6)' EQ '').ERR2   08000042
         AIF   ('&SYSLIST(&OP+1,5)' GT '&SYSLIST(&OP+1,6)').ERR3        08050042
&END1    SETA  &SYSLIST(&OP+1,5)        GET START COUNT OF 2            08100042
&END2    SETA  &SYSLIST(&OP+1,6)        GET END COUNT OF 2              08150042
         AGO   .LOOP                                                    08200042
.SET2    ANOP                                                           08250042
&ONLY1   SETB  1                        INDICATE ONLY ONE CONCATENATION 08300042
         AGO   .LOOP                                                    08350042
.ERR2    MNOTE '**SECOND SYMBOL CONCATENATION INCOMPLETE**'             08400042
         MEXIT                                                          08450042
.ERR3    MNOTE '**START GREATER THAN END CONCATENATION**'               08500042
         MEXIT                                                          08550042
.LOOP    ANOP                                                           08600042
&OP      SETA  &OP+1                                                    08650042
         AIF   (&OP GT N'&SYSLIST).DONE      TEST IF ALL DONE           08700042
&ITEMNBR SETA  &ITEMNBR+1                                               08750042
         AIF   ('&SYSLIST(&OP,2)' NE '').OK1                            08800042
         MNOTE '**NULL BIT COUNT FIELD**'                               08850042
         MEXIT                                                          08900042
.OK1     ANOP                                                           08950042
&SYMBOL  SETC  '&SYSLIST(&OP,1)'                                        09000042
         AIF   ('&SYMBOL' NE '').OK                                     09050042
*              *****     LOG ITEM SYMBOL NOT PROVIDED     *****         09100042
         AIF   ('&SYSLIST(&OP,3)' NE 'EQU').CNT                         09150042
         AGO   .START                   GET NEXT                        09200042
.OK      AIF   (N'&SYSLIST(&OP) LT 3).NO3    TEST FOR OLD FORMAT        09250042
         AIF   ('&SYSLIST(&OP,3)' EQ 'EQU').EQU   TEST FOR EQU          09300042
         AIF   (&ONLY1).OK2             TEST FOR ONLY ONE CONCAT        09350042
&SYMBOL  SETC  '&SYMBOL.&START1.&END1'       GET 1 AND 2 CONCAT         09400042
         AGO   .NO3                     BRANCH AROUND                   09450042
.OK2     ANOP                                                           09500042
&SYMBOL  SETC  '&SYMBOL.&START1'        GET 1 CONCATENATED              09550042
.NO3     ANOP                                                           09600042
&SYMBOL  EQU   *+&BYTE                                                  09650042
&ITEM(&ITEMNBR) SETC '&SYMBOL'          GET LABEL IN GLOBAL             09700042
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2)                                    09750042
&SHIFT(&ITEMNBR) SETA &COUNT-&BYTE*8                                    09800042
.CNT     ANOP                                                           09850042
&CTIND   SETB  1                        SET COUNT INDICATOR             09900042
&COUNT   SETA  &COUNT+&SYSLIST(&OP,2)                                   09950042
&BYTE    SETA  &COUNT/8                                                 10000042
         AIF   (N'&SYSLIST(&OP) LT 3).START  TEST FOR OLD FORMAT        10050042
         AIF   (&ONLY1).TSTST           TEST FOR ONLY ONE CONCAT        10100042
         AIF   (&END1 EQ &END2).TSTST   TEST FOR SECOND END             10150042
&END1    SETA  &END1+1                  INCREMENT COUNT                 10200042
&OP      SETA  &OP-1                    DECREMENT INCREMENT             10250042
         AGO   .LOOP                    GENERATE NEXT                   10300042
.TSTST   ANOP                                                           10350042
         AIF   (&START1 EQ &START2).LPDONE   TEST FOR END               10400042
         AIF   (&ONLY1).NSET1           TEST FOR ONLY ONE CONCAT        10450042
&END1    SETA  &SYSLIST(&OP,5)          RE-INIT SECOND START COUNT      10500042
.NSET1   ANOP                                                           10550042
&OP      SETA  &OP-1                    DECREMENT INDEX                 10600042
&START1  SETA  &START1+1                INCREMENT FIRST COUNT           10650042
         AGO   .LOOP                    GO DO NEXT                      10700042
.LPDONE  ANOP                                                           10750042
&ONLY1   SETB  0                        CLEAR INDICATOR                 10800042
         AGO   .START                   GO TEST FOR MORE SUB-LISTS      10850042
.DONE    AIF   (&COUNT-&COUNT/8*8 NE 0).ERR  TEST FOR MULTIPLE OF EIGHT 10900042
         AIF   (&CTIND EQ 0).END        NO DS IF NO COUNT               10950042
&COUNT   SETA  &COUNT/8                 GET NUMBER OF BYTES             11000042
&NAME    DS    &COUNT.C                                                 11050042
.END     MEXIT                                                          11100042
.ERR     MNOTE '**BIT COUNT FLDS DO NOT TOTAL MULTIPLE OF 8**'          11150042
         MEXIT                                                          11200042
.EQU     AIF   ('&SYSLIST(&OP,4)' NE '').EQU1     TEST FOR NULL LABEL   11250042
.ERR4    MNOTE '**EQU OPERAND OMITTED OR NOT FOUND**'                   11300042
         MEXIT                                                          11350042
.EQU1    AIF   (&SYSLIST(&OP,2) LT 16).EQU2  COUNT OVER FIFTEEN         11400042
*****               THE FOLLOWING STATEMENT                *****        11450042
*****     NUMBER OF BITS EXCEED 15 - DO NOT USE AS BIN     *****        11500042
.EQU2    ANOP                                                           11550042
&EQUCNT  SETA  0                        CLEAR COUNTER                   11600042
&EQUSYM  SETC  '&SYSLIST(&OP,4)'        GET EQU OPERAND                 11650042
.EQULOP  ANOP                                                           11700042
&EQUCNT  SETA  &EQUCNT+1                INCREMENT INDEX                 11750042
         AIF   ('&ITEM(&EQUCNT)' EQ '&EQUSYM').EQUOUT  LABEL FOUND?     11800042
         AIF   (&EQUCNT EQ &ITEMNBR).ERR4    ALL TESTED?                11850042
         AGO   .EQULOP                  NO-GET NEXT                     11900042
.EQUOUT  ANOP                                                           11950042
&ITEM(&ITEMNBR) SETC '&SYMBOL'          GET LABEL NAME                  12000042
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2)    GET NUMBER OF BITS              12050042
&SHIFT(&ITEMNBR) SETA &SHIFT(&EQUCNT)   GET SHIFT COUNT                 12100042
&SYMBOL  EQU   &EQUSYM                  THIS SYMBOL EQUATED             12150042
         AGO   .START                   RETURN FOR NEXT                 12200042
         MEND                                                           12250042
         EJECT                                                          12300042
         MACRO                                                          12350042
         LINEND                                                         12400042
.*                            THIS MACRO IS USED ONLY BY THE LINE       12450042
.*                                 MACRO TO SET THE NUMBER OF ENTRIES   12500042
.*                                 ASSOCIATED WITH EACH LINE.           12550042
         GBLA  &NRENTS                                                  12600042
         GBLC &NRENTSX                                                  12650042
         ORG   &NRENTSX                                                 12700042
         DC    FL1'&NRENTS'                                             12750042
         ORG                                                            12800042
&NRENTS  SETA  0                                                        12850042
B&SYSNDX EQU   *                                                        12900042
&NRENTSX SETC  'B&SYSNDX'                                               12950042
         MEND                                                           13000042
         SPACE 2                                                        13050042
         EJECT                                                          13100042
*  LABEL MACRO     LABEL MACRO     LABEL MACRO     LABEL MACRO        * 13150042
         SPACE 2                                                        13200042
         MACRO                                                          13250042
&NAME    LABEL &LABEL1,&LABEL2,&LABEL3,&LABEL4,&LABEL5,&LABEL6,        C13300042
               &LABEL7,&LABEL8                                          13350042
.*                            THIS MACRO ALLOWS UP TO ACHT LABELS TO    13400042
.*                                 BE SPECIFIED FOR A GIVEN LINE. THE   13450042
.*                                 LABELS SHOULD BE ENCLOSED IN QUOTA-  13500042
.*                                 TION MARKS. THE COLUMN AND LINE END  13550042
.*                                 CONTROLS WILL BE INSERTED BY THE     13600042
.*                                 MACRO. OMITTED OPERANDS MEAN NO      13650042
.*                                 LABEL REQUIRED FOR RESPECTIVE        13700042
.*                                 COLUMN. THIS MACRO WILL ALSO ALERT   13750042
.*                                 THE PROGRAMMER TO EXACTLY WHERE THE  13800042
.*                                 TABLE MUST BE BROKEN IF NECESSARY    13850042
.*                                 TO AVOID EXCEEDING THE MAXIMUM LIMIT 13900042
         GBLC &LABELS(2000)                                             13950042
         GBLC  &LBL(100)                                                14000042
         GBLA  &LBLCTR(100)                                             14050042
         GBLA  &LABELNR                                                 14100042
         GBLA  &NRENTS,&LPTR                                            14150042
         LCLC  &MARGIN,&TACK                                            14200042
         LCLC  &TEXT                                                    14250042
         LCLA  &OP,&K,&START,&NRCHAR,&REMAIN                            14300042
&MARGIN  SETC  '*'                                                      14350042
         AIF   ('&NAME' EQ '').LOOPOUT                                  14400042
&LPTR    SETA  &LPTR+1                                                  14450042
&LBL(&LPTR) SETC '&NAME'                                                14500042
&LBLCTR(&LPTR) SETA &LABELNR+1                                          14550042
.LOOPOUT ANOP                                                           14600042
&OP      SETA  &OP+1                                                    14650042
&K       SETA  K'&SYSLIST(&OP)                                          14700042
         AIF (&K GE 2).NORM                                             14750042
&K       SETA  2                                                        14800042
.NORM    ANOP                                                           14850042
&START   SETA  2                                                        14900042
         AIF (&OP LT N'&SYSLIST).NOTLAST                                14950042
&MARGIN  SETC  '$'                                                      15000042
.NOTLAST ANOP                                                           15050042
&NRCHAR  SETA  8                                                        15100042
&TACK    SETC  ''                                                       15150042
.LOOPIN  ANOP                                                           15200042
&REMAIN  SETA  &K-&START                                                15250042
         AIF (&REMAIN GE 8).MORE                                        15300042
&TACK    SETC  '&MARGIN'                                                15350042
&NRCHAR  SETA  &REMAIN                                                  15400042
.MORE    ANOP                                                           15450042
&TEXT    SETC  ''                                                       15500042
         AIF (&REMAIN EQ 0).ENDTEXT                                     15550042
&TEXT    SETC  '&SYSLIST(&OP)'(&START,&NRCHAR)                          15600042
.ENDTEXT ANOP                                                           15650042
&LABELNR SETA  &LABELNR+1                                               15700042
&LABELS(&LABELNR) SETC '&TEXT'.'&TACK'                                  15750042
&START   SETA  &START+8                                                 15800042
         AIF ('&TACK' EQ '').LOOPIN                                     15850042
         AIF ('&TACK' EQ '*').LOOPOUT                                   15900042
         MEND                                                           15950042
         SPACE 2                                                        16000042
         MACRO                                                          16050042
         LSTART                                                         16100042
.*                            THIS MACRO IS ISSUED WHEN THE LABEL AREA  16150042
.*                                 OF THE TABLE IS TO BEGIN.            16200042
         GBLC &LABELS(2000)                                             16250042
         GBLA  &LABELNR                                                 16300042
         GBLC  &LBL(100)                                                16350042
         GBLA  &LBLCTR(100)                                             16400042
         LCLA  &NDX,&CTR                                                16450042
         LINEND                                                         16500042
&CTR     SETA  1                                                        16550042
.LOOP    ANOP                                                           16600042
&NDX     SETA  &NDX+1                                                   16650042
         AIF   (&LBLCTR(&CTR) NE &NDX).NOLBL                            16700042
&LBL(&CTR) DC  C'&LABELS(&NDX)'                                         16750042
&CTR     SETA  &CTR+1                                                   16800042
         AGO   .LOOPCTL                                                 16850042
.NOLBL   ANOP                                                           16900042
         DC    C'&LABELS(&NDX)'                                         16950042
.LOOPCTL AIF   (&NDX LT &LABELNR).LOOP                                  17000042
         MEND                                                           17050042
         SPACE 2                                                        17100042
*  BIN MACRO     BIN MACRO     BIN MACRO     BIN MACRO     BIN MACRO  * 17150042
         SPACE 2                                                        17200042
         MACRO                                                          17250042
         BIN   &LOGITEM,&SKIP$OR                                        17300042
.*                                 &LOGITEM - NAME OF ITEM IN LOG       17350042
.*                                      RECORD DSECT                    17400042
.*                                 &SKIP$OR - NBR OF SPACES TO SKIP ON  17450042
.*                                 MULTIPLE PRINT OR NBR OF SPACES      17500042
.*                                      TO BACK UP FROM COLUMN FOR      17550042
.*                                      START OF PRINTING. THE LETTER   17600042
.*                                      B PRECEEDS THE NUMBER (B5) IF   17650042
.*                                      THE LATTER IS DESIRED. OMISSION 17700042
.*                                      OF THIS OPERAND FORCES OPTION 2 17750042
.*                                      WITH BACKUP SPACING EQUAL TO    17800042
.*                                 THE NUMBER OF BITS IN THE ITEM       17850042
.*                                 DEFINITION (VIA MACRO 'DSGEN').      17900042
.*                            A LIMIT OF 15 BITS IS IMPOSED FOR THE     17950042
.*                                 TOTAL NUMBER OF BITS TO PRINT.       18000042
         GBLC &ITEM(1000)                                               18050042
         GBLA &ITEMNBR,&BITS(1000),&SHIFT(1000),&NRENTS                 18100042
         GBLC  &DSECT                                                   18150042
         LCLB  &B                                                       18200042
         LCLA  &IBITS,&NDX,&ISHIFT,&K                                   18250042
         LCLA  &TEMP,&T                                                 18300042
         LCLC  &S                                                       18350042
.LOOP    ANOP                                                           18400042
&NDX     SETA  &NDX+1                                                   18450042
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      18500042
         AIF   (&NDX LT &ITEMNBR).LOOP                                  18550042
         MNOTE *,'YOU BLEW IT'                                          18600042
         ROUTINE DUM,SKIPPER                                            18650042
         MEXIT                                                          18700042
.FOUND   ANOP                                                           18750042
&ISHIFT  SETA  &SHIFT(&NDX)                                             18800042
&IBITS   SETA  &BITS(&NDX)                                              18850042
&T       SETA  &IBITS-1                                                 18900042
&B       SETB  0                                                        18950042
         AIF   ('&SKIP$OR' EQ '').BACKUP                                19000042
&K       SETA  K'&SKIP$OR                                               19050042
&B       SETB  ('&SKIP$OR'(1,1) EQ 'B')                                 19100042
&S       SETC  '&SKIP$OR'(&B+1,&K-&B)                                   19150042
&T       SETA  &S                                                       19200042
.BACKUP  ANOP                                                           19250042
&NRENTS  SETA  &NRENTS+1                                                19300042
&TEMP    SETA  &ISHIFT                                                  19350042
A&SYSNDX DC    AL.12(&LOGITEM-&DSECT),XL.4'&TEMP'                       19400042
         AIF (&IBITS EQ 1 AND &B EQ 0).OUT                              19450042
         ORG   A&SYSNDX                                                 19500042
&B       SETB  1                                                        19550042
         DC    AL.12(&LOGITEM-&DSECT),XL.4'C'                           19600042
         DC    BL.1'&B',AL.7(&T),AL.4(&IBITS),FL.4'&ISHIFT'             19650042
.OUT     ANOP                                                           19700042
         MEND                                                           19750042
         EJECT                                                          19800042
*  HEX MACRO     HEX MACRO     HEX MACRO    HEXN MACRO     HEX MACRO  * 19850042
         SPACE 2                                                        19900042
         MACRO                                                          19950042
         HEX   &LOGITEM,&SKIP$OR,&BYTES                                 20000042
.*                            THIS MACRO FACILITATES GENERATION OF THE  20050042
.*                                 TABLE ENTRIES SPECIFYING HEX TYPE    20100042
.*                                 CONVERSIONS.                         20150042
.*                            &LOGITEM - NAME OF DATA ITEM TO BE        20200042
.*                                 CONVERTED                            20250042
.*                            &SKIP$OR - NUMBER OF SPACES TO SKIP ON    20300042
.*                                 MULTIPLE PRINT OR NBR OF SPACES TO   20350042
.*                                 BACK UP FROM COLUMN FOR START OF     20400042
.*                                 PRINTING. THE LETTER B PRECEEDS THE  20450042
.*                                 NUMBER (B8) IF THE LATTER OPTION IS  20500042
.*                                 DESIRED. OMISSION OF THIS OPERAND    20550042
.*                                 FORCES OPTION 2 WITH BACKUP SPACING  20600042
.*                                 EQUAL TO THE NUMBER OF BYTES SPECI-  20650042
.*                                 FIED BY THE NEXT OPERAND (TWICE THIS 20700042
.*                                 NUMBER IF SUFFIX IS EXPLICITLY OR    20750042
.*                                 IMPLICITLY B).                       20800042
.*                            &BYTES - NUMBER OF TOTAL INPUT BYTES TO   20850042
.*                                 PROCESS. THIS NUMBER IS SUFFIXED     20900042
.*                                 WITH AN L,R, OR B TO STIPULATE       20950042
.*                                 PRINTING OF THE LEFT HALF, RIGHT     21000042
.*                                 HALF, OR BOTH HALVES OF THE BYTE     21050042
.*                                 RESPECTIVELY. OMISSION OF THIS       21100042
.*                                 OPERAND DEFAULTS TO B WITH THE NUM-  21150042
.*                                 BER OF BYTES EQUAL TO THE ITEM LNGTH 21200042
.*                            A NEW ENTRY IS GENERATED ONLY WHEN NECES- 21250042
.*                                 SARY. THIS MACRO MUST BE THE FIRST   21300042
.*                                 MACRO INSTRUCTION ISSUED FOR THE     21350042
.*                                 SUBJECT LINE(S).                     21400042
         GBLC &ITEM(1000),&DSECT                                        21450042
         GBLA &ITEMNBR,&BITS(1000),&SHIFT(1000),&NRENTS                 21500042
         LCLB  &B                                                       21550042
         LCLA  &IBITS,&NDX,&ISHIFT,&K,&T,&CODE,&BYTESP                  21600042
         LCLC  &S,&LETTER                                               21650042
.LOOP    ANOP                                                           21700042
&NDX     SETA  &NDX+1                                                   21750042
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      21800042
         AIF   (&NDX LT &ITEMNBR).LOOP                                  21850042
         MNOTE *,'LOG ITEM NOT DEFINED'                                 21900042
         MEXIT                                                          21950042
.FOUND   ANOP                                                           22000042
&ISHIFT  SETA  &SHIFT(&NDX)                                             22050042
&IBITS   SETA  &BITS(&NDX)                                              22100042
&CODE    SETA  1                                                        22150042
&K       SETA  K'&BYTES                                                 22200042
         AIF   (&IBITS-(&IBITS/4)*4 EQ 0).OK                            22250042
         MNOTE *,'BIT LENGTH SPECIFICATION INCONSISTENT WITH CONTROL'   22300042
         MEXIT                                                          22350042
.OK      AIF   ('&BYTES' EQ '').USEDEFN                                 22400042
&LETTER  SETC  '&BYTES'(&K,1)                                           22450042
&S       SETC  '&BYTES'(1,&K-1)                                         22500042
&BYTESP  SETA  &S                                                       22550042
         AIF   ('&LETTER' EQ 'B').BOTH                                  22600042
         AIF   (&ISHIFT EQ 0 OR &ISHIFT EQ 4).OK2                       22650042
.ERR     MNOTE *,'DATA NOT ALLIGNED ON HEX OR BYTE BOUNDARY'            22700042
         MEXIT                                                          22750042
.USEDEFN ANOP                                                           22800042
&BYTESP  SETA  &IBITS/8                                                 22850042
.BOTH    AIF   (&ISHIFT NE 0).ERR                                       22900042
&CODE    SETA  3                                                        22950042
&T       SETA  &BYTESP*2-1                                              23000042
&S       SETC  '&T'                                                     23050042
.OK2     AIF   (&ISHIFT EQ 0).L                                         23100042
&CODE    SETA  2                                                        23150042
.L       ANOP                                                           23200042
&B       SETB  1                                                        23250042
         AIF   ('&SKIP$OR' EQ '').BACKUP                                23300042
&K       SETA  K'&SKIP$OR                                               23350042
&B       SETB  ('&SKIP$OR'(1,1) EQ 'B')                                 23400042
&S       SETC  '&SKIP$OR'(&B+1,&K-&B)                                   23450042
.BACKUP  ANOP                                                           23500042
&NRENTS  SETA  &NRENTS+1                                                23550042
         DC    AL.12(&LOGITEM-&DSECT),XL.4'A'                           23600042
         DC    BL.1'&B',FL.7'&S',FL.4'&BYTESP',FL.4'&CODE'              23650042
.OUT     ANOP                                                           23700042
         MEND                                                           23750042
         MACRO                                                          23800042
         SPECIAL  &ROUTINE,&PARAM,&SPACE=                               23850042
.*                            THIS MACRO GENERATES A SPECIAL ROUTINE    23900042
.*                                 ENTRY TO BE PROCESSED BY THE SUM. M. 23950042
.*                            &ROUTINE - SYMBOL ON SPECIAL ROUTINE EWT. 24000042
.*                            &PARAM - AN 8 BIT BINARY REPRESENTATION   24050042
.*                                 TO OCCUPY THE 'MASK' FIELD BUT TO BE 24100042
.*                                 INTERPRETED AS AN ARGUMENT OF THE    24150042
.*                                 SPECIAL ROUTINE.                     24200042
.*                            &SPACE - THE NUMBER OF 2BYTE COUNTERS TO  24250042
.*                                 ALLOCATE FOR REQUIRED PROCESSING.    24300042
         GBLC  &CSECT                                                   24350042
         GBLA  &COUNTR                                                  24400042
         LCLA  &ADD                                                     24450042
         DC    AL1(128)                                                 24500042
         DC    BL.8'&PARAM'                                             24550042
         DC    AL2(&ROUTINE-&CSECT)                                     24600042
         DC    AL2(&COUNTR)                                             24650042
&ADD     SETA  1                                                        24700042
         AIF   ('&SPACE' EQ '').NORM                                    24750042
&ADD     SETA  &SPACE                                                   24800042
.NORM    ANOP                                                           24850042
&COUNTR  SETA  &COUNTR+&ADD                                             24900042
         MEND                                                           24950042
         MACRO                                                          25000042
         SUM   &LOGITEM,&MASK                                           25050042
.*                            THIS MACRO GENERATES A NORMAL EDIT ENTRY  25100042
.*                                 FOR PROCESSING BY THE SUMMARY MODULE 25150042
.*                            &LOGITEM - NAME OF DATA ITEM TO BE SUMMED 25200042
.*                            &MASK - BYTE MASK FOR BITS TO BE TESTED.  25250042
.*                                 THIS OPERAND SHOULD BE OMITTED FOR   25300042
.*                                 SINGLE BIT ITEMS IN WHICH CASE THE   25350042
.*                                 MASK WILL BE SET ACCORDING TO THE    25400042
.*                                 OFF BYTE BIT DISPLACEMENT OF THE     25450042
.*                                ITEM AS DEFINED BY THE MACRO 'DSGEN'  25500042
         GBLA  &COUNTR,&ITEMNBR,&BITS(1000),&SHIFT(1000)                25550042
         GBLC  &ITEM(1000),&DSECT                                       25600042
         LCLA  &IBITS,&NDX,&ISHIFT,&M,&BITNBR                           25650042
.LOOP    ANOP                                                           25700042
&NDX     SETA  &NDX+1                                                   25750042
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      25800042
         AIF   (&NDX LT &ITEMNBR).LOOP                                  25850042
         MNOTE *,'LOGITEM NOT FOUND'                                    25900042
         MEXIT                                                          25950042
.FOUND   ANOP                                                           26000042
         DC    AL1(0)                                                   26050042
&ISHIFT  SETA  &SHIFT(&NDX)                                             26100042
&IBITS   SETA  &BITS(&NDX)                                              26150042
         AIF   ('&MASK' EQ '').FORM                                     26200042
         DC    B'&MASK'                                                 26250042
         AGO   .ITEM                                                    26300042
.FORM    ANOP                                                           26350042
&BITNBR  SETA  &ISHIFT-7                                                26400042
&BITNBR  SETA  0-&BITNBR                                                26450042
&M       SETA  1                                                        26500042
.LOOP2   ANOP                                                           26550042
         AIF   (&BITNBR EQ 0).GOTIT                                     26600042
&M       SETA  &M*2                                                     26650042
&BITNBR  SETA  &BITNBR-1                                                26700042
         AGO   .LOOP2                                                   26750042
.GOTIT   ANOP                                                           26800042
         DC    AL1(&M)                                                  26850042
.ITEM    DC    AL2(&LOGITEM-&DSECT)                                     26900042
         DC    AL2(&COUNTR)                                             26950042
&COUNTR  SETA  &COUNTR+1                                                27000042
         MEND                                                           27050042
         GBLC  &DSECT,&CSECT                                            27100042
&CSECT   SETC  'IFCS3350'                                               27150042
&DSECT   SETC  'S3350'                                                  27200042
IFCS3350 CSECT                                                          27250042
S3350    DSECT                                                          27300042
         DSGEN (CLASRC,8),(SYSREL,8),(SWITCHES,16)             @Z30RIVS 27350042
         DSGEN (RECID,8),(SPARE1,16),(TYPE,8)                  @Z30RIVS 27400042
         DSGEN (DAY,32)                                        @Z30RIVS 27450042
         DSGEN (HOUR,32)                                       @Z30RIVS 27500042
         DSGEN (SPARE2,8),(CPUSERL,24)                         @Z30RIVS 27550042
         DSGEN (CPUID,16),(SPARE3,16)                          @Z30RIVS 27600042
         DSGEN (JCUAID,16),(JVOLID1,16)                        @Z30RIVS 27650042
         DSGEN (JVOLID2,32)                                    @Z30RIVS 27700042
         DSGEN (TSNB00,2),(TSNB02,1),(TSNB03,2),(TSNB05,1),    @Z30RIVSC27750042
               (TSNB06,2),(TSNB10,1),                          @Z30RIVSC27800042
               (TSNB11,1),(TSNB12,6),(TSNB20,8),(TSNB30,8)     @Z30RIVS 27850042
         DSGEN (TSNB40,8),(TSNB50,8),(TSNB60,8),(TSNB70,8)     @Z30RIVS 27900042
         DSGEN (TSNB80,8),(TSNB90,8),(TSNB100,8),(TSNB110,8)   @Z30RIVS 27950042
         DSGEN (TSNB120,8),(TSNB130,8),(TSNB140,8),(TSNB150,8) @Z30RIVS 28000042
         DSGEN (TSNB160,8),(TSNB170,8),(TSNB180,8),(TSNB190,8) @Z30RIVS 28050042
         DSGEN (TSNB200,8),(TSNB210,8),(TSNB220,8),(TSNB230,8) @Z30RIVS 28100042
         DSGEN (SPARE4,8),(CUA,24)                             @Z30RIVS 28150042
         DSGEN (IORET,24),(SBCNT,8)                            @Z30RIVS 28200042
         DSGEN (VOLID1,32)                                     @Z30RIVS 28250042
         DSGEN (VOLID2,16),(SPARE5,16)                         @Z30RIVS 28300042
         DSGEN (LSKAD1,64)                                     @Z30RIVS 28350042
         DSGEN (AHA1,32)                                       @Z30RIVS 28400042
         DSGEN (AHA2,16),(SPARE6,16)                           @Z30RIVS 28450042
         DSGEN (SNB00,2),(SNB02,1),(SNB03,2),(SNB05,1),        @Z30RIVSC28500042
               (SNB06,2),(SNB10,1),                            @Z30RIVSC28550042
               (SNB11,1),(SNB12,6),(SNB20,8),(SNB30,8)         @Z30RIVS 28600042
         DSGEN (SNB40,8),(SNB50,8),(SNB60,8),(SNB70,8)         @Z30RIVS 28650042
         DSGEN (SNB80,8),(SNB90,8),(SNB100,8),(SNB110,8)       @Z30RIVS 28700042
         DSGEN (SNB120,8),(SNB130,8),(SNB140,8),(SNB150,8)     @Z30RIVS 28750042
         DSGEN (SNB160,8),(SNB170,8),(SNB180,8),(SNB190,8)     @Z30RIVS 28800042
         DSGEN (SNB200,8),(SNB210,8),(SNB220,8),(SNB230,8)     @Z30RIVS 28850042
*                                                              @Z30RIVS 28900042
IFCS3350 CSECT                                                 @Z30RIVS 28950042
         USING S3350,R2                                        @Z30RIVS 29000042
         USING *,R9                                            @Z30RIVS 29050042
         DC    A(ENTRIES)                                      @Z30RIVS 29100042
         DC    A(PEDIT)                                        @Z30RIVS 29150042
*                                                              @Z30RIVS 29200042
REG8     DC    F'0'                                            @Z30RIVS 29250042
SCSIZE   DC    H'2273'                                         @Z427VLS 29300042
*                                                              @Z30RIVS 29350042
R0       EQU   0                                               @Z30RIVS 29400042
R1       EQU   1                                               @Z30RIVS 29450042
R2       EQU   2                                               @Z30RIVS 29500042
R3       EQU   3                                               @Z30RIVS 29550042
R4       EQU   4                                               @Z30RIVS 29600042
R5       EQU   5                                               @Z30RIVS 29650042
R6       EQU   6                                               @Z30RIVS 29700042
R7       EQU   7                                               @Z30RIVS 29750042
R8       EQU   8                                               @Z30RIVS 29800042
R9       EQU   9                                               @Z30RIVS 29850042
R10      EQU   10                                              @Z30RIVS 29900042
R11      EQU   11                                              @Z30RIVS 29950042
R12      EQU   12                                              @Z30RIVS 30000042
R13      EQU   13                                              @Z30RIVS 30050042
R14      EQU   14                                              @Z30RIVS 30100042
R15      EQU   15                                              @Z30RIVS 30150042
*                                                              @Z30RIVS 30200042
L0       EQU   0                                               @Z30RIVS 30250042
L1       EQU   1                                               @Z30RIVS 30300042
L2       EQU   2                                               @Z30RIVS 30350042
L3       EQU   3                                               @Z30RIVS 30400042
L4       EQU   4                                               @Z30RIVS 30450042
L5       EQU   5                                               @Z30RIVS 30500042
L6       EQU   6                                               @Z30RIVS 30550042
L7       EQU   7                                               @Z30RIVS 30600042
L8       EQU   8                                               @Z30RIVS 30650042
L9       EQU   9                                               @Z30RIVS 30700042
L10      EQU   10                                              @Z30RIVS 30750042
L11      EQU   11                                              @Z30RIVS 30800042
L12      EQU   12                                              @Z30RIVS 30850042
L13      EQU   13                                              @Z30RIVS 30900042
L14      EQU   14                                              @Z30RIVS 30950042
L15      EQU   15                                              @Z30RIVS 31000042
L16      EQU   16                                              @Z30RIVS 31050042
L17      EQU   17                                              @Z30RIVS 31100042
L18      EQU   18                                              @Z30RIVS 31150042
L19      EQU   19                                              @Z30RIVS 31200042
L20      EQU   20                                              @Z30RIVS 31250042
L22      EQU   22                                              @Z30RIVS 31300042
L23      EQU   23                                              @Z30RIVS 31350042
L24      EQU   24                                              @Z30RIVS 31400042
L26      EQU   26                                              @Z30RIVS 31450042
L27      EQU   27                                              @Z30RIVS 31500042
L28      EQU   28                                              @Z30RIVS 31550042
L40      EQU   40                                              @Z427VLS 31560042
L42      EQU   42                                              @Z427VLS 31570042
L29      EQU   29                                              @Z30RIVS 31600042
L30      EQU   30                                              @Z30RIVS 31650042
L31      EQU   31                                              @Z30RIVS 31700042
L32      EQU   32                                              @Z30RIVS 31750042
L36      EQU   36                                              @Z30RIVS 31800042
L39      EQU   39                                              @Z30RIVS 31850042
L44      EQU   44                                              @Z30RIVS 31900042
L46      EQU   46                                              @Z30RIVS 31950042
L47      EQU   47                                              @Z30RIVS 32000042
L48      EQU   48                                              @Z30RIVS 32050042
L49      EQU   49                                              @Z30RIVS 32100042
L50      EQU   50                                              @Z30RIVS 32150042
L480     EQU   480                                             @Z30RIVS 32200042
L510     EQU   510                                             @Z30RIVS 32250042
L1460    EQU   1460                                            @Z30RIVS 32300042
H0F      EQU   X'0F'                                           @Z30RIVS 32350042
HE0      EQU   X'E0'                                           @Z30RIVS 32400042
HF0      EQU   X'F0'                                           @Z30RIVS 32450042
H00      EQU   X'00'                                           @Z30RIVS 32500042
H01      EQU   X'01'                                           @Z30RIVS 32550042
H02      EQU   X'02'                                           @Z30RIVS 32600042
H04      EQU   X'04'                                           @Z30RIVS 32650042
H08      EQU   X'08'                                           @Z30RIVS 32700042
HC0      EQU   X'C0'                                           @Z30RIVS 32750042
H80      EQU   X'80'                                           @Z30RIVS 32800042
H50      EQU   X'50'                                           @Z30RIVS 32850042
H40      EQU   X'40'                                           @Z30RIVS 32900042
H30      EQU   X'30'                                           @Z30RIVS 32950042
H20      EQU   X'20'                                           @Z30RIVS 33000042
H10      EQU   X'10'                                           @Z30RIVS 33050042
H21      EQU   X'21'                                           @Z30RIVS 33100042
H23      EQU   X'23'                                           @Z30RIVS 33150042
H25      EQU   X'25'                                           @Z30RIVS 33200042
H29      EQU   X'29'                                           @Z30RIVS 33250042
H18      EQU   X'18'                                           @Z30RIVS 33300042
H32      EQU   X'32'                                           @Z30RIVS 33350042
H90      EQU   X'90'                                           @Z30RIVS 33400042
CHART    EQU   C'T'                                            @Z30RIVS 33450042
CLRSGN   EQU   X'F0'                                           @Z30RIVS 33500042
LOGMODE  EQU   X'10'                                           @Z30RIVS 33550042
NOLOG    EQU   X'7F'                                           @Z30RIVS 33600042
HEXFD    EQU   X'FD'                                           @Z30RIVS 33650042
SLASH    EQU   C'/'                                            @Z30RIVS 33700042
BLANK    EQU   X'40'                                           @Z30RIVS 33750042
COLON    EQU   C':'                                            @Z30RIVS 33800042
SETSORT  EQU   X'80'                                           @Z30RIVS 33850042
ON       EQU   1                                               @Z30RIVS 33900042
HEX02    EQU   X'02'                                           @Z30RIVS 33950042
NOCARRY  EQU   12                  COND CODE AFTER 'AL' =      @Z30RIVS 34000042
**    NO CARRY(OVERFLOW) INTO BIT POSITION 32                  @Z30RIVS 34050042
**                                                             @Z30RIVS 34100042
XDATE1   STM   R5,R8,XSAVE1        SAVE REGS                   @Z30RIVS 34150042
         CLC   DAY(L4),HEX00       IS DATE ZERO                @Z30RIVS 34200042
         BE    RETURN1             BR-ZERO                     @Z30RIVS 34250042
         CLC   L0(L4,R3),HEX00     IS LOW DATE ZERO            @Z30RIVS 34300042
         BNE   XDATE2              BR-NO                       @Z30RIVS 34350042
         MVC   L0(L4,R3),DAY       MOVE IN DATE                @Z30RIVS 34400042
XDATE2   CLC   DAY(L4),L0(R3)      CHECK FOR LOW DATE          @Z30RIVS 34450042
         BL    SAVELOW             LOWER SAVE IT               @Z30RIVS 34500042
         CLC   DAY(L4),L4(R3)      CHECK FOR HI                @Z30RIVS 34550042
         BNH   RETURN1                                         @Z30RIVS 34600042
SAVEHI   MVC   L4(L4,R3),DAY       MOVE HI DATE                @Z30RIVS 34650042
         B     RETURN1                                         @Z30RIVS 34700042
SAVELOW  MVC   L0(L4,R3),DAY       MOVE LOW DATE               @Z30RIVS 34750042
         B     RETURN1                                         @Z30RIVS 34800042
ISTPER   STM   R5,R8,XSAVE1        SAVE REGISTERS              @Z30RIVS 34850042
         SR    R8,R8               REGS                        @Z30RIVS 34900042
         USING T3350A,R3                                       @Z40RIVS 34950042
         LA    R6,T3350B           LOAD ADDR OF SUM COUNTER    @Z40RIVS 35000042
         ST    R6,VOLPTR           STORE VOL CNTR ADDR         @Z30RIVS 35050042
         LA    R6,T3350C           LOAD ADDR OF SUM COUNTER    @Z40RIVS 35100042
         ST    R6,FLTPTR           STORE FLT SUM CNTR ADDR     @Z30RIVS 35150042
         DROP  R3                                              @Z40RIVS 35200042
         LR    R5,R3               GET ADDR OF SUM CNTR        @Z30RIVS 35250042
         LA    R5,L32(R5)          INCR TO START OF CNTR       @Z40RIVS 35300042
         A     R5,RECTST4          PNT TO REC FOR DEV          @Z30RIVS 35350042
         ST    R3,RECTSTS          SAVE SUM PNTR               @Z30RIVS 35400042
         ST    R5,RECTSTP          SAVE REC PNTR               @Z30RIVS 35450042
         MVC   L0(L32,R3),L0(R5)   MOVE REC TO SUM AREA        @Z40RIVS 35500042
         LR    R5,R3               GET ADDRESS OF SUMMARY COUNTER       35550042
         MVC   L2(L1,R5),CLASRC    SAVE RECORD CLASS/SOURCE    @Z30RIVS 35600042
         TM    CLASRC,H90          TEST FOR A TPER RECORD      @Z30RIVS 35650042
         BO    TYPTPER             YES                         @Z30RIVS 35700042
**                                                             @Z30RIVS 35750042
**       NO - SAVE DEVICE TYPE CODE,BUT DONT ADD TO COUNTERS   @Z30RIVS 35800042
**                                                             @Z30RIVS 35850042
         MVC   L28(L2,R3),CUA+L1   SAVE DEVICE ADDR            @Z30RIVS 35900042
         MVC   L3(L2,R5),TSNB220   SAVE DEVICE CODE            @Z30RIVS 35950042
         B     RETURN1             RETURN                      @Z30RIVS 36000042
TYPTPER  MVC   L28(L2,R3),JCUAID   SAVE DEVICE ADDR            @Z30RIVS 36050042
         BAL   R8,ADDUP            GO ADD TO COUNT OF TPER RECORDS      36100042
         LA    R8,DOVOL-L6         MOVE POINTER TO ADD VOL ID  @Z30RIVS 36150042
         ST    R8,REG8                                         @Z30RIVS 36200042
         MVC   L1(L1,R5),RECID     SAVE RECORD ID              @Z30RIVS 36250042
         B     RETURN1                                         @Z30RIVS 36300042
ISLOG    STM   R5,R8,XSAVE1        SAVE REGISTERS              @Z30RIVS 36350042
         SR    R6,R6               ZERO                        @Z30RIVS 36400042
         SR    R8,R8               REGS                        @Z30RIVS 36450042
         TM    CLASRC,H32          IS THIS A CONVERTED OBR     @Z30RIVS 36500042
         BNO   NEWREC              NO                          @Z40RIVS 36550042
TESTCONV TM    SBCNT,H18           HAS THIS RECORD BEEN CONDENSED       36600042
         BO    NEWREC              YES                         @Z30RIVS 36650042
         MVC   SNB00(L24),SNB100   NO,MOVE SENSE OVER SDR      @Z30RIVS 36700042
NEWREC   LR    R5,R3               GET ADDRESS OF SUMMARY COUNTERS      36750042
         TM    SNB00,H08           DATA CHECK                           36760042
         BNO   NEWREC1             NO, GO FOR NORMAL                    36770042
         TM    SNB70,H50           FORMAT 5?                            36780042
         BNO   NEWREC1             NO,GO FOR LOGGING MODE               36790042
         BAL   R8,ADDUP            SUMM                                 36800042
         L     R3,VOLPTR             PICK UP ADDR OF VOL CNT   @XA20375 36810001
         LR    R5,R3                 SET POINTER TO CNTR       @XA20375 36810501
CORRVOL  CLC   ZEROS(L6),VOLID1      IS THIS VOLID ZEROS       @XA20375 36811001
         BE    LOGRET                DO NOT PROCESS FURTHER    @XA20375 36811501
         LA    R7,L50                SET NUM VOL ID'S ALLOWED  @XA20375 36812001
CORRVOL2 CLC   L0(L6,R5),VOLID1      COMPARE VOLID TO FIRST    @XA20375 36812501
         BNE   CORRVOL4              UNEQUAL BYPASS            @XA20375 36813001
         CLC   L26(L2,R5),CUA+L1     MOVE IN DEVICE ADDR       @XA20375 36813501
         BE    CORRVOL5              EQUAL GO TO SUM           @XA20375 36814001
CORRVOL4 CLC   L0(L6,R5),ZEROS       NO IS VOL ID EQ TO BLANKS @XA20375 36814501
         BE    CORRVOL3              YES THIS IS FIRST ONE     @XA20375 36815001
         LA    R5,L28(R5)            BUMP TO NEXT VOLID        @XA20375 36815501
         BCT   R7,CORRVOL2           LOOP TO FIRST TESTRM ABOV @XA20375 36816001
CORRVOL3 MVC   L0(L6,R5),VOLID1      MOVE IN VOLID             @XA20375 36816501
         MVC   L26(L2,R5),CUA+L1     MOVE IN DEVICE ADDR       @XA20375 36817001
CORRVOL5 LA    R5,L22(R5)            BUMP TO CORR READ CNTR    @XA20375 36817501
         STCM  R6,L15,L0(R5)         STORE TOTAL CORR DATA CKS @XA20375 36818001
         B     LOGRET                                                   36820042
NEWREC1  EQU   *                                                        36830042
         TM    SNB20,H10           WAS THIS RECORDED IN LOGGING MOD     36850042
         BNO   RETURN1             NO                          @Z40RIVS 36900042
         LA    R5,L2(R5)           NO,BUMP POINTER RO DATA CHK RTRY     37050042
         TM    SNB70,H40           IS THIS DATA CHECK RETRY    @Z30RIVS 37100042
         BO    LOGMOD1             YES,FORMAT 4 INDICATES DCR  @Z30RIVS 37150042
         LA    R5,L2(R5)           NO,BUMP POINTER TO SEEK CHECK        37200042
         TM    SNB70,H10           IS THIS SEEK CHECK          @Z30RIVS 37250042
         BNO   LOGRET              NO                          @Z40RIVS 37300042
LOGMOD1  BAL   R8,ADDUP            FMT 1 INDICATES SEEK CK     @Z40RIVS 37350042
LOGRET   LA    R8,ENDLOG-L6        LOG MOD ENDS,DO NOT ADD FURTHER      37400042
         ST    R8,REG8                                         @Z30RIVS 37450042
         B     RETURN1                                         @Z30RIVS 37500042
**                                                             @Z30RIVS 37550042
         EJECT                                                 @Z30RIVS 37600042
**                                                             @Z30RIVS 37650042
**       ROUTINE TO SUM INTO THE SPECIFIC SUM AREA FOR DEVICE  @Z30RIVS 37700042
**                                                             @Z30RIVS 37750042
RECTST0  STM   R5,R8,XSAVE1        SAVE REG                    @Z30RIVS 37800042
         IC    R7,JCUAID+L1        PICK UP MDR CUA             @Z40RIVS 37850042
         TM    CLASRC,H90          TEST TYPE RECORD            @Z30RIVS 37900042
         BO    RECTST1             GO TO CLEAR HIGH BYTES      @Z40RIVS 37950042
         IC    R7,CUA+L2           PICK UP OBR CUA             @Z30RIVS 38000042
RECTST1  SLL   R7,L28              CLEAR HIGH BYTES                     38050042
         SRL   R7,L28              IN REG7                              38100042
         LTR   R7,R7               TEST REG7 FOR ZERO          @Z30RIVS 38150042
         BZ    RECTST2             BRANCH FOR ZERO INCRMT      @Z30RIVS 38200042
         LA    R5,L32              LOAD REG5 WITH INCRMT       @Z40RIVS 38250042
         MR    R6,R5               SET REG7 TO SUM AREA        @Z30RIVS 38300042
RECTST2  ST    R7,RECTST4          SAVE INCRMT                 @Z30RIVS 38350042
         B     RETURN1             RETURN                      @Z30RIVS 38400042
**                                                             @Z30RIVS 38450042
**                                                             @Z30RIVS 38500042
**       SPECIAL TO RESTORE SUMREC BACK TO ITS PROPER POSITION @Z30RIVS 38550042
**                                                             @Z30RIVS 38600042
RESTOR   STM   R5,R8,XSAVE1        SAVE WORK REGS              @Z30RIVS 38650042
         L     R5,RECTSTS          PICK UP PNTR TO SUM AREA    @Z30RIVS 38700042
         L     R6,RECTSTP          PICK UP PNTR TO DEV AREA    @Z30RIVS 38750042
         MVC   L0(L32,R6),L0(R5)   RESTORE SUM CNTR            @XM09337 38800042
         B     RETURN1             RETURN                      @Z30RIVS 38850042
**                                                             @Z30RIVS 38900042
EQUIP    STM   R5,R8,XSAVE1        SAVE REGISTERS              @Z30RIVS 38950042
         SR    R6,R6               ZERO                        @Z30RIVS 39000042
         SR    R8,R8               REGS                        @Z30RIVS 39050042
         LR    R5,R3               GET ADDRESS OF SUMMARY COUNTERS      39100042
         TM    SNB00,H10           IS THIS EQUIPMET CHECK      @Z30RIVS 39150042
         BNO   RETURN1             NO RETURN,DO NOT ADD TO COUNTERS     39200042
EQUIPON  TM    SNB70,H30           IS THIS FORMAT 3            @Z30RIVS 39250042
         BO    EQUIPON1            YES                         @Z30RIVS 39300042
         TM    SNB70,H20           FORMAT 2                    @Z30RIVS 39350042
         BO    EQUIPON1            YES                         @Z30RIVS 39400042
         TM    SNB70,HF0           FORMAT 0                    @Z30RIVS 39450042
         BZ    EQUIPON1            YES                         @Z30RIVS 39500042
         TM    SNB70,H50           IS THIS FORMAT 5            @Z30RIVS 39550042
         BO    RETURN1             YES,DO NOT ADD TO COUNTERS  @Z30RIVS 39600042
         TM    SNB70,H10           FORMAT 1                    @Z30RIVS 39650042
         BNO   RETURN1             NO DO NOT ADD TO COUNTERS   @Z40RIVS 39700042
EQUIPON3 LA    R5,L4(R5)           POINT TO PROPER COUNTER     @Z40RIVS 39750042
         TM    SNB10,H80           IS THIS PERMANENT ERROR     @Z40RIVS 39800042
          BO    EQUPON4A               YES  PERM               @XA16795 39850001
          TM    SWITCHES+1,X'40'       TEST TEMP BIT HEADER    @XA16795 39870001
          BO    EQUIPON4               TEMP GO ADD             @XA16795 39890001
EQUPON4A  LA    R5,L2(R5)              BUMP POINT TO PERM CNTR @XA16795 39910001
EQUIPON4 BAL   R8,ADDUP            GO ADD TO TOTAL EQ DRIVE PERM        39950042
         B     RETURN1                                         @Z40RIVS 40000042
EQUIPON1 TM    SNB10,H80           IS THIS PERMANENT ERROR     @Z30RIVS 40050042
          BO    EQUPON2A               YES  PERM               @XA16795 40100001
          TM    SWITCHES+1,X'40'       TEST TEMP BIT HEADER    @XA16795 40120001
          BO    EQUIPON2               TEMP GO ADD             @XA16795 40140001
EQUPON2A  LA    R5,L2(R5)              BUMP POINT TO PERM CNTR @XA16795 40160001
EQUIPON2 BAL   R8,ADDUP            GO ADD TO TOTAL EQ CONT PERM@Z40RIVS 40200042
         B     RETURN1                                         @Z30RIVS 40250042
DATACKP  STM   R5,R8,XSAVE1        SAVE REGISTERS              @Z30RIVS 40300042
         SR    R6,R6               ZERO                        @Z30RIVS 40350042
         LR    R5,R3               GET ADDRESS OF SUMMARY COUNTER       40400042
         TM    SNB00,H08           TEST FOR DATA CHECK OBR     @Z30RIVS 40450042
         BNO   RETURN1             NO RETURN                   @Z40RIVS 40500042
DATACKP1 TM    SNB10,H80           IS THIS DATA CHECK PERMANENT@Z30RIVS 40550042
          BO    DATACKP2               YES, GO ADD             @XA16795 40600001
          TM    SWITCHES+1,X'40'       TEST TEMP BIT HEADER    @XA16795 40610001
          BO    RETURN1                DON'T ADD TEMP          @XA16795 40620001
DATACKP2 BAL   R8,ADDUP            ADD TO DATA CHECK,PERM      @Z40RIVS 40650042
         B     RETURN1                                         @Z30RIVS 40700042
TVOLID   STM   R5,R8,XSAVE1        SAVE THE REGS               @Z30RIVS 40750042
         SR    R6,R6                                           @Z30RIVS 40800042
         SR    R7,R7                                           @Z30RIVS 40850042
         SR    R8,R8                                           @Z30RIVS 40900042
         L     R3,VOLPTR           PICK UP ADDR OF VOL CNT     @Z30RIVS 40950042
         LR    R5,R3               GET POINTER TO COUNTERS     @Z30RIVS 41000042
         TM    CLASRC,H90          IS THIS AN  MDR  RECORD     @Z30RIVS 41050042
         BNO   RETURN1             NO RETURN FOR ANOTHER       @Z40RIVS 41100042
TVOLID1A CLC   ZEROS(L6),JVOLID1   IS THIS VOL ID ZEROS        @Z30RIVS 41150042
         BE    RETURN1             YES GO GET ANOTHER          @Z30RIVS 41200042
         LA    R7,L50              SET NO OF VLO ID'S ALLOWED  @Z30RIVS 41250042
TVOLID2A CLC   L0(L6,R5),JVOLID1   COMPARE VOL ID TO FIRST     @Z30RIVS 41300042
         BNE   TVOLID4Z            UNEQUAL,BYPASS              @Z40RIVS 41350042
TVOLID4X CLC   L26(L2,R5),JCUAID   CHECK DEVICE ADDR           @Z40RIVS 41400042
         BE    TVOLID4A            EQ GO TO SUM                @Z40RIVS 41450042
TVOLID4Z CLC   L0(L6,R5),ZEROS     NO,IS VOL ID EQUAL TO BLANKS@Z30RIVS 41500042
         BE    TVOLID3A            YES THEN THIS IS FIRST ONE  @Z30RIVS 41550042
         LA    R5,L28(R5)      BUMP TO NEXT VOLID              @XA11914 41600042
         BCT   R7,TVOLID2A         LOOP TO FIRST TEST          @Z30RIVS 41650042
TVOLID3A MVC   L0(L6,R5),JVOLID1   MOVE IN VOL ID              @Z30RIVS 41700042
         MVC   L26(L2,R5),JCUAID   MOVE IN DEVICE ADDR         @Z30RIVS 41750042
TVOLID4A LA    R5,L6(R5)           BUMP POINTER TO COUNTERS    @Z30RIVS 41800042
         ICM   R6,L15,L0(R5)       SEEKS                       @Z40RIVS 41850042
         AH    R6,TSNB160          COUNT OF SEEKS              @Z40RIVS 41900042
         STCM  R6,L15,L0(R5)       SAVE TOTAL                  @Z40RIVS 41950042
         LA    R5,L4(R5)           BUMP CNTR PTR               @Z30RIVS 42000042
         SR    R6,R6               CLEAR REG                   @Z30RIVS 42050042
         SPACE 1                                               @Z30RIVS 42100042
         IC    R6,TSNB190          GET COUNT OF SEEK ERRORS    @Z30RIVS 42150042
         AH    R6,L0(R5)           ADD TO COUNTER              @Z30RIVS 42200042
         STCM  R6,L3,L0(R5)        SAVE TOTAL                  @Z40RIVS 42250042
         LA    R5,L2(R5)           BUMP COUNTER POINTER        @Z30RIVS 42300042
         SPACE 1                                               @Z30RIVS 42350042
         ICM   R6,L15,TSNB80       MOVE IN NUMBER OF BYTES READ@Z40RIVS 42400042
         ICM   R7,L15,L2(R5)       ADD BYTES READ              @Z40RIVS 42450042
         ALR   R6,R7               ADD BYTES READ              @Z40RIVS 42500042
         BC    NOCARRY,SAVBTRD     BR IF NO OVERFLOW           @Z30RIVS 42550042
**             IF THERE WAS A CARRY                            @Z30RIVS 42600042
         LH    R7,L0(R5)           LOAD OVERFLOW CNTR          @Z30RIVS 42700042
         LA    R7,L1(R7)           BUMP BY ONE                 @Z30RIVS 42750042
         STH   R7,L0(R5)           SAVE CNTR                   @Z30RIVS 42800042
**                                                             @Z30RIVS 42850042
SAVBTRD  STCM  R6,L15,L2(R5)       SAVE BYTES READ             @Z40RIVS 42900042
         LA    R5,L6(R5)           BUMP CNTR PTR               @Z30RIVS 42950042
         SPACE 1                                               @Z30RIVS 43000042
         ICM   R6,L15,L0(R5)       LOAD TOTAL                  @Z40RIVS 43050042
         AH    R6,TSNB140          UNCORR DATA CKS             @Z40RIVS 43100042
         STCM  R6,L15,L0(R5)       SAVE TOTAL                  @Z40RIVS 43150042
         LA    R5,L4(R5)           BUMP CNTR PTR               @Z30RIVS 43200042
         SPACE 1                                               @Z30RIVS 43250042
         SPACE 1                                                        43420042
**                                                                      43480042
**       THE FOLLOWING ROUTINE DETERMINES IF THE COUNTS ARE MADE        43550042
**       FOR CHANNEL 'A' AND 'B' OR CHANNEL 'C' AND 'D'.       @Z30RIVS 43600042
**                                                             @Z30RIVS 43650042
         LA    R5,ABCNTR(R3)       SET PTR TO A/B CNTRS        @Z40RIVS 43700042
         CLI   TSNB180,H80         IS THIS REC FOR CHNL C/D    @Z30RIVS 43750042
         BNE   TVOLID5A            BRANCH TO TOTAL COUNTERS    @Z40RIVS 43800042
CHANCD   LA    R5,CDCNTR(R3)       SET POINTER TO C/D CNTRS    @Z30RIVS 43850042
**                                                             @Z30RIVS 43900042
TVOLID5A SR    R6,R6                                           @Z30RIVS 43950042
         IC    R6,TSNB200          GET COUNT OVERRUN A/C CMND  @Z30RIVS 44000042
         AH    R6,L0(R5)           ADD TO COUNTER              @Z30RIVS 44050042
         STCM  R6,L3,L0(R5)        SAVE TOTAL                  @Z40RIVS 44100042
         LA    R5,L2(R5)           BUMP COUNTER POINTER        @Z30RIVS 44150042
         SR    R6,R6                                           @Z30RIVS 44200042
         IC    R6,TSNB210          GET COUNT OVERRUN A/C DATA  @Z30RIVS 44250042
         AH    R6,L0(R5)           ADD TO COUNTER              @Z30RIVS 44300042
         STCM  R6,L3,L0(R5)        SAVE TOTAL                  @Z40RIVS 44350042
         LA    R5,L2(R5)           BUMP COUNTER POINTER        @Z30RIVS 44400042
         SR    R6,R6                                           @Z30RIVS 44450042
         IC    R6,TSNB220          GET COUNT OVERRUN B/D CMND  @Z30RIVS 44500042
         AH    R6,L0(R5)           ADD TO COUNTER              @Z30RIVS 44550042
         STCM  R6,L3,L0(R5)        SAVE TOTAL                  @Z40RIVS 44600042
         LA    R5,L2(R5)                                       @Z30RIVS 44650042
         SR    R6,R6                                           @Z30RIVS 44700042
         IC    R6,TSNB230          GET COUNT OVERRUN B/D DATA  @Z30RIVS 44750042
         AH    R6,L0(R5)           ADD TO COUNTER              @Z30RIVS 44800042
         STCM  R6,L3,L0(R5)        SAVE TOTAL                  @Z40RIVS 44850042
         B     RETURN1                                         @Z30RIVS 44900042
ADDUP    LH    R6,L0(R5)           PUT THE SUMMARY COUNTER IN REG 6     44950042
         LA    R6,L1(R6)           ADD ONE TO THE SUMMARY COUNTER       45000042
         STH   R6,L0(R5)           REPLACE COUNTER             @Z30RIVS 45050042
         LA    R5,L2(R5)           BUMP POINTER TO NEXT COUNTER@Z30RIVS 45100042
         BR    R8                  RETURN                      @Z30RIVS 45150042
**                                                             @Z30RIVS 45200042
**       SPECIAL TO SUM INTO THE FAULT SYMPTOM COUNTERS        @Z30RIVS 45250042
**                                                             @Z30RIVS 45300042
TFAULT0  STM   R5,R8,XSAVE1        SAVE WORK REG               @Z30RIVS 45350042
         TM    CLASRC,H30          TYPE REC AN OBR             @Z30RIVS 45400042
         BNO   RETURN1             ONLY USE OBR REC            @Z40RIVS 45450042
         TM    SNB70,H50          FORMAT 5?                             45460042
         BO    RETURN1            YES, DON'T SUM                        45470042
TFAULT1  L     R3,FLTPTR           PNT TO FLT SUM AREA         @Z30RIVS 45500042
         LA    R6,L1               SET OCCUR INCREMENT         @Z30RIVS 45550042
         LA    R7,L50              SET TO NUM OF SUMRECORD     @Z30RIVS 45600042
TFAULT2  CLC   L0(L2,R3),SNB220    IS FLT CODE EQ SUM REC      @Z30RIVS 45650042
         BE    TFAULT3             YES GO TEST CUA             @Z30RIVS 45700042
         CLC   L0(L2,R3),ZEROS     IS SUM REC ZERO             @Z30RIVS 45750042
         BE    TFAULT9             YES GO TEST REC CUA         @Z30RIVS 45800042
         B     TFAULT8             GO TO GET NEXT SUM REC      @Z30RIVS 45850042
TFAULT3  CLC   L2(L2,R3),CUA+L1    IS CUA EQ TO SUM REC        @Z30RIVS 45900042
         BE    TFAULT5             YES GO TO SUM               @Z30RIVS 45950042
TFAULT9  CLC   L2(L2,R3),ZEROS     IS REC CUA EQU TO ZEROS     @Z30RIVS 46000042
         BE    TFAULT4             YES STORE NEW REC           @Z30RIVS 46050042
TFAULT8  LA    R3,L40(R3)          STEP TO NEXT COUNTER        @Z427VLS 46100042
         BCT   R7,TFAULT2          GO TRY AGAIN                @Z30RIVS 46150042
         B     RETURN1             ALL ENTRIES FULL            @Z30RIVS 46200042
TFAULT4  MVC   L0(L2,R3),SNB220    MOVE FLT CODE TO REC        @Z30RIVS 46250042
         MVC   L2(L2,R3),CUA+L1    MOVE CUA TO SUM REC         @Z30RIVS 46300042
         MVC   L16(L24,R3),SNB00   MOVE 24 SENSE BYTES         @Z427VLS 46320042
TFAULT5  MVC   TFAULT7(L4),L4(R3)  INCREMENT                   @Z30RIVS 46350042
         A     R6,TFAULT7          NUM OF                      @Z30RIVS 46400042
         ST    R6,TFAULT7          OCCUR                       @Z30RIVS 46450042
         MVC   L4(L4,R3),TFAULT7   BY ONE                      @Z30RIVS 46500042
         CLC   L8(L4,R3),DAY       IS SUM DAY LATER RECDAY     @Z30RIVS 46550042
         BH    RETURN1             SUM DAY HIGH RETURN         @Z30RIVS 46600042
         CLC   L8(L4,R3),DAY       IS SUMDAY EQ RECDAY         @Z30RIVS 46650042
         BE    TFAULT6             GO TEST TIME DAY EQ         @Z30RIVS 46700042
         MVC   L8(L8,R3),DAY       MOVE IN NEW DAY/TIME        @Z30RIVS 46750042
         MVC   L16(L24,R3),SNB00   MOVE 24 SENSE BYTES         @Z427VLS 46770042
         B     RETURN1             REC UPDATED                 @Z30RIVS 46800042
TFAULT6  CLC   L12(L4,R3),HOUR     TEST SUM DAY/REC DAY        @Z30RIVS 46850042
         BNL   RETURN1             SUM REC HIGH OR EQ          @Z30RIVS 46900042
         MVC   L12(L4,R3),HOUR     MOVE IN NEW TIME TO SUM     @Z30RIVS 46950042
         MVC   L16(L24,R3),SNB00   MOVE 24 SENSE BYTES         @Z427VLS 46970042
**                                                             @Z30RIVS 47000042
RETURN1  LM    R5,R8,XSAVE1        RESTORE REGS                @Z30RIVS 47050042
         BR    R14                                             @Z30RIVS 47100042
**                                                             @Z30RIVS 47150042
         SPACE 1                                               @Z30RIVS 47200042
ENTRIES  DS    0F                                              @Z30RIVS 47250042
         SPECIAL RECTST0,00000000,SPACE=0                      @Z30RIVS 47300042
         SPECIAL XDATE1,00000000,SPACE=4 FROM TO DAY YEAR      @Z30RIVS 47350042
         SPECIAL ISTPER,00000000,SPACE=3 IS THIS A TPER REC    @Z30RIVS 47400042
         SPECIAL ISLOG,00000000,SPACE=3                        @Z30RIVS 47450042
         SUM   SNB02               ADD TO BUS OUT PARITY       @Z30RIVS 47500042
         SPECIAL EQUIP,00000000,SPACE=4 GO CHECK FOR           @Z30RIVS 47550042
**                                               EQUIPMENT CHECK IF ON  47600042
**                                               IS IT CONTROL UNIT     47650042
**                                                      PERMANENT OR    47700042
**                                                      TEMPORARY       47750042
**                                               OR IS IT DRIVE         47800042
**                                                      PERMANENT OR    47850042
**                                                      TEMPORARY       47900042
**                                               AND ADD TO COUNTERS    47950042
         SPECIAL DATACKP,00000000,SPACE=1 GO ADD TO DATA CHK PRM        48000042
         SUM   SNB05               ADD TO OVERRN COUNTER       @Z30RIVS 48050042
         SUM   SNB11               ADD TO INV TRK FMT CNT      @Z30RIVS 48100042
ENDLOG   EQU   *                                               @Z30RIVS 48150042
         SPECIAL RESTOR,00000000,SPACE=0                       @Z30RIVS 48200042
         SPECIAL TFAULT0,0,SPACE=20 SUM FOR SYMPTOM            @Z427VLS 48250042
         DC    XL1'FF'                                         @Z30RIVS 48300042
         DS    0H                                              @Z30RIVS 48350042
DOVOL    EQU   *                                               @Z30RIVS 48400042
         SPECIAL TVOLID,00000000,SPACE=14 LOOK FOR CORRECT     @Z40RIVS 48450042
         SPECIAL RESTOR,00000000,SPACE=0                       @Z30RIVS 48500042
         DC    XL1'FF'             VOL ID AND ADD T            @Z30RIVS 48550042
**                        APPROPRIATE COUNTERS                 @Z30RIVS 48600042
PEDIT    DS    0F                                              @Z30RIVS 48650042
**                                                             @Z30RIVS 48700042
&DSECT   SETC  'T3350'                                         @Z30RIVS 48750042
&CSECT   SETC  'PEDIT'                                         @Z30RIVS 48800042
         USING *,R9                                            @Z30RIVS 48850042
         USING T3350,R2                                        @Z30RIVS 48900042
         DC    A(PENTRY)                                       @Z30RIVS 48950042
         DC    C'IFCS3350'                                     @Z30RIVS 49000042
YR9PTR   DS    F                                               @Z30RIVS 49050042
YLABEL   DS    F                                               @Z30RIVS 49100042
         EJECT                                                 @Z30RIVS 49150042
*********************************************************************** 49200042
**                                                                    * 49250042
**       THE FOLLOWING DSECT DESCRIBES COUNTERS USED TO TOTAL         * 49300042
**       INCIDENTS PERTAINING TO ANY ONE PHYSICAL ADDRESS.            * 49350042
**       INDIVIDUAL ENTRIES ARE MADE FOR UP TO 20 VOLUME LABELS       * 49400042
**       AFTER 20,THE REMAINING ARE COMPILED IN THE 21ST ENTRY.       * 49450042
**       ALSO, IN THE 21ST ENTRY THERE ARE COUNTERS FOR TWO AND       * 49500042
**       FOUR CHANNEL SWITCHES IF A HEX'80' IS FOUND IN BYTE 18       * 49550042
**       OF THE INPUT RECORD,COUNTS ARE MADE FOR CHANNEL 'C' AND 'D'. * 49600042
**       IF A HEX'00' IS FOUND,COUNTS ARE KEPT FOR CHNL 'A' AND 'B'.  * 49650042
**                                                                    * 49700042
*********************************************************************** 49750042
T3350    DSECT                                                 @Z30RIVS 49800042
         DS    3H                                              @Z30RIVS 49850042
         DSGEN (YDUMA,16),(YNOREC,16)                          @Z30RIVS 49900042
         DSGEN (YTYPE,8),(YCHAN,8),(YCUA,24),(YSER,24)         @Z30RIVS 49950042
         DSGEN (YCPU,16),(YSMSW,16)                            @Z30RIVS 50000042
         DSGEN (TDAY1,32),(TDAY2,32)                           @Z30RIVS 50050042
T3350A   DSGEN (TSTAT,16),(TYPDEV,32),(TDACHKC,16)             @Z40RIVS 50100042
         DSGEN (TDACHKR,16),(TSKCHK,16)                        @Z30RIVS 50150042
         DSGEN (TBUSOPA,16),(TEQCNT,16)                        @Z30RIVS 50200042
         DSGEN (TEQCNP,16),(TEQDRT,16)                         @Z30RIVS 50250042
         DSGEN (TEQDRP,16),(TDATCHP,16)                        @Z30RIVS 50300042
         DSGEN (TOVERRN,16),(TINVTRKF,16),(TCUA,16)            @Z30RIVS 50350042
         DSGEN (TSEEK,16)                                      @Z30RIVS 50400042
         DSGEN (SUMREC,256,0,15)                               @Z427VLS 50450042
**                                                             @Z30RIVS 51250042
**       SUM COUNTERS FOR VOLID SUMMARY                        @Z30RIVS 51300042
**                                                             @Z30RIVS 51350042
T3350B   DSGEN (TVOLID1,48),(TSEEK1,32)                        @Z40RIVS 51400042
         DSGEN (TSEEKER1,16),(TBTRDO1,16)                      @Z30RIVS 51450042
         DSGEN (TBYTRD1,32),(TUNCRD1,32)                       @Z30RIVS 51500042
         DSGEN (TCORRD1,32),(TVCUA,16)                         @Z30RIVS 51550042
         DSGEN (TVOLID,224,2,51)                               @Z427VLS 51600042
         DSGEN (TOCACA,16)         CNTR FOR 'A' CMD            @Z30RIVS 54100042
         DSGEN (TOCADA,16),(TOCBCA,16) 'A' DATA AND CHNL 'B' CMD        54150042
         DSGEN (TOCBDA,16),(TOCCCA,16) 'B' DATA AND CHNL 'C' CMD        54200042
         DSGEN (TOCCDA,16),(TOCDCA,16) 'C' DATA AND CHNL 'D' CMD        54250042
         DSGEN (TOCDDA,16)         CNTR FOR 'D' DATA           @Z30RIVS 54300042
         SPACE 1                                               @Z30RIVS 54350042
**                                                             @Z30RIVS 54400042
**       SUM COUNTERS FOR FAULT SYMPTOM SUMMARY                @Z30RIVS 54450042
**                                                             @Z30RIVS 54500042
FLTSYM0  DSGEN (SYMCD,16),(SYMCUA,16)                          @Z30RIVS 54550042
         DSGEN (SYMOCR,32)                                     @Z30RIVS 54600042
         DSGEN (SYMDAY,32),(SYMHR,32)                          @Z30RIVS 54650042
         DSGEN (SYMSNS0,48),(SYMSNS1,48),(SYMSNS2,48),(SYMSNS3,48)      54670042
T3350C   DSGEN (FLTSYM,320,1,50)                               @Z427VLS 54700042
**                                                             @Z30RIVS 57200042
**     THE FOLLOWING EQUATES ARE  FOR DISPLACEMENTS FROM THE FIRST      57250042
**             VOL SER COUNTERS TO THE CHANNEL OVERRUN COUNTERS         57300042
**                                                             @Z30RIVS 57350042
ABCNTR   EQU   TOCACA-TVOLID1      DIS TO A/B COUNTERS         @Z30RIVS 57400042
CDCNTR   EQU   TOCCCA-TVOLID1      DIS TO C/D COUNTERS         @Z30RIVS 57450042
         SPACE 1                                               @Z30RIVS 57500042
IFCS3350 CSECT                                                 @Z30RIVS 57550042
XR9PTR   DC    F'0'                                            @Z30RIVS 57600042
XLABELP  DC    F'0'                                            @Z30RIVS 57650042
**                                                             @Z30RIVS 57700042
**                                                             @Z30RIVS 57750042
**       RESTORE REGISTERS USED BY ROUTINES IN THIS MODULE     @Z30RIVS 57800042
**                                                             @Z30RIVS 57850042
RETURN   LM    R5,R8,XSAVE         RESTORE REGS                @Z30RIVS 57900042
**                                                             @Z40RIVS 57950042
**       NO OP RETURN                                          @Z40RIVS 58000042
**                                                             @Z40RIVS 58050042
SKIPPER  BR    R14                                             @Z40RIVS 58100042
         SPACE 1                                               @Z30RIVS 58150042
MOVDEV   STM   R5,R8,XSAVE         SAVE REGS                   @Z30RIVS 58200042
         LA    R5,DEVTABLE         LOAD ADDR OF DEVICE TAB     @Z30RIVS 58250042
         LA    R6,L1               LOAD # OF POSSIBLE DEV      @Z30RIVS 58300042
         TM    L0(R4),H90          DO THE COUNTS REPRESENT     @Z30RIVS 58350042
**                                       TPER RECORDS          @Z30RIVS 58400042
         BO    TDEVCHK             YES - BR TO FIND DEV TYP    @Z30RIVS 58450042
         SPACE 1                                               @Z30RIVS 58500042
ODEVCHK  CLC   L1(L2,R4),L0(R5)    IS DEV SUPPORTED            @Z30RIVS 58550042
         BE    DEVFND              YES - BR TO MOVE DEV TYP    @Z30RIVS 58600042
         LA    R5,L10(R5)          BUMP PTR TO NXT TYP         @Z30RIVS 58650042
         BCT   R6,ODEVCHK          BR TO CHECK NXT TYP         @Z30RIVS 58700042
         B     MOVEUNKN            BR - DEVICE IS UNKNOWN      @Z30RIVS 58750042
         SPACE 1                                               @Z30RIVS 58800042
TDEVCHK  CLC   L1(L1,R4),L2(R5)    IS DEV SUPPORTED            @Z30RIVS 58850042
         BE    DEVFND              YES - BR TO MOVE DEV TYP    @Z30RIVS 58900042
         LA    R5,L10(R5)          BUMP PTR TO NXT TYP         @Z30RIVS 58950042
         BCT   R6,TDEVCHK          BR TO CHK NXT RECORD ID     @Z30RIVS 59000042
**                                                             @Z30RIVS 59050042
         SPACE 1                                               @Z30RIVS 59100042
**       DEVICE IS NOT SUPPORTED MOVE 'UNKNOWN' TO PRINT LINE  @Z30RIVS 59150042
**                                                             @Z30RIVS 59200042
MOVEUNKN MVC   L8(L7,R3),UNKNOWN   MOVE 'UNKNOWN' TO PRINT     @Z30RIVS 59250042
         B     RETURN              RETURN                      @Z30RIVS 59300042
         SPACE 1                                               @Z30RIVS 59350042
DEVFND   MVC   L8(L7,R3),L3(R5)    MOVE DEVICE TYPE TO         @Z30RIVS 59400042
**                   PRINT LINE                                @Z30RIVS 59450042
         B     RETURN              RETURN                      @Z30RIVS 59500042
         SPACE 2                                               @Z30RIVS 59550042
**                                                             @Z30RIVS 59600042
**       CHECK FOR CPU AND SERIAL NUMBER                       @Z30RIVS 59650042
**                                                             @Z30RIVS 59700042
SETCPUNO STM   R5,R8,XSAVE         SAVE REGS                   @Z30RIVS 59750042
         SR    R5,R5               CLEAR REG 5                 @Z30RIVS 59800042
         IC    R5,L0(R4)           PICK UP MODEL NUMBER        @Z30RIVS 59850042
         SLL   R5,L8               INTO                        @Z30RIVS 59900042
         IC    R5,L1(R4)           R5                          @Z30RIVS 59950042
         LTR   R5,R5               TEST FOR ZERO               @Z30RIVS 60000042
         BNZ   RETURN              RETURN                      @Z30RIVS 60050042
         LR    R5,R3               PUT LINE ADDRESS IN R5      @Z30RIVS 60100042
         LA    R6,L46              OFFSET IN REG 6             @Z30RIVS 60150042
         SR    R5,R6               SUBTRACT OFFSET FROM POINTER@Z30RIVS 60200042
         MVC   0(L6,R5),SHARED       SAY MODEL SHARED          @XA20374 60250001
         B     RETURN              RETURN                      @Z30RIVS 60350042
**                                                             @Z30RIVS 60400042
**       SET THE DATE READY FOR PRINT                          @Z30RIVS 60450042
**                                                             @Z30RIVS 60500042
SETDATE  UNPK  XSAVE(L8),L1(L3,R4) UNPACK THE DATE             @Z30RIVS 60550042
         MVC   L0(L3,R3),XSAVE+L5  MOVE DAY                    @Z30RIVS 60600042
         MVC   L6(L2,R3),XSAVE+L3  MOVE YEAR                   @Z30RIVS 60650042
         BR    R14                                             @Z30RIVS 60700042
**                                                             @Z30RIVS 60750042
**       CONVERT COUNTERS FROM HEX TO DECIMAL READY FOR PRINT  @Z30RIVS 60800042
**                                                             @Z30RIVS 60850042
CONV1    STM   R5,R8,XSAVE         SAVE REGISTERS              @Z30RIVS 60900042
         XC    READYP(L8),READYP   CLEAR UNPACK BUFFER         @Z30RIVS 60950042
         SR    R6,R6               ZERO REG                    @Z30RIVS 61000042
         LH    R6,L0(R4)           LOAD DATA TO BE CONVERTED   @Z30RIVS 61050042
CONV2    CVD   R6,READYP           CONVERT ERRORCNTRTO DECI    @Z30RIVS 61100042
         UNPK  READYP(L5),READYP+L5(L3) UNPACK DECI COUNT      @Z30RIVS 61150042
         OI    READYP+L4,CLRSGN    CLEAR SIGN                  @Z30RIVS 61200042
         MVC   L0(L4,R3),READYP+L1 MOVE COUNTER READY TO PRINT @Z30RIVS 61250042
         B     RETURN                                          @Z30RIVS 61300042
PRVOLS   STM   R4,R8,XSAVEV                                    @Z30RIVS 61350042
         L     R4,CNTDN2           LOAD ADDR OF NEXT VOLREC    @Z30RIVS 61400042
         LR    R5,R3                                           @Z30RIVS 61450042
         CLC   L0(L6,R4),ZEROS                                 @Z30RIVS 61500042
         BE    NORETVOL                                        @Z30RIVS 61550042
**                                                             @Z30RIVS 61600042
         MVC   L0(L6,R5),L0(R4)    MOVE INTO PRINT VOLID       @Z30RIVS 61650042
         LA    R5,L13(R5)          INCREMENT PRNT LINE PTR     @Z30RIVS 61700042
         IC    R6,L27(R4)          PICK UP DEVICE ADDR         @Z30RIVS 61750042
         SLL   R6,L28              SHIFT OUT GARBAGE           @Z30RIVS 61800042
         SRL   R6,L28              SHIFT UNIT TO LOW ORDER     @Z30RIVS 61850042
         LA    R6,CHARS(R6)        PICK UP ADDRESS OF CHAR     @Z30RIVS 61900042
         MVC   L0(L2,R5),CUANR+L1  GET CHAN AND CU             @Z30RIVS 61950042
         MVC   L2(L1,R5),L0(R6)    GET UNIT NUMBER             @Z30RIVS 62000042
         LA    R4,L6(R4)           POINT TO TOTAL SEEKS        @Z30RIVS 62050042
         LA    R5,L13(R5)                                      @Z30RIVS 62100042
         ICM   R6,L15,L0(R4)       LOAD SEEKS                  @Z40RIVS 62150042
         SRL   R6,L10              REDUCE TO 'X1000'           @Z30RIVS 62200042
         L     R7,TOTSKS           LOAD TOTAL SEEKS            @Z30RIVS 62250042
         AR    R7,R6               ADD THIS CNT TO TOTAL       @Z30RIVS 62300042
         ST    R7,TOTSKS           SAVE TOTAL                  @Z30RIVS 62350042
         BAL   R8,CONVH3           PUT SEEKS IN PRINT LINE     @Z30RIVS 62400042
**                                                             @Z30RIVS 62450042
         LA    R4,L4(R4)           BUMP CNTR PTR               @Z30RIVS 62500042
         SPACE 1                                               @Z30RIVS 62550042
         LH    R6,L0(R4)           LOAD SEEK ERRS              @Z30RIVS 62600042
         LH    R7,TOTSKERS         LOAD TOTAL SEEK ERRS        @Z30RIVS 62650042
         AR    R7,R6               ADD THIS VOL TO TOTAL       @Z30RIVS 62700042
         STH   R7,TOTSKERS         SAVE NEW TOTAL              @Z30RIVS 62750042
         BAL   R8,CONVH2           PUT SEEK ERRS IN PRINT      @Z30RIVS 62800042
**                                                             @Z30RIVS 62850042
         LA    R4,L2(R4)           BUMP CNTR PTR               @Z30RIVS 62900042
         SPACE 1                                               @Z30RIVS 62950042
         ICM   R6,L15,L2(R4)       LOAD BYT RD                 @Z40RIVS 63000042
         L     R7,TOTMEGRD         LOAD TOTAL                  @Z30RIVS 63050042
         AR    R7,R6               ADD THIS VOL TO TOTAL       @Z30RIVS 63100042
         ST    R7,TOTMEGRD         SAVE NEW TOTAL              @Z30RIVS 63150042
         ST    R6,SAVMEG           SAVE MEG READ               @Z30RIVS 63200042
         BAL   R8,CONVH2           PUT MEG READ IN PRINT       @Z30RIVS 63250042
**                                                             @Z30RIVS 63300042
         LA    R4,L6(R4)           BUMP CNTR PTR               @Z30RIVS 63350042
         SPACE 1                                               @Z30RIVS 63400042
         ICM   R6,L15,L0(R4)       LOAD RETRY READ ERRS        @Z40RIVS 63450042
         BAL   R8,CONVH2           PUT COUNT IN PRINT          @Z30RIVS 63500042
         LTR   R6,R6               ANY COUNT ??                @Z30RIVS 63550042
         BNZ   GETRETRD            YES - BR                    @Z30RIVS 63600042
**                                                             @Z30RIVS 63650042
         MVC   L13(L5,R5),NA       PUT N/A FOR MEG RD/R.ERR    @Z30RIVS 63700042
         LA    R5,L13(R5)          BUMP PRINT POS PTR          @Z30RIVS 63750042
         B     CHKCORRD            BR TO PROCESS CORR READ     @Z30RIVS 63800042
**                                                             @Z30RIVS 63850042
GETRETRD L     R7,TOTRETRD         LOAD TOTAL RETRY READ ER    @Z30RIVS 63900042
         AR    R7,R6               ADD THIS VOL CNT TO TOT     @Z30RIVS 63950042
         ST    R7,TOTRETRD         SAVE TOTAL                  @Z30RIVS 64000042
**                                                             @Z30RIVS 64050042
         L     R7,SAVMEG           LOAD MEG READ               @Z30RIVS 64100042
         LR    R8,R6               LOAD RETRY READ ERRS        @Z30RIVS 64150042
         SR    R6,R6               CLEAR REG                   @Z30RIVS 64200042
         DR    R6,R8               DIVIDE MEG READ/RET RD      @Z30RIVS 64250042
         LR    R6,R7               LOAD QUOTIENT               @Z30RIVS 64300042
         BAL   R8,CONVH2           PUT RESULT IN PRINT         @Z30RIVS 64350042
         SPACE 1                                               @Z30RIVS 64400042
CHKCORRD LA    R4,L4(R4)           BUMP CNTR PTR               @Z30RIVS 64450042
         ICM   R6,L15,L0(R4)       LOAD CORR RD ERRS           @Z40RIVS 64500042
         BAL   R8,CONVH2           COUNT TO PRINT              @Z30RIVS 64550042
         LTR   R6,R6               WAS COUNT ZERO ?            @Z30RIVS 64600042
         BNZ   GETCORRD            NO - BR TO HANDLE           @Z30RIVS 64650042
**                                                             @Z30RIVS 64700042
         MVC   L13(L5,R5),NA       MOVE N/A FOR MEG/CORR RD    @Z30RIVS 64750042
         B     RETVOL              BR TO RETURN                @Z30RIVS 64800042
**                                                             @Z30RIVS 64850042
GETCORRD L     R7,TOTCORRD         LOAD TOTAL SO FAR           @Z30RIVS 64900042
         AR    R7,R6               ADD THIS VOL TO TOTAL       @Z30RIVS 64950042
         ST    R7,TOTCORRD         SAVE NEW TOTAL              @Z30RIVS 65000042
**                                                             @Z30RIVS 65050042
         L     R7,SAVMEG           LOAD MEG READ               @Z30RIVS 65100042
         LR    R8,R6               LOAD CORR READ ERRS         @Z30RIVS 65150042
         SR    R6,R6               CLEAR REG                   @Z30RIVS 65200042
         DR    R6,R8               DIVIDE MEG READ/COR RD      @Z30RIVS 65250042
         LR    R6,R7               LOAD QUOTIENT               @Z30RIVS 65300042
         BAL   R8,CONVH2           PUT IN PRINT LINE           @Z30RIVS 65350042
         B     RETVOL              BR TO RETURN                @Z30RIVS 65400042
         SPACE 2                                               @Z30RIVS 65450042
**                                                             @Z30RIVS 65500042
CONVH2   LA    R5,L13(R5)          BUMP PRINT POS PTR          @Z30RIVS 65550042
CONVH3   XC    READYP(L8),READYP                               @Z30RIVS 65600042
         CVD   R6,READYP                                       @Z30RIVS 65650042
         UNPK  READYP(L5),READYP+L5(L3)                        @Z30RIVS 65700042
         OI    READYP+L4,CLRSGN                                @Z30RIVS 65750042
         MVC   L0(L5,R5),READYP                                @Z30RIVS 65800042
         BR    R8                                              @Z30RIVS 65850042
**                                                             @Z30RIVS 65900042
**                                                             @Z30RIVS 65950042
         EJECT                                                 @Z30RIVS 66000042
**                                                             @Z30RIVS 66050042
**       THE FOLLOWING INITIALIZES THE TOTALS FOR THE VOLID SUMMARY     66100042
**                                                             @Z30RIVS 66150042
GETTOTS  STM   R4,R8,XSAVEV        SAVE REGS                   @Z30RIVS 66200042
         LR    R5,R3               LOAD PRINT POS PTR          @Z30RIVS 66250042
         SPACE 1                                               @Z30RIVS 66300042
         L     R6,TOTSKS           LOAD TOTAL SEEKS            @Z30RIVS 66350042
         BAL   R8,CONVH3           PUT IN PRINT LINE           @Z30RIVS 66400042
         SPACE 1                                               @Z30RIVS 66450042
         LH    R6,TOTSKERS         LOAD TOTAL SEEK ERRORS      @Z30RIVS 66500042
         BAL   R8,CONVH2           PUT IN PRINT LINE           @Z30RIVS 66550042
         SPACE 1                                               @Z30RIVS 66600042
         L     R6,TOTMEGRD         LOAD TOTAL MEG. READ        @Z30RIVS 66650042
         BAL   R8,CONVH2           PUT IN PRINT LINE           @Z30RIVS 66700042
         SPACE 1                                               @Z30RIVS 66750042
         L     R6,TOTRETRD         LOAD TOTAL RETRY READ ERS   @Z30RIVS 66800042
         BAL   R8,CONVH2           PUT IN PRINT LINE           @Z30RIVS 66850042
         SPACE 1                                               @Z30RIVS 66900042
         LTR   R6,R6               WERE THERE RETRY RD ERRS    @Z30RIVS 66950042
         BZ    NORETRD             NO - BR                     @Z30RIVS 67000042
         L     R7,TOTMEGRD         LOAD TOTAL MEG READ         @Z30RIVS 67050042
         LR    R8,R6               LOAD RETRY READ ERRS        @Z30RIVS 67100042
         SR    R6,R6               CLEAR REG                   @Z30RIVS 67150042
         DR    R6,R8               DIVIDE MEG RD/RET RD        @Z30RIVS 67200042
         LR    R6,R7               LOAD QUOTIENT               @Z30RIVS 67250042
         BAL   R8,CONVH2           PUT IN PRINT LINE           @Z30RIVS 67300042
         B     GETCRTOT            BR TO CONTINUE              @Z30RIVS 67350042
**                                                             @Z30RIVS 67400042
NORETRD  LA    R5,L13(R5)          BUMP PRINT POS PTR          @Z30RIVS 67450042
         MVC   L0(L5,R5),NA        MOVE N/A TO PRINT LINE      @Z30RIVS 67500042
         SPACE 1                                               @Z30RIVS 67550042
GETCRTOT L     R6,TOTCORRD         LOAD CORR READ ERR TOTAL    @Z30RIVS 67600042
         BAL   R8,CONVH2           PUT IN PRINT LINE           @Z30RIVS 67650042
         SPACE 1                                               @Z30RIVS 67700042
         L     R8,TOTCORRD         LOAD CORR READ TOTAL        @Z30RIVS 67750042
         LTR   R8,R8               IS IT ZERO ?                @Z30RIVS 67800042
         BZ    NOCORRD             YES - BR                    @Z30RIVS 67850042
**                                                             @Z30RIVS 67900042
         L     R7,TOTMEGRD         LOAD MEG READ TOTAL         @Z30RIVS 67950042
         SR    R6,R6               CLEAR REG                   @Z30RIVS 68000042
         DR    R6,R8               DIVIDE MEG RD/CORR RD       @Z30RIVS 68050042
         LR    R6,R7               LOAD QUOTIENT               @Z30RIVS 68100042
         BAL   R8,CONVH2           PUT IN PRINT LINE           @Z30RIVS 68150042
         B     CLRTOTS             BR TO CONTINUE              @Z30RIVS 68200042
**                                                             @Z30RIVS 68250042
NOCORRD  MVC   L13(L5,R5),NA       MOVE N/A TO PRINT           @Z30RIVS 68300042
         SPACE 1                                               @Z30RIVS 68350042
CLRTOTS  XC    TOTSKS(TLEN),TOTSKS CLEAR ALL TOTAL AREAS       @Z30RIVS 68400042
         B     RETVOL              BR TO RETURN                @Z30RIVS 68450042
         EJECT                                                 @Z30RIVS 68500042
**                                                             @Z30RIVS 68550042
**                                                             @Z30RIVS 68600042
GETABCDD STM   R4,R8,XSAVEV        SAVE REGS                   @Z30RIVS 68650042
         LR    R5,R3                                           @Z30RIVS 68700042
         LA    R7,L4               NO. OF POSSIBLE CHANNELS    @Z30RIVS 68750042
         SR    R6,R6                                                    68770042
SETCHDTA ICM   R6,L3,L0(R4)        LOAD NO OF DATA OVER.       @Z40RIVS 68800042
         BAL   R8,CONVH3                                       @Z30RIVS 68850042
**                                                             @Z30RIVS 68900042
         LA    R4,L4(R4)           BUMP PNTR TO NEXT DTA CTR   @Z30RIVS 68950042
         LA    R5,L29(R5)          BUMP PNTR TO NEXT PRNT POS  @Z30RIVS 69000042
         BCT   R7,SETCHDTA         BRANCH IF THERE ARE MORE    @Z30RIVS 69050042
**                                                             @Z30RIVS 69100042
RETVOL   LM    R4,R8,XSAVEV                                    @Z40RIVS 69150042
         BR    R14                                             @Z40RIVS 69200042
**                                                             @Z30RIVS 69250042
NORETVOL LM    R4,R8,XSAVEV                                    @Z30RIVS 69300042
         SR    R15,R15                                         @Z30RIVS 69350042
         BR    R14                                             @Z30RIVS 69400042
**                                                             @Z30RIVS 69450042
**       ROUTINE TO SAVE CHANEL AND CONTROL UNIT FOR SUBSYSTEM @Z30RIVS 69500042
**                                                             @Z30RIVS 69550042
CUAN0    STM   R5,R8,XSAVE         SAVE WORK REGS              @Z30RIVS 69600042
         LA    R5,L10              LOAD DECREMENT FOR R3       @Z30RIVS 69650042
         SR    R3,R5               PNT TO START OF PRNT LI     @Z30RIVS 69700042
         MVC   CUANR+L1(L3),L1(R3) MOVE CHANEL AND CU          @Z30RIVS 69750042
         SR    R15,R15             CLR FOR NO PRINT            @Z30RIVS 69800042
         B     RETURN              RETURN                      @Z30RIVS 69850042
**                                                             @Z30RIVS 69900042
**       SORT FOR VOLID TO PUT HIGHEST ERROR RATE TO PRINT FIRST        69950042
**                                                             @Z30RIVS 70000042
SORTV0   STM   R5,R8,XSAVE         SAVE WORK REG               @Z30RIVS 70050042
         ST    R4,SRTSAV           SAVE REG 4                  @Z30RIVS 70100042
         ST    R4,CNTDN2           SAVE VOL PNTR FOR PRT       @Z30RIVS 70150042
SORTV1   SR    R8,R8               CLR REG 8 FOR SWITCH        @Z30RIVS 70200042
         L     R4,SRTSAV           SET 4 TO START OF SUM       @Z30RIVS 70250042
         LA    R5,L28(R4)          SET 5 TO NEXT RECORD        @XM09337 70300042
         LA    R7,L49              SET 7 TO NO.REC-1           @Z30RIVS 70350042
SORTV2   CLC   L0(L6,R5),ZEROS     IS THERE A VOLID            @Z30RIVS 70400042
         BE    SORTV4              NO BR TO TEST SW            @Z30RIVS 70450042
         CLC   L12(L2,R4),L12(R5)  TEST FOR HIGH COUNT         @Z30RIVS 70500042
         BNH   SORTV3              BRCH IF HIGH REC FIRST      @Z30RIVS 70550042
         LA    R8,L15              SET MOVE SWITCH             @Z30RIVS 70600042
         XC    L0(L28,R4),L0(R5)   RECORD                      @XM09337 70650042
         XC    L0(L28,R5),L0(R4)   SWAP                        @XM09337 70700042
         XC    L0(L28,R4),L0(R5)   FOR SORT                    @XM09337 70750042
SORTV3   LA    R4,L28(R4)          POINT TO NEXT RECORD        @XM09337 70800042
         LA    R5,L28(R5)          POINT TO NEXT RECORD+1      @XM09337 70850042
         BCT   R7,SORTV2           MORE TO TEST                @Z30RIVS 70900042
SORTV4   LTR   R8,R8               TEST PASS SWITCH            @Z30RIVS 70950042
         BZ    RETURN              ALL REC TESTED/MOVED        @Z30RIVS 71000042
         B     SORTV1              CONTINUE TO TEST/MOVE       @Z30RIVS 71050042
**                                                             @Z30RIVS 71100042
**       ROUTINE TO PRINT 50 VOLID SUM ENTRIES                 @Z30RIVS 71150042
**                                                             @Z30RIVS 71200042
CNTDN0   STM   R5,R8,XSAVE         SAVE THE REGS               @Z30RIVS 71250042
         SR    R5,R5               CLEAR REG                   @Z30RIVS 71300042
         L     R5,CNTDN3           LOAD WITH 50                @Z30RIVS 71350042
         BCT   R5,CNTDN1           BRANCH FOR 50               @Z30RIVS 71400042
CNTDN5   SR    R15,R15             CLEAR FOR NO PRINT          @Z30RIVS 71450042
         B     RETURN              RETURN                      @Z30RIVS 71500042
CNTDN1   ST    R5,CNTDN3           SAVE R 5                    @Z30RIVS 71550042
         L     R5,CNTDN2           GET CNTDN VALUE             @Z30RIVS 71600042
         LA    R5,L28(R5)          INCREMENT BY 28                      71650042
         CLC   L0(L6,R5),ZEROS     TESTFOR VOLID EQ ZERO       @Z30RIVS 71700042
         BE    CNTDN5              BRANCH NONE TO PRNT         @Z30RIVS 71750042
         ST    R5,CNTDN2           PUT IT BACK                 @Z30RIVS 71800042
         LA    R5,SUMTA3-L4        GET LINE ADDRESS            @Z30RIVS 71850042
         L     R6,ASUMTA4          GET LABEL ADDRESS           @Z30RIVS 71900042
         STM   R5,R6,YR9PTR        MAKE THEM CURRENT           @Z30RIVS 71950042
         B     RETURN              RETURN                      @Z30RIVS 72000042
         SPACE 1                                                        72003042
*                                                                       72006042
**       ROUTINE TO DETERMINE IF NECESSARY TO EDIT FLTYSYM              72009042
*                                                                       72012042
FLTTST0  STM   R5,R8,XSAVE         SAVE WORK REGS                       72015042
         LA    R4,L40(R4)          INCREMENT TO FIRST RECORD   @Z427VLS 72018042
         CLC   L0(L4,R4),ZEROS     ARE SYM AND CUA ZERO                 72021042
         BNE   FLTTST1             NO, CONTINUE                         72024042
         LA    R7,SUMTAC-4         YES, PICK UP NEW LINE                72027042
         LA    R8,SUMTAD-1         AND LABEL ADDRESSES                  72030042
         STM   R7,R8,YR9PTR        TO START FROM                        72033042
FLTTST1  B     RETURN              RETURN                               72036042
         SPACE 1                                                        72039042
         SPACE 1                                               @Z30RIVS 72050042
**                                                             @Z30RIVS 72100042
**       ROUTINE FOR SORTING THE FAULT SYMPTOM ENTERIES        @Z30RIVS 72150042
**                                                             @Z30RIVS 72200042
FLTSRT0  STM   R5,R8,XSAVE         SAVE WORK REGS              @Z30RIVS 72250042
         ST    R4,FLTSRT8          SAVE PNTR TO EDIT AREA      @Z30RIVS 72300042
         SR    R6,R6               CLEAR FOR SW                @Z30RIVS 72350042
FLTSRT1  LA    R4,L40(R4)          INCREMENT TO FIRST REC      @Z427VLS 72400042
         SR    R7,R7               CLR MOVE SWITCH             @Z30RIVS 72450042
         LA    R8,L50              SET R8 TO NUM REC           @Z30RIVS 72500042
FLTSRT2  CLC   L42(L2,R4),ZEROS    IS DEV ADDR ZERO            @Z427VLS 72550042
         BE    FLTSRT6             END REC AREA                @Z30RIVS 72600042
FLTSRT3  CLC   L2(L2,R4),L42(R4)   COMP CUA/SYM                @Z427VLS 72650042
         BNH   FLTSRT4             BRCH IF ASCENDING ORDER     @Z30RIVS 72700042
         XC    L0(L40,R4),L40(R4)  SWAP RECORD                 @Z427VLS 72750042
         XC    L40(L40,R4),L0(R4)  PUT IN ASCENDING            @Z427VLS 72800042
         XC    L0(L40,R4),L40(R4)  ORDER                       @Z427VLS 72850042
         LA    R7,L15              TURN MOVE SWITCH ON         @Z30RIVS 72900042
FLTSRT4  LA    R4,L40(R4)          INCREMENT FOR NEXT TEST     @Z427VLS 72950042
         BCT   R8,FLTSRT2          GO MAX 50 PASSES            @Z30RIVS 73000042
FLTSRT6  LTR   R7,R7               MOVE SWITCH SET             @Z30RIVS 73050042
         BZ    FLTSRT7             GO TO END                   @Z30RIVS 73100042
         L     R4,FLTSRT8          RESET R4 TO START           @Z30RIVS 73150042
         B     FLTSRT1             GO CYCLE ONCE MORE          @Z30RIVS 73200042
FLTSRT7  L     R4,FLTSRT8          NO RESTORE R4               @Z30RIVS 73250042
         LTR   R6,R6               IS THIS FIRST SORT          @Z30RIVS 73300042
         BNZ   FLTSRT9             NO GO TO COMPLETION         @Z30RIVS 73350042
         LA    R6,L15              YES SET SORT SWITCH         @Z30RIVS 73400042
         NI    FLTSRT3+L3,HEXFD    ALTER CLC INSTR             @Z30RIVS 73450042
         NI    FLTSRT3+L5,HEXFD    FOR NEXT SORT               @XM09337 73470042
         B     FLTSRT1             SORT ON SYM CODE            @Z30RIVS 73500042
FLTSRT9  MVC   L0(L40,R4),L40(R4)  MOVE FIRST REC TO EDIT      @Z427VLS 73550042
         LA    R4,L40(R4)          INCR R4 BY REC LENGTH       @Z427VLS 73600042
         ST    R4,FLTMOV2          KEEP USE BY MOVE RTNE       @Z30RIVS 73650042
         LA    R6,L48              SET REG 6 TO NUM REC        @Z30RIVS 73700042
         ST    R6,FLTMOV6          KEEP USE BY MOVE RTNE       @Z30RIVS 73750042
         B     RETURN                                          @Z30RIVS 73800042
         SPACE 1                                               @Z30RIVS 73850042
**                                                             @Z30RIVS 73900042
**      ROUTINE TO MOVE NEXT REC FROM SUM AREA TO EDIT AREA TO PRINT    73950042
**                                                             @Z30RIVS 74000042
FLTMOV0  STM   R5,R8,XSAVE         SAVE WORK REG               @Z30RIVS 74050042
         L     R5,FLTMOV2          PICK UP PNTR LAST REC       @Z30RIVS 74100042
         LA    R5,L40(R5)          POINT TO NEW REC            @Z427VLS 74150042
         ST    R5,FLTMOV2          SAVE PNTR                   @Z30RIVS 74200042
         CLC   L2(L2,R5),ZEROS     IS REC EQ ZERO              @Z30RIVS 74250042
         BE    FLTMOV3             BRNCH PREPARE NEW EDIT      @Z30RIVS 74300042
FLTMOV1  MVC   L0(L40,R4),L0(R5)   MOVE NEW REC TO EDIT        @Z427VLS 74350042
         LA    R7,SUMTA7-L4        BACK UP LINE AND            @Z30RIVS 74400042
         L     R8,ASUMTA8          LABEL PNTR TO               @Z30RIVS 74450042
         STM   R7,R8,YR9PTR        PRINT NEXT REC              @Z30RIVS 74500042
         L     R6,FLTMOV6          SET R6 TO NUM REC LEFT      @Z30RIVS 74550042
         BCT   R6,FLTMOV7          REDUCE COUNT BY ONE         @Z30RIVS 74600042
         B     FLTMOV3             END FIRST SECTION           @Z30RIVS 74650042
FLTMOV7  ST    R6,FLTMOV6          SAVE NUM REC REMAIN         @Z30RIVS 74700042
         SR    R15,R15             CLR FOR NO PRINT            @Z30RIVS 74750042
FLTMOV3  B     RETURN              GO PRINT NEXT RECORD        @Z30RIVS 74800042
         EJECT                                                 @Z30RIVS 74850042
**                                                             @Z30RIVS 74900042
**       EDIT CYCLE TO PRINT 16 SUM COUNTERS                   @Z30RIVS 74950042
**                                                             @Z30RIVS 75000042
EDTFA0   STM   R5,R8,XSAVE         SAVE WORK REGS              @Z30RIVS 75050042
         L     R7,EDTFA4           GET COUNTER                 @Z30RIVS 75100042
EDTFA1   L     R5,EDTFA5           PICK UP LAST PRT            @Z30RIVS 75150042
         LA    R5,L32(R5)          INCREMENT TO NEXT           @XM09337 75200042
         ST    R5,EDTFA5           SAVE LAST REC PRT           @Z30RIVS 75250042
         OC    L28(L2,R5),L28(R5)  TEST CUA                    @Z30RIVS 75300042
         BNZ   EDTFA2              BRCH IF NO REC INFO         @Z30RIVS 75350042
         BCT   R7,EDTFA1           REDUCE REC CNTR             @Z30RIVS 75400042
         B     RETURN              RETURN                      @Z30RIVS 75450042
EDTFA2   BCT   R7,EDTFA3           REDUCE REC CNTR             @Z30RIVS 75500042
         B     RETURN              RETURN                      @Z30RIVS 75550042
EDTFA3   MVC   L0(L32,R4),L0(R5)   MOVE REC TO PRNT            @XM09337 75600042
         ST    R7,EDTFA4           SAVE REC NO                 @Z30RIVS 75650042
         LA    R7,SUMTA1-L4        LOAD LINE ADDR-4            @Z30RIVS 75700042
         L     R8,ASUMTA2          LOAD LABEL ADDR-1           @Z30RIVS 75750042
         STM   R7,R8,YR9PTR        STORE NEW PNTR              @Z30RIVS 75800042
         SR    R15,R15             CLEAR FOR NO PRNT           @Z30RIVS 75850042
         B     RETURN              RETURN                      @Z30RIVS 75900042
EDTFA6   STM   R5,R8,XSAVE         SAVE WORK REG               @Z30RIVS 75950042
         L     R7,EDTFA4           PICK UP NO. REC LEFT        @Z30RIVS 76000042
         LR    R5,R4               LOAD SUM AREA PNTR          @Z30RIVS 76050042
EDTFA7   LA    R5,L32(R5)          INCRM TO REC AREA           @XM09337 76100042
         ST    R5,EDTFA5           SAVE PNTR                   @Z30RIVS 76150042
         OC    L28(L2,R5),L28(R5)  TEST FOR CUA                @Z30RIVS 76200042
         BNZ   EDTFA8              GO MOVE REC                 @Z30RIVS 76250042
         BCT   R7,EDTFA7           NO CUA TEST NEXT REC        @Z30RIVS 76300042
         LA    R7,L1               NO REC SET R7 TO ONE        @Z30RIVS 76350042
         ST    R7,EDTFA4           STORE TO PRNT ZERO          @Z30RIVS 76400042
         ST    R4,EDTFA5           SET TO START OF SUM AREA    @Z30RIVS 76450042
         B     RETURN              NO REC                      @Z30RIVS 76500042
EDTFA8   ST    R7,EDTFA4           SET TO NO. REC LEFT         @Z30RIVS 76550042
         MVC   L0(L32,R4),L0(R5)   MOVE FIRST REC TO PRNT      @XM09337 76600042
         B     RETURN                                          @Z30RIVS 76650042
**                                                             @Z30RIVS 76700042
**       ROUTINES TO INCREMENT OR DECREMENT PRNT LINE PNTR     @Z30RIVS 76750042
**                                                             @Z30RIVS 76800042
REPNT4   BCTR  R3,R0               DECREMENT R3 BY 5           @XM09337 76820042
REPNT1   BCTR  R3,R0               DECREMENT BY ONE            @Z40RIVS 76850042
REPNT2   BCTR  R3,R0               DECREMENT BY ONE            @Z40RIVS 76900042
         BCTR  R3,R0               DECREMENT BY ONE            @Z40RIVS 76950042
REPNT0   BCTR  R3,R0               DECREMENT BY ONE            @Z40RIVS 77000042
         BR    R14                 RETURN                      @Z30RIVS 77050042
REPNT3   LA    R3,L15(R3)          INCR PRNT LINE PNTR +15     @Z30RIVS 77100042
         BR    R14                 RETURN                      @Z30RIVS 77150042
REPNT5   LA    R3,L7(R3)           INCREMENT LINE PNTR         @XM09337 77160042
         BR    R14                 RETURN                      @XM09337 77170042
**                                                             @Z30RIVS 77200042
**       ROUTINE TO MOVE DATE TO FAULT SYMPTOM PRINTLINE       @Z30RIVS 77250042
**                                                             @Z30RIVS 77300042
FLTSYDA  UNPK  XSAVE(L8),L1(L3,R4) UNPACK THE DATE             @Z30RIVS 77350042
         MVC   L0(L3,R3),XSAVE+L5  MOVE JULIAN DATE            @Z30RIVS 77400042
         MVI   L3(R3),SLASH        MOVE SEPARATOR              @Z30RIVS 77450042
         MVC   L4(L2,R3),XSAVE+L3  MOVE YEAR                   @Z30RIVS 77500042
         LA    R4,L4               LOAD R4 WITH 4              @Z427VLS 77550042
         SR    R3,R4               REDUCE PRINT LINE PNTR      @Z30RIVS 77600042
         BR    R14                 RETURN                      @Z30RIVS 77650042
**                                                             @Z30RIVS 77700042
**       ROUTINE TO PREPARE TO CONVERT OCCUR COUNT TO PRINTABLE@Z30RIVS 77750042
**       FORMAT AND BLANK LEADING ZERO ON DEVICE ADDRESS FAULT SUM      77800042
**                                                             @Z30RIVS 77850042
GETOCCUR STM   R5,R8,XSAVE         SAVE WORK REG               @Z30RIVS 77900042
         LA    R5,L20              BLANK OUT                   @Z30RIVS 77950042
         LR    R6,R3               LEADING ZERO                @Z30RIVS 78000042
         SR    R6,R5               ON DEVICE                   @Z30RIVS 78050042
         MVI   L0(R6),BLANK        ADDRESS                     @Z30RIVS 78100042
         MVC   READYP(L4),L0(R4)   MOVE CNT FIELD TO WORD      @Z30RIVS 78150042
         L     R6,READYP           MOVE CNT INTO REG 6         @Z30RIVS 78200042
         LR    R5,R3               SET PRINT LINE PNTR         @Z30RIVS 78250042
         BAL   R8,CONVH3           USE STANDARD ROUTINE        @Z30RIVS 78300042
         B     RETURN              RETURN                      @Z30RIVS 78350042
**                                                             @Z30RIVS 78400042
**       ROUTINE TO REFORMAT TIME IN FAULT SYMPTOM OUTPUT      @Z30RIVS 78450042
**                                                             @Z30RIVS 78500042
HREDIT0  STM   R5,R8,XSAVE         SAVE WORK REGS              @Z30RIVS 78550042
         LA    R5,L10              SET REG5 TO 10              @Z427VLS 78600042
         SR    R3,R5               DECR PRNT LINE PNTR         @Z30RIVS 78650042
         MVC   READYP(L6),L0(R3)   SAVE FORMATED OUTPUT        @Z30RIVS 78700042
         MVI   L0(R3),COLON        MOVE IN SEPERATOR CHAR      @Z30RIVS 78750042
         MVC   L1(L2,R3),READYP    MOVE MIN TO PRNT LINE       @Z30RIVS 78800042
         MVI   L3(R3),COLON        MOVE IN SEPERATOR CHAR      @Z30RIVS 78850042
         MVC   L4(L2,R3),READYP+L2 MOVE SEC TO PRNT LINE       @Z30RIVS 78900042
         MVI   L6(R3),COLON        MOVE IN SEPERATOR CHAR      @Z30RIVS 78950042
         MVC   L7(L2,R3),READYP+L4 MOVE THOU TO PRNT LINE      @Z30RIVS 79000042
         B     RETURN              RETURN                      @Z30RIVS 79050042
**                                                             @Z30RIVS 79100042
**       ROUTINE TO BLANK OUT LEADING ZERO ON DEVICE ADDR      @Z30RIVS 79150042
**                                                             @Z30RIVS 79200042
NOPRNTT  STM   R5,R8,XSAVE         SAVE WORK REGS              @Z30RIVS 79250042
         LA    R5,L6               LOAD DECRMT INTO REG 5      @Z30RIVS 79300042
         LR    R6,R3               LOAD PRNT LINE INTO R6      @Z30RIVS 79350042
         SR    R6,R5               BACK UP PRNT LINE PNTR      @Z30RIVS 79400042
         MVI   L0(R6),BLANK        BLANK OUT ZERO              @Z30RIVS 79450042
         B     RETURN              RETURN                      @Z30RIVS 79500042
**                                                             @Z30RIVS 79550042
**       ROUTINE TO CALCULATE MEGABYTES READ AND SETUP FIELD FOR SORT   79600042
**       FOR THE VOLID SUMMATION                               @Z30RIVS 79650042
**                                                             @Z30RIVS 79700042
SETUP0   STM   R5,R8,XSAVE         SAVE WORK REGS              @Z30RIVS 79750042
         LA    R8,L50              LOAD NO. OF SUM REC         @Z30RIVS 79800042
SETUP1   CLC   L0(L6,R4),ZEROS     IS VOLID ZERO               @Z30RIVS 79850042
         BE    SETUP5              GO TO RETURN                @Z30RIVS 79900042
         ICM   R5,L15,L18(R4)      LOAD RETRY COUNT            @Z40RIVS 79950042
         SR    R6,R6                                           @Z40RIVS 80000042
         ICM   R6,L3,L12(R4)       LOAD OVERFLOW BYTES         @Z40RIVS 80050042
         ICM   R7,L15,L14(R4)      LOAD BYTES READ             @Z40RIVS 80100042
         SRDL  R6,L20              CONVERT TO MEGABYTES        @Z30RIVS 80150042
         ST    R7,SETUP7           SAVE FOR MOVE               @Z30RIVS 80200042
         STCM  R7,L15,L14(R4)      SAVE MEGABYTES              @Z40RIVS 80250042
         CR    R7,R5               COMPARE RETRY TO MEGA       @Z30RIVS 80300042
         BNL   SETUP2              MEGABYTES IS HIGH           @Z30RIVS 80350042
         MVC   L12(L2,R4),ZEROS    MOVE IN ZEROS               @Z30RIVS 80400042
         B     SETUP4              GO AGAIN                    @Z30RIVS 80450042
SETUP2   LTR   R5,R5               TEST FOR NO RETRY CNT       @Z30RIVS 80500042
         BZ    SETUP6              GO SET UP FOR SORT          @Z30RIVS 80550042
         SR    R6,R6               CLR REG 6 FOR DIV           @Z30RIVS 80600042
         DR    R6,R5               RETRY INTO MEGABYTES        @Z30RIVS 80650042
         ST    R7,SETUP7           SAVE MEGA/RETRY             @Z30RIVS 80700042
SETUP3   MVC   L12(L2,R4),SETUP7+L2 MOVE IN FOR SORT           @Z30RIVS 80750042
SETUP4   LA    R4,L28(R4)          INCREMENT TO NEXT RECORD             80800042
         BCT   R8,SETUP1           DECREMENT REC CNT           @Z30RIVS 80850042
SETUP5   B     RETURN              RETURN                      @Z30RIVS 80900042
SETUP6   OI    SETUP7+L2,SETSORT   SET UP FOR SORT             @Z30RIVS 80950042
         B     SETUP3              GO TO MOVE SORT FIELD       @Z30RIVS 81000042
**                                                             @Z30RIVS 81050042
**                                                             @Z30RIVS 81100042
THEEND   STM   R14,R12,L12(R13)    SAVE ALL REGS               @Z30RIVS 81150042
         LR    R12,R13             SAVE THE SAVE ADDRESS       @Z30RIVS 81200042
         LA    R13,FSAVE           POINT TO MY SAVE            @Z30RIVS 81250042
         ST    R12,L4(R13)         SET CHAINING POINTERS       @Z30RIVS 81300042
         ST    R13,L8(R12)                                     @Z30RIVS 81350042
         L     R3,L4(R2)           PICK UP POINTER TO NEXT COUNTER      81400042
         ST    R3,L32(R12)         SAVE POINTER TO REG SAVE    @XM09337 81450042
         LH    R0,SIZE             PICK UP SIZE OF AREA        @Z30RIVS 81500042
         LR    R1,R2               SET ADDRESS                 @Z30RIVS 81550042
         FREEMAIN R,LV=(0),A=(1)                               @Z30RIVS 81600042
         LTR   R3,R3               ANY MORE COUNTERS           @Z30RIVS 81650042
         BZ    RETURNO             NO RETURN                   @Z30RIVS 81700042
         LA    R5,PENTRY+L10       POINT TO TOP ENTRY LESS 4   @Z30RIVS 81750042
         LA    R6,LABELS-L1        POINT TO FIRST LABEL LESS 1 @Z40RIVS 81800042
         STM   R5,R6,YR9PTR                                    @Z40RIVS 81850042
RETURNO  L     R13,L4(R13)         PICK UP &                   @Z30RIVS 81900042
         LM    R14,R12,L12(R13)    RESTORE REGS                @Z30RIVS 81950042
         LR    R2,R3                                           @XM09337 81970042
         BR    R14                                             @Z30RIVS 82000042
**                                                             @Z30RIVS 82050042
SIZE     DC    H'4568'                                         @Z427VLS 82100042
         DS    0F                                              @Z30RIVS 82150042
ASUMTA2  DC    A(SUMTA2-1)                                              82200042
ASUMTA4  DC    A(SUMTA4-1)                                              82250042
ASUMTA8  DC    A(SUMTA8-1)                                              82300042
RECTST4  DC    F'0'                                            @Z30RIVS 82350042
RECTSTS  DC    F'0'                                            @Z30RIVS 82400042
RECTSTP  DC    F'0'                                            @Z30RIVS 82450042
TFAULT7  DC    F'0'                                            @Z30RIVS 82500042
CUANR    DC    F'0'                SAVE AREA FOR CH-CU         @Z30RIVS 82550042
SRTSAV   DC    F'0'                SAVE FOR REG 4              @Z30RIVS 82600042
CNTDN2   DC    F'0'                                            @Z30RIVS 82650042
CNTDN3   DC    F'50'                                           @Z30RIVS 82700042
FLTMOV2  DC    F'0'                                            @Z30RIVS 82750042
FLTMOV6  DC    F'0'                                            @Z30RIVS 82800042
FLTSRT8  DC    F'0'                                            @Z30RIVS 82850042
EDTFA4   DC    F'16'               NUMBER OF COUNTERS                   82900042
EDTFA5   DC    F'0'                                            @Z30RIVS 82950042
SETUP7   DC    F'0'                SAVE AREA                   @Z30RIVS 83000042
         SPACE 1                                               @Z30RIVS 83050042
VOLPTR   DC    F'0'                PNTR TO VOLID,SUM AREA      @Z30RIVS 83100042
         SPACE 1                                               @Z30RIVS 83150042
FLTPTR   DC    F'0'                PNTR TO FLTSYM SUM AREA     @Z30RIVS 83200042
         SPACE 1                                               @Z30RIVS 83250042
CON3350  DC    C'3350'                                         @Z30RIVS 83300042
         DS    0D                                              @Z30RIVS 83350042
XSAVE1   DC    18F'0'                                          @Z40RIVS 83400042
FSAVE    EQU   XSAVE1                                          @Z40RIVS 83450042
XSAVE    EQU   XSAVE1                                          @Z40RIVS 83500042
XSAVEV   EQU   XSAVE1                                          @Z40RIVS 83550042
XSAVED   EQU   XSAVE1                                          @Z40RIVS 83600042
**                                                             @Z30RIVS 83650042
         SPACE 2                                               @Z30RIVS 83700042
TOTSKS   DC    F'0'                                            @Z30RIVS 83750042
TOTMEGRD DC    F'0'                                            @Z30RIVS 83800042
SAVMEG   DC    F'0'                SAVE AREA FOR MEG READ      @Z30RIVS 83850042
TOTRETRD DC    F'0'                                            @Z30RIVS 83900042
TOTCORRD DC    F'0'                                            @Z30RIVS 83950042
TOTSKERS DC    H'0'                                            @Z30RIVS 84000042
**                                                             @Z30RIVS 84050042
TLEN     EQU   *-TOTSKS            LENGTH OF TOTALS AREA       @Z30RIVS 84100042
         SPACE 2                                               @Z30RIVS 84150042
ZEROS    DC    5F'0'                                           @Z30RIVS 84200042
HEX00    EQU   ZEROS                                           @Z40RIVS 84250042
NA       DC    C'-N/A-'                                        @Z30RIVS 84300042
SHARED   DC    C'SHARED'                                       @Z427VLS 84350042
UNKNOWN  DC    C'UNKNOWN'                                      @Z30RIVS 84400042
CHARS    DC    C'0123456789ABCDEF'                             @Z30RIVS 84450042
CHAR0    DC    C'0'                                            @Z30RIVS 84500042
DEVTABLE DC    X'200B'             DEVICE TYPE &               @Z30RIVS 84600042
         DC    X'11'               REC ID FOR A                @Z30RIVS 84650042
         DC    C'3350   '          MADRID                      @Z30RIVS 84700042
         SPACE 1                                               @Z30RIVS 84750042
READYP   DC    D'0'                                            @Z30RIVS 84800042
PENTRY   DS    0F                                              @Z30RIVS 84850042
         DC    X'0001001'                                      @Z30RIVS 84900042
         DC    X'0001001'                                      @Z30RIVS 84950042
         DC    A(LABELS)                                       @Z30RIVS 85000042
         DC    H'0'                                            @Z30RIVS 85050042
         LINE  ,,SKIP=2                                        @Z30RIVS 85100042
         ROUTINE YDUMA,SKIPPER     INSURE EJECT                @Z30RIVS 85150042
         LABEL ''                                              @Z30RIVS 85200042
         DC    X'01'                                           @Z30RIVS 85250042
         DC    X'000B8B00'                                     @Z30RIVS 85300042
         LABEL ' '                                             @Z30RIVS 85350042
         LINE  (61,23),(1,19),SKIP=2                           @Z30RIVS 85400042
         ROUTINE TYPDEV,MOVDEV                                 @Z30RIVS 85450042
         HEX   YCPU,0,2B                                       @Z30RIVS 85500042
         HEX   YSER,0,3B                                       @Z30RIVS 85550042
         ROUTINE YCPU,SETCPUNO                                 @Z30RIVS 85600042
         LABEL 'SUMMARY OF I/O RECO','RDS  TYPE OBR/MDR  ',    @Z30RIVSC85650042
               'SOURCE-OUTBOARD   D',                          @Z30RIVSC85700042
               'EVICE TYPE ',' MODEL-','SERIAL NO.-'           @Z30RIVS 85750042
         LINE  ,(13,13),SKIP=1                                 @Z30RIVS 85800042
         ROUTINE YDUMA,SKIPPER                                 @Z30RIVS 85850042
         LABEL 'DAY YEAR','DAY YEAR'                           @Z30RIVS 85900042
         LINE  (13,13),(1,21),SKIP=2                           @Z30RIVS 85950042
         ROUTINE TDAY1,SETDATE                                 @Z30RIVS 86000042
         ROUTINE TDAY2,SETDATE                                 @Z30RIVS 86050042
         ROUTINE YDUMA,REPNT3                                  @Z30RIVS 86100042
         ROUTINE YNOREC,CONV1                                  @Z30RIVS 86150042
         LABEL 'DATE RANGE-','TO','TOTAL NUMBER OF RECORDS'    @Z30RIVS 86200042
         LINE  (1,1),(1,1),SKIP=1                              @Z30RIVS 86250042
         ROUTINE YDUMA,SKIPPER                                 @Z30RIVS 86300042
         LABEL 'PHYSICAL    BUS OUT    EQUIP. CK.    EQUIP. CK.    DATAC86350042
                  DATA CHECK   OVERRN    INV.    SEEK CHK       STATISTC86400042
               ICAL'                                           @Z30RIVS 86450042
         LINE  (1,1),(1,1),SKIP=1                              @Z30RIVS 86500042
         ROUTINE YDUMA,SKIPPER                                 @Z30RIVS 86550042
         LABEL 'ADDRESS     PARITY        C.U.         DRIVE       CHECC86600042
               K  CORR  RETRY            TRACK'                @Z30RIVS 86650042
         LINE  ,,SKIP=2                                        @Z30RIVS 86700042
         ROUTINE TSTAT,EDTFA6                                  @Z30RIVS 86750042
         LABEL '                       TEMP  PERM    TEMP  PERM    PERMC86800042
                                         FMT.    '             @XM09337 86850042
SUMTA1   LINE  (1,6),(1,1),SKIP=1                              @Z427VLS 86900042
         HEX   TCUA,0,2B           CONVERT ADDRESS             @Z30RIVS 86950042
         ROUTINE YDUMA,NOPRNTT     DON'T PRINT LEADING ZERO    @Z30RIVS 87000042
         ROUTINE TBUSOPA,CONV1     CONVERT BUS OUT PARITY      @Z30RIVS 87050042
         ROUTINE YDUMA,REPNT0      ALTER PRNT LINE PNTR        @Z30RIVS 87100042
         ROUTINE TEQCNT,CONV1      CONVERT EQ CHK CU TEMP      @Z30RIVS 87150042
         ROUTINE TEQCNP,CONV1      CONVERT EQ CHK CU PERM      @Z30RIVS 87200042
         ROUTINE YDUMA,REPNT1      ALTER PRNT LINE PNTR        @Z30RIVS 87250042
         ROUTINE TEQDRT,CONV1      CONVERT EQ CHK DRV TEMP     @Z30RIVS 87300042
         ROUTINE TEQDRP,CONV1      CONVERT EQ CHK DRV PERM     @Z30RIVS 87350042
         ROUTINE YDUMA,REPNT1      ALTER PRNT LINE PNTR        @Z30RIVS 87400042
         ROUTINE TDATCHP,CONV1     CONVERT DATA CHK PERM       @Z30RIVS 87450042
         ROUTINE YDUMA,REPNT4      ALTER PRNT LINE POINTER     @XM09337 87500042
         ROUTINE TDACHKC,CONV1     CONVERT DATA CHK CORR       @XM09337 87570042
         ROUTINE TDACHKR,CONV1     CONVERT DATA CHK RETRY      @XM09337 87640042
         ROUTINE YDUMA,REPNT1      ALTER PRNT LINE PNTR        @XM09337 87710042
         ROUTINE TOVERRN,CONV1     CONVERT OVERRUN             @XM09337 87780042
         ROUTINE YDUMA,REPNT2      ALTER PRNT LINE PNTR        @Z30RIVS 87850042
         ROUTINE TINVTRKF,CONV1    CONVERT INV TRK FORMAT      @XM09337 87900042
         ROUTINE YDUMA,REPNT1      ALTER PRNT LINE POINTER     @XM09337 87930042
         ROUTINE TSKCHK,CONV1      CONVERT SK CHK COUNTER      @XM09337 87960042
         ROUTINE YDUMA,REPNT5      ALTER PRINT LINE POINTER    @XM09337 87990042
         ROUTINE TSTAT,CONV1       CONVERT STATISTICAL         @Z30RIVS 88050042
SUMTA2   LABEL ''                                              @Z30RIVS 88100042
         LINE  (1,6),(1,1),SKIP=1                              @Z427VLS 88150042
         ROUTINE TSTAT,EDTFA0      CYCLE THROUGH SUMREC        @Z30RIVS 88200042
         LABEL ''                                              @Z30RIVS 88250042
         LINE  ,(1,1),SKIP=2                                   @Z30RIVS 88300042
         ROUTINE SYMCD,FLTTST0                                          88350042
         LABEL 'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXC88400042
               XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' 88450042
SUMTA5   LINE  (61,23),(1,19),SKIP=2                           @Z30RIVS 88500042
         ROUTINE TYPDEV,MOVDEV                                 @Z30RIVS 88550042
         HEX   YCPU,0,2B                                       @Z30RIVS 88600042
         HEX   YSER,0,3B                                       @Z30RIVS 88650042
         ROUTINE YCPU,SETCPUNO                                 @Z30RIVS 88700042
SUMTA6   LABEL 'FAULT SYMPTOM CODE ','SUMMARY   TYPE-OBR ',    @Z30RIVSC88750042
               ' SOURCE-OUTBOARD  D',                          @Z30RIVSC88800042
               'EVICE TYPE',' MODEL-','SERIAL NO.-'            @Z30RIVS 88850042
         LINE  (61,23),(1,19),SKIP=2                           @Z30RIVS 88900042
         ROUTINE YDUMA,SKIPPER                                 @Z30RIVS 88950042
SUMTAA   LABEL 'SEQUENCE BY SYMPTOM CODE'                      @Z30RIVS 89000042
         LINE  (1,1),(1,12),SKIP=1                             @Z427VLS 89050042
         ROUTINE YDUMA,SKIPPER                                 @Z30RIVS 89100042
         LABEL 'FAULT','PHYSICAL','OCCURRENCES','  DATE/TIME ',,,      X89150042
               'SENSE FROM L','AST OCCURREN','CE'              @Z427VLS 89180042
         LINE  (1,1),(1,12),SKIP=1                             @Z427VLS 89210042
         ROUTINE YDUMA,SKIPPER                                 @Z30RIVS 89250042
         LABEL 'SYMPTOM','CHANNEL/',,'  LAST ENTRY ','           0',   X89300042
               ' 0 0 0 0 0 0',' 0 0 0 1 1 1',' 1 1 1 1 1 1',   @Z427VLSX89310042
               ' 1 2 2 2 2'                                    @Z427VLS 89320042
         LINE  ,,SKIP=1                                        @Z427VLS 89350042
         ROUTINE SYMCD,FLTSRT0                                 @Z30RIVS 89400042
         LABEL 'CODE','UNIT ADDRESS',,,'           0',' 1 2 3 4 5 6',  X89450042
               ' 7 8 9 0 1 2',' 3 4 5 6 7 8',' 9 0 1 2 3'      @Z427VLS 89480042
SUMTA7   LINE  (1,12)                                          @Z427VLS 89510042
         HEX   SYMCD,0,2B                                      @Z30RIVS 89550042
         HEX   SYMCUA,0,,2B                                    @Z30RIVS 89600042
         ROUTINE SYMOCR,GETOCCUR                               @Z30RIVS 89650042
         ROUTINE SYMDAY,FLTSYDA                                @Z30RIVS 89700042
         HEX   SYMHR,0,4B          CONVERT TIME                @Z30RIVS 89750042
         ROUTINE YDUMA,HREDIT0     REFORMAT TIME FIELD         @Z30RIVS 89800042
         HEX   SYMSNS0,0,6B                                    @Z427VLS 89810042
         HEX   SYMSNS1,0,6B                                    @Z427VLS 89820042
         HEX   SYMSNS2,0,6B                                    @Z427VLS 89830042
         HEX   SYMSNS3,0,6B                                    @Z427VLS 89840042
SUMTA8   LABEL ''                                              @Z30RIVS 89850042
         LINE  (1,12)                                          @Z427VLS 89900042
         ROUTINE SYMCD,FLTMOV0                                 @Z30RIVS 89950042
         LABEL ''                                              @Z30RIVS 90000042
         LINE  ,(1,1)                                          @Z30RIVS 90050042
         ROUTINE YDUMA,SKIPPER                                 @Z30RIVS 90100042
         LABEL 'NOTE:  IF SYMPTOM CODE IS 0 REFER TO DETAIL OBR RECORD' 90150042
SUMTAC   LINE  ,(1,1),SKIP=2                                            90200042
         ROUTINE YDUMA,SKIPPER                                 @Z30RIVS 90250042
SUMTAD   LABEL 'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX*90300042
               XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' 90350042
         LINE  (75,7),(1,63)                                   @Z30RIVS 90400042
         ROUTINE TYPDEV,MOVDEV                                 @Z30RIVS 90450042
         ROUTINE TVOLID1,SETUP0                                @Z30RIVS 90500042
         ROUTINE TVOLID1,SORTV0                                @Z30RIVS 90550042
         LABEL 'SUMMARY OF I/O STATISTICAL RECORDS BY VOLUME ID',      C90600042
               'DEVICE TYPE'                                   @Z30RIVS 90650042
         LINE  (1,10),,SKIP=2                                  @Z30RIVS 90700042
         HEX   TVCUA,0,2B                                      @Z30RIVS 90750042
         ROUTINE YDUMA,CUAN0                                   @Z30RIVS 90800042
         LABEL ''                                              @Z30RIVS 90850042
         LINE  ,(2,13),SKIP=1                                  @Z30RIVS 90900042
         ROUTINE YDUMA,SKIPPER                                 @Z30RIVS 90950042
         LABEL 'VOLUME ID','PHYSICAL','TOTAL','ACCESS',        @Z30RIVSC91000042
               'TOTAL','RETRY',                                @Z30RIVSC91050042
               'MEGABYTES','CORRECTABLE','MEGABYTES'           @Z30RIVS 91100042
         LINE  ,(2,13),SKIP=1                                  @Z30RIVS 91150042
         ROUTINE YDUMA,SKIPPER                                 @Z30RIVS 91200042
         LABEL ,'DRIVE','ACCESSES','ERRORS','MEGABYTES',       @Z30RIVSC91250042
               'READ','READ/RETRY','READ','READ/CORR'          @Z30RIVS 91300042
         LINE  ,,SKIP=2                                        @Z30RIVS 91350042
         ROUTINE YDUMA,SKIPPER                                 @Z30RIVS 91400042
         LABEL ,,'X1024',,'READ','ERRORS','ERRORS','ERRORS','ERRORS'    91450042
SUMTA3   LINE  (3,13),(1,1),SKIP=1                             @Z30RIVS 91500042
         ROUTINE TVOLID1,PRVOLS                                @Z30RIVS 91550042
SUMTA4   LABEL ' '                                             @Z30RIVS 91600042
         LINE  (3,13),(1,1),SKIP=1                             @Z30RIVS 91650042
         ROUTINE TVOLID1,CNTDN0                                @Z30RIVS 91700042
         LABEL ' '                                             @Z30RIVS 91750042
         LINE  (3,13),(1,1),SKIP=1                             @Z30RIVS 91800042
         ROUTINE YDUMA,SKIPPER                                 @Z30RIVS 91850042
         LABEL ' '                                             @Z30RIVS 91900042
         LINE  (29,13),(3,1),SKIP=2                            @Z30RIVS 91950042
         ROUTINE YDUMA,GETTOTS                                 @Z30RIVS 92000042
         LABEL 'TOTALS'                                        @Z30RIVS 92050042
         LINE  ,(2,29),SKIP=1                                  @Z30RIVS 92100042
         ROUTINE YDUMA,SKIPPER                                 @Z30RIVS 92150042
         LABEL 'TOTAL OVERRUNS  CHNL A',                       @Z30RIVSC92200042
               'TOTAL OVERRUNS  CHNL B',                       @Z30RIVSC92250042
               'TOTAL OVERRUNS  CHNL C',                       @Z30RIVSC92300042
               'TOTAL OVERRUNS  CHNL D'                        @Z30RIVS 92350042
         LINE  (21,29),(12,29)                                 @Z30RIVS 92400042
         ROUTINE TOCACA,GETABCDD                               @Z40RIVS 92450042
         LABEL 'COMMAND','COMMAND','COMMAND','COMMAND'         @Z30RIVS 92500042
         LINE  ,,SKIP=2                                        @Z30RIVS 92550042
         ROUTINE TOCADA,GETABCDD                               @Z30RIVS 92600042
         LABEL 'DATA','DATA','DATA','DATA'                     @Z30RIVS 92650042
         LINE  ,,SKIP=2                                        @Z30RIVS 92700042
         ROUTINE YDUMA,SKIPPER                                 @Z30RIVS 92750042
         LABEL ''                                              @Z30RIVS 92800042
         LINE  ,(1,1),SKIP=1                                   @Z30RIVS 92850042
         ROUTINE YDUMA,SKIPPER                                 @Z30RIVS 92900042
         LABEL 'NOTE:  VOLUME ID''S ARE LISTED IN ERROR RATE SEQUENCE SX92950042
               TARTING WITH THE ONE WITH HIGHEST % OF RETRY READ ERRORSX93000042
                '                                              @Z30RIVS 93050042
         LINE  ,(1,1),SKIP=1                                   @Z30RIVS 93100042
         ROUTINE YDUMA,SKIPPER                                 @Z30RIVS 93150042
         LABEL 'NOTE:  ZEROS IN MEGABYTES READ/XXXX ERROR COLUMNS INDICC93200042
               ATE THAT THERE WAS LESS THAN ONE MEGABYTE READ PER ERRORC93250042
                '                                              @Z30RIVS 93300042
         LINE  ,,SKIP=2                                        @Z30RIVS 93350042
         ROUTINE YDUMA,SKIPPER                                 @Z30RIVS 93400042
         LABEL 'NOTE:  N/A IS AN INDICATION OF EITHER NO RETRY READ ERRX93450042
               ORS OR CORRECTABLE READ ERRORS IN THE RESPECTIVE COUNTERX93500042
               S '                                             @Z30RIVS 93550042
         LINE  ,(1,1),SKIP=2                                   @Z30RIVS 93600042
         ROUTINE YDUMA,SKIPPER                                 @Z30RIVS 93650042
         LABEL 'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXC93700042
               XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' 93750042
         LINE  ,(1,1)                                          @Z30RIVS 93800042
         ROUTINE YDUMA,THEEND                                  @Z30RIVS 93850042
         LABEL ' '                                             @Z30RIVS 93900042
         DC    X'FF'                                           @Z30RIVS 93950042
         DC    XL2'0000'                                       @Z30RIVS 94000042
         DC    XL2'0018'                                       @Z30RIVS 94050042
         DC    XL2'0000'                                       @Z30RIVS 94100042
         DC    C'$'                                            @Z30RIVS 94150042
LABELS   EQU   *                                               @Z30RIVS 94200042
         LSTART                                                @Z30RIVS 94250042
         END                                                            94300042
