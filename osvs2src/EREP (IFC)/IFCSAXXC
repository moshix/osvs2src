         TITLE 'I F C S A X X C  SUMMARY TABLE FOR A 3340'              00050042
*   MADRID/WINCHESTER SVS REL2 1.7                             @Y17ASRB 00060042
*A000600                                                       @Y17ASRB 00070042
***  DSGEN MACRO     DSGEN MACRO     DSGEN MACRO     DSGEN MACRO    *** 00100042
         SPACE                                                          00150042
         MACRO                                                          00200042
&NAME    DSGEN                                                          00250042
.*                            THIS MACRO GENERATES ONE DSECT WORD       00300042
.*                                 FORMATTED FOR THE SUBJECT LOG RECORD 00350042
.*                                 EACH OPERAND HAS TWO SUB LISTS. THE  00400042
.*                                 FIRST IS THE NAME OF THE LOG ITEM    00450042
.*                                 WHILE THE SECOND IS THE # OF BITS TO 00500042
.*                                 ALLOCATE FOR THIS ITEM. ITEMS MUST   00550042
.*                                 BE DEFINED CONTIGUOUSLY WITHOUT GAPS 00600042
.*                                 UNUSED BIT GROUPS MUST BE GIVEN      00650042
.*                                 DUMMY NAMES. THE NAMES PROVIDED FOR  00700042
.*                                 THE LOG ITEMS MAY THEN BE USED IN    00750042
.*                                 THE CONVERSION MACRO INSTRUCTIONS.   00800042
         GBLA  &BITS(3000),&ITEMNBR,&SHIFT(3000)                        00850042
         GBLC  &ITEM(3000)                                              00900042
         LCLB  &ONLY1,&CTIND                                            00950042
         LCLA  &START1,&START2,&END1,&END2                              01000042
         LCLC  &SYMBOL,&EQUSYM                                          01050042
         LCLA  &OP,&COUNT,&BYTE,&EQUCNT                                 01100042
         ACTR  100000                                                   01150042
.START   AIF   (N'&SYSLIST(&OP+1) LT 3).LOOP                            01200042
         AIF   ('&SYSLIST(&OP+1,3)' EQ 'EQU').LOOP     TEST FOR EQU     01250042
  AIF   ('&SYSLIST(&OP+1,3)' EQ '' OR '&SYSLIST(&OP+1,4)' EQ '').ERR1   01300042
         AIF   ('&SYSLIST(&OP+1,3)' GT '&SYSLIST(&OP+1,4)').ERR3        01350042
&START1  SETA  &SYSLIST(&OP+1,3)        GET START COUNT OF 1            01400042
&START2  SETA  &SYSLIST(&OP+1,4)        GET FIRST END COUNT             01450042
         AGO   .SET2A                   BRANCH AROUND                   01500042
.ERR1    MNOTE '**FIRST SYMBOL CONCATENATION INCOMPLETE**'              01550042
         MEXIT                                                          01600042
.SET2A   AIF   ('&SYSLIST(&OP+1,5)' EQ ''AND '&SYSLIST(&OP+1,6)' EQ '' X01650042
               ).SET2                   TEST FOR NO SECOND              01700042
  AIF   ('&SYSLIST(&OP+1,5)' EQ '' OR '&SYSLIST(&OP+1,6)' EQ '').ERR2   01750042
         AIF   ('&SYSLIST(&OP+1,5)' GT '&SYSLIST(&OP+1,6)').ERR3        01800042
&END1    SETA  &SYSLIST(&OP+1,5)        GET START COUNT OF 2            01850042
&END2    SETA  &SYSLIST(&OP+1,6)        GET END COUNT OF 2              01900042
         AGO   .LOOP                                                    01950042
.SET2    ANOP                                                           02000042
&ONLY1   SETB  1                        INDICATE ONLY ONE CONCATENATION 02050042
         AGO   .LOOP                                                    02100042
.ERR2    MNOTE '**SECOND SYMBOL CONCATENATION INCOMPLETE**'             02150042
         MEXIT                                                          02200042
.ERR3    MNOTE '**START GREATER THAN END CONCATENATION**'               02250042
         MEXIT                                                          02300042
.LOOP    ANOP                                                           02350042
&OP      SETA  &OP+1                                                    02400042
         AIF   (&OP GT N'&SYSLIST).DONE      TEST IF ALL DONE           02450042
&ITEMNBR SETA  &ITEMNBR+1                                               02500042
         AIF   ('&SYSLIST(&OP,2)' NE '').OK1                            02550042
         MNOTE '**NULL BIT COUNT FIELD**'                               02600042
         MEXIT                                                          02650042
.OK1     ANOP                                                           02700042
&SYMBOL  SETC  '&SYSLIST(&OP,1)'                                        02750042
         AIF   ('&SYMBOL' NE '').OK                                     02800042
*              *****     LOG ITEM SYMBOL NOT PROVIDED     *****         02850042
         AIF   ('&SYSLIST(&OP,3)' NE 'EQU').CNT                         02900042
         AGO   .START                   GET NEXT                        02950042
.OK      AIF   (N'&SYSLIST(&OP) LT 3).NO3    TEST FOR OLD FORMAT        03000042
         AIF   ('&SYSLIST(&OP,3)' EQ 'EQU').EQU   TEST FOR EQU          03050042
         AIF   (&ONLY1).OK2             TEST FOR ONLY ONE CONCAT        03100042
&SYMBOL  SETC  '&SYMBOL.&START1.&END1'       GET 1 AND 2 CONCAT         03150042
         AGO   .NO3                     BRANCH AROUND                   03200042
.OK2     ANOP                                                           03250042
&SYMBOL  SETC  '&SYMBOL.&START1'        GET 1 CONCATENATED              03300042
.NO3     ANOP                                                           03350042
&SYMBOL  EQU   *+&BYTE                                                  03400042
&ITEM(&ITEMNBR) SETC '&SYMBOL'          GET LABEL IN GLOBAL             03450042
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2)                                    03500042
&SHIFT(&ITEMNBR) SETA &COUNT-&BYTE*8                                    03550042
.CNT     ANOP                                                           03600042
&CTIND   SETB  1                        SET COUNT INDICATOR             03650042
&COUNT   SETA  &COUNT+&SYSLIST(&OP,2)                                   03700042
&BYTE    SETA  &COUNT/8                                                 03750042
         AIF   (N'&SYSLIST(&OP) LT 3).START  TEST FOR OLD FORMAT        03800042
         AIF   (&ONLY1).TSTST           TEST FOR ONLY ONE CONCAT        03850042
         AIF   (&END1 EQ &END2).TSTST   TEST FOR SECOND END             03900042
&END1    SETA  &END1+1                  INCREMENT COUNT                 03950042
&OP      SETA  &OP-1                    DECREMENT INCREMENT             04000042
         AGO   .LOOP                    GENERATE NEXT                   04050042
.TSTST   ANOP                                                           04100042
         AIF   (&START1 EQ &START2).LPDONE   TEST FOR END               04150042
         AIF   (&ONLY1).NSET1           TEST FOR ONLY ONE CONCAT        04200042
&END1    SETA  &SYSLIST(&OP,5)          RE-INIT SECOND START COUNT      04250042
.NSET1   ANOP                                                           04300042
&OP      SETA  &OP-1                    DECREMENT INDEX                 04350042
&START1  SETA  &START1+1                INCREMENT FIRST COUNT           04400042
         AGO   .LOOP                    GO DO NEXT                      04450042
.LPDONE  ANOP                                                           04500042
&ONLY1   SETB  0                        CLEAR INDICATOR                 04550042
         AGO   .START                   GO TEST FOR MORE SUB-LISTS      04600042
.DONE    AIF   (&COUNT-&COUNT/8*8 NE 0).ERR  TEST FOR MULTIPLE OF EIGHT 04650042
         AIF   (&CTIND EQ 0).END        NO DS IF NO COUNT               04700042
&COUNT   SETA  &COUNT/8                 GET NUMBER OF BYTES             04750042
&NAME    DS    &COUNT.C                                                 04800042
.END     MEXIT                                                          04850042
.ERR     MNOTE '**BIT COUNT FLDS DO NOT TOTAL MULTIPLE OF 8**'          04900042
         MEXIT                                                          04950042
.EQU     AIF   ('&SYSLIST(&OP,4)' NE '').EQU1     TEST FOR NULL LABEL   05000042
.ERR4    MNOTE '**EQU OPERAND OMITTED OR NOT FOUND**'                   05050042
         MEXIT                                                          05100042
.EQU1    AIF   (&SYSLIST(&OP,2) LT 16).EQU2  COUNT OVER FIFTEEN         05150042
*****               THE FOLLOWING STATEMENT                *****        05200042
*****     NUMBER OF BITS EXCEED 15 - DO NOT USE AS BIN     *****        05250042
.EQU2    ANOP                                                           05300042
&EQUCNT  SETA  0                        CLEAR COUNTER                   05350042
&EQUSYM  SETC  '&SYSLIST(&OP,4)'        GET EQU OPERAND                 05400042
.EQULOP  ANOP                                                           05450042
&EQUCNT  SETA  &EQUCNT+1                INCREMENT INDEX                 05500042
         AIF   ('&ITEM(&EQUCNT)' EQ '&EQUSYM').EQUOUT  LABEL FOUND?     05550042
         AIF   (&EQUCNT EQ &ITEMNBR).ERR4    ALL TESTED?                05600042
         AGO   .EQULOP                  NO-GET NEXT                     05650042
.EQUOUT  ANOP                                                           05700042
&ITEM(&ITEMNBR) SETC '&SYMBOL'          GET LABEL NAME                  05750042
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2)    GET NUMBER OF BITS              05800042
&SHIFT(&ITEMNBR) SETA &SHIFT(&EQUCNT)   GET SHIFT COUNT                 05850042
&SYMBOL  EQU   &EQUSYM                  THIS SYMBOL EQUATED             05900042
         AGO   .START                   RETURN FOR NEXT                 05950042
         MEND                                                           06000042
         EJECT                                                          06050042
***  BIN MACRO       BIN MACRO       BIN MACRO       BIN MACRO      *** 06100042
         SPACE                                                          06150042
         MACRO                                                          06200042
         BIN                                                            06250042
.*                                 &SYSLIST(&OP,1) - NAME OF LOG ITEM   06300042
.*                                      RECORD DSECT                    06350042
.*                                 $SYSLIST(&OP,2) - NBR OF SPACES      06400042
.*                                      TO SKIP ON MULTIPLE             06450042
.*                                      PRINT OR NBR OF SPACES          06500042
.*                                      TO BACK UP FROM COLUMN FOR      06550042
.*                                      START OF PRINTING. THE LETTER   06600042
.*                                      B PRECEEDS THE NUMBER (B5) IF   06650042
.*                                      THE LATTER IS DESIRED. OMISSION 06700042
.*                                      OF THIS OPERAND FORCES OPTION 2 06750042
.*                                      WITH BACKUP SPACING EQUAL TO    06800042
.*                                 THE NUMBER OF BITS IN THE ITEM       06850042
.*                                 DEFINITION (VIA MACRO 'DSGEN').      06900042
.*                            A LIMIT OF 15 BITS IS IMPOSED FOR THE     06950042
.*                                 TOTAL NUMBER OF BITS TO PRINT.       07000042
         GBLA  &INITIAL                                                 07050042
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN                               07100042
         GBLC  &ITEM(3000),&DSECT                                       07150042
         GBLA  &BITS(3000),&ITEMNBR,&SHIFT(3000),&NRENTS                07200042
         LCLB  &B,&SUB                                                  07250042
         LCLA  &IBITS,&NDX,&ISHIFT,&K                                   07300042
         LCLA  &TEMP,&T,&OP                                             07350042
         LCLC  &S                                                       07400042
         ACTR  500000                                                   07450042
         AIF   (&DIAGTST EQ 0).NOMSG                                    07500042
         AIF   (&INITIAL EQ 0).NOMSG                                    07550042
         AIF   (&DIAGLIN EQ 1).NOMSG                                    07600042
         MNOTE '**NO LINE ASSOCIATED WITH THIS DATA**'                  07650042
*****THE FOLLOWING GENERATED FOR TEST PURPOSES*****                     07700042
*        LINE                                                           07750042
         LINE                                                           07800042
.NOMSG   ANOP                                                           07850042
         AIF   (K'&SYSLIST(1) EQ K'&SYSLIST(1,1)).LOOP                  07900042
&SUB     SETB  1                                                        07950042
.LOOP    ANOP                                                           08000042
&OP      SETA  &OP+1                                                    08050042
.LOOP1   ANOP                                                           08100042
&NDX     SETA  &NDX+1                                                   08150042
         AIF   ('&ITEM(&NDX)' EQ '&SYSLIST(&OP,1)').FOUND               08200042
         AIF   (&NDX LT &ITEMNBR).LOOP1                                 08250042
         MNOTE '**LOG ITEM NOT DEFINED**'                               08300042
         MEXIT                                                          08350042
.FOUND   ANOP                                                           08400042
&ISHIFT  SETA  &SHIFT(&NDX)                                             08450042
&IBITS   SETA  &BITS(&NDX)                                              08500042
         AIF   (&SUB EQ 1).SUB00                                        08550042
         AIF   ('&SYSLIST(3)' EQ '').SETT                               08600042
&IBITS   SETA  &SYSLIST(3)                                              08650042
         AGO   .SETT                                                    08700042
.SUB00   AIF   ('&SYSLIST(&OP,3)' EQ '').SETT                           08750042
&IBITS   SETA  &SYSLIST(&OP,3)                                          08800042
.SETT    ANOP                                                           08850042
&T       SETA  &IBITS-1                                                 08900042
&B       SETB  0                                                        08950042
         AIF   (&IBITS GT 0 AND &IBITS LT 16).SUB0                      09000042
         MNOTE '**NO. OF BITS OUTSIDE RANGE OF 1-15**'                  09050042
         MEXIT                                                          09100042
.SUB0    AIF   (&SUB EQ 1).SUBA                                         09150042
         AIF   ('&SYSLIST(2)' EQ '').BACKUP                             09200042
&K       SETA  K'&SYSLIST(2)                                            09250042
&B       SETB  ('&SYSLIST(2)'(1,1) EQ 'B')                              09300042
&S       SETC  '&SYSLIST(2)'(&B+1,&K-&B)                                09350042
         AGO   .SUBB                                                    09400042
.SUBA    ANOP                                                           09450042
         AIF   ('&SYSLIST(&OP,2)' EQ '').BACKUP                         09500042
&K       SETA  K'&SYSLIST(&OP,2)                                        09550042
&B       SETB  ('&SYSLIST(&OP,2)'(1,1) EQ 'B')                          09600042
&S       SETC  '&SYSLIST(&OP,2)'(&B+1,&K-&B)                            09650042
.SUBB    ANOP                                                           09700042
&T       SETA  &S                                                       09750042
.BACKUP  ANOP                                                           09800042
&NRENTS  SETA  &NRENTS+1                                                09850042
&TEMP    SETA  &ISHIFT                                                  09900042
         AIF   (&IBITS NE 1 OR &B NE 0).BIN2                            09950042
         DC    AL.12(&SYSLIST(&OP,1)-&DSECT),XL.4'&TEMP'                10000042
         AGO   .OUT                                                     10050042
.BIN2    AIF   (&SUB EQ 1).BIN2A                                        10100042
         AIF   ('&SYSLIST(2)' NE '').BIN3                               10150042
         AGO   .BIN2B                                                   10200042
.BIN2A   AIF   ('&SYSLIST(&OP,2)' NE '').BIN3                           10250042
.BIN2B   ANOP                                                           10300042
&B       SETB  1                                                        10350042
.BIN3    ANOP                                                           10400042
         DC    AL.12(&SYSLIST(&OP,1)-&DSECT),XL.4'C'                    10450042
         DC    BL.1'&B',AL.7(&T),AL.4(&IBITS),FL.4'&ISHIFT'             10500042
.OUT     ANOP                                                           10550042
&NDX     SETA  0                                                        10600042
         AIF   (&SUB EQ 0).OUTA                                         10650042
         AIF   (&OP LT N'&SYSLIST).LOOP                                 10700042
.OUTA    ANOP                                                           10750042
         MEND                                                           10800042
         EJECT                                                          10850042
***  HEX MACRO       HEX MACRO       HEX MACRO       HEX MACRO      *** 10900042
         SPACE                                                          10950042
         MACRO                                                          11000042
         HEX                                                            11050042
.*                            THIS MACRO FACILITATES GENERATION OF THE  11100042
.*                                 TABLE ENTRIES SPECIFYING HEX TYPE    11150042
.*                                 CONVERSIONS.                         11200042
.*                            &SYSLIST(&OP,1) - NAME OF DATA ITEM TO BE 11250042
.*                                 CONVERTED                            11300042
.*                            &SYSLIST(&OP,2) - # OF SPACES TO SKIP ON  11350042
.*                                 MULTIPLE PRINT OR NBR OF SPACES TO   11400042
.*                                 BACK UP FROM COLUMN FOR START OF     11450042
.*                                 PRINTING. THE LETTER B PRECEEDS THE  11500042
.*                                 NUMBER (B8) IF THE LATTER OPTION IS  11550042
.*                                 DESIRED. OMISSION OF THIS OPERAND    11600042
.*                                 FORCES OPTION 2 WITH BACKUP SPACING  11650042
.*                                 EQUAL TO THE NUMBER OF BYTES SPECI-  11700042
.*                                 FIED BY THE NEXT OPERAND (TWICE THIS 11750042
.*                                 NUMBER IF SUFFIX IS EXPLICITLY OR    11800042
.*                                 IMPLICITLY B).                       11850042
.*                            &SYSLIST(&OP,3) - NUMBER OF BYTES TO      11900042
.*                                 PROCESS. THIS NUMBER IS SUFFIXED     11950042
.*                                 WITH AN L,R, OR B TO STIPULATE       12000042
.*                                 PRINTING OF THE LEFT HALF, RIGHT     12050042
.*                                 HALF, OR BOTH HALVES OF THE BYTE     12100042
.*                                 RESPECTIVELY. OMISSION OF THIS       12150042
.*                                 OPERAND DEFAULTS TO B WITH THE NUM-  12200042
.*                                 BER OF BYTES EQUAL TO THE ITEM LNGTH 12250042
.*                            A NEW ENTRY IS GENERATED ONLY WHEN NECES- 12300042
.*                                 SARY. THIS MACRO MUST BE THE FIRST   12350042
.*                                 MACRO INSTRUCTION ISSUED FOR THE     12400042
.*                                 SUBJECT LINE(S).                     12450042
         GBLA  &BITS(3000),&ITEMNBR,&SHIFT(3000),&NRENTS                12500042
         GBLC  &ITEM(3000),&DSECT                                       12550042
         GBLA  &INITIAL                                                 12600042
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN                               12650042
         LCLB  &B,&SUB                                                  12700042
         LCLA  &IBITS,&NDX,&ISHIFT,&K,&T,&CODE,&BYTESP,&OP              12750042
         LCLC  &S,&LETTER                                               12800042
         ACTR  500000                                                   12850042
         AIF   (&DIAGTST EQ 0).NOMSG                                    12900042
         AIF   (&INITIAL EQ 0).NOMSG                                    12950042
         AIF   (&DIAGLIN EQ 1).NOMSG                                    13000042
         MNOTE '**NO LINE ASSOCIATED WITH THIS DATA**'                  13050042
*****THE FOLLOWING GENERATED FOR TEST PURPOSES*****                     13100042
*        LINE                                                           13150042
         LINE                                                           13200042
.NOMSG   ANOP                                                           13250042
         AIF   (K'&SYSLIST(1) EQ K'&SYSLIST(1,1)).LOOP                  13300042
&SUB     SETB  1                                                        13350042
.LOOP    ANOP                                                           13400042
&OP      SETA  &OP+1                                                    13450042
.LOOP1   ANOP                                                           13500042
&NDX     SETA  &NDX+1                                                   13550042
         AIF   ('&ITEM(&NDX)' EQ '&SYSLIST(&OP,1)').FOUND               13600042
         AIF   (&NDX LT &ITEMNBR).LOOP1                                 13650042
         MNOTE '**LOG ITEM NOT DEFINED**'                               13700042
         MEXIT                                                          13750042
.FOUND   ANOP                                                           13800042
&ISHIFT  SETA  &SHIFT(&NDX)                                             13850042
&IBITS   SETA  &BITS(&NDX)                                              13900042
         AIF   (&ISHIFT EQ 0 OR &ISHIFT EQ 4).ALIGN                     13950042
.ERR     MNOTE '**DATA NOT ALLIGNED ON HEX OR BYTE BOUNDARY**'          14000042
         MEXIT                                                          14050042
.ALIGN   ANOP                                                           14100042
&CODE    SETA  1                                                        14150042
         AIF   (&SUB EQ 1).SUBA                                         14200042
&K       SETA  K'&SYSLIST(3)                                            14250042
         AGO   .SUBB                                                    14300042
.SUBA    ANOP                                                           14350042
&K       SETA  K'&SYSLIST(&OP,3)                                        14400042
.SUBB    ANOP                                                           14450042
         AIF   (&K EQ 1).ERR3                                           14500042
         AIF   (&IBITS-(&IBITS/4)*4 EQ 0).OK                            14550042
         MNOTE '**BIT LENGTH SPECIFICATION INCONSISTENT WITH CONTROL**' 14600042
         MEXIT                                                          14650042
.OK      AIF   (&SUB EQ 1).SUBC                                         14700042
         AIF   ('&SYSLIST(3)' EQ '').USEDEFN                            14750042
&LETTER  SETC  '&SYSLIST(3)'(&K,1)                                      14800042
&S       SETC  '&SYSLIST(3)'(1,&K-1)                                    14850042
         AGO   .SUBD                                                    14900042
.SUBC    ANOP                                                           14950042
         AIF   ('&SYSLIST(&OP,3)' EQ '').USEDEFN                        15000042
&LETTER  SETC  '&SYSLIST(&OP,3)'(&K,1)                                  15050042
&S       SETC  '&SYSLIST(&OP,3)'(1,&K-1)                                15100042
.SUBD    ANOP                                                           15150042
&BYTESP  SETA  &S                                                       15200042
         AIF   ('&LETTER' EQ 'B').BOTH                                  15250042
         AIF   ('&LETTER' EQ 'L').LEFT                                  15300042
         AIF   ('&LETTER' EQ 'R').RIGHT                                 15350042
.ERR3    MNOTE '**PARAMETER 3 INCOMPLETE-DSGEN DEFINITION USED**'       15400042
         AGO   .USEDEFN                                                 15450042
.RIGHT   ANOP                                                           15500042
&CODE    SETA  2                                                        15550042
         AGO   .L                                                       15600042
.LEFT    ANOP                                                           15650042
&CODE    SETA  1                                                        15700042
         AGO   .L                                                       15750042
.USEDEFN ANOP                                                           15800042
&BYTESP  SETA  &IBITS/8                                                 15850042
.BOTH    AIF   (&ISHIFT NE 0).ERR                                       15900042
&CODE    SETA  3                                                        15950042
&T       SETA  &BYTESP*2-1                                              16000042
&S       SETC  '&T'                                                     16050042
.OK2     AIF   (&ISHIFT EQ 0).L                                         16100042
&CODE    SETA  2                                                        16150042
.L       ANOP                                                           16200042
&B       SETB  1                                                        16250042
         AIF   (&SUB EQ 1).SUBE                                         16300042
         AIF   ('&SYSLIST(2)' EQ '').BACKUP                             16350042
&K       SETA  K'&SYSLIST(2)                                            16400042
&B       SETB  ('&SYSLIST(2)'(1,1) EQ 'B')                              16450042
&S       SETC  '&SYSLIST(2)'(&B+1,&K-&B)                                16500042
         AGO   .SUBF                                                    16550042
.SUBE    ANOP                                                           16600042
         AIF   ('&SYSLIST(&OP,2)' EQ '').BACKUP                         16650042
&K       SETA  K'&SYSLIST(&OP,2)                                        16700042
&B       SETB  ('&SYSLIST(&OP,2)'(1,1) EQ 'B')                          16750042
&S       SETC  '&SYSLIST(&OP,2)'(&B+1,&K-&B)                            16800042
.SUBF    ANOP                                                           16850042
.BACKUP  ANOP                                                           16900042
&NRENTS  SETA  &NRENTS+1                                                16950042
         AIF   (&BYTESP GT 0 AND &BYTESP LT 16).SUB0                    17000042
         MNOTE '**NO. OF BYTES OUTSIDE RANGE OF 1-15**'                 17050042
         MEXIT                                                          17100042
.SUB0    AIF   (&SUB EQ 1).SUBG                                         17150042
         DC    AL.12(&SYSLIST(1)-&DSECT),XL.4'A'                        17200042
         AGO   .SUBH                                                    17250042
.SUBG    ANOP                                                           17300042
         DC    AL.12(&SYSLIST(&OP,1)-&DSECT),XL.4'A'                    17350042
.SUBH    ANOP                                                           17400042
         DC    BL.1'&B',FL.7'&S',AL.4(&BYTESP),FL.4'&CODE'              17450042
.OUT     ANOP                                                           17500042
&NDX     SETA  0                                                        17550042
         AIF   (&SUB EQ 0).OUTA                                         17600042
         AIF   (&OP LT N'&SYSLIST).LOOP                                 17650042
.OUTA    ANOP                                                           17700042
         MEND                                                           17750042
         EJECT                                                          17800042
***  LINE MACRO      LINE MACRO      LINE MACRO      LINE MACRO     *** 17850042
         SPACE                                                          17900042
         MACRO                                                          17950042
&NAME    LINE  &DATA,&LABEL,&SKIP=                                      18000042
.*                            THIS MACRO ESTABLISHES THE MARGINS OR     18050042
.*                                 COLUMN SETTINGS FOR EACH LINE. IT    18100042
.*                                 GENERATES NECESSARY CARRIAGE CONTROL 18150042
.*                                 ENTRIES. LASTLY IT DETERMINES THE    18200042
.*                                 NUMBER OF ENTRIES ASSOCIATED WITH    18250042
.*                                 THE PREVIOUS LINE AND STORES THAT #  18300042
.*                                 INTO THE APPROPRIATE BYTE.           18350042
.*                            &DATA(1) - CHARACTER POSITION TO BEGIN    18400042
.*                                 DATA.                                18450042
.*                            &DATA(2) - # OF SPACES BETWEEN SUCCESSIVE 18500042
.*                                 DATA COLUMN STARTING CHARACTERS.     18550042
.*                            &LABEL(1) - CHAR. POS. TO BEGIN LABELS.   18600042
.*                            &LABEL(2) - # SPACES BETWEEN LINE'S LABEL 18650042
.*                                 STARTING CHARACTERS.                 18700042
.*                            &SKIP= - # OF LINES TO ADVANCE CARRIAGE   18750042
.*                                 TO BEGIN NEXT PRINTED LINE.          18800042
.*                            NEW ENTRIES ARE GENERATED ONLY WHEN       18850042
.*                                 NECESSARY. OMISSION OF ITEMS MEANS   18900042
.*                                 THEY HAVE NOT CHANGED SINCE PREVIOUS 18950042
.*                                 SETTINGS. A LINE MACRO IS REQUIRED   19000042
.*                                 FOR EACH PRINTED LINE. IF NO SETTING 19050042
.*                                 CHANGES ARE REQUIRED ALL OPERANDS    19100042
.*                                 ARE OMITTED IN WHICH CASE ONLY THE   19150042
.*                                 # OF ENTRIES FOR THE PREVIOUS LINE   19200042
.*                                 IS COMPUTED. THIS MACRO MUST BE THE  19250042
.*                                 FIRST MACRO INSTRUCTION ISSUED FOR   19300042
.*                                 THE SUBJECT LINE                     19350042
         GBLA  &DB,&DT,&LB,&LT,&NRENTS                                  19400042
         GBLA  &LASTCC,&INITIAL                                         19450042
         GBLC  &NRENTSX                                                 19500042
         GBLC  &CARRCON                                                 19550042
         GBLB  &TEST                                                    19600042
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN                               19650042
         LCLA  &S                                                       19700042
         AIF   (&INITIAL EQ 0 OR &DIAGTST EQ 0).DIAGSET                 19750042
         AIF   (&DIAGSET EQ 0).DIAGSET                                  19800042
         MNOTE '**NO LABEL ASSOCIATED WITH LAST SET**'                  19850042
***** THE FOLLOWING GENERATED FOR TEST PURPOSES *****                   19900042
*        LABEL '%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%'       19950042
               LABEL '%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%' 20000042
.DIAGSET ANOP                                                           20050042
&DIAGSET SETB  1                                                        20100042
&DIAGLIN SETB  1                                                        20150042
&NAME    DS    0C                                                       20200042
         AIF   (&INITIAL EQ 0).FIRSTLN                                  20250042
         LINEND                                                         20300042
         AGO   .NTFIRST                                                 20350042
.FIRSTLN ANOP                                                           20400042
&NRENTSX SETC  'N&SYSNDX'                                               20450042
&INITIAL SETA  1                                                        20500042
N&SYSNDX EQU   *                                                        20550042
.NTFIRST ANOP                                                           20600042
         DC    AL1(0)                                                   20650042
         AIF   ('&DATA(1)' EQ '').CKDTABS                               20700042
         AIF   (&DATA(1) EQ &DB).CKDTABS                                20750042
&DB      SETA  &DATA(1)                                                 20800042
         AGO   .AA                                                      20850042
.CKDTABS AIF   ('&DATA(2)' EQ '').NCDATA                                20900042
         AIF   (&DATA(2) EQ &DT).NCDATA                                 20950042
         AGO   .CC                                                      21000042
.AA      AIF   ('&DATA(2)' EQ '').BB                                    21050042
         AIF   (&DATA(2) EQ &DT).BB                                     21100042
.CC      ANOP                                                           21150042
&DT      SETA  &DATA(2)                                                 21200042
.BB      DC    XL2'FFFE'                                                21250042
         DC    FL1'&DB'                                                 21300042
         DC    FL1'&DT'                                                 21350042
&NRENTS  SETA  &NRENTS+1                                                21400042
.NCDATA  ANOP                                                           21450042
         AIF   ('&LABEL(1)' EQ '').CKLTABS                              21500042
         AIF   (&LABEL(1) EQ &LB).CKLTABS                               21550042
&LB      SETA  &LABEL(1)                                                21600042
         AGO   .AAA                                                     21650042
.CKLTABS AIF   ('&LABEL(2)' EQ '').NCLABEL                              21700042
         AIF   (&LABEL(2) EQ &LT).NCLABEL                               21750042
         AGO   .CCC                                                     21800042
.AAA     AIF   ('&LABEL(2)' EQ '').BBB                                  21850042
         AIF   (&LABEL(2) EQ &LT).BBB                                   21900042
.CCC     ANOP                                                           21950042
&LT      SETA  &LABEL(2)                                                22000042
.BBB     DC    XL2'FFFF'                                                22050042
         DC    FL1'&LB'                                                 22100042
         DC    FL1'&LT'                                                 22150042
&NRENTS  SETA  &NRENTS+1                                                22200042
.NCLABEL ANOP                                                           22250042
         AIF   ('&SKIP' NE '').CONT                                     22300042
         AIF   (&TEST EQ 0).NOCHANG                                     22350042
         AGO   .DEFALTA                                                 22400042
.CONT    ANOP                                                           22450042
         AIF   (&TEST EQ 0).AB                                          22500042
         AIF   ('&SKIP' EQ 'E').AB                                      22550042
&S       SETA  &SKIP                                                    22600042
.DEFAULT ANOP                                                           22650042
         AIF   (&SKIP EQ &LASTCC).DEFALTA                               22700042
         ORG   &CARRCON+3                                               22750042
         DC    AL.3(0),AL.2(&S),AL.3(1)                                 22800042
         ORG                                                            22850042
&LASTCC  SETA  &S                                                       22900042
.DEFALTA ANOP                                                           22950042
&TEST    SETB  0                                                        23000042
         AGO   .DD                                                      23050042
.AB      AIF   ('&SKIP' NE 'E').ABB                                     23100042
A&SYSNDX DC    X'FFFB8B00'              EJECT                           23150042
         AGO   .ABC                                                     23200042
.ABB     AIF   (&SKIP EQ &LASTCC).NOCHANG                               23250042
A&SYSNDX DC    XL2'FFFB'                                                23300042
         DC    AL.3(0),AL.2(&SKIP),AL.3(1)                              23350042
         DC    AL.3(0),AL.2(&SKIP),AL.3(1)                              23400042
&LASTCC  SETA  &SKIP                                                    23450042
&TEST    SETB  1                                                        23500042
.ABC     ANOP                                                           23550042
&CARRCON SETC  'A&SYSNDX'                                               23600042
&NRENTS  SETA  &NRENTS+1                                                23650042
.DD      ANOP                                                           23700042
.NOCHANG ANOP                                                           23750042
         MEND                                                           23800042
         SPACE 3                                                        23850042
***  ROUTINE MACRO   ROUTINE MACRO   ROUTINE MACRO   ROUTINE MACRO  *** 23900042
         SPACE                                                          23950042
         MACRO                                                          24000042
&NAME    ROUTINE &LOGITEM,&RNAME                                        24050042
         GBLA  &NRENTS                                                  24100042
         GBLC  &DSECT,&CSECT                                            24150042
         GBLA  &INITIAL                                                 24200042
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN                               24250042
         AIF   (&DIAGTST EQ 0).NOMSG                                    24300042
         AIF   (&INITIAL EQ 0).NOMSG                                    24350042
         AIF   (&DIAGLIN EQ 1).NOMSG                                    24400042
         MNOTE '**NO LINE ASSOCIATED WITH THIS ROUTINE**'               24450042
*****THE FOLLOWING GENERATED FOR TEST PURPOSES*****                     24500042
*        LINE                                                           24550042
         LINE                                                           24600042
.NOMSG   ANOP                                                           24650042
&NAME    DC    AL.12(&LOGITEM-&DSECT),XL.4'D'                           24700042
         DC    AL2(&RNAME-&CSECT)                                       24750042
&NRENTS  SETA  &NRENTS+1                                                24800042
         MEND                                                           24850042
         EJECT                                                          24900042
***  LABEL MACRO     LABEL MACRO     LABEL MACRO     LABEL MACRO    *** 24950042
         SPACE                                                          25000042
         MACRO                                                          25050042
&NAME    LABEL &LABEL1,&LABEL2,&LABEL3,&LABEL4,&LABEL5,&LABEL6,        C25100042
               &LABEL7,&LABEL8                                          25150042
.*                                 THIS MACRO ALLOWS LABELS TO          25200042
.*                                 BE SPECIFIED FOR A GIVEN LINE. THE   25250042
.*                                 LABELS SHOULD BE ENCLOSED IN QUOTA-  25300042
.*                                 TION MARKS. THE COLUMN AND LINE END  25350042
.*                                 CONTROLS WILL BE INSERTED BY THE     25400042
.*                                 MACRO. OMITTED OPERANDS MEAN NO      25450042
.*                                 LABEL REQUIRED FOR RESPECTIVE        25500042
.*                                 COLUMN.                              25550042
         GBLC &LABELS(2000)                                             25600042
         GBLC  &LBL(100)                                                25650042
         GBLA  &LBLCTR(100)                                             25700042
         GBLA  &LABELNR                                                 25750042
         GBLA  &NRENTS,&LPTR,&INITIAL                                   25800042
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN                               25850042
         LCLC  &MARGIN,&TACK                                            25900042
         LCLC  &TEXT                                                    25950042
         LCLA  &OP,&K,&START,&NRCHAR,&REMAIN                            26000042
         AIF   (&INITIAL EQ 0).DIAGCLR                                  26050042
         AIF   (&DIAGTST EQ 0).DIAGCLR                                  26100042
         AIF   (&DIAGLIN EQ 1).DIAGCLR                                  26150042
         MNOTE '**NO LINE ASSOCIATED WITH PREVIOUS LABEL**'             26200042
***** THE FOLLOWING GENERATED FOR TEST PURPOSES *****                   26250042
*        LINE                                                           26300042
         LINE                                                           26350042
.DIAGCLR ANOP                                                           26400042
&DIAGSET SETB  0                                                        26450042
&DIAGLIN SETB  0                                                        26500042
&MARGIN  SETC  '*'                                                      26550042
         AIF   ('&NAME' EQ '').LOOPOUT                                  26600042
&LPTR    SETA  &LPTR+1                                                  26650042
&LBL(&LPTR) SETC '&NAME'                                                26700042
&LBLCTR(&LPTR) SETA &LABELNR+1                                          26750042
.LOOPOUT ANOP                                                           26800042
&OP      SETA  &OP+1                                                    26850042
&K       SETA  K'&SYSLIST(&OP)                                          26900042
         AIF (&K GE 2).NORM                                             26950042
&K       SETA  2                                                        27000042
.NORM    ANOP                                                           27050042
&START   SETA  2                                                        27100042
         AIF (&OP LT N'&SYSLIST).NOTLAST                                27150042
&MARGIN  SETC  '$'                                                      27200042
.NOTLAST ANOP                                                           27250042
&NRCHAR  SETA  8                                                        27300042
&TACK    SETC  ''                                                       27350042
.LOOPIN  ANOP                                                           27400042
&REMAIN  SETA  &K-&START                                                27450042
         AIF (&REMAIN GE 8).MORE                                        27500042
&TACK    SETC  '&MARGIN'                                                27550042
&NRCHAR  SETA  &REMAIN                                                  27600042
.MORE    ANOP                                                           27650042
&TEXT    SETC  ''                                                       27700042
         AIF (&REMAIN EQ 0).ENDTEXT                                     27750042
&TEXT    SETC  '&SYSLIST(&OP)'(&START,&NRCHAR)                          27800042
.ENDTEXT ANOP                                                           27850042
&LABELNR SETA  &LABELNR+1                                               27900042
&LABELS(&LABELNR) SETC '&TEXT'.'&TACK'                                  27950042
&START   SETA  &START+8                                                 28000042
         AIF ('&TACK' EQ '').LOOPIN                                     28050042
         AIF ('&TACK' EQ '*').LOOPOUT                                   28100042
         MEND                                                           28150042
         EJECT                                                          28200042
***  LSTART MACRO    LSTART MACRO    LSTART MACRO    LSTART MACRO   *** 28250042
         SPACE                                                          28300042
         MACRO                                                          28350042
         LSTART                                                         28400042
.*                            THIS MACRO IS ISSUED WHEN THE LABEL AREA  28450042
.*                                 OF THE TABLE IS TO BEGIN.            28500042
         GBLA  &LABELNR                                                 28550042
         GBLC  &LBL(100)                                                28600042
         GBLC &LABELS(2000)                                             28650042
         GBLA  &LBLCTR(100)                                             28700042
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN                               28750042
         LCLA  &NDX,&CTR                                                28800042
         AIF   (&DIAGTST EQ 0).NODIAG                                   28850042
         AIF   (&DIAGSET EQ 0).NODIAG                                   28900042
         MNOTE '**NO LABEL ASSOCIATED WITH LAST SET**'                  28950042
***** THE FOLLOWING GENERATED FOR TEST PURPOSES *****                   29000042
*        LABEL '%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%'       29050042
               LABEL '%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%' 29100042
.NODIAG  ANOP                                                           29150042
         LINEND                                                         29200042
&CTR     SETA  1                                                        29250042
.LOOP    ANOP                                                           29300042
&NDX     SETA  &NDX+1                                                   29350042
         AIF   (&LBLCTR(&CTR) NE &NDX).NOLBL                            29400042
&LBL(&CTR) DC  C'&LABELS(&NDX)'                                         29450042
&CTR     SETA  &CTR+1                                                   29500042
         AGO   .LOOPCTL                                                 29550042
.NOLBL   ANOP                                                           29600042
         DC    C'&LABELS(&NDX)'                                         29650042
.LOOPCTL AIF   (&NDX LT &LABELNR).LOOP                                  29700042
         MEND                                                           29750042
         SPACE 3                                                        29800042
***  LINEND MACRO    LINEND MACRO    LINEND MACRO    LINEND MACRO   *** 29850042
         SPACE                                                          29900042
         MACRO                                                          29950042
         LINEND                                                         30000042
.*                            THIS MACRO IS USED ONLY BY THE LINE       30050042
.*                                 MACRO TO SET THE NUMBER OF ENTRIES   30100042
.*                                 ASSOCIATED WITH EACH LINE.           30150042
         GBLA  &NRENTS                                                  30200042
         GBLC &NRENTSX                                                  30250042
         AIF   (&NRENTS EQ 0).NORENTS   TEST FOR NO COUNT               30300042
         ORG   &NRENTSX                                                 30350042
         DC    FL1'&NRENTS'                                             30400042
         ORG                                                            30450042
&NRENTS  SETA  0                                                        30500042
.NORENTS ANOP                                                           30550042
B&SYSNDX EQU   *                                                        30600042
&NRENTSX SETC  'B&SYSNDX'                                               30650042
         MEND                                                           30700042
         EJECT                                                          30750042
***  SUM MACRO       SUM MACRO       SUM MACRO       SUM MACRO      *** 30800042
         SPACE                                                          30850042
         MACRO                                                          30900042
         SUM   &LOGITEM,&MASK                                           30950042
.*                            THIS MACRO GENERATES A NORMAL EDIT ENTRY  31000042
.*                                 FOR PROCESSING BY THE SUMMARY MODULE 31050042
.*                            &LOGITEM - NAME OF DATA ITEM TO BE SUMMED 31100042
.*                            &MASK - BYTE MASK FOR BITS TO BE TESTED.  31150042
.*                                 THIS OPERAND SHOULD BE OMITTED FOR   31200042
.*                                 SINGLE BIT ITEMS IN WHICH CASE THE   31250042
.*                                 MASK WILL BE SET ACCORDING TO THE    31300042
.*                                 OFF BYTE BIT DISPLACEMENT OF THE     31350042
.*                                 ITEM AS DEFINED BY THE MACRO 'DSGEN' 31400042
         GBLA  &COUNTR,&ITEMNBR,&BITS(3000),&SHIFT(3000)                31450042
         GBLC  &ITEM(3000),&DSECT                                       31500042
         LCLA  &IBITS,&NDX,&ISHIFT,&M,&BITNBR                           31550042
.LOOP    ANOP                                                           31600042
&NDX     SETA  &NDX+1                                                   31650042
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      31700042
         AIF   (&NDX LT &ITEMNBR).LOOP                                  31750042
         MNOTE *,'LOGITEM NOT FOUND'                                    31800042
         MEXIT                                                          31850042
.FOUND   ANOP                                                           31900042
&ISHIFT  SETA  &SHIFT(&NDX)                                             31950042
&IBITS   SETA  &BITS(&NDX)                                              32000042
         AIF   (&IBITS EQ 1).FORM1      TEST FOR OLD FORM               32050042
         AIF   ('&MASK' NE '').FORM1    TEST FOR MASK                   32100042
         AIF   (&IBITS+&ISHIFT GT 8).MSG     TEST FOR MORE THAN EIGHT   32150042
         DC    AL.1(0),AL.3(&ISHIFT),AL.4(&IBITS)                       32200042
         DC    AL1(0)                                                   32250042
         AGO   .ITEM                                                    32300042
.MSG     MNOTE '**BITS GREATER THAN 8**'                                32350042
         MEXIT                                                          32400042
.FORM1   ANOP                                                           32450042
         DC    AL1(0)                                                   32500042
         AIF   ('&MASK' EQ '').FORM                                     32550042
         DC    B'&MASK'                                                 32600042
         AGO   .ITEM                                                    32650042
.FORM    ANOP                                                           32700042
&BITNBR  SETA  &ISHIFT-7                                                32750042
&BITNBR  SETA  0-&BITNBR                                                32800042
&M       SETA  1                                                        32850042
.LOOP2   ANOP                                                           32900042
         AIF   (&BITNBR EQ 0).GOTIT                                     32950042
&M       SETA  &M*2                                                     33000042
&BITNBR  SETA  &BITNBR-1                                                33050042
         AGO   .LOOP2                                                   33100042
.GOTIT   ANOP                                                           33150042
         DC    AL1(&M)                                                  33200042
.ITEM    DC    AL2(&LOGITEM-&DSECT)                                     33250042
         DC    AL2(&COUNTR)                                             33300042
&COUNTR  SETA  &COUNTR+1                                                33350042
         MEND                                                           33400042
         SPACE 3                                                        33450042
***  SPECIAL MACRO   SPECIAL MACRO   SPECIAL MACRO   SPECIAL MACRO  *** 33500042
         SPACE                                                          33550042
         MACRO                                                          33600042
         SPECIAL &ROUTINE,&PARAM,&SPACE=                                33650042
.*                            THIS MACRO GENERATES A SPECIAL ROUTINE    33700042
.*                                 ENTRY TO BE PROCESSED BY THE SUM. M. 33750042
.*                            &ROUTINE - SYMBOL ON SPECIAL ROUTINE EWT. 33800042
.*                            &PARAM - AN 8 BIT BINARY REPRESENTATION   33850042
.*                                 TO OCCUPY THE 'MASK' FIELD BUT TO BE 33900042
.*                                 INTERPRETED AS AN ARGUMENT OF THE    33950042
.*                                 SPECIAL ROUTINE.                     34000042
.*                            &SPACE - THE NUMBER OF 2BYTE COUNTERS TO  34050042
.*                                 ALLOCATE FOR REQUIRED PROCESSING.    34100042
         GBLC  &CSECT                                                   34150042
         GBLA  &COUNTR                                                  34200042
         LCLA  &ADD                                                     34250042
         DC    AL1(128)                                                 34300042
         DC    BL.8'&PARAM'                                             34350042
         DC    AL2(&ROUTINE-&CSECT)                                     34400042
         DC    AL2(&COUNTR)                                             34450042
&ADD     SETA  1                                                        34500042
         AIF   ('&SPACE' EQ '').NORM                                    34550042
&ADD     SETA  &SPACE                                                   34600042
.NORM    ANOP                                                           34650042
&COUNTR  SETA  &COUNTR+&ADD                                             34700042
         MEND                                                           34750042
         EJECT                                                          34800042
         GBLC  &DSECT,&CSECT                                            34850042
&CSECT   SETC  'IFCSAXXC'                                               34900042
&DSECT   SETC  'S3340'                                                  34950042
         SPACE                                                          35000042
IFCSAXXC CSECT                                                          35050042
         SPACE                                                          35100042
*                                                                       35150042
*      THE FOLLOWING DSECT DESCRIBES THE HEADER FOR AN OBR OR MDR REC.  35200042
*                                                                       35250042
         SPACE                                                          35300042
S3340    DSECT                                                          35350042
         SPACE                                                          35400042
         DSGEN (CLASRC,8),(SYSREL,8),(SWITCHES,8),(SW1,8)               35450042
         DSGEN (RECID,8),(SW2,8),(RECNT,8),(SPARE1,8)                   35500042
         DSGEN (DAY,32),(HOUR,32)                                       35550042
         DSGEN (SPARE2,8),(CPUSERL,24),(CPUID,16),(MCEL,16)             35600042
         SPACE 2                                                        35650042
*                                                                       35700042
*      THE FOLLOWING DESCRIBES AN OBR(UNIT CHECK) RECORD                35750042
*                                                                       35800042
         SPACE                                                          35850042
         DSGEN (JOBID,64),(FAILCCW,64),(CSW,64)                         35900042
         DSGEN (DDCNT,8),(SECUA,24),(DEVTYP1,16),(DEVTYP2,16)           35950042
         DSGEN (SDRCNT,8),(CUA,24),(IORET,16),(SNSCT,16)                36000042
         DSGEN (VOLID,48),(SPARE3,16)                                   36050042
         DSGEN (LASTSK,64),(HOMADR,32),(SPARE4,32)                      36100042
         DSGEN (SNB,1,0,23,0,7)                                         36150042
         SPACE 4                                                        36200042
*                                                                       36250042
*      THE FOLLOWING DESCRIBES AN MDR RECROD                            36300042
*                                                                       36350042
         SPACE                                                          36400042
         ORG   JOBID                                                    36450042
         SPACE                                                          36500042
         DSGEN (MCUA,16),(MVOLID,48)                                    36550042
         DSGEN (MSNB,1,0,23,0,7)                                        36600042
         EJECT                                                          36650042
IFCSAXXC CSECT                                                          36700042
         SPACE                                                          36750042
         USING S3340,R2                                                 36800042
         USING *,R9                                                     36850042
         SPACE                                                          36900042
         DC    A(ENTRIES)                                               36950042
         DC    A(PEDIT)                                                 37000042
REG8     DC    F'0'                                                     37050042
SCSIZE   DC    H'1975'                                         @Z427VLS 37100042
         SPACE                                                          37150042
*********************************************************************** 37200042
*                                                                     * 37250042
*      THIS ENTIRE MODULE IN SUPPORT OF XL03130                       * 37300042
*                                                                     * 37350042
*********************************************************************** 37400042
         SPACE 3                                                        37450042
R0       EQU   0                       R                                37500042
R1       EQU   1                        E                               37550042
R2       EQU   2                         G                              37600042
R3       EQU   3                          I                             37650042
R4       EQU   4                           S                            37700042
R5       EQU   5                            T                           37750042
R6       EQU   6                             E                          37800042
R7       EQU   7                              R                         37850042
R8       EQU   8                                                        37900042
R9       EQU   9                                E                       37950042
R10      EQU   10                                Q                      38000042
R11      EQU   11                                 U                     38050042
R12      EQU   12                                  A                    38100042
R13      EQU   13                                   T                   38150042
R14      EQU   14                                    E                  38200042
R15      EQU   15                                     S                 38250042
         EJECT                                                          38300042
L0       EQU   0                       EQUATES                          38350042
L1       EQU   1                                                        38400042
L2       EQU   2                                                        38450042
L3       EQU   3                          FOR                           38500042
L4       EQU   4                                                        38550042
L5       EQU   5                                                        38600042
L6       EQU   6                              LENGTHS                   38650042
L7       EQU   7                                                        38700042
L8       EQU   8                                                        38750042
L9       EQU   9                                 AND                    38800042
L10      EQU   10                                                       38850042
L11      EQU   11                                                       38900042
L12      EQU   12                                   DISPLACEMENTS       38950042
L13      EQU   13                                                       39000042
L14      EQU   14                                                       39050042
L15      EQU   15                                                       39100042
L16      EQU   16                                                       39150042
L17      EQU   17                                                       39200042
L18      EQU   18                                                       39250042
L19      EQU   19                                                       39300042
L20      EQU   20                                                       39350042
L21      EQU   21                                                       39400042
L23      EQU   23                                                       39450042
L24      EQU   24                                              @Z40NIVS 39460042
L25      EQU   25                                              @Z40NIVS 39470042
L26      EQU   26                                                       39500042
L27      EQU   27                                              @Z40NIVS 39520042
L28      EQU   28                                                       39550042
L29      EQU   29                                                       39600042
L42      EQU   42                                              @Z427VLS 39610042
L40      EQU   40                                              @Z427VLS 39620042
L46      EQU   46                                                       39650042
L47      EQU   47                                              @Z40NIVS 39652042
L48      EQU   48                                              @Z40NIVS 39654042
L49      EQU   49                                              @Z40NIVS 39656042
L50      EQU   50                                              @Z40NIVS 39658042
L432     EQU   432                                             @Z40NIVS 39660042
L459     EQU   459                                             @Z40NIVS 39662042
L1409    EQU   1409                                            @Z40NIVS 39664042
         SPACE 2                                               @Z40NIVS 39666042
COLON    EQU   C':'                                            @Z40NIVS 39668042
BASEDISP EQU   X'FD'                                           @Z40NIVS 39670042
BLANK    EQU   C' '                                            @Z40NIVS 39672042
SORTFLG  EQU   X'80'                                           @Z40NIVS 39674042
SLASH    EQU   C'/'                                            @Z40NIVS 39676042
ONE      EQU   1                                               @Z40NIVS 39678042
TWO      EQU   2                                               @Z40NIVS 39680042
THREE    EQU   3                                               @Z40NIVS 39682042
FOUR     EQU   4                                               @Z40NIVS 39684042
FIVE     EQU   5                                               @Z40NIVS 39686042
         SPACE 2                                                        39700042
H01      EQU   X'01'                                                    39750042
H10      EQU   X'10'                                                    39800042
H30      EQU   X'30'                                                    39850042
H40      EQU   X'40'                                                    39900042
H50      EQU   X'50'                                                    39950042
H80      EQU   X'80'                                                    40000042
H90      EQU   X'90'                                                    40050042
HE0      EQU   X'E0'                                                    40100042
CLRSGN   EQU   X'F0'                                                    40150042
NOCARRY  EQU   12                      COND CODE AFTER 'AL'= NO         40200042
*                                       CARRY(OVERFLOW) INTO BIT POS 32 40250042
         EJECT                                                          40300042
*********************************************************************** 40350042
*                                                                     * 40400042
*      ALL THE FOLLOWING ROUTINES ARE EXECUTED,VIA THE                * 40450042
*                                                                     * 40500042
*        'SPECIAL' MACRO,TO KEEP COUNTS AND INFORMATION FOR ANY       * 40550042
*                                                                     * 40600042
**    ONE C.U. SUBSYSTEM  NOTE: R3-PTR TO COUNTER              @Z40NIVS 40650042
*                                                                     * 40700042
*********************************************************************** 40750042
         SPACE 3                                                        40800042
*                                                                       40850042
*      THE FOLLOWING DETERMINES HIGH AND LOW DATE FOR THIS SUMMARY      40900042
*                                                                       40950042
XDATE1   STM   R5,R8,XSAVE1            SAVE REGS                        41000042
         CLC   DAY(L4),ZERO            IS DATE ZERO                     41050042
         BE    RETURN1                 YES - RETURN                     41100042
         CLC   L0(L4,R3),ZERO          IS LOW-DATE-COUNTER ZERO         41150042
         BNE   XDATE2                  NO - BR TO CK                    41200042
         MVC   L0(L4,R3),DAY           MOVE DATE TO LOW-DATE-COUNTER    41250042
         SPACE                                                          41300042
XDATE2   CLC   DAY(L4),L0(R3)          IS DATE LOWER THEN LOW-DATE-CTR  41350042
         BL    SAVELOW                 YES - BR TO MOVE LOW DATE        41400042
         SPACE                                                          41450042
         CLC   DAY(L4),L4(R3)          IS DATE HIGHER THEN HIGH-DATE-CT 41500042
         BNH   RETURN1                 NO - RETURN                      41550042
         MVC   L4(L4,R3),DAY           MOVE HIGH DATE TO CTR            41600042
         B     RETURN1                 RETURN                           41650042
         SPACE                                                          41700042
SAVELOW  MVC   L0(L4,R3),DAY           MOVE LOWER DATE TO LOW-DATE-CNTR 41750042
         B     RETURN1                 RETURN                           41800042
         EJECT                                                          41850042
*                                                                       41900042
*      THE FOLLOWING CHECKS THE TYPE OF RECORD,SAVES THE RECORD TYPE    41950042
*        AND DEVICE TYPE,AND SETS POINTERS TO BRANCH AROUND SOME        42000042
*        'SPECIAL' ROUTINES IF THIS IS AN MDR RECORD.                   42050042
*                                                                       42100042
ISMDR    STM   R5,R8,XSAVE1            SAVE REGS                        42150042
         SR    R6,R6                   CLEAR                            42200042
         SR    R8,R8                         REGS                       42250042
         USING SUMRECT,R3          GET ADDRESSABILITY          @Z40NIVS 42253042
         LA    R5,TVOLID1          PNT TO VOLID1 SUM AREA      @Z40NIVS 42256042
         ST    R5,VOLPTR           SAVE PNT TO VOLID1          @Z40NIVS 42259042
         LA    R5,FLTSYM1          PNT TO FLT SUM AREA         @Z40NIVS 42262042
         ST    R5,FLTPTR           SAVE PNTR                   @Z40NIVS 42265042
         DROP  R3                                              @Z40NIVS 42268042
         LR    R5,R3               LOAD REG 5 SUM AEA PNTR     @Z40NIVS 42271042
         A     R5,RECTST4          ADD PROPER DEVICE INCR      @Z40NIVS 42274042
         LA    R5,L27(R5)          ADD REC LENGTH              @Z40NIVS 42277042
         ST    R5,RECTSTP          SAVE DEV REC PNTR           @Z40NIVS 42280042
         ST    R3,RECTSTS          SAVE SUM AREA PNTR          @Z40NIVS 42283042
         MVC   L0(L27,R3),L0(R5)   MOVE DEV REC TO SUM         @Z40NIVS 42286042
         LR    R5,R3                   LOAD ADDR OF SUMMARY COUNTERS    42300042
         MVC   L2(L1,R5),CLASRC        SAVE CLASS/SOURCE OF RECORD      42350042
         SPACE                                                          42400042
         TM    CLASRC,H90              IS THIS AN MDR RECORD            42450042
         BO    TYPMDR                  YES - BR TO ADD TO COUNTER       42500042
         SPACE                                                          42550042
         MVC   L25(L2,R5),CUA+ONE  MOVE CUA TO SUM REC         @Z40NIVS 42570042
         MVC   L3(L2,R5),DEVTYP2       SAVE DEVICE CODE FROM OBR REC    42600042
         B     RETURN1                 RETURN                           42650042
         SPACE                                                          42700042
TYPMDR   MVC   L25(L2,R5),MCUA     MOVE CUA TO SUM REC         @Z40NIVS 42750042
         BAL   R8,ADDUP            GO ADD TO COUNTER           @Z40NIVS 42770042
         LA    R8,DOVOL-L6             LOAD ADDR OF SPECIAL FOR VOL CNT 42800042
         ST    R8,REG8                 STORE ADDR FOR EREP CONTROL      42850042
         MVC   L1(L1,R5),RECID         SAVE RECORD ID FROM MDR REC      42900042
         B     RETURN1                 RETURN                           42950042
         SPACE 2                                                        43000042
*                                                                       43001042
*      THE FOLLOWING CHECKS THIS OBR RECORD FOR EQUIPMENT CHECKS        43002042
*        ON THE DRIVE OR ATTACHMENT(CU/CTRLR),AND ADDS TO THE           43003042
*        APPROPRIATE COUNTERS.                                          43004042
*                                                                       43005042
EQIPCK   STM   R5,R8,XSAVE1            SAVE REGS                 XM3751 43006042
         TM    SNB00,H10               IS THIS AN EQUIPMENT CK   XM3751 43007042
         BNO   RETURN1                 NO - RETURN               XM3751 43008042
         SPACE                                                          43009042
         SR R6,R6                      CLEAR                     XM3751 43010042
         SR    R8,R8                         REGS                XM3751 43011042
         LR    R5,R3                   LOAD COUNTER ADDR         XM3751 43012042
         TM    SNB70,H30               IS THIS A FMT 3(EQ CK-ATT)XM3751 43013042
         BO    EQIPCKAT                YES - BR TO ADD TO CNTR   XM3751 43014042
         SPACE                                                          43015042
         TM    SNB70,H10               IS THIS A FMT 1(EQ CK-DRV)XM3751 43016042
         BNO   EQIPCKAT                NO - IT MUST BE ATTCH-ADD XM3751 43017042
*                                       TO COUNTER               XM3751 43018042
         LA    R5,L2(R5)               BUMP PTR TO DRV EQ CK CTR XM3751 43019042
         BAL   R8,ADDUP                GO ADD TO COUNT           XM3751 43020042
         B     RETURN1                 RETURN                    XM3751 43021042
         SPACE                                                          43022042
EQIPCKAT BAL   R8,ADDUP                GO ADD TO COUNT           XM3751 43023042
         B     RETURN1                 RETURN                    XM3751 43024042
         SPACE 2                                                        43025042
*                                                                       43050042
*      THE FOLLOWING CHECKS FOR DATA CHECK CORRECTABLE,RETRY,OR         43100042
*        PERMANENT,IF THIS OBR RECORD FITS THOSE CONDITIONS,THE         43150042
*        APPROPRIATE COUNTERS ARE ADDED TO.                             43200042
*                                                                       43250042
DATACK   STM   R5,R8,XSAVE1            SAVE REGS                        43300042
         SR    R6,R6                         REGS                       43350042
         SR    R8,R8                   CLEAR                            43400042
         LR    R5,R3                   LOAD COUNTER ADDRESS             43450042
         TM    SNB70,H50               IS THIS FMT 5(DATA CK CORRCT'BL) 43500042
         BO    DATACKC                 YES - BR TO ADD TO COUNTER       43550042
         SPACE                                                          43600042
         TM    SNB70,H40               IS THIS FMT 4                    43650042
         BNO   RETURN1                 NO - RETURN THIS ISNT DATA CK    43700042
         SPACE                                                          43750042
         TM    SWITCHES+1,X'40'      IS THIS DATA CK TEMP?     @XA21363 43800001
         BNO   DATACKP               NO-BR TO ADD TO PERM CNTR @XA21363 43830001
         SPACE                                                          43900042
         LA    R5,L2(R5)               THIS IS DATA CK-RETRY(BUMP PTR)  43950042
         BAL   R8,ADDUP                GO ADD TO COUNTER                44000042
         B     RETURN1                 RETURN                           44050042
         SPACE                                                          44100042
DATACKP  LA    R5,L4(R5)               BUMP PTR TO CORRECT COUNTER      44150042
         BAL   R8,ADDUP                GO ADD TO COUNT                  44200042
         B     RETURN1                 RETURN                           44250042
         SPACE                                                          44300042
DATACKC  BAL   R8,ADDUP                GO ADD TO COUNTER                44350042
         B     RETURN1                 RETURN                           44400042
         EJECT                                                          44450042
**                                                             @Z40NIVS 44500042
**       ROUTINE TO SUM INTO THE SPECIFIC SUM AREA FOR DEVICE  @Z40NIVS 44503042
**                                                             @Z40NIVS 44506042
RECTST0  STM   R5,R8,XSAVE1        SAVE REG                    @Z40NIVS 44509042
         TM    CLASRC,H90          TEST TYPE RECORD            @Z40NIVS 44512042
         BO    RECTST3             BRANCH IF MDR               @Z40NIVS 44515042
         IC    R7,CUA+TWO          PICK UP OBR CUA             @Z40NIVS 44518042
RECTST1  SLL   R7,L28              CLR HIGH BYTES              @Z40NIVS 44521042
         SRL   R7,L28              IN REG7                     @Z40NIVS 44524042
         LTR   R7,R7               TEST REG7 FOR ZERO          @Z40NIVS 44527042
         BZ    RECTST2             BRANCH FOR ZERO INCRMT      @Z40NIVS 44530042
         LA    R5,L27              LOAD REG5 WITH INCRMT       @Z40NIVS 44533042
         MR    R6,R5               SET REG7 TO SUM AREA        @Z40NIVS 44536042
RECTST2  ST    R7,RECTST4          SAVE INCRMT                 @Z40NIVS 44539042
         B     RETURN1             RETURN                      @Z40NIVS 44542042
RECTST3  IC    R7,MCUA+ONE         PICK UP MDR CUA             @Z40NIVS 44545042
         B     RECTST1             GO TO CLEAR HIGH BYTES      @Z40NIVS 44548042
**                                                             @Z40NIVS 44551042
**      SPECIAL TO RESTORE SUM REC TO PROPER DEV AREA          @Z40NIVS 44554042
**                                                             @Z40NIVS 44557042
RESTOR   STM   R5,R8,XSAVE1        SAVE WORK REGS              @Z40NIVS 44560042
         L     R5,RECTSTS          PICK UP PNTR TO SUM AREA    @Z40NIVS 44563042
         L     R6,RECTSTP          PICK UP PNTR TO DEV AREA    @Z40NIVS 44566042
         MVC   L0(L27,R6),L0(R5)   MOVE REC AND STORE          @Z40NIVS 44569042
         B     RETURN1             RETURN                      @Z40NIVS 44572042
**                                                             @Z40NIVS 44575042
**       THE FOLLOWING TOTALS SEEK CHECKS -                    @Z40NIVS 44578042
**             PERMANENT AND RETRY                             @Z40NIVS 44581042
*                                                                       44600042
SEEKCK   STM   R5,R8,XSAVE1            SAVE REGS                        44650042
         SR    R6,R6                   CLEAR                            44700042
         SR    R8,R8                         REGS                       44750042
         LR    R5,R3                   LOAD ADDR OF COUNTER             44800042
         TM    SNB00,H01               IS THIS A SEEK CHECK             44850042
         BNO   RETURN1                 NO - RETURN                      44900042
         SPACE                                                          44950042
         TM    SNB10,H80               IS THIS SEEK CK PERMANENT        45000042
         BO    SEEKPM                  YES - BR TO ADD TO CNTR          45050042
         BAL   R8,ADDUP                NO-ADD TO SEEK CK-RETRY COUNTER  45100042
         B     RETURN1                 RETURN                           45150042
         SPACE                                                          45200042
SEEKPM   LA    R5,L2(R5)               BUMP CNTR PTR TO PERM CNTR       45250042
         BAL   R8,ADDUP                ADD TO SEEK CK-PERM COUNTER      45300042
         B     RETURN1                 RETURN                           45350042
         SPACE 2                                                        45400042
*                                                                       45450042
*      THE FOLLOWING KEEPS COUNTS FOR THE 'SUMMARY BY VOLID'            45500042
*                                                                       45550042
TVOLID   STM   R5,R8,XSAVE1            SAVE REGS                        45600042
         SR    R6,R6                   CLEAR                            45650042
         SR    R7,R7                         WORK                       45700042
         SR    R8,R8                              REGS                  45750042
         L     R3,VOLPTR           LOAD 3 FROM PNTR AREA       @Z40NIVS 45770042
         LR    R5,R3                   LOAD ADDR OF 1ST SET OF VOL CTRS 45800042
         SPACE                                                          45850042
         TM    CLASRC,H30              IS THIS AN OBR RECORD            45900042
         BO    OVOLID                  YES - BR TO MAKE COUNTS          45950042
         SPACE                                                          46000042
         CLC   ZERO(L6),MVOLID         NO-(ITS MDR) IS VOLID ZEROS      46050042
         BE    RETURN1                 YES - RETURN - NO COUNTS         46100042
         SPACE                                                          46150042
         LA    R7,L50              LOAD NUM OF ALLOWABLE VOLIDS@Z40NIVS 46200042
MVOLID1  CLC   L0(L6,R5),MVOLID        IS THIS VOLID = TO ONE IN CNTR   46250042
         BE    MVOLID3                 YES - BR TO ADD TO COUNTERS      46300042
         SPACE                                                          46350042
MVOLID6  CLC   L0(L6,R5),ZERO      IS VOLID IN THE CNTR ZERO   @Z40NIVS 46400042
         BE    MVOLID2                 YES - BR TO RECORD COUNTS        46450042
         SPACE                                                          46500042
         LA    R5,ENTRYLN(R5)          BUMP COUNTER ADDR TO NEXT ENTRY  46550042
         BCT   R7,MVOLID1              BR TO CHECK THIS ENTRY           46600042
         EJECT                                                          46650042
MVOLID2  MVC   L0(L6,R5),MVOLID        MOVE VOLID TO COUNTER            46700042
         MVC   L25(L2,R5),MCUA     MOVE DEVICE FROM MDR        @Z40NIVS 46710042
         B     MVOLID5             GO TO SUM NEW CNTR          @Z40NIVS 46720042
         SPACE                                                          46750042
MVOLID3  CLC   L25(L2,R5),MCUA     TEST DEVICE                 @Z40NIVS 46800042
         BNE   MVOLID6             UNIT NOT EQ GET NEW CNTR    @Z40NIVS 46810042
MVOLID5  LA    R5,L6(R5)           BUMP PNTR TO SK CNT         @Z40NIVS 46820042
         MVC   READYA(L2),MSNB160      MOVE SEEK COUNT TO WORK AREA     46850042
         LH    R6,READYA               LOAD SEEK COUNT FROM RECORD      46900042
         XC    READYA(L8),READYA       CLEAR WORK AREA                  46950042
         MVC   READYA(L4),L0(R5)       MOVE SEEK COUNT FROM COUNTER     47000042
         A     R6,READYA               ADD SEEKS                        47050042
         ST    R6,READYA               STORE NEW TOTAL IN WORK AREA     47100042
         MVC   L0(L4,R5),READYA        MOVE TOTAL TO COUNTER            47150042
         LA    R5,L4(R5)               BUMP COUNTER PTR TO BYTES READ   47200042
         SPACE                                                          47250042
         MVC   READYA(L4),MSNB80       MOVE BYTES READ FROM RECORD      47300042
         L     R6,READYA               LOAD BYTES READ                  47350042
         XC    READYA(L8),READYA       CLEAR WORK AREA                  47400042
         MVC   READYA(L4),L2(R5)       MOVE BYTES READ FROM COUNTER     47450042
         AL    R6,READYA               ADD BYTES READ                   47500042
         BC    NOCARRY,MSAVBR          BR IF THERE WAS NOT AN OVERFLOW  47550042
*                                       IF THERE WAS AN OVERFOLW        47600042
         LH    R7,L0(R5)               LOAD OVERFLOW COUNTER            47650042
         LA    R7,L1(R7)               BUMP OVBRFLOW COUNT BY ONE       47700042
         STH   R7,L0(R5)               STORE UPDATED OVERFLOW COUNT     47750042
*                                                                       47800042
MSAVBR   ST    R6,READYA               STORE TOTAL IN WORK AREA         47850042
         MVC   L2(L4,R5),READYA        MOVE TOTAL TO COUNTERS           47900042
         SPACE                                                          47950042
*        THE FOLLOWING DETERMINES IF OVERRUN COUNTS ARE FOR             48000042
*        CHANNEL 'A' & 'B' OR CHANNEL 'C' & 'D',AND UPDATES THE         48050042
*        APPROPRIATE COUNTERS                                           48100042
         CLI   MSNB180,H80             ARE COUNTS FOR CHAN C & D        48150042
         BE    MCHANCD                 YES - BR TO SET PTR              48200042
         LA    R5,ABCNTR(R3)           SET POINTER TO 'A''B' CNTRS      48250042
         B     MVOLID4                 BR TO TOTAL COUNTS               48300042
         SPACE                                                          48350042
MCHANCD  LA    R5,CDCNTR(R3)           SET PTR TO CHAN 'C'&'D' COUNTERS 48400042
MVOLID4  SR    R6,R6                   CLEAR REG                        48450042
         IC    R6,MSNB200              INSERT OVERRUN-CHAN A/C CMND     48500042
         AH    R6,L0(R5)               ADD CURRENT TOTAL TO THIS COUNT  48550042
         STH   R6,L0(R5)               STORE NEW TOTAL                  48600042
         SPACE                                                          48650042
         SR    R6,R6                   CLEAR REG                        48700042
         IC    R6,MSNB210              INSERT DATA OVERRUNS FOR A/C     48750042
         AH    R6,L2(R5)               ADD CURRENT TOTAL TO THAT COUNT  48800042
         STH   R6,L2(R5)               STORE NEW TOTAL                  48850042
         EJECT                                                          48900042
         SR    R6,R6                   CLEAR REG                        48950042
         IC    R6,MSNB220              INSERT CHAN B/D CMND OVERRUNS    49000042
         AH    R6,L4(R5)               ADD CURRENT TOTAL TO THAT COUNT  49050042
         STH   R6,L4(R5)               SAVE NEW TOTAL                   49100042
         SPACE                                                          49150042
         SR    R6,R6                   CLEAR REG                        49200042
         IC    R6,MSNB230              INSERT CHAN B/D DATA OVERRUNS    49250042
         AH    R6,L6(R5)               ADD CURRENT TOTAL TO THAT COUNT  49300042
         STH   R6,L6(R5)               SAVE NEW TOTAL                   49350042
         B     RETURN1                 RETURN                           49400042
         SPACE 2                                                        49450042
*        THE FOLLOWING KEEPS READ AND SEEK ERROR COUNTS FROM            49500042
*        OBR RECORDS                                                    49550042
         SPACE                                                          49600042
OVOLID   CLC   ZERO(L6),VOLID          IS VOLID IN RECORD ZERO          49650042
         BE    RETURN1                 YES - RETURN                     49700042
         SPACE                                                          49750042
         LA    R7,L50              LOAD NUM OF ALLOWABLE VOLID @Z40NIVS 49800042
OVOLID1  CLC   L0(L6,R5),VOLID         IS VOLID=TO ONE IN COUNTER       49850042
         BE    OVOLID3                 YES - BR TO MAKE COUNTS          49900042
         SPACE                                                          49950042
OVOLID4  CLC   L0(L6,R5),ZERO      IS VOLID IN CNTR=TO ZERO    @Z40NIVS 50000042
         BE    OVOLID2                 YES - BR TO INIT CNTR            50050042
         SPACE                                                          50100042
         LA    R5,ENTRYLN(R5)          BUMP COUNTER ADDR TO NEXT ENTRY  50150042
         BCT   R7,OVOLID1              BR TO CHECK THIS ENTRY           50200042
         SPACE                                                          50250042
OVOLID2  MVC   L0(L6,R5),VOLID         MOVE VOLID TO COUNTER            50300042
         MVC   L25(L2,R5),CUA+ONE  MOVE CUA TO VOL CNTR        @Z40NIVS 50350042
         B     OVOLID5             GO TO SUM NEW CNTR          @Z40NIVS 50360042
         SPACE 1                                               @Z40NIVS 50370042
OVOLID3  CLC   L25(L2,R5),CUA+ONE  IS DEVICE EQUAL             @Z40NIVS 50380042
         BNE   OVOLID4             BRCH NO DUP                 @Z40NIVS 50390042
OVOLID5  LA    R5,L16(R5)          BUMP PTR TO SEEK ERR CNT    @Z40NIVS 50400042
         TM    SNB70,H50               IS THIS A FMT 5                  50450042
         BO    OCORDATA                YES-BR TO ADD TO CORR DATA CK    50500042
         SPACE                                                          50550042
         TM    SNB70,H40               IS THIS A FMT 4                  50600042
         BO    OUNCDATA                YES-BR TO CK IF PERM ERROR       50650042
         SPACE                                                          50700042
OCKSEEK  TM    SNB00,H01               IS THIS A SEEK CK ERROR          50750042
         BNO   RETURN1                 NO-RETURN                        50800042
         LH    R7,L0(R5)               LOAD SEEK CK CNTR                50850042
         LA    R7,L1(R7)               ADD ONE TO COUNT                 50900042
         STH   R7,L0(R5)               SAVE UPDATED SEEK CK COUNTER     50950042
         B     RETURN1                 RETURN                           51000042
         SPACE                                                          51050042
OUNCDATA TM    SNB10,H80               WAS THIS UNCORR DATA CK PERM     51100042
         BO    OCKSEEK                 YES-DONT ADD TO RETRY CNT        51150042
         LH    R7,L2(R5)               LOAD RETRY READ COUNTER          51200042
         LA    R7,L1(R7)               ADD ONE TO COUNT                 51250042
         STH   R7,L2(R5)               SAVE UPDATED COUNTER             51300042
         B     OCKSEEK                 BR TO CK FOR SEEK ERROR          51350042
         SPACE                                                          51400042
OCORDATA LH    R7,L4(R5)               LOAD CORR DATA CK COUNTER        51450042
         LA    R7,L1(R7)               ADD ONE TO COUNTER               51500042
         STH   R7,L4(R5)               SAVE UPDATED COUNTER             51550042
         B     OCKSEEK                 BR TO CHECK FOR SEEK ERROR       51600042
         SPACE 2                                                        51650042
*                                                                       51700042
*      THE FOLLOWING ADDS ONE TO ANY SUMMARY COUNTER                    51750042
*                                                                       51800042
ADDUP    LH    R6,L0(R5)               LOAD SUMMARY COUNTER             51850042
         LA    R6,L1(R6)               ADD ONE TO COUNTER               51900042
         STH   R6,L0(R5)               SAVE COUNTER                     51950042
         LA    R5,L2(R5)               BUMP SUMMARY COUNTER POINTER     52000042
         BR    R8                      RETURN TO MAIN LINE              52050042
         SPACE 2                                               @Z40NIVS 52100042
**                                                             @Z40NIVS 52102042
**       SPECIAL TO SUM INTO THE FAULT SYMPTOM COUNTERS        @Z40NIVS 52104042
**                                                             @Z40NIVS 52106042
TFAULT0  STM   R5,R8,XSAVE1        SAVE WORK REG               @Z40NIVS 52108042
         TM    CLASRC,H30          TYPE REC AN OBR             @Z40NIVS 52110042
         BNO   RETURN1       EXIT                                       52112042
         TM    SNB70,H50     FORMAT 5?                                  52113042
         BO    RETURN1       YES, DON'T SUM                             52114042
TFAULT1  L     R3,FLTPTR           PNT TO FLT SUM AREA         @Z40NIVS 52116042
         LA    R6,L1               SET OCCUR INCREMENT         @Z40NIVS 52118042
         LA    R7,L50              SET TO NUM OF SUMRECORD     @Z40NIVS 52120042
TFAULT2  CLC   L0(L2,R3),SNB220    IS FLT CODE EQ SUM REC      @Z40NIVS 52122042
         BE    TFAULT3             YES GO TEST CUA             @Z40NIVS 52124042
         CLC   L0(L2,R3),ZEROS     IS SUM REC ZERO             @Z40NIVS 52126042
         BE    TFAULT9             GO TO ENTER NEW REC         @Z40NIVS 52128042
         B     TFAULT8             GO TO PICK UP NEXT REC      @Z40NIVS 52130042
TFAULT3  CLC   L2(L2,R3),CUA+ONE   IS CUA EQ TO SUM REC        @Z40NIVS 52132042
         BE    TFAULT5             YES GO TO SUM               @Z40NIVS 52134042
TFAULT9  CLC   L2(L2,R3),ZEROS     CUA EQUAL TO ZERO           @Z40NIVS 52136042
         BE    TFAULT4             IF YES REC IS EMPTY         @Z40NIVS 52138042
TFAULT8  LA    R3,L40(R3)          STEP TO NEXT COUNTER        @Z427VLS 52140042
         BCT   R7,TFAULT2          GO TRY AGAIN                @Z40NIVS 52142042
         B     RETURN1             ALL ENTRIES FULL            @Z40NIVS 52144042
TFAULT4  MVC   L0(L2,R3),SNB220    MOVE FLT CODE TO REC        @Z40NIVS 52146042
         MVC   L2(L2,R3),CUA+ONE   MOVE CUA TO SUM REC         @Z40NIVS 52148042
         MVC   L16(L24,R3),SNB00   MOVE 24 SENSE BYTES         @Z427VLS 52149042
TFAULT5  MVC   TFAULT7(L4),L4(R3)  INCREMENT                   @Z40NIVS 52150042
         A     R6,TFAULT7          NUM OF                      @Z40NIVS 52152042
         ST    R6,TFAULT7          OCCUR                       @Z40NIVS 52154042
         MVC   L4(L4,R3),TFAULT7   BY ONE                      @Z40NIVS 52156042
         CLC   L8(L4,R3),DAY       IS SUM DAY LATER RECDAY     @Z40NIVS 52158042
         BH    RETURN1             SUM DAY HIGH RETURN         @Z40NIVS 52160042
         CLC   L8(L4,R3),DAY       IS SUMDAY EQ RECDAY         @Z40NIVS 52162042
         BE    TFAULT6             GO TEST TIME DAY EQ         @Z40NIVS 52164042
         MVC   L8(L8,R3),DAY       MOVE IN NEW DAY/TIME        @Z40NIVS 52166042
         MVC   L16(L24,R3),SNB00   MOVE 24 SENSE BYTES         @Z427VLS 52167042
         B     RETURN1             REC UPDATED                 @Z40NIVS 52168042
TFAULT6  CLC   L12(L4,R3),HOUR     TEST SUM DAY/REC DAY        @Z40NIVS 52170042
         BNL   RETURN1             SUM REC HIGH OR EQ          @Z40NIVS 52172042
         MVC   L12(L4,R3),HOUR     MOVE IN NEW TIME TO SUM     @Z40NIVS 52174042
         MVC   L16(L24,R3),SNB00   MOVE 24 SENSE BYTES         @Z427VLS 52175042
         SPACE 2                                               @Z40NIVS 52178042
**                                                             @Z40NIVS 52180042
*      THE FOLLOWING RETURNS TO EREP CONTROL                            52200042
*                                                                       52250042
RETURN1  LM    R5,R8,XSAVE1            RESTORE REGS                     52300042
         BR    R14                     RETURN TO EREP CONTROL           52350042
         EJECT                                                          52400042
*                                                                       52450042
*      THE FOLLOWING STORAGE CONSTANTS ARE USED                         52500042
*        IN THE PREVIOUS ROUTINES                                       52550042
*                                                                       52600042
         SPACE                                                          52650042
VOLPTR   DC    F'0'                PNTR TO VOLID SUM AREA      @Z40NIVS 52660042
         SPACE 1                                               @Z40NIVS 52670042
FLTPTR   DC    F'0'                PNTR TO FLTSYM SUM AREA     @Z40NIVS 52680042
         SPACE 1                                               @Z40NIVS 52690042
READYA   DC    D'0'                    WORK AREA                        52700042
         SPACE                                                          52750042
ZERO     DC    2F'0'                   ZERO'S - USED FOR COMPARES       52800042
         SPACE                                                          52850042
XSAVE1   DC    5F'0'                   REGISTER SAVE AREA               52900042
         EJECT                                                          52950042
*                                                                     * 53000042
*      THE FOLLOWING 'SPECIAL' AND 'SUM' MACRO'S KEEP TOTAL COUNTS    * 53050042
*        FOR ANY ONE CUA                                              * 53100042
*                                                                     * 53150042
ENTRIES  DS    0F                                                       53200042
         SPECIAL RECTST0,00000000,SPACE=0                      @Z40NIVS 53220042
         SPECIAL   XDATE1,00000000,SPACE=4       FROM-TO DATE           53250042
         SPECIAL   ISMDR,00000000,SPACE=3        SAVE REC CLAS/CK MDR   53300042
         SUM   SNB02                             ADD TO BUS OUT PARITY  53350042
         SPECIAL   EQIPCK,00000000,SPACE=2       CK FOR EQIP CK  XM3751 53400042
         SPECIAL   DATACK,00000000,SPACE=3       CK FOR DATA CHECKS     53450042
         SPECIAL   SEEKCK,00000000,SPACE=2       CK FOR SEEK CHECKS     53500042
         SUM   SNB05                             ADD TO OVERRUN         53550042
         SPACE                                                          53650042
DOVOL    EQU   *                                                        53700042
         SPECIAL   TVOLID,00000000,SPACE=12      ADD TO VOLID SUMRY CTS 53750042
         SPECIAL RESTOR,00000000,SPACE=0                       @Z40NIVS 53800042
         SPACE 1                                               @Z40NIVS 53810042
         SPECIAL TFAULT0,0,SPACE=20 SUM FOR SYMPTOM            @Z427VLS 53820042
         SPACE 1                                               @Z40NIVS 53830042
         DC    XL1'FF'                           END OF SUMMARY COUNTNG 53850042
         EJECT                                                          53900042
PEDIT    DS    0F                                                       53950042
&DSECT   SETC  'T3340'                                                  54000042
&CSECT   SETC  'PEDIT'                                                  54050042
         SPACE                                                          54100042
         USING *,R9                                                     54150042
         USING T3340,R2                                                 54200042
         SPACE                                                          54250042
         DC    A(PENTRY)                                                54300042
         DC    C'IFCSAXXC'                                              54350042
         SPACE                                                          54400042
YR9PTR   DS    F                                                        54450042
YLABEL   DS    F                                                        54500042
         SPACE 2                                                        54550042
*********************************************************************** 54600042
*                                                                     * 54650042
*      THE FOLLOWING DSECT DESCRIBES COUNTERS USED TO TOTAL INCIDENTS * 54700042
*      PERTAINING TO ANY ONE PHYSICAL ADDRESS. INDIVIDUAL ENTRIES ARE * 54750042
**     MADE FOR UP TO 50 VOLUME LABELS,AFTER 50,THE REMAINING ARE     * 54800042
**     COMPILED IN THE 51ST ENTRY.AFTER THE 51ST ENTRY,THERE ARE      * 54850042
*      COUNTERS FOR TWO AND FOUR CHANNEL SWITCH OVERRUNS. IF A HEX'80'* 54900042
*      IS FOUND IN SENSE BYTE 18 OF THE MDR RECORD,COUNTS ARE MADE    * 54950042
*      FOR CHANNEL 'C' AND 'D'. IF A HEX'00' IS FOUND,COUNTS ARE KEPT * 55000042
*      FOR CHANNEL 'A' AND 'B'.                                       * 55050042
*********************************************************************** 55100042
         SPACE                                                          55150042
T3340    DSECT                                                          55200042
         SPACE 2                                                        55250042
         DS    3H                                                       55300042
         SPACE                                                          55350042
         DSGEN (YDUMA,16),(YNOREC,16)                                   55400042
         DSGEN (YTYPE,8),(YCHAN,8),(YCUA,24),(YSER,24)                  55450042
         DSGEN (YCPU,16),(YSMSW,16)                                     55500042
         SPACE                                                          55550042
         DSGEN (TDAY1,32),(TDAY2,32)                                    55600042
         SPACE                                                          55650042
SUMRECT  DSGEN (TSTAT,16),(TRECLS,8),(TYPDEV,16),(TEXTRA,8)    @Z40NIVS 55700042
         SPACE                                                          55750042
         DSGEN (TBUSOPA,16)                                             55800042
         SPACE                                                          55850042
         DSGEN (TEQIPATH,16),(TEQIPDRV,16)                       XM3751 55900042
         SPACE                                                          55950042
         DSGEN (TDACKCOR,16),(TDACKRET,16),(TDACKPRM,16)                56000042
         SPACE                                                          56050042
         DSGEN (TSEEKR,16),(TSEEKP,16)                                  56100042
         SPACE                                                          56150042
         DSGEN (TOVERRN,16),(TCUA,24)                          @Z40NIVS 56200042
         SPACE                                                          56250042
SUMREC0  DS    27C                                             @Z40NIVS 56255042
SUMREC1  DS    27C                                             @Z40NIVS 56260042
SUMREC2  DS    27C                                             @Z40NIVS 56265042
SUMREC3  DS    27C                                             @Z40NIVS 56270042
SUMREC4  DS    27C                                             @Z40NIVS 56275042
SUMREC5  DS    27C                                             @Z40NIVS 56280042
SUMREC6  DS    27C                                             @Z40NIVS 56285042
SUMREC7  DS    27C                                             @Z40NIVS 56290042
SUMREC8  DS    27C                                             @Z40NIVS 56295042
SUMREC9  DS    27C                                             @Z40NIVS 56300042
SUMRECA  DS    27C                                             @Z40NIVS 56305042
SUMRECB  DS    27C                                             @Z40NIVS 56310042
SUMRECC  DS    27C                                             @Z40NIVS 56315042
SUMRECD  DS    27C                                             @Z40NIVS 56320042
SUMRECE  DS    27C                                             @Z40NIVS 56325042
SUMRECF  DS    27C                                             @Z40NIVS 56330042
         EJECT                                                          56350042
*                                                                       56400042
*      THE FOLLOWING COUNTERS FOR VOLID SUMMARY                         56450042
*                                                                       56500042
         SPACE                                                          56550042
         DSGEN (TVOLID1,48),(TSEEK1,32)                                 56600042
         DSGEN (TBTRDO1,16),(TBYTRD1,32)                                56650042
         DSGEN (TSEKER1,16),(TUNDTA1,16)                                56700042
         DSGEN (TCRDTA1,16),(SUPBUF1,16),(TVCUA,24)            @Z40NIVS 56750042
TVOLID2  DS    27C                                             @Z40NIVS 56770042
TVOLID3  DS    27C                                             @Z40NIVS 56790042
TVOLID4  DS    27C                                             @Z40NIVS 56810042
TVOLID5  DS    27C                                             @Z40NIVS 56830042
TVOLID6  DS    27C                                             @Z40NIVS 56850042
TVOLID7  DS    27C                                             @Z40NIVS 56870042
TVOLID8  DS    27C                                             @Z40NIVS 56890042
TVOLID9  DS    27C                                             @Z40NIVS 56910042
TVOLID10 DS    27C                                             @Z40NIVS 56930042
TVOLID11 DS    27C                                             @Z40NIVS 56950042
TVOLID12 DS    27C                                             @Z40NIVS 56970042
TVOLID13 DS    27C                                             @Z40NIVS 56990042
TVOLID14 DS    27C                                             @Z40NIVS 57010042
TVOLID15 DS    27C                                             @Z40NIVS 57030042
TVOLID16 DS    27C                                             @Z40NIVS 57050042
TVOLID17 DS    27C                                             @Z40NIVS 57070042
TVOLID18 DS    27C                                             @Z40NIVS 57090042
TVOLID19 DS    27C                                             @Z40NIVS 57110042
TVOLID20 DS    27C                                             @Z40NIVS 57130042
TVOLID21 DS    27C                                             @Z40NIVS 57150042
TVOLID22 DS    27C                                             @Z40NIVS 57170042
TVOLID23 DS    27C                                             @Z40NIVS 57190042
TVOLID24 DS    27C                                             @Z40NIVS 57210042
TVOLID25 DS    27C                                             @Z40NIVS 57230042
TVOLID26 DS    27C                                             @Z40NIVS 57250042
TVOLID27 DS    27C                                             @Z40NIVS 57270042
TVOLID28 DS    27C                                             @Z40NIVS 57290042
TVOLID29 DS    27C                                             @Z40NIVS 57310042
TVOLID30 DS    27C                                             @Z40NIVS 57330042
TVOLID31 DS    27C                                             @Z40NIVS 57350042
TVOLID32 DS    27C                                             @Z40NIVS 57370042
TVOLID33 DS    27C                                             @Z40NIVS 57390042
TVOLID34 DS    27C                                             @Z40NIVS 57410042
TVOLID35 DS    27C                                             @Z40NIVS 57430042
TVOLID36 DS    27C                                             @Z40NIVS 57450042
TVOLID37 DS    27C                                             @Z40NIVS 57470042
TVOLID38 DS    27C                                             @Z40NIVS 57490042
TVOLID39 DS    27C                                             @Z40NIVS 57510042
TVOLID40 DS    27C                                             @Z40NIVS 57530042
TVOLID41 DS    27C                                             @Z40NIVS 57550042
TVOLID42 DS    27C                                             @Z40NIVS 57570042
TVOLID43 DS    27C                                             @Z40NIVS 57590042
TVOLID44 DS    27C                                             @Z40NIVS 57610042
TVOLID45 DS    27C                                             @Z40NIVS 57630042
TVOLID46 DS    27C                                             @Z40NIVS 57650042
TVOLID47 DS    27C                                             @Z40NIVS 57670042
TVOLID48 DS    27C                                             @Z40NIVS 57690042
TVOLID49 DS    27C                                             @Z40NIVS 57710042
TVOLID50 DS    27C                                             @Z40NIVS 57730042
TVOLID51 DS    27C                                             @Z40NIVS 57750042
         DSGEN (TOCACA,16),(TOCADA,16)                         @Z40NIVS 57770042
         DSGEN (TOCBCA,16),(TOCBDA,16)                                  57850042
         DSGEN (TOCCCA,16),(TOCCDA,16)                                  57900042
         DSGEN (TOCDCA,16),(TOCDDA,16)                                  57950042
**                                                             @Z40NIVS 58000042
**       SUM COUNTERS FOR FAULT SYMPTOM                        @Z40NIVS 58001042
**                                                             @Z40NIVS 58002042
FLTSYM0  DSGEN (SYMCD,16),(SYMCUA,16)                          @Z40NIVS 58003042
         DSGEN (SYMOCR,32)                                     @Z40NIVS 58004042
         DSGEN (SYMDAY,32),(SYMHR,32)                          @Z40NIVS 58005042
         DSGEN (SYMSNS0,48),(SYMSNS1,48),(SYMSNS2,48),(SYMSNS3,48)      58005542
FLTSYM1  DS    40C                                             @Z40NIVS 58006042
FLTSYM2  DS    40C                                             @Z40NIVS 58007042
FLTSYM3  DS    40C                                             @Z40NIVS 58008042
FLTSYM4  DS    40C                                             @Z40NIVS 58009042
FLTSYM5  DS    40C                                             @Z40NIVS 58010042
FLTSYM6  DS    40C                                             @Z40NIVS 58011042
FLTSYM7  DS    40C                                             @Z40NIVS 58012042
FLTSYM8  DS    40C                                             @Z40NIVS 58013042
FLTSYM9  DS    40C                                             @Z40NIVS 58014042
FLTSYM10 DS    40C                                             @Z40NIVS 58015042
FLTSYM11 DS    40C                                             @Z40NIVS 58016042
FLTSYM12 DS    40C                                             @Z40NIVS 58017042
FLTSYM13 DS    40C                                             @Z40NIVS 58018042
FLTSYM14 DS    40C                                             @Z40NIVS 58019042
FLTSYM15 DS    40C                                             @Z40NIVS 58020042
FLTSYM16 DS    40C                                             @Z40NIVS 58021042
FLTSYM17 DS    40C                                             @Z40NIVS 58022042
FLTSYM18 DS    40C                                             @Z40NIVS 58023042
FLTSYM19 DS    40C                                             @Z40NIVS 58024042
FLTSYM20 DS    40C                                             @Z40NIVS 58025042
FLTSYM21 DS    40C                                             @Z40NIVS 58026042
FLTSYM22 DS    40C                                             @Z40NIVS 58027042
FLTSYM23 DS    40C                                             @Z40NIVS 58028042
FLTSYM24 DS    40C                                             @Z40NIVS 58029042
FLTSYM25 DS    40C                                             @Z40NIVS 58030042
FLTSYM26 DS    40C                                             @Z40NIVS 58031042
FLTSYM27 DS    40C                                             @Z40NIVS 58032042
FLTSYM28 DS    40C                                             @Z40NIVS 58033042
FLTSYM29 DS    40C                                             @Z40NIVS 58034042
FLTSYM30 DS    40C                                             @Z40NIVS 58035042
FLTSYM31 DS    40C                                             @Z40NIVS 58036042
FLTSYM32 DS    40C                                             @Z40NIVS 58037042
FLTSYM33 DS    40C                                             @Z40NIVS 58038042
FLTSYM34 DS    40C                                             @Z40NIVS 58039042
FLTSYM35 DS    40C                                             @Z40NIVS 58040042
FLTSYM36 DS    40C                                             @Z40NIVS 58041042
FLTSYM37 DS    40C                                             @Z40NIVS 58042042
FLTSYM38 DS    40C                                             @Z40NIVS 58043042
FLTSYM39 DS    40C                                             @Z40NIVS 58044042
FLTSYM40 DS    40C                                             @Z40NIVS 58045042
FLTSYM41 DS    40C                                             @Z40NIVS 58046042
FLTSYM42 DS    40C                                             @Z40NIVS 58047042
FLTSYM43 DS    40C                                             @Z40NIVS 58048042
FLTSYM44 DS    40C                                             @Z40NIVS 58049042
FLTSYM45 DS    40C                                             @Z40NIVS 58050042
FLTSYM46 DS    40C                                             @Z40NIVS 58051042
FLTSYM47 DS    40C                                             @Z40NIVS 58052042
FLTSYM48 DS    40C                                             @Z40NIVS 58053042
FLTSYM49 DS    40C                                             @Z40NIVS 58054042
FLTSYM50 DS    40C                                             @Z40NIVS 58055042
**                                                             @Z40NIVS 58056042
**       THE FOLLOWING EQUATES ARE FOR DISPLACEMENT WITHIN     @Z40NIVS 58057042
**       THE VOLID                                             @Z40NIVS 58058042
*        SUMMARY COUNTERS - FROM THE FIRST VOLID                        58100042
*                                                                       58150042
ABCNTR   EQU   TOCACA-TVOLID1          DIS TO A/B COUNTERS              58200042
CDCNTR   EQU   TOCCCA-TVOLID1          DIS TO C/D COUNTERS              58250042
ENTRYLN  EQU   TVOLID2-TVOLID1         LENGTH OF COUNTERS FOR ONE VOLID 58300042
         EJECT                                                          58350042
IFCSAXXC CSECT                                                          58400042
XR9PTR   DC    F'0'                                                     58450042
XLABELP  DC    F'0'                                                     58500042
         SPACE 2                                                        58550042
*                                                                       58600042
*      ALL THE FOLLOWING ROUTINES ARE EXECUTED VIA                      58650042
*        THE 'ROUTINE' MACRO - NOTE: R3=ADDR OF PRINT POSITION          58700042
*                                   R4=ADDR OF DATA IN SUMMARY COUNTER  58750042
*                                                                       58800042
         SPACE 2                                                        58850042
*                                                                       58900042
*      THE FOLLOWING MOVES THE DEVICE TYPE TO THE PRINT LINE            58950042
*                                                                       59000042
MOVDEV   STM   R5,R8,XSAVE             SAVE REGS                        59050042
         LA    R5,DEVTABLE             LOAD ADDR OF DEVICE TABLE        59100042
         LA    R6,DEVNUM               LOAD NUMBER OF SUPPORTED DEVICES 59150042
         TM    L0(R4),H90              WAS RECORD TYPE MDR              59200042
         BO    MDEVCHK                 YES BR TO CHECK ID               59250042
         SPACE                                                          59300042
ODEVCK   CLC   L1(L2,R4),L0(R5)        IS DEVICE CODE SUPPORTED         59350042
         BE    DEVFND                  YES - BR TO MOVE DEVICE TYPE     59400042
         LA    R5,L9(R5)               BUMP TABLE PTR TO NEXT ENTRY     59450042
         BCT   R6,ODEVCK               BR TO CHECK THIS DEVICE CODE     59500042
         B     MOVUNKN                 BR - DEVICE IS UNKNOWN           59550042
         SPACE                                                          59600042
MDEVCHK  CLC   L1(L1,R4),L2(R5)        IS RECORD ID SUPPORTED           59650042
         BE    DEVFND                  YES - BR TO MOVE DEVICE TYPE     59700042
         LA    R5,L9(R5)               BUMP PTR TO NEXT REC ID          59750042
         BCT   R6,MDEVCHK              BR TO CHECK THIS ONE             59800042
         SPACE                                                          59850042
*        DEVICE IS NOT SUPPORTED MOVE 'UNKNOWN' TO PRINT LINE           59900042
MOVUNKN  MVC   L9(L7,R3),UNKNOWN       MOVE TO PRINT LINE               59950042
         B     RETURN                  RETURN                           60000042
         SPACE                                                          60050042
DEVFND   MVC   L9(L6,R3),L3(R5)        MOVE DEVICE TYPE TO PRINT LINE   60100042
         B     RETURN                  RETURN                           60150042
         SPACE 2                                                        60200042
*                                                                       60250042
*      THE FOLLOWING PUTS THE DATE IN THE PRINT LINE                    60300042
*                                                                       60350042
SETDATE  UNPK  XSAVE(L8),L1(L3,R4)     UNPACK THE DATE                  60400042
         MVC   L0(L3,R3),XSAVE+L5      MOVE 'JULIAN' DAY TO PRINT LINE  60450042
         MVC   L6(L2,R3),XSAVE+L3      MOVE YEAR TO PRINT LINE          60500042
         BR    R14                     RETURN                           60550042
         EJECT                                                          60600042
*                                                                       60650042
*      THE FOLLOWING INSERTS DEFAULTS FOR CPU MODEL # AND SERIAL #      60700042
*        IF THEY ARE NOT IN RECORD                                      60750042
*                                                                       60800042
SETCPUNO STM   R5,R8,XSAVE             SAVE REGS                        60850042
         SR    R5,R5                   CLEAR REG                        60900042
         IC    R5,L0(R4)               INSERT FIRST 1/2 OF MODEL #      60950042
         SLL   R5,L8               SHIFT IT T                  @Z40NIVS 61000042
         IC    R5,L1(R4)               INSERT LAST 1/2 OF MODEL #       61050042
         LTR   R5,R5                   IS MODEL # ZERO                  61100042
         BNZ   RETURN                  NO - RETURN                      61150042
         SPACE                                                          61200042
         LR    R5,R3                   LOAD PRINT POS ADDR              61250042
         LA    R6,L46                  LOAD # OF PRINT POS TO BACK UP   61300042
         SR    R5,R6                   SUBTRACT OFFSET                  61350042
         MVC   0(L6,R5),SHARED           SAY MODEL SHARED      @Z427VLS 61400042
         B     RETURN                  RETURN                           61500042
         SPACE 2                                                        61550042
*                                                                       61600042
*      THE FOLLOWING CONVERTS HEX TO DECIMAL,READY FOR PRINT            61650042
*                                                                       61700042
CONV1    STM   R5,R8,XSAVE             SAVE REGS                        61750042
         XC    READYP(L8),READYP       CLEAR WORK AREA                  61800042
         SR    R6,R6                   CLEAR REG                        61850042
         LH    R6,L0(R4)               LOAD COUNT                       61900042
CONV2    CVD   R6,READYP               CONVERT COUNT TO DECIMAL         61950042
         UNPK  READYP(L5),READYP+L5(L3) UNPACK DECIMAL COUNT            62000042
         OI    READYP+L4,CLRSGN        SET THE SIGN                     62050042
         MVC   L0(L4,R3),READYP+L1     MOVE PRINTABLE COUNT TO PRINT    62100042
         B     RETURN                  RETURN                           62150042
         SPACE 2                                                        62200042
**                                                             @Z40NIVS 62250042
**       ROUTINES TO ALTER PRINT LINE                          @Z40NIVS 62252042
**                                                             @Z40NIVS 62254042
REPNT0   STM   R5,R8,XSAVE         SAVE WORK REGS              @Z40NIVS 62256042
         LA    R5,L6               LOAD THE DECREMENT          @Z40NIVS 62258042
         LR    R6,R3               PNT CRNT PRNT LINE POS      @Z40NIVS 62260042
         SR    R6,R5               PNT TO START OF PRNT        @Z40NIVS 62262042
         MVC   L0(L3,R6),L3(R6)    MOVE CUA BACK 3 POS         @Z40NIVS 62264042
         XC    L3(L3,R6),L3(R6)    CLEAR 3 BYTES               @Z40NIVS 62266042
         LA    R3,L1(R3)           INCR PRNT LINE PNTR 13      @Z40NIVS 62268042
         B     RETURN              RETURN                      @Z40NIVS 62270042
REPNT1   LA    R4,L4               CONSTANT FOUR               @Z40NIVS 62272042
         SR    R3,R4               DECREMENT PNTR TO 8         @Z40NIVS 62274042
         BR    R14                 RETURN                      @Z40NIVS 62276042
REPNT2   LA    R4,L2               CONSTANT TWO                @Z40NIVS 62278042
         SR    R3,R4               DECREMENT PNTR TO 10        @Z40NIVS 62280042
         BR    R14                 RETURN                      @Z40NIVS 62282042
**                                                             @Z40NIVS 62284042
***      EDIT CYCLE TO PRINT 16 SUMCTR                         @Z40NIVS 62286042
**                                                             @Z40NIVS 62288042
EDTFA0   STM   R5,R8,XSAVE         SAVE REG                    @Z40NIVS 62290042
         L     R7,EDTFA4           GET COUNTER                 @Z40NIVS 62292042
EDTFA1   L     R5,EDTFA5           PICK UP LAST PRT            @Z40NIVS 62294042
         LA    R5,L27(R5)          INCREMENT TO NEXT           @Z40NIVS 62296042
         ST    R5,EDTFA5           SAVE LAST REC PTR           @Z40NIVS 62298042
         OC    L24(L3,R5),L24(R5)  TEST CUA + 0                @Z40NIVS 62300042
         BNZ   EDTFA2              BR IF NO REC INFO           @Z40NIVS 62302042
         BCT   R7,EDTFA1           REDUCE RECCTR               @Z40NIVS 62304042
         B     RETURN              RETURN                      @Z40NIVS 62306042
EDTFA2   BCT   R7,EDTFA3           REDUCE REG CTR              @Z40NIVS 62308042
         B     RETURN              RETURN                      @Z40NIVS 62310042
EDTFA3   MVC   L0(L27,R4),L0(R5)   MOVE REC TO PRINT           @Z40NIVS 62312042
         ST    R7,EDTFA4           SAVE REC NO                 @Z40NIVS 62314042
         LA    R7,SUMTA1-FOUR      LOAD LINE ADDR-4            @Z40NIVS 62316042
         LA    R8,SUMTA2-ONE       LOAD LABEL ADDR-1           @Z40NIVS 62318042
         STM   R7,R8,YR9PTR        STORE NEW PNTR              @Z40NIVS 62320042
         SR    R15,R15             CLEAR FOR NO PRINT          @Z40NIVS 62322042
         B     RETURN              RETURN                      @Z40NIVS 62324042
EDTFA6   STM   R5,R8,XSAVE         SAVE WORK REG               @Z40NIVS 62326042
         L     R7,EDTFA4           PICK UP NO. REC TO GO       @Z40NIVS 62328042
         LR    R5,R4               LOAD SUM AREA PNTR          @Z40NIVS 62330042
EDTFA7   LA    R5,L27(R5)          PICK UP ADDR OF REC         @Z40NIVS 62332042
         ST    R5,EDTFA5           SAVE FIRST DEV REC          @Z40NIVS 62334042
         OC    L24(L3,R5),L24(R5)  TEST FOR CUA                @Z40NIVS 62336042
         BNZ   EDTFA8              GOT TO MOVE REC             @Z40NIVS 62338042
         BCT   R7,EDTFA7           GO TO TEST NEXT REC         @Z40NIVS 62340042
         LA    R7,L1               SET R7 TO 1 REC LEFT        @Z40NIVS 62342042
         ST    R7,EDTFA4           STORE TO PRNT ZERO          @Z40NIVS 62344042
         ST    R4,EDTFA5           SET TO START OF SUM AREA    @Z40NIVS 62346042
         B     RETURN              NO REC TO PRNT              @Z40NIVS 62348042
EDTFA8   ST    R7,EDTFA4           STORE TO NO. REC TO PRNT    @Z40NIVS 62350042
         MVC   L0(L27,R4),L0(R5)   MOVE FIRST REC TO PRNT      @Z40NIVS 62352042
         B     RETURN              RETURN                      @Z40NIVS 62354042
**                                                             @Z40NIVS 62356042
**       ROUTINE TO SAVE CHANNEL AND CONTROL UNIT FOR SUBSYS   @Z40NIVS 62358042
**                                                             @Z40NIVS 62360042
CUAN0    STM   R5,R8,XSAVE         SAVE WORK REGS              @Z40NIVS 62362042
         LA    R5,L10              LOAD DECREMENT FOR R3       @Z40NIVS 62364042
         SR    R3,R5               PNT TO START OF PRNT        @Z40NIVS 62366042
         MVC   CUANR+ONE(L3),L3(R3)  MOVE CHANEL AND CU        @Z40NIVS 62368042
         SR    R15,R15             CLR FOR NO PRNT             @Z40NIVS 62370042
         B     RETURN              RETURN                      @Z40NIVS 62372042
**                                                             @Z40NIVS 62374042
**       THE FOLLOWING PUTS THE PHYSICAL DRIVE                 @Z40NIVS 62376042
**       IN THE PRINT LINE                                     @Z40NIVS 62378042
**                                                             @Z40NIVS 62380042
SETPHY   STM   R5,R8,XSAVE         SAVE REGS                   @Z40NIVS 62382042
         IC    R5,L2(R4)               INSERT LO-ORDER BYTE OF CUA      62450042
         SLL   R5,L28              SHIFT OUT ALL BUT UNIT ADDR @Z40NIVS 62500042
         SRL   R5,L28              SHIFT UNIT ADDR BACK        @Z40NIVS 62550042
         LA    R5,PHYDRIVS(R5)         LOAD ADDR OF PHYSICAL DRIVE      62600042
         MVC   L0(L2,R3),CUANR+ONE  MOVE CHAN AND CTRL UNT     @Z40NIVS 62650042
         MVC   L2(L1,R3),L0(R5)    MOVE CUA TO PRT LINE        @Z40NIVS 62670042
         B     RETURN                  RETURN                           62700042
         EJECT                                                          62750042
*                                                                       62800042
*      THE FOLLOWING TOTALS OBR RECORDS THAT WERE SUMMARIZED            62850042
*                                                                       62900042
TOTOBR   STM   R5,R8,XSAVE             SAVE REGS                        62950042
         SR    R6,R6                   CLEAR REGS                       63000042
         AH    R6,TBUSOPA              ADD BUS OUT PARITY               63050042
         AH    R6,TEQIPATH             ADD EQUIPMENT CKS-ATTACH  XM3751 63100042
         AH    R6,TEQIPDRV             ADD EQUIPMENT CKS-DRIVE   XM3751 63120042
         AH    R6,TDACKCOR             ADD DATA CHK CORRECTABLE         63150042
         AH    R6,TDACKRET             ADD DATA CHK RETRY               63200042
         AH    R6,TDACKPRM             ADD DATA CHK PERMANENT           63250042
         AH    R6,TSEEKR               ADD SEEK CHK RETRY               63300042
         AH    R6,TSEEKP               ADD SEEK CHK PERMANENT           63350042
         AH    R6,TOVERRN              ADD OVERRUNS                     63400042
         XC    READYP(L8),READYP       CLEAR WORK AREA                  63500042
         B     CONV2                   BR TO CONVERT TOTAL TO PRINT     63550042
         SPACE 2                                                        63600042
*                                                                       63650042
*      THE FOLLOWING INITIALIZES THE COUNT FIELDS FOR THE VOLID SUMMARY 63700042
*        AND KEEPS A RUNNING TOTAL FOR EACH FIELD                       63750042
*                                                                       63800042
PRVOLS   L     R4,CNTDN2           LOAD REG 4                  @Z40NIVS 63850042
         CLC   L0(L6,R4),ZEROS     IS THERE A VOLID            @Z40NIVS 63870042
         BNE   SETTOTS                 YES - BR TO INIT SUMMARY LINE    63900042
         SPACE                                                          63950042
         SR    R15,R15                 DONT PRINT THIS LINE             64000042
         BR    R14                     RETURN                           64050042
         SPACE                                                          64100042
SETTOTS  STM   R4,R8,XSAVE             SAVE REGS                        64150042
         LR    R5,R3                   LOAD PRINT ADDR                  64200042
         MVC   L0(L6,R5),L0(R4)        MOVE VOL SER TO PRINT LINE       64250042
         LA    R5,L13(R5)          UP PRNT LINE PTR            @Z40NIVS 64256042
         IC    R6,L26(R4)          PICK UP NO. FROM TVCUA      @Z40NIVS 64262042
         SLL   R6,L28              SHIFT OUT GARBAGE           @Z40NIVS 64268042
         SRL   R6,L28              SHIFT UNIT NO.TO LOW        @Z40NIVS 64274042
         LA    R6,PHYDRIVS(R6)     PICK UP UNIT PRNT CHAR      @Z40NIVS 64280042
         MVC   L0(L2,R5),CUANR+ONE  MOVE IN CHAN AND CU        @Z40NIVS 64286042
         MVC   L2(L1,R5),L0(R6)    INSERT DRIVE NUM            @Z40NIVS 64292042
         SPACE                                                          64300042
         LA    R4,L6(R4)               BUMP CTR PTR TO SEEKS            64350042
         LA    R5,L13(R5)              BUMP PRINT POS PTR               64400042
         MVC   READYP(L4),L0(R4)       MOVE SEEKS TO WORK AREA          64450042
         L     R6,READYP               LOAD SEEKS                       64500042
         SRL   R6,L10                  REDUCE SEEK TO X1000             64550042
         L     R7,TOTSKS               LOAD TOTAL SEEKS                 64600042
         AR    R7,R6                   ADD SEEKS(THIS REC) TO TOTAL     64650042
         ST    R7,TOTSKS               SAVE NEW TOTAL                   64700042
         BAL   R8,CONVH                BR TO CONV AND MOVE SEEKS TO PNT 64750042
         EJECT                                                          64800042
         MVC   READYP(L2),L10(R4)      MOVE SEEK ERRS TO WORK AREA      64850042
         LH    R6,READYP               LOAD SEEK ERRS                   64900042
         LH    R7,TOTSKER              LOAD TOTAL SEEK ERRS             64950042
         AR    R7,R6                   ADD SEEK ERRS TO TOTAL           65000042
         STH   R7,TOTSKER              SAVE TOTAL                       65050042
         BAL   R8,CONVH                BR TO CONV AND MOVE SEEK ERRORS  65100042
         SPACE                                                          65150042
         LA    R4,L4(R4)               BUMP CTR PTR TO BYTES READ CNTRS 65200042
         MVC   READYP(L4),L2(R4)   MOVE MEGABYTES READ         @Z40NIVS 65250042
         L     R6,READYP           LOAD BYTES READ             @Z40NIVS 65350042
         L     R7,TOTMEGRD             LOAD TOTAL MEG READ              65550042
         AR    R7,R6                   ADD MEG READ TO TOTAL            65600042
         ST    R7,TOTMEGRD             SAVE TOTAL                       65650042
         ST    R6,SAVMEG               SAVE MEGABYTES READ FOR LATER    65700042
         BAL   R8,CONVH                BR TO CONV AND MOVE MEGABYTES    65750042
         SPACE                                                          65800042
         LA    R4,L8(R4)               BUMP CTR PTR TO RETRY READ ERRS  65850042
         MVC   READYP(L2),L0(R4)       MOVE RETRY READ ERRORS           65900042
         LH    R6,READYP               LOAD RETRY READ ERRORS           65950042
         LTR   R6,R6                   IS THERE A COUNT                 66000042
         BNZ   GETRETRD                YES - BR TO HANDLE               66050042
         SPACE                                                          66100042
         MVC   L0(L5,R5),NONA      NO, MOVE '-0-' TO PRINT LINE@Z40NIVS 66150042
         MVC   L13(L5,R5),NA       MOVE -N/A- TO PRNT LINE     @Z40NIVS 66170042
         LA    R5,L26(R5)              BUMP PRT POS PTR                 66200042
         B     CHKCORRD                BR TO CHECK CORR READ ERRS       66250042
         SPACE                                                          66300042
GETRETRD LH    R7,TOTRETRD             LOAD TOTAL RETRY READS           66350042
         AR    R7,R6                   ADD RETRY READS TO TOTAL         66400042
         STH   R7,TOTRETRD             SAVE TOTAL                       66450042
         BAL   R8,CONVH                BR TO CONV ANDMOVE RETRY READS   66500042
         SPACE                                                          66550042
         L     R7,SAVMEG               LOAD MEGABYTES READ FOR THIS VOL 66600042
         LR    R8,R6                   LOAD RETRY READ ERRORS           66650042
         SR    R6,R6                   CLEAR EVEN REG FOR DIVIDE        66700042
         DR    R6,R8                   DIVIDE MEG RD BY RETRY READ ERRS 66750042
         LR    R6,R7                   LOAD QUOTIENT(MEG/RET READ)      66800042
         BAL   R8,CONVH                BR TO CONV AND MOVE MEG/RET RDS  66850042
         EJECT                                                          66900042
CHKCORRD LA    R4,L2(R4)               BUMP CTR PTR TO CORR READ ERRS   66950042
         MVC   READYP(L2),L0(R4)       MOVE CORR READ ERRS TO WORK AREA 67000042
         LH    R6,READYP               LOAD CORR READ ERRS              67050042
         LTR   R6,R6                   IS THERE A COUNT                 67100042
         BNZ   GETCORRD                YES - BR TO HANDLE               67150042
         SPACE                                                          67200042
         MVC   L0(L5,R5),NONA      NO, MOVE '-0-' TO PRINT LINE@Z40NIVS 67250042
         MVC   L13(L5,R5),NA       MOVE -N/A- TO PRNT LINE     @Z40NIVS 67270042
         B     RETVOL                  BR TO RETURN                     67300042
         SPACE                                                          67350042
GETCORRD LH    R7,TOTCORRD             LOAD TOTAL CORR READ ERRS        67400042
         AR    R7,R6                   ADD CORR ERRS TO TOTAL           67450042
         STH   R7,TOTCORRD             SAVE TOTAL                       67500042
         BAL   R8,CONVH                BR TO CONV AND MOVE CORR READ ER 67550042
         SPACE                                                          67600042
         L     R7,SAVMEG               LOAD MEGABYTES READ              67650042
         LR    R8,R6                   LOAD CORR READ ERRS              67700042
         SR    R6,R6                   CLEAR 'EVEN' REG FOR DIVIDE      67750042
         DR    R6,R8                   DIVIDE MEG RD BY CORR READ ERRS  67800042
         LR    R6,R7                   LOAD QUOTIENT(MEG/CORR READ)     67850042
         BAL   R8,CONVH                BR TO CONV AN MOVE MEG/CORR READ 67900042
         SPACE                                                          67950042
RETVOL   LM    R4,R8,XSAVE             RESTORE REGS                     68000042
         BR    R14                     RETURN                           68050042
         SPACE 2                                                        68100042
*        THE FOLLOWING CONVERTS A COUNT IN REG 6 TO                     68150042
*        PRINTABLE EBCDIC AND MOVES IT TO THE PRINT LINE                68200042
         SPACE                                                          68250042
CONVH    XC    READYP(L8),READYP       CLEAR WORK AREA                  68300042
         CVD   R6,READYP               CONVERT COUNT TO DECIMAL         68350042
         UNPK  READYP(L5),READYP+L5(L3) UNPACK COUNT                    68400042
         OI    READYP+L4,CLRSGN        FIX SIGN                         68450042
         MVC   L0(L5,R5),READYP        MOVE TO PRINT LINE               68500042
         LA    R5,L13(R5)              BUMP PRINT POSITION POINTER      68550042
         BR    R8                      RETURN TO MAINLINE               68600042
         EJECT                                                          68650042
*                                                                       68700042
*      THE FOLLOWING INITIALIZES THE TOTALS FOR THE VOLID SUMMARY       68750042
*                                                                       68800042
GETTOTS  STM   R5,R8,XSAVE             SAVE REGS                        68850042
         LR    R5,R3                   LOAD PRINT POSITION ADDR         68900042
         SPACE                                                          68950042
         L     R6,TOTSKS               LOAD TOTAL SEEKS                 69000042
         BAL   R8,CONVH                BR TO CONVERT & MOVE TO PRINT    69050042
         SPACE                                                          69100042
         LH    R6,TOTSKER              LOAD TOTAL SEEK ERRORS           69150042
         BAL   R8,CONVH                BR TO CONVERT & MOVE TO PRINT    69200042
         SPACE                                                          69250042
         L     R6,TOTMEGRD             LOAD TOTAL MEGABYTES READ        69300042
         BAL   R8,CONVH                BR TO CONVERT & MOVE TO PRINT    69350042
         SPACE                                                          69400042
         LH    R6,TOTRETRD             LOAD TOTAL RETRY READ ERRORS     69450042
         BAL   R8,CONVH                BR TO CONVERT & MOVE TO PRINT    69500042
         SPACE                                                          69550042
         L     R7,TOTMEGRD             LOAD TOTAL MEG READ              69600042
         LH    R8,TOTRETRD             LOAD TOTAL RETRY READ ERRORS     69650042
         LTR   R8,R8                   WERE THERE ANY RETRY READ ERRS   69700042
         BZ    NOMEGR                  NO - BR TO MOVE 'N/A'            69750042
         SR    R6,R6                   CLEAR 'EVEN' REG                 69800042
         DR    R6,R8                   DIVIDE TO FIND MEG READ PER PETY 69850042
         LR    R6,R7                   LOAD QUOTIENT(MEG/RET READ)      69900042
         BAL   R8,CONVH                BR TO CONVERT AND MOVE TO PRINT  69950042
         B     GETCRTOT                BR TO GET CORR READ TOTAL        70000042
*                                                                       70050042
NOMEGR   MVC   L0(L5,R5),NA        MOVE 'N/A' TO PRINT LINE    @Z40NIVS 70100042
         LA    R5,L13(R5)              BUMP PRINT POSITION PTR          70150042
         SPACE                                                          70200042
GETCRTOT LH    R6,TOTCORRD             LOAD TOTAL CORRECTABLE READ ERRS 70250042
         BAL   R8,CONVH                BR TO CONVERT & MOVE TO PRINT    70300042
         SPACE                                                          70350042
         L     R7,TOTMEGRD             LOAD TOTAL MEG READ              70400042
         LH    R8,TOTCORRD             LOAD CORR READ ERRS              70450042
         LTR   R8,R8                   WERE THERE ANY CORR READ ERRS    70500042
         BZ    NOMEGC                  NO - BR TO MOVE 'N/A'            70550042
         SR    R6,R6                   CLEAR 'EVEN' REG                 70600042
         DR    R6,R8                   DIVIDE TO FIND MEG READ PER CORR 70650042
         LR    R6,R7                   LOAD QUOTIENT(MEG/CORR READ ER)  70700042
         BAL   R8,CONVH                BR TO CONVERT AND MOVE TO PRINT  70750042
         B     CLRTOTS                 BR TO CLEAR TOTAL AREAS          70800042
*                                                                       70850042
NOMEGC   MVC   L0(L5,R5),NA        MOVE 'N/A' TO PRINT LINE    @Z40NIVS 70900042
         LA    R5,L13(R5)              BUMP PRINT POSITION PTR          70950042
         EJECT                                                          71000042
CLRTOTS  SR    R6,R6                   CLEAR REG                        71050042
         ST    R6,TOTSKS               C                                71100042
         ST    R6,TOTMEGRD              L     T     A                   71150042
         ST    R6,SAVMEG                 E     O     R                  71200042
         STH   R6,TOTSKER                 A     T     E                 71250042
         STH   R6,TOTRETRD                 R     A     A                71300042
         STH   R6,TOTCORRD                        L     S               71350042
         B     RETURN                  RETURN                           71400042
         EJECT                                                          71450042
*                                                                       71500042
*      THE FOLLOWING RETURNS TO EREP CONTROL                            71550042
*                                                                       71600042
RETURN   LM    R5,R8,XSAVE             RESTORE REGS                     71650042
SKIPPER  BR    R14                     RETURN                           71700042
**                                                             @Z40NIVS 71750042
**       SORT FOR VOLID TO PUT HIGHEST ERROR                   @Z40NIVS 71751042
**       RATE TO PRINT FIRST                                   @Z40NIVS 71752042
**                                                             @Z40NIVS 71753042
SORTV0   STM   R5,R8,XSAVE         SAVE WORK REG               @Z40NIVS 71754042
         ST    R4,SRTSAV           SAVE REG 4                  @Z40NIVS 71755042
         ST    R4,CNTDN2           SAVE VOL PNTR FOR PRT       @Z40NIVS 71756042
SORTV1   SR    R8,R8               CLR REG 8 FOR SWITCH        @Z40NIVS 71757042
         L     R4,SRTSAV           SET 4 TO START OF SUM       @Z40NIVS 71758042
         LA    R5,L27(R4)          SET 5 TO NEXT REC           @Z40NIVS 71759042
         LA    R7,L49              SET 7 TO NO.REC-1           @Z40NIVS 71760042
SORTV2   CLC   L0(L6,R5),ZEROS     IS THERE A VOLID            @Z40NIVS 71761042
         BE    SORTV4              NO BR TO TEST SW            @Z40NIVS 71762042
         CLC   L10(L2,R4),L10(R5)  TEST FOR HIGH COUNT         @Z40NIVS 71763042
         BNH   SORTV3              BRCH IF HIGH REC FIRST      @Z40NIVS 71764042
         LA    R8,L15              SET MOVE SWITCH             @Z40NIVS 71765042
         XC    L0(L27,R4),L0(R5)   RECORD                      @Z40NIVS 71766042
         XC    L0(L27,R5),L0(R4)   SWAP                        @Z40NIVS 71767042
         XC    L0(L27,R4),L0(R5)   FOR SORT                    @Z40NIVS 71768042
SORTV3   LA    R4,L27(R4)          POINT TO NEXT REC           @Z40NIVS 71769042
         LA    R5,L27(R5)          POINT TO NEXT REC+1         @Z40NIVS 71770042
         BCT   R7,SORTV2           MORE TO TEST                @Z40NIVS 71771042
SORTV4   LTR   R8,R8               TEST PASS SWITCH            @Z40NIVS 71772042
         BZ    RETURN              ALL REC TESTED/MOVED        @Z40NIVS 71773042
         B     SORTV1              CONTINUE TO TEST/MOVE       @Z40NIVS 71774042
**                                                             @Z40NIVS 71775042
**       ROUTINE TO PRINT 50 VOLID SUM ENTRIES                 @Z40NIVS 71776042
**                                                             @Z40NIVS 71777042
CNTDN0   STM   R5,R8,XSAVE         SAVE THE REGS               @Z40NIVS 71778042
         SR    R5,R5               CLEAR REG                   @Z40NIVS 71779042
         L     R5,CNTDN3           LOAD WITH 50                @Z40NIVS 71780042
         BCT   R5,CNTDN1           BRANCH FOR 50               @Z40NIVS 71781042
CNTDN5   SR    R15,R15             CLEAR FOR NO PRINT          @Z40NIVS 71782042
         B     RETURN              RETURN                      @Z40NIVS 71783042
CNTDN1   ST    R5,CNTDN3           SAVE R 5                    @Z40NIVS 71784042
         L     R5,CNTDN2           GET CNTDN VALUE             @Z40NIVS 71785042
         LA    R5,L27(R5)          INCREMENT BY 27             @Z40NIVS 71786042
         CLC   L0(L6,R5),ZEROS     TESTFOR VOLID EQ ZERO       @Z40NIVS 71787042
         BE    CNTDN5              BRANCH NONE TO PRNT         @Z40NIVS 71788042
         ST    R5,CNTDN2           PUT IT BACK                 @Z40NIVS 71789042
         LA    R5,SUMTA3-FOUR      GET LINE ADDRESS            @Z40NIVS 71790042
         LA    R6,SUMTA4-ONE       GET LABEL ADDRESS           @Z40NIVS 71791042
         STM   R5,R6,YR9PTR        MAKE THEM CURRENT           @Z40NIVS 71792042
         B     RETURN              RETURN                      @Z40NIVS 71793042
         SPACE 1                                               @Z40NIVS 71794042
**                                                             @Z40NIVS 71795042
**       ROUTINE TO DETERMINE IF FLTSYM SHOULD BE EDITED       @Z40NIVS 71796042
**                                                             @Z40NIVS 71797042
FLTTST0  STM   R5,R8,XSAVE         SAVE WORK REGS              @Z40NIVS 71798042
         LA    R4,L40(R4)          INCREMENT TO FIRST RECORD   @Z427VLS 71799042
         CLC   L0(L4,R4),ZEROS     ARE SYM AND CUA ZERO        @Z40NIVS 71800042
         BNE   FLTTST1             NO CONTINUE TO PRINT        @Z40NIVS 71801042
         LA    R7,SUMTAC-FOUR      YES, PREPARE TO SKIP        @Z40NIVS 71802042
         LA    R8,SUMTAD-ONE       ROUTINES FOR FLT SYM        @Z40NIVS 71803042
         STM   R7,R8,YR9PTR        EDIT                        @Z40NIVS 71804042
FLTTST1  B     RETURN              RETURN                      @Z40NIVS 71805042
**                                                             @Z40NIVS 71806042
**       ROUTINE FOR SORTING THE FAULT SYMPTOM ENTRIES         @Z40NIVS 71807042
**                                                             @Z40NIVS 71808042
FLTSRT0  STM   R5,R8,XSAVE         SAVE WORK REGS              @Z40NIVS 71809042
         ST    R4,FLTSRT8          SAVE PNTR TO EDIT AREA      @Z40NIVS 71810042
         SR    R6,R6               CLEAR FOR SWITCH            @Z40NIVS 71811042
FLTSRT1  LA    R4,L40(R4)          INCREMENT TO FIRST RECORD   @Z427VLS 71812042
         SR    R7,R7               CLR MOVE SWITCH             @Z40NIVS 71813042
         LA    R8,L50              SET R8 TO NUM REC           @Z40NIVS 71814042
FLTSRT2  CLC   L42(L2,R4),ZEROS    IS DEV ADDR ZERO            @Z427VLS 71815042
         BE    FLTSRT6             END REC AREA                @Z40NIVS 71816042
FLTSRT3  CLC   L2(L2,R4),L42(R4)   COMP CUA/SYM                @Z427VLS 71817042
         BNH   FLTSRT4             BRCH IF ASCENDING ORDER     @Z40NIVS 71818042
         XC    L0(L40,R4),L40(R4)  SWAP REC                    @Z40NIVS 71819042
         XC    L40(L40,R4),L0(R4)  PUT IN ASCENDING            @Z40NIVS 71820042
         XC    L0(L40,R4),L40(R4)  ORDER                       @Z40NIVS 71821042
         LA    R7,L15              TURN MOVE SWITCH ON         @Z40NIVS 71822042
FLTSRT4  LA    R4,L40(R4)          INCRMENT FOR NEXT TEST      @Z427VLS 71823042
         BCT   R8,FLTSRT2          GO MAX 50 PASSES            @Z40NIVS 71824042
FLTSRT6  LTR   R7,R7               MOVE SWITCH SET             @Z40NIVS 71825042
         BZ    FLTSRT7             YES SORT COMPLETE           @Z40NIVS 71826042
         L     R4,FLTSRT8          RESET R4 TO START           @Z40NIVS 71827042
         B     FLTSRT1             GO CYCLE ONCE MORE          @Z40NIVS 71828042
FLTSRT7  L     R4,FLTSRT8          NO RESTORE R4               @Z40NIVS 71829042
         LTR   R6,R6               IS THIS FIRST SORT          @Z40NIVS 71830042
         BNZ   FLTSRT9             NO GO TO COMPLETION         @Z40NIVS 71831042
         LA    R6,L15              YES SET SORT SWITCH         @Z40NIVS 71832042
         NI    FLTSRT3+THREE,BASEDISP  ALTER CLC INSTR         @Z40NIVS 71833042
         NI    FLTSRT3+FIVE,BASEDISP  FOR NEXT SORT            @Z40NIVS 71834042
         B     FLTSRT1             SORT ON SYM CODE            @Z40NIVS 71835042
FLTSRT9  MVC   L0(L40,R4),L40(R4)  MOVE FIRST REC TO EDIT      @Z427VLS 71836042
         LA    R4,L40(R4)          INCR R4 BY REC LENGTH       @Z427VLS 71837042
         ST    R4,FLTMOV2          KEEP USE BY MOVE RTNE       @Z40NIVS 71838042
         LA    R6,L48              SET REG 6 TO NUM REC        @Z40NIVS 71839042
         ST    R6,FLTMOV6          KEEP USE BY MOVE RTNE       @Z40NIVS 71840042
         B     RETURN                                          @Z40NIVS 71841042
         SPACE 1                                               @Z40NIVS 71842042
**                                                             @Z40NIVS 71843042
**       ROUTINE TO MOVE NEXT REC FROM SUM AREA                @Z40NIVS 71844042
**       TO EDIT AREA TO PRINT                                 @Z40NIVS 71845042
**                                                             @Z40NIVS 71846042
FLTMOV0  STM   R5,R8,XSAVE         SAVE WORK REG               @Z40NIVS 71847042
         L     R5,FLTMOV2          PICK UP PNTR LAST REC       @Z40NIVS 71848042
         LA    R5,L40(R5)          POINT TO NEW REC            @Z427VLS 71849042
         ST    R5,FLTMOV2          SAVE PNTR                   @Z40NIVS 71850042
         CLC   L2(L2,R5),ZEROS     IS REC EQ ZERO              @Z40NIVS 71851042
         BNE   FLTMOV1             NO GO TO MOVE               @Z40NIVS 71852042
         B     FLTMOV3             BRNCH PREPARE NEW EDIT      @Z40NIVS 71853042
FLTMOV1  MVC   L0(L40,R4),L0(R5)   MOVE NEW REC TO EDIT        @Z427VLS 71854042
         LA    R7,SUMTA7-FOUR      BACK UP LINE AND            @Z40NIVS 71855042
         LA    R8,SUMTA8-ONE       LABEL PNTR TO               @Z40NIVS 71856042
         STM   R7,R8,YR9PTR        PRINT NEXT REC              @Z40NIVS 71857042
         L     R6,FLTMOV6          SET R6 TO NUM REC LEFT      @Z40NIVS 71858042
         BCT   R6,FLTMOV7          REDUCE COUNT BY ONE         @Z40NIVS 71859042
         B     FLTMOV3             END FIRST SECTION           @Z40NIVS 71860042
FLTMOV7  ST    R6,FLTMOV6          SAVE NUM REC REMAIN         @Z40NIVS 71861042
         SR    R15,R15             CLR FOR NO PRINT            @Z40NIVS 71862042
FLTMOV3  B     RETURN              RETURN *************        @Z40NIVS 71863042
**                                                             @Z40NIVS 71864042
**       ROUTINE TO MOVE DATE TO FAULT SYMPTON PRINTLINE       @Z40NIVS 71865042
**                                                             @Z40NIVS 71866042
FLTSYDA  UNPK  XSAVE(L8),L1(L3,R4) UNPACK THE DATE             @Z40NIVS 71867042
         MVC   L0(L3,R3),XSAVE+L5  MOVE JULIAN DATE            @Z40NIVS 71868042
         MVI   L3(R3),SLASH        MOVE SERARATOR              @Z40NIVS 71869042
         MVC   L4(L2,R3),XSAVE+L3  MOVE YEAR                   @Z40NIVS 71870042
         LA    R4,L4               LOAD R4 WITH 4              @Z427VLS 71871042
         SR    R3,R4               REDUCE PRINT LINE PTR       @Z40NIVS 71872042
         BR    R14                 RETURN                      @Z40NIVS 71873042
**                                                             @Z40NIVS 71874042
**       ROUTINE TO PREPARE CONVERT OCCUR COUNT TO PRINTABLE   @Z40NIVS 71875042
**       FORMAT.                                               @Z40NIVS 71876042
**                                                             @Z40NIVS 71877042
GETOCCUR STM   R5,R8,XSAVE         STORE WORK REGS             @Z40NIVS 71878042
         LA    R5,L20              BLANK OUT                   @Z40NIVS 71879042
         LR    R6,R3               LEADING ZERO                @Z40NIVS 71880042
         SR    R6,R5               ON DEVICE                   @Z40NIVS 71881042
         MVI   L0(R6),BLANK        ADDRESS                     @Z40NIVS 71882042
         MVC   READYP(L4),L0(R4)   MOVE CNT FIELD TO WORD      @Z40NIVS 71883042
         L     R6,READYP           MOVE INTO REG               @Z40NIVS 71884042
         LR    R5,R3               SET PRINT LINE POINTER      @Z40NIVS 71885042
         BAL   R8,CONVH            USE STANDARD ROUTINE        @Z40NIVS 71886042
         B     RETURN              RETURN                      @Z40NIVS 71887042
**                                                             @Z40NIVS 71888042
**       ROUTINE TO REFORMAT TIME IN FAULT SYMPTOM OUTPUT      @Z40NIVS 71889042
**                                                             @Z40NIVS 71890042
HREDIT0  STM   R5,R8,XSAVE         SAVE WORK REGS              @Z40NIVS 71891042
         LA    R5,L10              SET REG5 TO 10              @Z427VLS 71892042
         SR    R3,R5               DECR PRNT LINE PNTR         @Z40NIVS 71893042
         MVC   READYP(L6),L0(R3)   SAVE FORMATED OUTPUT        @Z40NIVS 71894042
         MVI   L0(R3),COLON        MOVE IN SEPERATOR CHAR      @Z40NIVS 71895042
         MVC   L1(L2,R3),READYP    MOVE MIN TO PRNT LINE       @Z40NIVS 71896042
         MVI   L3(R3),COLON        MOVE IN SEPERATOR CHAR      @Z40NIVS 71897042
         MVC   L4(L2,R3),READYP+TWO  MOVE SEC TO PRNT LINE     @Z40NIVS 71898042
         MVI   L6(R3),COLON        MOVE IN SEPERATOR CHAR      @Z40NIVS 71899042
         MVC   L7(L2,R3),READYP+FOUR  MOVE THOU TO PRNT LINE   @Z40NIVS 71900042
         B     RETURN              RETURN                      @Z40NIVS 71901042
**                                                             @Z40NIVS 71902042
**       ROUTINE TO CONVERT BYTES READ TO MEGABYTES            @Z40NIVS 71903042
**       READ AND SETUP FOR SORT                               @Z40NIVS 71904042
**                                                             @Z40NIVS 71905042
SETUP0   STM   R5,R8,XSAVE         SAVE WORK REGS              @Z40NIVS 71906042
         LA    R8,L50              LOAD NO. OF SUM REC         @Z40NIVS 71907042
SETUP1   CLC   L0(L6,R4),ZEROS     IS VOLID ZERO               @Z40NIVS 71908042
         BE    SETUP5              GO TO RETURN                @Z40NIVS 71909042
         MVC   READYP(L2),L18(R4)  MOVE RETRY COUNT            @Z40NIVS 71910042
         LH    R5,READYP           LOAD RETRY COUNT            @Z40NIVS 71911042
         MVC   READYP+L2(L6),L10(R4) MOVE IN BYTES READ        @Z40NIVS 71912042
         LH    R6,READYP+L2        LOAD OVERFLOW BYTES         @Z40NIVS 71913042
         L     R7,READYP+L4        LOAD BYTES READ             @Z40NIVS 71914042
         SRDL  R6,L20              CONVERT TO MEGABYTES        @Z40NIVS 71915042
         ST    R7,SETUP7           SAVE FOR MOVE               @Z40NIVS 71916042
         MVC   L12(L4,R4),SETUP7   MOVE MEGABYTES TO REC       @Z40NIVS 71917042
         CR    R7,R5               COMPARE RETRY TO MEGA       @Z40NIVS 71918042
         BNL   SETUP2              MEGA IS HIGH                @Z40NIVS 71919042
         MVC   L10(L2,R4),ZEROS    MOVE IN ZEROS TO SORT       @Z40NIVS 71920042
         B     SETUP4              GO AGAIN                    @Z40NIVS 71921042
SETUP2   LTR   R5,R5               TEST FOR NO RETRY           @Z40NIVS 71922042
         BZ    SETUP6              GO SET FOR SORT             @Z40NIVS 71923042
         SR    R6,R6               CLR REG 6 FOR DIV           @Z40NIVS 71924042
         DR    R6,R5               RETRY INTO MEGABYTES        @Z40NIVS 71925042
         ST    R7,SETUP7           SAVE RATIO RETRY/MEGA       @Z40NIVS 71926042
SETUP3   MVC   L10(L2,R4),SETUP7+L2 MOVE RATIO FOR SORT        @Z40NIVS 71927042
SETUP4   LA    R4,L27(R4)          INCREMENT TO NEXT REC       @Z40NIVS 71928042
         BCT   R8,SETUP1           DECREMENT CNT AND GO        @Z40NIVS 71929042
SETUP5   B     RETURN              RETURN                      @Z40NIVS 71930042
SETUP6   OI    SETUP7+L2,SORTFLG   SET UP FOR SORT             @Z40NIVS 71931042
         B     SETUP3              GO TO MOVE                  @Z40NIVS 71932042
**                                                             @Z40NIVS 71933042
**       THE FOLLOWING INITIALIZES THE COMMAND                 @Z40NIVS 71934042
**       AND DATA OVERRUN COUNTS                               @Z40NIVS 71935042
**                                                             @Z40NIVS 71936042
GETCHANT STM   R4,R8,XSAVE         SAVE REGS                   @Z40NIVS 71937042
         LR    R5,R3               LOAD PRINT POS ADDR         @Z40NIVS 71938042
         LA    R7,L4               LOAD # OF POSIBLE CHANNELS  @Z40NIVS 71939042
         SPACE                                                          72100042
SETCHANT LH    R6,L0(R4)               LOAD OVERRUN COUNT               72150042
         BAL   R8,CONVH                BR TO CONVERT & MOVE TO PRINT    72200042
         LA    R4,L4(R4)               BUMP COUNTER PTR TO NXT COUNT    72250042
         LA    R5,L16(R5)              BUMP PRINT POS PTR               72300042
         BCT   R7,SETCHANT             BR TO SET COUNT FOR NXT CHANNEL  72350042
         B     RETVOL                  RETURN                           72400042
         SPACE 2                                                        72450042
*                                                                       72500042
*      THE FOLLOWING SAVES REGS,FREES STORAGE FOR COUNTERS,AND CHECKS   72550042
*        TO SEE IF THERE IS ANOTHER SET OF COUNTERS TO BE SUMMARIZED.   72600042
*        IF THERE IS,POINT TO TOP OF TABLE AND SUMMARIZE THOSE COUNTS.  72650042
*                                                                       72700042
THEEND   STM   R14,R12,L12(R13)        SAVE REGS                        72750042
         LR    R12,R13                 LOAD SAVE AREA ADDR              72800042
         LA    R13,FSAVE               LOAD MY SAVE AREA ADDR           72850042
         ST    R12,L4(R13)             SAVE CALLERS SAVE AREA ADDR      72900042
         ST    R13,L8(R13)             SAVE MY SAVE AREA ADDR IN CALLER 72950042
         SPACE                                                          73000042
         L     R3,L4(R2)               LOAD ADDR OF NEXT COUNTERS       73050042
         ST    R3,L28(R12)             SAVE COUNTER ADDR                73100042
         SPACE                                                          73150042
         LH    R0,SIZE                 LOAD SIZE OF COUNTERS            73200042
         LR    R1,R2                   LOAD ADDR OF COUNTERS            73250042
         FREEMAIN  R,LV=(0),A=(1)      FREE COUNTER STORAGE             73300042
         SPACE                                                          73350042
         LTR   R3,R3                   ARE THERE MORE COUNTERS          73400042
         BZ    RETURNF                 NO - RETURN                      73450042
         SPACE                                                          73500042
         LA    R5,PENTRY+L10           LOAD EDIT TABLE ADDR             73550042
         ST    R5,YR9PTR               STORE ADDR FOR EREP CONTROL      73600042
         LA    R5,LABELS-L1            LOAD LABEL ADDR                  73650042
         ST    R5,YLABEL               STORE ADDR FOR EREP CONTROL      73700042
         SPACE                                                          73750042
RETURNF  L     R13,L4(R13)             LOAD CALLERS SAVE AREA ADDR      73800042
         LM    R14,R12,L12(R13)        RESTORE REGS                     73850042
         BR    R14                     RETURN                           73900042
         EJECT                                                          73950042
*                                                                       74000042
*      THE FOLLOWING STORAGE CONSTANTS ARE USED BY THE                  74050042
*        ABOVE ROUTINES                                                 74100042
*                                                                       74150042
         DS    0D                                                       74200042
FSAVE    DC    18F'0'                  FULL REG SAVE AREA               74250042
         SPACE                                                          74300042
READYP   DC    D'0'                                                     74350042
ZEROS    DC    2F'0'                                                    74400042
         SPACE                                                          74450042
XSAVE    DC    5F'0'                   REG SAVE AREA                    74500042
         SPACE                                                          74550042
TOTSKS   DC    F'0'                                                     74600042
TOTMEGRD DC    F'0'                                                     74650042
SAVMEG   DC    F'0'                    SAVE AREA FOR MEGABYTES READ     74700042
TOTSKER  DC    H'0'                                                     74750042
TOTRETRD DC    H'0'                                                     74800042
TOTCORRD DC    H'0'                                                     74850042
RECTST4  DC    F'0'                                            @Z40NIVS 74853042
RECTSTS  DC    F'0'                SAVE AREA SUM REC PNTR      @Z40NIVS 74856042
RECTSTP  DC    F'0'                SAVE AREA DEV REC PNTR      @Z40NIVS 74859042
TFAULT7  DC    F'0'                                            @Z40NIVS 74862042
EDTFA4   DC    F'16'                                           @Z40NIVS 74865042
EDTFA5   DC    F'0'                                            @Z40NIVS 74868042
CUANR    DC    F'0'                SAVE AREA FOR CH-CU         @Z40NIVS 74871042
SRTSAV   DC    F'0'                SAVE FOR REG 4              @Z40NIVS 74874042
CNTDN2   DC    F'0'                                            @Z40NIVS 74877042
CNTDN3   DC    F'50'                                           @Z40NIVS 74880042
FLTSRT8  DC    F'0'                                            @Z40NIVS 74883042
FLTMOV2  DC    F'0'                                            @Z40NIVS 74886042
FLTMOV4  DC    F'0'                                            @Z40NIVS 74889042
FLTMOV6  DC    F'0'                                            @Z40NIVS 74892042
SETUP7   DC    F'0'                SAVE AREA                   @Z40NIVS 74895042
         SPACE                                                          74900042
SIZE     DC    H'3972'                                         @Z427VLS 74950042
         SPACE                                                          75000042
UNKNOWN  DC    C'UNKNOWN'                                               75050042
SHARED   DC    C'SHARED'                                       @Z427VLS 75100042
NA       DC    C'-N/A-'                                        @Z40NIVS 75200042
NONA     DC    C'00000'                                        @Z40NIVS 75220042
         SPACE                                                          75250042
PHYDRIVS DC    C'0123456789ABCDEF'                             @Z40NIVS 75300042
         SPACE                                                          75350042
DEVNUM   EQU   1                       NUMBER OF DEVICES SUPPORTED      75400042
DEVTABLE DC    X'200A'                 DEVICE TYPE &                    75450042
         DC    X'09'                         REC ID FOR A               75500042
         DC    C'3340  '                           WINCHESTER           75550042
         EJECT                                                          75600042
*                                                                     * 75650042
*   S U M M A R Y  T A B L E  F O R  3 3 4 0 ( W I N C H E S T E R )  * 75700042
*                                                                     * 75750042
PENTRY   DS    0F                                                       75800042
         DC    X'0001001'                                               75850042
         DC    X'0001001'                                               75900042
         DC    A(LABELS)                                                75950042
         DC    H'0'                                                     76000042
         LINE  (1,1),(1,1),SKIP=2                              @Z40NIVS 76010042
         ROUTINE YDUMA,SKIPPER                                 @Z40NIVS 76020042
         LABEL ''                                              @Z40NIVS 76030042
         SPACE                                                          76050042
*                                                                       76100042
*      SKIP TO CHANNEL 1(EJECT)                                         76150042
*                                                                       76200042
         DC    X'01'                                                    76250042
         DC    X'000B8B00'                                              76300042
         SPACE                                                          76350042
         LABEL ' '                                                      76400042
         LINE  (61,23),(1,19),SKIP=2                           @Z40NIVS 76450042
         ROUTINE   TRECLS,MOVDEV                                        76500042
         HEX   YCPU,0,2B                                                76550042
         HEX   YSER,0,3B                                                76600042
         ROUTINE   YCPU,SETCPUNO                                        76650042
         LABEL 'SUMMARY OF I/O RECO','RDS  TYPE OBR/MDR  ',    @Z40NIVSC76700042
               'SOURCE-OUTBOARD   D',                          @Z40NIVSC76730042
               'EVICE TYPE ',' MODEL-','SERIAL NO.-'           @Z40NIVS 76760042
         LINE  ,(13,13),SKIP=1                                          76800042
         ROUTINE   YDUMA,SKIPPER                                        76850042
         LABEL 'DAY YEAR','DAY YEAR'                                    76900042
         LINE  (13,13),(1,21),SKIP=2                                    76950042
         ROUTINE   TDAY1,SETDATE                                        77000042
         ROUTINE   TDAY2,SETDATE                                        77050042
         LABEL 'DATE RANGE-','TO'                              @Z40NIVS 77100042
         LINE  (1,10),,SKIP=2                                  @Z40NIVS 77130042
         HEX   YCUA,0,3B                                       @Z40NIVS 77160042
         ROUTINE YDUMA,CUAN0                                   @Z40NIVS 77190042
         LABEL ''                                              @Z40NIVS 77220042
         LINE  ,,SKIP=1                                        @Z40NIVS 77250042
         ROUTINE YDUMA,SKIPPER                                 @Z40NIVS 77280042
         LABEL 'PHYSICAL     BUS OUT     EQUIP. CHECK         DATA CHECX77310042
               K         SEEK CHECK      OVERRUN     STATISTICAL'       77340042
         LINE  ,,SKIP=3                                        @Z40NIVS 77370042
         ROUTINE TSTAT,EDTFA6                                  @Z40NIVS 77400042
         LABEL 'ADDRESS      PARITY      C.U.    DRIVE     PERM  CORR  X77430042
               RETRY     PERM  RETRY'                          @Z40NIVS 77460042
SUMTA1   LINE  (1,6),,SKIP=1                                   @Z427VLS 77490042
         HEX   TCUA,00000000,3B    CONVERT DEVICE ADDR         @Z40NIVS 77520042
         ROUTINE YDUMA,REPNT0      UPDATE PRNT LINE PTR        @Z40NIVS 77550042
         ROUTINE TBUSOPA,CONV1     CONV BUS OUT PARITY         @Z40NIVS 77580042
         ROUTINE YDUMA,SKIPPER     UPDATE PRNT LINE PTR        @Z40NIVS 77610042
         ROUTINE TEQIPATH,CONV1    ATTACH EQ CHK               @Z40NIVS 77640042
         ROUTINE YDUMA,REPNT1      UPDATE LINE PTR             @Z40NIVS 77670042
         ROUTINE TEQIPDRV,CONV1    DRIVE EQ CHK                @Z40NIVS 77700042
         ROUTINE YDUMA,REPNT2      UPDATE PRNT LINE PTR        @Z40NIVS 77730042
         ROUTINE TDACKPRM,CONV1    DATA CHK PERM               @Z40NIVS 77760042
         ROUTINE TDACKCOR,CONV1    DATA CHK CORR               @Z40NIVS 77790042
         ROUTINE TDACKRET,CONV1    DATA CHK RETRY              @Z40NIVS 77820042
         ROUTINE YDUMA,REPNT2      UPDATE PRNT LINE PTR        @Z40NIVS 77850042
         ROUTINE TSEEKP,CONV1      SEEK CHK PERM               @Z40NIVS 77880042
         ROUTINE TSEEKR,CONV1      SEEK CHK RETRY              @Z40NIVS 77910042
         ROUTINE YDUMA,REPNT2      UPDATE PRNT LINE PTR        @Z40NIVS 77940042
         ROUTINE TOVERRN,CONV1     OVERRUN CONV                @Z40NIVS 77970042
         ROUTINE YDUMA,SKIPPER     UPDATE PRNT LINE PTR        @Z40NIVS 78000042
         ROUTINE TSTAT,CONV1       STATISTICAL SUM             @Z40NIVS 78030042
SUMTA2   LABEL ''                                              @Z40NIVS 78060042
         LINE  (1,6),,SKIP=1                                   @Z427VLS 78090042
         ROUTINE TSTAT,EDTFA0      CYCLE THROUGH SUMREC        @Z40NIVS 78120042
         LABEL ''                                              @Z40NIVS 78150042
         LINE  ,(1,1),SKIP=2                                   @Z40NIVS 78180042
         ROUTINE SYMCD,FLTTST0                                 @Z40NIVS 78210042
         LABEL 'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXC78240042
               XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' 78270042
SUMTA5   LINE  (61,23),(1,19),SKIP=2                           @Z40NIVS 78300042
         ROUTINE TRECLS,MOVDEV                                 @Z40NIVS 78330042
         HEX   YCPU,0,2B                                       @Z40NIVS 78360042
         HEX   YSER,0,3B                                       @Z40NIVS 78390042
         ROUTINE YCPU,SETCPUNO                                 @Z40NIVS 78420042
SUMTA6   LABEL 'FAULT SYMPTOM CODE ','SUMMARY   TYPE-OBR ',    @Z40NIVSC78450042
               'SOURCE-OUTBOARD   D',                                  X78480042
               'EVICE TYPE ',' MODEL-',                                X78510042
               'SERIAL NO.-'                                   @Z40NIVS 78540042
         LINE  ,,SKIP=2                                        @Z40NIVS 78570042
         ROUTINE YDUMA,SKIPPER                                 @Z40NIVS 78600042
SUMTAA   LABEL 'SEQUENCE BY SYMPTOM CODE'                      @Z40NIVS 78630042
         LINE  (1,1),(1,12),SKIP=1                             @Z427VLS 78660042
         ROUTINE YDUMA,SKIPPER                                 @Z40NIVS 78690042
         LABEL 'FAULT','PHYSICAL','OCCURRENCES','  DATE/TIME ',,,      X78720042
               'SENSE FROM L','AST OCCURREN','CE'              @Z427VLS 78740042
         LINE  (1,1),(1,12),SKIP=1                             @Z427VLS 78760042
         ROUTINE YDUMA,SKIPPER                                 @Z40NIVS 78780042
         LABEL 'SYMPTOM','ADDRESS',,'  LAST ENTRY','           0',     X78810042
               ' 0 0 0 0 0 0',' 0 0 0 1 1 1',' 1 1 1 1 1 1',   @Z427VLSX78820042
               ' 1 2 2 2 2'                                    @Z427VLS 78830042
         LINE  ,,SKIP=1                                        @Z427VLS 78840042
         ROUTINE SYMCD,FLTSRT0                                 @Z40NIVS 78870042
         LABEL 'CODE',,,,'           0',' 1 2 3 4 5 6',' 7 8 9 0 1 2', X78900042
               ' 3 4 5 6 7 8',' 9 0 1 2 3'                     @Z427VLS 78920042
SUMTA7   LINE  (1,12),,SKIP=1                                  @Z427VLS 78940042
         HEX   SYMCD,0,2B                                      @Z40NIVS 78960042
         HEX   SYMCUA,0,2B                                     @Z40NIVS 78990042
         ROUTINE SYMOCR,GETOCCUR                               @Z40NIVS 79020042
         ROUTINE SYMDAY,FLTSYDA                                @Z40NIVS 79350042
         HEX   SYMHR,0,4B                                      @Z40NIVS 79360042
         ROUTINE YDUMA,HREDIT0     REFORMAT TIME FIELD         @Z40NIVS 79370042
         HEX   SYMSNS0,0,6B                                    @Z427VLS 79372042
         HEX   SYMSNS1,0,6B                                    @Z427VLS 79374042
         HEX   SYMSNS2,0,6B                                    @Z427VLS 79376042
         HEX   SYMSNS3,0,6B                                    @Z427VLS 79378042
SUMTA8   LABEL ''                                              @Z40NIVS 79380042
         LINE  ,,SKIP=1                                        @Z427VLS 79390042
         ROUTINE SYMCD,FLTMOV0                                 @Z40NIVS 79400042
         LABEL ''                                              @Z40NIVS 79410042
         LINE  ,(1,1)                                          @Z40NIVS 79420042
         ROUTINE YDUMA,SKIPPER                                 @Z40NIVS 79430042
         LABEL 'NOTE:  IF SYMPTOM CODE IS 0 REFER TO DETAIL OBR RECORD' 79440042
SUMTAC   LINE  ,(1,1),SKIP=2                                   @Z40NIVS 79450042
         ROUTINE  YDUMA,SKIPPER                                         79550042
SUMTAD   LABEL 'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXC79600042
               XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' 79650042
         LINE  (75,6),(1,63)                                   @Z40NIVS 79700042
         ROUTINE   TRECLS,MOVDEV                                        79750042
         ROUTINE TVOLID1,SETUP0                                @Z40NIVS 79800042
         ROUTINE TVOLID1,SORTV0                                @Z40NIVS 79810042
         LABEL 'SUMMARY OF I/O STATISTICAL AND OBR RECORDS BY VOLUME IDC79820042
               ','DEVICE TYPE'                                          79850042
         LINE  ,(2,13),SKIP=1                                           80100042
         ROUTINE   YDUMA,SKIPPER                                        80150042
         LABEL 'VOLUME ID','PHYSICAL','TOTAL','SEEK','TOTAL',  @Z40NIVSX80200042
               'RETRY','MEGABYTES','CORRECTABLE','MEGABYTES'   @Z40NIVS 80250042
         LINE                                                           80300042
         ROUTINE   YDUMA,SKIPPER                                        80350042
         LABEL ,'ADDRESS','ACCESSES','ERRORS','MEGABYTES',     @Z40NIVSX80400042
               'READ','READ/RETRY','READ','READ/CORR'          @Z40NIVS 80450042
         LINE  ,,SKIP=2                                                 80500042
         ROUTINE   YDUMA,SKIPPER                                        80550042
         LABEL ,,'(X1024)',,'READ','ERRORS','ERRORS',                  X80600042
               'ERRORS','ERRORS'                               @Z40NIVS 80630042
SUMTA3   LINE  (3,13),(1,1),SKIP=1                             @Z40NIVS 80660042
         ROUTINE   TVOLID1,PRVOLS                                       80700042
SUMTA4   LABEL ''                                              @Z40NIVS 80750042
         LINE                                                           80800042
         ROUTINE TVOLID1,CNTDN0                                @Z40NIVS 80850042
         LABEL ' '                                                      81500042
         LINE  ,,SKIP=2                                        @Z40NIVS 81550042
         ROUTINE YDUMA,SKIPPER                                 @Z40NIVS 82150042
         LABEL ''                                              @Z40NIVS 82750042
         LINE  (29,13),(3,1),SKIP=2                            @Z40NIVS 83350042
         ROUTINE   YDUMA,GETTOTS                                        84000042
         LABEL 'TOTALS'                                                 84050042
         LINE  ,(2,29),SKIP=1                                           84100042
         ROUTINE   YDUMA,SKIPPER                                        84150042
         LABEL 'TOTAL OVERRUNS CHAN A','TOTAL OVERRUNS CHAN B','TOTAL OC84200042
               VERRUNS CHAN C','TOTAL OVERRUNS CHAN D'                  84250042
         LINE  (21,29),(12,29)                                          84300042
         ROUTINE   TOCACA,GETCHANT                                      84350042
         LABEL 'COMMAND','COMMAND','COMMAND','COMMAND'                  84400042
         LINE  ,,SKIP=2                                        @Z40NIVS 84450042
         ROUTINE   TOCADA,GETCHANT                                      84500042
         LABEL 'DATA','DATA','DATA','DATA'                              84550042
         LINE  ,,SKIP=2                                        @Z40NIVS 84600042
         ROUTINE YDUMA,SKIPPER                                 @Z40NIVS 84602042
         LABEL ''                                              @Z40NIVS 84604042
         LINE  ,(1,1),SKIP=1                                   @Z40NIVS 84606042
         ROUTINE YDUMA,SKIPPER                                 @Z40NIVS 84608042
         LABEL 'NOTE:  VOLUME ID''S ARE LISTED IN ERROR RATE SEQUENCE SX84610042
               TARTING WITH THE ONE WITH HIGHEST % OF RETRY READ ERRORSX84612042
               '                                               @Z40NIVS 84614042
         LINE  ,,SKIP=1                                        @Z40NIVS 84616042
         ROUTINE YDUMA,SKIPPER                                 @Z40NIVS 84618042
         LABEL 'NOTE:  ZEROS IN MEGABYTES READ/XXXX COLUMNS INDICATE THX84620042
               AT THERE WAS LESS THAN ONE MEGABYTE READ PER ERROR'      84622042
         LINE  ,,SKIP=2                                        @Z40NIVS 84624042
         ROUTINE YDUMA,SKIPPER                                 @Z40NIVS 84626042
         LABEL 'NOTE:  N/A IS AN INDICATION OF EITHER NO RETRY READ ERRX84628042
               ORS OR CORRECTABLE READ ERRORS IN THE RESPECTIVE COUNTERX84630042
               S '                                             @Z40NIVS 84632042
         LINE  ,(1,1),SKIP=2                                   @Z40NIVS 84634042
         ROUTINE YDUMA,SKIPPER                                 @Z40NIVS 84636042
         LABEL 'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXC84638042
               XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' 84640042
         LINE  ,(1,1)                                          @Z40NIVS 84642042
         ROUTINE   YDUMA,THEEND                                         84650042
         LABEL ' '                                                      84700042
         SPACE 2                                                        84750042
         DC    X'FF'                                                    84800042
         DC    XL2'0000'                                                84850042
         DC    XL2'0018'                                                84900042
         DC    XL2'0000'                                                84950042
         SPACE                                                          85000042
         DC    C'$'                                                     85050042
LABELS   EQU   *                                                        85100042
         LSTART                                                         85150042
         SPACE 2                                                        85200042
         END                                                            85250042
