         TITLE 'IFCSCUA0  MES DATA SUMMARY BY CUA'                      00105002
         MACRO                                                          00210002
&NAME    DSGEN                                                          00315002
.*                            THIS MACRO GENERATES ONE DSECT WORD       00420002
.*                                 FORMATTED FOR THE SUBJECT LOG RECORD 00525002
.*                                 EACH OPERAND HAS TWO SUB LISTS. THE  00630002
.*                                 FIRST IS THE NAME OF THE LOG ITEM    00735002
.*                                 WHILE THE SECOND IS THE # OF BITS TO 00840002
.*                                 ALLOCATE FOR THIS ITEM. ITEMS MUST   00945002
.*                                 BE DEFINED CONTIGUOUSLY WITHOUT GAPS 01050002
.*                                 UNUSED BIT GROUPS MUST BE GIVEN      01155002
.*                                 DUMMY NAMES. THE NAMES PROVIDED FOR  01260002
.*                                 THE LOG ITEMS MAY THEN BE USED IN    01365002
.*                                 THE CONVERSION MACRO INSTRUCTIONS.   01470002
         GBLC &ITEM(1000)                                               01575002
         GBLA &ITEMNBR,&BITS(1000),&SHIFT(1000)                         01680002
         LCLB  &ONLY1,&CTIND                                            01785002
         LCLA  &START1,&START2,&END1,&END2                              01890002
         LCLC  &SYMBOL,&EQUSYM                                          01995002
         LCLA  &OP,&COUNT,&BYTE,&EQUCNT                                 02100002
         ACTR  100000                                                   02205002
.START   AIF   (N'&SYSLIST(&OP+1) LT 3).LOOP                            02310002
         AIF   ('&SYSLIST(&OP+1,3)' EQ 'EQU').LOOP     TEST FOR EQU     02415002
  AIF   ('&SYSLIST(&OP+1,3)' EQ '' AND '&SYSLIST(&OP+1,4)' EQ '').ERR1  02520002
  AIF   ('&SYSLIST(&OP+1,3)' EQ '' OR '&SYSLIST(&OP+1,4)' EQ '').ERR1   02625002
         AIF   ('&SYSLIST(&OP+1,3)' GT '&SYSLIST(&OP+1,4)').ERR3        02730002
&START1  SETA  &SYSLIST(&OP+1,3)        GET START COUNT OF 1            02835002
&START2  SETA  &SYSLIST(&OP+1,4)        GET FIRST END COUNT             02940002
         AGO   .SET2A                   BRANCH AROUND                   03045002
.ERR1    MNOTE '**FIRST SYMBOL CONCATENATION INCOMPLETE**'              03150002
         MEXIT                                                          03255002
.SET2A   AIF   ('&SYSLIST(&OP+1,5)' EQ ''AND '&SYSLIST(&OP+1,6)' EQ '' X03360002
               ).SET2                   TEST FOR NO SECOND              03465002
  AIF   ('&SYSLIST(&OP+1,5)' EQ '' OR '&SYSLIST(&OP+1,6)' EQ '').ERR2   03570002
         AIF   ('&SYSLIST(&OP+1,5)' GT '&SYSLIST(&OP+1,6)').ERR3        03675002
&END1    SETA  &SYSLIST(&OP+1,5)        GET START COUNT OF 2            03780002
&END2    SETA  &SYSLIST(&OP+1,6)        GET END COUNT OF 2              03885002
         AGO   .LOOP                                                    03990002
.SET2    ANOP                                                           04095002
&ONLY1   SETB  1                        INDICATE ONLY ONE CONCATENATION 04200002
         AGO   .LOOP                                                    04305002
.ERR2    MNOTE '**SECOND SYMBOL CONCATENATION INCOMPLETE**'             04410002
         MEXIT                                                          04515002
.ERR3    MNOTE '**START GREATER THAN END CONCATENATION**'               04620002
         MEXIT                                                          04725002
.LOOP    ANOP                                                           04830002
&OP      SETA  &OP+1                                                    04935002
         AIF   (&OP GT N'&SYSLIST).DONE      TEST IF ALL DONE           05040002
&ITEMNBR SETA  &ITEMNBR+1                                               05145002
         AIF   ('&SYSLIST(&OP,2)' NE '').OK1                            05250002
         MNOTE '**NULL BIT COUNT FIELD**'                               05355002
         MEXIT                                                          05460002
.OK1     ANOP                                                           05565002
&SYMBOL  SETC  '&SYSLIST(&OP,1)'                                        05670002
         AIF   ('&SYMBOL' NE '').OK                                     05775002
*              *****     LOG ITEM SYMBOL NOT PROVIDED     *****         05880002
         AIF   ('&SYSLIST(&OP,3)' NE 'EQU').CNT                         05985002
         AGO   .START                   GET NEXT                        06090002
.OK      AIF   (N'&SYSLIST(&OP) LT 3).NO3    TEST FOR OLD FORMAT        06195002
         AIF   ('&SYSLIST(&OP,3)' EQ 'EQU').EQU   TEST FOR EQU          06300002
         AIF   (&ONLY1).OK2             TEST FOR ONLY ONE CONCAT        06405002
&SYMBOL  SETC  '&SYMBOL.&START1.&END1'       GET 1 AND 2 CONCAT         06510002
         AGO   .NO3                     BRANCH AROUND                   06615002
.OK2     ANOP                                                           06720002
&SYMBOL  SETC  '&SYMBOL.&START1'        GET 1 CONCATENATED              06825002
.NO3     ANOP                                                           06930002
&SYMBOL  EQU   *+&BYTE                                                  07035002
&ITEM(&ITEMNBR) SETC '&SYMBOL'          GET LABEL IN GLOBAL             07140002
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2)                                    07245002
&SHIFT(&ITEMNBR) SETA &COUNT-&BYTE*8                                    07350002
.CNT     ANOP                                                           07455002
&CTIND   SETB  1                        SET COUNT INDICATOR             07560002
&COUNT   SETA  &COUNT+&SYSLIST(&OP,2)                                   07665002
&BYTE    SETA  &COUNT/8                                                 07770002
         AIF   (N'&SYSLIST(&OP) LT 3).START  TEST FOR OLD FORMAT        07875002
         AIF   (&ONLY1).TSTST           TEST FOR ONLY ONE CONCAT        07980002
         AIF   (&END1 EQ &END2).TSTST   TEST FOR SECOND END             08085002
&END1    SETA  &END1+1                  INCREMENT COUNT                 08190002
&OP      SETA  &OP-1                    DECREMENT INCREMENT             08295002
         AGO   .LOOP                    GENERATE NEXT                   08400002
.TSTST   ANOP                                                           08505002
         AIF   (&START1 EQ &START2).LPDONE   TEST FOR END               08610002
         AIF   (&ONLY1).NSET1           TEST FOR ONLY ONE CONCAT        08715002
&END1    SETA  &SYSLIST(&OP,5)          RE-INIT SECOND START COUNT      08820002
.NSET1   ANOP                                                           08925002
&OP      SETA  &OP-1                    DECREMENT INDEX                 09030002
&START1  SETA  &START1+1                INCREMENT FIRST COUNT           09135002
         AGO   .LOOP                    GO DO NEXT                      09240002
.LPDONE  ANOP                                                           09345002
&ONLY1   SETB  0                        CLEAR INDICATOR                 09450002
         AGO   .START                   GO TEST FOR MORE SUB-LISTS      09555002
.DONE    AIF   (&COUNT-&COUNT/8*8 NE 0).ERR  TEST FOR MULTIPLE OF EIGHT 09660002
         AIF   (&CTIND EQ 0).END        NO DS IF NO COUNT               09765002
&COUNT   SETA  &COUNT/8                 GET NUMBER OF BYTES             09870002
&NAME    DS    &COUNT.C                                                 09975002
.END     MEXIT                                                          10080002
.ERR     MNOTE '**BIT COUNT FLDS DO NOT TOTAL MULTIPLE OF 8**'          10185002
         MEXIT                                                          10290002
.EQU     AIF   ('&SYSLIST(&OP,4)' NE '').EQU1     TEST FOR NULL LABEL   10395002
.ERR4    MNOTE '**EQU OPERAND OMITTED OR NOT FOUND**'                   10500002
         MEXIT                                                          10605002
.EQU1    AIF   (&SYSLIST(&OP,2) LT 16).EQU2  COUNT OVER FIFTEEN         10710002
*****               THE FOLLOWING STATEMENT                *****        10815002
*****     NUMBER OF BITS EXCEED 15 - DO NOT USE AS BIN     *****        10920002
.EQU2    ANOP                                                           11025002
&EQUCNT  SETA  0                        CLEAR COUNTER                   11130002
&EQUSYM  SETC  '&SYSLIST(&OP,4)'        GET EQU OPERAND                 11235002
.EQULOP  ANOP                                                           11340002
&EQUCNT  SETA  &EQUCNT+1                INCREMENT INDEX                 11445002
         AIF   ('&ITEM(&EQUCNT)' EQ '&EQUSYM').EQUOUT  LABEL FOUND?     11550002
         AIF   (&EQUCNT EQ &ITEMNBR).ERR3    ALL TESTED?                11655002
         AGO   .EQULOP                  NO-GET NEXT                     11760002
.EQUOUT  ANOP                                                           11865002
&ITEM(&ITEMNBR) SETC '&SYMBOL'          GET LABEL NAME                  11970002
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2)    GET NUMBER OF BITS              12075002
&SHIFT(&ITEMNBR) SETA &SHIFT(&EQUCNT)   GET SHIFT COUNT                 12180002
&SYMBOL  EQU   &EQUSYM                  THIS SYMBOL EQUATED             12285002
         AGO   .START                   RETURN FOR NEXT                 12390002
         MEND                                                           12495002
*  LINE MACRO     LINE MACRO     LINE MACRO     LINE MACRO            * 12600002
         SPACE 2                                                        12705002
         MACRO                                                          12810002
&NAME    LINE  &DATA,&LABEL,&SKIP=                                      12915002
.*                            THIS MACRO ESTABLISHES THE MARGINS OR     13020002
.*                                 COLUMN SETTINGS FOR EACH LINE. IT    13125002
.*                                 GENERATES NECESSARY CARRIAGE CONTROL 13230002
.*                                 ENTRIES. LASTLY IT DETERMINES THE    13335002
.*                                 NUMBER OF ENTRIES ASSOCIATED WITH    13440002
.*                                 THE PREVIOUS LINE AND STORES THAT #  13545002
.*                                 INTO THE APPROPRIATE BYTE.           13650002
.*                            &DATA(1) - CHARACTER POSITION TO BEGIN    13755002
.*                                 DATA.                                13860002
.*                            &DATA(2) - # OF SPACES BETWEEN SUCCESSIVE 13965002
.*                                 DATA COLUMN STARTING CHARACTERS.     14070002
.*                            &LABEL(1) - CHAR. POS. TO BEGIN LABELS.   14175002
.*                            &LABEL(2) - # SPACES BETWEEN LINE'S LABEL 14280002
.*                                 STARTING CHARACTERS.                 14385002
.*                            &SKIP= - # OF LINES TO ADVANCE CARRIAGE   14490002
.*                                 TO BEGIN NEXT PRINTED LINE.          14595002
.*                            NEW ENTRIES ARE GENERATED ONLY WHEN       14700002
.*                                 NECESSARY. OMISSION OF ITEMS MEANS   14805002
.*                                 THEY HAVE NOT CHANGED SINCE PREVIOUS 14910002
.*                                 SETTINGS. A LINE MACRO IS REQUIRED   15015002
.*                                 FOR EACH PRINTED LINE. IF NO SETTING 15120002
.*                                 CHANGES ARE REQUIRED ALL OPERANDS    15225002
.*                                 ARE OMITTED IN WHICH CASE ONLY THE   15330002
.*                                 # OF ENTRIES FOR THE PREVIOUS LINE   15435002
.*                                 IS COMPUTED. THIS MACRO MUST BE THE  15540002
.*                                 FIRST MACRO INSTRUCTION ISSUED FOR   15645002
.*                                 THE SUBJECT LINE                     15750002
         GBLA  &DB,&DT,&LB,&LT,&NRENTS                                  15855002
         GBLA  &LASTCC,&INITIAL                                         15960002
         GBLC  &NRENTSX                                                 16065002
         GBLC  &CARRCON                                                 16170002
         GBLB  &TEST                                                    16275002
         LCLA  &S                                                       16380002
&NAME    DS    0C                                                       16485002
         AIF   (&INITIAL EQ 0).FIRSTLN                                  16590002
         LINEND                                                         16695002
         AGO   .NTFIRST                                                 16800002
.FIRSTLN ANOP                                                           16905002
&NRENTSX SETC  'N&SYSNDX'                                               17010002
&INITIAL SETA  1                                                        17115002
N&SYSNDX EQU   *                                                        17220002
.NTFIRST ANOP                                                           17325002
         DC    AL1(0)                                                   17430002
         AIF   ('&DATA(1)' EQ '').CKDTABS                               17535002
         AIF   (&DATA(1) EQ &DB).CKDTABS                                17640002
&DB      SETA  &DATA(1)                                                 17745002
         AGO   .AA                                                      17850002
.CKDTABS AIF   ('&DATA(2)' EQ '').NCDATA                                17955002
         AIF   (&DATA(2) EQ &DT).NCDATA                                 18060002
         AGO   .CC                                                      18165002
.AA      AIF   ('&DATA(2)' EQ '').BB                                    18270002
         AIF   (&DATA(2) EQ &DT).BB                                     18375002
.CC      ANOP                                                           18480002
&DT      SETA  &DATA(2)                                                 18585002
.BB      DC    XL2'FFFE'                                                18690002
         DC    FL1'&DB'                                                 18795002
         DC    FL1'&DT'                                                 18900002
&NRENTS  SETA  &NRENTS+1                                                19005002
.NCDATA  ANOP                                                           19110002
         AIF   ('&LABEL(1)' EQ '').CKLTABS                              19215002
         AIF   (&LABEL(1) EQ &LB).CKLTABS                               19320002
&LB      SETA  &LABEL(1)                                                19425002
         AGO   .AAA                                                     19530002
.CKLTABS AIF   ('&LABEL(2)' EQ '').NCLABEL                              19635002
         AIF   (&LABEL(2) EQ &LT).NCLABEL                               19740002
         AGO   .CCC                                                     19845002
.AAA     AIF   ('&LABEL(2)' EQ '').BBB                                  19950002
         AIF   (&LABEL(2) EQ &LT).BBB                                   20055002
.CCC     ANOP                                                           20160002
&LT      SETA  &LABEL(2)                                                20265002
.BBB     DC    XL2'FFFF'                                                20370002
         DC    FL1'&LB'                                                 20475002
         DC    FL1'&LT'                                                 20580002
&NRENTS  SETA  &NRENTS+1                                                20685002
.NCLABEL ANOP                                                           20790002
         AIF   ('&SKIP' NE '').CONT                                     20895002
         AIF   (&TEST EQ 0).NOCHANG                                     21000002
&S       SETA  &LASTCC                                                  21105002
         AGO   .DEFAULT                                                 21210002
.CONT    ANOP                                                           21315002
         AIF   (&TEST EQ 0).AB                                          21420002
&S       SETA  &SKIP                                                    21525002
.DEFAULT ANOP                                                           21630002
         ORG   &CARRCON+3                                               21735002
         DC    AL.3(0),AL.2(&S),AL.3(1)                                 21840002
         ORG                                                            21945002
&LASTCC  SETA  &S                                                       22050002
&TEST    SETB  0                                                        22155002
         AGO   .DD                                                      22260002
.AB      AIF   (&SKIP EQ &LASTCC).NOCHANG                               22365002
A&SYSNDX DC    XL2'FFFB'                                                22470002
         DC    AL.3(0),AL.2(&SKIP),AL.3(1)                              22575002
         DC    FL1'9'                                                   22680002
&LASTCC  SETA  &SKIP                                                    22785002
&TEST    SETB  1                                                        22890002
&CARRCON SETC  'A&SYSNDX'                                               22995002
&NRENTS  SETA  &NRENTS+1                                                23100002
.DD      ANOP                                                           23205002
.NOCHANG ANOP                                                           23310002
         MEND                                                           23415002
         EJECT                                                          23520002
*  BIN MACRO     BIN MACRO     BIN MACRO     BIN MACRO     BIN MACRO  * 23625002
         SPACE 2                                                        23730002
         MACRO                                                          23835002
         BIN   &LOGITEM,&SKIP$OR                                        23940002
.*                                 &LOGITEM - NAME OF ITEM IN LOG       24045002
.*                                      RECORD DSECT                    24150002
.*                                 &SKIP$OR - NBR OF SPACES TO SKIP ON  24255002
.*                                 MULTIPLE PRINT OR NBR OF SPACES      24360002
.*                                      TO BACK UP FROM COLUMN FOR      24465002
.*                                      START OF PRINTING. THE LETTER   24570002
.*                                      B PRECEEDS THE NUMBER (B5) IF   24675002
.*                                      THE LATTER IS DESIRED. OMISSION 24780002
.*                                      OF THIS OPERAND FORCES OPTION 2 24885002
.*                                      WITH BACKUP SPACING EQUAL TO    24990002
.*                                 THE NUMBER OF BITS IN THE ITEM       25095002
.*                                 DEFINITION (VIA MACRO 'DSGEN').      25200002
.*                            A LIMIT OF 15 BITS IS IMPOSED FOR THE     25305002
.*                                 TOTAL NUMBER OF BITS TO PRINT.       25410002
         GBLC &ITEM(1000)                                               25515002
         GBLA &ITEMNBR,&BITS(1000),&SHIFT(1000),&NRENTS                 25620002
         GBLC  &DSECT                                                   25725002
         LCLB  &B                                                       25830002
         LCLA  &IBITS,&NDX,&ISHIFT,&K                                   25935002
         LCLA  &TEMP,&T                                                 26040002
         LCLC  &S                                                       26145002
.LOOP    ANOP                                                           26250002
&NDX     SETA  &NDX+1                                                   26355002
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      26460002
         AIF   (&NDX LT &ITEMNBR).LOOP                                  26565002
         MNOTE *,'YOU BLEW IT'                                          26670002
         ROUTINE DUM,SKIPPER                                            26775002
         MEXIT                                                          26880002
.FOUND   ANOP                                                           26985002
&ISHIFT  SETA  &SHIFT(&NDX)                                             27090002
&IBITS   SETA  &BITS(&NDX)                                              27195002
&T       SETA  &IBITS-1                                                 27300002
&B       SETB  0                                                        27405002
         AIF   ('&SKIP$OR' EQ '').BACKUP                                27510002
&K       SETA  K'&SKIP$OR                                               27615002
&B       SETB  ('&SKIP$OR'(1,1) EQ 'B')                                 27720002
&S       SETC  '&SKIP$OR'(&B+1,&K-&B)                                   27825002
&T       SETA  &S                                                       27930002
.BACKUP  ANOP                                                           28035002
&NRENTS  SETA  &NRENTS+1                                                28140002
&TEMP    SETA  &ISHIFT                                                  28245002
A&SYSNDX DC    AL.12(&LOGITEM-&DSECT),XL.4'&TEMP'                       28350002
         AIF (&IBITS EQ 1 AND &B EQ 0).OUT                              28455002
         ORG   A&SYSNDX                                                 28560002
&B       SETB  1                                                        28665002
         DC    AL.12(&LOGITEM-&DSECT),XL.4'C'                           28770002
         DC    BL.1'&B',AL.7(&T),AL.4(&IBITS),FL.4'&ISHIFT'             28875002
.OUT     ANOP                                                           28980002
         MEND                                                           29085002
         EJECT                                                          29190002
*  HEX MACRO     HEX MACRO     HEX MACRO    HEXN MACRO     HEX MACRO  * 29295002
         SPACE 2                                                        29400002
         MACRO                                                          29505002
         HEX   &LOGITEM,&SKIP$OR,&BYTES                                 29610002
.*                            THIS MACRO FACILITATES GENERATION OF THE  29715002
.*                                 TABLE ENTRIES SPECIFYING HEX TYPE    29820002
.*                                 CONVERSIONS.                         29925002
.*                            &LOGITEM - NAME OF DATA ITEM TO BE        30030002
.*                                 CONVERTED                            30135002
.*                            &SKIP$OR - NUMBER OF SPACES TO SKIP ON    30240002
.*                                 MULTIPLE PRINT OR NBR OF SPACES TO   30345002
.*                                 BACK UP FROM COLUMN FOR START OF     30450002
.*                                 PRINTING. THE LETTER B PRECEEDS THE  30555002
.*                                 NUMBER (B8) IF THE LATTER OPTION IS  30660002
.*                                 DESIRED. OMISSION OF THIS OPERAND    30765002
.*                                 FORCES OPTION 2 WITH BACKUP SPACING  30870002
.*                                 EQUAL TO THE NUMBER OF BYTES SPECI-  30975002
.*                                 FIED BY THE NEXT OPERAND (TWICE THIS 31080002
.*                                 NUMBER IF SUFFIX IS EXPLICITLY OR    31185002
.*                                 IMPLICITLY B).                       31290002
.*                            &BYTES - NUMBER OF TOTAL INPUT BYTES TO   31395002
.*                                 PROCESS. THIS NUMBER IS SUFFIXED     31500002
.*                                 WITH AN L,R, OR B TO STIPULATE       31605002
.*                                 PRINTING OF THE LEFT HALF, RIGHT     31710002
.*                                 HALF, OR BOTH HALVES OF THE BYTE     31815002
.*                                 RESPECTIVELY. OMISSION OF THIS       31920002
.*                                 OPERAND DEFAULTS TO B WITH THE NUM-  32025002
.*                                 BER OF BYTES EQUAL TO THE ITEM LNGTH 32130002
.*                            A NEW ENTRY IS GENERATED ONLY WHEN NECES- 32235002
.*                                 SARY. THIS MACRO MUST BE THE FIRST   32340002
.*                                 MACRO INSTRUCTION ISSUED FOR THE     32445002
.*                                 SUBJECT LINE(S).                     32550002
         GBLC &ITEM(1000),&DSECT                                        32655002
         GBLA &ITEMNBR,&BITS(1000),&SHIFT(1000),&NRENTS                 32760002
         LCLB  &B                                                       32865002
         LCLA  &IBITS,&NDX,&ISHIFT,&K,&T,&CODE,&BYTESP                  32970002
         LCLC  &S,&LETTER                                               33075002
.LOOP    ANOP                                                           33180002
&NDX     SETA  &NDX+1                                                   33285002
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      33390002
         AIF   (&NDX LT &ITEMNBR).LOOP                                  33495002
         MNOTE *,'LOG ITEM NOT DEFINED'                                 33600002
         MEXIT                                                          33705002
.FOUND   ANOP                                                           33810002
&ISHIFT  SETA  &SHIFT(&NDX)                                             33915002
&IBITS   SETA  &BITS(&NDX)                                              34020002
&CODE    SETA  1                                                        34125002
&K       SETA  K'&BYTES                                                 34230002
         AIF   (&IBITS-(&IBITS/4)*4 EQ 0).OK                            34335002
         MNOTE *,'BIT LENGTH SPECIFICATION INCONSISTENT WITH CONTROL'   34440002
         MEXIT                                                          34545002
.OK      AIF   ('&BYTES' EQ '').USEDEFN                                 34650002
&LETTER  SETC  '&BYTES'(&K,1)                                           34755002
&S       SETC  '&BYTES'(1,&K-1)                                         34860002
&BYTESP  SETA  &S                                                       34965002
         AIF   ('&LETTER' EQ 'B').BOTH                                  35070002
         AIF   (&ISHIFT EQ 0 OR &ISHIFT EQ 4).OK2                       35175002
.ERR     MNOTE *,'DATA NOT ALLIGNED ON HEX OR BYTE BOUNDARY'            35280002
         MEXIT                                                          35385002
.USEDEFN ANOP                                                           35490002
&BYTESP  SETA  &IBITS/8                                                 35595002
.BOTH    AIF   (&ISHIFT NE 0).ERR                                       35700002
&CODE    SETA  3                                                        35805002
&T       SETA  &BYTESP*2-1                                              35910002
&S       SETC  '&T'                                                     36015002
.OK2     AIF   (&ISHIFT EQ 0).L                                         36120002
&CODE    SETA  2                                                        36225002
.L       ANOP                                                           36330002
&B       SETB  1                                                        36435002
         AIF   ('&SKIP$OR' EQ '').BACKUP                                36540002
&K       SETA  K'&SKIP$OR                                               36645002
&B       SETB  ('&SKIP$OR'(1,1) EQ 'B')                                 36750002
&S       SETC  '&SKIP$OR'(&B+1,&K-&B)                                   36855002
.BACKUP  ANOP                                                           36960002
&NRENTS  SETA  &NRENTS+1                                                37065002
         DC    AL.12(&LOGITEM-&DSECT),XL.4'A'                           37170002
         DC    BL.1'&B',FL.7'&S',FL.4'&BYTESP',FL.4'&CODE'              37275002
.OUT     ANOP                                                           37380002
         MEND                                                           37485002
         SPACE 2                                                        37590002
*  ROUTINE MACRO     ROUTINE MACRO     ROUTINE MACRO     ROUTINE MACRO* 37695002
         SPACE 2                                                        37800002
         MACRO                                                          37905002
&NAME    ROUTINE &LOGITEM,&RNAME                                        38010002
         GBLC  &DSECT,&CSECT                                            38115002
         GBLC  &ITEM(1000)                                              38220002
         GBLA  &SHIFT(1000),&ITEMNBR                                    38325002
         GBLA  &NRENTS                                                  38430002
         LCLA  &ISHIFT,&NDX                                             38535002
.LOOP    ANOP                                                           38640002
&NDX     SETA  &NDX+1                                                   38745002
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      38850002
         AIF   (&NDX LT &ITEMNBR).LOOP                                  38955002
         MNOTE *,'LOG ITEM NOT DEFINED'                                 39060002
         MEXIT                                                          39165002
.FOUND   ANOP                                                           39270002
&ISHIFT  SETA  &SHIFT(&NDX)                                             39375002
&NAME    DC    AL.12(&LOGITEM-&DSECT),XL.4'D'                           39480002
         DC    AL.4(&ISHIFT),AL.12(&RNAME-&CSECT)                       39585002
&NRENTS  SETA  &NRENTS+1                                                39690002
         MEND                                                           39795002
         EJECT                                                          39900002
*  LABEL MACRO     LABEL MACRO     LABEL MACRO     LABEL MACRO        * 40005002
         SPACE 2                                                        40110002
         MACRO                                                          40215002
&NAME    LABEL &LABEL1,&LABEL2,&LABEL3,&LABEL4,&LABEL5,&LABEL6,        C40320002
               &LABEL7,&LABEL8                                          40425002
.*                            THIS MACRO ALLOWS UP TO ACHT LABELS TO    40530002
.*                                 BE SPECIFIED FOR A GIVEN LINE. THE   40635002
.*                                 LABELS SHOULD BE ENCLOSED IN QUOTA-  40740002
.*                                 TION MARKS. THE COLUMN AND LINE END  40845002
.*                                 CONTROLS WILL BE INSERTED BY THE     40950002
.*                                 MACRO. OMITTED OPERANDS MEAN NO      41055002
.*                                 LABEL REQUIRED FOR RESPECTIVE        41160002
.*                                 COLUMN. THIS MACRO WILL ALSO ALERT   41265002
.*                                 THE PROGRAMMER TO EXACTLY WHERE THE  41370002
.*                                 TABLE MUST BE BROKEN IF NECESSARY    41475002
.*                                 TO AVOID EXCEEDING THE MAXIMUM LIMIT 41580002
         GBLC &LABELS(2000)                                             41685002
         GBLC  &LBL(100)                                                41790002
         GBLA  &LBLCTR(100)                                             41895002
         GBLA  &LABELNR                                                 42000002
         GBLA  &NRENTS,&LPTR                                            42105002
         LCLC  &MARGIN,&TACK                                            42210002
         LCLC  &TEXT                                                    42315002
         LCLA  &OP,&K,&START,&NRCHAR,&REMAIN                            42420002
&MARGIN  SETC  '*'                                                      42525002
         AIF   ('&NAME' EQ '').LOOPOUT                                  42630002
&LPTR    SETA  &LPTR+1                                                  42735002
&LBL(&LPTR) SETC '&NAME'                                                42840002
&LBLCTR(&LPTR) SETA &LABELNR+1                                          42945002
.LOOPOUT ANOP                                                           43050002
&OP      SETA  &OP+1                                                    43155002
&K       SETA  K'&SYSLIST(&OP)                                          43260002
         AIF (&K GE 2).NORM                                             43365002
&K       SETA  2                                                        43470002
.NORM    ANOP                                                           43575002
&START   SETA  2                                                        43680002
         AIF (&OP LT N'&SYSLIST).NOTLAST                                43785002
&MARGIN  SETC  '$'                                                      43890002
.NOTLAST ANOP                                                           43995002
&NRCHAR  SETA  8                                                        44100002
&TACK    SETC  ''                                                       44205002
.LOOPIN  ANOP                                                           44310002
&REMAIN  SETA  &K-&START                                                44415002
         AIF (&REMAIN GE 8).MORE                                        44520002
&TACK    SETC  '&MARGIN'                                                44625002
&NRCHAR  SETA  &REMAIN                                                  44730002
.MORE    ANOP                                                           44835002
&TEXT    SETC  ''                                                       44940002
         AIF (&REMAIN EQ 0).ENDTEXT                                     45045002
&TEXT    SETC  '&SYSLIST(&OP)'(&START,&NRCHAR)                          45150002
.ENDTEXT ANOP                                                           45255002
&LABELNR SETA  &LABELNR+1                                               45360002
&LABELS(&LABELNR) SETC '&TEXT'.'&TACK'                                  45465002
&START   SETA  &START+8                                                 45570002
         AIF ('&TACK' EQ '').LOOPIN                                     45675002
         AIF ('&TACK' EQ '*').LOOPOUT                                   45780002
         MEND                                                           45885002
         SPACE 2                                                        45990002
         MACRO                                                          46095002
         LSTART                                                         46200002
.*                            THIS MACRO IS ISSUED WHEN THE LABEL AREA  46305002
.*                                 OF THE TABLE IS TO BEGIN.            46410002
         GBLC &LABELS(2000)                                             46515002
         GBLA  &LABELNR                                                 46620002
         GBLC  &LBL(100)                                                46725002
         GBLA  &LBLCTR(100)                                             46830002
         LCLA  &NDX,&CTR                                                46935002
         LINEND                                                         47040002
&CTR     SETA  1                                                        47145002
.LOOP    ANOP                                                           47250002
&NDX     SETA  &NDX+1                                                   47355002
         AIF   (&LBLCTR(&CTR) NE &NDX).NOLBL                            47460002
&LBL(&CTR) DC  C'&LABELS(&NDX)'                                         47565002
&CTR     SETA  &CTR+1                                                   47670002
         AGO   .LOOPCTL                                                 47775002
.NOLBL   ANOP                                                           47880002
         DC    C'&LABELS(&NDX)'                                         47985002
.LOOPCTL AIF   (&NDX LT &LABELNR).LOOP                                  48090002
         MEND                                                           48195002
         SPACE 2                                                        48300002
         MACRO                                                          48405002
         LINEND                                                         48510002
.*                            THIS MACRO IS USED ONLY BY THE LINE       48615002
.*                                 MACRO TO SET THE NUMBER OF ENTRIES   48720002
.*                                 ASSOCIATED WITH EACH LINE.           48825002
         GBLA  &NRENTS                                                  48930002
         GBLC &NRENTSX                                                  49035002
         ORG   &NRENTSX                                                 49140002
         DC    FL1'&NRENTS'                                             49245002
         ORG                                                            49350002
&NRENTS  SETA  0                                                        49455002
B&SYSNDX EQU   *                                                        49560002
&NRENTSX SETC  'B&SYSNDX'                                               49665002
         MEND                                                           49770002
         MACRO                                                          49875002
         SPECIAL  &ROUTINE,&PARAM,&SPACE=                               49980002
.*                            THIS MACRO GENERATES A SPECIAL ROUTINE    50085002
.*                                 ENTRY TO BE PROCESSED BY THE SUM. M. 50190002
.*                            &ROUTINE - SYMBOL ON SPECIAL ROUTINE EWT. 50295002
.*                            &PARAM - AN 8 BIT BINARY REPRESENTATION   50400002
.*                                 TO OCCUPY THE 'MASK' FIELD BUT TO BE 50505002
.*                                 INTERPRETED AS AN ARGUMENT OF THE    50610002
.*                                 SPECIAL ROUTINE.                     50715002
.*                            &SPACE - THE NUMBER OF 2BYTE COUNTERS TO  50820002
.*                                 ALLOCATE FOR REQUIRED PROCESSING.    50925002
         GBLC  &CSECT                                                   51030002
         GBLA  &COUNTR                                                  51135002
         LCLA  &ADD                                                     51240002
         DC    AL1(128)                                                 51345002
         DC    BL.8'&PARAM'                                             51450002
         DC    AL2(&ROUTINE-&CSECT)                                     51555002
         DC    AL2(&COUNTR)                                             51660002
&ADD     SETA  1                                                        51765002
         AIF   ('&SPACE' EQ '').NORM                                    51870002
&ADD     SETA  &SPACE                                                   51975002
.NORM    ANOP                                                           52080002
&COUNTR  SETA  &COUNTR+&ADD                                             52185002
         MEND                                                           52290002
         MACRO                                                          52395002
         SUM   &LOGITEM,&MASK                                           52500002
.*                            THIS MACRO GENERATES A NORMAL EDIT ENTRY  52605002
.*                                 FOR PROCESSING BY THE SUMMARY MODULE 52710002
.*                            &LOGITEM - NAME OF DATA ITEM TO BE SUMMED 52815002
.*                            &MASK - BYTE MASK FOR BITS TO BE TESTED.  52920002
.*                                 THIS OPERAND SHOULD BE OMITTED FOR   53025002
.*                                 SINGLE BIT ITEMS IN WHICH CASE THE   53130002
.*                                 MASK WILL BE SET ACCORDING TO THE    53235002
.*                                 OFF BYTE BIT DISPLACEMENT OF THE     53340002
.*                                ITEM AS DEFINED BY THE MACRO 'DSGEN'  53445002
         GBLA  &COUNTR,&ITEMNBR,&BITS(1000),&SHIFT(1000)                53550002
         GBLC  &ITEM(1000),&DSECT                                       53655002
         LCLA  &IBITS,&NDX,&ISHIFT,&M,&BITNBR                           53760002
.LOOP    ANOP                                                           53865002
&NDX     SETA  &NDX+1                                                   53970002
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      54075002
         AIF   (&NDX LT &ITEMNBR).LOOP                                  54180002
         MNOTE *,'LOGITEM NOT FOUND'                                    54285002
         MEXIT                                                          54390002
.FOUND   ANOP                                                           54495002
         DC    AL1(0)                                                   54600002
&ISHIFT  SETA  &SHIFT(&NDX)                                             54705002
&IBITS   SETA  &BITS(&NDX)                                              54810002
         AIF   ('&MASK' EQ '').FORM                                     54915002
         DC    B'&MASK'                                                 55020002
         AGO   .ITEM                                                    55125002
.FORM    ANOP                                                           55230002
&BITNBR  SETA  &ISHIFT-7                                                55335002
&BITNBR  SETA  0-&BITNBR                                                55440002
&M       SETA  1                                                        55545002
.LOOP2   ANOP                                                           55650002
         AIF   (&BITNBR EQ 0).GOTIT                                     55755002
&M       SETA  &M*2                                                     55860002
&BITNBR  SETA  &BITNBR-1                                                55965002
         AGO   .LOOP2                                                   56070002
.GOTIT   ANOP                                                           56175002
         DC    AL1(&M)                                                  56280002
.ITEM    DC    AL2(&LOGITEM-&DSECT)                                     56385002
         DC    AL2(&COUNTR)                                             56490002
&COUNTR  SETA  &COUNTR+1                                                56595002
         MEND                                                           56700002
         GBLC  &DSECT,&CSECT                                            56805002
IFCSCUA0 CSECT                                                          56910002
&CSECT   SETC  'IFCSCUA0'                                               57015002
&DSECT   SETC  'M3420'                                                  57120002
M3420    DSECT                                                          57225002
         DSGEN (CLASSRC,8),(SYSREL,8),(SWITCHES,16),                   C57330002
               (SPARES,32)                                              57435002
         DSGEN (DATE,32),(TIME,32)                                      57540002
         DSGEN (DUM2,8),(CPUSER,24),(CPUID,16),(DUM3,16)                57645002
         DSGEN (,264)                                                   57750002
         DSGEN (PRIMCUA,8,0,2),(IORETRY,16),(SNSCNT,16)                 57855002
         DSGEN (VOLID,48),(BLKLENG,16),(,32),(TEMPRDS,8),(TEMPWRTS,8), C57960002
               (SIOCNT,16),(PERMRDS,8),(PERMWRTS,8),(NOISEBLK,8),      C58065002
               (,8),(ERASEGPS,16),(CLNRACTS,16)                         58170002
         DSGEN (SPAR,8),(NOISE,8),(RWVRC,8),(MTELRCR,8)                 58275002
         DSGEN (EDCCRC,8),(ENVCKVRC,8),(OVERRUN,4),(SKEWCHK,4),        C58380002
               (CCOMPARE,4),(WRTTRVRC,4)                                58485002
         DSGEN (PEIDCHK,1),(MASKEXP,6),(PARITY,1),(TRKINERR,8),        C58590002
               (WRTTMCHK,4),(STRDCHK,4),(PARTREC,4),(EXCPAMB,4)         58695002
         DSGEN  (ORDROP,4),(FEEDTHRU,4),(EXP,4),(EARLBGRD,4),          C58800002
               (EARLNDRD,4),(SLBGRD,4),(SLWNDRD,4),(VELRETRY,4),       C58905002
               (EXP2,4),(VELCHNG,4),(EXP3A,4),(EXP3,4),(BACKWARD,8),   ,59010002
               (BUSOCHK,4),(ALUHRDER,4)                                 59115002
         DSGEN (SNB,1,0,23,0,7)                                         59220002
         DSGEN (TUSERIAL,16,EQU,SNB150)                                 59325002
IFCSCUA0 CSECT                                                          59430002
         USING M3420,R2                                                 59535002
         USING *,R9                                                     59640002
         DC    A(ENTRIES)                                               59745002
         DC    A(EDIT)                                                  59850002
REG8     DC    F'0'                                                     59955002
SCSIZE   DC    H'24'                                                    60060002
R2       EQU   2                                                        60165002
R3       EQU   3                                                        60270002
R4       EQU   4                                                        60375002
R5       EQU   5                                                        60480002
R6       EQU   6                                                        60585002
R7       EQU   7                                                        60690002
R9       EQU   9                                                        60795002
R14      EQU   14                                                       60900002
R15      EQU   15                                                       61005002
L0       EQU   0                                                        61110002
L1       EQU   1                                                        61215002
L2       EQU   2                                                        61320002
L3       EQU   3                                                        61425002
L4       EQU   4                                                        61530002
L5       EQU   5                                                        61635002
L6       EQU   6                                                        61740002
L7       EQU   7                                                        61845002
L8       EQU   8                                                        61950002
L28      EQU   28                                                       62055002
DISMOUNT EQU   X'84'                                                    62160002
F0       EQU   X'F0'                                                    62265002
FF       EQU   X'FF'                                                    62370002
*                                                                     * 62475002
* THIS ROUTINE WILL PUT A HIGH AND LOW DATE INTO THE COUNTER AREA.    * 62580002
* THE FIRST TIME IT PUTS THE SAME DATE IN BOTH AREAS.  WITH EACH NEW  * 62685002
* RECORD A COMPARE IS DONE FOR A LOWER AND HIGHER DATE.               * 62790002
*                                                                     * 62895002
SETDATES MVC   L0(L4,R3),DATE     SAVE THE DATE OF RECORD               63000002
RETURN   BR    R14                RETURN                                63105002
DEVICE   MVC   L0(2,R3),SNSCNT    MOVE IN SENSE COUNT           XA01919 63210002
         TM    SWITCHES+L1,DISMOUNT IS THIS A DISMOUNT          XA01919 63260002
         BZ    CKSNSCNT           IT IS NOT A DISMOUNT           XM9111 63310002
         XC    SNB00(L1),SNB00    ZERO OUT INVALID SENSE INFO    XM9111 63410002
         BR    R14                RETURN CONTROL                 XM9111 63510002
CKSNSCNT CLC   SNSCNT(L2),NINER   DOES UNIT HAVE 9  SENSE BYTES SA55024 63610002
         BCR   13,R14             BRANCH IF ONLY 9 SENSE BYTES  SA55024 63710002
         MVC   L2(L2,R3),TUSERIAL MOVE SERIAL NUMBER TO COUNTER XA01919 64155002
         BR    R14                                                      64260002
NINER    DC    H'9'                                                     64310002
* THE NEXT ROUTINES WILL TAKE THE COUNTERS FROM THE RECORD AND        * 64365002
* ADD THEM TO THE COUNTER AREAS.  HALF BYTE COUNTERS ARE ISOLATED AND * 64470002
* THEM ADDED. DEVICE DEPENDENT COUNTERS ARE ADDED ONLY FOR DISMOUNT   * 64575002
* RECORDS.                                                            * 64680002
*                                                                     * 64785002
DENS16   EQU   X'04'                                                    64890002
NOISERTN SR    R5,R5              CLEAR REGISTER                        64995002
         TM    SNB30,DENS16            IS THIS A 1600 BPI DRIVE         65100002
         BZ    GOON                    IF NOT ADD COUNTER               65205002
         MVI   L0(R3),X'7C'            MOVE IN NOT VALID INDICATOR      65310002
         BR    R14                                                      65415002
GOON     IC    R5,NOISE           GET QUANTITY TO BE ADDED              65520002
ADD      AH    R5,L0(R3)          ADD HALFWORD COUNTER TO IT            65625002
         STH   R5,L0(R3)          STORE SUM BACK IN COUNTER AREA        65730002
         L     R5,SAVE5           RELOAD REGISTER FIVE                  65835002
         BR    R14                RETURN                                65940002
LEFTHALF SRL   R5,L4              ISOLATE THE LOW ORDER BITS OF HI BYTE 66045002
         B     ADD                GO TO ADD THE COUNTER                 66150002
RGHTHALF SLL   R5,L28             SHIFT OUT LOW BITS OF HIGH BYTE       66255002
         SRL   R5,L28             SHIFT BYTE BACK TO HIGH POSITION      66360002
         B     ADD                GO TO ADD COUNTER                     66465002
OVERRTN  SR    R5,R5              CLEAR REGISTER                        66570002
         IC    R5,OVERRUN         GET QUANTITY TO BE ADDED              66675002
         B     LEFTHALF           GO TO ISOLATE THE LEFT HALF BYTE      66780002
WRTTMRTN SR    R5,R5              CLEAR REGISTER                        66885002
         IC    R5,WRTTMCHK        GET QUANTITY TO BE ADDED              66990002
         B     LEFTHALF           GO TO ISOLATE THE LEFT HALF BYTE      67095002
STRDRTN  SR    R5,R5              CLEAR REGISTER                        67200002
         IC    R5,WRTTMCHK        GET QUANTITY TO BE ADDED              67305002
         B     RGHTHALF           GO TO ISOLATE THE RIGHT HALF BYTE     67410002
PARTRTN  SR    R5,R5              CLEAR REGISTER                        67515002
         IC    R5,PARTREC         GET QUANTITY TO BE ADDED              67620002
         B     LEFTHALF           GO TO ISOLATE THE LEFT HALF BYTE      67725002
EXCRTN   SR    R5,R5              CLEAR REGISTER                        67830002
         IC    R5,PARTREC         GET QUANTITY TO BE ADDED              67935002
         B     RGHTHALF           GO TO ISOLATE RIGHT HALF BYTE         68040002
IBGRTN   SR    R5,R5              CLEAR REGISTER                        68145002
         IC    R5,ORDROP          GET QUANTITY TO BE ADDED              68250002
         B     LEFTHALF           GO TO ISOLATE LEFT HALF BYTE          68355002
FEEDRTN  SR    R5,R5              CLEAR REGISTER                        68460002
         IC    R5,ORDROP          GET QUANTITY TO BE ADDED              68565002
         B     RGHTHALF           GO TO ISOLATE RIGHT HALF BYTE         68670002
EARLERTN SR    R5,R5              CLEAR REGISTER                        68775002
         IC    R5,EARLNDRD        GET QUANTITY TO BE ADDED              68880002
         B     LEFTHALF           GO TO ISOLATE LEFT HALF BYTE          68985002
SLWBRTN  SR    R5,R5              CLEAR REGISTER                        69090002
         IC    R5,EARLNDRD        GET QUANTITY TO BE ADDED              69195002
         B     RGHTHALF           GO TO ISOLATE RIGHT HALF BYTE         69300002
VELRRTN  SR    R5,R5              CLEAR REGISTER                        69405002
         IC    R5,SLWNDRD         GET QUANTITY TO BE ADDED              69510002
         B     RGHTHALF           GO TO ISOLATE RIGHT HALF BYTE         69615002
TRDSRTN  TM    SWITCHES+L1,DISMOUNT IS THIS A DISMOUNT RECORD           69720002
         BCR   8,R14              NO-DO NOT ADD TO COUNTER              69825002
         SR    R5,R5              CLEAR REGISTER                        69930002
         IC    R5,TEMPRDS         GET NUMBER OF TEMP READ ERRORS        70035002
         B     ADD                GO TO ADD TO COUNTER                  70140002
TWRTSRTN TM    SWITCHES+L1,DISMOUNT IS THIS A DISMOUNT RECORD           70245002
         BCR   8,R14              NO-DO NOT ADD TO COUNTER              70350002
         SR    R5,R5              CLEAR REGISTER                        70455002
         IC    R5,TEMPWRTS        GET NUMBER OF TEMPORARY WRITE ERRORS  70560002
         B     ADD                GO TO ADD THEM TO COUNTER             70665002
PRDSRTN  TM    SWITCHES+L1,DISMOUNT IS THIS A DISMOUNT RECORD           70770002
         BCR   8,R14              NO-DO NOT ADD TO COUNTER              70875002
         SR    R5,R5              CLEAR REGISTER                        70980002
         IC    R5,PERMRDS         GET NUMBER OF PERM READ ERRORS        71085002
         B     ADD                GO TO ADD TO COUNTER                  71190002
PWRTSRTN TM    SWITCHES+L1,DISMOUNT IS THIS A DISMOUNT RECORD           71295002
         BCR   8,R14              NO-DO NOT ADD TO COUNTER              71400002
         SR    R5,R5              CLEAR REGISTER                        71505002
         IC    R5,PERMWRTS        GET NUMBER OF PERMANENT WRITE ERRORS  71610002
         B     ADD                GO TO ADD THEM TO COUNTER             71715002
SIORTN   STM   R5,R6,STOREREG+4   SAVE REGISTERS                        71820002
         TM    SWITCHES+L1,DISMOUNT IS THIS A DISMOUNT RECORD           71925002
         BCR   8,R14              NO-DO NO ADD TO COUNTER               72030002
         MVC   STOREREG+L2(L2),SIOCNT GET THE SIO COUNT FROM RECORD     72135002
         L     R5,STOREREG        PUT IT INTO A REGISTER                72225002
         MVC   STOREREG(L4),L0(R3) GET COUNTER ON BOUNDARY              72315002
         L     R6,STOREREG        PUT IT INTO A REGISTER                72405002
         AR    R5,R6              TOTAL THE COUNTS                      72495002
         ST    R5,STOREREG        PUT COUNTER BACK ON BOUNDARY          72585002
         MVC   L0(L4,R3),STOREREG PUT IT BACK IN COUNTER AREA           72675002
         LM    R5,R6,STOREREG+4   RELOAD REGISTERS                      72765002
         BR    R14                RETURN                                72870002
STOREREG DC    3F'0'                                                    72975002
SAVE5    DC    F'0'                                                     73080002
ENTRIES  DS    0F                                                       73395002
         SPECIAL SETDATES,0,SPACE=2                                     73500002
         SPECIAL DEVICE,0,SPACE=2                               XA01919 73605002
         SUM   SNB03                                                    73710002
         SPECIAL SIORTN,0,SPACE=2                                       73815002
         SPECIAL TRDSRTN,0,SPACE=1                                      73920002
         SPECIAL TWRTSRTN,0,SPACE=1                                     74025002
         SPECIAL PRDSRTN,0,SPACE=1                                      74130002
         SPECIAL PWRTSRTN,0,SPACE=1                                     74235002
         SPECIAL NOISERTN,0,SPACE=1                                     74340002
         SPECIAL OVERRTN,0,SPACE=1                                      74445002
         SPECIAL EARLERTN,0,SPACE=1                                     74550002
         SPECIAL WRTTMRTN,0,SPACE=1                                     74655002
         SPECIAL IBGRTN,0,SPACE=1                                       74760002
         SPECIAL FEEDRTN,0,SPACE=1                                      74865002
         SPECIAL VELRRTN,0,SPACE=1                                      74970002
         SPECIAL PARTRTN,0,SPACE=1                                      75075002
         SPECIAL SLWBRTN,0,SPACE=1                                      75180002
         SPECIAL EXCRTN,0,SPACE=1                                       75285002
         SPECIAL STRDRTN,0,SPACE=1                                      75390002
         DC    X'FF'                                                    75495002
EDIT     DS    0F                                                       75600002
&DSECT   SETC  'CNTRAREA'                                               75705002
&CSECT   SETC  'EDIT'                                                   75810002
         USING *,R9                                                     75915002
         USING CNTRAREA,R2                                              76020002
         DC    A(SUMEDIT)                                               76125002
         DC    CL8'IFCSCUA0'                                            76230002
NINE     DC    F'0'                                                     76335002
LABELPTR DC    F'0'                                                     76440002
CNTRAREA DSECT                                                          76545002
         DS    2H                                                       76650002
         DSGEN (CUA,24),(,120)                                          76755002
         DSGEN (DATE1,32)                                               76860002
         DSGEN (SENSE,16)                                               76910002
         DSGEN (DEV,16),(EQUIP,16),(SIOCTR,32),(TRDSCTR,16)             76965002
         DSGEN (TWRTSCTR,16),(PRDSCTR,16),(PWRTSCTR,16),(NOISECTR,16)   77070002
         DSGEN (OVERCTR,16),(EARLECTR,16),(WRTTMCTR,16),(IBGCTR,16),   C77175002
               (FEEDCTR,16)                                             77280002
         DSGEN (VELRCTR,16),(PARTCTR,16),(SLWBCTR,16),(EXCCTR,16)       77385002
         DSGEN (STRDCTR,16)                                             77490002
IFCSCUA0 CSECT                                                          77595002
*                                                                     * 77700002
* THE CONVERT ROUTINES WILL TAKE A COUNTER AND CONVERT IT TO          * 77805002
* PRINTABLE EBCDIC CHARACTERS. THEY ALL CONVERT INTO A DIFFERENT      * 77910002
* NUMBER OF DIGITS.                                                   * 78015002
* CONVERT-3 DIGITS  CONVERT1-4 DIGITS  CONVERT2-5 DIGITS              * 78120002
* CONVERT3-6 DIGITS                                                   * 78225002
*                                                                     * 78330002
*                                                                     * 78435002
CONVERT1 ST    R5,SAVE            SAVE REGISTER                         78540002
         MVC   SAVENBR+L2(L2),L0(R4) GET NUMBER TO CONVERT              78645002
         L     R5,SAVENBR                                               78750002
         CVD   R5,DECAREA          CONVERT THE COUNTER                  78855002
         UNPK  L0(L4,R3),DECAREA(L8) UNPACK AND PLACE IN PRINT BUFFER   78960002
         OI    L3(R3),F0           MAKE LAST DIGIT PRINTABLE            79065002
         L     R5,SAVE            RESTORE REGISTER                      79170002
DONOTHNG BR    R14                 RETURN                               79275002
CONVERT2 ST    R5,SAVE            SAVE REGISTER                         79380002
         MVC   SAVENBR+L2(L2),L0(R4) GET NUMBER TO CONVERT              79485002
         L     R5,SAVENBR                                               79590002
         CVD   R5,DECAREA          CONVERT THE COUNTER                  79695002
         UNPK  L0(L5,R3),DECAREA(L8) UNPACK INTO PRINT BUFFER           79800002
         OI    L4(R3),F0           MAKE LAST DIGIT PRINTABLE            79905002
         L     R5,SAVE            RESTORE REGISTER                      80010002
         BR    R14                 RETURN                               80115002
CONVERT3 ST    R5,SAVE            SAVE THE REGISTER                     80220002
         LA    R3,5(R3)           INCREMENT PRINT BUFFER PTR    XA01919 80270002
         MVC   DECAREA(4),L0(R4)   MOVE NUMBER TO INTEGRAL BOUNDARY     80325002
         L     R5,DECAREA          PUT NUMBER IN A REGISTER             80430002
         CVD   R5,DECAREA         CONVERT COUNTER TO DECIMAL            80535002
         UNPK  L0(L6,R3),DECAREA(L8) UNPACK THE COUNTER                 80640002
         OI    L5(R3),F0          MAKE LAST DIGIT PRINTABLE             80745002
         L     R5,SAVE            RESTORE THE REFISTER                  80850002
         LA    R3,6(R3)           INCREMENT PRINT BUFFER PTR    XA01919 80900002
         BR    R14                  RETURN                              80955002
*                                                                     * 81060002
* THIS ROUTINE WILL TAKE THE DATES FROM THE HIGH AND LOW DATE ARES    * 81165002
* AND PUT THEM INTO THE PRINT BUFFER IN UNPACKED FORMAT.              * 81270002
*                                                                     * 81375002
GETDATE  UNPK  DECAREA(L5),L1(L3,R4) UNPACK THE DATE                    81480002
         OI    DECAREA+L4,F0       MAKE LAST DIGIT PRINTABLE            81585002
         LA    R3,7(R3)           INCREMENT PRINT BUFFER PTR    XA01919 81635002
         MVC   L0(L3,R3),DECAREA+L2 MOVE DAY TO PRINT LINE              81690002
         MVC   L4(L2,R3),DECAREA   MOVE YEAR TO PRINT LINE              81795002
         BR    R14                 RETURN                               81900002
*                                                                     * 82005002
CHKFIR   CLC   L0(L2,R4),SAVENBR  IS THERE A TU SERIAL           XM9111 82110002
         LA    R3,6(R3)           INCREMENT PRINT BUFFER PTR    XA01919 82215002
         BNE   CONVERT2                                                 82320002
         MVC   L1(L3,R3),NA       NO SERIAL NBR FOR 3410                82425002
         BR    R14                RETURN CONTROL                        82530002
ADD3     LA    R3,L3(R3)               INCREMENT PRINT POSITION         82950002
         BR    R14                                                      83055002
ADD4     LA    R3,L4(R3)               INCREMENT PRINT POSITION         83160002
         BR    R14                                                      83265002
ADD5     LA    R3,L5(R3)               INCREMENT PRINT POSITION         83370002
         BR    R14                                                      83475002
ADD7     LA    R3,L7(R3)               INCREMENT PRINT POSITION         83580002
         BR    R14                                                      83685002
FIRSTIME ST    R7,SAVE                 SAVE REGISTER                    83790002
         TM    FIRST,FF                IS THIS FIRST TIME THRU CODE     83895002
         MVI   FIRST,FF                MOVE FF TO FIRST TIME SWITCH     84000002
         BC    1,GETCNT           ONLY PRINT ENTRIES                    84105002
         L     R7,SAVE                 RESTORE SAVED REGISTER           84210002
         BR    R14                                                      84315002
WHATLAB  ST    R7,SAVE                 SAVE REGISTER                    84420002
         CLI   L1(R4),X'09'       DETERMINE WHAT LABELS         XA01919 84525002
         BH    NOPRINT            IF 24 USE FIRST SET OF LABELS XA01919 84625002
         LA    R7,LAB3410              GET ADDRESS TO CHANGE            84735002
         ST    R7,LABELPTR                                              84840002
         LA    R7,ENT3410-4                                             84945002
         ST    R7,NINE                                                  85050002
NOPRINT  SR    R15,R15                 CLEAR REGISTER FOR NO PRINT      85155002
         L     R7,SAVE                                                  85260002
         BR    R14                                                      85365002
GETCNT   ST    R7,SAVE                 SAVE REGISTER                    85470002
         LA    R7,CNTLAB               CHANGE ADDRESSES TO GET COUNTERS 85575002
         ST    R7,LABELPTR             STORE LABEL ADDRESS              85680002
         LA    R7,CNTENT-4             GET ENTRY ADDRESS                85785002
         ST    R7,NINE                 STORE ADDRESS FOR ENTRY          85890002
         B     NOPRINT                                                  85995002
*                                                                     * 86100002
CHKNRZI  CLI   L0(R4),X'7C'            IS THIS A PE DRIVE               86205002
         BNE   CONVERT1                NO IT IS NRZI                    86310002
PUTNA    MVC   L1(L3,R3),NA            MOVE N/A TO PRINT BUFFER         86415002
         BR    R14                                                      86520002
NA       DC    C'N/A'                                                   86625002
FIRST    DC    X'00'                                                    86730002
*                                                                     * 86835002
*                                                                     * 86940002
*                                                                     * 87045002
*                                                                     * 87150002
*                                                                     * 87255002
*                                                                     * 87360002
*                                                                     * 87465002
DECAREA  DC    D'0'                                                     87570002
SAVENBR  DC    F'0'                                                     87675002
SAVE     DC    F'0'                                                     87780002
SUMEDIT  DS    0F                                                       87885002
         DC    X'00010001'                                              87990002
         DC    X'00010001'                                              88095002
         DC    A(LABELS)                                                88200002
         DC    H'0'                                                     88305002
         LINE  ,,SKIP=1                                                 88410002
         ROUTINE CUA,FIRSTIME                                           88515002
         LABEL ''                                                       88620002
         DC    X'01000B8B00'                                            88725002
NOSKIP   LABEL ''                                                       88830002
SAMEPAGE LINE  ,(34,),SKIP=1                                            88935002
         ROUTINE CUA,DONOTHNG                                           89040002
         LABEL 'SUMMARY--MAGNETIC TAPE ERROR STATISTICS BY TAPE UNIT'   89145002
         LINE                                                           89250002
         ROUTINE SENSE,WHATLAB                                          89355002
         LABEL ''                                                       89460002
         LINE  ,(10,51)                                                 89565002
         ROUTINE CUA,DONOTHNG                                           89670002
         LABEL 'DATE    TU    SIO  --TEMP--  --PERM--  NRZI  EQUIP',   C89775002
               'OVER EARLY  WR TM IBG  FEED VEL   PART SLOW   EXC',    C89880002
               '    START'                                              89985002
         LINE  ,(2,53),SKIP=1                                           90090002
         ROUTINE CUA,DONOTHNG                                           90195002
         LABEL 'CUA    DAY YR SERIAL COUNT RDS  WRTS RDS  WRTS NOISE', C90300002
               'CHK   RUN  END    CHECK DROP THRU RETRY REC  BOR    P',C90405002
               'AMB     CHECK'                                          90510002
         LINE                                                           90615002
         ROUTINE CUA,GETCNT                                             90720002
LAB3410  LABEL ''                                                       90825002
ENT3410  LINE  ,(10,51),SKIP=1                                          90930002
         ROUTINE CUA,DONOTHNG                                           91035002
         LABEL 'DATE    TU    SIO  --TEMP--  --PERM--  NRZI  EQUIP',   C91140002
               'OVER TP VEL WR TM RES- FEED VEL   TACH ST VEL FLSE',   C91245002
               'END ERG'                                                91350002
         LINE  ,(2,53)                                                  91455002
         ROUTINE CUA,DONOTHNG                                           91560002
CNTLAB   LABEL 'CUA    DAY YR SERIAL COUNT RDS  WRTS RDS  WRTS NOISE', C91665002
               'CHECK RUN  CHECK  CHECK ERVE THRU RETRY CHK  CHECK  CHEC91770002
               CK    CHK'                                               91875002
CNTENT   LINE  (1,1),,SKIP=2                                    XA01919 91980002
         HEX   CUA,0,3B                                                 92085002
         ROUTINE DATE1,GETDATE                                          92190002
         ROUTINE DEV,CHKFIR                                             92295002
         ROUTINE SIOCTR,CONVERT3                                XA01919 92400002
         ROUTINE TRDSCTR,CONVERT1                                       92715002
         ROUTINE CUA,ADD3                                       XA01919 92765002
         ROUTINE TWRTSCTR,CONVERT1                                      92820002
         ROUTINE CUA,ADD3                                       XA01919 92870002
         ROUTINE PRDSCTR,CONVERT1                                       92925002
         ROUTINE CUA,ADD3                                       XA01919 92975002
         ROUTINE PWRTSCTR,CONVERT1                                      93030002
         ROUTINE CUA,ADD3                                       XA01919 93080002
         ROUTINE NOISECTR,CHKNRZI                                       93135002
         ROUTINE CUA,ADD4                                       XA01919 93185002
         ROUTINE EQUIP,CONVERT1                                         93450002
         ROUTINE CUA,ADD4                                               93555002
         ROUTINE OVERCTR,CONVERT1                                       93660002
         ROUTINE CUA,ADD3                                               93765002
         ROUTINE EARLECTR,CONVERT1                                      93870002
         ROUTINE CUA,ADD5                                               93975002
         ROUTINE WRTTMCTR,CONVERT1                                      94080002
         ROUTINE CUA,ADD4                                               94185002
         ROUTINE IBGCTR,CONVERT1                                        94290002
         ROUTINE CUA,ADD3                                               94395002
         ROUTINE FEEDCTR,CONVERT1                                       94500002
         ROUTINE CUA,ADD3                                               94605002
         ROUTINE VELRCTR,CONVERT1                                       94710002
         ROUTINE CUA,ADD4                                               94815002
         ROUTINE PARTCTR,CONVERT1                                       94920002
         ROUTINE CUA,ADD3                                               95025002
         ROUTINE SLWBCTR,CONVERT1                                       95130002
         ROUTINE CUA,ADD5                                               95235002
         ROUTINE EXCCTR,CONVERT1                                        95340002
         ROUTINE CUA,ADD7                                               95445002
         ROUTINE STRDCTR,CONVERT1                                       95550002
         LABEL ''                                                       95655002
         DC    X'FF'                                                    95760002
         DC    X'000000000000'                                          95865002
         DS    0F                                                       95970002
         DC    C'$'                                                     96075002
LABELS   EQU   *                                                        96180002
         LSTART                                                         96285002
         END                                                            96390002
