         TITLE 'IFCSCUA1  MES DATA SUMMARY BY CUA WITH THRESHOLD'       00090042
*                                  THIS MODULE IS INCLUDE AS   @Z40NIVS 00180042
*                                  PART OF THE DASDI/TAPE EREP @Z40NIVS 00270042
*                                  ENHANCEMENTS.               @Z40NIVS 00360042
*                                                              @Z40NIVS 00450042
         MACRO                                                          00540042
&NAME    DSGEN                                                          00630042
.*                            THIS MACRO GENERATES ONE DSECT WORD       00720042
.*                                 FORMATTED FOR THE SUBJECT LOG RECORD 00810042
.*                                 EACH OPERAND HAS TWO SUB LISTS. THE  00900042
.*                                 FIRST IS THE NAME OF THE LOG ITEM    00990042
.*                                 WHILE THE SECOND IS THE # OF BITS TO 01080042
.*                                 ALLOCATE FOR THIS ITEM. ITEMS MUST   01170042
.*                                 BE DEFINED CONTIGUOUSLY WITHOUT GAPS 01260042
.*                                 UNUSED BIT GROUPS MUST BE GIVEN      01350042
.*                                 DUMMY NAMES. THE NAMES PROVIDED FOR  01440042
.*                                 THE LOG ITEMS MAY THEN BE USED IN    01530042
.*                                 THE CONVERSION MACRO INSTRUCTIONS.   01620042
         GBLC &ITEM(1000)                                               01710042
         GBLA &ITEMNBR,&BITS(1000),&SHIFT(1000)                         01800042
         LCLB  &ONLY1,&CTIND                                            01890042
         LCLA  &START1,&START2,&END1,&END2                              01980042
         LCLC  &SYMBOL,&EQUSYM                                          02070042
         LCLA  &OP,&COUNT,&BYTE,&EQUCNT                                 02160042
         ACTR  100000                                                   02250042
.START   AIF   (N'&SYSLIST(&OP+1) LT 3).LOOP                            02340042
         AIF   ('&SYSLIST(&OP+1,3)' EQ 'EQU').LOOP     TEST FOR EQU     02430042
  AIF   ('&SYSLIST(&OP+1,3)' EQ '' AND '&SYSLIST(&OP+1,4)' EQ '').ERR1  02520042
  AIF   ('&SYSLIST(&OP+1,3)' EQ '' OR '&SYSLIST(&OP+1,4)' EQ '').ERR1   02610042
         AIF   ('&SYSLIST(&OP+1,3)' GT '&SYSLIST(&OP+1,4)').ERR3        02700042
&START1  SETA  &SYSLIST(&OP+1,3)        GET START COUNT OF 1            02790042
&START2  SETA  &SYSLIST(&OP+1,4)        GET FIRST END COUNT             02880042
         AGO   .SET2A                   BRANCH AROUND                   02970042
.ERR1    MNOTE '**FIRST SYMBOL CONCATENATION INCOMPLETE**'              03060042
         MEXIT                                                          03150042
.SET2A   AIF   ('&SYSLIST(&OP+1,5)' EQ ''AND '&SYSLIST(&OP+1,6)' EQ '' X03240042
               ).SET2                   TEST FOR NO SECOND              03330042
  AIF   ('&SYSLIST(&OP+1,5)' EQ '' OR '&SYSLIST(&OP+1,6)' EQ '').ERR2   03420042
         AIF   ('&SYSLIST(&OP+1,5)' GT '&SYSLIST(&OP+1,6)').ERR3        03510042
&END1    SETA  &SYSLIST(&OP+1,5)        GET START COUNT OF 2            03600042
&END2    SETA  &SYSLIST(&OP+1,6)        GET END COUNT OF 2              03690042
         AGO   .LOOP                                                    03780042
.SET2    ANOP                                                           03870042
&ONLY1   SETB  1                        INDICATE ONLY ONE CONCATENATION 03960042
         AGO   .LOOP                                                    04050042
.ERR2    MNOTE '**SECOND SYMBOL CONCATENATION INCOMPLETE**'             04140042
         MEXIT                                                          04230042
.ERR3    MNOTE '**START GREATER THAN END CONCATENATION**'               04320042
         MEXIT                                                          04410042
.LOOP    ANOP                                                           04500042
&OP      SETA  &OP+1                                                    04590042
         AIF   (&OP GT N'&SYSLIST).DONE      TEST IF ALL DONE           04680042
&ITEMNBR SETA  &ITEMNBR+1                                               04770042
         AIF   ('&SYSLIST(&OP,2)' NE '').OK1                            04860042
         MNOTE '**NULL BIT COUNT FIELD**'                               04950042
         MEXIT                                                          05040042
.OK1     ANOP                                                           05130042
&SYMBOL  SETC  '&SYSLIST(&OP,1)'                                        05220042
         AIF   ('&SYMBOL' NE '').OK                                     05310042
*              *****     LOG ITEM SYMBOL NOT PROVIDED     *****         05400042
         AIF   ('&SYSLIST(&OP,3)' NE 'EQU').CNT                         05490042
         AGO   .START                   GET NEXT                        05580042
.OK      AIF   (N'&SYSLIST(&OP) LT 3).NO3    TEST FOR OLD FORMAT        05670042
         AIF   ('&SYSLIST(&OP,3)' EQ 'EQU').EQU   TEST FOR EQU          05760042
         AIF   (&ONLY1).OK2             TEST FOR ONLY ONE CONCAT        05850042
&SYMBOL  SETC  '&SYMBOL.&START1.&END1'       GET 1 AND 2 CONCAT         05940042
         AGO   .NO3                     BRANCH AROUND                   06030042
.OK2     ANOP                                                           06120042
&SYMBOL  SETC  '&SYMBOL.&START1'        GET 1 CONCATENATED              06210042
.NO3     ANOP                                                           06300042
&SYMBOL  EQU   *+&BYTE                                                  06390042
&ITEM(&ITEMNBR) SETC '&SYMBOL'          GET LABEL IN GLOBAL             06480042
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2)                                    06570042
&SHIFT(&ITEMNBR) SETA &COUNT-&BYTE*8                                    06660042
.CNT     ANOP                                                           06750042
&CTIND   SETB  1                        SET COUNT INDICATOR             06840042
&COUNT   SETA  &COUNT+&SYSLIST(&OP,2)                                   06930042
&BYTE    SETA  &COUNT/8                                                 07020042
         AIF   (N'&SYSLIST(&OP) LT 3).START  TEST FOR OLD FORMAT        07110042
         AIF   (&ONLY1).TSTST           TEST FOR ONLY ONE CONCAT        07200042
         AIF   (&END1 EQ &END2).TSTST   TEST FOR SECOND END             07290042
&END1    SETA  &END1+1                  INCREMENT COUNT                 07380042
&OP      SETA  &OP-1                    DECREMENT INCREMENT             07470042
         AGO   .LOOP                    GENERATE NEXT                   07560042
.TSTST   ANOP                                                           07650042
         AIF   (&START1 EQ &START2).LPDONE   TEST FOR END               07740042
         AIF   (&ONLY1).NSET1           TEST FOR ONLY ONE CONCAT        07830042
&END1    SETA  &SYSLIST(&OP,5)          RE-INIT SECOND START COUNT      07920042
.NSET1   ANOP                                                           08010042
&OP      SETA  &OP-1                    DECREMENT INDEX                 08100042
&START1  SETA  &START1+1                INCREMENT FIRST COUNT           08190042
         AGO   .LOOP                    GO DO NEXT                      08280042
.LPDONE  ANOP                                                           08370042
&ONLY1   SETB  0                        CLEAR INDICATOR                 08460042
         AGO   .START                   GO TEST FOR MORE SUB-LISTS      08550042
.DONE    AIF   (&COUNT-&COUNT/8*8 NE 0).ERR  TEST FOR MULTIPLE OF EIGHT 08640042
         AIF   (&CTIND EQ 0).END        NO DS IF NO COUNT               08730042
&COUNT   SETA  &COUNT/8                 GET NUMBER OF BYTES             08820042
&NAME    DS    &COUNT.C                                                 08910042
.END     MEXIT                                                          09000042
.ERR     MNOTE '**BIT COUNT FLDS DO NOT TOTAL MULTIPLE OF 8**'          09090042
         MEXIT                                                          09180042
.EQU     AIF   ('&SYSLIST(&OP,4)' NE '').EQU1     TEST FOR NULL LABEL   09270042
.ERR4    MNOTE '**EQU OPERAND OMITTED OR NOT FOUND**'                   09360042
         MEXIT                                                          09450042
.EQU1    AIF   (&SYSLIST(&OP,2) LT 16).EQU2  COUNT OVER FIFTEEN         09540042
*****               THE FOLLOWING STATEMENT                *****        09630042
*****     NUMBER OF BITS EXCEED 15 - DO NOT USE AS BIN     *****        09720042
.EQU2    ANOP                                                           09810042
&EQUCNT  SETA  0                        CLEAR COUNTER                   09900042
&EQUSYM  SETC  '&SYSLIST(&OP,4)'        GET EQU OPERAND                 09990042
.EQULOP  ANOP                                                           10080042
&EQUCNT  SETA  &EQUCNT+1                INCREMENT INDEX                 10170042
         AIF   ('&ITEM(&EQUCNT)' EQ '&EQUSYM').EQUOUT  LABEL FOUND?     10260042
         AIF   (&EQUCNT EQ &ITEMNBR).ERR3    ALL TESTED?                10350042
         AGO   .EQULOP                  NO-GET NEXT                     10440042
.EQUOUT  ANOP                                                           10530042
&ITEM(&ITEMNBR) SETC '&SYMBOL'          GET LABEL NAME                  10620042
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2)    GET NUMBER OF BITS              10710042
&SHIFT(&ITEMNBR) SETA &SHIFT(&EQUCNT)   GET SHIFT COUNT                 10800042
&SYMBOL  EQU   &EQUSYM                  THIS SYMBOL EQUATED             10890042
         AGO   .START                   RETURN FOR NEXT                 10980042
         MEND                                                           11070042
*  LINE MACRO     LINE MACRO     LINE MACRO     LINE MACRO            * 11160042
         SPACE 2                                                        11250042
         MACRO                                                          11340042
&NAME    LINE  &DATA,&LABEL,&SKIP=                                      11430042
.*                            THIS MACRO ESTABLISHES THE MARGINS OR     11520042
.*                                 COLUMN SETTINGS FOR EACH LINE. IT    11610042
.*                                 GENERATES NECESSARY CARRIAGE CONTROL 11700042
.*                                 ENTRIES. LASTLY IT DETERMINES THE    11790042
.*                                 NUMBER OF ENTRIES ASSOCIATED WITH    11880042
.*                                 THE PREVIOUS LINE AND STORES THAT #  11970042
.*                                 INTO THE APPROPRIATE BYTE.           12060042
.*                            &DATA(1) - CHARACTER POSITION TO BEGIN    12150042
.*                                 DATA.                                12240042
.*                            &DATA(2) - # OF SPACES BETWEEN SUCCESSIVE 12330042
.*                                 DATA COLUMN STARTING CHARACTERS.     12420042
.*                            &LABEL(1) - CHAR. POS. TO BEGIN LABELS.   12510042
.*                            &LABEL(2) - # SPACES BETWEEN LINE'S LABEL 12600042
.*                                 STARTING CHARACTERS.                 12690042
.*                            &SKIP= - # OF LINES TO ADVANCE CARRIAGE   12780042
.*                                 TO BEGIN NEXT PRINTED LINE.          12870042
.*                            NEW ENTRIES ARE GENERATED ONLY WHEN       12960042
.*                                 NECESSARY. OMISSION OF ITEMS MEANS   13050042
.*                                 THEY HAVE NOT CHANGED SINCE PREVIOUS 13140042
.*                                 SETTINGS. A LINE MACRO IS REQUIRED   13230042
.*                                 FOR EACH PRINTED LINE. IF NO SETTING 13320042
.*                                 CHANGES ARE REQUIRED ALL OPERANDS    13410042
.*                                 ARE OMITTED IN WHICH CASE ONLY THE   13500042
.*                                 # OF ENTRIES FOR THE PREVIOUS LINE   13590042
.*                                 IS COMPUTED. THIS MACRO MUST BE THE  13680042
.*                                 FIRST MACRO INSTRUCTION ISSUED FOR   13770042
.*                                 THE SUBJECT LINE                     13860042
         GBLA  &DB,&DT,&LB,&LT,&NRENTS                                  13950042
         GBLA  &LASTCC,&INITIAL                                         14040042
         GBLC  &NRENTSX                                                 14130042
         GBLC  &CARRCON                                                 14220042
         GBLB  &TEST                                                    14310042
         LCLA  &S                                                       14400042
&NAME    DS    0C                                                       14490042
         AIF   (&INITIAL EQ 0).FIRSTLN                                  14580042
         LINEND                                                         14670042
         AGO   .NTFIRST                                                 14760042
.FIRSTLN ANOP                                                           14850042
&NRENTSX SETC  'N&SYSNDX'                                               14940042
&INITIAL SETA  1                                                        15030042
N&SYSNDX EQU   *                                                        15120042
.NTFIRST ANOP                                                           15210042
         DC    AL1(0)                                                   15300042
         AIF   ('&DATA(1)' EQ '').CKDTABS                               15390042
         AIF   (&DATA(1) EQ &DB).CKDTABS                                15480042
&DB      SETA  &DATA(1)                                                 15570042
         AGO   .AA                                                      15660042
.CKDTABS AIF   ('&DATA(2)' EQ '').NCDATA                                15750042
         AIF   (&DATA(2) EQ &DT).NCDATA                                 15840042
         AGO   .CC                                                      15930042
.AA      AIF   ('&DATA(2)' EQ '').BB                                    16020042
         AIF   (&DATA(2) EQ &DT).BB                                     16110042
.CC      ANOP                                                           16200042
&DT      SETA  &DATA(2)                                                 16290042
.BB      DC    XL2'FFFE'                                                16380042
         DC    FL1'&DB'                                                 16470042
         DC    FL1'&DT'                                                 16560042
&NRENTS  SETA  &NRENTS+1                                                16650042
.NCDATA  ANOP                                                           16740042
         AIF   ('&LABEL(1)' EQ '').CKLTABS                              16830042
         AIF   (&LABEL(1) EQ &LB).CKLTABS                               16920042
&LB      SETA  &LABEL(1)                                                17010042
         AGO   .AAA                                                     17100042
.CKLTABS AIF   ('&LABEL(2)' EQ '').NCLABEL                              17190042
         AIF   (&LABEL(2) EQ &LT).NCLABEL                               17280042
         AGO   .CCC                                                     17370042
.AAA     AIF   ('&LABEL(2)' EQ '').BBB                                  17460042
         AIF   (&LABEL(2) EQ &LT).BBB                                   17550042
.CCC     ANOP                                                           17640042
&LT      SETA  &LABEL(2)                                                17730042
.BBB     DC    XL2'FFFF'                                                17820042
         DC    FL1'&LB'                                                 17910042
         DC    FL1'&LT'                                                 18000042
&NRENTS  SETA  &NRENTS+1                                                18090042
.NCLABEL ANOP                                                           18180042
         AIF   ('&SKIP' NE '').CONT                                     18270042
         AIF   (&TEST EQ 0).NOCHANG                                     18360042
&S       SETA  &LASTCC                                                  18450042
         AGO   .DEFAULT                                                 18540042
.CONT    ANOP                                                           18630042
         AIF   (&TEST EQ 0).AB                                          18720042
&S       SETA  &SKIP                                                    18810042
.DEFAULT ANOP                                                           18900042
         ORG   &CARRCON+3                                               18990042
         DC    AL.3(0),AL.2(&S),AL.3(1)                                 19080042
         ORG                                                            19170042
&LASTCC  SETA  &S                                                       19260042
&TEST    SETB  0                                                        19350042
         AGO   .DD                                                      19440042
.AB      AIF   (&SKIP EQ &LASTCC).NOCHANG                               19530042
A&SYSNDX DC    XL2'FFFB'                                                19620042
         DC    AL.3(0),AL.2(&SKIP),AL.3(1)                              19710042
         DC    FL1'9'                                                   19800042
&LASTCC  SETA  &SKIP                                                    19890042
&TEST    SETB  1                                                        19980042
&CARRCON SETC  'A&SYSNDX'                                               20070042
&NRENTS  SETA  &NRENTS+1                                                20160042
.DD      ANOP                                                           20250042
.NOCHANG ANOP                                                           20340042
         MEND                                                           20430042
         EJECT                                                          20520042
*  BIN MACRO     BIN MACRO     BIN MACRO     BIN MACRO     BIN MACRO  * 20610042
         SPACE 2                                                        20700042
         MACRO                                                          20790042
         BIN   &LOGITEM,&SKIP$OR                                        20880042
.*                                 &LOGITEM - NAME OF ITEM IN LOG       20970042
.*                                      RECORD DSECT                    21060042
.*                                 &SKIP$OR - NBR OF SPACES TO SKIP ON  21150042
.*                                 MULTIPLE PRINT OR NBR OF SPACES      21240042
.*                                      TO BACK UP FROM COLUMN FOR      21330042
.*                                      START OF PRINTING. THE LETTER   21420042
.*                                      B PRECEEDS THE NUMBER (B5) IF   21510042
.*                                      THE LATTER IS DESIRED. OMISSION 21600042
.*                                      OF THIS OPERAND FORCES OPTION 2 21690042
.*                                      WITH BACKUP SPACING EQUAL TO    21780042
.*                                 THE NUMBER OF BITS IN THE ITEM       21870042
.*                                 DEFINITION (VIA MACRO 'DSGEN').      21960042
.*                            A LIMIT OF 15 BITS IS IMPOSED FOR THE     22050042
.*                                 TOTAL NUMBER OF BITS TO PRINT.       22140042
         GBLC &ITEM(1000)                                               22230042
         GBLA &ITEMNBR,&BITS(1000),&SHIFT(1000),&NRENTS                 22320042
         GBLC  &DSECT                                                   22410042
         LCLB  &B                                                       22500042
         LCLA  &IBITS,&NDX,&ISHIFT,&K                                   22590042
         LCLA  &TEMP,&T                                                 22680042
         LCLC  &S                                                       22770042
.LOOP    ANOP                                                           22860042
&NDX     SETA  &NDX+1                                                   22950042
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      23040042
         AIF   (&NDX LT &ITEMNBR).LOOP                                  23130042
         MNOTE *,'YOU BLEW IT'                                          23220042
         ROUTINE DUM,SKIPPER                                            23310042
         MEXIT                                                          23400042
.FOUND   ANOP                                                           23490042
&ISHIFT  SETA  &SHIFT(&NDX)                                             23580042
&IBITS   SETA  &BITS(&NDX)                                              23670042
&T       SETA  &IBITS-1                                                 23760042
&B       SETB  0                                                        23850042
         AIF   ('&SKIP$OR' EQ '').BACKUP                                23940042
&K       SETA  K'&SKIP$OR                                               24030042
&B       SETB  ('&SKIP$OR'(1,1) EQ 'B')                                 24120042
&S       SETC  '&SKIP$OR'(&B+1,&K-&B)                                   24210042
&T       SETA  &S                                                       24300042
.BACKUP  ANOP                                                           24390042
&NRENTS  SETA  &NRENTS+1                                                24480042
&TEMP    SETA  &ISHIFT                                                  24570042
A&SYSNDX DC    AL.12(&LOGITEM-&DSECT),XL.4'&TEMP'                       24660042
         AIF (&IBITS EQ 1 AND &B EQ 0).OUT                              24750042
         ORG   A&SYSNDX                                                 24840042
&B       SETB  1                                                        24930042
         DC    AL.12(&LOGITEM-&DSECT),XL.4'C'                           25020042
         DC    BL.1'&B',AL.7(&T),AL.4(&IBITS),FL.4'&ISHIFT'             25110042
.OUT     ANOP                                                           25200042
         MEND                                                           25290042
         EJECT                                                          25380042
*  HEX MACRO     HEX MACRO     HEX MACRO    HEXN MACRO     HEX MACRO  * 25470042
         SPACE 2                                                        25560042
         MACRO                                                          25650042
         HEX   &LOGITEM,&SKIP$OR,&BYTES                                 25740042
.*                            THIS MACRO FACILITATES GENERATION OF THE  25830042
.*                                 TABLE ENTRIES SPECIFYING HEX TYPE    25920042
.*                                 CONVERSIONS.                         26010042
.*                            &LOGITEM - NAME OF DATA ITEM TO BE        26100042
.*                                 CONVERTED                            26190042
.*                            &SKIP$OR - NUMBER OF SPACES TO SKIP ON    26280042
.*                                 MULTIPLE PRINT OR NBR OF SPACES TO   26370042
.*                                 BACK UP FROM COLUMN FOR START OF     26460042
.*                                 PRINTING. THE LETTER B PRECEEDS THE  26550042
.*                                 NUMBER (B8) IF THE LATTER OPTION IS  26640042
.*                                 DESIRED. OMISSION OF THIS OPERAND    26730042
.*                                 FORCES OPTION 2 WITH BACKUP SPACING  26820042
.*                                 EQUAL TO THE NUMBER OF BYTES SPECI-  26910042
.*                                 FIED BY THE NEXT OPERAND (TWICE THIS 27000042
.*                                 NUMBER IF SUFFIX IS EXPLICITLY OR    27090042
.*                                 IMPLICITLY B).                       27180042
.*                            &BYTES - NUMBER OF TOTAL INPUT BYTES TO   27270042
.*                                 PROCESS. THIS NUMBER IS SUFFIXED     27360042
.*                                 WITH AN L,R, OR B TO STIPULATE       27450042
.*                                 PRINTING OF THE LEFT HALF, RIGHT     27540042
.*                                 HALF, OR BOTH HALVES OF THE BYTE     27630042
.*                                 RESPECTIVELY. OMISSION OF THIS       27720042
.*                                 OPERAND DEFAULTS TO B WITH THE NUM-  27810042
.*                                 BER OF BYTES EQUAL TO THE ITEM LNGTH 27900042
.*                            A NEW ENTRY IS GENERATED ONLY WHEN NECES- 27990042
.*                                 SARY. THIS MACRO MUST BE THE FIRST   28080042
.*                                 MACRO INSTRUCTION ISSUED FOR THE     28170042
.*                                 SUBJECT LINE(S).                     28260042
         GBLC &ITEM(1000),&DSECT                                        28350042
         GBLA &ITEMNBR,&BITS(1000),&SHIFT(1000),&NRENTS                 28440042
         LCLB  &B                                                       28530042
         LCLA  &IBITS,&NDX,&ISHIFT,&K,&T,&CODE,&BYTESP                  28620042
         LCLC  &S,&LETTER                                               28710042
.LOOP    ANOP                                                           28800042
&NDX     SETA  &NDX+1                                                   28890042
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      28980042
         AIF   (&NDX LT &ITEMNBR).LOOP                                  29070042
         MNOTE *,'LOG ITEM NOT DEFINED'                                 29160042
         MEXIT                                                          29250042
.FOUND   ANOP                                                           29340042
&ISHIFT  SETA  &SHIFT(&NDX)                                             29430042
&IBITS   SETA  &BITS(&NDX)                                              29520042
&CODE    SETA  1                                                        29610042
&K       SETA  K'&BYTES                                                 29700042
         AIF   (&IBITS-(&IBITS/4)*4 EQ 0).OK                            29790042
         MNOTE *,'BIT LENGTH SPECIFICATION INCONSISTENT WITH CONTROL'   29880042
         MEXIT                                                          29970042
.OK      AIF   ('&BYTES' EQ '').USEDEFN                                 30060042
&LETTER  SETC  '&BYTES'(&K,1)                                           30150042
&S       SETC  '&BYTES'(1,&K-1)                                         30240042
&BYTESP  SETA  &S                                                       30330042
         AIF   ('&LETTER' EQ 'B').BOTH                                  30420042
         AIF   (&ISHIFT EQ 0 OR &ISHIFT EQ 4).OK2                       30510042
.ERR     MNOTE *,'DATA NOT ALLIGNED ON HEX OR BYTE BOUNDARY'            30600042
         MEXIT                                                          30690042
.USEDEFN ANOP                                                           30780042
&BYTESP  SETA  &IBITS/8                                                 30870042
.BOTH    AIF   (&ISHIFT NE 0).ERR                                       30960042
&CODE    SETA  3                                                        31050042
&T       SETA  &BYTESP*2-1                                              31140042
&S       SETC  '&T'                                                     31230042
.OK2     AIF   (&ISHIFT EQ 0).L                                         31320042
&CODE    SETA  2                                                        31410042
.L       ANOP                                                           31500042
&B       SETB  1                                                        31590042
         AIF   ('&SKIP$OR' EQ '').BACKUP                                31680042
&K       SETA  K'&SKIP$OR                                               31770042
&B       SETB  ('&SKIP$OR'(1,1) EQ 'B')                                 31860042
&S       SETC  '&SKIP$OR'(&B+1,&K-&B)                                   31950042
.BACKUP  ANOP                                                           32040042
&NRENTS  SETA  &NRENTS+1                                                32130042
         DC    AL.12(&LOGITEM-&DSECT),XL.4'A'                           32220042
         DC    BL.1'&B',FL.7'&S',FL.4'&BYTESP',FL.4'&CODE'              32310042
.OUT     ANOP                                                           32400042
         MEND                                                           32490042
         SPACE 2                                                        32580042
*  ROUTINE MACRO     ROUTINE MACRO     ROUTINE MACRO     ROUTINE MACRO* 32670042
         SPACE 2                                                        32760042
         MACRO                                                          32850042
&NAME    ROUTINE &LOGITEM,&RNAME                                        32940042
         GBLC  &DSECT,&CSECT                                            33030042
         GBLC  &ITEM(1000)                                              33120042
         GBLA  &SHIFT(1000),&ITEMNBR                                    33210042
         GBLA  &NRENTS                                                  33300042
         LCLA  &ISHIFT,&NDX                                             33390042
.LOOP    ANOP                                                           33480042
&NDX     SETA  &NDX+1                                                   33570042
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      33660042
         AIF   (&NDX LT &ITEMNBR).LOOP                                  33750042
         MNOTE *,'LOG ITEM NOT DEFINED'                                 33840042
         MEXIT                                                          33930042
.FOUND   ANOP                                                           34020042
&ISHIFT  SETA  &SHIFT(&NDX)                                             34110042
&NAME    DC    AL.12(&LOGITEM-&DSECT),XL.4'D'                           34200042
         DC    AL.4(&ISHIFT),AL.12(&RNAME-&CSECT)                       34290042
&NRENTS  SETA  &NRENTS+1                                                34380042
         MEND                                                           34470042
         EJECT                                                          34560042
*  LABEL MACRO     LABEL MACRO     LABEL MACRO     LABEL MACRO        * 34650042
         SPACE 2                                                        34740042
         MACRO                                                          34830042
&NAME    LABEL &LABEL1,&LABEL2,&LABEL3,&LABEL4,&LABEL5,&LABEL6,        C34920042
               &LABEL7,&LABEL8                                          35010042
.*                            THIS MACRO ALLOWS UP TO ACHT LABELS TO    35100042
.*                                 BE SPECIFIED FOR A GIVEN LINE. THE   35190042
.*                                 LABELS SHOULD BE ENCLOSED IN QUOTA-  35280042
.*                                 TION MARKS. THE COLUMN AND LINE END  35370042
.*                                 CONTROLS WILL BE INSERTED BY THE     35460042
.*                                 MACRO. OMITTED OPERANDS MEAN NO      35550042
.*                                 LABEL REQUIRED FOR RESPECTIVE        35640042
.*                                 COLUMN. THIS MACRO WILL ALSO ALERT   35730042
.*                                 THE PROGRAMMER TO EXACTLY WHERE THE  35820042
.*                                 TABLE MUST BE BROKEN IF NECESSARY    35910042
.*                                 TO AVOID EXCEEDING THE MAXIMUM LIMIT 36000042
         GBLC &LABELS(2000)                                             36090042
         GBLC  &LBL(100)                                                36180042
         GBLA  &LBLCTR(100)                                             36270042
         GBLA  &LABELNR                                                 36360042
         GBLA  &NRENTS,&LPTR                                            36450042
         LCLC  &MARGIN,&TACK                                            36540042
         LCLC  &TEXT                                                    36630042
         LCLA  &OP,&K,&START,&NRCHAR,&REMAIN                            36720042
&MARGIN  SETC  '*'                                                      36810042
         AIF   ('&NAME' EQ '').LOOPOUT                                  36900042
&LPTR    SETA  &LPTR+1                                                  36990042
&LBL(&LPTR) SETC '&NAME'                                                37080042
&LBLCTR(&LPTR) SETA &LABELNR+1                                          37170042
.LOOPOUT ANOP                                                           37260042
&OP      SETA  &OP+1                                                    37350042
&K       SETA  K'&SYSLIST(&OP)                                          37440042
         AIF (&K GE 2).NORM                                             37530042
&K       SETA  2                                                        37620042
.NORM    ANOP                                                           37710042
&START   SETA  2                                                        37800042
         AIF (&OP LT N'&SYSLIST).NOTLAST                                37890042
&MARGIN  SETC  '$'                                                      37980042
.NOTLAST ANOP                                                           38070042
&NRCHAR  SETA  8                                                        38160042
&TACK    SETC  ''                                                       38250042
.LOOPIN  ANOP                                                           38340042
&REMAIN  SETA  &K-&START                                                38430042
         AIF (&REMAIN GE 8).MORE                                        38520042
&TACK    SETC  '&MARGIN'                                                38610042
&NRCHAR  SETA  &REMAIN                                                  38700042
.MORE    ANOP                                                           38790042
&TEXT    SETC  ''                                                       38880042
         AIF (&REMAIN EQ 0).ENDTEXT                                     38970042
&TEXT    SETC  '&SYSLIST(&OP)'(&START,&NRCHAR)                          39060042
.ENDTEXT ANOP                                                           39150042
&LABELNR SETA  &LABELNR+1                                               39240042
&LABELS(&LABELNR) SETC '&TEXT'.'&TACK'                                  39330042
&START   SETA  &START+8                                                 39420042
         AIF ('&TACK' EQ '').LOOPIN                                     39510042
         AIF ('&TACK' EQ '*').LOOPOUT                                   39600042
         MEND                                                           39690042
         SPACE 2                                                        39780042
         MACRO                                                          39870042
         LSTART                                                         39960042
.*                            THIS MACRO IS ISSUED WHEN THE LABEL AREA  40050042
.*                                 OF THE TABLE IS TO BEGIN.            40140042
         GBLC &LABELS(2000)                                             40230042
         GBLA  &LABELNR                                                 40320042
         GBLC  &LBL(100)                                                40410042
         GBLA  &LBLCTR(100)                                             40500042
         LCLA  &NDX,&CTR                                                40590042
         LINEND                                                         40680042
&CTR     SETA  1                                                        40770042
.LOOP    ANOP                                                           40860042
&NDX     SETA  &NDX+1                                                   40950042
         AIF   (&LBLCTR(&CTR) NE &NDX).NOLBL                            41040042
&LBL(&CTR) DC  C'&LABELS(&NDX)'                                         41130042
&CTR     SETA  &CTR+1                                                   41220042
         AGO   .LOOPCTL                                                 41310042
.NOLBL   ANOP                                                           41400042
         DC    C'&LABELS(&NDX)'                                         41490042
.LOOPCTL AIF   (&NDX LT &LABELNR).LOOP                                  41580042
         MEND                                                           41670042
         SPACE 2                                                        41760042
         MACRO                                                          41850042
         LINEND                                                         41940042
.*                            THIS MACRO IS USED ONLY BY THE LINE       42030042
.*                                 MACRO TO SET THE NUMBER OF ENTRIES   42120042
.*                                 ASSOCIATED WITH EACH LINE.           42210042
         GBLA  &NRENTS                                                  42300042
         GBLC &NRENTSX                                                  42390042
         ORG   &NRENTSX                                                 42480042
         DC    FL1'&NRENTS'                                             42570042
         ORG                                                            42660042
&NRENTS  SETA  0                                                        42750042
B&SYSNDX EQU   *                                                        42840042
&NRENTSX SETC  'B&SYSNDX'                                               42930042
         MEND                                                           43020042
         MACRO                                                          43110042
         SPECIAL  &ROUTINE,&PARAM,&SPACE=                               43200042
.*                            THIS MACRO GENERATES A SPECIAL ROUTINE    43290042
.*                                 ENTRY TO BE PROCESSED BY THE SUM. M. 43380042
.*                            &ROUTINE - SYMBOL ON SPECIAL ROUTINE EWT. 43470042
.*                            &PARAM - AN 8 BIT BINARY REPRESENTATION   43560042
.*                                 TO OCCUPY THE 'MASK' FIELD BUT TO BE 43650042
.*                                 INTERPRETED AS AN ARGUMENT OF THE    43740042
.*                                 SPECIAL ROUTINE.                     43830042
.*                            &SPACE - THE NUMBER OF 2BYTE COUNTERS TO  43920042
.*                                 ALLOCATE FOR REQUIRED PROCESSING.    44010042
         GBLC  &CSECT                                                   44100042
         GBLA  &COUNTR                                                  44190042
         LCLA  &ADD                                                     44280042
         DC    AL1(128)                                                 44370042
         DC    BL.8'&PARAM'                                             44460042
         DC    AL2(&ROUTINE-&CSECT)                                     44550042
         DC    AL2(&COUNTR)                                             44640042
&ADD     SETA  1                                                        44730042
         AIF   ('&SPACE' EQ '').NORM                                    44820042
&ADD     SETA  &SPACE                                                   44910042
.NORM    ANOP                                                           45000042
&COUNTR  SETA  &COUNTR+&ADD                                             45090042
         MEND                                                           45180042
         MACRO                                                          45270042
         SUM   &LOGITEM,&MASK                                           45360042
.*                            THIS MACRO GENERATES A NORMAL EDIT ENTRY  45450042
.*                                 FOR PROCESSING BY THE SUMMARY MODULE 45540042
.*                            &LOGITEM - NAME OF DATA ITEM TO BE SUMMED 45630042
.*                            &MASK - BYTE MASK FOR BITS TO BE TESTED.  45720042
.*                                 THIS OPERAND SHOULD BE OMITTED FOR   45810042
.*                                 SINGLE BIT ITEMS IN WHICH CASE THE   45900042
.*                                 MASK WILL BE SET ACCORDING TO THE    45990042
.*                                 OFF BYTE BIT DISPLACEMENT OF THE     46080042
.*                                ITEM AS DEFINED BY THE MACRO 'DSGEN'  46170042
         GBLA  &COUNTR,&ITEMNBR,&BITS(1000),&SHIFT(1000)                46260042
         GBLC  &ITEM(1000),&DSECT                                       46350042
         LCLA  &IBITS,&NDX,&ISHIFT,&M,&BITNBR                           46440042
.LOOP    ANOP                                                           46530042
&NDX     SETA  &NDX+1                                                   46620042
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      46710042
         AIF   (&NDX LT &ITEMNBR).LOOP                                  46800042
         MNOTE *,'LOGITEM NOT FOUND'                                    46890042
         MEXIT                                                          46980042
.FOUND   ANOP                                                           47070042
         DC    AL1(0)                                                   47160042
&ISHIFT  SETA  &SHIFT(&NDX)                                             47250042
&IBITS   SETA  &BITS(&NDX)                                              47340042
         AIF   ('&MASK' EQ '').FORM                                     47430042
         DC    B'&MASK'                                                 47520042
         AGO   .ITEM                                                    47610042
.FORM    ANOP                                                           47700042
&BITNBR  SETA  &ISHIFT-7                                                47790042
&BITNBR  SETA  0-&BITNBR                                                47880042
&M       SETA  1                                                        47970042
.LOOP2   ANOP                                                           48060042
         AIF   (&BITNBR EQ 0).GOTIT                                     48150042
&M       SETA  &M*2                                                     48240042
&BITNBR  SETA  &BITNBR-1                                                48330042
         AGO   .LOOP2                                                   48420042
.GOTIT   ANOP                                                           48510042
         DC    AL1(&M)                                                  48600042
.ITEM    DC    AL2(&LOGITEM-&DSECT)                                     48690042
         DC    AL2(&COUNTR)                                             48780042
&COUNTR  SETA  &COUNTR+1                                                48870042
         MEND                                                           48960042
         GBLC  &DSECT,&CSECT                                   @Z40NIVS 49050042
IFCSCUA1 CSECT                                                 @Z40NIVS 49140042
&CSECT   SETC  'IFCSCUA1'                                      @Z40NIVS 49230042
&DSECT   SETC  'M3420'                                         @Z40NIVS 49320042
M3420    DSECT                                                 @Z40NIVS 49410042
         DSGEN (CLASSRC,8),(SYSREL,8),(SWITCHES,16),           @Z40NIVSC49500042
               (SPARES,32)                                     @Z40NIVS 49590042
         DSGEN (DATE,32),(TIME,32)                             @Z40NIVS 49680042
         DSGEN (DUM2,8),(CPUSER,24),(CPUID,16),(DUM3,16)       @Z40NIVS 49770042
         DSGEN (,264)                                          @Z40NIVS 49860042
         DSGEN (PRIMCUA,8,0,2),(IORETRY,16),(SNSCNT,16)        @Z40NIVS 49950042
         DSGEN (VOLID,48),(BLKLENG,16),(,32),(TEMPRDS,8),      @Z40NIVSC50040042
               (TEMPWRTS,8),                                   @Z40NIVSX50130042
               (SIOCNT,16),(PERMRDS,8),(PERMWRTS,8),           @Z40NIVSC50220042
               (NOISEBLK,8),                                   @Z40NIVSX50310042
               (,8),(ERASEGPS,16),(CLNRACTS,16)                @Z40NIVS 50400042
         DSGEN (SPAR,8),(NOISE,8),(RWVRC,8),(MTELRCR,8)        @Z40NIVS 50490042
         DSGEN (EDCCRC,8),(ENVCKVRC,8),(OVERRUN,4),            @Z40NIVSC50580042
               (SKEWCHK,4),                                    @Z40NIVSC50670042
               (CCOMPARE,4),(WRTTRVRC,4)                       @Z40NIVS 50760042
         DSGEN (PEIDCHK,1),(MASKEXP,6),(PARITY,1),             @Z40NIVSC50850042
               (TRKINERR,8),                                   @Z40NIVSC50940042
               (WRTTMCHK,4),(STRDCHK,4),(PARTREC,4),           @Z40NIVSC51030042
               (EXCPAMB,4)                                     @Z40NIVS 51120042
         DSGEN (ORDROP,4),(FEEDTHRU,4),(EXP,4),(EARLBGRD,4),   @Z40NIVSC51210042
               (EARLNDRD,4),(SLBGRD,4),(SLWNDRD,4),            @Z40NIVSC51300042
               (VELRETRY,4),                                   @Z40NIVSC51390042
               (EXP2,4),(VELCHNG,4),(EXP3A,4),(EXP3,4),        @Z40NIVSC51480042
               (BACKWARD,8),                                   @Z40NIVSC51570042
               (BUSOCHK,4),(ALUHRDER,4)                        @Z40NIVS 51660042
         DSGEN (SNB,1,0,23,0,7)                                @Z40NIVS 51750042
         DSGEN (TUSERIAL,16,EQU,SNB150)                        @Z40NIVS 51840042
IFCSCUA1 CSECT                                                 @Z40NIVS 51930042
         USING M3420,R2                                        @Z40NIVS 52020042
         USING *,R9                                            @Z40NIVS 52110042
         DC    A(ENTRIES)                                      @Z40NIVS 52200042
         DC    A(EDIT)                                         @Z40NIVS 52290042
REG8     DC    F'0'                                            @Z40NIVS 52380042
SCSIZE   DC    H'544'                                          @Z40NIVS 52470042
R2       EQU   2                                               @Z40NIVS 52560042
R3       EQU   3                                               @Z40NIVS 52650042
R4       EQU   4                                               @Z40NIVS 52740042
R5       EQU   5                                               @Z40NIVS 52830042
R6       EQU   6                                               @Z40NIVS 52920042
R7       EQU   7                                               @Z40NIVS 53010042
R8       EQU   8                                               @Z40NIVS 53100042
R9       EQU   9                                               @Z40NIVS 53190042
R14      EQU   14                                              @Z40NIVS 53280042
R15      EQU   15                                              @Z40NIVS 53370042
L0       EQU   0                                               @Z40NIVS 53460042
L1       EQU   1                                               @Z40NIVS 53550042
L2       EQU   2                                               @Z40NIVS 53640042
L3       EQU   3                                               @Z40NIVS 53730042
L4       EQU   4                                               @Z40NIVS 53820042
L5       EQU   5                                               @Z40NIVS 53910042
L6       EQU   6                                               @Z40NIVS 54000042
L7       EQU   7                                               @Z40NIVS 54090042
L8       EQU   8                                               @Z40NIVS 54180042
L28      EQU   28                                              @Z40NIVS 54270042
ZERO     EQU   0                                               @Z40NIVS 54360042
ONE      EQU   1                                               @Z40NIVS 54450042
TWO      EQU   2                                               @Z40NIVS 54540042
THREE    EQU   3                                               @Z40NIVS 54630042
FOUR     EQU   4                                               @Z40NIVS 54720042
FIVE     EQU   5                                               @Z40NIVS 54810042
SIX      EQU   6                                               @Z40NIVS 54900042
SEVEN    EQU   7                                               @Z40NIVS 54990042
EIGHT    EQU   8                                               @Z40NIVS 55080042
TWELVE   EQU   12                                              @Z40NIVS 55170042
L16      EQU   16                                              @Z40NIVS 55260042
L20      EQU   20                                              @Z40NIVS 55350042
L22      EQU   22                                              @Z40NIVS 55440042
L24      EQU   24                                              @Z40NIVS 55530042
L78      EQU   78                                              @Z40NIVS 55620042
L12      EQU   12                                              @Z40NIVS 55710042
R12      EQU   12                                              @Z40NIVS 55800042
L59      EQU   59                                              @Z40NIVS 55890042
L64      EQU   64                                              @Z40NIVS 55980042
L76      EQU   76                                              @Z40NIVS 56070042
L77      EQU   77                                              @Z40NIVS 56160042
L84      EQU   84                                              @Z40NIVS 56250042
L86      EQU   86                                              @Z40NIVS 56340042
DISMOUNT EQU   X'84'                                           @Z40NIVS 56430042
MOUNT    EQU   X'04'                                           @Z427VLS 56470042
F0       EQU   X'F0'                                           @Z40NIVS 56520042
FF       EQU   X'FF'                                           @Z40NIVS 56610042
DUMMYR   EQU   X'FE'                                           @Z40NIVS 56700042
FOXZERO  EQU   X'F0'                                           @Z40NIVS 56790042
LSTDEV   EQU   X'10'                                           @Z40NIVS 56880042
FSTSW    EQU   X'01'                                           @Z40NIVS 56970042
DECIMAL  EQU   C'.'                                            @Z40NIVS 57060042
         SPACE 2                                               @Z40NIVS 57150042
DEVICES  STM   R5,R8,XSAVE         SAVE THE REGS               @Z40NIVS 57240042
         TM    FOUR(R2),DUMMYR     IS THIS A DUMMY RECORD      @Z40NIVS 57330042
         BO    DONTSUM             YES, DON'T SUM IT           @Z40NIVS 57420042
         IC    R5,L59(R2)          GET CUA AND DEV ADDR        @Z40NIVS 57510042
         SLL   R5,L28              ISOLATE DEV AND             @Z40NIVS 57600042
         SRL   R5,L22              MULTIPLY BY 64              @Z40NIVS 57690042
         LA    R5,L64(R5)          ADD 64                      @Z40NIVS 57780042
         AR    R5,R3               POINT TO CORRECT SUM FIELD  @Z40NIVS 57870042
         ST    R5,THISDEVA         SAVE THE ADDRESS            @Z40NIVS 57960042
         ST    R3,THISDUMM         SAVE THE DUMMY SUM  AREA    @Z40NIVS 58050042
         MVC   ZERO(L64,R3),ZERO(R5) MOVE DATA TO DUMMY AREA   @Z40NIVS 58140042
         TM    L3(R2),DISMOUNT     IS THIS A DISMOUNT?         @Z40NIVS 58230042
         BZ    CUAS                NO, RETURN                  @Z40NIVS 58320042
TEMPRD   LH    R5,ZERO(R3)         GET RDERRS                  @Z40NIVS 58410042
         SR    R6,R6               CLEAR WORKREG               @Z40NIVS 58500042
         IC    R6,L76(R2)          GET NO. TEMP READ ERRORS    @Z40NIVS 58590042
         AR    R5,R6               SUM                         @Z40NIVS 58680042
         STH   R5,ZERO(R3)         PUT INTO SUM COUNTER        @Z40NIVS 58770042
TEMPWRT  LH    R5,TWO(R3)          GET WRITE ERROR SUM         @Z40NIVS 58860042
         IC    R6,L77(R2)          WRITE ERRORS THIS RECORD    @Z40NIVS 58950042
         AR    R5,R6               SUM                         @Z40NIVS 59040042
         STH   R5,TWO(R3)          PUT INTO SUM COUNTER        @Z40NIVS 59130042
STRTIOS  L     R5,FOUR(R3)         GET SIO SUM                 @Z40NIVS 59220042
         XR    R6,R6               CLEAR REG 6                 @Z40NIVS 59310042
         ICM   R6,THREE,L78(R2)    LOAD SIO COUNT              @Z40NIVS 59410042
         AR    R5,R6               SUM                         @Z40NIVS 59580042
         C     R5,TEN9             HAS OVERFLOW ACCURED        @Z40NIVS 59670042
         BH    SETR59S             IF YES SET MAXIMUN VALUE    @Z40NIVS 59760042
         ST    R5,FOUR(R3)         PUT INTO SUM COUNTER        @Z40NIVS 59850042
CLNACTS  L     R5,EIGHT(R3)        GET CLEANER ACTION SUM      @Z40NIVS 59940042
         LH    R6,L86(R2)          GET NO. THIS RECORD         @Z40NIVS 60030042
         AR    R5,R6               SUM                         @Z40NIVS 60120042
         ST    R5,EIGHT(R3)        PUT INTO SUM COUNTER        @Z40NIVS 60210042
ERASGAPS L     R5,TWELVE(R3)       GET ERASE GAP CTR           @Z40NIVS 60300042
         LH    R6,L84(R2)          GET NO. THIS RECORD         @Z40NIVS 60390042
         AR    R5,R6               SUM                         @Z40NIVS 60480042
         ST    R5,TWELVE(R3)       PUT INTO SUM COUNTER        @Z40NIVS 60570042
CUAS     MVC   L24(TWO,R3),PRIMCUA1  SAVE THE CUA              @Z40NIVS 60660042
FIRSTDAT L     R5,L16(R3)          GET HIDATE                  @Z40NIVS 60750042
         LTR   R5,R5               DOES IT EXIST?              @Z40NIVS 60840042
         BZ    HIANDLO             NO, GO UPDATE BOTH DATES    @Z40NIVS 60930042
         L     R6,EIGHT(R2)        GET OBRDATE                 @Z40NIVS 61020042
         CR    R5,R6               NEW HIGHER?                 @Z40NIVS 61110042
         BNH   UPHI                IF SO, GO UPDATE HIDATE     @Z40NIVS 61200042
         L     R5,L20(R3)          GET LODATE                  @Z40NIVS 61290042
         CR    R5,R6               NEW LOWER?                  @Z40NIVS 61380042
         BNL   UPLO                IF SO, GO UPDATE LODATE     @Z40NIVS 61470042
         B     SPRET3              GO SET R3 FOR SUMS          @Z40NIVS 61560042
SETR59S  MVC   FOUR(FOUR,R3),TEN9  SET MAXIMUM VALUE           @Z40NIVS 61650042
         B     CLNACTS             CONTINUE PROCESSING         @Z40NIVS 61740042
HIANDLO  L     R6,EIGHT(R2)        GET OBRDATE                 @Z40NIVS 61830042
         ST    R6,L16(R3)          SET HIDATE                  @Z40NIVS 61920042
         ST    R6,L20(R3)          SET LODATE                  @Z40NIVS 62010042
         B     SPRET3              GO SET R3 FOR SUMS          @Z40NIVS 62100042
UPHI     ST    R6,L16(R3)          SET NEW HIDATE              @Z40NIVS 62190042
         B     SPRET3              GO SET R3 FOR SUMS          @Z40NIVS 62280042
UPLO     ST    R6,L20(R3)          SET NEW LODATE              @Z40NIVS 62370042
*        B     SPRET3              GO SET R3 FOR SUMS          @Z40NIVS 62460042
SPRET3   LM    R5,R8,XSAVE         RESTORE REGS                @Z40NIVS 62550042
         BR    R14                 RETURN                      @Z40NIVS 62640042
DONTSUM  LA    R5,ENDSUM-SIX       GET ENDING FF               @Z40NIVS 62730042
         ST    R5,EIGHT(R9)        MAKE IT CURRENT             @Z40NIVS 62820042
         LM    R5,R8,XSAVE         RESTORE THE REGS            @Z40NIVS 62910042
         BR    R14                 RETURN                      @Z40NIVS 63000042
MOVEBACK STM   R5,R6,XSAVE         SAVE THE REGS               @Z40NIVS 63090042
         L     R5,THISDEVA         GET SUM AREA                @Z40NIVS 63180042
         L     R6,THISDUMM         GET DUMMY SUM ADDRESS       @Z40NIVS 63270042
         MVC   ZERO(L64,R5),ZERO(R6)  MOVE TO SUM AREA         @Z40NIVS 63360042
         LM    R5,R6,XSAVE         RESTORE THE REGS            @Z40NIVS 63450042
         BR    R14                 RETURN                      @Z40NIVS 63540042
SUMMOUNT TM    L3(R2),MOUNT        CHECK IF DISMOUNT ONLY, NO EOD       63550042
         BNOR  R14                 NOT A DISMOUNT, GET OUT     @Z427VLS 63560042
         ST    R5,XSAVE            SAVE R5                     @Z427VLS 63570042
         L     R5,MOUNTS           LOAD MOUNTS                 @Z427VLS 63580042
         LA    R5,ONE(R5)          ADD 1 TO DISMOUNT           @Z427VLS 63590042
         ST    R5,MOUNTS           SAVE                        @Z427VLS 63600042
         LA    R5,ONE              LOAD R5 WITH ONE            @Z427VLS 63610042
         B     SUM                 GO TO SUM                   @Z427VLS 63620042
SUMECC   ST    R5,XSAVE            SAVE R5                     @Z40NIVS 63900042
         IC    R5,ENVCKVRC         GET THE FIELD               @Z40NIVS 63990042
         B     BOTH                GO ISOLATE IT               @Z40NIVS 64080042
SUMSTRD  ST    R5,XSAVE            SAVE R5                     @Z40NIVS 64170042
         IC    R5,STRDCHK          GET THE FIELD               @Z40NIVS 64260042
         B     RIGHT               GO ISOLATE IT               @Z40NIVS 64350042
SUMPART  ST    R5,XSAVE            SAVE R5                     @Z40NIVS 64440042
         IC    R5,PARTREC          GET THE FIELD               @Z40NIVS 64530042
         B     LEFT                GO ISOLATE IT               @Z40NIVS 64620042
SUMOVER  ST    R5,XSAVE            SAVE R5                     @Z40NIVS 64710042
         IC    R5,OVERRUN          GET THE FIELD               @Z40NIVS 64800042
         B     LEFT                GO ISOLATE IT               @Z40NIVS 64890042
SUMVEL   ST    R5,XSAVE            SAVE R5                     @Z40NIVS 64980042
         IC    R5,VELCHNG          GET THE FIELD               @Z40NIVS 65070042
         B     RIGHT               GO ISOLATE IT               @Z40NIVS 65160042
SUMIBG   ST    R5,XSAVE            SAVE R5                     @Z40NIVS 65250042
         IC    R5,ORDROP           GET THE FIELD               @Z40NIVS 65340042
LEFT     SLL   R5,L24              SHIFT OUT UNWANTED BITS     @Z40NIVS 65520042
         SRL   R5,L28              SHIFT TO LOW ORDER          @Z40NIVS 65610042
         B     SUM                 GO GET TOTAL                @Z40NIVS 65700042
RIGHT    SLL   R5,L28              SHIFT UNWANTED BITS         @Z40NIVS 65790042
         SRL   R5,L28              BACK TO LOW ORDER           @Z40NIVS 65880042
         B     SUM                 GO GET TOTAL                @Z40NIVS 65970042
BOTH     SLL   R5,L24              SHIFT UNWANTED BITS         @Z40NIVS 66060042
         SRL   R5,L24              BACK TO LOW ORDER           @Z40NIVS 66150042
SUM      AH    R5,ZERO(R3)         ADD EXISTING COUNT          @Z40NIVS 66330042
         STH   R5,ZERO(R3)         SAVE NEW TOTAL              @Z40NIVS 66420042
         L     R5,XSAVE            RESTORE R5                  @Z40NIVS 66510042
         BR    R14                 RETURN                      @Z40NIVS 66600042
THISDEVA DS    F                   SAVE AREA FOR TRUE SUM AREA @Z40NIVS 66690042
THISDUMM DS    F                   ADDRESS OF DUMMY SUM AREA   @Z40NIVS 66780042
ENTRIES  DS    0F                                              @Z40NIVS 66960042
         SPECIAL DEVICES,0,SPACE=13                            @Z40NIVS 67050042
         SPECIAL SUMMOUNT,0,SPACE=1                            @Z427VLS 67140042
         SPECIAL SUMECC,0,SPACE=1                              @Z40NIVS 67230042
         SPECIAL SUMSTRD,0,SPACE=1                             @Z40NIVS 67320042
         SPECIAL SUMPART,0,SPACE=1                             @Z40NIVS 67410042
         SPECIAL SUMOVER,0,SPACE=1                             @Z40NIVS 67500042
         SPECIAL SUMVEL,0,SPACE=1                              @Z40NIVS 67590042
         SPECIAL SUMIBG,0,SPACE=1                              @Z40NIVS 67680042
         SPECIAL MOVEBACK,0,SPACE=1 GO MOVE DATE TO REAL CTR.  @Z40NIVS 67770042
ENDSUM   DC    X'FF'                                           @Z40NIVS 67860042
EDIT     DS    0F                                              @Z40NIVS 67950042
&DSECT   SETC  'BEGINEDT'                                      @Z40NIVS 68040042
&CSECT   SETC  'EDIT'                                          @Z40NIVS 68130042
         USING *,R9                                            @Z40NIVS 68220042
         USING HDR,R2                                          @Z40NIVS 68310042
         DC    A(SUMEDIT)                                      @Z40NIVS 68400042
         DC    CL8'IFCSCUA1'                                   @Z40NIVS 68490042
NINE     EQU   *                                               @Z40NIVS 68580042
LINE     DC    F'0'                                            @Z40NIVS 68670042
LABELPTR DC    F'0'                                            @Z40NIVS 68760042
BEGINEDT DSECT                                                 @Z40NIVS 68850042
         DSGEN (HDR,176)                                       @Z40NIVS 68940042
         DSGEN (RDERR,16),(WRTERR,16),(SIOS,32)                @Z40NIVS 69030042
         DSGEN (BEGIN,16,EQU,RDERR)                            @Z40NIVS 69120042
         DSGEN (CAS,32),(ERGS,32),(HIDATE,32),(LODATE,32)      @Z40NIVS 69210042
         DSGEN (THISCUA,16)                                    @Z40NIVS 69300042
         DSGEN (PCCOMP,16),(ECCVRC,16),(STRD,16),(PART,16)     @Z40NIVS 69390042
         DSGEN (OVER,16),(VELCH,16),(IBG,16)                   @Z40NIVS 69480042
IFCSCUA1 CSECT                                                 @Z40NIVS 69570042
*                                                                     * 69660042
* THE CONVERT ROUTINES WILL TAKE A COUNTER AND CONVERT IT TO          * 69750042
* PRINTABLE EBCDIC CHARACTERS. THEY ALL CONVERT INTO A DIFFERENT      * 69840042
* NUMBER OF DIGITS.                                                   * 69930042
*  CONVERT ---- FOUR DIGITS TO SIX DIGITS                               70020042
*  CONVERT1 --- TWO DIGITS TO FOUR DIGITS                               70110042
*  CONVERT2 --- TWO DIGITS TO SIX DIGITS                                70200042
*  CONVERT3 --- FOUR DIGITS TO EIGHT DIGITS                             70290042
*                                                                     * 70380042
*                                                                     * 70470042
CONVERT  ST    R5,SAVE             SAVE THE REGISTER           @Z40NIVS 70560042
         MVC   DECAREA(FOUR),L0(R4) MOVE NUMBER TO INTEGRAL    @Z40NIVS 70650042
         L     R5,DECAREA          GET INTO REG                @Z40NIVS 70740042
         CVD   R5,DECAREA          CONVERT TO DECIMAL          @Z40NIVS 70830042
         UNPK  ZERO(L6,R3),DECAREA+FOUR(L4) UNPACK THE COUNTER @Z40NIVS 70920042
         OI    FIVE(R3),FOXZERO    OR IN THE SIGN              @Z40NIVS 71010042
         L     R5,SAVE             RESTORE THE REGISTER        @Z40NIVS 71100042
         BR    14                  RETURN                      @Z40NIVS 71190042
CONVERT1 ST    R5,SAVE             SAVE REGISTER               @Z40NIVS 71280042
         MVC   SAVENBR+L2(L2),L0(R4) GET NUMBER TO CONVERT     @Z40NIVS 71370042
         L     R5,SAVENBR                                      @Z40NIVS 71460042
         CVD   R5,DECAREA          CONVERT THE COUNTER         @Z40NIVS 71550042
         UNPK  L0(L5,R3),DECAREA(L8) UNPACK INTO PRINT BUFFER  @XA19162 71640060
         OI    L4(R3),F0             MAKE LAST DIGIT PRINTABLE @XA19162 71730060
         L     R5,SAVE             RESTORE REGISTER            @Z40NIVS 71820042
DONOTHNG BR    R14                 RETURN                      @Z40NIVS 71910042
CONVERT2 ST    R5,SAVE             SAVE REGISTER               @Z40NIVS 72000042
         MVC   SAVENBR+L2(L2),L0(R4) GET NUMBER TO CONVERT     @Z40NIVS 72090042
         L     R5,SAVENBR                                      @Z40NIVS 72180042
         CVD   R5,DECAREA          CONVERT THE COUNTER         @Z40NIVS 72270042
         UNPK  L0(L6,R3),DECAREA(L8) UNPACK INTO PRINT BUFFER  @Z40NIVS 72360042
         OI    L5(R3),F0           MAKE LAST DIGIT PRINTABLE   @Z40NIVS 72450042
         L     R5,SAVE             RESTORE REGISTER            @Z40NIVS 72540042
         BR    R14                 RETURN                      @Z40NIVS 72630042
CONVERT3 ST    R5,SAVE             SAVE THE REGISTER           @Z40NIVS 72720042
         MVC   DECAREA(FOUR),L0(R4)   MOVE NUMBER TO INTEGRAL BOUNDARY  72810042
         L     R5,DECAREA          PUT NUMBER IN A REGISTER    @Z40NIVS 72900042
         CVD   R5,DECAREA          CONVERT COUNTER TO DECIMAL  @Z40NIVS 72990042
         UNPK  L0(L8,R3),DECAREA(L8) UNPACK THE COUNTER        @Z40NIVS 73080042
         OI    L7(R3),F0           MAKE LAST DIGIT PRINTABLE   @Z40NIVS 73170042
         L     R5,SAVE             RESTORE THE REFISTER        @Z40NIVS 73260042
         LA    R3,FOUR(R3)         INCREMENT PRINT BUFFER PTR  @Z427VLS 73350042
         BR    R14                 RETURN                      @Z40NIVS 73440042
*                                                                     * 73530042
* THIS ROUTINE WILL TAKE THE DATES FROM THE HIGH AND LOW DATE ARES    * 73620042
* AND PUT THEM INTO THE PRINT BUFFER IN UNPACKED FORMAT.              * 73710042
*                                                                     * 73800042
GETDATE  UNPK  DECAREA(L5),L1(L3,R4) UNPACK THE DATE           @Z40NIVS 73890042
         OI    DECAREA+L4,F0       MAKE LAST DIGIT PRINTABLE   @Z40NIVS 73980042
         MVC   L0(L5,R3),DECAREA   MOVE YEAR TO PRINT LINE     @Z40NIVS 74070042
         BR    R14                 RETURN                      @Z40NIVS 74160042
*                                                                     * 74250042
         SPACE 2                                               @Z40NIVS 74340042
ROUTER   STM   R5,R8,XSAVE1        SAVE REGISTERS              @Z40NIVS 74430042
         LA    R5,CALLINE-FOUR     GET DETAIL LINE AND         @Z40NIVS 74520042
         LA    R6,CALLABEL-ONE     DETAIL LABEL AND            @Z40NIVS 74700042
         STM   R5,R6,LINE          SAVE                                 74740042
         B     SKIPPRNT            RETURN WITHOUT PRINT        @Z40NIVS 74790042
CALCDEV  STM   R5,R8,XSAVE1        SAVE REGS                   @Z40NIVS 74880042
RELD8    L     R8,DEVOFFST         GET NEXT DEVICE TO PROCESS  @Z40NIVS 74970042
CHKNXTDV CLI   DEVOFFST+THREE,LSTDEV   LAST DEVICE?            @Z40NIVS 75060042
         BNL   DONE                YES, LEAVE                  @Z40NIVS 75150042
         LR    R7,R8               PUT OFFSET IN R7 ALSO       @Z40NIVS 75240042
         LA    R8,ONE(R8)          INCREMENT DEVICE PRT        @Z40NIVS 75330042
         ST    R8,DEVOFFST         SAVE IT                     @Z40NIVS 75420042
         SLL   R7,SIX              MULTIPLY BY 64              @Z40NIVS 75510042
         LA    R7,L64(R7)          ADD 64                      @Z40NIVS 75600042
         LR    R6,R4               GET BASE START IN R6        @Z40NIVS 75690042
         AR    R6,R7               ADD OFFSET TO CORRECT SET   @Z40NIVS 75780042
         CLC   FOUR(FOUR,R6),ZEROES  ANY SIOS?                 @Z40NIVS 75870042
         BE    CHKNXTDV            NO, TRY NEXT UNIT           @Z40NIVS 75960042
         B     CHKHDR              GO GET PERCENT ERRORS       @Z40NIVS 76050042
DONE     XC    DEVOFFST(FOUR),DEVOFFST RESET DEVICE OFFSET     @Z40NIVS 76140042
         MVI   FIRST,ZERO          RESET ALL SWITCHES          @Z40NIVS 76230042
         LA    R12,ONE             FAKE OUT IFCEP008           @Z40NIVS 76320042
         LA    R5,ENDLINE-FOUR     GET ENDING LINE             @Z40NIVS 76410042
         LA    R6,ENDLABEL-ONE     AND ENDING LABEL            @Z40NIVS 76500042
         STM   R5,R6,LINE          MAKE THEM CURRENT           @Z40NIVS 76590042
*        B     SKIPPRNT            RETURN                      @Z40NIVS 76680042
*                                  WITHOUT PRINT               @Z40NIVS 76770042
SKIPPRNT SR    R15,R15             CLEAR REG FOR NO PRINT      @Z40NIVS 76860042
RETURN   LM    R5,R8,XSAVE1        RESTORE THE REGS            @Z40NIVS 76950042
SKIPPER  BR    R14                 RETURN                      @Z40NIVS 77040042
         SPACE 2                                               @Z40NIVS 77130042
PRTHDR   OI    FIRST,FSTSW         SET FIRST TIME SWITCH       @Z40NIVS 77220042
         IC    R5,DEVOFFST+THREE   GET DEVICE OFFSET AND       @Z40NIVS 77310042
         BCTR  R5,ZERO             DECREMENT BY ONE SO WILL    @Z40NIVS 77400042
         STC   R5,DEVOFFST+THREE   PRINT LINE NEXT TIME        @Z40NIVS 77490042
         LA    R12,ONE             FAKE OUT IFCEP008           @Z40NIVS 77580042
         LA    R5,HDRLINE-FOUR     FOR THIS TIME MAKE THE      @Z40NIVS 77670042
         LA    R6,HDRLABEL-ONE     HEADER LINE AND LABEL       @Z40NIVS 77760042
         STM   R5,R6,LINE          CURRENT AND                 @Z40NIVS 77850042
         B     SKIPPRNT            RETURN WITHOUT PRINT        @Z40NIVS 77940042
         SPACE 2                                               @Z40NIVS 78030042
CHKHDR   TM    FIRST,FSTSW         HAS HEADER BEEN PRINTED     @Z40NIVS 78120042
         BZ    PRTHDR              NO,  GO PRINT IT            @Z40NIVS 78210042
         SPACE 2                                               @Z40NIVS 78300042
CALCPERC LA    R7,SIX              CONSTANT SIX                @Z40NIVS 78390042
         LR    R5,R3               GET PRINT POSITION          @Z40NIVS 78480042
         SR    R5,R7               BACKUP                      @Z40NIVS 78570042
         L     R7,DEVOFFST         GET DEVICE OFFSET           @Z40NIVS 78660042
         IC    R7,TABLE(R7)        GET CORRECT LAST DIGIT      @Z40NIVS 78750042
         STC   R7,ZERO(R5)         STORE INTO PRINT LINE       @Z40NIVS 78840042
         LA    R5,THREE            CONSTANT 3                  @Z40NIVS 78930042
         SR    R3,R5               BACK UP PRINT POSIT         @Z40NIVS 79020042
         MVC   ZERO(L64,R4),ZERO(R6) MOVE FOR ADDRESSABILITY   @Z40NIVS 79110042
         L     R6,SYSSIOS          GET NUJBER OF STARTIOS      @Z40NIVS 79200042
         A     R6,FOUR(R4)         ADD SIOS FOR THIS DEVICE    @Z40NIVS 79290042
         ST    R6,SYSSIOS          AND PUT INTO SUM CTR        @Z40NIVS 79380042
         L     R6,SYSRDS           GET NUMBER OF READS         @Z40NIVS 79470042
         AH    R6,ZERO(R4)         ADD TEMP RD ERRS THIS DEV   @Z40NIVS 79560042
         ST    R6,SYSRDS           PUT INTO SUM COUNTER        @Z40NIVS 79650042
         L     R6,SYSWRTS          GET NUMBER OF WRT ERRS      @Z40NIVS 79740042
         AH    R6,TWO(R4)          ADD TEMP WRT ERRS THIS DEV  @Z40NIVS 79830042
         ST    R6,SYSWRTS          PUT INTO SUM COUNTER        @Z40NIVS 79920042
         LH    R7,RDERR            GET READ ERRORS             @Z40NIVS 80010042
         L     R6,HUNDREDK         GET CONSTANT 100000         @Z40NIVS 80100042
         MR    R6,R6               MULTIBYL READS BY 100000    @Z40NIVS 80190042
         CVD   R7,DIVIDEND         CONVERT THE RESULT          @Z40NIVS 80280042
         MVC   SAVE(L4),SIOS       MOVE TO BOUNDARY            @Z40NIVS 80370042
         L     R7,SAVE             GET NUMBER OF SIOS          @Z40NIVS 80460042
         BAL   R8,PERC             GO CONVERT TO PERCENTAGE    @Z40NIVS 80550042
         LA    R3,SIX(R3)          POINT TO NEW PRINT POSITION @Z40NIVS 80640042
         LH    R7,WRTERR           GET WRITE ERRORS            @Z40NIVS 80730042
         L     R6,HUNDREDK         GET CONSTANT 100000         @Z40NIVS 80820042
         MR    R6,R6               WRITES TIMES 100000         @Z40NIVS 80910042
         CVD   R7,DIVIDEND         CONVERT THE RESULT          @Z40NIVS 81000042
         MVC   SAVE(FOUR),SIOS     MOVE TO BOUNDARY            @Z40NIVS 81090042
         L     R7,SAVE             GET NUMBER OF SIOS          @Z40NIVS 81180042
         BAL   R8,PERC             GO CONVERT TO PERCENTAGE    @Z40NIVS 81270042
         LA    R3,ONE(R3)          INCREMENT PRINT POSITION    @Z40NIVS 81360042
         B     RETURN              RETURN                      @Z40NIVS 81450042
BACK2    LA    R4,TWO              CONSTANT 2                  @Z40NIVS 81540042
         SR    R3,R4               BACKUP                      @Z40NIVS 81630042
         BR    R14                 RETURN                      @Z40NIVS 81720042
BACK3    LA    R4,THREE            CONSTANT 3                  @Z40NIVS 81810042
         SR    R3,R4               BACKUP                      @Z40NIVS 81900042
         BR    R14                 RETURN                      @Z40NIVS 81990042
BACK4    LA    R4,FOUR             CONSTANT 4                  @Z40NIVS 82080042
         SR    R3,R4               BACKUP                      @Z40NIVS 82170042
         BR    R14                 RETURN                      @Z40NIVS 82260042
BACK5    LA    R4,FIVE             CONSTANT 5                  @Z40NIVS 82350042
         SR    R3,R4               BACKUP                      @Z40NIVS 82440042
         BR    R14                 RETURN                      @Z40NIVS 82530042
AGAIN    STM   R5,R8,XSAVE1        SAVE THE REGS               @Z40NIVS 82890042
         LA    R5,CALLINE-FOUR     GET CALC LINE ADDRESS       @Z40NIVS 82980042
         LA    R6,CALLABEL-ONE     GET CALC LABEL ADDRESS      @Z40NIVS 83070042
         STM   R5,R6,LINE          MAKE THEM CURRENT           @Z40NIVS 83160042
         B     SKIPPRNT            RETURN WITHOUT PRINT        @Z40NIVS 83250042
SYSTOT   STM   R5,R8,XSAVE1        SAVE REGS                   @Z40NIVS 83340042
         L     R7,SYSRDS           GET SYSTEM READS            @Z40NIVS 83430042
         L     R6,HUNDREDK         CONSTANT 100000             @Z40NIVS 83520042
         MR    R6,R6               READS TIMES 100000          @Z40NIVS 83610042
         CVD   R7,DIVIDEND         CONVERT THE RESULT          @Z40NIVS 83700042
         L     R7,SYSSIOS          GET SUBSYSTEM SIOS          @Z40NIVS 83790042
         LTR   R7,R7               CHECK FOR ANY SIO'S         @Z40NIVS 83880042
*                                  WHICH MEANS HAVE HAD AT     @Z40NIVS 83970042
*                                  LEAST ONE RECORD            @Z40NIVS 84060042
         BZ    NOSYSTOT            NONE,  GO SET UP MESSAGE    @Z40NIVS 84150042
         BAL   R8,PERC             GO CALCULATE PERCENTAGE     @Z40NIVS 84240042
         LA    R3,SIX(R3)          POINT TO NEW PRINT POSITION @Z40NIVS 84330042
         L     R7,SYSWRTS          GET SYSTEM WRITES           @Z40NIVS 84420042
         L     R6,HUNDREDK         CONSTANT 100000             @Z40NIVS 84510042
         MR    R6,R6               WRITES TIMES 100000         @Z40NIVS 84600042
         CVD   R7,DIVIDEND         CONVERT THE RESULT          @Z40NIVS 84690042
         L     R7,SYSSIOS          GET THE DIVISOR             @Z40NIVS 84780042
         BAL   R8,PERC             GO CALCULATE PERCENTAGE     @Z40NIVS 84870042
         STM   R14,R15,SAVEPNTR    SAVE LINK REGISTERS         @Z427VLS 84876042
         LA    R3,21(R3)           BUMP PRINT REGISTER         @Z427VLS 84882042
         LA    R4,SYSSIOS          GET TOTAL SYSTEM START IOS  @Z427VLS 84888042
         BAL   R14,CONVERT3        CONVERT INTO PRINT LINE     @Z427VLS 84894042
         LA    R3,SIX(R3)          BUMP PRINT POINTER          @Z427VLS 84900042
         LA    R4,MOUNTS+L2        GET TOTAL SYSTEM DISMOUNTS  @Z427VLS 84906042
         BAL   R14,CONVERT1        CONVERT INTO PRINT LINE     @Z427VLS 84912042
         LA    R3,SEVEN(R3)        BUMP PRINT POINTER          @Z427VLS 84918042
         LA    R4,SYSRDS           GET TOTAL SYSTEM READ ERRORS         84924042
         BAL   R14,CONVERT         CONVERT INTO PRINT LINE     @Z427VLS 84930042
         LA    R3,17(R3)           BUMP PRINT POINTER          @Z427VLS 84936042
         LA    R4,SYSWRTS          GET TOTAL SYSTEM WRITE ERRORS        84942042
         BAL   R14,CONVERT         CONVERT INTO PRINT LINE     @Z427VLS 84948042
         LM    R14,R15,SAVEPNTR    RESTORE LINK REGISTERS      @Z427VLS 84954042
         XC    SYSSIOS(L16),SYSSIOS CLEAR COUNTERS             @Z427VLS 84960042
         B     RETURN              RETURN TO PRINT LINE        @Z40NIVS 85050042
NOSYSTOT LA    R5,NOTOTAL-FOUR     GET NOTOTAL LINE AND        @Z40NIVS 85140042
         LA    R6,NOTOTALA-ONE     NOTOTAL LABEL AND           @Z40NIVS 85230042
         STM   R5,R6,LINE          MAKE THEM CURRENT           @Z40NIVS 85320042
         B     SKIPPRNT            RETURN WITHOUT PRINTING     @Z40NIVS 85410042
         SPACE 2                                               @Z40NIVS 85500042
PERC     CVD   R7,DIVISOR          CONVERT TO DECIMAL          @Z40NIVS 85590042
         XC    DIVEXT(EIGHT),DIVEXT  CLEAR DIVIDEND EXTENSION  @Z40NIVS 85680042
         DP    DIVEXT(L16),DIVISOR DO THE DIVIDE               @Z40NIVS 85770042
         CLC   DIVEXT(EIGHT),THOUSX  GT 100?                   @Z40NIVS 85860042
         BNL   GT100               YES, BRANCH                 @Z40NIVS 85950042
         UNPK  DIVEXT(L3),DIVEXT+SIX(L2) UNPACK THE RESULT     @Z40NIVS 86040042
         MVC   ZERO(L2,R3),DIVEXT+ONE  MOVE TO PRINT LINE      @Z40NIVS 86130042
         OI    ONE(R3),FOXZERO     OR IN SIGN                  @Z40NIVS 86220042
         MVI   TWO(R3),DECIMAL     MOVE IN DECIMAL POINT       @Z40NIVS 86310042
         XC    DIVEXT(EIGHT),DIVEXT  CLEAR FOR NEXT CALC       @Z40NIVS 86400042
         MP    DIVEXT(L16),D100(TWO) TIMES 100                          86490042
         DP    DIVEXT(L16),DIVISOR DO THE DIVIDE               @Z40NIVS 86580042
         UNPK  DIVEXT(L3),DIVEXT+SIX(L2)                       @Z40NIVS 86670042
         MVC   THREE(L2,R3),DIVEXT+ONE  MOVE TO PRINT LINE     @Z40NIVS 86760042
         OI    FOUR(R3),FOXZERO    OR IN SIGN                  @Z40NIVS 86850042
         BR    R8                  RETURN TO CALLER            @Z40NIVS 86940042
GT100    MVC   ZERO(FOUR,R3),HUNDPLUS  INDICATE GT 100         @Z40NIVS 87030042
         BR    R8                  RETURN                      @Z40NIVS 87120042
THOUSX   DC    X'0000000000001000'                             @Z40NIVS 87210042
HUNDPLUS DC    C'100+'                                         @Z40NIVS 87300042
TEN9     DC    F'999999999'                                    @Z40NIVS 87390042
         DS    0D                                              @Z40NIVS 87480042
XSAVE    DC    3F'0'                                           @Z40NIVS 87750042
FIRST    DC    X'00'                                           @Z40NIVS 87930042
SYSSIOS  DC    F'0'                SUBSYSTEM SIOS              @Z40NIVS 88020042
SYSRDS   DC    F'0'                SUBSYSTEM READ ERRORS       @Z40NIVS 88110042
SYSWRTS  DC    F'0'                SUBSYSTEM WRITE ERRORS      @Z40NIVS 88200042
MOUNTS   DC    F'0'                                            @Z427VLS 88230042
SAVEPNTR DS    2F                                              @Z427VLS 88260042
XSAVE1   DS    4F                  REGISTER SAVE AREA          @Z40NIVS 88290042
DEVOFFST DC    F'0'                OFFSET TO NEXT DEVICE       @Z40NIVS 88380042
DIVISOR  DC    D'0'                                            @Z40NIVS 88410042
DIVEXT   DS    D                                               @Z40NIVS 88470042
DIVIDEND DC    D'0'                                            @Z40NIVS 88560042
HUNDREDK DC    F'100000'             CONSTANT 100000           @XA19162 88650060
ZEROES   DC    XL4'00000000'                                   @Z40NIVS 88740042
D100     DC    X'100C'             CONSTANT 100                @Z40NIVS 88830042
TABLE    DC    C' 0123456789ABCDEF'                            @Z40NIVS 88920042
*                                                                     * 89010042
*                                                                     * 89100042
*                                                                     * 89190042
*                                                                     * 89280042
*                                                                     * 89370042
*                                                                     * 89460042
*                                                                     * 89550042
DECAREA  DC    D'0'                                            @Z40NIVS 89640042
SAVENBR  DC    F'0'                                            @Z40NIVS 89730042
SAVE     DC    F'0'                                            @Z40NIVS 89820042
SUMEDIT  DS    0F                                              @Z40NIVS 89910042
         DC    X'00010001'                                     @Z40NIVS 90000042
         DC    X'00010001'                                     @Z40NIVS 90090042
         DC    A(LABELS)                                       @Z40NIVS 90180042
         DC    H'0'                                            @Z40NIVS 90270042
         LINE  (1,1),(40,1),SKIP=1                             @Z40NIVS 90360042
         LABEL '34XX/3803 SUBSYSTEM TEMPORARY ERROR SUMMARY'            90450042
         LINE                                                           90540042
         ROUTINE BEGIN,ROUTER                                  @Z40NIVS 90630042
         LABEL ''                                              @Z40NIVS 90720042
HDRLINE  LINE  ,(7,49)                                         @Z427VLS 90810042
HDRLABEL LABEL 'ERRORS/100K',                                  @Z40NIVSX90900042
               ' READ            WRITE        ECC'             @Z427VLS 90990042
         LINE  ,(11,45)                                        @Z40NIVS 91080042
         LABEL 'SIOS           DATE      TOTAL    TOTAL    ST',        X91170042
               'ATISTICS       STATISTICS     VRC   STRD  PAR',        X91260042
               'T  OVER  VEL   IBG'                            @Z427VLS 91350042
         LINE  ,(2,45)                                         @Z40NIVS 91440042
         LABEL 'CUA   READ  WRITE  -FROM---TO--    SIOS   MOU',        X91530042
               'NTS. ERRORS  CLNRAC . ERRORS  ERSGAP . ENV   ',        X91620042
               'CHK   RECK  RUN   CHG   DET'                   @Z427VLS 91710042
CALLINE  LINE  (5,6),(50,17),SKIP=1                            @Z427VLS 91800042
         HEX   THISCUA,,2B                                     @Z40NIVS 91890042
         ROUTINE BEGIN,CALCDEV                                 @Z40NIVS 91980042
         ROUTINE LODATE,GETDATE                                @Z40NIVS 92070042
         ROUTINE BEGIN,BACK5                                   @Z40NIVS 92160042
         ROUTINE HIDATE,GETDATE                                @Z40NIVS 92250042
         ROUTINE BEGIN,BACK5                                   @Z40NIVS 92340042
         ROUTINE SIOS,CONVERT3                                 @Z40NIVS 92430042
         ROUTINE PCCOMP,CONVERT1                               @Z427VLS 92460042
         ROUTINE BEGIN,BACK5                                   @Z427VLS 92490042
         ROUTINE RDERR,CONVERT2                                @Z40NIVS 92520042
         ROUTINE BEGIN,BACK4                                   @Z40NIVS 92610042
         ROUTINE CAS,CONVERT                                   @Z40NIVS 92700042
         ROUTINE BEGIN,BACK3                                   @Z40NIVS 92790042
         ROUTINE WRTERR,CONVERT2                               @Z40NIVS 92880042
         ROUTINE BEGIN,BACK4                                   @Z40NIVS 92970042
         ROUTINE ERGS,CONVERT                                  @Z40NIVS 93060042
         ROUTINE BEGIN,BACK3                                   @Z40NIVS 93150042
         ROUTINE ECCVRC,CONVERT1                               @Z40NIVS 93330042
         ROUTINE STRD,CONVERT1                                 @Z40NIVS 93420042
         ROUTINE PART,CONVERT1                                 @Z40NIVS 93510042
         ROUTINE OVER,CONVERT1                                 @Z40NIVS 93600042
         ROUTINE VELCH,CONVERT1                                @Z40NIVS 93690042
         ROUTINE IBG,CONVERT1                                  @Z40NIVS 93780042
CALLABEL LABEL '.','.','.'                                     @Z40NIVS 93870042
         LINE  (5,6),(45,17),SKIP=1                            @Z40NIVS 93960042
         ROUTINE BEGIN,AGAIN                                   @Z40NIVS 94050042
         LABEL ''                                              @Z40NIVS 94140042
ENDLINE  LINE  (8,6),(1,40),SKIP=1                             @Z40NIVS 94230042
         ROUTINE BEGIN,DONOTHNG                                @Z427VLS 94320042
ENDLABEL LABEL ''                                              @Z427VLS 94350042
         LINE  (8,6),(1,40),SKIP=1                             @Z427VLS 94380042
         ROUTINE BEGIN,SYSTOT                                  @Z427VLS 94410042
         LABEL 'TOTALS'                                        @Z427VLS 94440042
         DC    X'FF000000000000'                               @Z40NIVS 94500042
NOTOTAL  LINE  ,(1,60),SKIP=1                                  @Z40NIVS 94590042
NOTOTALA LABEL 'NO TEMPORARY ERRORS ENCOUNTERED'               @Z40NIVS 94680042
         DC    X'FF000000000000'                               @Z40NIVS 94770042
         DC    C'$'                                            @Z40NIVS 94860042
LABELS   EQU   *                                               @Z40NIVS 94950042
         LSTART                                                @Z40NIVS 95040042
         END                                                            95130042
