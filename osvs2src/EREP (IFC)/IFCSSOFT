         TITLE 'IFCSSOFT - SOFTWARE (ABEND) RECORD SUMMARY'             00080002
         MACRO                                                          00160002
         HEX   &LOGITEM,&SKIP$OR,&BYTES                                 00240002
.*       CONVERSIONS.                                                   00320002
.*          &LOGITEM - NAME OF DATA ITEM TO BE CONVERTED.               00400002
.*          &SKIP$OR - NUMBER OF SPACES TO SKIP ON MULTIPLE PRINT OR    00480002
.*                     NUMBER OF SPACES TO BACKUP FROM COLUM FOR START  00560002
.*                     OF PRINTING.  THE LETTER B PRECEEDS THE NUMBER   00640002
.*                     (B8) IF THE LATTER OPTION IS DESIRED.  OMISSION  00720002
.*                     OF THIS OPERAND FORCES OPTION 2 WITH BACKUP      00800002
.*                     SPACING EQUAL TO THE NUMBER OF BYTES SPECIFIED   00880002
.*                     BY THE NEXT OPERAND (TWICE THIS NUMBER IF SUFFIX 00960002
.*                     IS EXPLICITLY OR IMPLICITLY B).                  01040002
.*          &BYTES   - NUMBER OF TOTAL INPUT BYTES TO PROCESS.  THIS    01120002
.*                     NUMBER IS SUFFIXED WITH AN L, R, OR B TO         01200002
.*                     STIPULATE PRINTING OF THE LEFT HALF, RIGHT HALF  01280002
.*                     OR BOTH BALVES OF THE BYTE RESPECTIVELY.         01360002
.*                     OMISSION OF THIS OPERAND DEFAULTS TO B WITH THE  01440002
.*                     NUMBER OF BYTES EQUAL TO THE ITEM LENGTH.        01520002
.*          A NEW ENTRY IS GENERATED ONLY WHEN NECESSARY.  THIS MACRO   01600002
.*          MUST BE ISSUED FOR THE SUBJECT LINE(S).                     01680002
         GBLC  &ITEM(2600),&DSECT                                       01760002
         GBLA  &ITEMNBR,&BITS(2600),&SHIFT(2600),&NRENTS                01840002
         LCLB  &B                                                       01920002
         LCLA  &IBITS,&NDX,&ISHIFT,&K,&T,&CODE,&BYTESP                  02000002
         LCLC  &S,&LETTER                                               02080002
.LOOP    ANOP                                                           02160002
&NDX     SETA  &NDX+1                                                   02240002
         AIF   ('&ITEM(&NDX)'      EQ '&LOGITEM').FOUND                 02320002
         AIF   (&NDX               LT &ITEMNBR).LOOP                    02400002
         MNOTE *,'LOG ITEM NOT DEFINED'                                 02480002
         MEXIT                                                          02560002
.FOUND   ANOP                                                           02640002
&ISHIFT  SETA  &SHIFT(&NDX)                                             02720002
&IBITS   SETA  &BITS(&NDX)                                              02800002
&CODE    SETA  1                                                        02880002
&K       SETA  K'&BYTES                                                 02960002
         AIF   (&IBITS-(&IBITS/4)*4 EQ 0).OK                            03040002
         MNOTE *,'BIT LENGTH SPECIFICATION INCONSISTENT WITH CONTROL'   03120002
         MEXIT                                                          03200002
.OK      AIF   ('&BYTES'           EQ '').USEDEFN                       03280002
&LETTER  SETC  '&BYTES'(&K,1)                                           03360002
&S       SETC  '&BYTES'(1,&K-1)                                         03440002
&BYTESP  SETA  &S                                                       03520002
         AIF   ('&LETTER'          EQ 'B').BOTH                         03600002
         AIF   (&ISHIFT            EQ 0 OR &ISHIFT EQ 4).OK2            03680002
.ERR     MNOTE *,'DATA NOT ALLIGNED ON HEX OR BYTE BOUNDARY'            03760002
         MEXIT                                                          03840002
.USEDEFN ANOP                                                           03920002
&BYTESP  SETA  &IBITS/8                                                 04000002
.BOTH    AIF   (&ISHIFT            NE 0).ERR                            04080002
&CODE    SETA  3                                                        04160002
&T       SETA  &BYTESP*2-1                                              04240002
&S       SETC  '&T'                                                     04320002
.OK2     AIF   (&ISHIFT            EQ 0).L                              04400002
&CODE    SETA  2                                                        04480002
.L       ANOP                                                           04560002
&B       SETB  1                                                        04640002
         AIF   ('&SKIP$OR'         EQ '').BACKUP                        04720002
&K       SETA  K'&SKIP$OR                                               04800002
&B       SETB  ('&SKIP$OR'(1,1)    EQ 'B')                              04880002
&S       SETC  '&SKIP$OR'(&B+1,&K-&B)                                   04960002
.BACKUP  ANOP                                                           05040002
&NRENTS  SETA  &NRENTS+1                                                05120002
         DC    AL.12(&LOGITEM-&DSECT),XL.4'A'                           05200002
         DC    BL.1'&B',FL.7'&S',FL.4'&BYTESP',FL.4'&CODE'              05280002
.OUT     ANOP                                                           05360002
         MEND                                                           05440002
         EJECT                                                          05520002
         MACRO                                                          05600002
         SPECIAL &ROUTINE,&PARAM,&SPACE=                                05680002
.*       THIS MACRO GENERATES A SPECIAL ROUTINE ENTRY TO BE PROCESSED   05760002
.*       BY THE SUMMARY MODULE.                                         05840002
.*          &ROUTINE - SYMBOL ON SPECIAL ROUTINE EWT.                   05920002
.*          &PARAM   - AN 8 BIT BINARY REPRESENTATION TO OCCUPY THE     06000002
.*                     'MASK' FIELD BUT TO BE INTERPRETED AS AN         06080002
.*                     ARGUMENT OF THE SPECIAL ROUTINE.                 06160002
.*          &SPACE   - THE NUMBER OF 2 BYTE COUNTERS TO ALLOCATE FOR    06240002
.*                     REQUIRED PROCESSING.                             06320002
         GBLC  &CSECT                                                   06400002
         GBLA  &COUNTR                                                  06480002
         LCLA  &ADD                                                     06560002
         DC    AL1(128)                                                 06640002
         DC    BL.8'&PARAM'                                             06720002
         DC    AL2(&ROUTINE-&CSECT)                                     06800002
         DC    AL2(&COUNTR)                                             06880002
&ADD     SETA  1                                                        06960002
         AIF   ('&SPACE'           EQ '').NORM                          07040002
&ADD     SETA  &SPACE                                                   07120002
.NORM    ANOP                                                           07200002
&COUNTR  SETA  &COUNTR+&ADD                                             07280002
         MEND                                                           07360002
         EJECT                                                          07440002
         MACRO                                                          07520002
&NAME    DSGEN ,                                                        07600002
.*                            THIS MACRO GENERATES ONE DSECT WORD       07680002
.*                                 FORMATTED FOR THE SUBJECT LOG RECORD 07760002
.*                                 EACH OPERAND HAS TWO SUB LISTS. THE  07840002
.*                                 FIRST IS THE NAME OF THE LOG ITEM    07920002
.*                                 WHILE THE SECOND IS THE # OF BITS TO 08000002
.*                                 ALLOCATE FOR THIS ITEM. ITEMS MUST   08080002
.*                                 BE DEFINED CONTIGUOUSLY WITHOUT GAPS 08160002
.*                                 UNUSED BIT GROUPS MUST BE GIVEN      08240002
.*                                 DUMMY NAMES. THE NAMES PROVIDED FOR  08320002
.*                                 THE LOG ITEMS MAY THEN BE USED IN    08400002
.*                                 THE CONVERSION MACRO INSTRUCTIONS.   08480002
         GBLA  &BITS(2600),&DB,&DT,&INITIAL                             08560002
         GBLA  &ITEMITR,&ITEMFST(20),&ITEMNBR,&ITEMMDX                  08640002
         GBLA  &ITEMNDX(2600),&ITEMXPT                                  08720002
         GBLA  &LABELNR,&LASTCC,&LB,&LBLCTR(100),&LPTR,&LT              08800002
         GBLA  &NRENTS,&SHIFT(2600)                                     08880002
         GBLB  &DIAGITF,&DIAGLIN,&DIAGSET,&DIAGTST,&FSW,&TEST           08960002
         GBLC  &CARRCON,&CSECT,&DSECT,&ITEM(2600)                       09040002
         GBLC  &LABELS(2600),&LBL(100),&NRENTSX                         09120002
         LCLB  &ONLY1,&CTIND                                            09200002
         LCLA  &START1,&START2,&END1,&END2                              09280002
         LCLC  &SYMBOL,&EQUSYM                                          09360002
         LCLA  &OP,&COUNT,&BYTE,&EQUCNT                                 09440002
         ACTR  100000                                                   09520002
         AIF   (&ITEMITR EQ 0).START                                    09600002
 MNOTE   20,'DSGEN MACRO OCCURRS AFTER ITEMSORT MACRO HAS BEEN ISSUED.' 09680002
         MEXIT                                                          09760002
.START   AIF   (N'&SYSLIST(&OP+1) LT 3).LOOP                            09840002
         AIF   ('&SYSLIST(&OP+1,3)' EQ 'EQU').LOOP     TEST FOR EQU     09920002
  AIF   ('&SYSLIST(&OP+1,3)' EQ '' OR '&SYSLIST(&OP+1,4)' EQ '').ERR1   10000002
         AIF   ('&SYSLIST(&OP+1,3)' GT '&SYSLIST(&OP+1,4)').ERR3        10080002
&START1  SETA  &SYSLIST(&OP+1,3)        GET START COUNT OF 1            10160002
&START2  SETA  &SYSLIST(&OP+1,4)        GET FIRST END COUNT             10240002
         AGO   .SET2A                   BRANCH AROUND                   10320002
         AIF   ('&SYSLIST(&OP+1,5)' GT '&SYSLIST(&OP+1,6)').ERR3        10400002
.ERR1    MNOTE '**FIRST SYMBOL CONCATENATION INCOMPLETE**'              10480002
         MEXIT                                                          10560002
.SET2A   AIF   ('&SYSLIST(&OP+1,5)' EQ ''AND '&SYSLIST(&OP+1,6)' EQ '' X10640002
               ).SET2                   TEST FOR NO SECOND              10720002
  AIF   ('&SYSLIST(&OP+1,5)' EQ '' OR '&SYSLIST(&OP+1,6)' EQ '').ERR2   10800002
&END1    SETA  &SYSLIST(&OP+1,5)        GET START COUNT OF 2            10880002
&END2    SETA  &SYSLIST(&OP+1,6)        GET END COUNT OF 2              10960002
         AGO   .LOOP                                                    11040002
.SET2    ANOP                                                           11120002
&ONLY1   SETB  1                        INDICATE ONLY ONE CONCATENATION 11200002
         AGO   .LOOP                                                    11280002
.ERR2    MNOTE '**SECOND SYMBOL CONCATENATION INCOMPLETE**'             11360002
         MEXIT                                                          11440002
.ERR3    MNOTE '**START GREATER THAN END CONCATENATION**'               11520002
         MEXIT                                                          11600002
.LOOP    ANOP                                                           11680002
&OP      SETA  &OP+1                                                    11760002
         AIF   (&OP GT N'&SYSLIST).DONE      TEST IF ALL DONE           11840002
&ITEMNBR SETA  &ITEMNBR+1                                               11920002
         AIF   ('&SYSLIST(&OP,2)' NE '').OK1                            12000002
         MNOTE '**NULL BIT COUNT FIELD**'                               12080002
         MEXIT                                                          12160002
.OK1     ANOP                                                           12240002
&SYMBOL  SETC  '&SYSLIST(&OP,1)'                                        12320002
         AIF   ('&SYMBOL' NE '').OK                                     12400002
*              *****     LOG ITEM SYMBOL NOT PROVIDED     *****         12480002
         AIF   ('&SYSLIST(&OP,3)' NE 'EQU').CNT                         12560002
         AGO   .START                   GET NEXT                        12640002
.OK      AIF   (N'&SYSLIST(&OP) LT 3).NO3    TEST FOR OLD FORMAT        12720002
         AIF   ('&SYSLIST(&OP,3)' EQ 'EQU').EQU   TEST FOR EQU          12800002
         AIF   (&ONLY1).OK2             TEST FOR ONLY ONE CONCAT        12880002
&SYMBOL  SETC  '&SYMBOL.&START1.&END1'       GET 1 AND 2 CONCAT         12960002
         AGO   .NO3                     BRANCH AROUND                   13040002
.OK2     ANOP                                                           13120002
&SYMBOL  SETC  '&SYMBOL.&START1'        GET 1 CONCATENATED              13200002
.NO3     ANOP                                                           13280002
&SYMBOL  EQU   *+&BYTE                                                  13360002
&ITEM(&ITEMNBR) SETC '&SYMBOL'          GET LABEL IN GLOBAL             13440002
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2)                                    13520002
&SHIFT(&ITEMNBR) SETA &COUNT-&BYTE*8                                    13600002
.CNT     ANOP                                                           13680002
&CTIND   SETB  1                        SET COUNT INDICATOR             13760002
&COUNT   SETA  &COUNT+&SYSLIST(&OP,2)                                   13840002
&BYTE    SETA  &COUNT/8                                                 13920002
         AIF   (N'&SYSLIST(&OP) LT 3).START  TEST FOR OLD FORMAT        14000002
         AIF   (&ONLY1).TSTST           TEST FOR ONLY ONE CONCAT        14080002
         AIF   (&END1 EQ &END2).TSTST   TEST FOR SECOND END             14160002
&END1    SETA  &END1+1                  INCREMENT COUNT                 14240002
&OP      SETA  &OP-1                    DECREMENT INCREMENT             14320002
         AGO   .LOOP                    GENERATE NEXT                   14400002
.TSTST   ANOP                                                           14480002
         AIF   (&START1 EQ &START2).LPDONE   TEST FOR END               14560002
         AIF   (&ONLY1).NSET1           TEST FOR ONLY ONE CONCAT        14640002
&END1    SETA  &SYSLIST(&OP,5)          RE-INIT SECOND START COUNT      14720002
.NSET1   ANOP                                                           14800002
&OP      SETA  &OP-1                    DECREMENT INDEX                 14880002
&START1  SETA  &START1+1                INCREMENT FIRST COUNT           14960002
         AGO   .LOOP                    GO DO NEXT                      15040002
.LPDONE  ANOP                                                           15120002
&ONLY1   SETB  0                        CLEAR INDICATOR                 15200002
         AGO   .START                   GO TEST FOR MORE SUB-LISTS      15280002
.DONE    AIF   (&COUNT-&COUNT/8*8 NE 0).ERR  TEST FOR MULTIPLE OF EIGHT 15360002
         AIF   (&CTIND EQ 0).END        NO DS IF NO COUNT               15440002
&COUNT   SETA  &COUNT/8                 GET NUMBER OF BYTES             15520002
&NAME    DS    &COUNT.C                                                 15600002
.END     MEXIT                                                          15680002
.ERR     MNOTE '**BIT COUNT FLDS DO NOT TOTAL MULTIPLE OF 8**'          15760002
         MEXIT                                                          15840002
.EQU     AIF   ('&SYSLIST(&OP,4)' NE '').EQU1     TEST FOR NULL LABEL   15920002
.ERR4    MNOTE '**EQU OPERAND OMITTED OR NOT FOUND**'                   16000002
         MEXIT                                                          16080002
.EQU1    AIF   (&SYSLIST(&OP,2) LT 16).EQU2  COUNT OVER FIFTEEN         16160002
*****               THE FOLLOWING STATEMENT                *****        16240002
*****     NUMBER OF BITS EXCEED 15 - DO NOT USE AS BIN     *****        16320002
.EQU2    ANOP                                                           16400002
&EQUCNT  SETA  0                        CLEAR COUNTER                   16480002
&EQUSYM  SETC  '&SYSLIST(&OP,4)'        GET EQU OPERAND                 16560002
.EQULOP  ANOP                                                           16640002
&EQUCNT  SETA  &EQUCNT+1                INCREMENT INDEX                 16720002
         AIF   ('&ITEM(&EQUCNT)' EQ '&EQUSYM').EQUOUT  LABEL FOUND?     16800002
         AIF   (&EQUCNT EQ &ITEMNBR).ERR4    ALL TESTED?                16880002
         AGO   .EQULOP                  NO-GET NEXT                     16960002
.EQUOUT  ANOP                                                           17040002
&ITEM(&ITEMNBR) SETC '&SYMBOL'          GET LABEL NAME                  17120002
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2)    GET NUMBER OF BITS              17200002
&SHIFT(&ITEMNBR) SETA &SHIFT(&EQUCNT)   GET SHIFT COUNT                 17280002
&SYMBOL  EQU   &EQUSYM                  THIS SYMBOL EQUATED             17360002
         AGO   .START                   RETURN FOR NEXT                 17440002
         MEND                                                           17520002
         EJECT                                                          17600002
         MACRO                                                          17680002
&NAME    LINE  &DATA,&LABEL,&SKIP=                                      17760002
.*                            THIS MACRO ESTABLISHES THE MARGINS OR     17840002
.*                                 COLUMN SETTINGS FOR EACH LINE. IT    17920002
.*                                 GENERATES NECESSARY CARRIAGE CONTROL 18000002
.*                                 ENTRIES. LASTLY IT DETERMINES THE    18080002
.*                                 NUMBER OF ENTRIES ASSOCIATED WITH    18160002
.*                                 THE PREVIOUS LINE AND STORES THAT #  18240002
.*                                 INTO THE APPROPRIATE BYTE.           18320002
.*                            &DATA(1) - CHARACTER POSITION TO BEGIN    18400002
.*                                 DATA.                                18480002
.*                            &DATA(2) - # OF SPACES BETWEEN SUCCESSIVE 18560002
.*                                 DATA COLUMN STARTING CHARACTERS.     18640002
.*                            &LABEL(1) - CHAR. POS. TO BEGIN LABELS.   18720002
.*                            &LABEL(2) - # SPACES BETWEEN LINE'S LABEL 18800002
.*                                 STARTING CHARACTERS.                 18880002
.*                            &SKIP= - # OF LINES TO ADVANCE CARRIAGE   18960002
.*                                 TO BEGIN NEXT PRINTED LINE.          19040002
.*                            NEW ENTRIES ARE GENERATED ONLY WHEN       19120002
.*                                 NECESSARY. OMISSION OF ITEMS MEANS   19200002
.*                                 THEY HAVE NOT CHANGED SINCE PREVIOUS 19280002
.*                                 SETTINGS. A LINE MACRO IS REQUIRED   19360002
.*                                 FOR EACH PRINTED LINE. IF NO SETTING 19440002
.*                                 CHANGES ARE REQUIRED ALL OPERANDS    19520002
.*                                 ARE OMITTED IN WHICH CASE ONLY THE   19600002
.*                                 # OF ENTRIES FOR THE PREVIOUS LINE   19680002
.*                                 IS COMPUTED. THIS MACRO MUST BE THE  19760002
.*                                 FIRST MACRO INSTRUCTION ISSUED FOR   19840002
.*                                 THE SUBJECT LINE                     19920002
         GBLA  &BITS(2600),&DB,&DT,&INITIAL                             20000002
         GBLA  &ITEMITR,&ITEMFST(20),&ITEMNBR,&ITEMMDX                  20080002
         GBLA  &ITEMNDX(2600),&ITEMXPT                                  20160002
         GBLA  &LABELNR,&LASTCC,&LB,&LBLCTR(100),&LPTR,&LT              20240002
         GBLA  &NRENTS,&SHIFT(2600)                                     20320002
         GBLB  &DIAGITF,&DIAGLIN,&DIAGSET,&DIAGTST,&FSW,&TEST           20400002
         GBLC  &CARRCON,&CSECT,&DSECT,&ITEM(2600)                       20480002
         GBLC  &LABELS(2600),&LBL(100),&NRENTSX                         20560002
         LCLA  &S                                                       20640002
         AIF   (&INITIAL EQ 0 OR &DIAGTST EQ 0).DIAGSET                 20720002
         AIF   (&DIAGSET EQ 0).DIAGSET                                  20800002
         MNOTE '**NO LABEL ASSOCIATED WITH LAST SET**'                  20880002
***** THE FOLLOWING GENERATED FOR TEST PURPOSES *****                   20960002
*        LABEL '%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%'       21040002
               LABEL '%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%' 21120002
.DIAGSET ANOP                                                           21200002
&DIAGSET SETB  1                                                        21280002
&DIAGLIN SETB  1                                                        21360002
&NAME    DS    0C                                                       21440002
         AIF   (&INITIAL EQ 0).FIRSTLN                                  21520002
         LINEND                                                         21600002
         AGO   .NTFIRST                                                 21680002
.FIRSTLN ANOP                                                           21760002
&NRENTSX SETC  'N&SYSNDX'                                               21840002
&INITIAL SETA  1                                                        21920002
N&SYSNDX EQU   *                                                        22000002
.NTFIRST ANOP                                                           22080002
         DC    AL1(0)                                                   22160002
         AIF   ('&DATA(1)' EQ '').CKDTABS                               22240002
         AIF   (&DATA(1) EQ &DB).CKDTABS                                22320002
&DB      SETA  &DATA(1)                                                 22400002
         AGO   .AA                                                      22480002
.CKDTABS AIF   ('&DATA(2)' EQ '').NCDATA                                22560002
         AIF   (&DATA(2) EQ &DT).NCDATA                                 22640002
         AGO   .CC                                                      22720002
.AA      AIF   ('&DATA(2)' EQ '').BB                                    22800002
         AIF   (&DATA(2) EQ &DT).BB                                     22880002
.CC      ANOP                                                           22960002
&DT      SETA  &DATA(2)                                                 23040002
.BB      DC    XL2'FFFE'                                                23120002
         DC    FL1'&DB'                                                 23200002
         DC    FL1'&DT'                                                 23280002
&NRENTS  SETA  &NRENTS+1                                                23360002
.NCDATA  ANOP                                                           23440002
         AIF   ('&LABEL(1)' EQ '').CKLTABS                              23520002
         AIF   (&LABEL(1) EQ &LB).CKLTABS                               23600002
&LB      SETA  &LABEL(1)                                                23680002
         AGO   .AAA                                                     23760002
.CKLTABS AIF   ('&LABEL(2)' EQ '').NCLABEL                              23840002
         AIF   (&LABEL(2) EQ &LT).NCLABEL                               23920002
         AGO   .CCC                                                     24000002
.AAA     AIF   ('&LABEL(2)' EQ '').BBB                                  24080002
         AIF   (&LABEL(2) EQ &LT).BBB                                   24160002
.CCC     ANOP                                                           24240002
&LT      SETA  &LABEL(2)                                                24320002
.BBB     DC    XL2'FFFF'                                                24400002
         DC    FL1'&LB'                                                 24480002
         DC    FL1'&LT'                                                 24560002
&NRENTS  SETA  &NRENTS+1                                                24640002
.NCLABEL ANOP                                                           24720002
         AIF   ('&SKIP' NE '').CONT                                     24800002
         AIF   (&TEST EQ 0).NOCHANG                                     24880002
         AGO   .DEFALTA                                                 24960002
.CONT    ANOP                                                           25040002
         AIF   (&TEST EQ 0).AB                                          25120002
         AIF   ('&SKIP' EQ 'E').AB                                      25200002
&S       SETA  &SKIP                                                    25280002
.DEFAULT ANOP                                                           25360002
         AIF   (&SKIP EQ &LASTCC).DEFALTA                               25440002
         ORG   &CARRCON+3                                               25520002
         DC    AL.3(0),AL.2(&S),AL.3(1)                                 25600002
         ORG                                                            25680002
&LASTCC  SETA  &S                                                       25760002
.DEFALTA ANOP                                                           25840002
&TEST    SETB  0                                                        25920002
         AGO   .DD                                                      26000002
.AB      AIF   ('&SKIP' NE 'E').ABB                                     26080002
A&SYSNDX DC    X'FFFB8B00'              EJECT                           26160002
         AGO   .ABC                                                     26240002
.ABB     AIF   (&SKIP EQ &LASTCC).NOCHANG                               26320002
A&SYSNDX DC    XL2'FFFB'                                                26400002
         DC    AL.3(0),AL.2(&SKIP),AL.3(1)                              26480002
         DC    AL.3(0),AL.2(&SKIP),AL.3(1)                              26560002
&LASTCC  SETA  &SKIP                                                    26640002
&TEST    SETB  1                                                        26720002
.ABC     ANOP                                                           26800002
&CARRCON SETC  'A&SYSNDX'                                               26880002
&NRENTS  SETA  &NRENTS+1                                                26960002
.DD      ANOP                                                           27040002
.NOCHANG ANOP                                                           27120002
         MEND                                                           27200002
         EJECT                                                          27280002
         MACRO                                                          27360002
         LINEND ,                                                       27440002
.*                                 THIS MACRO IS USED ONLY BY THE LINE  27520002
.*                                 MACRO TO SET THE NUMBER OF ENTRIES   27600002
.*                                 ASSOCIATED WITH EACH LINE.           27680002
         GBLA  &BITS(2600),&DB,&DT,&INITIAL                             27760002
         GBLA  &ITEMITR,&ITEMFST(20),&ITEMNBR,&ITEMMDX                  27840002
         GBLA  &ITEMNDX(2600),&ITEMXPT                                  27920002
         GBLA  &LABELNR,&LASTCC,&LB,&LBLCTR(100),&LPTR,&LT              28000002
         GBLA  &NRENTS,&SHIFT(2600)                                     28080002
         GBLB  &DIAGITF,&DIAGLIN,&DIAGSET,&DIAGTST,&FSW,&TEST           28160002
         GBLC  &CARRCON,&CSECT,&DSECT,&ITEM(2600)                       28240002
         GBLC  &LABELS(2600),&LBL(100),&NRENTSX                         28320002
         ORG   &NRENTSX                                                 28400002
         DC    FL1'&NRENTS'                                             28480002
         ORG                                                            28560002
&NRENTS  SETA  0                                                        28640002
B&SYSNDX EQU   *                                                        28720002
&NRENTSX SETC  'B&SYSNDX'                                               28800002
         MEND                                                           28880002
         EJECT                                                          28960002
         MACRO                                                          29040002
&NAME    LABEL &LABEL1,&LABEL2,&LABEL3,&LABEL4,&LABEL5,&LABEL6,        C29120002
               &LABEL7,&LABEL8                                          29200002
.*                                 THIS MACRO ALLOWS LABELS TO          29280002
.*                                 BE SPECIFIED FOR A GIVEN LINE. THE   29360002
.*                                 LABELS SHOULD BE ENCLOSED IN QUOTA-  29440002
.*                                 TION MARKS. THE COLUMN AND LINE END  29520002
.*                                 CONTROLS WILL BE INSERTED BY THE     29600002
.*                                 MACRO. OMITTED OPERANDS MEAN NO      29680002
.*                                 LABEL REQUIRED FOR RESPECTIVE        29760002
.*                                 COLUMN.                              29840002
         GBLA  &BITS(2600),&DB,&DT,&INITIAL                             29920002
         GBLA  &ITEMITR,&ITEMFST(20),&ITEMNBR,&ITEMMDX                  30000002
         GBLA  &ITEMNDX(2600),&ITEMXPT                                  30080002
         GBLA  &LABELNR,&LASTCC,&LB,&LBLCTR(100),&LPTR,&LT              30160002
         GBLA  &NRENTS,&SHIFT(2600)                                     30240002
         GBLB  &DIAGITF,&DIAGLIN,&DIAGSET,&DIAGTST,&FSW,&TEST           30320002
         GBLC  &CARRCON,&CSECT,&DSECT,&ITEM(2600)                       30400002
         GBLC  &LABELS(2600),&LBL(100),&NRENTSX                         30480002
         LCLC  &MARGIN,&TACK                                            30560002
         LCLC  &TEXT                                                    30640002
         LCLA  &OP,&K,&START,&NRCHAR,&REMAIN                            30720002
         AIF   (&INITIAL EQ 0).DIAGCLR                                  30800002
         AIF   (&DIAGTST EQ 0).DIAGCLR                                  30880002
         AIF   (&DIAGLIN EQ 1).DIAGCLR                                  30960002
         MNOTE '**NO LINE ASSOCIATED WITH PREVIOUS LABEL**'             31040002
***** THE FOLLOWING GENERATED FOR TEST PURPOSES *****                   31120002
*        LINE                                                           31200002
         LINE                                                           31280002
.DIAGCLR ANOP                                                           31360002
&DIAGSET SETB  0                                                        31440002
&DIAGLIN SETB  0                                                        31520002
&MARGIN  SETC  '*'                                                      31600002
         AIF   ('&NAME' EQ '').LOOPOUT                                  31680002
&LPTR    SETA  &LPTR+1                                                  31760002
&LBL(&LPTR) SETC '&NAME'                                                31840002
&LBLCTR(&LPTR) SETA &LABELNR+1                                          31920002
.LOOPOUT ANOP                                                           32000002
&OP      SETA  &OP+1                                                    32080002
&K       SETA  K'&SYSLIST(&OP)                                          32160002
         AIF (&K GE 2).NORM                                             32240002
&K       SETA  2                                                        32320002
.NORM    ANOP                                                           32400002
&START   SETA  2                                                        32480002
         AIF (&OP LT N'&SYSLIST).NOTLAST                                32560002
&MARGIN  SETC  '$'                                                      32640002
.NOTLAST ANOP                                                           32720002
&NRCHAR  SETA  8                                                        32800002
&TACK    SETC  ''                                                       32880002
.LOOPIN  ANOP                                                           32960002
&REMAIN  SETA  &K-&START                                                33040002
         AIF (&REMAIN GE 8).MORE                                        33120002
&TACK    SETC  '&MARGIN'                                                33200002
&NRCHAR  SETA  &REMAIN                                                  33280002
.MORE    ANOP                                                           33360002
&TEXT    SETC  ''                                                       33440002
         AIF (&REMAIN EQ 0).ENDTEXT                                     33520002
&TEXT    SETC  '&SYSLIST(&OP)'(&START,&NRCHAR)                          33600002
.ENDTEXT ANOP                                                           33680002
&LABELNR SETA  &LABELNR+1                                               33760002
&LABELS(&LABELNR) SETC '&TEXT'.'&TACK'                                  33840002
&START   SETA  &START+8                                                 33920002
         AIF ('&TACK' EQ '').LOOPIN                                     34000002
         AIF ('&TACK' EQ '*').LOOPOUT                                   34080002
         MEND                                                           34160002
         EJECT                                                          34240002
         MACRO                                                          34320002
&NAME    ROUTINE &LOGITEM,&RNAME                                        34400002
         GBLA  &BITS(2600),&DB,&DT,&INITIAL                             34480002
         GBLA  &ITEMITR,&ITEMFST(20),&ITEMNBR,&ITEMMDX                  34560002
         GBLA  &ITEMNDX(2600),&ITEMXPT                                  34640002
         GBLA  &LABELNR,&LASTCC,&LB,&LBLCTR(100),&LPTR,&LT              34720002
         GBLA  &NRENTS,&SHIFT(2600)                                     34800002
         GBLB  &DIAGITF,&DIAGLIN,&DIAGSET,&DIAGTST,&FSW,&TEST           34880002
         GBLC  &CARRCON,&CSECT,&DSECT,&ITEM(2600)                       34960002
         GBLC  &LABELS(2600),&LBL(100),&NRENTSX                         35040002
         AIF   (&DIAGTST EQ 0).NOMSG                                    35120002
         AIF   (&INITIAL EQ 0).NOMSG                                    35200002
         AIF   (&DIAGLIN EQ 1).NOMSG                                    35280002
         MNOTE '**NO LINE ASSOCIATED WITH THIS ROUTINE**'               35360002
*****THE FOLLOWING GENERATED FOR TEST PURPOSES*****                     35440002
*        LINE                                                           35520002
         LINE                                                           35600002
.NOMSG   ANOP                                                           35680002
&NAME    DC    AL.12(&LOGITEM-&DSECT),XL.4'D'                           35760002
         DC    AL2(&RNAME-&CSECT)                                       35840002
&NRENTS  SETA  &NRENTS+1                                                35920002
         MEND                                                           36000002
         EJECT                                                          36080002
         MACRO                                                          36160002
         ITEMFIND &ARG,&ITFDIAG=                                        36240002
         GBLA  &BITS(2600),&DB,&DT,&INITIAL                             36320002
         GBLA  &ITEMITR,&ITEMFST(20),&ITEMNBR,&ITEMMDX                  36400002
         GBLA  &ITEMNDX(2600),&ITEMXPT                                  36480002
         GBLA  &LABELNR,&LASTCC,&LB,&LBLCTR(100),&LPTR,&LT              36560002
         GBLA  &NRENTS,&SHIFT(2600)                                     36640002
         GBLB  &DIAGITF,&DIAGLIN,&DIAGSET,&DIAGTST,&FSW,&TEST           36720002
         GBLC  &CARRCON,&CSECT,&DSECT,&ITEM(2600)                       36800002
         GBLC  &LABELS(2600),&LBL(100),&NRENTSX                         36880002
         LCLA  &A,&B,&X,&I                                              36960002
         LCLC  &C1,&C2,&S                                               37040002
         ACTR  100000                                                   37120002
&ITEMXPT SETA  0                  INDICATE ITEM NOT FOUND.              37200002
         AIF   ('&ARG' NE '').NORM                                      37280002
         AIF   ('&ITFDIAG' EQ 'OFF'  OR  '&ITFDIAG' EQ 'ON').DIAGSET    37360002
  MNOTE 0,'ITEMFIND - OPERAND (&ITFDIAG) INVALID FOR ITFDIAG KEYWORD.'  37440002
         MEXIT                                                          37520002
.DIAGSET ANOP                                                           37600002
&DIAGITF SETB  ('&ITFDIAG' EQ 'ON')                                     37680002
         MEXIT                                                          37760002
.NORM    AIF   (&ITEMITR GT 0).SORTED                                   37840002
         ITEMSORT                                                       37920002
.SORTED  ANOP                                                           38000002
&I       SETA  &ITEMITR           COMPUTED ITTERATION COUNT.            38080002
&X       SETA  &ITEMMDX           COMPUTED MAXIMUM INDEX.               38160002
&C1      SETC  '&ARG'             ISOLATE SEARCH ARGUMENT.              38240002
&C1      SETC  '&C1'.'       '(1,8-K'&C1) PAD TO FULL 8 CHARACTERS.     38320002
.SRCHUP  ANOP                                                           38400002
&A       SETA  &A+&X              CURRENT TABLE SUBSCRIPT + INDEX.      38480002
&S       SETC  '+'                                                      38560002
         AIF   (&A  GT &ITEMNBR  AND  NOT &DIAGITF).SRCHDN1             38640002
         AIF   (&A  LE &ITEMNBR).SRCH00                                 38720002
&C2      SETC  '*-OVER-*'                                               38800002
&I       SETA  &I-1               DECREMENT ITTERATION COUNTER.         38880002
&X       SETA  &X/2               HALVE INDEX VALUE.                    38960002
 MNOTE *,'&ARG - &C2   ITRCTR = &I   PTR = &A&S &X'                     39040002
         AIF   (&I GE 0).SRCHDWN  IF ITTERATION COUNT NOT EXPIRED.      39120002
.NOFIND  MNOTE  20,' ITEMFIND FAILED FOR NAME  &C1  '                   39200002
         MEXIT                                                          39280002
.SRCH00  ANOP                                                           39360002
&I       SETA  &I-1               DECREMENT ITTERATION COUNTER.         39440002
         AIF   (&I LT 0).NOFIND   IF COUNT HAS GONE TO ZERO.            39520002
&X       SETA  &X/2               HALVE INDEX VALUE.                    39600002
&B       SETA  &ITEMNDX(&A)       GET SUBSCRIPT FROM INDEX TABLE.       39680002
&C2      SETC  '&ITEM(&B)'.'       '(1,8-K'&ITEM(&B))  PAD COMPARAND.   39760002
         AIF   (NOT &DIAGITF).COMPARE                                   39840002
 MNOTE *,'&ARG - &C2   ITRCTR = &I   PTR = &A&S &X   POS = &B'          39920002
.COMPARE AIF   ('&C1' LT '&C2').SRCHDWN   ARGUMENT LOWER, MOVE DOWN.    40000002
         AIF   ('&C1' GT '&C2').SRCHUP    ARGUMENT HIGHER, MOVE UP.     40080002
&ITEMXPT SETA  &B                 FOUND. SET INDEX POINTER FOR RETURN.  40160002
&ITEMFST(&I+1)  SETA  &ITEMFST(&I+1)+1                                  40240002
         MEXIT                                                          40320002
.SRCHDWN ANOP                                                           40400002
&A       SETA  &A-&X              CURRENT POINTER MINUS INDEX VALUE.    40480002
&S       SETC  '-'                                                      40560002
         AIF   (&A LE &ITEMNBR).SRCH00    IF WITHIN BOUNDS OF TABLE.    40640002
.SRCHDN1 ANOP                                                           40720002
&I       SETA  &I-1               DECREMENT ITTERATION COUNTER.         40800002
&X       SETA  &X/2               HALVE INDEX VALUE.                    40880002
         AIF   (&I GE 0).SRCHDWN  IF ITTERATION COUNT NOT EXPIRED.      40960002
         MNOTE  20,' ITEMFIND FAILED FOR NAME  &C1  '                   41040002
         MEND                                                           41120002
         EJECT                                                          41200002
         MACRO                                                          41280002
         ITEMSORT  &DUMMY                                               41360002
         GBLA  &BITS(2600),&DB,&DT,&INITIAL                             41440002
         GBLA  &ITEMITR,&ITEMFST(20),&ITEMNBR,&ITEMMDX                  41520002
         GBLA  &ITEMNDX(2600),&ITEMXPT                                  41600002
         GBLA  &LABELNR,&LASTCC,&LB,&LBLCTR(100),&LPTR,&LT              41680002
         GBLA  &NRENTS,&SHIFT(2600)                                     41760002
         GBLB  &DIAGITF,&DIAGLIN,&DIAGSET,&DIAGTST,&FSW,&TEST           41840002
         GBLC  &CARRCON,&CSECT,&DSECT,&ITEM(2600)                       41920002
         GBLC  &LABELS(2600),&LBL(100),&NRENTSX                         42000002
         LCLA  &R,&ZI,&I,&A1,&A2,&TEMP                                  42080002
         LCLB  &SR,&GOTO,&TB                                            42160002
         LCLB  &SW(3000)                                                42240002
         LCLC  &C1,&C2                                                  42320002
         ACTR  100000                                                   42400002
&A1      SETA  0                                                        42480002
         AIF   (&ITEMITR EQ 0).LOOP0   TEST FOR RE-ENTRY.               42560002
 MNOTE   0,'ITEMSORT MACRO OCCURRS MORE THAN ONCE. TABLE NOT RESORTED.' 42640002
         MEXIT                                                          42720002
.LOOP0   ANOP                                                           42800002
&A1      SETA  &A1+1                                                    42880002
&ITEMNDX(&A1) SETA &A1                                                  42960002
         AIF   (&A1 LT &ITEMNBR).LOOP0                                  43040002
         AIF   (&ITEMNBR LT 2).MEXIT                                    43120002
&A1      SETA  &ITEMNBR/2         HALF OF TOTAL ENTRIES.                43200002
&A2      SETA  0                                                        43280002
.LOOP1   ANOP                                                           43360002
&A2      SETA  &A2+1                                                    43440002
&SW(&A2) SETB  1                  SET FIRST HALF OF SWITCHES TO 1.      43520002
         AIF   (&A2 LT &A1).LOOP1                                       43600002
.LOOP2   ANOP                                                           43680002
&A2      SETA  &A2+1                                                    43760002
&SW(&A2) SETB  0                  SET SECOND HALF TO ZERO.              43840002
         AIF   (&A2 LT &ITEMNBR).LOOP2                                  43920002
&R       SETA  0                  SET R TO FIRST TRIAL ITEM.            44000002
&ZI      SETA  &ITEMNBR-1         SET ZI TO LAST ITEM.                  44080002
&I       SETA  &ZI-1                                                    44160002
.T3      ANOP                                                           44240002
&SR      SETB  (&SW(&R+1))        GET FLAG, WHICH WAY TO GO?            44320002
&R       SETA  (&R*2)+1+&SR       R=2R+(1 OR 2)                         44400002
         AIF   (&R LE &I).T3                                            44480002
.T4      ANOP                                                           44560002
&R       SETA  (&R-1)/2           R=(R-1)/2                             44640002
&SR      SETB  (&SW(&R+1))        GET SUBTREE SELECT FLAG.              44720002
         AIF   (&SR EQ 0).T7                                            44800002
         AIF   (&GOTO EQ 0).T5                                          44880002
.T7      ANOP                                                           44960002
&A1      SETA  &ITEMNDX(&R+1)                                           45040002
&A2      SETA  &ITEMNDX(&ZI+1)                                          45120002
&C1      SETC  '&ITEM(&A1)'.'       '(1,8-K'&ITEM(&A1))                 45200002
&C2      SETC  '&ITEM(&A2)'.'       '(1,8-K'&ITEM(&A2))                 45280002
         AIF   ('&C1' LT '&C2').T8                                      45360002
.T9      ANOP                                                           45440002
&TEMP    SETA  &ITEMNDX(&R+1)     Z(R) TO TEMP.                         45520002
&TB      SETB  (&SW(&R+1))                                              45600002
&ITEMNDX(&R+1) SETA &ITEMNDX(&ZI+1)    Z(I) TO Z(R)                     45680002
&SW(&R+1) SETB (&SW(&ZI+1))                                             45760002
&ITEMNDX(&ZI+1) SETA &TEMP        TEMP TO Z(I)                          45840002
&SW(&ZI+1) SETB (&TB)                                                   45920002
&SR      SETB  (&SR EQ 0)                                               46000002
&SW(&R+1) SETB (&SR)                                                    46080002
.T8      AIF   (&R GT 0).T4                                             46160002
&GOTO    SETB  1                  SET 'GO TO' T7                        46240002
&ZI      SETA  &ZI-1                                                    46320002
&I       SETA  &I-1                                                     46400002
         AIF   (&I GE 0).T3                                             46480002
.MEXIT   ANOP                                                           46560002
&ITEMITR SETA 1                                                         46640002
&ITEMMDX SETA 1                                                         46720002
.ITRLOOP ANOP                                                           46800002
&ITEMITR SETA &ITEMITR+1                                                46880002
&ITEMMDX SETA &ITEMMDX+&ITEMMDX                                         46960002
         AIF  (&ITEMMDX LT &ITEMNBR).ITRLOOP                            47040002
&ITEMITR SETA &ITEMITR-1                                                47120002
&ITEMMDX SETA &ITEMMDX/2                                                47200002
&A1      SETA &ITEMNBR                                                  47280002
&A2      SETA &ITEMMDX                                                  47360002
&TEMP    SETA &ITEMITR                                                  47440002
 MNOTE *,' ITEMS = &A1, MAX INDEX = &A2, ITTERATION COUNT = &TEMP'      47520002
         MEXIT                                                          47600002
.T5      ANOP                                                           47680002
&TEMP    SETA  &ITEMNDX(&R+1)     Z(R) TO TEMP.                         47760002
&TB      SETB  (&SW(&R+1))                                              47840002
&ITEMNDX(&R+1) SETA &ITEMNDX(&ZI+1)    Z(I) TO Z(R)                     47920002
&SW(&R+1) SETB (&SW(&ZI+1))                                             48000002
&ITEMNDX(&ZI+1) SETA &TEMP        TEMP TO Z(I)                          48080002
&SW(&ZI+1) SETB (&TB)                                                   48160002
&SR      SETB  (&SR EQ 0)                                               48240002
&SW(&R+1) SETB (&SR)                                                    48320002
         AGO   .T3                                                      48400002
         MEND                                                           48480002
         EJECT                                                          48560002
         MACRO                                                          48640002
         LSTART ,                                                       48720002
.*                            THIS MACRO IS ISSUED WHEN THE LABEL AREA  48800002
.*                                 OF THE TABLE IS TO BEGIN.            48880002
         GBLA  &BITS(2600),&DB,&DT,&INITIAL                             48960002
         GBLA  &ITEMITR,&ITEMFST(20),&ITEMNBR,&ITEMMDX                  49040002
         GBLA  &ITEMNDX(2600),&ITEMXPT                                  49120002
         GBLA  &LABELNR,&LASTCC,&LB,&LBLCTR(100),&LPTR,&LT              49200002
         GBLA  &NRENTS,&SHIFT(2600)                                     49280002
         GBLB  &DIAGITF,&DIAGLIN,&DIAGSET,&DIAGTST,&FSW,&TEST           49360002
         GBLC  &CARRCON,&CSECT,&DSECT,&ITEM(2600)                       49440002
         GBLC  &LABELS(2600),&LBL(100),&NRENTSX                         49520002
         LCLA  &NDX,&CTR                                                49600002
         ACTR  500000                                                   49680002
         AIF   (&DIAGTST EQ 0).NODIAG                                   49760002
         AIF   (&DIAGSET EQ 0).NODIAG                                   49840002
         MNOTE '**NO LABEL ASSOCIATED WITH LAST SET**'                  49920002
***** THE FOLLOWING GENERATED FOR TEST PURPOSES *****                   50000002
*        LABEL '%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%'       50080002
               LABEL '%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%' 50160002
.NODIAG  ANOP                                                           50240002
         LINEND                                                         50320002
&CTR     SETA  1                                                        50400002
.LOOP    ANOP                                                           50480002
&NDX     SETA  &NDX+1                                                   50560002
         AIF   (&LBLCTR(&CTR) NE &NDX).NOLBL                            50640002
&LBL(&CTR) DC  C'&LABELS(&NDX)'                                         50720002
&CTR     SETA  &CTR+1                                                   50800002
         AGO   .LOOPCTL                                                 50880002
.NOLBL   ANOP                                                           50960002
         DC    C'&LABELS(&NDX)'                                         51040002
.LOOPCTL AIF   (&NDX LT &LABELNR).LOOP                                  51120002
         MEND                                                           51200002
         EJECT                                                          51280002
         MACRO                                                          51360002
         CONVT ,                                                        51440002
         GBLA  &BITS(2600),&DB,&DT,&INITIAL                             51520002
         GBLA  &ITEMITR,&ITEMFST(20),&ITEMNBR,&ITEMMDX                  51600002
         GBLA  &ITEMNDX(2600),&ITEMXPT                                  51680002
         GBLA  &LABELNR,&LASTCC,&LB,&LBLCTR(100),&LPTR,&LT              51760002
         GBLA  &NRENTS,&SHIFT(2600)                                     51840002
         GBLB  &DIAGITF,&DIAGLIN,&DIAGSET,&DIAGTST,&FSW,&TEST           51920002
         GBLC  &CARRCON,&CSECT,&DSECT,&ITEM(2600)                       52000002
         GBLC  &LABELS(2600),&LBL(100),&NRENTSX                         52080002
         LCLB  &SUB                                                     52160002
         LCLA  &OP                                                      52240002
         LCLA  &OFFSET,&OUT,&IN,&IND,&IBITS,&ISHIFT                     52320002
.*                                                                      52400002
.*       CONVERT BINARY TO DECIMAL                                      52480002
.*             &NAME IS THE REFERENCE INTO THE DSECT RECORD             52560002
.*             &OUT    IS THE NUMBER OF CHARS TO BE PUT ONTO PRINT LINE 52640002
.*                                      DEFAULT IS FOUR MAXIMUM IS 8    52720002
.*             &IN       IS THE NUMBER OF BYTES AS INPUT                52800002
.*                                      ERROR DEFAULT IS 2 MAXIMUM IS 4 52880002
.*                                                                      52960002
         AIF   (&DIAGTST EQ 0).NOMSG                                    53040002
         AIF   (&INITIAL EQ 0).NOMSG                                    53120002
         AIF   (&DIAGLIN EQ 1).NOMSG                                    53200002
         MNOTE '**NO LINE ASSOCIATED WITH THIS DATA**'                  53280002
*****THE FOLLOWING GENERATED FOR TEST PURPOSES*****                     53360002
*        LINE                                                           53440002
         LINE                                                           53520002
.NOMSG   ANOP                                                           53600002
         AIF   (K'&SYSLIST(1) EQ K'&SYSLIST(1,1)).LLOP                  53680002
&SUB     SETB  1                                                        53760002
.LLOP    ANOP                                                           53840002
&OP      SETA  &OP+1                                                    53920002
&OUT     SETA  4                        .BR NOT NULL ELSE SET TO 4      54000002
         AIF   (&SUB EQ 1).SUBA                                         54080002
         AIF   ('&SYSLIST(3)' EQ '').B  TEST FOR NULL INPUT             54160002
&OUT     SETA  &SYSLIST(3)             SET &OUT FROM INPUT              54240002
         AGO   .A                                                       54320002
.SUBA    AIF   ('&SYSLIST(&OP,3)' EQ '').B                              54400002
&OUT     SETA  &SYSLIST(&OP,3)          SET &OUT FROM INPUT             54480002
.A       AIF   (&OUT GT 0 AND &OUT LT 9).B   TEST RANGE                 54560002
.AERR    MNOTE '*** BYTES OUT INCORRECTLY SPECIFIED DEFAULT USED ***'   54640002
&OUT     SETA  4                                                        54720002
.B       AIF   (&SUB EQ 1).SUBB                                         54800002
         AIF   ('&SYSLIST(2)' EQ '').LOOP    BRANCH IF NULL             54880002
&IN      SETA  &SYSLIST(2)              .SET &IN FROM INPUT             54960002
         AGO   .BB                                                      55040002
.SUBB    AIF   ('&SYSLIST(&OP,2)' EQ '').LOOP                           55120002
&IN      SETA  &SYSLIST(&OP,2)          .SET &IN FROM INPUT             55200002
.BB      AIF   (&IN GT 0 AND &IN LT 5).D     TEST RANGE                 55280002
.BERR    MNOTE '*** BYTES IN INCORRECTLY SPECIFIED DEFAULT USED ***'    55360002
&IN      SETA  2                                                        55440002
         AGO   .D                                                       55520002
.LOOP    ANOP                           .LOOP TO FIND &NAME IN DSECT    55600002
&IND     SETA  &IND+1                   .SET UP LOOP COUNTER            55680002
         AIF   ('&ITEM(&IND)' EQ '&SYSLIST(&OP,1)').FOUND               55760002
         AIF   (&IND LT &ITEMNBR).LOOP  .TEST FOR END OF DSECT          55840002
         MNOTE '*** LOG ITEM NOT DEFINED ***'                           55920002
         MEXIT                                                          56000002
.FOUND   ANOP                                                           56080002
&IBITS   SETA  &BITS(&IND)              .SET UP NUMBER OF BITS SPEC     56160002
         AIF   (&IBITS-((&IBITS/8)*8) EQ 0).C  .TEST FOR MULTIPLE OF 8  56240002
         MNOTE '*** DATA NOT DEFINED A MULTIPLE OF 8 BITS ***'          56320002
         MEXIT                                                          56400002
.C       ANOP                                                           56480002
&IN      SETA  &IBITS/8                 .COMPUTE NUMBER OF BYTES        56560002
         AIF   (&IN LT 1 OR &IN GT 4).BERR  .TEST RANGE B IF IN ERROR   56640002
&ISHIFT  SETA  &SHIFT(&IND)             .SET UP FOR TEST OF BYTE BNDR   56720002
         AIF   (&ISHIFT EQ 0).D         .TEST FOR BYTE BNDRY            56800002
         MNOTE '*** DATA NOT ALIGNED ON A BYTE BOUNDARY ***'            56880002
         MEXIT                                                          56960002
.*                                                                      57040002
.D       ANOP                                                           57120002
&NRENTS  SETA  &NRENTS+1                                                57200002
         DC    AL.12(&SYSLIST(&OP,1)-&DSECT),AL.4(9)                    57280002
         DC    X'&IN',X'&OUT'                                           57360002
&IND     SETA  0                                                        57440002
         AIF   (&SUB EQ 0).OUTA                                         57520002
         AIF   (&OP LT N'&SYSLIST).LLOP                                 57600002
.OUTA    ANOP                                                           57680002
         MEND                                                           57760002
         EJECT                                                          57840002
         MACRO                                                          57920002
         SUM   &LOGITEM,&MASK                                           58000002
.*                            THIS MACRO GENERATES A NORMAL EDIT ENTRY  58080002
.*                                 FOR PROCESSING BY THE SUMMARY MODULE 58160002
.*                            &LOGITEM - NAME OF DATA ITEM TO BE SUMMED 58240002
.*                            &MASK - BYTE MASK FOR BITS TO BE TESTED.  58320002
.*                                 THIS OPERAND SHOULD BE OMITTED FOR   58400002
.*                                 SINGLE BIT ITEMS IN WHICH CASE THE   58480002
.*                                 MASK WILL BE SET ACCORDING TO THE    58560002
.*                                 OFF BYTE BIT DISPLACEMENT OF THE     58640002
.*                                ITEM AS DEFINED BY THE MACRO 'DSGEN'  58720002
         GBLA  &COUNTR,&ITEMNBR,&BITS(2600),&SHIFT(2600)                58800002
         GBLC  &ITEM(2600),&DSECT                                       58880002
         LCLA  &IBITS,&NDX,&ISHIFT,&M,&BITNBR                           58960002
.LOOP    ANOP                                                           59040002
&NDX     SETA  &NDX+1                                                   59120002
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      59200002
         AIF   (&NDX LT &ITEMNBR).LOOP                                  59280002
         MNOTE *,'LOGITEM NOT FOUND'                                    59360002
         MEXIT                                                          59440002
.FOUND   ANOP                                                           59520002
         DC    AL1(0)                                                   59600002
&ISHIFT  SETA  &SHIFT(&NDX)                                             59680002
&IBITS   SETA  &BITS(&NDX)                                              59760002
         AIF   ('&MASK' EQ '').FORM                                     59840002
         DC    B'&MASK'                                                 59920002
         AGO   .ITEM                                                    60000002
.FORM    ANOP                                                           60080002
&BITNBR  SETA  &ISHIFT-7                                                60160002
&BITNBR  SETA  0-&BITNBR                                                60240002
&M       SETA  1                                                        60320002
.LOOP2   ANOP                                                           60400002
         AIF   (&BITNBR EQ 0).GOTIT                                     60480002
&M       SETA  &M*2                                                     60560002
&BITNBR  SETA  &BITNBR-1                                                60640002
         AGO   .LOOP2                                                   60720002
.GOTIT   ANOP                                                           60800002
         DC    AL1(&M)                                                  60880002
.ITEM    DC    AL2(&LOGITEM-&DSECT)                                     60960002
         DC    AL2(&COUNTR)                                             61040002
&COUNTR  SETA  &COUNTR+1                                                61120002
         MEND                                                           61200002
         EJECT                                                          61280002
IFCSSOFT CSECT                                                          61360002
         GBLC  &DSECT,&CSECT                                            61440002
&CSECT   SETC  'IFCSSOFT'                                               61520002
&DSECT   SETC  'RTMREC'                                                 61600002
RTMREC   DSECT                                                          61680002
         DSGEN (CLASSRC,8),(SYSREL,8),(,48)                             61760002
         DSGEN (XDATE,32),(TIME,32)                                     61840002
         DSGEN (,8),(CPUSER,24),(CPUID,16),(,16)                        61920002
         DSGEN (JOBID,64)                                               62000002
         DSGEN (,64)                                                    62080002
         DSGEN (SDWACMKA,8),(SDWAMWPA,8),(SDWAINTA,16),(SDWAPMKA,8),   X62160002
               (SDWANXTA,24)                                            62240002
         DSGEN (SDWACMKP,8),(SDWAMWPP,8),(SDWAINTP,16),(SDWAPMKP,8),   X62320002
               (SDWANXTP,24)                                            62400002
         DSGEN (GR,32,0,15)                                             62480002
         DSGEN (SDWANAME,64)                                            62560002
         DSGEN (,32),(,32)                                              62640002
         DSGEN (SDWAEC1A,32),(SDWAEC1B,32)                              62720002
         DSGEN (,8),(SDWAILC1,8),(SDWAINC1,16),(SDWATRN1,32)            62800002
         DSGEN (SDWAEC2A,32),(SDWAEC2B,32)                              62880002
         DSGEN (,8),(SDWAILC2,8),(SDWAINC2,16),(SDWATRN2,32)            62960002
         DSGEN (GPR,32,0,15)                                            63040002
         DSGEN (SDWASPID,8),(SDWALNTH,24)                               63120002
         DSGEN (SDWASCKB,32),(SDWASCKE,32)                              63200002
         DSGEN (SDWASRVL,1),(SDWARCDF,1),(SDWATSVL,1),(SDWAINVP,1),    C63280002
               (SDWARSRC,1),(SDWARSRF,1),(,2)                           63360002
         DSGEN (SDWASKYF,1),(SDWAREGU,1),(SDWAPSWU,1),(SDWASCK,1),     C63440002
               (SDWAACR,1),(SDWAINSF,1),(SDWASOFT,1),(SDWATERR,1)       63520002
         DSGEN (SDWACPID,16),(,6),(SDWAMSER,1),(SDWACHNG,1)             63600002
         DSGEN (SDWAOFLN,1),(SDWAINTC,1),(SDWASPER,1),(SDWANUCL,1),    C63680002
               (SDWAFSQA,1),(SDWAFLSQ,1),(SDWAPGFX,1),(SDWAVEQR,1),    C63760002
               (,16)                                                    63840002
         DSGEN (SDWARFSA,32)                                            63920002
         DSGEN (DUM2,8),(SDWAYEAR,8),(SDWADAY,16),(SDWAHRS,8),         C64000002
               (SDWAMINS,8),(SDWASECS,8),(SDWATNTH,8)                   64080002
         DSGEN (SDWAMCHK,1),(SDWAPCHK,1),(SDWARKEY,1),(SDWASVCD,1),    C64160002
               (SDWAABTM,1),(SDWASVCE,1),(SDWATEXC,1),(SDWAPGIO,1)      64240002
         DSGEN (,4),(SDWATYP1,1),(SDWAENRB,1),(SDWALDIS,1),(SDWASRBM,1) 64320002
         DSGEN (SDWASTAF,1),(SDWASTAI,1),(SDWAIRB,1),(SDWAPERC,1),     C64400002
               (SDWAEAS,1),(,3)                                         64480002
         DSGEN (SDWACLUP,1),(SDWANRBE,1),(SDWASTAE,1),(SDWACTS,1),     C64560002
               (SDWAMABD,1),(SDWARPIV,1),(SDWAMCIV,1),(,1)              64640002
         DSGEN (SDWAFMID,16)                                            64720002
         DSGEN (SDWAIOQR,1),(SDWAIOHT,1),(SDWANOIO,1),(SDWANIOP,1),(,4) 64800002
         DSGEN (,104)                                                   64880002
         DSGEN (SDWARCDE,8)                                             64960002
         DSGEN (SDWARCRD,1),(,1),(SDWASPIN,1),(,1),(SDWAUPRG,1),       C65040002
               (SDWAFREE,1),(,2)                                        65120002
         DSGEN (,3),(SDWADISP,1),(SDWAASMP,1),(SDWASALL,1),            C65200002
               (SDWAIPRG,1),(SDWAICAT,1)                                65280002
         DSGEN (SDWAIUCB,1),(SDWAILCH,1),(SDWATNCB,1),                 C65360002
               (SDWATDNB,1),(SDWATADB,1),(SDWAOPTM,1),                 C65440002
               (SDWACMS,1),(SDWAFLLK,1)                                 65520002
         DSGEN (SDWAICLW,32),(SDWAIULW,32),(SDWAILLW,32),(SDWAIPLW,32),C65600002
               (SDWAAPLW,32),(SDWATNLW,32),(SDWATDLW,32),(SDWATALW,32),C65680002
               (SDWAASID,16),(DUM3,16)                                  65760002
         DSGEN (SDWAMODN,64)                                            65840002
         DSGEN (SDWACSCT,64)                                            65920002
         ORG   SDWAMODN                                                 66000002
         DSGEN (MODNCSCT,128)                                           66080002
         DSGEN (SDWAREXN,64)                                            66160002
         DSGEN (SDWADPLA,32)                                            66240002
         DSGEN (SDWADPID,8),(SDWADPT,1),(SDWADLST,1),(,4),(SDWASLST,1),C66320002
               (,1),(,16)                                               66400002
         DSGEN (SDWANUC,1),(SDWASQA,1),(SDWALSQA,1),(SDWASWA,1),       C66480002
               (SDWAGTF,1),(SDWACBS,1),(SDWAQQS,1),(,9)                 66560002
         DSGEN (SDWADSAS,1),(SDWADSAH,1),(SDWADREG,1),(SDWATLPA,1),    C66640002
               (SDWATJPA,1),(SDWADPSW,1),(SDWAUSPL,1),(,9)              66720002
         DSGEN (SDWAFRM1,32),(SDWATO1,32),(SDWAFRM2,32),(SDWATO2,32)    66800002
         DSGEN (SDWAFRM3,32),(SDWATO3,32),(SDWAFRM4,32),(SDWATO4,32)    66880002
         DSGEN (,32)                                                    66960002
         DSGEN (SDWARCPL,224)                                           67040002
         DSGEN (SDWACOMP,32),(,32)                                      67120002
         DSGEN (SDWAVRAL,16),(SDWADPVA,8),(SDWAURAL,8),(SDWAVRA,864)    67200002
         DSGEN (MRCOUNT,8,EQU,JOBID)                                    67280002
IFCSSOFT CSECT                                                          67360002
         USING *,R9                                                     67440002
         USING RTMREC,R2                                                67520002
         DC    A(ENTRIES)                                               67600002
         DC    A(PEDIT)                                                 67680002
REG8     DC    F'0'                                                     67760002
SCSIZE   DC    H'1250'                                                  67840002
R0       EQU   0                                                        67920002
R1       EQU   1                                                        68000002
R2       EQU   2                                                        68080002
R3       EQU   3                                                        68160002
R4       EQU   4                                                        68240002
R5       EQU   5                                                        68320002
R6       EQU   6                                                        68400002
R7       EQU   7                                                        68480002
R8       EQU   8                                                        68560002
R9       EQU   9                                                        68640002
R10      EQU   10                                                       68720002
R11      EQU   11                                                       68800002
R12      EQU   12                                                       68880002
R13      EQU   13                                                       68960002
R14      EQU   14                                                       69040002
R15      EQU   15                                                       69120002
ONE      EQU   1                                                        69200002
L2       EQU   2                                                        69280002
L4       EQU   4                                                        69360002
L0       EQU   0                                                        69440002
L8       EQU   8                                                        69520002
L16      EQU   16                                                       69600002
L1       EQU   1                                                        69680002
L12      EQU   12                                                       69760002
L9       EQU   9                                                        69840002
L18      EQU   18                                                       69920002
L21      EQU   21                                                       70000002
L6       EQU   6                                                        70080002
L32      EQU   32                                                       70160002
L28      EQU   28                                                       70240002
L7       EQU   7                                                        70320002
L3       EQU   3                                                        70400002
L5       EQU   5                                                        70480002
L20      EQU   20                                                       70560002
**                                                                      70640002
**       FIND THE LOW AND HIGH DATE RANGE                               70720002
**                                                                      70800002
XDATE1   CLC   XDATE(L4),HEX00     DATE SPECIFIED?                      70880002
         BER   R14                 NO, EXIT                             70960002
         CLC   L0(L4,R3),HEX00     RECORD DATE ZERO                     71040002
         BNE   XDATE2              NO, CHECK FOR LOW DATE               71120002
         MVC   L0(L4,R3),XDATE                                          71200002
XDATE2   CLC   XDATE(L4),L0(R3)    CHECK FOR LOW DATE                   71280002
         BL    SAVELOW             GO SAVE LOW DATE                     71360002
         CLC   XDATE(L4),L4(R3)    CHECK FOR HIGH DATE                  71440002
         BNHR  R14                 NO, EXIT                             71520002
         MVC   L4(L4,R3),XDATE     MOVE IN HIGH DATE                    71600002
         BR    R14                 EXIT                                 71680002
SAVELOW  MVC   L0(L4,R3),XDATE     SAVE LOW DATE                        71760002
         BR    R14                                                      71840002
**                                                                      71920002
**       SEARCH FOR ROUTINE NAME AND CSECT NAME.  IF FOUND, ADD ONE     72000002
**       TO COUNTER.  IF NOT, MAKE A NEW ENTRY AND EXIT.                72080002
**                                                                      72160002
XCSECT   STM   R5,R8,REGSAVE       SAVE REGISTERS                       72240002
         LA    R6,L2(R3)           STEP R6 TO FIRST NAME SECTION        72320002
         SR    R5,R5                                                    72400002
         ICM   R5,X'3',L0(R3)      GET THE NUMBER OF ENTRIES            72480002
         BZ    FOUNDREC            NO ENTRIES, MAKE A NEW ONE.          72560002
         LR    R8,R5               COPY OF R5 FOR LOOP                  72640002
         LR    R7,R3               GET START OF SECTION                 72720002
         AH    R7,LASTRTN          INCRMENT TO END OF NAME SECTION      72800002
         MVC   L0(L16,R7),OTHERS   MOVE IN 'OTHERS'                     72880002
         MVC   ROUTCSCT(L16),MODNCSCT SAVE ROUTINE/CSECT NAMES          72960002
FINDRTN  CLC   L0(L16,R6),ROUTCSCT IS THIS THE RIGHT ONE?               73040002
         BE    FOUNDRTN            YES, GO TOTAL                        73120002
         LA    R6,L18(R6)          NO, GO TO NEXT ONE                   73200002
         BCT   R8,FINDRTN          DECREMENT NUMBER OF ENTRIES.  IF NO  73280002
*                                  MORE, EXIT                           73360002
         C     R5,MAXREC           AT THE END OF THE TABLE?             73440002
         BNL   FOUNDRTN            YES, TOTAL IN 'OTHERS' BUCKET        73520002
FOUNDREC LA    R5,L1(R5)           INCREMENT NUMBER OF ENTRIES          73600002
         STH   R5,L0(R3)           SAVE NUMBER OF ENTRIES               73680002
         MVC   L0(L16,R6),MODNCSCT SAVE ROUTINE NAME                    73760002
FOUNDRTN LH    R7,L16(R6)          GET COUNT OF USAGE                   73840002
         LA    R7,L1(R7)           INCREMENT BY ONE                     73920002
         STH   R7,L16(R6)          SAVE COUNT USAGE                     74000002
         LM    R5,R8,REGSAVE                                            74080002
         BR    R14                                                      74160002
REGSAVE  DS    4F                                                       74240002
MAXREC   DC    F'112'                                                   74320002
LASTRTN  DC    H'2240'                                                  74400002
OTHERS   DC    CL16'OTHERS'                                             74480002
ROUTCSCT DS    16C                                                      74560002
HEX00    DC    XL4'00'                                                  74640002
         SPACE 3                                                        74720002
ENTRIES  DS    0F                                                       74800002
         SPECIAL XDATE1,00000000,SPACE=4                                74880002
         SPECIAL XCSECT,00000000,SPACE=1                                74960002
         DC    X'FF'                                                    75040002
         EJECT                                                          75120002
PEDIT    DS    0F                                                       75200002
&DSECT   SETC  'RTMYYY'                                                 75280002
&CSECT   SETC  'PEDIT'                                                  75360002
         USING *,R9                                                     75440002
         USING RTMYYY,R2                                                75520002
**                                                                      75600002
**       EDIT AND PRINT SECTION                                         75680002
**                                                                      75760002
         DC    A(PENTRY)                                                75840002
         DC    CL8'IFCSSOFT'                                            75920002
ENTRYPTR DC    F'0'                                                     76000002
LABELPTR DC    F'0'                                                     76080002
*                                                                       76160002
RTMYYY   DSECT                                                          76240002
         DS    3H                  OVERFLOW                             76320002
         DSGEN (YDUMA,16),(YNOREC,16)                                   76400002
         DSGEN (,40),(YSER,24)                                          76480002
         DSGEN (YCPU,16),(,16)                                          76560002
         DSGEN (YLOWD,32)                                               76640002
         DSGEN (YHID,32)                                                76720002
         DSGEN (YNORTN,16)                                              76800002
YROUT1   EQU   *                                                        76880002
         DSGEN (YRNAME,64)                                              76960002
         DSGEN (YRSCECT,64)                                             77040002
         DSGEN (YNUMRTN,16)                                             77120002
         DSGEN (YROUT,144,2,113)                                        77200002
*                                                                       77280002
IFCSSOFT CSECT                                                          77360002
**                                                                      77440002
**       ESTABLISH THE CPU/SERIAL NUMBER                                77520002
**                                                                      77600002
SETCPUNO STM   R5,R8,YSAVE         SAVE REGISTERS                       77680002
         XC    RTNOUT,RTNOUT        RESET # ENTRIES TO PROCESS @XA17546 77720001
         SR    R5,R5               CLEAR REG 5                          77760002
         ICM   R5,X'03',L0(R4)     LOAD THE CPU MODEL                   77840002
         BNZ   RETURNA             EXIT IF NOT ZERO                     77920002
         LA    R6,64               LOAD DISPLACEMENT                    78000002
         SR    R3,R6               FIND PLACE IN PRINT LINE             78080002
         MVC   L0(L9,R3),UNIVERS   MODEL IS UNIVERSAL                   78160002
         MVC   L32(L6,R3),NONE     SERIAL NUMBER IS NONE                78240002
RETURNA  LM    R5,R8,YSAVE         RESTORE REGISTERS                    78320002
         BR    R14                 EXIT                                 78400002
**                                                                      78480002
**       SORT THE RECORDS BY ROUTINE NAME/CSECT NAME                    78560002
**                                                                      78640002
SORT     STM   R5,R8,YSAVE         SAVE REGISTERS                       78720002
         LH    R5,YNORTN           GET NUMBER OF ENTRIES                78800002
R5SWAP   LR    R6,R5               SAVE NUMBER OF ROUTINES              78880002
         BCTR  R6,R0               DECREMENT BY 1 FOR SORT              78960002
         LTR   R6,R6               IS THERE ANY RECORDS                 79040002
         BNP   RETURNA             ZERO OR ONE RECORDS                  79120002
         LA    R7,YROUT1           GET START OF RECORDS FOR SORT        79200002
         LA    R8,YROUT2           GET START OF SECOND RECORD           79280002
R6SWAP   CLC   L0(L16,R7),L0(R8)   RECORD IN SORT ORDER?                79360002
         BNH   NEXTRTN             YES, DON'T SWAP                      79440002
         OI    SORTFLG,X'80'       INTERCHANGE DONE                     79520002
         XC    L0(L18,R7),L0(R8)   SWAP                        @XA20333 79600001
         XC    L0(L18,R8),L0(R7)   THE                         @XA20333 79680001
         XC    L0(L18,R7),L0(R8)   RECORDS                     @XA20333 79760001
NEXTRTN  LA    R7,L18(R7)          INCREMENT TO NEXT RECORD             79840002
         LA    R8,L18(R8)          INCREMENT TO NEXT RECORD             79920002
         BCT   R6,R6SWAP           CYCLE THROUGH ALL OF THE RECORDS     80000002
         TM    SORTFLG,X'80'       ANY INTERCHANGES DONE?               80080002
         BZ    RETURNA             NO, RECORDS ARE IN SORT              80160002
         NI    SORTFLG,X'00'       YES, CYCLE BACK                      80240002
         BCT   R5,R5SWAP           CYCLE THROUGH ALL OF THE RECORDS     80320002
         B     RETURNA             EXIT                                 80400002
**                                                                      80480002
**       ESTABLISH THE DATE AND YEAR TO PRINT LINE                      80560002
**                                                                      80640002
SETDATE  UNPK  WORK(L8),L0(L4,R4)  PACK DATE                            80720002
         MVC   L0(L3,R3),WORK+L5   MOVE IN DATE                         80800002
         MVC   L5(L2,R3),WORK+L3   MOVE IN YEAR                         80880002
         BR    R14                 EXIT                                 80960002
**                                                                      81040002
**       ROUTINE TO FREE THE USED SUMMARY COUNTERS                      81120002
**                                                                      81200002
THEEND   STM   R14,R12,L12(R13)    SAVE REGISTERS                       81280002
         LR    R12,R13             SAVE AREA POINTER                    81360002
         LA    R13,FSAVE           NEXT SAVE AREA                       81440002
         ST    R12,L4(R13)         POINTER                              81520002
         ST    R13,L8(R12)         POINTER                              81600002
         L     R3,L4(R2)             NEXT AREA                          81680002
         ST    R3,L28(R12)           SAVE POINTER TO AREA               81720002
         LH    R0,SIZE               SIZE OF THE AREA TO BE FREED       81760002
         LR    R1,R2               ADDRESS OF AREA                      81840002
         FREEMAIN R,LV=(0),A=(1)                                        81920002
         LTR   R3,R3               ANY MORE SUMMARY COUNTERS            82000002
         BZ    RETURNB             NO, EXIT                             82080002
         LA    R5,PENTRY+10        YES, CYCLE FOR NEXT SET              82160002
         LA    R6,LABELS-L1        LABELS FOR NEXT SET                  82240002
         STM   R5,R6,ENTRYPTR      STORE FOR LOOP BACK                  82320002
RETURNB  L     R13,L4(R13)         RETORE SAVE AREA ADDRESS             82400002
         LM    R14,R12,L12(R13)    RESTORE REGISTERS                    82480002
         BR    R14                 EXIT                                 82560002
**                                                                      82640002
**       ROUTINE TO MOVE NAMES TO PRINT LINE                            82720002
**                                                                      82800002
PRTRTN   STM   R5,R8,YSAVE         SAVE REGISTERS                       82880002
         SR    R5,R5               CLEAR REGISTER                       82960002
         ICM   R5,X'3',YNORTN      GET NUMBER OF ROUTINES               83040002
         BZ    RETURNA             NO MORE, EXIT                        83120002
         SR    R6,R6               CLEAR REGISTER                       83200002
         LH    R6,RTNOUT           LOAD NUMBER OF THE ENTRY TO PROCESS  83280002
         MH    R6,DEC18            DETERMINE DISPLACEMENT               83360002
         LA    R7,YROUT1           START ADDRESS                        83440002
         AR    R6,R7               SET OF ROUTINE NAME/CSECT DESIRED    83520002
         MVC   L0(L8,R3),L0(R6)    MOVE ROUTINE NAME TO PRT LINE        83600002
         MVC   L9(L8,R3),L8(R6)    MOVE CSECT NAME TO PRT LINE          83680002
         SR    R7,R7               CLEAR REGISTER                       83760002
         LH    R7,L16(R6)          USAGE VALUE                          83840002
         CVD   R7,WORK             CONVERT TO DECIMAL                   83920002
         UNPK  L18(L3,R3),WORK+L6(L2) UNPACK VALUE                      84000002
         MVZ   L20(L1,R3),L18(R3)  ESTABLISH ZONE                       84080002
         SR    R6,R6               CLEAR REGISTER                       84160002
         LH    R6,RTNOUT           LOAD NUMBER OF THE ENTRY TO PROCESS  84240002
         LA    R6,L1(R6)           INCREMENT ENTRY NUMBER               84320002
         STH   R6,RTNOUT           STORE FOR NEXT ENTRY                 84400002
         BCTR  R5,R0               DECREMENT NUMBER TO PROCESS          84480002
         STH   R5,YNORTN           STORE VALUE                          84560002
         B     RETURNA             EXIT                                 84640002
**                                                                      84720002
**       CYCLE BACK ROUTINE FOR NEXT ROUTINE NAME                       84800002
**                                                                      84880002
GOBACK   STM   R5,R8,YSAVE         SAVE REGISTERS                       84960002
         SR    R5,R5               CLEAR REGISTER                       85040002
         ICM   R5,X'3',YNORTN      GET NUMBER OF ROUTINES TO PROCESS    85120002
         BZ    RETURNA             NO MORE,EXIT                         85200002
         LA    R5,PRTLINE-L4       MORE,CHANGE NEXT LINE TO PROCESS     85280002
         LA    R6,PRTLABEL-L1      CHANGE NEXT LABEL TO PROCESS         85360002
         STM   R5,R6,ENTRYPTR      STORE FOR CYCLE BACK                 85440002
         B     RETURNA             EXIT                                 85520002
**                                                                      85600002
WORK     DS    0D                                                       85680002
FSAVE    DS    18F                                                      85760002
YSAVE    EQU   FSAVE                                                    85840002
SIZE     DC    H'2302'                                                  85920002
RTNOUT   DC    H'0'                                                     86000002
DEC18    DC    H'18'                                                    86080002
SORTFLG  DC    X'00'                                                    86160002
UNIVERS  DC    C'UNIVERSAL'                                             86240002
NONE     DC    C'NONE'                                                  86320002
         EJECT                                                          86400002
PENTRY   DS    0F                                                       86480002
         DC    X'00010001'                                              86560002
         DC    X'00010001'                                              86640002
         DC    A(LABELS)                                                86720002
         DC    H'0'                                                     86800002
         DC    X'01'                                                    86880002
         DC    X'000B8B00'         SKIP TO CHANNEL 1                    86960002
         LABEL                                                          87040002
         LINE  (1,1),(1,1),SKIP=2                                       87120002
         LABEL ' '                                                      87200002
         LINE  (57,32),(23,26)                                          87280002
         HEX   YCPU,0,2B                                                87360002
         HEX   YSER,0,3B                                                87440002
         ROUTINE YCPU,SETCPUNO                                          87520002
         LABEL 'DAY YEAR   DAY YEAR','MODEL-','SERIAL NO.'              87600002
         LINE  (23,11),(1,30)                                           87680002
         ROUTINE YLOWD,SETDATE                                          87760002
         ROUTINE YHID,SETDATE                                           87840002
         LABEL 'SOFTWARE DATE RANGE -','TO'                             87920002
         LINE  ,(1,1),SKIP=1                                            88000002
         LABEL ' '                                                      88080002
         LINE  ,(40,1),SKIP=1                                           88160002
         LABEL 'SUMMARY OF SOFTWARE ENVIRONMENT RECORDS'                88240002
         LINE  (29,),(1,1),SKIP=2                                       88320002
         CONVT YNOREC,2,4                                               88400002
         LABEL 'TOTAL NUMBER OF RECORDS'                                88480002
         LINE                                                           88560002
         LABEL ' '                                                      88640002
         LINE  ,(3,25),SKIP=1                                           88720002
         ROUTINE YNORTN,SORT                                            88800002
         LABEL 'ROUTINE  CSECT  NUMBER','ROUTINE  CSECT  NUMBER','ROUTI*88880002
               NE  CSECT  NUMBER','ROUTINE  CSECT  NUMBER'              88960002
         LINE  ,,SKIP=1                                                 89040002
         LABEL ' NAME    NAME  ENTRIES',' NAME    NAME  ENTRIES',' NAME*89120002
                   NAME  ENTRIES',' NAME    NAME  ENTRIES'              89200002
         LINE  ,,SKIP=1                                                 89280002
         LABEL ' '                                                      89360002
PRTLINE  LINE  (3,25),(1,1)                                             89440002
         ROUTINE YNORTN,PRTRTN                                          89520002
         ROUTINE YNORTN,PRTRTN                                          89600002
         ROUTINE YNORTN,PRTRTN                                          89680002
         ROUTINE YNORTN,PRTRTN                                          89760002
         ROUTINE YNORTN,GOBACK                                          89840002
PRTLABEL LABEL ' '                                                      89920002
         LINE  ,,SKIP=1                                                 90000002
         ROUTINE YDUMA,THEEND                                           90080002
         LABEL ' '                                                      90160002
         DC    X'FF'                                                    90240002
         DC    X'0000'                                                  90320002
         DC    X'0000'                                                  90400002
         DC    X'0000'                                                  90480002
         DC    C'$'                                                     90560002
LABELS   EQU   *                                                        90640002
         LSTART                                                         90720002
         END                                                            90800002
