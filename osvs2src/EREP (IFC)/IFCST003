         TITLE 'IFCST003  3270 REMOTE BUFFER LOG SUMMARY'               00100042
         SPACE 2                                                        00200042
*  LINE MACRO     LINE MACRO     LINE MACRO     LINE MACRO            * 00300042
         MACRO                                                          00400042
&NAME    LINE  &DATA,&LABEL,&SKIP=                                      00500042
.*                            THIS MACRO ESTABLISHES THE MARGINS OR     00600042
.*                                 COLUMN SETTINGS FOR EACH LINE. IT    00700042
.*                                 GENERATES NECESSARY CARRIAGE CONTROL 00800042
.*                                 ENTRIES. LASTLY IT DETERMINES THE    00900042
.*                                 NUMBER OF ENTRIES ASSOCIATED WITH    01000042
.*                                 THE PREVIOUS LINE AND STORES THAT #  01100042
.*                                 INTO THE APPROPRIATE BYTE.           01200042
.*                                 &DATA(1) - CHARACTER POSITION TO     01300042
.*                                 BEGIN DATA.                          01400042
.*                                                                      01500042
.*                                 &DATA(2) - # OF SPACES BETWEEN       01600042
.*                                 SUCCESSIVE DATA COLUMN STARTING      01700042
.*                                 CHARACTERS.                          01800042
.*                                                                      01900042
.*                                 &LABEL(1) - CHARACTER POSITION       02000042
.*                                 TO BEGIN LABELS.                     02100042
.*                                                                      02200042
.*                                 &LABEL(2) - # OF SPACES BETWEEN      02300042
.*                                 LINE'S LABEL STARTING CHARACTERS.    02400042
.*                                                                      02500042
.*                                 &SKIP= - # OF LINES TO ADVANCE       02600042
.*                                 CARRIAGE TO BEGIN NEXT PRINTED LINE. 02700042
.*                                                                      02800042
.*                                 NEW ENTRIES ARE GENERATED ONLY WHEN  02900042
.*                                 NECESSARY. OMISSION OF ITEMS MEANS   03000042
.*                                 THEY HAVE NOT CHANGED SINCE PREVIOUS 03100042
.*                                 SETTINGS. A LINE MACRO IS REQUIRED   03200042
.*                                 FOR EACH PRINTED LINE. IF NO SETTING 03300042
.*                                 CHANGES ARE REQUIRED ALL OPERANDS    03400042
.*                                 ARE OMITTED IN WHICH CASE ONLY THE   03500042
.*                                 # OF ENTRIES FOR THE PREVIOUS LINE   03600042
.*                                 FIRST MACRO INSTRUCTION ISSUED FOR   03700042
.*                                 THE SUBJECT LINE.                    03800042
         GBLA  &DB,&DT,&LB,&LT,&NRENTS                                  03900042
         GBLA  &LASTCC,&INITIAL                                         04000042
         GBLC  &NRENTSX                                                 04100042
         GBLC  &CARRCON                                                 04200042
         GBLB  &TEST                                                    04300042
         LCLA  &S                                                       04400042
&NAME    DS    0C                                                       04500042
         AIF   (&INITIAL EQ 0).FIRSTLN                                  04600042
         LINEND                                                         04700042
         AGO   .NTFIRST                                                 04800042
.FIRSTLN ANOP                                                           04900042
&NRENTSX SETC  'N&SYSNDX'                                               05000042
&INITIAL SETA  1                                                        05100042
&LASTCC  SETA  1                                                        05200042
N&SYSNDX EQU   *                                                        05300042
.NTFIRST ANOP                                                           05400042
         DC    AL1(0)                                                   05500042
         AIF   ('&DATA(1)' EQ '').CKDTABS                               05600042
         AIF   ('&DATA'(1,1) NE '(').SLABEL                             05700042
         AIF   (&DATA(1) EQ &DB).CKDTABS                                05800042
&DB      SETA  &DATA(1)                                                 05900042
         AGO   .AA                                                      06000042
.CKDTABS AIF   ('&DATA(2)' EQ '').NCDATA                                06100042
         AIF   (&DATA(2) EQ &DT).NCDATA                                 06200042
         AGO   .CC                                                      06300042
.AA      AIF   ('&DATA(2)' EQ '').BB                                    06400042
         AIF   (&DATA(2) EQ &DT).BB                                     06500042
.CC      ANOP                                                           06600042
&DT      SETA  &DATA(2)                                                 06700042
.BB      DC    XL2'FFFE'                                                06800042
         DC    FL1'&DB'                                                 06900042
         DC    FL1'&DT'                                                 07000042
&NRENTS  SETA  &NRENTS+1                                                07100042
.NCDATA  ANOP                                                           07200042
         AIF   ('&LABEL(1)' EQ '').CKLTABS                              07300042
         AIF   ('&LABEL'(1,1) NE '(').SLABEL                            07400042
         AIF   (&LABEL(1) EQ &LB).CKLTABS                               07500042
&LB      SETA  &LABEL(1)                                                07600042
         AGO   .AAA                                                     07700042
.CKLTABS AIF   ('&LABEL(2)' EQ '').NCLABEL                              07800042
         AIF   (&LABEL(2) EQ &LT).NCLABEL                               07900042
         AGO   .CCC                                                     08000042
.AAA     AIF   ('&LABEL(2)' EQ '').BBB                                  08100042
         AIF   (&LABEL(2) EQ &LT).BBB                                   08200042
.CCC     ANOP                                                           08300042
&LT      SETA  &LABEL(2)                                                08400042
.BBB     DC    XL2'FFFF'                                                08500042
         DC    FL1'&LB'                                                 08600042
         DC    FL1'&LT'                                                 08700042
&NRENTS  SETA  &NRENTS+1                                                08800042
.NCLABEL ANOP                                                           08900042
         AIF   ('&SKIP' EQ 'E').EJECT                                   09000042
         AIF   ('&SKIP' EQ '').TESTOFF                                  09100042
.CONT    ANOP                                                           09200042
         AIF   (&TEST EQ 0).AB                                          09300042
         AIF   (&SKIP EQ &LASTCC).TESTOFF                               09400042
&S       SETA  &SKIP                                                    09500042
         ORG   &CARRCON+3                                               09600042
         DC    AL.3(0),AL.2(&S),AL.3(1)                                 09700042
         ORG                                                            09800042
&LASTCC  SETA  &S                                                       09900042
.SLABEL  ANOP                                                           10000042
.TESTOFF ANOP                                                           10100042
&TEST    SETB  0                                                        10200042
         AGO   .DD                                                      10300042
.EJECT   DC    XL2'FFFB'                                                10400042
&NRENTS  SETA  &NRENTS+1                                                10500042
         DC    X'8B'              SKIP TO CHANNEL 1                     10600042
         DC    AL.3(0),AL.2(&LASTCC),AL.3(1)                            10700042
&TEST    SETB  1                                                        10800042
         AGO   .DD                                                      10900042
.AB      AIF   (&SKIP EQ &LASTCC).NOCHANG                               11000042
A&SYSNDX DC    XL2'FFFB'                                                11100042
         DC    AL.3(0),AL.2(&SKIP),AL.3(1)                              11200042
         DC    AL.3(0),AL.2(&SKIP),AL.3(1)                              11300042
&LASTCC  SETA  &SKIP                                                    11400042
&TEST    SETB  1                                                        11500042
&CARRCON SETC  'A&SYSNDX'                                               11600042
&NRENTS  SETA  &NRENTS+1                                                11700042
.DD      ANOP                                                           11800042
.NOCHANG ANOP                                                           11900042
         MEND                                                           12000042
         EJECT                                                          12100042
         SPACE 2                                                        12200042
*  ROUTINE MACRO     ROUTINE MACRO     ROUTINE MACRO     ROUTINE MACRO* 12300042
         MACRO                                                          12400042
&NAME    ROUTINE &LOGITEM,&RNAME                                        12500042
         GBLC  &DSECT,&CSECT                                            12600042
         GBLC  &ITEM(1000)                                              12700042
         GBLA  &SHIFT(1000),&ITEMNBR                                    12800042
         GBLA  &NRENTS                                                  12900042
         LCLA  &ISHIFT,&NDX                                             13000042
.LOOP    ANOP                                                           13100042
&NDX     SETA  &NDX+1                                                   13200042
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      13300042
         AIF   (&NDX LT &ITEMNBR).LOOP                                  13400042
         MNOTE *,'LOG ITEM NOT DEFINED'                                 13500042
         MEXIT                                                          13600042
.FOUND   ANOP                                                           13700042
&ISHIFT  SETA  &SHIFT(&NDX)                                             13800042
&NAME    DC    AL.12(&LOGITEM-&DSECT),XL.4'D'                           13900042
         DC    AL.4(&ISHIFT),AL.12(&RNAME-&CSECT)                       14000042
&NRENTS  SETA  &NRENTS+1                                                14100042
         MEND                                                           14200042
*  DSGEN MACRO     DSGEN MACRO     DSGEN MACRO     DSGEN MACRO        * 14300042
         SPACE 2                                                        14400042
         MACRO                                                          14500042
&NAME    DSGEN &X1,&X2,&X3,&X4,&X5,&X6,&X7,&X8,&X9,&X10,&X11,&X12,&X13,X14600042
               &X14,&X15,&X16,&X17,&X18,&X19,&X20,&X21,&X22,&X23,&X24, X14700042
               &X25,&X26,&X27,&X28,&X29,&X30,&X31,&X32                  14800042
.*                            THIS MACRO GENERATES ONE DSECT WORD       14900042
.*                                 FORMATTED FOR THE SUBJECT LOG RECORD 15000042
.*                                 EACH OPERAND HAS TWO SUB LISTS. THE  15100042
.*                                 FIRST IS THE NAME OF THE LOG ITEM    15200042
.*                                 WHILE THE SECOND IS THE # OF BITS TO 15300042
.*                                 ALLOCATE FOR THIS ITEM. ITEMS MUST   15400042
.*                                 BE DEFINED CONTIGUOUSLY WITHOUT GAPS 15500042
.*                                 UNUSED BIT GROUPS MUST BE GIVEN      15600042
.*                                 DUMMY NAMES. THE NAMES PROVIDED FOR  15700042
.*                                 THE LOG ITEMS MAY THEN BE USED IN    15800042
.*                                 THE CONVERSION MACRO INSTRUCTIONS.   15900042
         GBLC &ITEM(1000)                                               16000042
         GBLA &ITEMNBR,&BITS(1000),&SHIFT(1000)                         16100042
         LCLC  &SYMBOL                                                  16200042
         LCLA  &OP,&COUNT,&BYTE                                         16300042
.LOOP    ANOP                                                           16400042
&OP      SETA  &OP+1                                                    16500042
&ITEMNBR SETA  &ITEMNBR+1                                               16600042
&SYMBOL  SETC  '&SYSLIST(&OP,1)'                                        16700042
         AIF   ('&SYSLIST(&OP,2)' NE '').OK1                            16800042
         MNOTE *,'NULL BIT COUNT FIELD'                                 16900042
         MEXIT                                                          17000042
.OK1     ANOP                                                           17100042
         AIF   ('&SYMBOL' NE '').OK                                     17200042
         MNOTE 'LOG ITEM SYMBOL NOT PROVIDED'                           17300042
         AGO   .CNT                                                     17400042
.OK      ANOP                                                           17500042
         AIF   ('&SYMBOL'(1,1) EQ '''').CNT                *TEMP*       17600042
&SYMBOL  EQU   *+&BYTE                                                  17700042
&ITEM(&ITEMNBR)  SETC '&SYSLIST(&OP,1)'                                 17800042
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2)                                    17900042
&SHIFT(&ITEMNBR) SETA &COUNT-&BYTE*8                                    18000042
.CNT     ANOP                                                           18100042
&COUNT   SETA  &COUNT+&SYSLIST(&OP,2)                                   18200042
&BYTE    SETA  &COUNT/8                                                 18300042
         AIF (&OP LT N'&SYSLIST).LOOP                                   18400042
         AIF   (&COUNT NE 32).NOT32                                     18500042
&NAME    DS    4C                                                       18600042
         MEXIT                                                          18700042
.NOT32   AIF   (&COUNT NE 64).ERR                                       18800042
&NAME    DS    8C                                                       18900042
         MEXIT                                                          19000042
.ERR     MNOTE '**BIT COUNT FIELDS DO NOT TOTAL 32 OR 64**'             19100042
         MEND                                                           19200042
         MACRO                                                          19300042
         LINEND                                                         19400042
.*                            THIS MACRO IS USED ONLY BY THE LINE       19500042
.*                                 MACRO TO SET THE NUMBER OF ENTRIES   19600042
.*                                 ASSOCIATED WITH EACH LINE.           19700042
         GBLA  &NRENTS                                                  19800042
         GBLC &NRENTSX                                                  19900042
         ORG   &NRENTSX                                                 20000042
         DC    FL1'&NRENTS'                                             20100042
         ORG                                                            20200042
&NRENTS  SETA  0                                                        20300042
B&SYSNDX EQU   *                                                        20400042
&NRENTSX SETC  'B&SYSNDX'                                               20500042
         MEND                                                           20600042
         SPACE 2                                                        20700042
         EJECT                                                          20800042
*  LABEL MACRO     LABEL MACRO     LABEL MACRO     LABEL MACRO        * 20900042
         SPACE 2                                                        21000042
         MACRO                                                          21100042
&NAME    LABEL &LABEL1,&LABEL2,&LABEL3,&LABEL4,&LABEL5,&LABEL6,        C21200042
               &LABEL7,&LABEL8                                          21300042
.*                            THIS MACRO ALLOWS UP TO ACHT LABELS TO    21400042
.*                                 BE SPECIFIED FOR A GIVEN LINE. THE   21500042
.*                                 LABELS SHOULD BE ENCLOSED IN QUOTA-  21600042
.*                                 TION MARKS. THE COLUMN AND LINE END  21700042
.*                                 CONTROLS WILL BE INSERTED BY THE     21800042
.*                                 MACRO. OMITTED OPERANDS MEAN NO      21900042
.*                                 LABEL REQUIRED FOR RESPECTIVE        22000042
.*                                 COLUMN. THIS MACRO WILL ALSO ALERT   22100042
.*                                 THE PROGRAMMER TO EXACTLY WHERE THE  22200042
.*                                 TABLE MUST BE BROKEN IF NECESSARY    22300042
.*                                 TO AVOID EXCEEDING THE MAXIMUM LIMIT 22400042
         GBLC &LABELS(2000)                                             22500042
         GBLC  &LBL(100)                                                22600042
         GBLA  &LBLCTR(100)                                             22700042
         GBLA  &LABELNR                                                 22800042
         GBLA  &NRENTS,&LPTR                                            22900042
         LCLC  &MARGIN,&TACK                                            23000042
         LCLC  &TEXT                                                    23100042
         LCLA  &OP,&K,&START,&NRCHAR,&REMAIN                            23200042
&MARGIN  SETC  '*'                                                      23300042
         AIF   ('&NAME' EQ '').LOOPOUT                                  23400042
&LPTR    SETA  &LPTR+1                                                  23500042
&LBL(&LPTR) SETC '&NAME'                                                23600042
&LBLCTR(&LPTR) SETA &LABELNR+1                                          23700042
.LOOPOUT ANOP                                                           23800042
&OP      SETA  &OP+1                                                    23900042
&K       SETA  K'&SYSLIST(&OP)                                          24000042
         AIF (&K GE 2).NORM                                             24100042
&K       SETA  2                                                        24200042
.NORM    ANOP                                                           24300042
&START   SETA  2                                                        24400042
         AIF (&OP LT N'&SYSLIST).NOTLAST                                24500042
&MARGIN  SETC  '$'                                                      24600042
.NOTLAST ANOP                                                           24700042
&NRCHAR  SETA  8                                                        24800042
&TACK    SETC  ''                                                       24900042
.LOOPIN  ANOP                                                           25000042
&REMAIN  SETA  &K-&START                                                25100042
         AIF (&REMAIN GE 8).MORE                                        25200042
&TACK    SETC  '&MARGIN'                                                25300042
&NRCHAR  SETA  &REMAIN                                                  25400042
.MORE    ANOP                                                           25500042
&TEXT    SETC  ''                                                       25600042
         AIF (&REMAIN EQ 0).ENDTEXT                                     25700042
&TEXT    SETC  '&SYSLIST(&OP)'(&START,&NRCHAR)                          25800042
.ENDTEXT ANOP                                                           25900042
&LABELNR SETA  &LABELNR+1                                               26000042
&LABELS(&LABELNR) SETC '&TEXT'.'&TACK'                                  26100042
&START   SETA  &START+8                                                 26200042
         AIF ('&TACK' EQ '').LOOPIN                                     26300042
         AIF ('&TACK' EQ '*').LOOPOUT                                   26400042
         MEND                                                           26500042
         SPACE 2                                                        26600042
         MACRO                                                          26700042
         LSTART                                                         26800042
.*                            THIS MACRO IS ISSUED WHEN THE LABEL AREA  26900042
.*                                 OF THE TABLE IS TO BEGIN.            27000042
         GBLC &LABELS(2000)                                             27100042
         GBLA  &LABELNR                                                 27200042
         GBLC  &LBL(100)                                                27300042
         GBLA  &LBLCTR(100)                                             27400042
         LCLA  &NDX,&CTR                                                27500042
         LINEND                                                         27600042
&CTR     SETA  1                                                        27700042
.LOOP    ANOP                                                           27800042
&NDX     SETA  &NDX+1                                                   27900042
         AIF   (&LBLCTR(&CTR) NE &NDX).NOLBL                            28000042
&LBL(&CTR) DC  C'&LABELS(&NDX)'                                         28100042
&CTR     SETA  &CTR+1                                                   28200042
         AGO   .LOOPCTL                                                 28300042
.NOLBL   ANOP                                                           28400042
         DC    C'&LABELS(&NDX)'                                         28500042
.LOOPCTL AIF   (&NDX LT &LABELNR).LOOP                                  28600042
         MEND                                                           28700042
         SPACE 2                                                        28800042
*  BIN MACRO     BIN MACRO     BIN MACRO     BIN MACRO     BIN MACRO  * 28900042
         SPACE 2                                                        29000042
         MACRO                                                          29100042
         BIN   &LOGITEM,&SKIP$OR                                        29200042
.*                                 &LOGITEM - NAME OF ITEM IN LOG       29300042
.*                                      RECORD DSECT                    29400042
.*                                 &SKIP$OR - NBR OF SPACES TO SKIP ON  29500042
.*                                 MULTIPLE PRINT OR NBR OF SPACES      29600042
.*                                      TO BACK UP FROM COLUMN FOR      29700042
.*                                      START OF PRINTING. THE LETTER   29800042
.*                                      B PRECEEDS THE NUMBER (B5) IF   29900042
.*                                      THE LATTER IS DESIRED. OMISSION 30000042
.*                                      OF THIS OPERAND FORCES OPTION 2 30100042
.*                                      WITH BACKUP SPACING EQUAL TO    30200042
.*                                 THE NUMBER OF BITS IN THE ITEM       30300042
.*                                 DEFINITION (VIA MACRO 'DSGEN').      30400042
.*                            A LIMIT OF 15 BITS IS IMPOSED FOR THE     30500042
.*                                 TOTAL NUMBER OF BITS TO PRINT.       30600042
         GBLC &ITEM(1000)                                               30700042
         GBLA &ITEMNBR,&BITS(1000),&SHIFT(1000),&NRENTS                 30800042
         GBLC  &DSECT                                                   30900042
         LCLB  &B                                                       31000042
         LCLA  &IBITS,&NDX,&ISHIFT,&K                                   31100042
         LCLA  &TEMP,&T                                                 31200042
         LCLC  &S                                                       31300042
.LOOP    ANOP                                                           31400042
&NDX     SETA  &NDX+1                                                   31500042
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      31600042
         AIF   (&NDX LT &ITEMNBR).LOOP                                  31700042
         MNOTE *,'YOU BLEW IT'                                          31800042
         ROUTINE DUM,SKIPPER                                            31900042
         MEXIT                                                          32000042
.FOUND   ANOP                                                           32100042
&ISHIFT  SETA  &SHIFT(&NDX)                                             32200042
&IBITS   SETA  &BITS(&NDX)                                              32300042
&T       SETA  &IBITS-1                                                 32400042
&B       SETB  0                                                        32500042
         AIF   ('&SKIP$OR' EQ '').BACKUP                                32600042
&K       SETA  K'&SKIP$OR                                               32700042
&B       SETB  ('&SKIP$OR'(1,1) EQ 'B')                                 32800042
&S       SETC  '&SKIP$OR'(&B+1,&K-&B)                                   32900042
&T       SETA  &S                                                       33000042
.BACKUP  ANOP                                                           33100042
&NRENTS  SETA  &NRENTS+1                                                33200042
&TEMP    SETA  &ISHIFT                                                  33300042
A&SYSNDX DC    AL.12(&LOGITEM-&DSECT),XL.4'&TEMP'                       33400042
         AIF (&IBITS EQ 1 AND &B EQ 0).OUT                              33500042
         ORG   A&SYSNDX                                                 33600042
&B       SETB  1                                                        33700042
         DC    AL.12(&LOGITEM-&DSECT),XL.4'C'                           33800042
         DC    BL.1'&B',AL.7(&T),AL.4(&IBITS),FL.4'&ISHIFT'             33900042
.OUT     ANOP                                                           34000042
         MEND                                                           34100042
         EJECT                                                          34200042
*  HEX MACRO     HEX MACRO     HEX MACRO    HEXN MACRO     HEX MACRO  * 34300042
         SPACE 2                                                        34400042
         MACRO                                                          34500042
         HEX   &LOGITEM,&SKIP$OR,&BYTES                                 34600042
.*                            THIS MACRO FACILITATES GENERATION OF THE  34700042
.*                                 TABLE ENTRIES SPECIFYING HEX TYPE    34800042
.*                                 CONVERSIONS.                         34900042
.*                            &LOGITEM - NAME OF DATA ITEM TO BE        35000042
.*                                 CONVERTED                            35100042
.*                            &SKIP$OR - NUMBER OF SPACES TO SKIP ON    35200042
.*                                 MULTIPLE PRINT OR NBR OF SPACES TO   35300042
.*                                 BACK UP FROM COLUMN FOR START OF     35400042
.*                                 PRINTING. THE LETTER B PRECEEDS THE  35500042
.*                                 NUMBER (B8) IF THE LATTER OPTION IS  35600042
.*                                 DESIRED. OMISSION OF THIS OPERAND    35700042
.*                                 FORCES OPTION 2 WITH BACKUP SPACING  35800042
.*                                 EQUAL TO THE NUMBER OF BYTES SPECI-  35900042
.*                                 FIED BY THE NEXT OPERAND (TWICE THIS 36000042
.*                                 NUMBER IF SUFFIX IS EXPLICITLY OR    36100042
.*                                 IMPLICITLY B).                       36200042
.*                            &BYTES - NUMBER OF TOTAL INPUT BYTES TO   36300042
.*                                 PROCESS. THIS NUMBER IS SUFFIXED     36400042
.*                                 WITH AN L,R, OR B TO STIPULATE       36500042
.*                                 PRINTING OF THE LEFT HALF, RIGHT     36600042
.*                                 HALF, OR BOTH HALVES OF THE BYTE     36700042
.*                                 RESPECTIVELY. OMISSION OF THIS       36800042
.*                                 OPERAND DEFAULTS TO B WITH THE NUM-  36900042
.*                                 BER OF BYTES EQUAL TO THE ITEM LNGTH 37000042
.*                            A NEW ENTRY IS GENERATED ONLY WHEN NECES- 37100042
.*                                 SARY. THIS MACRO MUST BE THE FIRST   37200042
.*                                 MACRO INSTRUCTION ISSUED FOR THE     37300042
.*                                 SUBJECT LINE(S).                     37400042
         GBLC &ITEM(1000),&DSECT                                        37500042
         GBLA &ITEMNBR,&BITS(1000),&SHIFT(1000),&NRENTS                 37600042
         LCLB  &B                                                       37700042
         LCLA  &IBITS,&NDX,&ISHIFT,&K,&T,&CODE,&BYTESP                  37800042
         LCLC  &S,&LETTER                                               37900042
.LOOP    ANOP                                                           38000042
&NDX     SETA  &NDX+1                                                   38100042
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      38200042
         AIF   (&NDX LT &ITEMNBR).LOOP                                  38300042
         MNOTE *,'LOG ITEM NOT DEFINED'                                 38400042
         MEXIT                                                          38500042
.FOUND   ANOP                                                           38600042
&ISHIFT  SETA  &SHIFT(&NDX)                                             38700042
&IBITS   SETA  &BITS(&NDX)                                              38800042
&CODE    SETA  1                                                        38900042
&K       SETA  K'&BYTES                                                 39000042
         AIF   (&IBITS-(&IBITS/4)*4 EQ 0).OK                            39100042
         MNOTE *,'BIT LENGTH SPECIFICATION INCONSISTENT WITH CONTROL'   39200042
         MEXIT                                                          39300042
.OK      AIF   ('&BYTES' EQ '').USEDEFN                                 39400042
&LETTER  SETC  '&BYTES'(&K,1)                                           39500042
&S       SETC  '&BYTES'(1,&K-1)                                         39600042
&BYTESP  SETA  &S                                                       39700042
         AIF   ('&LETTER' EQ 'B').BOTH                                  39800042
         AIF   (&ISHIFT EQ 0 OR &ISHIFT EQ 4).OK2                       39900042
.ERR     MNOTE *,'DATA NOT ALLIGNED ON HEX OR BYTE BOUNDARY'            40000042
         MEXIT                                                          40100042
.USEDEFN ANOP                                                           40200042
&BYTESP  SETA  &IBITS/8                                                 40300042
.BOTH    AIF   (&ISHIFT NE 0).ERR                                       40400042
&CODE    SETA  3                                                        40500042
&T       SETA  &BYTESP*2-1                                              40600042
&S       SETC  '&T'                                                     40700042
.OK2     AIF   (&ISHIFT EQ 0).L                                         40800042
&CODE    SETA  2                                                        40900042
.L       ANOP                                                           41000042
&B       SETB  1                                                        41100042
         AIF   ('&SKIP$OR' EQ '').BACKUP                                41200042
&K       SETA  K'&SKIP$OR                                               41300042
&B       SETB  ('&SKIP$OR'(1,1) EQ 'B')                                 41400042
&S       SETC  '&SKIP$OR'(&B+1,&K-&B)                                   41500042
.BACKUP  ANOP                                                           41600042
&NRENTS  SETA  &NRENTS+1                                                41700042
         DC    AL.12(&LOGITEM-&DSECT),XL.4'A'                           41800042
         DC    BL.1'&B',FL.7'&S',FL.4'&BYTESP',FL.4'&CODE'              41900042
.OUT     ANOP                                                           42000042
         MEND                                                           42100042
         MACRO                                                          42200042
         SPECIAL  &ROUTINE,&PARAM,&SPACE=                               42300042
.*                            THIS MACRO GENERATES A SPECIAL ROUTINE    42400042
.*                                 ENTRY TO BE PROCESSED BY THE SUM. M. 42500042
.*                            &ROUTINE - SYMBOL ON SPECIAL ROUTINE EWT. 42600042
.*                            &PARAM - AN 8 BIT BINARY REPRESENTATION   42700042
.*                                 TO OCCUPY THE 'MASK' FIELD BUT TO BE 42800042
.*                                 INTERPRETED AS AN ARGUMENT OF THE    42900042
.*                                 SPECIAL ROUTINE.                     43000042
.*                            &SPACE - THE NUMBER OF 2BYTE COUNTERS TO  43100042
.*                                 ALLOCATE FOR REQUIRED PROCESSING.    43200042
         GBLC  &CSECT                                                   43300042
         GBLA  &COUNTR                                                  43400042
         LCLA  &ADD                                                     43500042
         DC    AL1(128)                                                 43600042
         DC    BL.8'&PARAM'                                             43700042
         DC    AL2(&ROUTINE-&CSECT)                                     43800042
         DC    AL2(&COUNTR)                                             43900042
&ADD     SETA  1                                                        44000042
         AIF   ('&SPACE' EQ '').NORM                                    44100042
&ADD     SETA  &SPACE                                                   44200042
.NORM    ANOP                                                           44300042
&COUNTR  SETA  &COUNTR+&ADD                                             44400042
         MEND                                                           44500042
         MACRO                                                          44600042
         SUM   &LOGITEM,&MASK                                           44700042
.*                            THIS MACRO GENERATES A NORMAL EDIT ENTRY  44800042
.*                                 FOR PROCESSING BY THE SUMMARY MODULE 44900042
.*                            &LOGITEM - NAME OF DATA ITEM TO BE SUMMED 45000042
.*                            &MASK - BYTE MASK FOR BITS TO BE TESTED.  45100042
.*                                 THIS OPERAND SHOULD BE OMITTED FOR   45200042
.*                                 SINGLE BIT ITEMS IN WHICH CASE THE   45300042
.*                                 MASK WILL BE SET ACCORDING TO THE    45400042
.*                                 OFF BYTE BIT DISPLACEMENT OF THE     45500042
.*                                ITEM AS DEFINED BY THE MACRO 'DSGEN'  45600042
         GBLA  &COUNTR,&ITEMNBR,&BITS(1000),&SHIFT(1000)                45700042
         GBLC  &ITEM(1000),&DSECT                                       45800042
         LCLA  &IBITS,&NDX,&ISHIFT,&M,&BITNBR                           45900042
.LOOP    ANOP                                                           46000042
&NDX     SETA  &NDX+1                                                   46100042
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      46200042
         AIF   (&NDX LT &ITEMNBR).LOOP                                  46300042
         MNOTE *,'LOGITEM NOT FOUND'                                    46400042
         MEXIT                                                          46500042
.FOUND   ANOP                                                           46600042
         DC    AL1(0)                                                   46700042
&ISHIFT  SETA  &SHIFT(&NDX)                                             46800042
&IBITS   SETA  &BITS(&NDX)                                              46900042
         AIF   ('&MASK' EQ '').FORM                                     47000042
         DC    B'&MASK'                                                 47100042
         AGO   .ITEM                                                    47200042
.FORM    ANOP                                                           47300042
&BITNBR  SETA  &ISHIFT-7                                                47400042
&BITNBR  SETA  0-&BITNBR                                                47500042
&M       SETA  1                                                        47600042
.LOOP2   ANOP                                                           47700042
         AIF   (&BITNBR EQ 0).GOTIT                                     47800042
&M       SETA  &M*2                                                     47900042
&BITNBR  SETA  &BITNBR-1                                                48000042
         AGO   .LOOP2                                                   48100042
.GOTIT   ANOP                                                           48200042
         DC    AL1(&M)                                                  48300042
.ITEM    DC    AL2(&LOGITEM-&DSECT)                                     48400042
         DC    AL2(&COUNTR)                                             48500042
&COUNTR  SETA  &COUNTR+1                                                48600042
         MEND                                                           48700042
         GBLC  &DSECT,&CSECT                                            48800042
&CSECT   SETC  'IFCST003'                                               48900042
&DSECT   SETC  'T003'                                                   49000042
IFCST003 CSECT                                                          49100042
T003     DSECT                                                          49200042
         DSGEN (KEY,16),(TSWS,16),(TID,8),(TDUM1,16),(TCHAR,8)          49300042
         DSGEN (XDATE,32),(TIME,32)                                     49400042
         DSGEN (TDUM2,8),(TSER,24),(TMOD,16),(TDUM3,16)                 49500042
         DSGEN (TCUA,16),(TSID,16)                                      49600042
         DSGEN (TSTAT,16),(TDUM4,16)                                    49700042
IFCST003 CSECT                                                          49800042
         USING T003,R2                                                  49900042
         USING *,R9                                                     50000042
         DC    A(ENTRIES)               PTR TO ENTRIES                  50100042
         DC    A(PENTRY)                                                50200042
REG8     DC    F'0'                     CURRENT ENTRY                   50300042
SCSIZE   DC    H'30'                    NO OF 2BYTE CNTRS FOR SUM       50400042
XDATE1   STM   R14,R12,L12(R13)         SAVE REGS                       50500042
         CLC   XDATE(L4),HEX00         IS DATE ZERO                     50600042
         BE    RETURN                   BR-ZERO                         50700042
         CLC   L0(L4,R3),HEX00          IS LOW DATE ZERO                50800042
         BNE   XDATE2                   BR-NO                           50900042
         MVC   L0(L4,R3),XDATE          MOVE IN DATE                    51000042
XDATE2   EQU   *                                                        51100042
         CLC   XDATE(L4),L0(R3)         CHECK FOR LOW DATE              51200042
         BL    SAVELOW                  LOWER SAVE IT                   51300042
         CLC   XDATE(L4),L4(R3)         CHECK FOR HI                    51400042
         BNH   RETURN                   BR-NOT HI                       51500042
SAVEHI   MVC   L4(L4,R3),XDATE          MOVE HI DATE                    51600042
         B     RETURN                                                   51700042
SAVELOW  MVC   L0(L4,R3),XDATE          MOVE LOW DATE                   51800042
         B     RETURN                                                   51900042
*                                                                       52000042
RETURN   LM    R14,R12,L12(R13)    RESTORE REGS                         52100042
         BR    R14                 RETURN                               52200042
SETERR   DS    0H                                                       52300042
         ST    R5,XSAVE                 SAVE REG                        52400042
         MVC   SAVE1(L2),TSTAT          SAVE STATS                      52500042
         NC    SAVE1,STATMASK           TURN OFF UNUSED BITS            52600042
         LA    R5,ERLIST                PICK UP LIST POINTER            52700042
LOOP     DS    0H                                                       52800042
         TM    0(R5),HEXFF              IS THIS LAST ENTRY              52900042
         BO    RETURNB                  YES,RETURN                      53000042
         CLC   SAVE1(L2),0(R5)          IS THIS THE ERROR COMBO         53100042
         LA    R3,L2(R3)                BUMP TO NEXT COUNTER            53200042
         BE    ADDONE                   YES, ADD TO COUNTER             53300042
         LA    R5,L2(R5)                BUMP TO NEXT                    53400042
         B     LOOP                     TRY NEXT                        53500042
ADDONE   DS    0H                                                       53600042
         LH    R5,0(R3)                 GET COUNTER                     53700042
         LA    R5,L1(R5)                ADD ONE                         53800042
         STH   R5,0(R3)                 RESTORE COUNTER                 53900042
         B     RETURNB                  RETURN                          54000042
RETURNB  L     R5,XSAVE                 RESTORE REG                     54100042
         BR    R14                                                      54200042
ERLIST   DS    0C                                                       54300042
         DC    X'0C00'                  DB,US                           54400042
         DC    X'0002'                  CC                              54500042
         DC    X'0003'                  CC,OC                           54600042
         DC    X'0020'                  CR                              54700042
         DC    X'0004'                  DC                              54800042
         DC    X'0005'                  DC,OC                           54900042
         DC    X'0404'                  DC,US                           55000042
         DC    X'0405'                  DC,US,OC                        55100042
         DC    X'0008'                  EC                              55200042
         DC    X'0408'                  EC,US                           55300042
         DC    X'0010'                  IR                              55400042
         DC    X'0018'                  IR,EC                           55500042
         DC    X'0418'                  IR,EC,US                        55600042
         DC    X'0011'                  IR,OC                           55700042
         DC    X'0410'                  IR,OC                           55800042
         DC    X'0001'                  OC                              55900042
         DC    X'0401'                  OC,US                           56000042
         DC    X'0100'                  TC                              56100042
         DC    X'FFFF'                                                  56200042
HEX00    DC    XL4'00'                                                  56300042
SAVE1    DC    XL2'0000'                                                56400042
STATMASK DC    X'0D3F'                                           P4378  56500042
BDEUSCON DC    X'0E00'                                                  56600042
ENTRIES  DS    0F                                                       56700042
         SPECIAL    XDATE1,00000000,SPACE=4                             56800042
         SPECIAL  SETERR,0,SPACE=60                                     56900042
         DC    X'FF'                                                    57000042
R0       EQU   0                                                        57100042
R1       EQU   1                                                        57200042
R2       EQU   2                                                        57300042
R3       EQU   3                                                        57400042
R4       EQU   4                                                        57500042
R5       EQU   5                                                        57600042
R6       EQU   6                                                        57700042
R7       EQU   7                                                        57800042
R8       EQU   8                                                        57900042
R9       EQU   9                                                        58000042
R10      EQU   10                                                       58100042
R11      EQU   11                                                       58200042
R12      EQU   12                                                       58300042
R13      EQU   13                                                       58400042
R14      EQU   14                                                       58500042
R15      EQU   15                                                       58600042
L0       EQU   0                                                        58700042
L1       EQU   1                                                        58800042
L2       EQU   2                                                        58900042
L3       EQU   3                                                        59000042
L4       EQU   4                                                        59100042
L5       EQU   5                                                        59200042
L6       EQU   6                                                        59300042
L7       EQU   7                                                        59400042
L8       EQU   8                                                        59500042
L9       EQU   9                                                        59600042
L12      EQU   12                                                       59700042
L20      EQU   20                                                       59800042
L28      EQU   28                                                       59900042
L30      EQU   30                                                       60000042
L32      EQU   32                                                       60100042
L34      EQU   34                                                       60200042
L64      EQU   64                                                       60300042
L100     EQU   100                                                      60400042
HEXI28   EQU   X'28'                                                    60500042
HEXFF    EQU   X'FF'                                                    60600042
CUDISP   EQU   X'17'                                                    60700042
NOT      EQU   X'FF'                                                    60800042
Y3270    DSECT                                                          60900042
         DSGEN (YDUMA,32),(FWDPTR,32)                                   61000042
         DSGEN (TOTALREC,16),(YTYPE,8),(YCHAN,8),(YCUA,24),(YSER1,8)    61100042
         DSGEN (YSER2,16),(YCPU,16),(YSMSW,16),(YDUMB,8),(CU,8)         61200042
         DSGEN (DS,8),(YDUMC,8),(YDUMD,16)                              61300042
         DS    2C                                                       61400042
         DSGEN (YLOWD,32)               LOW DATE                        61500042
         DSGEN (YHID,32)                HI DATE                         61600042
         DS    2C                                                       61700042
         DSGEN (YERR01,16),(YERR02,16),(YERR03,16),(YERR04,16)          61800042
         DSGEN (YERR05,16),(YERR06,16),(YERR07,16),(YERR08,16)          61900042
         DSGEN (YERR09,16),(YERR10,16),(YERR11,16),(YERR12,16)          62000042
         DSGEN (YERR13,16),(YERR14,16),(YERR15,16),(YERR16,16)          62100042
         DSGEN (YERR17,16),(YERR18,16),(YERR19,16),(YERR20,16)          62200042
IFCST003 CSECT                                                          62300042
PENTRY   DS    0F                                                       62400042
&DSECT   SETC  'Y3270'                                                  62500042
&CSECT   SETC  'PENTRY'                                                 62600042
         USING *,R9                                                     62700042
         DC    A(PEDIT)                                                 62800042
         DC    C'IFCST003'                                              62900042
YR9PTR   DS    F                                                        63000042
YLABELP  DS    F                                                        63100042
*                                                                       63200042
SKIPPER  BR    R14                      NO-OP FOR EDIT                  63300042
SORTDATE DS    0H                                                       63400042
         STM   R5,R8,XSAVE                                              63500042
         LR    R5,R2                    SET R5 FOR FIRST LOOP           63600042
LOOPDATE L     R5,L4(R5)                GET NEXT AREA                   63700042
         LTR   R5,R5                    ZERO POINTER?                   63800042
         BZ    RETURNA                  YES, DONE                       63900042
         CLC   L30(L4,R5),L30(R2)       IS NEW DATE LOWER               64000042
         BNL   DATEHI                   NO, SEE IF HIGH HIGHER          64100042
         MVC   L30(L4,R2),L30(R5)       YES, MOVE IN NEW LOWER          64200042
DATEHI   CLC   L34(L4,R5),L34(R2)       IS HIGH HIGHER?                 64300042
         BNH   LOOPDATE                 NO, CHECK NEXT AREA             64400042
         MVC   L34(L4,R2),L34(R5)       YES, MOVE IN                    64500042
         B     LOOPDATE                 CHECK NEXT AREA                 64600042
SETCPUNO STM   R5,R8,XSAVE              SAVE REGS                       64700042
         SR    R5,R5                    CLEAR R5                        64800042
         IC    R5,0(R4)                 PICK UP                         64900042
         SLL   R5,L8                      CPU TYPE                      65000042
         IC    R5,L1(R4)                    FIELD                       65100042
         LTR   R5,R5                    IS IT ZERO?                     65200042
         BNZ   RETURNA                  NO, HEX IS GOOD, RETURN         65300042
         LA    R6,L64                   ELSE, BACK UP DATA PTR          65400042
         SR    R3,R6                    TO PUT IN NEW INFO              65500042
         MVC   0(L6,R3),SHARED          SAY MODEL SHARED       @Z427VLS 65600042
         B     RETURNA                  RETURN                          65800042
*                                                                       65900042
SETDATE  UNPK  WORK(L8),L0(L4,R4)       PACK DATE                       66000042
         MVZ   WORK+L7(L1),WORK         MOVE ON ZONE                    66100042
         MVC   L0(L3,R3),WORK+L5        MOVE DATE TO PRINT LINE         66200042
         MVC   L5(L2,R3),WORK+L3        MOVE YEAR TO PRINT LINE         66300042
         BR    R14                                                      66400042
*                                                                       66500042
RETURNA  LM    R5,R8,XSAVE              RESTORE REGS                    66600042
         BR    R14                                                      66700042
SHARED   DC    C'SHARED'                                       @Z427VLS 66800042
NODVPRT  DS    0H                                                       67000042
         TM    CU2,FLGEDTCU             IS THIS A CU EDIT               67100042
         BO    NOPRT                    YES, DON'T PRINT LINE           67200042
         TM    CU2,FLGCUAPT             IS CUA EDIT OCCURRING           67300042
         BO    NOPRT                    YES, DON'T PRINT LINE           67400042
         BR    R14                      ELSE, PRINT                     67500042
NOCUPRT  DS    0H                                                       67600042
         TM    CU2,FLGCUAPT             IS CUA EDIT OCCURRING           67700042
         BO    NOPRT                    YES, DON'T PRINT THIS LINE      67800042
         BR    R14                      ELSE PRINT                      67900042
NOCUAPRT DS    0H                                                       68000042
         TM    CU2,FLGCUAPT             IS CUA EDIT OCCURRING           68100042
         BNO   NOPRT                    NO, DON'T PRINT LINE            68200042
         BR    R14                      RETURN                          68300042
NOPRT    SR    R15,R15                  SHOW EREP TO NOT PRINT          68400042
         BR    R14                      RETURN                          68500042
LOOPDS   DS    0H                       EDIT NEXT SECTIONS              68600042
         STM   R5,R10,YSAVE             SAVE REGS                       68700042
         L     R5,L4(R2)                GET NEXT DS                     68800042
         LTR   R5,R5                    ALL DONE?                       68900042
         BE    EDITCUA                  YES, EDIT CUA SUMMARY           69000042
         CLC   CUDISP(L1,R2),CUDISP(R5) SAME CU?                        69100042
         BNE   CHNGCU                   NO, CHANGE CU                   69200042
         BAL   R10,FREEMAIN             GO FREE CORE                    69300042
         L     R6,CUSAVE                GET CURRENT CU AREA             69400042
         BAL   R7,ADDCU                 ADD COUNTERS TO CU              69500042
         TM    CU2,FLGCU2               IS THIS 2ND CU                  69600042
         BNO   N2CU                     NO, DON'T ADD TO CUA            69700042
         L     R6,CUASAVE               SET UP FOR  ADD                 69800042
         BAL   R7,ADDCU                 ADD COUNTERS TO CUA             69900042
N2CU     DS    0H                                                       70000042
         LR    R2,R5                    UPDATE R2                       70100042
         MVC   RELABELS(L100),DEVCHAR   SET LABEL TO SHOW DEVICE        70200042
SETEDIT  DS    0H                                                       70300042
         LA    R5,REDIT-4               POINT TO RE-EDIT AREA           70400042
         ST    R5,YR9PTR                TELL EREP                       70500042
         LA    R5,RELABELS              GET NEXT LABELS                 70600042
         ST    R5,YLABELP               TELL EREP                       70700042
EDITEND  DS    0H                                                       70800042
         LM    R5,R10,YSAVE             RESTORE REGS                    70900042
         BR    R14                      RETURN                          71000042
ADDCU    DS    0H                       ADD R5 COUNTERS TO R6           71100042
         LH    R8,L8(R6)                GET NUMBER OF RECORDS           71200042
         AH    R8,L8(R5)                ADD NUMBER IN NEXT SLOT         71300042
         STH   R8,L8(R6)                STORE IN CU OR CUA              71400042
         LA    R10,HEXI28               POINT TO FIRST ERROR SLOT       71500042
ADDLOOP  DS    0H                                                       71600042
         LH    R8,L0(R10,R6)            GET CU OR CUA ERROR COUNT       71700042
         AH    R8,L0(R10,R5)            ADD ERROR COUNT OF NEXT         71800042
         STH   R8,L0(R10,R6)            STORE IN CU OR CUA SUM          71900042
         LA    R10,L2(R10)              BUMP R10                        72000042
         CH    R10,HEX4C                PAST LAST COUNTER               72100042
         BNE   ADDLOOP                  NO, LOOP                        72200042
         BR    R7                       YES, RETURN                     72300042
CHNGCU   DS    0H                       EDIT SUMS FOR CU                72400042
         OI    CU2,FLGCU2               SHOW MORE THAN ONE CU           72500042
         BAL   R10,FREEMAIN             GO FREE CORE                    72600042
         TM    CU2,FLGEDTCU             JUST EDITED CU?                 72700042
         BO    CHNGCU2                  YES, START NEXT CU              72800042
CUEDIT   L     R2,CUSAVE                SET TO EDIT CU                  72900042
         ST    R5,CUSAVE                SHOW NEW CU SUM AREA            73000042
         ST    R5,L4(R2)                RELINK CHAIN                    73100042
         OI    CU2,FLGEDTCU             SHOW CU EDIT OCCURRING          73200042
         MVC   RELABELS(L100),CUCHAR    SET LABEL TO SHOW CU SUM        73300042
         B     SETEDIT                                                  73400042
CHNGCU2  DS    0H                                                       73500042
         NI    CU2,NOT-FLGEDTCU         TURN OFF CU FLAG                73600042
         LR    R2,R5                    SET TO EDIT FIRST OF NEXT       73700042
         L     R6,CUASAVE               ADD THIS TO CUA (COMB SUM       73800042
               BAL   R7,ADDCU                                           73900042
         MVC   RELABELS(L100),DEVCHAR   SET LABEL TO SHOW DEVICE        74000042
         B     SETEDIT                  GO EDIT IT                      74100042
EDITCUA  DS    0H                       LAST RECORD IN CHAIN            74200042
         BAL   R10,FREEMAIN             GO FREE CORE                    74300042
         TM    CU2,FLGCUAPT             ALL DONE?                       74400042
         BO    EDITEND                  YES, END EDIT                   74500042
         TM    CU2,FLGCUA               BEEN HERE BEFORE?               74600042
         BO    LASTEDIT                 YES, DO CUA SUMS, END           74700042
         OI    CU2,FLGCUA               SHOW CUA TO BE PRINTED          74800042
         B     CUEDIT                   SET UP TO EDIT CU               74900042
LASTEDIT DS    0H                                                       75000042
         L     R2,CUASAVE               POINT TO CUA TOTALS             75100042
         OI    CU2,FLGCUAPT             TELL THAT CUA IS PRINTING       75200042
         ST    R5,CUASAVE               SET TO FREE CUA NXT ENTRY       75300042
         ST    R5,L4(R2)                SET TO RETURN TO EDITCUA        75400042
         MVC   RELABELS(L100),COMCHAR   SET LABEL TO SHOW XCU SUM       75500042
         B     SETEDIT                                                  75600042
FREEMAIN DS    0H                                                       75700042
         C     R2,CUSAVE                WAS THIS CU TO BE SAVED         75800042
         BE    SKIPFREE                 YES, DON'T FREE IT              75900042
         C     R2,CUASAVE               IS THIS CUA SUM AREA?           76000042
         BE    SKIPFREE                 YES, DON'T FREE                 76100042
         LR    R1,R2                    SET UP FOR FREEMAIN             76200042
         FREEMAIN  R,LV=96,A=(1)        FREE THE SORE                   76300042
SKIPFREE DS    0H                                                       76400042
         BR    R10                      RETURN                          76500042
CONVERT  DS    0H                                                       76600042
         STM   R14,R12,L12(R13)         SAVE REGS                       76700042
         LH    R5,L0(R4)                                                76800042
CONV1    CVD   R5,WORK                  CONVERT TO DECIMAL              76900042
         UNPK  L0(L5,R3),WORK+L3(L5)    UNPACK TO PRINT BUFFER @XA22506 77000001
         MVZ   L4(L1,R3),L0(R3)         PUT ON PRINTABLE ZONE  @XA22506 77050001
         LM    R14,R12,L12(R13)         RESTORE REGS                    77200042
         BR    R14                                                      77300042
SORT     DS    0H                                                       77400042
         STM   R14,R12,L12(R13)         SAVE REGS                       77500042
         L     R3,L4(R2)                GET 2ND AREA                    77600042
         LA    R8,0                                                     77700042
         ST    R8,L4(R2)                SET NEW POINTER TO ZERO         77800042
LOOP1    DS    0H                                                       77900042
         LTR   R3,R3                    NO MORE AREAS?                  78000042
         BZ    ENDSORT                  YES, STOP SORT                  78100042
         LR    R4,R2               INITIALIZE R4                        78200042
         L     R7,L4(R4)                UPDATE R7                       78300042
         L     R5,L4(R3)                R5 HOLDS NEXT IN OLD CHAIN      78400042
         CLC   CUDISP(L2,R3),CUDISP(R2)                                 78500042
         BL    FIRST                                                    78600042
LOOP2    DS    0H                                                       78700042
*                                       COMPARE ON CU AND DS            78800042
         LTR   R7,R7                    END OF NEW CHAIN?               78900042
         BZ    EOCHAIN                  YES, ADD TO END                 79000042
         CLC   CUDISP(L2,R3),CUDISP(R7) B> OR = TO A?                   79100042
         BH    BHIGH                                                    79200042
         ST    R3,L4(R4)                INSERT AFTER LAST LOWER         79300042
         ST    R7,L4(R3)                POINT TO NEXT HIGHER            79400042
         LR    R3,R5                    SET TO NEXT TO CHECK            79500042
         B     LOOP1                    GO GET NEXT AREA                79600042
BHIGH    DS    0H                                                       79700042
         LR    R4,R7                    UPDATE R4                       79800042
         L    R7,L4(R4)                 SETUP R7                        79900042
         B     LOOP2                    CHECK NEXT SLOT                 80000042
EOCHAIN  DS    0H                                                       80100042
         ST    R3,L4(R4)                PT OLD LAST TO NEW LAST         80200042
         ST    R8,L4(R3)                POINT NEW LAST TO ZERO          80300042
         LR    R3,R5                    SET TO NEXT OLD AREA            80400042
         B     LOOP1                    INSERT IT IN NEW CHAIN          80500042
FIRST    DS    0H                                                       80600042
         ST    R2,L4(R3)                POINT THIS NEW AT NEXT          80700042
         LR    R2,R3                    START AT THIS NEW               80800042
         LR    R3,R5                    CHECK NEXT AREA                 80900042
         B     LOOP1                                                    81000042
ENDSORT  DS    0H                                                       81100042
         ST    R2,L28(R13)              SET R2 FOR EREP                 81200042
         ST    R2,CUSAVE                SET FIRST CU SUM AREA           81300042
         ST    R2,CUASAVE               SET CUA SUM AREA                81400042
         LM    R14,R12,L12(R13)         RESTORE REGS                    81500042
         BR    R14                      RETURN                          81600042
HEX4C    DC    H'76'                                                    81700042
YSAVE    DS    6F                       SAVE AREA FOR WORK REGS         81800042
CUSAVE   DS    F                        POINTER TO CURRENT CU SUM       81900042
CUASAVE  DS    F                        PTR TO CURR CUA SUM AREA        82000042
CU2      DC    X'00'                    FLAGS FOR LOOPDS                82100042
FLGCU2   EQU   X'80'                    SET FOR 2ND CU                  82200042
FLGEDTCU EQU   X'40'                    SHOWS CU EDIT OCCURRING         82300042
FLGCUAPT EQU   X'20'                    SHOWS CUA EDIT OCCURRING        82400042
FLGCUA   EQU   X'10'                    SHOWS LAST RECORD REACHED       82500042
WORK     DC    D'0'                                                     82600042
XSAVE    DS    4F                                                       82700042
COMCHAR  DC    CL100'TRANSMISSION CONTROL UNIT     TRANSMISSION CONTROLX82800042
                UNIT     TRANSMISSION CONTROL UNIT               '      82900042
CUCHAR   DC    CL100'CONTROL UNIT  CONTROL UNIT  CONTROL UNIT  CONTROL X83000042
               UNIT  CONTROL UNIT  CONTROL UNIT  CONTROL UNIT    '      83100042
DEVCHAR  DC    CL100'DEVICE DEVICE DEVICE DEVICE DEVICE DEVICE DEVICE DX83200042
               EVICE DEVICE DEVICE DEVICE DEVICE DEVICE DEVICE   '      83300042
PEDIT    DC    2F'0'                                                    83400042
         DC    A(LABELS)                LABEL PTR                       83500042
         DC    H'0'                     DISP                            83600042
         LINE  ,,SKIP=E                 EJECT                           83700042
         LINE  (57,32),(23,26)                                          83800042
         HEX   YCPU,0,2B                                                83900042
         HEX   YSER1,0,3B                                               84000042
         ROUTINE  YCPU,SETCPUNO                                         84100042
         ROUTINE  YDUMA,SORT                                            84200042
         ROUTINE  YLOWD,SORTDATE                                        84300042
         LABEL 'DAY YEAR   DAY YEAR','MODEL-','SERIAL NO.'              84400042
         LINE       (23,11),(1,30)                                      84500042
         ROUTINE    YLOWD,SETDATE                                       84600042
         ROUTINE    YHID,SETDATE                                        84700042
         LABEL      'OUTBOARD DATE RANGE -','TO'                        84800042
*                                                                       84900042
         LINE  (55,1),(1,65),SKIP=2                                     85000042
         HEX   YCUA                                                     85100042
         LABEL 'SUMMARY OF MISCELLANEOUS RECORDS FOR DEVICE','DEVICE TYX85200042
               PE 3270 REMOTE'                                          85300042
         LINE  ,,SKIP=2                                                 85400042
         ROUTINE  YDUMA,SKIPPER                                         85500042
RELABELS LABEL 'DEVICE DEVICE DEVICE DEVICE DEVICE DEVICE DEVICE DEVICEX85600042
                DEVICE DEVICE DEVICE DEVICE DEVICE DEVICE   '           85700042
REDIT    LINE  (30,1),(1,1),SKIP=1                                      85800042
         HEX   YCUA                                                     85900042
         ROUTINE  YDUMA,NOCUAPRT                                        86000042
         LABEL 'CHANNEL UNIT ADDRESS'                                   86100042
         LINE                                                           86200042
         HEX   CU                                                       86300042
         ROUTINE  YDUMA,NOCUPRT                                         86400042
         LABEL 'CONTROL UNIT ADDRESS'                                   86500042
         LINE                                                           86600042
         HEX   DS                                                       86700042
         ROUTINE  YDUMA,NODVPRT                                         86800042
         LABEL 'DEVICE ADDRESS'                                         86900042
         LINE  (26,1),,SKIP=3                                @XA22506   87000001
         ROUTINE TOTALREC,CONVERT                                       87100042
         LABEL 'NUMBER OF RECORDS'                                      87200042
         LINE  ,,SKIP=2                                                 87300042
         ROUTINE  YDUMA,SKIPPER                                         87400042
         LABEL 'STATISTICS SUMMARY'                                     87500042
         LINE  (25,40),(5,40),SKIP=1                                    87600042
         ROUTINE  YERR01,CONVERT                                        87700042
         ROUTINE  YERR02,CONVERT                                        87800042
         LABEL 'DB,US','CC'                                             87900042
         LINE                                                           88000042
         ROUTINE  YERR03,CONVERT                                        88100042
         ROUTINE  YERR04,CONVERT                                        88200042
         LABEL 'CC,OC','CR'                                             88300042
         LINE                                                           88400042
         ROUTINE  YERR05,CONVERT                                        88500042
         ROUTINE  YERR06,CONVERT                                        88600042
         LABEL 'DC','DC,OC'                                             88700042
         LINE                                                           88800042
         ROUTINE  YERR07,CONVERT                                        88900042
         ROUTINE  YERR08,CONVERT                                        89000042
         LABEL 'DC,US','DC,US,OC'                                       89100042
         LINE                                                           89200042
         ROUTINE  YERR09,CONVERT                                        89300042
         ROUTINE  YERR10,CONVERT                                        89400042
         LABEL 'EC','EC,US'                                             89500042
         LINE                                                           89600042
         ROUTINE  YERR11,CONVERT                                        89700042
         ROUTINE  YERR12,CONVERT                                        89800042
         LABEL 'IR','IR,EC'                                             89900042
         LINE                                                           90000042
         ROUTINE  YERR13,CONVERT                                        90100042
         ROUTINE  YERR14,CONVERT                                        90200042
         LABEL 'IR,EC,US','IR,OC'                                       90300042
         LINE                                                           90400042
         ROUTINE  YERR15,CONVERT                                        90500042
         ROUTINE  YERR16,CONVERT                                        90600042
         LABEL 'IR,US','OC'                                             90700042
         LINE  ,,SKIP=3                                                 90800042
         ROUTINE  YERR17,CONVERT                                        90900042
         ROUTINE  YERR18,CONVERT                                        91000042
         LABEL 'OC,US','TC'                                             91100042
         LINE  (27,1),(1,1),SKIP=2                                      91200042
         ROUTINE  YDUMA,LOOPDS                                          91300042
         LABEL ''                                                       91400042
         DC    X'FF'                                                    91500042
         DC    X'0000'                                                  91600042
         DC    X'0000'                                                  91700042
         DC    X'0000'                                                  91800042
LABELS   DS    0F                                                       91900042
         DC    C'$'                                                     92000042
         LSTART                                                         92100042
         END                                                            92200042
