         TITLE 'IFCST005 SUMMARY FOR 3705 27RN'                         00090051
         GBLC  &DSECT,&CSECT                                            00180000
&CSECT   SETC  'IFCST005'                                               00230000
&DSECT   SETC  'S3705'                                                  00280000
&CSECT   CSECT                                                          00330000
&DSECT   DSECT                                                          00380000
         DSGEN (RECT,8),(OPSYS,8),(SWITCH,24),(RCDID,8),(SPARE1,16)     44010051
         DSGEN (DATE,32),(TIME,32)                                      44100051
         DSGEN (SPARE2,8),(CPUSER,24),(MODEL,16),(SPARE3,16)            44190051
         DSGEN (CUA,16),(TERMN1,16),(TERMN2,32)                         44280051
         DSGEN (TERMN3,16),(RESID,16),(LINEADD,16),(RECMD,8),(RECID,8)  44370051
* NOTE THAT THERE WILL BE FOUR BYTES EXTRA IN HERE IF BIT ZERO OF       44400000
* RECMD IS ON.                                                 @D3502BL 44430000
         DSGEN (ISBOX,8),(BTUMOD,8),(REG100,8),(REG108,8),             C44460051
               (REG200,8),(REG208,8),(REG300,8),(REG308,8)              44550051
         DSGEN (REG400,16),(REG500,8),(REG508,8)                        44640051
         DSGEN (REG600,8),(REG608,8),(REG700,16)                        44730051
         DSGEN (REG800,8),(,8),(,16)                                    44820051
         EJECT                                                          44910051
&CSECT   CSECT                                                 @D3502BL 45000000
         USING &DSECT,R2                                       @D3502BL 45050000
         USING *,R9                                                     45180051
         DC    A(ENTRIES)                                               45270051
         DC    A(PEDIT)                                                 45360051
REG8     DC    F'0'                                                     45450051
SCSIZE   DC    AL2(TABSIZE1)       # OF HALF-WORD COUNTERS              45540051
         SPACE 2                                               @D3502BL 45630000
R0       EQU   0                                                        45810051
R1       EQU   1                                                        45900051
R2       EQU   2                                                        45990051
R3       EQU   3                                                        46080051
R4       EQU   4                                                        46170051
R5       EQU   5                                                        46260051
R6       EQU   6                                                        46350051
R7       EQU   7                                                        46440051
R8       EQU   8                                                        46530051
R9       EQU   9                                                        46620051
R10      EQU   10                                                       46710051
R11      EQU   11                                                       46800051
R12      EQU   12                                                       46890051
R13      EQU   13                                                       46980051
R14      EQU   14                                                       47070051
R15      EQU   15                                                       47160051
         SPACE 2                                               @D3502BL 47250000
L0       EQU   0                                                        47340051
L1       EQU   1                                                        47430051
L2       EQU   2                                                        47520051
L3       EQU   3                                                        47610051
L4       EQU   4                                                        47700051
L5       EQU   5                                                        47790051
L6       EQU   6                                                        47880051
L7       EQU   7                                                        47970051
L8       EQU   8                                                        48060051
L9       EQU   9                                                        48150051
L10      EQU   10                                                       48240051
L12      EQU   12                                                       48330051
L14      EQU   14                                                       48420051
L16      EQU   16                                                       48510051
L18      EQU   18                                                       48600051
L20      EQU   20                                                       48690051
L22      EQU   22                                                       48780051
L23      EQU   23                                                       48870051
L24      EQU   24                                                       48960051
L26      EQU   26                                                       49050051
L28      EQU   28                                                       49140051
L34      EQU   34                                              @D3502BL 49230000
L46      EQU   46                                                       49320051
H00      EQU   X'00'                                                    49410051
H01      EQU   X'01'                                                    49500051
H10      EQU   X'10'                                                    49590051
HEX01    EQU   X'01'                                                    49680051
HEX02    EQU   X'02'                                                    49770051
HEX03    EQU   X'03'                                                    49860051
HEX04    EQU   X'04'                                                    49950051
HEX08    EQU   X'08'                                                    50040051
HEX10    EQU   X'10'                                                    50130051
HEX11    EQU   X'11'                                                    50220051
HEX12    EQU   X'12'                                                    50310051
HEX13    EQU   X'13'                                                    50400051
HEX20    EQU   X'20'                                                    50490051
HEX40    EQU   X'40'                                                    50580051
HEX80    EQU   X'80'                                                    50670051
HEX84    EQU   X'84'                                                    50760051
HEXC0    EQU   X'C0'                                                    50850051
SRECMD   DC    X'00'                 SAVE RECORDING MODE       @D3502BL 50940000
*                                                                       50980000
*        SET UP FROM - TO DATE                                          51020000
*                                                                       51060000
XDATE1   DS    0H                                              @D3502BL 51100000
         CLI   RECMD,X'84'             MODE 84?                @D3502BL 51140000
         BE    NOSUM                   YES...DON'T SUM         @D3502BL 51180000
         TM    RECMD,X'A0'             MODE AX?                @D3502BL 51220000
         BO    NOSUM                   YES...DON'T SUM THIS EITHER      51260000
         STM   R5,R8,XSAVE1            SAVE REGS               @D3502BL 51300000
         CLC   DATE(L4),HEX00                                           51340000
         BE    RETURNX                                         @D3502BL 51380000
         CLC   L0(L4,R3),HEX00                                          51480051
         BNE   XDATE2                                                   51570051
         MVC   L0(L4,R3),DATE                                           51660051
XDATE2   CLC   DATE(L4),L0(R3)         CK FOR LO DATE            SM5193 51750051
         BL    SAVELOW                 LOWER SAVE IT             SM5193 51840051
         CLC   DATE(L4),L4(R3)                                   SM5193 51930051
         BNH   RETURNX                                           SM5193 52020000
SAVEHI   MVC   L4(L4,R3),DATE                                           52060000
         B     RETURNX                                           OM5193 52100000
SAVELOW  MVC   L0(L4,R3),DATE          MOVE LOW DATE             OM5193 52140000
         B     RETURNX                                           OM5193 52180000
*                                                                       52220000
RETURN1  L     R2,SAVER2                                       @D3502BL 52260000
RETURNX  LM    R5,R8,XSAVE1                                    @D3502BL 52300000
DUMMY    BR 14                                                 @XA12830 52340000
         SPACE 3                                               @D3502BL 52380000
NOSUM    MVC   REG8(4),ASUMEND         GO TO END OF SUMMARY    @D3502BL 52420000
         BR    R14                                             @D3502BL 52460000
ASUMEND  DC    A(SUMEND-6)                                     @D3502BL 52500000
         SPACE 3                                               @D3502BL 52540000
**                                                                      52650051
**   LOCATE THE PROPER ENTRY FOR THIS RECORD                            52740051
**                                                                      52830051
LOCATE   STM   R5,R8,XSAVE1        SAVE REGISTERS                       52920051
         MVC   SRECMD(1),RECMD     SAVE RECORDING MODE         @D3502BL 53010000
         NI    SRECMD,X'7F'        BLANK OUT THE 'LONG' BIT    @D3502BL 53030000
         CLI   SRECMD,HEX10        IS THE RECORDING MODE LESS THAN      53050000
         BL    FIND                CHANNEL ADAPTER             @VS48714 53100051
         XC    LINEADD(2),LINEADD  IF SO, CLEAR LIBADR                  53190051
FIND     LA    R5,200              NUMBER OF ENTRIES           @VS48714 53280051
         LR    R6,R3               START OF TABLE                       53370051
         MVC   VALUES(L12),TERMN1  MOVE IN SORT KEY                     53460051
FIND1    CLC   TERMN1(L12),L0(R6)  IS THIS THE RIGHT SET OF CTRS        53550051
         BE    UPDATE              YES, EXIT                            53640051
         OC    L0(L12,R6),L0(R6)   END OF ENTRIES                       53730051
         BZ    UPDATE              YES, EXIT                            53820051
         LA    R6,L34(R6)          STEP TO NEXT ENTRY          @D3502BL 53910000
         BCT   R5,FIND1            NEXT ENTRY                           54000051
         XC    VALUES(L12),VALUES  CLEAR THE SORT KEY OF 51ST ENTRY     54090051
         MVC   VALUES(L8),OVERFLOW INDICATE OVERFLOW                    54180051
UPDATE   MVC   VALUES+L12(L22),L12(R6) MOVE IN COUNTERS        @D3502VS 54270000
         ST    R6,WHEREGOT         SAVE LOCATION                        54360051
         B     RETURNX             EXIT                        @D3502BL 54450000
         SPACE 3                                               @D3502BL 54480000
**                                                                      54540051
**   TOTAL THE RECORD INTO THE APPROPRIATE COUNTERS                     54630051
**                                                                      54720051
TOTAL    STM   R5,R8,XSAVE1        SAVE REGISTERS                       54810051
         ST    R2,SAVER2           SAVE RECORD POINTER         @D3502BL 54900000
         TM    RECMD,X'80'         IS THE 'LONG' BIT ON?       @D3502BL 54910000
         BZ    NOT8X1              NO...                       @D3502BL 54920000
         AH    R2,HWD4             BACK UP 4 BYTES             @D3502BL 54930000
NOT8X1   CLI   SRECMD,HEX01        LINE STATISTICS             @D3502BL 54940000
         BNE   TOTAL2              NO, BYPASS                           54990051
         SR    R6,R6                                                    55080051
         ICM   R6,X'1',REG800      GET TEMP COUNTERS                    55170051
         ICM   R7,X'3',VTEMPS      GET TOTALS                           55260051
         AR    R7,R6               SUM                                  55350051
         STCM  R7,X'3',VTEMPS      STORE                                55440051
         ICM   R6,X'3',REG700      GET IO OPERS                         55530051
         ICM   R7,X'F',VIOPS       GET TOTALS                           55620051
         AR    R7,R6                                                    55710051
         STCM  R7,X'F',VIOPS       STORE TOTALS                         55800051
         B     RETURN1                                                  55890051
TOTAL2   SR    R6,R6                                                    55980051
         ICM   R6,X'3',VPERMS      GET PERMS                            56070051
         LA    R6,L1(R6)           ADD ONE                              56160051
         STCM  R6,X'3',VPERMS      STORE                                56250051
         CLI   SRECMD,HEX10        CHANNEL ADAPTER?            @D3502BL 56340000
         BL    TOTAL1              LESS THAN, EXIT                      56430051
         CLI   RECMD,HEX10+HEX01   COMMUNICATIONS SCAN                  56520051
         BH    TOTAL3              HIGH, TOTAL AS MISC                  56610051
         SR    R6,R6                                                    56700051
         ICM   R6,X'3',VHDWR       GET HARDWARE TOTALS                  56790051
         LA    R6,L1(R6)           ADD ONE                              56880051
         STCM  R6,X'3',VHDWR       STORE                                56970051
         B     RETURN1                                                  57060051
TOTAL3   SR    R6,R6                                                    57150051
         ICM   R6,X'3',VMISC       GET MISCELLANEOUS TOTALS             57240051
         LA    R6,L1(R6)           ADD ONE                              57330051
         STCM  R6,X'3',VMISC       STORE                                57420051
         B     RETURN1                                                  57510051
TOTAL1   SR    R6,R6                                                    57600051
         ICM   R6,X'1',REG800      GET TEMP COUNTERS                    57690051
         ICM   R7,X'3',VTEMPS      GET TOTALS                           57780051
         AR    R7,R6               SUM                                  57870051
         STCM  R7,X'3',VTEMPS      STORE                                57960051
         ICM   R6,X'3',REG700      GET IO OPERS                         58050051
         ICM   R7,X'F',VIOPS       GET TOTALS                           58140051
         AR    R7,R6                                                    58230051
         STCM  R7,X'F',VIOPS       STORE TOTALS                         58320051
         MVC   STATUS,REG508       GET INITAL ERROR STATUS              58410051
         OC    STATUS,STATUS       IS IT ZERO                           58500051
         BNZ   TOTAL6              IF NO, BYPASS                        58590051
         MVC   STATUS,REG400       IF YES, USE FINAL ERROR STATUS       58680051
TOTAL6   TM    STATUS,X'10'        DATA CHECK?                 @ZA36953 58770000
         BO    TOTAL7              YES, GO TOTAL               @ZA36953 58820000
         TM    STATUS,X'20'        SYNC CHECK?                 @ZA36953 58870000
         BNO   TOTAL8              NO, GO TO NEXT TEST         @ZA36953 58920000
TOTAL7   SR    R6,R6                                                    59130051
         ICM   R6,X'3',VDATACK     GET DATA CHECK TOTALS                59220051
         LA    R6,L1(R6)           ADD ONE                              59310051
         STCM  R6,X'3',VDATACK     STORE                                59400051
         B     RETURN1                                                  59490051
TOTAL8   TM    STATUS,X'40'        STAT FORM                   @ZA36953 59580000
         BNO   TOTAL9              NO, GO TO NEXT TEST         @ZA36953 59630000
TOTAL13  SR    R6,R6                                                    59760051
         ICM   R6,X'3',VRCV        GET RECEIVER TOTALS                  59850051
         LA    R6,L1(R6)           ADD ONE                              59940051
         STCM  R6,X'3',VRCV        STORE                                60030051
         B     RETURN1                                                  60120051
TOTAL9   OC    STATUS+L2(L1),STATUS+L2 IS STATUS ZERO                   60210051
         BZ    ANALYZE             IF YES, GO TO ANALYZE SECTION        60300051
         TM    STATUS+L2,HEX80+HEX08+HEX02 OVERRUN/UNDERRUN/ABORT?      60390051
         BZ    TOTAL10             NO, GO TO NEXT TEST                  60480051
TOTAL11  SR    R6,R6                                                    60570051
         ICM   R6,X'3',VMISC       GET MISCELLANEOUS TOTALS             60660051
         LA    R6,L1(R6)           ADD ONE                              60750051
         STCM  R6,X'3',VMISC       STORE                                60840051
         B     RETURN1                                                  60930051
TOTAL10  TM    STATUS+L2,HEX40+HEX20+HEX01 LINE-QUIET/DLE/SDLC          61020051
         BZ    TOTAL11             NO, GO TOTAL AS MISCELLANEOUS        61110051
         B     TOTAL13                                                  61200051
ANALYZE  NI    STATUS+L1,X'FE'     SET LEADING GRAPHICS BIT OFF         61290051
         LA    R8,LXBSTATB         GET START OF LXB TABLE               61380051
         LA    R7,LLXBSTB          GET LENGTH OF LXB TABLE              61470051
         CLI   SRECMD,H00          IS IT A PERM LINE ERROR     @D3502BL 61560000
         BNE   TRT                 NO, GO LOOK UP IN TABLE              61650051
         LA    R8,IOBSTATB         GET START OF IOB TABLE               61740051
         LA    R7,LIOBSTB          GET LENGTH OF IOB TABLE              61830051
         CLI   STATUS+1,H00        IS IT ZERO?                          61920051
         BNE   TRT                 NO, GO LOOK UP IN TABLE              62010051
         NI    STATUS,HEX08+HEX04+HEX02 AND OFF BITS                    62100051
         CLI   STATUS,HEX04                                             62190051
         BE    TOTAL7              GO ADD TO DATA CHECK COUNTERS        62280051
         CLI   STATUS,HEX04+HEX02                                       62370051
         BNE   TOTAL11             GO ADD TO MISCELLANEOUS              62460051
         SR    R6,R6                                                    62550051
         ICM   R6,X'3',VINTRQD     GET INTERVENTION REQUIRED TOTALS     62640051
         LA    R6,L1(R6)           ADD ONE                              62730051
         STCM  R6,X'3',VINTRQD     STORE                                62820051
         B     RETURN1                                                  62910051
TRT      CLC   STATUS+L1(L1),L0(R8) CHECK FOR VALUE IN TABLE            63000051
         BE    FOUND               YES, EXIT                            63090051
         LA    R8,L2(R8)           UP TO NEXT VALUE                     63180051
         BCT   R7,TRT              LOOP                                 63270051
FOUND    SR    R7,R7                                                    63360051
         ICM   R7,X'1',L1(R8)      GET INDEX VALUE                      63450051
         LA    R7,VALUES(R7)       GET TO COUNTER                       63540051
         SR    R6,R6                                                    63630051
         ICM   R6,X'3',L0(R7)      GET COUNTER VALUE                    63720051
         LA    R6,L1(R6)           ADD ONE                              63810051
         STCM  R6,X'3',L0(R7)      STORE                                63900051
         B     RETURN1                                                  63990051
         SPACE 3                                               @D3502BL 64030000
**                                                                      64080051
**   RESTORE THE COUNTERS TO THE TABLE                                  64170051
**                                                                      64260051
RESTORE  STM   R5,R8,XSAVE1                                             64350051
         L     R6,WHEREGOT         LOAD THE COUNTER LOCATION            64440051
         MVC   L0(L34,R6),VALUES   PLACE BACK INTO TABLE       @D3502BL 64530000
         B     RETURNX                                         @D3502BL 64580000
         EJECT                                                          64630000
         DS    0D                                                       64680000
XSAVE1   DC    4F'0'                                           @D3502BL 64730000
SAVER2   DC    F'0'                                            @D3502BL 64780000
HEX00    DC    F'0'                                                     64830000
WHEREGOT DC    F'0'                                                     64880000
HWD4     DC    H'4'                                            @D3502BL 64930000
VALUES   DS    0CL34                                           @D3502BL 64980000
VTERMN   DS    CL8                                                      65250051
VRESID   DS    CL2                                                      65340051
VLIBADR  DS    CL2                                                      65430051
VIOPS    DS    CL4                                                      65520051
VTEMPS   DS    CL2                                                      65610051
VPERMS   DS    CL2                                                      65700051
VHDWR    DS    CL2                                                      65790051
VTMOUT   DS    CL2                                                      65880051
VDATACK  DS    CL2                                                      65970051
VRCV     DS    CL2                                                      66060051
VINTRQD  DS    CL2                                                      66150051
VMISC    DS    CL2                                                      66240051
VMODEM   DS    CL2                                             @D3502BL 66330000
OVERFLOW DC    8X'FF'                                          @D3502BL 66360000
STATUS   DS    CL3                                                      66420051
         EJECT                                                          66510051
IOBSTATB DC    X'E4',AL1(VHDWR-VALUES)                                  66600051
         DC    X'E8',AL1(VHDWR-VALUES)                                  66690051
         DC    X'EA',AL1(VHDWR-VALUES)                                  66780051
         DC    X'F6',AL1(VHDWR-VALUES)                         @D3502BL 66870000
         DC    X'F0',AL1(VMODEM-VALUES)                        @D3502BL 66920000
         DC    X'F2',AL1(VMODEM-VALUES)                        @D3502BL 66970000
         DC    X'F4',AL1(VMODEM-VALUES)                        @D3502BL 67020000
         DC    X'F8',AL1(VMODEM-VALUES)                        @D3502BL 67070000
         DC    X'20',AL1(VTMOUT-VALUES)                                 67230051
         DC    X'40',AL1(VTMOUT-VALUES)                                 67320051
         DC    X'60',AL1(VTMOUT-VALUES)                                 67410051
         DC    X'80',AL1(VTMOUT-VALUES)                                 67500051
         DC    X'FC',AL1(VTMOUT-VALUES)                                 67590051
         DC    X'0C',AL1(VTMOUT-VALUES)                                 67680051
         DC    X'06',AL1(VRCV-VALUES)                                   67770051
         DC    X'08',AL1(VRCV-VALUES)                                   67860051
         DC    X'0A',AL1(VRCV-VALUES)                                   67950051
         DC    X'92',AL1(VRCV-VALUES)                                   68040051
         DC    X'9A',AL1(VRCV-VALUES)                                   68130051
LIOBSTB  EQU   (*-IOBSTATB)/2                                           68220051
         DC    X'00',AL1(VMISC-VALUES)                                  68310051
LXBSTATB DC    X'E4',AL1(VHDWR-VALUES)                                  68400051
         DC    X'E8',AL1(VHDWR-VALUES)                                  68490051
         DC    X'EA',AL1(VHDWR-VALUES)                                  68580051
         DC    X'F6',AL1(VHDWR-VALUES)                         @D3502BL 68670000
         DC    X'F0',AL1(VMODEM-VALUES)                        @D3502BL 68720000
         DC    X'F2',AL1(VMODEM-VALUES)                        @D3502BL 68770000
         DC    X'F4',AL1(VMODEM-VALUES)                        @D3502BL 68820000
         DC    X'F8',AL1(VMODEM-VALUES)                        @D3502BL 68870000
         DC    X'00',AL1(VTMOUT-VALUES)                                 69030051
         DC    X'20',AL1(VTMOUT-VALUES)                                 69120051
         DC    X'60',AL1(VTMOUT-VALUES)                                 69210051
         DC    X'80',AL1(VTMOUT-VALUES)                                 69300051
         DC    X'A0',AL1(VTMOUT-VALUES)                                 69390051
         DC    X'FC',AL1(VTMOUT-VALUES)                                 69480051
         DC    X'0C',AL1(VDATACK-VALUES)                                69570051
         DC    X'0E',AL1(VDATACK-VALUES)                                69660051
         DC    X'2C',AL1(VDATACK-VALUES)                                69750051
         DC    X'2E',AL1(VDATACK-VALUES)                                69840051
         DC    X'24',AL1(VRCV-VALUES)                                   69930051
         DC    X'64',AL1(VRCV-VALUES)                                   70020051
         DC    X'A2',AL1(VRCV-VALUES)                                   70110051
         DC    X'A4',AL1(VRCV-VALUES)                                   70200051
         DC    X'A6',AL1(VRCV-VALUES)                                   70290051
LLXBSTB  EQU   (*-LXBSTATB)/2                                           70380051
         DC    X'00',AL1(VMISC-VALUES)                                  70470051
         EJECT                                                          70560051
ENTRIES  DS    0F                                                       70650051
         SPECIAL XDATE1,00000000,SPACE=4                                70740051
         SPACE 2                                               @D3502BL 70830000
         SPECIAL LOCATE,00000000,SPACE=3                                70870000
         SPACE 2                                               @D3502BL 70910000
         SPECIAL TOTAL,00000000,SPACE=4                                 70950000
         SPACE 2                                               @D3502BL 70990000
         SPECIAL RESTORE,00000000,SPACE=4                               71030000
         SPACE 2                                               @D3502BL 71070000
SUMEND   DC    X'FF'                                           @D3502BL 71110000
         EJECT                                                          71190051
*                                                                       71280051
PEDIT    DS    0F                                                       71370051
*                                                                       71460051
&DSECT   SETC  'T3705'                                                  71550051
&CSECT   SETC  'PEDIT'                                                  71640051
         USING *,9                                                      71730051
         USING &DSECT,R2                                       @D3502BL 71820000
         DC    A(PENTRY)                                                71910051
         DC    C'IFCST005'                                              72000051
YR9PTR   DS    F                                                        72090051
YLABEL   DS    F                                                        72180051
&DSECT   DSECT                                                 @D3502BL 72270000
         DS    3H                                                       72360051
         DSGEN (YDUMA,16),(YNOREC,16)                                   72450051
         DSGEN (YTYPE,8),(YCHAN,8),(YCUA,24),(YSER,24)                  72540051
         DSGEN (YCPU,16),(YSMSW,16)                                     72630051
         DSGEN (TDAY1,32),(TDAY2,32)                                    72720051
ITEM1    DSGEN (TERMN,64)                                               72810051
         DSGEN (RESID1,16),(LIBADDR1,16)                                72900051
         DSGEN (IOPS1,32)                                               72990051
         DSGEN (TEMPS1,16),(PERMS1,16)                                  73080051
         DSGEN (HDWR1,16),(TMOUT1,16),(DATACK1,16),(RCV1,16)            73170051
         DSGEN (INTRQD1,16),(MISC1,16),(MODEM1,16)             @D3502BL 73260000
TERMNO2  DS    CL34                                            @D3502BL 73310000
TERMNO3  DS    CL34                                            @D3502BL 73360000
TERMNO4  DS    CL34                                            @D3502BL 73410000
TERMNO5  DS    CL34                                            @D3502BL 73460000
TERMNO6  DS    CL34                                            @D3502BL 73510000
TERMNO7  DS    CL34                                            @D3502BL 73560000
TERMNO8  DS    CL34                                            @D3502BL 73610000
TERMNO9  DS    CL34                                            @D3502BL 73660000
TERMNO10 DS    CL34                                            @D3502BL 73710000
TERMNO11 DS    CL34                                            @D3502BL 73760000
TERMNO12 DS    CL34                                            @D3502BL 73810000
TERMNO13 DS    CL34                                            @D3502BL 73860000
TERMNO14 DS    CL34                                            @D3502BL 73910000
TERMNO15 DS    CL34                                            @D3502BL 73960000
TERMNO16 DS    CL34                                            @D3502BL 74010000
TERMNO17 DS    CL34                                            @D3502BL 74060000
TERMNO18 DS    CL34                                            @D3502BL 74110000
TERMNO19 DS    CL34                                            @D3502BL 74160000
TERMNO20 DS    CL34                                            @D3502BL 74210000
TERMNO21 DS    CL34                                            @D3502BL 74260000
TERMNO22 DS    CL34                                            @D3502BL 74310000
TERMNO23 DS    CL34                                            @D3502BL 74360000
TERMNO24 DS    CL34                                            @D3502BL 74410000
TERMNO25 DS    CL34                                            @D3502BL 74460000
TERMNO26 DS    CL34                                            @D3502BL 74510000
TERMNO27 DS    CL34                                            @D3502BL 74560000
TERMNO28 DS    CL34                                            @D3502BL 74610000
TERMNO29 DS    CL34                                            @D3502BL 74660000
TERMNO30 DS    CL34                                            @D3502BL 74710000
TERMNO31 DS    CL34                                            @D3502BL 74760000
TERMNO32 DS    CL34                                            @D3502BL 74810000
TERMNO33 DS    CL34                                            @D3502BL 74860000
TERMNO34 DS    CL34                                            @D3502BL 74910000
TERMNO35 DS    CL34                                            @D3502BL 74960000
TERMNO36 DS    CL34                                            @D3502BL 75010000
TERMNO37 DS    CL34                                            @D3502BL 75060000
TERMNO38 DS    CL34                                            @D3502BL 75110000
TERMNO39 DS    CL34                                            @D3502BL 75160000
TERMNO40 DS    CL34                                            @D3502BL 75210000
TERMNO41 DS    CL34                                            @D3502BL 75260000
TERMNO42 DS    CL34                                            @D3502BL 75310000
TERMNO43 DS    CL34                                            @D3502BL 75360000
TERMNO44 DS    CL34                                            @D3502BL 75410000
TERMNO45 DS    CL34                                            @D3502BL 75460000
TERMNO46 DS    CL34                                            @D3502BL 75510000
TERMNO47 DS    CL34                                            @D3502BL 75560000
TERMNO48 DS    CL34                                            @D3502BL 75610000
TERMNO49 DS    CL34                                            @D3502BL 75660000
TERMNO50 DS    CL34                                            @D3502BL 75710000
TERMNO51 DS    CL34                                            @D3502BL 75760000
TERMS    DS    150CL34                                         @VS48714 75810000
TABSIZE  EQU   (*-T3705)                                                77850051
TABSIZE1 EQU   (*-TDAY1)/2                                              77940051
         EJECT                                                          78030051
IFCST005 CSECT                                                          78120051
*                                                                       78210051
*        CHECK FOR CPU AND SERIAL NUMBER                                78300051
*                                                                       78390051
SETCPUNO STM   R5,R8,XSAVE             SAVE REGS                        78480051
         SR    R5,R5                   CLEAR REG 5                      78570051
         IC    R5,L0(R4)               PICK UP MODEL NUMBER             78660051
         SLL   R5,L8                    INTO                            78750051
         IC    R5,L1(R4)               R5                               78840051
         LTR   R5,R5                   TEST FOR ZERO                    78930051
         BNZ   RETURN                  RETURN                           79020051
         LR    R5,R3                   PUT LINE ADDRESS IN R5           79110051
         LA    R6,L46                  OFFSET IN REG 6                  79200051
         SR    R5,R6                   SUBTRACT OFFSET FROM POINTER     79290051
         MVC   L0(L6,R5),SHARED         PUT IN SHARED          @Z427VLS 79380051
RETURN   LM    R5,R8,XSAVE                                              79470051
SKIPPER  BR    R14                 NOP RETURN                           79560051
         SPACE 3                                               @D3502BL 79600000
*                                                                       79650051
*        SET THE DATE READY FOR PRINT                                   79740051
*                                                                       79830051
SETDATE  UNPK  XSAVE(L8),L1(L3,R4)     UNPACK THE DATE                  79920051
         MVC   L0(L3,R3),XSAVE+L5      MOVE DAY                         80010051
         MVC   L6(L2,R3),XSAVE+L3      MOVE YEAR                        80100051
         BR    R14                                                      80190051
         SPACE 3                                               @D3502BL 80230000
**                                                                      80280051
**    FREE THIS SET OF COUNTERS AND CHECK FOR ANOTHER SET.  IF          80370051
**    YES, GO TO PRINT THE NEXT SET OF COUNTERS.                        80460051
**                                                                      80550051
THEEND   STM   R14,R12,L12(R13)    SAVE ALL REGISTERS                   80640051
         LR    R12,R13             SAVE THE SAVE ADDRESS                80730051
         LA    R13,FSAVE           POINT TO MY SAVE                     80820051
         ST    R12,L4(R13)         SET CHAINING POINTERS                80910051
         ST    R13,L8(R12)                                              81000051
         L     R3,L4(R2)           PICK UP POINTER TO NEXT COUNTER      81090051
         LH    R0,SIZE             PICK UP SIZE OF AREA                 81180051
         LR    R1,R2               SET ADDRESS                          81270051
         FREEMAIN R,LV=(0),A=(1)                                        81360051
         LTR   R3,R3               ANY MORE COUNTERS                    81450051
         BZ    RETURNO             NO RETURN                            81540051
         LA    R5,PENTRY+L10       POINT TO TOP ENTRY LESS 4            81630051
         ST    R5,YR9PTR                                                81720051
         ST    R3,L28(R12)         SAVE POINTER IN REG SIZE   @ZA00435  81810051
         LA    R5,LABELS-L1        POINT TO FIRST LABEL LESS 1          81900051
         ST    R5,YLABEL           STORE IT IN TABLE                    81990051
RETURNO  L     R13,L4(R13)         PICK UP &                            82080051
         LM    R14,R12,L12(R13)    RESTORE REGS                         82170051
         XC    VALINDX,VALINDX     CLEAR THE INDEX                      82260051
         BR    R14                                                      82350051
         SPACE 3                                               @D3502BL 82440000
MVCNAME  MVC   L0(L8,R3),TERMN     TERMINAL NAME                        82490000
         LA    R3,L3(R3)           INCREMENT LINE POINTER BY THREE      82540000
         BR    R14                                                      82590000
         SPACE 3                                               @D3502BL 82640000
SUB12    SH    R3,TWELVE           DECREMENT THE LINE POINTER           82890051
         BR    R14                 EXIT                                 82980051
SUB5     SH    R3,FIVE             DECREMENT THE LINE POINTER           83070051
         BR    R14                 EXIT                                 83160051
SUB8     SH    R3,EIGHT            DECREMENT THE LINE POINTER           83250051
         BR    R14                 EXIT                                 83340051
SUB7     SH    R3,SEVEN            DECREMENT THE LINE POINTER           83430051
         BR    R14                 EXIT                                 83520051
         SPACE 3                                               @D3502BL 83560000
**                                                                      83610051
**   CHECK FOR THE NEXT ENTRY IN THE TABLE.  IF THERE IS ONE,           83700051
**   LOOP BACK TO PRINT IT.  IF NOT, TERMINATE THE SUMMARY SECTION.     83790051
**                                                                      83880051
NEXTVAL  STM   R5,R8,XSAVE         SAVE REGISTERS                       83970051
         L     R5,VALINDX          INDEX INTO TABLE                     84060051
         LA    R5,L34(R5)          NEXT ENTRY                  @D3502BL 84150000
         ST    R5,VALINDX          SAVE                                 84200000
         LA    R6,TERMN(R5)        ADDRESS OF START            @D3502BL 84250000
         CLC   TERMN(L8),OVERFL    IS THIS THE 51ST ENTRY               84300000
         BE    THATSIT             YES,EXIT                             84350000
         MVC   TERMN(L34),L0(R6)                               @D3502BL 84400000
         OC    TERMN(L12),TERMN    IS THE NAME ZEROS                    84780051
         BZ    THATSIT             IF YES, EXIT                         84870051
         LA    R6,OUTLOOP-L4                                            84960051
         LA    R7,OUTLOOP1-L1                                           85050051
         STM   R6,R7,YR9PTR        SAVE NEW POINTERS                    85140051
THATSIT  LM    R5,R8,XSAVE                                              85230051
         SR    R15,R15             DONT PRINT THE LINE                  85320051
         BR    R14                                                      85410051
         SPACE 3                                               @D3502BL 85500000
SORTT    DS    0H                                              @D3502BL 85504000
         STM   R5,R8,XSAVE             SAVE REGS               @D3502BL 85508000
SORTL0   LR    R5,R4                   POINT R5 TO FIRST ENTRY @D3502BL 85512000
         XR    R8,R8                   USE TO INDICATE END OF SORT      85516000
SORTL1   OC    34(8,R5),34(R5)         NEXT ENTRY EMPTY?       @D3502BL 85520000
         BZ    ENDPASS                 YES...                  @D3502BL 85524000
         CLC   34(8,R5),OVERFL         TABLE OVERFLOW?         @D3502BL 85528000
         BE    ENDPASS                 YES...                  @D3502BL 85532000
         CLC   0(8,R5),34(R5)          COMPARE TRMINAL NAMES   @D3502BL 85536000
         BNH   NOSWAP                  DON'T SWAP              @D3502BL 85540000
         XC    0(34,R5),34(R5)         SWAP                    @D3502BL 85544000
         XC    34(34,R5),0(R5)             THE                 @D3502BL 85548000
         XC    0(34,R5),34(R5)                ENTRIES          @D3502BL 85552000
         LA    R8,1                    INDICATE SWAP           @D3502BL 85556000
NOSWAP   LA    R5,34(R5)               POINT TO NEXT ENTRY     @D3502BL 85560000
         B     SORTL1                                          @D3502BL 85564000
ENDPASS  LTR   R8,R8                   SORT DONE?              @D3502BL 85568000
         BZ    RETURN                  YES...                  @D3502BL 85572000
         B     SORTL0                                          @D3502BL 85576000
         SPACE 3                                               @D3502BL 85580000
         DS    0D                                                       85590051
XSAVE    DC    5F'0'                                                    85680051
FSAVE    DS    18F                                                      85770051
VALINDX  DC    F'0'                                                     85860051
TWELVE   DC    H'12'                                                    85950051
FIVE     DC    H'5'                                                     86040051
SEVEN    DC    H'7'                                                     86130051
EIGHT    DC    H'8'                                                     86220051
SIZE     DC    AL2(TABSIZE)                                             86310051
OVERFL   DC    8X'FF'                                          @D3502BL 86400000
SHARED   DC    C'SHARED'                                                86490051
         EJECT                                                          86580051
PENTRY   DS    0F                                                       86670051
         DC    X'00010001'                                              86760051
         DC    X'00010001'                                              86850051
         DC    A(LABELS)                                                86940051
         DC    H'0'                                                     87030051
         DC    X'01'                                                    87120051
         DC    X'000B8B00'                                              87210051
         LABEL ' '                                                      87300051
         SPACE 2                                               @D3502BL 87340000
         LINE  (77,23),(1,88),SKIP=2                                    87390051
         HEX   YCPU,0,2B                                                87480051
         HEX   YSER,0,3B                                                87570051
         ROUTINE  YCPU,SETCPUNO                                         87660051
         LABEL '---SUMMARY OF ENTRY TYPE - 3705 MDR        DEVICE TYPE C87750051
               3705          MODEL-','SERIAL NO.'                       87840051
         SPACE 2                                               @D3502BL 87930000
         LINE  ,(16,13),SKIP=1                                          87960000
         LABEL 'DAY YEAR','DAY YEAR'                                    87990000
         SPACE 2                                               @D3502BL 88020000
         LINE  (16,13),(4,21),SKIP=2                                    88110051
         ROUTINE  TDAY1,SETDATE                                         88200051
         ROUTINE  TDAY2,SETDATE                                         88290051
         LABEL 'DATE RANGE-','TO'                                OM5193 88380051
         SPACE 2                                               @D3502BL 88420000
         LINE  (26,49),(5,45)                                           88470051
         HEX   YCUA,0,3B                                                88560051
         CONVT YNOREC                                                   88650051
         LABEL 'CHANNEL UNIT ADDRESS','TOTAL NUMBER OF RECORDS'         88740051
         SPACE 2                                               @D3502BL 88830000
         LINE  ,,SKIP=1                                                 88880000
         LABEL ' '                                                      88930000
         SPACE 2                                               @D3502BL 88980000
         LINE  ,(64,30)                                        @D3502BL 89030000
         LABEL '- - - - - - - - - - PERMANENT ERROR TYPES - - - - - - -X89080000
                - - -'                                         @D3502BL 89130000
         SPACE 2                                               @D3502BL 89180000
         LINE  ,(20,10)                                                 89230000
         LABEL 'LIB',' ',' TEMP',' PERM',,,,,,,'MODEM/'        @D3502BL 89280000
         SPACE 2                                               @D3502BL 89330000
         LINE  ,(1,30)                                                  89380000
         LABEL 'TERM NAME   RID   ADDR    # I/',               @D3502BLX89430000
               'O OPS    ERRORS    ERRORS     ',                       X89480000
               '  HDWR    TM OUT   DATA CK   ',                        X89530000
               '  RCV    ITV RQD    MISC     INTFC'            @D3502BL 89580000
         SPACE 2                                               @D3502BL 89630000
         LINE                                                           89680000
         ROUTINE TERMN,SORTT                                   @D3502BL 89730000
         LABEL ' '                                                      89780000
         SPACE 2                                               @D3502BL 89830000
OUTLOOP  LINE  (1,9),(60)                                               90090051
         ROUTINE TERMN,MVCNAME                                          90180051
         HEX   RESID1,0,2B                                              90270051
         ROUTINE TERMN,SUB12                                            90360051
         HEX   LIBADDR1,0,2B                                            90450051
         CONVT IOPS1,4,8                                                90540051
         ROUTINE TERMN,SUB5                                             90630051
         CONVT TEMPS1,2,6                                               90720051
         ROUTINE TERMN,SUB8                                             90810051
         CONVT PERMS1,2,6                                               90900051
         ROUTINE TERMN,SUB5                                             90990051
         CONVT HDWR1,2,5                                                91080051
         CONVT TMOUT1,2,5                                               91170051
         CONVT DATACK1,2,5                                              91260051
         ROUTINE TERMN,SUB7                                             91350051
         CONVT RCV1,2,5                                                 91440051
         CONVT INTRQD1,2,5                                              91530051
         CONVT MISC1,2,5                                                91620051
         CONVT MODEM1,2,5                                      @D3502BL 91710000
OUTLOOP1 LABEL '%%'                                                     91760000
         SPACE 2                                               @D3502BL 91810000
         LINE                                                           91860000
         ROUTINE TERMN,NEXTVAL                                          91910000
         LABEL ' '                                                      91960000
         SPACE 2                                               @D3502BL 92010000
         LINE                                                           92060000
         ROUTINE TERMN,THEEND                                           92110000
         LABEL ' '                                                      92160000
         SPACE 2                                               @D3502BL 92210000
         DC    X'FF'                                                    92340051
         DC    XL2'0000'                                                92430051
         DC    XL2'0018'                                                92520051
         DC    XL2'0000'                                                92610051
         EJECT ,                                               @D3502BL 92700000
         DC    C'$'                                                     92790051
LABELS   EQU   *                                                        92880051
         LSTART                                                         92970051
         END                                                            93060051
