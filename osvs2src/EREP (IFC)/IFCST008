         SPACE 2                                                        00060042
*  LINE MACRO     LINE MACRO     LINE MACRO     LINE MACRO            * 00120042
         MACRO                                                          00180042
&NAME    LINE  &DATA,&LABEL,&SKIP=                                      00240042
.*                            THIS MACRO ESTABLISHES THE MARGINS OR     00300042
.*                                 COLUMN SETTINGS FOR EACH LINE. IT    00360042
.*                                 GENERATES NECESSARY CARRIAGE CONTROL 00420042
.*                                 ENTRIES. LASTLY IT DETERMINES THE    00480042
.*                                 NUMBER OF ENTRIES ASSOCIATED WITH    00540042
.*                                 THE PREVIOUS LINE AND STORES THAT #  00600042
.*                                 INTO THE APPROPRIATE BYTE.           00660042
.*                            &DATA(1) - CHARACTER POSITION TO BEGIN    00720042
.*                                 DATA.                                00780042
.*                            &DATA(2) - # OF SPACES BETWEEN SUCCESSIVE 00840042
.*                                 DATA COLUMN STARTING CHARACTERS.     00900042
.*                            &LABEL(1) - CHAR. POS. TO BEGIN LABELS.   00960042
.*                            &LABEL(2) - # SPACES BETWEEN LINE'S LABEL 01020042
.*                                 STARTING CHARACTERS.                 01080042
.*                            &SKIP= - # OF LINES TO ADVANCE CARRIAGE   01140042
.*                                 TO BEGIN NEXT PRINTED LINE.          01200042
.*                            NEW ENTRIES ARE GENERATED ONLY WHEN       01260042
.*                                 NECESSARY. OMISSION OF ITEMS MEANS   01320042
.*                                 THEY HAVE NOT CHANGED SINCE PREVIOUS 01380042
.*                                 SETTINGS. A LINE MACRO IS REQUIRED   01440042
.*                                 FOR EACH PRINTED LINE. IF NO SETTING 01500042
.*                                 CHANGES ARE REQUIRED ALL OPERANDS    01560042
.*                                 ARE OMITTED IN WHICH CASE ONLY THE   01620042
.*                                 # OF ENTRIES FOR THE PREVIOUS LINE   01680042
.*                                 IS COMPUTED. THIS MACRO MUST BE THE  01740042
.*                                 FIRST MACRO INSTRUCTION ISSUED FOR   01800042
.*                                 THE SUBJECT LINE                     01860042
         GBLA  &DB,&DT,&LB,&LT,&NRENTS                                  01920042
         GBLA  &LASTCC,&INITIAL                                         01980042
         GBLC  &NRENTSX                                                 02040042
         GBLC  &CARRCON                                                 02100042
         GBLB  &TEST                                                    02160042
         LCLA  &S                                                       02220042
&NAME    DS    0C                                                       02280042
         AIF   (&INITIAL EQ 0).FIRSTLN                                  02340042
         LINEND                                                         02400042
         AGO   .NTFIRST                                                 02460042
.FIRSTLN ANOP                                                           02520042
&NRENTSX SETC  'N&SYSNDX'                                               02580042
&INITIAL SETA  1                                                        02640042
N&SYSNDX EQU   *                                                        02700042
.NTFIRST ANOP                                                           02760042
         DC    AL1(0)                                                   02820042
         AIF   ('&DATA(1)' EQ '').CKDTABS                               02880042
         AIF   (&DATA(1) EQ &DB).CKDTABS                                02940042
&DB      SETA  &DATA(1)                                                 03000042
         AGO   .AA                                                      03060042
.CKDTABS AIF   ('&DATA(2)' EQ '').NCDATA                                03120042
         AIF   (&DATA(2) EQ &DT).NCDATA                                 03180042
         AGO   .CC                                                      03240042
.AA      AIF   ('&DATA(2)' EQ '').BB                                    03300042
         AIF   (&DATA(2) EQ &DT).BB                                     03360042
.CC      ANOP                                                           03420042
&DT      SETA  &DATA(2)                                                 03480042
.BB      DC    XL2'FFFE'                                                03540042
         DC    FL1'&DB'                                                 03600042
         DC    FL1'&DT'                                                 03660042
&NRENTS  SETA  &NRENTS+1                                                03720042
.NCDATA  ANOP                                                           03780042
         AIF   ('&LABEL(1)' EQ '').CKLTABS                              03840042
         AIF   (&LABEL(1) EQ &LB).CKLTABS                               03900042
&LB      SETA  &LABEL(1)                                                03960042
         AGO   .AAA                                                     04020042
.CKLTABS AIF   ('&LABEL(2)' EQ '').NCLABEL                              04080042
         AIF   (&LABEL(2) EQ &LT).NCLABEL                               04140042
         AGO   .CCC                                                     04200042
.AAA     AIF   ('&LABEL(2)' EQ '').BBB                                  04260042
         AIF   (&LABEL(2) EQ &LT).BBB                                   04320042
.CCC     ANOP                                                           04380042
&LT      SETA  &LABEL(2)                                                04440042
.BBB     DC    XL2'FFFF'                                                04500042
         DC    FL1'&LB'                                                 04560042
         DC    FL1'&LT'                                                 04620042
&NRENTS  SETA  &NRENTS+1                                                04680042
.NCLABEL ANOP                                                           04740042
         AIF   ('&SKIP' NE '').CONT                                     04800042
         AIF   (&TEST EQ 0).NOCHANG                                     04860042
&S       SETA  &LASTCC                                                  04920042
         AGO   .DEFAULT                                                 04980042
.CONT    ANOP                                                           05040042
         AIF   (&TEST EQ 0).AB                                          05100042
&S       SETA  &SKIP                                                    05160042
.DEFAULT ANOP                                                           05220042
         ORG   &CARRCON+3                                               05280042
         DC    AL.3(0),AL.2(&S),AL.3(1)                                 05340042
         ORG                                                            05400042
&LASTCC  SETA  &S                                                       05460042
&TEST    SETB  0                                                        05520042
         AGO   .DD                                                      05580042
.AB      AIF   (&SKIP EQ &LASTCC).NOCHANG                               05640042
A&SYSNDX DC    XL2'FFFB'                                                05700042
         DC    AL.3(0),AL.2(&SKIP),AL.3(1)                              05760042
         DC    FL1'9'                                                   05820042
&LASTCC  SETA  &SKIP                                                    05880042
&TEST    SETB  1                                                        05940042
&CARRCON SETC  'A&SYSNDX'                                               06000042
&NRENTS  SETA  &NRENTS+1                                                06060042
.DD      ANOP                                                           06120042
.NOCHANG ANOP                                                           06180042
         MEND                                                           06240042
         EJECT                                                          06300042
         SPACE 2                                                        06360042
*  ROUTINE MACRO     ROUTINE MACRO     ROUTINE MACRO     ROUTINE MACRO* 06420042
         MACRO                                                          06480042
&NAME    ROUTINE &LOGITEM,&RNAME                                        06540042
         GBLC  &DSECT,&CSECT                                            06600042
         GBLC  &ITEM(1000)                                              06660042
         GBLA  &SHIFT(1000),&ITEMNBR                                    06720042
         GBLA  &NRENTS                                                  06780042
         LCLA  &ISHIFT,&NDX                                             06840042
.LOOP    ANOP                                                           06900042
&NDX     SETA  &NDX+1                                                   06960042
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      07020042
         AIF   (&NDX LT &ITEMNBR).LOOP                                  07080042
         MNOTE *,'LOG ITEM NOT DEFINED'                                 07140042
         MEXIT                                                          07200042
.FOUND   ANOP                                                           07260042
&ISHIFT  SETA  &SHIFT(&NDX)                                             07320042
&NAME    DC    AL.12(&LOGITEM-&DSECT),XL.4'D'                           07380042
         DC    AL.4(&ISHIFT),AL.12(&RNAME-&CSECT)                       07440042
&NRENTS  SETA  &NRENTS+1                                                07500042
         MEND                                                           07560042
*  DSGEN MACRO     DSGEN MACRO     DSGEN MACRO     DSGEN MACRO        * 07620042
         SPACE 2                                                        07680042
         MACRO                                                          07740042
&NAME    DSGEN &X1,&X2,&X3,&X4,&X5,&X6,&X7,&X8,&X9,&X10,&X11,&X12,&X13,X07800042
               &X14,&X15,&X16,&X17,&X18,&X19,&X20,&X21,&X22,&X23,&X24, X07860042
               &X25,&X26,&X27,&X28,&X29,&X30,&X31,&X32                  07920042
.*                            THIS MACRO GENERATES ONE DSECT WORD       07980042
.*                                 FORMATTED FOR THE SUBJECT LOG RECORD 08040042
.*                                 EACH OPERAND HAS TWO SUB LISTS. THE  08100042
.*                                 FIRST IS THE NAME OF THE LOG ITEM    08160042
.*                                 WHILE THE SECOND IS THE # OF BITS TO 08220042
.*                                 ALLOCATE FOR THIS ITEM. ITEMS MUST   08280042
.*                                 BE DEFINED CONTIGUOUSLY WITHOUT GAPS 08340042
.*                                 UNUSED BIT GROUPS MUST BE GIVEN      08400042
.*                                 DUMMY NAMES. THE NAMES PROVIDED FOR  08460042
.*                                 THE LOG ITEMS MAY THEN BE USED IN    08520042
.*                                 THE CONVERSION MACRO INSTRUCTIONS.   08580042
         GBLC &ITEM(1000)                                               08640042
         GBLA &ITEMNBR,&BITS(1000),&SHIFT(1000)                         08700042
         LCLC  &SYMBOL                                                  08760042
         LCLA  &OP,&COUNT,&BYTE                                         08820042
.LOOP    ANOP                                                           08880042
&OP      SETA  &OP+1                                                    08940042
&ITEMNBR SETA  &ITEMNBR+1                                               09000042
&SYMBOL  SETC  '&SYSLIST(&OP,1)'                                        09060042
         AIF   ('&SYSLIST(&OP,2)' NE '').OK1                            09120042
         MNOTE *,'NULL BIT COUNT FIELD'                                 09180042
         MEXIT                                                          09240042
.OK1     ANOP                                                           09300042
         AIF   ('&SYMBOL' NE '').OK                                     09360042
         MNOTE 'LOG ITEM SYMBOL NOT PROVIDED'                           09420042
         AGO   .CNT                                                     09480042
.OK      ANOP                                                           09540042
         AIF   ('&SYMBOL'(1,1) EQ '''').CNT                *TEMP*       09600042
&SYMBOL  EQU   *+&BYTE                                                  09660042
&ITEM(&ITEMNBR)  SETC '&SYSLIST(&OP,1)'                                 09720042
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2)                                    09780042
&SHIFT(&ITEMNBR) SETA &COUNT-&BYTE*8                                    09840042
.CNT     ANOP                                                           09900042
&COUNT   SETA  &COUNT+&SYSLIST(&OP,2)                                   09960042
&BYTE    SETA  &COUNT/8                                                 10020042
         AIF (&OP LT N'&SYSLIST).LOOP                                   10080042
         AIF   (&COUNT NE 32).NOT32                                     10140042
&NAME    DS    4C                                                       10200042
         MEXIT                                                          10260042
.NOT32   AIF   (&COUNT NE 64).ERR                                       10320042
&NAME    DS    8C                                                       10380042
         MEXIT                                                          10440042
.ERR     MNOTE '**BIT COUNT FIELDS DO NOT TOTAL 32 OR 64**'             10500042
         MEND                                                           10560042
         MACRO                                                          10620042
         LINEND                                                         10680042
.*                            THIS MACRO IS USED ONLY BY THE LINE       10740042
.*                                 MACRO TO SET THE NUMBER OF ENTRIES   10800042
.*                                 ASSOCIATED WITH EACH LINE.           10860042
         GBLA  &NRENTS                                                  10920042
         GBLC &NRENTSX                                                  10980042
         ORG   &NRENTSX                                                 11040042
         DC    FL1'&NRENTS'                                             11100042
         ORG                                                            11160042
&NRENTS  SETA  0                                                        11220042
B&SYSNDX EQU   *                                                        11280042
&NRENTSX SETC  'B&SYSNDX'                                               11340042
         MEND                                                           11400042
         SPACE 2                                                        11460042
         EJECT                                                          11520042
*  LABEL MACRO     LABEL MACRO     LABEL MACRO     LABEL MACRO        * 11580042
         SPACE 2                                                        11640042
         MACRO                                                          11700042
&NAME    LABEL &LABEL1,&LABEL2,&LABEL3,&LABEL4,&LABEL5,&LABEL6,        C11760042
               &LABEL7,&LABEL8                                          11820042
.*                            THIS MACRO ALLOWS UP TO ACHT LABELS TO    11880042
.*                                 BE SPECIFIED FOR A GIVEN LINE. THE   11940042
.*                                 LABELS SHOULD BE ENCLOSED IN QUOTA-  12000042
.*                                 TION MARKS. THE COLUMN AND LINE END  12060042
.*                                 CONTROLS WILL BE INSERTED BY THE     12120042
.*                                 MACRO. OMITTED OPERANDS MEAN NO      12180042
.*                                 LABEL REQUIRED FOR RESPECTIVE        12240042
.*                                 COLUMN. THIS MACRO WILL ALSO ALERT   12300042
.*                                 THE PROGRAMMER TO EXACTLY WHERE THE  12360042
.*                                 TABLE MUST BE BROKEN IF NECESSARY    12420042
.*                                 TO AVOID EXCEEDING THE MAXIMUM LIMIT 12480042
         GBLC &LABELS(2000)                                             12540042
         GBLC  &LBL(100)                                                12600042
         GBLA  &LBLCTR(100)                                             12660042
         GBLA  &LABELNR                                                 12720042
         GBLA  &NRENTS,&LPTR                                            12780042
         LCLC  &MARGIN,&TACK                                            12840042
         LCLC  &TEXT                                                    12900042
         LCLA  &OP,&K,&START,&NRCHAR,&REMAIN                            12960042
&MARGIN  SETC  '*'                                                      13020042
         AIF   ('&NAME' EQ '').LOOPOUT                                  13080042
&LPTR    SETA  &LPTR+1                                                  13140042
&LBL(&LPTR) SETC '&NAME'                                                13200042
&LBLCTR(&LPTR) SETA &LABELNR+1                                          13260042
.LOOPOUT ANOP                                                           13320042
&OP      SETA  &OP+1                                                    13380042
&K       SETA  K'&SYSLIST(&OP)                                          13440042
         AIF (&K GE 2).NORM                                             13500042
&K       SETA  2                                                        13560042
.NORM    ANOP                                                           13620042
&START   SETA  2                                                        13680042
         AIF (&OP LT N'&SYSLIST).NOTLAST                                13740042
&MARGIN  SETC  '$'                                                      13800042
.NOTLAST ANOP                                                           13860042
&NRCHAR  SETA  8                                                        13920042
&TACK    SETC  ''                                                       13980042
.LOOPIN  ANOP                                                           14040042
&REMAIN  SETA  &K-&START                                                14100042
         AIF (&REMAIN GE 8).MORE                                        14160042
&TACK    SETC  '&MARGIN'                                                14220042
&NRCHAR  SETA  &REMAIN                                                  14280042
.MORE    ANOP                                                           14340042
&TEXT    SETC  ''                                                       14400042
         AIF (&REMAIN EQ 0).ENDTEXT                                     14460042
&TEXT    SETC  '&SYSLIST(&OP)'(&START,&NRCHAR)                          14520042
.ENDTEXT ANOP                                                           14580042
&LABELNR SETA  &LABELNR+1                                               14640042
&LABELS(&LABELNR) SETC '&TEXT'.'&TACK'                                  14700042
&START   SETA  &START+8                                                 14760042
         AIF ('&TACK' EQ '').LOOPIN                                     14820042
         AIF ('&TACK' EQ '*').LOOPOUT                                   14880042
         MEND                                                           14940042
         SPACE 2                                                        15000042
         MACRO                                                          15060042
         LSTART                                                         15120042
.*                            THIS MACRO IS ISSUED WHEN THE LABEL AREA  15180042
.*                                 OF THE TABLE IS TO BEGIN.            15240042
         GBLC &LABELS(2000)                                             15300042
         GBLA  &LABELNR                                                 15360042
         GBLC  &LBL(100)                                                15420042
         GBLA  &LBLCTR(100)                                             15480042
         LCLA  &NDX,&CTR                                                15540042
         LINEND                                                         15600042
&CTR     SETA  1                                                        15660042
.LOOP    ANOP                                                           15720042
&NDX     SETA  &NDX+1                                                   15780042
         AIF   (&LBLCTR(&CTR) NE &NDX).NOLBL                            15840042
&LBL(&CTR) DC  C'&LABELS(&NDX)'                                         15900042
&CTR     SETA  &CTR+1                                                   15960042
         AGO   .LOOPCTL                                                 16020042
.NOLBL   ANOP                                                           16080042
         DC    C'&LABELS(&NDX)'                                         16140042
.LOOPCTL AIF   (&NDX LT &LABELNR).LOOP                                  16200042
         MEND                                                           16260042
         SPACE 2                                                        16320042
*  BIN MACRO     BIN MACRO     BIN MACRO     BIN MACRO     BIN MACRO  * 16380042
         SPACE 2                                                        16440042
         MACRO                                                          16500042
         BIN   &LOGITEM,&SKIP$OR                                        16560042
.*                                 &LOGITEM - NAME OF ITEM IN LOG       16620042
.*                                      RECORD DSECT                    16680042
.*                                 &SKIP$OR - NBR OF SPACES TO SKIP ON  16740042
.*                                 MULTIPLE PRINT OR NBR OF SPACES      16800042
.*                                      TO BACK UP FROM COLUMN FOR      16860042
.*                                      START OF PRINTING. THE LETTER   16920042
.*                                      B PRECEEDS THE NUMBER (B5) IF   16980042
.*                                      THE LATTER IS DESIRED. OMISSION 17040042
.*                                      OF THIS OPERAND FORCES OPTION 2 17100042
.*                                      WITH BACKUP SPACING EQUAL TO    17160042
.*                                 THE NUMBER OF BITS IN THE ITEM       17220042
.*                                 DEFINITION (VIA MACRO 'DSGEN').      17280042
.*                            A LIMIT OF 15 BITS IS IMPOSED FOR THE     17340042
.*                                 TOTAL NUMBER OF BITS TO PRINT.       17400042
         GBLC &ITEM(1000)                                               17460042
         GBLA &ITEMNBR,&BITS(1000),&SHIFT(1000),&NRENTS                 17520042
         GBLC  &DSECT                                                   17580042
         LCLB  &B                                                       17640042
         LCLA  &IBITS,&NDX,&ISHIFT,&K                                   17700042
         LCLA  &TEMP,&T                                                 17760042
         LCLC  &S                                                       17820042
.LOOP    ANOP                                                           17880042
&NDX     SETA  &NDX+1                                                   17940042
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      18000042
         AIF   (&NDX LT &ITEMNBR).LOOP                                  18060042
         MNOTE *,'YOU BLEW IT'                                          18120042
         ROUTINE DUM,SKIPPER                                            18180042
         MEXIT                                                          18240042
.FOUND   ANOP                                                           18300042
&ISHIFT  SETA  &SHIFT(&NDX)                                             18360042
&IBITS   SETA  &BITS(&NDX)                                              18420042
&T       SETA  &IBITS-1                                                 18480042
&B       SETB  0                                                        18540042
         AIF   ('&SKIP$OR' EQ '').BACKUP                                18600042
&K       SETA  K'&SKIP$OR                                               18660042
&B       SETB  ('&SKIP$OR'(1,1) EQ 'B')                                 18720042
&S       SETC  '&SKIP$OR'(&B+1,&K-&B)                                   18780042
&T       SETA  &S                                                       18840042
.BACKUP  ANOP                                                           18900042
&NRENTS  SETA  &NRENTS+1                                                18960042
&TEMP    SETA  &ISHIFT                                                  19020042
A&SYSNDX DC    AL.12(&LOGITEM-&DSECT),XL.4'&TEMP'                       19080042
         AIF (&IBITS EQ 1 AND &B EQ 0).OUT                              19140042
         ORG   A&SYSNDX                                                 19200042
&B       SETB  1                                                        19260042
         DC    AL.12(&LOGITEM-&DSECT),XL.4'C'                           19320042
         DC    BL.1'&B',AL.7(&T),AL.4(&IBITS),FL.4'&ISHIFT'             19380042
.OUT     ANOP                                                           19440042
         MEND                                                           19500042
         EJECT                                                          19560042
*  HEX MACRO     HEX MACRO     HEX MACRO    HEXN MACRO     HEX MACRO  * 19620042
         SPACE 2                                                        19680042
         MACRO                                                          19740042
         HEX   &LOGITEM,&SKIP$OR,&BYTES                                 19800042
.*                            THIS MACRO FACILITATES GENERATION OF THE  19860042
.*                                 TABLE ENTRIES SPECIFYING HEX TYPE    19920042
.*                                 CONVERSIONS.                         19980042
.*                            &LOGITEM - NAME OF DATA ITEM TO BE        20040042
.*                                 CONVERTED                            20100042
.*                            &SKIP$OR - NUMBER OF SPACES TO SKIP ON    20160042
.*                                 MULTIPLE PRINT OR NBR OF SPACES TO   20220042
.*                                 BACK UP FROM COLUMN FOR START OF     20280042
.*                                 PRINTING. THE LETTER B PRECEEDS THE  20340042
.*                                 NUMBER (B8) IF THE LATTER OPTION IS  20400042
.*                                 DESIRED. OMISSION OF THIS OPERAND    20460042
.*                                 FORCES OPTION 2 WITH BACKUP SPACING  20520042
.*                                 EQUAL TO THE NUMBER OF BYTES SPECI-  20580042
.*                                 FIED BY THE NEXT OPERAND (TWICE THIS 20640042
.*                                 NUMBER IF SUFFIX IS EXPLICITLY OR    20700042
.*                                 IMPLICITLY B).                       20760042
.*                            &BYTES - NUMBER OF TOTAL INPUT BYTES TO   20820042
.*                                 PROCESS. THIS NUMBER IS SUFFIXED     20880042
.*                                 WITH AN L,R, OR B TO STIPULATE       20940042
.*                                 PRINTING OF THE LEFT HALF, RIGHT     21000042
.*                                 HALF, OR BOTH HALVES OF THE BYTE     21060042
.*                                 RESPECTIVELY. OMISSION OF THIS       21120042
.*                                 OPERAND DEFAULTS TO B WITH THE NUM-  21180042
.*                                 BER OF BYTES EQUAL TO THE ITEM LNGTH 21240042
.*                            A NEW ENTRY IS GENERATED ONLY WHEN NECES- 21300042
.*                                 SARY. THIS MACRO MUST BE THE FIRST   21360042
.*                                 MACRO INSTRUCTION ISSUED FOR THE     21420042
.*                                 SUBJECT LINE(S).                     21480042
         GBLC &ITEM(1000),&DSECT                                        21540042
         GBLA &ITEMNBR,&BITS(1000),&SHIFT(1000),&NRENTS                 21600042
         LCLB  &B                                                       21660042
         LCLA  &IBITS,&NDX,&ISHIFT,&K,&T,&CODE,&BYTESP                  21720042
         LCLC  &S,&LETTER                                               21780042
.LOOP    ANOP                                                           21840042
&NDX     SETA  &NDX+1                                                   21900042
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      21960042
         AIF   (&NDX LT &ITEMNBR).LOOP                                  22020042
         MNOTE *,'LOG ITEM NOT DEFINED'                                 22080042
         MEXIT                                                          22140042
.FOUND   ANOP                                                           22200042
&ISHIFT  SETA  &SHIFT(&NDX)                                             22260042
&IBITS   SETA  &BITS(&NDX)                                              22320042
&CODE    SETA  1                                                        22380042
&K       SETA  K'&BYTES                                                 22440042
         AIF   (&IBITS-(&IBITS/4)*4 EQ 0).OK                            22500042
         MNOTE *,'BIT LENGTH SPECIFICATION INCONSISTENT WITH CONTROL'   22560042
         MEXIT                                                          22620042
.OK      AIF   ('&BYTES' EQ '').USEDEFN                                 22680042
&LETTER  SETC  '&BYTES'(&K,1)                                           22740042
&S       SETC  '&BYTES'(1,&K-1)                                         22800042
&BYTESP  SETA  &S                                                       22860042
         AIF   ('&LETTER' EQ 'B').BOTH                                  22920042
         AIF   (&ISHIFT EQ 0 OR &ISHIFT EQ 4).OK2                       22980042
.ERR     MNOTE *,'DATA NOT ALLIGNED ON HEX OR BYTE BOUNDARY'            23040042
         MEXIT                                                          23100042
.USEDEFN ANOP                                                           23160042
&BYTESP  SETA  &IBITS/8                                                 23220042
.BOTH    AIF   (&ISHIFT NE 0).ERR                                       23280042
&CODE    SETA  3                                                        23340042
&T       SETA  &BYTESP*2-1                                              23400042
&S       SETC  '&T'                                                     23460042
.OK2     AIF   (&ISHIFT EQ 0).L                                         23520042
&CODE    SETA  2                                                        23580042
.L       ANOP                                                           23640042
&B       SETB  1                                                        23700042
         AIF   ('&SKIP$OR' EQ '').BACKUP                                23760042
&K       SETA  K'&SKIP$OR                                               23820042
&B       SETB  ('&SKIP$OR'(1,1) EQ 'B')                                 23880042
&S       SETC  '&SKIP$OR'(&B+1,&K-&B)                                   23940042
.BACKUP  ANOP                                                           24000042
&NRENTS  SETA  &NRENTS+1                                                24060042
         DC    AL.12(&LOGITEM-&DSECT),XL.4'A'                           24120042
         DC    BL.1'&B',FL.7'&S',FL.4'&BYTESP',FL.4'&CODE'              24180042
.OUT     ANOP                                                           24240042
         MEND                                                           24300042
         MACRO                                                          24360042
         SPECIAL  &ROUTINE,&PARAM,&SPACE=                               24420042
.*                            THIS MACRO GENERATES A SPECIAL ROUTINE    24480042
.*                                 ENTRY TO BE PROCESSED BY THE SUM. M. 24540042
.*                            &ROUTINE - SYMBOL ON SPECIAL ROUTINE EWT. 24600042
.*                            &PARAM - AN 8 BIT BINARY REPRESENTATION   24660042
.*                                 TO OCCUPY THE 'MASK' FIELD BUT TO BE 24720042
.*                                 INTERPRETED AS AN ARGUMENT OF THE    24780042
.*                                 SPECIAL ROUTINE.                     24840042
.*                            &SPACE - THE NUMBER OF 2BYTE COUNTERS TO  24900042
.*                                 ALLOCATE FOR REQUIRED PROCESSING.    24960042
         GBLC  &CSECT                                                   25020042
         GBLA  &COUNTR                                                  25080042
         LCLA  &ADD                                                     25140042
         DC    AL1(128)                                                 25200042
         DC    BL.8'&PARAM'                                             25260042
         DC    AL2(&ROUTINE-&CSECT)                                     25320042
         DC    AL2(&COUNTR)                                             25380042
&ADD     SETA  1                                                        25440042
         AIF   ('&SPACE' EQ '').NORM                                    25500042
&ADD     SETA  &SPACE                                                   25560042
.NORM    ANOP                                                           25620042
&COUNTR  SETA  &COUNTR+&ADD                                             25680042
         MEND                                                           25740042
         MACRO                                                          25800042
         SUM   &LOGITEM,&MASK                                           25860042
.*                            THIS MACRO GENERATES A NORMAL EDIT ENTRY  25920042
.*                                 FOR PROCESSING BY THE SUMMARY MODULE 25980042
.*                            &LOGITEM - NAME OF DATA ITEM TO BE SUMMED 26040042
.*                            &MASK - BYTE MASK FOR BITS TO BE TESTED.  26100042
.*                                 THIS OPERAND SHOULD BE OMITTED FOR   26160042
.*                                 SINGLE BIT ITEMS IN WHICH CASE THE   26220042
.*                                 MASK WILL BE SET ACCORDING TO THE    26280042
.*                                 OFF BYTE BIT DISPLACEMENT OF THE     26340042
.*                                ITEM AS DEFINED BY THE MACRO 'DSGEN'  26400042
         GBLA  &COUNTR,&ITEMNBR,&BITS(1000),&SHIFT(1000)                26460042
         GBLC  &ITEM(1000),&DSECT                                       26520042
         LCLA  &IBITS,&NDX,&ISHIFT,&M,&BITNBR                           26580042
.LOOP    ANOP                                                           26640042
&NDX     SETA  &NDX+1                                                   26700042
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      26760042
         AIF   (&NDX LT &ITEMNBR).LOOP                                  26820042
         MNOTE *,'LOGITEM NOT FOUND'                                    26880042
         MEXIT                                                          26940042
.FOUND   ANOP                                                           27000042
         DC    AL1(0)                                                   27060042
&ISHIFT  SETA  &SHIFT(&NDX)                                             27120042
&IBITS   SETA  &BITS(&NDX)                                              27180042
         AIF   ('&MASK' EQ '').FORM                                     27240042
         DC    B'&MASK'                                                 27300042
         AGO   .ITEM                                                    27360042
.FORM    ANOP                                                           27420042
&BITNBR  SETA  &ISHIFT-7                                                27480042
&BITNBR  SETA  0-&BITNBR                                                27540042
&M       SETA  1                                                        27600042
.LOOP2   ANOP                                                           27660042
         AIF   (&BITNBR EQ 0).GOTIT                                     27720042
&M       SETA  &M*2                                                     27780042
&BITNBR  SETA  &BITNBR-1                                                27840042
         AGO   .LOOP2                                                   27900042
.GOTIT   ANOP                                                           27960042
         DC    AL1(&M)                                                  28020042
.ITEM    DC    AL2(&LOGITEM-&DSECT)                                     28080042
         DC    AL2(&COUNTR)                                             28140042
&COUNTR  SETA  &COUNTR+1                                                28200042
         MEND                                                           28260042
         GBLC  &DSECT,&CSECT                                            28320042
&CSECT   SETC  'IFCST008'                                               28380042
&DSECT   SETC  'X2715'                                                  28440042
         TITLE 'IFCST008 - SUM MODULE - LINKNAME=IFCST008'              28500042
IFCST008 CSECT                                                          28560042
         USING *,R9                                                     28620042
         DC    A(ENTRIES)                                               28680042
         DC    A(PENTRY)                                                28740042
REG8     DS    F                                                        28800042
SCSIZE   DC    H'1591'                                                  28860042
*                                                                       28920042
*              DSGEN & DSECT FOR RECORD                                 28980042
*                                                                       29040042
X2715    DSECT                                                          29100042
         DSGEN (KEY,16),(TSWS,16),(TID,8),(TDUM1,16),(TCHAR,8)          29160042
         DSGEN (DATE,32),(TIME,32)                                      29220042
         DSGEN (TDUM2,8),(TSER,24),(TMOD,16),(TDUM3,16)                 29280042
         DSGEN (TCUA,16),(TSID,16)                                      29340042
*                                                                       29400042
*                   TABLE   DSGEN & DSECT                               29460042
*                                                                       29520042
YDSECT   DSECT                                                          29580042
         DSGEN (RECDATE,24),(RECTIME,32),(B0BIT0,1),(B0BIT1,1),        C29640042
               (B0BIT2,1),(B0BIT3,1),(B0BIT4,1),(B0BIT5,1),(B0BIT6,1), C29700042
               (B0BIT7,1)                                               29760042
         DSGEN (B1BIT0,1),(B1BIT1,1),(B1BIT2,1),(B1BIT3,1),            C29820042
               (B1BIT4,1),(B1BIT5,1),(B1BIT6,1),(B1BIT7,1),            C29880042
               (B2BIT0,1),(B2BIT1,1),(B2BIT2,1),(B2BIT3,1),            C29940042
               (B2BIT4,1),(B2BIT5,1),(B2BIT6,1),(B2BIT7,1),            C30000042
               (B3BIT0,1),(B3BIT1,1),(B3BIT2,1),(B3BIT3,1),            C30060042
               (B3BIT4,1),(B3BIT5,1),(B3BIT6,1),(B3BIT7,1),(DUM5,8)     30120042
*                                                                       30180042
*              COUNTER DSGEN & CSECT                                    30240042
*                                                                       30300042
Y2715    DSECT                                                          30360042
         DSGEN (DUM1,32),(FWDPTR,32)                                    30420042
         DSGEN (TOTALREC,16),(TYPE,8),(CHAN,8),(CUA,24),(YSER1,8)       30480042
         DSGEN (YSER2,16),(CPU,16),(SMSW,16),(XSWTCH,8),(DUM2,8)        30540042
         DS    6C                                                       30600042
         DSGEN (DUM3,64)                                                30660042
         DSGEN (DUMM3,64)                                               30720042
*                                                                       30780042
*              DISK ADPT  COUNTERS  18 CNTRS  1 DUMMY                   30840042
*                                                                       30900042
         DSGEN (DALOW,32),(DAHIGH,32)                                   30960042
         DSGEN (DATOTAL,16),(DB2BIT0,16),(DB2BIT1,16),(DB2BIT2,16)      31020042
         DSGEN (DB2BIT3,16),(DB2BIT4,16),(DB2BIT5,16),(DB2BIT6,16)      31080042
         DSGEN (DB2BIT7,16),(DB3BIT0,16),(DB3BIT1,16),(DB3BIT2,16)      31140042
         DSGEN (DB3BIT3,16),(DB3BIT4,16)                                31200042
*                                                                       31260042
*              2790 ADPT           20 CNTRS                             31320042
*                                                                       31380042
         DSGEN (MALOW,32),(MAHIGH,32)                                   31440042
         DSGEN (MATOTAL,16),(MB1BIT0,16),(MB1BIT1,16),(MB1BIT2,16)      31500042
         DSGEN (MB1BIT3,16),(MB1BIT4,16),(MB1BIT5,16),(MB1BIT6,16)      31560042
         DSGEN (MB1BIT7,16),(MB2BIT0,16),(MB2BIT1,16),(MB2BIT2,16)      31620042
         DSGEN (MB2BIT3,16),(MB2BIT4,16),(MB2BIT5,16),(MB2BIT6,16)      31680042
         DSGEN (MB2BIT7,16),(MB3BIT0,16),(MB3BIT1,16),(MB3BIT4,16)      31740042
         DSGEN (MB3BIT5,16),(MB3BIT6,16),(MB3BIT7,16),(MB3BIT2,16)      31800042
*                                                                       31860042
*              MPX SECTION    12 COUNTERS                               31920042
*                                                                       31980042
         DSGEN (MPLODATE,32),(MPHIDATE,32)                              32040042
         DSGEN (MPTOTAL,16),(PB3BIT0,16),(PB3BIT2,16),(PB3BIT3,16)      32100042
         DSGEN (PB3BIT5,16),(PB3BIT7,16),(PB3BIT1,16),(PB3BIT4,16)      32160042
*                                                                       32220042
*              2740AOPTER   SECTION  10 CTRS                            32280042
*                                                                       32340042
         DSGEN (ADLODATE,32),(ADHIDATE,32)                              32400042
         DSGEN (ADTOTAL,16),(AB2BIT3,16),(AB2BIT5,16),(AB2BIT6,16)      32460042
         DSGEN (AB2BIT4,16),(AB2BIT7,16)                                32520042
*                                                                       32580042
*              BSC ADAPTER    28 CTRS                                   32640042
*                                                                       32700042
         DSGEN (BSLODATE,32),(BSHIDATE,32)                              32760042
         DSGEN (BSTOTAL,16),(BB0BIT5,16),(BB0BIT6,16),(BB0BIT7,16)      32820042
         DSGEN (BB1BIT0,16),(BB1BIT3,16),(BB1BIT4,16),(BB1BIT5,16)      32880042
         DSGEN (BB1BIT6,16),(BB1BIT7,16),(BB2BIT3,16),(BB2BIT4,16)      32940042
         DSGEN (BB2BIT5,16),(BB2BIT6,16),(BB3BIT0,16),(BB3BIT1,16)      33000042
         DSGEN (BB3BIT2,16),(BB3BIT3,16),(BB3BIT4,16),(BB3BIT5,16)      33060042
         DSGEN (BB3BIT6,16),(BB3BIT7,16),(BB0BIT0,16),(BB0BIT1,16)      33120042
*                                                                       33180042
*              70 0  SPECIAL CODES    257 CTRS                          33240042
*                                                                       33300042
*                                                                       33360042
*                                                                       33420042
         DSGEN (SPLODATE,32),(SPHIDATE,32)                              33480042
         DSGEN (SPTOTAL,16),(SP70,16),(SP75,16),(SP78,16)               33540042
         DSGEN (SP79,16),(SP7A,16),(SP7X,16),(SP,16)                    33541042
         DS    CL500                                                    33600042
SPFFFF   DS    CL10                                                     33660042
*                                                                       33720042
*              AREA STATIONS  1200 COUNTERS                             33780042
*                                                                       33840042
         DSGEN (ASLODATE,32),(ASHIDATE,32)                              33900042
         DSGEN (ASTOTAL,16),(ASF0,16),(ASF1,16),(AS,16)                 33960042
         DS    CL2400                                                   34020042
ASFFFF   DS    CL24                                                     34080042
*                                                                       34140042
IFCST008 CSECT                                                          34200042
*                                                                       34260042
         USING YDSECT,R2                                                34320042
*                                                                       34380042
*                                                                       34440042
R0       EQU   0                                                        34500042
R1       EQU   1                                                        34560042
R2       EQU   2                                                        34620042
R3       EQU   3                                                        34680042
R4       EQU   4                                                        34740042
R5       EQU   5                                                        34800042
R6       EQU   6                                                        34860042
R7       EQU   7                                                        34920042
R8       EQU   8                                                        34980042
R9       EQU   9                                                        35040042
R10      EQU   10                                                       35100042
R11      EQU   11                                                       35160042
R12      EQU   12                                                       35220042
R13      EQU   13                                                       35280042
R14      EQU   14                                                       35340042
R15      EQU   15                                                       35400042
*                                                                       35460042
*                                                                       35520042
*        SPECIAL ROUTINES FOR SUMMARY MODULE                            35580042
*                                                                       35640042
LOOPER   LA    R2,L11(R2)               BUMP TO NXT ENTRY               35700042
         STM   R14,R12,L12(R13)         SAVE REGS                       35760042
         CLI   L0(R2),HEXFF             DONE WITH TABLE                 35820042
         BE    DONE                     YES-                            35880042
         CLI   L7(R2),HEX80             IS IT AREA STATIONS             35940042
         BL    REGULAR                  BR-NO                           36000042
         LA    R5,AREASTAT-L6           POINT TO NEXT TO DO             36060042
LOOPRTN  ST    R5,REG8                  PUT PTR INTO SAVE AREA          36120042
         B    RETURN                    RETURN                          36180042
REGULAR  CLI   L7(R2),HEX70             TEST FOR SPECIAL ERRS           36240042
         BL    NOTSPEC                  BR-NO                           36300042
         LA    R5,SPECERR-L6            SET TO DO PTR                   36360042
         B     LOOPRTN                                                  36420042
NOTSPEC  CLI   L7(R2),HEX4F             TEST FOR ILLEGAL CODE           36480042
         BH    LOOPER                   LOOP IF YES                     36540042
         SR    R5,R5                    CLEAR REG                       36600042
         IC    R5,L7(R2)                PICK UP CODE                    36660042
         SRL   R5,L4                    DROP OFF UNUSED BITS            36720042
         SLL   R5,L2                    MULTI BY 4                      36780042
         L     R5,ADCONS(R5)            PICK UP PROPER ADDRESS          36840042
         B     LOOPRTN                                                  36900042
*                                                                       36960042
ADCONS   DC    A(DISKADPT-L6)           CODE=00                         37020042
         DC    A(D2790ADP-L6)                10                         37080042
         DC    A(MPXADPT-L6)                 20                         37140042
         DC    A(ADPT2740-L6)                30                         37200042
         DC    A(BSCADPT-L6)                 40                         37260042
DONE     LA    R5,ALLDONE-L6                                            37320042
         B     LOOPRTN                                                  37380042
XDATE    STM   R14,R12,L12(R13)         SAVE REGS                       37440042
         CLC   RECDATE(L3),ZEROS        IS INPUT DATE 0'S               37500042
         BE    ADDONE                   BR-YES                          37560042
         CLC   L1(R3,R3),ZEROS          IS LOW DATE FILLED IN           37620042
         BNE   CHKLOW                   BR-YES                          37680042
         MVC   L1(L3,R3),RECDATE        PUT IN DATE                     37740042
CHKLOW   CLC   L1(L3,R3),RECDATE        IS LOW DATE LOWER THAN REC      37800042
         BNH   CHKHI                    BR-YES                          37860042
         MVC   L1(L3,R3),RECDATE        PUT IN LOWER DATE               37920042
CHKHI    CLC   L5(L3,R3),RECDATE        IS HI DATE HGHR THAN REC        37980042
         BNL   ADDONE                   BR-YES                          38040042
         MVC   L5(L3,R3),RECDATE        PUT IN HI DATE                  38100042
ADDONE   LH    R5,L8(R3)                ADD                             38160042
         LA    R5,L1(R5)                    ONE TO                      38220042
         STH   R5,L8(R3)                          COUNTER               38280042
         B     RETURN                   RETURN                          38340042
*                                                                       38400042
*              SPECIAL ERRORS  70-75                                    38460042
*                                                                       38520042
DO7075   STM   R14,R12,L12(R13)                                         38580042
         CLI   L7(R2),HEX70             IS IT CODE 70                   38640042
         BE    ADD70                    BR-YES                          38700042
         CLI   L7(R2),HEX75             IS IT CODE 75                   38760042
         BL    ADD7174                  BR CODES 71-74                  38820042
         LR    R5,R3                    SET COUNTER POINTER             38821042
         BE    ADD75                                                    38822042
         CLI   L7(R2),HEX78             TEST CODE FOR 78                38823042
         BL    ADD7X                    BR CODES 76 77                  38824042
         BE    ADD78                    BR CODES 78                     38825042
         CLI   L7(R2),HEX7A             TEST CODE FOR 7A                38826042
         BL    ADD79                    BR CODES 79                     38827042
         BE    ADD7A                    BR CODES 7A                     38828042
ADD7X    LA    R5,L2(R5)                BUMP POINTER TO COUNTER         38829042
ADD7A    LA    R5,L2(R5)                                                38830042
ADD79    LA    R5,L2(R5)                                                38831042
ADD78    LA    R5,L2(R5)                                                38832042
ADD75    LA    R5,L2(R5)                                                38833042
         B     ADDER                    BR-TO ADD 1                     38940042
ADD70    LR    R5,R3                    POINT TO 1ST CTR                39000042
         B     ADDER                    BR-TO ADD                       39060042
ADD7174  LA    R5,L12(R3)               BUMP UP TO 71-74 CNTRS          39120042
         LA    R7,L50                   # OF AREA STATIONS              39180042
ADD7174A CLI   L0(R5),HEXFF             IS AREA FREE                    39240042
         BE    ADD7174B                 YES                             39300042
         CLC   L1(L1,R5),L8(R2)         AREA STA EQUAL                  39360042
         BE    ADD7174C                                                 39420042
         LA    R5,L10(R5)               BUMP TO NXT CTRS                39480042
         BCT   R7,ADD7174A              LOOP                            39540042
         B     RETURN                                                   39600042
ADD7174B MVI   L0(R5),HEX00             SET TO ZERO                     39660042
         MVC   L1(L1,R5),L8(R2)         MOVE IN AREA CODE               39720042
ADD7174C IC    R8,L7(R2)                                                39780042
         SLL   R8,L28                   PICK UP AREA STA                39840042
         SRL   R8,L27                   DROP OFF HIGHER 4 BITS X BY 2   39900042
         AR    R5,R8                    COMPUTE CNTR TO ADD TO          39960042
ADDER    LH    R6,L0(R5)                ADD                             40020042
         LA    R6,L1(R6)                   ONE TO                       40080042
         STH   R6,L0(R5)                        COUNTER                 40140042
         B     RETURN                   RETURN                          40200042
*                                                                       40260042
*                                                                       40320042
*                                                                       40380042
*                                                                       40440042
*                                                                       40500042
*                                                                       40560042
DOAREA   STM   R14,R12,L12(R13)                                         40620042
         CLI   L7(R2),HEXF0             IS IT F0                        40680042
         BE    ADD70                    BR-YES ADD TO 1ST CTR           40740042
         CLI   L7(R2),HEXF1             IS IT F1                        40800042
         BE    ADD75                    BR-YES ADD TO 2ND               40860042
         LA    R5,L4(R3)                SET PTR TO AREA STATIONS        40920042
         LA    R6,L100                  SET LOOP CTR                    40980042
DOAREAA  CLI   L0(R5),HEXFF             IS CTRS FREE                    41040042
         BE    DOAREAB                  BR-YES                          41100042
         CLC   L0(L2,R5),L7(R2)         ARE AREA STATIONS EQUAL         41160042
         BE    DOAREAC                  BR-YES                          41220042
         LA    R5,L24(R5)               BUMP TO NXT SET                 41280042
         BCT   R6,DOAREAA               LOOP                            41340042
         B     RETURN                                                   41400042
DOAREAB  MVC   L0(L2,R5),L7(R2)         MOVE IN AREA STATION            41460042
DOAREAC  LH    R6,L2(R5)                ADD                             41520042
         LA    R6,L1(R6)                    ONE TO                      41580042
         STH   R6,L2(R5)                          CNTR                  41640042
         LA    R5,L4(R5)                BUMP OVER TOTAL COUNTER         41700042
         SR    R8,R8                                                    41760042
         IC    R8,L9(R2)                PICK UP ERROR CODE              41820042
         SRL   R8,L4                    DROP OFF LOW BITS               41880042
         CH    R8,H9                    CHK FOR 9                       41940042
         BH    RETURN                   BR-HI                           42000042
         SLL   R8,L1                                                    42060042
         AR    R5,R8                    ADD TO 5 TO POINT TO CNTR       42120042
         B     ADDER                    ADD TO CRTR                     42180042
*                                                                       42240042
*                                                                       42300042
*                                                                       42360042
*                                                                       42420042
*                                                                       42480042
*                                                                       42540042
SETUP    STM   R14,R12,L12(R13)         SAVE  REGS                      42600042
         LA    R6,L4095                 TO FFFF IN FIRST SET            42660042
         CLI   L0(R3),HEXFF             TEST SET UP SWITCH              42720042
         BE    SETTABLE                 DONE                            42780042
         MVI   L0(R3),HEXFF             SET SWITCH                      42840042
         SH    R3,H30                   SET DSECT BASE                  42900042
         USING Y2715,R3                                                 42960042
         MVC   SPFFFF(L2),CHARFFFF                                      43020042
         MVC   ASFFFF(L2),CHARFFFF                                      43080042
         LA    R4,SP                    SET SPECIAL CNTRS               43140042
         LA    R5,L50                   AND  AREA STATION CTRS          43200042
         LA    R7,L10                   TO INDICATE EMPTY CNTRS         43260042
         BAL   R8,STOREFF                                               43320042
         LA    R4,AS                                                    43380042
         LA    R5,L100                                                  43440042
         LA    R7,L24                                                   43500042
         BAL   R8,STOREFF                                               43560042
SETTABLE LA    R4,TABLE                 SET TABLE TO FFFF               43620042
         LA    R5,L234                  PRIOR TO BRINGING IN ENTRIES    43680042
         LA    R7,L2                                                    43740042
         BAL   R8,STOREFF                                               43800042
*                                                                       43860042
         LA    R6,TABLE                                                 43920042
         LR    R5,R2               PICK                                 43980042
         SH    R5,H2                   UP                               44040042
         LH    R5,L0(R5)               REC SIZE                         44100042
         SH    R5,H26              SUBTRACT REC SIZE                    44160042
         SR    R4,R4                                                    44220042
         D     R4,F35              GET NUMBER OF 35BYTE FLDS IN R5      44280042
         LTR   R5,R5               CHK FOR ZERO                         44340042
         BZ    RETURN              BR-NONE TO DO                        44400042
         LA    R4,L28(R2)          SET PTR TO ERROR SECTION             44460042
SETTBL01 MVC   DAYTIME(L7),L0(R4)  SAVE DATE & TIME                     44520042
         LA    R4,L7(R4)           BUMP OVER DAY&TIME                   44580042
         LA    R8,L7               LOOP CNTR                            44640042
SETTBL02 CLC   L0(L4,R4),CHARFFFF  DUMMY ENTRY                          44700042
         BE    SETTBL03            BR-YES                               44760042
         CLC   L0(L4,R4),ZEROS     DUMMY ENTRY                          44820042
         BE    SETTBL03            BR-YES                               44880042
         MVC   L0(L7,R6),DAYTIME   MOVE DAY TIME                        44940042
         MVC   L7(L4,R6),L0(R4)    MOVE ENTRY                           45000042
         LA    R6,L11(R6)          BUMP OVER ENTRY                      45060042
SETTBL03 LA    R4,L4(R4)           BUMP TO NXT ENTRY                    45120042
         BCT   R8,SETTBL02         LOOP                                 45180042
         BCT   R5,SETTBL01         LOOP TILL ALL 35 BYTE ENTRY DONE     45240042
*                                                                       45300042
         LA    R4,TABLE-L11             SET PTR                         45360042
SORTTBL1 LA    R4,L11(R4)               UP PTR A      TABLE SORT        45420042
         LA    R5,L11(R4)               UP PTR B TO A+11                45480042
         CR    R4,R6                    PTR A = PTR C---TABLE SORTED    45540042
         BE    RETURN                   BR-YES                          45600042
SORTTBL2 CLC   L7(L1,R4),L7(R5)         COMPARE ENTRY CODES             45660042
         BL    SORTTBL3                 LOW NO SWAP                     45720042
         BH    SWAP                     HI SWAP                         45780042
         CLC   L0(L7,R4),L0(R5)         COMPARE DATES                   45840042
         BNH   SORTTBL3                 BR-NO SWAP                      45900042
SWAP     XC    L0(L11,R4),L0(R5)        SWAP                            45960042
         XC    L0(L11,R5),L0(R4)           ENTRIES                      46020042
         XC    L0(L11,R4),L0(R5)                                        46080042
SORTTBL3 LA    R5,L11(R5)               BUMP PTR B                      46140042
         CR    R5,R6                    PTR B= A                        46200042
         BL    SORTTBL2                 BR-NO                           46260042
         B     SORTTBL1                 BR-YES                          46320042
*                                                                       46380042
*                                                                       46440042
STOREFF  STC   R6,L0(R4)                STORE FFFF                      46500042
         STC   R6,L1(R4)                                                46560042
         AR    R4,R7                    BUMP PTR BY SET AMOUNT          46620042
         BCT   R5,STOREFF               LOOP TILL DONE                  46680042
         BR    R8                       RTN                             46740042
*                                                                       46800042
         DROP  R3                                                       46860042
*                                                                       46920042
*                                                                       46980042
*                                                                       47040042
SETR2    ST    R2,SAVE2                 SAVE R2                         47100042
         LA    R2,TABLE-L11             SET PTR TO TABLE                47160042
         STM   R14,R12,L12(R13)         SAVE REGS                       47220042
         LR    R14,R3                   SAVE FOR LATER                  47280042
         L     R3,SAVE2                 SET DSECT BASE                  47340042
         USING X2715,R3                                                 47400042
         IC    R7,TCUA                  PICK UP                         47460042
         SLL   R7,L8                          CUA TO CONVERT            47520042
         IC    R7,TCUA+L1                                               47580042
         SLL   R7,L16                   MOVE IT TO HI ORDER             47640042
         LA    R4,CUAFLD                OF R7 FOR CONVERSION            47700042
         BAL   R8,SETUPA                SET AREA                        47760042
         IC    R7,TSID                                                  47820042
         SLL   R7,L8                    PICK                            47880042
         IC    R7,TSID+L1                    UP ID  &                   47940042
         SLL   R7,L16                   MOVE TO HI POS                  48000042
         LR    R4,R14                RESET ADDR OF COUNTER              48060042
         LA    R8,RETURN                                                48120042
SETUPA   LA    R5,L4                    LOOP CNT                        48180042
SETUPB   SR    R6,R6                    CLEAR R6                        48240042
         SLDL  R6,L4                    MOVE OVER 4 BITS                48300042
         LA    R6,CHARS(R6)             INDEX TO CHAR                   48360042
         MVC   L0(L1,R4),L0(R6)         MOVE CHAR                       48420042
         LA    R4,L1(R4)                BUMP PTR                        48480042
         BCT   R5,SETUPB                LOOP                            48540042
         BR    R8                       RETURN                          48600042
*                                                                       48660042
RESETR2  L     R2,SAVE2                 PICK UP R2                      48720042
         BR    R14                      RETURN                          48780042
DAYTIME  DS    CL7                                                      48840042
TABLE    DS    CL464                                                    48900042
         DC    11X'FF'                                                  48960042
         DROP  R3                                                       49020042
ENTRIES  DS    0F                                                       49080042
**                                                                      49140042
*        SUMMARY MODULE FOR 2715                                        49200042
**                                                                      49260042
STARTPT  EQU   *                                                        49320042
STARTPT  SPECIAL    SETUP,0,SPACE=2     SET TABLE                       49380042
         SPECIAL    SETR2,0,SPACE=2                                     49440042
*                                                                       49500042
*                                                                       49560042
&DSECT   SETC  'YDSECT'                                                 49620042
*                                                                       49680042
*                                                                       49740042
         SPECIAL    LOOPER,0,SPACE=2                                    49800042
ALLDONE  EQU   *                                                        49860042
ALLDONE  SPECIAL    RESETR2,0,SPACE=2                                   49920042
*                                                                       49980042
*                                                                       50040042
         DC    X'FF'                    END OF SUMMARY SECTION IND.     50100042
*                                                                       50160042
*                                                                       50220042
&DSECT   SETC  'YDSECT'                                                 50280042
         EJECT                                                          50340042
*              DISK ADAPTER      CODE=00                                50400042
*                                                                       50460042
         DS    0H                                                       50520042
DISKADPT EQU   *                                                        50580042
DISKADPT SPECIAL    XDATE,0,SPACE=5                                     50640042
         SUM        B2BIT0                                              50700042
         SUM        B2BIT1                                              50760042
         SUM        B2BIT2                                              50820042
         SUM        B2BIT3                                              50880042
         SUM        B2BIT4                                              50940042
         SUM        B2BIT5                                              51000042
         SUM        B2BIT6                                              51060042
         SUM        B2BIT7                                              51120042
         SUM        B3BIT0                                              51180042
         SUM        B3BIT1                                              51240042
         SUM        B3BIT2                                              51300042
         SUM        B3BIT3                                              51360042
         SPECIAL    LOOPER,0,SPACE=1                                    51420042
         EJECT                                                          51480042
*                                                                       51540042
*        2790  ADAPTER  CODE=10                                         51600042
*                                                                       51660042
         DS    0H                                                       51720042
D2790ADP EQU   *                                                        51780042
D2790ADP SPECIAL    XDATE,0,SPACE=5                                     51840042
         SUM        B1BIT0                                              51900042
         SUM        B1BIT1                                              51960042
         SUM        B1BIT2                                              52020042
         SUM        B1BIT3                                              52080042
         SUM        B1BIT4                                              52140042
         SUM        B1BIT5                                              52200042
         SUM        B1BIT6                                              52260042
         SUM        B1BIT7                                              52320042
         SUM        B2BIT0                                              52380042
         SUM        B2BIT1                                              52440042
         SUM        B2BIT2                                              52500042
         SUM        B2BIT3                                              52560042
         SUM        B2BIT4                                              52620042
         SUM        B2BIT5                                              52680042
         SUM        B2BIT6                                              52740042
         SUM        B2BIT7                                              52800042
         SUM        B3BIT0                                              52860042
         SUM        B3BIT1                                              52920042
         SUM        B3BIT4                                              52980042
         SUM        B3BIT5                                              53040042
         SUM        B3BIT6                                              53100042
         SUM        B3BIT7                                              53160042
         SPECIAL    LOOPER,0,SPACE=1                                    53220042
         EJECT                                                          53280042
*                                                                       53340042
*        MPX SUMMARY    CODE=20                                         53400042
*                                                                       53460042
         DS    0H                                                       53520042
MPXADPT  EQU   *                                                        53580042
MPXADPT  SPECIAL    XDATE,0,SPACE=5                                     53640042
         SUM        B3BIT0                                              53700042
         SUM        B3BIT2                                              53760042
         SUM        B3BIT3                                              53820042
         SUM        B3BIT5                                              53880042
         SUM        B3BIT7                                              53940042
         SPECIAL    LOOPER,0,SPACE=2                                    54000042
         EJECT                                                          54060042
*                                                                       54120042
*              2740 ADAPTER CODE=30                                     54180042
*                                                                       54240042
         DS    0H                                                       54300042
ADPT2740 EQU   *                                                        54360042
ADPT2740 SPECIAL    XDATE,0,SPACE=5                                     54420042
         SUM        B2BIT3                                              54480042
         SUM        B2BIT5                                              54540042
         SUM        B2BIT6                                              54600042
         SPECIAL    LOOPER,0,SPACE=2                                    54660042
         EJECT                                                          54720042
*                                                                       54780042
*              BSC ADAPTER  CODE=40                                     54840042
*                                                                       54900042
         DS    0H                                                       54960042
BSCADPT  EQU   *                                                        55020042
BSCADPT  SPECIAL    XDATE,0,SPACE=5                                     55080042
         SUM        B0BIT5                                              55140042
         SUM        B0BIT6                                              55200042
         SUM        B0BIT7                                              55260042
         SUM        B1BIT0                                              55320042
         SUM        B1BIT3                                              55380042
         SUM        B1BIT4                                              55440042
         SUM        B1BIT5                                              55500042
         SUM        B1BIT6                                              55560042
         SUM        B1BIT7                                              55620042
         SUM        B2BIT3                                              55680042
         SUM        B2BIT4                                              55740042
         SUM        B2BIT5                                              55800042
         SUM        B2BIT6                                              55860042
         SUM        B3BIT0                                              55920042
         SUM        B3BIT1                                              55980042
         SUM        B3BIT2                                              56040042
         SUM        B3BIT3                                              56100042
         SUM        B3BIT4                                              56160042
         SUM        B3BIT5                                              56220042
         SUM        B3BIT6                                              56280042
         SUM        B3BIT7                                              56340042
         SPECIAL    LOOPER,0,SPACE=2                                    56400042
         EJECT                                                          56460042
*                                                                       56520042
*              SPECIAL CODES 70--75                                     56580042
*                                                                       56640042
         DS    0H                                                       56700042
SPECERR  EQU   *                                                        56760042
SPECERR  SPECIAL    XDATE,0,SPACE=5                                     56820042
         SPECIAL    DO7075,0,SPACE=261                                  56880042
         SPECIAL    LOOPER,0,SPACE=1                                    56940042
*                                                                       57000042
*                   AREA STATIONS                                       57060042
*                                                                       57120042
         DS    0H                                                       57180042
AREASTAT  EQU   *                                                       57240042
AREASTA  SPECIAL    XDATE,0,SPACE=5                                     57300042
         SPECIAL    DOAREA,0,SPACE=1214                                 57360042
         SPECIAL    LOOPER,0,SPACE=1                                    57420042
         EJECT                                                          57480042
&DSECT   SETC  'Y2715'                                                  57540042
&CSECT   SETC  'PENTRY'                                                 57600042
*                                                                       57660042
PENTRY   DS    0F                                                       57720042
         USING *,R9                                                     57780042
         USING Y2715,R2                                                 57840042
         DC    A(PEDIT)                                                 57900042
         DC    CL8'IFCST008'                                            57960042
R9PTR    DS    F                                                        58020042
LABELPTR DS    F                                                        58080042
*                                                                       58140042
*                                                                       58200042
*                                                                       58260042
*                                                                       58320042
*              SPECIAL ROUTINES FOR EDIT SECTION                        58380042
*                                                                       58440042
*                                                                       58500042
FREECORE STM   R14,R12,L12(R13)                                         58560042
         LR    R12,R13                  SAVE POINTERS                   58620042
         LA    R13,FSAVE                SET UP LINK CONVS               58680042
         ST    R12,L4(R13)                                              58740042
         ST    R13,L8(R12)                                              58800042
         L     R3,L4(R2)                PICK UP POSS PTR                58860042
         ST    R3,L28(R12)              SAVE IT IN SAVE AREA            58920042
         LH    R0,SIZE                  SET UP TO FREE CNTRS            58980042
         LR    R1,R2                    SET ADDRESS                     59040042
         FREEMAIN R,LV=(0),A=(1)                                        59100042
         LTR   R3,R3                    IS THERE ANOTHER COUNTER BUFF   59160042
         BZ    RETURN0                  BR-NO                           59220042
         LA    R5,PEDIT+L10        SET UP POINTERS                      59280042
         LA    R6,LABELS-L1             TO RESTART TABLE                59340042
         STM   R5,R6,R9PTR              STORE THEM                      59400042
RETURN0  L     R13,L4(R13)              PICK UP HI SAVE AREA            59460042
         LM    R14,R12,L12(R13)                                         59520042
         BR    R14                      RETRUN                          59580042
*                                                                       59640042
*                                                                       59700042
*                                                                       59760042
SETADCON LM    R5,R6,RTNADDRS            POINT TO NXT SECTION           59820042
         STM   R5,R6,R9PTR              BY PUTTING ADCONS INTO TBL PTRS 59880042
         STM   R14,R15,L12(R13)         STORE 0 INTO RRIB STOP PRINT    59940042
         B     SWAPADCN                 BR                              60000042
*                                                                       60060042
CONVERT  STM   R14,R12,L12(R13)          SAVE REGS                      60120042
         LH    R5,L0(R4)                PICK UP NUMBER                  60180042
         CVD   R5,DBLWORD               CONVERT TO PACKED DEC           60240042
         UNPK  L0(L5,R3),DBLWORD+L3(L5)    UNPK IT INTO PR BUFF         60300042
         MVZ   L4(L1,R3),L0(R3)          MOVE ON PROPER ZONE            60360042
         B     RETURN                    RETURN                         60420042
SETCPUNO STM   R5,R8,FSAVE         SAVE WORK REGS              @Z427VLS 60424042
         SR    R5,R5               CLEAR REG 5                 @Z427VLS 60428042
         ICM   R5,X'3',0(R4)       PICK UP CPU TYPE FIELD      @Z427VLS 60432042
         LTR   R5,R5               IS FIELD ZERO?              @Z427VLS 60436042
         BNZ   RET1                NO,CPU TYPE THERE RETURN    @Z427VLS 60440042
         LA    R6,L48              AMOUNT TO BACK UP           @Z427VLS 60444042
         SR    R3,R6               BACK UP OUTPUT PTR          @Z427VLS 60448042
         MVC   L24(L6,R3),SHARED   SERIAL NO.- SHARED          @Z427VLS 60452042
RET1     LM    R5,R8,FSAVE         RESTORE REGS                @Z427VLS 60456042
         BR    R14                 RETURN                      @Z427VLS 60460042
*                                                              @Z427VLS 60464042
SHARED   DC   C'SHARED'                                        @Z427VLS 60468042
*                                                                       60480042
*                                                                       60540042
*                                                                       60600042
CONVERT1 ST    R4,SAVE4                                                 60660042
CONVERT3 LH    R2,L0(R4)                PICK UP COUNTER                 60720042
         CVD   R2,DBLWORD               CONVERT IT                      60780042
         UNPK  L0(L5,R3),DBLWORD+L3(L5) UNPACK IT                       60840042
         MVZ   L4(L1,R3),L0(R3)         PUT ON PROPER ZONE              60900042
         AR    R3,R6                    UP TO NXT COLUMN                60960042
         LA    R4,L2(R4)                 UP TO NXT COUNTER              61020042
         BCT   R5,CONVERT3              LOOP TILL DONE                  61080042
         STM   R7,R8,R9PTR                                              61140042
         L     R5,SAVE4                                                 61200042
         SH    R5,H2                    BACK UP TO START OF CNTRS       61260042
CONVERT2 MVC   L0(L100,R5),L0(R4)       SHIFT COUNTERS OCER TOP         61320042
         LA    R4,L100(R4)               THE COUNTERS JUST USED         61380042
         LA    R5,L100(R5)                                              61440042
         BCT   R10,CONVERT2             LOOP TILL ALL DONE              61500042
         B     RETURN                    RETURN                         61560042
*                                                                       61620042
*                                                                       61680042
*                                                                       61740042
SETSPEC  STM   R14,R12,L12(R13)         SAVE REGS                       61800042
         LH    R7,L0(R4)                PICK UP AREA STA                61860042
         LTR   R7,R7                    END OF LIST                     61920042
         BZ    RETURN                   BR END                          61980042
         CLC   L0(L2,R4),CHARFFFF       IS IT END                       62040042
         BE    RETURN                                                   62100042
         SLL   R7,L24                   SHIFT TO HI SIDE                62160042
         LA    R5,L1                    LOOP COUNT                      62220042
         BAL   R8,AREAHEX               CONVERT AREA STA                62280042
         LA    R3,L12(R3)                SET BUFF PTR                   62340042
         LA    R4,L2(R4)                 SET CTR PTR                    62400042
         LA    R5,L4                     COUNTER #                      62460042
         LA    R6,L10                   BUFFER SPACE VALUE              62520042
         LM    R7,R8,SPECADS            SET RTN PTRS                    62580042
         LA    R10,L5                    NUMBER OF 100 BYTE MOVES       62640042
         B     CONVERT1                                                 62700042
*                                                                       62760042
AREAHEX  LR    R2,R3                     SET WORK REG                   62820042
AREAHEX1 SR    R6,R6                                                    62880042
         SLDL  R6,L4                     MOVE 4 BITS TO R6              62940042
         LA    R6,CHARS(R6)              INDEX INTO CHARS               63000042
         MVC   L0(L1,R2),L0(R6)         MOVE INDEXED CHAR TO BUFF       63060042
         SR    R6,R6                    CLEAR 6                         63120042
         SLDL  R6,L4                    MOVE NXT 4 BYTS                 63180042
         LA    R6,CHARS(R6)              INDEX AGAIN                    63240042
         MVC   L1(L1,R2),L0(R6)          MOVE INDEXED CHAR              63300042
         LA    R2,L4(R2)                BUMP PTR                        63360042
         BCT   R5,AREAHEX1              LOOP                            63420042
         BR    R8                       RETURN                          63480042
*                                                                       63540042
*                                                                       63600042
*                                                                       63660042
SETAREA  STM   R14,R12,L12(R13)         SAVE REGS                       63720042
         LH    R7,L0(R4)                PICK UP CNTR                    63780042
         LTR   R7,R7                     TEST FOR END                   63840042
         BZ    RETURN                   BR-YES                          63900042
         CLC   L0(L2,R4),CHARFFFF       IS IT FF'S                      63960042
         BE    RETURN                    BR-YES                         64020042
         SLL   R7,L16                   MOVE TO HI                      64080042
         LA    R5,L2                     SET LOOP CNT                   64140042
         BAL   R8,AREAHEX               CONVERT AREA STA                64200042
         LA    R3,L12(R3)               SET BUFF PTR                    64260042
         LA    R4,L2(R4)                SET COUNTER POINTER             64320042
         LA    R5,L11                   #OF CNTRS                       64380042
         LA    R6,L9                    BUFFER SPACE                    64440042
         LM    R7,R8,AREAADS            SET RTN PTS                     64500042
         LA    R10,L24                   #OF 100 BYTE MOVES             64560042
         B     CONVERT1                 1                               64620042
*                                                                       64680042
*                                                                       64740042
*                                                                       64800042
SORTSPEC STM   R14,R12,L12(R13)                                         64860042
         LA    R5,L500(R4)              SET PTR TO END OF TABLE         64920042
         LA    R6,L10                   SET SIZE OF AREA                64980042
         B     SORTIT                                                   65040042
*                                                                       65100042
*                                                                       65160042
*                                                                       65220042
SORTAREA STM   R14,R12,L12(R13)                                         65280042
         LA    R5,L2400(R4)             SET PTR TO END OF TABLE         65340042
         LA    R6,L24                    SET SIZE OF AREA               65400042
         B     SORTIT                                                   65460042
SORTIT0  AR    R4,R6                    BUMP R4 TO NEXT ENTRY           65520042
SORTIT   CR    R4,R5                    AT END OF TABLE                 65580042
         BNL   RETURN                    BR-YES                         65640042
         LR    R7,R4                                                    65700042
SORTIT1  AR    R7,R6                    POINT TO NXT ENTRY              65760042
         CR    R7,R5                    IS ONE PASS DONE                65820042
         BNL   SORTIT0                   BR-YES                         65880042
         CLC   L0(L2,R4),L0(R7)                                         65940042
         BL    SORTIT1                                                  66000042
         BCTR  R6,R0                                                    66060042
         EX    R6,SWAP1                                                 66120042
         EX    R6,SWAP2                                                 66180042
         EX    R6,SWAP1                                                 66240042
         LA    R6,L1(R6)                                                66300042
         B     SORTIT1                                                  66360042
SWAP1    XC    L0(L0,R4),L0(R7)                                         66420042
SWAP2    XC    L0(L0,R7),L0(R4)                                         66480042
*                                                                       66540042
*                                                                       66600042
SETHEAD  STM   R14,R12,L12(R13)         SAVE REGS                       66660042
         LH    R15,L8(R4)               CHECK COUNT                     66720042
         LTR   R15,R15                  IS IT ZERO                      66780042
         BZ    SETADCON                 BR-YES SKIP SECTION             66840042
         MVC   IDFLD(L4),DUM3+L4       MOVE IN REC ID                   66900042
         MVC   L0(L30,R3),HEADER1       SET                             66960042
         MVC   FROMDAY(L3),L1(R4)          UP                           67020042
         MVC   TODAY(L3),L5(R4)             HEADER                      67080042
         MVC   L33(L33,R3),HEADER2      IF NOT ZERO                     67140042
SWAPADCN LM    R5,R6,RTNADDRS                                           67200042
         MVC   RTNADDRS(L48),RTNADDRS+L8     ADDJUST PTRS TO NXT DECT   67260042
         STM   R5,R6,RTNADDRS+L48                                       67320042
RETURN   LM    R14,R12,L12(R13)                                         67380042
SKIPPER  BR    R14                                                      67440042
*                                                                       67500042
L0       EQU   0                                                        67560042
L1       EQU   1                                                        67620042
L2       EQU   2                                                        67680042
L3       EQU   3                                                        67740042
L4       EQU   4                                                        67800042
L5       EQU   5                                                        67860042
L6       EQU   6                                                        67920042
L7       EQU   7                                                        67980042
L8       EQU   8                                                        68040042
L9       EQU   9                                                        68100042
L10      EQU   10                                                       68160042
L11      EQU   11                                                       68220042
L12      EQU   12                                                       68280042
L13      EQU   13                                                       68340042
L16      EQU   16                                                       68400042
L24      EQU   24                                                       68460042
L27      EQU   27                                                       68520042
L28      EQU   28                                                       68580042
L30      EQU   30                                                       68640042
L33      EQU   33                                                       68700042
L48      EQU   48                                                       68760042
L50      EQU   50                                                       68820042
L64      EQU   64                                                       68880042
L100     EQU   100                                                      68940042
L234     EQU   234                                                      69000042
L500     EQU   500                                                      69060042
L2400    EQU   2400                                                     69120042
L4095    EQU   4095                                                     69180042
HEX00    EQU   X'00'                                                    69240042
HEXFF    EQU   X'FF'                                                    69300042
HEX80    EQU   X'80'                                                    69360042
HEX70    EQU   X'70'                                                    69420042
HEX4F    EQU   X'4F'                                                    69480042
HEX75    EQU   X'75'                                                    69540042
HEX78    EQU   X'78'                                                    69541042
HEX7A    EQU   X'7A'                                                    69542042
HEXF0    EQU   X'F0'                                                    69600042
HEXF1    EQU   X'F1'                                                    69660042
*                                                                       69720042
DBLWORD  DS    D                                                        69780042
*                                                                       69840042
FSAVE    DS    18F                                                      69900042
SAVE2    DS    F                                                        69960042
SAVE4    DS    F                                                        70020042
F35      DC    F'35'                                                    70080042
SPECADS  DC    A(SPECIALR-L4)                                           70140042
         DC    A(ASSTARTL-L2)                                           70200042
AREAADS  DC    A(AREASTA-L4)                                            70260042
         DC    A(AREASTAL-L1)                                           70320042
RTNADDRS DC    A(MASTART-L4)                                            70380042
         DC    A(MASTARTL)                                              70440042
         DC    A(MPSTART-L4)                                            70500042
         DC    A(MPSTARTL)                                              70560042
         DC    A(ADSTART-L4)                                            70620042
         DC    A(ADSTARTL)                                              70680042
         DC    A(BSSTART-L4)                                            70740042
         DC    A(BSSTARTL)                                              70800042
         DC    A(SPSTART-L4)                                            70860042
         DC    A(SPSTARTL)                                              70920042
         DC    A(ASSTART-L4)                                            70980042
         DC    A(ASSTARTL)                                              71040042
         DC    A(FRBUFF-L4)                                             71100042
         DC    A(FRBUFFL)                                               71160042
H2       DC    H'2'                                                     71220042
H9       DC    H'9'                                                     71280042
H26      DC    H'26'                                                    71340042
SIZE     DC    H'3212'                                                  71400042
H30      DC    H'30'                                                    71460042
ZEROS    DC    XL4'00'                                                  71520042
CHARFFFF DC    4X'FF'                                                   71580042
CHARS    DC    C'0123456789ABCDEF'                                      71640042
HEADER1  DS    0CL30                                                    71700042
         DC    CL5'CUA'                                                 71760042
CUAFLD   DC    CL10' '                                                  71820042
         DC    CL10'2715 ID'                                            71880042
IDFLD    DC    CL5' '                                                   71940042
HEADER2  DS    0CL33                                                    72000042
         DC    C'DATE RANGE - FROM - '                                  72060042
FROMDAY  DC    C'XX  TO - '                                             72120042
TODAY    DC    C'XXX'                                                   72180042
*                                                                       72240042
&DSECT   SETC  'Y2715'                                                  72300042
&CSECT   SETC  'PENTRY'                                                 72360042
PEDIT    DC    2F'0'                                                    72420042
         DC    A(LABELS)                                                72480042
         DC    H'0'                                                     72540042
*                                                                       72600042
RESTART  DC    X'01'                                                    72660042
         DC    X'000B8B00'              SKIP TO CHAN 1                  72720042
         LABEL ''                                                       72780042
*                                                                       72840042
         LINE       (1,1),(1,1),SKIP=2                                  72900042
         ROUTINE    DUM1,SKIPPER                                        72960042
         LABEL      '2715 ERROR LOG DATA SUMMARY'                       73020042
*                                                                       73080042
         LINE       (8,24),(1,20)                                S21021 73140042
         HEX        CPU,0,2B                                     S21021 73200042
         HEX        YSER1,0,3B                                   S21021 73260042
         ROUTINE CPU,SETCPUNO                                  @Z427VLS 73290042
         LABEL      'MODEL -','SERIAL NO'                        S21021 73320042
         LINE       (40,1),(5,1)                                        73380042
         ROUTINE    TOTALREC,CONVERT                                    73440042
         LABEL      'TOTAL NUMBER OF RECORDS PROCESSED'                 73500042
*                                                                       73560042
         LINE       (29,35),(2,35)                                      73620042
         ROUTINE    DUM1,SKIPPER                                        73680042
         LABEL      ''                                                  73740042
*                                                                       73800042
         EJECT                                                          73860042
         LINE                                                           73920042
         ROUTINE    DALOW,SETHEAD                                       73980042
         LABEL      'DISK ADAPTER ERROR SUMMARY'                        74040042
*                                                                       74100042
         LINE       ,(4,35),SKIP=1                                      74160042
         ROUTINE    DUM1,SKIPPER                                        74220042
         ROUTINE    DATOTAL,CONVERT                                     74280042
         LABEL 'ERROR STATUS','TOTAL RECORDS PROCESSED'                 74340042
*                                                                       74400042
         LINE       ,(5,35)                                             74460042
         ROUTINE    DB2BIT0,CONVERT                                     74520042
         LABEL      'READ CHECK'                                        74580042
*                                                                       74640042
         LINE                                                           74700042
         ROUTINE    DB2BIT1,CONVERT                                     74760042
         LABEL      'CSBI PTY ERROR - DATA'                             74820042
*                                                                       74880042
         LINE       ,(5,34)                                             74940042
         ROUTINE    DB2BIT2,CONVERT                                     75000042
         LABEL      'CSBI PTY ERROR - ADDR','READ/WRITE OP CODE STATUS' 75060042
*                                                                       75120042
         LINE       ,(5,35)                                             75180042
         ROUTINE   DB2BIT3,CONVERT                                      75240042
         ROUTINE   DB3BIT0,CONVERT                                      75300042
         LABEL      'DATA REG PARITY CK','READ LABEL'                   75360042
*                                                                       75420042
         LINE                                                           75480042
         ROUTINE    DB2BIT4,CONVERT                                     75540042
         ROUTINE    DB3BIT1,CONVERT                                     75600042
         LABEL      'ADDR REG PARITY CX','WRITE'                        75660042
*                                                                       75720042
         LINE                                                           75780042
         ROUTINE    DB2BIT5,CONVERT                                     75840042
         ROUTINE    DB3BIT2,CONVERT                                     75900042
         LABEL      'OVERRUN','READ CHECK'                              75960042
*                                                                       76020042
         LINE                                                           76080042
         ROUTINE    DB2BIT6,CONVERT                                     76140042
         ROUTINE    DB3BIT3,CONVERT                                     76200042
         LABEL      'WRITE SELECT CHECK','READ'                         76260042
*                                                                       76320042
         LINE       ,,SKIP=2                                            76380042
         ROUTINE    DB2BIT7,CONVERT                                     76440042
MASTARTL LABEL      'MODULO 4/LENGTH CK'                                76500042
*                                                                       76560042
         EJECT                                                          76620042
MASTART  LINE       (29,35),(2,35),SKIP=2                               76680042
         ROUTINE    MALOW,SETHEAD                                       76740042
         LABEL      '2790 ADAPTER ERROR SUMMARY'                        76800042
*                                                                       76860042
         LINE       ,(4,35),SKIP=1                                      76920042
         ROUTINE    DUM1,SKIPPER                                        76980042
         ROUTINE    MATOTAL,CONVERT                                     77040042
         LABEL      '','TOTAL ERROR RECORDS'                            77100042
*                                                                       77160042
         LINE                                                           77220042
         ROUTINE    DUM1,SKIPPER                                        77280042
         LABEL      'PC ADAPTER STATUS'                                 77340042
*                                                                       77400042
         LINE       ,(5,34)                                             77460042
         ROUTINE    MB1BIT0,CONVERT                                     77520042
         LABEL      'TRANSMFT ACTIVE FRAME','PARITY ERRORS'             77580042
*                                                                       77640042
         LINE                                                           77700042
         ROUTINE    MB1BIT1,CONVERT                                     77760042
         ROUTINE    MB2BIT0,CONVERT                                     77820042
         LABEL      'RECEIVE CHARACTER SYNC',' ACCUMULATOR HIGH',      C77880042
               'SERVICE REQUESTS'                                       77940042
*                                                                       78000042
         LINE       ,(5,35)                                             78060042
         ROUTINE    MB1BIT2,CONVERT                                     78120042
         ROUTINE    MB2BIT1,CONVERT                                     78180042
         ROUTINE    MB3BIT0,CONVERT                                     78240042
         LABEL      'LOOP ACTIVE','ACCUMULATOR LOW','RECEIVE'           78300042
         LINE                                                           78360042
         ROUTINE    MB1BIT3,CONVERT                                     78420042
         ROUTINE    MB2BIT2,CONVERT                                     78480042
         ROUTINE    MB3BIT1,CONVERT                                     78540042
         LABEL      'RECEIVE ACTIVE FRAME','TRANSMIT SHIFT REGISTER',  X78600042
               'TRANSMIT'                                               78660042
*                                                                       78720042
         LINE                                                           78780042
         ROUTINE    DUM1,SKIPPER                                        78840042
         ROUTINE    MB2BIT3,CONVERT                                     78900042
         LABEL      ' ','RECEIVE  SHIFT REGISTER'                       78960042
*                                                                       79020042
         LINE       ,(4,35)                                             79080042
         ROUTINE    DUM1,SKIPPER                                        79140042
         ROUTINE    MB2BIT7,CONVERT                                     79200042
         ROUTINE    MB3BIT4,CONVERT                                     79260042
         LABEL      'SEGMENT STATUS',' CONTROL REGISTER 2',            *79320042
               'PC NOT RECEIVING FRAME'                                 79380042
*                                                                       79440042
         LINE                                                           79500042
         ROUTINE    MB1BIT4,CONVERT                                     79560042
         ROUTINE    DUM1,SKIPPER                                        79620042
         ROUTINE    MB2BIT4,CONVERT                                     79680042
         LABEL      ' SEGMENT A ACTIVE',' ','TRANSMIT FRAME OVERRUN'    79740042
         LINE                                                           79800042
         ROUTINE    MB1BIT5,CONVERT                                     79860042
         ROUTINE    DUM1,SKIPPER                                        79920042
         ROUTINE    MB2BIT5,CONVERT                                     79980042
         LABEL      ' SEGMENT B ACTIVE',' ','RECEIVE FRAME OVERRUN'     80040042
*                                                                       80100042
         LINE                                                           80160042
         ROUTINE    MB1BIT6,CONVERT                                     80220042
         ROUTINE    MB3BIT6,CONVERT                                     80280042
         ROUTINE    MB2BIT6,CONVERT                                     80340042
         LABEL      ' SEGMENT C ACTIVE','RECEIVE RESET ERROR',         X80400042
               'RECEIVE RE-SYNC ERROR'                                  80460042
         LINE       ,,SKIP=2                                            80520042
         ROUTINE    MB1BIT7,CONVERT                                     80580042
         ROUTINE    MB3BIT7,CONVERT                                     80640042
         ROUTINE    MB3BIT5,CONVERT                                     80700042
MPSTARTL LABEL      ' SEGMENT D ACTIVE','TRANSMIT RESET ERROR',        X80760042
               'LOST LOOP SYNC'                                         80820042
*                                                                       80880042
         EJECT                                                          80940042
MPSTART  LINE       (29,35),(2,35),SKIP=2                               81000042
         ROUTINE    MPLODATE,SETHEAD                                    81060042
         LABEL      'MPX ADAPTER ERROR SUMMARY'                         81120042
*                                                                       81180042
         LINE       ,(4,35),SKIP=1                                      81240042
         ROUTINE    DUM1,SKIPPER                                        81300042
         ROUTINE    MPTOTAL,CONVERT                                     81360042
         LABEL      'ERROR STATUS','TOTAL RECORDS PROCESSED'            81420042
*                                                                       81480042
         LINE       ,(5,35)                                             81540042
         ROUTINE    PB3BIT0,CONVERT                                     81600042
         LABEL      'PROGRAM CHECK'                                     81660042
*                                                                       81720042
         LINE                                                           81780042
         ROUTINE    PB3BIT2,CONVERT                                     81840042
         LABEL      'I/O BUS OUT CHECK'                                 81900042
*                                                                       81960042
         LINE                                                           82020042
         ROUTINE    PB3BIT3,CONVERT                                     82080042
         LABEL      'EQUIPMENT CHECK'                                   82140042
*                                                                       82200042
         LINE                                                           82260042
         ROUTINE    PB3BIT3,CONVERT                                     82320042
         LABEL      'XFER CHECK'                                        82380042
*                                                                       82440042
         LINE       ,,SKIP=2                                            82500042
         ROUTINE    PB3BIT7,CONVERT                                     82560042
ADSTARTL LABEL      'I/O BUS IN CHECK'                                  82620042
*                                                                       82680042
         EJECT                                                          82740042
ADSTART  LINE       (29,35),(2,35),SKIP=2                               82800042
         ROUTINE    ADLODATE,SETHEAD                                    82860042
         LABEL      '2740 ADAPTER ERROR SUMMARY'                        82920042
*                                                                       82980042
         LINE       ,(4,35),SKIP=1                                      83040042
         ROUTINE    DUM1,SKIPPER                                        83100042
         ROUTINE    ADTOTAL,CONVERT                                     83160042
         LABEL      'HARDWARE ERROR','TOTAL RECORDS PROCESSED'          83220042
*                                                                       83280042
         LINE       ,(5,35)                                             83340042
         ROUTINE    AB2BIT3,CONVERT                                     83400042
         LABEL      'KEYBOARD BIT OVERRUN'                              83460042
*                                                                       83520042
         LINE                                                           83580042
         ROUTINE    AB2BIT5,CONVERT                                     83640042
         LABEL      'ADAPTER INPUT PRTY ERR'                            83700042
*                                                                       83760042
         LINE       ,,SKIP=2                                            83820042
         ROUTINE    AB2BIT6,CONVERT                                     83880042
BSSTARTL LABEL      'CSBO PARITY ERROR'                                 83940042
*                                                                       84000042
         EJECT                                                          84060042
BSSTART  LINE       (29,35),(2,35),SKIP=2                               84120042
         ROUTINE    BSLODATE,SETHEAD                                    84180042
         LABEL      'BSC ADAPTER ERROR SUMMARY'                         84240042
*                                                                       84300042
         LINE       ,(4,35)                                             84360042
         ROUTINE    BSTOTAL,CONVERT                                     84420042
         LABEL      'TOTAL RECORDS PROCESSED'                           84480042
*                                                                       84540042
         LINE       ,,SKIP=1                                            84600042
         ROUTINE    DUM1,SKIPPER                                        84660042
         LABEL      'MODE OF OPERATION','BSC STATUS','BSC ADAPTER STATUX84720042
               S'                                                       84780042
*                                                                       84840042
         LINE       ,(5,35)                                             84900042
         ROUTINE    BB0BIT5,CONVERT                                     84960042
         ROUTINE    BB1BIT0,CONVERT                                     85020042
         ROUTINE    BB3BIT0,CONVERT                                     85080042
         LABEL      'INITIALIZATION','LOST OPERATIONAL COND',          C85140042
               'DATA SET READY OFF'                                     85200042
*                                                                       85260042
         LINE                                                           85320042
         ROUTINE    BB0BIT6,CONVERT                                     85380042
         ROUTINE    BB1BIT3,CONVERT                                     85440042
         ROUTINE    BB3BIT1,CONVERT                                     85500042
         LABEL      'TRANSMIT TEXT','TEXT TIMEOUT','CLEAR TO SEND OFF'  85560042
*                                                                       85620042
         LINE                                                           85680042
         ROUTINE    BB0BIT7,CONVERT                                     85740042
         ROUTINE    BB1BIT4,CONVERT                                     85800042
         ROUTINE    BB3BIT2,CONVERT                                     85860042
         LABEL      'RECEIVE TEXT','N - RETRYS','OVERRUN'               85920042
*                                                                       85980042
         LINE                                                           86040042
         ROUTINE    BB0BIT7,SKIPPER                                     86100042
         ROUTINE    BB1BIT5,CONVERT                                     86160042
         ROUTINE    BB3BIT3,CONVERT                                     86220042
         LABEL      '','INVALID CHARACTER','LOST BIT SERVICE'           86280042
*                                                                       86340042
         LINE       ,(4,35)                                             86400042
         ROUTINE    BB0BIT7,SKIPPER                                     86460042
         ROUTINE    BB1BIT6,CONVERT                                     86520042
         ROUTINE    BB3BIT4,CONVERT                                     86580042
         LABEL      'HARDWARE ERROR',' DATA CHECK',' TRANSMIT'          86640042
*                                                                       86700042
         LINE       ,(5,35)                                             86760042
         ROUTINE    BB2BIT3,CONVERT                                     86820042
         ROUTINE    BB1BIT7,CONVERT                                     86880042
         ROUTINE    BB3BIT5,CONVERT                                     86940042
         LABEL      'XFER ADAPT WORD LATCH','RESPONSE TIMEOUT',        C87000042
               'DATA TERMINAL READY'                                    87060042
*                                                                       87120042
         LINE                                                           87180042
         ROUTINE    BB2BIT4,CONVERT                                     87240042
         ROUTINE    BB2BIT4,SKIPPER                                     87300042
         ROUTINE    BB3BIT6,CONVERT                                     87360042
         LABEL      'BSC CHARACTER OVERRUN','','REQUEST TO SEND'        87420042
*                                                                       87480042
         LINE                                                           87540042
         ROUTINE    BB2BIT5,CONVERT                                     87600042
         ROUTINE    BB2BIT5,SKIPPER                                     87660042
         ROUTINE    BB3BIT7,CONVERT                                     87720042
         LABEL      'ADAPTER IN PARITY ERROR','','DATA CARRIER OFF'     87780042
*                                                                       87840042
         LINE       ,,SKIP=2                                            87900042
         ROUTINE    BB2BIT6,CONVERT                                     87960042
SPSTARTL LABEL      'CSBO PARITY ERROR'                                 88020042
*                                                                       88080042
         EJECT                                                          88140042
SPSTART  LINE       (29,35),(2,35),SKIP=2                               88200042
         ROUTINE    SPLODATE,SETHEAD                                    88260042
         LABEL      'SPECIAL ERROR LOG SUMMARY'                         88320042
*                                                                       88380042
         LINE       ,(4,35)                                             88440042
         ROUTINE    SPTOTAL,CONVERT                                     88500042
         LABEL      'TOTAL RECORDS PROCESSED'                           88560042
*                                                                       88620042
         LINE       (46,35),(5,35),SKIP=1                               88680042
         ROUTINE    SP70,CONVERT                                        88740042
         LABEL      'ERROR CODE 70 TOTAL RECORDS PROCESSED -'           88800042
*                                                                       88860042
         LINE                                                           88920042
         ROUTINE    SP75,CONVERT                                        88980042
         LABEL      'ERROR CODE 75 TOTAL RECORDS PROCESSED -'           89040042
         LINE                                                           89041042
         ROUTINE    SP78,CONVERT                                        89042042
         LABEL      'ERROR CODE 78 TOTAL RECORDS PROCESSED -'           89043042
         LINE                                                           89044042
         ROUTINE    SP79,CONVERT                                        89045042
         LABEL      'ERROR CODE 79 TOTAL RECORDS PROCESSED -'           89046042
         LINE                                                           89047042
         ROUTINE    SP7A,CONVERT                                        89048042
         LABEL      'ERROR CODE 7A TOTAL RECORDS PROCESSED -'           89049042
         LINE       ,,SKIP=2                                            89050042
         ROUTINE    SP7X,CONVERT                                        89051042
         LABEL      'ERROR CODE 7X TOTAL RECORDS PROCESSED -'           89052042
*                                                                       89100042
         LINE       ,,SKIP=1                                            89160042
         ROUTINE    DUM1,SKIPPER                                        89220042
         LABEL      'AREA STA.      ERROR     ERROR     ERROR     ERRORX89280042
               '                                                        89340042
         LINE                                                           89400042
         ROUTINE    DUM1,SKIPPER                                        89460042
         LABEL      ' ADDRESS      CODE 71   CODE 72   CODE 73   CODE 7X89520042
               4'                                                       89580042
         LINE       ,,SKIP=1                                            89640042
         ROUTINE    DUM3,SKIPPER                                        89700042
         LABEL      ' -----         -----     -----     -----     -----X89760042
               '                                                        89820042
         LINE       ,,SKIP=1                                            89880042
         ROUTINE    SP,SORTSPEC                                         89940042
         LABEL      ''                                                  90000042
SPECIALR LINE       (8,11),(1,1),SKIP=1                                 90060042
         ROUTINE    SP,SETSPEC                                          90120042
         LABEL      ''                                                  90180042
         LINE                                                           90240042
         ROUTINE    SP,SKIPPER                                          90300042
ASSTARTL LABEL      ''                                                  90360042
*                                                                       90420042
         EJECT                                                          90480042
*                                                                       90540042
ASSTART  LINE       (29,35),(2,35),SKIP=2                               90600042
         ROUTINE    ASLODATE,SETHEAD                                    90660042
         LABEL      'AREA STATION ERROR SUMMARY'                        90720042
*                                                                       90780042
         LINE                                                           90840042
         ROUTINE    ASTOTAL,CONVERT                                     90900042
         LABEL      'TOTAL RECORDS PROCESSED'                           90960042
*                                                                       91020042
         LINE       ,(5,1),SKIP=1                                       91080042
         ROUTINE    DUM1,SKIPPER                                        91140042
         LABEL      'ERROR TYPE---------(0)------(1)------(2)------(3)-X91200042
               -----(4)------(5)------(6)------(7)------(8)------(9)'   91260042
*                                                                       91320042
         LINE       ,(14,1)                                             91380042
         ROUTINE    DUM1,SKIPPER                                        91440042
         LABEL      'TOTAL  AREA STA  DEVICE   INVALID   CHANGE  CHANGEX91500042
               - END REQST RECEIVE   NULL    RECORD   VALID'            91560042
*                                                                       91620042
         LINE       ,(1,1)                                              91680042
         ROUTINE    DUM1,SKIPPER                                        91740042
         LABEL      'AREA DEV.   RECORDS  ADDRESS  ADDRESS AREA STA  INX91800042
               -DATA IN STATUS STATUS    DATA   ACKNWLDG LGTH CHK CHAR *91860042
               CK'                                                      91920042
*                                                                       91980042
         LINE       (2,1),,SKIP=1                                       92040042
         ROUTINE    DUM1,SKIPPER                                        92100042
         LABEL      'STA. ADDR  PROCESSED ERROR    ERROR   RESPONSE    *92160042
               BYTE    BYTE    ERROR    OVERRUN  OVERRUN  ERROR     ERR*92220042
               OR'                                                      92280042
*                                                                       92340042
         LINE       ,,SKIP=1                                            92400042
         ROUTINE    AS,SORTAREA                                         92460042
         LABEL      ''                                                  92520042
AREASTA  LINE                                                           92580042
         ROUTINE    AS,SETAREA                                          92640042
AREASTAL LABEL      ''                                                  92700042
*                                                                       92760042
         LINE       (15,1),(3,1)                                        92820042
         ROUTINE    ASF0,CONVERT                                        92880042
         LABEL      'F0'                                                92940042
*                                                                       93000042
         LINE                                                           93060042
         ROUTINE    ASF1,CONVERT                                        93120042
FRBUFFL  LABEL      'F1'                                                93180042
*                                                                       93240042
*                                                                       93300042
         EJECT                                                          93360042
FRBUFF   LINE                                                           93420042
         ROUTINE    DUM1,FREECORE                                       93480042
         LABEL      ''                                                  93540042
         DC    X'FF'                                                    93600042
         DC    XL6'00'                                                  93660042
         DC    C'$'                                                     93720042
LABELS   EQU   *                                                        93780042
         LSTART                                                         93840042
         END                                                            93900042
