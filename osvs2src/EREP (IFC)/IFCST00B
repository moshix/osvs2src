         MACRO                                                          00050042
         SPECIAL &ROUTINE,&PARAM,&SPACE=                                00100042
.*                            THIS MACRO GENERATES A SPECIAL ROUTINE    00150042
.*                                 ENTRY TO BE PROCESSED BY THE SUM. M. 00200042
.*                            &ROUTINE - SYMBOL ON SPECIAL ROUTINE EWT. 00250042
.*                            &PARAM - AN 8 BIT BINARY REPRESENTATION   00300042
.*                                 TO OCCUPY THE 'MASK' FIELD BUT TO BE 00350042
.*                                 INTERPRETED AS AN ARGUMENT OF THE    00400042
.*                                 SPECIAL ROUTINE.                     00450042
.*                            &SPACE - THE NUMBER OF 2BYTE COUNTERS TO  00500042
.*                                 ALLOCATE FOR REQUIRED PROCESSING.    00550042
         GBLC  &CSECT                                                   00600042
         GBLA  &COUNTR                                                  00650042
         LCLA  &ADD                                                     00700042
         DC    AL1(128)                                                 00750042
         DC    BL.8'&PARAM'                                             00800042
         DC    AL2(&ROUTINE-&CSECT)                                     00850042
         DC    AL2(&COUNTR)                                             00900042
&ADD     SETA  1                                                        00950042
         AIF   ('&SPACE' EQ '').NORM                                    01000042
&ADD     SETA  &SPACE                                                   01050042
.NORM    ANOP                                                           01100042
&COUNTR  SETA  &COUNTR+&ADD                                             01150042
         MEND                                                           01200042
         EJECT                                                          01250042
         MACRO                                                          01300042
         CONVT                                                          01350042
         GBLC  &ITEM(1000),&DSECT                                       01400042
         GBLA  &INITIAL                                                 01450042
         GBLA  &BITS(1000),&ITEMNBR,&SHIFT(1000)                        01500042
         GBLA  &NRENTS                                                  01550042
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN                               01600042
         LCLB  &SUB                                                     01650042
         LCLA  &OP                                                      01700042
         LCLA  &OFFSET,&OUT,&IN,&IND,&IBITS,&ISHIFT                     01750042
.*                                                                      01800042
.*       CONVERT BINARY TO DECIMAL                                      01850042
.*             &NAME IS THE REFERENCE INTO THE DSECT RECORD             01900042
.*             &OUT    IS THE NUMBER OF CHARS TO BE PUT ONTO PRINT LINE 01950042
.*                                      DEFAULT IS FOUR MAXIMUM IS 8    02000042
.*             &IN       IS THE NUMBER OF BYTES AS INPUT                02050042
.*                                      ERROR DEFAULT IS 2 MAXIMUM IS 4 02100042
.*                                                                      02150042
         AIF   (&DIAGTST EQ 0).NOMSG                                    02200042
         AIF   (&INITIAL EQ 0).NOMSG                                    02250042
         AIF   (&DIAGLIN EQ 1).NOMSG                                    02300042
         MNOTE '**NO LINE ASSOCIATED WITH THIS DATA**'                  02350042
*****THE FOLLOWING GENERATED FOR TEST PURPOSES*****                     02400042
*        LINE                                                           02450042
         LINE                                                           02500042
.NOMSG   ANOP                                                           02550042
         AIF   (K'&SYSLIST(1) EQ K'&SYSLIST(1,1)).LLOP                  02600042
&SUB     SETB  1                                                        02650042
.LLOP    ANOP                                                           02700042
&OP      SETA  &OP+1                                                    02750042
&OUT     SETA  4                        .BR NOT NULL ELSE SET TO 4      02800042
         AIF   (&SUB EQ 1).SUBA                                         02850042
         AIF   ('&SYSLIST(3)' EQ '').B  TEST FOR NULL INPUT             02900042
&OUT     SETA  &SYSLIST(3)             SET &OUT FROM INPUT              02950042
         AGO   .A                                                       03000042
.SUBA    AIF   ('&SYSLIST(&OP,3)' EQ '').B                              03050042
&OUT     SETA  &SYSLIST(&OP,3)          SET &OUT FROM INPUT             03100042
.A       AIF   (&OUT GT 0 AND &OUT LT 9).B   TEST RANGE                 03150042
.AERR    MNOTE '*** BYTES OUT INCORRECTLY SPECIFIED DEFAULT USED ***'   03200042
&OUT     SETA  4                                                        03250042
.B       AIF   (&SUB EQ 1).SUBB                                         03300042
         AIF   ('&SYSLIST(2)' EQ '').LOOP    BRANCH IF NULL             03350042
&IN      SETA  &SYSLIST(2)              .SET &IN FROM INPUT             03400042
         AGO   .BB                                                      03450042
.SUBB    AIF   ('&SYSLIST(&OP,2)' EQ '').LOOP                           03500042
&IN      SETA  &SYSLIST(&OP,2)          .SET &IN FROM INPUT             03550042
.BB      AIF   (&IN GT 0 AND &IN LT 5).D     TEST RANGE                 03600042
.BERR    MNOTE '*** BYTES IN INCORRECTLY SPECIFIED DEFAULT USED ***'    03650042
&IN      SETA  2                                                        03700042
         AGO   .D                                                       03750042
.LOOP    ANOP                           .LOOP TO FIND &NAME IN DSECT    03800042
&IND     SETA  &IND+1                   .SET UP LOOP COUNTER            03850042
         AIF   ('&ITEM(&IND)' EQ '&SYSLIST(&OP,1)').FOUND               03900042
         AIF   (&IND LT &ITEMNBR).LOOP  .TEST FOR END OF DSECT          03950042
         MNOTE '*** LOG ITEM NOT DEFINED ***'                           04000042
         MEXIT                                                          04050042
.FOUND   ANOP                                                           04100042
&IBITS   SETA  &BITS(&IND)              .SET UP NUMBER OF BITS SPEC     04150042
         AIF   (&IBITS-((&IBITS/8)*8) EQ 0).C  .TEST FOR MULTIPLE OF 8  04200042
         MNOTE '*** DATA NOT DEFINED A MULTIPLE OF 8 BITS ***'          04250042
         MEXIT                                                          04300042
.C       ANOP                                                           04350042
&IN      SETA  &IBITS/8                 .COMPUTE NUMBER OF BYTES        04400042
         AIF   (&IN LT 1 OR &IN GT 4).BERR  .TEST RANGE B IF IN ERROR   04450042
&ISHIFT  SETA  &SHIFT(&IND)             .SET UP FOR TEST OF BYTE BNDR   04500042
         AIF   (&ISHIFT EQ 0).D         .TEST FOR BYTE BNDRY  !R IF YES 04550042
         MNOTE '*** DATA NOT ALIGNED ON A BYTE BOUNDARY ***'            04600042
         MEXIT                                                          04650042
.*                                                                      04700042
.D       ANOP                                                           04750042
&NRENTS  SETA  &NRENTS+1                                                04800042
         DC    AL.12(&SYSLIST(&OP,1)-&DSECT),AL.4(9)                    04850042
         DC    X'&IN',X'&OUT'                                           04900042
&IND     SETA  0                                                        04950042
         AIF   (&SUB EQ 0).OUTA                                         05000042
         AIF   (&OP LT N'&SYSLIST).LLOP                                 05050042
.OUTA    ANOP                                                           05100042
*                                                                       05150042
         MEND                                                           05200042
         MACRO                                                          05250042
         LINEND                                                         05300042
.*                            THIS MACRO IS USED ONLY BY THE LINE       05350042
.*                                 MACRO TO SET THE NUMBER OF ENTRIES   05400042
.*                                 ASSOCIATED WITH EACH LINE.           05450042
         GBLA  &NRENTS                                                  05500042
         GBLC &NRENTSX                                                  05550042
         AIF   (&NRENTS EQ 0).NORENTS   TEST FOR NO COUNT               05600042
         ORG   &NRENTSX                                                 05650042
         DC    FL1'&NRENTS'                                             05700042
         ORG                                                            05750042
&NRENTS  SETA  0                                                        05800042
.NORENTS ANOP                                                           05850042
B&SYSNDX EQU   *                                                        05900042
&NRENTSX SETC  'B&SYSNDX'                                               05950042
         MEND                                                           06000042
*                                                                       06050042
         MACRO                                                          06100042
         BIN                                                            06150042
.*                                 &SYSLIST(&OP,1) - NAME OF LOG ITEM   06200042
.*                                      RECORD DSECT                    06250042
.*                                 $SYSLIST(&OP,2) - NBR OF SPACES      06300042
.*                                      TO SKIP ON MULTIPLE             06350042
.*                                      PRINT OR NBR OF SPACES          06400042
.*                                      TO BACK UP FROM COLUMN FOR      06450042
.*                                      START OF PRINTING. THE LETTER   06500042
.*                                      B PRECEEDS THE NUMBER (B5) IF   06550042
.*                                      THE LATTER IS DESIRED. OMISSION 06600042
.*                                      OF THIS OPERAND FORCES OPTION 2 06650042
.*                                      WITH BACKUP SPACING EQUAL TO    06700042
.*                                 THE NUMBER OF BITS IN THE ITEM       06750042
.*                                 DEFINITION (VIA MACRO 'DSGEN').      06800042
.*                            A LIMIT OF 15 BITS IS IMPOSED FOR THE     06850042
.*                                 TOTAL NUMBER OF BITS TO PRINT.       06900042
         GBLA  &INITIAL                                                 06950042
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN                               07000042
         GBLC &ITEM(1000)                                               07050042
         GBLA &ITEMNBR,&BITS(1000),&SHIFT(1000),&NRENTS                 07100042
         GBLC  &DSECT                                                   07150042
         LCLB  &B,&SUB                                                  07200042
         LCLA  &IBITS,&NDX,&ISHIFT,&K                                   07250042
         LCLA  &TEMP,&T,&OP                                             07300042
         LCLC  &S                                                       07350042
         AIF   (&DIAGTST EQ 0).NOMSG                                    07400042
         AIF   (&INITIAL EQ 0).NOMSG                                    07450042
         AIF   (&DIAGLIN EQ 1).NOMSG                                    07500042
         MNOTE '**NO LINE ASSOCIATED WITH THIS DATA**'                  07550042
*****THE FOLLOWING GENERATED FOR TEST PURPOSES*****                     07600042
*        LINE                                                           07650042
         LINE                                                           07700042
.NOMSG   ANOP                                                           07750042
         AIF   (K'&SYSLIST(1) EQ K'&SYSLIST(1,1)).LOOP                  07800042
&SUB     SETB  1                                                        07850042
.LOOP    ANOP                                                           07900042
&OP      SETA  &OP+1                                                    07950042
.LOOP1   ANOP                                                           08000042
&NDX     SETA  &NDX+1                                                   08050042
         AIF   ('&ITEM(&NDX)' EQ '&SYSLIST(&OP,1)').FOUND               08100042
         AIF   (&NDX LT &ITEMNBR).LOOP1                                 08150042
         MNOTE '**LOG ITEM NOT DEFINED**'                               08200042
         MEXIT                                                          08250042
.FOUND   ANOP                                                           08300042
&ISHIFT  SETA  &SHIFT(&NDX)                                             08350042
&IBITS   SETA  &BITS(&NDX)                                              08400042
&T       SETA  &IBITS-1                                                 08450042
&B       SETB  0                                                        08500042
         AIF   (&IBITS GT 0 AND &IBITS LT 16).SUB0                      08550042
         MNOTE '**NO. OF BITS OUTSIDE RANGE OF 1-15**'                  08600042
         MEXIT                                                          08650042
.SUB0    AIF   (&SUB EQ 1).SUBA                                         08700042
         AIF   ('&SYSLIST(2)' EQ '').BACKUP                             08750042
&K       SETA  K'&SYSLIST(2)                                            08800042
&B       SETB  ('&SYSLIST(2)'(1,1) EQ 'B')                              08850042
&S       SETC  '&SYSLIST(2)'(&B+1,&K-&B)                                08900042
         AGO   .SUBB                                                    08950042
.SUBA    ANOP                                                           09000042
         AIF   ('&SYSLIST(&OP,2)' EQ '').BACKUP                         09050042
&K       SETA  K'&SYSLIST(&OP,2)                                        09100042
&B       SETB  ('&SYSLIST(&OP,2)'(1,1) EQ 'B')                          09150042
&S       SETC  '&SYSLIST(&OP,2)'(&B+1,&K-&B)                            09200042
.SUBB    ANOP                                                           09250042
&T       SETA  &S                                                       09300042
.BACKUP  ANOP                                                           09350042
&NRENTS  SETA  &NRENTS+1                                                09400042
&TEMP    SETA  &ISHIFT                                                  09450042
         AIF   (&IBITS NE 1 OR &B NE 0).BIN2                            09500042
         DC    AL.12(&SYSLIST(&OP,1)-&DSECT),XL.4'&TEMP'                09550042
         AGO   .OUT                                                     09600042
.BIN2    AIF   ('&SYSLIST(&OP,2)' NE '').BIN3                           09650042
&B       SETB  1                                                        09700042
.BIN3    ANOP                                                           09750042
         DC    AL.12(&SYSLIST(&OP,1)-&DSECT),XL.4'C'                    09800042
         DC    BL.1'&B',AL.7(&T),AL.4(&IBITS),FL.4'&ISHIFT'             09850042
.OUT     ANOP                                                           09900042
&NDX     SETA  0                                                        09950042
         AIF   (&SUB EQ 0).OUTA                                         10000042
         AIF   (&OP LT N'&SYSLIST).LOOP                                 10050042
.OUTA    ANOP                                                           10100042
         MEND                                                           10150042
         MACRO                                                          10200042
         HEX                                                            10250042
.*                            THIS MACRO FACILITATES GENERATION OF THE  10300042
.*                                 TABLE ENTRIES SPECIFYING HEX TYPE    10350042
.*                                 CONVERSIONS.                         10400042
.*                            &SYSLIST(&OP,1) - NAME OF DATA ITEM TO BE 10450042
.*                                 CONVERTED                            10500042
.*                            &SYSLIST(&OP,2) - # OF SPACES TO SKIP ON  10550042
.*                                 MULTIPLE PRINT OR NBR OF SPACES TO   10600042
.*                                 BACK UP FROM COLUMN FOR START OF     10650042
.*                                 PRINTING. THE LETTER B PRECEEDS THE  10700042
.*                                 NUMBER (B8) IF THE LATTER OPTION IS  10750042
.*                                 DESIRED. OMISSION OF THIS OPERAND    10800042
.*                                 FORCES OPTION 2 WITH BACKUP SPACING  10850042
.*                                 EQUAL TO THE NUMBER OF BYTES SPECI-  10900042
.*                                 FIED BY THE NEXT OPERAND (TWICE THIS 10950042
.*                                 NUMBER IF SUFFIX IS EXPLICITLY OR    11000042
.*                                 IMPLICITLY B).                       11050042
.*                            &SYSLIST(&OP,3) - NUMBER OF BYTES TO      11100042
.*                                 PROCESS. THIS NUMBER IS SUFFIXED     11150042
.*                                 WITH AN L,R, OR B TO STIPULATE       11200042
.*                                 PRINTING OF THE LEFT HALF, RIGHT     11250042
.*                                 HALF, OR BOTH HALVES OF THE BYTE     11300042
.*                                 RESPECTIVELY. OMISSION OF THIS       11350042
.*                                 OPERAND DEFAULTS TO B WITH THE NUM-  11400042
.*                                 BER OF BYTES EQUAL TO THE ITEM LNGTH 11450042
.*                            A NEW ENTRY IS GENERATED ONLY WHEN NECES- 11500042
.*                                 SARY. THIS MACRO MUST BE THE FIRST   11550042
.*                                 MACRO INSTRUCTION ISSUED FOR THE     11600042
.*                                 SUBJECT LINE(S).                     11650042
         GBLC &ITEM(1000),&DSECT                                        11700042
         GBLA &ITEMNBR,&BITS(1000),&SHIFT(1000),&NRENTS                 11750042
         GBLA  &INITIAL                                                 11800042
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN                               11850042
         LCLB  &B,&SUB                                                  11900042
         LCLA  &IBITS,&NDX,&ISHIFT,&K,&T,&CODE,&BYTESP,&OP              11950042
         LCLC  &S,&LETTER                                               12000042
         AIF   (&DIAGTST EQ 0).NOMSG                                    12050042
         AIF   (&INITIAL EQ 0).NOMSG                                    12100042
         AIF   (&DIAGLIN EQ 1).NOMSG                                    12150042
         MNOTE '**NO LINE ASSOCIATED WITH THIS DATA**'                  12200042
*****THE FOLLOWING GENERATED FOR TEST PURPOSES*****                     12250042
*        LINE                                                           12300042
         LINE                                                           12350042
.NOMSG   ANOP                                                           12400042
         AIF   (K'&SYSLIST(1) EQ K'&SYSLIST(1,1)).LOOP                  12450042
&SUB     SETB  1                                                        12500042
.LOOP    ANOP                                                           12550042
&OP      SETA  &OP+1                                                    12600042
.LOOP1   ANOP                                                           12650042
&NDX     SETA  &NDX+1                                                   12700042
         AIF   ('&ITEM(&NDX)' EQ '&SYSLIST(&OP,1)').FOUND               12750042
         AIF   (&NDX LT &ITEMNBR).LOOP1                                 12800042
         MNOTE '**LOG ITEM NOT DEFINED**'                               12850042
         MEXIT                                                          12900042
.FOUND   ANOP                                                           12950042
&ISHIFT  SETA  &SHIFT(&NDX)                                             13000042
&IBITS   SETA  &BITS(&NDX)                                              13050042
         AIF   (&ISHIFT EQ 0 OR &ISHIFT EQ 4).ALIGN                     13100042
.ERR     MNOTE '**DATA NOT ALLIGNED ON HEX OR BYTE BOUNDARY**'          13150042
         MEXIT                                                          13200042
.ALIGN   ANOP                                                           13250042
&CODE    SETA  1                                                        13300042
         AIF   (&SUB EQ 1).SUBA                                         13350042
&K       SETA  K'&SYSLIST(3)                                            13400042
         AGO   .SUBB                                                    13450042
.SUBA    ANOP                                                           13500042
&K       SETA  K'&SYSLIST(&OP,3)                                        13550042
.SUBB    ANOP                                                           13600042
         AIF   (&IBITS-(&IBITS/4)*4 EQ 0).OK                            13650042
         MNOTE '**BIT LENGTH SPECIFICATION INCONSISTENT WITH CONTROL**' 13700042
         MEXIT                                                          13750042
.OK      AIF   (&SUB EQ 1).SUBC                                         13800042
         AIF   ('&SYSLIST(3)' EQ '').USEDEFN                            13850042
&LETTER  SETC  '&SYSLIST(3)'(&K,1)                                      13900042
&S       SETC  '&SYSLIST(3)'(1,&K-1)                                    13950042
         AGO   .SUBD                                                    14000042
.SUBC    ANOP                                                           14050042
         AIF   ('&SYSLIST(&OP,3)' EQ '').USEDEFN                        14100042
&LETTER  SETC  '&SYSLIST(&OP,3)'(&K,1)                                  14150042
&S       SETC  '&SYSLIST(&OP,3)'(1,&K-1)                                14200042
.SUBD    ANOP                                                           14250042
&BYTESP  SETA  &S                                                       14300042
         AIF   ('&LETTER' EQ 'B').BOTH                                  14350042
         AIF   ('&LETTER' EQ 'L').LEFT                                  14400042
&CODE    SETA  2                                                        14450042
         AGO   .L                                                       14500042
.LEFT    ANOP                                                           14550042
&CODE    SETA  1                                                        14600042
         AGO   .L                                                       14650042
.USEDEFN ANOP                                                           14700042
&BYTESP  SETA  &IBITS/8                                                 14750042
.BOTH    AIF   (&ISHIFT NE 0).ERR                                       14800042
&CODE    SETA  3                                                        14850042
&T       SETA  &BYTESP*2-1                                              14900042
&S       SETC  '&T'                                                     14950042
.OK2     AIF   (&ISHIFT EQ 0).L                                         15000042
&CODE    SETA  2                                                        15050042
.L       ANOP                                                           15100042
&B       SETB  1                                                        15150042
         AIF   (&SUB EQ 1).SUBE                                         15200042
         AIF   ('&SYSLIST(2)' EQ '').BACKUP                             15250042
&K       SETA  K'&SYSLIST(2)                                            15300042
&B       SETB  ('&SYSLIST(2)'(1,1) EQ 'B')                              15350042
&S       SETC  '&SYSLIST(2)'(&B+1,&K-&B)                                15400042
         AGO   .SUBF                                                    15450042
.SUBE    ANOP                                                           15500042
         AIF   ('&SYSLIST(&OP,2)' EQ '').BACKUP                         15550042
&K       SETA  K'&SYSLIST(&OP,2)                                        15600042
&B       SETB  ('&SYSLIST(&OP,2)'(1,1) EQ 'B')                          15650042
&S       SETC  '&SYSLIST(&OP,2)'(&B+1,&K-&B)                            15700042
.SUBF    ANOP                                                           15750042
.BACKUP  ANOP                                                           15800042
&NRENTS  SETA  &NRENTS+1                                                15850042
         AIF   (&BYTESP GT 0 AND &BYTESP LT 16).SUB0                    15900042
         MNOTE '**NO. OF BYTES OUTSIDE RANGE OF 1-15**'                 15950042
         MEXIT                                                          16000042
.SUB0    AIF   (&SUB EQ 1).SUBG                                         16050042
         DC    AL.12(&SYSLIST(1)-&DSECT),XL.4'A'                        16100042
         AGO   .SUBH                                                    16150042
.SUBG    ANOP                                                           16200042
         DC    AL.12(&SYSLIST(&OP,1)-&DSECT),XL.4'A'                    16250042
.SUBH    ANOP                                                           16300042
         DC    BL.1'&B',FL.7'&S',AL.4(&BYTESP),FL.4'&CODE'              16350042
.OUT     ANOP                                                           16400042
&NDX     SETA  0                                                        16450042
         AIF   (&SUB EQ 0).OUTA                                         16500042
         AIF   (&OP LT N'&SYSLIST).LOOP                                 16550042
.OUTA    ANOP                                                           16600042
         MEND                                                           16650042
         MACRO                                                          16700042
         LSTART                                                         16750042
.*                            THIS MACRO IS ISSUED WHEN THE LABEL AREA  16800042
.*                                 OF THE TABLE IS TO BEGIN.            16850042
         GBLA  &LABELNR                                                 16900042
         GBLC  &LBL(100)                                                16950042
         GBLC &LABELS(2000)                                             17000042
         GBLA  &LBLCTR(100)                                             17050042
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN                               17100042
         LCLA  &NDX,&CTR                                                17150042
         AIF   (&DIAGTST EQ 0).NODIAG                                   17200042
         AIF   (&DIAGSET EQ 0).NODIAG                                   17250042
         MNOTE '**NO LABEL ASSOCIATED WITH LAST SET**'                  17300042
***** THE FOLLOWING GENERATED FOR TEST PURPOSES *****                   17350042
*        LABEL '%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%'       17400042
               LABEL '%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%' 17450042
.NODIAG  ANOP                                                           17500042
         LINEND                                                         17550042
&CTR     SETA  1                                                        17600042
.LOOP    ANOP                                                           17650042
&NDX     SETA  &NDX+1                                                   17700042
         AIF   (&LBLCTR(&CTR) NE &NDX).NOLBL                            17750042
&LBL(&CTR) DC  C'&LABELS(&NDX)'                                         17800042
&CTR     SETA  &CTR+1                                                   17850042
         AGO   .LOOPCTL                                                 17900042
.NOLBL   ANOP                                                           17950042
         DC    C'&LABELS(&NDX)'                                         18000042
.LOOPCTL AIF   (&NDX LT &LABELNR).LOOP                                  18050042
         MEND                                                           18100042
         MACRO                                                          18150042
&NAME    LABEL &LABEL1,&LABEL2,&LABEL3,&LABEL4,&LABEL5,&LABEL6,        C18200042
               &LABEL7,&LABEL8                                          18250042
.*                                 THIS MACRO ALLOWS LABELS TO          18300042
.*                                 BE SPECIFIED FOR A GIVEN LINE. THE   18350042
.*                                 LABELS SHOULD BE ENCLOSED IN QUOTA-  18400042
.*                                 TION MARKS. THE COLUMN AND LINE END  18450042
.*                                 CONTROLS WILL BE INSERTED BY THE     18500042
.*                                 MACRO. OMITTED OPERANDS MEAN NO      18550042
.*                                 LABEL REQUIRED FOR RESPECTIVE        18600042
.*                                 COLUMN.                              18650042
         GBLC &LABELS(2000)                                             18700042
         GBLC  &LBL(100)                                                18750042
         GBLA  &LBLCTR(100)                                             18800042
         GBLA  &LABELNR                                                 18850042
         GBLA  &NRENTS,&LPTR,&INITIAL                                   18900042
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN                               18950042
         LCLC  &MARGIN,&TACK                                            19000042
         LCLC  &TEXT                                                    19050042
         LCLA  &OP,&K,&START,&NRCHAR,&REMAIN                            19100042
         AIF   (&INITIAL EQ 0).DIAGCLR                                  19150042
         AIF   (&DIAGTST EQ 0).DIAGCLR                                  19200042
         AIF   (&DIAGLIN EQ 1).DIAGCLR                                  19250042
         MNOTE '**NO LINE ASSOCIATED WITH PREVIOUS LABEL**'             19300042
***** THE FOLLOWING GENERATED FOR TEST PURPOSES *****                   19350042
*        LINE                                                           19400042
         LINE                                                           19450042
.DIAGCLR ANOP                                                           19500042
&DIAGSET SETB  0                                                        19550042
&DIAGLIN SETB  0                                                        19600042
&MARGIN  SETC  '*'                                                      19650042
         AIF   ('&NAME' EQ '').LOOPOUT                                  19700042
&LPTR    SETA  &LPTR+1                                                  19750042
&LBL(&LPTR) SETC '&NAME'                                                19800042
&LBLCTR(&LPTR) SETA &LABELNR+1                                          19850042
.LOOPOUT ANOP                                                           19900042
&OP      SETA  &OP+1                                                    19950042
&K       SETA  K'&SYSLIST(&OP)                                          20000042
         AIF (&K GE 2).NORM                                             20050042
&K       SETA  2                                                        20100042
.NORM    ANOP                                                           20150042
&START   SETA  2                                                        20200042
         AIF (&OP LT N'&SYSLIST).NOTLAST                                20250042
&MARGIN  SETC  '$'                                                      20300042
.NOTLAST ANOP                                                           20350042
&NRCHAR  SETA  8                                                        20400042
&TACK    SETC  ''                                                       20450042
.LOOPIN  ANOP                                                           20500042
&REMAIN  SETA  &K-&START                                                20550042
         AIF (&REMAIN GE 8).MORE                                        20600042
&TACK    SETC  '&MARGIN'                                                20650042
&NRCHAR  SETA  &REMAIN                                                  20700042
.MORE    ANOP                                                           20750042
&TEXT    SETC  ''                                                       20800042
         AIF (&REMAIN EQ 0).ENDTEXT                                     20850042
&TEXT    SETC  '&SYSLIST(&OP)'(&START,&NRCHAR)                          20900042
.ENDTEXT ANOP                                                           20950042
&LABELNR SETA  &LABELNR+1                                               21000042
&LABELS(&LABELNR) SETC '&TEXT'.'&TACK'                                  21050042
&START   SETA  &START+8                                                 21100042
         AIF ('&TACK' EQ '').LOOPIN                                     21150042
         AIF ('&TACK' EQ '*').LOOPOUT                                   21200042
         MEND                                                           21250042
         MACRO                                                          21300042
&NAME    LINE  &DATA,&LABEL,&SKIP=                                      21350042
.*                            THIS MACRO ESTABLISHES THE MARGINS OR     21400042
.*                                 COLUMN SETTINGS FOR EACH LINE. IT    21450042
.*                                 GENERATES NECESSARY CARRIAGE CONTROL 21500042
.*                                 ENTRIES. LASTLY IT DETERMINES THE    21550042
.*                                 NUMBER OF ENTRIES ASSOCIATED WITH    21600042
.*                                 THE PREVIOUS LINE AND STORES THAT #  21650042
.*                                 INTO THE APPROPRIATE BYTE.           21700042
.*                            &DATA(1) - CHARACTER POSITION TO BEGIN    21750042
.*                                 DATA.                                21800042
.*                            &DATA(2) - # OF SPACES BETWEEN SUCCESSIVE 21850042
.*                                 DATA COLUMN STARTING CHARACTERS.     21900042
.*                            &LABEL(1) - CHAR. POS. TO BEGIN LABELS.   21950042
.*                            &LABEL(2) - # SPACES BETWEEN LINE'S LABEL 22000042
.*                                 STARTING CHARACTERS.                 22050042
.*                            &SKIP= - # OF LINES TO ADVANCE CARRIAGE   22100042
.*                                 TO BEGIN NEXT PRINTED LINE.          22150042
.*                            NEW ENTRIES ARE GENERATED ONLY WHEN       22200042
.*                                 NECESSARY. OMISSION OF ITEMS MEANS   22250042
.*                                 THEY HAVE NOT CHANGED SINCE PREVIOUS 22300042
.*                                 SETTINGS. A LINE MACRO IS REQUIRED   22350042
.*                                 FOR EACH PRINTED LINE. IF NO SETTING 22400042
.*                                 CHANGES ARE REQUIRED ALL OPERANDS    22450042
.*                                 ARE OMITTED IN WHICH CASE ONLY THE   22500042
.*                                 # OF ENTRIES FOR THE PREVIOUS LINE   22550042
.*                                 IS COMPUTED. THIS MACRO MUST BE THE  22600042
.*                                 FIRST MACRO INSTRUCTION ISSUED FOR   22650042
.*                                 THE SUBJECT LINE                     22700042
         GBLA  &DB,&DT,&LB,&LT,&NRENTS                                  22750042
         GBLA  &LASTCC,&INITIAL                                         22800042
         GBLC  &NRENTSX                                                 22850042
         GBLC  &CARRCON                                                 22900042
         GBLB  &TEST                                                    22950042
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN                               23000042
         LCLA  &S                                                       23050042
         AIF   (&INITIAL EQ 0 OR &DIAGTST EQ 0).DIAGSET                 23100042
         AIF   (&DIAGSET EQ 0).DIAGSET                                  23150042
         MNOTE '**NO LABEL ASSOCIATED WITH LAST SET**'                  23200042
***** THE FOLLOWING GENERATED FOR TEST PURPOSES *****                   23250042
*        LABEL '%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%'       23300042
               LABEL '%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%' 23350042
.DIAGSET ANOP                                                           23400042
&DIAGSET SETB  1                                                        23450042
&DIAGLIN SETB  1                                                        23500042
&NAME    DS    0C                                                       23550042
         AIF   (&INITIAL EQ 0).FIRSTLN                                  23600042
         LINEND                                                         23650042
         AGO   .NTFIRST                                                 23700042
.FIRSTLN ANOP                                                           23750042
&NRENTSX SETC  'N&SYSNDX'                                               23800042
&INITIAL SETA  1                                                        23850042
N&SYSNDX EQU   *                                                        23900042
.NTFIRST ANOP                                                           23950042
         DC    AL1(0)                                                   24000042
         AIF   ('&DATA(1)' EQ '').CKDTABS                               24050042
         AIF   (&DATA(1) EQ &DB).CKDTABS                                24100042
&DB      SETA  &DATA(1)                                                 24150042
         AGO   .AA                                                      24200042
.CKDTABS AIF   ('&DATA(2)' EQ '').NCDATA                                24250042
         AIF   (&DATA(2) EQ &DT).NCDATA                                 24300042
         AGO   .CC                                                      24350042
.AA      AIF   ('&DATA(2)' EQ '').BB                                    24400042
         AIF   (&DATA(2) EQ &DT).BB                                     24450042
.CC      ANOP                                                           24500042
&DT      SETA  &DATA(2)                                                 24550042
.BB      DC    XL2'FFFE'                                                24600042
         DC    FL1'&DB'                                                 24650042
         DC    FL1'&DT'                                                 24700042
&NRENTS  SETA  &NRENTS+1                                                24750042
.NCDATA  ANOP                                                           24800042
         AIF   ('&LABEL(1)' EQ '').CKLTABS                              24850042
         AIF   (&LABEL(1) EQ &LB).CKLTABS                               24900042
&LB      SETA  &LABEL(1)                                                24950042
         AGO   .AAA                                                     25000042
.CKLTABS AIF   ('&LABEL(2)' EQ '').NCLABEL                              25050042
         AIF   (&LABEL(2) EQ &LT).NCLABEL                               25100042
         AGO   .CCC                                                     25150042
.AAA     AIF   ('&LABEL(2)' EQ '').BBB                                  25200042
         AIF   (&LABEL(2) EQ &LT).BBB                                   25250042
.CCC     ANOP                                                           25300042
&LT      SETA  &LABEL(2)                                                25350042
.BBB     DC    XL2'FFFF'                                                25400042
         DC    FL1'&LB'                                                 25450042
         DC    FL1'&LT'                                                 25500042
&NRENTS  SETA  &NRENTS+1                                                25550042
.NCLABEL ANOP                                                           25600042
         AIF   ('&SKIP' NE '').CONT                                     25650042
         AIF   (&TEST EQ 0).NOCHANG                                     25700042
         AGO   .DEFALTA                                                 25750042
.CONT    ANOP                                                           25800042
         AIF   (&TEST EQ 0).AB                                          25850042
         AIF   ('&SKIP' EQ 'E').AB                                      25900042
&S       SETA  &SKIP                                                    25950042
.DEFAULT ANOP                                                           26000042
         AIF   (&SKIP EQ &LASTCC).DEFALTA                               26050042
         ORG   &CARRCON+3                                               26100042
         DC    AL.3(0),AL.2(&S),AL.3(1)                                 26150042
         ORG                                                            26200042
&LASTCC  SETA  &S                                                       26250042
.DEFALTA ANOP                                                           26300042
&TEST    SETB  0                                                        26350042
         AGO   .DD                                                      26400042
.AB      AIF   ('&SKIP' NE 'E').ABB                                     26450042
A&SYSNDX DC    X'FFFB8B00'              EJECT                           26500042
         AGO   .ABC                                                     26550042
.ABB     AIF   (&SKIP EQ &LASTCC).NOCHANG                               26600042
A&SYSNDX DC    XL2'FFFB'                                                26650042
         DC    AL.3(0),AL.2(&SKIP),AL.3(1)                              26700042
         DC    AL.3(0),AL.2(&SKIP),AL.3(1)                              26750042
&LASTCC  SETA  &SKIP                                                    26800042
&TEST    SETB  1                                                        26850042
.ABC     ANOP                                                           26900042
&CARRCON SETC  'A&SYSNDX'                                               26950042
&NRENTS  SETA  &NRENTS+1                                                27000042
.DD      ANOP                                                           27050042
.NOCHANG ANOP                                                           27100042
         MEND                                                           27150042
         MACRO                                                          27200042
&NAME    ROUTINE &LOGITEM,&RNAME                                        27250042
         GBLA  &NRENTS                                                  27300042
         GBLC  &DSECT,&CSECT                                            27350042
         GBLA  &INITIAL                                                 27400042
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN                               27450042
         AIF   (&DIAGTST EQ 0).NOMSG                                    27500042
         AIF   (&INITIAL EQ 0).NOMSG                                    27550042
         AIF   (&DIAGLIN EQ 1).NOMSG                                    27600042
         MNOTE '**NO LINE ASSOCIATED WITH THIS ROUTINE**'               27650042
*****THE FOLLOWING GENERATED FOR TEST PURPOSES*****                     27700042
*        LINE                                                           27750042
         LINE                                                           27800042
.NOMSG   ANOP                                                           27850042
&NAME    DC    AL.12(&LOGITEM-&DSECT),XL.4'D'                           27900042
         DC    AL2(&RNAME-&CSECT)                                       27950042
&NRENTS  SETA  &NRENTS+1                                                28000042
         MEND                                                           28050042
*  DSGEN MACRO     DSGEN MACRO     DSGEN MACRO     DSGEN MACRO        * 28100042
         SPACE 2                                                        28150042
*  DSGEN MACRO     DSGEN MACRO     DSGEN MACRO     DSGEN MACRO        * 28200042
         SPACE 2                                                        28250042
         MACRO                                                          28300042
&NAME    DSGEN                                                          28350042
.*                            THIS MACRO GENERATES ONE DSECT WORD       28400042
.*                                 FORMATTED FOR THE SUBJECT LOG RECORD 28450042
.*                                 EACH OPERAND HAS TWO SUB LISTS. THE  28500042
.*                                 FIRST IS THE NAME OF THE LOG ITEM    28550042
.*                                 WHILE THE SECOND IS THE # OF BITS TO 28600042
.*                                 ALLOCATE FOR THIS ITEM. ITEMS MUST   28650042
.*                                 BE DEFINED CONTIGUOUSLY WITHOUT GAPS 28700042
.*                                 UNUSED BIT GROUPS MUST BE GIVEN      28750042
.*                                 DUMMY NAMES. THE NAMES PROVIDED FOR  28800042
.*                                 THE LOG ITEMS MAY THEN BE USED IN    28850042
.*                                 THE CONVERSION MACRO INSTRUCTIONS.   28900042
         GBLC &ITEM(1000)                                               28950042
         GBLA &ITEMNBR,&BITS(1000),&SHIFT(1000)                         29000042
         LCLB  &ONLY1,&CTIND                                            29050042
         LCLA  &START1,&START2,&END1,&END2                              29100042
         LCLC  &SYMBOL,&EQUSYM                                          29150042
         LCLA  &OP,&COUNT,&BYTE,&EQUCNT                                 29200042
         ACTR  100000                                                   29250042
.START   AIF   (N'&SYSLIST(&OP+1) LT 3).LOOP                            29300042
         AIF   ('&SYSLIST(&OP+1,3)' EQ 'EQU').LOOP     TEST FOR EQU     29350042
  AIF   ('&SYSLIST(&OP+1,3)' EQ '' OR '&SYSLIST(&OP+1,4)' EQ '').ERR1   29400042
         AIF   ('&SYSLIST(&OP+1,3)' GT '&SYSLIST(&OP+1,4)').ERR3        29450042
&START1  SETA  &SYSLIST(&OP+1,3)        GET START COUNT OF 1            29500042
&START2  SETA  &SYSLIST(&OP+1,4)        GET FIRST END COUNT             29550042
         AGO   .SET2A                   BRANCH AROUND                   29600042
.ERR1    MNOTE '**FIRST SYMBOL CONCATENATION INCOMPLETE**'              29650042
         MEXIT                                                          29700042
.SET2A   AIF   ('&SYSLIST(&OP+1,5)' EQ ''AND '&SYSLIST(&OP+1,6)' EQ '' X29750042
               ).SET2                   TEST FOR NO SECOND              29800042
  AIF   ('&SYSLIST(&OP+1,5)' EQ '' OR '&SYSLIST(&OP+1,6)' EQ '').ERR2   29850042
         AIF   ('&SYSLIST(&OP+1,5)' GT '&SYSLIST(&OP+1,6)').ERR3        29900042
&END1    SETA  &SYSLIST(&OP+1,5)        GET START COUNT OF 2            29950042
&END2    SETA  &SYSLIST(&OP+1,6)        GET END COUNT OF 2              30000042
         AGO   .LOOP                                                    30050042
.SET2    ANOP                                                           30100042
&ONLY1   SETB  1                        INDICATE ONLY ONE CONCATENATION 30150042
         AGO   .LOOP                                                    30200042
.ERR2    MNOTE '**SECOND SYMBOL CONCATENATION INCOMPLETE**'             30250042
         MEXIT                                                          30300042
.ERR3    MNOTE '**START GREATER THAN END CONCATENATION**'               30350042
         MEXIT                                                          30400042
.LOOP    ANOP                                                           30450042
&OP      SETA  &OP+1                                                    30500042
         AIF   (&OP GT N'&SYSLIST).DONE      TEST IF ALL DONE           30550042
&ITEMNBR SETA  &ITEMNBR+1                                               30600042
         AIF   ('&SYSLIST(&OP,2)' NE '').OK1                            30650042
         MNOTE '**NULL BIT COUNT FIELD**'                               30700042
         MEXIT                                                          30750042
.OK1     ANOP                                                           30800042
&SYMBOL  SETC  '&SYSLIST(&OP,1)'                                        30850042
         AIF   ('&SYMBOL' NE '').OK                                     30900042
*              *****     LOG ITEM SYMBOL NOT PROVIDED     *****         30950042
         AIF   ('&SYSLIST(&OP,3)' NE 'EQU').CNT                         31000042
         AGO   .START                   GET NEXT                        31050042
.OK      AIF   (N'&SYSLIST(&OP) LT 3).NO3    TEST FOR OLD FORMAT        31100042
         AIF   ('&SYSLIST(&OP,3)' EQ 'EQU').EQU   TEST FOR EQU          31150042
         AIF   (&ONLY1).OK2             TEST FOR ONLY ONE CONCAT        31200042
&SYMBOL  SETC  '&SYMBOL.&START1.&END1'       GET 1 AND 2 CONCAT         31250042
         AGO   .NO3                     BRANCH AROUND                   31300042
.OK2     ANOP                                                           31350042
&SYMBOL  SETC  '&SYMBOL.&START1'        GET 1 CONCATENATED              31400042
.NO3     ANOP                                                           31450042
&SYMBOL  EQU   *+&BYTE                                                  31500042
&ITEM(&ITEMNBR) SETC '&SYMBOL'          GET LABEL IN GLOBAL             31550042
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2)                                    31600042
&SHIFT(&ITEMNBR) SETA &COUNT-&BYTE*8                                    31650042
.CNT     ANOP                                                           31700042
&CTIND   SETB  1                        SET COUNT INDICATOR             31750042
&COUNT   SETA  &COUNT+&SYSLIST(&OP,2)                                   31800042
&BYTE    SETA  &COUNT/8                                                 31850042
         AIF   (N'&SYSLIST(&OP) LT 3).START  TEST FOR OLD FORMAT        31900042
         AIF   (&ONLY1).TSTST           TEST FOR ONLY ONE CONCAT        31950042
         AIF   (&END1 EQ &END2).TSTST   TEST FOR SECOND END             32000042
&END1    SETA  &END1+1                  INCREMENT COUNT                 32050042
&OP      SETA  &OP-1                    DECREMENT INCREMENT             32100042
         AGO   .LOOP                    GENERATE NEXT                   32150042
.TSTST   ANOP                                                           32200042
         AIF   (&START1 EQ &START2).LPDONE   TEST FOR END               32250042
         AIF   (&ONLY1).NSET1           TEST FOR ONLY ONE CONCAT        32300042
&END1    SETA  &SYSLIST(&OP,5)          RE-INIT SECOND START COUNT      32350042
.NSET1   ANOP                                                           32400042
&OP      SETA  &OP-1                    DECREMENT INDEX                 32450042
&START1  SETA  &START1+1                INCREMENT FIRST COUNT           32500042
         AGO   .LOOP                    GO DO NEXT                      32550042
.LPDONE  ANOP                                                           32600042
&ONLY1   SETB  0                        CLEAR INDICATOR                 32650042
         AGO   .START                   GO TEST FOR MORE SUB-LISTS      32700042
.DONE    AIF   (&COUNT-&COUNT/8*8 NE 0).ERR  TEST FOR MULTIPLE OF EIGHT 32750042
         AIF   (&CTIND EQ 0).END        NO DS IF NO COUNT               32800042
&COUNT   SETA  &COUNT/8                 GET NUMBER OF BYTES             32850042
&NAME    DS    &COUNT.C                                                 32900042
.END     MEXIT                                                          32950042
.ERR     MNOTE '**BIT COUNT FLDS DO NOT TOTAL MULTIPLE OF 8**'          33000042
         MEXIT                                                          33050042
.EQU     AIF   ('&SYSLIST(&OP,4)' NE '').EQU1     TEST FOR NULL LABEL   33100042
.ERR4    MNOTE '**EQU OPERAND OMITTED OR NOT FOUND**'                   33150042
         MEXIT                                                          33200042
.EQU1    AIF   (&SYSLIST(&OP,2) LT 16).EQU2  COUNT OVER FIFTEEN         33250042
*****               THE FOLLOWING STATEMENT                *****        33300042
*****     NUMBER OF BITS EXCEED 15 - DO NOT USE AS BIN     *****        33350042
.EQU2    ANOP                                                           33400042
&EQUCNT  SETA  0                        CLEAR COUNTER                   33450042
&EQUSYM  SETC  '&SYSLIST(&OP,4)'        GET EQU OPERAND                 33500042
.EQULOP  ANOP                                                           33550042
&EQUCNT  SETA  &EQUCNT+1                INCREMENT INDEX                 33600042
         AIF   ('&ITEM(&EQUCNT)' EQ '&EQUSYM').EQUOUT  LABEL FOUND?     33650042
         AIF   (&EQUCNT EQ &ITEMNBR).ERR4    ALL TESTED?                33700042
         AGO   .EQULOP                  NO-GET NEXT                     33750042
.EQUOUT  ANOP                                                           33800042
&ITEM(&ITEMNBR) SETC '&SYMBOL'          GET LABEL NAME                  33850042
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2)    GET NUMBER OF BITS              33900042
&SHIFT(&ITEMNBR) SETA &SHIFT(&EQUCNT)   GET SHIFT COUNT                 33950042
&SYMBOL  EQU   &EQUSYM                  THIS SYMBOL EQUATED             34000042
         AGO   .START                   RETURN FOR NEXT                 34050042
         MEND                                                           34100042
         GBLC  &DSECT,&CSECT                                            34150042
         GBLB  &DIAGTST,&DIAGSET,&DIAGLIN                               34200042
&DIAGTST SETB  1                                                        34250042
&CSECT   SETC  'IFCST00B'                                               34300042
&DSECT   SETC  'T00B'                                                   34350042
IFCST00B CSECT                                                          34400042
         TITLE 'IFCST00B 3270-DIAL SUPPORT SUM  TABLE'                  34450042
****************************************************************        34500042
*                                                              *        34550042
*        3270 SR DIAL FEATURE SUMMARY TABLE                    *        34600042
*                                                              *        34650042
****************************************************************        34700042
EQUAL    EQU   8                                                        34750042
END      EQU   X'FF'                                                    34800042
L0       EQU   0                                                        34850042
L1       EQU   1                                                        34900042
L2       EQU   2                                                        34950042
L3       EQU   3                                                        35000042
L4       EQU   4                                                        35050042
L5       EQU   5                                                        35100042
L6       EQU   6                                                        35150042
L7       EQU   7                                                        35200042
L8       EQU   8                                                        35250042
L9       EQU   9                                                        35300042
L10      EQU   10                                                       35350042
L12      EQU   12                                                       35400042
L28      EQU   28                                                       35450042
L64      EQU   64                                              @Z427VLS 35460042
L32      EQU   32                                              @Z427VLS 35470042
*                                                                       35500042
R0       EQU   0                                                        35550042
R1       EQU   1                                                        35600042
R2       EQU   2                                                        35650042
R3       EQU   3                                                        35700042
R4       EQU   4                                                        35750042
R5       EQU   5                                                        35800042
R6       EQU   6                                                        35850042
R7       EQU   7                                                        35900042
R8       EQU   8                                                        35950042
R9       EQU   9                                                        36000042
R10      EQU   10                                                       36050042
R11      EQU   11                                                       36100042
R12      EQU   12                                                       36150042
R13      EQU   13                                                       36200042
R14      EQU   14                                                       36250042
R15      EQU   15                                                       36300042
*                                                                       36350042
*                                                                       36400042
T00B     DSECT                                                          36450042
         DSGEN (KEY,8),(RELNO,8),(SWS,48)                               36500042
         DSGEN (DATE,32),(TIME,32)                                      36550042
         DSGEN (SPR,8),(SERIAL,24),(MODEL,16),(SPRE,16)                 36600042
         DSGEN (CUA,16),(ID,32),(STAT,16)                               36650042
*                                                                       36700042
IFCST00B CSECT                                                          36750042
         USING *,R9                     BASE REG FOR TABLE              36800042
         USING T00B,R2                  BASE REG FOR RECORD             36850042
         DC    A(ENTRIES)               PTR TO SUMMARY ENTRIES          36900042
         DC    A(PENTRY)                PTR TO EDIT SECTION             36950042
         DC    F'0'                                                     37000042
SCSIZE   DC    H'30'                    NO. OF COUNTERS NEEDED          37050042
         EJECT                                                          37100042
****************************************************************        37150042
*        SPECIAL ROUTINE FOR SUMMARY SECTION                   *        37200042
****************************************************************        37250042
*                                                                       37300042
SAVEDATE CLC   DATE(L4),ZEROS           IS REC DATE ZERO                37350042
         BCR   EQUAL,R14                BR-YES                          37400042
         CLC   L0(L4,R3),ZEROS          IS THIS FIRST TIME              37450042
         BNE   SVEDTE1                  BR NOT 1ST TIME                 37500042
         MVC   L0(L4,R3),DATE           MOVE IN LO DATE                 37550042
SVEDTE1  CLC   DATE(L4),L0(R3)          IS THIS DATE LOWER              37600042
         BL    SAVELOW                  BR-YES                          37650042
         CLC   DATE(L4),L4(R3)          TEST FOR THIS DATE HI           37700042
         BNH   DATESVD                  BR THIS DATE NOT HI             37750042
SAVEHI   MVC   L4(L4,R3),DATE           SAVE HI DATE                    37800042
DATESVD  BR    R14                      RETURN                          37850042
SAVELOW  MVC   L0(L4,R3),DATE           SAVE LOW DATE                   37900042
         BR    R14                      & RETURN                        37950042
*                                                                       38000042
SETERR   STM   R5,R8,XSAVE              SAVE REGS                       38050042
         LH    R5,STAT                  PICK UP ERROR STATS             38100042
         N     R5,STATMASK              MASK OFF UNUSED BITS            38150042
         LA    R6,ERRLIST               SET PTR TO ERROR LIST           38200042
         LR    R7,R3                    SET LOOP REGISTER               38250042
LOOP     TM    L0(R6),END               LOOP DONE                       38300042
         BO    RETURNB                  BR-YES                          38350042
         CH    R5,L0(R6)                IS THIS THE ERROR               38400042
         BE    ADDONE                   BR-YES                          38450042
         LA    R7,L2(R7)                BUMP POINTERS TO NXT CNT       38500042
         LA    R6,L2(R6)                BUMP POINTER TO NEXT ERR3R CODE 38550042
         B     LOOP                                                     38600042
ADDONE   LH    R5,L0(R7)                PICK UP COUNTER                 38650042
         LA    R5,L1(R5)                ADD ONE TO IT                   38700042
         STH   R5,L0(R7)                PUT IT BACK                     38750042
RETURNB  LM    R5,R8,XSAVE              RESTORE REGS                    38800042
         BR    R14                                                      38850042
*                                                                       38900042
*                                                                       38950042
ZEROS    DC    F'0'                                                     39000042
STATMASK DC    X'00000D3F'                                              39050042
ERRLIST  DS    0H                                                       39100042
         DC    X'0C00'                  DB,US                           39150042
         DC    X'0002'                  CC                              39200042
         DC    X'0003'                  CC,OC                           39250042
         DC    X'0020'                  CR                              39300042
         DC    X'0004'                  DC                              39350042
         DC    X'0005'                  DC,OC                           39400042
         DC    X'0404'                  DC,US                           39450042
         DC    X'0405'                  DC,US,OC                        39500042
         DC    X'0008'                  EC                              39550042
         DC    X'0408'                  EC,US                           39600042
         DC    X'0010'                  IR                              39650042
         DC    X'0018'                  IR,EC                           39700042
         DC    X'0418'                  IR,EC,US                        39750042
         DC    X'0011'                  IR,OC                           39800042
         DC    X'0410'                  IR,US                           39850042
         DC    X'0001'                  OC                              39900042
         DC    X'0401'                  OC,US                           39950042
         DC    X'0100'                  TC                              40000042
         DC    X'FFFF'                  END OF ERR LIST                 40050042
         EJECT                                                          40100042
****************************************************************        40150042
*        SUMMARY ENTRIES                                       *        40200042
****************************************************************        40250042
ENTRIES  DS    0F                                                       40300042
         SPECIAL    SAVEDATE,00000000,SPACE=4                           40350042
         SPECIAL    SETERR,00000000,SPACE=60                            40400042
         DC         X'FF'               END OF SUM SECTION              40450042
         EJECT                                                          40500042
****************************************************************        40550042
*        SUMMARY COUNTER DSECT                                 *        40600042
****************************************************************        40650042
S00B     DSECT                                                          40700042
         DSGEN (TBLPTR,32),(FWDPTR,32)                                  40750042
         DSGEN (TOTALREC,16),(TYPE,8),(CHAN,8),(YCUA,24),(YSER,8)       40800042
         DSGEN (YSER1,16),(YCPU,16)                                     40850042
         DSGEN (YSWS,16),(YID,32),(YSPARE,16)                           40900042
         DS    10C                      UNREFERENCED                    40950042
         DSGEN (YLOW,32),(YHI,32)                                       41000042
         DSGEN (STAT,16,1,20)                                           41050042
*                                                                       41100042
         EJECT                                                          41150042
IFCST00B CSECT                                                          41200042
&DSECT   SETC  'S00B'                                                   41250042
&CSECT   SETC  'PENTRY'                                                 41300042
PENTRY   DS    0F                                                       41350042
         USING *,R9                     BASE REG FOR THIS SECT          41400042
         USING S00B,R2                  BASE REG FOR CNTRS              41450042
         DC    A(PEDIT)                                                 41500042
         DC    C'IFCST00B'                                              41550042
YR9PTR   DC    F'0'                                                     41600042
YLABELP  DC    F'0'                                                     41650042
         EJECT                                                          41700042
****************************************************************        41750042
*        SPECIAL ROUTINE SECTION FOR EDIT                      *        41800042
****************************************************************        41850042
*                                                                       41900042
SETDATE  UNPK  WORK(L8),L0(L4,R4)       UNPACK DATE                     41950042
         MVZ   WORK+L7(L1),WORK         MOVE ON PRINTABLE ZONE          42000042
         MVC   L0(L3,R3),WORK+L5        MOVE IN DAY                     42050042
         MVC   L5(L2,R3),WORK+L3        MOVE ON YEAR                    42100042
SKIPPER  BR    R14                      RETURN                          42150042
*                                                                       42200042
SETCPUNO STM   R5,R8,MYSAVE        SAVE WORK  REGS             @Z427VLS 42204042
         SR    R5,R5               CLEAR REG 5                 @Z427VLS 42208042
         ICM   R5,X'3',0(R4)       PICKUP CPU TYPE FIELD       @Z427VLS 42212042
         BNZ   RET1                IF CPU TYPE NOT ZERO, THEN RETURN    42216042
         LA    R6,L64              AMOUNT TO BACK UP           @Z427VLS 42220042
         SR    R3,R6               BACK UP OUTPUT PTR          @Z427VLS 42224042
         MVC   L32(L6,R3),SHARED   SERIAL NO. - SHARED         @Z427VLS 42228042
RET1     LM    R5,R8,MYSAVE        RESTORE REGS                @Z427VLS 42232042
         BR    R14                 RETURN                      @Z427VLS 42236042
*                                                              @Z427VLS 42240042
SHARED   DC    C'SHARED'                                       @Z427VLS 42244042
MOVE4    MVC   L0(L4,R3),L0(R4)         MOVE 4 CHARS TO BUFFER          42250042
         BR    R14                                                      42300042
*                                                                       42350042
FREECORE STM   R14,R12,L12(R13)         SAVE REGS                       42400042
         LR    R12,R13                  SET CHAINS                      42450042
         LA    R13,MYSAVE               IN SAVE AREAS                   42500042
         ST    R12,L4(R13)                                              42550042
         ST    R13,L8(R12)                                              42600042
         L     R3,L4(R2)                PISK UP FWRD POINTER            42650042
         ST    R3,L28(R12)              SAVE PTR IN SAVE AREA           42700042
         LH    R0,SIZE                  PICK UP FREEMAIN SIZE           42750042
         LR    R1,R2                    SET FREEMAIN ADDR               42800042
         FREEMAIN R,LV=(0),A=(1)                                        42850042
         LTR   R3,R3                                                    42900042
         BZ    RETURN0                  NO MORE WORK                    42950042
         LA    R5,PEDIT+L10             SET UP TABLE PTRS               43000042
         LA    R6,LABELS-L1             TO LOOP THROUGH EDIT            43050042
         STM   R5,R6,YR9PTR                                             43100042
RETURN0  L     R13,L4(R13)                                              43150042
         LM    R14,R12,L12(R13)         RESTORE REGS                    43200042
         BR    R14                                                      43250042
*                                                                       43300042
WORK     DC    D'0'                                                     43350042
XSAVE    EQU   *                                                        43400042
MYSAVE   DS    18F                                                      43450042
SIZE     DC    H'98'                                                    43500042
         EJECT                                                          43550042
****************************************************************        43600042
*        SUMMARY EDIT ENTRIES                                  *        43650042
****************************************************************        43700042
PEDIT    DS    0F                                                       43750042
         DC    2H'1'                    FORMAT 1                        43800042
         DC    2H'1'                    FORMAT 2                        43850042
         DC    A(LABELS)                                                43900042
         DC    H'0'                     UNUSED                          43950042
*                                                                       44000042
         LINE       (57,32),(23,26),SKIP=E                              44050042
         LABEL      ''                                                  44100042
         LINE       ,,SKIP=1                                            44150042
         HEX        YCPU,0,2B                                           44200042
         HEX        YSER,0,3B                                           44250042
         ROUTINE YCPU,SETCPUNO                                 @Z427VLS 44270042
         LABEL      'DAY YEAR   DAY YEAR','MODEL -','SERIAL NO.'        44300042
         LINE       (23,11),(1,30)                                      44350042
         ROUTINE    YLOW,SETDATE                                        44400042
         ROUTINE    YHI,SETDATE                                         44450042
         LABEL      'MISC REC DATE RANGE -','TO'                        44500042
*                                                                       44550042
         LINE       (53,26),(1,65)                                      44600042
         HEX        YCUA,0,3B                                           44650042
         ROUTINE    YID,MOVE4                                           44700042
         LABEL      'SUMMARY OF I/O MISCELLANEOUS RECORDS FOR DEVICE', C44750042
               'TERMINAL ID'                                            44800042
*                                                                       44850042
         LINE       (29,18),,SKIP=2                                     44900042
         CONVT      TOTALREC                                            44950042
         LABEL      'TOTAL NUMBER OF RECORDS'                           45000042
*                                                                       45050042
         LINE                                                           45100042
         LABEL      'STATISTICAL SUMMARY'                               45150042
*                                                                       45200042
         LINE       (25,40),(5,40),SKIP=1                               45250042
         CONVT      STAT1                                               45300042
         CONVT      STAT2                                               45350042
         LABEL      'DB,US','CC'                                        45400042
         LINE                                                           45450042
         CONVT      STAT3                                               45500042
         CONVT      STAT4                                               45550042
         LABEL      'CC,OC','CR'                                        45600042
         LINE                                                           45650042
         CONVT      STAT5                                               45700042
         CONVT      STAT6                                               45750042
         LABEL      'DC','DC,OC'                                        45800042
         LINE                                                           45850042
         CONVT      STAT7                                               45900042
         CONVT      STAT8                                               45950042
         LABEL      'DC,US','DC,US,OC'                                  46000042
         LINE                                                           46050042
         CONVT      STAT9                                               46100042
         CONVT      STAT10                                              46150042
         LABEL      'EC','EC,US'                                        46200042
         LINE                                                           46250042
         CONVT      STAT11                                              46300042
         CONVT      STAT12                                              46350042
         LABEL      'IR','IR,EC'                                        46400042
         LINE                                                           46450042
         CONVT      STAT13                                              46500042
         CONVT      STAT14                                              46550042
         LABEL      'IR,EC,US','IR,OC'                                  46600042
         LINE                                                           46650042
         CONVT      STAT15                                              46700042
         CONVT      STAT16                                              46750042
         LABEL      'IR,US','OC'                                        46800042
         LINE                                                           46850042
         CONVT      STAT17                                              46900042
         CONVT      STAT18                                              46950042
         LABEL      'OC,US','TC'                                        47000042
*                                                                       47050042
         LINE                                                           47100042
         ROUTINE    TBLPTR,FREECORE                                     47150042
         LABEL      ''                                                  47200042
*                                                                       47250042
         DC         X'FF'                                               47300042
         DC         XL6'00'                                             47350042
         EJECT                                                          47400042
****************************************************************        47450042
*        LABEL SECTION  X                                      *        47500042
****************************************************************        47550042
         DC         C'$'                                                47600042
LABELS   DS         0C                                                  47650042
         LSTART                                                         47700042
         END                                                            47750042
