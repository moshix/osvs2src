         SPACE 2                                                        00058042
*   MADRID/WINCHESTER SVS REL2 1.7                             @Y17ASRB 00068042
*A001080                                                       @Y17ASRB 00078042
*  LINE MACRO     LINE MACRO     LINE MACRO     LINE MACRO            * 00116042
         MACRO                                                          00174042
&NAME    LINE  &DATA,&LABEL,&SKIP=                                      00232042
.*                            THIS MACRO ESTABLISHES THE MARGINS OR     00290042
.*                                 COLUMN SETTINGS FOR EACH LINE. IT    00348042
.*                                 GENERATES NECESSARY CARRIAGE CONTROL 00406042
.*                                 ENTRIES. LASTLY IT DETERMINES THE    00464042
.*                                 NUMBER OF ENTRIES ASSOCIATED WITH    00522042
.*                                 THE PREVIOUS LINE AND STORES THAT #  00580042
.*                                 INTO THE APPROPRIATE BYTE.           00638042
.*                            &DATA(1) - CHARACTER POSITION TO BEGIN    00696042
.*                                 DATA.                                00754042
.*                            &DATA(2) - # OF SPACES BETWEEN SUCCESSIVE 00812042
.*                                 DATA COLUMN STARTING CHARACTERS.     00870042
.*                            &LABEL(1) - CHAR. POS. TO BEGIN LABELS.   00928042
.*                            &LABEL(2) - # SPACES BETWEEN LINE'S LABEL 00986042
.*                                 STARTING CHARACTERS.                 01044042
.*                            &SKIP= - # OF LINES TO ADVANCE CARRIAGE   01102042
.*                                 TO BEGIN NEXT PRINTED LINE.          01160042
.*                            NEW ENTRIES ARE GENERATED ONLY WHEN       01218042
.*                                 NECESSARY. OMISSION OF ITEMS MEANS   01276042
.*                                 THEY HAVE NOT CHANGED SINCE PREVIOUS 01334042
.*                                 SETTINGS. A LINE MACRO IS REQUIRED   01392042
.*                                 FOR EACH PRINTED LINE. IF NO SETTING 01450042
.*                                 CHANGES ARE REQUIRED ALL OPERANDS    01508042
.*                                 ARE OMITTED IN WHICH CASE ONLY THE   01566042
.*                                 # OF ENTRIES FOR THE PREVIOUS LINE   01624042
.*                                 IS COMPUTED. THIS MACRO MUST BE THE  01682042
.*                                 FIRST MACRO INSTRUCTION ISSUED FOR   01740042
.*                                 THE SUBJECT LINE                     01798042
         GBLA  &DB,&DT,&LB,&LT,&NRENTS                                  01856042
         GBLA  &LASTCC,&INITIAL                                         01914042
         GBLC  &NRENTSX                                                 01972042
         GBLC  &CARRCON                                                 02030042
         GBLB  &TEST                                                    02088042
         LCLA  &S                                                       02146042
&NAME    DS    0C                                                       02204042
         AIF   (&INITIAL EQ 0).FIRSTLN                                  02262042
         LINEND                                                         02320042
         AGO   .NTFIRST                                                 02378042
.FIRSTLN ANOP                                                           02436042
&NRENTSX SETC  'N&SYSNDX'                                               02494042
&INITIAL SETA  1                                                        02552042
N&SYSNDX EQU   *                                                        02610042
.NTFIRST ANOP                                                           02668042
         DC    AL1(0)                                                   02726042
         AIF   ('&DATA(1)' EQ '').CKDTABS                               02784042
         AIF   (&DATA(1) EQ &DB).CKDTABS                                02842042
&DB      SETA  &DATA(1)                                                 02900042
         AGO   .AA                                                      02958042
.CKDTABS AIF   ('&DATA(2)' EQ '').NCDATA                                03016042
         AIF   (&DATA(2) EQ &DT).NCDATA                                 03074042
         AGO   .CC                                                      03132042
.AA      AIF   ('&DATA(2)' EQ '').BB                                    03190042
         AIF   (&DATA(2) EQ &DT).BB                                     03248042
.CC      ANOP                                                           03306042
&DT      SETA  &DATA(2)                                                 03364042
.BB      DC    XL2'FFFE'                                                03422042
         DC    FL1'&DB'                                                 03480042
         DC    FL1'&DT'                                                 03538042
&NRENTS  SETA  &NRENTS+1                                                03596042
.NCDATA  ANOP                                                           03654042
         AIF   ('&LABEL(1)' EQ '').CKLTABS                              03712042
         AIF   (&LABEL(1) EQ &LB).CKLTABS                               03770042
&LB      SETA  &LABEL(1)                                                03828042
         AGO   .AAA                                                     03886042
.CKLTABS AIF   ('&LABEL(2)' EQ '').NCLABEL                              03944042
         AIF   (&LABEL(2) EQ &LT).NCLABEL                               04002042
         AGO   .CCC                                                     04060042
.AAA     AIF   ('&LABEL(2)' EQ '').BBB                                  04118042
         AIF   (&LABEL(2) EQ &LT).BBB                                   04176042
.CCC     ANOP                                                           04234042
&LT      SETA  &LABEL(2)                                                04292042
.BBB     DC    XL2'FFFF'                                                04350042
         DC    FL1'&LB'                                                 04408042
         DC    FL1'&LT'                                                 04466042
&NRENTS  SETA  &NRENTS+1                                                04524042
.NCLABEL ANOP                                                           04582042
         AIF   ('&SKIP' NE '').CONT                                     04640042
         AIF   (&TEST EQ 0).NOCHANG                                     04698042
&S       SETA  &LASTCC                                                  04756042
         AGO   .DEFAULT                                                 04814042
.CONT    ANOP                                                           04872042
         AIF   (&TEST EQ 0).AB                                          04930042
&S       SETA  &SKIP                                                    04988042
.DEFAULT ANOP                                                           05046042
         ORG   &CARRCON+3                                               05104042
         DC    AL.3(0),AL.2(&S),AL.3(1)                                 05162042
         ORG                                                            05220042
&LASTCC  SETA  &S                                                       05278042
&TEST    SETB  0                                                        05336042
         AGO   .DD                                                      05394042
.AB      AIF   (&SKIP EQ &LASTCC).NOCHANG                               05452042
A&SYSNDX DC    XL2'FFFB'                                                05510042
         DC    AL.3(0),AL.2(&SKIP),AL.3(1)                              05568042
         DC    FL1'9'                                                   05626042
&LASTCC  SETA  &SKIP                                                    05684042
&TEST    SETB  1                                                        05742042
&CARRCON SETC  'A&SYSNDX'                                               05800042
&NRENTS  SETA  &NRENTS+1                                                05858042
.DD      ANOP                                                           05916042
.NOCHANG ANOP                                                           05974042
         MEND                                                           06032042
         EJECT                                                          06090042
         SPACE 2                                                        06148042
*  ROUTINE MACRO     ROUTINE MACRO     ROUTINE MACRO     ROUTINE MACRO* 06206042
         MACRO                                                          06264042
&NAME    ROUTINE &LOGITEM,&RNAME                                        06322042
         GBLC  &DSECT,&CSECT                                            06380042
         GBLC  &ITEM(1000)                                              06438042
         GBLA  &SHIFT(1000),&ITEMNBR                                    06496042
         GBLA  &NRENTS                                                  06554042
         LCLA  &ISHIFT,&NDX                                             06612042
.LOOP    ANOP                                                           06670042
&NDX     SETA  &NDX+1                                                   06728042
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      06786042
         AIF   (&NDX LT &ITEMNBR).LOOP                                  06844042
         MNOTE *,'LOG ITEM NOT DEFINED'                                 06902042
         MEXIT                                                          06960042
.FOUND   ANOP                                                           07018042
&ISHIFT  SETA  &SHIFT(&NDX)                                             07076042
&NAME    DC    AL.12(&LOGITEM-&DSECT),XL.4'D'                           07134042
         DC    AL.4(&ISHIFT),AL.12(&RNAME-&CSECT)                       07192042
&NRENTS  SETA  &NRENTS+1                                                07250042
         MEND                                                           07308042
         EJECT                                                          07366042
*        DSGEN  MACRO        D S G E N  M A C R O          DSGEN MACRO  07386042
         MACRO                                                          07406042
&NAME    DSGEN                                                          07426042
.*                            THIS MACRO GENERATES ONE DSECT WORD       07446042
.*                                 FORMATTED FOR THE SUBJECT LOG RECORD 07466042
.*                                 EACH OPERAND HAS TWO SUB LISTS. THE  07486042
.*                                 FIRST IS THE NAME OF THE LOG ITEM    07506042
.*                                 WHILE THE SECOND IS THE # OF BITS TO 07526042
.*                                 ALLOCATE FOR THIS ITEM. ITEMS MUST   07546042
.*                                 BE DEFINED CONTIGUOUSLY WITHOUT GAPS 07566042
.*                                 UNUSED BIT GROUPS MUST BE GIVEN      07586042
.*                                 DUMMY NAMES. THE NAMES PROVIDED FOR  07606042
.*                                 THE LOG ITEMS MAY THEN BE USED IN    07626042
.*                                 THE CONVERSION MACRO INSTRUCTIONS.   07646042
         GBLA  &BITS(1000),&ITEMNBR,&SHIFT(1000)                        07666042
         GBLC  &ITEM(1000)                                              07686042
         LCLB  &ONLY1,&CTIND                                            07706042
         LCLA  &START1,&START2,&END1,&END2                              07726042
         LCLC  &SYMBOL,&EQUSYM                                          07746042
         LCLA  &OP,&COUNT,&BYTE,&EQUCNT                                 07766042
         ACTR  500000                                                   07786042
.START   AIF   (N'&SYSLIST(&OP+1) LT 3).LOOP                            07806042
         AIF   ('&SYSLIST(&OP+1,3)' EQ 'EQU').LOOP     TEST FOR EQU     07826042
  AIF   ('&SYSLIST(&OP+1,3)' EQ '' OR '&SYSLIST(&OP+1,4)' EQ '').ERR1   07846042
         AIF   ('&SYSLIST(&OP+1,3)' GT '&SYSLIST(&OP+1,4)').ERR3        07866042
&START1  SETA  &SYSLIST(&OP+1,3)        GET START COUNT OF 1            07886042
&START2  SETA  &SYSLIST(&OP+1,4)        GET FIRST END COUNT             07906042
         AGO   .SET2A                   BRANCH AROUND                   07926042
.ERR1    MNOTE '**FIRST SYMBOL CONCATENATION INCOMPLETE**'              07946042
         MEXIT                                                          07966042
.SET2A   AIF   ('&SYSLIST(&OP+1,5)' EQ ''AND '&SYSLIST(&OP+1,6)' EQ '' X07986042
               ).SET2                   TEST FOR NO SECOND              08006042
  AIF   ('&SYSLIST(&OP+1,5)' EQ '' OR '&SYSLIST(&OP+1,6)' EQ '').ERR2   08026042
         AIF   ('&SYSLIST(&OP+1,5)' GT '&SYSLIST(&OP+1,6)').ERR3        08046042
&END1    SETA  &SYSLIST(&OP+1,5)        GET START COUNT OF 2            08066042
&END2    SETA  &SYSLIST(&OP+1,6)        GET END COUNT OF 2              08086042
         AGO   .LOOP                                                    08106042
.SET2    ANOP                                                           08126042
&ONLY1   SETB  1                        INDICATE ONLY ONE CONCATENATION 08146042
         AGO   .LOOP                                                    08166042
.ERR2    MNOTE '**SECOND SYMBOL CONCATENATION INCOMPLETE**'             08186042
         MEXIT                                                          08206042
.ERR3    MNOTE '**START GREATER THAN END CONCATENATION**'               08226042
         MEXIT                                                          08246042
.LOOP    ANOP                                                           08266042
&OP      SETA  &OP+1                                                    08286042
         AIF   (&OP GT N'&SYSLIST).DONE      TEST IF ALL DONE           08306042
&ITEMNBR SETA  &ITEMNBR+1                                               08326042
         AIF   ('&SYSLIST(&OP,2)' NE '').OK1                            08346042
         MNOTE '**NULL BIT COUNT FIELD**'                               08366042
         MEXIT                                                          08386042
.OK1     ANOP                                                           08406042
&SYMBOL  SETC  '&SYSLIST(&OP,1)'                                        08426042
         AIF   ('&SYMBOL' NE '').OK                                     08446042
*              *****     LOG ITEM SYMBOL NOT PROVIDED     *****         08466042
         AIF   ('&SYSLIST(&OP,3)' NE 'EQU').CNT                         08486042
         AGO   .START                   GET NEXT                        08506042
.OK      AIF   (N'&SYSLIST(&OP) LT 3).NO3    TEST FOR OLD FORMAT        08526042
         AIF   ('&SYSLIST(&OP,3)' EQ 'EQU').EQU   TEST FOR EQU          08546042
         AIF   (&ONLY1).OK2             TEST FOR ONLY ONE CONCAT        08566042
&SYMBOL  SETC  '&SYMBOL.&START1.&END1'       GET 1 AND 2 CONCAT         08586042
         AGO   .NO3                     BRANCH AROUND                   08606042
.OK2     ANOP                                                           08626042
&SYMBOL  SETC  '&SYMBOL.&START1'        GET 1 CONCATENATED              08646042
.NO3     ANOP                                                           08666042
&SYMBOL  EQU   *+&BYTE                                                  08686042
&ITEM(&ITEMNBR) SETC '&SYMBOL'          GET LABEL IN GLOBAL             08706042
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2)                                    08726042
&SHIFT(&ITEMNBR) SETA &COUNT-&BYTE*8                                    08746042
.CNT     ANOP                                                           08766042
&CTIND   SETB  1                        SET COUNT INDICATOR             08786042
&COUNT   SETA  &COUNT+&SYSLIST(&OP,2)                                   08806042
&BYTE    SETA  &COUNT/8                                                 08826042
         AIF   (N'&SYSLIST(&OP) LT 3).START  TEST FOR OLD FORMAT        08846042
         AIF   (&ONLY1).TSTST           TEST FOR ONLY ONE CONCAT        08866042
         AIF   (&END1 EQ &END2).TSTST   TEST FOR SECOND END             08886042
&END1    SETA  &END1+1                  INCREMENT COUNT                 08906042
&OP      SETA  &OP-1                    DECREMENT INCREMENT             08926042
         AGO   .LOOP                    GENERATE NEXT                   08946042
.TSTST   ANOP                                                           08966042
         AIF   (&START1 EQ &START2).LPDONE   TEST FOR END               08986042
         AIF   (&ONLY1).NSET1           TEST FOR ONLY ONE CONCAT        09006042
&END1    SETA  &SYSLIST(&OP,5)          RE-INIT SECOND START COUNT      09026042
.NSET1   ANOP                                                           09046042
&OP      SETA  &OP-1                    DECREMENT INDEX                 09066042
&START1  SETA  &START1+1                INCREMENT FIRST COUNT           09086042
         AGO   .LOOP                    GO DO NEXT                      09106042
.LPDONE  ANOP                                                           09126042
&ONLY1   SETB  0                        CLEAR INDICATOR                 09146042
         AGO   .START                   GO TEST FOR MORE SUB-LISTS      09166042
.DONE    AIF   (&COUNT-&COUNT/8*8 NE 0).ERR  TEST FOR MULTIPLE OF EIGHT 09186042
         AIF   (&CTIND EQ 0).END        NO DS IF NO COUNT               09206042
&COUNT   SETA  &COUNT/8                 GET NUMBER OF BYTES             09226042
&NAME    DS    &COUNT.C                                                 09246042
.END     MEXIT                                                          09266042
.ERR     MNOTE '**BIT COUNT FLDS DO NOT TOTAL MULTIPLE OF 8**'          09286042
         MEXIT                                                          09306042
.EQU     AIF   ('&SYSLIST(&OP,4)' NE '').EQU1     TEST FOR NULL LABEL   09326042
.ERR4    MNOTE '**EQU OPERAND OMITTED OR NOT FOUND**'                   09346042
         MEXIT                                                          09366042
.EQU1    AIF   (&SYSLIST(&OP,2) LT 16).EQU2  COUNT OVER FIFTEEN         09386042
*****               THE FOLLOWING STATEMENT                *****        09406042
*****     NUMBER OF BITS EXCEED 15 - DO NOT USE AS BIN     *****        09426042
.EQU2    ANOP                                                           09446042
&EQUCNT  SETA  0                        CLEAR COUNTER                   09466042
&EQUSYM  SETC  '&SYSLIST(&OP,4)'        GET EQU OPERAND                 09486042
.EQULOP  ANOP                                                           09506042
&EQUCNT  SETA  &EQUCNT+1                INCREMENT INDEX                 09526042
         AIF   ('&ITEM(&EQUCNT)' EQ '&EQUSYM').EQUOUT  LABEL FOUND?     09546042
         AIF   (&EQUCNT EQ &ITEMNBR).ERR4    ALL TESTED?                09566042
         AGO   .EQULOP                  NO-GET NEXT                     09586042
.EQUOUT  ANOP                                                           09606042
&ITEM(&ITEMNBR) SETC '&SYMBOL'          GET LABEL NAME                  09626042
&BITS(&ITEMNBR) SETA &SYSLIST(&OP,2)    GET NUMBER OF BITS              09646042
&SHIFT(&ITEMNBR) SETA &SHIFT(&EQUCNT)   GET SHIFT COUNT                 09666042
&SYMBOL  EQU   &EQUSYM                  THIS SYMBOL EQUATED             09686042
         AGO   .START                   RETURN FOR NEXT                 09706042
         MEND                                                           09726042
         EJECT                                                          09746042
         MACRO                                                          10266042
         LINEND                                                         10324042
.*                            THIS MACRO IS USED ONLY BY THE LINE       10382042
.*                                 MACRO TO SET THE NUMBER OF ENTRIES   10440042
.*                                 ASSOCIATED WITH EACH LINE.           10498042
         GBLA  &NRENTS                                                  10556042
         GBLC &NRENTSX                                                  10614042
         ORG   &NRENTSX                                                 10672042
         DC    FL1'&NRENTS'                                             10730042
         ORG                                                            10788042
&NRENTS  SETA  0                                                        10846042
B&SYSNDX EQU   *                                                        10904042
&NRENTSX SETC  'B&SYSNDX'                                               10962042
         MEND                                                           11020042
         SPACE 2                                                        11078042
         EJECT                                                          11136042
*  LABEL MACRO     LABEL MACRO     LABEL MACRO     LABEL MACRO        * 11194042
         SPACE 2                                                        11252042
         MACRO                                                          11310042
&NAME    LABEL &LABEL1,&LABEL2,&LABEL3,&LABEL4,&LABEL5,&LABEL6,        C11368042
               &LABEL7,&LABEL8                                          11426042
.*                            THIS MACRO ALLOWS UP TO ACHT LABELS TO    11484042
.*                                 BE SPECIFIED FOR A GIVEN LINE. THE   11542042
.*                                 LABELS SHOULD BE ENCLOSED IN QUOTA-  11600042
.*                                 TION MARKS. THE COLUMN AND LINE END  11658042
.*                                 CONTROLS WILL BE INSERTED BY THE     11716042
.*                                 MACRO. OMITTED OPERANDS MEAN NO      11774042
.*                                 LABEL REQUIRED FOR RESPECTIVE        11832042
.*                                 COLUMN. THIS MACRO WILL ALSO ALERT   11890042
.*                                 THE PROGRAMMER TO EXACTLY WHERE THE  11948042
.*                                 TABLE MUST BE BROKEN IF NECESSARY    12006042
.*                                 TO AVOID EXCEEDING THE MAXIMUM LIMIT 12064042
         GBLC &LABELS(2000)                                             12122042
         GBLC  &LBL(100)                                                12180042
         GBLA  &LBLCTR(100)                                             12238042
         GBLA  &LABELNR                                                 12296042
         GBLA  &NRENTS,&LPTR                                            12354042
         LCLC  &MARGIN,&TACK                                            12412042
         LCLC  &TEXT                                                    12470042
         LCLA  &OP,&K,&START,&NRCHAR,&REMAIN                            12528042
&MARGIN  SETC  '*'                                                      12586042
         AIF   ('&NAME' EQ '').LOOPOUT                                  12644042
&LPTR    SETA  &LPTR+1                                                  12702042
&LBL(&LPTR) SETC '&NAME'                                                12760042
&LBLCTR(&LPTR) SETA &LABELNR+1                                          12818042
.LOOPOUT ANOP                                                           12876042
&OP      SETA  &OP+1                                                    12934042
&K       SETA  K'&SYSLIST(&OP)                                          12992042
         AIF (&K GE 2).NORM                                             13050042
&K       SETA  2                                                        13108042
.NORM    ANOP                                                           13166042
&START   SETA  2                                                        13224042
         AIF (&OP LT N'&SYSLIST).NOTLAST                                13282042
&MARGIN  SETC  '$'                                                      13340042
.NOTLAST ANOP                                                           13398042
&NRCHAR  SETA  8                                                        13456042
&TACK    SETC  ''                                                       13514042
.LOOPIN  ANOP                                                           13572042
&REMAIN  SETA  &K-&START                                                13630042
         AIF (&REMAIN GE 8).MORE                                        13688042
&TACK    SETC  '&MARGIN'                                                13746042
&NRCHAR  SETA  &REMAIN                                                  13804042
.MORE    ANOP                                                           13862042
&TEXT    SETC  ''                                                       13920042
         AIF (&REMAIN EQ 0).ENDTEXT                                     13978042
&TEXT    SETC  '&SYSLIST(&OP)'(&START,&NRCHAR)                          14036042
.ENDTEXT ANOP                                                           14094042
&LABELNR SETA  &LABELNR+1                                               14152042
&LABELS(&LABELNR) SETC '&TEXT'.'&TACK'                                  14210042
&START   SETA  &START+8                                                 14268042
         AIF ('&TACK' EQ '').LOOPIN                                     14326042
         AIF ('&TACK' EQ '*').LOOPOUT                                   14384042
         MEND                                                           14442042
         SPACE 2                                                        14500042
         MACRO                                                          14558042
         LSTART                                                         14616042
.*                            THIS MACRO IS ISSUED WHEN THE LABEL AREA  14674042
.*                                 OF THE TABLE IS TO BEGIN.            14732042
         GBLC &LABELS(2000)                                             14790042
         GBLA  &LABELNR                                                 14848042
         GBLC  &LBL(100)                                                14906042
         GBLA  &LBLCTR(100)                                             14964042
         LCLA  &NDX,&CTR                                                15022042
         LINEND                                                         15080042
&CTR     SETA  1                                                        15138042
.LOOP    ANOP                                                           15196042
&NDX     SETA  &NDX+1                                                   15254042
         AIF   (&LBLCTR(&CTR) NE &NDX).NOLBL                            15312042
&LBL(&CTR) DC  C'&LABELS(&NDX)'                                         15370042
&CTR     SETA  &CTR+1                                                   15428042
         AGO   .LOOPCTL                                                 15486042
.NOLBL   ANOP                                                           15544042
         DC    C'&LABELS(&NDX)'                                         15602042
.LOOPCTL AIF   (&NDX LT &LABELNR).LOOP                                  15660042
         MEND                                                           15718042
         SPACE 2                                                        15776042
*  BIN MACRO     BIN MACRO     BIN MACRO     BIN MACRO     BIN MACRO  * 15834042
         SPACE 2                                                        15892042
         MACRO                                                          15950042
         BIN   &LOGITEM,&SKIP$OR                                        16008042
.*                                 &LOGITEM - NAME OF ITEM IN LOG       16066042
.*                                      RECORD DSECT                    16124042
.*                                 &SKIP$OR - NBR OF SPACES TO SKIP ON  16182042
.*                                 MULTIPLE PRINT OR NBR OF SPACES      16240042
.*                                      TO BACK UP FROM COLUMN FOR      16298042
.*                                      START OF PRINTING. THE LETTER   16356042
.*                                      B PRECEEDS THE NUMBER (B5) IF   16414042
.*                                      THE LATTER IS DESIRED. OMISSION 16472042
.*                                      OF THIS OPERAND FORCES OPTION 2 16530042
.*                                      WITH BACKUP SPACING EQUAL TO    16588042
.*                                 THE NUMBER OF BITS IN THE ITEM       16646042
.*                                 DEFINITION (VIA MACRO 'DSGEN').      16704042
.*                            A LIMIT OF 15 BITS IS IMPOSED FOR THE     16762042
.*                                 TOTAL NUMBER OF BITS TO PRINT.       16820042
         GBLC &ITEM(1000)                                               16878042
         GBLA &ITEMNBR,&BITS(1000),&SHIFT(1000),&NRENTS                 16936042
         GBLC  &DSECT                                                   16994042
         LCLB  &B                                                       17052042
         LCLA  &IBITS,&NDX,&ISHIFT,&K                                   17110042
         LCLA  &TEMP,&T                                                 17168042
         LCLC  &S                                                       17226042
.LOOP    ANOP                                                           17284042
&NDX     SETA  &NDX+1                                                   17342042
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      17400042
         AIF   (&NDX LT &ITEMNBR).LOOP                                  17458042
         MNOTE *,'YOU BLEW IT'                                          17516042
         ROUTINE DUM,SKIPPER                                            17574042
         MEXIT                                                          17632042
.FOUND   ANOP                                                           17690042
&ISHIFT  SETA  &SHIFT(&NDX)                                             17748042
&IBITS   SETA  &BITS(&NDX)                                              17806042
&T       SETA  &IBITS-1                                                 17864042
&B       SETB  0                                                        17922042
         AIF   ('&SKIP$OR' EQ '').BACKUP                                17980042
&K       SETA  K'&SKIP$OR                                               18038042
&B       SETB  ('&SKIP$OR'(1,1) EQ 'B')                                 18096042
&S       SETC  '&SKIP$OR'(&B+1,&K-&B)                                   18154042
&T       SETA  &S                                                       18212042
.BACKUP  ANOP                                                           18270042
&NRENTS  SETA  &NRENTS+1                                                18328042
&TEMP    SETA  &ISHIFT                                                  18386042
A&SYSNDX DC    AL.12(&LOGITEM-&DSECT),XL.4'&TEMP'                       18444042
         AIF (&IBITS EQ 1 AND &B EQ 0).OUT                              18502042
         ORG   A&SYSNDX                                                 18560042
&B       SETB  1                                                        18618042
         DC    AL.12(&LOGITEM-&DSECT),XL.4'C'                           18676042
         DC    BL.1'&B',AL.7(&T),AL.4(&IBITS),FL.4'&ISHIFT'             18734042
.OUT     ANOP                                                           18792042
         MEND                                                           18850042
         EJECT                                                          18908042
*  HEX MACRO     HEX MACRO     HEX MACRO    HEXN MACRO     HEX MACRO  * 18966042
         SPACE 2                                                        19024042
         MACRO                                                          19082042
         HEX   &LOGITEM,&SKIP$OR,&BYTES                                 19140042
.*                            THIS MACRO FACILITATES GENERATION OF THE  19198042
.*                                 TABLE ENTRIES SPECIFYING HEX TYPE    19256042
.*                                 CONVERSIONS.                         19314042
.*                            &LOGITEM - NAME OF DATA ITEM TO BE        19372042
.*                                 CONVERTED                            19430042
.*                            &SKIP$OR - NUMBER OF SPACES TO SKIP ON    19488042
.*                                 MULTIPLE PRINT OR NBR OF SPACES TO   19546042
.*                                 BACK UP FROM COLUMN FOR START OF     19604042
.*                                 PRINTING. THE LETTER B PRECEEDS THE  19662042
.*                                 NUMBER (B8) IF THE LATTER OPTION IS  19720042
.*                                 DESIRED. OMISSION OF THIS OPERAND    19778042
.*                                 FORCES OPTION 2 WITH BACKUP SPACING  19836042
.*                                 EQUAL TO THE NUMBER OF BYTES SPECI-  19894042
.*                                 FIED BY THE NEXT OPERAND (TWICE THIS 19952042
.*                                 NUMBER IF SUFFIX IS EXPLICITLY OR    20010042
.*                                 IMPLICITLY B).                       20068042
.*                            &BYTES - NUMBER OF TOTAL INPUT BYTES TO   20126042
.*                                 PROCESS. THIS NUMBER IS SUFFIXED     20184042
.*                                 WITH AN L,R, OR B TO STIPULATE       20242042
.*                                 PRINTING OF THE LEFT HALF, RIGHT     20300042
.*                                 HALF, OR BOTH HALVES OF THE BYTE     20358042
.*                                 RESPECTIVELY. OMISSION OF THIS       20416042
.*                                 OPERAND DEFAULTS TO B WITH THE NUM-  20474042
.*                                 BER OF BYTES EQUAL TO THE ITEM LNGTH 20532042
.*                            A NEW ENTRY IS GENERATED ONLY WHEN NECES- 20590042
.*                                 SARY. THIS MACRO MUST BE THE FIRST   20648042
.*                                 MACRO INSTRUCTION ISSUED FOR THE     20706042
.*                                 SUBJECT LINE(S).                     20764042
         GBLC &ITEM(1000),&DSECT                                        20822042
         GBLA &ITEMNBR,&BITS(1000),&SHIFT(1000),&NRENTS                 20880042
         LCLB  &B                                                       20938042
         LCLA  &IBITS,&NDX,&ISHIFT,&K,&T,&CODE,&BYTESP                  20996042
         LCLC  &S,&LETTER                                               21054042
.LOOP    ANOP                                                           21112042
&NDX     SETA  &NDX+1                                                   21170042
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      21228042
         AIF   (&NDX LT &ITEMNBR).LOOP                                  21286042
         MNOTE *,'LOG ITEM NOT DEFINED'                                 21344042
         MEXIT                                                          21402042
.FOUND   ANOP                                                           21460042
&ISHIFT  SETA  &SHIFT(&NDX)                                             21518042
&IBITS   SETA  &BITS(&NDX)                                              21576042
&CODE    SETA  1                                                        21634042
&K       SETA  K'&BYTES                                                 21692042
         AIF   (&IBITS-(&IBITS/4)*4 EQ 0).OK                            21750042
         MNOTE *,'BIT LENGTH SPECIFICATION INCONSISTENT WITH CONTROL'   21808042
         MEXIT                                                          21866042
.OK      AIF   ('&BYTES' EQ '').USEDEFN                                 21924042
&LETTER  SETC  '&BYTES'(&K,1)                                           21982042
&S       SETC  '&BYTES'(1,&K-1)                                         22040042
&BYTESP  SETA  &S                                                       22098042
         AIF   ('&LETTER' EQ 'B').BOTH                                  22156042
         AIF   (&ISHIFT EQ 0 OR &ISHIFT EQ 4).OK2                       22214042
.ERR     MNOTE *,'DATA NOT ALLIGNED ON HEX OR BYTE BOUNDARY'            22272042
         MEXIT                                                          22330042
.USEDEFN ANOP                                                           22388042
&BYTESP  SETA  &IBITS/8                                                 22446042
.BOTH    AIF   (&ISHIFT NE 0).ERR                                       22504042
&CODE    SETA  3                                                        22562042
&T       SETA  &BYTESP*2-1                                              22620042
&S       SETC  '&T'                                                     22678042
.OK2     AIF   (&ISHIFT EQ 0).L                                         22736042
&CODE    SETA  2                                                        22794042
.L       ANOP                                                           22852042
&B       SETB  1                                                        22910042
         AIF   ('&SKIP$OR' EQ '').BACKUP                                22968042
&K       SETA  K'&SKIP$OR                                               23026042
&B       SETB  ('&SKIP$OR'(1,1) EQ 'B')                                 23084042
&S       SETC  '&SKIP$OR'(&B+1,&K-&B)                                   23142042
.BACKUP  ANOP                                                           23200042
&NRENTS  SETA  &NRENTS+1                                                23258042
         DC    AL.12(&LOGITEM-&DSECT),XL.4'A'                           23316042
         DC    BL.1'&B',FL.7'&S',FL.4'&BYTESP',FL.4'&CODE'              23374042
.OUT     ANOP                                                           23432042
         MEND                                                           23490042
         MACRO                                                          23548042
         SPECIAL  &ROUTINE,&PARAM,&SPACE=                               23606042
.*                            THIS MACRO GENERATES A SPECIAL ROUTINE    23664042
.*                                 ENTRY TO BE PROCESSED BY THE SUM. M. 23722042
.*                            &ROUTINE - SYMBOL ON SPECIAL ROUTINE EWT. 23780042
.*                            &PARAM - AN 8 BIT BINARY REPRESENTATION   23838042
.*                                 TO OCCUPY THE 'MASK' FIELD BUT TO BE 23896042
.*                                 INTERPRETED AS AN ARGUMENT OF THE    23954042
.*                                 SPECIAL ROUTINE.                     24012042
.*                            &SPACE - THE NUMBER OF 2BYTE COUNTERS TO  24070042
.*                                 ALLOCATE FOR REQUIRED PROCESSING.    24128042
         GBLC  &CSECT                                                   24186042
         GBLA  &COUNTR                                                  24244042
         LCLA  &ADD                                                     24302042
         DC    AL1(128)                                                 24360042
         DC    BL.8'&PARAM'                                             24418042
         DC    AL2(&ROUTINE-&CSECT)                                     24476042
         DC    AL2(&COUNTR)                                             24534042
&ADD     SETA  1                                                        24592042
         AIF   ('&SPACE' EQ '').NORM                                    24650042
&ADD     SETA  &SPACE                                                   24708042
.NORM    ANOP                                                           24766042
&COUNTR  SETA  &COUNTR+&ADD                                             24824042
         MEND                                                           24882042
         MACRO                                                          24940042
         SUM   &LOGITEM,&MASK                                           24998042
.*                            THIS MACRO GENERATES A NORMAL EDIT ENTRY  25056042
.*                                 FOR PROCESSING BY THE SUMMARY MODULE 25114042
.*                            &LOGITEM - NAME OF DATA ITEM TO BE SUMMED 25172042
.*                            &MASK - BYTE MASK FOR BITS TO BE TESTED.  25230042
.*                                 THIS OPERAND SHOULD BE OMITTED FOR   25288042
.*                                 SINGLE BIT ITEMS IN WHICH CASE THE   25346042
.*                                 MASK WILL BE SET ACCORDING TO THE    25404042
.*                                 OFF BYTE BIT DISPLACEMENT OF THE     25462042
.*                                ITEM AS DEFINED BY THE MACRO 'DSGEN'  25520042
         GBLA  &COUNTR,&ITEMNBR,&BITS(1000),&SHIFT(1000)                25578042
         GBLC  &ITEM(1000),&DSECT                                       25636042
         LCLA  &IBITS,&NDX,&ISHIFT,&M,&BITNBR                           25694042
.LOOP    ANOP                                                           25752042
&NDX     SETA  &NDX+1                                                   25810042
         AIF   ('&ITEM(&NDX)' EQ '&LOGITEM').FOUND                      25868042
         AIF   (&NDX LT &ITEMNBR).LOOP                                  25926042
         MNOTE *,'LOGITEM NOT FOUND'                                    25984042
         MEXIT                                                          26042042
.FOUND   ANOP                                                           26100042
         DC    AL1(0)                                                   26158042
&ISHIFT  SETA  &SHIFT(&NDX)                                             26216042
&IBITS   SETA  &BITS(&NDX)                                              26274042
         AIF   ('&MASK' EQ '').FORM                                     26332042
         DC    B'&MASK'                                                 26390042
         AGO   .ITEM                                                    26448042
.FORM    ANOP                                                           26506042
&BITNBR  SETA  &ISHIFT-7                                                26564042
&BITNBR  SETA  0-&BITNBR                                                26622042
&M       SETA  1                                                        26680042
.LOOP2   ANOP                                                           26738042
         AIF   (&BITNBR EQ 0).GOTIT                                     26796042
&M       SETA  &M*2                                                     26854042
&BITNBR  SETA  &BITNBR-1                                                26912042
         AGO   .LOOP2                                                   26970042
.GOTIT   ANOP                                                           27028042
         DC    AL1(&M)                                                  27086042
.ITEM    DC    AL2(&LOGITEM-&DSECT)                                     27144042
         DC    AL2(&COUNTR)                                             27202042
&COUNTR  SETA  &COUNTR+1                                                27260042
         MEND                                                           27318042
         GBLC  &DSECT,&CSECT                                            27376042
&CSECT   SETC  'IFCS3330'                                               27434042
&DSECT   SETC  'S3330'                                                  27492042
IFCS3330 CSECT                                                          27550042
S3330    DSECT                                                          27608042
         DSGEN (CLASRC,8),(SYSREL,8),(SWITCHES,16)                      27666042
         DSGEN (RECID,8),(SPARE1,16),(TYPE,8)                           27724042
         DSGEN (DAY,32)                                                 27782042
         DSGEN (HOUR,32)                                                27840042
         DSGEN (SPARE2,8),(CPUSERL,24)                                  27898042
         DSGEN (CPUID,16),(SPARE3,16)                                   27956042
         DSGEN (JCUAID,16),(JVOLID1,16)                                 28014042
         DSGEN (JVOLID2,32)                                             28072042
         DSGEN (TSNB00,2),(TSNB02,1),(TSNB03,2),(TSNB05,1),(TSNB06,2), C28130042
               (TSNB10,1),(TSNB11,1),(TSNB12,6),(TSNB20,8),(TSNB30,8)   28188042
         DSGEN (TSNB40,8),(TSNB50,8),(TSNB60,8),(TSNB70,8)              28246042
         DSGEN (TSNB80,8),(TSNB90,8),(TSNB100,8),(TSNB110,8)            28304042
         DSGEN (TSNB120,8),(TSNB130,8),(TSNB140,8),(TSNB150,8)          28362042
         DSGEN (TSNB160,8),(TSNB170,8),(TSNB180,8),(TSNB190,8)          28420042
         DSGEN (TSNB200,8),(TSNB210,8),(TSNB220,8),(TSNB230,8)          28478042
         DSGEN (SPARE4,8),(CUA,24)                                      28536042
         DSGEN (IORET,24),(SBCNT,8)                              S21021 28594042
         DSGEN (VOLID1,32)                                              28652042
         DSGEN (VOLID2,16),(SPARE5,16)                                  28710042
         DSGEN (LSKAD1,64)                                              28768042
         DSGEN (AHA1,32)                                                28826042
         DSGEN (AHA2,16),(SPARE6,16)                                    28884042
         DSGEN (SNB00,2),(SNB02,1),(SNB03,2),(SNB05,1),(SNB06,2),      C28942042
               (SNB10,1),(SNB11,1),(SNB12,6),(SNB20,8),(SNB30,8)        29000042
         DSGEN (SNB40,8),(SNB50,8),(SNB60,8),(SNB70,8)           S21926 29058042
         DSGEN (SNB80,8),(SNB90,8),(SNB100,8),(SNB110,8)         S21926 29116042
         DSGEN (SNB120,8),(SNB130,8),(SNB140,8),(SNB150,8)       S21926 29174042
         DSGEN (SNB160,8),(SNB170,8),(SNB180,8),(SNB190,8)       S21926 29232042
         DSGEN (SNB200,8),(SNB210,8),(SNB220,8),(SNB230,8)       S21926 29290042
*                                                                       29348042
IFCS3330 CSECT                                                          29406042
         USING S3330,R2                                                 29464042
         USING *,R9                                                     29522042
         DC    A(ENTRIES)                                               29580042
         DC    A(PEDIT)                                                 29638042
*                                                                       29696042
REG8    DC    F'0'                                                      29754042
SCSIZE   DC    H'2877'                                         @Z427VLS 29812042
*                                                                       29870042
R0       EQU   0                                                        29928042
R1       EQU   1                                                        29986042
R2       EQU   2                                                        30044042
R3       EQU   3                                                        30102042
R4       EQU   4                                                        30160042
R5       EQU   5                                                        30218042
R6       EQU   6                                                        30276042
R7       EQU   7                                                        30334042
R8       EQU   8                                                        30392042
R9       EQU   9                                                        30450042
R10      EQU   10                                                       30508042
R11      EQU   11                                                       30566042
R12      EQU   12                                                       30624042
R13      EQU   13                                                       30682042
R14      EQU   14                                                       30740042
R15      EQU   15                                                       30798042
*                                                                       30856042
L0       EQU   0                                                        30914042
L1       EQU   1                                                        30972042
L2       EQU   2                                                        31030042
L3       EQU   3                                                        31088042
L4       EQU   4                                                        31146042
L5       EQU   5                                                        31204042
L6       EQU   6                                                        31262042
L7       EQU   7                                                        31320042
L8       EQU   8                                                        31378042
L9       EQU   9                                                        31436042
L10      EQU   10                                                       31494042
L11      EQU   11                                                       31552042
L12      EQU   12                                                       31610042
L13      EQU   13                                                       31668042
L14      EQU   14                                                       31726042
L15      EQU   15                                                       31784042
L16      EQU   16                                                       31842042
L17      EQU   17                                                       31900042
L18      EQU   18                                                       31958042
L19      EQU   19                                                       32016042
L20      EQU   20                                                       32074042
L22      EQU   22                                                       32132042
L23      EQU   23                                                       32190042
L24      EQU   24                                                       32248042
L26      EQU   26                                                       32306042
L27      EQU   27                                              @Z40NIVS 32326042
L28      EQU   28                                                       32364042
L29      EQU   29                                                Y01124 32384042
L30      EQU   30                                              @Z40NIVS 32394042
L31      EQU   31                                                       32422042
L32      EQU   32                                                       32480042
L36      EQU   36                                                       32538042
L39      EQU   39                                                       32596042
L42      EQU   42                                              @Z427VLS 32616042
L44      EQU   44                                                       32654042
L46      EQU   46                                                S21021 32712042
L47      EQU   47                                              @Z40NIVS 32715042
L48      EQU   48                                              @Z40NIVS 32718042
L49      EQU   49                                              @Z40NIVS 32721042
L50      EQU   50                                              @Z40NIVS 32724042
L64      EQU   64                                              @Z40RIVS 32725042
L480     EQU   480                                             @Z40NIVS 32727042
L510     EQU   510                                             @Z40NIVS 32730042
L1460    EQU   1460                                            @Z40NIVS 32733042
         SPACE 2                                               @Z40NIVS 32736042
BLANK    EQU   C' '                                            @Z40NIVS 32739042
SLASH    EQU   C'/'                                            @Z40NIVS 32742042
COLON    EQU   C':'                                            @Z40NIVS 32745042
SORTFLG  EQU   X'80'                                           @Z40NIVS 32748042
BASEDISP EQU   X'FD'                                           @Z40NIVS 32751042
DOGFOX   EQU   X'DF'                                           @Z40RIVS 32752042
ONE      EQU   1                                               @Z40NIVS 32754042
TWO      EQU   2                                               @Z40NIVS 32757042
THREE    EQU   3                                               @Z40NIVS 32760042
FOUR     EQU   4                                               @Z40NIVS 32763042
FIVE     EQU   5                                               @Z40NIVS 32766042
H0F      EQU   X'0F'                                                    32770042
HE0      EQU   X'E0'                                                    32828042
HF0      EQU   X'F0'                                                    32886042
H00      EQU   X'00'                                                    33002042
H01      EQU   X'01'                                                    33060042
H02      EQU   X'02'                                                    33118042
H04      EQU   X'04'                                                    33176042
H08      EQU   X'08'                                                    33234042
HC0      EQU   X'C0'                                                    33292042
H80      EQU   X'80'                                                    33350042
H50      EQU   X'50'                                                    33408042
H40      EQU   X'40'                                                    33466042
H30      EQU   X'30'                                                    33524042
H20      EQU   X'20'                                                    33582042
H10      EQU   X'10'                                                    33640042
H21      EQU   X'21'                                                    33698042
H23      EQU   X'23'                                                    33756042
H25      EQU   X'25'                                                    33814042
H29      EQU   X'29'                                                    33872042
H18      EQU   X'18'                                             S21926 33930042
H32      EQU   X'32'                                                    33988042
H90      EQU   X'90'                                                    34046042
CHART    EQU   C'T'                                                     34104042
CLRSGN   EQU   X'F0'                                                    34162042
LOGMODE  EQU   X'10'                                                    34220042
NOLOG    EQU   X'7F'                                                    34278042
NOCARRY  EQU   12                      COND CODE AFTER 'AL' =           34288042
*                                       NO CARRY(OVERFLOW) INTO         34298042
*                                       BIT POSITION 32                 34308042
XDATE1   STM   R5,R8,XSAVE1            SAVE REGS                        34336042
         CLC   DAY(L4),HEX00           IS DATE ZERO                     34452042
         BE    RETURN1                 BR-ZERO                          34510042
         CLC   L0(L4,R3),HEX00          IS LOW DATE ZERO                34568042
         BNE   XDATE2                   BR-NO                           34626042
         MVC   L0(L4,R3),DAY           MOVE IN DATE                     34684042
XDATE2   CLC   DAY(L4),L0(R3)          CHECK FOR LOW DATE               34742042
         BL    SAVELOW                  LOWER SAVE IT                   34800042
         CLC   DAY(L4),L4(R3)          CHECK FOR HI                     34858042
         BNH   RETURN1                                                  34916042
SAVEHI   MVC   L4(L4,R3),DAY           MOVE HI DATE                     34974042
         B     RETURN1                                                  35032042
SAVELOW  MVC   L0(L4,R3),DAY           MOVE LOW DATE                    35090042
         B     RETURN1                                                  35148042
ISTPER   STM   R5,R8,XSAVE1            SAVE REGISTERS                   35206042
         SR    R8,R8               ZERO REGS                            35264042
         USING T3330A,R3                                       @Z40NIVS 35326042
         LA    R6,T3330B           LOAD ADDR SUM CNTR          @Z40NIVS 35330042
         ST    R6,VOLPTR           STORE VOL CNTR ADDR         @Z40NIVS 35334042
         LA    R6,T3330C           LOAD ADDR OF SUM CNTR       @Z40NIVS 35338042
         ST    R6,FLTPTR           STORE FLT SUM CNTR ADDR     @Z40NIVS 35342042
         DROP  R3                                              @Z40NIVS 35346042
         LR    R5,R3               GET ADDR OF SUM CNTR        @Z40NIVS 35350042
         LA    R5,L32(R5)          INCR TO START OF CNTR       @Z40RIVS 35354042
         A     R5,RECTST4          PNT TO REC FOR DEV          @Z40NIVS 35358042
         TM    CLASRC,H90          IS THIS MDR REC             @Z40RIVS 35362042
         BO    ISTPER3             YES GO TEST SENSE           @Z40RIVS 35363042
         TM    CLASRC,H32          IS THIS A CONV OBR          @Z40RIVS 35364042
         BO    ISTPER4             YES GO TEST SENSE           @Z40RIVS 35365042
         TM    SNB20,H08           IS OBR EMULATION            @Z40RIVS 35366042
         BO    ISTPER5             YES GO TEST LOGICAL         @Z40RIVS 35367042
ISTPER2  ST    R3,RECTSTS          SAVE SUM PNTR               @Z40RIVS 35368042
         ST    R5,RECTSTP          SAVE REC PNTR               @Z40RIVS 35369042
         TM    EMCUA1,H80          ARE REC EMULATED            @Z40RIVS 35370042
         BNO   PASSSW1             NO CONTINUE                 @Z40RIVS 35371042
         LR    R7,R3               PICK UP DSECT PNTR          @Z40RIVS 35372042
         LA    R6,T3330A-T3330     GET DISPLACEMENT            @Z40RIVS 35373042
         SR    R7,R6               BACK UP TO DSECT START      @Z40RIVS 35374042
         OI    L0(R7),H80          PASS EMULATOR SW TO EDIT    @Z40RIVS 35375042
PASSSW1  MVC   L0(L32,R3),L0(R5)   MOVE REC TO SUM AREA        @Z40RIVS 35376042
         LR    R5,R3               GET ADDRESS OF SUM COUNTER  @Z40NIVS 35380042
         MVC   L2(L1,R5),CLASRC        SAVE RECORD CLASS/SOURCE XL03145 35400042
         TM    CLASRC,H90              TEST FOR A TPER RECORD    S21021 35438042
         BO    TYPTPER                 YES                       S21021 35496042
         TM    EMCUA1,H80          IS THIS EMULATION           @Z40RIVS 35506042
         BNO   ISTPER2A            NO GO HANDLE REC NORMAL     @Z40RIVS 35516042
         MVC   L30(L2,R3),TSNB180  MOVE IN LOGICAL CUA         @Z40RIVS 35526042
         NI    EMCUA1,H00          TURN OFF EMULATOR SW        @Z40RIVS 35536042
*                                      NO - SAVE DEVICE TYPE    XL03145 35554042
*                                       CODE,BUT DONT ADD TO    XL03145 35564042
*                                       COUNTERS                XL03145 35574042
ISTPER2A MVC   L28(L2,R3),CUA+L1   SAVE DEVICE ADDR            @Z40RIVS 35579042
         MVC   L3(L2,R5),TSNB220       SAVE DEVICE CODE         XL03145 35584042
         B     RETURN1                 RETURN                   XL03145 35594042
ISTPER3  TM    TSNB20,H08          MDR IN EMULATION            @Z40RIVS 35594642
         BNO   ISTPER2             NO GO TO HANDEL NORMAL      @Z40RIVS 35595242
         OI    EMCUA1,H80          TURN ON EMULATOR SW         @Z40RIVS 35595842
         TM    JCUAID+L1,H20       YES-IS THIS 2ND LOGICAL     @Z40RIVS 35596442
         BNO   ISTPER2             NO-GO TO SAVE SUM PNTRS     @Z40RIVS 35597042
         B     ISTPER1             YES-INCR SUM PNTR           @Z40RIVS 35597642
ISTPER4  TM    SNB120,H08          CONV OBR REC IN EMUL        @Z40RIVS 35598242
         BNO   ISTPER2             NO-GO SAVE PNTRS            @Z40RIVS 35598842
ISTPER5  OI    EMCUA1,H80          TURN ON EMULATOR SW         @Z40RIVS 35599442
         TM    CUA+L2,H20          YES-IS THIS 2ND LOGICAL     @Z40RIVS 35600042
         BNO   ISTPER2             NO-USE PHYSICAL AREA        @Z40RIVS 35600642
ISTPER1  LA    R5,L32(R5)          INCREMENT FOR 2ND REC       @Z40RIVS 35601242
         B     ISTPER2             GO TO USE PHYSICAL AREA     @Z40RIVS 35601842
TYPTPER  MVC   EMCUA(L2),JCUAID    MOVE CUA TO WORK AREA       @Z40RIVS 35603042
         TM    TSNB20,H08          TEST FOR EMULATION          @Z40RIVS 35611042
         BNO   TYPTPER1            NO HANDLE REC               @Z40RIVS 35619042
         MVC   L30(L2,R3),JCUAID   MOVE LOGICAL UNIT TO REC    @Z40RIVS 35635042
         NI    EMCUA1,H00          TURN OFF EMULATOR SW        @Z40RIVS 35643042
TYPTPER1 MVC   L28(L2,R3),EMCUA    SAVE DEVICE ADDR            @Z40RIVS 35651042
         BAL   R8,ADDUP            GO ADD TO COUNT OF TPER RECORDS      35659042
         LA    R8,DOVOL-L6             MOVE POINTER TO ADD VOL ID       35670042
         ST    R8,REG8                                                  35728042
         MVC   L1(L1,R5),RECID         SAVE RECORD ID           XL03145 35748042
         B     RETURN1                                                  35786042
ISLOG    STM   R5,R8,XSAVE1            SAVE REGISTERS                   35844042
         SR    R6,R6                   ZERO                             35902042
         TM    CLASRC,H32              IS THIS A CONVERTED OBR   S21021 36018042
         BNO   NEWREC              NO                                   36076042
TESTCONV TM    SBCNT,H18               HAS THIS RECORD BEEN CONDENSED   36192042
         BO    NEWREC                  YES                       S21021 36250042
         MVC   SNB00(L24),SNB100       NO,MOVE SENSE OVER SDR    S21021 36308042
NEWREC   LR    R5,R3                   GET ADDRESS OF SUMMARY COUNTERS  36366042
         TM    SNB20,H10               WAS THIS RECORDED IN LOGGING MOD 36482042
         BNO   RETURN1             NO, EXIT                             36540042
LOGMOD   TM    SNB70,H50               IS THIS DATA CHECK CORRECTABLE   36656042
         BO    LOGMOD1                 YES,FORMAT 5 INDICATES DCC       36714042
         LA    R5,L2(R5)               NO,BUMP POINTER RO DATA CHK RTRY 36772042
         TM    SNB70,H40               IS THIS DATA CHECK RETRY         36830042
         BO    LOGMOD1                 YES,FORMAT 4 INDICATES DCR       36888042
         LA    R5,L2(R5)               NO,BUMP POINTER TO SEEK CHECK    36946042
         TM    SNB70,H10               IS THIS SEEK CHECK               37004042
         BNO   LOGRET              NO                                   37062042
*                                  YES, FORMAT 1 INDICATES SK CHK       37072042
LOGMOD1  BAL   R8,ADDUP            GO ADD TO SUMMARY CTR                37082042
LOGRET   LA    R8,ENDLOG-L6            LOG MOD ENDS,DO NOT ADD FURTHER  37120042
         ST    R8,REG8                                                  37178042
         B     RETURN1                                                  37236042
*                                                                       37410042
         EJECT                                                 @Z40NIVS 37468042
*                                                              @Z40NIVS 37471042
*        ROUTINE TO SUM INTO THE SPECIFIC SUM AREA FOR DEVICE  @Z40NIVS 37474042
*                                                              @Z40NIVS 37477042
RECTST0  STM   R5,R8,XSAVE1        SAVE REG                    @Z40NIVS 37480042
         IC    R7,JCUAID+ONE       PICK UP MDR CUA             @Z40NIVS 37481042
         TM    CLASRC,H90          TEST TYPE RECORD            @Z40NIVS 37483042
         BO    RECTST1             BRANCH IF MDR               @Z40NIVS 37486042
         IC    R7,CUA+TWO          PICK UP OBR CUA             @Z40NIVS 37489042
RECTST1  SLL   R7,L28              CLR HIGH BYTES              @Z40NIVS 37492042
         SRL   R7,L28              IN REG7                     @Z40NIVS 37495042
         LTR   R7,R7               TEST REG7 FOR ZERO          @Z40NIVS 37498042
         BZ    RECTST2             BRANCH FOR ZERO INCRMT      @Z40NIVS 37501042
         LA    R5,L64              LOAD REG5 WITH INCRMT       @Z40RIVS 37504042
         MR    R6,R5               SET REG7 TO SUM AREA        @Z40NIVS 37507042
RECTST2  ST    R7,RECTST4          SAVE INCRMT                 @Z40NIVS 37510042
         B     RETURN1             RETURN                      @Z40NIVS 37513042
*                                                              @Z40NIVS 37522042
*                                                              @Z40NIVS 37525042
*    SPECIAL TO RESTORE SUMREC BACK TO ITS PROPER POSITION     @Z40NIVS 37528042
*                                                              @Z40NIVS 37531042
RESTOR   STM   R5,R8,XSAVE1        SAVE WORK REGS              @Z40NIVS 37534042
         L     R5,RECTSTS          PICK UP PNTR TO SUM AREA    @Z40NIVS 37537042
         L     R6,RECTSTP          PICK UP PNTR TO DEV AREA    @Z40NIVS 37540042
         MVC   L0(L32,R6),L0(R5)   RESTORE SUM CNTR            @Z40RIVS 37543042
         B     RETURN1             RETURN                      @Z40NIVS 37546042
*                                                              @Z40NIVS 37549042
EQUIP    STM   R5,R8,XSAVE1        SAVE REGISTERS              @Z40NIVS 37552042
         SR    R6,R6               ZERO                        @Z40NIVS 37555042
         LR    R5,R3                   GET ADDRESS OF SUMMARY COUNTERS  37642042
         TM    SNB00,H10               IS THIS EQUIPMET CHECK           37700042
         BNO   RETURN1             NO RETURN, DO NOT ADD TO CTRS        37758042
EQUIPON  TM    SNB70,H30               IS THIS FORMAT 3                 37874042
         BO    EQUIPON1                YES                              37932042
         TM    SNB70,H20                       FORMAT 2                 37990042
         BO    EQUIPON1                YES                              38048042
         TM    SNB70,HF0                       FORMAT 0                 38106042
         BZ    EQUIPON1                YES                              38164042
         TM    SNB70,H50               IS THIS FORMAT 5                 38222042
         BO    RETURN1                 YES,DO NOT ADD TO COUNTERS       38280042
         TM    SNB70,H10                       FORMAT 1                 38338042
         BNO   RETURN1             NO RETURN, DO NOT ADD TO CTRS        38396042
EQUIPON3 LA    R5,L4(R5)               POINT TO PROPER COUNTER          38918042
         TM    SNB10,H80               IS THIS PERMANENT ERROR          38976042
         BO    EQUPON4A            YES                         @XA11914 39034042
         TM    SWITCHES+1,X'40'    TEST HEADER                 @XA11914 39044042
         BO    EQUIPON4            TEMP, GO ADD                @XA11914 39054042
EQUPON4A LA    R5,L2(R5)           BUMP POINTER TO COUNTER     @XA11914 39064042
EQUIPON4 BAL   R8,ADDUP            GO ADD TO TOTAL EQ DRIVE             39094042
         B     RETURN1                                                  39150042
EQUIPON1 TM    SNB10,H80           IS THIS A PERM ERROR                 39208042
         BO    EQUPON2A            YES                         @XA11914 39238042
         TM    SWITCHES+1,X'40'    TEST HEADER FOR PERM        @XA11914 39248042
         BO    EQUIPON2                                        @XA11914 39258042
EQUPON2A LA    R5,L2(R5)           BUMP POINTER TO COUNTER     @XA11914 39268042
EQUIPON2 BAL   R8,ADDUP            GO ADD TO TOTAL EQ CONT              39298042
         B     RETURN1             RETURN                               39328042
DATACKP  STM   R5,R8,XSAVE1            SAVE REGISTERS                   39382042
         SR    R6,R6                   ZERO                             39440042
         LR    R5,R3                   GET ADDRESS OF SUMMARY COUNTER   39556042
         TM    SNB00,H08               TEST FOR DATA CHECK OBR          39614042
         BNO   RETURN1             EXIT                                 39672042
DATACKP1 TM    SNB10,H80               IS THIS DATA CHECK PERMANENT     39788042
         BO    DATACKP2            YES, GO ADD                 @XA11914 39846042
         TM    SWITCHES+1,X'40'    TEST HEADER FOR PERM        @XA11914 39876042
         BO    RETURN1                                         @XA11914 39906042
DATACKP2 BAL   R8,ADDUP                GO OUT TO ADD                    39962042
         B     RETURN1                                                  40020042
TVOLIDM  TM    TSNB20,H08          TEST FOR EMULATION          @Z40NIVS 40030042
         BNO   TVOLID3A            NO BYPASS LOG CUA MOVE      @Z40NIVS 40040042
         MVC   L28(L2,R5),JCUAID   MOVE LOGICAL CUA TO REC     @Z40NIVS 40050042
         B     TVOLID3A            GO TO CONTINUE PROCESSING   @Z40NIVS 40060042
TVOLID   STM   R5,R8,XSAVE1            SAVE THE REGS                    40078042
         SR    R6,R6                                                    40136042
         L     R3,VOLPTR           PICK UP ADDR OF VOL CNT     @Z40NIVS 40272042
         LR    R5,R3                   GET POINTER TO COUNTERS          40310042
         TM    CLASRC,H90              IS THIS AN  MDR  RECORD          40368042
         BNO   RETURN1             NO RETURN FOR ANOTHER                40418042
TVOLID1A CLC   ZEROS(L6),JVOLID1       IS THIS VOL ID ZEROS      A44063 40542042
         BE    RETURN1                 YES GO GET ANOTHER        A44063 40600042
         LA    R7,L50              SET NO OF VLO ID'S ALLOWED  @Z40NIVS 40658042
TVOLID2A CLC   L0(L6,R5),JVOLID1       COMPARE VOL ID TO FIRST          40716042
         BNE   TVOLID4Z            UNEQUAL                     @Z40NIVS 40774042
         CLC   L26(L2,R5),EMCUA    CHECK DEVADDR               @Z40RIVS 40781042
         BNE   TVOLID4Z            BYPASS EMUL                 @Z40RIVS 40788042
         TM    TSNB20,H08          TEST FOR EMUL               @Z40RIVS 40795042
         BNO   TVOLID4A            NO GO HANDLE MDR            @Z40RIVS 40802042
         CLC   L28(L2,R5),JCUAID   YES, TEST LOGICAL CUA       @Z40RIVS 40809042
         BE    TVOLID4A            YES, GOTO SUMMARY           @Z40RIVS 40816042
TVOLID4Z CLC   L0(L6,R5),ZEROS     NO,IS VOL ID EQUAL TO BLANKS@Z40NIVS 40824042
         BE    TVOLIDM             GO TEST FOR EMULATION       @Z40RIVS 40890042
         LA    R5,L30(R5)          BUMP PTR TO NEXT VOLID      @Z40RIVS 40940042
         BCT   R7,TVOLID2A             LOOP TO FIRST TEST               41006042
TVOLID3A MVC   L0(L6,R5),JVOLID1       MOVE IN VOL ID                   41064042
         MVC   L26(L2,R5),EMCUA    MOVE IN DEVICE ADDR         @Z40RIVS 41084042
TVOLID4A LA    R5,L6(R5)               BUMP POINTER TO COUNTERS         41122042
         ICM   R6,L15,L0(R5)                                            41180042
         AH    R6,TSNB160          ADD IN COUNT OF SEEKS                41280042
         STCM  R6,L15,L0(R5)       STORE TOTAL                          41380042
         LA    R5,L4(R5)               BUMP CNTR PTR                    41572042
         SR    R6,R6                   CLEAR REG                        41612042
         SPACE                                                          41652042
         IC    R6,TSNB190              GET COUNT OF SEEK ERRORS         41760042
         BAL   R8,ADDUP3           GO ADD TO COUNTER           @Z40NIVS 41818042
         SPACE                                                          42012042
         ICM   R6,L15,TSNB80       LOAD NUMBER OF BYTES READ.           42050042
         ICM   R7,L15,L2(R5)       PUT COUNTER ON BOUNDARY              42120042
         ALR   R6,R7               ADD BYTES READ                       42190042
*                                                              @XA21166 42260001
         BC    NOCARRY,SAVBTRD         BR IF NO OVERFLOW                42362042
*                                      IF THERE WAS A CARRY             42402042
         LH    R7,L0(R5)               LOAD OVERFLOW CNTR               42442042
         LA    R7,L1(R7)               BUMP BY ONE                      42482042
         STH   R7,L0(R5)               SAVE CNTR                        42522042
*                                                                       42562042
SAVBTRD  STCM  R6,L15,L2(R5)       SAVE BYTES READ                      42602042
         LA    R5,L6(R5)               BUMP CNTR PTR                    42682042
         SPACE                                                          42722042
         ICM   R6,L15,L0(R5)       LOAD CURRENT TOTAL                   42762042
         AH    R6,TSNB140          UNCORR DATA CKS                      42842042
         STCM  R6,L15,L0(R5)       STORE TOTAL                          42922042
         LA    R5,L4(R5)               BUMP CNTR PTR                    43002042
         SPACE                                                          43042042
         ICM   R6,L15,L0(R5)       CURRENT TOTAL                        43082042
         AH    R6,TSNB120          CORR DATA CKS                        43162042
         STCM  R6,L15,L0(R5)       STORE TOTAL                          43242042
         SPACE                                                          43322042
*        THE FOLLOWING ROUTINE DETERMINES IF THE COUNTS ARE MADE        43558042
*        FOR CHANNEL 'A' AND 'B' OR CHANNEL 'C' AND 'D'.                43568042
         CLI   TSNB180,H80             IS THIS REC FOR CHNL C/D  Y01124 43578042
         BE    CHANCD                  YES  BRANCH               Y01124 43588042
         LA    R5,ABCNTR(R3)           NO SET PTR TO A/B CNTRS          43598042
         B     TVOLID5A                BRANCH TO TOTAL COUNTERS  Y01124 43608042
CHANCD   LA    R5,CDCNTR(R3)           SET POINTER TO C/D CNTRS         43618042
*                                                                       43628042
TVOLID5A SR    R6,R6                                             Y01124 43638042
         IC    R6,TSNB200              GET COUNT OVERRUN A/C CMNDY01124 43648042
         BAL   R8,ADDUP3                                                43732042
         IC    R6,TSNB210              GET COUNT OVERRUN A/C DATAY01124 44022042
         BAL   R8,ADDUP3                                                44080042
         IC    R6,TSNB220              GET COUNT OVERRUN B/D CMNDY01124 44370042
         BAL   R8,ADDUP3                                                44428042
         IC    R6,TSNB230              GET COUNT OVERRUN B/D DATAY01124 44718042
         BAL   R8,ADDUP3                                                44776042
         B     RETURN1                                                  44950042
ADDUP3   AH    R6,L0(R5)           ADD TO COUNTER                       44960042
         STCM  R6,L3,L0(R5)        STORE TOTAL                          44970042
         LA    R5,L2(R5)           INCREMENT POINTER                    44980042
         SR    R6,R6               CLEAR R6                    @Z40RIVS 44985042
         BR    R8                                                       44990042
ADDUP    LH    R6,L0(R5)               PUT THE SUMMARY COUNTER IN REG 6 45008042
         LA    R6,L1(R6)               ADD ONE TO THE SUMMARY COUNTER   45066042
         STH   R6,L0(R5)               REPLACE COUNTER                  45124042
         LA    R5,L2(R5)               BUMP POINTER TO NEXT COUNTER     45182042
         BR    R8                      RETURN                           45240042
*                                                              @Z40NIVS 45298042
*        SPECIAL TO SUM INTO THE FAULT SYMPTOM COUNTERS        @Z40NIVS 45301042
*                                                              @Z40NIVS 45304042
TFAULT0  STM   R5,R8,XSAVE1        SAVE WORK REG               @Z40NIVS 45307042
         TM    CLASRC,H30          TYPE REC AN OBR             @Z40NIVS 45310042
         BNO   RETURN1             NO,EXIT                              45313042
         TM    SNB70,H50           FORMAT 5?                            45315042
         BO    RETURN1             YES,DON'T SAVE                       45317042
TFAULT1  L     R3,FLTPTR           PNT TO FLT SUM AREA         @Z40NIVS 45319042
         LA    R6,L1               SET OCCUR INCREMENT         @Z40NIVS 45322042
         LA    R7,L50              SET TO NUM OF SUMRECORD     @Z40NIVS 45325042
TFAULT2  CLC   L0(L2,R3),SNB220    IS FLT CODE EQ SUM REC      @Z40NIVS 45328042
         BE    TFAULT3             YES GO TEST CUA             @Z40NIVS 45331042
         CLC   L0(L2,R3),ZEROS     IS SUM REC ZERO             @Z40NIVS 45334042
         BE    TFAULT9             YES GO TEST REC CUA         @Z40NIVS 45337042
         B     TFAULT8             GO TO GET NEXT SUM REC      @Z40NIVS 45340042
TFAULT3  CLC   L2(L2,R3),CUA+ONE   IS CUA EQ TO SUM REC        @Z40NIVS 45343042
         BE    TFAULTA             TEST EMUL FOR COMP          @Z40RIVS 45346042
TFAULT9  CLC   L2(L2,R3),ZEROS     IS REC CUA EQU TO ZEROS     @Z40NIVS 45349042
         BE    TFAULTB             TEST EMUL FOR MOVE          @Z40RIVS 45352042
TFAULT8  LA    R3,L42(R3)          STEP TO NEXT COUNTER        @Z427VLS 45355042
         BCT   R7,TFAULT2          GO TRY AGAIN                @Z40NIVS 45358042
         B     RETURN1             ALL ENTRIES FULL            @Z40NIVS 45361042
TFAULTB  TM    SNB20,H08           IS THIS EMULATION           @Z40RIVS 45361742
         BNO   TFAULT4             NO DONT USE LAGICAL         @Z40RIVS 45362442
         MVC   L16(L2,R3),TSNB180  MOVE IN LOGICAL CUA         @Z40RIVS 45363142
TFAULT4  MVC   L0(L2,R3),SNB220    MOVE FLT CODE TO REC        @Z40NIVS 45364042
         MVC   L2(L2,R3),CUA+ONE   MOVE CUA TO SUM REC         @Z40NIVS 45367042
         MVC   L18(L24,R3),SNB00   MOVE 24 SENSE BYTES         @Z427VLS 45368042
TFAULT5  MVC   TFAULT7(L4),L4(R3)  INCREMENT                   @Z40NIVS 45370042
         A     R6,TFAULT7          NUM OF                      @Z40NIVS 45373042
         ST    R6,TFAULT7          OCCUR                       @Z40NIVS 45376042
         MVC   L4(L4,R3),TFAULT7   BY ONE                      @Z40NIVS 45379042
         CLC   L8(L4,R3),DAY       IS SUM DAY LATER RECDAY     @Z40NIVS 45382042
         BH    RETURN1             SUM DAY HIGH RETURN         @Z40NIVS 45385042
         CLC   L8(L4,R3),DAY       IS SUMDAY EQ RECDAY         @Z40NIVS 45388042
         BE    TFAULT6             GO TEST TIME DAY EQ         @Z40NIVS 45391042
         MVC   L8(L8,R3),DAY       MOVE IN NEW DAY/TIME        @Z40NIVS 45394042
         MVC   L18(L24,R3),SNB00   MOVE 24 SENSE BYTES         @Z427VLS 45395042
RETURN1  LM    R5,R8,XSAVE1        RESTORE REGS                         45397042
         BR    R14                 EXIT                                 45398042
TFAULT6  CLC   L12(L4,R3),HOUR     TEST SUM DAY/REC DAY        @Z40NIVS 45400042
         BNL   RETURN1             SUM REC HIGH OR EQ          @Z40NIVS 45403042
         MVC   L12(L4,R3),HOUR     MOVE IN NEW TIME TO SUM     @Z40NIVS 45406042
         MVC   L18(L24,R3),SNB00   MOVE 24 SENSE BYTES         @Z427VLS 45406542
         B     RETURN1         EXIT                            @Z40NIVS 45407042
TFAULTA  TM    SNB20,H08           IS THIS EMULATION           @Z40RIVS 45409042
         BNO   TFAULT5             NO DONT USE LOGICAL         @Z40RIVS 45412042
         CLC   L16(L2,R3),TSNB180  SUMREC EQ TO REC            @Z40RIVS 45415042
         BE    TFAULT5             YES GO SUM                  @Z40RIVS 45418042
         B     TFAULT8             NO GET NEXT SUM REC         @Z40RIVS 45421042
         SPACE 1                                               @Z40NIVS 45424042
VOLPTR   DC    F'0'                PNTR TO VOLID,SUM AREA      @Z40NIVS 45427042
         SPACE 1                                               @Z40NIVS 45430042
FLTPTR   DC    F'0'                PNTR TO FLTSYM SUM AREA     @Z40NIVS 45433042
         SPACE 1                                               @Z40NIVS 45436042
ENTRIES  DS    0F                                                       45762042
         SPECIAL RECTST0,00000000,SPACE=0                      @Z40NIVS 45782042
         SPECIAL   XDATE1,00000000,SPACE=4       FROM TO DAY YEAR       45820042
         SPECIAL   ISTPER,00000000,SPACE=3  IS THIS A TPER REC  XL03145 45878042
         SPECIAL   ISLOG,00000000,SPACE=3                               45936042
         SUM   SNB02                             ADD TO BUS OUT PARITY  45994042
         SPECIAL   EQUIP,00000000,SPACE=4        GO CHECK FOR           46052042
*                                                EQUIPMENT CHECK IF ON  46110042
*                                                IS IT CONTROL UNIT     46168042
*                                                       PERMANENT OR    46226042
*                                                       TEMPORARY       46284042
*                                                OR IS IT DRIVE         46342042
*                                                       PERMANENT OR    46400042
*                                                       TEMPORARY       46458042
*                                                AND ADD TO COUNTERS    46516042
         SPECIAL   DATACKP,00000000,SPACE=1      GO ADD TO DATA CHK PRM 46574042
         SUM   SNB05                             ADD TO OVERRN COUNTER  46632042
         SUM   SNB11                             ADD TO INV TRK FMT CNT 46690042
ENDLOG   EQU   *                                               @Z40NIVS 46700042
         SPECIAL RESTOR,00000000,SPACE=0                       @Z40NIVS 46710042
         SPECIAL TFAULT0,0,SPACE=21 SUM FOR SYMPTOM            @Z427VLS 46720042
         DC    XL1'FF'                                         @Z40NIVS 46748042
         DS    0H                                                       46806042
DOVOL    EQU   *                                                        46864042
         SPECIAL TVOLID,0,SPACE=15 LOOK FOR CORRECT            @Z40NIVS 46922042
         SPECIAL RESTOR,00000000,SPACE=0                       @Z40NIVS 46942042
         DC    XL1'FF'                           VOL ID AND ADD T       46980042
*                                                APPROPRIATE COUNTERS   47038042
PEDIT    DS    0F                                                       47096042
*                                                                       47154042
&DSECT   SETC  'T3330'                                                  47212042
&CSECT   SETC  'PEDIT'                                                  47270042
         USING *,R9                                                     47328042
         USING T3330,R2                                                 47386042
         DC    A(PENTRY)                                                47444042
         DC    C'IFCS3330'                                              47502042
YR9PTR   DS    F                                                        47560042
YLABEL   DS    F                                                        47618042
         EJECT                                                          47622042
*********************************************************************** 47626042
*                                                                     * 47630042
*        THE FOLLOWING DSECT DESCRIBES COUNTERS USED TO TOTAL         * 47634042
*        INCIDENTS PERTAINING TO ANY ONE PHYSICAL ADDRESS.            * 47638042
**       INDIVIDUAL ENTRIES ARE MADE FOR UP TO 50 VOLUME LABELS       * 47642042
**       AFTER 50,THE REMAINING ARE COMPILED IN THE 51ST ENTRY.       * 47646042
**       ALSO, IN THE 51ST ENTRY THERE ARE COUNTERS FOR TWO AND       * 47650042
*        FOUR CHANNEL SWITCHES IF A HEX'80' IS FOUND IN BYTE 18       * 47654042
*        OF THE INPUT RECORD,COUNTS ARE MADE FOR CHANNEL 'C' AND 'D'.*  47658042
*        IF A HEX'00' IS FOUND,COUNTS ARE KEPT FOR CHNL 'A' AND 'B'. *  47662042
*                                                                     * 47666042
*********************************************************************** 47670042
T3330    DSECT                                                          47676042
         DS    3H                                                       47734042
         DSGEN (YDUMA,16),(YNOREC,16)                                   47792042
         DSGEN (YTYPE,8),(YCHAN,8),(YCUA,24),(YSER,24)                  47850042
         DSGEN (YCPU,16),(YSMSW,16)                                     47908042
         DSGEN (TDAY1,32),(TDAY2,32)                                    47966042
T3330A   DSGEN (TSTAT,16),(TYPDEV,32),(TDACHKC,16)             @Z40NIVS 48024042
         DSGEN (TDACHKR,16),(TSKCHK,16)                                 48082042
         DSGEN (TBUSOPA,16),(TEQCNT,16)                                 48140042
         DSGEN (TEQCNP,16),(TEQDRT,16)                                  48198042
         DSGEN (TEQDRP,16),(TDATCHP,16)                                 48256042
         DSGEN (TOVERRN,16),(TINVTRKF,16),(TCUA,16)            @Z40NIVS 48314042
         DSGEN (LCUA,16)           ENTRY FOR LOGICAL UNIT      @Z40RIVS 48320042
         DSGEN (SUMREC,512,0,31)                               @Z427VLS 48330042
**                                                             @Z40RIVS 48650042
**       SUM COUNTERS FOR VOLID SUMMARY                        @Z40RIVS 48660042
**                                                             @Z40RIVS 48670042
T3330B   DSGEN (TVOLID1,48),(TSEEK1,32)                        @Z40RIVS 48680042
         DSGEN (TSEEKER1,16),(TBTRDO1,16)                               48788042
         DSGEN (TBYTRD1,32),(TUNCRD1,32)                                49088042
         DSGEN (TCORRD1,32),(TVCUA,16),(TLVCUA,16)             @Z40RIVS 49388042
         DSGEN (TVOLID,240,2,51)                               @Z427VLS 49488042
         DSGEN (TOCACA,16)         CNTR FOR 'A' CMD            @Z40NIVS 54488042
         DSGEN (TOCADA,16),(TOCBCA,16) 'A' DATA AND CHNL 'B' CMD Y01124 56812042
         DSGEN (TOCBDA,16),(TOCCCA,16) 'B' DATA AND CHNL 'C' CMD Y01124 56842042
         DSGEN (TOCCDA,16),(TOCDCA,16) 'C' DATA AND CHNL 'D' CMD Y01124 56872042
         DSGEN (TOCDDA,16)             CNTR FOR 'D' DATA                56902042
         SPACE                                                          56908042
*                                                              @Z40NIVS 56908642
*        SUM COUNTERS FOR FAULT SYMPTOM SUMMARY                @Z40NIVS 56909242
*                                                              @Z40NIVS 56909842
FLTSYM0  DSGEN (SYMCD,16),(SYMCUA,16)                          @Z40NIVS 56910442
         DSGEN (SYMOCR,32)                                     @Z40NIVS 56911042
         DSGEN (SYMDAY,32),(SYMHR,32),(SYMLCUA,16)             @Z40RIVS 56911642
         DSGEN (SYMSNS0,48),(SYMSNS1,48),(SYMSNS2,48),(SYMSNS3,48)      56912042
T3330C   DSGEN (FLTSYM,336,1,50)                               @Z427VLS 56912542
*                                                              @Z40NIVS 56961042
*        THE FOLLOWING EQUATES ARE FOR DISPLACEMENTS FROM THE  @Z40NIVS 56962042
*        FIRST VOL SER COUNTERS TO THE CHANNEL OVERRUN COUNTERS@Z40NIVS 56963042
*                                                              @Z40NIVS 56964042
ABCNTR   EQU   TOCACA-TVOLID1      DIS TO A/B COUNTERS         @Z40NIVS 56965042
CDCNTR   EQU   TOCCCA-TVOLID1      DIS TO C/D COUNTERS         @Z40NIVS 56966042
         SPACE 1                                               @Z40NIVS 56967042
IFCS3330 CSECT                                                 @Z40NIVS 56968042
XR9PTR   DC    F'0'                                                     57014042
XLABELP  DC    F'0'                                                     57072042
         SPACE                                                          60786042
MOVDEV   STM   R5,R8,XSAVE             SAVE REGS                        60788042
         LA    R5,DEVTABLE             LOAD ADDR OF DEVICE TAB  XL03145 60790042
         LA    R6,L2                   LOAD # OF POSSIBLE DEV   XL03145 60792042
         TM    L0(R4),H90              DO THE COUNTS REPRESENT  XL03145 60794042
*                                       TPER RECORDS            XL03145 60796042
         BO    TDEVCHK                 YES - BR TO FIND DEV TYP XL03145 60798042
         SPACE                                                          60800042
ODEVCHK  CLC   L1(L2,R4),L0(R5)        IS DEV SUPPORTED         XL03145 60802042
         BE    DEVFND                  YES - BR TO MOVE DEV TYP XL03145 60804042
         LA    R5,L10(R5)              BUMP PTR TO NXT TYP      XL03145 60806042
         BCT   R6,ODEVCHK              BR TO CHECK NXT TYP      XL03145 60808042
         B     MOVEUNKN                BR - DEVICE IS UNKNOWN   XL03145 60810042
         SPACE                                                          60812042
TDEVCHK  CLC   L1(L1,R4),L2(R5)        IS DEV SUPPORTED         XL03145 60814042
         BE    DEVFND                  YES - BR TO MOVE DEV TYP XL03145 60816042
         LA    R5,L10(R5)              BUMP PTR TO NXT TYP      XL03145 60818042
         BCT   R6,TDEVCHK              BR TO CHK NXT RECORD ID  XL03145 60820042
*                                                               XL03145 60822042
         SPACE                                                          60824042
*      DEVICE IS NOT SUPPORTED MOVE 'UNKNOWN' TO PRINT LINE             60826042
MOVEUNKN MVC   L8(L7,R3),UNKNOWN       MOVE 'UNKNOWN' TO PRINT  XL03145 60828042
**                                                                      60830042
**       RESTORE REGISTERS USED BY ROUTINES IN THIS MODULE              60830442
**                                                                      60830842
RETURN   LM    R5,R8,XSAVE         RESTORE REGS                         60831242
SKIPPER  BR    R14                                                      60831642
         SPACE                                                          60832042
DEVFND   MVC   L8(L7,R3),L3(R5)        MOVE DEVICE TYPE TO      XL03145 60834042
*                                       PRINT LINE              XL03145 60836042
         B     RETURN                  RETURN                   XL03145 60838042
         SPACE 2                                                        60840042
*                                                                       60842042
*        CHECK FOR CPU AND SERIAL NUMBER                                60900042
*                                                                       60958042
SETCPUNO STM   R5,R8,XSAVE             SAVE REGS                 S21926 61016042
         SR    R5,R5                   CLEAR REG 5               S21926 61074042
         IC    R5,L0(R4)               PICK UP MODEL NUMBER      S21926 61132042
         SLL   R5,L8                    INTO                     S21926 61190042
         IC    R5,L1(R4)               R5                        S21926 61248042
         LTR   R5,R5                   TEST FOR ZERO             S21926 61306042
         BNZ   RETURN                  RETURN                    S21926 61364042
         LR    R5,R3                   PUT LINE ADDRESS IN R5    S21926 61422042
         LA    R6,L46                  OFFSET IN REG 6           S21926 61480042
         SR    R5,R6                   SUBTRACT OFFSET FROM POINTER     61538042
         MVC   L0(L6,R5),SHARED        PUT IN SHARED           @Z427VLS 61596042
         B     RETURN                  RETURN                           61712042
*                                                                       61770042
*        SET THE DATE READY FOR PRINT                                   61828042
*                                                                       61886042
SETDATE  UNPK  XSAVE(L8),L1(L3,R4)     UNPACK THE DATE                  61944042
         MVC   L0(L3,R3),XSAVE+L5      MOVE DAY                         62002042
         MVC   L6(L2,R3),XSAVE+L3      MOVE YEAR                        62060042
         BR    R14                                                      62118042
*                                                                       62524042
*        CONVERT COUNTERS FROM HEX TO DECIMAL READY FOR PRINT           63800042
*                                                                       63858042
CONV1    STM   R5,R8,XSAVE             SAVE REGISTERS                   63916042
         XC    READYP(L8),READYP       CLEAR UNPACK BUFFER              63974042
         SR    R6,R6                   ZERO REG                         64032042
         LH    R6,L0(R4)               LOAD DATA TO BE CONVERTED        64090042
CONV2    CVD   R6,READYP               CONVERT ERRORCNTRTO DECI         64148042
         UNPK  READYP(L5),READYP+L5(L3)  UNPACK DECI COUNT              64206042
         OI    READYP+L4,CLRSGN        CLEAR SIGN                       64264042
         MVC   L0(L4,R3),READYP+L1     MOVE COUNTER READY TO PRINT      64322042
         B     RETURN                                                   64380042
*                                                                       64438042
*                                                                       65250042
PRVOLS   STM   R4,R8,XSAVEV                                             66294042
         L     R4,CNTDN2           LOAD ADDR OF NEXT VOLREC    @Z40NIVS 66314042
         LR    R5,R3                                                    66352042
         CLC   L0(L6,R4),ZEROS                                          66410042
         BE    NORETVOL                                                 66468042
*                                                                       66526042
         MVC   L0(L6,R5),L0(R4)        MOVE INTO PRINT VOLID            66584042
         LA    R5,L13(R5)          INCRE PRNT LINE PNTR        @Z40NIVS 66591042
         IC    R6,L27(R4)          PICK UP DEVICE ADDR         @Z40NIVS 66598042
         SLL   R6,L28              SHIFT OUT GARBAGE           @Z40NIVS 66605042
         SRL   R6,L28              SHIFT UNIT TO LOW ORDER     @Z40NIVS 66612042
         LA    R6,CHARS(R6)        PICK UP ADDRESS OF CHAR     @Z40NIVS 66619042
         MVC   L0(L2,R5),CUANR+ONE GET CHAN AND CU             @Z40NIVS 66626042
         MVC   L2(L1,R5),L0(R6)    GET UNIT NUMBER             @Z40NIVS 66633042
         LA    R4,L6(R4)               POINT TO TOTAL SEEKS             66642042
         LA    R5,L13(R5)                                               66700042
         ICM   R6,L15,L0(R4)       LOAD SEEKS                           66758042
         SRL   R6,L10                  REDUCE TO 'X1000'                66918042
         L     R7,TOTSKS               LOAD TOTAL SEEKS                 66998042
         AR    R7,R6                   ADD THIS CNT TO TOTAL            67078042
         ST    R7,TOTSKS               SAVE TOTAL                       67158042
         BAL   R8,CONVH3               PUT SEEKS IN PRINT LINE          67238042
*                                                                       67318042
         LA    R4,L4(R4)               BUMP CNTR PTR                    67398042
         SR    R6,R6                                                    67438042
         SPACE                                                          67478042
         LH    R6,L0(R4)               LOAD SEEK ERRS                   67558042
         LH    R7,TOTSKERS             LOAD TOTAL SEEK ERRS             67638042
         AR    R7,R6                   ADD THIS VOL TO TOTAL            67718042
         STH   R7,TOTSKERS             SAVE NEW TOTAL                   67798042
         BAL   R8,CONVH2               PUT SEEK ERRS IN PRINT           67878042
*                                                                       67958042
         LA    R4,L2(R4)               BUMP CNTR PTR                    68038042
         SPACE 1                                               @Z40NIVS 68118042
         ICM   R6,L15,L2(R4)       LOAD BYTES READ                      68278042
         L     R7,TOTMEGRD             LOAD TOTAL                       68598042
         AR    R7,R6                   ADD THIS VOL TO TOTAL            68678042
         ST    R7,TOTMEGRD             SAVE NEW TOTAL                   68758042
         ST    R6,SAVMEG               SAVE MEG READ                    68838042
         BAL   R8,CONVH2               PUT MEG READ IN PRINT            68918042
*                                                                       68998042
         LA    R4,L6(R4)               BUMP CNTR PTR                    69078042
         SPACE                                                          69158042
         ICM   R6,L15,L0(R4)       LOAD COUNT                           69238042
         BAL   R8,CONVH2               PUT COUNT IN PRINT               69398042
         LTR   R6,R6                   ANY COUNT ??                     69478042
         BNZ   GETRETRD                YES - BR                         69558042
*                                                                       69638042
         MVC   L13(L5,R5),NA           PUT N/A FOR MEG RD/R.ERR         69718042
         LA    R5,L13(R5)              BUMP PRINT POS PTR               69798042
         B     CHKCORRD                BR TO PROCESS CORR READ          69878042
*                                                                       69958042
GETRETRD DS    0H                                                       70038042
         L     R7,TOTRETRD             LOAD TOTAL RETRY READ ER         70118042
         AR    R7,R6                   ADD THIS VOL CNT TO TOT          70198042
         ST    R7,TOTRETRD             SAVE TOTAL                       70278042
*                                                                       70358042
         L     R7,SAVMEG               LOAD MEG READ                    70438042
         LR    R8,R6                   LOAD RETRY READ ERRS             70518042
         SR    R6,R6                   CLEAR REG                        70598042
         DR    R6,R8                   DIVIDE MEG READ/RET RD           70678042
         LR    R6,R7                   LOAD QUOTIENT                    70758042
         BAL   R8,CONVH2               PUT RESULT IN PRINT              70838042
         SPACE                                                          70918042
CHKCORRD DS    0H                                                       70998042
         LA    R4,L4(R4)               BUMP CNTR PTR                    71078042
         ICM   R6,L15,L0(R4)       LOAD CORR RD ERRORS                  71158042
         BAL   R8,CONVH2               COUNT TO PRINT                   71318042
         LTR   R6,R6                   WAS COUNT ZERO ?                 71398042
         BNZ   GETCORRD                NO - BR TO HANDLE                71478042
*                                                                       71558042
         MVC   L13(L5,R5),NA           MOVE N/A FOR MEG/CORR RD         71638042
         B     RETVOL                  BR TO RETURN                     71718042
*                                                                       71798042
GETCORRD DS    0H                                                       71878042
         L     R7,TOTCORRD             LOAD TOTAL SO FAR                71958042
         AR    R7,R6                   ADD THIS VOL TO TOTAL            72038042
         ST    R7,TOTCORRD             SAVE NEW TOTAL                   72118042
*                                                                       72198042
         L     R7,SAVMEG               LOAD MEG READ                    72278042
         LR    R8,R6                   LOAD CORR READ ERRS              72358042
         SR    R6,R6                   CLEAR REG                        72438042
         DR    R6,R8                   DIVIDE MEG READ/COR RD           72518042
         LR    R6,R7                   LOAD QUOTIENT                    72598042
         BAL   R8,CONVH2               PUT IN PRINT LINE                72678042
         B     RETVOL                  BR TO RETURN                     72758042
         SPACE 2                                                        72838042
CONVH2   DS    0H                                                       73902042
         LA    R5,L13(R5)              BUMP PRINT POS PTR               73912042
CONVH3   XC    READYP(L8),READYP                                        73950042
         CVD   R6,READYP                                                74008042
         UNPK  READYP(L5),READYP+L5(L3)                                 74066042
         OI    READYP+L4,CLRSGN                                         74124042
         MVC   L0(L5,R5),READYP                                         74182042
         BR    R8                                                       74240042
*                                                                       74298042
*                                                                       74820042
         EJECT                                                          74878042
*                                                                       74948042
*      THE FOLLOWING INITIALIZES THE TOTALS FOR THE VOLID SUMMARY       75018042
*                                                                       75088042
GETTOTS  DS    0H                                                       75158042
         STM   R4,R8,XSAVEV            SAVE REGS                        75228042
         LR    R5,R3                   LOAD PRINT POS PTR               75298042
         SPACE                                                          75368042
         L     R6,TOTSKS               LOAD TOTAL SEEKS                 75438042
         BAL   R8,CONVH3               PUT IN PRINT LINE                75508042
         SPACE                                                          75578042
         LH    R6,TOTSKERS             LOAD TOTAL SEEK ERRORS           75648042
         BAL   R8,CONVH2               PUT IN PRINT LINE                75718042
         SPACE                                                          75788042
         L     R6,TOTMEGRD             LOAD TOTAL MEG. READ             75858042
         BAL   R8,CONVH2               PUT IN PRINT LINE                75928042
         SPACE                                                          75998042
         L     R6,TOTRETRD             LOAD TOTAL RETRY READ ERS        76068042
         BAL   R8,CONVH2               PUT IN PRINT LINE                76138042
         SPACE                                                          76208042
         LTR   R6,R6                   WERE THERE RETRY RD ERRS         76278042
         BZ    NORETRD                 NO - BR                          76348042
         L     R7,TOTMEGRD             LOAD TOTAL MEG READ              76418042
         LR    R8,R6                   LOAD RETRY READ ERRS             76488042
         SR    R6,R6                   CLEAR REG                        76558042
         DR    R6,R8                   DIVIDE MEG RD/RET RD             76628042
         LR    R6,R7                   LOAD QUOTIENT                    76698042
         BAL   R8,CONVH2               PUT IN PRINT LINE                76768042
         B     GETCRTOT                BR TO CONTINUE                   76838042
*                                                                       76908042
NORETRD  DS    0H                                                       76978042
         LA    R5,L13(R5)              BUMP PRINT POS PTR               77048042
         MVC   L0(L5,R5),NA            MOVE N/A TO PRINT LINE           77118042
         SPACE                                                          77188042
GETCRTOT DS    0H                                                       77258042
         L     R6,TOTCORRD             LOAD CORR READ ERR TOTAL         77328042
         BAL   R8,CONVH2               PUT IN PRINT LINE                77398042
         SPACE                                                          77468042
         L     R8,TOTCORRD             LOAD CORR READ TOTAL             77538042
         LTR   R8,R8                   IS IT ZERO ?                     77608042
         BZ    NOCORRD                 YES - BR                         77678042
*                                                                       77748042
         L     R7,TOTMEGRD             LOAD MEG READ TOTAL              77818042
         SR    R6,R6                   CLEAR REG                        77888042
         DR    R6,R8                   DIVIDE MEG RD/CORR RD            77958042
         LR    R6,R7                   LOAD QUOTIENT                    78028042
         BAL   R8,CONVH2               PUT IN PRINT LINE                78098042
         B     CLRTOTS                 BR TO CONTINUE                   78168042
*                                                                       78238042
NOCORRD  DS    0H                                                       78308042
         MVC   L13(L5,R5),NA           MOVE N/A TO PRINT                78378042
         SPACE                                                          78448042
CLRTOTS  DS    0H                                                       78518042
         XC    TOTSKS(TLEN),TOTSKS     CLEAR ALL TOTAL AREAS            78588042
         B     RETVOL                  BR TO RETURN                     78658042
         EJECT                                                          78728042
GETABCDD STM   R4,R8,XSAVEV            SAVE REGS                 Y01124 79750042
         LR    R5,R3                                                    79808042
         LA    R7,L4                   NO. OF POSSIBLE CHANNELS  Y01124 79866042
         SR    R6,R6               CLEAR R6                    @Z40RIVS 79886042
SETCHDTA ICM   R6,L3,L0(R4)        MOVE IN NO. OF DATA OVERRUN          79916042
         BAL   R8,CONVH3                                                80040042
*                                                                       80098042
         LA    R4,L4(R4)               BUMP PNTR TO NEXT DTA CTR Y01124 80156042
         LA    R5,L29(R5)              BUMP PNTR TO NEXT PRNT POSY01124 80246042
         BCT   R7,SETCHDTA             BRANCH IF THERE ARE MORE  Y01124 80336042
*                                                                       80446042
RETVOL   LM    R4,R8,XSAVEV                                             80504042
         BR    R14                                                      80509042
*                                                              @Z40NIVS 80514042
NORETVOL LM    R4,R8,XSAVEV                                    @Z40NIVS 80524042
         SR    R15,R15                                         @Z40NIVS 80534042
         BR    R14                                             @Z40NIVS 80544042
*                                                              @Z40NIVS 81220042
*        ROUTINE TO SAVE CHANEL AND CONTROL UNIT FOR SUBSYSTEM @Z40NIVS 81258042
*                                                              @Z40NIVS 81260042
CUAN0    STM   R5,R8,XSAVE         SAVE WORK REGS              @Z40NIVS 81262042
         LA    R5,L10              LOAD DECREMENT FOR R3       @Z40NIVS 81264042
         SR    R3,R5               PNT TO START OF PRNT LI     @Z40NIVS 81266042
         MVC   CUANR+ONE(L3),L1(R3) MOVE CHANEL AND CU         @Z40NIVS 81268042
         SR    R15,R15             CLR FOR NO PRINT            @Z40NIVS 81270042
         B     RETURN              RETURN                      @Z40NIVS 81272042
*                                                              @Z40NIVS 81274042
*        SORT FOR VOLID TO PUT HIGHEST ERROR RATE  FIRST       @Z40NIVS 81276042
*                                                              @Z40NIVS 81278042
SORTV0   STM   R5,R8,XSAVE         SAVE WORK REG               @Z40NIVS 81280042
         ST    R4,SRTSAV           SAVE REG 4                  @Z40NIVS 81282042
         ST    R4,CNTDN2           SAVE VOL PNTR FOR PRT       @Z40NIVS 81284042
SORTV1   SR    R8,R8               CLR REG 8 FOR SWITCH        @Z40NIVS 81286042
         L     R4,SRTSAV           SET 4 TO START OF SUM       @Z40NIVS 81288042
         LA    R5,L30(R4)          SET 5 TO NEXT REC           @Z40RIVS 81290042
         LA    R7,L49              SET 7 TO NO.REC-1           @Z40NIVS 81292042
SORTV2   CLC   L0(L6,R5),ZEROS     IS THERE A VOLID            @Z40NIVS 81294042
         BE    SORTV4              NO BR TO TEST SW            @Z40NIVS 81296042
         CLC   L12(L2,R4),L12(R5)  TEST FOR HIGH COUNT         @Z40NIVS 81298042
         BNH   SORTV3              BRCH IF HIGH REC FIRST      @Z40NIVS 81300042
         LA    R8,L15              SET MOVE SWITCH             @Z40NIVS 81302042
         XC    L0(L30,R4),L0(R5)   RECORD                      @Z40RIVS 81304042
         XC    L0(L30,R5),L0(R4)   SWAP                        @Z40RIVS 81306042
         XC    L0(L30,R4),L0(R5)   FOR SORT                    @Z40RIVS 81308042
SORTV3   LA    R4,L30(R4)          POINT TO NEXT REC           @Z40RIVS 81310042
         LA    R5,L30(R5)          POINT TO NEXT REC+1         @Z40RIVS 81312042
         BCT   R7,SORTV2           MORE TO TEST                @Z40NIVS 81314042
SORTV4   LTR   R8,R8               TEST PASS SWITCH            @Z40NIVS 81316042
         BZ    RETURN              ALL REC TESTED/MOVED        @Z40NIVS 81318042
         B     SORTV1              CONTINUE TO TEST/MOVE       @Z40NIVS 81320042
*                                                              @Z40NIVS 81322042
**  ROUTINE TO PRINT 50 VOLID SUM ENTRIES                      @Z40NIVS 81324042
*                                                              @Z40NIVS 81326042
CNTDN0   STM   R5,R8,XSAVE         SAVE THE REGS               @Z40NIVS 81328042
         SR    R5,R5               CLEAR REG                   @Z40NIVS 81330042
         L     R5,CNTDN3           LOAD WITH 50                @Z40NIVS 81332042
         BCT   R5,CNTDN1           BRANCH FOR 50               @Z40NIVS 81334042
CNTDN5   SR    R15,R15             CLEAR FOR NO PRINT          @Z40NIVS 81336042
         B     RETURN              RETURN                      @Z40NIVS 81338042
CNTDN1   ST    R5,CNTDN3           SAVE R 5                    @Z40NIVS 81340042
         L     R5,CNTDN2           GET CNTDN VALUE             @Z40NIVS 81342042
         LA    R5,L30(R5)          INCREMENT BY 30             @Z40RIVS 81344042
         CLC   L0(L6,R5),ZEROS     TESTFOR VOLID EQ ZERO       @Z40NIVS 81346042
         BE    CNTDN5              BRANCH NONE TO PRNT         @Z40NIVS 81348042
         ST    R5,CNTDN2           PUT IT BACK                 @Z40NIVS 81350042
         LA    R5,SUMTA3-4         GET LINE ADDRESS            @Z40NIVS 81352042
         L     R6,ASUMTA4          GET LABEL ADDRESS           @Z40NIVS 81354042
         STM   R5,R6,YR9PTR        MAKE THEM CURRENT           @Z40NIVS 81356042
         B     RETURN              RETURN                      @Z40NIVS 81358042
         SPACE 1                                               @Z40NIVS 81360042
*                                                              @Z40NIVS 81362042
*        ROUTINE TO DETERMINE IF NECESSARY TO EDIT FLTYSYM     @Z40NIVS 81364042
*                                                              @Z40NIVS 81366042
FLTTST0  STM   R5,R8,XSAVE         SAVE WORK REGS              @Z40NIVS 81368042
         LA    R4,L42(R4)          INCREMENT TO FIRST REC      @Z427VLS 81370042
         CLC   L0(L4,R4),ZEROS     ARE SYM AND CUA ZERO        @Z40NIVS 81372042
         BNE   FLTTST1             NO CONTINUE                 @Z40NIVS 81374042
         LA    R7,SUMTAC-4         YES, PICK UP NEW LINE       @Z40NIVS 81376042
         L     R8,ASUMTAD          AND LABEL ADDRESSES         @Z40NIVS 81378042
         STM   R7,R8,YR9PTR        TO START FROM               @Z40NIVS 81380042
FLTTST1  B     RETURN              RETURN                      @Z40NIVS 81382042
*                                                              @Z40NIVS 81384042
*       ROUTINE FOR SORTING THE FAULT SYMPTOM ENTERIES         @Z40NIVS 81386042
*                                                              @Z40NIVS 81388042
FLTSRT0  STM   R5,R8,XSAVE         SAVE WORK REGS              @Z40NIVS 81390042
         ST    R4,FLTSRT8          SAVE PNTR TO EDIT AREA      @Z40NIVS 81392042
         SR    R6,R6               CLEAR FOR SW                @Z40NIVS 81394042
FLTSRT1  LA    R4,L42(R4)          INCREMENT TO FIRST REC      @Z427VLS 81396042
         SR    R7,R7               CLR MOVE SWITCH             @Z40NIVS 81398042
         LA    R8,L50              SET R8 TO NUM REC           @Z40NIVS 81400042
FLTSRT2  CLC   L44(L2,R4),ZEROS    IS DEV ADDR ZERO            @Z427VLS 81402042
         BE    FLTSRT6             END REC AREA                @Z40NIVS 81404042
         LTR   R6,R6               IS THIS FIRST SORT          @Z40RIVS 81406042
         BZ    FLTSRT3             YES GO TO CUA SORT          @Z40RIVS 81408042
         CLC   L0(L2,R4),L42(R4)   COMPARE SYM CODE            @Z427VLS 81410042
         BNH   FLTSRT4             BRCH IF ASCENDING           @Z40RIVS 81412042
         B     FLTSRT35            DECENDING GO SWAP           @Z40RIVS 81414042
FLTSRT3  CLC   L2(L2,R4),L44(R4)   COMP CUA/SYM                @Z427VLS 81416042
         BNH   FLTSRT4             BRCH IF ASCENDING ORDER     @Z40RIVS 81418042
FLTSRT35 XC    L0(L42,R4),L42(R4)  SWAP REC                    @Z40RIVS 81420042
         XC    L42(L42,R4),L0(R4)  PUT IN ASCENDING            @Z40RIVS 81422042
         XC    L0(L42,R4),L42(R4)  ORDER                       @Z40RIVS 81424042
         LA    R7,L15              TURN MOVE SWITCH ON         @Z40RIVS 81426042
FLTSRT4  LA    R4,L42(R4)          INCREMENT FOR NEXT TEST     @Z427VLS 81428042
         BCT   R8,FLTSRT2          GO MAX 50 PASSES            @Z40RIVS 81430042
FLTSRT6  LTR   R7,R7               MOVE SWITCH SET             @Z40RIVS 81432042
         BZ    FLTSRT7             GO TO END                   @Z40RIVS 81434042
         L     R4,FLTSRT8          RESET R4 TO START           @Z40RIVS 81436042
         B     FLTSRT1             GO CYCLE ONCE MORE          @Z40RIVS 81438042
FLTSRT7  L     R4,FLTSRT8          NO RESTORE R4               @Z40RIVS 81440042
         LTR   R6,R6               IS THIS FIRST SORT          @Z40RIVS 81442042
         BNZ   FLTSRT9             NO  GO TO COMPLETION        @Z40RIVS 81444042
         LA    R6,L15              YES SET SORT SWITCH         @Z40RIVS 81446042
         B     FLTSRT1             SORT ON SYM CODE            @Z40RIVS 81448042
FLTSRT9  MVC   L0(L42,R4),L42(R4)  MOVE FIRST REC TO EDIT      @Z427VLS 81450042
         LA    R4,L42(R4)          INCREMENT R4 BY REC LENGTH  @Z427VLS 81452042
         ST    R4,FLTMOV2          KEEP USE BY MOVE RTNE       @Z40RIVS 81454042
         LA    R6,L48              SET REG 6 TO NUM REC        @Z40RIVS 81456042
         ST    R6,FLTMOV6          KEEP USE BY MOVE RTNE       @Z40RIVS 81458042
         B     RETURN                                          @Z40RIVS 81460042
         SPACE 1                                               @Z40RIVS 81462042
**                                                             @Z40RIVS 81464042
**       ROUTINE TO MOVE NEXT REC FROM SUM AREA TO EDIT AREA TO PRINT   81466042
**                                                             @Z40RIVS 81468042
FLTMOV0  STM   R5,R8,XSAVE         SAVE WORK REG               @Z40RIVS 81470042
         L     R5,FLTMOV2          PICK UP PNTR LAST REC       @Z40RIVS 81472042
         LA    R5,L42(R5)          POINT TO NEW REC            @Z427VLS 81474042
         ST    R5,FLTMOV2          SAVE PNTR                   @Z40RIVS 81476042
         CLC   L2(L2,R5),ZEROS     IS REC EQ ZERO              @Z40RIVS 81478042
         BE    FLTMOV3             BRNCH PREPARE NEW EDIT      @Z40RIVS 81480042
FLTMOV1  MVC   L0(L42,R4),L0(R5)   MOVE NEW REC TO EDIT        @Z427VLS 81482042
         LA    R7,SUMTA7-L4        BACK UP LINE AND            @Z40RIVS 81484042
         L     R8,ASUMTA8          LABEL POINTER TO            @Z40RIVS 81486042
         STM   R7,R8,YR9PTR        PRINT NEXT REC              @Z40RIVS 81488042
         L     R6,FLTMOV6          SET R6 TO NUM REC T         @Z40RIVS 81490042
         BCT   R6,FLTMOV7          REDUCE COUNT BY ONE         @Z40RIVS 81492042
         B     FLTMOV3             END FIRST SECTION           @Z40RIVS 81494042
FLTMOV7  ST    R6,FLTMOV6          SAVE NUM REC REMAIN         @Z40RIVS 81496042
         SR    R15,R15             CLR FOR NO PRINT            @Z40RIVS 81498042
FLTMOV3  B     RETURN              GO PRINT NEXT RECORD        @Z40RIVS 81500042
         EJECT                                                 @Z40RIVS 81502042
**                                                             @Z40RIVS 81504042
**       EDIT CYCLE TO PRINT 16 SUM COUNTERS                   @Z40RIVS 81506042
**                                                             @Z40RIVS 81508042
EDTFA0   STM   R5,R8,XSAVE         SAVE WORK REGS              @Z40RIVS 81510042
         L     R7,EDTFA4           GET COUNTER                 @Z40RIVS 81512042
EDTFA1   L     R5,EDTFA5           PICK UP LAST PRT            @Z40RIVS 81514042
         LA    R5,L32(R5)          INCREMENT TO NEXT           @Z40RIVS 81516042
         ST    R5,EDTFA5           SAVE LAST REC PRT           @Z40RIVS 81518042
         OC    L28(L2,R5),L28(R5)  TEST CUA                    @Z40RIVS 81520042
         BNZ   EDTFA2              BRCH IF NO REC INFO         @Z40RIVS 81522042
         BCT   R7,EDTFA1           REDUCE REC CNTR             @Z40RIVS 81524042
         B     RETURN              RETURN                      @Z40RIVS 81526042
EDTFA2   BCT   R7,EDTFA3           REDUCE REC CNTR             @Z40RIVS 81528042
         B     RETURN              RETURN                      @Z40RIVS 81530042
EDTFA3   MVC   L0(L32,R4),L0(R5)   MOVE REC TO PRNT            @Z40RIVS 81532042
         ST    R7,EDTFA4           SAVE REC NO                 @Z40RIVS 81534042
         LA    R7,SUMTA1-L4        LOAD LINE ADDR-4            @Z40RIVS 81536042
         L     R8,ASUMTA2          LABEL POINTER TO ADDR-1     @Z40RIVS 81538042
         STM   R7,R8,YR9PTR        STORE NEW PNTR              @Z40RIVS 81540042
         SR    R15,R15             CLEAR FOR NO PRNT           @Z40RIVS 81542042
         B     RETURN              RETURN                      @Z40RIVS 81544042
EDTFA6   STM   R5,R8,XSAVE         SAVE WORK REG               @Z40RIVS 81546042
         L     R7,EDTFA4           PICK UP NO. REC T           @Z40RIVS 81548042
         LR    R5,R4               LOAD SUM AREA PNTR          @Z40RIVS 81550042
EDTFA7   LA    R5,L32(R5)          INCRM TO REC AREA           @Z40RIVS 81552042
         ST    R5,EDTFA5           SAVE PNTR                   @Z40RIVS 81554042
         OC    L28(L2,R5),L28(R5)  TEST FOR CUA                @Z40RIVS 81556042
         BNZ   EDTFA8              GO MOVE REC                 @Z40RIVS 81558042
         BCT   R7,EDTFA7           NO CUA TEST NEXT REC        @Z40RIVS 81560042
         LA    R7,L1               NO REC SET R7 TO ONE        @Z40RIVS 81562042
         ST    R7,EDTFA4           STORE TO PRNT ZERO          @Z40RIVS 81564042
         ST    R4,EDTFA5           SET TO START OF SUM AREA    @Z40RIVS 81566042
         B     RETURN              NO REC                      @Z40RIVS 81568042
EDTFA8   ST    R7,EDTFA4           SET TO NO. REC T            @Z40RIVS 81570042
         MVC   L0(L32,R4),L0(R5)   MOVE FIRST REC TO PRNT      @Z40RIVS 81572042
         B     RETURN                                          @Z40RIVS 81574042
**                                                             @Z40RIVS 81576042
**       ROUTINES TO INCREMENT OR DECREMENT PRNT LINE PNTR     @Z40RIVS 81578042
**                                                             @Z40RIVS 81580042
REPNT0   BCTR  R3,R0               REDUCE PRNT LINE PNTR       @Z40RIVS 81582042
         BR    R14                 RETURN                      @Z40RIVS 81584042
REPNT1   LA    R4,L4               SET REG4 TO FOUR            @Z40RIVS 81586042
         SR    R3,R4               REDUCE PRNT LINE PNTR       @Z40RIVS 81588042
         BR    R14                 RETURN                      @Z40RIVS 81590042
REPNT2   LA    R4,L3               SET REG4 TO THREE           @Z40RIVS 81592042
         SR    R3,R4               REDUCE PRNT LINE PNTR       @Z40RIVS 81594042
         BR    R14                 RETURN                      @Z40RIVS 81596042
REPNT3   LA    R3,L15(R3)          INCR PRNT LINE PNTR +15     @Z40RIVS 81598042
         BR    R14                 RETURN                      @Z40RIVS 81600042
**                                                             @Z40RIVS 81602042
**       ROUTINE TO MOVE DATE TO FAULT SYMPTOM PRINTLINE       @Z40RIVS 81604042
**                                                             @Z40RIVS 81606042
FLTSYDA  UNPK  XSAVE(L8),L1(L3,R4) UNPACK THE DATE             @Z40RIVS 81608042
         MVC   L0(L3,R3),XSAVE+L5  MOVE JULIAN DATE            @Z40RIVS 81610042
         MVI   L3(R3),SLASH        MOVE SEPARATOR              @Z40RIVS 81612042
         MVC   L4(L2,R3),XSAVE+L3  MOVE YEAR                   @Z40RIVS 81614042
         LA    R4,L4               LOAD R4 WITH 4              @Z427VLS 81616042
         SR    R3,R4               REDUCE PRINT LINE PNTR      @Z40RIVS 81618042
         BR    R14                 RETURN                      @Z40RIVS 81620042
**                                                             @Z40RIVS 81622042
**       ROUTINE TO PREPARE TO CONVERT OCCUR COUNT TO PRINTABLE         81624042
**       FORMAT AND BLANK LEADING ZERO ON DEVICE ADDRESS FAULT SUM      81626042
**                                                             @Z40RIVS 81628042
GETOCCUR STM   R5,R8,XSAVE         SAVE WORK REG               @Z40RIVS 81630042
         LA    R5,L20              BLANK OUT                   @Z40RIVS 81632042
         LR    R6,R3               LEADING ZERO                @Z40RIVS 81634042
         SR    R6,R5               ON DEVICE                   @Z40NIVS 81638042
         MVI   L0(R6),BLANK        ADDRESS                     @Z40NIVS 81640042
         ICM   R6,L15,L0(R4)       LOAD CNT                    @Z40NIVS 81642042
         LR    R5,R3               SET PRINT LINE PNTR         @Z40NIVS 81646042
         BAL   R8,CONVH3           USE STANDARD ROUTINE        @Z40NIVS 81648042
         B     RETURN              RETURN                      @Z40NIVS 81650042
*                                                              @Z40NIVS 81652042
*        ROUTINE TO REFORMAT TIME IN FAULT SYMPTOM OUTPUT      @Z40NIVS 81654042
*                                                              @Z40NIVS 81656042
HREDIT0  STM   R5,R8,XSAVE         SAVE WORK REGS              @Z40NIVS 81658042
         LA    R5,L10              SET REG5 TO 10              @Z427VLS 81660042
         SR    R3,R5               DECR PRNT LINE PNTR         @Z40NIVS 81662042
         MVC   READYP(L6),L0(R3)   SAVE FORMATED OUTPUT        @Z40NIVS 81664042
         MVI   L0(R3),COLON        MOVE IN SEPERATOR CHAR      @Z40NIVS 81666042
         MVC   L1(L2,R3),READYP    MOVE MIN TO PRNT LINE       @Z40NIVS 81668042
         MVI   L3(R3),COLON        MOVE IN SEPERATOR CHAR      @Z40NIVS 81670042
         MVC   L4(L2,R3),READYP+TWO  MOVE SEC TO PRNT LINE     @Z40NIVS 81672042
         MVI   L6(R3),COLON        MOVE IN SEPERATOR CHAR      @Z40NIVS 81674042
         MVC   L7(L2,R3),READYP+FOUR  MOVE THOU TO PRNT LINE   @Z40NIVS 81676042
         B     RETURN              RETURN                      @Z40NIVS 81678042
*                                                              @Z40NIVS 81680042
*        ROUTINE TO BLANK OUT LEADING ZERO ON DEVICE ADDR      @Z40NIVS 81682042
*                                                              @Z40NIVS 81684042
NOPRNTT  STM   R5,R8,XSAVE         SAVE WORK REGS              @Z40NIVS 81686042
         LA    R5,L6               LOAD DECRMT INTO REG 5      @Z40NIVS 81688042
         LR    R6,R3               LOAD PRNT LINE INTO R6      @Z40NIVS 81690042
         SR    R6,R5               BACK UP PRNT LINE PNTR      @Z40NIVS 81692042
         MVI   L0(R6),BLANK        BLANK OUT ZERO              @Z40NIVS 81694042
         LA    R3,L2(R3)           INCREMENT LINE PNTR         @Z40RIVS 81695042
         B     RETURN              RETURN                      @Z40NIVS 81696042
*                                                              @Z40NIVS 81698042
*        ROUTINE TO CALCULATE MEGABYTES READ AND SETUP FIELD   @Z40NIVS 81700042
*        FOR SORT FOR THE VOLID SUMMATION                      @Z40NIVS 81702042
*                                                              @Z40NIVS 81704042
SETUP0   STM   R5,R8,XSAVE         SAVE WORK REGS              @Z40NIVS 81706042
         LA    R8,L50              LOAD NO. OF SUM REC         @Z40NIVS 81708042
SETUP1   CLC   L0(L6,R4),ZEROS     IS VOLID ZERO               @Z40NIVS 81710042
         BE    SETUP5              GO TO RETURN                @Z40NIVS 81712042
         MVC   READYP(L4),L18(R4)  MOVE RETRY CNT              @Z40NIVS 81714042
         L     R5,READYP           LOAD RETRY COUNT            @Z40NIVS 81716042
         MVC   READYP+L2(L6),L12(R4) MOVE BYTES READ           @Z40NIVS 81718042
         LH    R6,READYP+L2        LOAD OVERFLOW BYTES         @Z40NIVS 81720042
         L     R7,READYP+L4        LOAD BYTES READ             @Z40NIVS 81722042
         SRDL  R6,L20              CONVERT TO MEGABYTES        @Z40NIVS 81724042
         ST    R7,SETUP7           SAVE FOR MOVE               @Z40NIVS 81726042
         MVC   L14(L4,R4),SETUP7   MOVE MEGABYTES TO REC       @Z40NIVS 81728042
         CR    R7,R5               COMPARE RETRY TO MEGA       @Z40NIVS 81730042
         BNL   SETUP2              MEGABYTES IS HIGH           @Z40NIVS 81732042
         MVC   L12(L2,R4),ZEROS    MOVE IN ZEROS               @Z40NIVS 81734042
         B     SETUP4              GO AGAIN                    @Z40NIVS 81736042
SETUP2   LTR   R5,R5               TEST FOR NO RETRY CNT       @Z40NIVS 81738042
         BZ    SETUP6              GO SET UP FOR SORT          @Z40NIVS 81740042
         SR    R6,R6               CLR REG 6 FOR DIV           @Z40NIVS 81742042
         DR    R6,R5               RETRY INTO MEGABYTES        @Z40NIVS 81744042
         ST    R7,SETUP7           SAVE MEGA/RETRY             @Z40NIVS 81746042
SETUP3   MVC   L12(L2,R4),SETUP7+L2 MOVE IN FOR SORT           @Z40NIVS 81748042
SETUP4   LA    R4,L30(R4)          INCREMENT TO NEXT REC       @Z40RIVS 81750042
         BCT   R8,SETUP1           DECREMENT REC CNT           @Z40NIVS 81752042
SETUP5   B     RETURN              RETURN                      @Z40NIVS 81754042
SETUP6   OI    SETUP7+L2,SORTFLG   SET UP FOR SORT             @Z40NIVS 81756042
         B     SETUP3              GO TO MOVE SORT FIELD       @Z40NIVS 81758042
*                                                              @Z40NIVS 81760042
*                                                              @Z40NIVS 81762042
THEEND   STM   R14,R12,L12(R13)        SAVE ALL REGS           @Z40NIVS 81764042
         LR    R12,R13                 SAVE THE SAVE ADDRESS   @Z40NIVS 81766042
         LA    R13,FSAVE               POINT TO MY SAVE        @Z40NIVS 81768042
         ST    R12,L4(R13)             SET CHAINING POINTERS   @Z40NIVS 81770042
         ST    R13,L8(R12)                                       S21926 81780042
         L     R3,L4(R2)               PICK UP POINTER TO NEXT COUNTER  81838042
         ST    R3,L28(R12)             SAVE POINTER IN REG SAVE  S21926 81896042
         LH    R0,SIZE                 PICK UP SIZE OF AREA      S21926 81954042
         LR    R1,R2                   SET ADDRESS               S21926 82012042
         FREEMAIN R,LV=(0),A=(1)                                 S21926 82070042
         LTR   R3,R3                   ANY MORE COUNTERS         S21926 82128042
         BZ    RETURNO                 NO RETURN                 S21926 82186042
         LA    R5,PENTRY+L10       POINT TO TOP ENTRY LESS 4            82244042
         LA    R6,LABELS-L1        POINT TO FIRST LABEL LESS 1          82314042
         STM   R5,R6,YR9PTR        STORE IT IN TABLE                    82384042
RETURNO  L     R13,L4(R13)             PICK UP &                 S21926 82476042
         LM    R14,R12,L12(R13)        RESTORE REGS              S21926 82534042
         BR    R14                                                      82592042
*                                                                       82650042
SIZE     DC    H'5776'                                         @Z427VLS 83636042
         DS    0D                                                       83694042
XSAVE    DC    5F'0'                                                    83752042
XSAVE1   EQU   XSAVE                                                    83762042
XSAVEV   EQU   XSAVE                                                    83772042
FSAVE    DS    18F                                                      83810042
*                                                                       83868042
EMCUA1   DC    X'00'                                           @Z40RIVS 83871042
EMCUA    DC    H'0'                                            @Z40RIVS 83874042
RECTST4  DC    F'0'                                            @Z40NIVS 83878042
RECTSTS  DC    F'0'                                            @Z40NIVS 83888042
RECTSTP  DC    F'0'                                            @Z40NIVS 83898042
TFAULT7  DC    F'0'                                            @Z40NIVS 83908042
CUANR    DC    F'0'                SAVE AREA FOR CH-CU         @Z40NIVS 83918042
SRTSAV   DC    F'0'                SAVE FOR REG 4              @Z40NIVS 83928042
CNTDN2   DC    F'0'                                            @Z40NIVS 83938042
CNTDN3   DC    F'50'                                           @Z40NIVS 83948042
ASUMTA4  DC    A(SUMTA4-1)                                     @Z40NIVS 83958042
ASUMTAD  DC    A(SUMTAD-1)                                     @Z40NIVS 83968042
FLTSRT8  DC    F'0'                                            @Z40NIVS 83978042
ASUMTA8  DC    A(SUMTA8-1)                                     @Z40NIVS 83988042
FLTMOV2  DC    F'0'                                            @Z40NIVS 83998042
FLTMOV6  DC    F'0'                                            @Z40NIVS 84018042
ASUMTA2  DC    A(SUMTA2-1)                                     @Z40NIVS 84028042
EDTFA4   DC    F'64'               NUMBER OF COUNTERS          @Z40RIVS 84038042
EDTFA5   DC    F'0'                                            @Z40NIVS 84048042
SETUP7   DC    F'0'                SAVE AREA                   @Z40NIVS 84058042
         SPACE 2                                                        84158042
TOTSKS   DC    F'0'                                                     84198042
TOTMEGRD DC    F'0'                                                     84238042
SAVMEG   DC    F'0'                    SAVE AREA FOR MEG READ           84278042
TOTRETRD DC    F'0'                                                     84318042
TOTCORRD DC    F'0'                                                     84358042
TOTSKERS DC    H'0'                                                     84398042
*                                                                       84438042
TLEN     EQU   *-TOTSKS                LENGTH OF TOTALS AREA            84478042
         SPACE 2                                                        84594042
ZEROS    DC    5F'0'                                                    84854042
HEX00    EQU   ZEROS                                                    84874042
NA       DC    C'-N/A-'                                        @Z40NIVS 85028042
SHARED   DC    C'SHARED'                                       @Z427VLS 85086042
UNKNOWN  DC    C'UNKNOWN'                                       XL03145 85106042
CHARS    DC    C'0123456789ABCDEF'                                      85144042
CHAR0    DC    C'0'                                                     85202042
DEVTABLE DC    X'2009'                 DEVICE TYPE &            XL03145 85318042
         DC    X'01'                         REC ID FOR A       XL03145 85328042
         DC    C'3330   '                            MERLIN     XL03145 85338042
*                                                                       85348042
         DC    X'200D'                 DEVICE TYPE &            XL03145 85358042
         DC    X'0A'                         REC ID FOR AN      XL03145 85368042
         DC    C'3330   '                            ICEBERG   @Z40NIVS 85378042
         SPACE                                                          85388042
         DS    0D                                                       85434042
READYP   DC    D'0'                                            @Z40NIVS 85492042
PENTRY   DS    0F                                                       85840042
         DC    X'0001001'                                               85898042
         DC    X'0001001'                                               85956042
         DC    A(LABELS)                                                86014042
         DC    H'0'                                                     86072042
         LINE  ,,SKIP=2                                        @Z40NIVS 86082042
         ROUTINE YDUMA,SKIPPER     INSURE EJECT                @Z40NIVS 86092042
         LABEL ''                                              @Z40NIVS 86102042
         DC    X'01'                                                    86130042
         DC    X'000B8B00'                                              86188042
         LABEL ' '                                                      86246042
         LINE  (61,23),(1,19),SKIP=2                           @Z40NIVS 86304042
         ROUTINE   TYPDEV,MOVDEV                                XL03145 86362042
         HEX   YCPU,0,2B                                                86478042
         HEX   YSER,0,3B                                                86536042
         ROUTINE   YCPU,SETCPUNO                                        86594042
         LABEL 'SUMMARY OF I/O RECO','RDS  TYPE OBR/MDR  ',    @Z40NIVSC86604042
               'SOURCE-OUTBOARD   D',                          @Z40NIVSC86614042
               'EVICE TYPE ',' MODEL-','SERIAL NO.-'           @Z40NIVS 86624042
*                                                                       86652042
         LINE  ,(13,13),SKIP=1                                          86710042
         ROUTINE   YDUMA,SKIPPER                                        86768042
         LABEL 'DAY YEAR','DAY YEAR'                                    86826042
         LINE  (13,13),(1,21),SKIP=2                                    86884042
         ROUTINE   TDAY1,SETDATE                                        86942042
         ROUTINE   TDAY2,SETDATE                                        87000042
         ROUTINE YDUMA,REPNT3                                  @Z40NIVS 87010042
         ROUTINE YNOREC,CONV1                                  @Z40NIVS 87020042
         LABEL 'DATE RANGE-','TO','TOTAL NUMBER OF RECORDS'    @Z40NIVS 87058042
*                                                                       87116042
         LINE  (1,1),(1,1),SKIP=1                              @Z40NIVS 87174042
         ROUTINE YDUMA,SKIPPER                                 @Z40NIVS 87204042
         LABEL 'UNIT          BUS OUT    EQUIP. CK.    EQUIP. CK.    DAC87234042
               TA     OVERRN     INV.         LOGGING MODE        STATIC87274042
               S-'                                             @Z40RIVS 87314042
         LINE  ,,SKIP=1                                        @Z40RIVS 87334042
         ROUTINE YDUMA,SKIPPER                                 @Z40NIVS 87354042
         LABEL 'ADDRESS       PARITY        C.U.         DRIVE       CHC87384042
               ECK               TRACK    DATA CHECK     SEEK     TICALC87404042
                '                                              @Z40RIVS 87424042
         LINE  ,,SKIP=2                                        @Z40NIVS 87444042
         ROUTINE TSTAT,EDTFA6                                  @Z40NIVS 87474042
SUMMAD0  LABEL 'PHYSICAL                 TEMP  PERM    TEMP  PERM    PEC87504042
               RM                FMT.     CORR  RETRY    CHECK'         87534042
SUMTA1   LINE  (1,6),(1,1),SKIP=1                              @Z427VLS 87564042
         HEX   TCUA,0,2B           CONVERT ADDRESS             @Z40NIVS 87594042
         ROUTINE YDUMA,NOPRNTT     DON'T PRINT LEADING ZERO    @Z40NIVS 87624042
         ROUTINE TBUSOPA,CONV1     CONVERT BUS OUT PARITY      @Z40NIVS 87654042
         ROUTINE YDUMA,REPNT0      ALTER PRNT LINE PNTR        @Z40NIVS 87684042
         ROUTINE TEQCNT,CONV1      CONVERT EQ CHK CU TEMP      @Z40NIVS 87714042
         ROUTINE TEQCNP,CONV1      CONVERT EQ CHK CU PERM      @Z40NIVS 87744042
         ROUTINE YDUMA,REPNT1      ALTER PRNT LINE PNTR        @Z40NIVS 87774042
         ROUTINE TEQDRT,CONV1      CONVERT EQ CHK DRV TEMP     @Z40NIVS 87804042
         ROUTINE TEQDRP,CONV1      CONVERT EQ CHK DRV PERM     @Z40NIVS 87834042
         ROUTINE YDUMA,REPNT1      ALTER PRNT LINE PNTR        @Z40NIVS 87864042
         ROUTINE TDATCHP,CONV1     CONVERT DATA CHK PERM       @Z40NIVS 87894042
         ROUTINE YDUMA,REPNT2      ALTER PRNT LINE PNTR        @Z40NIVS 87924042
         ROUTINE TOVERRN,CONV1     CONVERT OVERRUN             @Z40NIVS 87954042
         ROUTINE YDUMA,REPNT0      ALTER PRNT LINE PNTR        @Z40NIVS 87984042
         ROUTINE TINVTRKF,CONV1    CONVERT INV TRK FORMAT      @Z40NIVS 88014042
         ROUTINE YDUMA,REPNT2      ALTER PRNT LINE PNTR        @Z40NIVS 88044042
         ROUTINE TDACHKC,CONV1     CONVERT DATA CHK CORR       @Z40NIVS 88074042
         ROUTINE TDACHKR,CONV1     CONVERT DATA CHK RETRY      @Z40NIVS 88104042
         ROUTINE YDUMA,REPNT2      ALTER PRNT LINE PNTR        @Z40NIVS 88134042
         ROUTINE TSKCHK,CONV1      CONVERT SK CHK COUNTER      @Z40NIVS 88164042
         ROUTINE YDUMA,REPNT2      ALTER PRNT LINE PNTR        @Z40NIVS 88194042
         ROUTINE TSTAT,CONV1       CONVERT STATISTICAL         @Z40NIVS 88224042
SUMTA2   LABEL ''                                              @Z40NIVS 88254042
         LINE  (1,6),(1,1),SKIP=1                              @Z427VLS 88284042
         ROUTINE TSTAT,EDTFA0      CYCLE THROUGH SUMREC        @Z40NIVS 88314042
         LABEL ''                                              @Z40NIVS 88344042
         LINE  ,(1,1),SKIP=2                                   @Z40NIVS 88374042
         ROUTINE SYMCD,FLTTST0                                 @Z40NIVS 88404042
         LABEL 'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXC88434042
               XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' 88464042
SUMTA5   LINE  (61,23),(1,19),SKIP=2                           @Z40NIVS 88494042
         ROUTINE TYPDEV,MOVDEV                                 @Z40NIVS 88524042
         HEX   YCPU,0,2B                                       @Z40NIVS 88554042
         HEX   YSER,0,3B                                       @Z40NIVS 88584042
         ROUTINE YCPU,SETCPUNO                                 @Z40NIVS 88614042
SUMTA6   LABEL 'FAULT SYMPTOM CODE ','SUMMARY   TYPE-OBR ',    @Z40NIVSC88644042
               ' SOURCE-OUTBOARD  D',                          @Z40RIVSC88674042
               'EVICE TYPE',' MODEL-','SERIAL NO.-'            @Z30RIVS 88704042
         LINE  (61,23),(1,19),SKIP=2                           @Z40NIVS 88734042
         ROUTINE YDUMA,SKIPPER                                 @Z40NIVS 88764042
SUMTAA   LABEL 'SEQUENCE BY SYMPTOM CODE'                      @Z40NIVS 88794042
         LINE  (1,1),(1,12),SKIP=1                             @Z427VLS 88824042
         ROUTINE YDUMA,SKIPPER                                 @Z40NIVS 88854042
         LABEL 'FAULT','UNIT   ','OCCURRENCES','  DATE/TIME ',,,       X88884042
               'SENSE FROM L','AST OCCURREN','CE'              @Z427VLS 88904042
         LINE  (1,1),(1,12),SKIP=1                             @Z427VLS 88924042
         ROUTINE YDUMA,SKIPPER                                 @Z40NIVS 88944042
         LABEL 'SYMPTOM','ADDRESS ',,'  LAST ENTRY','           0',    X88974042
               ' 0 0 0 0 0 0',' 0 0 0 1 1 1',' 1 1 1 1 1 1',   @Z427VLSX88984042
               ' 1 2 2 2 2'                                    @Z427VLS 88994042
         LINE  ,,SKIP=1                                        @Z427VLS 89004042
         ROUTINE SYMCD,FLTSRT0                                 @Z40NIVS 89034042
SUMMAD1  LABEL 'CODE','PHYSICAL    ',,,'           0',' 1 2 3 4 5 6',  X89064042
               ' 7 8 9 0 1 2',' 3 4 5 6 7 8',' 9 0 1 2 3'      @Z427VLS 89084042
SUMTA7   LINE  (1,12)                                          @Z427VLS 89104042
         HEX   SYMCD,0,2B                                      @Z40NIVS 89124042
         HEX   SYMCUA,0,,2B                                    @Z40NIVS 89154042
         ROUTINE SYMOCR,GETOCCUR                               @Z40NIVS 89184042
         ROUTINE SYMDAY,FLTSYDA                                @Z40NIVS 89214042
         HEX   SYMHR,0,4B          CONVERT TIME                @Z40NIVS 89244042
         ROUTINE YDUMA,HREDIT0     REFORMAT TIME FIELD         @Z40NIVS 89274042
         HEX   SYMSNS0,0,6B                                    @Z427VLS 89280042
         HEX   SYMSNS1,0,6B                                    @Z427VLS 89286042
         HEX   SYMSNS2,0,6B                                    @Z427VLS 89292042
         HEX   SYMSNS3,0,6B                                    @Z427VLS 89298042
SUMTA8   LABEL ''                                              @Z40NIVS 89304042
         LINE  (1,12)                                          @Z427VLS 89334042
         ROUTINE SYMCD,FLTMOV0                                 @Z40NIVS 89364042
         LABEL ''                                              @Z40NIVS 89394042
         LINE  ,(1,1)                                          @Z40NIVS 89424042
         ROUTINE YDUMA,SKIPPER                                 @Z40NIVS 89454042
         LABEL 'NOTE:  IF SYMPTOM CODE IS 0 REFER TO DETAIL OBR RECORD' 89484042
SUMTAC   LINE  ,(1,1),SKIP=2                                   @Z40NIVS 89514042
         ROUTINE   YDUMA,SKIPPER                                        90306042
SUMTAD   LABEL 'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXC90364042
               XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' 90422042
         LINE  (75,7),(1,63)                                   @Z40NIVS 90480042
         ROUTINE   TYPDEV,MOVDEV                                XL03145 90530042
         ROUTINE TVOLID1,SETUP0                                @Z40NIVS 90596042
         ROUTINE TVOLID1,SORTV0                                @Z40NIVS 90606042
         LABEL 'SUMMARY OF I/O STATISTICAL RECORDS BY VOLUME ID','DEVICC90616042
               E TYPE'                                          XL03145 90654042
         LINE  (1,10),,SKIP=2                                  @Z40NIVS 90712042
         HEX   TVCUA,0,2B                                      @Z40NIVS 90762042
         ROUTINE YDUMA,CUAN0                                   @Z40NIVS 90812042
         LABEL ''                                              @Z40NIVS 90862042
         LINE  ,(2,13),SKIP=1                                           90944042
         ROUTINE   YDUMA,SKIPPER                                        91002042
         LABEL 'VOLUME ID','UNIT    ','TOTAL','SEEK','TOTAL',  @Z40RIVSC91012042
               'RETRY','MEGABYTES',                            @Z40NIVSC91022042
               'CORRECTABLE','MEGABYTES'                       @Z40NIVS 91032042
         LINE                                                           91176042
         ROUTINE   YDUMA,SKIPPER                                        91234042
         LABEL ,'ADDRESS','ACCESSES','ACCESS','MEGABYTES',     @Z40NIVSC91292042
               'READ','READ/RETRY',                            @Z40NIVSC91322042
               'READ','READ/CORR'                              @Z40NIVS 91352042
         LINE  ,,SKIP=2                                                 91408042
         ROUTINE   YDUMA,SKIPPER                                        91466042
SUMMAD2  LABEL ,'PHYSICAL   ','X1024','ERRORS','READ','ERRORS',        C91524042
               'ERRORS','ERRORS','ERRORS'                      @Z40RIVS 91544042
*                                                                       91582042
SUMTA3   LINE  (3,13),(1,1),SKIP=1                             @Z40NIVS 91640042
         ROUTINE   TVOLID1,PRVOLS                                       91698042
SUMTA4   LABEL ''                                              @Z40NIVS 91756042
         LINE                                                           94250042
         ROUTINE TVOLID1,CNTDN0                                @Z40NIVS 94308042
          LABEL ' '                                                     94366042
         LINE  ,,SKIP=2                                        @Z40NIVS 94424042
         ROUTINE   YDUMA,SKIPPER                                        95352042
         LABEL ' '                                                      95410042
         LINE  (29,13),(3,1),SKIP=2                            @Z40NIVS 95468042
         ROUTINE   YDUMA,GETTOTS                                        95526042
         LABEL 'TOTALS'                                                 95584042
*                                                                       95642042
         LINE  ,(2,29),SKIP=1                                    Y01124 95700042
         ROUTINE   YDUMA,SKIPPER                                        95758042
         LABEL 'TOTAL OVERRUNS  CHNL A','TOTAL OVERRUNS CHNL  B','TOTALC95816042
                OVERRUNS  CHNL C','TOTAL OVERRUNS  CHNL D'       Y01124 95846042
         LINE  (21,29),(12,29)                                   Y01124 95876042
         ROUTINE TOCACA,GETABCDD                                        95932042
         LABEL 'COMMAND','COMMAND','COMMAND','COMMAND'           Y01124 95982042
         LINE  ,,SKIP=2                                        @Z40NIVS 96048042
         ROUTINE   TOCADA,GETABCDD                               Y01124 96106042
         LABEL 'DATA','DATA','DATA','DATA'                       Y01124 96156042
         LINE  ,,SKIP=2                                        @Z40NIVS 96222042
         ROUTINE YDUMA,SKIPPER                                 @Z40NIVS 96228042
         LABEL ''                                              @Z40NIVS 96234042
         LINE  ,(1,1),SKIP=1                                   @Z40NIVS 96240042
         ROUTINE YDUMA,SKIPPER                                 @Z40NIVS 96246042
         LABEL 'NOTE:  VOLUME ID''S ARE LISTED IN ERROR RATE SEQUENCE SX96252042
               TARTING WITH THE ONE WITH HIGHEST % OF RETRY READ ERRORSX96258042
               '                                               @Z40NIVS 96264042
         LINE  ,(1,1),SKIP=1                                   @Z40NIVS 96270042
         ROUTINE YDUMA,SKIPPER                                 @Z40NIVS 96276042
         LABEL 'NOTE:  ZEROS IN MEGABYTES READ/XXXX ERROR COLUMNS INDICC96282042
               ATE THAT THERE WAS LESS THAN ONE MEGABYTE READ PER ERRORC96288042
               '                                               @Z40NIVS 96294042
         LINE  ,,SKIP=2                                        @Z40NIVS 96300042
         ROUTINE YDUMA,SKIPPER                                 @Z40NIVS 96306042
         LABEL 'NOTE:  N/A IS AN INDICATION OF EITHER NO RETRY READ ERRX96312042
               ORS OR CORRECTABLE READ ERRORS IN THE RESPECTIVE COUNTERX96318042
               S '                                             @Z40NIVS 96324042
         LINE  ,(1,1),SKIP=2                                   @Z40NIVS 96330042
         ROUTINE YDUMA,SKIPPER                                 @Z40NIVS 96336042
         LABEL 'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXC96342042
               XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX' 96348042
         LINE  ,(1,1)                                          @Z40NIVS 96354042
         ROUTINE YDUMA,THEEND                                  @Z40NIVS 96360042
         LABEL ' '                                             @Z40NIVS 96366042
         DC    X'FF'                                                    96396042
         DC    XL2'0000'                                                96454042
         DC    XL2'0018'                                                96512042
         DC    XL2'0000'                                                96570042
*                                                                       96628042
         DC    C'$'                                                     96686042
LABELS   EQU   *                                                        96744042
         LSTART                                                         96802042
         END                                                            96860042
