         TITLE 'IFCTREND - SYSTEM SUMMARY FOR EREP PROCESSING'          00001000
IFCTREND CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'IFCTREND  79.011'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  ST    @14,12(,@13)                                        0001 00009000
         STM   @00,@12,20(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  LA    @11,4095(,@12)                                      0001 00012000
         LA    @10,4095(,@11)                                      0001 00013000
         USING @PSTART,@12                                         0001 00014000
         USING @PSTART+4095,@11                                    0001 00015000
         USING @PSTART+8190,@10                                    0001 00016000
         ST    @13,@SA00001+4                                      0001 00017000
         LA    @14,@SA00001                                        0001 00018000
         ST    @14,8(,@13)                                         0001 00019000
         LR    @13,@14                                             0001 00020000
*/********************************************************************/ 00021000
*/*                                                          @Z427VLS*/ 00022000
*/* THIS IS THE ROOT SEGMENT.                                @Z427VLS*/ 00023000
*/* IT EXECUTES THE PROCS WHICH PRINT PARTS 1 AND 2 OF THE TREND     */ 00024000
*/* REPORT.                                                  @Z427VLS*/ 00025000
*/*                                                          @Z427VLS*/ 00026000
*/* PART 1 - THE TRENDONE TABLE PROVIDES CPU ERROR DATA TO PRODUCE   */ 00027000
*/*          A SYSTEM OVERVIEW BY DAY, BY CPU.               @Z427VLS*/ 00028000
*/*                                                          @Z427VLS*/ 00029000
*  IF DEBUG4 = ON THEN       /*PRINT THE NAME AND THE COMPILE DATE   */ 00030000
         TM    DEBUG4(R2),B'00001000'                              0123 00031000
         BNO   @RF00123                                            0123 00032000
*   DO;                                                    /*@Z427VLS*/ 00033000
*R15 = R12 -27;                                            /*@0099VLS*/ 00034000
         LR    R15,R12                                             0125 00035000
         SL    R15,@CF00680                                        0125 00036000
*    DDTYPE = '1';                                         /*@Z427VLS*/ 00037000
         MVI   DDTYPE,C'1'                                         0126 00038000
*    GEN(MVC  PRTLINE(16),0(R15));                         /*@Z427VLS*/ 00039000
         MVC  PRTLINE(16),0(R15)                                        00040000
*    CALL PRINT2;                                          /*@Z427VLS*/ 00041000
         BAL   @14,PRINT2                                          0128 00042000
*    DDTYPE = '0';                                         /*@Z427VLS*/ 00043000
         MVI   DDTYPE,C'0'                                         0129 00044000
*   END;                                                   /*@Z427VLS*/ 00045000
*  IF DEBUG21 = ON THEN                                            0131 00046000
@RF00123 TM    DEBUG21(R2),B'00000100'                             0131 00047000
         BNO   @RF00131                                            0131 00048000
*   CALL HEXDUMP;                                          /*@Z427VLS*/ 00049000
         BAL   @14,HEXDUMP                                         0132 00050000
*  CALL HEADING1;            /* PRINT REPORT HEADING.        @Z427VLS*/ 00051000
@RF00131 BAL   @14,HEADING1                                        0133 00052000
*  CALL HEADING2;            /* PRINT DAY HEADING.           @Z427VLS*/ 00053000
         BAL   @14,HEADING2                                        0134 00054000
*  MYLINECT = FOUR;              /* LINECT AFTER HEADER      @ZA26429*/ 00055000
         MVC   MYLINECT(4),@CF00063                                0135 00056000
*  CALL CPUERREC;            /* PRINT ERROR COUNTS.          @Z427VLS*/ 00057000
         BAL   @14,CPUERREC                                        0136 00058000
*  CALL CPUMODSN;            /* PRINT CPU, MODEL, SERIAL NO. LIST.   */ 00059000
         BAL   @14,CPUMODSN                                        0137 00060000
*                            /* FREE TRENDONE STORAGE        @Z427VLS*/ 00061000
*/* PART 2 - THE TREND2 TABLE PROVIDES I/O SUBSYSTEM ERROR DATA TO   */ 00062000
*/*          PRODUCE A SUBSYSTEM SUMMARY BY DAY, BY CUA.     @Z427VLS*/ 00063000
*/*                                                          @Z427VLS*/ 00064000
*  IF SORTNUM ^= ZERO & DEBUG51 ^= ON THEN                         0138 00065000
         L     @03,SORTNUM(,R2)                                    0138 00066000
         LTR   @03,@03                                             0138 00067000
         BZ    @RF00138                                            0138 00068000
         TM    DEBUG51(R2),B'00010000'                             0138 00069000
         BO    @RF00138                                            0138 00070000
*    DO;                                                   /*@Z427VLS*/ 00071000
*      CALL INITPRT2;        /* INITIALIZE REPORT HEADING,PARAMETERS.*/ 00072000
         BAL   @14,INITPRT2                                        0140 00073000
*      CALL HEADING1;        /* PRINT REPORT HEADING.        @Z427VLS*/ 00074000
         BAL   @14,HEADING1                                        0141 00075000
*      CALL HEADING2;        /* PRINT DAY HEADING.           @Z427VLS*/ 00076000
         BAL   @14,HEADING2                                        0142 00077000
*      MYLINECT = FOUR;          /* LINECT AFTER HEADER      @ZA26429*/ 00078000
         MVC   MYLINECT(4),@CF00063                                0143 00079000
*      CALL CUAERREC;        /* SUMMARIZE ERROR COUNTS, PRINT.       */ 00080000
         BAL   @14,CUAERREC                                        0144 00081000
*      CALL CPUMODSN;        /* PRINT CPU, MODEL, SERIAL NO. LIST.   */ 00082000
         BAL   @14,CPUMODSN                                        0145 00083000
*    END;                                                  /*@Z427VLS*/ 00084000
*  IF DEBUG12 = ON THEN                                            0147 00085000
@RF00138 TM    DEBUG12(R2),B'00001000'                             0147 00086000
         BNO   @RF00147                                            0147 00087000
*    GEN(ABEND 340,DUMP);                                  /*@Z427VLS*/ 00088000
         ABEND 340,DUMP                                                 00089000
*  RESPECIFY (R15) RESTRICTED;                             /*@Z427VLS*/ 00090000
@RF00147 DS    0H                                                  0150 00091000
*  R15 = RETCODE;            /* NORMAL RETURN                @Z427VLS*/ 00092000
         LH    R15,RETCODE                                         0150 00093000
*  RESPECIFY (R15) UNRESTRICTED;                           /*@Z427VLS*/ 00094000
*  RETURN;                                                 /*@Z427VLS*/ 00095000
@EL00001 L     @13,4(,@13)                                         0152 00096000
@EF00001 DS    0H                                                  0152 00097000
@ER00001 L     @14,12(,@13)                                        0152 00098000
         LM    @00,@12,20(@13)                                     0152 00099000
         BR    @14                                                 0152 00100000
*/********************************************************************/ 00101000
*/*                                                          @Z427VLS*/ 00102000
*/* THIS PROC PRINTS THE REPORT HEADING FOR PARTS 1 AND 2.   @Z427VLS*/ 00103000
*/*                                                          @Z427VLS*/ 00104000
*HEADING1:  PROC;                                          /*@Z427VLS*/ 00105000
HEADING1 STM   @14,@12,@SA00002                                    0153 00106000
*  CALL PRINT2;              /* PRINT BLANK LINE - SKIP TO NEW PAGE  */ 00107000
         BAL   @14,PRINT2                                          0154 00108000
*  SPACING = SINGLE;                                       /*@Z427VLS*/ 00109000
         MVI   SPACING,X'09'                                       0155 00110000
*  LNESPACE = ONE;                                         /*@Z427VLS*/ 00111000
         MVC   LNESPACE(4),@CF00054                                0156 00112000
*  DAYSDATE = DATENOW;       /* MOVE REPORT DATE TO PRINT LINE       */ 00113000
         MVC   DAYSDATE(6),DATENOW(R2)                             0157 00114000
*  HEADMOVE = LINE1;         /* MOVE LINE 1 OF HEADING TO PRINT AREA */ 00115000
         MVC   HEADMOVE(57),LINE1                                  0158 00116000
*  CALL PRINT2;              /* PRINT HEADING - 1ST LINE  - NEW PAGE */ 00117000
         BAL   @14,PRINT2                                          0159 00118000
*  NUMBER = TWO;             /* TWO BYTES TO BE CONVERTED    @Z427VLS*/ 00119000
         MVC   NUMBER(4),@CF00073                                  0160 00120000
*  SAVEDAY = EVSDAY;                                       /*@Z427VLS*/ 00121000
         MVC   SAVEDAY(2),EVSDAY(R2)                               0161 00122000
*  SRL (SAVEDAY,FOUR);       /* REMOVE SIGN                  @Z427VLS*/ 00123000
         SLR   @03,@03                                             0162 00124000
         ICM   @03,3,SAVEDAY                                       0162 00125000
         SRL   @03,4                                               0162 00126000
         STCM  @03,3,SAVEDAY                                       0162 00127000
*  NEXTBY = ADDR(SAVEDAY);   /* DATA SOURCE                  @Z427VLS*/ 00128000
         LA    @03,SAVEDAY                                         0163 00129000
         ST    @03,NEXTBY                                          0163 00130000
*  ADDNXT = ADDR(FROMDATE)-1;/* DATA DESTINATION - 2ND PRINT LINE    */ 00131000
         LA    @03,FROMDATE                                        0164 00132000
         BCTR  @03,0                                               0164 00133000
         ST    @03,ADDNXT                                          0164 00134000
*  SWITCH1 = ON;             /* DON'T CONVERT LEFT-MOST HALF BYTE    */ 00135000
         OI    SWITCH1,B'00001000'                                 0165 00136000
*  CALL CONVERT;             /* CONVERT 'PERIOD FROM' DAY TO EBCDIC  */ 00137000
         BAL   @14,CONVERT                                         0166 00138000
*  NUMBER = ONE;             /* ONE BYTE TO BE CONVERTED     @Z427VLS*/ 00139000
         MVC   NUMBER(4),@CF00054                                  0167 00140000
*  NEXTBY = ADDR(EVSYEAR);   /* DATA SOURCE - PARM TABLE     @Z427VLS*/ 00141000
         LA    @03,EVSYEAR(,R2)                                    0168 00142000
         ST    @03,NEXTBY                                          0168 00143000
*  ADDNXT = ADDR(FROMYEAR);  /* DATA DESTINATION - 2ND PRINT LINE    */ 00144000
         LA    @03,FROMYEAR                                        0169 00145000
         ST    @03,ADDNXT                                          0169 00146000
*  CALL CONVERT;             /* CONVERT 'PERIOD FROM' YEAR TO EBCDIC */ 00147000
         BAL   @14,CONVERT                                         0170 00148000
*  HEADMOVE = LINE2;         /* MOVE LINE 2 OF HEADING TO PRINT AREA */ 00149000
         MVC   HEADMOVE(57),LINE2                                  0171 00150000
*  CALL PRINT2;              /* PRINT HEADING - 2ND LINE     @Z427VLS*/ 00151000
         BAL   @14,PRINT2                                          0172 00152000
*  NUMBER = TWO;             /* TWO BYTES TO BE CONVERTED    @Z427VLS*/ 00153000
         MVC   NUMBER(4),@CF00073                                  0173 00154000
*  SAVEDAY = EVDAY;                                        /*@Z427VLS*/ 00155000
         L     @03,EVPTR(,R2)                                      0174 00156000
         MVC   SAVEDAY(2),EVDAY(@03)                               0174 00157000
*  SRL (SAVEDAY,FOUR);       /* REMOVE SIGN                  @Z427VLS*/ 00158000
         SLR   @03,@03                                             0175 00159000
         ICM   @03,3,SAVEDAY                                       0175 00160000
         SRL   @03,4                                               0175 00161000
         STCM  @03,3,SAVEDAY                                       0175 00162000
*  NEXTBY = ADDR(SAVEDAY);   /* DATA SOURCE                  @Z427VLS*/ 00163000
         LA    @03,SAVEDAY                                         0176 00164000
         ST    @03,NEXTBY                                          0176 00165000
*  ADDNXT = ADDR(TODATE)-1;  /* DATA DESTINATION - 3RD PRINT LINE    */ 00166000
         LA    @03,TODATE                                          0177 00167000
         BCTR  @03,0                                               0177 00168000
         ST    @03,ADDNXT                                          0177 00169000
*  SWITCH1 = ON;             /* DON'T CONVERT LEFT-MOST HALF BYTE    */ 00170000
         OI    SWITCH1,B'00001000'                                 0178 00171000
*  CALL CONVERT;             /* CONVERT 'PERIOD TO' DAY TO EBCDIC    */ 00172000
         BAL   @14,CONVERT                                         0179 00173000
*  NUMBER = ONE;             /* ONE BYTE TO BE CONVERTED     @Z427VLS*/ 00174000
         MVC   NUMBER(4),@CF00054                                  0180 00175000
*  NEXTBY = ADDR(EVYEAR);    /* DATA SOURCE - PARM TABLE     @Z427VLS*/ 00176000
         L     @03,EVPTR(,R2)                                      0181 00177000
         ST    @03,NEXTBY                                          0181 00178000
*  ADDNXT = ADDR(TOYEAR);    /* DATA DESTINATION - 3RD PRINT LINE    */ 00179000
         LA    @03,TOYEAR                                          0182 00180000
         ST    @03,ADDNXT                                          0182 00181000
*  CALL CONVERT;             /* CONVERT 'PERIOD TO' YEAR TO EBCDIC   */ 00182000
         BAL   @14,CONVERT                                         0183 00183000
*  HEADMOVE = LINE3;         /* MOVE LINE 3 OF HEADING TO PRINT AREA */ 00184000
         MVC   HEADMOVE(57),LINE3                                  0184 00185000
*  CALL PRINT2;              /* PRINT HEADING - 3RD LINE     @Z427VLS*/ 00186000
         BAL   @14,PRINT2                                          0185 00187000
*END;                                                      /*@Z427VLS*/ 00188000
@EL00002 DS    0H                                                  0186 00189000
@EF00002 DS    0H                                                  0186 00190000
@ER00002 LM    @14,@12,@SA00002                                    0186 00191000
         BR    @14                                                 0186 00192000
*/********************************************************************/ 00193000
*/*                                                          @Z427VLS*/ 00194000
*/* THIS PROC PRINTS THE DAY HEADING FOR PARTS 1 AND 2.      @Z427VLS*/ 00195000
*/*                                                          @Z427VLS*/ 00196000
*HEADING2:  PROC;                                          /*@Z427VLS*/ 00197000
HEADING2 STM   @14,@12,@SA00003                                    0187 00198000
*  CALL PRINT2;              /* PRINT BLANK LINE             @Z427VLS*/ 00199000
         BAL   @14,PRINT2                                          0188 00200000
*  NUMBER = ONE;             /* ONE BYTE TO BE CONVERTED     @Z427VLS*/ 00201000
         MVC   NUMBER(4),@CF00054                                  0189 00202000
*  NEXTBY = ADDR(PSTYR);     /* DATA SOURCE - PARM TABLE     @Z427VLS*/ 00203000
         LA    @03,PSTYR(,R2)                                      0190 00204000
         ST    @03,NEXTBY                                          0190 00205000
*  ADDNXT = ADDR(JYEAR);     /* DATA DESTINATION - 1ST PRINT LINE    */ 00206000
         LA    @03,JYEAR                                           0191 00207000
         ST    @03,ADDNXT                                          0191 00208000
*  CALL CONVERT;             /* CONVERT 'PERIOD FROM' YEAR TO EBCDIC */ 00209000
         BAL   @14,CONVERT                                         0192 00210000
*                            /*                              @Z427VLS*/ 00211000
*                            /* CONVERT STARTING DAY FROM HEX PLUS   */ 00212000
*                            /* SIGN(PACKED) TO BINARY TO COMPUTE    */ 00213000
*                            /* SUCCESSIVE DAYS FOR LINE 2 OF HEADING*/ 00214000
*                            /* THEN, CONVERT DAYS TO EBCDIC AND     */ 00215000
*                            /* FILL IN PRINT LINE           @Z427VLS*/ 00216000
*  CVB  (BINWORD,PSTDY);    /* - BINWORD - INPUT TO 'CONVBIN'       */  00217000
         XC    @TS00001(8),@TS00001                                0193 00218000
         MVC   @TS00001+6(2),PSTDY(R2)                             0193 00219000
         CVB   @03,@TS00001                                        0193 00220000
         ST    @03,BINWORD                                         0193 00221000
*  DO M = 1 TO NUMDAYS;                                    /*@Z427VLS*/ 00222000
         LA    @03,1                                               0194 00223000
         B     @DE00194                                            0194 00224000
@DL00194 DS    0H                                                  0195 00225000
*    DECADDR = ADDR(DAYNO(M))+1;  /* POINT TO DAY SLOT IN PRINT LINE */ 00226000
         SLA   @03,2                                               0195 00227000
         LA    @03,DAYNO-4(@03)                                    0195 00228000
         AL    @03,@CF00054                                        0195 00229000
         ST    @03,DECADDR                                         0195 00230000
*    CALL CONVBIN;                /* CONVERT DAY TO EBCDIC   @Z427VLS*/ 00231000
         BAL   @14,CONVBIN                                         0196 00232000
*    IF BINWORD = 365 THEN                                         0197 00233000
         CLC   BINWORD(4),@CF00701                                 0197 00234000
         BNE   @RF00197                                            0197 00235000
*      DO;                                                 /*@Z427VLS*/ 00236000
*        SAVEYR(2) = EVSYEAR;                              /*@Z427VLS*/ 00237000
         MVC   SAVEYR+1(1),EVSYEAR(R2)                             0199 00238000
*        SLL (SAVEYR,FOUR);                                /*@Z427VLS*/ 00239000
         SLR   @03,@03                                             0200 00240000
         ICM   @03,3,SAVEYR                                        0200 00241000
         SLL   @03,4                                               0200 00242000
         STCM  @03,3,SAVEYR                                        0200 00243000
*        SAVEYR(2) = SAVEYR(2) | SIGNPLUS;                 /*@Z427VLS*/ 00244000
         OI    SAVEYR+1,X'0F'                                      0201 00245000
*        CVB (BINYR,SAVEYR);                               /*@Z427VLS*/ 00246000
         XC    @TS00001(8),@TS00001                                0202 00247000
         MVC   @TS00001+6(2),SAVEYR                                0202 00248000
         CVB   @03,@TS00001                                        0202 00249000
         ST    @03,BINYR                                           0202 00250000
*        IF (BINYR/4 * 4) ^= BINYR THEN                            0203 00251000
         LR    @00,@03                                             0203 00252000
         SRDA  @00,32                                              0203 00253000
         D     @00,@CF00063                                        0203 00254000
         SLA   @01,2                                               0203 00255000
         CR    @01,@03                                             0203 00256000
         BE    @RF00203                                            0203 00257000
*          BINWORD = ZERO;        /* NORMAL YEAR             @Z427VLS*/ 00258000
         SLR   @03,@03                                             0204 00259000
         ST    @03,BINWORD                                         0204 00260000
*      END;                                                /*@Z427VLS*/ 00261000
*    ELSE                                                          0206 00262000
*      DO;                                                 /*@Z427VLS*/ 00263000
         B     @RC00197                                            0206 00264000
@RF00197 DS    0H                                                  0207 00265000
*        IF BINWORD = 366 THEN                                     0207 00266000
         CLC   BINWORD(4),@CF00703                                 0207 00267000
         BNE   @RF00207                                            0207 00268000
*          BINWORD = ZERO;        /* RESET DAY TALLY         @Z427VLS*/ 00269000
         SLR   @03,@03                                             0208 00270000
         ST    @03,BINWORD                                         0208 00271000
*      END;                                                /*@Z427VLS*/ 00272000
@RF00207 DS    0H                                                  0210 00273000
*      IF BINWORD = ZERO THEN     /*GOT TO MOVE IN ANOTHER YEAR LABEL*/ 00274000
@RC00197 L     @03,BINWORD                                         0210 00275000
         LTR   @03,@03                                             0210 00276000
         BNZ   @RF00210                                            0210 00277000
*       DO;                                                /*@Z427VLS*/ 00278000
*        NUMBER = ONE;                                     /*@Z427VLS*/ 00279000
         MVC   NUMBER(4),@CF00054                                  0212 00280000
*        NEXTBY = ADDR(PENYR);/* PICK UP NEXT YEAR           @Z427VLS*/ 00281000
         LA    @03,PENYR(,R2)                                      0213 00282000
         ST    @03,NEXTBY                                          0213 00283000
*        ADDNXT =(DECADDR + 5 - ADDR(DAYNO))+ (ADDR(LN1) + EIGHT); 0214 00284000
         LA    @03,5                                               0214 00285000
         AL    @03,DECADDR                                         0214 00286000
         LA    @15,DAYNO                                           0214 00287000
         SLR   @03,@15                                             0214 00288000
         LA    @15,LN1                                             0214 00289000
         AL    @15,@CF00065                                        0214 00290000
         ALR   @03,@15                                             0214 00291000
         ST    @03,ADDNXT                                          0214 00292000
*        CALL  CONVERT;      /* GO CONVERT TO PRINT          @Z427VLS*/ 00293000
         BAL   @14,CONVERT                                         0215 00294000
*       END;                                               /*@Z427VLS*/ 00295000
*      BINWORD = BINWORD + ONE;   /* SET NEXT DAY            @Z427VLS*/ 00296000
@RF00210 LA    @03,1                                               0217 00297000
         AL    @03,BINWORD                                         0217 00298000
         ST    @03,BINWORD                                         0217 00299000
*  END;                                                    /*@Z427VLS*/ 00300000
         LA    @03,1                                               0218 00301000
         AL    @03,M                                               0218 00302000
@DE00194 ST    @03,M                                               0218 00303000
         C     @03,NUMDAYS(,R2)                                    0218 00304000
         BNH   @DL00194                                            0218 00305000
*  HD2MOVE = LN1;            /* MOVE YEAR HEADING LINE TO PRINT AREA */ 00306000
         MVC   HD2MOVE(128),LN1                                    0219 00307000
*  CALL PRINT2;              /* PRINT YEAR HEADING           @Z427VLS*/ 00308000
         BAL   @14,PRINT2                                          0220 00309000
*  HD2MOVE = LN2;            /* MOVE DAY HEADING LINE TO PRINT AREA  */ 00310000
         MVC   HD2MOVE(128),LN2                                    0221 00311000
*  CALL PRINT2;              /* PRINT DAY HEADING            @Z427VLS*/ 00312000
         BAL   @14,PRINT2                                          0222 00313000
*  CALL PRINT2;              /* BLANK LINE                   @Z427VLS*/ 00314000
         BAL   @14,PRINT2                                          0223 00315000
*END;                                                      /*@Z427VLS*/ 00316000
@EL00003 DS    0H                                                  0224 00317000
@EF00003 DS    0H                                                  0224 00318000
@ER00003 LM    @14,@12,@SA00003                                    0224 00319000
         BR    @14                                                 0224 00320000
*HEXDUMP: PROC;                                            /*@Z427VLS*/ 00321000
HEXDUMP  STM   @14,@12,@SA00004                                    0225 00322000
*DCL BYTECT FIXED(31) INIT(0);                             /*@Z427VLS*/ 00323000
*SAVEPTR = TRENPTR;                                        /*@Z427VLS*/ 00324000
         L     @03,TRENPTR(,R2)                                    0227 00325000
         ST    @03,SAVEPTR                                         0227 00326000
*DDTYPE = '1';                                             /*@Z427VLS*/ 00327000
         MVI   DDTYPE,C'1'                                         0228 00328000
*BYTECT =(76 * NUMDAYS) + EIGHT;                           /*@0099VLS*/ 00329000
         L     @03,NUMDAYS(,R2)                                    0229 00330000
         MH    @03,@CH00708                                        0229 00331000
         AL    @03,@CF00065                                        0229 00332000
         ST    @03,BYTECT                                          0229 00333000
*DO J = 1 BY 1 TO EVNUM;                                   /*@Z427VLS*/ 00334000
         LA    @03,1                                               0230 00335000
         ST    @03,J                                               0230 00336000
         B     @DE00230                                            0230 00337000
@DL00230 DS    0H                                                  0231 00338000
* NUMBER = 66;                                             /*@Z427VLS*/ 00339000
         LA    @03,66                                              0231 00340000
         ST    @03,NUMBER                                          0231 00341000
* ADDNXT =ADDR(PRTLINE);                                   /*@Z427VLS*/ 00342000
         LA    @15,PRTLINE                                         0232 00343000
         ST    @15,ADDNXT                                          0232 00344000
* NEXTBY = TRENPTR;                                        /*@Z427VLS*/ 00345000
         L     @15,TRENPTR(,R2)                                    0233 00346000
         ST    @15,NEXTBY                                          0233 00347000
* DO I = 66 BY 66 TO BYTECT;                               /*@0099VLS*/ 00348000
         ST    @03,I                                               0234 00349000
         B     @DE00234                                            0234 00350000
@DL00234 DS    0H                                                  0235 00351000
*  CALL CONVERT;                                           /*@Z427VLS*/ 00352000
         BAL   @14,CONVERT                                         0235 00353000
*  NEXTBY = NEXTBY + 66;                                   /*@Z427VLS*/ 00354000
         LA    @03,66                                              0236 00355000
         AL    @03,NEXTBY                                          0236 00356000
         ST    @03,NEXTBY                                          0236 00357000
*  CALL PRINT2;                                            /*@Z427VLS*/ 00358000
         BAL   @14,PRINT2                                          0237 00359000
* END;                                                     /*@Z427VLS*/ 00360000
         LA    @03,66                                              0238 00361000
         AL    @03,I                                               0238 00362000
         ST    @03,I                                               0238 00363000
@DE00234 C     @03,BYTECT                                          0238 00364000
         BNH   @DL00234                                            0238 00365000
* IF NUMBER = BYTECT -(J - 66) THEN                                0239 00366000
         LA    @03,66                                              0239 00367000
         SL    @03,J                                               0239 00368000
         AL    @03,BYTECT                                          0239 00369000
         C     @03,NUMBER                                          0239 00370000
         BNE   @RF00239                                            0239 00371000
*  DO;                                                     /*@Z427VLS*/ 00372000
*   CALL CONVERT;                                          /*@Z427VLS*/ 00373000
         BAL   @14,CONVERT                                         0241 00374000
*   CALL PRINT2;                                           /*@Z427VLS*/ 00375000
         BAL   @14,PRINT2                                          0242 00376000
*  END;                                                    /*@Z427VLS*/ 00377000
* TRENPTR = TRENEXT;                                       /*@Z427VLS*/ 00378000
@RF00239 L     @03,TRENPTR(,R2)                                    0244 00379000
         L     @03,TRENEXT(,@03)                                   0244 00380000
         ST    @03,TRENPTR(,R2)                                    0244 00381000
*END;                                                      /*@Z427VLS*/ 00382000
         LA    @03,1                                               0245 00383000
         AL    @03,J                                               0245 00384000
         ST    @03,J                                               0245 00385000
@DE00230 L     @01,EVPTR(,R2)                                      0245 00386000
         CH    @03,EVNUM(,@01)                                     0245 00387000
         BNH   @DL00230                                            0245 00388000
*TRENPTR = SAVEPTR;                                        /*@Z427VLS*/ 00389000
         L     @03,SAVEPTR                                         0246 00390000
         ST    @03,TRENPTR(,R2)                                    0246 00391000
*DDTYPE = '0';                                             /*@Z427VLS*/ 00392000
         MVI   DDTYPE,C'0'                                         0247 00393000
*J = ZERO;                                                 /*@Z427VLS*/ 00394000
         SLR   @03,@03                                             0248 00395000
         ST    @03,J                                               0248 00396000
*X = ZERO;                                                 /*@Z427VLS*/ 00397000
         ST    @03,X                                               0249 00398000
*END;                                                      /*@Z427VLS*/ 00399000
@EL00004 DS    0H                                                  0250 00400000
@EF00004 DS    0H                                                  0250 00401000
@ER00004 LM    @14,@12,@SA00004                                    0250 00402000
         BR    @14                                                 0250 00403000
*/********************************************************************/ 00404000
*/*                                                          @Z427VLS*/ 00405000
*/* THIS PROC PRINTS ERROR COUNTS BY DAY BY CPU BY TYPE OF CPU       */ 00406000
*/* ERROR  - I.E. - IPL, MACHINE CHECK, CHANNEL CHECK, PROGRAM ERROR */ 00407000
*/*                                                          @Z427VLS*/ 00408000
*CPUERREC:  PROC;                                          /*@Z427VLS*/ 00409000
CPUERREC STM   @14,@12,@SA00005                                    0251 00410000
*DCL TREND6(16,30) FIXED(31) INIT((480)0);                 /*@0099VLS*/ 00411000
*DCL 1 NEWSW BIT(8) INIT('00'X),                                   0253 00412000
*    2 FOUND BIT(1) ,                                              0253 00413000
*    2 OUTSWTCH BIT(1);                                    /*@0099VLS*/ 00414000
*DCL NOFOUND CHAR(29) INIT('NO ERRORS FOUND FOR THIS CPU');/*@0099VLS*/ 00415000
*DCL CHAN CHAR(4) INIT('CHAN');                            /*@0099VLS*/ 00416000
*DCL Z1 FIXED(31) INIT(0);                                 /*@0099VLS*/ 00417000
*DCL Q FIXED(31) INIT(0);                                  /*@0099VLS*/ 00418000
*DCL Z2 FIXED(31) INIT(0);                                 /*@0099VLS*/ 00419000
*DCL ZCPU CHAR(3) INIT('CPU');                             /*@0099VLS*/ 00420000
*DCL   CHANZ(16) CHAR(6)                                           0260 00421000
*   INIT(' CHN-0',                                                 0260 00422000
*        ' CHN-1',                                                 0260 00423000
*        ' CHN-2',                                                 0260 00424000
*        ' CHN-3',                                                 0260 00425000
*        ' CHN-4',                                                 0260 00426000
*        ' CHN-5',                                                 0260 00427000
*        ' CHN-6',                                                 0260 00428000
*        ' CHN-7',                                                 0260 00429000
*        ' CHN-8',                                                 0260 00430000
*        ' CHN-9',                                                 0260 00431000
*        ' CHN-A',                                                 0260 00432000
*        ' CHN-B',                                                 0260 00433000
*        ' CHN-C',                                                 0260 00434000
*        ' CHN-D',                                                 0260 00435000
*        ' CHN-E',                                                 0260 00436000
*        ' CHN-F');                                        /*@0099VLS*/ 00437000
*DCL CHANID CHAR(6) DEFINED(LIN2) POS(3);                  /*@0099VLS*/ 00438000
*  SAVEPTR = TRENPTR;        /* SAVE POINTER TO ERROR TABLE - 1ST CPU*/ 00439000
         L     @03,TRENPTR(,R2)                                    0262 00440000
         ST    @03,SAVEPTR                                         0262 00441000
*  DO I = 1 TO FOUR;         /* LOOP FOR 4 CPU ERROR TYPES   @Z427VLS*/ 00442000
         LA    @03,1                                               0263 00443000
         ST    @03,I                                               0263 00444000
@DL00263 DS    0H                                                  0264 00445000
*    CALL PRINT1;            /* PRINT BLANK LINE             @Z427VLS*/ 00446000
         BAL   @14,PRINT1                                          0264 00447000
*    DSCRPT = DESCRIPT(I);   /* MOVE ERROR TYPE TO HEADING LINE      */ 00448000
         MVI   DSCRPT+13,C' '                                      0265 00449000
         MVC   DSCRPT+14(3),DSCRPT+13                              0265 00450000
         L     @03,I                                               0265 00451000
         MH    @03,@CH00548                                        0265 00452000
         LA    @01,DESCRIPT-13(@03)                                0265 00453000
         MVC   DSCRPT(13),0(@01)                                   0265 00454000
*    HD3MOVE = LIN1;         /* MOVE PRINT LINE TO PRINT AREA        */ 00455000
         MVC   HD3MOVE(128),LIN1                                   0266 00456000
*    CALL PRINT1;            /* PRINT ERROR TYPE HEADING     @Z427VLS*/ 00457000
         BAL   @14,PRINT1                                          0267 00458000
*    NUMCPUS = EVNUM;        /* NUMBER OF CPU'S - LOOP CONTROL       */ 00459000
         L     @03,EVPTR(,R2)                                      0268 00460000
         LH    @03,EVNUM(,@03)                                     0268 00461000
         ST    @03,NUMCPUS                                         0268 00462000
*  IF I = 3 THEN                                                   0269 00463000
         CLC   I(4),@CF00075                                       0269 00464000
         BNE   @RF00269                                            0269 00465000
*   DO Q  = 1 BY 1 TO NUMCPUS;                             /*@0099VLS*/ 00466000
         LA    @03,1                                               0270 00467000
         ST    @03,Q                                               0270 00468000
         B     @DE00270                                            0270 00469000
@DL00270 DS    0H                                                  0271 00470000
*   FOUND = NO;                                            /*@0099VLS*/ 00471000
         NI    FOUND,B'01111111'                                   0271 00472000
*    DO J = 1 BY 1 TO NUMDAYS;                             /*@0099VLS*/ 00473000
         LA    @03,1                                               0272 00474000
         ST    @03,J                                               0272 00475000
         B     @DE00272                                            0272 00476000
@DL00272 DS    0H                                                  0273 00477000
*     TREND6(1,J) = TRECCH0(J);                            /*@0099VLS*/ 00478000
         LR    @15,@03                                             0273 00479000
         SLA   @15,2                                               0273 00480000
         LR    @14,@03                                             0273 00481000
         MH    @14,@CH00708                                        0273 00482000
         L     @09,TRENPTR(,R2)                                    0273 00483000
         LA    @01,0(@14,@09)                                      0273 00484000
         AL    @01,@CF00822                                        0273 00485000
         L     @08,TRECCH0-16(,@01)                                0273 00486000
         ST    @08,TREND6-4(@15)                                   0273 00487000
*     TREND6(2,J) = TRECCH1(J);                            /*@0099VLS*/ 00488000
         LA    @01,0(@14,@09)                                      0274 00489000
         AL    @01,@CF00823                                        0274 00490000
         L     @08,TRECCH1-20(,@01)                                0274 00491000
         ST    @08,TREND6+116(@15)                                 0274 00492000
*     TREND6(3,J) = TRECCH2(J);                            /*@0099VLS*/ 00493000
         LA    @01,0(@14,@09)                                      0275 00494000
         AL    @01,@CF00824                                        0275 00495000
         L     @08,TRECCH2-24(,@01)                                0275 00496000
         ST    @08,TREND6+236(@15)                                 0275 00497000
*     TREND6(4,J) = TRECCH3(J);                            /*@0099VLS*/ 00498000
         LA    @01,0(@14,@09)                                      0276 00499000
         AL    @01,@CF00825                                        0276 00500000
         L     @08,TRECCH3-28(,@01)                                0276 00501000
         ST    @08,TREND6+356(@15)                                 0276 00502000
*     TREND6(5,J) = TRECCH4(J);                            /*@0099VLS*/ 00503000
         LA    @01,0(@14,@09)                                      0277 00504000
         AL    @01,@CF00826                                        0277 00505000
         L     @08,TRECCH4-32(,@01)                                0277 00506000
         ST    @08,TREND6+476(@15)                                 0277 00507000
*     TREND6(6,J) = TRECCH5(J);                            /*@0099VLS*/ 00508000
         LA    @01,0(@14,@09)                                      0278 00509000
         AL    @01,@CF00827                                        0278 00510000
         L     @08,TRECCH5-36(,@01)                                0278 00511000
         ST    @08,TREND6+596(@15)                                 0278 00512000
*     TREND6(7,J) = TRECCH6(J);                            /*@0099VLS*/ 00513000
         LA    @01,0(@14,@09)                                      0279 00514000
         AL    @01,@CF00828                                        0279 00515000
         L     @08,TRECCH6-40(,@01)                                0279 00516000
         ST    @08,TREND6+716(@15)                                 0279 00517000
*     TREND6(8,J) = TRECCH7(J);                            /*@0099VLS*/ 00518000
         LA    @01,0(@14,@09)                                      0280 00519000
         AL    @01,@CF00829                                        0280 00520000
         L     @08,TRECCH7-44(,@01)                                0280 00521000
         ST    @08,TREND6+836(@15)                                 0280 00522000
*     TREND6(9,J) = TRECCH8(J);                            /*@0099VLS*/ 00523000
         LA    @01,0(@14,@09)                                      0281 00524000
         AL    @01,@CF00830                                        0281 00525000
         L     @08,TRECCH8-48(,@01)                                0281 00526000
         ST    @08,TREND6+956(@15)                                 0281 00527000
*     TREND6(10,J) = TRECCH9(J);                           /*@0099VLS*/ 00528000
         LA    @01,0(@14,@09)                                      0282 00529000
         AL    @01,@CF00831                                        0282 00530000
         L     @08,TRECCH9-52(,@01)                                0282 00531000
         ST    @08,TREND6+1076(@15)                                0282 00532000
*     TREND6(11,J) = TRECCHA(J);                           /*@0099VLS*/ 00533000
         LA    @01,0(@14,@09)                                      0283 00534000
         AL    @01,@CF00832                                        0283 00535000
         L     @08,TRECCHA-56(,@01)                                0283 00536000
         ST    @08,TREND6+1196(@15)                                0283 00537000
*     TREND6(12,J) = TRECCHB(J);                           /*@0099VLS*/ 00538000
         LA    @01,0(@14,@09)                                      0284 00539000
         AL    @01,@CF00833                                        0284 00540000
         L     @08,TRECCHB-60(,@01)                                0284 00541000
         ST    @08,TREND6+1316(@15)                                0284 00542000
*     TREND6(13,J) = TRECCHC(J);                           /*@0099VLS*/ 00543000
         LA    @01,0(@14,@09)                                      0285 00544000
         AL    @01,@CF00834                                        0285 00545000
         L     @08,TRECCHC-64(,@01)                                0285 00546000
         ST    @08,TREND6+1436(@15)                                0285 00547000
*     TREND6(14,J) = TRECCHD(J);                           /*@0099VLS*/ 00548000
         LA    @01,0(@14,@09)                                      0286 00549000
         AL    @01,@CF00835                                        0286 00550000
         L     @08,TRECCHD-68(,@01)                                0286 00551000
         ST    @08,TREND6+1556(@15)                                0286 00552000
*     TREND6(15,J) = TRECCHE(J);                           /*@0099VLS*/ 00553000
         LA    @01,0(@14,@09)                                      0287 00554000
         AL    @01,@CF00836                                        0287 00555000
         L     @08,TRECCHE-72(,@01)                                0287 00556000
         ST    @08,TREND6+1676(@15)                                0287 00557000
*     TREND6(16,J) = TRECCHF(J);                           /*@0099VLS*/ 00558000
         L     @14,TRECCHF-76(@14,@09)                             0288 00559000
         ST    @14,TREND6+1796(@15)                                0288 00560000
*    END;                                                  /*@0099VLS*/ 00561000
         AL    @03,@CF00054                                        0289 00562000
         ST    @03,J                                               0289 00563000
@DE00272 C     @03,NUMDAYS(,R2)                                    0289 00564000
         BNH   @DL00272                                            0289 00565000
*    DO Z1 = 1 BY 1 TO 16;                                 /*@0099VLS*/ 00566000
         LA    @03,1                                               0290 00567000
         ST    @03,Z1                                              0290 00568000
@DL00290 DS    0H                                                  0291 00569000
*    LIN2 = LIN2 && LIN2;                                  /*@0099VLS*/ 00570000
         XC    LIN2(128),LIN2                                      0291 00571000
*    OUTSWTCH = OFF;                                       /*@0099VLS*/ 00572000
         NI    OUTSWTCH,B'10111111'                                0292 00573000
*    DO Z2 = 1 BY  1 TO NUMDAYS WHILE(OUTSWTCH = OFF);     /*@0099VLS*/ 00574000
         LA    @03,1                                               0293 00575000
         ST    @03,Z2                                              0293 00576000
         B     @DE00293                                            0293 00577000
@DL00293 TM    OUTSWTCH,B'01000000'                                0293 00578000
         BNZ   @DC00293                                            0293 00579000
*     IF TREND6(Z1,Z2) ^= 0 THEN                                   0294 00580000
         L     @15,Z1                                              0294 00581000
         MH    @15,@CH00546                                        0294 00582000
         ALR   @15,@03                                             0294 00583000
         SLA   @15,2                                               0294 00584000
         L     @03,TREND6-124(@15)                                 0294 00585000
         LTR   @03,@03                                             0294 00586000
         BZ    @RF00294                                            0294 00587000
*      OUTSWTCH = ON;                                      /*@0099VLS*/ 00588000
         OI    OUTSWTCH,B'01000000'                                0295 00589000
*    END;                                                  /*@0099VLS*/ 00590000
@RF00294 LA    @03,1                                               0296 00591000
         AL    @03,Z2                                              0296 00592000
         ST    @03,Z2                                              0296 00593000
@DE00293 C     @03,NUMDAYS(,R2)                                    0296 00594000
         BNH   @DL00293                                            0296 00595000
@DC00293 DS    0H                                                  0297 00596000
*    IF OUTSWTCH = ON THEN                                         0297 00597000
         TM    OUTSWTCH,B'01000000'                                0297 00598000
         BNO   @RF00297                                            0297 00599000
*     DO;                                                  /*@0099VLS*/ 00600000
*    IF FOUND = OFF THEN                                           0299 00601000
         TM    FOUND,B'10000000'                                   0299 00602000
         BNZ   @RF00299                                            0299 00603000
*    DO;                                                   /*@0099VLS*/ 00604000
*    LIN2(3:5) = ZCPU;                                     /*@0099VLS*/ 00605000
         MVC   LIN2+2(3),ZCPU                                      0301 00606000
*    LETTER = EVLETTER(Q);                                 /*@0099VLS*/ 00607000
         L     @03,Q                                               0302 00608000
         MH    @03,@CH00080                                        0302 00609000
         L     @01,EVPTR(,R2)                                      0302 00610000
         ALR   @01,@03                                             0302 00611000
         MVC   LETTER(1),EVLETTER-6(@01)                           0302 00612000
*    HD3MOVE = LIN2;                                       /*@0099VLS*/ 00613000
         MVC   HD3MOVE(128),LIN2                                   0303 00614000
*    CALL PRINT1;                                          /*@0099VLS*/ 00615000
         BAL   @14,PRINT1                                          0304 00616000
*    END;                                                  /*@0099VLS*/ 00617000
*      FOUND = ON;                                         /*@0099VLS*/ 00618000
@RF00299 OI    FOUND,B'10000000'                                   0306 00619000
*      CHANID = CHANZ(Z1);                                 /*@0099VLS*/ 00620000
         L     @03,Z1                                              0307 00621000
         MH    @03,@CH00080                                        0307 00622000
         LA    @01,CHANZ-6(@03)                                    0307 00623000
         MVC   CHANID(6),0(@01)                                    0307 00624000
*      DO K = 1 BY 1 TO NUMDAYS;                           /*@0099VLS*/ 00625000
         LA    @03,1                                               0308 00626000
         ST    @03,K                                               0308 00627000
         B     @DE00308                                            0308 00628000
@DL00308 DS    0H                                                  0309 00629000
*       BINWORD = TREND6(Z1,K);                            /*@0099VLS*/ 00630000
         L     @15,Z1                                              0309 00631000
         MH    @15,@CH00546                                        0309 00632000
         ALR   @15,@03                                             0309 00633000
         SLA   @15,2                                               0309 00634000
         L     @15,TREND6-124(@15)                                 0309 00635000
         ST    @15,BINWORD                                         0309 00636000
*       DECADDR = ADDR(ERCNT(K)) + 1;                      /*@0099VLS*/ 00637000
         SLA   @03,2                                               0310 00638000
         LA    @03,ERCNT-4(@03)                                    0310 00639000
         AL    @03,@CF00054                                        0310 00640000
         ST    @03,DECADDR                                         0310 00641000
*       CALL CONVBIN;                                      /*@0099VLS*/ 00642000
         BAL   @14,CONVBIN                                         0311 00643000
*      END;                                                /*@0099VLS*/ 00644000
         LA    @03,1                                               0312 00645000
         AL    @03,K                                               0312 00646000
         ST    @03,K                                               0312 00647000
@DE00308 C     @03,NUMDAYS(,R2)                                    0312 00648000
         BNH   @DL00308                                            0312 00649000
*      HD3MOVE = LIN2;                                     /*@0099VLS*/ 00650000
         MVC   HD3MOVE(128),LIN2                                   0313 00651000
*      CALL PRINT1;                                        /*@0099VLS*/ 00652000
         BAL   @14,PRINT1                                          0314 00653000
*      LIN2 = HD3MOVE;                                     /*@0099VLS*/ 00654000
         MVC   LIN2(128),HD3MOVE                                   0315 00655000
*     END;                                                 /*@0099VLS*/ 00656000
*    END;                                                  /*@0099VLS*/ 00657000
@RF00297 LA    @03,1                                               0317 00658000
         AL    @03,Z1                                              0317 00659000
         ST    @03,Z1                                              0317 00660000
         C     @03,@CF00088                                        0317 00661000
         BNH   @DL00290                                            0317 00662000
*    IF FOUND = NO THEN                                            0318 00663000
         TM    FOUND,B'10000000'                                   0318 00664000
         BNZ   @RF00318                                            0318 00665000
*    DO;                                                   /*@0099VLS*/ 00666000
*    DO K = 1 BY 1 TO NUMDAYS;                             /*@0099VLS*/ 00667000
         LA    @03,1                                               0320 00668000
         ST    @03,K                                               0320 00669000
         B     @DE00320                                            0320 00670000
@DL00320 DS    0H                                                  0321 00671000
*     ERCNT(K) = '404040F0'X;                              /*@0099VLS*/ 00672000
         LR    @15,@03                                             0321 00673000
         SLA   @15,2                                               0321 00674000
         LA    @14,ERCNT-4(@15)                                    0321 00675000
         MVC   0(4,@14),@CB00749                                   0321 00676000
*    END;                                                  /*@0099VLS*/ 00677000
         AL    @03,@CF00054                                        0322 00678000
         ST    @03,K                                               0322 00679000
@DE00320 C     @03,NUMDAYS(,R2)                                    0322 00680000
         BNH   @DL00320                                            0322 00681000
*    LETTER = EVLETTER(Q);                                 /*@0099VLS*/ 00682000
         L     @03,Q                                               0323 00683000
         MH    @03,@CH00080                                        0323 00684000
         L     @01,EVPTR(,R2)                                      0323 00685000
         ALR   @01,@03                                             0323 00686000
         MVC   LETTER(1),EVLETTER-6(@01)                           0323 00687000
*    LIN2(3:5) = ZCPU;                                     /*@0099VLS*/ 00688000
         MVC   LIN2+2(3),ZCPU                                      0324 00689000
*    HD3MOVE = LIN2;                                       /*@0099VLS*/ 00690000
         MVC   HD3MOVE(128),LIN2                                   0325 00691000
*    CALL PRINT1;                                          /*@0099VLS*/ 00692000
         BAL   @14,PRINT1                                          0326 00693000
*    END;                                                  /*@0099VLS*/ 00694000
*  TRENPTR = TRENEXT;                                      /*@0099VLS*/ 00695000
@RF00318 L     @03,TRENPTR(,R2)                                    0328 00696000
         L     @03,TRENEXT(,@03)                                   0328 00697000
         ST    @03,TRENPTR(,R2)                                    0328 00698000
*  LIN2(3:5) = ZCPU;                                       /*@0099VLS*/ 00699000
         MVC   LIN2+2(3),ZCPU                                      0329 00700000
* END;                                                     /*@0099VLS*/ 00701000
         LA    @03,1                                               0330 00702000
         AL    @03,Q                                               0330 00703000
         ST    @03,Q                                               0330 00704000
@DE00270 C     @03,NUMCPUS                                         0330 00705000
         BNH   @DL00270                                            0330 00706000
* ELSE                                                             0331 00707000
* DO;                                                      /*@0099VLS*/ 00708000
         B     @RC00269                                            0331 00709000
@RF00269 DS    0H                                                  0332 00710000
*  IF I = 4 THEN I = 19; /*MAKE UP FOR CHANNEL COUNTS        @0199VLS*/ 00711000
         CLC   I(4),@CF00063                                       0332 00712000
         BNE   @RF00332                                            0332 00713000
         MVC   I(4),@CF00625                                       0333 00714000
*  LIN2(3:5) = ZCPU;                                       /*@0099VLS*/ 00715000
@RF00332 MVC   LIN2+2(3),ZCPU                                      0334 00716000
*  TRENPTR = SAVEPTR;                                      /*@0099VLS*/ 00717000
         L     @03,SAVEPTR                                         0335 00718000
         ST    @03,TRENPTR(,R2)                                    0335 00719000
*    DO J = 1 TO NUMCPUS;    /* LOOP FOR NUMBER OF CPU'S     @Z427VLS*/ 00720000
         LA    @03,1                                               0336 00721000
         B     @DE00336                                            0336 00722000
@DL00336 DS    0H                                                  0337 00723000
*      LETTER = EVLETTER(J); /* MOVE CPU LETTER TO PRINT LINE        */ 00724000
         MH    @03,@CH00080                                        0337 00725000
         L     @01,EVPTR(,R2)                                      0337 00726000
         ALR   @01,@03                                             0337 00727000
         MVC   LETTER(1),EVLETTER-6(@01)                           0337 00728000
*      DO K = 1 TO NUMDAYS;  /* LOOP FOR NUMBER OF DAYS      @Z427VLS*/ 00729000
         LA    @03,1                                               0338 00730000
         B     @DE00338                                            0338 00731000
@DL00338 DS    0H                                                  0339 00732000
*        BINWORD = TREITM(K,I);   /* ERROR COUNT DATA        @Z427VLS*/ 00733000
         LR    @15,@03                                             0339 00734000
         MH    @15,@CH00625                                        0339 00735000
         AL    @15,I                                               0339 00736000
         SLA   @15,2                                               0339 00737000
         L     @01,TRENPTR(,R2)                                    0339 00738000
         AL    @01,@CF00840                                        0339 00739000
         L     @15,TREITM-8(@15,@01)                               0339 00740000
         ST    @15,BINWORD                                         0339 00741000
*        DECADDR = ADDR(ERCNT(K)) + 1; /* DAY SLOT IN PRINT LINE     */ 00742000
         SLA   @03,2                                               0340 00743000
         LA    @03,ERCNT-4(@03)                                    0340 00744000
         AL    @03,@CF00054                                        0340 00745000
         ST    @03,DECADDR                                         0340 00746000
*        CALL CONVBIN;            /* CONVERT ERROR DATA TO EBCDIC    */ 00747000
         BAL   @14,CONVBIN                                         0341 00748000
*      END;                                                /*@Z427VLS*/ 00749000
         LA    @03,1                                               0342 00750000
         AL    @03,K                                               0342 00751000
@DE00338 ST    @03,K                                               0342 00752000
         C     @03,NUMDAYS(,R2)                                    0342 00753000
         BNH   @DL00338                                            0342 00754000
*      HD3MOVE = LIN2;       /* MOVE PRINT LINE TO PRINT AREA        */ 00755000
         MVC   HD3MOVE(128),LIN2                                   0343 00756000
*      CALL PRINT1;          /* PRINT DAILY ERROR COUNTS - THIS CPU  */ 00757000
         BAL   @14,PRINT1                                          0344 00758000
*      TRENPTR = TRENEXT;    /* POINT TO ERROR TABLE - NEXT CPU      */ 00759000
         L     @03,TRENPTR(,R2)                                    0345 00760000
         L     @03,TRENEXT(,@03)                                   0345 00761000
         ST    @03,TRENPTR(,R2)                                    0345 00762000
*    END;                                                  /*@Z427VLS*/ 00763000
         LA    @03,1                                               0346 00764000
         AL    @03,J                                               0346 00765000
@DE00336 ST    @03,J                                               0346 00766000
         C     @03,NUMCPUS                                         0346 00767000
         BNH   @DL00336                                            0346 00768000
*  END;                                                    /*@0099VLS*/ 00769000
*    TRENPTR = SAVEPTR;      /* RE-SET POINT TO ERROR TABLE - 1ST    */ 00770000
@RC00269 L     @03,SAVEPTR                                         0348 00771000
         ST    @03,TRENPTR(,R2)                                    0348 00772000
*                            /* CPU - TO PROCESS NEXT ERROR TYPE     */ 00773000
*  END;                                                    /*@Z427VLS*/ 00774000
         LA    @03,1                                               0349 00775000
         AL    @03,I                                               0349 00776000
         ST    @03,I                                               0349 00777000
         C     @03,@CF00063                                        0349 00778000
         BNH   @DL00263                                            0349 00779000
*END;                                                      /*@Z427VLS*/ 00780000
@EL00005 DS    0H                                                  0350 00781000
@EF00005 DS    0H                                                  0350 00782000
@ER00005 LM    @14,@12,@SA00005                                    0350 00783000
         BR    @14                                                 0350 00784000
*/********************************************************************/ 00785000
*/*                                                          @Z427VLS*/ 00786000
*/* THIS PROC PRINTS THE MODEL AND SERIAL NO. OF THE CPU'S FOR WHICH */ 00787000
*/* ERROR COUNTS HAVE BEEN PRINTED                           @Z427VLS*/ 00788000
*/*                                                          @Z427VLS*/ 00789000
*CPUMODSN:  PROC;                                          /*@Z427VLS*/ 00790000
CPUMODSN STM   @14,@12,@SA00006                                    0351 00791000
*  IF ((LINECT - TWO) - MYLINECT) < (FIVE + NUMCPUS) THEN          0352 00792000
         LH    @03,LINECT(,R2)                                     0352 00793000
         BCTR  @03,0                                               0352 00794000
         BCTR  @03,0                                               0352 00795000
         SL    @03,MYLINECT                                        0352 00796000
         LA    @15,5                                               0352 00797000
         AL    @15,NUMCPUS                                         0352 00798000
         CR    @03,@15                                             0352 00799000
         BNL   @RF00352                                            0352 00800000
*    DO;                     /* DATA TO BE PRINTED WILL NOT FIT IN   */ 00801000
*      MYLINECT = ZERO;      /* REMAINING VERTICAL SPACE     @Z427VLS*/ 00802000
         SLR   @03,@03                                             0354 00803000
         ST    @03,MYLINECT                                        0354 00804000
*      SPACING = UPSPACE;                                  /*@Z427VLS*/ 00805000
         MVI   SPACING,X'89'                                       0355 00806000
*      CALL HEADING1;                                      /*@Z427VLS*/ 00807000
         BAL   @14,HEADING1                                        0356 00808000
*    END;                                                  /*@Z427VLS*/ 00809000
*      MYLINECT = ZERO;      /* REMAINING VERTICAL SPACE     @Z427VLS*/ 00810000
@RF00352 SLR   @03,@03                                             0358 00811000
         ST    @03,MYLINECT                                        0358 00812000
*      SPACING = TRIPLE;                                   /*@Z427VLS*/ 00813000
         MVI   SPACING,X'19'                                       0359 00814000
*      LNESPACE = THREE;                                   /*@Z427VLS*/ 00815000
         MVC   LNESPACE(4),@CF00075                                0360 00816000
*      CALL PRINT1;          /* SKIP 3 LINES                 @Z427VLS*/ 00817000
         BAL   @14,PRINT1                                          0361 00818000
*      SPACING = SINGLE;                                   /*@Z427VLS*/ 00819000
         MVI   SPACING,X'09'                                       0362 00820000
*      LNESPACE = ONE;                                     /*@Z427VLS*/ 00821000
         MVC   LNESPACE(4),@CF00054                                0363 00822000
*      CPULINE1 = CPULINE;   /* MOVE HEADING LINE TO PRINT AREA      */ 00823000
         MVC   CPULINE1(24),CPULINE                                0364 00824000
*      CALL PRINT1;          /* PRINT HEADING                @Z427VLS*/ 00825000
         BAL   @14,PRINT1                                          0365 00826000
*      CALL PRINT1;          /* PRINT BLANK LINE             @Z427VLS*/ 00827000
         BAL   @14,PRINT1                                          0366 00828000
*      DO I = 1 TO NUMCPUS;                                /*@Z427VLS*/ 00829000
         LA    @03,1                                               0367 00830000
         B     @DE00367                                            0367 00831000
@DL00367 DS    0H                                                  0368 00832000
*        CPUTYPE = EVLETTER(I);   /* MOVE CPU LETTER TO PRINT LINE   */ 00833000
         MH    @03,@CH00080                                        0368 00834000
         L     @15,EVPTR(,R2)                                      0368 00835000
         ST    @03,@TF00001                                        0368 00836000
         ALR   @03,@15                                             0368 00837000
         MVC   CPUTYPE(1),EVLETTER-6(@03)                          0368 00838000
*        NUMBER = TWO;            /* TWO BYTES TO BE CONVERTED       */ 00839000
         MVC   NUMBER(4),@CF00073                                  0369 00840000
*        NEXTBY = ADDR(EVMODEL(I));    /* DATA SOURCE - PARM TABLE   */ 00841000
         L     @03,@TF00001                                        0370 00842000
         LA    @03,EVMODEL-6(@03,@15)                              0370 00843000
         ST    @03,NEXTBY                                          0370 00844000
*        ADDNXT = ADDR(CPUMODEL); /* DATA DESTINATION - PRINT LINE   */ 00845000
         LA    @03,CPUMODEL                                        0371 00846000
         ST    @03,ADDNXT                                          0371 00847000
*        CALL CONVERT;            /* CONVERT CPU MODEL NO. TO EBCDIC */ 00848000
         BAL   @14,CONVERT                                         0372 00849000
*        NUMBER = THREE;          /* THREE BYTES TO BE CONVERTED     */ 00850000
         MVC   NUMBER(4),@CF00075                                  0373 00851000
*        NEXTBY = ADDR(EVSERIAL(I));   /* DATA SOURCE - PARM TABLE   */ 00852000
         L     @03,I                                               0374 00853000
         MH    @03,@CH00080                                        0374 00854000
         L     @01,EVPTR(,R2)                                      0374 00855000
         LA    @03,EVSERIAL-6(@03,@01)                             0374 00856000
         ST    @03,NEXTBY                                          0374 00857000
*        ADDNXT = ADDR(CPUSERAL);  /* DATA DESTINATION - PRINT LINE  */ 00858000
         LA    @03,CPUSERAL                                        0375 00859000
         ST    @03,ADDNXT                                          0375 00860000
*        CALL CONVERT;            /* CONVERT CPU SERIAL NO. TO EBCDIC*/ 00861000
         BAL   @14,CONVERT                                         0376 00862000
*        CPULINE1 = CPUDATA;      /* MOVE PRINT LINE TO PRINT AREA   */ 00863000
         MVI   CPULINE1+20,C' '                                    0377 00864000
         MVC   CPULINE1+21(3),CPULINE1+20                          0377 00865000
         MVC   CPULINE1(20),CPUDATA                                0377 00866000
*        CALL PRINT1;             /* PRINT CPU, MODEL, SERIAL NO.    */ 00867000
         BAL   @14,PRINT1                                          0378 00868000
*      END;                                                /*@Z427VLS*/ 00869000
         LA    @03,1                                               0379 00870000
         AL    @03,I                                               0379 00871000
@DE00367 ST    @03,I                                               0379 00872000
         C     @03,NUMCPUS                                         0379 00873000
         BNH   @DL00367                                            0379 00874000
*END;                                                      /*@Z427VLS*/ 00875000
@EL00006 DS    0H                                                  0380 00876000
@EF00006 DS    0H                                                  0380 00877000
@ER00006 LM    @14,@12,@SA00006                                    0380 00878000
         BR    @14                                                 0380 00879000
*/********************************************************************/ 00880000
*/*                                                          @Z427VLS*/ 00881000
*/* THIS PROC INITIALIZES PRINT CONTROLS AND LINES 2 AND 3 OF THE    */ 00882000
*/* REPORT HEADING FOR PART 2.                               @Z427VLS*/ 00883000
*INITPRT2:  PROC OPTIONS(NOSAVEAREA);                      /*@Z427VLS*/ 00884000
INITPRT2 STM   @14,@12,12(@13)                                     0381 00885000
*  SPACING = UPSPACE;        /* SET CARRIAGE CONTROL TO NEXT PAGE    */ 00886000
         MVI   SPACING,X'89'                                       0382 00887000
*  MYLINECT = ZERO;          /* CLEAR PRINT LINE COUNTER     @Z427VLS*/ 00888000
         SLR   @03,@03                                             0383 00889000
         ST    @03,MYLINECT                                        0383 00890000
*  LNESPACE = ZERO;          /* SET LINE COUNTER INCREMENT TO 0      */ 00891000
         ST    @03,LNESPACE                                        0384 00892000
*  LINE2 = LINE2P2;          /* CHANGE LINES 2, 3 OF REPORT HEADING  */ 00893000
         MVI   LINE2+51,C' '                                       0385 00894000
         MVC   LINE2+52(5),LINE2+51                                0385 00895000
         MVC   LINE2(51),LINE2P2                                   0385 00896000
*  LINE3 = LINE3P2;          /* TO PART 2 DATA               @Z427VLS*/ 00897000
         MVI   LINE3+51,C' '                                       0386 00898000
         MVC   LINE3+52(5),LINE3+51                                0386 00899000
         MVC   LINE3(51),LINE3P2                                   0386 00900000
*  DO J = 1 TO 30;                                         /*@Z427VLS*/ 00901000
         LA    @03,1                                               0387 00902000
         ST    @03,J                                               0387 00903000
@DL00387 DS    0H                                                  0388 00904000
*    PERMCT(J) = ZERO;                                     /*@Z427VLS*/ 00905000
         SLR   @15,@15                                             0388 00906000
         LR    @14,@03                                             0388 00907000
         SLA   @14,2                                               0388 00908000
         LA    @01,PERMCT-4(@14)                                   0388 00909000
         STCM  @15,15,0(@01)                                       0388 00910000
*    TEMPCT(J) = ZERO;                                     /*@Z427VLS*/ 00911000
         LA    @01,TEMPCT-4(@14)                                   0389 00912000
         STCM  @15,15,0(@01)                                       0389 00913000
*  END;                                                    /*@Z427VLS*/ 00914000
         AL    @03,@CF00054                                        0390 00915000
         ST    @03,J                                               0390 00916000
         C     @03,@CF00546                                        0390 00917000
         BNH   @DL00387                                            0390 00918000
* END;                                                     /*@Z427VLS*/ 00919000
@EL00007 DS    0H                                                  0391 00920000
@EF00007 DS    0H                                                  0391 00921000
@ER00007 LM    @14,@12,12(@13)                                     0391 00922000
         BR    @14                                                 0391 00923000
*/********************************************************************/ 00924000
*/*                                                          @Z427VLS*/ 00925000
*/* THIS PROC PERFORMS INITIALIZATION FOR TWO OTHER PROCS - ACCUMERR */ 00926000
*/* AND PRINTALL - WHICH SUMMARIZE OBR,MDR TEMPORARY AND PERMANENT   */ 00927000
*/* ERROR COUNTS BY DAY,BY CUA AND THEN PRINT RESPECTIVELY. SHARED   */ 00928000
*/* I/O IS REFLECTED IN THE REPORT,IF REQUESTED.             @Z427VLS*/ 00929000
*/*                                                          @Z427VLS*/ 00930000
*CUAERREC:  PROC;                                          /*@Z427VLS*/ 00931000
CUAERREC STM   @14,@12,@SA00008                                    0392 00932000
*  PREVGRP = TRENDGRP(1);               /* FIRST GROUP       @Z427VLS*/ 00933000
         L     @15,SORTADR(,R2)                                    0393 00934000
         SLR   PREVGRP,PREVGRP                                     0393 00935000
         IC    PREVGRP,TRENDGRP(,@15)                              0393 00936000
*  PREVDEV = TRENDDEV(1);               /* FIRST DEVICE      @Z427VLS*/ 00937000
         MVC   PREVDEV(2),TRENDDEV(@15)                            0394 00938000
*  PREVCPU = TRENCPUS(1) & 'F0'X;       /* FIRST CPU         @Z427VLS*/ 00939000
         MVC   PREVCPU(1),TRENCPUS(@15)                            0395 00940000
         NI    PREVCPU,X'F0'                                       0395 00941000
*  PREVCUA = TRENDRT(1) & 'FFF0'X;      /* FIRST CUA         @Z427VLS*/ 00942000
         MVC   PREVCUA(2),TRENDRT(@15)                             0396 00943000
         NC    PREVCUA(2),@CB00760                                 0396 00944000
*  I = 1;                                                  /*@Z427VLS*/ 00945000
         MVC   I(4),@CF00054                                       0397 00946000
*  DO UNTIL (I > SORTNUM);                                 /*@Z427VLS*/ 00947000
@DL00398 DS    0H                                                  0399 00948000
*    CALL PRTGROUP;               /* PRINT GROUP HEADING     @Z427VLS*/ 00949000
         BAL   @14,PRTGROUP                                        0399 00950000
*    DO UNTIL (I > SORTNUM | PREVGRP ^= TRENDGRP(I));      /*@Z427VLS*/ 00951000
@DL00400 DS    0H                                                  0401 00952000
*      IF PREVGRP = 5 THEN                                         0401 00953000
         C     PREVGRP,@CF00078                                    0401 00954000
         BNE   @RF00401                                            0401 00955000
*        CALL TPCNTRL;               /* DO TP CONTROLLER     @Z427VLS*/ 00956000
         BAL   @14,TPCNTRL                                         0402 00957000
*      IF I ^> SORTNUM THEN                                        0403 00958000
@RF00401 L     @15,I                                               0403 00959000
         C     @15,SORTNUM(,R2)                                    0403 00960000
         BH    @RF00403                                            0403 00961000
*       DO;                                                /*@Z427VLS*/ 00962000
*      CALL DODEVTYP;               /* PRINT THE DEVICE TYPE @Z427VLS*/ 00963000
         BAL   @14,DODEVTYP                                        0405 00964000
*      DO UNTIL (I > SORTNUM | PREVGRP ^= TRENDGRP(I) |            0406 00965000
*                PREVDEV ^= TRENDDEV(I));                  /*@Z427VLS*/ 00966000
@DL00406 DS    0H                                                  0407 00967000
*        CALL DOCUA;                 /* DETERMINE THE CUA    @Z427VLS*/ 00968000
         BAL   @14,DOCUA                                           0407 00969000
*        DO UNTIL (I > SORTNUM | PREVGRP ^= TRENDGRP(I) |          0408 00970000
*                  PREVDEV ^= TRENDDEV(I) |                        0408 00971000
*                  PREVCUA ^= (TRENDRT(I) & 'FFF0'X));     /*@Z427VLS*/ 00972000
@DL00408 DS    0H                                                  0409 00973000
*          CPUWORK = PREVCPU;                              /*@Z427VLS*/ 00974000
         MVC   CPUWORK(1),PREVCPU                                  0409 00975000
*          SRL (CPUWORK,FOUR);                             /*@Z427VLS*/ 00976000
         SLR   @15,@15                                             0410 00977000
         IC    @15,CPUWORK                                         0410 00978000
         SRL   @15,4                                               0410 00979000
         STC   @15,CPUWORK                                         0410 00980000
*          LABELCPU(CPU+1) = 1;      /* SET FOR BASE CPU     @Z427VLS*/ 00981000
         SLR   @01,@01                                             0411 00982000
         IC    @01,CPU                                             0411 00983000
         LA    @00,1                                               0411 00984000
         STC   @00,LABELCPU(@01)                                   0411 00985000
*          DO UNTIL (I > SORTNUM | PREVGRP ^= TRENDGRP(I) |        0412 00986000
*                    PREVDEV ^= TRENDDEV(I) |                      0412 00987000
*                    PREVCUA ^= (TRENDRT(I) & 'FFF0'X) |           0412 00988000
*                    PREVCPU ^= (TRENCPUS(I) & 'F0'X));    /*@Z427VLS*/ 00989000
@DL00412 DS    0H                                                  0413 00990000
*            CALL ACCUMERR;           /* TOTAL INTO THE BUCKETS      */ 00991000
         BAL   @14,ACCUMERR                                        0413 00992000
*          END;                                            /*@Z427VLS*/ 00993000
@DE00412 L     @15,I                                               0414 00994000
         C     @15,SORTNUM(,R2)                                    0414 00995000
         BH    @DC00412                                            0414 00996000
         MH    @15,@CH00484                                        0414 00997000
         L     @14,SORTADR(,R2)                                    0414 00998000
         LA    @01,0(@15,@14)                                      0414 00999000
         AL    @01,@CF00841                                        0414 01000000
         SLR   @00,@00                                             0414 01001000
         IC    @00,TRENDGRP(,@01)                                  0414 01002000
         CR    PREVGRP,@00                                         0414 01003000
         BNE   @DC00412                                            0414 01004000
         ST    @15,@TF00001                                        0414 01005000
         ALR   @15,@14                                             0414 01006000
         AL    @15,@CF00835                                        0414 01007000
         CLC   PREVDEV(2),TRENDDEV-6(@15)                          0414 01008000
         BNE   @DC00412                                            0414 01009000
         LR    @15,@14                                             0414 01010000
         AL    @15,@TF00001                                        0414 01011000
         AL    @15,@CF00842                                        0414 01012000
         MVC   @TS00001(2),TRENDRT-1(@15)                          0414 01013000
         NC    @TS00001(2),@CB00760                                0414 01014000
         CLC   PREVCUA(2),@TS00001                                 0414 01015000
         BNE   @DC00412                                            0414 01016000
         AL    @14,@TF00001                                        0414 01017000
         AL    @14,@CF00843                                        0414 01018000
         MVC   @TS00001(1),TRENCPUS-3(@14)                         0414 01019000
         NI    @TS00001,X'F0'                                      0414 01020000
         CLC   PREVCPU(1),@TS00001                                 0414 01021000
         BE    @DL00412                                            0414 01022000
@DC00412 DS    0H                                                  0415 01023000
*          CALL OUTCUA;               /* OUTPUT CUA AND CPU LETTERS  */ 01024000
         BAL   @14,OUTCUA                                          0415 01025000
*          CALL CNVRTPRT;             /* OUTPUT THE ERROR LINES      */ 01026000
         BAL   @14,CNVRTPRT                                        0416 01027000
*          IF I ^> SORTNUM THEN                                    0417 01028000
         L     @15,I                                               0417 01029000
         C     @15,SORTNUM(,R2)                                    0417 01030000
         BH    @RF00417                                            0417 01031000
*            PREVCPU = TRENCPUS(I) & 'F0'X;                /*@Z427VLS*/ 01032000
         MH    @15,@CH00484                                        0418 01033000
         L     @01,SORTADR(,R2)                                    0418 01034000
         ALR   @01,@15                                             0418 01035000
         AL    @01,@CF00843                                        0418 01036000
         MVC   PREVCPU(1),TRENCPUS-3(@01)                          0418 01037000
         NI    PREVCPU,X'F0'                                       0418 01038000
*        END;                                              /*@Z427VLS*/ 01039000
@RF00417 DS    0H                                                  0419 01040000
@DE00408 L     @15,I                                               0419 01041000
         C     @15,SORTNUM(,R2)                                    0419 01042000
         BH    @DC00408                                            0419 01043000
         MH    @15,@CH00484                                        0419 01044000
         L     @14,SORTADR(,R2)                                    0419 01045000
         LA    @01,0(@15,@14)                                      0419 01046000
         AL    @01,@CF00841                                        0419 01047000
         SLR   @00,@00                                             0419 01048000
         IC    @00,TRENDGRP(,@01)                                  0419 01049000
         CR    PREVGRP,@00                                         0419 01050000
         BNE   @DC00408                                            0419 01051000
         ST    @15,@TF00001                                        0419 01052000
         ALR   @15,@14                                             0419 01053000
         AL    @15,@CF00835                                        0419 01054000
         CLC   PREVDEV(2),TRENDDEV-6(@15)                          0419 01055000
         BNE   @DC00408                                            0419 01056000
         AL    @14,@TF00001                                        0419 01057000
         AL    @14,@CF00842                                        0419 01058000
         MVC   @TS00001(2),TRENDRT-1(@14)                          0419 01059000
         NC    @TS00001(2),@CB00760                                0419 01060000
         CLC   PREVCUA(2),@TS00001                                 0419 01061000
         BE    @DL00408                                            0419 01062000
@DC00408 DS    0H                                                  0420 01063000
*        IF I ^> SORTNUM THEN                                      0420 01064000
         L     @15,I                                               0420 01065000
         C     @15,SORTNUM(,R2)                                    0420 01066000
         BH    @RF00420                                            0420 01067000
*          PREVCUA = TRENDRT(I) & 'FFF0'X;                 /*@Z427VLS*/ 01068000
         MH    @15,@CH00484                                        0421 01069000
         L     @01,SORTADR(,R2)                                    0421 01070000
         ALR   @01,@15                                             0421 01071000
         AL    @01,@CF00842                                        0421 01072000
         MVC   PREVCUA(2),TRENDRT-1(@01)                           0421 01073000
         NC    PREVCUA(2),@CB00760                                 0421 01074000
*      END;                                                /*@Z427VLS*/ 01075000
@RF00420 DS    0H                                                  0422 01076000
@DE00406 L     @15,I                                               0422 01077000
         C     @15,SORTNUM(,R2)                                    0422 01078000
         BH    @DC00406                                            0422 01079000
         MH    @15,@CH00484                                        0422 01080000
         L     @14,SORTADR(,R2)                                    0422 01081000
         LA    @01,0(@15,@14)                                      0422 01082000
         AL    @01,@CF00841                                        0422 01083000
         SLR   @00,@00                                             0422 01084000
         IC    @00,TRENDGRP(,@01)                                  0422 01085000
         CR    PREVGRP,@00                                         0422 01086000
         BNE   @DC00406                                            0422 01087000
         ALR   @14,@15                                             0422 01088000
         AL    @14,@CF00835                                        0422 01089000
         CLC   PREVDEV(2),TRENDDEV-6(@14)                          0422 01090000
         BE    @DL00406                                            0422 01091000
@DC00406 DS    0H                                                  0423 01092000
*      IF I ^> SORTNUM THEN                                        0423 01093000
         L     @15,I                                               0423 01094000
         C     @15,SORTNUM(,R2)                                    0423 01095000
         BH    @RF00423                                            0423 01096000
*        PREVDEV = TRENDDEV(I);                            /*@Z427VLS*/ 01097000
         MH    @15,@CH00484                                        0424 01098000
         L     @01,SORTADR(,R2)                                    0424 01099000
         ALR   @01,@15                                             0424 01100000
         AL    @01,@CF00835                                        0424 01101000
         MVC   PREVDEV(2),TRENDDEV-6(@01)                          0424 01102000
*     END;                           /*END TO THE IF  STATEMENT     */  01103000
@RF00423 DS    0H                                                  0426 01104000
*    END;                                                  /*@Z427VLS*/ 01105000
@RF00403 DS    0H                                                  0426 01106000
@DE00400 L     @15,I                                               0426 01107000
         C     @15,SORTNUM(,R2)                                    0426 01108000
         BH    @DC00400                                            0426 01109000
         MH    @15,@CH00484                                        0426 01110000
         L     @01,SORTADR(,R2)                                    0426 01111000
         AL    @01,@CF00841                                        0426 01112000
         SLR   @14,@14                                             0426 01113000
         IC    @14,TRENDGRP(@15,@01)                               0426 01114000
         CR    PREVGRP,@14                                         0426 01115000
         BE    @DL00400                                            0426 01116000
@DC00400 DS    0H                                                  0427 01117000
*    IF I ^> SORTNUM THEN                                          0427 01118000
         L     @15,I                                               0427 01119000
         C     @15,SORTNUM(,R2)                                    0427 01120000
         BH    @RF00427                                            0427 01121000
*      DO;                                                 /*@Z427VLS*/ 01122000
*        CALL PRINT1;                /* SKIP A LINE          @Z427VLS*/ 01123000
         BAL   @14,PRINT1                                          0429 01124000
*        PREVGRP = TRENDGRP(I);                            /*@Z427VLS*/ 01125000
         L     @15,I                                               0430 01126000
         MH    @15,@CH00484                                        0430 01127000
         L     @01,SORTADR(,R2)                                    0430 01128000
         AL    @01,@CF00841                                        0430 01129000
         SLR   PREVGRP,PREVGRP                                     0430 01130000
         IC    PREVGRP,TRENDGRP(@15,@01)                           0430 01131000
*      END;                                                /*@Z427VLS*/ 01132000
*  END;                                                    /*@Z427VLS*/ 01133000
@RF00427 DS    0H                                                  0432 01134000
@DE00398 L     @15,I                                               0432 01135000
         C     @15,SORTNUM(,R2)                                    0432 01136000
         BNH   @DL00398                                            0432 01137000
*END;                                                      /*@Z427VLS*/ 01138000
@EL00008 DS    0H                                                  0433 01139000
@EF00008 DS    0H                                                  0433 01140000
@ER00008 LM    @14,@12,@SA00008                                    0433 01141000
         BR    @14                                                 0433 01142000
*/********************************************************************/ 01143000
*/*                                                          @Z427VLS*/ 01144000
*/* THIS PROC TOTALS THE TEMPORARY AND PERMANENT COUNTS INTO THE     */ 01145000
*/* BUCKET FOR THE APPORPRIATE DAY.                          @Z427VLS*/ 01146000
*/*                                                          @Z427VLS*/ 01147000
*ACCUMERR:  PROC;                                          /*@Z427VLS*/ 01148000
ACCUMERR STM   @14,@12,12(@13)                                     0434 01149000
*  CPUWORK = TRENDITM(I) & '0F'X;  /* BASE CPU - LEFT JUSTIFIED      */ 01150000
         L     @03,I                                               0435 01151000
         LR    @15,@03                                             0435 01152000
         MH    @15,@CH00484                                        0435 01153000
         L     @14,SORTADR(,R2)                                    0435 01154000
         ST    @15,@TF00001                                        0435 01155000
         ALR   @15,@14                                             0435 01156000
         AL    @15,@CF00844                                        0435 01157000
         MVC   CPUWORK(1),TRENDITM-4(@15)                          0435 01158000
         NI    CPUWORK,X'0F'                                       0435 01159000
*  LABELCPU(CPU+1) = 1;                                    /*@Z427VLS*/ 01160000
         LA    @15,1                                               0436 01161000
         SLR   @01,@01                                             0436 01162000
         IC    @01,CPU                                             0436 01163000
         STC   @15,LABELCPU(@01)                                   0436 01164000
*  J = TRENDDAT(I);                    /* SET THE DATE INDEX @Z427VLS*/ 01165000
         L     @01,@TF00001                                        0437 01166000
         AL    @01,@CF00845                                        0437 01167000
         SLR   @00,@00                                             0437 01168000
         IC    @00,TRENDDAT-5(@01,@14)                             0437 01169000
         ST    @00,J                                               0437 01170000
*     PERMCT(J) = PERMCT(J) + TREPRM(I);                   /*@0099VLS*/ 01171000
         SLA   @00,2                                               0438 01172000
         LR    @01,@00                                             0438 01173000
         LA    @09,PERMCT-4(@01)                                   0438 01174000
         ICM   @08,15,0(@09)                                       0438 01175000
         LR    @09,@14                                             0438 01176000
         AL    @09,@TF00001                                        0438 01177000
         AL    @09,@CF00846                                        0438 01178000
         ICM   @09,12,TREPRM-8(@09)                                0438 01179000
         SRA   @09,16                                              0438 01180000
         ALR   @08,@09                                             0438 01181000
         LR    @09,@00                                             0438 01182000
         LA    @01,PERMCT-4(@09)                                   0438 01183000
         STCM  @08,15,0(@01)                                       0438 01184000
*     TEMPCT(J) = TEMPCT(J) + TRETMP(I);                   /*@0099VLS*/ 01185000
         LR    @01,@00                                             0439 01186000
         LA    @09,TEMPCT-4(@01)                                   0439 01187000
         ICM   @08,15,0(@09)                                       0439 01188000
         AL    @14,@TF00001                                        0439 01189000
         AL    @14,@CF00836                                        0439 01190000
         ICM   @09,15,TRETMP-10(@14)                               0439 01191000
         ALR   @08,@09                                             0439 01192000
         LR    @09,@00                                             0439 01193000
         LA    @01,TEMPCT-4(@09)                                   0439 01194000
         STCM  @08,15,0(@01)                                       0439 01195000
*  I = I + 1;                                              /*@Z427VLS*/ 01196000
         ALR   @03,@15                                             0440 01197000
         ST    @03,I                                               0440 01198000
*END;                                                      /*@Z427VLS*/ 01199000
@EL00009 DS    0H                                                  0441 01200000
@EF00009 DS    0H                                                  0441 01201000
@ER00009 LM    @14,@12,12(@13)                                     0441 01202000
         BR    @14                                                 0441 01203000
*/********************************************************************/ 01204000
*/*                                                          @Z427VLS*/ 01205000
*/* THIS PROC PRINT THE GROUP HEADING.                       @Z427VLS*/ 01206000
*/*                                                          @Z427VLS*/ 01207000
*PRTGROUP: PROC;                                           /*@Z427VLS*/ 01208000
PRTGROUP STM   @14,@12,12(@13)                                     0442 01209000
*  GROUPLBL = DEVGROUP(PREVGRP);                           /*@Z427VLS*/ 01210000
         LR    @15,PREVGRP                                         0443 01211000
         SLA   @15,3                                               0443 01212000
         LA    @14,DEVGROUP-8(@15)                                 0443 01213000
         MVC   GROUPLBL(8),0(@14)                                  0443 01214000
*  LINESPRT = LINESPRT + NUMBER1;       /* PRINT A LINE      @Z427VLS*/ 01215000
         LA    @15,1                                               0444 01216000
         AL    @15,LINESPRT                                        0444 01217000
         ST    @15,LINESPRT                                        0444 01218000
*  GRPOUT = ON;                                            /*@Z427VLS*/ 01219000
         OI    GRPOUT,B'10000000'                                  0445 01220000
*END;                                                      /*@Z427VLS*/ 01221000
@EL00010 DS    0H                                                  0446 01222000
@EF00010 DS    0H                                                  0446 01223000
@ER00010 LM    @14,@12,12(@13)                                     0446 01224000
         BR    @14                                                 0446 01225000
*/********************************************************************/ 01226000
*/*                                                          @Z427VLS*/ 01227000
*/* THIS PROC PRINT THE DEVICE TYPE HEADING.                 @Z427VLS*/ 01228000
*/*                                                          @Z427VLS*/ 01229000
*DODEVTYP: PROC;                                           /*@Z427VLS*/ 01230000
DODEVTYP STM   @14,@12,@SA00011                                    0447 01231000
*  IF PREVDEV ^= '0000'X THEN                                      0448 01232000
         CLC   PREVDEV(2),@CB00208                                 0448 01233000
         BE    @RF00448                                            0448 01234000
*  DO;                                                     /*@Z427VLS*/ 01235000
*  NUMBER = TWO;                                           /*@Z427VLS*/ 01236000
         MVC   NUMBER(4),@CF00073                                  0450 01237000
*  NEXTBY = ADDR(PREVDEV);                                 /*@Z427VLS*/ 01238000
         LA    @03,PREVDEV                                         0451 01239000
         ST    @03,NEXTBY                                          0451 01240000
*  ADDNXT = ADDR(CUDEV);                                   /*@Z427VLS*/ 01241000
         LA    @03,CUDEV                                           0452 01242000
         ST    @03,ADDNXT                                          0452 01243000
*  CALL CONVERT;                                           /*@Z427VLS*/ 01244000
         BAL   @14,CONVERT                                         0453 01245000
*  END;                                                    /*@Z427VLS*/ 01246000
*  ELSE                                                            0455 01247000
*  CUDEV = UKNO;         /*DEVICE IS UKNOWN (FROM FILTER)    @Z427VLS*/ 01248000
         B     @RC00448                                            0455 01249000
@RF00448 MVC   CUDEV(4),UKNO                                       0455 01250000
*  LINESPRT = LINESPRT + NUMBER1;        /* PRINT A LINE     @Z427VLS*/ 01251000
@RC00448 LA    @03,1                                               0456 01252000
         AL    @03,LINESPRT                                        0456 01253000
         ST    @03,LINESPRT                                        0456 01254000
*  DEVOUT = ON;                                            /*@Z427VLS*/ 01255000
         OI    DEVOUT,B'01000000'                                  0457 01256000
*END;                                                      /*@Z427VLS*/ 01257000
@EL00011 DS    0H                                                  0458 01258000
@EF00011 DS    0H                                                  0458 01259000
@ER00011 LM    @14,@12,@SA00011                                    0458 01260000
         BR    @14                                                 0458 01261000
*/********************************************************************/ 01262000
*/*                                                          @Z427VLS*/ 01263000
*/* THIS PROC CREATED THE CUA HEADING.                       @Z427VLS*/ 01264000
*/*                                                          @Z427VLS*/ 01265000
*DOCUA: PROC;                                              /*@Z427VLS*/ 01266000
DOCUA    STM   @14,@12,@SA00012                                    0459 01267000
*  CUACONV = PREVCUA;                                      /*@Z427VLS*/ 01268000
         MVC   CUACONV(2),PREVCUA                                  0460 01269000
*  SRL (CUACONV,FOUR);                                     /*@Z427VLS*/ 01270000
         SLR   @03,@03                                             0461 01271000
         ICM   @03,3,CUACONV                                       0461 01272000
         SRL   @03,4                                               0461 01273000
         STCM  @03,3,CUACONV                                       0461 01274000
*  NUMBER = TWO;                                           /*@Z427VLS*/ 01275000
         MVC   NUMBER(4),@CF00073                                  0462 01276000
*  NEXTBY = ADDR(CUACONV);                                 /*@Z427VLS*/ 01277000
         LA    @03,CUACONV                                         0463 01278000
         ST    @03,NEXTBY                                          0463 01279000
*  ADDNXT = ADDR(CUADATA);                                 /*@Z427VLS*/ 01280000
         LA    @03,CUADATA                                         0464 01281000
         ST    @03,ADDNXT                                          0464 01282000
*  SWITCH1 = ON;                                           /*@Z427VLS*/ 01283000
         OI    SWITCH1,B'00001000'                                 0465 01284000
*  CALL CONVERT;                                           /*@Z427VLS*/ 01285000
         BAL   @14,CONVERT                                         0466 01286000
*END;                                                      /*@Z427VLS*/ 01287000
@EL00012 DS    0H                                                  0467 01288000
@EF00012 DS    0H                                                  0467 01289000
@ER00012 LM    @14,@12,@SA00012                                    0467 01290000
         BR    @14                                                 0467 01291000
*/********************************************************************/ 01292000
*/*                                                          @Z427VLS*/ 01293000
*/* THIS PROC OUTPUTS THE CUA HEADING AND THE CPU LETTERS.   @Z427VLS*/ 01294000
*/*                                                          @Z427VLS*/ 01295000
*OUTCUA: PROC;                                             /*@Z427VLS*/ 01296000
OUTCUA   STM   @14,@12,12(@13)                                     0468 01297000
*  K = 1;                                                  /*@Z427VLS*/ 01298000
         LA    @03,1                                               0469 01299000
         ST    @03,K                                               0469 01300000
*  DO J = 1 TO 16;                                         /*@Z427VLS*/ 01301000
         ST    @03,J                                               0470 01302000
@DL00470 DS    0H                                                  0471 01303000
*    IF LABELCPU (J) = 1 THEN                                      0471 01304000
         LA    @15,1                                               0471 01305000
         SLR   @14,@14                                             0471 01306000
         IC    @14,LABELCPU-1(@03)                                 0471 01307000
         CR    @15,@14                                             0471 01308000
         BNE   @RF00471                                            0471 01309000
*      DO;                                                 /*@Z427VLS*/ 01310000
*        CPULBL(K) = EVLETTER(J);         /*  PLACE THE CPU LETTER   */ 01311000
         L     @14,K                                               0473 01312000
         LA    @01,CPULBL-1(@14)                                   0473 01313000
         LR    @09,@03                                             0473 01314000
         MH    @09,@CH00080                                        0473 01315000
         L     @08,EVPTR(,R2)                                      0473 01316000
         ALR   @08,@09                                             0473 01317000
         MVC   0(1,@01),EVLETTER-6(@08)                            0473 01318000
*        K = K + 1;                                        /*@Z427VLS*/ 01319000
         ALR   @14,@15                                             0474 01320000
         ST    @14,K                                               0474 01321000
*        LABELCPU(J) = ZERO;                               /*@Z427VLS*/ 01322000
         SLR   @15,@15                                             0475 01323000
         STC   @15,LABELCPU-1(@03)                                 0475 01324000
*      END;                                                /*@Z427VLS*/ 01325000
*  END;                                                    /*@Z427VLS*/ 01326000
@RF00471 LA    @03,1                                               0477 01327000
         AL    @03,J                                               0477 01328000
         ST    @03,J                                               0477 01329000
         C     @03,@CF00088                                        0477 01330000
         BNH   @DL00470                                            0477 01331000
*  LINESPRT = LINESPRT + NUMBER1;         /* PRINT ONE LINE  @Z427VLS*/ 01332000
         LA    @03,1                                               0478 01333000
         AL    @03,LINESPRT                                        0478 01334000
         ST    @03,LINESPRT                                        0478 01335000
*  CUAOUT = ON;                                            /*@Z427VLS*/ 01336000
         OI    CUAOUT,B'00100000'                                  0479 01337000
*END;                                                      /*@Z427VLS*/ 01338000
@EL00013 DS    0H                                                  0480 01339000
@EF00013 DS    0H                                                  0480 01340000
@ER00013 LM    @14,@12,12(@13)                                     0480 01341000
         BR    @14                                                 0480 01342000
*/********************************************************************/ 01343000
*/*                                                          @Z427VLS*/ 01344000
*/* THIS PROC PROCESSES THE TP CONTROLLER GROUP.             @Z427VLS*/ 01345000
*/*                                                          @Z427VLS*/ 01346000
*TPCNTRL:   PROC;                                          /*@Z427VLS*/ 01347000
TPCNTRL  STM   @14,@12,@SA00014                                    0481 01348000
*  DO UNTIL (I > SORTNUM | PREVGRP ^= TRENDGRP(I));        /*@Z427VLS*/ 01349000
@DL00482 DS    0H                                                  0483 01350000
*    PREVCPU = TRENCPUS(I) & 'F0'X;       /* CPU             @Z427VLS*/ 01351000
         L     @15,I                                               0483 01352000
         MH    @15,@CH00484                                        0483 01353000
         L     @14,SORTADR(,R2)                                    0483 01354000
         ST    @15,@TF00001                                        0483 01355000
         ALR   @15,@14                                             0483 01356000
         AL    @15,@CF00843                                        0483 01357000
         MVC   PREVCPU(1),TRENCPUS-3(@15)                          0483 01358000
         NI    PREVCPU,X'F0'                                       0483 01359000
*    PREVDEV = TRENDDEV(I);               /* DEVICE          @Z427VLS*/ 01360000
         LR    @15,@14                                             0484 01361000
         AL    @15,@TF00001                                        0484 01362000
         AL    @15,@CF00835                                        0484 01363000
         MVC   PREVDEV(2),TRENDDEV-6(@15)                          0484 01364000
*    PREVCUA = TRENDRT(I) & 'FFF0'X;      /* CUA             @Z427VLS*/ 01365000
         LR    @15,@14                                             0485 01366000
         AL    @15,@TF00001                                        0485 01367000
         AL    @15,@CF00842                                        0485 01368000
         MVC   PREVCUA(2),TRENDRT-1(@15)                           0485 01369000
         NC    PREVCUA(2),@CB00760                                 0485 01370000
*    PREV37  = TRENDITM(I) & 'F0'X;       /* 3705 FLAG       @Z427VLS*/ 01371000
         AL    @14,@TF00001                                        0486 01372000
         AL    @14,@CF00844                                        0486 01373000
         MVC   PREV37(1),TRENDITM-4(@14)                           0486 01374000
         NI    PREV37,X'F0'                                        0486 01375000
*    CALL DODEVTYP;                      /* PRINT THE DEVICE TYPE   */  01376000
         BAL   @14,DODEVTYP                                        0487 01377000
*    DO UNTIL (I > SORTNUM | PREVGRP ^= TRENDGRP(I) |              0488 01378000
*              PREVDEV ^= TRENDDEV(I));                    /*@Z427VLS*/ 01379000
@DL00488 DS    0H                                                  0489 01380000
*      CALL DOCUA;              /* CREATE THE CUA            @Z427VLS*/ 01381000
         BAL   @14,DOCUA                                           0489 01382000
*      DO UNTIL (I > SORTNUM | PREVGRP ^= TRENDGRP(I) |            0490 01383000
*                PREVDEV ^= TRENDDEV(I) |                          0490 01384000
*                PREVCUA ^= (TRENDRT(I) & 'FFF0'X));       /*@Z427VLS*/ 01385000
@DL00490 DS    0H                                                  0491 01386000
*        CPUWORK = PREVCPU;                                /*@Z427VLS*/ 01387000
         MVC   CPUWORK(1),PREVCPU                                  0491 01388000
*        SRL (CPUWORK,FOUR);                               /*@Z427VLS*/ 01389000
         SLR   @15,@15                                             0492 01390000
         IC    @15,CPUWORK                                         0492 01391000
         SRL   @15,4                                               0492 01392000
         STC   @15,CPUWORK                                         0492 01393000
*        LABELCPU(CPU+1) = 1;        /* SET CPU INDICATOR    @Z427VLS*/ 01394000
         SLR   @01,@01                                             0493 01395000
         IC    @01,CPU                                             0493 01396000
         LA    @00,1                                               0493 01397000
         STC   @00,LABELCPU(@01)                                   0493 01398000
*        DO UNTIL (I > SORTNUM | PREVGRP ^= TRENDGRP(I) |          0494 01399000
*                  PREVDEV ^= TRENDDEV(I) |                        0494 01400000
*                  PREVCUA ^= (TRENDRT(I) & 'FFF0'X) |             0494 01401000
*                  PREVCPU ^= (TRENCPUS(I) & 'F0'X));      /*@Z427VLS*/ 01402000
@DL00494 DS    0H                                                  0495 01403000
*          J = TRENDITM(I);                                /*@Z427VLS*/ 01404000
         L     @15,I                                               0495 01405000
         MH    @15,@CH00484                                        0495 01406000
         L     @01,SORTADR(,R2)                                    0495 01407000
         AL    @01,@CF00844                                        0495 01408000
         SLR   @14,@14                                             0495 01409000
         IC    @14,TRENDITM-4(@15,@01)                             0495 01410000
         ST    @14,J                                               0495 01411000
*          SRL (J,FOUR);                                   /*@Z427VLS*/ 01412000
         SRL   @14,4                                               0496 01413000
         ST    @14,J                                               0496 01414000
*          CONTRLBL = TPLABEL(J+1);    /* 3705 LABELS.       @Z427VLS*/ 01415000
         L     @15,J                                               0497 01416000
         SLA   @15,3                                               0497 01417000
         LA    @14,TPLABEL(@15)                                    0497 01418000
         MVC   CONTRLBL(8),0(@14)                                  0497 01419000
*          DO UNTIL (I > SORTNUM | PREVGRP ^= TRENDGRP(I) |        0498 01420000
*                    PREVDEV ^= TRENDDEV(I) |                      0498 01421000
*                    PREVCUA ^= (TRENDRT(I) & 'FFF0'X) |           0498 01422000
*                    PREVCPU ^= (TRENCPUS(I) & 'F0'X) |            0498 01423000
*                    PREV37 ^= (TRENDITM(I) & 'F0'X));     /*@Z427VLS*/ 01424000
@DL00498 DS    0H                                                  0499 01425000
*            CALL ACCUMERR;                                /*@Z427VLS*/ 01426000
         BAL   @14,ACCUMERR                                        0499 01427000
*          END;                                            /*@Z427VLS*/ 01428000
@DE00498 L     @15,I                                               0500 01429000
         C     @15,SORTNUM(,R2)                                    0500 01430000
         BH    @DC00498                                            0500 01431000
         MH    @15,@CH00484                                        0500 01432000
         L     @14,SORTADR(,R2)                                    0500 01433000
         LA    @01,0(@15,@14)                                      0500 01434000
         AL    @01,@CF00841                                        0500 01435000
         SLR   @00,@00                                             0500 01436000
         IC    @00,TRENDGRP(,@01)                                  0500 01437000
         CR    PREVGRP,@00                                         0500 01438000
         BNE   @DC00498                                            0500 01439000
         ST    @15,@TF00001                                        0500 01440000
         ALR   @15,@14                                             0500 01441000
         AL    @15,@CF00835                                        0500 01442000
         CLC   PREVDEV(2),TRENDDEV-6(@15)                          0500 01443000
         BNE   @DC00498                                            0500 01444000
         LR    @15,@14                                             0500 01445000
         AL    @15,@TF00001                                        0500 01446000
         AL    @15,@CF00842                                        0500 01447000
         MVC   @TS00001(2),TRENDRT-1(@15)                          0500 01448000
         NC    @TS00001(2),@CB00760                                0500 01449000
         CLC   PREVCUA(2),@TS00001                                 0500 01450000
         BNE   @DC00498                                            0500 01451000
         LR    @15,@14                                             0500 01452000
         AL    @15,@TF00001                                        0500 01453000
         AL    @15,@CF00843                                        0500 01454000
         MVC   @TS00001(1),TRENCPUS-3(@15)                         0500 01455000
         NI    @TS00001,X'F0'                                      0500 01456000
         CLC   PREVCPU(1),@TS00001                                 0500 01457000
         BNE   @DC00498                                            0500 01458000
         AL    @14,@TF00001                                        0500 01459000
         AL    @14,@CF00844                                        0500 01460000
         MVC   @TS00001(1),TRENDITM-4(@14)                         0500 01461000
         NI    @TS00001,X'F0'                                      0500 01462000
         CLC   PREV37(1),@TS00001                                  0500 01463000
         BE    @DL00498                                            0500 01464000
@DC00498 DS    0H                                                  0501 01465000
*          CALL OUTCUA;           /* OUTPUT THE CUA          @Z427VLS*/ 01466000
         BAL   @14,OUTCUA                                          0501 01467000
*          N3705OUT = ON;                                  /*@Z427VLS*/ 01468000
         OI    N3705OUT,B'00010000'                                0502 01469000
*          LINESPRT = LINESPRT + 7;                        /*@Z427VLS*/ 01470000
         LA    @15,7                                               0503 01471000
         AL    @15,LINESPRT                                        0503 01472000
         ST    @15,LINESPRT                                        0503 01473000
*          CALL CNVRTPRT;         /* OUTPUT THE ERROR LINES  @Z427VLS*/ 01474000
         BAL   @14,CNVRTPRT                                        0504 01475000
*          IF I ^> SORTNUM THEN                                    0505 01476000
         L     @15,I                                               0505 01477000
         C     @15,SORTNUM(,R2)                                    0505 01478000
         BH    @RF00505                                            0505 01479000
*            PREV37 = TRENDITM(I) & 'F0'X;                 /*@Z427VLS*/ 01480000
         MH    @15,@CH00484                                        0506 01481000
         L     @01,SORTADR(,R2)                                    0506 01482000
         ALR   @01,@15                                             0506 01483000
         AL    @01,@CF00844                                        0506 01484000
         MVC   PREV37(1),TRENDITM-4(@01)                           0506 01485000
         NI    PREV37,X'F0'                                        0506 01486000
*        END;                                              /*@Z427VLS*/ 01487000
@RF00505 DS    0H                                                  0507 01488000
@DE00494 L     @15,I                                               0507 01489000
         C     @15,SORTNUM(,R2)                                    0507 01490000
         BH    @DC00494                                            0507 01491000
         MH    @15,@CH00484                                        0507 01492000
         L     @14,SORTADR(,R2)                                    0507 01493000
         LA    @01,0(@15,@14)                                      0507 01494000
         AL    @01,@CF00841                                        0507 01495000
         SLR   @00,@00                                             0507 01496000
         IC    @00,TRENDGRP(,@01)                                  0507 01497000
         CR    PREVGRP,@00                                         0507 01498000
         BNE   @DC00494                                            0507 01499000
         ST    @15,@TF00001                                        0507 01500000
         ALR   @15,@14                                             0507 01501000
         AL    @15,@CF00835                                        0507 01502000
         CLC   PREVDEV(2),TRENDDEV-6(@15)                          0507 01503000
         BNE   @DC00494                                            0507 01504000
         LR    @15,@14                                             0507 01505000
         AL    @15,@TF00001                                        0507 01506000
         AL    @15,@CF00842                                        0507 01507000
         MVC   @TS00001(2),TRENDRT-1(@15)                          0507 01508000
         NC    @TS00001(2),@CB00760                                0507 01509000
         CLC   PREVCUA(2),@TS00001                                 0507 01510000
         BNE   @DC00494                                            0507 01511000
         AL    @14,@TF00001                                        0507 01512000
         AL    @14,@CF00843                                        0507 01513000
         MVC   @TS00001(1),TRENCPUS-3(@14)                         0507 01514000
         NI    @TS00001,X'F0'                                      0507 01515000
         CLC   PREVCPU(1),@TS00001                                 0507 01516000
         BE    @DL00494                                            0507 01517000
@DC00494 DS    0H                                                  0508 01518000
*        IF I ^> SORTNUM THEN                                      0508 01519000
         L     @15,I                                               0508 01520000
         C     @15,SORTNUM(,R2)                                    0508 01521000
         BH    @RF00508                                            0508 01522000
*          PREVCPU = TRENCPUS(I) & 'F0'X;                  /*@Z427VLS*/ 01523000
         MH    @15,@CH00484                                        0509 01524000
         L     @01,SORTADR(,R2)                                    0509 01525000
         ALR   @01,@15                                             0509 01526000
         AL    @01,@CF00843                                        0509 01527000
         MVC   PREVCPU(1),TRENCPUS-3(@01)                          0509 01528000
         NI    PREVCPU,X'F0'                                       0509 01529000
*      END;                                                /*@Z427VLS*/ 01530000
@RF00508 DS    0H                                                  0510 01531000
@DE00490 L     @15,I                                               0510 01532000
         C     @15,SORTNUM(,R2)                                    0510 01533000
         BH    @DC00490                                            0510 01534000
         MH    @15,@CH00484                                        0510 01535000
         L     @14,SORTADR(,R2)                                    0510 01536000
         LA    @01,0(@15,@14)                                      0510 01537000
         AL    @01,@CF00841                                        0510 01538000
         SLR   @00,@00                                             0510 01539000
         IC    @00,TRENDGRP(,@01)                                  0510 01540000
         CR    PREVGRP,@00                                         0510 01541000
         BNE   @DC00490                                            0510 01542000
         ST    @15,@TF00001                                        0510 01543000
         ALR   @15,@14                                             0510 01544000
         AL    @15,@CF00835                                        0510 01545000
         CLC   PREVDEV(2),TRENDDEV-6(@15)                          0510 01546000
         BNE   @DC00490                                            0510 01547000
         AL    @14,@TF00001                                        0510 01548000
         AL    @14,@CF00842                                        0510 01549000
         MVC   @TS00001(2),TRENDRT-1(@14)                          0510 01550000
         NC    @TS00001(2),@CB00760                                0510 01551000
         CLC   PREVCUA(2),@TS00001                                 0510 01552000
         BE    @DL00490                                            0510 01553000
@DC00490 DS    0H                                                  0511 01554000
*      IF I ^> SORTNUM THEN                                        0511 01555000
         L     @15,I                                               0511 01556000
         C     @15,SORTNUM(,R2)                                    0511 01557000
         BH    @RF00511                                            0511 01558000
*        PREVCUA = TRENDRT(I) & 'FFF0'X;                   /*@Z427VLS*/ 01559000
         MH    @15,@CH00484                                        0512 01560000
         L     @01,SORTADR(,R2)                                    0512 01561000
         ALR   @01,@15                                             0512 01562000
         AL    @01,@CF00842                                        0512 01563000
         MVC   PREVCUA(2),TRENDRT-1(@01)                           0512 01564000
         NC    PREVCUA(2),@CB00760                                 0512 01565000
*    END;                                                  /*@Z427VLS*/ 01566000
@RF00511 DS    0H                                                  0513 01567000
@DE00488 L     @15,I                                               0513 01568000
         C     @15,SORTNUM(,R2)                                    0513 01569000
         BH    @DC00488                                            0513 01570000
         MH    @15,@CH00484                                        0513 01571000
         L     @14,SORTADR(,R2)                                    0513 01572000
         LA    @01,0(@15,@14)                                      0513 01573000
         AL    @01,@CF00841                                        0513 01574000
         SLR   @00,@00                                             0513 01575000
         IC    @00,TRENDGRP(,@01)                                  0513 01576000
         CR    PREVGRP,@00                                         0513 01577000
         BNE   @DC00488                                            0513 01578000
         ALR   @14,@15                                             0513 01579000
         AL    @14,@CF00835                                        0513 01580000
         CLC   PREVDEV(2),TRENDDEV-6(@14)                          0513 01581000
         BE    @DL00488                                            0513 01582000
@DC00488 DS    0H                                                  0514 01583000
*    IF I ^> SORTNUM THEN                                          0514 01584000
         L     @15,I                                               0514 01585000
         C     @15,SORTNUM(,R2)                                    0514 01586000
         BH    @RF00514                                            0514 01587000
*      PREVDEV = TRENDDEV(I);                              /*@Z427VLS*/ 01588000
         MH    @15,@CH00484                                        0515 01589000
         L     @01,SORTADR(,R2)                                    0515 01590000
         ALR   @01,@15                                             0515 01591000
         AL    @01,@CF00835                                        0515 01592000
         MVC   PREVDEV(2),TRENDDEV-6(@01)                          0515 01593000
*  END;                                                    /*@Z427VLS*/ 01594000
@RF00514 DS    0H                                                  0516 01595000
@DE00482 L     @15,I                                               0516 01596000
         C     @15,SORTNUM(,R2)                                    0516 01597000
         BH    @DC00482                                            0516 01598000
         MH    @15,@CH00484                                        0516 01599000
         L     @01,SORTADR(,R2)                                    0516 01600000
         AL    @01,@CF00841                                        0516 01601000
         SLR   @14,@14                                             0516 01602000
         IC    @14,TRENDGRP(@15,@01)                               0516 01603000
         CR    PREVGRP,@14                                         0516 01604000
         BE    @DL00482                                            0516 01605000
@DC00482 DS    0H                                                  0517 01606000
*END;                                                      /*@Z427VLS*/ 01607000
@EL00014 DS    0H                                                  0517 01608000
@EF00014 DS    0H                                                  0517 01609000
@ER00014 LM    @14,@12,@SA00014                                    0517 01610000
         BR    @14                                                 0517 01611000
*/********************************************************************/ 01612000
*/*                                                          @Z427VLS*/ 01613000
*/* THIS PROC CONVERTS THE SUMMARIZED PERMANENT AND TEMPORARY ERROR  */ 01614000
*/* COUNT DATA TO EBCDIC FOR PRINTING AND THEN PRINTS BOTH LINES.    */ 01615000
*/*                                                          @Z427VLS*/ 01616000
*CNVRTPRT:  PROC;                                          /*@Z427VLS*/ 01617000
CNVRTPRT STM   @14,@12,@SA00015                                    0518 01618000
*  LINESPRT = LINESPRT + 2;   /* TOTAL NUMBER OF LINES TO PRINT      */ 01619000
         LA    @03,2                                               0519 01620000
         L     @15,LINESPRT                                        0519 01621000
         ALR   @15,@03                                             0519 01622000
         ST    @15,LINESPRT                                        0519 01623000
*  IF LINESPRT + MYLINECT => (LINECT - TWO) THEN                   0520 01624000
         AL    @15,MYLINECT                                        0520 01625000
         LCR   @03,@03                                             0520 01626000
         AH    @03,LINECT(,R2)                                     0520 01627000
         CR    @15,@03                                             0520 01628000
         BL    @RF00520                                            0520 01629000
*    DO;                                                   /*@Z427VLS*/ 01630000
*      SPACING = UPSPACE;    /* UPSPACE TO A NEW PAGE        @Z427VLS*/ 01631000
         MVI   SPACING,X'89'                                       0522 01632000
*      CALL HEADING1;                                      /*@Z427VLS*/ 01633000
         BAL   @14,HEADING1                                        0523 01634000
*      CALL HEADING2;                                      /*@Z427VLS*/ 01635000
         BAL   @14,HEADING2                                        0524 01636000
*      MYLINECT = FOUR;                                    /*@Z427VLS*/ 01637000
         MVC   MYLINECT(4),@CF00063                                0525 01638000
*    END;                                                  /*@Z427VLS*/ 01639000
*  LINESPRT = ZERO;                                        /*@Z427VLS*/ 01640000
@RF00520 SLR   @03,@03                                             0527 01641000
         ST    @03,LINESPRT                                        0527 01642000
*  IF GRPOUT = ON THEN                                             0528 01643000
         TM    GRPOUT,B'10000000'                                  0528 01644000
         BNO   @RF00528                                            0528 01645000
*    DO;                                                   /*@Z427VLS*/ 01646000
*      LABELLNE = GROUPLBL;   /* GROUP LABEL                 @Z427VLS*/ 01647000
         MVC   LABELLNE(8),GROUPLBL                                0530 01648000
*      CALL PRINT1;                                        /*@Z427VLS*/ 01649000
         BAL   @14,PRINT1                                          0531 01650000
*      GRPOUT = OFF;                                       /*@Z427VLS*/ 01651000
         NI    GRPOUT,B'01111111'                                  0532 01652000
*    END;                                                  /*@Z427VLS*/ 01653000
*  IF DEVOUT = ON THEN                                             0534 01654000
@RF00528 TM    DEVOUT,B'01000000'                                  0534 01655000
         BNO   @RF00534                                            0534 01656000
*    DO;                                                   /*@Z427VLS*/ 01657000
*      LABELLNE = CUDVDATA;   /* DEVICE LINE                 @Z427VLS*/ 01658000
         MVC   LABELLNE(8),CUDVDATA                                0536 01659000
*      CALL PRINT1;                                        /*@Z427VLS*/ 01660000
         BAL   @14,PRINT1                                          0537 01661000
*      DEVOUT = OFF;                                       /*@Z427VLS*/ 01662000
         NI    DEVOUT,B'10111111'                                  0538 01663000
*    END;                                                  /*@Z427VLS*/ 01664000
*  IF CUAOUT = ON THEN                                             0540 01665000
@RF00534 TM    CUAOUT,B'00100000'                                  0540 01666000
         BNO   @RF00540                                            0540 01667000
*    DO;                                                   /*@Z427VLS*/ 01668000
*      LABELLNE = CUALINE;    /* CUA CPU LINE                @Z427VLS*/ 01669000
         MVC   LABELLNE(8),CUALINE                                 0542 01670000
*      CALL PRINT1;                                        /*@Z427VLS*/ 01671000
         BAL   @14,PRINT1                                          0543 01672000
*      CUAOUT = OFF;                                       /*@Z427VLS*/ 01673000
         NI    CUAOUT,B'11011111'                                  0544 01674000
*    END;                                                  /*@Z427VLS*/ 01675000
*  IF N3705OUT = ON THEN                                           0546 01676000
@RF00540 TM    N3705OUT,B'00010000'                                0546 01677000
         BNO   @RF00546                                            0546 01678000
*    DO;                                                   /*@Z427VLS*/ 01679000
*      LABELLNE = CONTRLBL;   /* 3705 FLAG LINE              @Z427VLS*/ 01680000
         MVC   LABELLNE(8),CONTRLBL                                0548 01681000
*      CALL PRINT1;                                        /*@Z427VLS*/ 01682000
         BAL   @14,PRINT1                                          0549 01683000
*      N3705OUT = OFF;                                     /*@Z427VLS*/ 01684000
         NI    N3705OUT,B'11101111'                                0550 01685000
*    END;                                                  /*@Z427VLS*/ 01686000
*  DO J = 1 TO NUMDAYS;                                    /*@Z427VLS*/ 01687000
@RF00546 LA    @03,1                                               0552 01688000
         B     @DE00552                                            0552 01689000
@DL00552 DS    0H                                                  0553 01690000
*    BINWORD = PERMCT(J);    /* PERMANENT ERROR DATA TO BE CONVERTED.*/ 01691000
         SLA   @03,2                                               0553 01692000
         LA    @01,PERMCT-4(@03)                                   0553 01693000
         ICM   @00,15,0(@01)                                       0553 01694000
         ST    @00,BINWORD                                         0553 01695000
*    DECADDR = ADDR(PERM(J)) + 1; /*  WHERE - POSITION IN PRINT LINE.*/ 01696000
         LA    @03,PERM-4(@03)                                     0554 01697000
         AL    @03,@CF00054                                        0554 01698000
         ST    @03,DECADDR                                         0554 01699000
*    CALL CONVBIN;           /* CONVERT TO EBCDIC.           @Z427VLS*/ 01700000
         BAL   @14,CONVBIN                                         0555 01701000
*    BINWORD = TEMPCT(J);    /* TEMPORARY ERROR DATA TO BE CONVERTED.*/ 01702000
         L     @03,J                                               0556 01703000
         SLA   @03,2                                               0556 01704000
         LA    @01,TEMPCT-4(@03)                                   0556 01705000
         ICM   @00,15,0(@01)                                       0556 01706000
         ST    @00,BINWORD                                         0556 01707000
*    DECADDR = ADDR(TEMP(J)) + 1; /*  WHERE - POSITION IN PRINT LINE.*/ 01708000
         LA    @03,TEMP-4(@03)                                     0557 01709000
         AL    @03,@CF00054                                        0557 01710000
         ST    @03,DECADDR                                         0557 01711000
*    CALL CONVBIN;           /* CONVERT TO EBCDIC.           @Z427VLS*/ 01712000
         BAL   @14,CONVBIN                                         0558 01713000
*  END;                                                    /*@Z427VLS*/ 01714000
         LA    @03,1                                               0559 01715000
         AL    @03,J                                               0559 01716000
@DE00552 ST    @03,J                                               0559 01717000
         C     @03,NUMDAYS(,R2)                                    0559 01718000
         BNH   @DL00552                                            0559 01719000
*  HD2MOVE = PERMELNE;       /* MOVE PRINT LINE TO PRINT AREA.       */ 01720000
         MVC   HD2MOVE(128),PERMELNE                               0560 01721000
*  CALL PRINT1;              /* PRINT PERMANENT ERROR SUMMARY LINE.  */ 01722000
         BAL   @14,PRINT1                                          0561 01723000
*  HD2MOVE = TEMPELNE;       /* MOVE PRINT LINE TO PRINT AREA.       */ 01724000
         MVC   HD2MOVE(128),TEMPELNE                               0562 01725000
*  CALL PRINT1;              /* PRINT TEMPORARY ERROR SUMMARY LINE.  */ 01726000
         BAL   @14,PRINT1                                          0563 01727000
*  DO J = 1 TO 30;                                         /*@Z427VLS*/ 01728000
         LA    @03,1                                               0564 01729000
         ST    @03,J                                               0564 01730000
@DL00564 DS    0H                                                  0565 01731000
*    PERMCT(J) = ZERO;       /* CLEAR PERM COUNT TO ZERO     @Z427VLS*/ 01732000
         SLR   @15,@15                                             0565 01733000
         LR    @14,@03                                             0565 01734000
         SLA   @14,2                                               0565 01735000
         LA    @01,PERMCT-4(@14)                                   0565 01736000
         STCM  @15,15,0(@01)                                       0565 01737000
*    TEMPCT(J) = ZERO;       /* CLEAR TEMP COUNT TO ZERO     @Z427VLS*/ 01738000
         LA    @01,TEMPCT-4(@14)                                   0566 01739000
         STCM  @15,15,0(@01)                                       0566 01740000
*    CPULBL(J) = ' ';        /* CLEAR CPU LABELS TO BLANKS   @Z427VLS*/ 01741000
         LA    @01,CPULBL-1(@03)                                   0567 01742000
         MVI   0(@01),C' '                                         0567 01743000
*  END;                                                    /*@Z427VLS*/ 01744000
         AL    @03,@CF00054                                        0568 01745000
         ST    @03,J                                               0568 01746000
         C     @03,@CF00546                                        0568 01747000
         BNH   @DL00564                                            0568 01748000
*END;                                                      /*@Z427VLS*/ 01749000
@EL00015 DS    0H                                                  0569 01750000
@EF00015 DS    0H                                                  0569 01751000
@ER00015 LM    @14,@12,@SA00015                                    0569 01752000
         BR    @14                                                 0569 01753000
*/********************************************************************/ 01754000
*/*                                                          @Z427VLS*/ 01755000
*/* THIS PROC SETS UP LINKAGE TO ACCESS I/O SERVICE PRINT -  @Z427VLS*/ 01756000
*/*                                                          @Z427VLS*/ 01757000
*PRINT1:    PROC;                                          /*@Z427VLS*/ 01758000
PRINT1   STM   @14,@12,@SA00016                                    0570 01759000
*  CALL PRINT2;                                            /*@Z427VLS*/ 01760000
         BAL   @14,PRINT2                                          0571 01761000
*  MYLINECT = MYLINECT + LNESPACE;          /* BUMP LINE COUNTER     */ 01762000
         L     @03,MYLINECT                                        0572 01763000
         AL    @03,LNESPACE                                        0572 01764000
         ST    @03,MYLINECT                                        0572 01765000
*      IF MYLINECT => (LINECT-TWO) &  /* IF PAGE OVERFLOW AND @0001VLS* 01766000
*         I ^> SORTNUM THEN           /* NOT LAST RCD, PRINT  @0001VLS* 01767000
         LH    @15,LINECT(,R2)                                     0573 01768000
         BCTR  @15,0                                               0573 01769000
         BCTR  @15,0                                               0573 01770000
         CR    @03,@15                                             0573 01771000
         BL    @RF00573                                            0573 01772000
         L     @03,I                                               0573 01773000
         C     @03,SORTNUM(,R2)                                    0573 01774000
         BH    @RF00573                                            0573 01775000
*    DO;                                    /* DAY HEADING - NEXT PG.*/ 01776000
*      SPACING = UPSPACE;                                  /*@Z427VLS*/ 01777000
         MVI   SPACING,X'89'                                       0575 01778000
*      CALL HEADING1;                                      /*@Z427VLS*/ 01779000
         BAL   @14,HEADING1                                        0576 01780000
*      CALL HEADING2;                                      /*@Z427VLS*/ 01781000
         BAL   @14,HEADING2                                        0577 01782000
*      MYLINECT = FOUR;                     /* CLEAR LINE COUNTER    */ 01783000
         MVC   MYLINECT(4),@CF00063                                0578 01784000
*    END;                                                  /*@Z427VLS*/ 01785000
*END;                                                      /*@Z427VLS*/ 01786000
@EL00016 DS    0H                                                  0580 01787000
@EF00016 DS    0H                                                  0580 01788000
@ER00016 LM    @14,@12,@SA00016                                    0580 01789000
         BR    @14                                                 0580 01790000
*/********************************************************************/ 01791000
*/*                                                          @Z427VLS*/ 01792000
*/* WRITE TO THE PRINTER                                     @Z427VLS*/ 01793000
*/*                                                          @Z427VLS*/ 01794000
*PRINT2:    PROC;                                          /*@Z427VLS*/ 01795000
PRINT2   STM   @14,@12,@SA00017                                    0581 01796000
*  PRINTADR = ADDR(PRINTLNE);               /* LINE TO BE PRINTED    */ 01797000
         LA    @03,PRINTLNE                                        0582 01798000
         ST    @03,PRINTADR(,R2)                                   0582 01799000
*  CALL IOHND(RITEPRTR);                    /* PRINT IT      @Z427VLS*/ 01800000
         L     @15,ADIOHND(,R2)                                    0583 01801000
         LA    @01,@AL00583                                        0583 01802000
         BALR  @14,@15                                             0583 01803000
*END;                                                      /*@Z427VLS*/ 01804000
@EL00017 DS    0H                                                  0584 01805000
@EF00017 DS    0H                                                  0584 01806000
@ER00017 LM    @14,@12,@SA00017                                    0584 01807000
         BR    @14                                                 0584 01808000
*/********************************************************************/ 01809000
*/*                                                          @Z427VLS*/ 01810000
*/* THIS PROC CONVERTS THE BINARY NUMBER IN ITEM BINWORD TO DISPLAY. */ 01811000
*/* IF THE CONVERTED NUMBER IS > THAN THE NUMBER OF DIGITS REQUESTED */ 01812000
*/* (IN ITEM BNDECNUM), A NINE IS PLACED IN EACH PRINT POSITION.     */ 01813000
*/* LEADING ZEROS ARE SUPPRESSED.                            @Z427VLS*/ 01814000
*/*                                                          @Z427VLS*/ 01815000
*CONVBIN:   PROC;                                          /*@Z427VLS*/ 01816000
CONVBIN  STM   @14,@12,@SA00018                                    0585 01817000
*  RESPECIFY (R8,R9) RESTRICTED;                           /*@Z427VLS*/ 01818000
*  R8 = BINWORD;             /* DATA TO BE CONVERTED.        @Z427VLS*/ 01819000
         L     R8,BINWORD                                          0587 01820000
*  GEN(CVD R8,DBLWORD);      /* CONVERT TO PACKED DECIMAL.   @Z427VLS*/ 01821000
         CVD R8,DBLWORD                                                 01822000
*  GEN(UNPK WORK(8),DBLWORD);   /* UNPACK CONVERTED NO.      @Z427VLS*/ 01823000
         UNPK WORK(8),DBLWORD                                           01824000
*  GEN(OI WORK+7,X'F0');     /* INSERT 'PLUS' SIGN.          @Z427VLS*/ 01825000
         OI WORK+7,X'F0'                                                01826000
*  SWITCH2 = OFF;            /* TURN OFF SWITCH.             @Z427VLS*/ 01827000
         NI    SWITCH2,B'11111011'                                 0591 01828000
*  DO L = 1 TO 7 WHILE (SWITCH2 = OFF);  /* SCAN NUMBER -    @Z427VLS*/ 01829000
         LA    @03,1                                               0592 01830000
         ST    @03,L                                               0592 01831000
@DL00592 TM    SWITCH2,B'00000100'                                 0592 01832000
         BNZ   @DC00592                                            0592 01833000
*    IF WORKOVER(L) = 'F0'X THEN                                   0593 01834000
         LA    @01,WORKOVER-1(@03)                                 0593 01835000
         CLI   0(@01),X'F0'                                        0593 01836000
         BNE   @RF00593                                            0593 01837000
*      WORKOVER(L) = '40'X;  /* SET LEADING 0'S TO BLANKS.   @Z427VLS*/ 01838000
         LA    @01,WORKOVER-1(@03)                                 0594 01839000
         MVI   0(@01),X'40'                                        0594 01840000
*    ELSE                                                          0595 01841000
*      SWITCH2 = ON;         /* TURN ON SWITCH TO TERMINATE LOOP     */ 01842000
         B     @RC00593                                            0595 01843000
@RF00593 OI    SWITCH2,B'00000100'                                 0595 01844000
*  END;                      /* WHEN 1ST NON-ZERO DIGIT FOUND.       */ 01845000
@RC00593 LA    @03,1                                               0596 01846000
         AL    @03,L                                               0596 01847000
         ST    @03,L                                               0596 01848000
         C     @03,@CF00082                                        0596 01849000
         BNH   @DL00592                                            0596 01850000
@DC00592 DS    0H                                                  0597 01851000
*  IF (10 - L) > BNDECNUM THEN                                     0597 01852000
         LA    @03,10                                              0597 01853000
         SL    @03,L                                               0597 01854000
         C     @03,BNDECNUM                                        0597 01855000
         BNH   @RF00597                                            0597 01856000
*    DO;                                                   /*@Z427VLS*/ 01857000
*      GEN(MVI WORKOVER,X'F9');          /* NUMBER TOO LARGE -       */ 01858000
         MVI WORKOVER,X'F9'                                             01859000
*      GEN(MVC WORKOVER+1(7),WORKOVER);  /* REPLACE WITH 9'S.        */ 01860000
         MVC WORKOVER+1(7),WORKOVER                                     01861000
*    END;                                                  /*@Z427VLS*/ 01862000
*  R8 = ADDR(WORKOVER) + (8-BNDECNUM);   /* ADDRESS - BEGIN. OF DATA.*/ 01863000
@RF00597 LA    R8,WORKOVER                                         0602 01864000
         L     @03,BNDECNUM                                        0602 01865000
         LA    @15,8                                               0602 01866000
         SLR   @15,@03                                             0602 01867000
         ALR   R8,@15                                              0602 01868000
*  R9 = BNDECNUM - ONE;                  /* NO. OF BYTES TO MOVE.    */ 01869000
         BCTR  @03,0                                               0603 01870000
         LR    R9,@03                                              0603 01871000
*  RESPECIFY (R6) RESTRICTED;                              /*@Z427VLS*/ 01872000
*  R6 = DECADDR;                         /* ADDRESS - DATA DESTINAT. */ 01873000
         L     R6,DECADDR                                          0605 01874000
*  GEN(EX R9,MVCINS);                    /* MOVE DATA.       @Z427VLS*/ 01875000
         EX R9,MVCINS                                                   01876000
*  GENERATE DATA;                                          /*@Z427VLS*/ 01877000
*  RESPECIFY (R6) UNRESTRICTED;                            /*@Z427VLS*/ 01878000
*END;                                                      /*@Z427VLS*/ 01879000
@EL00018 DS    0H                                                  0609 01880000
@EF00018 DS    0H                                                  0609 01881000
@ER00018 LM    @14,@12,@SA00018                                    0609 01882000
         BR    @14                                                 0609 01883000
*/********************************************************************/ 01884000
*/*                                                          @Z427VLS*/ 01885000
*/* THIS PROC CONVERTS HEX DATA TO DISPLAY.                  @Z427VLS*/ 01886000
*/* TO SUPPRESS CONVERSION OF LEFT-MOST HALF OF HIGH ORDER BYTE,     */ 01887000
*/* USER SHOULD SET SWITCH1 ON.                              @Z427VLS*/ 01888000
*/*                                                          @Z427VLS*/ 01889000
*CONVERT:   PROC;                                          /*@Z427VLS*/ 01890000
CONVERT  STM   @14,@12,12(@13)                                     0610 01891000
*  RESPECIFY (R8,R9) RESTRICTED;                           /*@Z427VLS*/ 01892000
*  DO P = NUMBER BY -1 TO 1; /* NUMBER OF BYTES TO CONVERT.  @Z427VLS*/ 01893000
         L     @03,NUMBER                                          0612 01894000
         ST    @03,P                                               0612 01895000
         B     @DE00612                                            0612 01896000
@DL00612 DS    0H                                                  0613 01897000
*    R8 = NEXTBYTE(P);       /* NEXT BYTE TO CONVERT.        @Z427VLS*/ 01898000
         L     @01,NEXTBY                                          0613 01899000
         BCTR  @01,0                                               0613 01900000
         SLR   R8,R8                                               0613 01901000
         IC    R8,NEXTBYTE(@03,@01)                                0613 01902000
*    X =  TWO * P;           /* OUTPUT INDEX MUST BE TWICE INPUT.    */ 01903000
         LR    @15,@03                                             0614 01904000
         ALR   @15,@15                                             0614 01905000
         ST    @15,X                                               0614 01906000
*    SRDL  (R8,FOUR);        /* MOVE 1/2 BYTE INTO NEXT REGISTER.    */ 01907000
         SRDL  R8,4                                                0615 01908000
*    SRL   (R9,TWOEIGHT);    /* SHIFT TO LOW END.            @Z427VLS*/ 01909000
         SRL   R9,28                                               0616 01910000
*    R9 = R9 + NUMBER1;                                    /*@Z427VLS*/ 01911000
         LA    @15,1                                               0617 01912000
         ALR   R9,@15                                              0617 01913000
*    R8 = R8 + NUMBER1;                                    /*@Z427VLS*/ 01914000
         ALR   R8,@15                                              0618 01915000
*    IF SWITCH1 = ON & P = ONE THEN    /* IF HIGH ORDER BYTE AND NO  */ 01916000
         TM    SWITCH1,B'00001000'                                 0619 01917000
         BNO   @RF00619                                            0619 01918000
         CR    @03,@15                                             0619 01919000
         BNE   @RF00619                                            0619 01920000
*      SWITCH1 = OFF;                  /* LEFT-HALF CONVERSION, TURN */ 01921000
         NI    SWITCH1,B'11110111'                                 0620 01922000
*                                      /* OFF SWITCH.        @Z427VLS*/ 01923000
*    ELSE                                                          0621 01924000
*      ADDNUM(X-ONE) = CHARS(R8);      /* PUT PRINT CHAR. INTO OUTPUT*/ 01925000
         B     @RC00619                                            0621 01926000
@RF00619 L     @03,ADDNXT                                          0621 01927000
         AL    @03,X                                               0621 01928000
         BCTR  @03,0                                               0621 01929000
         BCTR  @03,0                                               0621 01930000
         LA    @01,CHARS-1(R8)                                     0621 01931000
         MVC   ADDNUM(1,@03),0(@01)                                0621 01932000
*      ADDNUM(X) = CHARS(R9);          /* FINISH BYTE.       @Z427VLS*/ 01933000
@RC00619 L     @03,ADDNXT                                          0622 01934000
         AL    @03,X                                               0622 01935000
         BCTR  @03,0                                               0622 01936000
         LA    @01,CHARS-1(R9)                                     0622 01937000
         MVC   ADDNUM(1,@03),0(@01)                                0622 01938000
*  END;                                                    /*@Z427VLS*/ 01939000
         SLR   @03,@03                                             0623 01940000
         BCTR  @03,0                                               0623 01941000
         AL    @03,P                                               0623 01942000
         ST    @03,P                                               0623 01943000
@DE00612 LTR   @03,@03                                             0623 01944000
         BP    @DL00612                                            0623 01945000
*END;                                                      /*@Z427VLS*/ 01946000
@EL00019 DS    0H                                                  0624 01947000
@EF00019 DS    0H                                                  0624 01948000
@ER00019 LM    @14,@12,12(@13)                                     0624 01949000
         BR    @14                                                 0624 01950000
*END  /* CLOSING END TO IFCTREND                             @Z427VLS*/ 01951000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 01952000
*/*%INCLUDE SYSLIB  (COMTABLE)                                        * 01953000
*;                                                                 0625 01954000
@DATA    DS    0H                                                       01955000
@CH00080 DC    H'6'                                                     01956000
@CH00548 DC    H'13'                                                    01957000
@CH00484 DC    H'14'                                                    01958000
@CH00708 DC    H'76'                                                    01959000
         DS    0F                                                       01960000
@AL00583 DC    A(@CF00073+2)           LIST WITH   1 ARGUMENT(S)        01961000
         DS    0F                                                       01962000
@SA00001 DS    18F                                                      01963000
@SA00017 DS    15F                                                      01964000
@SA00004 DS    15F                                                      01965000
@SA00002 DS    15F                                                      01966000
@SA00003 DS    15F                                                      01967000
@SA00005 DS    15F                                                      01968000
@SA00006 DS    15F                                                      01969000
@SA00008 DS    15F                                                      01970000
@SA00018 DS    15F                                                      01971000
@SA00016 DS    15F                                                      01972000
@SA00014 DS    15F                                                      01973000
@SA00011 DS    15F                                                      01974000
@SA00012 DS    15F                                                      01975000
@SA00015 DS    15F                                                      01976000
@TF00001 DS    F                                                        01977000
         DS    0F                                                       01978000
@CF00054 DC    F'1'                                                     01979000
@CF00073 DC    F'2'                                                     01980000
@CF00075 DC    F'3'                                                     01981000
@CF00063 DC    F'4'                                                     01982000
@CF00078 DC    F'5'                                                     01983000
@CF00082 DC    F'7'                                                     01984000
@CF00065 DC    F'8'                                                     01985000
@CF00088 DC    F'16'                                                    01986000
@CF00625 DC    F'19'                                                    01987000
@CH00625 EQU   @CF00625+2                                               01988000
@CF00680 DC    F'27'                                                    01989000
@CF00546 DC    F'30'                                                    01990000
@CH00546 EQU   @CF00546+2                                               01991000
@CF00701 DC    F'365'                                                   01992000
@CF00703 DC    F'366'                                                   01993000
@CF00840 DC    F'-72'                                                   01994000
@CF00822 DC    F'-60'                                                   01995000
@CF00823 DC    F'-56'                                                   01996000
@CF00824 DC    F'-52'                                                   01997000
@CF00825 DC    F'-48'                                                   01998000
@CF00826 DC    F'-44'                                                   01999000
@CF00827 DC    F'-40'                                                   02000000
@CF00828 DC    F'-36'                                                   02001000
@CF00829 DC    F'-32'                                                   02002000
@CF00830 DC    F'-28'                                                   02003000
@CF00831 DC    F'-24'                                                   02004000
@CF00832 DC    F'-20'                                                   02005000
@CF00833 DC    F'-16'                                                   02006000
@CF00841 DC    F'-14'                                                   02007000
@CF00842 DC    F'-13'                                                   02008000
@CF00834 DC    F'-12'                                                   02009000
@CF00843 DC    F'-11'                                                   02010000
@CF00844 DC    F'-10'                                                   02011000
@CF00845 DC    F'-9'                                                    02012000
@CF00835 DC    F'-8'                                                    02013000
@CF00846 DC    F'-6'                                                    02014000
@CF00836 DC    F'-4'                                                    02015000
         DS    0D                                                       02016000
NEXTBY   DC    F'0'                                                     02017000
ADDNXT   DC    F'0'                                                     02018000
LINESPRT DC    F'0'                                                     02019000
NUMBER   DC    F'0'                                                     02020000
L        DC    F'0'                                                     02021000
MYLINECT DC    F'0'                                                     02022000
P        DC    F'0'                                                     02023000
X        DC    F'0'                                                     02024000
LNESPACE DC    F'0'                                                     02025000
I        DC    F'0'                                                     02026000
BINWORD  DC    F'0'                                                     02027000
BNDECNUM DC    F'3'                                                     02028000
DECADDR  DC    F'0'                                                     02029000
SAVEPTR  DC    F'0'                                                     02030000
J        DC    F'0'                                                     02031000
K        DC    F'1'                                                     02032000
NUMCPUS  DC    F'0'                                                     02033000
BINYR    DC    F'0'                                                     02034000
M        DC    F'0'                                                     02035000
BYTECT   DC    F'0'                                                     02036000
Z1       DC    F'0'                                                     02037000
Q        DC    F'0'                                                     02038000
Z2       DC    F'0'                                                     02039000
RETCODE  DC    H'0'                                                     02040000
         DS    0D                                                       02041000
@TS00001 DS    CL8                                                      02042000
@CB00749 DC    X'404040F0'                                              02043000
@CB00208 DC    X'0000'                                                  02044000
@CB00760 DC    X'FFF0'                                                  02045000
PRINTLNE DS    CL134                                                    02046000
         ORG   PRINTLNE                                                 02047000
DDTYPE   DC    CL1'0'                                                   02048000
SPACING  DC    X'89'                                                    02049000
PRTLINE  DC    CL132' '                                                 02050000
         ORG   PRINTLNE+134                                             02051000
HEAD1    DC    CL171' '                                                 02052000
         ORG   HEAD1                                                    02053000
LINE1    DS    CL57                                                     02054000
         ORG   LINE1                                                    02055000
@NM00012 DC    CL25'T R E N D S   R E P O R T'                          02056000
@NM00013 DC    CL14' '                                                  02057000
@NM00014 DC    CL12'REPORT DATE '                                       02058000
DAYSDATE DC    CL6'XXX XX'                                              02059000
         ORG   HEAD1+57                                                 02060000
LINE2    DS    CL57                                                     02061000
         ORG   LINE2                                                    02062000
@NM00015 DC    CL17'         (PART 1)'                                  02063000
@NM00016 DC    CL22' '                                                  02064000
@NM00017 DC    CL12'PERIOD FROM '                                       02065000
FROMDATE DS    CL3                                                      02066000
@NM00018 DC    CL1' '                                                   02067000
FROMYEAR DS    CL2                                                      02068000
         ORG   HEAD1+114                                                02069000
LINE3    DS    CL57                                                     02070000
         ORG   LINE3                                                    02071000
@NM00019 DC    CL24' CPU/CHANNEL/STORAGE/SCP'                           02072000
@NM00020 DC    CL22' '                                                  02073000
@NM00021 DC    CL5'TO   '                                               02074000
TODATE   DS    CL3                                                      02075000
@NM00022 DC    CL1' '                                                   02076000
TOYEAR   DS    CL2                                                      02077000
         ORG   HEAD1+171                                                02078000
CPULINE  DC    CL24'CPU   MODEL   SERIAL NO.'                           02079000
CPUDATA  DC    CL20' '                                                  02080000
         ORG   CPUDATA                                                  02081000
@NM00023 DC    CL1' '                                                   02082000
CPUTYPE  DS    CL1                                                      02083000
@NM00024 DC    CL5' '                                                   02084000
CPUMODEL DS    CL3                                                      02085000
@NM00025 DC    CL4' '                                                   02086000
CPUSERAL DS    CL6                                                      02087000
         ORG   CPUDATA+20                                               02088000
HEAD2    DC    CL256' '                                                 02089000
         ORG   HEAD2                                                    02090000
LN1      DS    CL128                                                    02091000
         ORG   LN1                                                      02092000
@NM00026 DC    CL10' JULIAN   '                                         02093000
JYEAR    DS    CL2                                                      02094000
@NM00027 DC    CL116' '                                                 02095000
         ORG   HEAD2+128                                                02096000
LN2      DS    CL128                                                    02097000
         ORG   LN2                                                      02098000
@NM00028 DC    CL8'   DAY  '                                            02099000
DAYNO    DC    CL4' '                                                   02100000
         DS    29XL4                                                    02101000
         ORG   HEAD2+256                                                02102000
HEAD3    DC    CL256' '                                                 02103000
         ORG   HEAD3                                                    02104000
LIN1     DS    CL128                                                    02105000
         ORG   LIN1                                                     02106000
DSCRPT   DS    CL17                                                     02107000
@NM00029 DC    CL111' '                                                 02108000
         ORG   HEAD3+128                                                02109000
LIN2     DS    CL128                                                    02110000
         ORG   LIN2                                                     02111000
@NM00030 DC    CL6'  CPU '                                              02112000
@NM00031 DC    CL1' '                                                   02113000
LETTER   DC    CL1'X'                                                   02114000
ERCNT    DC    CL4' '                                                   02115000
         DS    29XL4                                                    02116000
         ORG   HEAD3+256                                                02117000
SWITCHE  DC    AL1(0)                                                   02118000
         ORG   SWITCHE                                                  02119000
GRPOUT   DS    BL1                                                      02120000
DEVOUT   EQU   SWITCHE+0                                                02121000
CUAOUT   EQU   SWITCHE+0                                                02122000
N3705OUT EQU   SWITCHE+0                                                02123000
SWITCH1  EQU   SWITCHE+0                                                02124000
SWITCH2  EQU   SWITCHE+0                                                02125000
         ORG   SWITCHE+1                                                02126000
CHARS    DC    CL16'0123456789ABCDEF'                                   02127000
SAVEDAY  DC    CL2' '                                                   02128000
SAVEYR   DC    CL2' '                                                   02129000
         DS    CL6                                                      02130000
WORK     DS    CL8                                                      02131000
HEAD1P2  DC    CL102' '                                                 02132000
         ORG   HEAD1P2                                                  02133000
LINE2P2  DS    CL51                                                     02134000
         ORG   LINE2P2                                                  02135000
@NM00032 DC    CL17'         (PART 2)'                                  02136000
@NM00033 DS    CL22                                                     02137000
@NM00034 DC    CL12'PERIOD FROM '                                       02138000
         ORG   HEAD1P2+51                                               02139000
LINE3P2  DS    CL51                                                     02140000
         ORG   LINE3P2                                                  02141000
@NM00035 DC    CL24'     I/O SUBSYSTEM      '                           02142000
@NM00036 DS    CL22                                                     02143000
@NM00037 DC    CL5'TO   '                                               02144000
         ORG   HEAD1P2+102                                              02145000
GROUPLBL DC    CL8' '                                                   02146000
CUDVDATA DC    CL8' '                                                   02147000
         ORG   CUDVDATA                                                 02148000
CUDEV    DC    CL4' '                                                   02149000
@NM00038 DS    CL4                                                      02150000
         ORG   CUDVDATA+8                                               02151000
CUALINE  DC    CL128' '                                                 02152000
         ORG   CUALINE                                                  02153000
CUADATA  DS    CL3                                                      02154000
@NM00039 DS    CL2                                                      02155000
CPULBL   DC    CL1' '                                                   02156000
         DS    29XL1                                                    02157000
         ORG   CUALINE+128                                              02158000
         DS    CL2                                                      02159000
ERSUMLNE DC    CL256' '                                                 02160000
         ORG   ERSUMLNE                                                 02161000
PERMELNE DS    CL128                                                    02162000
         ORG   PERMELNE                                                 02163000
@NM00040 DC    CL8'  PERM  '                                            02164000
PERM     DC    CL4' '                                                   02165000
         DS    29XL4                                                    02166000
         ORG   ERSUMLNE+128                                             02167000
TEMPELNE DS    CL128                                                    02168000
         ORG   TEMPELNE                                                 02169000
@NM00041 DC    CL8'  TEMP  '                                            02170000
TEMP     DC    CL4' '                                                   02171000
         DS    29XL4                                                    02172000
         ORG   ERSUMLNE+256                                             02173000
UKNO     DC    CL4'UKNO'                                                02174000
CONTRLBL DC    CL8' '                                                   02175000
PREVCUA  DS    BL2                                                      02176000
PREV37   DS    CL1                                                      02177000
PREVCPU  DS    BL1                                                      02178000
PREVDEV  DS    CL2                                                      02179000
SAVECUA  DS    BL2                                                      02180000
CPUWORK  DS    BL1                                                      02181000
NEWSW    DC    X'00'                                                    02182000
         ORG   NEWSW                                                    02183000
FOUND    DS    BL1                                                      02184000
OUTSWTCH EQU   NEWSW+0                                                  02185000
         ORG   NEWSW+1                                                  02186000
NOFOUND  DC    CL29'NO ERRORS FOUND FOR THIS CPU'                       02187000
CHAN     DC    CL4'CHAN'                                                02188000
ZCPU     DC    CL3'CPU'                                                 02189000
         DS    CL6                                                      02190000
DBLWORD  DS    CL8                                                      02191000
OLDWORK  DS    BL1                                                      02192000
SUPERZAP DC    3CL10'SUPERZAP'                                          02193000
DEVGROUP DC    CL8'CONS+UR '                                            02194000
         DC    CL8'DASD    '                                            02195000
         DC    CL8'TAPE    '                                            02196000
         DC    CL8'DISPLAY '                                            02197000
         DC    CL8'TP CNTRL'                                            02198000
         DC    CL8'TERMINAL'                                            02199000
DESCRIPT DC    CL13'IPL          '                                      02200000
         DC    CL13'MACHINE CHECK'                                      02201000
         DC    CL13'CHANNEL CHECK'                                      02202000
         DC    CL13'PROGRAM ERROR'                                      02203000
         DS    CL1                                                      02204000
PATCH    DC    30F'0'                                                   02205000
TPLABEL  DC    CL8'  CNTRLR'                                            02206000
         DC    CL8'  NCP   '                                            02207000
         DC    CL8'  LINES '                                            02208000
LABELCPU DC    16AL1(0)                                                 02209000
TREND6   DC    480F'0'                                                  02210000
CHANZ    DC    CL6' CHN-0'                                              02211000
         DC    CL6' CHN-1'                                              02212000
         DC    CL6' CHN-2'                                              02213000
         DC    CL6' CHN-3'                                              02214000
         DC    CL6' CHN-4'                                              02215000
         DC    CL6' CHN-5'                                              02216000
         DC    CL6' CHN-6'                                              02217000
         DC    CL6' CHN-7'                                              02218000
         DC    CL6' CHN-8'                                              02219000
         DC    CL6' CHN-9'                                              02220000
         DC    CL6' CHN-A'                                              02221000
         DC    CL6' CHN-B'                                              02222000
         DC    CL6' CHN-C'                                              02223000
         DC    CL6' CHN-D'                                              02224000
         DC    CL6' CHN-E'                                              02225000
         DC    CL6' CHN-F'                                              02226000
IFCTREND CSECT                                                          02227000
         DC    S(SUPERZAP)                                              02228000
IFCTREND CSECT                                                          02229000
    DC  S(PATCH)                                                        02230000
IFCTREND CSECT                                                          02231000
MVCINS  MVC  R0(R0,R6),0(R8)                                            02232000
IFCTREND CSECT                                                          02233000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02234000
@01      EQU   01                                                       02235000
@02      EQU   02                                                       02236000
@03      EQU   03                                                       02237000
@04      EQU   04                                                       02238000
@05      EQU   05                                                       02239000
@06      EQU   06                                                       02240000
@07      EQU   07                                                       02241000
@08      EQU   08                                                       02242000
@09      EQU   09                                                       02243000
@10      EQU   10                                                       02244000
@11      EQU   11                                                       02245000
@12      EQU   12                                                       02246000
@13      EQU   13                                                       02247000
@14      EQU   14                                                       02248000
@15      EQU   15                                                       02249000
PREVGRP  EQU   @03                                                      02250000
R2       EQU   @02                                                      02251000
R6       EQU   @06                                                      02252000
R8       EQU   @08                                                      02253000
R9       EQU   @09                                                      02254000
R12      EQU   @12                                                      02255000
R15      EQU   @15                                                      02256000
R0       EQU   @00                                                      02257000
R1       EQU   @01                                                      02258000
R10      EQU   @10                                                      02259000
R11      EQU   @11                                                      02260000
R13      EQU   @13                                                      02261000
R14      EQU   @14                                                      02262000
R3       EQU   @03                                                      02263000
R4       EQU   @04                                                      02264000
R5       EQU   @05                                                      02265000
R7       EQU   @07                                                      02266000
IOHND    EQU   0                                                        02267000
PARM     EQU   0                                                        02268000
RECTYPE  EQU   PARM                                                     02269000
SWITCHES EQU   PARM+2                                                   02270000
DEBUG    EQU   PARM+4                                                   02271000
DEBUG4   EQU   DEBUG                                                    02272000
DEBUG12  EQU   DEBUG+1                                                  02273000
DEBUG21  EQU   DEBUG+2                                                  02274000
DEBUGA   EQU   PARM+8                                                   02275000
DEBUG51  EQU   DEBUGA+2                                                 02276000
MISC     EQU   PARM+12                                                  02277000
PRINTES  EQU   MISC                                                     02278000
OPENCLSE EQU   PARM+13                                                  02279000
OPENIO   EQU   OPENCLSE                                                 02280000
CLOSEIO  EQU   OPENCLSE+2                                               02281000
DATENOW  EQU   PARM+17                                                  02282000
STDT     EQU   PARM+23                                                  02283000
STDATE   EQU   STDT                                                     02284000
PSTD     EQU   STDATE+1                                                 02285000
PSTYR    EQU   PSTD                                                     02286000
PSTDY    EQU   PSTD+1                                                   02287000
ENDDT    EQU   PARM+31                                                  02288000
ENDDATE  EQU   ENDDT                                                    02289000
PEND     EQU   ENDDATE+1                                                02290000
PENYR    EQU   PEND                                                     02291000
STTIME1  EQU   PARM+39                                                  02292000
ENDTIME1 EQU   PARM+43                                                  02293000
STTIME2  EQU   PARM+47                                                  02294000
ENDTIME2 EQU   PARM+51                                                  02295000
STRTDATE EQU   PARM+55                                                  02296000
EVSYEAR  EQU   STRTDATE                                                 02297000
EVSDAY   EQU   STRTDATE+1                                               02298000
@NM00006 EQU   PARM+72                                                  02299000
@NM00007 EQU   PARM+75                                                  02300000
SORTNUM  EQU   PARM+84                                                  02301000
NUMDAYS  EQU   PARM+88                                                  02302000
ERRID    EQU   PARM+92                                                  02303000
IDTIMEA  EQU   ERRID+6                                                  02304000
IDTIME   EQU   IDTIMEA                                                  02305000
CCHHRLNG EQU   PARM+112                                                 02306000
LINECT   EQU   PARM+120                                                 02307000
ADIOHND  EQU   PARM+124                                                 02308000
ADIFCMSG EQU   PARM+128                                                 02309000
ADEDITB  EQU   PARM+132                                                 02310000
EVPTR    EQU   PARM+136                                                 02311000
SORTADR  EQU   PARM+140                                                 02312000
PRINTADR EQU   PARM+148                                                 02313000
CUAPTR   EQU   PARM+152                                                 02314000
DEVPTR   EQU   PARM+156                                                 02315000
MODPTR   EQU   PARM+160                                                 02316000
SERPTR   EQU   PARM+164                                                 02317000
VOLPTR   EQU   PARM+168                                                 02318000
CPUPTR   EQU   PARM+172                                                 02319000
CPCUAPTR EQU   PARM+176                                                 02320000
LIBADPTR EQU   PARM+180                                                 02321000
SYMCDPTR EQU   PARM+184                                                 02322000
SYSUMPTR EQU   PARM+188                                                 02323000
TRENPTR  EQU   PARM+192                                                 02324000
SHAREPTR EQU   PARM+196                                                 02325000
MERDCPTR EQU   PARM+208                                                 02326000
DUMPTABL EQU   PARM+228                                                 02327000
DUMPINFO EQU   DUMPTABL+4                                               02328000
TRENDONE EQU   0                                                        02329000
TRENEXT  EQU   TRENDONE                                                 02330000
TREGEN   EQU   TRENDONE+8                                               02331000
TRECCH0  EQU   TREGEN+8                                                 02332000
TRECCH1  EQU   TREGEN+12                                                02333000
TRECCH2  EQU   TREGEN+16                                                02334000
TRECCH3  EQU   TREGEN+20                                                02335000
TRECCH4  EQU   TREGEN+24                                                02336000
TRECCH5  EQU   TREGEN+28                                                02337000
TRECCH6  EQU   TREGEN+32                                                02338000
TRECCH7  EQU   TREGEN+36                                                02339000
TRECCH8  EQU   TREGEN+40                                                02340000
TRECCH9  EQU   TREGEN+44                                                02341000
TRECCHA  EQU   TREGEN+48                                                02342000
TRECCHB  EQU   TREGEN+52                                                02343000
TRECCHC  EQU   TREGEN+56                                                02344000
TRECCHD  EQU   TREGEN+60                                                02345000
TRECCHE  EQU   TREGEN+64                                                02346000
TRECCHF  EQU   TREGEN+68                                                02347000
TREND2   EQU   0                                                        02348000
TRENDKEY EQU   TREND2                                                   02349000
TRENDGRP EQU   TRENDKEY                                                 02350000
TRENDRT  EQU   TRENDKEY+1                                               02351000
TRENCPUS EQU   TRENDKEY+3                                               02352000
TRENDITM EQU   TRENDKEY+4                                               02353000
TRENDDAT EQU   TRENDKEY+5                                               02354000
TRENDDEV EQU   TREND2+6                                                 02355000
TREPRM   EQU   TREND2+8                                                 02356000
TRETMP   EQU   TREND2+10                                                02357000
EVTABLE  EQU   0                                                        02358000
EVSTOP   EQU   EVTABLE                                                  02359000
EVYEAR   EQU   EVSTOP                                                   02360000
EVDAY    EQU   EVSTOP+1                                                 02361000
EVNUM    EQU   EVTABLE+4                                                02362000
EVKEY    EQU   EVTABLE+6                                                02363000
EVMODEL  EQU   EVKEY                                                    02364000
EVSERIAL EQU   EVKEY+2                                                  02365000
EVLETTER EQU   EVKEY+5                                                  02366000
SORTABLE EQU   0                                                        02367000
SORTKEY  EQU   SORTABLE                                                 02368000
SORTCCHR EQU   SORTABLE+5                                               02369000
SYSUMONE EQU   0                                                        02370000
SYSUM2   EQU   0                                                        02371000
SYSUMKEY EQU   SYSUM2                                                   02372000
SYSRT    EQU   SYSUMKEY+1                                               02373000
SYSCPUS  EQU   SYSUMKEY+3                                               02374000
SYSITEM  EQU   SYSUMKEY+4                                               02375000
SHARE    EQU   0                                                        02376000
SHAREIO  EQU   SHARE+2                                                  02377000
SHRBASE  EQU   SHAREIO+1                                                02378000
SHRCUCPU EQU   SHAREIO+8                                                02379000
EDITLOAD EQU   0                                                        02380000
EDITABLE EQU   EDITLOAD+4                                               02381000
CUA      EQU   0                                                        02382000
CUAVAL   EQU   CUA+2                                                    02383000
DEVICE   EQU   0                                                        02384000
MODELS   EQU   0                                                        02385000
DEVSERAL EQU   0                                                        02386000
VOLUME   EQU   0                                                        02387000
CPUS     EQU   0                                                        02388000
CPUCUAS  EQU   0                                                        02389000
CPUCUAV  EQU   CPUCUAS+2                                                02390000
LIBADR   EQU   0                                                        02391000
SYMCODE  EQU   0                                                        02392000
SYMVAL   EQU   SYMCODE+2                                                02393000
MERIDIAN EQU   0                                                        02394000
NEXTBYTE EQU   0                                                        02395000
ADDNUM   EQU   0                                                        02396000
IFCMSG   EQU   0                                                        02397000
HEADMOVE EQU   PRTLINE                                                  02398000
CPULINE1 EQU   PRTLINE                                                  02399000
HD2MOVE  EQU   PRTLINE                                                  02400000
HD3MOVE  EQU   PRTLINE                                                  02401000
WORKOVER EQU   WORK                                                     02402000
TREITM   EQU   TREGEN                                                   02403000
LABELLNE EQU   PRTLINE                                                  02404000
PERMCT   EQU   PERM                                                     02405000
TEMPCT   EQU   TEMP                                                     02406000
CUACONV  EQU   SAVECUA                                                  02407000
CPU      EQU   CPUWORK                                                  02408000
CHANID   EQU   LIN2+2                                                   02409000
TRECCH   EQU   TRECCH0                                                  02410000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02411000
MODEL    EQU   MERIDIAN+2                                               02412000
MRDNUMBR EQU   MERIDIAN                                                 02413000
SYMVAL2  EQU   SYMVAL+2                                                 02414000
SYMVAL1  EQU   SYMVAL                                                   02415000
SYMCDNUM EQU   SYMCODE                                                  02416000
LIBVAL   EQU   LIBADR+2                                                 02417000
LIBADNUM EQU   LIBADR                                                   02418000
CPUCUX3  EQU   CPUCUAV+5                                                02419000
CPUCUX2  EQU   CPUCUAV+3                                                02420000
CPUCUX1  EQU   CPUCUAV                                                  02421000
CPCUANUM EQU   CPUCUAS                                                  02422000
CPUVAL   EQU   CPUS+2                                                   02423000
CPUNUM   EQU   CPUS                                                     02424000
VOLVAL   EQU   VOLUME+2                                                 02425000
VOLNUM   EQU   VOLUME                                                   02426000
SERVAL   EQU   DEVSERAL+2                                               02427000
SERNUM   EQU   DEVSERAL                                                 02428000
MODVAL   EQU   MODELS+2                                                 02429000
MODNUM   EQU   MODELS                                                   02430000
MDRVAL   EQU   DEVICE+204                                               02431000
MDRNUM   EQU   DEVICE+202                                               02432000
DEVVAL   EQU   DEVICE+2                                                 02433000
DEVNUM   EQU   DEVICE                                                   02434000
CUA2     EQU   CUAVAL+2                                                 02435000
CUA1     EQU   CUAVAL                                                   02436000
CUANUM   EQU   CUA                                                      02437000
LOADPTR  EQU   EDITABLE+8                                               02438000
LOADNAME EQU   EDITABLE                                                 02439000
EDITNUM  EQU   EDITLOAD                                                 02440000
SHARLET  EQU   SHAREIO+15                                               02441000
SHRCUAAH EQU   SHRCUCPU+5                                               02442000
SHRCUAAL EQU   SHRCUCPU+3                                               02443000
SHARSERA EQU   SHRCUCPU                                                 02444000
SHRCUABH EQU   SHRBASE+5                                                02445000
SHRCUABL EQU   SHRBASE+3                                                02446000
SHARSERB EQU   SHRBASE                                                  02447000
SHAREFLG EQU   SHAREIO                                                  02448000
SHARENUM EQU   SHARE                                                    02449000
SYSTEMP  EQU   SYSUM2+10                                                02450000
SYSPERM  EQU   SYSUM2+8                                                 02451000
SYSRANGE EQU   SYSUM2+7                                                 02452000
SYSDEV   EQU   SYSUM2+5                                                 02453000
SYSOLDA  EQU   SYSITEM                                                  02454000
SYS3705  EQU   SYSITEM                                                  02455000
SYSOLD   EQU   SYSCPUS                                                  02456000
SYSCPU   EQU   SYSCPUS                                                  02457000
SYSTROLL EQU   SYSRT+1                                                  02458000
SYSSPAN  EQU   SYSRT+1                                                  02459000
SYSCUA   EQU   SYSRT                                                    02460000
SYSGROUP EQU   SYSUMKEY                                                 02461000
SYSUMEOD EQU   SYSUMONE+96                                              02462000
SYSUMPER EQU   SYSUMONE+92                                              02463000
SYSUMPEA EQU   SYSUMONE+88                                              02464000
SYSUMPEI EQU   SYSUMONE+84                                              02465000
SYSUMCH  EQU   SYSUMONE+20                                              02466000
SYSUMMCN EQU   SYSUMONE+16                                              02467000
SYSUMMCR EQU   SYSUMONE+12                                              02468000
SYSUMNXT EQU   SYSUMONE+8                                               02469000
SYSUMIPL EQU   SYSUMONE+4                                               02470000
SYSUMNUM EQU   SYSUMONE                                                 02471000
SORTCORE EQU   SORTCCHR                                                 02472000
SORTTIME EQU   SORTKEY+1                                                02473000
SORTYEAR EQU   SORTKEY                                                  02474000
TRENDOD  EQU   TRENDITM                                                 02475000
TREND037 EQU   TRENDITM                                                 02476000
TRENDOLD EQU   TRENCPUS                                                 02477000
TRENDCPU EQU   TRENCPUS                                                 02478000
@NM00011 EQU   TRENDRT+1                                                02479000
TRENDCUA EQU   TRENDRT                                                  02480000
TREPRE   EQU   TREGEN+72                                                02481000
TREMCH   EQU   TREGEN+4                                                 02482000
TREIPL   EQU   TREGEN                                                   02483000
TRENUM   EQU   TRENDONE+4                                               02484000
DUMPSIZE EQU   DUMPINFO+4                                               02485000
DUMPADR  EQU   DUMPINFO                                                 02486000
DUMPNUM  EQU   DUMPTABL                                                 02487000
@NM00010 EQU   PARM+212                                                 02488000
RECLNGT1 EQU   PARM+204                                                 02489000
FRAMEPTR EQU   PARM+200                                                 02490000
ADCPUT   EQU   PARM+144                                                 02491000
RECLNGTH EQU   CCHHRLNG+6                                               02492000
@NM00009 EQU   CCHHRLNG+5                                               02493000
RECCCHHR EQU   CCHHRLNG                                                 02494000
USERPGM  EQU   PARM+102                                                 02495000
IDTSEC   EQU   IDTIME+3                                                 02496000
IDSEC    EQU   IDTIME+2                                                 02497000
IDMIN    EQU   IDTIME+1                                                 02498000
IDHOUR   EQU   IDTIME                                                   02499000
IDASID   EQU   ERRID+4                                                  02500000
IDCPU    EQU   ERRID+3                                                  02501000
@NM00008 EQU   ERRID+2                                                  02502000
IDVALUE  EQU   ERRID                                                    02503000
TABSIZE  EQU   PARM+80                                                  02504000
SYSRETRN EQU   @NM00007                                                 02505000
NUMIN222 EQU   @NM00006                                                 02506000
WRTHRSH  EQU   PARM+69                                                  02507000
RDTHRSH  EQU   PARM+66                                                  02508000
TERM     EQU   PARM+58                                                  02509000
PENSEC2  EQU   ENDTIME2+2                                               02510000
PENMIN2  EQU   ENDTIME2+1                                               02511000
PENHOUR2 EQU   ENDTIME2                                                 02512000
PSTSEC2  EQU   STTIME2+2                                                02513000
PSTMIN2  EQU   STTIME2+1                                                02514000
PSTHOUR2 EQU   STTIME2                                                  02515000
PENSEC1  EQU   ENDTIME1+2                                               02516000
PENMIN1  EQU   ENDTIME1+1                                               02517000
PENHOUR1 EQU   ENDTIME1                                                 02518000
PSTSEC1  EQU   STTIME1+2                                                02519000
PSTMIN1  EQU   STTIME1+1                                                02520000
PSTHOUR1 EQU   STTIME1                                                  02521000
@NM00005 EQU   ENDDT+4                                                  02522000
PENDY    EQU   PEND+1                                                   02523000
@NM00004 EQU   ENDDATE                                                  02524000
@NM00003 EQU   STDT+4                                                   02525000
@NM00002 EQU   STDATE                                                   02526000
YEARNOW  EQU   DATENOW+4                                                02527000
@NM00001 EQU   DATENOW+3                                                02528000
DAYNOW   EQU   DATENOW                                                  02529000
CSNAP    EQU   CLOSEIO                                                  02530000
CDRCTWRK EQU   CLOSEIO                                                  02531000
CSYSIN   EQU   CLOSEIO                                                  02532000
CACCDEV  EQU   CLOSEIO                                                  02533000
CACCIN   EQU   CLOSEIO                                                  02534000
CSERLOG  EQU   CLOSEIO                                                  02535000
CEREPPT  EQU   CLOSEIO                                                  02536000
CTOURIST EQU   CLOSEIO                                                  02537000
OSNAP    EQU   OPENIO                                                   02538000
ODRCTWRK EQU   OPENIO                                                   02539000
OSYSIN   EQU   OPENIO                                                   02540000
OACCDEV  EQU   OPENIO                                                   02541000
OACCIN   EQU   OPENIO                                                   02542000
OSERLOG  EQU   OPENIO                                                   02543000
OEREPPT  EQU   OPENIO                                                   02544000
OTOURIST EQU   OPENIO                                                   02545000
PASSFLAG EQU   MISC                                                     02546000
PLOGREC  EQU   MISC                                                     02547000
ERRORID  EQU   MISC                                                     02548000
PSUM     EQU   PRINTES                                                  02549000
PEDIT    EQU   PRINTES                                                  02550000
PHIST    EQU   MISC                                                     02551000
PACC     EQU   MISC                                                     02552000
PZERO    EQU   MISC                                                     02553000
DEBUG63  EQU   DEBUGA+3                                                 02554000
DEBUG62  EQU   DEBUGA+3                                                 02555000
DEBUG61  EQU   DEBUGA+3                                                 02556000
DEBUG60  EQU   DEBUGA+3                                                 02557000
DEBUG59  EQU   DEBUGA+3                                                 02558000
DEBUG58  EQU   DEBUGA+3                                                 02559000
DEBUG57  EQU   DEBUGA+3                                                 02560000
DEBUG56  EQU   DEBUGA+3                                                 02561000
DEBUG55  EQU   DEBUGA+2                                                 02562000
DEBUG54  EQU   DEBUGA+2                                                 02563000
DEBUG53  EQU   DEBUGA+2                                                 02564000
DEBUG52  EQU   DEBUGA+2                                                 02565000
DEBUG50  EQU   DEBUGA+2                                                 02566000
DEBUG49  EQU   DEBUGA+2                                                 02567000
DEBUG48  EQU   DEBUGA+2                                                 02568000
DEBUG47  EQU   DEBUGA+1                                                 02569000
DEBUG46  EQU   DEBUGA+1                                                 02570000
DEBUG45  EQU   DEBUGA+1                                                 02571000
DEBUG44  EQU   DEBUGA+1                                                 02572000
DEBUG43  EQU   DEBUGA+1                                                 02573000
DEBUG42  EQU   DEBUGA+1                                                 02574000
DEBUG41  EQU   DEBUGA+1                                                 02575000
DEBUG40  EQU   DEBUGA+1                                                 02576000
DEBUG39  EQU   DEBUGA                                                   02577000
DEBUG38  EQU   DEBUGA                                                   02578000
DEBUG37  EQU   DEBUGA                                                   02579000
DEBUG36  EQU   DEBUGA                                                   02580000
DEBUG35  EQU   DEBUGA                                                   02581000
DEBUG34  EQU   DEBUGA                                                   02582000
DEBUG33  EQU   DEBUGA                                                   02583000
DEBUG32  EQU   DEBUGA                                                   02584000
DEBUG31  EQU   DEBUG+3                                                  02585000
DEBUG30  EQU   DEBUG+3                                                  02586000
DEBUG29  EQU   DEBUG+3                                                  02587000
DEBUG28  EQU   DEBUG+3                                                  02588000
DEBUG27  EQU   DEBUG+3                                                  02589000
DEBUG26  EQU   DEBUG+3                                                  02590000
DEBUG25  EQU   DEBUG+3                                                  02591000
DEBUG24  EQU   DEBUG+3                                                  02592000
DEBUG23  EQU   DEBUG+2                                                  02593000
DEBUG22  EQU   DEBUG+2                                                  02594000
DEBUG20  EQU   DEBUG+2                                                  02595000
DEBUG19  EQU   DEBUG+2                                                  02596000
DEBUG18  EQU   DEBUG+2                                                  02597000
DEBUG17  EQU   DEBUG+2                                                  02598000
DEBUG16  EQU   DEBUG+2                                                  02599000
DEBUG15  EQU   DEBUG+1                                                  02600000
DEBUG14  EQU   DEBUG+1                                                  02601000
DEBUG13  EQU   DEBUG+1                                                  02602000
DEBUG11  EQU   DEBUG+1                                                  02603000
DEBUG10  EQU   DEBUG+1                                                  02604000
DEBUG9   EQU   DEBUG+1                                                  02605000
DEBUG8   EQU   DEBUG+1                                                  02606000
DEBUG7   EQU   DEBUG                                                    02607000
DEBUG6   EQU   DEBUG                                                    02608000
DEBUG5   EQU   DEBUG                                                    02609000
DEBUG3   EQU   DEBUG                                                    02610000
DEBUG2   EQU   DEBUG                                                    02611000
DEBUG1   EQU   DEBUG                                                    02612000
DEBUG0   EQU   DEBUG                                                    02613000
SORTBRK  EQU   SWITCHES+1                                               02614000
COREFAIL EQU   SWITCHES+1                                               02615000
ANALYSIS EQU   SWITCHES+1                                               02616000
SHIFT3RD EQU   SWITCHES+1                                               02617000
DEVEXCL  EQU   SWITCHES+1                                               02618000
ZEROALL  EQU   SWITCHES+1                                               02619000
NOTALL   EQU   SWITCHES+1                                               02620000
NOSDR    EQU   SWITCHES                                                 02621000
TIMESEQ  EQU   SWITCHES                                                 02622000
SYSUM    EQU   SWITCHES                                                 02623000
PARMTHR  EQU   SWITCHES                                                 02624000
TREND    EQU   SWITCHES                                                 02625000
SHORTOBR EQU   SWITCHES                                                 02626000
PARMMES  EQU   SWITCHES                                                 02627000
RDESUM   EQU   SWITCHES                                                 02628000
PCCHFRAM EQU   RECTYPE+1                                                02629000
PMCHFRAM EQU   RECTYPE+1                                                02630000
PTTYP    EQU   RECTYPE+1                                                02631000
PEOD     EQU   RECTYPE                                                  02632000
PMIH     EQU   RECTYPE                                                  02633000
PDDR     EQU   RECTYPE                                                  02634000
PIPL     EQU   RECTYPE                                                  02635000
PSOFT    EQU   RECTYPE                                                  02636000
POBR     EQU   RECTYPE                                                  02637000
PCHAN    EQU   RECTYPE                                                  02638000
PMCH     EQU   RECTYPE                                                  02639000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02640000
@RF00203 EQU   @RC00197                                                 02641000
@RF00573 EQU   @EL00016                                                 02642000
@ENDDATA EQU   *                                                        02643000
         END   IFCTREND                                                 02644000
