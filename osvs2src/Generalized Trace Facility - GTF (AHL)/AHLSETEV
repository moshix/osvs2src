         TITLE 'AHLSETEV - SETEVENT SERVICE ENABLED PROCESSOR          *00001000
                        '                                               00002000
AHLSETEV CSECT ,                                                01S0001 00003000
@MAINENT DS    0H                                               01S0001 00004000
         USING *,@15                                            01S0001 00005000
         B     @PROLOG                                          01S0001 00006000
         DC    AL1(16)                                          01S0001 00007000
         DC    C'AHLSETEV  77.321'                              01S0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                  01S0001 00010000
         BALR  @11,0                                            01S0001 00011000
@PSTART  LA    @12,4095(,@11)                                   01S0001 00012000
         USING @PSTART,@11                                      01S0001 00013000
         USING @PSTART+4095,@12                                 01S0001 00014000
         L     @00,@SIZDATD                                     01S0001 00015000
         GETMAIN  R,LV=(0)                                              00016000
         LR    @09,@01                                          01S0001 00017000
         USING @DATD,@09                                        01S0001 00018000
         ST    @13,@SA00001+4                                   01S0001 00019000
         LM    @00,@01,20(@13)                                  01S0001 00020000
         ST    @09,8(,@13)                                      01S0001 00021000
         LR    @13,@09                                          01S0001 00022000
         MVC   @PC00001(4),0(@01)                               01S0001 00023000
*   PLISTAD=R1PLSTAD;               /* SAVE PARMLIST ADDRESS         */ 00024000
         ST    R1PLSTAD,PLISTAD                                 02S0087 00025000
*   RFY                                                         02S0088 00026000
*     R1PLSTAD UNRSTD;                                          02S0088 00027000
*   RTRNCODE=0;                     /* INITIALIZE RETURN CODE TO ZERO*/ 00028000
         SLR   @08,@08                                          02S0089 00029000
         ST    @08,RTRNCODE                                     02S0089 00030000
*   RTRNMCQE=0;                     /* INITIALIZE MCQE ADDRESS TO BE    00031000
*                                      RETURNED IN REGISTER ZERO TO     00032000
*                                      ZERO. THIS WILL BE UPDATED       00033000
*                                      WITH NEWLY-GOTTEN MCQE ADDRESS   00034000
*                                      IF ONE IS AQUIRED ON THIS CALL   00035000
*                                      OF AHLSETEV.                  */ 00036000
         SLR   RTRNMCQE,RTRNMCQE                                02S0090 00037000
*   FLAGS=0;                        /* CLEAR ALL FLAGS               */ 00038000
         MVI   FLAGS,X'00'                                      02S0091 00039000
*   MCQEPTR=0;                      /* ZERO MCQE ADDRESS             */ 00040000
         SLR   MCQEPTR,MCQEPTR                                  02S0092 00041000
*   LASTELM=0;                      /* INITIALIZE CHAIN VALUE TO        00042000
*                                      INDICATE THAT WE ARE AT  02S0093 00043000
*                                      BEGINNING                     */ 00044000
         SLR   LASTELM,LASTELM                                  02S0093 00045000
*   MCHEADPT=ADDR(MCHEAD);          /* FIND MCHEAD ADDRESS AND SAVE     00046000
*                                      IT                            */ 00047000
         L     @08,CVTPTR                                       02S0094 00048000
         L     @08,CVTGTFA-1(,@08)                              02S0094 00049000
         LA    @08,0(,@08)                                      02S0094 00050000
         ST    @08,MCHEADPT                                     02S0094 00051000
*   RFY                                                         02S0095 00052000
*     MCHEAD BASED(MCHEADPT);                                   02S0095 00053000
*                                                               02S0096 00054000
*   /*****************************************************************/ 00055000
*   /*                                                               */ 00056000
*   /* THE FOLLOWING LOGIC CHECKS FOR A VALID CALLER VIA THE TESTAUTH*/ 00057000
*   /* FACILITY, AND ESTABLISHES PROTECT KEY ZERO AND SUPERVISOR     */ 00058000
*   /* STATE FOR VALID CALLERS. INVALID CALLERS ARE ABENDED.         */ 00059000
*   /*                                                               */ 00060000
*   /*****************************************************************/ 00061000
*                                                               02S0096 00062000
*   GENERATE;                                                   02S0096 00063000
          TESTAUTH STATE=YES,RBLEVEL=1   Q. WAS CALLER IN SUPER STATE   00064000
*   IF RETCOD15^=0 THEN                                         02S0097 00065000
         LTR   RETCOD15,RETCOD15                                02S0097 00066000
         BZ    @RF00097                                         02S0097 00067000
*     DO;                                                       02S0098 00068000
*                                                               02S0098 00069000
*       /*************************************************************/ 00070000
*       /*                                                           */ 00071000
*       /* CALLER WAS NOT IN SUPERVISOR STATE. ENSURE HIS VALIDITY   */ 00072000
*       /* VIA TESTAUTH, CHECKING FOR APF OR PROTECT KEY 0-7         */ 00073000
*       /*                                                           */ 00074000
*       /*************************************************************/ 00075000
*                                                               02S0099 00076000
*       GENERATE;                                               02S0099 00077000
         TESTAUTH FCTN=1,KEY=YES,RBLEVEL=1    IS CALLER PK 0-7, OR APF  00078000
*       IF RETCOD15^=0 THEN                                     02S0100 00079000
         LTR   RETCOD15,RETCOD15                                02S0100 00080000
         BZ    @RF00100                                         02S0100 00081000
*         DO;                                                   02S0101 00082000
*                                                               02S0101 00083000
*           /*********************************************************/ 00084000
*           /*                                                       */ 00085000
*           /* CALLER IS NOT VALID. ABEND HIM WITH PROPER INDICATOR  */ 00086000
*           /* IN REGISTER 15                                        */ 00087000
*           /*                                                       */ 00088000
*           /*********************************************************/ 00089000
*                                                               02S0102 00090000
*           RFY                                                 02S0102 00091000
*             ABNDCODE RSTD;                                    02S0102 00092000
*           ABNDCODE=NOTAUTH;       /* SET NOT-AUTHORIZED CODE       */ 00093000
         SLR   ABNDCODE,ABNDCODE                                02S0103 00094000
*           DO;                     /* ABEND(SETCMPCD) DUMP SYSTEM   */ 00095000
*             RESPECIFY                                         02S0105 00096000
*              (GPR01F) RESTRICTED;                             02S0105 00097000
*             GPR01F=((SETCMPCD)&'00000FFF'X)*4096;/* COMP CODE IN      00098000
*                                      BITS 8-19                     */ 00099000
         L     GPR01F,@CF02503                                  02S0106 00100000
*             GPR01F=GPR01F|'80000000'X;/* DUMP/STEP/DUMPOPTS FLAG   */ 00101000
         O     GPR01F,@CF02273                                  02S0107 00102000
*             SVC(13);              /* ISSUE ABEND SVC               */ 00103000
         SVC   13                                               02S0108 00104000
*             RESPECIFY                                         02S0109 00105000
*              (GPR01F) UNRESTRICTED;                           02S0109 00106000
*           END;                    /* ABEND(SETCMPCD) DUMP SYSTEM   */ 00107000
*           RFY                                                 02S0111 00108000
*             ABNDCODE UNRSTD;                                  02S0111 00109000
*         END;                                                  02S0112 00110000
*                                                               02S0112 00111000
*       /*************************************************************/ 00112000
*       /*                                                           */ 00113000
*       /* ISSUER IS VALID BUT NOT IN SUPERVISOR STATE. SET FLAG TO  */ 00114000
*       /* INDICATE THAT STATE MUST BE CHANGED ON EXIT, AND CHANGE TO*/ 00115000
*       /* SUPERVISOR STATE                                          */ 00116000
*       /*                                                           */ 00117000
*       /*************************************************************/ 00118000
*                                                               02S0113 00119000
*       PROBSTAT='1'B;              /* INDICATE CALLER WAS IN PROBLEM   00120000
*                                      STATE                         */ 00121000
@RF00100 OI    PROBSTAT,B'10000000'                             02S0113 00122000
*       DO;                         /* MODESET MODE(SUP)             */ 00123000
*         I10701='00000000'B;       /* OR MASK                       */ 00124000
         MVI   I10701,B'00000000'                               02S0115 00125000
*         I10702='00000000'B;       /* AND MASK                      */ 00126000
         MVI   I10702,B'00000000'                               02S0116 00127000
*         I10703='00000000'B;       /* RESERVED                      */ 00128000
         MVI   I10703,B'00000000'                               02S0117 00129000
*         I10704='00001100'B;                                   02S0118 00130000
         MVI   I10704,B'00001100'                               02S0118 00131000
*         RESPECIFY                                             02S0119 00132000
*           GPR01F RESTRICTED;                                  02S0119 00133000
*         GPR01F=I107;              /* MODESET PARMLIST              */ 00134000
         L     GPR01F,I107                                      02S0120 00135000
*         SVC(107);                 /* ISSUE MODESET SVC             */ 00136000
         SVC   107                                              02S0121 00137000
*         RESPECIFY                                             02S0122 00138000
*          (GPR01F) UNRESTRICTED;                               02S0122 00139000
*       END;                        /* MODESET MODE(SUP) CHANGE TO      00140000
*                                      SUPR SATE                     */ 00141000
*     END;                          /* END OF NON-SUPERVISOR STATE      00142000
*                                      PATH                          */ 00143000
*                                                               02S0124 00144000
*   /*****************************************************************/ 00145000
*   /*                                                               */ 00146000
*   /* SUPERVISOR STATE IS ASSURED. CHANGE PROTECT KEY TO ZERO AND   */ 00147000
*   /* SAVE CALLERS PROTECT KEY FOR LATER RESTORATION.               */ 00148000
*   /*                                                               */ 00149000
*   /*****************************************************************/ 00150000
*                                                               02S0125 00151000
*   RFY                                                         02S0125 00152000
*     TEMPREG RSTD;                                             02S0125 00153000
@RF00097 DS    0H                                               02S0126 00154000
*   DO;                             /* MODESET SAVEKEY(HISKEY)  02S0126 00155000
*                                      EXTKEY(ZERO) WORKREG(TEMPREG) */ 00156000
*     RESPECIFY                                                 02S0127 00157000
*      (GPR02F) RESTRICTED;                                     02S0127 00158000
*     TEMPREG=GPR02F;               /* SAVE REGISTER 2               */ 00159000
         LR    TEMPREG,GPR02F                                   02S0128 00160000
*     IPK;                          /* SAVE CURRENT PSW KEY          */ 00161000
         IPK                                                    02S0129 00162000
*     SPKA(0);                      /* SET PSW KEY                   */ 00163000
         SLR   @14,@14                                          02S0130 00164000
         SPKA  0(@14)                                           02S0130 00165000
*     HISKEY=GPR02F;                                            02S0131 00166000
         LR    HISKEY,GPR02F                                    02S0131 00167000
*     GPR02F=TEMPREG;               /* RESTORE REGISTER 2            */ 00168000
         LR    GPR02F,TEMPREG                                   02S0132 00169000
*     RESPECIFY                                                 02S0133 00170000
*      (GPR02F) UNRESTRICTED;                                   02S0133 00171000
*   END;                            /* MODESET SAVEKEY(HISKEY)  02S0134 00172000
*                                      EXTKEY(ZERO) WORKREG(TEMPREG) */ 00173000
*   RFY                                                         02S0135 00174000
*     TEMPREG UNRSTD;                                           02S0135 00175000
*                                                               02S0136 00176000
*   /*****************************************************************/ 00177000
*   /*                                                               */ 00178000
*   /* COMPLETE THE INITIALIZATION BY ESTABLISHING ESTAE, ENQING FOR */ 00179000
*   /* SERIALIZATION, THEN CHECKING BIT MCHTERM TO SEE IF THE MC     */ 00180000
*   /* ROUTING FACILITY WAS TERMINATED BY MODULE AHLMCER. IF SO,     */ 00181000
*   /* TERMINATION PHASE PROCESSING MUST BE ACCOMPLISHED BEFORE      */ 00182000
*   /* SERVICING THIS REQUEST.                                       */ 00183000
*   /*                                                               */ 00184000
*   /*****************************************************************/ 00185000
*                                                               02S0136 00186000
*   GENERATE;                                                   02S0136 00187000
*                                                          /*@YM03654*/ 00188000
    MVC ESTAELST(16),ESTAE2                                  ZM40016    00189000
          ESTAE AHLSETES,CT,PARAM=(9),MF=(E,ESTAELST)        @YM03654   00190000
*   IF RETCOD15^=0 THEN             /*                       @YM03654*/ 00191000
         LTR   RETCOD15,RETCOD15                                02S0137 00192000
         BZ    @RF00137                                         02S0137 00193000
*     DO;                           /* NONZERO R15 INDICATES    02S0138 00194000
*                                      UNSUCCESSFUL ESTAE    @YM03654*/ 00195000
*       RTRNCODE=BADESTAE;          /* SET THE PROPER RETURN CODE IN    00196000
*                                      TEMPORARY AREA        @YM03654*/ 00197000
         MVC   RTRNCODE(4),@CF00106                             02S0139 00198000
*       GO TO AHLXIT2;              /*                       @YM03654*/ 00199000
         B     AHLXIT2                                          02S0140 00200000
*     END;                          /* END OF BAD ESTAE PATH @YM03654*/ 00201000
*   DO;                             /* ENQ (SETQNM,SETRNM,E,,SYSTEMS)*/ 00202000
@RF00137 DS    0H                                               02S0143 00203000
*     RESPECIFY                                                 02S0143 00204000
*      (GPR01P) RESTRICTED;                                     02S0143 00205000
*     I056(1:20)=I056(1:20)&&I056(1:20);/* ZERO OUT THE TABLE        */ 00206000
         XC    I056(20),I056                                    02S0144 00207000
*     I05604(1)=LENGTH(SETRNM);     /* LENGTH OF MINOR RESOURCE NAME */ 00208000
         MVI   I05604,X'03'                                     02S0145 00209000
*     I05606(1)=ADDR(SETQNM);       /* ADDRESS OF MAJOR RESOURCE NAME*/ 00210000
         LA    @06,@CC00164                                     02S0146 00211000
         ST    @06,I05606                                       02S0146 00212000
*     I05607(1)=ADDR(SETRNM);       /* ADDRESS OF MINOR RESOURCE NAME*/ 00213000
         LA    @06,@CC00166                                     02S0147 00214000
         ST    @06,I05607                                       02S0147 00215000
*     I05603(1)='01000000'B;        /* SET BIT STRING 1 FOR RESOURCE    00216000
*                                      ELEMENT                       */ 00217000
         MVI   I05603,B'01000000'                               02S0148 00218000
*     I05605(1)='01001000'B;        /* SET BIT STRING 2 FOR RESOURCE    00219000
*                                      ELEMENT                       */ 00220000
         MVI   I05605,B'01001000'                               02S0149 00221000
*     I05603(1,1)='1'B;             /* SET END OF LIST BIT           */ 00222000
         OI    I05603,B'10000000'                               02S0150 00223000
*     GPR01P=ADDR(I05602);          /* LOAD LIST ADDRESS             */ 00224000
         LA    GPR01P,I05602                                    02S0151 00225000
*     SVC(56);                      /* ISSUE ENQ SVC                 */ 00226000
         SVC   56                                               02S0152 00227000
*     RESPECIFY                                                 02S0153 00228000
*      (GPR01P) UNRESTRICTED;                                   02S0153 00229000
*   END;                            /* ENQ (SETQNM,SETRNM,E,,SYSTEMS)*/ 00230000
*   IF MCHTERM='1'B THEN                                        02S0155 00231000
         L     @06,MCHEADPT                                     02S0155 00232000
         TM    MCHTERM(@06),B'01000000'                         02S0155 00233000
         BNO   @RF00155                                         02S0155 00234000
*     DO;                           /* MCHTERM SET TO ONE INDICATES     00235000
*                                      AHLMCER HAS TERMINATED THE MC    00236000
*                                      ROUTING FACILITY              */ 00237000
*                                                               03S0157 00238000
*       /*************************************************************/ 00239000
*       /*                                                           */ 00240000
*       /* MODULE AHLMCER HAS TERMINATED THE MC ROUTING FACILITY. THE*/ 00241000
*       /* FOLLOWING CODE SETS UP AND SCHEDULES THE SRB IN THE       */ 00242000
*       /* CURRENT MCCE, POSTING ALL APPLICATIONS TO TERMINATE.      */ 00243000
*       /*                                                           */ 00244000
*       /*************************************************************/ 00245000
*                                                               03S0157 00246000
*       MCHTERM='0'B;               /* TURN OFF TERMINATION INDICATOR*/ 00247000
         NI    MCHTERM(@06),B'10111111'                         03S0157 00248000
*       RFY                                                     03S0158 00249000
*         MCCE BASED(MCHCUR);                                   03S0158 00250000
*       RFY                                                     03S0159 00251000
*         SRBPTR RSTD;                                          03S0159 00252000
*                                                               03S0159 00253000
*       /*************************************************************/ 00254000
*       /*                                                           */ 00255000
*       /* SET UP THE SRB IN THE CURRENT MCCE TO SCHEDULE ROUTINE    */ 00256000
*       /* AHLMCPST TO POST ALL APPLICATIONS TO TERMINATE            */ 00257000
*       /*                                                           */ 00258000
*       /*************************************************************/ 00259000
*                                                               03S0160 00260000
*       SRBPTR=ADDR(MCCESRB);       /* POINT TO CORRECT SRB          */ 00261000
         L     @06,MCHCUR(,@06)                                 03S0160 00262000
         LA    SRBPTR,MCCESRB(,@06)                             03S0160 00263000
*       SRBEP=ADDR(AHLMCPST);       /* CHANGE EP TO CORRECT ROUTINE  */ 00264000
         LA    @00,AHLMCPST                                     03S0161 00265000
         ST    @00,SRBEP(,SRBPTR)                               03S0161 00266000
*       SRBASCB=PSAAOLD;            /* HAVE IT RUN IN THIS MEMORY    */ 00267000
         L     @00,PSAAOLD                                      03S0162 00268000
         ST    @00,SRBASCB(,SRBPTR)                             03S0162 00269000
*       RFY                                                     03S0163 00270000
*         SRBPTR UNRSTD;                                        03S0163 00271000
*       MCCEPTR=MCHCUR;             /* POINT TO MCCE TO BE REPLACED  */ 00272000
         ST    @06,MCCEPTR                                      03S0164 00273000
*       NEWMCCE=0;                  /* NEWW MCCE ADDRESS TO BE USED     00274000
*                                      IS ZERO                       */ 00275000
         SLR   @06,@06                                          03S0165 00276000
         ST    @06,NEWMCCE                                      03S0165 00277000
*       CALL CSDMCCE;               /* CALL SUBROUTINE TO SWAP ZERO     00278000
*                                      IN FOR MCCE ADDRESS, AND 03S0166 00279000
*                                      SCHEDULE SRB                  */ 00280000
         BAL   @14,CSDMCCE                                      03S0166 00281000
*       RFY                                                     03S0167 00282000
*         MCCE BASED(MCCEPTR);                                  03S0167 00283000
*       DO;                         /* WAIT ECB(MCCEECB)             */ 00284000
*         RESPECIFY                                             03S0169 00285000
*          (GPR00P,                                             03S0169 00286000
*           GPR01P) RESTRICTED;                                 03S0169 00287000
*         GPR00P=1;                 /* LOAD WAIT COUNT               */ 00288000
         LA    GPR00P,1                                         03S0170 00289000
*         GPR01P=ADDR(MCCEECB);     /* ADDRESS OF ECB                */ 00290000
         L     GPR01P,MCCEPTR                                   03S0171 00291000
         LA    GPR01P,MCCEECB(,GPR01P)                          03S0171 00292000
*         SVC(1);                   /* WAIT SVC                      */ 00293000
         SVC   1                                                03S0172 00294000
*         RESPECIFY                                             03S0173 00295000
*          (GPR00P,                                             03S0173 00296000
*           GPR01P) UNRESTRICTED;                               03S0173 00297000
*       END;                        /* WAIT ECB(MCCEECB) WAIT FOR SRB   00298000
*                                      ROUTINE AHLMCPST TO POST ECB     00299000
*                                      IN MCCE TO SIGNAL THAT IT IS     00300000
*                                      DONE.                         */ 00301000
*                                                               03S0174 00302000
*       /*************************************************************/ 00303000
*       /*                                                           */ 00304000
*       /* FINISH CLEANING UP BY FREEING THE MCCE, PGFREEING MODULE  */ 00305000
*       /* AHLSETD, AND CLEARING THE CONTROL REGISTER MASK. AFTER    */ 00306000
*       /* THIS IS DONE, THE REQUESTED FUNCTION CAN BE SERVICED      */ 00307000
*       /*                                                           */ 00308000
*       /*************************************************************/ 00309000
*                                                               03S0175 00310000
*       DO;                         /* FREEMAIN (E) LV(LENGTH(MCCE))    00311000
*                                      A(MCCEPTR) SP(SQA)            */ 00312000
*         RESPECIFY                                             03S0176 00313000
*          (GPR01P) RESTRICTED;                                 03S0176 00314000
*         I005=I005&&I005;          /* INIT LIST                     */ 00315000
         XC    I005(10),I005                                    03S0177 00316000
*         I00505='00'X;             /* SET TYPE                      */ 00317000
         MVI   I00505,X'00'                                     03S0178 00318000
*         I00502=LENGTH(MCCE);      /* LENGTH                        */ 00319000
         MVC   I00502(3),@CF02504+1                             03S0179 00320000
*         I00504=ADDR(MCCEPTR);     /* ADDR OF ADDR LIST             */ 00321000
         LA    @06,MCCEPTR                                      03S0180 00322000
         STCM  @06,7,I00504                                     03S0180 00323000
*         I00506=SQA;               /* SUBPOOL VALUE                 */ 00324000
         MVI   I00506,X'F5'                                     03S0181 00325000
*         GPR01P=ADDR(I005);        /* REG1 POINTS TO LIST           */ 00326000
         LA    GPR01P,I005                                      03S0182 00327000
*         SVC(5);                   /* STANDARD-FORM OF GETMAIN      */ 00328000
         SVC   5                                                03S0183 00329000
*         RESPECIFY                                             03S0184 00330000
*          (GPR01P) UNRESTRICTED;                               03S0184 00331000
*       END;                        /* FREEMAIN (E) LV(LENGTH(MCCE))    00332000
*                                      A(MCCEPTR) SP(SQA) FREE THE      00333000
*                                      MCCE SINCE ALL ARE DONE WITH     00334000
*                                      IT                            */ 00335000
*       DO;                         /* PGFREE(R) A(SETDPTR)          */ 00336000
*         RESPECIFY                                             03S0187 00337000
*          (GPR00P,                                             03S0187 00338000
*           GPR01P) RESTRICTED;                                 03S0187 00339000
*         GPR00P=0;                 /* INDICATE NO PAGE ECB          */ 00340000
         SLR   GPR00P,GPR00P                                    03S0188 00341000
*         GPR01P=ADDR(SETDPTR);     /* PAGE ADDR                     */ 00342000
         L     @06,MCHEADPT                                     03S0189 00343000
         L     @06,MCHSETD(,@06)                                03S0189 00344000
         LR    GPR01P,@06                                       03S0189 00345000
*         RESPECIFY                                             03S0190 00346000
*           GPR15P RESTRICTED;                                  03S0190 00347000
*         GPR15P=ADDR(SETDPTR)+1;   /* VSL ADDR OMITTED              */ 00348000
         AL    @06,@CF00145                                     03S0191 00349000
         LR    GPR15P,@06                                       03S0191 00350000
*         GPR01P=GPR01P|'20000000'X;/* R, PGFREE & RELEASE FLAG      */ 00351000
         O     GPR01P,@CF02311                                  03S0192 00352000
*         SVC(113);                 /* ISSUE PGFREE SVC              */ 00353000
         SVC   113                                              03S0193 00354000
*         RESPECIFY                                             03S0194 00355000
*          (GPR00P,                                             03S0194 00356000
*           GPR01P,                                             03S0194 00357000
*           GPR15P) UNRESTRICTED;                               03S0194 00358000
*       END;                        /* PGFREE(R) A(SETDPTR) FREE        00359000
*                                      AHLSETD PAGE SINCE IT IS NO      00360000
*                                      LONGER REQUIRED TO BE FIXED   */ 00361000
*       MCHCTL=0;                   /* SET THE CONTROL REGISTER MASK    00362000
*                                      TO ZERO                       */ 00363000
         L     @06,MCHEADPT                                     03S0196 00364000
         SLR   @15,@15                                          03S0196 00365000
         ST    @15,MCHCTL(,@06)                                 03S0196 00366000
*       CALL CR8SET;                /* SET THE CONTROL REGISTER ON      00367000
*                                      ALL CPUS                      */ 00368000
         BAL   @14,CR8SET                                       03S0197 00369000
*     END;                                                      02S0198 00370000
*                                                               01S0199 00371000
*   /*****************************************************************/ 00372000
*   /*                                                               */ 00373000
*   /* INTERROGATE THE PARAMETER LIST TO DETERMINE THE REQUESTED     */ 00374000
*   /* FUNCTION. ONCE A FUCTION SPECIFICATION HAS BEEN DETERMINED AND*/ 00375000
*   /* PROCESSED, CONTROL IS PASSED TO THE EXIT ROUTINE AND NO OTHER */ 00376000
*   /* BITS ARE CHECKED, EXCEPT THAT THE ACTIVATE FLAG IS CHECKED FOR*/ 00377000
*   /* AFTER ADD HAS BEEN SUCCESSFULLY PERFORMED.                    */ 00378000
*   /*                                                               */ 00379000
*   /*****************************************************************/ 00380000
*                                                               01S0199 00381000
*   IF ADD='1'B THEN                                            01S0199 00382000
@RF00155 L     @06,PLISTAD                                      01S0199 00383000
         TM    ADD(@06),B'10000000'                             01S0199 00384000
         BNO   @RF00199                                         01S0199 00385000
*     DO;                                                       01S0200 00386000
*                                                               02S0201 00387000
*       /*************************************************************/ 00388000
*       /*                                                           */ 00389000
*       /* ADD FUNCTION HAS BEEN SPECIFIED. THE FOLLOWING CODE       */ 00390000
*       /* OBTAINS AND INTIALIZES THE EVENT AND CLASS ELEMENTS (MCEES*/ 00391000
*       /* AND MCCLES) TO REPRESENT THE EIDS AND CLASSES IN THE      */ 00392000
*       /* PARAMETER LIST. THESE MCEES/MCCLES CONTAIN THE EID/CLASS, */ 00393000
*       /* AND THE ROUTINE ADDRESS TO RECEIVE CONTROL ON THAT EVENT. */ 00394000
*       /* FIRST, THE MCQE MUST BE FOUND.                            */ 00395000
*       /*                                                           */ 00396000
*       /*************************************************************/ 00397000
*                                                               02S0201 00398000
*       CALL GETMCQE;               /* CALL GETMCQE TO FIND OR OBTAIN   00399000
*                                      THE MCQE FOR THIS APPLICATION.*/ 00400000
         BAL   @14,GETMCQE                                      02S0201 00401000
*       RFY                                                     02S0202 00402000
*         MCQE BASED(MCQEPTR);                                  02S0202 00403000
*       IF RTRNCODE=0 THEN                                      02S0203 00404000
         SLR   @06,@06                                          02S0203 00405000
         C     @06,RTRNCODE                                     02S0203 00406000
         BNE   @RF00203                                         02S0203 00407000
*         DO;                       /* THE RETURN CODE WILL HAVE        00408000
*                                      REMAINED ZERO IF GETMCQE DID     00409000
*                                      NOT ENCOUNTER ANY PROBLEMS.      00410000
*                                      OTHERWISE, CONTROL WILL BE       00411000
*                                      GIVEN TO THE EXIT ROUTINE     */ 00412000
*           IF EVENTNUM=0 THEN                                  02S0205 00413000
         L     @01,PLISTAD                                      02S0205 00414000
         ICM   @15,12,EVENTNUM(@01)                             02S0205 00415000
         SRA   @15,16                                           02S0205 00416000
         CR    @06,@15                                          02S0205 00417000
         BNE   @RF00205                                         02S0205 00418000
*             DO;                   /* IF THERE ARE NO EVENTS OR        00419000
*                                      CLASSES GIVEN, THIS IS AN        00420000
*                                      INVALID SETEVENT CALL         */ 00421000
*               RFY                                             02S0207 00422000
*                 ABNDCODE RSTD;                                02S0207 00423000
*               ABNDCODE=BADOPT;    /* SET ABEND INDICATOR           */ 00424000
         LA    ABNDCODE,4                                       02S0208 00425000
*               DO;                 /* ABEND(SETCMPCD) DUMP SYSTEM   */ 00426000
*                 RESPECIFY                                     02S0210 00427000
*                  (GPR01F) RESTRICTED;                         02S0210 00428000
*                 GPR01F=((SETCMPCD)&'00000FFF'X)*4096;/* COMP CODE     00429000
*                                      IN BITS 8-19                  */ 00430000
         L     GPR01F,@CF02503                                  02S0211 00431000
*                 GPR01F=GPR01F|'80000000'X;/* DUMP/STEP/DUMPOPTS       00432000
*                                      FLAG                          */ 00433000
         O     GPR01F,@CF02273                                  02S0212 00434000
*                 SVC(13);          /* ISSUE ABEND SVC               */ 00435000
         SVC   13                                               02S0213 00436000
*                 RESPECIFY                                     02S0214 00437000
*                  (GPR01F) UNRESTRICTED;                       02S0214 00438000
*               END;                /* ABEND(SETCMPCD) DUMP SYSTEM   */ 00439000
*               RFY                                             02S0216 00440000
*                 ABNDCODE UNRSTD;                              02S0216 00441000
*             END;                                              02S0217 00442000
*                                                               02S0218 00443000
*           /*********************************************************/ 00444000
*           /*                                                       */ 00445000
*           /* PROCESS THE SPECIFIED EIDS IN THE EID LIST PASSED BY  */ 00446000
*           /* THE CALLER.                                           */ 00447000
*           /*                                                       */ 00448000
*           /*********************************************************/ 00449000
*                                                               02S0218 00450000
*           LISTELM=EIDLSTAD;       /* INITIALIZE TO THE FIRST ENTRY    00451000
*                                      IN THE EID LIST               */ 00452000
@RF00205 L     @06,PLISTAD                                      02S0218 00453000
         ICM   LISTELM,15,EIDLSTAD(@06)                         02S0218 00454000
*           TMPCNT=EIDNUM;          /* PICK UP THE NUMBER OF EIDS IN    00455000
*                                      THE LIST                      */ 00456000
         SLR   TMPCNT,TMPCNT                                    02S0219 00457000
         IC    TMPCNT,EIDNUM(,@06)                              02S0219 00458000
*           DO WHILE(TMPCNT^=0);    /* PERFORM THE FOLLOWING FOR EACH   00459000
*                                      ENTRY IN THE EID LIST         */ 00460000
         B     @DE00220                                         02S0220 00461000
@DL00220 DS    0H                                               02S0221 00462000
*             ELEMAD=MCQEMCEE;      /* PICK UP FIRST MCEE ADDRESS    */ 00463000
         L     @06,MCQEMCEE(,MCQEPTR)                           02S0221 00464000
         ST    @06,ELEMAD                                       02S0221 00465000
*             LASTELM=0;            /* INDICATE THAT THIS IS FIRST      00466000
*                                      ONE ON CHAIN                  */ 00467000
*                                                               02S0222 00468000
         SLR   LASTELM,LASTELM                                  02S0222 00469000
*             /*******************************************************/ 00470000
*             /*                                                     */ 00471000
*             /* LOOP THRU THE MCEE CHAIN, CHECKING FOR AN EID THAT  */ 00472000
*             /* MATCHES THE EID IN THE EIDLIST ENTRY UNDER          */ 00473000
*             /* CONSIDERATION. IF A MATCHING EID IS FOUND, IT IS    */ 00474000
*             /* IQNORED. THIS LOOP CONTINUES UNTIL THE END OF THE   */ 00475000
*             /* MCEE CHAIN IS REACHED, INDICATED BY A ZERO LINK     */ 00476000
*             /* FIELD.                                              */ 00477000
*             /*                                                     */ 00478000
*             /*******************************************************/ 00479000
*                                                               02S0223 00480000
*             DO WHILE(ELEMAD^=0);  /* LOOP UNTIL END OF CHAIN       */ 00481000
         B     @DE00223                                         02S0223 00482000
@DL00223 DS    0H                                               02S0224 00483000
*               RFY                                             02S0224 00484000
*                (MCEE,                                         02S0224 00485000
*                 MCCLE) BASED(ELEMAD);                         02S0224 00486000
*               IF MCEEEID=PLISTEID THEN                        02S0225 00487000
         L     @06,ELEMAD                                       02S0225 00488000
         CLC   MCEEEID(2,@06),PLISTEID(LISTELM)                 02S0225 00489000
         BE    @RT00225                                         02S0225 00490000
*                 GO TO AHLADD01;   /* GO PROCESS NEXT EIDLIST ENTRY    00491000
*                                      IF THIS EID IS ALREADY DEFINED   00492000
*                                      TO MCQE                       */ 00493000
*               LASTELM=ELEMAD;     /* THIS MCEE NOW BECOMES PRIOR   */ 00494000
         LR    LASTELM,@06                                      02S0227 00495000
*               ELEMAD=MCEEMCQL;    /* UPDATE POINTER TO THE NEXT       00496000
*                                      MCEE                          */ 00497000
         L     @06,MCEEMCQL(,@06)                               02S0228 00498000
         ST    @06,ELEMAD                                       02S0228 00499000
*             END;                                              02S0229 00500000
*                                                               02S0229 00501000
@DE00223 L     @06,ELEMAD                                       02S0229 00502000
         LTR   @06,@06                                          02S0229 00503000
         BNZ   @DL00223                                         02S0229 00504000
*             /*******************************************************/ 00505000
*             /*                                                     */ 00506000
*             /* FALL THROUGH TO THE FOLLOWING CODE INDICATES THAT   */ 00507000
*             /* THE EID IS NOT DEFINED IN THE PRESENT MCEE CHAIN. A */ 00508000
*             /* NEW MCEE IS OBTAINED, INITIALIZED, AND ENTERED ON   */ 00509000
*             /* THE CHAIN.                                          */ 00510000
*             /*                                                     */ 00511000
*             /*******************************************************/ 00512000
*                                                               02S0230 00513000
*             DO;                   /* GETMAIN (EC) LV(LENGTH(MCEE))    00514000
*                                      A(GETMADDR) SP(SQA)           */ 00515000
*               RESPECIFY                                       02S0231 00516000
*                (GPR01P) RESTRICTED;                           02S0231 00517000
*               I004=I004&&I004;    /* INIT LIST                     */ 00518000
         XC    I004(10),I004                                    02S0232 00519000
*               I00404='20'X;       /* TYPE                          */ 00520000
         MVI   I00404,X'20'                                     02S0233 00521000
*               I00401=LENGTH(MCEE);/* LENGTH                        */ 00522000
         MVC   I00401(4),@CF00106                               02S0234 00523000
*               I00403=ADDR(GETMADDR);/* ADDR OF ADDR LIST           */ 00524000
         LA    @06,GETMADDR                                     02S0235 00525000
         STCM  @06,7,I00403                                     02S0235 00526000
*               I00405=SQA;         /* SUBPOOL VALUE                 */ 00527000
         MVI   I00405,X'F5'                                     02S0236 00528000
*               GPR01P=ADDR(I004);  /* REG1 POINTS TO LIST           */ 00529000
         LA    GPR01P,I004                                      02S0237 00530000
*               SVC(4);             /* STANDARD-FORM OF GETMAIN      */ 00531000
         SVC   4                                                02S0238 00532000
*               RESPECIFY                                       02S0239 00533000
*                (GPR01P) UNRESTRICTED;                         02S0239 00534000
*             END;                  /* GETMAIN (EC) LV(LENGTH(MCEE))    00535000
*                                      A(GETMADDR) SP(SQA)           */ 00536000
*             IF RETCOD15^=0 THEN                               02S0241 00537000
         LTR   RETCOD15,RETCOD15                                02S0241 00538000
         BZ    @RF00241                                         02S0241 00539000
*               DO;                 /* IF SQA IS FULL, INDICATE THE     00540000
*                                      INSUFFICIENT STORAGE CONDITION   00541000
*                                      AND PASS CONTROL TO THE EXIT     00542000
*                                      CODE                          */ 00543000
*                 RTRNCODE=INSUFSTG;/* SET PROPER RETURN CODE        */ 00544000
         MVC   RTRNCODE(4),@CF00101                             02S0243 00545000
*                 GO TO AHLEXIT;    /* EXIT FFROM AHLSETEV           */ 00546000
         B     AHLEXIT                                          02S0244 00547000
*               END;                                            02S0245 00548000
*                                                               02S0245 00549000
*             /*******************************************************/ 00550000
*             /*                                                     */ 00551000
*             /* NEW MCEE HAS BEEN OBTAINED - INITIALIZE AND PLACE ON*/ 00552000
*             /* CHAIN                                               */ 00553000
*             /*                                                     */ 00554000
*             /*******************************************************/ 00555000
*                                                               02S0246 00556000
*             ELEMAD=GETMADDR;      /* POINT TO GOTTEN STORAGE       */ 00557000
@RF00241 L     @06,GETMADDR                                     02S0246 00558000
         ST    @06,ELEMAD                                       02S0246 00559000
*             MCEEIDEN=MCEETAG;     /* PLACE TABLE IDENTIFIER IN        00560000
*                                      TABLE                         */ 00561000
         MVC   MCEEIDEN(8,@06),@CC00174                         02S0247 00562000
*             MCEEFLGS=0;           /* CLEAR THE FLAGS AND EID FIELDS*/ 00563000
         SLR   @15,@15                                          02S0248 00564000
         ST    @15,MCEEFLGS(,@06)                               02S0248 00565000
*             MCEEEID=PLISTEID;     /* MOVE EID FROM PLIST ENTRY INTO   00566000
*                                      NEW MCEE                      */ 00567000
         MVC   MCEEEID(2,@06),PLISTEID(LISTELM)                 02S0249 00568000
*             MCEERTN=ELISTRTN;     /* MOVE ROUTINE ADDRESS FROM        00569000
*                                      PLIST ENTRY INTO MCEE         */ 00570000
         MVC   MCEERTN(4,@06),ELISTRTN(LISTELM)                 02S0250 00571000
*             MCEEMCQE=MCQEPTR;     /* PLACE CORRESPONDING MCQE ADDR    00572000
*                                      INTO MCEE                     */ 00573000
         ST    MCQEPTR,MCEEMCQE(,@06)                           02S0251 00574000
*             MCEEEIDL=0;           /* INDICATE THIS IS END OF CHAIN    00575000
*                                      FROM MCED                     */ 00576000
         ST    @15,MCEEEIDL(,@06)                               02S0252 00577000
*             MCEEMCQL=0;           /* INDICATE THIS IS LAST IN CHAIN   00578000
*                                      FROM MCQE                     */ 00579000
         ST    @15,MCEEMCQL(,@06)                               02S0253 00580000
*             IF LASTELM=0 THEN                                 02S0254 00581000
         CR    LASTELM,@15                                      02S0254 00582000
         BNE   @RF00254                                         02S0254 00583000
*               MCQEMCEE=ELEMAD;    /* IF THIS IS FIRST MCEE, STORE     00584000
*                                      ITS ADDR INTO MCQE            */ 00585000
         ST    @06,MCQEMCEE(,MCQEPTR)                           02S0255 00586000
*             ELSE                                              02S0256 00587000
*               LASTELM->MCEEMCQL=ELEMAD;/* IF NOT THE FIRST ONE,       00588000
*                                      PLACE ITS ADDRESS IN LINK        00589000
*                                      FIELD OF THE PRIOR LAST ONE   */ 00590000
*                                                               02S0256 00591000
         B     @RC00254                                         02S0256 00592000
@RF00254 L     @06,ELEMAD                                       02S0256 00593000
         ST    @06,MCEEMCQL(,LASTELM)                           02S0256 00594000
*             /*******************************************************/ 00595000
*             /*                                                     */ 00596000
*             /* UPDATE TO NEXT ENTRY IN EIDLIST                     */ 00597000
*             /*                                                     */ 00598000
*             /*******************************************************/ 00599000
*                                                               02S0257 00600000
*AHLADD01:                                                      02S0257 00601000
*             LISTELM=LISTELM+LENGTH(EIDLIST);/* POINT TO NEXT ENTRY    00602000
*                                      IN EID LIST                   */ 00603000
@RC00254 DS    0H                                               02S0257 00604000
AHLADD01 AL    LISTELM,@CF00250                                 02S0257 00605000
*             TMPCNT=TMPCNT-1;      /* DECREMENT COUNT BY THE ONE WE    00606000
*                                      JUST PROCESSED                */ 00607000
         BCTR  TMPCNT,0                                         02S0258 00608000
*           END;                    /* END OF LOOP WHICH PROCESSES      00609000
*                                      EID LIST                      */ 00610000
@DE00220 LTR   TMPCNT,TMPCNT                                    02S0259 00611000
         BNZ   @DL00220                                         02S0259 00612000
*                                                               02S0260 00613000
*           /*********************************************************/ 00614000
*           /*                                                       */ 00615000
*           /* PROCESS THE SPECIFIED CLASSES IN THE CLASS LIST PASSED*/ 00616000
*           /* BY THE CALLER.                                        */ 00617000
*           /*                                                       */ 00618000
*           /*********************************************************/ 00619000
*                                                               02S0260 00620000
*           LISTELM=CLSLSTAD;       /* INITIALIZE TO THE FIRST ENTRY    00621000
*                                      IN THE CLASS LIST             */ 00622000
         L     @06,PLISTAD                                      02S0260 00623000
         ICM   LISTELM,15,CLSLSTAD(@06)                         02S0260 00624000
*           TMPCNT=CLSNUM;          /* PICK UP THE NUMBER OF CLASSES    00625000
*                                      IN THE LIST                   */ 00626000
         SLR   TMPCNT,TMPCNT                                    02S0261 00627000
         IC    TMPCNT,CLSNUM(,@06)                              02S0261 00628000
*           DO WHILE(TMPCNT^=0);    /* PERFORM THE FOLLOWING FOR EACH   00629000
*                                      ENTRY IN THE CLASS LIST       */ 00630000
         B     @DE00262                                         02S0262 00631000
@DL00262 DS    0H                                               02S0263 00632000
*             ELEMAD=MCQEMCCL;      /* PICK UP FIRST MCCLE ADDRESS   */ 00633000
         L     @06,MCQEMCCL(,MCQEPTR)                           02S0263 00634000
         ST    @06,ELEMAD                                       02S0263 00635000
*             LASTELM=0;            /* INDICATE THAT THIS IS FIRST      00636000
*                                      ONE ON CHAIN                  */ 00637000
*                                                               02S0264 00638000
         SLR   LASTELM,LASTELM                                  02S0264 00639000
*             /*******************************************************/ 00640000
*             /*                                                     */ 00641000
*             /* LOOP THRU THE MCCLE CHAIN, CHECKING FOR A CLASS THAT*/ 00642000
*             /* MATCHES THE CLASS IN THE CLSLIST ENTRY UNDER        */ 00643000
*             /* CONSIDERATION. IF A MATCHING CLASS IS FOUND, IT IS  */ 00644000
*             /* IQNORED. THIS LOOP CONTINUES UNTIL THE END OF THE   */ 00645000
*             /* MCCLE CHAIN IS REACHED, INDICATED BY A ZERO LINK    */ 00646000
*             /* FIELD.                                              */ 00647000
*             /*                                                     */ 00648000
*             /*******************************************************/ 00649000
*                                                               02S0265 00650000
*             DO WHILE(ELEMAD^=0);  /* LOOP UNTIL END OF CHAIN       */ 00651000
         B     @DE00265                                         02S0265 00652000
@DL00265 DS    0H                                               02S0266 00653000
*               IF MCCLCLAS=PLISTCLS THEN                       02S0266 00654000
         L     @06,ELEMAD                                       02S0266 00655000
         CLC   MCCLCLAS(2,@06),PLISTCLS(LISTELM)                02S0266 00656000
         BE    @RT00266                                         02S0266 00657000
*                 GO TO AHLADD02;   /* GO PROCESS NEXT CLASS LIST       00658000
*                                      ENTRY IF THIS CLASS IS ALREADY   00659000
*                                      DEFINED TO MCQE               */ 00660000
*               LASTELM=ELEMAD;     /* THIS MCCLE NOW BECOMES PRIOR  */ 00661000
         LR    LASTELM,@06                                      02S0268 00662000
*               ELEMAD=MCCLMCQL;    /* UPDATE POINTER TO THE NEXT       00663000
*                                      MCCLE                         */ 00664000
         L     @06,MCCLMCQL(,@06)                               02S0269 00665000
         ST    @06,ELEMAD                                       02S0269 00666000
*             END;                                              02S0270 00667000
*                                                               02S0270 00668000
@DE00265 L     @06,ELEMAD                                       02S0270 00669000
         LTR   @06,@06                                          02S0270 00670000
         BNZ   @DL00265                                         02S0270 00671000
*             /*******************************************************/ 00672000
*             /*                                                     */ 00673000
*             /* FALL THROUGH TO THE FOLLOWING CODE INDICATES THAT   */ 00674000
*             /* THE CLASS IS NOT DEFINED IN THE PRESENT MCCLE CHAIN.*/ 00675000
*             /* A NEW MCCLE IS OBTAINED, INITIALIZED, AND ENTERED ON*/ 00676000
*             /* THE CHAIN.                                          */ 00677000
*             /*                                                     */ 00678000
*             /*******************************************************/ 00679000
*                                                               02S0271 00680000
*             DO;                   /* GETMAIN (EC) LV(LENGTH(MCCLE))   00681000
*                                      A(GETMADDR) SP(SQA)           */ 00682000
*               RESPECIFY                                       02S0272 00683000
*                (GPR01P) RESTRICTED;                           02S0272 00684000
*               I004=I004&&I004;    /* INIT LIST                     */ 00685000
         XC    I004(10),I004                                    02S0273 00686000
*               I00404='20'X;       /* TYPE                          */ 00687000
         MVI   I00404,X'20'                                     02S0274 00688000
*               I00401=LENGTH(MCCLE);/* LENGTH                       */ 00689000
         MVC   I00401(4),@CF00106                               02S0275 00690000
*               I00403=ADDR(GETMADDR);/* ADDR OF ADDR LIST           */ 00691000
         LA    @06,GETMADDR                                     02S0276 00692000
         STCM  @06,7,I00403                                     02S0276 00693000
*               I00405=SQA;         /* SUBPOOL VALUE                 */ 00694000
         MVI   I00405,X'F5'                                     02S0277 00695000
*               GPR01P=ADDR(I004);  /* REG1 POINTS TO LIST           */ 00696000
         LA    GPR01P,I004                                      02S0278 00697000
*               SVC(4);             /* STANDARD-FORM OF GETMAIN      */ 00698000
         SVC   4                                                02S0279 00699000
*               RESPECIFY                                       02S0280 00700000
*                (GPR01P) UNRESTRICTED;                         02S0280 00701000
*             END;                  /* GETMAIN (EC) LV(LENGTH(MCCLE))   00702000
*                                      A(GETMADDR) SP(SQA)           */ 00703000
*             IF RETCOD15^=0 THEN                               02S0282 00704000
         LTR   RETCOD15,RETCOD15                                02S0282 00705000
         BZ    @RF00282                                         02S0282 00706000
*               DO;                 /* IF SQA IS FULL, INDICATE THE     00707000
*                                      INSUFFICIENT STORAGE CONDITION   00708000
*                                      AND PASS CONTROL TO THE EXIT     00709000
*                                      CODE                          */ 00710000
*                 RTRNCODE=INSUFSTG;/* SET PROPER RETURN CODE        */ 00711000
         MVC   RTRNCODE(4),@CF00101                             02S0284 00712000
*                 GO TO AHLEXIT;    /* EXIT FOR AHLSETEV             */ 00713000
         B     AHLEXIT                                          02S0285 00714000
*               END;                                            02S0286 00715000
*                                                               02S0286 00716000
*             /*******************************************************/ 00717000
*             /*                                                     */ 00718000
*             /* NEW MCCLE HAS BEEN OBTAINED - INITIALIZE AND PLACE  */ 00719000
*             /* ON CHAIN                                            */ 00720000
*             /*                                                     */ 00721000
*             /*******************************************************/ 00722000
*                                                               02S0287 00723000
*             ELEMAD=GETMADDR;      /* POINT TO GOTTEN STORAGE       */ 00724000
@RF00282 L     @06,GETMADDR                                     02S0287 00725000
         ST    @06,ELEMAD                                       02S0287 00726000
*             MCCLIDEN=MCCLETAG;    /* PLACE TABLE IDENTIFIER IN        00727000
*                                      TABLE                         */ 00728000
         MVC   MCCLIDEN(8,@06),@CC00176                         02S0288 00729000
*             MCCLFLGS=0;           /* CLEAR THE FLAGS AND CLASS        00730000
*                                      FIELDS                        */ 00731000
         SLR   @15,@15                                          02S0289 00732000
         ST    @15,MCCLFLGS(,@06)                               02S0289 00733000
*             MVZ(MCCLCLS2,PLSTCLS2);/* MOVE CLASS ONLY (HI ORDER 4     00734000
*                                      BITS) INTO MCCLE              */ 00735000
         MVZ   MCCLCLS2(1,@06),PLSTCLS2(LISTELM)                02S0290 00736000
*             MCCLRTN=CLISTRTN;     /* MOVE ROUTINE ADDRESS FROM        00737000
*                                      PLIST ENTRY INTO MCCLE        */ 00738000
         MVC   MCCLRTN(4,@06),CLISTRTN(LISTELM)                 02S0291 00739000
*             MCCLMCQE=MCQEPTR;     /* PLACE CORRESPONDING MCQE ADDR    00740000
*                                      INTO MCCLE                    */ 00741000
         ST    MCQEPTR,MCCLMCQE(,@06)                           02S0292 00742000
*             MCCLEIDL=0;           /* INDICATE THIS IS END OF CHAIN    00743000
*                                      FROM MCCD                     */ 00744000
         ST    @15,MCCLEIDL(,@06)                               02S0293 00745000
*             MCCLMCQL=0;           /* INDICATE THIS IS LAST IN CHAIN   00746000
*                                      FROM MCQE                     */ 00747000
         ST    @15,MCCLMCQL(,@06)                               02S0294 00748000
*             IF LASTELM=0 THEN                                 02S0295 00749000
         CR    LASTELM,@15                                      02S0295 00750000
         BNE   @RF00295                                         02S0295 00751000
*               MCQEMCCL=ELEMAD;    /* IF THIS IS FIRST MCCLE, STORE    00752000
*                                      ITS ADDR INTO MCQE            */ 00753000
         ST    @06,MCQEMCCL(,MCQEPTR)                           02S0296 00754000
*             ELSE                                              02S0297 00755000
*               LASTELM->MCCLMCQL=ELEMAD;/* IF NOT THE FIRST ONE,       00756000
*                                      PLACE ITS ADDRESS IN LINK        00757000
*                                      FIELD OF THE PRIOR LAST ONE   */ 00758000
*                                                               02S0297 00759000
         B     @RC00295                                         02S0297 00760000
@RF00295 L     @06,ELEMAD                                       02S0297 00761000
         ST    @06,MCCLMCQL(,LASTELM)                           02S0297 00762000
*             /*******************************************************/ 00763000
*             /*                                                     */ 00764000
*             /* UPDATE TO NEXT ENTRY IN CLASS LIST                  */ 00765000
*             /*                                                     */ 00766000
*             /*******************************************************/ 00767000
*                                                               02S0298 00768000
*AHLADD02:                                                      02S0298 00769000
*             LISTELM=LISTELM+LENGTH(CLSLIST);/* POINT TO NEXT ENTRY    00770000
*                                      IN EID LIST                   */ 00771000
@RC00295 DS    0H                                               02S0298 00772000
AHLADD02 AL    LISTELM,@CF00250                                 02S0298 00773000
*             TMPCNT=TMPCNT-1;      /* DECREMENT COUNT BY THE ONE WE    00774000
*                                      JUST PROCESSED                */ 00775000
         BCTR  TMPCNT,0                                         02S0299 00776000
*           END;                    /* END OF LOOP WHICH PROCESSES      00777000
*                                      CLASS LIST                    */ 00778000
@DE00262 LTR   TMPCNT,TMPCNT                                    02S0300 00779000
         BNZ   @DL00262                                         02S0300 00780000
*         END;                      /* END OF ZERO RETURN CODE PATH. */ 00781000
*       ELSE                                                    02S0302 00782000
*         GO TO AHLEXIT;            /* IF RETURN CODE FROM GETMCQE IS   00783000
*                                      BAD, PASS IT ON TO CALLER     */ 00784000
*     END;                                                      01S0303 00785000
*   IF ACTIVATE='1'B THEN                                       01S0304 00786000
@RF00199 L     @06,PLISTAD                                      01S0304 00787000
         TM    ACTIVATE(@06),B'01000000'                        01S0304 00788000
         BNO   @RF00304                                         01S0304 00789000
*     DO;                                                       01S0305 00790000
*                                                               02S0306 00791000
*       /*************************************************************/ 00792000
*       /*                                                           */ 00793000
*       /* ACTIVATE FUNCTION HAS BEEN REQUESTED. THE CALLERS MCQE IS */ 00794000
*       /* TO BE ACTIVATED BY INSERTING ALL MCEES AND MCCLES INTO THE*/ 00795000
*       /* ROUTING TABLES, AND ENSURING THAT MC ROUTING IS ACTIVE    */ 00796000
*       /*                                                           */ 00797000
*       /*************************************************************/ 00798000
*                                                               02S0306 00799000
*       RFY                                                     02S0306 00800000
*         MCCE BASED(MCHCUR);                                   02S0306 00801000
*       IF MCHCUR=0|MCCEQEA=0 THEN                              02S0307 00802000
         SLR   @06,@06                                          02S0307 00803000
         L     @04,MCHEADPT                                     02S0307 00804000
         L     @04,MCHCUR(,@04)                                 02S0307 00805000
         CR    @04,@06                                          02S0307 00806000
         BE    @RT00307                                         02S0307 00807000
         C     @06,MCCEQEA(,@04)                                02S0307 00808000
         BNE   @RF00307                                         02S0307 00809000
@RT00307 DS    0H                                               02S0308 00810000
*AHLACT01:                                                      02S0308 00811000
*         DO;                       /* IF THERE IS NO MCQE CHAIN, MC    00812000
*                                      ROUTING MUST HAVE TERMINATED  */ 00813000
*                                                               02S0308 00814000
AHLACT01 DS    0H                                               02S0309 00815000
*           /*********************************************************/ 00816000
*           /*                                                       */ 00817000
*           /* THE FOLLOWING CODE IS ENTERED IF THE MCQE IN THE      */ 00818000
*           /* PARAMETER LIST CANNOT BE FOUND ON THE MCQE CHAIN. THIS*/ 00819000
*           /* CAN HAPPEN IF THE MC ROUTING FACILITY HAS TERMINATED, */ 00820000
*           /* OR IF THE MCQE ADDRESS IN THE PARAMETER LIST IS       */ 00821000
*           /* INVALID. THE FORMER CASE IS ASSUMED IF THE MCQE       */ 00822000
*           /* CONTAINS A VALID IDENTIFIER AND APPLICATION NAME.     */ 00823000
*           /* OTHERWISE, THE CALLER IS ABENDED.                     */ 00824000
*           /*                                                       */ 00825000
*           /*********************************************************/ 00826000
*                                                               02S0309 00827000
*           RFY                                                 02S0309 00828000
*             MCQE BASED(PASSEDQE);                             02S0309 00829000
*           IF MCQEIDEN=MCQETAG&MCQENAME=PLISTNAM THEN          02S0310 00830000
         L     @06,PLISTAD                                      02S0310 00831000
         ICM   @15,15,PASSEDQE(@06)                             02S0310 00832000
         CLC   MCQEIDEN(8,@15),@CC00170                         02S0310 00833000
         BNE   @RF00310                                         02S0310 00834000
         CLC   MCQENAME(8,@15),PLISTNAM(@06)                    02S0310 00835000
         BNE   @RF00310                                         02S0310 00836000
*             RTRNCODE=TERMPHSE;    /* IF MCQE PASSES VALIDITY  02S0311 00837000
*                                      CHECKS, SET RETURN CODE TO       00838000
*                                      INDICATE TERMINATION          */ 00839000
         MVC   RTRNCODE(4),@CF00097                             02S0311 00840000
*           ELSE                                                02S0312 00841000
*AHLACT02:                                                      02S0312 00842000
*             DO;                                               02S0312 00843000
*                                                               02S0312 00844000
         B     @RC00310                                         02S0312 00845000
@RF00310 DS    0H                                               02S0312 00846000
AHLACT02 DS    0H                                               02S0313 00847000
*               /*****************************************************/ 00848000
*               /*                                                   */ 00849000
*               /* ABEND CALLER DUE TO INVALID PARAMETER LIST        */ 00850000
*               /*                                                   */ 00851000
*               /*****************************************************/ 00852000
*                                                               02S0313 00853000
*               RFY                                             02S0313 00854000
*                 ABNDCODE RSTD;                                02S0313 00855000
*               ABNDCODE=INVALQE1;  /* SET PROPER ABEND INDICATOR    */ 00856000
         LA    ABNDCODE,8                                       02S0314 00857000
*               DO;                 /* ABEND(SETCMPCD) DUMP SYSTEM   */ 00858000
*                 RESPECIFY                                     02S0316 00859000
*                  (GPR01F) RESTRICTED;                         02S0316 00860000
*                 GPR01F=((SETCMPCD)&'00000FFF'X)*4096;/* COMP CODE     00861000
*                                      IN BITS 8-19                  */ 00862000
         L     GPR01F,@CF02503                                  02S0317 00863000
*                 GPR01F=GPR01F|'80000000'X;/* DUMP/STEP/DUMPOPTS       00864000
*                                      FLAG                          */ 00865000
         O     GPR01F,@CF02273                                  02S0318 00866000
*                 SVC(13);          /* ISSUE ABEND SVC               */ 00867000
         SVC   13                                               02S0319 00868000
*                 RESPECIFY                                     02S0320 00869000
*                  (GPR01F) UNRESTRICTED;                       02S0320 00870000
*               END;                /* ABEND(SETCMPCD) DUMP SYSTEM   */ 00871000
*               RFY                                             02S0322 00872000
*                 ABNDCODE UNRSTD;                              02S0322 00873000
*             END;                                              02S0323 00874000
*         END;                      /* END OF NO MCQE CHAIN PATH     */ 00875000
*       ELSE                                                    02S0325 00876000
*         DO;                                                   02S0325 00877000
*                                                               02S0325 00878000
         B     @RC00307                                         02S0325 00879000
@RF00307 DS    0H                                               02S0326 00880000
*           /*********************************************************/ 00881000
*           /*                                                       */ 00882000
*           /* SEARCH MCQE CHAIN FOR AN MCQE WHICH CONTAINS THE SAME */ 00883000
*           /* NAME AS IN THE PARAMETER LIST                         */ 00884000
*           /*                                                       */ 00885000
*           /*********************************************************/ 00886000
*                                                               02S0326 00887000
*           MCQEPTR=MCCEQEA;        /* POINT TO FIRST MCQE ON THE       00888000
*                                      CHAIN                         */ 00889000
         L     @06,MCHEADPT                                     02S0326 00890000
         L     @06,MCHCUR(,@06)                                 02S0326 00891000
         L     MCQEPTR,MCCEQEA(,@06)                            02S0326 00892000
*           RFY                                                 02S0327 00893000
*             MCQE BASED(MCQEPTR);                              02S0327 00894000
*AHLACT05:                                                      02S0328 00895000
*           IF MCQENAME=PLISTNAM THEN                           02S0328 00896000
AHLACT05 L     @06,PLISTAD                                      02S0328 00897000
         CLC   MCQENAME(8,MCQEPTR),PLISTNAM(@06)                02S0328 00898000
         BNE   @RF00328                                         02S0328 00899000
*             DO;                                               02S0329 00900000
*                                                               02S0329 00901000
*               /*****************************************************/ 00902000
*               /*                                                   */ 00903000
*               /* MCQE WITH SAME NAME HAS BEEN FOUND                */ 00904000
*               /*                                                   */ 00905000
*               /*****************************************************/ 00906000
*                                                               02S0330 00907000
*               IF MCQEPTR^=PASSEDQE THEN                       02S0330 00908000
         ICM   @15,15,PASSEDQE(@06)                             02S0330 00909000
         CR    MCQEPTR,@15                                      02S0330 00910000
         BE    @RF00330                                         02S0330 00911000
*                 IF PASSEDQE^=0|ADD^='1'B THEN                 02S0331 00912000
         LTR   @15,@15                                          02S0331 00913000
         BNZ   @RT00331                                         02S0331 00914000
         TM    ADD(@06),B'10000000'                             02S0331 00915000
         BNO   @RT00331                                         02S0331 00916000
*                   GO TO AHLACT02; /* IF THIS IS NOT THE SAME  02S0332 00917000
*                                      ADDRESS AS IN THE PARAMETER      00918000
*                                      LIST, ABEND THE CALLER UNLESS    00919000
*                                      HIS MCQE HAS JUST BEEN GOTTEN    00920000
*                                      ON THIS CALL                  */ 00921000
*                                                               02S0333 00922000
*               /*****************************************************/ 00923000
*               /*                                                   */ 00924000
*               /* THE MCQE TO BE ACTIVATED HAS BEEN FOUND. IF IT    */ 00925000
*               /* CONTAINS NEITHER MCEES NOR MCCLES, THE CALLER IS  */ 00926000
*               /* ABENDED. OTHERWISE, THE MCEES AND MCCLES ARE      */ 00927000
*               /* INSERTED INTO THE PROPER ROUTING TABLES           */ 00928000
*               /*                                                   */ 00929000
*               /*****************************************************/ 00930000
*                                                               02S0333 00931000
*               IF MCQEMCEE=0 THEN                              02S0333 00932000
@RF00330 SLR   @06,@06                                          02S0333 00933000
         C     @06,MCQEMCEE(,MCQEPTR)                           02S0333 00934000
         BNE   @RF00333                                         02S0333 00935000
*                 IF MCQEMCCL=0 THEN                            02S0334 00936000
         C     @06,MCQEMCCL(,MCQEPTR)                           02S0334 00937000
         BNE   @RF00334                                         02S0334 00938000
*                   DO;             /* IF BOTH CHAINS ARE NULL, ABEND   00939000
*                                      CALLER                        */ 00940000
*                     RFY                                       02S0336 00941000
*                       ABNDCODE RSTD;                          02S0336 00942000
*                     ABNDCODE=INVALQE2;                        02S0337 00943000
         LA    ABNDCODE,12                                      02S0337 00944000
*                     DO;           /* ABEND(SETCMPCD) DUMP SYSTEM   */ 00945000
*                       RESPECIFY                               02S0339 00946000
*                        (GPR01F) RESTRICTED;                   02S0339 00947000
*                       GPR01F=((SETCMPCD)&'00000FFF'X)*4096;/* COMP    00948000
*                                      CODE IN BITS 8-19             */ 00949000
         L     GPR01F,@CF02503                                  02S0340 00950000
*                       GPR01F=GPR01F|'80000000'X;/*            02S0341 00951000
*                                      DUMP/STEP/DUMPOPTS FLAG       */ 00952000
         O     GPR01F,@CF02273                                  02S0341 00953000
*                       SVC(13);    /* ISSUE ABEND SVC               */ 00954000
         SVC   13                                               02S0342 00955000
*                       RESPECIFY                               02S0343 00956000
*                        (GPR01F) UNRESTRICTED;                 02S0343 00957000
*                     END;          /* ABEND(SETCMPCD) DUMP SYSTEM   */ 00958000
*                     RFY                                       02S0345 00959000
*                       ABNDCODE UNRSTD;                        02S0345 00960000
*                   END;            /* END OF ABEND PATH             */ 00961000
*                 ELSE                                          02S0347 00962000
*AHLACT03:                                                      02S0347 00963000
*                   DO;             /* MCCLES EXIST - INSERT THEM       00964000
*                                      INTO MCCD                     */ 00965000
         B     @RC00334                                         02S0347 00966000
@RF00334 DS    0H                                               02S0347 00967000
AHLACT03 DS    0H                                               02S0348 00968000
*                                                               03S0348 00969000
*                     /***********************************************/ 00970000
*                     /*                                             */ 00971000
*                     /* MCCLES ARE TO BE INSERTED INTO THE CLASS    */ 00972000
*                     /* DIRECTORY FOR THE MCQE POINTED TO BY        */ 00973000
*                     /* MCQEPTR. FIRST, FIND OR OBTAIN THE CURRENT  */ 00974000
*                     /* CLASS DIRECTORY (MCCD).                     */ 00975000
*                     /*                                             */ 00976000
*                     /***********************************************/ 00977000
*                                                               03S0348 00978000
*                     IF MCCECDA=0 THEN                         03S0348 00979000
         L     @06,MCHEADPT                                     03S0348 00980000
         L     @06,MCHCUR(,@06)                                 03S0348 00981000
         L     @06,MCCECDA(,@06)                                03S0348 00982000
         LTR   @06,@06                                          03S0348 00983000
         BNZ   @RF00348                                         03S0348 00984000
*                       DO;         /* IF AN MCCD DOES NOT EXIST, GET   00985000
*                                      ONE                           */ 00986000
*                         DO;       /* GETMAIN (EC) LV(LENGTH(MCCD))    00987000
*                                      A(GETMADDR) SP(SQA)           */ 00988000
*                           RESPECIFY                           03S0351 00989000
*                            (GPR01P) RESTRICTED;               03S0351 00990000
*                           I004=I004&&I004;/* INIT LIST             */ 00991000
         XC    I004(10),I004                                    03S0352 00992000
*                           I00404='20'X;/* TYPE                     */ 00993000
         MVI   I00404,X'20'                                     03S0353 00994000
*                           I00401=LENGTH(MCCD);/* LENGTH            */ 00995000
         MVC   I00401(4),@CF02505                               03S0354 00996000
*                           I00403=ADDR(GETMADDR);/* ADDR OF ADDR       00997000
*                                      LIST                          */ 00998000
         LA    @06,GETMADDR                                     03S0355 00999000
         STCM  @06,7,I00403                                     03S0355 01000000
*                           I00405=SQA;/* SUBPOOL VALUE              */ 01001000
         MVI   I00405,X'F5'                                     03S0356 01002000
*                           GPR01P=ADDR(I004);/* REG1 POINTS TO LIST */ 01003000
         LA    GPR01P,I004                                      03S0357 01004000
*                           SVC(4); /* STANDARD-FORM OF GETMAIN      */ 01005000
         SVC   4                                                03S0358 01006000
*                           RESPECIFY                           03S0359 01007000
*                            (GPR01P) UNRESTRICTED;             03S0359 01008000
*                         END;      /* GETMAIN (EC) LV(LENGTH(MCCD))    01009000
*                                      A(GETMADDR) SP(SQA)           */ 01010000
*                         IF RETCOD15^=0 THEN                   03S0361 01011000
         LTR   RETCOD15,RETCOD15                                03S0361 01012000
         BZ    @RF00361                                         03S0361 01013000
*                           DO;     /* IF IT CANNOT BE OBTAINED,        01014000
*                                      INDICATE THIS CONDITION TO THE   01015000
*                                      CALLER                        */ 01016000
*                             RTRNCODE=INSUFSTG;/* SET          03S0363 01017000
*                                      NOT-ENOUGH-STORAGE CODE       */ 01018000
         MVC   RTRNCODE(4),@CF00101                             03S0363 01019000
*                             GO TO AHLEXIT;/* QUIT PROCESSING       */ 01020000
         B     AHLEXIT                                          03S0364 01021000
*                           END;                                03S0365 01022000
*                         RFY                                   03S0366 01023000
*                           MCCD BASED(GETMADDR);               03S0366 01024000
*                                                               03S0366 01025000
@RF00361 DS    0H                                               03S0367 01026000
*                         /*******************************************/ 01027000
*                         /*                                         */ 01028000
*                         /* INITIALIZE NEW MCCD                     */ 01029000
*                         /*                                         */ 01030000
*                         /*******************************************/ 01031000
*                                                               03S0367 01032000
*                         MCCD(1:LENGTH(MCCD))=''B;/* ZERO OUT ENTIRE   01033000
*                                      TABLE                         */ 01034000
         L     @06,GETMADDR                                     03S0367 01035000
         XC    MCCD(76,@06),MCCD(@06)                           03S0367 01036000
*                         MCCDIDEN=MCCDTAG;/* PLACE TABLE IDENTIFIER    01037000
*                                      IN ITS PLACE                  */ 01038000
         MVC   MCCDIDEN(8,@06),@CC00172                         03S0368 01039000
*                         MCCECDA=GETMADDR;/* PLACE ADDRESS INTO MCCE*/ 01040000
         L     @01,MCHEADPT                                     03S0369 01041000
         L     @01,MCHCUR(,@01)                                 03S0369 01042000
         ST    @06,MCCECDA(,@01)                                03S0369 01043000
*                       END;                                    03S0370 01044000
*                                                               03S0371 01045000
*                     /***********************************************/ 01046000
*                     /*                                             */ 01047000
*                     /* USING EACH MCCLE OFF THE MCQE AS ARGUMENTS, */ 01048000
*                     /* DETERMINE WHETHER EACH MCCLE IS OR IS NOT   */ 01049000
*                     /* DEFINED TO THE MCCD. IF IT IS, IGNORE THAT  */ 01050000
*                     /* MCCLE. IF NOT, INSERT IT INTO THE TABLE     */ 01051000
*                     /* STRUCTURE.                                  */ 01052000
*                     /*                                             */ 01053000
*                     /***********************************************/ 01054000
*                                                               03S0371 01055000
*                     RFY                                       03S0371 01056000
*                       MCCD BASED(MCCECDA);                    03S0371 01057000
@RF00348 DS    0H                                               03S0372 01058000
*                     ARGUMENT=MCQEMCCL;/* PICK UP FIRST MCCLE  03S0372 01059000
*                                      ADDRESS                       */ 01060000
         L     ARGUMENT,MCQEMCCL(,MCQEPTR)                      03S0372 01061000
*                     RFY                                       03S0373 01062000
*                       MCCLE BASED(ARGUMENT);                  03S0373 01063000
*                     DO WHILE(ARGUMENT^=0);/* PROCESS UNTIL    03S0374 01064000
*                                      END-OF-CHAIN                  */ 01065000
         B     @DE00374                                         03S0374 01066000
@DL00374 DS    0H                                               03S0375 01067000
*                       INDEX=(MCCLCLS/16)+1;/* CALCULATE INDEX INTO    01068000
*                                      THE MCCD BY USING THE CLASS IN   01069000
*                                      THE ARGUMENT MCCLE            */ 01070000
         LA    @06,1                                            03S0375 01071000
         SLR   INDEX,INDEX                                      03S0375 01072000
         IC    INDEX,MCCLCLS(,ARGUMENT)                         03S0375 01073000
         SRL   INDEX,4                                          03S0375 01074000
         ALR   INDEX,@06                                        03S0375 01075000
*                       IF MCCDCLE(INDEX)=0 THEN                03S0376 01076000
         LR    @03,INDEX                                        03S0376 01077000
         SLA   @03,2                                            03S0376 01078000
         L     @01,MCHEADPT                                     03S0376 01079000
         L     @01,MCHCUR(,@01)                                 03S0376 01080000
         L     @15,MCCECDA(,@01)                                03S0376 01081000
         L     @00,MCCDCLE-4(@03,@15)                           03S0376 01082000
         LTR   @00,@00                                          03S0376 01083000
         BNZ   @RF00376                                         03S0376 01084000
*                         DO;                                   03S0377 01085000
*                                                               03S0377 01086000
*                           /*****************************************/ 01087000
*                           /*                                       */ 01088000
*                           /* IF THE INDEXED ELEMENT IS ZERO, THIS  */ 01089000
*                           /* IS A NEW CLASS TO BE DEFINED.         */ 01090000
*                           /*                                       */ 01091000
*                           /*****************************************/ 01092000
*                                                               03S0378 01093000
*                           MCCDCLE(INDEX)=ARGUMENT;/* DEFINE MCCLE     01094000
*                                      TO MCCD                       */ 01095000
         ST    ARGUMENT,MCCDCLE-4(@03,@15)                      03S0378 01096000
*                           MCCDCNT=MCCDCNT+1;/* INCREMENT COUNT OF     01097000
*                                      ACTIVE CLASSES BY ONE.        */ 01098000
         AH    @06,MCCDCNT(,@15)                                03S0379 01099000
         STH   @06,MCCDCNT(,@15)                                03S0379 01100000
*                         END;                                  03S0380 01101000
*                       ELSE                                    03S0381 01102000
*                         DO;                                   03S0381 01103000
*                                                               03S0381 01104000
         B     @RC00376                                         03S0381 01105000
@RF00376 DS    0H                                               03S0382 01106000
*                           /*****************************************/ 01107000
*                           /*                                       */ 01108000
*                           /* THIS CLASS ALREADY HAS MCCLES ACTIVE. */ 01109000
*                           /* SEARCH THE MCCLE CHAIN POINTED TO BE  */ 01110000
*                           /* THIS ENTRY TO SEE IF THE ARGUMENT     */ 01111000
*                           /* MCCLE IS ON IT. IF IT IS, BYPASS THIS */ 01112000
*                           /* MCCLE. IF NOT, PLACE IT ON THE END OF */ 01113000
*                           /* THE CHAIN                             */ 01114000
*                           /*                                       */ 01115000
*                           /*****************************************/ 01116000
*                                                               03S0382 01117000
*                           ELEMAD=MCCDCLE(INDEX);/* PICK UP CHAIN      01118000
*                                      HEAD                          */ 01119000
         LR    @06,INDEX                                        03S0382 01120000
         SLA   @06,2                                            03S0382 01121000
         L     @03,MCHEADPT                                     03S0382 01122000
         L     @03,MCHCUR(,@03)                                 03S0382 01123000
         L     @03,MCCECDA(,@03)                                03S0382 01124000
         L     @06,MCCDCLE-4(@06,@03)                           03S0382 01125000
         ST    @06,ELEMAD                                       03S0382 01126000
*                           DO WHILE(ELEMAD^=0);/* LOOP UNTIL   03S0383 01127000
*                                      END-OF-CHAIN                  */ 01128000
         B     @DE00383                                         03S0383 01129000
@DL00383 DS    0H                                               03S0384 01130000
*                             IF ELEMAD=ARGUMENT THEN           03S0384 01131000
         L     @06,ELEMAD                                       03S0384 01132000
         CR    @06,ARGUMENT                                     03S0384 01133000
         BE    @RT00384                                         03S0384 01134000
*                               GO TO AHLMCCL1;/* IF THE ARGUMENT       01135000
*                                      MCCLE IS ALREADY HERE, PROCESS   01136000
*                                      THE NEXT ONE OFF MCQE         */ 01137000
*                             LASTELM=ELEMAD;/* INDICATE THIS MCCLE     01138000
*                                      AS THE LAST ONE               */ 01139000
         LR    LASTELM,@06                                      03S0386 01140000
*                             ELEMAD=ELEMAD->MCCLEIDL;/* POINT TO THE   01141000
*                                      NEXT MCCLE OFF THE MCCD, FOUND   01142000
*                                      VIA THE MCCLEIDL FIELD        */ 01143000
         L     @06,MCCLEIDL(,@06)                               03S0387 01144000
         ST    @06,ELEMAD                                       03S0387 01145000
*                           END;    /* LOOP THRU CHAIN UNTIL A ZERO     01146000
*                                      LINK FIELD IS FOUND           */ 01147000
*                                                               03S0388 01148000
@DE00383 L     @06,ELEMAD                                       03S0388 01149000
         LTR   @06,@06                                          03S0388 01150000
         BNZ   @DL00383                                         03S0388 01151000
*                           /*****************************************/ 01152000
*                           /*                                       */ 01153000
*                           /* FALL THRU TO THIS CODE INDICATES THAT */ 01154000
*                           /* THE ARGUMENT MCCLE IS NOT ON THE      */ 01155000
*                           /* CHAIN. INSERT IT ONTO THE END OF THE  */ 01156000
*                           /* CHAIN                                 */ 01157000
*                           /*                                       */ 01158000
*                           /*****************************************/ 01159000
*                                                               03S0389 01160000
*                           LASTELM->MCCLEIDL=ARGUMENT;/* CHAIN 03S0389 01161000
*                                      ARGUMENT MCCLE TO THE LAST       01162000
*                                      MCCLE FOUND ON CHAIN          */ 01163000
         ST    ARGUMENT,MCCLEIDL(,LASTELM)                      03S0389 01164000
*                         END;                                  03S0390 01165000
*                                                               03S0391 01166000
*                       /*********************************************/ 01167000
*                       /*                                           */ 01168000
*                       /* PROCESS NEXT MCCLE OFF MCQE               */ 01169000
*                       /*                                           */ 01170000
*                       /*********************************************/ 01171000
*                                                               03S0391 01172000
*AHLMCCL1:                                                      03S0391 01173000
*                       ARGUMENT=MCCLMCQL;/* POINT TO NEXT MCCLE     */ 01174000
@RC00376 DS    0H                                               03S0391 01175000
AHLMCCL1 L     ARGUMENT,MCCLMCQL(,ARGUMENT)                     03S0391 01176000
*                     END;          /* PROCESS UNTIL THE END-OF-CHAIN   01177000
*                                      IS FOUND                      */ 01178000
@DE00374 LTR   ARGUMENT,ARGUMENT                                03S0392 01179000
         BNZ   @DL00374                                         03S0392 01180000
*                   END;                                        02S0393 01181000
*               ELSE                                            02S0394 01182000
*                 DO;               /* MCEES EXIST - INSERT THEM INTO   01183000
*                                      MCED                          */ 01184000
         B     @RC00333                                         02S0394 01185000
@RF00333 DS    0H                                               02S0395 01186000
*                                                               03S0395 01187000
*                   /*************************************************/ 01188000
*                   /*                                               */ 01189000
*                   /* MCEES ARE TO BE INSERTED INTO THE EVENT       */ 01190000
*                   /* DIRECTORY FOR THE MCQE POINTED TO BY MCQEPTR. */ 01191000
*                   /* FIRST, FIND OR OBTAIN THE EVENT               */ 01192000
*                   /* DIRECTORY(MCED).                              */ 01193000
*                   /*                                               */ 01194000
*                   /*************************************************/ 01195000
*                                                               03S0395 01196000
*                   RFY                                         03S0395 01197000
*                     TREEAD RSTD;                              03S0395 01198000
*                   TREEAD=MCCEEDA; /* LOAD MCED ADDRESS             */ 01199000
         L     @06,MCHEADPT                                     03S0396 01200000
         L     @06,MCHCUR(,@06)                                 03S0396 01201000
         L     TREEAD,MCCEEDA(,@06)                             03S0396 01202000
*                   IF TREEAD=0 THEN                            03S0397 01203000
         LTR   TREEAD,TREEAD                                    03S0397 01204000
         BNZ   @RF00397                                         03S0397 01205000
*                     DO;           /* IF THE MCED DOES NOT EXIST,      01206000
*                                      CREATE ONE USING THE RPTS        01207000
*                                      ROUTINES                      */ 01208000
*                       GEN                                     03S0399 01209000
*(STREE (TREEAD),TSP=245,KEYL=2,OFFSET=10,TYPE=5);              03S0399 01210000
         STREE (TREEAD),TSP=245,KEYL=2,OFFSET=10,TYPE=5                 01211000
*                       IF NOTREE<0 THEN                        03S0400 01212000
         LTR   NOTREE,NOTREE                                    03S0400 01213000
         BNM   @RF00400                                         03S0400 01214000
*                         DO;       /* IF RPTS WAS UNABLE TO OBTAIN     01215000
*                                      THE MCED, INDICATE THIS TO       01216000
*                                      CALLER                        */ 01217000
*                           RTRNCODE=INSUFSTG;/* SET NO STORAGE 03S0402 01218000
*                                      RETURN CODE                   */ 01219000
         MVC   RTRNCODE(4),@CF00101                             03S0402 01220000
*                           GO TO AHLEXIT;/* QUIT                    */ 01221000
         B     AHLEXIT                                          03S0403 01222000
*                         END;                                  03S0404 01223000
*                       MCCEEDA=TREEAD;/* IF ONE WAS OBTAINED, PLACE    01224000
*                                      THE ADDRESS INTO THE MCCE.    */ 01225000
@RF00400 L     @06,MCHEADPT                                     03S0405 01226000
         L     @06,MCHCUR(,@06)                                 03S0405 01227000
         ST    TREEAD,MCCEEDA(,@06)                             03S0405 01228000
*                     END;                                      03S0406 01229000
*                                                               03S0407 01230000
*                   /*************************************************/ 01231000
*                   /*                                               */ 01232000
*                   /* USING EACH MCEE OFF THIS MCQE AS ARGUMENTS,   */ 01233000
*                   /* SEARCH THE MCED (VIA RPTS MACRO) TO SEE IF THE*/ 01234000
*                   /* MCEE IS ALREADY DEFINED TO THE MCED. IF IT IS,*/ 01235000
*                   /* IGNORE THIS MCEE AND PROCESS THE NEXT ONE. IF */ 01236000
*                   /* IT IS NOT DEFINED TO THE MCED, INSERT IT      */ 01237000
*                   /* EITHER INTO THE MCED OR ON THE END OF THE     */ 01238000
*                   /* CHAIN POINTED TO BY THE MCED                  */ 01239000
*                   /*                                               */ 01240000
*                   /*************************************************/ 01241000
*                                                               03S0407 01242000
*                   ARGUMENT=MCQEMCEE;/* PICK UP THE FIRST MCEE TO      01243000
*                                      INSERT                        */ 01244000
@RF00397 L     ARGUMENT,MCQEMCEE(,MCQEPTR)                      03S0407 01245000
*                   DO WHILE(ARGUMENT^=0);/* PROCESS UNTIL THE LINK     01246000
*                                      FIELD INDICATE END-OF-CHAIN   */ 01247000
         B     @DE00408                                         03S0408 01248000
@DL00408 DS    0H                                               03S0409 01249000
*                     GEN                                       03S0409 01250000
*(SRCH (TREEAD),SARG=MCEEEID(0,ARGUMENT),TYPE=5,KEYL=2);/* SEARCH THE   01251000
*                                      MCED FOR THE EID IN THIS MCEE */ 01252000
         SRCH (TREEAD),SARG=MCEEEID(0,ARGUMENT),TYPE=5,KEYL=2           01253000
*                     RFY                                       03S0410 01254000
*                       SINKADDR RSTD;                          03S0410 01255000
*                     IF SINKIND<0|SINKADDR->MCEEEID^=ARGUMENT->MCEEEID 01256000
*                       THEN                                    03S0411 01257000
         LTR   SINKIND,SINKIND                                  03S0411 01258000
         BM    @RT00411                                         03S0411 01259000
         CLC   MCEEEID(2,SINKADDR),MCEEEID(ARGUMENT)            03S0411 01260000
         BE    @RF00411                                         03S0411 01261000
@RT00411 DS    0H                                               03S0412 01262000
*                       DO;                                     03S0412 01263000
*                                                               03S0412 01264000
*                         /*******************************************/ 01265000
*                         /*                                         */ 01266000
*                         /* A RETURNED NEGATIVE ADDRESS INDICATES AN*/ 01267000
*                         /* EMPTY MCED. IF THIS IS TRUE, OR IF THE  */ 01268000
*                         /* EID IN THE FOUND MCEE (POINTED TO BY    */ 01269000
*                         /* REGISTER 15) DOES NOT MATCH THE EID IN  */ 01270000
*                         /* THE ARGUMENT MCEE, THE ARGUMENT EID IS  */ 01271000
*                         /* NOT DEFINED TO THE MCED. IT IS THEREFORE*/ 01272000
*                         /* INSERTED INTO THE MCED VIA THE RPTS     */ 01273000
*                         /* ROUTINES.                               */ 01274000
*                         /*                                         */ 01275000
*                         /*******************************************/ 01276000
*                                                               03S0413 01277000
*                         GEN                                   03S0413 01278000
*(INS (TREEAD),TYPE=5,MOVE=NO,INSARG=(ARGUMENT));               03S0413 01279000
         INS (TREEAD),TYPE=5,MOVE=NO,INSARG=(ARGUMENT)                  01280000
*                         IF SINKIND<0 THEN                     03S0414 01281000
         LTR   SINKIND,SINKIND                                  03S0414 01282000
         BNM   @RF00414                                         03S0414 01283000
*                           DO;     /* IF INS FUNCTION COULD NOT        01284000
*                                      OBTAIN THE NECESSARY STORAGE,    01285000
*                                      INDICATE THIS TO CALLER       */ 01286000
*                             RTRNCODE=INSUFSTG;/* SET NO STORAGE       01287000
*                                      RETURN CODE                   */ 01288000
         MVC   RTRNCODE(4),@CF00101                             03S0416 01289000
*                             GO TO AHLEXIT;/* QUIT                  */ 01290000
         B     AHLEXIT                                          03S0417 01291000
*                           END;                                03S0418 01292000
*                       END;                                    03S0419 01293000
*                     ELSE                                      03S0420 01294000
*                       DO;                                     03S0420 01295000
*                                                               03S0420 01296000
         B     @RC00411                                         03S0420 01297000
@RF00411 DS    0H                                               03S0421 01298000
*                         /*******************************************/ 01299000
*                         /*                                         */ 01300000
*                         /* OTHERWISE, THE EID IS ALREADY DEFINED IN*/ 01301000
*                         /* THE MCED. THE MCEE CHAIN HEADED BY THE  */ 01302000
*                         /* MCEE POINTED TO BY REGISTER 15 IS       */ 01303000
*                         /* SEARCHED TO SEE IF THE ARGUMENT MCEE IS */ 01304000
*                         /* ALREADY DEFINED. IF IT IS, THIS MCEE IS */ 01305000
*                         /* IGNORED.                                */ 01306000
*                         /*                                         */ 01307000
*                         /*******************************************/ 01308000
*                                                               03S0421 01309000
*                         ELEMAD=SINKADDR;/* SAVE THE FOUND MCEE        01310000
*                                      ADDRESS                       */ 01311000
         ST    SINKADDR,ELEMAD                                  03S0421 01312000
*                         RFY                                   03S0422 01313000
*                           SINKADDR UNRSTD;                    03S0422 01314000
*                         RFY                                   03S0423 01315000
*                           MCEE BASED(ELEMAD);                 03S0423 01316000
*                         DO WHILE(ELEMAD^=0);/* SEARCH UNTIL   03S0424 01317000
*                                      END-OF-CHAIN FOUND            */ 01318000
         B     @DE00424                                         03S0424 01319000
@DL00424 DS    0H                                               03S0425 01320000
*                           IF ELEMAD=ARGUMENT THEN             03S0425 01321000
         L     @06,ELEMAD                                       03S0425 01322000
         CR    @06,ARGUMENT                                     03S0425 01323000
         BE    @RT00425                                         03S0425 01324000
*                             GO TO AHLEEIN2;/* IF ARGUMENT MCEE IS     01325000
*                                      ON THE CHAIN, IGNORE IT       */ 01326000
*                           LASTELM=ELEMAD;/* SAVE THIS ONES ADDRESS    01327000
*                                      AS LAST ON CHAIN              */ 01328000
         LR    LASTELM,@06                                      03S0427 01329000
*                           ELEMAD=MCEEEIDL;/* PICK UP ADDRESS OF       01330000
*                                      NEXT MCEE ON CHAIN OFF MCED,     01331000
*                                      VIA MCEEEIDL FIELD            */ 01332000
         L     @06,MCEEEIDL(,@06)                               03S0428 01333000
         ST    @06,ELEMAD                                       03S0428 01334000
*                         END;                                  03S0429 01335000
*                                                               03S0429 01336000
@DE00424 L     @06,ELEMAD                                       03S0429 01337000
         LTR   @06,@06                                          03S0429 01338000
         BNZ   @DL00424                                         03S0429 01339000
*                         /*******************************************/ 01340000
*                         /*                                         */ 01341000
*                         /* FALL THRU TO THIS CODE INDICATES THAT   */ 01342000
*                         /* THE ARGUMENT MCEE IS NOT DEFINED TO THE */ 01343000
*                         /* MCED. ADD IT TO THE END OF THE CHAIN    */ 01344000
*                         /*                                         */ 01345000
*                         /*******************************************/ 01346000
*                                                               03S0430 01347000
*                         LASTELM->MCEEEIDL=ARGUMENT;/* PLACE ITS       01348000
*                                      ADDRESS INTO THE LINK FIELD OF   01349000
*                                      THE LAST ONE ON THE CHAIN     */ 01350000
         ST    ARGUMENT,MCEEEIDL(,LASTELM)                      03S0430 01351000
*                       END;        /* END OF DEFINED EID PATH       */ 01352000
*                                                               03S0431 01353000
*                     /***********************************************/ 01354000
*                     /*                                             */ 01355000
*                     /* PROCESS NEXT MCEE OFF MCQE                  */ 01356000
*                     /*                                             */ 01357000
*                     /***********************************************/ 01358000
*                                                               03S0432 01359000
*AHLEEIN2:                                                      03S0432 01360000
*                     ARGUMENT=ARGUMENT->MCEEMCQL;/* POINT TO NEXT      01361000
*                                      MCEE OFF MCQE TO PROCESS IT   */ 01362000
@RC00411 DS    0H                                               03S0432 01363000
AHLEEIN2 L     ARGUMENT,MCEEMCQL(,ARGUMENT)                     03S0432 01364000
*                   END;            /* LOOP THRU ALL MCEES FOR THIS     01365000
*                                      MCQE                          */ 01366000
@DE00408 SLR   @06,@06                                          03S0433 01367000
         CR    ARGUMENT,@06                                     03S0433 01368000
         BNE   @DL00408                                         03S0433 01369000
*                   RFY                                         03S0434 01370000
*                     TREEAD UNRSTD;                            03S0434 01371000
*                   IF MCQEMCCL^=0 THEN                         02S0435 01372000
         C     @06,MCQEMCCL(,MCQEPTR)                           02S0435 01373000
         BNE   @RT00435                                         02S0435 01374000
*                     GO TO AHLACT03;/* INSERT MCCLES ALSO, IF  02S0436 01375000
*                                      PRESENT                       */ 01376000
*                 END;                                          02S0437 01377000
*                                                               02S0438 01378000
*               /*****************************************************/ 01379000
*               /*                                                   */ 01380000
*               /* ALL ROUTING TABLES HAVE BEEN UPDATED WITH THIS    */ 01381000
*               /* MCQES ROUTING ELEMENTS. THE FOLLOWING CODE        */ 01382000
*               /* COMPLETES THE ACTIVATION OF THIS MCQE BY          */ 01383000
*               /* INITIALIZING CONTROL REGISTER 8, AND SETTING THE  */ 01384000
*               /* PROPER ACTIVE FLAGS                               */ 01385000
*               /*                                                   */ 01386000
*               /*****************************************************/ 01387000
*                                                               02S0438 01388000
*               CALL CR8MASK;       /* UPDATE CLASS MASK WITH NEW       01389000
*                                      CLASSES DUE TO THIS MCQE      */ 01390000
@RC00333 BAL   @14,CR8MASK                                      02S0438 01391000
*               CALL CR8SET;        /* SET CONTROL REGISTER 8 ON ALL    01392000
*                                      CPUS                          */ 01393000
         BAL   @14,CR8SET                                       02S0439 01394000
*               MCQEACT='1'B;       /* MARK THIS MCQE AS ACTIVE      */ 01395000
         OI    MCQEACT(MCQEPTR),B'10000000'                     02S0440 01396000
*               IF MCHACT='0'B THEN                             02S0441 01397000
         L     @06,MCHEADPT                                     02S0441 01398000
         TM    MCHACT(@06),B'10000000'                          02S0441 01399000
         BNZ   @RF00441                                         02S0441 01400000
*                 DO;                                           02S0442 01401000
*                                                               02S0442 01402000
*                   /*************************************************/ 01403000
*                   /*                                               */ 01404000
*                   /* ROUTING IS NOT ACTIVE. CHECK THE TERMINATION  */ 01405000
*                   /* FLAG TO SEE IF AHLMCER HAS TERMINATED ROUTING */ 01406000
*                   /* AND IF SO, SET THE PROPER RETURN CODE. IF THE */ 01407000
*                   /* TERMINATION FLAG IS NOT ON, SET THE ROUTING   */ 01408000
*                   /* ACTIVE FLAG, MCHACT                           */ 01409000
*                   /*                                               */ 01410000
*                   /*************************************************/ 01411000
*                                                               02S0443 01412000
*                   IF MCHTERM='1'B THEN                        02S0443 01413000
         TM    MCHTERM(@06),B'01000000'                         02S0443 01414000
         BNO   @RF00443                                         02S0443 01415000
*                     RTRNCODE=TERMPHSE;/* SET PROPER RC IF AHLMCER     01416000
*                                      HAS INDICATED TERMINATION     */ 01417000
         MVC   RTRNCODE(4),@CF00097                             02S0444 01418000
*                   ELSE                                        02S0445 01419000
*                     MCHACT='1'B;  /* OTHERWISE, MARK ROUTING ACTIVE*/ 01420000
         B     @RC00443                                         02S0445 01421000
@RF00443 L     @06,MCHEADPT                                     02S0445 01422000
         OI    MCHACT(@06),B'10000000'                          02S0445 01423000
*                 END;              /* END OF NOT ACTIVE PATH. IF       01424000
*                                      ROUTING IS ACTIVE, FLAG IS       01425000
*                                      ALREADY SET                   */ 01426000
*             END;                  /* END OF FOUND MCQE PATH        */ 01427000
*           ELSE                                                02S0448 01428000
*             DO;                                               02S0448 01429000
*                                                               02S0448 01430000
         B     @RC00328                                         02S0448 01431000
@RF00328 DS    0H                                               02S0449 01432000
*               /*****************************************************/ 01433000
*               /*                                                   */ 01434000
*               /* THIS MCQE IS NOT THE ONE - BUMP TO NEXT MCQE ON   */ 01435000
*               /* CHAIN                                             */ 01436000
*               /*                                                   */ 01437000
*               /*****************************************************/ 01438000
*                                                               02S0449 01439000
*               MCQEPTR=MCQEMCQE;                               02S0449 01440000
         L     MCQEPTR,MCQEMCQE(,MCQEPTR)                       02S0449 01441000
*               IF MCQEPTR=0 THEN                               02S0450 01442000
         LTR   MCQEPTR,MCQEPTR                                  02S0450 01443000
         BZ    @RT00450                                         02S0450 01444000
*                 GO TO AHLACT01;   /* IF THE END OF THE MCQE CHAIN     01445000
*                                      IS REACHED WITHOUT FINDING THE   01446000
*                                      MCQE, TERMINATION IS ASSUMED  */ 01447000
*               ELSE                                            02S0452 01448000
*                 GO TO AHLACT05;   /* IF THIS IS NOT THE END OF THE    01449000
*                                      MCQE CHAIN GO CHECK TO SEE IF    01450000
*                                      THIS IS THE RIGHT ONE.        */ 01451000
         B     AHLACT05                                         02S0452 01452000
*             END;                                              02S0453 01453000
*         END;                      /* END OF MCQE CHAIN SEARCH PATH */ 01454000
*     END;                                                      01S0455 01455000
*                                                               01S0455 01456000
*   /*****************************************************************/ 01457000
*   /*                                                               */ 01458000
*   /* CHECK FOR OTHER OPTIONS ONLY IF ADD WAS NOT SPECIFIED         */ 01459000
*   /*                                                               */ 01460000
*   /*****************************************************************/ 01461000
*                                                               01S0456 01462000
*   ELSE                                                        01S0456 01463000
*     IF ADD='0'B THEN                                          01S0456 01464000
         B     @RC00304                                         01S0456 01465000
@RF00304 L     @06,PLISTAD                                      01S0456 01466000
         TM    ADD(@06),B'10000000'                             01S0456 01467000
         BNZ   @RF00456                                         01S0456 01468000
*       DO;                                                     01S0457 01469000
*         IF FREE='1'B THEN                                     01S0458 01470000
         TM    FREE(@06),B'00010000'                            01S0458 01471000
         BNO   @RF00458                                         01S0458 01472000
*           DO;                                                 01S0459 01473000
*                                                               02S0460 01474000
*             /*******************************************************/ 01475000
*             /*                                                     */ 01476000
*             /* FREE FUNCTION HAS BEEN REQUESTED. REMOVE THIS       */ 01477000
*             /* APPLICATION FROM THE TABLES AND FREE ALL THE TABLES */ 01478000
*             /* ASSOCIATED WITH THIS APPLICATION. BEGIN PROCESSING  */ 01479000
*             /* BY FINDING ITS MCQE.                                */ 01480000
*             /*                                                     */ 01481000
*             /*******************************************************/ 01482000
*                                                               02S0460 01483000
*             IF MCHCUR=0 THEN                                  02S0460 01484000
         L     @06,MCHEADPT                                     02S0460 01485000
         L     @06,MCHCUR(,@06)                                 02S0460 01486000
         LTR   @06,@06                                          02S0460 01487000
         BNZ   @RF00460                                         02S0460 01488000
*AHLFREE1:                                                      02S0461 01489000
*               DO;                                             02S0461 01490000
*                                                               02S0461 01491000
AHLFREE1 DS    0H                                               02S0462 01492000
*                 /***************************************************/ 01493000
*                 /*                                                 */ 01494000
*                 /* NO MCCE EXISTS - TERMINATION IS ASSUMED TO HAVE */ 01495000
*                 /* OCCURRED. SINCE THE MCQE CANNOT BE FOUND IN THE */ 01496000
*                 /* TABLES, THE FREEING OPERATION MUST BE PERFORMED */ 01497000
*                 /* ON THE PASSED MCQE ADDRESS. FIRST VALIDITY CHECK*/ 01498000
*                 /* THE PASSED MCQE BY CHECKING THE TABLE IDENTIFIER*/ 01499000
*                 /* AND APPLICATION NAME FIELDS                     */ 01500000
*                 /*                                                 */ 01501000
*                 /***************************************************/ 01502000
*                                                               02S0462 01503000
*                 IF PASSEDQE=0 THEN                            02S0462 01504000
         L     @06,PLISTAD                                      02S0462 01505000
         ICM   @15,15,PASSEDQE(@06)                             02S0462 01506000
         BZ    @RT00462                                         02S0462 01507000
*                   GO TO AHLEXIT;  /* QUIT IF THIS APPLICATION HAS     01508000
*                                      NOTHING TO FREE               */ 01509000
*                 RFY                                           02S0464 01510000
*                   MCQE BASED(PASSEDQE);                       02S0464 01511000
*AHLFREE3:                                                      02S0465 01512000
*                 IF MCQEIDEN^=MCQETAG|MCQENAME^=PLISTNAM THEN  02S0465 01513000
AHLFREE3 L     @06,PLISTAD                                      02S0465 01514000
         ICM   @15,15,PASSEDQE(@06)                             02S0465 01515000
         CLC   MCQEIDEN(8,@15),@CC00170                         02S0465 01516000
         BNE   @RT00465                                         02S0465 01517000
         CLC   MCQENAME(8,@15),PLISTNAM(@06)                    02S0465 01518000
         BE    @RF00465                                         02S0465 01519000
@RT00465 DS    0H                                               02S0466 01520000
*                   DO;                                         02S0466 01521000
*                                                               02S0466 01522000
*                     /***********************************************/ 01523000
*                     /*                                             */ 01524000
*                     /* MCQE ADDRESS IS INVALID. ABEND THE CALLER   */ 01525000
*                     /*                                             */ 01526000
*                     /***********************************************/ 01527000
*                                                               02S0467 01528000
*                     RFY                                       02S0467 01529000
*                       ABNDCODE RSTD;                          02S0467 01530000
*                     ABNDCODE=INVALQE1;/* SET PROPER INDICATOR IN R    01531000
*                                      15                            */ 01532000
         LA    ABNDCODE,8                                       02S0468 01533000
*                     DO;           /* ABEND(SETCMPCD) DUMP SYSTEM   */ 01534000
*                       RESPECIFY                               02S0470 01535000
*                        (GPR01F) RESTRICTED;                   02S0470 01536000
*                       GPR01F=((SETCMPCD)&'00000FFF'X)*4096;/* COMP    01537000
*                                      CODE IN BITS 8-19             */ 01538000
         L     GPR01F,@CF02503                                  02S0471 01539000
*                       GPR01F=GPR01F|'80000000'X;/*            02S0472 01540000
*                                      DUMP/STEP/DUMPOPTS FLAG       */ 01541000
         O     GPR01F,@CF02273                                  02S0472 01542000
*                       SVC(13);    /* ISSUE ABEND SVC               */ 01543000
         SVC   13                                               02S0473 01544000
*                       RESPECIFY                               02S0474 01545000
*                        (GPR01F) UNRESTRICTED;                 02S0474 01546000
*                     END;          /* ABEND(SETCMPCD) DUMP SYSTEM   */ 01547000
*                     RFY                                       02S0476 01548000
*                       ABNDCODE UNRSTD;                        02S0476 01549000
*                   END;                                        02S0477 01550000
*                                                               02S0478 01551000
*                 /***************************************************/ 01552000
*                 /*                                                 */ 01553000
*                 /* PASSED MCQE PASSES VALIDITY CHECKS. FREE THE    */ 01554000
*                 /* STORAGE ASSOCIATED WITH THIS MCQE               */ 01555000
*                 /*                                                 */ 01556000
*                 /***************************************************/ 01557000
*                                                               02S0478 01558000
*                 ELEMAD=MCQEMCEE;  /* LOAD FIRST MCEE ADDRESS       */ 01559000
@RF00465 L     @06,PLISTAD                                      02S0478 01560000
         ICM   @01,15,PASSEDQE(@06)                             02S0478 01561000
         L     @06,MCQEMCEE(,@01)                               02S0478 01562000
         ST    @06,ELEMAD                                       02S0478 01563000
*                 IF ELEMAD^=0 THEN                             02S0479 01564000
         LTR   @06,@06                                          02S0479 01565000
         BZ    @RF00479                                         02S0479 01566000
*                   CALL FREEELMS;  /* GO TO SUBROUTINE TO FREE 02S0480 01567000
*                                      ELEMENTS IF THEY EXIST        */ 01568000
         BAL   @14,FREEELMS                                     02S0480 01569000
*                 ELEMAD=MCQEMCCL;  /* LOAD FIRST MCCLE ADDRESS      */ 01570000
@RF00479 L     @06,PLISTAD                                      02S0481 01571000
         ICM   @01,15,PASSEDQE(@06)                             02S0481 01572000
         L     @06,MCQEMCCL(,@01)                               02S0481 01573000
         ST    @06,ELEMAD                                       02S0481 01574000
*                 IF ELEMAD^=0 THEN                             02S0482 01575000
         LTR   @06,@06                                          02S0482 01576000
         BZ    @RF00482                                         02S0482 01577000
*                   CALL FREEELMS;  /* GO TO THE SAME SUBROUTINE TO     01578000
*                                      FREE MCCLES                   */ 01579000
         BAL   @14,FREEELMS                                     02S0483 01580000
*                 DO;               /* FREEMAIN (E) LV(LENGTH(MCQE))    01581000
*                                      A(PASSEDQE) SP(SQA)           */ 01582000
@RF00482 DS    0H                                               02S0485 01583000
*                   RESPECIFY                                   02S0485 01584000
*                    (GPR01P) RESTRICTED;                       02S0485 01585000
*                   I005=I005&&I005;/* INIT LIST                     */ 01586000
         XC    I005(10),I005                                    02S0486 01587000
*                   I00505='00'X;   /* SET TYPE                      */ 01588000
         MVI   I00505,X'00'                                     02S0487 01589000
*                   I00502=LENGTH(MCQE);/* LENGTH                    */ 01590000
         MVC   I00502(3),@CF02504+1                             02S0488 01591000
*                   I00504=ADDR(PASSEDQE);/* ADDR OF ADDR LIST       */ 01592000
         L     @06,PLISTAD                                      02S0489 01593000
         LA    @06,PASSEDQE(,@06)                               02S0489 01594000
         STCM  @06,7,I00504                                     02S0489 01595000
*                   I00506=SQA;     /* SUBPOOL VALUE                 */ 01596000
         MVI   I00506,X'F5'                                     02S0490 01597000
*                   GPR01P=ADDR(I005);/* REG1 POINTS TO LIST         */ 01598000
         LA    GPR01P,I005                                      02S0491 01599000
*                   SVC(5);         /* STANDARD-FORM OF GETMAIN      */ 01600000
         SVC   5                                                02S0492 01601000
*                   RESPECIFY                                   02S0493 01602000
*                    (GPR01P) UNRESTRICTED;                     02S0493 01603000
*                 END;              /* FREEMAIN (E) LV(LENGTH(MCQE))    01604000
*                                      A(PASSEDQE) SP(SQA) FREE THE     01605000
*                                      MCQE.                         */ 01606000
*               END;                /* END OF NO-MCCE PATH           */ 01607000
*             ELSE                                              02S0496 01608000
*               DO;                                             02S0496 01609000
*                                                               02S0496 01610000
         B     @RC00460                                         02S0496 01611000
@RF00460 DS    0H                                               02S0497 01612000
*                 /***************************************************/ 01613000
*                 /*                                                 */ 01614000
*                 /* MCCE EXISTS. SEARCH THE MCQE CHAIN FOR A        */ 01615000
*                 /* MATCHING APPLICATION NAME.                      */ 01616000
*                 /*                                                 */ 01617000
*                 /***************************************************/ 01618000
*                                                               02S0497 01619000
*                 MCCEPTR=MCHCUR;   /* SAVE THE CURRENT MCCE ADDRESS */ 01620000
         L     @05,MCHEADPT                                     02S0497 01621000
         L     @05,MCHCUR(,@05)                                 02S0497 01622000
         ST    @05,MCCEPTR                                      02S0497 01623000
*                 RFY                                           02S0498 01624000
*                   MCCE BASED(MCCEPTR);                        02S0498 01625000
*                 MCQEPTR=MCCEQEA;  /* LOAD THE FIRST MCQE ADDRESS   */ 01626000
         L     MCQEPTR,MCCEQEA(,@05)                            02S0499 01627000
*                 RFY                                           02S0500 01628000
*                   MCQE BASED(MCQEPTR);                        02S0500 01629000
*                 LASTMCQ=0;        /* INDICATE THAT THIS IS THE        01630000
*                                      FIRST ON CHAIN                */ 01631000
         SLR   LASTMCQ,LASTMCQ                                  02S0501 01632000
*                 DO WHILE(MCQEPTR^=0);/* SEARCH ENTIRE MCQE CHAIN      01633000
*                                      (UNTIL ZERO LINK VALUE IS        01634000
*                                      FOUND)                        */ 01635000
         B     @DE00502                                         02S0502 01636000
@DL00502 DS    0H                                               02S0503 01637000
*                   IF MCQENAME=PLISTNAM THEN                   02S0503 01638000
         L     @05,PLISTAD                                      02S0503 01639000
         CLC   MCQENAME(8,MCQEPTR),PLISTNAM(@05)                02S0503 01640000
         BE    @RT00503                                         02S0503 01641000
*                     GO TO AHLFREE2;/* LEAVE LOOP IF WE FIND THE       01642000
*                                      NAME IN AN MCQE ON THE CHAIN. */ 01643000
*                   LASTMCQ=MCQEPTR;/* THIS MCQE DOES NOT CONTAIN THE   01644000
*                                      SAME NAME. IT NOW BECOMES        01645000
*                                      KNOWN AS THE PRIOR            */ 01646000
         LR    LASTMCQ,MCQEPTR                                  02S0505 01647000
*                   MCQEPTR=MCQEMCQE;/* PICK UP THE PREDECESSOR AS      01648000
*                                      THE ONE TO PROCESS            */ 01649000
         L     MCQEPTR,MCQEMCQE(,MCQEPTR)                       02S0506 01650000
*                 END;              /* LOOP THRU ENTIRE MCQE CHAIN   */ 01651000
*                                                               02S0507 01652000
@DE00502 LTR   MCQEPTR,MCQEPTR                                  02S0507 01653000
         BNZ   @DL00502                                         02S0507 01654000
*                 /***************************************************/ 01655000
*                 /*                                                 */ 01656000
*                 /* FALL THRU TO HERE INDICATES THAT THE MCQE IS NOT*/ 01657000
*                 /* ON THE CHAIN                                    */ 01658000
*                 /*                                                 */ 01659000
*                 /***************************************************/ 01660000
*                                                               02S0508 01661000
*                 GO TO AHLFREE1;   /* TREAT IT AS IF TERMINATION HAS   01662000
*                                      TAKEN PLACE                   */ 01663000
         B     AHLFREE1                                         02S0508 01664000
*                                                               02S0509 01665000
*                 /***************************************************/ 01666000
*                 /*                                                 */ 01667000
*                 /* MCQE WITH THE SAME NAME HAS BEEN FOUND - VERIFY */ 01668000
*                 /* THAT THE ADDRESS IS THE SAME AS THE ADDRESS IN  */ 01669000
*                 /* THE PARAMETER LIST. IF NOT, ABEND THE CALLER.   */ 01670000
*                 /*                                                 */ 01671000
*                 /***************************************************/ 01672000
*                                                               02S0509 01673000
*AHLFREE2:                                                      02S0509 01674000
*                 IF MCQEPTR^=PASSEDQE THEN                     02S0509 01675000
AHLFREE2 L     @05,PLISTAD                                      02S0509 01676000
         ICM   @15,15,PASSEDQE(@05)                             02S0509 01677000
         CR    MCQEPTR,@15                                      02S0509 01678000
         BE    @RF00509                                         02S0509 01679000
*                   DO;             /* IF THE ADDRESSES ARE NOT THE     01680000
*                                      SAME, ABEND THE CALLER DUE TO    01681000
*                                      AN INVALID MCQE ADDRESS       */ 01682000
*                     RFY                                       02S0511 01683000
*                       ABNDCODE RSTD;                          02S0511 01684000
*                     ABNDCODE=INVALQE1;/* SET THE PROPER INDICATOR  */ 01685000
         LA    ABNDCODE,8                                       02S0512 01686000
*                     DO;           /* ABEND(SETCMPCD) DUMP SYSTEM   */ 01687000
*                       RESPECIFY                               02S0514 01688000
*                        (GPR01F) RESTRICTED;                   02S0514 01689000
*                       GPR01F=((SETCMPCD)&'00000FFF'X)*4096;/* COMP    01690000
*                                      CODE IN BITS 8-19             */ 01691000
         L     GPR01F,@CF02503                                  02S0515 01692000
*                       GPR01F=GPR01F|'80000000'X;/*            02S0516 01693000
*                                      DUMP/STEP/DUMPOPTS FLAG       */ 01694000
         O     GPR01F,@CF02273                                  02S0516 01695000
*                       SVC(13);    /* ISSUE ABEND SVC               */ 01696000
         SVC   13                                               02S0517 01697000
*                       RESPECIFY                               02S0518 01698000
*                        (GPR01F) UNRESTRICTED;                 02S0518 01699000
*                     END;          /* ABEND(SETCMPCD) DUMP SYSTEM   */ 01700000
*                     RFY                                       02S0520 01701000
*                       ABNDCODE UNRSTD;                        02S0520 01702000
*                   END;                                        02S0521 01703000
*                                                               02S0521 01704000
*                 /***************************************************/ 01705000
*                 /*                                                 */ 01706000
*                 /* IF THE MCQE IS ACTIVE, ITS ASSOCIATED MCEES AND */ 01707000
*                 /* MCCLES MUST BE REMOVED FROM THE MCED AND MCCD,  */ 01708000
*                 /* RESPECTIVELY. IF THE MCQE IS NOT YET ACTIVE, ITS*/ 01709000
*                 /* MCEES AND MCCLES DO NOT HAVE TO BE REMOVED SINCE*/ 01710000
*                 /* THEY HAVE NOT YET BEEN INSERTED INTO THOSE      */ 01711000
*                 /* TABLES                                          */ 01712000
*                 /*                                                 */ 01713000
*                 /***************************************************/ 01714000
*                                                               02S0522 01715000
*                 IF MCQEACT='1'B THEN                          02S0522 01716000
@RF00509 TM    MCQEACT(MCQEPTR),B'10000000'                     02S0522 01717000
         BNO   @RF00522                                         02S0522 01718000
*                   DO;                                         02S0523 01719000
*                     IF MCQEMCEE^=0 THEN                       02S0524 01720000
         SLR   @05,@05                                          02S0524 01721000
         L     @15,MCQEMCEE(,MCQEPTR)                           02S0524 01722000
         CR    @15,@05                                          02S0524 01723000
         BE    @RF00524                                         02S0524 01724000
*                       DO;         /* REMOVE MCEES FROM MCED IF THEY   01725000
*                                      EXIST                         */ 01726000
*                                                               03S0526 01727000
*                         /*******************************************/ 01728000
*                         /*                                         */ 01729000
*                         /* MCEES ARE TO BE DELETED FROM THE EVENT  */ 01730000
*                         /* DIRECTORY (MCED). FIRST, FIND THE MCED. */ 01731000
*                         /* IF IT DOES NOT EXIST, THERE IS NOTHING  */ 01732000
*                         /* TO PROCESS                              */ 01733000
*                         /*                                         */ 01734000
*                         /*******************************************/ 01735000
*                                                               03S0526 01736000
*                         IF MCCEEDA^=0 THEN                    03S0526 01737000
         L     @01,MCCEPTR                                      03S0526 01738000
         L     @14,MCCEEDA(,@01)                                03S0526 01739000
         CR    @14,@05                                          03S0526 01740000
         BE    @RF00526                                         03S0526 01741000
*                           DO;                                 03S0527 01742000
*                                                               03S0527 01743000
*                             /***************************************/ 01744000
*                             /*                                     */ 01745000
*                             /* MCED EXISTS - USING EACH MCEE OFF   */ 01746000
*                             /* THE MCQE (POINTED TO BY MCQEPTR) AS */ 01747000
*                             /* ARGUMENTS, PERFORM A RPTS SEARCH ON */ 01748000
*                             /* THE MCED, TO FIND OUT IF THE MCEE IS*/ 01749000
*                             /* DEFINED TO THE MCED                 */ 01750000
*                             /*                                     */ 01751000
*                             /***************************************/ 01752000
*                                                               03S0528 01753000
*                             RFY                               03S0528 01754000
*                               TREEAD RSTD;                    03S0528 01755000
*                             TREEAD=MCCEEDA;/* SAVE THE MCED ADDRESS*/ 01756000
         LR    TREEAD,@14                                       03S0529 01757000
*                             ARGUMENT=MCQEMCEE;/* PICK UP THE FIRST    01758000
*                                      MCEE TO PROCESS               */ 01759000
         LR    ARGUMENT,@15                                     03S0530 01760000
*                             RFY                               03S0531 01761000
*                              (SINKADDR,                       03S0531 01762000
*                               MCEDSINK) RSTD;                 03S0531 01763000
*                             DO WHILE(ARGUMENT^=0);/* PROCESS UNTIL    01764000
*                                      THE END IS INDICATED          */ 01765000
         B     @DE00532                                         03S0532 01766000
@DL00532 DS    0H                                               03S0533 01767000
*                               GEN                             03S0533 01768000
*(SRCH (TREEAD),SARG=MCEEEID(0,ARGUMENT),TYPE=5,KEYL=2);        03S0533 01769000
         SRCH (TREEAD),SARG=MCEEEID(0,ARGUMENT),TYPE=5,KEYL=2           01770000
*                                                               03S0534 01771000
*                               /*************************************/ 01772000
*                               /*                                   */ 01773000
*                               /* IF THE MCEE FOUND BY THE SRCH     */ 01774000
*                               /* MACRO ( THE ADDRESS OF WHICH IS   */ 01775000
*                               /* RETURNED IN SINKADDR (R 15) ) IS  */ 01776000
*                               /* THE ONE USED AS THE ARGUMENT, IT  */ 01777000
*                               /* IS TO BE DELETED FROM THE MCED.   */ 01778000
*                               /* HOWEVER, BEFORE IT CAN BE DELETED,*/ 01779000
*                               /* ITS EID LINK FIELD MUST BE        */ 01780000
*                               /* INTERROGATED TO SEE IF THERE ARE  */ 01781000
*                               /* OTHER MCEES DEFINED TO THE SAME   */ 01782000
*                               /* EID. IF THERE ARE NOT (INDICATED  */ 01783000
*                               /* BY A ZERO LINK FIELD) THE MCEE IS */ 01784000
*                               /* DELETED VIA THE RPTS DEL MACRO. IF*/ 01785000
*                               /* THERE ARE, THEY REMAIN DEFINED TO */ 01786000
*                               /* THE MCED BY MOVING THE EID LINK   */ 01787000
*                               /* FIELD OF THE FOUND MCEE INTO THE  */ 01788000
*                               /* FULLWORD POINTED TO BY REGISTER 3 */ 01789000
*                               /* AFTER THE SRCH MACRO. THIS WILL   */ 01790000
*                               /* REPLACE THE ARGUMENT MCEE WITH THE*/ 01791000
*                               /* NEXT MCEE ON THE CHAIN OFF THE    */ 01792000
*                               /* MCED.                             */ 01793000
*                               /*                                   */ 01794000
*                               /*************************************/ 01795000
*                                                               03S0534 01796000
*                               IF SINKADDR=ARGUMENT THEN       03S0534 01797000
         CR    SINKADDR,ARGUMENT                                03S0534 01798000
         BNE   @RF00534                                         03S0534 01799000
*                                 DO;                           03S0535 01800000
*                                                               03S0535 01801000
*                                   /*********************************/ 01802000
*                                   /*                               */ 01803000
*                                   /* MCED POINTS TO ARGUMENT MCEE  */ 01804000
*                                   /*                               */ 01805000
*                                   /*********************************/ 01806000
*                                                               03S0536 01807000
*                                   IF ARGUMENT->MCEEEIDL^=0 THEN       01808000
         L     @14,MCEEEIDL(,ARGUMENT)                          03S0536 01809000
         LTR   @14,@14                                          03S0536 01810000
         BZ    @RF00536                                         03S0536 01811000
*                                    NEWSINK=ARGUMENT->MCEEEIDL;/*      01812000
*                                      REPLACE MCEE WITH ITS    03S0537 01813000
*                                      SUCCESSOR                     */ 01814000
         ST    @14,NEWSINK(,MCEDSINK)                           03S0537 01815000
*                                   ELSE                        03S0538 01816000
*                                    DO;/* IF IT DOES NOT HAVE A        01817000
*                                      SUCCESSOR, DELETE IT FROM MCED   01818000
*                                      VIA RPTS MACRO                */ 01819000
         B     @RC00536                                         03S0538 01820000
@RF00536 DS    0H                                               03S0539 01821000
*                                     GEN(DEL (TREEAD),FREE=NO,TYPE=5); 01822000
*                                                               03S0539 01823000
         DEL (TREEAD),FREE=NO,TYPE=5                                    01824000
*                                     /*******************************/ 01825000
*                                     /*                             */ 01826000
*                                     /* NOW CHECK TO SEE IF THIS WAS*/ 01827000
*                                     /* THE LAST MCEE DEFINED TO THE*/ 01828000
*                                     /* MCED BY PERFORMING SRCH. IF */ 01829000
*                                     /* THE MCED IS NOW EMPTY, THE  */ 01830000
*                                     /* SRCH WILL RETURN A ZERO     */ 01831000
*                                     /* ADDRESS. IF THIS IS THE     */ 01832000
*                                     /* CASE, SET UP THE MCED TO BE */ 01833000
*                                     /* FREED BY PLACING ITS ADDRESS*/ 01834000
*                                     /* INTO THE MCCEOEDA FIELD     */ 01835000
*                                     /*                             */ 01836000
*                                     /*******************************/ 01837000
*                                                               03S0540 01838000
*                                     GEN                       03S0540 01839000
*(SRCH (TREEAD),SARG=MCEEEID(0,ARGUMENT),TYPE=5,KEYL=2);        03S0540 01840000
         SRCH (TREEAD),SARG=MCEEEID(0,ARGUMENT),TYPE=5,KEYL=2           01841000
*                                     IF SINKIND<0 THEN         03S0541 01842000
         LTR   SINKIND,SINKIND                                  03S0541 01843000
         BNM   @RF00541                                         03S0541 01844000
*AHLEEOT2:                                                      03S0542 01845000
*                                      DO;                      03S0542 01846000
*                                                               03S0542 01847000
AHLEEOT2 DS    0H                                               03S0543 01848000
*                                       /*****************************/ 01849000
*                                       /*                           */ 01850000
*                                       /* MCED IS NOW EMPTY         */ 01851000
*                                       /*                           */ 01852000
*                                       /*****************************/ 01853000
*                                                               03S0543 01854000
*                                       MCCEOEDA=TREEAD;/* PLACE        01855000
*                                      ADDRESS IN TO-BE-FREED SLOT   */ 01856000
         L     @14,MCCEPTR                                      03S0543 01857000
         ST    TREEAD,MCCEOEDA(,@14)                            03S0543 01858000
*                                       MCCEEDA=0;/* INDICATE THAT NO   01859000
*                                      MCED EXISTS                   */ 01860000
         SLR   @05,@05                                          03S0544 01861000
         ST    @05,MCCEEDA(,@14)                                03S0544 01862000
*                                       GO TO AHLEEOT1;/* QUIT SINCE    01863000
*                                      THERE ARE NO MORE MCEES TO BE    01864000
*                                      REMOVED                       */ 01865000
         B     AHLEEOT1                                         03S0545 01866000
*                                      END;                     03S0546 01867000
*                                    END;/* END OF NO SUCCESSOR PATH */ 01868000
*                                 END;/* END OF PATH WHERE MCED 03S0548 01869000
*                                      POINTS TO THE ARGUMENT        */ 01870000
*                                                               03S0549 01871000
*                               /*************************************/ 01872000
*                               /*                                   */ 01873000
*                               /* IF THE FOUND MCEE IS NOT THE SAME */ 01874000
*                               /* AS THE ARGUMENT, CHECK FOR        */ 01875000
*                               /* NEGATIVE. IF NEGATIVE, GO TO LABEL*/ 01876000
*                               /* AHLEEOT2 TO REMOVE THE MCED SINCE */ 01877000
*                               /* IT IS EMPTY.                      */ 01878000
*                               /*                                   */ 01879000
*                               /*************************************/ 01880000
*                                                               03S0549 01881000
*                               ELSE                            03S0549 01882000
*                                 IF SINKIND<0 THEN             03S0549 01883000
         B     @RC00534                                         03S0549 01884000
@RF00534 LTR   SINKIND,SINKIND                                  03S0549 01885000
         BM    @RT00549                                         03S0549 01886000
*                                   GO TO AHLEEOT2;             03S0550 01887000
*                                                               03S0550 01888000
*                               /*************************************/ 01889000
*                               /*                                   */ 01890000
*                               /* OTHERWISE, CHECK THE EID IN THE   */ 01891000
*                               /* FOUND MCEE FOR EQUALITY TO THE EID*/ 01892000
*                               /* IN THE ARGUMENT MCEE. IF THE EIDS */ 01893000
*                               /* ARE THE SAME, SEARCH THE CHAIN OFF*/ 01894000
*                               /* THE FOUND MCEE FOR THE ARGUMENT   */ 01895000
*                               /* MCEE ADDRESS. IF THE EIDS ARE NOT */ 01896000
*                               /* THE SAME, THE EID IS NOT DEFINED  */ 01897000
*                               /* TO THE MCED, SO BYPASS THIS       */ 01898000
*                               /* ARGUMENT MCEE.                    */ 01899000
*                               /*                                   */ 01900000
*                               /*************************************/ 01901000
*                                                               03S0551 01902000
*                                 ELSE                          03S0551 01903000
*                                   IF SINKADDR->MCEEEID=ARGUMENT->     01904000
*                                       MCEEEID THEN            03S0551 01905000
         CLC   MCEEEID(2,SINKADDR),MCEEEID(ARGUMENT)            03S0551 01906000
         BNE   @RF00551                                         03S0551 01907000
*                                    DO;                        03S0552 01908000
*                                                               03S0552 01909000
*                                     /*******************************/ 01910000
*                                     /*                             */ 01911000
*                                     /* EIDS MATCH                  */ 01912000
*                                     /*                             */ 01913000
*                                     /*******************************/ 01914000
*                                                               03S0553 01915000
*                                     LASTELM=SINKADDR;/* SAVE FOUND    01916000
*                                      MCEE AS THE LAST ON CHAIN     */ 01917000
         LR    LASTELM,SINKADDR                                 03S0553 01918000
*                                     ELEMAD=SINKADDR->MCEEEIDL;/*      01919000
*                                      POINT TO NEXT MCEE            */ 01920000
         L     @14,MCEEEIDL(,SINKADDR)                          03S0554 01921000
         ST    @14,ELEMAD                                       03S0554 01922000
*                                     DO WHILE(ELEMAD^=0);/* PROCESS    01923000
*                                      UNTIL END-OF-CHAIN            */ 01924000
         B     @DE00555                                         03S0555 01925000
@DL00555 DS    0H                                               03S0556 01926000
*                                      IF ELEMAD=ARGUMENT THEN  03S0556 01927000
         C     ARGUMENT,ELEMAD                                  03S0556 01928000
         BNE   @RF00556                                         03S0556 01929000
*                                       DO;                     03S0557 01930000
*                                                               03S0557 01931000
*                                        /****************************/ 01932000
*                                        /*                          */ 01933000
*                                        /* ARGUMENT MCEE FOUND ON   */ 01934000
*                                        /* CHAIN                    */ 01935000
*                                        /*                          */ 01936000
*                                        /****************************/ 01937000
*                                                               03S0558 01938000
*                                        LASTELM->MCEEEIDL=ARGUMENT->   01939000
*                                            MCEEEIDL;/* REMOVE 03S0558 01940000
*                                      ARGUMENT FROM CHAIN BY MOVING    01941000
*                                      LINK FIELD                    */ 01942000
         L     @14,MCEEEIDL(,ARGUMENT)                          03S0558 01943000
         ST    @14,MCEEEIDL(,LASTELM)                           03S0558 01944000
*                                        GO TO AHLEEOT3;/* GO PROCESS   01945000
*                                      NEXT MCEE OFF MCQE            */ 01946000
         B     AHLEEOT3                                         03S0559 01947000
*                                       END;                    03S0560 01948000
*                                                               03S0560 01949000
*                                      /******************************/ 01950000
*                                      /*                            */ 01951000
*                                      /* UPDATE TO PROCESS THE NEXT */ 01952000
*                                      /* MCEE OFF MCED              */ 01953000
*                                      /*                            */ 01954000
*                                      /******************************/ 01955000
*                                                               03S0561 01956000
*                                      LASTELM=ELEMAD;/* THIS ONE IS    01957000
*                                      NOT THE ARGUMENT, SO IT IS NOW   01958000
*                                      THE LAST ON CHAIN             */ 01959000
@RF00556 L     @14,ELEMAD                                       03S0561 01960000
         LR    LASTELM,@14                                      03S0561 01961000
*                                      ELEMAD=ELEMAD->MCEEEIDL;/*       01962000
*                                      FIND NEXT MCEE ON CHAIN       */ 01963000
         L     @14,MCEEEIDL(,@14)                               03S0562 01964000
         ST    @14,ELEMAD                                       03S0562 01965000
*                                     END;/* LOOP THROUGH CHAIN OFF     01966000
*                                      MCED.                         */ 01967000
@DE00555 L     @14,ELEMAD                                       03S0563 01968000
         LTR   @14,@14                                          03S0563 01969000
         BNZ   @DL00555                                         03S0563 01970000
*                                    END;/* END OF DEFINED EID PATH  */ 01971000
*                                                               03S0564 01972000
*                               /*************************************/ 01973000
*                               /*                                   */ 01974000
*                               /* UPDATE TO PROCESS THE NEXT MCEE   */ 01975000
*                               /* OFF THE MCQE                      */ 01976000
*                               /*                                   */ 01977000
*                               /*************************************/ 01978000
*                                                               03S0565 01979000
*AHLEEOT3:                                                      03S0565 01980000
*                               ARGUMENT=ARGUMENT->MCEEMCQL;/* NEXT     01981000
*                                      MCEE OFF MCQE NOW BECOMES THE    01982000
*                                      ARGUMENT MCEE                 */ 01983000
@RF00551 DS    0H                                               03S0565 01984000
@RC00534 DS    0H                                               03S0565 01985000
AHLEEOT3 L     ARGUMENT,MCEEMCQL(,ARGUMENT)                     03S0565 01986000
*                             END;  /* LOOP THRU ALL MCEES UNTIL        01987000
*                                      END-OF-CHAIN IS REACHED       */ 01988000
@DE00532 LTR   ARGUMENT,ARGUMENT                                03S0566 01989000
         BNZ   @DL00532                                         03S0566 01990000
*                           END;    /* END OF NON-ZERO MCED PATH     */ 01991000
*                         ELSE                                  03S0568 01992000
*AHLEEOT1:                                                      03S0568 01993000
*                           ;                                   03S0568 01994000
@RF00526 DS    0H                                               03S0568 01995000
AHLEEOT1 DS    0H                                               03S0569 01996000
*                         RFY                                   03S0569 01997000
*                          (TREEAD,                             03S0569 01998000
*                           SINKADDR,                           03S0569 01999000
*                           MCEDSINK) UNRSTD;                   03S0569 02000000
*                       END;                                    02S0570 02001000
*                     IF MCQEMCCL^=0 THEN                       02S0571 02002000
@RF00524 SLR   @05,@05                                          02S0571 02003000
         L     @15,MCQEMCCL(,MCQEPTR)                           02S0571 02004000
         CR    @15,@05                                          02S0571 02005000
         BE    @RF00571                                         02S0571 02006000
*                       DO;         /* REMOVE MCCLES FROM MCCD IF       02007000
*                                      THEY EXIST                    */ 02008000
*                                                               03S0573 02009000
*                         /*******************************************/ 02010000
*                         /*                                         */ 02011000
*                         /* MCCLES ARE TO BE REMOVED FROM THE MCCD  */ 02012000
*                         /* STRUCTURE. FIRST, CHECK TO SEE IF AN    */ 02013000
*                         /* MCCD EXISTS. IF ONE DOES NOT, THERE IS  */ 02014000
*                         /* NOTHING TO PROCESS.                     */ 02015000
*                         /*                                         */ 02016000
*                         /*******************************************/ 02017000
*                                                               03S0573 02018000
*                         ARGUMENT=MCQEMCCL;/* PICK UP FIRST MCCLE      02019000
*                                      OFF MCQE                      */ 02020000
         LR    ARGUMENT,@15                                     03S0573 02021000
*                         IF MCCECDA^=0 THEN                    03S0574 02022000
         L     @01,MCCEPTR                                      03S0574 02023000
         C     @05,MCCECDA(,@01)                                03S0574 02024000
         BE    @RF00574                                         03S0574 02025000
*                           DO WHILE(ARGUMENT^=0);              03S0575 02026000
*                                                               03S0575 02027000
         B     @DE00575                                         03S0575 02028000
@DL00575 DS    0H                                               03S0576 02029000
*                             /***************************************/ 02030000
*                             /*                                     */ 02031000
*                             /* THE MCCD EXISTS - USING EACH MCCLE  */ 02032000
*                             /* OFF THE MCQE AS AN ARGUMENT,        */ 02033000
*                             /* INVESTIGATE THE MCCD TO SEE IF THE  */ 02034000
*                             /* ARGUMENT MCCLE IS DEFINED TO THE    */ 02035000
*                             /* MCCD. IF IT IS DEFINED, REMOVE IT   */ 02036000
*                             /* FROM THE MCCD STRUCTURE. FIRST, THE */ 02037000
*                             /* CLASS IN THE ARGUMENT MCCLE IS      */ 02038000
*                             /* CONVERTED TO AN INDEX TO REFERENCE  */ 02039000
*                             /* THE CORRECT MCCD ENTRY              */ 02040000
*                             /*                                     */ 02041000
*                             /***************************************/ 02042000
*                                                               03S0576 02043000
*                             INDEX=(MCCLCLS/16)+1;/* CONVERT CLASS     02044000
*                                      TO INDEX                      */ 02045000
         SLR   INDEX,INDEX                                      03S0576 02046000
         IC    INDEX,MCCLCLS(,ARGUMENT)                         03S0576 02047000
         SRL   INDEX,4                                          03S0576 02048000
         AL    INDEX,@CF00145                                   03S0576 02049000
*                             IF MCCDCLE(INDEX)=ARGUMENT THEN   03S0577 02050000
         LR    @05,INDEX                                        03S0577 02051000
         SLA   @05,2                                            03S0577 02052000
         L     @03,MCCEPTR                                      03S0577 02053000
         L     @15,MCCECDA(,@03)                                03S0577 02054000
         C     ARGUMENT,MCCDCLE-4(@05,@15)                      03S0577 02055000
         BNE   @RF00577                                         03S0577 02056000
*                               DO;                             03S0578 02057000
*                                                               03S0578 02058000
*                                 /***********************************/ 02059000
*                                 /*                                 */ 02060000
*                                 /* THE MCCD POINTS TO THE ARGUMENT */ 02061000
*                                 /* MCCLE. REMOVE IT FROM THE MCCD  */ 02062000
*                                 /* BY STORING ITS CHAIN FIELD INTO */ 02063000
*                                 /* THE MCCD ENTRY                  */ 02064000
*                                 /*                                 */ 02065000
*                                 /***********************************/ 02066000
*                                                               03S0579 02067000
*                                 MCCDCLE(INDEX)=ARGUMENT->MCCLEIDL;    02068000
         L     @14,MCCLEIDL(,ARGUMENT)                          03S0579 02069000
         ST    @14,MCCDCLE-4(@05,@15)                           03S0579 02070000
*                                   /* REMOVE THIS MCCLE             */ 02071000
*                                 IF MCCDCLE(INDEX)=0 THEN      03S0580 02072000
         SLR   @05,@05                                          03S0580 02073000
         CR    @14,@05                                          03S0580 02074000
         BNE   @RF00580                                         03S0580 02075000
*                                   DO;                         03S0581 02076000
*                                                               03S0581 02077000
*                                    /********************************/ 02078000
*                                    /*                              */ 02079000
*                                    /* IF A ZERO HAS BEEN INSERTED  */ 02080000
*                                    /* INTO THE MCCD, ONE LESS CLASS*/ 02081000
*                                    /* IS NOW ACTIVE. INDICATE THIS */ 02082000
*                                    /* BY DECREMENTING THE ACTIVE   */ 02083000
*                                    /* CLASS COUNT                  */ 02084000
*                                    /*                              */ 02085000
*                                    /********************************/ 02086000
*                                                               03S0582 02087000
*                                    MCCDCNT=MCCDCNT-1;/* DECREMENT     02088000
*                                      NUMBER OF CLASSES             */ 02089000
         LH    @14,MCCDCNT(,@15)                                03S0582 02090000
         BCTR  @14,0                                            03S0582 02091000
         STH   @14,MCCDCNT(,@15)                                03S0582 02092000
*                                    IF MCCDCNT=0 THEN          03S0583 02093000
         CR    @14,@05                                          03S0583 02094000
         BNE   @RF00583                                         03S0583 02095000
*                                     DO;/* IF THIS COUNT HAS BECOME    02096000
*                                      ZERO, MCCD IS TO BE FREED     */ 02097000
*                                      MCCEOCDA=MCCECDA;/* PLACE ITS    02098000
*                                      ADDRESS INTO MCCEOCDA FIELD TO   02099000
*                                      INDICATE THAT IT IS TO BE        02100000
*                                      FREED                         */ 02101000
         ST    @15,MCCEOCDA(,@03)                               03S0585 02102000
*                                      MCCECDA=0;/* INDICATE THAT       02103000
*                                      THERE IS NO CURRENT MCCD      */ 02104000
         ST    @05,MCCECDA(,@03)                                03S0586 02105000
*                                      GO TO AHLLEOT1;/* QUIT SINCE     02106000
*                                      THERE ARE NO MORE MCCLES TO BE   02107000
*                                      REMOVED                       */ 02108000
         B     AHLLEOT1                                         03S0587 02109000
*                                     END;                      03S0588 02110000
*                                   END;/* END OF ZERO LINKFIELD PATH*/ 02111000
*                               END;/* END OF FOUND MCCLE PATH       */ 02112000
*                             ELSE                              03S0591 02113000
*                               DO;                             03S0591 02114000
*                                                               03S0591 02115000
         B     @RC00577                                         03S0591 02116000
@RF00577 DS    0H                                               03S0592 02117000
*                                 /***********************************/ 02118000
*                                 /*                                 */ 02119000
*                                 /* IF THE INDEXED ENTRY DOES NOT   */ 02120000
*                                 /* ADDRESS THE ARGUMENT MCCLE, THEN*/ 02121000
*                                 /* IT EITHER CONTAINS ZERO         */ 02122000
*                                 /* (INDICATING AN INACTIVE CLASS)  */ 02123000
*                                 /* OR CONTAINS THE ADDRESS OF      */ 02124000
*                                 /* ANOTHER MCCLE FOR THE SAME      */ 02125000
*                                 /* CLASS. IF ZERO, THE ARGUMENT    */ 02126000
*                                 /* MCCLE IS BYPASSED. IF NONZERO,  */ 02127000
*                                 /* THE MCCLE CHAIN HEADED BY THIS  */ 02128000
*                                 /* ADDRESS IS SEARCHED FOR THE     */ 02129000
*                                 /* ARGUMENT MCCLE                  */ 02130000
*                                 /*                                 */ 02131000
*                                 /***********************************/ 02132000
*                                                               03S0592 02133000
*                                 IF MCCDCLE(INDEX)^=0 THEN     03S0592 02134000
         LR    @05,INDEX                                        03S0592 02135000
         SLA   @05,2                                            03S0592 02136000
         L     @03,MCCEPTR                                      03S0592 02137000
         L     @03,MCCECDA(,@03)                                03S0592 02138000
         L     @05,MCCDCLE-4(@05,@03)                           03S0592 02139000
         LTR   @05,@05                                          03S0592 02140000
         BZ    @RF00592                                         03S0592 02141000
*                                   DO;/* SEARCH THE MCCLE CHAIN     */ 02142000
         ST    @05,@TF00001                                     03S0593 02143000
*                                    LASTELM=MCCDCLE(INDEX);/* SAVE     02144000
*                                      THIS FIRST MCCLE ADDRESS AS      02145000
*                                      THE LAST                      */ 02146000
         L     LASTELM,@TF00001                                 03S0594 02147000
*                                    ELEMAD=LASTELM->MCCLEIDL;/*        02148000
*                                      POINT TO NEXT MCCLE ON CHAIN     02149000
*                                      OFF MCCD                      */ 02150000
         L     @15,MCCLEIDL(,LASTELM)                           03S0595 02151000
         ST    @15,ELEMAD                                       03S0595 02152000
*                                    DO WHILE(ELEMAD^=0);/* LOOP        02153000
*                                      UNTIL END-OF-CHAIN            */ 02154000
         B     @DE00596                                         03S0596 02155000
@DL00596 DS    0H                                               03S0597 02156000
*                                     IF ELEMAD=ARGUMENT THEN   03S0597 02157000
         L     @15,ELEMAD                                       03S0597 02158000
         CR    @15,ARGUMENT                                     03S0597 02159000
         BNE   @RF00597                                         03S0597 02160000
*                                      DO;/* IF WE FIND THE MCCLE WE    02161000
*                                      ARE LOOKING FOR, REMOVE IT       02162000
*                                      FROM CHAIN BY MOVING ITS LINK    02163000
*                                      FIELD INTO PRIOR MCCLE        */ 02164000
*                                       LASTELM->MCCLEIDL=ELEMAD->      02165000
*                                           MCCLEIDL;           03S0599 02166000
         L     @15,MCCLEIDL(,@15)                               03S0599 02167000
         ST    @15,MCCLEIDL(,LASTELM)                           03S0599 02168000
*                                       GO TO AHLLEOT2;/* GO PROCESS    02169000
*                                      NEXT MCCLE OFF MCQE           */ 02170000
         B     AHLLEOT2                                         03S0600 02171000
*                                      END;                     03S0601 02172000
*                                     LASTELM=ELEMAD;/* THIS ONE IS     02173000
*                                      NOT IT, SO MAKE IT THE PRIOR     02174000
*                                      ONE                           */ 02175000
@RF00597 L     @15,ELEMAD                                       03S0602 02176000
         LR    LASTELM,@15                                      03S0602 02177000
*                                     ELEMAD=ELEMAD->MCCLEIDL;/*        02178000
*                                      POINT TO NEXT MCCLE ON CHAIN  */ 02179000
         L     @15,MCCLEIDL(,@15)                               03S0603 02180000
         ST    @15,ELEMAD                                       03S0603 02181000
*                                    END;/* LOOP THRU ALL MCCLES ON     02182000
*                                      CHAIN OFF MCCD                */ 02183000
@DE00596 L     @15,ELEMAD                                       03S0604 02184000
         LTR   @15,@15                                          03S0604 02185000
         BNZ   @DL00596                                         03S0604 02186000
*                                   END;/* END OF NON-ZERO ENTRY PATH*/ 02187000
*                               END;/* END OF CHAIN SEARCH PATH      */ 02188000
*                                                               03S0606 02189000
@RF00592 DS    0H                                               03S0607 02190000
*                             /***************************************/ 02191000
*                             /*                                     */ 02192000
*                             /* UPDATE TO NEXT MCCLE OFF THE MCQE   */ 02193000
*                             /*                                     */ 02194000
*                             /***************************************/ 02195000
*                                                               03S0607 02196000
*AHLLEOT2:                                                      03S0607 02197000
*                             ARGUMENT=ARGUMENT->MCCLMCQL;/* POINT TO   02198000
*                                      THE NEXT MCCLE TO PROCESS     */ 02199000
@RC00577 DS    0H                                               03S0607 02200000
AHLLEOT2 L     ARGUMENT,MCCLMCQL(,ARGUMENT)                     03S0607 02201000
*                           END;    /* PROCESS ALL MCCLES OFF MCQE   */ 02202000
@DE00575 LTR   ARGUMENT,ARGUMENT                                03S0608 02203000
         BNZ   @DL00575                                         03S0608 02204000
*                         ELSE                                  03S0609 02205000
*AHLLEOT1:                                                      03S0609 02206000
*                           ;                                   03S0609 02207000
@RF00574 DS    0H                                               03S0609 02208000
AHLLEOT1 DS    0H                                               03S0610 02209000
*                       END;                                    02S0610 02210000
*                   END;            /* END OF ACTIVE ONLY PROCESSING */ 02211000
*                                                               02S0611 02212000
@RF00571 DS    0H                                               02S0612 02213000
*                 /***************************************************/ 02214000
*                 /*                                                 */ 02215000
*                 /* SAVE THE MCQE ADDRESS IN FIELD MCCEOMCQ TO ALLOW*/ 02216000
*                 /* SRB ROUTINE AHLTFREE TO FIND IT, SET UP THE SRB */ 02217000
*                 /* IN THE MCCE TO SCHEDULE AHLTFREE, AND REMOVE THE*/ 02218000
*                 /* MCQE FROM THE MCQE CHAIN.                       */ 02219000
*                 /*                                                 */ 02220000
*                 /***************************************************/ 02221000
*                                                               02S0612 02222000
*                 MCCEOMCQ=MCQEPTR; /* SAVE MCQE ADDRESS IN     02S0612 02223000
*                                      TO-BE-FREED FIELD             */ 02224000
@RF00522 L     @05,MCCEPTR                                      02S0612 02225000
         ST    MCQEPTR,MCCEOMCQ(,@05)                           02S0612 02226000
*                 RFY                                           02S0613 02227000
*                   SRBPTR RSTD;                                02S0613 02228000
*                 SRBPTR=ADDR(MCCESRB);/* POINT TO TABLE FREEING SRB */ 02229000
         LA    SRBPTR,MCCESRB(,@05)                             02S0614 02230000
*                 SRBASCB=PSAAOLD;  /* HAVE SRB RUN IN THIS MEMORY   */ 02231000
         L     @00,PSAAOLD                                      02S0615 02232000
         ST    @00,SRBASCB(,SRBPTR)                             02S0615 02233000
*                 RFY                                           02S0616 02234000
*                   SRBPTR UNRSTD;                              02S0616 02235000
*                 IF LASTMCQ=0 THEN                             02S0617 02236000
         LTR   LASTMCQ,LASTMCQ                                  02S0617 02237000
         BNZ   @RF00617                                         02S0617 02238000
*                   MCCEQEA=MCQEMCQE;/* IF THIS IS THE FIRST MCQE,      02239000
*                                      CHANGE POINTER IN THE MCCE TO    02240000
*                                      POINT TO THE NEXT MCQE ON        02241000
*                                      CHAIN                         */ 02242000
         L     @06,MCQEMCQE(,MCQEPTR)                           02S0618 02243000
         ST    @06,MCCEQEA(,@05)                                02S0618 02244000
*                 ELSE                                          02S0619 02245000
*                   LASTMCQ->MCQEMCQE=MCQEMCQE;/* OTHERWISE, REMOVE     02246000
*                                      FROM CHAIN BY STORING ITS LINK   02247000
*                                      FIELD INTO PRIOR MCQE         */ 02248000
         B     @RC00617                                         02S0619 02249000
@RF00617 L     @05,MCQEMCQE(,MCQEPTR)                           02S0619 02250000
         ST    @05,MCQEMCQE(,LASTMCQ)                           02S0619 02251000
*                                                               02S0620 02252000
*                 /***************************************************/ 02253000
*                 /*                                                 */ 02254000
*                 /* IF THIS IS THE LAST MCQE TO BE REMOVED, SET UP  */ 02255000
*                 /* TO FREE ALL REMAINING TABLES                    */ 02256000
*                 /*                                                 */ 02257000
*                 /***************************************************/ 02258000
*                                                               02S0620 02259000
*                 IF MCCEQEA=0 THEN                             02S0620 02260000
@RC00617 SLR   @06,@06                                          02S0620 02261000
         L     @15,MCCEPTR                                      02S0620 02262000
         C     @06,MCCEQEA(,@15)                                02S0620 02263000
         BNE   @RF00620                                         02S0620 02264000
*                   DO;             /* HAVE WE REMOVED LAST MCQE     */ 02265000
*                     NEWMCCE=0;    /* INDICATE THAT THE NEXT MCCE      02266000
*                                      ADDRESS IS TO BE ZERO         */ 02267000
         ST    @06,NEWMCCE                                      02S0622 02268000
*                     MCHACT='0'B;  /* TURN OFF MC ROUTING SINCE THIS   02269000
*                                      IS THE LAST APPLICATION THAT     02270000
*                                      IS BEING REMOVED.             */ 02271000
         L     @01,MCHEADPT                                     02S0623 02272000
         NI    MCHACT(@01),B'01111111'                          02S0623 02273000
*                     IF MCCEEDA^=0 THEN                        02S0624 02274000
         L     @14,MCCEEDA(,@15)                                02S0624 02275000
         CR    @14,@06                                          02S0624 02276000
         BE    @RF00624                                         02S0624 02277000
*                       MCCEOEDA=MCCEEDA;/* IF AN MCED STILL ESISTS,    02278000
*                                      INDICATE THAT IT IS TO BE        02279000
*                                      FREED BY MOVING ITS ADDRESS      02280000
*                                      INTO THE MCCEOEDA FIELD. THAT    02281000
*                                      TELLS AHLTFREE TO FREE IT.    */ 02282000
         ST    @14,MCCEOEDA(,@15)                               02S0625 02283000
*                     IF MCCECDA^=0 THEN                        02S0626 02284000
@RF00624 L     @06,MCCEPTR                                      02S0626 02285000
         L     @15,MCCECDA(,@06)                                02S0626 02286000
         LTR   @15,@15                                          02S0626 02287000
         BZ    @RF00626                                         02S0626 02288000
*                       MCCEOCDA=MCCECDA;/* DO THE SAME WITH THE MCCD   02289000
*                                      IF IT EXISTS.                 */ 02290000
         ST    @15,MCCEOCDA(,@06)                               02S0627 02291000
*                   END;                                        02S0628 02292000
*                 ELSE                                          02S0629 02293000
*                   DO;                                         02S0629 02294000
*                                                               02S0629 02295000
         B     @RC00620                                         02S0629 02296000
@RF00620 DS    0H                                               02S0630 02297000
*                     /***********************************************/ 02298000
*                     /*                                             */ 02299000
*                     /* OTHERWISE, THERE ARE MORE MCQES REMAINING. A*/ 02300000
*                     /* NEW MCCE MUST MUST BE GOTTEN TO DESCRIBE THE*/ 02301000
*                     /* REMAINING TABLES, WHILE THE OLD MCCE IS USED*/ 02302000
*                     /* TO DESCRIBE THE TABLES TO BE FREED BY       */ 02303000
*                     /* AHLTFREE                                    */ 02304000
*                     /*                                             */ 02305000
*                     /***********************************************/ 02306000
*                                                               02S0630 02307000
*                     DO;           /* GETMAIN (EC) LV(LENGTH(MCCE))    02308000
*                                      A(GETMADDR) SP(SQA)           */ 02309000
*                       RESPECIFY                               02S0631 02310000
*                        (GPR01P) RESTRICTED;                   02S0631 02311000
*                       I004=I004&&I004;/* INIT LIST                 */ 02312000
         XC    I004(10),I004                                    02S0632 02313000
*                       I00404='20'X;/* TYPE                         */ 02314000
         MVI   I00404,X'20'                                     02S0633 02315000
*                       I00401=LENGTH(MCCE);/* LENGTH                */ 02316000
         MVC   I00401(4),@CF02504                               02S0634 02317000
*                       I00403=ADDR(GETMADDR);/* ADDR OF ADDR LIST   */ 02318000
         LA    @06,GETMADDR                                     02S0635 02319000
         STCM  @06,7,I00403                                     02S0635 02320000
*                       I00405=SQA; /* SUBPOOL VALUE                 */ 02321000
         MVI   I00405,X'F5'                                     02S0636 02322000
*                       GPR01P=ADDR(I004);/* REG1 POINTS TO LIST     */ 02323000
         LA    GPR01P,I004                                      02S0637 02324000
*                       SVC(4);     /* STANDARD-FORM OF GETMAIN      */ 02325000
         SVC   4                                                02S0638 02326000
*                       RESPECIFY                               02S0639 02327000
*                        (GPR01P) UNRESTRICTED;                 02S0639 02328000
*                     END;          /* GETMAIN (EC) LV(LENGTH(MCCE))    02329000
*                                      A(GETMADDR) SP(SQA) GET  02S0640 02330000
*                                      STORAGE FOR A NEW MCCE        */ 02331000
*                     IF RETCOD15^=0 THEN                       02S0641 02332000
         SLR   @14,@14                                          02S0641 02333000
         CR    RETCOD15,@14                                     02S0641 02334000
         BE    @RF00641                                         02S0641 02335000
*                       DO;                                     02S0642 02336000
*                                                               02S0642 02337000
*                         /*******************************************/ 02338000
*                         /*                                         */ 02339000
*                         /* IF A NEW MCCE CANNOT BE GOTTEN, THE MC  */ 02340000
*                         /* ROUTING FACILITY MUST TERMINATE SINCE   */ 02341000
*                         /* THERE IS NOT ENOUGH SQA TO KEEP IT      */ 02342000
*                         /* ALIVE. THIS TERMINATION PHASE IS        */ 02343000
*                         /* ACCOMPLISHED BY SCHEDULING SRB ROUTINE  */ 02344000
*                         /* AHLMCPST TO POST ALL APPLICATIONS TO    */ 02345000
*                         /* TERMINATE AND FREE THE ROUTING TABLES.  */ 02346000
*                         /*                                         */ 02347000
*                         /*******************************************/ 02348000
*                                                               02S0643 02349000
*                         MCHACT='0'B;/* DISABLE MC ROUTING          */ 02350000
         L     @06,MCHEADPT                                     02S0643 02351000
         NI    MCHACT(@06),B'01111111'                          02S0643 02352000
*                         RFY                                   02S0644 02353000
*                           SRBPTR RSTD;                        02S0644 02354000
*                         SRBPTR=ADDR(MCCESRB);                 02S0645 02355000
         L     SRBPTR,MCCEPTR                                   02S0645 02356000
         LA    SRBPTR,MCCESRB(,SRBPTR)                          02S0645 02357000
*                         SRBEP=ADDR(AHLMCPST);/* CHANGE THE EP TO      02358000
*                                      REFERENCE AHLMCPST            */ 02359000
         LA    @06,AHLMCPST                                     02S0646 02360000
         ST    @06,SRBEP(,SRBPTR)                               02S0646 02361000
*                         RFY                                   02S0647 02362000
*                           SRBPTR UNRSTD;                      02S0647 02363000
*                         NEWMCCE=0;/* INDICATE THAT THERE IS NO NEW    02364000
*                                      MCCE                          */ 02365000
         ST    @14,NEWMCCE                                      02S0648 02366000
*                         CALL CSDMCCE;/* CALL SUBROUTINE TO SWAP IN    02367000
*                                      NEW MCCE ADRESS AND SCHEDULE     02368000
*                                      THE SRB IN THE OLD MCCE       */ 02369000
         BAL   @14,CSDMCCE                                      02S0649 02370000
*                         DO;       /* WAIT ECB(MCCEECB)             */ 02371000
*                           RESPECIFY                           02S0651 02372000
*                            (GPR00P,                           02S0651 02373000
*                             GPR01P) RESTRICTED;               02S0651 02374000
*                           GPR00P=1;/* LOAD WAIT COUNT              */ 02375000
         LA    GPR00P,1                                         02S0652 02376000
*                           GPR01P=ADDR(MCCEECB);/* ADDRESS OF ECB   */ 02377000
         L     GPR01P,MCCEPTR                                   02S0653 02378000
         LA    GPR01P,MCCEECB(,GPR01P)                          02S0653 02379000
*                           SVC(1); /* WAIT SVC                      */ 02380000
         SVC   1                                                02S0654 02381000
*                           RESPECIFY                           02S0655 02382000
*                            (GPR00P,                           02S0655 02383000
*                             GPR01P) UNRESTRICTED;             02S0655 02384000
*                         END;      /* WAIT ECB(MCCEECB) WAIT UNTIL     02385000
*                                      AHLMCPST COMPLETES            */ 02386000
*                                                               02S0656 02387000
*                         /*******************************************/ 02388000
*                         /*                                         */ 02389000
*                         /* FREE THE OLD MCCE                       */ 02390000
*                         /*                                         */ 02391000
*                         /*******************************************/ 02392000
*                                                               02S0657 02393000
*                         DO;       /* FREEMAIN (E) LV(LENGTH(MCCE))    02394000
*                                      A(MCCEPTR) SP(SQA)            */ 02395000
*                           RESPECIFY                           02S0658 02396000
*                            (GPR01P) RESTRICTED;               02S0658 02397000
*                           I005=I005&&I005;/* INIT LIST             */ 02398000
         XC    I005(10),I005                                    02S0659 02399000
*                           I00505='00'X;/* SET TYPE                 */ 02400000
         MVI   I00505,X'00'                                     02S0660 02401000
*                           I00502=LENGTH(MCCE);/* LENGTH            */ 02402000
         MVC   I00502(3),@CF02504+1                             02S0661 02403000
*                           I00504=ADDR(MCCEPTR);/* ADDR OF ADDR LIST*/ 02404000
         LA    @06,MCCEPTR                                      02S0662 02405000
         STCM  @06,7,I00504                                     02S0662 02406000
*                           I00506=SQA;/* SUBPOOL VALUE              */ 02407000
         MVI   I00506,X'F5'                                     02S0663 02408000
*                           GPR01P=ADDR(I005);/* REG1 POINTS TO LIST */ 02409000
         LA    GPR01P,I005                                      02S0664 02410000
*                           SVC(5); /* STANDARD-FORM OF GETMAIN      */ 02411000
         SVC   5                                                02S0665 02412000
*                           RESPECIFY                           02S0666 02413000
*                            (GPR01P) UNRESTRICTED;             02S0666 02414000
*                         END;      /* FREEMAIN (E) LV(LENGTH(MCCE))    02415000
*                                      A(MCCEPTR) SP(SQA)            */ 02416000
*                                                               02S0667 02417000
*                         /*******************************************/ 02418000
*                         /*                                         */ 02419000
*                         /* PGFREE AHLSETD SINCE IT IS NO LONGER    */ 02420000
*                         /* NEEDED                                  */ 02421000
*                         /*                                         */ 02422000
*                         /*******************************************/ 02423000
*                                                               02S0668 02424000
*                         DO;       /* PGFREE(R) A(SETDPTR)          */ 02425000
*                           RESPECIFY                           02S0669 02426000
*                            (GPR00P,                           02S0669 02427000
*                             GPR01P) RESTRICTED;               02S0669 02428000
*                           GPR00P=0;/* INDICATE NO PAGE ECB         */ 02429000
         SLR   GPR00P,GPR00P                                    02S0670 02430000
*                           GPR01P=ADDR(SETDPTR);/* PAGE ADDR        */ 02431000
         L     @06,MCHEADPT                                     02S0671 02432000
         L     @06,MCHSETD(,@06)                                02S0671 02433000
         LR    GPR01P,@06                                       02S0671 02434000
*                           RESPECIFY                           02S0672 02435000
*                             GPR15P RESTRICTED;                02S0672 02436000
*                           GPR15P=ADDR(SETDPTR)+1;/* VSL ADDR  02S0673 02437000
*                                      OMITTED                       */ 02438000
         AL    @06,@CF00145                                     02S0673 02439000
         LR    GPR15P,@06                                       02S0673 02440000
*                           GPR01P=GPR01P|'20000000'X;/* R, PGFREE &    02441000
*                                      RELEASE FLAG                  */ 02442000
         O     GPR01P,@CF02311                                  02S0674 02443000
*                           SVC(113);/* ISSUE PGFREE SVC             */ 02444000
         SVC   113                                              02S0675 02445000
*                           RESPECIFY                           02S0676 02446000
*                            (GPR00P,                           02S0676 02447000
*                             GPR01P,                           02S0676 02448000
*                             GPR15P) UNRESTRICTED;             02S0676 02449000
*                         END;      /* PGFREE(R) A(SETDPTR)          */ 02450000
*                         MCHCTL=0; /* CLEAR THE CLASS MASK SINCE       02451000
*                                      THERE ARE NO MORE ACTIVE 02S0678 02452000
*                                      CLASSES                       */ 02453000
         L     @06,MCHEADPT                                     02S0678 02454000
         SLR   @15,@15                                          02S0678 02455000
         ST    @15,MCHCTL(,@06)                                 02S0678 02456000
*                         CALL CR8SET;/* CLEAR CR 8 ON ALL CPUS      */ 02457000
         BAL   @14,CR8SET                                       02S0679 02458000
*                         GO TO AHLFREE3;/* GO FREE THE MCQE AND ITS    02459000
*                                      ASSOCIATED ELEMENTS           */ 02460000
         B     AHLFREE3                                         02S0680 02461000
*                       END;        /* END OF TERMINATION PHASE PATH */ 02462000
*                                                               02S0682 02463000
*                     /***********************************************/ 02464000
*                     /*                                             */ 02465000
*                     /* IF MCCE HAS BEEN OBTAINED, CALL INITMCCE    */ 02466000
*                     /* SUBROUTINE TO INITIALIZE IT.                */ 02467000
*                     /*                                             */ 02468000
*                     /***********************************************/ 02469000
*                                                               02S0682 02470000
*                     ELSE                                      02S0682 02471000
*                       DO;                                     02S0682 02472000
@RF00641 DS    0H                                               02S0683 02473000
*                         CALL INITMCCE;                        02S0683 02474000
         BAL   @14,INITMCCE                                     02S0683 02475000
*                         NEWMCCE=GETMADDR;/* SAVE THIS NEW MCCE        02476000
*                                      ADDRESS                       */ 02477000
         L     @06,GETMADDR                                     02S0684 02478000
         ST    @06,NEWMCCE                                      02S0684 02479000
*                       END;                                    02S0685 02480000
*                   END;            /* END OF NEW MCCE PATH          */ 02481000
*                                                               02S0686 02482000
*                 /***************************************************/ 02483000
*                 /*                                                 */ 02484000
*                 /* THE OLD MCCE (POINTED TO BE MCCEPTR) HAS BEEN   */ 02485000
*                 /* SET UP FOR TABLE FREEING PROCESSING BY AHLTFREE,*/ 02486000
*                 /* AND THE NEW MCCE (POINTED TO BY NEWMCCE) HAS    */ 02487000
*                 /* BEEN INITIALIZED TO REFLECT THE NEW ROUTING     */ 02488000
*                 /* SCHEME. PROCESSING IS COMPLETED BY CALLING      */ 02489000
*                 /* SUBROUTINE CSDMCCE, CREATING A NEW CONTROL      */ 02490000
*                 /* REGISTER MASK FOR ALL CPUS IF NECESSARY, AND    */ 02491000
*                 /* FREEING THE OLD MCCE.                           */ 02492000
*                 /*                                                 */ 02493000
*                 /***************************************************/ 02494000
*                                                               02S0687 02495000
*                 CALL CSDMCCE;     /* CALL SUBROUTINE TO SWAP IN THE   02496000
*                                      MCCE POINTED TO BY NEWMCCE TO    02497000
*                                      REPLACE THE CURRENT MCCE. THE    02498000
*                                      SUBROUTINE WILL ALSO CAUSE THE   02499000
*                                      SRB IN THE OLD MCCE TO BE        02500000
*                                      SCHEDULED                     */ 02501000
*                                                               02S0687 02502000
@RC00620 BAL   @14,CSDMCCE                                      02S0687 02503000
*                 /***************************************************/ 02504000
*                 /*                                                 */ 02505000
*                 /* WAIT UNTIL AHLTFREE COMPLETES                   */ 02506000
*                 /*                                                 */ 02507000
*                 /***************************************************/ 02508000
*                                                               02S0688 02509000
*                 DO;               /* WAIT ECB(MCCEECB)             */ 02510000
*                   RESPECIFY                                   02S0689 02511000
*                    (GPR00P,                                   02S0689 02512000
*                     GPR01P) RESTRICTED;                       02S0689 02513000
*                   GPR00P=1;       /* LOAD WAIT COUNT               */ 02514000
         LA    GPR00P,1                                         02S0690 02515000
*                   GPR01P=ADDR(MCCEECB);/* ADDRESS OF ECB           */ 02516000
         L     GPR01P,MCCEPTR                                   02S0691 02517000
         LA    GPR01P,MCCEECB(,GPR01P)                          02S0691 02518000
*                   SVC(1);         /* WAIT SVC                      */ 02519000
         SVC   1                                                02S0692 02520000
*                   RESPECIFY                                   02S0693 02521000
*                    (GPR00P,                                   02S0693 02522000
*                     GPR01P) UNRESTRICTED;                     02S0693 02523000
*                 END;              /* WAIT ECB(MCCEECB)             */ 02524000
*                 MCHCTL=0;         /* CLEAR THE CONTROL REGISTER       02525000
*                                      MASK TO CREATE A CLEAN BASE TO   02526000
*                                      CREATE THE NEW MASK           */ 02527000
*                                                               02S0695 02528000
         SLR   @06,@06                                          02S0695 02529000
         L     @15,MCHEADPT                                     02S0695 02530000
         ST    @06,MCHCTL(,@15)                                 02S0695 02531000
*                 /***************************************************/ 02532000
*                 /*                                                 */ 02533000
*                 /* IF THE TABLES HAVE BEEN REMOVED, AHLSETD MUST BE*/ 02534000
*                 /* FREED                                           */ 02535000
*                 /*                                                 */ 02536000
*                 /***************************************************/ 02537000
*                                                               02S0696 02538000
*                 IF NEWMCCE=0 THEN                             02S0696 02539000
         C     @06,NEWMCCE                                      02S0696 02540000
         BNE   @RF00696                                         02S0696 02541000
*                   DO;             /* PGFREE(R) A(SETDPTR)          */ 02542000
*                     RESPECIFY                                 02S0698 02543000
*                      (GPR00P,                                 02S0698 02544000
*                       GPR01P) RESTRICTED;                     02S0698 02545000
*                     GPR00P=0;     /* INDICATE NO PAGE ECB          */ 02546000
         SLR   GPR00P,GPR00P                                    02S0699 02547000
*                     GPR01P=ADDR(SETDPTR);/* PAGE ADDR              */ 02548000
         L     @06,MCHSETD(,@15)                                02S0700 02549000
         LR    GPR01P,@06                                       02S0700 02550000
*                     RESPECIFY                                 02S0701 02551000
*                       GPR15P RESTRICTED;                      02S0701 02552000
*                     GPR15P=ADDR(SETDPTR)+1;/* VSL ADDR OMITTED     */ 02553000
         AL    @06,@CF00145                                     02S0702 02554000
         LR    GPR15P,@06                                       02S0702 02555000
*                     GPR01P=GPR01P|'20000000'X;/* R, PGFREE &  02S0703 02556000
*                                      RELEASE FLAG                  */ 02557000
         O     GPR01P,@CF02311                                  02S0703 02558000
*                     SVC(113);     /* ISSUE PGFREE SVC              */ 02559000
         SVC   113                                              02S0704 02560000
*                     RESPECIFY                                 02S0705 02561000
*                      (GPR00P,                                 02S0705 02562000
*                       GPR01P,                                 02S0705 02563000
*                       GPR15P) UNRESTRICTED;                   02S0705 02564000
*                   END;            /* PGFREE(R) A(SETDPTR)          */ 02565000
*                                                               02S0706 02566000
*                 /***************************************************/ 02567000
*                 /*                                                 */ 02568000
*                 /* OTHERWISE, A NEW CLASS MASK MUST BE CREATED BY  */ 02569000
*                 /* INVESTIGATING ALL MCQES ON THE CHAIN.           */ 02570000
*                 /*                                                 */ 02571000
*                 /***************************************************/ 02572000
*                                                               02S0707 02573000
*                 ELSE                                          02S0707 02574000
*                   DO;                                         02S0707 02575000
         B     @RC00696                                         02S0707 02576000
@RF00696 DS    0H                                               02S0708 02577000
*                     RFY                                       02S0708 02578000
*                       MCCE BASED(NEWMCCE);                    02S0708 02579000
*                     MCQEPTR=MCCEQEA;/* PICK UP FIRST MCQE ON CHAIN */ 02580000
         L     @06,NEWMCCE                                      02S0709 02581000
         L     MCQEPTR,MCCEQEA(,@06)                            02S0709 02582000
*                     DO WHILE(MCQEPTR^=0);/* PROCESS EVERY MCQE ON     02583000
*                                      CHAIN                         */ 02584000
         B     @DE00710                                         02S0710 02585000
@DL00710 DS    0H                                               02S0711 02586000
*                       IF MCQEACT='1'B THEN                    02S0711 02587000
         TM    MCQEACT(MCQEPTR),B'10000000'                     02S0711 02588000
         BNO   @RF00711                                         02S0711 02589000
*                         CALL CR8MASK;/* FOR EVERY ACTIVE MCQE,        02590000
*                                      SUBROUTINE CR8MASK IS CALLED     02591000
*                                      TO CREATE A NEW MASK          */ 02592000
         BAL   @14,CR8MASK                                      02S0712 02593000
*                       MCQEPTR=MCQEMCQE;/* INCREMENT TO NEXT MCQE ON   02594000
*                                      CHAIN                         */ 02595000
@RF00711 L     MCQEPTR,MCQEMCQE(,MCQEPTR)                       02S0713 02596000
*                     END;          /* LOOP THROUGH ALL MCQES ON        02597000
*                                      CHAIN                         */ 02598000
@DE00710 LTR   MCQEPTR,MCQEPTR                                  02S0714 02599000
         BNZ   @DL00710                                         02S0714 02600000
*                   END;            /* END OF MASK-CREATION PATH     */ 02601000
*                 CALL CR8SET;      /* CALL SUBROUTINE TO SET THIS      02602000
*                                      NEW CLASS MASK ON ALL CPUS CR    02603000
*                                      8                             */ 02604000
*                                                               02S0716 02605000
@RC00696 BAL   @14,CR8SET                                       02S0716 02606000
*                 /***************************************************/ 02607000
*                 /*                                                 */ 02608000
*                 /* FREE THE OLD MCCE                               */ 02609000
*                 /*                                                 */ 02610000
*                 /***************************************************/ 02611000
*                                                               02S0717 02612000
*                 RFY                                           02S0717 02613000
*                   MCCE BASED(MCCEPTR);                        02S0717 02614000
*                 DO;               /* FREEMAIN (E) LV(LENGTH(MCCE))    02615000
*                                      A(MCCEPTR) SP(SQA)            */ 02616000
*                   RESPECIFY                                   02S0719 02617000
*                    (GPR01P) RESTRICTED;                       02S0719 02618000
*                   I005=I005&&I005;/* INIT LIST                     */ 02619000
         XC    I005(10),I005                                    02S0720 02620000
*                   I00505='00'X;   /* SET TYPE                      */ 02621000
         MVI   I00505,X'00'                                     02S0721 02622000
*                   I00502=LENGTH(MCCE);/* LENGTH                    */ 02623000
         MVC   I00502(3),@CF02504+1                             02S0722 02624000
*                   I00504=ADDR(MCCEPTR);/* ADDR OF ADDR LIST        */ 02625000
         LA    @06,MCCEPTR                                      02S0723 02626000
         STCM  @06,7,I00504                                     02S0723 02627000
*                   I00506=SQA;     /* SUBPOOL VALUE                 */ 02628000
         MVI   I00506,X'F5'                                     02S0724 02629000
*                   GPR01P=ADDR(I005);/* REG1 POINTS TO LIST         */ 02630000
         LA    GPR01P,I005                                      02S0725 02631000
*                   SVC(5);         /* STANDARD-FORM OF GETMAIN      */ 02632000
         SVC   5                                                02S0726 02633000
*                   RESPECIFY                                   02S0727 02634000
*                    (GPR01P) UNRESTRICTED;                     02S0727 02635000
*                 END;              /* FREEMAIN (E) LV(LENGTH(MCCE))    02636000
*                                      A(MCCEPTR) SP(SQA)            */ 02637000
*               END;                /* END OF NON-ZERO MCCE PATH     */ 02638000
*             RFY                                               02S0730 02639000
*               MCCE BASED(MCHCUR);                             02S0730 02640000
@RC00460 DS    0H                                               02S0731 02641000
*           END;                                                01S0731 02642000
*                                                               01S0732 02643000
*         /***********************************************************/ 02644000
*         /*                                                         */ 02645000
*         /* THE BITS THAT WERE CHECKED ABOVE (ADD,ACTIVATE, AND     */ 02646000
*         /* FREE) ARE THE ONLY VALID FLAGS TO BE SET UPON ENTRANCE  */ 02647000
*         /* TO AHLSETEV. THE ONLY OTHER VALID OPTION IS THE INIT    */ 02648000
*         /* FUNCTION, INDICATED BY A ZERO OPTION BYTE. IN THIS CASE,*/ 02649000
*         /* SUBROUTINE GETMCQE IS CALLED. ANY OTHER BIT SETTING IN  */ 02650000
*         /* THE FLAG BYTE IS INVALID, AND THE CALLER IS ABENDED.    */ 02651000
*         /*                                                         */ 02652000
*         /***********************************************************/ 02653000
*                                                               01S0732 02654000
*         ELSE                                                  01S0732 02655000
*           IF SETOPTS=0 THEN                                   01S0732 02656000
         B     @RC00458                                         01S0732 02657000
@RF00458 L     @06,PLISTAD                                      01S0732 02658000
         CLI   SETOPTS(@06),0                                   01S0732 02659000
         BNE   @RF00732                                         01S0732 02660000
*             CALL GETMCQE;                                     01S0733 02661000
         BAL   @14,GETMCQE                                      01S0733 02662000
*           ELSE                                                01S0734 02663000
*             DO;                                               01S0734 02664000
         B     @RC00732                                         01S0734 02665000
@RF00732 DS    0H                                               01S0735 02666000
*               RFY                                             01S0735 02667000
*                 ABNDCODE RSTD;                                01S0735 02668000
*               ABNDCODE=BADOPT;    /* SET CORRECT ABEND CODE        */ 02669000
         LA    ABNDCODE,4                                       01S0736 02670000
*               DO;                 /* ABEND(SETCMPCD) DUMP SYSTEM   */ 02671000
*                 RESPECIFY                                     01S0738 02672000
*                  (GPR01F) RESTRICTED;                         01S0738 02673000
*                 GPR01F=((SETCMPCD)&'00000FFF'X)*4096;/* COMP CODE     02674000
*                                      IN BITS 8-19                  */ 02675000
         L     GPR01F,@CF02503                                  01S0739 02676000
*                 GPR01F=GPR01F|'80000000'X;/* DUMP/STEP/DUMPOPTS       02677000
*                                      FLAG                          */ 02678000
         O     GPR01F,@CF02273                                  01S0740 02679000
*                 SVC(13);          /* ISSUE ABEND SVC               */ 02680000
         SVC   13                                               01S0741 02681000
*                 RESPECIFY                                     01S0742 02682000
*                  (GPR01F) UNRESTRICTED;                       01S0742 02683000
*               END;                /* ABEND(SETCMPCD) DUMP SYSTEM   */ 02684000
*               RFY                                             01S0744 02685000
*                 ABNDCODE UNRSTD;                              01S0744 02686000
*             END;                                              01S0745 02687000
*       END;                        /* END OF PATH WITH ADD FUNCTION    02688000
*                                      OFF                           */ 02689000
*                                                               01S0746 02690000
@RC00732 DS    0H                                               01S0746 02691000
@RC00458 DS    0H                                               01S0747 02692000
*   /*****************************************************************/ 02693000
*   /*                                                               */ 02694000
*   /* PROCESSING IS COMPLETED. CLEAN UP AND RETURN                  */ 02695000
*   /*                                                               */ 02696000
*   /*****************************************************************/ 02697000
*                                                               01S0747 02698000
*                                                               02S0747 02699000
*   /*****************************************************************/ 02700000
*   /*                                                               */ 02701000
*   /* EXIT CODE. DEQ FROM THE RESOURCE, REESTABLISH THE CALLERS     */ 02702000
*   /* ENVIRONMENT, REMOVE THE ESTAE, AND SET THE PROPER RETURN CODE */ 02703000
*   /* BEFORE RETURNING TO THE CALLER. THE RETURN CODE HAS BEEN SET  */ 02704000
*   /* IN FIELD RTRNCODE. THIS ROUTINE PLACES THAT VALUE IN THE      */ 02705000
*   /* CALLERS SAVE AREA BEFORE RESTORING REGISTERS.                 */ 02706000
*   /*                                                               */ 02707000
*   /*****************************************************************/ 02708000
*                                                               02S0747 02709000
*AHLEXIT:                                                       02S0747 02710000
*                                                               02S0747 02711000
*   /*****************************************************************/ 02712000
*   /*                                                               */ 02713000
*   /* DEQ FROM RESOURCE                                             */ 02714000
*   /*                                                               */ 02715000
*   /*****************************************************************/ 02716000
*                                                               02S0747 02717000
*   DO;                             /* DEQ (SETQNM,SETRNM,3,SYSTEMS)    02718000
*                                      RET(HAVE)                     */ 02719000
@RF00456 DS    0H                                               02S0747 02720000
@RC00304 DS    0H                                               02S0747 02721000
AHLEXIT  DS    0H                                               02S0748 02722000
*     I048(1:20)=I048(1:20)&&I048(1:20);                        02S0748 02723000
         XC    I048(20),I048                                    02S0748 02724000
*     RFY                                                       02S0749 02725000
*       GPR01F RESTRICTED;                                      02S0749 02726000
*     I04804(1)='11000000'B;        /* LISTEND BYTE                  */ 02727000
         MVI   I04804,B'11000000'                               02S0750 02728000
*     I04805(1)=3;                  /* SET LENGTH                    */ 02729000
         MVI   I04805,X'03'                                     02S0751 02730000
*     I04806(1)='01001001'B;        /* OPTIONS                       */ 02731000
         MVI   I04806,B'01001001'                               02S0752 02732000
*     I04807(1)=ADDR(SETQNM);       /* QNAME ADDRESS                 */ 02733000
         LA    @06,@CC00164                                     02S0753 02734000
         ST    @06,I04807                                       02S0753 02735000
*     I04808(1)=ADDR(SETRNM);       /* RNAME ADDRESS                 */ 02736000
         LA    @06,@CC00166                                     02S0754 02737000
         ST    @06,I04808                                       02S0754 02738000
*     GPR01F=ADDR(I04802);                                      02S0755 02739000
         LA    GPR01F,I04802                                    02S0755 02740000
*     SVC(48);                                                  02S0756 02741000
         SVC   48                                               02S0756 02742000
*     RFY                                                       02S0757 02743000
*       GPR01F UNRESTRICTED;                                    02S0757 02744000
*   END;                            /* DEQ (SETQNM,SETRNM,3,SYSTEMS)    02745000
*                                      RET(HAVE)                     */ 02746000
*   RFY                                                         02S0759 02747000
*     TEMPREG RSTD;                                             02S0759 02748000
*                                                               02S0759 02749000
*   /*****************************************************************/ 02750000
*   /*                                                               */ 02751000
*   /* REESTABLISH THE CALLERS PROTECT KEY FROM WHERE IT WAS SAVED   */ 02752000
*   /*                                                               */ 02753000
*   /*****************************************************************/ 02754000
*                                                               02S0760 02755000
*   DO;                             /* MODESET KEYADDR(HISKEY)  02S0760 02756000
*                                      WORKREG(TEMPREG)              */ 02757000
*     TEMPREG=HISKEY;               /* GET KEY FORM SAVE LOCATION    */ 02758000
         LR    TEMPREG,HISKEY                                   02S0761 02759000
*     SPKA(TEMPREG);                /* SET PSW KEY                   */ 02760000
         SPKA  0(TEMPREG)                                       02S0762 02761000
*   END;                            /* MODESET KEYADDR(HISKEY)  02S0763 02762000
*                                      WORKREG(TEMPREG)              */ 02763000
*   RFY                                                         02S0764 02764000
*     TEMPREG UNRSTD;                                           02S0764 02765000
*                                                               02S0764 02766000
*   /*****************************************************************/ 02767000
*   /*                                                               */ 02768000
*   /* RESTORE TO PROBLEM STATE IF CALLER WAS ORIGINALLY IN THAT     */ 02769000
*   /* STATE                                                         */ 02770000
*   /*                                                               */ 02771000
*   /*****************************************************************/ 02772000
*                                                               02S0765 02773000
*   IF PROBSTAT='1'B THEN                                       02S0765 02774000
         TM    PROBSTAT,B'10000000'                             02S0765 02775000
         BNO   @RF00765                                         02S0765 02776000
*     DO;                           /* MODESET MODE(PROB)            */ 02777000
*       I10701='00000000'B;         /* OR MASK                       */ 02778000
         MVI   I10701,B'00000000'                               02S0767 02779000
*       I10702='00000000'B;         /* AND MASK                      */ 02780000
         MVI   I10702,B'00000000'                               02S0768 02781000
*       I10703='00000000'B;         /* RESERVED                      */ 02782000
         MVI   I10703,B'00000000'                               02S0769 02783000
*       I10704='00000100'B;                                     02S0770 02784000
         MVI   I10704,B'00000100'                               02S0770 02785000
*       RESPECIFY                                               02S0771 02786000
*         GPR01F RESTRICTED;                                    02S0771 02787000
*       GPR01F=I107;                /* MODESET PARMLIST              */ 02788000
         L     GPR01F,I107                                      02S0772 02789000
*       SVC(107);                   /* ISSUE MODESET SVC             */ 02790000
         SVC   107                                              02S0773 02791000
*       RESPECIFY                                               02S0774 02792000
*        (GPR01F) UNRESTRICTED;                                 02S0774 02793000
*     END;                          /* MODESET MODE(PROB)            */ 02794000
*                                                               02S0775 02795000
*   /*****************************************************************/ 02796000
*   /*                                                               */ 02797000
*   /* REMOVE THE ESTAE THAT WAS ESTABLISHED ON ENTRY                */ 02798000
*   /*                                                               */ 02799000
*   /*****************************************************************/ 02800000
*                                                               02S0776 02801000
*   GENERATE;                                                   02S0776 02802000
@RF00765 DS    0H                                               02S0776 02803000
          ESTAE 0                                                       02804000
*   RFY                                                         02S0777 02805000
*     SAVEAREA RSTD;                                            02S0777 02806000
*AHLXIT2:                                                       02S0778 02807000
*   HISREGF=RTRNCODE;               /* MOVE RETURN CODE TO REG 15       02808000
*                                      SAVE AREA                     */ 02809000
AHLXIT2  L     @08,HISSAVAD(,SAVEAREA)                          02S0778 02810000
         MVC   HISREGF(4,@08),RTRNCODE                          02S0778 02811000
*   HISREG0=RTRNMCQE;               /* RETURN THE MCQE ADDRESS TO       02812000
*                                      CALLER, IF IT WAS GOTTEN ON      02813000
*                                      THIS CALL. OTHERWISE, RTRNMCQE   02814000
*                                      WILL BE ZERO.                 */ 02815000
         STCM  RTRNMCQE,15,HISREG0(@08)                         02S0779 02816000
*   RETURN;                         /* GO BACK TO THE CALLER OF 02S0780 02817000
*                                      AHLSETEV                      */ 02818000
@EL00001 L     @13,4(,@13)                                      02S0780 02819000
@EF00001 L     @00,@SIZDATD                                     02S0780 02820000
         LR    @01,@09                                          02S0780 02821000
         FREEMAIN R,LV=(0),A=(1)                                        02822000
@ER00001 LM    @14,@12,12(@13)                                  02S0780 02823000
         BR    @14                                              02S0780 02824000
*   RFY                                                         02S0781 02825000
*     SAVEAREA UNRSTD;                                          02S0781 02826000
*   GEN;                                                        02S0782 02827000
ESTAE2 ESTAE MF=L                                            ZM40016    02828000
*                                                               01S0783 02829000
*   /*****************************************************************/ 02830000
*   /*                                                               */ 02831000
*   /* SUBROUTINES                                                   */ 02832000
*   /*                                                               */ 02833000
*   /*****************************************************************/ 02834000
*                                                               01S0783 02835000
*GETMCQE:                                                       02S0783 02836000
*   PROC;                                                       02S0783 02837000
*                                                               02S0783 02838000
         B     @PB00002                                         02S0783 02839000
GETMCQE  STM   @14,@03,@SA00002                                 02S0783 02840000
         STM   @06,@09,@SA00002+24                              02S0783 02841000
         STM   @11,@12,@SA00002+40                              02S0783 02842000
*   /*****************************************************************/ 02843000
*   /*                                                               */ 02844000
*   /* THE FOLLOWING SUBROUTINE IS CALLED TO LOCATE OR OBTAIN THE    */ 02845000
*   /* MCQE ASSOCIATED WITH THE CALLER. THE ADDRESS OF THIS MCQE IS  */ 02846000
*   /* RETURNED IN MCQEPTR, AND THE RETURN CODE IN RTRNCODE IS       */ 02847000
*   /* UPDATED WITH THE PROPER RETURN CODE, IF NECESSARY. IF ALL GOES*/ 02848000
*   /* WELL, RTRNCODE WILL REMAIN AS IS                              */ 02849000
*   /*                                                               */ 02850000
*   /*****************************************************************/ 02851000
*                                                               02S0784 02852000
*   IF PASSEDQE^=0 THEN                                         02S0784 02853000
         SLR   @08,@08                                          02S0784 02854000
         L     @06,PLISTAD                                      02S0784 02855000
         ICM   @15,15,PASSEDQE(@06)                             02S0784 02856000
         CR    @08,@15                                          02S0784 02857000
         BE    @RF00784                                         02S0784 02858000
*     DO;                                                       02S0785 02859000
*                                                               02S0785 02860000
*       /*************************************************************/ 02861000
*       /*                                                           */ 02862000
*       /* IF THE CALLER OF AHLSETEV HAS SPECIFIED AN MCQE ADDRESS IN*/ 02863000
*       /* HIS PARAMETER LIST, THE MCQE CHAIN IS SEARCHED FOR AN MCQE*/ 02864000
*       /* THAT CONTAINS THE SAME NAME AS THE NAME SPECIFIED IN THE  */ 02865000
*       /* PARAMETER LIST. IF THE NAME IS NOT FOUND ON THE CHAIN, AND*/ 02866000
*       /* THE PASSED MCQE IS VALID, THE MC ROUTING FACILITY IS      */ 02867000
*       /* ASSUMED TO HAVE TERMINATED.                               */ 02868000
*       /*                                                           */ 02869000
*       /*************************************************************/ 02870000
*                                                               02S0786 02871000
*       RFY                                                     02S0786 02872000
*         MCCE BASED(MCHCUR);                                   02S0786 02873000
*       RFY                                                     02S0787 02874000
*         MCQE BASED(PASSEDQE);                                 02S0787 02875000
*       IF MCHCUR=0|MCCEQEA=0 THEN                              02S0788 02876000
         L     @06,MCHEADPT                                     02S0788 02877000
         L     @06,MCHCUR(,@06)                                 02S0788 02878000
         CR    @06,@08                                          02S0788 02879000
         BE    @RT00788                                         02S0788 02880000
         C     @08,MCCEQEA(,@06)                                02S0788 02881000
         BNE   @RF00788                                         02S0788 02882000
@RT00788 DS    0H                                               02S0789 02883000
*AHLGET01:                                                      02S0789 02884000
*         DO;                       /* IF THERE IS NO CHAIN,    02S0789 02885000
*                                      TERMINATION MUST HAVE    02S0789 02886000
*                                      OCCURRED, OR THE MCQE ADDRESS    02887000
*                                      IN THE PARAMETER LIST IS 02S0789 02888000
*                                      INVALID.                      */ 02889000
AHLGET01 DS    0H                                               02S0790 02890000
*           IF MCQEIDEN=MCQETAG&MCQENAME=PLISTNAM THEN          02S0790 02891000
         L     @08,PLISTAD                                      02S0790 02892000
         ICM   @06,15,PASSEDQE(@08)                             02S0790 02893000
         CLC   MCQEIDEN(8,@06),@CC00170                         02S0790 02894000
         BNE   @RF00790                                         02S0790 02895000
         CLC   MCQENAME(8,@06),PLISTNAM(@08)                    02S0790 02896000
         BNE   @RF00790                                         02S0790 02897000
*             DO;                   /* IF THE PASSED MCQE IS VALID,     02898000
*                                      SET THE TERMINATION RETURN       02899000
*                                      CODE AND RETURN               */ 02900000
*               RTRNCODE=TERMPHSE;                              02S0792 02901000
         MVC   RTRNCODE(4),@CF00097                             02S0792 02902000
*               RETURN;                                         02S0793 02903000
@EL00002 DS    0H                                               02S0793 02904000
@EF00002 DS    0H                                               02S0793 02905000
@ER00002 LM    @14,@03,@SA00002                                 02S0793 02906000
         LM    @06,@09,@SA00002+24                              02S0793 02907000
         LM    @11,@12,@SA00002+40                              02S0793 02908000
         BR    @14                                              02S0793 02909000
*             END;                                              02S0794 02910000
*           ELSE                                                02S0795 02911000
*AHLGET02:                                                      02S0795 02912000
*             DO;                   /* OTHERWISE, THE MCQE ADDRESS IS   02913000
*                                      INVALID. ABEND THE CALLER     */ 02914000
@RF00790 DS    0H                                               02S0795 02915000
AHLGET02 DS    0H                                               02S0796 02916000
*               RFY                                             02S0796 02917000
*                 ABNDCODE RSTD;                                02S0796 02918000
*               ABNDCODE=INVALQE1;  /* SET THE PROPER INDICATION     */ 02919000
         LA    ABNDCODE,8                                       02S0797 02920000
*               DO;                 /* ABEND(SETCMPCD) DUMP SYSTEM   */ 02921000
*                 RESPECIFY                                     02S0799 02922000
*                  (GPR01F) RESTRICTED;                         02S0799 02923000
*                 GPR01F=((SETCMPCD)&'00000FFF'X)*4096;/* COMP CODE     02924000
*                                      IN BITS 8-19                  */ 02925000
         L     GPR01F,@CF02503                                  02S0800 02926000
*                 GPR01F=GPR01F|'80000000'X;/* DUMP/STEP/DUMPOPTS       02927000
*                                      FLAG                          */ 02928000
         O     GPR01F,@CF02273                                  02S0801 02929000
*                 SVC(13);          /* ISSUE ABEND SVC               */ 02930000
         SVC   13                                               02S0802 02931000
*                 RESPECIFY                                     02S0803 02932000
*                  (GPR01F) UNRESTRICTED;                       02S0803 02933000
*               END;                /* ABEND(SETCMPCD) DUMP SYSTEM   */ 02934000
*               RFY                                             02S0805 02935000
*                 ABNDCODE UNRSTD;                              02S0805 02936000
*             END;                                              02S0806 02937000
*         END;                      /* END OF NO MCQE CHAIN PATH     */ 02938000
*                                                               02S0808 02939000
*       /*************************************************************/ 02940000
*       /*                                                           */ 02941000
*       /* SEARCH THE MCQE CHAIN FOR ONE WHICH CONTAINS THE SAME NAME*/ 02942000
*       /* AS THE ONE IN THE PARAMETER LIST.                         */ 02943000
*       /*                                                           */ 02944000
*       /*************************************************************/ 02945000
*                                                               02S0808 02946000
*       MCQEPTR=MCCEQEA;            /* LOAD FIRST MCQE ADDRESS       */ 02947000
@RF00788 L     @08,MCHEADPT                                     02S0808 02948000
         L     @08,MCHCUR(,@08)                                 02S0808 02949000
         L     MCQEPTR,MCCEQEA(,@08)                            02S0808 02950000
*       RFY                                                     02S0809 02951000
*         MCQE BASED(MCQEPTR);                                  02S0809 02952000
*       DO WHILE(MCQEPTR^=0);       /* LOOP UNTIL END OF MCQE CHAIN  */ 02953000
         B     @DE00810                                         02S0810 02954000
@DL00810 DS    0H                                               02S0811 02955000
*         IF MCQENAME=PLISTNAM THEN                             02S0811 02956000
         L     @08,PLISTAD                                      02S0811 02957000
         CLC   MCQENAME(8,MCQEPTR),PLISTNAM(@08)                02S0811 02958000
         BNE   @RF00811                                         02S0811 02959000
*           IF MCQEPTR=PASSEDQE THEN                            02S0812 02960000
         ICM   @06,15,PASSEDQE(@08)                             02S0812 02961000
         CR    MCQEPTR,@06                                      02S0812 02962000
         BE    @RT00812                                         02S0812 02963000
*             RETURN;               /* IF THE MCQE IS FOUND WITH THE    02964000
*                                      SAME NAME, AND THE ADDRESS IS    02965000
*                                      THE SAME AS THE ONE PASSED,      02966000
*                                      RETURN FROM THE SUBROUTINE.      02967000
*                                      THIS IS THE CORRECT MCQE.     */ 02968000
*           ELSE                                                02S0814 02969000
*             GO TO AHLGET02;       /* IF THE NAME IS FOUND, AND THE    02970000
*                                      ADDRESS IS NOT THE SAME, ABEND   02971000
*                                      THE CALLER                    */ 02972000
         B     AHLGET02                                         02S0814 02973000
*         MCQEPTR=MCQEMCQE;         /* POINT TO NEXT MCQE ON THE        02974000
*                                      CHAIN                         */ 02975000
@RF00811 L     MCQEPTR,MCQEMCQE(,MCQEPTR)                       02S0815 02976000
*       END;                        /* LOOP THRU THE MCQE CHAIN      */ 02977000
*                                                               02S0816 02978000
@DE00810 LTR   MCQEPTR,MCQEPTR                                  02S0816 02979000
         BNZ   @DL00810                                         02S0816 02980000
*       /*************************************************************/ 02981000
*       /*                                                           */ 02982000
*       /* FALL THROUGH TO THIS CODE INDICATES THAT THE MCQE IS NOT  */ 02983000
*       /* ON THE MCQE CHAIN. TERMINATION IS ASSUMED TO HAVE         */ 02984000
*       /* OCCURRED.                                                 */ 02985000
*       /*                                                           */ 02986000
*       /*************************************************************/ 02987000
*                                                               02S0817 02988000
*       GO TO AHLGET01;             /* GO TREAT AS IF MCQE CHAIN DID    02989000
*                                      NOT EXIST                     */ 02990000
         B     AHLGET01                                         02S0817 02991000
*     END;                          /* END OF PASSED MCQE PATH       */ 02992000
*                                                               02S0819 02993000
*   /*****************************************************************/ 02994000
*   /*                                                               */ 02995000
*   /* MCQE ADDRESS IN THE PARAMETER LIST IS ZERO. ONE IS TO BE      */ 02996000
*   /* OBTAINED FOR THIS CALLER. FIRST, HOWEVER, CHECK TO SEE IF     */ 02997000
*   /* THERE ALREADY EXISTS ONE WITH THE SAME NAME. IF SO, ABEND THE */ 02998000
*   /* CALLER. IF NOT, GET ONE FOR HIM AND INITIALIZE IT             */ 02999000
*   /*                                                               */ 03000000
*   /*****************************************************************/ 03001000
*                                                               02S0819 03002000
*   IF MCHCUR=0 THEN                                            02S0819 03003000
@RF00784 L     @08,MCHEADPT                                     02S0819 03004000
         L     @08,MCHCUR(,@08)                                 02S0819 03005000
         LTR   @08,@08                                          02S0819 03006000
         BNZ   @RF00819                                         02S0819 03007000
*     DO;                                                       02S0820 03008000
*                                                               02S0820 03009000
*       /*************************************************************/ 03010000
*       /*                                                           */ 03011000
*       /* IF THERE IS NO MCCE, GET ONE AND INITIALIZE IT            */ 03012000
*       /*                                                           */ 03013000
*       /*************************************************************/ 03014000
*                                                               02S0821 03015000
*       DO;                         /* GETMAIN (EC) LV(LENGTH(MCCE))    03016000
*                                      A(GETMADDR) SP(SQA)           */ 03017000
*         RESPECIFY                                             02S0822 03018000
*          (GPR01P) RESTRICTED;                                 02S0822 03019000
*         I004=I004&&I004;          /* INIT LIST                     */ 03020000
         XC    I004(10),I004                                    02S0823 03021000
*         I00404='20'X;             /* TYPE                          */ 03022000
         MVI   I00404,X'20'                                     02S0824 03023000
*         I00401=LENGTH(MCCE);      /* LENGTH                        */ 03024000
         MVC   I00401(4),@CF02504                               02S0825 03025000
*         I00403=ADDR(GETMADDR);    /* ADDR OF ADDR LIST             */ 03026000
         LA    @08,GETMADDR                                     02S0826 03027000
         STCM  @08,7,I00403                                     02S0826 03028000
*         I00405=SQA;               /* SUBPOOL VALUE                 */ 03029000
         MVI   I00405,X'F5'                                     02S0827 03030000
*         GPR01P=ADDR(I004);        /* REG1 POINTS TO LIST           */ 03031000
         LA    GPR01P,I004                                      02S0828 03032000
*         SVC(4);                   /* STANDARD-FORM OF GETMAIN      */ 03033000
         SVC   4                                                02S0829 03034000
*         RESPECIFY                                             02S0830 03035000
*          (GPR01P) UNRESTRICTED;                               02S0830 03036000
*       END;                        /* GETMAIN (EC) LV(LENGTH(MCCE))    03037000
*                                      A(GETMADDR) SP(SQA)           */ 03038000
*       IF RETCOD15^=0 THEN                                     02S0832 03039000
         LTR   RETCOD15,RETCOD15                                02S0832 03040000
         BZ    @RF00832                                         02S0832 03041000
*         DO;                       /* IF IT CANT BE GOTTEN, INDICATE   03042000
*                                      THIS CONDITION VIA THE RETURN    03043000
*                                      CODE AND RETURN FROM THE 02S0833 03044000
*                                      SUBROUTINE                    */ 03045000
*           RTRNCODE=INSUFSTG;                                  02S0834 03046000
         MVC   RTRNCODE(4),@CF00101                             02S0834 03047000
*           RETURN;                                             02S0835 03048000
         B     @EL00002                                         02S0835 03049000
*         END;                                                  02S0836 03050000
*       CALL INITMCCE;              /* OTHERWISE, CALL SUBROUTINE TO    03051000
*                                      INITIALIZE THE NEWLY OBTAINED    03052000
*                                      MCCE                          */ 03053000
@RF00832 BAL   @14,INITMCCE                                     02S0837 03054000
*                                                               02S0838 03055000
*       /*************************************************************/ 03056000
*       /*                                                           */ 03057000
*       /* COMPLTE THE INITIALIZATION INVOLVED WITH A NEW MCCE BY    */ 03058000
*       /* STORING ITS ADDRESS INTO THE MCHEAD, AND PGFIXING MODULE  */ 03059000
*       /* AHLSETD. THIS MODULE PERFORMS THE DISABLE AND CHANGE      */ 03060000
*       /* FUCTIONS OF THE SETEVENT SERVICE AND MUST BE FIXED WHILE  */ 03061000
*       /* MC ROUTING IS ACTIVE. IT IS FIXED EACH TIME A NEW MCCE    */ 03062000
*       /* REPLACES A ZERO ADDRESS IN THE MCHEAD, AND IS FREED EACH  */ 03063000
*       /* TIME A ZERO IS STORED INTO THE MCHEAD AS THE MCCE ADDRESS.*/ 03064000
*       /*                                                           */ 03065000
*       /*************************************************************/ 03066000
*                                                               02S0838 03067000
*       MCHCUR=GETMADDR;            /* STORE MCCE ADDRESS INTO MCHEAD*/ 03068000
*                                                               02S0838 03069000
         L     @08,MCHEADPT                                     02S0838 03070000
         L     @06,GETMADDR                                     02S0838 03071000
         ST    @06,MCHCUR(,@08)                                 02S0838 03072000
*       /*************************************************************/ 03073000
*       /*                                                           */ 03074000
*       /* PGFIX AHLSETD                                             */ 03075000
*       /*                                                           */ 03076000
*       /*************************************************************/ 03077000
*                                                               02S0839 03078000
*       SETDECB=0;                  /* CLEAR THE ECB                 */ 03079000
         SLR   @06,@06                                          02S0839 03080000
         ST    @06,SETDECB                                      02S0839 03081000
*       DO;                         /* PGFIX (R) A(SETDPTR)     02S0840 03082000
*                                      ECB(SETDECB)                  */ 03083000
*         RESPECIFY                                             02S0841 03084000
*          (GPR00P,                                             02S0841 03085000
*           GPR01P) RESTRICTED;                                 02S0841 03086000
*         GPR00P=ADDR(SETDECB);     /* ECB ADDR                      */ 03087000
         LA    GPR00P,SETDECB                                   02S0842 03088000
*         GPR01P=ADDR(SETDPTR);     /* PAGE ADDR                     */ 03089000
         L     @08,MCHSETD(,@08)                                02S0843 03090000
         LR    GPR01P,@08                                       02S0843 03091000
*         RESPECIFY                                             02S0844 03092000
*           GPR15P RESTRICTED;                                  02S0844 03093000
*         GPR15P=ADDR(SETDPTR)+1;   /* VSL ADDR OMITTED              */ 03094000
         AL    @08,@CF00145                                     02S0845 03095000
         LR    GPR15P,@08                                       02S0845 03096000
*         GPR01P=GPR01P|'52000000'X;/* R, PGFIX, RELEASE & LONG FLAGS*/ 03097000
         O     GPR01P,@CF02397                                  02S0846 03098000
*         SVC(113);                 /* ISSUE PGFIX SVC               */ 03099000
         SVC   113                                              02S0847 03100000
*         RESPECIFY                                             02S0848 03101000
*          (GPR00P,                                             02S0848 03102000
*           GPR01P) UNRESTRICTED;                               02S0848 03103000
*         RESPECIFY                                             02S0849 03104000
*           GPR15P UNRESTRICTED;                                02S0849 03105000
*       END;                        /* PGFIX (R) A(SETDPTR)     02S0850 03106000
*                                      ECB(SETDECB)                  */ 03107000
*                                                               02S0850 03108000
*       /*************************************************************/ 03109000
*       /*                                                           */ 03110000
*       /* WAIT FOR FIX TO COMPLETE                                  */ 03111000
*       /*                                                           */ 03112000
*       /*************************************************************/ 03113000
*                                                               02S0851 03114000
*       DO;                         /* WAIT (1) ECB(SETDECB)         */ 03115000
*         RESPECIFY                                             02S0852 03116000
*          (GPR00P,                                             02S0852 03117000
*           GPR01P) RESTRICTED;                                 02S0852 03118000
*         GPR00P=1;                 /* LOAD WAIT COUNT               */ 03119000
         LA    GPR00P,1                                         02S0853 03120000
*         GPR01P=ADDR(SETDECB);     /* ADDRESS OF ECB                */ 03121000
         LA    GPR01P,SETDECB                                   02S0854 03122000
*         SVC(1);                   /* WAIT SVC                      */ 03123000
         SVC   1                                                02S0855 03124000
*         RESPECIFY                                             02S0856 03125000
*          (GPR00P,                                             02S0856 03126000
*           GPR01P) UNRESTRICTED;                               02S0856 03127000
*       END;                        /* WAIT (1) ECB(SETDECB)         */ 03128000
*       LASTELM=0;                  /* INDICATE THAT NO MCQES EXIST  */ 03129000
         SLR   LASTELM,LASTELM                                  02S0858 03130000
*     END;                          /* END OF ZERO MCCE PATH         */ 03131000
*   ELSE                                                        02S0860 03132000
*     DO;                                                       02S0860 03133000
*                                                               02S0860 03134000
         B     @RC00819                                         02S0860 03135000
@RF00819 DS    0H                                               02S0861 03136000
*       /*************************************************************/ 03137000
*       /*                                                           */ 03138000
*       /* IF AN MCCE DOES EXIST, SEARCH THE MCQE CHAIN FOR A        */ 03139000
*       /* MATCHING NAME TO THAT IN THE PARAMETER LIST               */ 03140000
*       /*                                                           */ 03141000
*       /*************************************************************/ 03142000
*                                                               02S0861 03143000
*       MCQEPTR=MCCEQEA;            /* LOAD FIRST MCQE ADDRESS       */ 03144000
         L     @08,MCHEADPT                                     02S0861 03145000
         L     @08,MCHCUR(,@08)                                 02S0861 03146000
         L     MCQEPTR,MCCEQEA(,@08)                            02S0861 03147000
*       DO WHILE(MCQEPTR^=0);       /* SEARCH CHAIN UNTIL END        */ 03148000
         B     @DE00862                                         02S0862 03149000
@DL00862 DS    0H                                               02S0863 03150000
*         IF MCQENAME=PLISTNAM THEN                             02S0863 03151000
         L     @08,PLISTAD                                      02S0863 03152000
         CLC   MCQENAME(8,MCQEPTR),PLISTNAM(@08)                02S0863 03153000
         BNE   @RF00863                                         02S0863 03154000
*           DO;                     /* IF WE FIND ONE WITH THE SAME     03155000
*                                      NAME, ABEND THE CALLER        */ 03156000
*             RFY                                               02S0865 03157000
*               ABNDCODE RSTD;                                  02S0865 03158000
*             ABNDCODE=INVALQE1;    /* INDICATE INVALID MCQE ADDRESS */ 03159000
         LA    ABNDCODE,8                                       02S0866 03160000
*             DO;                   /* ABEND(SETCMPCD) DUMP SYSTEM   */ 03161000
*               RESPECIFY                                       02S0868 03162000
*                (GPR01F) RESTRICTED;                           02S0868 03163000
*               GPR01F=((SETCMPCD)&'00000FFF'X)*4096;/* COMP CODE IN    03164000
*                                      BITS 8-19                     */ 03165000
         L     GPR01F,@CF02503                                  02S0869 03166000
*               GPR01F=GPR01F|'80000000'X;/* DUMP/STEP/DUMPOPTS FLAG */ 03167000
         O     GPR01F,@CF02273                                  02S0870 03168000
*               SVC(13);            /* ISSUE ABEND SVC               */ 03169000
         SVC   13                                               02S0871 03170000
*               RESPECIFY                                       02S0872 03171000
*                (GPR01F) UNRESTRICTED;                         02S0872 03172000
*             END;                  /* ABEND(SETCMPCD) DUMP SYSTEM   */ 03173000
*             RFY                                               02S0874 03174000
*               ABNDCODE UNRSTD;                                02S0874 03175000
*           END;                                                02S0875 03176000
*         LASTELM=MCQEPTR;          /* THIS ONE BECOMES LAST ONE     */ 03177000
@RF00863 LR    LASTELM,MCQEPTR                                  02S0876 03178000
*         MCQEPTR=MCQEMCQE;         /* POINT TO NEXT MCQE ON CHAIN   */ 03179000
         L     MCQEPTR,MCQEMCQE(,MCQEPTR)                       02S0877 03180000
*       END;                        /* END OF MCQE CHAIN SEARCH      */ 03181000
@DE00862 LTR   MCQEPTR,MCQEPTR                                  02S0878 03182000
         BNZ   @DL00862                                         02S0878 03183000
*     END;                          /* END OF NON ZERO MCCE PATH     */ 03184000
*                                                               02S0880 03185000
*   /*****************************************************************/ 03186000
*   /*                                                               */ 03187000
*   /* MCQE IS TO BE OBTAINED FOR THIS APPLICATION                   */ 03188000
*   /*                                                               */ 03189000
*   /*****************************************************************/ 03190000
*                                                               02S0880 03191000
*   DO;                             /* GETMAIN (EC) LV(LENGTH(MCQE))    03192000
*                                      A(GETMADDR) SP(SQA)           */ 03193000
@RC00819 DS    0H                                               02S0881 03194000
*     RESPECIFY                                                 02S0881 03195000
*      (GPR01P) RESTRICTED;                                     02S0881 03196000
*     I004=I004&&I004;              /* INIT LIST                     */ 03197000
         XC    I004(10),I004                                    02S0882 03198000
*     I00404='20'X;                 /* TYPE                          */ 03199000
         MVI   I00404,X'20'                                     02S0883 03200000
*     I00401=LENGTH(MCQE);          /* LENGTH                        */ 03201000
         MVC   I00401(4),@CF02504                               02S0884 03202000
*     I00403=ADDR(GETMADDR);        /* ADDR OF ADDR LIST             */ 03203000
         LA    @08,GETMADDR                                     02S0885 03204000
         STCM  @08,7,I00403                                     02S0885 03205000
*     I00405=SQA;                   /* SUBPOOL VALUE                 */ 03206000
         MVI   I00405,X'F5'                                     02S0886 03207000
*     GPR01P=ADDR(I004);            /* REG1 POINTS TO LIST           */ 03208000
         LA    GPR01P,I004                                      02S0887 03209000
*     SVC(4);                       /* STANDARD-FORM OF GETMAIN      */ 03210000
         SVC   4                                                02S0888 03211000
*     RESPECIFY                                                 02S0889 03212000
*      (GPR01P) UNRESTRICTED;                                   02S0889 03213000
*   END;                            /* GETMAIN (EC) LV(LENGTH(MCQE))    03214000
*                                      A(GETMADDR) SP(SQA)           */ 03215000
*   IF RETCOD15^=0 THEN                                         02S0891 03216000
         LTR   RETCOD15,RETCOD15                                02S0891 03217000
         BZ    @RF00891                                         02S0891 03218000
*     DO;                           /* IF IT CANT BE OBTAINED,  02S0892 03219000
*                                      INDICATE THIS CONDITION WITH A   03220000
*                                      RETURN CODE                   */ 03221000
*       RTRNCODE=INSUFSTG;                                      02S0893 03222000
         MVC   RTRNCODE(4),@CF00101                             02S0893 03223000
*       RETURN;                     /* LEAVE SUBROUTINE              */ 03224000
         B     @EL00002                                         02S0894 03225000
*     END;                                                      02S0895 03226000
*                                                               02S0895 03227000
*   /*****************************************************************/ 03228000
*   /*                                                               */ 03229000
*   /* INITIALIZE THE MCQE FOR THIS APPLICATION                      */ 03230000
*   /*                                                               */ 03231000
*   /*****************************************************************/ 03232000
*                                                               02S0896 03233000
*   MCQEPTR=GETMADDR;               /* SAVE GOTTEN STORAGE ADDRESS   */ 03234000
@RF00891 L     MCQEPTR,GETMADDR                                 02S0896 03235000
*   RTRNMCQE=MCQEPTR;               /* SAVE MCQE ADDRESS TO RETURN IT   03236000
*                                      TO CALLER                     */ 03237000
         LR    RTRNMCQE,MCQEPTR                                 02S0897 03238000
*   MCQE(1:LENGTH(MCQE))=''B;       /* ZERO OUT ENTIRE MCQE          */ 03239000
         XC    MCQE(88,MCQEPTR),MCQE(MCQEPTR)                   02S0898 03240000
*   MCQEIDEN=MCQETAG;               /* FILL IN TABLE IDENTIFIER      */ 03241000
         MVC   MCQEIDEN(8,MCQEPTR),@CC00170                     02S0899 03242000
*   MCQENAME=PLISTNAM;              /* MOVE IN NAME FROM THE    02S0900 03243000
*                                      PARAMETER LIST                */ 03244000
         L     @08,PLISTAD                                      02S0900 03245000
         MVC   MCQENAME(8,MCQEPTR),PLISTNAM(@08)                02S0900 03246000
*   MCQEASCB=PSAAOLD;               /* MOVE IN THIS ASCB ADDRESS     */ 03247000
         L     @08,PSAAOLD                                      02S0901 03248000
         ST    @08,MCQEASCB(,MCQEPTR)                           02S0901 03249000
*   RFY                                                         02S0902 03250000
*     SRBPTR RSTD;                                              02S0902 03251000
*   SRBPTR=ADDR(MCQESRB);           /* SET UP TO INITIALIZE ITS SRB  */ 03252000
         LA    SRBPTR,MCQESRB(,MCQEPTR)                         02S0903 03253000
*   SRBEP=ADDR(AHLMCQP);            /* SET EP TO THE SRB ROUTINE        03254000
*                                      WHICH WILL POST THE      02S0904 03255000
*                                      TERMINATION ECB               */ 03256000
         LA    @06,AHLMCQP                                      02S0904 03257000
         ST    @06,SRBEP(,SRBPTR)                               02S0904 03258000
*   SRBPARM=ADDR(MCQE);             /* SET THE PARAMETER TO POINT TO    03259000
*                                      THE MCQE ITSELF               */ 03260000
         ST    MCQEPTR,SRBPARM(,SRBPTR)                         02S0905 03261000
*   SRBASCB=PSAAOLD;                /* LET IT RUN IN THIS MEMORY WHEN   03262000
*                                      IT GETS SCHEDULED.            */ 03263000
         ST    @08,SRBASCB(,SRBPTR)                             02S0906 03264000
*   RFY                                                         02S0907 03265000
*     SRBPTR UNRSTD;                                            02S0907 03266000
*   IF LASTELM=0 THEN                                           02S0908 03267000
         LTR   LASTELM,LASTELM                                  02S0908 03268000
         BNZ   @RF00908                                         02S0908 03269000
*     MCCEQEA=ADDR(MCQE);           /* IF THIS IS THE ONLY MCQE,        03270000
*                                      STORE ITS ADDRESS INTO MCCE   */ 03271000
         L     @08,MCHEADPT                                     02S0909 03272000
         L     @08,MCHCUR(,@08)                                 02S0909 03273000
         ST    MCQEPTR,MCCEQEA(,@08)                            02S0909 03274000
*   ELSE                                                        02S0910 03275000
*     LASTELM->MCQEMCQE=ADDR(MCQE); /* OTHERWISE, PLACE IT ON END OF    03276000
*                                      MCQE CHAIN                    */ 03277000
         B     @RC00908                                         02S0910 03278000
@RF00908 ST    MCQEPTR,MCQEMCQE(,LASTELM)                       02S0910 03279000
*   RETURN;                                                     02S0911 03280000
         B     @EL00002                                         02S0911 03281000
*   END GETMCQE;                                                02S0912 03282000
         B     @EL00002                                         02S0912 03283000
*INITMCCE:                                                      02S0913 03284000
*   PROC;                                                       02S0913 03285000
*                                                               02S0913 03286000
INITMCCE STM   @14,@12,12(@13)                                  02S0913 03287000
*   /*****************************************************************/ 03288000
*   /*                                                               */ 03289000
*   /* THIS SUBROUTINE IS CALLED TO INITIALIZE THE MCCE POINTED TO BY*/ 03290000
*   /* GETMADDR.                                                     */ 03291000
*   /*                                                               */ 03292000
*   /*****************************************************************/ 03293000
*                                                               02S0914 03294000
*   RFY                                                         02S0914 03295000
*     MCCE BASED(GETMADDR);                                     02S0914 03296000
*   MCCE(1:LENGTH(MCCE))=''B;       /* CLEAR MCCE                    */ 03297000
         L     @10,GETMADDR                                     02S0915 03298000
         XC    MCCE(88,@10),MCCE(@10)                           02S0915 03299000
*   MCCEIDEN=MCCETAG;               /* PLACE TABLE IDENTIFIER INTO      03300000
*                                      MCCE                          */ 03301000
         MVC   MCCEIDEN(8,@10),@CC00168                         02S0916 03302000
*   RFY                                                         02S0917 03303000
*     SRBPTR RSTD;                                              02S0917 03304000
*   SRBPTR=ADDR(MCCESRB);           /* SET UP TO INITIALIZE ITS SRB  */ 03305000
         LA    SRBPTR,MCCESRB(,@10)                             02S0918 03306000
*   SRBEP=ADDR(AHLTFREE);           /* POINT SRB TO THE TABLE FREEING   03307000
*                                      ROUTINE, AHLTFREE             */ 03308000
         LA    @08,AHLTFREE                                     02S0919 03309000
         ST    @08,SRBEP(,SRBPTR)                               02S0919 03310000
*   SRBPARM=ADDR(MCCE);             /* POINT PARAMETER TO MCCE ITSELF*/ 03311000
         ST    @10,SRBPARM(,SRBPTR)                             02S0920 03312000
*   SRBASCB=PSAAOLD;                /* LET IT RUN IN THIS MEMORY WHEN   03313000
*                                      SCHEDULED                     */ 03314000
         L     @08,PSAAOLD                                      02S0921 03315000
         ST    @08,SRBASCB(,SRBPTR)                             02S0921 03316000
*   RFY                                                         02S0922 03317000
*     SRBPTR UNRSTD;                                            02S0922 03318000
*   IF MCHCUR^=0 THEN                                           02S0923 03319000
         L     @08,MCHEADPT                                     02S0923 03320000
         L     @08,MCHCUR(,@08)                                 02S0923 03321000
         LTR   @08,@08                                          02S0923 03322000
         BZ    @RF00923                                         02S0923 03323000
*     DO;                           /* SUBROUTINE IS DONE IF THERE IS   03324000
*                                      NO CURRENT MCCE. IF THERE IS     03325000
*                                      ONE, THE MCQE, MCED AND MCCD     03326000
*                                      ADDRESSES ARE COPIED INTO THIS   03327000
*                                      NEW ONE                       */ 03328000
*       MCCEQEA=MCHCUR->MCCEQEA;    /* COPY MCQE ADDRESS FROM OLD    */ 03329000
         L     @06,MCCEQEA(,@08)                                02S0925 03330000
         ST    @06,MCCEQEA(,@10)                                02S0925 03331000
*       MCCEEDA=MCHCUR->MCCEEDA;    /* COPY EVENT DIRECTORY FROM OLD */ 03332000
         L     @06,MCCEEDA(,@08)                                02S0926 03333000
         ST    @06,MCCEEDA(,@10)                                02S0926 03334000
*       MCCECDA=MCHCUR->MCCECDA;    /* COPY CLASS DIRECTORY FROM OLD */ 03335000
         L     @06,MCCECDA(,@08)                                02S0927 03336000
         ST    @06,MCCECDA(,@10)                                02S0927 03337000
*       MCCEMCCE=MCHCUR;            /* SAVE THE OLD MCCE ADDRESS IN     03338000
*                                      THIS NEW MCCE FOR DIAGNOSTIC     03339000
*                                      PURPOSES.                     */ 03340000
         ST    @08,MCCEMCCE(,@10)                               02S0928 03341000
*     END;                                                      02S0929 03342000
*   END INITMCCE;                                               02S0930 03343000
@EL00003 DS    0H                                               02S0930 03344000
@EF00003 DS    0H                                               02S0930 03345000
@ER00003 LM    @14,@12,12(@13)                                  02S0930 03346000
         BR    @14                                              02S0930 03347000
*CR8MASK:                                                       02S0931 03348000
*   PROC;                                                       02S0931 03349000
*                                                               02S0931 03350000
CR8MASK  STM   @14,@12,12(@13)                                  02S0931 03351000
*   /*****************************************************************/ 03352000
*   /*                                                               */ 03353000
*   /* THIS SUBROUTINE IS CALLED TO UPDATE THE CONTROL REGISTER MASK */ 03354000
*   /* AT MCHCTL TO REFLECT THE CLASSES REPRESENTED BY THE MCQE      */ 03355000
*   /* POINTED TO BY MCQEPTR. FIRST, THE CLASS IN EACH MCEE OFF THIS */ 03356000
*   /* MCQE IS CONVERTED INTO AN INDEX INTO A MASK TABLE. THIS       */ 03357000
*   /* INDEXED MASK IS THEN ORED WITH MCHCTL, UPDATING IT TO REFLECT */ 03358000
*   /* THE CLASS. THE PROCESSING IS THEN REPEATED FOR EACH MCCLE     */ 03359000
*   /*                                                               */ 03360000
*   /*****************************************************************/ 03361000
*                                                               02S0932 03362000
*   ELEMAD=MCQEMCEE;                /* PICK UP THE FIRST MCEE ADDRESS*/ 03363000
         L     @10,MCQEMCEE(,MCQEPTR)                           02S0932 03364000
         ST    @10,ELEMAD                                       02S0932 03365000
*   RFY                                                         02S0933 03366000
*     MCEE BASED(ELEMAD);                                       02S0933 03367000
*   DO WHILE(ELEMAD^=0);            /* PROCESS ALL OF THE MCEES, IF     03368000
*                                      ANY EXIST                     */ 03369000
         B     @DE00934                                         02S0934 03370000
@DL00934 DS    0H                                               02S0935 03371000
*     INDEX=(MCEECLS/16)+1;         /* CREATE INDEX INTO MASK TABLE  */ 03372000
         L     @10,ELEMAD                                       02S0935 03373000
         SLR   INDEX,INDEX                                      02S0935 03374000
         IC    INDEX,MCEECLS(,@10)                              02S0935 03375000
         SRL   INDEX,4                                          02S0935 03376000
         AL    INDEX,@CF00145                                   02S0935 03377000
*     MCHCTL=MCHCTL|MASKTAB(INDEX); /* OR MASK TO TURN ON THIS CLASS    03378000
*                                      IF NOT ALREADY ON IN MCHCTL   */ 03379000
         L     @08,MCHEADPT                                     02S0936 03380000
         LR    @06,INDEX                                        02S0936 03381000
         ALR   @06,@06                                          02S0936 03382000
         LH    @06,MASKTAB-2(@06)                               02S0936 03383000
         N     @06,@CF02511                                     02S0936 03384000
         O     @06,MCHCTL(,@08)                                 02S0936 03385000
         ST    @06,MCHCTL(,@08)                                 02S0936 03386000
*     ELEMAD=MCEEMCQL;              /* POINT TO NEXT MCEE ON CHAIN   */ 03387000
         L     @10,MCEEMCQL(,@10)                               02S0937 03388000
         ST    @10,ELEMAD                                       02S0937 03389000
*   END;                            /* LOOP THRU ALL MCEES OFF MCQE  */ 03390000
*                                                               02S0938 03391000
@DE00934 L     @10,ELEMAD                                       02S0938 03392000
         LTR   @10,@10                                          02S0938 03393000
         BNZ   @DL00934                                         02S0938 03394000
*   /*****************************************************************/ 03395000
*   /*                                                               */ 03396000
*   /* NEXT PROCESS THE MCCLES                                       */ 03397000
*   /*                                                               */ 03398000
*   /*****************************************************************/ 03399000
*                                                               02S0939 03400000
*   ELEMAD=MCQEMCCL;                /* PICK UP FIRST MCCLE ADDRESS   */ 03401000
         L     @10,MCQEMCCL(,MCQEPTR)                           02S0939 03402000
         ST    @10,ELEMAD                                       02S0939 03403000
*   RFY                                                         02S0940 03404000
*     MCCLE BASED(ELEMAD);                                      02S0940 03405000
*   DO WHILE(ELEMAD^=0);            /* PROCESS ALL MCCLES, IF ANY    */ 03406000
         B     @DE00941                                         02S0941 03407000
@DL00941 DS    0H                                               02S0942 03408000
*     INDEX=(MCCLCLS/16)+1;         /* BUILD MASK TABLE INDEX        */ 03409000
         L     @10,ELEMAD                                       02S0942 03410000
         SLR   INDEX,INDEX                                      02S0942 03411000
         IC    INDEX,MCCLCLS(,@10)                              02S0942 03412000
         SRL   INDEX,4                                          02S0942 03413000
         AL    INDEX,@CF00145                                   02S0942 03414000
*     MCHCTL=MCHCTL|MASKTAB(INDEX); /* UPDATE MASK TO REFLECT THIS      03415000
*                                      CLASS                         */ 03416000
         L     @08,MCHEADPT                                     02S0943 03417000
         LR    @06,INDEX                                        02S0943 03418000
         ALR   @06,@06                                          02S0943 03419000
         LH    @06,MASKTAB-2(@06)                               02S0943 03420000
         N     @06,@CF02511                                     02S0943 03421000
         O     @06,MCHCTL(,@08)                                 02S0943 03422000
         ST    @06,MCHCTL(,@08)                                 02S0943 03423000
*     ELEMAD=MCCLMCQL;              /* POINT TO NEXT MCCLE OFF MCQE  */ 03424000
         L     @10,MCCLMCQL(,@10)                               02S0944 03425000
         ST    @10,ELEMAD                                       02S0944 03426000
*   END;                            /* LOOP THRU ALL MCCLES          */ 03427000
@DE00941 L     @10,ELEMAD                                       02S0945 03428000
         LTR   @10,@10                                          02S0945 03429000
         BNZ   @DL00941                                         02S0945 03430000
*   RETURN;                         /* RETURN FROM SUBROUTINE        */ 03431000
@EL00004 DS    0H                                               02S0946 03432000
@EF00004 DS    0H                                               02S0946 03433000
@ER00004 LM    @14,@12,12(@13)                                  02S0946 03434000
         BR    @14                                              02S0946 03435000
*   END CR8MASK;                                                02S0947 03436000
*CR8SET:                                                        02S0948 03437000
*   PROC;                                                       02S0948 03438000
*                                                               02S0948 03439000
CR8SET   STM   @14,@12,@SA00005                                 02S0948 03440000
*   /*****************************************************************/ 03441000
*   /*                                                               */ 03442000
*   /* THIS SUBROUTINE IS CALLED TO SET CONTROL REGISTER 8 ON ALL    */ 03443000
*   /* ALIVE CPUS TO THE VALUE CONTAINED IN MCHCTL.                  */ 03444000
*   /*                                                               */ 03445000
*   /*****************************************************************/ 03446000
*                                                               02S0949 03447000
*   IF CSDMP='0'B THEN                                          02S0949 03448000
         L     @10,CVTPTR                                       02S0949 03449000
         L     @10,CVTCSD(,@10)                                 02S0949 03450000
         TM    CSDMP(@10),B'10000000'                           02S0949 03451000
         BNZ   @RF00949                                         02S0949 03452000
*     DO;                                                       02S0950 03453000
*                                                               02S0950 03454000
*       /*************************************************************/ 03455000
*       /*                                                           */ 03456000
*       /* IF THIS IS UNIPROCESSOR MODE, PROCESS ONLY THE CPU ON     */ 03457000
*       /* WHICH WE ARE PROCESSING                                   */ 03458000
*       /*                                                           */ 03459000
*       /*************************************************************/ 03460000
*                                                               02S0951 03461000
*       MCRWSAPT=ADDR(MCRWSA);      /* POINT TO THIS CPUS MCRWSA     */ 03462000
         L     @10,PSALCCAV                                     02S0951 03463000
         L     @10,LCCACPUS(,@10)                               02S0951 03464000
         L     MCRWSAPT,WSACGTF(,@10)                           02S0951 03465000
*       CALL MCAWSART;              /* GET MCAWSA IF NEEDED          */ 03466000
         BAL   @14,MCAWSART                                     02S0952 03467000
*       RFY                                                     02S0953 03468000
*         MCHEADA RSTD;                                         02S0953 03469000
*       MCHEADA=ADDR(MCHEAD);       /* POINT TO MCHEAD TO FIND MASK  */ 03470000
         L     MCHEADA,MCHEADPT                                 02S0954 03471000
*       GEN(LCTL  CR8,CR8,MCHCTL(MCHEADA));/* LOAD THE CLASS MASK    */ 03472000
         LCTL  CR8,CR8,MCHCTL(MCHEADA)                                  03473000
*       RFY                                                     02S0956 03474000
*         MCHEADA UNRSTD;                                       02S0956 03475000
*     END;                                                      02S0957 03476000
*                                                               02S0958 03477000
*   /*****************************************************************/ 03478000
*   /*                                                               */ 03479000
*   /* MP MODE - SET UP TO FIND ALIVE CPUS                           */ 03480000
*   /*                                                               */ 03481000
*   /*****************************************************************/ 03482000
*                                                               02S0958 03483000
*   ELSE                                                        02S0958 03484000
*     DO;                                                       02S0958 03485000
         B     @RC00949                                         02S0958 03486000
@RF00949 DS    0H                                               02S0959 03487000
*       PCCAVTP=CVTPCCAT;           /* POINT TO FIRST ENTRY IN PCCAVT*/ 03488000
         L     @10,CVTPTR                                       02S0959 03489000
         L     @08,CVTPCCAT(,@10)                               02S0959 03490000
         ST    @08,PCCAVTP                                      02S0959 03491000
*       LCCAVTP=CVTLCCAT;           /* POINT TO FIRST ENTRY IN LCCAVT*/ 03492000
         L     @08,CVTLCCAT(,@10)                               02S0960 03493000
         ST    @08,LCCAVTP                                      02S0960 03494000
*       RFY                                                     02S0961 03495000
*         CPUMSK RSTD;                                          02S0961 03496000
*       CPUMSK=CSDCPUAL;            /* LOAD THE ALIVE-CPU MASK INTO A   03497000
*                                      REGISTER                      */ 03498000
         L     @10,CVTCSD(,@10)                                 02S0962 03499000
         LH    CPUMSK,CSDCPUAL(,@10)                            02S0962 03500000
         N     CPUMSK,@CF02511                                  02S0962 03501000
*       GEN(SLL CPUMSK,16);         /* SHIFT TO CORRECT PLACE        */ 03502000
         SLL CPUMSK,16                                                  03503000
*       DO WHILE(CPUMSK^=0);        /* PROCESS WHILE THERE ARE  02S0964 03504000
*                                      BITS(S) REMAINING IN THE 02S0964 03505000
*                                      REGISTER, INDICATING ALIVE       03506000
*                                      CPUS                          */ 03507000
         B     @DE00964                                         02S0964 03508000
@DL00964 DS    0H                                               02S0965 03509000
*         GEN(ALR   CPUMSK,CPUMSK); /* THIS INSTRUCTION WILL SHIFT      03510000
*                                      REGISTER LEFT ONE BIT, AND       03511000
*                                      CAUSE OVERFLOW IF THE HI-ORDER   03512000
*                                      BIT WAS ON.                   */ 03513000
*                                                               02S0965 03514000
         ALR   CPUMSK,CPUMSK                                            03515000
*         /***********************************************************/ 03516000
*         /*                                                         */ 03517000
*         /* IF A BIT HAS BEEN CARRIED, THIS CPU IS ALIVE. PCCAVTP   */ 03518000
*         /* AND LCCAVTP POINT TO THE CORRECT ENTRIES IN THE PCCAVT  */ 03519000
*         /* AND LCCAVT FOR THE CPU REPRESENTED BY THE BIT THAT WAS  */ 03520000
*         /* CARRIED. IF A BIT HAS NOT BEEN CARRIED, CONTROL IS      */ 03521000
*         /* PASSED TO LABEL AHL8SET1 TO PROCESS THE NEXT CPU BIT.   */ 03522000
*         /*                                                         */ 03523000
*         /***********************************************************/ 03524000
*                                                               02S0966 03525000
*         BC(12,AHL8SET1);                                      02S0966 03526000
*                                                               02S0966 03527000
         BC    12,AHL8SET1                                      02S0966 03528000
*         /***********************************************************/ 03529000
*         /*                                                         */ 03530000
*         /* AN ALIVE CPU HAS BEEN FOUND                             */ 03531000
*         /*                                                         */ 03532000
*         /***********************************************************/ 03533000
*                                                               02S0967 03534000
*         PCCAPTR=PVTSLOT;          /* PICK UP ADDRESS OF PCCA FOR      03535000
*                                      THAT CPU                      */ 03536000
         L     @10,PCCAVTP                                      02S0967 03537000
         L     @10,PVTSLOT(,@10)                                02S0967 03538000
         ST    @10,PCCAPTR                                      02S0967 03539000
*         LCCAPTR=LVTSLOT;          /* PICK UP ADDRESS OF LCCA FOR      03540000
*                                      THAT CPU                      */ 03541000
         L     @10,LCCAVTP                                      02S0968 03542000
         L     LCCAPTR,LVTSLOT(,@10)                            02S0968 03543000
*         RFY                                                   02S0969 03544000
*           LCCA BASED(LCCAPTR);                                02S0969 03545000
*         MCRWSAPT=ADDR(MCRWSA);    /* FIND MCRWSA ON THAT CPU       */ 03546000
         L     @10,LCCACPUS(,LCCAPTR)                           02S0970 03547000
         L     MCRWSAPT,WSACGTF(,@10)                           02S0970 03548000
*         CALL MCAWSART;            /* GO GET MCAWSA IF NEEDED.      */ 03549000
         BAL   @14,MCAWSART                                     02S0971 03550000
*         RFY                                                   02S0972 03551000
*           LCCA BASED(PSALCCAV);                               02S0972 03552000
*         RFY                                                   02S0973 03553000
*           PARMPTR RSTD;                                       02S0973 03554000
*         PARMPTR=PCCAPTR;          /* POINT TO PCCA FOR THAT CPU    */ 03555000
         L     PARMPTR,PCCAPTR                                  02S0974 03556000
*         GEN(RPSGNL GTFCRM,CPU=(1));/* SIGNAL THAT CPU              */ 03557000
         RPSGNL GTFCRM,CPU=(1)                                          03558000
*         IF RETCOD15^=0 THEN                                   02S0976 03559000
         SLR   @14,@14                                          02S0976 03560000
         CR    RETCOD15,@14                                     02S0976 03561000
         BE    @RF00976                                         02S0976 03562000
*           DO;                                                 02S0977 03563000
*                                                               02S0977 03564000
*             /*******************************************************/ 03565000
*             /*                                                     */ 03566000
*             /* IF THE RPSGNL FAILS, FREE THE MCAWSA IF IT WAS      */ 03567000
*             /* GOTTEN, AND ISSUE AN ERROR MESSAGE                  */ 03568000
*             /*                                                     */ 03569000
*             /*******************************************************/ 03570000
*                                                               02S0978 03571000
*             IF MCAGOTN='1'B THEN                              02S0978 03572000
         TM    MCAGOTN,B'01000000'                              02S0978 03573000
         BNO   @RF00978                                         02S0978 03574000
*               DO;                                             02S0979 03575000
*                 GETMADDR=MCRWSAPT->MCRMCA;/* FIND THE MCAWSA TO       03576000
*                                      FREE                          */ 03577000
         L     @10,MCRMCA(,MCRWSAPT)                            02S0980 03578000
         ST    @10,GETMADDR                                     02S0980 03579000
*                 MCRWSAPT->MCRMCA=0;/* CLEAR THE POINTER TO IT      */ 03580000
         ST    @14,MCRMCA(,MCRWSAPT)                            02S0981 03581000
*                 DO;               /* FREEMAIN (E)             02S0982 03582000
*                                      LV(LENGTH(MCAWSA)) A(GETMADDR)   03583000
*                                      SP(245)                       */ 03584000
*                   RESPECIFY                                   02S0983 03585000
*                    (GPR01P) RESTRICTED;                       02S0983 03586000
*                   I005=I005&&I005;/* INIT LIST                     */ 03587000
         XC    I005(10),I005                                    02S0984 03588000
*                   I00505='00'X;   /* SET TYPE                      */ 03589000
         MVI   I00505,X'00'                                     02S0985 03590000
*                   I00502=LENGTH(MCAWSA);/* LENGTH                  */ 03591000
         MVC   I00502(3),@CF02194+1                             02S0986 03592000
*                   I00504=ADDR(GETMADDR);/* ADDR OF ADDR LIST       */ 03593000
         LA    @10,GETMADDR                                     02S0987 03594000
         STCM  @10,7,I00504                                     02S0987 03595000
*                   I00506=245;     /* SUBPOOL VALUE                 */ 03596000
         MVI   I00506,X'F5'                                     02S0988 03597000
*                   GPR01P=ADDR(I005);/* REG1 POINTS TO LIST         */ 03598000
         LA    GPR01P,I005                                      02S0989 03599000
*                   SVC(5);         /* STANDARD-FORM OF GETMAIN      */ 03600000
         SVC   5                                                02S0990 03601000
*                   RESPECIFY                                   02S0991 03602000
*                    (GPR01P) UNRESTRICTED;                     02S0991 03603000
*                 END;              /* FREEMAIN (E)             02S0992 03604000
*                                      LV(LENGTH(MCAWSA)) A(GETMADDR)   03605000
*                                                             SP(245)*/ 03606000
*               END;                                            02S0993 03607000
*AHLRC20:                                                       02S0994 03608000
*             RTRNCODE=CPUNOT;      /* INDICATE THAT ONE OR MORE CPUS   03609000
*                                      WOULD NOT INITIALIZE          */ 03610000
@RF00978 DS    0H                                               02S0994 03611000
AHLRC20  MVC   RTRNCODE(4),@CF00103                             02S0994 03612000
*             UNPK(MSGCPUID,CPUADDR);/* PLACE CPU ADDRESS INTO  02S0995 03613000
*                                      MESSAGE                       */ 03614000
         L     @10,@CA00135                                     02S0995 03615000
         L     @08,PCCAPTR                                      02S0995 03616000
         UNPK  MSGCPUID-AHL133(4,@10),CPUADDR(3,@08)            02S0995 03617000
*             XTRABYTE=' ';         /* CLEAR EXTRA UNPACKED BYTE     */ 03618000
         MVI   XTRABYTE-AHL133(@10),C' '                        02S0996 03619000
*             MSGNAME=PLISTNAM;     /* MOVE APPLICATION NAME TO 02S0997 03620000
*                                      MESSAGE                       */ 03621000
         L     @08,PLISTAD                                      02S0997 03622000
         MVC   MSGNAME-AHL133(8,@10),PLISTNAM(@08)              02S0997 03623000
*             DO;                   /* WTOP MF(E,AHL133)             */ 03624000
*               RFY                                             02S0999 03625000
*                 GPR01P RSTD;      /* RESTRICT REG 1                */ 03626000
*               GPR01P=ADDR(AHL133);/* ADDRESS CONTROL PROGRAM LIST  */ 03627000
         LR    GPR01P,@10                                       02S1000 03628000
*               SVC(35);            /* ISSUE WTO SVC                 */ 03629000
         SVC   35                                               02S1001 03630000
*               RFY                                             02S1002 03631000
*                 GPR01P UNRSTD;    /* RELEASE REG 1                 */ 03632000
*             END;                  /* WTOP MF(E,AHL133) ISSUE WTO   */ 03633000
*             IF CSDMP='0'B THEN                                02S1004 03634000
         L     @10,CVTPTR                                       02S1004 03635000
         L     @10,CVTCSD(,@10)                                 02S1004 03636000
         TM    CSDMP(@10),B'10000000'                           02S1004 03637000
         BZ    @RT01004                                         02S1004 03638000
*               RETURN;             /* DONE IF UNIPROCESSOR MODE     */ 03639000
*           END;                    /* END OF BAD RPSGNL PATH        */ 03640000
*         MCAGOTN='0'B;             /* RESET FLAG FOR NEXT TIME THRU    03641000
*                                      LOOP                          */ 03642000
@RF00976 NI    MCAGOTN,B'10111111'                              02S1007 03643000
*AHL8SET1:                                                      02S1008 03644000
*         PCCAVTP=PCCAVTP+LENGTH(PVTSLOT);/* UPDATE TABLE POINTER TO    03645000
*                                      NEXT CPU SLOT                 */ 03646000
AHL8SET1 LA    @10,4                                            02S1008 03647000
         L     @08,PCCAVTP                                      02S1008 03648000
         ALR   @08,@10                                          02S1008 03649000
         ST    @08,PCCAVTP                                      02S1008 03650000
*         LCCAVTP=LCCAVTP+LENGTH(LVTSLOT);/* SAME FOR LCCAVT         */ 03651000
         AL    @10,LCCAVTP                                      02S1009 03652000
         ST    @10,LCCAVTP                                      02S1009 03653000
*       END;                        /* LOOP UNTIL ALL ALIVE CPUS ARE    03654000
*                                      PROCESSED                     */ 03655000
@DE00964 LTR   CPUMSK,CPUMSK                                    02S1010 03656000
         BNZ   @DL00964                                         02S1010 03657000
*     END;                          /* END OF MP PROCESSING          */ 03658000
*   RFY                                                         02S1012 03659000
*     CPUMSK UNRSTD;                                            02S1012 03660000
*   END CR8SET;                                                 02S1013 03661000
@EL00005 DS    0H                                               02S1013 03662000
@EF00005 DS    0H                                               02S1013 03663000
@ER00005 LM    @14,@12,@SA00005                                 02S1013 03664000
         BR    @14                                              02S1013 03665000
*MCAWSART:                                                      02S1014 03666000
*   PROC;                                                       02S1014 03667000
*                                                               02S1014 03668000
MCAWSART STM   @14,@12,12(@13)                                  02S1014 03669000
*   /*****************************************************************/ 03670000
*   /*                                                               */ 03671000
*   /* THIS SUBROUTINE IS CALLED TO GET OR FREE THE MCAWSA ASSOCIATED*/ 03672000
*   /* WITH THE MCRWSA POINTED TO BY MCRWSAPT. IF THE CLASS MASK IN  */ 03673000
*   /* MCHCTL IS ZERO, THE MCAWSA IS TO BE FREED IF IT EXISTS.       */ 03674000
*   /* OTHERWISE, THE MCAWSA IS TO BE GOTTEN IF IT DOES NOT EXIST    */ 03675000
*   /*                                                               */ 03676000
*   /*****************************************************************/ 03677000
*                                                               02S1015 03678000
*   RFY                                                         02S1015 03679000
*     MCRWSA BASED(MCRWSAPT);                                   02S1015 03680000
*   IF MCHCTL=0 THEN                                            02S1016 03681000
         SLR   @10,@10                                          02S1016 03682000
         L     @08,MCHEADPT                                     02S1016 03683000
         C     @10,MCHCTL(,@08)                                 02S1016 03684000
         BNE   @RF01016                                         02S1016 03685000
*     IF MCRMCA^=0 THEN                                         02S1017 03686000
         L     @08,MCRMCA(,MCRWSAPT)                            02S1017 03687000
         CR    @08,@10                                          02S1017 03688000
         BE    @RF01017                                         02S1017 03689000
*       DO;                                                     02S1018 03690000
*                                                               02S1018 03691000
*         /***********************************************************/ 03692000
*         /*                                                         */ 03693000
*         /* FREE MCAWSA IF IT EXISTS                                */ 03694000
*         /*                                                         */ 03695000
*         /***********************************************************/ 03696000
*                                                               02S1019 03697000
*         GETMADDR=MCRMCA;          /* SAVE ITS ADDRESS              */ 03698000
         ST    @08,GETMADDR                                     02S1019 03699000
*         MCRMCA=0;                 /* ZERO OUT THE POINTER TO IT    */ 03700000
         ST    @10,MCRMCA(,MCRWSAPT)                            02S1020 03701000
*         DO;                       /* FREEMAIN (E)             02S1021 03702000
*                                      LV(LENGTH(MCAWSA)) A(GETMADDR)   03703000
*                                      SP(SQA)                       */ 03704000
*           RESPECIFY                                           02S1022 03705000
*            (GPR01P) RESTRICTED;                               02S1022 03706000
*           I005=I005&&I005;        /* INIT LIST                     */ 03707000
         XC    I005(10),I005                                    02S1023 03708000
*           I00505='00'X;           /* SET TYPE                      */ 03709000
         MVI   I00505,X'00'                                     02S1024 03710000
*           I00502=LENGTH(MCAWSA);  /* LENGTH                        */ 03711000
         MVC   I00502(3),@CF02194+1                             02S1025 03712000
*           I00504=ADDR(GETMADDR);  /* ADDR OF ADDR LIST             */ 03713000
         LA    @10,GETMADDR                                     02S1026 03714000
         STCM  @10,7,I00504                                     02S1026 03715000
*           I00506=SQA;             /* SUBPOOL VALUE                 */ 03716000
         MVI   I00506,X'F5'                                     02S1027 03717000
*           GPR01P=ADDR(I005);      /* REG1 POINTS TO LIST           */ 03718000
         LA    GPR01P,I005                                      02S1028 03719000
*           SVC(5);                 /* STANDARD-FORM OF GETMAIN      */ 03720000
         SVC   5                                                02S1029 03721000
*           RESPECIFY                                           02S1030 03722000
*            (GPR01P) UNRESTRICTED;                             02S1030 03723000
*         END;                      /* FREEMAIN (E)             02S1031 03724000
*                                      LV(LENGTH(MCAWSA)) A(GETMADDR)   03725000
*                                                             SP(SQA)*/ 03726000
*       END;                                                    02S1032 03727000
*     ELSE                                                      02S1033 03728000
*       ;                                                       02S1033 03729000
@RF01017 DS    0H                                               02S1034 03730000
*                                                               02S1034 03731000
*   /*****************************************************************/ 03732000
*   /*                                                               */ 03733000
*   /* MCAWSA TO BE GOTTEN IF ONE DOES NOT ALREADY EXIST             */ 03734000
*   /*                                                               */ 03735000
*   /*****************************************************************/ 03736000
*                                                               02S1034 03737000
*   ELSE                                                        02S1034 03738000
*     IF MCRMCA=0 THEN                                          02S1034 03739000
         B     @RC01016                                         02S1034 03740000
@RF01016 L     @10,MCRMCA(,MCRWSAPT)                            02S1034 03741000
         LTR   @10,@10                                          02S1034 03742000
         BNZ   @RF01034                                         02S1034 03743000
*       DO;                         /* IF THE MCAWSA DOES NOT EXIST,    03744000
*                                      GET ONE                       */ 03745000
*         DO;                       /* GETMAIN (EC)             02S1036 03746000
*                                      LV(LENGTH(MCAWSA)) A(GETMADDR)   03747000
*                                                             SP(SQA)*/ 03748000
*           RESPECIFY                                           02S1037 03749000
*            (GPR01P) RESTRICTED;                               02S1037 03750000
*           I004=I004&&I004;        /* INIT LIST                     */ 03751000
         XC    I004(10),I004                                    02S1038 03752000
*           I00404='20'X;           /* TYPE                          */ 03753000
         MVI   I00404,X'20'                                     02S1039 03754000
*           I00401=LENGTH(MCAWSA);  /* LENGTH                        */ 03755000
         MVC   I00401(4),@CF02194                               02S1040 03756000
*           I00403=ADDR(GETMADDR);  /* ADDR OF ADDR LIST             */ 03757000
         LA    @10,GETMADDR                                     02S1041 03758000
         STCM  @10,7,I00403                                     02S1041 03759000
*           I00405=SQA;             /* SUBPOOL VALUE                 */ 03760000
         MVI   I00405,X'F5'                                     02S1042 03761000
*           GPR01P=ADDR(I004);      /* REG1 POINTS TO LIST           */ 03762000
         LA    GPR01P,I004                                      02S1043 03763000
*           SVC(4);                 /* STANDARD-FORM OF GETMAIN      */ 03764000
         SVC   4                                                02S1044 03765000
*           RESPECIFY                                           02S1045 03766000
*            (GPR01P) UNRESTRICTED;                             02S1045 03767000
*         END;                      /* GETMAIN (EC)             02S1046 03768000
*                                      LV(LENGTH(MCAWSA)) A(GETMADDR)   03769000
*                                      SP(SQA)                       */ 03770000
*         IF RETCOD15^=0 THEN                                   02S1047 03771000
         LTR   RETCOD15,RETCOD15                                02S1047 03772000
         BZ    @RF01047                                         02S1047 03773000
*           DO;                     /* IF THE STORAGE CANNOT BE 02S1048 03774000
*                                      OBTAINED, RETURN IS MADE TO      03775000
*                                      AHLRC20 TO ISSUE AN ERROR        03776000
*                                      MESSAGE                       */ 03777000
*             PCCAPTR=PSAPCCAV;     /* POINT TO THIS PCCA            */ 03778000
         L     @10,PSAPCCAV                                     02S1049 03779000
         ST    @10,PCCAPTR                                      02S1049 03780000
*             RETURN TO AHLRC20;                                02S1050 03781000
         LA    @14,AHLRC20                                      02S1050 03782000
         LM    @15,@12,16(@13)                                  02S1050 03783000
         BR    @14                                              02S1050 03784000
*           END;                                                02S1051 03785000
*         MCRMCA=GETMADDR;          /* SAVE GOTTEN STORAGE ADDRESS   */ 03786000
@RF01047 L     @10,GETMADDR                                     02S1052 03787000
         ST    @10,MCRMCA(,MCRWSAPT)                            02S1052 03788000
*         GETMADDR->MCAMCR=MCRWSAPT;/* BACK CHAIN THE MCAWSA TO THE     03789000
*                                      MCRWSA                        */ 03790000
         ST    MCRWSAPT,MCAMCR(,@10)                            02S1053 03791000
*         MCAGOTN='1'B;             /* INDICATE THAT THE MCAWSA WAS     03792000
*                                      GOTTEN ON THIS CALL, SO IT CAN   03793000
*                                      BE FREED IF THE CONTROL  02S1054 03794000
*                                      REGISTER CANNOT BE SET        */ 03795000
         OI    MCAGOTN,B'01000000'                              02S1054 03796000
*       END;                                                    02S1055 03797000
*   END MCAWSART;                                               02S1056 03798000
@EL00006 DS    0H                                               02S1056 03799000
@EF00006 DS    0H                                               02S1056 03800000
@ER00006 LM    @14,@12,12(@13)                                  02S1056 03801000
         BR    @14                                              02S1056 03802000
*CSDMCCE:                                                       02S1057 03803000
*   PROC;                                                       02S1057 03804000
*                                                               02S1057 03805000
CSDMCCE  STM   @14,@12,@SA00007                                 02S1057 03806000
*   /*****************************************************************/ 03807000
*   /*                                                               */ 03808000
*   /* THIS SUBROUTINE IS CALLED TO PLACE THE MCCE POINTED TO BY     */ 03809000
*   /* NEWMCCE INTO THE MCHEAD, AND ZERO THE USE COUNT TO INDICATE   */ 03810000
*   /* THAT A NEW SET OF TABLES IS IN EFFECT. THIS IS DONE VIA       */ 03811000
*   /* COMPARE AND SWAP LOGIC. ONCE IT HAS BEEN DONE, IT ADDS THE OLD*/ 03812000
*   /* MCHEAD USE COUNT TO THE USE COUNT IN THE REPLACED MCCE, AND   */ 03813000
*   /* SCHEDULES THE SRB IN THE OLD MCCE IF THE RESULT OF THIS       */ 03814000
*   /* ADDITION IS ZERO                                              */ 03815000
*   /*                                                               */ 03816000
*   /*****************************************************************/ 03817000
*                                                               02S1058 03818000
*   NEWCOUNT=0;                     /* INITIALIZE THE USE COUNT TO      03819000
*                                      ZERO, TO REPLACE THE CURRENT     03820000
*                                      ONE IN THE MCHEAD             */ 03821000
         SLR   @10,@10                                          02S1058 03822000
         ST    @10,NEWCOUNT                                     02S1058 03823000
*   OLDMCCE=MCHCUR;                 /* LOAD THE OLD MCCE ADDRESS FROM   03824000
*                                      THE MCHEAD                    */ 03825000
         L     @10,MCHEADPT                                     02S1059 03826000
         L     @08,MCHCUR(,@10)                                 02S1059 03827000
         ST    @08,OLDMCCE                                      02S1059 03828000
*   OLDCOUNT=MCHCNT;                /* LOAD THE CURRENT USE COUNT       03829000
*                                      ALSO                          */ 03830000
         L     @10,MCHCNT(,@10)                                 02S1060 03831000
         ST    @10,OLDCOUNT                                     02S1060 03832000
*AHLCSD01:                                                      02S1061 03833000
*   CDS(OCDS,NCDS,ADDRCNT);         /* PLACE THE NEW MCCE ADDRESS AND   03834000
*                                      THE ZERO USE COUNT INTO THE      03835000
*                                      MCHEAD                        */ 03836000
AHLCSD01 LM    @02,@03,OCDS                                     02S1061 03837000
         LM    @04,@05,NCDS                                     02S1061 03838000
         L     @10,MCHEADPT                                     02S1061 03839000
         CDS   @02,@04,ADDRCNT(@10)                             02S1061 03840000
         BZ    @BC01061                                         02S1061 03841000
         STM   @02,@03,OCDS                                     02S1061 03842000
@BC01061 DS    0H                                               02S1062 03843000
*   BC(7,AHLCSD01);                 /* IF THE COUNT CHANGES, REDO THE   03844000
*                                      CDS                           */ 03845000
         BC    7,AHLCSD01                                       02S1062 03846000
*   RFY                                                         02S1063 03847000
*     MCCE BASED(OLDMCCE);          /* OLDMCCE NOW CONTAINS THE OLD     03848000
*                                      MCCE ADDRESS                  */ 03849000
*   OMCCECNT=MCCECNT;               /* PICK UP THE COUNT FROM THE OLD   03850000
*                                      MCCE                          */ 03851000
         L     @10,OLDMCCE                                      02S1064 03852000
         L     OMCCECNT,MCCECNT(,@10)                           02S1064 03853000
*AHLCSD02:                                                      02S1065 03854000
*   NEWCOUNT=OMCCECNT+OLDCOUNT;     /* ADD THE OLD MCCE USE COUNT TO    03855000
*                                      THE USE COUNT FROM THE MCHEAD    03856000
*                                      (IN OLDCOUNT)                 */ 03857000
AHLCSD02 LR    @10,OMCCECNT                                     02S1065 03858000
         AL    @10,OLDCOUNT                                     02S1065 03859000
         ST    @10,NEWCOUNT                                     02S1065 03860000
*   CS(OMCCECNT,NEWCOUNT,MCCECNT);  /* PLACE THE SUM INTO THE OLD       03861000
*                                      MCCE                          */ 03862000
         L     @08,OLDMCCE                                      02S1066 03863000
         CS    OMCCECNT,@10,MCCECNT(@08)                        02S1066 03864000
*   BC(7,AHLCSD02);                 /* IF THE OLD MCCE USE COUNT        03865000
*                                      CHANGED, REDO ARITHMETIC TO      03866000
*                                      ESTABLISH THE CORRECT COUNT   */ 03867000
         BC    7,AHLCSD02                                       02S1067 03868000
*   IF NEWCOUNT=0 THEN                                          02S1068 03869000
         L     @10,NEWCOUNT                                     02S1068 03870000
         LTR   @10,@10                                          02S1068 03871000
         BNZ   @RF01068                                         02S1068 03872000
*     DO;                           /* IF THE STORED COUNT WAS ZERO,    03873000
*                                      ALL ROUTINES ARE DONE USING      03874000
*                                      THE TABLES DESCRIBED BY THE      03875000
*                                      OLD MCCE. SCHEDULE THE SRB IN    03876000
*                                      THE OLD MCCE TO CAUSE THE        03877000
*                                      FREEING OF THE TABLES         */ 03878000
*       RFY                                                     02S1070 03879000
*         SRBPTR RSTD;                                          02S1070 03880000
*       SRBPTR=ADDR(MCCESRB);       /* POINT TO THE SRB              */ 03881000
         L     SRBPTR,OLDMCCE                                   02S1071 03882000
         LA    SRBPTR,MCCESRB(,SRBPTR)                          02S1071 03883000
*       GEN(SCHEDULE SRB=(1));      /* SCHEDULE THE SRB              */ 03884000
         SCHEDULE SRB=(1)                                               03885000
*       RFY                                                     02S1073 03886000
*         SRBPTR UNRSTD;                                        02S1073 03887000
*     END;                                                      02S1074 03888000
*   END CSDMCCE;                                                02S1075 03889000
@EL00007 DS    0H                                               02S1075 03890000
@EF00007 DS    0H                                               02S1075 03891000
@ER00007 LM    @14,@12,@SA00007                                 02S1075 03892000
         BR    @14                                              02S1075 03893000
*FREEELMS:                                                      02S1076 03894000
*   PROC;                                                       02S1076 03895000
*                                                               02S1076 03896000
FREEELMS STM   @14,@12,12(@13)                                  02S1076 03897000
*   /*****************************************************************/ 03898000
*   /*                                                               */ 03899000
*   /* THIS SUBROUTINE IS CALLED TO FREE THE MCEES OR MCCLES ON THE  */ 03900000
*   /* CHAIN HEADED BY THE ELEMENT POINTED TO BY ELEMAD. IT OPERATES */ 03901000
*   /* ON BOTH MCEES AND MCCLES SINCE THEIR FORMATS ARE IDENTICAL    */ 03902000
*   /*                                                               */ 03903000
*   /*****************************************************************/ 03904000
*                                                               02S1077 03905000
*   DO WHILE(ELEMAD^=0);            /* LOOP THRU ALL MCEE/MCCLES     */ 03906000
         B     @DE01077                                         02S1077 03907000
@DL01077 DS    0H                                               02S1078 03908000
*     NEXTELMT=ELEMAD->MCEEMCQL;    /* SAVE THE NEXT ELEMENT ADDRESS */ 03909000
         L     @10,ELEMAD                                       02S1078 03910000
         L     NEXTELMT,MCEEMCQL(,@10)                          02S1078 03911000
*     DO;                           /* FREEMAIN (E) LV(LENGTH(MCEE))    03912000
*                                      A(ELEMAD) SP(SQA)             */ 03913000
*       RESPECIFY                                               02S1080 03914000
*        (GPR01P) RESTRICTED;                                   02S1080 03915000
*       I005=I005&&I005;            /* INIT LIST                     */ 03916000
         XC    I005(10),I005                                    02S1081 03917000
*       I00505='00'X;               /* SET TYPE                      */ 03918000
         MVI   I00505,X'00'                                     02S1082 03919000
*       I00502=LENGTH(MCEE);        /* LENGTH                        */ 03920000
         MVC   I00502(3),@CF00106+1                             02S1083 03921000
*       I00504=ADDR(ELEMAD);        /* ADDR OF ADDR LIST             */ 03922000
         LA    @10,ELEMAD                                       02S1084 03923000
         STCM  @10,7,I00504                                     02S1084 03924000
*       I00506=SQA;                 /* SUBPOOL VALUE                 */ 03925000
         MVI   I00506,X'F5'                                     02S1085 03926000
*       GPR01P=ADDR(I005);          /* REG1 POINTS TO LIST           */ 03927000
         LA    GPR01P,I005                                      02S1086 03928000
*       SVC(5);                     /* STANDARD-FORM OF GETMAIN      */ 03929000
         SVC   5                                                02S1087 03930000
*       RESPECIFY                                               02S1088 03931000
*        (GPR01P) UNRESTRICTED;                                 02S1088 03932000
*     END;                          /* FREEMAIN (E) LV(LENGTH(MCEE))    03933000
*                                      A(ELEMAD) SP(SQA)             */ 03934000
*     ELEMAD=NEXTELMT;              /* POINT TO NEXT ONE TO BE FREED */ 03935000
         ST    NEXTELMT,ELEMAD                                  02S1090 03936000
*   END;                            /* LOOP UNTIL ZERO CHAIN IS 02S1091 03937000
*                                      NOTICED                       */ 03938000
@DE01077 L     @10,ELEMAD                                       02S1091 03939000
         LTR   @10,@10                                          02S1091 03940000
         BNZ   @DL01077                                         02S1091 03941000
*   END FREEELMS;                                               02S1092 03942000
@EL00008 DS    0H                                               02S1092 03943000
@EF00008 DS    0H                                               02S1092 03944000
@ER00008 LM    @14,@12,12(@13)                                  02S1092 03945000
         BR    @14                                              02S1092 03946000
@PB00008 DS    0H                                               02S1093 03947000
*                                                               01S1093 03948000
*   /*****************************************************************/ 03949000
*   /*                                                               */ 03950000
*   /* SRB ROUTINES                                                  */ 03951000
*   /*                                                               */ 03952000
*   /*****************************************************************/ 03953000
*                                                               01S1093 03954000
*AHLTFREE:                                                      02S1093 03955000
*                                                               02S1093 03956000
*   /*****************************************************************/ 03957000
*   /*                                                               */ 03958000
*   /* THIS SRB ROUTINE RECEIVES CONTROL TO FREE THE OBSOLETE TABLES */ 03959000
*   /* DESCRIBED BY THE MCCE WHOSE ADDRESS IS RECEIVED AS A          */ 03960000
*   /* PARAMETER. FIRST, ERROR RECOVERY IS ESTABLISHED VIA SETFRR, TO*/ 03961000
*   /* ENSURE THAT THE MCCEECB GETS POSTED, IF INDICATED, TO SIGNAL  */ 03962000
*   /* THE COMPLETION OF THE TABLE FREEING PROCESS                   */ 03963000
*   /*                                                               */ 03964000
*   /*****************************************************************/ 03965000
*                                                               02S1093 03966000
*   GENERATE;                                                   02S1093 03967000
AHLTFREE DS    0H                                               02S1093 03968000
         BALR   BASEREG,0                                               03969000
         USING  *,BASEREG                                               03970000
         LA    FRRLIST,AHLTFFRR                     @YM01899            03971000
         SETFRR A,FRRAD=(FRRLIST),WRKREGS=(2,3),PARMAD=(FRRLIST)        03972000
*   RFY                                                         02S1094 03973000
*    (SRBPARM2,                                                 02S1094 03974000
*     FRRLIST,                                                  02S1094 03975000
*     BASEREG,                                                  02S1094 03976000
*     RETURNAD) RSTD;                                           02S1094 03977000
*   SRBPARM2=SRBPARM1;              /* SAVE MCCE ADDRESS IN SAFE        03978000
*                                      REGISTER                      */ 03979000
         LR    SRBPARM2,SRBPARM1                                02S1095 03980000
*   RFY                                                         02S1096 03981000
*     MCCE BASED(SRBPARM2);                                     02S1096 03982000
*                                                               02S1096 03983000
*   /*****************************************************************/ 03984000
*   /*                                                               */ 03985000
*   /* INITIALIZE FRR PARAMETER LIST                                 */ 03986000
*   /*                                                               */ 03987000
*   /*****************************************************************/ 03988000
*                                                               02S1097 03989000
*   FRRTABL=ADDR(MCCE);             /* PASS MCCE ADDRESS TO FRR 02S1097 03990000
*                                      ROUTINE                       */ 03991000
         ST    SRBPARM2,FRRTABL(,FRRLIST)                       02S1097 03992000
*   FRRRET=RETURNAD;                /* PASS RETURN ADDRESS TO FRR FOR   03993000
*                                      RETRY                         */ 03994000
*                                                               02S1098 03995000
         ST    RETURNAD,FRRRET(,FRRLIST)                        02S1098 03996000
*   /*****************************************************************/ 03997000
*   /*                                                               */ 03998000
*   /* GET SALLOC LOCK FOR FREEMAINS                                 */ 03999000
*   /*                                                               */ 04000000
*   /*****************************************************************/ 04001000
*                                                               02S1099 04002000
*   GENERATE;                                                   02S1099 04003000
AHLTFR00 SETLOCK OBTAIN,TYPE=SALLOC,MODE=UNCOND,                       *04004000
               RELATED=(FREEMCCE,AHLSETEV,(AHLTFR03,AHLTFR04))          04005000
*   FRRSALOC='80'X;                 /* INDICATE LOCK GOTTEN          */ 04006000
         MVI   FRRSALOC(FRRLIST),X'80'                          02S1100 04007000
*                                                               02S1101 04008000
*   /*****************************************************************/ 04009000
*   /*                                                               */ 04010000
*   /* FREE MCED IF IT IS INDICATED TO BE FREED                      */ 04011000
*   /*                                                               */ 04012000
*   /*****************************************************************/ 04013000
*                                                               02S1101 04014000
*   IF MCCEOEDA^=0 THEN                                         02S1101 04015000
         L     @15,MCCEOEDA(,SRBPARM2)                          02S1101 04016000
         LTR   @15,@15                                          02S1101 04017000
         BZ    @RF01101                                         02S1101 04018000
*     DO;                                                       02S1102 04019000
*                                                               02S1102 04020000
*       /*************************************************************/ 04021000
*       /*                                                           */ 04022000
*       /* MCED IS TO BE FREED. TO FREE IT, ALL ITS ASSOCIATED       */ 04023000
*       /* STORAGE MUST BE DEFINED TO ITS FREESPACE QUEUE. TO FORCE  */ 04024000
*       /* THIS, ALL REMAINING ENTRIES MUST BE DELETED FROM THE MCED.*/ 04025000
*       /*                                                           */ 04026000
*       /*************************************************************/ 04027000
*                                                               02S1103 04028000
*       RFY                                                     02S1103 04029000
*        (FTREEAD,                                              02S1103 04030000
*         SINKADDR) RSTD;                                       02S1103 04031000
*       FTREEAD=MCCEOEDA;                                       02S1104 04032000
         L     @06,MCCEOEDA(,SRBPARM2)                          02S1104 04033000
         LR    FTREEAD,@06                                      02S1104 04034000
*AHLTFR01:                                                      02S1105 04035000
*       GEN(SRCH  (FTREEAD),SARG=DUMMYARG,TYPE=5,KEYL=2);/* PERFORM     04036000
*                                      SEARCH FOR A DUMMY MCEE, TO      04037000
*                                      FIND OUT IF THERE ARE ANY        04038000
*                                      ENTRIES TO BE DELETED FROM THE   04039000
*                                      TREE                          */ 04040000
AHLTFR01 SRCH  (FTREEAD),SARG=DUMMYARG,TYPE=5,KEYL=2                    04041000
*       IF SINKIND<0 THEN                                       02S1106 04042000
         LTR   SINKIND,SINKIND                                  02S1106 04043000
         BM    @RT01106                                         02S1106 04044000
*         GO TO AHLTFR02;           /* IF RETURNED MCEE ADDRESS IS      04045000
*                                      NEGATIVE, ALL ENTRIES HAVE       04046000
*                                      BEEN DELETED. GO FREE THE        04047000
*                                      SPACE                         */ 04048000
*       GEN(DEL  (FTREEAD),FREE=NO,TYPE=5);/* OTHERWISE, AN ENTRY       04049000
*                                      STILL EXISTS. DELETE IT FROM     04050000
*                                      THE MCED, CAUSING ITS STORAGE    04051000
*                                      TO BE PLACED ON THE FREESPACE    04052000
*                                      QUEUE                         */ 04053000
         DEL  (FTREEAD),FREE=NO,TYPE=5                                  04054000
*       GO TO AHLTFR01;             /* LOOP BACK UNTIL ALL REMAINING    04055000
*                                      ENTRIES ARE DELETED FROM THE     04056000
*                                      MCED                          */ 04057000
         B     AHLTFR01                                         02S1109 04058000
*       RFY                                                     02S1110 04059000
*         SINKADDR UNRSTD;                                      02S1110 04060000
*                                                               02S1111 04061000
*       /*************************************************************/ 04062000
*       /*                                                           */ 04063000
*       /* ALL ENTRIES HAVE BEEN DELETED FROM THE MCED, AND THEREFORE*/ 04064000
*       /* ALL ITS STORAGE IS DEFINED BY THE FREESPACE QUEUE. THE    */ 04065000
*       /* FOLLOWING CODE FREES ALL MCED STORAGE, STARTING WITH THE  */ 04066000
*       /* PREFIX                                                    */ 04067000
*       /*                                                           */ 04068000
*       /*************************************************************/ 04069000
*                                                               02S1111 04070000
*       RFY                                                     02S1111 04071000
*        (FRSPCELM,                                             02S1111 04072000
*         NXTFRSP) RSTD;                                        02S1111 04073000
*AHLTFR02:                                                      02S1112 04074000
*       GENERATE;                                               02S1112 04075000
*                                                               02S1112 04076000
AHLTFR02 DS    0H                                               02S1112 04077000
         USING IGARPTH5,FTREEAD                                         04078000
         L     FRSPCELM,IGAHVFC5     LOAD FREESPACE QUEUE ADDRESS       04079000
         LA    FRSPCELM,0(FRSPCELM)  CLEAR HI BYTE                      04080000
         LA    REG0,IGATYP5S         SET LENGTH TO FREE PREEFIX OF MCED 04081000
         FREEMAIN RU,LV=(0),A=(FTREEAD),BRANCH=(YES,GLOBAL),SP=245      04082000
         DROP  FTREEAD                                                  04083000
*       /*************************************************************/ 04084000
*       /*                                                           */ 04085000
*       /* FREE ALL STORAGE ON THE FREESPACE QUEUE                   */ 04086000
*       /*                                                           */ 04087000
*       /*************************************************************/ 04088000
*                                                               02S1113 04089000
*       DO WHILE(FRSPCELM^=0);      /* IF THERE ARE ELEMENTS ON THE     04090000
*                                      FREESPACE QUEUE, FREE THEM    */ 04091000
         B     @DE01113                                         02S1113 04092000
@DL01113 DS    0H                                               02S1114 04093000
*         NXTFRSP=FRESPLNK;         /* PICK UP ADDRESS OF NEXT  02S1114 04094000
*                                      FREESPACE QUEUE ELEMENT BEOFRE   04095000
*                                      FREEING THIS ONE              */ 04096000
         L     NXTFRSP,FRESPLNK-1(,FRSPCELM)                    02S1114 04097000
         LA    NXTFRSP,0(,NXTFRSP)                              02S1114 04098000
*         DO;                       /* FREEMAIN(RU) LV(LENGTH(FRESPAC   04099000
*                                      E))A(FRESPACE) SP(SQA)   02S1115 04100000
*                                      BRANCH(GLOBAL)                */ 04101000
*           RESPECIFY                                           02S1116 04102000
*            (GPR01F,                                           02S1116 04103000
*             GPR03F,                                           02S1116 04104000
*             GPR00F,                                           02S1116 04105000
*             GPR04P) RESTRICTED;                               02S1116 04106000
*           GPR01F=0;               /* REG 1 MUST BE ZERO            */ 04107000
         SLR   GPR01F,GPR01F                                    02S1117 04108000
*           GPR03F=3;               /* SET TYPE                      */ 04109000
         LA    GPR03F,3                                         02S1118 04110000
*           GPR00F=LENGTH(FRESPACE);/* LENGTH REQUESTED              */ 04111000
         LA    GPR00F,8                                         02S1119 04112000
*           GPR01F=ADDR(FRESPACE);  /* SET REGISTER ONE              */ 04113000
         LR    GPR01F,FRSPCELM                                  02S1120 04114000
*           GPR03F=GPR03F+((SQA)*256);/* SUBPOOL VALUE               */ 04115000
         AL    GPR03F,@CF02506                                  02S1121 04116000
*           GPR04P=WSAGGMFM;        /* POINT TO SAVE AREA            */ 04117000
         L     @15,CVTPTR                                       02S1122 04118000
         L     @02,CVTSPSA(,@15)                                02S1122 04119000
         L     GPR04P,WSAGGMFM(,@02)                            02S1122 04120000
*           CALL CVTGLMN;           /* BRANCH ENTRY POINT            */ 04121000
         L     @15,CVTGLMN(,@15)                                02S1123 04122000
         BALR  @14,@15                                          02S1123 04123000
*           RESPECIFY                                           02S1124 04124000
*            (GPR01F,                                           02S1124 04125000
*             GPR03F,                                           02S1124 04126000
*             GPR00F,                                           02S1124 04127000
*             GPR04P) UNRESTRICTED;                             02S1124 04128000
*         END;                      /* FREEMAIN(RU) LV(LENGTH(FRESPAC   04129000
*                                      E))A(FRESPACE) SP(SQA)   02S1125 04130000
*                                      BRANCH(GLOBAL)                */ 04131000
*         FRSPCELM=NXTFRSP;         /* PICK UP THE NEXT QUEUE ELEMENT   04132000
*                                      FROM WHERE IT WAS SAVED       */ 04133000
         LR    FRSPCELM,NXTFRSP                                 02S1126 04134000
*       END;                        /* LOOP UNTIL ALL FREESPACE 02S1127 04135000
*                                      ELEMENTS ARE FREED            */ 04136000
@DE01113 LTR   FRSPCELM,FRSPCELM                                02S1127 04137000
         BNZ   @DL01113                                         02S1127 04138000
*     END;                          /* END OF MCED FREEING PATH      */ 04139000
*   RFY                                                         02S1129 04140000
*    (FRSPCELM,                                                 02S1129 04141000
*     NXTFRSP,                                                  02S1129 04142000
*     FTREEAD) UNRSTD;                                          02S1129 04143000
@RF01101 DS    0H                                               02S1130 04144000
*                                                               02S1130 04145000
*   /*****************************************************************/ 04146000
*   /*                                                               */ 04147000
*   /* FREE MCCD STORAGE IF IT IS INDICATED TO BE FREED              */ 04148000
*   /*                                                               */ 04149000
*   /*****************************************************************/ 04150000
*                                                               02S1130 04151000
*   IF MCCEOCDA^=0 THEN                                         02S1130 04152000
         L     @15,MCCEOCDA(,SRBPARM2)                          02S1130 04153000
         LTR   @15,@15                                          02S1130 04154000
         BZ    @RF01130                                         02S1130 04155000
*     DO;                                                       02S1131 04156000
*       RFY                                                     02S1132 04157000
*         MCCD BASED(MCCEOCDA);                                 02S1132 04158000
*       DO;                         /* FREEMAIN(RU)             02S1133 04159000
*                                      LV(LENGTH(MCCD))A(MCCD)  02S1133 04160000
*                                      SP(245) BRANCH(GLOBAL)        */ 04161000
*         RESPECIFY                                             02S1134 04162000
*          (GPR01F,                                             02S1134 04163000
*           GPR03F,                                             02S1134 04164000
*           GPR00F,                                             02S1134 04165000
*           GPR04P) RESTRICTED;                                 02S1134 04166000
*         GPR01F=0;                 /* REG 1 MUST BE ZERO            */ 04167000
         SLR   GPR01F,GPR01F                                    02S1135 04168000
*         GPR03F=3;                 /* SET TYPE                      */ 04169000
         LA    GPR03F,3                                         02S1136 04170000
*         GPR00F=LENGTH(MCCD);      /* LENGTH REQUESTED              */ 04171000
         LA    GPR00F,76                                        02S1137 04172000
*         GPR01F=ADDR(MCCD);        /* SET REGISTER ONE              */ 04173000
         LR    GPR01F,@15                                       02S1138 04174000
*         GPR03F=GPR03F+((245)*256);/* SUBPOOL VALUE                 */ 04175000
         AL    GPR03F,@CF02506                                  02S1139 04176000
*         GPR04P=WSAGGMFM;          /* POINT TO SAVE AREA            */ 04177000
         L     @15,CVTPTR                                       02S1140 04178000
         L     @10,CVTSPSA(,@15)                                02S1140 04179000
         L     GPR04P,WSAGGMFM(,@10)                            02S1140 04180000
*         CALL CVTGLMN;             /* BRANCH ENTRY POINT            */ 04181000
         L     @15,CVTGLMN(,@15)                                02S1141 04182000
         BALR  @14,@15                                          02S1141 04183000
*         RESPECIFY                                             02S1142 04184000
*          (GPR01F,                                             02S1142 04185000
*           GPR03F,                                             02S1142 04186000
*           GPR00F,                                             02S1142 04187000
*           GPR04P) UNRESTRICTED;                               02S1142 04188000
*       END;                        /* FREEMAIN(RU)             02S1143 04189000
*                                      LV(LENGTH(MCCD))A(MCCD)  02S1143 04190000
*                                      SP(245) BRANCH(GLOBAL)        */ 04191000
*     END;                                                      02S1144 04192000
*                                                               02S1145 04193000
*   /*****************************************************************/ 04194000
*   /*                                                               */ 04195000
*   /* IF THE MCCEOMCQ FIELD CONTAINS A ZERO ADDRESS, THE MCCE IS TO */ 04196000
*   /* BE FREED. OTHERWISE, THE MCQE POINTED TO BY MCCEOMCQ AND ITS  */ 04197000
*   /* ASSOCIATED MCEE/MCCLES ARE TO BE FREED, AND THE MCCEECB IS TO */ 04198000
*   /* BE POSTED                                                     */ 04199000
*   /*                                                               */ 04200000
*   /*****************************************************************/ 04201000
*                                                               02S1145 04202000
*   IF MCCEOMCQ=0 THEN                                          02S1145 04203000
@RF01130 L     @15,MCCEOMCQ(,SRBPARM2)                          02S1145 04204000
         LTR   @15,@15                                          02S1145 04205000
         BNZ   @RF01145                                         02S1145 04206000
*     DO;                                                       02S1146 04207000
*                                                               02S1146 04208000
*       /*************************************************************/ 04209000
*       /*                                                           */ 04210000
*       /* FREE THE MCCE                                             */ 04211000
*       /*                                                           */ 04212000
*       /*************************************************************/ 04213000
*                                                               02S1147 04214000
*       DO;                         /* FREEMAIN(RU)             02S1147 04215000
*                                      LV(LENGTH(MCCE))A(MCCE)  02S1147 04216000
*                                      SP(SQA) BRANCH(GLOBAL)        */ 04217000
*         RESPECIFY                                             02S1148 04218000
*          (GPR01F,                                             02S1148 04219000
*           GPR03F,                                             02S1148 04220000
*           GPR00F,                                             02S1148 04221000
*           GPR04P) RESTRICTED;                                 02S1148 04222000
*         GPR01F=0;                 /* REG 1 MUST BE ZERO            */ 04223000
         SLR   GPR01F,GPR01F                                    02S1149 04224000
*         GPR03F=3;                 /* SET TYPE                      */ 04225000
         LA    GPR03F,3                                         02S1150 04226000
*         GPR00F=LENGTH(MCCE);      /* LENGTH REQUESTED              */ 04227000
         LA    GPR00F,88                                        02S1151 04228000
*         GPR01F=ADDR(MCCE);        /* SET REGISTER ONE              */ 04229000
         LR    GPR01F,SRBPARM2                                  02S1152 04230000
*         GPR03F=GPR03F+((SQA)*256);/* SUBPOOL VALUE                 */ 04231000
         AL    GPR03F,@CF02506                                  02S1153 04232000
*         GPR04P=WSAGGMFM;          /* POINT TO SAVE AREA            */ 04233000
         L     @15,CVTPTR                                       02S1154 04234000
         L     @10,CVTSPSA(,@15)                                02S1154 04235000
         L     GPR04P,WSAGGMFM(,@10)                            02S1154 04236000
*         CALL CVTGLMN;             /* BRANCH ENTRY POINT            */ 04237000
         L     @15,CVTGLMN(,@15)                                02S1155 04238000
         BALR  @14,@15                                          02S1155 04239000
*         RESPECIFY                                             02S1156 04240000
*          (GPR01F,                                             02S1156 04241000
*           GPR03F,                                             02S1156 04242000
*           GPR00F,                                             02S1156 04243000
*           GPR04P) UNRESTRICTED;                               02S1156 04244000
*       END;                        /* FREEMAIN(RU)             02S1157 04245000
*                                      LV(LENGTH(MCCE))A(MCCE)  02S1157 04246000
*                                      SP(SQA) BRANCH(GLOBAL)        */ 04247000
*       SRBRTRN=FRRRET;             /* LOAD RETURN ADDRESS           */ 04248000
         L     SRBRTRN,FRRRET(,FRRLIST)                         02S1158 04249000
*       GENERATE;                                               02S1159 04250000
               SETFRR D,WRKREGS=(2,3)  DELETE ERROR RECOVERY            04251000
AHLTFR03       SETLOCK RELEASE,TYPE=SALLOC,                            *04252000
               RELATED=(FREEMCCE,AHLSETEV,AHLTFR00) RELEASE SALLOC LOCK 04253000
*       GO TO SRBRTRN;              /* RETURN TO THE SYSTEM          */ 04254000
         BR    SRBRTRN                                          02S1160 04255000
*     END;                          /* END OF NO MCQE PATH           */ 04256000
*   ELSE                                                        02S1162 04257000
*     DO;                                                       02S1162 04258000
*                                                               02S1162 04259000
@RF01145 DS    0H                                               02S1163 04260000
*       /*************************************************************/ 04261000
*       /*                                                           */ 04262000
*       /* MCQE AND ITS ELEMENTS ARE TO BE FREED - START WITH THE    */ 04263000
*       /* MCEES                                                     */ 04264000
*       /*                                                           */ 04265000
*       /*************************************************************/ 04266000
*                                                               02S1163 04267000
*       RFY                                                     02S1163 04268000
*         MCQE BASED(MCCEOMCQ);                                 02S1163 04269000
*       RFY                                                     02S1164 04270000
*        (MCEETOFR,                                             02S1164 04271000
*         NEXTMCEE) RSTD;                                       02S1164 04272000
*       MCEETOFR=MCQEMCEE;          /* LOAD FIRST MCEE ADDRESS       */ 04273000
         L     @15,MCCEOMCQ(,SRBPARM2)                          02S1165 04274000
         L     MCEETOFR,MCQEMCEE(,@15)                          02S1165 04275000
*       DO WHILE(MCEETOFR^=0);      /* LOOP UNTIL LAST MCEE HAS BEEN    04276000
*                                      FREED                         */ 04277000
         B     @DE01166                                         02S1166 04278000
@DL01166 DS    0H                                               02S1167 04279000
*         NEXTMCEE=MCEETOFR->MCEEMCQL;/* FIND THE NEXT MCEE BEFORE      04280000
*                                      FREEING THIS ONE              */ 04281000
         L     NEXTMCEE,MCEEMCQL(,MCEETOFR)                     02S1167 04282000
*         RFY                                                   02S1168 04283000
*           MCEE BASED(MCEETOFR);                               02S1168 04284000
*         DO;                       /* FREEMAIN(RU)             02S1169 04285000
*                                      LV(LENGTH(MCEE))A(MCEE)  02S1169 04286000
*                                      SP(SQA) BRANCH(GLOBAL)        */ 04287000
*           RESPECIFY                                           02S1170 04288000
*            (GPR01F,                                           02S1170 04289000
*             GPR03F,                                           02S1170 04290000
*             GPR00F,                                           02S1170 04291000
*             GPR04P) RESTRICTED;                               02S1170 04292000
*           GPR01F=0;               /* REG 1 MUST BE ZERO            */ 04293000
         SLR   GPR01F,GPR01F                                    02S1171 04294000
*           GPR03F=3;               /* SET TYPE                      */ 04295000
         LA    GPR03F,3                                         02S1172 04296000
*           GPR00F=LENGTH(MCEE);    /* LENGTH REQUESTED              */ 04297000
         LA    GPR00F,28                                        02S1173 04298000
*           GPR01F=ADDR(MCEE);      /* SET REGISTER ONE              */ 04299000
         LR    GPR01F,MCEETOFR                                  02S1174 04300000
*           GPR03F=GPR03F+((SQA)*256);/* SUBPOOL VALUE               */ 04301000
         AL    GPR03F,@CF02506                                  02S1175 04302000
*           GPR04P=WSAGGMFM;        /* POINT TO SAVE AREA            */ 04303000
         L     @15,CVTPTR                                       02S1176 04304000
         L     @10,CVTSPSA(,@15)                                02S1176 04305000
         L     GPR04P,WSAGGMFM(,@10)                            02S1176 04306000
*           CALL CVTGLMN;           /* BRANCH ENTRY POINT            */ 04307000
         L     @15,CVTGLMN(,@15)                                02S1177 04308000
         BALR  @14,@15                                          02S1177 04309000
*           RESPECIFY                                           02S1178 04310000
*            (GPR01F,                                           02S1178 04311000
*             GPR03F,                                           02S1178 04312000
*             GPR00F,                                           02S1178 04313000
*             GPR04P) UNRESTRICTED;                             02S1178 04314000
*         END;                      /* FREEMAIN(RU)             02S1179 04315000
*                                      LV(LENGTH(MCEE))A(MCEE)  02S1179 04316000
*                                      SP(SQA) BRANCH(GLOBAL)        */ 04317000
*         MCEETOFR=NEXTMCEE;        /* NEXT MCEE TO BE FREED         */ 04318000
         LR    MCEETOFR,NEXTMCEE                                02S1180 04319000
*       END;                        /* LOOP THRU ALL MCEES, UNTIL       04320000
*                                      END-OF-CHAIN FOUND            */ 04321000
@DE01166 LTR   MCEETOFR,MCEETOFR                                02S1181 04322000
         BNZ   @DL01166                                         02S1181 04323000
*       RFY                                                     02S1182 04324000
*        (MCEETOFR,                                             02S1182 04325000
*         NEXTMCEE) UNRSTD;                                     02S1182 04326000
*                                                               02S1183 04327000
*       /*************************************************************/ 04328000
*       /*                                                           */ 04329000
*       /* THEN FREE THE MCCLES                                      */ 04330000
*       /*                                                           */ 04331000
*       /*************************************************************/ 04332000
*                                                               02S1183 04333000
*       RFY                                                     02S1183 04334000
*         MCCLE BASED(MCCLTOFR);                                02S1183 04335000
*       RFY                                                     02S1184 04336000
*        (MCCLTOFR,                                             02S1184 04337000
*         NEXTMCCL) RSTD;                                       02S1184 04338000
*       MCCLTOFR=MCQEMCCL;          /* LOAD FIRST MCCLE ADDRESS      */ 04339000
         L     @15,MCCEOMCQ(,SRBPARM2)                          02S1185 04340000
         L     MCCLTOFR,MCQEMCCL(,@15)                          02S1185 04341000
*       DO WHILE(MCCLTOFR^=0);      /* LOOP UNTIL LAST MCCLE HAS BEEN   04342000
*                                      FREED                         */ 04343000
         B     @DE01186                                         02S1186 04344000
@DL01186 DS    0H                                               02S1187 04345000
*         NEXTMCCL=MCCLMCQL;        /* PICK UP SUCCESSOR BEFORE THIS    04346000
*                                      ONE IS FREED                  */ 04347000
         L     NEXTMCCL,MCCLMCQL(,MCCLTOFR)                     02S1187 04348000
*         DO;                       /* FREEMAIN(RU)             02S1188 04349000
*                                      LV(LENGTH(MCCLE))A(MCCLE)        04350000
*                                      SP(SQA) BRANCH(GLOBAL)        */ 04351000
*           RESPECIFY                                           02S1189 04352000
*            (GPR01F,                                           02S1189 04353000
*             GPR03F,                                           02S1189 04354000
*             GPR00F,                                           02S1189 04355000
*             GPR04P) RESTRICTED;                               02S1189 04356000
*           GPR01F=0;               /* REG 1 MUST BE ZERO            */ 04357000
         SLR   GPR01F,GPR01F                                    02S1190 04358000
*           GPR03F=3;               /* SET TYPE                      */ 04359000
         LA    GPR03F,3                                         02S1191 04360000
*           GPR00F=LENGTH(MCCLE);   /* LENGTH REQUESTED              */ 04361000
         LA    GPR00F,28                                        02S1192 04362000
*           GPR01F=ADDR(MCCLE);     /* SET REGISTER ONE              */ 04363000
         LR    GPR01F,MCCLTOFR                                  02S1193 04364000
*           GPR03F=GPR03F+((SQA)*256);/* SUBPOOL VALUE               */ 04365000
         AL    GPR03F,@CF02506                                  02S1194 04366000
*           GPR04P=WSAGGMFM;        /* POINT TO SAVE AREA            */ 04367000
         L     @15,CVTPTR                                       02S1195 04368000
         L     @10,CVTSPSA(,@15)                                02S1195 04369000
         L     GPR04P,WSAGGMFM(,@10)                            02S1195 04370000
*           CALL CVTGLMN;           /* BRANCH ENTRY POINT            */ 04371000
         L     @15,CVTGLMN(,@15)                                02S1196 04372000
         BALR  @14,@15                                          02S1196 04373000
*           RESPECIFY                                           02S1197 04374000
*            (GPR01F,                                           02S1197 04375000
*             GPR03F,                                           02S1197 04376000
*             GPR00F,                                           02S1197 04377000
*             GPR04P) UNRESTRICTED;                             02S1197 04378000
*         END;                      /* FREEMAIN(RU)             02S1198 04379000
*                                      LV(LENGTH(MCCLE))A(MCCLE)        04380000
*                                      SP(SQA) BRANCH(GLOBAL)        */ 04381000
*         MCCLTOFR=NEXTMCCL;        /* LOAD NEXT MCCLE TO BE FREED   */ 04382000
         LR    MCCLTOFR,NEXTMCCL                                02S1199 04383000
*       END;                        /* LOOP UNTIL END-OF-CHAIN IS       04384000
*                                      FOUND                         */ 04385000
@DE01186 LTR   MCCLTOFR,MCCLTOFR                                02S1200 04386000
         BNZ   @DL01186                                         02S1200 04387000
*       RFY                                                     02S1201 04388000
*        (MCCLTOFR,                                             02S1201 04389000
*         NEXTMCCL) UNRSTD;                                     02S1201 04390000
*                                                               02S1202 04391000
*       /*************************************************************/ 04392000
*       /*                                                           */ 04393000
*       /* NOW FREE THE MCQE                                         */ 04394000
*       /*                                                           */ 04395000
*       /*************************************************************/ 04396000
*                                                               02S1202 04397000
*       DO;                         /* FREEMAIN(RU)             02S1202 04398000
*                                      LV(LENGTH(MCQE))A(MCQE)  02S1202 04399000
*                                      SP(SQA) BRANCH(GLOBAL)        */ 04400000
*         RESPECIFY                                             02S1203 04401000
*          (GPR01F,                                             02S1203 04402000
*           GPR03F,                                             02S1203 04403000
*           GPR00F,                                             02S1203 04404000
*           GPR04P) RESTRICTED;                                 02S1203 04405000
*         GPR01F=0;                 /* REG 1 MUST BE ZERO            */ 04406000
         SLR   GPR01F,GPR01F                                    02S1204 04407000
*         GPR03F=3;                 /* SET TYPE                      */ 04408000
         LA    GPR03F,3                                         02S1205 04409000
*         GPR00F=LENGTH(MCQE);      /* LENGTH REQUESTED              */ 04410000
         LA    GPR00F,88                                        02S1206 04411000
*         GPR01F=ADDR(MCQE);        /* SET REGISTER ONE              */ 04412000
         L     GPR01F,MCCEOMCQ(,SRBPARM2)                       02S1207 04413000
*         GPR03F=GPR03F+((SQA)*256);/* SUBPOOL VALUE                 */ 04414000
         AL    GPR03F,@CF02506                                  02S1208 04415000
*         GPR04P=WSAGGMFM;          /* POINT TO SAVE AREA            */ 04416000
         L     @15,CVTPTR                                       02S1209 04417000
         L     @10,CVTSPSA(,@15)                                02S1209 04418000
         L     GPR04P,WSAGGMFM(,@10)                            02S1209 04419000
*         CALL CVTGLMN;             /* BRANCH ENTRY POINT            */ 04420000
         L     @15,CVTGLMN(,@15)                                02S1210 04421000
         BALR  @14,@15                                          02S1210 04422000
*         RESPECIFY                                             02S1211 04423000
*          (GPR01F,                                             02S1211 04424000
*           GPR03F,                                             02S1211 04425000
*           GPR00F,                                             02S1211 04426000
*           GPR04P) UNRESTRICTED;                               02S1211 04427000
*       END;                        /* FREEMAIN(RU)             02S1212 04428000
*                                      LV(LENGTH(MCQE))A(MCQE)  02S1212 04429000
*                                      SP(SQA) BRANCH(GLOBAL)        */ 04430000
*                                                               02S1213 04431000
*       /*************************************************************/ 04432000
*       /*                                                           */ 04433000
*       /* COMPLETE PROCESSING BY REMOVING THE FRR, RELEASING THE    */ 04434000
*       /* SALLOC LOCK, AND POSTING COMPLTION VIA THE MCEEECB. THE   */ 04435000
*       /* LOCAL LOCK MUST BE OBTAINED AND RELEASED AROUND THE BRANCH*/ 04436000
*       /* ENTRY TO POST                                             */ 04437000
*       /*                                                           */ 04438000
*       /*************************************************************/ 04439000
*                                                               02S1213 04440000
*       SRBRTRN=FRRRET;             /* LOAD RETURN ADDRESS           */ 04441000
         L     SRBRTRN,FRRRET(,FRRLIST)                         02S1213 04442000
*       GENERATE;                                               02S1214 04443000
         SETFRR D,WRKREGS=(5,6) DELETE THE ERROR RECOVERY               04444000
AHLTFR04 SETLOCK RELEASE,TYPE=SALLOC,                                  *04445000
               RELATED=(FREEMCCE,AHLSETEV,AHLTFR00)  RELEASE SALLOC     04446000
*                        SINCE IT IS NO LONGER NEEDED                   04447000
AHLTFR05 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                        *04448000
               RELATED=(POSTMCCE,AHLSETEV,AHLTFR06)  OBTAIN LOCAL       04449000
*                        TO POST THE MCCEECB                            04450000
          SR    ECBCODE,ECBCODE            SET COMPLETION CODE TO 0     04451000
          LA    SRBECB,MCCEECB(SRBPARM2)   POINT TO MCCEECB TO POST     04452000
          L     TEMPREG,CVTPTR             FIND CVT ADDRESS             04453000
          L     TEMPREG,CVT0PT01(TEMPREG)  FIND BRANCH ENTRY TO POST    04454000
          BALR  RETURNAD,TEMPREG           CALL POST                    04455000
AHLTFR06 SETLOCK RELEASE,TYPE=LOCAL,                                   *04456000
               RELATED=(POSTMCCE,AHLSETEV,AHLTFR05) RELEASE LOCK        04457000
*       GO TO SRBRTRN;              /* RETURN TO THE SYSTEM          */ 04458000
         BR    SRBRTRN                                          02S1215 04459000
*       GEN(DROP  BASEREG);                                     02S1216 04460000
         DROP  BASEREG                                                  04461000
*       RFY                                                     02S1217 04462000
*         BASEREG UNRSTD;                                       02S1217 04463000
*     END;                          /* END OF MCQE PATH              */ 04464000
*AHLMCQP:                                                       02S1219 04465000
*   GENERATE;                                                   02S1219 04466000
*                                                               02S1219 04467000
AHLMCQP  DS    0H                                               02S1219 04468000
          BALR  BASEREG,0                                               04469000
          USING *,BASEREG                                               04470000
*   /*****************************************************************/ 04471000
*   /*                                                               */ 04472000
*   /* THE FOLLOWING SRB ROUTINE RECEIVES CONTROL WHEN THE SRB IN AN */ 04473000
*   /* MCQE GETS SCHEDULED. ITS JOB IS TO POST THE TERMINATE ECB IN  */ 04474000
*   /* THE MCQE, MCQETECB.                                           */ 04475000
*   /*                                                               */ 04476000
*   /*****************************************************************/ 04477000
*                                                               02S1220 04478000
*   RFY                                                         02S1220 04479000
*     MCQE BASED(SRBPARM2);                                     02S1220 04480000
*   RFY                                                         02S1221 04481000
*    (SRBPARM2,                                                 02S1221 04482000
*     SRBRTRN,                                                  02S1221 04483000
*     BASEREG,                                                  02S1221 04484000
*     SRBPARM1,                                                 02S1221 04485000
*     RETURNAD) RSTD;                                           02S1221 04486000
*   SRBPARM2=SRBPARM1;              /* SAVE MCQE ADDRESS IN A SAFE      04487000
*                                      REGISTER                      */ 04488000
         LR    SRBPARM2,SRBPARM1                                02S1222 04489000
*   SRBRTRN=RETURNAD;               /* SAVE RETURN ADDRESS           */ 04490000
*                                                               02S1223 04491000
         LR    SRBRTRN,RETURNAD                                 02S1223 04492000
*   /*****************************************************************/ 04493000
*   /*                                                               */ 04494000
*   /* GET THE LOCAL LOCK FOR BRANCH ENTRY POST                      */ 04495000
*   /*                                                               */ 04496000
*   /*****************************************************************/ 04497000
*                                                               02S1224 04498000
*   GENERATE;                                                   02S1224 04499000
AHLMCQP1 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                        *04500000
               RELATED=(MCQEPOST,AHLSETEV,AHLMCQP2)                     04501000
*                                                               02S1225 04502000
*   /*****************************************************************/ 04503000
*   /*                                                               */ 04504000
*   /* POST THE MCQETECB TO CAUSE TERMINATION OF THE APPLICATION     */ 04505000
*   /* DESCRIBED BY THIS MCQE                                        */ 04506000
*   /*                                                               */ 04507000
*   /*****************************************************************/ 04508000
*                                                               02S1225 04509000
*   RFY                                                         02S1225 04510000
*    (ECBCODE,                                                  02S1225 04511000
*     SRBECB) RSTD;                                             02S1225 04512000
*   ECBCODE=0;                      /* SET THE ECB COMPLETION CODE TO   04513000
*                                      ZERO                          */ 04514000
         SLR   ECBCODE,ECBCODE                                  02S1226 04515000
*   SRBECB=ADDR(MCQETECB);          /* POINT TO THE MCQE ECB TO POST */ 04516000
         LA    SRBECB,MCQETECB(,SRBPARM2)                       02S1227 04517000
*   CALL BRPOST;                    /* GO TO POST TO SIGNAL ECB 02S1228 04518000
*                                      COMPLETION                    */ 04519000
         L     @06,CVTPTR                                       02S1228 04520000
         L     @15,CVT0PT01(,@06)                               02S1228 04521000
         BALR  @14,@15                                          02S1228 04522000
*   RFY                                                         02S1229 04523000
*    (ECBCODE,                                                  02S1229 04524000
*     SRBECB) UNRSTD;                                           02S1229 04525000
*                                                               02S1229 04526000
*   /*****************************************************************/ 04527000
*   /*                                                               */ 04528000
*   /* RELEASE THE LOCAL LOCK                                        */ 04529000
*   /*                                                               */ 04530000
*   /*****************************************************************/ 04531000
*                                                               02S1230 04532000
*   GENERATE;                                                   02S1230 04533000
*                                                               02S1230 04534000
AHLMCQP2 SETLOCK RELEASE,TYPE=LOCAL,                                   *04535000
               RELATED=(MCQEPOST,AHLSETEV,AHLMCQP1)                     04536000
*   /*****************************************************************/ 04537000
*   /*                                                               */ 04538000
*   /* RETURN TO THE SYSTEM                                          */ 04539000
*   /*                                                               */ 04540000
*   /*****************************************************************/ 04541000
*                                                               02S1231 04542000
*   GO TO SRBRTRN;                                              02S1231 04543000
         BR    SRBRTRN                                          02S1231 04544000
*   GEN(DROP  BASEREG);                                         02S1232 04545000
         DROP  BASEREG                                                  04546000
*   RFY                                                         02S1233 04547000
*     BASEREG UNRSTD;                                           02S1233 04548000
*                                                               02S1234 04549000
*   /*****************************************************************/ 04550000
*   /*                                                               */ 04551000
*   /* AHLMCPST SRB ROUTINE - THIS SRB ROUTINE RECEIVES CONTROL WHEN */ 04552000
*   /* ALL MCQES OFF THE MCCE (POINTED TO BY R1) ARE TO BE POSTED TO */ 04553000
*   /* TERMINATE DUE TO AN ERROR ENCOUNTERED IN THE MC ROUTING       */ 04554000
*   /* FACILITY. THE POSTING IS ACCOMPLISHED BY SCHEDULING THE SRB IN*/ 04555000
*   /* EACH MCQE, CAUSING SRB ROUTINE AHLMCQP TO POST EACH MCQE TO   */ 04556000
*   /* TERMINATE                                                     */ 04557000
*   /*                                                               */ 04558000
*   /*****************************************************************/ 04559000
*                                                               02S1234 04560000
*AHLMCPST:                                                      02S1234 04561000
*   GENERATE;                                                   02S1234 04562000
*                                                               02S1234 04563000
AHLMCPST DS    0H                                               02S1234 04564000
         BALR  BASEREG,0                                                04565000
         USING *,BASEREG                                                04566000
         LA    TEMPREG,AHLTFFRR        LOAD FRR ROUTINE ADDRESS         04567000
         SETFRR A,FRRAD=(TEMPREG),WRKREGS=(2,3),PARMAD=(FRRLIST)        04568000
*   /*****************************************************************/ 04569000
*   /*                                                               */ 04570000
*   /* ERROR RECOVERY HAS BEEN SET UP TO ENSURE THAT THE MCCEECB GETS*/ 04571000
*   /* POSTED. INITIALIZE THE FRR PARAMETER LIST TO ALLOW AHLTFFRR TO*/ 04572000
*   /* FIND THE MCCE                                                 */ 04573000
*   /*                                                               */ 04574000
*   /*****************************************************************/ 04575000
*                                                               02S1235 04576000
*   RFY                                                         02S1235 04577000
*    (SRBPARM2,                                                 02S1235 04578000
*     BASEREG,                                                  02S1235 04579000
*     FRRLIST,                                                  02S1235 04580000
*     RETURNAD,                                                 02S1235 04581000
*     SRBPTR) RSTD;                                             02S1235 04582000
*   SRBPARM2=SRBPARM1;              /* SAVE THE MCCE ADDRESS IN SAFE    04583000
*                                      REG                           */ 04584000
         LR    SRBPARM2,SRBPARM1                                02S1236 04585000
*   RFY                                                         02S1237 04586000
*     MCCE BASED(SRBPARM2);                                     02S1237 04587000
*   FRRTABL=ADDR(MCCE);             /* SAVE MCCE ADDRESS FOR FRR        04588000
*                                      ROUTINE                       */ 04589000
         ST    SRBPARM2,FRRTABL(,FRRLIST)                       02S1238 04590000
*   FRRSALOC=0;                     /* INDICATE SALLOC LOCK NOT YET     04591000
*                                      GOTTEN                        */ 04592000
         MVI   FRRSALOC(FRRLIST),X'00'                          02S1239 04593000
*   FRRRET=RETURNAD;                /* SAVE SYSTEM ROTURN ADDRESS FOR   04594000
*                                      RETRY                         */ 04595000
         ST    RETURNAD,FRRRET(,FRRLIST)                        02S1240 04596000
*                                                               02S1241 04597000
*   /*****************************************************************/ 04598000
*   /*                                                               */ 04599000
*   /* SCHEDULE THE SRB IN EACH VALID MCQE IF IT HAS NOT ALREADY BEEN*/ 04600000
*   /* SCHEDULED                                                     */ 04601000
*   /*                                                               */ 04602000
*   /*****************************************************************/ 04603000
*                                                               02S1241 04604000
*   RFY                                                         02S1241 04605000
*     MCQEADR RSTD;                                             02S1241 04606000
*   MCQEADR=MCCEQEA;                /* LOAD FIRST MCQE ADDRESS       */ 04607000
         L     MCQEADR,MCCEQEA(,SRBPARM2)                       02S1242 04608000
*   RFY                                                         02S1243 04609000
*     MCQE BASED(MCQEADR);                                      02S1243 04610000
*   DO WHILE(MCQEADR^=0&MCQEIDEN=MCQETAG);/* LOOP UNTIL EITHER THE      04611000
*                                      VALID END IS REACHED, OR THE     04612000
*                                      CHAIN IS BROKEN               */ 04613000
         B     @DE01244                                         02S1244 04614000
@DL01244 DS    0H                                               02S1245 04615000
*     GEN(TS    MCQESCHE(MCQEADR)); /* TEST MCQESCHE FLAG - IF  02S1245 04616000
*                                      ALREADY SET, SRB HAS ALREADY     04617000
*                                      BEEN SCHEDULED                */ 04618000
         TS    MCQESCHE(MCQEADR)                                        04619000
*     BC(7,AHLMCP01);               /* IF SCHEDULED, DONT RESCHEDULE    04620000
*                                                            @YM01899*/ 04621000
         BC    7,AHLMCP01                                       02S1246 04622000
*     SRBPTR=ADDR(MCQESRB);         /* POINT AT SRB TO BE SCHEDULED  */ 04623000
         LA    SRBPTR,MCQESRB(,MCQEADR)                         02S1247 04624000
*     GEN(SCHEDULE SRB=(1));        /* SCHEDULE THE SRB              */ 04625000
         SCHEDULE SRB=(1)                                               04626000
*AHLMCP01:                                                      02S1249 04627000
*     MCQEADR=MCQEMCQE;             /* LOAD NEXT MCQE ADDRESS        */ 04628000
AHLMCP01 L     MCQEADR,MCQEMCQE(,MCQEADR)                       02S1249 04629000
*   END;                            /* LOOP UNTIL END IS REACHED     */ 04630000
@DE01244 LTR   MCQEADR,MCQEADR                                  02S1250 04631000
         BZ    @DC01244                                         02S1250 04632000
         CLC   MCQEIDEN(8,MCQEADR),@CC00170                     02S1250 04633000
         BE    @DL01244                                         02S1250 04634000
@DC01244 DS    0H                                               02S1251 04635000
*   RFY                                                         02S1251 04636000
*     MCQEADR UNRSTD;                                           02S1251 04637000
*                                                               02S1252 04638000
*   /*****************************************************************/ 04639000
*   /*                                                               */ 04640000
*   /* ALL APPLICATIONS HAVE BEEN POSTED. THE ROUTING TABLES, MCED   */ 04641000
*   /* AND MCCD, MUST NOW BE FREED. THE MCQES WILL BE FREED WHEN THE */ 04642000
*   /* APPLICATIONS ISSUE THEIR REQUIRED SETEVENT FREES. FIRST, THE  */ 04643000
*   /* SALLOC LOCK MUST BE OBTAINED TO ISSUE THE FREEMAINS           */ 04644000
*   /*                                                               */ 04645000
*   /*****************************************************************/ 04646000
*                                                               02S1252 04647000
*   GENERATE;                                                   02S1252 04648000
AHLMCP02 SETLOCK OBTAIN,TYPE=SALLOC,MODE=UNCOND,                       *04649000
               RELATED=(MCCEFREE,AHLSETEV,AHLMCP03)                     04650000
*   FRRSALOC='80'X;                 /* INDICATE TO FRR ROUTINE THAT     04651000
*                                      SALLOC LOCK MUST BE RELEASED  */ 04652000
         MVI   FRRSALOC(FRRLIST),X'80'                          02S1253 04653000
*   RFY                                                         02S1254 04654000
*    (FTREEAD,                                                  02S1254 04655000
*     SINKADDR) RSTD;                                           02S1254 04656000
*                                                               02S1254 04657000
*   /*****************************************************************/ 04658000
*   /*                                                               */ 04659000
*   /* FREE MCED IF IT IS INDICATED TO BE FREED                      */ 04660000
*   /*                                                               */ 04661000
*   /*****************************************************************/ 04662000
*                                                               02S1255 04663000
*   IF MCCEEDA^=0 THEN                                          02S1255 04664000
         L     @06,MCCEEDA(,SRBPARM2)                           02S1255 04665000
         LTR   @06,@06                                          02S1255 04666000
         BZ    @RF01255                                         02S1255 04667000
*     DO;                                                       02S1256 04668000
*                                                               02S1256 04669000
*       /*************************************************************/ 04670000
*       /*                                                           */ 04671000
*       /* MCED IS TO BE FREED. TO FREE IT, ALL ITS ASSOCIATED       */ 04672000
*       /* STORAGE MUST BE DEFINED TO ITS FREESPACE QUEUE. TO FORCE  */ 04673000
*       /* THIS, ALL REMAINING ENTRIES MUST BE DELETED FROM THE MCED.*/ 04674000
*       /*                                                           */ 04675000
*       /*************************************************************/ 04676000
*                                                               02S1257 04677000
*       FTREEAD=MCCEEDA;                                        02S1257 04678000
         LR    FTREEAD,@06                                      02S1257 04679000
*AHLMCPS1:                                                      02S1258 04680000
*       GEN(SRCH  (FTREEAD),SARG=DUMMYARG,TYPE=5,KEYL=2);/* PERFORM     04681000
*                                      SEARCH FOR A DUMMY MCEE, TO      04682000
*                                      FIND OUT IF THERE ARE ANY        04683000
*                                      ENTRIES TO BE DELETED FROM THE   04684000
*                                      TREE                          */ 04685000
AHLMCPS1 SRCH  (FTREEAD),SARG=DUMMYARG,TYPE=5,KEYL=2                    04686000
*       IF SINKIND<0 THEN                                       02S1259 04687000
         LTR   SINKIND,SINKIND                                  02S1259 04688000
         BM    @RT01259                                         02S1259 04689000
*         GO TO AHLMCPS2;           /* IF RETURNED MCEE ADDRESS IS      04690000
*                                      NEGATIVE, ALL ENTRIES HAVE       04691000
*                                      BEEN DELETED. GO FREE THE        04692000
*                                      SPACE                         */ 04693000
*       GEN(DEL  (FTREEAD),FREE=NO,TYPE=5);/* OTHERWISE, AN ENTRY       04694000
*                                      STILL EXISTS. DELETE IT FROM     04695000
*                                      THE MCED, CAUSING ITS STORAGE    04696000
*                                      TO BE PLACED ON THE FREESPACE    04697000
*                                      QUEUE                         */ 04698000
         DEL  (FTREEAD),FREE=NO,TYPE=5                                  04699000
*       GO TO AHLMCPS1;             /* LOOP BACK UNTIL ALL REMAINING    04700000
*                                      ENTRIES ARE DELETED FROM THE     04701000
*                                      MCED                          */ 04702000
         B     AHLMCPS1                                         02S1262 04703000
*       RFY                                                     02S1263 04704000
*         SINKADDR UNRSTD;                                      02S1263 04705000
*                                                               02S1264 04706000
*       /*************************************************************/ 04707000
*       /*                                                           */ 04708000
*       /* ALL ENTRIES HAVE BEEN DELETED FROM THE MCED, AND THEREFORE*/ 04709000
*       /* ALL ITS STORAGE IS DEFINED BY THE FREESPACE QUEUE. THE    */ 04710000
*       /* FOLLOWING CODE FREES ALL MCED STORAGE, STARTING WITH THE  */ 04711000
*       /* PREFIX                                                    */ 04712000
*       /*                                                           */ 04713000
*       /*************************************************************/ 04714000
*                                                               02S1264 04715000
*       RFY                                                     02S1264 04716000
*        (FRSPCELM,                                             02S1264 04717000
*         NXTFRSP) RSTD;                                        02S1264 04718000
*AHLMCPS2:                                                      02S1265 04719000
*       GENERATE;                                               02S1265 04720000
*                                                               02S1265 04721000
AHLMCPS2 DS    0H                                               02S1265 04722000
         USING IGARPTH5,FTREEAD                                         04723000
         L     FRSPCELM,IGAHVFC5     LOAD FREESPACE QUEUE ADDRESS       04724000
         LA    FRSPCELM,0(FRSPCELM)  CLEAR HI BYTE                      04725000
         LA    REG0,IGATYP5S         SET LENGTH TO FREE PREEFIX OF MCED 04726000
         FREEMAIN RU,LV=(0),A=(FTREEAD),BRANCH=(YES,GLOBAL),SP=245      04727000
         DROP  FTREEAD                                                  04728000
*       /*************************************************************/ 04729000
*       /*                                                           */ 04730000
*       /* FREE ALL STORAGE ON THE FREESPACE QUEUE                   */ 04731000
*       /*                                                           */ 04732000
*       /*************************************************************/ 04733000
*                                                               02S1266 04734000
*       DO WHILE(FRSPCELM^=0);      /* IF THERE ARE ELEMENTS ON THE     04735000
*                                      FREESPACE QUEUE, FREE THEM    */ 04736000
         B     @DE01266                                         02S1266 04737000
@DL01266 DS    0H                                               02S1267 04738000
*         NXTFRSP=FRESPLNK;         /* PICK UP ADDRESS OF NEXT  02S1267 04739000
*                                      FREESPACE QUEUE ELEMENT BEOFRE   04740000
*                                      FREEING THIS ONE              */ 04741000
         L     NXTFRSP,FRESPLNK-1(,FRSPCELM)                    02S1267 04742000
         LA    NXTFRSP,0(,NXTFRSP)                              02S1267 04743000
*         DO;                       /* FREEMAIN(RU) LV(LENGTH(FRESPAC   04744000
*                                      E))A(FRESPACE) SP(SQA)   02S1268 04745000
*                                      BRANCH(GLOBAL)                */ 04746000
*           RESPECIFY                                           02S1269 04747000
*            (GPR01F,                                           02S1269 04748000
*             GPR03F,                                           02S1269 04749000
*             GPR00F,                                           02S1269 04750000
*             GPR04P) RESTRICTED;                               02S1269 04751000
*           GPR01F=0;               /* REG 1 MUST BE ZERO            */ 04752000
         SLR   GPR01F,GPR01F                                    02S1270 04753000
*           GPR03F=3;               /* SET TYPE                      */ 04754000
         LA    GPR03F,3                                         02S1271 04755000
*           GPR00F=LENGTH(FRESPACE);/* LENGTH REQUESTED              */ 04756000
         LA    GPR00F,8                                         02S1272 04757000
*           GPR01F=ADDR(FRESPACE);  /* SET REGISTER ONE              */ 04758000
         LR    GPR01F,FRSPCELM                                  02S1273 04759000
*           GPR03F=GPR03F+((SQA)*256);/* SUBPOOL VALUE               */ 04760000
         AL    GPR03F,@CF02506                                  02S1274 04761000
*           GPR04P=WSAGGMFM;        /* POINT TO SAVE AREA            */ 04762000
         L     @15,CVTPTR                                       02S1275 04763000
         L     @02,CVTSPSA(,@15)                                02S1275 04764000
         L     GPR04P,WSAGGMFM(,@02)                            02S1275 04765000
*           CALL CVTGLMN;           /* BRANCH ENTRY POINT            */ 04766000
         L     @15,CVTGLMN(,@15)                                02S1276 04767000
         BALR  @14,@15                                          02S1276 04768000
*           RESPECIFY                                           02S1277 04769000
*            (GPR01F,                                           02S1277 04770000
*             GPR03F,                                           02S1277 04771000
*             GPR00F,                                           02S1277 04772000
*             GPR04P) UNRESTRICTED;                             02S1277 04773000
*         END;                      /* FREEMAIN(RU) LV(LENGTH(FRESPAC   04774000
*                                      E))A(FRESPACE) SP(SQA)   02S1278 04775000
*                                      BRANCH(GLOBAL)                */ 04776000
*         FRSPCELM=NXTFRSP;         /* PICK UP THE NEXT QUEUE ELEMENT   04777000
*                                      FROM WHERE IT WAS SAVED       */ 04778000
         LR    FRSPCELM,NXTFRSP                                 02S1279 04779000
*       END;                        /* LOOP UNTIL ALL FREESPACE 02S1280 04780000
*                                      ELEMENTS ARE FREED            */ 04781000
@DE01266 LTR   FRSPCELM,FRSPCELM                                02S1280 04782000
         BNZ   @DL01266                                         02S1280 04783000
*     END;                          /* END OF MCED FREEING PATH      */ 04784000
*   RFY                                                         02S1282 04785000
*    (FRSPCELM,                                                 02S1282 04786000
*     NXTFRSP,                                                  02S1282 04787000
*     FTREEAD) UNRSTD;                                          02S1282 04788000
@RF01255 DS    0H                                               02S1283 04789000
*                                                               02S1283 04790000
*   /*****************************************************************/ 04791000
*   /*                                                               */ 04792000
*   /* FREE MCCD STORAGE IF IT IS INDICATED TO BE FREED              */ 04793000
*   /*                                                               */ 04794000
*   /*****************************************************************/ 04795000
*                                                               02S1283 04796000
*   IF MCCECDA^=0 THEN                                          02S1283 04797000
         L     @15,MCCECDA(,SRBPARM2)                           02S1283 04798000
         LTR   @15,@15                                          02S1283 04799000
         BZ    @RF01283                                         02S1283 04800000
*     DO;                           /*                       @YM03654*/ 04801000
*       RFY                                                     02S1285 04802000
*         MCCD BASED(MCCECDA);      /*                       @YM03654*/ 04803000
*       DO;                         /* FREEMAIN(RU)             02S1286 04804000
*                                      LV(LENGTH(MCCD))A(MCCD)  02S1286 04805000
*                                      SP(245) BRANCH(GLOBAL)        */ 04806000
*         RESPECIFY                                             02S1287 04807000
*          (GPR01F,                                             02S1287 04808000
*           GPR03F,                                             02S1287 04809000
*           GPR00F,                                             02S1287 04810000
*           GPR04P) RESTRICTED;                                 02S1287 04811000
*         GPR01F=0;                 /* REG 1 MUST BE ZERO            */ 04812000
         SLR   GPR01F,GPR01F                                    02S1288 04813000
*         GPR03F=3;                 /* SET TYPE                      */ 04814000
         LA    GPR03F,3                                         02S1289 04815000
*         GPR00F=LENGTH(MCCD);      /* LENGTH REQUESTED              */ 04816000
         LA    GPR00F,76                                        02S1290 04817000
*         GPR01F=ADDR(MCCD);        /* SET REGISTER ONE              */ 04818000
         LR    GPR01F,@15                                       02S1291 04819000
*         GPR03F=GPR03F+((245)*256);/* SUBPOOL VALUE                 */ 04820000
         AL    GPR03F,@CF02506                                  02S1292 04821000
*         GPR04P=WSAGGMFM;          /* POINT TO SAVE AREA            */ 04822000
         L     @15,CVTPTR                                       02S1293 04823000
         L     @10,CVTSPSA(,@15)                                02S1293 04824000
         L     GPR04P,WSAGGMFM(,@10)                            02S1293 04825000
*         CALL CVTGLMN;             /* BRANCH ENTRY POINT            */ 04826000
         L     @15,CVTGLMN(,@15)                                02S1294 04827000
         BALR  @14,@15                                          02S1294 04828000
*         RESPECIFY                                             02S1295 04829000
*          (GPR01F,                                             02S1295 04830000
*           GPR03F,                                             02S1295 04831000
*           GPR00F,                                             02S1295 04832000
*           GPR04P) UNRESTRICTED;                               02S1295 04833000
*       END;                        /* FREEMAIN(RU)             02S1296 04834000
*                                      LV(LENGTH(MCCD))A(MCCD)  02S1296 04835000
*                                      SP(245) BRANCH(GLOBAL)        */ 04836000
*     END;                                                      02S1297 04837000
*                                                               02S1297 04838000
*   /*****************************************************************/ 04839000
*   /*                                                               */ 04840000
*   /* REMOVE THE FRR, RELEASE THE SALLOC LOCK, AND OBTAIN THE LOCAL */ 04841000
*   /* LOCK FOR BRANCH ENTRY TO POST                                 */ 04842000
*   /*                                                               */ 04843000
*   /*****************************************************************/ 04844000
*                                                               02S1298 04845000
*   GENERATE;                                                   02S1298 04846000
@RF01283 DS    0H                                               02S1298 04847000
         SETFRR D,WRKREGS=(11,12)                                       04848000
AHLMCP03 SETLOCK RELEASE,TYPE=SALLOC,                                  *04849000
               RELATED=(MCCEFREE,AHLSETEV,AHLMCP02)                     04850000
AHLMCP04 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                        *04851000
               RELATED=(MCCEPOST,AHLSETEV,AHLMCP05)                     04852000
*   RFY                                                         02S1299 04853000
*    (ECBCODE,                                                  02S1299 04854000
*     SRBECB) RSTD;                                             02S1299 04855000
*   ECBCODE=0;                      /* SET THE COMPLETION CODE TO       04856000
*                                      ZERO                          */ 04857000
         SLR   ECBCODE,ECBCODE                                  02S1300 04858000
*   SRBECB=ADDR(MCCEECB);           /* POINT TO THE ECB IN THE MCCE  */ 04859000
         LA    SRBECB,MCCEECB(,SRBPARM2)                        02S1301 04860000
*   CALL BRPOST;                                                02S1302 04861000
         L     @06,CVTPTR                                       02S1302 04862000
         L     @15,CVT0PT01(,@06)                               02S1302 04863000
         BALR  @14,@15                                          02S1302 04864000
*   RFY                                                         02S1303 04865000
*    (ECBCODE,                                                  02S1303 04866000
*     SRBECB) UNRSTD;                                           02S1303 04867000
*   GENERATE;                                                   02S1304 04868000
AHLMCP05 SETLOCK RELEASE,TYPE=LOCAL,                                   *04869000
               RELATED=(MCCEPOST,AHLSETEV,AHLMCP04)                     04870000
*   GO TO FRRRET;                   /* RETURN TO THE SYSTEM  @YM01899*/ 04871000
         L     @15,FRRRET(,FRRLIST)                             02S1305 04872000
         BR    @15                                              02S1305 04873000
*   GEN(DROP    BASEREG);           /*                       @YM01899*/ 04874000
         DROP    BASEREG                                                04875000
*                                                               01S1307 04876000
*   /*****************************************************************/ 04877000
*   /*                                                               */ 04878000
*   /* ERROR RECOVERY ROUTINES                                       */ 04879000
*   /*                                                               */ 04880000
*   /*****************************************************************/ 04881000
*                                                               01S1307 04882000
*                                                               02S1307 04883000
*   /*****************************************************************/ 04884000
*   /*                                                               */ 04885000
*   /* AHLSETES - THIS IS THE ESTAE ROUTINE FOR AHLSETEV             */ 04886000
*   /*                                                               */ 04887000
*   /*****************************************************************/ 04888000
*                                                               02S1307 04889000
*   RFY                                                         02S1307 04890000
*    (ESTAECOD,                                                 02S1307 04891000
*     RETURNAD,                                                 02S1307 04892000
*     TEMPREG,                                                  02S1307 04893000
*     R1PLSTAD) RSTD;                                           02S1307 04894000
*                                                               02S1307 04895000
*   /*****************************************************************/ 04896000
*   /*                                                               */ 04897000
*   /* TEMPORARY ADDRESSIBILITY                                      */ 04898000
*   /*                                                               */ 04899000
*   /*****************************************************************/ 04900000
*                                                               02S1308 04901000
*   GEN(USING *,TEMPREG);                                       02S1308 04902000
         USING *,TEMPREG                                                04903000
*AHLSETES:                                                      02S1309 04904000
*   IF ESTAECOD=NORTCA THEN                                     02S1309 04905000
AHLSETES C     ESTAECOD,@CF00034                                02S1309 04906000
         BNE   @RF01309                                         02S1309 04907000
*     DO;                           /* IF THE RTCA IS NOT AVAILABLE,    04908000
*                                      CONTINUE WITH TERMINATION     */ 04909000
*       RETCOD15=SDWACWT;           /* SET PROPER RETURN CODE        */ 04910000
         SLR   RETCOD15,RETCOD15                                02S1311 04911000
*       GO TO RETURNAD;                                         02S1312 04912000
         BR    RETURNAD                                         02S1312 04913000
*     END;                                                      02S1313 04914000
*                                                               02S1313 04915000
*   /*****************************************************************/ 04916000
*   /*                                                               */ 04917000
*   /* SET UP ESTAE ROUTINE ADDRESSIBILITY TO SAVE AREAS, ETC        */ 04918000
*   /*                                                               */ 04919000
*   /*****************************************************************/ 04920000
*                                                               02S1314 04921000
*   GENERATE;                                                   02S1314 04922000
@RF01309 DS    0H                                               02S1314 04923000
         STM   14,12,12(13)                                             04924000
         LM    BASER1,BASER2,AHLBASES   LOAD BASE REGS WITH ORIGINAL    04925000
         USING @PSTART,BASER1                                           04926000
         USING @PSTART+4095,BASER2                                      04927000
         DROP  TEMPREG                                                  04928000
*   RFY                                                         02S1315 04929000
*     SDWA BASED(R1PLSTAD);         /*                       @YM01899*/ 04930000
*   BASER3=SDWAPARM;                /* LOAD WORK AREA ADDRESS        */ 04931000
         L     BASER3,SDWAPARM(,R1PLSTAD)                       02S1316 04932000
*   ESTAESAV(2)=SAVEAREA;           /* BACK CHAIN SAVE AREAS         */ 04933000
         ST    SAVEAREA,ESTAESAV+4                              02S1317 04934000
*   FORCHAIN=ADDR(ESTAESAV);        /* FORWARD CHAIN SAVE AREAS      */ 04935000
         LA    @10,ESTAESAV                                     02S1318 04936000
         ST    @10,FORCHAIN(,SAVEAREA)                          02S1318 04937000
*   SAVEAREA=ADDR(ESTAESAV);        /* POINT TO CURRENT              */ 04938000
         LR    SAVEAREA,@10                                     02S1319 04939000
*   SDWAPTR=R1PLSTAD;               /* SAVE RTCA ADDRESS             */ 04940000
         LR    SDWAPTR,R1PLSTAD                                 02S1320 04941000
*   RFY                                                         02S1321 04942000
*     SDWA BASED(SDWAPTR);          /*                       @YM01899*/ 04943000
*                                                               02S1321 04944000
*   /*****************************************************************/ 04945000
*   /*                                                               */ 04946000
*   /* ADDRESSIBILITY HAS BEEN SET UP - CHECK FOR ACR ENTRY. IF ALL  */ 04947000
*   /* IS OK FOR RETRY AT THE INTERRUPTED ADDRESS, DO SO CONTINUE    */ 04948000
*   /* WITH TERMINATION IF IT IS NOT A PROGRAM CHECK                 */ 04949000
*   /*                                                               */ 04950000
*   /*****************************************************************/ 04951000
*                                                               02S1322 04952000
*   IF SDWAPCHK='0'B THEN                                       02S1322 04953000
         TM    SDWAPCHK(SDWAPTR),B'01000000'                    02S1322 04954000
         BNZ   @RF01322                                         02S1322 04955000
*     DO;                                                       02S1323 04956000
*       DO;                         /* DEQ (SETQNM,SETRNM,3,SYSTEMS)    04957000
*                                      RET(HAVE)                     */ 04958000
*         I048(1:20)=I048(1:20)&&I048(1:20);                    02S1325 04959000
         XC    I048(20),I048                                    02S1325 04960000
*         RFY                                                   02S1326 04961000
*           GPR01F RESTRICTED;                                  02S1326 04962000
*         I04804(1)='11000000'B;    /* LISTEND BYTE                  */ 04963000
         MVI   I04804,B'11000000'                               02S1327 04964000
*         I04805(1)=3;              /* SET LENGTH                    */ 04965000
         MVI   I04805,X'03'                                     02S1328 04966000
*         I04806(1)='01001001'B;    /* OPTIONS                       */ 04967000
         MVI   I04806,B'01001001'                               02S1329 04968000
*         I04807(1)=ADDR(SETQNM);   /* QNAME ADDRESS                 */ 04969000
         LA    @10,@CC00164                                     02S1330 04970000
         ST    @10,I04807                                       02S1330 04971000
*         I04808(1)=ADDR(SETRNM);   /* RNAME ADDRESS                 */ 04972000
         LA    @10,@CC00166                                     02S1331 04973000
         ST    @10,I04808                                       02S1331 04974000
*         GPR01F=ADDR(I04802);                                  02S1332 04975000
         LA    GPR01F,I04802                                    02S1332 04976000
*         SVC(48);                                              02S1333 04977000
         SVC   48                                               02S1333 04978000
*         RFY                                                   02S1334 04979000
*           GPR01F UNRESTRICTED;                                02S1334 04980000
*       END;                        /* DEQ (SETQNM,SETRNM,3,SYSTEMS)    04981000
*                                      RET(HAVE)             @YM03654*/ 04982000
*       DO;                         /* SETRP RC(SDWACWT)             */ 04983000
*         RESPECIFY                                             02S1337 04984000
*          (GPR00P,                                             02S1337 04985000
*           GPR01P,                                             02S1337 04986000
*           GPR14P,                                             02S1337 04987000
*           GPR15P) RSTD;                                       02S1337 04988000
*         GPR01P->SDWARCDE=SDWACWT; /* SAVE RC VALUE                 */ 04989000
         MVI   SDWARCDE(GPR01P),X'00'                           02S1338 04990000
*         RESPECIFY                                             02S1339 04991000
*          (GPR00P,                                             02S1339 04992000
*           GPR01P,                                             02S1339 04993000
*           GPR14P,                                             02S1339 04994000
*           GPR15P) UNRSTD;                                     02S1339 04995000
*       END;                        /*                       @YM03654*/ 04996000
*       GO TO AHLESTX;              /* EXIT FROM THE ESTAE ROUTINE   */ 04997000
         B     AHLESTX                                          02S1341 04998000
*     END;                                                      02S1342 04999000
*                                                               02S1343 05000000
*   /*****************************************************************/ 05001000
*   /*                                                               */ 05002000
*   /* A PROGRAM CHECK HAS OCCURRED DURING AHLSETEV. INVESTIGATE THE */ 05003000
*   /* PARAMETER LIST TO DETERMINE IF THAT WAS THE CAUSE. ESTAE      */ 05004000
*   /* ROUTINE AHLPLERR IS SET UP WHILE REFERENCING ALL BYTES        */ 05005000
*   /* ASSOCIATED WITH THE PLIST. IF A PROGRAM CHECK OCCURS DURING   */ 05006000
*   /* THIS REFERENCING, AHLPLERR WILL ABEND THE SETEVENT CALLER DUE */ 05007000
*   /* TO AN INVALID PARAMETER LIST                                  */ 05008000
*   /*                                                               */ 05009000
*   /*****************************************************************/ 05010000
*                                                               02S1343 05011000
*   GENERATE;                                                   02S1343 05012000
@RF01322 DS    0H                                               02S1343 05013000
         XC    ESTAELST(4),ESTAELST                                     05014000
         ESTAE AHLPLERR,CT,MF=(E,ESTAELST)    ESTABLISH ERROR RECOVERY  05015000
*   RFY                                                         02S1344 05016000
*    (WORKREG,                                                  02S1344 05017000
*     TEMPREG) RSTD;                                            02S1344 05018000
*   WORKREG=SETOPTS;                /* REFERENCE 1ST BYTE OF    02S1345 05019000
*                                      PARAMETER LIST                */ 05020000
         L     @10,PLISTAD                                      02S1345 05021000
         SLR   WORKREG,WORKREG                                  02S1345 05022000
         IC    WORKREG,SETOPTS(,@10)                            02S1345 05023000
*   WORKREG=PASSEDQE;               /* REFERENCE LAST BYTE OF PLIST  */ 05024000
         ICM   WORKREG,15,PASSEDQE(@10)                         02S1346 05025000
*   IF EIDNUM^=0 THEN                                           02S1347 05026000
         CLI   EIDNUM(@10),0                                    02S1347 05027000
         BE    @RF01347                                         02S1347 05028000
*     DO;                           /* IF THE ISSUER SPECIFIED AN EID   05029000
*                                      LIST, REFERENCE FIRST AND LAST   05030000
*                                      BYTES OF IT                   */ 05031000
*       TEMPREG=EIDLSTAD;           /* FIND THE EID LIST             */ 05032000
         ICM   TEMPREG,15,EIDLSTAD(@10)                         02S1349 05033000
*       GEN(IC    WORKREG,0(TEMPREG));/* REFERENCE FIRST BYTE        */ 05034000
         IC    WORKREG,0(TEMPREG)                                       05035000
*       TEMPREG=TEMPREG+(EIDNUM*6)-1;/* FIND LAST BYTE               */ 05036000
         L     @10,PLISTAD                                      02S1351 05037000
         SLR   @06,@06                                          02S1351 05038000
         IC    @06,EIDNUM(,@10)                                 02S1351 05039000
         MH    @06,@CH00250                                     02S1351 05040000
         ALR   @06,TEMPREG                                      02S1351 05041000
         BCTR  @06,0                                            02S1351 05042000
         LR    TEMPREG,@06                                      02S1351 05043000
*       GEN(IC    WORKREG,0(TEMPREG));/* REFERENCE LAST BYTE         */ 05044000
         IC    WORKREG,0(TEMPREG)                                       05045000
*     END;                                                      02S1353 05046000
*   IF CLSNUM^=0 THEN                                           02S1354 05047000
@RF01347 L     @10,PLISTAD                                      02S1354 05048000
         CLI   CLSNUM(@10),0                                    02S1354 05049000
         BE    @RF01354                                         02S1354 05050000
*     DO;                           /* IF THE ISSUER SPECIFIED A        05051000
*                                      CLASS LIST, REFERENCE FIRST      05052000
*                                      AND LAST BYTES OF IT          */ 05053000
*       TEMPREG=CLSLSTAD;           /* FIND THE CLASS LIST           */ 05054000
         ICM   TEMPREG,15,CLSLSTAD(@10)                         02S1356 05055000
*       GEN(IC    WORKREG,0(TEMPREG));/* REFERENCE FIRST BYTE        */ 05056000
         IC    WORKREG,0(TEMPREG)                                       05057000
*       TEMPREG=TEMPREG+(CLSNUM*6)-1;/* FIND LAST BYTE               */ 05058000
         L     @10,PLISTAD                                      02S1358 05059000
         SLR   @06,@06                                          02S1358 05060000
         IC    @06,CLSNUM(,@10)                                 02S1358 05061000
         MH    @06,@CH00250                                     02S1358 05062000
         ALR   @06,TEMPREG                                      02S1358 05063000
         BCTR  @06,0                                            02S1358 05064000
         LR    TEMPREG,@06                                      02S1358 05065000
*       GEN(IC    WORKREG,0(TEMPREG));/* REFERENCE LAST BYTE         */ 05066000
         IC    WORKREG,0(TEMPREG)                                       05067000
*     END;                                                      02S1360 05068000
*                                                               02S1360 05069000
*   /*****************************************************************/ 05070000
*   /*                                                               */ 05071000
*   /* USERS PARAMETER LIST HAS CHECKED OUT - A PROGRAM CHECK MUST   */ 05072000
*   /* HAVE OCCURRED IN THE MC TABLES. TAKE A DUMP AND TERMINATE THE */ 05073000
*   /* ROUTING FACILITY                                              */ 05074000
*   /*                                                               */ 05075000
*   /*****************************************************************/ 05076000
*                                                               02S1361 05077000
*   GENERATE;                                                   02S1361 05078000
@RF01354 DS    0H                                               02S1361 05079000
         XC    ESTAELST(4),ESTAELST                                     05080000
         ESTAE AHLTBERR,OV,MF(E,ESTAELST)  OVERLAY AHLPLERR             05081000
*   RFY                                                         02S1362 05082000
*     MCHEAD BASED(CVTGTF);                                     02S1362 05083000
*   RFY                                                         02S1363 05084000
*    (WORKREG,                                                  02S1363 05085000
*     TEMPREG) UNRSTD;                                          02S1363 05086000
*   MCHACT='0'B;                    /* DISABLE ROUTING               */ 05087000
         L     @15,CVTPTR                                       02S1364 05088000
         L     @15,CVTGTF(,@15)                                 02S1364 05089000
         NI    MCHACT(@15),B'01111111'                          02S1364 05090000
*   DO;                             /* WTOP MF(E,AHL132)             */ 05091000
*     RFY                                                       02S1366 05092000
*       GPR01P RSTD;                /* RESTRICT REG 1                */ 05093000
*     GPR01P=ADDR(AHL132);          /* ADDRESS CONTROL PROGRAM LIST  */ 05094000
         L     GPR01P,@CA00150                                  02S1367 05095000
*     SVC(35);                      /* ISSUE WTO SVC                 */ 05096000
         SVC   35                                               02S1368 05097000
*     RFY                                                       02S1369 05098000
*       GPR01P UNRSTD;              /* RELEASE REG 1                 */ 05099000
*   END;                            /* WTOP MF(E,AHL132) NOTIFY OF      05100000
*                                      ROUTING FAILURE               */ 05101000
*   GEN(SDUMP HDR='ERROR IN AHLSETEV',SDATA=SQA);/* TAKE A DUMP      */ 05102000
         SDUMP HDR='ERROR IN AHLSETEV',SDATA=SQA                        05103000
*   RFY                                                         02S1372 05104000
*     MCCE BASED(MCHCUR);                                       02S1372 05105000
*   RFY                                                         02S1373 05106000
*     SRBPTR RSTD;                                              02S1373 05107000
*                                                               02S1373 05108000
*   /*****************************************************************/ 05109000
*   /*                                                               */ 05110000
*   /* SET UP THE SRB IN THE CURRENT MCCE TO SCHEDULE ROUTINE        */ 05111000
*   /* AHLMCPST TO POST ALL APPLICATIONS TO TERMINATE                */ 05112000
*   /*                                                               */ 05113000
*   /*****************************************************************/ 05114000
*                                                               02S1374 05115000
*   SRBPTR=ADDR(MCCESRB);           /* POINT TO CORRECT SRB          */ 05116000
         L     @15,CVTPTR                                       02S1374 05117000
         L     @15,CVTGTF(,@15)                                 02S1374 05118000
         L     @15,MCHCUR(,@15)                                 02S1374 05119000
         LA    SRBPTR,MCCESRB(,@15)                             02S1374 05120000
*   SRBEP=ADDR(AHLMCPST);           /* CHANGE EP TO CORRECT ROUTINE  */ 05121000
         LA    @10,AHLMCPST                                     02S1375 05122000
         ST    @10,SRBEP(,SRBPTR)                               02S1375 05123000
*   SRBASCB=PSAAOLD;                /* HAVE IT RUN IN THIS MEMORY    */ 05124000
         L     @10,PSAAOLD                                      02S1376 05125000
         ST    @10,SRBASCB(,SRBPTR)                             02S1376 05126000
*   RFY                                                         02S1377 05127000
*     SRBPTR UNRSTD;                                            02S1377 05128000
*   MCCEPTR=MCHCUR;                 /* POINT TO MCCE TO BE REPLACED  */ 05129000
         ST    @15,MCCEPTR                                      02S1378 05130000
*   NEWMCCE=0;                      /* NEWW MCCE ADDRESS TO BE USED     05131000
*                                      IS ZERO                       */ 05132000
         SLR   @15,@15                                          02S1379 05133000
         ST    @15,NEWMCCE                                      02S1379 05134000
*   CALL CSDMCCE;                   /* CALL SUBROUTINE TO SWAP ZERO     05135000
*                                      IN FOR MCCE ADDRESS, AND 02S1380 05136000
*                                      SCHEDULE SRB                  */ 05137000
         BAL   @14,CSDMCCE                                      02S1380 05138000
*   RFY                                                         02S1381 05139000
*     MCCE BASED(MCCEPTR);                                      02S1381 05140000
*   DO;                             /* WAIT ECB(MCCEECB)             */ 05141000
*     RESPECIFY                                                 02S1383 05142000
*      (GPR00P,                                                 02S1383 05143000
*       GPR01P) RESTRICTED;                                     02S1383 05144000
*     GPR00P=1;                     /* LOAD WAIT COUNT               */ 05145000
         LA    GPR00P,1                                         02S1384 05146000
*     GPR01P=ADDR(MCCEECB);         /* ADDRESS OF ECB                */ 05147000
         L     GPR01P,MCCEPTR                                   02S1385 05148000
         LA    GPR01P,MCCEECB(,GPR01P)                          02S1385 05149000
*     SVC(1);                       /* WAIT SVC                      */ 05150000
         SVC   1                                                02S1386 05151000
*     RESPECIFY                                                 02S1387 05152000
*      (GPR00P,                                                 02S1387 05153000
*       GPR01P) UNRESTRICTED;                                   02S1387 05154000
*   END;                            /* WAIT ECB(MCCEECB) WAIT FOR SRB   05155000
*                                      ROUTINE AHLMCPST TO POST ECB     05156000
*                                      IN MCCE TO SIGNAL THAT IT IS     05157000
*                                      DONE.                         */ 05158000
*                                                               02S1388 05159000
*   /*****************************************************************/ 05160000
*   /*                                                               */ 05161000
*   /* FINISH CLEANING UP BY FREEING THE MCCE, PGFREEING MODULE      */ 05162000
*   /* AHLSETD, AND CLEARING THE CONTROL REGISTER MASK.              */ 05163000
*   /*                                                               */ 05164000
*   /*****************************************************************/ 05165000
*                                                               02S1389 05166000
*   DO;                             /* FREEMAIN (E) LV(LENGTH(MCCE))    05167000
*                                      A(MCCEPTR) SP(SQA)            */ 05168000
*     RESPECIFY                                                 02S1390 05169000
*      (GPR01P) RESTRICTED;                                     02S1390 05170000
*     I005=I005&&I005;              /* INIT LIST                     */ 05171000
         XC    I005(10),I005                                    02S1391 05172000
*     I00505='00'X;                 /* SET TYPE                      */ 05173000
         MVI   I00505,X'00'                                     02S1392 05174000
*     I00502=LENGTH(MCCE);          /* LENGTH                        */ 05175000
         MVC   I00502(3),@CF02504+1                             02S1393 05176000
*     I00504=ADDR(MCCEPTR);         /* ADDR OF ADDR LIST             */ 05177000
         LA    @15,MCCEPTR                                      02S1394 05178000
         STCM  @15,7,I00504                                     02S1394 05179000
*     I00506=SQA;                   /* SUBPOOL VALUE                 */ 05180000
         MVI   I00506,X'F5'                                     02S1395 05181000
*     GPR01P=ADDR(I005);            /* REG1 POINTS TO LIST           */ 05182000
         LA    GPR01P,I005                                      02S1396 05183000
*     SVC(5);                       /* STANDARD-FORM OF GETMAIN      */ 05184000
         SVC   5                                                02S1397 05185000
*     RESPECIFY                                                 02S1398 05186000
*      (GPR01P) UNRESTRICTED;                                   02S1398 05187000
*   END;                            /* FREEMAIN (E) LV(LENGTH(MCCE))    05188000
*                                      A(MCCEPTR) SP(SQA) FREE THE      05189000
*                                      MCCE SINCE ALL ARE DONE WITH     05190000
*                                      IT                            */ 05191000
*   DO;                             /* PGFREE(R) A(SETDPTR)          */ 05192000
*     RESPECIFY                                                 02S1401 05193000
*      (GPR00P,                                                 02S1401 05194000
*       GPR01P) RESTRICTED;                                     02S1401 05195000
*     GPR00P=0;                     /* INDICATE NO PAGE ECB          */ 05196000
         SLR   GPR00P,GPR00P                                    02S1402 05197000
*     GPR01P=ADDR(SETDPTR);         /* PAGE ADDR                     */ 05198000
         L     @15,CVTPTR                                       02S1403 05199000
         L     @15,CVTGTF(,@15)                                 02S1403 05200000
         L     @15,MCHSETD(,@15)                                02S1403 05201000
         LR    GPR01P,@15                                       02S1403 05202000
*     RESPECIFY                                                 02S1404 05203000
*       GPR15P RESTRICTED;                                      02S1404 05204000
*     GPR15P=ADDR(SETDPTR)+1;       /* VSL ADDR OMITTED              */ 05205000
         ST    @15,@TF00001                                     02S1405 05206000
         LA    GPR15P,1                                         02S1405 05207000
         AL    GPR15P,@TF00001                                  02S1405 05208000
*     GPR01P=GPR01P|'20000000'X;    /* R, PGFREE & RELEASE FLAG      */ 05209000
         O     GPR01P,@CF02311                                  02S1406 05210000
*     SVC(113);                     /* ISSUE PGFREE SVC              */ 05211000
         SVC   113                                              02S1407 05212000
*     RESPECIFY                                                 02S1408 05213000
*      (GPR00P,                                                 02S1408 05214000
*       GPR01P,                                                 02S1408 05215000
*       GPR15P) UNRESTRICTED;                                   02S1408 05216000
*   END;                            /* PGFREE(R) A(SETDPTR) FREE        05217000
*                                      AHLSETD PAGE SINCE IT IS NO      05218000
*                                      LONGER REQUIRED TO BE FIXED   */ 05219000
*   MCHCTL=0;                       /* SET THE CONTROL REGISTER MASK    05220000
*                                      TO ZERO                       */ 05221000
         L     @15,CVTPTR                                       02S1410 05222000
         L     @15,CVTGTF(,@15)                                 02S1410 05223000
         SLR   @10,@10                                          02S1410 05224000
         ST    @10,MCHCTL(,@15)                                 02S1410 05225000
*   CALL CR8SET;                    /* SET THE CONTROL REGISTER ON      05226000
*                                      ALL CPUS                      */ 05227000
         BAL   @14,CR8SET                                       02S1411 05228000
*   GEN(ESTAE 0);                   /* REMOVE THE ESTAE              */ 05229000
         ESTAE 0                                                        05230000
*AHLTBERR:                                                      02S1413 05231000
*   RTRNCODE=TERMPHSE;              /* SET TERMINATION RETURN CODE TO   05232000
*                                      ISSUER                        */ 05233000
AHLTBERR MVC   RTRNCODE(4),@CF00097                             02S1413 05234000
*   R1PLSTAD=SDWAPTR;               /* FIND RTCA                     */ 05235000
         LR    R1PLSTAD,SDWAPTR                                 02S1414 05236000
*   DO;                             /* SETRP RETADDR(AHLEXIT)RETREGS(   05237000
*                                      YES)RC(SDWARETY)FRESDWA(YES)  */ 05238000
*     RESPECIFY                                                 02S1416 05239000
*      (GPR00P,                                                 02S1416 05240000
*       GPR01P,                                                 02S1416 05241000
*       GPR14P,                                                 02S1416 05242000
*       GPR15P) RSTD;                                           02S1416 05243000
*     GPR01P->SDWARCDE=SDWARETY;    /* STORE RC INTO SDWA            */ 05244000
         MVI   SDWARCDE(GPR01P),X'04'                           02S1417 05245000
*     GPR01P->SDWARTYA=ADDR(AHLEXIT);/* SAVE RETRY ADDRESS           */ 05246000
         LA    @10,AHLEXIT                                      02S1418 05247000
         ST    @10,SDWARTYA(,GPR01P)                            02S1418 05248000
*     GPR01P->SDWAFREE='1'B;        /* SET FLAG TO FREE SDWA         */ 05249000
*     GPR01P->SDWAUPRG='1'B;        /* TURN ON RETREGS INDICATOR     */ 05250000
         OI    SDWAFREE(GPR01P),B'00001100'                     02S1420 05251000
*     RESPECIFY                                                 02S1421 05252000
*      (GPR00P,                                                 02S1421 05253000
*       GPR01P,                                                 02S1421 05254000
*       GPR14P,                                                 02S1421 05255000
*       GPR15P) UNRSTD;                                         02S1421 05256000
*   END;                            /*                       @ZA27501   05257000
*                                      OZ27501                       */ 05258000
*AHLESTX:                                                       02S1423 05259000
*   GENERATE;                                                   02S1423 05260000
AHLESTX  DS    0H                                               02S1423 05261000
         L     SAVEAREA,4(SAVEAREA)                                     05262000
         LM    14,12,12(SAVEAREA)                                       05263000
         BR    RETURNAD                                                 05264000
*                                                               02S1424 05265000
*   /*****************************************************************/ 05266000
*   /*                                                               */ 05267000
*   /* THE FOLLOWING ESATE ROUTINE WILL RECEIVE CONTROL IF A PROGRAM */ 05268000
*   /* CHECK OCCURS WHILE INVESTIGATING THE ISSUERS PARAMETER LIST   */ 05269000
*   /*                                                               */ 05270000
*   /*****************************************************************/ 05271000
*                                                               02S1424 05272000
*   RFY                                                         02S1424 05273000
*     ABNDCODE RSTD;                                            02S1424 05274000
*   GEN(USING *,TEMPREG);                                       02S1425 05275000
         USING *,TEMPREG                                                05276000
*AHLPLERR:                                                      02S1426 05277000
*   DO;                             /* DEQ (SETQNM,SETRNM,3,SYSTEMS)    05278000
*                                      RET(HAVE)                     */ 05279000
AHLPLERR DS    0H                                               02S1427 05280000
*     I048(1:20)=I048(1:20)&&I048(1:20);                        02S1427 05281000
         XC    I048(20),I048                                    02S1427 05282000
*     RFY                                                       02S1428 05283000
*       GPR01F RESTRICTED;                                      02S1428 05284000
*     I04804(1)='11000000'B;        /* LISTEND BYTE                  */ 05285000
         MVI   I04804,B'11000000'                               02S1429 05286000
*     I04805(1)=3;                  /* SET LENGTH                    */ 05287000
         MVI   I04805,X'03'                                     02S1430 05288000
*     I04806(1)='01001001'B;        /* OPTIONS                       */ 05289000
         MVI   I04806,B'01001001'                               02S1431 05290000
*     I04807(1)=ADDR(SETQNM);       /* QNAME ADDRESS                 */ 05291000
         LA    @10,@CC00164                                     02S1432 05292000
         ST    @10,I04807                                       02S1432 05293000
*     I04808(1)=ADDR(SETRNM);       /* RNAME ADDRESS                 */ 05294000
         LA    @10,@CC00166                                     02S1433 05295000
         ST    @10,I04808                                       02S1433 05296000
*     GPR01F=ADDR(I04802);                                      02S1434 05297000
         LA    GPR01F,I04802                                    02S1434 05298000
*     SVC(48);                                                  02S1435 05299000
         SVC   48                                               02S1435 05300000
*     RFY                                                       02S1436 05301000
*       GPR01F UNRESTRICTED;                                    02S1436 05302000
*   END;                            /* DEQ (SETQNM,SETRNM,3,SYSTEMS)    05303000
*                                      RET(HAVE)                     */ 05304000
*   ABNDCODE=BADOPT;                /* INDICATE INVALID PARAMETER       05305000
*                                      LIST                          */ 05306000
         LA    ABNDCODE,4                                       02S1438 05307000
*   DO;                             /* ABEND(SETCMPCD) DUMP SYSTEM   */ 05308000
*     RESPECIFY                                                 02S1440 05309000
*      (GPR01F) RESTRICTED;                                     02S1440 05310000
*     GPR01F=((SETCMPCD)&'00000FFF'X)*4096;/* COMP CODE IN BITS 8-19 */ 05311000
         L     GPR01F,@CF02503                                  02S1441 05312000
*     GPR01F=GPR01F|'80000000'X;    /* DUMP/STEP/DUMPOPTS FLAG       */ 05313000
         O     GPR01F,@CF02273                                  02S1442 05314000
*     SVC(13);                      /* ISSUE ABEND SVC               */ 05315000
         SVC   13                                               02S1443 05316000
*     RESPECIFY                                                 02S1444 05317000
*      (GPR01F) UNRESTRICTED;                                   02S1444 05318000
*   END;                            /* ABEND(SETCMPCD) DUMP SYSTEM      05319000
*                                      ABEND CALLER WITH NEW CODE    */ 05320000
*   RFY                                                         02S1446 05321000
*     ABNDCODE UNRSTD;                                          02S1446 05322000
*   GEN(DROP TEMPREG);                                          02S1447 05323000
         DROP TEMPREG                                                   05324000
*                                                               02S1448 05325000
*   /*****************************************************************/ 05326000
*   /*                                                               */ 05327000
*   /* AHLTFFRR FRR ROUTINE - THIS ROUTINE WILL RECEIVE CONTROL IS   */ 05328000
*   /* SRB ROUTINES AHLTFREE OR AHLMCPST ENCOUNTER AN ERRO DURING    */ 05329000
*   /* THEIR PROCESSING. ITS JOB IS TO POST THE ECB IN THE MCCE IF   */ 05330000
*   /* NECESSARY                                                     */ 05331000
*   /*                                                               */ 05332000
*   /*****************************************************************/ 05333000
*                                                               02S1448 05334000
*AHLTFFRR:                                                      02S1448 05335000
*   GENERATE;                                                   02S1448 05336000
AHLTFFRR DS    0H                                               02S1448 05337000
         BALR  BASEREG,0                                                05338000
         USING *,BASEREG                                                05339000
*   SRBPARM2=SRBPARM1;              /* SAVE RTCA ADDRESS             */ 05340000
         LR    SRBPARM2,SRBPARM1                                02S1449 05341000
*   SRBRTRN=RETURNAD;               /* SAVE RETURN ADDRESS           */ 05342000
         LR    SRBRTRN,RETURNAD                                 02S1450 05343000
*   RFY                                                         02S1451 05344000
*     SDWA BASED(SRBPARM2);                                     02S1451 05345000
*   RFY                                                         02S1452 05346000
*     FRRPARMS BASED(SDWAPARM);                                 02S1452 05347000
*   RFY                                                         02S1453 05348000
*     MCCE BASED(FRRTABL);                                      02S1453 05349000
*   IF FRRTABLE^=0 THEN                                         02S1454 05350000
         L     @15,SDWAPARM(,SRBPARM2)                          02S1454 05351000
         L     @10,FRRTABLE-1(,@15)                             02S1454 05352000
         LA    @10,0(,@10)                                      02S1454 05353000
         LTR   @10,@10                                          02S1454 05354000
         BZ    @RF01454                                         02S1454 05355000
*     DO;                           /* A NON-ZERO MCCE ADDRESS  02S1455 05356000
*                                      INDICATES THAT MCCEECB IS TO     05357000
*                                      BE POSTED                     */ 05358000
*       IF FRRSALOC='80'X THEN                                  02S1456 05359000
         CLI   FRRSALOC(@15),128                                02S1456 05360000
         BNE   @RF01456                                         02S1456 05361000
*         DO;                       /*                       @YM03652*/ 05362000
*           GENERATE;                                           02S1458 05363000
AHLTFF11 SETLOCK RELEASE,TYPE=SALLOC,                                  *05364000
               RELATED=(MCCEPOST,AHLSETEV(AHLTFR00))                    05365000
*         END;                                                  02S1459 05366000
*                                                               02S1459 05367000
*       /*************************************************************/ 05368000
*       /*                                                           */ 05369000
*       /* POST MCCEECB VIA BRANCH ENTRY                             */ 05370000
*       /*                                                           */ 05371000
*       /*************************************************************/ 05372000
*                                                               02S1460 05373000
*       GENERATE;                                               02S1460 05374000
@RF01456 DS    0H                                               02S1460 05375000
AHLTFF01 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                        *05376000
               RELATED=(MCCEPOST,AHLSETEV(AHLTFF02))                    05377000
*       RFY                                                     02S1461 05378000
*        (ECBCODE,                                              02S1461 05379000
*         SRBECB) RSTD;                                         02S1461 05380000
*       ECBCODE=TFFERROR;           /* SET POSTING CODE TO INDICATE     05381000
*                                      ERROR                         */ 05382000
         LA    ECBCODE,4                                        02S1462 05383000
*       SRBECB=ADDR(MCCEECB);       /* POINT AT ECB TO POST          */ 05384000
         L     @15,SDWAPARM(,SRBPARM2)                          02S1463 05385000
         L     SRBECB,FRRTABL(,@15)                             02S1463 05386000
         LA    SRBECB,MCCEECB(,SRBECB)                          02S1463 05387000
*       CALL BRPOST;                /* POST THE ECB                  */ 05388000
         L     @06,CVTPTR                                       02S1464 05389000
         L     @15,CVT0PT01(,@06)                               02S1464 05390000
         BALR  @14,@15                                          02S1464 05391000
*       RFY                                                     02S1465 05392000
*        (ECBCODE,                                              02S1465 05393000
*         SRBECB) UNRSTD;                                       02S1465 05394000
*       GENERATE;                                               02S1466 05395000
*               /* FREE THE LOCAL LOCK */                               05396000
AHLTFF02 SETLOCK RELEASE,TYPE=LOCAL,                                   *05397000
               RELATED=(MCCEPOST,AHLSETEV(AHLTFF01))                    05398000
*     END;                                                      02S1467 05399000
*   DO;                             /* SETRP                    02S1468 05400000
*                                      WRKAREA(SRBPARM2)RC(SDWACWT)  */ 05401000
@RF01454 DS    0H                                               02S1469 05402000
*     RESPECIFY                                                 02S1469 05403000
*      (GPR00P,                                                 02S1469 05404000
*       GPR01P,                                                 02S1469 05405000
*       GPR14P,                                                 02S1469 05406000
*       GPR15P) RSTD;                                           02S1469 05407000
*     GPR01P->SDWARCDE=SDWACWT;     /* SAVE RC VALUE                 */ 05408000
         MVI   SDWARCDE(GPR01P),X'00'                           02S1470 05409000
*     RESPECIFY                                                 02S1471 05410000
*      (GPR00P,                                                 02S1471 05411000
*       GPR01P,                                                 02S1471 05412000
*       GPR14P,                                                 02S1471 05413000
*       GPR15P) UNRSTD;                                         02S1471 05414000
*   END;                            /* LET THE ERROR CONTINUE        */ 05415000
*   GO TO SRBRTRN;                                              02S1473 05416000
         BR    SRBRTRN                                          02S1473 05417000
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */ 05418000
*     GPR00F FIXED(31) REG(0),                                  01S1474 05419000
*     GPR01F FIXED(31) REG(1),                                  01S1474 05420000
*     GPR02F FIXED(31) REG(2),                                  01S1474 05421000
*     GPR03F FIXED(31) REG(3),                                  01S1474 05422000
*     GPR00P PTR(31) REG(0),                                    01S1474 05423000
*     GPR01P PTR(31) REG(1),                                    01S1474 05424000
*     GPR04P PTR(31) REG(4),                                    01S1474 05425000
*     GPR14P PTR(31) REG(14),                                   01S1474 05426000
*     GPR15P PTR(31) REG(15);                                   01S1474 05427000
*   DCL                                                         01S1475 05428000
*     1 I004 DEF(ILIST) BDY(WORD),  /* LIST FOR GETMAIN              */ 05429000
*      2 I00401 PTR(31),            /* LENGTH                        */ 05430000
*      2 I00402 CHAR(1),            /* HIARCHY                       */ 05431000
*      2 I00403 PTR(24),            /* ADDR OF ADDR LIST             */ 05432000
*      2 I00404 CHAR(1),            /* TYPE OF REQUEST               */ 05433000
*      2 I00405 PTR(8);             /* SUBPOOL VALUE                 */ 05434000
*   DCL                                                         01S1476 05435000
*     1 I005 DEF(ILIST) BDY(WORD),  /* LIST FOR FREEMAIN             */ 05436000
*       3 I00501 PTR(8),            /* RESERVED                      */ 05437000
*       3 I00502 PTR(24),           /* LENGTH                        */ 05438000
*       3 I00503 PTR(8),            /* RESERVED                      */ 05439000
*       3 I00504 PTR(24),           /* ADDR OF ADDR LIST             */ 05440000
*       3 I00505 BIT(8),            /* TYPE OF FREEMAIN              */ 05441000
*       3 I00506 PTR(8);            /* SUBPOOL VALUE                 */ 05442000
*   DCL                                                         01S1477 05443000
*     1 I107 DEF(ILIST) BDY(WORD),  /* DEFINE LIST                   */ 05444000
*      2 I10701 BIT(8),             /* OR MASK                       */ 05445000
*      2 I10702 BIT(8),             /* AND MASK                      */ 05446000
*      2 I10703 BIT(8),             /* RESERVED                      */ 05447000
*      2 I10704 BIT(8);                                         01S1477 05448000
*   DCL                                                         01S1478 05449000
*     1 I056 DEF(ILIST) BDY(WORD) CHAR(32767),/* LIST FOR ENQ        */ 05450000
*       3 I05600 PTR(31),           /* TCB ADDR IF BOTH TCB AND ECB  */ 05451000
*       3 I05601 PTR(31),           /* TCB OR ECB ADDRESS            */ 05452000
*       3 I05602(*) CHAR(12) BDY(WORD),/* ARRAY OF RESOURCE ELEMENTS */ 05453000
*         5 I05603 BIT(8),          /* BIT FLAGS 1                   */ 05454000
*         5 I05604 PTR(8),          /* MINOR RESOURCE NAME LENGTH    */ 05455000
*         5 I05605 BIT(8),          /* BIT FLAGS 2                   */ 05456000
*         5 I05655 CHAR(1),         /* CONTROL PGM USE               */ 05457000
*         5 I05606 PTR(31),         /* MAJOR RESOURCE NAME ADDR      */ 05458000
*         5 I05607 PTR(31);         /* MINOR RESOURCE NAME ADDR      */ 05459000
*   DCL                                                         01S1479 05460000
*     1 I048 DEF(ILIST) CHAR(32767) BDY(WORD),                  01S1479 05461000
*       3 I04801 PTR(31),           /* TCB ADDR                      */ 05462000
*       3 I04802(*) CHAR(12) BDY(WORD),                         01S1479 05463000
*         5 I04803 PTR(31),         /* UCB @ IN LAST ENTRY           */ 05464000
*           7 I04804 BIT(8),        /* FLAGS                         */ 05465000
*           7 I04805 PTR(8),        /* MINOR RESOURCE NAME LENGTH    */ 05466000
*           7 I04806 BIT(8),        /* FLAGS                         */ 05467000
*           7 * CHAR(1),            /* CONTROL PROGRAM USE           */ 05468000
*         5 I04807 PTR(31),         /* MAJOR RESOURCE NAME @         */ 05469000
*         5 I04808 PTR(31);         /* MINOR RESOURCE NAME @         */ 05470000
*   DECLARE                                                     01S1480 05471000
*     ILIST CHAR(20) BDY(DWORD);    /* STANDARD LIST                 */ 05472000
*   DECLARE                         /* COMMON VARIABLES              */ 05473000
*     I256C CHAR(256) BASED,                                    01S1481 05474000
*     I031F FIXED(31) BASED,                                    01S1481 05475000
*     I031P PTR(31) BASED,                                      01S1481 05476000
*     I015F FIXED(15) BASED,                                    01S1481 05477000
*     I015P PTR(15) BASED,                                      01S1481 05478000
*     I008P PTR(8) BASED,                                       01S1481 05479000
*     I001C CHAR(1) BASED;                                      01S1481 05480000
*   END AHLSETEV                                                01S1482 05481000
*                                                               01S1482 05482000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 05483000
*/*%INCLUDE SYSUT5  (PLOG    )                                       */ 05484000
*/*%INCLUDE SYSUT5  (DCLS    )                                       */ 05485000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 05486000
*/*%INCLUDE SYSLIB  (IHASRB  )                                       */ 05487000
*/*%INCLUDE SYSLIB  (IHACSD  )                                       */ 05488000
*/*%INCLUDE SYSLIB  (IHAPCCA )                                       */ 05489000
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */ 05490000
*/*%INCLUDE SYSLIB  (IHALCCA )                                       */ 05491000
*/*%INCLUDE SYSLIB  (IHAWSAVT)                                       */ 05492000
*/*%INCLUDE SYSLIB  (IHASDWA )                                       */ 05493000
*/*%INCLUDE SYSLIB  (IHAFRRS )                                       */ 05494000
*/*%INCLUDE SYSLIB  (MCHEAD  )                                       */ 05495000
*/*%INCLUDE SYSLIB  (MCCE    )                                       */ 05496000
*/*%INCLUDE SYSLIB  (MCCD    )                                       */ 05497000
*/*%INCLUDE SYSLIB  (MCQE    )                                       */ 05498000
*/*%INCLUDE SYSLIB  (MCEE    )                                       */ 05499000
*/*%INCLUDE SYSLIB  (MCCLE   )                                       */ 05500000
*/*%INCLUDE SYSLIB  (MCRWSA  )                                       */ 05501000
*/*%INCLUDE SYSLIB  (MCAWSA  )                                       */ 05502000
*/*%INCLUDE SYSUT5  (SETUP   )                                       */ 05503000
*/*%INCLUDE SYSUT5  (TERMPHSE)                                       */ 05504000
*/*%INCLUDE SYSUT5  (AHLADD  )                                       */ 05505000
*/*%INCLUDE SYSUT5  (AHLACTIV)                                       */ 05506000
*/*%INCLUDE SYSUT5  (MCCLEIN )                                       */ 05507000
*/*%INCLUDE SYSUT5  (MCEEIN  )                                       */ 05508000
*/*%INCLUDE SYSUT5  (AHLFREE )                                       */ 05509000
*/*%INCLUDE SYSUT5  (MCEEOUT )                                       */ 05510000
*/*%INCLUDE SYSUT5  (MCCLEOUT)                                       */ 05511000
*/*%INCLUDE SYSUT5  (CLEANUP )                                       */ 05512000
*/*%INCLUDE SYSUT5  (GETMCQE )                                       */ 05513000
*/*%INCLUDE SYSUT5  (INITMCCE)                                       */ 05514000
*/*%INCLUDE SYSUT5  (CR8MASK )                                       */ 05515000
*/*%INCLUDE SYSUT5  (CR8SET  )                                       */ 05516000
*/*%INCLUDE SYSUT5  (MCAWSART)                                       */ 05517000
*/*%INCLUDE SYSUT5  (CSDMCCE )                                       */ 05518000
*/*%INCLUDE SYSUT5  (FREEELMS)                                       */ 05519000
*/*%INCLUDE SYSUT5  (AHLTFREE)                                       */ 05520000
*/*%INCLUDE SYSUT5  (AHLMCQP )                                       */ 05521000
*/*%INCLUDE SYSUT5  (AHLMCPST)                                       */ 05522000
*/*%INCLUDE SYSUT5  (AHLSETES)                                       */ 05523000
*/*%INCLUDE SYSUT5  (AHLPLERR)                                       */ 05524000
*/*%INCLUDE SYSUT5  (AHLTFFRR)                                       */ 05525000
*                                                               01S1482 05526000
*       ;                                                       01S1482 05527000
@DATA    DS    0H                                                       05528000
@DATD    DSECT                                                          05529000
         DS    0F                                                       05530000
@SA00001 DS    18F                                                      05531000
@PC00001 DS    1F                                                       05532000
@SA00007 DS    15F                                                      05533000
@SA00005 DS    15F                                                      05534000
@SA00002 DS    12F                                                      05535000
@TF00001 DS    F                                                        05536000
AHLSETEV CSECT                                                          05537000
         DS    0F                                                       05538000
@CF00145 DC    F'1'                                                     05539000
@CF00250 DC    F'6'                                                     05540000
@CH00250 EQU   @CF00250+2                                               05541000
@CF00034 DC    F'12'                                                    05542000
@CF00101 DC    F'16'                                                    05543000
@CF00103 DC    F'20'                                                    05544000
@CF00097 DC    F'24'                                                    05545000
@CF00106 DC    F'28'                                                    05546000
@CF02505 DC    F'76'                                                    05547000
@CF02504 DC    F'88'                                                    05548000
@CF02194 DC    F'800'                                                   05549000
@CF02506 DC    F'62720'                                                 05550000
@CF02503 DC    F'1007616'                                               05551000
@CF02273 DC    XL4'80000000'                                            05552000
@CF02311 DC    XL4'20000000'                                            05553000
@CF02397 DC    XL4'52000000'                                            05554000
@CF02511 DC    XL4'0000FFFF'                                            05555000
@DATD    DSECT                                                          05556000
         DS    0D                                                       05557000
PLISTAD  DS    A                                                        05558000
MCHEADPT DS    A                                                        05559000
MCCEPTR  DS    A                                                        05560000
ELEMAD   DS    A                                                        05561000
GETMADDR DS    A                                                        05562000
LCCAVTP  DS    A                                                        05563000
PCCAVTP  DS    A                                                        05564000
PCCAPTR  DS    A                                                        05565000
SETDECB  DS    F                                                        05566000
RTRNCODE DS    F                                                        05567000
OCDS     DS    CL8                                                      05568000
         ORG   OCDS                                                     05569000
OLDMCCE  DS    AL4                                                      05570000
OLDCOUNT DS    FL4                                                      05571000
         ORG   OCDS+8                                                   05572000
NCDS     DS    CL8                                                      05573000
         ORG   NCDS                                                     05574000
NEWMCCE  DS    AL4                                                      05575000
NEWCOUNT DS    FL4                                                      05576000
         ORG   NCDS+8                                                   05577000
FLAGS    DS    BL1                                                      05578000
         ORG   FLAGS                                                    05579000
PROBSTAT DS    BL1                                                      05580000
MCAGOTN  EQU   FLAGS+0                                                  05581000
@NM00013 EQU   FLAGS+0                                                  05582000
         ORG   FLAGS+1                                                  05583000
         DS    CL7                                                      05584000
ILIST    DS    CL20                                                     05585000
ESTAESAV DS    18A                                                      05586000
AHLSETEV CSECT                                                          05587000
         DS    0F                                                       05588000
@SIZDATD DC    AL1(0)                                                   05589000
         DC    AL3(@ENDDATD-@DATD)                                      05590000
@CA00135 DC    A(AHL133)                                                05591000
@CA00150 DC    A(AHL132)                                                05592000
         DS    0D                                                       05593000
GOODFIX  DC    XL4'40000000'                                            05594000
SQASPID  DC    AL1(245)                                                 05595000
@CC00164 DC    C'SYSZVARY'                                              05596000
@CC00168 DC    C'MCCE    '                                              05597000
@CC00170 DC    C'MCQE    '                                              05598000
@CC00172 DC    C'MCCD    '                                              05599000
@CC00174 DC    C'MCEE    '                                              05600000
@CC00176 DC    C'MCCLE   '                                              05601000
@CC00166 DC    C'CPU'                                                   05602000
AHLBASES DS    CL8                                                      05603000
         ORG   AHLBASES                                                 05604000
@NM00006 DC    AL4(@PSTART)                                             05605000
@NM00007 DC    AL4(@PSTART+4095)                                        05606000
         ORG   AHLBASES+8                                               05607000
MASKTAB  DC    XL2'8000'                                                05608000
         DC    XL2'4000'                                                05609000
         DC    XL2'2000'                                                05610000
         DC    XL2'1000'                                                05611000
         DC    XL2'0800'                                                05612000
         DC    XL2'0400'                                                05613000
         DC    XL2'0200'                                                05614000
         DC    XL2'0100'                                                05615000
         DC    XL2'0080'                                                05616000
         DC    XL2'0040'                                                05617000
         DC    XL2'0020'                                                05618000
         DC    XL2'0010'                                                05619000
         DC    XL2'0008'                                                05620000
         DC    XL2'0004'                                                05621000
         DC    XL2'0002'                                                05622000
         DC    XL2'0001'                                                05623000
DUMMYARG DC    12X'00'                                                  05624000
AHLSPTCH DC    400X'00'                                                 05625000
@DATD    DSECT                                                          05626000
ESTAELST ESTAE MF=L                                                     05627000
@DATD    DSECT                                                          05628000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                05629000
@ENDDATD EQU   *                                                        05630000
AHLSETEV CSECT                                                          05631000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       05632000
@01      EQU   01                                                       05633000
@02      EQU   02                                                       05634000
@03      EQU   03                                                       05635000
@04      EQU   04                                                       05636000
@05      EQU   05                                                       05637000
@06      EQU   06                                                       05638000
@07      EQU   07                                                       05639000
@08      EQU   08                                                       05640000
@09      EQU   09                                                       05641000
@10      EQU   10                                                       05642000
@11      EQU   11                                                       05643000
@12      EQU   12                                                       05644000
@13      EQU   13                                                       05645000
@14      EQU   14                                                       05646000
@15      EQU   15                                                       05647000
TMPCNT   EQU   @03                                                      05648000
HISKEY   EQU   @08                                                      05649000
RTRNMCQE EQU   @10                                                      05650000
INDEX    EQU   @02                                                      05651000
OMCCECNT EQU   @02                                                      05652000
NEXTELMT EQU   @02                                                      05653000
SDWAPTR  EQU   @04                                                      05654000
LCCAPTR  EQU   @02                                                      05655000
MCRWSAPT EQU   @04                                                      05656000
LASTMCQ  EQU   @06                                                      05657000
MCQEPTR  EQU   @04                                                      05658000
LASTELM  EQU   @05                                                      05659000
LISTELM  EQU   @02                                                      05660000
ESTAECOD EQU   @00                                                      05661000
R1PLSTAD EQU   @01                                                      05662000
SRBPTR   EQU   @01                                                      05663000
TREEAD   EQU   @01                                                      05664000
NOTREE   EQU   @01                                                      05665000
PARMPTR  EQU   @01                                                      05666000
MCEDSINK EQU   @03                                                      05667000
CPUMSK   EQU   @03                                                      05668000
MCHEADA  EQU   @04                                                      05669000
ARGUMENT EQU   @07                                                      05670000
WORKREG  EQU   @08                                                      05671000
BASER3   EQU   @09                                                      05672000
SAVEAREA EQU   @13                                                      05673000
SINKADDR EQU   @15                                                      05674000
SINKIND  EQU   @15                                                      05675000
ABNDCODE EQU   @15                                                      05676000
TEMPREG  EQU   @15                                                      05677000
RETCOD15 EQU   @15                                                      05678000
SRBPARM1 EQU   @01                                                      05679000
FRSPCELM EQU   @05                                                      05680000
MCCLTOFR EQU   @05                                                      05681000
MCEETOFR EQU   @05                                                      05682000
NEXTMCCL EQU   @06                                                      05683000
NEXTMCEE EQU   @06                                                      05684000
NXTFRSP  EQU   @06                                                      05685000
MCQEADR  EQU   @06                                                      05686000
SRBRTRN  EQU   @07                                                      05687000
FRRLIST  EQU   @07                                                      05688000
BASEREG  EQU   @08                                                      05689000
SRBPARM2 EQU   @09                                                      05690000
ECBCODE  EQU   @10                                                      05691000
FTREEAD  EQU   @10                                                      05692000
SRBECB   EQU   @11                                                      05693000
RETURNAD EQU   @14                                                      05694000
GPR01F   EQU   @01                                                      05695000
GPR02F   EQU   @02                                                      05696000
GPR01P   EQU   @01                                                      05697000
GPR00P   EQU   @00                                                      05698000
GPR15P   EQU   @15                                                      05699000
GPR03F   EQU   @03                                                      05700000
GPR00F   EQU   @00                                                      05701000
GPR04P   EQU   @04                                                      05702000
GPR14P   EQU   @14                                                      05703000
BASER1   EQU   @11                                                      05704000
BASER2   EQU   @12                                                      05705000
CR8      EQU   @08                                                      05706000
REG0     EQU   @00                                                      05707000
         ENTRY AHLSPTCH                                                 05708000
         EXTRN AHL133                                                   05709000
         EXTRN AHL132                                                   05710000
CVTPTR   EQU   16                                                       05711000
PSA      EQU   0                                                        05712000
FLCRNPSW EQU   PSA                                                      05713000
FLCROPSW EQU   PSA+8                                                    05714000
FLCICCW2 EQU   PSA+16                                                   05715000
PSAEEPSW EQU   PSA+132                                                  05716000
PSAESPSW EQU   PSA+136                                                  05717000
FLCSVILC EQU   PSAESPSW+1                                               05718000
PSAEPPSW EQU   PSA+140                                                  05719000
FLCPIILC EQU   PSAEPPSW+1                                               05720000
FLCPICOD EQU   PSAEPPSW+2                                               05721000
PSAPICOD EQU   FLCPICOD+1                                               05722000
FLCTEA   EQU   PSAEPPSW+4                                               05723000
FLCPER   EQU   PSA+152                                                  05724000
FLCMCLA  EQU   PSA+168                                                  05725000
FLCIOEL  EQU   FLCMCLA+4                                                05726000
FLCIOA   EQU   FLCMCLA+16                                               05727000
FLCFSA   EQU   FLCMCLA+80                                               05728000
PSAPCCAV EQU   PSA+520                                                  05729000
PSALCCAV EQU   PSA+528                                                  05730000
PSAAOLD  EQU   PSA+548                                                  05731000
PSASUPER EQU   PSA+552                                                  05732000
PSASUP1  EQU   PSASUPER                                                 05733000
PSASUP2  EQU   PSASUPER+1                                               05734000
PSASUP3  EQU   PSASUPER+2                                               05735000
PSASUP4  EQU   PSASUPER+3                                               05736000
PSACLHT  EQU   PSA+640                                                  05737000
PSALKSA  EQU   PSA+696                                                  05738000
PSAHLHI  EQU   PSA+760                                                  05739000
PSADSSFL EQU   PSA+836                                                  05740000
PSADSSF1 EQU   PSADSSFL                                                 05741000
PSADSSF3 EQU   PSADSSFL+2                                               05742000
PSADSSF4 EQU   PSADSSFL+3                                               05743000
PSARSVT  EQU   PSA+896                                                  05744000
FRRPARMS EQU   0                                                        05745000
FRRTABL  EQU   FRRPARMS                                                 05746000
FRRSALOC EQU   FRRTABL                                                  05747000
FRRTABLE EQU   FRRTABL+1                                                05748000
FRRRET   EQU   FRRPARMS+4                                               05749000
LVTSLOT  EQU   0                                                        05750000
PVTSLOT  EQU   0                                                        05751000
PARMLIST EQU   0                                                        05752000
SETOPTS  EQU   PARMLIST                                                 05753000
ADD      EQU   SETOPTS                                                  05754000
ACTIVATE EQU   SETOPTS                                                  05755000
FREE     EQU   SETOPTS                                                  05756000
EVENTNUM EQU   PARMLIST+2                                               05757000
EIDNUM   EQU   EVENTNUM                                                 05758000
CLSNUM   EQU   EVENTNUM+1                                               05759000
PLISTNAM EQU   PARMLIST+4                                               05760000
EIDLSTAD EQU   PARMLIST+12                                              05761000
CLSLSTAD EQU   PARMLIST+16                                              05762000
PASSEDQE EQU   PARMLIST+20                                              05763000
EIDLIST  EQU   0                                                        05764000
PLISTEID EQU   EIDLIST                                                  05765000
ELISTRTN EQU   EIDLIST+2                                                05766000
CLSLIST  EQU   0                                                        05767000
PLISTCLS EQU   CLSLIST                                                  05768000
CLISTRTN EQU   CLSLIST+2                                                05769000
SETDPTR  EQU   0                                                        05770000
FRESPACE EQU   0                                                        05771000
FRESPLNK EQU   FRESPACE+1                                               05772000
BRPOST   EQU   0                                                        05773000
NEWSINK  EQU   0                                                        05774000
MYSAVE   EQU   0                                                        05775000
HISSAVAD EQU   MYSAVE+4                                                 05776000
FORCHAIN EQU   MYSAVE+8                                                 05777000
HISSAVE  EQU   0                                                        05778000
HISREGF  EQU   HISSAVE+16                                               05779000
HISREG0  EQU   HISSAVE+20                                               05780000
CVTMAP   EQU   0                                                        05781000
CVTDAR   EQU   CVTMAP+72                                                05782000
CVTFLGS1 EQU   CVTDAR                                                   05783000
CVTDCB   EQU   CVTMAP+116                                               05784000
CVTIOQET EQU   CVTMAP+120                                               05785000
CVTIERLC EQU   CVTMAP+144                                               05786000
CVT0PT01 EQU   CVTMAP+152                                               05787000
CVTHEAD  EQU   CVTMAP+160                                               05788000
CVTSV76C EQU   CVTHEAD                                                  05789000
CVTOPTA  EQU   CVTMAP+182                                               05790000
CVTOPTB  EQU   CVTMAP+183                                               05791000
CVTGTF   EQU   CVTMAP+236                                               05792000
CVTGTFST EQU   CVTGTF                                                   05793000
CVTGTFS  EQU   CVTGTFST                                                 05794000
CVTSTATE EQU   CVTGTFST                                                 05795000
CVTTMODE EQU   CVTGTFST                                                 05796000
CVTFORM  EQU   CVTGTFST                                                 05797000
CVTGTFA  EQU   CVTGTF+1                                                 05798000
CVTAQAVT EQU   CVTMAP+240                                               05799000
CVTTCMFG EQU   CVTAQAVT                                                 05800000
CVTVOLM2 EQU   CVTMAP+244                                               05801000
CVTTATA  EQU   CVTVOLM2                                                 05802000
CVTTSKS  EQU   CVTTATA                                                  05803000
CVTVOLF2 EQU   CVTTSKS                                                  05804000
CVTTAT   EQU   CVTTATA+1                                                05805000
CVTATER  EQU   CVTMAP+248                                               05806000
CVTEXT1  EQU   CVTMAP+252                                               05807000
CVTPURG  EQU   CVTMAP+260                                               05808000
CVTQMSG  EQU   CVTMAP+268                                               05809000
CVTDMSR  EQU   CVTMAP+272                                               05810000
CVTRSV37 EQU   CVTDMSR                                                  05811000
CVTDMSRF EQU   CVTRSV37                                                 05812000
CVTERPV  EQU   CVTMAP+316                                               05813000
CVTINTLA EQU   CVTMAP+320                                               05814000
CVTAPF   EQU   CVTMAP+324                                               05815000
CVTEXT2  EQU   CVTMAP+328                                               05816000
CVTHJES  EQU   CVTMAP+332                                               05817000
CVTPGSIA EQU   CVTMAP+348                                               05818000
CVTA1F1  EQU   CVTMAP+356                                               05819000
CVTSYSK  EQU   CVTMAP+357                                               05820000
CVTVOLM1 EQU   CVTMAP+380                                               05821000
CVTVOLF1 EQU   CVTVOLM1                                                 05822000
CVTATMCT EQU   CVTMAP+388                                               05823000
CVTXTNT1 EQU   0                                                        05824000
CVTXTNT2 EQU   0                                                        05825000
CVTDSSV  EQU   CVTXTNT2                                                 05826000
CVTFLGBT EQU   CVTXTNT2+5                                               05827000
CVTQID   EQU   CVTXTNT2+24                                              05828000
CVTRV400 EQU   CVTXTNT2+52                                              05829000
CVTRV409 EQU   CVTXTNT2+53                                              05830000
CVTATCVT EQU   CVTXTNT2+64                                              05831000
CVTRV429 EQU   CVTXTNT2+84                                              05832000
CVTRV438 EQU   CVTXTNT2+85                                              05833000
CVTRV457 EQU   CVTXTNT2+112                                             05834000
CVTRV466 EQU   CVTXTNT2+113                                             05835000
CVTFIX   EQU   0                                                        05836000
CVTRELNO EQU   CVTFIX+252                                               05837000
SRBSECT  EQU   0                                                        05838000
SRB      EQU   SRBSECT                                                  05839000
SRBASCB  EQU   SRB+8                                                    05840000
SRBFLC   EQU   SRB+12                                                   05841000
SRBEP    EQU   SRB+20                                                   05842000
SRBPARM  EQU   SRB+28                                                   05843000
CSD      EQU   0                                                        05844000
CSDCPUAL EQU   CSD+8                                                    05845000
CSDSCWRD EQU   CSD+12                                                   05846000
CSDSCFL1 EQU   CSDSCWRD                                                 05847000
CSDSCFL2 EQU   CSDSCWRD+1                                               05848000
CSDSCFL3 EQU   CSDSCWRD+2                                               05849000
CSDSCFL4 EQU   CSDSCWRD+3                                               05850000
CSDFLAGS EQU   CSD+23                                                   05851000
CSDMP    EQU   CSDFLAGS                                                 05852000
PCCA     EQU   0                                                        05853000
PCCACPUA EQU   PCCA+16                                                  05854000
PCCATMST EQU   PCCA+128                                                 05855000
PCCATMFL EQU   PCCATMST                                                 05856000
PCCATODE EQU   PCCATMST+1                                               05857000
PCCACCE  EQU   PCCATMST+2                                               05858000
PCCAINTE EQU   PCCATMST+3                                               05859000
PCCAEMSB EQU   PCCA+136                                                 05860000
PCCAEMSI EQU   PCCAEMSB                                                 05861000
PCCARISP EQU   PCCAEMSI                                                 05862000
PCCAEMS2 EQU   PCCAEMSI+1                                               05863000
PCCAEMS3 EQU   PCCAEMSI+2                                               05864000
PCCARMSB EQU   PCCAEMSI+3                                               05865000
PCCAWERP EQU   PCCA+280                                                 05866000
PCCACHPF EQU   PCCAWERP+4                                               05867000
PCCACHBL EQU   PCCAWERP+5                                               05868000
PCCACHVA EQU   PCCAWERP+6                                               05869000
PCCACHTS EQU   PCCAWERP+7                                               05870000
PCCACHS1 EQU   PCCA+288                                                 05871000
PCCACHS2 EQU   PCCA+289                                                 05872000
PCCACHRB EQU   PCCA+290                                                 05873000
PCCACHF1 EQU   PCCA+308                                                 05874000
PCCACHF2 EQU   PCCA+309                                                 05875000
PCCACHF3 EQU   PCCA+310                                                 05876000
PCCACHF4 EQU   PCCA+311                                                 05877000
LCCA     EQU   0                                                        05878000
LCCAIHRC EQU   LCCA+520                                                 05879000
LCCAIHR1 EQU   LCCAIHRC                                                 05880000
LCCAIHR2 EQU   LCCAIHRC+1                                               05881000
LCCAIHR3 EQU   LCCAIHRC+2                                               05882000
LCCAIHR4 EQU   LCCAIHRC+3                                               05883000
LCCASPIN EQU   LCCA+524                                                 05884000
LCCASPN1 EQU   LCCASPIN                                                 05885000
LCCASPN2 EQU   LCCASPIN+1                                               05886000
LCCASPN3 EQU   LCCASPIN+2                                               05887000
LCCASPN4 EQU   LCCASPIN+3                                               05888000
LCCACPUS EQU   LCCA+536                                                 05889000
LCCADSF1 EQU   LCCA+540                                                 05890000
LCCADSF2 EQU   LCCA+541                                                 05891000
LCCASPSA EQU   LCCA+544                                                 05892000
LCCACRFL EQU   LCCA+692                                                 05893000
LCCACREX EQU   LCCA+693                                                 05894000
LCCALKFG EQU   LCCA+694                                                 05895000
LCCASRBF EQU   LCCA+720                                                 05896000
WSAG     EQU   0                                                        05897000
WSAGGMFM EQU   WSAG+4                                                   05898000
WSAC     EQU   0                                                        05899000
WSACGTF  EQU   WSAC+4                                                   05900000
SDWA     EQU   0                                                        05901000
SDWAPARM EQU   SDWA                                                     05902000
SDWAFIOB EQU   SDWA+4                                                   05903000
SDWAABCC EQU   SDWAFIOB                                                 05904000
SDWACMPF EQU   SDWAABCC                                                 05905000
SDWACTL1 EQU   SDWA+8                                                   05906000
SDWACMKA EQU   SDWACTL1                                                 05907000
SDWAMWPA EQU   SDWACTL1+1                                               05908000
SDWAPMKA EQU   SDWACTL1+4                                               05909000
SDWACTL2 EQU   SDWA+16                                                  05910000
SDWACMKP EQU   SDWACTL2                                                 05911000
SDWAMWPP EQU   SDWACTL2+1                                               05912000
SDWAPMKP EQU   SDWACTL2+4                                               05913000
SDWAGRSV EQU   SDWA+24                                                  05914000
SDWANAME EQU   SDWA+88                                                  05915000
SDWAEC1  EQU   SDWA+104                                                 05916000
SDWAEMK1 EQU   SDWAEC1                                                  05917000
SDWAMWP1 EQU   SDWAEC1+1                                                05918000
SDWAINT1 EQU   SDWAEC1+2                                                05919000
SDWANXT1 EQU   SDWAEC1+4                                                05920000
SDWAAEC1 EQU   SDWA+112                                                 05921000
SDWAILC1 EQU   SDWAAEC1+1                                               05922000
SDWAINC1 EQU   SDWAAEC1+2                                               05923000
SDWAICD1 EQU   SDWAINC1+1                                               05924000
SDWAEC2  EQU   SDWA+120                                                 05925000
SDWAEMK2 EQU   SDWAEC2                                                  05926000
SDWAMWP2 EQU   SDWAEC2+1                                                05927000
SDWAINT2 EQU   SDWAEC2+2                                                05928000
SDWANXT2 EQU   SDWAEC2+4                                                05929000
SDWAAEC2 EQU   SDWA+128                                                 05930000
SDWAILC2 EQU   SDWAAEC2+1                                               05931000
SDWAINC2 EQU   SDWAAEC2+2                                               05932000
SDWAICD2 EQU   SDWAINC2+1                                               05933000
SDWASRSV EQU   SDWA+136                                                 05934000
SDWAIDNT EQU   SDWA+200                                                 05935000
SDWAMCH  EQU   SDWA+204                                                 05936000
SDWASTCK EQU   SDWAMCH                                                  05937000
SDWAMCHI EQU   SDWAMCH+8                                                05938000
SDWAMCHS EQU   SDWAMCHI                                                 05939000
SDWAMCHD EQU   SDWAMCHI+1                                               05940000
SDWARSR1 EQU   SDWAMCH+12                                               05941000
SDWARSR2 EQU   SDWAMCH+13                                               05942000
SDWAFLGS EQU   SDWA+232                                                 05943000
SDWAERRA EQU   SDWAFLGS                                                 05944000
SDWAPCHK EQU   SDWAERRA                                                 05945000
SDWAERRB EQU   SDWAFLGS+1                                               05946000
SDWAERRC EQU   SDWAFLGS+2                                               05947000
SDWAERRD EQU   SDWAFLGS+3                                               05948000
SDWAIOFS EQU   SDWA+238                                                 05949000
SDWARTYA EQU   SDWA+240                                                 05950000
SDWACPUA EQU   SDWA+248                                                 05951000
SDWAPARQ EQU   SDWA+252                                                 05952000
SDWARCDE EQU   SDWAPARQ                                                 05953000
SDWAACF2 EQU   SDWAPARQ+1                                               05954000
SDWAUPRG EQU   SDWAACF2                                                 05955000
SDWAFREE EQU   SDWAACF2                                                 05956000
SDWAACF3 EQU   SDWAPARQ+2                                               05957000
SDWAACF4 EQU   SDWAPARQ+3                                               05958000
SDWALKWA EQU   SDWA+256                                                 05959000
SDWALKWS EQU   SDWALKWA                                                 05960000
SDWARECP EQU   SDWA+292                                                 05961000
SDWASNPA EQU   SDWA+320                                                 05962000
SDWADUMP EQU   SDWASNPA                                                 05963000
SDWADPFS EQU   SDWADUMP+1                                               05964000
SDWADDAT EQU   SDWASNPA+4                                               05965000
SDWASDAT EQU   SDWADDAT                                                 05966000
SDWAPDAT EQU   SDWADDAT+2                                               05967000
SDWADPSA EQU   SDWA+328                                                 05968000
SDWADPSL EQU   SDWADPSA                                                 05969000
SDWARA   EQU   SDWA+400                                                 05970000
SDWADPVA EQU   SDWARA+2                                                 05971000
FRRSPTR  EQU   0                                                        05972000
FRREPTR  EQU   0                                                        05973000
FRRS     EQU   0                                                        05974000
FRRSHEAD EQU   FRRS                                                     05975000
FRRSENTR EQU   0                                                        05976000
FRRSFLGS EQU   FRRSENTR+4                                               05977000
FRRSFLG1 EQU   FRRSFLGS                                                 05978000
MCHEAD   EQU   0                                                        05979000
MCHCUR   EQU   MCHEAD+8                                                 05980000
MCHCNT   EQU   MCHEAD+12                                                05981000
MCHCTL   EQU   MCHEAD+16                                                05982000
MCHFLGS  EQU   MCHEAD+24                                                05983000
MCHFLG1  EQU   MCHFLGS                                                  05984000
MCHACT   EQU   MCHFLG1                                                  05985000
MCHTERM  EQU   MCHFLG1                                                  05986000
MCHSETD  EQU   MCHEAD+32                                                05987000
MCCE     EQU   0                                                        05988000
MCCEIDEN EQU   MCCE                                                     05989000
MCCEEDA  EQU   MCCE+8                                                   05990000
MCCECDA  EQU   MCCE+12                                                  05991000
MCCEQEA  EQU   MCCE+16                                                  05992000
MCCEOEDA EQU   MCCE+20                                                  05993000
MCCEOCDA EQU   MCCE+24                                                  05994000
MCCEOMCQ EQU   MCCE+28                                                  05995000
MCCECNT  EQU   MCCE+32                                                  05996000
MCCEMCCE EQU   MCCE+36                                                  05997000
MCCEECB  EQU   MCCE+40                                                  05998000
MCCESRB  EQU   MCCE+44                                                  05999000
MCCD     EQU   0                                                        06000000
MCCDIDEN EQU   MCCD                                                     06001000
MCCDFLG1 EQU   MCCD+8                                                   06002000
MCCDCNT  EQU   MCCD+10                                                  06003000
MCCDCLE  EQU   MCCD+12                                                  06004000
MCQE     EQU   0                                                        06005000
MCQEIDEN EQU   MCQE                                                     06006000
MCQENAME EQU   MCQE+8                                                   06007000
MCQEASCB EQU   MCQE+16                                                  06008000
MCQEMCQE EQU   MCQE+20                                                  06009000
MCQEMCEE EQU   MCQE+24                                                  06010000
MCQEMCCL EQU   MCQE+28                                                  06011000
MCQETECB EQU   MCQE+36                                                  06012000
MCQEFLGS EQU   MCQE+41                                                  06013000
MCQEACT  EQU   MCQEFLGS                                                 06014000
MCQESRB  EQU   MCQE+44                                                  06015000
MCEE     EQU   0                                                        06016000
MCEEIDEN EQU   MCEE                                                     06017000
MCEEFLGS EQU   MCEE+8                                                   06018000
MCEEFLG1 EQU   MCEEFLGS                                                 06019000
MCEEEID  EQU   MCEEFLGS+2                                               06020000
MCEERTN  EQU   MCEE+12                                                  06021000
MCEEMCQE EQU   MCEE+16                                                  06022000
MCEEEIDL EQU   MCEE+20                                                  06023000
MCEEMCQL EQU   MCEE+24                                                  06024000
MCCLE    EQU   0                                                        06025000
MCCLIDEN EQU   MCCLE                                                    06026000
MCCLFLGS EQU   MCCLE+8                                                  06027000
MCCLFLG1 EQU   MCCLFLGS                                                 06028000
MCCLCLAS EQU   MCCLFLGS+2                                               06029000
MCCLRTN  EQU   MCCLE+12                                                 06030000
MCCLMCQE EQU   MCCLE+16                                                 06031000
MCCLEIDL EQU   MCCLE+20                                                 06032000
MCCLMCQL EQU   MCCLE+24                                                 06033000
MCRWSA   EQU   0                                                        06034000
MCRMCA   EQU   MCRWSA+128                                               06035000
MCRWSAF  EQU   MCRWSA+132                                               06036000
MCAWSA   EQU   0                                                        06037000
MCATRAIL EQU   MCAWSA+256                                               06038000
MCATRL1  EQU   MCATRAIL                                                 06039000
MCATRL2  EQU   MCATRAIL+1                                               06040000
MCATRL3  EQU   MCATRAIL+2                                               06041000
MCATRL4  EQU   MCATRAIL+3                                               06042000
MCATRL5  EQU   MCATRAIL+4                                               06043000
MCATRL6  EQU   MCATRAIL+5                                               06044000
MCATRL7  EQU   MCATRAIL+6                                               06045000
MCATRL8  EQU   MCATRAIL+7                                               06046000
MCAMCR   EQU   MCAWSA+264                                               06047000
ACRRETRY EQU   0                                                        06048000
I001C    EQU   0                                                        06049000
I008P    EQU   0                                                        06050000
I015F    EQU   0                                                        06051000
I015P    EQU   0                                                        06052000
I031F    EQU   0                                                        06053000
I031P    EQU   0                                                        06054000
I256C    EQU   0                                                        06055000
MSG133   EQU   AHL133+4                                                 06056000
MSGCPUID EQU   MSG133+42                                                06057000
XTRABYTE EQU   MSGCPUID+3                                               06058000
MSGNAME  EQU   MSG133+50                                                06059000
PLIST    EQU   0                                                        06060000
CPUADDR  EQU   PCCACPUA                                                 06061000
ADDRCNT  EQU   MCHCUR                                                   06062000
MCCLCLS  EQU   MCCLCLAS                                                 06063000
MCEECLS  EQU   MCEEEID                                                  06064000
MCCLCLS2 EQU   MCCLCLAS                                                 06065000
PLSTCLS2 EQU   PLISTCLS                                                 06066000
CVTS01   EQU   CVTPGSIA                                                 06067000
CVTLPDIA EQU   CVTS01+12                                                06068000
CVTDIRST EQU   CVTLPDIA                                                 06069000
CVTSLIDA EQU   CVTS01+24                                                06070000
CVTCTLFG EQU   CVTS01+50                                                06071000
CVTCSD   EQU   CVTS01+312                                               06072000
CVTGLMN  EQU   CVTS01+332                                               06073000
CVTSPSA  EQU   CVTS01+336                                               06074000
CVTPCCAT EQU   CVTS01+416                                               06075000
CVTLCCAT EQU   CVTS01+420                                               06076000
CVTRV210 EQU   CVTS01+424                                               06077000
CVTRV219 EQU   CVTS01+425                                               06078000
CVTRV228 EQU   CVTS01+426                                               06079000
CVTRV237 EQU   CVTS01+427                                               06080000
CVTMFRTR EQU   CVTS01+452                                               06081000
CVTRV262 EQU   CVTS01+468                                               06082000
CVTRV271 EQU   CVTS01+469                                               06083000
CVTRV280 EQU   CVTS01+470                                               06084000
CVTRV289 EQU   CVTS01+471                                               06085000
CVTGSDA  EQU   CVTS01+600                                               06086000
PSARSVTE EQU   PSARSVT                                                  06087000
AWSAPTR  EQU   MCRMCA                                                   06088000
I107     EQU   ILIST                                                    06089000
I10701   EQU   I107                                                     06090000
I10702   EQU   I107+1                                                   06091000
I10703   EQU   I107+2                                                   06092000
I10704   EQU   I107+3                                                   06093000
I056     EQU   ILIST                                                    06094000
I05602   EQU   I056+8                                                   06095000
I05603   EQU   I05602                                                   06096000
I05604   EQU   I05602+1                                                 06097000
I05605   EQU   I05602+2                                                 06098000
I05606   EQU   I05602+4                                                 06099000
I05607   EQU   I05602+8                                                 06100000
I005     EQU   ILIST                                                    06101000
I00502   EQU   I005+1                                                   06102000
I00504   EQU   I005+5                                                   06103000
I00505   EQU   I005+8                                                   06104000
I00506   EQU   I005+9                                                   06105000
I004     EQU   ILIST                                                    06106000
I00401   EQU   I004                                                     06107000
I00403   EQU   I004+5                                                   06108000
I00404   EQU   I004+8                                                   06109000
I00405   EQU   I004+9                                                   06110000
I048     EQU   ILIST                                                    06111000
I04802   EQU   I048+4                                                   06112000
I04803   EQU   I04802                                                   06113000
I04804   EQU   I04803                                                   06114000
I04805   EQU   I04803+1                                                 06115000
I04806   EQU   I04803+2                                                 06116000
I04807   EQU   I04802+4                                                 06117000
I04808   EQU   I04802+8                                                 06118000
FLC      EQU   PSA                                                      06119000
*                                      START UNREFERENCED COMPONENTS    06120000
@NM00103 EQU   I04803+3                                                 06121000
I04801   EQU   I048                                                     06122000
I00402   EQU   I004+4                                                   06123000
I00503   EQU   I005+4                                                   06124000
I00501   EQU   I005                                                     06125000
I05655   EQU   I05602+3                                                 06126000
I05601   EQU   I056+4                                                   06127000
I05600   EQU   I056                                                     06128000
PSARSAV  EQU   PSARSVTE+60                                              06129000
PSARSTK  EQU   PSARSVTE+56                                              06130000
PSAESAV3 EQU   PSARSVTE+52                                              06131000
PSAESTK3 EQU   PSARSVTE+48                                              06132000
PSAESAV2 EQU   PSARSVTE+44                                              06133000
PSAESTK2 EQU   PSARSVTE+40                                              06134000
PSAESAV1 EQU   PSARSVTE+36                                              06135000
PSAESTK1 EQU   PSARSVTE+32                                              06136000
PSAPSAV  EQU   PSARSVTE+28                                              06137000
PSAPSTK  EQU   PSARSVTE+24                                              06138000
PSAMSAV  EQU   PSARSVTE+20                                              06139000
PSAMSTK  EQU   PSARSVTE+16                                              06140000
PSASSAV  EQU   PSARSVTE+12                                              06141000
PSASSTK  EQU   PSARSVTE+8                                               06142000
PSANSTK  EQU   PSARSVTE+4                                               06143000
PSACSTK  EQU   PSARSVTE                                                 06144000
CVTRV628 EQU   CVTS01+728                                               06145000
CVTRV627 EQU   CVTS01+724                                               06146000
CVTRV626 EQU   CVTS01+720                                               06147000
CVTRV625 EQU   CVTS01+716                                               06148000
CVTRV624 EQU   CVTS01+712                                               06149000
CVTRV623 EQU   CVTS01+708                                               06150000
CVTRV622 EQU   CVTS01+704                                               06151000
CVTRV621 EQU   CVTS01+700                                               06152000
CVTIHASU EQU   CVTS01+696                                               06153000
CVTRV619 EQU   CVTS01+692                                               06154000
CVTRV618 EQU   CVTS01+688                                               06155000
CVTRV617 EQU   CVTS01+684                                               06156000
CVTRV616 EQU   CVTS01+680                                               06157000
CVTRV615 EQU   CVTS01+676                                               06158000
CVTRV614 EQU   CVTS01+672                                               06159000
CVTRV613 EQU   CVTS01+668                                               06160000
CVTTCASP EQU   CVTS01+664                                               06161000
CVT0PT03 EQU   CVTS01+660                                               06162000
CVT0PT0E EQU   CVTS01+656                                               06163000
CVTRV609 EQU   CVTS01+652                                               06164000
CVTCGK   EQU   CVTS01+648                                               06165000
CVTRAC   EQU   CVTS01+644                                               06166000
CVTRV606 EQU   CVTS01+640                                               06167000
CVTRV605 EQU   CVTS01+636                                               06168000
CVTRV604 EQU   CVTS01+632                                               06169000
CVTEFF02 EQU   CVTS01+628                                               06170000
CVTCBBR  EQU   CVTS01+624                                               06171000
CVTSSCR  EQU   CVTS01+620                                               06172000
CVTEVENT EQU   CVTS01+616                                               06173000
CVTCRCA  EQU   CVTS01+612                                               06174000
CVTTPIO  EQU   CVTS01+608                                               06175000
CVTADV   EQU   CVTS01+604                                               06176000
CVTGSDAB EQU   CVTGSDA                                                  06177000
CVTQV3   EQU   CVTS01+596                                               06178000
CVTQV2   EQU   CVTS01+592                                               06179000
CVTQV1   EQU   CVTS01+588                                               06180000
CVTRPT   EQU   CVTS01+584                                               06181000
CVTSSRB  EQU   CVTS01+580                                               06182000
CVTCSDRL EQU   CVTS01+576                                               06183000
CVTEXP1  EQU   CVTS01+572                                               06184000
CVTRMPMT EQU   CVTS01+568                                               06185000
CVTRMPTT EQU   CVTS01+564                                               06186000
CVTVPSA  EQU   CVTS01+560                                               06187000
CVTVSTOP EQU   CVTS01+556                                               06188000
CVTGTFR8 EQU   CVTS01+552                                               06189000
CVTQUIT  EQU   CVTS01+548                                               06190000
CVTVACR  EQU   CVTS01+544                                               06191000
CVTWTCB  EQU   CVTS01+540                                               06192000
CVTSTPRS EQU   CVTS01+536                                               06193000
CVT0PT02 EQU   CVTS01+532                                               06194000
CVTDARCM EQU   CVTS01+528                                               06195000
CVTIRECM EQU   CVTS01+524                                               06196000
CVTJRECM EQU   CVTS01+520                                               06197000
CVTVEMS0 EQU   CVTS01+516                                               06198000
CVTSPFRR EQU   CVTS01+512                                               06199000
CVTRLSTG EQU   CVTS01+508                                               06200000
CVT0TC0A EQU   CVTS01+504                                               06201000
CVTGMBR  EQU   CVTS01+500                                               06202000
CVTLFRM  EQU   CVTS01+496                                               06203000
CVTRMBR  EQU   CVTS01+492                                               06204000
CVTVIOP  EQU   CVTS01+488                                               06205000
CVTRV307 EQU   CVTS01+486                                               06206000
CVTRV306 EQU   CVTS01+484                                               06207000
CVTRV305 EQU   CVTS01+482                                               06208000
CVTRV304 EQU   CVTS01+480                                               06209000
CVTRV303 EQU   CVTS01+478                                               06210000
CVTRV302 EQU   CVTS01+476                                               06211000
CVTTRCA  EQU   CVTS01+472                                               06212000
CVTRV297 EQU   CVTRV289                                                 06213000
CVTRV296 EQU   CVTRV289                                                 06214000
CVTRV295 EQU   CVTRV289                                                 06215000
CVTRV294 EQU   CVTRV289                                                 06216000
CVTRV293 EQU   CVTRV289                                                 06217000
CVTRV292 EQU   CVTRV289                                                 06218000
CVTRV291 EQU   CVTRV289                                                 06219000
CVTRV290 EQU   CVTRV289                                                 06220000
CVTRV288 EQU   CVTRV280                                                 06221000
CVTRV287 EQU   CVTRV280                                                 06222000
CVTRV286 EQU   CVTRV280                                                 06223000
CVTRV285 EQU   CVTRV280                                                 06224000
CVTRV284 EQU   CVTRV280                                                 06225000
CVTRV283 EQU   CVTRV280                                                 06226000
CVTRV282 EQU   CVTRV280                                                 06227000
CVTRV281 EQU   CVTRV280                                                 06228000
CVTRV279 EQU   CVTRV271                                                 06229000
CVTRV278 EQU   CVTRV271                                                 06230000
CVTRV277 EQU   CVTRV271                                                 06231000
CVTRV276 EQU   CVTRV271                                                 06232000
CVTRV275 EQU   CVTRV271                                                 06233000
CVTRV274 EQU   CVTRV271                                                 06234000
CVTRV273 EQU   CVTRV271                                                 06235000
CVTRV272 EQU   CVTRV271                                                 06236000
CVTRV270 EQU   CVTRV262                                                 06237000
CVTRV269 EQU   CVTRV262                                                 06238000
CVTRV268 EQU   CVTRV262                                                 06239000
CVTRV267 EQU   CVTRV262                                                 06240000
CVTRV266 EQU   CVTRV262                                                 06241000
CVTRV265 EQU   CVTRV262                                                 06242000
CVTRV264 EQU   CVTRV262                                                 06243000
CVTRV263 EQU   CVTRV262                                                 06244000
CVTVFP   EQU   CVTS01+464                                               06245000
CVTVSI   EQU   CVTS01+460                                               06246000
CVTVPSIB EQU   CVTS01+456                                               06247000
CVTMFACT EQU   CVTMFRTR                                                 06248000
CVTMFCTL EQU   CVTS01+448                                               06249000
CVTPVBP  EQU   CVTS01+444                                               06250000
CVTPWI   EQU   CVTS01+440                                               06251000
CVTRV254 EQU   CVTS01+438                                               06252000
CVTRV253 EQU   CVTS01+436                                               06253000
CVTRV252 EQU   CVTS01+434                                               06254000
CVTRV251 EQU   CVTS01+433                                               06255000
CVTRV250 EQU   CVTS01+432                                               06256000
CVTRV249 EQU   CVTS01+431                                               06257000
CVTRV248 EQU   CVTS01+430                                               06258000
CVTRV247 EQU   CVTS01+429                                               06259000
CVTRV246 EQU   CVTS01+428                                               06260000
CVTRV245 EQU   CVTRV237                                                 06261000
CVTRV244 EQU   CVTRV237                                                 06262000
CVTRV243 EQU   CVTRV237                                                 06263000
CVTRV242 EQU   CVTRV237                                                 06264000
CVTRV241 EQU   CVTRV237                                                 06265000
CVTRV240 EQU   CVTRV237                                                 06266000
CVTRV239 EQU   CVTRV237                                                 06267000
CVTRV238 EQU   CVTRV237                                                 06268000
CVTRV236 EQU   CVTRV228                                                 06269000
CVTRV235 EQU   CVTRV228                                                 06270000
CVTRV234 EQU   CVTRV228                                                 06271000
CVTRV233 EQU   CVTRV228                                                 06272000
CVTRV232 EQU   CVTRV228                                                 06273000
CVTRV231 EQU   CVTRV228                                                 06274000
CVTRV230 EQU   CVTRV228                                                 06275000
CVTRV229 EQU   CVTRV228                                                 06276000
CVTRV227 EQU   CVTRV219                                                 06277000
CVTRV226 EQU   CVTRV219                                                 06278000
CVTRV225 EQU   CVTRV219                                                 06279000
CVTRV224 EQU   CVTRV219                                                 06280000
CVTRV223 EQU   CVTRV219                                                 06281000
CVTRV222 EQU   CVTRV219                                                 06282000
CVTRV221 EQU   CVTRV219                                                 06283000
CVTRV220 EQU   CVTRV219                                                 06284000
CVTRV218 EQU   CVTRV210                                                 06285000
CVTRV217 EQU   CVTRV210                                                 06286000
CVTRV216 EQU   CVTRV210                                                 06287000
CVTRV215 EQU   CVTRV210                                                 06288000
CVTRV214 EQU   CVTRV210                                                 06289000
CVTRV213 EQU   CVTRV210                                                 06290000
CVTRV212 EQU   CVTRV210                                                 06291000
CVTRV211 EQU   CVTRV210                                                 06292000
CVTIPCRP EQU   CVTS01+412                                               06293000
CVTIPCRI EQU   CVTS01+408                                               06294000
CVTIPCDS EQU   CVTS01+404                                               06295000
CVTAIDVT EQU   CVTS01+400                                               06296000
CVTSSAP  EQU   CVTS01+396                                               06297000
CVTEHCIR EQU   CVTS01+392                                               06298000
CVTEHDEF EQU   CVTS01+388                                               06299000
CVTDAIR  EQU   CVTS01+384                                               06300000
CVTPERFM EQU   CVTS01+380                                               06301000
CVT044R2 EQU   CVTS01+376                                               06302000
CVTFETCH EQU   CVTS01+372                                               06303000
CVTRSTWD EQU   CVTS01+368                                               06304000
CVTSPOST EQU   CVTS01+364                                               06305000
CVTIOBP  EQU   CVTS01+360                                               06306000
CVTASMVT EQU   CVTS01+356                                               06307000
CVTRECRQ EQU   CVTS01+352                                               06308000
CVTWSAC  EQU   CVTS01+348                                               06309000
CVTRV149 EQU   CVTS01+344                                               06310000
CVTWSAL  EQU   CVTS01+340                                               06311000
CVTVEAC0 EQU   CVTS01+328                                               06312000
CVT062R1 EQU   CVTS01+324                                               06313000
CVTRPOST EQU   CVTS01+320                                               06314000
CVTDQIQE EQU   CVTS01+316                                               06315000
CVTLKRMA EQU   CVTS01+308                                               06316000
CVTRSPIE EQU   CVTS01+304                                               06317000
CVTRENQ  EQU   CVTS01+300                                               06318000
CVTLQCB  EQU   CVTS01+296                                               06319000
CVTFQCB  EQU   CVTS01+292                                               06320000
CVTQCS01 EQU   CVTS01+288                                               06321000
CVTAPFT  EQU   CVTS01+284                                               06322000
CVTPARRL EQU   CVTS01+280                                               06323000
CVTVWAIT EQU   CVTS01+276                                               06324000
CVTGSPL  EQU   CVTS01+272                                               06325000
CVTLSMQ  EQU   CVTS01+268                                               06326000
CVTGSMQ  EQU   CVTS01+264                                               06327000
CVTEXPRO EQU   CVTS01+260                                               06328000
CVTOPCTP EQU   CVTS01+256                                               06329000
CVTSIC   EQU   CVTS01+252                                               06330000
CVTTPIOS EQU   CVTS01+248                                               06331000
CVTRTMS  EQU   CVTS01+244                                               06332000
CVTSDBF  EQU   CVTS01+240                                               06333000
CVTSCBP  EQU   CVTS01+236                                               06334000
CVTSDMP  EQU   CVTS01+232                                               06335000
CVTSV60  EQU   CVTS01+228                                               06336000
CVTRTMCT EQU   CVTS01+224                                               06337000
CVTASCBL EQU   CVTS01+220                                               06338000
CVTASCBH EQU   CVTS01+216                                               06339000
CVTGDA   EQU   CVTS01+212                                               06340000
CVTASVT  EQU   CVTS01+208                                               06341000
CVTVVMDI EQU   CVTS01+204                                               06342000
CVTAQTOP EQU   CVTS01+200                                               06343000
CVTIOSCS EQU   CVTS01+196                                               06344000
CVTSDRM  EQU   CVTS01+192                                               06345000
CVTOPTE  EQU   CVTS01+188                                               06346000
CVTSTXU  EQU   CVTS01+184                                               06347000
CVTQUIS  EQU   CVTS01+180                                               06348000
CVTPARS  EQU   CVTS01+176                                               06349000
CVTS1EE  EQU   CVTS01+172                                               06350000
CVTFRAS  EQU   CVTS01+168                                               06351000
CVTQSAS  EQU   CVTS01+164                                               06352000
CVTCRAS  EQU   CVTS01+160                                               06353000
CVTCRMN  EQU   CVTS01+156                                               06354000
CVTDELCP EQU   CVTS01+152                                               06355000
CVTFRECL EQU   CVTS01+148                                               06356000
CVTGETCL EQU   CVTS01+144                                               06357000
CVTBLDCP EQU   CVTS01+140                                               06358000
CVTAUTHL EQU   CVTS01+136                                               06359000
CVTSCAN  EQU   CVTS01+132                                               06360000
CVTRV144 EQU   CVTS01+130                                               06361000
CVTMAXMP EQU   CVTS01+128                                               06362000
CVTSTCK  EQU   CVTS01+124                                               06363000
CVTRV139 EQU   CVTS01+123                                               06364000
CVTDSSAC EQU   CVTS01+122                                               06365000
CVTRV513 EQU   CVTS01+121                                               06366000
CVTIOSPL EQU   CVTS01+120                                               06367000
CVTPTGT  EQU   CVTS01+116                                               06368000
CVTCSPIE EQU   CVTS01+112                                               06369000
CVTSMFEX EQU   CVTS01+108                                               06370000
CVTOLT0A EQU   CVTS01+104                                               06371000
CVTSRBRT EQU   CVTS01+100                                               06372000
CVTPUTL  EQU   CVTS01+96                                                06373000
CVTASCRL EQU   CVTS01+92                                                06374000
CVTASCRF EQU   CVTS01+88                                                06375000
CVTRV326 EQU   CVTS01+84                                                06376000
CVTRV325 EQU   CVTS01+80                                                06377000
CVTRV324 EQU   CVTS01+76                                                06378000
CVT0VL01 EQU   CVTS01+72                                                06379000
CVTSHRVM EQU   CVTS01+68                                                06380000
CVTRV332 EQU   CVTS01+64                                                06381000
CVTTAS   EQU   CVTS01+60                                                06382000
CVTRSCN  EQU   CVTS01+56                                                06383000
CVTTRAC2 EQU   CVTS01+54                                                06384000
CVTTRACE EQU   CVTS01+52                                                06385000
CVTAPG   EQU   CVTS01+51                                                06386000
CVTSDTRC EQU   CVTCTLFG                                                 06387000
CVTGTRCE EQU   CVTCTLFG                                                 06388000
CVTNOMP  EQU   CVTCTLFG                                                 06389000
CVTRSV79 EQU   CVTCTLFG                                                 06390000
CVTDSTAT EQU   CVTCTLFG                                                 06391000
CVTRSV78 EQU   CVTCTLFG                                                 06392000
CVTRV333 EQU   CVTCTLFG                                                 06393000
CVTRV323 EQU   CVTCTLFG                                                 06394000
CVTSPVLK EQU   CVTS01+49                                                06395000
CVTRSV77 EQU   CVTS01+48                                                06396000
CVTRV331 EQU   CVTS01+44                                                06397000
CVTRV330 EQU   CVTS01+40                                                06398000
CVTRV329 EQU   CVTS01+36                                                06399000
CVTRV328 EQU   CVTS01+32                                                06400000
CVTRV322 EQU   CVTS01+28                                                06401000
CVTSLID  EQU   CVTSLIDA+1                                               06402000
CVTSYLK  EQU   CVTSLIDA                                                 06403000
CVTRV321 EQU   CVTS01+20                                                06404000
CVTRV320 EQU   CVTS01+16                                                06405000
CVTLPDIR EQU   CVTLPDIA+1                                               06406000
CVTRSV69 EQU   CVTDIRST                                                 06407000
CVTRSV68 EQU   CVTDIRST                                                 06408000
CVTRSV67 EQU   CVTDIRST                                                 06409000
CVTRSV66 EQU   CVTDIRST                                                 06410000
CVTRSV65 EQU   CVTDIRST                                                 06411000
CVTRSV64 EQU   CVTDIRST                                                 06412000
CVTRSV63 EQU   CVTDIRST                                                 06413000
CVTDICOM EQU   CVTDIRST                                                 06414000
CVTPVTP  EQU   CVTS01+8                                                 06415000
CVTLPDSR EQU   CVTS01+4                                                 06416000
CVTGETL  EQU   CVTS01                                                   06417000
@NM00003 EQU   MSG133+46                                                06418000
MSGCPU   EQU   MSGCPUID                                                 06419000
@NM00002 EQU   MSG133                                                   06420000
@NM00001 EQU   AHL133                                                   06421000
MCASWORK EQU   MCAWSA+644                                               06422000
MCAWORK  EQU   MCAWSA+584                                               06423000
MCAREC   EQU   MCAWSA+284                                               06424000
MCARECPR EQU   MCAWSA+268                                               06425000
@NM00102 EQU   MCATRL8                                                  06426000
@NM00101 EQU   MCATRL8                                                  06427000
@NM00100 EQU   MCATRL8                                                  06428000
@NM00099 EQU   MCATRL8                                                  06429000
MCAFRECT EQU   MCATRL7                                                  06430000
MCAFRECC EQU   MCATRL7                                                  06431000
MCAFRESP EQU   MCATRL7                                                  06432000
MCAFREXJ EQU   MCATRL7                                                  06433000
MCAFRSBR EQU   MCATRL6                                                  06434000
MCAFRDMJ EQU   MCATRL6                                                  06435000
MCAFRDPC EQU   MCATRL6                                                  06436000
MCAFRPIC EQU   MCATRL6                                                  06437000
MCAFRPIJ EQU   MCATRL6                                                  06438000
@NM00098 EQU   MCATRL5                                                  06439000
MCADREGS EQU   MCATRL5                                                  06440000
MCAFRRB  EQU   MCATRL5                                                  06441000
MCAFRRJ  EQU   MCATRL5                                                  06442000
MCAFRRA  EQU   MCATRL5                                                  06443000
MCAFRERT EQU   MCATRL5                                                  06444000
MCAFREPC EQU   MCATRL5                                                  06445000
MCAMJOBN EQU   MCATRL4                                                  06446000
MCAMSDWA EQU   MCATRL4                                                  06447000
MCAMBTU  EQU   MCATRL4                                                  06448000
MCAMIOSB EQU   MCATRL4                                                  06449000
MCAMTCB  EQU   MCATRL4                                                  06450000
MCAMASCB EQU   MCATRL4                                                  06451000
MCAMUCB  EQU   MCATRL4                                                  06452000
MCAMEXT  EQU   MCATRL4                                                  06453000
MCAFRFRT EQU   MCATRL3                                                  06454000
MCAFRFA  EQU   MCATRL3                                                  06455000
MCAFRSJ  EQU   MCATRL3                                                  06456000
MCAFRSA  EQU   MCATRL3                                                  06457000
MCAPIF   EQU   MCATRL3                                                  06458000
MCASIOF  EQU   MCATRL3                                                  06459000
MCAIOF   EQU   MCATRL3                                                  06460000
MCASVCF  EQU   MCATRL3                                                  06461000
MCATDIR  EQU   MCATRL2                                                  06462000
MCALSR   EQU   MCATRL2                                                  06463000
MCAERROR EQU   MCATRL2                                                  06464000
MCAUIO   EQU   MCATRL2                                                  06465000
MCASTA   EQU   MCATRL2                                                  06466000
MCAFRR   EQU   MCATRL2                                                  06467000
MCASRM   EQU   MCATRL2                                                  06468000
MCARNIO  EQU   MCATRL2                                                  06469000
MCAUSR   EQU   MCATRL1                                                  06470000
MCAPI    EQU   MCATRL1                                                  06471000
MCASRB   EQU   MCATRL1                                                  06472000
MCADSP   EQU   MCATRL1                                                  06473000
MCASIO   EQU   MCATRL1                                                  06474000
MCAIO    EQU   MCATRL1                                                  06475000
MCAEXT   EQU   MCATRL1                                                  06476000
MCASVC   EQU   MCATRL1                                                  06477000
MCAMSG   EQU   MCAWSA+192                                               06478000
MCASETEV EQU   MCAWSA+128                                               06479000
MCAFWORK EQU   MCAWSA+112                                               06480000
MCASFEOB EQU   MCAWSA+56                                                06481000
MCASBLOK EQU   MCAWSA                                                   06482000
MCREID   EQU   MCRWSA+134                                               06483000
MCRRESV  EQU   MCRWSAF                                                  06484000
MCRBRENT EQU   MCRWSAF                                                  06485000
MCERROR  EQU   MCRWSAF                                                  06486000
MCINFGBR EQU   MCRWSAF                                                  06487000
MCINCTL  EQU   MCRWSAF                                                  06488000
MCROUTSA EQU   MCRWSA+64                                                06489000
MCRMCIH  EQU   MCRWSA                                                   06490000
MCCLFLG2 EQU   MCCLFLGS+1                                               06491000
MCCLRESV EQU   MCCLFLG1                                                 06492000
MCCLDIS  EQU   MCCLFLG1                                                 06493000
MCEEFLG2 EQU   MCEEFLGS+1                                               06494000
MCEERESV EQU   MCEEFLG1                                                 06495000
MCEEDIS  EQU   MCEEFLG1                                                 06496000
@NM00097 EQU   MCQE+42                                                  06497000
@NM00096 EQU   MCQEFLGS                                                 06498000
MCQESCHE EQU   MCQE+40                                                  06499000
MCQEAT   EQU   MCQE+32                                                  06500000
MCCDRESV EQU   MCCDFLG1                                                 06501000
MCCDDEL  EQU   MCCDFLG1                                                 06502000
MCHEADTR EQU   MCHEAD+48                                                06503000
MCHEADRD EQU   MCHEAD+44                                                06504000
MCHFRRAD EQU   MCHEAD+40                                                06505000
MCHMCER  EQU   MCHEAD+36                                                06506000
MCHSETE  EQU   MCHEAD+28                                                06507000
@NM00095 EQU   MCHFLGS+1                                                06508000
@NM00094 EQU   MCHFLG1                                                  06509000
MCHDIS   EQU   MCHEAD+20                                                06510000
MCHIDEN  EQU   MCHEAD                                                   06511000
FRRSPARM EQU   FRRSENTR+8                                               06512000
@NM00093 EQU   FRRSFLGS+1                                               06513000
@NM00092 EQU   FRRSFLG1                                                 06514000
FRRSNEST EQU   FRRSFLG1                                                 06515000
FRRSRCUR EQU   FRRSFLG1                                                 06516000
FRRSFRRA EQU   FRRSENTR                                                 06517000
FRRSENTS EQU   FRRS+84                                                  06518000
FRRSRTMW EQU   FRRS+16                                                  06519000
FRRSCURR EQU   FRRSHEAD+12                                              06520000
FRRSELEN EQU   FRRSHEAD+8                                               06521000
FRRSLAST EQU   FRRSHEAD+4                                               06522000
FRRSEMP  EQU   FRRSHEAD                                                 06523000
@NM00091 EQU   SDWA+512                                                 06524000
SDWAVRA  EQU   SDWARA+4                                                 06525000
SDWAURAL EQU   SDWARA+3                                                 06526000
@NM00090 EQU   SDWADPVA                                                 06527000
SDWAEBC  EQU   SDWADPVA                                                 06528000
SDWAHEX  EQU   SDWADPVA                                                 06529000
SDWAVRAL EQU   SDWARA                                                   06530000
@NM00089 EQU   SDWA+396                                                 06531000
SDWACOMP EQU   SDWA+392                                                 06532000
SDWARCPL EQU   SDWA+364                                                 06533000
@NM00088 EQU   SDWADPSA+32                                              06534000
SDWATO4  EQU   SDWADPSL+28                                              06535000
SDWAFRM4 EQU   SDWADPSL+24                                              06536000
SDWATO3  EQU   SDWADPSL+20                                              06537000
SDWAFRM3 EQU   SDWADPSL+16                                              06538000
SDWATO2  EQU   SDWADPSL+12                                              06539000
SDWAFRM2 EQU   SDWADPSL+8                                               06540000
SDWATO1  EQU   SDWADPSL+4                                               06541000
SDWAFRM1 EQU   SDWADPSL                                                 06542000
@NM00087 EQU   SDWADDAT+3                                               06543000
@NM00086 EQU   SDWAPDAT                                                 06544000
SDWAUSPL EQU   SDWAPDAT                                                 06545000
SDWADPSW EQU   SDWAPDAT                                                 06546000
SDWATJPA EQU   SDWAPDAT                                                 06547000
SDWATLPA EQU   SDWAPDAT                                                 06548000
SDWADREG EQU   SDWAPDAT                                                 06549000
SDWADSAH EQU   SDWAPDAT                                                 06550000
SDWADSAS EQU   SDWAPDAT                                                 06551000
@NM00085 EQU   SDWADDAT+1                                               06552000
@NM00084 EQU   SDWASDAT                                                 06553000
SDWAQQS  EQU   SDWASDAT                                                 06554000
SDWACBS  EQU   SDWASDAT                                                 06555000
SDWAGTF  EQU   SDWASDAT                                                 06556000
SDWASWA  EQU   SDWASDAT                                                 06557000
SDWALSQA EQU   SDWASDAT                                                 06558000
SDWASQA  EQU   SDWASDAT                                                 06559000
SDWANUC  EQU   SDWASDAT                                                 06560000
@NM00083 EQU   SDWADUMP+2                                               06561000
@NM00082 EQU   SDWADPFS                                                 06562000
SDWASLST EQU   SDWADPFS                                                 06563000
@NM00081 EQU   SDWADPFS                                                 06564000
SDWADLST EQU   SDWADPFS                                                 06565000
SDWADPT  EQU   SDWADPFS                                                 06566000
SDWADPID EQU   SDWADUMP                                                 06567000
SDWADPLA EQU   SDWA+316                                                 06568000
SDWAREXN EQU   SDWARECP+16                                              06569000
SDWACSCT EQU   SDWARECP+8                                               06570000
SDWAMODN EQU   SDWARECP                                                 06571000
@NM00080 EQU   SDWALKWA+32                                              06572000
SDWATALW EQU   SDWALKWS+28                                              06573000
SDWATDLW EQU   SDWALKWS+24                                              06574000
SDWATNLW EQU   SDWALKWS+20                                              06575000
SDWAAPLW EQU   SDWALKWS+16                                              06576000
SDWAIPLW EQU   SDWALKWS+12                                              06577000
SDWAILLW EQU   SDWALKWS+8                                               06578000
SDWAIULW EQU   SDWALKWS+4                                               06579000
SDWAICLW EQU   SDWALKWS                                                 06580000
SDWAFLLK EQU   SDWAACF4                                                 06581000
SDWACMS  EQU   SDWAACF4                                                 06582000
SDWAOPTM EQU   SDWAACF4                                                 06583000
SDWATADB EQU   SDWAACF4                                                 06584000
SDWATDNB EQU   SDWAACF4                                                 06585000
SDWATNCB EQU   SDWAACF4                                                 06586000
SDWAILCH EQU   SDWAACF4                                                 06587000
SDWAIUCB EQU   SDWAACF4                                                 06588000
SDWAICAT EQU   SDWAACF3                                                 06589000
SDWAIPRG EQU   SDWAACF3                                                 06590000
SDWASALL EQU   SDWAACF3                                                 06591000
SDWAASMP EQU   SDWAACF3                                                 06592000
SDWADISP EQU   SDWAACF3                                                 06593000
@NM00079 EQU   SDWAACF3                                                 06594000
@NM00078 EQU   SDWAACF2                                                 06595000
@NM00077 EQU   SDWAACF2                                                 06596000
SDWASPIN EQU   SDWAACF2                                                 06597000
@NM00076 EQU   SDWAACF2                                                 06598000
SDWARCRD EQU   SDWAACF2                                                 06599000
SDWALCPU EQU   SDWACPUA+2                                               06600000
@NM00075 EQU   SDWACPUA                                                 06601000
SDWARECA EQU   SDWA+244                                                 06602000
@NM00074 EQU   SDWA+239                                                 06603000
@NM00073 EQU   SDWAIOFS                                                 06604000
SDWANIOP EQU   SDWAIOFS                                                 06605000
SDWANOIO EQU   SDWAIOFS                                                 06606000
SDWAIOHT EQU   SDWAIOFS                                                 06607000
SDWAIOQR EQU   SDWAIOFS                                                 06608000
SDWAFMID EQU   SDWA+236                                                 06609000
@NM00072 EQU   SDWAERRD                                                 06610000
SDWAMCIV EQU   SDWAERRD                                                 06611000
SDWARPIV EQU   SDWAERRD                                                 06612000
SDWAMABD EQU   SDWAERRD                                                 06613000
SDWACTS  EQU   SDWAERRD                                                 06614000
SDWASTAE EQU   SDWAERRD                                                 06615000
SDWANRBE EQU   SDWAERRD                                                 06616000
SDWACLUP EQU   SDWAERRD                                                 06617000
@NM00071 EQU   SDWAERRC                                                 06618000
SDWAEAS  EQU   SDWAERRC                                                 06619000
SDWAPERC EQU   SDWAERRC                                                 06620000
SDWAIRB  EQU   SDWAERRC                                                 06621000
SDWASTAI EQU   SDWAERRC                                                 06622000
SDWASTAF EQU   SDWAERRC                                                 06623000
SDWASRBM EQU   SDWAERRB                                                 06624000
SDWALDIS EQU   SDWAERRB                                                 06625000
SDWAENRB EQU   SDWAERRB                                                 06626000
SDWATYP1 EQU   SDWAERRB                                                 06627000
@NM00070 EQU   SDWAERRB                                                 06628000
SDWAPGIO EQU   SDWAERRA                                                 06629000
SDWATEXC EQU   SDWAERRA                                                 06630000
SDWASVCE EQU   SDWAERRA                                                 06631000
SDWAABTM EQU   SDWAERRA                                                 06632000
SDWASVCD EQU   SDWAERRA                                                 06633000
SDWARKEY EQU   SDWAERRA                                                 06634000
SDWAMCHK EQU   SDWAERRA                                                 06635000
SDWATIME EQU   SDWAMCH+20                                               06636000
SDWARFSA EQU   SDWAMCH+16                                               06637000
@NM00069 EQU   SDWAMCH+14                                               06638000
SDWAVEQR EQU   SDWARSR2                                                 06639000
SDWAPGFX EQU   SDWARSR2                                                 06640000
SDWAFLSQ EQU   SDWARSR2                                                 06641000
SDWAFSQA EQU   SDWARSR2                                                 06642000
SDWANUCL EQU   SDWARSR2                                                 06643000
SDWASPER EQU   SDWARSR2                                                 06644000
SDWAINTC EQU   SDWARSR2                                                 06645000
SDWAOFLN EQU   SDWARSR2                                                 06646000
SDWACHNG EQU   SDWARSR1                                                 06647000
SDWAMSER EQU   SDWARSR1                                                 06648000
@NM00068 EQU   SDWARSR1                                                 06649000
SDWACPID EQU   SDWAMCH+10                                               06650000
SDWATERR EQU   SDWAMCHD                                                 06651000
SDWAFPRX EQU   SDWAMCHD                                                 06652000
SDWAINSF EQU   SDWAMCHD                                                 06653000
SDWAACR  EQU   SDWAMCHD                                                 06654000
SDWASCK  EQU   SDWAMCHD                                                 06655000
SDWAPSWU EQU   SDWAMCHD                                                 06656000
SDWAREGU EQU   SDWAMCHD                                                 06657000
SDWASKYF EQU   SDWAMCHD                                                 06658000
@NM00067 EQU   SDWAMCHS                                                 06659000
SDWARSRF EQU   SDWAMCHS                                                 06660000
SDWARSRC EQU   SDWAMCHS                                                 06661000
SDWAINVP EQU   SDWAMCHS                                                 06662000
SDWATSVL EQU   SDWAMCHS                                                 06663000
SDWARCDF EQU   SDWAMCHS                                                 06664000
SDWASRVL EQU   SDWAMCHS                                                 06665000
SDWASCKE EQU   SDWASTCK+4                                               06666000
SDWASCKB EQU   SDWASTCK                                                 06667000
SDWALNTH EQU   SDWAIDNT+1                                               06668000
SDWASPID EQU   SDWAIDNT                                                 06669000
SDWASR15 EQU   SDWASRSV+60                                              06670000
SDWASR14 EQU   SDWASRSV+56                                              06671000
SDWASR13 EQU   SDWASRSV+52                                              06672000
SDWASR12 EQU   SDWASRSV+48                                              06673000
SDWASR11 EQU   SDWASRSV+44                                              06674000
SDWASR10 EQU   SDWASRSV+40                                              06675000
SDWASR09 EQU   SDWASRSV+36                                              06676000
SDWASR08 EQU   SDWASRSV+32                                              06677000
SDWASR07 EQU   SDWASRSV+28                                              06678000
SDWASR06 EQU   SDWASRSV+24                                              06679000
SDWASR05 EQU   SDWASRSV+20                                              06680000
SDWASR04 EQU   SDWASRSV+16                                              06681000
SDWASR03 EQU   SDWASRSV+12                                              06682000
SDWASR02 EQU   SDWASRSV+8                                               06683000
SDWASR01 EQU   SDWASRSV+4                                               06684000
SDWASR00 EQU   SDWASRSV                                                 06685000
SDWATRN2 EQU   SDWAAEC2+4                                               06686000
SDWAIPC2 EQU   SDWAICD2                                                 06687000
SDWAIMC2 EQU   SDWAICD2                                                 06688000
SDWAIPR2 EQU   SDWAICD2                                                 06689000
@NM00066 EQU   SDWAINC2                                                 06690000
@NM00065 EQU   SDWAILC2                                                 06691000
SDWAIL2  EQU   SDWAILC2                                                 06692000
@NM00064 EQU   SDWAILC2                                                 06693000
@NM00063 EQU   SDWAAEC2                                                 06694000
SDWAADD2 EQU   SDWANXT2+1                                               06695000
@NM00062 EQU   SDWANXT2                                                 06696000
@NM00061 EQU   SDWAEC2+3                                                06697000
SDWASGN2 EQU   SDWAINT2                                                 06698000
SDWAEXP2 EQU   SDWAINT2                                                 06699000
SDWADEC2 EQU   SDWAINT2                                                 06700000
SDWAFPO2 EQU   SDWAINT2                                                 06701000
SDWACC2  EQU   SDWAINT2                                                 06702000
@NM00060 EQU   SDWAINT2                                                 06703000
SDWAPGM2 EQU   SDWAMWP2                                                 06704000
SDWAWAT2 EQU   SDWAMWP2                                                 06705000
SDWAMCK2 EQU   SDWAMWP2                                                 06706000
SDWAECT2 EQU   SDWAMWP2                                                 06707000
SDWAKEY2 EQU   SDWAMWP2                                                 06708000
SDWAEXT2 EQU   SDWAEMK2                                                 06709000
SDWAIO2  EQU   SDWAEMK2                                                 06710000
SDWATRM2 EQU   SDWAEMK2                                                 06711000
@NM00059 EQU   SDWAEMK2                                                 06712000
SDWAPER2 EQU   SDWAEMK2                                                 06713000
@NM00058 EQU   SDWAEMK2                                                 06714000
SDWATRAN EQU   SDWAAEC1+4                                               06715000
SDWAIPC1 EQU   SDWAICD1                                                 06716000
SDWAIMC1 EQU   SDWAICD1                                                 06717000
SDWAIPR1 EQU   SDWAICD1                                                 06718000
@NM00057 EQU   SDWAINC1                                                 06719000
@NM00056 EQU   SDWAILC1                                                 06720000
SDWAIL1  EQU   SDWAILC1                                                 06721000
@NM00055 EQU   SDWAILC1                                                 06722000
@NM00054 EQU   SDWAAEC1                                                 06723000
SDWAADD1 EQU   SDWANXT1+1                                               06724000
@NM00053 EQU   SDWANXT1                                                 06725000
@NM00052 EQU   SDWAEC1+3                                                06726000
SDWASGN1 EQU   SDWAINT1                                                 06727000
SDWAEXP1 EQU   SDWAINT1                                                 06728000
SDWADEC1 EQU   SDWAINT1                                                 06729000
SDWAFPO1 EQU   SDWAINT1                                                 06730000
SDWACC1  EQU   SDWAINT1                                                 06731000
@NM00051 EQU   SDWAINT1                                                 06732000
SDWAPGM1 EQU   SDWAMWP1                                                 06733000
SDWAWAT1 EQU   SDWAMWP1                                                 06734000
SDWAMCK1 EQU   SDWAMWP1                                                 06735000
SDWAECT1 EQU   SDWAMWP1                                                 06736000
SDWAKEY1 EQU   SDWAMWP1                                                 06737000
SDWAEXT1 EQU   SDWAEMK1                                                 06738000
SDWAIO1  EQU   SDWAEMK1                                                 06739000
SDWATRM1 EQU   SDWAEMK1                                                 06740000
@NM00050 EQU   SDWAEMK1                                                 06741000
SDWAPER1 EQU   SDWAEMK1                                                 06742000
@NM00049 EQU   SDWAEMK1                                                 06743000
SDWAIOBR EQU   SDWA+100                                                 06744000
SDWAEPA  EQU   SDWA+96                                                  06745000
@NM00048 EQU   SDWANAME+4                                               06746000
SDWARBAD EQU   SDWANAME                                                 06747000
SDWAGR15 EQU   SDWAGRSV+60                                              06748000
SDWAGR14 EQU   SDWAGRSV+56                                              06749000
SDWAGR13 EQU   SDWAGRSV+52                                              06750000
SDWAGR12 EQU   SDWAGRSV+48                                              06751000
SDWAGR11 EQU   SDWAGRSV+44                                              06752000
SDWAGR10 EQU   SDWAGRSV+40                                              06753000
SDWAGR09 EQU   SDWAGRSV+36                                              06754000
SDWAGR08 EQU   SDWAGRSV+32                                              06755000
SDWAGR07 EQU   SDWAGRSV+28                                              06756000
SDWAGR06 EQU   SDWAGRSV+24                                              06757000
SDWAGR05 EQU   SDWAGRSV+20                                              06758000
SDWAGR04 EQU   SDWAGRSV+16                                              06759000
SDWAGR03 EQU   SDWAGRSV+12                                              06760000
SDWAGR02 EQU   SDWAGRSV+8                                               06761000
SDWAGR01 EQU   SDWAGRSV+4                                               06762000
SDWAGR00 EQU   SDWAGRSV                                                 06763000
SDWANXTP EQU   SDWACTL2+5                                               06764000
SDWASGP  EQU   SDWAPMKP                                                 06765000
SDWAEUP  EQU   SDWAPMKP                                                 06766000
SDWADOP  EQU   SDWAPMKP                                                 06767000
SDWAFPP  EQU   SDWAPMKP                                                 06768000
SDWACCP  EQU   SDWAPMKP                                                 06769000
SDWAILP  EQU   SDWAPMKP                                                 06770000
SDWAINTP EQU   SDWACTL2+2                                               06771000
SDWASPVP EQU   SDWAMWPP                                                 06772000
SDWAWATP EQU   SDWAMWPP                                                 06773000
SDWAMCKP EQU   SDWAMWPP                                                 06774000
@NM00047 EQU   SDWAMWPP                                                 06775000
SDWAKEYP EQU   SDWAMWPP                                                 06776000
SDWAEXTP EQU   SDWACMKP                                                 06777000
SDWAIOP  EQU   SDWACMKP                                                 06778000
SDWANXTA EQU   SDWACTL1+5                                               06779000
SDWASGA  EQU   SDWAPMKA                                                 06780000
SDWAEUA  EQU   SDWAPMKA                                                 06781000
SDWADOA  EQU   SDWAPMKA                                                 06782000
SDWAFPA  EQU   SDWAPMKA                                                 06783000
SDWACCA  EQU   SDWAPMKA                                                 06784000
SDWAILA  EQU   SDWAPMKA                                                 06785000
SDWAINTA EQU   SDWACTL1+2                                               06786000
SDWASPVA EQU   SDWAMWPA                                                 06787000
SDWAWATA EQU   SDWAMWPA                                                 06788000
SDWAMCKA EQU   SDWAMWPA                                                 06789000
@NM00046 EQU   SDWAMWPA                                                 06790000
SDWAKEYA EQU   SDWAMWPA                                                 06791000
SDWAEXTA EQU   SDWACMKA                                                 06792000
SDWAIOA  EQU   SDWACMKA                                                 06793000
SDWACMPC EQU   SDWAABCC+1                                               06794000
@NM00045 EQU   SDWACMPF                                                 06795000
SDWASTCC EQU   SDWACMPF                                                 06796000
@NM00044 EQU   SDWACMPF                                                 06797000
SDWASTEP EQU   SDWACMPF                                                 06798000
SDWAREQ  EQU   SDWACMPF                                                 06799000
WSACASMS EQU   WSAC+60                                                  06800000
WSACASMD EQU   WSAC+56                                                  06801000
WSACCCH  EQU   WSAC+52                                                  06802000
WSACRRSA EQU   WSAC+48                                                  06803000
WSACREST EQU   WSAC+44                                                  06804000
WSACRSTI EQU   WSAC+40                                                  06805000
WSACABTM EQU   WSAC+36                                                  06806000
WSACMF1  EQU   WSAC+32                                                  06807000
WSACEDS0 EQU   WSAC+28                                                  06808000
WSACIOS  EQU   WSAC+24                                                  06809000
WSACRTMK EQU   WSAC+20                                                  06810000
WSACACR  EQU   WSAC+16                                                  06811000
WSACTIME EQU   WSAC+12                                                  06812000
WSACOPTM EQU   WSAC+8                                                   06813000
WSACCWSA EQU   WSAC                                                     06814000
WSAGSCHE EQU   WSAG+40                                                  06815000
WSAGREST EQU   WSAG+36                                                  06816000
WSAGNQDQ EQU   WSAG+32                                                  06817000
WSAGMEMT EQU   WSAG+28                                                  06818000
WSAGOPTM EQU   WSAG+24                                                  06819000
WSAGSTAT EQU   WSAG+20                                                  06820000
WSAGEMS0 EQU   WSAG+16                                                  06821000
WSAGSSRS EQU   WSAG+12                                                  06822000
WSAGRSM  EQU   WSAG+8                                                   06823000
WSAGPGIO EQU   WSAG                                                     06824000
LCCAR125 EQU   LCCA+964                                                 06825000
LCCAR124 EQU   LCCA+960                                                 06826000
LCCASGPR EQU   LCCA+896                                                 06827000
LCCADRT2 EQU   LCCA+888                                                 06828000
LCCADRT1 EQU   LCCA+880                                                 06829000
LCCAR103 EQU   LCCA+876                                                 06830000
LCCAESS2 EQU   LCCA+872                                                 06831000
LCCASPLJ EQU   LCCA+868                                                 06832000
LCCASMQJ EQU   LCCA+864                                                 06833000
LCCAIRT  EQU   LCCA+736                                                 06834000
LCCAASID EQU   LCCA+732                                                 06835000
LCCARV89 EQU   LCCA+728                                                 06836000
LCCAPGTA EQU   LCCASRBF+2                                               06837000
LCCASAFN EQU   LCCASRBF                                                 06838000
LCCAECSA EQU   LCCA+716                                                 06839000
LCCAICR0 EQU   LCCA+712                                                 06840000
LCCALWTM EQU   LCCA+704                                                 06841000
LCCARV78 EQU   LCCA+700                                                 06842000
LCCAPINV EQU   LCCA+696                                                 06843000
LCCARV88 EQU   LCCA+695                                                 06844000
LCCARV87 EQU   LCCALKFG                                                 06845000
LCCARV86 EQU   LCCALKFG                                                 06846000
LCCARV85 EQU   LCCALKFG                                                 06847000
LCCARV84 EQU   LCCALKFG                                                 06848000
LCCALKRD EQU   LCCALKFG                                                 06849000
LCCALKAQ EQU   LCCALKFG                                                 06850000
LCCALKSA EQU   LCCALKFG                                                 06851000
LCCALKDP EQU   LCCALKFG                                                 06852000
LCCACRST EQU   LCCACREX                                                 06853000
LCCACRDP EQU   LCCACREX                                                 06854000
LCCACRLM EQU   LCCACREX                                                 06855000
LCCACRIN EQU   LCCACREX                                                 06856000
LCCACRRT EQU   LCCACREX                                                 06857000
LCCACRLE EQU   LCCACREX                                                 06858000
LCCACRRM EQU   LCCACREX                                                 06859000
LCCACREF EQU   LCCACREX                                                 06860000
LCCAVARY EQU   LCCACRFL                                                 06861000
LCCARV73 EQU   LCCACRFL                                                 06862000
LCCARV72 EQU   LCCACRFL                                                 06863000
LCCARV71 EQU   LCCACRFL                                                 06864000
LCCARV70 EQU   LCCACRFL                                                 06865000
LCCARV69 EQU   LCCACRFL                                                 06866000
LCCACLMS EQU   LCCACRFL                                                 06867000
LCCACRTM EQU   LCCACRFL                                                 06868000
LCCALCR0 EQU   LCCA+688                                                 06869000
LCCACRLC EQU   LCCA+684                                                 06870000
LCCARCPU EQU   LCCA+680                                                 06871000
LCCADCPU EQU   LCCA+676                                                 06872000
LCCASRBJ EQU   LCCA+672                                                 06873000
LCCADSSR EQU   LCCA+668                                                 06874000
LCCADSSC EQU   LCCA+660                                                 06875000
LCCADSS3 EQU   LCCA+648                                                 06876000
LCCADSS2 EQU   LCCA+636                                                 06877000
LCCADSS1 EQU   LCCA+624                                                 06878000
LCCAWTIM EQU   LCCA+616                                                 06879000
LCCAITOD EQU   LCCA+608                                                 06880000
LCCADTOD EQU   LCCA+600                                                 06881000
LCCASTOD EQU   LCCA+592                                                 06882000
LCCARIR5 EQU   LCCASPSA+44                                              06883000
LCCARIR4 EQU   LCCASPSA+40                                              06884000
LCCARIR3 EQU   LCCASPSA+36                                              06885000
LCCARIR2 EQU   LCCASPSA+32                                              06886000
LCCARPR5 EQU   LCCASPSA+28                                              06887000
LCCARPR4 EQU   LCCASPSA+24                                              06888000
LCCARPR3 EQU   LCCASPSA+20                                              06889000
LCCARPR2 EQU   LCCASPSA+16                                              06890000
LCCADSR5 EQU   LCCASPSA+12                                              06891000
LCCADSR4 EQU   LCCASPSA+8                                               06892000
LCCADSR3 EQU   LCCASPSA+4                                               06893000
LCCADSR2 EQU   LCCASPSA                                                 06894000
LCCARV68 EQU   LCCA+543                                                 06895000
LCCAPSMK EQU   LCCA+542                                                 06896000
LCCARV67 EQU   LCCADSF2                                                 06897000
LCCARV66 EQU   LCCADSF2                                                 06898000
LCCARV65 EQU   LCCADSF2                                                 06899000
LCCARV64 EQU   LCCADSF2                                                 06900000
LCCADSRW EQU   LCCADSF2                                                 06901000
LCCADSPL EQU   LCCADSF2                                                 06902000
LCCAGSRB EQU   LCCADSF2                                                 06903000
LCCASRBM EQU   LCCADSF2                                                 06904000
LCCARV61 EQU   LCCADSF1                                                 06905000
LCCARV60 EQU   LCCADSF1                                                 06906000
LCCARV59 EQU   LCCADSF1                                                 06907000
LCCARV58 EQU   LCCADSF1                                                 06908000
LCCATIMR EQU   LCCADSF1                                                 06909000
LCCADSS  EQU   LCCADSF1                                                 06910000
LCCAVCPU EQU   LCCADSF1                                                 06911000
LCCAACR  EQU   LCCADSF1                                                 06912000
LCCAASCP EQU   LCCA+532                                                 06913000
LCCAESSA EQU   LCCA+528                                                 06914000
LCCARV55 EQU   LCCASPN4                                                 06915000
LCCARV54 EQU   LCCASPN4                                                 06916000
LCCARV53 EQU   LCCASPN4                                                 06917000
LCCARV52 EQU   LCCASPN4                                                 06918000
LCCARV51 EQU   LCCASPN4                                                 06919000
LCCARV50 EQU   LCCASPN4                                                 06920000
LCCARV49 EQU   LCCASPN4                                                 06921000
LCCARV48 EQU   LCCASPN4                                                 06922000
LCCARV47 EQU   LCCASPN3                                                 06923000
LCCARV46 EQU   LCCASPN3                                                 06924000
LCCARV45 EQU   LCCASPN3                                                 06925000
LCCARV44 EQU   LCCASPN3                                                 06926000
LCCARV43 EQU   LCCASPN3                                                 06927000
LCCARV42 EQU   LCCASPN3                                                 06928000
LCCARV41 EQU   LCCASPN3                                                 06929000
LCCARV40 EQU   LCCASPN3                                                 06930000
LCCARV39 EQU   LCCASPN2                                                 06931000
LCCARV38 EQU   LCCASPN2                                                 06932000
LCCARV37 EQU   LCCASPN2                                                 06933000
LCCARV36 EQU   LCCASPN2                                                 06934000
LCCARV35 EQU   LCCASPN2                                                 06935000
LCCARV34 EQU   LCCASPN2                                                 06936000
LCCARV33 EQU   LCCASPN2                                                 06937000
LCCARV32 EQU   LCCASPN2                                                 06938000
LCCARV31 EQU   LCCASPN1                                                 06939000
LCCARV30 EQU   LCCASPN1                                                 06940000
LCCAMFIO EQU   LCCASPN1                                                 06941000
LCCARSTR EQU   LCCASPN1                                                 06942000
LCCATSPN EQU   LCCASPN1                                                 06943000
LCCALOCK EQU   LCCASPN1                                                 06944000
LCCASIGP EQU   LCCASPN1                                                 06945000
LCCAPTLB EQU   LCCASPN1                                                 06946000
LCCARV27 EQU   LCCAIHR4                                                 06947000
LCCARV26 EQU   LCCAIHR4                                                 06948000
LCCARV25 EQU   LCCAIHR4                                                 06949000
LCCARV24 EQU   LCCAIHR4                                                 06950000
LCCARV23 EQU   LCCAIHR4                                                 06951000
LCCARV22 EQU   LCCAIHR4                                                 06952000
LCCARV21 EQU   LCCAIHR4                                                 06953000
LCCARV20 EQU   LCCAIHR4                                                 06954000
LCCARV19 EQU   LCCAIHR3                                                 06955000
LCCARV18 EQU   LCCAIHR3                                                 06956000
LCCARV17 EQU   LCCAIHR3                                                 06957000
LCCARV16 EQU   LCCAIHR3                                                 06958000
LCCARV15 EQU   LCCAIHR3                                                 06959000
LCCARV14 EQU   LCCAIHR3                                                 06960000
LCCARV13 EQU   LCCAIHR3                                                 06961000
LCCARV12 EQU   LCCAIHR3                                                 06962000
LCCARV11 EQU   LCCAIHR2                                                 06963000
LCCARV10 EQU   LCCAIHR2                                                 06964000
LCCARV09 EQU   LCCAIHR2                                                 06965000
LCCARV08 EQU   LCCAIHR2                                                 06966000
LCCARV07 EQU   LCCAIHR2                                                 06967000
LCCARV06 EQU   LCCAIHR2                                                 06968000
LCCARV05 EQU   LCCAIHR2                                                 06969000
LCCARV04 EQU   LCCAIHR2                                                 06970000
LCCARV03 EQU   LCCAIHR1                                                 06971000
LCCARV02 EQU   LCCAIHR1                                                 06972000
LCCARV01 EQU   LCCAIHR1                                                 06973000
LCCAPPIE EQU   LCCAIHR1                                                 06974000
LCCAPSG1 EQU   LCCAIHR1                                                 06975000
LCCAPDAT EQU   LCCAIHR1                                                 06976000
LCCAXRC2 EQU   LCCAIHR1                                                 06977000
LCCAXRC1 EQU   LCCAIHR1                                                 06978000
LCCAIOPS EQU   LCCA+512                                                 06979000
LCCAGPGR EQU   LCCA+448                                                 06980000
LCCAR133 EQU   LCCA+444                                                 06981000
LCCAR132 EQU   LCCA+440                                                 06982000
LCCAR131 EQU   LCCA+436                                                 06983000
LCCAR130 EQU   LCCA+432                                                 06984000
LCCAR129 EQU   LCCA+428                                                 06985000
LCCAR128 EQU   LCCA+424                                                 06986000
LCCAR127 EQU   LCCA+420                                                 06987000
LCCAR126 EQU   LCCA+416                                                 06988000
LCCARSGR EQU   LCCA+352                                                 06989000
LCCAXGR3 EQU   LCCA+288                                                 06990000
LCCAXGR2 EQU   LCCA+224                                                 06991000
LCCAXGR1 EQU   LCCA+160                                                 06992000
LCCACR0  EQU   LCCA+156                                                 06993000
LCCAMCR1 EQU   LCCA+152                                                 06994000
LCCAPVAD EQU   LCCA+148                                                 06995000
LCCAPINT EQU   LCCA+144                                                 06996000
LCCAPPSW EQU   LCCA+136                                                 06997000
LCCAPGR2 EQU   LCCA+72                                                  06998000
LCCAPGR1 EQU   LCCA+8                                                   06999000
LCCARV77 EQU   LCCA+6                                                   07000000
LCCACPUA EQU   LCCA+4                                                   07001000
LCCALCCA EQU   LCCA                                                     07002000
@NM00019 EQU   PCCA+512                                                 07003000
PCCACAT  EQU   PCCA+384                                                 07004000
PCCARV36 EQU   PCCA+380                                                 07005000
PCCARV35 EQU   PCCA+378                                                 07006000
PCCARV01 EQU   PCCA+377                                                 07007000
PCCACPUM EQU   PCCA+376                                                 07008000
PCCARV63 EQU   PCCA+372                                                 07009000
PCCARV62 EQU   PCCA+368                                                 07010000
PCCARV61 EQU   PCCA+364                                                 07011000
PCCARV60 EQU   PCCA+360                                                 07012000
PCCARV59 EQU   PCCA+356                                                 07013000
PCCARV58 EQU   PCCA+352                                                 07014000
PCCARV57 EQU   PCCA+348                                                 07015000
PCCARV56 EQU   PCCA+344                                                 07016000
PCCARV55 EQU   PCCA+340                                                 07017000
PCCARV54 EQU   PCCA+336                                                 07018000
PCCALOGA EQU   PCCA+332                                                 07019000
PCCACHID EQU   PCCA+324                                                 07020000
PCCACHSV EQU   PCCA+312                                                 07021000
PCCARV79 EQU   PCCACHF4                                                 07022000
PCCARV78 EQU   PCCACHF4                                                 07023000
PCCARV77 EQU   PCCACHF4                                                 07024000
PCCARV76 EQU   PCCACHF4                                                 07025000
PCCARV75 EQU   PCCACHF4                                                 07026000
PCCARV74 EQU   PCCACHF4                                                 07027000
PCCARV73 EQU   PCCACHF4                                                 07028000
PCCARV72 EQU   PCCACHF4                                                 07029000
PCCARV71 EQU   PCCACHF3                                                 07030000
PCCARV70 EQU   PCCACHF3                                                 07031000
PCCARV69 EQU   PCCACHF3                                                 07032000
PCCARV68 EQU   PCCACHF3                                                 07033000
PCCARV67 EQU   PCCACHF3                                                 07034000
PCCARV66 EQU   PCCACHF3                                                 07035000
PCCARV65 EQU   PCCACHF3                                                 07036000
PCCARV64 EQU   PCCACHF3                                                 07037000
PCCACF28 EQU   PCCACHF2                                                 07038000
PCCACF27 EQU   PCCACHF2                                                 07039000
PCCACF26 EQU   PCCACHF2                                                 07040000
PCCACF25 EQU   PCCACHF2                                                 07041000
PCCACF24 EQU   PCCACHF2                                                 07042000
PCCACF23 EQU   PCCACHF2                                                 07043000
PCCACF22 EQU   PCCACHF2                                                 07044000
PCCACF21 EQU   PCCACHF2                                                 07045000
PCCACF18 EQU   PCCACHF1                                                 07046000
PCCACF17 EQU   PCCACHF1                                                 07047000
PCCACF16 EQU   PCCACHF1                                                 07048000
PCCACF15 EQU   PCCACHF1                                                 07049000
PCCACF14 EQU   PCCACHF1                                                 07050000
PCCACF13 EQU   PCCACHF1                                                 07051000
PCCACF12 EQU   PCCACHF1                                                 07052000
PCCACF11 EQU   PCCACHF1                                                 07053000
PCCARV05 EQU   PCCA+306                                                 07054000
PCCACHPB EQU   PCCA+305                                                 07055000
PCCALGP2 EQU   PCCA+304                                                 07056000
PCCALGP1 EQU   PCCA+303                                                 07057000
PCCALOGL EQU   PCCA+302                                                 07058000
PCCARV80 EQU   PCCA+300                                                 07059000
PCCACHW2 EQU   PCCA+296                                                 07060000
PCCACHW1 EQU   PCCA+292                                                 07061000
PCCAIOSI EQU   PCCA+291                                                 07062000
PCCACNRB EQU   PCCACHRB                                                 07063000
PCCACCVB EQU   PCCACHRB                                                 07064000
PCCACSNB EQU   PCCACHRB                                                 07065000
PCCARV52 EQU   PCCACHRB                                                 07066000
PCCACHIB EQU   PCCACHRB                                                 07067000
PCCACTIB EQU   PCCACHRB                                                 07068000
PCCACINB EQU   PCCACHRB                                                 07069000
PCCACSIB EQU   PCCACHRB                                                 07070000
PCCARV51 EQU   PCCACHS2                                                 07071000
PCCARV50 EQU   PCCACHS2                                                 07072000
PCCACCRA EQU   PCCACHS2                                                 07073000
PCCACURC EQU   PCCACHS2                                                 07074000
PCCACNLG EQU   PCCACHS2                                                 07075000
PCCACMOD EQU   PCCACHS2                                                 07076000
PCCACALT EQU   PCCACHS2                                                 07077000
PCCACIOR EQU   PCCACHS2                                                 07078000
PCCARV47 EQU   PCCACHS1                                                 07079000
PCCACUCB EQU   PCCACHS1                                                 07080000
PCCACIBC EQU   PCCACHS1                                                 07081000
PCCACAND EQU   PCCACHS1                                                 07082000
PCCACNLS EQU   PCCACHS1                                                 07083000
PCCACFRR EQU   PCCACHS1                                                 07084000
PCCACNRE EQU   PCCACHS1                                                 07085000
PCCACCMP EQU   PCCACHS1                                                 07086000
PCCACSEQ EQU   PCCACHTS                                                 07087000
PCCACDIN EQU   PCCACHTS                                                 07088000
PCCARV44 EQU   PCCACHTS                                                 07089000
PCCARV43 EQU   PCCACHTS                                                 07090000
PCCACTEC EQU   PCCACHTS                                                 07091000
PCCACDAV EQU   PCCACHVA                                                 07092000
PCCACCHV EQU   PCCACHVA                                                 07093000
PCCACCMD EQU   PCCACHVA                                                 07094000
PCCACUNS EQU   PCCACHVA                                                 07095000
PCCACSQV EQU   PCCACHVA                                                 07096000
PCCARV42 EQU   PCCACHVA                                                 07097000
PCCARV41 EQU   PCCACHVA                                                 07098000
PCCACITF EQU   PCCACHVA                                                 07099000
PCCARV40 EQU   PCCACHBL                                                 07100000
PCCARV39 EQU   PCCACHBL                                                 07101000
PCCARV38 EQU   PCCACHBL                                                 07102000
PCCACCUE EQU   PCCACHBL                                                 07103000
PCCACSTG EQU   PCCACHBL                                                 07104000
PCCACSCU EQU   PCCACHBL                                                 07105000
PCCACCHA EQU   PCCACHBL                                                 07106000
PCCACCPU EQU   PCCACHBL                                                 07107000
PCCACNOR EQU   PCCACHPF                                                 07108000
PCCACCNT EQU   PCCACHPF                                                 07109000
PCCACSNS EQU   PCCACHPF                                                 07110000
PCCARV37 EQU   PCCACHPF                                                 07111000
PCCACHIO EQU   PCCACHPF                                                 07112000
PCCACTIO EQU   PCCACHPF                                                 07113000
PCCACINT EQU   PCCACHPF                                                 07114000
PCCACSIO EQU   PCCACHPF                                                 07115000
PCCACHUB EQU   PCCAWERP                                                 07116000
PCCACHEL EQU   PCCA+168                                                 07117000
PCCALRBR EQU   PCCA+164                                                 07118000
PCCALRBV EQU   PCCA+160                                                 07119000
PCCAPWAR EQU   PCCA+156                                                 07120000
PCCAPWAV EQU   PCCA+152                                                 07121000
PCCAEMSA EQU   PCCAEMSB+12                                              07122000
PCCAEMSE EQU   PCCAEMSB+8                                               07123000
PCCAEMSP EQU   PCCAEMSB+4                                               07124000
PCCARMS  EQU   PCCARMSB                                                 07125000
PCCARV34 EQU   PCCARMSB                                                 07126000
PCCARV33 EQU   PCCARMSB                                                 07127000
PCCARV32 EQU   PCCARMSB                                                 07128000
PCCARV31 EQU   PCCARMSB                                                 07129000
PCCARV30 EQU   PCCARMSB                                                 07130000
PCCARV29 EQU   PCCARMSB                                                 07131000
PCCARV28 EQU   PCCARMSB                                                 07132000
PCCARV27 EQU   PCCAEMS3                                                 07133000
PCCARV26 EQU   PCCAEMS3                                                 07134000
PCCARV25 EQU   PCCAEMS3                                                 07135000
PCCARV24 EQU   PCCAEMS3                                                 07136000
PCCARV23 EQU   PCCAEMS3                                                 07137000
PCCARV22 EQU   PCCAEMS3                                                 07138000
PCCARV21 EQU   PCCAEMS3                                                 07139000
PCCARV20 EQU   PCCAEMS3                                                 07140000
PCCARV19 EQU   PCCAEMS2                                                 07141000
PCCARV18 EQU   PCCAEMS2                                                 07142000
PCCARV17 EQU   PCCAEMS2                                                 07143000
PCCARV16 EQU   PCCAEMS2                                                 07144000
PCCARV15 EQU   PCCAEMS2                                                 07145000
PCCARV14 EQU   PCCAEMS2                                                 07146000
PCCARV13 EQU   PCCAEMS2                                                 07147000
PCCARV12 EQU   PCCAEMS2                                                 07148000
PCCARV11 EQU   PCCARISP                                                 07149000
PCCARV10 EQU   PCCARISP                                                 07150000
PCCARV09 EQU   PCCARISP                                                 07151000
PCCARV08 EQU   PCCARISP                                                 07152000
PCCARV07 EQU   PCCARISP                                                 07153000
PCCARV06 EQU   PCCARISP                                                 07154000
PCCASERL EQU   PCCARISP                                                 07155000
PCCAPARL EQU   PCCARISP                                                 07156000
PCCARPB  EQU   PCCA+132                                                 07157000
PCCACTIN EQU   PCCAINTE                                                 07158000
PCCANFIN EQU   PCCAINTE                                                 07159000
PCCANUIN EQU   PCCAINTE                                                 07160000
PCCACTCC EQU   PCCACCE                                                  07161000
PCCANFCC EQU   PCCACCE                                                  07162000
PCCANUCC EQU   PCCACCE                                                  07163000
PCCACTTD EQU   PCCATODE                                                 07164000
PCCANFTD EQU   PCCATODE                                                 07165000
PCCANUTD EQU   PCCATODE                                                 07166000
PCCARV04 EQU   PCCATMFL                                                 07167000
PCCARV03 EQU   PCCATMFL                                                 07168000
PCCARV02 EQU   PCCATMFL                                                 07169000
PCCAMINT EQU   PCCATMFL                                                 07170000
PCCAMCC  EQU   PCCATMFL                                                 07171000
PCCAVKIL EQU   PCCATMFL                                                 07172000
PCCASYNC EQU   PCCATMFL                                                 07173000
PCCAINIT EQU   PCCATMFL                                                 07174000
PCCARV9E EQU   PCCA+124                                                 07175000
PCCARV9D EQU   PCCA+120                                                 07176000
PCCARV9C EQU   PCCA+116                                                 07177000
PCCARV9B EQU   PCCA+112                                                 07178000
PCCARV9A EQU   PCCA+108                                                 07179000
PCCARV99 EQU   PCCA+104                                                 07180000
PCCARV98 EQU   PCCA+100                                                 07181000
PCCARV97 EQU   PCCA+96                                                  07182000
PCCARV96 EQU   PCCA+92                                                  07183000
PCCARV95 EQU   PCCA+88                                                  07184000
PCCARV94 EQU   PCCA+84                                                  07185000
PCCARV93 EQU   PCCA+80                                                  07186000
PCCARV92 EQU   PCCA+76                                                  07187000
PCCARV91 EQU   PCCA+72                                                  07188000
PCCARV90 EQU   PCCA+68                                                  07189000
PCCARV89 EQU   PCCA+64                                                  07190000
PCCARV88 EQU   PCCA+60                                                  07191000
PCCARV87 EQU   PCCA+56                                                  07192000
PCCARV86 EQU   PCCA+52                                                  07193000
PCCARV85 EQU   PCCA+48                                                  07194000
PCCARV84 EQU   PCCA+44                                                  07195000
PCCARV83 EQU   PCCA+40                                                  07196000
PCCARV82 EQU   PCCA+36                                                  07197000
PCCARV81 EQU   PCCA+32                                                  07198000
PCCAPSAR EQU   PCCA+28                                                  07199000
PCCAPSAV EQU   PCCA+24                                                  07200000
PCCATQEP EQU   PCCA+20                                                  07201000
PCCACAFM EQU   PCCA+18                                                  07202000
PCCACPID EQU   PCCA+4                                                   07203000
PCCAPCCA EQU   PCCA                                                     07204000
@NM00018 EQU   CSD+160                                                  07205000
CSDMASK  EQU   CSD+128                                                  07206000
CSDUCNT  EQU   CSD+124                                                  07207000
CSDTCNT  EQU   CSD+120                                                  07208000
CSDGDTOD EQU   CSD+116                                                  07209000
CSDGDINT EQU   CSD+112                                                  07210000
CSDGDCC  EQU   CSD+108                                                  07211000
CSDDDRCT EQU   CSD+106                                                  07212000
CSDRV044 EQU   CSD+104                                                  07213000
CSDMAFF  EQU   CSD+24                                                   07214000
CSDRV038 EQU   CSDFLAGS                                                 07215000
CSDRV037 EQU   CSDFLAGS                                                 07216000
CSDRV036 EQU   CSDFLAGS                                                 07217000
CSDRV035 EQU   CSDFLAGS                                                 07218000
CSDRV034 EQU   CSDFLAGS                                                 07219000
CSDRV033 EQU   CSDFLAGS                                                 07220000
CSDRV032 EQU   CSDFLAGS                                                 07221000
CSDACR   EQU   CSD+22                                                   07222000
CSDMF1CP EQU   CSD+20                                                   07223000
CSDRV043 EQU   CSD+16                                                   07224000
CSDRV030 EQU   CSDSCFL4                                                 07225000
CSDRV029 EQU   CSDSCFL4                                                 07226000
CSDRV028 EQU   CSDSCFL4                                                 07227000
CSDRV027 EQU   CSDSCFL4                                                 07228000
CSDRV026 EQU   CSDSCFL4                                                 07229000
CSDRV025 EQU   CSDSCFL4                                                 07230000
CSDRV024 EQU   CSDSCFL4                                                 07231000
CSDRV023 EQU   CSDSCFL4                                                 07232000
CSDRV022 EQU   CSDSCFL3                                                 07233000
CSDRV021 EQU   CSDSCFL3                                                 07234000
CSDRV020 EQU   CSDSCFL3                                                 07235000
CSDRV019 EQU   CSDSCFL3                                                 07236000
CSDRV018 EQU   CSDSCFL3                                                 07237000
CSDRV017 EQU   CSDSCFL3                                                 07238000
CSDRV016 EQU   CSDSCFL3                                                 07239000
CSDRV015 EQU   CSDSCFL3                                                 07240000
CSDRV014 EQU   CSDSCFL2                                                 07241000
CSDRV013 EQU   CSDSCFL2                                                 07242000
CSDRV012 EQU   CSDSCFL2                                                 07243000
CSDRV011 EQU   CSDSCFL2                                                 07244000
CSDRV010 EQU   CSDSCFL2                                                 07245000
CSDRV009 EQU   CSDSCFL2                                                 07246000
CSDRV008 EQU   CSDSCFL2                                                 07247000
CSDRV007 EQU   CSDSCFL2                                                 07248000
CSDRV006 EQU   CSDSCFL1                                                 07249000
CSDRV005 EQU   CSDSCFL1                                                 07250000
CSDRV004 EQU   CSDSCFL1                                                 07251000
CSDRV003 EQU   CSDSCFL1                                                 07252000
CSDRV002 EQU   CSDSCFL1                                                 07253000
CSDRV001 EQU   CSDSCFL1                                                 07254000
CSDSYSND EQU   CSDSCFL1                                                 07255000
CSDRV042 EQU   CSDSCFL1                                                 07256000
CSDCPUOL EQU   CSD+10                                                   07257000
CSDSAFF  EQU   CSDCPUAL                                                 07258000
CSDCHAD  EQU   CSD+6                                                    07259000
CSDCPUJS EQU   CSD+4                                                    07260000
CSDCSD   EQU   CSD                                                      07261000
@NM00017 EQU   SRB+40                                                   07262000
@NM00016 EQU   SRB+38                                                   07263000
SRBPRIOR EQU   SRB+37                                                   07264000
SRBPKF   EQU   SRB+36                                                   07265000
SRBSAVE  EQU   SRB+32                                                   07266000
SRBRMTR  EQU   SRB+24                                                   07267000
SRBPTCB  EQU   SRBFLC+4                                                 07268000
SRBPASID EQU   SRBFLC+2                                                 07269000
SRBCPAFF EQU   SRBFLC                                                   07270000
SRBFLNK  EQU   SRB+4                                                    07271000
SRBID    EQU   SRB                                                      07272000
CVTLEVL  EQU   CVTRELNO+2                                               07273000
CVTNUMB  EQU   CVTRELNO                                                 07274000
CVTMDL   EQU   CVTFIX+250                                               07275000
@NM00015 EQU   CVTFIX+248                                               07276000
@NM00014 EQU   CVTFIX                                                   07277000
CVTRV482 EQU   CVTXTNT2+128                                             07278000
CVTRV481 EQU   CVTXTNT2+124                                             07279000
CVTRV480 EQU   CVTXTNT2+120                                             07280000
CVTRV479 EQU   CVTXTNT2+118                                             07281000
CVTRV478 EQU   CVTXTNT2+117                                             07282000
CVTRV477 EQU   CVTXTNT2+116                                             07283000
CVTRV476 EQU   CVTXTNT2+115                                             07284000
CVTRV475 EQU   CVTXTNT2+114                                             07285000
CVTRV474 EQU   CVTRV466                                                 07286000
CVTRV473 EQU   CVTRV466                                                 07287000
CVTRV472 EQU   CVTRV466                                                 07288000
CVTRV471 EQU   CVTRV466                                                 07289000
CVTRV470 EQU   CVTRV466                                                 07290000
CVTRV469 EQU   CVTRV466                                                 07291000
CVTRV468 EQU   CVTRV466                                                 07292000
CVTRV467 EQU   CVTRV466                                                 07293000
CVTRV465 EQU   CVTRV457                                                 07294000
CVTRV464 EQU   CVTRV457                                                 07295000
CVTRV463 EQU   CVTRV457                                                 07296000
CVTRV462 EQU   CVTRV457                                                 07297000
CVTRV461 EQU   CVTRV457                                                 07298000
CVTRV460 EQU   CVTRV457                                                 07299000
CVTRV459 EQU   CVTRV457                                                 07300000
CVTRV458 EQU   CVTRV457                                                 07301000
CVTRV456 EQU   CVTXTNT2+108                                             07302000
CVTRV455 EQU   CVTXTNT2+104                                             07303000
CVTRV454 EQU   CVTXTNT2+100                                             07304000
CVTRV453 EQU   CVTXTNT2+96                                              07305000
CVTRV452 EQU   CVTXTNT2+94                                              07306000
CVTRV451 EQU   CVTXTNT2+92                                              07307000
CVTRV450 EQU   CVTXTNT2+90                                              07308000
CVTRV449 EQU   CVTXTNT2+88                                              07309000
CVTRV448 EQU   CVTXTNT2+87                                              07310000
CVTRV447 EQU   CVTXTNT2+86                                              07311000
CVTRV446 EQU   CVTRV438                                                 07312000
CVTRV445 EQU   CVTRV438                                                 07313000
CVTRV444 EQU   CVTRV438                                                 07314000
CVTRV443 EQU   CVTRV438                                                 07315000
CVTRV442 EQU   CVTRV438                                                 07316000
CVTRV441 EQU   CVTRV438                                                 07317000
CVTRV440 EQU   CVTRV438                                                 07318000
CVTRV439 EQU   CVTRV438                                                 07319000
CVTRV437 EQU   CVTRV429                                                 07320000
CVTRV436 EQU   CVTRV429                                                 07321000
CVTRV435 EQU   CVTRV429                                                 07322000
CVTRV434 EQU   CVTRV429                                                 07323000
CVTRV433 EQU   CVTRV429                                                 07324000
CVTRV432 EQU   CVTRV429                                                 07325000
CVTRV431 EQU   CVTRV429                                                 07326000
CVTRV430 EQU   CVTRV429                                                 07327000
CVTRV428 EQU   CVTXTNT2+80                                              07328000
CVTRV427 EQU   CVTXTNT2+76                                              07329000
CVTRV426 EQU   CVTXTNT2+72                                              07330000
CVTRV425 EQU   CVTXTNT2+68                                              07331000
CVTATACT EQU   CVTATCVT                                                 07332000
CVTRV423 EQU   CVTXTNT2+62                                              07333000
CVTRV422 EQU   CVTXTNT2+60                                              07334000
CVTRV421 EQU   CVTXTNT2+58                                              07335000
CVTRV420 EQU   CVTXTNT2+56                                              07336000
CVTRV419 EQU   CVTXTNT2+55                                              07337000
CVTRV418 EQU   CVTXTNT2+54                                              07338000
CVTRV417 EQU   CVTRV409                                                 07339000
CVTRV416 EQU   CVTRV409                                                 07340000
CVTRV415 EQU   CVTRV409                                                 07341000
CVTRV414 EQU   CVTRV409                                                 07342000
CVTRV413 EQU   CVTRV409                                                 07343000
CVTRV412 EQU   CVTRV409                                                 07344000
CVTRV411 EQU   CVTRV409                                                 07345000
CVTRV410 EQU   CVTRV409                                                 07346000
CVTRV408 EQU   CVTRV400                                                 07347000
CVTRV407 EQU   CVTRV400                                                 07348000
CVTRV406 EQU   CVTRV400                                                 07349000
CVTRV405 EQU   CVTRV400                                                 07350000
CVTRV404 EQU   CVTRV400                                                 07351000
CVTRV403 EQU   CVTRV400                                                 07352000
CVTRV402 EQU   CVTRV400                                                 07353000
CVTRV401 EQU   CVTRV400                                                 07354000
CVTICB   EQU   CVTXTNT2+48                                              07355000
CVTSKTA  EQU   CVTXTNT2+44                                              07356000
CVTRSV99 EQU   CVTXTNT2+40                                              07357000
CVTRSV98 EQU   CVTXTNT2+36                                              07358000
CVTRSV97 EQU   CVTXTNT2+34                                              07359000
CVTRSV96 EQU   CVTXTNT2+32                                              07360000
CVTOLTEP EQU   CVTXTNT2+28                                              07361000
CVTQIDA  EQU   CVTQID+1                                                 07362000
CVTRSV95 EQU   CVTQID                                                   07363000
CVTRSV94 EQU   CVTXTNT2+20                                              07364000
CVTRSV93 EQU   CVTXTNT2+16                                              07365000
CVTRSV92 EQU   CVTXTNT2+12                                              07366000
CVTDEBVR EQU   CVTXTNT2+8                                               07367000
CVTRSV91 EQU   CVTXTNT2+6                                               07368000
CVTRSV9H EQU   CVTFLGBT                                                 07369000
CVTRSV9G EQU   CVTFLGBT                                                 07370000
CVTRSV9F EQU   CVTFLGBT                                                 07371000
CVTRSV9E EQU   CVTFLGBT                                                 07372000
CVTRSV9D EQU   CVTFLGBT                                                 07373000
CVTRSV9C EQU   CVTFLGBT                                                 07374000
CVTVME   EQU   CVTFLGBT                                                 07375000
CVTNPE   EQU   CVTFLGBT                                                 07376000
CVTNUCLS EQU   CVTXTNT2+4                                               07377000
CVTDSSVA EQU   CVTDSSV+1                                                07378000
CVTRSV89 EQU   CVTDSSV                                                  07379000
CVTRSV88 EQU   CVTXTNT1+8                                               07380000
CVTRSV87 EQU   CVTXTNT1+4                                               07381000
CVTFACHN EQU   CVTXTNT1                                                 07382000
CVTRV488 EQU   CVTMAP+412                                               07383000
CVTRV487 EQU   CVTMAP+408                                               07384000
CVTRV486 EQU   CVTMAP+404                                               07385000
CVTRV485 EQU   CVTMAP+400                                               07386000
CVTACTAP EQU   CVTMAP+396                                               07387000
CVTAUTH  EQU   CVTMAP+392                                               07388000
CVTATMCA EQU   CVTATMCT+1                                               07389000
CVTATMST EQU   CVTATMCT                                                 07390000
CVTRSV61 EQU   CVTMAP+384                                               07391000
CVTVOLT1 EQU   CVTVOLM1+1                                               07392000
CVTVOLI1 EQU   CVTVOLF1                                                 07393000
CVTSTOA  EQU   CVTMAP+376                                               07394000
CVTRSV58 EQU   CVTMAP+374                                               07395000
CVTRSV57 EQU   CVTMAP+372                                               07396000
CVTDDCE  EQU   CVTMAP+368                                               07397000
CVTPNWFR EQU   CVTMAP+364                                               07398000
CVTSMF   EQU   CVTMAP+360                                               07399000
CVTSULK  EQU   CVTMAP+358                                               07400000
CVTSLKO  EQU   CVTSYSK                                                  07401000
CVTSLKP  EQU   CVTSYSK                                                  07402000
CVTSLKQ  EQU   CVTSYSK                                                  07403000
CVTSLKR  EQU   CVTSYSK                                                  07404000
CVTRSV56 EQU   CVTSYSK                                                  07405000
CVTRSV55 EQU   CVTSYSK                                                  07406000
CVTRSV54 EQU   CVTSYSK                                                  07407000
CVTRSV53 EQU   CVTSYSK                                                  07408000
CVTRSV52 EQU   CVTA1F1                                                  07409000
CVTRSV51 EQU   CVTA1F1                                                  07410000
CVTRSV50 EQU   CVTA1F1                                                  07411000
CVTRSV49 EQU   CVTA1F1                                                  07412000
CVTRSV48 EQU   CVTA1F1                                                  07413000
CVTRSV47 EQU   CVTA1F1                                                  07414000
CVTSRSW  EQU   CVTA1F1                                                  07415000
CVTPFSW  EQU   CVTA1F1                                                  07416000
CVTPCVT  EQU   CVTMAP+352                                               07417000
CVTRSV46 EQU   CVTMAP+344                                               07418000
CVTRSV45 EQU   CVTMAP+340                                               07419000
CVTRSV44 EQU   CVTMAP+338                                               07420000
CVTRSV43 EQU   CVTMAP+336                                               07421000
CVTHJESA EQU   CVTHJES+1                                                07422000
CVTRSV42 EQU   CVTHJES                                                  07423000
CVTEXT2A EQU   CVTEXT2+1                                                07424000
CVTRSV41 EQU   CVTEXT2                                                  07425000
CVTAPFA  EQU   CVTAPF+1                                                 07426000
CVTRSV40 EQU   CVTAPF                                                   07427000
CVTRV518 EQU   CVTINTLA                                                 07428000
CVTRV517 EQU   CVTERPV                                                  07429000
CVTEORM  EQU   CVTMAP+312                                               07430000
CVTMCHPR EQU   CVTMAP+308                                               07431000
CVTTZ    EQU   CVTMAP+304                                               07432000
CVTJEPS  EQU   CVTMAP+300                                               07433000
CVTJESCT EQU   CVTMAP+296                                               07434000
CVTMODE  EQU   CVTMAP+292                                               07435000
CVTPTRV  EQU   CVTMAP+288                                               07436000
CVTREAL  EQU   CVTMAP+284                                               07437000
CVTRSV39 EQU   CVTMAP+280                                               07438000
CVTRSV38 EQU   CVTMAP+276                                               07439000
CVTDMSRA EQU   CVTDMSR+1                                                07440000
CVTRV634 EQU   CVTDMSRF                                                 07441000
CVTRV633 EQU   CVTDMSRF                                                 07442000
CVTRV632 EQU   CVTDMSRF                                                 07443000
CVTRV631 EQU   CVTDMSRF                                                 07444000
CVTRV630 EQU   CVTDMSRF                                                 07445000
CVTRV629 EQU   CVTDMSRF                                                 07446000
CVTUDUMP EQU   CVTDMSRF                                                 07447000
CVTSDUMP EQU   CVTDMSRF                                                 07448000
CVTQMSGA EQU   CVTQMSG+1                                                07449000
CVTRSV36 EQU   CVTQMSG                                                  07450000
CVTAMFF  EQU   CVTMAP+264                                               07451000
CVTPURGA EQU   CVTPURG+1                                                07452000
CVTRSV35 EQU   CVTPURG                                                  07453000
CVTCBSP  EQU   CVTMAP+256                                               07454000
CVTATERA EQU   CVTATER+1                                                07455000
CVTSYST  EQU   CVTATER                                                  07456000
CVTVOLT2 EQU   CVTTAT                                                   07457000
CVTVOLI2 EQU   CVTVOLF2                                                 07458000
CVTAQAVB EQU   CVTAQAVT+1                                               07459000
CVTRSV34 EQU   CVTTCMFG                                                 07460000
CVTRSV33 EQU   CVTTCMFG                                                 07461000
CVTRSV32 EQU   CVTTCMFG                                                 07462000
CVTRSV31 EQU   CVTTCMFG                                                 07463000
CVTRSV30 EQU   CVTTCMFG                                                 07464000
CVTRSV29 EQU   CVTTCMFG                                                 07465000
CVTRSV28 EQU   CVTTCMFG                                                 07466000
CVTTCRDY EQU   CVTTCMFG                                                 07467000
CVTRSV27 EQU   CVTGTFST                                                 07468000
CVTRNIO  EQU   CVTGTFST                                                 07469000
CVTUSR   EQU   CVTGTFST                                                 07470000
CVTRV318 EQU   CVTFORM                                                  07471000
CVTRV317 EQU   CVTTMODE                                                 07472000
CVTRV316 EQU   CVTSTATE                                                 07473000
CVTRV315 EQU   CVTGTFS                                                  07474000
CVTGTFAV EQU   CVTGTFS                                                  07475000
CVT0SCR1 EQU   CVTMAP+232                                               07476000
CVTRV515 EQU   CVTMAP+228                                               07477000
CVTRMS   EQU   CVTMAP+224                                               07478000
CVTPATCH EQU   CVTMAP+220                                               07479000
CVTTSCE  EQU   CVTMAP+216                                               07480000
CVTLNKSC EQU   CVTMAP+214                                               07481000
CVTQABST EQU   CVTMAP+212                                               07482000
CVTMDLDS EQU   CVTMAP+208                                               07483000
CVTUSER  EQU   CVTMAP+204                                               07484000
CVTABEND EQU   CVTMAP+200                                               07485000
CVTSMCA  EQU   CVTMAP+196                                               07486000
CVTRSV18 EQU   CVTMAP+192                                               07487000
CVTQLPAQ EQU   CVTMAP+188                                               07488000
CVTQCDSR EQU   CVTMAP+184                                               07489000
CVTRSV17 EQU   CVTOPTB                                                  07490000
CVTRSV16 EQU   CVTOPTB                                                  07491000
CVTFP    EQU   CVTOPTB                                                  07492000
CVTAPTHR EQU   CVTOPTB                                                  07493000
CVTNLOG  EQU   CVTOPTB                                                  07494000
CVTTOD   EQU   CVTOPTB                                                  07495000
CVTCTIMS EQU   CVTOPTB                                                  07496000
CVTPROT  EQU   CVTOPTB                                                  07497000
CVTXPFP  EQU   CVTOPTA                                                  07498000
CVTASCII EQU   CVTOPTA                                                  07499000
CVTRSV13 EQU   CVTOPTA                                                  07500000
CVTRSV12 EQU   CVTOPTA                                                  07501000
CVTNIP   EQU   CVTOPTA                                                  07502000
CVTDDR   EQU   CVTOPTA                                                  07503000
CVTAPR   EQU   CVTOPTA                                                  07504000
CVTCCH   EQU   CVTOPTA                                                  07505000
CVTSNCTR EQU   CVTMAP+180                                               07506000
CVTQMWR  EQU   CVTMAP+176                                               07507000
CVTQOCR  EQU   CVTMAP+172                                               07508000
CVT1EF00 EQU   CVTMAP+168                                               07509000
CVTMZ00  EQU   CVTMAP+164                                               07510000
CVTSV76Q EQU   CVTSV76C                                                 07511000
CVTRSV11 EQU   CVTMAP+156                                               07512000
CVTMSER  EQU   CVTMAP+148                                               07513000
CVTRV516 EQU   CVTIERLC                                                 07514000
CVTILCH  EQU   CVTMAP+140                                               07515000
CVT0DS   EQU   CVTMAP+136                                               07516000
CVTFBOSV EQU   CVTMAP+132                                               07517000
CVTNUCB  EQU   CVTMAP+128                                               07518000
CVTIXAVL EQU   CVTMAP+124                                               07519000
CVTSV76M EQU   CVTIOQET                                                 07520000
CVTDCBA  EQU   CVTMAP+117                                               07521000
CVTMVS2  EQU   CVTDCB                                                   07522000
CVT6DAT  EQU   CVTDCB                                                   07523000
CVT4MPS  EQU   CVTDCB                                                   07524000
CVTRSV09 EQU   CVTDCB                                                   07525000
CVT4MS1  EQU   CVTDCB                                                   07526000
CVT2SPS  EQU   CVTDCB                                                   07527000
CVT1SSS  EQU   CVTDCB                                                   07528000
CVTRSV08 EQU   CVTDCB                                                   07529000
CVTSTB   EQU   CVTMAP+112                                               07530000
CVTQTD00 EQU   CVTMAP+108                                               07531000
CVTQTE00 EQU   CVTMAP+104                                               07532000
CVTCUCB  EQU   CVTMAP+100                                               07533000
CVTSJQ   EQU   CVTMAP+96                                                07534000
CVTPBLDL EQU   CVTMAP+92                                                07535000
CVTTPC   EQU   CVTMAP+88                                                07536000
CVTSVDCB EQU   CVTMAP+84                                                07537000
CVTBRET  EQU   CVTMAP+82                                                07538000
CVTEXIT  EQU   CVTMAP+80                                                07539000
CVT0FN00 EQU   CVTMAP+76                                                07540000
CVTDARA  EQU   CVTDAR+1                                                 07541000
CVTRSV07 EQU   CVTFLGS1                                                 07542000
CVTRSV06 EQU   CVTFLGS1                                                 07543000
CVTRSV05 EQU   CVTFLGS1                                                 07544000
CVTRSV04 EQU   CVTFLGS1                                                 07545000
CVTRSV03 EQU   CVTFLGS1                                                 07546000
CVTRSV02 EQU   CVTFLGS1                                                 07547000
CVTRSV01 EQU   CVTFLGS1                                                 07548000
CVTDMPLK EQU   CVTFLGS1                                                 07549000
CVTXITP  EQU   CVTMAP+68                                                07550000
CVTZDTAB EQU   CVTMAP+64                                                07551000
CVTMSLT  EQU   CVTMAP+60                                                07552000
CVTDATE  EQU   CVTMAP+56                                                07553000
CVTBTERM EQU   CVTMAP+52                                                07554000
CVTSYSAD EQU   CVTMAP+48                                                07555000
CVTXTLER EQU   CVTMAP+44                                                07556000
CVTILK2  EQU   CVTMAP+40                                                07557000
CVTILK1  EQU   CVTMAP+36                                                07558000
CVTPRLTV EQU   CVTMAP+32                                                07559000
CVTPCNVT EQU   CVTMAP+28                                                07560000
CVT0VL00 EQU   CVTMAP+24                                                07561000
CVTXAPG  EQU   CVTMAP+20                                                07562000
CVTBUF   EQU   CVTMAP+16                                                07563000
CVTJOB   EQU   CVTMAP+12                                                07564000
CVTLINK  EQU   CVTMAP+8                                                 07565000
CVT0EF00 EQU   CVTMAP+4                                                 07566000
CVTTCBP  EQU   CVTMAP                                                   07567000
CVT      EQU   CVTMAP                                                   07568000
@NM00012 EQU   HISSAVE+24                                               07569000
@NM00011 EQU   HISSAVE                                                  07570000
@NM00010 EQU   MYSAVE                                                   07571000
@NM00009 EQU   FRESPACE+4                                               07572000
@NM00008 EQU   FRESPACE                                                 07573000
@NM00005 EQU   PARMLIST+1                                               07574000
@NM00004 EQU   SETOPTS                                                  07575000
CHANGE   EQU   SETOPTS                                                  07576000
DISABLE  EQU   SETOPTS                                                  07577000
@NM00043 EQU   PSA+3668                                                 07578000
PSASTAK  EQU   PSA+3072                                                 07579000
@NM00042 EQU   PSA+1048                                                 07580000
PSAUSEND EQU   PSA+1048                                                 07581000
PSARV062 EQU   PSA+1044                                                 07582000
PSACDAL  EQU   PSA+1040                                                 07583000
PSAWTCOD EQU   PSA+1036                                                 07584000
PSAATCVT EQU   PSA+1032                                                 07585000
PSAPCPSW EQU   PSA+1024                                                 07586000
PSAPIR2  EQU   PSA+1020                                                 07587000
PSARV059 EQU   PSA+1018                                                 07588000
PSASVC13 EQU   PSA+1016                                                 07589000
PSALSFCC EQU   PSA+1012                                                 07590000
PSASFACC EQU   PSA+1008                                                 07591000
PSASTOP  EQU   PSA+992                                                  07592000
PSASTART EQU   PSA+976                                                  07593000
PSARSPSW EQU   PSA+968                                                  07594000
PSASRPSW EQU   PSA+960                                                  07595000
PSARV045 EQU   PSA+892                                                  07596000
PSARV044 EQU   PSA+888                                                  07597000
PSARV043 EQU   PSA+884                                                  07598000
PSARV042 EQU   PSA+880                                                  07599000
PSARV041 EQU   PSA+876                                                  07600000
PSARV040 EQU   PSA+872                                                  07601000
PSARV025 EQU   PSA+868                                                  07602000
PSADSSED EQU   PSA+868                                                  07603000
PSADSSPR EQU   PSA+864                                                  07604000
PSADSSFW EQU   PSA+860                                                  07605000
PSADSS14 EQU   PSA+856                                                  07606000
PSADSSPP EQU   PSA+848                                                  07607000
PSADSSRP EQU   PSA+840                                                  07608000
PSADSS05 EQU   PSADSSF4                                                 07609000
PSADSS10 EQU   PSADSSF4                                                 07610000
PSADSSVE EQU   PSADSSF4                                                 07611000
PSADSSDE EQU   PSADSSF4                                                 07612000
PSADSSC0 EQU   PSADSSF4                                                 07613000
PSADSSIE EQU   PSADSSF4                                                 07614000
PSADSS12 EQU   PSADSSF4                                                 07615000
PSADSSRC EQU   PSADSSF4                                                 07616000
PSARV057 EQU   PSADSSF3                                                 07617000
PSARV056 EQU   PSADSSF3                                                 07618000
PSARV055 EQU   PSADSSF3                                                 07619000
PSADSSMC EQU   PSADSSF3                                                 07620000
PSADSSRW EQU   PSADSSF3                                                 07621000
PSADSSNM EQU   PSADSSF3                                                 07622000
PSADSSES EQU   PSADSSF3                                                 07623000
PSADSSGP EQU   PSADSSF3                                                 07624000
PSADSSF2 EQU   PSADSSFL+1                                               07625000
PSADSSPI EQU   PSADSSF1                                                 07626000
PSADSSOI EQU   PSADSSF1                                                 07627000
PSADSSSP EQU   PSADSSF1                                                 07628000
PSADSSTP EQU   PSADSSF1                                                 07629000
PSADSSDW EQU   PSADSSF1                                                 07630000
PSADSSDD EQU   PSADSSF1                                                 07631000
PSADSSDM EQU   PSADSSF1                                                 07632000
PSADSSMV EQU   PSADSSF1                                                 07633000
PSADSSTS EQU   PSA+816                                                  07634000
PSADSSWK EQU   PSA+812                                                  07635000
PSADSSR3 EQU   PSA+808                                                  07636000
PSADSSR2 EQU   PSA+804                                                  07637000
PSADSSRS EQU   PSA+800                                                  07638000
PSASTOR  EQU   PSA+796                                                  07639000
PSACPUSA EQU   PSA+794                                                  07640000
PSAVSTAP EQU   PSA+792                                                  07641000
PSAWKVAP EQU   PSA+788                                                  07642000
PSAWKRAP EQU   PSA+784                                                  07643000
PSAMCHIC EQU   PSA+783                                                  07644000
PSARV061 EQU   PSA+782                                                  07645000
PSASYMSK EQU   PSA+781                                                  07646000
PSAMCHFL EQU   PSA+780                                                  07647000
PSACR0   EQU   PSA+776                                                  07648000
PSAPSWSV EQU   PSA+768                                                  07649000
PSALITA  EQU   PSA+764                                                  07650000
PSACLHS  EQU   PSAHLHI                                                  07651000
PSALKR15 EQU   PSALKSA+60                                               07652000
PSALKR14 EQU   PSALKSA+56                                               07653000
PSALKR13 EQU   PSALKSA+52                                               07654000
PSALKR12 EQU   PSALKSA+48                                               07655000
PSALKR11 EQU   PSALKSA+44                                               07656000
PSALKR10 EQU   PSALKSA+40                                               07657000
PSALKR9  EQU   PSALKSA+36                                               07658000
PSALKR8  EQU   PSALKSA+32                                               07659000
PSALKR7  EQU   PSALKSA+28                                               07660000
PSALKR6  EQU   PSALKSA+24                                               07661000
PSALKR5  EQU   PSALKSA+20                                               07662000
PSALKR4  EQU   PSALKSA+16                                               07663000
PSALKR3  EQU   PSALKSA+12                                               07664000
PSALKR2  EQU   PSALKSA+8                                                07665000
PSALKR1  EQU   PSALKSA+4                                                07666000
PSALKR0  EQU   PSALKSA                                                  07667000
PSARV023 EQU   PSACLHT+52                                               07668000
PSALOCAL EQU   PSACLHT+48                                               07669000
PSACMSL  EQU   PSACLHT+44                                               07670000
PSAOPTL  EQU   PSACLHT+40                                               07671000
PSATPACL EQU   PSACLHT+36                                               07672000
PSATPDNL EQU   PSACLHT+32                                               07673000
PSATPNCL EQU   PSACLHT+28                                               07674000
PSAIOSLL EQU   PSACLHT+24                                               07675000
PSAIOSUL EQU   PSACLHT+20                                               07676000
PSAIOSCL EQU   PSACLHT+16                                               07677000
PSAIOSSL EQU   PSACLHT+12                                               07678000
PSASALCL EQU   PSACLHT+8                                                07679000
PSAASML  EQU   PSACLHT+4                                                07680000
PSADISPL EQU   PSACLHT                                                  07681000
PSASRSA  EQU   PSA+636                                                  07682000
PSARV050 EQU   PSA+634                                                  07683000
PSADSSGO EQU   PSA+633                                                  07684000
PSARECUR EQU   PSA+632                                                  07685000
PSAHLHIS EQU   PSA+628                                                  07686000
PSAIPCSA EQU   PSA+624                                                  07687000
@NM00041 EQU   PSA+621                                                  07688000
PSAIPCDM EQU   PSA+620                                                  07689000
PSAIPCD  EQU   PSA+616                                                  07690000
@NM00040 EQU   PSA+613                                                  07691000
PSAIPCRM EQU   PSA+612                                                  07692000
PSAIPCR  EQU   PSA+608                                                  07693000
PSAMCHEX EQU   PSA+600                                                  07694000
PSAMPSW  EQU   PSA+592                                                  07695000
PSAEXPS2 EQU   PSA+584                                                  07696000
PSAEXPS1 EQU   PSA+576                                                  07697000
PSAPIREG EQU   PSA+572                                                  07698000
PSARSREG EQU   PSA+568                                                  07699000
PSAGPREG EQU   PSA+556                                                  07700000
PSARV022 EQU   PSASUP4                                                  07701000
PSARV021 EQU   PSASUP4                                                  07702000
PSARV020 EQU   PSASUP4                                                  07703000
PSARV019 EQU   PSASUP4                                                  07704000
PSARV018 EQU   PSASUP4                                                  07705000
PSARV017 EQU   PSASUP4                                                  07706000
PSARV016 EQU   PSASUP4                                                  07707000
PSARV015 EQU   PSASUP4                                                  07708000
PSARV014 EQU   PSASUP3                                                  07709000
PSARV013 EQU   PSASUP3                                                  07710000
PSARV012 EQU   PSASUP3                                                  07711000
PSAESTA  EQU   PSASUP3                                                  07712000
PSASPR   EQU   PSASUP3                                                  07713000
PSAPSREG EQU   PSASUP3                                                  07714000
PSAPI2   EQU   PSASUP3                                                  07715000
PSAIOSUP EQU   PSASUP3                                                  07716000
PSALCR   EQU   PSASUP2                                                  07717000
PSARTM   EQU   PSASUP2                                                  07718000
PSAACR   EQU   PSASUP2                                                  07719000
PSAIPCE2 EQU   PSASUP2                                                  07720000
PSAIPCES EQU   PSASUP2                                                  07721000
PSAIPCEC EQU   PSASUP2                                                  07722000
PSAGTF   EQU   PSASUP2                                                  07723000
PSAIPCRI EQU   PSASUP2                                                  07724000
PSATYPE6 EQU   PSASUP1                                                  07725000
PSATCTL  EQU   PSASUP1                                                  07726000
PSADISP  EQU   PSASUP1                                                  07727000
PSALOCK  EQU   PSASUP1                                                  07728000
PSAPI    EQU   PSASUP1                                                  07729000
PSAEXT   EQU   PSASUP1                                                  07730000
PSASVC   EQU   PSASUP1                                                  07731000
PSAIO    EQU   PSASUP1                                                  07732000
PSAANEW  EQU   PSA+544                                                  07733000
PSATOLD  EQU   PSA+540                                                  07734000
PSATNEW  EQU   PSA+536                                                  07735000
PSALCCAR EQU   PSA+532                                                  07736000
PSAPCCAR EQU   PSA+524                                                  07737000
PSACPULA EQU   PSA+518                                                  07738000
PSACPUPA EQU   PSA+516                                                  07739000
PSAPSA   EQU   PSA+512                                                  07740000
FLCHDEND EQU   PSA+512                                                  07741000
FLCCRSAV EQU   FLCMCLA+280                                              07742000
FLCGRSAV EQU   FLCMCLA+216                                              07743000
FLCFPSAV EQU   FLCMCLA+184                                              07744000
FLCFLA   EQU   FLCMCLA+88                                               07745000
FLCRGNCD EQU   FLCMCLA+84                                               07746000
FLCFSAA  EQU   FLCFSA+1                                                 07747000
@NM00039 EQU   FLCFSA                                                   07748000
@NM00038 EQU   FLCMCLA+72                                               07749000
FLCMCIC  EQU   FLCMCLA+64                                               07750000
@NM00037 EQU   FLCMCLA+20                                               07751000
FLCIOAA  EQU   FLCIOA+1                                                 07752000
@NM00036 EQU   FLCIOA                                                   07753000
@NM00035 EQU   FLCMCLA+15                                               07754000
@NM00034 EQU   FLCMCLA+14                                               07755000
@NM00033 EQU   FLCMCLA+12                                               07756000
FLCLCL   EQU   FLCMCLA+8                                                07757000
FLCIOELA EQU   FLCIOEL+1                                                07758000
@NM00032 EQU   FLCIOEL                                                  07759000
FLCCHNID EQU   FLCMCLA                                                  07760000
@NM00031 EQU   PSA+160                                                  07761000
FLCMTRCD EQU   PSA+157                                                  07762000
@NM00030 EQU   PSA+156                                                  07763000
FLCPERA  EQU   FLCPER+1                                                 07764000
@NM00029 EQU   FLCPER                                                   07765000
@NM00028 EQU   PSA+151                                                  07766000
FLCPERCD EQU   PSA+150                                                  07767000
FLCMCNUM EQU   PSA+149                                                  07768000
@NM00027 EQU   PSA+148                                                  07769000
FLCTEAA  EQU   FLCTEA+1                                                 07770000
@NM00026 EQU   FLCTEA                                                   07771000
PSAPIPC  EQU   PSAPICOD                                                 07772000
PSAPIMC  EQU   PSAPICOD                                                 07773000
PSAPIPER EQU   PSAPICOD                                                 07774000
PSARV049 EQU   FLCPICOD                                                 07775000
FLCPILCB EQU   FLCPIILC                                                 07776000
@NM00025 EQU   FLCPIILC                                                 07777000
@NM00024 EQU   PSAEPPSW                                                 07778000
FLCSVCN  EQU   PSAESPSW+2                                               07779000
FLCSILCB EQU   FLCSVILC                                                 07780000
@NM00023 EQU   FLCSVILC                                                 07781000
@NM00022 EQU   PSAESPSW                                                 07782000
FLCEICOD EQU   PSAEEPSW+2                                               07783000
PSASPAD  EQU   PSAEEPSW                                                 07784000
@NM00021 EQU   PSA+128                                                  07785000
FLCINPSW EQU   PSA+120                                                  07786000
FLCMNPSW EQU   PSA+112                                                  07787000
FLCPNPSW EQU   PSA+104                                                  07788000
FLCSNPSW EQU   PSA+96                                                   07789000
FLCENPSW EQU   PSA+88                                                   07790000
FLCTRACE EQU   PSA+84                                                   07791000
FLCTIMER EQU   PSA+80                                                   07792000
FLCCVT2  EQU   PSA+76                                                   07793000
FLCCAW   EQU   PSA+72                                                   07794000
FLCCSW   EQU   PSA+64                                                   07795000
FLCIOPSW EQU   PSA+56                                                   07796000
FLCMOPSW EQU   PSA+48                                                   07797000
FLCPOPSW EQU   PSA+40                                                   07798000
FLCSOPSW EQU   PSA+32                                                   07799000
FLCEOPSW EQU   PSA+24                                                   07800000
@NM00020 EQU   FLCICCW2+4                                               07801000
FLCCVT   EQU   FLCICCW2                                                 07802000
FLCICCW1 EQU   FLCROPSW                                                 07803000
FLCIPPSW EQU   FLCRNPSW                                                 07804000
*                                      END UNREFERENCED COMPONENTS      07805000
@RT00225 EQU   AHLADD01                                                 07806000
@RT00266 EQU   AHLADD02                                                 07807000
@RF00203 EQU   AHLEXIT                                                  07808000
@RT00331 EQU   AHLACT02                                                 07809000
@RT00384 EQU   AHLMCCL1                                                 07810000
@RC00334 EQU   @RC00333                                                 07811000
@RF00414 EQU   @RC00411                                                 07812000
@RT00425 EQU   AHLEEIN2                                                 07813000
@RT00435 EQU   AHLACT03                                                 07814000
@RT00450 EQU   AHLACT01                                                 07815000
@RF00450 EQU   AHLACT05                                                 07816000
@RC00307 EQU   @RC00304                                                 07817000
@RC00328 EQU   @RC00304                                                 07818000
@RT00462 EQU   AHLEXIT                                                  07819000
@RT00503 EQU   AHLFREE2                                                 07820000
@RC00536 EQU   @RC00534                                                 07821000
@RF00541 EQU   @RC00534                                                 07822000
@RT00549 EQU   AHLEEOT2                                                 07823000
@RF00580 EQU   @RC00577                                                 07824000
@RF00583 EQU   @RC00577                                                 07825000
@RF00626 EQU   @RC00620                                                 07826000
@RT00812 EQU   @EL00002                                                 07827000
@RF00812 EQU   AHLGET02                                                 07828000
@RC00908 EQU   @EL00002                                                 07829000
@RF00923 EQU   @EL00003                                                 07830000
@RT01004 EQU   @EL00005                                                 07831000
@RC00949 EQU   @EL00005                                                 07832000
@RF01034 EQU   @EL00006                                                 07833000
@RC01016 EQU   @EL00006                                                 07834000
@RF01068 EQU   @EL00007                                                 07835000
@PB00007 EQU   @PB00008                                                 07836000
@RT01106 EQU   AHLTFR02                                                 07837000
@RT01259 EQU   AHLMCPS2                                                 07838000
@RC00310 EQU   @RC00307                                                 07839000
@RF00441 EQU   @RC00328                                                 07840000
@RC00443 EQU   @RC00328                                                 07841000
@PB00006 EQU   @PB00007                                                 07842000
@PB00005 EQU   @PB00006                                                 07843000
@PB00004 EQU   @PB00005                                                 07844000
@PB00003 EQU   @PB00004                                                 07845000
@PB00002 EQU   @PB00003                                                 07846000
@ENDDATA EQU   *                                                        07847000
         END   AHLSETEV,(C'PLS2048',0701,77321)                         07848000
