         TITLE 'AHLT103 MESSAGE BUILD RTN                              *00001000
                       '                                                00002000
AHLT103  CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'AHLT103   73.240'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         ST    @13,@SA00001+4                                      0001 00014000
         LA    @14,@SA00001                                        0001 00015000
         ST    @14,8(,@13)                                         0001 00016000
         LR    @13,@14                                             0001 00017000
*                                                                  0035 00018000
*/********************************************************************/ 00019000
*/*                                                                  */ 00020000
*/*                  BEGIN AHLT103 EXECUTABLE CODE                   */ 00021000
*/*                                                                  */ 00022000
*/********************************************************************/ 00023000
*/********************************************************************/ 00024000
*/*                                                                  */ 00025000
*/*     INITIALIZE POINTERS AND PLACE MESSAGE SKELETON IN BUFFER     */ 00026000
*/*                                                                  */ 00027000
*/********************************************************************/ 00028000
*                                                                  0035 00029000
*   ICTMSGX=4;                      /* SET INDEX FOR AHL103I         */ 00030000
         L     @11,INITPTR(,PCTPTR)                                0035 00031000
         MVI   ICTMSGX(@11),X'04'                                  0035 00032000
*   TWTBUF(1:152)='';               /* CLEAR BUFFER            Y02014*/ 00033000
         MVI   TWTBUF(@11),C' '                                    0036 00034000
         MVC   TWTBUF+1(151,@11),TWTBUF(@11)                       0036 00035000
*   CALL AHLCTL2;                   /* GET MESSAGE             Y02014*/ 00036000
         L     @15,@CV00374                                        0037 00037000
         BALR  @14,@15                                             0037 00038000
*   MSGPTR=ADDR(TWTBUF)+WTOLEN;     /* SET PTR TO END OF MSG         */ 00039000
         L     @11,INITPTR(,PCTPTR)                                0038 00040000
         LA    MSGPTR,TWTBUF(,@11)                                 0038 00041000
         AH    MSGPTR,WTOLEN(,@11)                                 0038 00042000
*   RDHOLD=RTDCODE;                 /* SAVE ROUT,DESC CODES          */ 00043000
         MVC   RDHOLD(4),RTDCODE(MSGPTR)                           0039 00044000
*   OPHOLD=GTFOPIND;                /* SETUP TEMP OPTION INDS IN   0040 00045000
*                                      TWTWORK                 Y02014*/ 00046000
         MVC   OPHOLD(4,@11),GTFOPIND(@11)                         0040 00047000
*   PATHSW=6;                       /* SET SW FOR START PROC         */ 00048000
         LA    PATHSW,6                                            0041 00049000
*   DATASW=0;                       /* SET SW FOR NO MSG             */ 00050000
         SR    DATASW,DATASW                                       0042 00051000
*   TMPOPND2=TMPOPND2&'AA'X;        /* TURN OFF SVCP,SIOP,IOP, PIP IN   00052000
*                                      TMPOPIND                      */ 00053000
         NI    TMPOPND2(@11),X'AA'                                 0043 00054000
*   N=1;                            /* SET PTR TO 1ST OPTION IN OP 0044 00055000
*                                      INDS                          */ 00056000
         LA    N,1                                                 0044 00057000
*   OPREG=TMPOPIND;                 /* OPINDS TO REG                 */ 00058000
         L     OPREG,TMPOPIND(,@11)                                0045 00059000
*                                                                  0046 00060000
*/********************************************************************/ 00061000
*/*                                                                  */ 00062000
*/*                       BEGIN OPTION SEARCH                        */ 00063000
*/*               PLACE TRACE= OPTIONS IN MESSAGE FIRST              */ 00064000
*/*       PLACE FILTER DEVICES/CODES, IF ANY, IN MESSAGE SECOND      */ 00065000
*/*                                                                  */ 00066000
*/********************************************************************/ 00067000
*                                                                  0046 00068000
*T10301:                                                           0046 00069000
*   DO I=N                          /* SEARCH FOR OP BIT ON          */ 00070000
*         TO 20 BY 1;               /* START AT CURRENT OP     Y02014*/ 00071000
T10301   LR    I,N                                                 0046 00072000
         B     @DE00046                                            0046 00073000
@DL00046 DS    0H                                                  0047 00074000
*     CKREG=0;                      /* CLEAR CHECK REG               */ 00075000
         SR    CKREG,CKREG                                         0047 00076000
*     GEN(SLDL CKREG,1);            /* SHIFT OPTION BIT TO CKREG FROM   00077000
*                                      OPREG                         */ 00078000
*                                                                  0048 00079000
         SLDL CKREG,1                                                   00080000
*/********************************************************************/ 00081000
*/*                                                                  */ 00082000
*/*                      TEST FOR OPTION BIT ON                      */ 00083000
*/*                                                                  */ 00084000
*/********************************************************************/ 00085000
*                                                                  0049 00086000
*     IF CKREG^=0                   /* TEST FOR OP BIT ON            */ 00087000
*       THEN                        /* OP BIT ON                     */ 00088000
         LTR   CKREG,CKREG                                         0049 00089000
         BNZ   @RT00049                                            0049 00090000
*       GO TO T10302;               /* SAVE OPTION CHARS             */ 00091000
*   END;                                                           0051 00092000
         AH    I,@CH00049                                          0051 00093000
@DE00046 CH    I,@CH00280                                          0051 00094000
         BNH   @DL00046                                            0051 00095000
*   GO TO T10305;                   /* TEST FOR PROMPTING            */ 00096000
*                                                                  0052 00097000
         B     T10305                                              0052 00098000
*/********************************************************************/ 00099000
*/*                                                                  */ 00100000
*/*                     PLACE OPTION IN MESSAGE                      */ 00101000
*/*                                                                  */ 00102000
*/********************************************************************/ 00103000
*                                                                  0053 00104000
*T10302:                                                           0053 00105000
*   N=I+1;                          /* SET PTR TO NXT OP             */ 00106000
T10302   LA    N,1                                                 0053 00107000
         AR    N,I                                                 0053 00108000
*   MSGOP(1:4)=SCNOPTAB(I);         /* OPTION CHARS TO MSG           */ 00109000
         LR    @11,I                                               0054 00110000
         SLA   @11,2                                               0054 00111000
         LA    @09,SCNOPTAB-4(@11)                                 0054 00112000
         MVC   MSGOP(4,MSGPTR),0(@09)                              0054 00113000
*   I=5;                            /* SET PTR TO END OF OPTION CHARS*/ 00114000
*                                                                  0055 00115000
         LA    I,5                                                 0055 00116000
*/********************************************************************/ 00117000
*/*                                                                  */ 00118000
*/*                    TEST FOR BLANK IN KEYWORD                     */ 00119000
*/*                                                                  */ 00120000
*/********************************************************************/ 00121000
*                                                                  0056 00122000
*T10303:                                                           0056 00123000
*   IF MSGOP(I-1)^=BLANK(1)         /* TEST FOR NON BLANK            */ 00124000
*     THEN                          /* NON BLANK FOUND               */ 00125000
T10303   LR    @11,MSGPTR                                          0056 00126000
         ALR   @11,I                                               0056 00127000
         AL    @11,@CF00419                                        0056 00128000
         CLC   MSGOP(1,@11),BLANK                                  0056 00129000
         BNE   @RT00056                                            0056 00130000
*     GO TO T10304;                 /* INSERT COMMA                  */ 00131000
*   I=I-1;                          /* TO NEXT PSN                   */ 00132000
         BCTR  I,0                                                 0058 00133000
*   GO TO T10303;                   /* TEST FOR NON BLANK            */ 00134000
         B     T10303                                              0059 00135000
*T10304:                                                           0060 00136000
*   MSGOP(I)=RTPCOM(2);             /* INSERT COMMA IN MSG           */ 00137000
T10304   LR    @11,MSGPTR                                          0060 00138000
         ALR   @11,I                                               0060 00139000
         AL    @11,@CF00420                                        0060 00140000
         MVC   MSGOP(1,@11),RTPCOM+1                               0060 00141000
*   MSGPTR=MSGPTR+I;                /* UPDATE PTR TO NEW END OF MSG  */ 00142000
         AR    MSGPTR,I                                            0061 00143000
*   DATASW=1;                       /* SET SW TO ISSUE MSG           */ 00144000
         LA    DATASW,1                                            0062 00145000
*   WTOLEN=WTOLEN+I;                /* UPDATE LENGTH OF MSG          */ 00146000
         L     @11,INITPTR(,PCTPTR)                                0063 00147000
         LR    @09,I                                               0063 00148000
         AH    @09,WTOLEN(,@11)                                    0063 00149000
         STH   @09,WTOLEN(,@11)                                    0063 00150000
*   IF WTOLEN>60                    /* TEST FOR LEN > FULL LN        */ 00151000
*     THEN                          /* LINE FULL                     */ 00152000
         CH    @09,@CH00390                                        0064 00153000
         BH    @RT00064                                            0064 00154000
*     GO TO T10316;                 /* ISSUE MSG                     */ 00155000
*   GO TO T10301;                   /* GET NEXT OPTION               */ 00156000
         B     T10301                                              0066 00157000
*                                                                  0067 00158000
*/********************************************************************/ 00159000
*/*                                                                  */ 00160000
*/*        PLACE FILTER DEVICES/CODES, IF ANY, IN MESSAGE            */ 00161000
*/*                                                                  */ 00162000
*/********************************************************************/ 00163000
*/********************************************************************/ 00164000
*/*                                                                  */ 00165000
*/*                TEST FOR ANY FILTER DEVICES/CODES                 */ 00166000
*/*                                                                  */ 00167000
*/********************************************************************/ 00168000
*                                                                  0067 00169000
*T10305:                                                           0067 00170000
*   IF GTFSYSP='0'B                 /* TEST FOR SYSP OFF       Y02014*/ 00171000
*       &(GTFOPT2&'55'X)='00'X      /* TEST FOR ALL-P-BTS OFF  Y02014*/ 00172000
*     THEN                          /* NO PROMPTING                  */ 00173000
T10305   L     @11,INITPTR(,PCTPTR)                                0067 00174000
         TM    GTFSYSP(@11),B'01000000'                            0067 00175000
         BNZ   @RF00067                                            0067 00176000
         LA    @15,85                                              0067 00177000
         SR    @14,@14                                             0067 00178000
         IC    @14,GTFOPT2(,@11)                                   0067 00179000
         NR    @15,@14                                             0067 00180000
         LTR   @15,@15                                             0067 00181000
         BZ    @RT00067                                            0067 00182000
*     GO TO T10315;                 /* TEST FOR NO DATA              */ 00183000
*                                                                  0068 00184000
*/********************************************************************/ 00185000
*/*                                                                  */ 00186000
*/*                      TEST FOR IO=SIO OPTION                      */ 00187000
*/*                                                                  */ 00188000
*/********************************************************************/ 00189000
*                                                                  0069 00190000
*   IF GTFIOSIO='0'B                /* TEST FOR IO=SIO OFF     Y02014*/ 00191000
*     THEN                          /* NO IO=SIO OPTION              */ 00192000
@RF00067 L     @11,INITPTR(,PCTPTR)                                0069 00193000
         TM    GTFIOSIO(@11),B'00000001'                           0069 00194000
         BZ    @RT00069                                            0069 00195000
*     GO TO T10307;                 /* TEST FOR IO SELECTIVE         */ 00196000
*   PATHSW=1;                       /* SET SW FOR IO=SIO             */ 00197000
         LA    @15,1                                               0071 00198000
         LR    PATHSW,@15                                          0071 00199000
*   OPPTR=IOTAB;                    /* SET PTR TO ADDR IO EBCDIC   0072 00200000
*                                      TABLE                   Y02014*/ 00201000
         MVC   OPPTR(4),IOTAB(@11)                                 0072 00202000
*   I=1;                            /* SET INDEX TO REF BEGIN- NING     00203000
*                                      OF TBL                        */ 00204000
*                                                                  0073 00205000
         LR    I,@15                                               0073 00206000
*/********************************************************************/ 00207000
*/*                                                                  */ 00208000
*/*                   TEST FOR END OF IO=SIO TABLE                   */ 00209000
*/*                                                                  */ 00210000
*/********************************************************************/ 00211000
*                                                                  0074 00212000
*T10306:                                                           0074 00213000
*   IF OPTBL(I)=ENDLST              /* TEST FOR END OF TBL           */ 00214000
*     THEN                          /* END OF TBL                    */ 00215000
T10306   LR    @11,I                                               0074 00216000
         MH    @11,@CH00079                                        0074 00217000
         L     @09,OPPTR                                           0074 00218000
         ALR   @09,@11                                             0074 00219000
         AL    @09,@CF00421                                        0074 00220000
         CLC   OPTBL(3,@09),ENDLST                                 0074 00221000
         BE    @RT00074                                            0074 00222000
*     GO TO T10311;                 /* TEST FOR SVCP                 */ 00223000
*   MG103(1:8)=IOSIOCR;             /* PLACD -IO=SIO=(- IN MG        */ 00224000
         MVC   MG103(8,MSGPTR),IOSIOCR                             0076 00225000
*   MSGPTR=MSGPTR+8;                /* UPDATE PTR TO MSG END         */ 00226000
         LA    @11,8                                               0077 00227000
         AR    MSGPTR,@11                                          0077 00228000
*   WTOLEN=WTOLEN+8;                /* UPDATE MSG LENGTH             */ 00229000
         L     @09,INITPTR(,PCTPTR)                                0078 00230000
         AH    @11,WTOLEN(,@09)                                    0078 00231000
         STH   @11,WTOLEN(,@09)                                    0078 00232000
*   GO TO T10318;                   /* TEST FOR END OF TBL           */ 00233000
*                                                                  0079 00234000
         B     T10318                                              0079 00235000
*/********************************************************************/ 00236000
*/*                                                                  */ 00237000
*/*                        TEST FOR IO OPTION                        */ 00238000
*/*                                                                  */ 00239000
*/********************************************************************/ 00240000
*                                                                  0080 00241000
*T10307:                                                           0080 00242000
*   IF GTFIOP='0'B                  /* TEST FOR IO PROMPT OFF  Y02014*/ 00243000
*     THEN                          /* IO PROMPT OFF                 */ 00244000
T10307   L     @11,INITPTR(,PCTPTR)                                0080 00245000
         TM    GTFIOP(@11),B'00000001'                             0080 00246000
         BZ    @RT00080                                            0080 00247000
*     GO TO T10309;                 /* TEST FOR SIO PROMPT           */ 00248000
*   PATHSW=2;                       /* SET SW FOR IO PROMPT          */ 00249000
         LA    PATHSW,2                                            0082 00250000
*   OPPTR=IOTAB;                    /* SET PTR TO ADDR IO EBCDIC   0083 00251000
*                                      TABLE Y02014                  */ 00252000
         MVC   OPPTR(4),IOTAB(@11)                                 0083 00253000
*   I=1;                            /* SET INDEX TO REF BEGINNING OF    00254000
*                                      TABLE                         */ 00255000
*                                                                  0084 00256000
         LA    I,1                                                 0084 00257000
*/********************************************************************/ 00258000
*/*                                                                  */ 00259000
*/*                     TEST FOR END OF IO TABLE                     */ 00260000
*/*                                                                  */ 00261000
*/********************************************************************/ 00262000
*                                                                  0085 00263000
*T10308:                                                           0085 00264000
*   IF OPTBL(I)=ENDLST              /* TEST FOR END OF TBL           */ 00265000
*     THEN                          /* END OF TBL                    */ 00266000
T10308   LR    @11,I                                               0085 00267000
         MH    @11,@CH00079                                        0085 00268000
         L     @09,OPPTR                                           0085 00269000
         ALR   @09,@11                                             0085 00270000
         AL    @09,@CF00421                                        0085 00271000
         CLC   OPTBL(3,@09),ENDLST                                 0085 00272000
         BE    @RT00085                                            0085 00273000
*     GO TO T10309;                 /* TEST FOR SIO PROMPT           */ 00274000
*   MG103(1:4)=IOCR;                /* PLACE -IO=(- IN MSG           */ 00275000
         MVC   MG103(4,MSGPTR),IOCR                                0087 00276000
*   MSGPTR=MSGPTR+4;                /* UPDATE PTR TO MSG END         */ 00277000
         LA    @11,4                                               0088 00278000
         AR    MSGPTR,@11                                          0088 00279000
*   WTOLEN=WTOLEN+4;                /* UPDATE MSG LENGTH             */ 00280000
         L     @09,INITPTR(,PCTPTR)                                0089 00281000
         AH    @11,WTOLEN(,@09)                                    0089 00282000
         STH   @11,WTOLEN(,@09)                                    0089 00283000
*   GO TO T10318;                   /* TEST FOR END OF TBL           */ 00284000
*                                                                  0090 00285000
         B     T10318                                              0090 00286000
*/********************************************************************/ 00287000
*/*                                                                  */ 00288000
*/*                        TEST FOR SIO OPTION                       */ 00289000
*/*                                                                  */ 00290000
*/********************************************************************/ 00291000
*                                                                  0091 00292000
*T10309:                                                           0091 00293000
*   IF GTFSIOP='0'B                 /* TEST FOR SIO PROMPT OFF Y02014*/ 00294000
*     THEN                          /* SIO PROMPT OFF                */ 00295000
T10309   L     @11,INITPTR(,PCTPTR)                                0091 00296000
         TM    GTFSIOP(@11),B'00010000'                            0091 00297000
         BZ    @RT00091                                            0091 00298000
*     GO TO T10311;                 /* TEST FOR SVC PROMPT           */ 00299000
*   PATHSW=3;                       /* SET SW FOR SIO PROMPT         */ 00300000
         LA    PATHSW,3                                            0093 00301000
*   OPPTR=SIOTAB;                   /* SET PTR TO ADDR SIO EBCDIC  0094 00302000
*                                      TABLE                   Y02014*/ 00303000
         MVC   OPPTR(4),SIOTAB(@11)                                0094 00304000
*   I=1;                            /* SET INDEX TO REF BEGINNING OF    00305000
*                                      TABLE                         */ 00306000
*                                                                  0095 00307000
         LA    I,1                                                 0095 00308000
*/********************************************************************/ 00309000
*/*                                                                  */ 00310000
*/*                     TEST FOR END OF SIO TABLE                    */ 00311000
*/*                                                                  */ 00312000
*/********************************************************************/ 00313000
*                                                                  0096 00314000
*T10310:                                                           0096 00315000
*   IF OPTBL(I)=ENDLST              /* TEST FOR END OF TBL           */ 00316000
*     THEN                          /* END OF TBL                    */ 00317000
T10310   LR    @11,I                                               0096 00318000
         MH    @11,@CH00079                                        0096 00319000
         L     @09,OPPTR                                           0096 00320000
         ALR   @09,@11                                             0096 00321000
         AL    @09,@CF00421                                        0096 00322000
         CLC   OPTBL(3,@09),ENDLST                                 0096 00323000
         BE    @RT00096                                            0096 00324000
*     GO TO T10311;                 /* TEST FOR SVC PROMPT           */ 00325000
*   MG103(1:5)=SIOCR;               /* PLACE -SIO=(- IN MSG          */ 00326000
         MVC   MG103(5,MSGPTR),SIOCR                               0098 00327000
*   MSGPTR=MSGPTR+5;                /* UPDATE PTR TO MSG END         */ 00328000
         LA    @11,5                                               0099 00329000
         AR    MSGPTR,@11                                          0099 00330000
*   WTOLEN=WTOLEN+5;                /* UPDATE MSG LENGTH             */ 00331000
         L     @09,INITPTR(,PCTPTR)                                0100 00332000
         AH    @11,WTOLEN(,@09)                                    0100 00333000
         STH   @11,WTOLEN(,@09)                                    0100 00334000
*   GO TO T10318;                   /* TEST FOR END OF TBL           */ 00335000
*                                                                  0101 00336000
         B     T10318                                              0101 00337000
*/********************************************************************/ 00338000
*/*                                                                  */ 00339000
*/*                        TEST FOR SVC OPTION                       */ 00340000
*/*                                                                  */ 00341000
*/********************************************************************/ 00342000
*                                                                  0102 00343000
*T10311:                                                           0102 00344000
*   IF GTFSVCP='0'B                 /* TEST FOR SVC PROMPT OFF Y02014*/ 00345000
*     THEN                          /* SVC PROMPT OFF                */ 00346000
T10311   L     @11,INITPTR(,PCTPTR)                                0102 00347000
         TM    GTFSVCP(@11),B'01000000'                            0102 00348000
         BZ    @RT00102                                            0102 00349000
*     GO TO T10313;                 /* TEST FOR PI PROMPT            */ 00350000
*   PATHSW=4;                       /* SET SW FOR SVC PROMPT         */ 00351000
         LA    PATHSW,4                                            0104 00352000
*   OPPTR=SVCTAB;                   /* SET PTR TO ADDR SVC EBCDIC  0105 00353000
*                                      TABLE                   Y02014*/ 00354000
         MVC   OPPTR(4),SVCTAB(@11)                                0105 00355000
*   I=1;                            /* SET INDEX TO REF BEGINNING OF    00356000
*                                      TABLE                         */ 00357000
*                                                                  0106 00358000
         LA    I,1                                                 0106 00359000
*/********************************************************************/ 00360000
*/*                                                                  */ 00361000
*/*                     TEST FOR END OF SVC TABLE                    */ 00362000
*/*                                                                  */ 00363000
*/********************************************************************/ 00364000
*                                                                  0107 00365000
*T10312:                                                           0107 00366000
*   IF OPTBL(I)=ENDLST              /* TEST FOR END OF TBL           */ 00367000
*     THEN                          /* END OF TBL                    */ 00368000
T10312   LR    @11,I                                               0107 00369000
         MH    @11,@CH00079                                        0107 00370000
         L     @09,OPPTR                                           0107 00371000
         ALR   @09,@11                                             0107 00372000
         AL    @09,@CF00421                                        0107 00373000
         CLC   OPTBL(3,@09),ENDLST                                 0107 00374000
         BE    @RT00107                                            0107 00375000
*     GO TO T10313;                 /* TEST FOR PI PROMPT            */ 00376000
*   MG103(1:5)=SVCCR;               /* PLACE -SVC=(- IN MSG          */ 00377000
         MVC   MG103(5,MSGPTR),SVCCR                               0109 00378000
*   MSGPTR=MSGPTR+5;                /* UPDATE PTR TO MSG END         */ 00379000
         LA    @11,5                                               0110 00380000
         AR    MSGPTR,@11                                          0110 00381000
*   WTOLEN=WTOLEN+5;                /* UPDATE MSG LENGTH             */ 00382000
         L     @09,INITPTR(,PCTPTR)                                0111 00383000
         AH    @11,WTOLEN(,@09)                                    0111 00384000
         STH   @11,WTOLEN(,@09)                                    0111 00385000
*   GO TO T10318;                   /* TEST FOR END OF TBL           */ 00386000
*                                                                  0112 00387000
         B     T10318                                              0112 00388000
*/********************************************************************/ 00389000
*/*                                                                  */ 00390000
*/*                        TEST FOR PI OPTION                        */ 00391000
*/*                                                                  */ 00392000
*/********************************************************************/ 00393000
*                                                                  0113 00394000
*T10313:                                                           0113 00395000
*   IF GTFPIP='0'B                  /* TEST FOR PI PROMPT OFF  Y02014*/ 00396000
*     THEN                          /* PI PROMPT OFF                 */ 00397000
T10313   L     @11,INITPTR(,PCTPTR)                                0113 00398000
         TM    GTFPIP(@11),B'00000100'                             0113 00399000
         BZ    @RT00113                                            0113 00400000
*     GO TO T10315;                 /* TEST FOR MSG TO ISSUE         */ 00401000
*   PATHSW=5;                       /* SET SW FOR PI PROMPT          */ 00402000
         LA    PATHSW,5                                            0115 00403000
*   OPPTR=PITAB;                    /* SET PTR TO ADDR OF PI EBCDIC     00404000
*                                      TABLE                   Y02014*/ 00405000
         MVC   OPPTR(4),PITAB(@11)                                 0116 00406000
*   I=1;                            /* SET INDEX TO REF BEGINNING OF    00407000
*                                      TABLE                         */ 00408000
*                                                                  0117 00409000
         LA    I,1                                                 0117 00410000
*/********************************************************************/ 00411000
*/*                                                                  */ 00412000
*/*                     TEST FOR END OF PI TABLE                     */ 00413000
*/*                                                                  */ 00414000
*/********************************************************************/ 00415000
*                                                                  0118 00416000
*T10314:                                                           0118 00417000
*   IF OPTBL(I)=ENDLST              /* TEST FOR END OF TBL           */ 00418000
*     THEN                          /* END OF TBL                    */ 00419000
T10314   LR    @11,I                                               0118 00420000
         MH    @11,@CH00079                                        0118 00421000
         L     @09,OPPTR                                           0118 00422000
         ALR   @09,@11                                             0118 00423000
         AL    @09,@CF00421                                        0118 00424000
         CLC   OPTBL(3,@09),ENDLST                                 0118 00425000
         BE    @RT00118                                            0118 00426000
*     GO TO T10315;                 /* TEST FOR MSG TO ISSUE         */ 00427000
*   MG103(1:4)=PICR;                /* PLACE -PI=(- IN MSG           */ 00428000
         MVC   MG103(4,MSGPTR),PICR                                0120 00429000
*   MSGPTR=MSGPTR+4;                /* UPDATE PTR TO MSG END         */ 00430000
         LA    @11,4                                               0121 00431000
         AR    MSGPTR,@11                                          0121 00432000
*   WTOLEN=WTOLEN+4;                /* UPDATE MSG LENGTH             */ 00433000
         L     @09,INITPTR(,PCTPTR)                                0122 00434000
         AH    @11,WTOLEN(,@09)                                    0122 00435000
         STH   @11,WTOLEN(,@09)                                    0122 00436000
*   GO TO T10318;                   /* TEST FOR END OF TBL           */ 00437000
         B     T10318                                              0123 00438000
*                                                                  0124 00439000
*/********************************************************************/ 00440000
*/*                                                                  */ 00441000
*/*                     TEST FOR MESSAGES PENDING                    */ 00442000
*/*                                                                  */ 00443000
*/********************************************************************/ 00444000
*                                                                  0124 00445000
*T10315:                                                           0124 00446000
*   IF DATASW=0                     /* TEST FOR MSG                  */ 00447000
*     THEN                          /* NO MSGS TO ISSUE              */ 00448000
T10315   LTR   DATASW,DATASW                                       0124 00449000
         BNZ   @RF00124                                            0124 00450000
*     DO;                                                          0125 00451000
*       RETURN;                     /* RETURN TO AHLTCTL1            */ 00452000
@EL00001 L     @13,4(,@13)                                         0126 00453000
@EF00001 DS    0H                                                  0126 00454000
@ER00001 LM    @14,@12,12(@13)                                     0126 00455000
         BR    @14                                                 0126 00456000
*     END;                                                         0127 00457000
*   PATHSW=7;                       /* SET SW TO END PROC            */ 00458000
*                                                                  0128 00459000
@RF00124 LA    PATHSW,7                                            0128 00460000
*/********************************************************************/ 00461000
*/*                                                                  */ 00462000
*/*                ISSUE ONE LINE OF MESSAGE AHL103I                 */ 00463000
*/*                                                                  */ 00464000
*/********************************************************************/ 00465000
*                                                                  0129 00466000
*T10316:                                                           0129 00467000
*   WTOLEN=WTOLEN-1;                /* DECR LENGTH SO LAST COMMA NOT    00468000
*                                      WRITTEN                       */ 00469000
T10316   L     @11,INITPTR(,PCTPTR)                                0129 00470000
         LH    @09,WTOLEN(,@11)                                    0129 00471000
         BCTR  @09,0                                               0129 00472000
         STH   @09,WTOLEN(,@11)                                    0129 00473000
*   MSGPTR=MSGPTR-1;                /* DECR PTR TO MSG END           */ 00474000
         BCTR  MSGPTR,0                                            0130 00475000
*T10317:                                                           0131 00476000
*   RTDCODE=RDHOLD;                 /* RESTORE ROUT,DESC CODE        */ 00477000
T10317   MVC   RTDCODE(4,MSGPTR),RDHOLD                            0131 00478000
*   ICTMSGX=255;                    /* SET INDEX FOR MSG IN BUFFER   */ 00479000
         L     @11,INITPTR(,PCTPTR)                                0132 00480000
         MVI   ICTMSGX(@11),X'FF'                                  0132 00481000
*   ICTIOTYP=2;                     /* SET IO TYPE FOR WTO           */ 00482000
         MVI   ICTIOTYP(@11),X'02'                                 0133 00483000
*   CALL AHLTIO;                    /* ISSUE MESSAGE           Y02014*/ 00484000
*                                                                  0134 00485000
         L     @15,@CV00375                                        0134 00486000
         BALR  @14,@15                                             0134 00487000
*/********************************************************************/ 00488000
*/*                                                                  */ 00489000
*/*   CLEAR BUFFER, RESET POINTERS, AND RETURN TO MESSAGE BUILDING   */ 00490000
*/*                                                                  */ 00491000
*/********************************************************************/ 00492000
*                                                                  0135 00493000
*   TWTBUF(1:152)='';               /* CLEAR BUFFER            Y02014*/ 00494000
         L     @11,INITPTR(,PCTPTR)                                0135 00495000
         MVI   TWTBUF(@11),C' '                                    0135 00496000
         MVC   TWTBUF+1(151,@11),TWTBUF(@11)                       0135 00497000
*   TWTBUF(1:4)=PREF103;            /* PLACE MSG LEN,FLAGS IN BUFFER */ 00498000
         MVC   TWTBUF(4,@11),PREF103                               0136 00499000
*   TWTBUF(5:13)=ID103;             /* PLACE MSG ID IN BUFF          */ 00500000
         MVC   TWTBUF+4(9,@11),ID103                               0137 00501000
*   MSGPTR=ADDR(TWTBUF)+WTOLEN;     /* RESET MSG PTR                 */ 00502000
         LA    MSGPTR,TWTBUF(,@11)                                 0138 00503000
         AH    MSGPTR,WTOLEN(,@11)                                 0138 00504000
*   DATASW=0;                       /* SET SW FOR NO OUT- STANDING 0139 00505000
*                                      MSGS TO ISSUE                 */ 00506000
         SR    DATASW,DATASW                                       0139 00507000
*   GO TO WTGTAB1(PATHSW);          /* RETURN TO ROUTINE             */ 00508000
         LR    @11,PATHSW                                          0140 00509000
         SLA   @11,2                                               0140 00510000
         L     @11,WTGTAB1-4(@11)                                  0140 00511000
         BR    @11                                                 0140 00512000
*                                                                  0141 00513000
*/********************************************************************/ 00514000
*/*                                                                  */ 00515000
*/*              PLACE FILTER DEVICE/CODE INTO MESSAGE               */ 00516000
*/*                                                                  */ 00517000
*/********************************************************************/ 00518000
*/********************************************************************/ 00519000
*/*                                                                  */ 00520000
*/*                   TEST FOR END OF FILTER TABLE                   */ 00521000
*/*                                                                  */ 00522000
*/********************************************************************/ 00523000
*                                                                  0141 00524000
*T10318:                                                           0141 00525000
*   IF OPTBL(I)^=ENDLST             /* TEST FOR NOT TBL END          */ 00526000
*     THEN                          /* NOT END OF TBL                */ 00527000
T10318   LR    @11,I                                               0141 00528000
         MH    @11,@CH00079                                        0141 00529000
         L     @09,OPPTR                                           0141 00530000
         ALR   @09,@11                                             0141 00531000
         AL    @09,@CF00421                                        0141 00532000
         CLC   OPTBL(3,@09),ENDLST                                 0141 00533000
         BNE   @RT00141                                            0141 00534000
*     GO TO T10319;                 /* PLACE TBL ENTRY IN MSG        */ 00535000
*   MSGPTR=MSGPTR-1;                /* DECR PTR TO COVER LAST COMMA  */ 00536000
         BCTR  MSGPTR,0                                            0143 00537000
*   MG103(1:2)=RTPCOM;              /* UPDATE PTR TO MSG END         */ 00538000
         MVC   MG103(2,MSGPTR),RTPCOM                              0144 00539000
*   MSGPTR=MSGPTR+2;                /* UPDATE MSG PTR                */ 00540000
         AH    MSGPTR,@CH00357                                     0145 00541000
*   WTOLEN=WTOLEN+1;                /* UPDATE MSG LENGTH             */ 00542000
         L     @11,INITPTR(,PCTPTR)                                0146 00543000
         LA    @09,1                                               0146 00544000
         AH    @09,WTOLEN(,@11)                                    0146 00545000
         STH   @09,WTOLEN(,@11)                                    0146 00546000
*   GO TO WTGTAB2(PATHSW);          /* RETURN TO ROUTINE             */ 00547000
         LR    @11,PATHSW                                          0147 00548000
         SLA   @11,2                                               0147 00549000
         L     @11,WTGTAB2-4(@11)                                  0147 00550000
         BR    @11                                                 0147 00551000
*T10319:                                                           0148 00552000
*   MG103(1:3)=OPTBL(I);            /* TBL ENTRY TO MSG              */ 00553000
T10319   LA    @11,3                                               0148 00554000
         LR    @01,I                                               0148 00555000
         MR    @00,@11                                             0148 00556000
         L     @09,OPPTR                                           0148 00557000
         ALR   @09,@01                                             0148 00558000
         AL    @09,@CF00421                                        0148 00559000
         MVC   MG103(3,MSGPTR),OPTBL(@09)                          0148 00560000
*   J=3;                            /* SET INDEX TO PLACE COMMA IN 0149 00561000
*                                      MSG                           */ 00562000
*                                                                  0149 00563000
         LR    J,@11                                               0149 00564000
*/********************************************************************/ 00565000
*/*                                                                  */ 00566000
*/*                    TEST FOR SVC OR PI OPTION                     */ 00567000
*/*                                                                  */ 00568000
*/********************************************************************/ 00569000
*                                                                  0150 00570000
*   IF PATHSW<=3                    /* TEST FOR < SVC                */ 00571000
*       |PATHSW>=6                  /* TEST FOR > PI                 */ 00572000
*     THEN                          /* NOT SVC OR PI                 */ 00573000
         CR    PATHSW,@11                                          0150 00574000
         BNH   @RT00150                                            0150 00575000
         CH    PATHSW,@CH00379                                     0150 00576000
         BNL   @RT00150                                            0150 00577000
*     GO TO T10320;                 /* PLACE COMMA IN MSG            */ 00578000
*                                                                  0152 00579000
*/********************************************************************/ 00580000
*/*                                                                  */ 00581000
*/*            DELETE LEADING ZEROS FROM SVC OR PI NUMBER            */ 00582000
*/*                                                                  */ 00583000
*/********************************************************************/ 00584000
*                                                                  0152 00585000
*   K=1;                            /* SET INDEX FOR COMMA           */ 00586000
*                                                                  0152 00587000
         LA    @11,1                                               0152 00588000
         LR    K,@11                                               0152 00589000
*/********************************************************************/ 00590000
*/*                                                                  */ 00591000
*/*                 TEST FOR ZERO IN FIRST POSITION                  */ 00592000
*/*                                                                  */ 00593000
*/********************************************************************/ 00594000
*                                                                  0153 00595000
*   IF MG103(1)='0'                 /* TEST FOR 0 IN 1ST PSN         */ 00596000
*     THEN                          /* 1ST CHAR 0                    */ 00597000
         CLI   MG103(MSGPTR),C'0'                                  0153 00598000
         BNE   @RF00153                                            0153 00599000
*     DO;                                                          0154 00600000
*                                                                  0154 00601000
*/********************************************************************/ 00602000
*/*                                                                  */ 00603000
*/*                 TEST FOR ZERO IN SECOND POSITION                 */ 00604000
*/*                                                                  */ 00605000
*/********************************************************************/ 00606000
*                                                                  0155 00607000
*       IF MG103(2)='0'             /* TEST FOR 0 IN 2ND PSN         */ 00608000
*         THEN                      /* 2ND CHAR 0                    */ 00609000
*                                                                  0155 00610000
         CLI   MG103+1(MSGPTR),C'0'                                0155 00611000
         BNE   @RF00155                                            0155 00612000
*/********************************************************************/ 00613000
*/*                                                                  */ 00614000
*/*               ADJUST INDICES FOR TWO LEADING ZEROS               */ 00615000
*/*                                                                  */ 00616000
*/********************************************************************/ 00617000
*                                                                  0156 00618000
*         DO;                                                      0156 00619000
*           J=J-1;                  /* DECR END INDEX                */ 00620000
         BCTR  J,0                                                 0157 00621000
*           K=K+1;                  /* INCR START INDEX              */ 00622000
         AR    K,@11                                               0158 00623000
*         END;                                                     0159 00624000
*       J=J-1;                      /* DECR END INDEX                */ 00625000
@RF00155 BCTR  J,0                                                 0160 00626000
*       K=K+1;                      /* INCR START INDEX              */ 00627000
         AH    K,@CH00049                                          0161 00628000
*     END;                                                         0162 00629000
*   MG103(1:J)=MG103(K:3);          /* ADJUST SVC/PI NUMBER TO     0163 00630000
*                                      ELIMINATE LEADING 0S          */ 00631000
@RF00153 LR    @11,J                                               0163 00632000
         BCTR  @11,0                                               0163 00633000
         LR    @01,MSGPTR                                          0163 00634000
         ALR   @01,K                                               0163 00635000
         AL    @01,@CF00420                                        0163 00636000
         MVC   @TS00001(75),MG103(@01)                             0163 00637000
         EX    @11,@SM00422                                        0163 00638000
*                                                                  0164 00639000
*/********************************************************************/ 00640000
*/*                                                                  */ 00641000
*/*                      ADJUST END OF MESSAGE                       */ 00642000
*/*                                                                  */ 00643000
*/********************************************************************/ 00644000
*                                                                  0164 00645000
*T10320:                                                           0164 00646000
*   MG103(J+1)=RTPCOM(2);           /* COMMA TO MSG                  */ 00647000
T10320   LR    @11,MSGPTR                                          0164 00648000
         ALR   @11,J                                               0164 00649000
         MVC   MG103(1,@11),RTPCOM+1                               0164 00650000
*   MSGPTR=MSGPTR+J;                /* UPDATE PTR TO MSG END         */ 00651000
         AR    MSGPTR,J                                            0165 00652000
*   WTOLEN=WTOLEN+J+1;              /* UPDATE MSG LENGTH             */ 00653000
         L     @11,INITPTR(,PCTPTR)                                0166 00654000
         LA    @09,1                                               0166 00655000
         LR    @15,J                                               0166 00656000
         AH    @15,WTOLEN(,@11)                                    0166 00657000
         AR    @15,@09                                             0166 00658000
         STH   @15,WTOLEN(,@11)                                    0166 00659000
*   DATASW=1;                       /* SET SW TO ISSUE MSG           */ 00660000
         LR    DATASW,@09                                          0167 00661000
*   I=I+1;                          /* TO NXT TBL ENTRY              */ 00662000
*                                                                  0168 00663000
         AR    I,@09                                               0168 00664000
*/********************************************************************/ 00665000
*/*                                                                  */ 00666000
*/*     TEST FOR MESSAGE LENGTH GREATER THAN MAXIMUM LINE LENGTH     */ 00667000
*/*                                                                  */ 00668000
*/********************************************************************/ 00669000
*                                                                  0169 00670000
*   IF WTOLEN<=60                   /* TEST FOR NOT FULL LINE        */ 00671000
*     THEN                          /* NOT FULL LINE                 */ 00672000
         CH    @15,@CH00390                                        0169 00673000
         BH    @RF00169                                            0169 00674000
*     DO;                                                          0170 00675000
*       MSGPTR=MSGPTR+1;            /* INCR PTR FOR DECR             */ 00676000
         AR    MSGPTR,@09                                          0171 00677000
*       GO TO T10318;               /* TEST FOR END OF TBL           */ 00678000
         B     T10318                                              0172 00679000
*     END;                                                         0173 00680000
*   MG103(1)=RTPCOM(1);             /* RT PAREN TO MSG               */ 00681000
@RF00169 MVC   MG103(1,MSGPTR),RTPCOM                              0174 00682000
*   MSGPTR=MSGPTR+1;                /* UPDATE PTR TO MSG END         */ 00683000
         AH    MSGPTR,@CH00049                                     0175 00684000
*   GO TO T10317;                   /* ISSUE MSG                     */ 00685000
         B     T10317                                              0176 00686000
*   END AHLT103                     /* END AHLT103 PROC              */ 00687000
*                                                                  0177 00688000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00689000
*/*%INCLUDE SYSLIB  (GTFPCT  )                                       */ 00690000
*/*%INCLUDE SYSLIB  (INITDATA)                                       */ 00691000
*                                                                  0177 00692000
*       ;                                                          0177 00693000
@DATA    DS    0H                                                       00694000
@CH00049 DC    H'1'                                                     00695000
@CH00357 DC    H'2'                                                     00696000
@CH00079 DC    H'3'                                                     00697000
@CH00379 DC    H'6'                                                     00698000
@CH00280 DC    H'20'                                                    00699000
@CH00390 DC    H'60'                                                    00700000
@SM00422 MVC   MG103(0,MSGPTR),@TS00001                                 00701000
         DS    0F                                                       00702000
@SA00001 DS    18F                                                      00703000
         DS    0F                                                       00704000
@CF00421 DC    F'-3'                                                    00705000
@CF00419 DC    F'-2'                                                    00706000
@CF00420 DC    F'-1'                                                    00707000
@CV00374 DC    V(AHLCTL2)                                               00708000
@CV00375 DC    V(AHLTIO)                                                00709000
         DS    0D                                                       00710000
OPPTR    DS    A                                                        00711000
@TS00001 DS    CL75                                                     00712000
RDHOLD   DS    CL4                                                      00713000
BLANK    DC    CL4'    '                                                00714000
ENDLST   DC    X'FFFFFF'                                                00715000
RTPCOM   DC    CL2'),'                                                  00716000
PREF103  DC    X'000D8000'                                              00717000
ID103    DC    CL9'AHL103I  '                                           00718000
IOSIOCR  DC    CL8'IO=SIO=('                                            00719000
IOCR     DC    CL4'IO=('                                                00720000
SIOCR    DC    CL5'SIO=('                                               00721000
SVCCR    DC    CL5'SVC=('                                               00722000
PICR     DC    CL4'PI=('                                                00723000
PTCH103  DS    CL140                                                    00724000
SCNOPTAB DC    CL4'SYSM'                                                00725000
         DC    CL4'SYSP'                                                00726000
         DC    CL4'SYS '                                                00727000
         DC    CL4'USR '                                                00728000
         DC    CL4'TRC '                                                00729000
         DC    CL4'DSP '                                                00730000
         DC    CL4'    '                                                00731000
         DC    CL4'PCI '                                                00732000
         DC    CL4'SVC '                                                00733000
         DC    CL4'SVCP'                                                00734000
         DC    CL4'SIO '                                                00735000
         DC    CL4'SIOP'                                                00736000
         DC    CL4'PI  '                                                00737000
         DC    CL4'PIP '                                                00738000
         DC    CL4'IO  '                                                00739000
         DC    CL4'IOP '                                                00740000
         DC    CL4'EXT '                                                00741000
         DC    CL4'RNIO'                                                00742000
         DC    CL4'SRM '                                                00743000
         DC    CL4'RR  '                                                00744000
         DS    CL1                                                      00745000
WTGTAB1  DC    AL4(T10306)                                              00746000
         DC    AL4(T10308)                                              00747000
         DC    AL4(T10310)                                              00748000
         DC    AL4(T10312)                                              00749000
         DC    AL4(T10314)                                              00750000
         DC    AL4(T10301)                                              00751000
         DC    AL4(T10315)                                              00752000
WTGTAB2  DC    AL4(T10311)                                              00753000
         DC    AL4(T10309)                                              00754000
         DC    AL4(T10311)                                              00755000
         DC    AL4(T10313)                                              00756000
         DC    AL4(T10315)                                              00757000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00758000
@01      EQU   01                                                       00759000
@02      EQU   02                                                       00760000
@03      EQU   03                                                       00761000
@04      EQU   04                                                       00762000
@05      EQU   05                                                       00763000
@06      EQU   06                                                       00764000
@07      EQU   07                                                       00765000
@08      EQU   08                                                       00766000
@09      EQU   09                                                       00767000
@10      EQU   10                                                       00768000
@11      EQU   11                                                       00769000
@12      EQU   12                                                       00770000
@13      EQU   13                                                       00771000
@14      EQU   14                                                       00772000
@15      EQU   15                                                       00773000
N        EQU   @10                                                      00774000
K        EQU   @09                                                      00775000
J        EQU   @05                                                      00776000
DATASW   EQU   @05                                                      00777000
PATHSW   EQU   @08                                                      00778000
I        EQU   @04                                                      00779000
MSGPTR   EQU   @03                                                      00780000
CKREG    EQU   @06                                                      00781000
OPREG    EQU   @07                                                      00782000
PCTPTR   EQU   @02                                                      00783000
GTFPCT   EQU   0                                                        00784000
GTFSTAT  EQU   GTFPCT+8                                                 00785000
GTFOPTS  EQU   GTFPCT+12                                                00786000
GTFOPTS1 EQU   GTFOPTS                                                  00787000
GTFOPTS2 EQU   GTFOPTS+1                                                00788000
GTFOPTS3 EQU   GTFOPTS+2                                                00789000
GTFOPTS4 EQU   GTFOPTS+3                                                00790000
PCTCATF  EQU   GTFPCT+16                                                00791000
INITPTR  EQU   GTFPCT+60                                                00792000
NEXTBLOK EQU   GTFPCT+180                                               00793000
WRTRCOM  EQU   GTFPCT+204                                               00794000
TRMWRIT  EQU   GTFPCT+212                                               00795000
WRTRERR  EQU   GTFPCT+216                                               00796000
GTFSSRB  EQU   GTFPCT+220                                               00797000
QLOCKWRD EQU   GTFPCT+236                                               00798000
QLOCKECB EQU   GTFPCT+240                                               00799000
AUDITFLG EQU   GTFPCT+296                                               00800000
INITDATA EQU   0                                                        00801000
ICT      EQU   INITDATA+16                                              00802000
ICTMSGX  EQU   ICT                                                      00803000
ICTIOTYP EQU   ICT+1                                                    00804000
ICTFLAGS EQU   ICT+2                                                    00805000
GTFOPIND EQU   INITDATA+152                                             00806000
GTFOPT1  EQU   GTFOPIND                                                 00807000
GTFSYSP  EQU   GTFOPT1                                                  00808000
GTFOPT2  EQU   GTFOPIND+1                                               00809000
GTFSVCP  EQU   GTFOPT2                                                  00810000
GTFSIOP  EQU   GTFOPT2                                                  00811000
GTFPIP   EQU   GTFOPT2                                                  00812000
GTFIOP   EQU   GTFOPT2                                                  00813000
GTFOPT3  EQU   GTFOPIND+2                                               00814000
GTFIOSIO EQU   GTFOPT3                                                  00815000
GTFOPT4  EQU   GTFOPIND+3                                               00816000
IOTAB    EQU   INITDATA+156                                             00817000
SIOTAB   EQU   INITDATA+160                                             00818000
SVCTAB   EQU   INITDATA+164                                             00819000
PITAB    EQU   INITDATA+168                                             00820000
TWT      EQU   INITDATA+176                                             00821000
TWTWORK  EQU   TWT+8                                                    00822000
TWTBUF   EQU   TWT+40                                                   00823000
OPTBL    EQU   0                                                        00824000
MSGOP    EQU   0                                                        00825000
RTDCODE  EQU   0                                                        00826000
MG103    EQU   0                                                        00827000
TMPOPIND EQU   TWTWORK+8                                                00828000
TMPOPND1 EQU   TMPOPIND                                                 00829000
TMPOPND2 EQU   TMPOPIND+1                                               00830000
TMPOPND3 EQU   TMPOPIND+2                                               00831000
WTOLEN   EQU   TWTBUF                                                   00832000
OPHOLD   EQU   TWTWORK+8                                                00833000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00834000
TMPOPND4 EQU   TMPOPIND+3                                               00835000
TMPIOEQ  EQU   TMPOPND3                                                 00836000
TMPRES   EQU   TMPOPND3                                                 00837000
TMPRR    EQU   TMPOPND3                                                 00838000
TMPSRM   EQU   TMPOPND3                                                 00839000
TMPRNIO  EQU   TMPOPND3                                                 00840000
TMPEXT   EQU   TMPOPND3                                                 00841000
TMPIOP   EQU   TMPOPND2                                                 00842000
TMPIO    EQU   TMPOPND2                                                 00843000
TMPPIP   EQU   TMPOPND2                                                 00844000
TMPPI    EQU   TMPOPND2                                                 00845000
TMPSIOP  EQU   TMPOPND2                                                 00846000
TMPSIO   EQU   TMPOPND2                                                 00847000
TMPSVCP  EQU   TMPOPND2                                                 00848000
TMPSVC   EQU   TMPOPND2                                                 00849000
TMPPCI   EQU   TMPOPND1                                                 00850000
TMPRES1  EQU   TMPOPND1                                                 00851000
TMPDSP   EQU   TMPOPND1                                                 00852000
TMPTRC   EQU   TMPOPND1                                                 00853000
TMPUSR   EQU   TMPOPND1                                                 00854000
TMPSYS   EQU   TMPOPND1                                                 00855000
TMPSYSP  EQU   TMPOPND1                                                 00856000
TMPSYSM  EQU   TMPOPND1                                                 00857000
@NM00010 EQU   TWT+4                                                    00858000
@NM00009 EQU   TWT                                                      00859000
RANGPTR  EQU   INITDATA+172                                             00860000
GTFTIME  EQU   GTFOPT4                                                  00861000
GTFRES3  EQU   GTFOPT4                                                  00862000
GTFRES2  EQU   GTFOPT3                                                  00863000
GTFRR    EQU   GTFOPT3                                                  00864000
GTFSRM   EQU   GTFOPT3                                                  00865000
GTFRNIO  EQU   GTFOPT3                                                  00866000
GTFEXT   EQU   GTFOPT3                                                  00867000
GTFIO    EQU   GTFOPT2                                                  00868000
GTFPI    EQU   GTFOPT2                                                  00869000
GTFSIO   EQU   GTFOPT2                                                  00870000
GTFSVC   EQU   GTFOPT2                                                  00871000
GTFPCI   EQU   GTFOPT1                                                  00872000
GTFRES1  EQU   GTFOPT1                                                  00873000
GTFDSP   EQU   GTFOPT1                                                  00874000
GTFTRC   EQU   GTFOPT1                                                  00875000
GTFUSR   EQU   GTFOPT1                                                  00876000
GTFSYS   EQU   GTFOPT1                                                  00877000
GTFSYSM  EQU   GTFOPT1                                                  00878000
MSGREPLY EQU   INITDATA+28                                              00879000
WTORECB  EQU   INITDATA+24                                              00880000
PARMDCB  EQU   INITDATA+20                                              00881000
ICTRESV  EQU   ICTFLAGS                                                 00882000
ICTSTOP  EQU   ICTFLAGS                                                 00883000
ICTTRCIN EQU   ICTFLAGS                                                 00884000
ICTRETRY EQU   ICTFLAGS                                                 00885000
ICTEOD   EQU   ICTFLAGS                                                 00886000
ICTIOERR EQU   ICTFLAGS                                                 00887000
ICTPLIB  EQU   ICTFLAGS                                                 00888000
EXECPTR  EQU   INITDATA+12                                              00889000
CIBPTR   EQU   INITDATA+8                                               00890000
INITID   EQU   INITDATA                                                 00891000
PCTWTOMD EQU   GTFPCT+312                                               00892000
PCTDMPMD EQU   GTFPCT+308                                               00893000
TRANSMAX EQU   GTFPCT+304                                               00894000
GTFASCB  EQU   GTFPCT+300                                               00895000
@NM00008 EQU   AUDITFLG+3                                               00896000
AFSLEBLD EQU   AUDITFLG+3                                               00897000
WSERFG06 EQU   AUDITFLG+3                                               00898000
WSERFG05 EQU   AUDITFLG+3                                               00899000
WSERFG04 EQU   AUDITFLG+3                                               00900000
WSERFG03 EQU   AUDITFLG+3                                               00901000
WSERFG02 EQU   AUDITFLG+2                                               00902000
WSERFLAG EQU   AUDITFLG+2                                               00903000
TERMFLAG EQU   AUDITFLG+2                                               00904000
AFXWRIT  EQU   AUDITFLG+2                                               00905000
AFQLWAIT EQU   AUDITFLG+2                                               00906000
AFSLEGET EQU   AUDITFLG+2                                               00907000
AFBUFGET EQU   AUDITFLG+2                                               00908000
AFFEOB   EQU   AUDITFLG+2                                               00909000
AFBLKFIX EQU   AUDITFLG+1                                               00910000
AFEQFIX  EQU   AUDITFLG+1                                               00911000
AFPGRLSE EQU   AUDITFLG+1                                               00912000
AFWRAP   EQU   AUDITFLG+1                                               00913000
AFBUFOFF EQU   AUDITFLG+1                                               00914000
AFLDFX   EQU   AUDITFLG+1                                               00915000
AFCLOSE  EQU   AUDITFLG+1                                               00916000
AFOPEN   EQU   AUDITFLG+1                                               00917000
AFGMBLOK EQU   AUDITFLG                                                 00918000
AFGMSRB  EQU   AUDITFLG                                                 00919000
AFWAIT   EQU   AUDITFLG                                                 00920000
AFTERM   EQU   AUDITFLG                                                 00921000
AFINIT   EQU   AUDITFLG                                                 00922000
AFWWRIT  EQU   AUDITFLG                                                 00923000
AFCWRIT  EQU   AUDITFLG                                                 00924000
AFIWRIT  EQU   AUDITFLG                                                 00925000
EQSHORT  EQU   GTFPCT+292                                               00926000
SLEMAX   EQU   GTFPCT+288                                               00927000
SLECNT   EQU   GTFPCT+284                                               00928000
RQPURGE  EQU   GTFPCT+280                                               00929000
RQTOTAL  EQU   GTFPCT+276                                               00930000
WRTDLST  EQU   GTFPCT+272                                               00931000
NUMOFBUF EQU   GTFPCT+268                                               00932000
SBUFDISA EQU   GTFPCT+264                                               00933000
SLESUSED EQU   GTFPCT+260                                               00934000
EQMIN    EQU   GTFPCT+256                                               00935000
EQLENGTH EQU   GTFPCT+252                                               00936000
WQMAX    EQU   GTFPCT+248                                               00937000
WQLENGTH EQU   GTFPCT+244                                               00938000
QLECBP   EQU   QLOCKECB                                                 00939000
@NM00007 EQU   QLOCKECB                                                 00940000
@NM00006 EQU   QLOCKWRD+3                                               00941000
SCHEDBUF EQU   QLOCKWRD+2                                               00942000
POSTWRIT EQU   QLOCKWRD+1                                               00943000
QLOCK    EQU   QLOCKWRD                                                 00944000
WRITERDD EQU   GTFPCT+228                                               00945000
GTFLOSTR EQU   GTFPCT+224                                               00946000
SRBAVAIL EQU   GTFSSRB                                                  00947000
WRTRERRP EQU   WRTRERR                                                  00948000
@NM00005 EQU   WRTRERR                                                  00949000
TRMWRITP EQU   TRMWRIT                                                  00950000
@NM00004 EQU   TRMWRIT                                                  00951000
GTFCMECB EQU   GTFPCT+208                                               00952000
WRTRCOMP EQU   WRTRCOM                                                  00953000
@NM00003 EQU   WRTRCOM                                                  00954000
TRANSCNT EQU   GTFPCT+200                                               00955000
AHLRDPLQ EQU   GTFPCT+196                                               00956000
SFEOBRTN EQU   GTFPCT+192                                               00957000
SBLOKRTN EQU   GTFPCT+188                                               00958000
CURRBLOK EQU   GTFPCT+184                                               00959000
GBCDS    EQU   NEXTBLOK                                                 00960000
WSMODEND EQU   GTFPCT+176                                               00961000
WSMODBEG EQU   GTFPCT+172                                               00962000
BCBPAGE  EQU   GTFPCT+156                                               00963000
SLEPAGE  EQU   GTFPCT+152                                               00964000
SAVECNT  EQU   GTFPCT+148                                               00965000
SLQHEAD  EQU   GTFPCT+144                                               00966000
HQLENGTH EQU   GTFPCT+140                                               00967000
QTAIL    EQU   GTFPCT+136                                               00968000
HQHEAD   EQU   GTFPCT+132                                               00969000
WQHEAD   EQU   GTFPCT+128                                               00970000
RQHEAD   EQU   GTFPCT+124                                               00971000
EQHEAD   EQU   GTFPCT+120                                               00972000
WPOSTSRB EQU   GTFPCT+116                                               00973000
WTSKTCBA EQU   GTFPCT+112                                               00974000
WRTRTCBA EQU   GTFPCT+108                                               00975000
TRMWTASK EQU   GTFPCT+104                                               00976000
WTSKATTH EQU   GTFPCT+100                                               00977000
WTSKINIT EQU   GTFPCT+96                                                00978000
WTASKECB EQU   GTFPCT+92                                                00979000
WMTABPTR EQU   GTFPCT+88                                                00980000
ATTCHECB EQU   GTFPCT+84                                                00981000
AHLECB   EQU   GTFPCT+80                                                00982000
STOPECBA EQU   GTFPCT+76                                                00983000
ECBADRLT EQU   GTFPCT+72                                                00984000
FIXLEN   EQU   GTFPCT+68                                                00985000
FIXPTR   EQU   GTFPCT+64                                                00986000
MCQEPTR  EQU   GTFPCT+56                                                00987000
GTFEIDL  EQU   GTFPCT+52                                                00988000
GTFPIBL  EQU   GTFPCT+48                                                00989000
GTFPIFT  EQU   GTFPCT+44                                                00990000
GTFSVCBL EQU   GTFPCT+40                                                00991000
GTFSVCFT EQU   GTFPCT+36                                                00992000
GTFIOBL  EQU   GTFPCT+32                                                00993000
GTFIOFT  EQU   GTFPCT+28                                                00994000
GTFSIOBL EQU   GTFPCT+24                                                00995000
GTFSIOFT EQU   GTFPCT+20                                                00996000
@NM00002 EQU   PCTCATF+1                                                00997000
PCTPIF   EQU   PCTCATF+1                                                00998000
PCTSIOF  EQU   PCTCATF+1                                                00999000
PCTIOF   EQU   PCTCATF+1                                                01000000
PCTSVCF  EQU   PCTCATF+1                                                01001000
PCTRR    EQU   PCTCATF+1                                                01002000
PCTSRM   EQU   PCTCATF+1                                                01003000
PCTRNIO  EQU   PCTCATF+1                                                01004000
PCTUSR   EQU   PCTCATF                                                  01005000
PCTPI    EQU   PCTCATF                                                  01006000
@NM00001 EQU   PCTCATF                                                  01007000
PCTDSP   EQU   PCTCATF                                                  01008000
PCTSIO   EQU   PCTCATF                                                  01009000
PCTIO    EQU   PCTCATF                                                  01010000
PCTEXT   EQU   PCTCATF                                                  01011000
PCTSVC   EQU   PCTCATF                                                  01012000
OPTTIME  EQU   GTFOPTS4                                                 01013000
OPTRES3  EQU   GTFOPTS4                                                 01014000
OPTIOSIO EQU   GTFOPTS3                                                 01015000
OPTRES2  EQU   GTFOPTS3                                                 01016000
OPTRR    EQU   GTFOPTS3                                                 01017000
OPTSRM   EQU   GTFOPTS3                                                 01018000
OPTRNIO  EQU   GTFOPTS3                                                 01019000
OPTEXT   EQU   GTFOPTS3                                                 01020000
OPTIOP   EQU   GTFOPTS2                                                 01021000
OPTIO    EQU   GTFOPTS2                                                 01022000
OPTPIP   EQU   GTFOPTS2                                                 01023000
OPTPI    EQU   GTFOPTS2                                                 01024000
OPTSIOP  EQU   GTFOPTS2                                                 01025000
OPTSIO   EQU   GTFOPTS2                                                 01026000
OPTSVCP  EQU   GTFOPTS2                                                 01027000
OPTSVC   EQU   GTFOPTS2                                                 01028000
OPTPCI   EQU   GTFOPTS1                                                 01029000
OPTRES1  EQU   GTFOPTS1                                                 01030000
OPTDSP   EQU   GTFOPTS1                                                 01031000
OPTTRC   EQU   GTFOPTS1                                                 01032000
OPTUSR   EQU   GTFOPTS1                                                 01033000
OPTSYS   EQU   GTFOPTS1                                                 01034000
OPTSYSP  EQU   GTFOPTS1                                                 01035000
OPTSYSM  EQU   GTFOPTS1                                                 01036000
GTFRESV  EQU   GTFSTAT                                                  01037000
GTFDEBUG EQU   GTFSTAT                                                  01038000
GTFMODE  EQU   GTFSTAT                                                  01039000
GTFPCTID EQU   GTFPCT                                                   01040000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01041000
@RT00049 EQU   T10302                                                   01042000
@RT00056 EQU   T10304                                                   01043000
@RT00064 EQU   T10316                                                   01044000
@RT00067 EQU   T10315                                                   01045000
@RT00069 EQU   T10307                                                   01046000
@RT00074 EQU   T10311                                                   01047000
@RT00080 EQU   T10309                                                   01048000
@RT00085 EQU   T10309                                                   01049000
@RT00091 EQU   T10311                                                   01050000
@RT00096 EQU   T10311                                                   01051000
@RT00102 EQU   T10313                                                   01052000
@RT00107 EQU   T10313                                                   01053000
@RT00113 EQU   T10315                                                   01054000
@RT00118 EQU   T10315                                                   01055000
@RT00141 EQU   T10319                                                   01056000
@RT00150 EQU   T10320                                                   01057000
@ENDDATA EQU   *                                                        01058000
         END   AHLT103,(C'PL/S-II',0502,73240)                          01059000
