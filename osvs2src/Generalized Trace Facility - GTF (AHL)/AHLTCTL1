         TITLE 'AHLTCTL1- GTF INITIALIZATION CONTROL MODULE FOR TRACE O*00001000
               OPTION   '                                               00002000
AHLTCTL1 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'AHLTCTL1  76.167'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         ST    @13,@SA00001+4                                      0001 00014000
         LA    @14,@SA00001                                        0001 00015000
         ST    @14,8(,@13)                                         0001 00016000
         LR    @13,@14                                             0001 00017000
*                                                                  0073 00018000
*/********************************************************************/ 00019000
*/*                                                                  */ 00020000
*/*                BEGIN INITIALIZER SCAN CONTROL ROUTINE            */ 00021000
*/*                                                                  */ 00022000
*/********************************************************************/ 00023000
*/********************************************************************/ 00024000
*/*                                                                  */ 00025000
*/*           INITIALIZE INITDATA                                    */ 00026000
*/*                                                                  */ 00027000
*/********************************************************************/ 00028000
*                                                                  0073 00029000
*   PARMDCB=ADDR(DCBFORM);          /* @ PARMLIB DCB INITDATA  Y02014*/ 00030000
         L     @14,INITPTR(,PCTPTR)                                0073 00031000
         LA    @06,DCBFORM                                         0073 00032000
         ST    @06,PARMDCB(,@14)                                   0073 00033000
*   ICTFLAGS=ZEROWD(1:2);           /* CLEAR FLAG BYTES        Y02014*/ 00034000
         MVC   ICTFLAGS(2,@14),ZEROWD                              0074 00035000
*/********************************************************************/ 00036000
*/*                                                                  */ 00037000
*/*                       INITIALIZE ECB LIST                        */ 00038000
*/*                                                                  */ 00039000
*/********************************************************************/ 00040000
*                                                                  0075 00041000
*   WECBAD=ADDR(WTORECB);           /* @ WTOR ECB TO ECB LST   Y02014*/ 00042000
         LA    @00,WTORECB(,@14)                                   0075 00043000
         ST    @00,WECBAD                                          0075 00044000
*   SECBAD=STOPECBA;                /* @ STOP ECB TO ECB LST   Y02014*/ 00045000
         L     @00,STOPECBA(,PCTPTR)                               0076 00046000
         ST    @00,SECBAD                                          0076 00047000
*   ENDECB='1'B;                    /* SET END OF LIST IND           */ 00048000
         OI    ENDECB,B'10000000'                                  0077 00049000
*                                                                  0078 00050000
*/********************************************************************/ 00051000
*/*                                                                  */ 00052000
*/*                  INITIALIZE FOR PARMLIB RDJFCB                   */ 00053000
*/*                                                                  */ 00054000
*/********************************************************************/ 00055000
*                                                                  0078 00056000
*   TWT=TWT&&TWT;                   /* CLEAR TEMP WORK               */ 00057000
         XC    TWT(192,@14),TWT(@14)                               0078 00058000
*   DCBPTR=ADDR(DCBFORM);           /* SET BASE FOR DCB              */ 00059000
         LR    DCBPTR,@06                                          0079 00060000
*   EXPLAD=ADDR(TWT)+4;             /* SET EXIT LIST FOR JFCB        */ 00061000
         LA    EXPLAD,TWT(,@14)                                    0080 00062000
         AL    EXPLAD,@CF00060                                     0080 00063000
*   TWT(1:4)=EXPLAD;                /* SET @INPUT AREA               */ 00064000
         STCM  EXPLAD,15,TWT(@14)                                  0081 00065000
*   TWT(1)='07'X;                   /* JFCB ENTRY                    */ 00066000
         MVI   TWT(@14),X'07'                                      0082 00067000
*   DCBEXLST=ADDR(TWT);             /* SET @EXIT LIST                */ 00068000
         LA    @14,TWT(,@14)                                       0083 00069000
         STCM  @14,7,DCBEXLST(DCBPTR)                              0083 00070000
*   GENERATE;                                                      0084 00071000
*                                                                  0084 00072000
*                                   /* RDJFCB FOR PARMLIB            */ 00073000
           RDJFCB  ((DCBPTR))                                           00074000
*/********************************************************************/ 00075000
*/*                                                                  */ 00076000
*/*                    TEST FOR SUCCESSFUL RDJFCB                    */ 00077000
*/*                                                                  */ 00078000
*/********************************************************************/ 00079000
*                                                                  0085 00080000
*   IF TWT(5:8)=ZEROWD              /* TEST IF JFCB READ             */ 00081000
*     THEN                          /* JFCB NOT READ                 */ 00082000
         L     @14,INITPTR(,PCTPTR)                                0085 00083000
         CLC   TWT+4(4,@14),ZEROWD                                 0085 00084000
         BE    @RT00085                                            0085 00085000
*     GO TO CTL03;                  /* TO AHLTSCN-CONSOL INPT        */ 00086000
*/********************************************************************/ 00087000
*/*                                                                  */ 00088000
*/*            RDJFCB SUCCESSFUL-TEST FOR CORRECT DS NAME            */ 00089000
*/*                                                                  */ 00090000
*/********************************************************************/ 00091000
*                                                                  0087 00092000
*   IF JFCBDSNM(1:12)^=PLIBNM       /* TEST FOR CORRECT DSNAME Y02014*/ 00093000
*     THEN                          /* NOT CORRECT DSNAME            */ 00094000
         CLC   JFCBDSNM(12,@14),PLIBNM                             0087 00095000
         BNE   @RT00087                                            0087 00096000
*     GO TO CTL03;                  /* TO AHLTSCN-CONSOL INPT        */ 00097000
*/********************************************************************/ 00098000
*/*                                                                  */ 00099000
*/*                 ISSUE MESSAGE FOR PARMLIB INPUT                  */ 00100000
*/*                                                                  */ 00101000
*/********************************************************************/ 00102000
*                                                                  0089 00103000
*   ELSAV=JFCBELNM;                 /* SAVE MEMBER NAME              */ 00104000
         MVC   ELSAV(8,@14),JFCBELNM(@14)                          0089 00105000
*   ICTIOTYP=2;                     /* SET IND FOR WTO MESSAGE Y02014*/ 00106000
         MVI   ICTIOTYP(@14),X'02'                                 0090 00107000
*   ICTMSGX=19;                     /* SET NDX FOR AHL121I           */ 00108000
         MVI   ICTMSGX(@14),X'13'                                  0091 00109000
*   CALL AHLTIO;                    /* ISSUE MSG                     */ 00110000
         BAL   @14,AHLTIO                                          0092 00111000
*   JFCBELNM=ELSAV;                 /* RESTORE MEMBER NAME           */ 00112000
         L     @14,INITPTR(,PCTPTR)                                0093 00113000
         MVC   JFCBELNM(8,@14),ELSAV(@14)                          0093 00114000
*/********************************************************************/ 00115000
*/*                                                                  */ 00116000
*/*                     TEST FOR NO MEMBER NAME                      */ 00117000
*/*                                                                  */ 00118000
*/********************************************************************/ 00119000
*                                                                  0094 00120000
*   IF JFCBELNM^=BLANK              /* TEST FOR MEMBER NAME          */ 00121000
*     THEN                          /* MEMBER NAME IN JFCB           */ 00122000
         CLC   JFCBELNM(8,@14),BLANK                               0094 00123000
         BNE   @RT00094                                            0094 00124000
*     GO TO CTL02;                  /* ISSUE STAE FOR OPEN           */ 00125000
*   ICTMSGX=20;                     /* SET INDX FOR AHL122I          */ 00126000
         MVI   ICTMSGX(@14),X'14'                                  0096 00127000
*                                                                  0097 00128000
*/********************************************************************/ 00129000
*/*                                                                  */ 00130000
*/*                       ISSUE ERROR MESSAGE                        */ 00131000
*/*                                                                  */ 00132000
*/********************************************************************/ 00133000
*                                                                  0097 00134000
*CTL01:                                                            0097 00135000
*   ICTIOTYP=2;                     /* SET TYPE FOR WTO              */ 00136000
CTL01    L     @14,INITPTR(,PCTPTR)                                0097 00137000
         MVI   ICTIOTYP(@14),X'02'                                 0097 00138000
*   CALL AHLTIO;                    /* ISSUE MSG                     */ 00139000
         BAL   @14,AHLTIO                                          0098 00140000
*   GO TO CTL03;                    /* TO AHLTSCN FOR TRC OPS        */ 00141000
         B     CTL03                                               0099 00142000
*                                                                  0100 00143000
*/********************************************************************/ 00144000
*/*                                                                  */ 00145000
*/*                   ISSUE STAE AND OPEN PARMLIB                    */ 00146000
*/*                                                                  */ 00147000
*/********************************************************************/ 00148000
*                                                                  0100 00149000
*CTL02:                                                            0100 00150000
*   RFY                                                            0100 00151000
*     SAVREG RSTD;                  /*                         Y02014*/ 00152000
CTL02    DS    0H                                                  0101 00153000
*   SAVREG=ADDR(SVAREA);            /* SET R8 = @SAVE AREA           */ 00154000
         LA    SAVREG,SVAREA                                       0101 00155000
*   RTRYAD=ADDR(CTLRETRY);          /* SET R15 = @ RETRY ROUT        */ 00156000
         LA    RTRYAD,CTLRETRY                                     0102 00157000
*   EXPLAD=ADDR(TWTWORK);           /* SET STAE PLIST BASE           */ 00158000
         L     EXPLAD,INITPTR(,PCTPTR)                             0103 00159000
         LA    EXPLAD,TWTWORK(,EXPLAD)                             0103 00160000
*   EXPLAD1=EXPLAD;                 /* SAVE REGISTER VALUE     Y02014*/ 00161000
         ST    EXPLAD,EXPLAD1                                      0104 00162000
*   GEN(STM R0,R15,8(SAVREG));      /* SAVE REGS                     */ 00163000
         STM R0,R15,8(SAVREG)                                           00164000
*   RTRYCODE=RETRYCOD;              /* MOVE RETRY CODE TO SAVE AREA  */ 00165000
         MVC   RTRYCODE(6),RETRYCOD                                0106 00166000
*   SAVARAD=SAVREG;                 /* @SAVE AREA TO PLIST           */ 00167000
         ST    SAVREG,SAVARAD(,EXPLAD)                             0107 00168000
*   STAEPLST=STAELST2;              /* PLACE STAE LIST INTO GOTTEN 0108 00169000
*                                      CORE                          */ 00170000
         MVC   STAEPLST(8),STAELST2                                0108 00171000
*   PARMRG1=ADDR(STAEPLST);         /* SET R1 = @ STAE PLIST   Y02014*/ 00172000
         LA    PARMRG1,STAEPLST                                    0109 00173000
*   GENERATE;                                                      0110 00174000
*                                   /* ISSUE STAE                    */ 00175000
           STAE  PARAM=(EXPLAD),MF=(E,(1))                              00176000
*   DCBPTR=ADDR(DCBFORM);           /* GET DCB ADDR FOR OPEN         */ 00177000
         LA    DCBPTR,DCBFORM                                      0111 00178000
*   OPENPLST=OPENLST2;              /* PLACE OPEN PARMLIST INTO    0112 00179000
*                                      GOTTEN CORE                   */ 00180000
         MVC   OPENPLST(4),OPENLST2                                0112 00181000
*   PARMRG1=ADDR(OPENPLST);         /* SET R1 = @ PLIST        Y02014*/ 00182000
         LA    PARMRG1,OPENPLST                                    0113 00183000
*   GENERATE;                                                      0114 00184000
*                                   /* OPEN PARMLIB DATA SET         */ 00185000
           OPEN  ((DCBPTR)),MF=(E,(1))         OPEN PARMLIB             00186000
           STAE  0                             CANCEL STAE              00187000
*   RFY                                                            0115 00188000
*     SAVREG UNRSTD;                                               0115 00189000
*   ICTPLIB='1'B;                   /* TURN ON PARMLIB IND IN ICT    */ 00190000
         L     @14,INITPTR(,PCTPTR)                                0116 00191000
         OI    ICTPLIB(@14),B'10000000'                            0116 00192000
*                                                                  0117 00193000
*/********************************************************************/ 00194000
*/*                                                                  */ 00195000
*/*                      PROCESS TRACE OPTIONS                       */ 00196000
*/*                                                                  */ 00197000
*/********************************************************************/ 00198000
*                                                                  0117 00199000
*CTL03:                                                            0117 00200000
*                                                                  0117 00201000
*/********************************************************************/ 00202000
*/*                                                                  */ 00203000
*/*    PASS CONTROL TO INITIALIZER SCAN/ANALYSIS ROUTINE - AHLTSCN   */ 00204000
*/*                                                                  */ 00205000
*/********************************************************************/ 00206000
*                                                                  0117 00207000
*   CALL AHLTSCN;                   /* GO TO AHLTSCN TO REQUEST AND     00208000
*                                      ANALYZE OPTIONS         Y02014*/ 00209000
CTL03    L     @15,@CV00389                                        0117 00210000
         BALR  @14,@15                                             0117 00211000
*/********************************************************************/ 00212000
*/*                                                                  */ 00213000
*/*                  TEST RETURN CODE FROM AHLTSCN                   */ 00214000
*/*                                                                  */ 00215000
*/********************************************************************/ 00216000
*                                                                  0118 00217000
*   IF RTRNCODE^=0                  /* TEST FOR ERROR IN SCN         */ 00218000
*     THEN                          /* ERROR IN AHLTSCN              */ 00219000
         SLR   @14,@14                                             0118 00220000
         CR    RTRNCODE,@14                                        0118 00221000
         BNE   @RT00118                                            0118 00222000
*     GO TO CTL06;                  /* END GTF                       */ 00223000
*/********************************************************************/ 00224000
*/*                                                                  */ 00225000
*/*                      TEST FOR ERROR IN SCAN                      */ 00226000
*/*             AND RETRY OF TRACE OPTION SPECIFICATION              */ 00227000
*/*                                                                  */ 00228000
*/********************************************************************/ 00229000
*                                                                  0120 00230000
*   IF ICTRETRY='1'B                /* TEST FOR RETRY                */ 00231000
*     THEN                          /* ERROR - RETRY                 */ 00232000
         L     @06,INITPTR(,PCTPTR)                                0120 00233000
         TM    ICTRETRY(@06),B'00010000'                           0120 00234000
         BO    @RT00120                                            0120 00235000
*     GO TO CTL07;                  /* REINITIALIZE TBLS             */ 00236000
*/********************************************************************/ 00237000
*/*                                                                  */ 00238000
*/*                         TEST FOR PROMPTING                       */ 00239000
*/*                                                                  */ 00240000
*/********************************************************************/ 00241000
*                                                                  0122 00242000
*   IF GTFSYSP='0'B                 /* TEST FOR PROMPTING      Y02014*/ 00243000
*       &(GTFOPT2&'55'X)=0 THEN     /* NO PROMPTING            Y02014*/ 00244000
         TM    GTFSYSP(@06),B'01000000'                            0122 00245000
         BNZ   @RF00122                                            0122 00246000
         LA    @00,85                                              0122 00247000
         SLR   @11,@11                                             0122 00248000
         IC    @11,GTFOPT2(,@06)                                   0122 00249000
         NR    @00,@11                                             0122 00250000
         CR    @00,@14                                             0122 00251000
         BE    @RT00122                                            0122 00252000
*     GO TO CTL04;                  /* GOTO AHLT103                  */ 00253000
*                                                                  0124 00254000
*/********************************************************************/ 00255000
*/*                                                                  */ 00256000
*/*         PASS CONTROL TO INITIALIZER PROMPT ROUTINE - AHLTPMT     */ 00257000
*/*                                                                  */ 00258000
*/********************************************************************/ 00259000
*                                                                  0124 00260000
*   CALL AHLTPMT;                   /* TO AHLTPMT TO PROMPT FOR    0124 00261000
*                                      OPTIONS                 Y02014*/ 00262000
@RF00122 L     @15,@CV00388                                        0124 00263000
         BALR  @14,@15                                             0124 00264000
*/********************************************************************/ 00265000
*/*                                                                  */ 00266000
*/*                  TEST RETURN CODE FROM AHLTPMT                   */ 00267000
*/*                                                                  */ 00268000
*/********************************************************************/ 00269000
*                                                                  0125 00270000
*   IF RTRNCODE^=0                  /* TEST FOR ERROR IN PMT         */ 00271000
*     THEN                          /* ERROR IN AHLTPMT              */ 00272000
         LTR   RTRNCODE,RTRNCODE                                   0125 00273000
         BNZ   @RT00125                                            0125 00274000
*     GO TO CTL06;                  /* END GTF                       */ 00275000
*/********************************************************************/ 00276000
*/*                                                                  */ 00277000
*/*                      TEST FOR ERROR IN SCAN                      */ 00278000
*/*             AND RETRY OF TRACE OPTION SPECIFICATION              */ 00279000
*/*                                                                  */ 00280000
*/********************************************************************/ 00281000
*                                                                  0127 00282000
*   IF ICTRETRY='1'B THEN                                          0127 00283000
         L     @14,INITPTR(,PCTPTR)                                0127 00284000
         TM    ICTRETRY(@14),B'00010000'                           0127 00285000
         BO    @RT00127                                            0127 00286000
*     GO TO CTL07;                                                 0128 00287000
*                                                                  0129 00288000
*/********************************************************************/ 00289000
*/*                                                                  */ 00290000
*/*       INITIALIZE GTF OPTION WORD                           Y02014*/ 00291000
*/*                                                                  */ 00292000
*/********************************************************************/ 00293000
*                                                                  0129 00294000
*CTL04:                                                            0129 00295000
*   GTFOPTS(1:3)=ZEROWD(1:3);       /* INITIALIZE TO ZERO      Y02014*/ 00296000
CTL04    MVC   GTFOPTS(3,PCTPTR),ZEROWD                            0129 00297000
*   GTFOPTS(1:3)=GTFOPTS|GTFOPIND;  /* SET TO INDICATE OPTS    Y02014*/ 00298000
         L     @14,INITPTR(,PCTPTR)                                0130 00299000
         MVC   @TS00001(3),GTFOPTS(PCTPTR)                         0130 00300000
         OC    @TS00001(3),GTFOPIND(@14)                           0130 00301000
         MVC   GTFOPTS(3,PCTPTR),@TS00001                          0130 00302000
*                                                                  0131 00303000
*/********************************************************************/ 00304000
*/*                                                                  */ 00305000
*/*         PASS CONTROL TO AHLT103 TO BUILD MESSAGE AHL103I         */ 00306000
*/*                                                                  */ 00307000
*/********************************************************************/ 00308000
*                                                                  0131 00309000
*   CALL AHLT103;                   /* TO AHLT103 TO BUILD AND ISSUE    00310000
*                                      MESSAGE AHLT103I        Y02014*/ 00311000
         L     @15,@CV00391                                        0131 00312000
         BALR  @14,@15                                             0131 00313000
*                                                                  0132 00314000
*/********************************************************************/ 00315000
*/*                                                                  */ 00316000
*/*                  ISSUE MESSAGE AHL125A TO CHECK                  */ 00317000
*/*                 FOR TRACE OPTION RESPECIFICATION                 */ 00318000
*/*                                                                  */ 00319000
*/********************************************************************/ 00320000
*                                                                  0132 00321000
*CTL04A:                                                           0132 00322000
*   ICTMSGX=23;                     /* SET NDX FOR AHL125A           */ 00323000
CTL04A   L     @14,INITPTR(,PCTPTR)                                0132 00324000
         MVI   ICTMSGX(@14),X'17'                                  0132 00325000
*   ICTIOTYP=1;                     /* SET IO TYPE FOR WTOR          */ 00326000
         MVI   ICTIOTYP(@14),X'01'                                 0133 00327000
*   CALL AHLTIO;                    /* ISSUE AHL125A                 */ 00328000
         BAL   @14,AHLTIO                                          0134 00329000
*/********************************************************************/ 00330000
*/*                                                                  */ 00331000
*/*                     TEST FOR STOP ECB POSTED                     */ 00332000
*/*                                                                  */ 00333000
*/********************************************************************/ 00334000
*                                                                  0135 00335000
*   IF ICTSTOP='1'B                 /* TEST FOR STOP ECB POST        */ 00336000
*     THEN                          /* STOP ECB POSTED               */ 00337000
         L     @14,INITPTR(,PCTPTR)                                0135 00338000
         TM    ICTSTOP(@14),B'00000100'                            0135 00339000
         BNO   @RF00135                                            0135 00340000
*     DO;                                                          0136 00341000
*       RTRNCODE=12;                /* SET RTRN CODE TO STOP         */ 00342000
         LA    RTRNCODE,12                                         0137 00343000
*       GO TO CTL06;                /* RETURN                        */ 00344000
         B     CTL06                                               0138 00345000
*     END;                                                         0139 00346000
*                                                                  0139 00347000
*/********************************************************************/ 00348000
*/*                                                                  */ 00349000
*/*             LOOP TO ANALYZE REPLY TO MESSAGE AHL125A             */ 00350000
*/*                                                                  */ 00351000
*/********************************************************************/ 00352000
*                                                                  0140 00353000
*   DO MSGPTRVR=1 TO 124            /* ANALYZE REPLY                 */ 00354000
*         BY 1;                                                    0140 00355000
*                                                                  0140 00356000
@RF00135 LA    MSGPTRVR,1                                          0140 00357000
@DL00140 DS    0H                                                  0141 00358000
*/********************************************************************/ 00359000
*/*                                                                  */ 00360000
*/*                   ANALYZE REPLY                                  */ 00361000
*/*                                                                  */ 00362000
*/********************************************************************/ 00363000
*                                                                  0141 00364000
*     IF MSGREPLY(MSGPTRVR)         /* TEST FOR NON-BLANK      Y02014*/ 00365000
*         ^=BLANK(1) THEN           /* NON-BLANK FOUND               */ 00366000
         L     @14,INITPTR(,PCTPTR)                                0141 00367000
         LR    @11,@14                                             0141 00368000
         ALR   @11,MSGPTRVR                                        0141 00369000
         CLC   MSGREPLY-1(1,@11),BLANK                             0141 00370000
         BE    @RF00141                                            0141 00371000
*       DO;                         /* TEST FOR VALID REPLY          */ 00372000
*/********************************************************************/ 00373000
*/*                                                                  */ 00374000
*/*                   TEST FOR NO RESPECIFICATION                    */ 00375000
*/*                                                                  */ 00376000
*/********************************************************************/ 00377000
*                                                                  0143 00378000
*         IF MSGREPLY(MSGPTRVR)     /* TEST FOR U              Y02014*/ 00379000
*             ='U' THEN             /* U SPECIFIED                   */ 00380000
         LR    @11,@14                                             0143 00381000
         ALR   @11,MSGPTRVR                                        0143 00382000
         CLI   MSGREPLY-1(@11),C'U'                                0143 00383000
         BE    @RT00143                                            0143 00384000
*           GO TO CTL04B;           /* CONTINUE                      */ 00385000
*/********************************************************************/ 00386000
*/*                                                                  */ 00387000
*/*                     TEST FOR RESPECIFICATION                     */ 00388000
*/*                                                                  */ 00389000
*/********************************************************************/ 00390000
*                                                                  0145 00391000
*         IF MSGREPLY(MSGPTRVR:MSGPTRVR+5)^=TRCEQ/*            Y02014*/ 00392000
*           THEN                                                   0145 00393000
         LR    @11,@14                                             0145 00394000
         ALR   @11,MSGPTRVR                                        0145 00395000
         CLC   MSGREPLY-1(6,@11),TRCEQ                             0145 00396000
         BE    @RF00145                                            0145 00397000
*           DO;                     /* NOT TRACE=              Y02014*/ 00398000
*             ICTMSGX=32;           /* ISSUE AHL136I           Y02014*/ 00399000
         MVI   ICTMSGX(@14),X'20'                                  0147 00400000
*             ICTIOTYP=2;           /* MESSAGE IS WTO          Y02014*/ 00401000
         MVI   ICTIOTYP(@14),X'02'                                 0148 00402000
*             CALL AHLTIO;          /* GO ISSUE MESSAGE        Y02014*/ 00403000
         BAL   @14,AHLTIO                                          0149 00404000
*             GO TO CTL04A;         /* REISSUE AHL125A               */ 00405000
         B     CTL04A                                              0150 00406000
*           END;                                                   0151 00407000
*         ICTTRCIN='1'B;            /* SET IND-OPS IN BUFFER         */ 00408000
@RF00145 L     @14,INITPTR(,PCTPTR)                                0152 00409000
         OI    ICTTRCIN(@14),B'00001000'                           0152 00410000
*         GO TO CTL07;              /* RESTART                       */ 00411000
         B     CTL07                                               0153 00412000
*       END;                                                       0154 00413000
*   END;                                                           0155 00414000
@RF00141 AL    MSGPTRVR,@CF00055                                   0155 00415000
         C     MSGPTRVR,@CF00244                                   0155 00416000
         BNH   @DL00140                                            0155 00417000
*   ICTMSGX=32;                     /* ISSUE MSG AHL136I       Y02014*/ 00418000
         L     @14,INITPTR(,PCTPTR)                                0156 00419000
         MVI   ICTMSGX(@14),X'20'                                  0156 00420000
*   ICTIOTYP=2;                     /* MESSAGE IS WTO          Y02014*/ 00421000
         MVI   ICTIOTYP(@14),X'02'                                 0157 00422000
*   CALL AHLTIO;                    /* GO ISSUE MESSAGE        Y02014*/ 00423000
         BAL   @14,AHLTIO                                          0158 00424000
*   GO TO CTL04A;                   /* REISSUE AHL125A-NO RPLY       */ 00425000
         B     CTL04A                                              0159 00426000
*                                                                  0160 00427000
*/********************************************************************/ 00428000
*/*                                                                  */ 00429000
*/*                         TEST FOR PROMPTING                       */ 00430000
*/*                                                                  */ 00431000
*/********************************************************************/ 00432000
*                                                                  0160 00433000
*CTL04B:                                                           0160 00434000
*   IF GTFSYSP='0'B                 /* TEST FOR PROMPTING      Y02014*/ 00435000
*       &(GTFOPT2&'55'X)=0 THEN     /* NO PROMPTING            Y02014*/ 00436000
CTL04B   L     @14,INITPTR(,PCTPTR)                                0160 00437000
         TM    GTFSYSP(@14),B'01000000'                            0160 00438000
         BNZ   @RF00160                                            0160 00439000
         LA    @06,85                                              0160 00440000
         SLR   @00,@00                                             0160 00441000
         IC    @00,GTFOPT2(,@14)                                   0160 00442000
         NR    @06,@00                                             0160 00443000
         LTR   @06,@06                                             0160 00444000
         BZ    @RT00160                                            0160 00445000
*     GO TO CTL05B;                 /* EXIT                    Y02014*/ 00446000
*/********************************************************************/ 00447000
*/*                                                                  */ 00448000
*/*    PASS CONTROL TO INITIALIZER ROUTINE TO CONVERT FILTER TABLES  */ 00449000
*/*                     TO FINAL FORMAT - AHLTTAB                    */ 00450000
*/*                                                                  */ 00451000
*/********************************************************************/ 00452000
*                                                                  0162 00453000
*   CALL AHLTTAB;                   /* TO AHLTTAB TO BUILD FILTER  0162 00454000
*                                      TABLES                  Y02014*/ 00455000
@RF00160 L     @15,@CV00390                                        0162 00456000
         BALR  @14,@15                                             0162 00457000
*/********************************************************************/ 00458000
*/*                                                                  */ 00459000
*/*                TEST FOR RETURN CODE FROM AHLTTAB                 */ 00460000
*/*                                                                  */ 00461000
*/********************************************************************/ 00462000
*                                                                  0163 00463000
*   IF RTRNCODE^=0                  /* TEST FOR ERROR IN TAB         */ 00464000
*     THEN                          /* ERROR IN AHLTTAB              */ 00465000
         LTR   RTRNCODE,RTRNCODE                                   0163 00466000
         BNZ   @RT00163                                            0163 00467000
*     GO TO CTL06;                  /* END GTF                       */ 00468000
*/********************************************************************/ 00469000
*/*                                                                  */ 00470000
*/*              SET GTFOPIND FOR LOADING SCHEME               Y02014*/ 00471000
*/*                                                                  */ 00472000
*/********************************************************************/ 00473000
*                                                                  0165 00474000
*CTL05B:                                                           0165 00475000
*   IF(GTFSYSM='1'B                 /* WAS EITHER SYSM         Y02014*/ 00476000
*       |GTFSYS='1'B)               /* OR SYS SPECIFIED        Y02014*/ 00477000
*     THEN                          /* YES, SO SET IMPLIED OPTIONS 0165 00478000
*                                                              Y02014*/ 00479000
CTL05B   L     @14,INITPTR(,PCTPTR)                                0165 00480000
         TM    GTFSYSM(@14),B'10100000'                            0165 00481000
         BZ    @RF00165                                            0165 00482000
*     DO;                                                          0166 00483000
*       GTFSIO='1'B;                /* SET SIO                 Y02014*/ 00484000
*       GTFIO='1'B;                 /* SET IO                  Y02014*/ 00485000
*       GTFSVC='1'B;                /* SET SVC                 Y02014*/ 00486000
*       GTFPI='1'B;                 /* SET PI                  Y02014*/ 00487000
         OI    GTFSIO(@14),B'10101010'                             0170 00488000
*       GTFRR='1'B;                 /* SET RR                  Y02014*/ 00489000
*       GTFEXT='1'B;                /* SET EXT                 Y02014*/ 00490000
         OI    GTFRR(@14),B'10010000'                              0172 00491000
*     END;                                                         0173 00492000
*   IF GTFSYSP='1'B THEN            /* SYSP BIT ON             Y02014*/ 00493000
@RF00165 L     @14,INITPTR(,PCTPTR)                                0174 00494000
         TM    GTFSYSP(@14),B'01000000'                            0174 00495000
         BNO   @RF00174                                            0174 00496000
*     DO;                                                          0175 00497000
*       GTFRR='1'B;                 /* SET RR                  Y02014*/ 00498000
*       GTFEXT='1'B;                /* SET EXT                 Y02014*/ 00499000
         OI    GTFRR(@14),B'10010000'                              0177 00500000
*     END;                                                         0178 00501000
*                                                                  0179 00502000
*/********************************************************************/ 00503000
*/*                                                                  */ 00504000
*/*          CLOSE PARMLIB, IF OPEN, AND RETURN TO AHLSCAN           */ 00505000
*/*                                                                  */ 00506000
*/********************************************************************/ 00507000
*                                                                  0179 00508000
*CTL05:                                                            0179 00509000
*   IF(DCBOFLGS&'10'X)=0            /* TEST FOR OPEN PARMLIB         */ 00510000
*     THEN                          /* PARMLIB NOT OPEN              */ 00511000
@RF00174 DS    0H                                                  0179 00512000
CTL05    LA    @14,16                                              0179 00513000
         SLR   @06,@06                                             0179 00514000
         IC    @06,DCBOFLGS(,DCBPTR)                               0179 00515000
         NR    @14,@06                                             0179 00516000
         LTR   @14,@14                                             0179 00517000
         BZ    @RT00179                                            0179 00518000
*     GO TO CTL05A;                 /* EXIT                          */ 00519000
*   DCBPTR=ADDR(DCBFORM);           /* SET PTR TO DCB                */ 00520000
         LA    DCBPTR,DCBFORM                                      0181 00521000
*   CLOSPLST=CLOSLST2;              /* PLACE CLOSE PARMLIST INTO   0182 00522000
*                                      GOTTEN CORE                   */ 00523000
         MVC   CLOSPLST(4),CLOSLST2                                0182 00524000
*   PARMRG1=ADDR(CLOSPLST);         /* SET R1 = @CLOSE PLIST   Y02014*/ 00525000
         LA    PARMRG1,CLOSPLST                                    0183 00526000
*/********************************************************************/ 00527000
*/*                                                                  */ 00528000
*/*                          CLOSE PARMLIB                           */ 00529000
*/*                                                                  */ 00530000
*/********************************************************************/ 00531000
*                                                                  0184 00532000
*   GENERATE;                                                      0184 00533000
*                                   /* CLOSE PARMLIB DCB             */ 00534000
           CLOSE ((DCBPTR)),MF=(E,(1))                                  00535000
*CTL05A:                                                           0185 00536000
*   RTRNCODE=0;                     /* SET RC FOR AHLSCAN --       0185 00537000
*                                      SUCCESSFUL COMPLETION   Y02014*/ 00538000
CTL05A   SLR   RTRNCODE,RTRNCODE                                   0185 00539000
*CTL06:                                                            0186 00540000
*   GPRS15=RTRNCODE;                /* RETURN CODE TO R15 SAVE M1402 */ 00541000
CTL06    L     @14,CALLRSA1(,SAVR)                                 0186 00542000
         ST    RTRNCODE,GPRS15(,@14)                               0186 00543000
*   RETURN;                         /* RETURN TO AHLSCAN       Y02014*/ 00544000
@EL00001 L     @13,4(,@13)                                         0187 00545000
@EF00001 DS    0H                                                  0187 00546000
@ER00001 LM    @14,@12,12(@13)                                     0187 00547000
         BR    @14                                                 0187 00548000
*                                                                  0188 00549000
*/********************************************************************/ 00550000
*/*                                                                  */ 00551000
*/*              RESET FOR TRACE OPTION RESPECIFICATION              */ 00552000
*/*                                                                  */ 00553000
*/********************************************************************/ 00554000
*                                                                  0188 00555000
*CTL07:                                                            0188 00556000
*   DCBPTR=ADDR(DCBFORM);           /* SET PTR TO DCB                */ 00557000
CTL07    LA    DCBPTR,DCBFORM                                      0188 00558000
*/********************************************************************/ 00559000
*/*                                                                  */ 00560000
*/*                      TEST FOR PARMLIB OPEN                       */ 00561000
*/*                                                                  */ 00562000
*/********************************************************************/ 00563000
*                                                                  0189 00564000
*   IF(DCBOFLGS&'10'X)=0            /* TEST FOR OPEN PARMLIB         */ 00565000
*     THEN                          /* PARMLIB NOT OPEN              */ 00566000
         LA    @14,16                                              0189 00567000
         SLR   @06,@06                                             0189 00568000
         IC    @06,DCBOFLGS(,DCBPTR)                               0189 00569000
         NR    @14,@06                                             0189 00570000
         LTR   @14,@14                                             0189 00571000
         BZ    @RT00189                                            0189 00572000
*     GO TO CTL08;                  /* RESET ICTFLG1                 */ 00573000
*   CLOSPLST=CLOSLST2;              /* PLACE CLOSE PARMLIST INTO   0191 00574000
*                                      GOTTEN CORE                   */ 00575000
         MVC   CLOSPLST(4),CLOSLST2                                0191 00576000
*   PARMRG1=ADDR(CLOSPLST);         /* SET R1 = @CLOSE PLIST   Y02014*/ 00577000
         LA    PARMRG1,CLOSPLST                                    0192 00578000
*/********************************************************************/ 00579000
*/*                                                                  */ 00580000
*/*                          CLOSE PARMLIB                           */ 00581000
*/*                                                                  */ 00582000
*/********************************************************************/ 00583000
*                                                                  0193 00584000
*   GENERATE;                                                      0193 00585000
*                                   /* CLOSE PARMLIB DCB             */ 00586000
           CLOSE ((DCBPTR)),MF=(E,(1))                                  00587000
*CTL08:                                                            0194 00588000
*   ICTFLAGS=ICTFLAGS&'0800'X;      /* TURN OFF ALL ICTFLGS EXCEPT 0194 00589000
*                                      ICTTRCIN                Y02014*/ 00590000
CTL08    L     @14,INITPTR(,PCTPTR)                                0194 00591000
         LA    @06,2048                                            0194 00592000
         LH    @00,ICTFLAGS(,@14)                                  0194 00593000
         N     @00,@CF00533                                        0194 00594000
         NR    @06,@00                                             0194 00595000
         STH   @06,ICTFLAGS(,@14)                                  0194 00596000
*/********************************************************************/ 00597000
*/*                                                                  */ 00598000
*/*                    TEST FOR SIO EBCDIC TABLE                     */ 00599000
*/*                                                                  */ 00600000
*/********************************************************************/ 00601000
*                                                                  0195 00602000
*   IF SIOTAB=0                     /* TEST FOR SIO TABLE      Y02014*/ 00603000
*     THEN                          /* NO SIO TABLE                  */ 00604000
         L     @06,SIOTAB(,@14)                                    0195 00605000
         LTR   @06,@06                                             0195 00606000
         BZ    @RT00195                                            0195 00607000
*     GO TO CTL10;                  /* TEST FOR IO TABLE             */ 00608000
*/********************************************************************/ 00609000
*/*                                                                  */ 00610000
*/*              TEST FOR SIO AND IO EBCDIC TABLES SAME              */ 00611000
*/*                                                                  */ 00612000
*/********************************************************************/ 00613000
*                                                                  0197 00614000
*   IF SIOTAB=IOTAB                 /* TEST FOR SAME TBL       Y02014*/ 00615000
*     THEN                          /* SAME TBLS                     */ 00616000
         C     @06,IOTAB(,@14)                                     0197 00617000
         BE    @RT00197                                            0197 00618000
*     GO TO CTL09;                  /* FREE IO EBCDIC TBL      Y02014*/ 00619000
*   FREEAD=SIOTAB;                  /* GET TBL ADDR            Y02014*/ 00620000
         LR    FREEAD,@06                                          0199 00621000
*/********************************************************************/ 00622000
*/*                                                                  */ 00623000
*/*                    FREE SIO EBCDIC TABLE CORE              Y02014*/ 00624000
*/*                                                                  */ 00625000
*/********************************************************************/ 00626000
*                                                                  0200 00627000
*   DO;                             /* FREEMAIN(R) LV(153)A(FREETB)  */ 00628000
*     RESPECIFY                                                    0201 00629000
*      (GPR01F,                                                    0201 00630000
*       GPR00F) RESTRICTED;                                        0201 00631000
*     GPR00F=153;                   /* LENGTH REQUESTED              */ 00632000
         LA    GPR00F,153                                          0202 00633000
*     GPR01F=ADDR(FREETB);          /* SET REGISTER ONE              */ 00634000
         LR    GPR01F,FREEAD                                       0203 00635000
*     SVC(10);                      /* R-FORM OF GETMAIN             */ 00636000
         SVC   10                                                  0204 00637000
*     RESPECIFY                                                    0205 00638000
*      (GPR01F,                                                    0205 00639000
*       GPR00F) UNRESTRICTED;                                      0205 00640000
*   END;                            /* FREEMAIN(R) LV(153)A(FREETB)     00641000
*                                      FREE SIO EBCDIC TBL Y02014    */ 00642000
*CTL09:                                                            0207 00643000
*   SIOTAB=0;                       /* CLEAR SIOTAB            Y02014*/ 00644000
CTL09    L     @14,INITPTR(,PCTPTR)                                0207 00645000
         SLR   @06,@06                                             0207 00646000
         ST    @06,SIOTAB(,@14)                                    0207 00647000
*/********************************************************************/ 00648000
*/*                                                                  */ 00649000
*/*                    TEST FOR I/O EBCIDC TABLE               Y02014*/ 00650000
*/*                                                                  */ 00651000
*/********************************************************************/ 00652000
*                                                                  0208 00653000
*CTL10:                                                            0208 00654000
*   IF IOTAB=0                      /* TEST FOR IO EBCDIC TBL  Y02014*/ 00655000
*     THEN                          /* NO IO TBL                     */ 00656000
CTL10    L     @14,INITPTR(,PCTPTR)                                0208 00657000
         L     @14,IOTAB(,@14)                                     0208 00658000
         LTR   @14,@14                                             0208 00659000
         BZ    @RT00208                                            0208 00660000
*     GO TO CTL11;                  /* TEST FOR PI TBL               */ 00661000
*   FREEAD=IOTAB;                   /* GET TABLE ADDRESS       Y02014*/ 00662000
         LR    FREEAD,@14                                          0210 00663000
*/********************************************************************/ 00664000
*/*                                                                  */ 00665000
*/*                    FREE I/O EBCDIC TABLE CORE              Y02014*/ 00666000
*/*                                                                  */ 00667000
*/********************************************************************/ 00668000
*                                                                  0211 00669000
*   DO;                             /* FREEMAIN(R) LV(153)A(FREETB)  */ 00670000
*     RESPECIFY                                                    0212 00671000
*      (GPR01F,                                                    0212 00672000
*       GPR00F) RESTRICTED;                                        0212 00673000
*     GPR00F=153;                   /* LENGTH REQUESTED              */ 00674000
         LA    GPR00F,153                                          0213 00675000
*     GPR01F=ADDR(FREETB);          /* SET REGISTER ONE              */ 00676000
         LR    GPR01F,FREEAD                                       0214 00677000
*     SVC(10);                      /* R-FORM OF GETMAIN             */ 00678000
         SVC   10                                                  0215 00679000
*     RESPECIFY                                                    0216 00680000
*      (GPR01F,                                                    0216 00681000
*       GPR00F) UNRESTRICTED;                                      0216 00682000
*   END;                            /* FREEMAIN(R) LV(153)A(FREETB)     00683000
*                                      FREE IO EBCDIC TBL Y02014     */ 00684000
*   IOTAB=0;                        /* CLEAR GTFIOFT           Y02014*/ 00685000
         L     @14,INITPTR(,PCTPTR)                                0218 00686000
         SLR   @06,@06                                             0218 00687000
         ST    @06,IOTAB(,@14)                                     0218 00688000
*/********************************************************************/ 00689000
*/*                                                                  */ 00690000
*/*                    TEST FOR PI EBCDIC TABLE                Y02014*/ 00691000
*/*                                                                  */ 00692000
*/********************************************************************/ 00693000
*                                                                  0219 00694000
*CTL11:                                                            0219 00695000
*   IF PITAB=0                      /* TEST FOR PI TBL         Y02014*/ 00696000
*     THEN                          /* NO PI EBCDIC TBL              */ 00697000
CTL11    L     @14,INITPTR(,PCTPTR)                                0219 00698000
         L     @14,PITAB(,@14)                                     0219 00699000
         LTR   @14,@14                                             0219 00700000
         BZ    @RT00219                                            0219 00701000
*     GO TO CTL12;                  /* TEST FOR SVC TBL              */ 00702000
*   FREEAD=PITAB;                   /* GET TBL ADDR            Y02014*/ 00703000
         LR    FREEAD,@14                                          0221 00704000
*/********************************************************************/ 00705000
*/*                                                                  */ 00706000
*/*                    FREE PI EBCDIC TABLE CORE               Y02014*/ 00707000
*/*                                                                  */ 00708000
*/********************************************************************/ 00709000
*                                                                  0222 00710000
*   DO;                             /* FREEMAIN(R) LV(60)A(FREETB)   */ 00711000
*     RESPECIFY                                                    0223 00712000
*      (GPR01F,                                                    0223 00713000
*       GPR00F) RESTRICTED;                                        0223 00714000
*     GPR00F=60;                    /* LENGTH REQUESTED              */ 00715000
         LA    GPR00F,60                                           0224 00716000
*     GPR01F=ADDR(FREETB);          /* SET REGISTER ONE              */ 00717000
         LR    GPR01F,FREEAD                                       0225 00718000
*     SVC(10);                      /* R-FORM OF GETMAIN             */ 00719000
         SVC   10                                                  0226 00720000
*     RESPECIFY                                                    0227 00721000
*      (GPR01F,                                                    0227 00722000
*       GPR00F) UNRESTRICTED;                                      0227 00723000
*   END;                            /* FREEMAIN(R) LV(60)A(FREETB) 0228 00724000
*                                      FREE PI EBCDIC TBL Y02014     */ 00725000
*   PITAB=0;                        /* CLEAR PITAB             Y02014*/ 00726000
         L     @14,INITPTR(,PCTPTR)                                0229 00727000
         SLR   @06,@06                                             0229 00728000
         ST    @06,PITAB(,@14)                                     0229 00729000
*/********************************************************************/ 00730000
*/*                                                                  */ 00731000
*/*                    TEST FOR SVC EBCDIC TABLE               Y02014*/ 00732000
*/*                                                                  */ 00733000
*/********************************************************************/ 00734000
*                                                                  0230 00735000
*CTL12:                                                            0230 00736000
*   IF SVCTAB=0                     /* TEST FOR SVC TABLE      Y02014*/ 00737000
*     THEN                          /* NO SVC EBCDIC TBL             */ 00738000
CTL12    L     @14,INITPTR(,PCTPTR)                                0230 00739000
         L     @14,SVCTAB(,@14)                                    0230 00740000
         LTR   @14,@14                                             0230 00741000
         BZ    @RT00230                                            0230 00742000
*     GO TO CTL13;                  /* CLEAR LOADBYTS                */ 00743000
*   FREEAD=SVCTAB;                  /* GET TABLE ADDR          Y02014*/ 00744000
         LR    FREEAD,@14                                          0232 00745000
*/********************************************************************/ 00746000
*/*                                                                  */ 00747000
*/*                    FREE SVC EBCDIC TABLE CORE              Y02014*/ 00748000
*/*                                                                  */ 00749000
*/********************************************************************/ 00750000
*                                                                  0233 00751000
*   DO;                             /* FREEMAIN(R) LV(153)A(FREETB)  */ 00752000
*     RESPECIFY                                                    0234 00753000
*      (GPR01F,                                                    0234 00754000
*       GPR00F) RESTRICTED;                                        0234 00755000
*     GPR00F=153;                   /* LENGTH REQUESTED              */ 00756000
         LA    GPR00F,153                                          0235 00757000
*     GPR01F=ADDR(FREETB);          /* SET REGISTER ONE              */ 00758000
         LR    GPR01F,FREEAD                                       0236 00759000
*     SVC(10);                      /* R-FORM OF GETMAIN             */ 00760000
         SVC   10                                                  0237 00761000
*     RESPECIFY                                                    0238 00762000
*      (GPR01F,                                                    0238 00763000
*       GPR00F) UNRESTRICTED;                                      0238 00764000
*   END;                            /* FREEMAIN(R) LV(153)A(FREETB)     00765000
*                                      FREE SVC EBCDIC TBL Y02014    */ 00766000
*   SVCTAB=0;                       /* CLEAR SVCTAB            Y02014*/ 00767000
         L     @14,INITPTR(,PCTPTR)                                0240 00768000
         SLR   @06,@06                                             0240 00769000
         ST    @06,SVCTAB(,@14)                                    0240 00770000
*/********************************************************************/ 00771000
*/*                                                                  */ 00772000
*/*                         CLEAR INDICATORS                         */ 00773000
*/*                                                                  */ 00774000
*/********************************************************************/ 00775000
*                                                                  0241 00776000
*CTL13:                                                            0241 00777000
*   GTFOPIND(1:3)=ZEROWD(1:3);      /* CLEAR GTFOPIND          Y02014*/ 00778000
CTL13    L     @14,INITPTR(,PCTPTR)                                0241 00779000
         MVC   GTFOPIND(3,@14),ZEROWD                              0241 00780000
*   GTFOPTS(1:3)=ZEROWD(1:3);       /* CLEAR GTFOPTS           Y02014*/ 00781000
         MVC   GTFOPTS(3,PCTPTR),ZEROWD                            0242 00782000
*   PCTCATF=0;                      /* CLEAR PCTCATF           Y02014*/ 00783000
         SLR   @14,@14                                             0243 00784000
         ST    @14,PCTCATF(,PCTPTR)                                0243 00785000
*   GO TO CTL03;                    /* TO AHLTSCN FOR RETRY          */ 00786000
         B     CTL03                                               0244 00787000
*                                                                  0245 00788000
*/********************************************************************/ 00789000
*/*                                                                  */ 00790000
*/*                  DECLARE SYSTEM PARAMETER LISTS                  */ 00791000
*/*                                                                  */ 00792000
*/********************************************************************/ 00793000
*                                                                  0245 00794000
*   GENERATE;                                                      0245 00795000
*                                   /* GENERATE PARMLISTS            */ 00796000
           DS    0F                                                     00797000
STAELST1   STAE  CTLSTEX,CT,PARAM=0,MF=L    /* STAE PARMLIST         */ 00798000
           DS    0F                                                     00799000
OPENLST1   OPEN  (0,(INPUT)),MF=L           /* OPEN PARMLIST         */ 00800000
           DS    0F                                                     00801000
CLOSLST1   CLOSE (0),MF=L                   /* CLOSE PARMLIST        */ 00802000
*      PARMLIB DATA CONTROL BLOCK                                       00803000
DCBFORM  DCB  MACRF=(GM),LRECL=80,DDNAME=SYSLIB,DSORG=PS         Y02014 00804000
*                                                                  0246 00805000
*/********************************************************************/ 00806000
*/*                                                                  */ 00807000
*/*                        STAE RETRY ROUTINE                        */ 00808000
*/*                                                                  */ 00809000
*/********************************************************************/ 00810000
*                                                                  0246 00811000
*CTLRETRY:                                                         0246 00812000
*   RFY                                                            0246 00813000
*    (MSGPTR,                                                      0246 00814000
*     TRTBLAD) RSTD;                /* RESTRICT 7,8            Y02014*/ 00815000
CTLRETRY DS    0H                                                  0247 00816000
*   RTRNCODE=CMPCD;                 /* SET R15 = COMP CODE           */ 00817000
         L     RTRNCODE,CMPCD(,EXPLAD)                             0247 00818000
*/********************************************************************/ 00819000
*/*                                                                  */ 00820000
*/*                      ADJUST COMPLETION CODE                      */ 00821000
*/*                                                                  */ 00822000
*/********************************************************************/ 00823000
*                                                                  0248 00824000
*   GENERATE;                                                      0248 00825000
*                                                                  0248 00826000
           LA    RTRNCODE,0(RTRNCODE)          CLEAR HIGH-ORDER BYTE    00827000
           SRL   RTRNCODE,12                   SHIFT SYSTEM CODE TO LOW 00828000
*                                              ORDER BYTES              00829000
*/********************************************************************/ 00830000
*/*                                                                  */ 00831000
*/*            TEST FOR MEMBER NOT FOUND ABEND FROM OPEN             */ 00832000
*/*                                                                  */ 00833000
*/********************************************************************/ 00834000
*                                                                  0249 00835000
*   IF RTRNCODE=NOMEMBR             /* TEST FOR MEMBER NOT FOUND     */ 00836000
*     THEN                          /* MEMBER NOT FOUND- 013         */ 00837000
         C     RTRNCODE,NOMEMBR                                    0249 00838000
         BE    @RT00249                                            0249 00839000
*     GO TO CTL14;                  /* ISSUE MSG AHL123I             */ 00840000
*/********************************************************************/ 00841000
*/*                                                                  */ 00842000
*/*             OTHER ABEND IN OPEN--CONVERT COMPLETION              */ 00843000
*/*                  CODE, ISSUE MESSAGE AND RETRY                   */ 00844000
*/*                                                                  */ 00845000
*/********************************************************************/ 00846000
*                                                                  0251 00847000
*   GEN(SLL RTRNCODE,16);           /* SET RC FOR CONVERSION   YM1407*/ 00848000
         SLL RTRNCODE,16                                                00849000
*   CMPCD=RTRNCODE;                 /* RESTORE RTRNOCDE              */ 00850000
         ST    RTRNCODE,CMPCD(,EXPLAD)                             0252 00851000
*   ICTMSGX=29;                     /* SET NDX FOR MSG AHL131I -ABEND   00852000
*                                      IN OPEN-NOT 013               */ 00853000
         L     @14,INITPTR(,PCTPTR)                                0253 00854000
         MVI   ICTMSGX(@14),X'1D'                                  0253 00855000
*   CALL AHLCTL2;                   /* GET MSG                       */ 00856000
         BAL   @14,AHLCTL2                                         0254 00857000
*   EXPLAD=ADDR(CMPCD);             /* SET PTR TO CODE               */ 00858000
         LA    @14,CMPCD(,EXPLAD)                                  0255 00859000
         LR    EXPLAD,@14                                          0255 00860000
*   MSGPTR=ADDR(MSGCODE);           /* SET PTR TO MSG AREA           */ 00861000
         L     @14,INITPTR(,PCTPTR)                                0256 00862000
         LA    MSGPTR,MSGCODE(,@14)                                0256 00863000
*   TRTBLAD=ADDR(TRTBL);            /* GET @ CNVT TBL                */ 00864000
         LA    TRTBLAD,TRTBL                                       0257 00865000
*   TWTWORK(1:4)=RTDCD;             /* SAVE ROUT/DESC CODES          */ 00866000
         MVC   TWTWORK(4,@14),RTDCD(@14)                           0258 00867000
*/********************************************************************/ 00868000
*/*                                                                  */ 00869000
*/*                     CONVERT COMPLETION CODE                      */ 00870000
*/*                                                                  */ 00871000
*/********************************************************************/ 00872000
*                                                                  0259 00873000
*   GENERATE;                                                      0259 00874000
*                                   /* CONVERT COMP CODE             */ 00875000
           UNPK  0(4,MSGPTR),0(3,EXPLAD)                                00876000
           TR    0(3,MSGPTR),0(TRTBLAD)                                 00877000
*   RTDCD=TWTWORK(1:4);             /* REPLACE ROUT/DESC CODE        */ 00878000
         L     @14,INITPTR(,PCTPTR)                                0260 00879000
         MVC   RTDCD(4,@14),TWTWORK(@14)                           0260 00880000
*   ICTMSGX='FF'X;                  /* SET IND FOR MSG IN BUF        */ 00881000
         MVI   ICTMSGX(@14),X'FF'                                  0261 00882000
*   RFY                                                            0262 00883000
*    (MSGPTR,                                                      0262 00884000
*     TRTBLAD) UNRSTD;              /* UNRESTRICT 7,8          Y02014*/ 00885000
*   GO TO CTL01;                    /* ISSUE MSG                     */ 00886000
         B     CTL01                                               0263 00887000
*/********************************************************************/ 00888000
*/*                                                                  */ 00889000
*/*                MEMBER NOT FOUND ABEND--PLACE NAME                */ 00890000
*/*               IN MESSAGE, ISSUE MESSAGE, AND RETRY               */ 00891000
*/*                                                                  */ 00892000
*/********************************************************************/ 00893000
*                                                                  0264 00894000
*CTL14:                                                            0264 00895000
*   ICTMSGX=21;                     /* SET IND FOR AHL123I           */ 00896000
CTL14    L     @14,INITPTR(,PCTPTR)                                0264 00897000
         MVI   ICTMSGX(@14),X'15'                                  0264 00898000
*   TWTWORK(1:8)=JFCBELNM;          /* SAVE MEMBER NAME              */ 00899000
         MVC   TWTWORK(8,@14),JFCBELNM(@14)                        0265 00900000
*   CALL AHLCTL2;                   /* GET MSG                       */ 00901000
         BAL   @14,AHLCTL2                                         0266 00902000
*   MSGMEMBR=TWTWORK(1:8);          /* PUT MEMBR NAME IN MSG         */ 00903000
         L     @14,INITPTR(,PCTPTR)                                0267 00904000
         MVC   MSGMEMBR(8,@14),TWTWORK(@14)                        0267 00905000
*   ICTMSGX='FF'X;                  /* SET MSG IND                   */ 00906000
         MVI   ICTMSGX(@14),X'FF'                                  0268 00907000
*   RFY                                                            0269 00908000
*    (MSGPTR,                                                      0269 00909000
*     TRTBLAD) UNRSTD;              /* UNRESTRICT 7,8          Y02014*/ 00910000
*   GO TO CTL01;                    /* ISSUE MSG                     */ 00911000
         B     CTL01                                               0270 00912000
*                                                                  0271 00913000
*/********************************************************************/ 00914000
*/*                                                                  */ 00915000
*/*         DEFINE TRANSLATE TABLE AND STAE EXIT ROUTINE CODE        */ 00916000
*/*                                                                  */ 00917000
*/********************************************************************/ 00918000
*                                                                  0271 00919000
*   GENERATE;                                                      0271 00920000
*                                   /* DEFINE TBL AND CODE           */ 00921000
RTRYRT     LM    R0,R15,8(R15)              /* RESTORE REGS 0-15     */ 00922000
           BCR   15,R15                     /* TO EXIT ROUTINE       */ 00923000
           DC    C'0123456789ABCDEF'        /* TRANSLATE TABLE       */ 00924000
           ORG   *-256                      /* RELOCATE TABLE START  */ 00925000
TRTBL      DS    0C                         /* TABLE LABLE           */ 00926000
           ORG                                                          00927000
*                                                                  0272 00928000
*/********************************************************************/ 00929000
*/*                                                                  */ 00930000
*/*            STAE EXIT ROUTINE--PLACE COMPLETION CODE IN           */ 00931000
*/*           STAE PARMLIST IN TWTWORK AND RETURN FOR RETRY          */ 00932000
*/*                                                                  */ 00933000
*/********************************************************************/ 00934000
*                                                                  0272 00935000
*CTLSTEX:                                                          0272 00936000
*   GENERATE;                                                      0272 00937000
*                                                                  0272 00938000
CTLSTEX  DS    0H                                                  0272 00939000
         ST    14,12(0,13)                                       Y02014 00940000
         STM   0,12,20(13)                                       Y02014 00941000
         BALR  12,0                                              Y02014 00942000
CTLSEXEP LA    15,CTLSEXEP-@PSTART                               Y02014 00943000
         SR    12,15                                             Y02014 00944000
         ST    13,SAV3AREA+4                                     Y02014 00945000
         LA    15,SAV3AREA                                       Y02014 00946000
         ST    15,8(0,13)                                        Y02014 00947000
         LR    13,15                                             Y02014 00948000
*/********************************************************************/ 00949000
*/*                                                                  */ 00950000
*/*                    TEST FOR NO STAE WORK AREA                    */ 00951000
*/*                                                                  */ 00952000
*/********************************************************************/ 00953000
*                                                                  0273 00954000
*   RFY                                                            0273 00955000
*     R0 RSTD;                      /* RESTRICT REG 0          Y02014*/ 00956000
*   IF R0=12                        /* TEST FOR STAE WORKAREA        */ 00957000
*     THEN                          /* NO WORK AREA                  */ 00958000
         C     R0,@CF00308                                         0274 00959000
         BE    @RT00274                                            0274 00960000
*     GO TO CTL15;                  /* GET PL@ FROM R2               */ 00961000
*   EXPLAD=PARMAD;                  /* GET ADDR STAE PARMLIST FROM 0276 00962000
*                                      1ST WD-STAE WORK              */ 00963000
         L     EXPLAD,PARMAD(,PARMRG1)                             0276 00964000
*   CMPCD=ABNDCC;                   /* COMP CODE TO STAE PARM LIST 0277 00965000
*                                      (IN TWTWORK)                  */ 00966000
         L     @14,ABNDCC(,PARMRG1)                                0277 00967000
         ST    @14,CMPCD(,EXPLAD)                                  0277 00968000
*   GO TO CTL16;                    /* SET RETRY ADDR                */ 00969000
         B     CTL16                                               0278 00970000
*CTL15:                                                            0279 00971000
*   EXPLAD=EXPLAD1;                 /* RESET REGISTER 3        Y02014*/ 00972000
CTL15    L     EXPLAD,EXPLAD1                                      0279 00973000
*   CMPCD=PARMRG1;                  /* COMP CODE TO STAE PARM LIST 0280 00974000
*                                      (IN TWTWORK)            Y02014*/ 00975000
         ST    PARMRG1,CMPCD(,EXPLAD)                              0280 00976000
*CTL16:                                                            0281 00977000
*   GPRS0=SAVARAD;                  /* SET R0=@ RETRY ROUT IN SAVE 0281 00978000
*                                      AREA                    Y02014*/ 00979000
CTL16    L     @14,CALLRSA1(,SAVR)                                 0281 00980000
         L     @06,SAVARAD(,EXPLAD)                                0281 00981000
         ST    @06,GPRS0(,@14)                                     0281 00982000
*   GPRS15=4;                       /* SET RETURN CODE FOR RETRY WITH   00983000
*                                      PURGE                   Y02014*/ 00984000
         MVC   GPRS15(4,@14),@CF00060                              0282 00985000
*   RFY                                                            0283 00986000
*     R0 UNRSTD;                    /* UNRESTRICT REG 0        Y02014*/ 00987000
*   RETURN;                         /* RETURN TO STAE          Y02014*/ 00988000
         B     @EL00001                                            0284 00989000
*                                                                  0285 00990000
*/********************************************************************/ 00991000
*/*                                                                  */ 00992000
*/*                           I/O ROUTINE                            */ 00993000
*/*                                                                  */ 00994000
*/********************************************************************/ 00995000
*                                                                  0285 00996000
*AHLTIO:                                                           0285 00997000
*   PROC OPTIONS(NOSAVEAREA,DONTSAVE);/* DEFINE PROC OPTIONS   Y02014*/ 00998000
AHLTIO   DS    0H                                                  0286 00999000
*   GENERATE;                                                      0286 01000000
*                                                                  0286 01001000
         ST   14,12(0,13)                                        Y02014 01002000
         STM  0,12,20(13)                                        Y02014 01003000
         BALR 12,0                                               Y02014 01004000
AHLTIOE  LA   15,AHLTIOE-@PSTART                                 Y02014 01005000
         SR   12,15                                              Y02014 01006000
         ST   13,SAV1AREA+4                                      Y02014 01007000
         LA   15,SAV1AREA                                        Y02014 01008000
         ST   15,8(0,13)                                         Y02014 01009000
         LR   13,15                                              Y02014 01010000
*/********************************************************************/ 01011000
*/*                                                                  */ 01012000
*/*                        REGISTER VARIABLES                        */ 01013000
*/*                                                                  */ 01014000
*/********************************************************************/ 01015000
*                                                                  0287 01016000
*   DECLARE                         /* PTR TO INPUT BUFFER           */ 01017000
*     AREAPTR PTR(31) REG(0);                                      0287 01018000
*                                                                  0288 01019000
*/********************************************************************/ 01020000
*/*                                                                  */ 01021000
*/*                  DEFINE MISCELLANEOUS VARIABLES                  */ 01022000
*/*                                                                  */ 01023000
*/********************************************************************/ 01024000
*                                                                  0288 01025000
*   DECLARE                         /* ROUTINE LABELS FOR            */ 01026000
*    (IO01,                         /* BRANCH TABLE                  */ 01027000
*     IO02,                                                        0288 01028000
*     IO03,                                                        0288 01029000
*     IO04) LABEL;                                                 0288 01030000
*   DECLARE                         /* BRANCH TABLE                  */ 01031000
*     IOROUT(4) PTR(31) INIT(ADDR(IO01),/* WTOR ROUTINE        Y02014*/ 01032000
*         ADDR(IO02),               /* WTO ROUTINE                   */ 01033000
*         ADDR(IO03),               /* READ PARMLIB ROUTINE          */ 01034000
*         ADDR(IO04));              /* WTP ROUTINE             Y02014*/ 01035000
*   DECLARE                         /* CONSTANT FOR COMPUTING        */ 01036000
*     LISTLEN PTR(15) INIT(3);      /* MESSAGE LENGTH                */ 01037000
*   DECLARE                         /* WTOR REPLY LENGTH             */ 01038000
*     MAXRPLY PTR(15) INIT(123);                                   0291 01039000
*   DECLARE                         /* ECB ADDR IN WTOR              */ 01040000
*     ECBAD PTR(31)                 /* PARMLIST                      */ 01041000
*         DEFINED(TWTBUF) POSITION(5);/*                       Y02014*/ 01042000
*   DECLARE                         /* WTOR REPLY ADDR IN            */ 01043000
*     RPLYAD PTR(24)                /* WTOR PARMLIST                 */ 01044000
*         DEFINED(TWTBUF) POSITION(2);/*                       Y02014*/ 01045000
*   DECLARE                         /* WTOR REPLY LENGTH IN          */ 01046000
*     RPLYLEN PTR(8)                /* WTOR PARMLIST                 */ 01047000
*         DEFINED(TWTBUF);          /*                         Y02014*/ 01048000
*   DECLARE                         /* MESSAGE AREA            Y02014*/ 01049000
*     WTOMSG CHAR(123)              /*                         Y02014*/ 01050000
*         DEFINED(TWTBUF) POSITION(5);/*                       Y02014*/ 01051000
*   DECLARE                         /* WTO LENGTH IN WTO             */ 01052000
*     WTOLEN PTR(15)                /* PARMLIST                      */ 01053000
*         DEFINED(TWTBUF);          /*                         Y02014*/ 01054000
*   DECLARE                         /* MESSAGE AREA            Y02014*/ 01055000
*     WTORMSG CHAR(75)              /*                         Y02014*/ 01056000
*         DEFINED(TWTBUF) POSITION(13);/*                      Y02014*/ 01057000
*   DECLARE                         /*                         Y02014*/ 01058000
*     MSGHOLD CHAR(75);             /* HOLDS WTOR TEXT         Y02014*/ 01059000
*   DECLARE                         /* WTOR LENGTH IN WTOR           */ 01060000
*     WTORLEN PTR(15)               /* PARMLIST                      */ 01061000
*         DEFINED(TWTBUF) POSITION(9);/*                       Y02014*/ 01062000
*   DECLARE                                                        0300 01063000
*     AHL127RC CHAR(4) DEFINED(TWTBUF) POSITION(37);/* AHL127I     0300 01064000
*                                      ROUTING CODES           Y02014*/ 01065000
*   DECLARE                                                        0301 01066000
*     A127RCHD CHAR(4) DEFINED(TWTBUF) POSITION(71);/* NEW ROUTING CD   01067000
*                                      POSITION                Y02014*/ 01068000
*   DECLARE                         /* SAVE MSG LENGTH         Y02014*/ 01069000
*     SLENMSG PTR(31);                                             0302 01070000
*   DECLARE                         /* SAVE MSG ADDRESS        Y02014*/ 01071000
*     SMSGPTR PTR(31);                                             0303 01072000
*   DECLARE                         /* SAVE MESSAGE TO BE WRITTEN    */ 01073000
*     MSG CHAR(123) BASED(SMSGPTR) POSITION(13);/*             Y02014*/ 01074000
*                                                                  0305 01075000
*/********************************************************************/ 01076000
*/*                                                                  */ 01077000
*/*                         BEGIN I/O ROUTINE                        */ 01078000
*/*                                                                  */ 01079000
*/********************************************************************/ 01080000
*/********************************************************************/ 01081000
*/*                                                                  */ 01082000
*/*            TEST FOR MESSAGE PREVIOUSLY PLACED IN BUFFER          */ 01083000
*/*                                                                  */ 01084000
*/********************************************************************/ 01085000
*                                                                  0305 01086000
*   IF ICTMSGX='FF'X                /* TEST FOR MSG IN BUFF          */ 01087000
*     THEN                          /* MSG ALREADY IN BUFFER         */ 01088000
         L     @14,INITPTR(,PCTPTR)                                0305 01089000
         CLI   ICTMSGX(@14),255                                    0305 01090000
         BE    @RT00305                                            0305 01091000
*     GO TO IO00;                   /* TO I/O ROUTINE                */ 01092000
*   TWTBUF(1:152)='';               /* CLEAR TWTBUF            Y02014*/ 01093000
         MVI   TWTBUF(@14),C' '                                    0307 01094000
         MVC   TWTBUF+1(151,@14),TWTBUF(@14)                       0307 01095000
*   CALL AHLCTL2;                   /* GET MSG                       */ 01096000
         BAL   @14,AHLCTL2                                         0308 01097000
*IO00:                                                             0309 01098000
*   GO TO IOROUT(ICTIOTYP);         /* TO I/O ROUTINE                */ 01099000
IO00     L     @14,INITPTR(,PCTPTR)                                0309 01100000
         SLR   @06,@06                                             0309 01101000
         IC    @06,ICTIOTYP(,@14)                                  0309 01102000
         SLA   @06,2                                               0309 01103000
         L     @14,IOROUT-4(@06)                                   0309 01104000
         BR    @14                                                 0309 01105000
*                                                                  0310 01106000
*/********************************************************************/ 01107000
*/*                                                                  */ 01108000
*/*                           WTOR ROUTINE                           */ 01109000
*/*                                                                  */ 01110000
*/********************************************************************/ 01111000
*                                                                  0310 01112000
*IO01:                                                             0310 01113000
*   MSGREPLY(1:124)='';             /* CLEAR REPLY BUFFER      Y02014*/ 01114000
IO01     L     @14,INITPTR(,PCTPTR)                                0310 01115000
         MVI   MSGREPLY(@14),C' '                                  0310 01116000
         MVC   MSGREPLY+1(123,@14),MSGREPLY(@14)                   0310 01117000
*   WTORECB=0;                      /* CLEAR ECB               Y02014*/ 01118000
         SLR   @06,@06                                             0311 01119000
         ST    @06,WTORECB(,@14)                                   0311 01120000
*   ECBAD=ADDR(WTORECB);            /* PUT ADDR OF ECB IN GTFPCT INTO   01121000
*                                      THE WTOR PARMLIST       Y02014*/ 01122000
         LA    @06,WTORECB(,@14)                                   0312 01123000
         ST    @06,ECBAD(,@14)                                     0312 01124000
*   RPLYAD=ADDR(MSGREPLY);          /* PUT ADDR OF REPLY AREA IN   0313 01125000
*                                      INITDATA INTO WTOR PLIST    0313 01126000
*                                                              Y02014*/ 01127000
         LA    @06,MSGREPLY(,@14)                                  0313 01128000
         STCM  @06,7,RPLYAD(@14)                                   0313 01129000
*/********************************************************************/ 01130000
*/*                                                                  */ 01131000
*/*                     WRITE TO OPERATOR WITH REPLY                 */ 01132000
*/*                                                                  */ 01133000
*/********************************************************************/ 01134000
*                                                                  0314 01135000
*   DO;                             /* WTORP MF(E,TWTBUF)            */ 01136000
*     RFY                                                          0315 01137000
*       GPR01P RSTD;                /* RESTRICT REG 1                */ 01138000
*     GPR01P=ADDR(TWTBUF);          /* ADDRESS CONTROL PROGRAM LIST  */ 01139000
         LA    GPR01P,TWTBUF(,@14)                                 0316 01140000
*     SVC(35);                      /* ISSUE WTOR SVC                */ 01141000
         SVC   35                                                  0317 01142000
*     RFY                                                          0318 01143000
*       GPR01P UNRSTD;              /* RELEASE REG 1                 */ 01144000
*   END;                            /* WTORP MF(E,TWTBUF) WTOR Y02014*/ 01145000
*   DO;                             /* WAIT (1) ECBLIST(ECBLST)      */ 01146000
*     RESPECIFY                                                    0321 01147000
*      (GPR00P,                                                    0321 01148000
*       GPR01P) RESTRICTED;                                        0321 01149000
*     GPR00P=1;                     /* LOAD WAIT COUNT               */ 01150000
         LA    GPR00P,1                                            0322 01151000
*     GPR01P=-ADDR(ECBLST);         /* ADDRESS OF LIST OF ECB'S      */ 01152000
         LA    GPR01P,ECBLST                                       0323 01153000
         LCR   GPR01P,GPR01P                                       0323 01154000
*     SVC(1);                       /* WAIT SVC                      */ 01155000
         SVC   1                                                   0324 01156000
*     RESPECIFY                                                    0325 01157000
*      (GPR00P,                                                    0325 01158000
*       GPR01P) UNRESTRICTED;                                      0325 01159000
*   END;                            /* WAIT (1) ECBLIST(ECBLST) WAIT    01160000
*                                      ON WTOR AND STOP Y02014       */ 01161000
*/********************************************************************/ 01162000
*/*                                                                  */ 01163000
*/*                     TEST FOR STOP ECB POSTED                     */ 01164000
*/*                                                                  */ 01165000
*/********************************************************************/ 01166000
*                                                                  0327 01167000
*   IF POSTBIT='1'B                 /* TEST FOR STOP ECB POST        */ 01168000
*     THEN                          /* STOP ECB POSTED               */ 01169000
         L     @14,STOPECBA(,PCTPTR)                               0327 01170000
         TM    POSTBIT(@14),B'01000000'                            0327 01171000
         BNO   @RF00327                                            0327 01172000
*     DO;                                                          0328 01173000
*       ICTSTOP='1'B;               /* SET IND IN ICT                */ 01174000
         L     @14,INITPTR(,PCTPTR)                                0329 01175000
         OI    ICTSTOP(@14),B'00000100'                            0329 01176000
*       GO TO IO12;                 /* RETURN TO CALLER        Y02014*/ 01177000
         B     IO12                                                0330 01178000
*     END;                                                         0331 01179000
*                                                                  0331 01180000
*/********************************************************************/ 01181000
*/*                                                                  */ 01182000
*/*                   'OR' REPLY AREA WITH BLANKS                    */ 01183000
*/*                                                                  */ 01184000
*/********************************************************************/ 01185000
*                                                                  0332 01186000
*   DO MSGPTRVR=124 TO 1            /* OR REPLY AREA WITH            */ 01187000
*         BY-1;                                                    0332 01188000
@RF00327 LA    MSGPTRVR,124                                        0332 01189000
@DL00332 DS    0H                                                  0333 01190000
*     MSGREPLY(MSGPTRVR)=           /* BLANKS FOR ALL CAPITAL  Y02014*/ 01191000
*         MSGREPLY(MSGPTRVR)|       /* LETTERS                 Y02014*/ 01192000
*         BLANK(1);                                                0333 01193000
         L     @14,INITPTR(,PCTPTR)                                0333 01194000
         ALR   @14,MSGPTRVR                                        0333 01195000
         OC    MSGREPLY-1(1,@14),BLANK                             0333 01196000
*   END;                            /*                         Y02014*/ 01197000
         BCTR  MSGPTRVR,0                                          0334 01198000
         LTR   MSGPTRVR,MSGPTRVR                                   0334 01199000
         BP    @DL00332                                            0334 01200000
*   ICTMSGX=30;                     /* SET UP FOR WRITING REPLY TO 0335 01201000
*                                      PROGRAMMER              Y02014*/ 01202000
         L     @14,INITPTR(,PCTPTR)                                0335 01203000
         MVI   ICTMSGX(@14),X'1E'                                  0335 01204000
*   TWTBUF(1:152)='';               /* CLEAR TWTBUF            Y02014*/ 01205000
         MVI   TWTBUF(@14),C' '                                    0336 01206000
         MVC   TWTBUF+1(151,@14),TWTBUF(@14)                       0336 01207000
*   CALL AHLCTL2;                   /* GET MESSAGE             Y02014*/ 01208000
         BAL   @14,AHLCTL2                                         0337 01209000
*   WTOMSG=MSGREPLY;                /* PLACE REPLY IN PARMLIST Y02014*/ 01210000
         L     @14,INITPTR(,PCTPTR)                                0338 01211000
         MVC   WTOMSG(123,@14),MSGREPLY(@14)                       0338 01212000
*                                                                  0339 01213000
*/********************************************************************/ 01214000
*/*                                                                  */ 01215000
*/*                           WTO ROUTINE                            */ 01216000
*/*                                                                  */ 01217000
*/********************************************************************/ 01218000
*                                                                  0339 01219000
*IO02:                                                             0339 01220000
*                                                                  0339 01221000
*/********************************************************************/ 01222000
*/*                                                                  */ 01223000
*/*                           WRITE TO OPERATOR AND PROGRAMMER Y02014*/ 01224000
*/*                                                                  */ 01225000
*/********************************************************************/ 01226000
*                                                                  0339 01227000
*   DO;                             /* WTOP MF(E,TWTBUF)             */ 01228000
IO02     DS    0H                                                  0340 01229000
*     RFY                                                          0340 01230000
*       GPR01P RSTD;                /* RESTRICT REG 1                */ 01231000
*     GPR01P=ADDR(TWTBUF);          /* ADDRESS CONTROL PROGRAM LIST  */ 01232000
         L     GPR01P,INITPTR(,PCTPTR)                             0341 01233000
         LA    GPR01P,TWTBUF(,GPR01P)                              0341 01234000
*     SVC(35);                      /* ISSUE WTO SVC                 */ 01235000
         SVC   35                                                  0342 01236000
*     RFY                                                          0343 01237000
*       GPR01P UNRSTD;              /* RELEASE REG 1                 */ 01238000
*   END;                            /* WTOP MF(E,TWTBUF) WTO Y02014  */ 01239000
*   GO TO IO12;                     /* RETURN                  Y02014*/ 01240000
         B     IO12                                                0345 01241000
*                                                                  0346 01242000
*/********************************************************************/ 01243000
*/*                                                                  */ 01244000
*/*                       READ PARMLIB ROUTINE                       */ 01245000
*/*                                                                  */ 01246000
*/********************************************************************/ 01247000
*                                                                  0346 01248000
*IO03:                                                             0346 01249000
*   DCBPTR=PARMDCB;                 /* GET @DCB FOR GET        Y02014*/ 01250000
IO03     L     @14,INITPTR(,PCTPTR)                                0346 01251000
         L     DCBPTR,PARMDCB(,@14)                                0346 01252000
*   GEN;                                                           0347 01253000
*                                   /* SET SYNAD ROUT ADDR   @ZA09667*/ 01254000
         LA    @06,IO10                                         ZA09667 01255000
         STCM  @06,7,DCBSYNAD+1(DCBPTR)                         ZA09667 01256000
*   DCBEODAD=ADDR(IO11);            /* SET ADDR FOR EOD              */ 01257000
         LA    @14,IO11                                            0348 01258000
         ST    @14,DCBEODAD(,DCBPTR)                               0348 01259000
*   MSGREPLY(1:124)='';             /* CLEAR BUFFER            Y02014*/ 01260000
         L     @14,INITPTR(,PCTPTR)                                0349 01261000
         MVI   MSGREPLY(@14),C' '                                  0349 01262000
         MVC   MSGREPLY+1(123,@14),MSGREPLY(@14)                   0349 01263000
*   AREAPTR=ADDR(MSGREPLY);         /* SET INPUT BUFF PTR            */ 01264000
         LA    AREAPTR,MSGREPLY(,@14)                              0350 01265000
*   GENERATE(GET (DCBPTR));         /* READ PARMLIB                  */ 01266000
         GET (DCBPTR)                                                   01267000
*   ICTMSGX=30;                     /* SET UP FOR WRITING MSG TO   0352 01268000
*                                      PROGRAMMER              Y02014*/ 01269000
         L     @14,INITPTR(,PCTPTR)                                0352 01270000
         MVI   ICTMSGX(@14),X'1E'                                  0352 01271000
*   TWTBUF='';                      /* CLEAR BUFFER            Y02014*/ 01272000
         MVI   TWTBUF(@14),C' '                                    0353 01273000
         MVC   TWTBUF+1(151,@14),TWTBUF(@14)                       0353 01274000
*   CALL AHLCTL2;                   /* GET MESSAGE             Y02014*/ 01275000
         BAL   @14,AHLCTL2                                         0354 01276000
*   WTOMSG=MSGREPLY;                /* MOVE RECORD TO PARMLIST Y02014*/ 01277000
         L     @14,INITPTR(,PCTPTR)                                0355 01278000
         MVC   WTOMSG(123,@14),MSGREPLY(@14)                       0355 01279000
*   GOTO IO02;                      /* GO PERFORM WTP          Y02014*/ 01280000
         B     IO02                                                0356 01281000
*                                                                  0357 01282000
*/********************************************************************/ 01283000
*/*                     WTP ROUTINE                                  */ 01284000
*/********************************************************************/ 01285000
*                                                                  0357 01286000
*IO04:                                                             0357 01287000
*   IF ICTMSGX='FF'X THEN           /* MESSAGE IN BUFFER       Y02014*/ 01288000
IO04     L     @14,INITPTR(,PCTPTR)                                0357 01289000
         CLI   ICTMSGX(@14),255                                    0357 01290000
         BNE   @RF00357                                            0357 01291000
*     DO;                           /* YES                     Y02014*/ 01292000
*       SLENMSG=WTORLEN-4;          /* ACTUAL TEXT LENGTH      Y02014*/ 01293000
         LH    SLENMSG,WTORLEN(,@14)                               0359 01294000
         SL    SLENMSG,@CF00060                                    0359 01295000
*       MSGHOLD(1:SLENMSG)=WTORMSG(1:SLENMSG);/* SAVE TEXT     Y02014*/ 01296000
         LR    @09,SLENMSG                                         0360 01297000
         BCTR  @09,0                                               0360 01298000
         EX    @09,@SM00535                                        0360 01299000
*       ICTMSGX=30;                 /* WTO PARMLIST NEEDED     Y02014*/ 01300000
         MVI   ICTMSGX(@14),X'1E'                                  0361 01301000
*       TWTBUF(1:152)='';           /* CLEAR BUFFER            Y02014*/ 01302000
         MVI   TWTBUF(@14),C' '                                    0362 01303000
         MVC   TWTBUF+1(151,@14),TWTBUF(@14)                       0362 01304000
*       CALL AHLCTL2;               /* OBTAIN PARMLIST         Y02014*/ 01305000
         BAL   @14,AHLCTL2                                         0363 01306000
*       WTOMSG(1:SLENMSG)=MSGHOLD(1:SLENMSG);/* RESTORE TEXT   Y02014*/ 01307000
         L     @14,INITPTR(,PCTPTR)                                0364 01308000
         LR    @09,SLENMSG                                         0364 01309000
         BCTR  @09,0                                               0364 01310000
         EX    @09,@SM00537                                        0364 01311000
*       GOTO IO02;                  /* GO ISSUE WTO            Y02014*/ 01312000
         B     IO02                                                0365 01313000
*     END;                                                         0366 01314000
*   SLENMSG=AHLLEN(ICTMSGX)-16;     /* LNG OF MESSAGE          Y02014*/ 01315000
@RF00357 L     @14,MSGTBLAD                                        0367 01316000
         L     @11,INITPTR(,PCTPTR)                                0367 01317000
         SLR   @06,@06                                             0367 01318000
         IC    @06,ICTMSGX(,@11)                                   0367 01319000
         SLA   @06,2                                               0367 01320000
         LA    @09,0(@06,@14)                                      0367 01321000
         AL    @09,@CF00539                                        0367 01322000
         SLR   SLENMSG,SLENMSG                                     0367 01323000
         IC    SLENMSG,AHLLEN(,@09)                                0367 01324000
         SL    SLENMSG,@CF00232                                    0367 01325000
*   SMSGPTR=AHLAD(ICTMSGX);         /* ADDRESS OF MSG          Y02014*/ 01326000
         AL    @14,@CF00539                                        0368 01327000
         L     SMSGPTR,AHLAD-1(@06,@14)                            0368 01328000
         LA    SMSGPTR,0(,SMSGPTR)                                 0368 01329000
*   ICTMSGX=30;                     /* OBTAIN WTO PARM LST     Y02014*/ 01330000
         MVI   ICTMSGX(@11),X'1E'                                  0369 01331000
*   TWTBUF(1:152)='';               /* CLEAR BUFFER            Y02014*/ 01332000
         MVI   TWTBUF(@11),C' '                                    0370 01333000
         MVC   TWTBUF+1(151,@11),TWTBUF(@11)                       0370 01334000
*   CALL AHLCTL2;                   /* GO GET PARM LST         Y02014*/ 01335000
         BAL   @14,AHLCTL2                                         0371 01336000
*   WTOMSG(1:SLENMSG)=MSG(1:SLENMSG);/* MSG TO PARM LST        Y02014*/ 01337000
         L     @14,INITPTR(,PCTPTR)                                0372 01338000
         LR    @11,SLENMSG                                         0372 01339000
         BCTR  @11,0                                               0372 01340000
         EX    @11,@SM00540                                        0372 01341000
*   GOTO IO02;                      /* GO ISSUE WTO            Y02014*/ 01342000
         B     IO02                                                0373 01343000
*                                                                  0374 01344000
*/********************************************************************/ 01345000
*/*                                                                  */ 01346000
*/*                    PARMLIB READ ERROR ROUTINE                    */ 01347000
*/*                                                                  */ 01348000
*/********************************************************************/ 01349000
*                                                                  0374 01350000
*IO10:                                                             0374 01351000
*   GENERATE;                                                      0374 01352000
*                                                                  0374 01353000
IO10     DS    0H                                                  0374 01354000
*                                   /* ANALYZE I/O ERROR             */ 01355000
    SYNADAF ACSMETH=QSAM                                                01356000
*/********************************************************************/ 01357000
*/*                                                                  */ 01358000
*/*                   SETUP ERROR MESSAGE AHL127I                    */ 01359000
*/*                                                                  */ 01360000
*/********************************************************************/ 01361000
*                                                                  0375 01362000
*   ICTMSGX=25;                     /* SET INDX FOR AHL127I    Y02014*/ 01363000
         L     @14,INITPTR(,PCTPTR)                                0375 01364000
         MVI   ICTMSGX(@14),X'19'                                  0375 01365000
*   CALL AHLCTL2;                   /* GET AHL127I--1ST PART OF MSG     01366000
*                                      ONLY                    Y02014*/ 01367000
         BAL   @14,AHLCTL2                                         0376 01368000
*   WTOLEN=WTOLEN+34;               /* UPDATE MSG LNG FOR WTO  Y02014*/ 01369000
         L     @14,INITPTR(,PCTPTR)                                0377 01370000
         LA    @00,34                                              0377 01371000
         AH    @00,WTOLEN(,@14)                                    0377 01372000
         STH   @00,WTOLEN(,@14)                                    0377 01373000
*   A127RCHD=AHL127RC;              /* SAVE ROUTING CD         Y02014*/ 01374000
         MVC   A127RCHD(4,@14),AHL127RC(@14)                       0378 01375000
*   SYNADPTR=PARMRG1;               /* SET PTR TO SYNAD W/A    Y02014*/ 01376000
         LR    SYNADPTR,PARMRG1                                    0379 01377000
*   UNITADR=SYNUAD;                 /* UNIT ADDR TO MSG              */ 01378000
         MVC   UNITADR(4,@14),SYNUAD(SYNADPTR)                     0380 01379000
*   OPERR=SYNOPERR;                 /* OP AND ERR DESC TO MSG        */ 01380000
         MVC   OPERR(23,@14),SYNOPERR(SYNADPTR)                    0381 01381000
*   ACSMETH=SYNAM;                  /* ACCESS METHOD TO MSG          */ 01382000
         MVC   ACSMETH(6,@14),SYNAM(SYNADPTR)                      0382 01383000
*   GENERATE(SYNADRLS);             /* RELEASE SYNAD W/A             */ 01384000
         SYNADRLS                                                       01385000
*   ICTIOTYP=2;                     /* SET I/O TYPE FOR WTO          */ 01386000
         L     @14,INITPTR(,PCTPTR)                                0384 01387000
         MVI   ICTIOTYP(@14),X'02'                                 0384 01388000
*   ICTIOERR='1'B;                  /* SET READ ERROR IND            */ 01389000
         OI    ICTIOERR(@14),B'01000000'                           0385 01390000
*   GO TO IO02;                     /* ISSUE MESSAGE                 */ 01391000
         B     IO02                                                0386 01392000
*/********************************************************************/ 01393000
*/*                                                                  */ 01394000
*/*                         PARMLIB READ EOD                         */ 01395000
*/*                                                                  */ 01396000
*/********************************************************************/ 01397000
*                                                                  0387 01398000
*IO11:                                                             0387 01399000
*   ICTEOD='1'B;                    /* TURN ON EOD IND               */ 01400000
IO11     L     @14,INITPTR(,PCTPTR)                                0387 01401000
         OI    ICTEOD(@14),B'00100000'                             0387 01402000
*IO12:                                                             0388 01403000
*   GENERATE;                                                      0388 01404000
IO12     DS    0H                                                  0388 01405000
         L   13,4(0,13)                                                 01406000
         L   14,12(0,13)                                                01407000
         LM  0,12,20(13)                                                01408000
*   END AHLTIO;                     /* END I/O SUBROUTINE            */ 01409000
@EL00002 DS    0H                                                  0389 01410000
@EF00002 DS    0H                                                  0389 01411000
@ER00002 BR    @14                                                 0389 01412000
*                                                                  0390 01413000
*/********************************************************************/ 01414000
*/*                                                                  */ 01415000
*/*                 PLACE MESSAGE IN BUFFER ROUTINE                  */ 01416000
*/*                                                                  */ 01417000
*/********************************************************************/ 01418000
*                                                                  0390 01419000
*AHLCTL2:                                                          0390 01420000
*   PROC OPTIONS(DONTSAVE,NOSAVEAREA);/* DEFINE PROC OPTIONS   Y02014*/ 01421000
AHLCTL2  DS    0H                                                  0391 01422000
*   GENERATE;                                                      0391 01423000
*                                                                  0391 01424000
         ST   14,12(0,13)                                        Y02014 01425000
         STM  0,12,20(13)                                        Y02014 01426000
         BALR 12,0                                               Y02014 01427000
AHLCTLE  LA   15,AHLCTLE-@PSTART                                 Y02014 01428000
         SR   12,15                                              Y02014 01429000
         ST   13,SAV2AREA+4                                      Y02014 01430000
         LA   15,SAV2AREA                                        Y02014 01431000
         ST   15,8(0,13)                                         Y02014 01432000
         LR   13,15                                              Y02014 01433000
*/********************************************************************/ 01434000
*/*                                                                  */ 01435000
*/*                       MESSAGE, BUFFER AREAS                      */ 01436000
*/*                                                                  */ 01437000
*/********************************************************************/ 01438000
*                                                                  0392 01439000
*   DECLARE                         /* MSG IN AHLTCTL2               */ 01440000
*     AHLMSG CHAR(135) BASED(MSGPTRVR);                            0392 01441000
*   DECLARE                         /* MSG OUTPUT BUFFER             */ 01442000
*     MSGAREA CHAR(135) DEFINED(TWTBUF);/* MSG AREA            Y02014*/ 01443000
*                                                                  0394 01444000
*/********************************************************************/ 01445000
*/*                                                                  */ 01446000
*/*                           BEGIN CTL2                             */ 01447000
*/*                                                                  */ 01448000
*/********************************************************************/ 01449000
*                                                                  0394 01450000
*   MSGPTRVR=AHLAD(ICTMSGX);        /* SET PTR TO AHL MSG            */ 01451000
         L     @14,MSGTBLAD                                        0394 01452000
         L     @11,INITPTR(,PCTPTR)                                0394 01453000
         SLR   @05,@05                                             0394 01454000
         IC    @05,ICTMSGX(,@11)                                   0394 01455000
         SLA   @05,2                                               0394 01456000
         LA    @04,0(@05,@14)                                      0394 01457000
         AL    @04,@CF00539                                        0394 01458000
         L     MSGPTRVR,AHLAD-1(,@04)                              0394 01459000
         LA    MSGPTRVR,0(,MSGPTRVR)                               0394 01460000
*   LENMSG=AHLLEN(ICTMSGX);         /* GET LENGTH OF MSG             */ 01461000
         AL    @14,@CF00539                                        0395 01462000
         SLR   LENMSG,LENMSG                                       0395 01463000
         IC    LENMSG,AHLLEN(@05,@14)                              0395 01464000
*   MSGAREA(1:LENMSG)=              /* MOVE MSG FROM                 */ 01465000
*       AHLMSG(1:LENMSG);           /* AHLTCTL2 TO BUFFER            */ 01466000
         LR    @14,LENMSG                                          0396 01467000
         BCTR  @14,0                                               0396 01468000
         EX    @14,@SM00544                                        0396 01469000
*   GENERATE;                                                      0397 01470000
         L    13,4(0,13)                                                01471000
         L    14,12(0,13)                                               01472000
         LM   0,12,20(13)                                               01473000
*   END AHLCTL2;                                                   0398 01474000
@EL00003 DS    0H                                                  0398 01475000
@EF00003 DS    0H                                                  0398 01476000
@ER00003 BR    @14                                                 0398 01477000
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */ 01478000
*     GPR00F FIXED(31) REG(0),                                     0399 01479000
*     GPR01F FIXED(31) REG(1),                                     0399 01480000
*     GPR00P PTR(31) REG(0),                                       0399 01481000
*     GPR01P PTR(31) REG(1);                                       0399 01482000
*   DECLARE                         /* COMMON VARIABLES              */ 01483000
*     I256C CHAR(256) BASED,                                       0400 01484000
*     I031F FIXED(31) BASED,                                       0400 01485000
*     I031P PTR(31) BASED,                                         0400 01486000
*     I015F FIXED(15) BASED,                                       0400 01487000
*     I015P PTR(15) BASED,                                         0400 01488000
*     I008P PTR(8) BASED,                                          0400 01489000
*     I001C CHAR(1) BASED;          /* EXPAND MACRO VARIBLES Y02014  */ 01490000
*   END AHLTCTL1                                                   0401 01491000
*                                                                  0401 01492000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01493000
*/*%INCLUDE SYSLIB  (GTFPCT  )                                       */ 01494000
*/*%INCLUDE SYSLIB  (INITDATA)                                       */ 01495000
*                                                                  0401 01496000
*       ;                                                          0401 01497000
@DATA    DS    0H                                                       01498000
@SM00535 MVC   MSGHOLD(0),WTORMSG(@14)                                  01499000
@SM00537 MVC   WTOMSG(0,@14),MSGHOLD                                    01500000
@SM00540 MVC   WTOMSG(0,@14),MSG(SMSGPTR)                               01501000
@SM00544 MVC   MSGAREA(0,@11),AHLMSG(MSGPTRVR)                          01502000
         DS    0F                                                       01503000
@SA00001 DS    18F                                                      01504000
         DS    0F                                                       01505000
@CF00055 DC    F'1'                                                     01506000
@CF00060 DC    F'4'                                                     01507000
@CF00308 DC    F'12'                                                    01508000
@CF00232 DC    F'16'                                                    01509000
@CF00244 DC    F'124'                                                   01510000
@CF00539 DC    F'-4'                                                    01511000
@CF00533 DC    XL4'0000FFFF'                                            01512000
@CV00388 DC    V(AHLTPMT)                                               01513000
@CV00389 DC    V(AHLTSCN)                                               01514000
@CV00390 DC    V(AHLTTAB)                                               01515000
@CV00391 DC    V(AHLT103)                                               01516000
@CV00398 DC    V(MSGTBL)                                                01517000
@CV00387 DC    V(AHLTCTL2)                                              01518000
         DS    0D                                                       01519000
NOMEMBR  DC    XL4'13'                                                  01520000
EXPLAD1  DS    A                                                        01521000
MSGTBLAD DC    VL4(MSGTBL)                                              01522000
LISTLEN  DC    AL2(3)                                                   01523000
MAXRPLY  DC    AL2(123)                                                 01524000
@TS00001 DS    CL3                                                      01525000
         DS    CL1                                                      01526000
SVAREA   DS    CL72                                                     01527000
         ORG   SVAREA                                                   01528000
RTRYCODE DS    CL6                                                      01529000
@NM00011 DS    CL2                                                      01530000
REGSAVE  DS    CL64                                                     01531000
         ORG   SVAREA+72                                                01532000
ECBLST   DS    CL8                                                      01533000
         ORG   ECBLST                                                   01534000
WECBAD   DS    AL4                                                      01535000
SECBAD   DS    AL4                                                      01536000
         ORG   SECBAD                                                   01537000
ENDECB   DS    BL1                                                      01538000
         ORG   ECBLST+8                                                 01539000
CLOSPLST DS    CL4                                                      01540000
OPENPLST DS    CL4                                                      01541000
STAEPLST DS    CL8                                                      01542000
TRCEQ    DC    CL6'TRACE='                                              01543000
PLIBNM   DC    CL12'SYS1.PARMLIB'                                       01544000
ZEROWD   DC    X'00000000'                                              01545000
         ORG   ZEROWD                                                   01546000
ZEROCR   DS    CL1                                                      01547000
         ORG   ZEROWD+4                                                 01548000
BLANK    DC    CL8'        '                                            01549000
MSGHOLD  DS    CL75                                                     01550000
CTLPTCH  DS    CL200                                                    01551000
         DS    CL3                                                      01552000
SAV1AREA DC    18A(0)                                                   01553000
SAV2AREA DC    18A(0)                                                   01554000
SAV3AREA DC    18A(0)                                                   01555000
IOROUT   DC    AL4(IO01)                                                01556000
         DC    AL4(IO02)                                                01557000
         DC    AL4(IO03)                                                01558000
         DC    AL4(IO04)                                                01559000
AHLTCTL1 CSECT                                                          01560000
         ENTRY AHLTIO                       /* AHLTIO EXTERNAL Y02014*/ 01561000
         ENTRY AHLCTL2                     /* AHLCTL2 EXTERNAL Y02014*/ 01562000
         ENTRY CTLSTEX                     /* STAE RTN         Y02014*/ 01563000
AHLTCTL1 CSECT                                                          01564000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01565000
@01      EQU   01                                                       01566000
@02      EQU   02                                                       01567000
@03      EQU   03                                                       01568000
@04      EQU   04                                                       01569000
@05      EQU   05                                                       01570000
@06      EQU   06                                                       01571000
@07      EQU   07                                                       01572000
@08      EQU   08                                                       01573000
@09      EQU   09                                                       01574000
@10      EQU   10                                                       01575000
@11      EQU   11                                                       01576000
@12      EQU   12                                                       01577000
@13      EQU   13                                                       01578000
@14      EQU   14                                                       01579000
@15      EQU   15                                                       01580000
SMSGPTR  EQU   @10                                                      01581000
SLENMSG  EQU   @08                                                      01582000
LENMSG   EQU   @09                                                      01583000
MSGPTRVR EQU   @06                                                      01584000
SYNADPTR EQU   @06                                                      01585000
FREEAD   EQU   @08                                                      01586000
R0       EQU   @00                                                      01587000
PARMRG1  EQU   @01                                                      01588000
EXPLAD   EQU   @03                                                      01589000
DCBPTR   EQU   @07                                                      01590000
TRTBLAD  EQU   @07                                                      01591000
SAVREG   EQU   @08                                                      01592000
MSGPTR   EQU   @08                                                      01593000
SAVR     EQU   @13                                                      01594000
RTRNCODE EQU   @15                                                      01595000
RTRYAD   EQU   @15                                                      01596000
PCTPTR   EQU   @02                                                      01597000
GPR01F   EQU   @01                                                      01598000
GPR00F   EQU   @00                                                      01599000
AREAPTR  EQU   @00                                                      01600000
GPR01P   EQU   @01                                                      01601000
GPR00P   EQU   @00                                                      01602000
ENTRYREG EQU   @15                                                      01603000
R15      EQU   @15                                                      01604000
FREETB   EQU   0                                                        01605000
GTFPCT   EQU   0                                                        01606000
GTFSTAT  EQU   GTFPCT+8                                                 01607000
GTFOPTS  EQU   GTFPCT+12                                                01608000
GTFOPTS1 EQU   GTFOPTS                                                  01609000
GTFOPTS2 EQU   GTFOPTS+1                                                01610000
GTFOPTS3 EQU   GTFOPTS+2                                                01611000
GTFOPTS4 EQU   GTFOPTS+3                                                01612000
PCTCATF  EQU   GTFPCT+16                                                01613000
INITPTR  EQU   GTFPCT+60                                                01614000
STOPECBA EQU   GTFPCT+76                                                01615000
NEXTBLOK EQU   GTFPCT+180                                               01616000
WRTRCOM  EQU   GTFPCT+204                                               01617000
TRMWRIT  EQU   GTFPCT+212                                               01618000
WRTRERR  EQU   GTFPCT+216                                               01619000
GTFSSRB  EQU   GTFPCT+220                                               01620000
QLOCKWRD EQU   GTFPCT+236                                               01621000
QLOCKECB EQU   GTFPCT+240                                               01622000
AUDITFLG EQU   GTFPCT+296                                               01623000
INITDATA EQU   0                                                        01624000
ICT      EQU   INITDATA+16                                              01625000
ICTMSGX  EQU   ICT                                                      01626000
ICTIOTYP EQU   ICT+1                                                    01627000
ICTFLAGS EQU   ICT+2                                                    01628000
ICTPLIB  EQU   ICTFLAGS                                                 01629000
ICTIOERR EQU   ICTFLAGS                                                 01630000
ICTEOD   EQU   ICTFLAGS                                                 01631000
ICTRETRY EQU   ICTFLAGS                                                 01632000
ICTTRCIN EQU   ICTFLAGS                                                 01633000
ICTSTOP  EQU   ICTFLAGS                                                 01634000
PARMDCB  EQU   INITDATA+20                                              01635000
WTORECB  EQU   INITDATA+24                                              01636000
MSGREPLY EQU   INITDATA+28                                              01637000
GTFOPIND EQU   INITDATA+152                                             01638000
GTFOPT1  EQU   GTFOPIND                                                 01639000
GTFSYSM  EQU   GTFOPT1                                                  01640000
GTFSYSP  EQU   GTFOPT1                                                  01641000
GTFSYS   EQU   GTFOPT1                                                  01642000
GTFOPT2  EQU   GTFOPIND+1                                               01643000
GTFSVC   EQU   GTFOPT2                                                  01644000
GTFSIO   EQU   GTFOPT2                                                  01645000
GTFPI    EQU   GTFOPT2                                                  01646000
GTFIO    EQU   GTFOPT2                                                  01647000
GTFOPT3  EQU   GTFOPIND+2                                               01648000
GTFEXT   EQU   GTFOPT3                                                  01649000
GTFRR    EQU   GTFOPT3                                                  01650000
GTFOPT4  EQU   GTFOPIND+3                                               01651000
IOTAB    EQU   INITDATA+156                                             01652000
SIOTAB   EQU   INITDATA+160                                             01653000
SVCTAB   EQU   INITDATA+164                                             01654000
PITAB    EQU   INITDATA+168                                             01655000
TWT      EQU   INITDATA+176                                             01656000
TWTWORK  EQU   TWT+8                                                    01657000
TWTBUF   EQU   TWT+40                                                   01658000
STAEXPL  EQU   0                                                        01659000
SAVARAD  EQU   STAEXPL                                                  01660000
CMPCD    EQU   STAEXPL+4                                                01661000
STAEWORK EQU   0                                                        01662000
PARMAD   EQU   STAEWORK                                                 01663000
ABNDCC   EQU   STAEWORK+4                                               01664000
SYNADMSG EQU   0                                                        01665000
SYNUAD   EQU   SYNADMSG+68                                              01666000
SYNOPERR EQU   SYNADMSG+84                                              01667000
SYNAM    EQU   SYNADMSG+122                                             01668000
CTLSAVE  EQU   0                                                        01669000
CALLRSA1 EQU   CTLSAVE+4                                                01670000
CLRSAVE  EQU   0                                                        01671000
GPRS15   EQU   CLRSAVE+16                                               01672000
GPRS0    EQU   CLRSAVE+20                                               01673000
STOPECB  EQU   0                                                        01674000
POSTBIT  EQU   STOPECB                                                  01675000
DCBEXLST EQU   37                                                       01676000
DCBOFLGS EQU   48                                                       01677000
DCBEODAD EQU   32                                                       01678000
AHLMSGTB EQU   0                                                        01679000
AHLLEN   EQU   AHLMSGTB                                                 01680000
AHLAD    EQU   AHLMSGTB+1                                               01681000
MSG      EQU   12                                                       01682000
AHLMSG   EQU   0                                                        01683000
DCBSYNAD EQU   56                                                       01684000
I001C    EQU   0                                                        01685000
I008P    EQU   0                                                        01686000
I015F    EQU   0                                                        01687000
I015P    EQU   0                                                        01688000
I031F    EQU   0                                                        01689000
I031P    EQU   0                                                        01690000
I256C    EQU   0                                                        01691000
JFCB     EQU   TWT+4                                                    01692000
JFCBDSNM EQU   JFCB                                                     01693000
JFCBELNM EQU   JFCB+44                                                  01694000
TXT127   EQU   TWTBUF+36                                                01695000
UNITADR  EQU   TXT127                                                   01696000
OPERR    EQU   TXT127+4                                                 01697000
ACSMETH  EQU   TXT127+27                                                01698000
CLOSLST2 EQU   CLOSLST1                                                 01699000
OPENLST2 EQU   OPENLST1                                                 01700000
STAELST2 EQU   STAELST1                                                 01701000
MSGMEMBR EQU   TWTBUF+20                                                01702000
RTDCD    EQU   TWTBUF+47                                                01703000
MSGCODE  EQU   TWTBUF+44                                                01704000
ELSAV    EQU   TWTWORK+24                                               01705000
RETRYCOD EQU   RTRYRT                                                   01706000
ECBAD    EQU   TWTBUF+4                                                 01707000
RPLYAD   EQU   TWTBUF+1                                                 01708000
WTOMSG   EQU   TWTBUF+4                                                 01709000
WTOLEN   EQU   TWTBUF                                                   01710000
WTORMSG  EQU   TWTBUF+12                                                01711000
WTORLEN  EQU   TWTBUF+8                                                 01712000
AHL127RC EQU   TWTBUF+36                                                01713000
A127RCHD EQU   TWTBUF+70                                                01714000
MSGAREA  EQU   TWTBUF                                                   01715000
RPLYLEN  EQU   TWTBUF                                                   01716000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01717000
WAITBIT  EQU   STOPECB                                                  01718000
@NM00017 EQU   CLRSAVE+24                                               01719000
GPRS14   EQU   CLRSAVE+12                                               01720000
CALLDSA2 EQU   CLRSAVE+8                                                01721000
CALLRSA2 EQU   CLRSAVE+4                                                01722000
@NM00016 EQU   CLRSAVE                                                  01723000
REGS     EQU   CTLSAVE+12                                               01724000
CALLDSA1 EQU   CTLSAVE+8                                                01725000
@NM00015 EQU   CTLSAVE                                                  01726000
@NM00014 EQU   SYNADMSG+107                                             01727000
@NM00013 EQU   SYNADMSG+72                                              01728000
@NM00012 EQU   SYNADMSG                                                 01729000
@NM00010 EQU   TWT+4                                                    01730000
@NM00009 EQU   TWT                                                      01731000
RANGPTR  EQU   INITDATA+172                                             01732000
GTFTIME  EQU   GTFOPT4                                                  01733000
GTFRES3  EQU   GTFOPT4                                                  01734000
GTFIOSIO EQU   GTFOPT3                                                  01735000
GTFRES2  EQU   GTFOPT3                                                  01736000
GTFSRM   EQU   GTFOPT3                                                  01737000
GTFRNIO  EQU   GTFOPT3                                                  01738000
GTFIOP   EQU   GTFOPT2                                                  01739000
GTFPIP   EQU   GTFOPT2                                                  01740000
GTFSIOP  EQU   GTFOPT2                                                  01741000
GTFSVCP  EQU   GTFOPT2                                                  01742000
GTFPCI   EQU   GTFOPT1                                                  01743000
GTFRES1  EQU   GTFOPT1                                                  01744000
GTFDSP   EQU   GTFOPT1                                                  01745000
GTFTRC   EQU   GTFOPT1                                                  01746000
GTFUSR   EQU   GTFOPT1                                                  01747000
ICTRESV  EQU   ICTFLAGS                                                 01748000
EXECPTR  EQU   INITDATA+12                                              01749000
CIBPTR   EQU   INITDATA+8                                               01750000
INITID   EQU   INITDATA                                                 01751000
PCTWTOMD EQU   GTFPCT+312                                               01752000
PCTDMPMD EQU   GTFPCT+308                                               01753000
TRANSMAX EQU   GTFPCT+304                                               01754000
GTFASCB  EQU   GTFPCT+300                                               01755000
@NM00008 EQU   AUDITFLG+3                                               01756000
AFSLEBLD EQU   AUDITFLG+3                                               01757000
WSERFG06 EQU   AUDITFLG+3                                               01758000
WSERFG05 EQU   AUDITFLG+3                                               01759000
WSERFG04 EQU   AUDITFLG+3                                               01760000
WSERFG03 EQU   AUDITFLG+3                                               01761000
WSERFG02 EQU   AUDITFLG+2                                               01762000
WSERFLAG EQU   AUDITFLG+2                                               01763000
TERMFLAG EQU   AUDITFLG+2                                               01764000
AFXWRIT  EQU   AUDITFLG+2                                               01765000
AFQLWAIT EQU   AUDITFLG+2                                               01766000
AFSLEGET EQU   AUDITFLG+2                                               01767000
AFBUFGET EQU   AUDITFLG+2                                               01768000
AFFEOB   EQU   AUDITFLG+2                                               01769000
AFBLKFIX EQU   AUDITFLG+1                                               01770000
AFEQFIX  EQU   AUDITFLG+1                                               01771000
AFPGRLSE EQU   AUDITFLG+1                                               01772000
AFWRAP   EQU   AUDITFLG+1                                               01773000
AFBUFOFF EQU   AUDITFLG+1                                               01774000
AFLDFX   EQU   AUDITFLG+1                                               01775000
AFCLOSE  EQU   AUDITFLG+1                                               01776000
AFOPEN   EQU   AUDITFLG+1                                               01777000
AFGMBLOK EQU   AUDITFLG                                                 01778000
AFGMSRB  EQU   AUDITFLG                                                 01779000
AFWAIT   EQU   AUDITFLG                                                 01780000
AFTERM   EQU   AUDITFLG                                                 01781000
AFINIT   EQU   AUDITFLG                                                 01782000
AFWWRIT  EQU   AUDITFLG                                                 01783000
AFCWRIT  EQU   AUDITFLG                                                 01784000
AFIWRIT  EQU   AUDITFLG                                                 01785000
EQSHORT  EQU   GTFPCT+292                                               01786000
SLEMAX   EQU   GTFPCT+288                                               01787000
SLECNT   EQU   GTFPCT+284                                               01788000
RQPURGE  EQU   GTFPCT+280                                               01789000
RQTOTAL  EQU   GTFPCT+276                                               01790000
WRTDLST  EQU   GTFPCT+272                                               01791000
NUMOFBUF EQU   GTFPCT+268                                               01792000
SBUFDISA EQU   GTFPCT+264                                               01793000
SLESUSED EQU   GTFPCT+260                                               01794000
EQMIN    EQU   GTFPCT+256                                               01795000
EQLENGTH EQU   GTFPCT+252                                               01796000
WQMAX    EQU   GTFPCT+248                                               01797000
WQLENGTH EQU   GTFPCT+244                                               01798000
QLECBP   EQU   QLOCKECB                                                 01799000
@NM00007 EQU   QLOCKECB                                                 01800000
@NM00006 EQU   QLOCKWRD+3                                               01801000
SCHEDBUF EQU   QLOCKWRD+2                                               01802000
POSTWRIT EQU   QLOCKWRD+1                                               01803000
QLOCK    EQU   QLOCKWRD                                                 01804000
WRITERDD EQU   GTFPCT+228                                               01805000
GTFLOSTR EQU   GTFPCT+224                                               01806000
SRBAVAIL EQU   GTFSSRB                                                  01807000
WRTRERRP EQU   WRTRERR                                                  01808000
@NM00005 EQU   WRTRERR                                                  01809000
TRMWRITP EQU   TRMWRIT                                                  01810000
@NM00004 EQU   TRMWRIT                                                  01811000
GTFCMECB EQU   GTFPCT+208                                               01812000
WRTRCOMP EQU   WRTRCOM                                                  01813000
@NM00003 EQU   WRTRCOM                                                  01814000
TRANSCNT EQU   GTFPCT+200                                               01815000
AHLRDPLQ EQU   GTFPCT+196                                               01816000
SFEOBRTN EQU   GTFPCT+192                                               01817000
SBLOKRTN EQU   GTFPCT+188                                               01818000
CURRBLOK EQU   GTFPCT+184                                               01819000
GBCDS    EQU   NEXTBLOK                                                 01820000
WSMODEND EQU   GTFPCT+176                                               01821000
WSMODBEG EQU   GTFPCT+172                                               01822000
BCBPAGE  EQU   GTFPCT+156                                               01823000
SLEPAGE  EQU   GTFPCT+152                                               01824000
SAVECNT  EQU   GTFPCT+148                                               01825000
SLQHEAD  EQU   GTFPCT+144                                               01826000
HQLENGTH EQU   GTFPCT+140                                               01827000
QTAIL    EQU   GTFPCT+136                                               01828000
HQHEAD   EQU   GTFPCT+132                                               01829000
WQHEAD   EQU   GTFPCT+128                                               01830000
RQHEAD   EQU   GTFPCT+124                                               01831000
EQHEAD   EQU   GTFPCT+120                                               01832000
WPOSTSRB EQU   GTFPCT+116                                               01833000
WTSKTCBA EQU   GTFPCT+112                                               01834000
WRTRTCBA EQU   GTFPCT+108                                               01835000
TRMWTASK EQU   GTFPCT+104                                               01836000
WTSKATTH EQU   GTFPCT+100                                               01837000
WTSKINIT EQU   GTFPCT+96                                                01838000
WTASKECB EQU   GTFPCT+92                                                01839000
WMTABPTR EQU   GTFPCT+88                                                01840000
ATTCHECB EQU   GTFPCT+84                                                01841000
AHLECB   EQU   GTFPCT+80                                                01842000
ECBADRLT EQU   GTFPCT+72                                                01843000
FIXLEN   EQU   GTFPCT+68                                                01844000
FIXPTR   EQU   GTFPCT+64                                                01845000
MCQEPTR  EQU   GTFPCT+56                                                01846000
GTFEIDL  EQU   GTFPCT+52                                                01847000
GTFPIBL  EQU   GTFPCT+48                                                01848000
GTFPIFT  EQU   GTFPCT+44                                                01849000
GTFSVCBL EQU   GTFPCT+40                                                01850000
GTFSVCFT EQU   GTFPCT+36                                                01851000
GTFIOBL  EQU   GTFPCT+32                                                01852000
GTFIOFT  EQU   GTFPCT+28                                                01853000
GTFSIOBL EQU   GTFPCT+24                                                01854000
GTFSIOFT EQU   GTFPCT+20                                                01855000
@NM00002 EQU   PCTCATF+1                                                01856000
PCTPIF   EQU   PCTCATF+1                                                01857000
PCTSIOF  EQU   PCTCATF+1                                                01858000
PCTIOF   EQU   PCTCATF+1                                                01859000
PCTSVCF  EQU   PCTCATF+1                                                01860000
PCTRR    EQU   PCTCATF+1                                                01861000
PCTSRM   EQU   PCTCATF+1                                                01862000
PCTRNIO  EQU   PCTCATF+1                                                01863000
PCTUSR   EQU   PCTCATF                                                  01864000
PCTPI    EQU   PCTCATF                                                  01865000
@NM00001 EQU   PCTCATF                                                  01866000
PCTDSP   EQU   PCTCATF                                                  01867000
PCTSIO   EQU   PCTCATF                                                  01868000
PCTIO    EQU   PCTCATF                                                  01869000
PCTEXT   EQU   PCTCATF                                                  01870000
PCTSVC   EQU   PCTCATF                                                  01871000
OPTTIME  EQU   GTFOPTS4                                                 01872000
OPTRES3  EQU   GTFOPTS4                                                 01873000
OPTIOSIO EQU   GTFOPTS3                                                 01874000
OPTRES2  EQU   GTFOPTS3                                                 01875000
OPTRR    EQU   GTFOPTS3                                                 01876000
OPTSRM   EQU   GTFOPTS3                                                 01877000
OPTRNIO  EQU   GTFOPTS3                                                 01878000
OPTEXT   EQU   GTFOPTS3                                                 01879000
OPTIOP   EQU   GTFOPTS2                                                 01880000
OPTIO    EQU   GTFOPTS2                                                 01881000
OPTPIP   EQU   GTFOPTS2                                                 01882000
OPTPI    EQU   GTFOPTS2                                                 01883000
OPTSIOP  EQU   GTFOPTS2                                                 01884000
OPTSIO   EQU   GTFOPTS2                                                 01885000
OPTSVCP  EQU   GTFOPTS2                                                 01886000
OPTSVC   EQU   GTFOPTS2                                                 01887000
OPTPCI   EQU   GTFOPTS1                                                 01888000
OPTRES1  EQU   GTFOPTS1                                                 01889000
OPTDSP   EQU   GTFOPTS1                                                 01890000
OPTTRC   EQU   GTFOPTS1                                                 01891000
OPTUSR   EQU   GTFOPTS1                                                 01892000
OPTSYS   EQU   GTFOPTS1                                                 01893000
OPTSYSP  EQU   GTFOPTS1                                                 01894000
OPTSYSM  EQU   GTFOPTS1                                                 01895000
GTFRESV  EQU   GTFSTAT                                                  01896000
GTFDEBUG EQU   GTFSTAT                                                  01897000
GTFMODE  EQU   GTFSTAT                                                  01898000
GTFPCTID EQU   GTFPCT                                                   01899000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01900000
@RT00085 EQU   CTL03                                                    01901000
@RT00087 EQU   CTL03                                                    01902000
@RT00094 EQU   CTL02                                                    01903000
@RT00118 EQU   CTL06                                                    01904000
@RT00120 EQU   CTL07                                                    01905000
@RT00122 EQU   CTL04                                                    01906000
@RT00125 EQU   CTL06                                                    01907000
@RT00127 EQU   CTL07                                                    01908000
@RT00143 EQU   CTL04B                                                   01909000
@RT00160 EQU   CTL05B                                                   01910000
@RT00163 EQU   CTL06                                                    01911000
@RT00179 EQU   CTL05A                                                   01912000
@RT00189 EQU   CTL08                                                    01913000
@RT00195 EQU   CTL10                                                    01914000
@RT00197 EQU   CTL09                                                    01915000
@RT00208 EQU   CTL11                                                    01916000
@RT00219 EQU   CTL12                                                    01917000
@RT00230 EQU   CTL13                                                    01918000
@RT00249 EQU   CTL14                                                    01919000
@RT00274 EQU   CTL15                                                    01920000
@RT00305 EQU   IO00                                                     01921000
@ENDDATA EQU   *                                                        01922000
         END   AHLTCTL1,(C'PLS2342',0603,76167)                         01923000
