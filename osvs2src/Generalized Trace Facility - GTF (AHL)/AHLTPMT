         TITLE 'AHLTPMT- GTF EVENT SELECTION PROMPTING MODULE          *00001000
                       '                                                00002000
AHLTPMT  CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'AHLTPMT   73.240'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @11,0                                               0001 00011000
@PSTART  LA    @12,4095(,@11)                                      0001 00012000
         USING @PSTART,@11                                         0001 00013000
         USING @PSTART+4095,@12                                    0001 00014000
         ST    @13,@SA00001+4                                      0001 00015000
         LA    @14,@SA00001                                        0001 00016000
         ST    @14,8(,@13)                                         0001 00017000
         LR    @13,@14                                             0001 00018000
*                                                                  0053 00019000
*/********************************************************************/ 00020000
*/*                                                                  */ 00021000
*/* INITIALIZATION                                                   */ 00022000
*/*                                                                  */ 00023000
*/********************************************************************/ 00024000
*                                                                  0053 00025000
*   ENDPTRS=ENDPTRS&&ENDPTRS;       /* CLEAR DEV TBL ENDPTRS:      0053 00026000
*                                      IOEND,SIOEND,SVCEND, PIEND  0053 00027000
*                                                              Y02014*/ 00028000
*                                                                  0053 00029000
         XC    ENDPTRS(16),ENDPTRS                                 0053 00030000
*/********************************************************************/ 00031000
*/*                                                                  */ 00032000
*/* GET THE MESSAGE TEXT FOR AHL101A AND BUILD THE DETAIL PORTION    */ 00033000
*/* WHILE GETTING CORE FOR THE NECESSARY FILTER TABLES               */ 00034000
*/*                                                                  */ 00035000
*/********************************************************************/ 00036000
*                                                                  0054 00037000
*   ICTMSGX=2;                      /* SET THE INDEX FOR MSG #     0054 00038000
*                                      AHL101A                       */ 00039000
         L     @10,INITPTR(,PCTPTR)                                0054 00040000
         MVI   ICTMSGX(@10),X'02'                                  0054 00041000
*   TWTBUF(1:152)='';               /* BLANK OUT MSG BUFFER    Y02014*/ 00042000
         MVI   TWTBUF(@10),C' '                                    0055 00043000
         MVC   TWTBUF+1(151,@10),TWTBUF(@10)                       0055 00044000
*   CALL AHLCTL2;                   /* THEN BRANCH TO AHLCTL2 WHICH     00045000
*                                      WILL PUT THE MSG INDICATED  0056 00046000
*                                      INTO THE BUFFER INDICATED   0056 00047000
*                                                              Y02014*/ 00048000
         L     @15,@CV00346                                        0056 00049000
         BALR  @14,@15                                             0056 00050000
*   MSGPTR=ADDR(TWTBUF)+WTOLEN+8;   /* SET THIS POINTER TO THE END OF   00051000
*                                      THE MSG WHICH IS IN WTO FORMAT   00052000
*                                      & BEGINS 8 BYTES INTO THE   0057 00053000
*                                      BUFFER                        */ 00054000
         L     @10,INITPTR(,PCTPTR)                                0057 00055000
         LA    MSGPTR,TWTBUF(,@10)                                 0057 00056000
         LH    @15,WTOLEN(,@10)                                    0057 00057000
         AR    MSGPTR,@15                                          0057 00058000
         AH    MSGPTR,@CH00038                                     0057 00059000
*   TWTWORK(1:4)=RTDCODE;           /* SAVE THE ROUT&DESC CODES THAT    00060000
*                                      ARE AT THE END OF THE WTO MSG    00061000
*                                      SO THAT THEY CAN BE RESTORED     00062000
*                                      AFTER THE MSG HAS BEEN ADDED     00063000
*                                      TO                            */ 00064000
         MVC   TWTWORK(4,@10),RTDCODE(MSGPTR)                      0058 00065000
*                                                                  0059 00066000
*/********************************************************************/ 00067000
*/*                                                                  */ 00068000
*/* IF THE IO BIT IS ON ADD TO THE MESSAGE TEXT 'IO=,' AND GET CORE  */ 00069000
*/* FOR THE IO EBCDIC  TABLE                                         */ 00070000
*/*                                                                  */ 00071000
*/********************************************************************/ 00072000
*                                                                  0059 00073000
*   IF GTFIOP='0'B                  /* IS THERE TO BE ANY IO       0059 00074000
*                                      PROMPTING?              Y02014*/ 00075000
*     THEN                          /* NO IO PROMPTING               */ 00076000
         TM    GTFIOP(@10),B'00000001'                             0059 00077000
         BZ    @RT00059                                            0059 00078000
*     GO TO PMT01;                  /* SO GO TEST FOR SIO            */ 00079000
*   MESSAGE(1:7)=PMTAB(1);          /* YES SO PLACE IO= INTO THE MSG    00080000
*                                      TO INDICATE IT IS EXPECTED    */ 00081000
         MVC   MESSAGE(7,MSGPTR),PMTAB                             0061 00082000
*   MESSAGE(4)=',';                 /* PUT IN A COMMA                */ 00083000
         MVI   MESSAGE+3(MSGPTR),C','                              0062 00084000
*   MSGPTR=MSGPTR+4;                /* MOVE THE POINTER TO THE NEW 0063 00085000
*                                      END OF THE MSG                */ 00086000
         LA    @14,4                                               0063 00087000
         AR    MSGPTR,@14                                          0063 00088000
*   WTOLEN=WTOLEN+4;                /* INCREASE THE 2 BYTE MSG LENGTH   00089000
*                                      FIELD AT THE BEGINNING OF THE    00090000
*                                      MSG                           */ 00091000
*                                                                  0064 00092000
         AR    @15,@14                                             0064 00093000
         STH   @15,WTOLEN(,@10)                                    0064 00094000
*/* PERFORM GETMAIN FOR IO EBCDIC  TABLE                       Y02014*/ 00095000
*                                                                  0065 00096000
*   RFY                                                            0065 00097000
*     RETCODE RSTD;                                                0065 00098000
*   DO;                             /* GETMAIN (EC) LV(153)        0066 00099000
*                                      A(GETFREE) SP(0) RTCD(RETCODE)*/ 00100000
*     RESPECIFY                                                    0067 00101000
*      (GPR01P,                                                    0067 00102000
*       GPR15F)RESTRICTED;                                         0067 00103000
*     I004=I004&&I004;              /* INIT LIST                     */ 00104000
         XC    I004(10),I004                                       0068 00105000
*     I00404='20'X;                 /* TYPE                          */ 00106000
         MVI   I00404,X'20'                                        0069 00107000
*     I00401=153;                   /* LENGTH                        */ 00108000
         MVC   I00401(4),@CF00406                                  0070 00109000
*     I00403=ADDR(GETFREE);         /* ADDR OF ADDR LIST             */ 00110000
         LA    @14,GETFREE                                         0071 00111000
         STCM  @14,7,I00403                                        0071 00112000
*     I00405=0;                     /* SUBPOOL VALUE                 */ 00113000
         MVI   I00405,X'00'                                        0072 00114000
*     GPR01P=ADDR(I004);            /* REG1 POINTS TO LIST           */ 00115000
         LA    GPR01P,I004                                         0073 00116000
*     SVC(4);                       /* STANDARD-FORM OF GETMAIN      */ 00117000
         SVC   4                                                   0074 00118000
*     RETCODE=GPR15F;               /* SET RETURN CODE               */ 00119000
*     RESPECIFY                                                    0076 00120000
*      (GPR01P,                                                    0076 00121000
*       GPR15F)UNRESTRICTED;                                       0076 00122000
*   END;                            /* GETMAIN (EC) LV(153)        0077 00123000
*                                      A(GETFREE) SP(0) RTCD(RETCODE)*/ 00124000
*                                   /* Y02014                        */ 00125000
*   IF RETCODE^=0                   /* DID GETMAIN GO OK       Y02014*/ 00126000
*     THEN                                                         0078 00127000
         LTR   RETCODE,RETCODE                                     0078 00128000
         BZ    @RF00078                                            0078 00129000
*     DO;                           /* NO                      Y02014*/ 00130000
*       ICTMSGX=28;                 /* SET INDEX FOR MSG AHL130I   0080 00131000
*                                                              Y02014*/ 00132000
         L     @14,INITPTR(,PCTPTR)                                0080 00133000
         MVI   ICTMSGX(@14),X'1C'                                  0080 00134000
*       ICTIOTYP=2;                 /* SET IO TYPE WTO         Y02014*/ 00135000
         MVI   ICTIOTYP(@14),X'02'                                 0081 00136000
*       CALL AHLTIO;                /* PRINT MSG               Y02014*/ 00137000
         L     @15,@CV00303                                        0082 00138000
         BALR  @14,@15                                             0082 00139000
*       GO TO PMT71;                /* SET RETURN CODE AND EXIT    0083 00140000
*                                                              Y02014*/ 00141000
         B     PMT71                                               0083 00142000
*     END;                                                         0084 00143000
*   RFY                                                            0085 00144000
*     RETCODE UNRSTD;                                              0085 00145000
@RF00078 DS    0H                                                  0086 00146000
*   IOTAB=GETFREE;                  /* GETMAIN OK SO PLACE ADDR OF 0086 00147000
*                                      STORAGE IN INITDATA     Y02014*/ 00148000
         L     @10,GETFREE                                         0086 00149000
         L     @05,INITPTR(,PCTPTR)                                0086 00150000
         ST    @10,IOTAB(,@05)                                     0086 00151000
*   OPPTR=GETFREE;                  /* SET THE POINTER FOR THE TABLE    00152000
*                                      CURRENTLY BEING WORKED ON   0087 00153000
*                                                              Y02014*/ 00154000
*                                                                  0087 00155000
         LR    OPPTR,@10                                           0087 00156000
*/* THE FOLLOWING STATEMENT ZEROS OUT THE IO EBCDIC TABLE      Y02014*/ 00157000
*                                                                  0088 00158000
*   ENTRYTBL(1:153)=ENTRYTBL(1:153)&&ENTRYTBL(1:153);              0088 00159000
         XC    ENTRYTBL(153,OPPTR),ENTRYTBL(OPPTR)                 0088 00160000
*   IOFTPTR=OPPTR;                  /* SET THE POINTER THAT POINTS TO   00161000
*                                      THE NEXT SLOT I IN THE TABLE     00162000
*                                      TO BE FILLED TO THE BEGINNING    00163000
*                                      OF THE TABLE                  */ 00164000
         ST    OPPTR,IOFTPTR                                       0089 00165000
*   IOEND=OPPTR;                    /* INITIALIZE THE RESET POINTER     00166000
*                                      THE SAME                      */ 00167000
         ST    OPPTR,IOEND                                         0090 00168000
*   ENTRYTBL(151:153)=ELIND;        /* PLACE THE END OF LIST FLAGS IN   00169000
*                                      THE LAST SLOT IN THE TABLE    */ 00170000
         MVC   ENTRYTBL+150(3,OPPTR),ELIND                         0091 00171000
*                                                                  0092 00172000
*/********************************************************************/ 00173000
*/*                                                                  */ 00174000
*/* IF THE SIO BIT IS ON ADD TO THE MESSAGE TEXT 'SIO=,' AND GET CORE*/ 00175000
*/* FOR THE SIO EBCDIC  TABLE                                        */ 00176000
*/*                                                                  */ 00177000
*/********************************************************************/ 00178000
*                                                                  0092 00179000
*PMT01:                                                            0092 00180000
*   IF GTFSIOP='0'B                 /* IS THERE TO BE ANY SIO      0092 00181000
*                                      PROMPTING?              Y02014*/ 00182000
*     THEN                          /* NO THERE ISN'T SO             */ 00183000
PMT01    L     @10,INITPTR(,PCTPTR)                                0092 00184000
         TM    GTFSIOP(@10),B'00010000'                            0092 00185000
         BZ    @RT00092                                            0092 00186000
*     GO TO PMT02;                  /* GO TEST FOR SVC               */ 00187000
*   MESSAGE(1:7)=PMTAB(2);          /* ADD SIO= TO THE END OF THE MSG   00188000
*                                      TEXT                          */ 00189000
         MVC   MESSAGE(7,MSGPTR),PMTAB+7                           0094 00190000
*   MESSAGE(5)=',';                 /* PUT IN A COMMA                */ 00191000
         MVI   MESSAGE+4(MSGPTR),C','                              0095 00192000
*   MSGPTR=MSGPTR+5;                /* MOVE THE POINTER OUT TO THE 0096 00193000
*                                      NEW MSG END                   */ 00194000
         LA    @15,5                                               0096 00195000
         AR    MSGPTR,@15                                          0096 00196000
*   WTOLEN=WTOLEN+5;                /* INCREMENT THE 2 BYTE WTO    0097 00197000
*                                      LENGTH FIELD                  */ 00198000
*                                                                  0097 00199000
         AH    @15,WTOLEN(,@10)                                    0097 00200000
         STH   @15,WTOLEN(,@10)                                    0097 00201000
*/* PERFORM GETMAIN FOR SIO EBCDIC TABLE                       Y02014*/ 00202000
*                                                                  0098 00203000
*   RFY                                                            0098 00204000
*     RETCODE RSTD;                                                0098 00205000
*   DO;                             /* GETMAIN (EC) LV(153)        0099 00206000
*                                      A(GETFREE) SP(0) RTCD(RETCODE)*/ 00207000
*     RESPECIFY                                                    0100 00208000
*      (GPR01P,                                                    0100 00209000
*       GPR15F)RESTRICTED;                                         0100 00210000
*     I004=I004&&I004;              /* INIT LIST                     */ 00211000
         XC    I004(10),I004                                       0101 00212000
*     I00404='20'X;                 /* TYPE                          */ 00213000
         MVI   I00404,X'20'                                        0102 00214000
*     I00401=153;                   /* LENGTH                        */ 00215000
         MVC   I00401(4),@CF00406                                  0103 00216000
*     I00403=ADDR(GETFREE);         /* ADDR OF ADDR LIST             */ 00217000
         LA    @14,GETFREE                                         0104 00218000
         STCM  @14,7,I00403                                        0104 00219000
*     I00405=0;                     /* SUBPOOL VALUE                 */ 00220000
         MVI   I00405,X'00'                                        0105 00221000
*     GPR01P=ADDR(I004);            /* REG1 POINTS TO LIST           */ 00222000
         LA    GPR01P,I004                                         0106 00223000
*     SVC(4);                       /* STANDARD-FORM OF GETMAIN      */ 00224000
         SVC   4                                                   0107 00225000
*     RETCODE=GPR15F;               /* SET RETURN CODE               */ 00226000
*     RESPECIFY                                                    0109 00227000
*      (GPR01P,                                                    0109 00228000
*       GPR15F)UNRESTRICTED;                                       0109 00229000
*   END;                            /* GETMAIN (EC) LV(153)        0110 00230000
*                                      A(GETFREE) SP(0) RTCD(RETCODE)*/ 00231000
*   IF RETCODE^=0                   /* DID GETMAIN GO OK       Y02014*/ 00232000
*     THEN                                                         0111 00233000
         LTR   RETCODE,RETCODE                                     0111 00234000
         BZ    @RF00111                                            0111 00235000
*     DO;                           /* NO                      Y02014*/ 00236000
*       ICTMSGX=28;                 /* SET INDEX FOR MSG AHL130I   0113 00237000
*                                                              Y02014*/ 00238000
         L     @14,INITPTR(,PCTPTR)                                0113 00239000
         MVI   ICTMSGX(@14),X'1C'                                  0113 00240000
*       ICTIOTYP=2;                 /* SET IO TYPE WTO         Y02014*/ 00241000
         MVI   ICTIOTYP(@14),X'02'                                 0114 00242000
*       CALL AHLTIO;                /* PRINT MSG               Y02014*/ 00243000
         L     @15,@CV00303                                        0115 00244000
         BALR  @14,@15                                             0115 00245000
*       GO TO PMT71;                /* SET RETURN CODE AND EXIT    0116 00246000
*                                                              Y02014*/ 00247000
         B     PMT71                                               0116 00248000
*     END;                                                         0117 00249000
*   RFY                                                            0118 00250000
*     RETCODE UNRSTD;                                              0118 00251000
@RF00111 DS    0H                                                  0119 00252000
*   SIOTAB=GETFREE;                 /* GETMAIN OK SO PLACE ADDR OF 0119 00253000
*                                      STORAGE IN INITDATA     Y02014*/ 00254000
         L     @10,GETFREE                                         0119 00255000
         L     @05,INITPTR(,PCTPTR)                                0119 00256000
         ST    @10,SIOTAB(,@05)                                    0119 00257000
*   OPPTR=GETFREE;                  /* SET THE POINTER FOR THE TABLE    00258000
*                                      CURRENTLY BEING WORKED ON   0120 00259000
*                                                              Y02014*/ 00260000
*                                                                  0120 00261000
         LR    OPPTR,@10                                           0120 00262000
*/* THE FOLLOWING STATEMENT ZEROS OUT THE SIO EBCDIC TABLE     Y02014*/ 00263000
*                                                                  0121 00264000
*   ENTRYTBL(1:153)=ENTRYTBL(1:153)&&ENTRYTBL(1:153);              0121 00265000
         XC    ENTRYTBL(153,OPPTR),ENTRYTBL(OPPTR)                 0121 00266000
*   SIOFTPTR=OPPTR;                 /* INITIALIZE THIS POINTER TO THE   00267000
*                                      NEXT AVAILABLE SLOT IN THE SIO   00268000
*                                      F.T.                          */ 00269000
         ST    OPPTR,SIOFTPTR                                      0122 00270000
*   SIOEND=OPPTR;                   /* INITIALIZE THE RESET POINTER     00271000
*                                      THE SAME                      */ 00272000
         ST    OPPTR,SIOEND                                        0123 00273000
*   ENTRYTBL(151:153)=ELIND;        /* PUT THE END OF TABLE FLAG IN     00274000
*                                      THE TABLE                     */ 00275000
         MVC   ENTRYTBL+150(3,OPPTR),ELIND                         0124 00276000
*                                                                  0125 00277000
*/********************************************************************/ 00278000
*/*                                                                  */ 00279000
*/* IF THE SVC BIT IS ON ADD TO THE MESSAGE TEXT 'SVC=,' AND GET CORE*/ 00280000
*/* FOR THE SVC EBCDIC  TABLE                                        */ 00281000
*/*                                                                  */ 00282000
*/********************************************************************/ 00283000
*                                                                  0125 00284000
*PMT02:                                                            0125 00285000
*   IF GTFSVCP='0'B                 /* IS THERE TO BE ANY SVC      0125 00286000
*                                      PROMPTING               Y02014*/ 00287000
*     THEN                          /* NO THERE ISN'T SO             */ 00288000
PMT02    L     @10,INITPTR(,PCTPTR)                                0125 00289000
         TM    GTFSVCP(@10),B'01000000'                            0125 00290000
         BZ    @RT00125                                            0125 00291000
*     GO TO PMT03;                  /* GO TEST FOR PI                */ 00292000
*   MESSAGE(1:7)=PMTAB(3);          /* YES THERE IS SO ADD SVC= TO 0127 00293000
*                                      THE MSG                       */ 00294000
         MVC   MESSAGE(7,MSGPTR),PMTAB+14                          0127 00295000
*   MESSAGE(5)=',';                 /* PUT IN A COMMA                */ 00296000
         MVI   MESSAGE+4(MSGPTR),C','                              0128 00297000
*   MSGPTR=MSGPTR+5;                /* INCREMENT THE POINTER TO THE     00298000
*                                      NEW END OF THE MESSAGE        */ 00299000
         LA    @15,5                                               0129 00300000
         AR    MSGPTR,@15                                          0129 00301000
*   WTOLEN=WTOLEN+5;                /* INCREASE THE MESSAGE LENGTH 0130 00302000
*                                      FIELD IN THE WTO MSG FORMAT   */ 00303000
*                                                                  0130 00304000
         AH    @15,WTOLEN(,@10)                                    0130 00305000
         STH   @15,WTOLEN(,@10)                                    0130 00306000
*/* PERFORM GETMAIN FOR SVC EBCDIC TABLE                       Y02014*/ 00307000
*                                                                  0131 00308000
*   RFY                                                            0131 00309000
*     RETCODE RSTD;                                                0131 00310000
*   DO;                             /* GETMAIN (EC) LV(153)        0132 00311000
*                                      A(GETFREE) SP(0) RTCD(RETCODE)*/ 00312000
*     RESPECIFY                                                    0133 00313000
*      (GPR01P,                                                    0133 00314000
*       GPR15F)RESTRICTED;                                         0133 00315000
*     I004=I004&&I004;              /* INIT LIST                     */ 00316000
         XC    I004(10),I004                                       0134 00317000
*     I00404='20'X;                 /* TYPE                          */ 00318000
         MVI   I00404,X'20'                                        0135 00319000
*     I00401=153;                   /* LENGTH                        */ 00320000
         MVC   I00401(4),@CF00406                                  0136 00321000
*     I00403=ADDR(GETFREE);         /* ADDR OF ADDR LIST             */ 00322000
         LA    @14,GETFREE                                         0137 00323000
         STCM  @14,7,I00403                                        0137 00324000
*     I00405=0;                     /* SUBPOOL VALUE                 */ 00325000
         MVI   I00405,X'00'                                        0138 00326000
*     GPR01P=ADDR(I004);            /* REG1 POINTS TO LIST           */ 00327000
         LA    GPR01P,I004                                         0139 00328000
*     SVC(4);                       /* STANDARD-FORM OF GETMAIN      */ 00329000
         SVC   4                                                   0140 00330000
*     RETCODE=GPR15F;               /* SET RETURN CODE               */ 00331000
*     RESPECIFY                                                    0142 00332000
*      (GPR01P,                                                    0142 00333000
*       GPR15F)UNRESTRICTED;                                       0142 00334000
*   END;                            /* GETMAIN (EC) LV(153)        0143 00335000
*                                      A(GETFREE) SP(0) RTCD(RETCODE)*/ 00336000
*   IF RETCODE^=0                   /* DID GETMAIN GO OK       Y02014*/ 00337000
*     THEN                                                         0144 00338000
         LTR   RETCODE,RETCODE                                     0144 00339000
         BZ    @RF00144                                            0144 00340000
*     DO;                           /* NO                      Y02014*/ 00341000
*       ICTMSGX=28;                 /* SET INDEX FOR MSG AHL130I   0146 00342000
*                                                              Y02014*/ 00343000
         L     @14,INITPTR(,PCTPTR)                                0146 00344000
         MVI   ICTMSGX(@14),X'1C'                                  0146 00345000
*       ICTIOTYP=2;                 /* SET IO TYPE WTO         Y02014*/ 00346000
         MVI   ICTIOTYP(@14),X'02'                                 0147 00347000
*       CALL AHLTIO;                /* PRINT MSG               Y02014*/ 00348000
         L     @15,@CV00303                                        0148 00349000
         BALR  @14,@15                                             0148 00350000
*       GO TO PMT71;                /* SET RETURN CODE AND EXIT    0149 00351000
*                                                              Y02014*/ 00352000
         B     PMT71                                               0149 00353000
*     END;                                                         0150 00354000
*   RFY                                                            0151 00355000
*     RETCODE UNRSTD;                                              0151 00356000
@RF00144 DS    0H                                                  0152 00357000
*   SVCTAB=GETFREE;                 /* GETMAIN OK SO PLACE ADDR OF 0152 00358000
*                                      STORAGE IN INITDATA     Y02014*/ 00359000
         L     @10,GETFREE                                         0152 00360000
         L     @05,INITPTR(,PCTPTR)                                0152 00361000
         ST    @10,SVCTAB(,@05)                                    0152 00362000
*   OPPTR=GETFREE;                  /* SET THE POINTER FOR THE TABLE    00363000
*                                      CURRENTLY BEING WORKED ON   0153 00364000
*                                                              Y02014*/ 00365000
*                                                                  0153 00366000
         LR    OPPTR,@10                                           0153 00367000
*/* THE FOLLOWING STATEMENT ZEROS OUT THE SVC EBCDIC TABLE     Y02014*/ 00368000
*                                                                  0154 00369000
*   ENTRYTBL(1:153)=ENTRYTBL(1:153)&&ENTRYTBL(1:153);              0154 00370000
         XC    ENTRYTBL(153,OPPTR),ENTRYTBL(OPPTR)                 0154 00371000
*   SVCFIPTR=OPPTR;                 /* INITIALIZE THE PTR TO THE NEXT   00372000
*                                      EMPTY SLOT IN THE TABLE       */ 00373000
         ST    OPPTR,SVCFIPTR                                      0155 00374000
*   SVCEND=OPPTR;                   /* AND INITIALIZE THE RESET PTR     00375000
*                                      THE SAME                      */ 00376000
         ST    OPPTR,SVCEND                                        0156 00377000
*   ENTRYTBL(151:153)=ELIND;        /* PUT THE END OF TABLE FLAG AT     00378000
*                                      THE END                       */ 00379000
         MVC   ENTRYTBL+150(3,OPPTR),ELIND                         0157 00380000
*                                                                  0158 00381000
*/********************************************************************/ 00382000
*/*                                                                  */ 00383000
*/* IF THE PI BIT IS ON ADD TO THE MESSAGE TEXT 'PI=,' AND GET CORE  */ 00384000
*/* FOR THE PI EBCDIC  TABLE                                         */ 00385000
*/*                                                                  */ 00386000
*/********************************************************************/ 00387000
*                                                                  0158 00388000
*PMT03:                                                            0158 00389000
*   IF GTFPIP='0'B                  /* IS THERE TO BE PI PROMTING? 0158 00390000
*                                                              Y02014*/ 00391000
*     THEN                          /* NO PI PROMPTING SO            */ 00392000
PMT03    L     @10,INITPTR(,PCTPTR)                                0158 00393000
         TM    GTFPIP(@10),B'00000100'                             0158 00394000
         BZ    @RT00158                                            0158 00395000
*     GO TO PMT04;                  /* GO TEST FOR IO=SIO            */ 00396000
*   MESSAGE(1:7)=PMTAB(4);          /* YES THERE IS SO ADD PI= TO THE   00397000
*                                      END OF THE WTO MSG IN THE   0160 00398000
*                                      BUFFER                        */ 00399000
         MVC   MESSAGE(7,MSGPTR),PMTAB+21                          0160 00400000
*   MESSAGE(4)=',';                 /* PUT IN A COMMA                */ 00401000
         MVI   MESSAGE+3(MSGPTR),C','                              0161 00402000
*   MSGPTR=MSGPTR+4;                /* MOVE THE PTR TO THE NEW END OF   00403000
*                                      THE MSG                       */ 00404000
         LA    @15,4                                               0162 00405000
         AR    MSGPTR,@15                                          0162 00406000
*   WTOLEN=WTOLEN+4;                /* AND INCREMENT THE 2 BYTE WTO     00407000
*                                      LENGTH FIELD BY 4             */ 00408000
*                                                                  0163 00409000
         AH    @15,WTOLEN(,@10)                                    0163 00410000
         STH   @15,WTOLEN(,@10)                                    0163 00411000
*/* PERFORM GETMAIN FOR PI EBCDIC  TABLE                       Y02014*/ 00412000
*                                                                  0164 00413000
*   RFY                                                            0164 00414000
*     RETCODE RSTD;                                                0164 00415000
*   DO;                             /* GETMAIN (EC) LV(60) A(GETFREE)   00416000
*                                      SP(0) RTCD(RETCODE)           */ 00417000
*     RESPECIFY                                                    0166 00418000
*      (GPR01P,                                                    0166 00419000
*       GPR15F)RESTRICTED;                                         0166 00420000
*     I004=I004&&I004;              /* INIT LIST                     */ 00421000
         XC    I004(10),I004                                       0167 00422000
*     I00404='20'X;                 /* TYPE                          */ 00423000
         MVI   I00404,X'20'                                        0168 00424000
*     I00401=60;                    /* LENGTH                        */ 00425000
         MVC   I00401(4),@CF00420                                  0169 00426000
*     I00403=ADDR(GETFREE);         /* ADDR OF ADDR LIST             */ 00427000
         LA    @14,GETFREE                                         0170 00428000
         STCM  @14,7,I00403                                        0170 00429000
*     I00405=0;                     /* SUBPOOL VALUE                 */ 00430000
         MVI   I00405,X'00'                                        0171 00431000
*     GPR01P=ADDR(I004);            /* REG1 POINTS TO LIST           */ 00432000
         LA    GPR01P,I004                                         0172 00433000
*     SVC(4);                       /* STANDARD-FORM OF GETMAIN      */ 00434000
         SVC   4                                                   0173 00435000
*     RETCODE=GPR15F;               /* SET RETURN CODE               */ 00436000
*     RESPECIFY                                                    0175 00437000
*      (GPR01P,                                                    0175 00438000
*       GPR15F)UNRESTRICTED;                                       0175 00439000
*   END;                            /* GETMAIN (EC) LV(60) A(GETFREE)   00440000
*                                      SP(0) RTCD(RETCODE)           */ 00441000
*   IF RETCODE^=0                   /* DID GETMAIN GO OK       Y02014*/ 00442000
*     THEN                                                         0177 00443000
         LTR   RETCODE,RETCODE                                     0177 00444000
         BZ    @RF00177                                            0177 00445000
*     DO;                           /* NO                      Y02014*/ 00446000
*       ICTMSGX=28;                 /* SET INDEX FOR MSG AHL130I   0179 00447000
*                                                              Y02014*/ 00448000
         L     @14,INITPTR(,PCTPTR)                                0179 00449000
         MVI   ICTMSGX(@14),X'1C'                                  0179 00450000
*       ICTIOTYP=2;                 /* SET IO TYPE WTO         Y02014*/ 00451000
         MVI   ICTIOTYP(@14),X'02'                                 0180 00452000
*       CALL AHLTIO;                /* PRINT MSG               Y02014*/ 00453000
         L     @15,@CV00303                                        0181 00454000
         BALR  @14,@15                                             0181 00455000
*       GO TO PMT71;                /* SET RETURN CDE AND EXIT Y02014*/ 00456000
         B     PMT71                                               0182 00457000
*     END;                                                         0183 00458000
*   RFY                                                            0184 00459000
*     RETCODE UNRSTD;                                              0184 00460000
@RF00177 DS    0H                                                  0185 00461000
*   PITAB=GETFREE;                  /* GETMAIN OK SO PLACE ADDR OF 0185 00462000
*                                      STORAGE IN INITDATA     Y02014*/ 00463000
         L     @10,GETFREE                                         0185 00464000
         L     @05,INITPTR(,PCTPTR)                                0185 00465000
         ST    @10,PITAB(,@05)                                     0185 00466000
*   OPPTR=GETFREE;                  /* SET THE POINTER FOR THE TABLE    00467000
*                                      CURRENTLY BEING WORKED ON   0186 00468000
*                                                              Y02014*/ 00469000
*                                                                  0186 00470000
         LR    OPPTR,@10                                           0186 00471000
*/* THE FOLLOWING STATEMENT ZEROS OUT THE PI EBCDIC TABLE      Y02014*/ 00472000
*                                                                  0187 00473000
*   ENTRYTBL(1:60)=ENTRYTBL(1:60)&&ENTRYTBL(1:60);                 0187 00474000
         XC    ENTRYTBL(60,OPPTR),ENTRYTBL(OPPTR)                  0187 00475000
*   PIFIPTR=OPPTR;                  /* INITIALIZE THE CURRENT ENTRY     00476000
*                                      POINTER TO THE NEXT EMPTY SLOT*/ 00477000
         ST    OPPTR,PIFIPTR                                       0188 00478000
*   PIEND=OPPTR;                    /* INITIALIZE THE RESET POINTER     00479000
*                                      THE SAME                      */ 00480000
         ST    OPPTR,PIEND                                         0189 00481000
*   ENTRYTBL(58:60)=ELIND;          /* PUT THE END OF TABLE FLAG IN     00482000
*                                      AT THE END                    */ 00483000
         MVC   ENTRYTBL+57(3,OPPTR),ELIND                          0190 00484000
*                                                                  0191 00485000
*/********************************************************************/ 00486000
*/*                                                                  */ 00487000
*/* IF THE IO & SIO BITS ARE ON PUT 'IO=SIO=' INTO THE MESSAGE TEXT  */ 00488000
*/*                                                                  */ 00489000
*/********************************************************************/ 00490000
*                                                                  0191 00491000
*PMT04:                                                            0191 00492000
*                                                                  0191 00493000
*   /*****************************************************************/ 00494000
*   /*                                                               */ 00495000
*   /* CAN THERE BE PROMPTING FOR IO=SIO OR SIO=IO?                  */ 00496000
*   /*                                                               */ 00497000
*   /*****************************************************************/ 00498000
*                                                                  0191 00499000
*   IF GTFIOP='1'B&GTFSIOP='1'B     /*                         Y02014*/ 00500000
*     THEN                          /* YES                           */ 00501000
PMT04    L     @10,INITPTR(,PCTPTR)                                0191 00502000
         TM    GTFIOP(@10),B'00010001'                             0191 00503000
         BNO   @RF00191                                            0191 00504000
*     DO;                           /* YES THERE CAN                 */ 00505000
*       MESSAGE(1:7)=PMTAB(5);      /* PLACE IO=SIO IN MSG           */ 00506000
         MVC   MESSAGE(7,MSGPTR),PMTAB+28                          0193 00507000
*       MSGPTR=MSGPTR+8;            /* MOVE THE PTR TO THE NEW END OF   00508000
*                                      THE MSG                       */ 00509000
         LA    @15,8                                               0194 00510000
         AR    MSGPTR,@15                                          0194 00511000
*       WTOLEN=WTOLEN+8;            /* INCREMENT THE WTO MSG LENGTH     00512000
*                                      FIELD                         */ 00513000
         AH    @15,WTOLEN(,@10)                                    0195 00514000
         STH   @15,WTOLEN(,@10)                                    0195 00515000
*     END;                                                         0196 00516000
*                                                                  0196 00517000
*/********************************************************************/ 00518000
*/*                                                                  */ 00519000
*/* FINISH UP THE MESSAGE INTO WTOR FORMAT                           */ 00520000
*/*                                                                  */ 00521000
*/********************************************************************/ 00522000
*                                                                  0197 00523000
*   MSGPTR=MSGPTR-1;                /* MOVE THE END OF MSG PTR BACK 1   00524000
*                                      AND                           */ 00525000
@RF00191 BCTR  MSGPTR,0                                            0197 00526000
*   WTOLEN=WTOLEN-1;                /* DECREMENT THE WTO MSG LENGTH     00527000
*                                      FIELD 1 SO THAT THE LAST COMMA   00528000
*                                      WILL NOT BE WRITTEN OUT       */ 00529000
         L     @10,INITPTR(,PCTPTR)                                0198 00530000
         LH    @00,WTOLEN(,@10)                                    0198 00531000
         BCTR  @00,0                                               0198 00532000
         STH   @00,WTOLEN(,@10)                                    0198 00533000
*   MESSAGE(1:4)=TWTWORK(1:4);      /* RESTORE THE ROUT & DESC SAVED    00534000
*                                      FROM THE END OF THE WTOR TEXT    00535000
*                                      TO THE NEW END OF THE WTOR    */ 00536000
         MVC   MESSAGE(4,MSGPTR),TWTWORK(@10)                      0199 00537000
*   ICTMSGX='FF'X;                  /* INDICATE THAT IT IS TO BE   0200 00538000
*                                      WRITTEN OUT                   */ 00539000
         MVI   ICTMSGX(@10),X'FF'                                  0200 00540000
*                                                                  0201 00541000
*/********************************************************************/ 00542000
*/*                                                                  */ 00543000
*/* CHECK TO SEE IF THE INPUT IS FROM PARMLIB OR FROM THE CONSOLE    */ 00544000
*/* IF IT IS FROM PARMLIB DON'T WRITE OUT THE MSG                    */ 00545000
*/*                                                                  */ 00546000
*/********************************************************************/ 00547000
*                                                                  0201 00548000
*PMT06:                                                            0201 00549000
*                                                                  0201 00550000
*   /*****************************************************************/ 00551000
*   /*                                                               */ 00552000
*   /* IS THE INPUT TO BE FROM PARMLIB?                              */ 00553000
*   /*                                                               */ 00554000
*   /*****************************************************************/ 00555000
*                                                                  0201 00556000
*   IF ICTPLIB='1'B THEN            /* YES                           */ 00557000
PMT06    L     @10,INITPTR(,PCTPTR)                                0201 00558000
         TM    ICTPLIB(@10),B'10000000'                            0201 00559000
         BNO   @RF00201                                            0201 00560000
*     DO;                           /* YES IT IS FROM PARMLIB        */ 00561000
*                                                                  0202 00562000
*/********************************************************************/ 00563000
*/*                                                                  */ 00564000
*/* READ A RECORD FROM PARMLIB INTO ICTBUF AND THEN CHECK FOR AN EOD */ 00565000
*/* ON THE READ OR AN I/O ERROR                                      */ 00566000
*/*                                                                  */ 00567000
*/********************************************************************/ 00568000
*                                                                  0203 00569000
*PMT59:                                                            0203 00570000
*       ICTIOTYP=3;                 /* INDICATE THAT A RECORD IS TO     00571000
*                                      BE GOTTEN FROM PARMLIB        */ 00572000
PMT59    L     @10,INITPTR(,PCTPTR)                                0203 00573000
         MVI   ICTIOTYP(@10),X'03'                                 0203 00574000
*       CALL AHLTIO;                /* THEN CALL THE ROUTINE THAT  0204 00575000
*                                      DOES THE I/O            Y02014*/ 00576000
*                                                                  0204 00577000
         L     @15,@CV00303                                        0204 00578000
         BALR  @14,@15                                             0204 00579000
*       /*************************************************************/ 00580000
*       /*                                                           */ 00581000
*       /* HAS THE STOP/MODIFY ECB BEEN POSTED?                      */ 00582000
*       /*                                                           */ 00583000
*       /*************************************************************/ 00584000
*                                                                  0205 00585000
*       IF ICTSTOP='1'B THEN        /* YES                           */ 00586000
         L     @10,INITPTR(,PCTPTR)                                0205 00587000
         TM    ICTSTOP(@10),B'00000100'                            0205 00588000
         BO    @RT00205                                            0205 00589000
*         GO TO PMT70;              /* YES RETURN A CODE OF 12       */ 00590000
*                                                                  0206 00591000
*       /*************************************************************/ 00592000
*       /*                                                           */ 00593000
*       /* WAS THERE AN EOD ON THE READ FROM PARMLIB?                */ 00594000
*       /*                                                           */ 00595000
*       /*************************************************************/ 00596000
*                                                                  0207 00597000
*       IF ICTEOD='1'B THEN         /* YES                           */ 00598000
         TM    ICTEOD(@10),B'00100000'                             0207 00599000
         BNO   @RF00207                                            0207 00600000
*         DO;                       /* YES THERE WAS SO              */ 00601000
*           EODIND=2;               /* SET THE INDICATOR AS IF AN  0209 00602000
*                                      'END' HAD BEEN READ AND       */ 00603000
         MVI   EODIND,X'02'                                        0209 00604000
*           GO TO PMT46;            /* GO TO UPDATE THE RESET      0210 00605000
*                                      POINTERS & FINISH OFF THE   0210 00606000
*                                      TABLES                        */ 00607000
         B     PMT46                                               0210 00608000
*         END;                                                     0211 00609000
*                                                                  0211 00610000
*       /*************************************************************/ 00611000
*       /*                                                           */ 00612000
*       /* IF THIS IS NOT THE EOD THEN WAS THERE A READ ERROR?       */ 00613000
*       /*                                                           */ 00614000
*       /*************************************************************/ 00615000
*                                                                  0212 00616000
*       IF ICTIOERR='1'B THEN       /* YES THERE WAS AN ERROR WHICH     00617000
*                                      MEANS THE INPUT PARMLIB CANNOT   00618000
*                                      BE USED FOR PROMPTING SO      */ 00619000
@RF00207 L     @10,INITPTR(,PCTPTR)                                0212 00620000
         TM    ICTIOERR(@10),B'01000000'                           0212 00621000
         BO    @RT00212                                            0212 00622000
*         GO TO PMT69;              /* GIVE THE OPERATOR A CHANCE TO    00623000
*                                      DO THE PROMPTS FROM THE     0213 00624000
*                                      CONSOLE                       */ 00625000
*     END;                                                         0214 00626000
*   ELSE                            /* NO                            */ 00627000
*     DO;                           /* NO INPUT IS TO BE FROM THE  0215 00628000
*                                      CONSOLE                       */ 00629000
*                                                                  0215 00630000
         B     @RC00201                                            0215 00631000
@RF00201 DS    0H                                                  0216 00632000
*/********************************************************************/ 00633000
*/*                                                                  */ 00634000
*/* THIS IS INPUT FROM THE CONSOLE SO SET THE TABLE POINTERS BACK TO */ 00635000
*/* THE LAST ENTRIES MADE INTO THE TABLES FROM THE LAST SUCESSFUL    */ 00636000
*/* INPUT PARAMETERS AND THEN ISSUE A WTOR REQUESTING FUTHER TRACE   */ 00637000
*/* DEFINITION.  THIS IS NOT NEEDED FOR PARMLIB INPUT BECAUSE IF AN  */ 00638000
*/* ERROR IS MADE ON INPUT FROM PARMLIB NO ATTEMPT IS MADE TO RECOVER*/ 00639000
*/* INSTEAD THE RETRY BIT IS SET AND PROMPTING IS STARTED OVER FROM  */ 00640000
*/* THE CONSOLE                                                      */ 00641000
*/*                                                                  */ 00642000
*/********************************************************************/ 00643000
*                                                                  0216 00644000
*PMT61:                                                            0216 00645000
*       IOFTPTR=IOEND;              /* SINCE THE INPUT IS TO BE FROM    00646000
*                                      THE CONSOLE TABLE POINTERS  0216 00647000
*                                      MUST BE RESET                 */ 00648000
PMT61    MVC   IOFTPTR(4),IOEND                                    0216 00649000
*       SIOFTPTR=SIOEND;            /* TO THE LAST VALID ENTRIES MADE   00650000
*                                      INTO ANY OF THE 4 TABLES THAT    00651000
*                                      IS AN ERROR WAS MADE MADE THE    00652000
*                                      BAD                           */ 00653000
         MVC   SIOFTPTR(4),SIOEND                                  0217 00654000
*       SVCFIPTR=SVCEND;            /* ENTRIES CAN BE IGNORED. SO  0218 00655000
*                                      HERE THE POINTERS TO LAST   0218 00656000
*                                      ENTRIES MADE ARE              */ 00657000
         MVC   SVCFIPTR(4),SVCEND                                  0218 00658000
*       PIFIPTR=PIEND;              /* RESET TO THE LAST VALID ENTRY */ 00659000
         MVC   PIFIPTR(4),PIEND                                    0219 00660000
*       ICTIOTYP=1;                 /* NOW PREPARE TO WRITE OUT THE     00661000
*                                      NEXT PROMPTING MESSAGE (WTOR) */ 00662000
         L     @10,INITPTR(,PCTPTR)                                0220 00663000
         MVI   ICTIOTYP(@10),X'01'                                 0220 00664000
*       CALL AHLTIO;                /* AND BRANCH TO THE ROUTINE THAT   00665000
*                                      DOES I/O                Y02014*/ 00666000
*                                                                  0221 00667000
         L     @15,@CV00303                                        0221 00668000
         BALR  @14,@15                                             0221 00669000
*       /*************************************************************/ 00670000
*       /*                                                           */ 00671000
*       /* HAS THE STOP/MODIFY ECB BEEN POSTED?                      */ 00672000
*       /*                                                           */ 00673000
*       /*************************************************************/ 00674000
*                                                                  0222 00675000
*       IF ICTSTOP='1'B THEN        /* YES                           */ 00676000
         L     @10,INITPTR(,PCTPTR)                                0222 00677000
         TM    ICTSTOP(@10),B'00000100'                            0222 00678000
         BO    @RT00222                                            0222 00679000
*         GO TO PMT70;              /* YES RETURN A CODE OF 12       */ 00680000
*     END;                          /* NO                            */ 00681000
*                                                                  0225 00682000
*/********************************************************************/ 00683000
*/*                                                                  */ 00684000
*/* SEARCH FOR THE FIRST NONBLANK CHAR AS THE BEGINNING OF THE TEXT  */ 00685000
*/* AND REQUEST ANOTHER LINE IF THERE IS NO NONBLANK                 */ 00686000
*/*                                                                  */ 00687000
*/********************************************************************/ 00688000
*                                                                  0225 00689000
*PMT60:                                                            0225 00690000
*   EODIND=0;                       /* SET THE SWITCH TO INDICATE  0225 00691000
*                                      THAT THIS IS NOT THE END OF 0225 00692000
*                                      ANYTHING                      */ 00693000
@RC00201 DS    0H                                                  0225 00694000
PMT60    MVI   EODIND,X'00'                                        0225 00695000
*   DO K=1 TO LENGTH(MSGREPLY);     /* SEARCH FOR THE FIRST NONBLANK    00696000
*                                      CHAR IN THE MSG BUFFER  Y02014*/ 00697000
         LA    K,1                                                 0226 00698000
@DL00226 DS    0H                                                  0227 00699000
*     IF MSGREPLY(K)^=' '           /* IS THIS A BLANK?        Y02014*/ 00700000
*       THEN                        /* NO SO IT MUST BE THE BEGINNING   00701000
*                                      OF THE TEXT                   */ 00702000
         L     @10,INITPTR(,PCTPTR)                                0227 00703000
         ALR   @10,K                                               0227 00704000
         CLI   MSGREPLY-1(@10),C' '                                0227 00705000
         BNE   @RT00227                                            0227 00706000
*       GO TO PMT07;                /* SO LEAVE THE LOOP             */ 00707000
*   END;                            /* YES IT IS A BLANK SO CONTINUE    00708000
*                                      THE LOOP                      */ 00709000
         AH    K,@CH00041                                          0229 00710000
         CH    K,@CH00230                                          0229 00711000
         BNH   @DL00226                                            0229 00712000
*   ICTMSGX=3;                      /* NO NONBLANK WAS FOUND SO    0230 00713000
*                                      PROMPT AGAIN FOR ANOTHER LINE    00714000
*                                      OF TEXT                 Y02014*/ 00715000
         L     @10,INITPTR(,PCTPTR)                                0230 00716000
         MVI   ICTMSGX(@10),X'03'                                  0230 00717000
*   GO TO PMT06;                    /* GO DO THE I/O                 */ 00718000
         B     PMT06                                               0231 00719000
*PMT07:                             /* EXIT FROM LOOP                */ 00720000
*   KWPSN=K;                        /* SAVE THE POSITION OF THE FIRST   00721000
*                                      NONBLANK CHAR AS THE BEGINNING   00722000
*                                      OF THE FIRST KEYWORD          */ 00723000
PMT07    LR    KWPSN,K                                             0232 00724000
*                                                                  0233 00725000
*/********************************************************************/ 00726000
*/*                                                                  */ 00727000
*/* AT THIS POINT IN THE CODE IT IS ASSUMED THAT K (& KWPSN) POINT TO*/ 00728000
*/* THE BEGINNING OF A KEYWORD.  HERE A LOOP ADVANCES K TO POINT TO  */ 00729000
*/* THE NEXT '=', WHEN ONE IS FOUND THE TEXT BETWEEN KWPSN & K IS    */ 00730000
*/* CHECKED TO SEE IF IT IS A VALID KEYWORD; IF NONE IS FOUND AND A  */ 00731000
*/* BLANK IS TURNED UP INSTEAD THE TEXT BETWEEN KWPSN & K IS CHECKED */ 00732000
*/* FOR THE STRING 'END' ANYTHING ELSE IS AN ERROR                   */ 00733000
*/*                                                                  */ 00734000
*/********************************************************************/ 00735000
*                                                                  0233 00736000
*PMT08:                                                            0233 00737000
*   IF MSGREPLY(K)='='              /* IS THIS CHAR '='?       Y02014*/ 00738000
*     THEN                          /* YES                           */ 00739000
PMT08    L     @10,INITPTR(,PCTPTR)                                0233 00740000
         LR    @06,@10                                             0233 00741000
         ALR   @06,K                                               0233 00742000
         CLI   MSGREPLY-1(@06),C'='                                0233 00743000
         BE    @RT00233                                            0233 00744000
*     GO TO PMT10;                  /* YES SO LEAVE THE LOOP         */ 00745000
*   K=K+1;                          /* NO IT ISN'T SO GO ON TO THE 0235 00746000
*                                      NEXT CHAR                     */ 00747000
*                                                                  0235 00748000
         AH    K,@CH00041                                          0235 00749000
*   /*****************************************************************/ 00750000
*   /*                                                               */ 00751000
*   /* IS THIS CHAR A ' '?                                           */ 00752000
*   /*                                                               */ 00753000
*   /*****************************************************************/ 00754000
*                                                                  0236 00755000
*   IF MSGREPLY(K)^=' '             /*                         Y02014*/ 00756000
*     THEN                          /* NO                            */ 00757000
         LR    @06,@10                                             0236 00758000
         ALR   @06,K                                               0236 00759000
         CLI   MSGREPLY-1(@06),C' '                                0236 00760000
         BNE   @RT00236                                            0236 00761000
*     GO TO PMT08;                  /* NO SO CONTINUE THE LOOP       */ 00762000
*                                                                  0237 00763000
*   /*****************************************************************/ 00764000
*   /*                                                               */ 00765000
*   /* YES IT IS A BLANK SO ARE THERE ANY MORE THAN 3 CHAR?          */ 00766000
*   /*                                                               */ 00767000
*   /*****************************************************************/ 00768000
*                                                                  0238 00769000
*   IF K-KWPSN^=3 THEN              /* YES                           */ 00770000
         LR    @06,K                                               0238 00771000
         SR    @06,KWPSN                                           0238 00772000
         CH    @06,@CH00071                                        0238 00773000
         BNE   @RT00238                                            0238 00774000
*     GO TO PMT11;                  /* YES SO THERE MUST BE TEXT   0239 00775000
*                                      THERE OTHER THAN 'END'; AN  0239 00776000
*                                      ERROR WRITE OUT A MSG         */ 00777000
*                                                                  0239 00778000
*   /*****************************************************************/ 00779000
*   /*                                                               */ 00780000
*   /* NO IT IS EXACTLY 3 CHAR SO CHECK TO SEE IF THEY ARE 'END'     */ 00781000
*   /*                                                               */ 00782000
*   /*****************************************************************/ 00783000
*                                                                  0240 00784000
*   IF MSGREPLY(KWPSN:KWPSN+2)^='END'/*                        Y02014*/ 00785000
*     THEN                          /* NO                            */ 00786000
         ALR   @10,KWPSN                                           0240 00787000
         CLC   MSGREPLY-1(3,@10),@CC00444                          0240 00788000
         BNE   @RT00240                                            0240 00789000
*     GO TO PMT11;                  /* NO; ERROR WRITE OUT MSG 110   */ 00790000
*   EODIND=2;                       /* YES IT IS A VALID 'END' SO SET   00791000
*                                      THE SWITCH TO INDICATE THAT NO   00792000
*                                      MORE PROMPTING IS TO BE DONE     00793000
*                                      AND THE TABLES SHOULD BE    0242 00794000
*                                      FINISHED                      */ 00795000
         MVI   EODIND,X'02'                                        0242 00796000
*   GO TO PMT46;                    /* THEN GO FINISH THEM           */ 00797000
         B     PMT46                                               0243 00798000
*                                                                  0244 00799000
*/********************************************************************/ 00800000
*/*                                                                  */ 00801000
*/* AN '=' HAS BEEN FOUND SO ISOLATE THE KEYWORD AND THEN COMPARE IT */ 00802000
*/* WITH THE VALID KEYWORDS IN PMTAB LOOKING FOR A MATCH             */ 00803000
*/*                                                                  */ 00804000
*/********************************************************************/ 00805000
*                                                                  0244 00806000
*PMT10:                                                            0244 00807000
*   K=K+1;                          /* AN '=' HAS BEEN FOUND       0244 00808000
*                                      INCREMENT K TO THE NEXT CHAR     00809000
*                                      WHICH SHOULD BE A '(' AND     */ 00810000
*                                                                  0244 00811000
PMT10    LA    @10,1                                               0244 00812000
         AR    K,@10                                               0244 00813000
*   /*****************************************************************/ 00814000
*   /*                                                               */ 00815000
*   /* IS THE KEYWORD OVER 6 CHAR LONG?                              */ 00816000
*   /*                                                               */ 00817000
*   /*****************************************************************/ 00818000
*                                                                  0245 00819000
*   IF K-KWPSN>7 THEN               /* YES                           */ 00820000
         LR    @06,K                                               0245 00821000
         SR    @06,KWPSN                                           0245 00822000
         CH    @06,@CH00075                                        0245 00823000
         BH    @RT00245                                            0245 00824000
*     GO TO PMT11;                  /* YES IT IS; ERROR WRITE OUT A     00825000
*                                      MSG                           */ 00826000
*   TEMPKW(1:4)=BLANK;              /* NO IT ISN'T SO                */ 00827000
         MVC   TEMPKW(4),BLANK                                     0247 00828000
*   TEMPKW(5:7)=BLANK(1:3);         /* BLANK OUT A 7 BYTE WORK AREA     00829000
*                                      PARM TO TEMP HOLD AREA  Y02014*/ 00830000
         MVC   TEMPKW+4(3),BLANK                                   0248 00831000
*   TEMPKW(1:K-KWPSN)=MSGREPLY(KWPSN:K-1);/* AND PUT THE KEYWORD ONLY   00832000
*                                      INTO IT LEFT JUSTIFIED SO IT     00833000
*                                      WILL BE SET UP LIKE THE     0249 00834000
*                                      KEYWORDS IN PMTAB       Y02014*/ 00835000
*                                                                  0249 00836000
         BCTR  @06,0                                               0249 00837000
         L     @15,INITPTR(,PCTPTR)                                0249 00838000
         ALR   @15,KWPSN                                           0249 00839000
         EX    @06,@SM00580                                        0249 00840000
*   /*****************************************************************/ 00841000
*   /*                                                               */ 00842000
*   /* SEARCH FOR A MATCH                                            */ 00843000
*   /*                                                               */ 00844000
*   /*****************************************************************/ 00845000
*                                                                  0250 00846000
*   DO J=1 TO 6;                                                   0250 00847000
*                                                                  0250 00848000
         LA    @06,1                                               0250 00849000
         LR    J,@06                                               0250 00850000
@DL00250 DS    0H                                                  0251 00851000
*     /***************************************************************/ 00852000
*     /*                                                             */ 00853000
*     /* IS THIS A MATCH?                                            */ 00854000
*     /*                                                             */ 00855000
*     /***************************************************************/ 00856000
*                                                                  0251 00857000
*     IF PMTAB(J)=TEMPKW THEN       /* YES                           */ 00858000
         LR    @06,J                                               0251 00859000
         MH    @06,@CH00075                                        0251 00860000
         LA    @15,PMTAB-7(@06)                                    0251 00861000
         CLC   0(7,@15),TEMPKW                                     0251 00862000
         BE    @RT00251                                            0251 00863000
*       GO TO PMT12;                /* YES LEAVE THE LOOP            */ 00864000
*   END;                            /* NO CONTINUE THE LOOP          */ 00865000
         AH    J,@CH00041                                          0253 00866000
         CH    J,@CH00308                                          0253 00867000
         BNH   @DL00250                                            0253 00868000
*PMT11:                             /* ERROR MSG                     */ 00869000
*   ICTMSGX=11;                     /* AN INVALID KEYWORD HAS BEEN 0254 00870000
*                                      FOUND SO SET THE INDICATER FOR   00871000
*                                      MSG AHL110A                   */ 00872000
PMT11    L     @10,INITPTR(,PCTPTR)                                0254 00873000
         MVI   ICTMSGX(@10),X'0B'                                  0254 00874000
*   GO TO PMT05;                    /* AND WRITE IT OUT              */ 00875000
         B     PMT05                                               0255 00876000
*                                                                  0256 00877000
*/********************************************************************/ 00878000
*/*                                                                  */ 00879000
*/* NOW THAT A VALID KEYWORD HAS BEEN IDENTIFIED CHECK WHAT FOLLOWS  */ 00880000
*/*                                                                  */ 00881000
*/********************************************************************/ 00882000
*                                                                  0256 00883000
*PMT12:                                                            0256 00884000
*   IF MSGREPLY(K)^='('             /* IS THE NEXT CHAR AFTER THE  0256 00885000
*                                      KEYWORD A '('?          Y02014*/ 00886000
*     THEN                          /* NO                            */ 00887000
PMT12    L     @06,INITPTR(,PCTPTR)                                0256 00888000
         LR    @15,@06                                             0256 00889000
         ALR   @15,K                                               0256 00890000
         CLI   MSGREPLY-1(@15),C'('                                0256 00891000
         BE    @RF00256                                            0256 00892000
*     DO;                           /* NO THEN IT MIGHT BE 'I' OR 'S'   00893000
*                                      IF THE KEYWORD WAS 'SIO=IO='     00894000
*                                      OR 'IO=SIO='            Y02014*/ 00895000
*       IF MSGREPLY(K)='I'          /* IS THIS THE CASE?             */ 00896000
*           |MSGREPLY(K)='S'        /*                         Y02014*/ 00897000
*         THEN                      /* YES THEN WE'VE IDENTIFIED THE */ 00898000
         LR    @15,@06                                             0258 00899000
         ALR   @15,K                                               0258 00900000
         CLI   MSGREPLY-1(@15),C'I'                                0258 00901000
         BE    @RT00258                                            0258 00902000
         ALR   @06,K                                               0258 00903000
         CLI   MSGREPLY-1(@06),C'S'                                0258 00904000
         BE    @RT00258                                            0258 00905000
*         GO TO PMT08;              /* WRONG KEYWORD BECAUSE WE HAD     00906000
*                                      THE WRONG '=' SO GO BACK AND     00907000
*                                      SCAN ON TO THE NEXT '=' SIGN  */ 00908000
*       KWPBEG=K-1;                 /* SINCE THERE IS NO OPENNING '('   00909000
*                                      THIS MUST BE A SUBPARM LIST OF   00910000
*                                      JUST ONE ENTRY I.E. IO=284 SO    00911000
*                                      POINT TO THE '=' AS THE     0260 00912000
*                                      BEGINNING                     */ 00913000
*                                                                  0260 00914000
         LR    @00,K                                               0260 00915000
         BCTR  @00,0                                               0260 00916000
         ST    @00,KWPBEG                                          0260 00917000
*       /*************************************************************/ 00918000
*       /*                                                           */ 00919000
*       /* SCAN FOR THE NEXT DELIMITER                               */ 00920000
*       /*                                                           */ 00921000
*       /*************************************************************/ 00922000
*                                                                  0261 00923000
*       L=K;                        /*                         Y02014*/ 00924000
         ST    K,L                                                 0261 00925000
*       DO K=L TO L+3;              /*                         Y02014*/ 00926000
*                                                                  0262 00927000
         L     @15,L                                               0262 00928000
         LR    K,@15                                               0262 00929000
         B     @DE00262                                            0262 00930000
@DL00262 DS    0H                                                  0263 00931000
*         /***********************************************************/ 00932000
*         /*                                                         */ 00933000
*         /* CHECK FOR DELIMITER                                     */ 00934000
*         /*                                                         */ 00935000
*         /***********************************************************/ 00936000
*                                                                  0263 00937000
*         IF MSGREPLY(K)=','        /* CHECK FOR ','           Y02014*/ 00938000
*             |MSGREPLY(K)=' '      /* OR ' '                  Y02014*/ 00939000
*           THEN                    /* YES                           */ 00940000
         L     @15,INITPTR(,PCTPTR)                                0263 00941000
         LR    @14,@15                                             0263 00942000
         ALR   @14,K                                               0263 00943000
         CLI   MSGREPLY-1(@14),C','                                0263 00944000
         BE    @RT00263                                            0263 00945000
         ALR   @15,K                                               0263 00946000
         CLI   MSGREPLY-1(@15),C' '                                0263 00947000
         BNE   @RF00263                                            0263 00948000
@RT00263 DS    0H                                                  0264 00949000
*           DO;                     /* FOUND ONE OF THE DELIMITERS   */ 00950000
*             KWPEND=K;             /* SAVE THIS AS THE END OF THE 0265 00951000
*                                      SUBPARMLIST                   */ 00952000
         ST    K,KWPEND                                            0265 00953000
*             GO TO PMT67;          /* PROCESS THE ONE ENTRY         */ 00954000
         B     PMT67                                               0266 00955000
*           END;                                                   0267 00956000
*       END;                                                       0268 00957000
@RF00263 AH    K,@CH00041                                          0268 00958000
@DE00262 LA    @00,3                                               0268 00959000
         A     @00,L                                               0268 00960000
         CR    K,@00                                               0268 00961000
         BNH   @DL00262                                            0268 00962000
*       ICTMSGX=31;                 /* ID OF ERROR MESSAGE     Y02014*/ 00963000
         L     @03,INITPTR(,PCTPTR)                                0269 00964000
         MVI   ICTMSGX(@03),X'1F'                                  0269 00965000
*       GO TO PMT20;                /* GO ISSUE ERROR MESSAGE  Y02014*/ 00966000
         B     PMT20                                               0270 00967000
*     END;                                                         0271 00968000
*                                                                  0272 00969000
*/********************************************************************/ 00970000
*/*                                                                  */ 00971000
*/* NOW THAT THE KEYWORD HAS BEEN DETERMIND CHECK THE FOLLOWING      */ 00972000
*/* SUBPARMLIST FOR VALID GENERAL SYNTAX                             */ 00973000
*/*                                                                  */ 00974000
*/********************************************************************/ 00975000
*                                                                  0272 00976000
*   KWPBEG=K;                       /* YES SO ASSUME IT TO BE THE  0272 00977000
*                                      BEGINNING OF THE SUBPARMLIST     00978000
*                                      AND SAVE THE POINTER TO IT    */ 00979000
@RF00256 ST    K,KWPBEG                                            0272 00980000
*PMT15:                             /* SCAN ON                       */ 00981000
*   K=K+1;                          /* ADVANCE TO THE NEXT CHAR OF 0273 00982000
*                                      THE TEXT                      */ 00983000
*                                                                  0273 00984000
PMT15    AH    K,@CH00041                                          0273 00985000
*   /*****************************************************************/ 00986000
*   /*                                                               */ 00987000
*   /* IS IT A ' '                                                   */ 00988000
*   /*                                                               */ 00989000
*   /*****************************************************************/ 00990000
*                                                                  0274 00991000
*   IF MSGREPLY(K)=' '              /*                         Y02014*/ 00992000
*     THEN                          /* YES                           */ 00993000
         L     @15,INITPTR(,PCTPTR)                                0274 00994000
         LR    @14,@15                                             0274 00995000
         ALR   @14,K                                               0274 00996000
         CLI   MSGREPLY-1(@14),C' '                                0274 00997000
         BNE   @RF00274                                            0274 00998000
*     DO;                           /* YES IT IS; ERROR              */ 00999000
*       ICTMSGX=12;                 /* SET THE MSG INDEX TO AHL111A     01000000
*                                      AND                           */ 01001000
         MVI   ICTMSGX(@15),X'0C'                                  0276 01002000
*       GO TO PMT20;                /* GO WRITE IT OUT               */ 01003000
         B     PMT20                                               0277 01004000
*     END;                                                         0278 01005000
*                                                                  0278 01006000
*   /*****************************************************************/ 01007000
*   /*                                                               */ 01008000
*   /* NO THEN IS IT THE END OF THE SUBPARMLIST?                     */ 01009000
*   /*                                                               */ 01010000
*   /*****************************************************************/ 01011000
*                                                                  0279 01012000
*   IF MSGREPLY(K)^=')'             /*                         Y02014*/ 01013000
*     THEN                          /* NO                            */ 01014000
@RF00274 L     @15,INITPTR(,PCTPTR)                                0279 01015000
         ALR   @15,K                                               0279 01016000
         CLI   MSGREPLY-1(@15),C')'                                0279 01017000
         BNE   @RT00279                                            0279 01018000
*     GO TO PMT15;                  /* NO SO GO TRY THE NEXT CHAR IN    01019000
*                                      THE TEXT                      */ 01020000
*   KWPEND=K;                       /* YES THEN SAVE THIS POSITION AS   01021000
*                                      THE END OF THE SUPARMLIST     */ 01022000
         ST    K,KWPEND                                            0281 01023000
*                                                                  0282 01024000
*/********************************************************************/ 01025000
*/*                                                                  */ 01026000
*/* NOW THAT THE ENDS OF THE SUBPARMLIST HAVE BEEN FOUND             */ 01027000
*/* CHECK TO SEE THAT THE SUBPARMLIST IS FOLLOWED                    */ 01028000
*/* EITHER BY A BLANK OR A COMMA NONBLANK                            */ 01029000
*/*                                                                  */ 01030000
*/********************************************************************/ 01031000
*                                                                  0282 01032000
*   K=K+1;                          /* GO TO THE NEXT CHAR           */ 01033000
         AH    K,@CH00041                                          0282 01034000
*PMT67:                             /* SCAN ON                       */ 01035000
*                                                                  0283 01036000
*   /*****************************************************************/ 01037000
*   /*                                                               */ 01038000
*   /* IS IT A COMMA?                                                */ 01039000
*   /*                                                               */ 01040000
*   /*****************************************************************/ 01041000
*                                                                  0283 01042000
*   IF MSGREPLY(K)=','              /*                         Y02014*/ 01043000
*     THEN                          /* YES                           */ 01044000
PMT67    L     @15,INITPTR(,PCTPTR)                                0283 01045000
         LR    @14,@15                                             0283 01046000
         ALR   @14,K                                               0283 01047000
         CLI   MSGREPLY-1(@14),C','                                0283 01048000
         BE    @RT00283                                            0283 01049000
*     GO TO PMT13;                  /* YES SO ANOTHER KEYWORD MUST 0284 01050000
*                                      FOLLOW                        */ 01051000
*                                                                  0284 01052000
*   /*****************************************************************/ 01053000
*   /*                                                               */ 01054000
*   /* NO, THEN IS IT MUST BE A BLANK, IS IT?                        */ 01055000
*   /*                                                               */ 01056000
*   /*****************************************************************/ 01057000
*                                                                  0285 01058000
*   IF MSGREPLY(K)^=' '             /*                         Y02014*/ 01059000
*     THEN                          /* NO                            */ 01060000
         LR    @14,@15                                             0285 01061000
         ALR   @14,K                                               0285 01062000
         CLI   MSGREPLY-1(@14),C' '                                0285 01063000
         BE    @RF00285                                            0285 01064000
*     DO;                           /* NO; ERROR                     */ 01065000
*       ICTMSGX=8;                  /* SET THE MSG INDEX FOR AHL107A */ 01066000
         MVI   ICTMSGX(@15),X'08'                                  0287 01067000
*       GO TO PMT05;                /* GO WRITE THE MSG              */ 01068000
         B     PMT05                                               0288 01069000
*     END;                                                         0289 01070000
*   EODIND=1;                       /* YES IT IS A BLANK SO SET THE     01071000
*                                      SWITCH TO INDICATE THAT THIS     01072000
*                                      IS THE END OF THE LINE WHEN 0290 01073000
*                                      THIS KEYWORD IS PROCESSED     */ 01074000
@RF00285 MVI   EODIND,X'01'                                        0290 01075000
*   GO TO PMT14;                    /* AND THEN GO ON TO PROCESS IT  */ 01076000
         B     PMT14                                               0291 01077000
*PMT13:                             /* COMMA FOUND                   */ 01078000
*   K=K+1;                          /* YES THE ')' IS FOLLOWED BY A     01079000
*                                      ',' WHICH MEANS ANOTHER     0292 01080000
*                                      KEYWORD SHOULD FOLLOW. MOVE TO   01081000
*                                      THE NEXT CHAR                 */ 01082000
*                                                                  0292 01083000
PMT13    AH    K,@CH00041                                          0292 01084000
*   /*****************************************************************/ 01085000
*   /*                                                               */ 01086000
*   /* IS THIS A BLANK?                                              */ 01087000
*   /*                                                               */ 01088000
*   /*****************************************************************/ 01089000
*                                                                  0293 01090000
*   IF MSGREPLY(K)=' '              /*                         Y02014*/ 01091000
*     THEN                          /* YES                           */ 01092000
         L     @15,INITPTR(,PCTPTR)                                0293 01093000
         ALR   @15,K                                               0293 01094000
         CLI   MSGREPLY-1(@15),C' '                                0293 01095000
         BE    @RT00293                                            0293 01096000
*     GO TO PMT09;                  /* YES IT IS; ERROR              */ 01097000
*   NEXTKW=K;                       /* NO IT ISN'T SO SAVE IT AS THE    01098000
*                                      NEXT KEYWORD TO BE CHECKED    */ 01099000
         ST    K,NEXTKW                                            0295 01100000
*                                                                  0296 01101000
*/********************************************************************/ 01102000
*/*                                                                  */ 01103000
*/*         GO PROCESS THE SUBPARAMETERS FOR THIS KEYWORD      Y02014*/ 01104000
*/*                                                                  */ 01105000
*/********************************************************************/ 01106000
*                                                                  0296 01107000
*PMT14:                                                            0296 01108000
*   GO TO WTGTAB3(J);               /* NO SO USE THE KEYWORD INDEX 0296 01109000
*                                      INTO THE BRANCH TABLE TO GO TO   01110000
*                                      THE PROPER CODE               */ 01111000
*                                                                  0296 01112000
PMT14    LR    @03,J                                               0296 01113000
         SLA   @03,2                                               0296 01114000
         L     @03,WTGTAB3-4(@03)                                  0296 01115000
         BR    @03                                                 0296 01116000
*/********************************************************************/ 01117000
*/*                                                                  */ 01118000
*/* IF J=5 OR 6 FOR WTGTAB THE CODE BRANCHES HERE.  THIS IS THE CODE */ 01119000
*/* FOR THE IO=SIO= & SIO=IO= KEYWORDS                               */ 01120000
*/*                                                                  */ 01121000
*/********************************************************************/ 01122000
*                                                                  0297 01123000
*PMT18:                                                            0297 01124000
*   IF GTFSIOP='1'B                 /* ARE BOTH IO AND SIO     Y02014*/ 01125000
*       &GTFIOP='1'B                /* PROMPTING BITS ON?      Y02014*/ 01126000
*     THEN                          /* YES                           */ 01127000
PMT18    L     @03,INITPTR(,PCTPTR)                                0297 01128000
         TM    GTFSIOP(@03),B'00010001'                            0297 01129000
         BNO   @RF00297                                            0297 01130000
*     DO;                           /* YES SO THIS KEYWORD IS      0298 01131000
*                                      ACCEPTABLE                    */ 01132000
*       ENTRYPTR=IOFTPTR;           /* SET PTR TO CURRENT ENTRY IN IO   01133000
*                                      TBL                           */ 01134000
         L     ENTRYPTR,IOFTPTR                                    0299 01135000
*       OPPTR=IOTAB;                /* SET THE CURRENT TABLE PTR TO     01136000
*                                      THE IO TABLE            Y02014*/ 01137000
         L     OPPTR,IOTAB(,@03)                                   0300 01138000
*       PATHSW=1;                   /* SET PATHSW FOR IO=SIO         */ 01139000
         MVI   PATHSW,X'01'                                        0301 01140000
*       GO TO PMT23;                /* GO TO THE COMMON CODE TO    0302 01141000
*                                      PROCESS THE ENTRIES           */ 01142000
         B     PMT23                                               0302 01143000
*     END;                                                         0303 01144000
*PMT19:                             /* ERROR MSG                     */ 01145000
*   ICTMSGX=13;                     /* NO THEN IT IS AN INVALID    0304 01146000
*                                      KEYWORD FOR THIS PROMPT. ERROR   01147000
*                                      MSG AHL112A                   */ 01148000
@RF00297 DS    0H                                                  0304 01149000
PMT19    L     @03,INITPTR(,PCTPTR)                                0304 01150000
         MVI   ICTMSGX(@03),X'0D'                                  0304 01151000
*PMT20:                             /* ERROR MSG PROCESS             */ 01152000
*   CALL AHLCTL2;                   /* GET THE MSG TEXT        Y02014*/ 01153000
PMT20    L     @15,@CV00346                                        0305 01154000
         BALR  @14,@15                                             0305 01155000
*   MSGPTR=ADDR(TWTBUF)+WTOLEN+2;   /* SET PTR TO END OF MSG -6 BYTES*/ 01156000
         L     @15,INITPTR(,PCTPTR)                                0306 01157000
         LA    MSGPTR,TWTBUF(,@15)                                 0306 01158000
         AH    MSGPTR,WTOLEN(,@15)                                 0306 01159000
         AH    MSGPTR,@CH00327                                     0306 01160000
*   MSG10X(1:6)=PMTAB(J);           /* MOVE THAT KEYWORD INTO THE MSG*/ 01161000
         LR    @14,J                                               0307 01162000
         MH    @14,@CH00075                                        0307 01163000
         LA    @09,PMTAB-7(@14)                                    0307 01164000
         MVC   MSG10X(6,MSGPTR),0(@09)                             0307 01165000
*   ICTMSGX='FF'X;                  /* INDICATE THAT THE MSG IS IN 0308 01166000
*                                      THE BUFFER                    */ 01167000
         MVI   ICTMSGX(@15),X'FF'                                  0308 01168000
*   GO TO PMT05;                    /* & GO WRITE OUT THE MSG        */ 01169000
         B     PMT05                                               0309 01170000
*                                                                  0310 01171000
*/********************************************************************/ 01172000
*/*                                                                  */ 01173000
*/* IF J=1 FOR WTGTAB THE CODE BRANCHES HERE.  THIS IS THE CODE      */ 01174000
*/* FOR THE IO= KEYWORD                                              */ 01175000
*/*                                                                  */ 01176000
*/********************************************************************/ 01177000
*                                                                  0310 01178000
*PMT21:                                                            0310 01179000
*   IF GTFIOP='0'B                  /* IS THE IO PROMPTING BIT ON? 0310 01180000
*                                                              Y02014*/ 01181000
*     THEN                          /* NO                            */ 01182000
PMT21    L     @03,INITPTR(,PCTPTR)                                0310 01183000
         TM    GTFIOP(@03),B'00000001'                             0310 01184000
         BZ    @RT00310                                            0310 01185000
*     GO TO PMT19;                  /* NO; ERROR GO WRITE OUT MSG  0311 01186000
*                                      AHL112A                       */ 01187000
*   ENTRYPTR=IOFTPTR;               /* YES THEN SET THE CURRENT ENTRY   01188000
*                                      PTR TO THE NEXT SLOT IN THE IO   01189000
*                                      TABLE                         */ 01190000
         L     ENTRYPTR,IOFTPTR                                    0312 01191000
*   OPPTR=IOTAB;                    /* SET THE CURRENT TABLE PTR TO     01192000
*                                      THE IO TABLE            Y02014*/ 01193000
         L     OPPTR,IOTAB(,@03)                                   0313 01194000
*   PATHSW=2;                       /* SET THE SWITCH FOR IO=        */ 01195000
         MVI   PATHSW,X'02'                                        0314 01196000
*   GO TO PMT23;                    /* GO TO THE COMMON CODE TO    0315 01197000
*                                      PROCESS THE ENTRIES           */ 01198000
*                                                                  0315 01199000
         B     PMT23                                               0315 01200000
*/********************************************************************/ 01201000
*/*                                                                  */ 01202000
*/* IF J=2 FOR WTGTAB THE CODE BRANCHES HERE.  THIS IS THE CODE      */ 01203000
*/* FOR THE SIO= KEYWORD                                             */ 01204000
*/*                                                                  */ 01205000
*/********************************************************************/ 01206000
*                                                                  0316 01207000
*PMT22:                                                            0316 01208000
*   IF GTFSIOP='0'B                 /* IS THE BIT ON FOR SIO       0316 01209000
*                                      PROMPTING?              Y02014*/ 01210000
*     THEN                          /* NO                            */ 01211000
PMT22    L     @03,INITPTR(,PCTPTR)                                0316 01212000
         TM    GTFSIOP(@03),B'00010000'                            0316 01213000
         BZ    @RT00316                                            0316 01214000
*     GO TO PMT19;                  /* NO; ERROR GO WRITE OUT MSG  0317 01215000
*                                      AHL112A                       */ 01216000
*   ENTRYPTR=SIOFTPTR;              /* SET THE CURRENT ENTRY PTR TO     01217000
*                                      THE NEXT EMPTY SLOT IN THE SIO   01218000
*                                      TABLE                         */ 01219000
         L     ENTRYPTR,SIOFTPTR                                   0318 01220000
*   OPPTR=SIOTAB;                   /* SET THE CURRENT TABLE PTR TO     01221000
*                                      THE SIO TABLE           Y02014*/ 01222000
         L     OPPTR,SIOTAB(,@03)                                  0319 01223000
*   PATHSW=3;                       /* SET THE SWITCH FOR SIO      0320 01224000
*                                      PROCESSING                    */ 01225000
         MVI   PATHSW,X'03'                                        0320 01226000
*                                                                  0321 01227000
*/********************************************************************/ 01228000
*/*                                                                  */ 01229000
*/* THIS IS COMMON CODE USED FOR PROCESSING IO=, SIO=, IO=SIO=, AND  */ 01230000
*/* SIO=IO= KEYWORDS                                                 */ 01231000
*/*                                                                  */ 01232000
*/********************************************************************/ 01233000
*                                                                  0321 01234000
*PMT23:                                                            0321 01235000
*   ENDSW=0;                        /* SET THE SWITCH TO INDICATE NOT   01236000
*                                      AT THE END OF THE SUBPARMLIST */ 01237000
PMT23    MVI   ENDSW,X'00'                                         0321 01238000
*   KWPSN=KWPBEG;                   /* SAVE THE BEGINNING OF THE   0322 01239000
*                                      SUBPARMLIST AS THE BEGINNING     01240000
*                                      OF THE FIRST SUBPARM ENTRY    */ 01241000
*                                                                  0322 01242000
         L     @10,KWPBEG                                          0322 01243000
         LR    KWPSN,@10                                           0322 01244000
*   /*****************************************************************/ 01245000
*   /*                                                               */ 01246000
*   /* START THE LOOP THAT SCANS THE WHOLE SUBPARMLIST               */ 01247000
*   /*                                                               */ 01248000
*   /*****************************************************************/ 01249000
*                                                                  0323 01250000
*   DO K=KWPBEG TO KWPEND-1;        /* AND STOPS AT EACH ','         */ 01251000
         LR    K,@10                                               0323 01252000
         B     @DE00323                                            0323 01253000
@DL00323 DS    0H                                                  0324 01254000
*PMT24:                             /*                               */ 01255000
*     IF MSGREPLY(K)=','            /* IS THIS CHAR A ','?     Y02014*/ 01256000
*       THEN                        /* YES                           */ 01257000
PMT24    L     @10,INITPTR(,PCTPTR)                                0324 01258000
         ALR   @10,K                                               0324 01259000
         CLI   MSGREPLY-1(@10),C','                                0324 01260000
         BE    @RT00324                                            0324 01261000
*       GO TO PMT25;                /* YES THEN ONE SUBENTRY SHOULD     01262000
*                                      BE ISOLATED LEAVE THE LOOP    */ 01263000
*   END;                            /* NO CONTINUE THE LOOP          */ 01264000
         AH    K,@CH00041                                          0326 01265000
@DE00323 L     @10,KWPEND                                          0326 01266000
         BCTR  @10,0                                               0326 01267000
         CR    K,@10                                               0326 01268000
         BNH   @DL00323                                            0326 01269000
*   ENDSW=1;                        /* LOOP HAS REACHED THE END OF 0327 01270000
*                                      THE SUPPARMLIST WHICH IS THE     01271000
*                                      SAME AS A COMMA EXCEPT THAT NO   01272000
*                                      MORE SUBENTRIES FOLLOW SO SET    01273000
*                                      THE SWITCH TO SHOW THAT THERE    01274000
*                                      ARE NO MORE                   */ 01275000
         MVI   ENDSW,X'01'                                         0327 01276000
*PMT25:                                                            0328 01277000
*   IF K-KWPSN-1=0                  /* CHECK TO SEE THAT THE IS NOT     01278000
*                                      NUL (,,)                      */ 01279000
*     THEN                          /* YES IT IS NUL; ERROR          */ 01280000
PMT25    LR    @10,K                                               0328 01281000
         SR    @10,KWPSN                                           0328 01282000
         BCTR  @10,0                                               0328 01283000
         LTR   @10,@10                                             0328 01284000
         BZ    @RT00328                                            0328 01285000
*     GO TO PMT09;                  /* GO WRITE OUT MSG              */ 01286000
*PMT26:                                                            0330 01287000
*   IF K-KWPSN-1^=3                 /* LENGTH IS LESS THAN 0 IS IT 0330 01288000
*                                      GREATER THAN 3?               */ 01289000
*     THEN                                                         0330 01290000
PMT26    LR    @10,K                                               0330 01291000
         SR    @10,KWPSN                                           0330 01292000
         BCTR  @10,0                                               0330 01293000
         CH    @10,@CH00071                                        0330 01294000
         BE    @RF00330                                            0330 01295000
*     DO;                           /* YES IT IS; ERROR              */ 01296000
*PMT26A:                                                           0332 01297000
*       ICTMSGX=10;                 /* SET INDEX FOR MSG AHL109A     */ 01298000
PMT26A   L     @10,INITPTR(,PCTPTR)                                0332 01299000
         MVI   ICTMSGX(@10),X'0A'                                  0332 01300000
*       CALL AHLCTL2;               /* GET MSG TEXT            Y02014*/ 01301000
         L     @15,@CV00346                                        0333 01302000
         BALR  @14,@15                                             0333 01303000
*       MSGPTR=ADDR(TWTBUF)+WTOLEN+5;/* SET PTR TO END OF MSG -3   0334 01304000
*                                      BYTES                         */ 01305000
*                                                                  0334 01306000
         L     @10,INITPTR(,PCTPTR)                                0334 01307000
         LA    MSGPTR,TWTBUF(,@10)                                 0334 01308000
         AH    MSGPTR,WTOLEN(,@10)                                 0334 01309000
         AH    MSGPTR,@CH00273                                     0334 01310000
*       /*************************************************************/ 01311000
*       /*                                                           */ 01312000
*       /* PLACE FIRST 3 BYTES OF ENTRY INTO MSG TEXT                */ 01313000
*       /*                                                           */ 01314000
*       /*************************************************************/ 01315000
*                                                                  0335 01316000
*       MSG10X(1:3)=MSGREPLY(KWPSN+1:KWPSN+3);/*               Y02014*/ 01317000
         LR    @06,@10                                             0335 01318000
         ALR   @06,KWPSN                                           0335 01319000
         MVC   MSG10X(3,MSGPTR),MSGREPLY(@06)                      0335 01320000
*       ICTMSGX='FF'X;              /* INDICATE MSG IS IN THE BUFFER */ 01321000
         MVI   ICTMSGX(@10),X'FF'                                  0336 01322000
*       GO TO PMT05;                /* GO WRITE OUT THE MSG          */ 01323000
         B     PMT05                                               0337 01324000
*     END;                                                         0338 01325000
*   NUMBER=MSGREPLY(KWPSN+1:K-1);   /* THE SUBENTRY IS OF THE CORRECT   01326000
*                                      LENGTH SO SAVE IT IN A 3 BYTE    01327000
*                                      AREA                    Y02014*/ 01328000
@RF00330 MVI   NUMBER+1,C' '                                       0339 01329000
         MVI   NUMBER+2,C' '                                       0339 01330000
         LR    @10,K                                               0339 01331000
         SR    @10,KWPSN                                           0339 01332000
         BCTR  @10,0                                               0339 01333000
         BCTR  @10,0                                               0339 01334000
         L     @15,INITPTR(,PCTPTR)                                0339 01335000
         ALR   @15,KWPSN                                           0339 01336000
         EX    @10,@SM00582                                        0339 01337000
*   I=1;                            /* BEGIN LOOP AT THE FIRST ENTRY    01338000
*                                      IN THE CURRENT TABLE          */ 01339000
         LA    I,1                                                 0340 01340000
*PMT27:                             /* CHECK FOR KEYWORDS            */ 01341000
*   IF ENTRYPTR=ADDR(ENTRX(I))      /* IS THE ENTRY INDEXED BY I THE    01342000
*                                      SAME ONE AS THE NEXT EMPTY  0341 01343000
*                                      ENTRY IN THE TABLE?           */ 01344000
*     THEN                          /* YES                           */ 01345000
PMT27    LR    @10,I                                               0341 01346000
         MH    @10,@CH00071                                        0341 01347000
         LR    @15,OPPTR                                           0341 01348000
         AL    @15,@CF00584                                        0341 01349000
         LA    @00,ENTRX(@10,@15)                                  0341 01350000
         CR    ENTRYPTR,@00                                        0341 01351000
         BE    @RT00341                                            0341 01352000
*     GO TO PMT28;                  /* YES LEAVE THE LOOP NO       0342 01353000
*                                      DUPLICATE ENTRY EXISTS        */ 01354000
*   IF ENTRX(I)=NUMBER              /* NO THEN CHECK TO SEE IF THESE    01355000
*                                      TWO ENTRIES ARE THE SAME      */ 01356000
*     THEN                          /* YES                           */ 01357000
         ALR   @10,OPPTR                                           0343 01358000
         AL    @10,@CF00584                                        0343 01359000
         CLC   ENTRX(3,@10),NUMBER                                 0343 01360000
         BE    @RT00343                                            0343 01361000
*     GO TO PMT31;                  /* YES THEY ARE THE SAME SO BY 0344 01362000
*                                      PASS THIS ONE                 */ 01363000
*   I=I+1;                          /* NO THEY ARE NOT THE SAME SO GO   01364000
*                                      TO THE NEXT ENTRY             */ 01365000
         AH    I,@CH00041                                          0345 01366000
*   GO TO PMT27;                    /* CONTINUE THE LOOP             */ 01367000
         B     PMT27                                               0346 01368000
*                                                                  0347 01369000
*   /*****************************************************************/ 01370000
*   /*                                                               */ 01371000
*   /* VALIDITY CHECK DEVICE ADDRESS TO ENSURE A VALID HEX NUMBER    */ 01372000
*   /*                                                         Y02014*/ 01373000
*   /*                                                               */ 01374000
*   /*****************************************************************/ 01375000
*                                                                  0347 01376000
*PMT28:                             /* VALIDITY CHECK                */ 01377000
*   DO L=1 TO 3;                    /* CHECK THE THREE BYTES   Y02014*/ 01378000
PMT28    LA    @10,1                                               0347 01379000
         ST    @10,L                                               0347 01380000
@DL00347 DS    0H                                                  0348 01381000
*     IF^((NUMBER(L:L)>='A')&       /* VALID EBCDIC A-F        Y02014*/ 01382000
*         (NUMBER(L:L)<='F')        /*                         Y02014*/ 01383000
*         |(NUMBER(L:L)>='0')&      /* VALID EBCDIC 0-9        Y02014*/ 01384000
*         (NUMBER(L:L)<='9'))THEN   /*                         Y02014*/ 01385000
         LA    @15,NUMBER-1(@10)                                   0348 01386000
         CLI   0(@15),C'A'                                         0348 01387000
         BL    @GL00003                                            0348 01388000
         LA    @15,NUMBER-1(@10)                                   0348 01389000
         CLI   0(@15),C'F'                                         0348 01390000
         BNH   @RF00348                                            0348 01391000
@GL00003 L     @10,L                                               0348 01392000
         LA    @15,NUMBER-1(@10)                                   0348 01393000
         CLI   0(@15),C'0'                                         0348 01394000
         BL    @RT00348                                            0348 01395000
         LA    @15,NUMBER-1(@10)                                   0348 01396000
         CLI   0(@15),C'9'                                         0348 01397000
         BH    @RT00348                                            0348 01398000
*       GO TO PMT26A;               /* WRITE ERR MSG           Y02014*/ 01399000
*   END;                                                           0350 01400000
@RF00348 LA    @10,1                                               0350 01401000
         A     @10,L                                               0350 01402000
         ST    @10,L                                               0350 01403000
         CH    @10,@CH00071                                        0350 01404000
         BNH   @DL00347                                            0350 01405000
*PMT30:                             /* ENTER?                        */ 01406000
*   IF ENTRX(I)=ELIND               /* IS THERE ANY MORE ROOM IN THE    01407000
*                                      TABLE?                        */ 01408000
*     THEN                          /* NO                            */ 01409000
PMT30    LR    @10,I                                               0351 01410000
         MH    @10,@CH00071                                        0351 01411000
         ALR   @10,OPPTR                                           0351 01412000
         AL    @10,@CF00584                                        0351 01413000
         CLC   ENTRX(3,@10),ELIND                                  0351 01414000
         BNE   @RF00351                                            0351 01415000
*     DO;                           /* NO; ERROR PICK A MSG          */ 01416000
*                                                                  0352 01417000
*       /*************************************************************/ 01418000
*       /*                                                           */ 01419000
*       /* DOES THE SWITCH INDICATE SIO PROCESSING?                  */ 01420000
*       /*                                                           */ 01421000
*       /*************************************************************/ 01422000
*                                                                  0353 01423000
*       IF PATHSW=3 THEN            /* YES                           */ 01424000
         CLI   PATHSW,3                                            0353 01425000
         BNE   @RF00353                                            0353 01426000
*         ICTMSGX=15;               /* YES SO SET INDEX FOR MSG    0354 01427000
*                                      AHL114A                       */ 01428000
         L     @10,INITPTR(,PCTPTR)                                0354 01429000
         MVI   ICTMSGX(@10),X'0F'                                  0354 01430000
*       ELSE                        /* NO                            */ 01431000
*         ICTMSGX=14;               /* NO THEN SET THE INDEX FOR MSG    01432000
*                                      AHL113A                       */ 01433000
         B     @RC00353                                            0355 01434000
@RF00353 L     @10,INITPTR(,PCTPTR)                                0355 01435000
         MVI   ICTMSGX(@10),X'0E'                                  0355 01436000
*       GO TO PMT05;                /* THEN GO WRITE IT OUT          */ 01437000
         B     PMT05                                               0356 01438000
*     END;                                                         0357 01439000
*   ENTRX(I)=NUMBER;                /* YES THERE IS ROOM IN THE    0358 01440000
*                                      CURRENT TABLE SO PUT THIS ONE    01441000
*                                      IN IT                         */ 01442000
@RF00351 LA    @10,3                                               0358 01443000
         LR    @09,I                                               0358 01444000
         MR    @08,@10                                             0358 01445000
         ALR   @09,OPPTR                                           0358 01446000
         AL    @09,@CF00584                                        0358 01447000
         MVC   ENTRX(3,@09),NUMBER                                 0358 01448000
*   ENTRYPTR=ENTRYPTR+3;            /* ADVANCE THE CURRENT ENTRY PTR    01449000
*                                      TO THE NEXT SLOT IN THE TABLE */ 01450000
         AR    ENTRYPTR,@10                                        0359 01451000
*PMT31:                             /* END?                          */ 01452000
*                                                                  0360 01453000
*   /*****************************************************************/ 01454000
*   /*                                                               */ 01455000
*   /* ARE WE AT THE END OF THE SUBPARMLIST?                         */ 01456000
*   /*                                                               */ 01457000
*   /*****************************************************************/ 01458000
*                                                                  0360 01459000
*   IF ENDSW^=1 THEN                /* NO                            */ 01460000
PMT31    CLI   ENDSW,1                                             0360 01461000
         BE    @RF00360                                            0360 01462000
*     DO;                           /* NO SO                         */ 01463000
*       KWPSN=K;                    /* SAVE THE POSITION OF THE END     01464000
*                                      OF THIS SUBENTRY AS THE     0362 01465000
*                                      BEGINNING OF THE NEXT SUBENTRY*/ 01466000
         LR    KWPSN,K                                             0362 01467000
*       K=K+1;                      /* ADVANCE THE TEXT PTR TO THE 0363 01468000
*                                      NEXT CHAR                     */ 01469000
         AH    K,@CH00041                                          0363 01470000
*       GO TO PMT24;                /* GO ISOLATE THE NEXT SUBENTRY     01471000
*                                      IN THE LIST                   */ 01472000
         B     PMT24                                               0364 01473000
*     END;                                                         0365 01474000
*                                                                  0365 01475000
*   /*****************************************************************/ 01476000
*   /*                                                               */ 01477000
*   /* YES THAT WAS THE LAST ENTRY FOR THIS KEYWORD WAS IT SIO?      */ 01478000
*   /*                                                               */ 01479000
*   /*****************************************************************/ 01480000
*                                                                  0366 01481000
*   IF PATHSW=3 THEN                /* YES                           */ 01482000
@RF00360 CLI   PATHSW,3                                            0366 01483000
         BNE   @RF00366                                            0366 01484000
*     DO;                           /* YES IT WAS SIO                */ 01485000
*       SIOFTPTR=ENTRYPTR;          /* SO UPDATE SIO PTR TO REFLECT     01486000
*                                      NEW ENTRIES                   */ 01487000
         ST    ENTRYPTR,SIOFTPTR                                   0368 01488000
*       GO TO PMT46;                /* GO SEE IF THERE ARE MORE    0369 01489000
*                                      KEYWORDS                      */ 01490000
         B     PMT46                                               0369 01491000
*     END;                                                         0370 01492000
*                                                                  0370 01493000
*   /*****************************************************************/ 01494000
*   /*                                                               */ 01495000
*   /* NOT SIO, WAS IT IO?                                           */ 01496000
*   /*                                                               */ 01497000
*   /*****************************************************************/ 01498000
*                                                                  0371 01499000
*   IF PATHSW=2 THEN                /* YES                           */ 01500000
@RF00366 CLI   PATHSW,2                                            0371 01501000
         BNE   @RF00371                                            0371 01502000
*     DO;                           /* YES IT WAS                    */ 01503000
*       IOFTPTR=ENTRYPTR;           /* SO UPDATE IO PTR TO REFLECT 0373 01504000
*                                      NEW ENTRIES                   */ 01505000
         ST    ENTRYPTR,IOFTPTR                                    0373 01506000
*       GO TO PMT46;                /* GO SEE IF THERE ARE MORE    0374 01507000
*                                      KEYWORDS                      */ 01508000
         B     PMT46                                               0374 01509000
*     END;                          /* IT IS NEITHER IO NOR SIO SO IT   01510000
*                                      MUST BE IO=SIO                */ 01511000
*                                                                  0376 01512000
*/********************************************************************/ 01513000
*/*                                                                  */ 01514000
*/* WHEN ENTRIES JUST MADE INTO THE IO HAVE TO ALSO BE MADE INTO THE */ 01515000
*/* SIO TABLE BECAUSE THE IO=SIO= KEYWORD WAS USED THE CODE BRANCHES */ 01516000
*/* HERE.  THE LATEST IO ENTRIES ARE MERGED INTO THE SIO TABLE IF    */ 01517000
*/* THERE IS ROOM                                                    */ 01518000
*/*                                                                  */ 01519000
*/********************************************************************/ 01520000
*                                                                  0376 01521000
*   OPPTR=IOFTPTR;                  /* USE THE CURRENT TABLE PTR TO     01522000
*                                      POINT TO THE ENTRIES IN THE IO   01523000
*                                      TABLE TO BE COPIED INTO THE 0376 01524000
*                                      SIO TABLE, THE FIRST ONE WOULD   01525000
*                                      BE POINTED TO BY THE NEXT   0376 01526000
*                                      ENTRY PTR THAT WAS UPDATED AT    01527000
*                                      THE END OF THE LAST GROUP OF     01528000
*                                      ENTRIES INTO THE IO TABLE     */ 01529000
@RF00371 L     OPPTR,IOFTPTR                                       0376 01530000
*   IOFTPTR=ENTRYPTR;               /* NOW THAT WE HAVE THE BEGINNING   01531000
*                                      OF THE NEW ENTRIES FROM IT  0377 01532000
*                                      UPDATE IT FOR THIS GROUP OF 0377 01533000
*                                      ENTRIES                       */ 01534000
         ST    ENTRYPTR,IOFTPTR                                    0377 01535000
*   ENTRYPTR=SIOFTPTR;              /* GET THE PTR TO THE NEXT ENTRY    01536000
*                                      TO BE MADE INTO THE SIO TABLE */ 01537000
         L     ENTRYPTR,SIOFTPTR                                   0378 01538000
*PMT32:                                                            0379 01539000
*   IF OPPTR=IOFTPTR                /* IS THIS THE END OF THE IO   0379 01540000
*                                      TABLE ENTRIES?          Y02014*/ 01541000
*     THEN                                                         0379 01542000
PMT32    C     OPPTR,IOFTPTR                                       0379 01543000
         BNE   @RF00379                                            0379 01544000
*     DO;                           /* YES IT IS                     */ 01545000
*       SIOFTPTR=ENTRYPTR;          /* UPDATE THE SIO PTR TO THE NEXT   01546000
*                                      EMPTY SLOT TO REFLECT NEW   0381 01547000
*                                      ENTRIES                       */ 01548000
         ST    ENTRYPTR,SIOFTPTR                                   0381 01549000
*       GO TO PMT46;                /* THEN GO TO SEE IF THERE IS  0382 01550000
*                                      ANYMORE                       */ 01551000
         B     PMT46                                               0382 01552000
*     END;                                                         0383 01553000
*   I=1;                            /* BEGIN LOOP TO SEARCH FOR    0384 01554000
*                                      DUPLICATE ENTRIES AT THE    0384 01555000
*                                      BEGINNING OF SIO TABLE        */ 01556000
@RF00379 LA    I,1                                                 0384 01557000
*PMT33:                                                            0385 01558000
*   IF ENTRYPTR=ADDR(SIOENT(I))     /* IS THIS THE END OF THE SIO  0385 01559000
*                                      TABLE ENTRIES?                */ 01560000
*     THEN                                                         0385 01561000
PMT33    LR    @10,I                                               0385 01562000
         MH    @10,@CH00071                                        0385 01563000
         L     @07,INITPTR(,PCTPTR)                                0385 01564000
         L     @07,SIOTAB(,@07)                                    0385 01565000
         LA    @03,0(@10,@07)                                      0385 01566000
         AL    @03,@CF00584                                        0385 01567000
         CR    ENTRYPTR,@03                                        0385 01568000
         BE    @RT00385                                            0385 01569000
*     GO TO PMT34;                  /* YES IT IS SO GO MAKE THE ENTRY*/ 01570000
*   IF ENTRX(1)=SIOENT(I)           /* NO ITS NOT IS THIS A DUPLICATE   01571000
*                                      ENTRY?                        */ 01572000
*     THEN                                                         0387 01573000
         ALR   @07,@10                                             0387 01574000
         AL    @07,@CF00584                                        0387 01575000
         CLC   ENTRX(3,OPPTR),SIOENT(@07)                          0387 01576000
         BE    @RT00387                                            0387 01577000
*     GO TO PMT35;                  /* YES, SKIP IT                  */ 01578000
*   I=I+1;                          /* NO SO GO ON TO THE NEXT SIO 0389 01579000
*                                      ENTRY                         */ 01580000
         AH    I,@CH00041                                          0389 01581000
*   GO TO PMT33;                    /* CONTINUE LOOP                 */ 01582000
         B     PMT33                                               0390 01583000
*PMT34:                             /* NO DUP                        */ 01584000
*                                                                  0391 01585000
*   /*****************************************************************/ 01586000
*   /*                                                               */ 01587000
*   /* NO DUPLICATE FOUND IS THERE ROOM IN SIO TBL FOR ANOTHER ENTRY */ 01588000
*   /*                                                               */ 01589000
*   /*****************************************************************/ 01590000
*                                                                  0391 01591000
*   IF SIOENT(I)=ELIND THEN         /* NO                            */ 01592000
PMT34    LR    @10,I                                               0391 01593000
         MH    @10,@CH00071                                        0391 01594000
         L     @07,INITPTR(,PCTPTR)                                0391 01595000
         L     @03,SIOTAB(,@07)                                    0391 01596000
         ALR   @03,@10                                             0391 01597000
         AL    @03,@CF00584                                        0391 01598000
         CLC   SIOENT(3,@03),ELIND                                 0391 01599000
         BNE   @RF00391                                            0391 01600000
*     DO;                           /* NO; ERROR                     */ 01601000
*       ICTMSGX=15;                 /* SET INDEX FOR THE MSG AHL114A */ 01602000
         MVI   ICTMSGX(@07),X'0F'                                  0393 01603000
*       GO TO PMT05;                /* GO WRITE IT OUT               */ 01604000
         B     PMT05                                               0394 01605000
*     END;                                                         0395 01606000
*   SIOENT(I)=ENTRX(1);             /* YES THER IS ROOM SO ADD THE 0396 01607000
*                                      ENTRY                         */ 01608000
@RF00391 LA    @10,3                                               0396 01609000
         LR    @09,I                                               0396 01610000
         MR    @08,@10                                             0396 01611000
         L     @07,INITPTR(,PCTPTR)                                0396 01612000
         L     @07,SIOTAB(,@07)                                    0396 01613000
         ALR   @07,@09                                             0396 01614000
         AL    @07,@CF00584                                        0396 01615000
         MVC   SIOENT(3,@07),ENTRX(OPPTR)                          0396 01616000
*   ENTRYPTR=ENTRYPTR+3;            /* AND UPDATE THE CURRENT ENTRY     01617000
*                                      POINTER                       */ 01618000
         AR    ENTRYPTR,@10                                        0397 01619000
*PMT35:                             /* CONTINUE                      */ 01620000
*   OPPTR=OPPTR+3;                  /* INCREMENT THE CURRENT TABLE 0398 01621000
*                                      PTR BEING USED TO POINT TO THE   01622000
*                                      NEW ENTRY IN THE IO TABLE THAT   01623000
*                                      IS BEING COPIED               */ 01624000
PMT35    AH    OPPTR,@CH00071                                      0398 01625000
*   GO TO PMT32;                    /* CONTINUE THE LOOP             */ 01626000
         B     PMT32                                               0399 01627000
*                                                                  0400 01628000
*/********************************************************************/ 01629000
*/*                                                                  */ 01630000
*/* IF J=3 FOR WTGTAB THE CODE BRANCHES HERE.  THIS IS THE CODE      */ 01631000
*/* FOR THE SVC= KEYWORD                                             */ 01632000
*/*                                                                  */ 01633000
*/********************************************************************/ 01634000
*                                                                  0400 01635000
*PMT41:                                                            0400 01636000
*   IF GTFSVCP='0'B                 /* IS THE PROMPTING BIT FOR SVC     01637000
*                                      ON?                     Y02014*/ 01638000
*     THEN                          /* NO                            */ 01639000
PMT41    L     @03,INITPTR(,PCTPTR)                                0400 01640000
         TM    GTFSVCP(@03),B'01000000'                            0400 01641000
         BZ    @RT00400                                            0400 01642000
*     GO TO PMT19;                  /* NO THEN THIS IS AN INVALID  0401 01643000
*                                      PROMPT WRITE AN ERROR MSG     */ 01644000
*   ENTRYPTR=SVCFIPTR;              /* YES SET THE CURRENT ENTRY PTR    01645000
*                                      TO THE NEXT SLOT IN THE SVC 0402 01646000
*                                      TABLE                         */ 01647000
         L     ENTRYPTR,SVCFIPTR                                   0402 01648000
*   OPPTR=SVCTAB;                   /* SET THE CURRENT TABLE PTR TO     01649000
*                                      THE SVC TABLE           Y02014*/ 01650000
         L     OPPTR,SVCTAB(,@03)                                  0403 01651000
*   PATHSW=2;                       /* SET SWITCH TO INDICATE SVC  0404 01652000
*                                      PROCESSING                    */ 01653000
         MVI   PATHSW,X'02'                                        0404 01654000
*   GO TO PMT37;                    /* GO TO THE COMMON CODE TO    0405 01655000
*                                      PROCESS PI&SVC ENTRIES        */ 01656000
*                                                                  0405 01657000
         B     PMT37                                               0405 01658000
*/********************************************************************/ 01659000
*/*                                                                  */ 01660000
*/* IF J=4 FOR WTGTAB THE CODE BRANCHES HERE.  THIS IS THE CODE      */ 01661000
*/* FOR THE PI= KEYWORD                                              */ 01662000
*/*                                                                  */ 01663000
*/********************************************************************/ 01664000
*                                                                  0406 01665000
*PMT36:                                                            0406 01666000
*   IF GTFPIP='0'B                  /* IS THE PROMPTING BIT FOR PI 0406 01667000
*                                      ON?                     Y02014*/ 01668000
*     THEN                          /* NO                            */ 01669000
PMT36    L     @03,INITPTR(,PCTPTR)                                0406 01670000
         TM    GTFPIP(@03),B'00000100'                             0406 01671000
         BZ    @RT00406                                            0406 01672000
*     GO TO PMT19;                  /* NO IVALID PROMPTING WRITE OUT    01673000
*                                      ERROR MSG                     */ 01674000
*   ENTRYPTR=PIFIPTR;               /* YES SET THE CURRENT ENTRY PTR    01675000
*                                      TO THE NEXT EMPTY SLOT IN PI     01676000
*                                      TABLE                         */ 01677000
         L     ENTRYPTR,PIFIPTR                                    0408 01678000
*   OPPTR=PITAB;                    /* SET THE CURRENT TABLE PTR TO     01679000
*                                      THE PI TABLE            Y02014*/ 01680000
         L     OPPTR,PITAB(,@03)                                   0409 01681000
*   PATHSW=1;                       /* SET SWITCH TO INDICATE PI   0410 01682000
*                                      PROCESSING                    */ 01683000
         MVI   PATHSW,X'01'                                        0410 01684000
*                                                                  0411 01685000
*/********************************************************************/ 01686000
*/*                                                                  */ 01687000
*/* COMMON CODE FOR READING IN PI= & SVC= KEYWORD PARAMETER LISTS    */ 01688000
*/*                                                                  */ 01689000
*/********************************************************************/ 01690000
*                                                                  0411 01691000
*PMT37:                                                            0411 01692000
*   ENDSW=0;                        /* SET SWITCH TO INDICATE NOT THE   01693000
*                                      END OF THE SUBPARMLIST        */ 01694000
PMT37    MVI   ENDSW,X'00'                                         0411 01695000
*   KWPSN=KWPBEG;                   /* INITIALIZE PTR TO THE FIRST 0412 01696000
*                                      SUBENTRY                      */ 01697000
         L     @10,KWPBEG                                          0412 01698000
         LR    KWPSN,@10                                           0412 01699000
*   DO K=KWPBEG                     /* SET UP A LOOP TO SCAN THE   0413 01700000
*                                      PARMLIST STOPPING             */ 01701000
*         TO KWPEND-1;              /* AT EACH ',' & THE END         */ 01702000
         LR    K,@10                                               0413 01703000
         B     @DE00413                                            0413 01704000
@DL00413 DS    0H                                                  0414 01705000
*PMT38:                                                            0414 01706000
*     IF MSGREPLY(K)=','            /* IS THIS CHAR A ','?     Y02014*/ 01707000
*       THEN                                                       0414 01708000
PMT38    L     @10,INITPTR(,PCTPTR)                                0414 01709000
         ALR   @10,K                                               0414 01710000
         CLI   MSGREPLY-1(@10),C','                                0414 01711000
         BE    @RT00414                                            0414 01712000
*       GO TO PMT39;                /* YES SO A SUBENTRY SHOULD BE 0415 01713000
*                                      ISOLATED                      */ 01714000
*   END;                            /* NO CONTINUE THE LOOP          */ 01715000
         AH    K,@CH00041                                          0416 01716000
@DE00413 L     @10,KWPEND                                          0416 01717000
         BCTR  @10,0                                               0416 01718000
         CR    K,@10                                               0416 01719000
         BNH   @DL00413                                            0416 01720000
*   ENDSW=1;                        /* LOOP HAS REACHED THE END OF 0417 01721000
*                                      THE SUBPARMLIST SET THE SWITCH   01722000
*                                      TO INDICATE THAT THIS WILL BE    01723000
*                                      THE LAST SUBENTRY FOR THIS  0417 01724000
*                                      KEYWORD                       */ 01725000
         MVI   ENDSW,X'01'                                         0417 01726000
*PMT39:                                                            0418 01727000
*   IF K-KWPSN-1<=0                 /* IS THE SUBENTRY NUL           */ 01728000
*     THEN                          /* YES; ERROR                    */ 01729000
PMT39    LR    @10,K                                               0418 01730000
         SR    @10,KWPSN                                           0418 01731000
         BCTR  @10,0                                               0418 01732000
         LTR   @10,@10                                             0418 01733000
         BNP   @RT00418                                            0418 01734000
*     GO TO PMT09;                  /* WRITE OUT A MSG               */ 01735000
*   IF K-KWPSN-1>3                  /* IS THE SUBENTRY TOO LONG?     */ 01736000
*     THEN                                                         0420 01737000
         CH    @10,@CH00071                                        0420 01738000
         BNH   @RF00420                                            0420 01739000
*     DO;                           /* YES PICK A MSG                */ 01740000
*       IF PATHSW=1                 /* IS THIS PI PROCESSING?        */ 01741000
*         THEN                                                     0422 01742000
         CLI   PATHSW,1                                            0422 01743000
         BNE   @RF00422                                            0422 01744000
*         ICTMSGX=16;               /* YES SET INDEX FOR MSG AHL115A */ 01745000
         L     @10,INITPTR(,PCTPTR)                                0423 01746000
         MVI   ICTMSGX(@10),X'10'                                  0423 01747000
*       ELSE                                                       0424 01748000
*         ICTMSGX=17;               /* NO THEN SET INDEX FOR MSG   0424 01749000
*                                      AHL116A                       */ 01750000
         B     @RC00422                                            0424 01751000
@RF00422 L     @10,INITPTR(,PCTPTR)                                0424 01752000
         MVI   ICTMSGX(@10),X'11'                                  0424 01753000
*       GO TO PMT05;                /* THEN WRITE OUT MSG            */ 01754000
         B     PMT05                                               0425 01755000
*     END;                                                         0426 01756000
*   NUMBER=CHAR0;                   /* NO LENGTH IS VALID SO       0427 01757000
*                                      INITALIZE A 3 BYTE AREA TO 0     01758000
*                                      CHAR 'F0F0F0'X                */ 01759000
@RF00420 MVC   NUMBER(3),CHAR0                                     0427 01760000
*   J=KWPSN+5-K;                    /* FIGURE WHERE THE FIRST DIGIT     01761000
*                                      WILL FALL IN A 3 BYTE FIELD IF   01762000
*                                      THE SUBENTRY IS RIGHT       0428 01763000
*                                      JUSTIFIED                     */ 01764000
         LA    J,5                                                 0428 01765000
         AR    J,KWPSN                                             0428 01766000
         SR    J,K                                                 0428 01767000
*   NUMBER(J:3)=MSGREPLY(KWPSN+1:K-1);/* MOVE THE SUBENTRY INTO THE 3   01768000
*                                      BYTE FIELD RIGHT JUSTIFIED  0429 01769000
*                                                              Y02014*/ 01770000
         LA    @05,NUMBER-1(J)                                     0429 01771000
         LA    @15,3                                               0429 01772000
         SR    @15,J                                               0429 01773000
         L     @14,INITPTR(,PCTPTR)                                0429 01774000
         ALR   @14,KWPSN                                           0429 01775000
         EX    @15,@SM00585                                        0429 01776000
*   KWPSN=K;                        /* SAVE THE POSITION OF THE NEXT    01777000
*                                      SUBENTRY                      */ 01778000
*                                                                  0430 01779000
         LR    KWPSN,K                                             0430 01780000
*   /*****************************************************************/ 01781000
*   /*                                                               */ 01782000
*   /* CHECK TO BE SURE THAT ALL 3 BYTES CAN ONLY CONTAIN A DIGIT    */ 01783000
*   /* CHAR                                                          */ 01784000
*   /*                                                               */ 01785000
*   /*****************************************************************/ 01786000
*                                                                  0431 01787000
*   IF HIGH1='1111'B&HIGH2='1111'B&HIGH3='1111'B THEN/* YES          */ 01788000
         TM    HIGH1,B'11110000'                                   0431 01789000
         BNO   @RF00431                                            0431 01790000
         TM    HIGH2,B'11110000'                                   0431 01791000
         BNO   @RF00431                                            0431 01792000
         TM    HIGH3,B'11110000'                                   0431 01793000
         BO    @RT00431                                            0431 01794000
*     GO TO PMT65;                  /* YES THEY ARE OK SO GO TO CHECK   01795000
*                                      FURTHER                       */ 01796000
*   NUMBER=ELIND;                   /* NO THEY ARE NOT OK SO PUT   0433 01797000
*                                      'FFFFFF'X INTO THE 3 BYTE   0433 01798000
*                                      FIELD TO BE SURE THAT IT WILL    01799000
*                                      COME UP INVALID LATER         */ 01800000
@RF00431 MVC   NUMBER(3),ELIND                                     0433 01801000
*PMT65:                             /* PI?                           */ 01802000
*                                                                  0434 01803000
*   /*****************************************************************/ 01804000
*   /*                                                               */ 01805000
*   /* IS THIS PI PROCESSING?                                        */ 01806000
*   /*                                                               */ 01807000
*   /*****************************************************************/ 01808000
*                                                                  0434 01809000
*   IF PATHSW=1 THEN                /* YES                           */ 01810000
PMT65    CLI   PATHSW,1                                            0434 01811000
         BE    @RT00434                                            0434 01812000
*     GO TO PMT40;                  /* YES THEN GO TO THE PI TEST &     01813000
*                                      ERROR MSG                     */ 01814000
*                                                                  0435 01815000
*   /*****************************************************************/ 01816000
*   /*                                                               */ 01817000
*   /* NO THEN IT MUST BE SVC PROCESSING                             */ 01818000
*   /*                                                               */ 01819000
*   /*****************************************************************/ 01820000
*                                                                  0436 01821000
*   IF NUMBER>=CHAR0                /* IS THE SVC NUMBER             */ 01822000
*       &NUMBER<=MAXSVCNO           /* 000<=SVC#<=255?               */ 01823000
*     THEN                          /* YES                           */ 01824000
         CLC   NUMBER(3),CHAR0                                     0436 01825000
         BL    @RF00436                                            0436 01826000
         CLC   NUMBER(3),MAXSVCNO                                  0436 01827000
         BNH   @RT00436                                            0436 01828000
*     GO TO PMT42;                  /* YES ENTER IT IN TABLE         */ 01829000
*   ICTMSGX=17;                     /* NO; ERROR SET INDEX FOR MSG 0438 01830000
*                                      AHL116                        */ 01831000
@RF00436 L     @10,INITPTR(,PCTPTR)                                0438 01832000
         MVI   ICTMSGX(@10),X'11'                                  0438 01833000
*   GO TO PMT05;                    /* GO WRITE OUT THE MSG          */ 01834000
         B     PMT05                                               0439 01835000
*PMT40:                             /* PI                            */ 01836000
*                                                                  0440 01837000
*   /*****************************************************************/ 01838000
*   /*                                                               */ 01839000
*   /* VALIDITY CHECK THE PI NUMBER                                  */ 01840000
*   /*                                                               */ 01841000
*   /*****************************************************************/ 01842000
*                                                                  0440 01843000
*   IF NUMBER>CHAR0                 /* IS THIS PI NUMBER             */ 01844000
*       &NUMBER<=MAXPINO            /* 000<PI#<=019                  */ 01845000
*     THEN                          /* YES                           */ 01846000
PMT40    CLC   NUMBER(3),CHAR0                                     0440 01847000
         BNH   @RF00440                                            0440 01848000
         CLC   NUMBER(3),MAXPINO                                   0440 01849000
         BNH   @RT00440                                            0440 01850000
*     GO TO PMT42;                  /* YES GO PUT IT INTO THE TABLE  */ 01851000
*   ICTMSGX=16;                     /* NO; ERROR SET THE INDEX FOR 0442 01852000
*                                      MSG AHL115A                   */ 01853000
@RF00440 L     @10,INITPTR(,PCTPTR)                                0442 01854000
         MVI   ICTMSGX(@10),X'10'                                  0442 01855000
*   GO TO PMT05;                    /* GO WRITE OUT THE MSG          */ 01856000
         B     PMT05                                               0443 01857000
*                                                                  0444 01858000
*/********************************************************************/ 01859000
*/*                                                                  */ 01860000
*/* AT THIS POINT THE PARMLIST ENTRY IS KNOWN TO BE VALID, NEXT      */ 01861000
*/* CHECK TO SEE IF IT IS A DUPLICATE & IF NOT ENTER IT IN THE TABLE */ 01862000
*/*                                                                  */ 01863000
*/********************************************************************/ 01864000
*                                                                  0444 01865000
*PMT42:                                                            0444 01866000
*   I=1;                            /* START LOOP AT THE FIRST ENTRY    01867000
*                                      IN THE CURRENT TABLE          */ 01868000
PMT42    LA    I,1                                                 0444 01869000
*PMT43:                             /* FIRST SLOT?                   */ 01870000
*   IF ENTRYPTR=ADDR(ENTRX(I))      /* IS THIS ENTRY THE FIRST EMPTY    01871000
*                                      SLOT IN THE CURRENT TABLE     */ 01872000
*     THEN                          /* YES                           */ 01873000
PMT43    LR    @10,I                                               0445 01874000
         MH    @10,@CH00071                                        0445 01875000
         LR    @15,OPPTR                                           0445 01876000
         AL    @15,@CF00584                                        0445 01877000
         LA    @00,ENTRX(@10,@15)                                  0445 01878000
         CR    ENTRYPTR,@00                                        0445 01879000
         BE    @RT00445                                            0445 01880000
*     GO TO PMT45;                  /* YES THEN THERE ARE NO       0446 01881000
*                                      DUPLICATE ENTRIES SO LEAVE THE   01882000
*                                      LOOP                          */ 01883000
*                                                                  0446 01884000
*   /*****************************************************************/ 01885000
*   /*                                                               */ 01886000
*   /* NO SO THEN CHECK TO SEE IF THIS ENTRY IS A DUPLICATE          */ 01887000
*   /*                                                               */ 01888000
*   /*****************************************************************/ 01889000
*                                                                  0447 01890000
*   IF NUMBER=ENTRX(I)THEN          /* YES                           */ 01891000
         ALR   @10,OPPTR                                           0447 01892000
         AL    @10,@CF00584                                        0447 01893000
         CLC   NUMBER(3),ENTRX(@10)                                0447 01894000
         BE    @RT00447                                            0447 01895000
*     GO TO PMT44;                  /* YES IT IS A DUP SO SKIP IT &     01896000
*                                      GO ON TO THE NEXT SUBPARM     */ 01897000
*   I=I+1;                          /* NO NOT A DUP SO GO ON TO THE     01898000
*                                      NEXT ENTRY                    */ 01899000
         AH    I,@CH00041                                          0449 01900000
*   GO TO PMT43;                    /* CONTINUE LOOP                 */ 01901000
         B     PMT43                                               0450 01902000
*PMT45:                             /* NO DUP                        */ 01903000
*                                                                  0451 01904000
*   /*****************************************************************/ 01905000
*   /*                                                               */ 01906000
*   /* NOW THAT WE KNOW THERE IS NO DUPLICATE ENTRY IS THERE ROOM    */ 01907000
*   /*                                                               */ 01908000
*   /*****************************************************************/ 01909000
*                                                                  0451 01910000
*   IF ENTRX(I)=ELIND               /* IN THE TABLE FOR A NEW ENTRY? */ 01911000
*     THEN                          /* NO                            */ 01912000
PMT45    LR    @10,I                                               0451 01913000
         MH    @10,@CH00071                                        0451 01914000
         ALR   @10,OPPTR                                           0451 01915000
         AL    @10,@CF00584                                        0451 01916000
         CLC   ENTRX(3,@10),ELIND                                  0451 01917000
         BNE   @RF00451                                            0451 01918000
*     DO;                           /* NO THERE ISN'T ANYMORE ROOM;     01919000
*                                      ERROR                         */ 01920000
*       ICTMSGX=18;                 /* SET THE MSG INDEX FOR MSG   0453 01921000
*                                      AHL117A                       */ 01922000
         L     @10,INITPTR(,PCTPTR)                                0453 01923000
         MVI   ICTMSGX(@10),X'12'                                  0453 01924000
*       GO TO PMT05;                /* GO WRITE OUT THE MSG          */ 01925000
         B     PMT05                                               0454 01926000
*     END;                                                         0455 01927000
*   ENTRX(I)=NUMBER;                /* YES THERE IS ROOM SO PUT THE     01928000
*                                      NEW ENTRY INTO THE CURRENT  0456 01929000
*                                      TABLE                         */ 01930000
@RF00451 LA    @10,3                                               0456 01931000
         LR    @09,I                                               0456 01932000
         MR    @08,@10                                             0456 01933000
         ALR   @09,OPPTR                                           0456 01934000
         AL    @09,@CF00584                                        0456 01935000
         MVC   ENTRX(3,@09),NUMBER                                 0456 01936000
*   ENTRYPTR=ENTRYPTR+3;            /* ADVANCE THE CURRENT PTR TO THE   01937000
*                                      NEXT SLOT                     */ 01938000
         AR    ENTRYPTR,@10                                        0457 01939000
*PMT44:                             /* ROUTE?                        */ 01940000
*                                                                  0458 01941000
*   /*****************************************************************/ 01942000
*   /*                                                               */ 01943000
*   /* TEST THIS SWITCH TO SEE IF THAT WAS THE LAST SUBENTRY         */ 01944000
*   /*                                                               */ 01945000
*   /*****************************************************************/ 01946000
*                                                                  0458 01947000
*   IF ENDSW^=1 THEN                /* NO                            */ 01948000
PMT44    CLI   ENDSW,1                                             0458 01949000
         BE    @RF00458                                            0458 01950000
*     DO;                           /* NO IT WASN'T SO               */ 01951000
*       K=K+1;                      /* START THE SCAN FOR THE NEXT 0460 01952000
*                                      SUBENTRY                      */ 01953000
         AH    K,@CH00041                                          0460 01954000
*       GO TO PMT38;                /* RETURN TO THE LOOP            */ 01955000
         B     PMT38                                               0461 01956000
*     END;                                                         0462 01957000
*                                                                  0462 01958000
*   /*****************************************************************/ 01959000
*   /*                                                               */ 01960000
*   /* YES THAT WAS THE LAST ONE SO WAS THIS PI PROCESSING?          */ 01961000
*   /*                                                               */ 01962000
*   /*****************************************************************/ 01963000
*                                                                  0463 01964000
*   IF PATHSW=1 THEN                /* YES                           */ 01965000
@RF00458 CLI   PATHSW,1                                            0463 01966000
         BNE   @RF00463                                            0463 01967000
*     PIFIPTR=ENTRYPTR;             /* THEN UPDATE THE PI PTR TO THE    01968000
*                                      NEXT EMPTY SLOT TO REFLECT THE   01969000
*                                      NEW GROUP OF ENTRIES INTO THE    01970000
*                                      PI TABLE                      */ 01971000
         ST    ENTRYPTR,PIFIPTR                                    0464 01972000
*   ELSE                            /* NO THEN IT MUST BE SVC        */ 01973000
*     SVCFIPTR=ENTRYPTR;            /* THEN UPDATE THE SVC PTR TO THE   01974000
*                                      NEXT EMPTY SLOT TO REFLECT THE   01975000
*                                      NEW GROUP OF ENTRIES INTO THE    01976000
*                                      SVC TABLE                     */ 01977000
         B     @RC00463                                            0465 01978000
@RF00463 ST    ENTRYPTR,SVCFIPTR                                   0465 01979000
*                                                                  0466 01980000
*/********************************************************************/ 01981000
*/*                                                                  */ 01982000
*/* THE CODE BRANCHES HERE AFTER FINISHING PROCESSING OF A LINE OR   */ 01983000
*/* ANY KEYWORD SUBPARMLIST.  THE SWITCH EODIND IS USED TO DECIDE IF */ 01984000
*/* THERE SHOULD BE ANYMORE INPUT & WHERE TO GO TO PROCESS IT        */ 01985000
*/*                                                                  */ 01986000
*/********************************************************************/ 01987000
*                                                                  0466 01988000
*PMT46:                                                            0466 01989000
*   IF EODIND=0                     /* IS THE SWITCH SET TO INDICATE    01990000
*                                      THE END OF A LINE WAS REACHED?*/ 01991000
*     THEN                          /* NO                            */ 01992000
@RC00463 DS    0H                                                  0466 01993000
PMT46    CLI   EODIND,0                                            0466 01994000
         BNE   @RF00466                                            0466 01995000
*     DO;                           /* NO                            */ 01996000
*       K=NEXTKW;                   /* SO INITALIZE THE SCAN PTR TO     01997000
*                                      THE POSITION OF WHAT SHOULD BE   01998000
*                                      THE NEXT KEYWORD              */ 01999000
         L     K,NEXTKW                                            0468 02000000
*       GO TO PMT07;                /* GO BACK INTO THE SCAN LOOP FOR   02001000
*                                      KEYWORDS                      */ 02002000
         B     PMT07                                               0469 02003000
*     END;                                                         0470 02004000
*                                                                  0470 02005000
*/********************************************************************/ 02006000
*/*                                                                  */ 02007000
*/* THE RESET POINTERS ARE UPDATED AT THIS POINT -- THE CONSEQUENCE  */ 02008000
*/* OF DOING THIS AT THIS POINT IS THAT ANY ERROR IN ANY WHOLE LINE  */ 02009000
*/* OF PROMPTING INVALIDATES THAT WHOLE LINE NOT JUST THAT KEYWORD   */ 02010000
*/*                                                                  */ 02011000
*/********************************************************************/ 02012000
*                                                                  0471 02013000
*   IOEND=IOFTPTR;                  /* YES THIS IS THE END OF A LINE    02014000
*                                      SO UPDATE THE                 */ 02015000
@RF00466 MVC   IOEND(4),IOFTPTR                                    0471 02016000
*   SIOEND=SIOFTPTR;                /* RESET POINTERS TO             */ 02017000
         MVC   SIOEND(4),SIOFTPTR                                  0472 02018000
*   PIEND=PIFIPTR;                  /* REFLECT ALL THE VALID         */ 02019000
         MVC   PIEND(4),PIFIPTR                                    0473 02020000
*   SVCEND=SVCFIPTR;                /* ENTRIES MADE INTO THE TABLES     02021000
*                                      FROM THIS LINE OF PROMPTING   */ 02022000
         MVC   SVCEND(4),SVCFIPTR                                  0474 02023000
*   IF EODIND^=2                    /* IN ADDITIN TO BEING THE END OF   02024000
*                                      THE LINE WAS THIS ALSO THE END   02025000
*                                      OF THE PROMPTING?             */ 02026000
*     THEN                                                         0475 02027000
         CLI   EODIND,2                                            0475 02028000
         BE    @RF00475                                            0475 02029000
*     DO;                           /* NO SO                         */ 02030000
*       ICTMSGX=3;                  /* SET THE MSG INDEX FOR MSG   0477 02031000
*                                      AHL102A AND                   */ 02032000
         L     @10,INITPTR(,PCTPTR)                                0477 02033000
         MVI   ICTMSGX(@10),X'03'                                  0477 02034000
*       GO TO PMT06;                /* BRANCH TO REQUEST MORE      0478 02035000
*                                      PROMPTING OR 'END'            */ 02036000
         B     PMT06                                               0478 02037000
*     END;                                                         0479 02038000
*                                                                  0480 02039000
*/********************************************************************/ 02040000
*/*                                                                  */ 02041000
*/* FREEMAIN CORE GOTTEN FOR ANY TABLE IF THAT TABLE IS EMPTY AND    */ 02042000
*/* THEN TURN OFF THE ASSOCIATED PROMTING BIT AND SET THE OPTION     */ 02043000
*/* BITS SO THAT THERE WILL BE A FULL TRACE OF THAT EVENT            */ 02044000
*/*                                                                  */ 02045000
*/********************************************************************/ 02046000
*                                                                  0480 02047000
*   /*****************************************************************/ 02048000
*   /*                                                               */ 02049000
*   /* YES EODIND=2 SO THAT WAS THE END OF THE PROMPTING             */ 02050000
*   /*                                                               */ 02051000
*   /*****************************************************************/ 02052000
*                                                                  0480 02053000
*   IF GTFIOP='0'B                  /* WAS THERE TO BE IO PROMPTING?    02054000
*                                                              Y02014*/ 02055000
*     THEN                          /* NO                            */ 02056000
@RF00475 L     @10,INITPTR(,PCTPTR)                                0480 02057000
         TM    GTFIOP(@10),B'00000001'                             0480 02058000
         BZ    @RT00480                                            0480 02059000
*     GO TO PMT48;                  /* NO THERE WASN'T SO THERE IS NO   02060000
*                                      IO TABLE                      */ 02061000
*                                                                  0481 02062000
*   /*****************************************************************/ 02063000
*   /*                                                               */ 02064000
*   /* YES THERE WAS SO ARE THERE ANY ENTRIES IN THE IO TABLE?       */ 02065000
*   /*                                                               */ 02066000
*   /*****************************************************************/ 02067000
*                                                                  0482 02068000
*   IF IOFTPTR=IOTAB                /*                         Y02014*/ 02069000
*     THEN                          /* NO                            */ 02070000
         L     @03,IOFTPTR                                         0482 02071000
         C     @03,IOTAB(,@10)                                     0482 02072000
         BE    @RT00482                                            0482 02073000
*     GO TO PMT47;                  /* NO GO FREE THE TABLE          */ 02074000
*   ENTRYPTR=IOFTPTR;               /* YES THEN SET THE CURRENT ENTRY   02075000
*                                      PTR TO THE NEXT EMPTY SLOT    */ 02076000
         LR    ENTRYPTR,@03                                        0484 02077000
*   LSTENTRY=ELIND;                 /* STORE 'FFFFFF'X INTO AS THE 0485 02078000
*                                      LAST ENTRY                    */ 02079000
         MVC   LSTENTRY(3,ENTRYPTR),ELIND                          0485 02080000
*   GO TO PMT48;                    /* GO CHECK SIO                  */ 02081000
         B     PMT48                                               0486 02082000
*PMT47:                             /* FREE IO EBCDIC TABLE          */ 02083000
*   FREEAD=IOTAB;                   /* ADDR OF STORAGE         Y02014*/ 02084000
PMT47    L     @10,INITPTR(,PCTPTR)                                0487 02085000
         L     FREEAD,IOTAB(,@10)                                  0487 02086000
*   DO;                             /* FREEMAIN(R) LV(153)A(FREETB)  */ 02087000
*     RESPECIFY                                                    0489 02088000
*      (GPR01F,                                                    0489 02089000
*       GPR00F)RESTRICTED;                                         0489 02090000
*     GPR00F=153;                   /* LENGTH REQUESTED              */ 02091000
         LA    GPR00F,153                                          0490 02092000
*     GPR01F=ADDR(FREETB);          /* SET REGISTER ONE              */ 02093000
         LR    GPR01F,FREEAD                                       0491 02094000
*     SVC(10);                      /* R-FORM OF GETMAIN             */ 02095000
         SVC   10                                                  0492 02096000
*     RESPECIFY                                                    0493 02097000
*      (GPR01F,                                                    0493 02098000
*       GPR00F)UNRESTRICTED;                                       0493 02099000
*   END;                            /* FREEMAIN(R) LV(153)A(FREETB)  */ 02100000
*   IOTAB=0;                        /* ZERO THE PTR IN THE TVT TO THE   02101000
*                                      IO TABLE                Y02014*/ 02102000
         L     @10,INITPTR(,PCTPTR)                                0495 02103000
         SR    @03,@03                                             0495 02104000
         ST    @03,IOTAB(,@10)                                     0495 02105000
*   GTFIOP='0'B;                    /* TURN OFF THE IO PROMPT BIT  0496 02106000
*                                                              Y02014*/ 02107000
*   GTFIO='1'B;                     /* SINCE NO PROMPT WAS GIVEN   0497 02108000
*                                      THERE SHOULD BE A FULL TRACE     02109000
*                                      OF IO                   Y02014*/ 02110000
         OI    GTFIO(@10),B'00000010'                              0497 02111000
         NI    GTFIOP(@10),B'11111110'                             0497 02112000
*   PCTIOF='0'B;                    /* TURN OFF PCTCATF FILTER BIT 0498 02113000
*                                                              Y02014*/ 02114000
         NI    PCTIOF(PCTPTR),B'11110111'                          0498 02115000
*PMT48:                             /* SIO                           */ 02116000
*                                                                  0499 02117000
*   /*****************************************************************/ 02118000
*   /*                                                               */ 02119000
*   /* WAS THERE TO BE SIO PROMPTING?                                */ 02120000
*   /*                                                               */ 02121000
*   /*****************************************************************/ 02122000
*                                                                  0499 02123000
*   IF GTFSIOP='0'B                 /*                         Y02014*/ 02124000
*     THEN                          /* NO                            */ 02125000
PMT48    L     @10,INITPTR(,PCTPTR)                                0499 02126000
         TM    GTFSIOP(@10),B'00010000'                            0499 02127000
         BZ    @RT00499                                            0499 02128000
*     GO TO PMT50;                  /* NO SO GO ON TO PI             */ 02129000
*                                                                  0500 02130000
*   /*****************************************************************/ 02131000
*   /*                                                               */ 02132000
*   /* YES, ARE THERE ANY SIO ENTRIES IN THE TABLE                   */ 02133000
*   /*                                                               */ 02134000
*   /*****************************************************************/ 02135000
*                                                                  0501 02136000
*   IF SIOFTPTR=SIOTAB              /*                         Y02014*/ 02137000
*     THEN                          /* NO                            */ 02138000
         L     @03,SIOFTPTR                                        0501 02139000
         C     @03,SIOTAB(,@10)                                    0501 02140000
         BE    @RT00501                                            0501 02141000
*     GO TO PMT49;                  /* NO                            */ 02142000
*   ENTRYPTR=SIOFTPTR;              /* YES THERE ARE, SET THE CURRENT   02143000
*                                      TABLE PTR TO THE SIO TABLE    */ 02144000
         LR    ENTRYPTR,@03                                        0503 02145000
*   LSTENTRY=ELIND;                 /* STORE 'FFFFFF'X INTO IT AS THE   02146000
*                                      LAST ENTRY                    */ 02147000
         MVC   LSTENTRY(3,ENTRYPTR),ELIND                          0504 02148000
*   GO TO PMT50;                    /* GO ON TO TEST PI              */ 02149000
         B     PMT50                                               0505 02150000
*PMT49:                             /* FREE SIO EBCDIC TABLE   Y02014*/ 02151000
*   FREEAD=SIOTAB;                  /* ADDR OF STORAGE         Y02014*/ 02152000
PMT49    L     @10,INITPTR(,PCTPTR)                                0506 02153000
         L     FREEAD,SIOTAB(,@10)                                 0506 02154000
*   DO;                             /* FREEMAIN(R) LV(153)A(FREETB)  */ 02155000
*     RESPECIFY                                                    0508 02156000
*      (GPR01F,                                                    0508 02157000
*       GPR00F)RESTRICTED;                                         0508 02158000
*     GPR00F=153;                   /* LENGTH REQUESTED              */ 02159000
         LA    GPR00F,153                                          0509 02160000
*     GPR01F=ADDR(FREETB);          /* SET REGISTER ONE              */ 02161000
         LR    GPR01F,FREEAD                                       0510 02162000
*     SVC(10);                      /* R-FORM OF GETMAIN             */ 02163000
         SVC   10                                                  0511 02164000
*     RESPECIFY                                                    0512 02165000
*      (GPR01F,                                                    0512 02166000
*       GPR00F)UNRESTRICTED;                                       0512 02167000
*   END;                            /* FREEMAIN(R) LV(153)A(FREETB)  */ 02168000
*   SIOTAB=0;                       /* ZERO THE TVT PTR TO THE SIO 0514 02169000
*                                      TABLE                   Y02014*/ 02170000
         L     @10,INITPTR(,PCTPTR)                                0514 02171000
         SR    @03,@03                                             0514 02172000
         ST    @03,SIOTAB(,@10)                                    0514 02173000
*   GTFSIOP='0'B;                   /* TURN OFF THE SIO PROMPTING BIT   02174000
*                                                              Y02014*/ 02175000
*   GTFSIO='1'B;                    /* SINCE THERE WAS NO PROMPTING     02176000
*                                      THERE SHOULD BE FULL SIO    0516 02177000
*                                                              Y02014*/ 02178000
         OI    GTFSIO(@10),B'00100000'                             0516 02179000
         NI    GTFSIOP(@10),B'11101111'                            0516 02180000
*   PCTSIOF='0'B;                   /* TURN OFF CATF FILTER BIT    0517 02181000
*                                                              Y02014*/ 02182000
         NI    PCTSIOF(PCTPTR),B'11111011'                         0517 02183000
*PMT50:                             /* PI?                           */ 02184000
*                                                                  0518 02185000
*   /*****************************************************************/ 02186000
*   /*                                                               */ 02187000
*   /* WAS THERE TO BE PI PROMPTING?                                 */ 02188000
*   /*                                                               */ 02189000
*   /*****************************************************************/ 02190000
*                                                                  0518 02191000
*   IF GTFPIP='0'B                  /* WAS THERE TO BE PI PROMPTING?    02192000
*                                                              Y02014*/ 02193000
*     THEN                          /* NO                            */ 02194000
PMT50    L     @10,INITPTR(,PCTPTR)                                0518 02195000
         TM    GTFPIP(@10),B'00000100'                             0518 02196000
         BZ    @RT00518                                            0518 02197000
*     GO TO PMT52;                  /* NO                            */ 02198000
*                                                                  0519 02199000
*   /*****************************************************************/ 02200000
*   /*                                                               */ 02201000
*   /* YES, THERE WAS TO HAVE BEEN PI PROMTING                       */ 02202000
*   /*                                                               */ 02203000
*   /*****************************************************************/ 02204000
*                                                                  0520 02205000
*   IF PIFIPTR=PITAB                /* YES, ARE THERE ANY PI TABLE 0520 02206000
*                                      ENTRIES?                Y02014*/ 02207000
*     THEN                          /* NO                            */ 02208000
         L     @03,PIFIPTR                                         0520 02209000
         C     @03,PITAB(,@10)                                     0520 02210000
         BE    @RT00520                                            0520 02211000
*     GO TO PMT51;                  /* NO                            */ 02212000
*   ENTRYPTR=PIFIPTR;               /* YES, SET THE CURRENT TABLE  0522 02213000
*                                      POINTER TO THE PI TABLE       */ 02214000
         LR    ENTRYPTR,@03                                        0522 02215000
*   LSTENTRY=ELIND;                 /* PUT 'FFFFFF'X IN AS THE LAST     02216000
*                                      ENTRY                         */ 02217000
         MVC   LSTENTRY(3,ENTRYPTR),ELIND                          0523 02218000
*   GO TO PMT52;                    /* GO ON TO SVC                  */ 02219000
         B     PMT52                                               0524 02220000
*PMT51:                             /* FREE PI TABLE           Y02014*/ 02221000
*   FREEAD=PITAB;                   /* ADRESS OF STORAGE       Y02014*/ 02222000
PMT51    L     @10,INITPTR(,PCTPTR)                                0525 02223000
         L     FREEAD,PITAB(,@10)                                  0525 02224000
*   DO;                             /* FREEMAIN(R) LV(60)A(FREETB)   */ 02225000
*     RESPECIFY                                                    0527 02226000
*      (GPR01F,                                                    0527 02227000
*       GPR00F)RESTRICTED;                                         0527 02228000
*     GPR00F=60;                    /* LENGTH REQUESTED              */ 02229000
         LA    GPR00F,60                                           0528 02230000
*     GPR01F=ADDR(FREETB);          /* SET REGISTER ONE              */ 02231000
         LR    GPR01F,FREEAD                                       0529 02232000
*     SVC(10);                      /* R-FORM OF GETMAIN             */ 02233000
         SVC   10                                                  0530 02234000
*     RESPECIFY                                                    0531 02235000
*      (GPR01F,                                                    0531 02236000
*       GPR00F)UNRESTRICTED;                                       0531 02237000
*   END;                            /* FREEMAIN(R) LV(60)A(FREETB)   */ 02238000
*   PITAB=0;                        /* ZERO THE TVT PTR TO THE PI  0533 02239000
*                                      TABLE                   Y02014*/ 02240000
         L     @10,INITPTR(,PCTPTR)                                0533 02241000
         SR    @03,@03                                             0533 02242000
         ST    @03,PITAB(,@10)                                     0533 02243000
*   GTFPIP='0'B;                    /* TURN OFF THE PI PROMPTING BIT    02244000
*                                                              Y02014*/ 02245000
*   GTFPI='1'B;                     /* TURN ON THE TRACE ALL SINCE 0535 02246000
*                                      THERE WAS NO PI PROMPTING   0535 02247000
*                                                              Y02014*/ 02248000
         OI    GTFPI(@10),B'00001000'                              0535 02249000
         NI    GTFPIP(@10),B'11111011'                             0535 02250000
*   PCTPIF='0'B;                    /* TURN OFF CATF FILTER BIT    0536 02251000
*                                                              Y02014*/ 02252000
         NI    PCTPIF(PCTPTR),B'11111101'                          0536 02253000
*PMT52:                             /* SVC?                          */ 02254000
*                                                                  0537 02255000
*   /*****************************************************************/ 02256000
*   /*                                                               */ 02257000
*   /* WAS THERE TO BE SVC PROMPTING?                                */ 02258000
*   /*                                                               */ 02259000
*   /*****************************************************************/ 02260000
*                                                                  0537 02261000
*   IF GTFSVCP='0'B                 /*                         Y02014*/ 02262000
*     THEN                          /* NO                            */ 02263000
PMT52    L     @10,INITPTR(,PCTPTR)                                0537 02264000
         TM    GTFSVCP(@10),B'01000000'                            0537 02265000
         BZ    @RT00537                                            0537 02266000
*     GO TO PMT54;                  /* NO THEN SKIP LOOKING AT THE 0538 02267000
*                                      TABLE BECAUSE THERE WON'T BE     02268000
*                                      ANY TABLE                     */ 02269000
*                                                                  0538 02270000
*   /*****************************************************************/ 02271000
*   /*                                                               */ 02272000
*   /* HAVE ANY ENTRIES BEEN MADE IN THE SVC TABLE?                  */ 02273000
*   /*                                                               */ 02274000
*   /*****************************************************************/ 02275000
*                                                                  0539 02276000
*   IF SVCFIPTR=SVCTAB              /*                         Y02014*/ 02277000
*     THEN                          /* NO                            */ 02278000
         L     @03,SVCFIPTR                                        0539 02279000
         C     @03,SVCTAB(,@10)                                    0539 02280000
         BE    @RT00539                                            0539 02281000
*     GO TO PMT53;                  /* NO SO DELETE THE TABLE        */ 02282000
*   ENTRYPTR=SVCFIPTR;              /* YES SO SET THE CURRENT ENTRY     02283000
*                                      PTR TO THE SVC TABLE NEXT   0541 02284000
*                                      EMPTY SLOT                    */ 02285000
         LR    ENTRYPTR,@03                                        0541 02286000
*   LSTENTRY=ELIND;                 /* AND PUT THE 'FFFFFF'X ENTRY AT   02287000
*                                      THE END                       */ 02288000
         MVC   LSTENTRY(3,ENTRYPTR),ELIND                          0542 02289000
*   GO TO PMT54;                    /* BRANCH AROUND THE CODE THAT 0543 02290000
*                                      FREES THE SVC TABLE CORE      */ 02291000
         B     PMT54                                               0543 02292000
*PMT53:                             /* FREE SVC EBCDIC TABLE   Y02014*/ 02293000
*   FREEAD=SVCTAB;                  /* ADDRESS OF STORAGE      Y02014*/ 02294000
PMT53    L     @10,INITPTR(,PCTPTR)                                0544 02295000
         L     FREEAD,SVCTAB(,@10)                                 0544 02296000
*   DO;                             /* FREEMAIN(R) LV(153)A(FREETB)  */ 02297000
*     RESPECIFY                                                    0546 02298000
*      (GPR01F,                                                    0546 02299000
*       GPR00F)RESTRICTED;                                         0546 02300000
*     GPR00F=153;                   /* LENGTH REQUESTED              */ 02301000
         LA    GPR00F,153                                          0547 02302000
*     GPR01F=ADDR(FREETB);          /* SET REGISTER ONE              */ 02303000
         LR    GPR01F,FREEAD                                       0548 02304000
*     SVC(10);                      /* R-FORM OF GETMAIN             */ 02305000
         SVC   10                                                  0549 02306000
*     RESPECIFY                                                    0550 02307000
*      (GPR01F,                                                    0550 02308000
*       GPR00F)UNRESTRICTED;                                       0550 02309000
*   END;                            /* FREEMAIN(R) LV(153)A(FREETB)  */ 02310000
*   SVCTAB=0;                       /* ZERO THE TVT PTR TO THE SVC 0552 02311000
*                                      TABLE                   Y02014*/ 02312000
         L     @10,INITPTR(,PCTPTR)                                0552 02313000
         SR    @03,@03                                             0552 02314000
         ST    @03,SVCTAB(,@10)                                    0552 02315000
*   GTFSVCP='0'B;                   /* TURN OFF THE SVC PROMPTING BIT   02316000
*                                                              Y02014*/ 02317000
*   GTFSVC='1'B;                    /* SINCE THERE WAS NO PROMPTING     02318000
*                                      TURN ON THE TRACE ALL SVC BIT    02319000
*                                                              Y02014*/ 02320000
         OI    GTFSVC(@10),B'10000000'                             0554 02321000
         NI    GTFSVCP(@10),B'10111111'                            0554 02322000
*   PCTSVCF='0'B;                   /* TURN OFF CATF FILTERING BIT 0555 02323000
*                                                              Y02014*/ 02324000
         NI    PCTSVCF(PCTPTR),B'11101111'                         0555 02325000
*                                                                  0556 02326000
*/********************************************************************/ 02327000
*/*                                                                  */ 02328000
*/* CHECK FOR FULL TABLES AND SORT THEM INTO ASENDING ORDER          */ 02329000
*/*                                                                  */ 02330000
*/********************************************************************/ 02331000
*                                                                  0556 02332000
*PMT54:                                                            0556 02333000
*   EBCIO=IOTAB;                    /* STORE ADDRESS IN ORDERED    0556 02334000
*                                      STRUCTURE               Y02014*/ 02335000
PMT54    L     @10,INITPTR(,PCTPTR)                                0556 02336000
         MVC   EBCIO(4),IOTAB(@10)                                 0556 02337000
*   EBCSIO=SIOTAB;                  /* STORE ADDRESS IN ORDERED    0557 02338000
*                                      STRUCTURE               Y02014*/ 02339000
         MVC   EBCSIO(4),SIOTAB(@10)                               0557 02340000
*   EBCSVC=SVCTAB;                  /* STORE ADDRESS IN ORDERED    0558 02341000
*                                      STRUCTURE               Y02014*/ 02342000
         MVC   EBCSVC(4),SVCTAB(@10)                               0558 02343000
*   EBCPI=PITAB;                    /* STORE ADRESS IN ORDERED     0559 02344000
*                                      STRUCTURE               Y02014*/ 02345000
         MVC   EBCPI(4),PITAB(@10)                                 0559 02346000
*   FLTRAD=ADDR(EBCIO);             /* POINT TO THE ADDRESS OF THE 0560 02347000
*                                      FIRST OF THE FOUR DEVICE    0560 02348000
*                                      TABLES                  Y02014*/ 02349000
         LA    FLTRAD,EBCIO                                        0560 02350000
*   ENTRYPTR=ADDR(IOFTPTR);         /* AND POINT TO THE ADDRESS OF 0561 02351000
*                                      THE END OF IT                 */ 02352000
         LA    ENTRYPTR,IOFTPTR                                    0561 02353000
*PMT55:                             /* EMPTY?                        */ 02354000
*                                                                  0562 02355000
*   /*****************************************************************/ 02356000
*   /*                                                               */ 02357000
*   /* ARE THERE ENTRIES IN THIS TABLE?                              */ 02358000
*   /*                                                               */ 02359000
*   /*****************************************************************/ 02360000
*                                                                  0562 02361000
*   IF GTFFTAD=0                    /*                         Y02014*/ 02362000
*     THEN                          /* NO                            */ 02363000
PMT55    L     @10,GTFFTAD(,FLTRAD)                                0562 02364000
         LTR   @10,@10                                             0562 02365000
         BZ    @RT00562                                            0562 02366000
*     GO TO PMT57;                  /* NO GO ON TO THE NEXT          */ 02367000
*   OPPTR=GTFFTAD;                  /* YES SET THE CURRENT TABLE PTR    02368000
*                                      TO IT                   Y02014*/ 02369000
         L     @07,GTFFTAD(,FLTRAD)                                0564 02370000
         LR    OPPTR,@07                                           0564 02371000
*   J=(ENDPTR-OPPTR)/3;             /* FIGURE THE NUMBER OF ENTRIES     02372000
*                                      IN THE TABLE                  */ 02373000
         L     @08,ENDPTR(,ENTRYPTR)                               0565 02374000
         SR    @08,OPPTR                                           0565 02375000
         SRDA  @08,32                                              0565 02376000
         D     @08,@CF00071                                        0565 02377000
         LR    J,@09                                               0565 02378000
*PMT56:                             /* TOP OF LOOP                   */ 02379000
*   J=J-1;                          /* SET UP OUTER LOOP FOR BUBBLE     02380000
*                                      SORT                          */ 02381000
PMT56    BCTR  J,0                                                 0566 02382000
*   EXCHG=0;                        /* INITIALIZE SWITCH TO SHOW THAT   02383000
*                                      NO SWAP HAS BEEN MADE         */ 02384000
*                                                                  0567 02385000
         SR    EXCHG,EXCHG                                         0567 02386000
*   /*****************************************************************/ 02387000
*   /*                                                               */ 02388000
*   /* INNER LOOP OF BUBBLE SORT MOVES THE LARGEST ENTRY TO THE END  */ 02389000
*   /*                                                               */ 02390000
*   /*****************************************************************/ 02391000
*                                                                  0568 02392000
*   DO I=1 TO J;                                                   0568 02393000
*                                                                  0568 02394000
         LA    I,1                                                 0568 02395000
         B     @DE00568                                            0568 02396000
@DL00568 DS    0H                                                  0569 02397000
*     /***************************************************************/ 02398000
*     /*                                                             */ 02399000
*     /* IS THIS ENTRY LARGER THAN THE NEXT ONE?                     */ 02400000
*     /*                                                             */ 02401000
*     /***************************************************************/ 02402000
*                                                                  0569 02403000
*     IF ENTRX(I)>ENTRX(I+1)THEN    /* YES                           */ 02404000
         LR    @15,I                                               0569 02405000
         MH    @15,@CH00071                                        0569 02406000
         ST    @15,@TF00001                                        0569 02407000
         ALR   @15,OPPTR                                           0569 02408000
         AL    @15,@CF00584                                        0569 02409000
         LR    @14,OPPTR                                           0569 02410000
         AL    @14,@TF00001                                        0569 02411000
         CLC   ENTRX(3,@15),ENTRX(@14)                             0569 02412000
         BNH   @RF00569                                            0569 02413000
*       DO;                         /* YES, SWAP                     */ 02414000
*         NUMBER=ENTRX(I);          /* STORE THIS ENTRY IN TEMP    0571 02415000
*                                      STORAGE                       */ 02416000
         LR    @15,OPPTR                                           0571 02417000
         AL    @15,@TF00001                                        0571 02418000
         AL    @15,@CF00584                                        0571 02419000
         MVC   NUMBER(3),ENTRX(@15)                                0571 02420000
*         ENTRX(I)=ENTRX(I+1);      /* MOVE THE NEXT ENTRY WHERE THIS   02421000
*                                      ONE WAS                       */ 02422000
         LR    @15,OPPTR                                           0572 02423000
         AL    @15,@TF00001                                        0572 02424000
         AL    @15,@CF00584                                        0572 02425000
         LR    @14,OPPTR                                           0572 02426000
         AL    @14,@TF00001                                        0572 02427000
         MVC   ENTRX(3,@15),ENTRX(@14)                             0572 02428000
*         ENTRX(I+1)=NUMBER;        /* AND PUT THIS ONE WHERE IT WAS */ 02429000
         LR    @15,OPPTR                                           0573 02430000
         AL    @15,@TF00001                                        0573 02431000
         MVC   ENTRX(3,@15),NUMBER                                 0573 02432000
*         EXCHG=1;                  /* SET THE SWITCH TO SHOW THAT 0574 02433000
*                                      THERE WAS A SWAP              */ 02434000
         LA    EXCHG,1                                             0574 02435000
*       END;                                                       0575 02436000
*   END;                            /* CONTINUE THE LOOP             */ 02437000
*                                                                  0576 02438000
@RF00569 AH    I,@CH00041                                          0576 02439000
@DE00568 CR    I,J                                                 0576 02440000
         BNH   @DL00568                                            0576 02441000
*   /*****************************************************************/ 02442000
*   /*                                                               */ 02443000
*   /* WERE THERE ANY SWAPS?                                         */ 02444000
*   /*                                                               */ 02445000
*   /*****************************************************************/ 02446000
*                                                                  0577 02447000
*   IF EXCHG^=0 THEN                /* NO                            */ 02448000
         CH    EXCHG,@CH00409                                      0577 02449000
         BNE   @RT00577                                            0577 02450000
*     GO TO PMT56;                  /* NO, SO THEN THERE IS NO NEED     02451000
*                                      TO SORT ANYMORE THE LIST IS IN   02452000
*                                      ORDER                         */ 02453000
*PMT57:                             /* NEXT                          */ 02454000
*   ENTRYPTR=ENTRYPTR+4;            /* MOVE THE PTR TO THE PTRS UP TO   02455000
*                                      THE NEXT                      */ 02456000
PMT57    LA    @10,4                                               0579 02457000
         AR    ENTRYPTR,@10                                        0579 02458000
*   FLTRAD=FLTRAD+4;                /* ALSO MOVE THE PTR TO THE END     02459000
*                                      PTRS UP ONE                   */ 02460000
*                                                                  0580 02461000
         AR    FLTRAD,@10                                          0580 02462000
*   /*****************************************************************/ 02463000
*   /*                                                               */ 02464000
*   /* TEST TO SEE IF ALL 4 TABLES HAVE BEEN DONE                    */ 02465000
*   /*                                                               */ 02466000
*   /*****************************************************************/ 02467000
*                                                                  0581 02468000
*   IF FLTRAD<=ADDR(EBCIO)+12       /*                         Y02014*/ 02469000
*     THEN                          /* NO                            */ 02470000
         LA    @10,EBCIO                                           0581 02471000
         AH    @10,@CH00033                                        0581 02472000
         CR    FLTRAD,@10                                          0581 02473000
         BNH   @RT00581                                            0581 02474000
*     GO TO PMT55;                  /* NO SO CONTINUE THE LOOP       */ 02475000
*                                                                  0583 02476000
*/********************************************************************/ 02477000
*/*                                                                  */ 02478000
*/* COMPARE THE IO & SIO TABLES TO SEE IF THEY ARE EQUAL AND IF SO   */ 02479000
*/* SET THE IOEQ BIT AND FREEMAIN THE SIO TABLE                      */ 02480000
*/*                                                                  */ 02481000
*/********************************************************************/ 02482000
*                                                                  0583 02483000
*   IF GTFIOP='0'B|GTFSIOP='0'B     /* IS EITHER THE IO OR     Y02014*/ 02484000
*     THEN                          /* THE SIO PROMPTING BIT OFF?    */ 02485000
         L     @10,INITPTR(,PCTPTR)                                0583 02486000
         TM    GTFIOP(@10),B'00010001'                             0583 02487000
         BNO   @RT00583                                            0583 02488000
*     GO TO PMT68;                  /* YES SO DON'T TRY TO COMPARE 0584 02489000
*                                      THE TABLES              Y02014*/ 02490000
*   OPPTR=IOTAB;                    /* NO SO SET UP TO COMPARE THE IO   02491000
*                                      TO THE SIO TABLE SET UP BASE     02492000
*                                      FOR IOENT               Y02014*/ 02493000
*                                                                  0585 02494000
         L     OPPTR,IOTAB(,@10)                                   0585 02495000
*   /*****************************************************************/ 02496000
*   /*                                                               */ 02497000
*   /* LOOP THROUGH THE TABLES                                       */ 02498000
*   /*                                                               */ 02499000
*   /*****************************************************************/ 02500000
*                                                                  0586 02501000
*   DO I=1 TO 50;                                                  0586 02502000
*                                                                  0586 02503000
         LA    I,1                                                 0586 02504000
@DL00586 DS    0H                                                  0587 02505000
*     /***************************************************************/ 02506000
*     /*                                                             */ 02507000
*     /* ARE THESE TO ENTRIES THE SAME?                              */ 02508000
*     /*                                                             */ 02509000
*     /***************************************************************/ 02510000
*                                                                  0587 02511000
*     IF IOENT(I)^=SIOENT(I)THEN    /* NO                            */ 02512000
         LR    @10,I                                               0587 02513000
         MH    @10,@CH00071                                        0587 02514000
         L     @03,INITPTR(,PCTPTR)                                0587 02515000
         L     @03,SIOTAB(,@03)                                    0587 02516000
         ST    @10,@TF00001                                        0587 02517000
         ALR   @10,OPPTR                                           0587 02518000
         AL    @10,@CF00584                                        0587 02519000
         AL    @03,@TF00001                                        0587 02520000
         AL    @03,@CF00584                                        0587 02521000
         CLC   IOENT(3,@10),SIOENT(@03)                            0587 02522000
         BNE   @RT00587                                            0587 02523000
*       GO TO PMT68;                /* NO SO LEAVE THE LOOP THE    0588 02524000
*                                      TABLES ARE NOT THE SAME Y02014*/ 02525000
*     IF IOENT(I)=ELIND             /* IS THIS THE END OF THE IO   0589 02526000
*                                      TABLE?                        */ 02527000
*       THEN                        /* YES                           */ 02528000
         LR    @10,OPPTR                                           0589 02529000
         AL    @10,@TF00001                                        0589 02530000
         AL    @10,@CF00584                                        0589 02531000
         CLC   IOENT(3,@10),ELIND                                  0589 02532000
         BE    @RT00589                                            0589 02533000
*       GO TO PMT63;                /* YES AND IF WE HAVEN'T HAD A 0590 02534000
*                                      DIFFERENCE YET THEN THIS MUST    02535000
*                                      ALSO BE THE END OF THE SIO  0590 02536000
*                                      TABLE AND THEY MUST BE THE  0590 02537000
*                                      SAME SO LEAVE THE LOOP        */ 02538000
*   END;                                                           0591 02539000
         AH    I,@CH00041                                          0591 02540000
         CH    I,@CH00550                                          0591 02541000
         BNH   @DL00586                                            0591 02542000
*PMT63:                             /* IOEQ ON                       */ 02543000
*   GTFIOSIO='1'B;                  /* SINCE BOTH IO & SIO ARE THE 0592 02544000
*                                      SAME TURN ON THE IOEQ BIT IN     02545000
*                                      INITDATA                Y02014*/ 02546000
PMT63    L     @10,INITPTR(,PCTPTR)                                0592 02547000
         OI    GTFIOSIO(@10),B'00000001'                           0592 02548000
*   FREEAD=SIOTAB;                  /* POINT TO AREA TO FREE   Y02014*/ 02549000
         L     FREEAD,SIOTAB(,@10)                                 0593 02550000
*   DO;                             /* FREEMAIN(R) LV(153)A(FREETB)  */ 02551000
*     RESPECIFY                                                    0595 02552000
*      (GPR01F,                                                    0595 02553000
*       GPR00F)RESTRICTED;                                         0595 02554000
*     GPR00F=153;                   /* LENGTH REQUESTED              */ 02555000
         LA    GPR00F,153                                          0596 02556000
*     GPR01F=ADDR(FREETB);          /* SET REGISTER ONE              */ 02557000
         LR    GPR01F,FREEAD                                       0597 02558000
*     SVC(10);                      /* R-FORM OF GETMAIN             */ 02559000
         SVC   10                                                  0598 02560000
*     RESPECIFY                                                    0599 02561000
*      (GPR01F,                                                    0599 02562000
*       GPR00F)UNRESTRICTED;                                       0599 02563000
*   END;                            /* FREEMAIN(R) LV(153)A(FREETB)  */ 02564000
*                                   /* FREE SIO TABLE Y02014         */ 02565000
*   SIOTAB=IOTAB;                   /* THEN PUT THE IO TABLE ADDRESS    02566000
*                                      IN INITDATA IN PLACE OF THE 0601 02567000
*                                      SIO TABLE SO THAT IT WILL BE     02568000
*                                      USED FOR BOTH           Y02014*/ 02569000
         L     @10,INITPTR(,PCTPTR)                                0601 02570000
         MVC   SIOTAB(4,@10),IOTAB(@10)                            0601 02571000
*   GOTO PMT68;                     /* PREPARE FOR RETURN      Y02014*/ 02572000
         B     PMT68                                               0602 02573000
*                                                                  0603 02574000
*/********************************************************************/ 02575000
*/*                                                                  */ 02576000
*/* THE CODE BRANCHES HERE WHEN AN ERROR HAS OCCURRED THAT           */ 02577000
*/* INVALIDATES A LINE OF INPUT.  IF PROMPTING IS FROM THE CONSOLE   */ 02578000
*/* IT BRANCHES BACK TO THE BEGINNING OF THE PROMPTING LOOP.         */ 02579000
*/* IF PROMPTING IS FROM PARMLIB THE RETRY BIT IS SET AND IT RETURNS */ 02580000
*/*                                                                  */ 02581000
*/********************************************************************/ 02582000
*                                                                  0603 02583000
*PMT09:                                                            0603 02584000
*   ICTMSGX=6;                      /* SET INDEX FOR MSG AHL105A     */ 02585000
PMT09    L     @10,INITPTR(,PCTPTR)                                0603 02586000
         MVI   ICTMSGX(@10),X'06'                                  0603 02587000
*PMT05:                                                            0604 02588000
*                                                                  0604 02589000
*   /*****************************************************************/ 02590000
*   /*                                                               */ 02591000
*   /* IS INPUT FROM PARMLIB?                                  Y02014*/ 02592000
*   /*                                                               */ 02593000
*   /*****************************************************************/ 02594000
*                                                                  0604 02595000
*   IF ICTPLIB='0'B THEN            /* NO                            */ 02596000
PMT05    L     @10,INITPTR(,PCTPTR)                                0604 02597000
         TM    ICTPLIB(@10),B'10000000'                            0604 02598000
         BZ    @RT00604                                            0604 02599000
*     GO TO PMT61;                  /* NO SO GO PRINT THE MSG TO THE    02600000
*                                      CONSOLE AND GET ANOTHER LINE     02601000
*                                      OF INPUT                      */ 02602000
*   ICTIOTYP=4;                     /* YES SO INFORM THE OPERATOR  0606 02603000
*                                      THAT THERE WAS AN ERROR       */ 02604000
         MVI   ICTIOTYP(@10),X'04'                                 0606 02605000
*   CALL AHLTIO;                    /* GO DO THE IO            Y02014*/ 02606000
*                                                                  0607 02607000
         L     @15,@CV00303                                        0607 02608000
         BALR  @14,@15                                             0607 02609000
*   /*****************************************************************/ 02610000
*   /*                                                               */ 02611000
*   /* HAS THE STOP/MODIFY ECB BEEN POSTED?                          */ 02612000
*   /*                                                               */ 02613000
*   /*****************************************************************/ 02614000
*                                                                  0608 02615000
*   IF ICTSTOP='1'B THEN            /* YES                           */ 02616000
         L     @10,INITPTR(,PCTPTR)                                0608 02617000
         TM    ICTSTOP(@10),B'00000100'                            0608 02618000
         BO    @RT00608                                            0608 02619000
*     GO TO PMT70;                  /* YES RETURN A CODE OF 12       */ 02620000
*   ICTMSGX=22;                     /* NO SET THE INDEX FOR MSG    0610 02621000
*                                      AHL124I                 Y02014*/ 02622000
         MVI   ICTMSGX(@10),X'16'                                  0610 02623000
*   ICTIOTYP=2;                     /* AND MSG TYPE TO WTO           */ 02624000
         MVI   ICTIOTYP(@10),X'02'                                 0611 02625000
*   CALL AHLTIO;                    /* GO WRITE OUT THE REST OF WHAT    02626000
*                                      HAS TO BE SAID          Y02014*/ 02627000
*                                                                  0612 02628000
         L     @15,@CV00303                                        0612 02629000
         BALR  @14,@15                                             0612 02630000
*   /*****************************************************************/ 02631000
*   /*                                                               */ 02632000
*   /* HAS THE STOP/MODIFY ECB BEEN POSTED?                          */ 02633000
*   /*                                                               */ 02634000
*   /*****************************************************************/ 02635000
*                                                                  0613 02636000
*   IF ICTSTOP='1'B THEN            /* YES                           */ 02637000
         L     @10,INITPTR(,PCTPTR)                                0613 02638000
         TM    ICTSTOP(@10),B'00000100'                            0613 02639000
         BO    @RT00613                                            0613 02640000
*     GO TO PMT70;                  /* YES RETURN A CODE OF 12       */ 02641000
*PMT69:                             /* RETRY                         */ 02642000
*   ICTRETRY='1'B;                  /* TURN ON THE RETRY BIT MEANNING   02643000
*                                      THAT THESE TABLES ARE INVALID    02644000
*                                      AND THAT THE PROMPTING MUST BE   02645000
*                                      STARTED OVER AGAIN            */ 02646000
PMT69    L     @10,INITPTR(,PCTPTR)                                0615 02647000
         OI    ICTRETRY(@10),B'00010000'                           0615 02648000
*PMT68:                             /* OK                            */ 02649000
*   SAREG15=0;                      /* RETURN A 0 IN REG15 FOR A   0616 02650000
*                                      NORMAL END                    */ 02651000
PMT68    L     @10,BAKSAPTR(,SAPTR)                                0616 02652000
         SR    @03,@03                                             0616 02653000
         ST    @03,SAREG15(,@10)                                   0616 02654000
*   RETURN;                         /* AND THEN RETURN TO CTL WHICH     02655000
*                                      WILL BACK TRACK TO TRY AGAIN  */ 02656000
@EL00001 L     @13,4(,@13)                                         0617 02657000
@EF00001 DS    0H                                                  0617 02658000
@ER00001 LM    @14,@12,12(@13)                                     0617 02659000
         BR    @14                                                 0617 02660000
*PMT70:                             /* STOP                          */ 02661000
*   SAREG15=12;                     /* RETURN A 12 IN REG 15 IF THE     02662000
*                                      STOP/MODIFY ECB HAS BEEN    0618 02663000
*                                      POSTED                        */ 02664000
PMT70    L     @10,BAKSAPTR(,SAPTR)                                0618 02665000
         MVC   SAREG15(4,@10),@CF00033                             0618 02666000
*   RETURN;                         /*                         Y02014*/ 02667000
         B     @EL00001                                            0619 02668000
*PMT71:                                                            0620 02669000
*   SAREG15=8;                      /* RETURN CODE OF EIGHT FOR ERROR   02670000
*                                      IN GTF INITIALIZATION   Y02014*/ 02671000
PMT71    L     @10,BAKSAPTR(,SAPTR)                                0620 02672000
         MVC   SAREG15(4,@10),@CF00038                             0620 02673000
*   RETURN;                         /* RETURN TO AHLTCTL1;     Y02014*/ 02674000
         B     @EL00001                                            0621 02675000
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */ 02676000
*     GPR00F FIXED(31)REG(0),                                      0622 02677000
*     GPR01F FIXED(31)REG(1),                                      0622 02678000
*     GPR15F FIXED(31)REG(15),                                     0622 02679000
*     GPR01P PTR(31)REG(1);                                        0622 02680000
*   DCL                                                            0623 02681000
*     1 I004 DEF(ILIST)BDY(WORD),   /* LIST FOR GETMAIN              */ 02682000
*      2 I00401 PTR(31),            /* LENGTH                        */ 02683000
*      2 I00402 CHAR(1),            /* HIARCHY                       */ 02684000
*      2 I00403 PTR(24),            /* ADDR OF ADDR LIST             */ 02685000
*      2 I00404 CHAR(1),            /* TYPE OF REQUEST               */ 02686000
*      2 I00405 PTR(8);             /* SUBPOOL VALUE                 */ 02687000
*   DECLARE                                                        0624 02688000
*     ILIST CHAR(10)BDY(DWORD);     /* STANDARD LIST                 */ 02689000
*   DECLARE                         /* COMMON VARIABLES              */ 02690000
*     I256C CHAR(256)BASED,                                        0625 02691000
*     I031F FIXED(31)BASED,                                        0625 02692000
*     I031P PTR(31)BASED,                                          0625 02693000
*     I015F FIXED(15)BASED,                                        0625 02694000
*     I015P PTR(15)BASED,                                          0625 02695000
*     I008P PTR(8)BASED,                                           0625 02696000
*     I001C CHAR(1)BASED;                                          0625 02697000
*   END                             /*                               */ 02698000
*                                                                  0626 02699000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 02700000
*/*%INCLUDE SYSLIB  (GTFPCT  )                                       */ 02701000
*/*%INCLUDE SYSLIB  (INITDATA)                                       */ 02702000
*/*%INCLUDE SYSLIB  (SAVEAREA)                                       */ 02703000
*                                                                  0626 02704000
*       ;                                                          0626 02705000
@DATA    DS    0H                                                       02706000
@CH00409 DC    H'0'                                                     02707000
@CH00041 DC    H'1'                                                     02708000
@CH00327 DC    H'2'                                                     02709000
@CH00273 DC    H'5'                                                     02710000
@CH00308 DC    H'6'                                                     02711000
@CH00075 DC    H'7'                                                     02712000
@CH00550 DC    H'50'                                                    02713000
@CH00230 DC    H'124'                                                   02714000
@SM00580 MVC   TEMPKW(0),MSGREPLY-1(@15)                                02715000
@SM00582 MVC   NUMBER(0),MSGREPLY(@15)                                  02716000
@SM00585 MVC   0(0,@05),MSGREPLY(@14)                                   02717000
         DS    0F                                                       02718000
@SA00001 DS    18F                                                      02719000
@TF00001 DS    F                                                        02720000
         DS    0F                                                       02721000
@CF00584 DC    F'-3'                                                    02722000
@CF00071 DC    F'3'                                                     02723000
@CH00071 EQU   @CF00071+2                                               02724000
@CF00038 DC    F'8'                                                     02725000
@CH00038 EQU   @CF00038+2                                               02726000
@CF00033 DC    F'12'                                                    02727000
@CH00033 EQU   @CF00033+2                                               02728000
@CF00420 DC    F'60'                                                    02729000
@CF00406 DC    F'153'                                                   02730000
@CV00303 DC    V(AHLTIO)                                                02731000
@CV00346 DC    V(AHLCTL2)                                               02732000
         DS    0D                                                       02733000
L        DS    A                                                        02734000
KWPBEG   DS    A                                                        02735000
NEXTKW   DS    A                                                        02736000
KWPEND   DS    A                                                        02737000
GETFREE  DS    A                                                        02738000
ENDSW    DS    AL1                                                      02739000
EODIND   DS    AL1                                                      02740000
PATHSW   DS    AL1                                                      02741000
@CC00444 DC    C'END'                                                   02742000
         DS    CL2                                                      02743000
ENDPTRS  DS    CL16                                                     02744000
         ORG   ENDPTRS                                                  02745000
IOEND    DS    AL4                                                      02746000
SIOEND   DS    AL4                                                      02747000
SVCEND   DS    AL4                                                      02748000
PIEND    DS    AL4                                                      02749000
         ORG   ENDPTRS+16                                               02750000
ELIND    DC    X'FFFFFF'                                                02751000
         DS    CL1                                                      02752000
BGNPTRS  DS    CL16                                                     02753000
         ORG   BGNPTRS                                                  02754000
IOFTPTR  DS    AL4                                                      02755000
SIOFTPTR DS    AL4                                                      02756000
SVCFIPTR DS    AL4                                                      02757000
PIFIPTR  DS    AL4                                                      02758000
         ORG   BGNPTRS+16                                               02759000
NUMBER   DS    CL3                                                      02760000
         ORG   NUMBER                                                   02761000
HIGH1    DS    BL1                                                      02762000
@NM00011 EQU   NUMBER+0                                                 02763000
HIGH2    DS    BL1                                                      02764000
@NM00012 EQU   NUMBER+1                                                 02765000
HIGH3    DS    BL1                                                      02766000
         ORG   NUMBER+3                                                 02767000
BLANK    DC    CL4' '                                                   02768000
         DS    CL1                                                      02769000
EBCTAB   DS    CL16                                                     02770000
         ORG   EBCTAB                                                   02771000
EBCIO    DS    AL4                                                      02772000
EBCSIO   DS    AL4                                                      02773000
EBCSVC   DS    AL4                                                      02774000
EBCPI    DS    AL4                                                      02775000
         ORG   EBCTAB+16                                                02776000
MSK2     DC    X'55'                                                    02777000
TEMPKW   DS    CL7                                                      02778000
CHAR0    DC    CL3'000'                                                 02779000
MAXSVCNO DC    CL3'255'                                                 02780000
MAXPINO  DC    CL3'019'                                                 02781000
TRANEXNO DC    CL3'016'                                                 02782000
PGFLTNO  DC    CL3'017'                                                 02783000
SEGEXNO  DC    CL3'018'                                                 02784000
SSMNO    DC    CL3'019'                                                 02785000
PATCH    DC    CL256'AHLTPMT AHLTPMT AHLTPMT AHLTPMT PATCH AREA'        02786000
         DC    CL144' '                                                 02787000
         DS    CL3                                                      02788000
ILIST    DS    CL10                                                     02789000
PMTAB    DC    CL7'IO=    '                                             02790000
         DC    CL7'SIO=   '                                             02791000
         DC    CL7'SVC=   '                                             02792000
         DC    CL7'PI=    '                                             02793000
         DC    CL7'IO=SIO='                                             02794000
         DC    CL7'SIO=IO='                                             02795000
WTGTAB3  DC    AL4(PMT21)                                               02796000
         DC    AL4(PMT22)                                               02797000
         DC    AL4(PMT41)                                               02798000
         DC    AL4(PMT36)                                               02799000
         DC    AL4(PMT18)                                               02800000
         DC    AL4(PMT18)                                               02801000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02802000
@01      EQU   01                                                       02803000
@02      EQU   02                                                       02804000
@03      EQU   03                                                       02805000
@04      EQU   04                                                       02806000
@05      EQU   05                                                       02807000
@06      EQU   06                                                       02808000
@07      EQU   07                                                       02809000
@08      EQU   08                                                       02810000
@09      EQU   09                                                       02811000
@10      EQU   10                                                       02812000
@11      EQU   11                                                       02813000
@12      EQU   12                                                       02814000
@13      EQU   13                                                       02815000
@14      EQU   14                                                       02816000
@15      EQU   15                                                       02817000
FREEAD   EQU   @03                                                      02818000
FLTRAD   EQU   @03                                                      02819000
EXCHG    EQU   @07                                                      02820000
ENTRYPTR EQU   @06                                                      02821000
KWPSN    EQU   @07                                                      02822000
J        EQU   @10                                                      02823000
K        EQU   @03                                                      02824000
I        EQU   @05                                                      02825000
OPPTR    EQU   @04                                                      02826000
MSGPTR   EQU   @03                                                      02827000
PCTPTR   EQU   @02                                                      02828000
SAPTR    EQU   @13                                                      02829000
ENTBLAD  EQU   @01                                                      02830000
RETCODE  EQU   @15                                                      02831000
GPR01P   EQU   @01                                                      02832000
GPR15F   EQU   @15                                                      02833000
GPR01F   EQU   @01                                                      02834000
GPR00F   EQU   @00                                                      02835000
GTFPCT   EQU   0                                                        02836000
GTFSTAT  EQU   GTFPCT+8                                                 02837000
GTFOPTS  EQU   GTFPCT+12                                                02838000
GTFOPTS1 EQU   GTFOPTS                                                  02839000
GTFOPTS2 EQU   GTFOPTS+1                                                02840000
GTFOPTS3 EQU   GTFOPTS+2                                                02841000
GTFOPTS4 EQU   GTFOPTS+3                                                02842000
PCTCATF  EQU   GTFPCT+16                                                02843000
PCTSVCF  EQU   PCTCATF+1                                                02844000
PCTIOF   EQU   PCTCATF+1                                                02845000
PCTSIOF  EQU   PCTCATF+1                                                02846000
PCTPIF   EQU   PCTCATF+1                                                02847000
INITPTR  EQU   GTFPCT+60                                                02848000
NEXTBLOK EQU   GTFPCT+180                                               02849000
WRTRCOM  EQU   GTFPCT+204                                               02850000
TRMWRIT  EQU   GTFPCT+212                                               02851000
WRTRERR  EQU   GTFPCT+216                                               02852000
GTFSSRB  EQU   GTFPCT+220                                               02853000
QLOCKWRD EQU   GTFPCT+236                                               02854000
QLOCKECB EQU   GTFPCT+240                                               02855000
AUDITFLG EQU   GTFPCT+296                                               02856000
INITDATA EQU   0                                                        02857000
ICT      EQU   INITDATA+16                                              02858000
ICTMSGX  EQU   ICT                                                      02859000
ICTIOTYP EQU   ICT+1                                                    02860000
ICTFLAGS EQU   ICT+2                                                    02861000
ICTPLIB  EQU   ICTFLAGS                                                 02862000
ICTIOERR EQU   ICTFLAGS                                                 02863000
ICTEOD   EQU   ICTFLAGS                                                 02864000
ICTRETRY EQU   ICTFLAGS                                                 02865000
ICTSTOP  EQU   ICTFLAGS                                                 02866000
MSGREPLY EQU   INITDATA+28                                              02867000
GTFOPIND EQU   INITDATA+152                                             02868000
GTFOPT1  EQU   GTFOPIND                                                 02869000
GTFOPT2  EQU   GTFOPIND+1                                               02870000
GTFSVC   EQU   GTFOPT2                                                  02871000
GTFSVCP  EQU   GTFOPT2                                                  02872000
GTFSIO   EQU   GTFOPT2                                                  02873000
GTFSIOP  EQU   GTFOPT2                                                  02874000
GTFPI    EQU   GTFOPT2                                                  02875000
GTFPIP   EQU   GTFOPT2                                                  02876000
GTFIO    EQU   GTFOPT2                                                  02877000
GTFIOP   EQU   GTFOPT2                                                  02878000
GTFOPT3  EQU   GTFOPIND+2                                               02879000
GTFIOSIO EQU   GTFOPT3                                                  02880000
GTFOPT4  EQU   GTFOPIND+3                                               02881000
IOTAB    EQU   INITDATA+156                                             02882000
SIOTAB   EQU   INITDATA+160                                             02883000
SVCTAB   EQU   INITDATA+164                                             02884000
PITAB    EQU   INITDATA+168                                             02885000
TWT      EQU   INITDATA+176                                             02886000
TWTWORK  EQU   TWT+8                                                    02887000
TWTBUF   EQU   TWT+40                                                   02888000
BAKSAPTR EQU   4                                                        02889000
SAVEAREA EQU   0                                                        02890000
SAREG15  EQU   SAVEAREA+16                                              02891000
RTDCODE  EQU   0                                                        02892000
MESSAGE  EQU   0                                                        02893000
ENTRYTBL EQU   0                                                        02894000
ENTRX    EQU   ENTRYTBL                                                 02895000
ENDPTR   EQU   0                                                        02896000
IOENT    EQU   0                                                        02897000
LSTENTRY EQU   0                                                        02898000
MSG10X   EQU   0                                                        02899000
SIOENT   EQU   0                                                        02900000
GTFFTAD  EQU   0                                                        02901000
FREETB   EQU   0                                                        02902000
I001C    EQU   0                                                        02903000
I008P    EQU   0                                                        02904000
I015F    EQU   0                                                        02905000
I015P    EQU   0                                                        02906000
I031F    EQU   0                                                        02907000
I031P    EQU   0                                                        02908000
I256C    EQU   0                                                        02909000
WTOLEN   EQU   TWTBUF+8                                                 02910000
I004     EQU   ILIST                                                    02911000
I00401   EQU   I004                                                     02912000
I00403   EQU   I004+5                                                   02913000
I00404   EQU   I004+8                                                   02914000
I00405   EQU   I004+9                                                   02915000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02916000
I00402   EQU   I004+4                                                   02917000
UNIT     EQU   ENTRX+1                                                  02918000
CHANL    EQU   ENTRX                                                    02919000
SAREG12  EQU   SAVEAREA+68                                              02920000
SAREG11  EQU   SAVEAREA+64                                              02921000
SAREG10  EQU   SAVEAREA+60                                              02922000
SAREG9   EQU   SAVEAREA+56                                              02923000
SAREG8   EQU   SAVEAREA+52                                              02924000
SAREG7   EQU   SAVEAREA+48                                              02925000
SAREG6   EQU   SAVEAREA+44                                              02926000
SAREG5   EQU   SAVEAREA+40                                              02927000
SAREG4   EQU   SAVEAREA+36                                              02928000
SAREG3   EQU   SAVEAREA+32                                              02929000
SAREG2   EQU   SAVEAREA+28                                              02930000
SAREG1   EQU   SAVEAREA+24                                              02931000
SAREG0   EQU   SAVEAREA+20                                              02932000
SAREG14  EQU   SAVEAREA+12                                              02933000
SAFORPTR EQU   SAVEAREA+8                                               02934000
SABAKPTR EQU   SAVEAREA+4                                               02935000
SAVACANT EQU   SAVEAREA                                                 02936000
@NM00010 EQU   TWT+4                                                    02937000
@NM00009 EQU   TWT                                                      02938000
RANGPTR  EQU   INITDATA+172                                             02939000
GTFTIME  EQU   GTFOPT4                                                  02940000
GTFRES3  EQU   GTFOPT4                                                  02941000
GTFRES2  EQU   GTFOPT3                                                  02942000
GTFRR    EQU   GTFOPT3                                                  02943000
GTFSRM   EQU   GTFOPT3                                                  02944000
GTFRNIO  EQU   GTFOPT3                                                  02945000
GTFEXT   EQU   GTFOPT3                                                  02946000
GTFPCI   EQU   GTFOPT1                                                  02947000
GTFRES1  EQU   GTFOPT1                                                  02948000
GTFDSP   EQU   GTFOPT1                                                  02949000
GTFTRC   EQU   GTFOPT1                                                  02950000
GTFUSR   EQU   GTFOPT1                                                  02951000
GTFSYS   EQU   GTFOPT1                                                  02952000
GTFSYSP  EQU   GTFOPT1                                                  02953000
GTFSYSM  EQU   GTFOPT1                                                  02954000
WTORECB  EQU   INITDATA+24                                              02955000
PARMDCB  EQU   INITDATA+20                                              02956000
ICTRESV  EQU   ICTFLAGS                                                 02957000
ICTTRCIN EQU   ICTFLAGS                                                 02958000
EXECPTR  EQU   INITDATA+12                                              02959000
CIBPTR   EQU   INITDATA+8                                               02960000
INITID   EQU   INITDATA                                                 02961000
PCTWTOMD EQU   GTFPCT+312                                               02962000
PCTDMPMD EQU   GTFPCT+308                                               02963000
TRANSMAX EQU   GTFPCT+304                                               02964000
GTFASCB  EQU   GTFPCT+300                                               02965000
@NM00008 EQU   AUDITFLG+3                                               02966000
AFSLEBLD EQU   AUDITFLG+3                                               02967000
WSERFG06 EQU   AUDITFLG+3                                               02968000
WSERFG05 EQU   AUDITFLG+3                                               02969000
WSERFG04 EQU   AUDITFLG+3                                               02970000
WSERFG03 EQU   AUDITFLG+3                                               02971000
WSERFG02 EQU   AUDITFLG+2                                               02972000
WSERFLAG EQU   AUDITFLG+2                                               02973000
TERMFLAG EQU   AUDITFLG+2                                               02974000
AFXWRIT  EQU   AUDITFLG+2                                               02975000
AFQLWAIT EQU   AUDITFLG+2                                               02976000
AFSLEGET EQU   AUDITFLG+2                                               02977000
AFBUFGET EQU   AUDITFLG+2                                               02978000
AFFEOB   EQU   AUDITFLG+2                                               02979000
AFBLKFIX EQU   AUDITFLG+1                                               02980000
AFEQFIX  EQU   AUDITFLG+1                                               02981000
AFPGRLSE EQU   AUDITFLG+1                                               02982000
AFWRAP   EQU   AUDITFLG+1                                               02983000
AFBUFOFF EQU   AUDITFLG+1                                               02984000
AFLDFX   EQU   AUDITFLG+1                                               02985000
AFCLOSE  EQU   AUDITFLG+1                                               02986000
AFOPEN   EQU   AUDITFLG+1                                               02987000
AFGMBLOK EQU   AUDITFLG                                                 02988000
AFGMSRB  EQU   AUDITFLG                                                 02989000
AFWAIT   EQU   AUDITFLG                                                 02990000
AFTERM   EQU   AUDITFLG                                                 02991000
AFINIT   EQU   AUDITFLG                                                 02992000
AFWWRIT  EQU   AUDITFLG                                                 02993000
AFCWRIT  EQU   AUDITFLG                                                 02994000
AFIWRIT  EQU   AUDITFLG                                                 02995000
EQSHORT  EQU   GTFPCT+292                                               02996000
SLEMAX   EQU   GTFPCT+288                                               02997000
SLECNT   EQU   GTFPCT+284                                               02998000
RQPURGE  EQU   GTFPCT+280                                               02999000
RQTOTAL  EQU   GTFPCT+276                                               03000000
WRTDLST  EQU   GTFPCT+272                                               03001000
NUMOFBUF EQU   GTFPCT+268                                               03002000
SBUFDISA EQU   GTFPCT+264                                               03003000
SLESUSED EQU   GTFPCT+260                                               03004000
EQMIN    EQU   GTFPCT+256                                               03005000
EQLENGTH EQU   GTFPCT+252                                               03006000
WQMAX    EQU   GTFPCT+248                                               03007000
WQLENGTH EQU   GTFPCT+244                                               03008000
QLECBP   EQU   QLOCKECB                                                 03009000
@NM00007 EQU   QLOCKECB                                                 03010000
@NM00006 EQU   QLOCKWRD+3                                               03011000
SCHEDBUF EQU   QLOCKWRD+2                                               03012000
POSTWRIT EQU   QLOCKWRD+1                                               03013000
QLOCK    EQU   QLOCKWRD                                                 03014000
WRITERDD EQU   GTFPCT+228                                               03015000
GTFLOSTR EQU   GTFPCT+224                                               03016000
SRBAVAIL EQU   GTFSSRB                                                  03017000
WRTRERRP EQU   WRTRERR                                                  03018000
@NM00005 EQU   WRTRERR                                                  03019000
TRMWRITP EQU   TRMWRIT                                                  03020000
@NM00004 EQU   TRMWRIT                                                  03021000
GTFCMECB EQU   GTFPCT+208                                               03022000
WRTRCOMP EQU   WRTRCOM                                                  03023000
@NM00003 EQU   WRTRCOM                                                  03024000
TRANSCNT EQU   GTFPCT+200                                               03025000
AHLRDPLQ EQU   GTFPCT+196                                               03026000
SFEOBRTN EQU   GTFPCT+192                                               03027000
SBLOKRTN EQU   GTFPCT+188                                               03028000
CURRBLOK EQU   GTFPCT+184                                               03029000
GBCDS    EQU   NEXTBLOK                                                 03030000
WSMODEND EQU   GTFPCT+176                                               03031000
WSMODBEG EQU   GTFPCT+172                                               03032000
BCBPAGE  EQU   GTFPCT+156                                               03033000
SLEPAGE  EQU   GTFPCT+152                                               03034000
SAVECNT  EQU   GTFPCT+148                                               03035000
SLQHEAD  EQU   GTFPCT+144                                               03036000
HQLENGTH EQU   GTFPCT+140                                               03037000
QTAIL    EQU   GTFPCT+136                                               03038000
HQHEAD   EQU   GTFPCT+132                                               03039000
WQHEAD   EQU   GTFPCT+128                                               03040000
RQHEAD   EQU   GTFPCT+124                                               03041000
EQHEAD   EQU   GTFPCT+120                                               03042000
WPOSTSRB EQU   GTFPCT+116                                               03043000
WTSKTCBA EQU   GTFPCT+112                                               03044000
WRTRTCBA EQU   GTFPCT+108                                               03045000
TRMWTASK EQU   GTFPCT+104                                               03046000
WTSKATTH EQU   GTFPCT+100                                               03047000
WTSKINIT EQU   GTFPCT+96                                                03048000
WTASKECB EQU   GTFPCT+92                                                03049000
WMTABPTR EQU   GTFPCT+88                                                03050000
ATTCHECB EQU   GTFPCT+84                                                03051000
AHLECB   EQU   GTFPCT+80                                                03052000
STOPECBA EQU   GTFPCT+76                                                03053000
ECBADRLT EQU   GTFPCT+72                                                03054000
FIXLEN   EQU   GTFPCT+68                                                03055000
FIXPTR   EQU   GTFPCT+64                                                03056000
MCQEPTR  EQU   GTFPCT+56                                                03057000
GTFEIDL  EQU   GTFPCT+52                                                03058000
GTFPIBL  EQU   GTFPCT+48                                                03059000
GTFPIFT  EQU   GTFPCT+44                                                03060000
GTFSVCBL EQU   GTFPCT+40                                                03061000
GTFSVCFT EQU   GTFPCT+36                                                03062000
GTFIOBL  EQU   GTFPCT+32                                                03063000
GTFIOFT  EQU   GTFPCT+28                                                03064000
GTFSIOBL EQU   GTFPCT+24                                                03065000
GTFSIOFT EQU   GTFPCT+20                                                03066000
@NM00002 EQU   PCTCATF+1                                                03067000
PCTRR    EQU   PCTCATF+1                                                03068000
PCTSRM   EQU   PCTCATF+1                                                03069000
PCTRNIO  EQU   PCTCATF+1                                                03070000
PCTUSR   EQU   PCTCATF                                                  03071000
PCTPI    EQU   PCTCATF                                                  03072000
@NM00001 EQU   PCTCATF                                                  03073000
PCTDSP   EQU   PCTCATF                                                  03074000
PCTSIO   EQU   PCTCATF                                                  03075000
PCTIO    EQU   PCTCATF                                                  03076000
PCTEXT   EQU   PCTCATF                                                  03077000
PCTSVC   EQU   PCTCATF                                                  03078000
OPTTIME  EQU   GTFOPTS4                                                 03079000
OPTRES3  EQU   GTFOPTS4                                                 03080000
OPTIOSIO EQU   GTFOPTS3                                                 03081000
OPTRES2  EQU   GTFOPTS3                                                 03082000
OPTRR    EQU   GTFOPTS3                                                 03083000
OPTSRM   EQU   GTFOPTS3                                                 03084000
OPTRNIO  EQU   GTFOPTS3                                                 03085000
OPTEXT   EQU   GTFOPTS3                                                 03086000
OPTIOP   EQU   GTFOPTS2                                                 03087000
OPTIO    EQU   GTFOPTS2                                                 03088000
OPTPIP   EQU   GTFOPTS2                                                 03089000
OPTPI    EQU   GTFOPTS2                                                 03090000
OPTSIOP  EQU   GTFOPTS2                                                 03091000
OPTSIO   EQU   GTFOPTS2                                                 03092000
OPTSVCP  EQU   GTFOPTS2                                                 03093000
OPTSVC   EQU   GTFOPTS2                                                 03094000
OPTPCI   EQU   GTFOPTS1                                                 03095000
OPTRES1  EQU   GTFOPTS1                                                 03096000
OPTDSP   EQU   GTFOPTS1                                                 03097000
OPTTRC   EQU   GTFOPTS1                                                 03098000
OPTUSR   EQU   GTFOPTS1                                                 03099000
OPTSYS   EQU   GTFOPTS1                                                 03100000
OPTSYSP  EQU   GTFOPTS1                                                 03101000
OPTSYSM  EQU   GTFOPTS1                                                 03102000
GTFRESV  EQU   GTFSTAT                                                  03103000
GTFDEBUG EQU   GTFSTAT                                                  03104000
GTFMODE  EQU   GTFSTAT                                                  03105000
GTFPCTID EQU   GTFPCT                                                   03106000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      03107000
@RT00059 EQU   PMT01                                                    03108000
@RT00092 EQU   PMT02                                                    03109000
@RT00125 EQU   PMT03                                                    03110000
@RT00158 EQU   PMT04                                                    03111000
@RT00205 EQU   PMT70                                                    03112000
@RT00212 EQU   PMT69                                                    03113000
@RT00222 EQU   PMT70                                                    03114000
@RT00227 EQU   PMT07                                                    03115000
@RT00233 EQU   PMT10                                                    03116000
@RT00236 EQU   PMT08                                                    03117000
@RT00238 EQU   PMT11                                                    03118000
@RT00240 EQU   PMT11                                                    03119000
@RT00245 EQU   PMT11                                                    03120000
@RT00251 EQU   PMT12                                                    03121000
@RT00258 EQU   PMT08                                                    03122000
@RT00279 EQU   PMT15                                                    03123000
@RT00283 EQU   PMT13                                                    03124000
@RT00293 EQU   PMT09                                                    03125000
@RT00310 EQU   PMT19                                                    03126000
@RT00316 EQU   PMT19                                                    03127000
@RT00324 EQU   PMT25                                                    03128000
@RT00328 EQU   PMT09                                                    03129000
@RT00341 EQU   PMT28                                                    03130000
@RT00343 EQU   PMT31                                                    03131000
@RT00348 EQU   PMT26A                                                   03132000
@RC00353 EQU   PMT05                                                    03133000
@RT00385 EQU   PMT34                                                    03134000
@RT00387 EQU   PMT35                                                    03135000
@RT00400 EQU   PMT19                                                    03136000
@RT00406 EQU   PMT19                                                    03137000
@RT00414 EQU   PMT39                                                    03138000
@RT00418 EQU   PMT09                                                    03139000
@RC00422 EQU   PMT05                                                    03140000
@RT00431 EQU   PMT65                                                    03141000
@RT00434 EQU   PMT40                                                    03142000
@RT00436 EQU   PMT42                                                    03143000
@RT00440 EQU   PMT42                                                    03144000
@RT00445 EQU   PMT45                                                    03145000
@RT00447 EQU   PMT44                                                    03146000
@RT00480 EQU   PMT48                                                    03147000
@RT00482 EQU   PMT47                                                    03148000
@RT00499 EQU   PMT50                                                    03149000
@RT00501 EQU   PMT49                                                    03150000
@RT00518 EQU   PMT52                                                    03151000
@RT00520 EQU   PMT51                                                    03152000
@RT00537 EQU   PMT54                                                    03153000
@RT00539 EQU   PMT53                                                    03154000
@RT00562 EQU   PMT57                                                    03155000
@RT00577 EQU   PMT56                                                    03156000
@RT00581 EQU   PMT55                                                    03157000
@RT00583 EQU   PMT68                                                    03158000
@RT00587 EQU   PMT68                                                    03159000
@RT00589 EQU   PMT63                                                    03160000
@RT00604 EQU   PMT61                                                    03161000
@RT00608 EQU   PMT70                                                    03162000
@RT00613 EQU   PMT70                                                    03163000
@ENDDATA EQU   *                                                        03164000
         END   AHLTPMT,(C'PL/S-II',0502,73240)                          03165000
