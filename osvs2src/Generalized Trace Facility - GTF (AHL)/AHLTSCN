         TITLE 'AHLTSCN - MODULE TO SCAN TRACE OPTIONS                 *00001000
                       '                                                00002000
AHLTSCN  CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'AHLTSCN   73.240'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         ST    @13,@SA00001+4                                      0001 00014000
         LA    @14,@SA00001                                        0001 00015000
         ST    @14,8(,@13)                                         0001 00016000
         LR    @13,@14                                             0001 00017000
*                                                                  0027 00018000
*/********************************************************************/ 00019000
*/*                                                                  */ 00020000
*/*                ENTRY POINT---AHLTSCN, SCAN ROUTINE               */ 00021000
*/*                                                                  */ 00022000
*/********************************************************************/ 00023000
*/********************************************************************/ 00024000
*/*                                                                  */ 00025000
*/*                 TEST FOR TRACE OPTIONS IN BUFFER                 */ 00026000
*/*                                                                  */ 00027000
*/********************************************************************/ 00028000
*                                                                  0027 00029000
*   IF ICTTRCIN='1'B                /* TEST FOR OPS IN BUFF          */ 00030000
*     THEN                          /* OPTIONS IN BUFFER             */ 00031000
         L     @03,INITPTR(,PCTPTR)                                0027 00032000
         TM    ICTTRCIN(@03),B'00001000'                           0027 00033000
         BO    @RT00027                                            0027 00034000
*     GO TO SCN06;                  /* SKIP INPUT - PROCESS          */ 00035000
*                                                                  0028 00036000
*/********************************************************************/ 00037000
*/*                                                                  */ 00038000
*/*                      TEST FOR PARMLIB INPUT                      */ 00039000
*/*                                                                  */ 00040000
*/********************************************************************/ 00041000
*                                                                  0029 00042000
*   IF ICTPLIB='0'B                 /* TEST FOR PARMLIB INPUT        */ 00043000
*     THEN                          /* NO PARMLIB                    */ 00044000
         TM    ICTPLIB(@03),B'10000000'                            0029 00045000
         BZ    @RT00029                                            0029 00046000
*     GO TO SCN04;                  /* ISSUE MSG FOR CONSOLE INPUT 0030 00047000
*                                      AND PROCESS                   */ 00048000
*                                                                  0031 00049000
*/********************************************************************/ 00050000
*/*                                                                  */ 00051000
*/*                 PARMLIB INPUT-READ FIRST RECORD                  */ 00052000
*/*                                                                  */ 00053000
*/********************************************************************/ 00054000
*                                                                  0031 00055000
*   ICTMSGX='FF'X;                  /* SET IND FOR MSG IN BUF        */ 00056000
         MVI   ICTMSGX(@03),X'FF'                                  0031 00057000
*   ICTIOTYP=3;                     /* SET IO TYPE-READ PLIB         */ 00058000
         MVI   ICTIOTYP(@03),X'03'                                 0032 00059000
*   CALL AHLTIO;                    /* READ PARMLIB            Y02014*/ 00060000
*                                                                  0033 00061000
         L     @15,@CV00314                                        0033 00062000
         BALR  @14,@15                                             0033 00063000
*/********************************************************************/ 00064000
*/*                                                                  */ 00065000
*/*             TEST FOR I/O ERROR WHEN READING PARMLIB              */ 00066000
*/*                                                                  */ 00067000
*/********************************************************************/ 00068000
*                                                                  0034 00069000
*   IF ICTIOERR='0'B                /* TEST FOR READ ERROR           */ 00070000
*     THEN                          /* NO READ ERROR                 */ 00071000
         L     @03,INITPTR(,PCTPTR)                                0034 00072000
         TM    ICTIOERR(@03),B'01000000'                           0034 00073000
         BZ    @RT00034                                            0034 00074000
*     GO TO SCN06;                  /* PROCESS INPUT                 */ 00075000
*   ICTRETRY='1'B;                  /* SET RETRY IND-READ ERROR      */ 00076000
         OI    ICTRETRY(@03),B'00010000'                           0036 00077000
*   GO TO SCN11;                    /* RETURN TO AHLTCTL1            */ 00078000
         B     SCN11                                               0037 00079000
*                                                                  0038 00080000
*/********************************************************************/ 00081000
*/*                                                                  */ 00082000
*/*                       ISSUE ERROR MESSAGE                        */ 00083000
*/*                                                                  */ 00084000
*/********************************************************************/ 00085000
*                                                                  0038 00086000
*SCN02:                                                            0038 00087000
*   ICTMSGX=5;                      /* SET NDX FOR AHL104A           */ 00088000
SCN02    L     @03,INITPTR(,PCTPTR)                                0038 00089000
         MVI   ICTMSGX(@03),X'05'                                  0038 00090000
*SCN03:                                                            0039 00091000
*   IF ICTPLIB='0'B                 /* TEST FOR PARMLIB INPUT        */ 00092000
*     THEN                          /* NO PARMLIB                    */ 00093000
SCN03    L     @03,INITPTR(,PCTPTR)                                0039 00094000
         TM    ICTPLIB(@03),B'10000000'                            0039 00095000
         BZ    @RT00039                                            0039 00096000
*     GO TO SCN05;                  /* ISSUE MSG                     */ 00097000
*   ICTIOTYP=4;                     /* SET IO TYPE FOR WRITING TO  0041 00098000
*                                      PROGRAMMER              Y02014*/ 00099000
         MVI   ICTIOTYP(@03),X'04'                                 0041 00100000
*   CALL AHLTIO;                    /* ISSUE MSG               Y02014*/ 00101000
         L     @15,@CV00314                                        0042 00102000
         BALR  @14,@15                                             0042 00103000
*   ICTMSGX=22;                     /* SET NDX FOR AHL124I           */ 00104000
         L     @03,INITPTR(,PCTPTR)                                0043 00105000
         MVI   ICTMSGX(@03),X'16'                                  0043 00106000
*   ICTIOTYP=2;                     /* SET IO TYPE FOR WTO           */ 00107000
         MVI   ICTIOTYP(@03),X'02'                                 0044 00108000
*   CALL AHLTIO;                    /* ISSUE MSG                     */ 00109000
         L     @15,@CV00314                                        0045 00110000
         BALR  @14,@15                                             0045 00111000
*   ICTRETRY='1'B;                  /* SET BIT FOR RETRY             */ 00112000
         L     @03,INITPTR(,PCTPTR)                                0046 00113000
         OI    ICTRETRY(@03),B'00010000'                           0046 00114000
*   GO TO SCN11;                    /* RETURN TO AHLTCTL             */ 00115000
         B     SCN11                                               0047 00116000
*                                                                  0048 00117000
*/********************************************************************/ 00118000
*/*                                                                  */ 00119000
*/*             ISSUE MESSAGE FOR TRACE OPTIONS OR ERROR             */ 00120000
*/*                                                                  */ 00121000
*/********************************************************************/ 00122000
*                                                                  0048 00123000
*SCN04:                                                            0048 00124000
*   ICTMSGX=1;                      /* SET NDX FOR AHL100A           */ 00125000
SCN04    L     @03,INITPTR(,PCTPTR)                                0048 00126000
         MVI   ICTMSGX(@03),X'01'                                  0048 00127000
*SCN05:                                                            0049 00128000
*   ICTIOTYP=1;                     /* SET IO TYPE FOR WTOR          */ 00129000
SCN05    L     @03,INITPTR(,PCTPTR)                                0049 00130000
         MVI   ICTIOTYP(@03),X'01'                                 0049 00131000
*   CALL AHLTIO;                    /* ISSUE MSG                     */ 00132000
*                                                                  0050 00133000
         L     @15,@CV00314                                        0050 00134000
         BALR  @14,@15                                             0050 00135000
*/********************************************************************/ 00136000
*/*                                                                  */ 00137000
*/*                     TEST FOR STOP ECB POSTED                     */ 00138000
*/*                                                                  */ 00139000
*/********************************************************************/ 00140000
*                                                                  0051 00141000
*   IF ICTSTOP='1'B                 /* TEST FOR STOP ECB POST        */ 00142000
*     THEN                          /* STOP ECB POSTED               */ 00143000
         L     @03,INITPTR(,PCTPTR)                                0051 00144000
         TM    ICTSTOP(@03),B'00000100'                            0051 00145000
         BNO   @RF00051                                            0051 00146000
*     DO;                                                          0052 00147000
*       RTRNCODE=12;                /* SET RTRN CODE TO STOP         */ 00148000
         LA    RTRNCODE,12                                         0053 00149000
*       GO TO SCN11A;               /* RETURN TO AHLTCTL             */ 00150000
         B     SCN11A                                              0054 00151000
*     END;                                                         0055 00152000
*                                                                  0056 00153000
*/********************************************************************/ 00154000
*/*                                                                  */ 00155000
*/*                          PROCESS INPUT                           */ 00156000
*/*                                                                  */ 00157000
*/********************************************************************/ 00158000
*                                                                  0056 00159000
*SCN06:                                                            0056 00160000
*   EODIND=0;                       /* SET IND-NOT END OF DATA       */ 00161000
@RF00051 DS    0H                                                  0056 00162000
SCN06    SR    EODIND,EODIND                                       0056 00163000
*   GTFOPIND(1:3)=                  /* CLEAR OP INDS           Y02014*/ 00164000
*       ZEROWD(1:3);                                               0057 00165000
*                                                                  0057 00166000
         L     @04,INITPTR(,PCTPTR)                                0057 00167000
         MVC   GTFOPIND(3,@04),ZEROWD                              0057 00168000
*/********************************************************************/ 00169000
*/*                                                                  */ 00170000
*/*     SEARCH FOR 1ST NON-BLANK CHARACTER IN REPLY FROM OPERATOR    */ 00171000
*/*                                                                  */ 00172000
*/********************************************************************/ 00173000
*                                                                  0058 00174000
*   DO I=1 TO 123 BY 1;             /* SEARCH TO END OF BUFF         */ 00175000
*                                                                  0058 00176000
         LA    I,1                                                 0058 00177000
@DL00058 DS    0H                                                  0059 00178000
*/********************************************************************/ 00179000
*/*                                                                  */ 00180000
*/*               TEST FOR NON-BLANK CHARACTER IN REPLY              */ 00181000
*/*                                                                  */ 00182000
*/********************************************************************/ 00183000
*                                                                  0059 00184000
*     IF MSGREPLY(I)^=BLANK(1)      /* TEST FOR NON-BLANK      Y02014*/ 00185000
*       THEN                        /* CONTINUE TO PROCESS           */ 00186000
         L     @04,INITPTR(,PCTPTR)                                0059 00187000
         ALR   @04,I                                               0059 00188000
         CLC   MSGREPLY-1(1,@04),BLANK                             0059 00189000
         BNE   @RT00059                                            0059 00190000
*       GO TO SCN07;                /* SEARCH FOR DELIMITER          */ 00191000
*   END;                                                           0061 00192000
         AH    I,@CH00056                                          0061 00193000
         CH    I,@CH00352                                          0061 00194000
         BNH   @DL00058                                            0061 00195000
*   GO TO SCN02;                    /* ISSUE MSG AHL104A       Y02014*/ 00196000
         B     SCN02                                               0062 00197000
*SCN07:                                                            0063 00198000
*   N=I;                            /* SAVE PSN OF KEYWD BEGIN       */ 00199000
*                                                                  0063 00200000
SCN07    LR    N,I                                                 0063 00201000
*/********************************************************************/ 00202000
*/*                                                                  */ 00203000
*/*               SEARCH FOR DELIMITER -=- AFTER KEYWORD             */ 00204000
*/*                                                                  */ 00205000
*/********************************************************************/ 00206000
*                                                                  0064 00207000
*   DO I=N                          /* SEARCH FROM BEGINNING         */ 00208000
*         TO 123 BY 1;              /* OF KEYWD TO END OF BUFF       */ 00209000
*                                                                  0064 00210000
         LR    I,N                                                 0064 00211000
         B     @DE00064                                            0064 00212000
@DL00064 DS    0H                                                  0065 00213000
*/********************************************************************/ 00214000
*/*                                                                  */ 00215000
*/*  TEST FOR BLANK AFTER KEYWORD, BEFORE = SIGN                     */ 00216000
*/*                                                                  */ 00217000
*/********************************************************************/ 00218000
*                                                                  0065 00219000
*     IF MSGREPLY(I)=BLANK(1)       /* TEST FOR BLANK          Y02014*/ 00220000
*       THEN                        /* ERROR IF BLANK                */ 00221000
         L     @15,INITPTR(,PCTPTR)                                0065 00222000
         LR    @14,@15                                             0065 00223000
         ALR   @14,I                                               0065 00224000
         CLC   MSGREPLY-1(1,@14),BLANK                             0065 00225000
         BE    @RT00065                                            0065 00226000
*       GO TO SCN02;                /* ISSUE MSG AHL104A       Y02014*/ 00227000
*                                                                  0066 00228000
*/********************************************************************/ 00229000
*/*                                                                  */ 00230000
*/*  TEST FOR DELIMITER IMMEDIATELY AFTER KEYWORD                    */ 00231000
*/*                                                                  */ 00232000
*/********************************************************************/ 00233000
*                                                                  0067 00234000
*     IF MSGREPLY(I)='='            /* TEST FOR = SIGN         Y02014*/ 00235000
*       THEN                        /* CONTINUE TO PROCESS           */ 00236000
         ALR   @15,I                                               0067 00237000
         CLI   MSGREPLY-1(@15),C'='                                0067 00238000
         BE    @RT00067                                            0067 00239000
*       GO TO SCN08;                /* CHECK KEYWD LENGTH            */ 00240000
*   END;                                                           0069 00241000
         AH    I,@CH00056                                          0069 00242000
@DE00064 CH    I,@CH00352                                          0069 00243000
         BNH   @DL00064                                            0069 00244000
*   GO TO SCN02;                    /* ISSUE MSG AHL104A       Y02014*/ 00245000
*                                                                  0070 00246000
         B     SCN02                                               0070 00247000
*/********************************************************************/ 00248000
*/*                                                                  */ 00249000
*/*  TEST FOR VALID LENGTH OF KEYWORD                                */ 00250000
*/*                                                                  */ 00251000
*/********************************************************************/ 00252000
*                                                                  0071 00253000
*SCN08:                                                            0071 00254000
*   IF I-N^=5                       /* TEST KEYWD LEN NOT=5          */ 00255000
*     THEN                          /* ERROR IF NOT 5                */ 00256000
SCN08    LR    @15,I                                               0071 00257000
         SR    @15,N                                               0071 00258000
         CH    @15,@CH00339                                        0071 00259000
         BNE   @RT00071                                            0071 00260000
*     GO TO SCN02;                  /* ISSUE MSG- RESTART            */ 00261000
*                                                                  0072 00262000
*/********************************************************************/ 00263000
*/*                                                                  */ 00264000
*/*  TEST FOR VALID KEYWORD                                          */ 00265000
*/*                                                                  */ 00266000
*/********************************************************************/ 00267000
*                                                                  0073 00268000
*   IF MSGREPLY(N:I)^=TRACE         /* TEST FOR KEYWD=TRACE=   Y02014*/ 00269000
*     THEN                          /* ERROR IF NOT =                */ 00270000
         L     @01,INITPTR(,PCTPTR)                                0073 00271000
         ALR   @01,N                                               0073 00272000
         EX    @15,@SC00416                                        0073 00273000
         BNE   @RT00073                                            0073 00274000
*     GO TO SCN02;                  /* ISSUE MSG - RESTART           */ 00275000
*SCN09:                                                            0075 00276000
*   N=I+1;                          /* SAVE PSN OF BEGINNING OF    0075 00277000
*                                      OPTION KEYWORD                */ 00278000
*                                                                  0075 00279000
SCN09    LA    N,1                                                 0075 00280000
         AR    N,I                                                 0075 00281000
*/********************************************************************/ 00282000
*/*                                                                  */ 00283000
*/*  SEARCH FOR END OF OPTION KEYWORD                                */ 00284000
*/*                                                                  */ 00285000
*/********************************************************************/ 00286000
*                                                                  0076 00287000
*   DO I=N                          /* SEARCH FROM BEGINNING         */ 00288000
*         TO 123 BY 1;              /* OF KEYWD TO END OF BUFF       */ 00289000
*                                                                  0076 00290000
         LR    I,N                                                 0076 00291000
         B     @DE00076                                            0076 00292000
@DL00076 DS    0H                                                  0077 00293000
*/********************************************************************/ 00294000
*/*                                                                  */ 00295000
*/*  TEST FOR END OF REPLY                                           */ 00296000
*/*                                                                  */ 00297000
*/********************************************************************/ 00298000
*                                                                  0077 00299000
*     IF MSGREPLY(I)=BLANK(1)       /* BLANK MEANS END DATA    Y02014*/ 00300000
*       THEN                        /* SET INDICATOR                 */ 00301000
         L     @01,INITPTR(,PCTPTR)                                0077 00302000
         ALR   @01,I                                               0077 00303000
         CLC   MSGREPLY-1(1,@01),BLANK                             0077 00304000
         BNE   @RF00077                                            0077 00305000
*       DO;                                                        0078 00306000
*         EODIND=1;                 /* SET IND FOR END DATA          */ 00307000
         LA    EODIND,1                                            0079 00308000
*         GO TO SCN10;              /* TEST FOR ERROR                */ 00309000
         B     SCN10                                               0080 00310000
*       END;                                                       0081 00311000
*                                                                  0081 00312000
*/********************************************************************/ 00313000
*/*                                                                  */ 00314000
*/*  TEST FOR OPTION SEPARATOR DELIMITER                             */ 00315000
*/*                                                                  */ 00316000
*/********************************************************************/ 00317000
*                                                                  0082 00318000
*     IF MSGREPLY(I)=','            /* TEST FOR COMMA          Y02014*/ 00319000
*       THEN                        /* CONTINUE PROCESSING           */ 00320000
@RF00077 L     @01,INITPTR(,PCTPTR)                                0082 00321000
         ALR   @01,I                                               0082 00322000
         CLI   MSGREPLY-1(@01),C','                                0082 00323000
         BE    @RT00082                                            0082 00324000
*       GO TO SCN10;                /* TEST FOR ERROR                */ 00325000
*   END;                                                           0084 00326000
*                                                                  0084 00327000
         AH    I,@CH00056                                          0084 00328000
@DE00076 CH    I,@CH00352                                          0084 00329000
         BNH   @DL00076                                            0084 00330000
*/********************************************************************/ 00331000
*/*                                                                  */ 00332000
*/*  TEST FOR IMPROPER DELIMITER OR NO OPTIONS                       */ 00333000
*/*                                                                  */ 00334000
*/********************************************************************/ 00335000
*                                                                  0085 00336000
*SCN10:                                                            0085 00337000
*   IF I-N=0                        /* TEST FOR INVALID LEN          */ 00338000
*     THEN                          /* CONTINUE CHECK                */ 00339000
SCN10    SR    @15,@15                                             0085 00340000
         LR    @14,I                                               0085 00341000
         SR    @14,N                                               0085 00342000
         CR    @14,@15                                             0085 00343000
         BNE   @RF00085                                            0085 00344000
*     DO;                                                          0086 00345000
*                                                                  0086 00346000
*/********************************************************************/ 00347000
*/*                                                                  */ 00348000
*/*  TEST FOR SYNTAX ERROR - IMPROPER DELIMITER                      */ 00349000
*/*                                                                  */ 00350000
*/********************************************************************/ 00351000
*                                                                  0087 00352000
*       IF EODIND=0                 /* TEST FOR NO DATA END          */ 00353000
*         THEN                                                     0087 00354000
         CR    EODIND,@15                                          0087 00355000
         BNE   @RF00087                                            0087 00356000
*         DO;                                                      0088 00357000
*           ICTMSGX=6;              /* SET INDEX FOR AHL105A         */ 00358000
         L     @03,INITPTR(,PCTPTR)                                0089 00359000
         MVI   ICTMSGX(@03),X'06'                                  0089 00360000
*           GO TO SCN03;            /* ISSUE MSG - RESTART           */ 00361000
         B     SCN03                                               0090 00362000
*         END;                                                     0091 00363000
*                                                                  0091 00364000
*/********************************************************************/ 00365000
*/*                                                                  */ 00366000
*/*  TEST FOR NO OPTIONS OR IMPROPER DELIMITER                       */ 00367000
*/*                                                                  */ 00368000
*/********************************************************************/ 00369000
*                                                                  0092 00370000
*       IF MSGREPLY(I-1)=','        /* TEST FOR IMPRPR DELIM   Y02014*/ 00371000
*         THEN                      /* IMPROPER DELIMITER            */ 00372000
@RF00087 L     @15,INITPTR(,PCTPTR)                                0092 00373000
         LR    @14,@15                                             0092 00374000
         ALR   @14,I                                               0092 00375000
         CLI   MSGREPLY-2(@14),C','                                0092 00376000
         BNE   @RF00092                                            0092 00377000
*         ICTMSGX=6;                /* SET INDEX FOR AHL105A         */ 00378000
         MVI   ICTMSGX(@15),X'06'                                  0093 00379000
*       ELSE                        /* NO OPTIONS SPECIFIED          */ 00380000
*         ICTMSGX=7;                /* SET INDEX FOR AHL106A         */ 00381000
         B     @RC00092                                            0094 00382000
@RF00092 L     @03,INITPTR(,PCTPTR)                                0094 00383000
         MVI   ICTMSGX(@03),X'07'                                  0094 00384000
*       GO TO SCN03;                /* ISSUE MSG - RESTART           */ 00385000
         B     SCN03                                               0095 00386000
*     END;                                                         0096 00387000
*   OPTION=BLANK;                   /* CLEAR OPTION HOLD AREA        */ 00388000
*                                                                  0097 00389000
@RF00085 MVC   OPTION(4),BLANK                                     0097 00390000
*/********************************************************************/ 00391000
*/*                                                                  */ 00392000
*/*  TEST FOR VALID OPTION LENGTH--NOT GREATER THAN MAXIMUM          */ 00393000
*/*                                                                  */ 00394000
*/********************************************************************/ 00395000
*                                                                  0098 00396000
*   IF I-N>4                        /* TEST FOR OP LEN > MAX         */ 00397000
*     THEN                          /* OP LEN > MAX                  */ 00398000
         LR    @15,I                                               0098 00399000
         SR    @15,N                                               0098 00400000
         CH    @15,@CH00069                                        0098 00401000
         BNH   @RF00098                                            0098 00402000
*     DO;                                                          0099 00403000
*       OPTION=                     /* PLACE OP IN HOLD AREA         */ 00404000
*           MSGREPLY(N:N+3);        /*                         Y02014*/ 00405000
         L     @05,INITPTR(,PCTPTR)                                0100 00406000
         ALR   @05,N                                               0100 00407000
         MVC   OPTION(4),MSGREPLY-1(@05)                           0100 00408000
*       GO TO SCN12;                /* ISSUE MSG - RESTART           */ 00409000
         B     SCN12                                               0101 00410000
*     END;                                                         0102 00411000
*                                                                  0102 00412000
*/********************************************************************/ 00413000
*/*                                                                  */ 00414000
*/*  TEST FOR VALID OPTION LENGTH--NOT LESS THAN MINIMUM             */ 00415000
*/*                                                                  */ 00416000
*/********************************************************************/ 00417000
*                                                                  0103 00418000
*   IF I-N<2                        /* TEST FOR OP LEN < MIN         */ 00419000
*     THEN                          /* OP LEN < MIN                  */ 00420000
@RF00098 LR    @15,I                                               0103 00421000
         SR    @15,N                                               0103 00422000
         CH    @15,@CH00345                                        0103 00423000
         BNL   @RF00103                                            0103 00424000
*     DO;                                                          0104 00425000
*       OPTION(1)=                  /* PLACE OP IN HOLD AREA         */ 00426000
*           MSGREPLY(N);            /*                         Y02014*/ 00427000
         L     @05,INITPTR(,PCTPTR)                                0105 00428000
         ALR   @05,N                                               0105 00429000
         MVC   OPTION(1),MSGREPLY-1(@05)                           0105 00430000
*       GO TO SCN12;                /* ISSUE MSG - RESTART           */ 00431000
         B     SCN12                                               0106 00432000
*     END;                                                         0107 00433000
*   OPTION=MSGREPLY(N:I-1);         /* PLACE OPTION IN HOLD AREA FROM   00434000
*                                      BUFFER                  Y02014*/ 00435000
@RF00103 MVI   OPTION+1,C' '                                       0108 00436000
         MVC   OPTION+2(2),OPTION+1                                0108 00437000
         LR    @15,I                                               0108 00438000
         SR    @15,N                                               0108 00439000
         BCTR  @15,0                                               0108 00440000
         L     @01,INITPTR(,PCTPTR)                                0108 00441000
         ALR   @01,N                                               0108 00442000
         EX    @15,@SM00418                                        0108 00443000
*                                                                  0109 00444000
*/********************************************************************/ 00445000
*/*                                                                  */ 00446000
*/*  SEARCH FOR OPTION SPECIFIED IN OPTION TABLE                     */ 00447000
*/*                                                                  */ 00448000
*/********************************************************************/ 00449000
*                                                                  0109 00450000
*   DO N=1 TO 20 BY 1;              /* SEARCH FOR VALID OP           */ 00451000
*                                                                  0109 00452000
         LA    N,1                                                 0109 00453000
@DL00109 DS    0H                                                  0110 00454000
*/********************************************************************/ 00455000
*/*                                                                  */ 00456000
*/*  TEST FOR VALID OPTION                                           */ 00457000
*/*                                                                  */ 00458000
*/********************************************************************/ 00459000
*                                                                  0110 00460000
*     IF SCNOPTAB(N)=OPTION         /* TEST FOR VALID OPTION         */ 00461000
*       THEN                        /* OPTION FOUND                  */ 00462000
         LR    @15,N                                               0110 00463000
         SLA   @15,2                                               0110 00464000
         LA    @14,SCNOPTAB-4(@15)                                 0110 00465000
         CLC   0(4,@14),OPTION                                     0110 00466000
         BNE   @RF00110                                            0110 00467000
*       DO;                                                        0111 00468000
*                                                                  0111 00469000
*/********************************************************************/ 00470000
*/*                                                                  */ 00471000
*/*               SET GTFOPIND BIT FOR THIS OPTION                   */ 00472000
*/*                                                                  */ 00473000
*/********************************************************************/ 00474000
*                                                                  0112 00475000
*         RFY                                                      0112 00476000
*          (GTFOPADR,                                              0112 00477000
*           BYTEREG)RSTD;           /* RESTRICT REGS           Y02014*/ 00478000
*         GTFOPADR=ADDR(GTFOPIND);  /* SET PTR TO ADDR OF INDS IN  0113 00479000
*                                      GTFPCT                  Y02014*/ 00480000
         L     GTFOPADR,INITPTR(,PCTPTR)                           0113 00481000
         LA    GTFOPADR,GTFOPIND(,GTFOPADR)                        0113 00482000
*         BYTEREG=N-1;              /* SET PTR TO PSN OF OP IN     0114 00483000
*                                      SCNOPTAB - 1                  */ 00484000
*                                                                  0114 00485000
         LR    BYTEREG,N                                           0114 00486000
         BCTR  BYTEREG,0                                           0114 00487000
*/********************************************************************/ 00488000
*/*                                                                  */ 00489000
*/*  COMPUTE BYTE PSN IN GTFOPIND FOR THIS OPTION, COMPUTE MASK TO   */ 00490000
*/*  TURN ON BIT FOR THIS OPTION                               Y02014*/ 00491000
*/*                                                                  */ 00492000
*/********************************************************************/ 00493000
*                                                                  0115 00494000
*         GENERATE;                                                0115 00495000
                  SRDL  BYTEREG,3     COMPUTE BYTE PSN OF OP            00496000
                  SRL   MOVNUM,29      COMPUTE BIT PSN OF OP            00497000
                  AR    BYTEREG,GTFOPADR    COMP BYTE PSN IN GTFOPIND   00498000
*                                                                Y02014 00499000
                  LA    MASKREG,X'80'      SETUP MASK                   00500000
                  SRL   MASKREG,0(MOVNUM)    SET MASK                   00501000
*                                                                Y02014 00502000
                  EX    MASKREG,BITON       TURN '1'B BIT FOR THIS OP   00503000
*                                           IN GTFOPIND          Y02014 00504000
*         RFY                                                      0116 00505000
*          (GTFOPADR,                                              0116 00506000
*           BYTEREG)UNRSTD;         /* UNRESTRICT REGS         Y02014*/ 00507000
*                                                                  0116 00508000
*/********************************************************************/ 00509000
*/*                                                                  */ 00510000
*/*  TEST FOR END OF PARAMETERS                                      */ 00511000
*/*                                                                  */ 00512000
*/********************************************************************/ 00513000
*                                                                  0117 00514000
*         IF EODIND^=1              /* TEST FOR END OF DATA          */ 00515000
*           THEN                    /* CONTINUE IF NOT END           */ 00516000
         CH    EODIND,@CH00056                                     0117 00517000
         BNE   @RT00117                                            0117 00518000
*           GO TO SCN09;            /* TO NEXT PARAMETER             */ 00519000
*                                                                  0118 00520000
*/********************************************************************/ 00521000
*/*                                                                  */ 00522000
*/*           TEST FOR OPTIONS OTHER THAN TRC OR PCI                 */ 00523000
*/*                                                                  */ 00524000
*/********************************************************************/ 00525000
*                                                                  0119 00526000
*         IF(GTFOPT1&'F6'X)=0       /* TEST FOR OPTIONS OTHER  Y02014*/ 00527000
*             &GTFOPT2=0            /* THAN TRC OR PCI         Y02014*/ 00528000
*             &(GTFOPT3&'F0'X)=0    /* BEING ON                Y02014*/ 00529000
*           THEN                    /* NO OTHER OPTIONS              */ 00530000
         SR    @03,@03                                             0119 00531000
         L     @15,INITPTR(,PCTPTR)                                0119 00532000
         LA    @14,246                                             0119 00533000
         SR    @11,@11                                             0119 00534000
         IC    @11,GTFOPT1(,@15)                                   0119 00535000
         NR    @14,@11                                             0119 00536000
         CR    @14,@03                                             0119 00537000
         BNE   @RF00119                                            0119 00538000
         CLI   GTFOPT2(@15),0                                      0119 00539000
         BNE   @RF00119                                            0119 00540000
         LA    @14,240                                             0119 00541000
         SR    @11,@11                                             0119 00542000
         IC    @11,GTFOPT3(,@15)                                   0119 00543000
         NR    @14,@11                                             0119 00544000
         CR    @14,@03                                             0119 00545000
         BNE   @RF00119                                            0119 00546000
*           DO;                                                    0120 00547000
*             ICTMSGX=24;           /* SET NDX FOR AHL126A           */ 00548000
         MVI   ICTMSGX(@15),X'18'                                  0121 00549000
*             GO TO SCN03;          /* ISSUE MSG                     */ 00550000
         B     SCN03                                               0122 00551000
*           END;                                                   0123 00552000
*                                                                  0124 00553000
*/********************************************************************/ 00554000
*/*                                                                  */ 00555000
*/*               CALL ANALYSIS SUBROUTINE TO PROCESS                */ 00556000
*/*         MUTUALLY EXCLUSIVE OPTIONS AND RETURN TO AHLTCTL1  Y02014*/ 00557000
*/*                                                                  */ 00558000
*/********************************************************************/ 00559000
*                                                                  0124 00560000
*         CALL AHLTANL;             /* TO ANALYSIS ROUTINE           */ 00561000
@RF00119 BAL   @14,AHLTANL                                         0124 00562000
*SCN11:                                                            0125 00563000
*         RTRNCODE=0;               /* SET RETURN CODE FOR CONTINUE  */ 00564000
SCN11    SR    RTRNCODE,RTRNCODE                                   0125 00565000
*SCN11A:                                                           0126 00566000
*         GPRS15=RTRNCODE;          /* RTRNCODE TO SAVE AREA M1402   */ 00567000
SCN11A   L     @01,CALLRSA1(,SAVR)                                 0126 00568000
         ST    RTRNCODE,GPRS15(,@01)                               0126 00569000
*         RETURN;                   /* RETURN TO AHLTCTL             */ 00570000
@EL00001 L     @13,4(,@13)                                         0127 00571000
@EF00001 DS    0H                                                  0127 00572000
@ER00001 LM    @14,@12,12(@13)                                     0127 00573000
         BR    @14                                                 0127 00574000
*       END;                                                       0128 00575000
*   END;                                                           0129 00576000
@RF00110 AH    N,@CH00056                                          0129 00577000
         CH    N,@CH00279                                          0129 00578000
         BNH   @DL00109                                            0129 00579000
*                                                                  0130 00580000
*/********************************************************************/ 00581000
*/*                                                                  */ 00582000
*/*        SETUP MESSAGE AHL108A, INVALID OPT SPECIFIED        Y02014*/ 00583000
*/*                                                                  */ 00584000
*/********************************************************************/ 00585000
*                                                                  0130 00586000
*SCN12:                                                            0130 00587000
*   ICTMSGX=9;                      /* SET INDEX FOR AHL108A         */ 00588000
SCN12    L     @03,INITPTR(,PCTPTR)                                0130 00589000
         MVI   ICTMSGX(@03),X'09'                                  0130 00590000
*   TWTBUF(1:152)='';               /* CLEAR TWTBUF W/BLANKS   Y02014*/ 00591000
         MVI   TWTBUF(@03),C' '                                    0131 00592000
         MVC   TWTBUF+1(151,@03),TWTBUF(@03)                       0131 00593000
*   CALL AHLCTL2;                   /* GET MSG                 Y02014*/ 00594000
         L     @15,@CV00313                                        0132 00595000
         BALR  @14,@15                                             0132 00596000
*   OP108=OPTION;                   /* INVALID OP TO BUFFER          */ 00597000
         L     @03,INITPTR(,PCTPTR)                                0133 00598000
         MVC   OP108(4,@03),OPTION                                 0133 00599000
*   ICTMSGX='FF'X;                  /* SET INDEX FOR MSG IN BUFFER   */ 00600000
         MVI   ICTMSGX(@03),X'FF'                                  0134 00601000
*   GO TO SCN03;                    /* ISSUE MSG - RESTART           */ 00602000
         B     SCN03                                               0135 00603000
*                                                                  0136 00604000
*/********************************************************************/ 00605000
*/*                                                                  */ 00606000
*/*  TURN BIT IN GTFOPIND -- THIS INSTR IS OBJ OF AN EXECUTE   Y02014*/ 00607000
*/*                                                                  */ 00608000
*/********************************************************************/ 00609000
*                                                                  0136 00610000
*BITON:                                                            0136 00611000
*   GENERATE;                                                      0136 00612000
BITON    DS    0H                                                  0136 00613000
*                                   /* TURN ON BIT                   */ 00614000
    OI 0(BYTEREG),0                                                     00615000
*                                                                  0137 00616000
*/********************************************************************/ 00617000
*/*                                                                  */ 00618000
*/*              BEGIN AHLTANL ROUTINE  -  AHLTSCN MODULE            */ 00619000
*/*                                                                  */ 00620000
*/********************************************************************/ 00621000
*                                                                  0137 00622000
*AHLTANL:                                                          0137 00623000
*   PROC OPTIONS(NOSAVEAREA);       /* DEFINE PROC OPTIONS           */ 00624000
*                                                                  0137 00625000
         B     @PB00002                                            0137 00626000
AHLTANL  STM   @14,@12,12(@13)                                     0137 00627000
*/********************************************************************/ 00628000
*/*                                                                  */ 00629000
*/*                        AHLTANL ENTRY POINT                       */ 00630000
*/*                                                                  */ 00631000
*/********************************************************************/ 00632000
*                                                                  0138 00633000
*   PCTCATF=0;                      /* CLEAR FUNCTION DISABLED BITS     00634000
*                                                              Y02014*/ 00635000
*                                                                  0138 00636000
         SR    @03,@03                                             0138 00637000
         ST    @03,PCTCATF(,PCTPTR)                                0138 00638000
*/********************************************************************/ 00639000
*/*                                                                  */ 00640000
*/*  TEST FOR SYSM OPTION                                            */ 00641000
*/*                                                                  */ 00642000
*/********************************************************************/ 00643000
*                                                                  0139 00644000
*   IF GTFSYSM='0'B                 /* TEST FOR SYSM OFF       Y02014*/ 00645000
*     THEN                          /* SYSM OFF                      */ 00646000
         L     @03,INITPTR(,PCTPTR)                                0139 00647000
         TM    GTFSYSM(@03),B'10000000'                            0139 00648000
         BZ    @RT00139                                            0139 00649000
*     GO TO ANL02;                  /* TEST FOR SYSP                 */ 00650000
*                                                                  0140 00651000
*/********************************************************************/ 00652000
*/*                                                                  */ 00653000
*/*                  SET INDICATORS FOR SYSM OPTION                  */ 00654000
*/*                                                                  */ 00655000
*/********************************************************************/ 00656000
*                                                                  0141 00657000
*   GTFOPT1=GTFOPT1&'9F'X;          /* TURN OFF SYSP,SYS IN GTFOPIND */ 00658000
         LA    @15,159                                             0141 00659000
         SR    @14,@14                                             0141 00660000
         IC    @14,GTFOPT1(,@03)                                   0141 00661000
         NR    @15,@14                                             0141 00662000
         STC   @15,GTFOPT1(,@03)                                   0141 00663000
*                                   /*                         Y02014*/ 00664000
*   GTFOPT2='00'X;                  /* CLEAR 2ND BYTE OF OPND  Y02014*/ 00665000
         MVI   GTFOPT2(@03),X'00'                                  0142 00666000
*   GTFEXT='0'B;                    /* CLEAR EXT&RR BITS-SYSM  Y02014*/ 00667000
*                                   /* OPTION AUTOMATICALLY    Y02014*/ 00668000
*   GTFRR='0'B;                     /* GIVES EXT AND RR        Y02014*/ 00669000
*                                                                  0144 00670000
         NI    GTFEXT(@03),B'01101111'                             0144 00671000
*/*************************************************************Y02014*/ 00672000
*/*                                                            Y02014*/ 00673000
*/* THE FOLLOWING DEFINES A LOCAL INCLUDE.  THIS CODE WHEN     Y02014*/ 00674000
*/* INCLUDED, SETS THE DEFAULT OPTIONS IMPLIED BY THE          Y02014*/ 00675000
*/* SYS, SYSM, OR SYSP OPTIONS IN THE PCTCATF FIELD.           Y02014*/ 00676000
*/*                                                            Y02014*/ 00677000
*/*************************************************************Y02014*/ 00678000
*                                                                  0145 00679000
*   PCTSVC='1'B;                    /* SET SVC ACTIVE          Y02014*/ 00680000
*   PCTEXT='1'B;                    /* SET EXT ACTIVE          Y02014*/ 00681000
*   PCTIO='1'B;                     /* SET IO ACTIVE           Y02014*/ 00682000
*   PCTSIO='1'B;                    /* SET SIO ACTIVE          Y02014*/ 00683000
*   PCTPI='1'B;                     /* SET PI ACTIVE           Y02014*/ 00684000
         OI    PCTSVC(PCTPTR),B'11110010'                          0149 00685000
*   PCTRR='1'B;                     /* SET RR ACTIVE           Y02014*/ 00686000
         OI    PCTRR(PCTPTR),B'00100000'                           0150 00687000
*   GO TO ANL10;                    /* GO CHECK OTHER OPTIONS  Y02014*/ 00688000
         B     ANL10                                               0151 00689000
*                                                                  0152 00690000
*/********************************************************************/ 00691000
*/*                                                                  */ 00692000
*/*  TEST FOR SYSP OPTION                                            */ 00693000
*/*                                                                  */ 00694000
*/********************************************************************/ 00695000
*                                                                  0152 00696000
*ANL02:                                                            0152 00697000
*   IF GTFSYSP='1'B                 /* TEST FOR SYSP ON        Y02014*/ 00698000
*     THEN                          /* SYSP ON                       */ 00699000
ANL02    L     @03,INITPTR(,PCTPTR)                                0152 00700000
         TM    GTFSYSP(@03),B'01000000'                            0152 00701000
         BNO   @RF00152                                            0152 00702000
*     DO;                                                          0153 00703000
*                                                                  0153 00704000
*/********************************************************************/ 00705000
*/*                                                                  */ 00706000
*/*  SET INDICATORS FOR SYSP                                         */ 00707000
*/*                                                                  */ 00708000
*/********************************************************************/ 00709000
*                                                                  0154 00710000
*       GTFOPT1=GTFOPT1             /* TURN OFF SYSM AND SYS   Y02014*/ 00711000
*           &'5F'X;                 /* IN GTFOPIND             Y02014*/ 00712000
         LA    @15,95                                              0154 00713000
         SR    @14,@14                                             0154 00714000
         IC    @14,GTFOPT1(,@03)                                   0154 00715000
         NR    @15,@14                                             0154 00716000
         STC   @15,GTFOPT1(,@03)                                   0154 00717000
*       GTFOPT2='00'X;              /* CLEAR 2ND BYTE OF OPND  Y02014*/ 00718000
         SR    @15,@15                                             0155 00719000
         STC   @15,GTFOPT2(,@03)                                   0155 00720000
*       GTFEXT='0'B;                /* TURN OFF EXT & RR BITS  Y02014*/ 00721000
*       GTFRR='0'B;                 /* SYSP OPTION AUTO-       Y02014*/ 00722000
         NI    GTFEXT(@03),B'01101111'                             0157 00723000
*                                   /* MATICALLY GIVES EXT RR  Y02014*/ 00724000
*       GTFOPT2=GTFOPT2             /* TURN ON SVCP,SIOP,PIP,  Y02014*/ 00725000
*           |'55'X;                 /* IOP IN GTFOPIND         Y02014*/ 00726000
*                                                                  0158 00727000
         O     @15,@CF00383                                        0158 00728000
         STC   @15,GTFOPT2(,@03)                                   0158 00729000
*/*************************************************************Y02014*/ 00730000
*/*                                                            Y02014*/ 00731000
*/* THE FOLLOWING DEFINES A LOCAL INCLUDE.  THIS CODE WHEN     Y02014*/ 00732000
*/* INCLUDED, SETS THE DEFAULT OPTIONS IMPLIED BY THE          Y02014*/ 00733000
*/* SYS, SYSM, OR SYSP OPTIONS IN THE PCTCATF FIELD.           Y02014*/ 00734000
*/*                                                            Y02014*/ 00735000
*/*************************************************************Y02014*/ 00736000
*                                                                  0159 00737000
*       PCTSVC='1'B;                /* SET SVC ACTIVE          Y02014*/ 00738000
*       PCTEXT='1'B;                /* SET EXT ACTIVE          Y02014*/ 00739000
*       PCTIO='1'B;                 /* SET IO ACTIVE           Y02014*/ 00740000
*       PCTSIO='1'B;                /* SET SIO ACTIVE          Y02014*/ 00741000
*       PCTPI='1'B;                 /* SET PI ACTIVE           Y02014*/ 00742000
         OI    PCTSVC(PCTPTR),B'11110010'                          0163 00743000
*       PCTRR='1'B;                 /* SET RR ACTIVE           Y02014*/ 00744000
*       PCTIOF='1'B;                /* SET IO FILTER BIT       Y02014*/ 00745000
*       PCTSIOF='1'B;               /* SET SIO FILTER BIT      Y02014*/ 00746000
*       PCTSVCF='1'B;               /* SET SVC FILTER BIT      Y02014*/ 00747000
*       PCTPIF='1'B;                /* SET PI FILTER BIT       Y02014*/ 00748000
         OI    PCTRR(PCTPTR),B'00111110'                           0168 00749000
*       GO TO ANL10;                /* CHECK OTHER OPTIONS     Y02014*/ 00750000
         B     ANL10                                               0169 00751000
*     END;                                                         0170 00752000
*                                                                  0171 00753000
*/********************************************************************/ 00754000
*/*                                                                  */ 00755000
*/*  TEST FOR SYS OPTION                                             */ 00756000
*/*                                                                  */ 00757000
*/********************************************************************/ 00758000
*                                                                  0171 00759000
*   IF GTFSYS='1'B                  /* TEST FOR SYS ON         Y02014*/ 00760000
*     THEN                          /* SYS ON                        */ 00761000
*                                                                  0171 00762000
@RF00152 L     @03,INITPTR(,PCTPTR)                                0171 00763000
         TM    GTFSYS(@03),B'00100000'                             0171 00764000
         BNO   @RF00171                                            0171 00765000
*/********************************************************************/ 00766000
*/*                                                                  */ 00767000
*/*                  SET INDICATORS FOR SYS OPTION                   */ 00768000
*/*                                                                  */ 00769000
*/********************************************************************/ 00770000
*                                                                  0172 00771000
*     DO;                                                          0172 00772000
*       GTFOPT1=GTFOPT1             /* TURN OFF SYSM,SYSP      Y02014*/ 00773000
*           &'3F'X;                 /* IN GTFOPIND             Y02014*/ 00774000
         LA    @15,63                                              0173 00775000
         SR    @14,@14                                             0173 00776000
         IC    @14,GTFOPT1(,@03)                                   0173 00777000
         NR    @15,@14                                             0173 00778000
         STC   @15,GTFOPT1(,@03)                                   0173 00779000
*       GTFOPT2='00'X;              /* CLEAR 2ND BYTE OF OPND  Y02014*/ 00780000
         MVI   GTFOPT2(@03),X'00'                                  0174 00781000
*       GTFEXT='0'B;                /* TURN OFF EXT & RR BITS  Y02014*/ 00782000
*       GTFRR='0'B;                 /* SYS OPTION AUTO-        Y02014*/ 00783000
         NI    GTFEXT(@03),B'01101111'                             0176 00784000
*                                   /* MATICALLY GIVES EXT     Y02014*/ 00785000
*                                                                  0177 00786000
*/*************************************************************Y02014*/ 00787000
*/*                                                            Y02014*/ 00788000
*/* THE FOLLOWING DEFINES A LOCAL INCLUDE.  THIS CODE WHEN     Y02014*/ 00789000
*/* INCLUDED, SETS THE DEFAULT OPTIONS IMPLIED BY THE          Y02014*/ 00790000
*/* SYS, SYSM, OR SYSP OPTIONS IN THE PCTCATF FIELD.           Y02014*/ 00791000
*/*                                                            Y02014*/ 00792000
*/*************************************************************Y02014*/ 00793000
*                                                                  0177 00794000
*       PCTSVC='1'B;                /* SET SVC ACTIVE          Y02014*/ 00795000
*       PCTEXT='1'B;                /* SET EXT ACTIVE          Y02014*/ 00796000
*       PCTIO='1'B;                 /* SET IO ACTIVE           Y02014*/ 00797000
*       PCTSIO='1'B;                /* SET SIO ACTIVE          Y02014*/ 00798000
*       PCTPI='1'B;                 /* SET PI ACTIVE           Y02014*/ 00799000
         OI    PCTSVC(PCTPTR),B'11110010'                          0181 00800000
*       PCTRR='1'B;                 /* SET RR ACTIVE           Y02014*/ 00801000
         OI    PCTRR(PCTPTR),B'00100000'                           0182 00802000
*       GOTO ANL10;                 /* CHECK OTHER OPTIONS     Y02014*/ 00803000
         B     ANL10                                               0183 00804000
*     END;                                                         0184 00805000
*                                                                  0185 00806000
*/********************************************************************/ 00807000
*/*                                                                  */ 00808000
*/*  TEST FOR IO PROMPTING                                           */ 00809000
*/*                                                                  */ 00810000
*/********************************************************************/ 00811000
*                                                                  0185 00812000
*IOPMP:                                                            0185 00813000
*   IF GTFIOP='1'B                  /* TEST FOR IO PROMPTING   Y02014*/ 00814000
*     THEN                                                         0185 00815000
@RF00171 DS    0H                                                  0185 00816000
IOPMP    L     @03,INITPTR(,PCTPTR)                                0185 00817000
         TM    GTFIOP(@03),B'00000001'                             0185 00818000
         BO    @RT00185                                            0185 00819000
*     GO TO IOFRTN;                 /* SET ON APPROPRIATE BITS Y02014*/ 00820000
*                                                                  0186 00821000
*/********************************************************************/ 00822000
*/*                                                                  */ 00823000
*/*  TEST FOR IO ALL OPTION                                          */ 00824000
*/*                                                                  */ 00825000
*/********************************************************************/ 00826000
*                                                                  0187 00827000
*   IF GTFIO='1'B                   /* IS IO ALL BIT ON        Y02014*/ 00828000
*     THEN                          /* YES                     Y02014*/ 00829000
         TM    GTFIO(@03),B'00000010'                              0187 00830000
         BO    @RT00187                                            0187 00831000
*     GO TO IORTN;                  /* SET APPROPRIATE BITS    Y02014*/ 00832000
*   IF GTFSYS^='1'B                 /* HAS IO BEEN REQUESTED ANOTHER    00833000
*                                      WAY                     Y02014*/ 00834000
*       |GTFSYSM^='1'B|GTFSYSP^='1'B THEN                          0189 00835000
         TM    GTFSYS(@03),B'11100000'                             0189 00836000
         BO    @RF00189                                            0189 00837000
*     GTFPCI='0'B;                  /* NO, TURN OFF PCI        Y02014*/ 00838000
         L     @03,INITPTR(,PCTPTR)                                0190 00839000
         NI    GTFPCI(@03),B'11111110'                             0190 00840000
*   GO TO ANL05;                    /* TEST FOR SVC PROMPT     Y02014*/ 00841000
         B     ANL05                                               0191 00842000
*IOFRTN:                            /*                         Y02014*/ 00843000
*   GTFIO='0'B;                     /* TURN OFF IO ALL BIT           */ 00844000
IOFRTN   L     @03,INITPTR(,PCTPTR)                                0192 00845000
         NI    GTFIO(@03),B'11111101'                              0192 00846000
*   PCTIOF='1'B;                    /* TURN ON CATF IO FILTER  Y02014*/ 00847000
         OI    PCTIOF(PCTPTR),B'00001000'                          0193 00848000
*IORTN:                             /*                         Y02014*/ 00849000
*   PCTIO='1'B;                     /* TURN ON CATF IO ALL BIT Y02014*/ 00850000
IORTN    OI    PCTIO(PCTPTR),B'00100000'                           0194 00851000
*                                                                  0195 00852000
*/********************************************************************/ 00853000
*/*                                                                  */ 00854000
*/*  TEST FOR SVC PROMPTING                                          */ 00855000
*/*                                                                  */ 00856000
*/********************************************************************/ 00857000
*                                                                  0195 00858000
*ANL05:                                                            0195 00859000
*   IF GTFSVCP='1'B                 /* TEST FOR SVC PROMPT ON  Y02014*/ 00860000
*     THEN                          /* SVC PROMPT ON                 */ 00861000
*                                                                  0195 00862000
ANL05    L     @03,INITPTR(,PCTPTR)                                0195 00863000
         TM    GTFSVCP(@03),B'01000000'                            0195 00864000
         BNO   @RF00195                                            0195 00865000
*/********************************************************************/ 00866000
*/*                                                                  */ 00867000
*/*                  SET INDICATORS FOR SVC OPTION                   */ 00868000
*/*                                                                  */ 00869000
*/********************************************************************/ 00870000
*                                                                  0196 00871000
*     DO;                                                          0196 00872000
*       GTFSVC='0'B;                /* TURN OFF SVC ALL        Y02014*/ 00873000
         NI    GTFSVC(@03),B'01111111'                             0197 00874000
*       PCTSVCF='1'B;               /* SET CATF BIT SVC FILTER Y02014*/ 00875000
         OI    PCTSVCF(PCTPTR),B'00010000'                         0198 00876000
*ANL06:                                                            0199 00877000
*       PCTSVC='1'B;                /* SET IND FOR AHLTSVC     Y02014*/ 00878000
ANL06    OI    PCTSVC(PCTPTR),B'10000000'                          0199 00879000
*       GO TO ANL07;                /* TEST FOR SIO PROMPT           */ 00880000
         B     ANL07                                               0200 00881000
*     END;                                                         0201 00882000
*                                                                  0201 00883000
*/********************************************************************/ 00884000
*/*                                                                  */ 00885000
*/*  TEST FOR SVC ALL OPTION                                         */ 00886000
*/*                                                                  */ 00887000
*/********************************************************************/ 00888000
*                                                                  0202 00889000
*   IF GTFSVC='1'B                  /* TEST FOR SVC ALL ON     Y02014*/ 00890000
*     THEN                          /* SVC ALL ON                    */ 00891000
@RF00195 L     @03,INITPTR(,PCTPTR)                                0202 00892000
         TM    GTFSVC(@03),B'10000000'                             0202 00893000
         BO    @RT00202                                            0202 00894000
*     GO TO ANL06;                  /* SET IND FOR SVC ALL     Y02014*/ 00895000
*                                                                  0204 00896000
*/********************************************************************/ 00897000
*/*                                                                  */ 00898000
*/*  TEST FOR SIO PROMPTING                                          */ 00899000
*/*                                                                  */ 00900000
*/********************************************************************/ 00901000
*                                                                  0204 00902000
*ANL07:                                                            0204 00903000
*   IF GTFSIOP='1'B                 /* TEST FOR SIO PROMPT ON  Y02014*/ 00904000
*     THEN                          /* SIO PROMPT ON                 */ 00905000
*                                                                  0204 00906000
ANL07    L     @03,INITPTR(,PCTPTR)                                0204 00907000
         TM    GTFSIOP(@03),B'00010000'                            0204 00908000
         BNO   @RF00204                                            0204 00909000
*/********************************************************************/ 00910000
*/*                                                                  */ 00911000
*/*                   SET INDICATORS FOR SIO OPTION                  */ 00912000
*/*                                                                  */ 00913000
*/********************************************************************/ 00914000
*                                                                  0205 00915000
*     DO;                                                          0205 00916000
*       GTFSIO='0'B;                /* TURN OFF SIO ALL IN GTFOPIND     00917000
*                                                              Y02014*/ 00918000
         NI    GTFSIO(@03),B'11011111'                             0206 00919000
*       PCTSIOF='1'B;               /* SET CARF BIT FOR SIO    Y02014*/ 00920000
         OI    PCTSIOF(PCTPTR),B'00000100'                         0207 00921000
*ANL08:                                                            0208 00922000
*       PCTSIO='1'B;                /* FILTER AND SIO ALL      Y02014*/ 00923000
ANL08    OI    PCTSIO(PCTPTR),B'00010000'                          0208 00924000
*       GO TO ANL09;                /* TEST FOR PI PROMPTING         */ 00925000
         B     ANL09                                               0209 00926000
*     END;                                                         0210 00927000
*                                                                  0210 00928000
*/********************************************************************/ 00929000
*/*                                                                  */ 00930000
*/*  TEST FOR SIO ALL OPTION                                         */ 00931000
*/*                                                                  */ 00932000
*/********************************************************************/ 00933000
*                                                                  0211 00934000
*   IF GTFSIO='1'B                  /* TEST FOR SIO ALL ON     Y02014*/ 00935000
*     THEN                          /* SIO ALL ON                    */ 00936000
@RF00204 L     @03,INITPTR(,PCTPTR)                                0211 00937000
         TM    GTFSIO(@03),B'00100000'                             0211 00938000
         BO    @RT00211                                            0211 00939000
*     GO TO ANL08;                  /* GO SET SIO ALL CATF BIT Y02014*/ 00940000
*                                                                  0213 00941000
*/********************************************************************/ 00942000
*/*                                                                  */ 00943000
*/*  TEST FOR PI PROMPTING                                           */ 00944000
*/*                                                                  */ 00945000
*/********************************************************************/ 00946000
*                                                                  0213 00947000
*ANL09:                                                            0213 00948000
*   IF GTFPIP='1'B                  /* TEST FOR PI PROMPT ON   Y02014*/ 00949000
*     THEN                          /* PI PROMPT ON                  */ 00950000
ANL09    L     @03,INITPTR(,PCTPTR)                                0213 00951000
         TM    GTFPIP(@03),B'00000100'                             0213 00952000
         BNO   @RF00213                                            0213 00953000
*     DO;                                                          0214 00954000
*                                                                  0214 00955000
*/********************************************************************/ 00956000
*/*                                                                  */ 00957000
*/*                   SET INDICATORS FOR PI OPTION                   */ 00958000
*/*                                                                  */ 00959000
*/********************************************************************/ 00960000
*                                                                  0215 00961000
*       GTFPI='0'B;                 /* TURN OFF PI ALL OPTION  Y02014*/ 00962000
         NI    GTFPI(@03),B'11110111'                              0215 00963000
*       PCTPIF='1'B;                /* TURN ON PI FILTER BIT   Y02014*/ 00964000
         OI    PCTPIF(PCTPTR),B'00000010'                          0216 00965000
*ANL095:                                                           0217 00966000
*       PCTPI='1'B;                 /* TURN ON PI CATF BIT     Y02014*/ 00967000
ANL095   OI    PCTPI(PCTPTR),B'00000010'                           0217 00968000
*       GO TO ANL10;                /* SET IND FOR AHLTPED           */ 00969000
         B     ANL10                                               0218 00970000
*     END;                                                         0219 00971000
*                                                                  0219 00972000
*/********************************************************************/ 00973000
*/*                                                                  */ 00974000
*/*  TEST FOR PI ALL OPTION                                          */ 00975000
*/*                                                                  */ 00976000
*/********************************************************************/ 00977000
*                                                                  0220 00978000
*   IF GTFPI='1'B                   /* TEST FOR PI ALL ON      Y02014*/ 00979000
*     THEN                          /* PI ALL ON                     */ 00980000
@RF00213 L     @03,INITPTR(,PCTPTR)                                0220 00981000
         TM    GTFPI(@03),B'00001000'                              0220 00982000
         BO    @RT00220                                            0220 00983000
*     GO TO ANL095;                 /* SET IND. FOR PI ALL     Y02014*/ 00984000
*                                                                  0221 00985000
*/********************************************************************/ 00986000
*/*                                                                  */ 00987000
*/*      TEST FOR OTHER OPTIONS DSP, EXT, RR, RNIO, SRM, USR         */ 00988000
*/*                                                                  */ 00989000
*/********************************************************************/ 00990000
*                                                                  0222 00991000
*ANL10:                                                            0222 00992000
*   IF GTFDSP='1'B                  /* TURN ON CATF BIT FOR DSP IF 0222 00993000
*                                      NECESSARY               Y02014*/ 00994000
*     THEN                                                         0222 00995000
ANL10    L     @03,INITPTR(,PCTPTR)                                0222 00996000
         TM    GTFDSP(@03),B'00000100'                             0222 00997000
         BNO   @RF00222                                            0222 00998000
*     PCTDSP='1'B;                  /*                         Y02014*/ 00999000
         OI    PCTDSP(PCTPTR),B'00001000'                          0223 01000000
*   IF GTFEXT='1'B                  /* TURN ON CATF BIT FOR EXT IF 0224 01001000
*                                      NECESSARY               Y02014*/ 01002000
*     THEN                                                         0224 01003000
@RF00222 L     @03,INITPTR(,PCTPTR)                                0224 01004000
         TM    GTFEXT(@03),B'10000000'                             0224 01005000
         BNO   @RF00224                                            0224 01006000
*     PCTEXT='1'B;                  /*                         Y02014*/ 01007000
         OI    PCTEXT(PCTPTR),B'01000000'                          0225 01008000
*   IF GTFRR='1'B                   /* TURN ON CATF BIT FOR RR IF  0226 01009000
*                                      NECESSARY               Y02014*/ 01010000
*     THEN                                                         0226 01011000
@RF00224 L     @03,INITPTR(,PCTPTR)                                0226 01012000
         TM    GTFRR(@03),B'00010000'                              0226 01013000
         BNO   @RF00226                                            0226 01014000
*     PCTRR='1'B;                   /*                         Y02014*/ 01015000
         OI    PCTRR(PCTPTR),B'00100000'                           0227 01016000
*   IF GTFRNIO='1'B                 /* TURN ON CATF BIT FOR RNIO IF     01017000
*                                      NECESSARY               Y02014*/ 01018000
*     THEN                                                         0228 01019000
@RF00226 L     @03,INITPTR(,PCTPTR)                                0228 01020000
         TM    GTFRNIO(@03),B'01000000'                            0228 01021000
         BNO   @RF00228                                            0228 01022000
*     PCTRNIO='1'B;                 /*                         Y02014*/ 01023000
         OI    PCTRNIO(PCTPTR),B'10000000'                         0229 01024000
*   IF GTFSRM='1'B                  /* TURN ON CATF BIT FOR SRM IF 0230 01025000
*                                      NECESSARY               Y02014*/ 01026000
*     THEN                                                         0230 01027000
@RF00228 L     @03,INITPTR(,PCTPTR)                                0230 01028000
         TM    GTFSRM(@03),B'00100000'                             0230 01029000
         BNO   @RF00230                                            0230 01030000
*     PCTSRM='1'B;                  /*                         Y02014*/ 01031000
         OI    PCTSRM(PCTPTR),B'01000000'                          0231 01032000
*   IF GTFUSR='1'B                  /* TURN ON CATF BIT FOR USR IF 0232 01033000
*                                      NECESSARY               Y02014*/ 01034000
*     THEN                                                         0232 01035000
@RF00230 L     @03,INITPTR(,PCTPTR)                                0232 01036000
         TM    GTFUSR(@03),B'00010000'                             0232 01037000
         BNO   @RF00232                                            0232 01038000
*     PCTUSR='1'B;                  /*                         Y02014*/ 01039000
         OI    PCTUSR(PCTPTR),B'00000001'                          0233 01040000
*   RETURN;                                                        0234 01041000
@EL00002 DS    0H                                                  0234 01042000
@EF00002 DS    0H                                                  0234 01043000
@ER00002 LM    @14,@12,12(@13)                                     0234 01044000
         BR    @14                                                 0234 01045000
*   END AHLTANL;                    /* RETURN TO AHLTSCN       Y02014*/ 01046000
         B     @EL00002                                            0235 01047000
*   END AHLTSCN                                                    0236 01048000
*                                                                  0236 01049000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01050000
*/*%INCLUDE SYSLIB  (INITDATA)                                       */ 01051000
*/*%INCLUDE SYSLIB  (GTFPCT  )                                       */ 01052000
*/*%INCLUDE SYSUT5  (SETDEFLT)                                       */ 01053000
*/*%INCLUDE SYSUT5  (SETDEFLT)                                       */ 01054000
*/*%INCLUDE SYSUT5  (SETDEFLT)                                       */ 01055000
*                                                                  0236 01056000
*       ;                                                          0236 01057000
         B     @EL00001                                            0236 01058000
@DATA    DS    0H                                                       01059000
@CH00056 DC    H'1'                                                     01060000
@CH00345 DC    H'2'                                                     01061000
@CH00069 DC    H'4'                                                     01062000
@CH00339 DC    H'5'                                                     01063000
@CH00279 DC    H'20'                                                    01064000
@CH00352 DC    H'123'                                                   01065000
@SC00416 CLC   MSGREPLY-1(0,@01),TRACE                                  01066000
@SM00418 MVC   OPTION(0),MSGREPLY-1(@01)                                01067000
         DS    0F                                                       01068000
@SA00001 DS    18F                                                      01069000
         DS    0F                                                       01070000
@CF00383 DC    XL4'55'                                                  01071000
@CV00313 DC    V(AHLCTL2)                                               01072000
@CV00314 DC    V(AHLTIO)                                                01073000
         DS    0D                                                       01074000
BLANK    DC    CL4'    '                                                01075000
OPTION   DS    CL4                                                      01076000
TRACE    DC    CL6'TRACE='                                              01077000
ZEROWD   DC    X'00000000'                                              01078000
SCNOPTAB DC    CL4'SYSM'                                                01079000
         DC    CL4'SYSP'                                                01080000
         DC    CL4'SYS '                                                01081000
         DC    CL4'USR '                                                01082000
         DC    CL4'TRC '                                                01083000
         DC    CL4'DSP '                                                01084000
         DC    CL4'    '                                                01085000
         DC    CL4'PCI '                                                01086000
         DC    CL4'SVC '                                                01087000
         DC    CL4'SVCP'                                                01088000
         DC    CL4'SIO '                                                01089000
         DC    CL4'SIOP'                                                01090000
         DC    CL4'PI  '                                                01091000
         DC    CL4'PIP '                                                01092000
         DC    CL4'IO  '                                                01093000
         DC    CL4'IOP '                                                01094000
         DC    CL4'EXT '                                                01095000
         DC    CL4'RNIO'                                                01096000
         DC    CL4'SRM'                                                 01097000
         DC    CL4'RR'                                                  01098000
SCNPTCH  DC    130X'00'                                                 01099000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01100000
@01      EQU   01                                                       01101000
@02      EQU   02                                                       01102000
@03      EQU   03                                                       01103000
@04      EQU   04                                                       01104000
@05      EQU   05                                                       01105000
@06      EQU   06                                                       01106000
@07      EQU   07                                                       01107000
@08      EQU   08                                                       01108000
@09      EQU   09                                                       01109000
@10      EQU   10                                                       01110000
@11      EQU   11                                                       01111000
@12      EQU   12                                                       01112000
@13      EQU   13                                                       01113000
@14      EQU   14                                                       01114000
@15      EQU   15                                                       01115000
EODIND   EQU   @05                                                      01116000
I        EQU   @03                                                      01117000
N        EQU   @04                                                      01118000
RTRNCODE EQU   @03                                                      01119000
PCTPTR   EQU   @02                                                      01120000
GTFOPADR EQU   @06                                                      01121000
SAVR     EQU   @13                                                      01122000
BYTEREG  EQU   @14                                                      01123000
MASKREG  EQU   @07                                                      01124000
MOVNUM   EQU   @15                                                      01125000
RTRNREG  EQU   @14                                                      01126000
INITDATA EQU   0                                                        01127000
ICT      EQU   INITDATA+16                                              01128000
ICTMSGX  EQU   ICT                                                      01129000
ICTIOTYP EQU   ICT+1                                                    01130000
ICTFLAGS EQU   ICT+2                                                    01131000
ICTPLIB  EQU   ICTFLAGS                                                 01132000
ICTIOERR EQU   ICTFLAGS                                                 01133000
ICTRETRY EQU   ICTFLAGS                                                 01134000
ICTTRCIN EQU   ICTFLAGS                                                 01135000
ICTSTOP  EQU   ICTFLAGS                                                 01136000
MSGREPLY EQU   INITDATA+28                                              01137000
GTFOPIND EQU   INITDATA+152                                             01138000
GTFOPT1  EQU   GTFOPIND                                                 01139000
GTFSYSM  EQU   GTFOPT1                                                  01140000
GTFSYSP  EQU   GTFOPT1                                                  01141000
GTFSYS   EQU   GTFOPT1                                                  01142000
GTFUSR   EQU   GTFOPT1                                                  01143000
GTFDSP   EQU   GTFOPT1                                                  01144000
GTFPCI   EQU   GTFOPT1                                                  01145000
GTFOPT2  EQU   GTFOPIND+1                                               01146000
GTFSVC   EQU   GTFOPT2                                                  01147000
GTFSVCP  EQU   GTFOPT2                                                  01148000
GTFSIO   EQU   GTFOPT2                                                  01149000
GTFSIOP  EQU   GTFOPT2                                                  01150000
GTFPI    EQU   GTFOPT2                                                  01151000
GTFPIP   EQU   GTFOPT2                                                  01152000
GTFIO    EQU   GTFOPT2                                                  01153000
GTFIOP   EQU   GTFOPT2                                                  01154000
GTFOPT3  EQU   GTFOPIND+2                                               01155000
GTFEXT   EQU   GTFOPT3                                                  01156000
GTFRNIO  EQU   GTFOPT3                                                  01157000
GTFSRM   EQU   GTFOPT3                                                  01158000
GTFRR    EQU   GTFOPT3                                                  01159000
GTFOPT4  EQU   GTFOPIND+3                                               01160000
TWT      EQU   INITDATA+176                                             01161000
TWTBUF   EQU   TWT+40                                                   01162000
GTFPCT   EQU   0                                                        01163000
GTFSTAT  EQU   GTFPCT+8                                                 01164000
GTFOPTS  EQU   GTFPCT+12                                                01165000
GTFOPTS1 EQU   GTFOPTS                                                  01166000
GTFOPTS2 EQU   GTFOPTS+1                                                01167000
GTFOPTS3 EQU   GTFOPTS+2                                                01168000
GTFOPTS4 EQU   GTFOPTS+3                                                01169000
PCTCATF  EQU   GTFPCT+16                                                01170000
PCTSVC   EQU   PCTCATF                                                  01171000
PCTEXT   EQU   PCTCATF                                                  01172000
PCTIO    EQU   PCTCATF                                                  01173000
PCTSIO   EQU   PCTCATF                                                  01174000
PCTDSP   EQU   PCTCATF                                                  01175000
PCTPI    EQU   PCTCATF                                                  01176000
PCTUSR   EQU   PCTCATF                                                  01177000
PCTRNIO  EQU   PCTCATF+1                                                01178000
PCTSRM   EQU   PCTCATF+1                                                01179000
PCTRR    EQU   PCTCATF+1                                                01180000
PCTSVCF  EQU   PCTCATF+1                                                01181000
PCTIOF   EQU   PCTCATF+1                                                01182000
PCTSIOF  EQU   PCTCATF+1                                                01183000
PCTPIF   EQU   PCTCATF+1                                                01184000
INITPTR  EQU   GTFPCT+60                                                01185000
NEXTBLOK EQU   GTFPCT+180                                               01186000
WRTRCOM  EQU   GTFPCT+204                                               01187000
TRMWRIT  EQU   GTFPCT+212                                               01188000
WRTRERR  EQU   GTFPCT+216                                               01189000
GTFSSRB  EQU   GTFPCT+220                                               01190000
QLOCKWRD EQU   GTFPCT+236                                               01191000
QLOCKECB EQU   GTFPCT+240                                               01192000
AUDITFLG EQU   GTFPCT+296                                               01193000
SCNSAVE  EQU   0                                                        01194000
CALLRSA1 EQU   SCNSAVE+4                                                01195000
CLRSAVE  EQU   0                                                        01196000
GPRS15   EQU   CLRSAVE+16                                               01197000
OP108    EQU   TWTBUF+49                                                01198000
WTORLEN  EQU   TWTBUF+8                                                 01199000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01200000
@NM00013 EQU   CLRSAVE+20                                               01201000
GPRS14   EQU   CLRSAVE+12                                               01202000
CALLDSA2 EQU   CLRSAVE+8                                                01203000
CALLRSA2 EQU   CLRSAVE+4                                                01204000
@NM00012 EQU   CLRSAVE                                                  01205000
REGS     EQU   SCNSAVE+12                                               01206000
CALLDSA1 EQU   SCNSAVE+8                                                01207000
@NM00011 EQU   SCNSAVE                                                  01208000
PCTWTOMD EQU   GTFPCT+312                                               01209000
PCTDMPMD EQU   GTFPCT+308                                               01210000
TRANSMAX EQU   GTFPCT+304                                               01211000
GTFASCB  EQU   GTFPCT+300                                               01212000
@NM00010 EQU   AUDITFLG+3                                               01213000
AFSLEBLD EQU   AUDITFLG+3                                               01214000
WSERFG06 EQU   AUDITFLG+3                                               01215000
WSERFG05 EQU   AUDITFLG+3                                               01216000
WSERFG04 EQU   AUDITFLG+3                                               01217000
WSERFG03 EQU   AUDITFLG+3                                               01218000
WSERFG02 EQU   AUDITFLG+2                                               01219000
WSERFLAG EQU   AUDITFLG+2                                               01220000
TERMFLAG EQU   AUDITFLG+2                                               01221000
AFXWRIT  EQU   AUDITFLG+2                                               01222000
AFQLWAIT EQU   AUDITFLG+2                                               01223000
AFSLEGET EQU   AUDITFLG+2                                               01224000
AFBUFGET EQU   AUDITFLG+2                                               01225000
AFFEOB   EQU   AUDITFLG+2                                               01226000
AFBLKFIX EQU   AUDITFLG+1                                               01227000
AFEQFIX  EQU   AUDITFLG+1                                               01228000
AFPGRLSE EQU   AUDITFLG+1                                               01229000
AFWRAP   EQU   AUDITFLG+1                                               01230000
AFBUFOFF EQU   AUDITFLG+1                                               01231000
AFLDFX   EQU   AUDITFLG+1                                               01232000
AFCLOSE  EQU   AUDITFLG+1                                               01233000
AFOPEN   EQU   AUDITFLG+1                                               01234000
AFGMBLOK EQU   AUDITFLG                                                 01235000
AFGMSRB  EQU   AUDITFLG                                                 01236000
AFWAIT   EQU   AUDITFLG                                                 01237000
AFTERM   EQU   AUDITFLG                                                 01238000
AFINIT   EQU   AUDITFLG                                                 01239000
AFWWRIT  EQU   AUDITFLG                                                 01240000
AFCWRIT  EQU   AUDITFLG                                                 01241000
AFIWRIT  EQU   AUDITFLG                                                 01242000
EQSHORT  EQU   GTFPCT+292                                               01243000
SLEMAX   EQU   GTFPCT+288                                               01244000
SLECNT   EQU   GTFPCT+284                                               01245000
RQPURGE  EQU   GTFPCT+280                                               01246000
RQTOTAL  EQU   GTFPCT+276                                               01247000
WRTDLST  EQU   GTFPCT+272                                               01248000
NUMOFBUF EQU   GTFPCT+268                                               01249000
SBUFDISA EQU   GTFPCT+264                                               01250000
SLESUSED EQU   GTFPCT+260                                               01251000
EQMIN    EQU   GTFPCT+256                                               01252000
EQLENGTH EQU   GTFPCT+252                                               01253000
WQMAX    EQU   GTFPCT+248                                               01254000
WQLENGTH EQU   GTFPCT+244                                               01255000
QLECBP   EQU   QLOCKECB                                                 01256000
@NM00009 EQU   QLOCKECB                                                 01257000
@NM00008 EQU   QLOCKWRD+3                                               01258000
SCHEDBUF EQU   QLOCKWRD+2                                               01259000
POSTWRIT EQU   QLOCKWRD+1                                               01260000
QLOCK    EQU   QLOCKWRD                                                 01261000
WRITERDD EQU   GTFPCT+228                                               01262000
GTFLOSTR EQU   GTFPCT+224                                               01263000
SRBAVAIL EQU   GTFSSRB                                                  01264000
WRTRERRP EQU   WRTRERR                                                  01265000
@NM00007 EQU   WRTRERR                                                  01266000
TRMWRITP EQU   TRMWRIT                                                  01267000
@NM00006 EQU   TRMWRIT                                                  01268000
GTFCMECB EQU   GTFPCT+208                                               01269000
WRTRCOMP EQU   WRTRCOM                                                  01270000
@NM00005 EQU   WRTRCOM                                                  01271000
TRANSCNT EQU   GTFPCT+200                                               01272000
AHLRDPLQ EQU   GTFPCT+196                                               01273000
SFEOBRTN EQU   GTFPCT+192                                               01274000
SBLOKRTN EQU   GTFPCT+188                                               01275000
CURRBLOK EQU   GTFPCT+184                                               01276000
GBCDS    EQU   NEXTBLOK                                                 01277000
WSMODEND EQU   GTFPCT+176                                               01278000
WSMODBEG EQU   GTFPCT+172                                               01279000
BCBPAGE  EQU   GTFPCT+156                                               01280000
SLEPAGE  EQU   GTFPCT+152                                               01281000
SAVECNT  EQU   GTFPCT+148                                               01282000
SLQHEAD  EQU   GTFPCT+144                                               01283000
HQLENGTH EQU   GTFPCT+140                                               01284000
QTAIL    EQU   GTFPCT+136                                               01285000
HQHEAD   EQU   GTFPCT+132                                               01286000
WQHEAD   EQU   GTFPCT+128                                               01287000
RQHEAD   EQU   GTFPCT+124                                               01288000
EQHEAD   EQU   GTFPCT+120                                               01289000
WPOSTSRB EQU   GTFPCT+116                                               01290000
WTSKTCBA EQU   GTFPCT+112                                               01291000
WRTRTCBA EQU   GTFPCT+108                                               01292000
TRMWTASK EQU   GTFPCT+104                                               01293000
WTSKATTH EQU   GTFPCT+100                                               01294000
WTSKINIT EQU   GTFPCT+96                                                01295000
WTASKECB EQU   GTFPCT+92                                                01296000
WMTABPTR EQU   GTFPCT+88                                                01297000
ATTCHECB EQU   GTFPCT+84                                                01298000
AHLECB   EQU   GTFPCT+80                                                01299000
STOPECBA EQU   GTFPCT+76                                                01300000
ECBADRLT EQU   GTFPCT+72                                                01301000
FIXLEN   EQU   GTFPCT+68                                                01302000
FIXPTR   EQU   GTFPCT+64                                                01303000
MCQEPTR  EQU   GTFPCT+56                                                01304000
GTFEIDL  EQU   GTFPCT+52                                                01305000
GTFPIBL  EQU   GTFPCT+48                                                01306000
GTFPIFT  EQU   GTFPCT+44                                                01307000
GTFSVCBL EQU   GTFPCT+40                                                01308000
GTFSVCFT EQU   GTFPCT+36                                                01309000
GTFIOBL  EQU   GTFPCT+32                                                01310000
GTFIOFT  EQU   GTFPCT+28                                                01311000
GTFSIOBL EQU   GTFPCT+24                                                01312000
GTFSIOFT EQU   GTFPCT+20                                                01313000
@NM00004 EQU   PCTCATF+1                                                01314000
@NM00003 EQU   PCTCATF                                                  01315000
OPTTIME  EQU   GTFOPTS4                                                 01316000
OPTRES3  EQU   GTFOPTS4                                                 01317000
OPTIOSIO EQU   GTFOPTS3                                                 01318000
OPTRES2  EQU   GTFOPTS3                                                 01319000
OPTRR    EQU   GTFOPTS3                                                 01320000
OPTSRM   EQU   GTFOPTS3                                                 01321000
OPTRNIO  EQU   GTFOPTS3                                                 01322000
OPTEXT   EQU   GTFOPTS3                                                 01323000
OPTIOP   EQU   GTFOPTS2                                                 01324000
OPTIO    EQU   GTFOPTS2                                                 01325000
OPTPIP   EQU   GTFOPTS2                                                 01326000
OPTPI    EQU   GTFOPTS2                                                 01327000
OPTSIOP  EQU   GTFOPTS2                                                 01328000
OPTSIO   EQU   GTFOPTS2                                                 01329000
OPTSVCP  EQU   GTFOPTS2                                                 01330000
OPTSVC   EQU   GTFOPTS2                                                 01331000
OPTPCI   EQU   GTFOPTS1                                                 01332000
OPTRES1  EQU   GTFOPTS1                                                 01333000
OPTDSP   EQU   GTFOPTS1                                                 01334000
OPTTRC   EQU   GTFOPTS1                                                 01335000
OPTUSR   EQU   GTFOPTS1                                                 01336000
OPTSYS   EQU   GTFOPTS1                                                 01337000
OPTSYSP  EQU   GTFOPTS1                                                 01338000
OPTSYSM  EQU   GTFOPTS1                                                 01339000
GTFRESV  EQU   GTFSTAT                                                  01340000
GTFDEBUG EQU   GTFSTAT                                                  01341000
GTFMODE  EQU   GTFSTAT                                                  01342000
GTFPCTID EQU   GTFPCT                                                   01343000
TWTWORK  EQU   TWT+8                                                    01344000
@NM00002 EQU   TWT+4                                                    01345000
@NM00001 EQU   TWT                                                      01346000
RANGPTR  EQU   INITDATA+172                                             01347000
PITAB    EQU   INITDATA+168                                             01348000
SVCTAB   EQU   INITDATA+164                                             01349000
SIOTAB   EQU   INITDATA+160                                             01350000
IOTAB    EQU   INITDATA+156                                             01351000
GTFTIME  EQU   GTFOPT4                                                  01352000
GTFRES3  EQU   GTFOPT4                                                  01353000
GTFIOSIO EQU   GTFOPT3                                                  01354000
GTFRES2  EQU   GTFOPT3                                                  01355000
GTFRES1  EQU   GTFOPT1                                                  01356000
GTFTRC   EQU   GTFOPT1                                                  01357000
WTORECB  EQU   INITDATA+24                                              01358000
PARMDCB  EQU   INITDATA+20                                              01359000
ICTRESV  EQU   ICTFLAGS                                                 01360000
ICTEOD   EQU   ICTFLAGS                                                 01361000
EXECPTR  EQU   INITDATA+12                                              01362000
CIBPTR   EQU   INITDATA+8                                               01363000
INITID   EQU   INITDATA                                                 01364000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01365000
@RT00027 EQU   SCN06                                                    01366000
@RT00029 EQU   SCN04                                                    01367000
@RT00034 EQU   SCN06                                                    01368000
@RT00039 EQU   SCN05                                                    01369000
@RT00059 EQU   SCN07                                                    01370000
@RT00065 EQU   SCN02                                                    01371000
@RT00067 EQU   SCN08                                                    01372000
@RT00071 EQU   SCN02                                                    01373000
@RT00073 EQU   SCN02                                                    01374000
@RT00082 EQU   SCN10                                                    01375000
@RC00092 EQU   SCN03                                                    01376000
@RT00117 EQU   SCN09                                                    01377000
@RT00139 EQU   ANL02                                                    01378000
@RT00185 EQU   IOFRTN                                                   01379000
@RT00187 EQU   IORTN                                                    01380000
@RF00189 EQU   ANL05                                                    01381000
@RT00202 EQU   ANL06                                                    01382000
@RT00211 EQU   ANL08                                                    01383000
@RT00220 EQU   ANL095                                                   01384000
@RF00232 EQU   @EL00002                                                 01385000
@PB00002 EQU   @EL00001                                                 01386000
@ENDDATA EQU   *                                                        01387000
         END   AHLTSCN,(C'PL/S-II',0502,73240)                          01388000
