         TITLE 'AHLTTAB          FILTER TABLE CONVERT ROUTINE          *00001000
                       '                                                00002000
AHLTTAB  CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'AHLTTAB   73.241'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         ST    @13,@SA00001+4                                      0001 00014000
         LA    @14,@SA00001                                        0001 00015000
         ST    @14,8(,@13)                                         0001 00016000
         LR    @13,@14                                             0001 00017000
*                                                                  0030 00018000
*/********************************************************************/ 00019000
*/*                                                                  */ 00020000
*/* EXECUTABLE CODE                                                  */ 00021000
*/*                                                                  */ 00022000
*/* INITIALIZATION                                                   */ 00023000
*/*                                                                  */ 00024000
*/********************************************************************/ 00025000
*/********************************************************************/ 00026000
*/*                                                                  */ 00027000
*/* CHECK FOR AN IO DEVICE TABLE TO BE CONVERTED INTO A FILTER TABLE */ 00028000
*/*                                                                  */ 00029000
*/********************************************************************/ 00030000
*                                                                  0030 00031000
*   IF GTFIOP='1'B                  /* IS THERE AN IO DEVICE ADDRESS    00032000
*                                      TABLE TO BE CONVERTED?  Y02014*/ 00033000
*     THEN                          /* YES                           */ 00034000
         L     @05,INITPTR(,PCTPTR)                                0030 00035000
         TM    GTFIOP(@05),B'00000001'                             0030 00036000
         BNO   @RF00030                                            0030 00037000
*     DO;                           /* YES THERE IS                  */ 00038000
*       PATHSW=0;                   /* SET THIS SWITCH TO INDICATE TO   00039000
*                                      THE COMMON CODE THAT IT IS THE   00040000
*                                      IO TABLE NOT THE SIO BEING  0032 00041000
*                                      CONVERTED                     */ 00042000
         SR    PATHSW,PATHSW                                       0032 00043000
*       OPPTR=IOTAB;                /* PUT THE ADDRESS OF THE IO   0033 00044000
*                                      TABLE INTO THE COMMON PTR   0033 00045000
*                                                              Y02014*/ 00046000
         L     @09,INITPTR(,PCTPTR)                                0033 00047000
         L     OPPTR,IOTAB(,@09)                                   0033 00048000
*       GO TO CNVT02;               /* BRANCH TO THE COMMON CODE     */ 00049000
         B     CNVT02                                              0034 00050000
*     END;                                                         0035 00051000
*                                                                  0035 00052000
*/********************************************************************/ 00053000
*/*                                                                  */ 00054000
*/* CHECK FOR AN SIO DEVICE TABLE TO BE CONVERTED INTO A FILTER TABLE*/ 00055000
*/*                                                                  */ 00056000
*/********************************************************************/ 00057000
*                                                                  0036 00058000
*CNVT01:                            /* FALL THROUGH TO HERE IF THERE    00059000
*                                      IS NO IO TABLE TO BE DONE, OR    00060000
*                                      IF THE IO TABLE HAS BEEN DONE    00061000
*                                      AND THE IO=SIO BIT ISN'T ON 0036 00062000
*                                                              Y02014*/ 00063000
*   IF GTFSIOP='0'B                 /* IS THERE AN SIO DEVICE TABLE     00064000
*                                      TO BE CONVERTED?        Y02014*/ 00065000
*     THEN                          /* NO                            */ 00066000
@RF00030 DS    0H                                                  0036 00067000
CNVT01   L     @05,INITPTR(,PCTPTR)                                0036 00068000
         TM    GTFSIOP(@05),B'00010000'                            0036 00069000
         BZ    @RT00036                                            0036 00070000
*     GO TO CNVT07;                 /* NO THEN SKIP TO THE NEXT    0037 00071000
*                                      CONVERTION                    */ 00072000
*   OPPTR=SIOTAB;                   /* YES THERE IS AN SIO TABLE SO     00073000
*                                      SET THE COMMON POINTER TO IT     00074000
*                                                              Y02014*/ 00075000
         L     @09,INITPTR(,PCTPTR)                                0038 00076000
         L     OPPTR,SIOTAB(,@09)                                  0038 00077000
*   PATHSW=1;                       /* AND SET THIS SWITCH TO      0039 00078000
*                                      INDICATE TO THE COMMON CODE 0039 00079000
*                                      THAT THE SIO TABLE IS BEING 0039 00080000
*                                      DONE                          */ 00081000
         LA    PATHSW,1                                            0039 00082000
*                                                                  0040 00083000
*/********************************************************************/ 00084000
*/*                                                                  */ 00085000
*/* THIS IS THE COMMON CODE THAT CONVERTS IO &/OR SIO DEVICE TABLES  */ 00086000
*/* INTO FILTER TABLES                                               */ 00087000
*/* FIRST CALCULATE THE AMOUNT OF CORE NEEDED FOR THE TABLE          */ 00088000
*/*                                                                  */ 00089000
*/********************************************************************/ 00090000
*                                                                  0040 00091000
*CNVT02:                            /* THIS LOOP GOES THROUGH THE IO    00092000
*                                      OR SIO TABLE AND COUNTS THE 0040 00093000
*                                      EXACT AMOUNT OF CORE THAT WILL   00094000
*                                      BE NEEDED FOR THE           0040 00095000
*                                      CORRESPONDING FILTER TABLE    */ 00096000
*   I=1;                            /* START AT THE BEGINNING OF THE    00097000
*                                      IO OR SIO DEVICE TABLE        */ 00098000
CNVT02   LA    I,1                                                 0040 00099000
*   FLTRLEN=22;                     /* SET ASIDE 16 BYTES FOR THE  0041 00100000
*                                      CHANNEL DISPLACEMENT TABLE  0041 00101000
*                                      THAT GOES AT THE HEAD OF THE     00102000
*                                      FILTER TABLE PLUS 4 BYTES FOR    00103000
*                                      THE FIRST & LAST ENTRIES OF 0041 00104000
*                                      'FFFF'X PLUS 2 BYTES FOR THE     00105000
*                                      LNG FIELD               Y02014*/ 00106000
         MVC   FLTRLEN(4),@CF00344                                 0041 00107000
*   CHANLSAV=CHANL(I);              /* SAVE THE CHANNEL DIGIT FROM 0042 00108000
*                                      THE FIRST UNIT ADDR IN THE TBL*/ 00109000
         LR    @09,I                                               0042 00110000
         MH    @09,@CH00069                                        0042 00111000
         AL    @09,@CF00375                                        0042 00112000
         SR    CHANLSAV,CHANLSAV                                   0042 00113000
         IC    CHANLSAV,CHANL(@09,OPPTR)                           0042 00114000
*CNVT03:                            /* BRANCH HERE TO CONTINUE THE 0043 00115000
*                                      COUNT                         */ 00116000
*   IF CHANL(I)=CHANLSAV            /* IS THE CHANNEL DIGIT OF THIS     00117000
*                                      UNIT ADDRESS THE SAME AS THE     00118000
*                                      ONE BEFORE IT IN THE TABLE?   */ 00119000
*     THEN                          /* YES IT IS SO IT WILL ONLY   0043 00120000
*                                      REQUIRE ONE ENTRY             */ 00121000
CNVT03   LR    @09,I                                               0043 00122000
         MH    @09,@CH00069                                        0043 00123000
         AL    @09,@CF00375                                        0043 00124000
         SR    @06,@06                                             0043 00125000
         IC    @06,CHANL(@09,OPPTR)                                0043 00126000
         CR    CHANLSAV,@06                                        0043 00127000
         BNE   @RF00043                                            0043 00128000
*     FLTRLEN=FLTRLEN+2;            /* 2 BYTES                       */ 00129000
         LA    @09,2                                               0044 00130000
         A     @09,FLTRLEN                                         0044 00131000
         ST    @09,FLTRLEN                                         0044 00132000
*   ELSE                            /* NO                            */ 00133000
*     DO;                           /* NO IT IS DIFFERENT SO WE ARE     00134000
*                                      GOING TO NEED A 'FFFF'X ENTRY    00135000
*                                      TO SHOW END OF THE GROUP      */ 00136000
         B     @RC00043                                            0045 00137000
@RF00043 DS    0H                                                  0046 00138000
*       FLTRLEN=FLTRLEN+4;          /* TWO ENTRIES 4 BYTES           */ 00139000
         LA    @09,4                                               0046 00140000
         A     @09,FLTRLEN                                         0046 00141000
         ST    @09,FLTRLEN                                         0046 00142000
*       CHANLSAV=CHANL(I);          /* NOW THAT WE ARE INTO A NEW  0047 00143000
*                                      GROUP OF CHANNELS UPDATE THE     00144000
*                                      DIGIT BEING COMPARED          */ 00145000
         LR    @09,I                                               0047 00146000
         MH    @09,@CH00069                                        0047 00147000
         AL    @09,@CF00375                                        0047 00148000
         SR    CHANLSAV,CHANLSAV                                   0047 00149000
         IC    CHANLSAV,CHANL(@09,OPPTR)                           0047 00150000
*     END;                                                         0048 00151000
*   I=I+1;                          /* INCREMENT THE LOOP INDEX      */ 00152000
@RC00043 AH    I,@CH00039                                          0049 00153000
*   IF ENTRX(I)^=ENDLST1            /* IS THIS THE DEVICE TABLE END? */ 00154000
*     THEN                          /* NO                            */ 00155000
         LR    @09,I                                               0050 00156000
         MH    @09,@CH00069                                        0050 00157000
         ALR   @09,OPPTR                                           0050 00158000
         AL    @09,@CF00375                                        0050 00159000
         CLC   ENTRX(3,@09),ENDLST1                                0050 00160000
         BNE   @RT00050                                            0050 00161000
*     GO TO CNVT03;                 /* NO, SO THEN CONTINUE THE LOOP */ 00162000
*   RFY                                                            0052 00163000
*     RETCODE RSTD;                 /* RESTRICT REGISTER 15    Y02014*/ 00164000
*   GEN;                                                           0053 00165000
*                                   /* YES # OF BYTS IS IN FLTRLEN   */ 00166000
        L  0,FLTRLEN                                                    00167000
        GETMAIN EC,LV=(0),A=GETFREE,SP=245                              00168000
*                                   /* GET THE FILTER TABLE CORE        00169000
*                                                              Y02014*/ 00170000
*                                   /* SAVE THE ADDR OF THE CORE JUST   00171000
*                                      GOTTEN AS THE FILTER TABLE  0054 00172000
*                                      ADDRESS                       */ 00173000
*   IF RETCODE^=0                   /* CHECK FOR NONZERO RET CODE    */ 00174000
*     THEN                          /* NONZERO                       */ 00175000
         SR    @14,@14                                             0054 00176000
         CR    RETCODE,@14                                         0054 00177000
         BNE   @RT00054                                            0054 00178000
*     GO TO CNVT14;                 /* GETMAIN ERROR WRITE GO MSG    */ 00179000
*   RFY                                                            0056 00180000
*     RETCODE UNRSTD;               /* UNRESTRICT REGISTER 15  Y02014*/ 00181000
*   FLTRAD=GETFREE;                 /* PUT THE ADDRESS OF THE GOTTEN    00182000
*                                      CORE IN A REG                 */ 00183000
         L     FLTRAD,GETFREE                                      0057 00184000
*   LNGTAB=FLTRLEN;                 /* PLACE LENGTH OF TABLE IN 1ST     00185000
*                                      BYTE                    Y02014*/ 00186000
         MVC   LNGTAB(2,FLTRAD),FLTRLEN+2                          0058 00187000
*                                                                  0059 00188000
*/********************************************************************/ 00189000
*/*                                                                  */ 00190000
*/* CONVERT THE DEVICE TABLE ENTRIES INTO BINARY AND BUILD THE FILTER*/ 00191000
*/* TABLE IN THE CORE JUST OBTAINED                                  */ 00192000
*/*                                                                  */ 00193000
*/********************************************************************/ 00194000
*                                                                  0059 00195000
*   UNITADD=0;                      /* INITIALIZE THE UNIT ADDRESS TO   00196000
*                                      ZERO                          */ 00197000
         ST    @14,UNITADD                                         0059 00198000
*   OFST=OFST&&OFST;                /* ZERO CHANNEL DISPLACEMENT     */ 00199000
         XC    OFST(16,FLTRAD),OFST(FLTRAD)                        0060 00200000
*                                   /* BYTES                   Y02014*/ 00201000
*   K=1;                            /* INITIALIZE THE INDEX FOR THE     00202000
*                                      FILTER TABLE ENTRIES          */ 00203000
         LA    @09,1                                               0061 00204000
         LR    K,@09                                               0061 00205000
*   I=1;                            /* INITIALIZE THE INDEX FOR THE     00206000
*                                      DEVICE TABLE ENTRIES          */ 00207000
         LR    I,@09                                               0062 00208000
*   CHANLSAV='FF'X;                 /* INITIALIZE THE CHANNEL DIGIT     00209000
*                                      TO ONE THAT WILL NEVER BE THE    00210000
*                                      SAME AS THE ONE FOR THE FIRST    00211000
*                                      UNIT ADDRESS IN THE TABLE SO     00212000
*                                      THAT ON THE FIRST TIME THROUGH   00213000
*                                      THE LOOP A 'FFFF'X ENTRY WILL    00214000
*                                      BE MADE                       */ 00215000
         LA    CHANLSAV,255                                        0063 00216000
*CNVT04:                                                           0064 00217000
*                                                                  0064 00218000
*   /*****************************************************************/ 00219000
*   /*                                                               */ 00220000
*   /* IS THIS THE END OF THE DEVICE TABLE?                          */ 00221000
*   /*                                                               */ 00222000
*   /*****************************************************************/ 00223000
*                                                                  0064 00224000
*   IF ENTRX(I)=ENDLST1 THEN        /* YES                           */ 00225000
CNVT04   LR    @09,I                                               0064 00226000
         MH    @09,@CH00069                                        0064 00227000
         ST    @09,@TF00001                                        0064 00228000
         ALR   @09,OPPTR                                           0064 00229000
         AL    @09,@CF00375                                        0064 00230000
         CLC   ENTRX(3,@09),ENDLST1                                0064 00231000
         BE    @RT00064                                            0064 00232000
*     GO TO CNVT06;                 /* YES THEN LEAVE THE LOOP       */ 00233000
*   UNITADD(1:3)=ENTRX(I);          /* PUT THE ENTRY TO BE CONVERTED    00234000
*                                      INTO THE FIRST THREE BYTES OF    00235000
*                                      A WORK SPACE                  */ 00236000
         LR    @09,OPPTR                                           0066 00237000
         AL    @09,@TF00001                                        0066 00238000
         AL    @09,@CF00375                                        0066 00239000
         MVC   UNITADD(3),ENTRX(@09)                               0066 00240000
*   GEN;                                                           0067 00241000
*                                                                  0067 00242000
*                                   /* CONVERT IT                    */ 00243000
T3       EQU   3                                                        00244000
T4       EQU   4                                                        00245000
         TR    UNITADD(T3),TRANTAB                                      00246000
         PACK  PKENT(T3),UNITADD(T4)                                    00247000
*   /*****************************************************************/ 00248000
*   /*                                                               */ 00249000
*   /* SEE IF THE CHANNEL DIGIT IS THE SAME AS THE ONE BEFORE        */ 00250000
*   /*                                                               */ 00251000
*   /*****************************************************************/ 00252000
*                                                                  0068 00253000
*   IF CHANL(I)=CHANLSAV THEN       /* YES                           */ 00254000
         LR    @09,I                                               0068 00255000
         MH    @09,@CH00069                                        0068 00256000
         AL    @09,@CF00375                                        0068 00257000
         SR    @15,@15                                             0068 00258000
         IC    @15,CHANL(@09,OPPTR)                                0068 00259000
         CR    @15,CHANLSAV                                        0068 00260000
         BE    @RT00068                                            0068 00261000
*     GO TO CNVT05;                 /* YES IT IS SO SKIP PUTTING THE    00262000
*                                      'FFFF'X ENTRY IN              */ 00263000
*   CHANLSAV=CHANL(I);              /* THEY ARE DIFFERENT SO SAVE THE   00264000
*                                      NEW CHANNELL DIGIT            */ 00265000
         LR    CHANLSAV,@15                                        0070 00266000
*   DVADFT(K)=ENDLST1(1:2);         /* PUT A 'FFFF' ENTRY INTO THE 0071 00267000
*                                      FILTER TABLE                  */ 00268000
         LR    @09,K                                               0071 00269000
         AR    @09,@09                                             0071 00270000
         ALR   @09,FLTRAD                                          0071 00271000
         MVC   DVADFT-2(2,@09),ENDLST1                             0071 00272000
*   K=K+1;                          /* INCREMENT THE INDEX TO THE  0072 00273000
*                                      NEXT FILTER TABLE ENTRY       */ 00274000
*                                                                  0072 00275000
         AH    K,@CH00039                                          0072 00276000
*   /*****************************************************************/ 00277000
*   /*                                                               */ 00278000
*   /* CALCULATE THE DISPLACEMENT TO THE NEXT FILTER TABLE ENTRY FROM*/ 00279000
*   /* THE BEGINNING OF THE TABLE ENTRIES, AND STORE IT IN THE OFFSET*/ 00280000
*   /* PORTION OF THE TABLE                                          */ 00281000
*   /*                                                               */ 00282000
*   /*****************************************************************/ 00283000
*                                                                  0073 00284000
*   OFFSET(PKCHAN+1)=ADDR(DVADFT(K))-ADDR(DVADFT(1));              0073 00285000
         SR    @09,@09                                             0073 00286000
         IC    @09,PKCHAN                                          0073 00287000
         LR    @15,K                                               0073 00288000
         AR    @15,@15                                             0073 00289000
         LA    @15,DVADFT-2(@15,FLTRAD)                            0073 00290000
         LA    @14,DVADFT(,FLTRAD)                                 0073 00291000
         SR    @15,@14                                             0073 00292000
         STC   @15,OFFSET(@09,FLTRAD)                              0073 00293000
*CNVT05:                            /* BRANCH HERE IF UNIT IS VALID  */ 00294000
*   DVADFT(K)=PKDA;                 /* STORE THE UNIT ADDRESS INTO 0074 00295000
*                                      THE FILTER TABLE              */ 00296000
CNVT05   LR    @09,K                                               0074 00297000
         AR    @09,@09                                             0074 00298000
         ALR   @09,FLTRAD                                          0074 00299000
         MVC   DVADFT-2(2,@09),PKDA                                0074 00300000
*   K=K+1;                          /* INCREMENT THIS INDEX TO THE 0075 00301000
*                                      NEXT FILTER TABLE ENTRY       */ 00302000
         LA    @09,1                                               0075 00303000
         AR    K,@09                                               0075 00304000
*   I=I+1;                          /* INCREMENT THIS INDEX TO THE 0076 00305000
*                                      NEXT DEVICE TABLE ENTRY       */ 00306000
         AR    I,@09                                               0076 00307000
*   GO TO CNVT04;                   /* GO SEE IF THIS IS THE END OF     00308000
*                                      THE TABLE                     */ 00309000
         B     CNVT04                                              0077 00310000
*CNVT06:                            /* BRANCH HERE WHEN THE LAST   0078 00311000
*                                      ENTRY HAS BEEN CONVERTED      */ 00312000
*   DVADFT(K)=ENDLST1(1:2);         /* STORE A 'FFFF'X TO SHOW THIS     00313000
*                                      IS THE END OF THE ENTRIES FOR    00314000
*                                      THE LAST CHANNEL              */ 00315000
*                                                                  0078 00316000
CNVT06   LR    @09,K                                               0078 00317000
         AR    @09,@09                                             0078 00318000
         ALR   @09,FLTRAD                                          0078 00319000
         MVC   DVADFT-2(2,@09),ENDLST1                             0078 00320000
*/********************************************************************/ 00321000
*/*                                                                  */ 00322000
*/* FREE THE CORE USED BY THE OLD DEVICE TABLE NOW THAT A FILTER     */ 00323000
*/* TABLE IS BUILT AND CHECK TO SEE IF THERE IS ANOTHER DEVICE TABLE */ 00324000
*/* TO BE CONVERTED                                                  */ 00325000
*/*                                                                  */ 00326000
*/********************************************************************/ 00327000
*                                                                  0079 00328000
*   ENTBLN=153;                     /* PUT THE LENGTH OF THE IO/SIO     00329000
*                                      DEVICE TABLE INTO REG 0       */ 00330000
         LA    ENTBLN,153                                          0079 00331000
*   ENTBLAD=OPPTR;                  /* AND ITS ADDRESS INTO REG 1    */ 00332000
         LR    ENTBLAD,OPPTR                                       0080 00333000
*   GEN;                                                           0081 00334000
*                                                                  0081 00335000
*                                   /* THEN FREE IT                  */ 00336000
        FREEMAIN R,LV=(0),A=(1)                                         00337000
*   /*****************************************************************/ 00338000
*   /*                                                               */ 00339000
*   /* WAS THIS THE SIO TABLE THAT WAS BEING CONVERTED               */ 00340000
*   /*                                                               */ 00341000
*   /*****************************************************************/ 00342000
*                                                                  0082 00343000
*   IF PATHSW=1 THEN                /* YES                           */ 00344000
         CH    PATHSW,@CH00039                                     0082 00345000
         BNE   @RF00082                                            0082 00346000
*     DO;                           /* YES SO                        */ 00347000
*       SIOTAB=0;                   /* ZERO EBCDIC TABLE PTR         */ 00348000
         L     @05,INITPTR(,PCTPTR)                                0084 00349000
         SR    @03,@03                                             0084 00350000
         ST    @03,SIOTAB(,@05)                                    0084 00351000
*       GTFSIOFT=FLTRAD;            /* STORE THE FILTER TABLE ADDRESS   00352000
*                                      IN GTFPCT               Y02014*/ 00353000
         ST    FLTRAD,GTFSIOFT(,PCTPTR)                            0085 00354000
*       GO TO CNVT07;               /* AND SKIP TO THE NEXT        0086 00355000
*                                      CONVERTION                    */ 00356000
         B     CNVT07                                              0086 00357000
*     END;                                                         0087 00358000
*   IF GTFIOSIO='0'B                /* MEANING ONE TABLE FOR BOTH?   */ 00359000
*                                                                  0088 00360000
*   /*****************************************************************/ 00361000
*   /*                                                               */ 00362000
*   /* IT WASN'T SIO SO IT MUST HAVE BEEN IO, IS THE IOEQ BIT ON     */ 00363000
*   /*                                                         Y02014*/ 00364000
*   /*                                                               */ 00365000
*   /*****************************************************************/ 00366000
*                                                                  0088 00367000
*     THEN                          /* NO                            */ 00368000
@RF00082 L     @05,INITPTR(,PCTPTR)                                0088 00369000
         TM    GTFIOSIO(@05),B'00000001'                           0088 00370000
         BNZ   @RF00088                                            0088 00371000
*     DO;                           /* NO THEN                       */ 00372000
*       IOTAB=0;                    /* ZERO EBCDIC TABLE PTR   Y02014*/ 00373000
         SR    @03,@03                                             0090 00374000
         ST    @03,IOTAB(,@05)                                     0090 00375000
*       GTFIOFT=FLTRAD;             /* JUST STORE THE FILTER TABLE 0091 00376000
*                                      ADDRESS IN GTFPCT FOR IO    0091 00377000
*                                      FILTER TABLE            Y02014*/ 00378000
         ST    FLTRAD,GTFIOFT(,PCTPTR)                             0091 00379000
*       GO TO CNVT01;               /* AND THEN GO BACK AND SEE IF 0092 00380000
*                                      THERE IS ANY SIO TABLE        */ 00381000
         B     CNVT01                                              0092 00382000
*     END;                                                         0093 00383000
*   IOTAB=0;                        /* ZERO EBCDIC PTRS        Y02014*/ 00384000
@RF00088 SR    @05,@05                                             0094 00385000
         L     @03,INITPTR(,PCTPTR)                                0094 00386000
         ST    @05,IOTAB(,@03)                                     0094 00387000
*   SIOTAB=0;                       /* ZERO EBCDIC PTRS        Y02014*/ 00388000
         ST    @05,SIOTAB(,@03)                                    0095 00389000
*   GTFIOFT=FLTRAD;                 /* OTHERWISE IF THE IOEQ BIT IS     00390000
*                                      ON STORE THE TABLE ADDRESS IN    00391000
*                                      THE PCT AS BOTH IO      Y02014*/ 00392000
         ST    FLTRAD,GTFIOFT(,PCTPTR)                             0096 00393000
*   GTFSIOFT=FLTRAD;                /* AND SIO                 Y02014*/ 00394000
         ST    FLTRAD,GTFSIOFT(,PCTPTR)                            0097 00395000
*                                                                  0098 00396000
*/********************************************************************/ 00397000
*/*                                                                  */ 00398000
*/* CHECK TO SEE IF THERE IS A PI TABLE TO BE CONVERTED AND BUILD    */ 00399000
*/* A FILTER TABLE IF THERE IS                                       */ 00400000
*/*                                                                  */ 00401000
*/********************************************************************/ 00402000
*                                                                  0098 00403000
*CNVT07:                            /* COME HERE WHEN BOTH IO AND SIO   00404000
*                                      ARE TAKEN CARE OF             */ 00405000
*   IF GTFPIP='0'B                  /* IS THERE A PI TABLE TO BE   0098 00406000
*                                      CONVERTED?              Y02014*/ 00407000
*     THEN                          /* NO                            */ 00408000
CNVT07   L     @05,INITPTR(,PCTPTR)                                0098 00409000
         TM    GTFPIP(@05),B'00000100'                             0098 00410000
         BZ    @RT00098                                            0098 00411000
*     GO TO CNVT10;                 /* NO THEN SKIP TO THE NEXT    0099 00412000
*                                      CONVERTION                    */ 00413000
*   RFY                                                            0100 00414000
*     RETCODE RSTD;                 /* RESTRICT REGISTER 15    Y02014*/ 00415000
*   GEN;                                                           0101 00416000
*                                   /* YES GET FILTER TABLE CORE     */ 00417000
*                                   /*                         Y02014*/ 00418000
        GETMAIN EC,LV=8,A=GETFREE,SP=245                                00419000
*                                   /* STORE THE ADDRESS OF THE CORE    00420000
*                                      JUST GOTTEN AS THE PTR TO THE    00421000
*                                      FILTER TABLE                  */ 00422000
*                                                                  0102 00423000
*   /*****************************************************************/ 00424000
*   /*                                                               */ 00425000
*   /* CHECK THE RETURN CODE FOR A NONZERO NUMBER                    */ 00426000
*   /*                                                               */ 00427000
*   /*****************************************************************/ 00428000
*                                                                  0102 00429000
*   IF RETCODE^=0 THEN              /* NONZERO                       */ 00430000
         LTR   RETCODE,RETCODE                                     0102 00431000
         BNZ   @RT00102                                            0102 00432000
*     GO TO CNVT14;                 /* GETMAIN ERROR WRITE GO MSG    */ 00433000
*   RFY                                                            0104 00434000
*     RETCODE UNRSTD;               /* UNRESTRICT REG 15       Y02014*/ 00435000
*   FLTRAD=GETFREE;                 /* PUT THE ADDRESS OF THE GOTTEN    00436000
*                                      CORE IN A REG                 */ 00437000
         L     FLTRAD,GETFREE                                      0105 00438000
*   LNGTAB=8;                       /* PUT LENGTH IN TABLE     Y02014*/ 00439000
         MVC   LNGTAB(2,FLTRAD),@CH00036                           0106 00440000
*   OPPTR=PITAB;                    /* LOAD THE ADDRESS OF THE PI  0107 00441000
*                                      TABLE TO BE CONVERTED FROM THE   00442000
*                                      PCT                     Y02014*/ 00443000
         L     @15,INITPTR(,PCTPTR)                                0107 00444000
         L     OPPTR,PITAB(,@15)                                   0107 00445000
*   SVPIFLTB(1:6)=SVPIFLTB(1:6)&&SVPIFLTB(1:6);/* ZERO OUT THE PI  0108 00446000
*                                      FILTER TABLE            Y02014*/ 00447000
         XC    SVPIFLTB(6,FLTRAD),SVPIFLTB(FLTRAD)                 0108 00448000
*   I=1;                            /* INITIALIZE THIS INDEX TO THE     00449000
*                                      BEGINNING OF THE TABLE TO BE     00450000
*                                      CONVERTED                     */ 00451000
         LA    I,1                                                 0109 00452000
*CNVT08:                            /* END CHECK FOR LOOP            */ 00453000
*   IF ENTRX(I)=ENDLST1             /* IS THIS THE END OF THE PI   0110 00454000
*                                      TABLE?                        */ 00455000
*     THEN                                                         0110 00456000
CNVT08   LR    @15,I                                               0110 00457000
         MH    @15,@CH00069                                        0110 00458000
         ST    @15,@TF00001                                        0110 00459000
         ALR   @15,OPPTR                                           0110 00460000
         AL    @15,@CF00375                                        0110 00461000
         CLC   ENTRX(3,@15),ENDLST1                                0110 00462000
         BE    @RT00110                                            0110 00463000
*     GO TO CNVT09;                 /* YES IT IS SO GO TO THE NEXT 0111 00464000
*                                      CONVERSION                    */ 00465000
*   FLTREG=ADDR(ENTRX(I));          /* NO THEN PUT THE ADDRESS OF THE   00466000
*                                      NEXT ENTRY TO BE CONVERTED  0112 00467000
*                                      INTO A REG                    */ 00468000
         L     FLTREG,@TF00001                                     0112 00469000
         AL    FLTREG,@CF00375                                     0112 00470000
         LA    FLTREG,ENTRX(FLTREG,OPPTR)                          0112 00471000
*                                                                  0113 00472000
*/********************************************************************/ 00473000
*/*                                                                  */ 00474000
*/* THIS BAL CODE CONVERTS THE EBCDIC PI NUMBER TO BINARY THEN SETS  */ 00475000
*/* UP A MASK WITH THE BIT FOR THAT PI ON AND ORS IT IN TO THE PI    */ 00476000
*/* FILTER TABLE                                                     */ 00477000
*/*                                                                  */ 00478000
*/********************************************************************/ 00479000
*                                                                  0113 00480000
*   GEN;                                                           0113 00481000
*                                   /* CONVERT IT                    */ 00482000
T8      EQU   8                                                         00483000
OTE     EQU   128                                                       00484000
        PACK  PKENT(T8),0(T3,FLTREG)                                    00485000
        CVB   BYTEREG,PKENT                                             00486000
        SRDL  BYTEREG,3                DIVIDE BY 8                      00487000
        SRL   MOVNUM,29                GET REMAINDER                    00488000
        AR    BYTEREG,FLTRAD           ADD QUO TO GET PROPER BYTE       00489000
        LA    BYTEREG,2(BYTEREG)       BYPASS LENGTH FIELD       Y02014 00490000
        LA    MASKREG,OTE              GET BIT AT BEGINNING OF BYTE     00491000
        SRL   MASKREG,0(MOVNUM)        SHIFT BIT BY REMAINDER           00492000
        EX    MASKREG,BITON            OI   0(BYTEREG),0                00493000
*   I=I+1;                          /* INCREMENT THE INDEX TO POINT     00494000
*                                      TO THE NEXT ENTRY             */ 00495000
         AH    I,@CH00039                                          0114 00496000
*   GO TO CNVT08;                   /* AND GO SEE IF THIS IS THE END    00497000
*                                      OF THE TABLE                  */ 00498000
         B     CNVT08                                              0115 00499000
*CNVT09:                            /* BRANCH HERE WHEN THE PI TABLE    00500000
*                                      HAS BEEN CONVERTED            */ 00501000
*   PITAB=0;                        /* ZERO EBCDIC TABLE PTR   Y02014*/ 00502000
CNVT09   L     @03,INITPTR(,PCTPTR)                                0116 00503000
         SR    @15,@15                                             0116 00504000
         ST    @15,PITAB(,@03)                                     0116 00505000
*   ENTBLN=60;                      /* PUT THE LENGTH OF THE OLD PI     00506000
*                                      TABLE IN REG 0                */ 00507000
         LA    ENTBLN,60                                           0117 00508000
*   ENTBLAD=OPPTR;                  /* PUT THE ADDRESS OF THE OLD PI    00509000
*                                      TABLE INTO REG 1              */ 00510000
         LR    ENTBLAD,OPPTR                                       0118 00511000
*   GEN;                                                           0119 00512000
*                                   /* THEN FREE THE OLD PI TABLE    */ 00513000
        FREEMAIN R,LV=(0),A=(1)                                         00514000
*   GTFPIFT=FLTRAD;                 /* STORE THE NEW PI FILTER TABLE    00515000
*                                      ADDRESS INTO THE PCT    Y02014*/ 00516000
         ST    FLTRAD,GTFPIFT(,PCTPTR)                             0120 00517000
*                                                                  0121 00518000
*/********************************************************************/ 00519000
*/*                                                                  */ 00520000
*/* CHECK TO SEE IF THERE IS A SVC TABLE TO BE CONVERTED AND BUILD   */ 00521000
*/* A FILTER TABLE IF THERE IS                                       */ 00522000
*/*                                                                  */ 00523000
*/********************************************************************/ 00524000
*                                                                  0121 00525000
*CNVT10:                            /* BRANCH HERE AFTER THE PI TABLE   00526000
*                                      IS CONVERTED OR IF THERE IS NO   00527000
*                                      PI TABLE                      */ 00528000
*                                                                  0121 00529000
*   /*****************************************************************/ 00530000
*   /*                                                               */ 00531000
*   /* IS THERE AN SVC TABLE TO BE CONVERTED?                        */ 00532000
*   /*                                                               */ 00533000
*   /*****************************************************************/ 00534000
*                                                                  0121 00535000
*   IF GTFSVCP='0'B THEN            /* NO                            */ 00536000
CNVT10   L     @05,INITPTR(,PCTPTR)                                0121 00537000
         TM    GTFSVCP(@05),B'01000000'                            0121 00538000
         BZ    @RT00121                                            0121 00539000
*     GO TO CNVT13;                 /* NO THEN ITS ALL DONE,RETURN   */ 00540000
*   RFY                                                            0123 00541000
*     RETCODE RSTD;                 /* RESTRICT REGISTER 15    Y02014*/ 00542000
*   GEN;                                                           0124 00543000
*                                                                  0124 00544000
*                                   /* YES GET CORE FOR SVC TABLE    */ 00545000
        GETMAIN EC,LV=40,A=GETFREE,SP=245                               00546000
*   /*****************************************************************/ 00547000
*   /*                                                               */ 00548000
*   /* SAVE THE ADDRESS AS THE ADDRESS OF THE NEW FILTER TABLE       */ 00549000
*   /*                                                               */ 00550000
*   /*****************************************************************/ 00551000
*                                                                  0125 00552000
*   IF RETCODE^=0                   /* CHECK THE RETURN CODE FOR A 0125 00553000
*                                      NONZERO NUMBER                */ 00554000
*     THEN                                                         0125 00555000
         LTR   RETCODE,RETCODE                                     0125 00556000
         BNZ   @RT00125                                            0125 00557000
*     GO TO CNVT14;                 /* GETMAIN ERROR WRITE GO MSG    */ 00558000
*   RFY                                                            0127 00559000
*     RETCODE UNRSTD;               /* UNRESTRICT REG 15       Y02014*/ 00560000
*   FLTRAD=GETFREE;                 /* PUT THE ADDRESS OF THE GOTTEN    00561000
*                                      CORE IN A REG                 */ 00562000
         L     FLTRAD,GETFREE                                      0128 00563000
*   LNGTAB=40;                      /*                         Y02014*/ 00564000
         MVC   LNGTAB(2,FLTRAD),@CH00367                           0129 00565000
*   OPPTR=SVCTAB;                   /* GET THE ADDRESS OF THE OLD SCV   00566000
*                                      TABLE TO BE CONVERTED   Y02014*/ 00567000
         L     @15,INITPTR(,PCTPTR)                                0130 00568000
         L     OPPTR,SVCTAB(,@15)                                  0130 00569000
*   SVPIFLTB(1:38)=SVPIFLTB(1:38)&&SVPIFLTB(1:38);/* ZERO OUT FILTER    00570000
*                                      TABLE                   Y02014*/ 00571000
         XC    SVPIFLTB(38,FLTRAD),SVPIFLTB(FLTRAD)                0131 00572000
*   I=1;                            /* SET THIS INDEX TO THE       0132 00573000
*                                      BEGINNING OF THE TABLE TO BE     00574000
*                                      CONVERTED                     */ 00575000
         LA    I,1                                                 0132 00576000
*CNVT11:                                                           0133 00577000
*                                                                  0133 00578000
*   /*****************************************************************/ 00579000
*   /*                                                               */ 00580000
*   /* IS THIS THE END OF THE OLD SVC TABLE?                         */ 00581000
*   /*                                                               */ 00582000
*   /*****************************************************************/ 00583000
*                                                                  0133 00584000
*   IF ENTRX(I)=ENDLST1 THEN        /* YES                           */ 00585000
CNVT11   LR    @15,I                                               0133 00586000
         MH    @15,@CH00069                                        0133 00587000
         ST    @15,@TF00001                                        0133 00588000
         ALR   @15,OPPTR                                           0133 00589000
         AL    @15,@CF00375                                        0133 00590000
         CLC   ENTRX(3,@15),ENDLST1                                0133 00591000
         BE    @RT00133                                            0133 00592000
*     GO TO CNVT12;                 /* YES THEN GO FREE THE CORE FOR    00593000
*                                      THE OLD SVC TABLE             */ 00594000
*   FLTREG=ADDR(ENTRX(I));          /* NO GET THE ADDRESS OF THE NEXT   00595000
*                                      ENTRY TO BE CONVERTED         */ 00596000
         L     FLTREG,@TF00001                                     0135 00597000
         AL    FLTREG,@CF00375                                     0135 00598000
         LA    FLTREG,ENTRX(FLTREG,OPPTR)                          0135 00599000
*                                                                  0136 00600000
*/********************************************************************/ 00601000
*/*                                                                  */ 00602000
*/* THIS BAL CODE CONVERTS THE EBCDIC SVC NUMBER TO BINARY THEN SETS */ 00603000
*/* UP A MASK WITH THE BIT FOR THAT SVC ON AND ORS IT IN TO THE SVC  */ 00604000
*/* FILTER TABLE                                                     */ 00605000
*/*                                                                  */ 00606000
*/********************************************************************/ 00607000
*                                                                  0136 00608000
*   GEN;                                                           0136 00609000
*                                   /* CONVERT THE ENTRY             */ 00610000
        PACK  PKENT(T8),0(T3,FLTREG)                                    00611000
        CVB   BYTEREG,PKENT                                             00612000
        SRDL  BYTEREG,3                DIVIDE BY 8                      00613000
        SRL   MOVNUM,29                GET REMAINDER                    00614000
        AR    BYTEREG,FLTRAD           ADD QUO TO GET PROPER BYTE       00615000
        LA    BYTEREG,2(BYTEREG)       BYPASS LENGTH FIELD       Y02014 00616000
        LA    MASKREG,OTE              GET BIT AT BEGINNING OF BYTE     00617000
        SRL   MASKREG,0(MOVNUM)        SHIFT BIT BY REMAINDER           00618000
        EX    MASKREG,BITON            OI    0(BYTEREG),0               00619000
*   I=I+1;                          /* INCREMENT INDEX TO THE NEXT 0137 00620000
*                                      ENTRY IN THE TABLE            */ 00621000
         AH    I,@CH00039                                          0137 00622000
*   GO TO CNVT11;                   /* AND GO SEE IF THIS IS THE END    00623000
*                                      OF THE TABLE                  */ 00624000
         B     CNVT11                                              0138 00625000
*CNVT12:                            /* BRANCH HERE WHEN THE SVC TABLE   00626000
*                                      CONVERTION IS DONE            */ 00627000
*   SVCTAB=0;                       /* ZERO OUT PTR TO EBCDIC TABLE     00628000
*                                                              Y02014*/ 00629000
CNVT12   L     @03,INITPTR(,PCTPTR)                                0139 00630000
         SR    @15,@15                                             0139 00631000
         ST    @15,SVCTAB(,@03)                                    0139 00632000
*   ENTBLN=153;                     /* PUT THE LENGTH OF THE OLD SCV    00633000
*                                      TABLE IN REG 0                */ 00634000
         LA    ENTBLN,153                                          0140 00635000
*   ENTBLAD=OPPTR;                  /* GET THE ADDRESS OF THE OLD SCV   00636000
*                                      TABLE IN REG 1                */ 00637000
         LR    ENTBLAD,OPPTR                                       0141 00638000
*   GEN;                                                           0142 00639000
*                                   /* FREE THE OLD SVC TABLE        */ 00640000
        FREEMAIN R,LV=(0),A=(1)                                         00641000
*   GTFSVCFT=FLTRAD;                /* STORE THE ADDRESS OF THE NEW     00642000
*                                      FILTER TABLE INTO THE GTFPCT     00643000
*                                                              Y02014*/ 00644000
         ST    FLTRAD,GTFSVCFT(,PCTPTR)                            0143 00645000
*CNVT13:                            /* BRANCH HERE IF THERE IS NO SVC   00646000
*                                      TABLE TO BE CONVERTED         */ 00647000
*   SAREG15=0;                      /* SET A SUCCESSFUL RETURN CODE     00648000
*                                      IN REG 15                     */ 00649000
CNVT13   L     @05,BAKSAPTR(,SAPTR)                                0144 00650000
         SR    @03,@03                                             0144 00651000
         ST    @03,SAREG15(,@05)                                   0144 00652000
*   RETURN;                                                        0145 00653000
@EL00001 L     @13,4(,@13)                                         0145 00654000
@EF00001 DS    0H                                                  0145 00655000
@ER00001 LM    @14,@12,12(@13)                                     0145 00656000
         BR    @14                                                 0145 00657000
*CNVT14:                            /* BRANCH HERE IF A GETMAIN GIVES   00658000
*                                      A NONZERO RETCODE             */ 00659000
*   ICTMSGX=28;                     /* SET THE MSG INDEX TO MSG    0146 00660000
*                                      AHL130I                       */ 00661000
CNVT14   L     @05,INITPTR(,PCTPTR)                                0146 00662000
         MVI   ICTMSGX(@05),X'1C'                                  0146 00663000
*   ICTIOTYP=2;                     /* INDICATE A WTO IS TO BE DONE  */ 00664000
         MVI   ICTIOTYP(@05),X'02'                                 0147 00665000
*   CALL AHLTIO;                    /* GO DO THE IO                  */ 00666000
         L     @15,@CV00317                                        0148 00667000
         BALR  @14,@15                                             0148 00668000
*   SAREG15=8;                      /* SET AN UNSUCCESSFUL RETURN  0149 00669000
*                                      CODE IN REG 15                */ 00670000
         L     @05,BAKSAPTR(,SAPTR)                                0149 00671000
         MVC   SAREG15(4,@05),@CF00036                             0149 00672000
*   END                                                            0150 00673000
*                                                                  0150 00674000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00675000
*/*%INCLUDE SYSLIB  (GTFPCT  )                                       */ 00676000
*/*%INCLUDE SYSLIB  (INITDATA)                                       */ 00677000
*/*%INCLUDE SYSLIB  (SAVEAREA)                                       */ 00678000
*                                                                  0150 00679000
*       ;                                                          0150 00680000
         B     @EL00001                                            0150 00681000
@DATA    DS    0H                                                       00682000
@CH00039 DC    H'1'                                                     00683000
@CH00069 DC    H'3'                                                     00684000
@CH00367 DC    H'40'                                                    00685000
         DS    0F                                                       00686000
@SA00001 DS    18F                                                      00687000
@TF00001 DS    F                                                        00688000
         DS    0F                                                       00689000
@CF00375 DC    F'-3'                                                    00690000
@CF00036 DC    F'8'                                                     00691000
@CH00036 EQU   @CF00036+2                                               00692000
@CF00344 DC    F'22'                                                    00693000
@CV00317 DC    V(AHLTIO)                                                00694000
         DS    0D                                                       00695000
FLTRLEN  DS    AL4                                                      00696000
         ORG   FLTRLEN                                                  00697000
SUBPLNUM DS    AL1                                                      00698000
@NM00011 DS    AL3                                                      00699000
         ORG   FLTRLEN+4                                                00700000
GETFREE  DS    A                                                        00701000
ENDLST1  DC    X'FFFFFF'                                                00702000
         DS    CL5                                                      00703000
PKENT    DS    CL8                                                      00704000
         ORG   PKENT                                                    00705000
PKDA     DS    AL2                                                      00706000
         ORG   PKDA                                                     00707000
PKCHAN   DS    AL1                                                      00708000
         ORG   PKENT+8                                                  00709000
UNITADD  DS    CL4                                                      00710000
PATCH    DC    CL150'AHLTTAB AHLTTAB AHLTTAB AHLTTAB PATCH AREA'        00711000
AHLTTAB  CSECT                                                          00712000
*                                   /* TABLE FOR TR INSTRUCTION      */ 00713000
BITON    OI    0(BYTEREG),0                                             00714000
TRANTAB  DS    193XL1                                                   00715000
         DC    X'FAFBFCFDFEFF'                                          00716000
         DS    41XL1                                                    00717000
         DC    X'F0F1F2F3F4F5F6F7F8F9'                                  00718000
AHLTTAB  CSECT                                                          00719000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00720000
@01      EQU   01                                                       00721000
@02      EQU   02                                                       00722000
@03      EQU   03                                                       00723000
@04      EQU   04                                                       00724000
@05      EQU   05                                                       00725000
@06      EQU   06                                                       00726000
@07      EQU   07                                                       00727000
@08      EQU   08                                                       00728000
@09      EQU   09                                                       00729000
@10      EQU   10                                                       00730000
@11      EQU   11                                                       00731000
@12      EQU   12                                                       00732000
@13      EQU   13                                                       00733000
@14      EQU   14                                                       00734000
@15      EQU   15                                                       00735000
CHANLSAV EQU   @07                                                      00736000
PATHSW   EQU   @08                                                      00737000
I        EQU   @03                                                      00738000
K        EQU   @06                                                      00739000
OPPTR    EQU   @05                                                      00740000
PCTPTR   EQU   @02                                                      00741000
SAPTR    EQU   @13                                                      00742000
ENTBLN   EQU   @00                                                      00743000
ENTBLAD  EQU   @01                                                      00744000
FLTREG   EQU   @01                                                      00745000
FLTRAD   EQU   @04                                                      00746000
RETCODE  EQU   @15                                                      00747000
BYTEREG  EQU   @14                                                      00748000
MASKREG  EQU   @09                                                      00749000
MOVNUM   EQU   @15                                                      00750000
GTFPCT   EQU   0                                                        00751000
GTFSTAT  EQU   GTFPCT+8                                                 00752000
GTFOPTS  EQU   GTFPCT+12                                                00753000
GTFOPTS1 EQU   GTFOPTS                                                  00754000
GTFOPTS2 EQU   GTFOPTS+1                                                00755000
GTFOPTS3 EQU   GTFOPTS+2                                                00756000
GTFOPTS4 EQU   GTFOPTS+3                                                00757000
PCTCATF  EQU   GTFPCT+16                                                00758000
GTFSIOFT EQU   GTFPCT+20                                                00759000
GTFIOFT  EQU   GTFPCT+28                                                00760000
GTFSVCFT EQU   GTFPCT+36                                                00761000
GTFPIFT  EQU   GTFPCT+44                                                00762000
INITPTR  EQU   GTFPCT+60                                                00763000
NEXTBLOK EQU   GTFPCT+180                                               00764000
WRTRCOM  EQU   GTFPCT+204                                               00765000
TRMWRIT  EQU   GTFPCT+212                                               00766000
WRTRERR  EQU   GTFPCT+216                                               00767000
GTFSSRB  EQU   GTFPCT+220                                               00768000
QLOCKWRD EQU   GTFPCT+236                                               00769000
QLOCKECB EQU   GTFPCT+240                                               00770000
AUDITFLG EQU   GTFPCT+296                                               00771000
INITDATA EQU   0                                                        00772000
ICT      EQU   INITDATA+16                                              00773000
ICTMSGX  EQU   ICT                                                      00774000
ICTIOTYP EQU   ICT+1                                                    00775000
ICTFLAGS EQU   ICT+2                                                    00776000
GTFOPIND EQU   INITDATA+152                                             00777000
GTFOPT1  EQU   GTFOPIND                                                 00778000
GTFOPT2  EQU   GTFOPIND+1                                               00779000
GTFSVCP  EQU   GTFOPT2                                                  00780000
GTFSIOP  EQU   GTFOPT2                                                  00781000
GTFPIP   EQU   GTFOPT2                                                  00782000
GTFIOP   EQU   GTFOPT2                                                  00783000
GTFOPT3  EQU   GTFOPIND+2                                               00784000
GTFIOSIO EQU   GTFOPT3                                                  00785000
GTFOPT4  EQU   GTFOPIND+3                                               00786000
IOTAB    EQU   INITDATA+156                                             00787000
SIOTAB   EQU   INITDATA+160                                             00788000
SVCTAB   EQU   INITDATA+164                                             00789000
PITAB    EQU   INITDATA+168                                             00790000
TWT      EQU   INITDATA+176                                             00791000
BAKSAPTR EQU   4                                                        00792000
SAVEAREA EQU   0                                                        00793000
SAREG15  EQU   SAVEAREA+16                                              00794000
ENTRYTBL EQU   0                                                        00795000
ENTRX    EQU   ENTRYTBL                                                 00796000
CHANL    EQU   ENTRX                                                    00797000
LNGTAB   EQU   0                                                        00798000
IOSIOFT  EQU   2                                                        00799000
OFST     EQU   IOSIOFT                                                  00800000
OFFSET   EQU   OFST                                                     00801000
DVADFT   EQU   IOSIOFT+16                                               00802000
SVPIFLTB EQU   2                                                        00803000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00804000
UNIT     EQU   ENTRX+1                                                  00805000
SAREG12  EQU   SAVEAREA+68                                              00806000
SAREG11  EQU   SAVEAREA+64                                              00807000
SAREG10  EQU   SAVEAREA+60                                              00808000
SAREG9   EQU   SAVEAREA+56                                              00809000
SAREG8   EQU   SAVEAREA+52                                              00810000
SAREG7   EQU   SAVEAREA+48                                              00811000
SAREG6   EQU   SAVEAREA+44                                              00812000
SAREG5   EQU   SAVEAREA+40                                              00813000
SAREG4   EQU   SAVEAREA+36                                              00814000
SAREG3   EQU   SAVEAREA+32                                              00815000
SAREG2   EQU   SAVEAREA+28                                              00816000
SAREG1   EQU   SAVEAREA+24                                              00817000
SAREG0   EQU   SAVEAREA+20                                              00818000
SAREG14  EQU   SAVEAREA+12                                              00819000
SAFORPTR EQU   SAVEAREA+8                                               00820000
SABAKPTR EQU   SAVEAREA+4                                               00821000
SAVACANT EQU   SAVEAREA                                                 00822000
TWTBUF   EQU   TWT+40                                                   00823000
TWTWORK  EQU   TWT+8                                                    00824000
@NM00010 EQU   TWT+4                                                    00825000
@NM00009 EQU   TWT                                                      00826000
RANGPTR  EQU   INITDATA+172                                             00827000
GTFTIME  EQU   GTFOPT4                                                  00828000
GTFRES3  EQU   GTFOPT4                                                  00829000
GTFRES2  EQU   GTFOPT3                                                  00830000
GTFRR    EQU   GTFOPT3                                                  00831000
GTFSRM   EQU   GTFOPT3                                                  00832000
GTFRNIO  EQU   GTFOPT3                                                  00833000
GTFEXT   EQU   GTFOPT3                                                  00834000
GTFIO    EQU   GTFOPT2                                                  00835000
GTFPI    EQU   GTFOPT2                                                  00836000
GTFSIO   EQU   GTFOPT2                                                  00837000
GTFSVC   EQU   GTFOPT2                                                  00838000
GTFPCI   EQU   GTFOPT1                                                  00839000
GTFRES1  EQU   GTFOPT1                                                  00840000
GTFDSP   EQU   GTFOPT1                                                  00841000
GTFTRC   EQU   GTFOPT1                                                  00842000
GTFUSR   EQU   GTFOPT1                                                  00843000
GTFSYS   EQU   GTFOPT1                                                  00844000
GTFSYSP  EQU   GTFOPT1                                                  00845000
GTFSYSM  EQU   GTFOPT1                                                  00846000
MSGREPLY EQU   INITDATA+28                                              00847000
WTORECB  EQU   INITDATA+24                                              00848000
PARMDCB  EQU   INITDATA+20                                              00849000
ICTRESV  EQU   ICTFLAGS                                                 00850000
ICTSTOP  EQU   ICTFLAGS                                                 00851000
ICTTRCIN EQU   ICTFLAGS                                                 00852000
ICTRETRY EQU   ICTFLAGS                                                 00853000
ICTEOD   EQU   ICTFLAGS                                                 00854000
ICTIOERR EQU   ICTFLAGS                                                 00855000
ICTPLIB  EQU   ICTFLAGS                                                 00856000
EXECPTR  EQU   INITDATA+12                                              00857000
CIBPTR   EQU   INITDATA+8                                               00858000
INITID   EQU   INITDATA                                                 00859000
PCTWTOMD EQU   GTFPCT+312                                               00860000
PCTDMPMD EQU   GTFPCT+308                                               00861000
TRANSMAX EQU   GTFPCT+304                                               00862000
GTFASCB  EQU   GTFPCT+300                                               00863000
@NM00008 EQU   AUDITFLG+3                                               00864000
AFSLEBLD EQU   AUDITFLG+3                                               00865000
WSERFG06 EQU   AUDITFLG+3                                               00866000
WSERFG05 EQU   AUDITFLG+3                                               00867000
WSERFG04 EQU   AUDITFLG+3                                               00868000
WSERFG03 EQU   AUDITFLG+3                                               00869000
WSERFG02 EQU   AUDITFLG+2                                               00870000
WSERFLAG EQU   AUDITFLG+2                                               00871000
TERMFLAG EQU   AUDITFLG+2                                               00872000
AFXWRIT  EQU   AUDITFLG+2                                               00873000
AFQLWAIT EQU   AUDITFLG+2                                               00874000
AFSLEGET EQU   AUDITFLG+2                                               00875000
AFBUFGET EQU   AUDITFLG+2                                               00876000
AFFEOB   EQU   AUDITFLG+2                                               00877000
AFBLKFIX EQU   AUDITFLG+1                                               00878000
AFEQFIX  EQU   AUDITFLG+1                                               00879000
AFPGRLSE EQU   AUDITFLG+1                                               00880000
AFWRAP   EQU   AUDITFLG+1                                               00881000
AFBUFOFF EQU   AUDITFLG+1                                               00882000
AFLDFX   EQU   AUDITFLG+1                                               00883000
AFCLOSE  EQU   AUDITFLG+1                                               00884000
AFOPEN   EQU   AUDITFLG+1                                               00885000
AFGMBLOK EQU   AUDITFLG                                                 00886000
AFGMSRB  EQU   AUDITFLG                                                 00887000
AFWAIT   EQU   AUDITFLG                                                 00888000
AFTERM   EQU   AUDITFLG                                                 00889000
AFINIT   EQU   AUDITFLG                                                 00890000
AFWWRIT  EQU   AUDITFLG                                                 00891000
AFCWRIT  EQU   AUDITFLG                                                 00892000
AFIWRIT  EQU   AUDITFLG                                                 00893000
EQSHORT  EQU   GTFPCT+292                                               00894000
SLEMAX   EQU   GTFPCT+288                                               00895000
SLECNT   EQU   GTFPCT+284                                               00896000
RQPURGE  EQU   GTFPCT+280                                               00897000
RQTOTAL  EQU   GTFPCT+276                                               00898000
WRTDLST  EQU   GTFPCT+272                                               00899000
NUMOFBUF EQU   GTFPCT+268                                               00900000
SBUFDISA EQU   GTFPCT+264                                               00901000
SLESUSED EQU   GTFPCT+260                                               00902000
EQMIN    EQU   GTFPCT+256                                               00903000
EQLENGTH EQU   GTFPCT+252                                               00904000
WQMAX    EQU   GTFPCT+248                                               00905000
WQLENGTH EQU   GTFPCT+244                                               00906000
QLECBP   EQU   QLOCKECB                                                 00907000
@NM00007 EQU   QLOCKECB                                                 00908000
@NM00006 EQU   QLOCKWRD+3                                               00909000
SCHEDBUF EQU   QLOCKWRD+2                                               00910000
POSTWRIT EQU   QLOCKWRD+1                                               00911000
QLOCK    EQU   QLOCKWRD                                                 00912000
WRITERDD EQU   GTFPCT+228                                               00913000
GTFLOSTR EQU   GTFPCT+224                                               00914000
SRBAVAIL EQU   GTFSSRB                                                  00915000
WRTRERRP EQU   WRTRERR                                                  00916000
@NM00005 EQU   WRTRERR                                                  00917000
TRMWRITP EQU   TRMWRIT                                                  00918000
@NM00004 EQU   TRMWRIT                                                  00919000
GTFCMECB EQU   GTFPCT+208                                               00920000
WRTRCOMP EQU   WRTRCOM                                                  00921000
@NM00003 EQU   WRTRCOM                                                  00922000
TRANSCNT EQU   GTFPCT+200                                               00923000
AHLRDPLQ EQU   GTFPCT+196                                               00924000
SFEOBRTN EQU   GTFPCT+192                                               00925000
SBLOKRTN EQU   GTFPCT+188                                               00926000
CURRBLOK EQU   GTFPCT+184                                               00927000
GBCDS    EQU   NEXTBLOK                                                 00928000
WSMODEND EQU   GTFPCT+176                                               00929000
WSMODBEG EQU   GTFPCT+172                                               00930000
BCBPAGE  EQU   GTFPCT+156                                               00931000
SLEPAGE  EQU   GTFPCT+152                                               00932000
SAVECNT  EQU   GTFPCT+148                                               00933000
SLQHEAD  EQU   GTFPCT+144                                               00934000
HQLENGTH EQU   GTFPCT+140                                               00935000
QTAIL    EQU   GTFPCT+136                                               00936000
HQHEAD   EQU   GTFPCT+132                                               00937000
WQHEAD   EQU   GTFPCT+128                                               00938000
RQHEAD   EQU   GTFPCT+124                                               00939000
EQHEAD   EQU   GTFPCT+120                                               00940000
WPOSTSRB EQU   GTFPCT+116                                               00941000
WTSKTCBA EQU   GTFPCT+112                                               00942000
WRTRTCBA EQU   GTFPCT+108                                               00943000
TRMWTASK EQU   GTFPCT+104                                               00944000
WTSKATTH EQU   GTFPCT+100                                               00945000
WTSKINIT EQU   GTFPCT+96                                                00946000
WTASKECB EQU   GTFPCT+92                                                00947000
WMTABPTR EQU   GTFPCT+88                                                00948000
ATTCHECB EQU   GTFPCT+84                                                00949000
AHLECB   EQU   GTFPCT+80                                                00950000
STOPECBA EQU   GTFPCT+76                                                00951000
ECBADRLT EQU   GTFPCT+72                                                00952000
FIXLEN   EQU   GTFPCT+68                                                00953000
FIXPTR   EQU   GTFPCT+64                                                00954000
MCQEPTR  EQU   GTFPCT+56                                                00955000
GTFEIDL  EQU   GTFPCT+52                                                00956000
GTFPIBL  EQU   GTFPCT+48                                                00957000
GTFSVCBL EQU   GTFPCT+40                                                00958000
GTFIOBL  EQU   GTFPCT+32                                                00959000
GTFSIOBL EQU   GTFPCT+24                                                00960000
@NM00002 EQU   PCTCATF+1                                                00961000
PCTPIF   EQU   PCTCATF+1                                                00962000
PCTSIOF  EQU   PCTCATF+1                                                00963000
PCTIOF   EQU   PCTCATF+1                                                00964000
PCTSVCF  EQU   PCTCATF+1                                                00965000
PCTRR    EQU   PCTCATF+1                                                00966000
PCTSRM   EQU   PCTCATF+1                                                00967000
PCTRNIO  EQU   PCTCATF+1                                                00968000
PCTUSR   EQU   PCTCATF                                                  00969000
PCTPI    EQU   PCTCATF                                                  00970000
@NM00001 EQU   PCTCATF                                                  00971000
PCTDSP   EQU   PCTCATF                                                  00972000
PCTSIO   EQU   PCTCATF                                                  00973000
PCTIO    EQU   PCTCATF                                                  00974000
PCTEXT   EQU   PCTCATF                                                  00975000
PCTSVC   EQU   PCTCATF                                                  00976000
OPTTIME  EQU   GTFOPTS4                                                 00977000
OPTRES3  EQU   GTFOPTS4                                                 00978000
OPTIOSIO EQU   GTFOPTS3                                                 00979000
OPTRES2  EQU   GTFOPTS3                                                 00980000
OPTRR    EQU   GTFOPTS3                                                 00981000
OPTSRM   EQU   GTFOPTS3                                                 00982000
OPTRNIO  EQU   GTFOPTS3                                                 00983000
OPTEXT   EQU   GTFOPTS3                                                 00984000
OPTIOP   EQU   GTFOPTS2                                                 00985000
OPTIO    EQU   GTFOPTS2                                                 00986000
OPTPIP   EQU   GTFOPTS2                                                 00987000
OPTPI    EQU   GTFOPTS2                                                 00988000
OPTSIOP  EQU   GTFOPTS2                                                 00989000
OPTSIO   EQU   GTFOPTS2                                                 00990000
OPTSVCP  EQU   GTFOPTS2                                                 00991000
OPTSVC   EQU   GTFOPTS2                                                 00992000
OPTPCI   EQU   GTFOPTS1                                                 00993000
OPTRES1  EQU   GTFOPTS1                                                 00994000
OPTDSP   EQU   GTFOPTS1                                                 00995000
OPTTRC   EQU   GTFOPTS1                                                 00996000
OPTUSR   EQU   GTFOPTS1                                                 00997000
OPTSYS   EQU   GTFOPTS1                                                 00998000
OPTSYSP  EQU   GTFOPTS1                                                 00999000
OPTSYSM  EQU   GTFOPTS1                                                 01000000
GTFRESV  EQU   GTFSTAT                                                  01001000
GTFDEBUG EQU   GTFSTAT                                                  01002000
GTFMODE  EQU   GTFSTAT                                                  01003000
GTFPCTID EQU   GTFPCT                                                   01004000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01005000
@RT00036 EQU   CNVT07                                                   01006000
@RT00050 EQU   CNVT03                                                   01007000
@RT00054 EQU   CNVT14                                                   01008000
@RT00064 EQU   CNVT06                                                   01009000
@RT00068 EQU   CNVT05                                                   01010000
@RT00098 EQU   CNVT10                                                   01011000
@RT00102 EQU   CNVT14                                                   01012000
@RT00110 EQU   CNVT09                                                   01013000
@RT00121 EQU   CNVT13                                                   01014000
@RT00125 EQU   CNVT14                                                   01015000
@RT00133 EQU   CNVT12                                                   01016000
@ENDDATA EQU   *                                                        01017000
         END   AHLTTAB,(C'PL/S-II',0502,73241)                          01018000
