         TITLE 'IFFAFA01 -- PLINE / PPOINT MODULE'          D11         00100000
*                                                                       00200000
*        PLINE AND PPOINT ARE ENTERED FROM DIRECTOR PART 2 WITH THE     00300000
*        ADDRESS OF A WORK AREA IN REGISTER 1.  THE FIRST WORD OF THE   00400000
*        WORK AREA CONTAINS THE ADDRESS OF THE PARAMETER LIST BELOW.    00500000
*                                                                       00600000
*                             PLINE AND PPOINT                          00700000
*                                                                       00800000
*                             INPUT PARAMETER LIST                      00900000
*                                                                       01000000
*                             +0  A(GDSVAR)                             01100000
*                             +4  A(X-COORD)                            01200000
*                             +8  A(Y-COORD)                            01300000
*                             +12 A(CORVAL)                             01400000
*                             +16 A(KEY)                                01500000
*                             +20 A(GENCODE)                            01600000
*                             +24 A(COUNT)                              01700000
*                             +28 A(X-INDEX)                            01800000
*                             +32 A(Y-INDEX)                            01900000
*                             +36 A(X-INCR)                             02000000
*                             +40 A(Y-INCR)                             02100000
*                                                                       02200000
*        EXTERNAL ROUTINES CALLED:                                      02300000
*                                                                       02400000
*        SCALE-IFFAHA06                                                 02500000
*        SCISSOR-IFFAHA07                                               02600000
*        KEY TABLE MANAGEMENT- IFFAHA03                                 02700000
*        DATA GENERATOR-IFFAHA04                                        02800000
*        UPDATE-IFFAHA13 AND IFFAHA14                                   02900000
*        EXTERNAL MACROS USED:                                          03000000
*                                                                       03100000
*        LINK                                                           03200000
*                                                                       03300000
         EJECT                                                          03400000
*        PLINE AND PPOINT WILL SPEND A GOOD PORTION OF ITS TIME         03500000
*        BUILDING A PARAMETER LIST WHICH IS USED AS THE INPUT           03600000
*        PARAMETER LIST TO SCALE, SCISSOR, DATA GENERATOR, AND          03700000
*        UPDATE.                                                        03800000
*                                                                       03900000
*        WORD 0 IS THE KEY WHICH IS RETURNED TO THE USER.  THE FIRST    04000000
*        HALFWORD CONTAINS THE LENGTH OF THE ELEMENT AND THE SECOND     04100000
*        HALFWORD CONTAINS THE LOGICAL START ADDRESS OF THE ELEMENT.    04200000
*                                                                       04300000
*        WORD 1 CONTAINS BIT SWITCHES.                                  04400000
*        BIT 0: 0=SINGLE ENTRY/1=MULTIPLE ENTRY                         04500000
*        BIT 1: INITIALIZED TO ZERO.  SET BY DATA GEN TO SHOW IF        04600000
*        FOR A SINGLE ENTRY IF THE DATA CONTAINS A SET MODE ORDER.      04700000
*        BITS 2,3,4:                                                    04800000
*        000 IS VECTOR INPUT                                            04900000
*        010 IS POINT INPUT                                             05000000
*        BIT 5: 0=OMIT/1=INCLUDE                                        05100000
*        BITS 6&7:                                                      05200000
*        00 IS ABSOLUTE OUTPUT                                          05300000
*        01 IS INCREMENTAL OUTPUT                                       05400000
*        11 IS OPTIMIZED OUTPUT                                         05500000
*        BITS 8-15: ARE RESERVED AND INITIALIZED TO ZERO. DATA          05600000
*        GEN WILL PLACE THE BYTE OF DATA CONTAINING THE BEAM BIT        05700000
*        HERE IF IT IS A SINGLE ENTRY WHICH IS KEYED OR CORRELATED.     05800000
*        BITS 16&17:                                                    05900000
*        00 IS FIRST PASS                                               06000000
*        01 IS NOT FIRST PASS, NOT LAST PASS                            06100000
*        11 IS LAST PASS                                                06200000
*        FOR SINGLE ELEMENTS THIS IS SET TO FIRST PASS.                 06300000
*        BIT 18: 0=DATA NOT KEYED/1=DATA KEYED                          06400000
*        BIT 19: 0=DATA NOT CORRELATED/1=DATA CORRELATED                06500000
*        BIT 20: 0=BEAM OFF/1=BEAM ON                                   06600000
*        BIT 21: 0=REPOSITION/1=NO REPOSITIONING                        06700000
*        BITS 22&23: RESERVED AND SET TO ZERO                           06800000
*        BIT 24: 0=NOT PART OF A SUBROUTINE/1:PART OF A SUBROUTINE      06900000
*        BIT 25: 0=NOT PART OF A SEQUENCE/1=PART OF A SWQUEN            07000000
*        BIT 25: 0=NOT PART OF A SEQUENCE/1=PART OF A SEQUENCE          07100000
*        BITS26-31: RESERVED AND SET TO ZERO                            07200000
*                                                                       07300000
*                                                                       07400000
*                                                                       07500000
         EJECT                                                          07600000
*        WORD 2 CONTAINS THE CORVAL                                     07700000
*                                                                       07800000
*        WORD 3 CONTAINS THE ADDRESS OF THE KEY.                        07900000
*                                                                       08000000
*        WORD 4 CONTAINS THE ADDRESS OF THE GDSCB.                      08100000
*                                                                       08200000
*        WORDS5,6,7&8: ARE SET TO ZERO AND IF A POSITIONING             08300000
*        VECTOR IS REQUIRED BECAUSE OF PREVIOUS SCISSORING, SCISSOR     08400000
*        WILL FILL THE FIELDS IN WITH X ABSOLUTE, Y ABSOLUTE,           08500000
*        X INCREMENTAL, AND Y INCREMENTAL FOR THE POSITIONING           08600000
*        VECTOR.                                                        08700000
*                                                                       08800000
*        WORD 9 CONTAINS X ABSOLUTE.                                    08900000
*                                                                       09000000
*        WORD 10 CONTAINS Y ABSOLUTE.                                   09100000
*                                                                       09200000
*        WORD 11 CONTAINS X INCREMENTAL.                                09300000
*                                                                       09400000
*        WORD 12 CONTAINS Y INCREMENTAL.                                09500000
*                                                                       09600000
*        THE ABOVE WORDS WILL BE SET FROM THE INPUT PASSED AS EITHER    09700000
*        INCREMENTAL OR ABSOLUTE IN USERS UNITS.  SCALE WILL CONVERT    09800000
*        TO RASTER UNITS AND FILL IN THE FORM NOT PASSED.               09900000
*                                                                       10000000
*        WORD 13 CONTAINS THE TOTAL X INCREMENT THUS FAR.               10100000
*                                                                       10200000
*        WORD 14 CONTAINS THE TOTAL Y INCREMENT THUS FAR.               10300000
*                                                                       10400000
*        THE ABOVE WORDS ARE USED IF AN INCREMENTAL REPOSITIONING       10500000
*        VECTOR IS REQUIRED TO REPOSITION WHEN THE ELEMENT IS IN        10600000
*        OMIT STATUS.                                                   10700000
*                                                                       10800000
*        WORD 15 CONTAINS THE ELEMENT COUNT.  IT IS SET TO ZERO         10900000
*        ORIGINALLY AND INCREMENTED BY SCALE. IF THERE IS A             11000000
*        SCALING OR SCISSORING ERROR THE ELEMENT NUMBER IS PLACED       11100000
*        IN THE RETURN ARRAY.                                           11200000
*                                                                       11300000
*                                                                       11400000
         EJECT                                                          11500000
*                                                                       11600000
*        PLINE IS ENTERED AT THE TOP OF THE MODULE AND AFTER SAVING     11700000
*        REGISTERS A REGISTER IS SET TO ZERO AS A SWITCH TO SAY         11800000
*        THAT PLINE WAS CALLED.  PPOINT IS ENTERED AT IFFAFA16 AND      11900000
*        A REGISTER IS SET TO ONE TO SAY THAT PPOINT WAS CALLED.        12000000
*        ALL FUTURE COMMENTS WILL REFER TO THIS MODULE BY THE NAME      12100000
*        PLINE.                                                         12200000
*                                                                       12300000
IFFAFA01 CSECT                     PLINE                                12400000
*2055,270000-272000                                                000A 12500000
*D539500,D541400                                                 YM1963 12600000
*A459500-459980,A750600-750920                                LD YM5163 12700000
*A468600,A780600                                            D11 ZA04161 12800000
*A468300,A480300                                            D11 ZA04162 12900000
*C538000-540000,A541000-542050,C577000-580000,542100-542300 D11 ZA15418 13000000
*587000-590000,A813200-813400                               D11 ZA15418 13050000
*C472000,D474000-482000                                     E12 ZA17700 13070000
         ENTRY IFFAFA16                                                 13100000
         USING *,15                                                     13200000
         SAVE  (14,12)                                                  13300000
         LA    REGA,0              SET PLINE FLAG                       13400000
         B     PLT00100                                                 13500000
         DROP  15                                                       13600000
IFFAFA16 SAVE  (14,12)             ENTRY-PPOINT                         13700000
         LA    REGA,1              SET POINT FLAG                       13800000
*                                                                       13900000
*        THE BASE REGISTER IS SET UP, THE WORK AREA DSECT IS            14000000
*        INITIALIZED, AND THE RETURN ARRAY IS INITIALIZED.  THE GDSCB   14100000
*        IS INITIALIZED AND CHECKED FOR VALIDITY.  THE SAVE AREAS       14200000
*        ARE CHAINED.  THE INPUT PARAMETER LIST FOR DATA GEN IS         14300000
*        SET TO ZERO AND THE SKELETON SWITCHES ARE SET.  THE INITIAL    14400000
*        SETTINGS ARE SINGLE ELEMENT, VECTOR, INCLUDE STATUS,           14500000
*        OPTIMIZE OUTPUT, FIRST PASS, NOT KEYED, NOT CORRELATED,        14600000
*        BEAM ON AND A REPOSITIONING VECTOR REQUIRED.  THE GDSCB        14700000
*        ADDRESS AND RETURN ARRAY ADDRESS ARE PLACED IN THE PARAMETER   14800000
*        LIST.  GDSDATMD SWITCH IN THE GDSCB IS SAVED IN CASE IT        14900000
*        MUST BE CHANGED TEMPORARILY FOR SCALE IN THE CASE OF           15000000
*        BUFFER SUBROUTINE MEMBERS REQUIRING INCREMENTAL INPUT.         15100000
*                                                                       15200000
PLT00100 BALR  BASE,0                                                   15300000
         USING *,BASE                                                   15400000
         LR    WORK,PARM           WORK AREA                            15500000
         USING WORKAREA,WORK                                            15600000
         ST    REGA,WRKSWTCH       SET SWITCH FOR LINE OR POINT         15700000
         L     PARM,WRKPARM        LOAD PARM LIST ADDR                  15800000
         L     ERRCD,WRKRTNCD                                           15900000
         XC    0(20,ERRCD),0(ERRCD) ZERO RETURN ARRAY                   16000000
         L     GDSREG,GDS(PARM)    GDS VAR ADDR                         16100000
         L     GDSREG,0(GDSREG)    GDSCB ADDR                           16200000
         USING GDSCB,GDSREG                                             16300000
         MVC   WRKSWTCH+2(1),GDSDATMD  TEMP SETTING OF DZT MODE         16400000
         LA    REGA,WRKSAVE        CHAIN SAVE AREAS                     16500000
         ST    REGA,8(SAVE)                                             16600000
         ST    SAVE,4(REGA)                                             16700000
         LR    SAVE,REGA                                                16800000
         C     GDSREG,GDSGDSCB     IS GDSCB VALID                       16900000
         BNE   ERR1                NO                                   17000000
         XC    WRKSPVSR(12),WRKSPVSR ZERO SUPERVISOR PARAMETER LIST     17100000
         XC    WRKADDR(68),WRKADDR ZERO PARM LIST                       17200000
         MVC   WRKBITS,BITS        MOVE IN SKELETON                     17300000
         ST    GDSREG,WRKGDS       GDSCB ADDR                           17400000
         MVC   WRKRTN,WRKRTNCD     RTN CODE ADDR                        17500000
         TM    GDSFLAGS,SUBR       PART OF SUBR                         17600000
         BZ    PLT00150            YES,GO CHANGE DATA INPUT SWITCH      17700000
         OI    WRKBITS+3,MEMSUB    SET SUBR SW                          17800000
*                                                                       17900000
*        THE PRESENCE OF THE X AND Y PARAMETERS IS CHECKED AND THEY     18000000
*        ARE PICKED UP IN REGISTERS AND PLACED IN THE DATA ARRAY        18100000
*        DEPENDING ON WHETHER THEY ARE INCREMENTAL OR ABSOLUTE.         18200000
         EJECT                                                          18300000
PLT00150 L     REGE,ONE            SET COUNT TO ONE                     18400000
         TM    GDS(PARM),LAST      LAST PARM                            18500000
         BO    ERRPRM              YES-ERROR                            18600000
         L     REGA,X(PARM)        X ADDR                               18700000
         L     REGA,0(REGA)        X VALUE                              18800000
         TM    GDSDATMD,XABS       IS X ABS                             18900000
         BZ    PLT01600            NO                                   19000000
         ST    REGA,WRKXABS                                             19100000
PLT00200 TM    X(PARM),LAST        LAST PARM                            19200000
         BO    ERRPRM                                                   19300000
         L     REGB,Y(PARM)        Y ADDR                               19400000
         L     REGB,0(REGB)        Y VALUE                              19500000
         TM    GDSDATMD,YABS       IS Y ABS                             19600000
         BZ    PLT01700                                                 19700000
         ST    REGB,WRKYABS                                             19800000
*                                                                       19900000
*        IF THE CORVAL IS PASSED AND THE GDS IS NOT A LEVEL 2 GDS       20000000
*        IT IS PLACED IN THE PARAMETER LIST.  IF THE KEY IS PASSED      20100000
*        THE ADDRESS OF THE VARIABLE IS PLACED IN THE PARAMETER         20200000
*        LIST.  IF THE KEY IS A LEVEL 2 KEY THE SWITCH IN THE PARAMETER 20300000
*        LIST IS NOT SET BECAUSE IT WOULD CAUSE THE GENERATION          20400000
*        OF THE INCLUDE/OMIT STRUCTURE WHICH IS USELESS IN A LEVEL 2    20500000
*        ENVIRONMENT.                                                   20600000
PLT00300 TM    Y(PARM),LAST        ANY OPTIONAL PARMS.                  20700000
         BO    PLT02000            NO                                   20800000
         CLC   NULL+1(3,ERRCD),COR+1(PARM) IS CORVAL NULL               20900000
         BE    PLT00400            NO                                   21000000
         TM    GDSFLAGS,LEVEL2                                          21100000
         BO    PLT00400                                                 21200000
         L     REGD,COR(PARM)      LOAD ADDR OF CORVAL                  21300000
         MVC   WRKCORVL,0(REGD)    PLACE CORVAL IN PARM LIST            21400000
         OI    WRKBITS+2,CORRE     SET CORVAL SW                        21500000
PLT00400 TM    COR(PARM),LAST      ANY MORE                             21600000
         BO    PLT02000            NO                                   21700000
         CLC   NULL+1(3,ERRCD),KEY+1(PARM) IS KEY NULL                  21800000
         BE    PLT00500            YES                                  21900000
         MVC   WRKKEY,KEY(PARM)    PLACE ADDR OF KEY IN LIST            22000000
         TM    GDSFLAGS,LEVEL2     LEVEL 2 KEY                          22100000
         BO    PLT00500            YES                                  22200000
         OI    WRKBITS+2,KEYED     NO SET KEYED SO IN PRM LST           22300000
         EJECT                                                          22400000
*                                                                       22500000
*        THE GENCODE IS CHECKED.  IF ONE THE SWITCH IS ALREADY SET.     22600000
*        FOR 2 OR 3 A KEY OR CORVAL MUST BE PRESENT.  A GENCODE OF      22700000
*        2 FOR A LEVEL 2 GDS IS INVALID.  IF THE GENCODE IS THREE,      22800000
*        AND THIS IS A LEVEL 1 GDS THE KEY OR CORVAL IS SEARCHED        22900000
*        FOR IN THE KEY TABLE.                                          23000000
PLT00500 TM    KEY(PARM),LAST      MORE                                 23100000
         BO    PLT02000            NO                                   23200000
         CLC   NULL+1(3,ERRCD),GEN+1(PARM) IS GENCODE NULL              23300000
         BE    PLT00600            NO                                   23400000
         L     REGD,GEN(PARM)      ADDR OF CODE                         23500000
         L     REGD,0(REGD)        CODE                                 23600000
         C     REGD,ONE            INCLUDE                              23700000
         BE    PLT00600            YES ALREADY SET                      23800000
         CLC   WRKCORVL(8),ZERO                                         23900000
         BZ    ERR3                NO                                   24000000
         C     REGD,TWO            OMIT                                 24100000
         BNE   PLT00700            NO                                   24200000
         TM    GDSFLAGS,LEVEL2     LEVEL2                               24300000
         BO    ERR3                YES-ERROR                            24400000
         NI    WRKBITS,OMIT        TURN OFF INCLUDE SW                  24500000
PLT00600 TM    WRKBITS+2,CORRE     CORRELATED                           24600000
         BZ    PLT00950                                                 24700000
         CLC   WRKCORVL,ZERO       IS CORVAL ZERO                       24800000
         BE    ERR4                BAD CORVAL                           24900000
         B     PLT00950                                                 25000000
PLT00620 OI    GDSDATMD,XINTINC    SET X INPUT INTEGER,INC              25100000
         B     PLT02870            P                                    25200000
PLT00640 OI    GDSDATMD,YINTINC    Y INPUT INTEGER INC                  25300000
         B     PLT02880                                                 25400000
         EJECT                                                          25500000
*                                                                       25600000
*        THE LOGICAL START ADDRESS AND THE LENGTH OF THE KEY FOR        25700000
*        THE UPDATE ELEMENT ARE SAVED.                                  25800000
*                                                                       25900000
PLT00700 C     REGD,THREE                                               26000000
         BNE   ERR3                BAD GENCODE                          26100000
         TM    GDSFLAGS,SUBR       ARE WE CURRENTLY GEN A SUBR          26200000
         BO    ERRPRM              YES, THIS CALL INVALID               26300000
         TM    GDSFLAGS,LEVEL2     LEVEL2                               26400000
         BO    PLT01800            SET KEY                              26500000
         TM    WRKBITS+2,KEYED     KEY                                  26600000
         BZ    PLT01900            NO                                   26700000
         L     REGD,KEY(PARM)      LOAD KEY ADDR                        26800000
*//                                                                     26900000
*//      SEARCH ON KEY                                                  27000000
*//                                                                     27100000
         ST    REGD,WRKKADDR       ADDR OF KEY                          27200000
         ST    GDSREG,WRKGDS1      GDSCB                                27300000
         LA    REGD,TWO            CODE TO SEARCH ON KEY                27400000
         ST    REGD,WRKCODE                                             27500000
PLT00800 LA    PARM,WRKGDS1                                             27600000
         L     REGD,GDSGTMCB       GET POINTER TO GTMCB            000A 27700000
         L     REGD,4(REGD)        GET POINTER TO GSPCB            000A 27800000
         L     REGD,FE(REGD)       GET POINTER TO STATUS TABLE     000A 27900000
         L      REGFIFTN,ETE(REGD) GET ADRS OF KEY TABLE MGMT      000A 28000000
         BALR  RETURN,REGFIFTN     BRANCH TO KEY TABLE MGMT        000A 28100000
         LTR   REGFIFTN,REGFIFTN                                        28200000
         BNE   ERRPRM              INVALID KEY                          28300000
         MVC   WRKADDR,0(PARM)     MOVE IN KEY START                    28400000
         TM    4(PARM),INCL        WAS PREVIOUS INCLUDE                 28500000
         BO    PLT00820            YES                                  28600000
         NI    WRKBITS,OMIT        SET TO OMIT                          28700000
PLT00820 MVC   WRKBITS+3(1),7(PARM)    MOVE IN SEQ/SUBR MEMBER SW       28800000
         ST    PARM,WRKKEY         SAVE ADDR OF KEY IN KEY TABLE        28900000
PLT00900 OI    WRKSWTCH,UPDATE     SET UPDATE SWITCH                    29000000
         L     PARM,WRKPARM        RESET REG                            29100000
         EJECT                                                          29200000
*                                                                       29300000
*        THE COUNT IS CHECKED AND IF GREATER THAN ONE THE INDEX AND     29400000
*        INCREMENT PARAMETERS MUST BE CHECKED FOR. IF NONE ARE          29500000
*        PASSED, THE INDEX IS ASSUMED TO BE ONE.  IF BOTH INDEX AND     29600000
*        INCREMENT ARE PASSED, IT IS AN ERROR.  THE PRESENCE OF         29700000
*        ONE OR THE OTHER IS VERIFIED AND FLAGS ARE SET TO SHOW         29800000
*        WHICH ONE WAS PASSED AND THE INCREMENT OR INDEX IS SAVED.      29900000
PLT00950 TM    GEN(PARM),LAST      IS THIS LAST                         30000000
         BO    PLT02000            YES                                  30100000
         CLC   NULL+1(3,ERRCD),CT+1(PARM)  IS COUNT NULL                30200000
         L     REGE,ONE            SET CT=1                             30300000
         BE    PLT02000            YES                                  30400000
         L     REGE,CT(PARM)                                            30500000
         L     REGE,0(REGE)        PLACE COUNT IN REGE                  30600000
         C     REGE,ZERO           IS COUNT=0                           30700000
         BE    PLT02700            YES,RETURN                           30800000
         BL    ERR7                LOWER=ERROR                          30900000
         C     REGE,ONE            COUNT=1                              31000000
         BE    PLT02000            YES                                  31100000
         TM    CT(PARM),LAST       LAST                                 31200000
         BO    PLT01300            YES                                  31300000
         CLC   NULL+1(3,ERRCD),XINDEX+1(PARM) IS X INDEX NULL           31400000
         BE    PLT01000            YES                                  31500000
         L     REGD,XINDEX(PARM)                                        31600000
         L     REGD,0(REGD)                                             31700000
         ST    REGC,WRKTEMP        SAVE NULL VARIABLE                   31800000
         M     REGC,FOUR           MULTIPLY INDEX BY FOUR               31900000
         L     REGC,WRKTEMP        RELOAD REGISTER                      32000000
         ST    REGD,WRKXCHNG       PLACE INDEX IN AREA                  32100000
         OI    WRKSWTCH+1,XINDX                                         32200000
PLT01000 TM    XINDEX(PARM),LAST   IS THIS THE LAST PARAMETER ?         32300000
         BO    PLT01300                                                 32400000
         CLC   NULL+1(3,ERRCD),YINDEX+1(PARM) IS Y INDEX NULL           32500000
         BE    PLT01100            YES                                  32600000
         L     REGD,YINDEX(PARM)                                        32700000
         L     REGD,0(REGD)        PICK UP INDEX                        32800000
         ST    REGC,WRKTEMP        SAVE NULL VARIABLE                   32900000
         M     REGC,FOUR           MULTIPLY DISP BY FOUR                33000000
         L     REGC,WRKTEMP        LOAC NULL AGAIN                      33100000
         ST    REGD,WRKYCHNG       PLACE INDEX IN AREA                  33200000
         OI    WRKSWTCH+1,YINDX                                         33300000
         EJECT                                                          33400000
PLT01100 TM    YINDEX(PARM),LAST   IS Y INDEX LAST PARM                 33500000
         BO    PLT01300                                                 33600000
         CLC   NULL+1(3,ERRCD),XINCR+1(PARM) IS X INCR NULL             33700000
         BE    PLT01200            YES                                  33800000
         TM    WRKSWTCH+1,XINDX    XINDEX ALSO PASSED                   33900000
         BO    ERRPRM              YES-ERROR                            34000000
         L     REGD,XINCR(PARM)                                         34100000
         MVC   WRKXCHNG,0(REGD)    SAVE INCR                            34200000
         OI    WRKSWTCH+1,XINC     SET SW                               34300000
PLT01200 TM    XINCR(PARM),LAST    LAST                                 34400000
         BO    PLT01300            YES                                  34500000
         CLC   NULL+1(3,ERRCD),YINCR+1(PARM) IS Y INCR NULL             34600000
         BE    PLT01300                                                 34700000
         TM    WRKSWTCH+1,YINDX    YINDEX PASSED ALSO                   34800000
         BO    ERRPRM              YES,ERROR                            34900000
         L     REGD,YINCR(PARM)                                         35000000
         MVC   WRKYCHNG,0(REGD)    SAVE INCR                            35100000
         OI    WRKSWTCH+1,YINC                                          35200000
PLT01300 TM    WRKSWTCH+1,XINDX+XINC    IS AN X PASSED                  35300000
         BZ    PLT01500                                                 35400000
PLT01400 TM    WRKSWTCH+1,YINDX+YINC    IS A Y PASSED                   35500000
         BM    PLT02000                                                 35600000
         MVC   WRKYCHNG,FOUR            NO                              35700000
         OI    WRKSWTCH+1,YINDX         SET INDEX=4                     35800000
         B     PLT02000                                                 35900000
PLT01500 MVC   WRKXCHNG,FOUR                                            36000000
         OI    WRKSWTCH+1,XINDX         SET INDEX=4                     36100000
         B     PLT01400                                                 36200000
PLT01600 ST    REGA,WRKXINCR       STORE X INCR                         36300000
         B     PLT00200                                                 36400000
PLT01700 ST    REGB,WRKYINCR       STORE Y INCR                         36500000
         B     PLT00300                                                 36600000
PLT01800 L     REGD,KEY(PARM)      LOAD KEY ADDR                        36700000
         MVC   WRKADDR,0(REGD)     PLACE KEY IN PARM LIST               36800000
         B     PLT00900                                                 36900000
PLT01900 CLC   WRKCORVL,ZERO                                            37000000
         BE    ERRPRM              BAD PARM COMBINATION                 37100000
*//                                                                     37200000
*//      SEARCH ON CORVAL KEY RETURNED IN REG1                          37300000
*//                                                                     37400000
         LA    REGD,WRKCORVL       ADDR OF CORVAL                       37500000
         ST    REGD,WRKKADDR       IN PARM LIST                         37600000
         LA    REGD,FIVE           CODE SEARCH ON CORVAL                37700000
         ST    REGD,WRKCODE        IN CODE                              37800000
         ST    GDSREG,WRKGDS1      GDSCB ADDR                           37900000
         B     PLT00800                                                 38000000
         EJECT                                                          38100000
**                                                                      38200000
**       ALL THE PARAMETERS ARE CHECKED WE WILL NOW GET SOME            38300000
**       DATA GENERATED.                                                38400000
**                                                                      38500000
*                                                                       38600000
*        THE SWITCH SET ON ENTRY IN THE REGISTER WHICH HAS SINCE        38700000
*        BEEN PLACED IN STORAGE IS CHECKED FOR VECTOR OR POINT          38800000
*        AND THE SWITCH IS SET IN THE PARAMETER LIST. IF THE            38900000
*        CALL IS A MULTIPLE CALL THE SWITCH IS SET. IF IT IS            39000000
*        A SEQUENCE MEMBER OR A SUBROUTINE MEMBER THE SWITCH IS         39100000
*        SET. THE OUTPUT MODE IS SET TO INCREMENTAL FOR PART            39200000
*        OF A SUBROUTINE, OTHERWISE IT IS SET ACCORDING TO THE          39300000
*        GDSCURMD.  THE GDSXLAST, GDSYLAST, GDSXCURR, AND GDSYCURR      39400000
*        FIELDS ARE SAVED IN CASE THE CALL FAILS AND RESET IS           39500000
*        NECESSARY. IF NOT UPDATE THE LOGICAL ADDRESS FROM THE          39600000
*        OACB IS PLACED IN THE KEY. IF UPDATE THE UPDATE GDOAS          39700000
*        WILL BE OBTAINED NOW.                                          39800000
PLT02000 TM    WRKSWTCH+3,POINT    POINT                                39900000
         BZ    PLT02100            NO                                   40000000
         OI    WRKBITS,PT          SET SW FOR POINT                     40100000
PLT02100 C     REGE,ONE            MULTIPLE                             40200000
         BE    PLT02150                                                 40300000
         OI    WRKBITS,MULT        SET SW MULTIPLE ENTRY                40400000
PLT02150 TM    WRKSWTCH,UPDATE     IS THIS AN UPDATE                    40500000
         BO    PLT02200            YES BYPASS CHECK                     40600000
         TM    GDSFLAGS,SEQ        PART OF A SEQUENCE                   40700000
         BZ    PLT02200            NO                                   40800000
         OI    WRKBITS+3,MEMSEQ    YES SET SW IN KEY                    40900000
PLT02200 TM    WRKBITS+3,MEMSUB    PART OF A SUBROUTINE                 41000000
         BO    PLT02850            YES, INCREMENTAL                     41100000
         TM    GDSCURMD,OPT        OPTIMIZE                             41200000
         BO    PLT02300            YES, ALREADY SET                     41300000
         TM    GDSCURMD,INC        INCR                                 41400000
         BO    PLT02900            YES                                  41500000
         XI    WRKBITS,ABSSW       SET TO ABSOLUTE                      41600000
PLT02300 MVC   WRKXCURR(4),GDSXCURR SAVE X-Y CURR                       41700000
         MVC   WRKXLAST(8),GDSXLAST SAVE X-Y LAST                       41800000
         TM    WRKSWTCH,UPDATE     UPDATE                               41900000
         BO    PLT03200            YES                                  42000000
         L     REGD,GDSAOACB       OACB                                 42100000
         L     REGD,CURRLOG(REGD)  LOGICAL START                        42200000
         STH   REGD,WRKADDR+2      IN ELEMENT                           42300000
*                                                                       42400000
*        IF THE ELEMENT IS A MULTIPLE ONE THE FUTURE LOOP IS SET        42500000
*        UP. THE ADDRESS OF THE GDSCB IN THE PARAMETER LIST             42600000
*        WE HAVE BEEN BUILDING IS PLACED IN REGISTER 1 AND THE          42700000
*        DATA IS SCALED. IF THE CALL IS TO A BUFFER SUBROUTINE          42800000
*        MEMBER NO SCISSORING WILL TAKE PLACE. IF THE OPTION            42900000
*        IS NO SCISSORING THE GDSXLAST, GDSYLAST, GDSXCURR,             43000000
*        AND GDSYCURR FIELDS IN THE GDSCB ARE UPDATED. THE              43100000
*        SCISSORING FLAGS ARE ALSO SET SUCH THAT IT APPEARS AS          43200000
*        IF THE LAST CALL WAS ON THE SCREEN AND ON THE GRID.            43300000
PLT02350 OI    WRKSWTCH,FIRST      SET FIRST TIME SWITCH SO THAT THE    43400000
*        FIRST CALL TO DATA GENERATOR IS NOT BYPASSED BECAUSE OF NO     43500000
*        MOVEMENT FROM THE LAST BEAM POSITION                           43600000
         C     REGE,ONE            MORE THAN ONE                        43700000
         BH    PLT03400            YES SET UP FUTURE LOOP               43800000
         EJECT                                                          43900000
*                                                                       44000000
*        COUNT IN REGE   X IN REGA  Y IN REGB                           44100000
*                                                                       44200000
PLT02400 LA    PARM,WRKGDS                                              44300000
*/*                                                                     44400000
*/*      CALL  SCALE                                                    44500000
*/*                                                                     44600000
         L     REGFIFTN,STAT(ERRCD) ADDR OF STATUS TABLE                44700000
         L     REGFIFTN,SCALE(REGFIFTN) ADDRESS OF SCALE                44800000
         BALR  RETURN,REGFIFTN     BRANCH TO SCALE                      44900000
         LTR   REGFIFTN,REGFIFTN   SCALE OK                             45000000
         BNE   ERR10               RESET AND RETURN                     45100000
         TM    GDSFLAGS,SUBR       SUBR                                 45200000
         BO    PLT02450            NO SCISS OR CHANGE OF BEAM IN GDSCV  45300000
         TM    GDSSCISS,NOSCISS    NO SCISS WANTED                      45400000
         BO    PLT03000            NONE                                 45500000
         LA    PARM,WRKGDS                                              45600000
*//      CALL SCISSOR                                                   45700000
*//                                                                     45800000
         L     REGFIFTN,STAT(ERRCD)                                     45900000
         L     REGFIFTN,SCISS(REGFIFTN) ADDRESS OF SCISSOR              46000000
         BALR  RETURN,REGFIFTN                                          46100000
         LTR   REGFIFTN,REGFIFTN   ERROR                                46200000
         BNE   PLT03100            YES                                  46300000
         TM    WRKSWTCH,FIRST      FIRST ONE                            46400000
         BO    PLT02401            YES, GENERATE ANYWAY     L5 @ZA04162 46500000
         CLC   WRKXINCR(8),ZERO    ANY MOVEMENT?                        46600000
         BE    PLT02500            NO-DON'T GENERATE                    46700000
PLT02401 EQU   *                                            L5 @ZA04162 46800000
         EJECT                                                          46900000
         L     REGFIFTN,GDSGTMCB        GET POINTER TO GTMCB  LD YM5163 47000000
         TM    WRKSWTCH,UPDATE          UPDATE CALL?        L5 @ZA04162 47100000
         BNO   PLT02450                 NO,SKIP DGEN FLGS  E12 @ZA17700 47200000
         OI    GTMUPDT(REGFIFTN),UPDATE  SET DGEN FLG       L5 @ZA04162 47300000
*    THE NEXT SEVEN LINES HAVE BEEN DELETED BY APAR ------>E12 @ZA17700 47350000
*PLT02402 EQU   *                                           L5 @ZA04162 47400000
*        L     REGFIFTN,GSPPTR(REGFIFTN) GET PTR TO GSPCB     LD YM5163 47440000
*        TM    ARRAY(REGFIFTN),SCISORED WAS SCISSORING USED?  LD YM5163 47560000
*        BZ    PLT02450                 BRANCH IF NO          LD YM5163 47700000
*        TM    WRKSWTCH+3,PLTPTNT       WAS POINT SCISSORED?  LD YM5163 47750000
*        BZ    PLT02450                 BRANCH IF NO          LD YM5163 47800000
*        NI    WRKBITS+2,BLANK          SET FLAGS SO DATA...  LD YM5163 47850000
*                                       GEN WILL BLANK....    LD YM5163 48100000
*                                       THE BEAM.             LD YM5163 48200000
PLT02450 LA    PARM,WRKADDR                                             48300000
*//                                                                     48400000
*//      CALL DATA GEN                                                  48500000
*//                                                                     48600000
         L     REGFIFTN,STAT(ERRCD)                                     48700000
         L     REGFIFTN,DGEN(REGFIFTN)  ADDRESS OF DATA GEN             48800000
         BALR  RETURN,REGFIFTN                                          48900000
         LTR   REGFIFTN,REGFIFTN   ERROR                                49000000
         BNE   ERR10               RESET AND RETURN                     49100000
         L     REGFIFTN,GDSGTMCB   GET GTMCB ADDRESS        L5 @ZA04162 49200000
         NI    GTMUPDT(REGFIFTN),UPDTOFF  TURN OFF DGEN FLG L5 @ZA04161 49300000
         NI    WRKSWTCH,OFF        TURN OFF FIRST SWITCH                49400000
*                                                                       49500000
*        THE VECTOR OR POINT IS GENERATED BY DATA GEN AND               49600000
*        STORED IN THE GDOA BY DATA STORE.  IF THERE ARE NO             49700000
*        MORE TO DO THE UPDATE GDOAS ARE WRITTEN OUT IF UPDATE,         49800000
*        OR THE KEY IS COMPLETED AND PLACED IN THE KEY TABLE IF         49900000
*        NECESSARY AND IN THE USER VARIABLE IF PASSED.  THE             50000000
*        SWITCHES IN THE GDSDATMD FIELD ARE RESET AND CONTROL           50100000
*        IS RETURNED TO THE CALLING PROGRAM.                            50200000
*                                                                       50300000
PLT02500 BCT   REGE,PLT03700       MORE TO DO                           50400000
         TM    WRKSWTCH,FIRST      HAS ANY DATA BEEN GEN                50500000
         BO    ERR8                NO                                   50600000
         TM    WRKSWTCH,LSTONE     WAS LAST ONE GENERATED               50700000
         BZ    PLT02550            YES                                  50800000
         OI    WRKBITS+2,REPONLY   SET FLAG TO GEN REPOS VECT           50900000
         XC    WRKDATA1(32),WRKDATA1                                    51000000
         MVC   WRKXABS+2(2),GDSXCURR    PLACE CURRENT BEAM POSITION     51100000
         MVC   WRKYABS+2(2),GDSYCURR FROM GDS INTO DATA ARRAY           51200000
         LA    REGE,1              RESET COUNT TO FALL THROUGH          51300000
         B     PLT02450            CALL DATA GEN                        51400000
PLT02550 TM    WRKSWTCH,UPDATE     UPDATE                               51500000
         BO    PLT03300            YES                                  51600000
         L     REGE,GDSAOACB       NO                                   51700000
         L     REGE,CURRLOG(REGE)  GET CURR LOG ADDR                    51800000
         SH    REGE,WRKADDR+2      COMPUTE ELEM LEN                     51900000
         LTR   REGE,REGE           ANY DATA GENERATED                   52000000
         BE    ERR8                NO ERROR                             52100000
         STH   REGE,WRKADDR        PLACE LENGTH IN KEY                  52200000
         L     REGE,WRKKEY                                              52300000
         LTR   REGE,REGE                                                52400000
         BE    PLT02600                                                 52500000
         MVC   0(4,REGE),WRKADDR   PLACE KEY IN USER VARIABLE           52600000
PLT02600 TM    WRKBITS+2,KEYED+CORRE KEYED OR CORRELATED                52700000
         BZ    PLT02700            NO                                   52800000
*//                                                                     52900000
*//      CALL KEY TABLE TO ADD KEY                                      53000000
*//                                                                     53100000
         ST    GDSREG,WRKGDS1      GDSCB FOR KEY TABLE MGT              53200000
         LA    REGA,ONE            CODE                                 53300000
         ST    REGA,WRKCODE        IN PARM LIST                         53400000
         LA    REGA,WRKADDR        ADDR OF KEY                          53500000
         ST    REGA,WRKKADDR       IN PARM LIST                         53600000
         LA    PARM,WRKGDS1                                             53700000
         L     REGFIFTN,GDSGTMCB   GET POINTER TO GTMCB     D11 OZ15418 53800000
         L     REGFIFTN,4(REGFIFTN) GET POINTER TO GSPCB    D11 OZ15418 53900000
         L     REGFIFTN,FE(REGFIFTN) POINT TO STATUS TABLE  D11 ZA15418 54000000
         L     REGFIFTN,ETE(REGFIFTN) ADDR OF KEYTBL MGR    D11 ZA15418 54100000
         LTR   REGFIFTN,REGFIFTN   LOADED YET ?             D11 ZA15418 54130000
         BZ    PLTLINK1            NO,MUST USE SYSTEM LINK  D11 ZA15418 54160000
         BALR  RETURN,REGFIFTN     BRANCH TO KEY TABLE MGMT D11 ZA15418 54200000
         B     PLTRTN1             RETURN FROM BALR         D11 ZA15418 54206000
PLTLINK1 LA    REGA,16             CVT                      D11 ZA15418 54212000
         L     REGA,CVTLINK(REGA)  LINKLIB DCB                          54218000
         LINK  EP=IFFAHA03,MF=(E,(1)),SF=(E,WRKSPVSR)                   54224000
PLTRTN1  LTR   REGFIFTN,REGFIFTN   SUCCESSFUL               D11 ZA15418 54230000
         BNE   ERR9                NO                                   54260000
PLT02700 L     SAVE,4(SAVE)                                             54300000
         MVC   GDSDATMD,WRKSWTCH+2 RESET DATA MODE                      54400000
PLT02800 RETURN (14,12),T          RETURN                               54500000
         EJECT                                                          54600000
*                                                                       54700000
*        IF THIS CALL IS TO GENERATE DATA THAT IS TO BE PART OF A       54800000
*        BUFFER SUBROUTINE, THE GDSDATMD SWITCH IS CHANGED TO           54900000
*        REFLECT EITHER REAL OR INTEGER INCREMENTAL DATA AS INPUT.      55000000
PLT02850 XC    GDSDATMD,GDSDATMD   ZERO DATA MODE SW                    55100000
         TM    WRKSWTCH+2,REALX    REAL                                 55200000
         BZ    PLT00620            NO                                   55300000
         OI    GDSDATMD,XRELINC    SET X INPUT REAL,INC                 55400000
PLT02870 TM    WRKSWTCH+2,REALY    REAL                                 55500000
         BZ    PLT00640            NO                                   55600000
         OI    GDSDATMD,YRELINC    SET Y INPUT REAL,INC                 55700000
PLT02880 XC    WRKXABS(16),WRKXABS                                      55800000
         ST    REGA,WRKXINCR      SET X INCREMENTAL                     55900000
         ST    REGB,WRKYINCR      SET Y INCREMENTAL                     56000000
PLT02900 XI    WRKBITS,INCSW                                            56100000
         B     PLT02300                                                 56200000
PLT03000 L     PARM,WRKXABS        LOAD X                               56300000
         ST    PARM,GDSXLAST       STORE IN LAST LOC                    56400000
         SH    PARM,GDSXCURR       COMPUTE NEW INCR                     56500000
         ST    PARM,WRKXINCR       STORE                                56600000
         MVC   GDSXCURR,WRKXABS+2      XCURR                            56700000
         L     PARM,WRKYABS        LOAD Y                               56800000
         ST    PARM,GDSYLAST       STORE IN LAST LOC                    56900000
         SH    PARM,GDSYCURR       COMPUTE NEW INCR                     57000000
         ST    PARM,WRKYINCR       STORE                                57100000
         MVC   GDSYCURR,WRKYABS+2      YCURR IN GDSCB                   57200000
         NI    GDSSCISS,LASTON                                          57300000
         B     PLT02450                                                 57400000
PLT03100 C     REGFIFTN,FOUR            STOP GENERATION                 57500000
         BE    ERR10               YES, RESET AND RETURN                57600000
         B     PLT02500                                                 57700000
*//      GET GDOA'S FOR UPDATE                                          57800000
PLT03200 LA    PARM,WRKADDR        PARMLIST FOR IFFAHA13    D11 ZA15418 57900000
         L     REGFIFTN,STAT(ERRCD) POINT TO STATUS TABLE   D11 ZA15418 58000000
         L     REGFIFTN,UPDH13(REGFIFTN) AND TO IFFAHA13    D11 ZA15418 58100000
         BALR  RETURN,REGFIFTN     GOTO IFFAHA13            D11 ZA15418 58200000
         LTR   REGFIFTN,REGFIFTN   SUCCESS                              58300000
         BNE   PLT02700            NO                                   58400000
         B     PLT02350                                                 58500000
         EJECT                                                          58600000
*/                                                                      58700000
*//      WRITE OUT UPDATE                                               58800000
PLT03300 LA    PARM,WRKADDR        PARMLIST ADDRESS FOR H14 D11 ZA15418 58900000
         L     REGFIFTN,STAT(ERRCD) POINT TO STATUS TABLE   D11 ZA15418 59000000
         L     REGFIFTN,UPDH14(REGFIFTN) AND TO IFFAHA14    D11 ZA15418 59100000
         BALR  RETURN,REGFIFTN     GOTO IFFAHA14            D11 ZA15418 59200000
         TM    GDSFLAGS,LEVEL2                                          59300000
         BO    PLT02700                                                 59400000
         L     REGD,WRKKEY                                              59500000
         MVC   0(8,REGD),WRKADDR   REPLACE KEY                          59600000
         TM    WRKBITS+2,CORRE     IS IS IT CORRELATED                  59700000
         BZ    PLT02700            NO EXIT                              59800000
         L     REGD,WRKKEY         ADDR OF KEY IN KEY TABLE             59900000
         MVC   8(4,REGD),WRKCORVL  REPLACE CORVAL                       60000000
         B     PLT02700                                                 60100000
PLT03400 L     PARM,WRKPARM        RESET REG                            60200000
         TM    WRKSWTCH+1,XINDX    X INDEX                              60300000
         BO    PLT03600            YES                                  60400000
PLT03500 TM    WRKSWTCH+1,YINDX    Y INDEX                              60500000
         BZ    PLT02400            NO                                   60600000
         L     REGB,Y(PARM)        REP Y VAL WITH Y ADDR                60700000
         B     PLT02400                                                 60800000
         EJECT                                                          60900000
PLT03600 L     REGA,X(PARM)        REP X VAL WITH X ADDR                61000000
         B     PLT03500                                                 61100000
*                                                                       61200000
*        IN ORDER TO GENERATE THE NEXT DATA THE DATA FIELDS IN          61300000
*        THE PARAMETER LIST ARE ZEROED.  THE NOT FIRST NOT              61400000
*        LAST SWITCH IS SET. IF THIS IS THE LAST TIME THEN THE          61500000
*        LAST SWITCH IS SET. THE ARRAY IS INDEXED THROUGH OR            61600000
*        THE INCREMENT IS ADDED TO THE PREVIOUS DATA TO FORM            61700000
*        THE NEW DATA. THEN SCALE IS CALLED, SCISSOR, ETC.              61800000
*                                                                       61900000
PLT03700 XC    WRKDATA1(32),WRKDATA1 ZERO DATA                          62000000
         TM    WRKSWTCH,FIRST      HAS ANY DATA BEEN GENERATED YET      62100000
         BO    PLT03730            NO SO DONT CHANGE THE FIRST SW IN PL 62200000
         OI    WRKBITS+2,NFNL      SET NOT FIRST LAST SWITCH            62300000
PLT03730 C     REGE,ONE            IS THIS THE LAST ONE                 62400000
         BE    PLT04900            LAST TIME                            62500000
PLT03750 TM    WRKSWTCH+1,XINDX    INDEX X                              62600000
         BZ    PLT04100            NO                                   62700000
         A     REGA,WRKXCHNG                                            62800000
         TM    GDSDATMD,ABSOLX     X ABS                                62900000
         BZ    PLT03900                                                 63000000
         MVC   WRKXABS,0(REGA)     MOVE IN X ABS                        63100000
PLT03800 TM    WRKSWTCH+1,YINDX    Y INDEX                              63200000
         BZ    PLT04300            NO                                   63300000
         A     REGB,WRKYCHNG                                            63400000
         TM    GDSDATMD,ABSOLY     Y ABS                                63500000
         BZ    PLT04000            NO                                   63600000
         MVC   WRKYABS,0(REGB)     MOVE IN Y ABS                        63700000
         B     PLT02400                                                 63800000
PLT03900 MVC   WRKXINCR,0(REGA)    MOVE IN X INCR                       63900000
         B     PLT03800                                                 64000000
PLT04000 MVC   WRKYINCR,0(REGB)    MOVE IN Y INCR                       64100000
         B     PLT02400                                                 64200000
         EJECT                                                          64300000
PLT04100 TM    GDSDATMD,REALX      X IN FLOAT                           64400000
         BM    PLT04500            YES                                  64500000
         A     REGA,WRKXCHNG       ADD X INCRE                          64600000
PLT04200 TM    GDSDATMD,ABSOLX     ABSOLUTE                             64700000
         BZ    PLT04600            NO                                   64800000
         ST    REGA,WRKXABS        STORE IN ABS LOC                     64900000
         B     PLT03800            CHECK Y                              65000000
PLT04300 TM    GDSDATMD,REALY      Y REAL                               65100000
         BM    PLT04700            YES                                  65200000
         A     REGB,WRKYCHNG       ADD Y INCR                           65300000
PLT04400 TM    GDSDATMD,ABSOLY     Y ABS                                65400000
         BZ    PLT04800            NO                                   65500000
         ST    REGB,WRKYABS        STORE IN ABS                         65600000
         B     PLT02400                                                 65700000
PLT04500 ST    REGA,WRKTEMP        STORE # IN CORE                      65800000
         LE    FLT2,WRKTEMP                                             65900000
         AE    FLT2,WRKXCHNG       ADD INCR IN FLOAT INSTR              66000000
         STE   FLT2,WRKTEMP                                             66100000
         L     REGA,WRKTEMP        REPLACE IN REG                       66200000
         B     PLT04200                                                 66300000
PLT04600 MVC   WRKXINCR,WRKXCHNG   STORE X IN INCR                      66400000
         B     PLT03800            CHECK Y                              66500000
PLT04700 ST    REGB,WRKTEMP        STORE IN CORE                        66600000
         LE    FLT2,WRKTEMP                                             66700000
         AE    FLT2,WRKYCHNG       ADD Y INCR IN                        66800000
         STE   FLT2,WRKTEMP        FLOAT INSTR                          66900000
         L     REGB,WRKTEMP        RELOAD REG                           67000000
         B     PLT04400                                                 67100000
PLT04800 MVC   WRKYINCR,WRKYCHNG   STORE Y INCR                         67200000
         B     PLT02400                                                 67300000
PLT04900 TM    WRKSWTCH,FIRST      ANY GENERATED YET                    67400000
         BO    PLT05000            NO CHANGE ENTRY TO SINGEL            67500000
         OI    WRKBITS+2,LASTIN    SET LAST TIME SWITCH                 67600000
         OI    WRKSWTCH,LSTONE     SET SWITCH TO SAY LAST TIME IN       67700000
         B     PLT03750            CONTINUE ON                          67800000
PLT05000 XI    WRKBITS,MULT        MULTIPLE ENTRY HAS BECOME A SINGLE   67900000
         B     PLT03750            CONTINUE                             68000000
         EJECT                                                          68100000
ERR1     MVC   PARMERR(4,ERRCD),ONE GDS INVALID                         68200000
ERRPRM   OI    0(ERRCD),PRM        PARM ERROR                           68300000
         B     PLT02700                                                 68400000
ERR3     MVC   PARMERR(4,ERRCD),SIX GENCODE                             68500000
         B     ERRPRM                                                   68600000
ERR4     MVC   PARMERR(4,ERRCD),FOUR CORVAL                             68700000
         B     ERRPRM                                                   68800000
ERR7     MVC   PARMERR(4,ERRCD),SEVEN COUNT                             68900000
ERR8     OI    0(ERRCD),SCISSOR    NO DATA GEN                          69000000
         XC    4(4,ERRCD),4(ERRCD) ZERO SCISSOR COUNT                   69100000
         B     PLT02700                                                 69200000
ERR9     OI    0(ERRCD),STRG       MAIN STORAGE EXCEEDED                69300000
         MVC   STOR(4,ERRCD),FOUR                                       69400000
ERR10    MVC   GDSXLAST(8),WRKXLAST RESET SYSTEM                        69500000
         MVC   GDSXCURR(4),WRKXCURR                                     69600000
         TM    WRKSWTCH,UPDATE     UPDATE                               69700000
         BO    PLT02700            NO RESET RQD                         69800000
*//                                                                     69900000
*//      CALL RESET TO RESET SYSTEM                                     70000000
*//                                                                     70100000
         MVC   WRKDATA2(20),0(ERRCD)   SAVE RETURN ARRAY                70200000
         LA    REGA,GDSGDSCB       VAR CONTAINING ADDR OF GDS           70300000
         ST    REGA,WRKGDS         IN PARAMETER LIST                    70400000
         L     REGA,NULL(ERRCD)    NULL FOR CORVAL                      70500000
         ST    REGA,WRKRTN         IN PARM LIST                         70600000
         LA    REGA,WRKADDR        ADDRESS OF KEY                       70700000
         ST    REGA,WRKDATA1       IN PARAMETER LIST                    70800000
         OI    WRKDATA1,LAST       LAST PARM SW                         70900000
         LA    REGA,WRKGDS         ADDR OF PARM LIST                    71000000
         ST    REGA,WRKGDS1        IN WORK AREA                         71100000
         ST    ERRCD,WRKCODE       ERROR CODE IN PARM LIST              71200000
         LA    PARM,WRKGDS1        ADDR OF WRK AREA IN R1               71300000
         LINK  EP=IFFAFA12,MF=(E,(1)),SF=(E,WRKSPVSR)                   71400000
*        LINK TO RESET ROUTINE                                          71500000
         MVC   0(20,ERRCD),WRKDATA2                                     71600000
*        RESET RETURN ARRAY                                             71700000
         B     PLT02700                                                 71800000
         EJECT                                                          71900000
* REGISTERS                                                             72000000
REGZERO  EQU   0                                                        72100000
PARM     EQU   1                                                        72200000
REGA     EQU   2                                                        72300000
REGB     EQU   3                                                        72400000
REGE     EQU   4                                                        72500000
WORK     EQU   5                                                        72600000
ERRCD    EQU   6                                                        72700000
GTMREG   EQU   7                                                        72800000
GDSREG   EQU   8                                                        72900000
BASE     EQU   9                                                        73000000
REGC     EQU   10                                                       73100000
REGD     EQU   11                                                       73200000
SAVE     EQU   13                                                       73300000
RETURN   EQU   14                                                       73400000
REGFIFTN EQU   15                                                       73500000
FLT2     EQU   2                   FLOATING PT REG                      73600000
         EJECT                                                          73700000
ZERO     DC    2F'0'                                                    73800000
ONE      DC    F'1'                                                     73900000
TWO      DC    F'2'                                                     74000000
THREE    DC    F'3'                                                     74100000
FOUR     DC    F'4'                                                     74200000
BITS     DC    B'00000111'         SINGLE,VECTOR,INCLUDE,OPTIMIZE       74300000
         DC    X'00'                                                    74400000
         DC    B'00001000'         FIRST PASS,NOT KEY,COR,BEAMON,REPOS  74500000
         DC    X'00'                                                    74600000
SIX      DC    F'6'                                                     74700000
SEVEN    DC    F'7'                                                     74800000
PATCH    DC    10F'0'                                       L5 @ZA04162 74900000
SCISSOR  EQU   X'40'                                                    75000000
FE       EQU   48                                                  000A 75100000
ETE      EQU   828                                                 000A 75200000
         EJECT                                                          75300000
OMIT     EQU   X'FB'                                                    75400000
XINDX    EQU   X'C0'                                                    75500000
YINDX    EQU   X'0C'                                                    75600000
XINC     EQU   X'30'                                                    75700000
YINC     EQU   X'03'                                                    75800000
MULT     EQU   X'80'                                                    75900000
OPT      EQU   X'04'                                                    76000000
ABS      EQU   X'02'                                                    76100000
ABSSW    EQU   X'03'                                                    76200000
INCSW    EQU   X'02'                                                    76300000
SUBR     EQU   X'02'                                                    76400000
INC      EQU   X'01'                                                    76500000
NOSCISS  EQU   X'10'                                                    76600000
LASTON   EQU   X'1F'                                                    76700000
CURRLOG  EQU   52                                                       76800000
ABSOLX   EQU   X'A0'                                                    76900000
ABSOLY   EQU   X'0A'                                                    77000000
REALX    EQU   X'C0'                                                    77100000
REALY    EQU   X'0C'                                                    77200000
PT       EQU   X'10'                                                    77300000
NULL     EQU   20                                                       77400000
LAST     EQU   X'80'                                                    77500000
XABS     EQU   X'A0'                                                    77600000
YABS     EQU   X'0A'                                                    77700000
CORRE    EQU   X'10'                                                    77800000
KEYED    EQU   X'20'                                                    77900000
LEVEL2   EQU   X'10'                                                    78000000
POINT    EQU   X'01'                                                    78100000
MEMSUB   EQU   X'80'                                                    78200000
MEMSEQ   EQU   X'40'                                                    78300000
SEQ      EQU   X'04'                                                    78400000
XINTINC  EQU   X'10'                                                    78500000
XRELINC  EQU   X'40'                                                    78600000
YINTINC  EQU   X'01'                                                    78700000
YRELINC  EQU   X'04'                                                    78800000
EVENFOUR EQU   X'FC'                                                    78900000
ARRAY    EQU   X'18'               OFFSET TO GSPARRAY         LD YM5163 79000000
GSPPTR   EQU   4                   OFFSET TO GSPCB IN GTMCB   LD YM5163 79100000
SCISORED EQU   X'40'               SCISSOR FLAGS IN ARRAY     LD YM5163 79200000
PLTPTNT  EQU   X'01'               PLOT POINT FLAGS           LD YM5163 79300000
BLANK    EQU   X'F7'               BLANK BEAM BIT MASK        LD YM5163 79400000
* PARM LIST EQUATES                                                     79500000
GDS      EQU   0                                                        79600000
X        EQU   4                                                        79700000
Y        EQU   8                                                        79800000
COR      EQU   12                                                       79900000
KEY      EQU   16                                                       80000000
GEN      EQU   20                                                       80100000
CT       EQU   24                                                       80200000
XINDEX   EQU   28                                                       80300000
YINDEX   EQU   32                                                       80400000
XINCR    EQU   36                                                       80500000
YINCR    EQU   40                                                       80600000
PARMERR  EQU   16                                                       80700000
PRM      EQU   X'08'                                                    80800000
STRG     EQU   X'10'                                                    80900000
STOR     EQU   12                                                       81000000
NFNL     EQU   X'40'                                                    81100000
LASTIN   EQU   X'C0'                                                    81200000
DGEN     EQU   840                                                      81300000
SCISS    EQU   876                                                      81400000
SCALE    EQU   864                                                      81500000
UPDH13   EQU   936               DISPL OF H13 IN STATAB     D11 ZA15418 81600000
UPDH14   EQU   948               DISPL OF H14 IN STATAB     D11 ZA15418 81700000
STAT     EQU   24                                                       81800000
FIVE     DC    F'5'                                                     81900000
CVTLINK  EQU   8                                                        82000000
INCL     EQU   X'04'                                                    82100000
REPONLY  EQU   X'02'                                                    82200000
FIRST    EQU   X'02'                                                    82300000
LSTONE   EQU   X'01'                                                    82400000
OFF      EQU   X'FC'                                                    82500000
UPDATE   EQU   X'80'                                                    82600000
GTMUPDT  EQU   X'3C'             DISP IN GTMCB FOR DGN FLG  L5 @ZA04162 82700000
UPDTOFF  EQU   X'7E'             MASK TO TURN OFF DGEN FLG  L5 @ZA04161 82800000
         EJECT                                                          82900000
WORKAREA DSECT                                                          83000000
WRKPARM  DS    F                                                        83100000
WRKRTNCD DS    F                                                        83200000
WRKSWTCH DS    F                                                        83300000
*        SWITCH SETTINGS FOR WRKSWTCH - PLINE AND PPOINT                83400000
*                                                                       83500000
*        WRKSWTCH+1                                                     83600000
*        C0 = X INDEX PASSED                                            83700000
*        30 = X INCREMENT PASSED                                        83800000
*        0C = Y INDEX PASSED                                            83900000
*        03 = Y INCREMENT PASSED                                        84000000
*                                                                       84100000
*        WRKSWTCH+2                                                     84200000
*        80 = X IS REAL,ABSOLUTE                                        84300000
*        40 = X IS REAL,INCREMENTAL                                     84400000
*        20 = X IS INTEGER,ABSOLUTE                                     84500000
*        10 = X IS INTEGER,INCREMENTAL                                  84600000
*        08 = Y IS REAL,ABSOLUTE                                        84700000
*        04 = Y IS REAL,INCREMENTAL                                     84800000
*        02 = Y IS INTEGER,ABSOLUTE                                     84900000
*        01 = Y IS INTEGER,INCREMENTAL                                  85000000
*                                                                       85100000
*        WRKSWTCH+3                                                     85200000
*        00 = PLINE                                                     85300000
*        O1 = PPOINT                                                    85400000
*                                                                       85500000
WRKSAVE  DS    18F                                                      85600000
WRKSPVSR DS    3F                                                       85700000
WRKXCURR DS    H                                                        85800000
WRKYCURR DS    H                                                        85900000
WRKXLAST DS    F                                                        86000000
WRKYLAST DS    F                                                        86100000
WRKXCHNG DS    F                                                        86200000
WRKYCHNG DS    F                                                        86300000
WRKTEMP  DS    F                                                        86400000
WRKADDR  DS    F                                                        86500000
WRKBITS  DS    F                                                        86600000
WRKCORVL DS    F                                                        86700000
WRKKEY   DS    F                                                        86800000
WRKGDS   DS    F                                                        86900000
WRKRTN   DS    F                                                        87000000
WRKDATA1 DS    F                                                        87100000
WRKDATA2 DS    F                                                        87200000
WRKDATA3 DS    F                                                        87300000
WRKDATA4 DS    F                                                        87400000
WRKXABS  DS    F                                                        87500000
WRKYABS  DS    F                                                        87600000
WRKXINCR DS    F                                                        87700000
WRKYINCR DS    F                                                        87800000
WRKTOTX  DS    F                                                        87900000
WRKTOTY  DS    F                                                        88000000
WRKENTCT DS    F                                                        88100000
WRKGDS1  DS    F                                                        88200000
WRKCODE  DS    F                                                        88300000
WRKKADDR DS    F                                                        88400000
         COPY  GDSCB                                                    88500000
         COPY  GTMCB                                                    88600000
         COPY  GSPCB                                                    88700000
         END                                                            88800000
