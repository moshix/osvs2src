         TITLE 'PSGMT --IFFAFA02'                                       00090000
*********************************************************************** 00180000
*                                                                       00270000
*TITLE         PSGMT                                                  * 00360000
*                                                                     * 00450000
*MODULE NAME   IFFAFA02                                               * 00540000
*                                                                     * 00630000
*STATUS        CHANGE LEVEL 000                                       * 00720000
*                                                                     * 00810000
*FUNCTION/OPERATION                                                   * 00900000
*  TO PRODUCE LINE SEGMENTS ON THE GRAPHIC OUTPUT MEDIUM AT THE       * 00990000
*  POSITIONS SPECIFIED BY THE ARGUMENTS, AND TO UPDATE GRAPHIC        * 01080000
*  DATA PREVIOUSLY PRODUCED BY PSGMT. EACH LINE SEGMENT IS IS         * 01170000
*  DETERMINED BY TWO SUPPLIED ARGUMENT POINTS.                        * 01260000
*  EACH LINE SEGMENT TO BE DISPLAYED DEMANDS TWO CALLS TO THE DATA    * 01350000
*  GENERATION ROUTINE, THE FIRST TO MOVE THE BEAM TO THE SEGMENT      * 01440000
*  START POINT (BLANKED MODE), THE SECOND TO DISPLAY THE LINE         * 01530000
*  SEGMENT(UNBLANKED MODE).                                           * 01620000
*                                                                     * 01710000
*ENTRY POINT   IFFAFA02- CSECT NAME                                   * 01800000
*                                                                     * 01890000
*INPUT   REGISTER 1 CONTAINS THE ADDRESS OF A WORK/SAVE AREA. THE     * 01980000
*  FIRST WORD CONTAINS THE ADDRESS OF A VARIABLE LENGTH PARAMETER     * 02070000
*  LIST ON A FULL WORD BOUNDARY, THE SECOND WORD CONTAINS THE         * 02160000
*  ADDRESS OF THE RETURN ARRAY. THE NULL VARIABLE IS AT AN OFFSET     * 02250000
*  OF 20 FROM THE RETURN ARRAY, AND THE ADDRESS OF THE STATUS TABLE   * 02340000
*  IS AT AN OFFSET OF 24 FROM THE RETURN ARRAY.                       * 02430000
*FORMAT OF PARAMETER LIST                                             * 02520000
* REQUIRED PARAMETERS                                                 * 02610000
*                                                                     * 02700000
*  +0   A(VAR)      ADDRESS OF A VARIABLE WHICH CONTAINS THE GDSCB    * 02790000
*                   ADDRESS.                                          * 02880000
*  +4   A(UVAL1)    ADDRESS OF THE U VALUE PARAMETER FOR THE SEGMENT  * 02970000
*                   START.                                            * 03060000
*  +8   A(VVAL1)    ADDRESS OF THE V VALUE PARAMETER FOR THE SEGMENT  * 03150000
*                   START.                                            * 03240000
* +12   A(UVAL2)    ADDRESS OF THE U VALUE PARAMETER FOR THE SEGMENT  * 03330000
*                   END.                                              * 03420000
* +16   A(VVAL2)    ADDRESS OF THE V VALUE PARAMETER FOR THE SEGMENT  * 03510000
*                   END.                                              * 03600000
*                                                                     * 03690000
*  OPTIONAL PARAMETERS                                                * 03780000
*                                                                     * 03870000
* +20   A(CORRVAL)  ADDRESS OF A FULL WORD CONTAINING A CORRELATION   * 03960000
*                   VALUE.                                            * 04050000
* +24   A(KEY)      ADDRESS OF KEY VARIABLE                             04140000
* +28   A(GENCODE)  ADDRESS OF THE CODE WHICH SPECIFIES THE TYPE OF     04230000
*                   OUTPUT - EITHER BLANKED, UNBLANKED, OR UPDATE     * 04320000
* +32   A(COUNT)    ADDRESS OF A VARIABLE WHICH CONTAINS THE COUNT    * 04410000
*                   OF THE NUMBER OF DATA ELEMENTS TO BE GENERATED.   * 04500000
* +36   A(U-INDEX1) ADDRESS OF THE INDEX TO BE USED IN OBTAINING THE  * 04590000
*                   NEXT U ELEMENT FOR THE START OF THE SEGMENT, WHEN * 04680000
*                   MORE THAN ONE DATA ELEMENT IS BEING GENERATED.    * 04770000
* +40   A(V-INDEX1) ADDRESS OF THE INDEX TO BE USED IN OBTAINING THE  * 04860000
*                   NEXT V ELEMENT FOR THE START OF THE SEGMENT, WHEN * 04950000
*                   MORE THAN ONE DATA ELEMENT IS BEING GENERATED.    * 05040000
* +44   A(U-INDEX2) ADDRESS OF THE INDEX TO BE USED IN OBTAINING THE  * 05130000
*                   NEXT U ELEMENT FOR THE END OF THE SEGMENT WHEN    * 05220000
*                   MORE THAN ONE DATA ELEMENT IS BEING GENERATED.    * 05310000
* +48   A(V-INDEX2) ADDRESS OF THE INDEX TO BE USED IN OBTAINING THE  * 05400000
*                   NEXT V.ELEMENT FOR THE END OF THE SEGMENT WHEN    * 05490000
*                   MORE THAN ONE DATA ELEMENT IS BEING GENERATED.    * 05580000
* +52   A(U-INCR1)  ADDRESS OF A VALUE TO BE ADDED TO THE UVAL1 TO    * 05670000
*                   OBTAIN THE NEXT UVAL1 FOR THE START OF THE LINE   * 05760000
*                   SEGMENT WHEN MORE THAN ONE DATA ELEMENT IS BEING  * 05850000
*                   GENERATED.                                        * 05940000
* +56   A(V-INCR1)  ADDRESS OF A VALUE TO BE ADDED TO THE VVAL1 TO    * 06030000
*                   OBTAIN THE NEXT VVAL1 FOR THE START OF THE LINE   * 06120000
*                   SEGMENT WHEN MORE THAN ONE DATA ELEMENT IS BEING  * 06210000
*                   GENERATED                                         * 06300000
* +60   A(U-INCR2)  ADDRESS OF A VALUE TO BE ADDED TO UVAL2 TO OBTAIN * 06390000
*                   THE NEXT UVAL2 FOR THE END OF THE LINE SEGMENT    * 06480000
*                   WHEN MORE THAN ONE DATA ELEMENT IS BEING GENER-   * 06570000
*                   ATED.                                             * 06660000
* +64   A(V-INCR2)  ADDRESS OF A VALUE TO BE ADDED TO VVAL2 TO OBTAIN * 06750000
*                   THE NEXT VVAL2 FOR THE END OF THE LINE SEGMENT    * 06840000
*                   WHEN MORE THAN ONE DATA ELEMENT IS BEING GENER-   * 06930000
*                   ATED.                                             * 07020000
*                                                                     * 07110000
*OUTPUT                                                               * 07200000
*  THE DATA WILL BE SCISSORED AND SCALED AND IF IT APPEARS ON THE     * 07290000
*  SCREEN AND/OR GRID, ORDERS WILL BE GENERATED FOR IT IN THE GDOA.   * 07380000
*                                                                     * 07470000
*EXTERNAL ROUTINES                                                    * 07560000
*  IFFAFA12 - RESET                                                   * 07650000
*  IFFAHA03 - KEY TABLE MANAGEMENT                                    * 07740000
*  IFFAHA04 - DATA GENERATION                                         * 07830000
*  IFFAHA06 - SCALE                                                   * 07920000
*  IFFAHA07 - SCISSOR                                                 * 08010000
*  IFFAHA13 - GET GDOA'S FOR UPDATE                                   * 08100000
*  IFFAHA14 - WRITE OUT UPDATE                                        * 08190000
*                                                                     * 08280000
*EXITS - NORMAL- BACK TO CALLER VIA REGISTER 14                       * 08370000
*      - ERROR - BACK TO CALLER VIA REGISTER 14                       * 08460000
*  APPROPRIATE CODES ARE SET IN THE RETURN ARRAY -VALUES = 0,1,2,3,4  * 08550000
*                                                                     * 08640000
*                                                                     * 08730000
*                                                                     * 08820000
*TABLES/WORKAREAS -  SEE WORKAREA DSECT                               * 08910000
*                                                                     * 09000000
*ATTRIBUTES       -  REENTRANT, PROBLEM PROGRAM MODE                  * 09090000
*                                                                     * 09180000
*********************************************************************** 09270000
         EJECT                                                          09360000
IFFAFA02 CSECT                          PSEGMT                          09450000
*2024,695700-698400                                                000A 09540000
*D601500-601800                                                  YM1963 09630000
*A179300-179500,C570600,C572400-575100,C685800-688500       D11 ZA15418 09720000
         SPACE                                                          09810000
* REGISTERS                                                             09900000
REGZERO  EQU   0                                                        09990000
PARM     EQU   1                                                        10080000
LOOPCT   EQU   1                                                        10170000
REGA     EQU   2                                                        10260000
ERRCD    EQU   3                                                        10350000
REGB     EQU   4                                                        10440000
WORK     EQU   5                                                        10530000
REGD     EQU   6                                                        10620000
GTMREG   EQU   7                                                        10710000
GDSREG   EQU   8                                                        10800000
BASE     EQU   9                                                        10890000
REGC     EQU   10                                                       10980000
COUNT    EQU   11                                                       11070000
REGE     EQU   11                                                       11160000
SAVE     EQU   13                                                       11250000
RETURN   EQU   14                                                       11340000
REGFIFTN EQU   15                                                       11430000
FLT2     EQU   2                        FLOATING POINT REG              11520000
         SPACE 2                                                        11610000
*        PARAMETER LIST EQUATES                                         11700000
*                        REQUIRED PARAMETERS                            11790000
GDS      EQU   0                        ADR OF VARIABLE HOLDING GDS ADR 11880000
X        EQU   4                        ADR OF X VALUE FOR SEGMT START  11970000
Y        EQU   8                        ADR OF Y VALUE FOR SEGMT START  12060000
X2       EQU   12                       ADR OF X VALUE FOR SEGMT END    12150000
Y2       EQU   16                       ADR OF Y VALUE FOR SEGMT END    12240000
*                        OPTIONAL PARAMETERS                            12330000
FE       EQU   48                                                  000A 12420000
ETE      EQU   828                                                 000A 12510000
COR      EQU   20                       ADR OF CORRELATION VALUE        12600000
KEY      EQU   24                       ADR OF KEY LOCATION             12690000
GEN      EQU   28                       ADR OF CODE                     12780000
CT       EQU   32                       ADR OF COUNT                    12870000
XINDEX   EQU   36                       ADR OF X START INDEX            12960000
YINDEX   EQU   40                       ADR OF Y START INDEX            13050000
XINDEX2  EQU   44                       ADR OF X END INDEX              13140000
YINDEX2  EQU   48                       ADR OF Y END INDEX              13230000
XINCR    EQU   52                       ADR OF X START INCREMENT        13320000
YINCR    EQU   56                       ADR OF Y START INCREMENT        13410000
XINCR2   EQU   60                       ADR OF X END INCREMENT          13500000
YINCR2   EQU   64                       ADR OF Y END INCREMENT          13590000
         EJECT                                                          13680000
ON       EQU   X'FF'                                                    13770000
REPONLY  EQU   X'02'                                                    13860000
UPDATE   EQU   X'FF'                                                    13950000
INCLUDE  EQU   X'04'                                                    14040000
SWOFF    EQU    X'3F'                                                   14130000
OMIT     EQU   X'FB'                                                    14220000
XINDX    EQU   X'C0'                                                    14310000
YINDX    EQU   X'0C'                                                    14400000
XINC     EQU   X'30'                                                    14490000
YINC     EQU   X'03'                                                    14580000
NOX      EQU   X'0F'                                                    14670000
NOY      EQU   X'F0'                                                    14760000
PRM      EQU   X'08'                                                    14850000
STRG     EQU   X'10'                                                    14940000
SCISSOR  EQU   X'40'                                                    15030000
NOSCISS  EQU   X'10'                                                    15120000
LEVEL2   EQU   X'10'                                                    15210000
OPT      EQU   X'04'                                                    15300000
INC      EQU   X'01'                                                    15390000
INCSW    EQU   X'02'                                                    15480000
ABS      EQU   X'02'                                                    15570000
ABSSW    EQU   X'03'                                                    15660000
SUBR     EQU   X'02'                                                    15750000
MEMSUB   EQU   X'80'                                                    15840000
SEQ      EQU   X'04'                                                    15930000
MEMSEQ   EQU   X'40'                                                    16020000
NFNL     EQU   X'40'                                                    16110000
MULT     EQU   X'80'                                                    16200000
BEAMSW   EQU   X'08'                                                    16290000
CORRE    EQU   X'10'                                                    16380000
KEYED    EQU   X'20'                                                    16470000
REALY    EQU   X'0C'                                                    16560000
REALX    EQU   X'C0'                                                    16650000
ABSOLXY  EQU   X'AA'                                                    16740000
XABS     EQU   X'A0'                    SWITCH SETTING IN GDSCB         16830000
YABS     EQU   X'0A'                                                    16920000
XREALI   EQU   X'40'                                                    17010000
YREALI   EQU   X'04'                                                    17100000
XINTGI   EQU   X'10'                                                    17190000
YINTGI   EQU   X'01'                                                    17280000
LAST     EQU   X'80'                                                    17370000
LASTIN   EQU   X'C0'                                                    17460000
LASTON   EQU   X'1F'                                                    17550000
XFOUR    EQU   X'FC'                                                    17640000
STOR     EQU   12                                                       17730000
PARMERR  EQU   16                                                       17820000
NULL     EQU   20                                                       17910000
NL       EQU   21                                                       18000000
CURRLOG  EQU   52                                                       18090000
STAT     EQU   24                                                       18180000
DGEN     EQU   840                                                      18270000
SCISS    EQU   876                                                      18360000
SCALE    EQU   864                                                      18450000
UPDH13   EQU   936         STATAB DISPL OF IFFAHA13 ENTRY   D11 ZA15418 18540000
UPDH14   EQU   948         STATAB DISPL OF IFFAHA14 ENTRY   D11 ZA15418 18630000
CVTLINK  EQU   8                                                        18720000
         EJECT                                                          18810000
*        THIS CODE ESTABLIHES ADDRESSABILITY FOR IFFAFA02, FOR THE      18900000
*        GDSCB AND FOR THE WORKAREA. THE RETURN ARRAY IS SET TO ZERO,   18990000
*        AND THE SAVE AREAS ARE CHAINED.                                19080000
         SPACE                                                          19170000
         USING *,15                                                     19260000
         SAVE  (14,12)                                                  19350000
         DROP  15                                                       19440000
         LR    BASE,15                  LOAD CONTROL SECTION BASE       19530000
         USING IFFAFA02,BASE                                            19620000
         LR    WORK,PARM                LOAD WORK AREA BASE             19710000
         USING WORKAREA,WORK                                            19800000
         XC    WKSWITCH(8),WKSWITCH     ZERO SWITCH AREAS               19890000
         L     PARM,WKPARM              LOAD PARAMETER LIST ADDRESS     19980000
         L     ERRCD,WKRTNCD                                            20070000
         XC    0(20,ERRCD),0(ERRCD)     ZERO RETURN ARRAY               20160000
         L     GDSREG,GDS(PARM)         PICK UP ADDRESS OF GDS ADDRESS  20250000
         L     GDSREG,0(GDSREG)         ADDRESS OF GDSCB                20340000
         USING GDSCB,GDSREG                                             20430000
         L     COUNT,TWO                SET COUNT DEFAULT TO TWO        20520000
         LA    REGA,WKSAVE              CHAIN SAVE AREAS                20610000
         ST    REGA,8(SAVE)                                             20700000
         ST    SAVE,4(REGA)                                             20790000
         LR    SAVE,REGA                REG 13 CONTAINS ADR OF THIS     20880000
*                                          SAVE AREA                    20970000
*                                                                       21060000
*        THE GDSCB PASSED IS CHECKED FOR VALIDITY, AND IF IT IS VALID,  21150000
*        A SKELETON PARAMETER LIST FOR DATA GENERATION IS SET UP,       21240000
*        WITH SWITCHES INITIALIZED TO MULTIPLE ENTRY, OUTPUT TYPE=      21330000
*        VECTOR, STATUS IS INCLUDE,OUTPUT IS OPTIMIZED, FIRST ENTRY,    21420000
*        NOT KEYED, NOT CORVALED, BEAM OFF.                             21510000
*                                                                       21600000
         MVC   WKSWAREA+1(1),GDSDATMD  SAVE DATA MODE SW FROM GDSCB     21690000
         C     GDSREG,GDSGDSCB                                          21780000
         BNE   AFAERR10                 BRANCH IF INVALID GDSCB         21870000
         XC    WKSPVSR(12),WKSPVSR     ZERO PARM LIST FOR LINK MACRO    21960000
         XC    WKADDR(68),WKADDR        ZERO PARAMETER FIELDS           22050000
         MVC   WKBITS,BITS              MOVE OPTION SWITCHES,           22140000
         ST    GDSREG,WKGDS              GDSCB ADDRESS, AND             22230000
         MVC   WKRTN,WKRTNCD             RETURN CODE ARRAY ADDRESS      22320000
*                                       INTO PARAMETER LIST             22410000
         EJECT                                                          22500000
*        REQUIRED PARAMETERS (X AND Y VALUES FOR START AND END OF       22590000
*        SEGMENT) ARE EXAMINED, AND THE TYPE OF DATA PASSED IS          22680000
*        DETERMINED.                                                    22770000
         TM    GDS(PARM),LAST                                           22860000
         BO    AFAERR20                 BRANCH IF REQ PARMS NOT PRESENT 22950000
         MVC   WKSWITCH+3(1),GDSDATMD  IINITIALIZE DATA MODE SWITCH     23040000
*                                         IN WORK AREA                  23130000
         TM    GDSFLAGS,SEQ                                             23220000
         BZ    AFAREQ03                                                 23310000
         OI    WKBITS+3,MEMSEQ          OTHERWISE SET SWITCH IN KEY     23400000
AFAREQ03 TM    GDSFLAGS,SUBR                                            23490000
         BZ    AFAREQ05                                                 23580000
         OI    WKBITS+3,MEMSUB         SET SWITCH IN KEY                23670000
         BAL   RETURN,AFAREQ90         IF SUBR, GO CHECK DATA MODE      23760000
AFAREQ05 TM    X(PARM),LAST                                             23850000
         BO    AFAERR20                 BRANCH IF REQ PARMS NOT PRESENT 23940000
         TM    Y(PARM),LAST                                             24030000
         BO    AFAERR20                 BRANCH IF REQ PARMS NOT PRESENT 24120000
         TM    X2(PARM),LAST                                            24210000
         BO    AFAERR20                 BRANCH IF REQ PARMS NOT PRESENT 24300000
         TM    Y2(PARM),LAST                                            24390000
         BO    AFAREQ10                 START PROCESSING PARMS          24480000
         TM    COR(PARM),LAST                                           24570000
         BO    AFAREQ10                 START PROCESSING PARMS          24660000
         TM    KEY(PARM),LAST                                           24750000
         BO    AFAREQ10             START PROCESSING PARMS              24840000
*                                                                       24930000
*CHECK FOR GENCODE OF 3- AND IF IT IS, PROCESS IT                       25020000
*                                                                       25110000
         CLC   NL(3,ERRCD),GEN+1(PARM)                                  25200000
         BE    AFAREQ10                 BRANCH IF GENCODE NULL          25290000
         L     REGA,GEN(PARM)                                           25380000
         L     REGA,0(REGA)             PICK UP GENCODE                 25470000
         C     REGA,THREE                                               25560000
         BE    AFAOPT10                                                 25650000
*                                                                       25740000
AFAREQ10 L     REGA,X(PARM)             ADDRESS OF X START VALUE        25830000
         L     REGA,0(REGA)             X VALUE                         25920000
         TM    WKSWITCH+3,XABS                                          26010000
         BZ    AFAREQ60                 BRANCH IF X INCREMENTAL         26100000
         ST    REGA,WKXABS              PUT ABSOLUTE VALUE IN PARM LIST 26190000
AFAREQ20 ST    REGA,WKXVAL              SAVE COPY OF X VALUE            26280000
         L     REGB,Y(PARM)             ADDRESS OF Y START VALUE        26370000
         L     REGB,0(REGB)             Y VALUE                         26460000
         TM    WKSWITCH+3,YABS                                          26550000
         BZ    AFAREQ65                 BRANCH IF Y INCREMENTAL         26640000
         ST    REGB,WKYABS              PUT ABSOLUTE VALUE IN PARM LIST 26730000
AFAREQ30 ST    REGB,WKYVAL              SAVE COPY OF Y VALUE            26820000
         L     REGA,X2(PARM)            ADDRESS OF X END VALUE          26910000
         L     REGA,0(REGA)             X END VALUE                     27000000
         ST    REGA,WKXVAL2             SAVE COPY OF X END VALUE        27090000
         TM    WKSWITCH+3,XABS                                          27180000
         BZ    AFAREQ50                 BRANCH IF X END INCREMENTAL     27270000
AFAREQ35 L     REGB,Y2(PARM)                                            27360000
         L     REGB,0(REGB)             Y END VALUE                     27450000
         ST    REGB,WKYVAL2                                             27540000
         TM    WKSWITCH+3,YABS                                          27630000
         BZ    AFAREQ70                BRANCH IF Y END INCREMENTAL      27720000
AFAREQ40 TM    Y2(PARM),LAST                                            27810000
         BO    AFADAT10                 BRANCH IF NO OPTIONAL PARMS     27900000
         CLI   WKSWITCH,UPDATE                                          27990000
         BE    AFAOPT55                BRANCH IF UPDATE- CORRBAL,KEY    28080000
*                                       AND GENCODE ALREADY PROCESSED   28170000
         B     AFAOPT10                                                 28260000
         EJECT                                                          28350000
*INITIALIZATION OF INCREMENT TOTALS                                     28440000
*                                                                       28530000
AFAREQ60 ST    REGA,WKXINCR             PUT X INCR VALUE IN PARM LIST   28620000
         ST    REGA,WKXTOT               AND SAVE COPY FOR COMPUTING    28710000
         B     AFAREQ20                                                 28800000
*                                                                       28890000
*                                                                       28980000
AFAREQ65 ST    REGB,WKYINCR             PUT Y INCR VALUE IN PARM LIST   29070000
         ST    REGB,WKYTOT               AND SAVE COPY FOR COM          29160000
         B     AFAREQ30                                                 29250000
*                                                                       29340000
*REGA CONTAINS X END INCREMENT                                          29430000
*                                                                       29520000
AFAREQ50 TM    WKSWITCH+3,REALX                                         29610000
         BM    AFAREQ55                 BRANCH IF REAL NUMBER           29700000
         A     REGA,WKXTOT              1ST X END INCR IS FROM X START  29790000
         ST    REGA,WKXTOT2             KEEP CURRENT POINTER TO BEAM    29880000
         B     AFAREQ35                                                 29970000
AFAREQ55 LE    FLT2,WKXVAL2                                             30060000
         AE    FLT2,WKXTOT              ADD X START INCREMENT           30150000
         STE   FLT2,WKXTOT2             SAVE TOTAL                      30240000
         B     AFAREQ35                                                 30330000
*                                                                       30420000
*REGB CONTAINS Y END INCREMENT                                          30510000
*                                                                       30600000
AFAREQ70 TM    WKSWITCH+3,REALY                                         30690000
         BM    AFAREQ75                 BRANCH IF REAL NUMBER           30780000
         A     REGB,WKYTOT              ADD TO Y START INCREMENT        30870000
         ST    REGB,WKYTOT2             SAVE TOTAL                      30960000
         B     AFAREQ40                                                 31050000
AFAREQ75 LE    FLT2,WKYVAL2                                             31140000
         AE    FLT2,WKYTOT              ADD Y START INCREMENT           31230000
         STE   FLT2,WKYTOT2             SAVE TOTAL                      31320000
         B     AFAREQ40                                                 31410000
         EJECT                                                          31500000
*        RESETS DATA MODE SWITCHES IN TEMPORARY WORK AREA FOR           31590000
*        BUFFER SUBROUTINE. INPUT DATA SET TO INCREMENTAL MODE          31680000
*                                                                       31770000
AFAREQ90 MVI   WKSWITCH+3,X'00'         ZERO OUT SWITCH AREA            31860000
         TM    GDSDATMD,REALX                                           31950000
         BZ    AFAREQ96                 BRANCH IF X VALUE INTEGER       32040000
         OI    WKSWITCH+3,XREALI        SET SWITCH FOR REAL,INCR  X     32130000
AFAREQ92 TM    GDSDATMD,REALY                                           32220000
         BZ    AFAREQ98                 BRANCH IF Y VALUE INTEGER       32310000
         OI    WKSWITCH+3,YREALI        SET SWITCH FOR REAL,INCR  Y     32400000
         MVC   GDSDATMD(1),WKSWITCH+3  STORE NEW SWITCH IN GDSCB        32490000
         BR    RETURN                                                   32580000
*                                                                       32670000
AFAREQ96 OI    WKSWITCH+3,XINTGI        SET SWITCH FOR INTEGER,INCR X   32760000
         B     AFAREQ92                                                 32850000
AFAREQ98 OI    WKSWITCH+3,YINTGI        SET SWITCH FOR INTEGER,INCR Y   32940000
         MVC   GDSDATMD(1),WKSWITCH+3  STORE NEW SWITCH IN GDSCB        33030000
         BR    RETURN                                                   33120000
         EJECT                                                          33210000
*        THIS SECTION OF CODE EXAMINES THE OPTIONAL PARAMETERS          33300000
*        CORRVAL, KEY, AND GENCODE, AND TESTS THEM FOR VALIDITY         33390000
AFAOPT10 CLC   NL(3,ERRCD),COR+1(PARM)                                  33480000
         BE    AFAOPT15                 BRANCH IF CORRVAL NOT PASSED    33570000
         TM    GDSFLAGS,LEVEL2                                          33660000
         BO    AFAOPT15                BRANCH IF LEVEL 2 CORRVAL        33750000
         L     REGD,COR(PARM)           LOAD ADDRESS OF CORRVAL         33840000
         MVC   WKCORVL,0(REGD)          PLACE CORRVAL IN PARAM LIST     33930000
         OI    WKBITS+2,CORRE          SET CORRVAL SWITCH IN PARM LIST  34020000
AFAOPT15 TM    COR(PARM),LAST                                           34110000
         BO    AFADAT10                 BRANCH IF NO MORE PARAMETERS    34200000
         CLC   NL(3,ERRCD),KEY+1(PARM)                                  34290000
         BE    AFAOPT20                 BRANCH IF KEY NOT PASSED        34380000
         MVC   WKKEY,KEY(PARM)          PLACE ADDRESS OF KEY IN PARM    34470000
*                                           LIST                        34560000
         TM    GDSFLAGS,LEVEL2                                          34650000
         BO    AFAOPT20                 BRANCH IF LEVEL 2 KEY           34740000
         OI    WKBITS+2,KEYED           OTHERWISE SET KEY SWITCH IN     34830000
*                                           PARM LIST                   34920000
AFAOPT20 TM    KEY(PARM),LAST                                           35010000
         BO    AFADAT10                 BRANCH IF NO MORE PARAMETERS    35100000
         CLC   NL(3,ERRCD),GEN+1(PARM)                                  35190000
         BE    AFAOPT25                 BRANCH IF GENCODE NOT PASSED    35280000
         L     REGD,GEN(PARM)           PICK UP CODE ADDRESS            35370000
         L     REGD,0(REGD)             PICK UP ACTUAL CODE             35460000
         C     REGD,ONE                                                 35550000
         BE    AFAOPT25                 BRANCH IF STATUS='INCLUDE'      35640000
*                                      (SWT ALREADY SET IN PARM LIST)   35730000
         CLC   WKCORVL(8),ZERO         CHECK FOR CORRVAL AND/OR KEY     35820000
         BZ    AFAERR30                 BRANCH IF STATUS NOT INCLUDE    35910000
*                                         AND ELEMENT NOT KEYED OR      36000000
*                                         CORRVALED-ERROR               36090000
         C     REGD,TWO                                                 36180000
         BNE   AFAOPT30                 BRANCH IF STATUS NOT 'OMIT'     36270000
         TM    GDSFLAGS,LEVEL2                                          36360000
         BO    AFAERR30                 BRANCH IF LEVEL 2 AND 'OMIT'    36450000
*                                         STATUS SPECIFIED-ERROR        36540000
         NI    WKBITS,OMIT              TURN OFF INCLUDE SWITCH         36630000
AFAOPT25 TM    WKBITS+2,CORRE                                           36720000
         BZ    AFAOPT55                 BRANCH IF NOT CORRELATED        36810000
         CLC   WKCORVL,ZERO                                             36900000
         BE    AFAERR40                 BRANCH IF CORRVAL=0,-ERROR      36990000
         B     AFAOPT55                                                 37080000
*                                                                       37170000
AFAOPT30 C     REGD,THREE                                               37260000
         BNE   AFAERR30                 BRANCH IF NOT 'UPDATE'  -ERROR  37350000
         TM    GDSFLAGS,SUBR                                            37440000
         BO    AFAERR20                 BRANCH IF UPDATE WHEN GENERAT-  37530000
*                                         ING SUBROUTINE -ERROR         37620000
         TM    GDSFLAGS,LEVEL2                                          37710000
         BO    AFAOPT45                 BRANCH IF LEVEL2 TO SET KEY     37800000
         TM    WKBITS+2,KEYED                                           37890000
         BZ    AFAOPT50                 BRANCH IF ELEMENT NOT KEYED     37980000
*                                       PREPARE PARAMS FOR KEY SEARCH   38070000
         L     REGD,KEY(PARM)           LOAD KEY ADDRESS                38160000
         ST    REGD,WKKADDR             AND PUT IN PARAMETER LIST       38250000
         LA    REGD,TWO                CODE FOR SEARCH ON KEY           38340000
AFAOPT35 ST    REGD,WKCODE              WORK CODE ADDRESS               38430000
         LA    REGD,AFAOPT37                                            38520000
         ST    REGD,WKTEMP             SAVE RETURN ADDRESS              38610000
*                                                                       38700000
*SEARCH ON KEY OR CORRVAL - ADDRESS IN REGISTER 1                       38790000
*                                                                       38880000
         B     AFAKEY10                                                 38970000
AFAOPT37 LTR   REGFIFTN,REGFIFTN       TEST RETURN CODE                 39060000
         BNE   AFAERR20                 BRANCH IF INVALID KEY           39150000
         MVC   WKADDR,0(PARM)           MOVE KEY FIELDS INTO PARM LIST  39240000
         OC    WKBITS+3(1),7(PARM)      GET FLAGS FROM OLD KEY          39330000
         TM    WKBITS+3,MEMSUB                                          39420000
         BZ    AFAOPT38                                                 39510000
         BAL   RETURN,AFAREQ90                                          39600000
AFAOPT38 TM    4(PARM),INCLUDE                                          39690000
         BO    AFAOPT39                                                 39780000
         NI    WKBITS,OMIT              TURN OFF INCLUDE SWITCH         39870000
AFAOPT39 ST    PARM,WKSTORAD           SAVE KEY ADDR IN KEY TABLE       39960000
AFAOPT40 MVI   WKSWITCH,UPDATE          SET UPDATE SWITCH               40050000
AFAOPT42 L     PARM,WKPARM             RESTORE PARAMETER REG. POINTER   40140000
         B     AFAREQ10                                                 40230000
*                                                                       40320000
*                                                                       40410000
*                                                                       40500000
*                                                                       40590000
AFAOPT45 L     REGD,KEY(PARM)           LOAD KEY ADDRESS                40680000
         MVC   WKADDR,0(REGD)           PLACE KEY IN PARM LIST          40770000
         B     AFAOPT40                                                 40860000
*                                                                       40950000
AFAOPT50 CLC  WKCORVL,ZERO                                              41040000
         BE    AFAERR20                 BAD PARAMETER COMBINATION       41130000
*                                                                       41220000
*PREPARE FOR SEARCH ON CORRVAL                                          41310000
*                                                                       41400000
         LA    REGD,WKCORVL             LOAD CORRVAL ADDRESS            41490000
         ST    REGD,WKKADDR             AND PUT IN PARAMETER LIST       41580000
         LA    REGD,FIVE                 SEARCH                         41670000
         B     AFAOPT35                 BRANCH TO GET REST OF PARAMS    41760000
*                                         AND TO CALL KEY MANAGEMENT    41850000
         EJECT                                                          41940000
*        THIS SECTION EXAMINES THE COUNT PARAMETER, IF THE COUNT IS     42030000
*        NOT SPECIFIED IT IS SET TO TWO (TWO CALLS TO THE DATA          42120000
*        GENERATION ROUTINE ARE NEEDED FOR EACH LINE SEGMENT). IF       42210000
*        THE COUNT IS 0, NO DATA IS GENERATED AND CONTROL IS RETURNED   42300000
*        TO THE CALLER. IF THE COUNT IS LESS THAN ZERO AN ERROR         42390000
*        RETURN IS MADE. OTHERWISE THE COUNT IS MULTIPLIED BY TWO,      42480000
*        AND PROCESSING CONTINUES.                                      42570000
*                                                                       42660000
AFAOPT55 TM    GEN(PARM),LAST                                           42750000
         BO    AFADAT10                 BRANCH IF END OF PARM LIST      42840000
         CLC   NL(3,ERRCD),CT+1(PARM)                                   42930000
         BE    AFADAT10                 BRANCH IF COUNT NULL            43020000
         L     COUNT,CT(PARM)                                           43110000
         L     COUNT,0(COUNT)           LOAD COUNT                      43200000
         LTR   COUNT,COUNT                                              43290000
         BZ    AFARET10                 RETURN IF COUNT = 0             43380000
         BM    AFAERR70                 ERROR IF COUNT LESS THAN ZERO   43470000
         SLA   COUNT,1                 MULTIPLY COUNT BY 2              43560000
         C     COUNT,TWO                                                43650000
         BE    AFADAT10                 BRANCH IF ONE LINE TO BE        43740000
*                                       DISPLAYED                       43830000
         EJECT                                                          43920000
*        THIS SECTION EXAMINES THE X START INDEX, Y START INDEX,        44010000
*        X END INDEX, Y END INDEX, X START INCR, Y START INCR,          44100000
*        X END INCR, AND Y END INCR PARAMETERS.                         44190000
*        THESE PARAMETERS ARE CHECKED ONLY WHEN MORE THAN ONE LINE      44280000
*        SEGMENT IS TO BE DISPLAYED.                                    44370000
         TM    CT(PARM),LAST                                            44460000
         BO    AFAINX50                 BRANCH IF END OF PARAMETER LIST 44550000
         CLC   NL(3,ERRCD),XINDEX+1(PARM)                               44640000
         BE    AFAINX10                 BRANCH IF X START INDEX NULL    44730000
         L     REGD,XINDEX(PARM)                                        44820000
         L     REGD,0(REGD)             PICK UP INDEX VALUE             44910000
         SLA   REGD,2                   MULTIPLY BY 4                   45000000
         ST    REGD,WKXCHNG             SAVE INDEXING FACTOR            45090000
         OI    WKSWITCH+1,XINDX         SET SWITCH IN WORK AREA         45180000
AFAINX10 TM    XINDEX(PARM),LAST                                        45270000
         BO    AFAINX50                 BRANCH IF END OF PARAMETER LIST 45360000
         CLC   NL(3,ERRCD),YINDEX+1(PARM)                               45450000
         BE    AFAINX15                 BRANCH IF Y START INDEX NULL    45540000
         L     REGD,YINDEX(PARM)                                        45630000
         L     REGD,0(REGD)             PICK UP INDEX VALUE             45720000
         SLA   REGD,2                   MULTIPLY BY 4                   45810000
         ST    REGD,WKYCHNG             SAVE INDEXING FACTOR            45900000
         OI    WKSWITCH+1,YINDX         SET SWITCH IN WORK AREA         45990000
AFAINX15 TM    YINDEX(PARM),LAST                                        46080000
         BO    AFAINX50                 BRANCH IF END OF PARM LIST      46170000
         CLC   NL(3,ERRCD),XINDEX2+1(PARM)                              46260000
         BE    AFAINX20                 BRANCH IF X END INDEX NULL      46350000
         L     REGD,XINDEX2(PARM)                                       46440000
         L     REGD,0(REGD)            PICK UP INDES VALUE              46530000
         SLA   REGD,2                   MULTIPLY BY 4                   46620000
         ST    REGD,WKXCHNG2            SAVE INDEX FACTOR               46710000
         OI    WKSWITCH+2,XINDX        SET SWITCH IN WORK AREA          46800000
AFAINX20 TM    XINDEX2(PARM),LAST                                       46890000
         BO    AFAINX50                 BRANCH IF END OF PARM LIST      46980000
         CLC   NL(3,ERRCD),YINDEX2+1(PARM)                              47070000
         BE    AFAINX25                 BRANCH IF Y END INDEX NULL      47160000
         L     REGD,YINDEX2(PARM)                                       47250000
         L     REGD,0(REGD)             PICK UP INDEX VALUE             47340000
         SLL   REGD,2                   MULTIPLY BY 4                   47430000
         ST    REGD,WKYCHNG2            SAVE INDEX FACTOR               47520000
         OI    WKSWITCH+2,YINDX        SET SWITCH IN WORK AREA          47610000
         EJECT                                                          47700000
AFAINX25 TM    YINDEX2(PARM),LAST                                       47790000
         BO    AFAINX50                 BRANCH IF END OF PARAMETER LIST 47880000
         CLC   NL(3,ERRCD),XINCR+1(PARM)                                47970000
         BE    AFAINX30                 BRANCH IF X START INCR NULL     48060000
         TM    WKSWITCH+1,XINDX         WAS X START INDEX ALSO PASSED   48150000
         BO    AFAERR20                 BRANCH IF YES-ERROR             48240000
         L     REGD,XINCR(PARM)                                         48330000
         MVC   WKXCHNG,0(REGD)          SACE INCREMENT VALUE            48420000
         OI    WKSWITCH+1,XINC          SET SWITCH IN WORK AREA         48510000
AFAINX30 TM    XINCR(PARM),LAST                                         48600000
         BO    AFAINX50                 BRANCH IF END OF PARAMETER LIST 48690000
         CLC   NL(3,ERRCD),YINCR+1(PARM)                                48780000
         BE    AFAINX35                 BRANCH IF Y START INCR NULL     48870000
         TM    WKSWITCH+1,YINC          WAS Y START INDEX ALSO PASSED   48960000
         BO    AFAERR20                 BRANCH IF YES- ERROR            49050000
         L     REGD,YINCR(PARM)                                         49140000
         MVC   WKYCHNG,0(REGD)          SAVE INCREMENT VALUE            49230000
         OI    WKSWITCH+1,YINC                                          49320000
AFAINX35 TM    YINCR(PARM),LAST                                         49410000
         BO    AFAINX50                 BRANCH IF END OF PARAMETER LIST 49500000
         CLC   NL(3,ERRCD),XINCR2+1(PARM)                               49590000
         BE    AFAINX40                 BRANCH IF X END INCREMENT NULL  49680000
         TM    WKSWITCH+2,XINDX         WAS X END INDEX ALSO PASSED     49770000
         BO    AFAERR20                 BRANCH IF YES- ERROR            49860000
         L     REGD,XINCR2(PARM)                                        49950000
         MVC   WKXCHNG2,0(REGD)         SAVE INCREMENT VALUE            50040000
         OI    WKSWITCH+2,XINC          SET SWITCH IN WORK AREA         50130000
AFAINX40 TM    XINCR2(PARM),LAST                                        50220000
         BO    AFAINX50                 BRANCH IF END OF PARAMETER LIST 50310000
         CLC   NL(3,ERRCD),YINCR2+1(PARM)                               50400000
         BE    AFAINX50                 BRANCH IF Y ENC INCREMENT NULL  50490000
         TM    WKSWITCH+2,YINDX         WAS Y END INDEX ALSO PASSED     50580000
         BO    AFAERR20                 BRANCH IF YES- ERROR            50670000
         L     REGD,YINCR2(PARM)                                        50760000
         MVC   WKYCHNG2,0(REGD)         SAVE INCREMENT VALUE            50850000
         OI    WKSWITCH+2,YINC          SET SWITCH IN WORK AREA         50940000
         EJECT                                                          51030000
*        THIS SECTION CHECKS WHICH OF THE INDEX AND INCREMENT PARAMS    51120000
*        HAVE BEEN PASSED AND SETS UP DEFAULT CONDITIONS WHERE          51210000
*        NECESSARY.                                                     51300000
*                                                                       51390000
AFAINX50 TM    WKSWITCH+1,XINDX+XINC                                    51480000
         BM    AFAINX55                 BRANCH IF X START IX/INC THERE  51570000
         MVC   WKXCHNG,FOUR              OTHERWISE, SET INDEX VALUE=4   51660000
         OI    WKSWITCH+1,XINDX         AND SET SWITCH IN WORK AREA     51750000
AFAINX55 TM    WKSWITCH+1,YINDX+YINC                                    51840000
         BM    AFAINX60                 BRANCH IF Y START IX/INC THERE  51930000
         MVC   WKYCHNG,FOUR              OTHERWISE, SET INDEX VALUE=4   52020000
         OI    WKSWITCH+1,YINDX          AND SET SWITCH IN WORK AREA    52110000
AFAINX60 TM    WKSWITCH+2,XINDX+XINC                                    52200000
         BM    AFAINX65                 BRANCH IF X END IX/INC PRESENT  52290000
         MVC   WKXCHNG2,FOUR             OTHERWISE, SET INDEX VALUE=4   52380000
         OI    WKSWITCH+2,XINDX          AND SET SWITCH IN WORK AREA    52470000
AFAINX65 TM    WKSWITCH+2,YINDX+YINC                                    52560000
         BM    AFADAT10                 BRANCH IF Y END IX/INC PRESENT  52650000
         MVC   WKYCHNG2,FOUR             OTHERWISE,SET INDEX VALUE=4    52740000
         OI    WKSWITCH+2,YINDX          AND SET SWOTCH IN WORK AREA    52830000
         EJECT                                                          52920000
*        THIS SECTION COMPLETES THE PARAMETER LIST FOR THE CALL TO      53010000
*        THE DATA GENERATION ROUTINE AND, IF MORE THAN ONE LINE         53100000
*        SEGMENT IS TO BE DISPLAYED, SETS UP THE LOOP FOR FUTURE        53190000
*        ENTRIES. PSGMT WILL ALWAYS MAKE MULTIPLE ENTRIES TO THE        53280000
*        DATA GENERATION ROUTINE, AND OUTPUT WILL ALWAYS BE VECTOR.     53370000
*                                                                       53460000
AFADAT10 TM    WKBITS+3,MEMSUB                                          53550000
         BO    AFADAT70                BRANCH IF BUFFER SUBROUTINE      53640000
*                                        SUBROUTINE-OUTPUT INCREMENTAL  53730000
*TEST FOR OUTPUT DATA MODE                                              53820000
*                                                                       53910000
         TM    GDSCURMD,OPT                                             54000000
         BO    AFADAT20                 BRANCH IF OPTIMIZE MODE- SWITCH 54090000
*                                        ALREADY SET                    54180000
         TM    GDSCURMD,INC                                             54270000
         BO    AFADAT70                 BRANCH IF INCREMENTAL MODE      54360000
         XI    WKBITS,ABSSW            SET SWITCH TO ABSOLUTE MODE      54450000
*                                                                       54540000
*                                                                       54630000
AFADAT20 MVC   WKXCURR(4),GDSXCURR      SAVE X-Y CURRENT VALUE          54720000
         MVC   WKXLAST(8),GDSXLAST      SAVE X-Y LAST VALUE             54810000
         CLI   WKSWITCH,UPDATE                                          54900000
         BE    AFADAT75                 BRANCH IF UPDATE                54990000
         L     REGD,GDSAOACB            GET OACB ADDRESS                55080000
         L     REGD,CURRLOG(REGD)       GET LOGICAL START AND           55170000
         STH   REGD,WKADDR+2             STORE IN PARAMETER LIST        55260000
         EJECT                                                          55350000
*SET UP LOOP CONTROL IF MORE THAN ONE LINE SEGMENT TO BE GENERATED.     55440000
*                                                                       55530000
AFADAT25 C     COUNT,TWO                                                55620000
         BE    AFASSD10                 BRANCH IF ONE LINE TO GENERATE  55710000
AFADAT30 TM    WKSWITCH+1,XINDX                                         55800000
         BZ    AFADAT35                 BRANCH IF X START INCREMENTAL   55890000
         MVC   WKXVAL,X(PARM)           REPLACE X VALUE WITH X ADDR     55980000
AFADAT35 TM    WKSWITCH+1,YINDX                                         56070000
         BZ    AFADAT40                 BRANCH IF Y START INCREMENTAL   56160000
         MVC   WKYVAL,Y(PARM)           REPLACE Y VALUE WITH Y ADDR     56250000
AFADAT40 TM    WKSWITCH+2,XINDX                                         56340000
         BZ    AFADAT45                 BRANCH IF X END INCREMENTAL     56430000
         MVC   WKXVAL2,X2(PARM)         REPLACE X2 VALUE WITH X2 ADDR   56520000
AFADAT45 TM    WKSWITCH+2,YINDX                                         56610000
         BZ    AFASSD10                 BRANCH IF Y END INCREMENTAL     56700000
         MVC   WKYVAL2,Y2(PARM)         REPLACE Y2 VALUE WITH Y2 ADDR   56790000
         B     AFASSD10                                                 56880000
*                                                                       56970000
*                                                                       57060000
*                                                                       57150000
AFADAT70 XI    WKBITS,INCSW                                             57240000
         B     AFADAT20                                                 57330000
*/                                                                      57420000
*GET GDOA'S FOR UPDATE                                                  57510000
*                                                                       57600000
AFADAT75 EQU   *                                            D11 ZA15418 57690000
         LA    PARM,WKADDR                                              57780000
         L     REGFIFTN,STAT(ERRCD)  POINT TO STATUS TABLE  D11 ZA15418 57870000
         L     REGFIFTN,UPDH13(REGFIFTN) POINT TO IFFAHA13  D11 ZA15418 57960000
         BALR  RETURN,REGFIFTN       GOTO IFFAHA13          D11 ZA15418 58050000
* IFFAHA13 IS NOW CALLED VIA GSP LOGIC TO SAVE SYS OVERHEAD D11 ZA15418 58140000
         LTR   REGFIFTN,REGFIFTN                                        58230000
         BNE   AFAERR90                                                 58320000
         L     PARM,WKPARM             RESTORE PARAMETER POINTER        58410000
         B     AFADAT25                                                 58500000
         EJECT                                                          58590000
*THIS SECTION OF CODE IS ENTERED TWICE FOR EVERY LINE SEGMENT TO BE     58680000
*GENERATED. IT INCLUDES CALLS TO THE SCALE, SCISSOR(WHEN REQUESTED),    58770000
*AND DATA GENERATION ROUTINES.                                          58860000
         SPACE                                                          58950000
AFASSD10 LA    PARM,WKGDS                                               59040000
*/       CALL  SCALE                                                    59130000
*/                                                                      59220000
         L     REGFIFTN,STAT(ERRCD)     ADDRESS OF STATUS TABLE         59310000
         L     REGFIFTN,SCALE(REGFIFTN) ADDRESS OF SCALE                59400000
         BALR  RETURN,REGFIFTN          BRANCH TO SCALE                 59490000
         LTR   REGFIFTN,REGFIFTN                                        59580000
         BNE   AFARES10                                                 59670000
         TM    WKBITS+3,MEMSUB         TEST FOR BUFFER SUBROUTINE       59760000
         BO    AFASSD25                IF IS, NO SCISS, NO BEAM REPOS   59850000
         TM    GDSSCISS,NOSCISS                                         59940000
         BZ    AFASSD15                 BRANCH IF SCISSOR WANTED        60030000
*                                                                       60120000
*THESE VALUES ARE SET BY THE SCISSOR ROUTINE, SO ARE SET IN PSEGMT ONLY 60210000
*WHEN THERE IS TO BE NO SCISSORING                                      60300000
*                                                                       60390000
         MVC   GDSXLAST,WKXABS          * SET XLAST                     60480000
         L     PARM,WKXABS                                              60570000
         SH    PARM,GDSXCURR            RECOMPUTE INCREMENT AND PUT     60660000
         ST    PARM,WKXINCR              IN PARAMETER LIST              60750000
         MVC   GDSXCURR,WKXABS+2        *     XCURR                     60840000
         MVC   GDSYLAST,WKYABS          *     YLAST AND                 60930000
         L     PARM,WKYABS                                              61020000
         SH    PARM,GDSYCURR            RECOMPUTE INCREMENT AND PUT     61110000
         ST    PARM,WKYINCR              IN PARAMETER LIST              61200000
         MVC   GDSYCURR,WKYABS+2        *     YCURR IN GDSCB            61290000
         NI    GDSSCISS,LASTON                                          61380000
         B     AFASSD25                                                 61470000
*                                                                       61560000
*CALL TO SCISSOR ROUTINE                                                61650000
*                                                                       61740000
AFASSD15 LA    PARM,WKGDS                                               61830000
*/                                                                      61920000
*/       CALL  SCISSOR                                                  62010000
         L     REGFIFTN,STAT(ERRCD)     ADDRESS OF STATUS TABLE         62100000
         L     REGFIFTN,SCISS(REGFIFTN) ADDRESS OF SCISSOR              62190000
         BALR  RETURN,REGFIFTN          BRANCH TO SCISSOR               62280000
         LTR   REGFIFTN,REGFIFTN                                        62370000
         BZ    AFASSD20                 BRANCH IF SCISSOR RETURN OK     62460000
         C     REGFIFTN,FOUR                                            62550000
         BE    AFARES10                                                 62640000
         B     AFASSD30                 OTHERWISE SKIP CALL TO DATA GEN 62730000
         EJECT                                                          62820000
AFASSD20 TM    WKBITS+2,LASTIN                                          62910000
         BZ    AFASSD25                ALWAYS GENERATE FIRST VECTOR     63000000
         CLC   WKXINCR(8),ZERO          IF NO MOVEMENT                  63090000
         BE    AFASSD30                  BRANCH PAST CALL TO DATA GEN   63180000
*CALL TO DATA GENERATION ROUTINE                                        63270000
*                                                                       63360000
AFASSD25 LA    PARM,WKADDR                                              63450000
*/                                                                      63540000
*/       CALL  DATA GEN                                                 63630000
*/                                                                      63720000
         L     REGFIFTN,STAT(ERRCD)     ADDRESS OF STATUS TABLE         63810000
         L     REGFIFTN,DGEN(REGFIFTN)  ADDRESS OF DATA GEN             63900000
         BALR  RETURN,REGFIFTN          BRANCH TO DATA GEN              63990000
         LTR   REGFIFTN,REGFIFTN                                        64080000
         BNE   AFARES10                                                 64170000
         NI    WKBITS+2,SWOFF                                           64260000
         OI    WKBITS+2,NFNL            SET NOT FIRST NOT LAST SWITCH   64350000
         SPACE                                                          64440000
AFASSD30 BCT   COUNT,AFASET05          BRANCH IF MORE TO DO             64530000
         TM    WKBITS+2,LASTIN                                          64620000
         BZ    AFAERR80                BRANCH IF FIRST PASS SWITCH      64710000
*                                      STILL ON - NO DATA GENERATED     64800000
         BO    AFASSD50                B-&NCH &F L&00 &&-   &&          64890000
*                                      CALL DATA GEN AGAIN              64980000
         CLI   WKSWITCH,UPDATE                                          65070000
         BE    AFASSD80                 BRANCH IF UPDATE                65160000
         SPACE                                                          65250000
*PREPARE KEY                                                            65340000
*                                                                       65430000
         L     COUNT,GDSAOACB                                           65520000
         L     COUNT,CURRLOG(COUNT)    GET CURRENT LOGICAL ADDRESS      65610000
         SH    COUNT,WKADDR+2          COMPUTE ELEMENT LENGTH           65700000
         LTR   COUNT,COUNT                                              65790000
         BZ    AFAERR80                 ERROR IF NO DATA GENERATED      65880000
         STH   COUNT,WKADDR            PLACE LENGTH IN KEY              65970000
         L     COUNT,WKKEY                                              66060000
         LTR   COUNT,COUNT                                              66150000
         BE    AFASSD35                 BRANCH IF NO USER VARIABLE      66240000
         MVC   0(4,COUNT),WKADDR       PLACE KEY IN USER VARIABLE       66330000
AFASSD35 TM    WKBITS+2,KEYED+CORRE                                     66420000
         BZ    AFARET10                BRANCH IF NOT KEYED OR CORREL    66510000
*                                                                       66600000
*   PREPARE PARAM LIST                                                  66690000
         SPACE                                                          66780000
         LA    REGA,ONE                CODE FOR ADDING KEY TO TABLE     66870000
         ST    REGA,WKCODE                                              66960000
         LA    REGA,AFASSD40           SAVE RETURN ADDRESS              67050000
         ST    REGA,WKTEMP                                              67140000
         LA    REGA,WKADDR                                              67230000
         ST    REGA,WKKADDR                                             67320000
         B     AFAKEY10                                                 67410000
*                                                                       67500000
AFASSD40 LTR   REGFIFTN,REGFIFTN                                        67590000
         BNE   AFAERR90                 BRANCH IF NOT ENOUGH STORAGE    67680000
         SPACE                                                          67770000
AFARET10 CLI   WKSWITCH,UPDATE                                          67860000
         BNE   AFARET15                 BRANCH IF NOT UPDATE            67950000
         TM    GDSFLAGS,LEVEL2                                          68040000
         BO    AFARET15                BRANCH IF LEVEL 2-NO KEY TABLE   68130000
         L     PARM,WKSTORAD                                            68220000
         MVC   4(4,PARM),WKBITS        MOVE IN NEW KEY SWITCHES         68310000
         TM    WKBITS+2,CORRE                                           68400000
         BZ    AFARET15                 BRANCH IF NO CORRVAL            68490000
         MVC   8(4,PARM),WKCORVL        MOVE IN NEW CORRVAL             68580000
AFARET15 MVC   GDSDATMD(1),WKSWAREA+1   RESTORE DATA MODE SWITCH        68670000
AFARET17 L     SAVE,4(SAVE)                                             68760000
AFARET20 RETURN (14,12),T                                               68850000
         SPACE 2                                                        68940000
AFASSD50 OI  WKBITS+2,REPONLY          SET FLAG TO GENERATE REPOS VECT  69030000
         XC    WKDATA1(32),WKDATA1                                      69120000
         MVC   WKXABS+2(2),GDSXCURR    PLACE CURRENT BEAM POSITION      69210000
         MVC   WKYABS+2(2),GDSYCURR    FROM GDS INTO PARAMETER LIST     69300000
         LA    COUNT,1                 RESET COUNT REGISTER             69390000
         B     AFASSD25                CALL DATA GEN AGAIN              69480000
         EJECT                                                          69570000
*CALL DATA STORE TO WRITE OUT UPDATE                                    69660000
*                                                                       69750000
*WRITE OUT UPDATE                                                       69840000
*                                                                       69930000
AFASSD80 LA    PARM,WKADDR                                              70020000
         L     REGFIFTN,STAT(ERRCD) POINT TO STATUS TABLE   D11 ZA15418 70110000
         L     REGFIFTN,UPDH14(REGFIFTN) AND TO IFFAHA14    D11 ZA15418 70200000
         BALR  RETURN,REGFIFTN     GOTO IFFAHA14            D11 ZA15418 70290000
* IFFAHA14 IS NOW CALLED VIA GSP LOGIC TO AVOID SYS OVRHD   D11 ZA15418 70380000
         B     AFARET10                                                 70470000
         SPACE                                                          70560000
*                                                                       70650000
*LINKAGE TO KEY MANAGEMENT ROUTINE                                      70740000
*                                                                       70830000
AFAKEY10 ST    GDSREG,WKGDS1                                            70920000
         LA    PARM,WKGDS1                                              71010000
         L     REGA,GDSGTMCB       GET POINTER TO GTMCB            000A 71100000
         L     REGA,4(REGA)        GET POINTER TO GSPCB            000A 71190000
         L     REGA,FE(REGA)       GET POINTER TO STATUS TABLE     000A 71280000
         L     REGFIFTN,ETE(REGA)  GET ADRS OF KEY TABLE MGMT      000A 71370000
         BALR  RETURN,REGFIFTN     BRANCH TO KEY TABLE MGMT        000A 71460000
         L     RETURN,WKTEMP            PICK UP RETURN ADDRESS          71550000
         BR    RETURN                                                   71640000
         EJECT                                                          71730000
*THIS SECTION IS ENTERED ON RETURN FROM THE DATA GENERATION ROUTINE   * 71820000
*WHEN DATA REMAINS TO BE GENERATED. THE DATA AREA IN THE PARAMETER    * 71910000
*LIST IS ZEROED, AND THE BEAM OFF/ON SWITCH IS FLIPPED. THE X AND Y   * 72000000
*VALUES TO BE USED (X AN Y START IF THE BEAM IS OFF, AND X AND Y END  * 72090000
*IF THE BEAM IS ON) ARE UPDATED AND PLACED IN THE PARAMETER LIST        72180000
*                                                                       72270000
*RESETTING AND INITIALIZATION                                           72360000
*                                                                       72450000
AFASET05 XC    WKDATA1(32),WKDATA1      ZERO DATA FIELDS IN PARM LIST   72540000
         XI    WKBITS+2,BEAMSW          FLIP BEAM OFF/ON SWITCH         72630000
         LA    LOOPCT,2                 SET UP LOOP CONTROL FOR UPDATE  72720000
*                                                                       72810000
*INITIALIZE FOR FIRST PASS- X ENTRY                                     72900000
*                                                                       72990000
         SR    REGB,REGB                INDEX TO PARM LIST, FOR X=0     73080000
         MVC   WKSWAREA(1),WKSWITCH+3   MOVE DATA MODE SWITCH TO WORK   73170000
         NI    WKSWAREA,NOY              AREA AND ELIMINATE Y SWITCHES  73260000
         TM    WKBITS+2,BEAMSW                                          73350000
         BO    AFASET10                 BRANCH IF X AND Y END VALUES    73440000
*                                        TO BE USED                     73530000
*INITIALIZE FOR X-Y START VALUES                                        73620000
         SR    REGD,REGD                INDEX TO WKAREAS =0 FOR X START 73710000
         LA    REGC,WKSWITCH+1          SWITCH ADDRESS FOR X-Y START    73800000
         B     AFASET15                 GO TO PROCESS                   73890000
*                                                                       73980000
*INITIALIZE FOR X-Y END VALUES                                          74070000
*                                                                       74160000
AFASET10 LA    REGD,8                   INDEX TO WKAREAS=8 FOR X END    74250000
         LA    REGC,WKSWITCH+2          SWITCH ADDRESS FOR X-Y END      74340000
*                                                                       74430000
*LOOPCT= LOOP CONTROL INFORMATION                                       74520000
*REGB  = INDEX TO VALUES IN PARM LIST                                   74610000
*REGC  = ADDRESS OF SWITCH AREA                                         74700000
*REGD  = INDEX TO WORK AREA                                             74790000
*                                                                       74880000
AFASET15 TM    0(REGC),XINDX                                            74970000
         BZ    AFASET50                 BRANCH IF INCREMENT PARM PASSED 75060000
         EJECT                                                          75150000
*THIS SECTION ENTERED WHEN INDEX PARAMETER PASSED                       75240000
*                                                                       75330000
AFASET20 L     REGA,WKXVAL(REGD)        PICK UP POINTER TO DATA         75420000
         TM    WKSWAREA+2,ON                                            75510000
         BZ    AFASET90                 BRANCH IF 1ST TIME X-Y END USED 75600000
         A     REGA,WKXCHNG(REGD)       OTHERWISE, UPDATE POINTER       75690000
         ST    REGA,WKXVAL(REGD)         AND SAVE IT                    75780000
         TM    WKSWAREA,ABSOLXY                                         75870000
         BZ    AFASET95                 BRANCH IF DATA MODE INCREMENTAL 75960000
AFASET25 LA    REGB,WKXABS(REGB)        GET POINTER TO PARM LIST ENTRY  76050000
         MVC   0(4,REGB),0(REGA)        MOVE VALUE INTO PARM LIST       76140000
AFASET30 BCT   LOOPCT,AFASET40          *                               76230000
*                                                                       76320000
*X AND Y VALUES NOW UPDATED                                             76410000
         C     COUNT,ONE                                                76500000
         BE    AFASET35                 BRANCH IF LAST CALL TO DATA GEN 76590000
         OI    WKSWAREA+2,ON           SET SWITCH 1ST X,Y END USED      76680000
         B     AFASSD10                                                 76770000
*                                                                       76860000
AFASET35 TM    WKBITS+2,LASTIN                                          76950000
         BZ    AFASET37      BRANCH IF NO DATA GENERATED YET            77040000
         OI    WKBITS+2,LASTIN         SET LAST PASS SWITCH             77130000
         B     AFASSD10                                                 77220000
AFASET37 XI    WKBITS,MULT             MULT ENTRY HAS BECOME SINGLE     77310000
         B     AFASSD10                                                 77400000
         EJECT                                                          77490000
*INITIALIZATION FOR SECOND PASS THROUGH LOOP (Y VALUES)                 77580000
*                                                                       77670000
AFASET40 LA    REGB,4                   IX VALUE FOR PARM LIST=4 FOR Y  77760000
         AR    REGD,REGB                IX TO WK AREA FOR Y=4 PLUS X IX 77850000
*                                       SWITCH ADDR (REG C) REMAINS     77940000
         MVC   WKSWAREA(1),WKSWITCH+3   MOVE DATA MODE SWITCH AND       78030000
         NI    WKSWAREA,NOX              ELIMINATE ANY X SWITCHES       78120000
         TM    0(REGC),YINDX                                            78210000
         BZ    AFASET50                 BRANCH IF INCREMENT PARM PASSED 78300000
         B     AFASET20                                                 78390000
         EJECT                                                          78480000
*INCREMENT PARAMETER PASSED, DATA MODE ABSOLUTE OR INCREMENTAL          78570000
*                                                                       78660000
AFASET50 TM    WKSWAREA+2,ON                                            78750000
         BZ    AFASET60                 BRANCH IF 1ST TIME X-Y END USED 78840000
         TM    WKSWAREA,ABSOLXY                                         78930000
         BZ    AFASET65                 BRANCH IF DATA MODE INCREMENTAL 79020000
         TM    WKSWAREA,REALX+REALY                                     79110000
         BM    AFASET55                 BRANCH IF INCREMENT REAL        79200000
         L     REGA,WKXVAL(REGD)                                        79290000
         A     REGA,WKXCHNG(REGD)       ADD INCREMENT                   79380000
         ST    REGA,WKXVAL(REGD)        SAVE NEW VALUE AND              79470000
AFASET52 ST    REGA,WKXABS(REGB)         PLACE IT IN PARM LIST          79560000
         B     AFASET30                 RETURN TO CHECK LOOP COUNT      79650000
*                                                                       79740000
*INCREMENT VALUE REAL                                                   79830000
         SPACE                                                          79920000
AFASET55 LE    FLT2,WKXVAL(REGD)                                        80010000
         AE    FLT2,WKXCHNG(REGD)       ADD INCREMENT                   80100000
         STE   FLT2,WKXVAL(REGD)        SAVE NEW VALUE AND              80190000
         STE   FLT2,WKXABS(REGB)         PLACE IT IN PARAMETER LIST     80280000
         B     AFASET30                 RETURN TO CHECK LOOP COUNT      80370000
*                                                                       80460000
* X OR Y END INCREMENTED, FIRST TIME REFERENCED                         80550000
         SPACE                                                          80640000
AFASET60 L     REGA,WKXVAL(REGD)        PICK UP VALUE                   80730000
         TM    WKSWAREA,ABSOLXY                                         80820000
         BM    AFASET52                 BRANCH IF DATA MODE ABSOLUTE    80910000
         ST    REGA,WKXINCR(REGB)      PLACE INCR IN PARM LIST          81000000
         B     AFASET30                 RETURN TO CHECK LOOP COUNT      81090000
*                                                                       81180000
*DATA MODE INCREMENTAL, INCREMENT PARAMETER PASSED                      81270000
*                                                                       81360000
AFASET65 L     REGA,WKXCHNG(REGD)                                       81450000
         ST    REGA,WKTEMP                                              81540000
         B     AFASUB10                                                 81630000
         SPACE                                                          81720000
* X OR Y END INDEXED, FIRST TIME REFERENCED                             81810000
*                                                                       81900000
AFASET90 TM    WKSWAREA,ABSOLXY                                         81990000
         BM    AFASET25                 BRANCH IF DATA MODE ABSOLUTE    82080000
         LA    REGB,WKXINCR(REGB)       GET POINTER TO PARM LIST ENTRY  82170000
         MVC   0(4,REGB),0(REGA)        PLACE VALUE IN PARM LIST        82260000
         B     AFASET30                                                 82350000
*                                                                       82440000
*X OR Y INDEXED, DATA MODE INCREMENTAL                                  82530000
*                                                                       82620000
AFASET95 MVC   WKTEMP,0(REGA)           MOVE INCREMENT INTO WORK AREA   82710000
         B     AFASUB10                 GO TO COMPUTE INCREMENT         82800000
         EJECT                                                          82890000
*THIS ROUTINE COMPUTES THE INCREMENT TO BE PASSED TO THE SCALE          82980000
*ROUTINE. IT EXPECTS WKTEMP TO HOLD THE INCREMENT, AND THE VARIOUS      83070000
*REGISTERS AS SET UP- REGB-INDEX TO PARAMETER LIST, REGD-INDEX TO       83160000
*WORK AREAS, AND REGC-SWITCH ADDRESS. REGISTER 15 IS USED AS A          83250000
*WORK REGISTER                                                          83340000
*                                                                       83430000
AFASUB10 LR    REGFIFTN,REGD                                            83520000
         C     REGFIFTN,EIGHT                                           83610000
         BL    AFASUB50                 BRANCH IF UPDATING X OR Y START 83700000
         S     REGFIFTN,EIGHT           ESTABLISH IX TO X OR Y START    83790000
AFASUB15 TM    WKSWAREA,REALX+REALY                                     83880000
         BM    AFASUB60                 BRANCH IF FLOATING POINT        83970000
         L     REGA,WKTEMP              PICK UP INCREMENT               84060000
         A     REGA,WKXTOT(REGD)         ADD TO CUMULATIVE POSITION     84150000
         ST    REGA,WKXTOT(REGD)         AND SAVE NEW TOTAL             84240000
         S     REGA,WKXTOT(REGFIFTN)    FIND DIFFERENCE FROM LAST POSIT 84330000
         ST    REGA,WKXINCR(REGB)      AND SAVE IN PARM LIST            84420000
         B     AFASET30                 RETURN TO CHECK LOOP COUNT      84510000
*                                                                       84600000
AFASUB50 LA    REGFIFTN,8(REGFIFTN)     ESTABLISH INDEX TO X OR Y END   84690000
         B     AFASUB15                                                 84780000
*                                                                       84870000
*INCREMENT REAL NUMBER                                                  84960000
*                                                                       85050000
AFASUB60 LE    FLT2,WKTEMP             PICK UP INCREMENT                85140000
         AE    FLT2,WKXTOT(REGD)         ADD TO CUMULATIVE POAITION     85230000
         STE   FLT2,WKXTOT(REGD)         AND SAVE NEW TOTAL             85320000
         SE    FLT2,WKXTOT(REGFIFTN)    COMPUTE INCREMENT               85410000
         STE   FLT2,WKXINCR(REGB)        AND PUT IN PARAMETER LIST      85500000
         B     AFASET30                 RETURN TO CHECK LOOP COUNT      85590000
         EJECT                                                          85680000
AFAERR10 MVC   PARMERR(4,ERRCD),ONE     GDS INVALID                     85770000
         OI     0(ERRCD),PRM                                            85860000
         B     AFARET17                                                 85950000
*                                                                       86040000
AFAERR20 OI    0(ERRCD),PRM             PARAMETER ERROR                 86130000
         B     AFARET15                                                 86220000
*                                                                       86310000
AFAERR30 MVC   PARMERR(4,ERRCD),EIGHT   GENCODE ERROR                   86400000
         B     AFAERR20                                                 86490000
*                                                                       86580000
AFAERR40 MVC   PARMERR(4,ERRCD),SIX     CORRVAL ERROR                   86670000
         B     AFAERR20                                                 86760000
*                                                                       86850000
AFAERR70 MVC   PARMERR(4,ERRCD),NINE    COUNT ERROR                     86940000
AFAERR80 OI    0(ERRCD),SCISSOR         NO DATA GENERATION              87030000
         B     AFARET15                                                 87120000
*                                                                       87210000
AFAERR90 OI    0(ERRCD),STRG            MAIN STORAGE EXCEEDED           87300000
         MVC   STOR(4,ERRCD),FOUR                                       87390000
         B     AFARES10                                                 87480000
*                                                                       87570000
*CALL RESET IF ERROR RETURN FROM SCALE OR DATA GEN                      87660000
*                                                                       87750000
AFARES10 MVC   GDSXCURR(4),WKXCURR      RESTORE BEAM POINTERS           87840000
         MVC   GDSXLAST(8),WKXLAST                                      87930000
         CLI   WKSWITCH,UPDATE                                          88020000
         BE    AFARET15                BRANCH IF UPDATE-RESET NOT       88110000
*                                       NECESSARY                       88200000
         MVC   WKDATA2(20),0(ERRCD)     SAVE RETURN ARRAY               88290000
         LA    REGA,GDSGDSCB            VAR HOLDING ADDR OF GDSCB       88380000
         ST    REGA,WKGDS                                               88470000
         LA    REGA,WKGDS               ADDRESS OF PARAMETER LIST       88560000
         ST    REGA,WKGDS1               STORED IN WORK AREA            88650000
         L     REGA,NULL(ERRCD)         NULL FOR CORRVAL IN PARM LIST   88740000
         ST    REGA,WKRTN                                               88830000
         LA    REGA,WKADDR              ADDRESS OF KEY IN PARM LIST     88920000
         ST    REGA,WKDATA1                                             89010000
         OI    WKDATA1,LAST             LAST PARM INDICATION            89100000
         ST    ERRCD,WKCODE             ADDRESS OF RETURN ARRAY         89190000
         LA    PARM,WKGDS1              ADDRESS OF WORK AREA            89280000
         L     REGA,16                                                  89370000
         L     REGA,CVTLINK(REGA)       LINK LIB DCB                    89460000
*      LINK EP=IFFAFA12,DCB=(REGA),MF=(E,(1)),SF=(E,WKSPVSR)            89550000
         LINK  EP=IFFAFA12,MF=(E,(1)),SF=(E,WKSPVSR)                    89640000
         MVC   0(20,ERRCD),WKDATA2      RESTORE RETURN ARRAY            89730000
         B     AFARET15                                                 89820000
         EJECT                                                          89910000
*CONSTANTS                                                              90000000
*                                                                       90090000
ZERO     DC    2F'0'                                                    90180000
ONE      DC    F'1'                                                     90270000
TWO      DC    F'2'                                                     90360000
THREE    DC    F'3'                                                     90450000
FOUR     DC    F'4'                                                     90540000
FIVE     DC    F'5'                                                     90630000
SIX      DC    F'6'                                                     90720000
SEVEN    DC    F'7'                                                     90810000
EIGHT    DC    F'8'                                                     90900000
NINE     DC    F'9'                                                     90990000
BITS     DC    B'10000111'              MULTIPLE,VECTOR,INCLUDE,        91080000
         DC    X'00'                     OPTIMIZED, FIRST PASS, NO KEY, 91170000
         DC    B'00000000'               NO CORRVAL, BEAM OFF           91260000
         DC    X'00'                                                    91350000
PATCH    DC    64X'FF'             PATCH AREA               D11         91440000
         EJECT                                                          91530000
WORKAREA DSECT                                                          91620000
WKPARM   DS    F                        ADDRESS OF PARAMETER LIST       91710000
WKRTNCD  DS    F                        ADDRESS OF RETURN ARRAY         91800000
WKSAVE   DS    18F                      REGISTER SAVE AREA              91890000
WKSWITCH DS    F                                                        91980000
*                                       BYTE 0 - UPDATE SWITCH          92070000
*                                       BYTE 1                          92160000
*                                          X'C0' - X INDEX              92250000
*                                          X'0C' - Y INDEX              92340000
*                                          X'30' - X INCREMENT          92430000
*                                          X'03' - Y INCREMENT          92520000
*                                       BYTE 2                          92610000
*                                          X'C0' - X2 INDEX             92700000
*                                          X'0C' - Y2 INDEX             92790000
*                                          X'30' - X2 INCREMENT         92880000
*                                          X'03' - Y2 INCREMENT         92970000
*                                       BYTE 3   - COPY OF INPUT DATA   93060000
*                                          MODE SWITCH FROM GDSCB       93150000
WKSWAREA DS    F                                                        93240000
WKSPVSR  DS    3F                                                       93330000
WKSTORAD DS    F                                                        93420000
WKTEMP   DS    F                                                        93510000
WKXCHNG  DS    F                                                        93600000
WKYCHNG  DS    F                                                        93690000
WKXCHNG2 DS    F                                                        93780000
WKYCHNG2 DS    F                                                        93870000
WKXVAL   DS    F                                                        93960000
WKYVAL   DS    F                                                        94050000
WKXVAL2  DS    F                                                        94140000
WKYVAL2  DS    F                                                        94230000
WKXTOT   DS    F                                                        94320000
WKYTOT   DS    F                                                        94410000
WKXTOT2  DS    F                                                        94500000
WKYTOT2  DS    F                                                        94590000
WKXCURR  DS    H                        *                               94680000
WKYCURR  DS    H                        *SAVE AREA FOR INFORMATION      94770000
WKXLAST  DS    F                        *  FROM GDSCB                   94860000
WKYLAST  DS    F                        *                               94950000
* START OF PARAMETER LIST PASSED TO DATA GENERATION ROUTINE             95040000
*                                                                       95130000
WKADDR   DS    F                        BUFFER LENGTH & LOG. BUFF ADDR  95220000
WKBITS   DS    F                        SWITCHES                        95310000
WKCORVL  DS    F                        CORRVAL                         95400000
WKKEY    DS    F                        KEY                             95490000
* START OF PARAMETER LIST PASSED TO SCALING AND SCISSORING ROUTINES     95580000
WKGDS    DS    F                        ADDRESS OF GDSCB                95670000
WKRTN    DS    F                        ADDRESS OF RETURN ARRAY         95760000
WKDATA1  DS    F                            *                           95850000
WKDATA2  DS    F                            *                           95940000
WKDATA3  DS    F                            *                           96030000
WKDATA4  DS    F                        DATA ARRAY                      96120000
WKXABS   DS    F                            *                           96210000
WKYABS   DS    F                            *                           96300000
WKXINCR  DS    F                            *                           96390000
WKYINCR  DS    F                            *                           96480000
WKTOTX   DS    F                        X INCREMENT THUS FAR            96570000
WKTOTY   DS    F                        Y INCREMENT THUS FAR            96660000
WKENDCT  DS    F                                                        96750000
* PARAMETERS FOR KEY MANAGEMENT ROUTINE                                 96840000
WKGDS1   DS    F                        ADDRESS OF GDSCB                96930000
WKCODE   DS    F                        CODE FOR KEY MANAGEMENT         97020000
WKKADDR  DS    F                        ADDRESS OF KEY                  97110000
         COPY  GDSCB                                                    97200000
         COPY  GTMCB                                                    97290000
         END                                                            97380000
