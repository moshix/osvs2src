*TITLE         PLSTR- PLOT STROKES                                    * 00320021
*                                                                     * 00400021
*MODULE NAME   IFFAGA06                                               * 00480021
*                                                                     * 00560021
*FUNCTION/OPERATION                                                   * 00640021
*  TRANSLATES STROKE TABLE ENTRIES INTO CHARACTERS ON THE SCREEN,     * 00720021
*  OF A SIZE AND AT AN ORIENTATION DETERMINED BY THE PARAMETERS       * 00800021
*  PASSED. THE STROKE TABLE ENTRIES REFERENCED ARE GOVERNED BY THE    * 00880021
*  VALUE OF THE EBCDIC TEXT GIVEN AS INPUT.                           * 00960021
*                                                                     * 01040021
*ENTRY POINT   IFFAGA06 - CSECT NAME                                  * 01120021
*                                                                     * 01200021
*INPUT  REGISTER 1 CONTAINS THE ADDRESS OF A WORK/SAVE AREA. THE FIRST* 01280021
*  WORD CONTAINS THE ADDRESS OF THE PARAMETER LIST ON A FULL WORD     * 01360021
*  BOUNDARY. THE NULL VARIABLE IS AT AN OFFSET OF 20 FROM THE RETURN  * 01440021
*  ARRAY, AND THE ADDRESS OF THE STATUS TABLE IS AT AN OFFSET OF 24   * 01520021
*  FROM THE RETURN ARRAY.                                             * 01600021
*FORMAT OF PARAMETER LIST                                             * 01680021
* REQUIRED PARAMETERS                                                 * 01760021
*                                                                     * 01840021
*  +0    A(VAR)          ADDRESS OF A VARIABLE WHICH CONTAINS THE     * 01920021
*                        GDSCB ADDRESS                                * 02000021
*  +4    A(TABLE ID)     ADDRESS OF AN INTEGER VALUE FROM 1-99 WHICH  * 02080021
*                        IDENTIFIES THE STROKE TABLE REFERENCED.      * 02160021
*  +8    A(TEXT)         ADDRESS OF AN ARRAY CONTAINING THE           * 02240021
*                        CHARACTERS TO BE GENERATED                   * 02320021
*  +12   A(COUNT)        ADDRESS OF THE COUNT OF THE NUMBER OF        * 02400021
*                        CHARACTERS TO BE GENERATED, THE COUNT IS     * 02480021
*                        POSITIVE IF THERE ARE14 CHARACTERS PER WORD  * 02560021
*                        IN THE TEXT ARRAY, AND NEGATIVE IS THERE     * 02640021
*                        IS 1 CHARACTER/PER WORD (RIGHT ALIGNED).     * 02720021
*  +16   A(HEIGHT)       ADDRESS OF HEIGHT IN INCHES OF THE CHARACTERS* 02800021
*                        (MINIMUM = 1/8 INCH)                         * 02880021
*  OPTIONAL PARAMETERS                                                * 02960021
*                                                                     * 03040021
*  +20   A(WIDTH)        ADDRESS OF WIDTH IN INCHES OF THE CHARACTERS.* 03120021
*                        (MINIMUM = 1/8 INCH)                         * 03200021
*  +24   A(SPACING)      ADDRESS OF SPACE IN INCHES FROM CENTER OF    * 03280021
*                        ONE CHARACTER TO CENTER OF NEXT.             * 03360021
*  +28   A(ORIENTATION)  ADDRESS OF A FOUR WORD ARRAY                 * 03440021
*                          WORD 1= SINE OF ANGLE OF ROTATION FROM     * 03520021
*                                  POSITIVE X AXIS OF CHARACTER.      * 03600021
*                          WORD 2= COSINE OF ANGLE OF ROTATION FROM   * 03680021
*                                  POSITIVE X AXIS OF CHARACTER       * 03760021
*                          WORD 3= SINE OF ANGLE OF ROTATION FROM     * 03840021
*                                  POSITIVE X AXIS OF CHARACTER STRING* 03920021
*                          WORD 4= COSINE OF ANGLE OF ROTATION FROM   * 04000021
*                                  POSITIVE X AXIS OF CHARACTER STRING* 04080021
*  +36   A(CORRVAL)      ADDRESS OF CORRELATION VALUE.                * 04160021
*                                                                     * 04240021
*  +40   A(KEY)          ADDRESS OF USER KEY VARIABLE.                * 04320021
*                                                                     * 04400021
*  +44   A(GENCODE)      ADDRESS OF THE CODE WHICH SPECIFIED THE TYPE * 04480021
*                        OF OUTPUT - EITHER INCLUDE,OMIT OR UPDATE    * 04560021
*  +48   A(X COR)        ADDRESS OF THE X VALUE TO WHICH THE BEAM IS  * 04640021
*                        TO BE POSITIONED.                            * 04720021
*  +52   A(Y COR)        ADDRESS OF THE Y VALUE TO WHICH THE BEAM IS  * 04800021
*                        TO BE POSITIONED.                            * 04880021
*                                                                     * 04960021
*NOTE: HEIGHT, WIDTH, SPACING, AND THE CONTENTS OF THE ORIENTATION    * 05040021
*      ARRAY ARE ALL REAL VALUES.                                     * 05120021
*                                                                     * 05200021
*OUTPUT  NONE TO CALLER. THE DATA WILL BE SCISSORED AND IF IT APPEARS * 05280021
*  ON THE SCREEN ORDERS WILL BE GENERATED FOR IT IN THE GDOA.         * 05360021
*                                                                     * 05440021
*EXTERNAL ROUTINES                                                    * 05520021
*  IFFAFA12 - RESET                                                     05600021
*  IFFAHA03    KEY TABLE MANAGEMENT                                   * 05680021
*  IFFAHA04    DATA GENERATION                                        * 05760021
*  IFFAHA05    DATA STORE                                             * 05840021
*  IFFAHA06    SCALE     TO SCALE X,Y PARAMETERS IF PASSED.           * 05920021
*  IFFAHA07    SCISSOR                                                * 06000021
*  IFFAHA13    GET GDOA'S FOR UPDATE                                  * 06080021
*  IFFAHA14    WRITE OUT UPDATE                                       * 06160021
*                                                                     * 06240021
*EXITS - NORMAL- BACK TO CALLER VIA REGISTER 14                       * 06320021
*        ERROR - BACK TO CALLER VIA REGISTER 14                       * 06400021
*  APPRORIATE CODES ARE SET IN THE RETURN ARRAY- SEE GSPARRAY         * 06480021
*NOTE: IF THE STROKE TABLE REFERENCED CANNOT BE LOCATED, AN ABEND     * 06560021
*      WILL BE CAUSED BY THE OPERATING SYSTEM                         * 06640021
*                                                                     * 06720021
*TABLES/WORKAREAS   - SEE WORKAREA DSECT                              * 06800021
*                                                                     * 06880021
*ATTRIBUTES         - REENTRANT, PROBLEM PROGRAM MODE                 * 06960021
*                                                                     * 07040021
*********************************************************************** 07120021
         EJECT                                                          07200021
IFFAGA06 CSECT                          PLSTR                           07280021
*A779700-779900,946100-946300                                    A29395 07290021
*A779904                                                         F40704 07292021
*C388800                                                         A30726 07294021
*0874,200800                                                       9326 07300021
*2239,379200-384800                                                000A 07320021
*D792200-792400                                                  YM1963 07330000
         SPACE 4                                                        07360021
*REGISTERS                                                              07440021
RZERO    EQU   0                                                        07520021
PARM     EQU   1                                                        07600021
REGA     EQU   2                                                        07680021
REGB     EQU   3                                                        07760021
ERRCD    EQU   4                                                        07840021
WORK     EQU   5                                                        07920021
GSPREG   EQU   6                                                        08000021
REGD     EQU   6                                                        08080021
GTMREG   EQU   7                                                        08160021
REGE     EQU   7                                                        08240021
GDSREG   EQU   8                                                        08320021
BASE     EQU   9                                                        08400021
REGC     EQU   10                                                       08480021
COUNT    EQU   11                                                       08560021
SAVE     EQU   13                                                       08640021
RETREG   EQU   14                                                       08720021
BRANCH   EQU   15                                                       08800021
FE       EQU   48                                                  000A 08820021
ETE      EQU   828                                                 000A 08840021
         SPACE 2                                                        08880021
FLT0     EQU   0                                                        08960021
FLT2     EQU   2                                                        09040021
FLT4     EQU   4                                                        09120021
FLT6     EQU   6                                                        09200021
         EJECT                                                          09280021
*PARAMETER LIST DISPLACEMENTS                                           09360021
*                                                                       09440021
GDS      EQU   0                        ADDR OF GDSCB VARIABLE          09520021
TAB      EQU   4                        ADDR OF TABLE IDENTIFIER        09600021
TEXT     EQU   8                        ADDRESS OF ARRAY                09680021
CT       EQU   12                                                       09760021
HGT      EQU   16                                                       09840021
*                                                                       09920021
*THE FOLLOWING ARE OPTIONAL PARAMETERS                                  10000021
*                                                                       10080021
WIDTH    EQU   20                       ADDR OF WIDTH OF CHAR           10160021
SPACING  EQU   24                                                       10240021
ORIENT   EQU   28                       ADDR OF ARRAY                   10320021
COR      EQU   32                       ADDR OF CORRVAL                 10400021
KEY      EQU   36                                                       10480021
GEN      EQU   40                                                       10560021
XCOR     EQU   44                                                       10640021
YCOR     EQU   48                                                       10720021
STOR     EQU   12                                                       10880021
PARMERR  EQU   16                                                       10960021
NULL     EQU   20                                                       11040021
NL       EQU   21                                                       11120021
CURRLOG  EQU   52                                                       11200021
STAT     EQU   24                                                       11280021
DGEN     EQU   840                                                      11360021
CVRT     EQU   924                                                      11440021
DSTORE   EQU   852                                                      11520021
SCISS    EQU   876                                                      11600021
SCALE    EQU   864                                                      11680021
CVTLINK  EQU   8                                                        11760021
ID       EQU   0                        DISPLACEMENTS FOR STROKE TABLE  11840021
NEXTAB   EQU   4                             *                          11920021
ADDR     EQU   8                             *                          12000021
         EJECT                                                          12080021
*SWITCHES                                                               12160021
REPONLY  EQU   X'02'                                                    12240021
OPT      EQU   X'04'                    OUTPUT MODE SWITCHES            12320021
INC      EQU   X'01'                         *                          12400021
ABSSW    EQU   X'03'                         *                          12480021
INCSW    EQU   X'02'                         *                          12560021
YABS     EQU   X'0A'                                                    12640021
XABS     EQU   X'A0'                                                    12720021
NOSCISS  EQU   X'10'                                                    12800021
LASTON   EQU   X'1F'                                                    12880021
NEG      EQU   X'80'                                                    12960021
BLANK    EQU   X'80'                                                    13040021
RESOL    EQU   X'02'                                                    13120021
BEAMON   EQU   X'08'                                                    13200021
NFNL     EQU   X'40'                                                    13280021
LASTT    EQU   X'C0'                                                    13360021
BOFF     EQU   X'F7'                                                    13440021
LASSTR   EQU   X'80'                                                    13520021
MULT     EQU   X'80'                                                    13600021
SWOFF    EQU   X'3F'                                                    13680021
OFF      EQU   X'00'                                                    13760021
XSIGN    EQU   X'F0'                                                    13840021
XFOUR    EQU   X'FC'                                                    13880021
*                                                                       13920021
PRM      EQU   X'08'                                                    14000021
LAST     EQU   X'80'                                                    14080021
IX       EQU   X'04'                                                    14160021
STRG     EQU   X'10'                                                    14240021
SCISSOR  EQU   X'40'                                                    14320021
LEVEL2   EQU   X'10'                                                    14400021
OMIT     EQU   X'FB'                                                    14480021
KEYED    EQU   X'20'                                                    14560021
CORRE    EQU   X'10'                                                    14640021
SUBR     EQU   X'02'                                                    14720021
INCLUDE  EQU   X'04'                                                    14800021
UPDATE   EQU   X'FF'                                                    14880021
MEMSUB   EQU   X'80'                                                    14960021
MEMSEQ   EQU   X'40'                                                    15040021
SEQ      EQU   X'04'                                                    15120021
XREALI   EQU   X'40'                                                    15200021
REALX    EQU   X'C0'                                                    15280021
REALY    EQU   X'0C'                                                    15360021
YREALI   EQU   X'04'                                                    15440021
XINTGI   EQU   X'10'                                                    15520021
YINTGI   EQU   X'01'                                                    15600021
POS      EQU   X'11'                                                    15680021
X        EQU   X'01'                                                    15760021
Y        EQU   X'10'                                                    15840021
*BRANCHING CONDITION                                                    15920021
PLUS     EQU   2                                                        16000021
ZORM     EQU   12                       BRANCH ON ZERO OR MINUS         16080021
         EJECT                                                          16160021
*                                                                       16240021
*THIS CODE ESTABLISHES ADDRESSABILITY FOR IFFAGA06, FOR THE GDSCB AND   16320021
*FOR THE WORKAREA. THE RETURN ARRAY IS SET TO ZERO, AND THE SAVE AREAS  16400021
*ARE CHAINED.                                                           16480021
*                                                                       16560021
         USING *,15                                                     16640021
         SAVE  (14,12)                                                  16720021
         DROP  15                                                       16800021
         LR    BASE,15                  LOAD CSECT BASE                 16880021
         USING IFFAGA06,BASE                                            16960021
         LR    WORK,PARM                LOAD WORKAREA BASE              17040021
         USING WORKAREA,WORK                                            17120021
         XC    WKSWITCH(4),WKSWITCH                                     17200021
         XC    WKSPVSR(12),WKSPVSR                                      17280021
         L     PARM,WKPARM              LOAD PARAMETER LIST ADDRESS     17360021
         L     ERRCD,WKRTNCD            LOAD ADDRESS OF RETURN ARRAY    17440021
         XC    0(20,ERRCD),0(ERRCD)     ZERO RETURN ARRAY               17520021
         L     GDSREG,GDS(PARM)        GET ADDR OF ARG 1                17650021
         L     GDSREG,0(GDSREG)         ADDRESS OF GDSCB                17680021
         USING GDSCB,GDSREG                                             17760021
         LA    REGA,WKSAVE              CHAIN SAVE AREAS                17840021
         ST    REGA,8(SAVE)                                             17920021
         ST    SAVE,4(REGA)                                             18000021
         LR    SAVE,REGA                REG 13 CONTAINS SAVE AREA ADDR  18080021
         EJECT                                                          18120021
*                                                                       18160021
*THE GDSCB PASSED IS CHECKED FOR VALIDITY, AND IF IT IS VALID, A        18240021
*SKELETON PARAMETER LIST FOR DATA GENERATION IS SET UP, WITH SWITCHES   18320021
*INITIALIZED TO MULTIPLE ENTRY, OUTPUT TYPE=VECTOR, STATUS=INCLUDE,     18400021
*OUTPUT=OPTIMIZED, FIRST ENTRY, NOT KEYED, NOT CORRVALLED, BEAM OFF.    18480021
*SWITCHES ARE SET IN THE KEY IF ELEMENT IS A SEQUENCE MEMBER AND/OR     18560021
*PART OF A BUFFER SUBROUTINE.                                           18640021
*                                                                       18720021
         C     GDSREG,GDSGDSCB                                          18800021
         BNE   AGAERR10                 BRANCH IF INVALID GDSCB         18880021
         MVC   WKSWITCH+2(1),GDSDATMD   SAVE DATA MODE SWITCH           18960021
         MVC   WKXLAST(8),GDSXLAST      SAVE X-Y LAST VALUE             19040021
         MVC   WKXCURR(4),GDSXCURR                                      19120021
         XC    WKADDR(68),WKADDR        ZERO PARAMETER FIELDS           19200021
         MVC   WKBITS,BITS              MOVE IN OPTION SWITCHES,        19280021
         ST    GDSREG,WKGDS             GDSCB ADDRESS, AND              19360021
         ST    ERRCD,WKRTN              RETURN ARRAY ADDRESS INTO       19440021
*                                       PARAMETER LIST                  19520021
         TM    GDSFLAGS,SUBR                                            19600021
         BZ    AGAREQ05                 BRANCH IF NOT GENERATING SUBR   19680021
         OI    WKBITS+3,MEMSUB          SET SWITCH IN KEY               19760021
         BAL   RETREG,AGASDM10                                          19840021
AGAREQ05 TM    GDSFLAGS,SEQ                                             19920021
         BZ    AGAREQ07                 BRANCH IF NOT PART OF SEQUENCE  20000021
         OI    WKBITS+3,MEMSEQ          SET SWITCH IN KEY          9326 20080021
         EJECT                                                          20160021
*                                                                       20240021
*REQUIRED PARAMETERS (TABLE, TEXT, COUNT AND HEIGHT ) ARE CHECKED       20320021
*FOR PRESENCE.                                                          20400021
AGAREQ07 TM    GDS(PARM),LAST                                           20480021
         BO    AGAERR00                 BRANCH IF REQ PARMS NOT PRESENT 20560021
         TM    TAB(PARM),LAST                                           20640021
         BO    AGAERR00                 BRANCH IF REQ PARMS NOT PRESENT 20720021
         TM    TEXT(PARM),LAST                                          20800021
         BO    AGAERR00                 BRANCH IF REQ PARMS NOT PRESENT 20880021
         TM    CT(PARM),LAST                                            20960021
         BO    AGAERR00                 BRANCH IF REQ PARMS NOT PRESENT 21040021
*                                                                       21120021
*CHECK FOR VALID TABLE IDENTIFIER                                       21200021
*                                                                       21280021
         CLC   NL(3,ERRCD),TAB+1(PARM)                                  21360021
         BE    AGAERR20                 BRANCH IF TAB NULL- ERROR       21440021
         L     REGA,TAB(PARM)                                           21520021
         L     REGA,0(REGA)             PICK UP TABLE IDENT             21600021
         LTR   REGA,REGA                                                21680021
         BC    ZORM,AGAERR20            BRANCH IF ZERO OR NEGATIVE      21760021
         C     REGA,ONEH                                                21840021
         BNL   AGAERR20                 BRANCH IF GREATER THAN 99       21920021
         ST    REGA,WKDBL               SAVE ID                         22000021
*                                                                       22080021
*                                                                       22160021
         CLC   NL(3,ERRCD),TEXT+1(PARM)                                 22240021
         BE    AGAERR30                 BRANCH IF TEXT ARRAY NULL-ERROR 22320021
*                                                                       22400021
*CHECK COUNT                                                            22480021
*                                                                       22560021
         CLC   NL(3,ERRCD),CT+1(PARM)                                   22640021
         BE    AGAERR40                 BRANCH IF COUNT NULL- ERROR     22720021
         L     COUNT,CT(PARM)                                           22800021
         L     COUNT,0(COUNT)           PICK UP CHARACTER COUNT         22880021
         LTR   COUNT,COUNT                                              22960021
         BZ    AGARET10                 RETURN IF COUNT ZERO            23040021
         BM    AGAREQ90                 BRANCH IF COUNT NEG= 1 CHAR     23120021
*                                        PER WORD IN TEXT ARRAY         23200021
*                                                                       23280021
*THIS SECTION CHECKS THE PARAMETERS HEIGHT, WIDTH, SPACING, AND         23360021
*ORIENTATION.  IF THEY ARE NOT ALL PRESENT, DEFAULT VALUES ARE          23440021
*INITIALIZED. THESE PARAMETERS ARE ALL REAL VALUES.                     23520021
*                                                                       23600021
AGAREQ10 CLC   NL(3,ERRCD),HGT+1(PARM)                                  23680021
         BE    AGAERR50                 BRANCH IF HEIGHT NULL-ERROR     23760021
         L     REGA,HGT(PARM)           ADDRESS OF HEIGHT               23840021
         LE    FLT4,0(REGA)             HEIGHT                          23920021
         CE    FLT4,EIGHTH              MINIMAL VALUE=1/8 INCH          24000021
         BL    AGAERR50                 BRANCH IF TOO SMALL-ERROR       24080021
         EJECT                                                          24120021
*                                                                       24160021
*FLOATING POINT REGISTER 4 CONTAINS THE HEIGHT IN INCHES                24240021
*CONVERT HEIGHT (IN INCHES) OF 8*8 MATRIX INTO DELTAY IN RASTER UNITS   24320021
*PER POINT.                                                             24400021
         LER   FLT2,FLT4                                                24480021
         ME    FLT2,RAST                MULTIPLY HGT(IN) BY 4096 AND    24560021
         DE    FLT2,INCH                 DIVIDE BY 96 TO GET DELTA Y    24640021
         STE   FLT2,WKHGT               SAVE DELTA Y / POINT ON MATRIC  24720021
         TM    HGT(PARM),LAST                                           24800021
         BO    AGAREQ80                 BRANCH IF NO MORE PARAMETERS    24880021
         CLC   NL(3,ERRCD),WIDTH+1(PARM)                                24960021
         BE    AGAREQ85                 BRANCH IF WIDTH NULL            25040021
         L     REGA,WIDTH(PARM)         ADDRESS OF WIDTH                25120021
*                                                                       25200021
*CONVERT WIDTH (IN INCHES) OF 8*8 MATRIX INTO DELTA X IN RASTER UNITS   25280021
*PER POINT                                                              25360021
*                                                                       25440021
         LE    FLT2,0(REGA)                                             25520021
         CE    FLT2,EIGHTH                                              25600021
         BL    AGAERR60                 BRANCH IF HGT LESS THAN 1/8 IN  25680021
AGAREQ20 ME    FLT2,RAST                MULTIPLY WIDTH(IN) BY 4096 AND  25760021
         DE    FLT2,INCH                 DIVIDE BY 96 TO GET DELTA X    25840021
         STE   FLT2,WKWIDTH             SAVE DELTA X / POINT ON MATRIC  25920021
         TM    WKSWITCH+3,LAST                                          26000021
         BO    AGAREQ75                 BRANCH IF NO PARMS              26080021
         TM    WIDTH(PARM),LAST                                         26160021
         BO    AGAREQ70                 BRANCH IF WIDTH=LAST PARM       26240021
         CLC   NL(3,ERRCD),SPACING+1(PARM)                              26320021
         BE    AGAREQ75                 BRANCH IF SPACING NULL          26400021
*                                                                       26480021
*CONVERT SPACING FROM CHARACTER CENTER TO CHARACTER CENTER (IN INCHES)  26560021
*INTO SPACING IN RASTER UNITS                                           26640021
         L     REGA,SPACING(PARM)       ADDRESS OF CHARACTER SPACING    26720021
         LE    FLT4,0(REGA)                                             26800021
AGAREQ30 ME    FLT4,RAST                MULTIPLY SPACING(IN) BY 4096    26880021
         DE    FLT4,ONE2                 AND DIVIDE BY 12 TO GET RUS    26960021
         STE   FLT4,WKSPACE             SAVE SPACING                    27040021
         EJECT                                                          27080021
*                                                                       27120021
*CHECK FOR ORIENTATION PARAMETERS PASSED                                27200021
*                                                                       27280021
         TM    WKSWITCH+3,LAST                                          27360021
         BO    AGAREQ65                 BRANCH IF REACHED END OF PARMS  27440021
         TM    SPACING(PARM),LAST                                       27520021
         BO    AGAREQ60                 BRANCH IF SPACING WAS LAST PARM 27600021
         LA    REGB,4                   SET UP LOOP FOR CHECKING ORIENT 27680021
         CLC   NL(3,ERRCD),ORIENT+1(PARM)                               27760021
         BE    AGAREQ65                 BRANCH IF ORIENTATION NULL      27840021
         L     REGA,ORIENT(PARM)        PICK UP ADDR OF ARRAY           27920021
AGAREQ40 LE    FLT2,0(REGA)                                             28000021
         CE    FLT2,ONEA                                                28080021
         BH    AGAERR80                 BRANCH IF TOO LARGE-ERROR       28160021
         CE    FLT2,ONEB                                                28240021
         BL    AGAERR80                 BRANCH IF TOO LOW-ERROR         28320021
         BCT   REGB,AGAREQ50                                            28400021
*                                                                       28480021
*IF ALL ARE CORRECT, MOVE INTO WORK AREA                                28560021
*                                                                       28640021
         L     REGA,ORIENT(PARM)                                        28720021
         MVC   WKSIN(16),0(REGA)                                        28800021
         B     AGAOPT10                                                 28880021
AGAREQ50 LA    REGA,4(REGA)             UPDATE POINTER AND              29040021
         B     AGAREQ40                                                 29120021
         EJECT                                                          29200021
*                                                                       29280021
*SET SINE AND COSINE VALUES FOR CHARACTER AND STRING DEFAULTS           29360021
AGAREQ60 OI    WKSWITCH+3,LAST          SET SWITCH- NO MORE PARMS       29440021
AGAREQ65 MVC   WKSIN(4),A0             CHARACTER ORIENTATION            29520021
         MVC   WKCOS(4),ONEA           *                                29600021
         MVC   WKSINS(4),A0            STRING ORIENTATION               29680021
         MVC   WKCOSS(4),ONEA          *                                29760021
         B     AGAOPT10                                                 29840021
         SPACE 2                                                        29920021
*SET SPACE EQUAL TO ONE AND ONE THIRD HEIGHT                            30000021
*                                                                       30080021
AGAREQ70 OI    WKSWITCH+3,LAST          SET SWITCH-NO MORE PARAMETERS   30160021
AGAREQ75 ME    FLT4,ONEONE3             SPACING DEFAULT=1-1/3 * HEIGHT  30240021
         B     AGAREQ30                                                 30320021
*                                                                       30400021
*                                                                       30480021
         SPACE 2                                                        30560021
*                                                                       30640021
*SET WIDTH = TWO-THIRDS HEIGHT                                          30720021
*                                                                       30800021
AGAREQ80 OI    WKSWITCH+3,LAST          SET SWITCH SHOWING NO MORE PARM 30880021
AGAREQ85 LER   FLT2,FLT4                                                30960021
         ME    FLT2,TWO3RD              WIDTH= 2/3 HEIGHT               31040021
         CE    FLT2,EIGHTH                                              31120021
         BNL   AGAREQ20                 BRANCH IF WIDTH AT LEAST 1/8 IN 31200021
         LE    FLT2,EIGHTH              SET HEIGHT TO 1/8 INCH          31280021
         B     AGAREQ20                                                 31360021
         SPACE 2                                                        31440021
AGAREQ90 OI    WKSWITCH+3,IX            SET SWITCH FOR 1 CHAR/WORD      31520021
         LPR   COUNT,COUNT              SET COUNT POSITIVE              31600021
         B     AGAREQ10                                                 31680021
         EJECT                                                          31760021
*                                                                       31840021
*WHEN THIS SECTION IS ENTERED THE REQUIRED PARAMETERS HAVE BEEN         31920021
*CHECKED AND THE NECESSARY DEFAULT CONDITIONS HAVE BEEN SET UP.         32000021
*                                                                       32080021
*TEST CORRVAL AND KEY FOR VALIDITY                                      32160021
*                                                                       32240021
AGAOPT10 TM    WKSWITCH+3,LAST                                          32320021
         BO    AGADAT10                 BRANCH IF PARM LIST ENDED       32400021
         TM    ORIENT(PARM),LAST                                        32480021
         BO    AGADAT10                 BRANCH IF ORIENT WAS LAST PARM  32560021
         CLC   NL(3,ERRCD),COR+1(PARM)                                  32640021
         BE    AGAOPT15                 BRANCH IF CORRVAL NOT PASSED    32720021
         TM    GDSFLAGS,LEVEL2                                          32800021
         BO    AGAOPT15                 BRANCH IF LEVEL 2 CORRVAL       32880021
         L     REGA,COR(PARM)           LOAD ADDRESS OF CORRVAL         32960021
         MVC   WKCORVL,0(REGA)          PLACE CORRVAL IN PARM LIST      33040021
         OI    WKBITS+2,CORRE           SET CORRVAL SWITCH IN PARM LIST 33120021
AGAOPT15 TM    COR(PARM),LAST                                           33200021
         BO    AGADAT10                 BRANCH IF NO MORE PARAMETERS    33280021
         CLC   NL(3,ERRCD),KEY+1(PARM)                                  33360021
         BE    AGAOPT20                 BRANCH IF KEY NOT PASSED        33440021
         MVC   WKKEY,KEY(PARM)          PLACE ADDRESS OF KEY IN PARM    33520021
*                                        LIST                           33600021
         TM    GDSFLAGS,LEVEL2                                          33680021
         BO    AGAOPT20                 BRANCH IF LEVEL 2 KEY           33760021
         OI    WKBITS+2,KEYED           OTHERWISE SET KEY SWITCH IN     33840021
*                                       PARM LIST                       33920021
AGAOPT20 TM    KEY(PARM),LAST                                           34000021
         BO    AGADAT10                 BRANCH IF NO MORE PARAMETERS    34080021
         CLC   NL(3,ERRCD),GEN+1(PARM)                                  34160021
         BE    AGAOPT25                 BRANCH IF GENCODE NOT PASSED    34240021
         EJECT                                                          34280021
*                                                                       34320021
*TEST FOR VALID GENCODE       CODE=1    STATUS 'INCLUDE'                34400021
*                             CODE=2    STATUS 'OMIT'                   34480021
*                             CODE=3    STATUS 'UPDAT'                  34560021
         L     REGA,GEN(PARM)           PICK UP CODE ADDRESS            34640021
         L     REGA,0(REGA)             PICK UP ACTUAL CODE             34720021
         C     REGA,ONE                                                 34800021
         BE    AGAOPT25                 BRANCH IF STATUS 'INCLUDE'      34880021
*                                       (SWT ALREADY SET IN PARM LIST)  34960021
         CLC   WKCORVL(8),ZERO          CHECK FOR CORRVAL AND/OR KEY    35040021
         BZ    AGAERR90                 BRANCH IF STATUS NOT INCLUDE    35120021
*                                        AND ELEMENT NOT KEYED OR       35200021
*                                        CORRVALLED--ERROR              35280021
         C     REGA,TWO                                                 35360021
         BNE   AGAOPT30                                                 35440021
         TM    GDSFLAGS,LEVEL2          BRANCH IF LEVEL 2 AND 'OMIT'    35520021
         BO    AGAERR90                                                 35600021
         NI    WKBITS,OMIT               STATUS SPECIFIED-ERROR         35680021
AGAOPT25 TM    WKBITS+2,CORRE                                           35760021
         BZ    AGAOPT55                 BRANCH IF NOT CORRELATED        35840021
         CLC   WKCORVL,ZERO                                             35920021
         BE    AGAERR95                 BRANCH IF CORRVAL=0 - ERROR     36000021
         B     AGAOPT55                                                 36080021
         EJECT                                                          36160021
*                                                                       36240021
*THIS SECTION IS ENTERED WHEN STATUS 'UPDATE'  IS SPECIFIED             36320021
*                                                                       36400021
AGAOPT30 C     REGA,THREE                                               36480021
         BNE   AGAERR90                 BRANCH IF NOT 'UPDATE'- ERROR   36560021
         TM    GDSFLAGS,SUBR                                            36640021
         BO    AGAERR00                 BRANCH IF UPDATE WHEN GENERAT-  36720021
*                                        ING SUBROUTINE- ERROR          36800021
         TM    GDSFLAGS,LEVEL2                                          36880021
         BO    AGAOPT45                 BRANCH IF LEVEL 2 TO SET KEY    36960021
         TM    WKBITS+2,KEYED                                           37040021
         BZ    AGAOPT50                 BRANCH IF ELEMENT NOT KEYED     37120021
*                                                                       37200021
*PREPARE PARAMETERS FOR KEY SEARCH                                      37280021
*                                                                       37360021
         L     REGA,KEY(PARM)           LOAD KEY ADDRESS                37440021
         ST    REGA,WKKADDR             AND PUT IN PARAMETER LIST       37520021
         LA    REGA,TWO                 CODE FOR SEARCH ON KEY          37600021
AGAOPT35 ST    REGA,WKCODE                                              37680021
         ST    GDSREG,WKGDS1            ADDRESS OF GDSCB                37760021
         LA    PARM,WKGDS1                                              37840021
         L     REGA,GDSGTMCB       GET POINTER TO GTMCB            000A 37940021
         L     REGA,4(REGA)        GET POINTER TO GSPCB            000A 38040021
         L     REGA,FE(REGA)       GET POINTER TO STATUS TABLE     000A 38140021
         L     BRANCH,ETE(REGA)    GET ADRS OF KEY TABLE MGMT      000A 38240021
         BALR  RETREG,BRANCH       BRANCH TO KEY TABLE MGMT        000A 38340021
*                                                                       38560021
         LTR   BRANCH,BRANCH            TEST RETURN CODE                38640021
         BNE   AGAERR00                 BRANCH IF INVALID KEY           38720021
         MVC   WKADDR,0(PARM)           MOVE KEY FIELDS INTO PARM LIST  38800021
         OC    WKBITS+3(1),7(PARM) CHECK KEY FOR SUBRTN STATUS   A30726 38940021
         BZ    AGAOPT36                 BRANCH IF NOT PART OF SUBROUT   38960021
         BAL   RETREG,AGASDM10                                          39040021
AGAOPT36 TM    4(PARM),INCLUDE                                          39120021
         BO    AGAOPT39                 BRANCH IF INCLUDE STATUS        39200021
         NI    WKBITS,OMIT              TURN OFF INCLUDE SWITCH         39280021
AGAOPT39 ST    PARM,WKSTORAD           SAVE KEY ADDR IN KEY TABLE       39380021
AGAOPT43 MVI   WKSWITCH,UPDATE          SET UPDATE SWITCH               39600021
         L     PARM,WKPARM              RESTORE PARM REGISTER           39680021
         B     AGAOPT55                                                 39760021
         EJECT                                                          39840021
*                                                                       39920021
*ENTERED WHEN UPDATE ON LEVEL 2 KEY                                     40000021
*                                                                       40080021
AGAOPT45 L     REGA,KEY(PARM)           LOAD KEY ADDRESS                40160021
         MVC   WKADDR,0(REGD)           PLACE KEY IN PARM LIST          40240021
         B     AGAOPT43                                                 40320021
*                                                                       40400021
AGAOPT50 CLC   WKCORVL,ZERO             BAD PARAMETER COMBINATION       40480021
         BE    AGAERR00                                                 40560021
*                                                                       40640021
*PREPARE FOR SEARCH ON CORRVAL                                          40720021
         LA    REGA,WKCORVL             LOAD CORRVAL ADDRESS            40800021
         ST    REGA,WKKADDR             AND PUT IN PARAMETER LIST       40880021
         LA    REGA,FIVE                CODE FOR SEARCH ON CORRVAL      40960021
         B     AGAOPT35                                                 41040021
         EJECT                                                          41120021
*                                                                       41200021
*THIS SECTION CHECKS FOR THE X AND Y PARAMETERS. AN ERROR RETURN IS     41280021
*MADE IF ONLY ONE OF THESE PARAMETERS IS PASSED                         41360021
*                                                                       41440021
AGAOPT55 TM    GEN(PARM),LAST                                           41520021
         BO    AGADAT10                 BRANCH IF NO MORE PARAMETERS    41600021
         CLC   NL(3,ERRCD),XCOR+1(PARM)                                 41680021
         BE    AGAOPT60                 BRANCH IF X NULL                41760021
         OI    WKSWITCH+1,X             SET SWITCH, X PRESENT           41840021
AGAOPT60 TM    XCOR(PARM),LAST                                          41920021
         BO    AGAOPT65                 BRANCH IF LAST                  42000021
         CLC   NL(3,ERRCD),YCOR+1(PARM)                                 42080021
         BE    AGAOPT65                 BRANCH IF Y NULL                42160021
         OI    WKSWITCH+1,Y             SET SWITCH, Y PRESENT           42240021
AGAOPT65 TM    WKSWITCH+1,POS                                           42320021
         BM    AGAERR00                 ERROR IF ONE COORD PASSED       42400021
         B     AGADAT10                                                 42480021
         EJECT                                                          42560021
*THIS SECTION LOADS THE STROKE TABLE AND SETS UP FOR THE ACTUAL         42640021
*GENERATION OF DATA.                                                    42720021
*                                                                       42800021
AGADAT10 L     REGA,WKDBL               PICK UP TABLE ID                42880021
         L     GTMREG,GDSGTMCB          PICK UP ADDRESS OF GTMCB        42960021
         USING GTMCB,GTMREG                                             43040021
         L     GSPREG,GTMGSPCB          PICK UP ADDRESS OF GSPCB        43120021
         DROP  GTMREG                                                   43200021
         USING GSPCB,GSPREG                                             43280021
         L     REGB,GSPSTRTB            LOAD ADDRESS OF STROKE TAB      43360021
*                                                                       43440021
*SET UP LOOP TO CHECK WHETHER STROKE TABLE LOADED                       43520021
*                                                                       43600021
         SR    REGC,REGC                INITIALIZE REG TO CONTAIN PTR   43680021
AGADAT20 LTR   REGB,REGB                                                43760021
         BZ    AGADAT80                 BRANCH IF NO MORE TABLES        43840021
         C     REGA,ID(REGB)            CHECK FOR ID EQUAL              43920021
         BE    AGAGEN10                 BRANCH IF STROKE TABLE FOUND    44000021
         LR    REGC,REGB                SAVE POINTER TO CURRENT TABLE   44080021
         L     REGB,NEXTAB(REGB)        PICK UP CHAIN ADDRESS           44160021
         B     AGADAT20                                                 44240021
*                                                                       44320021
*LOAD THE STROKE TABLE AND CHAIN IT TO OTHERS                           44400021
* TABLE CODE CONVERTED TO EBCDIC                                        44480021
*                                                                       44560021
AGADAT80 MVC   WKNAME(8),FIXNAME        SET UP 'GSP     ' IN WORK AREA  44640021
         CVD   REGA,WKDBL               PACKED DECIMAL                  44720021
         UNPK  WKNAME+3(2),WKDBL+6(2)   STORE EBCIDIC NAME              44800021
         OI    WKNAME+4,XSIGN                                           44880021
         LOAD  EPLOC=WKNAME                                             44960021
         LR    REGB,RZERO               ADDRESS OF STROKE TABLE         45040021
         ST    REGA,ID(REGB)            PUT ID IN STROKE TABLE          45120021
         XC    NEXTAB(4,REGB),NEXTAB(REGB) ZERO CHAIN FIELD             45200021
         LTR   REGC,REGC                                                45280021
         BZ    AGADAT90                                                 45360021
         ST    REGB,NEXTAB(REGC)        CHAIN STROKE TABLES             45440021
         B     AGAGEN10                                                 45520021
*                                                                       45600021
*IF FIRST STROKE TABLE, ADDRESS IS ENTERED IN GSPCB                     45680021
*                                                                       45760021
AGADAT90 ST    REGB,GSPSTRTB                                            45840021
         DROP  GSPREG                                                   45920021
         EJECT                                                          46000021
*AFTER ALL PARAMETERS ARE CHECKED, AND THE STROKE TABLE IS LOCATED,     46080021
*THE CONVERT RUUTINE IS LOADED,AND ITS ENTRY POINT ADDRESS IS PLACED    46160021
*IN THE STATUS TABLE. IF THE X AND Y COORDINATES HAVE BEEN PASSED,      46240021
*THEY ARE SCALED, AND A BLANKED LINE IS GENERATED.                      46320021
*                                                                       46400021
*                                                                       46480021
AGAGEN10 L     REGA,STAT(ERRCD)                                         46500021
         L     REGA,CVRT(REGA)         CHECK IF CNVT ALREADY LOADED     46520021
         LTR   REGA,REGA                                                46540021
         BNE   AGAGEN15                BRANCH IF ALREADY LOADED         46560021
         L     REGA,16                 CVT                              46580021
         L     REGA,CVTLINK(REGA)      LINK LIB DCB                     46640021
*        LOAD EP=IFFAHA15,DCB=(REGA)                                    46720021
         LOAD  EP=IFFAHA15                                              46800021
         L     REGA,STAT(ERRCD)                                         46880021
         ST    RZERO,CVRT(REGA)        STORE ENTRY POINT ADDREXS        46960021
*                                                                       47040021
AGAGEN15 TM    WKBITS+3,MEMSUB                                          47120021
         BO    AGAGEN70                 BRANCH IF PART OF BUFFER SUBR,  47200021
*                                        OUTPUT INCREMENAL              47280021
*TEST FOR OUTPUT DATA MODE                                              47360021
*                                                                       47440021
         TM    GDSCURMD,OPT                                             47520021
         BO    AGAGEN20                 BRANCH IF OPTIMIZED OUTPUT-     47600021
*                                        SWITCH ALREADY SET             47680021
         TM    GDSCURMD,INC                                             47760021
         BO    AGAGEN70                 BRANCH IF INCREMENTAL MODE      47840021
         XI    WKBITS,ABSSW             SET SWITCH TO ABSOLUTE          47920021
*                                                                       48000021
*                                                                       48080021
AGAGEN20 TM    WKBITS+3,MEMSUB                                          48160021
         BO    AGAGEN90                BRANCH IF BUFFER SUBR            48240021
AGAGEN22 CLI   WKSWITCH,UPDATE                                          48320021
         BE    AGAGEN75                 BRANCH IF UPDATE                48400021
         L     REGD,GDSAOACB            GET OACB ADDRESS                48480021
         L     REGD,CURRLOG(REGD)       GET LOGICAL START AND STORE     48560021
         STH   REGD,WKADDR+2              IN PARM LIST                  48640021
         EJECT                                                          48680021
*                                                                       48720021
*REG B CONTAINS POINTER TO STROKE TABLE                                 48800021
*REG COUNT CONTAINS COUNT OF NUMBER OF CHARACTERS                       48880021
*REG E IS INITIALIZED AS AN INDEX TO THE TEXT ARRAY AND                 48960021
*REGC IS INITIALIZED TO POINT TO THE FIRST SYMBOL IN THE TEXT ARRAY.    49040021
*                                                                       49120021
AGAGEN25 L     PARM,WKPARM              REINITIALIZE POINTER TO PARM    49200021
         L     REGC,TEXT(PARM)         PICK UP POINTER TO TEXT          49280021
         LA    REGB,ADDR(REGB)          POINTER TO FIRST ENTRY IN       49360021
*                                        STROKE TABLE                   49440021
         LA    REGE,1                   SET UP INDEX                    49520021
         TM    WKSWITCH+3,IX                                            49600021
         BZ     AGAGEN29                                                49680021
         LA    REGE,4                   SET INDEX TO 4                  49760021
         LA    REGC,3(REGC)             POINT TO FIRST CHARACTER        49840021
AGAGEN29 TM    WKSWITCH+1,POS                                           49920021
         BZ    AGAGEN65                BRANCH IF NO POSITIONING VECTOR  50000021
         L     REGA,XCOR(PARM)          PICK UP X COORDINATE            50080021
         L     REGA,0(REGA)                                             50160021
         TM    GDSDATMD,XABS                                            50240021
         BZ    AGAGEN80                 BRANCH IF X INCREMENTAL         50320021
         ST    REGA,WKXABS                                              50400021
AGAGEN30 L     REGA,YCOR(PARM)          PICK UP Y COORDINATE            50480021
         L     REGA,0(REGA)                                             50560021
         TM    GDSDATMD,YABS                                            50640021
         BZ    AGAGEN85                 BRANCH IF Y INCREMENTAL         50720021
         ST    REGA,WKYABS                                              50800021
         EJECT                                                          50840021
*                                                                       50880021
*CALL SCALE TO SCALE THE X AND Y COORDINATES                            50960021
*                                                                       51040021
AGAGEN35 LA    PARM,WKGDS                                               51120021
         L     BRANCH,STAT(ERRCD)       ADDRESS OF STATUS TABLE         51200021
         L     BRANCH,SCALE(BRANCH)     ADDRESS OF SCALE                51280021
         BALR  RETREG,BRANCH                                            51360021
         LTR   BRANCH,BRANCH                                            51440021
         BNE   AGARES10                 BRANCH IF SCALE ERROR-RESET     51520021
         LA    PARM,WKXABS                                              51600021
         LA    REGA,WKYABS                                              51680021
         BAL   RETREG,AGAFLT10                                          51760021
         LA    RETREG,AGATXT30                                          51840021
         B     AGAGDO25                CO CALL SCISSOR AND DATA GEN     51920021
AGAGEN65 LA    PARM,GDSXLAST                                            52080021
         LA    REGA,GDSYLAST                                            52160021
         BAL   RETREG,AGAFLT10         CONVERT BEAM POS TO REAL NUM     52240021
         MVC   WKENTCT(4),ONE           INITIALIZE ENTRY COUNT          52280021
         B     AGATXT30                                                 52320021
AGAGEN70 XI    WKBITS,INCSW                                             52400021
         B     AGAGEN20                                                 52480021
         EJECT                                                          52520021
*                                                                       52560021
*GET GDOA'S FOR UPDATE                                                  52640021
*                                                                       52720021
AGAGEN75 L     REGD,16                  CVT                             52800021
         L     REGD,CVTLINK(REGD)       LINK LIB DCB                    52880021
         LA    PARM,WKADDR                                              52960021
*                                                                       53040021
*        LINK  EP=IFFAHA13,DCB=(REGD),MF=(E,(1)),SF=(E,WKSPVSR)         53120021
         LINK  EP=IFFAHA13,MF=(E,(1)),SF=(E,WKSPVSR)                    53200021
         LTR   BRANCH,BRANCH                                            53280021
         BNE   AGAERR97                                                 53360021
         B     AGAGEN25                                                 53440021
*                                                                       53520021
AGAGEN80 ST    REGA,WKXINCR                                             53600021
         B     AGAGEN30                                                 53680021
*                                                                       53760021
AGAGEN85 ST    REGA,WKYINCR                                             53840021
         B     AGAGEN35                                                 53920021
*                                                                       54000021
*SET GDSXLAST,GDSYLAST,GDSXCURR,AND GDSYCURR TO ZERO WHEN GENERATING    54080021
*OR UPDATING A BUFFER SUBROUTINE.                                       54160021
AGAGEN90 MVC   GDSXLAST(8),ZERO        SET CURRENT POSITION TO ZERO     54240021
         MVC   GDSXCURR(4),ZERO        BEAM POSITION TO ZERO            54320021
         B     AGAGEN22                                                 54400021
         EJECT                                                          54480021
*THIS SECTION IS ENTERED EACH TIME A SYMBOL IS TO BE GENERATED.         54560021
*THE SPACE TO THE NEXT CHARACTER IS COMPUTED AND SAVED.                 54640021
*  SPACE IN THE X DIRECTION= SPACE*COS THETA + CURRENT X                54720021
*  SPACE IN THE Y DIRECTION= SPACE*SIN THETA + CURRENT Y                54800021
*                                                                       54880021
AGATXT30 LE    FLT2,WKSPACE                                             54960021
         ME    FLT2,WKCOSS                                              55040021
         AE    FLT2,WKXNOW                                              55120021
         STE   FLT2,WKXNOW              X COR FOR NEXT CHAR             55200021
         LE    FLT2,WKSPACE                                             55280021
         ME    FLT2,WKSINS                                              55360021
         AE    FLT2,WKYNOW              Y COR FOR NEXT CHARACTER        55440021
         STE   FLT2,WKYNOW                                              55520021
*                                                                       55600021
*REG D IS INITIALIZED TO POINT TO THE STROKES. IF NO STROKES ARE        55680021
*DEFINED FOR THE SYMBOL, NO DATA IS GENERATED, AND THE NEXT             55760021
*SYMBOL IS PROCESSED.                                                   55840021
*                                                                       55920021
AGATXT35 SR    REGD,REGD                                                56000021
         IC    REGD,0(REGC)             PICK UP SYMBOL                  56080021
         SLA   REGD,2                   MULTIPLY BY 4 TO ALIGN TO WORD  56160021
         L     REGD,0(REGD,REGB)        PICK UP POINTER TO STROKES      56240021
         LTR   REGD,REGD                                                56320021
         BZ    AGAGOT40                                                 56400021
*                                                                       56480021
*FIRST STROKE DETERMINED FROM POINT 63,63 OF 128*128 MATRIX             56560021
*                                                                       56640021
         MVC   WKXLGRID(4),A3           INITIALIZE GRID POSITION        56720021
         MVC   WKYLGRID(4),A3                                           56800021
*                                                                       56880021
*                                                                       56960021
*THIS SECTION CONVERTS STROKE DEFINITIONS FROM THE STROKE TABLE INTO    57040021
*ACTUAL  X AND Y COORDINATES.                                           57120021
*STROKE TABLE FORMAT- 2 BYTES/STROKE                                    57200021
*                     BYTE 0- BIT0 = 1-BLANKED STROKE                   57280021
*                                  = 0-UNBLANKED STROKE                 57360021
*                             BITS 1-7= INTEGER FROM 0-127 INDICATING   57440021
*                                  X COORD ON 128*128 MATRIX            57520021
*                     BYTE 1- BIT0 = 1-LAST STROKE                      57600021
*                                  = 0-NOT LAST STROKE                  57680021
*                                                                       57760021
*REGISTER 0 AND 1 ARE USED AS WORK REGISTERS                            57840021
*                                                                       57920021
AGATXT37 LH    RZERO,0(REGD)                                            58000021
         TM    0(REGD),BLANK                                            58080021
         BO    AGATXT90                 BRANCH IF BLANKED STROKE        58160021
         OI    WKBITS+2,BEAMON                                          58240021
AGATXT45 N     RZERO,MASK               TURN OFF SWITCHES               58320021
         EJECT                                                          58360021
*                                                                       58400021
*CONVERT STROKES TO REAL VALUES                                         58480021
*                                                                       58560021
         MVC   CONCON2(4),CCON2                                         58600021
         STC   RZERO,CONCON2+1                                          58640021
         CLI   CONCON2+1,OFF                                            58720021
         BE    AGATXT48                 BRANCH IF ZERO                  58800021
         LE    FLT4,CONCON2                                             58880021
         AE    FLT4,ZERO                NORMALIZE FLOATING PT Y         58960021
AGATXT46 SRL   RZERO,8                  MOVE OUT Y COOR                 59040021
         STC   RZERO,CONCON2+1                                          59120021
         CLI   CONCON2+1,OFF                                            59200021
         BE    AGATXT49                                                 59280021
         LE    FLT0,CONCON2                                             59360021
         AE    FLT0,ZERO                                                59440021
AGATXT47 LER   FLT6,FLT4                                                59520021
         LER   FLT2,FLT0                SAVE COPY                       59600021
         SE    FLT2,WKXLGRID                                            59680021
         STE   FLT0,WKXLGRID           SAVE LAST POINT                  59760021
         ME    FLT2,WKWIDTH             GET CHANGE IN X IN RASTER UNITS 59840021
         SE    FLT4,WKYLGRID                                            59920021
         STE   FLT6,WKYLGRID                                            60000021
         ME    FLT4,WKHGT               GET CHANGE IN Y IN RASTER UNITS 60080021
         LER   FLT0,FLT2               X'S IN REGS 0 AND 2              60160021
         LER   FLT6,FLT4               Y'S IN REGS 4 AND 6              60240021
         EJECT                                                          60280021
*                                                                       60320021
*COMPUTE X INCREMENT IN RASTER UNITS, AND SAVE IT                       60480021
*                                                                       60560021
         ME    FLT4,WKSIN                                               60640021
         ME    FLT0,WKCOS                                               60720021
         SER   FLT0,FLT4                                                60800021
         STE   FLT0,WKXINCR                                             60880021
*                                                                       60960021
*COMPUTE Y INCREMENT IN RASTER UNITS, AND SAVE IT                       61040021
*                                                                       61120021
         ME    FLT6,WKCOS                                               61200021
         ME    FLT2,WKSIN                                               61280021
         AER   FLT2,FLT6                                                61360021
         STE   FLT2,WKYINCR                                             61440021
*                                                                       61520021
*CONVERT X AND Y INCREMENT FROM REAL TO INTEGER VALUES, AND COMPUTE     61600021
*THE ABSOLUTE BEAM POSITIONS.                                           61680021
*                                                                       61760021
         SR    REGA,REGA               SET UP LOOP CONTROL AND INDES    61840021
AGATXT50 L     PARM,WKXINCR(REGA)       PICK UP REAL VALUE              61920021
         L     BRANCH,STAT(ERRCD)       ADDRESS OF STATUS TABLE         62000021
         L     BRANCH,CVRT(BRANCH)      ADDRESS OF CONVERT              62080021
         BALR  RETREG,BRANCH                                            62160021
         LTR   BRANCH,BRANCH            BRANCH IF CONVERSION ERROR      62240021
         BNE   AGARES10                                                 62320021
         ST    PARM,WKXINCR(REGA)      SAVE INTEGER INCREMENT           62400021
         A     PARM,GDSXLAST(REGA)     COMPUTE ABSOLUTE VALUE           62480021
         ST    PARM,WKXABS(REGA)       AND PUT IN PARAMETER LIST        62560021
         LTR   REGA,REGA                                                62640021
         BP    AGATXT65                 BRANCH IF X AND Y FINISHED      62720021
         LA    REGA,4                  SET UP NEW INDEX                 62800021
         B     AGATXT50                                                 62880021
         EJECT                                                          62920021
*                                                                       62960021
*CALL SCISSOR AND DATA GENERATOR TO ENTER DATA IN GDOA                  63040021
*                                                                       63120021
AGATXT65 BAL   RETREG,AGAGDO25                                          63200021
         TM    1(REGD),LASSTR                                           63280021
         BO    AGAGOT10                BRANCH IF LAST STROKE IN         63360021
*                                       SYMBOL JUST GENERATED.          63440021
         LA    REGD,2(REGD)             UPDATE POINTER TO NEXT STROKE   63520021
         B     AGATXT37                                                 63600021
*                                                                       63680021
*TURN OFF BEAM SWITCH FOR BLANKED LINE                                  63760021
*                                                                       63840021
AGATXT75 XI    WKBITS,MULT                                              63920021
         B     AGAGOT18                                                 64000021
*                                                                       64080021
AGATXT90 NI    WKBITS+2,BOFF            TURN OFF BEAM SWIT              64160021
         B     AGATXT45                                                 64240021
*                                                                       64320021
AGATXT48 LE    FLT4,ZERO                                                64400021
         B     AGATXT46                                                 64480021
*                                                                       64560021
AGATXT49 LE    FLT0,ZERO                                                64640021
         B     AGATXT47                                                 64720021
         EJECT                                                          64800021
*IF THE LAST STROKE IN A CHARACTER IS GENERATED, A BLANKED VECTOR       64880021
*IS GENERATED TO THE CENTER OF THE NEXT CHARACTER, AND THE CHARACTER    64960021
*COUNT IS DECREMENTED BY ONE. IF NO MORE SYMBOLS REMAIN TO BE           65040021
*GENERATED, THE KEY IS COMPLETED AND CONTROL IS RETURNED TO THE         65120021
*CALLING PROGRAM.                                                       65200021
*REGC CONTAINS A POINTER TO THE TEXT ARRAY                              65280021
*REGE CONTAINS THE INDEX TO THE TEXT ARRAY                              65360021
*                                                                       65440021
AGAGOT10 SR    REGA,REGA                                                65520021
AGAGOT15 L     PARM,WKXNOW(REGA)                                        65600021
         L     BRANCH,STAT(ERRCD)      ADDRESS OF STATUS TABLE          65680021
         L     BRANCH,CVRT(BRANCH)     ADDRESS OF CONVERT               65760021
         BALR  RETREG,BRANCH                                            65840021
         LTR   BRANCH,BRANCH                                            65920021
         BNE   AGARES10                BRANCH IF CONVERSION ERROR       66000021
         ST    PARM,WKXABS(REGA)       SAVE INTEGER VALUE               66080021
         S     PARM,GDSXLAST(REGA)     COMPUTE INCREMENT                66160021
         ST    PARM,WKXINCR(REGA)      AND PUT IN PARAMETER LIST        66240021
         LTR   REGA,REGA                                                66320021
         BP    AGAGOT17                BRANCH IF FINISHED               66400021
         LA    REGA,4                  SET UP NEW INDES                 66480021
         B     AGAGOT15                CONTINUE LOOP                    66560021
*                                                                       66640021
AGAGOT17 NI    WKBITS+2,BOFF           SET BEAM SWITCH OFF              66720021
         C     COUNT,ONE                                                66800021
         BNE   AGAGOT18                BRANCH IF NOT LAST               66880021
         TM    WKBITS+2,LASTT                                           66960021
         BZ    AGATXT75                 BRANCH IF NO DATA GENERATED YET 67040021
         OI    WKBITS+2,LASTT           SET LAST PASS SWITCH ON         67120021
*                                                                       67200021
AGAGOT18 BAL   RETREG,AGAGDO25         GO CALL SCISSOR AND DATA GEN     67280021
AGAGOT20 AR    REGC,REGE               UPDATE POINTER TO TEXT           67360021
         LA    REGD,1                                                   67380021
         A     REGD,WKENTCT                                             67400021
         ST    REGD,WKENTCT             UPDATE ENTRY COUNT              67420021
         BCT   COUNT,AGATXT30                                           67440021
         TM    WKBITS+2,LASTT                                           67520021
         BZ    AGAERR98                 NO DATA GENERATION              67600021
         BO    AGAGOT50                 LAST ENTRY SCISSORED            67680021
         CLI   WKSWITCH,UPDATE                                          67760021
         BE    AGACOM10                                                 67840021
         EJECT                                                          67880021
*                                                                       67920021
*PREPARE KEY                                                            68000021
         L     COUNT,GDSAOACB                                           68080021
         L     COUNT,CURRLOG(COUNT)     GET CURRENT LOGICAL ADDRESS     68160021
         SH    COUNT,WKADDR+2           COMPUTE ELEMENT LENGTH          68240021
         LTR   COUNT,COUNT                                              68320021
         BZ    AGAERR98                 ERROR IF NO DATA GENERATED      68400021
         STH   COUNT,WKADDR             PLACE LENGTH IN KEY             68480021
         L     COUNT,WKKEY                                              68560021
         LTR   COUNT,COUNT                                              68640021
         BZ    AGAEND10                 BRANCH IF NO USER VARIABLE      68720021
         MVC   0(4,COUNT),WKADDR        PLACE KEY IN USER VARIABLE      68800021
AGAEND10 TM    WKBITS+2,KEYED+CORRE                                     68804021
         BZ    AGARET10                 BRANCH IF NOT KEYED OR CORRE    68808021
*                                                                       68812021
*PREPARE LINK TO KEY MANAGEMENT TO ADD KEY                              68816021
*                                                                       68820021
         LA    REGA,ONE                 CODE FOR ADDING KET TO TABLE    68824021
         ST    REGA,WKCODE                                              68828021
         LA    REGA,WKADDR              KEY ADDRESS                     68832021
         ST    REGA,WKKADDR                                             68836021
         ST    GDSREG,WKGDS1            ADD OF GDSCB                    68840021
         LA    PARM,WKGDS1                                              68844021
         L     REGA,16                  CVT                             68848021
         L     REGA,CVTLINK(REGA)       LINK LIB DCB                    68852021
*        LINK  EP=IFFAHA03,DCB=(REGA),MF=(E,(1)),SF=(E,WKSPVSR)         68856021
         LINK  EP=IFFAHA03,MF=(E,(1)),SF=(E,WKSPVSR)                    68860021
         LTR   BRANCH,BRANCH                                            68864021
         BNE   AGAERR97                 BRANCH IF NOT ENOUGH STORAGE    68868021
         EJECT                                                          68872021
AGARET10 CLI   WKSWITCH,UPDATE                                          68876021
         BNE   AGARET20                 BRANCH IF NOT UPDATE            68880021
         TM    GDSFLAGS,LEVEL2                                          68884021
         BO    AGARET20                BRANCH IF LEVEL 2-NO KEY TABLE   68888021
         L     PARM,WKSTORAD                                            68892021
         MVC   4(4,PARM),WKBITS        MOVE IN NEW KEY SWITCHES         68896021
         TM    WKBITS+2,CORRE                                           68900021
         BZ    AGARET20                 BRANCH IF NOR CORRELATED        68904021
         MVC   8(4,PARM),WKCORVL        MOVE NEW CORRVAL INTO KEY       68908021
AGARET20 MVC   GDSDATMD(1),WKSWITCH+2   RESTORE DATA MODE SWITCH        68912021
         TM    WKBITS+3,MEMSUB                                          68916021
         BZ    AGARET30                BRANCH IF NOT SUBROUTINE         68920021
         MVC   GDSXLAST(8),WKXLAST     RESTORE REAM POINTERS            68924021
         MVC   GDSXCURR(4),WKXCURR                                      68928021
AGARET30 L     SAVE,4(SAVE)                                             68932021
         RETURN (14,12),T                                               68936021
         EJECT                                                          68940021
*                                                                       68960021
*THIS SECTION IS ENTERED WHEN A SYMBOL IS REFERENCED WHICH HAS NO       69040021
*STROKES DEFINING IT.                                                   69120021
*                                                                       69200021
AGAGOT40 C     COUNT,ONE                                                69280021
         BNE   AGAGOT55                 BRANCH IF NOT LAST CHARACTER    69360021
         TM    WKBITS+2,LASTT                                           69440021
         BZ    AGAERR98                 ERROR IF NO DATA GENERATED      69520021
         OI    WKBITS+2,LASTT           SET SWITCH SO MAKE LAST ENTRY   69600021
         B     AGAGOT20                                                 69680021
AGAGOT50 OI    WKBITS+2,REPONLY         SET FLAG TO GENERATE REPOS VECT 69760021
         XC    WKDATA1(32),WKDATA1                                      69840021
         MVC   WKXABS+2(2),GDSXCURR     PLACE CURRENT BEAM POSITION     69920021
         MVC   WKYABS+2(2),GDSYCURR     FROM GDS INTO PARAM LIST        70000021
         LA    COUNT,1                  RESET COUNT REG                 70080021
         LA    RETREG,AGAGOT20                                          70160021
         ST    RETREG,WKTEMP            SET RETURN ADDRESS              70240021
         B     AGAGDO40                 CALL DATA GENERATOR             70320021
*                                                                       70400021
AGAGOT55 AR    REGC,REGE               UPDATE POINTR                    70480021
         S     COUNT,ONE               DECREMENT COUNT                  70560021
         LA    REGD,1                                                   70580021
         A     REGD,WKENTCT                                             70600021
         ST    REGD,WKENTCT             UPDATE ENTRY COUNT              70620021
         B     AGATXT35                                                 70640021
         EJECT                                                          73360021
*                                                                       73410021
*CALL RESET IF ERROR IN CALL TO SCALE OR DATA GEN                       73440021
*                                                                       73490021
*                                                                       73520021
AGARES10 MVC   GDSXCURR(4),WKXCURR                                      73600021
         MVC   GDSXLAST(8),WKXLAST                                      73680021
         CLI   WKSWITCH,UPDATE                                          73760021
         BE    AGARET20                BRANCH IF UPDATE - RESET NOT     73840021
*                                       NECESSARY                       73920021
         MVC   WKDATA2(20),0(ERRCD)     SAVE RETURN ARRAY               74000021
         LA    REGA,GDSGDSCB            VAR HOLDING ADDRESS OF GDSCB    74080021
         ST    REGA,WKGDS                                               74160021
         LA    REGA,WKGDS               ADDRESS OF PARAMETER LIST       74240021
         ST    REGA,WKGDS1               STORED IN WORK AREA            74320021
         L     REGA,NULL(ERRCD)         NULL FOR CORRVAL IN PARM LIST   74400021
         ST    REGA,WKRTN                                               74480021
         LA    REGA,WKADDR              ADDRESS OF KEY IN PARM LIST     74560021
         ST    REGA,WKDATA1                                             74640021
         OI    WKDATA1,LAST             LAST PARM INDICATION            74720021
         ST    ERRCD,WKCODE             ERROR CODE IN PARM LIST         74800021
         LA    PARM,WKGDS1              ADDRESS OF WORK AREA            74880021
         L     REGA,16                                                  74960021
         L     REGA,CVTLINK(REGA)       LINK LIB DCB                    75040021
*        LINK  EP=IFFAFA12,DCB=(REGA),MF=(E,(1)),SF=(E,WKSPVSR)         75120021
         LINK  EP=IFFAFA12,MF=(E,(1)),SF=(E,WKSPVSR)                    75200021
         MVC   0(20,ERRCD),WKDATA2      RESTORE RETURN ARRAY            75280021
         B     AGARET20                                                 75360021
         EJECT                                                          75520021
*                                                                       75570021
*THIS ROUTINE CALLS SCISSOR (IF SCISSOR OPTION IS SET) AND DATA         75600021
*GENERATION, AND CHECKS THE RETURN CODES.                               75680021
*                                                                       75760021
*CALL SCISSOR IF SCISSOR OPTION SET                                     75840021
*                                                                       75920021
AGAGDO25 ST    RETREG,WKTEMP           SAVE RETURN ADDRESS              76000021
         TM    WKBITS+3,MEMSUB          TEST FOR BUFFER SUBROUTINE      76080021
         BO    AGAGDO85                BRANCH IF PART OF SUBROUTINE     76160021
         TM    GDSSCISS,NOSCISS                                         76240021
         BO    AGAGDO85                BRANCH IF NO SCISSORING          76320021
*                                                                       76400021
         LA    PARM,WKGDS                                               76480021
         L     BRANCH,STAT(ERRCD)       ADDRESS OF STATUS TABLE         76560021
         L     BRANCH,SCISS(BRANCH)     ADDRESS OF SCISSOR              76640021
         BALR  RETREG,BRANCH                                            76720021
         LTR   BRANCH,BRANCH                                            76800021
         BZ    AGAGDO35                BRANCH IF SCISSOR RETURN OK      76880021
         C     BRANCH,FOUR                                              76960021
         BE    AGARES10                 BRANCH IF STOP GENERATION       77040021
         B     AGAGDO45                OTHERWISE SKIP CALL TO DATA GEN  77120021
AGAGDO35 TM    WKBITS+2,LASTT                                           77200021
         BZ    AGAGDO40                 ALWAYS GENERATE FIRST VECTOR    77280021
         CLC   WKXINCR(8),ZERO          IF NO MOVEMENT                  77360021
         BE    AGAGDO45                                                 77440021
         EJECT                                                          77480021
*                                                                       77520021
*CALL DATA GENERATOR                                                    77600021
*                                                                       77680021
AGAGDO40 LA PARM,WKADDR                                                 77760021
         L     BRANCH,STAT(ERRCD)                                       77840021
         L     BRANCH,DGEN(BRANCH)                                      77920021
         TM    WKBITS+2,LASTT     CK IF FIRST CALL TO DGEN       A29395 77970021
         BNZ   AGAGDO42             IF NO, USE LAST CALC POS     A29395 77980021
         MVC   WKXPREV(8),WKXLAST   IF YES, USE LAST BEAM POS    A29395 77990021
         OI    WKBITS+3,INC       SET ADJUST INCR FLAG           F40704 77990421
AGAGDO42 BALR  RETREG,BRANCH                                            78000021
         LTR   BRANCH,BRANCH                                            78080021
         BNE   AGARES10                BRANCH IF ERROR RETURN           78160021
         XC    WKDATA1(16),WKDATA1      ZERO DATA FIELDS                78240021
         NI    WKBITS+2,SWOFF           TURN SWITCHES OFF               78320021
         OI    WKBITS+2,NFNL           SET NOT FIRST,NOT LAST SW        78400021
AGAGDO45 L     RETREG,WKTEMP           LOAD RETURN ADDRESS              78480021
         BR    RETREG                  RETURN                           78560021
*                                                                       78640021
*                                                                       78720021
*BEAM POSITION SET IN GDSCB WHEN NO SCISSOR OPTION                      78800021
*                                                                       78880021
AGAGDO85 MVC   GDSXLAST,WKXABS         SET XLAST                        78960021
         L     PARM,WKXABS                                              78980021
         SH    PARM,GDSXCURR            RECOMPUTE INCREMENT AND PUT     79000021
         ST    PARM,WKXINCR              IN PARAMETER                   79020021
         MVC   GDSXCURR,WKXABS+2        *    XCURR                      79040021
         MVC   GDSYLAST,WKYABS          *    YLAST AND                  79120021
         L     PARM,WKYABS                                              79140021
         SH    PARM,GDSYCURR            RECOMPUTE INCREMENT AND PUT     79160021
         ST    PARM,WKYINCR              IN PARAMETER LIST              79180021
         MVC   GDSYCURR,WKYABS+2        *    YCURR IN GDSCB             79200021
         NI    GDSSCISS,LASTON                                          79280021
         B     AGAGDO40                                                 79360021
         EJECT                                                          79440021
*                                                                       79520021
*THIS ROUTINE CHECKS THE DATA MODE SWITCH IN THE GDSCB WHEN A           79600021
*SUBROUTINE IS BEING GENERATED OR UPDATED, AND ENSURES THAT             79680021
*THE INPUT MODE IS SET TO INCREMENTAL.                                  79760021
*                                                                       79840021
*                                                                       79920021
AGASDM10 MVI   GDSDATMD,X'00'           ZERO SWITCH AREA                80000021
         TM    WKSWITCH+2,REALX                                         80080021
         BZ    AGASDM30                 BRANCH IF X VALUE INTEGER       80160021
         OI    GDSDATMD,XREALI          SWT SWITCH FOR REAL, INCR X     80240021
AGASDM20 TM    WKSWITCH+2,REALY                                         80320021
         BZ    AGASDM40                 BRANCH IF Y VALUE INTEGER       80400021
         OI    GDSDATMD,YREALI          SWT SWITCH FOR REAL, INCR Y     80480021
         BR    RETREG                                                   80560021
*                                                                       80640021
AGASDM30 OI    GDSDATMD,XINTGI          SET SWITCH FOR INTEGER, INCR X  80720021
         B     AGASDM20                                                 80800021
*                                                                       80880021
AGASDM40 OI    GDSDATMD,YINTGI          SET SWITCH FOR INTEGER, INCR Y  80960021
         BR    RETREG                                                   81040021
         EJECT                                                          81120021
*THIS ROUTINE CONVERTS THE BEAM POSITION TO REAL VALUES AND             81200021
*STORES THEM IN THE WORK AREA.                                          81280021
*ADDRESS OF X IN REG PARM                                               81360021
*ADDRESS OF Y IN REG A                                                  81440021
*                                                                       81520021
AGAFLT10 SR    REGD,REGD               SET UP LOOP CONTROL AND INDES    81600021
AGAFLT15 MVC   WKDBL(4),CONCON         SET UP CONVERSION CONST          81680021
         CLC   0(4,PARM),ZERO                                           81760021
         BE    AGAFLT50                                                 81840021
         TM    0(PARM),NEG                                              81920021
         BO    AGAFLT40                 BRANCH IF NUMBER NEGATIVE       82000021
AGAFLT20 MVC   WKDBL+4(4),0(PARM)       NO, MOVE NUMBER INTO AREA       82080021
AGAFLT30 LD    FLT0,WKDBL               GET UNNORMALIZED NUMBER INTO    82160021
*                                        FLOATING POINT REGISTER        82240021
         AD    FLT0,ZERO               NORMALIZE                        82320021
AGAFLT35 STE   FLT0,WKXNOW(REGD)                                        82400021
         LTR   REGD,REGD                                                82480021
         BCR   PLUS,RETREG             RETURN IF FINISHED               82560021
*                                                                       82640021
         LR    PARM,REGA                                                82720021
         LA    REGD,4                  SET UP NEW INDEX                 82800021
         B     AGAFLT15                                                 82880021
AGAFLT40 OI    WKDBL,NEG                SET SIGN BIT IN CONVERSION AREA 82960021
         CLC   MAXNEG(4),0(PARM)                                        83040021
         BE    AGAFLT20                 IF MAX NEG #, TREAT AS POSIT.   83120021
         L     RZERO,0(PARM)            NO,GET MAGNITUDE OF NUMBER      83200021
         LPR   RZERO,RZERO                                              83280021
         ST    RZERO,WKDBL+4                                            83360021
         B     AGAFLT30                                                 83440021
AGAFLT50 LE    FLT0,A0                                                  83520021
         B     AGAFLT35                                                 83600021
*                                                                       83680021
         EJECT                                                          83760021
*WRITE OUT UPDATE                                                       83840021
AGACOM10 LA    PARM,WKADDR                                              83920021
         L     REGA,16                  CVT                             84000021
         L     REGA,CVTLINK(REGA)       LINK LIB DCB                    84080021
*        LINK  EP=IFFAHA14,DCB=(REGA),MF=(E,(1)),SF=(E,WKSPVSR)         84160021
         LINK  EP=IFFAHA14,MF=(E,(1)),SF=(E,WKSPVSR)                    84240021
         B     AGARET10                                                 84320021
*                                                                       84400021
         EJECT                                                          84480021
*ERRORS                                                                 84560021
AGAERR00 OI    0(ERRCD),PRM             PARAMETER ERROR                 84640021
         B     AGARET20                                                 84720021
*                                                                       84800021
AGAERR10 MVC   PARMERR(4,ERRCD),ONE     GDS INVALID                     84880021
         OI    0(ERRCD),PRM                                             84960021
         B     AGARET30                                                 85040021
*                                                                       85120021
AGAERR20 MVC   PARMERR(4,ERRCD),TWO     INVALID TABLE ID                85200021
         B     AGAERR00                                                 85280021
*                                                                       85360021
AGAERR30 MVC   PARMERR(4,ERRCD),THREE   INVALID TEXT ADDRESS            85440021
         B     AGAERR00                                                 85520021
*                                                                       85600021
AGAERR40 MVC   PARMERR(4,ERRCD),FOUR    INVALID COUNT                   85680021
         B     AGAERR00                                                 85760021
*                                                                       85840021
AGAERR50 MVC   PARMERR(4,ERRCD),FIVE    INVALID HEIGHT                  85920021
         B     AGAERR00                                                 86000021
*                                                                       86080021
AGAERR60 MVC   PARMERR(4,ERRCD),SIX     INVALID WIDTH                   86160021
         B     AGAERR00                                                 86240021
*                                                                       86320021
AGAERR80 MVC   PARMERR(4,ERRCD),EIGHT   INVALID ORIENTATION             86400021
         B     AGAERR00                                                 86480021
*                                                                       86560021
AGAERR90 MVC   PARMERR(4,ERRCD),ELEVEN  GENCODE ERROR                   86640021
         B     AGAERR00                                                 86720021
*                                                                       86800021
AGAERR95 MVC   PARMERR(4,ERRCD),NINE    CORRVAL ERROR                   86880021
         B     AGAERR00                                                 86960021
*                                                                       87040021
AGAERR97 OI    0(ERRCD),STRG            MAIN STORAGE EXCEEDED           87120021
         MVC   STOR(4,ERRCD),FOUR                                       87200021
         B     AGARES10                                                 87280021
AGAERR98 OI    0(ERRCD),SCISSOR         NO DATA GENERATION              87360021
*                                                                       87440021
         B     AGARES10                                                 87520021
         EJECT                                                          87600021
*CONSTANTS                                                              87680021
ONE      DC    F'1'                                                     87760021
TWO      DC    F'2'                                                     87840021
THREE    DC    F'3'                                                     87920021
FOUR     DC    F'4'                                                     88000021
FIVE     DC    F'5'                                                     88080021
SIX      DC    F'6'                                                     88160021
SEVEN    DC    F'7'                                                     88240021
EIGHT    DC    F'8'                                                     88320021
ZERO     DC    D'0'                                                     88400021
ONEB     DC    E'-1.0'                                                  88480021
BITS     DC    B'10000111'              MULTIPLE,VECTOR,INCLUDE,        88560021
         DC    X'00'                     OPTIMIZED,FIRST PASS,NO KEY,   88640021
         DC    B'00000000'               NO CORRVAL, BEAM OFF           88720021
         DC    X'00'                                                    88800021
ONEH     DC    F'100'                                                   88880021
MASK     DC    X'FFFF7F7F'                                              88960021
EIGHTH   DC    E'0.125'                                                 89040021
TWO3RD   DC    E'0.6666667'             2/3                             89120021
RAST     DC    E'4096.0'                                                89200021
INCH     DC    E'1536.0'                                                89280021
ONEONE3  DC    E'1.333333'                                              89360021
ONE2     DC    E'12.0'                                                  89440021
ELEVEN   DC    F'11'                                                    89520021
NINE     DC    F'9'                                                     89600021
CONCON   DC    XL4'4E000000'            CONVERSION CONSTANT             89680021
CCON2    DC    X'42000000'                                              89760021
MAXNEG   DC    XL4'80000000'            MAXIMUM NEGATIVE NUMBER         89840021
FIXNAME  DC    C'GSP     '                                              89920021
A0       DC    E'0.0'                                                   90000021
ONEA     DC    E'1.0'                                                   90080021
A3       DC    E'63.0'                                                  90160021
ZAP      DS    10F                  PATCH AREA                   F40704 90210021
         EJECT                                                          90240021
WORKAREA DSECT                                                          90320021
WKPARM   DS    F                                                        90400021
WKRTNCD  DS    F                                                        90480021
WKSAVE   DS    18F                                                      90560021
WKSPVSR  DS    3F                                                       90640021
WKXCURR  DS    H                                                        90720021
WKYCURR  DS    H                                                        90800021
WKXLAST  DS    F                                                        91010021
WKYLAST  DS    F                                                        91020021
WKXNOW   DS    F                                                        91040021
WKYNOW   DS    F                                                        91120021
WKSWITCH DS    F                                                        91200021
*SWITCH FORMAT                                                          91280021
*                                       BYTE 0 - X'FF' = UPDATE         91360021
*                                       BYTE 1 - X'10' = X COR PASSED   91440021
*                                                X'01' = Y COR PASSED   91520021
*                                       BYTE 2 - COPY OF GDSDATMD SW    91600021
*                                       BYTE 3 - X'04' = 1 CHAR/WORD    91680021
*                                                X'80' = LAST PARM HIT  91760021
WKSTORAD DS    F                                                        91840021
CONCON2  DS    F                                                        91880021
WKSIN    DS    F                                                        91920021
WKCOS    DS    F                                                        92000021
WKSINS   DS    F                                                        92080021
WKCOSS   DS    F                                                        92160021
WKSPACE  DS    F                                                        92240021
WKHGT    DS    F                                                        92320021
WKWIDTH  DS    F                                                        92400021
WKNAME   DS    D                                                        92480021
WKDBL    DS    D                                                        92560021
WKXLGRID DS    F                        LAST X ON 8*8 MATRIX            92640021
WKYLGRID DS    F                        LAST Y ON 8*8 MATRIX            92720021
WKTEMP   DS    F                                                        92800021
*                                                                       92880021
*PARAMETERS PASSED TO DATA GENERATION ROUTINE                           92960021
*                                                                       93040021
WKADDR   DS    F                        KEY                             93120021
WKBITS   DS    F                         *                              93200021
WKCORVL  DS    F                         *                              93280021
WKKEY    DS    F                        ADDR OF USER KEY VARIABLE       93360021
*                                                                       93440021
*PARAMETERS PASSED TO SCALE AND SCISSOR START HERE                      93520021
WKGDS    DS    F                        ADDRESS OF GDSCB                93600021
WKRTN    DS    F                        ADDRESS OF RETURN ARRAY         93680021
WKDATA1  DS    F                                                        93760021
WKDATA2  DS    F                                                        93840021
WKDATA3  DS    F                                                        93920021
WKDATA4  DS    F                                                        94000021
WKXABS   DS    F                                                        94080021
WKYABS   DS    F                                                        94160021
WKXINCR  DS    F                                                        94240021
WKYINCR  DS    F                                                        94320021
WKTOTX   DS    F                                                        94400021
WKTOTY   DS    F                                                        94480021
WKENTCT  DS    F                                                        94560021
WKXPREV  DS    F                  ADDED TO PLIST FOR DATA GEN    A29395 94610021
WKYPREV  DS    F                  ADDED TO PLIST FOR DATA GEN    A29395 94630021
*                                                                       94640021
*PARAMETERS PASSED TO KEY TABLE MANAGEMENT START HERE                   94720021
WKGDS1   DS    F                                                        94800021
WKCODE   DS    F                                                        94880021
WKKADDR  DS    F                                                        94960021
         COPY  GDSCB                                                    95040021
         COPY  GTMCB                                                    95120021
         COPY  GSPCB                                                    95200021
         END                                                            95280021
