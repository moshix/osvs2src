         TITLE 'IFFAHA07 - SCISSOR'                                     00002013
*STATUS: CHANGE LEVEL 000                                               00004013
*                                                                       00006013
*FUNCTION/OPERATIONS:  ANALYZES IMAGE GENERATION VALUES. MODIFIES       00008013
*        COORDINATES SO THAT NO DISPLAY WILL OCCUR OUTSIDE THE USER-    00010013
*        SPECIFIED SCISSORING BOUNDARY                                  00012013
*                                                                       00014013
*ENTRY POINTS: IFFAHA07                                                 00016013
*                                                                       00018013
*INPUT:  REGISTER 1 POINTS TO A WORKAREA, THE FIRST 13 WORDS OF WHICH   00020013
*        ARE THE PARAMETER LIST                                         00022013
*    + 0 A(GDSCB)                                                       00024013
*                                                                       00026013
*    + 4 A(RETURN CODE ARRAY)                                           00028013
*                                                                       00030013
*    + 8 THE 4 WORDS STARTING HERE ARE IGNORED AS INPUT                 00032013
*                                                                       00034013
*    +24 ABSOLUTE X-VALUE TO BE SCISSORED                               00036013
*                                                                       00038013
*    +28 ABSOLUTE Y-VALUE TO BE SCISSORED                               00040013
*                                                                       00042013
*    +32 INCREMENTAL X-VALUE                                            00044013
*                                                                       00046013
*    +36 INCREMENTAL Y-VALUE                                            00048013
*                                                                       00050013
*    +40 TOTAL X-INCREMENT TO DATE                                      00052013
*                                                                       00054013
*    +44 TOTAL Y-INCREMENT TO DATE                                      00056013
*                                                                       00058013
*    +48 NUMBER OF POINTS SCISSORED TO DATE                             00060013
*                                                                       00062013
*OUTPUT: OUTPUT IS OVERLAYED OVER THE INPUT ARRAY                       00064013
*    + 0 NOT CHANGED                                                    00066013
*                                                                       00068013
*    + 4 NOT CHANGED                                                    00070013
*        THE NEXT FOUR VALUES ARE POSITIONING VALUES                    00072013
*    + 8 ABSOLUTE X                                                     00074013
*                                                                       00076013
*    +12 ABSOLUTE Y                                                     00078013
*                                                                       00080013
*    +16 INCREMENTAL X                                                  00082013
*                                                                       00084013
*    +20 INCREMENTAL Y                                                  00086013
*        THE NEXT FOUR VALUES ARE DISPLAY VALUES                        00088013
*    +24 ABSOLUTE X                                                     00090013
*                                                                       00092013
*    +28 ABSOLUTE Y                                                     00094013
*                                                                       00096013
*    +32 INCREMENTAL X                                                  00098013
*                                                                       00100013
*    +36 INCREMENTAL Y                                                  00102013
*                                                                       00104013
*    +40 UPDATED AS APPROPRIATE                                         00106013
*                                                                       00108013
*    +44 UPDATED AS APPROPRIATE                                         00110013
*                                                                       00112013
*    +48 NOT CHANGED                                                    00114013
*                                                                       00116013
*        GDSXLAST, GDSYLAST, GDSXCURR, GDSYCURR ARE UPDATE              00118013
*        APPROPRIATELY.                                                 00120013
*                                                                       00122013
*EXTERNAL ROUTINES: NONE                                                00124013
*                                                                       00126013
*EXITS-NORMAL: VIA RETURN MACRO TO CALLING PROGRAM, RETURN CODE = 0     00128013
*                                                                       00130013
*     -ERROR:  VIA RETURN MACRO, RETURN CODE=4 NO DATA, STOP GENERATION 00132013
*                                RETURN CODE=8 NO DATA,CONTINUE         00134013
*                                GENERATION                             00136013
*TABLES/WORKAREAS: GSP WORKAREA                                         00138013
*                                                                       00140013
*ATTRIBUTES: PROBLEM STATE, REENTRANT                                   00142013
*                                                                       00144013
IFFAHA07 CSECT                                                          00146013
*D070300-070600                                                  YM1963 00196000
         SAVE  (14,12)                                                  00200013
         BALR  SCS09,0                 ADDRESSABILITY FOR CSECT         00300013
         USING *,SCS09                                                  00400013
*                                                                       00500013
         LR    SCS10,SCS01             ADDRESSABILITY FOR WORKAREA      00600013
         USING SCISSR,SCS10                                             00700013
*                                                                       00800013
         L     SCS11,SCSGDSCB          ADDRESSABILITY FOR GDSCB         00900013
         USING GDSCB,SCS11                                              01000013
*                                                                       01100013
         L     SCS08,SCSRTNA           ADDRESSABILITY FOR RETURN ARRAY  01200013
         USING GSPARRAY,SCS08                                           01300013
*                                                                       01400013
         NI    GDSSCISS,ZROFLGS        MAKE SURE OLD FALGS ZERO         01450013
         LM    SCS02,SCS03,GDSXLAST                                     01500013
         C     SCS02,SCS0000           SET POSITION SWITCHES            01600013
         BL    SCS000A                 FOR CURRENT LOGICAL              01700013
         CH    SCS02,SCS4095           POSITION                         01800013
         BH    SCS000A                                                  01900013
         C     SCS03,SCS0000                                            02000013
         BL    SCS000A                                                  02100013
         CH    SCS03,SCS4095                                            02200013
         BNH   SCS000B                                                  02300013
SCS000A  OI    GDSSCISS,OFFSCR                                          02400013
*                                                                       02500013
SCS000B  C     SCS02,GDSXVILL                                           02600013
         BL    SCS000C                                                  02700013
         C     SCS02,GDSXVIUR                                           02800013
         BH    SCS000C                                                  02900013
         C     SCS03,GDSYVILL                                           03000013
         BL    SCS000C                                                  03100013
         C     SCS03,GDSYVIUR                                           03200013
         BNH   SCS000D                                                  03300013
SCS000C  OI    GDSSCISS,OFFGRID                                         03400013
*                                                                       03500013
SCS000D  LM    SCS02,SCS03,SCSXABS                                      03600013
         C     SCS02,SCS0000           ON SCREEN                        03700013
         BL    SCS001                                                   03800013
         CH    SCS02,SCS4095           NO, SET FLAG=1                   03900013
         BH    SCS001                                                   04000013
         C     SCS03,SCS0000           YES, SET FLAG=0                  04100013
         BL    SCS001                                                   04200013
         CH    SCS03,SCS4095                                            04300013
         BH    SCS001                                                   04400013
         MVI   SCSPTPOS,ONSCR                                           04500013
         B     SCS002                                                   04600013
SCS001   MVI   SCSPTPOS,OFFSCR                                          04700013
*                                                                       04800013
SCS002   C     SCS02,GDSXVILL          IS POINT                         04900013
         BL    SCS003                  ON GDS                           05000013
         C     SCS02,GDSXVIUR                                           05100013
         BH    SCS003                  YES, LEAVE FLAG SET=0            05200013
         C     SCS03,GDSYVILL                                           05300013
         BL    SCS003                  NO, SET FLAG=1                   05400013
         C     SCS03,GDSYVIUR                                           05500013
         BH    SCS003                                                   05600013
         B     SCS004                                                   05700013
SCS003   OI    SCSPTPOS,OFFGRID                                         05800013
*                                                                       05900013
SCS004   TM    GDSSCISS,SCRGDS         LAST POINT ON BOTH GDS AND       06000013
         BC    7,SCS007                SCREEN. NO, CHECK FOR SCISSORING 06100013
         TM    SCSPTPOS,SCRGDS         CURRENT POINT ON BOTH GDS AND    06200013
         BC    7,SCS007                SCREEN                           06300013
*                                                                       06400013
SCS005   XC    SCSXAPOS(16),SCSXAPOS   ZERO OUT POSITIONING VECTORS     06500013
         MVC   GDSXLAST(4),SCSXABS     SET CURRENT BEAM POSITION        06600013
         MVC   GDSYLAST(4),SCSYABS     = ABSOLUTE POSITION              06700013
SCS006   NI    GDSSCISS,ZROFLGS        REPLACE POSITION FLAGS           06800013
         MVC   GDSXCURR(2),SCSXABS+2   SET LOGICAL BEAM POSITION        06900013
         MVC   GDSYCURR(2),SCSYABS+2   = ABSOLUTE POSITION              07000013
*                                                                       08000013
         RETURN (14,12),T,RC=0                                          08100013
*                                                                       08200013
*                                                                       08300013
SCS007   TM    GDSSCISS,SCRSCIS        SCISSOR AT SCREEN                08400013
         BZ    SCS010                  NO, CHECK FOR SCISSOR AT GDS     08500013
         TM    GDSSCISS,SCR            LAST POINT ON SCREEN             08600013
         BO    SCS0070                 NO, PREPARE TO SCISSOR           08700013
         TM    SCSPTPOS,SCR            CURRENT POINT ON SCREEN          08800013
         BZ    SCS005                  YES, PLOT AS IS                  08900013
*                                                                       09000013
SCS0070  TM    GDSSCISS,STOP           DISCONTINUE GENERATION           09100013
         BO    SCS008                  YES, SET RETURN CODE AND QUIT    09200013
         MVC   SCSLIMX1(2),SCS0000     SET LIMITS = SCREEN LIMIT        09300013
         MVC   SCSLIMY1(2),SCS0000                                      09400013
         MVC   SCSLIMX2(2),SCS4095                                      09500013
         MVC   SCSLIMY2(2),SCS4095                                      09600013
         MVI   SCSSCSL,SCR             DO SCISSORING                    09700013
         B     SCS020                                                   09800013
SCS008   LA    SCS15,4                 SET REGISTER 15                  09900013
SCS009   OI    GSPARRAY,SCISS          SET RETURN CODE ARRAY            10000013
         CLC   GSPARRAY+4(4),SCS0000                                    10100013
         BNE   SCS0090                                                  10200013
         MVC   GSPARRAY+4(4),SCSCOUNT                                   10300013
SCS0090  RETURN (14,12),T,RC=(15)                                       10400013
SCS010   TM    GDSSCISS,GDS            SCISSOR AT GDS                   10500013
         BO    SCS011                  BOTH POINTS IN GDS               10600013
         TM    SCSPTPOS,GDS            NO, CHECK FOR TERMINATION        10700013
         BZ    SCS012                  YES,PREPARE FOR SCISSORING       10800013
*                                                                       10900013
SCS011   TM    GDSSCISS,STOP           DISCONTINUE GENERATION           11000013
         BO    SCS008                  YES, SET RETURN CODE AND QUIT    11100013
*                                                                       11200013
*        DETERMINE GDS SCISSORING LIMITS                                11300013
SCS012   MVI   SCSSCSL,SCRGDS                                           11400013
         L     SCS02,GDSXVILL          LOWER X LIMIT ON SCREEN          11500013
         CH    SCS02,SCS0000                                            11600013
         BL    SCS013                  YES, LOWER LEFT SCISSORING       11700013
         STH   SCS02,SCSLIMX1          LIMIT = GDS LIMIT                11800013
         B     SCS014                                                   11900013
SCS013   MVC   SCSLIMX1(2),SCS0000     NO, USE SCREEN LIMIT             12000013
*                                                                       12100013
SCS014   L     SCS02,GDSYVILL          LOWER Y LIMIT ON SCREEN          12200013
         CH    SCS02,SCS0000                                            12300013
         BL    SCS015                  YES, LOWER LEFT SCISSORING       12400013
         STH   SCS02,SCSLIMY1          LIMIT = GDS LIMITS               12500013
         B     SCS016                                                   12600013
SCS015   MVC   SCSLIMY1(2),SCS0000     NO, USE SCREEN LIMIT             12700013
*                                                                       12800013
SCS016   L     SCS02,GDSXVIUR          UPPER X LIMIT ON SCREEN          12900013
         CH    SCS02,SCS4095                                            13000013
         BH    SCS017                  YES, UPPER X SCISSORRING LIMIT   13100013
         STH   SCS02,SCSLIMX2          = GDS LIMIT                      13200013
         B     SCS018                                                   13300013
SCS017   MVC   SCSLIMX2(2),SCS4095     NO, USE SCREEN LIMIT             13400013
*                                                                       13500013
SCS018   L     SCS02,GDSYVIUR          UPPER Y LIMIT ON SCREEN          13600013
         CH    SCS02,SCS4095                                            13700013
         BH    SCS019                  YES, UPPER Y SCISSORING          13800013
         STH   SCS02,SCSLIMY2          LIMIT= GDS LIMIT                 13900013
         B     SCS020                                                   14000013
SCS019   MVC   SCSLIMY2(2),SCS4095     NO, USE SCREEN LIMIT             14100013
*                                                                       14200013
*        COMPUTE NUMBER AND LOCATION OF INTERSECTIONS WITH BOUNDARY     14300013
*                                                                       14400013
         DROP  SCS08                   DROP RETURN ARRAY ADDRESSABILITY 14500013
*                                                                       14600013
SCS020   L     SCS02,SCSXABS           COMPUTE DX                       14700013
         S     SCS02,GDSXLAST                                           14800013
         C     SCS02,SCS0000           IS DX=0                          14900013
         BNE   SCS021                  IF NOT, GO TO TEST Y             15000013
         MVC   SCSPT3X(4),GDSXLAST     OTHERWISE, SET PT3=X1,YL         15100013
         LH    SCS04,SCSLIMY1                                           15200013
         ST    SCS04,SCSPT3Y                                            15300013
         MVC   SCSPT4X(4),GDSXLAST                SET PT4=X1,YH         15400013
         LH    SCS04,SCSLIMY2                                           15500013
         ST    SCS04,SCSPT4Y                                            15600013
         B     SCS022                  GO TO SET NI VALUE TO 2          15700013
*                                                                       15800013
SCS021   L     SCS03,SCSYABS           COMPUTE DY                       15900013
         S     SCS03,GDSYLAST                                           16000013
         C     SCS03,SCS0000           IS DY =0                         16100013
         BNE   SCS023                  IF NOT GO TO SET NI=4            16200013
         LH    SCS04,SCSLIMX1          OTHERWISE SET PT3=XL,Y1          16300013
         ST    SCS04,SCSPT3X                                            16400013
         MVC   SCSPT3Y(4),GDSYLAST                                      16500013
         LH    SCS04,SCSLIMX2                AND SET PT4=XH,Y1          16600013
         ST    SCS04,SCSPT4X                                            16700013
         MVC   SCSPT4Y(4),GDSYLAST                                      16800013
*                                                                       16900013
SCS022   MVC   SCSNI,SCS0002           SET NI = 2                       17000013
         B     SCS035                  ELIMINATE OUTSIDE POINTS         17100013
*                                                                       17200013
SCS023   MVC   SCSNI,SCS0004           SET NI = 4                       17300013
         L     SCS05,GDSYLAST          COMPUTE B= Y1 - MX1              17400013
         LR    SCS06,SCS03                                              17500013
         SRDA  SCS06,32                                                 17600013
         M     SCS06,GDSXLAST          WHERE MX1=X1*DY/DX               17700013
         DR    SCS06,SCS02                                              17800013
         SR    SCS05,SCS07             Y1-MX1                           17900013
*                                                                       18000013
         LH    SCS04,SCSLIMX1          COMPARE XL TO X1                 18100013
         C     SCS04,GDSXLAST                                           18200013
         BE    SCS027                  IF EQUAL GO TO SET PT3=PT1       18300013
         C     SCS04,SCSXABS           COMPARE TO X2                    18400013
         BE    SCS028                  IF EQUAL GO TO SET PT3=PT2       18500013
         ST    SCS04,SCSPT3X                                            18600013
         LR    SCS06,SCS03             Y3 =MX2+B                        18700013
         SRDA  SCS06,32                                                 18800013
         MR    SCS06,SCS04             WHERE MX2=X1*DY/DX               18900013
         DR    SCS06,SCS02                                              19000013
         AR    SCS07,SCS05             PLUS B TO MX2                    19100013
         ST    SCS07,SCSPT3Y           SAVE COMPUTED PT3 Y COORDINATE   19200013
*                                                                       19300013
SCS024   LH    SCS04,SCSLIMX2          CHECK IF X1 OR X2 = XH           19400013
         C     SCS04,GDSXLAST                                           19500013
         BE    SCS029                  IF X1=XH GO TO SET PT4=PT1       19600013
         C     SCS04,SCSXABS                                            19700013
         BE    SCS030                  IF X2=XH GO TO SET PT4=PT2       19800013
         ST    SCS04,SCSPT4X           OTHERWISE, X4=XH                 19900013
         LR    SCS06,SCS03             Y4=MXH+B                         20000013
         SRDA  SCS06,32                                                 20100013
         MR    SCS06,SCS04                                              20200013
         DR    SCS06,SCS02                                              20300013
         AR    SCS07,SCS05                                              20400013
         ST    SCS07,SCSPT4Y                                            20500013
*                                                                       20600013
SCS025   LH    SCS04,SCSLIMY1          CHECK IF Y1 OR Y2=YL             20700013
         C     SCS04,GDSYLAST                                           20800013
         BE    SCS031                  IF Y1=YL GO TO SET PT5=PT1       20900013
         C     SCS04,SCSYABS                                            21000013
         BE    SCS032                  IF Y2=YL GO TO SET PT5=PT2       21100013
         ST    SCS04,SCSPT5Y           OTHERWISE Y5=YL                  21200013
         SR    SCS04,SCS05             X5=(YL-B)/M OR (YL-B)*DX/DY      21300013
         LR    SCS06,SCS02             WHERE M=DX/DY                    21400013
         SRDA  SCS06,32                                                 21500013
         MR    SCS06,SCS04                                              21600013
         DR    SCS06,SCS03                                              21700013
         ST    SCS07,SCSPT5X                                            21800013
*                                                                       21900013
SCS026   LH    SCS04,SCSLIMY2          CHECK IF Y1 OR Y2=YH             22000013
         C     SCS04,GDSYLAST                                           22100013
         BE    SCS033                  IF Y1=YH GO TO SET PT6=PT1       22200013
         C     SCS04,SCSYABS                                            22300013
         BE    SCS034                  IF Y2=YH GO TO SET PT6=PT2       22400013
         ST    SCS04,SCSPT6Y           OTHERWISE, Y6=YH                 22500013
         SR    SCS04,SCS05             X6=(YH-B)/M OR (YH-B)*DX/DY      22600013
         LR    SCS06,SCS02             WHERE M=DY/DX                    22700013
         SRDA  SCS06,32                                                 22800013
         MR    SCS06,SCS04                                              22900013
         DR    SCS06,SCS03                                              23000013
         ST    SCS07,SCSPT6X           STORE COMPURED X6                23100013
         B     SCS035                                                   23200013
*                                                                       23300013
SCS027   MVC   SCSPT3(8),GDSXLAST      SET PT3=PT1                      23400013
         B     SCS024                                                   23500013
SCS028   MVC   SCSPT3(8),SCSXABS       SET PT3=PT2                      23600013
         B     SCS024                                                   23700013
*                                                                       23800013
SCS029   MVC   SCSPT4(8),GDSXLAST      SET PT4=PT1                      23900013
         B     SCS025                                                   24000013
SCS030   MVC   SCSPT4(8),SCSXABS       SET PT4=PT2                      24100013
         B     SCS025                                                   24200013
*                                                                       24300013
SCS031   MVC   SCSPT5(8),GDSXLAST      SET PT5=PT1                      24400013
         B     SCS026                                                   24500013
SCS032   MVC   SCSPT5(8),SCSXABS       SET PT5=PT2                      24600013
         B     SCS026                                                   24700013
*                                                                       24800013
SCS033   MVC   SCSPT6(8),GDSXLAST      SET PT6=PT1                      24900013
         B     SCS035                                                   25000013
SCS034   MVC   SCSPT6(8),SCSXABS       SET PT6=PT2                      25100013
*                                                                       25200013
*                                                                       25300013
*        ELIMINATE POINTS OUTSIDE BOUNDARY AND/OR LINE LIMITS           25400013
*                                                                       25500013
SCS035   L     SCS07,SCS0001           LOAD 1 TO I COUNT                25600013
         SR    SCS05,SCS05             CLEAR INDEX REGISTER             25700013
         SR    SCS06,SCS06             LOAD 0 TO ZERO COUNT             25800013
         SR    SCS08,SCS08             CLEAR POSITION REGISTER          25900013
         L     SCS04,GDSXLAST          LOAD X1                          26000013
         C     SCS04,SCSXABS           COMPARE X1 TO X2                 26100013
         BH    SCS036                  AND SET XR=MIN(X1,X2)            26200013
         MVC   SCSXR(4),GDSXLAST               XS=MAX(X1,X2)            26300013
         MVC   SCSXS(4),SCSXABS                                         26400013
         B     SCS037                                                   26500013
SCS036   MVC   SCSXR(4),SCSXABS                                         26600013
         MVC   SCSXS(4),GDSXLAST                                        26700013
*                                                                       26800013
SCS037   L     SCS04,GDSYLAST          LOAD Y1                          26900013
         C     SCS04,SCSYABS           COMPARE Y1 TO Y2                 27000013
         BH    SCS038                  AND SET YR=MIN(Y1,Y2)            27100013
         MVC   SCSYR(4),GDSYLAST               YS=MAX(Y1,Y2)            27200013
         MVC   SCSYS(4),SCSYABS                                         27300013
         B     SCS039                                                   27400013
SCS038   MVC   SCSYS(4),GDSYLAST                                        27500013
         MVC   SCSYR(4),SCSYABS                                         27600013
*                                                                       27700013
SCS039   L     SCS02,SCSPT3X(SCS05)    GET COMPUTED POINTS              27800013
         LH    SCS04,SCSLIMX1                                           27900013
         CR    SCS02,SCS04             CHECK IF PT OUTSIDE LEFT LIMIT   28000013
         BL    SCS042                                                   28100013
         C     SCS02,SCSXR             COMPARE WITH LINE RANGE          28200013
         BL    SCS042                  MASK IF NOT IN RANGE             28300013
         LH    SCS04,SCSLIMX2                                           28400013
         CR    SCS02,SCS04             COMPARE THE PT WITH BOUNDARY     28500013
         BH    SCS042                  MASK IT IF OUTSIDE BOUNDARY      28600013
         C     SCS02,SCSXS             CHECK IF OUTSIDE LINE RANGE      28700013
         BH    SCS042                                                   28800013
*                                                                       28900013
         L     SCS03,SCSPT3Y(SCS05)                                     29000013
         LH    SCS04,SCSLIMY1                                           29100013
         CR    SCS03,SCS04             IS THE PT OUTSIDE THE BOUNDARY   29200013
         BL    SCS042                                                   29300013
         C     SCS03,SCSYR             IS THE PT OUTSIDE THE LINE       29400013
         BL    SCS042                                                   29500013
         LH    SCS04,SCSLIMY2                                           29600013
         CR    SCS03,SCS04             IS THE PT OUTSIDE THE BOUNDARY   29700013
         BH    SCS042                                                   29800013
         C     SCS03,SCSYS             IS PT OUTSIDE THE LINE           29900013
         BH    SCS042                                                   30000013
         C     SCS02,GDSXLAST          IS THIS PT SAME AS PT1           30100013
         BNE   SCS040                  IF NOT, COMPARE TO PT2           30200013
         C     SCS03,GDSYLAST                                           30300013
         BE    SCS042                  IDENTICAL TO PT1, ELIMINATE      30400013
*                                                                       30500013
SCS040   C     SCS02,SCSXABS           IS THIS PT SAME AS PT2           30600013
         BNE   SCS041                  NO, BUILD UP INTERSECTIONS       30700013
         C     SCS03,SCSYABS                                            30800013
         BE    SCS042                  IDENTICAL TO PT2, ELIMINATE      30900013
*                                                                       31000013
SCS041   STH   SCS02,SCSINTX1(SCS08)   BUILD UP INTERSECTIONS           31100013
         STH   SCS03,SCSINTY1(SCS08)                                    31200013
         A     SCS08,SCS0004           INDEX BY 4                       31300013
         B     SCS043                                                   31400013
SCS042   A     SCS06,SCS0001           ADD 1 TO OUT COUNT               31500013
SCS043   A     SCS07,SCS0001           I=I+1                            31600013
         C     SCS07,SCSNI             IS I GREATER THAN NI             31700013
         BH    SCS044                  YES, COMPUTE FINAL NI            31800013
         A     SCS05,SCS0008           INDEX AND CHECK NEXT             31900013
         B     SCS039                                                   32000013
*                                                                       32100013
SCS044   L     SCS04,SCSNI             NI=NI-OUT                        32200013
         SR    SCS04,SCS06                                              32300013
         ST    SCS04,SCSNI                                              32400013
SCS045   CLC   SCSNI(4),SCS0002        IS NI = 2                        32500013
         BH    SCS047                  IF YES ELIMINATE DUPLICATES      32600013
         BL    SCS050                                                   32700013
SCS046   CLC   SCSINTS1(4),SCSINTS2    CHECK IF TWO POINTS THE SAME     32800013
         BNE   SCS050                                                   32900013
         MVC   SCSNI(4),SCS0001        ELIMINATE DUPLICATE              33000013
         B     SCS050                                                   33100013
*                                                                       33200013
SCS047   CLC   SCSINTS1(4),SCSINTS2                                     33300013
         BNE   SCS049                  IF THESE TWO PTS = TAKE 2 & 3    33400013
         MVC   SCSINTS1(8),SCSINTS2                                     33500013
SCS049   MVC   SCSNI(4),SCS0002                                         33600013
SCS050   MVC   GDSXLAST(8),SCSXABS     UPDATE LOGICAL POSITION          33700013
         L     SCS08,SCSRTNA           REESTABLISH ADDRESSABILITY       33800013
         USING GSPARRAY,SCS08          TO RETURN ARRAY                  33900013
         CLC   SCSNI(4),SCS0001        CHECK NUMBER OF INTERSECTIONS    34000013
         BE    SCS054                  ONE                              34100013
         BH    SCS056                  TWO                              34200013
         IC    SCS02,SCSSCSL           ZERO, IS END-POINT ON BOUNDARY   34300013
         EX    SCS02,SCS058                                             34400013
         BC    7,SCS053                NO, SUPPRESS PLOT                34500013
SCS051   MVC   SCSXAPOS(8),SCSXABS     MOVE IN ABSOLUTE POSITIONING     34600013
*                                      VALUES                           34700013
         XC    SCSXINC(8),SCSXINC                                       34800013
         L     SCS02,SCSXAPOS          COMPUTE INCREMENTAL POSITION-    34900013
         SH    SCS02,GDSXCURR          ING VALUES FOR X                 35000013
         ST    SCS02,SCSXIPOS                                           35100013
         L     SCS02,SCSYAPOS          AND Y                            35200013
         SH    SCS02,GDSYCURR                                           35300013
         ST    SCS02,SCSYIPOS                                           35400013
SCS052   OI    GSPARRAY,SCISS          AND SET SWITCH                   35500013
         CLC   GSPARRAY+4(4),SCS0000   RETURN CODE NOT SET              35600013
         BNE   SCS006                  YES, SET IT                      35700013
         MVC   GSPARRAY+4(4),SCSCOUNT  OTHERWISE, CONTINUE              35800013
         B     SCS006                                                   35900013
*                                                                       36000013
SCS053   MVC   GDSXLAST(8),SCSXABS     UPDATE LOGICAL POSITION          36100013
         NI    GDSSCISS,ZROFLGS        REPLACE OLD POSITION             36200013
         XC    SCSXAPOS(32),SCSXAPOS   ZERO DATA                        36400013
         LA    SCS15,8                                                  36500013
         B     SCS009                                                   36600013
*                                                                       36700013
SCS054   IC    SCS02,SCSSCSL           FIRST POINT IN BOUNDARY          36800013
         EX    SCS02,SCS057                                             36900013
         BZ    SCS055                  YES                              37000013
         EX    SCS02,SCS058            NO. IS SECOND POINT IN BOUNDARY  37100013
         BC    7,SCS053                NO, SUPPRESS PLOT                37200013
         LH    SCS02,SCSINTX1          POSITION TO INTERSECTION         37300013
         ST    SCS02,SCSXAPOS          GET X ABSOLUTE                   37400013
         SH    SCS02,GDSXCURR          COMPUTE X INCREMENT              37500013
         ST    SCS02,SCSXIPOS                                           37600013
         LH    SCS02,SCSINTY1          GET Y ABSOLUTE                   37700013
         ST    SCS02,SCSYAPOS                                           37800013
         SH    SCS02,GDSYCURR          COMPUTE Y INCREMENT              37900013
         ST    SCS02,SCSYIPOS                                           38000013
         L     SCS02,SCSXABS           GET X INCREMENT FROM             38100013
         S     SCS02,SCSXAPOS          POSITIONING TO FINAL POINT       38200013
         ST    SCS02,SCSXINC                                            38300013
         L     SCS02,SCSYABS           GET CORRESPONDING                38400013
         S     SCS02,SCSYAPOS          Y INCREMENT                      38500013
         ST    SCS02,SCSYINC                                            38600013
         B     SCS052                                                   38700013
*                                                                       38800013
SCS055   XC    SCSXAPOS(16),SCSXAPOS   PLOT TO POINT OF INTERSECTION    38900013
         LH    SCS02,SCSINTX1          MOVE IN ABSOLUTE X VALUE         39000013
         ST    SCS02,SCSXABS                                            39100013
         SH    SCS02,GDSXCURR          COMPUTE NEW INCREMENT            39200013
         ST    SCS02,SCSXINC                                            39300013
         LH    SCS02,SCSINTY1          MOVE IN ABSOLUTE Y VALUE         39400013
         ST    SCS02,SCSYABS                                            39500013
         SH    SCS02,GDSYCURR          COMPUTE NEW INCREMENT            39600013
         ST    SCS02,SCSYINC                                            39700013
         B     SCS052                                                   39800013
*                                                                       39900013
SCS056   L     SCS02,GDSXLAST          GET DISPLACEMENTS FROM           40000013
         SH    SCS02,SCSINTX1          LOGICAL ENDPOINT TO              40100013
         LPR   SCS02,SCS02             BOTH INTERSECTIONS               40200013
         L     SCS03,GDSXLAST                                           40300013
         SH    SCS03,SCSINTX2                                           40400013
         LPR   SCS03,SCS03             DISPLACEMENT TO SECOND LESS,     40500013
         CR    SCS03,SCS02             PLOT AS IS                       40600013
         BL    SCS061                  EQUAL, CHECK Y DISPLACEMENTS     40700013
         BE    SCS059                  DISPLACEMENT TO FIRST LESS,      40800013
         LM    SCS02,SCS03,SCSINTS1    REVERSE INTERSECTIONS AND PLOT   40900013
         ST    SCS02,SCSINTS2                                           41000013
         ST    SCS03,SCSINTS1                                           41100013
         B     SCS061                                                   41200013
*                                                                       41300013
SCS059   L     SCS02,GDSYLAST          GET MAGNITUDE OF YDISPLACEMENTS  41400013
         SH    SCS02,SCSINTY1          FROM LOGICAL ENDPOINT            41500013
         LPR   SCS02,SCS02             TO BOTH INTERSECTIONS            41600013
         L     SCS03,GDSYLAST                                           41700013
         SH    SCS03,SCSINTY2                                           41800013
         LPR   SCS03,SCS03                                              41900013
         CR    SCS03,SCS02             DISPLACEMENT TO SECOND LESS OR   42000013
         BNH   SCS061                  EQUAL TO FIRST, PLOT AS IS       42100013
         LM    SCS02,SCS03,SCSINTS1    OTHERWISE, REVERSE INTERSECTIONS 42200013
         ST    SCS02,SCSINTS2                                           42300013
         ST    SCS03,SCSINTS1                                           42400013
*                                                                       42500013
SCS061   LH    SCS02,SCSINTX1          PLOT FROM FIRST TO SECOND        42600013
         ST    SCS02,SCSXAPOS          INTERSECTION                     42700013
         SH    SCS02,GDSXCURR          STORE ABSOLUTE AND INCREMENTAL   42800013
         ST    SCS02,SCSXIPOS          POSITIONING VALUES               42900013
         LH    SCS02,SCSINTX2          STORE FINAL ABSOLUTE POSITION    43000013
         ST    SCS02,SCSXABS                                            43100013
         S     SCS02,SCSXAPOS          AND INCREMENT TO IT              43200013
         ST    SCS02,SCSXINC                                            43300013
*                                                                       43400013
         LH    SCS02,SCSINTY1                                           43500013
         ST    SCS02,SCSYAPOS          ABSOLUTE POSITIONING VALUE       43600013
         SH    SCS02,GDSYCURR          AND INCREMENT TO IT              43700013
         ST    SCS02,SCSYIPOS                                           43800013
         LH    SCS02,SCSINTY2                                           43900013
         ST    SCS02,SCSYABS           ABSOLUTE FINAL VALUE             44000013
         S     SCS02,SCSYAPOS          AND INCREMENT TO IT              44100013
         ST    SCS02,SCSYINC                                            44200013
         B     SCS052                                                   44300013
*                                                                       44400013
SCS057   TM    GDSSCISS,X'00'                                           44500013
SCS058   TM    SCSPTPOS,X'00'                                           44600013
*                                                                       44700013
SCS4095  DC    H'4095'                                                  44800013
SCS0000  DC    F'0'                                                     44900013
SCS0001  DC    F'1'                                                     45000013
SCS0002  DC    F'2'                                                     45100013
SCS0004  DC    F'4'                                                     45200013
SCS0008  DC    F'8'                                                     45300013
*                                                                       45400013
SCS01    EQU   1                       REGISTER EQUATES                 45500013
SCS02    EQU   2                                                        45600013
SCS03    EQU   3                                                        45700013
SCS04    EQU   4                                                        45800013
SCS05    EQU   5                                                        45900013
SCS06    EQU   6                                                        46000013
SCS07    EQU   7                                                        46100013
SCS08    EQU   8                                                        46200013
SCS09    EQU   9                                                        46300013
SCS10    EQU   10                                                       46400013
SCS11    EQU   11                                                       46500013
SCS15    EQU   15                                                       46600013
*                                                                       46700013
ONSCR    EQU   0                                                        46800013
OFFSCR   EQU   X'80'                                                    46900013
OFFGRID  EQU   X'40'                                                    47000013
SCRGDS   EQU   X'C0'                                                    47100013
ZROFLGS  EQU   X'3F'                                                    47200013
SCRSCIS  EQU   X'08'                                                    47300013
SCR      EQU   X'80'                                                    47400013
GDS      EQU   X'40'                                                    47500013
STOP     EQU   X'01'                                                    47600013
SCISS    EQU   X'40'                                                    47700013
TRUNC    EQU   X'FC'                                                    47730013
*                                                                       47760013
SCISSR   DSECT                                                          47800013
SCSGDSCB DS    F                                                        47900013
SCSRTNA  DS    F                                                        48000013
SCSXAPOS DS    F                                                        48100013
SCSYAPOS DS    F                                                        48200013
SCSXIPOS DS    F                                                        48300013
SCSYIPOS DS    F                                                        48400013
SCSXABS  DS    F                                                        48500013
SCSYABS  DS    F                                                        48600013
SCSXINC  DS    F                                                        48700013
SCSYINC  DS    F                                                        48800013
SCSXITOT DS    F                                                        48900013
SCSYITOT DS    F                                                        49000013
SCSCOUNT DS    F                                                        49100013
*                                                                       49200013
SCSLIM   DS    2F                                                       49300013
         ORG   SCSLIM                                                   49400013
SCSLIMX1 DS    H                                                        49500013
SCSLIMY1 DS    H                                                        49600013
SCSLIMX2 DS    H                                                        49700013
SCSLIMY2 DS    H                                                        49800013
*                                                                       49900013
SCSNI    DS    F                                                        50000013
SCSINTS1 DS    F                                                        50100013
         ORG   SCSINTS1                                                 50200013
SCSINTX1 DS    H                                                        50300013
SCSINTY1 DS    H                                                        50400013
SCSINTS2 DS    F                                                        50500013
         ORG   SCSINTS2                                                 50600013
SCSINTX2 DS    H                                                        50700013
SCSINTY2 DS    H                                                        50800013
SCSPT3   DS    2F                                                       50900013
         ORG   SCSPT3                                                   51000013
SCSPT3X  DS    F                                                        51100013
SCSPT3Y  DS    F                                                        51200013
SCSPT4   DS    2F                                                       51300013
         ORG   SCSPT4                                                   51400013
SCSPT4X  DS    F                                                        51500013
SCSPT4Y  DS    F                                                        51600013
SCSPT5   DS    2F                                                       51700013
         ORG   SCSPT5                                                   51800013
SCSPT5X  DS    F                                                        51900013
SCSPT5Y  DS    F                                                        52000013
SCSPT6   DS    2F                                                       52100013
         ORG   SCSPT6                                                   52200013
SCSPT6X  DS    F                                                        52300013
SCSPT6Y  DS    F                                                        52400013
SCSXR    DS    F                                                        52500013
SCSXS    DS    F                                                        52600013
SCSYR    DS    F                                                        52700013
SCSYS    DS    F                                                        52800013
SCSPTPOS DS    C                                                        52900013
SCSSCSL  DS    C                                                        53000013
         COPY  GDSCB                                                    53100013
         COPY  GSPCB                                                    53200013
         END                                                            53300013
