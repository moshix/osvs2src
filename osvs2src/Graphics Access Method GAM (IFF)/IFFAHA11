*TITLE         DIRECTOR PART2                                           00400021
*                                                                       00800021
*MODULE NAME   IFFAHA11                                                 01200021
*                                                                       01600021
*INPUT         OUTPUT FROM DIRECTOR PART 2                              02000021
*                                                                       02400021
*              REG1  ADDRESS OF USERS PARAMETER LIST                    02800021
*                                                                       03200021
*              REG2  ADDRESS OF GSPCB                                   03600021
*                                                                       04000021
*              REG3  DISPLACEMENT NUMBER                                04400021
*                                                                       04800021
*              REG9  ENTRY ADDRESS                                      05200021
*                                                                       05600021
*              REG13 UNCHANGED                                          06000021
*                                                                       06400021
*              REG14 UNCHANGED                                          06800021
*                                                                       07200021
*OUTPUT        NONE TO CALLER                                           07600021
*ERRORS        NONE                                                     08000021
*                                                                       08400021
*FUNCTION      USES DISPLACEMENT NUMBER * 4 IN REFERENCING              08800021
*                                                                       09200021
*              STATUS TABLE.  IT WILL CALL, LOAD AND CALL, OR           09600021
*                                                                       10000021
*              LINK TO THE MODULE IDENTIFIED IN THE STATUS              10400021
*                                                                       10800021
*              TABLE ENTRY                                              11200021
*                                                                       11600021
*OUTPUT TO GSP                                                          12000021
* SUBROUTINE   REG1  ADDRESS OF WORKAREA                                12400021
*                                                                       12800021
*              FIRST WORD OF WORK AREA IS ADDRESS OF USERS PLIST        13200021
*                                                                       13600021
*              SECOND WORD IS ADDRESS OF GSP RETURN ARRAY               14000021
*                                                                       14400021
*              REG13  ADDRESS OF SAVE AREA                              14800021
*                                                                       15200021
*              REG14 RETURN ADDRESS ( TO DIRECTOR 2)                    15600021
*                                                                       16000021
*              REG15 ENTRY ADDRESS OF INVOKED ROUTINE                   16400021
         EJECT                                                          16800021
*REGISTER EQUATES****************************************************** 17200021
R0       EQU   0                                                        17600021
R1       EQU   1                                                        18000021
R2       EQU   2                                                        18400021
R3       EQU   3                                                        18800021
R4       EQU   4                                                        19200021
R5       EQU   5                                                        19600021
R6       EQU   6                                                        20000021
R7       EQU   7                                                        20400021
R8       EQU   8                                                        20800021
R9BASE   EQU   9                                                        21200021
R12      EQU   12                                                S21016 21400021
R13      EQU   13                                                       21600021
R14      EQU   14                      RETURN ADDR REG           S21016 21800021
R15      EQU   15                                                       22000021
         EJECT                                                          22400021
IFFAHA11 CSECT                                                          22800021
*D6000000,A                                                      S21016 23000021
*A598900,C599400                                                  M1097 23050021
         USING *,R9BASE                                                 23200021
         USING GSPCB,R2                                                 23600021
         TS    GSPBUSYS                SET  GSP BUSY                    24000021
*                                                                       24400021
*NOTE:  CONDITION CODE NOT TESTED.  NEED FOR DIRECT ENTRY               24800021
*                                                                       25200021
*STRUCTURE WORK AREA                                                    25600021
*                                                                       26000021
         L     R4,GSPAWORK             GET ADDRESS OF WORK AREA         26400021
         ST    R1,0(R4)                SET USER PLIST INTO FIRST WORD,  26800021
         LA    R1,GSPARRAY                                              27200021
         ST    R1,4(R4)                SET RETURN ARRAY INTO SECOND     27600021
*                                                                       28000021
*CHAIN AND ESTABLISH SAVE AREA (IN WORK AREA)                           28400021
*                                                                       28800021
         ST    R13,USERSAVE+4(R4)                                       29200021
         LA    R5,USERSAVE(R4)                                          29600021
         ST    R5,8(R13)                                                30000021
         LR    R13,R5                                                   30400021
*                                                                       30800021
*LOCATE MODULE IN STATUS TABLE                                          31200021
*                                                                       31600021
         L     R5,GSPASTAT             GET ADDRESS OF STATUS TABLE      32000021
         LR    R10,R3              SAVE DISPLACEMENT             S21016 32200021
         MH    R3,HCON3                USE DIFF NUMBR*3 FOR INDEX       32400021
         LR    R8,R3                    SAVE COPY OF STAT ID            32800021
         AR    R8,R5                                                    33200021
         L     R15,0(R5,R3)            GET EP ADDR FROM STATAB          33600021
         LTR   R15,R15                                                  34000021
         BZ    AHAD2010                EP IS ZERO, MODULE NOT LOADED    34400021
*                                                                       34800021
*CALL GSP SUBROUTINE                                                    35200021
*                                                                       35600021
*R13 HAS CHAINED SAVE AREA                                              36000021
*R4 HAS WORK AREA ADDR, WORK AREA IS SET UP                             36400021
*R15 HAS ENTRY POINT ADDRESS                                            36800021
*                                                                       37200021
AHAD2040 LR    R1,R4                   PUT WORK AREA DDDR INTO REG1     37600021
         CALL  (15)                    CALL GSP SUBROUTINE              38000021
         EJECT                                                          38200021
*                                                                       38400021
*BACK FROM ROUTINE, SET TO EXIT TO USER                                 38800021
*                                                                       39200021
AHAD2050 CLI   GSPARRAY,R0                                              39600021
         BE    AHAD2055                                                 40000021
         L     R5,GSPASTAT        ADDRESS OF STATUS TABLE        S21016 40010021
         USING STATTBL,R5          R5 BASE FOR STATUS TABLE      S21016 40020021
         SRL   R10,TWO            DIVIDE DISP BY FOUR            S21016 40030021
         MH    R10,H5              DISP NBR * 5 FOR NAME TBL     S21016 40040021
         LA    R11,TABLE           ADDR OF NAME TABLE            S21016 40050021
         AR    R11,R10             POINTS TO SUBRTN NAME -       S21016 40060021
         TM    GSPARRAY,X'04'     TEST FOR I/O ERROR             S21016 40070021
         BO    PD10               IT WAS                         S21016 40080021
PD20     EQU   *                                                 S21016 40090021
         TM    GSPARRAY,X'08'     TEST FOR PARAMETER ERROR       S21016 40100021
         BO    PD3                IT WAS                         S21016 40110021
PD30     EQU   *                                                 S21016 40120021
         TM    GSPARRAY,X'10'     TEST FOR STORAGE EXCEEDED      S21016 40130021
         BO    PD2                IT WAS                         S21016 40140021
         B     PD4                CHECK FOR TERM MSG             S21016 40150021
PD1      MVC   N0(FIVE,R6),N0(R11) SUBRTN NAME TO MSG            S21016 40160021
         WTO   MF=(E,(R1))         ISSUE WTO                     S21016 40170021
         BR    R7                 CONTINUE PROCESSING            S21016 40180021
* AT THIS POINT CONTINUE NORMAL PROCESSING                       S21016 40190021
PD0      EQU   *                   NORMAL PROCESSING             S21016 40200021
         L     R5,GSPNULLV                                              40400021
         L     R5,0(R5)                 PICK UP NULL VARIABLE           40800021
         LTR   R5,R5                                                    41200021
         BNL   AHAD2051                 BRANCH IF PLUS OR ZERO          41600021
         MVI   GSPDUMP,DUMP                                             42000021
         LPR   R5,R5                                                    42400021
AHAD2051 C     R5,SEVEN                                                 42800021
         BL    AHAD2052                 BRANCH IF LESS THAN 7           43200021
         LA    R5,6                     OTHERWISE SET VALUE TO 6        43600021
AHAD2052 IC    R5,TAB(R5)               PICK UP CONVERSION FACTOR       44000021
         STC   R5,GSPABEND                 AND SAVE IT                  44400021
         CLC   GSPARRAY(1),GSPABEND                                     44800021
         BNH   AHAD2100                 BRANCH IF ABEND                 45200021
AHAD2055 L     R13,USERSAVE+4(R4)       GET USER SAVE AREA ADDRESS      45600021
         MVI   GSPBUSYS,X'00'          SET GSP NOT BUSY                 46000021
         RETURN (14,12),T                                               46400021
         EJECT                                                          46403021
PD2      EQU   *                                                 S21016 46406021
         LA    R7,PD4             ADDR OF NEXT                   S21016 46409021
         CLI   GSPARRAY+F,X'01'    UPDATE FAIL?                  S21016 46412021
         BE    PD5                 YES                           S21016 46415021
         CLI   GSPARRAY+F,X'02'    GDS SPACE UNAVAILABLE?        S21016 46418021
         BE    PD6                 YES                           S21016 46421021
         CLI   GSPARRAY+F,X'03'    BUFFER NOT AVAILABLE?         S21016 46424021
         BE    PD8                YES                            S21016 46427021
         CLI   GSPARRAY+F,X'04'   MAIN STORAGE EXCEEDED?         S21016 46430021
         BE    PD9                IT WAS                         S21016 46433021
         B     PD0                TAKE NO  ACTION                S21016 46436021
PD5      EQU   *                                                 S21016 46439021
         LA    R6,NAME2            ADDR OF NAME FLD IN MSG 2     S21016 46442021
         LA    R1,MSG2             POINTS TO IFF602I             S21016 46445021
         B     PD1                 GO ISSUE WTO                  S21016 46448021
*                                                                S21016 46451021
PD6      EQU   *                                                 S21016 46454021
         LA    R6,NAME3            ADDR OF NAME FLD IN MSG 3     S21016 46457021
         LA    R1,MSG3             POINTS TO IFF603I             S21016 46460021
         B     PD1                  GO ISSUE WTO                 S21016 46463021
*                                                                S21016 46466021
*                                                                S21016 46469021
PD8      EQU   *                                                 S21016 46472021
         LA    R6,NAME4            ADDR OF NAME FLD IN MSG 4     S21016 46475021
         LA    R1,MSG4             ADDR OF IFF604I               S21016 46478021
         B     PD1                 GO ISSUE WTO                  S21016 46481021
*                                                                S21016 46484021
PD9      EQU   *                                                 S21016 46487021
         LA    R6,NAME5            POINTS TO NAME FLD IN MSG 5   S21016 46490021
         LA    R1,MSG5             POINTS TO IFF605I             S21016 46493021
         B     PD1                 GO ISSUE WTO                  S21016 46496021
*                                                                S21016 46499021
PD10     EQU   *                                                 S21016 46502021
         LA    R1,MSG7             ADDR OF IFF607I               S21016 46505021
         LA    R6,NAME7            PTS TO MSG7 IN STAT TBL       S21016 46508021
           LA    R7,PD20          ADDR OF NEXT CHECK             S21016 46511021
         B     PD1                GO ISSUE WTO                   S21016 46514021
         EJECT                                                          46517021
PD3      EQU   *                                                 S21016 46520021
         SR    R6,R6               ZERO CONVERT REGISTER         S21016 46523021
         IC    R6,GSPARRAY+NINTN   INSERT FAILING ARG NBR        S21016 46526021
         CVD   R6,ARG(R2)         CONVERT ARG TO DECIMAL         S21016 46529021
         LA    R1,ARG(R2)         ADDRESS OF MOVE FIELD          S21016 46532021
         LA    R6,ARG1(R2)        ADDRESS OF MOVE FROM FIELD     S21016 46535021
         UNPK  N0(FOUR,R1),N0(TWO,R6)  UNPACK ARGUMENT NUMBER    S21016 46538021
         LA    R6,ARG3(R2)        ADDRESS OF UNPACKED ARG NBR    S21016 46541021
         OI    N0(R6),X'F0'       MOVE IN ZONE                   S21016 46544021
* PRINTABLE ARG NBR IN FORM FN FN NOW AT ARG+2                   S21016 46547021
         LA    R6,ARGNBR           POINT TO ARG PARM IN MSG6     S21016 46550021
         LA    R10,ARG4(R2)       ADDRESS OF ARG FOR MOVE        S21016 46553021
         MVC   N0(TWO,R6),N0(R10) MOVE ARG NBR TO MSG            S21016 46556021
         LA    R6,NAME6            POINT TO NAME FLD             S21016 46559021
         LA    R1,MSG6             POINT TO IFF606I              S21016 46562021
         LA    R7,PD30            ADDR OF NEXT                   S21016 46565021
         B     PD1                 GO ISSUE WTO                  S21016 46568021
PD4      EQU   *                   CODE TO TEST NULL VS RET CODE S21016 46571021
         SR    R1,R1               ZERO REG                      S21016 46574021
         SR    R6,R6               ZERO REG                      S21016 46577021
         TM    GSPARRAY,X'04'     I/O ERROR?                     S21016 46580021
         BO    RCEQ5              IT WAS                         S21016 46583021
         TM    GSPARRAY,X'08'     PARAMETER ERROR?               S21016 46586021
         BO    RCEQ4              YES                            S21016 46589021
         TM    GSPARRAY,X'10'     RET CODE = 3?                  S21016 46592021
         BO    RCEQ3              IT WAS                         S21016 46595021
         TM    GSPARRAY,X'40'      SCISSORING USED?              S21016 46598021
         BO    RCEQ1               YES                           S21016 46601021
         TM    GSPARRAY,X'20'      SCALING ERROR?                S21016 46604021
         BO    RCEQ2               YES                           S21016 46607021
         B     PD0                IRRELEVENT RET CODE - NA ACTIONS21016 46610021
*                                                                S21016 46613021
*                                                                S21016 46616021
RCEQ1    EQU   *                                                 S21016 46619021
         LA    R1,ONE              LOAD SCISSORING CODE          S21016 46622021
         B     CHKNULL             CHECK NULL VALUE              S21016 46625021
*                                                                S21016 46628021
*                                                                S21016 46631021
RCEQ2    EQU   *                                                 S21016 46634021
         LA    R1,TWO              SCALING ERROR CODE            S21016 46637021
         B     CHKNULL             CHECK NULL VALUE              S21016 46640021
*                                                                S21016 46643021
*                                                                S21016 46646021
*                                                                S21016 46649021
*                                                                S21016 46652021
RCEQ3    EQU   *                                                 S21016 46655021
         LA    R1,TH               LOAD 3                        S21016 46658021
         B     CHKNULL             GO COMPARE WITH NULL          S21016 46661021
*                                                                S21016 46664021
RCEQ5    EQU   *                                                 S21016 46667021
         LA    R1,FIVE             ASSUME I/O ERROR - LOAD 5     S21016 46670021
         B     CHKNULL             GO COMPARE WITH NULL          S21016 46673021
RCEQ4    EQU   *                                                 S21016 46676021
         LA    R1,FOUR             LOAD 4                        S21016 46679021
CHKNULL  EQU   *                   THIS CODE MASSAGES NULL       S21016 46682021
         L     R10,GSPNULLV        ADDR OF NULL VARIABLE         S21016 46685021
         L     R10,N0(R10)         LOAD ACTUAL NULL              S21016 46688021
         LPR   R10,R10             MAKE POSITIVE                 S21016 46691021
         CLR   R10,R1              COMPARE NULL AND RET CODE     S21016 46694021
         BH    PD0                BRANCH - NO TERMINATION MSG    S21016 46697021
* RETCODE IS IN R1; NULL IS IN R10                               S21016 46700021
PD7      EQU   *                                                 S21016 46703021
         O     R1,PRTMASK          INSERT ZONE                   S21016 46706021
         O     R10,PRTMASK         INSERT ZONE                   S21016 46709021
         STC   R1,RETCODE          STORE RET CODE                S21016 46712021
         STC   R10,NULL1           STORE NULL VALUE              S21016 46715021
         LA    R6,NAME1           ADDRESS OF NAME 1              S21016 46718021
         MVC   N0(FIVE,R6),N0(R11) MOVE SUBRTN NAME TO MSG       S21016 46721021
         LA    R1,MSG1             POINT TO IFF601I              S21016 46724021
         WTO   MF=(E,(R1))         ISSUE WTO                     S21016 46727021
         B     PD0                 CONTINUE "NORMAL" PROCESSING  S21016 46730021
         EJECT                                                          46800021
*                                                                       47200021
*MODULE NOT IN STORAGE.  TEST FOR LOAD AND CALL OR LINK.                47600021
*                                                                       48000021
AHAD2010 L     R7,16                   GET CVT ADDRESS                  48400021
         L     R7,CVTLINK(R7)          GET LINKLIB DCB ADDR             48800021
*                                                                       49200021
*MOVE 4 CHARACTERS OF MODULE NAME PAST IFFA FIELD IN STATUS TABLE       49600021
*                                                                       50000021
         L     R6,N4(R3,R5)            GET CHARACTERS FROM STATAB       50400021
         ST    R6,MODNAME+4(R5)        CONCATENATE WITH IFFA FIELD      50800021
         LA    R3,N0(R5,R3)            ADD STATAB ADDR AND STATAB INDEX 51200021
         TM    N8(R3),X'01'        LINK                            000A 51600021
         BO    AHAD2060            YES                             000A 52000021
*                                                                       52400021
*MODULE TO BE LOADED AND CALLED                                         52800021
*                                                                       53200021
         LR    R1,R7                   PUT LINKLIB DCB IN REG 1         53600021
         LA    R0,MODNAME(R5)          LOAD MODULE NAME ADDR            54000021
         LOAD  EPLOC=(0)                                                54400021
         LR    R15,R0                  PUT EP ADDRESS IN R15            54800021
         ST    R15,0(R3)               PPUT EP ADDR IN STATAB           55200021
         TM    N8(R3),X'04'        ANOTHER ENTRY PT                000A 55240021
         BZ    AHAD2015            NO                              000A 55280021
         SR    R1,R1                                               000A 55320021
         IC    R1,9(R3)            ENTRY NUMBER                    000A 55360021
         MH    R1,H12              DISP IN STATUS TABLE            000A 55400021
         LH    R7,10(R3)           DISP INTO MODULE                000A 55440021
         AR    R7,R15              COMPUTE ENTRY PT                000A 55480021
         ST    R7,0(R1,R5)         PLACE ENT PT IN OTHER MODULE    000A 55520021
AHAD2015 OI    N8(R3),X'08'        SET SWITCH-LOAD MODULE          000A 55560021
         B     AHAD2040                BRANCH TO CALL SUBROUTINE        55600021
*                                                                       56000021
*MODULE TO BE LINKED TO                                                 56400021
*                                                                       56800021
AHAD2060 LA    R6,MODNAME(R5)          TRANSFER MODULE NAME             57200021
         XC    SUPPLIST(16,R4),SUPPLIST(R4)                             57600021
         LINK  EPLOC=(6),MF=(E,(4)),SF=(E,SUPPLIST(4))                  58000021
         B     AHAD2050                GO TO EXIT TO USER               58400021
         EJECT                                                          58480021
*   RETURN CODE HAS EQUALED OR EXCEEDED NULL VALUE. ONE OF TWO ACTIONS  58560021
*   OCCURS NOW.                                                         58640021
*                                                                       58720021
*          1. IF A USER ERROR EXIT HAS BEEN SPECIFIED IN THE CALL TO    58800021
*             INGSP, THE EXIT ROUTINE IS GIVEN CONTROL.  CONTROL DOES   58880021
*             NOT RETURN TO DIRECTOR II AFTER EXIT ROUTINE COMPLETION,  58960021
*             SINCE THE SAVE AND RETURN REGISTERS ARE THOSE PASSED TO   59040021
*             DIRECTOR II. CONTROL INSTEAD PASSES FROM EXIT ROUTINE TO  59120021
*             SUPERVISOR TO HIGHER LANGUAGE CALLING PROGRAM.            59200021
*                                                                       59280021
*          2. IF NO EXIT ROUTINE HAS BEEN SPECIFIED, THE TASK IS        59360021
*             TERMINATED.  A DUMP IS PROVIDED IF A NEGATIVE NULL VALUE  59440021
*             HAS BEEN SPECIFIED IN THE CALL  TO INGSP.                 59520021
         SPACE 3                                                        59600021
AHAD2100 L     R15,GSPAEXIT          IS ERROR EXIT SPECIFIED     S21016 59680021
         LTR   R15,R15                                           S21016 59760021
         BZ    AHAD2120                 IF NO, ABEND             S21016 59840021
         MVI   GSPBUSYS,X'00'           IF YES,SET GSP NOT BUSY   M1097 59890021
         L     R13,USERSAVE+4(R4)              AND RESTORE        M1097 59940021
         L     R14,RETURN(R13)                  REGISTERS        S21016 60000021
         LM    R0,R12,R0SAVE(R13)               FOR USER         S21016 60080021
         BR    R15                   PASS CONTROL TO EXIT RTN    S21016 60160021
         SPACE 3                                                        60240021
AHAD2120 L     R1,CCODE              GET ABEND CODE 062          S21016 60320021
         CLI   GSPDUMP,DUMP                                             60400021
         BNE   AHAD2150                 BRANCH IF NO DUMP               60800021
         LA    R3,GSPARRAY              SET UP FOR ABEND                61200021
         LR    R2,R8                    ADDRESS OF STATUS TABLE ENTRY   61600021
         ABEND (1),DUMP                                                 62000021
*                                                                       62400021
AHAD2150 ABEND (1)                                                      62800021
         DS    0F                                                       63200021
CCODE    DC    XL4'00062000'                                            63600021
         EJECT                                                          64000021
GSPCB    DSECT                                                          64400021
GSPGTMCB DS    F                   ADDRESS OF THE FIRST GTMCB           64800021
*                                  ON THE CHAIN                         65200021
GSPDCTR2 DS    F                   ADDRESS OF PART 2 OF THE DIRECTOR    65600021
GSPSYSID DS    X                   BYTE TO SAY THIS IS A CONTROL BLK    66000021
*              X'F2'               SETTING                              66400021
GSPCBID  DS    X                   ID TO SAY THIS IS A GSPCB            66800021
*              X'01'               SETTING                              67200021
GSPBUSYS DS    X                   GSP BUSY SWITCH                      67600021
*              X'00'               GSP NOT BUSY                         68000021
*              X'FF'               GSP BUSY                             68400021
GSPFLAGS DS    X                   ASSORTED FLAGS                       68800021
*              X'01'               1=IN DE / 0=NOT IN DE                69200021
GSPDECNT DS    X                   COUNT OF DIRECT ENTRIES PENDING      69600021
GSPDUMP  DS    X                                                        70000021
GSPABEND DS    X                                                        70400021
GSPAWORK DS    F                   ADDRESS OF WORK AREA                 70800021
GSPSTRTB DS    F                   ADDRESS OF THE STROKE TABLE          71200021
GSPARRAY DS    5F                  GSP RETURN ARRAY                     71600021
GSPNULLV DS    F                   THE ADDRESS TO BE RECOGNIZED         72000021
*                                  AS THE ABSENCE OF A PARAMETER        72400021
GSPASTAT DS    F                   ADDRESS OF THE STATUS TABLE          72800021
GSPAEXIT DS    F             ADDR OF USER EXIT RTN, INGSP ARG 3  S21016 73000021
GSPCBLGN EQU   *-GSPCB                 LENGTH OF GSPCB                  73200021
         EJECT                                                          73600021
IFFAHA11 CSECT                                                          74000021
N0       EQU   0                                                        74800021
TWO      EQU   2                                                 S21016 74900021
TH       EQU   3                                                 S21016 75000021
FOUR     EQU   4                                                 S21016 75100021
N4       EQU   4                                                        75200021
FIVE     EQU   5                                                 S21016 75400021
N8       EQU   8                                                        75600021
CVTLINK  EQU   8                                                        76000021
RETURN   EQU   12             USER RETURN REGISTER 14 DISPL      S21016 76020021
R0SAVE   EQU   20             USER REGISTER 0 DISPLACEMENT       S21016 76040021
R10      EQU   10                                                S21016 76060021
R11      EQU   11                                                S21016 76080021
TWLV     EQU   12                                                S21016 76100021
F        EQU   15                                                S21016 76120021
NINTN    EQU   19                                                S21016 76140021
ARG      EQU   32                                                S21016 76160021
ARG1     EQU   38                                                S21016 76180021
ARG3     EQU   35                                                S21016 76200021
ARG4     EQU   34                                                S21016 76220021
ONE      EQU   1                                                 S21016 76240021
         DS    0F                                                S21016 76260021
PRTMASK  DC    X'000000F0'                                       S21016 76280021
H5       DC    H'5'                                              S21016 76300021
DUMP     EQU   X'FF'                                                    76400021
*                                                                       76800021
*THESE ASSUME A 1K WORKAREA                                             77600021
*                                                                       78000021
USERSAVE EQU   1020-GSPCBLGN-72                                         78400021
SUPPLIST EQU   1020-GSPCBLGN-104                                        78800021
*                                                                       79200021
*ASSUMES 66 TWELVE BYTE ENTRIES IN STATUS TABLE                  00000B 79600021
*                                                                       80000021
MODNAME  EQU   70*12+120                                                80400021
*                                                                       80800021
HCON3    DC    H'3'          FACTOR$DIFF NUM IS STATAB DISPLACEMENT     81200021
H12      DC    H'12'                                               000A 81400021
SEVEN    DC    F'7'                                                     81600021
         SPACE 3                                                        82000021
*CONVERSION TABLE FOR ABEND CODES                                       82400021
TAB      DC    X'80'                                                    82800021
         DC    X'40'                    RETURN CODE 1   -SCISSOR        83200021
         DC    X'20'                                2   -SCALE          83600021
         DC    X'10'                                3   -STOR EXCEDED   84000021
         DC    X'08'                                4   -PARAMETER      84400021
         DC    X'04'                                5   -I/O ERROR      84800021
         DC    X'02'                                6   -               85200021
         EJECT                                                          85203021
* THE FOLLOWING TABLE IS A LIST OF NAMES TO BE MOVED INTO WTO'S  S21016 85206021
* IN THE STATUS TABLE WHEN ERROR CONDITIONS ARE ENCOUNTERED; THE S21016 85209021
* TABLE IS, AND MUST REMAIN, IN THE SAME ORDER AS THE STATUS TABLS21016 85212021
TABLE    EQU   *                                                 S21016 85215021
         DC    C'INDEV'                                          S21016 85218021
         DC    C'TMDEV'                                          S21016 85221021
         DC    C'INGDS'                                          S21016 85224021
         DC    C'TMGDS'                                          S21016 85227021
         DC    C'CRATL'                                          S21016 85230021
         DC    C'ENATL'                                          S21016 85233021
         DC    C'ENATN'                                          S21016 85236021
         DC    C'DSATN'                                          S21016 85239021
         DC    C'MPATL'                                          S21016 85242021
         DC    C'MLPEO'                                          S21016 85245021
         DC    C'SLPAT'                                          S21016 85248021
         DC    C'MLITS'                                          S21016 85251021
         DC    C'RQATN'                                          S21016 85254021
         DC    C'     '            TAKES UP SPACE IN TABLE       S21016 85257021
         DC    C'     '            TAKES UP SPACE IN TABLE       S21016 85260021
         DC    C'SALRM'                                          S21016 85263021
         DC    C'GSPRD'                                          S21016 85266021
         DC    C'RCURS'                                          S21016 85269021
         DC    C'ICURS'                                          S21016 85272021
         DC    C'SDATM'                                          S21016 85275021
         DC    C'SGRAM'                                          S21016 85278021
         DC    C'SDATL'                                          S21016 85281021
         DC    C'SGDSL'                                          S21016 85284021
         DC    C'SSCIS'                                          S21016 85287021
         DC    C'SCHAM'                                          S21016 85290021
         DC    C'PLINE'                                          S21016 85293021
         DC    C'PPNT '                                          S21016 85296021
         DC    C'PSGMT'                                          S21016 85299021
         DC    C'PTEXT'                                          S21016 85302021
         DC    C'STPOS'                                          S21016 85305021
         DC    C'MVPOS'                                          S21016 85308021
         DC    C'BSGEQ'                                          S21016 85311021
         DC    C'BGSUB'                                          S21016 85314021
         DC    C'ENSEQ'                                          S21016 85317021
         DC    C'ENSUB'                                          S21016 85320021
         DC    C'LKSUB'                                          S21016 85323021
         DC    C'INCL '                                          S21016 85326021
         DC    C'OMIT '                                          S21016 85329021
         DC    C'EXEC '                                          S21016 85332021
         DC    C'RESET'                                          S21016 85335021
         DC    C'IDPOS'                                          S21016 85338021
         DC    C'FSMOD'                                          S21016 85341021
         DC    C'STEOS'                                          S21016 85344021
         DC    C'ORGDS'                                          S21016 85347021
         DC    C'LOCPN'                                          S21016 85350021
         DC    C'BGTRK'                                          S21016 85353021
         DC    C'RDTRK'                                          S21016 85356021
         DC    C'ENTRK'                                          S21016 85359021
         DC    C'DFSTR'                                          S21016 85362021
         DC    C'PLSTR'                                          S21016 85365021
         DC    C'ORGEN'                                          S21016 85368021
         DC    C'CNVRT'                                          S21016 85371021
         DC    C'ITRC '                                          S21016 85374021
         DC    C'RTBP '                                          S21016 85377021
         DC    C'ITBP '                                          S21016 85380021
         DC    C'ITST '                                          S21016 85383021
         DC    C'SPEC '                                          S21016 85386021
* END OF TABLE                                                   S21016 85389021
         EJECT                                                          85392021
STATTBL  DSECT                                                   S21016 85395021
STATSTRT DS    242F                LGTH OF STATUS TABLE UP TO MSGS21016 85398021
MSG1     DS    F                   MSG LGTH AND MCS FLAGS        S21016 85401021
         DS    8C                  IFF601I MSG ID + 1 BLANK      S21016 85404021
NAME1    DS    5C                  SUBRTN NAME                   S21016 85407021
         DS    13C                                               S21016 85410021
RETCODE  DS    C                   RETURN CODE                   S21016 85413021
         DS    28C                                               S21016 85416021
NULL1    DS    C                   NULL VALUE                    S21016 85419021
         DS    C                   ADDL INFO                     S21016 85422021
         DS    F                   DESC AND ROUTING CODES        S21016 85425021
*                                                                S21016 85428021
*                                                                S21016 85431021
*                                                                S21016 85434021
MSG2     DS    F                   MSG LGTH AND MCS FLAGS        S21016 85437021
         DS    8C                  IFF602I MSG ID + 1 BLANK      S21016 85440021
NAME2    DS    5C                  SUBRTN NAME                   S21016 85443021
         DS    51C                                               S21016 85446021
         DS    F                   DESC AND ROUTING CODES        S21016 85449021
*                                                                S21016 85452021
*                                                                S21016 85455021
*                                                                S21016 85458021
MSG3     DS    F                   MSG LGTH AND MCS FLAGS        S21016 85461021
         DS    8C                  IFF603I MSG ID + 1 BLANK      S21016 85464021
NAME3    DS    5C                  SUBRTN NAME                   S21016 85467021
         DS    48C                                               S21016 85470021
         DS    F                   DESC AND ROUTING CODES        S21016 85473021
*                                                                S21016 85476021
         EJECT                                                          85479021
*                                                                S21016 85482021
*                                                                S21016 85485021
MSG4     DS    F                   MSG LGTH AND MCS FLAGS        S21016 85488021
         DS    8C                  IFF604I MSG ID + 1 BLANK      S21016 85491021
NAME4    DS    5C                  SUBRTN NAME                   S21016 85494021
         DS    59C                                               S21016 85497021
         DS    F                   DESC AND ROUTING CODES        S21016 85500021
*                                                                S21016 85503021
*                                                                S21016 85506021
*                                                                S21016 85509021
MSG5     DS    F                   MSG LGTH AND MCS FLAGS        S21016 85512021
         DS    8C                  IFF605I MSG ID + 1 BLANK      S21016 85515021
NAME5    DS    5C                  SUBRTN NAME                   S21016 85518021
         DS    54C                                               S21016 85521021
         DS    F                   DESC AND ROUTING CODES        S21016 85524021
*                                                                S21016 85527021
*                                                                S21016 85530021
*                                                                S21016 85533021
MSG6     DS    F                   MSG LGTH AND MCS FIELDS       S21016 85536021
         DS    8C                  IFF606I MSG ID + 1 BLANK      S21016 85539021
NAME6    DS    5C                  SUBRTN NAME                   S21016 85542021
         DS    25C                ADDL INFO                      S21016 85545021
ARGNBR   DS    2C                  INVALID ARGUMENT NUMBER       S21016 85548021
         DS    8C                 ADDL INFO                      S21016 85551021
         DS    F                   DESC AND ROUTING CODES        S21016 85554021
         EJECT                                                          85557021
*                                                                S21016 85560021
*                                                                S21016 85563021
*                                                                S21016 85566021
MSG7     DS    F                   MSG LGTH AND MCS FIELDS       S21016 85569021
         DS    8C                  IFF607I MSG ID + 1 BLANK      S21016 85572021
NAME7    DS    5C                  SUBRTN NAME                   S21016 85575021
         DS    48C                 ADDL INFO                     S21016 85578021
         DS    F                   DESC AND ROUTING CODES        S21016 85581021
*                                                                S21016 85584021
*                                                                S21016 85587021
*                                                                S21016 85590021
* END OF WTO DSECT                                               S21016 85593021
         END                                                            85600021
