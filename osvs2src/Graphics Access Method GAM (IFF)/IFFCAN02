         TITLE ' GRAPHICS CANCEL KEY DUMP FORMATTING ROUTINE '          00060000
*********************************************************************** 00062000
*                                                                       00064000
* MODULE NAME:           IFFCAN02 (OS/VS2)                              00066000
*                                                                       00068000
* DESCRIPTIVE NAME:      GRAPHICS CANCEL KEY DUMP FORMATTING ROUTINE    00068400
*                                                                       00068800
* COPYRIGHT:             NONE                                           00069200
*                                                                       00069600
* STATUS:                RELEASE 2.0                                    00069700
*                                                                       00069800
* FUNCTION:              FORMAT INTO AN ABDUMP TYPE FORMAT AND PLACE    00073600
*                        ON THE SPECIFIED SEQUENTIAL DEVICE OR DATA     00074000
*                        SET THE 2250 BUFFER SECTIONS, EACH 256         00074400
*                        BYTES IN SIZE, THAT HAVE BEEN ASSIGNED TO      00074800
*                        THE JOBSTEP REQUESTING THE DUMP.               00074900
*                                                                       00075200
******************* PROLOGUE*CONTINUED*NEXT*PAGE ********************** 00085200
         EJECT                                                          00095200
*********************************************************************** 00095300
*                                                                       00095600
* NOTES:                                                                00096000
*    DEPENDENCIES:       NONE                                           00096100
*                                                                       00096600
*     RESTRICTION:       SYSBFDMP CARD MUST SPECIFY A SEQUENTIAL DEVICE 00096700
*                                                                       00097200
*     RESISTERS:         SEE EQUATE DEFINITIONS FOLLOWING PROLOG        00097300
*                                                                       00097400
*     PATCH LABEL:       PATCH, A 50 BYTE DC AREA AT END OF MODULE      00097500
*                                                                       00097600
* MODULE TYPE:           EXECUTABLE CODE                                00098000
*                                                                       00098100
*    PROCESSOR:          ASSEMBLER XF                                   00098200
*                                                                       00098300
*    MODULE SIZE:        SEE PAGE 1 OF THIS LISTING                     00099700
*                                                                       00100100
*    ATTRIBUTES:                                                        00100500
*       AT ENTRY:        REENTRANT  ENABLED  SUPERVISOR STATE IN KEY 0  00100900
*                                                                       00101100
* ENTRY POINT:           IFFCAN02                                       00103400
*                                                                       00105400
*    PURPOSE:            SEE 'FUNCTION' HEADING ABOVE                   00105500
*                                                                       00105600
*    LINKAGE:            SEE 'INPUT', NEXT HEADING                      00106000
*                                                                       00106400
* INPUT:                 REGISTER 1 POINTS TO CKQE FOR DEVICE           00106500
*                        REQUESTING THE DUMP                            00106700
*                                                                       00108300
* OUTPUT:                SEE 'FUNCTION' HEADING ABOVE                   00108700
*                                                                       00109100
* EXITS:                                                                00109400
*                                                                       00109800
*    NORMAL:             RETURN, USING ADDRESS IN REGISTER 14           00110200
*                                                                       00110300
*    ERROR:              RETURN, USING ADDRESS IN REGISTER 14           00110700
*                          RETURN CODE 4 IN REGISTER 15                 00111100
*                                                                       00111500
******************* PROLOGUE*CONTINUED*NEXT*PAGE ********************** 00111800
         EJECT                                                          00112200
*********************************************************************** 00112600
*                                                                       00112700
* EXTERNAL REFERENCES:                                                  00112800
*                                                                       00113100
*     ROUTINES:          IGG019OA TO READ IN THE 2250 BUFFER            00113500
*                        READ/WRITE (BSAM) TO WRITE BUFFER CONTENTS     00113900
*                                                                       00114200
*     DATA AREAS:        SEE DSECT SECTION AT END OF LISTING            00114600
*                                                                       00115000
*     CONTROL BLOCKS:    SEE DSECT SECTION AT END OF LISTING            00115100
*                                                                       00115200
* TABLES:                CKCB     CKQE     BUFFER TABLE                 00115300
*                        OPCB     TIOT                                  00117600
*                                                                       00119600
* MACROS:                CHECK         OPEN           SYNADRLS          00120000
*                        CLOSE         RETURN         WTO               00120600
*                        GETMAIN       SAVE                             00121000
*                        GREAD         SYNADAF                          00121400
*                                                                       00121500
* CHANGE ACTIVITY:       1. BLOCKING FACTOR CHANGED TO A SINGLE LINE    00121600
*                        2. DCB IS OPENED AND CLOSED EVERY ENTRY        00122000
*                                                                       00123100
*                        FIXES DROPPED LIST:     GJP UNSUPPORTED IN VS  00123200
*                                                                       00124400
*********************************************************************** 00124800
         SPACE 3                                                        00124900
IFFCAN02 CSECT                                                          00125000
*   SEE LABEL 'MODID' FOR LAST CHANGE DATE; FORMAT:  NAME.SYSREL.DATE   00125100
* 507000,520500-522000,536500-539000                             A33603 00125200
*D631000-634500                                                  A39421 00125800
*A616100,A616200                                                 A39421 00126400
*C119500,D120000                                                 X01007 00127000
*D64500,D79000,D129000,D134500,D318000,D323000                LI A39419 00129300
*A64200-64400,A76200,A78900,A128700-129100,A134200-134800     LI A39419 00131600
*A317800-318100,A322800-323100,A713050-713450                 LI A39419 00133900
*C666000                                                      LI A39419 00136200
*C519500,520000                                              LD YA00801 00138500
*A315600-315997,A624100,C665500                               LG YM5686 00140800
*D231500,A231600-231700,D263000,A263100-263200               LG Z30AALG 00142800
*D278500,A278600-278700,D303000,A303100-303200               LG Z30AALG 00142900
*D433500,A433600-433620                                      LG Z30AALG 00143000
*A297700-297996,A658100-658420                               LG @ZM2360 00193000
*C390500-392500                                             D11 ZA14043 00213000
*                                                                       00243000
*                                                                       00293000
         EJECT                                                          03350021
*********************************************************************** 03400021
*                                                                     * 03450021
*                        EQUATES                                      * 03500021
*                                                                     * 03550021
*********************************************************************** 03600021
WORKR0   EQU   0                        WORKING REGISTER                03650021
WORKR1   EQU   1                        WORKING REGISTER                03700021
WORKR2   EQU   2                        WORKING REGISTER                03750021
BUFTABR  EQU   2                        BUFFER TABLE                    03800021
WORDCTR  EQU   2                        WORD COUNT REGISTER             03850021
WORKR3   EQU   3                        WORKING REGISTER                03900021
BUFINDXR EQU   3                        DISPLACEMENT INTO BUFFER TABLE  03950021
INTRTNR  EQU   4                        INTERNAL RETURN                 04000021
DCBR     EQU   5                        DATA CONTROL BLOCK              04050021
BUFFSECR EQU   7                        ADDRESS OF 256 BUFFER SECTION   04100021
UCBR     EQU   5                        UNIT CONTROL BLOCK              04150021
HEXR     EQU   5                        HEXADECIMAL DATA                04200021
BUFSTR   EQU   6                        ADDRESS OF BUFFER RESTART       04250021
*                                            GENERATION ADDRESS         04300021
MOVELNGR EQU   6                        LENGTH OF INTERPERT AREA        04350021
INDEXR   EQU   6                        INDEX VALUE                     04400021
TIOTR    EQU   6                        TASK INPUT/OUTPUT TABLE         04450021
HALFLNR  EQU   7                        HALF LINE COUNTER               04500021
CKCBR    EQU   7                        CANCEL KEY CONTROL BLOCK        04550021
TCBR     EQU   7                        TASK CONTROL BLOCK              04600021
DEBR     EQU   8                        DATA EVENT BLOCK ADDRESS        04650021
DECBR    EQU   8                        DATA EVENT CONTROL BLOCK        04700021
EBCDICR  EQU   8                        EBCDIC DATA                     04750021
CVTR     EQU   8                        COMMUNICATION VECTOR TABLE      04800021
LINER    EQU   9                        CURRENT OUTPUT LINE IN USE      04850021
TIOTDPLR EQU   9                        TASK I/O TABLE DISPLACEMENT     04900021
OPCBR    EQU   10                       OUTPUT CONTROL BLOCK            04950021
CKQER    EQU   11                       OUTPUT CONTROL BLOCK ADDRESS    05000021
BASER    EQU   12                       CANCEL KEY QUEUE ELEMENT ADD.   05050021
SAVEPTR  EQU   13                       BASE REGISTER                   05100021
RETURNR  EQU   14                       RETURN REGISTER EXTERNAL        05150021
WORKRE   EQU   14                       WORKING REGISTER                05200021
ENTRYR   EQU   15                       ENTRY POINT ADDRESS             05250021
RTNCODER EQU   15                       RETURN CODE                     05300021
WORKRF   EQU   15                       WORKING REGISTER                05350021
DEBR2    EQU   15                       DEB OTHER THAN SYSFBDMP DEB     05400021
SUMR     EQU   15                       ACCUMULATOR                     05450021
XDUMY    EQU   X'00'                   IMMED. COMPARAND       LB  AOS/1 05470021
         EJECT                                                          05500021
*********************************************************************** 05550021
*                                                                     * 05600021
*                        ENTRY INTERFACE                              * 05650021
*                                                                     * 05700021
*********************************************************************** 05750021
         SPACE 2                                                        05800021
         USING *,ENTRYR                                                 05850021
         B     *+24                     BRANCH AROUND ID                05860000
MODID    DC    C'IFFCAN02.VS2R2.74324'                                  05870000
         SAVE  (14,12)                  SAVE REGISTERS                  05900000
         DROP  ENTRYR                   ESTABLISH                       05950021
         BALR  BASER,0                                                  06000021
         USING *,BASER                       ADDRESSABILITY             06050021
         LR    CKQER,WORKR1             ESTABLISH ADDRESSABILITY        06100021
         USING CKQE,CKQER               FOR CKQE                        06150021
         USING CKCB,CKCBR               ESTABLISH ADDRESSABILITY FOR    06200021
*                                            CANCEL KEY CONTROL BLOCK   06250021
         L     CKCBR,CKQECKCB           LOAD POINTER TO CKCB            06300021
*                             TRY TO GET CORE FOR OPCB                  06350021
         LA    CKCBR,ZERO(CKCBR)        CLEAR HIGH ORDER BYTE           06400021
         LA    WORKR1,CKCBWORK         PT TO LIST IN CKCB     LI A39419 06420021
         GETMAIN EC,LV=OPCBLEN,A=(CKCBR),SP=252,MF=(E,(1))    LI A39419 06440021
         SR    WORKR2,WORKR2           SET INDEX TO WTO TABLE           06480021
         LTR   RTNCODER,RTNCODER       WAS GETMAIN SUCCESSFUL           06510021
         BNZ   COMMON                  NO-ISSUE ERROR MESSAGE           06540021
*                                      IF GETMAIN FAILS RETURN CODE     06600021
*                                         IN REGISTER 15 IS ALREADY     06650021
*                                         NOT ZERO SO WILL NOT HAVE     06700021
*                                         TO SET IT FOR ABNORMAL        06750021
*                                         RETURN INDICATOR              06800021
         OI    CKQEFLG2,CKFOPCB         INDICATE THAT                   06850021
*                                            GETTMAIN WAS ISSUED        06900021
*                                            SUCCESSFULLY               06950021
         L     OPCBR,CKCBOPCB           ESTABLISH ADDRESSABILITY        07000021
         USING OPCB,OPCBR                    FOR OPCB                   07050021
         USING SAVEAREA,SAVEPTR                                         07100021
         LA    WORKR1,OPCBSVAR          GET POINTER TO MY SAVE AREA     07150021
         ST    WORKR1,LSA               DOING THE BACKWORD              07200021
         DROP  SAVEPTR                         AND                      07250021
         USING SAVEAREA,WORKR1                     THE                  07300021
         ST    SAVEPTR,HSA              FOREWORD SAVE AREA CHAINING     07350021
         LR    SAVEPTR,WORKR1           SET POINTER TO MY SAVE AREA     07400021
         DROP  WORKR1                                                   07450021
         USING SAVEAREA,SAVEPTR                                         07500021
         SPACE 2                                                        07550021
*                                       GET INPUT BUFFER                07600021
         LA    WORKR1,CKCBWORK         PT TO LIST IN CKCB     LI A39419 07620021
         SPACE 2                                                        07650021
         LA    BUFFSECR,OPCBINBF        GET ADDRESS OF WHERE INPUT      07700021
*                                            BUFFER ADDRESS IS TO GO    07750021
         SPACE 2                                                        07800021
*                                       SEE IF CORE AVAILABLE           07850021
         GETMAIN EC,LV=INBUFLN,A=(BUFFSECR),SP=252,MF=(E,(1)) LI A39419 07890021
         SR    WORKR2,WORKR2           SET INDEX TO WTO TABLE           07930021
         LTR   RTNCODER,RTNCODER       WAS GETMAIN SUCCESSFUL           07960021
         BNZ   COMMON                  NO-ISSUE ERROR MESSAGE           07990021
*                                      IF GETMAIN FAILS RETURN CODE     08050021
*                                         IN REGISTER 15 IS ALREADY     08100021
*                                         NOT ZERO SO WILL NOT HAVE     08150021
*                                         TO SET IT FOR ABNORMAL        08200021
*                                         RETURN INDICATOR              08250021
         OI    CKQEFLG2,CKFINBUF        INDICATE THAT INPUT BUFFER      08300021
*                                            GOTTEN                     08350021
         EJECT                                                          08400021
*********************************************************************** 08450021
*                                                                     * 08500021
*                             MAIN BODY                               * 08550021
*                                                                     * 08600021
*********************************************************************** 08650021
         SPACE 2                                                        08700021
*                   LOCATE CURRENT TCB BY WAY OF CVT                    08750021
         SPACE 2                                                        08800021
         USING CVT,CVTR                 ESTABLISH ADDRESSABILITY FOR    08850021
*                                          COMMUNICATION VECTOR TABLE   08900021
         USING TCB,TCBR                 ESTABLISH ADDRESSABILITY FOR    08950021
*                                            TASK CONTROL BLOCK         09000021
         LA    CVTR,SYSCVTPT            GET LOCATION OF CVT POINTER     09050021
         L     CVTR,ZERO(CVTR)          GET CVT ADDRESS                 09100021
         L     TCBR,CVTTCBP             GET NEW/CURRENT WORDS ADDRESS   09150021
         L     TCBR,CURRTCB(TCBR)       GET CURRENT TCB POINTER         09200021
         SPACE 2                                                        09250021
*                   IS SYSTEM MVT IF YES USE JOBSTEP'S TCB              09300021
         SPACE 2                                                        09350021
         TM    CVTDCB,MVTSYS            IS THIS A MVT SYSTEM            09400021
         BNO   GETTIOT                  IF NOT MVT TAKE BRANCH          09450021
         L     TCBR,TCBJSTCB            GET JOB STEP TCB POINTER        09500021
GETTIOT  L     TIOTR,TCBTIO             GET TASK TIOT ADDRESS           09550021
         USING TIOT,TIOTR               ESTABLISH ADDRESSABILITY FOR    09600021
*                                            TASK I/O TABLE             09650021
         USING TIOTDDEN,WORKR1          ESTABLISH ADDRESSABILITY        09700021
*                                            FOR TASK I/O TABLE         09750021
*                                            DD ENTRY                   09800021
         LA    TIOTDPLR,TIOTHEAD             BYPASS TIOT IDENTIFIERS    09850021
         B     FIRSTENT                 FOR FIRST DD ENTRY SPECIAL      09900021
*                                            ENTRY TO LOOP              09950021
         SPACE 2                                                        10000021
*                   LOOP TO SEARCH TIOT FOR DDENTRY 'SYSBFDMP'          10050021
         SPACE 2                                                        10100021
TIOTLOOP IC    WORKR1,TIOELNGH          GET LENGTH OF THIS DD ENTRY     10150021
         SLL   WORKR1,X24BITS           ZERO OUT OTHER                  10200021
         SRL   WORKR1,X24BITS                THREE BYTES OF REGISTER    10250021
         AR    TIOTDPLR,WORKR1          UP TIOT DISPLACEMENT INTO       10300021
*                                            NEXT DD ENTRY              10350021
FIRSTENT LR    WORKR1,TIOTR             MOVE TIOT ADDRESS TO WORKING    10400021
*                                            PLACE                      10450021
         AR    WORKR1,TIOTDPLR          GET ADDRESS OF NEXT DD ENTRY    10500021
*                                            TIOT                       10550021
*                                       IS THIS END OF TIOT (I.E. FULL  10600021
*                                            WORD OF ZEROS)             10650021
         OC    TIOELNGH(X4BYTES),TIOELNGH      END OF TABLE             10670021
         LA    WORKR2,TWELVE           SET INDEX TO WTO TABLE           10700021
         BZ    COMMON                  ISSUE ERROR MESSAGE              10750021
         CLC   TIOEDDNM,SYSBFDMP        IS DD ENTRY 'SYSBFDMP'          11050021
         BNE   TIOTLOOP                 IF NOT TAKE BRANCH              11100021
         DROP  WORKR1                                                   11150021
         DROP  TIOTR                                                    11200021
         SPACE 2                                                        11250021
DCBNOPEN LA    DCBR,OPCBDCB             PLACE FOR DCB POINTER FROM      12750021
*                                            GETMAIN.                   12800021
*                        TRY TO GET CORE FOR OUTPUT DCB                 12850021
         L     WORKR1,CKQECKCB         PT TO CKCB             LI A39419 12870021
         LA    WORKR1,196(WORKR1)      PT TO LIST IN CKCB     LI A39419 12890021
         GETMAIN EC,LV=DCBLEN,A=(DCBR),SP=252,MF=(E,(1))      LI A39419 12910021
         SR    WORKR2,WORKR2           SET INDEX TO WTO TABLE           12930021
         LTR   RTNCODER,RTNCODER       WAS GETMAIN SUCCESSFUL           12960021
         BNZ   COMMON                  ISSUE ERROR MESSAGE              12990021
*                                      IF GETMAIN FAILS RETURN CODE     13050021
*                                         IN REGISTER 15 IS ALREADY     13100021
*                                         NOT ZERO SO WILL NOT HAVE     13150021
*                                         TO SET IT FOR ABNORMAL        13200021
*                                         RETURN INDICATOR              13250021
         L     DCBR,OPCBDCB             GET DCB NEW LOCATION            13300021
         USING DCB,DCBR            ADDRESSABILITY FOR DCB               13320000
         MVC   DCB(DCBLEN),DCBCOPY      MOVE DCB INTO CORE              13350021
*                                                 JUST GOTTEN           13400021
         L     WORKR1,CKQECKCB         PT TO CKCB             LI A39419 13420021
         LA    WORKR1,196(WORKR1)      PT TO LIST IN CKCB     LI A39419 13440021
         MVI   ZERO(WORKR1),X'8F'      INDICATE LAST DCB      LI A39419 13460021
OPENDCB  OPEN  ((DCBR),(OUTPUT)),MF=(E,(1))                   LI A39419 13480021
         TM    DCBOFLGS,OPEN            IS DCB OPEN SUCCESSFUL          13500021
         LA    RTNCODER,ABNORMAL        SET RETURN CODE FOR ERROR       13550021
*                                            CONDITION INCOUNTERED      13600021
*                                            IF BRANCH TAKEN            13650021
         BZ    EXIT                     IF NOT TAKE BRANCH              13700021
         OI    CKQEFLG2,CKFOPEN         NOTE DCB OPEN                   13750021
         SPACE 2                                                        13800021
         EJECT                                                          18800021
*********************************************************************** 18850021
*                                                                     * 18900021
*                   WILL INITIALIZE OPCB                                18950021
*                                                                       19000021
*********************************************************************** 19050021
START    EQU   *                                                        19100021
         MVC   OPCBPCNT(OPCBHEAD),OPCBCOPY        MOVE OPCB COPY TO     19150021
*                                                 GOTTEN CORE AREA      19200021
         MVC   OPCBDECB,DECBCOPY       MOVE DECB TO OPCB                19250021
         LA    WORKR3,OPCBL1            GET ADDRESS OF LINE 1 BUFFER    19300021
         USING LINE,WORKR3              ESTABLISHING ADDRESSABILITY FOR 19350021
*                                            LINE AREA                  19400021
         LA    WORKR2,OPCBLN2I          GET LINE 2 INDEX VALUE          19450021
         SR    WORKR2,OPCBR             BY LINE POINTER MINUS OPCB      19500021
*                                       ADDRESS                         19550021
         SLL   WORKR3,X8BITS            COMBINE INDEX AND LINE ADDRESS  19600021
         SLDL  WORKR2,X24BITS                INTO ONE WORD              19650021
         ST    WORKR2,OPCBCRLN-X1BYTE   PLACE POINTER IN CURRENT        19700021
*                                            LINE POINTER POSITION      19750021
         ST    WORKR2,OPCBLN1-X1BYTE    PLACE LINE 1 ADDRESS INTO       19800021
*                                            LINE TABLE                 19850021
         LA    WORKR3,OPCBL2            GET ADDRESS OF LINE 2 BUFFER    19900021
         LA    WORKR2,OPCBLN3I          GET LINE 3 INDEX                19950021
         SR    WORKR2,OPCBR             BY LINE POINTER MINUS OPCB      20000021
*                                       ADDRESS                         20050021
         ST    WORKR3,OPCBLN2-X1BYTE    PLACE LINE ADDRESS INTO LINE    20100021
*                                            TABLE                      20150021
         STC   WORKR2,OPCBLN2I          PLACE INDEX TO NEXT LINE TO BE  20200021
*                                            USED INTO TABLE            20250021
         LA    WORKR3,OPCBL3            GET ADDRESS OF LINE 3 BUFFER    20300021
         LA    WORKR2,OPCBLN1I         GET LINE ONE INDEX               20350021
         SR    WORKR2,OPCBR             BY LINE POINTER MINUS OPCB      20400021
*                                       ADDRESS                         20450021
         ST    WORKR3,OPCBLN3-X1BYTE    PLACE LINE ADDRESS INTO LINE    20500021
*                                            TABLE                      20550021
         STC   WORKR2,OPCBLN3I          PLACE INDEX TO NEXT LINE TO BE  20600021
*                                            USED INTO TABLE            20650021
         DROP  WORKR3                                                   20700021
         EJECT                                                          20750021
*********************************************************************** 20800021
*                                                                     * 20850021
*                   EJECT OUTPUT AND FORMAT HEADER AND PRINT IT       * 20900021
*                                                                     * 20950021
*********************************************************************** 21000021
         SPACE 2                                                        21050021
         USING LINE,LINER               ESTABLISHING ADDRESSABILITY     21100021
*                                            FOR OUTPUT LINES           21150021
         L     LINER,OPCBCRLN-X1BYTE    GET CURRENT LINE ADDRESS        21200021
         BAL   INTRTNR,EJECT            GO SPACE OUTPUT TO NEW PAGE     21250021
         MVC   LINETEXT(MSG#1LN),MSG#1  MOVE TEXT OF HEADER MESSAGE     21300021
*                                            TO OUTPUT LINE             21350021
         BAL   INTRTNR,WRITESP2         GO OUTPUT LINE                  21400021
         LA    CVTR,SYSCVTPT            LOCATION OF CVT POINTER         21450021
         L     CVTR,ZERO(CVTR)          GET CVT ADDRESS                 21500021
         USING CVT,CVTR                 ESTABLISH ADDRESSABILITY FOR    21550021
*                                            COMMUNICATION VECTOR TABLE 21600021
         L     TCBR,CVTTCBP             GET NEW/CURRENT WORDS ADDRESS   21650021
         L     TCBR,CURRTCB(TCBR)       GET CURRENT TCB POINTER         21700021
         L     TIOTR,TCBTIO             GET TASK TIOT POINTER           21750021
*                                       ESTABLISH ADDRESSABILITY        21800021
         USING TIOT,TIOTR                    FOR TASK I/O TABLE         21850021
         MVC   LNJOBNM,TXTJOBNM         PLACE 'JOB' ON TO LINE          21900021
         MVC   LNJOBNAM,TIOTNJOB        MOVE JOB NAME TO LINE           21950021
         MVC   LNSTPNM,TXTSTPNM         PLACE 'STEP' ON LINE            22000021
         MVC   LNSTPNAM,TIOTSTP         MOVE STEP NAME TO LINE          22050021
         MVC   LNTMNM,TXTTMNM           PLACE 'TIME' ON LINE            22100021
         MVC   LNDTNM,TXTDTNM           PLACE 'DATA' ON LINE            22150021
         DROP  TIOTR                                                    22200021
         DROP  CVTR                                                     22250021
         TIME  DEC                      GET DATE AND TIME               22300021
         IC    WORKR0,PLUSSIGN          CHANGE TO PACKED DECIMAL OF     22350021
         SRL   WORKR0,X4BITS               HOURS MINUTES AND SECONDS    22400021
         ST    WORKR0,LINEWORK          PLACE TIME INTO LINE WORK AREA  22450021
         MVC   LNTIME,TIMEMASK               PLACE TIME EDIT MASK ON    22500021
*                                                 LINE                  22550021
         ED    LNTIME,LINEWORK               MAKE TIME PRINTABLE        22600021
         ST    WORKR1,LINEWORK          PLACE DATE INTO LINE WORK AREA  22650021
         MVC   LNDATE,DATEMASK               PLACE DATE EDIT MASK ON    22700021
*                                                 LINE                  22750021
         ED    LNDATE,LINEWORK+X1BYTE        MAKE DATE PRINTABLE        22800021
         MVC   LINEWORK,LINEWORK+X5BYTES          MAKE LINE WORK        22850021
*                                            AREA BLANKS AGAIN          22900021
         BAL   INTRTNR,WRITESP          GO OUTPUT LINE                  22950021
         MVC   LNDPMSG,TXTDUMP          PLACE 'DUMP OF' ON LINE         23000021
         USING UCB,UCBR                 ESTABLISHING ADDRESSABILITY     23050021
*                                            FOR UNIT CONTROL BLOCK     23100021
         SR    UCBR,UCBR               CLEAR REGISTER        LG Z30AALG 23160000
         ICM   UCBR,THREE,CKQEUCB      GET UCB ADDRESS       LG Z30AALG 23170000
         MVC   LNDVAD,UCBNAME           MOVE DEVICE ADDRESS TO LINE     23200021
         DROP  UCBR                                                     23250021
         BAL   INTRTNR,WRITESP          GO OUTPUT LINE                  23300021
         MVC   LNBFNM,TXTBFAD           PLACE 'BUFFER START             23350021
*                                            REGENERATION ADDRESS'      23400021
*                                            ON LINE                    23450021
         LA    EBCDICR,LNSTRGAD         POINT TO LINE WHERE BUFFER      23500021
*                                            ADDRESS IS TO GO           23550021
         L     CKCBR,CKQECKCB           ESTABLISH ADDRESSABILITY FOR    23600021
         USING CKCB,CKCBR                    CANCEL KEY CONTROL BLOCK   23650021
         LA    HEXR,CKCBREST+X2BYTES    POINT TO USERS BUFFER RESTART   23700021
*                                            ADDRESS                    23750021
         LA    MOVELNGR,BUFADDLN        LENGTH OF BUFFER ADDRESS        23800021
         BAL   INTRTNR,HEXTOEBC         GO CONVERT BUFFER ADDRESS TO    23850021
*                                            PRINTABLE CHARACTERS AND   23900021
*                                            PLACE ON OUTPUT LINE       23950021
         BAL   INTRTNR,WRITESP2         GO OUTPUT LINE                  24000021
         SPACE 2                                                        24050021
*                       CHECK ROLL OUT                                  24100021
         SPACE 2                                                        24150021
         TM    CKQEFLG2,CKFROLUT        HAS USERS BUFFER BEEN ROLLED    24200021
*                                            OUT                        24250021
         BNO   STARTDMP                 IF NOT TAKE BRANCH              24300021
         SPACE 2                                                        24350021
*                   SINCE USERS BUFFER HAS BEEN ROLLED OUT FOR US       24400021
*                        WILL USE IT IN FORMATING DUMP                  24450021
         SPACE 2                                                        24500021
         LA    DECBR,CKCBDECB           ESTABLISH ADDRESSABILITY FOR    24550021
         USING DECB,DECBR                    DATA EVENT CONTROL BLOCK   24600021
         L     WORKR1,DECBBFAD-X1BYTE        ADDRESS OF WHERE BUFFER    24650021
*                                            SECTION ADDRESS IS         24700021
         MVC   ZERO(X2BYTES,WORKR1),CKCBBFAD MOVE IN ADDRESS            24750021
         MVC   DECBAREA,CKCBROLL            INPUT AREA ADDRESS          24800021
         SPACE 2                                                        24850021
*                                       WILL CALCULATE BUFFER INDEX     24900021
*                                            FOR FIRST BUFFER SECTION   24950021
*                                            ASSIGNED TO DEVICE         25000021
*                                            REQUESTING DUMP. (I.E.     25050021
*                                            BUFFER ADDRESS OF OPTION   25100021
*                                            PANEL IS FIRST ASSIGNED    25150021
*                                            SO INDEX IS ADDRESS        25200021
*                                            DIVIDED BY 256 BUFFER      25250021
*                                            SECTION SIZE)              25300021
         LH    WORKR1,CKCBBFAD         GET BUFFER ADDRESS               25320021
         SLL   WORKR1,X16BITS          SHIFT OUT SIGN BITS              25340021
         SRL   WORKR1,X16BITS          RESTORE REG VALUE                25360021
         LA    WORKR2,NUMONE            GET ONE TO                      25400021
         MR    WORKR0,WORKR2                 MULTIPLY BY TO SET UP FOR  25450021
*                                            DIVIDE                     25500021
         LA    WORKR2,NUM256            GET BUFFER SECTION SIZE AND     25550021
         DR    WORKR0,WORKR2                 DIVIDE TO GET NUMBER OF    25600021
         LR    BUFINDXR,WORKR0               SECTION READ IN            25650021
         SPACE 2                                                        25700021
         B     LINEFORM                 GO FORMAT THIS BUFFER SECTION   25750021
         DROP  DECBR                                                    25800021
         DROP  CKCBR                                                    25850021
         EJECT                                                          25900021
*********************************************************************** 25950021
*                                                                     * 26000021
*              FIND NEXT BUFFER SECTION AND READ IT IN                * 26050021
*                                                                     * 26100021
*********************************************************************** 26150021
         SPACE 2                                                        26200021
STARTDMP SR    BUFINDXR,BUFINDXR        ZERO OUT REGISTER               26250021
CKASSIGN EQU   *                                             LG Z30AALG 26310000
         SR    UCBR,UCBR               CLEAR REGISTER        LG Z30AALG 26320000
         ICM   UCBR,THREE,CKQEUCB      GET UCB ADDRESS       LG Z30AALG 26330000
         USING BUFTABLE,BUFTABR         ESTABLISH ADDRESSABILITY FOR    26350021
*                                            BUFFER TABLE               26400021
         USING UCB,UCBR                 ESTABLISH ADDRESSABILITY FOR    26450021
*                                            UNIT CONTROL BLOCK         26500021
         L     BUFTABR,UCBBFTAB-X1BYTE       GET BUFFER TABLE ADDRESS   26550021
         CLI   UCBTYP,MODEL1            IS THIS A 2250 MODEL 1          26600021
         BNE   MOD2OR3                  IF NOT TAKE BRANCH              26650021
         LA    WORKR1,NUMONE            FOR MODEL 1 ONLY HAVE ONE       26700021
*                                            DEVICE ENTRY IN BUFFER     26750021
*                                            TABLE                      26800021
         B     ADDHEAD                                                  26850021
MOD2OR3  LA    WORKR1,NUM4              FOR MODEL 2 OR 3 HAVE FOUR      26900021
*                                            DEVICE ENTRIES IN TABLE    26950021
*                                            NO MATTER HOW MANY DEVICES 27000021
*                                            ARE ON THE 2840            27050021
ADDHEAD  LA    WORKR1,NUMONE(WORKR1)    ADD ONE ENTRY FOR HEADER THEN   27100021
         SLL   WORKR1,X3BITS                 MULTIPLY BY 8 TO HAVE      27150021
*                                            DISPLACEMENT TO DEVICE     27200021
*                                            ASSIGNMENT SECTIONS        27250021
         AR    BUFTABR,WORKR1           ADD DISPLACEMENT TO START OF    27300021
*                                            TABLE                      27350021
         AR    BUFTABR,BUFINDXR         ADD SECTIONS DISPLACEMENT TO    27400021
*                                            SEE IF ASSIGNED            27450021
         CLC   UCBDEVI,ZERO(BUFTABR)         IS THIS BUFFER SECTION     27500021
*                                            ASSIGNED TO 2250 UNDER     27550021
*                                            CONTROL OF CANCEL KEY      27600021
*                                            ROUTINE.                   27650021
         BE    READIN                   IF YES TAKE BRANCH              27700021
CKNEXTAS LA    BUFINDXR,NUMONE(BUFINDXR)     UP INDEX TO NEXT BUFFER    27750021
*                                            DEVICE ASSIGN BYTE         27800021
         SR    UCBR,UCBR               CLEAR REGISTER        LG Z30AALG 27860000
         ICM   UCBR,THREE,CKQEUCB      GET UCB ADDRESS       LG Z30AALG 27870000
         L     BUFTABR,UCBBFTAB-X1BYTE  GET BUFFER TABLE ADDRESS        27900021
         CH    BUFINDXR,BFTLN           HAVE SEARCHED TOTAL TABLE       27950021
         BNH   CKASSIGN                 IF NOT TAKE BRANCH              28000021
         BAL   INTRTNR,WRITE            WRITE BLANK LINE                28050021
         MVC   LNEOD,MSGEOD             PLACE 'END OF DUMP' ON LINE     28100021
         BAL   INTRTNR,WRITE            GO WRITE LAST LINE              28150021
         BAL   INTRTNR,WRITE           AGAIN FOR BLOCKED RECORDS        28200021
         BAL   INTRTNR,WRITE           TWICE                            28250021
         SR    RTNCODER,RTNCODER        SET RETURN CODE FOR NORMAL      28300021
*                                            COMPLETION (I.E. = 0)      28350021
         B     EXIT                     GO DO HOUSE KEEPING AND RETURN  28400021
*                                            TO CALLER                  28450021
         DROP  UCBR                                                     28500021
READIN   L     CKCBR,CKQECKCB           GET POINTER TO CKCB             28550021
         USING CKCB,CKCBR               ESTABLISH ADDRESSABILITY FOR    28600021
*                                            CANCEL KEY CONTROL BLOCK   28650021
         LR    WORKR2,BUFINDXR          TAKE INDEX VALUE AND            28700021
         SLL   WORKR2,X8BITS                 MULTIPLY BY 256 TO GET     28750021
*                                            DISPLACEMENT OF BUFFER     28800021
*                                            SECTION IN BYTES           28850021
         ST    WORKR2,CKCBWRKA          PLACE ADDRESS INTO WORK AREA    28900021
         LA    WORKR2,CKCBWRKA+X2BYTES       GET POINTER TO ADDRESS     28950021
*                                            VALUE JUST STORED          29000021
         LA    DECBR,CKCBDECB           GET DECB ADDRESS                29050021
         USING DECB,DECBR               ESTABLISH ADDRESSABILITY FOR    29100021
*                                            DATA EVENT CONTROL BLOCK   29150021
         XC    DECBECB,DECBECB          CLEAR WAIT-POST FLAGS IN ECB    29200021
         DROP  CKCBR                                                    29220021
         L     BUFFSECR,OPCBINBF        GET ADDRESS OF READ INPUT       29250021
*                                            BUFFER                     29300021
         L     BUFSTR,DECBSTAD-X1BYTE   GET RESTART GENERATION ADDRESS  29350021
*                                            POINTER                    29400021
         L     DCBR,CKQEDCB             GET DCB ADDRESS                 29450021
*                                       READ IN NEXT SECTION OF 2250    29500021
*                                            BUFFER                     29550021
         LR    WORKR1,DECBR             GET DATA EVENT CONTROL BLOCK    29600021
*                                            ADDRESS INTO REGISTER U    29650021
*                                            ADDRESS INTO REGISTER 1    29700021
*                                            FOR MACRO                  29750021
         SR    GIOCRR1,GIOCRR1         CLR REGISTER          LG @ZM2360 29760000
         ICM   GIOCRR1,THREE,CKQEUCB  GET UCB ADDRESS        LG @ZM2360 29770000
         L     GIOCRR1,TEB(GIOCRR1)  GET TEB ADDRESS         LG @ZM2360 29780000
         CLC   GIOCR(3,GIOCRR1),DCBGIOCR(DCBR)  ADDR IN DCB CORRECT?    29790000
         BE    STREGEN               YES,ISSUE READ          LG @ZM2360 29798400
         LA    WORKR2,MSG#9          NO,LD MSG DISP FOR WTO  LG @ZM2360 29798800
         B     COMMON                GO ISSUE WTO            LG @ZM2360 29799200
STREGEN  EQU   *                                             LG @ZM2360 29799600
         GREAD (WORKR1),STR,(DCBR),256,(BUFFSECR),(WORKR2),(BUFSTR),   C29800021
               MF=E                                                     29850021
         LTR   RTNCODER,RTNCODER        WAS I/O STARTED                 29900021
         LA    WORKR2,FOUR             SET INDEX TO WTO TABLE           29930021
         BNE   COMMON                  ISSUE ERROR MESSAGE              29960021
         WAIT  1,ECB=(DECBR)            WAIT ON I/O TO COMPLETE         30000021
         CLI   DECBECB,SUCCESS          WAS I/O SUCCESSFUL              30050021
         BE    LINEFORM                 GO FORMAT BUFFER SECTION        30100021
         LA    WORKR2,FOUR             SET INDEX TO WTO TABLE           30120021
*                                                                       30150021
*********************************************************************** 30160021
*                                                                     * 30170021
*        THIS ROUTINE WILL ISSUE WTO'S FOR ERROR CONDITIONS           * 30180021
*                                                                     * 30190021
*********************************************************************** 30200021
COMMON   L     CKCBR,CKQECKCB                                           30210021
         USING  CKCB,CKCBR                                              30220021
         L     WORKR1,CKCBERMT         LOAD POINTER TO WTO TABLE        30230021
         L     WORKR1,ZERO(WORKR2,WORKR1)    GET POINTER TO MSG         30240021
         SR    UCBR,UCBR               CLEAR REGISTER        LG Z30AALG 30310000
         ICM   UCBR,THREE,CKQEUCB      GET UCB ADDRESS       LG Z30AALG 30320000
         USING UCB,UCBR                 ESTABLISHING ADDRESSABILITY     30350021
*                                            FOR UNIT CONTROL BLOCK     30400021
         USING WTOMSG,WORKR1            ESTABLISH ADDRESSABILITY FOR    30450021
*                                            WRITE TO OPERATOR MESSAGE  30500021
         MVC   CKCBWRKA(NUM57),WTOMSG   MOVE MSG TO WORK AREA TO        30520021
*                                      MAINTAIN REENTERABILITY          30540021
         MVC   CKCBWRKA+TWELVE(NUM3),UCBNAME    PUT UCBNAME IN WTO      30560021
         LA    WORKR1,CKCBWRKA         GET ADDR OF MSG FOR WTO MACRO    30580021
         WTO   MF=(E,(1))               ISSUE WTO                       30600021
         LA    RTNCODER,ABNORMAL        SET RETURN CODE AS ERROR        30650021
*                                            CONDITION EXISTS           30700021
* GO CLEAN UP AND RETURN TO CALLER                                      30770021
         DROP  UCBR                                                     30850021
         EJECT                                                          30900021
*********************************************************************** 30950021
*                                                                     * 31000021
*                    EXIT ROUTINE FOR NORMAL AND ADNORMAL RETURN      * 31050021
*                                                                     * 31100021
*********************************************************************** 31150021
         SPACE 2                                                        31200021
*    NOTE:  THE RETURN CODE MUST BE IN REGISTER (15)                    31250021
*                                 UPON ENTRY TO THIS SUB-PROGRAM        31300021
         SPACE 2                                                        31350021
EXIT     OI    CKQEFLG1,CKFEXIT         INDICATE THAT EXIT IS NOW       31400021
*                                            IN PROCESS                 31450021
         L     CKCBR,CKQECKCB           GET CKCB ADDRESS                31500021
         ST    RTNCODER,CKCBWRKA+X24BYTES         SAVE RETURN CODE      31550021
         TM    CKQEFLG2,CKFOPEN    IS DCB OPEN?               LG YM5686 31560000
         BNO   FREEBUFF            NO,DO NOT ATTEMPT TO CLOSE LG YM5686 31570000
         L     DCBR,OPCBDCB        GET DCB ADDRESS(SYSBFDMP)  LG YM5686 31580000
         LA    WORKR1,CKCBWORK     GET ADDRESS OF LIST        LG YM5686 31590000
         MVI   ZERO(WORKR1),X'8F'  INDICATE LAST DCB          LG YM5686 31592000
         CLOSE ((DCBR)),MF=(E,(1))                            LG YM5686 31594000
         NI    CKQEFLG2,CLOSED     NOTE DCB CLOSED            LG YM5686 31598400
         LA    WORKR1,CKCBWORK     GET ADDRESS OF LIST        LG YM5686 31599200
         LA    DCBR,OPCBDCB        GET ADDRESS OF DCB ADDRESS LG YM5686 31599300
         FREEMAIN E,LV=DCBLEN,A=(DCBR),SP=252,MF=(E,(1))      LG YM5686 31599600
FREEBUFF EQU   *                                              LG YM5686 31599700
         TM    CKQEFLG2,CKFINBUF        HAS INPUT BUFFER BEEN GOTTEN    31600021
         BNO   EXCKOPCB                 IF NOT TAKE BRANCH              31650021
         LA    WORKR2,OPCBINBF          GET ADDRESS OF BUFFER ADDRESS   31700021
*                                            IN BYTES                   31750021
         LA    WORKR1,CKCBWORK         PT TO LIST IN CKCB     LI A39419 31780021
         FREEMAIN E,LV=INBUFLN,A=(WORKR2),SP=252,MF=(E,(1))   LI A39419 31810021
         NI    CKQEFLG2,FULLMASK-CKFINBUF         TURN OFF BUFFER       31850021
*                                            ACQUIRED SWITCH            31900021
EXCKOPCB TM    CKQEFLG2,CKFOPCB         HAS THE OPCB GETMAIN BE ISSUED  31950021
         BNO   EXRTN                    IF NOT TAKE BRANCH              32000021
         LA    DECBR,OPCBDECB          GET LINE DECB ADDR FOR CHECK     32050021
EXFROPCB L     WORKRE,HSA               GET CALLERS SAVE AREA           32100021
         LA    WORKR2,CKCBOPCB          GET ADDRESS OF OPCB'S ADDRESS   32150021
         LA    WORKR3,OPCBLEN           GET LENGTH OF OPCB LENGTH       32200021
*                                       FREE UP OPCB AREA               32250021
         LA    WORKR1,CKCBWORK         PT TO LIST IN CKCB     LI A39419 32280021
         FREEMAIN E,LV=(WORKR3),A=(WORKR2),SP=252,MF=(E,(1))  LI A39419 32310021
         NI    CKQEFLG2,FULLMASK-CKFOPCB    RESET BIT IN CKQE           32350021
         LR    SAVEPTR,WORKRE           PLACE SAVEAREA ADDRESS INTO     32400021
*                                            PROPER REGISTER            32450021
EXRTN    NI    CKQEFLG1,FULLMASK-CKFEXIT     TURN OFF EXIT IN PROCESS   32500021
         L     RTNCODER,CKCBWRKA+X24BYTES        GET RETURN CODE SAVED  32550021
*                                                 EARLIER               32600021
         RETURN     (14,12),T,RC=(15)             RETURN TO CALLER      32650021
*                                                                       32700021
*                                                                       32750021
*                                                                       32800021
         EJECT                                                          32850021
*********************************************************************** 32900021
*                                                                     * 32950021
*                   PRINT BUFFER SECTION ROUTINE                      * 33000021
*                                  AND                                * 33050021
*                             FORMAT A LINE OF  BUFFER DUMP           * 33100021
*                                                                     * 33150021
*********************************************************************** 33200021
         SPACE 2                                                        33250021
LINEFORM L     CKCBR,CKQECKCB           GET CKCB ADDRESS                33300021
         LA    DECBR,CKCBDECB           ESTABLISH ADDRESSABILITY        33350021
         USING DECB,DECBR               FOR DATA EVENT CONTROL BLOCK    33400021
         L     HEXR,DECBAREA            GET INPUT BUFFER ADDRESS        33450021
         SR    WORKRF,WORKRF            ZERO OUT REGISTER               33500021
         L     WORKRE,DECBBFAD-X1BYTE        GET BUFFER SECTION ADDRESS 33550021
         IC    WORKRF,X1BYTE(WORKRE)         GET BUFFER SECTION         33600021
*                                            DISPLACEMENT OF 0 TO 256   33650021
         AR    HEXR,WORKRF              ADD TO START OF 256 BYTE        33700021
*                                            SECTION READ IN BUFFER     33750021
*                                            ADDRESS                    33800021
         MVC   LININTA,ZERO(HEXR)            MOVE BUFFER DATA           33850021
*                                            INTO OUTPUT LINE TO WORK   33900021
*                                            FROM AND LATER TO BE       33950021
*                                            INTERPRETED IN.            34000021
         LA    MOVELNGR,X4BYTES         SET CHARACTER COUNT TO 4        34050021
         L     HEXR,DECBBFAD-X1BYTE     GET ADDRESS OF BUFFER SECTION   34100021
*                                            FOR FIRST BYTE OF LINE     34150021
         LA    EBCDICR,LINEBFAD         GET BUFFER ADDRESS POSITION     34200021
*                                            ON OUTPUT LINE             34250021
         BAL   INTRTNR,HEXTOEBC         GO PLACE PRINTABLE BUFFER       34300021
*                                            ADDRESS ON LINE            34350021
         LA    EBCDICR,X2BYTES(EBCDICR)      SPACE UP TO NEXT FIELD     34400021
*                                            TO BE FILLED IN            34450021
         LA    HALFLNR,NUM2             SET LOOP REGISTER FOR HALF LINE 34500021
*                                            COUNTER  (I.E. 2)          34550021
         LA    HEXR,LININTA             SET POINTER TO BUFFER DATA      34600021
*                                            TO BE CONVERTED            34650021
HALFLINE LA    WORDCTR,NUM4             SET LOOP REGISTER FOR WORDS IN  34700021
*                                            HALF LINE (I.E. 4)         34750021
WORD     LA    MOVELNGR,X8BYTES         SET CHARACTER COUNT TO 8        34800021
         LA    EBCDICR,X1BYTE(EBCDICR)  SPACE TO START OF NEXT FIELD    34850021
         BAL   INTRTNR,HEXTOEBC         GO HAVE WORD CONVERTED          34900021
         BCT   WORDCTR,WORD             HAVE DONE HALF LINE  (I.E. FOUR 34950021
*                                            FULL WORDS) ?    IF NOT    35000021
*                                            LOOP BACK                  35050021
         LA    EBCDICR,X3BYTES(EBCDICR) SPACE UP OUTPUT LINE POINTER    35100021
         BCT   HALFLNR,HALFLINE         HAVE DONE FULL LINE OR          35150021
*                                            TWO HALF LINES? IF NOT     35200021
*                                            LOOP BACK TO D SECOND      35250021
*                                            HALF                       35300021
         TR    LININTA,TTRTABLE                   INTERPERT BUFFER DATA 35350021
         MVI   LINEFATK,ASTERISK        PLACE * AROUND INTERPERTED      35400021
         MVI   LINEBATK,ASTERISK             DATA                       35450021
         BAL   INTRTNR,WRITE            OUTPUT LINE                     35500021
         LA    WORKRF,X32BYTES          GET 32 BYTE COUNT               35550021
         L     CKCBR,CKQECKCB           GET POINTER TO CKCB             35600021
         LA    DECBR,CKCBDECB           GET POINTER TO DATA EVENT       35650021
*                                            CONTROL BLOCK              35700021
         L     WORKRE,DECBBFAD-X1BYTE   GET BUFFER SECTION ADDRESS      35750021
         AH    WORKRF,ZERO(WORKRE)      UP BUFFER DATA ADDRESS BY 32    35800021
         STH   WORKRF,ZERO(WORKRE)      RESET BUFFER DATA ADDRESS       35850021
         CLI   X1BYTE(WORKRE),BYTEZERO       HAVE WE FORMATED A FULL    35900021
*                                            BUFFER SECTION (I.E. IS    35950021
*                                            ADDRESS MULTIPLE OF 256    36000021
*                                            AND ADDRESS LOW ORDER      36050021
*                                            BYTE ZERO)                 36100021
         BE    CKNEXTAS                 IF YES TAKE BRANCH              36150021
         B     LINEFORM                 GO FORMAT LINE OF THIS          36200021
*                                           BUFFER SECTION              36250021
         EJECT                                                          36300021
*********************************************************************** 36350021
*                                                                     * 36400021
*                   OUTPUT CONTROL SUB-PROGRAM                        * 36450021
*                                                                     * 36500021
*********************************************************************** 36550021
         SPACE 2                                                        36600021
*  INPUT:      ADDRESS IN THE OPCBR REGISTER OF THE OPCB                36650021
         SPACE 2                                                        36700021
*  ENTRY:      EJECT - TO WRITE LINE IN CURRENT LINE OF OPCB AND        36750021
*                             EJECT TO NEW PAGE OF OUTPUT               36800021
*                                                                       36850021
*              WRITE - TO WRITE LINE IN CURRENT LINE OF OPCB AND        36900021
*                             SPACE TO NEXT LINE OF OUTPUT              36950021
*                                                                       37000021
*              WRITESP - TO WRITE LINE IN CURRENT LINE OF OPCB AND      37050021
*                             SKIP ONE LINE OF OUTPUT                   37100021
*                                                                       37150021
*              WRITESP2 - TO WRITE LINE IN CURRENT LINE OF OPCB AND     37200021
*                             SKIP TWO LINES OF OUTPUT                  37250021
*                                                                       37300021
*  EXIT:       BRANCH BACK ON RETURN ADDRESS OF INTERNAL RETURN         37350021
*                   REGISTER INTRTNR                                    37400021
*                                                                       37450021
*  OUTPUT:     TAKE CURRENT LINE AND ISSUE I/O FOR IT. PLACE NEXT       37500021
*                   LINE TO BE USED INTO CURRENT LINE POINTER OF        37550021
*                   OPCB                                                37600021
*                                                                       37650021
*  FUNCTION:   TAKE CURRENT LINE AND ISSUE I/O FOR IT. PLACING PROPER   37700021
*                   CONTROL CODES INTO FIRST BYTE OF LINE. (THE CONTROL 37750021
*                   CODE IS DEPENDENT ON ENTRY POINT TO SUB-PROGRAM)    37800021
*              IF THE NEXT LINE NEEDS TO HAVE A CHECK MADE BEFORE       37850021
*                   CONTROL IS RETURNED TO WHERE IT IS CALLED FROM      37900021
*                   THE CHECK WILL BE ISSUED.                           37950021
*              LINE COUNT IS KEEP SO WHEN LINE COUNT EXCEEDS MAXIMUM    38000021
*                   LIMIT PER PAGE THEN AN AUTOMATIC EJECT WILL TAKE    38050021
*                   PLACE WITH WRITING OF PAGE NUMBER ON TOP LINE OF    38100021
*                   NEW PAGE.                                           38150021
         SPACE 2                                                        38200021
WRITE    MVI   LNCNTCD,WRTSP1        SET CONTROL CODE TO WRITE          38250021
*                                        AND SPACE                      38300021
         LA    SUMR,NUM1                GET ONE TO                      38350021
PAGEFULL AH    SUMR,OPCBLCNT            ADD TO LINE COUNT               38400021
         STH   SUMR,OPCBLCNT            SAVE LINE COUNT                 38450021
UPLINE   SR    INDEXR,INDEXR           CLEAR REGISTER                   38500021
         IC    INDEXR,OPCBLNI          GET NEXT LINE INDEX VALUE        38550021
         L     WORKR1,ZERO(INDEXR,OPCBR)    GET NEXT LINE POINTER       38600021
         ST    WORKR1,OPCBCRLN-X1BYTE  MAKE CURRENT NEXT LINE           38650021
         CLI   OPCBLCNT+X1BYTE,NUM55    IS PAGE FULL (I.E. PAGE COUNT   38700021
*                                            > OR = 55)                 38750021
         BL    CKBLOCK                 IF PAGE NOT FULL TAKE BRANCH     38800021
SETEJECT MVI   LNCNTCD,EJECTCD          SET CONTROL CODE TO WRITE AND   38850021
*                                            EJECT                      38900021
CKBLOCK  L     DCBR,OPCBDCB            GET O/P DCB ADDRESS              38950021
         USING DCB,DCBR            ZA14043 LOGICALLY DELETES 5 LINES    39000000
*        TM    DCBDEVT,DCBDTDA        O/P TAPE OR DA??      D11 ZA14043 39020000
*        BZ    ZEROECB             NO-DONT BLOCK RECS       D11 ZA14043 39050000
*        C     LINER,OPCBLN3-X1BYTE LAST LINE IN BLOCK??    D11 ZA14043 39100000
*        BNE   BLANKOUT                NO-TAKE BRANCH       D11 ZA14043 39150000
*        SPACE 2                                            D11 ZA14043 39200000
*                        PREPARE TO OUTPUT THIS LINE AND ISSUE I/O      39300021
         SPACE 2                                                        39350021
ZEROECB   XC    OPCBECB,OPCBECB      ZERO O/P ECB                       39400021
         LA    DECBR,OPCBDECB          GET ADDR OF O/P DECB             39450021
         L     LINER,OPCBLN1-X1BYTE    GET BUFFER ADDR                  39500021
         ST    LINER,OPCBCRLN-X1BYTE   SET CURRENT LINE AS LINE ONE     39550021
*                                      INCASE O/P NOT BLOCKED           39600021
         WRITE      (DECBR),SF,(DCBR),(LINER),'S',MF=E      WRITE LINE  39650021
*                                       CHECK CURRENT LINE FOR          39700021
*                                            SUCCESSFUL I/O LAST TIME   39750021
*                                            USED                       39800021
         CHECK      (DECBR)                                             39850021
         CLI   OPCBECB,SUCCESS         I/O SUCCESSFUL                   39900021
         BNE   BLANKOUT                 IF NOT TAKE BRANCH              39950021
         NI    OPCBERRF,FULLMASK-IOERBSAM         NOTE THAT THIS I/O    40000021
*                                            WAS SUCCESSFUL (I.E.       40050021
*                                            INDICATE THAT DO NOT HAVE  40100021
*                                            CONSECUTIVE I/O ERRORS)    40150021
*                                                                       40200021
BLANKOUT L     LINER,OPCBCRLN-X1BYTE   GET ADDR OF NEXT LINE            40250021
         MVI   LINE,BLANK              MOVE IN BLANK CHAR               40300021
         MVC   LINETEXT,LINE                 MAKE ALL OF LINE BLANKS    40350021
         CLI   OPCBLCNT+X1BYTE,NUM55    IS PAGE FULL                    40400021
*                                                                       40450021
         BCR   LOW,INTRTNR              IF NOT TAKE BRANCH              40500021
         XC    OPCBLCNT,OPCBLCNT        SET LINE COUNT TO ZERO          40550021
         AP    OPCBPCNT,OPCBDEC1        UP PAGE COUNT BY ONE            40600021
         MVC   LNPAGNM,TXTPAGE          MOVE 'PAGE' TO LINE             40650021
*                                            LINE                       40700021
         ED    LNPAGNO,OPCBPCNT         CHANGE DECIMAL PAGE COUNT TO    40750021
*                                            ECBDIC                     40800021
         B     WRITESP2                 GO WRITE OUT LINE               40850021
         SPACE 3                                                        40900021
EJECT    MVI   LINE,BLANK               MOVE IN BLANK CHARACTER         40950021
         MVC   LINETEXT,LINE                 MAKE ALL CHARACTERS BLANKS 41000021
         MVI   OPCBLCNT+X1BYTE,NUM55    SET LINE COUNT TO PAGE FULL     41050021
         B     UPLINE                  SET CONTROL CODE FOR EJECT       41100021
         SPACE 3                                                        41150021
WRITESP  MVI   LNCNTCD,WRTSPCD          SET CONTROL CODE TO WRITE AND   41200021
*                                            SPACE TWICE                41250021
         LA    SUMR,NUM2                GET TWO TO                      41300021
*                                       ADD TO LINE COUNT               41350021
         B     PAGEFULL                 GO CHECK TO SEE IF PAGE FULL    41400021
         SPACE 3                                                        41450021
WRITESP2 MVI   LNCNTCD,WRTSP2CD         SET CONTROL CODE TO WRITE AND   41500021
*                                            SPACE THREE TIMES          41550021
         LA    SUMR,NUM3                GET THREE TO                    41600021
*                                       ADD TO LINE COUNT               41650021
         B     PAGEFULL                 GO CHECK TO SEE IF PAGE FULL    41700021
         EJECT                                                          41750021
*********************************************************************** 41800021
*                                                                     * 41850021
*                   BSAM I/O ERROR ANALYSIS ROUTINE                   * 41900021
*                                                                     * 41950021
*********************************************************************** 42000021
*                        THE CHECK ROUTINE IGG019BB GIVES US CONTROL    42050021
*                        UPON PERMANENT I/O ERROR CONDITION. CHECK      42100021
*                        MAY USE REGISTERS 14-8 BUT SAVED THEM BY       42150021
*                        STANDARD CONVENTIONS IN MY SAVE AREA POINTER   42200021
*                        TO BY REGISTER 13.  SINCE CHECK WILL NOT       42250021
*                        REINITIALIZE 9-13 FOR US WE SHOULD NOT         42300021
*                        ALTER THEM                                     42350021
ERFORMAT TM    CKQEFLG1,CKFEXIT         IS EXIT IN PROCESS              42400021
         BCR   ONES,RETURNR             IF YES TAKE BRANCH              42450021
*                   IF THE ERROR IS THE SECOND IN A ROW THEN BSAM       42500021
*                        PROCESSING WILL BE STOPPED AND WE WILL RESTORE 42550021
*                        REGISTERS 14-8 FROM OUR SAVE AREA POINTED TO   42600021
*                        BY REGISTER 13.  THESE ARE OUR REGISTERS       42650021
*                        AT TIME OF GOING TO CHECK.                     42700021
         TM    OPCBERRF,IOERBSAM        IS THIS CONSECTIVE ERROR        42750021
         BZ    GETMSG                   IF NOT TAKE BRANCH              42800021
*                   IF THIS IS NOT A CONSECUTIVE ERROR WILL ISSUE       42850021
*                        SYNADAF MACRO AND THEN ISSUE WRITE TO OPERATOR 42900021
*                        TO NOTE ERROR AND THEN SET SWITCH THAT BSAM    42950021
*                        I/O ERROR HAS OCCURED.                         43000021
         LM    RETURNR,DEBR,R0                    RESTORE REGISTERS     43050021
*                                            TO THE WAY THEY WERE       43100021
*                                            BEFORE CHECK WAS ISSUED    43150021
         B     EXIT                     GO CLEAN UP AND STOP            43200021
GETMSG   SYNADAF    ACSMETH=BSAM             FORMAT OUTPUT OF ERROR     43250021
         MVC   ZERO(FOUR,WORKR1),LENFLGS1    MOVE WTO LENGTH            43270021
*                                            AND MCSFLGS TO             43290021
*                                            START OF WTO               43310021
         MVC   FOUR(SEVEN,WORKR1),MSGHDRID    MOVE MSG ID TO WTO        43330021
         SR    UCBR,UCBR               CLEAR REGISTER        LG Z30AALG 43360000
         ICM   UCBR,THREE,CKQEUCB      GET UCB ADDRESS       LG Z30AALG 43362000
         USING UCB,UCBR                ESTABLISH ADDRESSABILITY         43370021
*                                      FOR UNIT CONTROL BLOCK           43390021
         MVC   TWELVE(THREE,WORKR1),UCBNAME     ADD UCB NAME TO WTO     43410021
         MVC   SIXTN(FORTY,WORKR1),FIFTY(WORKR1)     SHIFT MSG          43430021
         MVC   X56BYTES(FOUR,WORKR1),RCDC    MOVE ROUTING AND           43450021
*                                      DESCRIPTOR CODES TO WTO          43470021
         LA    WORKR2,SIXTY(WORKR1)    GET WTO AREA ADDR FOR MSG2       43490021
         MVC   ZERO(FOUR,WORKR2),LENFLGS2    MOVE WTO LENGTH AND        43510021
*                                            MCSFLGS TO WTO 2           43530021
         MVC   FOUR(SEVEN,WORKR2),MSGHDRID    MOVE MSG ID TO WTO        43550021
         MVC   TWELVE(THREE,WORKR2),UCBNAME   ADD UCBNAME TO WTO        43570021
         MVC   SIXTN(X37BYTES,WORKR2),X91BYTES(WORKR2)   SHIFT MSG      43590021
         MVC   X53BYTES(FOUR,WORKR2),RCDC    MOVE ROUTING AND           43610021
*                                    DESCRIPTOR CODES TO WTO            43630021
         WTO   MF=(E,(1))               ISSUE WTO                       43800021
         LR    WORKR1,WORKR2           LOAD REG ONE FOR WTO             43810021
         WTO   MF=(E,(1))              ISSUE WTO                        43820021
         OI    OPCBERRF,IOERBSAM        NOTE HAVE HAD I/O ERROR         43850021
         SYNADRLS                       CLEAN UP SAVE AREA CHAINING     43900021
         LTR   RTNCODER,RTNCODER        WAS FREEING OF SAVE AREA        43950021
*                                            SUCCESSFUL                 44000021
*                                       IF YES TAKE BRANCH              44050021
         BCR   EQUAL,RETURNR            GO BACK TO CHECK AND CONTINUE   44100021
*                                       PROCESSING BSAM OUTPUT          44150021
*                   IF RELEASE OF SAVE AREA AND RESTORING OF REGISTER   44200021
*                        13 TO MY SAVE AREA HAS FAILS WILL TRY TO       44250021
*                        RECOVER BY LOADING REGISTER 13 FROM MY SAVE    44300021
*                        AREA DISPLACEMENT IN OPCB THEN GO BACK TO      44350021
*                        CHECK.  THIS IS A LAST EFFERATE AND IF FAILS   44400021
*                        CAN ONLY BE SORRY FOR TRIED TO KEEP RUNNING    44450021
*                        AS BEST POSIBLE. CHECK MUST POINT TO OUR       44500021
*                        SAVE AREA TO RESTORE REGISTERS BEFORE GOING    44550021
*                        BACK TO MAIN PROGRAM TO CONTINUE.              44600021
*                                                                       44650021
         LA    SAVEPTR,OPCBSVAR         GET POINTER TO SAVE AREA        44700021
         BR    RETURNR                  HOPFULLY GO BACK TO CHECK       44750021
         EJECT                                                          44800021
*********************************************************************** 44850021
*                                                                     * 44900021
*                   SUB-PROGRAM TO CONVERT HEX  TO EBCDIC             * 44950021
*                                                                     * 45000021
*********************************************************************** 45050021
         SPACE 2                                                        45100021
*  INPUT:      REGISTER MOVELGNR NUMBER OF BYTES OF EBCDIC INFROMATION  45150021
*                        TO BE PRODUCED                                 45200021
*              REGISTER HEXR  THE HEX  DATA TO BE CONVERTED TO EBCDIC   45250021
*                                                                       45300021
*              REGISTER EBCDICR THE PLACE WHERE THE EBCDIC INFORMATION  45350021
*                        IS TO GO UPON CONVERSION                       45400021
*  NOTE:       OUTPUT AREA MUST BE TWICE THE SIZE OF THE HEX DATA TO    45450021
*                        BE CONVERTED                                   45500021
*              AT COMPLETION OF THE MOVE OPERATION THE HEXR WILL POINT  45550021
*                   TO THE BYTE NEXT TO BE CONVERTED IF AN EVEN NUMBER  45600021
*                   OF BYTES ARE SPECIFIED OR TO THE BYTE HALF          45650021
*                   CONVERTED IF AN ODD NUMBER WAS SPECIFIED.           45700021
*                   THE EBCDICR REGISTER WILL POINT TO THE NEXT BYTE    45750021
*                   FIELD TO BE STORED INTO IN THE LINE.                45800021
         SPACE 2                                                        45850021
HEXTOEBC LTR   MOVELNGR,MOVELNGR        IS MOVE LENGTH ZERO             45900021
         BCR   EQUAL,INTRTNR            IF YES TAKE BRANCH              45950021
         SR    WORKRE,WORKRE            ZERO OUT REGISTER               46000021
MOVEMORE IC    WORKRE,ZERO(HEXR)        GET TWO HEX DIGITS              46050021
         SRDL  WORKRE,X4BITS            MOVE OUT SECOND DIGITS          46100021
         IC    WORKRF,EBCDICTB(WORKRE)       GET EBCDIC FOR HEX         46150021
         STC   WORKRF,ZERO(EBCDICR)     PLACE EBCDIC CHARACTER IN LINE  46200021
         LA    EBCDICR,NUMONE(EBCDICR)       UP OUTPUT POINTER          46250021
         BCT   MOVELNGR,SCNDHALF        LOWER NUMBER OF OUTPUT REQUEST  46300021
*                                            COUNT BY ONE AND IF HAVE   46350021
         BR    INTRTNR                       CONVERTED ALL THAT WAS     46400021
*                                            REQUESTED RETURN TO WHERE  46450021
*                                            CALLED                     46500021
SCNDHALF SR    WORKRE,WORKRE            ZERO OUT REGISTER               46550021
         SLDL  WORKRE,X4BITS            GET SECOND HALF OF BYTE         46600021
         IC    WORKRF,EBCDICTB(WORKRE)       GET EBCDIC FOR HEX         46650021
         STC   WORKRF,ZERO(EBCDICR)     PLACE EBCDIC CHARACTER ON LINE  46700021
         LA    EBCDICR,NUMONE(EBCDICR)       UP OUTPUT POINTER BY ONE   46750021
         LA    HEXR,NUMONE(HEXR)        UP INPUT POINTER TO NEXT BYTE   46800021
*                                                                       46850021
         BCT   MOVELNGR,MOVEMORE        LOWER NUMBER OF BYTES TO BE     46900021
*                                            CONVERTED BY ONE AND IF    46950021
         BR    INTRTNR                       HAVE CONVERTED ALL THAT    47000021
*                                            WAS REQUESTED RETURN TO    47050021
*                                            WHERE CALLED FROM          47100021
         EJECT                                                          47150021
*********************************************************************** 47200021
*                   THE TABLE USED BY THE TEST AND TRANSLATE          * 47250021
*                        INSTRUCTION TO INTERPRET THE DUMP CORE       * 47300021
*                                                                     * 47350021
*********************************************************************** 47400021
         SPACE 2                                                        47450021
*                                       HEX BYTE  TO BE PRINTED AS      47500021
TTRTABLE DC    X'4B'                      '00'          '.'             47550021
         DC    X'4B'                      '01'          '.'             47600021
         DC    X'4B'                      '02'          '.'             47650021
         DC    X'4B'                      '03'          '.'             47700021
         DC    X'4B'                      '04'          '.'             47750021
         DC    X'4B'                      '05'          '.'             47800021
         DC    X'4B'                      '06'          '.'             47850021
         DC    X'4B'                      '07'          '.'             47900021
         DC    X'4B'                      '08'          '.'             47950021
         DC    X'4B'                      '09'          '.'             48000021
         DC    X'4B'                      '0A'          '.'             48050021
         DC    X'4B'                      '0B'          '.'             48100021
         DC    X'4B'                      '0C'          '.'             48150021
         DC    X'4B'                      '0D'          '.'             48200021
         DC    X'4B'                      '0E'          '.'             48250021
         DC    X'4B'                      '0F'          '.'             48300021
         DC    X'4B'                      '10'          '.'             48350021
         DC    X'4B'                      '11'          '.'             48400021
         DC    X'4B'                      '12'          '.'             48450021
         DC    X'4B'                      '13'          '.'             48500021
         DC    X'4B'                      '14'          '.'             48550021
         DC    X'4B'                      '15'          '.'             48600021
         DC    X'4B'                      '16'          '.'             48650021
         DC    X'4B'                      '17'          '.'             48700021
         DC    X'4B'                      '18'          '.'             48750021
         DC    X'4B'                      '19'          '.'             48800021
         DC    X'4B'                      '1A'          '.'             48850021
         DC    X'4B'                      '1B'          '.'             48900021
         DC    X'4B'                      '1C'          '.'             48950021
         DC    X'4B'                      '1D'          '.'             49000021
         DC    X'4B'                      '1E'          '.'             49050021
         DC    X'4B'                      '1F'          '.'             49100021
         DC    X'4B'                      '20'          '.'             49150021
         DC    X'4B'                      '21'          '.'             49200021
         DC    X'4B'                      '22'          '.'             49250021
         DC    X'4B'                      '23'          '.'             49300021
         DC    X'4B'                      '24'          '.'             49350021
         DC    X'4B'                      '25'          '.'             49400021
         DC    X'4B'                      '26'          '.'             49450021
         DC    X'4B'                      '27'          '.'             49500021
         DC    X'4B'                      '28'          '.'             49550021
         DC    X'4B'                      '29'          '.'             49600021
         DC    X'4E'                      '2A'          '+'             49650021
         DC    X'4B'                      '2B'          '.'             49700021
         DC    X'4B'                      '2C'          '.'             49750021
         DC    X'4B'                      '2D'          '.'             49800021
         DC    X'4B'                      '2E'          '.'             49850021
         DC    X'4B'                      '2F'          '.'             49900021
         DC    X'4B'                      '30'          '.'             49950021
         DC    X'4B'                      '31'          '.'             50000021
         DC    X'4B'                      '32'          '.'             50050021
         DC    X'4B'                      '33'          '.'             50100021
         DC    X'4B'                      '34'          '.'             50150021
         DC    X'4B'                      '35'          '.'             50200021
         DC    X'4B'                      '36'          '.'             50250021
         DC    X'4B'                      '37'          '.'             50300021
         DC    X'4B'                      '38'          '.'             50350021
         DC    X'4B'                      '39'          '.'             50400021
         DC    X'4B'                      '3A'          '.'             50450021
         DC    X'4B'                      '3B'          '.'             50500021
         DC    X'4B'                      '3C'          '.'             50550021
         DC    X'4B'                      '3D'          '.'             50600021
         DC    X'4B'                      '3E'          '.'             50650021
         DC    X'4B'                      '3F'          '.'             50700021
         DC    X'40'                      '40'          ' '      A33603 50750021
         DC    X'4B'                      '41'          '.'             50800021
         DC    X'4B'                      '42'          '.'             50850021
         DC    X'4B'                      '43'          '.'             50900021
         DC    X'4B'                      '44'          '.'             50950021
         DC    X'4B'                      '45'          '.'             51000021
         DC    X'4B'                      '46'          '.'             51050021
         DC    X'4B'                      '47'          '.'             51100021
         DC    X'4B'                      '48'          '.'             51150021
         DC    X'4B'                      '49'          '.'             51200021
         DC    X'4A'                      '4A'          ''             51250021
         DC    X'4B'                      '4B'          '.'             51300021
         DC    X'4C'                      '4C'          '<'             51350021
         DC    X'4D'                      '4D'          '('             51400021
         DC    X'4E'                      '4E'          '+'             51450021
         DC    X'4F'                      '4F'          '|'             51500021
         DC    X'50'                      '50'          '&'             51550021
         DC    X'4B'                      '51'          '.'             51600021
         DC    X'4B'                      '52'          '.'             51650021
         DC    X'4B'                      '53'          '.'             51700021
         DC    X'4B'                      '54'          '.'             51750021
         DC    X'4B'                      '55'          '.'             51800021
         DC    X'4B'                      '56'          '.'             51850021
         DC    X'4B'                      '57'          '.'             51900021
         DC    X'4B'                      '58'          '.'  LD YA00801 51950001
         DC    X'4B'                      '59'          '.'  LD YA00801 52000001
         DC    X'5A'                      '5A'          ' '      A33603 52050021
         DC    X'5B'                      '5B'          '$'      A33603 52100021
         DC    X'5C'                      '5C'          '*'      A33603 52150021
         DC    X'5D'                      '5D'          ')'      A33603 52200021
         DC    X'5E'                      '5E'          ';'             52250021
         DC    X'5F'                      '5F'          '^'             52300021
         DC    X'60'                      '60'          '-'             52350021
         DC    X'61'                      '61'          '/'             52400021
         DC    X'4B'                      '62'          '.'             52450021
         DC    X'4B'                      '63'          '.'             52500021
         DC    X'4B'                      '64'          '.'             52550021
         DC    X'4B'                      '65'          '.'             52600021
         DC    X'4B'                      '66'          '.'             52650021
         DC    X'4B'                      '67'          '.'             52700021
         DC    X'4B'                      '68'          '.'             52750021
         DC    X'4B'                      '69'          '.'             52800021
         DC    X'4B'                      '6A'          '.'             52850021
         DC    X'6B'                      '6B'          ','             52900021
         DC    X'6C'                      '6C'          '%'             52950021
         DC    X'6D'                      '6D'          '_'             53000021
         DC    X'6E'                      '6E'          '>'             53050021
         DC    X'6F'                      '6F'          '?'             53100021
         DC    X'4B'                      '70'          '.'             53150021
         DC    X'4B'                      '71'          '.'             53200021
         DC    X'4B'                      '72'          '.'             53250021
         DC    X'4B'                      '73'          '.'             53300021
         DC    X'4B'                      '74'          '.'             53350021
         DC    X'4B'                      '75'          '.'             53400021
         DC    X'4B'                      '76'          '.'             53450021
         DC    X'4B'                      '77'          '.'             53500021
         DC    X'4B'                      '78'          '.'             53550021
         DC    X'4B'                      '79'          '.'             53600021
         DC    X'7A'                      '7A'          ':'      A33603 53650021
         DC    X'7B'                      '7B'          '#'      A33603 53700021
         DC    X'7C'                      '7C'          '@'      A33603 53750021
         DC    X'7D'                      '7D'          '''      A33603 53800021
         DC    X'7E'                      '7E'          '='      A33603 53850021
         DC    X'7F'                      '7F'          '"'      A33603 53900021
         DC    X'4B'                      '80'          '.'             53950021
         DC    X'C1'                      '81'          'A'             54000021
         DC    X'C2'                      '82'          'B'             54050021
         DC    X'C3'                      '83'          'C'             54100021
         DC    X'C4'                      '84'          'D'             54150021
         DC    X'C5'                      '85'          'E'             54200021
         DC    X'C6'                      '86'          'F'             54250021
         DC    X'C7'                      '87'          'G'             54300021
         DC    X'C8'                      '88'          'H'             54350021
         DC    X'C9'                      '89'          'I'             54400021
         DC    X'4B'                      '8A'          '.'             54450021
         DC    X'4B'                      '8B'          '.'             54500021
         DC    X'4B'                      '8C'          '.'             54550021
         DC    X'4B'                      '8D'          '.'             54600021
         DC    X'4B'                      '8D'          '.'             54650021
         DC    X'4B'                      '8F'          '.'             54700021
         DC    X'4B'                      '90'          '.'             54750021
         DC    X'D1'                      '91'          'J'             54800021
         DC    X'D2'                      '92'          'K'             54850021
         DC    X'D3'                      '93'          'L'             54900021
         DC    X'D4'                      '94'          'M'             54950021
         DC    X'D5'                      '95'          'N'             55000021
         DC    X'D6'                      '96'          'O'             55050021
         DC    X'D7'                      '97'          'P'             55100021
         DC    X'D8'                      '98'          'Q'             55150021
         DC    X'D9'                      '99'          'R'             55200021
         DC    X'4B'                      '9A'          '.'             55250021
         DC    X'4B'                      '9B'          '.'             55300021
         DC    X'4B'                      '9C'          '.'             55350021
         DC    X'4B'                      '9D'          '.'             55400021
         DC    X'4B'                      '9E'          '.'             55450021
         DC    X'4B'                      '9F'          '.'             55500021
         DC    X'4B'                      'A0'          '.'             55550021
         DC    X'4B'                      'A1'          '.'             55600021
         DC    X'E2'                      'A2'          'S'             55650021
         DC    X'E3'                      'A3'          'T'             55700021
         DC    X'E4'                      'A4'          'U'             55750021
         DC    X'E5'                      'A5'          'V'             55800021
         DC    X'E6'                      'A6'          'W'             55850021
         DC    X'E7'                      'A7'          'X'             55900021
         DC    X'E8'                      'A8'          'Y'             55950021
         DC    X'E9'                      'A9'          'Z'             56000021
         DC    X'4B'                      'AA'          '.'             56050021
         DC    X'4B'                      'AB'          '.'             56100021
         DC    X'4B'                      'AC'          '.'             56150021
         DC    X'4B'                      'AD'          '.'             56200021
         DC    X'4B'                      'AE'          '.'             56250021
         DC    X'4B'                      'AF'          '.'             56300021
         DC    X'4B'                      'B0'          '.'             56350021
         DC    X'4B'                      'B1'          '.'             56400021
         DC    X'4B'                      'B2'          '.'             56450021
         DC    X'4B'                      'B3'          '.'             56500021
         DC    X'4B'                      'B4'          '.'             56550021
         DC    X'4B'                      'B5'          '.'             56600021
         DC    X'4B'                      'B6'          '.'             56650021
         DC    X'4B'                      'B7'          '.'             56700021
         DC    X'4B'                      'B8'          '.'             56750021
         DC    X'4B'                      'B9'          '.'             56800021
         DC    X'4B'                      'BA'          '.'             56850021
         DC    X'4B'                      'BB'          '.'             56900021
         DC    X'4B'                      'BC'          '.'             56950021
         DC    X'4B'                      'BD'          '.'             57000021
         DC    X'4B'                      'BE'          '.'             57050021
         DC    X'4B'                      'BF'          '.'             57100021
         DC    X'4B'                      'B0'          '.'             57150021
         DC    X'C1'                      'C1'          'A'             57200021
         DC    X'C2'                      'C2'          'B'             57250021
         DC    X'C3'                      'C3'          'C'             57300021
         DC    X'C4'                      'C4'          'D'             57350021
         DC    X'C5'                      'C5'          'E'             57400021
         DC    X'C6'                      'C6'          'F'             57450021
         DC    X'C7'                      'C7'          'G'             57500021
         DC    X'C8'                      'C8'          'H'             57550021
         DC    X'C9'                      'C9'          'I'             57600021
         DC    X'4B'                      'CA'          '.'             57650021
         DC    X'4B'                      'CB'          '.'             57700021
         DC    X'4B'                      'CC'          '.'             57750021
         DC    X'4B'                      'CD'          '.'             57800021
         DC    X'4B'                      'CE'          '.'             57850021
         DC    X'4B'                      'CF'          '.'             57900021
         DC    X'4B'                      'D0'          '.'             57950021
         DC    X'D1'                      'D1'          'J'             58000021
         DC    X'D2'                      'D2'          'K'             58050021
         DC    X'D3'                      'D3'          'L'             58100021
         DC    X'D4'                      'D4'          'M'             58150021
         DC    X'D5'                      'D5'          'N'             58200021
         DC    X'D6'                      'D6'          'O'             58250021
         DC    X'D7'                      'D7'          'P'             58300021
         DC    X'D8'                      'D8'          'Q'             58350021
         DC    X'D9'                      'D9'          'R'             58400021
         DC    X'4B'                      'DA'          '.'             58450021
         DC    X'4B'                      'DB'          '.'             58500021
         DC    X'4B'                      'DC'          '.'             58550021
         DC    X'4B'                      'DD'          '.'             58600021
         DC    X'4B'                      'DE'          '.'             58650021
         DC    X'4B'                      'DF'          '.'             58700021
         DC    X'4B'                      'E0'          '.'             58750021
         DC    X'4B'                      'E1'          '.'             58800021
         DC    X'E2'                      'E2'          'S'             58850021
         DC    X'E3'                      'E3'          'T'             58900021
         DC    X'E4'                      'E4'          'U'             58950021
         DC    X'E5'                      'E5'          'V'             59000021
         DC    X'E6'                      'E6'          'W'             59050021
         DC    X'E7'                      'E7'          'X'             59100021
         DC    X'E8'                      'E8'          'Y'             59150021
         DC    X'E9'                      'E9'          'Z'             59200021
         DC    X'4B'                      'EA'          '.'             59250021
         DC    X'4B'                      'EB'          '.'             59300021
         DC    X'4B'                      'EC'          '.'             59350021
         DC    X'4B'                      'ED'          '.'             59400021
         DC    X'4B'                      'EE'          '.'             59450021
         DC    X'4B'                      'EF'          '.'             59500021
         DC    X'F0'                      'F0'          '0'             59550021
         DC    X'F1'                      'F1'          '1'             59600021
         DC    X'F2'                      'F2'          '2'             59650021
         DC    X'F3'                      'F3'          '3'             59700021
         DC    X'F4'                      'F4'          '4'             59750021
         DC    X'F5'                      'F5'          '5'             59800021
         DC    X'F6'                      'F6'          '6'             59850021
         DC    X'F7'                      'F7'          '7'             59900021
         DC    X'F8'                      'F8'          '8'             59950021
         DC    X'F9'                      'F9'          '9'             60000021
         DC    X'4B'                      'FA'          '.'             60050021
         DC    X'4B'                      'FB'          '.'             60100021
         DC    X'4B'                      'FC'          '.'             60150021
         DC    X'4B'                      'FD'          '.'             60200021
         DC    X'4B'                      'FE'          '.'             60250021
         DC    X'4B'                      'FF'          '.'             60300021
*                                                                       60350021
         EJECT                                                          60400021
*********************************************************************** 60450021
*                                                                     * 60500021
*                        EBCDIC LOOK UP TABLE FOR HEX TO EBCDIC       * 60550021
*                             CONVERSION                              * 60600021
*                                                                     * 60650021
*********************************************************************** 60700021
         SPACE 2                                                        60750021
*                                  HEX VALUE TO BE PRINTED AS           60800021
EBCDICTB DC    C'0'                  '0000'          '0'                60850021
         DC    C'1'                  '0001'          '1'                60900021
         DC    C'2'                  '0010'          '2'                60950021
         DC    C'3'                  '0011'          '3'                61000021
         DC    C'4'                  '0100'          '4'                61050021
         DC    C'5'                  '0101'          '5'                61100021
         DC    C'6'                  '0110'          '6'                61150021
         DC    C'7'                  '0111'          '7'                61200021
         DC    C'8'                  '1000'          '8'                61250021
         DC    C'9'                  '1001'          '9'                61300021
         DC    C'A'                  '1010'          'A'                61350021
         DC    C'B'                  '1011'          'B'                61400021
         DC    C'C'                  '1100'          'C'                61450021
         DC    C'D'                  '1101'          'D'                61500021
         DC    C'E'                  '1110'          'E'                61550021
         DC    C'F'                  '1111'          'F'                61600021
DISABLED DC    X'00'             MASK TO DISABLE ALL INTERRUPTS  A39421 61610021
ENABLED  DC    X'FF'                   MASK TO ENABLE ALL INTER  A39421 61620021
         EJECT                                                          61650021
         SPACE 2                                                        61700021
*                        PRINTER CONTROL CODES                          61750021
         SPACE 2                                                        61800021
WRTSP1   EQU   X'09'                    WRITE AND SPACE ONE LINE        61850021
WRTSPCD  EQU   X'11'                    WRITE AND SPACE TWO LINES       61900021
WRTSP2CD EQU   X'19'                    WRITE AND SPACE THREE LINES     61950021
EJECTCD  EQU   X'89'                    WRITE AND SKIP TO CHANNEL 1     62000021
NUM1     EQU   1                        HEX VALUE OF ONE                62050021
NUM2     EQU   2                        HEX VALUE OF TWO                62100021
NUM3     EQU   3                        HEX VALUE OF THREE              62150021
NUM4     EQU   4                        HEX VALUE OF FOUR               62200021
NUM55    EQU   55                       HEX VALUE OF 55                 62250021
NUM57    EQU   57                      HEX VALUE OF 57                  62258021
RCDC     DC    X'10004020'             ROUTING/DESCRIPTOR CODES         62266021
LENFLGS1 DC    X'00388000'             LENGTH/MCSFLGS FOR WTO 1         62274021
LENFLGS2 DC    X'00358000'             LENGTH/MCSFLGS FOR WTO 2         62282021
MSGHDRID DC    C'IFF005I'              MSG ID                           62290021
NUM256   EQU   256                      HEX VALUE OF 256                62300021
BLANK    EQU   X'40'                    EBCDIC BLANK CHARACTER          62350021
CKNEEDED EQU   X'FF'                    CHECK NEEDED FOR THIS LINE ECB  62400021
CLOSED   EQU   X'F7'             MASK TO SET DCB CLOSED FLGS  LG YM5686 62410000
TXTPAGE  DC    C'PAGE'                                                  62450021
PAGEMASK DC    X'20202020'              MASK USED IN EDIT OF PAGE COUNT 62500021
CKFERROR EQU   X'02'                    HAVE HAD ONE I/0 ERROR ON       62550021
*                                            BSAM OUT PUT               62600021
LOW      EQU   4                        CONDITION CODE FOR LOW (4)      62650021
EQUAL    EQU   8                        CONDITION CODE OF 8 (EQUAL)     62700021
NOTHIGH  EQU   13                       CONDITION CODE OF 13 (NOT HIGH) 62750021
ZERO     EQU   0                        DISPLACEMENT OF ZERO            62800021
NUMONE   EQU   1                        DISPLACEMENT OF ONE             62850021
X4BITS   EQU   4                        MOVEMENT OF 4 BITS              62900021
X8BITS   EQU   8                        SHIFT OF 8 BITS (1 BYTE)        62950021
*                                       ALSO MULTIPLY BY 256            63000021
ABNORMAL EQU   4                        ADNORMAL RETURN CODE            63050021
SUCCESS  EQU   X'7F'                    POST CODE FOR SUCCESSFUL I/O    63500021
FULLMASK EQU   X'FF'                    FULL BYTE OF ONES MASK          63550021
BYTEZERO EQU   X'00'                    BYTE OF ZEROS                   63600021
*                                       BRANCH IF TAKEN                 63650021
IOERBSAM EQU   X'FF'                    BSAM ERROR CONSECTATIVE ERROR   63700021
*                                            INDICATOR                  63750021
ONES     EQU   1                        CONDITION CODE OF ONE           63800021
WTOHEAD  DC    AL1(91)                  WTO MESSAGE LENGTH              63850021
         DC    X'00'                    FILLER                          63900021
         DC    C'IFF005I '              MESSAGE ID                      63950021
WTOUNIT  DC    C'   '                   UNIT ADDRESS                    64000021
WTOUNITL EQU   *-WTOUNIT                LENGTH OF UNIT ADDRESS          64050021
WTOUNDPL EQU   WTOHEAD-WTOUNIT          DISPLACEMENT INTO WTO WHERE     64100021
*                                            UNIT ADDRESS IS PLACED     64150021
WTOLN    EQU   *-WTOHEAD                LENGTH OF WTO HEADER            64200021
*                                                                       64250021
*                                       WORDS USED IN DUMP FORMAT       64300021
*                                                                       64350021
MSG#1    DC    C'*2250 BUFFER DUMP REQUESTED *'                         64400021
MSG#1LN  EQU   *-MSG#1                  LENGTH OF MESSAGE 1 TEXT        64450021
TXTJOBNM DC    C'JOB'                                                   64500021
TXTSTPNM DC    C'STEP'                                                  64550021
TXTTMNM  DC    C'TIME'                                                  64600021
TXTDTNM  DC    C'DATE'                                                  64650021
TXTBFAD  DC    C'BUFFER START REGENERATION ADDRESS'                     64700021
TXTDUMP  DC    C'DUMP OF'                                               64750021
TIMEMASK DC    X'2020204B20204B2020'    MASK USED IN EDIT OF TIME       64800021
DATEMASK DC    X'20204B202020'          MASK USED IN EDIT OF DATE       64850021
ASTERISK EQU   C'*'                     PRINTABLE ASTERISK CHARACTER    64900021
MSGEOD   DC    C'END OF 2250 BUFFER DUMP'         TEXT MESSAGE          64950021
SYSBFDMP DC    C'SYSBFDMP'              DUMP OUTPUT DDNAME              65000021
PATCH    DC    C'IFFCAN02 50 BYTE PATCH AREA.'                          65010000
         DS    0H                  LINEUP SO CAN USE IT ALL D11         65015000
         DC    40X'FF'                                      D11         65020000
*                        STORAGE CONSTANTS                              65050021
X1BYTE   EQU   1                                                        65100021
X2BYTES  EQU   2                        DISPLACEMENT OF TWO             65150021
X3BYTES  EQU   3                        DISPLACEMENT OF THREE BYTES     65200021
X4BYTES  EQU   4                        LENGTH OF 4 BYTES               65250021
X5BYTES  EQU   5                       DISP OF 5 BYTES                  65300021
X8BYTES  EQU   8                        DISPLACEMENT VALUE OF 8         65350021
X24BYTES EQU   24                       DISPLACEMENT VALUE OF 24        65400021
X32BYTES EQU   32                       DISPLACEMENT VALUE OF 32        65450021
X36BYTES EQU   36                       DISPLACEMENT VALUE OF 36        65500021
X3BITS   EQU   3                        MULTIPLY BY 8 (MULTIPIER)       65550021
*                                           (I.E. 3 SHIFT BITS)         65580021
X16BITS  EQU   16                      SHIFT VALUE OF HALF WORD         65610021
X24BITS  EQU   24                       SHIFT VALUE OF 24 BITS          65650021
FOUR     EQU   4                       DISPLACEMENT                     65653021
SEVEN    EQU   7                       LENGTH OF SEVEN                  65656021
TWELVE   EQU   12                      DISPLACEMENT                     65659021
THREE    EQU   3                       DISPLACEMENT                     65662021
SIXTN    EQU   16                      DISPLACEMENT                     65665021
FORTY    EQU   40                      DISPLACEMENT                     65668021
FIFTY    EQU   50                      DISPLACEMENT                     65671021
NUM52    EQU   52                                                       65674021
SIXTY    EQU   60                                                       65677021
X37BYTES EQU   37                                                       65680021
X53BYTES EQU   53                                                       65683021
X56BYTES EQU   56                                                       65686021
X91BYTES EQU   91                                                       65689021
MSG#2AD  EQU   8                        DISPLACEMENT INTO ERROR         65700021
*                                            MESSAGE TABLE FOR IFF002I  65750021
*                                            MESSAGE ADDRESS            65800021
MSG#9    EQU   20                    DISP INTO MSG TABLE     LG @ZM2360 65810000
GIOCR    EQU   33                    DISP INTO TEB           LG @ZM2360 65820000
TEB      EQU   28                    DISP INTO UCB           LG @ZM2360 65830000
DCBGIOCR EQU   49                    DISP INTO DCB           LG @ZM2360 65840000
GIOCRR1  EQU   15                    WORK REG                LG @ZM2360 65842000
PLUSSIGN DC    X'C0'                    PLUSS SIGN FOR PACKED DECIMAL   65850021
         LTORG                                                          65900021
         SPACE 2                                                        65950021
*                             OPCB HEADER VALUES                        66000021
         SPACE 2                                                        66050021
OPCBCOPY DC    X'000C'                  DECIMAL PLUS ZERO PAGE COUNT    66100021
         DC    X'0000'                  HEX ZERO LINE COUNT             66150021
         DC    X'001C'                  DECIMAL PLUS ONE PAGE ADDER     66200021
         DC    X'00'                    BSAM ERROR COUNTER              66250021
         EJECT                                                          66300021
         EJECT                                                          66350021
         WRITE DECBCOPY,SF,,,'S',,,MF=L      DECB COPY                  66400021
DECBLN   EQU   *-DECBCOPY               LENGTH OF DECB                  66450021
         EJECT                                                          66500021
DCBCOPY  DCB   DSORG=PS,MACRF=W,RECFM=MBF,LRECL=124,BLKSIZE=124,       C66550000
               DDNAME=SYSBFDMP,BFALN=F,SYNAD=GETMSG    LG YM5686,A39419 66600000
DCBLEN   EQU   *-DCBCOPY                LENGTH OF DCB                   66650021
         EJECT                                                          66700021
CKQE     DSECT         SYSTEM CANCEL KEY QUEUE ELEMENT                  66750021
         SPACE 2                                                        66800021
CKQECKQE DS    F                        POINTER TO NEXT CKQE ON         66850021
*                                            ACTIVE LIST                66900021
CKQEFLG1 DS    X                        FLAG FIELD BYTE ONE             66950021
CKFGJP   EQU   X'80'                    IS THIS CALL TO SYSTEM CANCEL   67000021
*                                            KEY ROUTINES FROM GJP      67050021
*                                            ABEND HOOK                 67100021
CKFABDMP EQU   X'40'                    A ABEND DUMP IS REQUESTED BY    67150021
*                                            THE 2250 OPERATOR          67200021
CKFATTWT EQU   X'20'                    SYSTEM CANCEL KEY ROUTINES      67250021
*                                            ARE EXPECTING AN ATTENTION 67300021
*                                            FROM DEVICE ASSOCIATED     67350021
*                                            WITH THIS CKQE             67400021
CKFCKCB  EQU   X'10'                    CANCEL KEY CONTROL BLOCK        67450021
*                                            POINTER IS VALID IN CKQE   67500021
CKFEXIT  EQU   X'08'                    EXIT IN PROCESS                 67550021
CKFECB   EQU   X'04'                    GJP ECB POINTER IS VALID IN     67600021
*                                            CKQE AND GJP IS WAITING    67650021
*                                            TO BE POSTED               67700021
CKFDEQUE EQU   X'02'                    SYSTEM CANCEL KEY ROUTINE HAS   67750021
*                                            PERFORMED ALL REQUESTS     67800021
*                                            FOR DEVICE ASSOCIATED      67850021
*                                            WITH THIS CKQE AND THE     67900021
*                                            CKQE SHOULD BE DEQUEUED    67950021
CKFBFRUN EQU   X'01'                    THE 2250 BUFFER WAS RUNNING     68000021
*                                            AT THE TIME THE SYSTEM     68050021
*                                            CANCEL KEY FUNCTION WAS    68100021
*                                            REQUESTED                  68150021
CKQEFLG2 DS    X                        SECOND BYTE OF FLAG FIELD       68200021
CKFROLBF EQU   X'80'                    GETMAIN HAS BEEN ISSUED TO      68250021
*                                            ROLL OUT THE USERS         68300021
*                                            BUFFER SECTION             68350021
CKFROLUT EQU   X'40'                    USERS BUFFER HAS BEEN ROLLED    68400021
*                                            OUT                        68450021
CKFINBUF EQU   X'20'                    GETMAIN FOR INPUT BUFFER FOR    68500021
*                                            BUFFER DUMP REQUEST HAS    68550021
*                                            BEEN ISSUED SUCCESSFULLY   68600021
CKFOPCB  EQU   X'10'                    GETMAIN FOR OUTPUT CONTROL      68650021
*                                            BLOCK HAS BEEN ISSUED      68700021
CKFOPEN  EQU   X'08'                    SYSBFDMP OUTPUT DCB IS OPEN     68750021
CKFLPATN EQU   X'04'                    THIS IS AN ENTRY SCHEDULED      68800021
*                                            BY GAR WITH A LIGHTPEN     68850021
*                                            ATTENTION.                 68900021
CKFWTCNT EQU   X'02'                    THE REQUESTOR OF A        M2878 68907021
*                                            SYSTEM CANCEL KEY    M2878 68914021
*                                            FUNCTION REQUEST     M2878 68921021
*                                            BLOCK'S WAIT COUNT   M2878 68928021
*                                            HAS BEEN INCREMENTED M2878 68935021
*                                            BY ONE               M2878 68942021
CKQEUCB  DS    H                        UNIT CONTROL BLOCK THAT IS NOW  68950021
*                                            UNDER CONTROL OF THE       69000021
*                                            SYSTEM CANCEL KEY ROUTINES 69050021
CKQECKCB DS    F                        POINTER TO CANCEL KEY CONTROL   69100021
*                                            BLOCK ASSOCIATED WITH THIS 69150021
*                                            CKQE                       69200021
CKQEDCB  DS    F                        POINTER TO THE OPEN DATA        69250021
*                                            CONTROL BLOCK FOR THE      69300021
*                                            DEVICE REQUESTING THE      69350021
*                                            SYSTEM CANCEL KEY FUNCTION 69400021
         EJECT                                                          69450021
CKCB     DSECT         SYSTEM CANCEL KEY CONTROL BLOCK                  69500021
         SPACE 2                                                        69550021
CKCBOPCB DS    F                        ADDRESS OF OUTPUT CONTROL BLOCK 69600021
*                                            ASSOCIATED WITH THIS CKCB  69650021
CKCBECB  DS    F                        ADDRESS OF GJP'S ECB TO BE      69700021
*                                            POSTED WHEN SYSTEM CANCEL  69750021
*                                            KEY FUNCTION REQUESTED BY  69800021
*                                            GJP IS COMPLETE            69850021
CKCBSVAR DS    18F                      SAVE AREA FOR IFFCAN01          69900021
CKCBBFAD DS    H                        BUFFER ADDRESS WHERE SYSTEM     69950021
*                                            CANCEL KEY 256 BYTE BUFFER 70000021
*                                            SECTION STARTS.  OPTION    70050021
*                                            PANEL WILL BE PLACED INTO  70100021
*                                            THIS SECTION               70150021
CKCBBFLG DS    H                        BUFFER LENGTH OF THE DATA       70200021
*                                            WRITTEN TO THE 2250 FOR    70250021
*                                            THE OPTIONS PANEL          70300021
CKCBWRKA DS    CL64                    WORK AREA FOR:                   70350021
*                                            READ MI INPUT              70400021
*                                            READ SENSE INPUT           70450021
*                                            BUFFER INQUIRY TABLE       70500021
*                                            WRITE TO OPERATOR MESSAGES 70550021
CKCBDECB DS    8F                       DATA EVENT CONTROL BLOCK        70600021
*                                            USED IN I/O OPERATIONS     70650021
*                                            TO THE 2250                70700021
CKCBREST DS    F                        ADDRESS OF 2250 RESTART         70750021
*                                            GNERATION OF THE USERS     70800021
*                                            BUFFER PROGRAM             70850021
CKCBROLL DS    F                        ADDRESS OF 256 BYTE AREA USED   70900021
*                                            TO ROLL OUT USERS BUFFER   70950021
*                                            IF NO OTHER BUFFER SPACE   71000021
*                                            AVAILABLE FOR THE DEVICE   71050021
CKCBERMT DS    F                        POINTER TO TABLE OF ERROR       71100021
*                                            MESSAGES TO BE SENT TO     71150021
*                                            THE SYSTEM OPERATOR UPON   71200021
*                                            ERROR CONDITION.           71250021
*                                                                       71300021
CKDCBSTR DS    F                       SAVE AREA - DCB BUFFER LI  M6619 71305021
*                                      START ADDRESS          LI A39419 71310021
CKCBWORK DS    F                       LENGTH FOR E GETMAIN   LI A39419 71315021
         DS    F                       ADDR OF ADDR LIST      LI A39419 71320021
         DS    C                       EC MODE                LI A39419 71325021
         DS    C                       SP VALUE               LI A39419 71330021
CKCBBFDP DS    H                       STORAGE FOR SENSE DATA LI A34790 71335021
*                                      FROM UCB ON LP ATTN    LI A34790 71340021
         EJECT                                                          71350021
UCB      DSECT         UNIT CONTROL BLOCK                               71400021
         DS    0F                                                       71450021
         SPACE 2                                                        71500021
UCBIJI   DS    X                        INTERNAL JOB IDENTIFICATION     71550021
UCBACM   DS    X                        ALLOCATION CHANNEL MASK         71600021
UCBID    DS    X                        UCB IDENTIFICATION - HEX FF     71650021
UCBSTBYA DS    X                        STATUS BYTE A                   71700021
UCBCHA   DS    X                        CHANNEL ADDRESS                 71750021
UCBUA    DS    X                        UNIT ADDRESS                    71800021
UCBFL1   DS    X                        FLAG BYTE 1                     71850021
UCBDTI   DS    X                        INDEX TO DEVICE TABLE           71900021
UCBETI   DS    X                        ERROR ROUTINE KEY               71950021
UCBSTI   DS    X                        STATISTICS TABLE INDEX          72000021
UCBLCI   DS    X                        CHANNEL TABEL INDEX             72050021
UCBATI   DS    X                        ATTENTION TABLE INDEX           72100021
UCBWGT   DS    X                        FLAGS AND CHANNEL MASK          72150021
UCBNAME  DS    3X                       UNIT NAME IN EBCDIC             72200021
UCBTYP   DS    F                        DEVICE TYPE                     72250021
MODEL1   EQU   X'31'                    MODEL 1 2250 TYPE CODE          72300021
UCBLTR   DS    H                        LAST REQUEST ELEMENT            72350021
UCBSNS   DS    2H                       SENSE INFORMATION               72400021
UCBUCNT  DS    X                        USE COUNT                       72450021
UCBGCB   DS    X                        GRAPHIC CONTROL BYTE            72500021
UCBTEB   DS    F                        TASK ENTRY BLOCK ADDRESS        72550021
UCBREST  DS    F                        RESTART ADDRESS                 72600021
UCBDEVI  DS    X                        DEVICE INDEX FOR BUFFER TABLE   72650021
UCBBFTAB DS    3X                       BUFFER TABLE ADDRESS            72700021
         EJECT                     BUFFER TABLE                         72750021
BUFTABLE DSECT                                                          72800021
         DS    0F                                                       72850021
         SPACE 2                                                        72900021
BFTLN    DS    H                        TOTAL LENGTH OF BUFFER TABLE    72950021
BFTNMDEV DS    H                        TOTAL NUMBER OF DEVICES         73000021
BFTEXBUF DS    H                        EXPRESS BUFFER SIZE             73050021
BFTTOTAV DS    H                        TOTAL AVAILABLE SECTIONS        73100021
         EJECT                                                          73150021
OPCB     DSECT         OUTPUT CONTROL BLOCK                             73200021
         SPACE 2                                                        73250021
         DS    0F                                                       73300021
OPCBLNI  DS    X                        INDEX OF LINE IN USE            73350021
OPCBCRLN DS    3X                       ADDRESS OF LINE NOW IN USE      73400021
OPCBLN1I DS    X                        INDEX OF LINE ONE (I.E.         73450021
*                                            DISPLACEMENT TO NEXT       73500021
*                                            LINE TO BE USED)           73550021
OPCBLN1  DS    3X                       ADDRESS OF LINE ONE             73600021
OPCBLN2I DS    X                        INDEX OF LINE TWO               73650021
OPCBLN2  DS    3X                       ADDRESS OF LINE TWO             73700021
OPCBLN3I DS    X                        INDEX OF LINE THREE             73750021
OPCBLN3  DS    3X                       ADDRESS OF LINE THREE           73800021
OPCBPCNT DS    H                        PAGE COUNT OF OUTPUT IN DECIMAL 73850021
OPCBLCNT DS    H                        LINE COUNT OF CURRENT PAGE      73900021
*                                            IN HEX                     73950021
OPCBDEC1 DS    H                        HALF WORD OF A DECIMAL ONE      74000021
OPCBERRF DS    X                        BSAM ERROR FLAG FIELD COUNTER   74050021
OPCBHEAD EQU   *-OPCBPCNT               LENGTH OF OPCB HEADER           74100021
OPCBSVAR DS    18F                      SAVE AREA FOR IFFCAN02          74150021
OPCBL1   DS    CL124                   LINE ONE BUFFER AREA             74200021
OPCBL2   DS    CL124                   LINE TWO BUFFER AREA             74250021
OPCBL3   DS    CL124                   LINE THREE BUFFER AREA           74300021
         DS    0F                                                       74350021
OPCBECB  DS    F                       O/P ECB                          74400021
         ORG   OPCBECB                                                  74450021
OPCBDECB DS    CL20                    O/P DECB                         74500021
         DS    0F                                                       74550021
OPCBDCB  DS    F                        ADDRESS OF DCB ASSOCIATED WITH  74600021
*                                            SYSBFDMP DD CARD (I.E.     74650021
*                                            BSAM OUTPUT)               74700021
OPCBINBF DS    F                        ADDRESS OF 256 BYTE INPUT AREA  74750021
*                                            FOR BUFFER SECTIONS TO     74800021
*                                            BE READ INTO.              74850021
OPCBERSV DS    3F                      SAVE AREA FOR BSAM ERROR RTN     74900021
OPCBLEN  EQU   *-OPCB                   LENGTH OF OPCB                  74950021
         EJECT                                                          75000021
*                             INPUT BUFFER                              75050021
INPUTBUF DSECT                                                          75100021
         DC    CL256' '                 ONE BASIC BUFFER SECTION        75150021
INBUFLN  EQU   *-INPUTBUF               LENGTH OF BUFFER IN BYTES       75200021
*                                            INPUT BUFFER AREA          75250021
         EJECT                                                          75300021
SAVEAREA DSECT         SAVE AREA                                        75350021
         SPACE 2                                                        75400021
WD1      DS    F                        FIRST WORD                      75450021
HSA      DS    F                        HEAD SAVE AREA POINTER          75500021
LSA      DS    F                        LAST SAVE AREA POINTER          75550021
RET      DS    F                        RETURN ADDRESS                  75600021
EPA      DS    F                        ENTRY POINT ADDRESS             75650021
R0       DS    F                        REGISTER 0  CONTENTS            75700021
R1       DS    F                        REGISTER 1  CONTENTS            75750021
R2       DS    F                        REGISTER 2  CONTENTS            75800021
R3       DS    F                        REGISTER 3  CONTENTS            75850021
R4       DS    F                        REGISTER 4  CONTENTS            75900021
R5       DS    F                        REGISTER 5  CONTENTS            75950021
R6       DS    F                        REGISTER 6  CONTENTS            76000021
R7       DS    F                        REGISTER 7  CONTENTS            76050021
R8       DS    F                        REGISTER 8  CONTENTS            76100021
R9       DS    F                        REGISTER 9  CONTENTS            76150021
R10      DS    F                        REGISTER 10 CONTENTS            76200021
R11      DS    F                        REGISTER 11 CONTENTS            76250021
R12      DS    F                        REGISTER 12 CONTENTS            76300021
         EJECT                                                          76350021
TIOT     DSECT         TASK INPUT / OUTPUT TABLE                        76400021
         SPACE 2                                                        76450021
TIOTNJOB DS    D                        JOB NAME                        76500021
TIOTSTP  DS    D                        JOB STEP OR PROCEDURE STEP NAME 76550021
TIOTPRC  DS    D                        PROCEDURE JOB STEP NAME         76600021
TIOTHEAD EQU   *-TIOT                   LENGTH OF TIOT HEADER           76650021
         SPACE 2                                                        76700021
TIOTDDEN DSECT                          DD ENTRY IN TIOT                76750021
         SPACE 2                                                        76800021
TIOELNGH DS    X                        LENGTH OF DD ENTRY              76850021
TIOESTTA DS    X                        STATUS BYTE A                   76900021
TIOENTCT DS    X                        NUMBER OF DEVICES REQUESTED     76950021
TIEOLINK DS    X                        ALLOCATION: LINE-CLOSE: FLAG    77000021
TIOEDDNM DS    CL8                      DD NAME                         77050021
TIOEJFCB DS    3X                       RELATIVE ADDRESS OF JFCB        77100021
TIOESTIC DS    X                        STATUS BYTE C                   77150021
TIOESTIB DS    X                        STATUS BYTE B                   77200021
TIOEFSRT DS    3X                       UNIT CONTROL BLOCK ADDRESS      77250021
         EJECT                                                          77300021
TCB      DSECT         TASK CONTROL BLOCK                               77350021
         SPACE 2                                                        77400021
TCBRBP   DS    F                        PROGRAM BLOCK POINTER           77450021
TCBDIE   DS    F                        PROGRAM INTERRUPT ELEMENT       77500021
TCBDEB   DS    F                        DATA EVENT BLOCK QUEUE          77550021
TCBTIO   DS    F                        TASK I/O TABLE                  77600021
         ORG   TCB+124                                                  77650021
TCBJSTCB DS    F                        ADDRESS OF JOB STEP TCB (MVT)   77700021
         EJECT                                                          77750021
DEB      DSECT         DATA EVENT BLOCK                                 77800021
         DS    0F                                                       77850021
         SPACE 2                                                        77900021
DEBNMSUB DS    X                        NUMBER OF SUBROUTINES           77950021
DEBTCBAD DS    3X                       TASK CONTROL BLOCK ADDRESS      78000021
DEBAMLNG DS    X                        LENGTH OF ACCESS METHOD SECTION 78050021
DEBDEBAD DS    CL3                      NEXT DEB ON DEB QUEUE           78100021
         ORG   DEB+16                                                   78150021
DEBNMEXT DS    X                        NUMBER OF EXTENTS               78200021
         ORG   DEB+25                                                   78250021
DEBDCBAD DS    3X                       DATA CONTROL BLOCK ADDRESS      78300021
         ORG   DEB+33                                                   78350021
DEBUCBAD DS    3X                       UNIT CONTROL BLOCK ADDRESS      78400021
         EJECT                                                          78450021
DCB      DSECT                                                          78500021
         DS    0F                                                       78550021
         SPACE 2                                                        78600021
         ORG   DCB+17                                                   78650021
DCBDEVT  DS    X                       DEVICE TYPE                      78700021
DCBDTAPE EQU   X'80'                   TAPE                             78750021
DCBDDA   EQU   X'20'                   DIRECT ACCESS                    78800021
DCBDTDA  EQU   DCBDTAPE+DCBDDA         TAPE OR DA                       78850021
         ORG   DCB+40                                                   78900021
DCBTIOT  DS    H                        OFFSET OF DD ENTRY IN TIOT      78950021
         ORG   DCB+45                                                   79000021
DCBDEBAD DS    3X                       DATA EVENT BLOCK ADDRESS        79050021
         ORG   DCB+48                                                   79100021
DCBOFLGS DS    X                        OPEN FLAGS                      79150021
OPEN     EQU   X'10'                    SUCCESSFUL OPEN FOR THIS DCB    79200021
         EJECT                                                          79250021
*                        DATA EVENT CONTROL BLOCK (GRAPHIC)             79300021
DECB     DSECT                                                          79350021
         SPACE 2                                                        79400021
DECBECB  DS    F                        EVENT CONTROL BLOCK             79450021
DECBTYPE DS    F                        TYPE OF I/O FIELD               79500021
DECBDCB  DS    F                        DATA CONTROL BLOCK ADDRESS      79550021
DECBAREA DS    F                        I/O BUFFER AREA ADDRESS         79600021
DECBHXCD DS    X                        HEX CODE ON I/O COMPLETNESS     79650021
DECBCNT  DS    3X                       CHANNEL STATUS WORD COUNT       79700021
DECBSTA  DS    X                        STATUS BIT A                    79750021
DECBLNGH DS    3X                       LENGTH OF I/O DATA IN BYTES     79800021
DECBSTB  DS    X                        STATUS BIT B                    79850021
DECBSTAD DS    3X                       ADDRESS OF START REGENERATION   79900021
*                                           ADDRESS                     79950021
DECBUNIX DS    X                        UNIT INDEX                      80000021
DECBBFAD DS    3X                       ADDRESS OF DATA TRANSFER TO OR  80050021
*                                            FROM BUFFER ADDRESS        80100021
         EJECT                                                          80150021
SYSCVTPT EQU   16                       STORAGE LOCATION OF CVT ADDRESS 80200021
         SPACE 2                                                        80250021
CVT      DSECT        COMMUNICATION VECTOR TABLE                        80300021
         DS    0F                                                       80350021
         SPACE 2                                                        80400021
CVTTCBP  DS    F                        ADDRESS OF NEXT AND CURRENT     80450021
*                                            TCB POINTERS               80500021
         ORG   CVT+116                                                  80550021
CVTDCB   DS    X                        SYSTEM CONFIGURATION            80600021
MVTSYS   EQU   X'10'                    SYSTEM IS MVT                   80650021
CURRTCB  EQU   4                        DISPLACEMENT TO CURRENT TCB     80700021
*                                            POINTER IN NEW OLD TCB     80750021
*                                            WORDS                      80800021
         EJECT                                                          80850021
LINE     DSECT         OUTPUT LINE FORMAT                               80900021
         SPACE 2                                                        80950021
LNCNTCD  DS    X                        CONTROL CODE FOR PRINTER        81000021
*                                       MESSAGE NUMBER ONE FORMAT       81050021
         DS    2X                                                       81100021
LNJOBNM  DC    C'JOB'                                                   81150021
         DS    X                                                        81200021
LNJOBNAM DC    CL8' '                   JOBNAME                         81250021
         DS    3X                                                       81300021
LNSTPNM  DC    C'STEP'                                                  81350021
         DS    X                                                        81400021
LNSTPNAM DC    CL8' '                   STEPNAME                        81450021
         DS    3X                                                       81500021
LNTMNM   DC    C'TIME'                                                  81550021
LNTIME   DC    CL9' '                   TIME OF DAY                     81600021
         DS    3X                                                       81650021
LNDTNM   DC    C'DATE'                                                  81700021
         DS    X                                                        81750021
LNDATE   DC    CL6' '                   DATE                            81800021
         DS    2X                                                       81850021
LINEWORK DC    F'0'                     WORK AREA                       81900021
         SPACE 2                                                        81950021
*                                       MESSAGE NUMBER TWO FORMAT       82000021
         SPACE 2                                                        82050021
         ORG   LINE+3                                                   82100021
LNDPMSG  DC    C'DUMP OF'                                               82150021
         DS    X                                                        82200021
LNDVAD   DC    C'XXX'                   UNIT ADDRESS                    82250021
         SPACE 2                                                        82300021
*                                       MESSAGE NUMBER THREE FORMAT     82350021
         SPACE 2                                                        82400021
         ORG   LINE+3                                                   82450021
LNBFNM   DC    C'BUFFER START REGENERATION ADDRESS'                     82500021
         DS    X                                                        82550021
LNSTRGAD DC    4C' '                    BUFFER RESTART ADDRESS          82600021
BUFADDLN EQU   *-LNSTRGAD               LENGTH OF BUFFER ADDRESS        82650021
*                                            IN BYTES                   82700021
         SPACE 2                                                        82750021
*                                       MESSACE NUMBER FOUR FORMAT      82800021
         SPACE 2                                                        82850021
         ORG   LINE+1                                                   82900021
LINEBFAD DC    4C' '                    BUFFER ADDRESS                  82950021
         ORG   LINE+86                                                  83000021
LINEFATK DC    C'*'                     FRONT ASTERISK ARROUND          83050021
LININTA  DC    CL32' '                  INTERPERTED BUFFER              83100021
LINTLNG  EQU   *-LININTA                LENGTH OF INTERPERT BUFFER      83150021
LINEBATK DS    C'*'                     FOLLOWING ASTERISK              83200021
         SPACE 2                                                        83250021
*                                       MESSAGE LINE                    83300021
         SPACE 2                                                        83350021
         ORG   LINE+1                                                   83400021
LINETEXT DC    CL123' '                LINE SIZE                        83450021
LINELNG  EQU   *-LINETEXT               LENGTH OF OUTPUT LINE TEXT      83500021
         SPACE 2                                                        83550021
*                                  PAGE COUNT                           83600021
         SPACE 2                                                        83650021
         ORG   LINE+113                                                 83700021
LNPAGNM  DC    C'PAGE    '                                              83750021
         ORG   LNPAGNM+4                                                83800021
LNPAGNO  DC    C'    '                  PAGE COUNT                      83850021
         SPACE 2                                                        83900021
*                             LAST LINE ('END OD DUMP')                 83950021
         SPACE 2                                                        84000021
         ORG   LINE+1                                                   84050021
LNEOD    DC    C'END OF 2250 BUFFER DUMP'                               84100021
         EJECT                                                          84150021
WTOMSG   DSECT                WRITE TO OPERATOR ERROR MESSAGE           84200021
         SPACE 2                                                        84250021
WTOLNG   DS    X                        LENGTH OF MESSAGE               84300021
         DS    X                                                        84350021
WTOID    DC    C'IFF000I'               MESSAGE ID                      84400021
         DS    X                                                        84450021
WTOUNTAD DC    C'XXX'                   UNIT ADDRESS                    84500021
         DS    X                                                        84550021
WTOTEXT  DC    64C' '                   MESSAGE TEXT                    84600021
         END                                                            84650021
