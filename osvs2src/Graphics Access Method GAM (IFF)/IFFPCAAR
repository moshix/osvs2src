         TITLE 'GARC-CIRCULAR ARC GENERATION ROUTINE(ROUTINE)'          00020021
*STATUS. CHANGE LEVEL 0                                               * 00040021
*                                                                     * 00060021
*FUNCTION/OPERATION. GARC GENERATES THE GRAPHIC ORDERS AND DATA TO    * 00080021
*   DISPLAY A SERIES OF POINTS THAT APPROXIMATE A CIRCLE OR ARC ON    * 00100021
*   THE DISPLAY UNIT SCREEN AND STORES THEM IN THE GRAPHIC DATA OUTPUT* 00120021
*   AREA-(GDOA)                                                       * 00140021
*                                                                     * 00160021
*ENTRY POINTS.GARC VIA CALL OR LINK MACRO  ALIAS NAME IFFPCAAR        * 00180021
*                                                                     * 00200021
*INPUT.OUTPUT CONTROL BLOCK POINTER(OCBP) AND A PARAMETER TABLE       * 00220021
*   WHICH CONTAINS PARAMETERS REQUIRED BY GARC                        * 00240021
*                                                                     * 00260021
*OUTPUT.A GRAPHIC ORDER GEPM TO CAUSE DISPLAY UNIT ENTERING POINT     * 00280021
*   PLOTTING MODE AND A SERIES OF DATA BYTES WHICH CONTAIN THE X,Y    * 00300021
*   COORDIATES OF THE CIRCLE OR ARC. THE OUTPUT ARE STORED IN GDOA    * 00320021
*                                                                     * 00340021
*EXTERNAL ROUTINES. N/A                                               * 00360021
*                                                                     * 00380021
*EXITS-NORMAL.COMPLETION OF TASK EXIT VIA RETURN MACRO                * 00400021
*     -ERROR.HEXADECIMAL 4,12,16,20,24,28,AND 32(WHEN OFF-SCREEN ONLY)* 00420021
*   IN REG 15 RETURN IMMEDIATELY. EXIT VIA RETURN MACRO               * 00440021
*     -ERROR.HEXADECIMAL 32(WHEN NOT OFF-SCREEN),40,44,48 IN REG 15   * 00460021
*   DO NOT RETURN IMMEDIATELY. UPON COMPLETION OF TASK,RETURN VIA     * 00480021
*   RETURN MACRO                                                      * 00500021
*                                                                     * 00520021
*TABLES/WORK AREAS. USER SPECIFIED PARAMETER TABLE,XYLIM TABLE AND    * 00540021
*   WORK AREA                                                         * 00560021
*                                                                     * 00580021
*ATTRIBUTES.READ ONLY,REENTRANT                                       * 00600021
*                                                                     * 00620021
IFFPCAAR CSECT                                                          00640021
*0669                                                              7468 00650021
         ENTRY GARC                                                     00660021
GARC     SAVE  (14,12),T,*              SAVE REGISTERS                  00680021
         BALR  9,0                                                      00700021
         USING *,9                                                      00720021
         SR    NPAREG,NPAREG            INIT  NO.OF POINTS ATTEMPTED    00740021
*                                                                       00760021
*   INITIALIZATION                                                      00780021
*                                                                       00800021
MAINRT   L     WRKREG,0(0,1)            GET OCBP ADDRESS                00820021
         L     PATREG,4(0,1)            GET PARTAB ADDRESS              00840021
         USING PARTAB,PATREG                                            00860021
         L     WKAREG,4(0,WRKREG)       GET WORKAREA ADDRESS            00880021
         USING WKAREA,WKAREG                                            00900021
         L     OABREG,0(WRKREG)         GET OACB ADDRESS                00920021
         ST    OABREG,WOACB                                             00940021
         L     XYLREG,XYLIM             LOAD XYLIM ADDR INTO XYLREG     00960021
         USING XYLIMTB,XYLREG                                           00980021
*  SAVE MASK BITS AS SET BY USER                                        01000021
         ST    9,MASKSV                                                 01020021
         SR    WRKREG,WRKREG                                            01040021
         SPM   WRKREG                                                   01060021
         MVC   WUC,UC                   SAVE UC VC FOR WORKING          01080021
         MVC   WVC,VC                                                   01100021
         MVC   WR,RU                    SAVE RADIUS FOR WORKING         01120021
         MVC   WALPHA,ALPHA             SAVE ALPHA FOR WORKING          01140021
         SR    15,15                    CLEAR ERROR CODE REGISTER       01160021
         ST    15,ERRCOUNT              CLEAR ERROR COUNT               01180021
         BAL   LINREG,XYLCHK                                            01200021
*                                                                       01220021
*   TEST OFF S/G OPTION SPECIFIED AND DECIDE BOUNDARY TO BE OBSERVED    01240021
*                                                                       01260021
TESTSG   CLI   SG,C'A'                  IS OPTION A SPECIFIED           01280021
         BE    MVGRDLIM                 IF YES USE GRID LIMITS          01300021
         CLI   SG,C'B'                  IS OPTION B SPECIFIED           01320021
         BE    MVSCRLIM                 IF YES USE SCREEN LIMITS        01340021
         CLI   SG,C'C'                  IS C OPTION SPECIFIED           01360021
         BE    MVGRDLIM                 IF YES USE GRID LIMITS          01380021
         CLI   SG,C'D'                  IS D OPTION SPECIFIED           01400021
         BE    MVGRDLIM                 IF YES USE GRID LIMITS          01420021
         CLI   SG,C'E'                  IS E OPTION SPECIFIED           01440021
         BE    MVSCRLIM                 IF YES USE SCREEN LIMITS        01460021
         BAL   LINREG,ERR40             OTHERWISE INPUT ERROR ASSUME E  01480021
MVSCRLIM LA    WRKREG,SCRCHK            GET SCREEN CHECK RT ADDR        01500021
         ST    WRKREG,WRTADDR           STORE THE ROUTINE ADDR USED     01520021
         B     TESTF                                                    01540021
MVGRDLIM LA    WRKREG,GRDCK             LOAD GRID CHECK RT ADDR         01560021
         ST    WRKREG,WRTADDR           STORE THE ROUTINE ADDR USED     01580021
*                                                                       01600021
*   TEST IF FLOATING AND/OR SCALING INPUT USED                          01620021
*                                                                       01640021
TESTF    CLI   F,C'F'                   TEST FOR FLOAT                  01660021
         BE    FLTRT                                                    01680021
         CLI   F,C'B'                   TEST FOR FIX                    01700021
         BE    TESTSC                                                   01720021
         BAL   LINREG,ERR40                                             01740021
TESTSC   CLI   S,C'S'                   TEST FOR SCALING                01760021
         BE    SCALFIX                                                  01780021
         CLI   S,C'N'                   TEST FOR NO SCALING             01800021
         BE    TESTIN                                                   01820021
         BAL   LINREG,ERR40                                             01840021
         B     TESTIN                                                   01860021
FLTRT    CLI   S,C'S'                   TEST FOR SCALING                01880021
         BE    SCALFLT                                                  01900021
         CLI   S,C'N'                   TEST FOR NO SCALING             01920021
         BE    FCONVERT                                                 01940021
         BAL   LINREG,ERR40                                             01960021
         B     FCONVERT                                                 01980021
*                                                                       02000021
*   TEST INPUT PARAMETERS                                               02020021
*                                                                       02040021
TESTIN   SR    NPAREG,NPAREG            INITIATE PT COUNT               02060021
         C     NPAREG,WR                COMPARE RADIUS TO ZERO          02080021
         BNL   ERR20RET       IF NEGATIVE OR ZERO SET ERROR CODE        02100021
         CH    NPAREG,THETA             COMPARE ZERO TO THETA           02120021
         BH    ERR20RET                                                 02140021
         CH    NPAREG,GAMMA                                             02160021
         BH    ERR20RET                                                 02180021
         CLI   INC,C'D'                 TEST IF INC=D                   02200021
         BE    TESTD                     IF SO TEST DENSITY FIELD       02220021
         CLI   INC,C'A'                 TEST IF INC=A                   02240021
         BE    TESTA                     IF SO TEST ALPHA FIELD         02260021
         B     ERR20RET                                                 02280021
*   MAIN ROUTINE                                                        02300021
*                                                                       02320021
TESTD    CH    NPAREG,DENSITY           COMPARE ZERO TO DENSITY         02340021
         BH    ERR20RET                 IF NEGTIVE GO TO SET ERRORCODE  02360021
         L     WRKREG,FOUR                                              02380021
         CH    WRKREG,DENSITY           COMPARE FOUR TO DENSITY         02400021
         BH    COMALP                   GO TO COMPUTE ALPHA AS D IS 0-3 02420021
CONVRD   L     MPCREG,C360              CONVERT DENSITY TO ALPHA        02440021
         MH    MPCREG,DENSITY           DENSITY*360                     02460021
         SRDA  MPCREG,32                                                02480021
         SLDA  MPCREG,28                                                02500021
         D     MPCREG,TWOPI                                             02520021
         SR    MPCREG,MPCREG                                            02540021
         D     MPCREG,WR                DIVIDED BY RADIUS               02560021
         SLA   MPCREG,1                 SHIFT TO DOUBLE THE REMAINDER   02580021
         C     MPCREG,WR                                                02600021
         BL    CHECK                    NO ROUNDING IF 2*REMAINDER LT R 02620021
        A     PRDREG,ONE                ROUND BY ADD ONE TO QUOTIENT    02640021
CHECK    C     PRDREG,ZERO              CHECK VALIDITY OF RESULT        02660021
         BL    ERR20RET                                                 02680021
         BE    SETALP                                                   02700021
         STH   PRDREG,WALPHA            SAVE COMPUTED ALPHA             02720021
         B     ALPRECK                                                  02740021
TESTA    CH    NPAREG,ALPHA             COMPARE ALPHA TO ZERO           02760021
         BH    ERR20RET                 IF NEGTIVE GO TO SET ERRORCODE  02780021
         BNE   ALPRECK                                                  02800021
COMALP   LA    DVDREG,345                IF YES COMPUTE ALPHA           02820021
         C     DVDREG,WR                                                02840021
         BL    SETALP                    OTHERWISE                      02860021
         SRDA  DVDREG,32(0)                                             02880021
         D     DVDREG,WR                                                02900021
         STH   QUOREG,WALPHA            SAVE COMPUTED ALPHA             02920021
ALPRECK  LH    WRKREG,WALPHA            GET ALPHA                       02940021
         C     WRKREG,C360              COMPARE ALPHA TO 360            02960021
         BH    ERR20RET                 IF OVER 360 GO TO SET ERRCODE   02980021
         B     STOEPM                                                   03000021
SETALP   L     WRKREG,ONE               SET ALPHA TO ONE                03020021
         STH   WRKREG,WALPHA            STORE ALPHA                     03040021
STOEPM   STM   2,12,PORSAVE             STORE REGISTERS                 03060021
         MVC   GOMODE,EPM                                               03080021
         LA    CNTREG,2                 PASSING BYTE NUMBER             03100021
         LA    ADDREG,EPM               LOAD GEPM ADDRESS               03120021
         L     OABREG,WOACB             GET OACB ADDR SAVED             03140021
         BAL   LINREG,STORE                                             03160021
         LM    2,12,PORSAVE             RESTORE REGISTERS               03180021
TESTGM   LH    DVDREG,GAMMA             SEE IF GAMMA ZERO               03200021
         CH    DVDREG,ZERO               IF YES                         03220021
         BE    ONEPT                      THIS IS ONE POINT PLOTTING    03240021
         SRDA  DVDREG,32(0)                                             03260021
         D     DVDREG,C360                COMPUTE GAMMA(MOD 360)        03280021
         C     DVDREG,ZERO              CHECK IF GAMMA(MOD 360) ZERO    03300021
         BNE   ARCRT                     IF NOT IT IS AN ARC            03320021
         L     GMREG,C360                IF YES SET GAMMI=360 (CIRCLE)  03340021
         B     PROCEED                                                  03360021
ONEPT    SR    GMREG,GMREG              GAMMI=0 IF ONE POINT            03380021
         B     PROCEED                                                  03400021
ARCRT    LR    GMREG,DVDREG             GAMMI=GAMMA(MOD 360)            03420021
PROCEED  LH    DVDREG,THETA             GET THETA                       03440021
         SRDA  DVDREG,32(0)                                             03460021
         D     DVDREG,C360              COMPUTE THET=THETA(MOD 360)     03480021
         AR    GMREG,DVDREG              GAMM=GAMMI+THET                03500021
         STH   GMREG,WGAMMA                                             03520021
         STH   DVDREG,WTHETA            SAVE INITIAL THETA              03540021
         STH   DVDREG,WDELTA            SAVE INITIAL THETA AS DELTA     03560021
DTENTRY  SRDA  DVDREG,32                                                03580021
         D     DVDREG,C90               COMPUTE THET(MOD 90)            03600021
         SLA   QUOREG,1                                                 03620021
         C     DVDREG,ZERO               IS THET=K TIMES 90             03640021
         BNE   COMPXYI                   IF NOT GO TO COMPUTE XYI       03660021
         C     QUOREG,ZERO               IF YES ASSIGN XI YI VALUES     03680021
         BNE   TESTG2                     DEPENDING ON QUADRANT         03700021
         MVC   WXI,WR                   FOR ZERO DEGREE                 03720021
         MVC   WYI,ZERO                 XI=R,YI=0                       03740021
         B     FDENTRY                  GO TO FORM DATA                 03760021
TESTG2   C     QUOREG,TWO                                               03780021
         BNE   TESTH2                                                   03800021
         MVC   WXI,ZERO                 FOR 90 DEGREE                   03820021
         MVC   WYI,WR                    XI= 0,YI=R                     03840021
         B     FDENTRY                                                  03860021
TESTH2   C     QUOREG,FOUR                                              03880021
         BNE   SETXYI                                                   03900021
         L     WRKREG,WR                FOR 180 DEGREE                  03920021
         LNR   XREG,WRKREG               XI=-R  YI=0                    03940021
         ST    XREG,WXI                 SAVE COMPUTED XI                03960021
         MVC   WYI,ZERO                  SET YI=0                       03980021
         B     FDENTRY                                                  04000021
SETXYI   MVC   WXI,ZERO                 FOR 270 DEGREE                  04020021
         L     WRKREG,WR                 XI=0 YI=-R                     04040021
         LNR   YREG,WRKREG                                              04060021
         ST    YREG,WYI                                                 04080021
         B     FDENTRY                                                  04100021
COMPXYI  C     QUOREG,ZERO              CHECK IF THET IN 1ST OR 3RD Q   04120021
         BC    8,NORMAL                  IF YES GO TO NORMAL ROUTINE    04140021
         C     QUOREG,FOUR                                              04160021
         BC    8,NORMAL                                                 04180021
         L     WRKREG,C90                                               04200021
         SR    WRKREG,DVDREG                                            04220021
         LR    DVDREG,WRKREG                                            04240021
         STH   DVDREG,WTHETA                                            04260021
NORMAL   C     DVDREG,C45               COMPARE THET TO 45              04280021
         BH    OVER45                                                   04300021
         LR    WRKREG,DVDREG            LOAD THET TO WK REG             04320021
         MH    WRKREG,PLUS4                                             04340021
         LH    XREG,TABLE+2(WRKREG)       GET COS(THET)                 04360021
         SRDA  XREG,32                                                  04380021
         M     XREG,WR                  XI=R*COS(THET)                  04400021
         A     PRDREG,C8192            ROUND TO THE NEAREST INTEGER     04420021
         SRA   PRDREG,14                                                04440021
         MH    PRDREG,CSIGN(QUOREG)                                     04460021
         ST    PRDREG,WXI               SAVE XI                         04480021
         L     YREG,TABLE(WRKREG)                                       04500021
         SRDA  YREG,48                                                  04520021
         M     YREG,WR                  YI=R*SIN(THET)                  04540021
         A     PRDREG,C8192            ROUND TO THE NEAREST INTEGER     04560021
         SRA   PRDREG,14                                                04580021
         MH    PRDREG,SSIGN(QUOREG)                                     04600021
         ST    PRDREG,WYI               SAVE YI                         04620021
         B     FDENTRY                  GO TO FORM XY DATA              04640021
OVER45   LR    WRKREG,DVDREG            ROUTINE FOR THET OVER 45        04660021
         MH    WRKREG,MINUS4                                            04680021
         L     XREG,TABLE+360(WRKREG)                                   04700021
         SRDA  XREG,48                                                  04720021
         M     XREG,WR                  XI=R*COS(THET)                  04740021
         A     PRDREG,C8192            ROUND TO THE NEAREST INTEGER     04760021
         SRA   PRDREG,14                                                04780021
         MH    PRDREG,CSIGN(QUOREG)                                     04800021
         ST    PRDREG,WXI               SAVE XI                         04820021
         LH    YREG,TABLE+362(WRKREG)                                   04840021
         SRDA  YREG,32                                                  04860021
         M     YREG,WR                                                  04880021
         A     PRDREG,C8192            ROUND TO THE NEAREST INTEGER     04900021
         SRA   PRDREG,14                                                04920021
         MH    PRDREG,SSIGN(QUOREG)                                     04940021
         ST    PRDREG,WYI               SAVE YI                         04960021
FDENTRY  A     NPAREG,ONE                                               04980021
         L     WRKREG,WXI               COMPUTE X=XI&XC                 05000021
         A     WRKREG,WUC                                               05020021
SAVEX    ST    WRKREG,COMPUX            SAVE COMPUTED X                 05040021
         STH   WRKREG,BUILDXY           SAVE SIGNIFICANT PORTION OF X   05060021
         L     WRKREG,WYI               COMPUTE Y=YI&YC                 05080021
         A     WRKREG,WVC                                               05100021
         ST    WRKREG,COMPUY            SAVE COMPUTED Y                 05120021
         STH   WRKREG,BUILDXY+2         SAVE SIGNIFICANT PART OF Y      05140021
         L     WRKREG,WRTADDR           GET BOUNDARY CHCK RT            05160021
         BALR  LINREG,WRKREG            BRANCH TO CHECK                 05180021
         CLI   OFFSW,X'11'              IS THIS PT OFF BOUNDARY         05200021
         BE    ILLEGAL                  IF SO GO TO ILLEGAL HANDLING    05220021
         STM   2,12,PORSAVE                                             05240021
         LA    CNTREG,4                 LOAD BYTE NUMBER                05260021
         LA    ADDREG,BUILDXY                                           05280021
         L     OABREG,WOACB                                             05300021
         BAL   LINREG,STORE             BRANCH AND LINK TO STORE RT     05320021
         LM    2,12,PORSAVE                                             05340021
CKENTRY  LH    DELREG,WDELTA            GET DELTA                       05360021
         CH    DELREG,WGAMMA            COMPARE DELTA TO GAMM           05380021
         BE    RET                       IF EQUAL JOB IS COMPLETED      05400021
         AH    DELREG,WALPHA            ADD ALPHA                       05420021
         STH   DELREG,WDELTA            STORE DELTA                     05440021
         CH    DELREG,WGAMMA            COMPARE DELTA TO GAMM           05460021
         BC    12,NEWTHET                IF LE COMPUTE NEW THET         05480021
         MVC   WDELTA,WGAMMA            SET DELTA=GAMM                  05500021
         LH    DELREG,WDELTA                                            05520021
NEWTHET  LR    DVDREG,DELREG            LOAD DELT TO DIVIDEND REG       05540021
         SRDA  DVDREG,32                                                05560021
         D     DVDREG,C360              THET NOT OVER 360               05580021
         STH   DVDREG,WTHETA                                            05600021
         B     DTENTRY                                                  05620021
*                                                                       05640021
*   HANDLING OF OFF S/G CONDITIONS                                      05660021
*                                                                       05680021
ILLEGAL  CLI   SG,C'A'                  IS A OPTION SPECIFIED           05700021
         BNE   OPTIONB                  IF NOT TEST FOR B               05720021
         BAL   LINREG,ERR44                                             05740021
         B     CKENTRY                  CONTINUE AFTER SET ERROR CODE   05760021
OPTIONB  CLI   SG,C'B'                  IS B OPTION SPECIFIED           05780021
         BNE   OPTIONC                  IF NOT TEST FOR OPTION C        05800021
         BAL   LINREG,ERR48                                             05820021
         B     CKENTRY                  CONTINUE AFTER SET ERROR CODE   05840021
OPTIONC  CLI   SG,C'C'                  IS OPTION C SPECIFIED           05860021
         BNE   OPTIOND                  IF NOT TEST FOR OPTION D        05880021
         BAL   LINREG,SCRCHK            IF YES GO TO TEST IF OFF SCREEN 05900021
         CLI   OFFSW,X'11'              TEST IF OFF SWITCH ON           05920021
         BE    ERR32RET                 IF OFF SCREEN ERROR RETURN      05940021
         LA    15,32                    OTHERWISE SET ERROR CODE        05960021
         BAL   LINREG,ERRCNT            UPDATE ERROR COUNT              05980021
         B     CKENTRY                  AND CONTINUE THE JOB            06000021
OPTIOND  CLI   SG,C'D'                  IS OPTION D SPECIFIED           06020021
         BNE   ASSUMEE                  IF NOT ASSUME OPTION E          06040021
         B     ERR28RET                 IMMEDIATE ERROR RETURN          06060021
ASSUMEE  B     ERR32RET                 IMMEDIATE ERROR RETURN          06080021
RET      LA    WRKREG,1                                                 06100021
         C     WRKREG,ERRCOUNT                                          06120021
         BL    SETBIT                                                   06140021
* RESTORE PROGRAM MASK TO SETTING UPON ENTRY                            06160021
RETMACRO L     WRKREG,MASKSV                                            06180021
         SPM   WRKREG                                                   06200021
         RETURN (14,12),T,RC=(15)                                       06220021
SETBIT   O     15,MZERO                                                 06240021
         B     RETMACRO                                                 06260021
*                                                                       06280021
* STORE GRAPHIC DATA IN GDOA FOR POR                                    06300021
* INPUT TO SUBROUTINE                                                   06320021
*   CNTREG = NUMBER OF BYTES OF GRAPHIC DATA TO STORE                   06340021
*   ADDREG = ADDRESS OF THE GRAPHIC DATA                                06360021
*   WKAREG = REGISTER 1 MUST CONTAIN THE WORKAREA ADDRESS               06380021
*   OABREG = ADDRESS OF OACB                                            06400021
STORE    SR    PASREG,PASREG            CLEAR OVERFLOW PASS INDICATOR   06420021
STORE1   L     OLPREG,16(0,OABREG)      ADDRESS OF OLP FROM OACB        06440021
         LR    WRKREG,CNTREG            LOAD BYTES TO MOVE              06460021
*                                                                       06480021
* CALCULATE ADDRESSES BASED ON N VALUE AND SIZE OF GDOA                 06500021
*                                                                       06520021
STORE2   AR    OLPREG,WRKREG            OLP ADDRESS PLUS N VALUE        06540021
         LA    TEMREG,4                                                 06560021
         AR    TEMREG,OLPREG            OLP PLUS N PLUS 4               06580021
         L     SLOREG,0(OABREG)         SLOA ADDRESS                    06600021
         A     SLOREG,4(OABREG)         ADD LOA EQUALS TOTAL GDOA       06620021
         CR    TEMREG,SLOREG                                            06640021
         L     OLPREG,16(0,OABREG)      RESET INITIAL OLP ADDRESS       06660021
         BC    12,OK                    ROOM FOR DATA                   06680021
*                                                                       06700021
* NOT ENOUGH ROOM TO STORE ALL OF THE DATA-DETERMINE AMOUNT TO STORE    06720021
*                                                                       06740021
         SR    TEMREG,SLOREG            EQUAL BYTES-CAN'T STORE         06760021
         SR    WRKREG,TEMREG            NUMBER OF BYTES CAN STORE       06780021
*                                                                       06800021
* ANY BYTES TO STORE                                                    06820021
*                                                                       06840021
         C     WRKREG,ZERO                                              06860021
         BC    12,STORE4                LESS OF EQUAL TO ZERO           06880021
         LH    TEMREG,H2A02                                             06900021
         CH    TEMREG,GOMODE                                            06920021
         BH    STORE3A                                                  06940021
         LH    TEMREG,H0003                                             06960021
         NR    TEMREG,WRKREG                                            06980021
         BM    STORE4      GO TO USER OVERFLOW ROUTINE (CAAR)      7468 07000021
STORE3A  SR    CNTREG,WRKREG       BYTES REMAINING                      07020021
         BAL   INTLNK,STORE6            LINK INTERNALLY                 07040021
STORE3   LA    PASREG,1                 SET PASS INDICATOR              07060021
*                                                                       07080021
* STORE REGISTERS IN WORKAREA                                           07100021
*                                                                       07120021
         STM   0,15,0(WKAREG)           SAVE REGISTERS IN WORKAREA      07140021
         L     15,8(0,OABREG)           OVER FLOW ADDRESS               07160021
         LM    2,12,28(13)              RELOAD USER'S REGISTERS         07180021
         BALR  14,15                    LINK TO ROUTINE-SET RETURN      07200021
         LM    0,15,0(WKAREG)           RELOAD FROM WORKAREA            07220021
         B     STORE1                   GET NEW OLP ADDRESS-CONTINUE    07240021
*                                                                       07260021
* NO SPACE AVAILABLE                                                    07280021
*                                                                       07300021
*                                                                       07320021
STORE4   C     PASREG,ONE               WAS A TRANSFER TO OVERFLOW MADE 07340021
         BC    4,STORE3                 NO                              07360021
*                                                                       07380021
* SET ERROR CODE AND RETURN TO POR-LEAVE POR WITH RETURN MACRO          07400021
*                                                                       07420021
         LA    15,24                    SET ERROR CODE                  07440021
         B     RET                      SYMBOLIC IN POR                 07460021
*                                                                       07480021
*                                                                       07500021
OK       BAL   INTLNK,STORE6            LINK INTERNALLY                 07520021
         BR    LINREG                                                   07540021
STORE6   LA    TEMREG,255               SET REG. EQUAL TO 255           07560021
STORE6A  CR    WRKREG,TEMREG            IS AMOUNT TO MOVE OVER 255      07580021
         BC    2,STORE7                 YES                             07600021
         LR    TEMREG,WRKREG                                            07620021
         S     TEMREG,ONE               COMPENSATE FOR EXTRA BYTE       07640021
         EX    TEMREG,MOVE              MOVE GRAPHIC DATA               07660021
         AR    OLPREG,WRKREG            UPDATE OLP ADDRESS              07680021
         AR    ADDREG,WRKREG            UPDATE DATA ADDR                07700021
         ST    OLPREG,16(0,OABREG)      STORE NEW OLP ADDRESS           07720021
         BR    INTLNK                   RETURN INTERNALLY               07740021
STORE7   LR    SLOREG,TEMREG                                            07760021
         S     SLOREG,ONE               COMPENSATE FOR EXTRA BYTE       07780021
         EX    SLOREG,MOVE              MOVE GRAPHIC DATA               07800021
         AR    OLPREG,TEMREG            UPDATE OLP ADDRESS              07820021
         AR    ADDREG,TEMREG            UPDATE INPUT ADDRESS            07840021
         SR    WRKREG,TEMREG           REDUCE BY 255                    07860021
         B     STORE6A                  MAKE NEXT COMPARISON            07880021
MOVE     MVC   0(0,OLPREG),0(ADDREG)    MOVE DATA TO GDOA               07900021
*                                                                       07920021
*   SUBROUTINE TO CHECK IF INPUT POINT WITHIN GRID                      07940021
*                                                                       07960021
GRDCK    LH    WRKREG,X1                GET X1                          07980021
         C     WRKREG,COMPUX            SEE IF COMPUTED X OUTSIDE GRID  08000021
         BH    SIGNAL                                                   08020021
         LH    WRKREG,X2                GET X2                          08040021
         C     WRKREG,COMPUX            SEE IF COMPUTED X OUTSIDE GRID  08060021
         BL    SIGNAL                                                   08080021
         LH    WRKREG,Y1                GET Y1                          08100021
         C     WRKREG,COMPUY            SEE IF COMPUTED Y OUTSIDE GRID  08120021
         BH    SIGNAL                                                   08140021
         LH    WRKREG,Y2                GET Y2                          08160021
         C     WRKREG,COMPUY            SEE IF COMPUTED Y OUTSIDE GRID  08180021
         BL    SIGNAL                                                   08200021
         MVI   OFFSW,X'00'              WITHIN LIMIT SET SW OFF         08220021
         BR    LINREG                                                   08240021
*                                                                       08260021
*   SUBROUTINE TO CHECK IF INPUT POINT WITHIN SCREEN                    08280021
*                                                                       08300021
SCRCHK   L     WRKREG,COMPUX            GET COMPUTED X                  08320021
         C     WRKREG,ZERO              COMPARE TO ZERO                 08340021
         BL    SIGNAL                   IF NEGATIVE SIGNAL OFFSG        08360021
         C     WRKREG,C4095             COMPARE TO 4095                 08380021
         BH    SIGNAL                   IF HIGHER SIGNAL OFFSG          08400021
         L     WRKREG,COMPUY            GET COMPUTED Y AND              08420021
         C     WRKREG,ZERO               TEST IN THE SAME WAY           08440021
         BL    SIGNAL                                                   08460021
         C     WRKREG,C4095                                             08480021
         BH    SIGNAL                                                   08500021
         MVI   OFFSW,X'00'              WITHIN LIMIT SET SW OFF         08520021
         BR    LINREG                                                   08540021
SIGNAL   MVI   OFFSW,X'11'              SET OFFGRID SWITCH ON           08560021
         BR    LINREG                                                   08580021
* SCALE UC VC IN FIXED POINT WITH THE FOLLOWING FORMULAS                08600021
*                                                                       08620021
*   UC=(U-U1)(X2-X1)/(U2-U1)+X1                                         08640021
*   VC=(V-V1)(Y2-Y1)/(V2-V1)+Y1                                         08660021
*                                                                       08680021
SCALFIX  STM   2,12,PORSAVE                                             08700021
FIXSCAL  LA    CNTREG,2                                                 08720021
         SR    HALREG,HALREG            INDEX REG FOR X1 THEN Y1        08740021
         SR    SCLREG,SCLREG            INDEX REG FOR UC THEN VC        08760021
         SR    INXREG,INXREG            INDEX REG FOR UI THEN VI        08780021
SCALFXV  L     DVSREG,U2(INXREG)        LOAD U2 THEN V2                 08800021
         S     DVSREG,U1(INXREG)        U2-U1 THEN V2-V1                08820021
         BC    13,ERR16RET              BRANCH ON OVF, MINUS OR ZERO    08840021
         L     DVDREG,UC(SCLREG)        LOAD UC THEN VC                 08860021
         S     DVDREG,U1(INXREG)        UC-U1 OR VC-V1                  08880021
         LH    WRKREG,X2(HALREG)        LOAD X2 THEN Y2                 08900021
         SH    WRKREG,X1(HALREG)        X2-X1 OR Y2-Y1                  08920021
         BC    13,ERR4RET               BRANCH ON OVF, MINUS OR ZERO    08940021
         SRDA  DVDREG,32                                                08960021
         MR    DVDREG,WRKREG            (UC-U1)(X2-X1)OR(VC-V1)(Y2-Y1)  08980021
         DR    DVDREG,DVSREG            DEVIDED BY U2-U1 ORV2-V1        09000021
         AH    QUOREG,X1(HALREG)        ADD X1 OR Y1                    09020021
         ST    QUOREG,WUC(SCLREG)       STORE SCALED UC VC FOR WORKING  09040021
         A     INXREG,EIGHT                                             09060021
         A     SCLREG,FOUR              INDEXING REGISTER               09080021
         A     HALREG,TWO               INDEXING REGISTER               09100021
         BCT   CNTREG,SCALFXV           LOOP TO SCALE VC                09120021
* SCALE RU USING FORMULA                                                09140021
*                                                                       09160021
*   R=RU*(X2-X1)/(U2-U1)                                                09180021
*                                                                       09200021
         L     DVSREG,U2                GET U2                          09220021
         S     DVSREG,U1                U2-U1                           09240021
         BC    13,ERR16RET              BRANCH ON OVF, MINUS OR ZERO    09260021
         LH    DVDREG,X2                LOAD X2                         09280021
         SH    DVDREG,X1                X2-X1                           09300021
         BC    13,ERR4RET               BRANCH ON OVF, MINUS OR ZERO    09320021
         SRDA  DVDREG,32                                                09340021
         M    DVDREG,RU                 RU*(X2-X1) AND                  09360021
         DR    DVDREG,DVSREG            DIVIDED BY (U2-U1)              09380021
         ST    QUOREG,WR                                                09400021
         LM    2,12,PORSAVE                                             09420021
         B     TESTIN                                                   09440021
*    CONVERT XYLIM TABLE TO FLOATING VALUES                             09460021
SCALFLT  STM   2,12,PORSAVE                                             09480021
*    FLOATING POINT SPECIFIED - TEST FOR CHARACTERISTIC ZERO AND        09500021
*    FRACTION NON ZERO. OF ALL U,V VALUES                               09520021
         L     VALREG,UC                                                09540021
         BAL   LINREG,FIXCONV                                           09560021
         L     VALREG,VC                                                09580021
         BAL   LINREG,FIXCONV                                           09600021
         L     VALREG,RU                                                09620021
         BAL   LINREG,FIXCONV                                           09640021
         L     VALREG,U1                                                09660021
         BAL   LINREG,FIXCONV                                           09680021
         L     VALREG,U2                                                09700021
         BAL   LINREG,FIXCONV                                           09720021
         L     VALREG,V1                                                09740021
         BAL   LINREG,FIXCONV                                           09760021
         L     VALREG,V2                                                09780021
         BAL   LINREG,FIXCONV                                           09800021
         LA    CNTREG,4                 SET LOOP COUNT                  09820021
         SR    HALREG,HALREG            SET HALF WORK INDEX REG         09840021
         SR    SCLREG,SCLREG            CLEAR FULL WORD INDEX REG       09860021
NEXTXY   LH    VALREG,X1(HALREG)        GET X1,Y1,X2,Y2                 09880021
         BAL   LINREG,FLTCONV           BRANCH TO CONVERT               09900021
         ST    VALREG,FX1(SCLREG)       STORE CONVERTED VALUES          09920021
         A     HALREG,TWO               INDEXING HALF WORD              09940021
         A     SCLREG,FOUR              INDEXING FULL WORD              09960021
         BCT   CNTREG,NEXTXY                                            09980021
*                                                                       10000021
*                                                                       10020021
* SCALE UC VC IN FLOATING POINT WITH THE FOLLOWING FORMULAS             10040021
*                                                                       10060021
*  UC=(UC-U1)(X2-X1)/(U2-U1)+X1                                         10080021
*  VC=(VC-V1)(Y2-Y1)/(V2-V1)+Y1                                         10100021
*                                                                       10120021
FLTSCAL  LA    CNTREG,2                                                 10140021
         SR    INXREG,INXREG                                            10160021
         SR    SCLREG,SCLREG                                            10180021
SCALFLV  LE    REG6,U1(INXREG)          LOAD U1 THEN V1                 10200021
         LE    REG4,U2(INXREG)          LOAD U2 THEN V2                 10220021
         SER   REG4,REG6                     U2-U1                      10240021
         BC    13,ERR16RET              BRANCH ON OVF, MINUS OR ZERO    10260021
         LE    REG0,UC(SCLREG)          LOAD UC THEN VC                 10280021
         SER   REG0,REG6                U-U1  OR V-V1                   10300021
         LE    REG6,FX1(SCLREG)         LOAD X1 OR Y1 FLT VALUE         10320021
         LE    REG2,FX2(SCLREG)         X2 OR Y2 FLOAT VALUE            10340021
         SER   REG2,REG6                (X2-X1)                         10360021
         BC    13,ERR4RET               BRANCH ON OVF, MINUS OR ZERO    10380021
         MER   REG0,REG2                (U-U1)(X2-X1)                   10400021
         DER   REG0,REG4                (U-U1)(X2-X1)                   10420021
         AER   REG0,REG6                                                10440021
         STE   REG0,WUC(SCLREG)         STORE UC VC SCALED VALUES       10460021
         A     INXREG,EIGHT                                             10480021
         A     SCLREG,FOUR                                              10500021
         BCT   CNTREG,SCALFLV                                           10520021
*                                                                       10540021
* SCALE RU IN FLOATING POINT WITH THE FOLLOWING FORMULAS                10560021
*                                                                       10580021
*   R=RU*(X2-X1)/(U2-U1)                                                10600021
*                                                                       10620021
         LE    REG6,U1                  LOAD U1                         10640021
         LE    REG4,U2                  LOAD U2                         10660021
         SER   REG4,REG6                U2-U1                           10680021
         BC    13,ERR16RET              BRANCH ON OVF, MINUS OR ZERO    10700021
         LE    REG0,RU                  GET RADIUS IN PARTAB            10720021
         LE    REG6,FX1                 LOAD X1 FLOAT VALUE             10740021
         LE    REG2,FX2                 LOAD X2 FLOAT VALUE             10760021
         SER   REG2,REG6                FX2-FX1                         10780021
         BC    13,ERR4RET               BRANCH ON OVF, MINUS OR ZERO    10800021
         MER   REG0,REG2                RU*(X2-X1)                      10820021
         DER   REG0,REG4                DIVIDED BY U2-U1                10840021
         STE   REG0,WR                  STORE SCALED RADIUS             10860021
         LM    2,12,PORSAVE                                             10880021
*                                                                       10900021
*    CONVERT FLOATING UC VC RU TO FIXED POINT VALUES                    10920021
FCONVERT L     VALREG,WR                LOAD RADIUS                     10940021
         BAL   LINREG,FIXCONV           FIXCONV=CONVERT FLT TO FIX      10960021
         ST    VALREG,WR                STORE THE CONVERTED RADIUS      10980021
         L     VALREG,WUC               GET UC                          11000021
         BAL   LINREG,FIXCONV                                           11020021
         ST    VALREG,WUC               STORE CONVERTED UC              11040021
         L     VALREG,WVC               GET VC                          11060021
         BAL   LINREG,FIXCONV                                           11080021
         ST    VALREG,WVC               STORE CONVERTED VC              11100021
         B     TESTIN                                                   11120021
FIXCONV  ST    1,OVFSAVE                STORE IN FIRST WORD REG.1       11140021
         TM    OVFSAVE+3,X'07'          TEST LAST THREE BITS            11160021
         BZ    SETMODI                  NO BITS ON SET INDEX TO ZERO    11180021
         LA    TEMREG,4                 SET MODIFIER                    11200021
         B     SAVFLT                   START CONVERSION                11220021
SETMODI  LA    TEMREG,0                 SET MODIFIER TO ZERO            11240021
SAVFLT   ST    VALREG,TEMFLT(TEMREG)    SAVE FLOAT VALUE                11260021
         SR    WRKREG,WRKREG                                            11280021
         ST    WRKREG,TEMFLT+4(TEMREG)  CLEAR SECOND WORD               11300021
         LD    6,TEMFLT(TEMREG)         VALUE TO FLOAT REGISTERS        11320021
         N     VALREG,FCHAR                                             11340021
         BE    FLERR1                   CHARACTERISTIC IS ZERO          11360021
         AE    6,FLPT5                  ADD .5 TO ROUND                 11380021
         AW    6,X4E                    ADD UNNORMALIZED-RIGHT JUSTIF.  11400021
         STD   6,TEMFLT(TEMREG)         SAVE VALUES                     11420021
         L     WRKREG,TEMFLT+4(TEMREG)  CHECK SECOND WORD               11440021
         N     WRKREG,MZERO             CHECK BIT 32                    11460021
         BM    ERR12RET                                                 11480021
         L     WRKREG,TEMFLT(TEMREG)                                    11500021
         N     WRKREG,BYTE123                                           11520021
         BM    ERR12RET                                                 11540021
         L     WRKREG,TEMFLT(TEMREG)                                    11560021
         N     WRKREG,MZERO             DROP CHARACTERISTIC             11580021
         L     VALREG,TEMFLT+4(TEMREG)  NEW FIXED VALUE                 11600021
         LTR   WRKREG,WRKREG                                            11620021
         BNL   NOTNEG                                                   11640021
         LNR   VALREG,VALREG            TWO'S COMPLEMENT                11660021
NOTNEG   BR    LINREG                                                   11680021
FLERR1   CE    6,ZERO                   IS TOTAL VALUE ZERO             11700021
         BE    NOTNEG                   RETURN                          11720021
         B     ERR12RET                 SET ERROR CODE AND RETURN       11740021
         DS    0D                                                       11760021
X4E      DC    X'4E00000000000000'                                      11780021
FLPT5    DC    E'.5'                                                    11800021
BYTE123  DC    X'00FFFFFF'                                              11820021
MZERO    DC    X'80000000'                                              11840021
FCHAR    DC    X'7F000000'                                              11860021
XZERO    DC    X'80FFFFFF'              SIGN AND VALUE -DROP EXPONENT   11880021
X6       DC    X'46000000'              EXPONENT OF SIX                 11900021
NSIGN    DC    X'7FFFFFFF'                                              11920021
*                                                                       11940021
*   CONVERT FIXED POINT TO FLOATING POINT VALUES                        11960021
*                                                                       11980021
FLTCONV  O     VALREG,X6                EXPONENT OF 6                   12000021
         ST    VALREG,OVFSAVE                                           12020021
         LE    0,OVFSAVE                LOAD TO FLOAT REG.              12040021
         AE    0,X6                     NORMALIZE                       12060021
         STE   0,OVFSAVE                                                12080021
         L     VALREG,OVFSAVE           FLOAT PT VALUE IN REG.          12100021
         BR    LINREG                                                   12120021
*    CHECK XYLIM TABLE                                                  12140021
XYLCHK   LH    XYREG1,X1                LOAD X1                         12160021
         LH    XYREG2,X2                LOAD X2                         12180021
         LA    CONREG,2                 SET LOOP CONTROL                12200021
XYLOOP   CR    XYREG1,XYREG2            COMPARE X1 TO X2                12220021
         BNL   XYLERR                                                   12240021
         C     XYREG1,ZERO              COMPARE X1 TO ZERO              12260021
         BL    XYLERR                                                   12280021
         C     XYREG1,C4095             COMPARE X1 TO 4095              12300021
         BH    XYLERR                                                   12320021
         C     XYREG2,ZERO              CHECK X2                        12340021
         BL    XYLERR                                                   12360021
         C     XYREG2,C4095                                             12380021
         BH    XYLERR                                                   12400021
         LH    XYREG1,Y1                LOAD Y1                         12420021
         LH    XYREG2,Y2                LOAD Y2                         12440021
         BCT   CONREG,XYLOOP                                            12460021
         BR    LINREG                                                   12480021
XYLERR   B     ERR4RET                                                  12500021
*INPUT INVALID- ERROR HANDLING                                          12520021
ERR4RET  LA    15,4                     XYLIM X1,Y1,X2,Y2 ERROR         12540021
         B     ERRCNTR                                                  12560021
ERR12RET LA    15,12                                                    12580021
         B     ERRCNTR                                                  12600021
ERR16RET LA    15,16                    U1 V1 GREATER THAN U2 V2        12620021
         B     ERRCNTR                                                  12640021
ERR20RET LA    15,20                    IMMEDIATE INPUT RETURN          12660021
         B     ERRCNTR                                                  12680021
ERR24RET LA    15,24                    USERS OVERFLOW                  12700021
         B     ERRCNTR                                                  12720021
ERR28RET LA    15,28                    SET ERROR CODE                  12740021
         B     ERRCNTR                                                  12760021
ERR32RET LA    15,32                                                    12780021
         B     ERRCNTR                                                  12800021
ERR40    LA    15,40                    INPUT ERROR - NOT SERIOUS       12820021
         B     ERRCNT                                                   12840021
ERR44    LA    15,44                                                    12860021
         B     ERRCNT                                                   12880021
ERR48    LA    15,48                                                    12900021
         B     ERRCNT                                                   12920021
ERRCNTR  LA    LINREG,RET                                               12940021
ERRCNT   L     TEMREG,ERRCOUNT          UPDATE ERROR COUNT              12960021
         A     TEMREG,ONE                                               12980021
         ST    TEMREG,ERRCOUNT                                          13000021
         BR    LINREG                                                   13020021
ZERO     DC    F'0'                                                     13040021
ONE      DC    F'1'                                                     13060021
TWO      DC    F'2'                                                     13080021
FOUR     DC    F'4'                                                     13100021
EIGHT    DC    F'8'                                                     13120021
TWOPI    DC    FS28'6.2832'             DEFINE TWOPI VALUE              13140021
EPM      DC    X'2A00'                  GEPM ORDER                      13160021
C16384   DC    F'16384'                                                 13180021
C8192    DC    F'8192'                                                  13200021
C4095    DC    F'4095'                                                  13220021
C360     DC    F'360'                                                   13240021
C90      DC    F'90'                                                    13260021
C45      DC    F'45'                                                    13280021
H2A02    DC    X'2A02'                                                  13300021
H0003    DC    H'0003'                                                  13320021
PLUS4    DC    X'0004'                                                  13340021
MINUS4   DC    X'FFFC'                                                  13360021
CSIGN    DC    X'0001FFFFFFFF0001'                                      13380021
SSIGN    DC    X'00010001FFFFFFFF'                                      13400021
TABLE    DC    HS14'0.0000,1.0000,0.0175,0.9999'                        13420021
         DC    HS14'0.0349,0.9994,0.0523,0.9986'                        13440021
         DC    HS14'0.0698,0.9976,0.0872,0.9962'                        13460021
         DC    HS14'0.1045,0.9945,0.1219,0.9925'                        13480021
         DC    HS14'0.1392,0.9903,0.1564,0.9877'                        13500021
         DC    HS14'0.1737,0.9848,0.1908,0.9816'                        13520021
         DC    HS14'0.2079,0.9782,0.2250,0.9744'                        13540021
         DC    HS14'0.2419,0.9703,0.2588,0.9659'                        13560021
         DC    HS14'0.2756,0.9613,0.2924,0.9563'                        13580021
         DC    HS14'0.3090,0.9511,0.3256,0.9455'                        13600021
         DC    HS14'0.3420,0.9397,0.3584,0.9336'                        13620021
         DC    HS14'0.3746,0.9272,0.3907,0.9205'                        13640021
         DC    HS14'0.4067,0.9136,0.4226,0.9063'                        13660021
         DC    HS14'0.4384,0.8988,0.4540,0.8910'                        13680021
         DC    HS14'0.4695,0.8830,0.4848,0.8746'                        13700021
         DC    HS14'0.5000,0.8660,0.5150,0.8572'                        13720021
         DC    HS14'0.5299,0.8481,0.5446,0.8387'                        13740021
         DC    HS14'0.5592,0.8290,0.5736,0.8192'                        13760021
         DC    HS14'0.5878,0.8090,0.6018,0.7986'                        13780021
         DC    HS14'0.6157,0.7880,0.6293,0.7772'                        13800021
         DC    HS14'0.6428,0.7660,0.6561,0.7547'                        13820021
         DC    HS14'0.6691,0.7431,0.6820,0.7314'                        13840021
         DC    HS14'0.6947,0.7193,0.7071,0.7071'                        13860021
REG0     EQU   0                                                        13880021
REG2     EQU   2                                                        13900021
REG4     EQU   4                                                        13920021
REG6     EQU   6                                                        13940021
HALREG   EQU   5                                                        13960021
SCLREG   EQU   6                                                        13980021
INXREG   EQU   7                                                        14000021
DVSREG   EQU   8                                                        14020021
XYREG1   EQU   7                                                        14040021
XYREG2   EQU   8                                                        14060021
VALREG   EQU   8                                                        14080021
XYLREG   EQU   14                                                       14100021
WKAREG   EQU   1                                                        14120021
DVDREG   EQU   2                                                        14140021
QUOREG   EQU   3                                                        14160021
GMREG    EQU   4                                                        14180021
DELREG   EQU   4                                                        14200021
WRKREG   EQU   4                                                        14220021
CONREG   EQU   5                                                        14240021
XREG     EQU   6                                                        14260021
YREG     EQU   6                                                        14280021
MPCREG   EQU   6                                                        14300021
PRDREG   EQU   7                                                        14320021
NPAREG   EQU   10                                                       14340021
PATREG   EQU   12                                                       14360021
PASREG   EQU   2                                                        14380021
SLOREG   EQU   3                                                        14400021
OLPREG   EQU   5                                                        14420021
TEMREG   EQU   6                                                        14440021
ADDREG   EQU   7                                                        14460021
OABREG   EQU   8                                                        14480021
CNTREG   EQU   10                                                       14500021
LINREG   EQU   11                                                       14520021
INTLNK   EQU   12                                                       14540021
WKAREA   DSECT                                                          14560021
OVFSAVE  DS    CL72                     18-WORD SAVEAREA FOR REGISTERS  14580021
         ORG   OVFSAVE                                                  14600021
TEMFLT   DS    CL8                      A  TEMPORARY SAVE AREA          14620021
         DS    CL64                                                     14640021
PORSAVE  DS    CL44                     A  REGISTER SAVE AREA           14660021
ERRCOUNT DS    CL4                      COUNT OF ERRORS                 14680021
FX1      DS    CL4                      FLOATING X1                     14700021
FY1      DS    CL4                      FLOATING Y1                     14720021
FX2      DS    CL4                      FLOATING X2                     14740021
FY2      DS    CL4                      FLOATING Y2                     14760021
WOACB    DS    CL4                      AN AREA TO SAVE OACB ADDRESS    14780021
WRTADDR  DS    CL4                      ADDR OF GRID OR SCREEN CHECK RT 14800021
WUC      DS    CL4                                                      14820021
WVC      DS    CL4                                                      14840021
WR       DS    CL4                                                      14860021
WTHETA   DS    CL2                                                      14880021
WALPHA   DS    CL2                                                      14900021
WGAMMA   DS    CL2                                                      14920021
WDELTA   DS    CL2                                                      14940021
BUILDXY  DS    CL4                      XY BUILDUP AREA                 14960021
WXI      DS    CL4                                                      14980021
WYI      DS    CL4                                                      15000021
COMPUX   DS    CL4                      COMPUTED X VALUE                15020021
COMPUY   DS    CL4                      COMPUTED Y VALUE                15040021
MASKSV   DS    F                   SAVE SETTING OF USER PROGRAM MASK    15060021
         ORG   OVFSAVE+396                                              15080021
GOMODE   DS    CL2                                                      15100021
PARTAB   DSECT                                                          15120021
XYLIM    DS    CL4                                                      15140021
UC       DS    CL4                                                      15160021
VC       DS    CL4                                                      15180021
F        DS    CL1                                                      15200021
S        DS    CL1                                                      15220021
INC      DS    CL1                                                      15240021
SG       DS    CL1                                                      15260021
RU       DS    CL4                                                      15280021
THETA    DS    CL2                                                      15300021
DENSITY  DS    CL2                                                      15320021
         ORG   DENSITY                                                  15340021
ALPHA    DS    CL2                                                      15360021
GAMMA    DS    CL2                                                      15380021
OFFSW    DS    CL1                                                      15400021
XYLIMTB  DSECT                                                          15420021
X1       DS    CL2                                                      15440021
Y1       DS    CL2                                                      15460021
X2       DS    CL2                                                      15480021
Y2       DS    CL2                                                      15500021
U1       DS    CL4                                                      15520021
U2       DS    CL4                                                      15540021
V1       DS    CL4                                                      15560021
V2       DS    CL4                                                      15580021
         END                                                            15600021
