         TITLE 'GSPLOT-SCALE AND PLOT'                                  00020021
*STATUS. CHANGE LEVEL 0                                                 00040021
*                                                                       00060021
*FUNCTION/OPERATION. GSPLOT GENERATES THE GRAPHIC ORDERS TO DISPLAY A   00080021
*   POINT,CHARACTER,OR VECTOR PLOT.  A COMBINATION OF THE VARIOUS PLOT  00100021
*   TYPES MAY BE DISPLAYED.                                             00120021
*   THE GRAPHIC ORDERS ARE STORED IN THE GRAPHIC DATA OUTPUT AREA(GDOA) 00140021
*                                                                       00160021
*ENTRY POINTS. GSPLOT VIA CALL OR LINK MACRO   ALIAS NAME IFFPDA        00180021
*                                                                       00200021
*INPUT.OUTPUT CONTROL BLOCK POINTER (OCBP) AND A PARAMETER ADDRESS      00220021
*   WHICH POINTS TO A SEQUENCE OF ADDRESSES AND EBCDIC CHARACTERS IN A  00240021
*   USER PROVIDED PARAMETER TABLE                                       00260021
*                                                                       00280021
*OUTPUT. A STRING OF GRAPHIC ORDERS SUITABLE FOR PLOTTING               00300021
*                                                                       00320021
*EXTERNAL ROUTINES. GOFFSG-OFF SCREEN/GRID INTERSECTION ROUTINE         00340021
*                                                                       00360021
*EXITS-NORMAL. COMPLETION OF TASK EXIT VIA RETURN MACRO                 00380021
*     -ERROR. HEXADECIMAL 4,C,10,18,1C, OR 20 IN REG. 15                00400021
*  IMMEDIATE RETURN. EXIT VIA RETURN MACRO                              00420021
*     -ERROR. HEXADECIMAL 28,2C OR 30 IN REG. 15 DOES NOT RETURN        00440021
*      IMMEDIATELY-COMPLETION OF TASK AND RETURN VIA RETURN MACRO       00460021
*                                                                       00480021
*TABLES/WORK AREAS. USER SPECIFIED PARAMETER TABLE, XYLIM TABLE, UTAB,  00500021
*   VTAB VALUE TABLES AND A USER SUPPLIED WORK AREA                     00520021
*                                                                       00540021
*ATTRIBUTES. READ ONLY, REENTRANT                                       00560021
*                                                                       00580021
IFFPDAPL CSECT                          GSPLOT                          00600021
*0669                                                              7468 00610021
* GSPLOT ROUTINE-SAVE REGISTERS-SET RETURN REGISTER AND INITIALIZE      00620021
*                                                                       00640021
         ENTRY GSPLOT                                                   00660021
GSPLOT   SAVE  (14,12),T,*              SYSTEM SAVE MACRO               00680021
         BALR  9,0                                                      00700021
         USING *,9                      BASE REGISTER                   00720021
         USING XYLIM,PATREG                                             00740021
         USING X1,XYLREG                                                00760021
         USING OVFSAVE,WKAREG                                           00780021
         SR    15,15                    CLEAR RETURN CODE               00800021
         LM    OBPREG,PATREG,0(1)       LOAD CONTROL BLOCK AND PARTAB   00820021
         L     OABREG,0(0,OBPREG)       CONTROL BLOCK ADDRESS           00840021
         L     WKAREG,4(0,OBPREG)       WORK AREA ADDRESS               00860021
*  SAVE MASK BITS AS SET BY USER                                        00880021
         ST    9,MASKSV                                                 00900021
         SR    WRKREG,WRKREG                                            00920021
         SPM   WRKREG                                                   00940021
*   CLEAR WORKAREA-TOTAL TEMPORARY STORAGE                              00960021
*                                                                       00980021
         LA    CNTREG,72                COUNT FOR WORK AREA             01000021
         SR    CONREG,CONREG            SET INDEX CONTROL               01020021
CLEARWK  ST    15,OVFSAVE(CONREG)       CLEAR WORK AREA                 01040021
         A     CONREG,FOUR              MODIFY                          01060021
         BCT   CNTREG,CLEARWK           CONTINUE                        01080021
         MVI   COUNT+1,X'01'            SET COUNT TO 1                  01100021
* CHECK INPUT PARAMETERS                                                01120021
*                                                                       01140021
         L     XYLREG,XYLIM             XYLIM ADDRESS                   01160021
         BAL   INTREG,XYLCHK            CHK X1,X2,Y1,Y2 FOR LIMITS      01180021
*                                                                       01200021
* TEST IF FLOATING PT.OR FIXED IS SPECIFIED                             01220021
*                                                                       01240021
         CLI   F,C'B'                   FIXED PARAMETER                 01260021
         BE    OV1                      YES                             01280021
         CLI   F,C'F'                   FLOAT PRAAMETER                 01300021
         BE    OV1                      YES                             01320021
         BAL   LINREG,ERR40             SET ERROR CODE-COUNT ERRORS     01340021
OV1      CLI   S,C'S'                   SCALE                           01360021
         BE    OV2                      YES                             01380021
         CLI   S,C'N'                   NO SCALE                        01400021
         BE    OV2                      YES                             01420021
         BAL   LINREG,ERR40             SET ERROR CODE-COUNT ERRORS     01440021
*                                                                       01460021
* TEST FOR ABSOLUTE OR RELATIVE MODE                                    01480021
*                                                                       01500021
OV2      CLI   A,C'A'                   ABSOLUTE MODE                   01520021
         BE    OV3                      YES                             01540021
         CLI   A,C'R'                   RELATIVE MODE                   01560021
         BE    OV3                      YES                             01580021
         BAL   LINREG,ERR40             SET ERROR CODE-COUNT ERRORS     01600021
*                                                                       01620021
* TEST INCREMENT CODE                                                   01640021
*                                                                       01660021
OV3      CLI   I,C'W'                   NO-INCREMENT                    01680021
         BE    OV4                      YES                             01700021
         CLI   I,C'X'                   INCREMENT U-ONLY                01720021
         BE    OV4                      YES                             01740021
         CLI   I,C'Y'                   INCREMENT V-ONLY                01760021
         BE    OV4                      YES                             01780021
         CLI   I,C'Z'                   INCREMENT U AND V               01800021
         BE    OV4                      YES                             01820021
         BAL   LINREG,ERR40             SET ERROR CODE-COUNT ERRORS     01840021
*                                                                       01860021
* TEST PLOT TYPE CODE                                                   01880021
*                                                                       01900021
*                                                                       01920021
OV4      CLI   PTYPE,C'A'               POINT PLOT                      01940021
         BE    OV5                      YES                             01960021
         CLI   PTYPE,C'B'               CHARACTER PLOT                  01980021
         BE    OV5                      YES                             02000021
         CLI   PTYPE,C'C'               VECTOR PLOT                     02020021
         BE    OV5                      YES                             02040021
         CLI   PTYPE,C'D'               VECTOR AND POINT                02060021
         BE    OV5                      YES                             02080021
         CLI   PTYPE,C'E'               VECTOR AND CHARACTER            02100021
         BE    OV5                      YES                             02120021
         BAL   LINREG,ERR40             SET ERROR CODE-COUNT ERRORS     02140021
*                                                                       02160021
* CHECK S/G OPTIONS                                                     02180021
*                                                                       02200021
*                                                                       02220021
*   TEST OFF S/G OPTION SPECIFIED AND DECIDE BOUNDARY TO BE OBSERVED    02240021
*                                                                       02260021
OV5      CLI   SG,C'A'                  IS OPTION A SPECIFIED           02280021
         BE    MVGRDLIM                 IF YES USE GRID LIMITS          02300021
         CLI   SG,C'B'                  IS OPTION B SPECIFIED           02320021
         BE    MVSCRLIM                 IF YES USE SCREEN LIMITS        02340021
         CLI   SG,C'C'                  IS C OPTION SPECIFIED           02360021
         BE    MVGRDLIM                 IF YES USE GRID LIMITS          02380021
         CLI   SG,C'D'                  IS D OPTION SPECIFIED           02400021
         BE    MVGRDLIM                 IF YES USE GRID LIMITS          02420021
         CLI   SG,C'E'                  IS E OPTION SPECIFIED           02440021
         BE    MVSCRLIM                 IF YES USE SCREEN LIMITS        02460021
         BAL   LINREG,ERR40             OTHERWISE INPUT ERROR ASSUME E  02480021
MVSCRLIM LA    WRKREG,SCLCHK           GET SCREEN CHECK RT ADDRESS      02500021
         ST    WRKREG,WRTADDR           STORE THE ROUTINE ADDR USED     02520021
         LA    WRKREG,LOHI              SCREEN LIMITS START ADDRESS     02540021
         ST    WRKREG,SABL              STORE THE ADDRESS AT SABL       02560021
         B     OV6                                                      02580021
MVGRDLIM LA    WRKREG,GRLCHK           LOAD GRID ROUTINE CHECK ADDRESS  02600021
         ST    WRKREG,WRTADDR           STORE THE ROUTINE ADDR USED     02620021
         ST    XYLREG,SABL              STORE GRID LIMITS ADDR          02640021
OV6      CLC   N,ZERO                   N COMPARED TO ZERO              02660021
         BH    OV7                      N GREATER THAN ZERO             02680021
         BAL   LINREG,ERR40             SET ERROR CODE-COUNT ERRORS     02700021
* IS SYMBOL IN PARAMETER TABLE                                          02720021
*                                                                       02740021
OV7      CLI   PTYPE,C'B'               CHARACTER PLOT SPECIFIED        02760021
         BE    OV8                      YES                             02780021
         CLI   PTYPE,C'E'               VECTOR AND CHARACTER SPECIFIED  02800021
         BNE   STADD                    SKIP OVER-LAP CHECK             02820021
*                                                                       02840021
* IS CHARACTER GIVEN IN TABLE                                           02860021
*                                                                       02880021
OV8      LH    VALREG,SYMBOL            LETTER TO PLOT                  02900021
         N     VALREG,BYTE3             MASK FOR THIRD BYTE             02920021
         BC    4,CHSMOD                 LETTER PRESENT                  02940021
         BAL   LINREG,ERR40             SET ERROR CODE-COUNT ERRORS     02960021
*                                                                       02980021
*   SUBROUTINE TO TEST AND DEVELOPE GRAPHIC ORDER  FOR                  03000021
*   CHARACTER MODE AND SIZE                                             03020021
*   PATREG CONTAINS THE ADDRESS OF THE PARAMETER TABLE ON ENTRY         03040021
*   ORDREG CONTAINS THE GRAPHIC ORDER DEVELOPED ON RETURN               03060021
*   IF MODE OR SIZE ARE INCORRECTLY SPECIFIED, UNPROTECTED AND BASIC    03080021
*   ARE ASSUMED                                                         03100021
CHSMOD   CLI   CMOD,C'P'                PROTECTED                       03120021
         BE    PLEG                                                     03140021
         CLI   CMOD,C'F'                UNPROTECTED                     03160021
         BE    FLEG                                                     03180021
         BAL   LINREG,ERR40             SET ERROR CODE-COUNT ERRORS     03200021
FLEG     LH    VALREG,GFSC                                              03220021
SIZE     CLI   CSIZE,C'L'               LARGE                           03240021
         BE    SIZEL                                                    03260021
         CLI   CSIZE,C'B'               BASIC                           03280021
         BE    ORDSTO                                                   03300021
         BAL   LINREG,ERR40             SET ERROR CODE-COUNT ERRORS     03320021
ORDSTO   STH   VALREG,CHARMOD           ORDER-MODE-SIZE                 03340021
         B     NOCHK                    CHECK OVERLAP LETTER            03360021
SIZEL    A     VALREG,ONE               MODIFY ORDER TO LARGE           03380021
         B     ORDSTO                                                   03400021
PLEG     LH    VALREG,GFPC                                              03420021
         B     SIZE                                                     03440021
GFSC     DC    X'2A40'                                                  03460021
GFPC     DC    X'2A44'                                                  03480021
*                                                                       03500021
* CHECK OVERLAP LETTERS                                                 03520021
NOCHK    CLI   E,C'O'                   OVERLAP LETTER PRESENT          03540021
         BE    STADD                    YES                             03560021
         CLI   E,C'N'                   NO-OVERLAP-WANTED               03580021
         BE    STADD                    YES                             03600021
         BAL   LINREG,ERR40             SET ERROR CODE-COUNT ERRORS     03620021
*                                                                       03640021
* STORE VALUES FROM UTAB AND VTAB IN WORKAREA-SCALED VALUES AFTER SCALE 03660021
*                                                                       03680021
STADD    L     WRKREG,UTAB              UTAB ADDRESS                    03700021
         L     VALREG,0(0,WRKREG)       FIRST VALUE                     03720021
         ST    VALREG,UA                ABSOLUTE UA                     03740021
         ST    VALREG,UASCALE           ABSOLUTE-MAY BE SCALED          03760021
         STH   VALREG,X2FIN             MAY BE FINAL FIXED VALUE        03780021
         L     WRKREG,VTAB              VTAB ADDRESS                    03800021
         L     VALREG,0(0,WRKREG)       FIRST VALUE                     03820021
         ST    VALREG,VA                ABSOLUTE VA                     03840021
         ST    VALREG,VASCALE           ABSOLUTE-MAY BE SCALED          03860021
         STH   VALREG,Y2FIN             MAY BE FINAL FIXED VALUE        03880021
*                                                                       03900021
* IS FLOATING SPECIFIED                                                 03920021
*                                                                       03940021
         CLI   F,C'F'                   FLOATING PT. SPECIFIED          03960021
         BNE   NOFLOAT                  INDICATES FIXED OR NO PARAMETER 03980021
*                                                                       04000021
* IS SCALING SPECIFIED                                                  04020021
*                                                                       04040021
         CLI   S,C'S'                   SCALING SPECIFIED               04060021
         BNE   NOSCALE1                 INDICATES NO SCALE-CONVERT TO   04080021
*                                       FIXED PT. UA VALUES             04100021
*                                                                       04120021
* SET UP VALUES TO CONVERT XYLIM TABLE TO FLOATING POINT VALUES         04140021
*                                                                       04160021
         LA    CONREG,4                 DO FOUR VALUES                  04180021
         SR    INXREG,INXREG            CLEAR CONTROL MODIFICATION      04200021
         SR    CNTREG,CNTREG            CLEAR CONTROL MODIFICATION      04220021
NEXTXY   LH    VALREG,X1(INXREG)        GET X1,Y1,X2,Y2 VALUES          04240021
         BAL   LINREG,FLTCONV           CONVERT FIXED VALUE TO FLOAT PT 04260021
         ST    VALREG,FX1(CNTREG)       STORE IN WORKAREA               04280021
         A     INXREG,TWO               MODIFY BY TWO BYTES             04300021
         A     CNTREG,FOUR              MODIFY BY FOUR BYTES            04320021
         BCT   CONREG,NEXTXY                                            04340021
*                                                                       04360021
* FLOATING POINT SCALE-SUBROUTINE                                       04380021
* EQUATION XS=(UA-U1)*(X2-X1)/(U2-U1)+X1                                04400021
* EQUATION YS=(VA-V1)*(Y2-Y1)/(V2-V1)+Y1                                04420021
*                                                                       04440021
FLTSCAL  LA    CNTREG,2                 SET CONTROL                     04460021
         SR    CONREG,CONREG            CLEAR MODIFIER                  04480021
         SR    INXREG,INXREG            CLEAR MODIFIER                  04500021
FLTSCAL1 LE    6,U1(CONREG)             U1 THEN V1                      04520021
         LE    4,U2(CONREG)             U2 THEN V2                      04540021
         SER   4,6                      U2-U1 THEN V2-V1                04560021
         BC    13,ERR16RET         MINUS OR ZERO                        04580021
* LOAD FLOATING PT VALUE FROM WORKAREA                                  04600021
         LE    0,UA(INXREG)             UA-STORED THRU UN               04620021
         SER   0,6                      UA-U1 VARIABLE RESULT           04640021
         LE    6,FX1(INXREG)            X1 OR Y1 CONVERTED VALUE        04660021
         LE    2,FX2(INXREG)            X2 OR Y2 CONVERTED VALUE        04680021
         SER   2,6                                                      04700021
         MER   0,2                      UA-U1*X2-X1 OR VA-V1*Y2-Y1      04720021
         DER   0,4                      /U2-U1 OR V2-V1                 04740021
         AER   0,6                      +X1 OR Y1                       04760021
         STE   0,UASCALE(INXREG)        X OR Y SCALED VALUE             04780021
         A     CONREG,EIGHT             MODIFY FOR V1-V2                04800021
         A     INXREG,FOUR                                              04820021
         BCT   CNTREG,FLTSCAL1                                          04840021
*                                                                       04860021
* SCALE WAS SPECIFIED OR NO SCALE IS REQUIRED-CONVERT DATA TO FIXED PT. 04880021
*                                                                       04900021
*                                                                       04920021
NOSCALE1 LA    CONREG,2                 SET CONTROL                     04940021
         SR    CNTREG,CNTREG            CLEAR INDEX VALUE               04960021
         SR    INXREG,INXREG                                            04980021
NEXTSCAL L     VALREG,UASCALE(INXREG)   LOAD SCALED OR UNSCALED VALUE   05000021
         BAL   INTREG,FIXCONV           CONVERT TO FIXED PT.            05020021
         ST    VALREG,UASCALE(INXREG)   CONVERTED FIXED VALUE           05040021
         STH   VALREG,X2FIN(CNTREG)     FINAL VALUE                     05060021
         A     CNTREG,TWO               MODIFY                          05080021
         A     INXREG,FOUR                                              05100021
         BCT   CONREG,NEXTSCAL                                          05120021
         B     CHKCNT                                                   05140021
*                                                                       05160021
* FLOATING PT IS NOT SPECIFIED                                          05180021
* IS SCALING SPECIFIED                                                  05200021
*                                                                       05220021
*                                                                       05240021
*                                                                       05260021
* STORE  X1,Y1,X2,Y2 IN WORK AREA                                       05280021
NOFLOAT  LA    CONREG,4                                                 05300021
         SR    INXREG,INXREG                                            05320021
         SR    CNTREG,CNTREG                                            05340021
NEXXY    LH    VALREG,X1(INXREG)        X1,Y1,X2,Y2                     05360021
         ST    VALREG,FX1(CNTREG)       X1,Y1,X2,Y2 IN WORKAREA         05380021
         A     INXREG,TWO                                               05400021
         A     CNTREG,FOUR                                              05420021
         BCT   CONREG,NEXXY                                             05440021
*                                                                       05460021
         CLI   S,C'S'                   IS SCALE INDICATED              05480021
         BNE   CHKCNT                   INDICATES NO SCALE              05500021
* DATA MUST BE SCALED IN FIXED PT.                                      05520021
*                                                                       05540021
FIXSCAL  LA    INTREG,2                 SET INTERNAL CONTROL            05560021
         SR    CONREG,CONREG            CLEAR MODIFIER                  05580021
         SR    INXREG,INXREG            CLEAR MODIFIER                  05600021
FIXSCAL1 L     VALREG,U1(CONREG)        U1 THEN V1                      05620021
         L     TEMREG,U2(CONREG)        U2 THEN V2                      05640021
         SR    TEMREG,VALREG            U2-U1                           05660021
         BC    13,ERR16RET         MINUS OR ZERO                        05680021
         L     XREG,UA(INXREG)          UA                              05700021
         SR    XREG,VALREG              UA-U1  VARIABLE RESULT          05720021
         L     YREG,FX1(INXREG)         X1 OR Y1                        05740021
         L     VALREG,FX2(INXREG)       X2 OR Y2                        05760021
         SR    VALREG,YREG              X2-X1                           05780021
         SR    EREG,EREG                CLEAR MULTIPLICAND              05800021
         MR    EREG,VALREG              UA-U1*X2-X1                     05820021
         DR    EREG,TEMREG                                              05840021
         AR    XREG,YREG                                                05860021
         ST    XREG,UASCALE(INXREG)     X OR Y SCALED                   05880021
         A     CONREG,EIGHT                                             05900021
         A     INXREG,FOUR                                              05920021
         BCT   INTREG,FIXSCAL1                                          05940021
         LH    VALREG,UAS2              X                               05960021
         STH   VALREG,X2FIN             SCALED VALUE OF X               05980021
         LH    VALREG,VAS2              Y                               06000021
         STH   VALREG,Y2FIN             SCALED VALUE OF Y               06020021
*                                                                       06040021
*CHECK COUNT-IS IT EQUAL TO TWO OR MORE                                 06060021
*                                                                       06080021
CHKCNT   CLC   COUNT,TWO+2              COMPARE COUNT TO TWO            06100021
         BNL   SECOND                   YES                             06120021
         L     WRKREG,WRTADDR           CHECK FOR GRID IF APPLIES       06140021
         BALR  LINREG,WRKREG                                            06160021
         CLC   N,ONE+2                 FOR ONLY ONE POINT               06180021
         BE    ONEPT                   HANDLE IT IN POINT MODE          06200021
         LA    CNTREG,2                                                 06220021
         LA    ADDREG,ORDER1                                            06240021
         CLI   PTYPE,C'B'                                               06260021
         BNH   PTMODE                   MODE INITIALIZE GDOA FOR PTONLY 06280021
*                                       GENERATE                        06300021
         MVI   ORDER1,X'2A'             ORDER FOR VECTOR PLOTTING       06320021
         MVI   ORDER2,X'02'                                             06340021
         MVC   GOMODE,ORDER1                                            06360021
         BAL   LINREG,STORE             GIVE TO STORE ROUTINE           06380021
         B     SECOND                                                   06400021
PTMODE   MVI   ORDER1,X'2A'             ORDER FOR POINT PLOTTING        06420021
         MVI   ORDER2,X'00'             GENERATED GIVE                  06440021
         MVC   GOMODE,ORDER1                                            06460021
         BAL   LINREG,STORE             TO STORE ROUTINE                06480021
         B     SECOND                                                   06500021
*                                                                       06520021
* IS N VALUE EQUAL TO OR LESS THAN 1                                    06540021
*                                                                       06560021
*                                                                       06580021
*                                                                       06600021
* WAS PT. OFF SCREEN-ONLY 1 POINT ESTABLISHED                           06620021
*                                                                       06640021
ONEPT    BAL   LINREG,SCLCHK            DISCONTINUE IF ONLY ONE         06660021
         CLC   SWSTATUS,STATUS1         POINT AND IT IS OFF SCREEN      06680021
         BNE   ERR32RET                                                 06700021
*                                                                       06720021
* PT ON SCREEN- SET UP ORDER FOR A PT.                                  06740021
*                                                                       06760021
         MVI   ORDER1,X'2A'             PT PLOT MODE                    06780021
         MVI   ORDER2,X'00'                                             06800021
         MVC   ORDER3,X2FINAL           X AND Y FOR A POINT             06820021
         MVC   GOMODE,ORDER1                                            06840021
         LA    CNTREG,6                 MOVE SIX BYTES                  06860021
         LA    ADDREG,ORDER1            ADDRESS OF DATA                 06880021
         BAL   LINREG,STORE             STORE GRAPHIC DATA IN GDOA      06900021
         BAL   LINREG,PLTCH        GO PLOT A CHARECTOR        LI A44596 06910021
         BAL   LINREG,STORE        STORE IN GDOA              LI A44596 06912021
         B     RET                      RETURN TO USER                  06920021
*                                                                       06940021
* IS COUNT EQUAL TO N                                                   06960021
*                                                                       06980021
NOT1     CLC   N,COUNT                  COMPARE N TO COUNT              07000021
         BE    RET                      END OF PROGRAM                  07020021
* UPDATE COUNT FOR NEXT POINT                                           07040021
         LH    CNTREG,COUNT             COUNT                           07060021
         A     CNTREG,ONE               UPDATE COUNT                    07080021
         STH   CNTREG,COUNT             SAVE COUNT                      07100021
*                                                                       07120021
         L     VALREG,ZERO              CLEAR SKIPSW                    07140021
         STH   VALREG,SKIPSW                                            07160021
         MVC   PT1SW,OFFSW              UPDATE SCREEN GRID SWITCH       07180021
* SAVE THE PREVIOUS CALCULATED VALUE                                    07200021
         L     VALREG,UASCALE           X VALUE MAXIMUM SIZE            07220021
         ST    VALREG,UASCALE2          PT1-X-VALUE                     07240021
         L     VALREG,VASCALE           Y VALUE MAXIMUM SIZE            07260021
         ST    VALREG,VASCALE2          PT1-Y-VALUE                     07280021
         L     VALREG,X2FINAL                                           07300021
         ST    VALREG,X1FINAL                                           07320021
*                                                                       07340021
         SR    CONREG,CONREG            CLEAR MODIFIER                  07360021
         LA    CNTREG,2                 SET LOOP CONTROL                07380021
* THIS ROUTINE GET U-AND V TABLE VALUES                                 07400021
*                                                                       07420021
* GET NEXT VALUE FROM TABLE-UTAB                                        07440021
*                                                                       07460021
INCU     LH    INXREG,INDEX             TABLE INDEX VALUE               07480021
         L     WRKREG,UTAB              UTAB ADDRESS                    07500021
         CLI   I,C'X'                   U ARRAY INCREMENTAL             07520021
         BE    UINCR                    YES                             07540021
         CLI   I,C'Z'                   U AND V ARRAY INCREMENTAL       07560021
         BE    UINCR                    YES-BOTH U AND V ARE INCREMENT  07580021
FLCHK    CLI   F,C'F'                   FLOATING PT.                    07600021
         BE    FLRCHK                   YES-IS IT RELATIVE              07620021
FIXVAL   L     VALREG,4(INXREG,WRKREG)  NO -BINARY OR ASSUMED BINARY    07640021
         CLI   A,C'R'                   RELATIVE                        07660021
         BNE   USTORE                   NOT RELATIVE-STORE INDEXED VAL. 07680021
         B     USTORA                   RELATIVE-ADD PREVIOUS VALUE     07700021
UINCR    CLI   F,C'F'                   FLOATING PT.                    07720021
         BE    FLOATAD                  FLOAT SPECIFIED                 07740021
         L     VALREG,4(0,WRKREG)       FIXED INCREMENT VALUE-NOT INDEX 07760021
USTORA   A     VALREG,UA(CONREG)        ADD PREVIOUS ABS. VALUE         07780021
USTORE   ST    VALREG,UA(CONREG)        NEXT ABS. VALUE                 07800021
         ST    VALREG,UASCALE(CONREG)   NEW X OR Y VALUE                07820021
         B     INCV                     GET THE V VALUE                 07840021
*                                                                       07860021
* FLOATING PT NUMBERS SPECIFIED                                         07880021
*                                                                       07900021
FLRCHK   LE    0,4(INXREG,WRKREG)       NEXT FLOATING VALUE-INDEXED     07920021
         CLI   A,C'R'                   IS FLOAT RELATIVE               07940021
         BNE   STORFL                   NO REPLACE VALUE                07960021
         B     STORAF                   YES                             07980021
FLOATAD  LE    0,4(0,WRKREG)            FLOAT INCREMENT-NOT INDEXED     08000021
STORAF   AE    0,UA(CONREG)             FLOAT ADD ABS. VALUE            08020021
STORFL   STE   0,UA(CONREG)             NEW VALUE X OR Y                08040021
         STE   0,UASCALE(CONREG)        NEW X OR Y VALUE                08060021
*                                                                       08080021
* SET UP V TABLE AND MAKE CHECKS                                        08100021
*                                                                       08120021
INCV     BCT   CNTREG,DOV               DO V TABLE                      08140021
         B     OUT                                                      08160021
DOV      LA    CONREG,4                 SET MODIFIER                    08180021
         L     WRKREG,VTAB              VTAB ADDRESS                    08200021
         CLI   I,C'Y'                   V INCREMENTAL                   08220021
         BE    UINCR                    YES                             08240021
         CLI   I,C'Z'                   V AND U INCREMENTAL             08260021
         BE    UINCR                    YES                             08280021
         B     FLCHK                    NO                              08300021
*                                                                       08320021
* BOTH TABLE VALUES STORED-UPDATE INDEX                                 08340021
*                                                                       08360021
OUT      A     INXREG,FOUR              UPDATE INDEX VALUE              08380021
         STH   INXREG,INDEX             SAVE TABLE INDEX VALUE          08400021
         CLI   F,C'F'                                                   08420021
         BE    CHKSCA                   YES                             08440021
         CLI   S,C'S'                                                   08460021
         BE    FIXSCAL                  YES-SCALE NEW VALUES            08480021
* STORE FIXED UNSCALED VALUES FOR NEXT PT VALUE                         08500021
STOXY    L     VALREG,UA                                                08520021
         STH   VALREG,X2FIN             X2 UNSCALED FIXED VALUE         08540021
         L     VALREG,VA                                                08560021
         STH   VALREG,Y2FIN             Y2 UNSCALED FIXED VALUE         08580021
         B     CHKCNT                   NO                              08600021
CHKSCA   CLI   S,C'S'                   SCALING SPECIFIED               08620021
         BE    FLTSCAL                  YES                             08640021
         B     NOSCALE1                 NO                              08660021
SECOND   BAL   LINREG,SCRNGRD                                           08680021
         CLC   SKIPSW,ONE+2             SKIP PLOTTING IF REQUIRED       08700021
         BE    NOT1                                                     08720021
         CLI   PTYPE,C'B'               FOR CHARACTER MODE              08740021
         BE    BEAMOFF                  POSITION BEAM OFF               08760021
         CLI   PTYPE,C'A'               FOR POINT MODE                  08780021
         BE    BEAMON                   POSITION BEAM ON                08800021
         CLC   COUNT,ONE+2              FOR OTHER THAN                  08820021
         BH    BEAMON                   FIRST POINT,POSITION BEAM ON    08840021
BEAMOFF  MVC   ORDER3,X2FINAL           OTHERWISE INSERT                08860021
         OI    ORDER3,X'40'             BLANK BEAM BIT IN               08880021
         LA    CNTREG,4                 ORDER AND                       08900021
         LA    ADDREG,ORDER3                                            08920021
         BAL   LINREG,STORE             STORE                           08940021
         B     FLOW2                    BACK TO NORMAL FLOW             08960021
BEAMON   CLI   PTYPE,C'B'               IF NOT VECTOR MODE USE          08980021
         BNH   REGOUT                  STANDARD OUTPUT                  09000021
         BAL   LINREG,VECTOR            OTHERWISE GENERATE PSEUDO VEC.  09020021
         B     FLOW2                                                    09040021
REGOUT   MVC   ORDER3,X2FINAL          POSITION AT                      09060021
         LA    ADDREG,ORDER3                                            09080021
         LA    CNTREG,4                 PT2,BEAM ON                     09100021
         BAL   LINREG,STORE             STORE                           09120021
FLOW2    CLI   PTYPE,C'B'               IF CHARACTER                    09140021
         BE    CHAR                     MODE OR                         09160021
         CLI   PTYPE,C'E'               VECTOR AND CHARACTER            09180021
         BE    CHAR                     PLOT CHARACTER                  09200021
         CLI   PTYPE,C'D'               IF NOT POINT-VECTOR MODE        09220021
         BNE   NOT1                     GO TO UPDATE THE COUNTER        09240021
         LA    CNTREG,4                 OTHERWISE REPEAT ORDER TO       09260021
         LA    ADDREG,ORDER3                                            09280021
         BAL   LINREG,STORE             STORE TO INTENSIFY END POINT    09300021
         B     NOT1                     GO TO UPDATE THE COUNTER        09320021
CHAR     BAL   LINREG,PLTCH             GO PLOT A CHARACTER             09340021
         BAL   LINREG,STORE             STORE GRAPHIC ORDERS IN GDOA    09360021
         CLI   PTYPE,C'E'               IF NOT VECTOR CHARACTER MODE    09380021
         BNE   REPTM                    REPEAT ENTER POINT MODE         09400021
         MVI   ORDER1,X'2A'             OTHERWISE REENTER VECTOR MODE   09420021
         MVI   ORDER2,X'02'                                             09440021
         OI    ORDER3,X'40'             TURN BEAM OFF                   09460021
         MVC   GOMODE,ORDER1                                            09480021
         LA    CNTREG,6                 AND REPEAT ORDER                09500021
         LA    ADDREG,ORDER1                                            09520021
         BAL   LINREG,STORE             TO STORE OF CURRENT POSITION    09540021
         B     NOT1                     GET NEXT VALUES                 09560021
REPTM    LA    CNTREG,2                                                 09580021
         LA    ADDREG,ORDER1                                            09600021
         MVI   ORDER1,X'2A'             ORDER FOR POINT PLOTTING        09620021
         MVI   ORDER2,X'00'                                             09640021
         MVC   GOMODE,ORDER1                                            09660021
         BAL   LINREG,STORE             TO STORE ROUTINE                09680021
         B     NOT1                     UPDATE THE COUNTER              09700021
* STORE GRAPHIC DATA IN GDOA FOR POR                                    09720021
* INPUT TO SUBROUTINE                                                   09740021
*   CNTREG = NUMBER OF BYTES OF GRAPHIC DATA TO STORE                   09760021
*   ADDREG = ADDRESS OF THE GRAPHIC DATA                                09780021
*   WKAREG = REGISTER 1 MUST CONTAIN THE WORKAREA ADDRESS               09800021
*   OABREG = ADDRESS OF OACB                                            09820021
STORE    STM   8,12,PORSAVE             SAVE REGISTERS                  09840021
         SR    PASREG,PASREG            CLEAR OVERFLOW INDICATOR        09860021
STORE1   L     OLPREG,16(0,OABREG)      ADDRESS OF OLP FROM OACB        09880021
         LR    WRKREG,CNTREG            LOAD BYTES TO MOVE              09900021
*                                                                       09920021
* CALCULATE ADDRESSES BASED ON N VALUE AND SIZE OF GDOA                 09940021
*                                                                       09960021
STORE2   AR    OLPREG,WRKREG            OLP ADDRESS PLUS N VALUE        09980021
         LA    TEMREG,4                                                 10000021
         AR    TEMREG,OLPREG            OLP PLUS N PLUS 4               10020021
         L     SLOREG,0(OABREG)         SLOA ADDRESS                    10040021
         A     SLOREG,4(OABREG)         ADD LOA EQUALS TOTAL GDOA       10060021
         L     OLPREG,16(0,OABREG)      RESET INITIAL OLP ADDRESS       10080021
         CR    TEMREG,SLOREG                                            10100021
         BNH   OK                                                       10120021
*                                                                       10140021
* NOT ENOUGH ROOM TO STORE ALL OF THE DATA-DETERMINE AMOUNT TO STORE    10160021
*                                                                       10180021
         SR    TEMREG,SLOREG            EQUAL BYTES-CAN'T STORE         10200021
         SR    WRKREG,TEMREG            NUMBER OF BYTES CAN STORE       10220021
*                                                                       10240021
* ANY BYTES TO STORE                                                    10260021
*                                                                       10280021
         C     WRKREG,ZERO                                              10300021
         BNH   STORE4                   LESS OF EQUAL TO ZERO           10320021
         LH    TEMREG,H2A02                                             10340021
         CH    TEMREG,GOMODE                                            10360021
         BH    STORE3A                                                  10380021
         LH    TEMREG,H0003                                             10400021
         NR    TEMREG,WRKREG                                            10420021
         BM    STORE4      GO TO USER OVERFLOW ROUTINE (DAPL)      7468 10440021
STORE3A  SR    CNTREG,WRKREG       BYTES REMAINING                      10460021
         BAL   INTREG,STORE6            LINK INTERNALLY                 10480021
STORE3   LA    PASREG,1                 SET PASS INDICATOR              10500021
*                                                                       10520021
* STORE REGISTERS IN WORKAREA                                           10540021
*                                                                       10560021
         STM   0,15,OVFSAVE             OVERFLOW SAVE IN WORKAREA       10580021
         CLC   ADGOFFSG,ZERO            WAS OFF SCREEN/GRID LOADED      10600021
         BE    LAOVFLO                  NO                              10620021
         SR    WRKREG,WRKREG                                            10640021
         ST    WRKREG,ADGOFFSG          CLEAR ADDRESS                   10660021
         LR    3,1                      SAVE REG 1.                     10680021
         DELETE EP=GOFFSG                                               10700021
         LR    1,3                      RESTORE REG 1.                  10720021
LAOVFLO  L     15,8(0,OABREG)           LOAD OVERFLOW ADDRESS           10740021
         LM    2,12,28(13)              RELOAD USER'S REGISTERS         10760021
         BALR  14,15                    LINK TO ROUTINE-SET RETURN      10780021
         LM    0,15,OVFSAVE             RELOAD AND CONTINUE TO STORE    10800021
         B     STORE1                   GET NEW OLP ADDRESS-CONTINUE    10820021
*                                                                       10840021
* NO SPACE AVAILABLE                                                    10860021
*                                                                       10880021
*                                                                       10900021
STORE4   C     PASREG,ONE               WAS A TRANSFER TO OVERFLOW MADE 10920021
         BL    STORE3                                                   10940021
*                                                                       10960021
* SET ERROR CODE AND RETURN TO POR-LEAVE POR WITH RETURN MACRO          10980021
*                                                                       11000021
         B     ERR24RET                                                 11020021
*                                                                       11040021
*                                                                       11060021
OK       BAL   INTREG,STORE6            LINK INTERNALLY                 11080021
         LM    8,12,PORSAVE            RELOAD REGISTERS                 11100021
         BR    LINREG                                                   11120021
STORE6   LA    TEMREG,255               SET REG. EQUAL TO 255           11140021
STORE6A  CR    WRKREG,TEMREG            IS AMOUNT TO MOVE OVER 255      11160021
         BH    STORE7                                                   11180021
         LR    TEMREG,WRKREG                                            11200021
         S     TEMREG,ONE               COMPENSATE FOR EXTRA BYTE       11220021
         EX    TEMREG,MOVE              MOVE GRAPHIC DATA               11240021
         AR    OLPREG,WRKREG            UPDATE OLP ADDRESS              11260021
         AR    ADDREG,WRKREG            UPDATE DATA ADDR                11280021
         ST    OLPREG,16(0,OABREG)      STORE NEW OLP ADDRESS           11300021
         BR    INTREG                   RETURN INTERNALLY               11320021
STORE7   LR    SLOREG,TEMREG                                            11340021
         S     SLOREG,ONE               COMPENSATE FOR EXTRA BYTE       11360021
         EX    SLOREG,MOVE              MOVE GRAPHIC DATA               11380021
         AR    OLPREG,TEMREG            UPDATE OLP ADDRESS              11400021
         AR    ADDREG,TEMREG            UPDATE INPUT ADDRESS            11420021
         SR    WRKREG,TEMREG           REDUCE BY 255                    11440021
         B     STORE6A                  MAKE NEXT COMPARISON            11460021
MOVE     MVC   0(0,OLPREG),0(ADDREG)    MOVE DATA TO GDOA               11480021
*                                                                       11500021
*    CONVERT  FLOATING  POINT  TO  FIXED  POINT  VALUES                 11520021
*    VALREG CONTAINS THE VALUE TO BE CONVERTED                          11540021
*                                                                       11560021
FIXCONV  ST    1,OVFSAVE                STORE IN FIRST WORD REG. 1      11580021
         TM    OVFSAVE+3,X'07'          TEST LAST THREE BITS            11600021
         BZ    SETMODI                  NO BITS ON SET INDEX TO ZERO    11620021
         LA    TEMREG,4                 SET MODIFIER                    11640021
         B     SAVFLT                   START CONVERSION                11660021
         MVC   GOMODE,CHARMOD                                           11680021
SETMODI  LA    TEMREG,0                 SET MODIFIER TO ZERO            11700021
SAVFLT   ST    VALREG,TEMFLT(TEMREG)    SAVE FLOAT VALUE                11720021
         SR    WRKREG,WRKREG                                            11740021
         ST    WRKREG,TEMFLT+4(TEMREG)  CLEAR SECOND WORD               11760021
         LD    6,TEMFLT(TEMREG)         VALUE TO FLOAT REGISTERS        11780021
         N     VALREG,FCHAR                                             11800021
         BE    FLERR1                   CHARACTERISTIC IS ZERO          11820021
         AE    6,FLPT5                  ADD .5 TO ROUND                 11840021
         AW    6,X4E                    ADD UNNORMALIZED-RIGHT JUSTIFY  11860021
         STD   6,TEMFLT(TEMREG)         SAVE VALUES                     11880021
         L     WRKREG,TEMFLT+4(TEMREG)  CHECK SECOND WORD               11900021
         N     WRKREG,MZERO             CHECK BIT 32                    11920021
         BM    ERR12RET                 INDICATE ERROR                  11940021
         L     WRKREG,TEMFLT(TEMREG)                                    11960021
         N     WRKREG,BYTE123                                           11980021
         BM    ERR12RET                                                 12000021
         L     WRKREG,TEMFLT(TEMREG)                                    12020021
         N     WRKREG,MZERO             DROP CHARACTERISTIC             12040021
         L     VALREG,TEMFLT+4(TEMREG)  NEW FIXED VALUE                 12060021
         LTR   WRKREG,WRKREG                                            12080021
         BNL   NOTNEG                   NOT NEGATIVE                    12100021
         LNR   VALREG,VALREG            TAKE TWO'S COMPLIMENT           12120021
NOTNEG   BR    INTREG                   RETURN TO N S I                 12140021
FLERR1   CE    6,ZERO                   IS TOTAL VALUE ZERO             12160021
         BE    NOTNEG                   RETURN                          12180021
         B     ERR12RET                 SET ERROR CODE AND RETURN       12200021
*                                                                       12220021
*    CONVERT  FIXED  POINT  TO  FLOATING  POINT  VALUES                 12240021
*    VALREG CONTAINS THE VALUE TO BE CONVERTED                          12260021
*                                                                       12280021
FLTCONV  O     VALREG,X6                EXPONENT OF 6                   12300021
         ST    VALREG,OVFSAVE                                           12320021
         LE    0,OVFSAVE                LOAD TO FLOAT REG.              12340021
         AE    0,X6                     NORMALIZE                       12360021
         STE   0,OVFSAVE                                                12380021
         L     VALREG,OVFSAVE           FLOAT PT. VALUE IN REG.         12400021
         BR    LINREG                                                   12420021
*   ROUTINE TO CHECK IF PT. IS OUTSIDE OF GRID BOUNDARY                 12440021
*                                                                       12460021
GRLCHK   LH    VALREG,X1                X1                              12480021
         C     VALREG,UASCALE           X VALUE COMPARED TO X1          12500021
         BH    SETIND                   OFF GRID LIMIT                  12520021
         LH    VALREG,X2                X2                              12540021
         C     VALREG,UASCALE           X VALUE COMPARED TO X2          12560021
         BL    SETIND                   OFF GRID LIMIT                  12580021
         LH    VALREG,Y1                Y1                              12600021
         C     VALREG,VASCALE           Y VALUE COMPARED TO Y1          12620021
         BH    SETIND                   OFF GRID                        12640021
         LH    VALREG,Y2                Y2                              12660021
         C     VALREG,VASCALE           Y VALUE COMPARED TO Y2          12680021
         BL    SETIND                   OFF GRID                        12700021
         MVI   OFFSW,X'00'              WITHIN LIMIT SET OFF            12720021
         B     OV10                                                     12740021
SETIND   MVI   OFFSW,X'11'              SET INDICATOR                   12760021
         BR    LINREG                   RETURN                          12780021
OV10     BR    LINREG                   RETURN                          12800021
*                                                                       12820021
*                                                                       12840021
*    ROUTINE TO CHECK IF POINT IS OFF THE SCREEN                        12860021
*                                                                       12880021
SCLCHK   L     VALREG,UASCALE           GET X VALUE                     12900021
         C     VALREG,ZERO              X VALUE COMPARED TO ZERO        12920021
         BL    SETBITS                  OFF SCREEN                      12940021
         C     VALREG,HIGH              X VALUE COMPARED TO 4095        12960021
         BH    SETBITS                  OFF SCREEN                      12980021
         L     VALREG,VASCALE           GET Y VALUE                     13000021
         C     VALREG,ZERO              Y VALUE COMPARED TO ZERO        13020021
         BL    SETBITS                  OFF SCREEN                      13040021
         C     VALREG,HIGH              Y VALUE COMPARED TO 4095        13060021
         BH    SETBITS                  OFF SCREEN                      13080021
         MVI   OFFSW,X'00'              WITHIN LIMIT SET OFF            13100021
         BR    LINREG                   RETURN                          13120021
SETBITS  MVI   OFFSW,X'11'              SET INDICATOR                   13140021
         BR    LINREG                   RETURN                          13160021
*                                                                       13180021
*                                                                       13200021
SCRNGRD  ST    LINREG,RSAVE             SAVE THE BRANCH REGISTER        13220021
         L     WRKREG,WRTADDR           GET BOUNDARY CHECK RT ADDRESS   13240021
         BALR  LINREG,WRKREG             AND BRANCH TO CHECK            13260021
         CLC   SWSTATUS,STATUS1         CHECK THE SWS STATUS IF STATUS1 13280021
         BE    RESREG                   ARE ALL POINTS ON ANSWER  YES   13300021
OPTIONA  CLI   SG,C'A'                  OTHERWISE OFFSG CONDITION EXIST 13320021
         BNE   OPTIONB                   CHECK USER-SPECIFIED OPTION    13340021
         BAL   LINREG,ERR44             IF A OPTION SET ERR CODE AND    13360021
         B     ANALOFF                   ANALIZE OFF STATUS TO HANDLE   13380021
OPTIONB  CLI   SG,C'B'                  IS B OPTION SPECIFIED           13400021
         BNE   OPTIONC                  IF NOT TEST FOR C               13420021
         BAL   LINREG,ERR48             IF YES SET ERR CODE AND         13440021
         B     ANALOFF                   ANALIZE OFF STATUS TO HANDLE   13460021
OPTIONC  CLI   SG,C'C'                  IS C OPTION SPECIFIED           13480021
         BNE   OPTIOND                  IF NOT TEST FOR D               13500021
         BAL LINREG,SCLCHK              CHECK FURTHER IF POINT          13520021
         CLI   OFFSW,X'11'               OFF SCREEN                     13540021
         BE    ERR32RET                 IFF OFF SCREEN IMMEDIATE RET    13560021
         LA    15,32                    OTHERWISE SET ERROR CODE AND    13580021
         BAL   LINREG,ERRCNT             CONTINUE THE JOB               13600021
         BAL   LINREG,GRLCHK            CHECK FURTHER FOR GRID          13620021
         B     ANALOFF                  GO TO ANALIZE OFF STATUS        13640021
OPTIOND  CLI   SG,C'D'                  IS OPTION D SPECIFIED           13660021
         BNE   ASSUMEE                  IF NOT ASSUME OPTION E          13680021
         B     ERR28RET                 IMMEDIATE ERROR RETURN          13700021
ASSUMEE  B     ERR32RET                 IMMEDIATE ERROR RETURN          13720021
         BE    ERR32RET                 IF OFF SCREEN IMMEDIATE RETURN  13740021
         BAL   LINREG,SCLCHK            IF OPTION C TEST FOR OFF SCRN   13760021
         LA    15,32                    OTHERWISE SET ERROR CODE        13780021
         BAL   LINREG,ERRCNT            UPDATE ERROR COUNT              13800021
         MVI   OFFSW,X'11'              RESTORE OFF BOUNDARY STATUS     13820021
         B     RESREG                   CONTINUE JOB                    13840021
SETSKIP  L     VALREG,ONE               SET SWITCH TO SKIP TO NEXT      13860021
         STH   VALREG,SKIPSW            POINT                           13880021
         B     RESREG                   AND RETURN VIA RESTORE REG      13900021
ANALOFF  CLI   PTYPE,C'B'               IF NOT VECTOR                   13920021
         BH    ANALVEC                  TYPE SKIP IT IF                 13940021
         CLC   SWSTATUS,STATUS3         IT IS POINT 2 OFF               13960021
         BE    SETSKIP                                                  13980021
         B     RESREG                   OTHERWISE CONTINUE              14000021
ANALVEC  CLC   COUNT,ONE+2              IF FIRST POINT OFF, GET         14020021
         BNH   SETSKIP                  GET ANOTHER                     14040021
         STM   13,0,PORSAVE             SAVE REGISTERS                  14060021
         ST    13,OVFSAVE+4             SAVE POR SAVEAREA CHAINING ADDR 14080021
         ST    15,SVR15                 SAVE ERROR REGISTER             14100021
         LA    13,OVFSAVE               LOAD GOFFSG RT SAVEAREA ADDR    14120021
         LR    WRKREG,1                 SAVE REG1-WKAREA POINTER        14140021
         CLC   GOFFSGAD,ZERO            CHECK IF GOFFSG RT ADDR AREA 0  14160021
         BNE   OFFHDLG                  IF NOT RT BROUGHT IN GO TO HDL  14180021
         LA    1,SABL                   LOAD 24-WORD PARTAB START ADDR  14200021
         LOAD  EP=GOFFSG                RETAIN THE MODULE               14220021
         LR    1,WRKREG                 RESTORE REGISTER 1              14240021
         ST    0,GOFFSGAD               SAVE GOFFSG RT ADDRESS          14260021
OFFHDLG  L     15,GOFFSGAD              LOAD GOFFSG RT ADDRESS          14280021
         LA    1,SABL                   LOAD 24-WORD PARTAB ADDR        14300021
         BALR  14,15                    BRANCH TO GOFFSG RT             14320021
         LR    1,WRKREG                 RESTORE REG 1                   14340021
LINKOUT  LM    13,0,PORSAVE             RESTORE REG 13 TO 0             14360021
         L     15,SVR15                 RESTORE ERROR REGISTER          14380021
*   ANALIZE THE RESPONSE OF GOFFSG ROUTINE AND GENERATE PROPER DATA     14400021
ANALRES  CLC   NI,ZERO                  IS NI=0                         14420021
         BE    NOINTS                   IF SO GO TO NO INTERSECT RT     14440021
         CLC   NI,ONE                   IS NI=1                         14460021
         BE    ONEINTS                  IF SO GO TO ONE INTERSECT RT    14480021
BOTHOUT  MVC   X1FINAL,XYINT1           OTHERWISE GDV I1X,I1Y,B         14500021
         MVC   X2FINAL,XYINT2                                           14520021
         MVC   ORDER3,X1FINAL           AND GDV I2X,I2Y,U               14540021
         MVC   ORDER4,X2FINAL                                           14560021
         OI    ORDER3,X'40'                                             14580021
         LA    CNTREG,8                 LOAD BYTE NUMBER                14600021
         LA    ADDREG,ORDER3                                            14620021
         BAL   LINREG,STORE             GIVE TO STORE ROUTINE           14640021
         B     SETSKIP                  SKIP THE NEXT POINT             14660021
NOINTS   CLC   SWSTATUS,STATUS2         SEE IF PT1 OFF PT2 ON           14680021
         BE    NOINTSA                  IF SO IT'S NO INTS CONDITION A  14700021
         B     SETSKIP                  GO ON TO NEXT POINT             14720021
NOINTSA  MVC   X1FINAL,X2FINAL          GDV X2,Y2,B                     14740021
         MVC   ORDER3,X1FINAL           AND GDV X2,Y2,U                 14760021
         MVC   ORDER4,X2FINAL                                           14780021
         OI    ORDER3,X'40'                                             14800021
         LA    CNTREG,8                 AND GIVE TO STORE ROUTINE       14820021
         LA    ADDREG,ORDER3                                            14840021
         B     STOREP                                                   14860021
ONEINTS  CLC   SWSTATUS,STATUS2         SEE IF PT1 OFF PT2 ON           14880021
         BE    ONEINTSA                 IF SO GO TO ONE INTS CONDITIONA 14900021
         CLC   SWSTATUS,STATUS3         SEE IF PT1 ON PT2 OFF           14920021
         BE    ONEINTSB                 IF SO GO TO ONE INTS CONDITIONB 14940021
         B     BOTHOUT                                                  14960021
ONEINTSA MVC   X1FINAL,XYINT1           GENERATE I1X,I1Y,B              14980021
         MVC   ORDER3,X1FINAL                                           15000021
         OI    ORDER3,X'40'             BLAND BEAM BIT                  15020021
         LA CNTREG,4                    AND GIVE TO STORE ROUTINE       15040021
         LA    ADDREG,ORDER3                                            15060021
         B     STOREP                                                   15080021
ONEINTSB MVC   X2FINAL,XYINT1                                           15100021
         MVC   ORDER3,X2FINAL                                           15120021
         LA CNTREG,4                    GDVI1X,I1Y,U AND THEN STORE     15140021
         LA    ADDREG,ORDER3                                            15160021
         BAL   LINREG,STORE             STORE THE POINT AND             15180021
         B     SETSKIP                  AND SKIP ANYTHING ELSE          15200021
STOREP   BAL   LINREG,STORE                                             15220021
RESREG   L     LINREG,RSAVE             RESTORE THE L INE REGISTER      15240021
         BR    LINREG                   AND RETURN                      15260021
* SUBROUTINE TO PLOT A CHARACTER                                        15280021
PLTCH    CLI   E,C'O'                   NO OVERLAP                      15300021
         BE    OV9                      YES-NO OVER LAP PERMITTER       15320021
         B     PLTCH1                   VECTOR AND CHAR OR VECTOR ONLY  15340021
OV9      LH    VALREG,X2FIN             X2                              15360021
         SH    VALREG,X1FIN             X2-X1                           15380021
         LPR   XREG,VALREG              ABSOLUTE OF DELTA X             15400021
         C     XREG,EIGHT                                               15420021
         BH    PLTCH1                   MORE THAN EIGHT                 15440021
         LH    VALREG,Y2FIN             Y2                              15460021
         SH    VALREG,Y1FIN             Y2-Y1                           15480021
         LPR   YREG,VALREG              ABSOLUTE OF DELTA Y             15500021
         C     YREG,EIGHT                                               15520021
         BH    PLTCH1                   MOVE THAN EIGHT                 15540021
*                                                                       15560021
* DIFFERENCE IS LESS THAN EIGHT BETWEEN POINTS                          15580021
*                                                                       15600021
         L     VALREG,X1FINAL           X1,Y1                           15620021
         ST    VALREG,X2FINAL           STORE X1,Y1 OVER X2,Y2          15640021
         B     NOT1                     CHECK COUNT                     15660021
PLTCH1   MVC   ORDER5,CHARMOD           MODE AND CHARACTER SIZE         15680021
         MVC   ORDER6,SYMBOL            LETTER                          15700021
         MVI   ORDER7,X'00'             NULL CHARACTER                  15720021
         LA    CNTREG,4                 COUNT TO MOVE                   15740021
         LA    ADDREG,ORDER5                                            15760021
         BR    LINREG                                                   15780021
*                                                                       15800021
*        PSUEDO VECTOR GENERATOR                                        15820021
*        THIS ROUTINE TAKES ADVANTAGE OF THE LIMITED                    15840021
*        VECTOR CAPABILITY OF A 2250 WITHOUT THE ABSOLUTE               15860021
*        VECTOR GRAPHICS FEATURE                                        15880021
*                                                                       15900021
VECTOR   ST    LINREG,RSAVE             SAVE BRANCH REGISTER            15920021
         L     VALREG,X1FINAL           GET X1 AND Y1                   15940021
         ST    VALREG,PT1VEC            TEMP CALCULATIONS               15960021
         L     VALREG,X2FINAL           X2,Y2                           15980021
         ST    VALREG,PT2VEC            TEMP CALCULATIONS               16000021
* DETERMINE DELTA X AND DELTA Y                                         16020021
         LH    VALREG,X2FIN             X2                              16040021
         SH    VALREG,X1FIN             X2-X1                           16060021
         STH   VALREG,DELTAX            SAVE DELTA X                    16080021
         LPR   XREG,VALREG              ABSOLUTE OF DELTA X             16100021
*                                                                       16120021
         LH    VALREG,Y2FIN             Y2                              16140021
         SH    VALREG,Y1FIN             Y2-Y1                           16160021
         STH   VALREG,DELTAY            SAVE DELTA  Y                   16180021
         LPR   YREG,VALREG              ABSOLUTE OF DELTA Y             16200021
*                                                                       16220021
* IS DELTA X EQUAL TO ZERO                                              16240021
*                                                                       16260021
         CLC   DELTAX,ZERO              DELTA X EQUAL ZERO              16280021
         BE    SETCNT                   LINE IS VERTICAL-ENTER ORDERS   16300021
         CLC   DELTAY,ZERO              DELTA Y EQUAL ZERO              16320021
         BNE   DETPTS                   DELTA X AND DELTA Y HAVE VALUES 16340021
* ON DROP THRU LINE IS HORIZONTAL                                       16360021
* HORIZONTAL LINE-ENTER GRAPHIC ORDERS ABSOLUTE VECTOR MODE             16380021
SETCNT   LA    CNTREG,10                TEN BYTES THIS PATH             16400021
         LA    ADDREG,ORDER1            ORDER ADDRESS                   16420021
* ENTER ABSOLUTE VECTOR MODE                                            16440021
NOMODE   MVC   ORDER3,X1FINAL           OLD PT.                         16460021
         OI    ORDER3,X'40'             BLANK BIT                       16480021
         MVC   ORDER4,X2FINAL           NEW PT.                         16500021
         BAL   LINREG,STORE             STORE GRAPHIC ORDERS IN GDOA    16520021
ENDVEC   L     LINREG,RSAVE RELOAD LINE REGISTER                        16540021
         BR    LINREG                   RETURN                          16560021
*                                                                       16580021
*                                                                       16600021
* DETERMINE INTERMEDIATE POINT                                          16620021
DETPTS   SR    CONREG,CONREG            CLEAR MODIFIER                  16640021
         CR    XREG,YREG                                                16660021
         BH    NPATH                    DELTA  X LESS THAN DELTA Y      16680021
         STH   YREG,NC                  SET NC=YREG                     16700021
         STH   YREG,NT                  SET NT=YREG                     16720021
         STH   XREG,NR                  SET NR=XREG                     16740021
         LH    VALREG,NR                AND NA                          16760021
         SRA   VALREG,1(0)              EQUAL TO                        16780021
         STH   VALREG,NA                NR/2                            16800021
OVCHG    LH    VALREG,NC                WHEN NC =0 ALL DONE             16820021
         CH    VALREG,ZERO                                              16840021
         BNH   ENDVEC                                                   16860021
         LH    VALREG,DELTAY                                            16880021
         LPR   YREG,VALREG                                              16900021
         LH    VALREG,DELTAX                                            16920021
         LPR   XREG,VALREG                                              16940021
         LH    VALREG,NA                                                16960021
         AH    VALREG,NR                NA=NA+NR                        16980021
         STH   VALREG,NA                                                17000021
         CH    VALREG,NT                IF NA GREATER OR EQUAL TO NT    17020021
         BNL   ANG45                    USE 45 DEGREE LINE              17040021
         CR    YREG,XREG                IF ABS. VALUE DELTA Y GREATER   17060021
         BH    ROUTE2                   THAN ABS.VALUE DELTAX-ROUTE2    17080021
         LH    VALREG,DELTAX            IF DELTA X LESS THAN 0          17100021
         CH    VALREG,ZERO                                              17120021
         BL    XNEG                     GO TO XNEG                      17140021
         LH    VALREG,PT1VE             OTHERWISE                       17160021
         A     VALREG,EIGHT             INCREMENT X ONE SMALL DELTA(SMD 17180021
         STH   VALREG,PT1VE                                             17200021
         B     NCDECR                                                   17220021
NPATH    STH   XREG,NC                                                  17240021
         STH   XREG,NT                                                  17260021
         STH   YREG,NR                                                  17280021
         LH    VALREG,NR                                                17300021
         SRA   VALREG,1(0)                                              17320021
         STH   VALREG,NA                                                17340021
         B     OVCHG                                                    17360021
ROUTE2   LH    VALREG,DELTAY            IF DELTAX IS ZERO AND Y         17380021
         CH    VALREG,ZERO              IS       LESS THAN ZERO         17400021
         BL    YNEG                     USE YNEG                        17420021
         LH    VALREG,PT2VE             OTHERWISE                       17440021
         A     VALREG,EIGHT             IMCREMENT Y                     17460021
         STH   VALREG,PT2VE             ONE SMD                         17480021
         B     NCDECR                                                   17500021
XNEG     LH    VALREG,PT1VE             DECREMENT                       17520021
         S     VALREG,EIGHT             X BY ONE SMD                    17540021
         STH   VALREG,PT1VE                                             17560021
         B     NCDECR                                                   17580021
YNEG     LH    VALREG,PT2VE             DECREMENT Y                     17600021
         S     VALREG,EIGHT             BY ONE SMD                      17620021
         STH   VALREG,PT2VE            STUFF IT AWAY                    17640021
         B     NCDECR                                                   17660021
ANG45    LH    VALREG,DELTAX            IF DELTA X IS LESS THAN         17680021
         CH    VALREG,ZERO              ZERO                            17700021
         BL    ROUTE3                   GO TO ROUTE3                    17720021
         LH    VALREG,DELTAY            IF DELTAY IS                    17740021
         CH    VALREG,ZERO              LESS THAN ZERO                  17760021
         BL    XPYN                     GO TO XPYN                      17780021
         LH    VALREG,PT1VE             OTHERWISE INCREMENT             17800021
         A     VALREG,EIGHT             BOTH BY ONE SMD                 17820021
         STH   VALREG,PT1VE                                             17840021
         LH    VALREG,PT2VE                                             17860021
         A     VALREG,EIGHT                                             17880021
         STH   VALREG,PT2VE                                             17900021
         B     NADECR                                                   17920021
*                                                                       17940021
ROUTE3   LH    VALREG,DELTAY            IF BOTH DELTA X AND Y ARE       17960021
         CH    VALREG,ZERO              LESS THAN ZERO                  17980021
         BL    BTHNEG                   GO TO BTHNEG                    18000021
         LH    VALREG,PT1VE             OTHERWISE                       18020021
         S     VALREG,EIGHT             DECREMENT X AND INCREMENT Y     18040021
         STH   VALREG,PT1VE             BY ONE SMD                      18060021
         LH    VALREG,PT2VE                                             18080021
         A     VALREG,EIGHT                                             18100021
         STH   VALREG,PT2VE                                             18120021
         B     NADECR                                                   18140021
*                                                                       18160021
XPYN     LH    VALREG,PT1VE             INCREMENT X                     18180021
         A     VALREG,EIGHT             AND DECREMENT Y BY ONE SMD      18200021
         STH   VALREG,PT1VE                                             18220021
         LH    VALREG,PT2VE                                             18240021
         S     VALREG,EIGHT                                             18260021
         STH   VALREG,PT2VE                                             18280021
         B     NADECR                                                   18300021
*                                                                       18320021
BTHNEG   LH    VALREG,PT1VE             DECREMENT X AN Y BY ONE SMD     18340021
         S     VALREG,EIGHT                                             18360021
         STH   VALREG,PT1VE                                             18380021
         LH    VALREG,PT2VE                                             18400021
         S     VALREG,EIGHT                                             18420021
         STH   VALREG,PT2VE                                             18440021
NADECR   LH    VALREG,NA                                                18460021
         SH    VALREG,NT                SUBTRACT NT FROM NA             18480021
         STH   VALREG,NA                                                18500021
NCDECR   LH    VALREG,NC                SUBTRACT ONE SMD FROM ABS.VALUE 18520021
         S     VALREG,EIGHT             OF THE LARGEST DELTA            18540021
         STH   VALREG,NC                SAVE FOR COMPLETION TEST        18560021
         MVC   ORDER3,PT1VEC            OUTPUT SMALL VECTOR             18580021
         LA    CNTREG,4                 USING THE STORE ROUTINE         18600021
         LA    ADDREG,ORDER3                                            18620021
         BAL   LINREG,STORE                                             18640021
         B     OVCHG                    AND CONTINUE                    18660021
*        XYLCHK     SUBROUTINE                                          18680021
*        ADDRESS OF XYLIM TABLE IN  XYLREG BEFORE  BAL                  18700021
XYLCHK   LA    CONREG,4                SET LOOP CONTROL                 18720021
         LA    INXREG,0                 SET  INDEX                      18740021
XYLLOOP  LH    TEMREG,X1(INXREG)        X1,Y1,X2,Y2                     18760021
         C     TEMREG,ZERO                                              18780021
         BL    ERR4RET                                                  18800021
         C     TEMREG,HIGH                                              18820021
         BH    ERR4RET                                                  18840021
         A     INXREG,TWO                                               18860021
         BCT   CONREG,XYLLOOP                                           18880021
         CLC   X1,X2                    X1 COMPARED TO X2               18900021
         BNL   ERR4RET                                                  18920021
         CLC   Y1,Y2                    Y1 COMPARED TO Y2               18940021
         BNL   ERR4RET                                                  18960021
         BR    INTREG                   RETURN TO MAIN LINE             18980021
ERR4RET  LA    15,4                     XYLIM X1,Y2,X2,Y2 LIMIT ERROR   19000021
         B     ERRCNTR                                                  19020021
ERR8RET  LA    15,8                                                     19040021
         B     ERRCNTR                                                  19060021
ERR12RET LA    15,12                    FLOATING POINT ERROR DETECTED   19080021
         B     ERRCNTR                                                  19100021
ERR16RET LA    15,16                    U1,V1 GREATER THAN U2,V2        19120021
         B     ERRCNTR                                                  19140021
ERR20RET LA    15,20                                                    19160021
         B     ERRCNTR                                                  19180021
ERR24RET LA    15,24                    USERS OVERFLOW-OLP NOT RESET    19200021
         B     ERRCNTR                                                  19220021
ERR28RET LA    15,28                                                    19240021
         B     ERRCNTR                                                  19260021
ERR32RET LA    15,32                    OPTION C                        19280021
         B     ERRCNTR                                                  19300021
ERR40    LA    15,40                    PARAMETERS ERROR-NOT SERIOUS    19320021
         B     ERRCNT                   ADD TO COUNT                    19340021
ERR44    LA    15,44                                                    19360021
         B     ERRCNT                                                   19380021
ERR48    LA    15,48                                                    19400021
         B     ERRCNT                   ADD TO COUNT                    19420021
ERRCNTR  LA    LINREG,RET                                               19440021
ERRCNT   L     TEMREG,ERRCOUNT                                          19460021
         A     TEMREG,ONE                                               19480021
         ST    TEMREG,ERRCOUNT                                          19500021
         BR    LINREG                                                   19520021
*                                                                       19540021
*   RET SUBROUTINE TESTS COUNT IN WORK AREA,(ERRCOUNT) AND              19560021
*   SETS BIT IN SIGN POSITION OF REG. 15 IF MULTIBLE ERRORS             19580021
*   (MORE THAN ONE)                                                     19600021
RET      CLC   ADGOFFSG,ZERO            HAS OFF SCREEN/GRID ROUTINE     19620021
         BE    RET1                                                     19640021
         ST    15,SVR15                 SAVE ERROR REGISTER             19660021
         LR    WRKREG,1                 SAVE REGISTER 1                 19680021
         DELETE EP=GOFFSG                                               19700021
         LR    1,WRKREG                 RESTORE REGISTER 1              19720021
         L     15,SVR15                 RESTORE ERROR REGISTER          19740021
RET1     LA    TEMREG,1                                                 19760021
         C     TEMREG,ERRCOUNT                                          19780021
         BL    SETBIT                                                   19800021
* RESTORE PROGRAM MASK TO SETTING UPON ENTRY                            19820021
RETMACRO L     WRKREG,MASKSV                                            19840021
         SPM   WRKREG                                                   19860021
         RETURN (14,12),T,RC=(15)                                       19880021
SETBIT   O     15,MZERO                                                 19900021
         B     RETMACRO                                                 19920021
BYCT     DC    F'120'                                                   19940021
ZERO     DC    F'0'                     ZERO                            19960021
MZERO    DC    X'80000000'              MINUS ZERO                      19980021
ONE      DC    F'1'                                                     20000021
TWO      DC    F'2'                                                     20020021
MTWO     DC    X'FFFFFFFE'              MINUS TWO                       20040021
FOUR     DC    F'4'                                                     20060021
EIGHT    DC    F'8'                                                     20080021
HIGH     DC    F'4095'                  HIGH LIMIT                      20100021
BYTE3    DC    X'0000FF00'              MASK SYMBOL-EBCDIC CODE         20120021
BYTE123  DC    X'00FFFFFF'                                              20140021
ALLFF    DC    X'FFFFFFFF'              ALL BITS                        20160021
X6       DC    X'46000000'              EXPONENT OF SIX                 20180021
         DS    0D                       ALIGN BOUNDARY                  20200021
X4E      DC    X'4E00000000000000'                                      20220021
FLPT5    DC    E'.5'                                                    20240021
FCHAR    DC    X'7F000000'              MASK FOR CHARACTERISTIC         20260021
LOHI     DC    F'0'                     X1,Y1                           20280021
         DC    H'4095'                  UPPER LIMIT                     20300021
         DC    H'4095'                  UPPER LIMIT                     20320021
STATUS1  DC    H'0'                     BOTH PT1 AND PT2 WITHIN LIMITS  20340021
H2A02    DC    X'2A02'                                                  20360021
H0003    DC    H'0003'                                                  20380021
STATUS2  DC    X'1100'                  PT1 OFF PT2 ON                  20400021
STATUS3  DC    X'0011'                  PT1 ON PT2 OFF                  20420021
* REGISTER ASSIGN MENT                                                  20440021
VALREG   EQU   0                                                        20460021
PASREG   EQU   0                                                        20480021
WKAREG   EQU   1                                                        20500021
XYLREG   EQU   2                                                        20520021
OBPREG   EQU   2                        MUST BE IN THIS ORDER           20540021
PATREG   EQU   3                        MUST BE IN THIS ORDER           20560021
WRKREG   EQU   4                                                        20580021
EREG     EQU   4                        EVEN REGISTER                   20600021
XREG     EQU   5                        ODD  REGISTER                   20620021
CNTREG   EQU   5                                                        20640021
TEMREG   EQU   6                                                        20660021
OREG     EQU   6                        EVEN REGISTER                   20680021
YREG     EQU   7                        ODD REGISTER                    20700021
ADDREG   EQU   7                                                        20720021
INXREG   EQU   8                                                        20740021
SLOREG   EQU   8                                                        20760021
OABREG   EQU   10                                                       20780021
INTREG   EQU   11                                                       20800021
OLPREG   EQU   12                                                       20820021
CONREG   EQU   12                                                       20840021
LINREG   EQU   14                                                       20860021
* PARTAB DEFINED STORAGE MAP                                            20880021
* PATREG EQUALS A GENERAL REGISTER                                      20900021
PARTAB   DSECT                                                          20920021
XYLIM    DS    CL4                      XYLIM ADDRESS                   20940021
UTAB     DS    CL4                      UTAB  ADDRESS                   20960021
VTAB     DS    CL4                      VTAB  ADDRESS                   20980021
F        DS    CL1                      MODE OF INPUT                   21000021
S        DS    CL1                      SCALE OR NO SCALE               21020021
CSIZE    DS    CL1                      CHARACTER SIZE                  21040021
CMOD     DS    CL1                      PROTECTED OR UNPROTECTED MODE   21060021
A        DS    CL1                      RELATIVE OR ABSOLUTE            21080021
I        DS    CL1                      INCREMENT OR NO INCREMENT       21100021
PTYPE    DS    CL1                      PLOT TYPE                       21120021
SG       DS    CL1                                                      21140021
N        DS    CL2                      NUMBER OF POINTS TO PLOT        21160021
SYMBOL   DS    CL1                      LETTER TO PLOT                  21180021
E        DS    CL1                      OVERLAP OR NO OVERLAP           21200021
* XYLIM TABLE DEFINED.STORAGE MAP                                       21220021
* XYLREG EQUALS A GENERAL REGISTER                                      21240021
XYLIMTB  DSECT                                                          21260021
X1       DS    CL2                      LOWER LEFT COORDINATE VALUE     21280021
Y1       DS    CL2                      LOWER LEFT COORDINATE VALUE     21300021
X2       DS    CL2                      UPPER RIGHT COORDINATE VALUE    21320021
Y2       DS    CL2                      UPPER RIGHT COORDINATE VALUE    21340021
U1       DS    CL4                      LOWER LEFT SCALING COORDINATE   21360021
U2       DS    CL4                      LOWER LEFT SCALING COORDINATE   21380021
V1       DS    CL4                      UPPER RIGHT SCALING COORDINATE  21400021
V2       DS    CL4                      UPPER RIGHT SCALING COORDINATE  21420021
* WORK AREA DEFINED STORAGE MAP                                         21440021
* WKAREG EQUALS A GENERAL REGISTER                                      21460021
WKAREA   DSECT                                                          21480021
         DS    0D                                                       21500021
OVFSAVE  DS    0CL72                                                    21520021
TEMFLT   DS    0CL8                                                     21540021
         DS    CL72                                                     21560021
ERRCOUNT DS    CL4                      COUNT OF PARAMETER ERRORS       21580021
INCOUNT  DS    CL4                                                      21600021
         ORG   INCOUNT                                                  21620021
INDEX    DS    CL2                      TABLE INDEX OF UTAB OR VTAB     21640021
COUNT    DS    CL2                      NUMBER OF POINTS PROCESSED      21660021
MASKSV   DS    F                   SAVE SETTING OF USER PROGRAM MASK    21680021
FX1      DS    CL4                      FLOAT X1                        21700021
FY1      DS    CL4                      FLOAT Y1                        21720021
FX2      DS    CL4                      FLOAT X2                        21740021
FY2      DS    CL4                      FLOAT Y2                        21760021
UA       DS    CL4                      ABSOLUTE FLOAT OR FIXED UA      21780021
VA       DS    CL4                      ABSOLUTE FLOAT OR FIXED VA      21800021
X1FINAL  DS    CL4                      X1,Y1                           21820021
         ORG   X1FINAL                                                  21840021
X1FIN    DS    CL2                      X1                              21860021
Y1FIN    DS    CL2                      Y1                              21880021
X2FINAL  DS    CL4                      X2,Y2                           21900021
         ORG   X2FINAL                                                  21920021
X2FIN    DS    CL2                      X2                              21940021
Y2FIN    DS    CL2                      Y2                              21960021
WRTADDR  DS    CL4                      ADDR OF GRID OR SCREEN CHECK RT 21980021
GOFFSGAD DS    CL4                      GOFFSG RT ADDR AREA             22000021
SWSTATUS DS    CL2                      SWITCH STATUS OF PT1 AND PT2    22020021
         ORG   SWSTATUS                                                 22040021
PT1SW    DS    CL1                      PREVIOUS STATUS                 22060021
OFFSW    DS    CL1                      CURRENT STATUS                  22080021
SKIPSW   DS    CL2                      SET TO ONE TO SKIP POINT        22100021
NC       DS    CL2                                                      22120021
NT       DS    CL2                                                      22140021
NR       DS    CL2                                                      22160021
NA       DS    CL2                                                      22180021
RSAVE    DS    CL4                      PLACE TO SAVE LINE REGISTER     22200021
SVR15    DS    CL4                      PLACE TO SAVE ERROR REGISTER    22220021
ORDER1   DS    CL1                      GRAPHICORDERS-MODE              22240021
ORDER2   DS    CL1                                                      22260021
ORDER3   DS    CL4                      PT. TO PLOT                     22280021
ORDER4   DS    CL4                                                      22300021
         ORG   ORDER4                                                   22320021
ORDER5   DS    CL2                                                      22340021
ORDER6   DS    CL1                                                      22360021
ORDER7   DS    CL1                                                      22380021
ORDER8   DS    CL2                                                      22400021
EPRGMOD  DS    CL4                                                      22420021
         ORG   EPRGMOD                                                  22440021
EOPRG    DS    CL2                      LAST PT. INDICATOR              22460021
CHARMOD  DS    CL2                      ORDER FOR CHARACTER AND MODE    22480021
PT1VEC   DS    CL4                      SIMULATED VECTOR X1,Y1          22500021
         ORG   PT1VEC                                                   22520021
PT1VE    DS    CL2                                                      22540021
PT2VE    DS    CL2                                                      22560021
PT2VEC   DS    CL4                      SIMULATED VECTOR X2,Y2          22580021
         ORG   PT2VEC                                                   22600021
PT2VECT  DS    CL2                                                      22620021
PT2VECS  DS    CL2                                                      22640021
DELTAX   DS    CL2                      DELTA X                         22660021
DELTAY   DS    CL2                      DELTA Y                         22680021
TOTAL    DS    CL4                                                      22700021
         ORG   TOTAL                                                    22720021
INTEGER  DS    CL2                      INTEGER-SIMULATED VECTOR        22740021
FRACTION DS    CL2                      FRACTION-SIMULATED VECTOR       22760021
ABVTEMP  DS    CL4                      VECTOR MODE-TEMP STORAGE        22780021
         ORG   ABVTEMP                                                  22800021
ABVMODE  DS    CL2                      VECTOR MODE INDICATOR           22820021
TEMP     DS    CL2                      TEMP STORAGE                    22840021
XYINCR   DS    CL4                      CHANGING X OR Y VALUE           22860021
PORSAVE  DS    CL28                                                     22880021
ADGOFFSG DS    CL4                      ADDRESS OF GOFFSG               22900021
SABL     DS    CL4                      ADDRESS OF BOUNDARY             22920021
UASCALE2 DS    CL4                                                      22940021
VASCALE2 DS    CL4                                                      22960021
UASCALE  DS    CL4                      ABSOLUTE FLOAT-FIX-THEN SCALE   22980021
         ORG   UASCALE                                                  23000021
UAS1     DS    CL2                                                      23020021
UAS2     DS    CL2                      FIXED HALF WORD-MAY BE SCALED   23040021
VASCALE  DS    CL4                                                      23060021
         ORG   VASCALE                                                  23080021
VAS1     DS    CL2                                                      23100021
VAS2     DS    CL2                      FIXED HALF WORD-MAY BE SCALED   23120021
NI       DS    CL4                      NUMBER OF INTERATIONS           23140021
XYINT1   DS    CL4                      FIRST INTERSECTION              23160021
XYINT2   DS    CL4                      SECOND INTERSECTION             23180021
INTWKA   DS    CL64                     INTERNAL WORKAREA               23200021
         DS    0D                                                       23220021
         DS    0D                                                       23240021
         DS    0D                                                       23260021
         ORG   OVFSAVE+396                                              23280021
GOMODE   DS    CL2                                                      23300021
         END                                                            23320021
