         TITLE 'GCGRID-- RECTANGULAR CARTESIAN GRID GENERATION ROUTINE' 00020021
*STATUS. CHANGE LEVEL 0                                               * 00040021
*                                                                     * 00060021
*FUNCTION/OPERATION. GCGRID GENERATES RECTANGULAR CARTESIAN GRID      * 00080021
*   PATTERNS IN LINEAR, SEMI-LOGARITHMIC OR LOGARITHMIC FORMS. THE    * 00100021
*   SEMI-LOGARITHMIC GRID PATTERN MAY BE LOGARITHMIC IN EITHER THE    * 00120021
*   HORIZONTAL OR VERTICAL DIRECTION. THE ORDERS GENERATED ARE STORED * 00140021
*   IN THE GRAPHIC DATA OUTPUT AREA (GDOA)                            * 00160021
*                                                                     * 00180021
*ENTRY POINTS. GCGRID VIA CALL OR LINK MACRO   ALIAS NAME IFFPEAGR    * 00200021
*                                                                     * 00220021
*INPUT. OUTPUT CONTROL BLOCK POINTER (OCBP) AND A PARAMETER TABLE     * 00240021
*                                                                     * 00260021
*OUTPUT. GRAPHIC ORDERS TO GENERATE A GRID STORED IN THE GDOA         * 00280021
*                                                                     * 00300021
*EXTERNAL ROUTINES. N/A                                               * 00320021
*                                                                     * 00340021
*EXITS-NORMAL. COMPLETION OF TASK. EXIT VIA RETUR MACRO               * 00360021
*     -ERROR. HEXADECIMAL 4,8,C,10, OR 18 IN REG 15                   * 00380021
*   IMMEDIATE RETURN. EXIT VIA RETURN MACRO                           * 00400021
*     -ERROR. HEXADECIMAL 28 IN REG 15   DOES NOT RETURN IMMEDIATELY  * 00420021
*   COMPLETION  OF TASK AND EXIT VIA RETURN MACRO                     * 00440021
*                                                                     * 00460021
*TABLES/WORK AREAS. USER SPECIFIED PARAMETER TABLE, XYLIM TABLE AND   * 00480021
*   WORK AREA                                                         * 00500021
*                                                                     * 00520021
*ATTRIBUTES. READ ONLY, REENTRANT                                     * 00540021
         EJECT                                                          00560021
IFFPEAGR CSECT                          GCGRID                          00580021
*0669                                                              7468 00590021
         ENTRY GCGRID                                                   00600021
GCGRID   SAVE  (14,12),T,*                                              00620021
         BALR  9,0                                                      00640021
         USING *,9                                                      00660021
         USING PARTAB,PATREG                                            00680021
         USING XYLIMT,XYLREG                                            00700021
         USING WRKAREA,WKAREG                                           00720021
         LM    OBPREG,PATREG,0(1)       LAOD ADDRESS OF OCBP, PARTAB    00740021
         L     WKAREG,4(OBPREG)         LOAD ADDRESS OF WORK AREA       00760021
         L     OABREG,0(OBPREG)         LOAD ADDRESS OF OACB            00780021
         L     XYLREG,0(PATREG)         LOAD ADDRESS OF XYLIM TABLE     00800021
*  SAVE MASK BITS AS SET BY USER                                        00820021
         ST    9,MASKSV                                                 00840021
         SR    WRKREG,WRKREG                                            00860021
         SPM   WRKREG                                                   00880021
         LM    XREG,YREG,4(PATREG)      LOAD UI VI                      00900021
         SR    15,15                    ZERO ERR CODE REG               00920021
         ST    15,64(WKAREG)                 ERR COUNT                  00940021
         BAL   LINREG,XYLCHK                                            00960021
         CLI   12(PATREG),C'F'          TEST FOR FLOAT                  00980021
         BE    FLTLEG                                                   01000021
         CLI   12(PATREG),C'B'          TEST FOR FIX POINT              01020021
         BE    TESTS                                                    01040021
         BAL   LINREG,ERR40                                             01060021
TESTS    CLI   13(PATREG),C'S'          TEST FOR SCALE                  01080021
         BE    FIXSCAL                                                  01100021
         CLI   13(PATREG),C'N'          TEST FOR NO SCALE               01120021
         BE    TESTUV                                                   01140021
         BAL   LINREG,ERR40                                             01160021
*   TEST  UI,VI   FOR  0-4095 LIMITS                                    01180021
TESTUV   C     XREG,ZERO                                                01200021
         BNH   ERR8RET                                                  01220021
         C     XREG,HIGH                                                01240021
         BH    ERR8RET                                                  01260021
         C     YREG,ZERO                                                01280021
         BNH   ERR8RET                                                  01300021
         C     YREG,HIGH                                                01320021
         BH    ERR8RET                                                  01340021
*   STORE GTYPE IN WORK AREA AND TEST FOR TYPE OF GRID                  01360021
         MVC   68(1,WKAREG),14(PATREG)  STORE GTYPE                     01380021
         CLI   68(WKAREG),C'A'          LINEAR-X,Y                      01400021
         BE    GTYPEOK                                                  01420021
         CLI   68(WKAREG),C'B'          LOG-X, LINEAR-Y                 01440021
         BE    GTYPEOK                                                  01460021
         CLI   68(WKAREG),C'C'          LINEAR-X, LOG-Y                 01480021
         BE    GTYPEOK                                                  01500021
         CLI   68(WKAREG),C'D'          LOG-X, LOG-Y                    01520021
         BE    GTYPEOK                                                  01540021
         BAL   LINREG,ERR40                                             01560021
         MVI   68(WKAREG),C'A'          SET GTYPE = A                   01580021
*   STORE  GAVM  ORDER  IN  GDOA                                        01600021
GTYPEOK  LA    CNTREG,2                 LOAD NUMBER OF BYTES            01620021
         MVC   72(2,WKAREG),GAVM        GET GAVM ORDER                  01640021
         MVC   GOMODE,GAVM                                              01660021
         BAL   LINREG,STORELNK                                          01680021
         EJECT                                                          01700021
*   SET   SX=1   SY=Y1  TY=Y2                                           01720021
         MVC   72(4,WKAREG),0(XYLREG)   SX,SY                           01740021
         MVC   78(2,WKAREG),6(XYLREG)      TY                           01760021
SETSX    MVC   76(2,WKAREG),72(WKAREG)  SX                              01780021
         BAL   LINREG,STORINIT                                          01800021
*   TEST FOR  LOG   X-AXIS                                              01820021
         CLI   68(WKAREG),C'B'          LOG-X                           01840021
         BE    LOGX                                                     01860021
         CLI   68(WKAREG),C'D'          LOG-X                           01880021
         BE    LOGX                                                     01900021
*    LINEAR      X AXIS                                                 01920021
         LH    WRKREG,76(WKAREG)        SX                              01940021
SETVALX  AR    WRKREG,XREG                +XINC                         01960021
*    COMPARE   SX+XINC  TO X2 ,IF  GREATER  GO TO  YAXIS                01980021
         CH    WRKREG,4(XYLREG)                                         02000021
         BH    YLEG                                                     02020021
         STH   WRKREG,72(WKAREG)        NEW SX                          02040021
*    OLD SY TO TY   OLD TY TO SY                                        02060021
         LH    WRKREG,78(WKAREG)        SAVE OLD TY                     02080021
         MVC   78(2,WKAREG),74(WKAREG)  OLD SY TO TY                    02100021
         STH   WRKREG,74(WKAREG)        OLD TY TO SY                    02120021
         B     SETSX                                                    02140021
*    SET  SX=X1   SY=Y1  TX=X2                                          02160021
YLEG     MVC   72(4,WKAREG),0(XYLREG)   SX SY                           02180021
         MVC   76(2,WKAREG),4(XYLREG)   TX                              02200021
SETSY    MVC   78(2,WKAREG),74(WKAREG)     SY                           02220021
         BAL   LINREG,STORINIT                                          02240021
*   TEST FOR  LOG   Y-AXIS                                              02260021
         CLI   68(WKAREG),C'C'          LOG-Y                           02280021
         BE    LOGY                                                     02300021
         CLI   68(WKAREG),C'D'          LOG-Y                           02320021
         BE    LOGY                                                     02340021
*   LINEAR      Y-AXIS                                                  02360021
         LH    WRKREG,74(WKAREG)        SY                              02380021
SETVALY  AR    WRKREG,YREG                +YINC                         02400021
*   COMPARE    SX+YINC TO Y2 ,IF GREATER  RETURN                        02420021
         CH    WRKREG,6(XYLREG)                                         02440021
         BH    RET                                                      02460021
         STH   WRKREG,74(WKAREG)        NEW SY                          02480021
*   OLD  SX TO TX   OLD TX TO  SX                                       02500021
         LH    WRKREG,76(WKAREG)        SAVE OLD TX                     02520021
         MVC   76(2,WKAREG),72(WKAREG)  OLD SX TO TX                    02540021
         NI    76(WKAREG),X'0F'         RESET BLANKING BIT              02560021
         STH   WRKREG,72(WKAREG)        OLD TX TO SX                    02580021
         B     SETSY                                                    02600021
STORINIT OI    72(WKAREG),X'40'         SET  BEAM  OFF                  02620021
         LA    CNTREG,8                                                 02640021
STORELNK STM   1,14,80(WKAREG)                                          02660021
         LA    ADDREG,72(WKAREG)                                        02680021
         BAL   LINREG,STORE                                             02700021
         LM    1,14,80(WKAREG)                                          02720021
         BR    LINREG                                                   02740021
         EJECT                                                          02760021
*   XYLCHK  SUBROUTINE                                                  02780021
*   CHECK X1,X2,Y1,Y2 LIMITS GREATER THAN 0 AND LESS THAN 4095          02800021
*   CHECK X1 LESS THAN X2 , Y1 LESS THAN Y2                             02820021
*   ADDRESSOF XYLIM TABLE IN XYLREG BEFORE BAL                          02840021
XYLCHK   LA    CNTREG,4                 SET  LOOP  COUNT                02860021
         LA    INXREG,0                 SET  INDEX                      02880021
XYLLOOP  LH    WRKREG,0(XYLREG,INXREG)  LOAD  X1,Y1,X2,Y2               02900021
         C     WRKREG,ZERO                                              02920021
         BL    ERR4RET                                                  02940021
         C     WRKREG,HIGH                                              02960021
         BH    ERR4RET                                                  02980021
         A     INXREG,TWO                                               03000021
         BCT   CNTREG,XYLLOOP                                           03020021
         CLC   0(2,XYLREG),4(XYLREG)    X1 COMP  X2                     03040021
         BNL   ERR4RET                                                  03060021
         CLC   2(2,XYLREG),6(XYLREG)    Y1 COMP  Y2                     03080021
         BNL   ERR4RET                                                  03100021
         BR    LINREG                                                   03120021
*   LOAD ERROR CODE IN REG 15                                           03140021
ERR40    LA    15,40                    PARAMETER ERROR DOES NOT RET    03160021
         B     ERRCNT                                                   03180021
ERR24RET LA    15,24                    USER OUF HAS NOT RESET OLP      03200021
         B     ERRCNTR                                                  03220021
ERR16RET LA    15,16                    U1,V1 GREATER THAN U2,V2        03240021
         B     ERRCNTR                                                  03260021
ERR12RET LA    15,12                    FLT PT ERROR DETECTED           03280021
         B     ERRCNTR                                                  03300021
ERR8RET  LA    15,8                     U,V LIMIT ERROR                 03320021
         B     ERRCNTR                                                  03340021
ERR4RET  LA    15,4                     XYLIM X1,Y1  X2,Y2 LIMIT ERROR  03360021
         B     ERRCNTR                                                  03380021
ERRCNTR  LA    LINREG,RET                                               03400021
ERRCNT   L     TEMREG,64(WKAREG)                                        03420021
         A     TEMREG,ONE                                               03440021
         ST    TEMREG,64(WKAREG)                                        03460021
         BR    LINREG                                                   03480021
*   TEST ERROR COUNT IN WORK AREA AND SET BIT                           03500021
*   IN SIGN POSITION OF REG 15 IF MULTIPLE ERRORS                       03520021
RET      LA    TEMREG,1                                                 03540021
         C     TEMREG,64(WKAREG)                                        03560021
         BL    SETBIT                                                   03580021
* RESTORE PROGRAM MASK TO SETTING UPON ENTRY                            03600021
RETMACRO L     WRKREG,MASKSV                                            03620021
         SPM   WRKREG                                                   03640021
         RETURN (14,12),T,RC=(15)                                       03660021
SETBIT   O     15,MZERO                                                 03680021
         B     RETMACRO                                                 03700021
         EJECT                                                          03720021
*   LOGX LOOPS 8 TIMES / LOGCYCLE                                       03740021
*   TEST IF TX GREATER THAN X2 -IF YES GO TO YAXIS                      03760021
*   LOGTABLE INDEXED BY 2 / LOOP                                        03780021
LOGX     LA    CONREG,8                 SET  LOOP CONTROL =8            03800021
         MVC   70(2,WKAREG),76(WKAREG)  SAVE SX FOR LOG CYCLE           03820021
         SR    INXREG,INXREG            SET  INDEX =0                   03840021
LOGLOOPX LA    LOGREG,LOGTBL            GET  ADDR  OF LOG TABLE         03860021
         LR    ODDREG,XREG              LOAD  XINC                      03880021
         MH    ODDREG,0(LOGREG,INXREG)            *  LOG                03900021
         SRA   ODDREG,14                ABSOLUTE  VAL                   03920021
         AH    ODDREG,70(WKAREG)                                        03940021
         CH    ODDREG,4(XYLREG)         COMPARE TO  X2  LIMIT           03960021
         BH    YLEG                                                     03980021
         STH   ODDREG,72(WKAREG)        NEW  TX                         04000021
         LH    WRKREG,78(WKAREG)        SAVE OLD TY                     04020021
         MVC   78(2,WKAREG),74(WKAREG)  OLD SY TO TY                    04040021
         STH   WRKREG,74(WKAREG)        OLD TY TO SY                    04060021
         MVC   76(2,WKAREG),72(WKAREG)  TX                              04080021
         BAL   LINREG,STORINIT                                          04100021
         A     INXREG,TWO                                               04120021
         BCT   CONREG,LOGLOOPX                                          04140021
         LH    WRKREG,70(WKAREG)        GET SX FOR NEXT LOG CYCLE       04160021
         B     SETVALX                                                  04180021
         EJECT                                                          04200021
*   LOGY LOOPS 8 TIMES / LOGCYCLE                                       04220021
*   TEST IF TY GREATER THAN Y2 -IF YES RETURN                           04240021
*   LOGTABLE INDEXED BY 2 / LOOP                                        04260021
LOGY     LA    CONREG,8                 SETLOOPCONTROL                  04280021
         MVC   70(2,WKAREG),74(WKAREG)  SAVE SY FOR LOG CYCLE           04300021
         SR    INXREG,INXREG            SET  INXDEX = 0                 04320021
LOGLOOPY LA    LOGREG,LOGTBL            GET  ADDR  OF  LOG  TABLE       04340021
         LR    ODDREG,YREG              LOAD  YINC                      04360021
         MH    ODDREG,0(LOGREG,INXREG)             *  LOG               04380021
         SRA   ODDREG,14                                                04400021
         AH    ODDREG,70(WKAREG)                                        04420021
         CH    ODDREG,6(XYLREG)         COMPARE TO Y2 LIMIT             04440021
         BH    RET                                                      04460021
         STH   ODDREG,74(WKAREG)        NEW  TY                         04480021
         LH    WRKREG,76(WKAREG)        SAVE OLD  TX                    04500021
         MVC   76(2,WKAREG),72(WKAREG)  OLD SX TO TX                    04520021
         NI    76(WKAREG),X'0F'                                         04540021
         STH   WRKREG,72(WKAREG)        OLD TX TO SX                    04560021
         MVC   78(2,WKAREG),74(WKAREG)  TY                              04580021
         BAL   LINREG,STORINIT                                          04600021
         A     INXREG,TWO                                               04620021
         BCT   CONREG,LOGLOOPY                                          04640021
         LH    WRKREG,70(WKAREG)        GET SX FOR NEXT LOG CYCLE       04660021
         B     SETVALY                                                  04680021
FLTLEG   CLI   13(PATREG),C'S'                                          04700021
         BE    SCALFLT                                                  04720021
         CLI   13(PATREG),C'N'          TEST FOR NO SCALE               04740021
         BE    FCONVERT                                                 04760021
         BAL   LINREG,ERR40                                             04780021
FCONVERT LR    VALREG,XREG              FIXCONVERT -(CONVERT FLOAT      04800021
         BAL   LINREG,FIXCONV           TO FIX)                         04820021
         LR    XREG,VALREG                                              04840021
         LR    VALREG,YREG                                              04860021
         BAL   LINREG,FIXCONV                                           04880021
         LR    YREG,VALREG                                              04900021
         B     TESTUV                                                   04920021
         EJECT                                                          04940021
*    CONVERT  FLOATING  POINT  TO  FIXED  POINT  VALUES                 04960021
*    TEST FLOATING POINT INPUT VALIDITY                                 04980021
*    VALREG CONTAINS THE VALUE TO BE CONVERTED                          05000021
FIXCONV  ST    VALREG,0(WKAREG)         STORE FLT VAL IN WORKAREA       05020021
         LE    6,0(WKAREG)              LOAD VALUE TO FLOAT REG         05040021
         N     VALREG,FCHAR             CHECK  CHARACTERISTIC           05060021
         BE    FLERR1                   POSSIBLE ERROR                  05080021
FCHECOK  AU    6,X6                     ADD EXPONENT TO FLOAT REG       05100021
         STE   6,0(WKAREG)              STORE CONV IN WORKAREA          05120021
         L     VALREG,0(WKAREG)         LOAD TO GR                      05140021
         N     VALREG,XZERO             DROP CHARACTERISTIC             05160021
         LTR   VALREG,VALREG            IS VAL NEGATIVE                 05180021
         BNL   NOTNEG                                                   05200021
         N     VALREG,NSIGN             DROP SIGN                       05220021
         LNR   VALREG,VALREG            TAKE TWO'S COMPLIMENT           05240021
NOTNEG   BR    LINREG                   RETURN TO NSI AFTER BAL         05260021
FLERR1   CE    6,ZERO                   IS VAL ZERO                     05280021
         BE    FCHECOK                                                  05300021
         B     ERR12RET                                                 05320021
SCALFLT  LA    CONREG,4                 LOOP  COUNT                     05340021
         LA    INXREG,0                 SET INDEX                       05360021
         LA    WRKREG,0                                                 05380021
FLTLOOP  LH    VALREG,0(XYLREG,INXREG)  GET X1Y1,X2Y2 VALUES            05400021
         BAL   LINREG,FLTCONV                                           05420021
         ST    VALREG,4(WKAREG,WRKREG)                                  05440021
         A     INXREG,TWO                                               05460021
         A     WRKREG,FOUR                                              05480021
         BCT   CONREG,FLTLOOP                                           05500021
*    FLOATING POINT SPECIFIED - TEST FOR CHARACTERISTIC ZERO AND        05520021
*    FRACTION NON ZERO. OF ALL U,V VALUES                               05540021
         L     VALREG,U1                                                05560021
         BAL   LINREG,FIXCONV                                           05580021
         L     VALREG,U2                                                05600021
         BAL   LINREG,FIXCONV                                           05620021
         L     VALREG,V1                                                05640021
         BAL   LINREG,FIXCONV                                           05660021
         L     VALREG,V2                                                05680021
         BAL   LINREG,FIXCONV                                           05700021
         L     VALREG,UI                                                05720021
         BAL   LINREG,FIXCONV                                           05740021
         L     VALREG,VI                                                05760021
         BAL   LINREG,FIXCONV                                           05780021
         EJECT                                                          05800021
*   SUBROUTINE TO SCALE FLOATING POINT VALUES                           05820021
*   SCALED  U,V VALUES LOADED IN XREG AND YREG                          05840021
*   (X2-X1)*UI/U2-U1   SCALED INCREMENT (XINC)                          05860021
*   (Y2-Y1)*VI/V2-V1   SCALED INCREMENT (YINC)                          05880021
FLTSCAL  LE    0,12(WKAREG)             X2                              05900021
         SE    0,4(WKAREG)              -X1                             05920021
         BC    13,ERR4RET               BRANCH ON OVF, MINUS OR ZERO    05940021
         ME    0,4(PATREG)              *UI                             05960021
         LE    2,12(XYLREG)             U2                              05980021
         SE    2,8(XYLREG)              -U1                             06000021
         BC    13,ERR16RET              BRANCH ON OVF, MINUS OR ZERO    06020021
         DER   0,2                                                      06040021
         STE   0,0(WKAREG)                                              06060021
         L     XREG,0(WKAREG)           XREG CONTAINS SCALED FP UI      06080021
         LE    0,16(WKAREG)             Y2                              06100021
         SE    0,8(WKAREG)              -Y1                             06120021
         BC    13,ERR4RET               BRANCH ON OVF, MINUS OR ZERO    06140021
         ME    0,8(PATREG)              *VI                             06160021
         LE    2,20(XYLREG)             V2                              06180021
         SE    2,16(XYLREG)             -V1                             06200021
         BC    13,ERR16RET              BRANCH ON OVF, MINUS OR ZERO    06220021
         DER   0,2                                                      06240021
         STE   0,0(WKAREG)                                              06260021
         L     YREG,0(WKAREG)           YREG CONTAINS SCALED FP         06280021
         B     FCONVERT                                                 06300021
         EJECT                                                          06320021
*    CONVERT  FIXED  POINT  TO  FLOATING  POINT  VALUES                 06340021
*    VALREG CONTAINS THE VALUE TO BE CONVERTED                          06360021
FLTCONV  O     VALREG,X6                EXPONENT OF 6                   06380021
         ST    VALREG,0(WKAREG)                                         06400021
         LE    0,0(WKAREG)              LOAD FLOATING PT REG            06420021
         AE    0,X6                     NORMALIZE                       06440021
         STE   0,0(WKAREG)                                              06460021
         L     VALREG,0(WKAREG)         FLOAT PT VAL IN VALREG          06480021
         BR    LINREG                                                   06500021
*   SUBROUTINE TO SCALE   FIXED  POINT  VALUES                          06520021
*   (X2-X1)*UI/U2-U1)= SCALED INCREMENT (XINC)                          06540021
*   (Y2-Y1)*VI/V2-V1)= SCALED INCREMENT (YINC)                          06560021
*   SCALED  U,V VALUES LOADED IN  XREG AND YREG  (FIXED POINT)          06580021
FIXSCAL  LH    ODDREG,4(XYLREG)         X2                              06600021
         SH    ODDREG,0(XYLREG)         -X1                             06620021
         BC    13,ERR4RET               BRANCH ON OVF, MINUS OR ZERO    06640021
         SR    EVEREG,EVEREG            ZERO EVEN REG                   06660021
         MR    EVEREG,XREG              * UI                            06680021
         L     XREG,12(XYLREG)          U2                              06700021
         S     XREG,8(XYLREG)           -U1                             06720021
         BC    13,ERR16RET              BRANCH ON OVF, MINUS OR ZERO    06740021
         SR    EVEREG,EVEREG            ZERO EVEN REG                   06760021
         DR    EVEREG,XREG                                              06780021
         LR    XREG,ODDREG              SCALED U VALUE IN XREG          06800021
         LH    ODDREG,6(XYLREG)         Y2                              06820021
         SH    ODDREG,2(XYLREG)         -Y1                             06840021
         BC    13,ERR4RET               BRANCH ON OVF, MINUS OR ZERO    06860021
         SR    EVEREG,EVEREG            ZERO EVEN REG                   06880021
         MR    EVEREG,YREG              * VI                            06900021
         L     YREG,20(XYLREG)          V2                              06920021
         S     YREG,16(XYLREG)          -V1                             06940021
         BC    13,ERR16RET              BRANCH ON OVF, MINUS OR ZERO    06960021
         SR    EVEREG,EVEREG                                            06980021
         DR    EVEREG,YREG                                              07000021
         LR    YREG,ODDREG                                              07020021
         B     TESTUV                                                   07040021
         EJECT                                                          07060021
* STORE GRAPHIC DATA IN GDOA FOR POR                                    07080021
* INPUT TO SUBROUTINE                                                   07100021
*   CNTREG = NUMBER OF BYTES OF GRAPHIC DATA TO STORE                   07120021
*   ADDREG = ADDRESS OF THE GRAPHIC DATA                                07140021
*   WKAREG = REGISTER 1 MUST CONTAIN THE WORKAREA ADDRESS               07160021
*   OABREG = ADDRESS OF OACB                                            07180021
STORE    SR    PASREG,PASREG            CLEAR OVERFLOW PASS INDICATOR   07200021
STORE1   L     OLPREG,16(0,OABREG)      ADDRESS OF OLP FROM OACB        07220021
         LR    WRKREG,CNTREG            LOAD BYTES TO MOVE              07240021
* CALCULATE ADDRESSES BASED ON N VALUE AND SIZE OF GDOA                 07260021
STORE2   AR    OLPREG,WRKREG            OLP ADDRESS PLUS N VALUE        07280021
         LA    TEMREG,4                                                 07300021
         AR    TEMREG,OLPREG            OLP PLUS N PLUS 4               07320021
         L     SLOREG,0(OABREG)         SLOA ADDRESS                    07340021
         A     SLOREG,4(OABREG)         ADD LOA EQUALS TOTAL GDOA       07360021
         L     OLPREG,16(0,OABREG)      RESET INITIAL OLP ADDRESS       07380021
         CR    TEMREG,SLOREG                                            07400021
         BNH   OK                       ROOM FOR DATA                   07420021
* NOT ENOUGH ROOM TO STORE ALL OF THE DATA-DETERMINE AMOUNT TO STORE    07440021
         SR    TEMREG,SLOREG            EQUAL BYTES-CAN'T STORE         07460021
         SR    WRKREG,TEMREG            NUMBER OF BYTES CAN STORE       07480021
* ANY BYTES TO STORE                                                    07500021
         C     WRKREG,ZERO                                              07520021
         BNH   STORE4                   LESS OF EQUAL TO ZERO           07540021
         LH    TEMREG,H2A02                                             07560021
         CH    TEMREG,GOMODE                                            07580021
         BH    STORE3A                                                  07600021
         LH    TEMREG,H0003                                             07620021
         NR    TEMREG,WRKREG                                            07640021
         BM    STORE4      GO TO USER OVERFLOW ROUTINE (EAGR)      7468 07660021
STORE3A  SR    CNTREG,WRKREG       BYTES REMAINING                      07680021
         BAL   INTLNK,STORE6            LINK INTERNALLY                 07700021
STORE3   LA    PASREG,1                 SET PASS INDICATOR              07720021
* STORE REGISTERS IN WORKAREA                                           07740021
         STM   0,15,0(WKAREG)           SAVE REGISTERS IN WORKAREA      07760021
         L     15,8(0,OABREG)           OVER FLOW ADDRESS               07780021
         LM    2,12,28(13)              RELOAD USER'S REGISTERS         07800021
         BALR  14,15                    LINK TO ROUTINE-SET RETURN      07820021
         LM    0,15,0(WKAREG)           RELOAD FROM WORKAREA            07840021
         B     STORE1                   GET NEW OLP ADDRESS-CONTINUE    07860021
* NO SPACE AVAILABLE                                                    07880021
STORE4   C     PASREG,ONE               WAS A TRANSFER TO OVERFLOW MADE 07900021
         BL    STORE3                   NO                              07920021
* SET ERROR CODE AND RETURN TO POR-LEAVE POR WITH RETURN MACRO          07940021
         B     ERR24RET                                                 07960021
OK       BAL   INTLNK,STORE6            LINK INTERNALLY                 07980021
         BR    LINREG                                                   08000021
STORE6   LA    TEMREG,255               SET REG. EQUAL TO 255           08020021
STORE6A  CR    WRKREG,TEMREG            IS AMOUNT TO MOVE OVER 255      08040021
         BH    STORE7                   YES                             08060021
         LR    TEMREG,WRKREG                                            08080021
         S     TEMREG,ONE               COMPENSATE FOR EXTRA BYTE       08100021
         EX    TEMREG,MOVE              MOVE GRAPHIC DATA               08120021
         AR    OLPREG,WRKREG            UPDATE OLP ADDRESS              08140021
         AR    ADDREG,WRKREG            UPDATE DATA ADDR                08160021
         ST    OLPREG,16(0,OABREG)      STORE NEW OLP ADDRESS           08180021
         BR    INTLNK                   RETURN INTERNALLY               08200021
STORE7   LR    SLOREG,TEMREG                                            08220021
         S     SLOREG,ONE               COMPENSATE FOR EXTRA BYTE       08240021
         EX    SLOREG,MOVE              MOVE GRAPHIC DATA               08260021
         AR    OLPREG,TEMREG            UPDATE OLP ADDRESS              08280021
         AR    ADDREG,TEMREG            UPDATE INPUT ADDRESS            08300021
         SR    WRKREG,TEMREG           REDUCE BY 255                    08320021
         B     STORE6A                  MAKE NEXT COMPARISON            08340021
MOVE     MVC   0(0,OLPREG),0(ADDREG)    MOVE DATA TO GDOA               08360021
         EJECT                                                          08380021
         CNOP  0,4                                                      08400021
LOGTBL   DC    HS14'.3010'              LOG2                            08420021
         DC    HS14'.4771'              LOG3                            08440021
         DC    HS14'.6021'              LOG4                            08460021
         DC    HS14'.6990'              LOG5                            08480021
         DC    HS14'.7782'              LOG6                            08500021
         DC    HS14'.8451'              LOG7                            08520021
         DC    HS14'.9031'              LOG8                            08540021
         DC    HS14'.9542'              LOG9                            08560021
ZERO     DC    F'0'                                                     08580021
ONE      DC    F'1'                                                     08600021
TWO      DC    F'2'                                                     08620021
HIGH     DC    F'4095'                                                  08640021
FOUR     DC    F'4'                                                     08660021
H2A02    DC    X'2A02'                                                  08680021
H0003    DC    H'0003'                                                  08700021
FCHAR    DC    X'7F000000'                                              08720021
XZERO    DC    X'80FFFFFF'                   SIGN AND VALUE -DROP EXP   08740021
X6       DC    X'46000000'                   EXPONENT OF SIX            08760021
NSIGN    DC    X'7FFFFFFF'                   DROP SIGN -RETAIN VALUE    08780021
MZERO    DC    X'80000000'                                              08800021
GAVM     DC    X'2A02'                                                  08820021
PASREG   EQU   0                                                        08840021
WKAREG   EQU   1                                                        08860021
OBPREG   EQU   2                                                        08880021
OABREG   EQU   2                                                        08900021
PATREG   EQU   3                                                        08920021
XYLREG   EQU   4                                                        08940021
XREG     EQU   5                                                        08960021
SLOREG   EQU   5                                                        08980021
YREG     EQU   6                                                        09000021
INTLNK   EQU   6                                                        09020021
WRKREG   EQU   7                                                        09040021
CNTREG   EQU   8                                                        09060021
LOGREG   EQU   8                                                        09080021
INXREG   EQU   10                                                       09100021
OLPREG   EQU   10                                                       09120021
EVEREG   EQU   10                                                       09140021
ODDREG   EQU   11                                                       09160021
VALREG   EQU   11                                                       09180021
TEMREG   EQU   11                                                       09200021
LINREG   EQU   12                                                       09220021
CONREG   EQU   14                                                       09240021
ADDREG   EQU   14                                                       09260021
         EJECT                                                          09280021
PARTAB   DSECT                                                          09300021
XYLIM    DS    CL4                                                      09320021
UI       DS    CL4                                                      09340021
VI       DS    CL4                                                      09360021
F        DS    CL1                                                      09380021
S        DS    CL1                                                      09400021
GTYPE    DS    CL1                                                      09420021
*                                                                       09440021
XYLIMT   DSECT                                                          09460021
X1       DS    CL2                                                      09480021
Y1       DS    CL2                                                      09500021
X2       DS    CL2                                                      09520021
Y2       DS    CL2                                                      09540021
U1       DS    CL4                                                      09560021
U2       DS    CL4                                                      09580021
V1       DS    CL4                                                      09600021
V2       DS    CL4                                                      09620021
*                                                                       09640021
WRKAREA  DSECT                                                          09660021
OVFSAVE  DS    CL64                     STORE SAVE AREA -OVERFLOW       09680021
PORSAVE  DS    CL64                     POR SAVE AREA                   09700021
ERRCOUNT DS    CL4                      ERROR COUNT SAVE AREA           09720021
SX1      DS    CL2                                                      09740021
SY1      DS    CL2                                                      09760021
SX2      DS    CL2                                                      09780021
         ORG   SX2                                                      09800021
TX       DS    CL2                                                      09820021
SY2      DS    CL2                                                      09840021
         ORG   SY2                                                      09860021
TY       DS    CL2                                                      09880021
WRKGTYPE DS    CL1                      GTYPE SAVE                      09900021
MASKSV   DS    F                   SAVE SETTING OF USER PROGRAM MASK    09920021
         ORG   OVFSAVE+396                                              09940021
GOMODE   DS    CL2                                                      09960021
         END                                                            09980021
