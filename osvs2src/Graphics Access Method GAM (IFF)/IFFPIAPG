         TITLE 'GPGRID -  POINT POLAR GRID GENEREATION ROUTINE'         00020021
*                                                                       00040021
*                                                                       00060021
*   STATUS.              CHANGE LEVEL 0.                                00080021
*                                                                       00100021
*   FUNCTION/OPERATION.  GPGRID GENERATES THE GRAPHIC ORDERS TO DISPLAY 00120021
*                        A SET OF CONCENTRIC CIRCLES, DIVIDED INTO      00140021
*                        EQUAL SECTORS BY A NUMBER OF RADIAL VECTORS.   00160021
*                        THE SPACING BETWEEN THE CIRCLES MAY BE LINEAR  00180021
*                        OR LOGARITHMIC.  THIS ROUTINE PROVIDES THE     00200021
*                        GRAPHIC ORDERS TO  DISPLAY  POINTS ON THE      00220021
*                        PERIMETERS OF THE CIRCLES.                     00240021
*                                                                       00260021
*   ENTRY POINTS.        GPGRID VIA CALL OR LINK MACRO.                 00280021
*                        ALIAS NAME - IFFPIAPG                          00300021
*                                                                       00320021
*   INPUT.               OUTPUT CONTROL BLOCK POINTER (OACB).           00340021
*                        PARAMETER TABLE WHICH DEFINES THE POSITION,    00360021
*                        SIZE, AND TYPE OF POLAR GRID.                  00380021
*                                                                       00400021
*   OUTPUT.              GRAPHIC ORDERS STORED IN THE GDOA.             00420021
*                                                                       00440021
*   EXTERNAL ROUTINES.   GOFFSG - OFF SCREEN OFF GRID ROUTINE.          00460021
*                                                                       00480021
*   EXITS-NORMAL.        COMPLETION OF TASK. EXIT VIA RETURN MACRO.     00500021
*        -ERROR.         IMMEDIATE RETURN. EXIT VIA RETURN MACRO.       00520021
*                        HEXADECIMAL 4,8,C,10,14, OR 18 IN RET CODE REG 00540021
*        -ERROR.         DOES NOT RETURN IMMEDIATELY. COMPLETION OF     00560021
*                        TASK AND RETURN VIA RETURN MACRO.              00580021
*                        HEXADECIMAL 28 IN RETURN CODE REGISTER.        00600021
*                                                                       00620021
*   TABLES/WORK AREAS.   USER SPECIFIED PARAMETER TABLE, XYLIM TABLE    00640021
*                        AND WORK AREA.                                 00660021
*                                                                       00680021
*   ATTRIBUTER.          READ ONLY. REENTRANT.                          00700021
         EJECT                                                          00720021
IFFPIAPG CSECT                          GPGRID                          00740021
*0669                                                              7468 00750021
         ENTRY GPGRID                                                   00760021
PASREG   EQU   0                                                        00780021
WKAREG   EQU   1                        WORK AREA ADDRESS REGISTER      00800021
PARREG   EQU   1                                                        00820021
OBPREG   EQU   2                        CONTROL BLOCK POINTER ADDR REG  00840021
OABREG   EQU   2                        CONTROL BLOCK ADDRESS REGISTER  00860021
PATREG   EQU   3                        ADDRESS OF PARAMETER TABLE      00880021
XYLREG   EQU   4                        ADDRESS OF XYLIM TABLE          00900021
XREG     EQU   5                        X-COMPUTING REGISTER            00920021
SLOREG   EQU   5                        SLOA ADDRESS REGISTER           00940021
COSREG   EQU   5                        COSINE REGISTER                 00960021
SINREG   EQU   6                        SINE REGISTER                   00980021
YREG     EQU   6                        Y-COMPUTING REGISTER            01000021
INTLNK   EQU   6                        INTERNAL POR LINK REGISTER      01020021
INDEXREG EQU   7                        INDEX REGISTER                  01040021
WRKREG   EQU   7                        WORK REGISTER                   01060021
CNTREG   EQU   8                        COUNT REGISTER                  01080021
LINKREG  EQU   8                        INTERNAL POR LINK REGISTER      01100021
BASE9    EQU   9                        BASE REGISTER FOR GPGRID        01120021
INXREG   EQU   10                       INDEX AND POR LINK REGISTER     01140021
OLPREG   EQU   10                       ORDER LOAD POINT ADDRESS        01160021
EVEREG   EQU   10                       ARITHMETIC WORK REGISTER        01180021
ODDREG   EQU   11                       ARITHMETIC WORK REGISTER        01200021
VALREG   EQU   11                       WORK REGISTER                   01220021
TEMREG   EQU   11                       WORK REGISTER                   01240021
LINREG   EQU   12                       INTERNAL POR LINK REGISTER      01260021
ADDREG   EQU   14                       GENERAL USE ADDRESS REGISTER    01280021
CONREG   EQU   14                       CONTROL COUNT REGISTER          01300021
ERREG    EQU   15                       ERROR CODE REGISTER             01320021
         EJECT                                                          01340021
*************************                                               01360021
*   INITIALIZATION      *                                               01380021
*************************                                               01400021
GPGRID   STM   14,12,12(13)                                             01420021
         BALR  BASE9,0                                                  01440021
         USING *,BASE9                                                  01460021
         USING PARTAB,PATREG                                            01480021
         USING WKAREA,WKAREG                                            01500021
         USING XYLIMT,XYLREG                                            01520021
         SR    ERREG,ERREG                                              01540021
         LM    OBPREG,PATREG,0(PARREG)  LOAD OCBP AND PARTAB ADDRESSES. 01560021
         L     XYLREG,XYLIM             LOAD ADDR OF XYLIM TABLE.       01580021
         L     WKAREG,4(0,OBPREG)       LOAD ADDR OF USER WORK AREA.    01600021
         L     OABREG,0(0,OBPREG)       LOAD ADDR OF CONTROL BLOCK.     01620021
*  SAVE MASK BITS AS SET BY USER                                        01640021
         ST    9,MASKSV                                                 01660021
         SR    WRKREG,WRKREG                                            01680021
         SPM   WRKREG                                                   01700021
         BAL   LINREG,XYLCHK            LINK TO XYLIM CHECK             01720021
         MVC   ERCOUNT,ZERO         CLEAR ERROR COUNTER                 01740021
         MVI   LOADSW,X'00'                                             01760021
         MVI   SGSW,X'00'                                               01780021
         CLI   F,C'F'                   CHECK FOR FLOATING POINT VALUES 01800021
         BE    FLOAT                    BRANCH IF FIX FL OPTION = F     01820021
         CLI   F,C'B'                                                   01840021
         BE    CHKS                     IF F PARA NOT = F OR B,         01860021
         BAL   LINKREG,ER40             LINK TO SET ERROR CODE.         01880021
CHKS     CLI   S,C'S'                   CHECK IF SCALING REQUIRED.      01900021
         BE    LINK1                    SCALE FIXED POINT VALUES.       01920021
         MVC   RINK(4),RINC             STORE RINC AND MAX-RADIUS       01940021
         MVC   MAXR(4),MAXRAD           IN THE USER WORK AREA.          01960021
         MVC   XC(8),UC                 UC,VC TO USER WORK AREA.        01980021
TSTS     CLI   S,C'N'                                                   02000021
         BE    CHKPARA                  IF SCALE PARA NOT S OR N,       02020021
         BAL   LINKREG,ER40             LINK TO SET ERROR CODE.         02040021
         B     CHKPARA                                                  02060021
FLOAT    CLI   S,C'S'                                                   02080021
         BE    LINK2                                                    02100021
         CLI   S,C'N'                   IF SCALE PARA NOT S OR N,       02120021
         BE    LINK0                    LINK TO SET ERROR CODE.         02140021
         BAL   LINKREG,ER40                                             02160021
LINK0    L     VALREG,UC                CONVERT UC,VC,RINC AND          02180021
         BAL   LINKREG,FCONVERT         MAX-RADIUS TO FIXED POINT.      02200021
         ST    VALREG,XC                                                02220021
         L     VALREG,VC                                                02240021
         BAL   LINKREG,FCONVERT                                         02260021
         ST    VALREG,YC                                                02280021
         L     VALREG,RINC                                              02300021
         BAL   LINKREG,FCONVERT                                         02320021
         ST    VALREG,RINK                                              02340021
         L     VALREG,MAXRAD                                            02360021
         BAL   LINKREG,FCONVERT                                         02380021
         ST    VALREG,MAXR                                              02400021
         B     CHKPARA                                                  02420021
LINK1    L     XREG,UC                  SCALE FIXED-POINT VALUES        02440021
         L     YREG,VC                  UC,VC,RINC,AND MAX-RADIUS.      02460021
         BAL   LINREG,SCALFIX                                           02480021
         ST    XREG,XC                                                  02500021
         ST    YREG,YC                                                  02520021
         L     XREG,RINC                                                02540021
         BAL   LINREG,FIXSCAL                                           02560021
         ST    XREG,RINK                                                02580021
         L     XREG,MAXRAD                                              02600021
         BAL   LINREG,FIXSCAL           BR TO SCALE MAXIMUM RADIUS.     02620021
         ST    XREG,MAXR                                                02640021
         B     CHKPARA                                                  02660021
LINK2    BAL   LINKREG,SCALFLT          SCALE FLOATING POINT VALUES     02680021
         MVC   VALUE1(4),RINC           UC,VC,RINC, AND MAXRAD.         02700021
         BAL   LINKREG,FLTSCAL                                          02720021
         ST    VALREG,RINK              STORE SCALED VALUES IN          02740021
         MVC   VALUE1(4),MAXRAD         XC,YC,RINK, AND MAXR.           02760021
         BAL   LINKREG,FLTSCAL                                          02780021
         ST    VALREG,MAXR                                              02800021
******************************                                          02820021
*   CHECK PARAMETER TABLE    *                                          02840021
******************************                                          02860021
CHKPARA  LM    XREG,YREG,XC             CHECK INPUT PARAMETERS.         02880021
         C     XREG,ZERO                IF XC IS LESS THAN ZERO,        02900021
         BL    ER8                      BR TO SET ERROR CODE & RETURN.  02920021
         C     XREG,C4095               IF XC IS GREATER THAN 4095,     02940021
         BH    ER8                      BR TO SET ERROR CODE & RETURN.  02960021
         C     YREG,ZERO                IF YC IS LESS THAN ZERO,        02980021
         BL    ER8                      BR TO SET ERROR CODE & RETURN.  03000021
         C     YREG,C4095                                               03020021
         BH    ER8                                                      03040021
         L     WRKREG,MAXR              CHECK MAXR AND RINK             03060021
         C     WRKREG,FOUR              TO SEE IF GT FOUR.              03080021
         BL    ER20                     SET ERROR CODE AND RET IF NOT.  03100021
         L     WRKREG,RINK                                              03120021
         C     WRKREG,FOUR                                              03140021
         BL    ER20                                                     03160021
         MVC   R(4),RINK                                                03180021
         CLI   TYPE,C'A'                                                03200021
         BE    TSTINC                                                   03220021
         CLI   TYPE,C'B'                IF TYPE NOT A OR B,             03240021
         BNE   ER20                     SET ERROR CODE AND RETURN.      03260021
RLOG     MVI   J,X'01'                  LOG GRID REQUESTED. SET J=1.    03280021
         MVC   LOGSAV(2),MINUS2                                         03300021
TSTINC   CLI   INC,C'A'                 CHECK PARAMETER INC TO SEE      03320021
         BE    SETA                     IF ALPHA OR DENSITY IS SPEC.    03340021
         CLI   INC,C'D'                                                 03360021
         BE    SETD                                                     03380021
SETC     BAL   LINKREG,ER40             IF INC NOT A OR D, SET INTERNAL 03400021
         MVI   INK,C'C'                 INDICATOR TO C, ERROR CODE TO   03420021
         B     AOK                      40 AND CONTINUE PROCESSING.     03440021
SETA     LH    WRKREG,ALPHA             ALPHA SPECIFIED.                03460021
         CH    WRKREG,ZERO                                              03480021
         BL    SETC                                                     03500021
         BE    SETCC                                                    03520021
         CH    WRKREG,H360                                              03540021
         BNL   SETC                                                     03560021
         MVI   INK,C'A'                 ALPHA OK.                       03580021
         MVC   ALPH(2),ALPHA            MOVE ALPHA TO USER WORK AREA.   03600021
         B     AOK                                                      03620021
SETCC    MVI   INK,C'C'                                                 03640021
         B     AOK                                                      03660021
SETD     LH    WRKREG,DENSITY           DENSITY SPECIFIED.              03680021
         CH    WRKREG,FOUR                                              03700021
         BL    SETC                                                     03720021
         MVI   INK,C'D'                                                 03740021
AOK      LA    CNTREG,2                 LENGTH OF GEPM ORDER TO CNTREG. 03760021
         LA    ADDREG,GEPM              ADDR OF GEPM ORDER TO ADDREG.   03780021
         MVC   GOMODE,GEPM                                              03800021
         BAL   LINREG,STORE             LINK TO STORE GEPM ORDER.       03820021
         MVC   I(4),ONE                 SET I=1.                        03840021
         EJECT                                                          03860021
TESTINC  CLI   INK,C'C'                 IF INK=C, COMPUTE ALPHA=2048/R  03880021
         BE    COMPA                                                    03900021
         CLI   INK,C'D'                 IF INK NOT D, INK=A.            03920021
         BNE   SETNPT                                                   03940021
**************************************************                      03960021
* COMPUTE  TEMP=360*DENSITY/(2PI*R)              *                      03980021
*          ALPHA=INTEGRAL PART OF (TEMP+0.5)     *                      04000021
**************************************************                      04020021
ALPHAGET L     EVEREG,C360                                              04040021
         MH    EVEREG,DENSITY           COMPUTE 360*DENSITY             04060021
         SRDA  EVEREG,32                                                04080021
         SLDA  EVEREG,29                                                04100021
         D     EVEREG,TWOPI             COMPUTE 360*DENSITY/2PI         04120021
         SR    EVEREG,EVEREG                                            04140021
         L     WRKREG,R                                                 04160021
         DR    EVEREG,WRKREG            COMPUTE ALPHA=360*DENSITY/2PI/R 04180021
         A     ODDREG,ONE                                               04200021
         SRA   ODDREG,1                                                 04220021
         STH   ODDREG,ALPH              STORE ALPHA IN USER WORK AREA.  04240021
CHKA1    CLC   ALPH(2),ZERO                                             04260021
         BH    CHKA2                                                    04280021
SETALP   MVC   ALPH(2),ONE+2            SET ALPHA = 1                   04300021
         B     SETNPT                                                   04320021
CHKA2    CLC   ALPH(2),H360                                             04340021
         BL    SETNPT                                                   04360021
         BAL   LINKREG,ER40                                             04380021
******************************                                          04400021
*   COMPUTE ALPHA=2048/R     *                                          04420021
******************************                                          04440021
COMPA    CLC   R(4),C1365               IF R IS GT 1365,                04460021
         BH    SETALP                   BR TO SET ALPHA TO ONE.         04480021
         CLC   R+2(2),C46               IF R IS LESS THAN 46,           04500021
         BL    SETA45                   SET ALPHA = 45.                 04520021
         LA    EVEREG,2048              IF NOT, COMPUTE ALPHA.          04540021
         SRDA  EVEREG,32                                                04560021
         SLDA  EVEREG,1                                                 04580021
         D     EVEREG,R                                                 04600021
         A     ODDREG,ONE                                               04620021
         SRA   ODDREG,1                                                 04640021
         STH   ODDREG,ALPH              STORE ALPHA IN USER WORK AREA.  04660021
         B     SETNPT                                                   04680021
SETA45   MVC   ALPH(2),C45                                              04700021
         B     SETNPT                                                   04720021
GETR     STH   INDEXREG,LOGSAV                                          04740021
         SR    EVEREG,EVEREG            COMPUTE  R=RINC*(I-1+LOG(J))    04760021
         L     EVEREG,I                 EVEREG=I                        04780021
         SH    EVEREG,ONE+2             EVEREG=I-1                      04800021
         SLA   EVEREG,14                                                04820021
         AH    EVEREG,LOGJ(INDEXREG)    EVEREG=I-1+LOG(J)               04840021
         SRDA  EVEREG,32                                                04860021
         M     EVEREG,RINK              EVEREG=R=RINC*(I-1+LOG(J))      04880021
         AH    ODDREG,POINT5                                            04900021
         SRA   ODDREG,14                REMOVE DECIMAL PORTION OF R     04920021
         ST    ODDREG,R                 AND STORE IN USER WORK AREA.    04940021
         BR    LINKREG                                                  04960021
SETNPT   MVC   K(2),ZERO                                                04980021
         LA    EVEREG,360               SET NPT EQ TO INTEGRAL          05000021
         SRDA  EVEREG,32                PART OF 360/ALPHA.              05020021
         LH    XREG,ALPH                                                05040021
         DR    EVEREG,XREG                                              05060021
         STH   ODDREG,NPT               NPT=THE # OF POINTS PER CIRCLE. 05080021
         CLC  R(4),C5793                SEE IF ALL POINTS WITH CURRENT  05100021
         BNH   SETPHI                   RADIUS WILL BE OUTSIDE SCREEN.  05120021
         MVC   K(2),NPT                                                 05140021
         B     OFFSCR                   BR TO CHECK OFF SCREEN OPTION.  05160021
SETPHI   LH    ODDREG,K                 SET PHI=K*ALPHA                 05180021
         MH    ODDREG,ALPH                                              05200021
         STH   ODDREG,PHI               STORE VALUE IN USER WRK AREA.   05220021
         EJECT                                                          05240021
***********************************                                     05260021
*   DETERMINE QUADRANT OF PHI.    *                                     05280021
*   GET SIN%PHI< AND COS%PHI<     *                                     05300021
*   FROM SINE/COSINE TABLE.       *                                     05320021
***********************************                                     05340021
         CLC   PHI(2),C90               CHECK IF PHI IN 1'ST QUADRANT.  05360021
         BH    CK180                    IF NOT, CHECK QUADRANT 2.       05380021
         CLC   PHI(2),C46                                               05400021
         BL    TBLOK                                                    05420021
         MVI   FUNCSW,X'0F'             PHI IN RANGE OF 46-90 DEG.      05440021
         LA    WRKREG,90                                                05460021
         B     LOOKUP1                  GO TO EXTRACT SIN(PHI),COS(PHI) 05480021
TBLOK    MVI   FUNCSW,X'00'             PHI IN RANGE OF 0-45 DEG.       05500021
         LA    WRKREG,0                                                 05520021
         B     LOOKUP2                  GO TO EXTRACT SIN(PHI),COS(PHI) 05540021
CK180    CLC   PHI(2),C180              CHECK IF PHI IN 2'ND QUADRANT   05560021
         BH    CK270                    IF NOT, CHECK QUADRANT 3.       05580021
         CLC   PHI(2),C136                                              05600021
         BL    PHI180                                                   05620021
         MVI   FUNCSW,X'30'             PHI IN RANGE OF 136-180 DEG.    05640021
         LA    WRKREG,180                                               05660021
         B     LOOKUP1                  GO TO EXTRACT SIN(PHI),COS(PHI) 05680021
PHI180   MVI   FUNCSW,X'3F'             PHI IN RANGE OF 91-135 DEG.     05700021
         LA    WRKREG,90                                                05720021
         B     LOOKUP2                  GO TO EXTRACT SIN(PHI),COS(PHI) 05740021
CK270    CLC   PHI(2),C270              CHECK IF PHI IN 3'RD QUAD.      05760021
         BH    CK315                    IF NOT, PHI IN QUADRANT 4.      05780021
         CLC   PHI(2),C226                                              05800021
         BL    PHI270                                                   05820021
         MVI   FUNCSW,X'FF'             PHI IN RANGE OF 226-270 DEG.    05840021
         LA    WRKREG,270                                               05860021
         B     LOOKUP1                  GO TO EXTRACT SIN(PHI),COS(PHI) 05880021
PHI270   MVI   FUNCSW,X'F0'             PHI IN RANGE OF 181-225 DEG.    05900021
         LA    WRKREG,180                                               05920021
         B     LOOKUP2                  GO TO EXTRACT SIN(PHI),COS(PHI) 05940021
CK315    CLC   PHI(2),C315                                              05960021
         BH    PHI360                                                   05980021
         MVI   FUNCSW,X'CF'             PHI IN RANGE OF 271-315 DEG.    06000021
         LA    WRKREG,270                                               06020021
         B     LOOKUP2                  GO TO EXTRACT SIN(PHI),COS(PHI) 06040021
PHI360   CLC   PHI(2),H360                                              06060021
         BNL   OMIT                                                     06080021
         MVI   FUNCSW,X'C0'             PHI IN RANGE OF 316-360 DEG.    06100021
         LA    WRKREG,360                                               06120021
         B     LOOKUP1                                                  06140021
LOOKUP1  SH    WRKREG,PHI                                               06160021
         LR    INXREG,WRKREG                                            06180021
         B     EXTRACT                                                  06200021
LOOKUP2  LH    INXREG,PHI                                               06220021
         SR    INXREG,WRKREG                                            06240021
EXTRACT  MH    INXREG,FOUR+2                                            06260021
         TM    FUNCSW,X'0F'             IF FUNCSW=0F, GO TO PUT COS     06280021
         BO    SWITCH                   IN SINREG AND SIN IN COSREG.    06300021
         LH    SINREG,SINE(INXREG)      LOAD SINE TO SINREG.            06320021
         LH    COSREG,COSINE(INXREG)    LOAD COSINE TO COSREG.          06340021
         B     TSIGNS                   GO TO TEST SIGN OF FUNCTIONS.   06360021
SWITCH   LH    SINREG,COSINE(INXREG)    LOAD COSINE TO SINREG.          06380021
         LH    COSREG,SINE(INXREG)      LOAD SINE TO COSREG.            06400021
TSIGNS   TM    FUNCSW,X'C0'             SEE IF SIGN OF SINE IS MINUS.   06420021
         BZ    TSIGNC                                                   06440021
         MH    SINREG,MINUS1                                            06460021
TSIGNC   TM    FUNCSW,X'30'             SEE IF SIGN OF COSINE IS MINUS. 06480021
         BZ    MULTR                                                    06500021
         MH    COSREG,MINUS1                                            06520021
         EJECT                                                          06540021
**************************************************                      06560021
*   COMPUTE  X=XC+R*COS(PHI) AND Y=YC+R*SIN(PHI) *                      06580021
**************************************************                      06600021
MULTR    LR    EVEREG,COSREG            LOAD COS(PHI)                   06620021
         SRDA  EVEREG,32                                                06640021
         M     EVEREG,R                 R*COS(PHI)                      06660021
         L     COSREG,XC                                                06680021
         SLA   COSREG,14                                                06700021
         AR    COSREG,ODDREG            XC+R*COS(PHI)                   06720021
         AH    COSREG,POINT5                                            06740021
         SRA   COSREG,14                SHIFT OFF DECIMAL PORTION OF X. 06760021
         LR    EVEREG,SINREG            LOAD SIN(PHI)                   06780021
         SRDA  EVEREG,32                                                06800021
         M     EVEREG,R                 R*SIN(PHI)                      06820021
         L     SINREG,YC                                                06840021
         SLA   SINREG,14                                                06860021
         AR    SINREG,ODDREG            YC+R*SIN(PHI)                   06880021
         AH    SINREG,POINT5                                            06900021
         SRA   SINREG,14                SHIFT OFF DECIMAL PORTION OF Y. 06920021
****************************************                                06940021
*   XREG=COSREG=X   YREG=SINREG=Y      *                                06960021
****************************************                                06980021
OFFCHECK BAL   LINKREG,CHKOFF           LINK TO OFF GRID/SCREEN CHECK.  07000021
         B     OFFGRD                   IF POINT OFF GRID.              07020021
         B     OFFSCR                   IF POINT OFF SCREEN.            07040021
         B     CONT                     IF POINT OK.                    07060021
CHKOFF   CH    XREG,H4095               TEST X- AND Y-COORDINATES       07080021
         BH    4(0,LINKREG)             TO SEE IF OFF-SCREEN/GRID.      07100021
         CH    XREG,ZERO                                                07120021
         BL    4(0,LINKREG)                                             07140021
         CH    YREG,H4095                                               07160021
         BH    4(0,LINKREG)                                             07180021
         CH    YREG,ZERO                                                07200021
         BL    4(0,LINKREG)                                             07220021
         CH    XREG,X1                                                  07240021
         BL    0(0,LINKREG)                                             07260021
         CH    XREG,X2                                                  07280021
         BH    0(0,LINKREG)                                             07300021
         CH    YREG,Y1                                                  07320021
         BL    0(0,LINKREG)                                             07340021
         CH    YREG,Y2                                                  07360021
         BH    0(0,LINKREG)                                             07380021
         B     8(0,LINKREG)                                             07400021
OFFGRD   BAL   LINKREG,TSTGR            LINK TO TEST USER OPTION.       07420021
         B     OMIT                       IF OPTION = A OR C.           07440021
         TM    SGSW,X'F0'                                               07460021
         BO    PT2ON                                                    07480021
         B     CONT                       IF OPTION = B,E, OR INVALID.  07500021
TSTGR    CLI   OFFSG,C'A'                                               07520021
         BNE   GRDB                                                     07540021
         BAL   LINREG,ER44              OMIT POINT AND SET ERROR CODE   07560021
         BR    LINKREG                  IF S/G OPTION=A.                07580021
GRDB     CLI   OFFSG,C'B'               SHOW POINT IF S/G-OPTION=B      07600021
         BE    4(0,LINKREG)                                             07620021
GRDC     CLI   OFFSG,C'C'               OMIT POINT IF S/G OPTION=C      07640021
         BE    0(0,LINKREG)                                             07660021
GRDD     CLI   OFFSG,C'D'                                               07680021
         BNE   GRDE                                                     07700021
         LA    LINREG,RET               SET ERROR CODE AND RETURN TO    07720021
         B     ER28                     CALLING PROG IF S/G OPTION=D    07740021
GRDE     CLI   OFFSG,C'E'                                               07760021
         BE    4(0,LINKREG)             OMIT POINT IF S/G OPTION=E      07780021
         LR    TEMREG,LINKREG                                           07800021
         BAL   LINKREG,ER40             S/G OPTION INVALID.             07820021
         B     4(0,TEMREG)                                              07840021
OFFSCR   BAL   LINKREG,TSTSR            LINK TO TEST USER OPTION.       07860021
         B     OMIT                       IF OPTION = A OR B.           07880021
         B     OMIT                                                     07900021
TSTSR    CLI   OFFSG,C'A'                                               07920021
         BNE   SCRB                                                     07940021
         BAL   LINREG,ER44              OMIT POINT AND SET ERROR CODE   07960021
         B     4(0,LINKREG)             IF S/G OPTION=A.                07980021
SCRB     CLI   OFFSG,C'B'                                               08000021
         BNE   SCRC                                                     08020021
         BAL   LINREG,ER48              OMIT POINT AND SET ERROR CODE   08040021
         BR    LINKREG                  IF S/G OPTION=B.                08060021
SCRC     CLI   OFFSG,C'C'               SEE IF OPTION C                 08080021
         BNE   SCRD                                                     08100021
         LA    LINREG,RET                                               08120021
         B     ER32                                                     08140021
SCRD     CLI   OFFSG,C'D'                                               08160021
         BNE   SCRE                                                     08180021
         LA    LINREG,RET               SET ERROR CODE AND RETURN TO    08200021
         B     ER28                     CLLING PROG IF S/G OPTION=D     08220021
SCRE     LA    LINREG,RET                                               08240021
         B     ER32                     ERROR 32 ASSUMED.               08260021
CONT     STH   XREG,GDV1                STORE X-COORDINATE IN GDV.      08280021
         STH   YREG,GDV1+2              STORE Y-COORDINATE IN GDV.      08300021
         LA    CNTREG,4                 LENGTH OF GDV TO COUNT REG.     08320021
         LA    ADDREG,GDV1                                              08340021
         BAL   LINREG,STORE             LINK TO STORE GDV X,Y,U.        08360021
OMIT     CLC   NPT(2),K                 CHECK NO OF POINTS DRAWN        08380021
         BE    TSTGRD                   WITH NO OF POINTS PER CIRCLE.   08400021
         LH    EVEREG,K                 IF K AND NPT UNEQUAL, SET       08420021
         A     EVEREG,ONE               K=K+1 AND RETURN TO COMPUTE     08440021
         STH   EVEREG,K                 THE NEXT X,Y VALUES.            08460021
         B     SETPHI                                                   08480021
TSTGRD   CLI   TYPE,C'B'                                                08500021
         BNE   TESTI                    BRANCH IF LINEAR GRID.          08520021
         CLI   J,X'08'                                                  08540021
         BH    TESTI                                                    08560021
         SR    EVEREG,EVEREG                                            08580021
         IC    EVEREG,J                                                 08600021
         A     EVEREG,ONE               SET J=J+1                       08620021
         STC   EVEREG,J                                                 08640021
         LH    INDEXREG,LOGSAV          GET ADDRESS OF                  08660021
         A     INDEXREG,TWO             CURRENT LOG(J).                 08680021
         BAL   LINKREG,GETR                                             08700021
         B     TESTINC                                                  08720021
TESTI    SR    EVEREG,EVEREG                                            08740021
         L     EVEREG,I                 LOAD THE NO OF CIRCLES.         08760021
         A     EVEREG,ONE               SET I=I+1      I=# OF CIRCLES,  08780021
         ST    EVEREG,I                                OR LOG CYCLES.   08800021
         SRDA  EVEREG,32                                                08820021
         M     EVEREG,RINK              MULTIPLY I BY RINC.             08840021
         CL    ODDREG,MAXR              IF MAX-RADIUS IS LT I*RINC      08860021
         BH    TESTNR                   BR TO TEST THE NO OF RADII.     08880021
         ST    ODDREG,R                 NEW LOG CYCLE.                  08900021
         CLI   TYPE,C'B'                                                08920021
         BE    SETJ                                                     08940021
         B     TESTINC                                                  08960021
SETJ     MVI   J,X'01'                  SET J=1 AND                     08980021
         MVC   LOGSAV(2),MINUS2         RETURN TO GEN                   09000021
         B     TESTINC                  NEXT LOG CYCLE                  09020021
         EJECT                                                          09040021
TESTNR   CLC   NR(2),ZERO               IF NO RADII REQUESTED,          09060021
         BE    RET                      RETURN TO USER ROUTINE.         09080021
         LA    CNTREG,2                 LENGTH OF GEVM ORDER TO CNTREG. 09100021
         LA    ADDREG,GEVM              LOAD ADDR OF GEVM ORDER.        09120021
         MVC   GOMODE,GEVM                                              09140021
         BAL   LINREG,STORE             LINK TO STORE GEVM ORDER.       09160021
**************************************************                      09180021
*   COMPUTE END POINTS OF 90,0,180,& 270 DEG RAD *                      09200021
**************************************************                      09220021
         L     EVEREG,XC                                                09240021
         A     EVEREG,MAXR              VV1=XC+MAXR                     09260021
         ST    EVEREG,VV1                                               09280021
         L     EVEREG,XC                                                09300021
         S     EVEREG,MAXR              VV2=XC-MAXR                     09320021
         ST    EVEREG,VV2                                               09340021
         L     EVEREG,YC                                                09360021
         A     EVEREG,MAXR              VV3=YC+MAXR                     09380021
         ST    EVEREG,VV3                                               09400021
         L     EVEREG,YC                                                09420021
         S     EVEREG,MAXR              VV4=YC-MAXR                     09440021
         ST    EVEREG,VV4                                               09460021
         LM    XREG,YREG,XC                                             09480021
         BAL   LINKREG,CHKOFF           LINK TO CHECK CENTER OF CIRCLE  09500021
         B     XCOFF                    FOR OFF GRID CONDITION.         09520021
         B     XCOFF                                                    09540021
         MVI   SGSW,X'00'               CENTER POINT ON GRID. SET SGSW  09560021
         B     CHKNR                    AND GO TO CHECK NUM OF RADII.   09580021
XCOFF    MVI   SGSW,X'F0'               CENTER POINT OFF GRID.          09600021
CHKNR    STM   XREG,YREG,PT1X                                           09620021
         CLC   NR(2),C8                 CHECK THE NUMBER                09640021
         BE    GETUVAL                  OF RADII TO SEE                 09660021
         CLC   NR(2),FOUR+2             IF VALID.                       09680021
         BE    GEN4                                                     09700021
         CLC   NR(2),TWO+2              NR MUST = 1,2,4, OR 8.          09720021
         BE    GEN2                                                     09740021
         CLC   NR(2),ONE+2                                              09760021
         BE    GEN1                                                     09780021
         BAL   LINKREG,ER40             ASSUME ZERO IF NR IS INVALID.   09800021
         B     RET                      RETURN TO CALLING PROGRAM.      09820021
GEN4     MVC   PT2X(4),XC               GENERATE RADII                  09840021
         MVC   PT2Y(4),VV4              ON Y AXIS.                      09860021
         LM    XREG,YREG,PT2X                                           09880021
         BAL   INXREG,CHKPOINT          CHECK FOR OFF SCR/GRD.          09900021
         MVC   PT2Y(4),VV3                                              09920021
         LM    XREG,YREG,PT2X                                           09940021
         BAL   INXREG,CHKPOINT                                          09960021
GEN2     MVC   PT2X(4),VV2              GENERATE RADII                  09980021
         MVC   PT2Y(4),YC               ON X AXIS                       10000021
         LM    XREG,YREG,PT2X                                           10020021
         BAL   INXREG,CHKPOINT          CHECK FOR OFF SCR/GRD.          10040021
GEN1     MVC   PT2X(4),VV1                                              10060021
         MVC   PT2Y(4),YC                                               10080021
         LM    XREG,YREG,PT2X                                           10100021
         BAL   INXREG,CHKPOINT                                          10120021
         B     RET                      RETURN TO CALLING PROGRAM.      10140021
CHKPOINT ST    INXREG,VALUE1                                            10160021
         OI    SGSW,X'0C'                                               10180021
         BAL   LINKREG,CHKOFF                                           10200021
         B     GRID                                                     10220021
         B     SCREEN                                                   10240021
         NI    SGSW,X'F0'                                               10260021
         TM    SGSW,X'F0'                                               10280021
         BO    GRID                                                     10300021
ONSCR    MVC   GDV1(2),XC+2             ALL POINTS ON SCREEN.           10320021
         MVC   GDV1+2(2),YC+2           PUT GDV'S NEEDED TO PUT         10340021
         STH   XREG,GDV2                VECTOR AS COMPUTED.             10360021
         STH   YREG,GDV2+2                                              10380021
PUTRAD1  OI    GDV1,X'40'               SET BEAM BIT OF GDV1 OFF.       10400021
         LA    CNTREG,8                                                 10420021
         LA    ADDREG,GDV1                                              10440021
         BAL   LINREG,STORE             STORE GDV'S IN GDOA.            10460021
         NI    SGSW,X'F0'                                               10480021
         L     INXREG,VALUE1            RETURN TO MAINLINE.             10500021
         BR    INXREG                                                   10520021
GRID      BAL  LINKREG,TSTGR            LINK TO TEST OFF GRID OPTION.   10540021
         B     LINKGR                         OFF GRID BRANCH.          10560021
         B     ONSCR                          SHOW ON SCREEN BRANCH.    10580021
         B     SEENI                          SHOW ON GRID ONLY.        10600021
SCREEN   BAL   LINKREG,TSTSR            LINK TO TEST OFF SCREEN OPTION. 10620021
         B     LINKSR                         SHOW ON SCREEN BRANCH.    10640021
         B     LINKGR                         SHOW ON GRID BRANCH.      10660021
SEENI    CLI   NI+3,X'02'               SEE IF TWO INTERSECT POINTS     10680021
         BE    TWOIN                                                    10700021
         CLI   NI+3,X'01'                                               10720021
         BE    ONEIN1                                                   10740021
         NI    SGSW,X'F0'                                               10760021
         L     INXREG,VALUE1            RETURN TO MAINLINE.             10780021
         BR    INXREG                                                   10800021
TWOIN    MVC   GDV1(4),INTS1X                                           10820021
         MVC   GDV2(4),INTS2X                                           10840021
         B     PUTRAD1                                                  10860021
ONEIN1   TM    SGSW,X'F0'                                               10880021
         BO    ONEIN2                                                   10900021
PUTCNTR  MVC   GDV1(2),XC+2                                             10920021
         MVC   GDV1+2(2),YC+2                                           10940021
         MVC   GDV2(4),INTS1X                                           10960021
         B     PUTRAD1                                                  10980021
ONEIN2   TM    SGSW,X'0F'               IF PT2 PART OF SGSW IS OFF,     11000021
         BZ    PUTP2                    BR TO PUT GDV PT2X,PT2Y,U.      11020021
         TM    SGSW,X'03'                                               11040021
         BO    PUTCNTR                                                  11060021
         MVC   GDV1(4),INTS1X             PUT GDV'S NEEDED TO GENERATE  11080021
         MVC   GDV2(4),INTS1X             POINT AT INTERSECT ONE.       11100021
         B     PUTRAD1                                                  11120021
PUTP2    STH   XREG,GDV2                                                11140021
         STH   YREG,GDV2+2                                              11160021
         MVC   GDV1(4),INTS1X                                           11180021
         B     PUTRAD1                                                  11200021
         EJECT                                                          11220021
*********************************************                           11240021
*   COMPUTE END POINTS OF 45 DEGREE RADII   *                           11260021
*********************************************                           11280021
GETUVAL  LH    EVEREG,COS45                    UU1=XC+MAXR*COS(45)      11300021
         SRDA  EVEREG,32                                                11320021
         M     EVEREG,MAXR                                              11340021
         AH    ODDREG,POINT5                                            11360021
         SRDA  EVEREG,14                                                11380021
         A     ODDREG,XC                                                11400021
         ST    ODDREG,UU1                                               11420021
         LH    EVEREG,SIN45                    UU1=YC+MAXR*SIN(45)      11440021
         SRDA  EVEREG,32                                                11460021
         M     EVEREG,MAXR                                              11480021
         AH    ODDREG,POINT5                                            11500021
         SRDA  EVEREG,14                                                11520021
         A     ODDREG,YC                                                11540021
         ST    ODDREG,UU2                                               11560021
         LH    EVEREG,COS45                    UU3=XC-MAXR*COS(45)      11580021
         SRDA  EVEREG,32                                                11600021
         M     EVEREG,MAXR                                              11620021
         AH    ODDREG,POINT5                                            11640021
         SRDA  EVEREG,14                                                11660021
         L     XREG,XC                                                  11680021
         SR    XREG,ODDREG                                              11700021
         ST    XREG,UU3                                                 11720021
         LH    EVEREG,SIN45                    UU4=YC-MAXR*SIN(45)      11740021
         SRDA  EVEREG,32                                                11760021
         M     EVEREG,MAXR                                              11780021
         AH    ODDREG,POINT5                                            11800021
         SRDA  EVEREG,14                                                11820021
         L     YREG,YC                                                  11840021
         SR    YREG,ODDREG                                              11860021
         ST    YREG,UU4                                                 11880021
*********************************************                           11900021
*   COMPUTE X- AND Y-COORDINATES (XE,YE)    *                           11920021
*   AND STORE THE GDV'S NEEDED TO GENERATE  *                           11940021
*   RADII AT +45 DEGREES FROM EACH AXIS.    *                           11960021
*********************************************                           11980021
         MVC   PT2X(8),UU1              SET END POINT FOR RADII AT 45   12000021
         MVC   TEMP(2),C56+2            DEGREES EQ TO UU1,UU2.          12020021
         LM    XREG,YREG,PT2X                                           12040021
         BAL   INXREG,CHECKUU                                           12060021
         MVC   PT2X(4),UU3              END POINT FOR RADII AT 135      12080021
         MVC   TEMP(2),MINUS56          DEGREES EQ TO UU3,UU2.          12100021
         LM    XREG,YREG,PT2X                                           12120021
         BAL   INXREG,CHECKUU                                           12140021
         MVC   PT2Y(4),UU4              END POINT FOR RADII AT 225      12160021
         MVC   TEMP(2),C56+2            DEGREES EQ TO UU3,UU4.          12180021
         LM    XREG,YREG,PT2X                                           12200021
         BAL   INXREG,CHECKUU                                           12220021
         MVC   PT2X(4),UU1              END POINT FOR RADII AT 315      12240021
         MVC   TEMP(2),MINUS56          DEGREES EQ TO UU1,UU4.          12260021
         LM    XREG,YREG,PT2X                                           12280021
         BAL   INXREG,CHECKUU                                           12300021
         B     GEN4                     GO TO PUT RADII ON X & Y AXIS.  12320021
CHECKUU  ST    INXREG,VALUE1                                            12340021
         OI    SGSW,X'0C'                                               12360021
         BAL   LINKREG,CHKOFF           LINK TO CHECK PT2.              12380021
         B     GRDOFF                   OFF GRID BRANCH.                12400021
         B     SCROFF                   OFF SCREEN BRANCH.              12420021
         NI    SGSW,X'F0'                                               12440021
         TM    SGSW,X'F0'               SEE IF XC,YC OFF GRID.          12460021
         BO    GRDOFF                                                   12480021
         B     PUT20RU                                                  12500021
GRDOFF   BAL   LINKREG,TSTGR            LINK TO TEST USER OPTION.       12520021
         B     LINKGR                   SHOW ON GRID.                   12540021
         B     PUT20RU                  SHOW ON SCREEN.                 12560021
         B     TESTNI                   GO TO TEST NUMBER OF INTERSECTS 12580021
SCROFF   BAL   LINKREG,TSTSR            LINK  TO TEST USER OPTION.      12600021
         B     LINKSR                   SHOW ON SCREEN.                 12620021
         B     LINKGR                   SHOW ON GRID.                   12640021
TESTNI   CLI   NI+3,X'02'                                               12660021
         BE    PUT2                                                     12680021
         CLI   NI+3,X'01'                                               12700021
         BE    PUT1A                                                    12720021
         NI    SGSW,X'F0'                                               12740021
         L     INXREG,VALUE1                                            12760021
         BR    INXREG                                                   12780021
PUT2     LH    YREG,INTS1Y              TWO INTERSECT POINTS.           12800021
         LH    XREG,INTS2Y                                              12820021
         CR    XREG,YREG                SEE IF INTS2 IS LT INTS1.       12840021
         BL    INT2LO                                                   12860021
         MVC   XE(4),INTS1X             START OF RADII IS INTERSECT 1.  12880021
         MVC   ZE(4),INTS2X                                             12900021
         B     PUTRAD2                                                  12920021
INT2LO   MVC   XE(4),INTS2X             START OF RADII IS INTERSECT 2   12940021
         MVC   ZE(4),INTS1X                                             12960021
         B     PUTRAD2                                                  12980021
PUT1A    TM    SGSW,X'F0'               SEE IF XC,YC OFF GRID.          13000021
         BO    PUT1B                                                    13020021
PUTXYC   L     YREG,YC                  ONE INTERSECT POINT.            13040021
         LH    XREG,INTS1Y                                              13060021
         CR    XREG,YREG                FIND LOW POINT OF RADII         13080021
         BL    INT1LO                                                   13100021
         MVC   XE(2),XC+2               START OF RADII IS XC,YC.        13120021
         MVC   YE(2),YC+2                                               13140021
         MVC   ZE(4),INTS1X             END OF RADII IS INTS1.          13160021
         B     PUTRAD2                                                  13180021
INT1LO   MVC   XE(4),INTS1X             START OF RADII IS INTS1.        13200021
         MVC   ZE(2),XC+2               END OF RADII IS XC,YC.          13220021
         MVC   ZE+2(2),YC+2                                             13240021
         B     PUTRAD2                                                  13260021
PUT1B    TM    SGSW,X'0F'               SEE IF BOTH POINTS OFF.         13280021
         BZ    FINDLO                                                   13300021
         TM    SGSW,X'03'                                               13320021
         BO    PUTXYC                                                   13340021
         MVC   GDV1(4),INTS1X           GENERATE POINT AT INTERSECT     13360021
         MVC   GDV2(4),INTS1X           ONE IF BOTH POINTS OFF GRID.    13380021
         B     PUTRAD1                                                  13400021
PUT20RU  MVC   INTS1X(2),XC+2                                           13420021
         MVC   INTS1Y(2),YC+2                                           13440021
FINDLO   LH    YREG,INTS1Y              FIND LOW POINT OF RADII.        13460021
         L     XREG,PT2Y                                                13480021
         CR    XREG,YREG                                                13500021
         BL    PT2LO                                                    13520021
         MVC   XE(4),INTS1X             INTS1 IS START OF RADII.        13540021
         MVC   ZE(2),PT2X+2             PT2 IS END OF RADII.            13560021
         MVC   ZE+2(2),PT2Y+2                                           13580021
         B     PUTRAD2                                                  13600021
PT2LO    MVC   XE(2),PT2X+2                                             13620021
         MVC   YE(2),PT2Y+2             PT2 IS START OF RADII.          13640021
         MVC   ZE(4),INTS1X             INTS1 IS END OF RADII.          13660021
PUTRAD2  MVC   GDV1(2),XE               SET UP A GDV FOR POSITIONING    13680021
         MVC   GDV1+2(2),YE             BEAM AT XE,YE BLANKED.          13700021
         OI    GDV1,X'40'                                               13720021
         LA    CNTREG,4                                                 13740021
         LA    ADDREG,GDV1                                              13760021
         BAL   LINREG,STORE                                             13780021
NEWXE    LH    EVEREG,XE                XE=XE+TEMP                      13800021
         AH    EVEREG,TEMP                                              13820021
         STH   EVEREG,XE                                                13840021
         LH    EVEREG,YE                YE=YE+56                        13860021
         AH    EVEREG,C56+2                                             13880021
         STH   EVEREG,YE                                                13900021
         CH    EVEREG,ZE+2                                              13920021
         BNL   LAST1                                                    13940021
         MVC   GDV1(2),XE               SET UP GDV FOR NEW              13960021
         MVC   GDV1+2(2),YE             BEAM POSITION.                  13980021
         LA    ADDREG,GDV1              GDV1= GDV XE,YE,U               14000021
         LA    CNTREG,4                                                 14020021
         BAL   LINREG,STORE                                             14040021
         B     NEWXE                                                    14060021
LAST1    MVC   GDV1(4),ZE               SET UP GDV TO COMPLETE RADII.   14080021
         LA    ADDREG,GDV1                                              14100021
         LA    CNTREG,4                                                 14120021
         BAL   LINREG,STORE                                             14140021
         NI    SGSW,X'F0'                                               14160021
         L     INXREG,VALUE1                                            14180021
         BR    INXREG                                                   14200021
LINKGR   ST    XYLREG,SABL                                              14220021
         B     PT2ON                                                    14240021
LINKSR   OI    SGSW,X'03'                                               14260021
         LA    WRKREG,ZERO                                              14280021
         ST    WRKREG,SABL                                              14300021
PT2ON    STM   XREG,YREG,PT2X           STORE COORDINATES IN PT2X,PT2Y. 14320021
         STM   14,1,SAVE                STORE VITAL REGISTERS.          14340021
         ST    13,OVFSAVE+4                                             14360021
         ST    15,SVR15                 SAVE ERROR REGISTER             14380021
         LA    13,OVFSAVE               SET UP SAVE AREA FOR GOFFSG,    14400021
         LR    WRKREG,WKAREG            SAVE WORK AREA ADDRESS          14420021
         CLI   LOADSW,X'FF'             IF LOADSW IS ON, BR TO GET ADDR 14440021
         BE    GETIT                    OF GOFFSG. IF LOADSW IS OFF,    14460021
         LA    1,SABL                   AND POINT TO PARAMETER TABLE.   14480021
         LOAD EP=GOFFSG                 GET ADDR OF OFF SCREEN/GR1D RTN 14500021
         LR    WKAREG,WRKREG                                            14520021
         ST    0,LOADSW                 STORE ADDR OF GOFFSG ROUTINE.   14540021
         OI    LOADSW,X'FF'             SET LOAD SWITCH ON.             14560021
GETIT    L     15,LOADSW                LOAD ADDR OF GOFFSG ROUTINE AND 14580021
         LA    1,SABL                   POINT TO WORK AREA              14600021
         BALR  14,15                    BRANCH & LINK TO GOFFSG.        14620021
RESET    LR    WKAREG,WRKREG                                            14640021
         LM    14,0,SAVE                                                14660021
         L     13,OVFSAVE+4             RESTORE SAVE AREA ADDRESS.      14680021
         L     15,SVR15                 RESTORE ERROR REGISTER          14700021
         B     8(0,LINKREG)                                             14720021
         EJECT                                                          14740021
*********************************************                           14760021
*        XYLCHK     SUBROUTINE              *                           14780021
*        ADDRESS OF XYLIM TABLE IN XYLREG   *                           14800021
*********************************************                           14820021
XYLCHK   LA    CNTREG,4                 SET  LOOP  COUNT                14840021
         LA    INXREG,0                 SET  INDEX                      14860021
XYLLOOP  LH    WRKREG,0(XYLREG,INXREG)  LOAD  X1,Y1,X2,Y2               14880021
         C     WRKREG,ZERO                                              14900021
         BL    XYLERR                                                   14920021
         C     WRKREG,HIGH                                              14940021
         BH    XYLERR                                                   14960021
         A     INXREG,TWO                                               14980021
         BCT   CNTREG,XYLLOOP                                           15000021
         CLC   0(2,XYLREG),4(XYLREG)    X1 COMP  X2                     15020021
         BNL   XYLERR                                                   15040021
         CLC   2(2,XYLREG),6(XYLREG)    Y1 COMP  Y2                     15060021
         BNL   XYLERR                                                   15080021
         BR    LINREG                                                   15100021
XYLERR   LA    15,4                     SET ERROR CODE = 4              15120021
         BAL   LINREG,ERRCNT                                            15140021
         B     RET                                                      15160021
ER8      LA    ERREG,8                  UC,VC PARAMETER ERROR,          15180021
         BAL   LINREG,ERRCNT            IMMEDIATE RETURN.               15200021
         B     RET                                                      15220021
ER16     BAL   LINREG,ERRCNT                                            15240021
         LA    ERREG,16                                                 15260021
         B     RET                                                      15280021
ER20     LA    ERREG,20                 INPUT PARAMETER ERROR,          15300021
         BAL   LINREG,ERRCNT            IMMEDIATE RETURN.               15320021
         B     RET                                                      15340021
ER28     LA    ERREG,28                 S/G OPTION = D.                 15360021
         B     ERRCNT                                                   15380021
ER32     LA    ERREG,32                 S/G OPTION = C OR E.            15400021
         B     ERRCNT                                                   15420021
ER40     LA    ERREG,40                 INPUT PARAMETER ERROR,          15440021
         BAL   LINREG,ERRCNT            COUNT ERRORS AND CONTINUE.      15460021
         BR    LINKREG                                                  15480021
ER44     LA    ERREG,44                 S/G OPTION = A.                 15500021
         B     ERRCNT                                                   15520021
ER48     LA    ERREG,48                 S/G OPTION = B.                 15540021
ERRCNT   L     TEMREG,ERCOUNT                                           15560021
         A     TEMREG,ONE                                               15580021
         ST    TEMREG,ERCOUNT                                           15600021
         BR    LINREG                                                   15620021
RET      LA    TEMREG,1                                                 15640021
         C     TEMREG,ERCOUNT                                           15660021
         BL    SETBIT                                                   15680021
RETURN   CLI   LOADSW,X'00'                                             15700021
         BE    RETMACRO                                                 15720021
         ST    15,SVR15                 SAVE ERROR REGISTER             15740021
         LR    WRKREG,1                 SAVE REGISTER 1                 15760021
DELETE   DELETE EP=GOFFSG                                               15780021
         LR    1,WRKREG                 RESTORE REGISTER 1              15800021
         L     15,SVR15                 RESTORE ERROR REGISTER          15820021
* RESTORE PROGRAM MASK TO SETTING UPON ENTRY                            15840021
RETMACRO L     WRKREG,MASKSV                                            15860021
         SPM   WRKREG                                                   15880021
         RETURN (14,12),T,RC=(15)                                       15900021
SETBIT   O     15,MZERO                                                 15920021
         B     RETURN                                                   15940021
         EJECT                                                          15960021
SCALFLT  LA    CONREG,4                 LOOP  COUNT                     15980021
         LA    INXREG,0                 SET INDEX                       16000021
         LA    WRKREG,0                                                 16020021
FLTLOOP  LH    VALREG,0(XYLREG,INXREG)  GET X1Y1,X2Y2 VALUES            16040021
         BAL   LINREG,FLTCONV                                           16060021
         ST    VALREG,4(WKAREG,WRKREG)                                  16080021
         A     INXREG,TWO                                               16100021
         A     WRKREG,FOUR                                              16120021
         BCT   CONREG,FLTLOOP                                           16140021
***********************************************                         16160021
*   SUBROUTINE TO SCALE FLOATING  *                                     16180021
*   POINT COORDINATES UC,VC.      *                                     16200021
***********************************************                         16220021
         LE    0,UC                                                     16240021
         SE    0,U1                     UC-U1                           16260021
         LE    2,12(WKAREG)             LOAD CONVERTED X2.              16280021
         SE    2,4(WKAREG)              X2-X1                           16300021
         MER   0,2                      (UC-U1)*(X2-X1)                 16320021
         LE    2,U2                                                     16340021
         SE    2,U1                     U2-U1                           16360021
         BNP   ER16                                                     16380021
         DER   0,2                      ((UC-U1)*(X2-X1))/(U2-U1)       16400021
         AE    0,4(WKAREG)              ADD X1 TO COMPLETE FUNCTION.    16420021
         L     VALREG,0(WKAREG)                                         16440021
         STE   0,0(WKAREG)                                              16460021
         BAL   LINREG,FIXCONV                                           16480021
         ST    VALREG,XC                                                16500021
         LE    0,VC                                                     16520021
         SE    0,V1                                                     16540021
         LE    2,16(WKAREG)                                             16560021
         SE    2,8(WKAREG)                                              16580021
         MER   0,2                                                      16600021
         LE    2,V2                                                     16620021
         SE    2,V1                     V2-V1                           16640021
         BNP   ER16                                                     16660021
         DER   0,2                      ((VC-V1)*(Y2-Y1)/(V2-V1)        16680021
         AE    0,8(WKAREG)              ADD Y1 TO COMPLETE FUNCTION     16700021
         L     VALREG,0(WKAREG)                                         16720021
         STE   0,0(WKAREG)                                              16740021
         BAL   LINREG,FIXCONV                                           16760021
         ST    VALREG,YC                                                16780021
         BR    LINKREG                                                  16800021
**************************************************                      16820021
*   SUBROUTINE TO SCALE FLOATING POINT VALUES    *                      16840021
*   SVAL=XINC*((X2-X1)/(U2-U1))  XINC=RINC OR MRU*                      16860021
*   SVAL REPRESENTS RINC OR MRU SCALED           *                      16880021
**************************************************                      16900021
FLTSCAL  LE    0,12(WKAREG)             X2                              16920021
         SE    0,4(WKAREG)              -X1                             16940021
         ME    0,VALUE1                 *UI                             16960021
         LE    2,12(XYLREG)             U2                              16980021
         SE    2,8(XYLREG)              -U1                             17000021
         DER   0,2                                                      17020021
         STE   0,0(WKAREG)                                              17040021
         L     XREG,0(WKAREG)           XREG CONTAINS SCALED FP UI      17060021
         L     VALREG,0(WKAREG)                                         17080021
         BAL   LINREG,FIXCONV           BR AND LINK TO CONVERT RTN.     17100021
         LR    XREG,VALREG              LOAD XREG WITH SCALED INC       17120021
         BR    LINKREG                  AND RETURN TO MAINLINE.         17140021
         EJECT                                                          17160021
*********************************************                           17180021
*   CONVERT FLOATING POINT TO FIXED POINT   *                           17200021
*   VALREG = VALUE TO BE CONVERTED          *                           17220021
*********************************************                           17240021
FCONVERT LR    VALREG,XREG              FIXCONVERT -(CONVERT FLOAT      17260021
         BAL   LINREG,FIXCONV           TO FIX)                         17280021
         LR    XREG,VALREG                                              17300021
         LR    VALREG,YREG                                              17320021
         BAL   LINREG,FIXCONV                                           17340021
         LR    YREG,VALREG                                              17360021
         BR    LINKREG                                                  17380021
FIXCONV  ST    1,OVFSAVE                STORE REG 1 IN WORK AREA        17400021
         TM    OVFSAVE+3,X'07'          TEST LAST THREE BITS            17420021
         BZ    *+12                     NO BITS ON, SET INDEX TO ZERO   17440021
         LA    TEMREG,4                 SET MODIFIER                    17460021
         B     *+8                      START CONVERSION                17480021
         LA    TEMREG,0                 SET MODIFIER TO ZERO            17500021
         ST    VALREG,TEMFLT(TEMREG)    SAVE FLOAT VALUE                17520021
         SR    WRKREG,WRKREG                                            17540021
         ST    WRKREG,TEMFLT+4(TEMREG)  CLEAR SECOND WORD               17560021
         LD    6,TEMFLT(TEMREG)         VALUE TO FLOAT REGISTERS        17580021
         N     VALREG,FCHAR                                             17600021
         BE    FLERR1                   CHARACTERISTIC IS ZERO          17620021
         AE    6,FLPT5                  ADD .5 TO ROUND                 17640021
         AW    6,X4E                    ADD UNNORMALIZED-RIGHT JUSTIFY  17660021
         STD   6,TEMFLT(TEMREG)         SAVE VALUES                     17680021
         L     WRKREG,TEMFLT+4(TEMREG)  CHECK SECOND WORD               17700021
         N     WRKREG,MZERO             CHECK BIT 32                    17720021
         BM    ER12                     BRANCH ON MINUS                 17740021
         L     WRKREG,TEMFLT(TEMREG)                                    17760021
         N     WRKREG,BYTE123                                           17780021
         BM    ER12                     BRANCH ON MINUS                 17800021
         L     WRKREG,TEMFLT(TEMREG)                                    17820021
         N     WRKREG,MZERO             DROP CHARACTERISTIC             17840021
         L     VALREG,TEMFLT+4(TEMREG)  NEW FIXED VALUE                 17860021
         LTR   WRKREG,WRKREG                                            17880021
         BNL   NOTNEG                   NOT NEGATIVE                    17900021
         LNR   VALREG,VALREG            TAKE TWO'S COMPLEMENT           17920021
NOTNEG   BR    LINREG                   RETURN TO MAINLINE.             17940021
FLERR1   CE    6,ZERO                   IS TOTAL VALUE ZERO             17960021
         BE    NOTNEG                   RETURN                          17980021
         B     ER12                     ERROR 12                        18000021
ER12   LA    ERREG,12                                                   18020021
       BAL   LINKREG,ERRCNT                                             18040021
       B     RET                                                        18060021
**************************************************                      18080021
*    CONVERT  FIXED  POINT  TO  FLOATING  POINT  *                      18100021
*    VALREG CONTAINS THE VALUE TO BE CONVERTED   *                      18120021
**************************************************                      18140021
FLTCONV  O     VALREG,X6                EXPONENT OF 6                   18160021
         ST    VALREG,0(WKAREG)                                         18180021
         LE    0,0(WKAREG)              LOAD FLOATING PT REG            18200021
         AE    0,X6                     NORMALIZE                       18220021
         STE   0,0(WKAREG)                                              18240021
         L     VALREG,0(WKAREG)         FLOAT PT VAL IN VALREG          18260021
         BR    LINREG                                                   18280021
         EJECT                                                          18300021
**********************************                                      18320021
*   SUBROUTINE TO SCALE FIXED     *                                     18340021
*   FIXED POINT COORDINATES UC,VC *                                     18360021
***********************************                                     18380021
SCALFIX  S     XREG,U1                  COMPUTE UC-U1                   18400021
         LR    ODDREG,XREG              LOAD MULTIPLICAND               18420021
         LH    XREG,X2                                                  18440021
         SH    XREG,X1                  COMPUTE X2-X1                   18460021
         SR    EVEREG,EVEREG                 AND                        18480021
         MR    EVEREG,XREG              (UC-U1)*(X2-X1)                 18500021
         L     XREG,U2                                                  18520021
         S     XREG,U1                  COMPUTE U2-U1                   18540021
         BNP   ER16                                                     18560021
         DR    EVEREG,XREG              COMPUTE ((UC-U1)<(X2-X1))/U2-U1 18580021
         AH    ODDREG,X1                COMPLETE FUNCTION BY ADDING X1. 18600021
         LR    XREG,ODDREG              RETURN SCALED VALUE IN XREG.    18620021
         S     YREG,V1                  COMPUTE VC-V1                   18640021
         LR    ODDREG,YREG                                              18660021
         LH    YREG,Y2                                                  18680021
         SH    YREG,Y1                  COMPUTE Y2-Y1                   18700021
         SR    EVEREG,EVEREG                                            18720021
         MR    EVEREG,YREG              (VC-V1)*(Y2-Y1)                 18740021
         L     YREG,V2                                                  18760021
         S     YREG,V1                  COMPUTE V2-V1                   18780021
         BNP   ER16                                                     18800021
         DR    EVEREG,YREG              COMPUTE ((VC-V1)*(Y2-Y1))/U2-V1 18820021
         AH    ODDREG,Y1                COMPLETE FUNCTION BY ADDING Y1. 18840021
         LR    YREG,ODDREG              RETURN SCALED VALUE IN YREG.    18860021
         BR    LINREG                   RETURN TO MAINLINE.             18880021
**************************************************                      18900021
*   SUBROUTINE TO SCALE   FIXED  POINT  VALUES   *                      18920021
*   SVAL=XINC*((X2-X1)/(U2-U1))  XINC=RINC OR MRU*                      18940021
*   SVAL REPRESENTS RINC OR MRU SCALED           *                      18960021
**************************************************                      18980021
FIXSCAL  LH    ODDREG,4(XYLREG)         X2                              19000021
         SH    ODDREG,0(XYLREG)         -X1                             19020021
         SR    EVEREG,EVEREG            ZERO EVEN REG                   19040021
         MR    EVEREG,XREG              * UI                            19060021
         L     XREG,12(XYLREG)          U2                              19080021
         S     XREG,8(XYLREG)           -U1                             19100021
         BNP   ER16                                                     19120021
         SR    EVEREG,EVEREG            ZERO EVEN REG                   19140021
         DR    EVEREG,XREG                                              19160021
         LR    XREG,ODDREG              SCALED U VALUE IN XREG          19180021
         BR    LINREG                                                   19200021
         EJECT                                                          19220021
*********************************************                           19240021
* STORE GRAPHIC DATA IN GDOA FOR POR        *                           19260021
* INPUT TO SUBROUTINE                       *                           19280021
*   CNTREG = NUMBER OF BYTES TO BE STORED   *                           19300021
*   ADDREG = ADDRESS OF THE GRAPHIC DATA    *                           19320021
*   WKAREG = WORK AREA ADDRESS              *                           19340021
*   OABREG = ADDRESS OF OACB                *                           19360021
*********************************************                           19380021
STORE    SR    PASREG,PASREG            CLEAR OVERFLOW PASS INDICATOR   19400021
STORE1   L     OLPREG,16(0,OABREG)      ADDRESS OF OLP FROM OACB        19420021
         LR    WRKREG,CNTREG            LOAD BYTES TO MOVE              19440021
* CALCULATE ADDRESSES BASED ON N VALUE AND SIZE OF GDOA                 19460021
STORE2   AR    OLPREG,WRKREG            OLP ADDRESS PLUS N VALUE        19480021
         LA    TEMREG,4                                                 19500021
         AR    TEMREG,OLPREG            OLP PLUS N PLUS 4               19520021
         L     SLOREG,0(OABREG)         SLOA ADDRESS                    19540021
         A     SLOREG,4(OABREG)         ADD LOA EQUALS TOTAL GDOA       19560021
         CR    TEMREG,SLOREG                                            19580021
         L     OLPREG,16(0,OABREG)      RESET INITIAL OLP ADDRESS       19600021
         BNH   OK                                                       19620021
* NOT ENOUGH ROOM TO STORE ALL OF THE DATA-DETERMINE AMOUNT TO STORE    19640021
         SR    TEMREG,SLOREG            EQUAL BYTES-CAN'T STORE         19660021
         SR    WRKREG,TEMREG            NUMBER OF BYTES CAN STORE       19680021
* ANY BYTES TO STORE                                                    19700021
         C     WRKREG,ZERO                                              19720021
         BNH   STORE4                   LESS OF EQUAL TO ZERO           19740021
         LH    TEMREG,H2A02                                             19760021
         CH    TEMREG,GOMODE                                            19780021
         BH    STORE3A                                                  19800021
         LH    TEMREG,H0003                                             19820021
         NR    TEMREG,WRKREG                                            19840021
         BM    STORE4      GO TO USER OVERFLOW ROUTINE (IAPG)      7468 19860021
STORE3A  SR    CNTREG,WRKREG       BYTES REMAINING                      19880021
         BAL   INTLNK,STORE6            LINK INTERNALLY                 19900021
STORE3   LA    PASREG,1                 SET PASS INDICATOR              19920021
* STORE REGISTERS IN WORKAREA                                           19940021
         STM   0,15,0(WKAREG)           SAVE REGISTERS IN WORKAREA      19960021
         CLI   LOADSW,X'FF'                                             19980021
         BNE   LOADREG                                                  20000021
         LR    3,1                      SAVE REG 1.                     20020021
         DELETE EP=GOFFSG                                               20040021
         LR    1,3                      RESTORE REG 1.                  20060021
LOADREG  L     15,8(0,OABREG)       OVERFLOW ADDRESS                    20080021
         LM    2,12,28(13)           RELOAD USERS REG                   20100021
         BALR  14,15                    LINK TO ROUTINE-SET RETURN      20120021
         MVI   LOADSW,X'00'                                             20140021
         LM    0,15,0(WKAREG)           RELOAD FROM WORKAREA            20160021
         B     STORE1                   GET NEW OLP ADDRESS-CONTINUE    20180021
* NO SPACE AVAILABLE                                                    20200021
STORE4   C     PASREG,ONE               WAS A TRANSFER TO OVERFLOW MADE 20220021
         BL    STORE3                                                   20240021
*                                                                       20260021
* SET ERROR CODE AND RETURN TO POR-LEAVE POR WITH RETURN MACRO          20280021
         LA    15,28                    SET ERROR CODE REG.             20300021
         B     RET                      SYMBOLIC IN POR                 20320021
OK       BAL   INTLNK,STORE6            LINK INTERNALLY                 20340021
         BR    LINREG                                                   20360021
STORE6   LA    TEMREG,255               SET REG. EQUAL TO 255           20380021
STORE6A  CR    WRKREG,TEMREG            IS AMOUNT TO MOVE OVER 255      20400021
         BH    STORE7                                                   20420021
         LR    TEMREG,WRKREG                                            20440021
         S     TEMREG,ONE               COMPENSATE FOR EXTRA BYTE       20460021
         EX    TEMREG,MOVE              MOVE GRAPHIC DATA               20480021
         AR    OLPREG,WRKREG            UPDATE OLP ADDRESS              20500021
         AR    ADDREG,WRKREG            UPDATE DATA ADDR                20520021
         ST    OLPREG,16(0,OABREG)      STORE NEW OLP ADDRESS           20540021
         BR    INTLNK                   RETURN INTERNALLY               20560021
STORE7   LR    SLOREG,TEMREG                                            20580021
         S     SLOREG,ONE               COMPENSATE FOR EXTRA BYTE       20600021
         EX    SLOREG,MOVE              MOVE GRAPHIC DATA               20620021
         AR    OLPREG,TEMREG            UPDATE OLP ADDRESS              20640021
         AR    ADDREG,TEMREG            UPDATE INPUT ADDRESS            20660021
         SR    WRKREG,TEMREG           REDUCE BY 255                    20680021
         B     STORE6A                  MAKE NEXT COMPARISON            20700021
MOVE     MVC   0(0,OLPREG),0(ADDREG)    MOVE DATA TO GDOA               20720021
         CNOP  0,4                                                      20740021
         EJECT                                                          20760021
******************************                                          20780021
*   CONSTANTS USED BY GPGRID *                                          20800021
******************************                                          20820021
         DS    0D                                                       20840021
X4E      DC    X'4E00000000000000'                                      20860021
ZERO     DC    F'0'                                                     20880021
H4095    DC    H'4095,4095'                                             20900021
ONE      DC    F'1'                                                     20920021
TWO      DC    F'2'                                                     20940021
FOUR     DC    F'4'                                                     20960021
FLPT5    DC    E'.5'                                                    20980021
C56      DC    F'56'                                                    21000021
C360     DC    F'360'                                                   21020021
C1365    DC    F'1365'                                                  21040021
C4095    DC    F'4095'                                                  21060021
C5793    DC    F'5793'                                                  21080021
TWOPI    DC    FS28'6.2832'                                             21100021
HIGH     DC    F'4095'                                                  21120021
BYTE123  DC    X'00FFFFFF'                                              21140021
FCHAR    DC    X'7F000000'                                              21160021
XZERO    DC    X'80FFFFFF'                                              21180021
X6       DC    X'46000000'                   EXPONENT OF SIX            21200021
MZERO    DC    X'80000000'                                              21220021
POINT5   DC    HS14'.5'                                                 21240021
MINUS1   DC    H'-1'                                                    21260021
MINUS2   DC    H'-2'                                                    21280021
MINUS56  DC    H'-56'                                                   21300021
C8       DC    H'8'                                                     21320021
C45      DC    H'45'                                                    21340021
C46      DC    H'46'                                                    21360021
C90      DC    H'90'                                                    21380021
C136     DC    H'136'                                                   21400021
C180     DC    H'180'                                                   21420021
C226     DC    H'226'                                                   21440021
C270     DC    H'270'                                                   21460021
C315     DC    H'315'                                                   21480021
H360     DC    H'360'                                                   21500021
H2A02    DC    X'2A02'                                                  21520021
H0003    DC    H'0003'                                                  21540021
GEPM     DC    X'2A00'                                                  21560021
GEVM     DC    X'2A02'                                                  21580021
LOGJ     DC    HS14'.3010,.4771,.6021,.6990,.7782,.8451,.9031,.9542'    21600021
*   LOGJ TABLE=LOG VALUES FOR THE CYCLES OF LOG GRID. WHEN J=2,3,4,...9 21620021
LOGTBL   EQU   LOGJ                                                     21640021
         EJECT                                                          21660021
******************************                                          21680021
*    SINE/COSINE TABLE       *                                          21700021
******************************                                          21720021
SCTBL    DC    HS14'0.0000,1.0000,0.0175,0.9999'             0- 1       21740021
         DC    HS14'0.0349,0.9994,0.0523,0.9986'             2- 3       21760021
         DC    HS14'0.0698,0.9976,0.0872,0.9962'             4- 5       21780021
         DC    HS14'0.1045,0.9945,0.1219,0.9926'             6- 7       21800021
         DC    HS14'0.1392,0.9903,0.1564,0.9877'             8- 9       21820021
         DC    HS14'0.1737,0.9848,0.1908,0.9816'            10-11       21840021
         DC    HS14'0.2079,0.9782,0.2250,0.9744'            12-13       21860021
         DC    HS14'0.2419,0.9703,0.2588,0.9659'            14-15       21880021
         DC    HS14'0.2756,0.9613,0.2924,0.9563'            16-17       21900021
         DC    HS14'0.3090,0.9511,0.3256,0.9455'            18-19       21920021
         DC    HS14'0.3420,0.9397,0.3584,0.9336'            20-21       21940021
         DC    HS14'0.3746,0.9272,0.3907,0.9205'            22-23       21960021
         DC    HS14'0.4067,0.9136,0.4226,0.9063'            24-25       21980021
         DC    HS14'0.4384,0.8988,0.4540,0.8910'            26-27       22000021
         DC    HS14'0.4695,0.8830,0.4848,0.8746'            28-29       22020021
         DC    HS14'0.5000,0.8660,0.5150,0.8572'            30-31       22040021
         DC    HS14'0.5299,0.8481,0.5446,0.8387'            32-33       22060021
         DC    HS14'0.5592,0.8290,0.5736,0.8192'            34-35       22080021
         DC    HS14'0.5878,0.8090,0.6018,0.7986'            36-37       22100021
         DC    HS14'0.6157,0.7880,0.6293,0.7772'            38-39       22120021
         DC    HS14'0.6428,0.7660,0.6561,0.7547'            40-41       22140021
         DC    HS14'0.6691,0.7431,0.6820,0.7314'            42-43       22160021
S4445    DC    HS14'0.6947,0.7193,0.7071,0.7071'            44-45       22180021
SINE     EQU   SCTBL                                                    22200021
COSINE   EQU   SCTBL+2                                                  22220021
SIN45    EQU   S4445+4                                                  22240021
COS45    EQU   S4445+6                                                  22260021
         EJECT                                                          22280021
******************************                                          22300021
******************************                                          22320021
*   PARAMETER TABLE FORMAT   *                                          22340021
******************************                                          22360021
PARTAB   DSECT                                                          22380021
XYLIM    DS    CL4                      ADDR OF XY LIMIT TABLE.         22400021
UC       DS    CL4                      X-COORDINATE OF ARC CENTER.     22420021
VC       DS    CL4                      Y-COORDINATE OF ARC CENTER.     22440021
F        DS    CL1                      FIXED/FLOATING POINT INDICATOR. 22460021
S        DS    CL1                      SCALING INDICATOR.              22480021
INC      DS    CL1                      ALPHA/DENSITY INDICATOR.        22500021
OFFSG    DS    CL1                      OFF SCREEN/GRID OPTION IND.     22520021
RINC     DS    CL4                      INCREMENT IN RADIAL DIRECTION.  22540021
NR       DS    CL2                      # OF RADII                      22560021
DENSITY  DS    CL2                   ** DENSITY OF CONSECUTIVE POINTS.  22580021
ALPHA    EQU   DENSITY               ** DEGREE OF SUCCESIVE POINTS.     22600021
MAXRAD   DS    CL4                      MAXIMUM LENGTH OF RADIUS.       22620021
TYPE     DS    CL1                      GRID TYPE.                      22640021
         EJECT                                                          22660021
******************************                                          22680021
*   GPGRID USE OF WORK AREA  *                                          22700021
******************************                                          22720021
WKAREA   DSECT                                                          22740021
OVFSAVE  DS    0CL72                                                    22760021
TEMFLT   DS    0CL8                                                     22780021
         DS    CL128                                                    22800021
SABL     DS    CL4                                                      22820021
PT1X     DS    CL4                                                      22840021
PT1Y     DS    CL4                                                      22860021
PT2X     DS    CL4                                                      22880021
PT2Y     DS    CL4                                                      22900021
NI       DS    CL4                                                      22920021
INTS1X   DS    CL2                                                      22940021
INTS1Y   DS    CL2                                                      22960021
INTS2X   DS    CL2                                                      22980021
INTS2Y   DS    CL2                                                      23000021
         DS    CL64                                                     23020021
SAVE     DS    CL16                                                     23040021
LOADSW   DS    CL4                                                      23060021
GDV1     DS    CL4                                                      23080021
GDV2     DS    CL4                                                      23100021
XC       DS    CL4                                                      23120021
YC       DS    CL4                                                      23140021
MAXR     DS    CL4                                                      23160021
RINK     DS    CL4                                                      23180021
R        DS    CL4                                                      23200021
VALUE1   DS    CL4                                                      23220021
UU1      DS    CL4                                                      23240021
UU2      DS    CL4                                                      23260021
UU3      DS    CL4                                                      23280021
UU4      DS    CL4                                                      23300021
VV1      DS    CL4                                                      23320021
VV2      DS    CL4                                                      23340021
VV3      DS    CL4                                                      23360021
VV4      DS    CL4                                                      23380021
I        DS    CL4                                                      23400021
SVR15    DS    CL4                      PLACE TO SAVE ERROR REGISTER    23420021
ERCOUNT  DS    CL4                                                      23440021
ALPH     DS    CL2                                                      23460021
NPT      DS    CL2                                                      23480021
PHI      DS    CL2                                                      23500021
K        DS    CL2                                                      23520021
LOGSAV   DS    CL2                                                      23540021
TEMP     DS    CL2                                                      23560021
XE       DS    CL2                                                      23580021
YE       DS    CL2                                                      23600021
ZE       DS    CL4                                                      23620021
SGSW     DS    CL1                                                      23640021
FUNCSW   DS    CL1                                                      23660021
INK      DS    CL1                                                      23680021
J        DS    CL1                                                      23700021
MASKSV   DS    F                   SAVE SETTING OF USER PROGRAM MASK    23720021
         ORG   OVFSAVE+396                                              23740021
GOMODE   DS    CL2                                                      23760021
XYLIMT   DSECT                                                          23780021
X1       DS    CL2                                                      23800021
Y1       DS    CL2                                                      23820021
X2       DS    CL2                                                      23840021
Y2       DS    CL2                                                      23860021
U1       DS    CL4                                                      23880021
U2       DS    CL4                                                      23900021
V1       DS    CL4                                                      23920021
V2       DS    CL4                                                      23940021
         END                                                            23960021
