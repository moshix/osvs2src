* %/* START OF SPECIFICATIONS****                                       00052000
         MACRO                                                          00060003
&SYMBOL  ICBACREL &MF=,&TYPE=,&FLAGS=,&VOLID=,&ECB=,&EXTS=,            *00070003
               &HOSTID=,&NMEXTS=                                        00080003
.************************************************************  @ZA28964 00090000
.*                                                             @Y30LB02 00100003
.* MODULE-NAME = ICBACREL                                      @Y30LB02 00150000
.*                                                             @Y30LB02 00200003
.* DESCRIPTIVE-NAME = ACQUIRE/RELINQUISH MACRO                 @Y30LB02 00250000
.*                                                             @Y30LB02 00300003
.* COPYRIGHT = NONE                                            @Y30LB02 00350000
.*                                                             @Y30LB02 00400003
.* STATUS = OPERATING SYSTEM = VS/2 REL 3                      @ZA28964 00450000
.*                                                             @Y30LB02 00550003
.* FUNCTION = THE ACQUIRE REQUEST IS ISSUED IF THE CALLER      @Y30LB02 00600000
.*            WISHES TO HAVE DASD SPACE ALLOCATED FOR A        @Y30LB02 00610000
.*            DATA RESOURCE AND, OPTIONALLY, IF THE DATA       @Y30LB02 00620000
.*            EXTENTS ARE TO BE STAGED. THE RELINQUISH         @Y30LB02 00630000
.*            REQUEST IS ISSUED WHEN A DATA RESOURCE IS TO     @Y30LB02 00640000
.*            HAVE ITS DASD SPACE MADE AVAILABLE FOR           @Y30LB02 00642000
.*            REALLOCATION AND, OPTIONALLY, IF ITS DASD        @Y30LB02 00644000
.*            EXTENTS ARE TO BE DESTAGED FROM THE              @Y30LB02 00646000
.*            REAL DASD.                                       @Y30LB02 00648000
.*                                                             @Y30LB02 00648400
.* NOTES =                                                     @Y30LB02 00648800
.*                                                             @Y30LB02 00649200
.*   CODE = MACRO IS BILINGUALLY CODED. IN THE ORIGINAL        @ZA28964 00649600
.*          VERSION OF THIS MACRO, THE BAL AND PL/S SECTIONS   @ZA28964 00650600
.*          ASSIGNED DIFFERENT LABELS TO THE SAME REQUEST      @ZA28964 00651600
.*          BLOCK STRUCTURE. TO MAINTAIN COMPATABILITY, THE    @ZA28964 00652600
.*          ALTERNATE PL/S LABELS HAVE BEEN ADDED TO THE BAL   @ZA28964 00653600
.*          REQUEST BLOCKS, AND THE ALTERNATE BAL LABELS       @ZA28964 00654600
.*          ADDED TO THE PL/S REQUEST BLOCKS.                  @ZA28964 00655600
.*                                                             @Y30LB02 00656600
.*   DEPENDENCIES = NONE                                       @Y30LB02 00657600
.*                                                             @Y30LB02 00658600
.*   RESTRICTIONS = THE PREFIXES ICB AND AR SHOULD BE          @Y30LB02 00659600
.*                  AVOIDED IN THE INVOKING MODULE LABELS.     @ZA28964 00660600
.*                  SVC 126, WHICH IS INVOKED BY THIS MACRO,   @ZA28964 00661600
.*                  REQUIRES THAT THE CALLER BE APF-           @ZA28964 00662600
.*                  AUTHORIZED, IN PROTECTION KEY 0 OR         @ZA28964 00663600
.*                  IN SUPERVISOR STATE.                       @ZA28964 00664600
.*                                                             @Y30LB02 00680600
.*   REGISTER-CONVENTIONS = FOLLOWS NORMAL USE OF REGISTERS    @Y30LB02 00682600
.*                          BY MACROS: R0,R1,R14 AND R15       @Y30LB02 00683000
.*                                                             @Y30LB02 00683100
.*   PATCH-LABEL = NONE                                        @Y30LB02 00683200
.*                                                             @Y30LB02 00688800
.* MODULE-TYPE = MACRO                                         @Y30LB02 00690800
.*                                                             @Y30LB02 00692800
.*   PROCESSOR = ASSEM                                         @Y30LB02 00693200
.*               PL/S                                          @Y30LB02 00693600
.*                                                             @Y30LB02 00694000
.*   ATTRIBUTES = REUSABLE                                     @Y30LB02 00694200
.*                REENTRANT (EXECUTE FORM)                     @Y30LB02 00694300
.*                                                             @Y30LB02 00708200
.* ENTRY-POINT = ICBACREL                                      @Y30LB02 00718200
.*                                                             @Y30LB02 00720200
.*   PURPOSE = SEE FUNCTION                                    @Y30LB02 00720600
.*                                                             @Y30LB02 00721000
.*   LINKAGE = SEE INPUT                                       @ZA28964 00721100
.*                                                             @ZA28964 00721200
.* INPUT = CODE THE ICBACREL MACRO USING ONE OF THE            @Y30LB02 00721400
.*     FOLLOWING SYNTAX FORMS (THE '(R)' REGISTER PARAMETER    @Y30LB02 00721800
.*     FORM IS VALID ONLY IN THE BAL VERSIONS).                @Y30LB02 00721900
.*                                                             @Y30LB02 00722000
.*   LIST FORMS =                                              @Y30LB02 00722100
.*                                                             @Y30LB02 00723100
.*     BAL - ICBACREL MF=(L,MAP),TYPE=ACQ|REL                  @Y30LB02 00724100
.*                                                             @Y30LB02 00725100
.*       REQUIRED PARAMETERS - MF=L,TYPE                       @Y30LB02 00726100
.*                                                             @Y30LB02 00727100
.*     PL/S- ICBACREL MF(L,NAME,ATTR) TYPE(ACQ|REL)            @Y30LB02 00728100
.*                                                             @Y30LB02 00729100
.*       REQUIRED PARAMETERS - MF(L,NAME) TYPE                 @Y30LB02 00730100
.*                                                             @Y30LB02 00731100
.*   STANDARD FORMS =                                          @Y30LB02 00732100
.*                                                             @Y30LB02 00733100
.*     BAL - ICBACREL TYPE=ACQ|REL,EXTS=NAME|(R),              @Y30LB02 00734100
.*                    NMEXTS=NAME|(R),VOLID=NAME|(R),          @Y30LB02 00735100
.*                    ECB=NAME|(R),FLAGS=NAME|(R),             @Y30LB02 00736100
.*                    HOSTID=NAME|(R)                          @Y30LB02 00737100
.*                                                             @Y30LB02 00738100
.*       REQUIRED PARAMETERS - TYPE,EXTS,NMEXTS,VOLID          @Y30LB02 00739100
.*                                                             @Y30LB02 00740100
.*     PL/S- ICBACREL TYPE(ACQ|REL) EXTS(NAME) NMEXTS(NAME)    @Y30LB02 00741100
.*                    VOLID(NAME) ECB(NAME) FLAGS(NAME)        @Y30LB02 00742100
.*                    HOSTID(NAME)                             @Y30LB02 00743100
.*                                                             @Y30LB02 00744100
.*       REQUIRED PARAMETERS - TYPE EXTS NMEXTS VOLID          @Y30LB02 00745100
.*                                                             @Y30LB02 00746100
.*   EXECUTE FORMS =                                           @Y30LB02 00747100
.*                                                             @Y30LB02 00748100
.*     BAL - ICBACREL MF=(E,NAME|(R))                          @Y30LB02 00749100
.*                                                             @Y30LB02 00750100
.*       REQUIRED PARAMETERS - MF=(E,NAME|(R))                 @Y30LB02 00751100
.*                                                             @Y30LB02 00752100
.*     PL/S- ICBACREL MF(E,NAME)                               @Y30LB02 00753100
.*                                                             @Y30LB02 00754100
.*       REQUIRED PARAMETERS - MF(E,NAME)                      @Y30LB02 00755100
.*                                                             @Y30LB02 00756100
.*   KEYWORD PARAMETERS =                                      @Y30LB02 00757100
.*                                                             @Y30LB02 00758100
.*     MF = MACRO FORMAT                                       @Y30LB02 00759100
.*                                                             @Y30LB02 00760100
.*       L = LIST FORM. THE EXPANSION OF THE LIST FORM         @Y30LB02 00761100
.*           PROVIDES ONLY THE PARAMETER REQUEST BLOCK.        @Y30LB02 00762100
.*           THE OPCODE AND BLOCK LENGTH FIELDS ARE            @Y30LB02 00763100
.*           FILLED IN BY THE MACRO AND THE REMAINING          @Y30LB02 00764100
.*           FIELDS ARE SET TO ZERO. IF ANY PARAMETERS         @Y30LB02 00765100
.*           BESIDES 'MF' AND 'TYPE' ARE SPECIFIED, THEY       @Y30LB02 00766100
.*           ARE IGNORED. (A WARNING IS ISSUED)                @Y30LB02 00767100
.*                                                             @ZA28964 00768100
.*         MAP = SPECIFIES THAT AN ASSEMBLER VERSION           @Y30LB02 00769100
.*             INVOCATION WILL PRODUCE A MAPPING DSECT         @Y30LB02 00770100
.*             LABELED 'ICBACREL'.                             @Y30LB02 00771100
.*                                                             @ZA28964 00772100
.*         NAME = LABEL ASSIGNED TO THE REQUEST BLOCK          @Y30LB02 00773100
.*             IN PL/S (REQUIRED IN PL/S VERSION).             @Y30LB02 00774100
.*                                                             @ZA28964 00775100
.*         ATTR = A PL/S ATTRIBUTE THAT WILL BE PLACED IN      @Y30LB02 00776100
.*             AN UNINITIALIZED REQUEST BLOCK DEFINITION.      @Y30LB02 00777100
.*             SOME ATTRIBUTE EXAMPLES ARE:                    @Y30LB02 00778100
.*                STATIC LOCAL, NONLOCAL, BASED(*), ETC        @Y30LB02 00779100
.*                                                             @Y30LB02 00780100
.*       NULL = STANDARD FORM IS INVOKED. THE EXPANSION        @Y30LB02 00781100
.*           OF THIS FORM CONSISTS OF A REQUEST BLOCK          @Y30LB02 00782100
.*           (ONLY IN THE FIRST INVOCATION OF THIS FORM        @Y30LB02 00783100
.*           IN ANY MODULE) LABELED 'ARLIST' IN THE PL/S       @ZA28964 00784100
.*           VERSION, A LINKAGE INSTRUCTION AND POSSIBLY       @ZA28964 00785100
.*           PARAMETER BINDING INSTRUCTIONS. ONLY A            @ZA28964 00786100
.*           SINGLE VOLUME REQUEST FOR UP TO 16 EXTENTS        @ZA28964 00787100
.*           MAY BE REQUESTED WITH A SINGLE STANDARD           @ZA28964 00788100
.*           FORM INVOCATION.                                  @ZA28964 00789100
.*                                                             @Y30LB02 00790100
.*       E = EXECUTE FORM. THE EXPANSION OF THIS FORM          @Y30LB02 00791100
.*           CONSISTS OF A LINKAGE INSTRUCTION AND             @Y30LB02 00792100
.*           POSSIBLY PARAMETER BINDING INSTRUCTIONS.          @Y30LB02 00793100
.*                                                             @ZA28964 00794100
.*         NAME = LABEL OF THE REQUEST BLOCK TO USE.           @Y30LB02 00795100
.*                                                             @Y30LB02 00796100
.*     TYPE = INDICATES WHETHER THE REQUEST IS FOR AN          @Y30LB02 00797100
.*         ACQUIRE (ACQ) OR RELINQUISH (REL).                  @Y30LB02 00798100
.*                                                             @Y30LB02 00799100
.*     EXTS = EXTENTS. LABEL OF THE AREA WHICH CONTAINS        @Y30LB02 00800100
.*         THE LIST OF EXTENTS OF THE RESOURCE. THE DATA       @Y30LB02 00801100
.*         FOR THIS AREA CAN BE EXTRACTED FROM EITHER          @Y30LB02 00802100
.*         THE DATA EXTENT BLOCK (DEB) OR THE DATA SET         @Y30LB02 00803100
.*         CONTROL BLOCK(S) (DSCB). THIS AREA IS COPIED        @Y30LB02 00804100
.*         INTO THE REQUEST BLOCK. THE FORMAT OF               @Y30LB02 00805100
.*         AREA POINTED TO BY THIS PARAMETER IS:               @Y30LB02 00806100
.*                                                             @ZA28964 00807100
.*          OFFSETS    LENGTH   DESCRIPTION                    @Y30LB02 00808100
.*          DEC HEX    (BYTES)                                 @Y30LB02 00809100
.*          -------    -------  -----------                    @Y30LB02 00810100
.*           0    (0)     2     BEGIN CC - EXTENT 1            @Y30LB02 00811100
.*           2    (2)     2     END CC - EXTENT 1              @Y30LB02 00812100
.*           4    (4)     2     BEGIN CC - EXTENT 2            @Y30LB02 00813100
.*             ...       ...          ...                      @Y30LB02 00814100
.*           60 (3C)      2     BEGIN CC - EXTENT 16           @Y30LB02 00815100
.*           62 (3E)      2     END CC - EXTENT 16             @Y30LB02 00816100
.*                                                             @Y30LB02 00817100
.*     NMEXTS = NUMBER OF EXTENTS. LABEL OF A ONE-BYTE FIELD   @Y30LB02 00818100
.*         WHICH CONTAINS THE NUMBER OF EXTENTS                @Y30LB02 00819100
.*         (FROM 1 TO 16) RECORDED IN THE AREA POINTED         @Y30LB02 00820100
.*         TO BY THE 'EXTS' PARAMETER. THE FIRST EXTENT        @Y30LB02 00821100
.*         IS RECORDED AT THE 'EXTS' ADDRESS.                  @Y30LB02 00822100
.*                                                             @Y30LB02 00823100
.*     VOLID = LABEL OF A 6-BYTE VOLUME IDENTIFIER OF THE      @ZA28964 00824100
.*         VOLUME ON WHICH THE DATA RESOURCE RESIDES.          @ZA28964 00825100
.*                                                             @Y30LB02 00826100
.*     ECB = LABEL OF THE EVENT CONTROL BLOCK. SPECIFIED IF A  @Y30LB02 00827100
.*         DELAYED RESPONSE IS INDICATED IN THE 'FLAGS'        @Y30LB02 00828100
.*         PARAMETER. A POST CODE IN THE RANGE X'70' -         @Y30LB02 00829100
.*         X'7F' WILL BE PLACED IN THE LOW-ORDER BYTE          @Y30LB02 00830100
.*         OF THE ECB ON COMPLETION OF THE REQUEST (X'7F'      @Y30LB02 00831100
.*         IS THE SUCCESSFUL COMPLETION CODE). THE ECB         @Y30LB02 00832100
.*         SHOULD BE SET TO BINARY ZERO BEFORE INVOKING        @Y30LB02 00833100
.*         THE MACRO. THE 'ARASID' FIELD OF THE REQUEST        @Y30LB02 00834100
.*         BLOCK IS USED BY SVC 126 TO RECORD THE              @Y30LB02 00835100
.*         ADDRESS SPACE ID OF THE INVOKING MODULE SO          @Y30LB02 00836100
.*         THAT THE CORRECT ECB MAY BE LOCATED FOR             @Y30LB02 00837100
.*         POSTING.                                            @Y30LB02 00838100
.*                                                             @Y30LB02 00839100
.*     FLAGS = LABEL OF A ONE-BYTE FIELD SPECIFYING THE        @Y30LB02 00840100
.*         ATTRIBUTES TO BE ASSOCIATED WITH THE REQUEST:       @Y30LB02 00841100
.*                                                             @Y30LB02 00842100
.*       ACQUIRE REQUESTS =                                    @Y30LB02 00843100
.*                                                             @Y30LB02 00844100
.*         1... ....    BIND. FORCES SPACE TO BE ALLOCATED     @Y30LB02 00845100
.*                        AND PREVENTS DE-ALLOCATION OF THAT   @ZA28964 00846100
.*                        SPACE UNTIL THE DATA IS RELINQUISHED @ZA28964 00847100
.*                        WITH THE UNBIND OPTION OR THE        @ZA28964 00848100
.*                        VOLUME IS DEMOUNTED.                 @ZA28964 00849100
.*         .1.. ....    DELAYED RESPONSE. FORCES SPACE TO BE   @Y30LB02 00850100
.*                        ALLOCATED AND THE CALLER NOTIFIED    @ZA28964 00851100
.*                        WHEN THE STAGING IS COMPLETE.        @ZA28964 00852100
.*         ..1. ....    INHIBIT STAGING. AFTER DASD SPACE IS   @Y30LB02 00853100
.*                        ALLOCATED, THE STAGING OF CYLINDERS  @ZA28964 00854100
.*                        OF THE DATA RESOURCE TO THE REAL     @ZA28964 00855100
.*                        DASD IS PREVENTED.                   @ZA28964 00856100
.*         ...1 ....    NEWLY ALLOCATED SECONDARY EXTENT.      @Y30LB02 00857100
.*                        CAUSES MSVC TO UPDATE THE RUNNING-   @ZA28964 00858100
.*                        SPACE COUNT FOR GENERAL-USE GROUP    @ZA28964 00859100
.*                        VOLUMES.                             @ZA28964 00860100
.*         .... 0000    RESERVED - MUST BE ZERO                @Y30LB02 00861100
.*                                                             @Y30LB02 00862100
.*       RELINQUISH REQUESTS =                                 @Y30LB02 00863100
.*                                                             @Y30LB02 00864100
.*         1... ....    UNBIND. RESETS THE BIND AND PERMITS    @Y30LB02 00865100
.*                        NORMAL DESTAGING TO RESUME. USED IN  @ZA28964 00866100
.*                        CONJUNCTION WITH THE ACQUIRE         @ZA28964 00867100
.*                        'BIND' FLAG.                         @ZA28964 00868100
.*         .1.. ....    DELAYED RESPONSE. CAUSES THE           @Y30LB02 00869100
.*                        DESTAGING OF ALL WRITTEN CYLINDERS   @ZA28964 00870100
.*                        (UNLESS THE 'INHIBIT DESTAGING'      @ZA28964 00871100
.*                        FLAG IS USED) AND THE CALLER         @ZA28964 00872100
.*                        NOTIFIED USING THE ECB BLOCK.        @ZA28964 00873100
.*         ..1. ....    INHIBIT DESTAGING. FREES THE DASD      @Y30LB02 00874100
.*                        SPACE WITHOUT DESTAGING THE DATA.    @ZA28964 00875100
.*         ..0. ....    DESTAGE. ALL CYLINDERS OF THE DATA     @Y30LB02 00876100
.*                        RESOURCE ON REAL DASD ARE MADE       @ZA28964 00877100
.*                        AVAILABLE FOR REALLOCATION. WHEN     @ZA28964 00878100
.*                        THE SPACE IS REQUIRED FOR            @ZA28964 00879100
.*                        ALLOCATION, ANY NECESSARY DESTAGING  @ZA28964 00880100
.*                        WILL BE DONE. IF 'DELAYED RESPONSE'  @ZA28964 00881100
.*                        IS SPECIFIED, THESE CYLINDERS ARE    @ZA28964 00882100
.*                        SCHEDULED FOR DESTAGING.             @ZA28964 00883100
.*         ...0 0000    RESERVED - MUST BE ZERO.               @Y30LB02 00884100
.*                                                             @Y30LB02 00885100
.*     HOSTID = LABEL OF A 5-BYTE FIELD WHICH CONTAINS THE     @Y30LB02 00886100
.*         MANUFACTURER'S CPU IDENTIFICATION. IF SET TO        @Y30LB02 00887100
.*         ZERO, SVC126 WILL FILL IN THE ID OF THE CALLING     @Y30LB02 00888100
.*         CPU.                                                @Y30LB02 00889100
.*                                                             @Y30LB02 00890100
.*   REQUEST BLOCK DESCRIPTION =                               @Y30LB02 00891100
.*                                                             @Y30LB02 00892100
.*     'ARLEN' = REQUEST BLOCK LENGTH FILLED IN BY THE         @Y30LB02 00893100
.*         MACRO(STANDARD AND LIST FORMS). 96 DEC BYTES.       @ZA28964 00894100
.*                                                             @Y30LB02 00895100
.*     'AROP' = OPCODE FILLED IN BY THE MACRO(STANDARD         @Y30LB02 00896100
.*         AND LIST FORMS). ACQUIRE = '02'X AND RELINQUISH =   @Y30LB02 00897100
.*         '04'X.                                              @Y30LB02 00898100
.*                                                             @Y30LB02 00899100
.*     'ARRES0' = RESERVED - MUST BE ZERO.                     @Y30LB02 00900100
.*                                                             @Y30LB02 00901100
.*     'ARFLAG' = FLAGS. CAN BE SET BY MACRO PARAMETER.        @Y30LB02 00902100
.*                                                             @Y30LB02 00903100
.*     'ARNMEXTS' = NUMBER OF EXTENTS. CAN BE SET BY           @Y30LB02 00904100
.*         MACRO PARAMETER.                                    @Y30LB02 00905100
.*                                                             @Y30LB02 00906100
.*     'ARVOL' = VOLID. CAN BE SET BY MACRO PARAMETER.         @Y30LB02 00907100
.*                                                             @Y30LB02 00908100
.*     'ARASID' = ADDRESS SPACE ID. SET BY SVC 126.            @Y30LB02 00909100
.*                                                             @Y30LB02 00910100
.*     'ARECB' = ECB. CAN BE SET BY MACRO PARAMETER.           @Y30LB02 00911100
.*                                                             @Y30LB02 00912100
.*     'ARHOST' = HOSTID. CAN BE SET BY SVC126 OR              @Y30LB02 00913100
.*         MACRO PARAMETER.                                    @Y30LB02 00914100
.*                                                             @Y30LB02 00915100
.*     'ARRES3' = RESERVED - MUST BE ZERO.                     @Y30LB02 00916100
.*                                                             @Y30LB02 00917100
.*     'ARCOMPC' = COMPLETION CODE. A 2-BYTE AREA WHICH        @Y30LB02 00918100
.*         IS FILLED IN BY SVC126 (MUST BE ZERO ON CALLING     @Y30LB02 00919100
.*         THE SVC). DETAILED COMPLETION CODE MESSAGES         @Y30LB02 00920100
.*         ARE EXPLAINED IN THE MSSC MESSAGES MANUAL, BUT      @Y30LB02 00921100
.*         THE FOLLOWING SITUATIONS CAN OCCUR WHEN             @Y30LB02 00922100
.*         CHAINED REQUESTS ARE MADE:                          @Y30LB02 00923100
.*                                                             @Y30LB02 00924100
.*       ACQUIRE CHAIN COMPLETION CODES =                      @Y30LB02 00925100
.*                                                             @Y30LB02 00926100
.*         FOR GENERAL ERRORS, THE SAME COMPLETION CODE        @Y30LB02 00927100
.*         WILL BE IN EACH REQUEST BLOCK IN THE CHAIN:         @Y30LB02 00928100
.*             X'173' = MSSC CONTROL BLOCK INDICATES THAT      @Y30LB02 00929100
.*                       THE MSC WAS NOT INITIALIZED           @Y30LB02 00930100
.*             X'174' = GETMAIN FAILURE FOR I/O BLOCKS         @Y30LB02 00931100
.*             X'175' = MSSC CONTROL BLOCK NOT AVAILABLE       @Y30LB02 00932100
.*                       (VS/2 ONLY)                           @Y30LB02 00933100
.*                                                             @Y30LB02 00934100
.*         FOR ERROR COMPLETION CODES IN THE RANGE X'000'      @Y30LB02 00935100
.*         TO X'0FF', THE REQUEST IN ERROR CONTAINS THE        @Y30LB02 00936100
.*         APPROPRIATE COMPLETION CODE. REQUESTS PRIOR TO      @Y30LB02 00937100
.*         THE ONE IN ERROR CONTAIN A COMPLETION CODE OF       @Y30LB02 00938100
.*         X'000', AND THE REQUESTED MSS ACTIVITY HAS BEEN     @Y30LB02 00939100
.*         INITIATED. IF APPROPRIATE FOR ANY OF THESE          @Y30LB02 00940100
.*         REQUESTS, WAIT FOR ITS DELAYED RESPONSE. EACH       @Y30LB02 00941100
.*         REQUEST SUBSEQUENT TO THE ONE IN ERROR CONTAINS     @Y30LB02 00942100
.*         A COMPLETION CODE OF X'170', WHICH MEANS THAT       @Y30LB02 00943100
.*         THE REQUEST WAS NOT PROCESSED ANY FURTHER. THERE    @Y30LB02 00944100
.*         WILL *NOT* BE ANY DELAYED RESPONSE FOR THESE        @Y30LB02 00945100
.*         REQUEST BLOCKS SINCE MSS ACTIVITY HAS NOT BEEN      @Y30LB02 00946100
.*         INITIATED.                                          @Y30LB02 00947100
.*                                                             @Y30LB02 00948100
.*         FOR THE ERROR CODES:                                @Y30LB02 00949100
.*             X'172' = PARAMETER NOT AS EXPECTED. EITHER      @Y30LB02 00950100
.*                       THE ECB ADDRESS WAS 0 WHEN A          @Y30LB02 00951100
.*                       DELAYED RESPONSE WAS REQUESTED, THE   @Y30LB02 00952100
.*                       THE LENGTH OF THE PARAMETER LIST      @Y30LB02 00953100
.*                       WAS INCORRECT, OR A WRONG NUMBER      @Y30LB02 00954100
.*                       OF EXTENTS WAS SPECIFIED.             @Y30LB02 00955100
.*             X'176' = INTERMIXED CHAIN FOR AN ACQUIRE.       @Y30LB02 00956100
.*         THE REQUEST IN ERROR CONTAINS THE APPROPRIATE       @Y30LB02 00957100
.*         COMPLETION CODE. REQUESTS PRIOR TO THE ONE IN       @Y30LB02 00958100
.*         ERROR CONTAIN A COMPLETION CODE OF X'000', BUT      @Y30LB02 00959100
.*         THE MSS ACTIVITY HAS *NOT* BEEN INITIATED -         @Y30LB02 00960100
.*         DO NOT WAIT FOR A DELAYED RESPONSE. EACH REQUEST    @Y30LB02 00961100
.*         SUBSEQUENT TO THE ONE IN ERROR CONTAINS A           @Y30LB02 00962100
.*         X'170' COMPLETION CODE - DO NOT WAIT FOR A          @Y30LB02 00963100
.*         DELAYED RESPONSE FROM THESE REQUESTS EITHER.        @Y30LB02 00964100
.*                                                             @Y30LB02 00965100
.*       RELINQUISH CHAIN COMPLETION CODES =                   @Y30LB02 00966100
.*                                                             @Y30LB02 00967100
.*         FOR GENERAL ERRORS, THE SAME COMPLETION CODE        @Y30LB02 00968100
.*         WILL BE IN EACH REQUEST BLOCK IN THE CHAIN:         @Y30LB02 00969100
.*             X'173' = MSSC CONTROL BLOCK INDICATES THAT      @Y30LB02 00970100
.*                       THE MSC WAS NOT INITIALIZED           @Y30LB02 00971100
.*             X'174' = GETMAIN FAILURE FOR I/O BLOCKS         @Y30LB02 00972100
.*             X'175' = MSSC CONTROL BLOCK NOT AVAILABLE       @Y30LB02 00973100
.*                       (VS/2 ONLY)                           @Y30LB02 00974100
.*                                                             @Y30LB02 00975100
.*         FOR THE ERROR COMPLETION CODE                       @Y30LB02 00976100
.*             X'176' = INTERMIXED CHAIN FOR RELINQUISH.       @Y30LB02 00977100
.*         THE REQUEST IN ERROR CONTAINS THE COMPLETION        @Y30LB02 00978100
.*         CODE. REQUESTS PRIOR TO THE ONE IN ERROR CONTAIN    @Y30LB02 00979100
.*         A COMPLETION CODE OF X'000', BUT THE MSS            @Y30LB02 00980100
.*         ACTIVITY HAS *NOT* BEEN INITIATED - DO NOT WAIT     @Y30LB02 00981100
.*         FOR A DELAYED RESPONSE. EACH REQUEST SUBSEQUENT     @Y30LB02 00982100
.*         TO THE ONE IN ERROR CONTAINS A COMPLETION CODE      @Y30LB02 00983100
.*         OF X'170' - DO *NOT* WAIT FOR A DELAYED RESPONSE    @Y30LB02 00984100
.*         FROM THESE REQUESTS.                                @Y30LB02 00985100
.*                                                             @Y30LB02 00986100
.*         IF THE FIRST ERROR COMPLETION CODE FOUND IN A       @Y30LB02 00987100
.*         RELINQUISH CHAIN IS NOT ONE OF THE CODES            @Y30LB02 00988100
.*         DESCRIBED ABOVE, EACH REQUEST IN THE CHAIN MUST     @Y30LB02 00989100
.*         BE INTERROGATED TO DETERMINE IF IT HAS FAILED       @Y30LB02 00990100
.*         AND THE REASON FOR THE FAILURE (SOME OR ALL OF      @Y30LB02 00991100
.*         THE REQUESTS MAY HAVE FAILED,EACH FOR A DIFFERENT   @Y30LB02 00992100
.*         REASON). IN THIS SITUATION, WAIT FOR A DELAYED      @Y30LB02 00993100
.*         RESPONSE ONLY IF THE COMPLETION CODE IS X'000'      @Y30LB02 00994100
.*         AND A DELAYED RESPONSE WAS REQUESTED.               @Y30LB02 00995100
.*                                                             @Y30LB02 00996100
.*     'AREXT' = EXTENTS. MAY BE SET BY MACRO PARAMETER.       @Y30LB02 00997100
.*                                                             @Y30LB02 00998100
.*     'ARNEDB' = ADDR OF THE NEXT EXTENT BLOCK. THROUGH       @ZA28964 00999100
.*         THE USE OF THIS POINTER, MULTIPLE ACQUIRES OR       @ZA28964 01000100
.*         RELINQUISHES MAY BE LINKED TOGETHER AND             @ZA28964 01001100
.*         EXECUTED WITH ONE CALL TO SVC 126. POINTS TO        @ZA28964 01002100
.*         AN AUXILLARY REQUEST BLOCK CONTAINING RELATED       @Y30LB02 01003100
.*         INFORMATION FOR THE SAME OR DIFFERENT VOLUME(S)     @Y30LB02 01004100
.*         AND DIFFERENT EXTENTS. ANY CHAIN OF REQUESTS MUST   @Y30LB02 01005100
.*         CONTAIN ONLY ACQUIRE REQUESTS OR ONLY               @Y30LB02 01006100
.*         RELINQUISH REQUESTS (NO MIXTURE). ALL INFORMATION   @Y30LB02 01007100
.*         REQUIRED MUST BE SPECIFIED IN EACH REQUEST BLOCK.   @Y30LB02 01008100
.*         A POINTER OF ZERO INDICATES THAT NO MORE            @Y30LB02 01009100
.*         REQUESTS ARE TO BE PROCESSED IN THIS CALL.          @Y30LB02 01010100
.*                                                             @Y30LB02 01043000
.* OUTPUT =                                                    @Y30LB02 01045000
.*                                                             @Y30LB02 01045400
.*   INLINE PL/S OR BAL STATEMENTS THAT PERFORM THE REQUESTED  @Y30LB02 01045500
.*   FUNCTION AND ERROR MESSAGES AS COMMENTS AT THE POINT      @Y30LB02 01045600
.*   OF INVOCATION.                                            @Y30LB02 01045700
.*                                                             @Y30LB02 01045800
.*   SVC126 REQUEST BLOCK (LIST AND STANDARD FORMS):           @Y30LB02 01045900
.*                                                             @Y30LB02 01053900
.*     OFFSETS  LENGTH    BAL    DESCRIPTION                   @Y30LB02 01055900
.*     DEC HEX  (BYTES)  LABEL                                 @Y30LB02 01056900
.*     -------  ------  -------  -----------                   @Y30LB02 01059900
.*      0  (0)     4    ARLEN    REQUEST BLOCK LENGTH          @Y30LB02 01061900
.*      4  (4)     1    AROP     OPCODE                        @Y30LB02 01063000
.*      5  (5)     1    ARRES0   RESERVED                      @Y30LB02 01065000
.*      6  (6)     1    ARFLAG   FLAGS                         @Y30LB02 01065100
.*      7  (7)     1    ARNMEXTS NUMBER OF EXTENTS             @Y30LB02 01067300
.*      8  (8)     6    ARVOL    VOLID                         @Y30LB02 01069300
.*     14  (E)     2    ARASID   ADDR SPACE ID                 @Y30LB02 01071300
.*     16  (10)    4    ARECB    EVENT CONTROL BLOCK ADDR      @Y30LB02 01071400
.*     20  (14)    5    ARHOST   HOSTID                        @Y30LB02 01071500
.*     25  (19)    1    ARRES3   RESERVED                      @Y30LB02 01071600
.*     26  (1A)    2    ARCOMPC  COMPLETION CODE               @Y30LB02 01073800
.*     28  (1C)   64DEC AREXT    EXTENTS                       @Y30LB02 01075800
.*     92  (5C)    4    ARNEDB   ADDR OF NEXT REQ BLK          @Y30LB02 01077800
.*                                                             @Y30LB02 01077900
.* EXIT-NORMAL = VALID INVOCATION                              @Y30LB02 01078000
.*                                                             @Y30LB02 01078100
.*   CONDITION = RETURN CODE = 0 | 4                           @Y30LB02 01080300
.*                                                             @Y30LB02 01082300
.*   OUTPUT = REQUEST BLOCK AND STATEMENTS GENERATED. IF PL/S  @ZA28964 01082700
.*       WARNING MESSAGES ARE GENERATED (RETCODE=4), THEY WILL @ZA28964 01082800
.*       ONLY APPEAR AS COMMENTS WHEN THE 'MSOURCE' PARAMETER  @ZA28964 01082900
.*       IS USED IN THE PL/S COMPILATION. IF THE ACQUIRE/      @ZA28964 01083000
.*       RELINQUISH REQUEST GENERATES A RUN-TIME ERROR, THE    @ZA28964 01083100
.*       MSSC SVC 126 WILL EXIT WITH R15 = 4 AND R0 = 0. IN    @ZA28964 01083200
.*       THIS CASE, THE USER MUST SCAN THE COMPLETION CODES    @ZA28964 01083300
.*       IN THE CHAIN OF REQUESTS TO DETERMINE THE REQUESTS    @ZA28964 01083400
.*       IN ERROR.                                             @ZA28964 01083500
.*                                                             @ZA28964 01083600
.*   MESSAGES =                                                @Y30LB02 01084300
.*                                                             @Y30LB02 01084400
.*     ICB603I:  WARNING-ONLY MF AND TYPE PARAMETERS ARE       @Y30LB02 01085700
.*               VALID FOR LIST FORM                           @Y30LB02 01087700
.*                                                             @Y30LB02 01088300
.* EXIT-ERROR = INVALID INVOCATION                             @Y30LB02 01089600
.*                                                             @Y30LB02 01090900
.*   CONDITION = RETURN CODE = 12                              @Y30LB02 01092200
.*                                                             @Y30LB02 01093500
.*   OUTPUT = REQUEST BLOCK AND STATEMENTS NOT GENERATED. PL/S @ZA28964 01093900
.*       ERROR MESSAGES WILL ONLY APPEAR AS COMMENTS WHEN THE  @ZA28964 01094200
.*       'MSOURCE' PARAMETER IS USED IN THE PL/S COMPILATION.  @ZA28964 01094500
.*       IF THE ACQUIRE/RELINQUISH REQUEST GENERATES AN ERROR  @ZA28964 01094800
.*       AT RUN-TIME, THE MSSC SVC 126 WILL EXIT WITH R15 = 4  @ZA28964 01095100
.*       AND R0 = 0. IN THIS CASE, THE USER MUST SCAN THE      @ZA28964 01095400
.*       THE COMPLETION CODES IN THE CHAIN OF REQUESTS TO      @ZA28964 01095700
.*       DETERMINE THE REQUESTS IN ERROR.                      @ZA28964 01096000
.*                                                             @ZA28964 01096300
.*   MESSAGES =                                                @Y30LB02 01097200
.*                                                             @Y30LB02 01098000
.*     ICB600I:  TYPE MUST BE SPECIFIED                        @Y30LB02 01098400
.*     ICB601I:  TYPE IS INCORRECTLY SPECIFIED                 @Y30LB02 01098500
.*     ICB602I:  A NAME FOR THE REQUEST BLOCK MUST BE          @Y30LB02 01098600
.*               SPECIFIED IN MF(2)                            @Y30LB02 01098700
.*     ICB606I:  EXTS MUST BE SPECIFIED FOR THE STANDARD FORM  @Y30LB02 01100200
.*               MACRO                                         @Y30LB02 01102200
.*     ICB609I:  NMEXTS MUST BE SPECIFIED FOR STANDARD         @Y30LB02 01102600
.*               FORM MACRO                                    @Y30LB02 01103000
.*     ICB610I:  VOLID MUST BE SPECIFIED FOR STANDARD          @Y30LB02 01103400
.*               FORM MACRO                                    @Y30LB02 01103500
.*     ICB612I:  MF(2) MUST CONTAIN REQ BLK NAME               @Y30LB02 01104000
.*               IF EXEC MACRO FORM REQUESTED                  @Y30LB02 01104400
.*     ICB613I:  MISSING REQ BLK NAME OR                       @Y30LB02 01104800
.*               MORE THAN 2 SUBPARAMETERS FOR MF              @Y30LB02 01104900
.*     ICB615I:  INVALID MF PARAMETER SPECIFIED, MUST          @Y30LB02 01105000
.*               BE L, E, OR NULL                              @Y30LB02 01105200
.*                                                             @Y30LB02 01105800
.* EXTERNAL REFERENCES =                                       @Y30LB02 01106000
.*                                                             @Y30LB02 01106500
.*   ROUTINES = NONE                                           @Y30LB02 01108000
.*                                                             @Y30LB02 01109500
.*   DATA-AREAS =                                              @Y30LB02 01111000
.*                                                             @Y30LB02 01112500
.*     BAL : GLOBAL VARIABLES USED                             @Y30LB02 01114000
.*       &ARSTEST : >0 IF THE STANDARD FORM HAS BEEN           @Y30LB02 01115500
.*           INVOKED PREVIOUSLY IN THE CALLING MODULE          @Y30LB02 01117000
.*                                                             @Y30LB02 01118500
.*     PL/S: FIXED EXTERNAL DECLARATIONS USED                  @Y30LB02 01120000
.*       ARTESTR1: >0 IF ARR1 HAS BEEN DECLARED AS REG1        @Y30LB02 01121500
.*           PREVIOUSLY IN THE CALLING MODULE                  @Y30LB02 01123000
.*       ARTEST : >0 IF THE STANDARD FORM HAS BEEN             @Y30LB02 01124500
.*           PREVIOUSLY INVOKED IN THE CALLING MODULE          @Y30LB02 01126000
.*                                                             @Y30LB02 01127500
.*   CONTROL-BLOCKS = NONE                                     @Y30LB02 01129000
.*                                                             @Y30LB02 01130500
.* TABLES = NONE                                               @Y30LB02 01132000
.*                                                             @Y30LB02 01133500
.* MACROS = IHBINNRA (USED IN BAL TO LOAD REG1)                @Y30LB02 01135000
.*                                                             @Y30LB02 01136500
.* CHANGE-ACTIVITY =                                           @Y30LB02 01138000
.*                                                             @Y30LB02 01139500
.*   00 74/06/09 DEVELOPMENT                                   @Y30LB02 01141000
.*   01 76/04/20 ALLOCATE TO MOUNTED VOLUMES                   @G24LB04 01142500
.*   02 77/12/15 DOCUMENTATION ADDITIONS/RESTRUCTURE           @ZA28964 01143400
.*               BAL STD FORM SERIALLY REUSABLE                @ZA28964 01144300
.*               PL/S VARIABLE 'EXSPTR' RENAMED 'ARSPTR'       @ZA28964 01145200
.*               PL/S LABELS DECLARED IN BAL VERSION           @ZA28964 01146100
.*               BAL LABELS DECLARED IN PL/S VERSION           @ZA28964 01147000
.*               PL/S MACRO INVOCATION ECHOED BACK TO CALLER   @ZA28964 01147900
.*                                                             @Y30LB02 01150000
.**** END OF SPECIFICATIONS ***                                @Y30LB02 22850003
         GBLB  &ARTEST       STANDARD FORM FLAG                @Y30LB02 22900000
         LCLC  &MEXTS                                          @Y30LB02 23200003
         LCLC  &END                                            @Y30LB02 23250003
         LCLC  &ACQRE                                          @Y30LB02 23300003
&END     SETC  'AR'.'&SYSNDX'                                  @Y30LB02 23350003
&MEXTS   SETC  'AR1'.'&SYSNDX'                                 @Y30LB02 23400003
&ACQRE   SETC  'AR2'.'&SYSNDX'                                 @Y30LB02 23450000
         AIF   ('&MF(1)' EQ 'E').EXEC  IF EXECUTE              @Y30LB02 23500000
         AIF   ('&TYPE' EQ 'ACQ' OR '&TYPE' EQ 'REL').START    @Y30LB02 23550003
         AIF   ('&TYPE' EQ '').NOT                             @Y30LB02 23650003
         MNOTE 12,'  ICB601I - TYPE IS INCORRECTLY SPECIFIED ' @Y30LB02 23700003
         AGO   .EXIT                                           @Y30LB02 23750000
.NOT     MNOTE 12,'  ICB600I - TYPE MUST BE SPECIFIED '        @Y30LB02 23800003
         AGO   .EXIT                                           @Y30LB02 23850000
.*                                                             @ZA28964 23860000
.START   AIF   ('&MF(1)' NE 'L').NLIST BRANCH IF NOT LIST FORM @Y30LB02 23870000
.*                                                             @ZA28964 23880000
.* *********************************************************** @Y30LB02 23890000
.*               L I S T   F O R M                             @ZA28964 23900000
.* *********************************************************** @Y30LB02 23910000
.*                                                             @ZA28964 23920000
.*       THE FOLLOWING CODE CHECKS FOR ILLEGAL PARAMETERS ON   @Y30LB02 24000003
.*       LIST FORM MACRO AND GIVES WARNING IF FOUND            @Y30LB02 24050003
.*                                                             @Y30LB02 24100003
         AIF   ('&FLAGS' NE '' OR '&VOLID' NE '').WARN         @Y30LB02 24150003
         AIF   ('&ECB' NE '' OR '&EXTS' NE '').WARN            @Y30LB02 24200003
         AIF   ('&HOSTID' EQ '' AND '&NMEXTS' EQ '').LISTOK    @ZA28964 24210000
.*                                                             @Y30LB02 24300003
.WARN    MNOTE 4,'  ICB603I - WARNING-ONLY MF AND TYPE '       @Y30LB02 24350003
         MNOTE 4,'  PARAMETERS ARE VALID FOR LIST FORM '       @Y30LB02 24400003
.*                                                             @Y30LB02 24450003
.LISTOK  AIF   ('&MF(2)' EQ 'MAP').LISTDS   DSECT REQUESTED?   @Y30LB02 24550000
*        MACMEAN  ACQUIRE/RELINQUISH MACRO                     @Y30LB02 24600003
*                 INITIALIZED LIST FORM MACRO                  @Y30LB02 24650000
*                 VERSION - VS/2 REL 3 77/12/15  LEVEL 02      @ZA28964 24700000
*                                                              @Y30LB02 24750003
&SYMBOL  DS    0F                                              @Y30LB02 24800003
ARLEN    DC    F'96'                   REQUEST BLOCK LENGTH    @Y30LB02 24850003
         AIF   ('&TYPE' EQ 'REL').LREL BRCH IF REL. REQUEST    @Y30LB02 24900003
AROP     DC    XL1'02'                 OPCODE FOR ACQUIRE      @Y30LB02 24950003
         AGO   .ZEROES                 BRANCH                  @Y30LB02 25000003
.LREL    ANOP                                                  @Y30LB02 25050003
AROP     DC    XL1'04'                 OPCODE FOR RELINQUISH   @Y30LB02 25100003
.ZEROES  ANOP                                                  @Y30LB02 25150003
ARRES0   DC    XL1'00'                 RESERVED                @Y30LB02 25200000
ARFLAG   DC    XL1'00'                 FLAGS                   @Y30LB02 25250000
ARNMEXTS DC    XL1'00'                 NUM EXTS                @Y30LB02 25300000
ARVOL    DC    XL6'000000000000'       VOLID                   @Y30LB02 25350000
ARASID   DC    XL2'0000'               ASID                    @Y30LB02 25400000
ARECB    DC    XL4'00000000'           ECB                     @Y30LB02 25450000
ARHOST   DC    XL5'0000000000'         HOSTID                  @Y30LB02 25500000
ARRES3   DC    XL1'00'                 RESERVED                @Y30LB02 25550000
ARCOMPC  DC    XL2'0000'               COMP CODE               @Y30LB02 25600000
AREXT    DC    16XL4'00000000'         EXTS                    @Y30LB02 25650000
ARNEDB   DC    XL4'00000000'           ADDR OF NEXT EXT BLK    @Y30LB02 25700003
ARLL     EQU   ARLEN                   COMPATABILITY DEF       @ZA28964 25710000
ARFLG    EQU   ARFLAG                  COMPATIBILITY DEF       @ZA28964 25730000
ARNMEXT  EQU   ARNMEXTS                COMPATIBILITY DEF       @ZA28964 25750000
         AGO   .EXIT                   GO TO EXIT              @Y30LB02 25770000
.*                                                             @ZA28964 25790000
.LISTDS  ANOP                                                  @Y30LB02 25810000
*        MACMEAN  ACQUIRE/RELINQUISH MACRO                     @Y30LB02 25830000
*                 UNINITIALIZED LIST FORM MACRO                @Y30LB02 25850000
*                 VERSION - VS/2 REL 3 77/12/15  LEVEL 02      @ZA28964 25870000
*                                                              @Y30LB02 25970000
ICBACREL DSECT                                                 @Y30LB02 26050003
ARLEN    DS    F                       REQ BLK LEN 96 DEC      @Y30LB02 26100003
         AIF   ('&TYPE' EQ 'REL').LREL1 BRCH IF REL. REQUEST   @Y30LB02 26150003
AROP     DS    XL1                     ACQUIRE OPCD (02 HEX)   @ZA28964 26200000
         AGO   .RESTDS                 BRANCH                  @Y30LB02 26220000
.*                                                             @ZA28964 26240000
.LREL1   ANOP                                                  @Y30LB02 26260000
AROP     DS    XL1                     RELINQ OPCD (04 HEX)    @ZA28964 26280000
.*                                                             @ZA28964 26300000
.RESTDS  ANOP                                                  @Y30LB02 26320000
ARRES0   DS    XL1                     RESERVED                @ZA28964 26340000
ARFLAG   DS    XL1                     FLAGS                   @ZA28964 26360000
ARNMEXTS DS    XL1                     NUM EXTS                @ZA28964 26380000
ARVOL    DS    CL6                     VOLID                   @ZA28964 26400000
ARASID   DS    XL2                     ASID                    @ZA28964 26420000
ARECB    DS    A                       ECB                     @ZA28964 26440000
ARHOST   DS    CL5                     HOSTID                  @ZA28964 26460000
ARRES3   DS    XL1                     RESERVED                @ZA28964 26480000
ARCOMPC  DS    XL2                     COMPLETION CODE         @ZA28964 26500000
AREXT    DS    16XL4                   EXTENTS                 @ZA28964 26520000
ARNEDB   DS    A                       ADDR OF NEXT EXT BLK    @Y30LB02 26540000
ARLL     EQU   ARLEN                   COMPATABILITY DEF       @ZA28964 26560000
ARFLG    EQU   ARFLAG                  COMPATIBILITY DEF       @ZA28964 26580000
ARNMEXT  EQU   ARNMEXTS                COMPATIBILITY DEF       @ZA28964 26600000
         AGO   .EXIT                   GO TO EXIT              @Y30LB02 26620000
.*                                                             @ZA28964 26640000
.NLIST   AIF   ('&MF(1)' EQ '').ISSTD  IF STD. FORM BRANCH     @Y30LB02 26660000
         MNOTE 12,'  ICB615I - INVALID MF PARAMETER '          @Y30LB02 26680000
         MNOTE 12,'  SPECIFIED, MUST BE L, E, OR NULL'         @Y30LB02 26700000
         AGO   .EXIT                   BRANCH                  @ZA28964 26720000
.*                                                             @ZA28964 26740000
.* *********************************************************** @ZA28964 26760000
.*        S T A N D A R D   F O R M                            @ZA28964 26780000
.* *********************************************************** @ZA28964 26800000
.*                                                             @ZA28964 26820000
.ISSTD   AIF   ('&NMEXTS' NE '').VOLIDCK BRCH IF NMEXTS SPEC'D @Y30LB02 26840000
         MNOTE 12,'  ICB609I - NMEXTS MUST BE SPECIFIED '      @Y30LB02 26860000
         MNOTE 12,'  FOR STANDARD FORM MACRO '                 @Y30LB02 26880000
         AGO   .EXIT                                           @Y30LB02 26900000
.*                                                             @ZA28964 26920000
.VOLIDCK AIF   ('&VOLID' NE '').EXTSCK IF VOLID SPEC'D         @ZA28964 26940000
         MNOTE 12,'  ICB610I - VOLID MUST BE SPECIFIED '       @Y30LB02 26960000
         MNOTE 12,'  FOR STANDARD FORM MACRO '                 @Y30LB02 26980000
         AGO   .EXIT                                           @ZA28964 27000000
.*                                                             @ZA28964 27020000
.EXTSCK  AIF   ('&EXTS' NE '').PAROK   IF EXTS SPEC'D,BRCH     @Y30LB02 27040000
         MNOTE 12,'  ICB606I - EXTS MUST BE SPECIFIED '        @Y30LB02 27060000
         MNOTE 12,'  FOR STANDARD FORM MACRO '                 @Y30LB02 27080000
         AGO   .EXIT                                           @ZA28964 27100000
.*                                                             @ZA28964 27120000
.PAROK   ANOP                                                  @ZA28964 27140000
*        MACMEAN  ACQUIRE/RELINQUISH MACRO                     @ZA28964 27160000
*                 STANDARD FORM INVOCATION                     @ZA28964 27180000
*                 VERSION - VS/2 REL 3 77/12/15  LEVEL 02      @ZA28964 27200000
         AIF   (&ARTEST).ARSET    IF ^ FIRST INVOCATION        @ZA28964 27220000
&ARTEST  SETB  1                                               @ZA28964 27240000
         CNOP  0,4                                             @Y30LB02 27260000
&SYMBOL  BAL   1,&ACQRE                BRANCH AROUND REQBLK    @Y30LB02 27280000
ARLEN    DC    A(&ACQRE-*)             REQUEST BLOCK LENGTH    @Y30LB02 27350003
         AIF   ('&TYPE' EQ 'REL').SREL BRCH IF REL REQUEST     @Y30LB02 27400003
AROP     DC    XL1'02'                 ACQ OPCODE              @Y30LB02 27450003
         AGO   .REST                   BRCH TO REST OF DC'S    @Y30LB02 27500003
.*                                                             @ZA28964 27510000
.SREL    ANOP                                                  @Y30LB02 27560000
AROP     DC    XL1'04'                 REL OPCODE              @Y30LB02 27610000
.*                                                             @ZA28964 27660000
.REST    ANOP                                                  @Y30LB02 27710000
ARRES0   DC    XL1'00'                 RESERVED                @ZA28964 27760000
ARFLAG   DC    XL1'00'                 FLAGS                   @ZA28964 27810000
ARNMEXTS DC    XL1'00'                 NUM EXTS                @ZA28964 27860000
ARVOL    DC    XL6'000000000000'       VOLID                   @ZA28964 27910000
ARASID   DC    XL2'0000'               ASID                    @ZA28964 27960000
ARECB    DC    XL4'00000000'           ECB                     @ZA28964 28010000
ARHOST   DC    XL5'0000000000'         HOSTID                  @ZA28964 28060000
ARRES3   DC    XL1'00'                 RESERVED                @ZA28964 28110000
ARCOMPC  DC    XL2'0000'               COMP CODE               @ZA28964 28160000
AREXT    DC    16XL4'00000000'         EXTS                    @ZA28964 28210000
ARNEDB   DC    XL4'00000000'           ADDR NEXT EXT BLK       @ZA28964 28260000
ARLL     EQU   ARLEN                   COMPATABILITY DEF       @ZA28964 28310000
ARFLG    EQU   ARFLAG                  COMPATIBILITY DEF       @ZA28964 28360000
ARNMEXT  EQU   ARNMEXTS                COMPATIBILITY DEF       @ZA28964 28410000
&ACQRE   EQU   *                                               @Y30LB02 28460000
         AGO   .TEST                   BRANCH                  @Y30LB02 28510000
.*                                                             @ZA28964 28560000
.ARSET   ANOP                                                  @ZA28964 28610000
*                 SUBSEQUENT STANDARD FORM INVOCATION          @ZA28964 28660000
&SYMBOL  LA    1,ARLEN       LOAD LIST ADDRESS IN REG 1        @ZA28964 28710000
.*                                                             @ZA28964 28760000
.TEST    AIF   ('&FLAGS' EQ '').NMEXTS  BRCH IF NOT SPEC'D     @ZA28964 28810000
         AIF   ('&FLAGS'(1,1) EQ '(').RFLAGS IF REGFORM        @ZA28964 28860000
         MVC   6(1,1),&FLAGS           MOVE FLAGS              @ZA28964 28910000
         AGO   .NMEXTS                 BRCH TO CHECK FOR VOLID @Y30LB02 28960000
.*                                                             @ZA28964 29010000
.RFLAGS  ANOP                                                  @Y30LB02 29060000
         MVC   6(1,1),0(&FLAGS(1))     MOVE FLAGS              @ZA28964 29110000
.*                                                             @ZA28964 29160000
.NMEXTS  AIF   ('&NMEXTS'(1,1) EQ '(').RNEXT IF REGFORM        @ZA28964 29210000
         MVC   7(1,1),&NMEXTS          MOVE #EXT INFO          @ZA28964 29260000
         AGO   .VOLOK                  BRCH TO CHECK FOR VOLID @Y30LB02 29310000
.*                                                             @ZA28964 29360000
.RNEXT   ANOP                                                  @Y30LB02 29410000
         MVC   7(1,1),0(&NMEXTS(1))    MOVE #EXT INFO          @ZA28964 29460000
.*                                                             @ZA28964 29510000
.VOLOK   AIF   ('&VOLID'(1,1) EQ '(').RVOLID IF REGFORM        @ZA28964 29560000
         MVC   8(6,1),&VOLID           MOVE VOLID              @ZA28964 29610000
         AGO   .ECBCK                  BRANCH TO CHECK FOR ECB @Y30LB02 29660000
.*                                                             @ZA28964 29710000
.RVOLID  ANOP                                                  @Y30LB02 29760000
         MVC   8(6,1),0(&VOLID(1))     MOVE VOLID              @ZA28964 29810000
.*                                                             @ZA28964 29860000
.ECBCK   AIF   ('&ECB' EQ '').HOSTCK   IF ECB NOT SPEC'D.,BRCH @ZA28964 29910000
         AIF   ('&ECB'(1,1) EQ '(').RECB IF SPEC'D BY REG,BRCH @Y30LB02 31450003
         LA    15,&ECB                 LOAD R15 WITH ADDR(ECB) @Y30LB02 31500003
         ST    15,16(1)                STORE ADDR IN ECB FIELD @Y30LB02 31550003
         AGO   .HOSTCK                 BRANCH TO CHECK HOST    @Y30LB02 31600003
.*                                                             @ZA28964 31610000
.RECB    ANOP                                                  @Y30LB02 31660000
         ST    &ECB,16(1)              ST ADDR IN THE ECB FLD  @Y30LB02 31710000
.*                                                             @ZA28964 31760000
.HOSTCK  AIF   ('&HOSTID' EQ '').EXTS    IF HOST NOT SPECD,BR  @ZA28964 31810000
         AIF   ('&HOSTID'(1,1) EQ '(').RHOST REG-FORM,BRANCH   @Y30LB02 31860000
         MVC   20(5,1),&HOSTID         STORE HOSTID IN BLOCK   @Y30LB02 31910000
         AGO   .EXTS                   BRANCH                  @Y30LB02 31960000
.*                                                             @ZA28964 32010000
.RHOST   ANOP                                                  @Y30LB02 32060000
         MVC   20(5,1),0(&HOSTID(1))   STORE HOSTID IN BLOCK   @Y30LB02 32110000
.*                                                             @ZA28964 32160000
.EXTS    ANOP                                                  @ZA28964 32210000
         SR    14,14                   ZERO REGISTER 14        @Y30LB02 32600003
         IC    14,&NMEXTS              PUT #EXTS INTO R14      @Y30LB02 32650003
         SLA   14,2                    MULT R14 BY 4           @Y30LB02 32700003
         LA    15,1                    LOAD 1 INTO R15         @Y30LB02 32750003
         SR    14,15                   SUB R15 FROM R14        @Y30LB02 32800003
         AIF   ('&EXTS'(1,1) EQ '(').RNMEX SPEC'D. BY REG,BR   @Y30LB02 32850003
         LA    15,&EXTS                LOAD EXTS ADDR INTO R15 @Y30LB02 32900003
         AGO   .LOAD5                  BRANCH                  @Y30LB02 32950003
.*                                                             @ZA28964 32960000
.RNMEX   ANOP                                                  @Y30LB02 32980000
         LR    15,&EXTS                LOAD EXTS ADDR INTO R15 @Y30LB02 33000000
.*                                                             @ZA28964 33020000
.LOAD5   ANOP                                                  @Y30LB02 33100003
         EX    14,&MEXTS               EXEC MOVE(EXTENTS) INST @Y30LB02 33150003
         B     &END                    BRANCH TO THE END       @Y30LB02 33200003
&MEXTS   MVC   28(1,1),0(15)           MOVE 64 BYTES (OF       @Y30LB02 33250003
*                                      EXTENTS) INTO REQ BLOCK @Y30LB02 33300003
         AGO   .LINK                   INVOKE THE SVC          @ZA28964 33350000
.*                                                             @ZA28964 33355000
.* *********************************************************** @ZA28964 33360000
.*        E X E C U T E   F O R M                              @ZA28964 33365000
.* *********************************************************** @ZA28964 33370000
.*                                                             @ZA28964 33375000
.EXEC    AIF   (N'&MF EQ 2).CONT       IF 2 SUBPARAMETERS      @ZA28964 33380000
         MNOTE 12,'  ICB613I - MISSING REQ BLK NAME '          @Y30LB02 33385000
         MNOTE 12,'  OR MORE THAN 2 SUBPARAMETERS FOR MF '     @Y30LB02 33390000
         AGO   .EXIT                   BRANCH                  @ZA28964 33395000
.*                                                             @ZA28964 33400000
.CONT    ANOP                                                  @Y30LB02 33405000
*        MACMEAN  ACQUIRE/RELINQUISH MACRO                     @ZA28964 33410000
*                 EXECUTE FORM INVOCATION                      @ZA28964 33415000
*                 VERSION - VS/2 REL 3 77/12/15  LEVEL 02      @ZA28964 33420000
&SYMBOL  IHBINNRA &MF(2)               LOAD THE ADDR INTO R1   @Y30LB02 33425000
.*                                                             @ZA28964 33430000
.LINK    ANOP                                                  @Y30LB02 33435000
&END     SVC   126                     LINK TO THE SVC         @Y30LB02 33440000
.*                                                             @ZA28964 33445000
.EXIT    MEND                                                  @Y30LB02 33450000
**********************************************************     @ZA28964 33455000
*********************************************************/              33470000
* ICBACREL: MACRO KEYS(MF,TYPE,FLAGS,VOLID,ECB,EXTS,                    33550003
*                  HOSTID,NMEXTS);                         /*@Y30LB02*/ 33600003
*/*                                                          @Y30LB02*/ 33650003
*/********************************************************** @ZA28964*/ 33660000
*/*          EXTERNAL DECLARES                               @Y30LB02*/ 33680000
*/********************************************************** @ZA28964*/ 33700000
*   DCL (ARTEST,                       /*USED AS A TEST TO   @Y30LB02*/ 33750000
*                                      /*SEE IF STD FORM     @Y30LB02*/ 33800003
*                                      /*ALREADY INVOKED     @Y30LB02*/ 33850003
*        ARTESTR1) FIXED EXT;          /*USED AS A TEST TO   @Y30LB02*/ 33900000
*                                      /*SEE IF R1 ALREADY   @Y30LB02*/ 33950003
*                                      /*DECLARED            @Y30LB02*/ 34000003
*/*                                                          @Y30LB02*/ 34100003
*/********************************************************** @ZA28964*/ 34110000
*/*            INTERNAL DECLARES                             @Y30LB02*/ 34130000
*/********************************************************** @ZA28964*/ 34150000
*   DCL (ARLENGTH,                     /*LIST LENGTH         @Y30LB02*/ 34200000
*        AOPCODE,                      /* ACQUIRE OPCODE     @Y30LB02*/ 34300000
*        ROPCODE) CHAR,                /* RELINQUISH OPCODE  @Y30LB02*/ 34350000
*        RETCODE FIXED;                /* RETURN CODE        @Y30LB02*/ 34360000
*/*                                                          @Y30LB02*/ 34410000
*/********************************************************** @ZA28964*/ 34460000
*/*             VARIABLE INITIALIZATION                      @ZA28964*/ 34480000
*/********************************************************** @ZA28964*/ 34500000
*   ARLENGTH='96';                     /*LEN CONSTANT OF 96  @Y30LB02*/ 34600003
*   AOPCODE='02';                      /* ACQUIRE OPCODE     @Y30LB02*/ 34650003
*   ROPCODE='04';                      /* RELINQUISH OPCODE  @Y30LB02*/ 34700003
*   RETCODE=0;                         /*RETURN CODE         @Y30LB02*/ 34750003
*/*                                                          @ZA28964*/ 34800000
*/*   NOTE: ANSWER TEXT IS INCLUDED AT THE END OF THE MACRO  @ZA28964*/ 34820000
*/*         AND IS INVOKED IN A SEGMENT-LIKE FASHION         @ZA28964*/ 34840000
*/*                                                          @ZA28964*/ 34860000
*/********************************************************** @ZA28964*/ 34880000
*/*     ECHO INVOCATION BACK TO CALLING MODULE               @ZA28964*/ 34900000
*/********************************************************** @ZA28964*/ 34920000
*  ANS('     /* MACRO INVOCATION:  @ZA28964*/')SKIP;                    34940000
*  ANS('     /* ' || MACLABEL || ' ' || MACNAME || ' ' || MACLIST ||    34960000
*      ' ' || MACKEYS || ' @ZA28964*/')SKIP;               /*@ZA28964*/ 34980000
*/*                                                          @ZA28964*/ 35000000
*/********************************************************** @ZA28964*/ 35020000
*/*         DECLARE REGISTER 1                               @ZA28964*/ 35040000
*/********************************************************** @ZA28964*/ 35060000
*  IF ARTESTR1=0 THEN                  /*HAS R1 BEEN DCL'D?  @Y30LB02*/ 35080000
*    DO;                               /*NO,DECLARE REG1     @Y30LB02*/ 35100000
*      ANS('DCL ARR1 REG(1) PTR ;   '||                                 35120000
*          '/*WILL CONTAIN LIST ADDRESS   @Y30LB02*/') SKIP;            35140000
*      ARTESTR1=1;                     /*SET ARTESTR1 TO 1   @Y30LB02*/ 35160000
*    END;                                                  /*@Y30LB02*/ 35180000
*/*                                                          @ZA28964*/ 35200000
*/********************************************************** @ZA28964*/ 35220000
*/*      CHECK FOR VALID TYPE                                @ZA28964*/ 35240000
*/********************************************************** @ZA28964*/ 35260000
*  IF MF(1) = 'E' THEN                 /*EXECUTE FORM SPECD? @Y30LB02*/ 35280000
*    GO TO EXFORM;                     /*YES, BRANCH         @Y30LB02*/ 35300000
*  IF TYPE(1) ^= 'ACQ' THEN IF TYPE(1) ^= 'REL' THEN       /*@ZA28964*/ 35320000
*    DO;                                                   /*@ZA28964*/ 35340000
*      IF TYPE(1) = '' THEN                                /*@ZA28964*/ 35360000
*        ANS MSG('  ICB600I - TYPE '||                                  35380000
*                'MUST BE SPECIFIED') SKIP(5);             /*@Y30LB02*/ 35400000
*      ELSE                                                /*@ZA28964*/ 35420000
*        ANS MSG('  ICB601I - TYPE '||                                  35440000
*                ' IS INCORRECTLY SPECIFIED') SKIP(5);     /*@Y30LB02*/ 35460000
*      RETCODE=12;                     /*SET RETURN CODE     @Y30LB02*/ 35480000
*      GO TO FINISH;                                       /*@ZA28964*/ 35500000
*    END;                                                  /*@ZA28964*/ 35520000
*/*                                                          @ZA28964*/ 35540000
*/********************************************************** @ZA28964*/ 35560000
*/*          LIST FORM                                       @ZA28964*/ 35580000
*/********************************************************** @ZA28964*/ 35600000
*  IF MF(1)^='L' THEN                  /* IF NOT LIST FORM   @Y30LB02*/ 36300000
*    GO TO NOTLIST;                    /* BRANCH             @Y30LB02*/ 36350000
*  IF MF(2)='' THEN                    /* WAS A NAME GIVEN?  @Y30LB02*/ 36400000
*    DO;                               /* NO,PRT ERROR MSG   @Y30LB02*/ 36450000
*      ANS MSG('  ICB602I - A NAME FOR THE REQUEST BLOCK '||            36550000
*              'MUST BE SPECIFIED IN MF(2) ') SKIP(5);     /*@Y30LB02*/ 36600000
*      RETCODE=12;                     /*SET RETURN CODE     @Y30LB02*/ 36650000
*      GO TO FINISH;                                       /*@Y30LB02*/ 36800000
*    END;                                                  /*@Y30LB02*/ 36810000
*/*                                                          @Y30LB02*/ 37050003
*  IF FLAGS ||                         /*FLAGS SPECIFIED?    @Y30LB02*/ 37100000
*     VOLID ||                         /*VOLID SPECIFIED     @Y30LB02*/ 37200000
*     ECB ||                           /*ECB SPECIFIED?      @Y30LB02*/ 37300000
*     EXTS ||                          /*EXTENTS SPECIFIED?  @Y30LB02*/ 37400000
*     HOSTID ||                        /*HOSTID SPECIFIED?   @Y30LB02*/ 37450000
*     NMEXTS ^= '' THEN                /*NMEXTS SPECIFIED?   @Y30LB02*/ 37460000
*    DO;                               /*PRT WARNING MSG     @Y30LB02*/ 37550000
*      RETCODE=4;                      /*RETURN CODE EQ 4    @Y30LB02*/ 37600000
*      ANS MSG('  ICB603I - WARNING-ONLY '||                            37650000
*              'MF AND TYPE PARAMETERS ARE VALID FOR '||                37700000
*              'LIST FORM ')SKIP;                          /*@Y30LB02*/ 37750000
*    END;                                                  /*@Y30LB02*/ 37800000
*  IF MF(3) = '' THEN        /*ATTRIBUTE ^ SPECIFIED         @Y30LB02*/ 37850000
*    GO TO LINIT;            /* CALL ANSWER TEXT BLOCK       @ZA28964*/ 37910000
*                            /*  AND THEN GO TO FINISH       @ZA28964*/ 37960000
*  ELSE                                                                 38010000
*    GO TO LUN;              /* CALL ANSWER TEXT BLOCK       @ZA28964*/ 38060000
*                            /*  AND THEN GO TO FINISH       @ZA28964*/ 38110000
*/*                                                          @Y30LB02*/ 38160000
*/*********************************************************  @Y30LB02*/ 38210000
*/*        STANDARD FORM                                     @ZA28964*/ 38260000
*/*********************************************************  @Y30LB02*/ 38310000
*  NOTLIST:                                                /*@Y30LB02*/ 38360000
*  IF MF(1)^='' THEN                   /* IF NOT STD FORM    @Y30LB02*/ 38410000
*    DO;                               /* PRT ERROR MESSAGE  @Y30LB02*/ 38460000
*      ANS MSG('  ICB615I - INVALID MF PARAMETER'||                     38510000
*              ' SPECIFIED, MUST BE L, E, OR NULL')SKIP;   /*@Y30LB02*/ 38560000
*      RETCODE=12;                     /*SET RETURN CODE     @Y30LB02*/ 38610000
*      GO TO FINISH;                   /* AND EXIT           @ZA28964*/ 38660000
*    END;                                                  /*@Y30LB02*/ 38710000
*/*                                                        /*@ZA28964*/ 38760000
*  IF NMEXTS = '' THEN                 /* IS NMEXT SPEC'D?   @Y30LB02*/ 38810000
*    DO;                                                   /*@Y30LB02*/ 38860000
*      ANS MSG('  ICB609I - NMEXTS MUST BE '||                          38910000
*              'SPECIFIED FOR STANDARD FORM MACRO ')SKIP;               38960000
*      RETCODE = 12;                                       /*@ZA28964*/ 39010000
*    END;                                                  /*@Y30LB02*/ 39060000
*  IF VOLID = '' THEN                  /* IS VOLID SPEC'D?   @Y30LB02*/ 39110000
*    DO;                                                   /*@Y30LB02*/ 39160000
*      ANS MSG('  ICB610I - VOLID MUST BE SPECIFIED FOR'||              39210000
*              ' STANDARD FORM MACRO')SKIP;                /*@Y30LB02*/ 39260000
*      RETCODE = 12;                                       /*@Y30LB02*/ 39310000
*    END;                                                  /*@ZA28964*/ 39360000
*  IF EXTS = '' THEN                   /* IS EXTS SPEC'D?    @Y30LB02*/ 39410000
*    DO;                                                   /*@Y30LB02*/ 39460000
*      ANS MSG('  ICB606I - EXTS MUST BE '||                            39510000
*              ' SPECIFIED FOR STANDARD FORM MACRO ')SKIP;              39560000
*      RETCODE=12;           /*SET RETURN CODE               @Y30LB02*/ 39610000
*    END;                                                  /*@Y30LB02*/ 39660000
*  IF RETCODE >= 12 THEN     /*ERROR FOUND                   @ZA28964*/ 39710000
*    GO TO FINISH;           /*BRANCH                        @Y30LB02*/ 39760000
*  IF ARTEST=1 THEN          /*IF THE STD FM HAS             @Y30LB02*/ 39810000
*                            /*BEEN INVOKED ALRDY            @Y30LB02*/ 39860000
*    GO TO STDSEC;           /*SET UP REG1 TO PNT            @Y30LB02*/ 39910000
*                            /*TO REQUEST BLOCK              @Y30LB02*/ 39960000
*                            /*BY CALLING TEXT,              @ZA28964*/ 40010000
*                            /* THEN GOTO FCHECK             @ZA28964*/ 40060000
*  ELSE                                                    /*@ZA28964*/ 40110000
*    GO TO STDINT;           /* CALL ANSWER TEXT BLOCK       @ZA28964*/ 40160000
*                            /*  THEN GO TO FCHECK           @ZA28964*/ 40210000
*/*                                                          @Y30LB02*/ 53000003
*/*********************************************************  @Y30LB02*/ 53050003
*/*         FILL IN STANDARD FORM PARAMETERS                 @Y30LB02*/ 53100000
*/*********************************************************  @Y30LB02*/ 53250003
*  FCHECK:                                                 /*@Y30LB02*/ 53300000
*  IF FLAGS ^= '' THEN                 /*ARE FLAGS SPEC'D?   @Y30LB02*/ 53350000
*    ANS('ARFLG='||FLAGS||';/*FILL IN FLAGS  @Y30LB02*/')SKIP;          53600000
*/*                                                          @ZA28964*/ 53650000
*  ANS('ARNMEXT='||NMEXTS||';/*FILL IN NMEXT  @Y30LB02*/')SKIP;         53700000
*/*                                                          @ZA28964*/ 53750000
*  ANS('ARVOL='||VOLID||';/*FILL IN VOLID  @Y30LB02*/')SKIP;            53800000
*/*                                                          @ZA28964*/ 53850000
*  IF ECB ^= '' THEN        /* IF ECB SPECIFIED              @ZA28964*/ 53900000
*    ANS('ARECB=ADDR'||ECB||';/*FILL IN ECB @Z30LB02*/')SKIP;           53950000
*/*                                                          @ZA28964*/ 54000000
*  IF HOSTID ^= '' THEN                /*CK FOR HOSTID       @Y30LB02*/ 54050000
*    ANS('ARHOST='||HOSTID||';/*FILL IN HOSTID @Y30LB02*/')SKIP;        54100000
*/*                                                          @ZA28964*/ 54150000
*  ANS(' /*THE FOLLOWING CODE MOVES THE'||                              54200000
*      ' EXTENTS INFO INTO THE BLOCK  @Y30LB02*/')SKIP;                 54250000
*  IF ARTEST=0 THEN   /* FIRST INVOCATION OF STD FORM        @ZA28964*/ 54300000
*    DO;                                                   /*@Y30LB02*/ 54350000
*      ANS('DCL ARI FIXED(31) INIT(0);'||                               54400000
*          '/*LOOP CTR INDEX  @Y30LB02*/') SKIP;                        54450000
*      ANS('/*ARSPTR IS PTR USED TO EXTRACT'||                          54500000
*          ' # OF EXTENTS AND EXTENTS INFO   */')SKIP;                  54550000
*      ANS('DCL ARSPTR PTR(31);') SKIP;                                 54600000
*      ANS('DCL ARE CHAR(4) BASED(ARSPTR)'||                            54650000
*          ';  /* EXTENTS   @Y30LB02*/') SKIP;                          54700000
*      ARTEST=1;              /* SET FLAG ON                 @Y30LB02*/ 54750000
*    END;                                                  /*@Y30LB02*/ 54800000
*  ANS('/*INITIALIZE ARSPTR TO PTR SPECD '||                            54850000
*      'FOR EXTS PARAMETER       @Y30LB02*/') SKIP;                     54900000
*  ANS('ARSPTR=ADDR'||EXTS||' ;') SKIP;                    /*@Y30LB02*/ 54950000
*  ANS('/*THIS DO LOOP MOVES THE BEG AND '||                            55000000
*      'END CYLINDERS TO LIST @Y30LB02*/') SKIP;                        55050000
*  ANS('DO ARI=1 TO ARNMEXT;') SKIP;                       /*@Y30LB02*/ 55100000
*  ANS('   AREXT(ARI)=ARE; /*FILL IN '||                                55150000
*      'EXTENTS FIELD  @Y30LB02*/') SKIP;                               55200000
*  ANS('   ARSPTR=ARSPTR+4;/*INCR PTR TO'||                             55250000
*      ' EXTS FIELD  @Y30LB02*/') SKIP;                                 55300000
*  ANS('END;')  SKIP;                                      /*@Y30LB02*/ 55350000
*  GO TO QUIT;                                             /*@ZA28964*/ 55400000
*/*                                                          @Y30LB02*/ 55450000
*/*********************************************************  @Y30LB02*/ 55500000
*/*               EXECUTE FORM                               @Y30LB02*/ 55550000
*/*********************************************************  @Y30LB02*/ 55600000
*/*                                                          @ZA28964*/ 55650000
*  EXFORM:                                                 /*@ZA28964*/ 55700000
*    IF MF(2)='' THEN                  /*ADDRESS  GIVEN?     @Y30LB02*/ 55750000
*      DO;                             /*NO,ERROR MSG PRNTD  @Y30LB02*/ 55800000
*        ANS MSG('  ICB612I - MF(2) MUST'||                             55850000
*                ' CONTAIN REQ BLK NAME IF '||                          55900000
*                'EXEC MACRO FORM REQUESTED') SKIP(5);     /*@Y30LB02*/ 55950000
*        RETCODE=12;                                       /*@Y30LB02*/ 56000000
*        GO TO FINISH;                  /*BRANCH             @Y30LB02*/ 56050000
*      END;                                                /*@Y30LB02*/ 56100000
*    ELSE                                                  /*@ZA28964*/ 56150000
*      GO TO EXEC;           /* CALL ANSWER TEXT BLOCK       @ZA28964*/ 56200000
*                            /* THEN GO TO QUIT              @ZA28964*/ 56250000
*/*                                                          @ZA28964*/ 56300000
*/********************************************************** @ZA28964*/ 56350000
*/*           INVOKE SVC 126                                 @ZA28964*/ 56400000
*/********************************************************** @ZA28964*/ 56450000
*/*                                                          @ZA28964*/ 56500000
*QUIT:  ANS('SVC (126); /*ISSUE  SVC   @Y30LB02*/') SKIP;               56550000
*       ANS('RFY(ARR1)UNRSTD;/*UNRESTRICT REG 1  @Y30LB02*/')SKIP;      56600000
*       GO TO FINISH;                                      /*@ZA28964*/ 56650000
*/*                                                          @Y30LB02*/ 56700000
*/********************************************************** @Y30LB02*/ 56750000
*/*      MACRO ANSWER TEXT - EACH BLOCK IS INVOKED AT        @ZA28964*/ 56800000
*/*      ONLY ONE POINT IN THE MACRO                         @ZA28964*/ 56850000
*/********************************************************** @Y30LB02*/ 56900000
*/*                                                          @Y30LB02*/ 56950000
*  LINIT:                                                               58910000
*   ANS('/*******************************************'||                58912000
*       '*************  @Y30LB02*/')SKIP;                               58920000
*   ANS('/*MACMEAN  MSSC ACQUIRE/RELINQUISH MACRO    '||                58930000
*       '               @Y30LB02*/')SKIP;                               58940000
*   ANS('/*         VERSION - VS/2 REL 3   77/12/15  '||                58942000
*       'LEVEL 02       @ZA28964*/')SKIP;                               58943000
*   ANS('/*THIS IS THE INITIALIZED LIST FORM         '||                58946000
*       '               @Y30LB02*/')SKIP;                               58948000
*   ANS('/*******************************************'||                58948400
*       '*************  @Y30LB02*/')SKIP;                               58948800
*   ANS('DCL 1   '||MF(2)||' STATIC LOCAL,')SKIP;          /*@Y30LB02*/ 58949200
*   ANS('     2 ARLL FIXED(31) INIT(96),/*LENGTH @Y30LB02*/')SKIP;      58954200
*   IF TYPE(1) = 'ACQ' THEN                                /*@ZA28964*/ 58959200
*     ANS('    2 AROP FIXED(8) INIT(2),/*OPCODE=02 @Y30LB02*/')SKIP;    58964200
*   ELSE                               /*RELINQUISH REQUEST  @Y30LB02*/ 58969200
*     ANS('    2 AROP FIXED(8) INIT(4),/*OPCODE=04 @Y30LB02*/')SKIP;    58974200
*   ANS('      2  * CHAR(1) INIT('||QUOTE('00')||                       58979200
*       'X),  /*RESERVED AREA  @Y30LB02*/') SKIP;                       58984200
*   ANS('      2  ARFLG BIT(8) INIT('||QUOTE('00000000')||              58989200
*       'B), /*FLAGS  @Y30LB02*/') SKIP;                                58994200
*   ANS('       3 ARBDUBD BIT(1),/* BIND/UNBIND BIT @Y30LB02*/')SKIP;   58999200
*   ANS('       3 ARDRES BIT(1),/* DELAYED RESPONSE BIT   @Y30LB02*/')  59004200
*        SKIP;                                                          59009200
*   ANS('        3 ARINH BIT(1), /*INHIBIT (DE)STAGE BIT   @Y30LB02*/') 59014200
*        SKIP;                                                          59019200
*   ANS('        3 ARSEC BIT(1), /*NEWLY ALLOCATED SECONDARY EXTENT'||  59024200
*       ' BIT @G24LB04*/')SKIP;                                         59029200
*   ANS('        3 * BIT(4), /*THESE BITS ALWAYS ZEROES   @G24LB04*/')  59034200
*        SKIP;                                                          59039200
*   ANS('      2  ARNMEXT FIXED(8) INIT(0),/* #EXTS  @Y30LB02*/')       59044200
*        SKIP;                                                          59049200
*   ANS('      2  ARVOL CHAR(6) INIT('||                                59054200
*        QUOTE('000000000000')||'X), /*VOLID  @Y30LB02*/') SKIP;        59059200
*   ANS('      2  ARASID CHAR(2) INIT('||QUOTE('0000')||                59064200
*        'X),  /*ASID FIELD  @Y30LB02*/') SKIP;                         59069200
*   ANS('      2  ARECB PTR(31) INIT(0), /*ADDR OF ECB  @ZA28964*/')    59074200
*        SKIP;                                                          59079200
*   ANS('      2  ARHOST CHAR(5) INIT('||QUOTE('0000000000')            59084200
*       || 'X),  /*HOSTID  @Y30LB02*/') SKIP;                           59089200
*   ANS('      2  * CHAR(1) INIT('||QUOTE('00')                         59094200
*       || 'X),  /*ZEROES  @Y30LB02*/') SKIP;                           59099200
*   ANS('      2  ARCOMPC CHAR(2) INIT('||QUOTE('0000')                 59104200
*       || 'X),  /*ZERO COMP CODE FLD  @Y30LB02*/') SKIP;               59109200
*   ANS('      2  AREXT (16), /*EXTENTS  @Y30LB02*/') SKIP;             59114200
*   ANS('       3 * CHAR(4) INIT('||                                    59119200
*       QUOTE('00000000')||'X),') SKIP;                                 59124200
*   ANS('      2  ARNEDB PTR(31) INIT(0);  /*NEDB    @ZA28964*/')       59129200
*        SKIP;                                                          59134200
*   ANS('DCL ARLEN FIXED(31) DEF(ARLL), /*BAL LABEL  @ZA28964*/')SKIP;  59139200
*   ANS('    ARFLAG BIT(8) DEF(ARFLG),/*BAL LABEL @ZA28964*/')SKIP;     59144200
*   ANS('    ARNMEXTS FIXED(8) DEF(ARNMEXT);  ' ||                      59149200
*       '/*BAL LABEL @ZA28964*/')SKIP;                                  59154200
*   GO TO FINISH;        /* RETURN TO CALLER                 @ZA28964*/ 59159200
*/*                                                          @ZA28964*/ 59164200
*  LUN:                                                                 59198600
*   ANS('/*******************************************'||                59200600
*       '*************  @Y30LB02*/')SKIP;                               59208600
*   ANS('/*MACMEAN  MSSC ACQUIRE/RELINQUISH MACRO    '||                59218600
*       '               @Y30LB02*/')SKIP;                               59228600
*   ANS('/*         VERSION - VS/2 REL 3    77/12/15 '||                59230600
*       'LEVEL 02       @ZA28964*/')SKIP;                               59231600
*   ANS('/*THIS IS THE UNINITIALIZED LIST FORM       '||                59234600
*       '               @Y30LB02*/')SKIP;                               59236600
*   ANS('/*******************************************'||                59237000
*       '*************  @Y30LB02*/')SKIP;                               59237400
*   ANS('DCL 1   '||MF(2)||'  '||MF(3)||',')SKIP;          /*@Y30LB02*/ 59237800
*   ANS('      2  ARLL FIXED(31),  /*LENGTH=96 BYTES   @Y30LB02*/')     59242800
*        SKIP;                                                          59247800
*   IF TYPE(1)='ACQ' THEN                                               59252800
*     ANS('      2  AROP FIXED(8),/*OPCODE=02  @Y30LB02*/')SKIP;        59257800
*   ELSE                               /*REL OPCODE          @Y30LB02*/ 59262800
*     ANS('      2  AROP FIXED(8),/*OPCODE = 04  @Y30LB02*/')SKIP;      59267800
*   ANS('      2  * CHAR(1),  /*RESERVED AREA  @Y30LB02*/') SKIP;       59272800
*   ANS('      2  ARFLG BIT(8), /*FLAGS  @Y30LB02*/') SKIP;             59277800
*   ANS('        3 ARBDUBD BIT(1),   /* BIND/UNBIND BIT    @Y30LB02*/') 59282800
*        SKIP;                                                          59287800
*   ANS('        3 ARDRES BIT(1),/* DELAYED RESPONSE BIT   @Y30LB02*/') 59292800
*        SKIP;                                                          59297800
*   ANS('        3 ARINH BIT(1), /*INHIBIT (DE)STAGE BIT   @Y30LB02*/') 59302800
*        SKIP;                                                          59307800
*   ANS('        3 ARSEC BIT(1), /*NEWLY ALLOCATED SECONDARY EXTENT'||  59312800
*        ' BIT @G24LB04*/')SKIP;                                        59317800
*   ANS('        3 * BIT(4), /*THESE BITS ALWAYS ZEROES   @G24LB04*/')  59322800
*        SKIP;                                                          59327800
*   ANS('      2  ARNMEXT FIXED(8),/* #EXTS  @Y30LB02*/') SKIP;         59332800
*   ANS('      2  ARVOL CHAR(6), /*VOLID  @Y30LB02*/') SKIP;            59337800
*   ANS('      2  ARASID CHAR(2),/*ASID FIELD  @Y30LB02*/') SKIP;       59342800
*   ANS('      2  ARECB PTR(31), /*ADDR OF ECB  @ZA28964*/')            59347800
*        SKIP;                                                          59352800
*   ANS('      2  ARHOST CHAR(5),  /*HOSTID  @Y30LB02*/') SKIP;         59357800
*   ANS('      2  * CHAR(1),  /*ZEROES  @Y30LB02*/') SKIP;              59362800
*   ANS('      2  ARCOMPC CHAR(2),  /*COMP CODE  @Y30LB02*/')SKIP;      59367800
*   ANS('      2  AREXT (16), /*EXTENTS  @Y30LB02*/')                   59372800
*        SKIP;                                                          59377800
*   ANS('        3 * CHAR(4), /*ELEMENT OF EXTS ARRAY   @Y30LB02*/')    59382800
*        SKIP;                                                          59387800
*   ANS('      2  ARNEDB PTR(31);  /*ADDR OF NEDB   @ZA28964*/')        59392800
*        SKIP;                                                          59397800
*   ANS('DCL ARLEN FIXED(31) DEF(ARLL), /*BAL LABEL @ZA28964*/')SKIP;   59402800
*   ANS('    ARFLAG BIT(8) DEF(ARFLG),/*BAL LABEL @ZA28964*/')SKIP;     59407800
*   ANS('    ARNMEXTS FIXED(8) DEF(ARNMEXT);  ' ||                      59412800
*       '/*BAL LABEL @ZA28964*/')SKIP;                                  59417800
*   GO TO FINISH;                      /*BRANCH TO END       @Y30LB02*/ 59422800
*/*                                                          @ZA28964*/ 59427800
*  STDSEC:                                                              59455600
*   ANS('/*******************************************'||                59457600
*       '************  @Y30LB02*/')SKIP;                                59462800
*   ANS('/*MACMEAN  MSSC ACQUIRE/RELINQUISH MACRO    '||                59470000
*       '              @Y30LB02*/')SKIP;                                59477200
*   ANS('/*         VERSION - VS/2 REL 3    77/12/15 '||                59487200
*       'LEVEL 02      @ZA28964*/')SKIP;                                59493200
*   ANS('/*THIS IS THE OUTPUT FOR A SECONDARY        '||                59507200
*       '              @Y30LB02*/')SKIP;                                59517200
*   ANS('/*INVOCATION OF THE STANDARD FORM MACRO     '||                59519200
*       '              @Y30LB02*/')SKIP;                                59521200
*   ANS('/*******************************************'||                59523200
*       '************  @Y30LB02*/')SKIP;                                59525200
*   ANS('RFY(ARR1)RSTD;/*RESTRICT R1  @Y30LB02*/')SKIP;                 59525600
*   ANS('ARR1=ADDR(ARLL);'||                                            59526000
*       '/*ARR1 SET TO ADDRESS OF LIST  @Y30LB02*/') SKIP;              59526400
*   IF TYPE(1)='ACQ' THEN              /* AN ACQ REQUEST?    @Y30LB02*/ 59527400
*     ANS('AROP='||QUOTE(AOPCODE)||'X;/*ACQ OPCODE  @Y30LB02*/')SKIP;   59528400
*   ELSE                              /*RELINQUISH CODE      @Y30LB02*/ 59529400
*     ANS('AROP='||QUOTE(ROPCODE)||'X;/*REL OPCODE  @Y30LB02*/')SKIP;   59530400
*   GO TO FCHECK;                    /*BRCH TO STANDF CODE   @Y30LB02*/ 59531400
*/*                                                          @ZA28964*/ 59532400
*  STDINT:                                                              59538200
*   ANS('/*******************************************'||                59540200
*       '************  @Y30LB02*/')SKIP;                                59541000
*   ANS('/*MACMEAN  MSSC ACQUIRE/RELINQUISH MACRO    '||                59543800
*       '              @Y30LB02*/')SKIP;                                59553800
*   ANS('/*         VERSION - VS/2 REL 3    77/12/15 '||                59555800
*       'LEVEL 02      @ZA28964*/')SKIP;                                59556800
*   ANS('/*THIS IS THE STANDARD FORM - ACQ/REL MACRO '||                59559800
*       '              @Y30LB02*/')SKIP;                                59560200
*   ANS('/*******************************************'||                59560300
*       '************  @Y30LB02*/')SKIP;                                59560400
*   ANS('DCL  1  ARLIST,/*ACQUIRE/RELINQUISH @Y30LB02*/') SKIP;         59566000
*   ANS('      2  ARLL FIXED(31) INIT(96), /* LENGTH     @Y30LB02*/')   59571000
*        SKIP;                                                          59576000
*   IF TYPE(1)='ACQ' THEN              /*ACQUIRE REQUEST?    @Y30LB02*/ 59581000
*     ANS('      2  AROP FIXED(8) INIT(2),/*OPCODE  @Y30LB02*/')SKIP;   59586000
*   ELSE                                                   /*@Y30LB02*/ 59591000
*     ANS('      2  AROP FIXED(8) INIT(4),/*OPCODE  @Y30LB02*/')SKIP;   59596000
*   ANS('      2  * CHAR(1) INIT('||QUOTE('00')||                       59601000
*        'X), /*RESERVED AREA  @Y30LB02*/') SKIP;                       59606000
*   ANS('      2  ARFLG BIT(8) INIT('||QUOTE('00000000')||              59611000
*        'B), /*FLAGS  @Y30LB02*/') SKIP;                               59616000
*   ANS('        3 ARBDUBD BIT(1),   /* BIND/UNBIND BIT  @Y30LB02*/')   59621000
*        SKIP;                                                          59626000
*   ANS('        3 ARDRES BIT(1),/* DELAYED RESPONSE BIT  @Y30LB02*/')  59631000
*        SKIP;                                                          59636000
*   ANS('        3 ARINH BIT(1), /*INHIBIT (DE)STAGE BIT  @Y30LB02*/')  59641000
*        SKIP;                                                          59646000
*   ANS('        3 ARSEC BIT(1), /*NEWLY ALLOCATED SECONDARY EXTENT'||  59651000
*        'BIT @G24LB04*/')SKIP;                                         59656000
*   ANS('        3 * BIT(4), /*THESE BITS ALWAYS ZEROES   @G24LB04*/')  59661000
*        SKIP;                                                          59666000
*   ANS('      2  ARNMEXT FIXED(8) INIT(0), /* #EXTS  @Y30LB02*/')      59671000
*        SKIP;                                                          59676000
*   ANS('      2  ARVOL CHAR(6) INIT('||                                59681000
*        QUOTE('000000000000')||'X), /*VOLID  @Y30LB02*/') SKIP;        59686000
*   ANS('      2  ARASID CHAR(2) INIT('||QUOTE('0000')||                59691000
*        'X), /*ASID AREA  @Y30LB02*/') SKIP;                           59696000
*   ANS('      2  ARECB PTR(31) INIT(0), /*ADDR OF ECB  @ZA28964*/')    59701000
*        SKIP;                                                          59706000
*   ANS('      2  ARHOST CHAR(5) INIT('||QUOTE('0000000000')            59711000
*       || 'X),  /*HOSTID  @Y30LB02*/') SKIP;                           59716000
*   ANS('      2  * CHAR(1) INIT('||QUOTE('00')                         59721000
*       || 'X),  /*ZEROES  @Y30LB02*/') SKIP;                           59726000
*   ANS('      2  ARCOMPC CHAR(2) INIT('||QUOTE('0000')                 59731000
*       || 'X),/*ZERO COMP CODE FLD  @Y30LB02*/') SKIP;                 59736000
*   ANS('      2  AREXT(16) , /*EXTENTS  @Y30LB02*/') SKIP;             59741000
*   ANS('       3 * CHAR(4) INIT('||                                    59746000
*      QUOTE('00000000')||'X),') SKIP;                                  59751000
*   ANS('      2  ARNEDB PTR(31) INIT(0);/*ADDR OF NEDB  @ZA28964*/')   59756000
*        SKIP;                                                          59761000
*   ANS('DCL ARLEN FIXED(31) DEF(ARLL), /*BAL LABEL @ZA28964*/')SKIP;   59766000
*   ANS('    ARFLAG BIT(8) DEF(ARFLG),/*BAL LABEL @ZA28964*/')SKIP;     59771000
*   ANS('    ARNMEXTS FIXED(8) DEF(ARNMEXT);  ' ||                      59776000
*       '/*BAL LABEL @ZA28964*/')SKIP;                                  59781000
*   ANS('RFY(ARR1)RSTD;/*RESTRICT R1  @Y30LB02*/')SKIP;                 59786000
*   ANS('ARR1=ADDR(ARLL);/*ARR1 SET TO ADDRESS OF LIST  @Y30LB02*/')    59791000
*       SKIP;                                                           59796000
*   GO TO FCHECK;                                          /*@ZA28964*/ 59801000
*/*                                                          @ZA28964*/ 59806000
*  EXEC:                                                                59859400
*   ANS('/*******************************************'||                59859800
*       '************  @Y30LB02*/')SKIP;                                59861400
*   ANS('/*MACMEAN  MSSC ACQUIRE/RELINQUISH MACRO    '||                59861500
*       '              @Y30LB02*/')SKIP;                                59911500
*   ANS('/*         VERSION - VS/2 REL 3    77/12/15 '||                59921500
*       'LEVEL 02      @ZA28964*/')SKIP;                                59927500
*   ANS('/*THIS IS THE OUTPUT FOR THE EXECUTE FORM.  '||                59933500
*       '              @Y30LB02*/')SKIP;                                59939500
*   ANS('/*THE LIST FORM OF THIS MACRO SHOULD BE     '||                59953500
*       '              @Y30LB02*/')SKIP;                                59955500
*   ANS('/*INVOKED FIRST IN ORDER TO SET UP NECESSARY'||                59957500
*       '              @Y30LB02*/')SKIP;                                59959500
*   ANS('/*DECLARES.  THE EXECUTE FORM WILL ONLY     '||                59959900
*       '              @Y30LB02*/')SKIP;                                59960300
*   ANS('/*ISSUE THE SVC.                            '||                59960700
*       '              @Y30LB02*/')SKIP;                                59961100
*   ANS('/*******************************************'||                59961200
*       '************  @Y30LB02*/')SKIP;                                59961300
*   ANS('RFY(ARR1)RSTD;/*RESTRICT R1  @Y30LB02*/')SKIP;                 59961400
*   ANS('ARR1=ADDR('||MF(2)||                                           59978100
*       '); /*SET ARR1 TO ADDR OF LIST  @Y30LB02*/')  SKIP;             59988100
*   GO TO QUIT;                                            /*@ZA28964*/ 60038100
*/*                                                          @ZA28964*/ 60088100
*FINISH:RETURN CODE(RETCODE);/*RETURN CODE                   @Y30LB02*/ 60138100
*        %END;                                             /*@Y30LB02*/ 60188100
