* %/*  START OF SPECIFICATIONS****                             @Y30LB02 00050003
.*                                                             @Y30LB02 00100003
.*01   MODULE-NAME = ICBASDAS                                  @Y30LB02 00150003
.*                                                             @Y30LB02 00200003
.*01   DESCRIPTIVE-NAME = ASSOCIATE-DISASSOCIATE MACRO         @Y30LB02 00250003
.*                                                             @Y30LB02 00300003
.*01   COPYRIGHT = NONE                                        @Y30LB02 00350003
.*                                                             @Y30LB02 00400003
.*01   STATUS = OS/VS1 RELEASE 4, OS/VS2 RELEASE 3             @Y30LB02 00450003
.*                                                             @Y30LB02 00500003
.*01   FUNCTION=THIS MACRO BUILDS THE REQUEST BLOCK            @Y30LB02 00550003
.*     NECESSARY TO ASSOCIATE/DISASSOCIATE CPU'S IN AN         @Y30LB02 00600003
.*     MP ENVIRONMENT                                          @Y30LB02 00650003
.*                                                             @Y30LB02 00700003
.*01   NOTES = AS FOLLOWS:                                     @Y30LB02 00750003
.*                                                             @Y30LB02 00800003
.*02     CODE = MACRO IS BILINGUALLY CODED                     @Y30LB02 00850003
.*                                                             @Y30LB02 00900003
.*02     RESTRICTIONS = THE FOLLOWING PREFIXES SHOULD BE       @Y30LB02 00950003
.*                      AVOIDED IN THE USER'S INVOCATION:      @Y30LB02 01000003
.*                      ICB AND AS/DAS                         @Y30LB02 01050003
.*                                                             @Y30LB02 01100003
.*02     REGISTER-CONVENTIONS = FOLLOW NORMAL USE OF           @Y30LB02 01150003
.*                              REGISTERS BY MACROS:           @Y30LB02 01200003
.*                              R0,R1,R14, AND R15.            @Y30LB02 01250003
.*                                                             @Y30LB02 01300003
.*01   MODULE-TYPE = MACRO                                     @Y30LB02 01350003
.*                                                             @Y30LB02 01400003
.*02     PROCESSOR = PLS2 AND ASSEMBLER                        @Y30LB02 01450003
.*                                                             @Y30LB02 01550003
.*02     ATTRIBUTES = REUSABLE                                 @Y30LB02 01600003
.*                                                             @Y30LB02 01650003
.*02     ENTRY-POINT = ICBASDAS                                @Y30LB02 01700003
.*                                                             @Y30LB02 01750003
.*                                                             @Y30LB02 01800003
.*02     LINKAGE = SVC 126                                     @Y30LB02 01850003
.*                                                             @Y30LB02 01900003
.*01  INPUT                                                    @Y30LB02 01950003
.*                                                             @Y30LB02 02000003
.*   THE ASSOCIATE-DISASSOCIATE MACRO IS ISSUED TO             @Y30LB02 02050003
.*   CHANGE THE RELATIONSHIP BETWEEN CPU'S(HOSTS) OF           @Y30LB02 02100003
.*   TIGHTLY COUPLED MP SYSTEMS  AND  NETWORKS.                @Y30LB02 02150003
.*                                                             @Y30LB02 02200003
.*   THE ASSOCIATE-DISASSOCIATE MACRO WILL                     @Y30LB02 02250003
.*   PERFORM THE FOLLOWING:                                    @Y30LB02 02300003
.*                                                             @Y30LB02 02350003
.*        (1)  ASSOCIATE CPU AND ITS PREDEFINED ASSOCIATE      @Y30LB02 02400003
.*             CPU AS TIGHTLY COUPLED MP  CPU'S.               @Y30LB02 02450003
.*                                                             @Y30LB02 02500003
.*        (2)  DISASSOCIATE CPU1 AND ITS PREDEFINED ASSOCIATE  @Y30LB02 02550003
.*             CPU.                                            @Y30LB02 02600003
.*                                                             @Y30LB02 02650003
.*                                                             @Y30LB02 02700003
.*        (3)  DEINITIALIZE THE INTERFACE FOR THE              @Y30LB02 02750003
.*             ASSOCIATED CPU                                  @Y30LB02 02800003
.*                                                             @Y30LB02 02850003
.*        (4)  DEMOUNT ALL VOLUMES FOR BOTH CPUS               @Y30LB02 02900003
.*                                                             @Y30LB02 02950003
.*        MACRO SYNTAX:                                        @Y30LB02 03000003
.*                                                             @Y30LB02 03050003
.*   LIST FORM                                                 @Y30LB02 03100003
.*                                                             @Y30LB02 03150003
.* VERB    REQUIRED PARMS        OPTIONAL PARMS                @Y30LB02 03200003
.*                                                             @Y30LB02 03250003
.*ICBASDAS MF=L - (BAL)          MF=(L,MAP) - BAL              @Y30LB02 03300003
.*         MF(L,NAME/(R))-PLS    MF(L,NAME/(R),ATTR)-PLS       @Y30LB02 03350003
.*                                                             @Y30LB02 03400003
.*   STANDARD FORM                                             @Y30LB02 03450003
.*                                                             @Y30LB02 03500003
.* VERB    REQUIRED PARMS        OPTIONAL PARMS                @Y30LB02 03550003
.*                                                             @Y30LB02 03600003
.*ICBASDAS HOSTID=ADDR/(R)       NONE                          @Y30LB02 03650003
.*         FLAGS=ADDR/(R)                                      @Y30LB02 03700003
.*                                                             @Y30LB02 03750003
.*                                                             @Y30LB02 03800003
.* EXECUTE FORM                                                @Y30LB02 03850003
.*                                                             @Y30LB02 03900003
.* VERB    REQUIRED PARMS        OPTIONAL PARMS                @Y30LB02 03950003
.*                                                             @Y30LB02 04000003
.*ICBASDAS MF(E,NAME/(R))       MF(E,NAME/(R),COMPLETE)-PLS    @Y30LB02 04050003
.*                              FLAGS=ADDR/(R)                 @Y30LB02 04100003
.*                              HOSTID=ADDR/(R)                @Y30LB02 04150003
.*                                                             @Y30LB02 04200003
.*   KEYWORD PARAMETERS:                                       @Y30LB02 04250003
.*                                                             @Y30LB02 04300003
.*   MF  -  MACRO FORMAT: THIS PARAMETER DESCRIBES THE         @Y30LB02 04350003
.*          MACRO FORMAT AND MAY GIVE THE ADDRESS OR           @Y30LB02 04400003
.*          ADDRESS IN A REGISTER WHERE THE REQUEST BLOCK      @Y30LB02 04450003
.*          IS STORED.                                         @Y30LB02 04500003
.*                                                             @Y30LB02 04550003
.*          L - LIST FORM: THE EXPANSION OF THE L-FORM         @Y30LB02 04600003
.*              MACRO WILL RESULT IN A REQUEST BLOCK WITH      @Y30LB02 04650003
.*              THE ONLY NON-ZERO FIELDS BEING THE OPCODE      @Y30LB02 04700003
.*              AND LENGTH FIELDS.                             @Y30LB02 04750003
.*                                                             @Y30LB02 04800003
.*          (1) 'MAP' - IF MAP IS SPECIFIED WITH THE           @Y30LB02 04850003
.*              ASSEMBLER MACRO CALL A DSECT EQUIVALENT TO     @Y30LB02 04900003
.*              A MAPPING MACRO IS PRODUCED.                   @Y30LB02 04950003
.*                                                             @Y30LB02 05000003
.*          (2) NAME - THE MACRO INVOKER MUST SPECIFY A        @Y30LB02 05050003
.*              NAME FOR HIS STRUCTURE WHEN INVOKING THE       @Y30LB02 05100003
.*              PLS LIST FORM.                                 @Y30LB02 05150003
.*                                                             @Y30LB02 05200003
.*          (3) ATTRIBUTE - THE MACRO WILL PLACE ANY PLS       @Y30LB02 05250003
.*              ATTRIBUTE SPECIFIED IN THE MACRO INVOCATION    @Y30LB02 05300003
.*              IN AN UNINITIALIZED REQUEST BLOCK.  ATTRI-     @Y30LB02 05350003
.*              BUTE EXAMPLE:                                  @Y30LB02 05400003
.*                                                             @Y30LB02 05450003
.*              CHAR, FIXED, STATIC LOCAL, NONLOCAL,           @Y30LB02 05500003
.*              BASED(*), ETC.                                 @Y30LB02 05550003
.*                                                             @Y30LB02 05600003
.*       NULL - STANDARD FORM: THE EXPANSION OF THIS FORM      @Y30LB02 05650003
.*              CONSISTS OF A REQUEST BLOCK, A LINKAGE         @Y30LB02 05700003
.*              INSTRUCTION, AND, POSSIBLY, PARAMETER          @Y30LB02 05750003
.*              BINDING INSTRUCTION.                           @Y30LB02 05800003
.*                                                             @Y30LB02 05850003
.*          E - EXECUTABLE FORM: THE EXPANSION OF THIS FORM    @Y30LB02 05900003
.*              CONSISTS OF A LINKAGE INSTRUCTION AND          @Y30LB02 05950003
.*              POSSIBLY, PARAMETER BINDING INSTRUCTIONS.      @Y30LB02 06000003
.*                                                             @Y30LB02 06050003
.*              SUB-PARAMETERS                                 @Y30LB02 06100003
.*                                                             @Y30LB02 06150003
.*              (1)  AN E MUST BE SPECIFIED IN THE FIRST       @Y30LB02 06200003
.*                   SUB-PARAMETER POSITION.  THIS INDICATES   @Y30LB02 06250003
.*                   THAT THE MACRO IS IN EXECUTABLE FORM.     @Y30LB02 06300003
.*                                                             @Y30LB02 06350003
.*              (2)  A NAME OR A REGISTER MUST BE SPECIFIED    @Y30LB02 06400003
.*                   IN THE SECOND SUB-PARAMETER.              @Y30LB02 06450003
.*                                                             @Y30LB02 06500003
.*              (3)  'COMPLETE' - COMPLETE WILL CAUSE THE      @Y30LB02 06550003
.*                   MACRO TO ZERO OUT THE REQUEST BLOCK.      @Y30LB02 06600003
.*                   AFTER ZEROING THE REQUEST BLOCK THE       @Y30LB02 06650003
.*                   FUNCTION OPCODE AND LENGTH ARE PLACED     @Y30LB02 06700003
.*                   IN THE REQUEST BLOCK.                     @Y30LB02 06750003
.*                                                             @Y30LB02 06800003
.*   FLAGS  - THE 2 BYTE FIELD WHICH INDICATES THE FUNCTION    @Y30LB02 06850003
.*            TO BE PERFORMED.  THE ATTRIBUTES FOLLOW:         @Y30LB02 06900003
.*                                                             @Y30LB02 06950003
.*       ASSOCIATE CPU                                         @Y30LB02 07000003
.*                                                             @Y30LB02 07050003
.*         IF THIS ATTRIBUTE IS SPECIFIED, CPU (SPECIFIED      @Y30LB02 07100003
.*         BY HOSTID) AND ITS PREDEFINED ASSOCIATE CPU WILL    @Y30LB02 07150003
.*         BE ASSOCIATED AS TIGHTLY COUPLED MP HOSTS.          @Y30LB02 07200003
.*                                                             @Y30LB02 07250003
.*       DISASSOCIATE CPU                                      @Y30LB02 07300003
.*                                                             @Y30LB02 07350003
.*         IF THIS ATTRIBUTE IS SPECIFIED, CPU (SPECIFIED      @Y30LB02 07400003
.*         BY HOSTID) AND ITS PREDEFINED ASSOCIATED CPU        @Y30LB02 07450003
.*         WILL NO LONGER BE ASSOCIATED AS TIGHTLY COUPLED     @Y30LB02 07500003
.*         MP HOSTS.                                           @Y30LB02 07550003
.*                                                             @Y30LB02 07600003
.*        DEINITIALIZE INTERFACE                               @Y30LB02 07650003
.*                                                             @Y30LB02 07700003
.*         THIS BIT HAS THE SAME FUNCTION AS ATTRIBUTE         @Y30LB02 07750003
.*         BIT 1 PLUS DEINITIALIZE THE INTERFACE FOR THE       @Y30LB02 07800003
.*         OTHER CPU SPECIFIED IN THE CPU ASSOCIATION          @Y30LB02 07850003
.*         TABLE.  IF THE CPU'S ARE ALREADY DISASSOCIATED      @Y30LB02 07900003
.*         THE ORDER IS UNIT CHECKED.                          @Y30LB02 07950003
.*                                                             @Y30LB02 08000003
.*        DEMOUNT                                              @Y30LB02 08050003
.*                                                             @Y30LB02 08100003
.*         THIS ATTRIBUTE HAS THE SAME FUNCTION AS             @Y30LB02 08150003
.*         ATTRIBUTE BIT 0 EXCEPT ALL VOLUMES FOR BOTH         @Y30LB02 08200003
.*         CPU'S ARE DEMOUNTED.  THE FUNCTION IS DONE          @Y30LB02 08250003
.*         EVEN THOUGH THE CPU'S ARE ALREADY ASSOCIATED.       @Y30LB02 08300003
.*                                                             @Y30LB02 08350003
.*                                                             @Y30LB02 08400003
.*       THE FORMAT OF THE FLAGS FIELD IS                      @Y30LB02 08450003
.*                                                             @Y30LB02 08500003
.*      ____________________________________________________   @Y30LB02 08550003
.*      | X | X | 0 | 0 | 0 | X | X |BITS 7-15 MUST BE ZERO|   @Y30LB02 08600003
.*      -----------------------------------------------------  @Y30LB02 08650003
.*      BIT 0------------'1'B          ASSOCIATE CPUS          @Y30LB02 08700003
.*                       '0'B          DON'T ASSOCIATE         @Y30LB02 08750003
.*                                                             @Y30LB02 08800003
.*      BIT 1------------'1'B          DISASSOCIATE CPUS       @Y30LB02 08850003
.*                       '0'B          DON'T DISASSOCIATE      @Y30LB02 08900003
.*                                                             @Y30LB02 08950003
.*      BITS 2-4 --------              |RESERVED,MUST BE ZERO| @Y30LB02 09000003
.*                                                             @Y30LB02 09050003
.*      BIT 5------------'1'B          DEINITIALIZE INTERFACE  @Y30LB02 09100003
.*                       '0'B          DON'T DENITIALIZE       @Y30LB02 09150003
.*                                                             @Y30LB02 09200003
.*      BIT 6------------'1'B          DEMOUNT                 @Y30LB02 09250003
.*                       '0'B          DON'T DEMOUNT           @Y30LB02 09300003
.*                                                             @Y30LB02 09350003
.*      BITS 7-15-------               |UNUSED,MUST BE ZERO|   @Y30LB02 09400003
.*                                                             @Y30LB02 09450003
.*      HOSTID - HOSTID IDENTIFIER:  THE 5 BYTE AREA WHICH     @Y30LB02 09500003
.*               CONTAINS THE MANUFACTURER'S CPU IDENTI-       @Y30LB02 09550003
.*               FICATION OF CPU #1 OR CPU #2 OF A MP          @Y30LB02 09600003
.*               OR NETWORK ENVIRONMENT.                       @Y30LB02 09650003
.*                                                             @Y30LB02 09700003
.*01  EXIT-NORMAL = VALID INVOCATION                           @Y30LB02 09750003
.*                                                             @Y30LB02 09800003
.*                                                             @Y30LB02 09850003
.*02     CONDITION = RETURN CODE = 0                           @Y30LB02 09900003
.*                                                             @Y30LB02 09950003
.*02     OUTPUT = IN-LINE PLS/BAL STATEMENTS THAT PERFORM      @Y30LB02 10000003
.*       THE REQUESTED FUNCTION                                @Y30LB02 10050003
.*                                                             @Y30LB02 10100003
.*01  EXIT-ERROR = INVALID INVOCATION                          @Y30LB02 10150003
.*                                                             @Y30LB02 10200003
.*02     CONDITION = RETURN CODE = 12                          @Y30LB02 10250003
.*                                                             @Y30LB02 10300003
.*02     OUTPUT = ERROR MESSAGE AS A COMMENT AT POINT OF       @Y30LB02 10350003
.*                INVOCATION                                   @Y30LB02 10400003
.*                                                             @Y30LB02 10450003
.*01  EXTERNAL REFERENCES = NONE                               @Y30LB02 10500003
.*                                                             @Y30LB02 10550003
.*                                                             @Y30LB02 10600003
.*01  TABLES = NONE                                            @Y30LB02 10650003
.*                                                             @Y30LB02 10700003
.*01  MESSAGES = AS FOLLOWS:                                   @Y30LB02 10750003
.*     ICB602I:  A NAME FOR THE REQUEST BLOCK MUST BE          @Y30LB02 10800003
.*               SPECIFIED IN MF(2)                            @Y30LB02 10850003
.*     ICB604I:  WARNING ONLY THE MF  PARAMETER  IS            @Y30LB02 10900003
.*               VALID FOR LIST FORM                           @Y30LB02 10950003
.*     ICB607I:  FLAGS MUST BE SPECIFIED FOR STANDARD          @Y30LB02 11000003
.*               FORM MACRO                                    @Y30LB02 11050003
.*     ICB608I:  HOSTID MUST BE SPECIFIED FOR STANDARD         @Y30LB02 11100003
.*               FORM MACRO                                    @Y30LB02 11150003
.*     ICB612I:  MF(2) MUST CONTAIN REQ BLK NAME IF            @Y30LB02 11200003
.*               EXEC MACRO FORM REQUESTED                     @Y30LB02 11250003
.*     ICB615I:  INVALID MF PARAMETER SPECIFIED, MUST BE       @Y30LB02 11300003
.*                L,E, OR NULL                                 @Y30LB02 11350003
.*                                                             @Y30LB02 11400003
.*01  CONTROL-BLOCKS = NONE                                    @Y30LB02 11450003
.*                                                             @Y30LB02 11500003
.*01  INNER MACROS = NONE                                      @Y30LB02 11550003
.*                                                             @Y30LB02 11600003
.*01  SYSTEM MACRO = IHBINNRA                                  @Y30LB02 11650003
.*                                                             @Y30LB02 11700003
.*01  CHANGE-ACTIVITY = S/D X04AC02 & Y30LB02                  @Y30LB02 11750003
.*                                                             @Y30LB02 11800003
.**** END OF SPECIFICATIONS ***                                @Y30LB02 11850003
         MACRO                                                          11900003
&SYMBOL  ICBASDAS &MF=,&FLAGS=,&HOSTID=                                 11950003
         LCLB &ERSW               ERROR SWITCH                 @Y30LB02 12000003
         LCLC &ASDAS              ASSOC MACRO INSTR INDX       @Y30LB02 12050003
&ASDAS   SETC 'ASD'.'&SYSNDX'     ASSIGN CHARACTER VALUE       @Y30LB02 12100003
.*                                                             @Y30LB02 12150003
.*       DETERMINATION OF DESIRED MACRO FORM                   @Y30LB02 12200003
.*                                                             @Y30LB02 12250003
         AIF  ('&MF(1)' NE 'L').EFORM       LIST FORM?         @Y30LB02 12300003
         AIF  ('&FLAGS' EQ '' AND '&HOSTID' EQ '').LISTOK      @AS17746 12350003
         MNOTE 4,'  ICB604I - WARNING-ONLY THE MF  '           @Y30LB02 12400003
         MNOTE 4,'  PARAMETER IS VALID FOR LIST FORM '         @Y30LB02 12450003
.*                                                             @Y30LB02 12500003
.LISTOK  ANOP                                                  @Y30LB02 12550003
*  MACMEAN  ASSOCIATE MACRO--INITIALIZED LIST FORM             @Y30LB02 12600003
*  VS1-4/VS2-3 VERSION--06/09/74   LEVEL 00                    @Y30LB02 12650003
         AIF  ('&MF(2)' EQ 'MAP').LISTDS   DSECT REQUESTED?    @Y30LB02 12700003
&SYMBOL  DS   0F                                               @Y30LB02 12750003
ASDALEN  DC   F'16'               LENGTH OF ASSOC REQ BLOCK    @Y30LB02 12800003
ASDAOPC  DC   XL1'2C'             ASSOCIATE  FUNCTION OPCODE   @Y30LB02 12850003
ASDA001  DC   XL1'00'             1-BYTE RESERVED AREA         @Y30LB02 12900003
ASDAFLG  DC   XL2'0000'           2-BYTE FLAGS AREA            @Y30LB02 12950003
ASDACPU  DC   CL5'00000'          5-BYTE HOSTID AREA           @Y30LB02 13000003
ASDA002  DC   XL3'000000'         3-BYTE RESERVED AREA         @Y30LB02 13050003
         AGO  .FINISH                                          @Y30LB02 13100003
.*                                                             @Y30LB02 13150003
.LISTDS  ANOP                                                  @Y30LB02 13200003
*  MACMEAN  ASSOCIATE MACRO--UNINITIALIZED LIST FORM           @Y30LB02 13250003
*  VS1-4/VS2-3 VERSION--06/09/74   LEVEL 00                    @Y30LB02 13300003
ICBASDAS DSECT                                                 @Y30LB02 13350003
ASDALEN  DS   F                   LENGTH OF ASSOC 16 DEC       @Y30LB02 13400003
ASDAOPC  DS   XL1                 ASSOCIATE OPCODE 2C HEX      @Y30LB02 13450003
ASDA001  DS   XL1                 1-BYTE RESERVED AREA-ZERO    @Y30LB02 13500003
ASDAFLG  DS   XL2                 2-BYTE FLAGS AREA            @Y30LB02 13550003
ASDACPU  DS   CL5                 5-BYTE HOSTID AREA           @Y30LB02 13600003
ASDA002  DS   XL3                 3-BYTE RESERVED AREA         @Y30LB02 13650003
         AGO  .FINISH                                          @Y30LB02 13700003
.*                                                             @Y30LB02 13750003
.*       THE FOLLOWING PROCESSING IS ACCOMPLISHED FOR THE      @Y30LB02 13800003
.*       EXECUTABLE MACRO FORM                                 @Y30LB02 13850003
.*                                                             @Y30LB02 13900003
.EFORM   AIF  ('&MF(1)' NE 'E').SFORM       EXECUTE FORM?      @Y30LB02 13950003
         AIF  ('&MF(2)' EQ '').EXFAIL       MF(2) NULL?        @Y30LB02 14000003
*  MACMEAN  ASSOCIATE MACRO--EXECUTE FORM                      @Y30LB02 14050003
*  VS1-4/VS2-3 VERSION--06/09/74   LEVEL 00                    @Y30LB02 14100003
&SYMBOL  IHBINNRA &MF(2)          LOAD REG ONE USING           @Y30LB02 14150003
.*                                IHBINNRA MACRO               @Y30LB02 14200003
         LA   0,16                LEN OF ASSOC REQBLK          @Y30LB02 14250003
         ST   0,0(1)              STORE LEN IN REQBLK          @Y30LB02 14300003
         MVI  4(1),X'2C'          ASSOC OPCODE IN BLK          @Y30LB02 14350003
         AGO  .CKSW1                                           @Y30LB02 14400003
.*                                                             @Y30LB02 14450003
.EXFAIL  ANOP                                                  @Y30LB02 14500003
         MNOTE 12,'  ICB612I - MF(2) MUST CONTAIN REQ BLK '    @Y30LB02 14550003
         MNOTE 12,'  NAME IF EXEC MACRO FORM IS REQUESTED '    @Y30LB02 14600003
&ERSW    SETB 1                   SET ERROR SWITCH TO 1        @Y30LB02 14650003
.*                                                             @Y30LB02 14700003
.CKSW1   AIF  (&ERSW).FINISH      IF ERROR-END PROCESSING      @Y30LB02 14750003
         AGO  .COMMON                                          @Y30LB02 14800003
.*                                                             @Y30LB02 14850003
.*       PROCESSING OF THE STANDARD FORM MACRO                 @Y30LB02 14900003
.*                                                             @Y30LB02 14950003
.SFORM   AIF  ('&MF(1)' NE '').BADFORM      STANDARD FORM?     @Y30LB02 15000003
         AIF  ('&FLAGS' NE '').CKHOST       FLAGS SPECIFIED?   @Y30LB02 15050003
&ERSW    SETB 1                   SET ERROR SWITCH TO 1        @Y30LB02 15100003
         MNOTE 12,'  ICB607I - FLAGS MUST BE SPECIFIED '       @Y30LB02 15150003
         MNOTE 12,'  FOR STANDARD FORM MACRO '                 @Y30LB02 15200003
         AGO  .CKSW2                                           @Y30LB02 15250003
.CKHOST  AIF  ('&HOSTID' NE '').CKSW2    HOSTID SPECIFIED?     @Y30LB02 15300003
&ERSW    SETB 1                   SET ERROR SWITCH TO 1        @Y30LB02 15350003
         MNOTE 12,'  ICB608I - HOSTID MUST BE SPECIFIED '      @Y30LB02 15400003
         MNOTE 12,'  FOR STANDARD FORM MACRO '                 @Y30LB02 15450003
         AGO  .CKSW2                                           @Y30LB02 15500003
.*                                                             @Y30LB02 15550003
.BADFORM ANOP                                                  @Y30LB02 15600003
&ERSW    SETB 1                   SET ERROR SWITCH TO 1        @Y30LB02 15650003
         MNOTE 12,'  ICB615I - INVALID MF PARAMETER '          @Y30LB02 15700003
         MNOTE 12,'  SPECIFIED, MUST BE L, E, OR NULL.'        @Y30LB02 15750003
.*                                                             @Y30LB02 15800003
.*       THE FOLLOWING CODE CHECKS TO DETERMINE IF THE ERROR   @Y30LB02 15850003
.*       SWITCH IS ON. IF YES, PROCESSING IS TERMINATED, OTHER @Y30LB02 15900003
.*       WISE STANDARD FORM MACRO PROCESSING WILL BE CON-      @Y30LB02 15950003
.*       TINUED                                                @Y30LB02 16000003
.*                                                             @Y30LB02 16050003
.CKSW2   AIF  (&ERSW).FINISH      IF YES-END PROCESSING        @Y30LB02 16100003
*  MACMEAN ASSOCIATE MACRO--STANDARD FORM                      @Y30LB02 16150003
*  VS1-4/VS2-3 VERSION--06/09/74   LEVEL 00                    @Y30LB02 16200003
         CNOP 0,4                                              @Y30LB02 16250003
&SYMBOL  BAL  1,&ASDAS            SET R1 ADDR OF REQBLK        @Y30LB02 16300003
ASDALEN  DC   A(&ASDAS-*)         LENGTH OF REQUEST BLOCK      @Y30LB02 16350003
ASDAOPC  DC   XL1'2C'             ASSOCIATE  FUNCTION OPCODE   @Y30LB02 16400003
ASDA001  DC   XL1'00'             1-BYTE RESERVED AREA         @Y30LB02 16450003
ASDAFLG  DC   XL2'0000'           2-BYTE FLAGS AREA            @Y30LB02 16500003
ASDACPU  DC   CL5'00000'          5-BYTE HOSTID AREA           @Y30LB02 16550003
ASDA002  DC   XL3'000000'         3-BYTE RESERVED AREA         @Y30LB02 16600003
&ASDAS   EQU  *                                                @Y30LB02 16650003
.*                                                             @Y30LB02 16700003
.*       THE FOLLOWING CODE CHECKS FOR VALID PARAMETERS IF     @Y30LB02 16750003
.*       STANDARD OR EXECUTE FORM MACRO IS SPECIFIED.          @Y30LB02 16800003
.*       IF PARAMETERS ARE SPECIFIED, THEY WILL BE STORED      @Y30LB02 16850003
.*       IN THE REQUEST BLOCK.                                 @Y30LB02 16900003
.*                                                             @Y30LB02 16950003
.COMMON  AIF  ('&FLAGS' EQ '').HOSTD       FLAGS SPECIFIED?    @Y30LB02 17000003
         AIF  ('&FLAGS'(1,1) EQ '(').FLREG  FLAGS IN REG-FORM? @Y30LB02 17050003
         MVC  6(2,1),&FLAGS       PUT FLAGS IN PARM LIST       @Y30LB02 17100003
         AGO  .HOSTD              BRANCH TO CK HOSTID          @Y30LB02 17150003
.*                                                             @Y30LB02 17200003
.FLREG   ANOP                                                  @Y30LB02 17250003
         MVC  6(2,1),0(&FLAGS(1)) REG-FORM PLACE FLAGS IN BLK  @Y30LB02 17300003
.*                                                             @Y30LB02 17350003
.HOSTD   AIF  ('&HOSTID' EQ '').INVOKE      HOSTID SPECIFIED?  @Y30LB02 17400003
         AIF  ('&HOSTID'(1,1) EQ '(').HREG  REGISTER FORM?     @Y30LB02 17450003
         MVC  8(5,1),&HOSTID      ADDRFORM-PUT HOSTID IN BLK   @Y30LB02 17500003
         AGO  .INVOKE                                          @Y30LB02 17550003
.*                                                             @Y30LB02 17600003
.HREG    ANOP                                                  @Y30LB02 17650003
         MVC  8(5,1),0(&HOSTID(1)) REGFORM-PUT HOSTID IN BLK   @Y30LB02 17700003
.INVOKE  ANOP                                                  @Y30LB02 17750003
         SVC  126                 INVOKE THE SVC               @Y30LB02 17800003
.FINISH  MEND                                                  @Y30LB02 17850003
**/                                                                     17900003
*   ICBASDAS: MACRO KEYS(MF,FLAGS,HOSTID);                 /*@Y30LB02*/ 17950003
*/*                                                          @Y30LB02*/ 18000003
*/*                     EXTERNAL DECLARES                    @Y30LB02*/ 18050003
*/*********************************************************  @Y30LB02*/ 18100003
*/*      ASDATEST IS USED TO DETERMINE WHETHER THE STANDARD  @Y30LB02*/ 18150003
*/*      FORM MACRO HAS BEEN INVOKED MORE THAN ONCE BY THE   @Y30LB02*/ 18200003
*/*      SAME CALLER.                                        @Y30LB02*/ 18250003
*/*********************************************************  @Y30LB02*/ 18300003
*/*      ASTESTR1 WILL BE USED TO DETERMINE IF IT IS NECES-  @Y30LB02*/ 18350003
*/*      SARY TO DECLARE R1 OR WHETHER IT IS ALREADY DCLD    @Y30LB02*/ 18400003
*/*********************************************************  @Y30LB02*/ 18450003
*/*                                                          @Y30LB02*/ 18500003
*   DCL  ASTESTR1  FIXED  EXT;    /*REG1 DECLARE COUNTER     @Y30LB02*/ 18550003
*   DCL  ASDATEST  FIXED  EXT;    /*STANDARD INVOC COUNTER   @Y30LB02*/ 18600003
*/*                                                          @Y30LB02*/ 18650003
*/*      INTERNAL DECLARES                                   @Y30LB02*/ 18700003
*   DCL  ASDOP   CHAR;       /*DEFINE ASSOC OPCODE           @Y30LB02*/ 18750003
*   DCL  ASDLEN  CHAR;       /*DECLARE LENGTH OF ORDER       @Y30LB02*/ 18800003
*   DCL  ERSW     FIXED;     /*DECLARE ERROR COND SWITCH     @Y30LB02*/ 18850003
*   DCL  RETCODE  FIXED;     /*DECLARE RETURN CODE AREA      @Y30LB02*/ 18900003
*   DCL  CTR      FIXED;     /*DECLARE CTR FOR LIST FORM     @Y30LB02*/ 18950003
*        ERSW=0;             /*INITIALIZE ERROR SWITCH       @Y30LB02*/ 19000003
*        RETCODE=0;          /*INITIALIZE RETURN CODE        @Y30LB02*/ 19050003
*        ASDLEN='10';        /*INITIALIZE LENGTH             @Y30LB02*/ 19100003
*        ASDOP='2C';         /*INITIALIZE OPCODE             @Y30LB02*/ 19150003
*        CTR=0;              /*INITIALIZE PARM CTR           @Y30LB02*/ 19200003
*/********************************************************   @Y30LB02*/ 19250003
*/*      CHECK FOR VALID MACRO FORM--E INDICATES EXECUTE     @Y30LB02*/ 19300003
*/*      FORM, L INDICATES LIST FORM AND IF THE MF PARA-     @Y30LB02*/ 19350003
*/*      METER IS NULL THE STANDARD FORM MACRO IS INVOKED    @Y30LB02*/ 19400003
*/********************************************************   @Y30LB02*/ 19450003
*        IF ASTESTR1=0 THEN   /*REGISTER ONE DECLARED?       @Y30LB02*/ 19500003
*             DO;             /*NO,DECLARE REGISTER ONE      @Y30LB02*/ 19550003
*                  ANS('DCL ASDAR1 REG(1) PTR;/*PTR'||                  19600003
*                  ' TO REQUEST BLOCK @Y30LB02*/')SKIP;                 19650003
*                  ASTESTR1=ASTESTR1+1; /*INCREM REG CTR     @Y30LB02*/ 19700003
*             END;           /*                              @Y30LB02*/ 19750003
*   IF MF(1) ^= 'L' THEN     /*IS IT LIST FORM?              @Y30LB02*/ 19800003
*        GO TO EFORM;        /*NO, CK FOR EXEC               @Y30LB02*/ 19850003
*   IF MF(2) = '' THEN       /*LIST NAME SPECIFIED?          @Y30LB02*/ 19900003
*        DO;                 /*NO, DO ERROR PROCESSING       @Y30LB02*/ 19950003
*             ERSW=1;        /*SET ERROR SWITCH TO ONE       @Y30LB02*/ 20000003
*             RETCODE=12;    /*SET RETURN CODE TO 12         @Y30LB02*/ 20050003
*             ANS MSG('  ICB602I - A NAME FOR THE REQUEST BLOCK '||     20100003
*             'MUST BE SPECIFIED IN MF(2) ')SKIP;          /*@Y30LB02*/ 20150003
*             GO TO FINISH;  /*BRANCH TO END PROCESSING      @Y30LB02*/ 20200003
*        END;                /*                              @Y30LB02*/ 20250003
*/*                                                          @Y30LB02*/ 20300003
*   IF FLAGS ^= '' THEN      /*IS THE FLAGS AREA NULL        @Y30LB02*/ 20350003
*        CTR=CTR+1;          /*INCREMENT PARAMETER COUNTER   @Y30LB02*/ 20400003
*   IF HOSTID ^= '' THEN     /*IS THE HOSTID AREA NULL       @Y30LB02*/ 20450003
*        CTR=CTR+1;          /*INCREMENT PARAMETER COUNTER   @Y30LB02*/ 20500003
*   IF CTR > 0 THEN          /*INCREMENT CTR > ZERO?         @Y30LB02*/ 20550003
*        DO;                 /*DO ERROR PROCESSING           @Y30LB02*/ 20600003
*           RETCODE=4;     /*SET RETRUN CODE TO 4            @Y30LB02*/ 20650003
*           ANS MSG('  ICB604I - WARNING-ONLY THE MF PARAMETER'||       20700003
*             ' IS VALID FOR LIST FORM')SKIP;              /*@Y30LB02*/ 20750003
*        END;                /*                              @Y30LB02*/ 20800003
*   IF MF(3) ^= '' THEN      /*PLS ATTRIBUTE SPECIFIED?      @Y30LB02*/ 20850003
*        GO TO ATTRLST;      /*BRANCH TO UNINITL LIST FORM   @Y30LB02*/ 20900003
*/*                                                          @Y30LB02*/ 20950003
*             ANS('/*******************************************'||      21000003
*                 '************** @Y30LB02*/')SKIP;                     21050003
*             ANS('/*     MACMEAN  MSSC ASSOCIATE MACRO        '||      21100003
*                 '               @Y30LB02*/')SKIP;                     21150003
*             ANS('/*VS1-4/VS2-3 VERSION--06/09/74 LEVEL 00    '||      21200003
*                 '               @Y30LB02*/')SKIP;                     21250003
*             ANS('/*THIS IS THE INITIALIZED LIST FORM         '||      21300003
*                 '               @Y30LB02*/')SKIP;                     21350003
*             ANS('/*******************************************'||      21400003
*                 '************** @Y30LB02*/')SKIP;                     21450003
*             ANS('DCL 1 '||MF(2)||'  STATIC LOCAL,'||                  21500003
*             ' /*ASSOCIATE REQUEST BLOCK @Y30LB02*/')SKIP;             21550003
*             ANS('    2  ASDALEN  FIXED(31)INIT('||QUOTE               21600003
*             ('10')||'X),/*LENG OF ASSOC REQ BLK @Y30LB02*/')SKIP;     21650003
*             ANS('    2  ASDAOPC CHAR(1)INIT('||QUOTE('2C')||          21700003
*             'X),/*ASSOCIATE OPCODE @Y30LB02*/')SKIP;                  21750003
*             ANS('    2  ASDA001 CHAR(1)INIT('||QUOTE('00')||          21800003
*             'X),/*RESERVED AND ZERO @Y30LB02*/')SKIP;                 21850003
*             ANS('    2  ASDAFLG BIT(16)INIT('||QUOTE                  21900003
*             ('0000000000000000')||'B),/*TWO BYTE ATTRI'||             21950003
*             'BUTE AREA @Y30LB02*/')SKIP;                              22000003
*             ANS('       3  ASASSOC BIT(1),/*ASSOCIATE'||              22050003
*             ' ATTRIBUTE @Y30LB02*/')SKIP;                             22100003
*             ANS('       3  ASDASSOC BIT(1),/*DISASSOCIATE'||          22150003
*             ' ATTRIBUTE @Y30LB02*/')SKIP;                             22200003
*             ANS('       3  *    BIT(3),/*THREE BITS'||                22250003
*             ' RESERVE @Y30LB02*/')SKIP;                               22300003
*             ANS('       3  ASDEINT BIT(1),/*DISASSOC'||               22350003
*             ' AND DEINITIALIZE THE INTERFACE FOR THE'||               22400003
*             ' OTHER CPU SPECIFIED IN THE CPU ASSOCIATE'||             22450003
*             ' TABLE @Y30LB02*/')SKIP;                                 22500003
*             ANS('       3  ASDMNT BIT(1),/*ASSOC'||                   22550003
*             ' CPUS AND DEMOUNT ALL VOLUMES FOR BOTH'||                22600003
*             ' CPUS @Y30LB02*/')SKIP;                                  22650003
*             ANS('       3  *      BIT(9),/*RESERVED AND'||            22700003
*             ' MUST BE ZERO @Y30LB02*/')SKIP;                          22750003
*             ANS('    2  ASDACPU  CHAR(5) INIT('||QUOTE                22800003
*             ('0000000000')||'X),/*HOSTID @Y30LB02*/')SKIP;            22850003
*             ANS('    2  ASDA002  CHAR(3) INIT('||QUOTE                22900003
*             ('000000')||'X);/*RESERVED AREA @Y30LB02*/')SKIP;         22950003
*             GO TO FINISH;                                /*@Y30LB02*/ 23000003
*/*                                                          @Y30LB02*/ 23050003
*ATTRLST:                                                               23100003
*             ANS('/*******************************************'||      23150003
*                 '************** @Y30LB02*/')SKIP;                     23200003
*             ANS('/*      MACMEAN  MSSC ASSOCIATE MACRO       '||      23250003
*                 '               @Y30LB02*/')SKIP;                     23300003
*             ANS('/*VS1-4/VS2-3 VERSION--06/09/74 LEVEL 00    '||      23350003
*                 '               @Y30LB02*/')SKIP;                     23400003
*             ANS('/*THIS IS THE UNINITIALIZED LIST FORM       '||      23450003
*                 '               @Y30LB02*/')SKIP;                     23500003
*             ANS('/*******************************************'||      23550003
*                 '************** @Y30LB02*/')SKIP;                     23600003
*             ANS('DCL 1 '||MF(2)||' '||MF(3)||','||                    23650003
*             ' /*ASSOCIATE REQUEST BLOCK @Y30LB02*/')SKIP;             23700003
*             ANS('    2  ASDALEN  FIXED(31),/*LENG'||                  23750003
*             'TH OF ASSOCIATE REQ BLOCK=10 HEX @Y30LB02*/')SKIP;       23800003
*             ANS('    2  ASDAOPC CHAR(1),'||                           23850003
*             '/*ASSOCIATE OPCODE=2C HEX @Y30LB02*/')SKIP;              23900003
*             ANS('    2  ASDA001 CHAR(1),'||                           23950003
*             ' /*RESERVED AND ZERO @Y30LB02*/')SKIP;                   24000003
*             ANS('    2  ASDAFLG BIT(16),'||                           24050003
*             '/*TWO BYTE ATTRIBUTE AREA @Y30LB02*/')SKIP;              24100003
*             ANS('       3  ASASSOC BIT(1),/*ASSOCIATE'||              24150003
*             ' ATTRIBUTE @Y30LB02*/')SKIP;                             24200003
*             ANS('       3  ASDASSOC BIT(1),/*DISASSOCIATE'||          24250003
*             ' ATTRIBUTE @Y30LB02*/')SKIP;                             24300003
*             ANS('       3  *    BIT(3),/*THREE BITS'||                24350003
*             ' RESERVE @Y30LB02*/')SKIP;                               24400003
*             ANS('       3  ASDEINT BIT(1),/*DISASSOC'||               24450003
*             ' AND DEINITIALIZE THE INTERFACE FOR THE'||               24500003
*             ' OTHER CPU SPECIFIED IN THE CPU ASSOCIATE'||             24550003
*             ' TABLE @Y30LB02*/')SKIP;                                 24600003
*             ANS('       3  ASDMNT BIT(1),/*ASSOC'||                   24650003
*             ' CPUS AND DEMOUNT ALL VOLUMES FOR BOTH'||                24700003
*             ' CPUS @Y30LB02*/')SKIP;                                  24750003
*             ANS('       3  *      BIT(9),/*RESERVED AND'||            24800003
*             ' MUST BE ZERO @Y30LB02*/')SKIP;                          24850003
*             ANS('    2  ASDACPU  CHAR(5),/*HOSTID @Y30LB02*/')SKIP;   24900003
*             ANS('    2  ASDA002  CHAR(3);/*RESERVED'||                24950003
*             ' AREA @Y30LB02*/')SKIP;                                  25000003
*             GO TO FINISH;                                /*@Y30LB02*/ 25050003
*/*                                                          @Y30LB02*/ 25100003
*/*      PROCESSING THE EXECUTE MACRO FORM                   @Y30LB02*/ 25150003
*/*                                                          @Y30LB02*/ 25200003
*EFORM:                                                                 25250003
*   IF MF(1) ^= 'E' THEN     /*EXCUTE FORM                   @Y30LB02*/ 25300003
*        GO TO SFORM;        /*NO, CK FOR STANDARD           @Y30LB02*/ 25350003
*   IF MF(2) = '' THEN       /*YES,LIST NAME SPECD?          @Y30LB02*/ 25400003
*        DO;                 /*DO ERROR PROCESSING           @Y30LB02*/ 25450003
*             ERSW=1;        /*SET ERROR SWITCH TO ONE       @Y30LB02*/ 25500003
*             RETCODE=12;    /*SET ERROR RETURN CODE TO 12   @Y30LB02*/ 25550003
*             ANS MSG('  ICB612I - MF(2) MUST CONTAIN'||                25600003
*                ' REQ BLK NAME IF EXEC '||                             25650003
*                ' MACRO FORM REQUESTED')SKIP;             /*@Y30LB02*/ 25700003
*             GO TO CKSW;    /*BRCH TO CK ERROR CONDITION    @Y30LB02*/ 25750003
*        END;                /*                              @Y30LB02*/ 25800003
*/*                                                          @Y30LB02*/ 25850003
*   ELSE                     /*EXECUTE FORM PROCESSING       @Y30LB02*/ 25900003
*/*                                                          @Y30LB02*/ 25950003
*        ANS('/*******************************************'||           26000003
*            '************* @Y30LB02*/')SKIP;                           26050003
*        ANS('/*     MACMEAN  MSSC ASSOCIATE MACRO        '||           26100003
*            '              @Y30LB02*/')SKIP;                           26150003
*        ANS('/*VS1-4/VS2-3 VERSION-- 06/09/74 LEVEL 00   '||           26200003
*            '              @Y30LB02*/')SKIP;                           26250003
*        ANS('/*THIS IS THE OUTPUT FOR THE EXECUTE FORM.  '||           26300003
*            '              @Y30LB02*/')SKIP;                           26350003
*        ANS('/*THE LIST FORM OF THIS MACRO SHOULD BE     '||           26400003
*            '              @Y30LB02*/')SKIP;                           26450003
*        ANS('/*INVOKED FIRST IN ORDER TO SET UP NECESSARY'||           26500003
*            '              @Y30LB02*/')SKIP;                           26550003
*        ANS('/*DECLARES.  IF THE COMPLETE ARGUMENT IS    '||           26600003
*            '              @Y30LB02*/')SKIP;                           26650003
*        ANS('/*SPECIFIED THE REQ BLOCK WILL BE ZEROED.   '||           26700003
*            '              @Y30LB02*/')SKIP;                           26750003
*        ANS('/*******************************************'||           26800003
*            '************* @Y30LB02*/')SKIP;                           26850003
*        ANS('RFY(ASDAR1)RSTD;/*RESTRICT REG 1 @Y30LB02*/')SKIP;        26900003
*        ANS('ASDAR1=ADDR('||MF(2)||');/*R1 POINTER TO'||               26950003
*        ' REQUEST BLOCK @Y30LB02*/')SKIP;                              27000003
*   IF MF(3) = 'COMPLETE' THEN   /*COMPLETE SPECIFIED        @Y30LB02*/ 27050003
*     DO;                        /*ZERO REQ BLOCK            @Y30LB02*/ 27100003
*        ANS(' '||MF(2)||'='||MF(2)||'&&'||MF(2)||';'||    /*@Y30LB02*/ 27150003
*        '/*ZERO BLOCK @Y30LB02*/')SKIP;                                27200003
*     END;                       /*                          @Y30LB02*/ 27250003
*        ANS('ASDALEN= '||QUOTE(ASDLEN)||'X;/* '||                      27300003
*        'LENGTH OF ASSOC REQUEST @Y30LB02*/')SKIP;                     27350003
*        ANS('ASDAOPC= '||QUOTE(ASDOP)||'X;/*ASSOCIATE'||               27400003
*        ' OPCODE @Y30LB02*/')SKIP;                                     27450003
*/*                                                          @Y30LB02*/ 27500003
*CKSW:                                                                  27550003
*   IF ERSW=1 THEN             /*ERROR SWITCH EQ ONE?        @Y30LB02*/ 27600003
*        GO TO FINISH;         /*YES,BRANCH TO END           @Y30LB02*/ 27650003
*   ELSE                       /*NO,CK PARAMETERS            @Y30LB02*/ 27700003
*        GO TO COMPROC;        /*BRANCH TO CK PARAMETERS     @Y30LB02*/ 27750003
*/*                                                          @Y30LB02*/ 27800003
*SFORM:                                                                 27850003
*   IF MF(1) ^= '' THEN        /*STANDARD FORM               @Y30LB02*/ 27900003
*     DO;                      /*NO,DO ERROR PROCESSING      @Y30LB02*/ 27950003
*        ERSW=1;               /*SET ERROR SWITCH TO ONE     @Y30LB02*/ 28000003
*        RETCODE=12;           /*SET RETURN CODE TO 12       @Y30LB02*/ 28050003
*        ANS MSG('  ICB615I - INVALID MF PARAMETER '||                  28100003
*                'SPECIFIED, MUST BE L, E, OR NULL')SKIP;  /*@Y30LB02*/ 28150003
*        GO TO CKSW2;          /*BRANCH TO CK ERROR SWITCH   @Y30LB02*/ 28200003
*     END;                                                 /*@Y30LB02*/ 28250003
*/*                                                          @Y30LB02*/ 28300003
*   IF FLAGS = '' THEN         /*FLAGS SPECIFIED?            @Y30LB02*/ 28350003
*     DO;                      /*NO,DO ERROR PROCESSING      @Y30LB02*/ 28400003
*        ERSW=1;               /*SET ERROR SWITCH TO 1       @Y30LB02*/ 28450003
*        RETCODE=12;           /*SET RETURN CODE TO 12       @Y30LB02*/ 28500003
*        ANS MSG('  ICB607I - FLAGS MUST BE SPECIFIED  '||              28550003
*        'FOR STANDARD FORM MACRO')SKIP;                   /*@Y30LB02*/ 28600003
*        GO TO CKSW2;          /*BRANCH TO CK SWITCH         @Y30LB02*/ 28650003
*     END;                     /*                            @Y30LB02*/ 28700003
*   IF HOSTID = '' THEN        /*HOSTID SPECIFIED?           @Y30LB02*/ 28750003
*     DO;                      /*DO ERROR PROCESSING         @Y30LB02*/ 28800003
*        ERSW=1;               /*SET ERROR CODE TO ONE       @Y30LB02*/ 28850003
*        RETCODE=12;           /*SET RETURN CODE TO 12       @Y30LB02*/ 28900003
*        ANS MSG('  ICB608I - HOSTID MUST BE SPECIFIED  '||             28950003
*        'FOR STANDARD FORM MACRO')SKIP;                   /*@Y30LB02*/ 29000003
*     END;                     /*                            @Y30LB02*/ 29050003
*/*                                                          @Y30LB02*/ 29100003
*CKSW2:                                                                 29150003
*/*                                                          @Y30LB02*/ 29200003
*   IF ERSW = 1 THEN           /*ERROR SWITCH EQUAL 1?       @Y30LB02*/ 29250003
*        GO TO FINISH;         /*YES,BRANCH TO END           @Y30LB02*/ 29300003
*/*                                                          @Y30LB02*/ 29350003
*   IF ASDATEST = 1 THEN       /*FIRST STANDARD FORM?        @Y30LB02*/ 29400003
*     DO;                      /*NO,PUT OUT NO DCLS          @Y30LB02*/ 29450003
*        ANS('/*******************************************'||           29500003
*            '************** @Y30LB02*/')SKIP;                          29550003
*        ANS('/*     MACMEAN  MSSC ASSOCIATE MACRO        '||           29600003
*            '               @Y30LB02*/')SKIP;                          29650003
*        ANS('/*VS1-4/VS2-3 VERSION--06/09/74 LEVEL 00    '||           29700003
*            '               @Y30LB02*/')SKIP;                          29750003
*        ANS('/*THIS IS THE OUTPUT FOR A SECONDARY        '||           29800003
*            '               @Y30LB02*/')SKIP;                          29850003
*        ANS('/*INVOCATION OF THE STANDARD FORM MACRO     '||           29900003
*            '               @Y30LB02*/')SKIP;                          29950003
*        ANS('/*******************************************'||           30000003
*            '************** @Y30LB02*/')SKIP;                          30050003
*        ANS('RFY(ASDAR1)RSTD;/*RESTRICT REG 1 @Y30LB02*/')SKIP;        30100003
*        ANS('ASDAR1=ADDR(ASDALEN);/*R1 PTR TO BLK @Y30LB02*/')SKIP;    30150003
*        ANS('ASDALEN= '||QUOTE(ASDLEN)||'X;/* '||                      30200003
*        'LENGTH OF ASSOC REQUEST @Y30LB02*/')SKIP;                     30250003
*        ANS('ASDAOPC='||QUOTE(ASDOP)||'X;/*ASSOC'||                    30300003
*        ' OPCODE @Y30LB02*/')SKIP;                                     30350003
*        GO TO COMPROC;      /*BRANCH TO CK PARAMETERS       @Y30LB02*/ 30400003
*     END;                   /*                              @Y30LB02*/ 30450003
*/*                                                          @Y30LB02*/ 30500003
*   ELSE                     /*PUT OUT THE DECLARES          @Y30LB02*/ 30550003
*     DO;                    /*STANDARD FIRST TIME           @Y30LB02*/ 30600003
*        ANS('/*******************************************'||           30650003
*            '************** @Y30LB02*/')SKIP;                          30700003
*        ANS('/*    MACMEAN  MSSC ASSOCIATE MACRO         '||           30750003
*            '               @Y30LB02*/')SKIP;                          30800003
*        ANS('/*VS1-4/VS2-3 VERSION--06/09/74 LEVEL 00    '||           30850003
*            '               @Y30LB02*/')SKIP;                          30900003
*        ANS('/*THIS IS THE STANDARD FORM  MACRO          '||           30950003
*            '               @Y30LB02*/')SKIP;                          31000003
*        ANS('/*******************************************'||           31050003
*            '************** @Y30LB02*/')SKIP;                          31100003
*        ANS('RFY(ASDAR1)RSTD;/*RESTRICT REG 1 @Y30LB02*/')SKIP;        31150003
*        ANS('ASDAR1=ADDR(ASDALEN);/*R1 PTR  '||                        31200003
*        'TO REQUEST BLOCK @Y30LB02*/')SKIP;                            31250003
*        ANS('DCL 1 ASDALST  STATIC LOCAL,'||                           31300003
*        ' /*ASSOCIATE REQUEST BLOCK @Y30LB02*/')SKIP;                  31350003
*        ANS('    2  ASDALEN  FIXED(31)INIT('||QUOTE                    31400003
*        ('10')||'X),/*LENG OF ASSOC REQ BLK @Y30LB02*/')SKIP;          31450003
*        ANS('    2  ASDAOPC CHAR(1)INIT('||QUOTE('2C')||               31500003
*        'X),/*ASSOCIATE OPCODE @Y30LB02*/')SKIP;                       31550003
*        ANS('    2  *      CHAR(1)INIT('||QUOTE('00')||                31600003
*        'X),/*RESERVED AND ZERO @Y30LB02*/')SKIP;                      31650003
*        ANS('    2  ASDAFLG BIT(16)INIT('||QUOTE                       31700003
*        ('0000000000000000')||'B),/*TWO BYTE ATTRI'||                  31750003
*        'BUTE AREA @Y30LB02*/')SKIP;                                   31800003
*        ANS('       3  ASASSOC BIT(1),/*ASSOCIATE'||                   31850003
*        ' ATTRIBUTE @Y30LB02*/')SKIP;                                  31900003
*        ANS('       3  ASDASSOC BIT(1),/*DISASSOCIATE'||               31950003
*        ' ATTRIBUTE @Y30LB02*/')SKIP;                                  32000003
*        ANS('       3  *     BIT(1),/*THREE BITS'||                    32050003
*        ' RESERVE @Y30LB02*/')SKIP;                                    32100003
*        ANS('       3  ASDEINT BIT(1),/*DISASSOC'||                    32150003
*        ' AND DEINITIALIZE THE INTERFACE FOR THE'||                    32200003
*        ' OTHER CPU SPECIFIED IN THE CPU ASSOCIATE'||                  32250003
*        ' TABLE @Y30LB02*/')SKIP;                                      32300003
*        ANS('       3  ASDMNT BIT(1),/*ASSOC'||                        32350003
*        ' CPUS AND DEMOUNT ALL VOLUMES FOR BOTH'||                     32400003
*        ' CPUS @Y30LB02*/')SKIP;                                       32450003
*        ANS('       3  *      BIT(9),/*RESERVED AND'||                 32500003
*        ' MUST BE ZERO @Y30LB02*/')SKIP;                               32550003
*        ANS('    2  ASDACPU  CHAR(5) INIT('||QUOTE                     32600003
*        ('0000000000')||'X),/*HOSTID @Y30LB02*/')SKIP;                 32650003
*        ANS('    2  ASDA002  CHAR(3) INIT('||QUOTE                     32700003
*        ('000000')||'X);/*RESERVED AREA @Y30LB02*/')SKIP;              32750003
*        ASDATEST=ASDATEST+1; /*INCREM STD FORM CTR          @Y30LB02*/ 32800003
*        GO TO COMPROC;       /*BRANCH,CK PARAMETERS         @Y30LB02*/ 32850003
*     END;                    /*                             @Y30LB02*/ 32900003
*/*                                                          @Y30LB02*/ 32950003
*/*********************************************************  @Y30LB02*/ 33000003
*/*      COMMON PROCESSING FOR EXECUTE AND STANDARD FORMS    @Y30LB02*/ 33050003
*/*      THE FOLLOWING CODE WILL CHECK TO DETERMINE WHICH    @Y30LB02*/ 33100003
*/*      PARAMETERS ARE SPECIFIED AND PLACE THE VALUE IN     @Y30LB02*/ 33150003
*/*      THE REQUEST BLOCK                                   @Y30LB02*/ 33200003
*/*********************************************************  @Y30LB02*/ 33250003
*COMPROC:                                                               33300003
*   IF FLAGS ^= '' THEN      /*FLAGS SPECIFIED?              @Y30LB02*/ 33350003
*        ANS('ASDAFLG= '||FLAGS||';/*VALUE OF FLAGS '||                 33400003
*        'PARAMETER @Y30LB02*/')SKIP;                                   33450003
*/*                                                          @Y30LB02*/ 33500003
*   IF HOSTID ^= '' THEN    /*HOSTID SPECIFIED?              @Y30LB02*/ 33550003
*        ANS('ASDACPU= '||HOSTID||';/*HOSTID @Y30LB02*/')SKIP;          33600003
*/*                                                          @Y30LB02*/ 33650003
*/********************************************************   @Y30LB02*/ 33700003
*/*      THIS SECTION OF CODE WILL INVOKE SVC 126 AND        @Y30LB02*/ 33750003
*/*      SET THE PROPER RETURN CODE, THEN END PROCESSING     @Y30LB02*/ 33800003
*/********************************************************   @Y30LB02*/ 33850003
*/********************************************************   @Y30LB02*/ 33900003
*        ANS('SVC (126);/*INVOKE THE SVC  @Y30LB02*/')SKIP;             33950003
*        ANS('RFY  ASDAR1 UNRSTD;/*UNRESTRICT REG 1 @Y30LB02*/')SKIP;   34000003
*/*                                                          @Y30LB02*/ 34050003
*FINISH:                                                                34100003
*        RETURN CODE(RETCODE);                             /*@Y30LB02*/ 34150003
*        %END;                                             /*@Y30LB02*/ 34200003
