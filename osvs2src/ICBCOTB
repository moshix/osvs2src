* %/* START OF SPECIFICATIONS  ***                             @Y30LB02 00050003
.*                                                             @Y30LB02 00100003
.*01  MODULE-NAME = ICBCOTB                                    @Y30LB02 00150003
.*                                                             @Y30LB02 00200003
.*01  DESCRIPTIVE-NAME = COPY TABLES                           @Y30LB02 00250003
.*                                                             @Y30LB02 00300003
.*01  COPYRIGHT = NONE                                         @Y30LB02 00350003
.*                                                             @Y30LB02 00400003
.*01  STATUS = OS/VS1 RELEASE 4.0,                             @Y30LB02 00450003
.*             OS/VS2 RELEASE 3.0                              @Y30LB02 00500003
.*                                                             @Y30LB02 00550003
.*01  FUNCTION = BUILDS A REQUEST BLOCK FOR A COPY             @Y30LB02 00600003
.*               TABLES REQUEST.  THE MACRO IS A               @Y30LB02 00650003
.*               COMMUNICATION LINK BETWEEN THE CALLER         @Y30LB02 00700003
.*               AND THE MSSC SVC MODULE.                      @Y30LB02 00750003
.*                                                             @Y30LB02 00800003
.*01  NOTES = ICBCOTB IS A BILINGUAL MACRO.                    @Y30LB02 00850003
.*                                                             @Y30LB02 00900003
.*02    DEPENDENCIES = NONE                                    @Y30LB02 00950003
.*                                                             @Y30LB02 01000003
.*02    RESTRICTIONS = THE PREFIXES ICB AND COTB SHOULD        @Y30LB02 01050003
.*                     BE AVOIDED WHEN INVOKING THIS MACRO.    @Y30LB02 01100003
.*                                                             @Y30LB02 01150003
.*02    REGISTER-CONVENTIONS = FOLLOWS NORMAL USE OF           @Y30LB02 01200003
.*                             REGISTERS BY MACROS:            @Y30LB02 01250003
.*                             R0,R1,R14, AND R15.             @Y30LB02 01300003
.*                                                             @Y30LB02 01350003
.*01  MODULE-TYPE = MACRO                                      @Y30LB02 01400003
.*                                                             @Y30LB02 01450003
.*02    PROCESSOR = PLS2 AND ASSEM                             @Y30LB02 01500003
.*                                                             @Y30LB02 01550003
.*01  INPUT = PARAMETERS SPECIFIED ON THE PLS/BAL MACRO        @Y30LB02 01600003
.*            INVOCATION.                                      @Y30LB02 01650003
.*                                                             @Y30LB02 01700003
.*                                                             @Y30LB02 01750003
.*   THE COPY TABLES REQUEST IS ISSUED BY A HOST CALLER        @Y30LB02 01800003
.*   WHEN HE DESIRES TO HAVE THE MSC'S TABLES ON DASD          @Y30LB02 01850003
.*   MOVED TO THE VIRTUAL VOLUME SPECIFIED BY VOLID            @Y30LB02 01900003
.*   SPECIFIED BY VOLID AT THE LOCATION GIVEN                  @Y30LB02 01950003
.*   BY EXTS.                                                  @Y30LB02 02000003
.*                                                             @Y30LB02 02050003
.*   MACRO SYNTAX                                              @Y30LB02 02100003
.*                                                             @Y30LB02 02150003
.*   LIST FORM                                                 @Y30LB02 02200003
.*                                                             @Y30LB02 02250003
.* VERB    REQUIRED PARMS        OPTIONAL PARMS                @Y30LB02 02300003
.*                                                             @Y30LB02 02350003
.*ICBCOTB  MF=L - (BAL)          MF=(L,MAP) - BAL              @Y30LB02 02400003
.*         MF(L,NAME/(R))-PLS    MF(L,NAME/(R),ATTR)-PLS       @Y30LB02 02450003
.*                                                             @Y30LB02 02500003
.*   STANDARD FORM                                             @Y30LB02 02550003
.*                                                             @Y30LB02 02600003
.* VERB    REQUIRED PARMS        OPTIONAL PARMS                @Y30LB02 02650003
.*                                                             @Y30LB02 02700003
.*ICBCOTB  VOLID=ADDR/(R)              NONE                    @Y30LB02 02750003
.*         ECB=ADDR/(R)                                        @Y30LB02 02800003
.*         EXTS=ADDR/(R)                                       @Y30LB02 02850003
.*         FLAGS=ADDR/(R)                                      @Y30LB02 02900003
.*                                                             @Y30LB02 02950003
.* EXECUTE FORM                                                @Y30LB02 03000003
.*                                                             @Y30LB02 03050003
.* VERB    REQUIRED PARMS        OPTIONAL PARMS                @Y30LB02 03100003
.*                                                             @Y30LB02 03150003
.*ICBCOTB  MF(E,NAME/(R))       MF(E,NAME/(R),COMPLETE)-PLS    @Y30LB02 03200003
.*                              VOLID=ADDR/(R)                 @Y30LB02 03250003
.*                              ECB=ADDR/(R)                   @Y30LB02 03300003
.*                              EXTS=ADDR/(R)                  @Y30LB02 03350003
.*                              FLAGS=ADDR/(R)                 @Y30LB02 03400003
.*                                                             @Y30LB02 03450003
.*                                                             @Y30LB02 03500003
.*   KEYWORD PARAMETERS:                                       @Y30LB02 03550003
.*                                                             @Y30LB02 03600003
.*   MF  -  MACRO FORMAT: THIS PARAMETER DESCRIBES THE         @Y30LB02 03650003
.*          MACRO FORMAT AND MAY GIVE THE ADDRESS OR           @Y30LB02 03700003
.*          ADDRESS IN A REGISTER WHERE THE REQUEST BLOCK      @Y30LB02 03750003
.*          IS STORED.                                         @Y30LB02 03800003
.*                                                             @Y30LB02 03850003
.*          L - LIST FORM: THE EXPANSION OF THE L-FORM         @Y30LB02 03900003
.*              MACRO WILL RESULT IN A REQUEST BLOCK WITH      @Y30LB02 03950003
.*              THE ONLY NON-ZERO FIELDS BEING THE OPCODE      @Y30LB02 04000003
.*              AND LENGTH FIELDS.                             @Y30LB02 04050003
.*                                                             @Y30LB02 04100003
.*          (1) 'MAP' - IF MAP IS SPECIFIED WITH THE           @Y30LB02 04150003
.*              ASSEMBLER MACRO CALL A DSECT EQUIVALENT TO     @Y30LB02 04200003
.*              A MAPPING MACRO IS PRODUCED.                   @Y30LB02 04250003
.*                                                             @Y30LB02 04300003
.*          (2) NAME - THE MACRO INVOKER MUST SPECIFY A        @Y30LB02 04350003
.*              NAME FOR HIS STRUCTURE WHEN INVOKING THE       @Y30LB02 04400003
.*              PLS LIST FORM.                                 @Y30LB02 04450003
.*                                                             @Y30LB02 04500003
.*          (3) ATTRIBUTE - THE MACRO WILL PLACE ANY PLS       @Y30LB02 04550003
.*              ATTRIBUTE SPECIFIED IN THE MACRO INVOCATION    @Y30LB02 04600003
.*              IN AN UNINITIALIZED REQUEST BLOCK.  ATTRI-     @Y30LB02 04650003
.*              BUTE EXAMPLE:                                  @Y30LB02 04700003
.*                                                             @Y30LB02 04750003
.*              CHAR, FIXED, STATIC LOCAL, NONLOCAL,           @Y30LB02 04800003
.*              BASED(*), ETC.                                 @Y30LB02 04850003
.*                                                             @Y30LB02 04900003
.*       NULL - STANDARD FORM: THE EXPANSION OF THIS FORM      @Y30LB02 04950003
.*              CONSISTS OF A REQUEST BLOCK, A LINKAGE         @Y30LB02 05000003
.*              INSTRUCTION, AND, POSSIBLY, PARAMETER          @Y30LB02 05050003
.*              BINDING INSTRUCTIONS.                          @Y30LB02 05100003
.*                                                             @Y30LB02 05150003
.*          E - EXECUTABLE FORM: THE EXPANSION OF THIS FORM    @Y30LB02 05200003
.*              CONSISTS OF A LINKAGE INSTRUCTION AND          @Y30LB02 05250003
.*              POSSIBLY, PARAMETER BINDING INSTRUCTIONS.      @Y30LB02 05300003
.*                                                             @Y30LB02 05350003
.*              SUB-PARAMETERS                                 @Y30LB02 05400003
.*                                                             @Y30LB02 05450003
.*              (1)  AN E MUST BE SPECIFIED IN THE FIRST       @Y30LB02 05500003
.*                   SUB-PARAMETER POSITION.  THIS INDICATES   @Y30LB02 05550003
.*                   THAT THE MACRO IS IN EXECUTABLE FORM.     @Y30LB02 05600003
.*                                                             @Y30LB02 05650003
.*              (2)  A NAME OR A REGISTER MUST BE SPECIFIED    @Y30LB02 05700003
.*                   IN THE SECOND SUB-PARAMETER.              @Y30LB02 05750003
.*                                                             @Y30LB02 05800003
.*              (3)  'COMPLETE' - COMPLETE WILL CAUSE THE      @Y30LB02 05850003
.*                   MACRO TO ZERO OUT THE REQUEST BLOCK.      @Y30LB02 05900003
.*                   AFTER ZEROING THE REQUEST BLOCK THE       @Y30LB02 05950003
.*                   FUNCTION OPCODE AND LENGTH ARE PLACED     @Y30LB02 06000003
.*                   IN THE REQUEST BLOCK.                     @Y30LB02 06050003
.*                                                             @Y30LB02 06100003
.*                                                             @Y30LB02 06150003
.*   FLAGS--FLAGS:  THE 2 BYTE FIELD WHICH INDICATES THE       @Y30LB02 06200003
.*   TABLE TO BE COPIED.  THE FORMAT OF THE 'FLAGS' FIELD      @Y30LB02 06250003
.*   IS SHOWN BELOW:                                           @Y30LB02 06300003
.*                                                             @Y30LB02 06350003
.*     BITS 0-7                                                @Y30LB02 06400003
.*     ____________________________                            @Y30LB02 06450003
.*     | X |X |X | X| 0| 0 |0 | 0|                             @Y30LB02 06500003
.*     ----------------------------                            @Y30LB02 06550003
.*                                                             @Y30LB02 06600003
.*                                                             @Y30LB02 06650003
.*  BIT SPECIFICATIONS FOR BITS 0-7                            @Y30LB02 06700003
.*                                                             @Y30LB02 06750003
.*  BITS 0-3------------MAY BE SET TO 8                        @Y30LB02 06800003
.*                                                             @Y30LB02 06850003
.*  BITS 4-7------------UNUSED AND MUST BE SET TO ZERO         @Y30LB02 06900003
.*                                                             @Y30LB02 06950003
.*   IF BITS 0-3 OF THE FLAGS FIELD IS SET TO EIGHT, THE       @Y30LB02 07000003
.*   FOLLOWING TABLES WILL BE COPIED                           @Y30LB02 07050003
.*                                                             @Y30LB02 07100003
.*   TABLE ID  TABLE                                           @Y30LB02 07150003
.*                                                             @Y30LB02 07200003
.*       1     STAGING DRIVE                                   @Y30LB02 07250003
.*       2     MOUNTED VOLUME                                  @Y30LB02 07300003
.*       3     SCRATCH CARTRIDGE                               @Y30LB02 07350003
.*       4     VOLUME INVENTORY                                @Y30LB02 07400003
.*       5     TRANSIENT VOLUME                                @Y30LB02 07450003
.*       6     VDA/VOLID CROSS REFERENCE                       @Y30LB02 07500003
.*       7     CONFIGURATION                                   @Y30LB02 07550003
.*       9     CELL MAP                                        @Y30LB02 07600003
.*       A     VDA                                             @Y30LB02 07650003
.*       B     JOURNAL                                         @Y30LB02 07700003
.*       C     SCHEDULE QUEUE                                  @Y30LB02 07750003
.*       D     DIAGNOSTIC,EC AND OVERLAY                       @Y30LB02 07800003
.*                                                             @Y30LB02 07850003
.*   BITS 8-15 OF THE FLAGS FIELD WILL BE USED TO COPY THE     @Y30LB02 07900003
.*   TRACE TABLE IN ITS ENTIRETY OR SPECIFIC VARIATIONS        @Y30LB02 07950003
.*   THEREOF.                                                  @Y30LB02 08000003
.*                                                             @Y30LB02 08050003
.*    BITS 8-15                                                @Y30LB02 08100003
.*     ____________________________                            @Y30LB02 08150003
.*     | X |X |X | X| 0| 0 |0 | 0|                             @Y30LB02 08200003
.*     ____________________________                            @Y30LB02 08250003
.*                                                             @Y30LB02 08300003
.*                                                             @Y30LB02 08350003
.*                                                             @Y30LB02 08400003
.*   *BIT 8--------------'1'B  COPY TRACE X                    @Y30LB02 08450003
.*                       '0'B  NO FUNCTION REQUESTED           @Y30LB02 08500003
.*                                                             @Y30LB02 08550003
.*   *BIT 9--------------'1'B  COPY TRACE Y                    @Y30LB02 08600003
.*                       '0'B  NO FUNCTION REQUESTED           @Y30LB02 08650003
.*                                                             @Y30LB02 08700003
.*     *NOTE:  IF BOTH BITS(8 AND 9) ARE SET TO 1,             @Y30LB02 08750003
.*         THE ENTIRE TRACE TABLE WILL BE COPIED.              @Y30LB02 08800003
.*         (TRACE X AND TRACE Y)                               @Y30LB02 08850003
.*                                                             @Y30LB02 08900003
.*   BIT 10--------------'1'B  COPY ACTIVE TRACE               @Y30LB02 08950003
.*                       '0'B  NO FUNCTION REQUESTED           @Y30LB02 09000003
.*                                                             @Y30LB02 09050003
.*   BIT 11--------------'1'B  COPY INACTIVE TRACE             @Y30LB02 09100003
.*                       '0'B   NO FUNCTION REQUESTED          @Y30LB02 09150003
.*                                                             @Y30LB02 09200003
.*   BITS 12-15----------UNUSED AND MUST BE SET TO ZERO        @Y30LB02 09250003
.*                                                             @Y30LB02 09300003
.*       **********            **********                      @Y30LB02 09350003
.*                                                             @Y30LB02 09400003
.*   NOTE 1: BITS 0-7 AND BITS 8-15 ARE MUTUALLY EXCLUSIVE.    @Y30LB02 09450003
.*       IF THE TABLE ID IS SPECIFIED IN BITS 0-7,             @Y30LB02 09500003
.*       THEN BITS 8-15 MUST BE SET TO ZERO.                   @Y30LB02 09550003
.*                                                             @Y30LB02 09600003
.*   NOTE 2: BITS 8 AND 9 MAY BOTH BE SPECIFIED AT             @Y30LB02 09650003
.*       THE SAME TIME, HOWEVER, NEITHER BIT                   @Y30LB02 09700003
.*       8 OR 9 CAN BE USED IN CONJUNCTION                     @Y30LB02 09750003
.*       WITH EITHER BIT 10 OR 11.                             @Y30LB02 09800003
.*                                                             @Y30LB02 09850003
.*   NOTE 3: BITS 10 AND 11 ARE MUTUALLY EXCLUSIVE.            @Y30LB02 09900003
.*                                                             @Y30LB02 09950003
.*   NOTE 4: THE MSC WILL BE RESPONSIBLE FOR RETURN OF         @Y30LB02 10000003
.*           A MESSAGE TO THE MESSAGE BUFFER.  THIS            @Y30LB02 10050003
.*           MESSAGE WILL GIVE THE 'START' AND 'END' CHR'S     @Y30LB02 10100003
.*           FOR THE TABLE THAT WAS COPIED.  THE CHRS WILL     @Y30LB02 10150003
.*           BE THE ADDRESS OF THE TABLE ON THE TARGET         @Y30LB02 10200003
.*           VIRTUAL VOLUME.  THE MSC WILL ALSO RETURN THE     @Y30LB02 10250003
.*           THE ORIGINAL 'START' CHR OF THE TABLE BEFORE      @Y30LB02 10300003
.*           IT WAS COPIED.  IF A TRACE TABLE WAS COPIED,      @Y30LB02 10350003
.*           THE MSC WILL ALSO RETURN THE 'CURRENT' CHR        @Y30LB02 10400003
.*           VALUE FOR THE TRACE TABLE; THIS CHR WILL BE       @Y30LB02 10450003
.*           THE ORIGINAL CHR BEFORE THE TRACE TABLE WAS       @Y30LB02 10500003
.*           COPIED.                                           @Y30LB02 10550003
.*                                                             @Y30LB02 10600003
.*   NOTE 5: THE MSC WILL RETURN CHRS FOR BOTH TRACE AREAS     @Y30LB02 10650003
.*           WHEN BOTH TRACE AREAS ARE COPIED.                 @Y30LB02 10700003
.*                                                             @Y30LB02 10750003
.*  VOLID -- VOLUME IDENTIFIER:  THE VOLUME IDENTIFIER OF      @Y30LB02 10800003
.*           THE VOLUME TO WHICH THE TABLES ARE TO BE          @Y30LB02 10850003
.*           COPIED.  THIS VOLUME MUST BE MOUNTED.             @Y30LB02 10900003
.*                                                             @Y30LB02 10950003
.*  ECB ---- EVENT CONTROL BLOCK:  ADDRESS OF AN EVENT         @Y30LB02 11000003
.*           CONTROL BLOCK.  THIS PARAMETER IS PROVIDED SINCE  @Y30LB02 11050003
.*           A DELAYED RESPONSE IS ALWAYS GIVEN FOR A COPY     @Y30LB02 11100003
.*           TABLES REQUEST.  THE ECB WILL BE POSTED WITH      @Y30LB02 11150003
.*           ONE OF THE FOLLOWING POST CODES: 70, 71, 72, 73,  @Y30LB02 11200003
.*           74, ETC.. THE POST CODE WILL BE PLACED IN THE     @Y30LB02 11250003
.*           LOW-ORDER BYTE OF THE ECB - '7F'X INDICATES       @Y30LB02 11300003
.*           SUCCESSFUL COMPLETION.  THE ECB AREA MUST BE      @Y30LB02 11350003
.*           CLEARED(SET TO BINARY 0) BEFORE INVOKING          @Y30LB02 11400003
.*           THE MACRO.                                        @Y30LB02 11450003
.*                                                             @Y30LB02 11500003
.*  EXTS --- EXTENTS:  A FOUR BYTE AREA WHICH CONTAINS         @Y30LB02 11550003
.*           THE BEGINNING CYLINDER (2 BYTES) AND ENDING       @Y30LB02 11600003
.*           CYLINDER (2 BYTES) OF THE EXTENT OF THE VIRTUAL   @Y30LB02 11650003
.*           VOLUME TO WHICH THE TABLES ARE TO BE COPIED.      @Y30LB02 11700003
.*           THE EXTENTS PARAMETER MUST SPECIFY SUFFICIENT     @Y30LB02 11750003
.*           CONTIGUOUS CYLINDERS TO ACCOMMODATE THE           @Y30LB02 11800003
.*           TABLE(S) TO BE COPIED AS THEY ARE MAPPED IN THE   @Y30LB02 11850003
.*           PAGES OF THE MSC TABLES.                          @Y30LB02 11900003
.*                                                             @Y30LB02 11950003
.*                                                             @Y30LB02 12000003
.*01  EXIT-NORMAL = VALID INVOCATION                           @Y30LB02 12050003
.*                                                             @Y30LB02 12100003
.*02    CONDITION = RETURN CODE = 0.                           @Y30LB02 12150003
.*                                                             @Y30LB02 12200003
.*02    OUTPUT = IN-LINE PLS/BAL STATEMENTS THAT PERFORM       @Y30LB02 12250003
.*               THE REQUESTED FUNCTION.                       @Y30LB02 12300003
.*                                                             @Y30LB02 12350003
.*01  EXIT-ERROR = INVALID INVOCATION                          @Y30LB02 12400003
.*                                                             @Y30LB02 12450003
.*02    CONDITION = RETURN CODE = 12.                          @Y30LB02 12500003
.*                                                             @Y30LB02 12550003
.*02    OUTPUT = ERROR MESSAGE                                 @Y30LB02 12600003
.*                                                             @Y30LB02 12650003
.*01  EXTERNAL-REFERENCES = NONE                               @Y30LB02 12700003
.*                                                             @Y30LB02 12750003
.*01  TABLES = NONE                                            @Y30LB02 12800003
.*                                                             @Y30LB02 12850003
.*01 MESAGES = AS FOLLOWS:                                     @Y30LB02 12900003
.*                                                             @Y30LB02 12950003
.*                                                             @Y30LB02 13000003
.*           ICB602I: A NAME FOR THE REQUEST BLOCK MUST        @Y30LB02 13050003
.*                    BE SPECIFIED IN MF(2)                    @Y30LB02 13100003
.*           ICB604I: WARNING-ONLY THE MF PARAMETER IS         @Y30LB02 13150003
.*                    VALID FOR THE LIST FORM                  @Y30LB02 13200003
.*           ICB605I: ECB MUST BE SPECIFIED FOR                @Y30LB02 13250003
.*                    STANDARD FORM MACRO                      @Y30LB02 13300003
.*           ICB606I: EXTS MUST BE SPECIFIED FOR               @Y30LB02 13350003
.*                    STANDARD FORM MACRO                      @Y30LB02 13400003
.*           ICB607I: FLAGS MUST BE SPECIFIED FOR              @Y30LB02 13450003
.*                    STANDARD FORM MACRO                      @Y30LB02 13500003
.*           ICB610I: VOLID MUST BE SPECIFIED FOR              @Y30LB02 13550003
.*                    STANDARD FORM MACRO                      @Y30LB02 13600003
.*           ICB612I: MF(2) MUST CONTAIN REQ BLK NAME          @Y30LB02 13650003
.*                    IF EXEC MACRO FORM REQUESTED             @Y30LB02 13700003
.*           ICB613I: MISSING REQ BLK NAME OR MORE             @Y30LB02 13750003
.*                    THAN 2 SUBPARAMETERS FOR MF              @Y30LB02 13800003
.*           ICB615I: INVALID MF PARAMETER SPECIFIED,          @Y30LB02 13850003
.*                    MUST BE L, E, OR NULL                    @Y30LB02 13900003
.*                                                             @Y30LB02 13950003
.*                                                             @Y30LB02 14000003
.*01  INNER=MACRO = NONE                                       @Y30LB02 14050003
.*                                                             @Y30LB02 14100003
.*01  SYSTEM-MACROS = IHBINNRA                                 @Y30LB02 14150003
.*                                                             @Y30LB02 14200003
.*01  CHANGE-ACTIVITY = S/D = X04AC02 AND Y30LB02              @Y30LB02 14250003
.*                                                             @Y30LB02 14300003
.**** END OF SPECIFICATIONS ***                                @Y30LB02 14350003
         MACRO                                                          14400003
&SYMBOL  ICBCOTB &MF=,&VOLID=,&ECB=,&EXTS=,&FLAGS=                      14450003
         LCLB  &ESW                    EXIT-SWITCH             @Y30LB02 14500003
         LCLB  &BSW                    BRCH-SWITCH             @Y30LB02 14550003
         LCLC  &COTB                                           @Y30LB02 14600003
&COTB    SETC  'CT'.'&SYSNDX'                                  @Y30LB02 14650003
         AIF   ('&MF(1)' NE 'L').NLIST BRCH IF NOT LIST FORM   @Y30LB02 14700003
         AIF   ('&VOLID' NE '' OR '&ECB' NE '' OR '&EXTS' NE           *14750003
               '' OR '&FLAGS' NE '').WARN                      @Y30LB02 14800003
         AGO   .LIST                                           @Y30LB02 14850003
.WARN    MNOTE 4,'  ICB604I - WARNING-ONLY THE MF PARAMETER '  @Y30LB02 14900003
         MNOTE 4,'  IS VALID FOR THE LIST FORM  '              @Y30LB02 14950003
.LIST    ANOP                                                  @Y30LB02 15000003
         AIF   ('&MF(2)' EQ 'MAP').LISTDS   DSECT REQUESTED?   @Y30LB02 15050003
*  MACMEAN  MSSC COPY TABLES MACRO--INITIALIZED LIST FORM      @Y30LB02 15100003
*  VS1-4/VS2-3 VERSION--06/09/74   LEVEL 00                    @Y30LB02 15150003
&SYMBOL  DS    0F                                              @Y30LB02 15200003
COTBLEN  DC    F'24'                   REQUEST BLK LENGTH      @Y30LB02 15250003
COTBOP   DC    XL1'16'                 COTB OPCODE             @Y30LB02 15300003
COTBRES1 DC    XL1'00'                 RESERVED FIELD          @Y30LB02 15350003
COTBFLAG DC    XL2'0000'               FLAGS FIELD             @Y30LB02 15400003
COTBEXT  DC    XL4'00000000'           EXTENTS FIELD           @Y30LB02 15450003
COTBVOL  DC    XL6'000000000000'       VOLID FIELD             @Y30LB02 15500003
COTBASID DC    XL2'0000'               ASID FIELD              @Y30LB02 15550003
COTBECB  DC    XL4'00000000'           ECB FIELD               @Y30LB02 15600003
         AGO   .EXIT                   BRANCH TO END           @Y30LB02 15650003
.*                                                             @Y30LB02 15700003
.LISTDS  ANOP                                                  @Y30LB02 15750003
*  MACMEAN  MSSC COPY TABLES MACRO--UNINITIALIZED LIST FORM    @Y30LB02 15800003
*  VS1-4/VS2-3 VERSION--06/09/74   LEVEL 00                    @Y30LB02 15850003
ICBCOTB  DSECT                                                 @Y30LB02 15900003
COTBLEN  DS    F                       REQUEST LEN 18 HEX      @Y30LB02 15950003
COTBOP   DS    XL1                     COTB OPCODE 16 HEX      @Y30LB02 16000003
COTBRES1 DS    XL1                     RESERVED FIELD          @Y30LB02 16050003
COTBFLAG DS    XL2                     FLAGS FIELD             @Y30LB02 16100003
COTBEXT  DS    XL4                     EXTENTS FIELD           @Y30LB02 16150003
COTBVOL  DS    XL6                     VOLID FIELD             @Y30LB02 16200003
COTBASID DS    XL2                     ASID FIELD              @Y30LB02 16250003
COTBECB  DS    A                       ECB FIELD               @Y30LB02 16300003
         AGO   .EXIT                   BRANCH TO END           @Y30LB02 16350003
.NLIST   AIF   ('&MF(1)' NE '').EXCK   IF NOT STD FORM,BRCH    @Y30LB02 16400003
*  MACMEAN  MSSC COPY TABLES MACRO--STANDARD FORM              @Y30LB02 16450003
*  VS1-4/VS2-3 VERSION--06/09/74   LEVEL 00                    @Y30LB02 16500003
         CNOP 0,4                                              @Y30LB02 16550003
&SYMBOL  BAL   1,&COTB                 BRCH AROUND REQBLK      @Y30LB02 16600003
COTBLEN  DC    A(&COTB-*)              REQUEST BLOCK LENGTH    @Y30LB02 16650003
COTBOP   DC    XL1'16'                 COTB OPCODE             @Y30LB02 16700003
COTBRES1 DC    XL1'00'                 RESERVED FIELD          @Y30LB02 16750003
COTBFLAG DC    XL2'0000'               FLAGS FIELD             @Y30LB02 16800003
COTBEXT  DC    XL4'00000000'           EXTENTS FIELD           @Y30LB02 16850003
COTBVOL  DC    XL6'000000000000'       VOLID FIELD             @Y30LB02 16900003
COTBASID DC    XL2'0000'               ASID FIELD              @Y30LB02 16950003
COTBECB  DC    XL4'00000000'           ECB FIELD               @Y30LB02 17000003
&COTB    EQU   *                                               @Y30LB02 17050003
         AGO   .TEST                   BRANCH                  @Y30LB02 17100003
.EXCK    AIF   ('&MF(1)' EQ 'E').EXEC  IF EXEC FORM,BRCH       @Y30LB02 17150003
&ESW     SETB  1                       TURN EXIT-SWITCH ON     @Y30LB02 17200003
         MNOTE 12,'  ICB615I - INVALID MF PARAMETER '          @Y30LB02 17250003
         MNOTE 12,'  SPECIFIED, MUST BE L, E, OR NULL '        @Y30LB02 17300003
         AGO   .TEST                   BRANCH                  @Y30LB02 17350003
.EXEC    AIF   (N'&MF EQ 2).CONT       IF 2 SUBPARAMETERS,BRCH @Y30LB02 17400003
&ESW     SETB  1                       TURN EXIT-SWITCH ON     @Y30LB02 17450003
         MNOTE 12,'  ICB613I - MISSING REQ BLK NAME OR MORE '  @Y30LB02 17500003
         MNOTE 12,'  THAN 2 SUBPARAMETERS FOR MF'              @Y30LB02 17550003
         AGO   .TEST                   BRANCH                  @Y30LB02 17600003
.CONT    ANOP                                                  @Y30LB02 17650003
.*                                                             @Y30LB02 17700003
*  MACMEAN  MSSC COPY TABLES MACRO--EXECUTE FORM               @Y30LB02 17750003
*  VS1-4/VS2-3 VERSION--06/09/74   LEVEL 00                    @Y30LB02 17800003
&SYMBOL  IHBINNRA &MF(2)               ADDR OF REQUEST BLK     @Y30LB02 17850003
.*                                     USING IHBINNRA MACRO    @Y30LB02 17900003
         LA    15,24                   LENGTH(24) INTO R15     @Y30LB02 17950003
         ST    15,0(1)                 STORE R15 IN BLOCK      @Y30LB02 18000003
         MVI   4(1),X'16'              STORE  OPCODE           @Y30LB02 18050003
.TEST    AIF   (&ESW).EXIT             BRCH IF EXIT-SWITCH ON  @Y30LB02 18100003
         AIF   ('&FLAGS' NE '').TEST6  BRCH IF FLAGS SPECIFIED @Y30LB02 18150003
         AIF   ('&MF(1)' EQ '').SETESW0 BRCH IF STD FORM       @Y30LB02 18200003
&BSW     SETB  1                       TURN BRCH-SWITCH ON     @Y30LB02 18250003
         AGO   .TEST6                  BRANCH                  @Y30LB02 18300003
.SETESW0 ANOP                                                  @Y30LB02 18350003
&ESW     SETB  1                       TURN EXIT-SWITCH ON     @Y30LB02 18400003
         MNOTE 12,'  ICB607I - FLAGS MUST BE SPECIFIED '       @Y30LB02 18450003
         MNOTE 12,'  FOR STANDARD FORM MACRO '                 @Y30LB02 18500003
.TEST6   AIF   (&ESW).EXIT             BRCH IF EXIT-SWITCH ON  @Y30LB02 18550003
         AIF   (&BSW).RESET0           BRCH IF BRCH-SWITCH ON  @Y30LB02 18600003
         AIF   ('&FLAGS'(1,1) EQ '(').RFLAGS BRCH IF IN REG    @Y30LB02 18650003
         MVC   6(2,1),&FLAGS           MV FLAGS INTO FLAGS FLD @Y30LB02 18700003
         AGO   .RESET0                 BRANCH                  @Y30LB02 18750003
.RFLAGS  ANOP                                                  @Y30LB02 18800003
         MVC   6(2,1),0(&FLAGS(1))     MV FLAGS TO FLAGS FLD   @Y30LB02 18850003
.RESET0  ANOP                                                  @Y30LB02 18900003
&BSW     SETB  0                                               @Y30LB02 18950003
         AIF   (&ESW).EXIT             BRCH IF EXIT-SWITCH ON  @Y30LB02 19000003
         AIF   ('&VOLID' NE '').TEST2  BRCH IF VOLID SPECIFIED @Y30LB02 19050003
         AIF   ('&MF(1)' EQ '').SETESW1 BRCH IF STD FORM       @Y30LB02 19100003
&BSW     SETB  1                       TURN BRCH-SWITCH ON     @Y30LB02 19150003
         AGO   .TEST2                  BRANCH                  @Y30LB02 19200003
.SETESW1 ANOP                                                  @Y30LB02 19250003
&ESW     SETB  1                       TURN EXIT-SWITCH ON     @Y30LB02 19300003
         MNOTE 12,'  ICB610I - VOLID MUST BE SPECIFIED '       @Y30LB02 19350003
         MNOTE 12,'  FOR STANDARD FORM MACRO '                 @Y30LB02 19400003
.TEST2   AIF   (&ESW).EXIT             BRCH IF EXIT-SWITCH ON  @Y30LB02 19450003
         AIF   (&BSW).RESET1           BRCH IF BRCH-SWITCH ON  @Y30LB02 19500003
         AIF   ('&VOLID'(1,1) EQ '(').RVOLID BRCH IF IN REG    @Y30LB02 19550003
         MVC   8(6,1),&VOLID           MV VOLID INTO VOLID FLD @Y30LB02 19600003
         AGO   .RESET1                 BRANCH                  @Y30LB02 19650003
.RVOLID  ANOP                                                  @Y30LB02 19700003
         MVC   8(6,1),0(&VOLID(1))     MV VOLID TO VOLID FLD   @Y30LB02 19750003
.RESET1  ANOP                                                  @Y30LB02 19800003
&BSW     SETB  0                       RESET BRCH-SWITCH TO 0  @Y30LB02 19850003
         AIF   ('&ECB' NE '').TEST3    BRCH IF ECB SPECIFIED   @Y30LB02 19900003
         AIF   ('&MF(1)' EQ '').SETESW2 BRCH IF STD FORM       @Y30LB02 19950003
&BSW     SETB  1                       TURN BRCH-SWITCH ON     @Y30LB02 20000003
         AGO   .TEST3                  BRANCH                  @Y30LB02 20050003
.SETESW2 ANOP                                                  @Y30LB02 20100003
&ESW     SETB  1                       TURN EXIT-SWITCH ON     @Y30LB02 20150003
         MNOTE 12,'  ICB605I - ECB MUST BE SPECIFIED FOR '     @Y30LB02 20200003
         MNOTE 12,'  STANDARD FORM MACRO '                     @Y30LB02 20250003
.TEST3   AIF   (&ESW).EXIT             BRCH IF EXIT-SWITCH ON  @Y30LB02 20300003
         AIF   (&BSW).RESET2           BRCH IF BRCH-SWITCH ON  @Y30LB02 20350003
         AIF   ('&ECB'(1,1) EQ '(').RECB BRCH IF IN REG        @Y30LB02 20400003
         LA    15,&ECB                 LOAD R15 WITH ADDR      @Y30LB02 20450003
         ST    15,16(1)                ST ADDR IN ECB FIELD    @Y30LB02 20500003
         AGO   .RESET2                 BRANCH                  @Y30LB02 20550003
.RECB    ANOP                                                  @Y30LB02 20600003
         ST    &ECB,16(1)              ST ADDR IN ECB FIELD    @Y30LB02 20650003
.RESET2  ANOP                                                  @Y30LB02 20700003
&BSW     SETB  0                       RESET BRCH-SWITCH TO 0  @Y30LB02 20750003
         AIF   ('&EXTS' NE '').TEST4   BRCH IF EXTS SPECIFIED  @Y30LB02 20800003
         AIF   ('&MF(1)' EQ '').SETESW3 BRCH IF STD FORM       @Y30LB02 20850003
&BSW     SETB  1                       TURN BRCH-SWITCH ON     @Y30LB02 20900003
         AGO   .TEST4                  BRANCH                  @Y30LB02 20950003
.SETESW3 ANOP                                                  @Y30LB02 21000003
&ESW     SETB  1                       TURN EXIT-SWITCH ON     @Y30LB02 21050003
         MNOTE 12,'  ICB606I - EXTS MUST BE SPECIFIED FOR '    @Y30LB02 21100003
         MNOTE 12,'  STANDARD FORM MACRO '                     @Y30LB02 21150003
.TEST4   AIF   (&ESW).EXIT             BRCH IF EXIT-SWITCH ON  @Y30LB02 21200003
         AIF   (&BSW).LINK             BRCH IF BRCH-SWITCH ON  @Y30LB02 21250003
         AIF   ('&EXTS'(1,1) EQ '(').REXTS BRCH IF IN REG      @Y30LB02 21300003
         MVC   20(4,1),&EXTS           MV EXTS INTO EXTS FLD   @Y30LB02 21350003
         AGO   .LINK                   BRANCH                  @Y30LB02 21400003
.REXTS   ANOP                                                  @Y30LB02 21450003
         MVC   20(4,1),0(&EXTS(1))     MV EXTS TO EXTS FLD     @Y30LB02 21500003
.LINK    ANOP                                                  @Y30LB02 21550003
         SVC   126                     ISSUE SVC INSTRUCTION   @Y30LB02 21600003
.EXIT    MEND                                                  @Y30LB02 21650003
**/                                                                     21700003
* ICBCOTB: MACRO KEYS(MF,VOLID,ECB,EXTS,FLAGS);            /*@Y30LB02*/ 21750003
*/*                                                          @Y30LB02*/ 21800003
*/* EXTERNAL DECLARES                                        @Y30LB02*/ 21850003
*   DCL COTBTEST FIXED EXT;            /*USED AS A TEST TO   @Y30LB02*/ 21900003
*                                      /*SEE IF STD FORM     @Y30LB02*/ 21950003
*                                      /*ALREADY INVOKED     @Y30LB02*/ 22000003
*   DCL COTESTR1 FIXED EXT;            /*USED AS A TEST TO   @Y30LB02*/ 22050003
*                                      /*SEE IF R1 ALREADY   @Y30LB02*/ 22100003
*                                      /*DECLARED            @Y30LB02*/ 22150003
*/* INTERNAL DECLARES                                        @Y30LB02*/ 22200003
*   DCL  RETCODE FIXED;                /*RETURN CODE         @Y30LB02*/ 22250003
*   DCL  COPCODE CHAR;                 /*COPY TABLES OPCODE  @Y30LB02*/ 22300003
*   DCL  LENGTH CHAR;                  /*LENGTH OF BLOCK     @Y30LB02*/ 22350003
*   DCL  ESW FIXED;                    /*EXIT-SWITCH         @Y30LB02*/ 22400003
*   DCL  BSW FIXED;                    /*BRCH-SWITCH         @Y30LB02*/ 22450003
*   DCL  CTR FIXED;                    /*PARM-SWITCH         @Y30LB02*/ 22500003
*   COPCODE='16';                      /*COPY TABLES OPCODE  @Y30LB02*/ 22550003
*   LENGTH='18';                       /*DEFINE REQ LENGTH   @Y30LB02*/ 22600003
*/* INITIALIZE SWITCHES TO ZERO                              @Y30LB02*/ 22650003
*   ESW=0;                             /*INIT ERROR SWITCH   @Y30LB02*/ 22700003
*   BSW=0;                             /*INIT BRANCH SWITCH  @Y30LB02*/ 22750003
*   CTR=0;                             /*INIT PARM  SWITCH   @Y30LB02*/ 22800003
*/* END OF DECLARES AND INITIALIZATION                       @Y30LB02*/ 22850003
*   IF COTESTR1=0 THEN                 /*HAS R1 BEEN DCL'D?  @Y30LB02*/ 22900003
*             DO;                      /*NO,DECLARE IT       @Y30LB02*/ 22950003
*                  ANS('DCL COTBR1 PTR REG(1) ;'||         /*@Y30LB02*/ 23000003
*                       '/*WILL CONTAIN BLOCK ADDRESS @Y30LB02*/')      23050003
*                       SKIP(1);                           /*@Y30LB02*/ 23100003
*                  COTESTR1=1;         /*COTESTR1 SET TO 1   @Y30LB02*/ 23150003
*             END;                     /*                    @Y30LB02*/ 23200003
*   IF MF(1)^='L' THEN                 /*IF NOT LIST FORM    @Y30LB02*/ 23250003
*        GO TO NOTLIST;                /*THEN BRANCH         @Y30LB02*/ 23300003
*   IF MF(2)='' THEN                   /*WAS A NAME GIVEN?   @Y30LB02*/ 23350003
*        DO;                           /*NO,TURN ESW ON AND  @Y30LB02*/ 23400003
*             ESW=1;                   /*PRINT ERROR MSG     @Y30LB02*/ 23450003
*             ANS MSG('  ICB602I - A NAME FOR THE '||                   23500003
*                  'REQUEST BLOCK MUST BE SPECIFIED '||                 23550003
*                  'IN MF(2)')SKIP(5);                     /*@Y30LB02*/ 23600003
*             RETCODE=12;              /*SET RETURN CODE     @Y30LB02*/ 23650003
*        END;                          /*                    @Y30LB02*/ 23700003
*   IF ESW=1 THEN                      /*EXIT-SWITCH ON?     @Y30LB02*/ 23750003
*        GO TO EXIT;                   /*YES, BRANCH         @Y30LB02*/ 23800003
*        IF FLAGS ^= '' THEN  /*FLAGS SPECIFIED?             @Y30LB02*/ 23850003
*             CTR = CTR + 1;  /*YES,INCREMENT CTR            @Y30LB02*/ 23900003
*        IF VOLID ^= '' THEN  /*VOLID SPECIFIED?             @Y30LB02*/ 23950003
*             CTR = CTR + 1; /*YES,INCREMENT COUNTER         @Y30LB02*/ 24000003
*        IF EXTS ^= '' THEN   /*EXTENTS SPECIFIED?           @Y30LB02*/ 24050003
*             CTR = CTR + 1;  /*YES,INCREMENT COUNTER        @Y30LB02*/ 24100003
*        IF ECB ^= '' THEN    /*ECB SPECIFIED?               @Y30LB02*/ 24150003
*             CTR = CTR + 1;  /*YES,INCREMENT COUNTER        @Y30LB02*/ 24200003
*        IF CTR > 0 THEN      /*COUNTER GT ZERO?             @Y30LB02*/ 24250003
*          DO;                /*YES,PRINT WARNING MSG        @Y30LB02*/ 24300003
*             RETCODE = 4;    /*SET RETURN CODE TO 4         @Y30LB02*/ 24350003
*             ANS MSG('  ICB604I - WARNING-ONLY'||                      24400003
*                 ' THE MF PARAMETER IS VALID FOR THE'||                24450003
*                 ' LIST FORM  ')SKIP;                     /*@Y30LB02*/ 24500003
*          END;               /*                             @Y30LB02*/ 24550003
*   IF MF(3) ^= '' THEN                /*PLS ATTR SPCD?      @Y30LB02*/ 24600003
*        GO TO ATTRLST;                /*BRANCH              @Y30LB02*/ 24650003
*/*                                                          @Y30LB02*/ 24700003
*/*********************************************************  @Y30LB02*/ 24750003
*/* PRINT OUT DECLARES FOR LIST FORM                         @Y30LB02*/ 24800003
*/*********************************************************  @Y30LB02*/ 24850003
*/*                                                          @Y30LB02*/ 24900003
*   ANS('/*******************************************'||                24950003
*       '************** @Y30LB02*/')SKIP;                               25000003
*   ANS('/*    MACMEAN  MSSC COPY TABLES MACRO       '||                25050003
*       '               @Y30LB02*/')SKIP;                               25100003
*   ANS('/*VS1-4/VS2-3 VERSION--06/09/74 LEVEL 00    '||                25150003
*       '               @Y30LB02*/')SKIP;                               25200003
*   ANS('/*THIS IS THE INITIALIZED LIST FORM         '||                25250003
*       '               @Y30LB02*/')SKIP;                               25300003
*   ANS('/*******************************************'||                25350003
*       '************** @Y30LB02*/')SKIP;                               25400003
*   ANS('DCL 1  '||MF(2)||'  STATIC LOCAL,') SKIP(1);      /*@Y30LB02*/ 25450003
*   ANS('      2  COTBLL FIXED(31) INIT('||QUOTE('18')||                25500003
*        'X), /*LENGTH OF REQUEST BLOCK @Y30LB02*/') SKIP(1);           25550003
*   ANS('      2  COTBOP FIXED(8) INIT('||QUOTE(COPCODE)||              25600003
*        'X), /*OPCODE @Y30LB02*/') SKIP(1);                            25650003
*   ANS('      2  * CHAR(1) INIT('||QUOTE('00')||                       25700003
*        'X), /*RESERVED AREA @Y30LB02*/') SKIP(1);                     25750003
*   ANS('      2  COTBFLG BIT(16) INIT('||                              25800003
*        QUOTE('0000000000000000')||'B), /*FLAGS FIELD @Y30LB02*/')     25850003
*        SKIP(1);                                          /*@Y30LB02*/ 25900003
*   ANS('        3  COTBTID BIT(4),/*TABLE IDENTIFI'||                  25950003
*        'CATION, MUST BE SET TO 8 FOR TABLES OTHER '||                 26000003
*        'THAN TRACE  @Y30LB02*/') SKIP(1);                             26050003
*   ANS('        3  *       BIT(4),/*RESERVED BITS'||                   26100003
*        ' AND MUST BE ZERO @Y30LB02*/') SKIP(1);                       26150003
*   ANS('        3  COTBTRX BIT(1),/*COPY TRACEX'||                     26200003
*        ' ATTRIBUTE @Y30LB02*/') SKIP(1);                              26250003
*   ANS('        3  COTBTRY BIT(1),/*COPY TRACEY'||                     26300003
*        ' ATTRIBUTE @Y30LB02*/') SKIP(1);                              26350003
*   ANS('        3  COTBTRA BIT(1),/*COPY TRACE'||                      26400003
*        ' ACTIVE ATTRIBUTE @Y30LB02*/') SKIP(1);                       26450003
*   ANS('        3  COTBTRI BIT(1),/*COPY TRACE'||                      26500003
*        ' INACTIVE ATTRIBUTE @Y30LB02*/') SKIP(1);                     26550003
*   ANS('        3  *       BIT(4),/*RESERVED BITS '||                  26600003
*        'AND MUST BE ZERO @Y30LB02*/') SKIP(1);                        26650003
*   ANS('      2  COTBEXTS CHAR(4) INIT('||QUOTE('00000000')            26700003
*        ||'X), /*BEG AND END EXTENTS @Y30LB02*/') SKIP(1);             26750003
*   ANS('      2  COTBVOL CHAR(6) INIT('||                              26800003
*        QUOTE('000000000000')||'X), /*VOLID FIELD @Y30LB02*/')         26850003
*        SKIP(1);                                                       26900003
*   ANS('      2  COTBASID CHAR(2) INIT('||QUOTE('0000')||              26950003
*        'X), /*ASID FIELD @Y30LB02*/') SKIP(1);                        27000003
*   ANS('      2  COTBECB FIXED(31) INIT(0);/*NAME OF ECB @Y30LB02*/')  27050003
*        SKIP(1);                                          /*@Y30LB02*/ 27100003
*/*                                                          @Y30LB02*/ 27150003
*   GO TO EXIT;                        /*BRANCH TO END       @Y30LB02*/ 27200003
*/*********************************************************  @Y30LB02*/ 27250003
*/* THIS IS ALL THAT IS DONE FOR LIST FORM                   @Y30LB02*/ 27300003
*/*********************************************************  @Y30LB02*/ 27350003
*/*                                                          @Y30LB02*/ 27400003
*ATTRLST:                                                               27450003
*/*                                                          @Y30LB02*/ 27500003
*   ANS('/*******************************************'||                27550003
*       '************* @Y30LB02*/')SKIP;                                27600003
*   ANS('/*     MACMEAN  MSSC COPY TABLES MACRO      '||                27650003
*       '              @Y30LB02*/')SKIP;                                27700003
*   ANS('/*VS1-4/VS2-3 VERSION--06/09/74 LEVEL 00    '||                27750003
*       '              @Y30LB02*/')SKIP;                                27800003
*   ANS('/*THIS IS THE UNINITIALIZED LIST FORM       '||                27850003
*       '              @Y30LB02*/')SKIP;                                27900003
*   ANS('/*******************************************'||                27950003
*       '************* @Y30LB02*/')SKIP;                                28000003
*   ANS('DCL 1  '||MF(2)||' '||MF(3)||','||                             28050003
*   '/*COPY TABLES REQUEST BLOCK*/ ') SKIP(1);                          28100003
*   ANS('      2  COTBLL FIXED(31), /*LENGTH'||                         28150003
*        ' = 18 BYTES HEX @Y30LB02*/')SKIP(1);                          28200003
*   ANS('      2  COTBOP FIXED(8) , /*OPCODE='||                        28250003
*        ' 16 HEX @Y30LB02*/') SKIP(1);                                 28300003
*   ANS('      2  * CHAR(1), /*RESERVED AREA @Y30LB02*/') SKIP(1);      28350003
*   ANS('      2  COTBFLG BIT(16),'||                                   28400003
*        ' /*FLAGS FIELD @Y30LB02*/') SKIP(1);                          28450003
*   ANS('        3  COTBTID BIT(4),/*TABLE IDENTIFI'||                  28500003
*        'CATION, MUST BE SET TO 8 FOR TABLES OTHER '||                 28550003
*        'THAN TRACE  @Y30LB02*/') SKIP(1);                             28600003
*   ANS('        3  *       BIT(4),/*RESERVED BITS'||                   28650003
*        ' AND MUST BE ZERO @Y30LB02*/') SKIP(1);                       28700003
*   ANS('        3  COTBTRX BIT(1),/*COPY TRACEX'||                     28750003
*        ' ATTRIBUTE @Y30LB02*/') SKIP(1);                              28800003
*   ANS('        3  COTBTRY BIT(1),/*COPY TRACEY'||                     28850003
*        ' ATTRIBUTE @Y30LB02*/') SKIP(1);                              28900003
*   ANS('        3  COTBTRA BIT(1),/*COPY TRACE'||                      28950003
*        ' ACTIVE ATTRIBUTE @Y30LB02*/') SKIP(1);                       29000003
*   ANS('        3  COTBTRI BIT(1),/*COPY TRACE'||                      29050003
*        ' INACTIVE ATTRIBUTE @Y30LB02*/') SKIP(1);                     29100003
*   ANS('        3  *       BIT(4),/*RESERVED BITS '||                  29150003
*        'AND MUST BE ZERO @Y30LB02*/') SKIP(1);                        29200003
*   ANS('      2  COTBEXTS CHAR(4),'||                                  29250003
*        ' /*BEG AND END EXTENTS @Y30LB02*/') SKIP(1);                  29300003
*   ANS('      2  COTBVOL CHAR(6),'||                                   29350003
*        ' /*VOLID FIELD @Y30LB02*/') SKIP(1);                          29400003
*   ANS('      2  COTBASID CHAR(2), /*ASID AREA '||                     29450003
*        'USED BY THE SVC @Y30LB02*/') SKIP(1);                         29500003
*   ANS('      2  COTBECB FIXED(31);/*NAME OF ECB @Y30LB02*/')          29550003
*        SKIP(1);                                          /*@Y30LB02*/ 29600003
*   GO TO EXIT;                        /*BRANCH TO END       @Y30LB02*/ 29650003
*NOTLIST:                                                               29700003
*   IF MF(1)^='' THEN                  /*STD FORM REQUEST?   @Y30LB02*/ 29750003
*        GO TO EXCHECK;                /*NO,BRANCH           @Y30LB02*/ 29800003
*/*                                                          @Y30LB02*/ 29850003
*/*********************************************************  @Y30LB02*/ 29900003
*/* THIS PART OF THE MACRO IS FOR STD FORM(MF(1)='')         @Y30LB02*/ 29950003
*/*********************************************************  @Y30LB02*/ 30000003
*/*                                                          @Y30LB02*/ 30050003
*   IF COTBTEST=1 THEN                 /*IF THE STD FRM HAS  @Y30LB02*/ 30100003
*                                      /*BEEN INVOKED ALRDY  @Y30LB02*/ 30150003
*        DO;                           /*SET UP REG1 TO PNT  @Y30LB02*/ 30200003
*                                      /*TO REQUEST BLOCK    @Y30LB02*/ 30250003
*           ANS('/***********************************'||                30300003
*               '********************* @Y30LB02*/')SKIP;                30350003
*           ANS('/*     MACMEAN  MSSC COPY TABLES    '||                30400003
*               ' MACRO                @Y30LB02*/')SKIP;                30450003
*           ANS('/*     VS1-4/VS2-3 VERSION--06/09/74'||                30500003
*               'LEVEL 00              @Y30LB02*/')SKIP;                30550003
*           ANS('/*     THIS IS THE OUTPUT FOR A     '||                30600003
*               'SECONDARY             @Y30LB02*/')SKIP;                30650003
*           ANS('/*     INVOCATION OF THE STANDARD   '||                30700003
*               'FORM MACRO            @Y30LB02*/')SKIP;                30750003
*           ANS('/***********************************'||                30800003
*               '********************* @Y30LB02*/')SKIP;                30850003
*             ANS('RFY(COTBR1)RSTD;'||                     /*@Y30LB02*/ 30900003
*                '/*RESTRICT REGISTER 1 @Y30LB02*/')SKIP(1);            30950003
*             ANS('COTBR1=ADDR(COTBLL);'||                 /*@Y30LB02*/ 31000003
*                '/*COTBR1 ADDRESS OF REQ BLOCK @Y30LB02*/')SKIP(1);    31050003
*             GO TO TEST1;                                 /*@Y30LB02*/ 31100003
*        END;                                              /*@Y30LB02*/ 31150003
*/*                                                          @Y30LB02*/ 31200003
*/*********************************************************  @Y30LB02*/ 31250003
*/* OTHERWISE, PRINT OUT DECLARES FOR STD FORM               @Y30LB02*/ 31300003
*/*********************************************************  @Y30LB02*/ 31350003
*/*                                                          @Y30LB02*/ 31400003
*   ANS('/*******************************************'||                31450003
*       '************* @Y30LB02*/')SKIP;                                31500003
*   ANS('/*     MACMEAN  MSSC COPY TABLES MACRO      '||                31550003
*       '              @Y30LB02*/')SKIP;                                31600003
*   ANS('/*VS1-4/VS2-3 VERSION--06/09/74 LEVEL 00    '||                31650003
*       '              @Y30LB02*/')SKIP;                                31700003
*   ANS('/*INVOCATION OF THE STANDARD FORM MACRO     '||                31750003
*       '              @Y30LB02*/')SKIP;                                31800003
*   ANS('/*******************************************'||                31850003
*       '************* @Y30LB02*/')SKIP;                                31900003
*   ANS ('DCL  1 COTBLIST  STATIC LOCAL,') SKIP(1);        /*@Y30LB02*/ 31950003
*   ANS('      2  COTBLL FIXED(31) INIT('||QUOTE('18')||                32000003
*        'X), /*LENGTH OF REQUEST BLOCK @Y30LB02*/') SKIP(1);           32050003
*   ANS('      2  COTBOP FIXED(8) INIT('||QUOTE(COPCODE)||              32100003
*        'X), /*OPCODE @Y30LB02*/') SKIP(1);                            32150003
*   ANS('      2  * CHAR(1) INIT('||QUOTE('00')||                       32200003
*        'X), /*RESERVED AREA @Y30LB02*/') SKIP(1);                     32250003
*   ANS('      2  COTBFLG BIT(16) INIT('||                              32300003
*        QUOTE('0000000000000000')||'B), /*FLAGS FIELD @Y30LB02*/')     32350003
*        SKIP(1);                                                       32400003
*   ANS('        3  COTBTID BIT(4),/*TABLE IDENTIFI'||                  32450003
*        'CATION @Y30LB02*/') SKIP(1);                                  32500003
*   ANS('        3  *       BIT(4),/*RESERVED BITS'||                   32550003
*        ' AND MUST BE ZERO @Y30LB02*/') SKIP(1);                       32600003
*   ANS('        3  COTBTRX BIT(1),/*COPY TRACEX'||                     32650003
*        ' ATTRIBUTE @Y30LB02*/') SKIP(1);                              32700003
*   ANS('        3  COTBTRY BIT(1),/*COPY TRACEY'||                     32750003
*        ' ATTRIBUTE @Y30LB02*/') SKIP(1);                              32800003
*   ANS('        3  COTBTRA BIT(1),/*COPY TRACE'||                      32850003
*        ' ACTIVE ATTRIBUTE @Y30LB02*/') SKIP(1);                       32900003
*   ANS('        3  COTBTRI BIT(1),/*COPY TRACE'||                      32950003
*        ' INACTIVE ATTRIBUTE @Y30LB02*/') SKIP(1);                     33000003
*   ANS('        3  *       BIT(4),/*RESERVED BITS '||                  33050003
*        'AND MUST BE ZERO @Y30LB02*/') SKIP(1);                        33100003
*   ANS('      2  COTBEXTS CHAR(4) INIT('||QUOTE('00000000')            33150003
*        ||'X), /*BEG AND END EXTENTS @Y30LB02*/') SKIP(1);             33200003
*   ANS('      2  COTBVOL CHAR(6) INIT('||                              33250003
*        QUOTE('000000000000')||'X), /*VOLID FIELD @Y30LB02*/')         33300003
*        SKIP(1);                                                       33350003
*   ANS('      2  COTBASID CHAR(2) INIT('||QUOTE('0000')||              33400003
*        'X), /*ASID FIELD @Y30LB02*/') SKIP(1);                        33450003
*   ANS('      2  COTBECB FIXED(31) INIT(0);/*NAME OF ECB @Y30LB02*/')  33500003
*        SKIP(1);                                          /*@Y30LB02*/ 33550003
*/*                                                          @Y30LB02*/ 33600003
*   COTBTEST=1;                        /*SET SWITCH TO 1     @Y30LB02*/ 33650003
*/*                                                          @Y30LB02*/ 33700003
*/*********************************************************  @Y30LB02*/ 33750003
*/* END OF DECLARES FOR REQUEST BLOCK                        @Y30LB02*/ 33800003
*/*********************************************************  @Y30LB02*/ 33850003
*/*                                                          @Y30LB02*/ 33900003
*   ANS('RFY(COTBR1)RSTD;/*RESTRICT REGISTER 1 @Y30LB02*/')SKIP;        33950003
*   ANS('COTBR1=ADDR(COTBLL);/*COTBR1  ADDR OF REQBLK @Y30LB02*/')      34000003
*        SKIP(1);                                          /*@Y30LB02*/ 34050003
*   GO TO TEST1;                       /*BRANCH              @Y30LB02*/ 34100003
*/*                                                          @Y30LB02*/ 34150003
*/*********************************************************  @Y30LB02*/ 34200003
*/* THE MACRO BRANCHES HERE FOR EXEC FORM                    @Y30LB02*/ 34250003
*/*********************************************************  @Y30LB02*/ 34300003
*/*                                                          @Y30LB02*/ 34350003
*EXCHECK: IF MF(1)='E' THEN            /*EXEC FORM?          @Y30LB02*/ 34400003
*             GO TO EXFORM;            /*YES, BRANCH         @Y30LB02*/ 34450003
*   ESW=1;                             /*TURN EXIT-SWTCH ON  @Y30LB02*/ 34500003
*   DO;                                /*PRINT THIS ERR MSG  @Y30LB02*/ 34550003
*        ANS MSG('  ICB615I - INVALID MF PARAMETER'||                   34600003
*             ' SPECIFIED, MUST BE L, E, OR NULL') SKIP(5);/*@Y30LB02*/ 34650003
*   END;                                /*                   @Y30LB02*/ 34700003
*   RETCODE=12;                        /*SET RETURN CODE     @Y30LB02*/ 34750003
*   GO TO TEST1;                       /*BRANCH              @Y30LB02*/ 34800003
*EXFORM: IF MF(2)='' THEN              /*ADDR OF LIST GIVEN  @Y30LB02*/ 34850003
*             DO;                      /*NO,PRINT ERROR MSG  @Y30LB02*/ 34900003
*                  ESW=1;              /*TURN EXIT-SWTCH ON  @Y30LB02*/ 34950003
*                  ANS MSG('  ICB612I - MF(2) MUST '||                  35000003
*                  'CONTAIN REQ BLK NAME IF '||                         35050003
*                  'EXEC MACRO FORM REQUESTED ') SKIP(5);  /*@Y30LB02*/ 35100003
*                  RETCODE=12;         /*SET RETURN CODE     @Y30LB02*/ 35150003
*                  GO TO TEST1;        /*BRANCH              @Y30LB02*/ 35200003
*             END;                     /*                    @Y30LB02*/ 35250003
*   ANS('/*******************************************'||                35300003
*       '************* @Y30LB02*/')SKIP;                                35350003
*   ANS('/*     MACMEAN  MSSC COPY TABLES MACRO      '||                35400003
*       '              @Y30LB02*/')SKIP;                                35450003
*   ANS('/*VS1-4/VS2-3 VERSION-- 06/09/74 LEVEL 00   '||                35500003
*       '              @Y30LB02*/')SKIP;                                35550003
*   ANS('/*THIS IS THE OUTPUT FOR THE EXECUTE FORM.  '||                35600003
*       '              @Y30LB02*/')SKIP;                                35650003
*   ANS('/*THE LIST FORM OF THIS MACRO SHOULD BE     '||                35700003
*       '              @Y30LB02*/')SKIP;                                35750003
*   ANS('/*INVOKED FIRST IN ORDER TO SET UP NECESSARY'||                35800003
*       '              @Y30LB02*/')SKIP;                                35850003
*   ANS('/*DECLARES.  IF THE COMPLETE ARGUMENT IS    '||                35900003
*       '              @Y30LB02*/')SKIP;                                35950003
*   ANS('/*SPECIFIED THE REQ BLOCK WILL BE ZEROED.   '||                36000003
*       '              @Y30LB02*/')SKIP;                                36050003
*   ANS('/*******************************************'||                36100003
*       '************* @Y30LB02*/')SKIP;                                36150003
*   ANS('RFY(COTBR1)RSTD;/*RESTRICT REGISTER 1 @Y30LB02*/')SKIP;        36200003
*   ANS('COTBR1=ADDR('||MF(2)||                                         36250003
*        '); /*SET COTBR1 TO ADDR OF REQ BLK @Y30LB02*/') SKIP(1);      36300003
*  IF MF(3) = 'COMPLETE' THEN    /*REQUEST TO ZERO?          @Y30LB02*/ 36350003
*   DO;                          /*YES,ZERO BLK              @Y30LB02*/ 36400003
*   ANS(' '||MF(2)||'='||MF(2)||'&&'||MF(2)||';'||         /*@Y30LB02*/ 36450003
*       '/*ZERO REQUEST BLOCK @Y30LB02*/')SKIP;                         36500003
*   END;                        /*                           @Y30LB02*/ 36550003
*   ANS('COTBLL='||QUOTE(LENGTH)||'X;'||                   /*@Y30LB02*/ 36600003
*       '/*SET LENGTH FIELD @Y30LB02*/')SKIP(1);                        36650003
*   ANS('COTBOP='||QUOTE(COPCODE)||'X; /*OPCODE @Y30LB02*/') SKIP(1);   36700003
*TEST1: BSW=0;                                             /*@Y30LB02*/ 36750003
*   IF ESW=1 THEN                      /*EXIT-SWITCH ON?     @Y30LB02*/ 36800003
*        GO TO EXIT;                   /*YES, BRANCH TO END  @Y30LB02*/ 36850003
*   IF FLAGS='' THEN                   /*FLAGS SPECIFIED?    @Y30LB02*/ 36900003
*        DO;                           /*NO,CHECK FOR STD    @Y30LB02*/ 36950003
*             IF MF(1)='' THEN         /*FORM                @Y30LB02*/ 37000003
*                  DO;                 /*IF STD FORM,TURN    @Y30LB02*/ 37050003
*                       ESW=1;         /*EXIT-SWITCH ON AND  @Y30LB02*/ 37100003
*                                      /*PRINT ERROR MSG     @Y30LB02*/ 37150003
*                       ANS MSG('  ICB607I - FLAGS'||                   37200003
*                        ' MUST BE SPECIFIED FOR STANDARD'||            37250003
*                        ' FORM MACRO') SKIP(5);           /*@Y30LB02*/ 37300003
*                       RETCODE=12;    /*SET RETURN CODE     @Y30LB02*/ 37350003
*                  END;                /*                    @Y30LB02*/ 37400003
*             ELSE                     /*IF NOT STD FORM     @Y30LB02*/ 37450003
*                  BSW=1;              /*TURN BRCH-SWTCH ON  @Y30LB02*/ 37500003
*        END;                          /*                    @Y30LB02*/ 37550003
*   IF ESW=1 THEN                      /*EXIT-SWITCH ON?     @Y30LB02*/ 37600003
*        GO TO EXIT;                   /*YES, GO TO END      @Y30LB02*/ 37650003
*   IF BSW=1 THEN                      /*BRCH-SWITCH ON?     @Y30LB02*/ 37700003
*        GO TO VOLCHECK;               /*YES,GO CK FOR ECB   @Y30LB02*/ 37750003
*   ANS('COTBFLG='||FLAGS||';/*FILL IN FLAGS FIELD @Y30LB02*/')         37800003
*        SKIP(1);                                          /*@Y30LB02*/ 37850003
*VOLCHECK:  BSW=0;                                         /*@Y30LB02*/ 37900003
*   IF ESW=1 THEN                      /*EXIT-SWITCH ON?     @Y30LB02*/ 37950003
*        GO TO EXIT;                   /*YES, BRANCH TO END  @Y30LB02*/ 38000003
*   IF VOLID='' THEN                   /*VOLID SPECIFIED?    @Y30LB02*/ 38050003
*        DO;                           /*NO,CHECK FOR STD    @Y30LB02*/ 38100003
*             IF MF(1)='' THEN         /*FORM                @Y30LB02*/ 38150003
*                  DO;                 /*IF STD FORM,TURN    @Y30LB02*/ 38200003
*                       ESW=1;         /*EXIT-SWITCH ON AND  @Y30LB02*/ 38250003
*                                      /*PRINT ERROR MSG     @Y30LB02*/ 38300003
*                       ANS MSG('  ICB610I - VOLID'||                   38350003
*                        ' MUST BE SPECIFIED FOR STANDARD'||            38400003
*                        ' FORM MACRO') SKIP(5);           /*@Y30LB02*/ 38450003
*                       RETCODE=12;    /*SET RETURN CODE     @Y30LB02*/ 38500003
*                  END;                /*                    @Y30LB02*/ 38550003
*             ELSE                     /*IF NOT STD FORM     @Y30LB02*/ 38600003
*                  BSW=1;              /*TURN BRCH-SWTCH ON  @Y30LB02*/ 38650003
*        END;                          /*                    @Y30LB02*/ 38700003
*   IF ESW=1 THEN                      /*EXIT-SWITCH ON?     @Y30LB02*/ 38750003
*        GO TO EXIT;                   /*YES, GO TO END      @Y30LB02*/ 38800003
*   IF BSW=1 THEN                      /*BRCH-SWITCH ON?     @Y30LB02*/ 38850003
*        GO TO ECBCHECK;               /*YES,GO CK FOR ECB   @Y30LB02*/ 38900003
*   ANS('COTBVOL='||VOLID||';/*FILL IN VOLID FIELD @Y30LB02*/')         38950003
*        SKIP(1);                                                       39000003
*ECBCHECK:  BSW=0;                     /*RESET BRCH-SWITCH   @Y30LB02*/ 39050003
*   IF ECB='' THEN                     /*ECB   SPECIFIED?    @Y30LB02*/ 39100003
*        DO;                           /*NO,CHECK FOR STD    @Y30LB02*/ 39150003
*             IF MF(1)='' THEN          /*FORM               @Y30LB02*/ 39200003
*                  DO;                 /*IF STD FORM,TURN    @Y30LB02*/ 39250003
*                       ESW=1;         /*EXIT-SWITCH ON AND  @Y30LB02*/ 39300003
*                                      /*PRINT ERROR MSG     @Y30LB02*/ 39350003
*                       ANS MSG('  ICB605I - ECB'||                     39400003
*                        ' MUST BE SPECIFIED FOR STANDARD'||            39450003
*                        ' FORM MACRO') SKIP(5);           /*@Y30LB02*/ 39500003
*                       RETCODE=12;    /*SET RETURN CODE     @Y30LB02*/ 39550003
*                  END;                                    /*@Y30LB02*/ 39600003
*             ELSE                     /*IF NOT STD FORM     @Y30LB02*/ 39650003
*                  BSW=1;              /*TURN BRCH-SWTCH ON  @Y30LB02*/ 39700003
*        END;                                              /*@Y30LB02*/ 39750003
*   IF ESW=1 THEN                      /*EXIT-SWITCH ON?     @Y30LB02*/ 39800003
*        GO TO EXIT;                   /*YES, GO TO END      @Y30LB02*/ 39850003
*   IF BSW=1 THEN                      /*BRCH-SWITCH ON?     @Y30LB02*/ 39900003
*        GO TO EXTSCK;                 /*YES,GO CK FOR EXTS  @Y30LB02*/ 39950003
*   ANS('COTBECB=ADDR'||ECB||';/*FILL IN ECB FIELD @Y30LB02*/')         40000003
*        SKIP(1);                                          /*@Y30LB02*/ 40050003
*EXTSCK:  BSW=0;                       /*RESET BRCH-SWITCH   @Y30LB02*/ 40100003
*   IF EXTS='' THEN                    /*EXTS  SPECIFIED?    @Y30LB02*/ 40150003
*        DO;                           /*NO,CHECK FOR STD    @Y30LB02*/ 40200003
*             IF MF(1)='' THEN         /*FORM                @Y30LB02*/ 40250003
*                  DO;                 /*IF STD FORM,TURN    @Y30LB02*/ 40300003
*                       ESW=1;         /*EXIT-SWITCH ON AND  @Y30LB02*/ 40350003
*                                      /*PRINT ERROR MSG     @Y30LB02*/ 40400003
*                       ANS MSG('  ICB606I - EXTS'||                    40450003
*                        ' MUST BE SPECIFIED FOR STANDARD'||            40500003
*                        ' FORM MACRO') SKIP(5);           /*@Y30LB02*/ 40550003
*                       RETCODE=12;    /*SET RETURN CODE     @Y30LB02*/ 40600003
*                  END;                /*                    @Y30LB02*/ 40650003
*             ELSE                     /*IF NOT STD FORM     @Y30LB02*/ 40700003
*                  BSW=1;              /*TURN BRCH-SWTCH ON  @Y30LB02*/ 40750003
*        END;                          /*                    @Y30LB02*/ 40800003
*   IF ESW=1 THEN                      /*EXIT-SWITCH ON?     @Y30LB02*/ 40850003
*        GO TO EXIT;                   /*YES, GO TO END      @Y30LB02*/ 40900003
*   IF BSW=1 THEN                      /*BRCH-SWITCH ON?     @Y30LB02*/ 40950003
*        GO TO LINK;                   /*YES,BR TO SVC INST  @Y30LB02*/ 41000003
*   ANS('COTBEXTS='||EXTS||';/*FILL IN EXTS FIELD @Y30LB02*/') SKIP(1); 41050003
*LINK: ANS(' SVC (126); /*ISSUE SVC INSTRUCTION @Y30LB02*/')            41100003
*        SKIP(1);                                                       41150003
*      ANS('RFY  COTBR1 UNRSTD;/*UNRESTRCT REG 1 @Y30LB02*/')SKIP;      41200003
*EXIT: RETURN CODE(RETCODE);                               /*@Y30LB02*/ 41250003
*   %END;                                                  /*@Y30LB02*/ 41300003
