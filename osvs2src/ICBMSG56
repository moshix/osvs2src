         TITLE 'ICBMSG56 - DISPLAY 3850                                *00001000
                        '                                               00002000
ICBMSG56 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'ICBMSG56  78.180'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  LA    @11,4095(,@12)                                      0001 00012000
         LA    @10,4095(,@11)                                      0001 00013000
         LA    @09,4095(,@10)                                      0001 00014000
         LA    @08,4095(,@09)                                      0001 00015000
         USING @PSTART,@12                                         0001 00016000
         USING @PSTART+4095,@11                                    0001 00017000
         USING @PSTART+8190,@10                                    0001 00018000
         USING @PSTART+12285,@09                                   0001 00019000
         USING @PSTART+16380,@08                                   0001 00020000
         LA    @07,@DATA                                           0001 00021000
         LA    @06,4095(,@07)                                      0001 00022000
         LA    @05,4095(,@06)                                      0001 00023000
         USING @DATA,@07                                           0001 00024000
         USING @DATA+4095,@06                                      0001 00025000
         USING @DATA+8190,@05                                      0001 00026000
         ST    @13,@SA00001+4                                      0001 00027000
         LA    @14,@SA00001                                        0001 00028000
         ST    @14,8(,@13)                                         0001 00029000
         LR    @13,@14                                             0001 00030000
*                                                                  0232 00031000
*/* ******************************************************   @Z40LB01*/ 00032000
*/*                                                          @Z40LB01*/ 00033000
*/*  IF THERE ARE ANY CWBS ON THE INTERNAL CWB               @Z40LB01*/ 00034000
*/*  QUEUE THEN GET THE TIME STAMP AND ISSUE THE             @Z40LB01*/ 00035000
*/*  DISPLAY START MESSAGE.                                  @Z40LB01*/ 00036000
*/*                                                          @Z40LB01*/ 00037000
*/*  STATMENT LABEL - MAIN,  END STATMENT LABEL ENDMAIN...   @Z40LB01*/ 00038000
*/* ******************************************************   @Z40LB01*/ 00039000
*                                                                  0232 00040000
*MAIN:                              /* MAIN DO ENDMAIN END   @Z40LB01*/ 00041000
*   IF CMDQUE(F1)^=F0 THEN          /* EMPTY QUE TEST        @Z40LB01*/ 00042000
MAIN     L     @04,@CA01311                                        0232 00043000
         L     @04,CMDQUE-CMDQUE(,@04)                             0232 00044000
         LTR   @04,@04                                             0232 00045000
         BZ    @RF00232                                            0232 00046000
*     DO;                           /* INITIALIZE MESSAGE    @Z40LB01*/ 00047000
*                                                                  0233 00048000
*       /*************************************************************/ 00049000
*       /*                                                           */ 00050000
*       /* ISSUE THE TIME MACRO AND TRANSLATE THE TIME       @Z40LB01*/ 00051000
*       /* STAMP FOR THE DISPLAY MESSAGES.                   @Z40LB01*/ 00052000
*       /*                                                           */ 00053000
*       /*************************************************************/ 00054000
*                                                                  0234 00055000
*       RFY                                                        0234 00056000
*         R0 RSTD;                  /*                       @Z40LB01*/ 00057000
*       GEN(TIME DEC);              /*                       @Z40LB01*/ 00058000
         TIME DEC                                                       00059000
*       TMESTAMP=R0;                /* STORE TIME RETURN     @Z40LB01*/ 00060000
         ST    R0,TMESTAMP                                         0236 00061000
*       RFY                                                        0237 00062000
*         R0 UNRSTD;                /*                       @Z40LB01*/ 00063000
*       UNPK(TIMEFLD,TMESTAMP);     /* UNPACK TIME           @Z40LB01*/ 00064000
         UNPK  TIMEFLD(8),TMESTAMP(4)                              0238 00065000
*       HRS=HH;                     /* FILL MSG HOURS FIELD  @Z40LB01*/ 00066000
         MVC   HRS(2),HH                                           0239 00067000
*       MINS=MM;                    /* FILL MSG MINUTES FLD  @Z40LB01*/ 00068000
         MVC   MINS(2),MM                                          0240 00069000
*       SECS=SS;                    /* FILL MSG SECONDS FLD  @Z40LB01*/ 00070000
         MVC   SECS(2),SS                                          0241 00071000
*       RETC=F0;                    /* AVOID WARNING MSG     @OZ30157*/ 00072000
         SLR   @04,@04                                             0242 00073000
         STH   @04,RETC                                            0242 00074000
*QUELOOP:                           /* DO GROUP LABEL        @Z40LB01*/ 00075000
*                                                                  0243 00076000
*       /*************************************************************/ 00077000
*       /*                                                           */ 00078000
*       /* THERE IS A MAXIMUM OF TEN CWBS ON THE INTERNAL CWB        */ 00079000
*       /*                                                   @Z40LB01*/ 00080000
*       /* QUEUE. THE FOLLOWING DO LOOP IS SET UP TO PROCESS @Z40LB01*/ 00081000
*       /* THE CWBS FROM THE QUEUE ONE AT A TIME UNTIL THE   @Z40LB01*/ 00082000
*       /* QUEUE IS EMPTY. THE DO START AND END ARE LABELED  @Z40LB01*/ 00083000
*       /* QUELOOP & QUELOOPX.                               @Z40LB01*/ 00084000
*       /*                                                           */ 00085000
*       /*************************************************************/ 00086000
*                                                                  0243 00087000
*       DO CWBIX=F1 TO F10;         /*                       @OZ30157*/ 00088000
QUELOOP  LA    @04,1                                               0243 00089000
         STH   @04,CWBIX                                           0243 00090000
@DL00243 DS    0H                                                  0244 00091000
*         FLAGS=''B;                /* CLEAR LOCAL FLAGS     @OZ24706*/ 00092000
         MVI   FLAGS,X'00'                                         0244 00093000
*         CONSOL=0;                 /* SET/RESET FOR WTO     @OZ24706*/ 00094000
*                                                                  0245 00095000
         SLR   @15,@15                                             0245 00096000
         ST    @15,CONSOL                                          0245 00097000
*         /***********************************************************/ 00098000
*         /*                                                         */ 00099000
*         /* SET CWBPTR FOR ADDRESSABILITY TO CWB            @Z40LB01*/ 00100000
*         /*                                                         */ 00101000
*         /***********************************************************/ 00102000
*                                                                  0246 00103000
*         IF CMDQUE(CWBIX)^=F0 THEN /* INSURE CWB IN SLOT    @ZA14724*/ 00104000
         SLA   @04,2                                               0246 00105000
         L     @14,@CA01311                                        0246 00106000
         AL    @14,@CF03609                                        0246 00107000
         L     @04,CMDQUE-CMDQUE(@04,@14)                          0246 00108000
         CR    @04,@15                                             0246 00109000
         BE    @RF00246                                            0246 00110000
*           DO;                     /* IF CWB DO             @ZA14724*/ 00111000
*             CWBPTR=CMDQUE(CWBIX); /*                       @OZ24706*/ 00112000
         L     @14,@CA00041                                        0248 00113000
         ST    @04,CWBPTR-CWBPTR(,@14)                             0248 00114000
*             IF DSPINP^=BONE THEN  /* WAS ALREADY IN PROC ? @ZA14724*/ 00115000
         TM    DSPINP(@04),B'00000001'                             0249 00116000
         BO    @RF00249                                            0249 00117000
*               DO;                 /* NO PROCESS IT         @ZA14724*/ 00118000
*                 RETC=F0;          /* CLEAR RETURN CODE     @OZ30157*/ 00119000
         STH   @15,RETC                                            0251 00120000
*                 DSPINP=BONE;      /* MARK IN PRCSS         @ZA14724*/ 00121000
         OI    DSPINP(@04),B'00000001'                             0252 00122000
*                 IF DSPOFFS^=F0 THEN/* SET DSPQUAL IF OFFSET      0253 00123000
*                                                            @OZ30157*/ 00124000
         CH    @15,DSPOFFS(,@04)                                   0253 00125000
         BE    @RF00253                                            0253 00126000
*                   DSPQUAL=BONE;   /* IS PRESENT            @OZ30157*/ 00127000
         OI    DSPQUAL(@04),B'00100000'                            0254 00128000
*                 IF DSPPATH=BONE|DSPALTM=BONE|DSPTRC=BONE|/*      0255 00129000
*                                                            @OZ30157*/ 00130000
*                     DSPMSVC=BONE|DSPQCB=BONE THEN/*        @OZ30157*/ 00131000
@RF00253 L     @04,@CA00041                                        0255 00132000
         L     @04,CWBPTR-CWBPTR(,@04)                             0255 00133000
         TM    DSPPATH(@04),B'00000001'                            0255 00134000
         BO    @RT00255                                            0255 00135000
         TM    DSPALTM(@04),B'00011110'                            0255 00136000
         BZ    @RF00255                                            0255 00137000
@RT00255 DS    0H                                                  0256 00138000
*                   DO;             /* SET CORRECT MSG FLAG  @OZ30157*/ 00139000
*                     DSPNEW=BONE;  /* AND INDICATE NEW OPS  @OZ30157*/ 00140000
         L     @04,@CA00041                                        0257 00141000
         L     @04,CWBPTR-CWBPTR(,@04)                             0257 00142000
         OI    DSPNEW(@04),B'01000000'                             0257 00143000
*                     IF DSPPATH=BONE THEN/* INSURE CORRECT PATH   0258 00144000
*                                                            @OZ30157*/ 00145000
         TM    DSPPATH(@04),B'00000001'                            0258 00146000
         BNO   @RF00258                                            0258 00147000
*                       DO;         /* AND CALL PATHS BUILD  @OZ30157*/ 00148000
*                         IF DSPCPU=BZERO&DSPSDG=BZERO&DSPDRC=BZERO     00149000
*                           THEN    /*                       @OZ30157*/ 00150000
         TM    DSPCPU(@04),B'00010010'                             0260 00151000
         BNZ   @RF00260                                            0260 00152000
         TM    DSPDRC(@04),B'10000000'                             0260 00153000
         BNZ   @RF00260                                            0260 00154000
*                           DO;     /* IF ALL OFF, SET ALL   @OZ30157*/ 00155000
*                             DSPCPU=BONE;/* ON TO INSURE    @OZ30157*/ 00156000
*                             DSPSDG=BONE;/* LIST ALL        @OZ30157*/ 00157000
         OI    DSPCPU(@04),B'00010010'                             0263 00158000
*                             DSPDRC=BONE;/* PATHS           @OZ30157*/ 00159000
         OI    DSPDRC(@04),B'10000000'                             0264 00160000
*                           END;    /*                       @OZ30157*/ 00161000
*                         CALL MSG56PA;/* DO PATHS BUILD     @OZ30157*/ 00162000
@RF00260 BAL   @14,MSG56PA                                         0266 00163000
*                       END;        /* END PATHS BUILD       @OZ30157*/ 00164000
*                     ELSE          /* IF NOT PATHS,         @OZ30157*/ 00165000
*                       IF DSPQCB=BONE THEN/* IF QCB DISPLAY @OZ30157*/ 00166000
         B     @RC00258                                            0268 00167000
@RF00258 L     @04,@CA00041                                        0268 00168000
         L     @04,CWBPTR-CWBPTR(,@04)                             0268 00169000
         TM    DSPQCB(@04),B'00000100'                             0268 00170000
         BNO   @RF00268                                            0268 00171000
*                         CALL MSG56QC;/* BUILD QCB TABLES   @OZ30157*/ 00172000
         BAL   @14,MSG56QC                                         0269 00173000
*                       ELSE                                       0270 00174000
*                         IF DSPTRC=BONE THEN/* IF TRACE, DO @OZ30157*/ 00175000
         B     @RC00268                                            0270 00176000
@RF00268 L     @04,@CA00041                                        0270 00177000
         L     @04,CWBPTR-CWBPTR(,@04)                             0270 00178000
         TM    DSPTRC(@04),B'00001000'                             0270 00179000
         BNO   @RF00270                                            0270 00180000
*                           DO;     /* QUERIES               @OZ30157*/ 00181000
*                             QAPTR(1)=ADDR(QUBUF1);/* FST QRY     0272 00182000
*                                      ADDRESS               @OZ30157*/ 00183000
         LA    @04,44                                              0272 00184000
         AL    @04,WORKPTR                                         0272 00185000
         ST    @04,QAPTR                                           0272 00186000
*                             QBCNT=F2;/* 2 QUERIES          @OZ30157*/ 00187000
         MVC   QBCNT(4),@CF00056                                   0273 00188000
*                             QBENT(1)=QBW57;/* NEED SECT 57 IN B1 0274 00189000
*                                                            @OZ30157*/ 00190000
         MVI   QBENT+12,C' '                                       0274 00191000
         MVC   QBENT+13(31),QBENT+12                               0274 00192000
         MVC   QBENT(12),QBW57                                     0274 00193000
*                             QBENT(2)=QBVER1;/* VERIFICATION TABLE     00194000
*                                                            @OZ30157*/ 00195000
         MVI   QBENT+56,C' '                                       0275 00196000
         MVC   QBENT+57(31),QBENT+56                               0275 00197000
         MVC   QBENT+44(12),QBVER1                                 0275 00198000
*                             QBINDX(2)=F2;/* IN BUFFER 2    @OZ30157*/ 00199000
         MVI   QBINDX+44,X'02'                                     0276 00200000
*                             CALL MSG56GQ;/* GET QUERY DATA @OZ30157*/ 00201000
         BAL   @14,MSG56GQ                                         0277 00202000
*                             IF RETC=F0 THEN/* IF QUERIES GOOD,   0278 00203000
*                                                            @OZ30157*/ 00204000
         LH    @04,RETC                                            0278 00205000
         LTR   @04,@04                                             0278 00206000
         BNZ   @RF00278                                            0278 00207000
*                               DO; /* THEN SET SWITCHES TO  @OZ30157*/ 00208000
*                                 VALSSID=BONE;/* CALL THE MSG56TR 0280 00209000
*                                                            @OZ30157*/ 00210000
*                                 VALCODE=BONE;/* MODULE IN THE    0281 00211000
*                                                            @OZ30157*/ 00212000
         OI    VALSSID,B'01001000'                                 0281 00213000
*                               END;/* NEXT SECTIONION       @OZ30157*/ 00214000
*                           END;    /* END TRACE QUERIES     @OZ30157*/ 00215000
*                         ELSE      /* IF NOT TRACE,         @OZ30157*/ 00216000
*                           DO;     /* MUST BE ALTMSC OR     @OZ30157*/ 00217000
         B     @RC00270                                            0284 00218000
@RF00270 DS    0H                                                  0285 00219000
*                             VALSSID=BONE;/* MSVC, SO SAY IS VALID     00220000
*                                                            @OZ30157*/ 00221000
*                             VALCODE=BONE;/* FOR LATER CALL TO    0286 00222000
*                                                            @OZ30157*/ 00223000
         OI    VALSSID,B'01001000'                                 0286 00224000
*                           END;    /* MSG56AL OR MSG56MS    @OZ30157*/ 00225000
*                   END;            /* END MSG BUILD NEW OPTS@OZ30157*/ 00226000
*                 ELSE              /* MUST BE ORD DISP      @OZ30157*/ 00227000
*                   DO;             /* START MSG92 ANALYSIS  @OZ30157*/ 00228000
*                                                                  0289 00229000
         B     @RC00255                                            0289 00230000
@RF00255 DS    0H                                                  0290 00231000
*                     /***********************************************/ 00232000
*                     /*                                             */ 00233000
*                     /* CLEAR REQUESTED BIT AND CHARACTER STRINGS   */ 00234000
*                     /*                                     @Z40LB01*/ 00235000
*                     /*                                             */ 00236000
*                     /***********************************************/ 00237000
*                                                                  0290 00238000
*                     REQBIT=''B;   /*                       @Z40LB01*/ 00239000
         XC    REQBIT(40),REQBIT                                   0290 00240000
*                     RNGCHAR(1:160)=''B;/*                  @Z40LB01*/ 00241000
         L     @04,WORKPTR                                         0291 00242000
         XC    RNGCHAR(160,@04),RNGCHAR(@04)                       0291 00243000
*                     RNGCHAR(161:320)=''B;/*                @Z40LB01*/ 00244000
*                                                                  0292 00245000
         XC    RNGCHAR+160(160,@04),RNGCHAR+160(@04)               0292 00246000
*                     /***********************************************/ 00247000
*                     /*                                             */ 00248000
*                     /* CLEAR STATUS AND REQUEST FLAGS FOR EACH CWB */ 00249000
*                     /*                                     @Z40LB01*/ 00250000
*                     /*                                             */ 00251000
*                     /***********************************************/ 00252000
*                                                                  0293 00253000
*                     REQFLG=''B;   /*                       @Z40LB01*/ 00254000
*                                                                  0293 00255000
         MVI   REQFLG,X'00'                                        0293 00256000
*                     /***********************************************/ 00257000
*                     /*                                             */ 00258000
*                     /* TEST FOR DISPLAY ALL AND SET THE APPROPRIATE*/ 00259000
*                     /*                                     @Z40LB01*/ 00260000
*                     /* VALUES IN THE REQCHAR ARRAY.        @OZ30157*/ 00261000
*                     /*                                             */ 00262000
*                     /***********************************************/ 00263000
*                                                                  0294 00264000
*                     IF DSPALL=BONE THEN/* TEST FOR REQUEST ALL   0294 00265000
*                                                            @Z40LB01*/ 00266000
         L     @15,@CA00041                                        0294 00267000
         L     @15,CWBPTR-CWBPTR(,@15)                             0294 00268000
         TM    DSPALL(@15),B'10000000'                             0294 00269000
         BNO   @RF00294                                            0294 00270000
*                       REQCHAR(1)=CONE;/* IF ON, SET FOR ONES     0295 00271000
*                                                            @OZ30157*/ 00272000
         MVC   REQCHAR+320(1,@04),CONE                             0295 00273000
*                     ELSE          /* IF OFF,               @OZ30157*/ 00274000
*                       REQCHAR(1)=''B;/* SET FOR NULLS      @OZ30157*/ 00275000
         B     @RC00294                                            0296 00276000
@RF00294 L     @04,WORKPTR                                         0296 00277000
         MVI   REQCHAR+320(@04),X'00'                              0296 00278000
*                     DO I=F2 TO F320;/* SET ARRAY TO ALL SAME     0297 00279000
*                                                            @OZ30157*/ 00280000
@RC00294 LA    @04,2                                               0297 00281000
         STH   @04,I                                               0297 00282000
@DL00297 DS    0H                                                  0298 00283000
*                       REQCHAR(I)=REQCHAR(1);/* EITHER NULL OR F0 0298 00284000
*                                                            @OZ30157*/ 00285000
         LA    @15,320                                             0298 00286000
         AL    @15,WORKPTR                                         0298 00287000
         ALR   @04,@15                                             0298 00288000
         BCTR  @04,0                                               0298 00289000
         MVC   @TS00001(1),REQCHAR(@15)                            0298 00290000
         MVC   REQCHAR(1,@04),@TS00001                             0298 00291000
*                     END;          /* END INITIALIZE        @OZ30157*/ 00292000
         LH    @15,I                                               0299 00293000
         AH    @15,@CH00047                                        0299 00294000
         LR    @04,@15                                             0299 00295000
         STH   @04,I                                               0299 00296000
         CH    @04,@CH01355                                        0299 00297000
         BNH   @DL00297                                            0299 00298000
*                                                                  0300 00299000
*                     /***********************************************/ 00300000
*                     /*                                             */ 00301000
*                     /* TEST TO SEE IF THE REQUEST IS FOR A SINGLE  */ 00302000
*                     /* SSID.                               @OZ30157*/ 00303000
*                     /* IF IT IS, SET THE APPROPRIATE REQBIT FOR THE*/ 00304000
*                     /* SSID.                               @Z40LB01*/ 00305000
*                     /*                                             */ 00306000
*                     /***********************************************/ 00307000
*                                                                  0300 00308000
*                     IF DSPSSID=BONE&DSPQUAL=BONE THEN/* SINGLE SSID   00309000
*                                      ?                     @OZ30157*/ 00310000
         L     @04,@CA00041                                        0300 00311000
         L     @04,CWBPTR-CWBPTR(,@04)                             0300 00312000
         TM    DSPSSID(@04),B'00000100'                            0300 00313000
         BNO   @RF00300                                            0300 00314000
         TM    DSPQUAL(@04),B'00100000'                            0300 00315000
         BNO   @RF00300                                            0300 00316000
*                       DO;         /* REQ FOR SINGLE SSID   @Z40LB01*/ 00317000
*                         QUALLEN(1)=F3;/* EXPECT 3 CHARACTERS     0302 00318000
*                                                            @OZ30157*/ 00319000
         MVC   QUALLEN(2),@CH00060                                 0302 00320000
*                         QUALLEN(2)=F0;/* IN ONE QUALIFIER  @OZ30157*/ 00321000
         SLR   @04,@04                                             0303 00322000
         STH   @04,QUALLEN+2                                       0303 00323000
*                         CALL MSG56QU;/*                    @OZ30157*/ 00324000
         BAL   @14,MSG56QU                                         0304 00325000
*                         IF RETC=F0 THEN/*                  @OZ30157*/ 00326000
         LH    @04,RETC                                            0305 00327000
         LTR   @04,@04                                             0305 00328000
         BNZ   @RF00305                                            0305 00329000
*                           DO I=F1 TO F320;/* SCAN TABL SSIDS     0306 00330000
*                                                            @Z40LB01*/ 00331000
         LA    @04,1                                               0306 00332000
         STH   @04,I                                               0306 00333000
@DL00306 DS    0H                                                  0307 00334000
*                             IF QUAL(1,1:3)=SSIDS(I) THEN/* MATCH 0307 00335000
*                                      FOUND                 @OZ30157*/ 00336000
         LR    @15,@04                                             0307 00337000
         MH    @15,@CH00060                                        0307 00338000
         LA    @14,SSIDS-3(@15)                                    0307 00339000
         CLC   QUAL(3),0(@14)                                      0307 00340000
         BNE   @RF00307                                            0307 00341000
*                               REQCHAR(I)=CONE;/* SET ITS REQBIT  0308 00342000
*                                                            @Z40LB01*/ 00343000
         L     @15,WORKPTR                                         0308 00344000
         ALR   @15,@04                                             0308 00345000
         MVC   REQCHAR+319(1,@15),CONE                             0308 00346000
*                           END;    /* END TABL SCAN         @Z40LB01*/ 00347000
@RF00307 LA    @04,1                                               0309 00348000
         AH    @04,I                                               0309 00349000
         STH   @04,I                                               0309 00350000
         CH    @04,@CH01355                                        0309 00351000
         BNH   @DL00306                                            0309 00352000
*                       END;        /* END SINGLE SSID CODE  @Z40LB01*/ 00353000
@RF00305 DS    0H                                                  0311 00354000
*                                                                  0311 00355000
*                     /***********************************************/ 00356000
*                     /*                                             */ 00357000
*                     /* IF REQUEST IS NOT FOR SINGLE SSID THEN TEST */ 00358000
*                     /* TO                                  @Z40LB01*/ 00359000
*                     /* SEE IF THE REQUEST IS FOR A SDG DISPLAY. IF */ 00360000
*                     /* THE                                 @Z40LB01*/ 00361000
*                     /* REQUEST IS FOR A SDG DISPLAY, THE SDG NUMBER*/ 00362000
*                     /*                                     @Z40LB01*/ 00363000
*                     /* HAS TO BE TRANSLATED TO BINARY TO USE IT FOR*/ 00364000
*                     /*                                     @Z40LB01*/ 00365000
*                     /* INDEXING INTO THE BIT ARRAYS TO SET THE     */ 00366000
*                     /* REQUEST                             @Z40LB01*/ 00367000
*                     /* BITS FOR ALL THE SSIDS IN THAT SDG. @Z40LB01*/ 00368000
*                     /*                                             */ 00369000
*                     /***********************************************/ 00370000
*                                                                  0311 00371000
*                     IF DSPSDG=BONE&DSPQUAL=BONE THEN/* SDG REQUEST    00372000
*                                      ?                     @OZ30157*/ 00373000
@RF00300 L     @04,@CA00041                                        0311 00374000
         L     @04,CWBPTR-CWBPTR(,@04)                             0311 00375000
         TM    DSPSDG(@04),B'00010000'                             0311 00376000
         BNO   @RF00311                                            0311 00377000
         TM    DSPQUAL(@04),B'00100000'                            0311 00378000
         BNO   @RF00311                                            0311 00379000
*                       DO;         /* REQUEST IS FOR SDG    @Z40LB01*/ 00380000
*                         INTER=''B;/* CLEAR CONV WORK AREA  @Z40LB01*/ 00381000
         L     @04,@CA01302                                        0313 00382000
         XC    INTER-INTER(4,@04),INTER-INTER(@04)                 0313 00383000
*                         QUALLEN(1)=F2;/* ONE QUALIFIER, 2  @OZ30157*/ 00384000
         MVC   QUALLEN(2),@CH00056                                 0314 00385000
*                         QUALLEN(2)=F0;/* BYTES LONG EXPECTED     0315 00386000
*                                                            @OZ30157*/ 00387000
         SLR   @04,@04                                             0315 00388000
         STH   @04,QUALLEN+2                                       0315 00389000
*                         CALL MSG56QU;/* GO GET IT          @OZ30157*/ 00390000
         BAL   @14,MSG56QU                                         0316 00391000
*                         IF RETC=F0 THEN/* IF GOOD VALUE,   @OZ30157*/ 00392000
         LH    @04,RETC                                            0317 00393000
         LTR   @04,@04                                             0317 00394000
         BNZ   @RF00317                                            0317 00395000
*                           DO;     /* CONVERT IT            @OZ30157*/ 00396000
*                             BYTES34=QUAL(1,1:2);/* MOVE IN SDG NO     00397000
*                                                            @OZ30157*/ 00398000
         L     @04,@CA01302                                        0319 00399000
         MVC   BYTES34-INTER(2,@04),QUAL                           0319 00400000
*                             PACK(INTER,BYTES34);/* PACK SDG NO   0320 00401000
*                                                            @Z40LB01*/ 00402000
         PACK  INTER-INTER(4,@04),BYTES34-INTER(2,@04)             0320 00403000
*                             CVB(SDGNO,BYTES34);/* CONVERT TO BINARY   00404000
*                                                            @Z40LB01*/ 00405000
         XC    @TS00001(8),@TS00001                                0321 00406000
         MVC   @TS00001+6(2),BYTES34-INTER(@04)                    0321 00407000
         CVB   @04,@TS00001                                        0321 00408000
         STH   @04,SDGNO                                           0321 00409000
*                             SDGNO=SDGNO+F1;/* ADD ONE FOR INDEXING    00410000
*                                                            @Z40LB01*/ 00411000
         LA    @15,1                                               0322 00412000
         ALR   @04,@15                                             0322 00413000
         STH   @04,SDGNO                                           0322 00414000
*                             IF SDGNO>=F1&SDGNO<=F28 THEN/* SDG NO     00415000
*                                      IN RANGE              @Z40LB01*/ 00416000
         CR    @04,@15                                             0323 00417000
         BL    @RF00323                                            0323 00418000
         CH    @04,@CH01339                                        0323 00419000
         BH    @RF00323                                            0323 00420000
*                               DO; /* SET REQUEST           @Z40LB01*/ 00421000
*                                 DO I=F1 TO F8;/* SCAN THIS SDG   0325 00422000
*                                                            @Z40LB01*/ 00423000
         STH   @15,I                                               0325 00424000
@DL00325 DS    0H                                                  0326 00425000
*                                   SDGCHR(SDGNO,I)=CONE;/* SET    0326 00426000
*                                      REQUESTED BITS        @Z40LB01*/ 00427000
         LH    @04,SDGNO                                           0326 00428000
         SLA   @04,3                                               0326 00429000
         ALR   @04,@15                                             0326 00430000
         L     @14,WORKPTR                                         0326 00431000
         ALR   @14,@04                                             0326 00432000
         MVC   SDGCHR+311(1,@14),CONE                              0326 00433000
*                                 END;/* END SDG SCAN        @Z40LB01*/ 00434000
         AH    @15,@CH00047                                        0327 00435000
         STH   @15,I                                               0327 00436000
         CH    @15,@CH00036                                        0327 00437000
         BNH   @DL00325                                            0327 00438000
*                               END;/* END SET REQUEST       @Z40LB01*/ 00439000
*                           END;    /* GOOD CONVERT          @OZ30157*/ 00440000
@RF00323 DS    0H                                                  0330 00441000
*                       END;        /* END SDG CODE          @Z40LB01*/ 00442000
@RF00317 DS    0H                                                  0331 00443000
*RNGDO:                             /* RANGE REQUEST LABEL   @Z40LB01*/ 00444000
*                                                                  0331 00445000
*                     /***********************************************/ 00446000
*                     /*                                             */ 00447000
*                     /* IF THE REQUEST IS NOT FOR SDG THEN IT MUST  */ 00448000
*                     /* BE                                  @Z40LB01*/ 00449000
*                     /* A RANGE DISPLAY. THE RANGE DISPLAY IS THE   */ 00450000
*                     /* MOST                                @Z40LB01*/ 00451000
*                     /* COMPLEX TO BREAK DOWN INTO THE VARIOUS TYPES*/ 00452000
*                     /*                                     @Z40LB01*/ 00453000
*                     /* AND SSIDS WHICH MUST BE DISPLAYED.  @Z40LB01*/ 00454000
*                     /*                                             */ 00455000
*                     /***********************************************/ 00456000
*                                                                  0331 00457000
*                     IF DSPRNG=BONE THEN/* TEST RANGE REQUEST     0331 00458000
*                                                            @Z40LB01*/ 00459000
@RF00311 DS    0H                                                  0331 00460000
RNGDO    L     @04,@CA00041                                        0331 00461000
         L     @04,CWBPTR-CWBPTR(,@04)                             0331 00462000
         TM    DSPRNG(@04),B'00001000'                             0331 00463000
         BNO   @RF00331                                            0331 00464000
*                       DO;         /* RANGE DISPLAY REQ     @Z40LB01*/ 00465000
*                                                                  0332 00466000
*                         /*******************************************/ 00467000
*                         /*                                         */ 00468000
*                         /* BUILD A TEMP TABLE OF SSID NAMES IN     */ 00469000
*                         /* ASCENDING                       @Z40LB01*/ 00470000
*                         /* NUMERIC SEQUENCE. THIS TABLE WILL BE    */ 00471000
*                         /* USED IN                         @Z40LB01*/ 00472000
*                         /* CONJUNCTION WITH THE RNGCHAR ARRAY TO   */ 00473000
*                         /* SET                             @Z40LB01*/ 00474000
*                         /* REQUESTED BITS FOR THE RANGE.   @Z40LB01*/ 00475000
*                         /*                                         */ 00476000
*                         /*******************************************/ 00477000
*                                                                  0333 00478000
*                         DTBDA1=SRTSDA1;/* GET DASD SSIDS   @OZ30157*/ 00479000
         LA    @04,640                                             0333 00480000
         AL    @04,WORKPTR                                         0333 00481000
         MVC   DTBDA1(224,@04),SRTSDA1                             0333 00482000
*                         DTBDA2=SRTSDA2;/* GET DASD SSIDS   @OZ30157*/ 00483000
         MVC   DTBDA2(224,@04),SRTSDA2                             0334 00484000
*                         DTBDA3=SRTSDA3;/* GET DASD SSIDS   @OZ30157*/ 00485000
         MVC   DTBDA3(224,@04),SRTSDA3                             0335 00486000
*                         DTBMSF=SRTMSFS;/* GET MSF SSIDS    @OZ30157*/ 00487000
         MVC   DTBMSF(24,@04),SRTMSFS                              0336 00488000
*                         DTBDRD=SRTDRDS;/* GET DRD SSIDS    @OZ30157*/ 00489000
         MVC   DTBDRD(96,@04),SRTDRDS                              0337 00490000
*                         DTBDRC=SRTDRCS;/* GET DRC SSIDS    @OZ30157*/ 00491000
         MVC   DTBDRC(48,@04),SRTDRCS                              0338 00492000
*                         DTBSA=SRTSAS;/* GET SA SSIDS       @OZ30157*/ 00493000
*                                                                  0339 00494000
         MVC   DTBSA(48,@04),SRTSAS                                0339 00495000
*                         /*******************************************/ 00496000
*                         /*                                         */ 00497000
*                         /* FIND INDEX FOR FIRST AND LAST SSID      */ 00498000
*                         /* REQUESTED                       @Z40LB01*/ 00499000
*                         /* IN THE OPERATOR COMMAND. USE THE START  */ 00500000
*                         /* AND                             @Z40LB01*/ 00501000
*                         /* END INCREMENTS AS LOOP CONTROL VALUES TO*/ 00502000
*                         /* SET                             @Z40LB01*/ 00503000
*                         /* THE PROPER REQUESTS.            @Z40LB01*/ 00504000
*                         /*                                         */ 00505000
*                         /*******************************************/ 00506000
*                                                                  0340 00507000
*                         STARTI=F0;/* SET FOR CMPLR WARNING @Z40LB01*/ 00508000
         SLR   @04,@04                                             0340 00509000
         STH   @04,STARTI                                          0340 00510000
*                         ENDI=F0;  /* SET FOR CMPLR WARNING @Z40LB01*/ 00511000
         STH   @04,ENDI                                            0341 00512000
*                         EXITSW=BZERO;/* CLEAR LOOP EXIT SW @Z40LB01*/ 00513000
         L     @04,@CA01294                                        0342 00514000
         NI    EXITSW-BITSW(@04),B'11110111'                       0342 00515000
*                         QUALLEN(1)=F3;/* NEED TWO QUALIFIERS,    0343 00516000
*                                                            @OZ30157*/ 00517000
         LA    @04,3                                               0343 00518000
         STH   @04,QUALLEN                                         0343 00519000
*                         QUALLEN(2)=F3;/* EACH 3 BYTES LONG @OZ30157*/ 00520000
         STH   @04,QUALLEN+2                                       0344 00521000
*                         CALL MSG56QU;/* GO GET THEM        @OZ30157*/ 00522000
         BAL   @14,MSG56QU                                         0345 00523000
*                         IF RETC=F0 THEN/* IF GOOD QUALIFIERS     0346 00524000
*                                                            @OZ30157*/ 00525000
         LH    @04,RETC                                            0346 00526000
         LTR   @04,@04                                             0346 00527000
         BNZ   @RF00346                                            0346 00528000
*                           DO;     /* THEN PROCESS RANGE REQ@OZ30157*/ 00529000
*                             CMPSSID1=QUAL(1,1:3);/* SET START SSID    00530000
*                                                            @OZ30157*/ 00531000
         MVC   CMPSSID1(3),QUAL                                    0348 00532000
*                             TR(CMPSSID1,TRANS);/* TRANSLATE ALPHAS    00533000
*                                                            @X50AC01*/ 00534000
         TR    CMPSSID1(3),TRANS                                   0349 00535000
*                             DO I=F1 TO F296 WHILE EXITSW=BZERO;/*     00536000
*                                      MATCH                 @Z40LB01*/ 00537000
         LA    @04,1                                               0350 00538000
         STH   @04,I                                               0350 00539000
@DL00350 L     @15,@CA01294                                        0350 00540000
         TM    EXITSW-BITSW(@15),B'00001000'                       0350 00541000
         BNZ   @DC00350                                            0350 00542000
*                               CMPSSID2=DSPSSIDS(I);/* SET ARRAY  0351 00543000
*                                      SSID                  @Z40LB01*/ 00544000
         LR    @14,@04                                             0351 00545000
         MH    @14,@CH00060                                        0351 00546000
         L     @03,WORKPTR                                         0351 00547000
         ALR   @03,@14                                             0351 00548000
         MVC   CMPSSID2(3),DSPSSIDS+637(@03)                       0351 00549000
*                               TR(CMPSSID2,TRANS);/* TRANSLATE    0352 00550000
*                                      ALPHAS                @Z40LB01*/ 00551000
         TR    CMPSSID2(3),TRANS                                   0352 00552000
*                               IF CMPSSID1<=CMPSSID2 THEN/* TEST  0353 00553000
*                                      MATCH                 @Z40LB01*/ 00554000
         CLC   CMPSSID1(3),CMPSSID2                                0353 00555000
         BH    @RF00353                                            0353 00556000
*                                 DO;/* MATCH FOUND          @Z40LB01*/ 00557000
*                                   STARTI=I;/* KEEP START INDEX   0355 00558000
*                                                            @Z40LB01*/ 00559000
         STH   @04,STARTI                                          0355 00560000
*                                   EXITSW=BONE;/* SET LOOP EXIT   0356 00561000
*                                                            @Z40LB01*/ 00562000
         OI    EXITSW-BITSW(@15),B'00001000'                       0356 00563000
*                                 END;/* END MATCH CODE      @Z40LB01*/ 00564000
*                             END;  /* END LOOP              @Z40LB01*/ 00565000
@RF00353 LA    @04,1                                               0358 00566000
         AH    @04,I                                               0358 00567000
         STH   @04,I                                               0358 00568000
         CH    @04,@CH01353                                        0358 00569000
         BNH   @DL00350                                            0358 00570000
@DC00350 DS    0H                                                  0359 00571000
*                             IF EXITSW=BZERO THEN/* STARTI SET ?  0359 00572000
*                                                            @Z40LB01*/ 00573000
         L     @04,@CA01294                                        0359 00574000
         TM    EXITSW-BITSW(@04),B'00001000'                       0359 00575000
         BNZ   @RF00359                                            0359 00576000
*                               STARTI=F320;/* SET TO LAST SSID    0360 00577000
*                                                            @Z40LB01*/ 00578000
         MVC   STARTI(2),@CH01355                                  0360 00579000
*                             EXITSW=BZERO;/* CLEAR LOOP EXIT SW   0361 00580000
*                                                            @Z40LB01*/ 00581000
@RF00359 L     @04,@CA01294                                        0361 00582000
         NI    EXITSW-BITSW(@04),B'11110111'                       0361 00583000
*                             CMPSSID1=QUAL(2,1:3);/* SET END SSID 0362 00584000
*                                                            @OZ30157*/ 00585000
         MVC   CMPSSID1(3),QUAL+11                                 0362 00586000
*                             TR(CMPSSID1,TRANS);/* TRANSLATE ALPHAS    00587000
*                                                            @Z40LB01*/ 00588000
         TR    CMPSSID1(3),TRANS                                   0363 00589000
*                             DO I=F296 TO F1 BY-1 WHILE(EXITSW=BZERO); 00590000
         LA    @04,296                                             0364 00591000
         STH   @04,I                                               0364 00592000
@DL00364 L     @15,@CA01294                                        0364 00593000
         TM    EXITSW-BITSW(@15),B'00001000'                       0364 00594000
         BNZ   @DC00364                                            0364 00595000
*                                   /*                       @OZ30157*/ 00596000
*                               CMPSSID2=DSPSSIDS(I);/* SET ARRAY  0365 00597000
*                                      SSID                  @Z40LB01*/ 00598000
         LR    @15,@04                                             0365 00599000
         MH    @15,@CH00060                                        0365 00600000
         L     @14,WORKPTR                                         0365 00601000
         ALR   @14,@15                                             0365 00602000
         MVC   CMPSSID2(3),DSPSSIDS+637(@14)                       0365 00603000
*                               TR(CMPSSID2,TRANS);/* TRANSLATE    0366 00604000
*                                      ALPHAS                @Z40LB01*/ 00605000
         TR    CMPSSID2(3),TRANS                                   0366 00606000
*                               IF CMPSSID1>=CMPSSID2 THEN/* TEST  0367 00607000
*                                      MATCH                 @OZ30157*/ 00608000
         CLC   CMPSSID1(3),CMPSSID2                                0367 00609000
         BL    @RF00367                                            0367 00610000
*                                 DO;/* MATCH FOUND          @Z40LB01*/ 00611000
*                                   IF CMPSSID1>CMPSSID2 THEN/* TEST    00612000
*                                      FOR LOW               @OZ30157*/ 00613000
         CLC   CMPSSID1(3),CMPSSID2                                0369 00614000
         BNH   @RF00369                                            0369 00615000
*                                    ENDI=I+F1;/* SET TO NEXT LOW  0370 00616000
*                                      SSID                  @OZ30157*/ 00617000
         LA    @04,1(,@04)                                         0370 00618000
         STH   @04,ENDI                                            0370 00619000
*                                   ELSE/* NOT LOW           @Z40LB01*/ 00620000
*                                    ENDI=I;/* SET TO CURRENT SSID 0371 00621000
*                                                            @Z40LB01*/ 00622000
         B     @RC00369                                            0371 00623000
@RF00369 MVC   ENDI(2),I                                           0371 00624000
*                                   EXITSW=BONE;/* SET LOOP EXIT   0372 00625000
*                                                            @Z40LB01*/ 00626000
@RC00369 L     @04,@CA01294                                        0372 00627000
         OI    EXITSW-BITSW(@04),B'00001000'                       0372 00628000
*                                 END;/* END MATCH CODE      @Z40LB01*/ 00629000
*                             END;  /* END LOOP              @Z40LB01*/ 00630000
@RF00367 SLR   @04,@04                                             0374 00631000
         BCTR  @04,0                                               0374 00632000
         AH    @04,I                                               0374 00633000
         STH   @04,I                                               0374 00634000
         LTR   @04,@04                                             0374 00635000
         BP    @DL00364                                            0374 00636000
@DC00364 DS    0H                                                  0375 00637000
*                             IF EXITSW=BZERO THEN/* END SSID TO   0375 00638000
*                                      GREAT                 @Z40LB01*/ 00639000
         L     @04,@CA01294                                        0375 00640000
         TM    EXITSW-BITSW(@04),B'00001000'                       0375 00641000
         BNZ   @RF00375                                            0375 00642000
*                               ENDI=F296;/* SET TO LAST SSID      0376 00643000
*                                                            @Z40LB01*/ 00644000
         MVC   ENDI(2),@CH01353                                    0376 00645000
*                             EXITSW=BZERO;/* CLEAR LOOP EXIT SW   0377 00646000
*                                                            @Z40LB01*/ 00647000
*                                                                  0377 00648000
@RF00375 L     @04,@CA01294                                        0377 00649000
         NI    EXITSW-BITSW(@04),B'11110111'                       0377 00650000
*                             /***************************************/ 00651000
*                             /*                                     */ 00652000
*                             /* USING THE START AND END INDEX SET   */ 00653000
*                             /* THE MATCHING                @Z40LB01*/ 00654000
*                             /* RNGCHAR                     @Z40LB01*/ 00655000
*                             /*                                     */ 00656000
*                             /***************************************/ 00657000
*                                                                  0378 00658000
*                             DO I=STARTI TO ENDI;/* LOOP START    0378 00659000
*                                                            @Z40LB01*/ 00660000
         LH    @04,STARTI                                          0378 00661000
         B     @DE00378                                            0378 00662000
@DL00378 DS    0H                                                  0379 00663000
*                               RNGCHAR(I)=CONE;/* SET RNGCHAR     0379 00664000
*                                                            @Z40LB01*/ 00665000
         L     @15,WORKPTR                                         0379 00666000
         ALR   @15,@04                                             0379 00667000
         BCTR  @15,0                                               0379 00668000
         MVC   RNGCHAR(1,@15),CONE                                 0379 00669000
*                             END;  /* LOOP END              @Z40LB01*/ 00670000
*                                                                  0380 00671000
         AH    @04,@CH00047                                        0380 00672000
@DE00378 STH   @04,I                                               0380 00673000
         CH    @04,ENDI                                            0380 00674000
         BNH   @DL00378                                            0380 00675000
*                             /***************************************/ 00676000
*                             /*                                     */ 00677000
*                             /* MOVE THE NUMERIC SEQUENCED RNGCHAR  */ 00678000
*                             /* TO THE MSC                  @Z40LB01*/ 00679000
*                             /* SEQUENCED REQCHAR STRUCTURE.        */ 00680000
*                             /*                             @Z40LB01*/ 00681000
*                             /*                                     */ 00682000
*                             /***************************************/ 00683000
*                                                                  0381 00684000
*                             SDGCHRA=SDGRNGA;/* SDG ELEMENTS      0381 00685000
*                                                            @OZ30157*/ 00686000
         L     @04,WORKPTR                                         0381 00687000
         LA    @15,320                                             0381 00688000
         ALR   @15,@04                                             0381 00689000
         MVI   SDGCHRA+224(@15),C' '                               0381 00690000
         MVC   SDGCHRA+225(15,@15),SDGCHRA+224(@15)                0381 00691000
         MVC   SDGCHRA(224,@15),SDGRNGA(@04)                       0381 00692000
*                             DRDCHRA=DRDRNGA;/* DRD ELEMENTS      0382 00693000
*                                                            @OZ30157*/ 00694000
         MVC   DRDCHRA(32,@15),DRDRNGA(@04)                        0382 00695000
*                             DRCCHRA=DRCRNGA;/* DRC ELEMENTS      0383 00696000
*                                                            @OZ30157*/ 00697000
         MVC   DRCCHRA(16,@15),DRCRNGA(@04)                        0383 00698000
*                             SACHRA=SARNGA;/* SA ELEMENTS   @OZ30157*/ 00699000
         MVC   SACHRA(16,@15),SARNGA(@04)                          0384 00700000
*                             MSFCHRA=MSFRNGA;/* MSF ELEMENT @OZ30157*/ 00701000
         MVC   MSFCHRA(8,@15),MSFRNGA(@04)                         0385 00702000
*                           END;    /* END GOOD QUALIFIERS   @OZ30157*/ 00703000
*RNGEND:                                                           0387 00704000
*                       END;        /* END RANGE REQUEST     @Z40LB01*/ 00705000
@RF00346 DS    0H                                                  0387 00706000
RNGEND   DS    0H                                                  0388 00707000
*                                                                  0388 00708000
*                     /***********************************************/ 00709000
*                     /*                                             */ 00710000
*                     /* AT THIS POINT THE REQCHAR ARRAY HAS ALL THE */ 00711000
*                     /*                                     @Z40LB01*/ 00712000
*                     /* REQUESTED SSIDS IN THE COMMAND SPECIFIED BY */ 00713000
*                     /*                                     @Z40LB01*/ 00714000
*                     /* THE OPERATOR. NOW WE HAVE TO CONVERT THIS   */ 00715000
*                     /*                                     @Z40LB01*/ 00716000
*                     /* CHARACTER ARRAY TO A BIT ARRAY SO THE       */ 00717000
*                     /*                                     @Z40LB01*/ 00718000
*                     /* REQUESTS CAN BE COORDINATED WITH THE MSG92  */ 00719000
*                     /*                                     @Z40LB01*/ 00720000
*                     /* DATA.                               @Z40LB01*/ 00721000
*                     /*                                             */ 00722000
*                     /***********************************************/ 00723000
*                                                                  0388 00724000
*                     DO I=F1 TO F40;/* BYTE LOOP            @Z40LB01*/ 00725000
@RF00331 LA    @04,1                                               0388 00726000
         STH   @04,I                                               0388 00727000
@DL00388 DS    0H                                                  0389 00728000
*                       DO K=F1 TO F8;/* BIT LOOP            @Z40LB01*/ 00729000
         LA    @04,1                                               0389 00730000
         STH   @04,K                                               0389 00731000
@DL00389 DS    0H                                                  0390 00732000
*                         IF REQCHAR((I-1)*8+K)=CONE THEN/*  @Z40LB01*/ 00733000
         LH    @15,I                                               0390 00734000
         LR    @14,@15                                             0390 00735000
         BCTR  @14,0                                               0390 00736000
         SLA   @14,3                                               0390 00737000
         ALR   @14,@04                                             0390 00738000
         L     @03,WORKPTR                                         0390 00739000
         ALR   @03,@14                                             0390 00740000
         CLC   REQCHAR+319(1,@03),CONE                             0390 00741000
         BNE   @RF00390                                            0390 00742000
*                           RBIT(I)=(RBIT(I)|CONFGMSK(K));/* @Z40LB01*/ 00743000
         LA    @14,RBIT-1(@15)                                     0391 00744000
         L     @15,@CA01312                                        0391 00745000
         ALR   @15,@04                                             0391 00746000
         BCTR  @15,0                                               0391 00747000
         OC    0(1,@14),CONFGMSK-CONFGMSK(@15)                     0391 00748000
*                       END;        /* END BIT LOOP          @Z40LB01*/ 00749000
@RF00390 LA    @04,1                                               0392 00750000
         AH    @04,K                                               0392 00751000
         STH   @04,K                                               0392 00752000
         CH    @04,@CH00036                                        0392 00753000
         BNH   @DL00389                                            0392 00754000
*                     END;          /* END BYTE LOOP         @Z40LB01*/ 00755000
*                                                                  0393 00756000
         LA    @04,1                                               0393 00757000
         AH    @04,I                                               0393 00758000
         STH   @04,I                                               0393 00759000
         CH    @04,@CH01344                                        0393 00760000
         BNH   @DL00388                                            0393 00761000
*                     /***********************************************/ 00762000
*                     /*                                             */ 00763000
*                     /* REQUEST BITS AS SET NOW INCLUDE ALL SSIDS   */ 00764000
*                     /*                                     @Z40LB01*/ 00765000
*                     /* REQUESTED IN THE OPERATOR COMMAND. THE      */ 00766000
*                     /* REQUEST                             @Z40LB01*/ 00767000
*                     /* BITS MUST BE MATCHED AGAINST THE MSC EXIST  */ 00768000
*                     /* BITS                                @Z40LB01*/ 00769000
*                     /* AND ANY REQUESTED BUT NOT VALID MUST BE     */ 00770000
*                     /* RESET                               @Z40LB01*/ 00771000
*                     /* TO ZERO.                            @Z40LB01*/ 00772000
*                     /*                                             */ 00773000
*                     /***********************************************/ 00774000
*                                                                  0394 00775000
*                     REQBIT=(REQBIT&EXISTARY);/*            @Z40LB01*/ 00776000
*                                                                  0394 00777000
         L     @04,@CA01293                                        0394 00778000
         LA    @15,2                                               0394 00779000
         AL    @15,MSGPTR-MSGPTR(,@04)                             0394 00780000
         NC    REQBIT(40),EXISTARY(@15)                            0394 00781000
*                     /***********************************************/ 00782000
*                     /*                                             */ 00783000
*                     /* REQUEST BITS AS SET NOW INCLUDE ALL         */ 00784000
*                     /* REQUESTED                           @Z40LB01*/ 00785000
*                     /* AND VALID. IF THE DISPLAY COMMAND REQUESTED */ 00786000
*                     /*                                     @Z40LB01*/ 00787000
*                     /* ONLY ONLINE UNITS, THE REQUEST BITS MUST NOW*/ 00788000
*                     /*                                     @Z40LB01*/ 00789000
*                     /* BE MATCHED AGAINST THE MSC ONLINE BITS AND  */ 00790000
*                     /*                                     @Z40LB01*/ 00791000
*                     /* ANY OF THE REQUEST BITS WHICH ARE NOT ONLINE*/ 00792000
*                     /*                                     @Z40LB01*/ 00793000
*                     /* MUST BE RESET TO ZERO.              @Z40LB01*/ 00794000
*                     /*                                             */ 00795000
*                     /***********************************************/ 00796000
*                                                                  0395 00797000
*                     IF DSPON=BONE THEN/*                   @Z40LB01*/ 00798000
         L     @04,@CA00041                                        0395 00799000
         L     @04,CWBPTR-CWBPTR(,@04)                             0395 00800000
         TM    DSPON(@04),B'01000000'                              0395 00801000
         BNO   @RF00395                                            0395 00802000
*                       REQBIT=(REQBIT&ONLINARY);/*          @Z40LB01*/ 00803000
*                                                                  0396 00804000
         NC    REQBIT(40),ONLINARY(@15)                            0396 00805000
*                     /***********************************************/ 00806000
*                     /*                                             */ 00807000
*                     /* OFFLINE IS MUTUALLY EXCLUSIVE OF ONLINE AND */ 00808000
*                     /* IF                                  @OZ30157*/ 00809000
*                     /* THE DISPLAY REQUEST WAS FOR ONLY OFFLINE    */ 00810000
*                     /* UNITS,                              @Z40LB01*/ 00811000
*                     /* THE REQUEST BITS WILL STILL INCLUDE THE     */ 00812000
*                     /* REQUESTED                           @Z40LB01*/ 00813000
*                     /* AND VALID SSIDS. IF OFFLINE ONLY WAS        */ 00814000
*                     /* REQUESTED,                          @Z40LB01*/ 00815000
*                     /* THE REQUEST BITS ARE EXCLUSIVELY OR'D WITH  */ 00816000
*                     /* THE                                 @OZ30157*/ 00817000
*                     /* MSC ONLINE BITS TO REDUCE THE REQUESTS TO   */ 00818000
*                     /* ONLY                                @Z40LB01*/ 00819000
*                     /* THOSE REQUESTED WHICH ARE NOT ONLINE.       */ 00820000
*                     /*                                     @Z40LB01*/ 00821000
*                     /*                                             */ 00822000
*                     /***********************************************/ 00823000
*                                                                  0397 00824000
*                     IF DSPOFF=BONE THEN/*                  @Z40LB01*/ 00825000
@RF00395 L     @04,@CA00041                                        0397 00826000
         L     @04,CWBPTR-CWBPTR(,@04)                             0397 00827000
         TM    DSPOFF(@04),B'00100000'                             0397 00828000
         BNO   @RF00397                                            0397 00829000
*                       DO;         /*                       @Z40LB01*/ 00830000
*                         OFFMASK=(ONLINARY&REQBIT);/*       @Z40LB01*/ 00831000
         L     @04,@CA01293                                        0399 00832000
         L     @04,MSGPTR-MSGPTR(,@04)                             0399 00833000
         MVC   OFFMASK(40),ONLINARY+2(@04)                         0399 00834000
         NC    OFFMASK(40),REQBIT                                  0399 00835000
*                         REQBIT=(REQBIT&&OFFMASK);/*        @Z40LB01*/ 00836000
         XC    REQBIT(40),OFFMASK                                  0400 00837000
*                       END;        /*                       @Z40LB01*/ 00838000
*                                                                  0401 00839000
*                     /***********************************************/ 00840000
*                     /*                                             */ 00841000
*                     /* PROCESSING OF THIS DISPLAY REQUEST FROM HERE*/ 00842000
*                     /* CAN                                 @Z40LB01*/ 00843000
*                     /* BE CONTROLLED BY REQUEST BITS AS THEY ARE   */ 00844000
*                     /* NOW                                 @Z40LB01*/ 00845000
*                     /* SET.                                @Z40LB01*/ 00846000
*                     /*                                             */ 00847000
*                     /***********************************************/ 00848000
*                                                                  0402 00849000
*                                                                  0402 00850000
*                     /***********************************************/ 00851000
*                     /*                                             */ 00852000
*                     /* TO BYPASS SOME CODE IF NOT REQUIRED, DO A   */ 00853000
*                     /* SCAN                                @Z40LB01*/ 00854000
*                     /* OF THE FINAL REQUEST BITS TO SEE IF ANY ARE */ 00855000
*                     /*                                     @Z40LB01*/ 00856000
*                     /* STILL SET. IF THERE ARE NONE THEN THE REST  */ 00857000
*                     /*                                     @Z40LB01*/ 00858000
*                     /* OF THE PROCESSING FOR THIS CWB CAN BE       */ 00859000
*                     /* BYPASSED.                           @Z40LB01*/ 00860000
*                     /*                                             */ 00861000
*                     /***********************************************/ 00862000
*                                                                  0402 00863000
*                     DO I=F1 TO F4;/*                       @Z40LB01*/ 00864000
@RF00397 LA    @04,1                                               0402 00865000
         STH   @04,I                                               0402 00866000
@DL00402 DS    0H                                                  0403 00867000
*                       IF RBIT(I)^=F0 THEN/*                @Z40LB01*/ 00868000
         SLR   @00,@00                                             0403 00869000
         IC    @00,RBIT-1(@04)                                     0403 00870000
         CH    @00,@CH00226                                        0403 00871000
         BE    @RF00403                                            0403 00872000
*                         DRDFLG=BONE;/*                     @Z40LB01*/ 00873000
         OI    DRDFLG,B'00100000'                                  0404 00874000
*                     END;          /*                       @Z40LB01*/ 00875000
@RF00403 LA    @04,1                                               0405 00876000
         AH    @04,I                                               0405 00877000
         STH   @04,I                                               0405 00878000
         CH    @04,@CH00045                                        0405 00879000
         BNH   @DL00402                                            0405 00880000
*                     DO I=F5 TO F6;/*                       @Z40LB01*/ 00881000
         LA    @04,5                                               0406 00882000
         STH   @04,I                                               0406 00883000
@DL00406 DS    0H                                                  0407 00884000
*                       IF RBIT(I)^=F0 THEN/*                @Z40LB01*/ 00885000
         SLR   @00,@00                                             0407 00886000
         IC    @00,RBIT-1(@04)                                     0407 00887000
         CH    @00,@CH00226                                        0407 00888000
         BE    @RF00407                                            0407 00889000
*                         SAFLG=BONE;/*                      @Z40LB01*/ 00890000
         OI    SAFLG,B'00001000'                                   0408 00891000
*                     END;          /*                       @Z40LB01*/ 00892000
@RF00407 LA    @04,1                                               0409 00893000
         AH    @04,I                                               0409 00894000
         STH   @04,I                                               0409 00895000
         CH    @04,@CH00038                                        0409 00896000
         BNH   @DL00406                                            0409 00897000
*                     DO I=F7 TO F8;/*                       @Z40LB01*/ 00898000
         LA    @04,7                                               0410 00899000
         STH   @04,I                                               0410 00900000
@DL00410 DS    0H                                                  0411 00901000
*                       IF RBIT(I)^=F0 THEN/*                @Z40LB01*/ 00902000
         SLR   @00,@00                                             0411 00903000
         IC    @00,RBIT-1(@04)                                     0411 00904000
         CH    @00,@CH00226                                        0411 00905000
         BE    @RF00411                                            0411 00906000
*                         DRCFLG=BONE;/*                     @Z40LB01*/ 00907000
         OI    DRCFLG,B'00010000'                                  0412 00908000
*                     END;          /*                       @Z40LB01*/ 00909000
@RF00411 LA    @04,1                                               0413 00910000
         AH    @04,I                                               0413 00911000
         STH   @04,I                                               0413 00912000
         CH    @04,@CH00036                                        0413 00913000
         BNH   @DL00410                                            0413 00914000
*                     EXITSW=BZERO; /*                       @Z40LB01*/ 00915000
         L     @04,@CA01294                                        0414 00916000
         NI    EXITSW-BITSW(@04),B'11110111'                       0414 00917000
*                     DO I=F9 TO F36 WHILE EXITSW=BZERO;/*   @Z40LB01*/ 00918000
         LA    @04,9                                               0415 00919000
         STH   @04,I                                               0415 00920000
@DL00415 L     @15,@CA01294                                        0415 00921000
         TM    EXITSW-BITSW(@15),B'00001000'                       0415 00922000
         BNZ   @DC00415                                            0415 00923000
*                       IF RBIT(I)^=F0 THEN/*                @Z40LB01*/ 00924000
         SLR   @00,@00                                             0416 00925000
         IC    @00,RBIT-1(@04)                                     0416 00926000
         CH    @00,@CH00226                                        0416 00927000
         BE    @RF00416                                            0416 00928000
*                         DO;       /*                       @Z40LB01*/ 00929000
*                           SDGFLG=BONE;/*                   @Z40LB01*/ 00930000
         OI    SDGFLG,B'10000000'                                  0418 00931000
*                           EXITSW=BONE;/*                   @Z40LB01*/ 00932000
         OI    EXITSW-BITSW(@15),B'00001000'                       0419 00933000
*                         END;      /*                       @Z40LB01*/ 00934000
*                     END;          /*                       @Z40LB01*/ 00935000
@RF00416 LA    @04,1                                               0421 00936000
         AH    @04,I                                               0421 00937000
         STH   @04,I                                               0421 00938000
         CH    @04,@CH01342                                        0421 00939000
         BNH   @DL00415                                            0421 00940000
@DC00415 DS    0H                                                  0422 00941000
*                     EXITSW=BZERO; /*                       @Z40LB01*/ 00942000
         L     @04,@CA01294                                        0422 00943000
         NI    EXITSW-BITSW(@04),B'11110111'                       0422 00944000
*                     IF RBIT(F40)^=F0 THEN/*                @Z40LB01*/ 00945000
         CLI   RBIT+39,0                                           0423 00946000
         BE    @RF00423                                            0423 00947000
*                       MSFFLG=BONE;/*                       @Z40LB01*/ 00948000
         OI    MSFFLG,B'01000000'                                  0424 00949000
*                     IF DRDFLG=BONE|SAFLG=BONE|DRCFLG=BONE|/*     0425 00950000
*                                                            @Z40LB01*/ 00951000
*                         SDGFLG=BONE|MSFFLG=BONE THEN/*     @Z40LB01*/ 00952000
@RF00423 TM    DRDFLG,B'11111000'                                  0425 00953000
         BZ    @RF00425                                            0425 00954000
*                       DO;         /* WE HAVE VALID REQ     @Z40LB01*/ 00955000
*                         VALSSID=BONE;/* SET VALID REQ FLAG @Z40LB01*/ 00956000
*                         VALCODE=BONE;/* VALID CODE PROCESS @Z40LB01*/ 00957000
         OI    VALSSID,B'01001000'                                 0428 00958000
*                       END;        /* END HAVE VALID REQ    @Z40LB01*/ 00959000
*                   END;            /* END MSG92 ANALYSIS    @OZ30157*/ 00960000
@RF00425 DS    0H                                                  0431 00961000
*                                                                  0431 00962000
*                 /***************************************************/ 00963000
*                 /*                                                 */ 00964000
*                 /* IF THE VALID CODE FLAG (VALCODE) IS SET THEN    */ 00965000
*                 /*                                         @Z40LB01*/ 00966000
*                 /* PROCESSING OF THIS CWB MUST CONTINUE. IF NOT,   */ 00967000
*                 /*                                         @Z40LB01*/ 00968000
*                 /* THE REMAINING CODE FOR THIS CWB IS BYPASSED.    */ 00969000
*                 /*                                         @Z40LB01*/ 00970000
*                 /* THIS CODE IS IDENTIFIED BY LABEL VALPROC AND    */ 00971000
*                 /*                                         @Z40LB01*/ 00972000
*                 /* VALPROCX.                               @Z40LB01*/ 00973000
*                 /*                                                 */ 00974000
*                 /***************************************************/ 00975000
*                                                                  0431 00976000
*                 IF VALCODE=BONE THEN/*                     @Z40LB01*/ 00977000
@RC00255 TM    VALCODE,B'00001000'                                 0431 00978000
         BNO   @RF00431                                            0431 00979000
*VALPROC:                           /*                       @Z40LB01*/ 00980000
*                   DO;             /*                       @Z40LB01*/ 00981000
VALPROC  DS    0H                                                  0433 00982000
*                     RETC=F0;      /* INSURE GOOD RET CODE  @OZ30157*/ 00983000
         SLR   @04,@04                                             0433 00984000
         STH   @04,RETC                                            0433 00985000
*                     CALL MSG56E;  /* CALL MSG START SUB    @OZ24706*/ 00986000
*                                                                  0434 00987000
         BAL   @14,MSG56E                                          0434 00988000
*                     /***********************************************/ 00989000
*                     /*                                             */ 00990000
*                     /* HEADER LINES NEED TO BE BUILT IN THE        */ 00991000
*                     /*                                     @Z40LB01*/ 00992000
*                     /* MULTI LINE BUFFER BEFORE ISSUANCE   @Z40LB01*/ 00993000
*                     /* OF THE ML WTO. THE CODE FOR THIS FUNCTION   */ 00994000
*                     /*                                     @Z40LB01*/ 00995000
*                     /* IS PUT IN SUBROUTINE MSG56A.        @Z40LB01*/ 00996000
*                     /* ON RETURN FROM MSG56A, THE WPLPTR IS SET    */ 00997000
*                     /*                                     @Z40LB01*/ 00998000
*                     /* TO POINT TO THE FIRST DATA LINE FOR THE     */ 00999000
*                     /*                                     @Z40LB01*/ 01000000
*                     /* DISPLAY.                            @Z40LB01*/ 01001000
*                     /*                                             */ 01002000
*                     /***********************************************/ 01003000
*                                                                  0435 01004000
*                     MSGIND=MSG05603;/* SET DEFAULT MESSAGE @OZ30157*/ 01005000
         MVI   MSGIND,X'13'                                        0435 01006000
*                     IF DSPCPU=BONE THEN/* IF CPU PATHS OPER.     0436 01007000
*                                                            @OZ30157*/ 01008000
         L     @04,@CA00041                                        0436 01009000
         L     @04,CWBPTR-CWBPTR(,@04)                             0436 01010000
         TM    DSPCPU(@04),B'00000010'                             0436 01011000
         BNO   @RF00436                                            0436 01012000
*                       MSGIND=MSG05608;/* SET FOR THAT MSG  @OZ30157*/ 01013000
         MVI   MSGIND,X'2C'                                        0437 01014000
*                     ELSE          /*                       @OZ30157*/ 01015000
*                       IF DSPSDG=BONE THEN/* IF SDG PATHS   @OZ30157*/ 01016000
         B     @RC00436                                            0438 01017000
@RF00436 L     @04,@CA00041                                        0438 01018000
         L     @04,CWBPTR-CWBPTR(,@04)                             0438 01019000
         TM    DSPSDG(@04),B'00010000'                             0438 01020000
         BNO   @RF00438                                            0438 01021000
*                         MSGIND=MSG05610;/* SET FIRST LINE  @OZ30157*/ 01022000
         MVI   MSGIND,X'2E'                                        0439 01023000
*                       ELSE        /*                       @OZ30157*/ 01024000
*                         IF DSPDRC=BONE THEN/* IF DRC PATHS @OZ30157*/ 01025000
         B     @RC00438                                            0440 01026000
@RF00438 L     @04,@CA00041                                        0440 01027000
         L     @04,CWBPTR-CWBPTR(,@04)                             0440 01028000
         TM    DSPDRC(@04),B'10000000'                             0440 01029000
         BNO   @RF00440                                            0440 01030000
*                           MSGIND=MSG05612;/* SET TO DRC LINE     0441 01031000
*                                                            @OZ30157*/ 01032000
         MVI   MSGIND,X'30'                                        0441 01033000
*                         ELSE      /*                       @OZ30157*/ 01034000
*                           IF DSPQCB=BONE THEN/* IF ERR QCB REQUEST    01035000
*                                                            @OZ30157*/ 01036000
         B     @RC00440                                            0442 01037000
@RF00440 L     @04,@CA00041                                        0442 01038000
         L     @04,CWBPTR-CWBPTR(,@04)                             0442 01039000
         TM    DSPQCB(@04),B'00000100'                             0442 01040000
         BNO   @RF00442                                            0442 01041000
*                             MSGIND=MSG05614;/* THEN SET THAT ONE 0443 01042000
*                                                            @OZ30157*/ 01043000
         MVI   MSGIND,X'32'                                        0443 01044000
*                           ELSE    /*                       @OZ30157*/ 01045000
*                             IF DSPMSVC=BONE THEN/* IF MSVC REQUEST    01046000
*                                                            @OZ30157*/ 01047000
         B     @RC00442                                            0444 01048000
@RF00442 L     @04,@CA00041                                        0444 01049000
         L     @04,CWBPTR-CWBPTR(,@04)                             0444 01050000
         TM    DSPMSVC(@04),B'00010000'                            0444 01051000
         BNO   @RF00444                                            0444 01052000
*                               MSGIND=MSG05616;/*           @OZ30157*/ 01053000
         MVI   MSGIND,X'34'                                        0445 01054000
*                             ELSE  /*                       @OZ30157*/ 01055000
*                               IF DSPTRC=BONE THEN/* IF TRACE     0446 01056000
*                                      REQUEST               @OZ30157*/ 01057000
         B     @RC00444                                            0446 01058000
@RF00444 L     @04,@CA00041                                        0446 01059000
         L     @04,CWBPTR-CWBPTR(,@04)                             0446 01060000
         TM    DSPTRC(@04),B'00001000'                             0446 01061000
         BNO   @RF00446                                            0446 01062000
*                                 MSGIND=MSG05618;/*         @OZ30157*/ 01063000
         MVI   MSGIND,X'36'                                        0447 01064000
*                               ELSE/*                       @OZ30157*/ 01065000
*                                 IF DSPALTM=BONE THEN/* IF ALTMSC 0448 01066000
*                                      REQUEST               @OZ30157*/ 01067000
         B     @RC00446                                            0448 01068000
@RF00446 L     @04,@CA00041                                        0448 01069000
         L     @04,CWBPTR-CWBPTR(,@04)                             0448 01070000
         TM    DSPALTM(@04),B'00000010'                            0448 01071000
         BNO   @RF00448                                            0448 01072000
*                                   MSGIND=MSG05620;/*       @OZ30157*/ 01073000
         MVI   MSGIND,X'38'                                        0449 01074000
*                                 ELSE                             0450 01075000
*                                   ;/*                      @OZ30157*/ 01076000
@RF00448 DS    0H                                                  0451 01077000
*                     CALL MSG56AA; /* CALL MSG BUILD SUB    @OZ30157*/ 01078000
@RC00446 DS    0H                                                  0451 01079000
@RC00444 DS    0H                                                  0451 01080000
@RC00442 DS    0H                                                  0451 01081000
@RC00440 DS    0H                                                  0451 01082000
@RC00438 DS    0H                                                  0451 01083000
@RC00436 BAL   @14,MSG56AA                                         0451 01084000
*                     IF DSPNEW=BZERO THEN/* IF NOT NEW TYPE @OZ30157*/ 01085000
         L     @04,@CA00041                                        0452 01086000
         L     @04,CWBPTR-CWBPTR(,@04)                             0452 01087000
         TM    DSPNEW(@04),B'01000000'                             0452 01088000
         BNZ   @RF00452                                            0452 01089000
*                       DO;         /* DO ORIGINAL LOGIC     @OZ30157*/ 01090000
*                                                                  0453 01091000
*                         /*******************************************/ 01092000
*                         /*                                         */ 01093000
*                         /* SET WPLPTR TO NEXT LINE (DATA LINE) AND */ 01094000
*                         /* MOVE IN THE                     @ZA14724*/ 01095000
*                         /* DATA LINE SKELETON.             @ZA14724*/ 01096000
*                         /*                                         */ 01097000
*                         /*******************************************/ 01098000
*                                                                  0454 01099000
*                         MSGIND=MSG05606;/* IND. MESSAGE TYPE     0454 01100000
*                                                            @OZ30157*/ 01101000
         MVI   MSGIND,X'16'                                        0454 01102000
*                         WPLPTR=WPLPTR+WPLMLLEN;/* UP BY HDR 2    0455 01103000
*                                      LENGTH                @OZ30157*/ 01104000
         L     @04,WPLPTR                                          0455 01105000
         SLR   @00,@00                                             0455 01106000
         IC    @00,WPLMLLEN(,@04)                                  0455 01107000
         ALR   @00,@04                                             0455 01108000
         ST    @00,WPLPTR                                          0455 01109000
*                         WPLMLLTF=''B;/* CLEAR FLAG FIELD   @OZ30157*/ 01110000
         LR    @04,@00                                             0456 01111000
         XC    WPLMLLTF(2,@04),WPLMLLTF(@04)                       0456 01112000
*                         WPLMLTXT=MESGS(MSG05606);/* DATA LINE    0457 01113000
*                                      SKELETON@ZA14724              */ 01114000
*                                                                  0457 01115000
         LR    @04,@00                                             0457 01116000
         MVI   WPLMLTXT+72(@04),C' '                               0457 01117000
         MVC   WPLMLTXT+73(53,@04),WPLMLTXT+72(@04)                0457 01118000
         MVC   WPLMLTXT(72,@04),MESGS+1596                         0457 01119000
*                         /*******************************************/ 01120000
*                         /*                                         */ 01121000
*                         /* TEST TO SEE IF THERE ARE ANY SDG DASD   */ 01122000
*                         /* SSIDS                           @Z40LB01*/ 01123000
*                         /* WHICH NEED TO BE DISPLAYED AND IF SO,   */ 01124000
*                         /*                                 @Z40LB01*/ 01125000
*                         /* PROCESS THESE FIRST.            @Z40LB01*/ 01126000
*                         /*                                         */ 01127000
*                         /*******************************************/ 01128000
*                                                                  0458 01129000
*                         IF SDGFLG=BONE THEN/*              @Z40LB01*/ 01130000
         TM    SDGFLG,B'10000000'                                  0458 01131000
         BNO   @RF00458                                            0458 01132000
*                           DO;     /*                       @Z40LB01*/ 01133000
*                                                                  0459 01134000
*                             /***************************************/ 01135000
*                             /*                                     */ 01136000
*                             /* SUBROUTINE MSG56B READS THE MSC PAB */ 01137000
*                             /*                             @Z40LB01*/ 01138000
*                             /* FOR EACH SDG AND BUILDS A TABLE OF  */ 01139000
*                             /*                             @Z40LB01*/ 01140000
*                             /* DASD SSID STATUS FOR EACH REQUESTED */ 01141000
*                             /*                             @Z40LB01*/ 01142000
*                             /* DASD SSID.                  @Z40LB01*/ 01143000
*                             /*                                     */ 01144000
*                             /***************************************/ 01145000
*                                                                  0460 01146000
*                             CALL MSG56B;/*                 @Z40LB01*/ 01147000
*                                                                  0460 01148000
         BAL   @14,MSG56B                                          0460 01149000
*                             /***************************************/ 01150000
*                             /*                                     */ 01151000
*                             /* USING THE TABLE BUILT BY MSG56B AND */ 01152000
*                             /* THE                         @Z40LB01*/ 01153000
*                             /* REQUEST BIT STRUCTURES, MESSAGE     */ 01154000
*                             /* LINES                       @Z40LB01*/ 01155000
*                             /* ARE BUILT IN THE ML WTO BUFFER AND  */ 01156000
*                             /*                             @Z40LB01*/ 01157000
*                             /* WHEN THE BUFFER IS FULL, ISSUE THE  */ 01158000
*                             /*                             @Z40LB01*/ 01159000
*                             /* MLWTO MACRO.                @Z40LB01*/ 01160000
*                             /*                                     */ 01161000
*                             /***************************************/ 01162000
*                                                                  0461 01163000
*                             CALL SDGMSGS;/* CALL DASD MSG BLD    0461 01164000
*                                                            @Z40LB01*/ 01165000
         BAL   @14,SDGMSGS                                         0461 01166000
*                           END;    /* END SDG CODE          @Z40LB01*/ 01167000
*                                                                  0463 01168000
*                         /*******************************************/ 01169000
*                         /*                                         */ 01170000
*                         /* TEST IF ANY MSF SSIDS WERE REQUESTED IN */ 01171000
*                         /* THE                             @Z40LB01*/ 01172000
*                         /* DISPLAY COMMAND                 @Z40LB01*/ 01173000
*                         /*                                         */ 01174000
*                         /*******************************************/ 01175000
*                                                                  0463 01176000
*                         IF MSFFLG=BONE THEN/*              @Z40LB01*/ 01177000
@RF00458 TM    MSFFLG,B'01000000'                                  0463 01178000
         BNO   @RF00463                                            0463 01179000
*                           DO;     /* PROCESS MSF STATUS    @X50AC01*/ 01180000
*                             DO I=F1 TO F8;/* LOOP THRU MSF REQSTS     01181000
*                                                            @Z40LB01*/ 01182000
         LA    @04,1                                               0465 01183000
         STH   @04,I                                               0465 01184000
@DL00465 DS    0H                                                  0466 01185000
*                               IF CONFGMSK(I)=(MSFREQ(1)&CONFGMSK(I))  01186000
*                                 THEN/*                     @Z40LB01*/ 01187000
         L     @15,@CA01312                                        0466 01188000
         MVC   @TS00001(1),MSFREQ                                  0466 01189000
         ST    @04,@TF00001                                        0466 01190000
         ALR   @04,@15                                             0466 01191000
         BCTR  @04,0                                               0466 01192000
         NC    @TS00001(1),CONFGMSK-CONFGMSK(@04)                  0466 01193000
         AL    @15,@TF00001                                        0466 01194000
         BCTR  @15,0                                               0466 01195000
         CLC   CONFGMSK-CONFGMSK(1,@15),@TS00001                   0466 01196000
         BNE   @RF00466                                            0466 01197000
*                                 DO;/* BUILD MESSAGE LINE   @Z40LB01*/ 01198000
*                                                                  0467 01199000
*                                   /*********************************/ 01200000
*                                   /*                               */ 01201000
*                                   /* FILL MESSAGE FIELDS   @Z40LB01*/ 01202000
*                                   /*                               */ 01203000
*                                   /*********************************/ 01204000
*                                                                  0468 01205000
*                                   IF FLIPSW=BONE THEN/* SECOND HALF   01206000
*                                      LINE ?                @Z40LB01*/ 01207000
         TM    FLIPSW,B'00010000'                                  0468 01208000
         BNO   @RF00468                                            0468 01209000
*                                    DTAPTR=ADDR(SHALF);/* PNT TO  0469 01210000
*                                      SECND HALF            @OZ30157*/ 01211000
         L     @04,WPLPTR                                          0469 01212000
         LA    @04,SHALF+4(,@04)                                   0469 01213000
         ST    @04,DTAPTR                                          0469 01214000
*                                   ELSE/* FIRST HALF LINE   @Z40LB01*/ 01215000
*                                    DTAPTR=ADDR(FHALF);/* PNT TO IT    01216000
*                                                            @OZ30157*/ 01217000
         B     @RC00468                                            0470 01218000
@RF00468 LA    @04,4                                               0470 01219000
         AL    @04,WPLPTR                                          0470 01220000
         ST    @04,DTAPTR                                          0470 01221000
*                                   DSSID=MSFSSIDS(I);/* FILL SSID 0471 01222000
*                                      FIELD                 @Z40LB01*/ 01223000
@RC00468 L     @04,DTAPTR                                          0471 01224000
         LH    @15,I                                               0471 01225000
         LR    @14,@15                                             0471 01226000
         MH    @14,@CH00060                                        0471 01227000
         LA    @03,MSFSSIDS-3(@14)                                 0471 01228000
         MVC   DSSID(3,@04),0(@03)                                 0471 01229000
*                                   DTYPE14='MSF-';/* MSFID  @OZ30157*/ 01230000
         MVC   DTYPE14(4,@04),@CC02848                             0472 01231000
*                                   DTYPE5=DSSID2;/* FILL UNIT TYPE     01232000
*                                      FLD                   @OZ30157*/ 01233000
         MVC   DTYPE5(1,@04),DSSID2(@04)                           0473 01234000
*                                   IF CONFGMSK(I)=(MSFON(1)&CONFGMSK(I 01235000
*                                       )) THEN/*            @Z40LB01*/ 01236000
         L     @14,@CA01312                                        0474 01237000
         L     @03,@CA01293                                        0474 01238000
         LA    @02,2                                               0474 01239000
         AL    @02,MSGPTR-MSGPTR(,@03)                             0474 01240000
         MVC   @TS00001(1),MSFON(@02)                              0474 01241000
         ST    @15,@TF00001                                        0474 01242000
         ALR   @15,@14                                             0474 01243000
         BCTR  @15,0                                               0474 01244000
         NC    @TS00001(1),CONFGMSK-CONFGMSK(@15)                  0474 01245000
         LR    @15,@14                                             0474 01246000
         AL    @15,@TF00001                                        0474 01247000
         BCTR  @15,0                                               0474 01248000
         CLC   CONFGMSK-CONFGMSK(1,@15),@TS00001                   0474 01249000
         BNE   @RF00474                                            0474 01250000
*                                    DO;/* SET ONLINE IND    @Z40LB01*/ 01251000
*                                     DSTAT1='O';/* ONLINE IND     0476 01252000
*                                                            @OZ30157*/ 01253000
         MVI   DSTAT1(@04),C'O'                                    0476 01254000
*                                     IF CONFGMSK(I)^=(MSFRDY(1)&  0477 01255000
*                                         CONFGMSK(I))/*     @Z40LB01*/ 01256000
*                                       THEN/* IS UNIT UNUSABLE    0477 01257000
*                                                            @Z40LB01*/ 01258000
         MVC   @TS00001(1),MSFRDY(@02)                             0477 01259000
         LR    @15,@14                                             0477 01260000
         AL    @15,@TF00001                                        0477 01261000
         BCTR  @15,0                                               0477 01262000
         NC    @TS00001(1),CONFGMSK-CONFGMSK(@15)                  0477 01263000
         AL    @14,@TF00001                                        0477 01264000
         BCTR  @14,0                                               0477 01265000
         CLC   CONFGMSK-CONFGMSK(1,@14),@TS00001                   0477 01266000
         BE    @RF00477                                            0477 01267000
*                                      DSTAT27='/SUU  ';/* UNUSABLE     01268000
*                                      IND                   @OZ30157*/ 01269000
         MVC   DSTAT27(6,@04),@CC02850                             0478 01270000
*                                     ELSE/* UNIT USABLE     @Z40LB01*/ 01271000
*                                      DO;/* ACC STATUS CODE @Z40LB01*/ 01272000
         B     @RC00477                                            0479 01273000
@RF00477 DS    0H                                                  0480 01274000
*                                       QBCNT=F1;/* ONE QUERY      0480 01275000
*                                                            @OZ30157*/ 01276000
         MVC   QBCNT(4),@CF00047                                   0480 01277000
*                                       QBENT(1)=QBCEL;/* FOR CELL 0481 01278000
*                                      AUDIT                 @OZ30157*/ 01279000
         MVI   QBENT+12,C' '                                       0481 01280000
         MVC   QBENT+13(31),QBENT+12                               0481 01281000
         MVC   QBENT(12),QBCEL                                     0481 01282000
*                                       QBREC(1)=DSSID(2:2)&'0F'X;/*    01283000
*                                      SET LIBID             @OZ30157*/ 01284000
         LA    @04,15                                              0482 01285000
         L     @15,DTAPTR                                          0482 01286000
         MVC   @ZT00003+3(1),DSSID+1(@15)                          0482 01287000
         N     @04,@ZT00003                                        0482 01288000
         STC   @04,QBREC                                           0482 01289000
*                                       QBREC(1)=QBREC(1)*F64;/* SHFT   01290000
*                                      6 POS                 @OZ30157*/ 01291000
         SLA   @04,6                                               0483 01292000
         STC   @04,QBREC                                           0483 01293000
*                                       QBTID(1)='EA'X;/* SET CELL 0484 01294000
*                                      LOC 234               @OZ30157*/ 01295000
         MVI   QBTID,X'EA'                                         0484 01296000
*IQUERY2:                                                          0485 01297000
*                                       CALL MSG56GQ;/* GO DO QUERY     01298000
*                                                            @OZ30157*/ 01299000
IQUERY2  BAL   @14,MSG56GQ                                         0485 01300000
*                                       IF RETC=F0 THEN/* CHECK    0486 01301000
*                                      RETURN                @Z40LB01*/ 01302000
         LH    @04,RETC                                            0486 01303000
         LTR   @04,@04                                             0486 01304000
         BNZ   @RF00486                                            0486 01305000
*                                        DO;/* GOOD RETURN   @Z40LB01*/ 01306000
*                                         CELPTR=QAPTR(1);/* GET AREA   01307000
*                                      ADDRESS               @OZ30157*/ 01308000
         L     @04,QAPTR                                           0488 01309000
         ST    @04,CELPTR                                          0488 01310000
*                                         IF ACC2BIT=BONE THEN/* ACC2   01311000
*                                      STAT                  @Z40LB01*/ 01312000
         TM    ACC2BIT(@04),B'00000010'                            0489 01313000
         BNO   @RF00489                                            0489 01314000
*                                          DCONF12=' 2';/* ACC2 GOOD    01315000
*                                                            @OZ30157*/ 01316000
         L     @04,DTAPTR                                          0490 01317000
         MVC   DCONF12(2,@04),@CC02853                             0490 01318000
*                                         IF ACC1BIT=BONE THEN/* ACC1   01319000
*                                      STAT                  @Z40LB01*/ 01320000
@RF00489 L     @04,CELPTR                                          0491 01321000
         TM    ACC1BIT(@04),B'00000001'                            0491 01322000
         BNO   @RF00491                                            0491 01323000
*                                          DCONF35='/1 ';/* ACC1 GOOD   01324000
*                                                            @OZ30157*/ 01325000
         L     @04,DTAPTR                                          0492 01326000
         MVC   DCONF35(3,@04),@CC02854                             0492 01327000
*                                        END;/* END GOOD RET CODE  0493 01328000
*                                                            @Z40LB01*/ 01329000
*                                       ELSE/* BAD RETURN    @Z40LB01*/ 01330000
*                                        DCONF=' */* ';/* NO ACC STAT   01331000
*                                                            @Z40LB01*/ 01332000
         B     @RC00486                                            0494 01333000
@RF00486 L     @04,DTAPTR                                          0494 01334000
         MVC   DCONF(5,@04),@CC02855                               0494 01335000
*                                      END;/* END ACC STAT CODE    0495 01336000
*                                                            @Z40LB01*/ 01337000
*                                    END;/* END ONLINE CODE  @Z40LB01*/ 01338000
*                                   ELSE/* UNIT IS OFFLINE   @Z40LB01*/ 01339000
*                                    DSTAT='OFFLINE';/* OFFLINE IND     01340000
*                                                            @Z40LB01*/ 01341000
*                                                                  0497 01342000
         B     @RC00474                                            0497 01343000
@RF00474 L     @04,DTAPTR                                          0497 01344000
         MVC   DSTAT(7,@04),@CC02856                               0497 01345000
*                                   /*********************************/ 01346000
*                                   /*                               */ 01347000
*                                   /* ONE MESSAGE LINE CONTAINS THE */ 01348000
*                                   /* STATUS                @Z40LB01*/ 01349000
*                                   /* OF TWO SSIDS. SWITCH FIELD    */ 01350000
*                                   /* (FLIPSW)              @Z40LB01*/ 01351000
*                                   /* IS USED TO KEEP TRACK OF THIS */ 01352000
*                                   /* SO WHEN               @Z40LB01*/ 01353000
*                                   /* THE TWO SSIDS HAVE BEEN PUT IN*/ 01354000
*                                   /* THE                   @Z40LB01*/ 01355000
*                                   /* LINE, THE LINE CAN BE MOVED TO*/ 01356000
*                                   /* THE                   @Z40LB01*/ 01357000
*                                   /* ML WTO BUFFER AREA. FLIPSW = 0*/ 01358000
*                                   /* FOR                   @Z40LB01*/ 01359000
*                                   /* FIRST SSID AND FLIPSW = 1 FOR */ 01360000
*                                   /* 2ND                   @Z40LB01*/ 01361000
*                                   /* SSID STATUS.          @Z40LB01*/ 01362000
*                                   /*                               */ 01363000
*                                   /*********************************/ 01364000
*                                                                  0498 01365000
*                                   IF FLIPSW=BONE THEN/*    @Z40LB01*/ 01366000
@RC00474 TM    FLIPSW,B'00010000'                                  0498 01367000
         BNO   @RF00498                                            0498 01368000
*                                    CALL MSG56D;/*          @OZ30157*/ 01369000
         BAL   @14,MSG56D                                          0499 01370000
*                                   ELSE/*                   @Z40LB01*/ 01371000
*                                                                  0500 01372000
*                                    /********************************/ 01373000
*                                    /*                              */ 01374000
*                                    /* FILL PART ONE MESSAGE FIELDS */ 01375000
*                                    /*                      @Z40LB01*/ 01376000
*                                    /*                              */ 01377000
*                                    /********************************/ 01378000
*                                                                  0500 01379000
*                                    FLIPSW=BONE;/*          @Z40LB01*/ 01380000
         B     @RC00498                                            0500 01381000
@RF00498 OI    FLIPSW,B'00010000'                                  0500 01382000
*                                 END;/* END BUILD MESSAGE   @Z40LB01*/ 01383000
@RC00498 DS    0H                                                  0502 01384000
*                             END;  /* END SCAN MSF REQUESTS @Z40LB01*/ 01385000
@RF00466 LA    @04,1                                               0502 01386000
         AH    @04,I                                               0502 01387000
         STH   @04,I                                               0502 01388000
         CH    @04,@CH00036                                        0502 01389000
         BNH   @DL00465                                            0502 01390000
*                           END;    /* END MSF STATUS        @Z40LB01*/ 01391000
*                                                                  0504 01392000
*                         /*******************************************/ 01393000
*                         /*                                         */ 01394000
*                         /* TEST IF ANY DRD SSIDS WERE REQUESTED IN */ 01395000
*                         /* THE                             @Z40LB01*/ 01396000
*                         /* DISPLAY COMMAND                 @Z40LB01*/ 01397000
*                         /*                                         */ 01398000
*                         /*******************************************/ 01399000
*                                                                  0504 01400000
*                         IF DRDFLG=BONE THEN/*              @Z40LB01*/ 01401000
@RF00463 TM    DRDFLG,B'00100000'                                  0504 01402000
         BNO   @RF00504                                            0504 01403000
*                           DO;     /* PROCESS DRD STATUS    @Z40LB01*/ 01404000
*                             DO I=F1 TO F4;/* SCAN BY DRD   @Z40LB01*/ 01405000
         LA    @04,1                                               0506 01406000
         STH   @04,I                                               0506 01407000
@DL00506 DS    0H                                                  0507 01408000
*                               IF DRDREQ(I)^=F0 THEN/* ANY VAL REQ     01409000
*                                                            @Z40LB01*/ 01410000
         SLR   @00,@00                                             0507 01411000
         IC    @00,DRDREQ-1(@04)                                   0507 01412000
         CH    @00,@CH00226                                        0507 01413000
         BE    @RF00507                                            0507 01414000
*                                 DO;/* PROCESS THE VALID REQUESTS IN   01415000
*                                      GROUP                 @Z40LB01*/ 01416000
*                                   DO K=F1 TO F8;/* SCAN SSID WITHIN   01417000
*                                      GRP                   @Z40LB01*/ 01418000
         LA    @04,1                                               0509 01419000
         STH   @04,K                                               0509 01420000
@DL00509 DS    0H                                                  0510 01421000
*                                    IF CONFGMSK(K)=(CONFGMSK(K)&DRDREQ 01422000
*                                        (I))/*              @Z40LB01*/ 01423000
*                                      THEN/* ANY REQUESTED SSIDS  0510 01424000
*                                                            @Z40LB01*/ 01425000
         L     @15,@CA01312                                        0510 01426000
         LH    @14,I                                               0510 01427000
         ST    @04,@TF00001                                        0510 01428000
         ALR   @04,@15                                             0510 01429000
         BCTR  @04,0                                               0510 01430000
         MVC   @TS00001(1),CONFGMSK-CONFGMSK(@04)                  0510 01431000
         LA    @04,DRDREQ-1(@14)                                   0510 01432000
         NC    @TS00001(1),0(@04)                                  0510 01433000
         AL    @15,@TF00001                                        0510 01434000
         BCTR  @15,0                                               0510 01435000
         CLC   CONFGMSK-CONFGMSK(1,@15),@TS00001                   0510 01436000
         BNE   @RF00510                                            0510 01437000
*                                     DO;/* BUILD MESSAGE LINE     0511 01438000
*                                                            @Z40LB01*/ 01439000
*                                                                  0511 01440000
*                                      /******************************/ 01441000
*                                      /*                            */ 01442000
*                                      /* FILL MESSAGE FIELDS        */ 01443000
*                                      /*                    @Z40LB01*/ 01444000
*                                      /*                            */ 01445000
*                                      /******************************/ 01446000
*                                                                  0512 01447000
*                                      IF FLIPSW=BONE THEN/* SECOND     01448000
*                                      HALF LINE ?@Z40LB01           */ 01449000
         TM    FLIPSW,B'00010000'                                  0512 01450000
         BNO   @RF00512                                            0512 01451000
*                                       DTAPTR=ADDR(SHALF);/* PNT  0513 01452000
*                                      SECOND HALF           @OZ30157*/ 01453000
         L     @04,WPLPTR                                          0513 01454000
         LA    @04,SHALF+4(,@04)                                   0513 01455000
         ST    @04,DTAPTR                                          0513 01456000
*                                      ELSE/* FIRST HALF LINE      0514 01457000
*                                                            @Z40LB01*/ 01458000
*                                       DTAPTR=ADDR(FHALF);/* PNT TO    01459000
*                                      FIRST HALF            @OZ30157*/ 01460000
         B     @RC00512                                            0514 01461000
@RF00512 LA    @04,4                                               0514 01462000
         AL    @04,WPLPTR                                          0514 01463000
         ST    @04,DTAPTR                                          0514 01464000
*                                      DSSID=DRDSSIDS((I-1)*8+K);/*     01465000
*                                      SSID FIELD            @Z40LB01*/ 01466000
@RC00512 L     @04,DTAPTR                                          0515 01467000
         LH    @15,K                                               0515 01468000
         LH    @14,I                                               0515 01469000
         LR    @03,@14                                             0515 01470000
         BCTR  @03,0                                               0515 01471000
         SLA   @03,3                                               0515 01472000
         ALR   @03,@15                                             0515 01473000
         MH    @03,@CH00060                                        0515 01474000
         LA    @02,DRDSSIDS-3(@03)                                 0515 01475000
         MVC   DSSID(3,@04),0(@02)                                 0515 01476000
*                                      DTYPE14='DRD-';/* DRDID     0516 01477000
*                                                            @OZ30157*/ 01478000
         MVC   DTYPE14(4,@04),@CC02858                             0516 01479000
*                                      DTYPE5=DSSID2;/* FILL UNIT  0517 01480000
*                                      TYPE FLD              @OZ30157*/ 01481000
         MVC   DTYPE5(1,@04),DSSID2(@04)                           0517 01482000
*                                      IF CONFGMSK(K)=(DRDON(I)&   0518 01483000
*                                          CONFGMSK(K)) THEN/*     0518 01484000
*                                                            @Z40LB01*/ 01485000
         L     @03,@CA01312                                        0518 01486000
         L     @02,@CA01293                                        0518 01487000
         LA    @00,2                                               0518 01488000
         AL    @00,MSGPTR-MSGPTR(,@02)                             0518 01489000
         LR    @02,@00                                             0518 01490000
         ALR   @02,@14                                             0518 01491000
         MVC   @TS00001(1),DRDON-1(@02)                            0518 01492000
         ST    @15,@TF00001                                        0518 01493000
         ALR   @15,@03                                             0518 01494000
         BCTR  @15,0                                               0518 01495000
         NC    @TS00001(1),CONFGMSK-CONFGMSK(@15)                  0518 01496000
         LR    @02,@03                                             0518 01497000
         AL    @02,@TF00001                                        0518 01498000
         BCTR  @02,0                                               0518 01499000
         CLC   CONFGMSK-CONFGMSK(1,@02),@TS00001                   0518 01500000
         BNE   @RF00518                                            0518 01501000
*                                       DO;/* SET ONLINE IND @Z40LB01*/ 01502000
*                                        DSTAT1='O';/* ONLINE IND  0520 01503000
*                                                            @OZ30157*/ 01504000
         MVI   DSTAT1(@04),C'O'                                    0520 01505000
*                                        IF CONFGMSK(K)^=(DRDRDY(I)&    01506000
*                                            CONFGMSK(K))/*  @Z40LB01*/ 01507000
*                                          THEN/* IS UNIT UNUSABLE 0521 01508000
*                                                            @Z40LB01*/ 01509000
         LR    @15,@00                                             0521 01510000
         ALR   @15,@14                                             0521 01511000
         MVC   @TS00001(1),DRDRDY-1(@15)                           0521 01512000
         LR    @02,@03                                             0521 01513000
         AL    @02,@TF00001                                        0521 01514000
         BCTR  @02,0                                               0521 01515000
         NC    @TS00001(1),CONFGMSK-CONFGMSK(@02)                  0521 01516000
         AL    @03,@TF00001                                        0521 01517000
         BCTR  @03,0                                               0521 01518000
         CLC   CONFGMSK-CONFGMSK(1,@03),@TS00001                   0521 01519000
         BE    @RF00521                                            0521 01520000
*                                         DSTAT27='/SUU  ';/*      0522 01521000
*                                      UNUSABLE IND          @OZ30157*/ 01522000
         MVC   DSTAT27(6,@04),@CC02850                             0522 01523000
*                                       END;/* END ONLINE CODE     0523 01524000
*                                                            @Z40LB01*/ 01525000
*                                      ELSE/* UNIT IS OFFLINE      0524 01526000
*                                                            @Z40LB01*/ 01527000
*                                       DSTAT='OFFLINE';/* OFFLINE 0524 01528000
*                                      IND                   @Z40LB01*/ 01529000
*                                                                  0524 01530000
         B     @RC00518                                            0524 01531000
@RF00518 L     @04,DTAPTR                                          0524 01532000
         MVC   DSTAT(7,@04),@CC02856                               0524 01533000
*                                      /******************************/ 01534000
*                                      /*                            */ 01535000
*                                      /* ONE MESSAGE LINE CONTAINS  */ 01536000
*                                      /* THE STATUS         @Z40LB01*/ 01537000
*                                      /* OF TWO SSIDS. SWITCH FIELD */ 01538000
*                                      /* (FLIPSW)           @Z40LB01*/ 01539000
*                                      /* IS USED TO KEEP TRACK OF   */ 01540000
*                                      /* THIS SO WHEN       @Z40LB01*/ 01541000
*                                      /* THE TWO SSIDS HAVE BEEN PUT*/ 01542000
*                                      /* IN THE             @Z40LB01*/ 01543000
*                                      /* LINE, THE LINE CAN BE MOVED*/ 01544000
*                                      /* TO THE             @Z40LB01*/ 01545000
*                                      /* ML WTO BUFFER AREA. FLIPSW */ 01546000
*                                      /* = 0 FOR            @Z40LB01*/ 01547000
*                                      /* FIRST SSID AND FLIPSW = 1  */ 01548000
*                                      /* FOR 2ND            @Z40LB01*/ 01549000
*                                      /* SSID STATUS.       @Z40LB01*/ 01550000
*                                      /*                            */ 01551000
*                                      /******************************/ 01552000
*                                                                  0525 01553000
*                                      IF FLIPSW=BONE THEN/* @Z40LB01*/ 01554000
@RC00518 TM    FLIPSW,B'00010000'                                  0525 01555000
         BNO   @RF00525                                            0525 01556000
*                                       CALL MSG56D;/*       @OZ30157*/ 01557000
         BAL   @14,MSG56D                                          0526 01558000
*                                      ELSE/*                @Z40LB01*/ 01559000
*                                                                  0527 01560000
*                                       /*****************************/ 01561000
*                                       /*                           */ 01562000
*                                       /* FILL PART ONE MESSAGE     */ 01563000
*                                       /* FIELDS            @Z40LB01*/ 01564000
*                                       /*                           */ 01565000
*                                       /*****************************/ 01566000
*                                                                  0527 01567000
*                                       FLIPSW=BONE;/*       @Z40LB01*/ 01568000
         B     @RC00525                                            0527 01569000
@RF00525 OI    FLIPSW,B'00010000'                                  0527 01570000
*                                     END;/* END MESSAGE BUILD     0528 01571000
*                                                            @Z40LB01*/ 01572000
@RC00525 DS    0H                                                  0529 01573000
*                                   END;/* END SSID SCAN     @Z40LB01*/ 01574000
@RF00510 LA    @04,1                                               0529 01575000
         AH    @04,K                                               0529 01576000
         STH   @04,K                                               0529 01577000
         CH    @04,@CH00036                                        0529 01578000
         BNH   @DL00509                                            0529 01579000
*                                 END;/* END VALID REQUEST CODE FOR     01580000
*                                      SDG                   @Z40LB01*/ 01581000
*                             END;  /* END GROUP SCAN        @Z40LB01*/ 01582000
@RF00507 LA    @04,1                                               0531 01583000
         AH    @04,I                                               0531 01584000
         STH   @04,I                                               0531 01585000
         CH    @04,@CH00045                                        0531 01586000
         BNH   @DL00506                                            0531 01587000
*                           END;    /* END DRD STATUS        @Z40LB01*/ 01588000
*                                                                  0533 01589000
*                         /*******************************************/ 01590000
*                         /*                                         */ 01591000
*                         /* TEST IF ANY DRC SSIDS WERE REQUESTED IN */ 01592000
*                         /* THE                             @Z40LB01*/ 01593000
*                         /* DISPLAY COMMAND                 @Z40LB01*/ 01594000
*                         /*                                         */ 01595000
*                         /*******************************************/ 01596000
*                                                                  0533 01597000
*                         IF DRCFLG=BONE THEN/*              @Z40LB01*/ 01598000
@RF00504 TM    DRCFLG,B'00010000'                                  0533 01599000
         BNO   @RF00533                                            0533 01600000
*                           DO;     /* PROCESS DRC STATUS    @Z40LB01*/ 01601000
*                             DO I=F1 TO F2;/* SCAN BY GROUP @Z40LB01*/ 01602000
         LA    @04,1                                               0535 01603000
         STH   @04,I                                               0535 01604000
@DL00535 DS    0H                                                  0536 01605000
*                               IF DRCREQ(I)^=F0 THEN/* ANY VAL REQ     01606000
*                                                            @Z40LB01*/ 01607000
         SLR   @00,@00                                             0536 01608000
         IC    @00,DRCREQ-1(@04)                                   0536 01609000
         CH    @00,@CH00226                                        0536 01610000
         BE    @RF00536                                            0536 01611000
*                                 DO;/* PROCESS THE VALID REQUESTS IN   01612000
*                                      GROUP                 @Z40LB01*/ 01613000
*                                   DO K=F1 TO F8;/* SCAN SSID WITHIN   01614000
*                                      GRP                   @Z40LB01*/ 01615000
         LA    @04,1                                               0538 01616000
         STH   @04,K                                               0538 01617000
@DL00538 DS    0H                                                  0539 01618000
*                                    IF CONFGMSK(K)=(CONFGMSK(K)&DRCREQ 01619000
*                                        (I))/*              @Z40LB01*/ 01620000
*                                      THEN/* ANY REQUESTED SSIDS  0539 01621000
*                                                            @Z40LB01*/ 01622000
         L     @15,@CA01312                                        0539 01623000
         LH    @14,I                                               0539 01624000
         ST    @04,@TF00001                                        0539 01625000
         ALR   @04,@15                                             0539 01626000
         BCTR  @04,0                                               0539 01627000
         MVC   @TS00001(1),CONFGMSK-CONFGMSK(@04)                  0539 01628000
         LA    @04,DRCREQ-1(@14)                                   0539 01629000
         NC    @TS00001(1),0(@04)                                  0539 01630000
         AL    @15,@TF00001                                        0539 01631000
         BCTR  @15,0                                               0539 01632000
         CLC   CONFGMSK-CONFGMSK(1,@15),@TS00001                   0539 01633000
         BNE   @RF00539                                            0539 01634000
*                                     DO;/* BUILD MESSAGE LINE     0540 01635000
*                                                            @Z40LB01*/ 01636000
*                                                                  0540 01637000
*                                      /******************************/ 01638000
*                                      /*                            */ 01639000
*                                      /* FILL MESSAGE FIELDS        */ 01640000
*                                      /*                    @Z40LB01*/ 01641000
*                                      /*                            */ 01642000
*                                      /******************************/ 01643000
*                                                                  0541 01644000
*                                      IF FLIPSW=BONE THEN/* SECOND     01645000
*                                      HALF LINE ?@Z40LB01           */ 01646000
         TM    FLIPSW,B'00010000'                                  0541 01647000
         BNO   @RF00541                                            0541 01648000
*                                       DTAPTR=ADDR(SHALF);/* PNT TO    01649000
*                                      SECND HALF            @OZ30157*/ 01650000
         L     @04,WPLPTR                                          0542 01651000
         LA    @04,SHALF+4(,@04)                                   0542 01652000
         ST    @04,DTAPTR                                          0542 01653000
*                                      ELSE/* FIRST HALF LINE      0543 01654000
*                                                            @Z40LB01*/ 01655000
*                                       DTAPTR=ADDR(FHALF);/* POINT     01656000
*                                      TO IT                 @OZ30157*/ 01657000
         B     @RC00541                                            0543 01658000
@RF00541 LA    @04,4                                               0543 01659000
         AL    @04,WPLPTR                                          0543 01660000
         ST    @04,DTAPTR                                          0543 01661000
*                                      DSSID=DRCSSIDS((I-1)*8+K);/*     01662000
*                                      SSID FIELD            @Z40LB01*/ 01663000
@RC00541 L     @04,DTAPTR                                          0544 01664000
         LH    @15,K                                               0544 01665000
         LH    @14,I                                               0544 01666000
         LR    @03,@14                                             0544 01667000
         BCTR  @03,0                                               0544 01668000
         SLA   @03,3                                               0544 01669000
         ALR   @03,@15                                             0544 01670000
         MH    @03,@CH00060                                        0544 01671000
         LA    @02,DRCSSIDS-3(@03)                                 0544 01672000
         MVC   DSSID(3,@04),0(@02)                                 0544 01673000
*                                      DTYPE14='DRC-';/* DRCID     0545 01674000
*                                                            @OZ30157*/ 01675000
         MVC   DTYPE14(4,@04),@CC02859                             0545 01676000
*                                      DTYPE5=DSSID2;/* FILL UNIT  0546 01677000
*                                      TYPE FLD              @OZ30157*/ 01678000
         MVC   DTYPE5(1,@04),DSSID2(@04)                           0546 01679000
*                                      IF CONFGMSK(K)=(DRCON(I)&   0547 01680000
*                                          CONFGMSK(K)) THEN/*     0547 01681000
*                                                            @Z40LB01*/ 01682000
         L     @03,@CA01312                                        0547 01683000
         L     @02,@CA01293                                        0547 01684000
         L     @02,MSGPTR-MSGPTR(,@02)                             0547 01685000
         ALR   @02,@14                                             0547 01686000
         MVC   @TS00001(1),DRCON+1(@02)                            0547 01687000
         ST    @15,@TF00001                                        0547 01688000
         ALR   @15,@03                                             0547 01689000
         BCTR  @15,0                                               0547 01690000
         NC    @TS00001(1),CONFGMSK-CONFGMSK(@15)                  0547 01691000
         AL    @03,@TF00001                                        0547 01692000
         BCTR  @03,0                                               0547 01693000
         CLC   CONFGMSK-CONFGMSK(1,@03),@TS00001                   0547 01694000
         BNE   @RF00547                                            0547 01695000
*                                       DSTAT1='O';/* ONLINE IND   0548 01696000
*                                                            @OZ30157*/ 01697000
         MVI   DSTAT1(@04),C'O'                                    0548 01698000
*                                      ELSE/* UNIT IS OFFLINE      0549 01699000
*                                                            @Z40LB01*/ 01700000
*                                       DSTAT='OFFLINE';/* OFFLINE 0549 01701000
*                                      IND                   @Z40LB01*/ 01702000
*                                                                  0549 01703000
         B     @RC00547                                            0549 01704000
@RF00547 L     @04,DTAPTR                                          0549 01705000
         MVC   DSTAT(7,@04),@CC02856                               0549 01706000
*                                      /******************************/ 01707000
*                                      /*                            */ 01708000
*                                      /* ONE MESSAGE LINE CONTAINS  */ 01709000
*                                      /* THE STATUS         @Z40LB01*/ 01710000
*                                      /* OF TWO SSIDS. SWITCH FIELD */ 01711000
*                                      /* (FLIPSW)           @Z40LB01*/ 01712000
*                                      /* IS USED TO KEEP TRACK OF   */ 01713000
*                                      /* THIS SO WHEN       @Z40LB01*/ 01714000
*                                      /* THE TWO SSIDS HAVE BEEN PUT*/ 01715000
*                                      /* IN THE             @Z40LB01*/ 01716000
*                                      /* LINE, THE LINE CAN BE MOVED*/ 01717000
*                                      /* TO THE             @Z40LB01*/ 01718000
*                                      /* ML WTO BUFFER AREA. FLIPSW */ 01719000
*                                      /* = 0 FOR            @Z40LB01*/ 01720000
*                                      /* FIRST SSID AND FLIPSW = 1  */ 01721000
*                                      /* FOR 2ND            @Z40LB01*/ 01722000
*                                      /* SSID STATUS.       @Z40LB01*/ 01723000
*                                      /*                            */ 01724000
*                                      /******************************/ 01725000
*                                                                  0550 01726000
*                                      IF FLIPSW=BONE THEN/* @Z40LB01*/ 01727000
@RC00547 TM    FLIPSW,B'00010000'                                  0550 01728000
         BNO   @RF00550                                            0550 01729000
*                                       CALL MSG56D;/*       @OZ30157*/ 01730000
         BAL   @14,MSG56D                                          0551 01731000
*                                      ELSE/*                @Z40LB01*/ 01732000
*                                                                  0552 01733000
*                                       /*****************************/ 01734000
*                                       /*                           */ 01735000
*                                       /* FILL PART ONE MESSAGE     */ 01736000
*                                       /* FIELDS            @Z40LB01*/ 01737000
*                                       /*                           */ 01738000
*                                       /*****************************/ 01739000
*                                                                  0552 01740000
*                                       FLIPSW=BONE;/*       @Z40LB01*/ 01741000
         B     @RC00550                                            0552 01742000
@RF00550 OI    FLIPSW,B'00010000'                                  0552 01743000
*                                     END;/* END MESSAGE BUILD     0553 01744000
*                                                            @Z40LB01*/ 01745000
@RC00550 DS    0H                                                  0554 01746000
*                                   END;/* END SSID SCAN     @Z40LB01*/ 01747000
@RF00539 LA    @04,1                                               0554 01748000
         AH    @04,K                                               0554 01749000
         STH   @04,K                                               0554 01750000
         CH    @04,@CH00036                                        0554 01751000
         BNH   @DL00538                                            0554 01752000
*                                 END;/* END VALID REQUEST CODE FOR     01753000
*                                      SDG                   @Z40LB01*/ 01754000
*                             END;  /* END GROUP SCAN        @Z40LB01*/ 01755000
@RF00536 LA    @04,1                                               0556 01756000
         AH    @04,I                                               0556 01757000
         STH   @04,I                                               0556 01758000
         CH    @04,@CH00056                                        0556 01759000
         BNH   @DL00535                                            0556 01760000
*                           END;    /* END DRC STATUS        @Z40LB01*/ 01761000
*                                                                  0558 01762000
*                         /*******************************************/ 01763000
*                         /*                                         */ 01764000
*                         /* TEST IF ANY SA SSIDS WERE REQUESTED IN  */ 01765000
*                         /* THE                             @Z40LB01*/ 01766000
*                         /* DISPLAY COMMAND                 @Z40LB01*/ 01767000
*                         /*                                         */ 01768000
*                         /*******************************************/ 01769000
*                                                                  0558 01770000
*                         IF SAFLG=BONE THEN/*               @Z40LB01*/ 01771000
@RF00533 TM    SAFLG,B'00001000'                                   0558 01772000
         BNO   @RF00558                                            0558 01773000
*                           DO;     /* PROCESS SA STATUS     @Z40LB01*/ 01774000
*                             DO I=F1 TO F2;/* SCAN BY GROUP @Z40LB01*/ 01775000
         LA    @04,1                                               0560 01776000
         STH   @04,I                                               0560 01777000
@DL00560 DS    0H                                                  0561 01778000
*                               IF SAREQ(I)^=F0 THEN/* ANY VAL REQ 0561 01779000
*                                                            @Z40LB01*/ 01780000
         SLR   @00,@00                                             0561 01781000
         IC    @00,SAREQ-1(@04)                                    0561 01782000
         CH    @00,@CH00226                                        0561 01783000
         BE    @RF00561                                            0561 01784000
*                                 DO;/* PROCESS THE VALID REQUESTS IN   01785000
*                                      GROUP                 @Z40LB01*/ 01786000
*                                   DO K=F1 TO F8;/* SCAN SSID WITHIN   01787000
*                                      GRP                   @Z40LB01*/ 01788000
         LA    @04,1                                               0563 01789000
         STH   @04,K                                               0563 01790000
@DL00563 DS    0H                                                  0564 01791000
*                                    IF CONFGMSK(K)=(CONFGMSK(K)&SAREQ( 01792000
*                                        I))/*               @Z40LB01*/ 01793000
*                                      THEN/* ANY REQUESTED SSIDS  0564 01794000
*                                                            @Z40LB01*/ 01795000
         L     @15,@CA01312                                        0564 01796000
         LH    @14,I                                               0564 01797000
         ST    @04,@TF00001                                        0564 01798000
         ALR   @04,@15                                             0564 01799000
         BCTR  @04,0                                               0564 01800000
         MVC   @TS00001(1),CONFGMSK-CONFGMSK(@04)                  0564 01801000
         LA    @04,SAREQ-1(@14)                                    0564 01802000
         NC    @TS00001(1),0(@04)                                  0564 01803000
         AL    @15,@TF00001                                        0564 01804000
         BCTR  @15,0                                               0564 01805000
         CLC   CONFGMSK-CONFGMSK(1,@15),@TS00001                   0564 01806000
         BNE   @RF00564                                            0564 01807000
*                                     DO;/* BUILD MESSAGE LINE     0565 01808000
*                                                            @Z40LB01*/ 01809000
*                                                                  0565 01810000
*                                      /******************************/ 01811000
*                                      /*                            */ 01812000
*                                      /* FILL MESSAGE FIELDS        */ 01813000
*                                      /*                    @Z40LB01*/ 01814000
*                                      /*                            */ 01815000
*                                      /******************************/ 01816000
*                                                                  0566 01817000
*                                      IF FLIPSW=BONE THEN/* SECOND     01818000
*                                      HALF LINE ?@Z40LB01           */ 01819000
         TM    FLIPSW,B'00010000'                                  0566 01820000
         BNO   @RF00566                                            0566 01821000
*                                       DTAPTR=ADDR(SHALF);/* PNT TO    01822000
*                                      SECND HALF            @OZ30157*/ 01823000
         L     @04,WPLPTR                                          0567 01824000
         LA    @04,SHALF+4(,@04)                                   0567 01825000
         ST    @04,DTAPTR                                          0567 01826000
*                                      ELSE/* FIRST HALF LINE      0568 01827000
*                                                            @Z40LB01*/ 01828000
*                                       DTAPTR=ADDR(FHALF);/* POINT     01829000
*                                      TO IT                 @OZ30157*/ 01830000
         B     @RC00566                                            0568 01831000
@RF00566 LA    @04,4                                               0568 01832000
         AL    @04,WPLPTR                                          0568 01833000
         ST    @04,DTAPTR                                          0568 01834000
*                                      DSSID=SASSIDS((I-1)*8+K);/* 0569 01835000
*                                      SSID FIELD            @Z40LB01*/ 01836000
@RC00566 L     @04,DTAPTR                                          0569 01837000
         LH    @15,K                                               0569 01838000
         LH    @14,I                                               0569 01839000
         LR    @03,@14                                             0569 01840000
         BCTR  @03,0                                               0569 01841000
         SLA   @03,3                                               0569 01842000
         ALR   @03,@15                                             0569 01843000
         MH    @03,@CH00060                                        0569 01844000
         LA    @02,SASSIDS-3(@03)                                  0569 01845000
         MVC   DSSID(3,@04),0(@02)                                 0569 01846000
*                                      DTYPE14='SA  ';/* SAID      0570 01847000
*                                                            @OZ30157*/ 01848000
         MVC   DTYPE14(4,@04),@CC02860                             0570 01849000
*                                      DTYPE5=DSSID2;/* FILL UNIT  0571 01850000
*                                      TYPE FLD              @OZ30157*/ 01851000
         MVC   DTYPE5(1,@04),DSSID2(@04)                           0571 01852000
*                                      IF CONFGMSK(K)=(SAON(I)&CONFGMSK 01853000
*                                          (K)) THEN/*       @Z40LB01*/ 01854000
         L     @03,@CA01312                                        0572 01855000
         L     @02,@CA01293                                        0572 01856000
         LA    @00,2                                               0572 01857000
         AL    @00,MSGPTR-MSGPTR(,@02)                             0572 01858000
         LR    @02,@00                                             0572 01859000
         ALR   @02,@14                                             0572 01860000
         MVC   @TS00001(1),SAON-1(@02)                             0572 01861000
         ST    @15,@TF00001                                        0572 01862000
         ALR   @15,@03                                             0572 01863000
         BCTR  @15,0                                               0572 01864000
         NC    @TS00001(1),CONFGMSK-CONFGMSK(@15)                  0572 01865000
         LR    @02,@03                                             0572 01866000
         AL    @02,@TF00001                                        0572 01867000
         BCTR  @02,0                                               0572 01868000
         CLC   CONFGMSK-CONFGMSK(1,@02),@TS00001                   0572 01869000
         BNE   @RF00572                                            0572 01870000
*                                       DO;/* SET ONLINE IND @Z40LB01*/ 01871000
*                                        DSTAT1='O';/* ONLINE IND  0574 01872000
*                                                            @OZ30157*/ 01873000
         MVI   DSTAT1(@04),C'O'                                    0574 01874000
*                                        IF CONFGMSK(K)^=(SARDY(I)&     01875000
*                                            CONFGMSK(K))/*  @Z40LB01*/ 01876000
*                                          THEN/* IS UNIT UNUSABLE 0575 01877000
*                                                            @Z40LB01*/ 01878000
         LR    @15,@00                                             0575 01879000
         ALR   @15,@14                                             0575 01880000
         MVC   @TS00001(1),SARDY-1(@15)                            0575 01881000
         LR    @02,@03                                             0575 01882000
         AL    @02,@TF00001                                        0575 01883000
         BCTR  @02,0                                               0575 01884000
         NC    @TS00001(1),CONFGMSK-CONFGMSK(@02)                  0575 01885000
         AL    @03,@TF00001                                        0575 01886000
         BCTR  @03,0                                               0575 01887000
         CLC   CONFGMSK-CONFGMSK(1,@03),@TS00001                   0575 01888000
         BE    @RF00575                                            0575 01889000
*                                         DSTAT27='/SUU  ';/*      0576 01890000
*                                      UNUSABLE IND          @OZ30157*/ 01891000
         MVC   DSTAT27(6,@04),@CC02850                             0576 01892000
*                                       END;/* END ONLINE CODE     0577 01893000
*                                                            @Z40LB01*/ 01894000
*                                      ELSE/* UNIT IS OFFLINE      0578 01895000
*                                                            @Z40LB01*/ 01896000
*                                       DSTAT='OFFLINE';/* OFFLINE 0578 01897000
*                                      IND                   @Z40LB01*/ 01898000
*                                                                  0578 01899000
         B     @RC00572                                            0578 01900000
@RF00572 L     @04,DTAPTR                                          0578 01901000
         MVC   DSTAT(7,@04),@CC02856                               0578 01902000
*                                      /******************************/ 01903000
*                                      /*                            */ 01904000
*                                      /* ONE MESSAGE LINE CONTAINS  */ 01905000
*                                      /* THE STATUS         @Z40LB01*/ 01906000
*                                      /* OF TWO SSIDS. SWITCH FIELD */ 01907000
*                                      /* (FLIPSW)           @Z40LB01*/ 01908000
*                                      /* IS USED TO KEEP TRACK OF   */ 01909000
*                                      /* THIS SO WHEN       @Z40LB01*/ 01910000
*                                      /* THE TWO SSIDS HAVE BEEN PUT*/ 01911000
*                                      /* IN THE             @Z40LB01*/ 01912000
*                                      /* LINE, THE LINE CAN BE MOVED*/ 01913000
*                                      /* TO THE             @Z40LB01*/ 01914000
*                                      /* ML WTO BUFFER AREA. FLIPSW */ 01915000
*                                      /* = 0 FOR            @Z40LB01*/ 01916000
*                                      /* FIRST SSID AND FLIPSW = 1  */ 01917000
*                                      /* FOR 2ND            @Z40LB01*/ 01918000
*                                      /* SSID STATUS.       @Z40LB01*/ 01919000
*                                      /*                            */ 01920000
*                                      /******************************/ 01921000
*                                                                  0579 01922000
*                                      IF FLIPSW=BONE THEN/* @Z40LB01*/ 01923000
@RC00572 TM    FLIPSW,B'00010000'                                  0579 01924000
         BNO   @RF00579                                            0579 01925000
*                                       CALL MSG56D;/*       @OZ30157*/ 01926000
         BAL   @14,MSG56D                                          0580 01927000
*                                      ELSE/*                @Z40LB01*/ 01928000
*                                                                  0581 01929000
*                                       /*****************************/ 01930000
*                                       /*                           */ 01931000
*                                       /* FILL PART ONE MESSAGE     */ 01932000
*                                       /* FIELDS            @Z40LB01*/ 01933000
*                                       /*                           */ 01934000
*                                       /*****************************/ 01935000
*                                                                  0581 01936000
*                                       FLIPSW=BONE;/*       @Z40LB01*/ 01937000
         B     @RC00579                                            0581 01938000
@RF00579 OI    FLIPSW,B'00010000'                                  0581 01939000
*                                     END;/* END MESSAGE BUILD     0582 01940000
*                                                            @Z40LB01*/ 01941000
@RC00579 DS    0H                                                  0583 01942000
*                                   END;/* END SSID SCAN     @Z40LB01*/ 01943000
@RF00564 LA    @04,1                                               0583 01944000
         AH    @04,K                                               0583 01945000
         STH   @04,K                                               0583 01946000
         CH    @04,@CH00036                                        0583 01947000
         BNH   @DL00563                                            0583 01948000
*                                 END;/* END VALID REQUEST CODE FOR     01949000
*                                      SDG                   @Z40LB01*/ 01950000
*                             END;  /* END GROUP SCAN        @Z40LB01*/ 01951000
@RF00561 LA    @04,1                                               0585 01952000
         AH    @04,I                                               0585 01953000
         STH   @04,I                                               0585 01954000
         CH    @04,@CH00056                                        0585 01955000
         BNH   @DL00560                                            0585 01956000
*                           END;    /* END SA STATUS         @Z40LB01*/ 01957000
*                       END;        /* END SSID DISPLAY      @OZ30157*/ 01958000
*                                                                  0588 01959000
*/* CODE TO INVOKE ALTERNATE DISPLAYS - PATHS, ALTMSC,       @OZ30157*/ 01960000
*/* ERROR QCBS, TRACE, MSVC                                  @OZ30157*/ 01961000
*                                                                  0588 01962000
*                     ELSE          /*                       @OZ30157*/ 01963000
*                       DO;         /* PATHS, ETC.           @OZ30157*/ 01964000
         B     @RC00452                                            0588 01965000
@RF00452 DS    0H                                                  0589 01966000
*                         IF DSPPATH=BONE THEN/* IF PATHS REQUEST  0589 01967000
*                                                            @OZ30157*/ 01968000
         L     @04,@CA00041                                        0589 01969000
         L     @04,CWBPTR-CWBPTR(,@04)                             0589 01970000
         TM    DSPPATH(@04),B'00000001'                            0589 01971000
         BNO   @RF00589                                            0589 01972000
*                           DO;     /* THEN CHK CPU,SDG,DRC  @OZ30157*/ 01973000
*                             IF DSPCPU=BONE THEN/* IF CPU PATHS   0591 01974000
*                                      REQUEST               @OZ30157*/ 01975000
         TM    DSPCPU(@04),B'00000010'                             0591 01976000
         BNO   @RF00591                                            0591 01977000
*                               CALL MSG56G;/* DO CPU PATH DISPLAY 0592 01978000
*                                                            @OZ30157*/ 01979000
         BAL   @14,MSG56G                                          0592 01980000
*                             IF DSPSDG=BONE THEN/* IF SDG PATHS   0593 01981000
*                                      REQUEST               @OZ30157*/ 01982000
@RF00591 L     @04,@CA00041                                        0593 01983000
         L     @04,CWBPTR-CWBPTR(,@04)                             0593 01984000
         TM    DSPSDG(@04),B'00010000'                             0593 01985000
         BNO   @RF00593                                            0593 01986000
*                               DO; /*                       @OZ30157*/ 01987000
*                                 IF DSPCPU=BONE THEN/* IF DID CPU 0595 01988000
*                                      ALREADY               @OZ30157*/ 01989000
         TM    DSPCPU(@04),B'00000010'                             0595 01990000
         BNO   @RF00595                                            0595 01991000
*                                   DO;/* MUST REINIT WPLBUF @OZ30157*/ 01992000
*                                    CALL MSG56C;/* FINISH CURRENT 0597 01993000
*                                      MSG,                  @OZ30157*/ 01994000
         BAL   @14,MSG56C                                          0597 01995000
*                                    MSGIND=MSG05610;/* SET UP FOR 0598 01996000
*                                      SDG HDR               @OZ30157*/ 01997000
         MVI   MSGIND,X'2E'                                        0598 01998000
*                                    CALL MSG56AA;/* GET IT OUT    0599 01999000
*                                                            @OZ30157*/ 02000000
         BAL   @14,MSG56AA                                         0599 02001000
*                                   END;/* ALL SET FOR MSGS  @OZ30157*/ 02002000
*                                 CALL MSG56H;/* THEN DO THAT ONE  0601 02003000
*                                                            @OZ30157*/ 02004000
@RF00595 BAL   @14,MSG56H                                          0601 02005000
*                               END;/*                       @OZ30157*/ 02006000
*                             IF DSPDRC=BONE THEN/* IF DRC PATHS   0603 02007000
*                                      REQUEST               @OZ30157*/ 02008000
@RF00593 L     @04,@CA00041                                        0603 02009000
         L     @04,CWBPTR-CWBPTR(,@04)                             0603 02010000
         TM    DSPDRC(@04),B'10000000'                             0603 02011000
         BNO   @RF00603                                            0603 02012000
*                               DO; /*                       @OZ30157*/ 02013000
*                                 IF DSPCPU=BONE THEN/* IF DID CPU 0605 02014000
*                                      ALREADY,              @OZ30157*/ 02015000
         TM    DSPCPU(@04),B'00000010'                             0605 02016000
         BNO   @RF00605                                            0605 02017000
*                                   DO;/* MUST REINIT WPLBUF @OZ30157*/ 02018000
*                                    CALL MSG56C;/* FINISH CURRENT 0607 02019000
*                                      MSG,                  @OZ30157*/ 02020000
         BAL   @14,MSG56C                                          0607 02021000
*                                    MSGIND=MSG05612;/* SET UP FOR 0608 02022000
*                                      DRC HDR               @OZ30157*/ 02023000
         MVI   MSGIND,X'30'                                        0608 02024000
*                                    CALL MSG56AA;/* GET IT OUT    0609 02025000
*                                                            @OZ30157*/ 02026000
         BAL   @14,MSG56AA                                         0609 02027000
*                                   END;/* ALL SET FOR MSGS  @OZ30157*/ 02028000
*                                 CALL MSG56I;/* THEN DO THAT ONE  0611 02029000
*                                                            @OZ30157*/ 02030000
@RF00605 BAL   @14,MSG56I                                          0611 02031000
*                               END;/*                       @OZ30157*/ 02032000
*                           END;    /* END PATHS DISPLAY     @OZ30157*/ 02033000
*                         ELSE      /*                       @OZ30157*/ 02034000
*                           IF DSPQCB=BONE THEN/* IF ERROR QCB     0614 02035000
*                                      REQUEST               @OZ30157*/ 02036000
         B     @RC00589                                            0614 02037000
@RF00589 L     @04,@CA00041                                        0614 02038000
         L     @04,CWBPTR-CWBPTR(,@04)                             0614 02039000
         TM    DSPQCB(@04),B'00000100'                             0614 02040000
         BNO   @RF00614                                            0614 02041000
*                             CALL MSG56J;/* DO THAT DISPLAY @OZ30157*/ 02042000
         BAL   @14,MSG56J                                          0615 02043000
*                           ELSE    /*                       @OZ30157*/ 02044000
*                             IF DSPALTM=BONE THEN/* IF ALTMSC     0616 02045000
*                                      REQUEST               @OZ30157*/ 02046000
         B     @RC00614                                            0616 02047000
@RF00614 L     @04,@CA00041                                        0616 02048000
         L     @04,CWBPTR-CWBPTR(,@04)                             0616 02049000
         TM    DSPALTM(@04),B'00000010'                            0616 02050000
         BNO   @RF00616                                            0616 02051000
*                               CALL MSG56AL;/* DO THAT      @OZ30157*/ 02052000
         BAL   @14,MSG56AL                                         0617 02053000
*                             ELSE  /*                       @OZ30157*/ 02054000
*                               IF DSPTRC=BONE THEN/* IF TRACE     0618 02055000
*                                      DISPLAY               @OZ30157*/ 02056000
         B     @RC00616                                            0618 02057000
@RF00616 L     @04,@CA00041                                        0618 02058000
         L     @04,CWBPTR-CWBPTR(,@04)                             0618 02059000
         TM    DSPTRC(@04),B'00001000'                             0618 02060000
         BNO   @RF00618                                            0618 02061000
*                                 CALL MSG56TR;/* THEN DO IT @OZ30157*/ 02062000
         BAL   @14,MSG56TR                                         0619 02063000
*                               ELSE/*                       @OZ30157*/ 02064000
*                                 IF DSPMSVC=BONE THEN/* IF MSVC   0620 02065000
*                                      REQUEST               @OZ30157*/ 02066000
         B     @RC00618                                            0620 02067000
@RF00618 L     @04,@CA00041                                        0620 02068000
         L     @04,CWBPTR-CWBPTR(,@04)                             0620 02069000
         TM    DSPMSVC(@04),B'00010000'                            0620 02070000
         BNO   @RF00620                                            0620 02071000
*                                   CALL MSG56MS;/* THEN DO THAT   0621 02072000
*                                                            @OZ30157*/ 02073000
         BAL   @14,MSG56MS                                         0621 02074000
*                                 ELSE                             0622 02075000
*                                   ;/*                      @OZ30157*/ 02076000
@RF00620 DS    0H                                                  0623 02077000
*                       END;        /* END ALTERNATE REQ     @OZ30157*/ 02078000
@RC00618 DS    0H                                                  0623 02079000
@RC00616 DS    0H                                                  0623 02080000
@RC00614 DS    0H                                                  0623 02081000
@RC00589 DS    0H                                                  0624 02082000
*                                                                  0624 02083000
*/*  ******************************************************  @Z40LB01*/ 02084000
*/*                                                          @Z40LB01*/ 02085000
*/*   CLEANUP RESIDUAL MESSAGES IN THE WPL BUFFER            @Z40LB01*/ 02086000
*/*   OR BUILD BLANK LINE FOR OUTPUT.                        @ZA14724*/ 02087000
*/*                                                          @Z40LB01*/ 02088000
*/*  ******************************************************  @Z40LB01*/ 02089000
*                                                                  0624 02090000
*                     CALL MSG56CA; /* WRITE SUBROUTINE      @OZ30157*/ 02091000
@RC00452 BAL   @14,MSG56CA                                         0624 02092000
*VALPROCX:                                                         0625 02093000
*                   END;            /* VALID PROCESS END     @OZ24706*/ 02094000
VALPROCX DS    0H                                                  0626 02095000
*/*  ******************************************************  @OZ24706*/ 02096000
*/*                                                          @OZ24706*/ 02097000
*/*   IF NO VALID SSIDS WERE PROCESSED FOR THIS CWB,         @OZ24706*/ 02098000
*/*   THEN BUILD AND WRITE ERROR MESSAGE.                    @OZ24706*/ 02099000
*/*                                                          @OZ24706*/ 02100000
*/*  ******************************************************  @OZ24706*/ 02101000
*                                                                  0626 02102000
*                 IF VALSSID=BZERO THEN/* TEST FOR VALID     @OZ24706*/ 02103000
@RF00431 TM    VALSSID,B'01000000'                                 0626 02104000
         BNZ   @RF00626                                            0626 02105000
*                   DO;             /* NO VALID SSID PROCES  @OZ24706*/ 02106000
*                     IF STORER=BZERO THEN/* IF NO VALID SSID      0628 02107000
*                                                            @OZ30157*/ 02108000
         TM    STORER,B'00000001'                                  0628 02109000
         BNZ   @RF00628                                            0628 02110000
*                       MSGIND=MSG05604;/* POINT TO ERROR MSG      0629 02111000
*                                                            @OZ24706*/ 02112000
         MVI   MSGIND,X'14'                                        0629 02113000
*                     ELSE          /* ELSE IF INSUFF STOR.  @OZ30157*/ 02114000
*                       MSGIND=MSG05601;/* INSUFFICIENT STORAGE    0630 02115000
*                                                            @OZ30157*/ 02116000
         B     @RC00628                                            0630 02117000
@RF00628 MVI   MSGIND,X'11'                                        0630 02118000
*                     CALL MSG56A;  /* MSG BUILD SUB         @OZ24706*/ 02119000
@RC00628 BAL   @14,MSG56A                                          0631 02120000
*                     CALL MSG56C;  /* MSG WRITE SUB         @OZ24706*/ 02121000
         BAL   @14,MSG56C                                          0632 02122000
*                   END;            /* END ERROR MSG CODE    @OZ24706*/ 02123000
*               END;                /* END OF CK FOR IN PROCESS    0634 02124000
*                                                            @ZA14724*/ 02125000
@RF00626 DS    0H                                                  0635 02126000
*/*  ******************************************************  @Z40LB01*/ 02127000
*/*                                                          @Z40LB01*/ 02128000
*/*   CALL SUBROUTINE ICBMSG46 TO ISSUE FREEMAIN FOR CWB     @Z40LB01*/ 02129000
*/*                                                          @Z40LB01*/ 02130000
*/*  ******************************************************  @Z40LB01*/ 02131000
*                                                                  0635 02132000
*             CALL ICBMSG46;        /*                       @Z40LB01*/ 02133000
@RF00249 BAL   @14,ICBMSG46                                        0635 02134000
*/*  ******************************************************  @OZ30157*/ 02135000
*/*                                                          @OZ30157*/ 02136000
*/*   CLEANUP AREAS OBTAINED WITH GETMAIN BY MSG56F          @OZ30157*/ 02137000
*/*                                                          @OZ30157*/ 02138000
*/*  ******************************************************  @OZ30157*/ 02139000
*                                                                  0636 02140000
*             IF GMCUR>=GMSTT THEN  /*                       @OZ30157*/ 02141000
         L     @04,GMSTT                                           0636 02142000
         CL    @04,GMCUR                                           0636 02143000
         BH    @RF00636                                            0636 02144000
*               DO GMPTR=GMSTT TO GMCUR BY F8;/* FREE ALL AREAS    0637 02145000
*                                                            @OZ30157*/ 02146000
         ST    @04,GMPTR                                           0637 02147000
         B     @DE00637                                            0637 02148000
@DL00637 DS    0H                                                  0638 02149000
*                 RFY                                              0638 02150000
*                   R0 RSTD;        /* OBTAINED WITH GETMAIN @OZ30157*/ 02151000
*                 R0=GMLEN;         /* GET LENGTH OF AREA    @OZ30157*/ 02152000
         L     R0,GMLEN(,@04)                                      0639 02153000
*                 R1=GMADR;         /* ADDRESS               @OZ30157*/ 02154000
         L     R1,GMADR(,@04)                                      0640 02155000
*                 GEN CODE;                                        0641 02156000
*                                   /* FREE QUEUE SPACE      @OZ30157*/ 02157000
FREE1    FREEMAIN R,LV=(0),A=(1)                                        02158000
*                 RFY                                              0642 02159000
*                   R0 UNRSTD;      /* RELEASE R0            @OZ30157*/ 02160000
*               END;                /* END FREEMAIN LOOP     @OZ30157*/ 02161000
         LA    @04,8                                               0643 02162000
         AL    @04,GMPTR                                           0643 02163000
         ST    @04,GMPTR                                           0643 02164000
@DE00637 CL    @04,GMCUR                                           0643 02165000
         BNH   @DL00637                                            0643 02166000
*             GMCUR=F0;             /* RESET START POINTER   @OZ30157*/ 02167000
@RF00636 SLR   @04,@04                                             0644 02168000
         ST    @04,GMCUR                                           0644 02169000
*/*  ******************************************************  @Z40LB01*/ 02170000
*/*                                                          @Z40LB01*/ 02171000
*/*   DEQUE THIS CWB FROM INTERNAL QUEUE                     @Z40LB01*/ 02172000
*/*                                                          @Z40LB01*/ 02173000
*/*  ******************************************************  @Z40LB01*/ 02174000
*                                                                  0645 02175000
*             CMDQUE(CWBIX)=F0;     /* CLEAR CURRENT ELEMENT @Z40LB01*/ 02176000
         LH    @15,CWBIX                                           0645 02177000
         SLA   @15,2                                               0645 02178000
         L     @14,@CA01311                                        0645 02179000
         AL    @14,@CF03609                                        0645 02180000
         ST    @04,CMDQUE-CMDQUE(@15,@14)                          0645 02181000
*           END;                    /* END OF F0 CK LOOP     @ZA14724*/ 02182000
*QUELOOPX:                                                         0647 02183000
*       END;                        /*                       @Z40LB01*/ 02184000
@RF00246 DS    0H                                                  0647 02185000
QUELOOPX LA    @04,1                                               0647 02186000
         AH    @04,CWBIX                                           0647 02187000
         STH   @04,CWBIX                                           0647 02188000
         CH    @04,@CH00034                                        0647 02189000
         BNH   @DL00243                                            0647 02190000
*ENDMAIN:                                                          0648 02191000
*     END;                          /* END MAIN CODE         @Z40LB01*/ 02192000
ENDMAIN  DS    0H                                                  0649 02193000
*/*  ******************************************************  @Z40LB01*/ 02194000
*/*                                                          @Z40LB01*/ 02195000
*/*   CLEANUP AND EXIT PROCEDURE                             @Z40LB01*/ 02196000
*/*                                                          @Z40LB01*/ 02197000
*/*  ******************************************************  @Z40LB01*/ 02198000
*                                                                  0649 02199000
*   BITSW=''B;                      /* RESET DSP SWITCHES    @Z40LB01*/ 02200000
@RF00232 L     @04,@CA01294                                        0649 02201000
         MVI   BITSW-BITSW(@04),X'00'                              0649 02202000
*   RETURN;                         /* RETURN TO ICBMSG15    @Z40LB01*/ 02203000
@EL00001 L     @13,4(,@13)                                         0650 02204000
@EF00001 DS    0H                                                  0650 02205000
@ER00001 LM    @14,@12,12(@13)                                     0650 02206000
         BR    @14                                                 0650 02207000
*                                                                  0651 02208000
*/******************* SUBROUTINES ************************   @Z40LB01*/ 02209000
*                                                                  0651 02210000
*MSG56AL:                                                          0651 02211000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @OZ30157*/ 02212000
MSG56AL  DS    0H                                                  0652 02213000
*/********************************************************** @OZ30157*/ 02214000
*/*                                                          @OZ30157*/ 02215000
*/* PROCEDURE NAME: MSG56AL                                  @OZ30157*/ 02216000
*/*                                                          @OZ30157*/ 02217000
*/* FUNCTION: DISPLAY ALTMSC STATUS                          @OZ30157*/ 02218000
*/*                                                          @OZ30157*/ 02219000
*/* INPUTS: MSC SECTORS 04, 40, AND IEZSSC                   @OZ30157*/ 02220000
*/*                                                          @OZ30157*/ 02221000
*/* OUTPUTS: ONE WTO LINE WITH ALTERNATE MSC STATUS          @OZ30157*/ 02222000
*/*                                                          @OZ30157*/ 02223000
*/********************************************************** @OZ30157*/ 02224000
*                                                                  0652 02225000
*   DCL                                                            0652 02226000
*     MS56AL14 FIXED(31);           /* LOCAL RETURN REG SAVE @OZ30157*/ 02227000
*   DCL                                                            0653 02228000
*     1 MSGBMAP CHAR(52) BASED(WPLPTR+4),/* ALT MSC MSG      @OZ30157*/ 02229000
*      2 * CHAR(8),                 /* HEADING               @OZ30157*/ 02230000
*      2 ALMSCAD CHAR(3),           /* MSC ADR               @OZ30157*/ 02231000
*       3 ALMSCCH CHAR(1),          /* CHANNEL               @OZ30157*/ 02232000
*       3 ALMSCCU CHAR(2),          /* CONTROL UNIT          @OZ30157*/ 02233000
*      2 * CHAR(4),                 /* CHARS IS              @OZ30157*/ 02234000
*      2 ALTMONOF CHAR(7),          /* OFFLINE               @OZ30157*/ 02235000
*       3 ALTMONON CHAR(2),         /* O/                    @OZ30157*/ 02236000
*       3 ALTMRDYO CHAR(5),         /* READY                 @OZ30157*/ 02237000
*      2 * CHAR(3),                 /* -                     @OZ30157*/ 02238000
*      2 ALTMUNUS CHAR(8),          /* UNUSABLE              @OZ30157*/ 02239000
*       3 ALTMUS CHAR(6),           /* USABLE                @OZ30157*/ 02240000
*      2 * CHAR(3),                 /* -                     @OZ30157*/ 02241000
*      2 ALTMRCD CHAR(12),          /* REASON CODE           @OZ30157*/ 02242000
*       3 ALTMNIML CHAR(9),         /* NOT IMLED             @OZ30157*/ 02243000
*      2 * CHAR(1),                 /* BLANK                 @OZ30157*/ 02244000
*      2 ALTMRSNU CHAR(3),          /*                       @OZ30157*/ 02245000
*       3 ALTMRSN CHAR(2),          /* REASON CODE HEX       @OZ30157*/ 02246000
*       3 ALTMRSNY CHAR(1);         /*                       @OZ30157*/ 02247000
*   DCL                                                            0654 02248000
*     1 WCS4C BASED(QAPTR(2)),      /* SECTOR 4C             @OZ30157*/ 02249000
*      2 WC4CRSNP CHAR(2),          /* REASON CODE FOR UNPK  @OZ30157*/ 02250000
*       3 WC4CRSN CHAR(1);          /* REASON CODE           @OZ30157*/ 02251000
*   RFY                                                            0655 02252000
*     R14 RSTD;                     /*                       @OZ30157*/ 02253000
*   MS56AL14=R14;                   /* SAVE RETURN REG       @OZ30157*/ 02254000
         ST    R14,MS56AL14                                        0656 02255000
*   RFY                                                            0657 02256000
*     R14 UNRSTD;                   /*                       @OZ30157*/ 02257000
*   UCBPTR=ICBAUCB;                 /* GET PTR TO ALT MSC UCB@OZ30157*/ 02258000
         L     @04,@CA00927                                        0658 02259000
         L     @15,CVTPTR                                          0658 02260000
         L     @15,CVTEXT2(,@15)                                   0658 02261000
         L     @15,CVTICB(,@15)                                    0658 02262000
         L     @00,ICBAUCB(,@15)                                   0658 02263000
         ST    @00,UCBPTR-UCBPTR(,@04)                             0658 02264000
*   IF UCBPTR=0 THEN                /* IF NO SUCH DEVICE     @OZ30157*/ 02265000
         LTR   @00,@00                                             0659 02266000
         BNZ   @RF00659                                            0659 02267000
*     DO;                           /* THEN SAY SO           @OZ30157*/ 02268000
*       ALMSCAD='NO';               /* NO                    @OZ30157*/ 02269000
         LA    @04,4                                               0661 02270000
         AL    @04,WPLPTR                                          0661 02271000
         MVI   ALMSCAD+2(@04),C' '                                 0661 02272000
         MVC   ALMSCAD(2,@04),@CC02904                             0661 02273000
*       ALTMONOF='ALTMSC';          /* ALTERNATE MSC         @OZ30157*/ 02274000
         MVI   ALTMONOF+6(@04),C' '                                0662 02275000
         MVC   ALTMONOF(6,@04),@CC02905                            0662 02276000
*     END;                          /*                       @OZ30157*/ 02277000
*   ELSE                            /* OTHERWISE, GET STAT   @OZ30157*/ 02278000
*     DO;                           /* AND WTO               @OZ30157*/ 02279000
*                                                                  0664 02280000
         B     @RC00659                                            0664 02281000
@RF00659 DS    0H                                                  0665 02282000
*       /*************************************************************/ 02283000
*       /*                                                           */ 02284000
*       /* PUT IN ADDRESS FROM UCB(SEE ICB2MSG)              @OZ30157*/ 02285000
*       /*                                                           */ 02286000
*       /*************************************************************/ 02287000
*                                                                  0665 02288000
*       ALMSCAD=UCBNAME;            /* MOVE IN UCB NAME      @OZ30157*/ 02289000
*                                                                  0665 02290000
         LA    @04,4                                               0665 02291000
         AL    @04,WPLPTR                                          0665 02292000
         L     @15,@CA00927                                        0665 02293000
         L     @15,UCBPTR-UCBPTR(,@15)                             0665 02294000
         MVC   ALMSCAD(3,@04),UCBNAME(@15)                         0665 02295000
*       /*************************************************************/ 02296000
*       /*                                                           */ 02297000
*       /* GET STATUS FROM UCB (ALTMONOF ETC)                @OZ30157*/ 02298000
*       /*                                                           */ 02299000
*       /*************************************************************/ 02300000
*                                                                  0666 02301000
*       IF UCBONLI=BZERO THEN       /* IF SECNDRY DEVICE OFFLINE   0666 02302000
*                                                            @OZ30157*/ 02303000
         TM    UCBONLI(@15),B'10000000'                            0666 02304000
         BNZ   @RF00666                                            0666 02305000
*         ALTMONOF='OFFLINE';       /* THEN SAY SO           @OZ30157*/ 02306000
         MVC   ALTMONOF(7,@04),@CC02856                            0667 02307000
*       ELSE                        /* NO ALT MSC            @OZ30157*/ 02308000
*         DO;                       /* ALT MSC AVAIL CODE    @OZ30157*/ 02309000
         B     @RC00666                                            0668 02310000
@RF00666 DS    0H                                                  0669 02311000
*           ALTMONOF='O/     ';     /* FIRST SAY ONLINE      @OZ30157*/ 02312000
         LA    @04,4                                               0669 02313000
         AL    @04,WPLPTR                                          0669 02314000
         MVC   ALTMONOF(7,@04),@CC02906                            0669 02315000
*           ALTMRDYO='READY';       /* AND READY             @OZ30157*/ 02316000
*                                                                  0670 02317000
         MVC   ALTMRDYO(5,@04),@CC02907                            0670 02318000
*           /*********************************************************/ 02319000
*           /*                                                       */ 02320000
*           /* ISSUE QUERY FOR SECTOR 04                     @OZ30157*/ 02321000
*           /*                                                       */ 02322000
*           /*********************************************************/ 02323000
*                                                                  0671 02324000
*           QAPTR(1)=ADDR(QUBUF1);  /* SET FIRST QUERY       @OZ30157*/ 02325000
         LA    @04,44                                              0671 02326000
         AL    @04,WORKPTR                                         0671 02327000
         ST    @04,QAPTR                                           0671 02328000
*           QBCNT=F2;               /* TWO QUERIES           @OZ30157*/ 02329000
         MVC   QBCNT(4),@CF00056                                   0672 02330000
*           QBENT(1)=QBW04;         /* FOR SECTOR 04         @OZ30157*/ 02331000
         MVI   QBENT+12,C' '                                       0673 02332000
         MVC   QBENT+13(31),QBENT+12                               0673 02333000
         MVC   QBENT(12),QBW04                                     0673 02334000
*           QBENT(2)=QBW4C;         /* AND 4C                @OZ30157*/ 02335000
         MVI   QBENT+56,C' '                                       0674 02336000
         MVC   QBENT+57(31),QBENT+56                               0674 02337000
         MVC   QBENT+44(12),QBW4C                                  0674 02338000
*           CALL MSG56GQ;           /* TO SEE IF WAS IMLED   @OZ30157*/ 02339000
*                                                                  0675 02340000
         BAL   @14,MSG56GQ                                         0675 02341000
*           /*********************************************************/ 02342000
*           /*                                                       */ 02343000
*           /* IF RETURN NON-ZERO, SAY NOT AVAILABLE, NOT IMLED      */ 02344000
*           /*                                               @OZ30157*/ 02345000
*           /*                                                       */ 02346000
*           /*********************************************************/ 02347000
*                                                                  0676 02348000
*           IF RETC^=F0 THEN        /* IF CANNOT QUERY 04    @OZ30157*/ 02349000
         LH    @04,RETC                                            0676 02350000
         LTR   @04,@04                                             0676 02351000
         BZ    @RF00676                                            0676 02352000
*             DO;                   /* THEN                  @OZ30157*/ 02353000
*               ALTMUNUS='UNUSABLE';/* SAY UNUSABLE          @OZ30157*/ 02354000
         LA    @04,4                                               0678 02355000
         AL    @04,WPLPTR                                          0678 02356000
         MVC   ALTMUNUS(8,@04),@CC02908                            0678 02357000
*               ALTMNIML='NOT INIT ';/* AND NOT IMLED        @OZ30157*/ 02358000
         MVC   ALTMNIML(9,@04),@CC02909                            0679 02359000
*             END;                  /*                       @OZ30157*/ 02360000
*           ELSE                    /*                       @OZ30157*/ 02361000
*             DO;                   /* CHECK CODES           @OZ30157*/ 02362000
*                                                                  0681 02363000
         B     @RC00676                                            0681 02364000
@RF00676 DS    0H                                                  0682 02365000
*               /*****************************************************/ 02366000
*               /*                                                   */ 02367000
*               /* ELSE IF STATUS BYTE IS 00 SAY USABLE      @OZ30157*/ 02368000
*               /*                                                   */ 02369000
*               /*****************************************************/ 02370000
*                                                                  0682 02371000
*               IF WC4CRSN='00'X THEN/* IF 00, IS GOOD IML   @OZ30157*/ 02372000
         L     @04,QAPTR+4                                         0682 02373000
         CLI   WC4CRSN(@04),X'00'                                  0682 02374000
         BNE   @RF00682                                            0682 02375000
*                 ALTMUS='USABLE';  /* SO SAY SO             @OZ30157*/ 02376000
         L     @04,WPLPTR                                          0683 02377000
         MVC   ALTMUS+4(6,@04),@CC02911                            0683 02378000
*               ELSE                /* IF NOT, MUST          @OZ30157*/ 02379000
*                 DO;               /* PRINT REASON CODE     @OZ30157*/ 02380000
         B     @RC00682                                            0684 02381000
@RF00682 DS    0H                                                  0685 02382000
*                   ALTMUNUS='UNUSABLE';/* IS UNUSABLE       @OZ30157*/ 02383000
         LA    @04,4                                               0685 02384000
         AL    @04,WPLPTR                                          0685 02385000
         MVC   ALTMUNUS(8,@04),@CC02908                            0685 02386000
*                   ALTMRCD='REASON CODE ';/* WITH REASON          0686 02387000
*                                      CODE@OZ30157                  */ 02388000
*                                                                  0686 02389000
         MVC   ALTMRCD(12,@04),@CC02912                            0686 02390000
*                   /*************************************************/ 02391000
*                   /*                                               */ 02392000
*                   /* UNPACK STATUS BYTE INTO MESSAGE       @OZ30157*/ 02393000
*                   /*                                               */ 02394000
*                   /*************************************************/ 02395000
*                                                                  0687 02396000
*                   UNPK(ALTMRSNU,WC4CRSNP);/* UNPACK RSN COD      0687 02397000
*                                                            @OZ30157*/ 02398000
         L     @15,QAPTR+4                                         0687 02399000
         UNPK  ALTMRSNU(3,@04),WC4CRSNP(2,@15)                     0687 02400000
*                   TR(ALTMRSN,TRANS);/* GET GOOD PRINTABLE  @OZ30157*/ 02401000
         TR    ALTMRSN(2,@04),TRANS                                0688 02402000
*                   ALTMRSNY=' ';   /* CLEAR EXTRA BYTE      @OZ30157*/ 02403000
         MVI   ALTMRSNY(@04),C' '                                  0689 02404000
*                 END;              /* END SET REASON CODE   @OZ30157*/ 02405000
*             END;                  /* END GOOD RET 2        @OZ30157*/ 02406000
@RC00682 DS    0H                                                  0692 02407000
*         END;                      /* END ALT MSC CODE      @OZ30157*/ 02408000
@RC00676 DS    0H                                                  0693 02409000
*     END;                          /* END OF WTO FOR ALTMSC @OZ30157*/ 02410000
@RC00666 DS    0H                                                  0694 02411000
*   WPLPTR=WPLPTR+WPLMLLEN;         /* SET FOR NEXT LINE     @OZ30157*/ 02412000
@RC00659 L     @04,WPLPTR                                          0694 02413000
         SLR   @00,@00                                             0694 02414000
         IC    @00,WPLMLLEN(,@04)                                  0694 02415000
         ALR   @00,@04                                             0694 02416000
         ST    @00,WPLPTR                                          0694 02417000
*   MSGCNT=F2;                      /* TWO MESSAGES THIS TIME@OZ30157*/ 02418000
         MVC   MSGCNT(2),@CH00056                                  0695 02419000
*   RFY                                                            0696 02420000
*     R14 RSTD;                     /*                       @OZ30157*/ 02421000
*   R14=MS56AL14;                   /* RESTORE RETURN REG    @OZ30157*/ 02422000
         L     R14,MS56AL14                                        0697 02423000
*   RFY                                                            0698 02424000
*     R14 UNRSTD;                   /*                       @OZ30157*/ 02425000
*   RETURN;                         /*                       @OZ30157*/ 02426000
@EL00002 DS    0H                                                  0699 02427000
@EF00002 DS    0H                                                  0699 02428000
@ER00002 BR    @14                                                 0699 02429000
*   END MSG56AL;                    /* END ALTMSC ROUTINE    @OZ30157*/ 02430000
*MSG56MS:                                                          0701 02431000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @OZ30157*/ 02432000
MSG56MS  DS    0H                                                  0702 02433000
*/********************************************************** @OZ30157*/ 02434000
*/*                                                          @OZ30157*/ 02435000
*/* PROCEDURE NAME: MSG56MS                                  @OZ30157*/ 02436000
*/*                                                          @OZ30157*/ 02437000
*/* FUNCTION: DISPLAY MSVI AND JOURNAL STATUS                @OZ30157*/ 02438000
*/*                                                          @OZ30157*/ 02439000
*/* INPUTS: HOST TABLES                                      @OZ30157*/ 02440000
*/*                                                          @OZ30157*/ 02441000
*/* OUTPUTS: ONE WTO LINE WITH MSVI STATUS                   @OZ30157*/ 02442000
*/*                                                          @OZ30157*/ 02443000
*/********************************************************** @OZ30157*/ 02444000
*                                                                  0702 02445000
*   DCL                                                            0702 02446000
*     MS56MS14 FIXED(31);           /* LOCAL RETURN REG SAVE @OZ30157*/ 02447000
*   DCL                                                            0703 02448000
*     DISABL CHAR(8) CONSTANT('DISABLED');/*                 @OZ30157*/ 02449000
*   DCL                                                            0704 02450000
*     ENABLE CHAR(8) CONSTANT('ENABLED ');/*                 @OZ30157*/ 02451000
*   DCL                                                            0705 02452000
*     1 MSGBDS CHAR(31) BASED(WPLPTR+4),/*                   @OZ30157*/ 02453000
*      2 * CHAR(5),                 /* HEADER                @OZ30157*/ 02454000
*      2 MSGBVIST CHAR(8),          /* ENABLED/DISABLED      @OZ30157*/ 02455000
*      2 * CHAR(10),                /* HEADER - JOURNAL      @OZ30157*/ 02456000
*      2 MSGBJRST CHAR(8);          /* ENABLED/DISABLED      @OZ30157*/ 02457000
*   RFY                                                            0706 02458000
*     R14 RSTD;                     /*                       @OZ30157*/ 02459000
*   MS56MS14=R14;                   /* SAVE RETURN REG       @OZ30157*/ 02460000
         ST    R14,MS56MS14                                        0707 02461000
*   RFY                                                            0708 02462000
*     R14 UNRSTD;                   /*                       @OZ30157*/ 02463000
*/* LOCATE VVI TABLE                                         @OZ30157*/ 02464000
*                                                                  0709 02465000
*   VVIPTR=ICBVVICB;                /* POINT TO VVICB        @OZ30157*/ 02466000
         L     @04,CVTPTR                                          0709 02467000
         L     @04,CVTEXT2(,@04)                                   0709 02468000
         L     @04,CVTICB(,@04)                                    0709 02469000
         L     @04,ICBVVICB(,@04)                                  0709 02470000
         ST    @04,VVIPTR                                          0709 02471000
*   IF VVIFLG0=BONE THEN            /* IF BOTH DISABLED      @OZ30157*/ 02472000
         TM    VVIFLG0(@04),B'10000000'                            0710 02473000
         BNO   @RF00710                                            0710 02474000
*     DO;                           /* THEN SAY THEY ARE     @OZ30157*/ 02475000
*       MSGBVIST=DISABL;            /* INVENTORY             @OZ30157*/ 02476000
         LA    @04,4                                               0712 02477000
         AL    @04,WPLPTR                                          0712 02478000
         MVC   MSGBVIST(8,@04),@CC02919                            0712 02479000
*       MSGBJRST=DISABL;            /* AND JOURNAL           @OZ30157*/ 02480000
         MVC   MSGBJRST(8,@04),@CC02919                            0713 02481000
*     END;                          /*                       @OZ30157*/ 02482000
*   ELSE                            /*                       @OZ30157*/ 02483000
*     DO;                           /*                       @OZ30157*/ 02484000
         B     @RC00710                                            0715 02485000
@RF00710 DS    0H                                                  0716 02486000
*       MSGBVIST=ENABLE;            /* ASSUME ENABLED FOR    @OZ30157*/ 02487000
         LA    @04,4                                               0716 02488000
         AL    @04,WPLPTR                                          0716 02489000
         MVC   MSGBVIST(8,@04),@CC02921                            0716 02490000
*       MSGBJRST=ENABLE;            /* BOTH                  @OZ30157*/ 02491000
         MVC   MSGBJRST(8,@04),@CC02921                            0717 02492000
*       IF VVIFLG1=BONE THEN        /* THEN IF INVENTORY IS  @OZ30157*/ 02493000
         L     @15,VVIPTR                                          0718 02494000
         TM    VVIFLG1(@15),B'01000000'                            0718 02495000
         BNO   @RF00718                                            0718 02496000
*         MSGBVIST=DISABL;          /* DISABLED, SAY SO      @OZ30157*/ 02497000
         MVC   MSGBVIST(8,@04),@CC02919                            0719 02498000
*       ELSE                        /* OTHERWISE, ONLY       @OZ30157*/ 02499000
*         IF VVIFLG2=BONE THEN      /* THE JOURNAL CAN BE    @OZ30157*/ 02500000
         B     @RC00718                                            0720 02501000
@RF00718 L     @04,VVIPTR                                          0720 02502000
         TM    VVIFLG2(@04),B'00100000'                            0720 02503000
         BNO   @RF00720                                            0720 02504000
*           MSGBJRST=DISABL;        /* IT IS, SO INDICATE    @OZ30157*/ 02505000
         L     @04,WPLPTR                                          0721 02506000
         MVC   MSGBJRST+4(8,@04),@CC02919                          0721 02507000
*     END;                          /*                       @OZ30157*/ 02508000
@RF00720 DS    0H                                                  0722 02509000
@RC00718 DS    0H                                                  0723 02510000
*   WPLMLLTF=''B;                   /* SET FOR DATA LINE     @OZ30157*/ 02511000
@RC00710 L     @04,WPLPTR                                          0723 02512000
         XC    WPLMLLTF(2,@04),WPLMLLTF(@04)                       0723 02513000
*   WPLMLLTC=BONE;                  /* AND BUMP POINTER      @OZ30157*/ 02514000
         OI    WPLMLLTC(@04),B'00100000'                           0724 02515000
*   WPLPTR=WPLPTR+WPLMLLEN;         /* TO END OF LINE        @OZ30157*/ 02516000
         SLR   @00,@00                                             0725 02517000
         IC    @00,WPLMLLEN(,@04)                                  0725 02518000
         ALR   @00,@04                                             0725 02519000
         ST    @00,WPLPTR                                          0725 02520000
*   MSGCNT=F2;                      /* TWO MESSAGE LINES     @OZ30157*/ 02521000
         MVC   MSGCNT(2),@CH00056                                  0726 02522000
*   RFY                                                            0727 02523000
*     R14 RSTD;                     /*                       @OZ30157*/ 02524000
*   R14=MS56MS14;                   /* RESTORE RETURN REG    @OZ30157*/ 02525000
         L     R14,MS56MS14                                        0728 02526000
*   RFY                                                            0729 02527000
*     R14 UNRSTD;                   /*                       @OZ30157*/ 02528000
*   RETURN;                         /*                       @OZ30157*/ 02529000
@EL00003 DS    0H                                                  0730 02530000
@EF00003 DS    0H                                                  0730 02531000
@ER00003 BR    @14                                                 0730 02532000
*   END MSG56MS;                    /* END MSVI ROUTINE      @OZ30157*/ 02533000
*MSG56PA:                                                          0732 02534000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @OZ30157*/ 02535000
MSG56PA  DS    0H                                                  0733 02536000
*/********************************************************************/ 02537000
*/*                                                                  */ 02538000
*/* PROCEDURE NAME: MSG56PA                                          */ 02539000
*/*                                                                  */ 02540000
*/* FUNCTION: DISPLAY PATH STATUS - CPU, SDG, DRC                    */ 02541000
*/*                                                                  */ 02542000
*/* INPUTS: SYSTEM AND MSC TABLES AND MSC SECTORS AS FOLLOWS:        */ 02543000
*/*            CVT                                                   */ 02544000
*/*            UCB AND UCB INDEX                                     */ 02545000
*/*            ICB                                                   */ 02546000
*/*            CONFIGURATION INDEX AND MANUFACTURER'S ID TABLE       */ 02547000
*/*            CONFIGURATION DATA TABLE                              */ 02548000
*/*            VERIFICATION TABLE                                    */ 02549000
*/*            MSC WCS SECTORS 0F, 7C, 7D                            */ 02550000
*/*                                                                  */ 02551000
*/* DATA AREAS: CPU PATH HEADER TABLE                                */ 02552000
*/*             CPU PATH DETAIL TABLE                                */ 02553000
*/*             SDG PATH TABLE                                       */ 02554000
*/*             PAB TABLE                                            */ 02555000
*/*             DRC PATH TABLE                                       */ 02556000
*/*                                                                  */ 02557000
*/* OUTPUTS: WTO LINES WITH PATH STATUS AS REQUESTED                 */ 02558000
*/*                                                                  */ 02559000
*/* CALLS: MSG56F - GETMAIN                                          */ 02560000
*/*        MSG56G - DISPLAY CPU STATUS                               */ 02561000
*/*        MSG56H - DISPLAY SDG STATUS                               */ 02562000
*/*        MSG56I - DISPLAY DRC STATUS                               */ 02563000
*/*        MSG56GQ- ISSUE QUERIES                                    */ 02564000
*/*        MSG56QU- GET QUALIFIERS                                   */ 02565000
*/*                                                          @OZ30157*/ 02566000
*/********************************************************************/ 02567000
*                                                                  0733 02568000
*   DCL                                                            0733 02569000
*     MS56PA14 FIXED(31);           /* LOCAL RETURN REG SAVE @OZ30157*/ 02570000
*/********************************************************************/ 02571000
*/*                                                                  */ 02572000
*/* THIS STRUCTURE MAPS THE CONFIGURATION INDEX/ MANUFACTURERS ID    */ 02573000
*/* RECORD FROM THE CONFIGURATION TABLE AS USED IN PATHS DSP @OZ30157*/ 02574000
*/*                                                                  */ 02575000
*/********************************************************************/ 02576000
*                                                                  0734 02577000
*   DCL                                                            0734 02578000
*     1 CONFXTBL BASED(CONXPTR),    /* CONFIG INDEX ENTRY    @OZ30157*/ 02579000
*      2 CONFXTAB(16) CHAR(8),      /* INDEX ENTRIES         @OZ30157*/ 02580000
*/********************************************************************/ 02581000
*/*                                                                  */ 02582000
*/* IN THE SAME RECORD, MAP THE MANUFACTURERS ID TABLE       @OZ30157*/ 02583000
*/*                                                                  */ 02584000
*/********************************************************************/ 02585000
*                                                                  0734 02586000
*      2 MIDCTAB(16),               /* 16 ENTRIES            @OZ30157*/ 02587000
*       3 MIDCPUID CHAR(5),         /* MANUF ID THIS CPU     @OZ30157*/ 02588000
*       3 MIDCPAIR FIXED(8),        /* INDEX TO OTHER CPU IN PAIR  0734 02589000
*                                                            @OZ30157*/ 02590000
*       3 MIDCFLG1 BIT(8),          /* FIRST FLAG BYTE       @OZ30157*/ 02591000
*        4 * BIT(1),                /* MUST BE ZERO          @OZ30157*/ 02592000
*        4 MIDCFPOT BIT(1),         /* MAY BE MULTIPROC PAIR @OZ30157*/ 02593000
*        4 MIDCFALT BIT(1),         /* ALTERNATE PATH TO THIS CPU  0734 02594000
*                                                            @OZ30157*/ 02595000
*        4 MIDCFZZ1 BIT(3),         /* MUST BE ZERO          @OZ30157*/ 02596000
*        4 MIDCFIF BIT(2),          /* INTERFACE ID          @OZ30157*/ 02597000
*         5 MIDCFIF1 BIT(1),        /* FIRST BIT OF INTERFACE ID   0734 02598000
*                                                            @OZ30157*/ 02599000
*         5 MIDCFIF2 BIT(1),        /* FIRST BIT OF INTERFACE ID   0734 02600000
*                                                            @OZ30157*/ 02601000
*       3 MIDCFLG2 BIT(8),          /* SECOND FLAG BYTE      @OZ30157*/ 02602000
*        4 MIDCFVAL BIT(1),         /* ENTRY IS VALID        @OZ30157*/ 02603000
*        4 MIDCFASC BIT(1),         /* IS ASSOCIATED         @OZ30157*/ 02604000
*        4 MIDCFCBF BIT(1),         /* COMM MSG BUFF         @OZ30157*/ 02605000
*        4 MIDCFZZZ BIT(2),         /* MUST BE ZERO          @OZ30157*/ 02606000
*        4 MIDCFAIF BIT(2),         /* ALT INTERFACE ID      @OZ30157*/ 02607000
*         5 MIDCFAI1 BIT(1),        /* FIRST BIT OF ALT INTFC ID   0734 02608000
*                                                            @OZ30157*/ 02609000
*         5 MIDCFAI2 BIT(1);        /* FIRST BIT OF ALT INTFC ID   0734 02610000
*                                                            @OZ30157*/ 02611000
*   DCL                                                            0735 02612000
*     1 CONFXENT BASED(TABPTR1),    /* INDIV TABLE ENTRY     @OZ30157*/ 02613000
*      2 CXCSCON BIT(8),            /*                       @OZ30157*/ 02614000
*       3 CXCSCCS BIT(1),           /* OFF=SA, ON=CART STORE @OZ30157*/ 02615000
*       3 * BIT(3),                 /* NOT USED              @OZ30157*/ 02616000
*       3 CXCSCS0 BIT(1),           /* SA TO CS 0            @OZ30157*/ 02617000
*       3 CXCSCS1 BIT(1),           /* SA TO CS 1            @OZ30157*/ 02618000
*       3 * BIT(2),                 /* NOT USED              @OZ30157*/ 02619000
*      2 * BIT(8),                  /* ALWAYS 00000000 1     @OZ30157*/ 02620000
*      2 CXSAIF(3),                 /* 3 SA INTERFACES - A, B, C   0735 02621000
*                                      2-7@OZ30157                   */ 02622000
*       3 CXSACPU FIXED(8),         /* INDEX TO CPU          @OZ30157*/ 02623000
*       3 CXSACUCH BIT(8),          /* CU AND CHANNEL        @OZ30157*/ 02624000
*        4 CXSACU BIT(2),           /* CU NUMBER             @OZ30157*/ 02625000
*        4 * BIT(2),                /* NOT USED 00           @OZ30157*/ 02626000
*        4 CXSACH BIT(4);           /* CHANNEL ADDRESS       @OZ30157*/ 02627000
*/********************************************************************/ 02628000
*/*                                                                  */ 02629000
*/* THIS STRUCTURE MAPS THE CONFIGURATION TABLE ENTRY FOR USE BY     */ 02630000
*/* THE PATHS DISPLAY                                        @OZ30157*/ 02631000
*/*                                                                  */ 02632000
*/********************************************************************/ 02633000
*                                                                  0736 02634000
*   DCL                                                            0736 02635000
*     1 CONFDATA(16) BASED(CONDPTR),/* CONFIG TABLE          @OZ30157*/ 02636000
*      2 CONDCONF BIT(8),           /*                       @OZ30157*/ 02637000
*       3 CONDNSHR BIT(1),          /* ON IF NOT SHARED      @OZ30157*/ 02638000
*       3 CONDVINU BIT(1),          /* VUA IN USE            @OZ30157*/ 02639000
*       3 CONDDTYP BIT(1),          /* ON IF 3333-1          @OZ30157*/ 02640000
*       3 CONDSDG BIT(5),           /* SDG NUMBER            @OZ30157*/ 02641000
*      2 CONDALTP BIT(8),           /* ALT PATH INFO         @OZ30157*/ 02642000
*       3 CONA1NU BIT(1),           /* NOT USED              @OZ30157*/ 02643000
*       3 CONA1B BIT(1),            /* SA1 INTF B IS ALT     @OZ30157*/ 02644000
*       3 CONA1C BIT(1),            /* SA1 INTF C IS ALT     @OZ30157*/ 02645000
*       3 CONA1D BIT(1),            /* SA1 INTF D IS ALT     @OZ30157*/ 02646000
*       3 CONA2NU BIT(1),           /* NOT USED              @OZ30157*/ 02647000
*       3 CONA2B BIT(1),            /* SA2 INTF B IS ALT     @OZ30157*/ 02648000
*       3 CONA2C BIT(1),            /* SA2 INTF C            @OZ30157*/ 02649000
*       3 CONA2D BIT(1),            /* SA2 INTF D            @OZ30157*/ 02650000
*      2 CONDMVTP FIXED(16);        /* MVT DB PTR            @OZ30157*/ 02651000
*/********************************************************************/ 02652000
*/*                                                                  */ 02653000
*/* THIS STRUCTURE MAPS WCS SECTORS 7C THROUGH 7F DATA IN QUBUF1     */ 02654000
*/* FOR USE IN THE PATHS DISPLAY                             @OZ30157*/ 02655000
*/*                                                                  */ 02656000
*/********************************************************************/ 02657000
*                                                                  0737 02658000
*   DCL                                                            0737 02659000
*     1 WCS7X BASED(PWCS7X),        /* SECTOR 7C THROUGH 7F  @OZ30157*/ 02660000
*      2 DRCSA(4),                  /* DRC-SA PATHS          @OZ30157*/ 02661000
*       3 DRCCON BIT(16),           /* SA'S BY BIT           @OZ30157*/ 02662000
*       3 * CHAR(2),                /* NOT USED              @OZ30157*/ 02663000
*      2 DRCUCB(4) CHAR(4),         /* DRC UCBS              @OZ30157*/ 02664000
*      2 DRDUCB(8) CHAR(4),         /* DRD PATH UCBS         @OZ30157*/ 02665000
*       3 DRDFLGS BIT(8),           /*                       @OZ30157*/ 02666000
*        4 DRDFVAL BIT(1),          /* VALID                 @OZ30157*/ 02667000
*        4 DRDFONL BIT(1),          /* ONLINE                @OZ30157*/ 02668000
*        4 DRDFRDY BIT(1),          /* READY/USABLE          @OZ30157*/ 02669000
*        4 DRDFAPR BIT(1),          /* ALT PATH RETRY        @OZ30157*/ 02670000
*        4 DRDDRC0 BIT(1),          /* TO DRC 0              @OZ30157*/ 02671000
*        4 DRDDRC1 BIT(1),          /* 1                     @OZ30157*/ 02672000
*        4 DRDDRC2 BIT(1),          /* 2                     @OZ30157*/ 02673000
*        4 DRDDRC3 BIT(1),          /* 3                     @OZ30157*/ 02674000
*       3 * CHAR(3),                /*                       @OZ30157*/ 02675000
*      2 SAUCB(4) CHAR(4),          /* SA UCBS               @OZ30157*/ 02676000
*       3 SAFLGS BIT(8),            /*                       @OZ30157*/ 02677000
*        4 SAFVAL BIT(1),           /* VALID                 @OZ30157*/ 02678000
*        4 SAFONL BIT(1),           /* ONLINE                @OZ30157*/ 02679000
*        4 SAFRDY BIT(1),           /* READY                 @OZ30157*/ 02680000
*        4 SAFBSY BIT(1),           /* BUSY                  @OZ30157*/ 02681000
*        4 * BIT(4),                /* ZEROS                 @OZ30157*/ 02682000
*       3 * CHAR(3);                /* NOT USED              @OZ30157*/ 02683000
*   DCL                                                            0738 02684000
*     1 DRCPUCB BASED(PTHPTR),      /* DRC PATH UCB          @OZ30157*/ 02685000
*      2 DRCFLGS(4) BIT(8),         /* ONE EACH LOGICAL PATH @OZ30157*/ 02686000
*       3 DRCFVAL BIT(1),           /* VALID                 @OZ30157*/ 02687000
*       3 DRCFONL BIT(1),           /* ONLINE                @OZ30157*/ 02688000
*       3 DRCFUSA BIT(1),           /* USABLE                @OZ30157*/ 02689000
*       3 DRCFAPR BIT(1),           /* ALT PATH RETRY        @OZ30157*/ 02690000
*       3 DRCFADR BIT(4);           /* DRD LOGICAL ADDRESS   @OZ30157*/ 02691000
*/********************************************************************/ 02692000
*/*                                                                  */ 02693000
*/* THIS STRUCTURE MAPS WCS SECTOR 0F AS USED IN PATHS DISPL @OZ30157*/ 02694000
*/*                                                                  */ 02695000
*/********************************************************************/ 02696000
*                                                                  0739 02697000
*   DCL                                                            0739 02698000
*     1 WCS0F BASED(PWCS0F),        /* SECTOR 0F DSECT       @OZ30157*/ 02699000
*      2 WC0FINIT BIT(8),           /* INTERFACES INITIALIZE @OZ30157*/ 02700000
*       3 WC0FINA BIT(1),           /* A                     @OZ30157*/ 02701000
*       3 WC0FINB BIT(1),           /* B                     @OZ30157*/ 02702000
*       3 WC0FINC BIT(1),           /* C                     @OZ30157*/ 02703000
*       3 WC0FIND BIT(1),           /* D                     @OZ30157*/ 02704000
*       3 * BIT(4),                 /* NOT USED              @OZ30157*/ 02705000
*      2 WC0FP BIT(8),              /* PRIMARY HOST ID       @OZ30157*/ 02706000
*       3 * BIT(4),                 /* NOT USED              @OZ30157*/ 02707000
*       3 WC0FPHIF BIT(2),          /* INTERFACE ID          @OZ30157*/ 02708000
*       3 * BIT(2),                 /* NOT USED              @OZ30157*/ 02709000
*      2 WC0FAP(4) CHAR(1),         /* FOR AP/MP CHECK       @OZ30157*/ 02710000
*       3 WC0FAPCK BIT(8),          /* AP/MP HERE            @OZ30157*/ 02711000
*        4 * BIT(5),                /* NOT USED              @OZ30157*/ 02712000
*        4 WC0FAPVL BIT(1),         /* ALP PATH IS VALID     @OZ30157*/ 02713000
*        4 * BIT(1),                /* NOT USED              @OZ30157*/ 02714000
*        4 WC0FMPPR BIT(1);         /* POTENTIAL MP PAIR     @OZ30157*/ 02715000
*/********************************************************************/ 02716000
*/*                                                                  */ 02717000
*/* MAP THE VIRTUAL UCB AREA                                 @OZ30157*/ 02718000
*/*                                                                  */ 02719000
*/********************************************************************/ 02720000
*                                                                  0740 02721000
*   DCL                                                            0740 02722000
*     VUCBAD(64) PTR(32) BASED(VVIUCB);/* 64 VUCB ADDRESSES  @OZ30157*/ 02723000
*/********************************************************************/ 02724000
*/*                                                                  */ 02725000
*/* THESE STRUCTURES MAP THE VERIFICATION TABLE AS IN PATHS DISPL    */ 02726000
*/* VERIFICATION RECORD 1                                    @OZ30157*/ 02727000
*/*                                                                  */ 02728000
*/********************************************************************/ 02729000
*                                                                  0741 02730000
*   DCL                                                            0741 02731000
*     1 VERTAB BASED(VERPTR),       /* VERIFICATION TABLE    @OZ30157*/ 02732000
*      2 VESDGNDX(16),              /* SDGS BY SA NUMBER 50  @OZ30157*/ 02733000
*       3 VESDG1 FIXED(8),          /* SDG 1 FOR THIS SA 50  @OZ30157*/ 02734000
*       3 VESDG2 FIXED(8),          /* SDG 2 FOR THIS SA 51  @OZ30157*/ 02735000
*       3 * FIXED(15);              /* NOT USED 52           @OZ30157*/ 02736000
*   DCL                                                            0742 02737000
*     PKPTR PTR(31);                /* PTR TO UNPK VESDG     @OZ30157*/ 02738000
*   DCL                                                            0743 02739000
*     PACK2 CHAR(2) BASED(PKPTR);   /* OVERLAY FOR UNPK      @OZ30157*/ 02740000
*/********************************************************************/ 02741000
*/*                                                                  */ 02742000
*/* VARIABLES, WORK AREAS, AND CONSTANTS USED WITHIN THIS    @OZ30157*/ 02743000
*/* MODULE ONLY                                              @OZ30157*/ 02744000
*/*                                                                  */ 02745000
*/********************************************************************/ 02746000
*                                                                  0744 02747000
*   DCL                                                            0744 02748000
*     PWCS0F PTR(31),               /* PTR TO WCS 0F         @OZ30157*/ 02749000
*     CONXPTR PTR(31),              /* PTR TO CONFIG INDEX   @OZ30157*/ 02750000
*     LASTENT PTR(31),              /* LAST ENTRY TRACKER    @OZ30157*/ 02751000
*     ENDPTR PTR(31);               /* GETMAIN END POINTER   @OZ30157*/ 02752000
*/********************************************************************/ 02753000
*/*                                                                  */ 02754000
*/* POINTERS TO BUILD CPU DETAIL TABLE - USED TO FIND THE            */ 02755000
*/* CURRENT ENTRY OF A TYPE TO ADD A VUA. SET TO ZERO AT             */ 02756000
*/* START OF EACH SDG, TO ENTRY ADDRESS ON FIRST OCCURRENCE          */ 02757000
*/* OF A VUA IN A PARTICULAR TYPE.                           @OZ30157*/ 02758000
*/*                                                                  */ 02759000
*/********************************************************************/ 02760000
*                                                                  0745 02761000
*   DCL                                                            0745 02762000
*     1 CURSTR,                     /*                       @OZ30157*/ 02763000
*      2 * BIT(8),                  /*                       @OZ30157*/ 02764000
*      2 ONLPTR PTR(24),            /* CURR ONLINE POINTER   @OZ30157*/ 02765000
*      2 * BIT(8),                  /*                       @OZ30157*/ 02766000
*      2 OFFPTR PTR(24),            /* CURR OFFLINE POINTER  @OZ30157*/ 02767000
*      2 * BIT(8),                  /*                       @OZ30157*/ 02768000
*      2 SUUPTR PTR(24);            /* CURR SUU POINTER      @OZ30157*/ 02769000
*   DCL                                                            0746 02770000
*     1 CURPTRS(3) DEF(CURSTR),     /* REDEF FOR INDEXED OPS @OZ30157*/ 02771000
*      2 * BIT(8),                  /* SWITCHES              @OZ30157*/ 02772000
*       3 USEADB BIT(1),            /* NEXT TO ADD VUAB      @OZ30157*/ 02773000
*       3 * BIT(7),                 /* NOT USED              @OZ30157*/ 02774000
*      2 CURPTR PTR(24);            /* CURRENT POINTERS      @OZ30157*/ 02775000
*   DCL                                                            0747 02776000
*     VUALEN FIXED(31) CONSTANT(388);/* LENGTH OF VUA ENTRY  @OZ30157*/ 02777000
*   DCL                                                            0748 02778000
*     VUAMIN FIXED(31) CONSTANT(10);/* LENGTH MINIMUM VUA ENT@OZ30157*/ 02779000
*/********************************************************************/ 02780000
*/*                                                                  */ 02781000
*/* WORK AREAS FOR CHANNEL, CONTROL UNIT AND DEVICE CALCS            */ 02782000
*/* AND FOR BIT ADJUSTMENT TO DO BIT COMPARES                @OZ30157*/ 02783000
*/*                                                                  */ 02784000
*/********************************************************************/ 02785000
*                                                                  0749 02786000
*   DCL                                                            0749 02787000
*     1 PTHWK BDY(DWORD),           /* PATH CALC WORK AREA   @OZ30157*/ 02788000
*      2 PCHAN FIXED(31),           /* CHANNEL ADDRESS WORK  @OZ30157*/ 02789000
*       3 * CHAR(3),                /* FROM CHAR FIELDS      @OZ30157*/ 02790000
*       3 PCHANCX CHAR(1),          /* INTO FIXED FIELDS     @OZ30157*/ 02791000
*        4 BITWK1 BIT(8),           /*                       @OZ30157*/ 02792000
*      2 PCNTL FIXED(31),           /* CNTL UNIT ADDR WORK   @OZ30157*/ 02793000
*       3 * CHAR(3),                /*                       @OZ30157*/ 02794000
*       3 PCNTLCX CHAR(1),          /*                       @OZ30157*/ 02795000
*        4 BITWK2 BIT(8),           /*                       @OZ30157*/ 02796000
*      2 PUNIT FIXED(31),           /* DVC ADDR WORK AREA    @OZ30157*/ 02797000
*       3 * CHAR(1),                /*                       @OZ30157*/ 02798000
*       3 PUNIT3 CHAR(3),           /*                       @OZ30157*/ 02799000
*        4 * CHAR(1),               /*                       @OZ30157*/ 02800000
*        4 PUNITCY CHAR(2),         /* WORK FOR CVD OPS      @OZ30157*/ 02801000
*         5 PUNITCX CHAR(1),        /*                       @OZ30157*/ 02802000
*          6 BITWK3 BIT(8);         /*                       @OZ30157*/ 02803000
*   DCL                                                            0750 02804000
*     1 CPXWK DEF(PTHWK),           /* CALC CPU ID WORK AREA @OZ30157*/ 02805000
*      2 * FIXED(8),                /* VERSION - NOT USED    @OZ30157*/ 02806000
*      2 CPXIDP CHAR(3),            /* CPU ID - SERIAL NUMBER@OZ30157*/ 02807000
*      2 CPXMODP1 CHAR(3),          /* UNPACK WORK SOURCE    @OZ30157*/ 02808000
*       3 CPXMODP CHAR(2);          /* MODEL NUMBER          @OZ30157*/ 02809000
*   DCL                                                            0751 02810000
*     1 CPYWK DEF(PTHWK),           /* CALC CPU ID WORK AREA @OZ30157*/ 02811000
*      2 * FIXED(8),                /* VERSION - NOT USED    @OZ30157*/ 02812000
*      2 CPXIDP1 CHAR(4);           /* UNPACK WORK SOURCE    @OZ30157*/ 02813000
*   DCL                                                            0752 02814000
*     CPXCPU CHAR(5) DEF(PTHWK) POS(2);/* PACKED FORM        @OZ30157*/ 02815000
*   DCL                                                            0753 02816000
*     1 CURRCPUW CHAR(11),          /* SAVE AREA             @OZ30157*/ 02817000
*      2 CPXIDC CHAR(6),            /* SAVE CPU SERIAL       @OZ30157*/ 02818000
*      2 CPXMODC1 CHAR(5),          /*                       @OZ30157*/ 02819000
*       3 CPXMODC CHAR(4);          /* AND MODEL NUMBER      @OZ30157*/ 02820000
*   DCL                                                            0754 02821000
*     1 CURRCPU CHAR(10) DEF(CURRCPUW),/* REDEF FOR COMPARE  @OZ30157*/ 02822000
*      2 CPXIDC1 CHAR(7);           /* UNPACK WORK AREA      @OZ30157*/ 02823000
*   DCL                                                            0755 02824000
*     TESTVAL FIXED(31) INIT(32768);/* START VALUE FOR SHIFT @OZ30157*/ 02825000
*   DCL                                                            0756 02826000
*     SATST FIXED(15);              /* WORK AREA             @OZ30157*/ 02827000
*   DCL                                                            0757 02828000
*     CURSTAT FIXED(8);             /* STATUS SAVE AREA      @OZ30157*/ 02829000
*   DCL                                                            0758 02830000
*     PRVSTAT FIXED(8);             /* STATUS SAVE AREA      @OZ30157*/ 02831000
*   DCL                                                            0759 02832000
*     CURCPUP CHAR(5);              /* CURRENT CPU IN PACKED @OZ30157*/ 02833000
*/********************************************************************/ 02834000
*/*                                                                  */ 02835000
*/* COMPARE AREA FOR CPUID                                   @OZ30157*/ 02836000
*/*                                                                  */ 02837000
*/********************************************************************/ 02838000
*                                                                  0760 02839000
*   DCL                                                            0760 02840000
*     1 COMPAREA,                   /* COMPARE AREA FOR      @OZ30157*/ 02841000
*      2 CMPCPUX CHAR(6),           /* CPUID                 @OZ30157*/ 02842000
*       3 CMPCPU CHAR(5);           /* IN 5 CHARACTER PACKED @OZ30157*/ 02843000
*/********************************************************************/ 02844000
*/*                                                                  */ 02845000
*/* MISCELLANEOUS CHARACTER VARIABLES AND CONSTANTS          @OZ30157*/ 02846000
*/*                                                                  */ 02847000
*/********************************************************************/ 02848000
*                                                                  0761 02849000
*   DCL                                                            0761 02850000
*     VUA00 CHAR(3) INIT('000000'X);/* BASIC VUA 00 VALUE    @OZ30157*/ 02851000
*   DCL                                                            0762 02852000
*     VUA3F CHAR(3) INIT('00030F'X);/* BASIC VUA 3F VALUE    @OZ30157*/ 02853000
*   DCL                                                            0763 02854000
*     OFFLN BIT(8) CONSTANT('02'X), /* OFFLINE SWITCH VALUE  @OZ30157*/ 02855000
*     ONLN BIT(8) CONSTANT('01'X),  /* ONLINE SWITCH VALUE   @OZ30157*/ 02856000
*     SUU BIT(8) CONSTANT('03'X),   /* SUU SWITCH VALUE      @OZ30157*/ 02857000
*     HEX01 BIT(8) CONSTANT('01'X), /* CONSTANT VALUES       @OZ30157*/ 02858000
*     HEX02 BIT(8) CONSTANT('02'X), /* FOR COMPARES          @OZ30157*/ 02859000
*     HEX03 BIT(8) CONSTANT('03'X), /*                       @OZ30157*/ 02860000
*     HEX04 BIT(8) CONSTANT('04'X); /*                       @OZ30157*/ 02861000
*   RFY                                                            0764 02862000
*     R14 RSTD;                     /*                       @OZ30157*/ 02863000
*   MS56PA14=R14;                   /* SAVE RETURN REG       @OZ30157*/ 02864000
         ST    R14,MS56PA14                                        0765 02865000
*   RFY                                                            0766 02866000
*     R14 UNRSTD;                   /*                       @OZ30157*/ 02867000
*   VVIPTR=ICBVVICB;                /* POINT TO VVICB        @OZ30157*/ 02868000
         L     @04,CVTPTR                                          0767 02869000
         L     @04,CVTEXT2(,@04)                                   0767 02870000
         L     @04,CVTICB(,@04)                                    0767 02871000
         MVC   VVIPTR(4),ICBVVICB(@04)                             0767 02872000
*   CPUPTR=F0;                      /* INSURE START AT 0     @OZ30157*/ 02873000
         SLR   @04,@04                                             0768 02874000
         ST    @04,CPUPTR                                          0768 02875000
*   CPHPTR=F0;                      /* FOR LATER CHECK       @OZ30157*/ 02876000
         ST    @04,CPHPTR                                          0769 02877000
*   CPHEND=F0;                      /* IN CASE OF ERROR      @OZ30157*/ 02878000
         ST    @04,CPHEND                                          0770 02879000
*   IF(DSPON=BZERO)&(DSPOFF=BZERO) THEN/* IF BOTH TO SHOW    @OZ30157*/ 02880000
         L     @04,@CA00041                                        0771 02881000
         L     @04,CWBPTR-CWBPTR(,@04)                             0771 02882000
         TM    DSPON(@04),B'01100000'                              0771 02883000
         BNZ   @RF00771                                            0771 02884000
*     DO;                           /* THEN SET BOTH FOR     @OZ30157*/ 02885000
*       DSPON=BONE;                 /* PATHS DSPLY ONLY      @OZ30157*/ 02886000
*       DSPOFF=BONE;                /* ON AND OFF            @OZ30157*/ 02887000
         OI    DSPON(@04),B'01100000'                              0774 02888000
*     END;                          /*                       @OZ30157*/ 02889000
*                                                                  0775 02890000
*   /*****************************************************************/ 02891000
*   /*                                                               */ 02892000
*   /* GET CONFIGURATION TABLE DATA, SECTS 0F, 7C-7F, AND            */ 02893000
*   /* VERIFICATION TABLE                                    @OZ30157*/ 02894000
*   /*                                                               */ 02895000
*   /*****************************************************************/ 02896000
*                                                                  0776 02897000
*   QAPTR(1)=ADDR(QUBUF1);          /* SET FOR FIRST QUERY   @OZ30157*/ 02898000
@RF00771 LA    @04,44                                              0776 02899000
         AL    @04,WORKPTR                                         0776 02900000
         ST    @04,QAPTR                                           0776 02901000
*   QBCNT=F4;                       /* COUNT TO 4            @OZ30157*/ 02902000
         MVC   QBCNT(4),@CF00045                                   0777 02903000
*   QBENT(1)=QBCIX;                 /* 1ST IS CONF INDX      @OZ30157*/ 02904000
         MVI   QBENT+12,C' '                                       0778 02905000
         MVC   QBENT+13(31),QBENT+12                               0778 02906000
         MVC   QBENT(12),QBCIX                                     0778 02907000
*   QBENT(2)=QBW0F;                 /* 2ND IS SECT 0F        @OZ30157*/ 02908000
         MVI   QBENT+56,C' '                                       0779 02909000
         MVC   QBENT+57(31),QBENT+56                               0779 02910000
         MVC   QBENT+44(12),QBW0F                                  0779 02911000
*   QBENT(3)=QBW7C;                 /* 3RD IS SECTS 7C-7F    @OZ30157*/ 02912000
         MVI   QBENT+100,C' '                                      0780 02913000
         MVC   QBENT+101(31),QBENT+100                             0780 02914000
         MVC   QBENT+88(12),QBW7C                                  0780 02915000
*   QBENT(4)=QBVER1;                /* 4TH IS VER REC 1      @OZ30157*/ 02916000
         MVI   QBENT+144,C' '                                      0781 02917000
         MVC   QBENT+145(31),QBENT+144                             0781 02918000
         MVC   QBENT+132(12),QBVER1                                0781 02919000
*   CALL MSG56GQ;                   /* GO GET THE DATA       @OZ30157*/ 02920000
         BAL   @14,MSG56GQ                                         0782 02921000
*   CONXPTR=QAPTR(1);               /* CONF INDEX PTR        @OZ30157*/ 02922000
         MVC   CONXPTR(4),QAPTR                                    0783 02923000
*   PWCS0F=QAPTR(2);                /* WCS 0F PTR            @OZ30157*/ 02924000
         MVC   PWCS0F(4),QAPTR+4                                   0784 02925000
*   PWCS7X=QAPTR(3);                /* PTR TO WCS 7C-7F      @OZ30157*/ 02926000
         MVC   PWCS7X(4),QAPTR+8                                   0785 02927000
*   VERPTR=QAPTR(7);                /* PTR TO VER REC 1      @OZ30157*/ 02928000
         MVC   VERPTR(4),QAPTR+24                                  0786 02929000
*   IF DSPCPU=BONE THEN             /* IF CPU PATH REQUEST   @OZ30157*/ 02930000
         L     @04,@CA00041                                        0787 02931000
         L     @04,CWBPTR-CWBPTR(,@04)                             0787 02932000
         TM    DSPCPU(@04),B'00000010'                             0787 02933000
         BNO   @RF00787                                            0787 02934000
*     DO;                           /* DO CPU PATH DISPLAY   @OZ30157*/ 02935000
*/*  *****************************************************************/ 02936000
*/*                                                                  */ 02937000
*/*   GET CPUID FOR LATER COMPARISON                         @OZ30157*/ 02938000
*/*                                                                  */ 02939000
*/*  *****************************************************************/ 02940000
*                                                                  0789 02941000
*       GEN CODE REFS(CPXWK) SETS(CPXWK);                          0789 02942000
*                                    /* GET THIS HOST CPUID  @OZ30157*/ 02943000
          STIDP CPXWK                                                   02944000
*       CURCPUP=CPXCPU;             /* SAVE PACKED FORM      @OZ30157*/ 02945000
         MVC   CURCPUP(5),CPXCPU                                   0790 02946000
*       UNPK(CPXIDC1,CPXIDP1);      /* UNPACK CPU SERIAL     @OZ30157*/ 02947000
         UNPK  CPXIDC1(7),CPXIDP1(4)                               0791 02948000
*       UNPK(CPXMODC1,CPXMODP1);    /* AND MODEL NUMBER      @OZ30157*/ 02949000
         UNPK  CPXMODC1(5),CPXMODP1(3)                             0792 02950000
*       TR(CURRCPU,TRANS);          /* AND TRANSLATE TO VALID@OZ30157*/ 02951000
         TR    CURRCPU(10),TRANS                                   0793 02952000
*       IF RETC=F0 THEN             /* IF GOOD RETURN CODE   @OZ30157*/ 02953000
         SLR   @04,@04                                             0794 02954000
         CH    @04,RETC                                            0794 02955000
         BNE   @RF00794                                            0794 02956000
*         DO;                       /* THEN CONTINUE         @OZ30157*/ 02957000
*           IEND=F1;                /* AVOID ERR MSG         @OZ30157*/ 02958000
         LA    @15,1                                               0796 02959000
         STH   @15,IEND                                            0796 02960000
*           I2=F1;                  /* BY SETTING INITIALLY  @OZ30157*/ 02961000
         STH   @15,I2                                              0797 02962000
*           IF DSPQUAL=BONE THEN    /* IF QUALIFIED REQUEST  @OZ30157*/ 02963000
         L     @15,@CA00041                                        0798 02964000
         L     @15,CWBPTR-CWBPTR(,@15)                             0798 02965000
         TM    DSPQUAL(@15),B'00100000'                            0798 02966000
         BNO   @RF00798                                            0798 02967000
*             DO;                   /* GO GET QUALIFIER      @OZ30157*/ 02968000
*               QUALLEN(1)=F10;     /* LENGTH OF 10          @OZ30157*/ 02969000
         MVC   QUALLEN(2),@CH00034                                 0800 02970000
*               QUALLEN(2)=F0;      /* ONE QUALIFIER ONLY    @OZ30157*/ 02971000
         STH   @04,QUALLEN+2                                       0801 02972000
*               CALL MSG56QU;       /* GET QUALIFIER VALUE   @OZ30157*/ 02973000
         BAL   @14,MSG56QU                                         0802 02974000
*               ENDSW=BZERO;        /*                       @OZ30157*/ 02975000
         NI    ENDSW,B'11111011'                                   0803 02976000
*               IF RETC=F0&QUALLEN(1)=F10 THEN/* IF QUAL VALID     0804 02977000
*                                                            @OZ30157*/ 02978000
         LH    @04,RETC                                            0804 02979000
         LTR   @04,@04                                             0804 02980000
         BNZ   @RF00804                                            0804 02981000
         CLC   QUALLEN(2),@CH00034                                 0804 02982000
         BNE   @RF00804                                            0804 02983000
*                 DO;               /*                       @OZ30157*/ 02984000
*                   PACK(CMPCPUX,QUAL(1));/* PACK TO 5 BYTES @OZ30157*/ 02985000
         PACK  CMPCPUX(6),QUAL(11)                                 0806 02986000
*                   DO I=F1 TO F16 WHILE(ENDSW^=BONE);/* FIND      0807 02987000
*                                                            @OZ30157*/ 02988000
         LA    @04,1                                               0807 02989000
         STH   @04,I                                               0807 02990000
@DL00807 TM    ENDSW,B'00000100'                                   0807 02991000
         BO    @DC00807                                            0807 02992000
*                     IF CMPCPU=MIDCPUID(I) THEN/* COMP CPUID      0808 02993000
*                                                            @OZ30157*/ 02994000
         LR    @15,@04                                             0808 02995000
         SLA   @15,3                                               0808 02996000
         L     @14,CONXPTR                                         0808 02997000
         ALR   @14,@15                                             0808 02998000
         CLC   CMPCPU(5),MIDCPUID-8(@14)                           0808 02999000
         BNE   @RF00808                                            0808 03000000
*                       DO;         /*                       @OZ30157*/ 03001000
*                         I2=I;     /* SAY FOUND IT          @OZ30157*/ 03002000
         STH   @04,I2                                              0810 03003000
*                         IEND=I;   /* SET LOOP INDICES      @OZ30157*/ 03004000
         STH   @04,IEND                                            0811 03005000
*                         ENDSW=BONE;/* AND EXIT             @OZ30157*/ 03006000
         OI    ENDSW,B'00000100'                                   0812 03007000
*                       END;        /*                       @OZ30157*/ 03008000
*                   END;            /* END CPU SEARCH RTN    @OZ30157*/ 03009000
@RF00808 LA    @04,1                                               0814 03010000
         AH    @04,I                                               0814 03011000
         STH   @04,I                                               0814 03012000
         CH    @04,@CH01227                                        0814 03013000
         BNH   @DL00807                                            0814 03014000
@DC00807 DS    0H                                                  0815 03015000
*                   IF ENDSW^=BONE THEN/* IF NOT FOUND,      @OZ30157*/ 03016000
         TM    ENDSW,B'00000100'                                   0815 03017000
         BO    @RF00815                                            0815 03018000
*                     RETC=F1;      /* THEN IS ERROR         @OZ30157*/ 03019000
         MVC   RETC(2),@CH00047                                    0816 03020000
*                 END;              /* END GOOD QUAL RTN     @OZ30157*/ 03021000
*               ELSE                /* IF BAD QUAL           @OZ30157*/ 03022000
*                 RETC=F1;          /* SAY SO                @OZ30157*/ 03023000
         B     @RC00804                                            0818 03024000
@RF00804 MVC   RETC(2),@CH00047                                    0818 03025000
*             END;                  /* END QUALIFIER RTN     @OZ30157*/ 03026000
*           ELSE                    /* IF NO QUALIFIER       @OZ30157*/ 03027000
*             DO;                   /* ASSUME ALL            @OZ30157*/ 03028000
         B     @RC00798                                            0820 03029000
@RF00798 DS    0H                                                  0821 03030000
*               I2=F1;              /* SET INDICES TO LOOP   @OZ30157*/ 03031000
         MVC   I2(2),@CH00047                                      0821 03032000
*               IEND=F16;           /* THROUGH ALL ENTRIES   @OZ30157*/ 03033000
         MVC   IEND(2),@CH01227                                    0822 03034000
*             END;                  /* END SETUP             @OZ30157*/ 03035000
*/********************************************************************/ 03036000
*/*                                                                  */ 03037000
*/* GET STORAGE FOR THE CPU TABLES - HEADER TABLE WITH 16 ENTRIES    */ 03038000
*/* AND SPACE FOR 4 FULL SIZE DETAIL ENTRIES                 @OZ30157*/ 03039000
*/*                                                                  */ 03040000
*/********************************************************************/ 03041000
*                                                                  0824 03042000
*           IF RETC=F0 THEN         /* IF GOOD SO FAR,       @OZ30157*/ 03043000
@RC00798 SLR   @04,@04                                             0824 03044000
         CH    @04,RETC                                            0824 03045000
         BNE   @RF00824                                            0824 03046000
*             DO;                   /* THEN GET SPACE        @OZ30157*/ 03047000
*               CPUPTR=F0;          /* INSURE START AT 0     @OZ30157*/ 03048000
         ST    @04,CPUPTR                                          0826 03049000
*               R1=ADDR(CPUPTR);    /* SET UP POINTER ADR    @OZ30157*/ 03050000
         LA    R1,CPUPTR                                           0827 03051000
*               CALL MSG56F;        /* GO GET SPACE          @OZ30157*/ 03052000
         BAL   @14,MSG56F                                          0828 03053000
*               IF RETC=F0 THEN     /* IF GOOD GETMAIN       @OZ30157*/ 03054000
         LH    @04,RETC                                            0829 03055000
         LTR   @04,@04                                             0829 03056000
         BNZ   @RF00829                                            0829 03057000
*                 CPHPTR=CPUPTR;    /* INIT HEADER POINTER   @OZ30157*/ 03058000
         MVC   CPHPTR(4),CPUPTR                                    0830 03059000
*             END;                  /* GOT SPACE             @OZ30157*/ 03060000
@RF00829 DS    0H                                                  0832 03061000
*/********************************************************************/ 03062000
*/*                                                                  */ 03063000
*/* BUILD CPU HEADER TABLE FROM SECT 0F AND MID TBL          @OZ30157*/ 03064000
*/*                                                                  */ 03065000
*/********************************************************************/ 03066000
*                                                                  0832 03067000
*           UCBPTR=ICBPUCB;         /* PRIMARY UCB ADDRESS   @OZ30157*/ 03068000
@RF00824 L     @04,@CA00927                                        0832 03069000
         L     @15,CVTPTR                                          0832 03070000
         L     @15,CVTEXT2(,@15)                                   0832 03071000
         L     @15,CVTICB(,@15)                                    0832 03072000
         MVC   UCBPTR-UCBPTR(4,@04),ICBPUCB(@15)                   0832 03073000
*           IF RETC=F0 THEN         /*                       @OZ30157*/ 03074000
         LH    @04,RETC                                            0833 03075000
         LTR   @04,@04                                             0833 03076000
         BNZ   @RF00833                                            0833 03077000
*             DO I2=I2 TO IEND;     /* LOOP THRU ALL CPUS    @OZ30157*/ 03078000
         LH    @04,I2                                              0834 03079000
         B     @DE00834                                            0834 03080000
@DL00834 DS    0H                                                  0835 03081000
*               IF MIDCFVAL(I2)=BONE THEN/* IF VALID ENTRY   @OZ30157*/ 03082000
         L     @15,CONXPTR                                         0835 03083000
         LR    @14,@04                                             0835 03084000
         SLA   @14,3                                               0835 03085000
         ST    @14,@TF00001                                        0835 03086000
         ALR   @14,@15                                             0835 03087000
         TM    MIDCFVAL-8(@14),B'10000000'                         0835 03088000
         BNO   @RF00835                                            0835 03089000
*                 DO;               /* THEN USE IT           @OZ30157*/ 03090000
*                   CPHENT=''B;     /* FIRST, CLEAR IT       @OZ30157*/ 03091000
         L     @14,CPHPTR                                          0837 03092000
         XC    CPHENT(16,@14),CPHENT(@14)                          0837 03093000
*                   CPHID=MIDCPUID(I2);/* GET CPU ID         @OZ30157*/ 03094000
         LR    @03,@15                                             0838 03095000
         AL    @03,@TF00001                                        0838 03096000
         MVC   CPHID(5,@14),MIDCPUID-8(@03)                        0838 03097000
*                   CPHPTI=I2-1;    /* AND CPU INDEX         @OZ30157*/ 03098000
         BCTR  @04,0                                               0839 03099000
         STC   @04,CPHPTI(,@14)                                    0839 03100000
*                   CPHPTA=MIDCPAIR(I2);/* PAIRED CPU        @OZ30157*/ 03101000
         L     @04,@TF00001                                        0840 03102000
         SLR   @00,@00                                             0840 03103000
         IC    @00,MIDCPAIR-8(@04,@15)                             0840 03104000
         STC   @00,CPHPTA(,@14)                                    0840 03105000
*                   CPHFLGS=HEX00;  /* FIRST FLAG BYTE       @OZ30157*/ 03106000
         MVI   CPHFLGS(@14),X'00'                                  0841 03107000
*                   CPHSTAT=HEX00;  /* SECOND FLAG BYTE      @OZ30157*/ 03108000
         MVI   CPHSTAT(@14),X'00'                                  0842 03109000
*                   CPHDET=F0;      /* NULL DETAIL POINTER   @OZ30157*/ 03110000
         SLR   @04,@04                                             0843 03111000
         ST    @04,@TF00002                                        0843 03112000
         MVC   CPHDET(3,@14),@TF00002+1                            0843 03113000
*                   PCHAN=F0;       /* CLEAR WORK AREAS      @OZ30157*/ 03114000
         SLR   @04,@04                                             0844 03115000
         ST    @04,PCHAN                                           0844 03116000
*                   PCNTL=F0;       /* FOR BIT COMPARE       @OZ30157*/ 03117000
         ST    @04,PCNTL                                           0845 03118000
*                   PCHANCX=WC0FP&'0C'X;/* SET FIRST COMP FLD      0846 03119000
*                                                            @OZ30157*/ 03120000
         L     @04,PWCS0F                                          0846 03121000
         MVC   PCHANCX(1),WC0FP(@04)                               0846 03122000
         NI    PCHANCX,X'0C'                                       0846 03123000
*                   PCHAN=PCHAN/4;  /* WITH BITS IN LOW ORD  @OZ30157*/ 03124000
         L     @02,PCHAN                                           0847 03125000
         SRDA  @02,32                                              0847 03126000
         D     @02,@CF00045                                        0847 03127000
         ST    @03,PCHAN                                           0847 03128000
*                   CPHFLGS=MIDCFLG1(I2)&'03'X;/* 2ND COMP FLD     0848 03129000
*                                                            @OZ30157*/ 03130000
         AL    @15,@TF00001                                        0848 03131000
         MVC   CPHFLGS(1,@14),MIDCFLG1-8(@15)                      0848 03132000
         NI    CPHFLGS(@14),X'03'                                  0848 03133000
*                   CPHINT=CPHFLGS+F1;/* SAVE INTERFACE      @OZ30157*/ 03134000
         LA    @00,1                                               0849 03135000
         MVC   @ZT00003+3(1),CPHFLGS(@14)                          0849 03136000
         AL    @00,@ZT00003                                        0849 03137000
         STC   @00,CPHINT(,@14)                                    0849 03138000
*                   CPHINT=CPHINT|'C0'X;/* IN ALPHA          @OZ30157*/ 03139000
         OI    CPHINT(@14),X'C0'                                   0850 03140000
*                   IF WC0FINA=BONE THEN/* SET PCNTLCX TO    @OZ30157*/ 03141000
         TM    WC0FINA(@04),B'10000000'                            0851 03142000
         BNO   @RF00851                                            0851 03143000
*                     PCNTLCX=HEX00;/* VALUE INDICATING      @OZ30157*/ 03144000
         MVI   PCNTLCX,X'00'                                       0852 03145000
*                   ELSE            /* THE PROPER            @OZ30157*/ 03146000
*                     IF WC0FINB=BONE THEN/* INTERFACE PER THE     0853 03147000
*                                                            @OZ30157*/ 03148000
         B     @RC00851                                            0853 03149000
@RF00851 L     @04,PWCS0F                                          0853 03150000
         TM    WC0FINB(@04),B'01000000'                            0853 03151000
         BNO   @RF00853                                            0853 03152000
*                       PCNTLCX=HEX01;/* ID TABLE VALUES     @OZ30157*/ 03153000
         MVI   PCNTLCX,X'01'                                       0854 03154000
*                     ELSE          /* SO THAT A             @OZ30157*/ 03155000
*                       IF WC0FINC=BONE THEN/* COMPARE CAN   @OZ30157*/ 03156000
         B     @RC00853                                            0855 03157000
@RF00853 L     @04,PWCS0F                                          0855 03158000
         TM    WC0FINC(@04),B'00100000'                            0855 03159000
         BNO   @RF00855                                            0855 03160000
*                         PCNTLCX=HEX02;/* BE DONE           @OZ30157*/ 03161000
         MVI   PCNTLCX,X'02'                                       0856 03162000
*                       ELSE        /*                       @OZ30157*/ 03163000
*                         IF WC0FIND=BONE THEN/*             @OZ30157*/ 03164000
         B     @RC00855                                            0857 03165000
@RF00855 L     @04,PWCS0F                                          0857 03166000
         TM    WC0FIND(@04),B'00010000'                            0857 03167000
         BNO   @RF00857                                            0857 03168000
*                           PCNTLCX=HEX03;/* VALUES SET      @OZ30157*/ 03169000
         MVI   PCNTLCX,X'03'                                       0858 03170000
*                         ELSE      /* IF NONE OF ABOVE      @OZ30157*/ 03171000
*                           PCNTLCX=HEX04;/* INSURE NO COMP  @OZ30157*/ 03172000
         B     @RC00857                                            0859 03173000
@RF00857 MVI   PCNTLCX,X'04'                                       0859 03174000
*                   IF CPHFLGS=PCNTLCX THEN/* NOW SET INIT FLG     0860 03175000
*                                                            @OZ30157*/ 03176000
@RC00857 DS    0H                                                  0860 03177000
@RC00855 DS    0H                                                  0860 03178000
@RC00853 DS    0H                                                  0860 03179000
@RC00851 L     @04,CPHPTR                                          0860 03180000
         CLC   CPHFLGS(1,@04),PCNTLCX                              0860 03181000
         BNE   @RF00860                                            0860 03182000
*                     CPHIN=BONE;   /* IF THIS INTF INIT'D   @OZ30157*/ 03183000
         OI    CPHIN(@04),B'10000000'                              0861 03184000
*                   IF CPHFLGS=PCHANCX THEN/* IF THIS IS PRIM      0862 03185000
*                                                            @OZ30157*/ 03186000
@RF00860 L     @04,CPHPTR                                          0862 03187000
         CLC   CPHFLGS(1,@04),PCHANCX                              0862 03188000
         BNE   @RF00862                                            0862 03189000
*                     CPHPRI=BONE;  /* SET PRI FLAG          @OZ30157*/ 03190000
         OI    CPHPRI(@04),B'01000000'                             0863 03191000
*                   ELSE                                           0864 03192000
*                     CPHPRI=BZERO; /* 0 IF NOT              @OZ30157*/ 03193000
         B     @RC00862                                            0864 03194000
@RF00862 L     @04,CPHPTR                                          0864 03195000
         NI    CPHPRI(@04),B'10111111'                             0864 03196000
*                   CPHVALID=BONE;  /* VALID                 @OZ30157*/ 03197000
@RC00862 L     @04,CPHPTR                                          0865 03198000
         OI    CPHVALID(@04),B'10000000'                           0865 03199000
*                   IF MIDCFASC(I2)=BONE THEN/*              @OZ30157*/ 03200000
         LH    @15,I2                                              0866 03201000
         SLA   @15,3                                               0866 03202000
         L     @14,CONXPTR                                         0866 03203000
         ALR   @14,@15                                             0866 03204000
         TM    MIDCFASC-8(@14),B'01000000'                         0866 03205000
         BNO   @RF00866                                            0866 03206000
*                     CPHFASC=BONE; /* ASSOCIATED            @OZ30157*/ 03207000
         OI    CPHFASC(@04),B'01000000'                            0867 03208000
*                   IF MIDCFAI1(I2)=BONE THEN/*              @OZ30157*/ 03209000
@RF00866 LH    @04,I2                                              0868 03210000
         SLA   @04,3                                               0868 03211000
         L     @15,CONXPTR                                         0868 03212000
         ALR   @15,@04                                             0868 03213000
         TM    MIDCFAI1-8(@15),B'00000100'                         0868 03214000
         BNO   @RF00868                                            0868 03215000
*                     CPHALTF1=BONE;/* ALT INTERFACE ID      @OZ30157*/ 03216000
         L     @04,CPHPTR                                          0869 03217000
         OI    CPHALTF1(@04),B'00000010'                           0869 03218000
*                   IF MIDCFAI2(I2)=BONE THEN/*              @OZ30157*/ 03219000
@RF00868 LH    @04,I2                                              0870 03220000
         SLA   @04,3                                               0870 03221000
         L     @15,CONXPTR                                         0870 03222000
         ALR   @15,@04                                             0870 03223000
         TM    MIDCFAI2-8(@15),B'00000010'                         0870 03224000
         BNO   @RF00870                                            0870 03225000
*                     CPHALTF2=BONE;/* ALT INTERFACE ID      @OZ30157*/ 03226000
         L     @04,CPHPTR                                          0871 03227000
         OI    CPHALTF2(@04),B'00000001'                           0871 03228000
*                   IF MIDCFALT(I2)=BONE THEN/*              @OZ30157*/ 03229000
@RF00870 LH    @04,I2                                              0872 03230000
         SLA   @04,3                                               0872 03231000
         L     @15,CONXPTR                                         0872 03232000
         ALR   @15,@04                                             0872 03233000
         TM    MIDCFALT-8(@15),B'00100000'                         0872 03234000
         BNO   @RF00872                                            0872 03235000
*                     CPHFALT=BONE; /* ALT PATH AVAIL        @OZ30157*/ 03236000
         L     @04,CPHPTR                                          0873 03237000
         OI    CPHFALT(@04),B'00001000'                            0873 03238000
*                   IF MIDCFCBF(I2)=BONE THEN/*              @OZ30157*/ 03239000
@RF00872 LH    @04,I2                                              0874 03240000
         SLA   @04,3                                               0874 03241000
         L     @15,CONXPTR                                         0874 03242000
         ALR   @15,@04                                             0874 03243000
         TM    MIDCFCBF-8(@15),B'00100000'                         0874 03244000
         BNO   @RF00874                                            0874 03245000
*                     CPHMBUF=BONE; /* COMM MSG BUFF         @OZ30157*/ 03246000
         L     @04,CPHPTR                                          0875 03247000
         OI    CPHMBUF(@04),B'00000100'                            0875 03248000
*                   IF MIDCFPOT(I2)=BONE THEN/*              @OZ30157*/ 03249000
@RF00874 LH    @04,I2                                              0876 03250000
         SLA   @04,3                                               0876 03251000
         L     @15,CONXPTR                                         0876 03252000
         ALR   @15,@04                                             0876 03253000
         TM    MIDCFPOT-8(@15),B'01000000'                         0876 03254000
         BNO   @RF00876                                            0876 03255000
*                     CPHFPOT=BONE; /* POTENTIAL PAIR        @OZ30157*/ 03256000
         L     @04,CPHPTR                                          0877 03257000
         OI    CPHFPOT(@04),B'00010000'                            0877 03258000
*                   IF MIDCFASC(I2)=BONE THEN/* IF ASSOCIATED      0878 03259000
*                                                            @OZ30157*/ 03260000
@RF00876 LH    @04,I2                                              0878 03261000
         SLA   @04,3                                               0878 03262000
         L     @15,CONXPTR                                         0878 03263000
         ALR   @15,@04                                             0878 03264000
         TM    MIDCFASC-8(@15),B'01000000'                         0878 03265000
         BNO   @RF00878                                            0878 03266000
*                     CPHASC=BONE;  /* SAY SO                @OZ30157*/ 03267000
         L     @04,CPHPTR                                          0879 03268000
         OI    CPHASC(@04),B'00100000'                             0879 03269000
*                   ELSE                                           0880 03270000
*                     ;             /*                       @OZ30157*/ 03271000
@RF00878 DS    0H                                                  0881 03272000
*                   CPHMSAD=UCBNAME;/* GET MSC ADDRESS       @OZ30157*/ 03273000
         L     @04,CPHPTR                                          0881 03274000
         L     @15,@CA00927                                        0881 03275000
         L     @15,UCBPTR-UCBPTR(,@15)                             0881 03276000
         MVC   CPHMSAD(3,@04),UCBNAME(@15)                         0881 03277000
*                   IF UCBONLI=BZERO THEN/* IF OFFLINE       @OZ30157*/ 03278000
         TM    UCBONLI(@15),B'10000000'                            0882 03279000
         BNZ   @RF00882                                            0882 03280000
*                     CPHMSOF=BONE; /* THEN SAY SO           @OZ30157*/ 03281000
*                                                                  0883 03282000
         OI    CPHMSOF(@04),B'00000010'                            0883 03283000
*                   /*************************************************/ 03284000
*                   /*                                               */ 03285000
*                   /* GET UCB RDY STAT                      @OZ30157*/ 03286000
*                   /*                                               */ 03287000
*                   /*************************************************/ 03288000
*                                                                  0884 03289000
*                   CPHEND=CPHPTR;  /* SAVE ADR LAST ENTRY   @OZ30157*/ 03290000
@RF00882 L     @04,CPHPTR                                          0884 03291000
         ST    @04,CPHEND                                          0884 03292000
*                   CPHPTR=CPHPTR+CPHLEN;/* INCREMENT CPH PTR      0885 03293000
*                                                            @OZ30157*/ 03294000
         AH    @04,@CH01227                                        0885 03295000
         ST    @04,CPHPTR                                          0885 03296000
*                 END;              /* END VALID CPU CODE    @OZ30157*/ 03297000
*             END;                  /* END CPU LOOP MID TAB  @OZ30157*/ 03298000
@RF00835 LA    @04,1                                               0887 03299000
         AH    @04,I2                                              0887 03300000
         STH   @04,I2                                              0887 03301000
@DE00834 CH    @04,IEND                                            0887 03302000
         BNH   @DL00834                                            0887 03303000
*/********************************************************************/ 03304000
*/*                                                                  */ 03305000
*/*             NOW BUILD DETAIL TABLE                               */ 03306000
*/*  GET THE CPUID FOR THIS HOST SYSTEM. CAN ONLY GET                */ 03307000
*/*  SOME INFO FOR THE CURRENT HOST SYSTEM.                  @OZ30157*/ 03308000
*/*                                                                  */ 03309000
*/********************************************************************/ 03310000
*                                                                  0888 03311000
*           LASTENT=CPUPTR+2047-CPDLEN;/* MAX ENTRY ADDR     @OZ30157*/ 03312000
@RF00833 L     @04,CPUPTR                                          0888 03313000
         LA    @00,2047                                            0888 03314000
         ALR   @00,@04                                             0888 03315000
         SH    @00,CPDLEN                                          0888 03316000
         ST    @00,LASTENT                                         0888 03317000
*           CPHPTR=CPUPTR;          /* IN FIRST CPH ENTRY,   @OZ30157*/ 03318000
         ST    @04,CPHPTR                                          0889 03319000
*           CPDPTR=CPHEND+CPHLEN;   /* SET DETAIL POINTER    @OZ30157*/ 03320000
         LA    @00,16                                              0890 03321000
         AL    @00,CPHEND                                          0890 03322000
         ST    @00,CPDPTR                                          0890 03323000
*           DO CPHPTR=CPUPTR TO CPHEND BY CPHLEN;/* CPU LOOP @OZ30157*/ 03324000
         ST    @04,CPHPTR                                          0891 03325000
         B     @DE00891                                            0891 03326000
@DL00891 DS    0H                                                  0892 03327000
*             CPHDET=CPDPTR;        /* POINT TO DETAIL ENT.  @OZ30157*/ 03328000
         L     @00,CPDPTR                                          0892 03329000
         ST    @00,@TF00001                                        0892 03330000
         MVC   CPHDET(3,@04),@TF00001+1                            0892 03331000
*             IF CPHDET>LASTENT THEN/* NEED SPACE?           @OZ30157*/ 03332000
         C     @00,LASTENT                                         0893 03333000
         BNH   @RF00893                                            0893 03334000
*               DO;                 /* THEN GET IT           @OZ30157*/ 03335000
*                 R1=ADDR(CPHDET)-1;/* SET UP FOR GETMAIN    @OZ30157*/ 03336000
         LA    R1,CPHDET(,@04)                                     0895 03337000
         BCTR  R1,0                                                0895 03338000
*                 CALL MSG56F;      /*                       @OZ30157*/ 03339000
         BAL   @14,MSG56F                                          0896 03340000
*                 IF RETC=F0 THEN   /* CHECK FOR GOOD GETM   @OZ30157*/ 03341000
         LH    @04,RETC                                            0897 03342000
         LTR   @04,@04                                             0897 03343000
         BNZ   @RF00897                                            0897 03344000
*                   DO;             /* IF GOOD,              @OZ30157*/ 03345000
*                     CPDPTR=CPHDET;/* GET NEW ENTRY ADDR    @OZ30157*/ 03346000
         L     @04,CPHPTR                                          0899 03347000
         L     @04,CPHDET-1(,@04)                                  0899 03348000
         LA    @04,0(,@04)                                         0899 03349000
         ST    @04,CPDPTR                                          0899 03350000
*                     LASTENT=CPDPTR+2047-CPDLEN;/* END POINT      0900 03351000
*                                                            @OZ30157*/ 03352000
         AH    @04,@CH03110                                        0900 03353000
         SH    @04,CPDLEN                                          0900 03354000
         ST    @04,LASTENT                                         0900 03355000
*                   END;            /*                       @OZ30157*/ 03356000
*               END;                /*                       @OZ30157*/ 03357000
@RF00897 DS    0H                                                  0903 03358000
*             IF RETC=F0 THEN       /* IF GETMAIN GOOD OR NOT@OZ30157*/ 03359000
@RF00893 LH    @04,RETC                                            0903 03360000
         SLR   @15,@15                                             0903 03361000
         CR    @04,@15                                             0903 03362000
         BNE   @RF00903                                            0903 03363000
*               DO;                 /* ISSUED                @OZ30157*/ 03364000
*                 ENDSW=BZERO;      /* SET UP FOR LOOP CNTL  @OZ30157*/ 03365000
*                                                                  0905 03366000
         NI    ENDSW,B'11111011'                                   0905 03367000
*                 /***************************************************/ 03368000
*                 /*                                                 */ 03369000
*                 /* LOOP THROUGH ALL SAS, 3 INTERFACES EACH ONE AND */ 03370000
*                 /* BUILD A DETAIL ENTRY FOR EACH INTERFACE         */ 03371000
*                 /* CONNECTED TO THE CPU IN THE CURRENT HEADER TABLE*/ 03372000
*                 /* ENTRY.                                  @OZ30157*/ 03373000
*                 /*                                                 */ 03374000
*                 /***************************************************/ 03375000
*                                                                  0906 03376000
*                 IF RETC=F0 THEN   /* IF ENOUGH SPACE, THEN @OZ30157*/ 03377000
         CR    @04,@15                                             0906 03378000
         BNE   @RF00906                                            0906 03379000
*                   DO J=1 TO 16;   /* SA LOOP               @OZ30157*/ 03380000
         LA    @04,1                                               0907 03381000
         STH   @04,J                                               0907 03382000
@DL00907 DS    0H                                                  0908 03383000
*                     TABPTR1=ADDR(CONFXTAB(J));/* SET ENTRY POINTER    03384000
*                                                            @OZ30157*/ 03385000
         SLA   @04,3                                               0908 03386000
         L     @15,CONXPTR                                         0908 03387000
         AL    @15,@CF03654                                        0908 03388000
         LA    @04,CONFXTAB(@04,@15)                               0908 03389000
         ST    @04,TABPTR1                                         0908 03390000
*                     IF CXCSCCS=BZERO THEN/*                @OZ30157*/ 03391000
         TM    CXCSCCS(@04),B'10000000'                            0909 03392000
         BNZ   @RF00909                                            0909 03393000
*                       IF CXCSCS0=BONE|CXCSCS1=BONE THEN/*  @OZ30157*/ 03394000
         TM    CXCSCS0(@04),B'00001100'                            0910 03395000
         BZ    @RF00910                                            0910 03396000
*                         DO;       /* GOT VALID ENTRY       @OZ30157*/ 03397000
*                           DO K=1 TO 3;/*                   @OZ30157*/ 03398000
         LA    @04,1                                               0912 03399000
         STH   @04,K                                               0912 03400000
@DL00912 DS    0H                                                  0913 03401000
*                             PCNTL=F0;/* CLEAR CONTROL UNIT AD    0913 03402000
*                                                            @OZ30157*/ 03403000
         SLR   @00,@00                                             0913 03404000
         ST    @00,PCNTL                                           0913 03405000
*                             PCNTLCX=CXSACUCH(K)&'C0'X;/* CNTL UNIT    03406000
*                                                            @OZ30157*/ 03407000
         L     @15,TABPTR1                                         0914 03408000
         ALR   @04,@04                                             0914 03409000
         ST    @04,@TF00001                                        0914 03410000
         ALR   @04,@15                                             0914 03411000
         MVC   PCNTLCX(1),CXSACUCH-2(@04)                          0914 03412000
         NI    PCNTLCX,X'C0'                                       0914 03413000
*                             PCNTL=PCNTL/F64;/* PUT INTO LOW ORD. 0915 03414000
*                                      BITS@OZ30157                  */ 03415000
*                                                                  0915 03416000
         L     @02,PCNTL                                           0915 03417000
         SRDA  @02,32                                              0915 03418000
         D     @02,@CF01346                                        0915 03419000
         ST    @03,PCNTL                                           0915 03420000
*                             /***************************************/ 03421000
*                             /*                                     */ 03422000
*                             /* DO FOLLOWING ONLY FOR CPU IN CURRENT*/ 03423000
*                             /* HEADER ENTRY                @OZ30157*/ 03424000
*                             /*                                     */ 03425000
*                             /***************************************/ 03426000
*                                                                  0916 03427000
*                             IF CXSACPU(K)=CPHPTI THEN/* IF THIS CPU   03428000
*                                                            @OZ30157*/ 03429000
         L     @04,@TF00001                                        0916 03430000
         SLR   @00,@00                                             0916 03431000
         IC    @00,CXSACPU-2(@04,@15)                              0916 03432000
         L     @04,CPHPTR                                          0916 03433000
         MVC   @ZT00003+3(1),CPHPTI(@04)                           0916 03434000
         C     @00,@ZT00003                                        0916 03435000
         BNE   @RF00916                                            0916 03436000
*                               DO; /* THEN PUT IN VALUES    @OZ30157*/ 03437000
*                                 CPDET=''B;/* FIRST, CLEAR IT     0918 03438000
*                                                            @OZ30157*/ 03439000
         L     @04,CPDPTR                                          0918 03440000
         XC    CPDET(28,@04),CPDET(@04)                            0918 03441000
*                                 K1=((J-1)//4)+1;/* SA WITHIN GROUP    03442000
*                                                            @OZ30157*/ 03443000
         LH    @15,J                                               0919 03444000
         LR    @02,@15                                             0919 03445000
         BCTR  @02,0                                               0919 03446000
         SRDA  @02,32                                              0919 03447000
         D     @02,@CF00045                                        0919 03448000
         AL    @02,@CF00047                                        0919 03449000
         STH   @02,K1                                              0919 03450000
*                                 PWCS7X=QAPTR((J/4+3));/* SET SECTOR   03451000
*                                      PTR                   @OZ30157*/ 03452000
         LR    @02,@15                                             0920 03453000
         SRDA  @02,32                                              0920 03454000
         D     @02,@CF00045                                        0920 03455000
         SLA   @03,2                                               0920 03456000
         L     @00,QAPTR+8(@03)                                    0920 03457000
         ST    @00,PWCS7X                                          0920 03458000
*                                 IF SAFVAL(K1)=BONE THEN/* IF SA IS    03459000
*                                      VALID                 @OZ30157*/ 03460000
         LH    @15,K1                                              0921 03461000
         SLA   @15,2                                               0921 03462000
         LR    @14,@00                                             0921 03463000
         ALR   @14,@15                                             0921 03464000
         TM    SAFVAL-4(@14),B'10000000'                           0921 03465000
         BNO   @RF00921                                            0921 03466000
*                                   DO;/* THEN SET OFL, RDY        0922 03467000
*                                      BITS@OZ30157                  */ 03468000
*                                    IF SAFONL(K1)=BZERO THEN/* IS 0923 03469000
*                                      OFFLINE               @OZ30157*/ 03470000
         LR    @14,@00                                             0923 03471000
         ALR   @14,@15                                             0923 03472000
         TM    SAFONL-4(@14),B'01000000'                           0923 03473000
         BNZ   @RF00923                                            0923 03474000
*                                     CPDSAOF=BONE;/* SAY IS OFFLINE    03475000
*                                                            @OZ30157*/ 03476000
         OI    CPDSAOF(@04),B'10000000'                            0924 03477000
*                                    IF SAFRDY(K1)=BONE THEN/* IF  0925 03478000
*                                      READY                 @OZ30157*/ 03479000
@RF00923 LH    @04,K1                                              0925 03480000
         SLA   @04,2                                               0925 03481000
         L     @15,PWCS7X                                          0925 03482000
         ALR   @15,@04                                             0925 03483000
         TM    SAFRDY-4(@15),B'00100000'                           0925 03484000
         BNO   @RF00925                                            0925 03485000
*                                     CPDSARDY=BONE;/* SAY SO,     0926 03486000
*                                                            @OZ30157*/ 03487000
         L     @04,CPDPTR                                          0926 03488000
         OI    CPDSARDY(@04),B'01000000'                           0926 03489000
*                                    ELSE                          0927 03490000
*                                     CPDSAVAL=BONE;/* SUU MUST PRINT   03491000
*                                                            @OZ30157*/ 03492000
         B     @RC00925                                            0927 03493000
@RF00925 L     @04,CPDPTR                                          0927 03494000
         OI    CPDSAVAL(@04),B'00100000'                           0927 03495000
*                                   END;/* SA FLAGS SET      @OZ30157*/ 03496000
@RC00925 DS    0H                                                  0929 03497000
*                                 IF(SAFONL(K1)=BONE)&(DSPON=BONE) THEN 03498000
@RF00921 LH    @04,K1                                              0929 03499000
         SLA   @04,2                                               0929 03500000
         L     @15,PWCS7X                                          0929 03501000
         ALR   @15,@04                                             0929 03502000
         TM    SAFONL-4(@15),B'01000000'                           0929 03503000
         BNO   @RF00929                                            0929 03504000
         L     @04,@CA00041                                        0929 03505000
         L     @04,CWBPTR-CWBPTR(,@04)                             0929 03506000
         TM    DSPON(@04),B'01000000'                              0929 03507000
         BNO   @RF00929                                            0929 03508000
*                                   /* OZ30157                       */ 03509000
*                                   CPDSAVAL=BONE;/* VALID PER     0930 03510000
*                                      REQUEST               @OZ30157*/ 03511000
         L     @04,CPDPTR                                          0930 03512000
         OI    CPDSAVAL(@04),B'00100000'                           0930 03513000
*                                 IF(SAFONL(K1)=BZERO)&(DSPOFF=BONE)    03514000
*                                   THEN/* OZ30157                   */ 03515000
@RF00929 LH    @04,K1                                              0931 03516000
         SLA   @04,2                                               0931 03517000
         L     @15,PWCS7X                                          0931 03518000
         ALR   @15,@04                                             0931 03519000
         TM    SAFONL-4(@15),B'01000000'                           0931 03520000
         BNZ   @RF00931                                            0931 03521000
         L     @04,@CA00041                                        0931 03522000
         L     @04,CWBPTR-CWBPTR(,@04)                             0931 03523000
         TM    DSPOFF(@04),B'00100000'                             0931 03524000
         BNO   @RF00931                                            0931 03525000
*                                   CPDSAVAL=BONE;/* ALSO VALID    0932 03526000
*                                                            @OZ30157*/ 03527000
         L     @04,CPDPTR                                          0932 03528000
         OI    CPDSAVAL(@04),B'00100000'                           0932 03529000
*                                 IF ENDSW=BONE THEN/* CHAIN IF NOT     03530000
*                                      FIRST                 @OZ30157*/ 03531000
@RF00931 TM    ENDSW,B'00000100'                                   0933 03532000
         BNO   @RF00933                                            0933 03533000
*                                   CHNADR=CPDPTR;/* TO PREV ENTRY 0934 03534000
*                                                            @OZ30157*/ 03535000
         L     @04,LVUPTR                                          0934 03536000
         MVC   CHNADR(3,@04),CPDPTR+1                              0934 03537000
*                                 CPDSAAD='800';/* INIT SA SSID    0935 03538000
*                                                            @OZ30157*/ 03539000
@RF00933 L     @04,CPDPTR                                          0935 03540000
         MVC   CPDSAAD(3,@04),@CC01468                             0935 03541000
*                                 CPDSAAD(2:2)=NUMBRS(J:J);/*      0936 03542000
*                                                            @OZ30157*/ 03543000
         LH    @15,J                                               0936 03544000
         LA    @14,NUMBRS-1(@15)                                   0936 03545000
         MVC   CPDSAAD+1(1,@04),0(@14)                             0936 03546000
*                                 CPDINT=INTFC(K:K);/* SA INTERFACE     03547000
*                                      ID                    @OZ30157*/ 03548000
         LH    @14,K                                               0937 03549000
         LA    @03,INTFC-1(@14)                                    0937 03550000
         MVC   CPDINT(1,@04),0(@03)                                0937 03551000
*                                 CVD(VESDG1(J),PUNITCY);/* CNVT FOR    03552000
*                                      DSP                   @OZ30157*/ 03553000
         L     @03,VERPTR                                          0938 03554000
         SLA   @15,2                                               0938 03555000
         LA    @02,0(@15,@03)                                      0938 03556000
         AL    @02,@CF03609                                        0938 03557000
         SLR   @00,@00                                             0938 03558000
         IC    @00,VESDG1(,@02)                                    0938 03559000
         CVD   @00,@TS00001                                        0938 03560000
         MVC   PUNITCY(2),@TS00001+6                               0938 03561000
*                                 UNPK(CPDSDG1,PUNITCY);/* UNPACK SDG   03562000
*                                      1                     @OZ30157*/ 03563000
         UNPK  CPDSDG1(2,@04),PUNITCY(2)                           0939 03564000
*                                 CPDSDG12=CPDSDG12|'0';/* CLEAR SIGN   03565000
*                                                            @OZ30157*/ 03566000
         OI    CPDSDG12(@04),C'0'                                  0940 03567000
*                                 CVD(VESDG2(J),PUNITCY);/* SAME FOR    03568000
*                                      SDG 2                 @OZ30157*/ 03569000
         AL    @03,@CF03655                                        0941 03570000
         SLR   @00,@00                                             0941 03571000
         IC    @00,VESDG2-1(@15,@03)                               0941 03572000
         CVD   @00,@TS00001                                        0941 03573000
         MVC   PUNITCY(2),@TS00001+6                               0941 03574000
*                                 UNPK(CPDSDG2,PUNITCY);/* UNPACK AND   03575000
*                                                            @OZ30157*/ 03576000
         UNPK  CPDSDG2(2,@04),PUNITCY(2)                           0942 03577000
*                                 CPDSDG22=CPDSDG22|'0';/* CLEAR SIGN   03578000
*                                                            @OZ30157*/ 03579000
         OI    CPDSDG22(@04),C'0'                                  0943 03580000
*                                 PCHAN=F0;/* CLEAR CHANNEL  @OZ30157*/ 03581000
         SLR   @00,@00                                             0944 03582000
         ST    @00,PCHAN                                           0944 03583000
*                                 PCHANCX=CXSACUCH(K)&'0F'X;/* CHAN     03584000
*                                      ADR                   @OZ30157*/ 03585000
         ALR   @14,@14                                             0945 03586000
         L     @15,TABPTR1                                         0945 03587000
         ALR   @15,@14                                             0945 03588000
         MVC   PCHANCX(1),CXSACUCH-2(@15)                          0945 03589000
         NI    PCHANCX,X'0F'                                       0945 03590000
*                                 CPDCH=PCHANCX|'F0'X;/* SAVE IT FOR    03591000
*                                      DSPLY                 @OZ30157*/ 03592000
         MVC   CPDCH(1,@04),PCHANCX                                0946 03593000
         OI    CPDCH(@04),X'F0'                                    0946 03594000
*                                 CURSTAT=HEX00;/* CLEAR NEW STATUS     03595000
*                                                            @OZ30157*/ 03596000
         MVI   CURSTAT,X'00'                                       0947 03597000
*/*  IF THE ENTRY IS FOR THIS HOST, THEN VUA NUMBERS AND STATUSES    */ 03598000
*/*  CAN BE BUILT INTO VUA TABLE ENTRIES.                    @OZ30157*/ 03599000
*                                                                  0948 03600000
*                                 IF CPHID=CURCPUP THEN/* IF SAME ID,   03601000
*                                      THEN                  @OZ30157*/ 03602000
         L     @15,CPHPTR                                          0948 03603000
         CLC   CPHID(5,@15),CURCPUP                                0948 03604000
         BNE   @RF00948                                            0948 03605000
*                                   DO;/* IS THIS HOST CPU   @OZ30157*/ 03606000
*                                    ENDSW=BONE;/* SAY END LOOP    0950 03607000
*                                                            @OZ30157*/ 03608000
         OI    ENDSW,B'00000100'                                   0950 03609000
*                                    VUAPTR=CPDPTR+CPDLEN;/* INDEXING   03610000
*                                                            @OZ30157*/ 03611000
         AH    @04,CPDLEN                                          0951 03612000
         ST    @04,VUAPTR                                          0951 03613000
*                                    ENDPTR=VUAPTR;/* INDEXING END 0952 03614000
*                                                            @OZ30157*/ 03615000
         ST    @04,ENDPTR                                          0952 03616000
*/********************************************************************/ 03617000
*/*                                                                  */ 03618000
*/* LOOP THROUGH ALL POSSIBLE VUAS THIS SA FOR STATUSES      @OZ30157*/ 03619000
*/*                                                                  */ 03620000
*/********************************************************************/ 03621000
*                                                                  0953 03622000
*                                    CURSTAT=HEX00;/* SET INITIALLY     03623000
*                                      TO 0                  @OZ30157*/ 03624000
         MVI   CURSTAT,X'00'                                       0953 03625000
*                                    ONLPTR=F0;/* INITIALIZE CHAIN 0954 03626000
*                                                            @OZ30157*/ 03627000
         SLR   @04,@04                                             0954 03628000
         ST    @04,@TF00001                                        0954 03629000
         MVC   ONLPTR(3),@TF00001+1                                0954 03630000
*                                    OFFPTR=F0;/* REFERENCE POINTERS    03631000
*                                                            @OZ30157*/ 03632000
         SLR   @04,@04                                             0955 03633000
         ST    @04,@TF00001                                        0955 03634000
         MVC   OFFPTR(3),@TF00001+1                                0955 03635000
*                                    SUUPTR=F0;/* TO ZERO    @OZ30157*/ 03636000
         SLR   @04,@04                                             0956 03637000
         ST    @04,@TF00001                                        0956 03638000
         MVC   SUUPTR(3),@TF00001+1                                0956 03639000
*                                    DO K2=1 TO 64;/* LOOP ALL VUAS     03640000
*                                                            @OZ30157*/ 03641000
         LA    @04,1                                               0957 03642000
         STH   @04,K2                                              0957 03643000
@DL00957 DS    0H                                                  0958 03644000
*                                     PUNIT=K2;/* GET UNIT ADDRESS 0958 03645000
*                                                            @OZ30157*/ 03646000
         ST    @04,PUNIT                                           0958 03647000
*                                     UCBPTR=VUCBAD(K2);/* ADDRESS OF   03648000
*                                      UCB                   @OZ30157*/ 03649000
         L     @15,@CA00927                                        0959 03650000
         SLA   @04,2                                               0959 03651000
         L     @14,VVIPTR                                          0959 03652000
         L     @14,VVIUCB(,@14)                                    0959 03653000
         AL    @14,@CF03609                                        0959 03654000
         L     @04,VUCBAD(@04,@14)                                 0959 03655000
         ST    @04,UCBPTR-UCBPTR(,@15)                             0959 03656000
*/********************************************************************/ 03657000
*/*                                                                  */ 03658000
*/* SAVE PREVIOUS STATUS, SET CURRENT TO THAT OF CURRENT VUA.        */ 03659000
*/* THEN CAN CHAIN TO CORRECT CHAIN                          @OZ30157*/ 03660000
*/*                                                                  */ 03661000
*/********************************************************************/ 03662000
*                                                                  0960 03663000
*                                     PRVSTAT=CURSTAT;/* SAVE LAST 0960 03664000
*                                      STATUS                @OZ30157*/ 03665000
         MVC   PRVSTAT(1),CURSTAT                                  0960 03666000
*                                     CURSTAT=HEX00;/* CLEAR NEW   0961 03667000
*                                      STATUS                @OZ30157*/ 03668000
         MVI   CURSTAT,X'00'                                       0961 03669000
*                                     IF UCBONLI=BZERO THEN/* IF OFFL   03670000
*                                                            @OZ30157*/ 03671000
         TM    UCBONLI(@04),B'10000000'                            0962 03672000
         BNZ   @RF00962                                            0962 03673000
*                                      CURSTAT=OFFLN;/* SAY IT IS  0963 03674000
*                                                            @OZ30157*/ 03675000
         MVI   CURSTAT,X'02'                                       0963 03676000
*                                     ELSE/* IF NOT, IS IT SUU     0964 03677000
*                                                            @OZ30157*/ 03678000
*                                      IF UCBNOTRD=BONE THEN/* YES,     03679000
*                                                            @OZ30157*/ 03680000
         B     @RC00962                                            0964 03681000
@RF00962 L     @04,@CA00927                                        0964 03682000
         L     @04,UCBPTR-UCBPTR(,@04)                             0964 03683000
         TM    UCBNOTRD(@04),B'01000000'                           0964 03684000
         BNO   @RF00964                                            0964 03685000
*                                       CURSTAT=SUU;/* SAY THAT, ELSE   03686000
*                                                            @OZ30157*/ 03687000
         MVI   CURSTAT,X'03'                                       0965 03688000
*                                      ELSE/* SAY IT IS      @OZ30157*/ 03689000
*                                       CURSTAT=ONLN;/* ONLINE     0966 03690000
*                                                            @OZ30157*/ 03691000
         B     @RC00964                                            0966 03692000
@RF00964 MVI   CURSTAT,X'01'                                       0966 03693000
*/********************************************************************/ 03694000
*/*                                                                  */ 03695000
*/* SET CHAIN REFERENCE TO CHAIN THIS TO NEXT PREVIOUS ONE IN CHAIN  */ 03696000
*/*                                                          @OZ30157*/ 03697000
*/*                                                                  */ 03698000
*/********************************************************************/ 03699000
*                                                                  0967 03700000
*                                     IF CURSTAT^=PRVSTAT THEN/* NOT    03701000
*                                      SAME                  @OZ30157*/ 03702000
@RC00964 DS    0H                                                  0967 03703000
@RC00962 CLC   CURSTAT(1),PRVSTAT                                  0967 03704000
         BE    @RF00967                                            0967 03705000
*                                      DO;/* AS PREVIOUS, SET NEW  0968 03706000
*                                      CHAIN                 @OZ30157*/ 03707000
*                                       IF PRVSTAT^=F0 THEN/* IF ANY    03708000
*                                      PREV                  @OZ30157*/ 03709000
         CLI   PRVSTAT,0                                           0969 03710000
         BE    @RF00969                                            0969 03711000
*                                        CURPTR(PRVSTAT)=TABPTR;/* SV   03712000
*                                      OLD                   @OZ30157*/ 03713000
         SLR   @04,@04                                             0970 03714000
         IC    @04,PRVSTAT                                         0970 03715000
         SLA   @04,2                                               0970 03716000
         L     @00,TABPTR                                          0970 03717000
         ST    @00,@TF00001                                        0970 03718000
         LA    @15,CURPTR-4(@04)                                   0970 03719000
         MVC   0(3,@15),@TF00001+1                                 0970 03720000
*                                       VUAPTR=CURPTR(CURSTAT);/* GET   03721000
*                                      NEW                   @OZ30157*/ 03722000
*                                                                  0971 03723000
@RF00969 SLR   @04,@04                                             0971 03724000
         IC    @04,CURSTAT                                         0971 03725000
         SLA   @04,2                                               0971 03726000
         L     @04,CURPTR-5(@04)                                   0971 03727000
         LA    @04,0(,@04)                                         0971 03728000
         ST    @04,VUAPTR                                          0971 03729000
*                                       /*****************************/ 03730000
*                                       /*                           */ 03731000
*                                       /* IF THIS IS THE FIRST VUA  */ 03732000
*                                       /* WITH THIS STATUS, MUST    */ 03733000
*                                       /* BUILD A NEW VUA CHAIN.    */ 03734000
*                                       /*                   @OZ30157*/ 03735000
*                                       /*                           */ 03736000
*                                       /*****************************/ 03737000
*                                                                  0972 03738000
*                                       IF VUAPTR=F0 THEN/* ANY CURR    03739000
*                                      CHN                   @OZ30157*/ 03740000
         LTR   @04,@04                                             0972 03741000
         BNZ   @RF00972                                            0972 03742000
*                                        DO;/* NO SET CHAIN  @OZ30157*/ 03743000
*                                         IF CPDVUA=BZERO THEN/* IF     03744000
*                                      FIRST                 @OZ30157*/ 03745000
         L     @04,CPDPTR                                          0974 03746000
         TM    CPDVUA(@04),B'00000001'                             0974 03747000
         BNZ   @RF00974                                            0974 03748000
*                                          DO;/* THEN SET FOR IT   0975 03749000
*                                                            @OZ30157*/ 03750000
*                                           VUAPTR=CPDPTR+CPDLEN;/*     03751000
*                                                            @OZ30157*/ 03752000
         LH    @00,CPDLEN                                          0976 03753000
         ALR   @00,@04                                             0976 03754000
         ST    @00,VUAPTR                                          0976 03755000
*                                           CPDVUA=BONE;/* ONCE ONLY    03756000
*                                                            @OZ30157*/ 03757000
         OI    CPDVUA(@04),B'00000001'                             0977 03758000
*                                          END;/* IF NOT FIRST, THEN    03759000
*                                                            @OZ30157*/ 03760000
*                                         ELSE/* SET FOR NEXT VUA  0979 03761000
*                                                            @OZ30157*/ 03762000
*                                          VUAPTR=TABPTR+VUALEN;/* 0979 03763000
*                                                            @OZ30157*/ 03764000
         B     @RC00974                                            0979 03765000
@RF00974 LA    @04,388                                             0979 03766000
         AL    @04,TABPTR                                          0979 03767000
         ST    @04,VUAPTR                                          0979 03768000
*                                         LVUPTR=ADDR(CHNPTR(CURSTAT)); 03769000
@RC00974 SLR   @04,@04                                             0980 03770000
         IC    @04,CURSTAT                                         0980 03771000
         SLA   @04,2                                               0980 03772000
         L     @15,CPDPTR                                          0980 03773000
         LA    @04,CHNPTR-4(@04,@15)                               0980 03774000
         ST    @04,LVUPTR                                          0980 03775000
*                                         /*                 @OZ30157*/ 03776000
*                                         NEWVUA=BONE;/* GET NEW VUA    03777000
*                                                            @OZ30157*/ 03778000
         OI    NEWVUA,B'00000010'                                  0981 03779000
*                                        END;/* END SET NEW CHAIN  0982 03780000
*                                                            @OZ30157*/ 03781000
*                                                                  0982 03782000
*                                       /*****************************/ 03783000
*                                       /*                           */ 03784000
*                                       /* IF NOT FIRST, USE CURRENT */ 03785000
*                                       /* ENTRY IN CURRENT CHAIN.   */ 03786000
*                                       /*                   @OZ30157*/ 03787000
*                                       /*                           */ 03788000
*                                       /*****************************/ 03789000
*                                                                  0983 03790000
*                                       ELSE/* ELSE USE CURR CHAIN 0983 03791000
*                                                            @OZ30157*/ 03792000
*                                        DO;/* SET UP LINKS  @OZ30157*/ 03793000
         B     @RC00972                                            0983 03794000
@RF00972 DS    0H                                                  0984 03795000
*                                         NEWVUA=BZERO;/* NXT WILL BE   03796000
*                                      NEW                   @OZ30157*/ 03797000
         NI    NEWVUA,B'11111101'                                  0984 03798000
*                                         TABPTR=VUAPTR;/*   @OZ30157*/ 03799000
         L     @04,VUAPTR                                          0985 03800000
         ST    @04,TABPTR                                          0985 03801000
*                                         LVUPTR=ADDR(VUACHN);/* CUR    03802000
*                                      CHAIN                 @OZ30157*/ 03803000
         LA    @00,VUACHN(,@04)                                    0986 03804000
         ST    @00,LVUPTR                                          0986 03805000
*                                         USEADB(CURSTAT)=BZERO;/* 0987 03806000
*                                      VUAA                  @OZ30157*/ 03807000
*                                                                  0987 03808000
         SLR   @15,@15                                             0987 03809000
         IC    @15,CURSTAT                                         0987 03810000
         SLA   @15,2                                               0987 03811000
         LA    @14,USEADB-4(@15)                                   0987 03812000
         NI    0(@14),B'01111111'                                  0987 03813000
*                                         /***************************/ 03814000
*                                         /*                         */ 03815000
*                                         /* IF THE CURRENT ENTRY IS */ 03816000
*                                         /* FULL, MUST BUILD A NEW  */ 03817000
*                                         /* ONE             @OZ30157*/ 03818000
*                                         /*                         */ 03819000
*                                         /***************************/ 03820000
*                                                                  0988 03821000
*                                         IF VUACNT>63 THEN/*      0988 03822000
*                                                            @OZ30157*/ 03823000
         CLI   VUACNT(@04),63                                      0988 03824000
         BNH   @RF00988                                            0988 03825000
*                                          DO;/* SET UP NEW VUA ENTRY   03826000
*                                                            @OZ30157*/ 03827000
*                                           NEWVUA=BONE;/*   @OZ30157*/ 03828000
         OI    NEWVUA,B'00000010'                                  0990 03829000
*                                           VUAPTR=VUALEN+TABPTR;/*     03830000
*                                                            @OZ30157*/ 03831000
         AH    @04,@CH03055                                        0991 03832000
         ST    @04,VUAPTR                                          0991 03833000
*                                          END;/* END SETUP NEW    0992 03834000
*                                                            @OZ30157*/ 03835000
*                                        END;/* END NOT 0 VUAPTR   0993 03836000
*                                                            @OZ30157*/ 03837000
*                                      END;/* END NOT SAME STATUS  0994 03838000
*                                                            @OZ30157*/ 03839000
*                                                                  0994 03840000
*                                     /*******************************/ 03841000
*                                     /*                             */ 03842000
*                                     /* IF THIS VUA HAS SAME STATUS */ 03843000
*                                     /* AS PREVIOUS, IF THE CURRENT */ 03844000
*                                     /* ENTRY IS FULL, MUST ADD A   */ 03845000
*                                     /* NEW ENTRY TO THE CHAIN.     */ 03846000
*                                     /*                     @OZ30157*/ 03847000
*                                     /*                             */ 03848000
*                                     /*******************************/ 03849000
*                                                                  0995 03850000
*                                     ELSE/* ELSE SAME STATUS      0995 03851000
*                                                            @OZ30157*/ 03852000
*                                      IF VUACNT>63 THEN/* IF OLD  0995 03853000
*                                      FULL                  @OZ30157*/ 03854000
         B     @RC00967                                            0995 03855000
@RF00967 L     @04,TABPTR                                          0995 03856000
         CLI   VUACNT(@04),63                                      0995 03857000
         BNH   @RF00995                                            0995 03858000
*                                       DO;/* SET UP NEW     @OZ30157*/ 03859000
*                                        NEWVUA=BONE;/*      @OZ30157*/ 03860000
         OI    NEWVUA,B'00000010'                                  0997 03861000
*                                        VUAPTR=VUALEN+TABPTR;/*   0998 03862000
*                                                            @OZ30157*/ 03863000
         AH    @04,@CH03055                                        0998 03864000
         ST    @04,VUAPTR                                          0998 03865000
*                                       END;/* END SETUP NEW @OZ30157*/ 03866000
*                                                                  0999 03867000
*                                     /*******************************/ 03868000
*                                     /*                             */ 03869000
*                                     /* IF THE ENTRY IS NOT FULL,   */ 03870000
*                                     /* CAN USE IT          @OZ30157*/ 03871000
*                                     /*                             */ 03872000
*                                     /*******************************/ 03873000
*                                                                  1000 03874000
*                                      ELSE/* ELSE USE OLD   @OZ30157*/ 03875000
*                                       DO;/* VUA ENTRY AND PUT    1000 03876000
*                                                            @OZ30157*/ 03877000
         B     @RC00995                                            1000 03878000
@RF00995 DS    0H                                                  1001 03879000
*                                        NEWVUA=BZERO;/* INTO THE  1001 03880000
*                                                            @OZ30157*/ 03881000
         NI    NEWVUA,B'11111101'                                  1001 03882000
*                                        VUAPTR=CURPTR(CURSTAT);/* 1002 03883000
*                                                            @OZ30157*/ 03884000
         SLR   @04,@04                                             1002 03885000
         IC    @04,CURSTAT                                         1002 03886000
         SLA   @04,2                                               1002 03887000
         L     @00,CURPTR-5(@04)                                   1002 03888000
         N     @00,@CF03658                                        1002 03889000
         ST    @00,VUAPTR                                          1002 03890000
*                                        USEADB(CURSTAT)=BONE;/*   1003 03891000
*                                      FIELD                 @OZ30157*/ 03892000
         LA    @15,USEADB-4(@04)                                   1003 03893000
         OI    0(@15),B'10000000'                                  1003 03894000
*                                       END;/* END USE OLD   @OZ30157*/ 03895000
*                                     TABPTR=VUAPTR;/*       @OZ30157*/ 03896000
*                                                                  1005 03897000
@RC00995 DS    0H                                                  1005 03898000
@RC00967 L     @04,VUAPTR                                          1005 03899000
         ST    @04,TABPTR                                          1005 03900000
*                                     /*******************************/ 03901000
*                                     /*                             */ 03902000
*                                     /* BUILD A NEW VUA ENTRY       */ 03903000
*                                     /*                     @OZ30157*/ 03904000
*                                     /*                             */ 03905000
*                                     /*******************************/ 03906000
*                                                                  1006 03907000
*                                     IF NEWVUA=BONE THEN/* IF NEW 1006 03908000
*                                      ONE                   @OZ30157*/ 03909000
         TM    NEWVUA,B'00000010'                                  1006 03910000
         BNO   @RF01006                                            1006 03911000
*                                      DO;/* INITIALIZE      @OZ30157*/ 03912000
*/*   IF NOT ENOUGH SPACE IN CURRENT BLOCK, MUST GET MORE    @OZ30157*/ 03913000
*                                                                  1008 03914000
*                                       IF VUAPTR>(LASTENT-388+CPDLEN)  03915000
*                                        THEN/*              @OZ30157*/ 03916000
         L     @00,LASTENT                                         1008 03917000
         SH    @00,@CH03055                                        1008 03918000
         AH    @00,CPDLEN                                          1008 03919000
         CR    @04,@00                                             1008 03920000
         BNH   @RF01008                                            1008 03921000
*                                        DO;/* THEN GET IT   @OZ30157*/ 03922000
*                                         R1=LVUPTR;/* SET UP GETMAIN   03923000
*                                                            @OZ30157*/ 03924000
         L     R1,LVUPTR                                           1010 03925000
*                                         CALL MSG56F;/*     @OZ30157*/ 03926000
         BAL   @14,MSG56F                                          1011 03927000
*                                         IF RETC=F0 THEN/* GOOD GETM   03928000
*                                                            @OZ30157*/ 03929000
         LH    @04,RETC                                            1012 03930000
         LTR   @04,@04                                             1012 03931000
         BNZ   @RF01012                                            1012 03932000
*                                          DO;/* IF GOOD,    @OZ30157*/ 03933000
*                                           VUAPTR=CHNADR;/* @OZ30157*/ 03934000
         L     @04,LVUPTR                                          1014 03935000
         L     @04,CHNADR-1(,@04)                                  1014 03936000
         LA    @04,0(,@04)                                         1014 03937000
         ST    @04,VUAPTR                                          1014 03938000
*                                           LASTENT=VUAPTR+2047;/* 1015 03939000
*                                                            @OZ30157*/ 03940000
         AH    @04,@CH03110                                        1015 03941000
         ST    @04,LASTENT                                         1015 03942000
*                                          END;/*            @OZ30157*/ 03943000
*                                        END;/*              @OZ30157*/ 03944000
@RF01012 DS    0H                                                  1018 03945000
*                                       IF RETC=F0 THEN/* IF SPACE 1018 03946000
*                                      GOOD                  @OZ30157*/ 03947000
@RF01008 LH    @04,RETC                                            1018 03948000
         LTR   @04,@04                                             1018 03949000
         BNZ   @RF01018                                            1018 03950000
*                                        DO;/* OR NOT REQUIRED,    1019 03951000
*                                                            @OZ30157*/ 03952000
*                                         CHNADR=VUAPTR;/* SET UP  1020 03953000
*                                      CHAIN                 @OZ30157*/ 03954000
         L     @04,VUAPTR                                          1020 03955000
         ST    @04,@TF00001                                        1020 03956000
         L     @15,LVUPTR                                          1020 03957000
         MVC   CHNADR(3,@15),@TF00001+1                            1020 03958000
*                                         ENDPTR=VUAPTR;/* SAVE HIGH    03959000
*                                      ADDR                  @OZ30157*/ 03960000
         ST    @04,ENDPTR                                          1021 03961000
*                                         VUACNT=F1;/* BUILD NEW   1022 03962000
*                                      ENTRY                 @OZ30157*/ 03963000
         L     @15,TABPTR                                          1022 03964000
         MVI   VUACNT(@15),X'01'                                   1022 03965000
*                                         VUACHN=F0;/* CLEAR NEW   1023 03966000
*                                      CHAIN                 @OZ30157*/ 03967000
         SLR   @00,@00                                             1023 03968000
         ST    @00,@TF00001                                        1023 03969000
         MVC   VUACHN(3,@15),@TF00001+1                            1023 03970000
*                                         VUAA(1)=UCBNAME;/* FST VUA    03971000
*                                      NME                   @OZ30157*/ 03972000
         L     @14,@CA00927                                        1024 03973000
         L     @14,UCBPTR-UCBPTR(,@14)                             1024 03974000
         MVC   VUAA(3,@15),UCBNAME(@14)                            1024 03975000
*                                         VUAA(1,1:1)=CPDCH;/*     1025 03976000
*                                      CHANNEL               @OZ30157*/ 03977000
         L     @14,CPDPTR                                          1025 03978000
         MVC   VUAA(1,@15),CPDCH(@14)                              1025 03979000
*                                         VUAB(1)='   ';/* SECOND  1026 03980000
*                                      BLANKS                @OZ30157*/ 03981000
         MVC   VUAB(3,@15),@CC03112                                1026 03982000
*                                         USEADB(CURSTAT)=BONE;/*  1027 03983000
*                                                            @OZ30157*/ 03984000
         SLR   @15,@15                                             1027 03985000
         IC    @15,CURSTAT                                         1027 03986000
         SLA   @15,2                                               1027 03987000
         LA    @14,USEADB-4(@15)                                   1027 03988000
         OI    0(@14),B'10000000'                                  1027 03989000
*                                         CURPTR(CURSTAT)=VUAPTR;/*     03990000
*                                                            @OZ30157*/ 03991000
         ST    @04,@TF00001                                        1028 03992000
         LA    @14,CURPTR-4(@15)                                   1028 03993000
         MVC   0(3,@14),@TF00001+1                                 1028 03994000
*                                        END;/* END NEW SPACE GOOD 1029 03995000
*                                                            @OZ30157*/ 03996000
*                                      END;/* END INITIALIZE NEW   1030 03997000
*                                                            @OZ30157*/ 03998000
*                                                                  1030 03999000
*                                     /*******************************/ 04000000
*                                     /*                             */ 04001000
*                                     /* ADD TO EXISTING VUA ENTRY.  */ 04002000
*                                     /* IF USEADB IS ON, MUST PUT   */ 04003000
*                                     /* VUA IN CURRENT VUAB FIELD.  */ 04004000
*                                     /*                     @OZ30157*/ 04005000
*                                     /*                             */ 04006000
*                                     /*******************************/ 04007000
*                                                                  1031 04008000
*                                     ELSE/* NOT NEW, BUT NEW      1031 04009000
*                                      COUNT@OZ30157                 */ 04010000
*                                      DO;/* IF FOR VUAB, SET IT   1031 04011000
*                                                            @OZ30157*/ 04012000
         B     @RC01006                                            1031 04013000
@RF01006 DS    0H                                                  1032 04014000
*                                       IF USEADB(CURSTAT)=BONE THEN    04015000
         SLR   @04,@04                                             1032 04016000
         IC    @04,CURSTAT                                         1032 04017000
         SLA   @04,2                                               1032 04018000
         LA    @15,USEADB-4(@04)                                   1032 04019000
         TM    0(@15),B'10000000'                                  1032 04020000
         BNO   @RF01032                                            1032 04021000
*                                        /*                  @OZ30157*/ 04022000
*                                        DO;/*               @OZ30157*/ 04023000
*                                         VUAB(VUACNT)=UCBNAME;/*  1034 04024000
*                                                            @OZ30157*/ 04025000
         L     @04,TABPTR                                          1034 04026000
         SLR   @15,@15                                             1034 04027000
         IC    @15,VUACNT(,@04)                                    1034 04028000
         MH    @15,@CH00038                                        1034 04029000
         ST    @15,@TF00001                                        1034 04030000
         ALR   @15,@04                                             1034 04031000
         L     @14,@CA00927                                        1034 04032000
         L     @14,UCBPTR-UCBPTR(,@14)                             1034 04033000
         MVC   VUAB-6(3,@15),UCBNAME(@14)                          1034 04034000
*                                         VUAB(VUACNT,1:1)=CPDCH;/*     04035000
*                                      CHAN                  @OZ30157*/ 04036000
         AL    @04,@TF00001                                        1035 04037000
         L     @15,CPDPTR                                          1035 04038000
         MVC   VUAB-6(1,@04),CPDCH(@15)                            1035 04039000
*                                        END;/*              @OZ30157*/ 04040000
*                                                                  1036 04041000
*                                       /*****************************/ 04042000
*                                       /*                           */ 04043000
*                                       /* IF USEADB IS OFF, PUT VUA */ 04044000
*                                       /* IN NEXT VUAA FIELD AND SET*/ 04045000
*                                       /* USEADB SO THAT THE NEXT   */ 04046000
*                                       /* ONE WILL GO INTO THE VUAB */ 04047000
*                                       /* FIELD             @OZ30157*/ 04048000
*                                       /*                           */ 04049000
*                                       /*****************************/ 04050000
*                                                                  1037 04051000
*                                       ELSE/* ELSE PUT IN NEXT    1037 04052000
*                                                            @OZ30157*/ 04053000
*                                        DO;/* VUAA          @OZ30157*/ 04054000
         B     @RC01032                                            1037 04055000
@RF01032 DS    0H                                                  1038 04056000
*                                         VUACNT=VUACNT+1;/* BUMP CNT   04057000
*                                                            @OZ30157*/ 04058000
         L     @04,TABPTR                                          1038 04059000
         LA    @00,1                                               1038 04060000
         MVC   @ZT00003+3(1),VUACNT(@04)                           1038 04061000
         AL    @00,@ZT00003                                        1038 04062000
         STC   @00,VUACNT(,@04)                                    1038 04063000
*                                         VUAA(VUACNT)=UCBNAME;/* SET   04064000
*                                                            @OZ30157*/ 04065000
         MH    @00,@CH00038                                        1039 04066000
         LR    @15,@00                                             1039 04067000
         ALR   @15,@04                                             1039 04068000
         BCTR  @15,0                                               1039 04069000
         BCTR  @15,0                                               1039 04070000
         L     @14,@CA00927                                        1039 04071000
         L     @14,UCBPTR-UCBPTR(,@14)                             1039 04072000
         MVC   VUAA-4(3,@15),UCBNAME(@14)                          1039 04073000
*                                         VUAA(VUACNT,1:1)=CPDCH;/*     04074000
*                                      CHAN                  @OZ30157*/ 04075000
         LR    @15,@00                                             1040 04076000
         ALR   @15,@04                                             1040 04077000
         BCTR  @15,0                                               1040 04078000
         BCTR  @15,0                                               1040 04079000
         L     @14,CPDPTR                                          1040 04080000
         MVC   VUAA-4(1,@15),CPDCH(@14)                            1040 04081000
*                                         VUAB(VUACNT)='   ';/* CLEAR   04082000
*                                                            @OZ30157*/ 04083000
         ALR   @04,@00                                             1041 04084000
         MVC   VUAB-6(3,@04),@CC03112                              1041 04085000
*                                         USEADB(CURSTAT)=BONE;/*  1042 04086000
*                                                            @OZ30157*/ 04087000
         SLR   @04,@04                                             1042 04088000
         IC    @04,CURSTAT                                         1042 04089000
         SLA   @04,2                                               1042 04090000
         LA    @15,USEADB-4(@04)                                   1042 04091000
         OI    0(@15),B'10000000'                                  1042 04092000
*                                        END;/* DONE THIS SUBENT   1043 04093000
*                                                            @OZ30157*/ 04094000
*                                      END;/* END ADD TO OLD @OZ30157*/ 04095000
@RC01032 DS    0H                                                  1045 04096000
*                                    END;/* END VUA LOOP     @OZ30157*/ 04097000
@RC01006 LA    @04,1                                               1045 04098000
         AH    @04,K2                                              1045 04099000
         STH   @04,K2                                              1045 04100000
         CH    @04,@CH01346                                        1045 04101000
         BNH   @DL00957                                            1045 04102000
*                                   END;/* END SAME CPU      @OZ30157*/ 04103000
*                                                                  1046 04104000
*                                 /***********************************/ 04105000
*                                 /*                                 */ 04106000
*                                 /* IF NOT FOR THE CURRENT HOST, CAN*/ 04107000
*                                 /* ONLY PUT IN VUA RANGE THAT CAN  */ 04108000
*                                 /* BE ACCESSED BY THE CPU. PUT INTO*/ 04109000
*                                 /* ONLINE CHAIN            @OZ30157*/ 04110000
*                                 /*                                 */ 04111000
*                                 /***********************************/ 04112000
*                                                                  1047 04113000
*                                 ELSE/* IF NOT SAME CPU     @OZ30157*/ 04114000
*                                   DO;/* THEN SET ONLINE GROUP    1047 04115000
*                                                            @OZ30157*/ 04116000
         B     @RC00948                                            1047 04117000
@RF00948 DS    0H                                                  1048 04118000
*                                    ENDSW=BONE;/* FORCE LAST ENTRY     04119000
*                                                            @OZ30157*/ 04120000
         OI    ENDSW,B'00000100'                                   1048 04121000
*                                    VUAPTR=CPDPTR+CPDLEN;/* @OZ30157*/ 04122000
         L     @04,CPDPTR                                          1049 04123000
         LH    @00,CPDLEN                                          1049 04124000
         ALR   @00,@04                                             1049 04125000
         ST    @00,VUAPTR                                          1049 04126000
*                                    ENDPTR=VUAPTR;/* SAVE HIGH    1050 04127000
*                                      ADDRESS               @OZ30157*/ 04128000
         ST    @00,ENDPTR                                          1050 04129000
*                                    CPDONL=VUAPTR;/* POINT TO VUA 1051 04130000
*                                      ENTRY                 @OZ30157*/ 04131000
         ST    @00,@TF00001                                        1051 04132000
         MVC   CPDONL(3,@04),@TF00001+1                            1051 04133000
*                                    CPDFLG1=BONE;/* NOT REAL ONLINE    04134000
*                                                            @OZ30157*/ 04135000
         OI    CPDFLG1(@04),B'10000000'                            1052 04136000
*                                    CURSTAT=ONLN;/* SET FOR ONLINE     04137000
*                                                            @OZ30157*/ 04138000
         MVI   CURSTAT,X'01'                                       1053 04139000
*                                    TABPTR=VUAPTR;/* POINT TO ENTRY    04140000
*                                                            @OZ30157*/ 04141000
         ST    @00,TABPTR                                          1054 04142000
*                                    VUACNT=F1;/* COUNT OF ONE     1055 04143000
*                                                            @OZ30157*/ 04144000
         LR    @04,@00                                             1055 04145000
         MVI   VUACNT(@04),X'01'                                   1055 04146000
*                                    VUACHN=F0;/* AND END OF CHAIN 1056 04147000
*                                                            @OZ30157*/ 04148000
         LR    @04,@00                                             1056 04149000
         SLR   @15,@15                                             1056 04150000
         ST    @15,@TF00001                                        1056 04151000
         MVC   VUACHN(3,@04),@TF00001+1                            1056 04152000
*                                    VUAA(1)=VUA00;/* SET BASE VALUE    04153000
*                                      AND                   @OZ30157*/ 04154000
         LR    @04,@00                                             1057 04155000
         MVC   VUAA(3,@04),VUA00                                   1057 04156000
*                                    VUAA(1,1:1)=PCHANCX;/* CHANNEL     04157000
*                                      ADDRESS               @OZ30157*/ 04158000
         LR    @04,@00                                             1058 04159000
         MVC   VUAA(1,@04),PCHANCX                                 1058 04160000
*                                    PUNIT=PCNTL*4;/* AND CONTROL  1059 04161000
*                                      UNIT                  @OZ30157*/ 04162000
         L     @04,PCNTL                                           1059 04163000
         SLA   @04,2                                               1059 04164000
         ST    @04,PUNIT                                           1059 04165000
*                                    VUAA(1,2:2)=PUNITCX;/* INTO VUAA   04166000
*                                                            @OZ30157*/ 04167000
         LR    @04,@00                                             1060 04168000
         MVC   VUAA+1(1,@04),PUNITCX                               1060 04169000
*                                    VUAB(1)=VUAA(1)|VUA3F;/* SET  1061 04170000
*                                      VUAB                  @OZ30157*/ 04171000
         LR    @04,@00                                             1061 04172000
         LR    @15,@00                                             1061 04173000
         MVC   VUAB(3,@04),VUAA(@15)                               1061 04174000
         OC    VUAB(3,@04),VUA3F                                   1061 04175000
*                                    TR(VUAA(1),NUMBRS);/* MAKE    1062 04176000
*                                                            @OZ30157*/ 04177000
         LR    @04,@00                                             1062 04178000
         TR    VUAA(3,@04),NUMBRS                                  1062 04179000
*                                    TR(VUAB(1),NUMBRS);/* PRINTABLE    04180000
*                                                            @OZ30157*/ 04181000
         LR    @04,@00                                             1063 04182000
         TR    VUAB(3,@04),NUMBRS                                  1063 04183000
*                                   END;/* END NOT SAME CPU  @OZ30157*/ 04184000
*                                 LVUPTR=ADDR(CPDCHN);/* SET FOR   1065 04185000
*                                      CHAINING              @OZ30157*/ 04186000
@RC00948 L     @04,CPDPTR                                          1065 04187000
         LA    @04,CPDCHN(,@04)                                    1065 04188000
         ST    @04,LVUPTR                                          1065 04189000
*                                 TABPTR=ENDPTR;/* GET HIGH VUA ADDR    04190000
*                                                            @OZ30157*/ 04191000
         L     @04,ENDPTR                                          1066 04192000
         ST    @04,TABPTR                                          1066 04193000
*                                 CPDPTR=TABPTR+(VUACNT*6)+8;/* NEXT    04194000
*                                      ENTRY                 @OZ30157*/ 04195000
         SLR   @00,@00                                             1067 04196000
         IC    @00,VUACNT(,@04)                                    1067 04197000
         MH    @00,@CH00038                                        1067 04198000
         ALR   @04,@00                                             1067 04199000
         AH    @04,@CH00036                                        1067 04200000
         ST    @04,CPDPTR                                          1067 04201000
*                                 CPDPTR=(CPDPTR/4)*4;/* ROUND TO  1068 04202000
*                                      NEXT WORD             @OZ30157*/ 04203000
         SRL   @04,2                                               1068 04204000
         SLA   @04,2                                               1068 04205000
         ST    @04,CPDPTR                                          1068 04206000
*                                 ENDPTR=CPDPTR;/* SAVE HIGH ADDRESS    04207000
*                                                            @OZ30157*/ 04208000
         ST    @04,ENDPTR                                          1069 04209000
*                               END;/* END VALID INTERFACE   @OZ30157*/ 04210000
*                           END;    /* END INTERFACE LOOP    @OZ30157*/ 04211000
@RF00916 LA    @04,1                                               1071 04212000
         AH    @04,K                                               1071 04213000
         STH   @04,K                                               1071 04214000
         CH    @04,@CH00060                                        1071 04215000
         BNH   @DL00912                                            1071 04216000
*                         END;      /* END GOOD SA ENTRY     @OZ30157*/ 04217000
*                   END;            /* END SA LOOP           @OZ30157*/ 04218000
@RF00910 DS    0H                                                  1073 04219000
@RF00909 LA    @04,1                                               1073 04220000
         AH    @04,J                                               1073 04221000
         STH   @04,J                                               1073 04222000
         CH    @04,@CH01227                                        1073 04223000
         BNH   @DL00907                                            1073 04224000
*               END;                /* USE CONF INDEX FOR SA @OZ30157*/ 04225000
@RF00906 DS    0H                                                  1075 04226000
*           END;                    /* END CPU LOOP          @OZ30157*/ 04227000
@RF00903 LA    @04,16                                              1075 04228000
         AL    @04,CPHPTR                                          1075 04229000
         ST    @04,CPHPTR                                          1075 04230000
@DE00891 C     @04,CPHEND                                          1075 04231000
         BNH   @DL00891                                            1075 04232000
*/********************************************************************/ 04233000
*/*                                                                  */ 04234000
*/*   SETUP TO CALL MSG56G OR ISSUE ERROR MESSAGE            @OZ30157*/ 04235000
*/*                                                                  */ 04236000
*/********************************************************************/ 04237000
*                                                                  1076 04238000
*         END;                      /* END GOOD RETC         @OZ30157*/ 04239000
*       IF RETC=F0&CPUPTR^=F0 THEN  /* IF GOOD TABLES BUILT  @OZ30157*/ 04240000
@RF00794 SLR   @04,@04                                             1077 04241000
         CH    @04,RETC                                            1077 04242000
         BNE   @RF01077                                            1077 04243000
         C     @04,CPUPTR                                          1077 04244000
         BE    @RF01077                                            1077 04245000
*         DO;                       /* SET TO DO DISPLAY     @OZ30157*/ 04246000
*           VALSSID=BONE;           /* SAY SSID VALID        @OZ30157*/ 04247000
*           VALCODE=BONE;           /* AND CODE VALID SO     @OZ30157*/ 04248000
         OI    VALSSID,B'01001000'                                 1080 04249000
*         END;                      /* WILL CALL MSG56G      @OZ30157*/ 04250000
*     END;                          /* END CPU PATH DISPLAY  @OZ30157*/ 04251000
@RF01077 DS    0H                                                  1083 04252000
*   IF DSPSDG=BONE|DSPDRC=BONE THEN /* IF SDG OR DRC PATH    @OZ30157*/ 04253000
@RF00787 L     @04,@CA00041                                        1083 04254000
         L     @04,CWBPTR-CWBPTR(,@04)                             1083 04255000
         TM    DSPSDG(@04),B'00010000'                             1083 04256000
         BO    @RT01083                                            1083 04257000
         TM    DSPDRC(@04),B'10000000'                             1083 04258000
         BNO   @RF01083                                            1083 04259000
@RT01083 DS    0H                                                  1084 04260000
*     DO;                           /* BUILD SDG TABLE HDR   @OZ30157*/ 04261000
*/********************************************************************/ 04262000
*/*                                                                  */ 04263000
*/*     BUILD SDG HEADER TABLE                               @OZ30157*/ 04264000
*/*                                                                  */ 04265000
*/********************************************************************/ 04266000
*                                                                  1085 04267000
*       SDGPTR=F0;                  /* CLEAR FOR GET 2K      @OZ30157*/ 04268000
         SLR   @04,@04                                             1085 04269000
         ST    @04,SDGPTR                                          1085 04270000
*       SDGEND=F0;                  /* CLEAR BFORE FIRST USE @OZ30157*/ 04271000
         ST    @04,SDGEND                                          1086 04272000
*       DRCPTR=F0;                  /* CLEAR BFORE FIRST USE @OZ30157*/ 04273000
         ST    @04,DRCPTR                                          1087 04274000
*       DRCEND=F0;                  /* CLEAR BFORE FIRST USE @OZ30157*/ 04275000
         ST    @04,DRCEND                                          1088 04276000
*       LVUPTR=ADDR(SDGPTR);        /* SET FOR CHAINING      @OZ30157*/ 04277000
         LA    @04,SDGPTR                                          1089 04278000
         ST    @04,LVUPTR                                          1089 04279000
*       R1=LVUPTR;                  /* PARM ADR FOR CALL     @OZ30157*/ 04280000
         LR    R1,@04                                              1090 04281000
*       CALL MSG56F;                /* GO GET SPACE FOR SDGTB@OZ30157*/ 04282000
         BAL   @14,MSG56F                                          1091 04283000
*       IF RETC=F0 THEN             /* GOOD GETM             @OZ30157*/ 04284000
         SLR   @04,@04                                             1092 04285000
         CH    @04,RETC                                            1092 04286000
         BNE   @RF01092                                            1092 04287000
*         DO;                       /* IF GOOD,              @OZ30157*/ 04288000
*           VUAPTR=CHNADR;          /*                       @OZ30157*/ 04289000
         L     @15,LVUPTR                                          1094 04290000
         L     @00,CHNADR-1(,@15)                                  1094 04291000
         N     @00,@CF03658                                        1094 04292000
         ST    @00,VUAPTR                                          1094 04293000
*           LASTENT=VUAPTR+2047;    /*                       @OZ30157*/ 04294000
         AH    @00,@CH03110                                        1095 04295000
         ST    @00,LASTENT                                         1095 04296000
*           SDGEND=SDGPTR+216;      /* AND QUERIES           @OZ30157*/ 04297000
         L     @15,SDGPTR                                          1096 04298000
         LA    @00,216                                             1096 04299000
         ALR   @00,@15                                             1096 04300000
         ST    @00,SDGEND                                          1096 04301000
*/********************************************************************/ 04302000
*/*                                                                  */ 04303000
*/* BUILD A HEADER ENTRY FOR EACH SA IN THE CONFIGURATION TABLE      */ 04304000
*/*                                                          @OZ30157*/ 04305000
*/*                                                                  */ 04306000
*/********************************************************************/ 04307000
*                                                                  1097 04308000
*           TABPTR=SDGPTR;          /* ENTRY ADDRESS         @OZ30157*/ 04309000
         ST    @15,TABPTR                                          1097 04310000
*           I=F1;                   /* START POINT DEFAULT   @OZ30157*/ 04311000
         MVC   I(2),@CH00047                                       1098 04312000
*           I2=F28;                 /* MAXIMUM SDG NUMBER+1  @OZ30157*/ 04313000
         MVC   I2(2),@CH01339                                      1099 04314000
*           IF DSPQUAL=BONE&DSPSDG=BONE THEN/* IF OP IS SDGNN      1100 04315000
*                                                            @OZ30157*/ 04316000
         L     @15,@CA00041                                        1100 04317000
         L     @15,CWBPTR-CWBPTR(,@15)                             1100 04318000
         TM    DSPQUAL(@15),B'00100000'                            1100 04319000
         BNO   @RF01100                                            1100 04320000
         TM    DSPSDG(@15),B'00010000'                             1100 04321000
         BNO   @RF01100                                            1100 04322000
*             DO;                   /* THEN SET LIMITS PER   @OZ30157*/ 04323000
*               QUALLEN(1)=F2;      /* QUALIFIER             @OZ30157*/ 04324000
         MVC   QUALLEN(2),@CH00056                                 1102 04325000
*               QUALLEN(2)=F0;      /* ONE QUALIFIER NEEDED  @OZ30157*/ 04326000
         STH   @04,QUALLEN+2                                       1103 04327000
*               CALL MSG56QU;       /* GO GET IT             @OZ30157*/ 04328000
         BAL   @14,MSG56QU                                         1104 04329000
*               IF RETC=F0 THEN     /* IF GOT ONE 2 BYTE QUAL@OZ30157*/ 04330000
         LH    @04,RETC                                            1105 04331000
         LTR   @04,@04                                             1105 04332000
         BNZ   @RF01105                                            1105 04333000
*                 DO;               /* THEN USE IT           @OZ30157*/ 04334000
*                   PACK(CPXCPU,QUAL(1,1:2));/* PACK SDG NUMBER    1107 04335000
*                                                            @OZ30157*/ 04336000
         PACK  CPXCPU(5),QUAL(2)                                   1107 04337000
*                   CVB(I,CPXCPU);  /* CVT TO BINARY START   @OZ30157*/ 04338000
         XC    @TS00001(8),@TS00001                                1108 04339000
         MVC   @TS00001+3(5),CPXCPU                                1108 04340000
         CVB   @04,@TS00001                                        1108 04341000
         STH   @04,I                                               1108 04342000
*                   I=I+1;          /* PLUS ONE FOR INDEX    @OZ30157*/ 04343000
         AL    @04,@CF00047                                        1109 04344000
         STH   @04,I                                               1109 04345000
*                   I2=I;           /* AND END LOOP VALUES   @OZ30157*/ 04346000
         STH   @04,I2                                              1110 04347000
*                 END;              /* GOT QUALIFIER         @OZ30157*/ 04348000
*             END;                  /* END QUALIFIER         @OZ30157*/ 04349000
*           ELSE                                                   1113 04350000
*             ;                     /* NO QUALIFIER          @OZ30157*/ 04351000
@RF01100 DS    0H                                                  1114 04352000
*           ENDSW=BZERO;            /* RESET TEST SWITCH     @OZ30157*/ 04353000
@RC01100 NI    ENDSW,B'11111011'                                   1114 04354000
*           DO I=I TO I2 WHILE(RETC=F0);/* LOOP ALL SDGS     @OZ30157*/ 04355000
         LH    @04,I                                               1115 04356000
         B     @DE01115                                            1115 04357000
@DL01115 LH    @00,RETC                                            1115 04358000
         LTR   @00,@00                                             1115 04359000
         BNZ   @DC01115                                            1115 04360000
*             IF SDGXST(I)^='00000000'B THEN/* ALL EXIST SDGS      1116 04361000
*                                                            @OZ30157*/ 04362000
         L     @15,@CA01293                                        1116 04363000
         L     @15,MSGPTR-MSGPTR(,@15)                             1116 04364000
         ALR   @15,@04                                             1116 04365000
         CLI   SDGXST+1(@15),B'00000000'                           1116 04366000
         BE    @RF01116                                            1116 04367000
*               DO;                 /* SDG EXISTS, BUILD AN ENTRY  1117 04368000
*                                                            @OZ30157*/ 04369000
*                 ENDSW=BONE;       /* SAY FOUND IT          @OZ30157*/ 04370000
         OI    ENDSW,B'00000100'                                   1118 04371000
*                 SDGENT=''B;       /* CLEAR BEFORE USE      @OZ30157*/ 04372000
         L     @15,TABPTR                                          1119 04373000
         XC    SDGENT(16,@15),SDGENT(@15)                          1119 04374000
*                 IF I>1 THEN       /* CHAIN TO EARLIER      @OZ30157*/ 04375000
         CH    @04,@CH00047                                        1120 04376000
         BNH   @RF01120                                            1120 04377000
*                   CHAIN=TABPTR;   /* SDGTAB ENTRY          @OZ30157*/ 04378000
         L     @04,LVUPTR                                          1121 04379000
         ST    @15,CHAIN(,@04)                                     1121 04380000
*                 SDGNUM=I-1;       /* SDG DEFINED           @OZ30157*/ 04381000
@RF01120 LH    @04,I                                               1122 04382000
         BCTR  @04,0                                               1122 04383000
         L     @15,TABPTR                                          1122 04384000
         STC   @04,SDGNUM(,@15)                                    1122 04385000
*                 SDGREQ(SDGNUM+1)='FF'X;/* SET REQUEST FLAG @OZ30157*/ 04386000
*                                                                  1123 04387000
         LA    @15,SDGREQ(@04)                                     1123 04388000
         MVI   0(@15),X'FF'                                        1123 04389000
*                 /***************************************************/ 04390000
*                 /*                                                 */ 04391000
*                 /* SCAN ALL SA ENTRIES IN CONFIG INDEX TABLE       */ 04392000
*                 /*                                         @OZ30157*/ 04393000
*                 /*                                                 */ 04394000
*                 /***************************************************/ 04395000
*                                                                  1124 04396000
*                 K=1;              /* SA ENTRY NUMBER       @OZ30157*/ 04397000
         LA    @04,1                                               1124 04398000
         STH   @04,K                                               1124 04399000
*                 DO J=1 TO 16 WHILE(K<3);/* ALL SAS TO CHECK      1125 04400000
*                                                            @OZ30157*/ 04401000
         STH   @04,J                                               1125 04402000
@DL01125 LH    @15,K                                               1125 04403000
         CH    @15,@CH00060                                        1125 04404000
         BNL   @DC01125                                            1125 04405000
*                   TABPTR1=ADDR(CONFXTAB(J));/* SET ENTRY PTR     1126 04406000
*                                                            @OZ30157*/ 04407000
         LR    @14,@04                                             1126 04408000
         SLA   @14,3                                               1126 04409000
         L     @03,CONXPTR                                         1126 04410000
         AL    @03,@CF03654                                        1126 04411000
         LA    @00,CONFXTAB(@14,@03)                               1126 04412000
         ST    @00,TABPTR1                                         1126 04413000
*                   IF CXCSCCS=BZERO THEN/* IF SA CONNECTION @OZ30157*/ 04414000
         LR    @14,@00                                             1127 04415000
         TM    CXCSCCS(@14),B'10000000'                            1127 04416000
         BNZ   @RF01127                                            1127 04417000
*                     IF CXCSCS0^=BZERO|CXCSCS1^=BZERO THEN/* VALID     04418000
*                                                            @OZ30157*/ 04419000
         LR    @14,@00                                             1128 04420000
         TM    CXCSCS0(@14),B'00001100'                            1128 04421000
         BZ    @RF01128                                            1128 04422000
*                       DO;         /* THEN USE IT           @OZ30157*/ 04423000
*                         IF VESDG1(J)=SDGNUM THEN/* IS IT THIS SDG     04424000
*                                                            @OZ30157*/ 04425000
         LR    @14,@04                                             1130 04426000
         SLA   @14,2                                               1130 04427000
         L     @03,TABPTR                                          1130 04428000
         L     @02,VERPTR                                          1130 04429000
         AL    @02,@CF03609                                        1130 04430000
         SLR   @00,@00                                             1130 04431000
         IC    @00,VESDG1(@14,@02)                                 1130 04432000
         MVC   @ZT00003+3(1),SDGNUM(@03)                           1130 04433000
         C     @00,@ZT00003                                        1130 04434000
         BNE   @RF01130                                            1130 04435000
*                           DO;     /*                       @OZ30157*/ 04436000
*                             SDGSANO(K)=J-1;/* WITH SA NUMBER     1132 04437000
*                                                            @OZ30157*/ 04438000
         LR    @14,@15                                             1132 04439000
         MH    @14,@CH00038                                        1132 04440000
         BCTR  @04,0                                               1132 04441000
         LA    @02,0(@14,@03)                                      1132 04442000
         BCTR  @02,0                                               1132 04443000
         BCTR  @02,0                                               1132 04444000
         STC   @04,SDGSANO-4(,@02)                                 1132 04445000
*                             SDGSAP(K)=BONE;/* SAY SA IS PRESENT  1133 04446000
*                                                            @OZ30157*/ 04447000
         ALR   @03,@14                                             1133 04448000
         BCTR  @03,0                                               1133 04449000
         OI    SDGSAP-5(@03),B'00001000'                           1133 04450000
*                             K=K+1;/* GOT ONE, BUILD        @OZ30157*/ 04451000
         LA    @15,1(,@15)                                         1134 04452000
         STH   @15,K                                               1134 04453000
*                           END;    /*                       @OZ30157*/ 04454000
*                         IF VESDG2(J)=SDGNUM THEN/* OR THIS SDG   1136 04455000
*                                                            @OZ30157*/ 04456000
@RF01130 LH    @04,J                                               1136 04457000
         LR    @15,@04                                             1136 04458000
         SLA   @15,2                                               1136 04459000
         L     @14,TABPTR                                          1136 04460000
         L     @03,VERPTR                                          1136 04461000
         AL    @03,@CF03655                                        1136 04462000
         SLR   @00,@00                                             1136 04463000
         IC    @00,VESDG2-1(@15,@03)                               1136 04464000
         MVC   @ZT00003+3(1),SDGNUM(@14)                           1136 04465000
         C     @00,@ZT00003                                        1136 04466000
         BNE   @RF01136                                            1136 04467000
*                           DO;     /*                       @OZ30157*/ 04468000
*                             SDGSANO(K)=J-1;/* WITH SA NUMBER     1138 04469000
*                                                            @OZ30157*/ 04470000
         LH    @15,K                                               1138 04471000
         LR    @03,@15                                             1138 04472000
         MH    @03,@CH00038                                        1138 04473000
         BCTR  @04,0                                               1138 04474000
         LA    @02,0(@03,@14)                                      1138 04475000
         BCTR  @02,0                                               1138 04476000
         BCTR  @02,0                                               1138 04477000
         STC   @04,SDGSANO-4(,@02)                                 1138 04478000
*                             SDGSAP(K)=BONE;/* SAY SA IS PRESENT  1139 04479000
*                                                            @OZ30157*/ 04480000
         ALR   @14,@03                                             1139 04481000
         BCTR  @14,0                                               1139 04482000
         OI    SDGSAP-5(@14),B'00001000'                           1139 04483000
*                             K=K+1;/* GOT ONE, BUILD        @OZ30157*/ 04484000
         LA    @15,1(,@15)                                         1140 04485000
         STH   @15,K                                               1140 04486000
*                           END;    /*                       @OZ30157*/ 04487000
*                         IF CXCSCS1=BONE THEN/* IF ON CARTR STORE 1    04488000
*                                                            @OZ30157*/ 04489000
@RF01136 L     @04,TABPTR1                                         1142 04490000
         TM    CXCSCS1(@04),B'00000100'                            1142 04491000
         BNO   @RF01142                                            1142 04492000
*                           SDGCSFNO(K)=F1;/* THEN SAY SO    @OZ30157*/ 04493000
         LH    @04,K                                               1143 04494000
         MH    @04,@CH00038                                        1143 04495000
         LA    @00,1                                               1143 04496000
         L     @15,TABPTR                                          1143 04497000
         STC   @00,SDGCSFNO-6(@04,@15)                             1143 04498000
*                       END;        /* END SA CONNECTION     @OZ30157*/ 04499000
@RF01142 DS    0H                                                  1145 04500000
*                 END;              /* END SCAN ALL SAS      @OZ30157*/ 04501000
@RF01128 DS    0H                                                  1145 04502000
@RF01127 LA    @04,1                                               1145 04503000
         AH    @04,J                                               1145 04504000
         STH   @04,J                                               1145 04505000
         CH    @04,@CH01227                                        1145 04506000
         BNH   @DL01125                                            1145 04507000
@DC01125 DS    0H                                                  1146 04508000
*                 SDGEND=TABPTR;    /* SET END POINTER       @OZ30157*/ 04509000
         L     @04,TABPTR                                          1146 04510000
         ST    @04,SDGEND                                          1146 04511000
*                 LVUPTR=ADDR(SDGCHN)-F1;/* SET FOR CHAINING @OZ30157*/ 04512000
         LA    @00,SDGCHN(,@04)                                    1147 04513000
         BCTR  @00,0                                               1147 04514000
         ST    @00,LVUPTR                                          1147 04515000
*                 TABPTR=TABPTR+SDGLEN;/* BUMP TO NEXT ENTRY @OZ30157*/ 04516000
         AL    @04,SDGLEN                                          1148 04517000
         ST    @04,TABPTR                                          1148 04518000
*               END;                /* END ENTRY BUILD       @OZ30157*/ 04519000
*           END;                    /* END SDG LOOP          @OZ30157*/ 04520000
@RF01116 LA    @04,1                                               1150 04521000
         AH    @04,I                                               1150 04522000
         STH   @04,I                                               1150 04523000
@DE01115 CH    @04,I2                                              1150 04524000
         BNH   @DL01115                                            1150 04525000
@DC01115 DS    0H                                                  1151 04526000
*           IF ENDSW=BZERO&RETC=F0 THEN/* IF NEW ERROR       @OZ30157*/ 04527000
         TM    ENDSW,B'00000100'                                   1151 04528000
         BNZ   @RF01151                                            1151 04529000
         LH    @04,RETC                                            1151 04530000
         LTR   @04,@04                                             1151 04531000
         BNZ   @RF01151                                            1151 04532000
*             RETC=F1;              /* SAY SO                @OZ30157*/ 04533000
         MVC   RETC(2),@CH00047                                    1152 04534000
*         END;                      /* END GOOD RETC         @OZ30157*/ 04535000
@RF01151 DS    0H                                                  1154 04536000
*       IF RETC=F0 THEN             /* IF GOOD SO FAR        @OZ30157*/ 04537000
@RF01092 LH    @04,RETC                                            1154 04538000
         LTR   @04,@04                                             1154 04539000
         BNZ   @RF01154                                            1154 04540000
*         DO;                       /* KEEP ON               @OZ30157*/ 04541000
*           DO J=1 TO 2;            /* NOW THROUGH 2 CSFS    @OZ30157*/ 04542000
         LA    @04,1                                               1156 04543000
         STH   @04,J                                               1156 04544000
@DL01156 DS    0H                                                  1157 04545000
*             DO I=1 TO 4;          /* DO UP TO 4 DRCS EACH  @OZ30157*/ 04546000
         LA    @04,1                                               1157 04547000
         STH   @04,I                                               1157 04548000
@DL01157 DS    0H                                                  1158 04549000
*               PWCS7X=QAPTR(J+2);  /* POINT TO SECT7.CSF    @OZ30157*/ 04550000
         LH    @15,J                                               1158 04551000
         SLA   @15,2                                               1158 04552000
         L     @00,QAPTR+4(@15)                                    1158 04553000
         ST    @00,PWCS7X                                          1158 04554000
*               IF(DRCXST&CONFGMSK(I))^=HEX00 THEN/* IF EXISTS     1159 04555000
*                                                            @OZ30157*/ 04556000
         L     @15,@CA01293                                        1159 04557000
         L     @15,MSGPTR-MSGPTR(,@15)                             1159 04558000
         L     @14,@CA01312                                        1159 04559000
         MVC   @TS00001(1),DRCXST+2(@15)                           1159 04560000
         ALR   @14,@04                                             1159 04561000
         BCTR  @14,0                                               1159 04562000
         NC    @TS00001(1),CONFGMSK-CONFGMSK(@14)                  1159 04563000
         CLI   @TS00001,X'00'                                      1159 04564000
         BE    @RF01159                                            1159 04565000
*                 DO TABPTR=SDGPTR TO SDGEND BY SDGLEN;/*    @OZ30157*/ 04566000
         L     @04,SDGPTR                                          1160 04567000
         B     @DE01160                                            1160 04568000
@DL01160 DS    0H                                                  1161 04569000
*                   DO K=1 TO 2;    /* CHECK EACH SA IN SDG  @OZ30157*/ 04570000
         LA    @04,1                                               1161 04571000
         STH   @04,K                                               1161 04572000
@DL01161 DS    0H                                                  1162 04573000
*                     PWCS7X=QAPTR(J+2);/* POINT TO SECT7.CSF      1162 04574000
*                                                            @OZ30157*/ 04575000
         LH    @15,J                                               1162 04576000
         SLA   @15,2                                               1162 04577000
         L     @00,QAPTR+4(@15)                                    1162 04578000
         ST    @00,PWCS7X                                          1162 04579000
*                     R1=TESTVAL;   /* SET INITIAL BIT       @OZ30157*/ 04580000
         L     R1,TESTVAL                                          1163 04581000
*                     PUNIT=SDGSANO(K);/* CALC SHIFT VALUE   @OZ30157*/ 04582000
         L     @15,TABPTR                                          1164 04583000
         MH    @04,@CH00038                                        1164 04584000
         LA    @14,0(@04,@15)                                      1164 04585000
         BCTR  @14,0                                               1164 04586000
         BCTR  @14,0                                               1164 04587000
         SLR   @03,@03                                             1164 04588000
         IC    @03,SDGSANO-4(,@14)                                 1164 04589000
         ST    @03,PUNIT                                           1164 04590000
*                     SRL(R1,PUNIT);/* FIND BIT TO CHECK     @OZ30157*/ 04591000
         SRL   R1,0(@03)                                           1165 04592000
*                     PUNIT=R1;     /* PUT INTO PUNIT        @OZ30157*/ 04593000
         ST    R1,PUNIT                                            1166 04594000
*                     SATST=DRCCON(I)&PUNIT;/* CHECK CONNECT @OZ30157*/ 04595000
         L     @14,PUNIT                                           1167 04596000
         LH    @03,I                                               1167 04597000
         LR    @02,@03                                             1167 04598000
         SLA   @02,2                                               1167 04599000
         LR    @15,@00                                             1167 04600000
         ALR   @15,@02                                             1167 04601000
         AL    @15,@CF03609                                        1167 04602000
         MVC   @ZT00002+2(2),DRCCON(@15)                           1167 04603000
         N     @14,@ZT00002                                        1167 04604000
         STH   @14,SATST                                           1167 04605000
*                     IF SATST^=F0 THEN/* IF CONNECTION, THEN      1168 04606000
*                                                            @OZ30157*/ 04607000
         LTR   @14,@14                                             1168 04608000
         BZ    @RF01168                                            1168 04609000
*                       DO;         /* BUILD ENTRIES         @OZ30157*/ 04610000
*                         SDGDCCNO(K)=I-1;/* AND DRC NUMBER  @OZ30157*/ 04611000
         L     @02,TABPTR                                          1170 04612000
         BCTR  @03,0                                               1170 04613000
         STC   @03,SDGDCCNO-6(@04,@02)                             1170 04614000
*                       END;        /* END SET DRC ENTRY     @OZ30157*/ 04615000
*                                                                  1171 04616000
*                     /***********************************************/ 04617000
*                     /*                                             */ 04618000
*                     /* USE WCS SECTORS 7C TO 7F DATA FROM SA AND   */ 04619000
*                     /* PATH UCBS TO FILL IN THE SDG TABLE ENTRY    */ 04620000
*                     /*                                     @OZ30157*/ 04621000
*                     /*                                             */ 04622000
*                     /***********************************************/ 04623000
*                                                                  1172 04624000
*                     IF SDGSAP(K)=BONE THEN/* IF SA IS PRESENT    1172 04625000
*                                                            @OZ30157*/ 04626000
@RF01168 L     @04,TABPTR                                          1172 04627000
         LH    @15,K                                               1172 04628000
         MH    @15,@CH00038                                        1172 04629000
         ST    @15,@TF00001                                        1172 04630000
         ALR   @15,@04                                             1172 04631000
         BCTR  @15,0                                               1172 04632000
         TM    SDGSAP-5(@15),B'00001000'                           1172 04633000
         BNO   @RF01172                                            1172 04634000
*                       DO;         /* THEN                  @OZ30157*/ 04635000
*                         K3=SDGDCCNO(K)+1;/* NOW SET DRC NUMBER   1174 04636000
*                                                            @OZ30157*/ 04637000
         L     @15,@TF00001                                        1174 04638000
         SLR   @00,@00                                             1174 04639000
         IC    @00,SDGDCCNO-6(@15,@04)                             1174 04640000
         AL    @00,@CF00047                                        1174 04641000
         STH   @00,K3                                              1174 04642000
*                         PWCS7X=QAPTR(J+2);/* POINT TO SECT7.CSF  1175 04643000
*                                                            @OZ30157*/ 04644000
*                                                                  1175 04645000
         LH    @15,J                                               1175 04646000
         LR    @14,@15                                             1175 04647000
         SLA   @14,2                                               1175 04648000
         L     @14,QAPTR+4(@14)                                    1175 04649000
         ST    @14,PWCS7X                                          1175 04650000
*                         /*******************************************/ 04651000
*                         /*                                         */ 04652000
*                         /* IF PATH IS VALID                @OZ30157*/ 04653000
*                         /*                                         */ 04654000
*                         /*******************************************/ 04655000
*                                                                  1176 04656000
*                         IF CONFGMSK(K3)=(DRCXST&CONFGMSK(K3)) THEN    04657000
         L     @14,@CA01312                                        1176 04658000
         L     @03,@CA01293                                        1176 04659000
         LA    @02,2                                               1176 04660000
         AL    @02,MSGPTR-MSGPTR(,@03)                             1176 04661000
         MVC   @TS00001(1),DRCXST(@02)                             1176 04662000
         LR    @03,@00                                             1176 04663000
         ALR   @03,@14                                             1176 04664000
         BCTR  @03,0                                               1176 04665000
         NC    @TS00001(1),CONFGMSK-CONFGMSK(@03)                  1176 04666000
         LR    @03,@00                                             1176 04667000
         ALR   @03,@14                                             1176 04668000
         BCTR  @03,0                                               1176 04669000
         CLC   CONFGMSK-CONFGMSK(1,@03),@TS00001                   1176 04670000
         BNE   @RF01176                                            1176 04671000
*                                   /*                       @OZ30157*/ 04672000
*                           DO;     /* THEN GET STATUS       @OZ30157*/ 04673000
*                             IF CONFGMSK(K3)^=(DRCON(J)&CONFGMSK(K3))  04674000
*                               THEN/*                       @OZ30157*/ 04675000
         ALR   @02,@15                                             1178 04676000
         MVC   @TS00001(1),DRCON-1(@02)                            1178 04677000
         LR    @15,@00                                             1178 04678000
         ALR   @15,@14                                             1178 04679000
         BCTR  @15,0                                               1178 04680000
         NC    @TS00001(1),CONFGMSK-CONFGMSK(@15)                  1178 04681000
         ALR   @14,@00                                             1178 04682000
         BCTR  @14,0                                               1178 04683000
         CLC   CONFGMSK-CONFGMSK(1,@14),@TS00001                   1178 04684000
         BE    @RF01178                                            1178 04685000
*                               SDGDCOF(K)=BONE;/* NO, OFFLINE     1179 04686000
*                                                            @OZ30157*/ 04687000
         AL    @04,@TF00001                                        1179 04688000
         OI    SDGDCOF-6(@04),B'10000000'                          1179 04689000
*                             ELSE                                 1180 04690000
*                               SDGDCOF(K)=BZERO;/* YES, ONLINE    1180 04691000
*                                                            @OZ30157*/ 04692000
         B     @RC01178                                            1180 04693000
@RF01178 LH    @04,K                                               1180 04694000
         MH    @04,@CH00038                                        1180 04695000
         L     @15,TABPTR                                          1180 04696000
         ALR   @15,@04                                             1180 04697000
         NI    SDGDCOF-6(@15),B'01111111'                          1180 04698000
*                             IF CONFGMSK(K3)=(DRCRDY(J)&CONFGMSK(K3))  04699000
*                               THEN/*                       @OZ30157*/ 04700000
@RC01178 LH    @04,K3                                              1181 04701000
         L     @15,@CA01312                                        1181 04702000
         LH    @14,J                                               1181 04703000
         L     @03,@CA01293                                        1181 04704000
         L     @03,MSGPTR-MSGPTR(,@03)                             1181 04705000
         ALR   @03,@14                                             1181 04706000
         MVC   @TS00001(1),DRCRDY+1(@03)                           1181 04707000
         ST    @04,@TF00001                                        1181 04708000
         ALR   @04,@15                                             1181 04709000
         BCTR  @04,0                                               1181 04710000
         NC    @TS00001(1),CONFGMSK-CONFGMSK(@04)                  1181 04711000
         AL    @15,@TF00001                                        1181 04712000
         BCTR  @15,0                                               1181 04713000
         CLC   CONFGMSK-CONFGMSK(1,@15),@TS00001                   1181 04714000
         BNE   @RF01181                                            1181 04715000
*                               SDGDCRDY(K)=BONE;/* YES, USABLE    1182 04716000
*                                                            @OZ30157*/ 04717000
         LH    @04,K                                               1182 04718000
         MH    @04,@CH00038                                        1182 04719000
         L     @15,TABPTR                                          1182 04720000
         ALR   @15,@04                                             1182 04721000
         OI    SDGDCRDY-6(@15),B'01000000'                         1182 04722000
*                           END;    /*                       @OZ30157*/ 04723000
*                         ELSE                                     1184 04724000
*                           SDGDCCST(K)=''B;/* NOT VALID     @OZ30157*/ 04725000
         B     @RC01176                                            1184 04726000
@RF01176 LH    @04,K                                               1184 04727000
         MH    @04,@CH00038                                        1184 04728000
         L     @15,TABPTR                                          1184 04729000
         ALR   @15,@04                                             1184 04730000
         MVI   SDGDCCST-6(@15),X'00'                               1184 04731000
*                         PWCS7X=QAPTR((SDGSANO(K)/4)+3);/* SET    1185 04732000
*                                      SECTOR AND            @OZ30157*/ 04733000
@RC01176 L     @04,TABPTR                                          1185 04734000
         LH    @15,K                                               1185 04735000
         MH    @15,@CH00038                                        1185 04736000
         LA    @14,0(@15,@04)                                      1185 04737000
         BCTR  @14,0                                               1185 04738000
         BCTR  @14,0                                               1185 04739000
         SLR   @03,@03                                             1185 04740000
         IC    @03,SDGSANO-4(,@14)                                 1185 04741000
         LR    @02,@03                                             1185 04742000
         SRL   @02,2                                               1185 04743000
         SLA   @02,2                                               1185 04744000
         L     @00,QAPTR+8(@02)                                    1185 04745000
         ST    @00,PWCS7X                                          1185 04746000
*                         K3=(SDGSANO(K)//4)+1;/* UCB INDICES      1186 04747000
*                                                            @OZ30157*/ 04748000
         LR    @14,@03                                             1186 04749000
         ST    @15,@TF00001                                        1186 04750000
         SRDA  @14,32                                              1186 04751000
         D     @14,@CF00045                                        1186 04752000
         AL    @14,@CF00047                                        1186 04753000
         STH   @14,K3                                              1186 04754000
*                         IF SAFVAL(K3)=BONE THEN/* IF SA IS VALID 1187 04755000
*                                                            @OZ30157*/ 04756000
         SLA   @14,2                                               1187 04757000
         LR    @15,@00                                             1187 04758000
         ALR   @15,@14                                             1187 04759000
         TM    SAFVAL-4(@15),B'10000000'                           1187 04760000
         BNO   @RF01187                                            1187 04761000
*                           DO;     /* THEN SET OFL, RDY BITS@OZ30157*/ 04762000
*                             IF SAFONL(K3)=BZERO THEN/* NOT ONLINE     04763000
*                                                            @OZ30157*/ 04764000
         LR    @15,@00                                             1189 04765000
         ALR   @15,@14                                             1189 04766000
         TM    SAFONL-4(@15),B'01000000'                           1189 04767000
         BNZ   @RF01189                                            1189 04768000
*                               SDGSAOF(K)=BONE;/* SAY IS OFFLINE  1190 04769000
*                                                            @OZ30157*/ 04770000
         AL    @04,@TF00001                                        1190 04771000
         BCTR  @04,0                                               1190 04772000
         OI    SDGSAOF-5(@04),B'10000000'                          1190 04773000
*                             ELSE                                 1191 04774000
*                               SDGSAOF(K)=BZERO;/* OR ONLINE      1191 04775000
*                                                            @OZ30157*/ 04776000
         B     @RC01189                                            1191 04777000
@RF01189 LH    @04,K                                               1191 04778000
         MH    @04,@CH00038                                        1191 04779000
         L     @15,TABPTR                                          1191 04780000
         ALR   @15,@04                                             1191 04781000
         BCTR  @15,0                                               1191 04782000
         NI    SDGSAOF-5(@15),B'01111111'                          1191 04783000
*                             IF(SDGSAOF(K)=BONE)&(DSPOFF=BONE) THEN    04784000
@RC01189 L     @04,TABPTR                                          1192 04785000
         LH    @15,K                                               1192 04786000
         MH    @15,@CH00038                                        1192 04787000
         ST    @15,@TF00001                                        1192 04788000
         ALR   @15,@04                                             1192 04789000
         BCTR  @15,0                                               1192 04790000
         TM    SDGSAOF-5(@15),B'10000000'                          1192 04791000
         BNO   @RF01192                                            1192 04792000
         L     @15,@CA00041                                        1192 04793000
         L     @15,CWBPTR-CWBPTR(,@15)                             1192 04794000
         TM    DSPOFF(@15),B'00100000'                             1192 04795000
         BNO   @RF01192                                            1192 04796000
*                                   /*                       @OZ30157*/ 04797000
*                               SDGSAVAL(K)=BONE;/* VALID FOR DISPLAY   04798000
*                                                            @OZ30157*/ 04799000
         AL    @04,@TF00001                                        1193 04800000
         BCTR  @04,0                                               1193 04801000
         OI    SDGSAVAL-5(@04),B'00010000'                         1193 04802000
*                             IF(SDGSAOF(K)=BZERO)&(DSPON=BONE) THEN    04803000
@RF01192 L     @04,TABPTR                                          1194 04804000
         LH    @15,K                                               1194 04805000
         MH    @15,@CH00038                                        1194 04806000
         ST    @15,@TF00001                                        1194 04807000
         ALR   @15,@04                                             1194 04808000
         BCTR  @15,0                                               1194 04809000
         TM    SDGSAOF-5(@15),B'10000000'                          1194 04810000
         BNZ   @RF01194                                            1194 04811000
         L     @15,@CA00041                                        1194 04812000
         L     @15,CWBPTR-CWBPTR(,@15)                             1194 04813000
         TM    DSPON(@15),B'01000000'                              1194 04814000
         BNO   @RF01194                                            1194 04815000
*                                   /*                       @OZ30157*/ 04816000
*                               SDGSAVAL(K)=BONE;/* VALID FOR DISPLAY   04817000
*                                                            @OZ30157*/ 04818000
         AL    @04,@TF00001                                        1195 04819000
         BCTR  @04,0                                               1195 04820000
         OI    SDGSAVAL-5(@04),B'00010000'                         1195 04821000
*                             IF SAFRDY(K3)=BONE THEN/* IF READY   1196 04822000
*                                                            @OZ30157*/ 04823000
@RF01194 LH    @04,K3                                              1196 04824000
         SLA   @04,2                                               1196 04825000
         L     @15,PWCS7X                                          1196 04826000
         ALR   @15,@04                                             1196 04827000
         TM    SAFRDY-4(@15),B'00100000'                           1196 04828000
         BNO   @RF01196                                            1196 04829000
*                               SDGSARDY(K)=BONE;/* SAY SO,  @OZ30157*/ 04830000
         LH    @04,K                                               1197 04831000
         MH    @04,@CH00038                                        1197 04832000
         L     @15,TABPTR                                          1197 04833000
         ALR   @15,@04                                             1197 04834000
         BCTR  @15,0                                               1197 04835000
         OI    SDGSARDY-5(@15),B'01000000'                         1197 04836000
*                             ELSE                                 1198 04837000
*                               SDGSAVAL(K)=BONE;/* ELSE IS SUU    1198 04838000
*                                                            @OZ30157*/ 04839000
         B     @RC01196                                            1198 04840000
@RF01196 LH    @04,K                                               1198 04841000
         MH    @04,@CH00038                                        1198 04842000
         L     @15,TABPTR                                          1198 04843000
         ALR   @15,@04                                             1198 04844000
         BCTR  @15,0                                               1198 04845000
         OI    SDGSAVAL-5(@15),B'00010000'                         1198 04846000
*                           END;    /* SA FLAGS SET          @OZ30157*/ 04847000
@RC01196 DS    0H                                                  1200 04848000
*                       END;        /* END SA PRESENT        @OZ30157*/ 04849000
@RF01187 DS    0H                                                  1201 04850000
*                   END;            /* END SA LOOP           @OZ30157*/ 04851000
@RF01172 LA    @04,1                                               1201 04852000
         AH    @04,K                                               1201 04853000
         STH   @04,K                                               1201 04854000
         CH    @04,@CH00056                                        1201 04855000
         BNH   @DL01161                                            1201 04856000
*                 END;              /* END SDG LOOP          @OZ30157*/ 04857000
         L     @04,TABPTR                                          1202 04858000
         AL    @04,SDGLEN                                          1202 04859000
@DE01160 ST    @04,TABPTR                                          1202 04860000
         C     @04,SDGEND                                          1202 04861000
         BNH   @DL01160                                            1202 04862000
*             END;                  /* END DRC LOOP          @OZ30157*/ 04863000
@RF01159 LA    @04,1                                               1203 04864000
         AH    @04,I                                               1203 04865000
         STH   @04,I                                               1203 04866000
         CH    @04,@CH00045                                        1203 04867000
         BNH   @DL01157                                            1203 04868000
*           END;                    /* END SCAN DRCS         @OZ30157*/ 04869000
         LA    @04,1                                               1204 04870000
         AH    @04,J                                               1204 04871000
         STH   @04,J                                               1204 04872000
         CH    @04,@CH00056                                        1204 04873000
         BNH   @DL01156                                            1204 04874000
*         END;                      /* END GOOD RET CODE     @OZ30157*/ 04875000
*       IF RETC=F0 THEN             /* IF GOOD SO FAR        @OZ30157*/ 04876000
@RF01154 SLR   @04,@04                                             1206 04877000
         CH    @04,RETC                                            1206 04878000
         BNE   @RF01206                                            1206 04879000
*         DO;                       /* THEN CONTINUE         @OZ30157*/ 04880000
*           DRCPTR=TABPTR;          /* START OF DRC TABLE    @OZ30157*/ 04881000
         L     @00,TABPTR                                          1208 04882000
         ST    @00,DRCPTR                                          1208 04883000
*           TABPTR2=DRCPTR;         /* SET DRC TABLE ENT PTR @OZ30157*/ 04884000
         ST    @00,TABPTR2                                         1209 04885000
*           I=F1;                   /* SET DEFAULT DRC START @OZ30157*/ 04886000
         MVC   I(2),@CH00047                                       1210 04887000
*           I2=F4;                  /* AND STOP POINTS       @OZ30157*/ 04888000
         MVC   I2(2),@CH00045                                      1211 04889000
*           IF DSPQUAL=BONE&DSPDRC=BONE THEN/* IF OP IS DRCNN      1212 04890000
*                                                            @OZ30157*/ 04891000
         L     @15,@CA00041                                        1212 04892000
         L     @15,CWBPTR-CWBPTR(,@15)                             1212 04893000
         TM    DSPQUAL(@15),B'10100000'                            1212 04894000
         BNO   @RF01212                                            1212 04895000
*             DO;                   /* THEN GET QUALIFIER    @OZ30157*/ 04896000
*               QUALLEN(1)=F2;      /* SET FOR ONE TWO BYTE  @OZ30157*/ 04897000
         MVC   QUALLEN(2),@CH00056                                 1214 04898000
*               QUALLEN(2)=F0;      /* QUALIFIER AND GET     @OZ30157*/ 04899000
         STH   @04,QUALLEN+2                                       1215 04900000
*               CALL MSG56QU;       /* VALUE IN QUAL(1)      @OZ30157*/ 04901000
         BAL   @14,MSG56QU                                         1216 04902000
*               IF RETC=F0 THEN     /* IF GOT GOOD ONE       @OZ30157*/ 04903000
         LH    @04,RETC                                            1217 04904000
         LTR   @04,@04                                             1217 04905000
         BNZ   @RF01217                                            1217 04906000
*                 DO;               /* THEN SET IT UP        @OZ30157*/ 04907000
*                   PACK(CPXCPU,QUAL(1,1:2));/* PACK IT AND  @OZ30157*/ 04908000
         PACK  CPXCPU(5),QUAL(2)                                   1219 04909000
*                   CVB(I,CPXCPU);  /* PUT IN BINARY FORM    @OZ30157*/ 04910000
         XC    @TS00001(8),@TS00001                                1220 04911000
         MVC   @TS00001+3(5),CPXCPU                                1220 04912000
         CVB   @04,@TS00001                                        1220 04913000
         STH   @04,I                                               1220 04914000
*                   I=I+1;          /* PLUS ONE FOR INDEX    @OZ30157*/ 04915000
         AL    @04,@CF00047                                        1221 04916000
         STH   @04,I                                               1221 04917000
*                   I2=I;           /* PUT IN END CNTRL ALSO @OZ30157*/ 04918000
         STH   @04,I2                                              1222 04919000
*                 END;              /* END GOOD QUAL         @OZ30157*/ 04920000
*             END;                  /* END GET QUALIFIER     @OZ30157*/ 04921000
@RF01217 DS    0H                                                  1225 04922000
*         END;                      /* END GOOD RETC         @OZ30157*/ 04923000
@RF01212 DS    0H                                                  1226 04924000
*       ENDSW=BZERO;                /* TEST SWITCH           @OZ30157*/ 04925000
@RF01206 NI    ENDSW,B'11111011'                                   1226 04926000
*       IF RETC=F0 THEN             /* IF GOOD SO FAR        @OZ30157*/ 04927000
         LH    @04,RETC                                            1227 04928000
         LTR   @04,@04                                             1227 04929000
         BNZ   @RF01227                                            1227 04930000
*         DO;                       /* THEN KEEP ON          @OZ30157*/ 04931000
*           DO J=1 TO 2;            /* NOW THROUGH 2 CSFS    @OZ30157*/ 04932000
         LA    @04,1                                               1229 04933000
         STH   @04,J                                               1229 04934000
@DL01229 DS    0H                                                  1230 04935000
*             DO I=I TO I2;         /* DO UP TO 4 DRCS EACH  @OZ30157*/ 04936000
         LH    @04,I                                               1230 04937000
         B     @DE01230                                            1230 04938000
@DL01230 DS    0H                                                  1231 04939000
*               PWCS7X=QAPTR(J+2);  /* POINT TO SECT7.CSF    @OZ30157*/ 04940000
         LH    @15,J                                               1231 04941000
         SLA   @15,2                                               1231 04942000
         L     @00,QAPTR+4(@15)                                    1231 04943000
         ST    @00,PWCS7X                                          1231 04944000
*               IF(DRCXST&CONFGMSK(I))^=HEX00 THEN/* IF EXISTS     1232 04945000
*                                                            @OZ30157*/ 04946000
         L     @15,@CA01293                                        1232 04947000
         L     @15,MSGPTR-MSGPTR(,@15)                             1232 04948000
         L     @14,@CA01312                                        1232 04949000
         MVC   @TS00001(1),DRCXST+2(@15)                           1232 04950000
         ALR   @14,@04                                             1232 04951000
         BCTR  @14,0                                               1232 04952000
         NC    @TS00001(1),CONFGMSK-CONFGMSK(@14)                  1232 04953000
         CLI   @TS00001,X'00'                                      1232 04954000
         BE    @RF01232                                            1232 04955000
*                 DO K=1 TO 16;     /* THEN LOOP ALL SAS     @OZ30157*/ 04956000
         LA    @04,1                                               1233 04957000
         STH   @04,K                                               1233 04958000
@DL01233 DS    0H                                                  1234 04959000
*                   R1=TESTVAL;     /* SET INITIAL BIT       @OZ30157*/ 04960000
         L     R1,TESTVAL                                          1234 04961000
*                   PUNIT=K-1;      /* CALC SHIFT VALUE      @OZ30157*/ 04962000
         BCTR  @04,0                                               1235 04963000
         ST    @04,PUNIT                                           1235 04964000
*                   SRL(R1,PUNIT);  /* FIND BIT TO CHECK     @OZ30157*/ 04965000
         SRL   R1,0(@04)                                           1236 04966000
*                   PUNIT=R1;       /* PUT INTO PUNIT        @OZ30157*/ 04967000
         ST    R1,PUNIT                                            1237 04968000
*                   SATST=DRCCON(I)&PUNIT;/* CHECK CONNECT   @OZ30157*/ 04969000
         L     @04,PUNIT                                           1238 04970000
         LH    @15,I                                               1238 04971000
         SLA   @15,2                                               1238 04972000
         L     @14,PWCS7X                                          1238 04973000
         ALR   @14,@15                                             1238 04974000
         AL    @14,@CF03609                                        1238 04975000
         MVC   @ZT00002+2(2),DRCCON(@14)                           1238 04976000
         N     @04,@ZT00002                                        1238 04977000
         STH   @04,SATST                                           1238 04978000
*                   IF SATST^=F0 THEN/* IF CONNECTION, THEN  @OZ30157*/ 04979000
         LTR   @04,@04                                             1239 04980000
         BZ    @RF01239                                            1239 04981000
*                     DO;           /* BUILD ENTRIES         @OZ30157*/ 04982000
*                       IF ENDSW=BONE THEN/* IF NOT FIRST,   @OZ30157*/ 04983000
         TM    ENDSW,B'00000100'                                   1241 04984000
         BNO   @RF01241                                            1241 04985000
*                         CHNADR=TABPTR2;/* CHAIN TO PREV    @OZ30157*/ 04986000
         L     @04,LVUPTR                                          1242 04987000
         MVC   CHNADR(3,@04),TABPTR2+1                             1242 04988000
*                       ENDSW=BONE; /* SET FOUND DRC SW      @OZ30157*/ 04989000
@RF01241 OI    ENDSW,B'00000100'                                   1243 04990000
*                       DRCTAB=''B; /* CLEAR THE ENTRY FIRST @OZ30157*/ 04991000
         L     @04,TABPTR2                                         1244 04992000
         XC    DRCTAB(30,@04),DRCTAB(@04)                          1244 04993000
*                       DRCSANO=K-1;/* SET SA NUMBER         @OZ30157*/ 04994000
         LH    @15,K                                               1245 04995000
         LR    @00,@15                                             1245 04996000
         BCTR  @00,0                                               1245 04997000
         STC   @00,DRCSANO(,@04)                                   1245 04998000
*                       DRCCSNO=J-1;/* AND CSF NUMBER        @OZ30157*/ 04999000
         LH    @14,J                                               1246 05000000
         LR    @00,@14                                             1246 05001000
         BCTR  @00,0                                               1246 05002000
         STC   @00,DRCCSNO(,@04)                                   1246 05003000
*                       DRCSAID='800';/* ALSO SET INTO THE   @OZ30157*/ 05004000
         MVC   DRCSAID(3,@04),@CC01468                             1247 05005000
*                       DRCSAID2=NUMBRS(K);/* SA NUMBER      @OZ30157*/ 05006000
         LA    @03,NUMBRS-1(@15)                                   1248 05007000
         MVC   DRCSAID2(1,@04),0(@03)                              1248 05008000
*                       DRCDRNO=I-1;/* DRC NUMBER            @OZ30157*/ 05009000
         LH    @15,I                                               1249 05010000
         LR    @00,@15                                             1249 05011000
         BCTR  @00,0                                               1249 05012000
         STC   @00,DRCDRNO(,@04)                                   1249 05013000
*                       DRCDRSS='400';/* BUILD THE           @OZ30157*/ 05014000
         MVC   DRCDRSS(3,@04),@CC01484                             1250 05015000
*                       DRCDRSS2=NUMBRS(J);/* CSF AND DRC INTO     1251 05016000
*                                                            @OZ30157*/ 05017000
         LA    @03,NUMBRS-1(@14)                                   1251 05018000
         MVC   DRCDRSS2(1,@04),0(@03)                              1251 05019000
*                       DRCDRSS3=NUMBRS(I);/* SSID FIELD     @OZ30157*/ 05020000
         LA    @14,NUMBRS-1(@15)                                   1252 05021000
         MVC   DRCDRSS3(1,@04),0(@14)                              1252 05022000
*                       DRCEND=TABPTR2;/* SAVE LAST ENTRY ADDR     1253 05023000
*                                                            @OZ30157*/ 05024000
         ST    @04,DRCEND                                          1253 05025000
*                       LVUPTR=ADDR(DRCCHN);/* SET FOR CHAIN @OZ30157*/ 05026000
         ST    @04,LVUPTR                                          1254 05027000
*                       TABPTR2=TABPTR2+DRCLEN;/*            @OZ30157*/ 05028000
         AL    @04,DRCLEN                                          1255 05029000
         ST    @04,TABPTR2                                         1255 05030000
*                     END;          /* END BUILD ONE ENTRY   @OZ30157*/ 05031000
*                 END;              /* END SA LOOP           @OZ30157*/ 05032000
@RF01239 LA    @04,1                                               1257 05033000
         AH    @04,K                                               1257 05034000
         STH   @04,K                                               1257 05035000
         CH    @04,@CH01227                                        1257 05036000
         BNH   @DL01233                                            1257 05037000
*             END;                  /* END DRC LOOP          @OZ30157*/ 05038000
@RF01232 LA    @04,1                                               1258 05039000
         AH    @04,I                                               1258 05040000
         STH   @04,I                                               1258 05041000
@DE01230 CH    @04,I2                                              1258 05042000
         BNH   @DL01230                                            1258 05043000
*           END;                    /* END CSF LOOP          @OZ30157*/ 05044000
         LA    @04,1                                               1259 05045000
         AH    @04,J                                               1259 05046000
         STH   @04,J                                               1259 05047000
         CH    @04,@CH00056                                        1259 05048000
         BNH   @DL01229                                            1259 05049000
*           IF ENDSW=BZERO THEN     /* IF DRC NOT FOUND      @OZ30157*/ 05050000
         TM    ENDSW,B'00000100'                                   1260 05051000
         BNZ   @RF01260                                            1260 05052000
*             RETC=F1;              /* THEN SAY SO           @OZ30157*/ 05053000
         MVC   RETC(2),@CH00047                                    1261 05054000
*         END;                      /* END GOOD RETC         @OZ30157*/ 05055000
@RF01260 DS    0H                                                  1263 05056000
*       IF RETC=F0 THEN             /* IF GOOD SO FAR        @OZ30157*/ 05057000
@RF01227 LH    @04,RETC                                            1263 05058000
         LTR   @04,@04                                             1263 05059000
         BNZ   @RF01263                                            1263 05060000
*         DO TABPTR2=DRCPTR TO DRCEND BY DRCLEN;/* INTO ALL  @OZ30157*/ 05061000
*                                                                  1264 05062000
         L     @04,DRCPTR                                          1264 05063000
         B     @DE01264                                            1264 05064000
@DL01264 DS    0H                                                  1265 05065000
*           /*********************************************************/ 05066000
*           /*                                                       */ 05067000
*           /* USE SA AND DRC NUMBERS AS INDICES, GET        @OZ30157*/ 05068000
*           /* STATUS OF SA AND PATHS TO DRDS                @OZ30157*/ 05069000
*           /*                                                       */ 05070000
*           /*********************************************************/ 05071000
*                                                                  1265 05072000
*           J=DRCSANO//4+1;         /* CALC INDICES          @OZ30157*/ 05073000
         SLR   @15,@15                                             1265 05074000
         IC    @15,DRCSANO(,@04)                                   1265 05075000
         LR    @02,@15                                             1265 05076000
         SRDA  @02,32                                              1265 05077000
         D     @02,@CF00045                                        1265 05078000
         AL    @02,@CF00047                                        1265 05079000
         STH   @02,J                                               1265 05080000
*           PWCS7X=QAPTR(DRCSANO/4+3);/* SECTOR ADDRESS      @OZ30157*/ 05081000
         SRL   @15,2                                               1266 05082000
         SLA   @15,2                                               1266 05083000
         L     @00,QAPTR+8(@15)                                    1266 05084000
         ST    @00,PWCS7X                                          1266 05085000
*           DRCSAST=''B;            /* FIRST CLEAR FLAGS     @OZ30157*/ 05086000
         MVI   DRCSAST(@04),X'00'                                  1267 05087000
*           IF SAFONL(J)=BZERO THEN /* IF OFFLINE            @OZ30157*/ 05088000
         SLA   @02,2                                               1268 05089000
         LR    @03,@00                                             1268 05090000
         ALR   @03,@02                                             1268 05091000
         TM    SAFONL-4(@03),B'01000000'                           1268 05092000
         BNZ   @RF01268                                            1268 05093000
*             DRCSAOF=BONE;         /* SAY SO                @OZ30157*/ 05094000
         OI    DRCSAOF(@04),B'10000000'                            1269 05095000
*           IF SAFRDY(J)=BONE THEN  /* IF READY              @OZ30157*/ 05096000
@RF01268 LH    @04,J                                               1270 05097000
         SLA   @04,2                                               1270 05098000
         L     @15,PWCS7X                                          1270 05099000
         ALR   @15,@04                                             1270 05100000
         TM    SAFRDY-4(@15),B'00100000'                           1270 05101000
         BNO   @RF01270                                            1270 05102000
*             DRCSARDY=BONE;        /* SAY THAT TOO          @OZ30157*/ 05103000
         L     @04,TABPTR2                                         1271 05104000
         OI    DRCSARDY(@04),B'01000000'                           1271 05105000
*           ELSE                                                   1272 05106000
*             DRCSAVAL=BONE;        /* SUU IS VALID          @OZ30157*/ 05107000
         B     @RC01270                                            1272 05108000
@RF01270 L     @04,TABPTR2                                         1272 05109000
         OI    DRCSAVAL(@04),B'00010000'                           1272 05110000
*           IF(DRCSAOF=BONE)&(DSPOFF=BONE) THEN/*            @OZ30157*/ 05111000
@RC01270 L     @04,TABPTR2                                         1273 05112000
         TM    DRCSAOF(@04),B'10000000'                            1273 05113000
         BNO   @RF01273                                            1273 05114000
         L     @15,@CA00041                                        1273 05115000
         L     @15,CWBPTR-CWBPTR(,@15)                             1273 05116000
         TM    DSPOFF(@15),B'00100000'                             1273 05117000
         BNO   @RF01273                                            1273 05118000
*             DRCSAVAL=BONE;        /* VALID FOR DISPLAY     @OZ30157*/ 05119000
         OI    DRCSAVAL(@04),B'00010000'                           1274 05120000
*           IF(DRCSAOF=BZERO)&(DSPON=BONE) THEN/*            @OZ30157*/ 05121000
@RF01273 L     @04,TABPTR2                                         1275 05122000
         TM    DRCSAOF(@04),B'10000000'                            1275 05123000
         BNZ   @RF01275                                            1275 05124000
         L     @15,@CA00041                                        1275 05125000
         L     @15,CWBPTR-CWBPTR(,@15)                             1275 05126000
         TM    DSPON(@15),B'01000000'                              1275 05127000
         BNO   @RF01275                                            1275 05128000
*             DRCSAVAL=BONE;        /* VALID FOR DISPLAY     @OZ30157*/ 05129000
         OI    DRCSAVAL(@04),B'00010000'                           1276 05130000
*           PWCS7X=QAPTR(DRCCSNO+3);/* SET SECTOR ADDRESS    @OZ30157*/ 05131000
@RF01275 L     @04,TABPTR2                                         1277 05132000
         SLR   @15,@15                                             1277 05133000
         IC    @15,DRCCSNO(,@04)                                   1277 05134000
         LR    @14,@15                                             1277 05135000
         SLA   @14,2                                               1277 05136000
         L     @00,QAPTR+8(@14)                                    1277 05137000
         ST    @00,PWCS7X                                          1277 05138000
*           K1=DRCDRNO+1;           /* DRC UCB INDEX         @OZ30157*/ 05139000
         SLR   @00,@00                                             1278 05140000
         IC    @00,DRCDRNO(,@04)                                   1278 05141000
         AL    @00,@CF00047                                        1278 05142000
         STH   @00,K1                                              1278 05143000
*           IF CONFGMSK(DRCCSNO+1)=(DRCRDY(K1)&CONFGMSK(DRCCSNO+1))     05144000
*             THEN                                                 1279 05145000
         L     @14,@CA01312                                        1279 05146000
         L     @03,@CA01293                                        1279 05147000
         L     @03,MSGPTR-MSGPTR(,@03)                             1279 05148000
         ALR   @03,@00                                             1279 05149000
         MVC   @TS00001(1),DRCRDY+1(@03)                           1279 05150000
         ST    @15,@TF00001                                        1279 05151000
         ALR   @15,@14                                             1279 05152000
         NC    @TS00001(1),CONFGMSK-CONFGMSK(@15)                  1279 05153000
         AL    @14,@TF00001                                        1279 05154000
         CLC   CONFGMSK-CONFGMSK(1,@14),@TS00001                   1279 05155000
         BNE   @RF01279                                            1279 05156000
*             DRCDCRDY=BONE;        /* SAY SO                @OZ30157*/ 05157000
         OI    DRCDCRDY(@04),B'00000100'                           1280 05158000
*           IF CONFGMSK(DRCCSNO+1)^=(DRCON(K1)&CONFGMSK(DRCCSNO+1))     05159000
*             THEN                                                 1281 05160000
@RF01279 L     @04,TABPTR2                                         1281 05161000
         SLR   @15,@15                                             1281 05162000
         IC    @15,DRCCSNO(,@04)                                   1281 05163000
         L     @14,@CA01312                                        1281 05164000
         LH    @03,K1                                              1281 05165000
         L     @02,@CA01293                                        1281 05166000
         L     @02,MSGPTR-MSGPTR(,@02)                             1281 05167000
         ALR   @02,@03                                             1281 05168000
         MVC   @TS00001(1),DRCON+1(@02)                            1281 05169000
         ST    @15,@TF00001                                        1281 05170000
         ALR   @15,@14                                             1281 05171000
         NC    @TS00001(1),CONFGMSK-CONFGMSK(@15)                  1281 05172000
         AL    @14,@TF00001                                        1281 05173000
         CLC   CONFGMSK-CONFGMSK(1,@14),@TS00001                   1281 05174000
         BE    @RF01281                                            1281 05175000
*             DRCDCOF=BONE;         /* SET OFFLINE FLAG      @OZ30157*/ 05176000
         OI    DRCDCOF(@04),B'00001000'                            1282 05177000
*           ELSE                    /* IF ONLINE,            @OZ30157*/ 05178000
*             IF(DRCSAOF=BONE)|(DRCSARDY=BZERO) THEN               1283 05179000
*                                                                  1283 05180000
         B     @RC01281                                            1283 05181000
@RF01281 L     @04,TABPTR2                                         1283 05182000
         TM    DRCSAOF(@04),B'10000000'                            1283 05183000
         BNZ   @RT01283                                            1283 05184000
         TM    DRCSARDY(@04),B'01000000'                           1283 05185000
         BO    @RF01283                                            1283 05186000
@RT01283 DS    0H                                                  1284 05187000
*               /*****************************************************/ 05188000
*               /*                                                   */ 05189000
*               /* IF SA NOT ON & RDY                        @OZ30157*/ 05190000
*               /*                                                   */ 05191000
*               /*****************************************************/ 05192000
*                                                                  1284 05193000
*               DRCDCNA=BONE;       /* THEN DRC UNAVAIL.     @OZ30157*/ 05194000
         L     @04,TABPTR2                                         1284 05195000
         OI    DRCDCNA(@04),B'00000010'                            1284 05196000
*           PTHPTR=ADDR(DRCUCB(K1));/* POINT TO DRC PATHS    @OZ30157*/ 05197000
@RF01283 DS    0H                                                  1285 05198000
@RC01281 LH    @04,K1                                              1285 05199000
         SLA   @04,2                                               1285 05200000
         L     @15,PWCS7X                                          1285 05201000
         LA    @04,DRCUCB-4(@04,@15)                               1285 05202000
         ST    @04,PTHPTR                                          1285 05203000
*           DO K=1 TO 4;            /* DO ALL 4 POSS DRDS    @OZ30157*/ 05204000
         LA    @04,1                                               1286 05205000
         STH   @04,K                                               1286 05206000
@DL01286 DS    0H                                                  1287 05207000
*             IF DRCCSNO=0 THEN     /* SET UP BASE FOR DRD   @OZ30157*/ 05208000
         L     @15,TABPTR2                                         1287 05209000
         CLI   DRCCSNO(@15),0                                      1287 05210000
         BNE   @RF01287                                            1287 05211000
*               DRCDRDAD(K)='20X';  /* SSID                  @OZ30157*/ 05212000
         SLA   @04,2                                               1288 05213000
         ALR   @15,@04                                             1288 05214000
         MVC   DRCDRDAD-4(3,@15),@CC03116                          1288 05215000
*             ELSE                                                 1289 05216000
*               DRCDRDAD(K)='21X';  /*                       @OZ30157*/ 05217000
         B     @RC01287                                            1289 05218000
@RF01287 LH    @04,K                                               1289 05219000
         SLA   @04,2                                               1289 05220000
         L     @15,TABPTR2                                         1289 05221000
         ALR   @15,@04                                             1289 05222000
         MVC   DRCDRDAD-4(3,@15),@CC03117                          1289 05223000
*             K2=DRCFLGS(K)&'0F'X;  /* INDEX TO PATH UCB     @OZ30157*/ 05224000
@RC01287 L     @04,PTHPTR                                          1290 05225000
         LH    @15,K                                               1290 05226000
         LA    @00,15                                              1290 05227000
         ALR   @15,@04                                             1290 05228000
         BCTR  @15,0                                               1290 05229000
         MVC   @ZT00003+3(1),DRCFLGS(@15)                          1290 05230000
         N     @00,@ZT00003                                        1290 05231000
         STH   @00,K2                                              1290 05232000
*             DRCDRDAD(K,3:3)=NUMBRS(K2+1);/* DRD NUMBER AS CHAR   1291 05233000
*                                                            @OZ30157*/ 05234000
         L     @15,TABPTR2                                         1291 05235000
         LH    @14,K                                               1291 05236000
         LR    @03,@14                                             1291 05237000
         SLA   @03,2                                               1291 05238000
         ST    @03,@TF00001                                        1291 05239000
         ALR   @03,@15                                             1291 05240000
         LR    @02,@00                                             1291 05241000
         LA    @04,NUMBRS(@02)                                     1291 05242000
         MVC   DRCDRDAD-2(1,@03),0(@04)                            1291 05243000
*             DRCDRDST(K)=''B;      /* CLEAR STATUS          @OZ30157*/ 05244000
         LR    @04,@15                                             1292 05245000
         AL    @04,@TF00001                                        1292 05246000
         MVI   DRCDRDST-4(@04),X'00'                               1292 05247000
*             IF DRCFUSA(K)=BONE THEN/* SAME IF READY        @OZ30157*/ 05248000
         L     @04,PTHPTR                                          1293 05249000
         ALR   @04,@14                                             1293 05250000
         BCTR  @04,0                                               1293 05251000
         TM    DRCFUSA(@04),B'00100000'                            1293 05252000
         BNO   @RF01293                                            1293 05253000
*               DRCDRDRD(K)=BONE;   /* FLAG IT               @OZ30157*/ 05254000
         AL    @15,@TF00001                                        1294 05255000
         OI    DRCDRDRD-4(@15),B'01000000'                         1294 05256000
*             IF DRCFONL(K)=BZERO THEN/* IF PATH IS OFFLINE  @OZ30157*/ 05257000
@RF01293 LH    @04,K                                               1295 05258000
         L     @15,PTHPTR                                          1295 05259000
         ALR   @15,@04                                             1295 05260000
         BCTR  @15,0                                               1295 05261000
         TM    DRCFONL(@15),B'01000000'                            1295 05262000
         BNZ   @RF01295                                            1295 05263000
*               DRCDRDOF(K)=BONE;   /* SAY SO                @OZ30157*/ 05264000
         SLA   @04,2                                               1296 05265000
         L     @15,TABPTR2                                         1296 05266000
         ALR   @15,@04                                             1296 05267000
         OI    DRCDRDOF-4(@15),B'10000000'                         1296 05268000
*             ELSE                  /* IF ONLINE, THEN       @OZ30157*/ 05269000
*               IF DRCDCOF=BONE|DRCDCRDY=BZERO|DRCDCNA=BONE THEN   1297 05270000
         B     @RC01295                                            1297 05271000
@RF01295 L     @04,TABPTR2                                         1297 05272000
         TM    DRCDCOF(@04),B'00001010'                            1297 05273000
         BNZ   @RT01297                                            1297 05274000
         TM    DRCDCRDY(@04),B'00000100'                           1297 05275000
         BO    @RF01297                                            1297 05276000
@RT01297 DS    0H                                                  1298 05277000
*                 DRCDRDNA(K)=BONE; /* FLAG IF NOT AVAIL     @OZ30157*/ 05278000
         LH    @04,K                                               1298 05279000
         SLA   @04,2                                               1298 05280000
         L     @15,TABPTR2                                         1298 05281000
         ALR   @15,@04                                             1298 05282000
         OI    DRCDRDNA-4(@15),B'00100000'                         1298 05283000
*           END;                    /* END DRD LOOP          @OZ30157*/ 05284000
@RF01297 DS    0H                                                  1299 05285000
@RC01295 LA    @04,1                                               1299 05286000
         AH    @04,K                                               1299 05287000
         STH   @04,K                                               1299 05288000
         CH    @04,@CH00045                                        1299 05289000
         BNH   @DL01286                                            1299 05290000
*         END;                      /* END DRC LOOP          @OZ30157*/ 05291000
         L     @04,TABPTR2                                         1300 05292000
         AL    @04,DRCLEN                                          1300 05293000
@DE01264 ST    @04,TABPTR2                                         1300 05294000
         C     @04,DRCEND                                          1300 05295000
         BNH   @DL01264                                            1300 05296000
*     END;                          /* READY FOR SDG/DRC     @OZ30157*/ 05297000
@RF01263 DS    0H                                                  1302 05298000
*                                                                  1302 05299000
*   /*****************************************************************/ 05300000
*   /*                                                               */ 05301000
*   /* IF ANY VALID SDG ENTRIES, SET SWITCHES FOR DISPLAY    @OZ30157*/ 05302000
*   /* BY LATER CALL TO MSG56H                               @OZ30157*/ 05303000
*   /*                                                               */ 05304000
*   /*****************************************************************/ 05305000
*                                                                  1302 05306000
*   IF DSPSDG=BONE&RETC=F0 THEN     /* IF SDG DISPLAY REQUEST@OZ30157*/ 05307000
@RF01083 L     @04,@CA00041                                        1302 05308000
         L     @04,CWBPTR-CWBPTR(,@04)                             1302 05309000
         TM    DSPSDG(@04),B'00010000'                             1302 05310000
         BNO   @RF01302                                            1302 05311000
         LH    @04,RETC                                            1302 05312000
         LTR   @04,@04                                             1302 05313000
         BNZ   @RF01302                                            1302 05314000
*     DO;                           /* THEN DO IT            @OZ30157*/ 05315000
*       VALSSID=BONE;               /* SSID SWITCH AND       @OZ30157*/ 05316000
*       VALCODE=BONE;               /* VALCODE SWITCH        @OZ30157*/ 05317000
         OI    VALSSID,B'01001000'                                 1305 05318000
*     END;                          /* END SDG DISPLAY       @OZ30157*/ 05319000
*   IF DSPDRC=BONE THEN             /* IF DRC PATH REQUEST   @OZ30157*/ 05320000
@RF01302 L     @04,@CA00041                                        1307 05321000
         L     @04,CWBPTR-CWBPTR(,@04)                             1307 05322000
         TM    DSPDRC(@04),B'10000000'                             1307 05323000
         BNO   @RF01307                                            1307 05324000
*     IF RETC=F0 THEN               /* IF GOOD RUN           @OZ30157*/ 05325000
         LH    @04,RETC                                            1308 05326000
         LTR   @04,@04                                             1308 05327000
         BNZ   @RF01308                                            1308 05328000
*/********************************************************************/ 05329000
*/*                                                                  */ 05330000
*/*  SINCE THE TABLE IS ALREADY BUILT, IF RETURN CODE IS 0           */ 05331000
*/*     SETUP TO CALL MSG56I TO DO THE DISPLAY.              @OZ30157*/ 05332000
*/*                                                                  */ 05333000
*/********************************************************************/ 05334000
*                                                                  1309 05335000
*       DO;                         /* SET SWITCHES          @OZ30157*/ 05336000
*         VALSSID=BONE;             /* FOR VALID SSID        @OZ30157*/ 05337000
*         VALCODE=BONE;             /* AND VALID CODE        @OZ30157*/ 05338000
         OI    VALSSID,B'01001000'                                 1311 05339000
*       END;                        /* TO DO DISPLAY         @OZ30157*/ 05340000
*   RFY                                                            1313 05341000
*     R14 RSTD;                     /*                       @OZ30157*/ 05342000
@RF01308 DS    0H                                                  1313 05343000
@RF01307 DS    0H                                                  1314 05344000
*   R14=MS56PA14;                   /* RESTORE RETURN REG    @OZ30157*/ 05345000
         L     R14,MS56PA14                                        1314 05346000
*   RFY                                                            1315 05347000
*     R14 UNRSTD;                   /*                       @OZ30157*/ 05348000
*   RETURN;                         /*                       @OZ30157*/ 05349000
@EL00004 DS    0H                                                  1316 05350000
@EF00004 DS    0H                                                  1316 05351000
@ER00004 BR    @14                                                 1316 05352000
*   END MSG56PA;                    /* END PATHS ROUTINE     @OZ30157*/ 05353000
*MSG56QC:                                                          1318 05354000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @OZ30157*/ 05355000
MSG56QC  DS    0H                                                  1319 05356000
*/********************************************************** @OZ30157*/ 05357000
*/*                                                          @OZ30157*/ 05358000
*/* PROCEDURE NAME: MSG56QC                                  @OZ30157*/ 05359000
*/*                                                          @OZ30157*/ 05360000
*/* FUNCTION: DISPLAY ERROR QCB STATUS                       @OZ30157*/ 05361000
*/*                                                          @OZ30157*/ 05362000
*/* INPUTS: MSC SECTORS 6A, 6B, AND SQT TABLE RECORDS        @OZ30157*/ 05363000
*/*                                                          @OZ30157*/ 05364000
*/* OUTPUTS: WTO LINES WITH ERROR QCB STATUS                 @OZ30157*/ 05365000
*/*                                                          @OZ30157*/ 05366000
*/* CALLS: MSG56J - DISPLAY QCB STATUS                       @OZ30157*/ 05367000
*/*                                                          @OZ30157*/ 05368000
*/********************************************************** @OZ30157*/ 05369000
*                                                                  1319 05370000
*   DCL                                                            1319 05371000
*     MS56QC14 FIXED(31);           /* LOCAL RETURN REG SAVE @OZ30157*/ 05372000
*   DCL                                                            1320 05373000
*     QCBAR(64) CHAR(4) BASED(QAPTR(1));/* SECT 6A, 6B       @OZ30157*/ 05374000
*   DCL                                                            1321 05375000
*     QCBLST PTR(31);               /* PTR TO LAST QCB IN SEC@OZ30157*/ 05376000
*   DCL                                                            1322 05377000
*     QCBEPTR PTR(31);              /* PTR TO ERR QCB        @OZ30157*/ 05378000
*   DCL                                                            1323 05379000
*     MHPTR PTR(31);                /* PTR TO MINI-HEADER    @OZ30157*/ 05380000
*   DCL                                                            1324 05381000
*     MHSAPTR PTR(31);              /* PTR TO SA FIELD       @OZ30157*/ 05382000
*   DCL                                                            1325 05383000
*     QCBLEN FIXED(15) CONSTANT(4); /*                       @OZ30157*/ 05384000
*   DCL                                                            1326 05385000
*     1 QCB BASED(QCBPTR),          /* QCB FORMAT            @OZ30157*/ 05386000
*      2 QCBFLG1 BIT(8),            /*                       @OZ30157*/ 05387000
*       3 QCBEXC BIT(1),            /*                       @OZ30157*/ 05388000
*       3 QCBERR BIT(1),            /* THIS QCB IN ERROR     @OZ30157*/ 05389000
*       3 * BIT(1),                 /*                       @OZ30157*/ 05390000
*       3 QCBFMVTP BIT(5),          /*                       @OZ30157*/ 05391000
*      2 QCBMVTP FIXED(8),          /*                       @OZ30157*/ 05392000
*      2 QCBFLG2 BIT(8),            /*                       @OZ30157*/ 05393000
*       3 QCBDSQ0 BIT(1),           /* VALID ON DSQ          @OZ30157*/ 05394000
*       3 * BIT(3),                 /*                       @OZ30157*/ 05395000
*       3 QCBF2RS BIT(1),           /* RESTART INDICATOR     @OZ30157*/ 05396000
*       3 QCBCSEQ BIT(1),           /* CARTRIDGE SEQUENCE NUMBER   1326 05397000
*                                                            @OZ30157*/ 05398000
*       3 * BIT(2),                 /*                       @OZ30157*/ 05399000
*      2 QCBRCOD CHAR(1),           /* RESTART CODE          @OZ30157*/ 05400000
*       3 QCBRCE BIT(1),            /* RESTART BY CE         @OZ30157*/ 05401000
*       3 QCBRCC BIT(1),            /* RESTART COPY CART     @OZ30157*/ 05402000
*       3 QCBRMC BIT(1),            /* RESTART MAN CART ENT  @OZ30157*/ 05403000
*       3 QCBRDA BIT(1),            /* RESTART V DASD        @OZ30157*/ 05404000
*       3 QCBRSA BIT(1),            /* RESTART V SA          @OZ30157*/ 05405000
*       3 QCBRDC BIT(1),            /* RESTART V DRC         @OZ30157*/ 05406000
*       3 QCBRDD BIT(1),            /* RESTART V DRD         @OZ30157*/ 05407000
*       3 QCBRCS BIT(1);            /* RESTART V CSF         @OZ30157*/ 05408000
*   DCL                                                            1327 05409000
*     QCBRCODP CHAR(2) DEF(QCBRCOD);/* REDEF FOR UNPACK      @OZ30157*/ 05410000
*   DCL                                                            1328 05411000
*     1 QCBEXT BASED(QCBEPTR),      /* QCB EXTENSION         @OZ30157*/ 05412000
*       3 QCBXXXX BIT(1);           /*                       @OZ30157*/ 05413000
*   DCL                                                            1329 05414000
*     1 SQTENT BASED(QAPTR(2)),     /* SCHEDULER QUEUE BLOCK @OZ30157*/ 05415000
*      2 SQTBFLG BIT(8),            /* BLOCK FLAG            @OZ30157*/ 05416000
*       3 * BIT(5),                 /* NOT USED HERE         @OZ30157*/ 05417000
*       3 SQTBFSA2 BIT(1),          /* USE SA 2 FOR DRD      @OZ30157*/ 05418000
*       3 * BIT(2),                 /* NOT USED HERE         @OZ30157*/ 05419000
*      2 SQTMHPTR FIXED(8),         /* CURRENT MINI-HDR PTR  @OZ30157*/ 05420000
*      2 SQTBFLG1 BIT(8),           /* FLAGS AND CSID        @OZ30157*/ 05421000
*      2 SQTBFLG2 BIT(8),           /* FLAG OR SDG INDEX     @OZ30157*/ 05422000
*       3 SQT2RCL BIT(1),           /* READ CART LABEL       @OZ30157*/ 05423000
*       3 * BIT(2),                 /* NOT USED              @OZ30157*/ 05424000
*       3 SQTSDG BIT(5),            /* SDG INDEX             @OZ30157*/ 05425000
*      2 SQTSA1 CHAR(1),            /* ACCESS TO SA 1        @OZ30157*/ 05426000
*      2 SQTSA2 CHAR(1),            /* ACCESS TO SA 2        @OZ30157*/ 05427000
*      2 SQTVVA(2) FIXED(8),        /* VVAS 1 AND 2          @OZ30157*/ 05428000
*      2 SQTQCB(6) BIT(8),          /* QCB FLAGS             @OZ30157*/ 05429000
*      2 SQTDRDAD FIXED(8),         /* LOGICAL DRD ADDRESS   @OZ30157*/ 05430000
*      2 SQTQCBPT FIXED(8),         /* QCB POINTER           @OZ30157*/ 05431000
*      2 SQTCVOL CHAR(6),           /* CARTRIDGE VOLID       @OZ30157*/ 05432000
*      2 SQTLZYX CHAR(2),           /* LZYX                  @OZ30157*/ 05433000
*       3 SQLZYXC1 CHAR(1),         /* FIRST CHARACTER       @OZ30157*/ 05434000
*       3 SQLZYXC2 CHAR(1),         /* SECOND CHARACTER      @OZ30157*/ 05435000
*      2 SQTNU CHAR(8),             /* NOT USED HERE         @OZ30157*/ 05436000
*      2 SQTMHDRS CHAR(224);        /* MINI-HEADERS          @OZ30157*/ 05437000
*   DCL                                                            1330 05438000
*     1 MHDR BASED(MHPTR),          /* MINI-HEADER MAP       @OZ30157*/ 05439000
*      2 MHSEQ FIXED(8),            /* SEQUENCE              @OZ30157*/ 05440000
*      2 MHF1 BIT(8),               /* FLAGS                 @OZ30157*/ 05441000
*       3 MHF1B0 BIT(1),            /* STAGING OR NOT        @OZ30157*/ 05442000
*       3 MHF1B1 BIT(1),            /* SA TYPE OR NOT        @OZ30157*/ 05443000
*       3 * BIT(4),                 /* NOT USED HERE         @OZ30157*/ 05444000
*       3 MHF1B6 BIT(1),            /* IORB TYPE             @OZ30157*/ 05445000
*       3 MHF1B7 BIT(1),            /* IORB TYPE             @OZ30157*/ 05446000
*      2 * CHAR(6),                 /* NOT USED HERE         @OZ30157*/ 05447000
*      2 MHIOLUA CHAR(1),           /* LUA IF IORB TYPE      @OZ30157*/ 05448000
*      2 * CHAR(5),                 /* NOT USED HERE         @OZ30157*/ 05449000
*      2 MHPLNDX FIXED(8);          /* ACTIVE PAGE LIST INDEX@OZ30157*/ 05450000
*   DCL                                                            1331 05451000
*     MHSALUA CHAR(1) BASED(MHSAPTR);/* PAGE LIST            @OZ30157*/ 05452000
*/********************************************************************/ 05453000
*/*                                                                  */ 05454000
*/* INTERNAL VARIABLES, CONSTANTS, AND WORK AREAS            @OZ30157*/ 05455000
*/*                                                                  */ 05456000
*/********************************************************************/ 05457000
*                                                                  1332 05458000
*   DCL                                                            1332 05459000
*     1 LZYXCALC BDY(WORD),         /* LZYX CALC AREA        @OZ30157*/ 05460000
*      2 LCALC FIXED(15),           /* SAVE L VALUE          @OZ30157*/ 05461000
*       3 LCALCC CHAR(2),           /* REDEF IN CHARACTER    @OZ30157*/ 05462000
*        4 * CHAR(1),               /* NOT USED BY NAME      @OZ30157*/ 05463000
*        4 LCALCC2 CHAR(1),         /* REDEF LOW ORDER BYTE  @OZ30157*/ 05464000
*         5 * BIT(7),               /* NOT USED              @OZ30157*/ 05465000
*         5 LCALCB7 BIT(1),         /* BIT 7 OF SDG          @OZ30157*/ 05466000
*      2 ZCALC FIXED(15),           /* Z CALC AREA           @OZ30157*/ 05467000
*       3 ZCALCC CHAR(2),           /*                       @OZ30157*/ 05468000
*        4 * CHAR(1),               /*                       @OZ30157*/ 05469000
*        4 ZCALCC2 CHAR(1),         /*                       @OZ30157*/ 05470000
*      2 YCALC FIXED(15),           /* SAVE Y VALUE          @OZ30157*/ 05471000
*       3 YCALCC CHAR(2),           /*                       @OZ30157*/ 05472000
*        4 * CHAR(1),               /*                       @OZ30157*/ 05473000
*        4 YCALCC2 CHAR(1),         /*                       @OZ30157*/ 05474000
*      2 XCALC FIXED(15),           /* SAVE X VALUE          @OZ30157*/ 05475000
*       3 XCALCC CHAR(2),           /* REDEF AS CHARACTERS   @OZ30157*/ 05476000
*        4 * CHAR(1),               /*                       @OZ30157*/ 05477000
*        4 XCALCC2 CHAR(1);         /* REDEF LOW ORDER       @OZ30157*/ 05478000
*   DCL                                                            1333 05479000
*     LZYXFX(4) FIXED(15) DEF(LZYXCALC) POS(1);/*            @OZ30157*/ 05480000
*   DCL                                                            1334 05481000
*     LZYXCP(4) CHAR(2);            /* PACKED VERSIONS       @OZ30157*/ 05482000
*   DCL                                                            1335 05483000
*     LZYXCU(4) CHAR(4);            /* UNPACKED VERSIONS     @OZ30157*/ 05484000
*   RFY                                                            1336 05485000
*     R14 RSTD;                     /*                       @OZ30157*/ 05486000
*   MS56QC14=R14;                   /* SAVE RETURN REG       @OZ30157*/ 05487000
         ST    R14,MS56QC14                                        1337 05488000
*   RFY                                                            1338 05489000
*     R14 UNRSTD;                   /*                       @OZ30157*/ 05490000
*   RETC=F0;                        /* SET RETURN CODE       @OZ30157*/ 05491000
         SLR   @04,@04                                             1339 05492000
         STH   @04,RETC                                            1339 05493000
*   QCTPTR=F0;                      /* CLEAR QCTPTR          @OZ30157*/ 05494000
         ST    @04,QCTPTR                                          1340 05495000
*   QCTEND=F0;                      /* AND QCTEND            @OZ30157*/ 05496000
         ST    @04,QCTEND                                          1341 05497000
*   R1=ADDR(QCTPTR);                /* POINT TO ADDRESS      @OZ30157*/ 05498000
         LA    R1,QCTPTR                                           1342 05499000
*   CALL MSG56F;                    /* GO GET STORAGE        @OZ30157*/ 05500000
         BAL   @14,MSG56F                                          1343 05501000
*   IF RETC=0 THEN                  /* IF GOOD GETMAIN       @OZ30157*/ 05502000
         LH    @04,RETC                                            1344 05503000
         LTR   @04,@04                                             1344 05504000
         BNZ   @RF01344                                            1344 05505000
*     DO;                           /* SAVE R1 IN CHAINADR   @OZ30157*/ 05506000
*       TABPTR=QCTPTR;              /* TABPTR TO START       @OZ30157*/ 05507000
         L     @04,QCTPTR                                          1346 05508000
         ST    @04,TABPTR                                          1346 05509000
*       QCTEND=TABPTR+1512;         /* RESET ENDPTR          @OZ30157*/ 05510000
         AH    @04,@CH03211                                        1347 05511000
         ST    @04,QCTEND                                          1347 05512000
*       VALSSID=BZERO;              /* INSURE VALSSID AND    @OZ30157*/ 05513000
*       ENDSW=BZERO;                /* ENDSW ARE OFF         @OZ30157*/ 05514000
         NI    VALSSID,B'10111011'                                 1349 05515000
*     END;                          /* END OF GETMAIN GOOD   @OZ30157*/ 05516000
*   DO I=1 TO 2 WHILE(RETC=F0);     /* AND GO TO IT          @OZ30157*/ 05517000
@RF01344 LA    @04,1                                               1351 05518000
         STH   @04,I                                               1351 05519000
@DL01351 LH    @00,RETC                                            1351 05520000
         LTR   @00,@00                                             1351 05521000
         BNZ   @DC01351                                            1351 05522000
*     QAPTR(1)=ADDR(QUBUF1);        /* FIRST QUERY ADDRESS   @OZ30157*/ 05523000
         LA    @00,44                                              1352 05524000
         AL    @00,WORKPTR                                         1352 05525000
         ST    @00,QAPTR                                           1352 05526000
*     QBCNT=F1;                     /* ONE QUERY FOR         @OZ30157*/ 05527000
         MVC   QBCNT(4),@CF00047                                   1353 05528000
*     QBENT(1)=QBW6A;               /* SECTOR 6A (FIRST PASS)@OZ30157*/ 05529000
         MVI   QBENT+12,C' '                                       1354 05530000
         MVC   QBENT+13(31),QBENT+12                               1354 05531000
         MVC   QBENT(12),QBW6A                                     1354 05532000
*     IF I=2 THEN                   /*                       @OZ30157*/ 05533000
         CH    @04,@CH00056                                        1355 05534000
         BNE   @RF01355                                            1355 05535000
*       QBSECT(1)='6B'X;            /* OR SECT 6B (SECOND)   @OZ30157*/ 05536000
         MVI   QBSECT,X'6B'                                        1356 05537000
*     CALL MSG56GQ;                 /* ISSUE QUERY           @OZ30157*/ 05538000
@RF01355 BAL   @14,MSG56GQ                                         1357 05539000
*     QCBPTR=ADDR(QCBAR(1));        /* SET QCB POINTER       @OZ30157*/ 05540000
         L     @04,QAPTR                                           1358 05541000
         ST    @04,QCBPTR                                          1358 05542000
*     QCBLST=ADDR(QCBAR(64));       /* SET LOOP END POINTER  @OZ30157*/ 05543000
         LA    @00,QCBAR+252(,@04)                                 1359 05544000
         ST    @00,QCBLST                                          1359 05545000
*     LVUPTR=ADDR(QCTCHAIN)-1;      /* DUMMY FIRST CHAIN     @OZ30157*/ 05546000
         L     @15,TABPTR                                          1360 05547000
         LA    @00,QCTCHAIN(,@15)                                  1360 05548000
         BCTR  @00,0                                               1360 05549000
         ST    @00,LVUPTR                                          1360 05550000
*     DO QCBPTR=QCBPTR TO QCBLST BY QCBLEN;/* QCB LOOP       @OZ30157*/ 05551000
         B     @DE01361                                            1361 05552000
@DL01361 DS    0H                                                  1362 05553000
*       IF QCBERR=BONE THEN         /* IF THIS ONE IN ERR    @OZ30157*/ 05554000
         TM    QCBERR(@04),B'01000000'                             1362 05555000
         BNO   @RF01362                                            1362 05556000
*         DO;                       /* EXTRACT IT            @OZ30157*/ 05557000
*                                                                  1363 05558000
*           /*********************************************************/ 05559000
*           /*                                                       */ 05560000
*           /* BUILD QTAB ENTRY                              @OZ30157*/ 05561000
*           /*                                                       */ 05562000
*           /*********************************************************/ 05563000
*                                                                  1364 05564000
*           IF ENDSW=BONE THEN      /* IF NOT FIRST, CHAIN   @OZ30157*/ 05565000
         TM    ENDSW,B'00000100'                                   1364 05566000
         BNO   @RF01364                                            1364 05567000
*             CHNADR=TABPTR;        /* TO PREVIOUS ENTRY     @OZ30157*/ 05568000
         L     @04,LVUPTR                                          1365 05569000
         MVC   CHNADR(3,@04),TABPTR+1                              1365 05570000
*           ENDSW=BONE;             /* SAY ONE FOUND         @OZ30157*/ 05571000
@RF01364 OI    ENDSW,B'00000100'                                   1366 05572000
*           IF TABPTR>QCTEND THEN   /* OOPS, NEED MORE       @OZ30157*/ 05573000
         CLC   TABPTR(4),QCTEND                                    1367 05574000
         BNH   @RF01367                                            1367 05575000
*             DO;                   /* GET SOME              @OZ30157*/ 05576000
*               CHAIN=F0;           /* INSURE ZERO ADDRESS   @OZ30157*/ 05577000
         L     @04,LVUPTR                                          1369 05578000
         SLR   @00,@00                                             1369 05579000
         ST    @00,CHAIN(,@04)                                     1369 05580000
*               R1=LVUPTR;          /* POINT TO ADDRESS      @OZ30157*/ 05581000
         LR    R1,@04                                              1370 05582000
*               CALL MSG56F;        /* GO GET STORAGE        @OZ30157*/ 05583000
         BAL   @14,MSG56F                                          1371 05584000
*               IF RETC=F0 THEN     /* IF GOOD GETMAIN       @OZ30157*/ 05585000
         LH    @04,RETC                                            1372 05586000
         LTR   @04,@04                                             1372 05587000
         BNZ   @RF01372                                            1372 05588000
*                 DO;               /* SAVE R1 IN CHAINADR   @OZ30157*/ 05589000
*                   QCTEND=TABPTR+1512;/* RESET ENDPTR       @OZ30157*/ 05590000
         LA    @04,1512                                            1374 05591000
         AL    @04,TABPTR                                          1374 05592000
         ST    @04,QCTEND                                          1374 05593000
*                 END;              /* END OF GETMAIN GOOD   @OZ30157*/ 05594000
*             END;                  /* END OF GETMAIN RTN    @OZ30157*/ 05595000
@RF01372 DS    0H                                                  1377 05596000
*/********************************************************************/ 05597000
*/*                                                                  */ 05598000
*/* GET SCHEDULE QUEUE BLOCK                                 @OZ30157*/ 05599000
*/*                                                                  */ 05600000
*/********************************************************************/ 05601000
*                                                                  1377 05602000
*           QCTENT=''B;             /* CLEAR THE ENTRY       @OZ30157*/ 05603000
@RF01367 L     @04,TABPTR                                          1377 05604000
         XC    QCTENT(24,@04),QCTENT(@04)                          1377 05605000
*           QCTNO=QCBPTR-QAPTR(1);  /* CALC QCB NUMBER       @OZ30157*/ 05606000
         L     @15,QCBPTR                                          1378 05607000
         LR    @00,@15                                             1378 05608000
         SL    @00,QAPTR                                           1378 05609000
         STC   @00,QCTNO(,@04)                                     1378 05610000
*           UNPK(QCTRCODU,QCBRCODP);/* RESTART CODE          @OZ30157*/ 05611000
         UNPK  QCTRCODU(3,@04),QCBRCODP(2,@15)                     1379 05612000
*           TR(QCTRCOD,TRANS);      /* TO PRINTABLE FORM     @OZ30157*/ 05613000
         TR    QCTRCOD(2,@04),TRANS                                1380 05614000
*           QCTCHAIN=F0;            /*                       @OZ30157*/ 05615000
         SLR   @15,@15                                             1381 05616000
         ST    @15,@TF00001                                        1381 05617000
         MVC   QCTCHAIN(3,@04),@TF00001+1                          1381 05618000
*           QBCNT=QBDSECNT;         /* DO ONE QUERY          @OZ30157*/ 05619000
         SLR   @04,@04                                             1382 05620000
         IC    @04,QBDSECNT                                        1382 05621000
         ST    @04,QBCNT                                           1382 05622000
*           QBENT(1)=QBDSQ;         /* SET QUERY PARMS       @OZ30157*/ 05623000
         MVI   QBENT+12,C' '                                       1383 05624000
         MVC   QBENT+13(31),QBENT+12                               1383 05625000
         MVC   QBENT(12),QBDSQ                                     1383 05626000
*           QBVAR2(1)=QCTNO;        /* SET QCB INDEX         @OZ30157*/ 05627000
         STC   @00,QBVAR2                                          1384 05628000
*           CALL MSG56GQ;           /* GO GET SQT ENTRY      @OZ30157*/ 05629000
         BAL   @14,MSG56GQ                                         1385 05630000
*           IF RETC=F0 THEN         /* IF GOOD RETURN CODE   @OZ30157*/ 05631000
         LH    @04,RETC                                            1386 05632000
         LTR   @04,@04                                             1386 05633000
         BNZ   @RF01386                                            1386 05634000
*             DO;                   /* THEN PROCESS IT       @OZ30157*/ 05635000
*               IF SQTCVOL^=NULLS&SQTCVOL^=BLKS THEN/*       @OZ30157*/ 05636000
         L     @04,QAPTR+4                                         1388 05637000
         CLC   SQTCVOL(6,@04),NULLS                                1388 05638000
         BE    @RF01388                                            1388 05639000
         CLC   SQTCVOL(6,@04),@CC01404                             1388 05640000
         BE    @RF01388                                            1388 05641000
*                 DO;               /*                       @OZ30157*/ 05642000
*/********************************************************************/ 05643000
*/*                                                                  */ 05644000
*/* TRANSLATE LZYX FIELD FOR PRINTING                        @OZ30157*/ 05645000
*/*                                                                  */ 05646000
*/********************************************************************/ 05647000
*                                                                  1390 05648000
*                   QCTCVOL=SQTCVOL;/* PUT IN VOLID          @OZ30157*/ 05649000
         L     @15,TABPTR                                          1390 05650000
         MVC   QCTCVOL(6,@15),SQTCVOL(@04)                         1390 05651000
*                   IF QCBCSEQ=BZERO THEN/* IF FIRST CARTR.  @OZ30157*/ 05652000
         L     @04,QCBPTR                                          1391 05653000
         TM    QCBCSEQ(@04),B'00000100'                            1391 05654000
         BNZ   @RF01391                                            1391 05655000
*                     QCTCSEQ='1';  /* SAY SO IN DSPLY       @OZ30157*/ 05656000
         MVI   QCTCSEQ(@15),C'1'                                   1392 05657000
*                   ELSE            /* ELSE IS               @OZ30157*/ 05658000
*                     QCTCSEQ='2';  /* SECOND ONE            @OZ30157*/ 05659000
         B     @RC01391                                            1393 05660000
@RF01391 L     @04,TABPTR                                          1393 05661000
         MVI   QCTCSEQ(@04),C'2'                                   1393 05662000
*                   DO I=1 TO 4;    /* CLEAR WORK AREAS      @OZ30157*/ 05663000
@RC01391 LA    @04,1                                               1394 05664000
         STH   @04,I                                               1394 05665000
@DL01394 DS    0H                                                  1395 05666000
*                     LZYXFX(I)=F0; /* TO ZERO VALUES        @OZ30157*/ 05667000
         LR    @15,@04                                             1395 05668000
         ALR   @15,@15                                             1395 05669000
         SLR   @00,@00                                             1395 05670000
         STH   @00,LZYXFX-2(@15)                                   1395 05671000
*                   END;            /*                       @OZ30157*/ 05672000
         AL    @04,@CF00047                                        1396 05673000
         STH   @04,I                                               1396 05674000
         CH    @04,@CH00045                                        1396 05675000
         BNH   @DL01394                                            1396 05676000
*                   LCALCC2=SQLZYXC1&'C0'X;/* GET L VALUE    @OZ30157*/ 05677000
         L     @04,QAPTR+4                                         1397 05678000
         MVC   LCALCC2(1),SQLZYXC1(@04)                            1397 05679000
         NI    LCALCC2,X'C0'                                       1397 05680000
*                   XCALCC2=SQLZYXC2;/* X VALUE              @OZ30157*/ 05681000
         MVC   XCALCC2(1),SQLZYXC2(@04)                            1398 05682000
*                   YCALCC2=SQLZYXC1&'1F'X;/* Y VALUE        @OZ30157*/ 05683000
         MVC   YCALCC2(1),SQLZYXC1(@04)                            1399 05684000
         NI    YCALCC2,X'1F'                                       1399 05685000
*                   ZCALCC2=SQLZYXC1&'20'X;/* Z VALUE        @OZ30157*/ 05686000
         MVC   ZCALCC2(1),SQLZYXC1(@04)                            1400 05687000
         NI    ZCALCC2,X'20'                                       1400 05688000
*                   LCALC=LCALC/64; /* SHIFT TO LOW ORDER    @OZ30157*/ 05689000
         LH    @02,LCALC                                           1401 05690000
         SRDA  @02,32                                              1401 05691000
         D     @02,@CF01346                                        1401 05692000
         STH   @03,LCALC                                           1401 05693000
*                   ZCALC=ZCALC/32; /* SHIFT TO LOW ORDER    @OZ30157*/ 05694000
         LH    @02,ZCALC                                           1402 05695000
         SRDA  @02,32                                              1402 05696000
         D     @02,@CF00291                                        1402 05697000
         STH   @03,ZCALC                                           1402 05698000
*                   DO I=1 TO 4;    /* CONVERT ALL 4         @OZ30157*/ 05699000
         LA    @04,1                                               1403 05700000
         STH   @04,I                                               1403 05701000
@DL01403 DS    0H                                                  1404 05702000
*                     CVD(LZYXFX(I),LZYXCP(I));/* TO DECIMAL @OZ30157*/ 05703000
         LR    @15,@04                                             1404 05704000
         ALR   @15,@15                                             1404 05705000
         LH    @00,LZYXFX-2(@15)                                   1404 05706000
         CVD   @00,@TS00001                                        1404 05707000
         LA    @14,LZYXCP-2(@15)                                   1404 05708000
         MVC   0(2,@14),@TS00001+6                                 1404 05709000
*                     UNPK(LZYXCU(I),LZYXCP(I));/* AND UNPACK      1405 05710000
*                                                            @OZ30157*/ 05711000
         LR    @14,@04                                             1405 05712000
         SLA   @14,2                                               1405 05713000
         LA    @03,LZYXCU-4(@14)                                   1405 05714000
         LA    @02,LZYXCP-2(@15)                                   1405 05715000
         UNPK  0(4,@03),0(2,@02)                                   1405 05716000
*                     LZYXCU(I)=LZYXCU(I)|ZEROS4;/* CLEAR          1406 05717000
*                                      ZONES@OZ30157                 */ 05718000
         LA    @15,LZYXCU-4(@14)                                   1406 05719000
         OC    0(4,@15),@CC01402                                   1406 05720000
*                   END;            /* LOOP 4 TIMES          @OZ30157*/ 05721000
         AL    @04,@CF00047                                        1407 05722000
         STH   @04,I                                               1407 05723000
         CH    @04,@CH00045                                        1407 05724000
         BNH   @DL01403                                            1407 05725000
*                   QCTLVAL=LZYXCU(1,4:4);/* ONE BYTE L VALUE      1408 05726000
*                                                            @OZ30157*/ 05727000
         L     @04,TABPTR                                          1408 05728000
         MVC   QCTLVAL(1,@04),LZYXCU+3                             1408 05729000
*                   QCTXVAL=LZYXCU(4,2:4);/* 3 BYTE X VALUE  @OZ30157*/ 05730000
         MVC   QCTXVAL(3,@04),LZYXCU+13                            1409 05731000
*                   QCTYVAL=LZYXCU(3,3:4);/* 2 BYTE Y VALUE  @OZ30157*/ 05732000
         MVC   QCTYVAL(2,@04),LZYXCU+10                            1410 05733000
*                   QCTZVAL=LZYXCU(2,4:4);/* 1 BYTE Z VALUE  @OZ30157*/ 05734000
         MVC   QCTZVAL(1,@04),LZYXCU+7                             1411 05735000
*                 END;              /*                       @OZ30157*/ 05736000
*               ELSE                /*                       @OZ30157*/ 05737000
*                 DO;               /* CALCULATE SSID        @OZ30157*/ 05738000
         B     @RC01388                                            1413 05739000
@RF01388 DS    0H                                                  1414 05740000
*/********************************************************************/ 05741000
*/*                                                                  */ 05742000
*/* CALCULATE SSID OF DEVICE IN ERROR PER QCB AND SQT        @OZ30157*/ 05743000
*/*                                                                  */ 05744000
*/********************************************************************/ 05745000
*                                                                  1414 05746000
*                   IF QCBRCE=BZERO&QCBRCC=BZERO&QCBRMC=BZERO THEN/*    05747000
*                                                            @OZ30157*/ 05748000
         L     @04,QCBPTR                                          1414 05749000
         TM    QCBRCE(@04),B'11100000'                             1414 05750000
         BNZ   @RF01414                                            1414 05751000
*                     IF QCBRDA=BONE THEN/* IF DASD          @OZ30157*/ 05752000
         TM    QCBRDA(@04),B'00010000'                             1415 05753000
         BNO   @RF01415                                            1415 05754000
*                       DO;         /* SET DASD SSID         @OZ30157*/ 05755000
*                         QCTSSID='00X';/* INIT VALUE        @OZ30157*/ 05756000
         L     @04,TABPTR                                          1417 05757000
         MVC   QCTSSID(3,@04),@CC03216                             1417 05758000
*                         LCALC=F0; /* CLEAR WORK AREAS      @OZ30157*/ 05759000
         SLR   @04,@04                                             1418 05760000
         STH   @04,LCALC                                           1418 05761000
*                         ZCALC=F0; /*                       @OZ30157*/ 05762000
         STH   @04,ZCALC                                           1419 05763000
*                         LCALCC2=SQTBFLG2&'1F'X;/* GET SDG  @OZ30157*/ 05764000
         L     @04,QAPTR+4                                         1420 05765000
         MVC   LCALCC2(1),SQTBFLG2(@04)                            1420 05766000
         NI    LCALCC2,X'1F'                                       1420 05767000
*                         IF LCALCB7=BONE THEN/*             @OZ30157*/ 05768000
         TM    LCALCB7,B'00000001'                                 1421 05769000
         BNO   @RF01421                                            1421 05770000
*                           YCALC=F8;/* SET HIGH ORDER       @OZ30157*/ 05771000
         MVC   YCALC(2),@CH00036                                   1422 05772000
*                         ELSE      /* IF SDG UNITS ON       @OZ30157*/ 05773000
*                           YCALC=F0;/* OFF IF OFF           @OZ30157*/ 05774000
         B     @RC01421                                            1423 05775000
@RF01421 SLR   @04,@04                                             1423 05776000
         STH   @04,YCALC                                           1423 05777000
*                         LCALC=LCALC/2;/* DROP LOW ORD. BIT @OZ30157*/ 05778000
@RC01421 LH    @02,LCALC                                           1424 05779000
         SRDA  @02,32                                              1424 05780000
         D     @02,@CF00056                                        1424 05781000
         STH   @03,LCALC                                           1424 05782000
*                         QCTSSID(2:2)=LCALCC2&'0F'X;/* FOR  @OZ30157*/ 05783000
         L     @04,TABPTR                                          1425 05784000
         MVC   QCTSSID+1(1,@04),LCALCC2                            1425 05785000
         NI    QCTSSID+1(@04),X'0F'                                1425 05786000
*                         MHPTR=QAPTR(2)+SQTMHPTR;/* MH ADDR @OZ30157*/ 05787000
         L     @04,QAPTR+4                                         1426 05788000
         SLR   @00,@00                                             1426 05789000
         IC    @00,SQTMHPTR(,@04)                                  1426 05790000
         ALR   @00,@04                                             1426 05791000
         ST    @00,MHPTR                                           1426 05792000
*                         IF MHF1B1=BZERO THEN/* IF SA TYPE  @OZ30157*/ 05793000
         LR    @04,@00                                             1427 05794000
         TM    MHF1B1(@04),B'01000000'                             1427 05795000
         BNZ   @RF01427                                            1427 05796000
*                           IF MHF1B6=BZERO&MHF1B7=BZERO THEN/*    1428 05797000
*                                                            @OZ30157*/ 05798000
         LR    @04,@00                                             1428 05799000
         TM    MHF1B6(@04),B'00000011'                             1428 05800000
         BNZ   @RF01428                                            1428 05801000
*                             DO;   /* GET LUA IN ERROR      @OZ30157*/ 05802000
*                               MHSAPTR=MHPTR+MHPLNDX;/*     @OZ30157*/ 05803000
         LR    @04,@00                                             1430 05804000
         SLR   @15,@15                                             1430 05805000
         IC    @15,MHPLNDX(,@04)                                   1430 05806000
         ALR   @15,@00                                             1430 05807000
         ST    @15,MHSAPTR                                         1430 05808000
*                               ZCALCC2=MHSALUA&'07'X;/*     @OZ30157*/ 05809000
         MVC   ZCALCC2(1),MHSALUA(@15)                             1431 05810000
         NI    ZCALCC2,X'07'                                       1431 05811000
*                             END;  /*                       @OZ30157*/ 05812000
*                           ELSE    /* IF IORB TYPE, GET LUA @OZ30157*/ 05813000
*                             ZCALCC2=MHIOLUA&'07'X;/* FIELD @OZ30157*/ 05814000
         B     @RC01428                                            1433 05815000
@RF01428 L     @04,MHPTR                                           1433 05816000
         MVC   ZCALCC2(1),MHIOLUA(@04)                             1433 05817000
         NI    ZCALCC2,X'07'                                       1433 05818000
*                         ELSE                                     1434 05819000
*                           ;       /* LEAVE AS ZERO         @OZ30157*/ 05820000
@RF01427 DS    0H                                                  1435 05821000
*                         ZCALC=ZCALC+YCALC;/* GET SSID UNITS      1435 05822000
*                                                            @OZ30157*/ 05823000
@RC01427 LH    @04,ZCALC                                           1435 05824000
         AH    @04,YCALC                                           1435 05825000
         STH   @04,ZCALC                                           1435 05826000
*                         QCTSSID(3:3)=ZCALCC2&'0F'X;/*      @OZ30157*/ 05827000
         L     @04,TABPTR                                          1436 05828000
         MVC   QCTSSID+2(1,@04),ZCALCC2                            1436 05829000
         NI    QCTSSID+2(@04),X'0F'                                1436 05830000
*                         TR(QCTSSID(2:3),NUMBRS);/* SSID    @OZ30157*/ 05831000
         TR    QCTSSID+1(2,@04),NUMBRS                             1437 05832000
*                       END;        /* DASD SSID SET         @OZ30157*/ 05833000
*                     ELSE          /* NOT DASD              @OZ30157*/ 05834000
*                       IF QCBRSA=BONE THEN/* IS IT SA       @OZ30157*/ 05835000
         B     @RC01415                                            1439 05836000
@RF01415 L     @04,QCBPTR                                          1439 05837000
         TM    QCBRSA(@04),B'00001000'                             1439 05838000
         BNO   @RF01439                                            1439 05839000
*                         DO;       /* YES                   @OZ30157*/ 05840000
*                           QCTSSID='800';/* SET SA BASE SSID      1441 05841000
*                                                            @OZ30157*/ 05842000
         L     @04,TABPTR                                          1441 05843000
         MVC   QCTSSID(3,@04),@CC01468                             1441 05844000
*                           QCTSSID(2:2)=SQTSA1&'0F'X;/* SA NO     1442 05845000
*                                                            @OZ30157*/ 05846000
         L     @15,QAPTR+4                                         1442 05847000
         MVC   QCTSSID+1(1,@04),SQTSA1(@15)                        1442 05848000
         NI    QCTSSID+1(@04),X'0F'                                1442 05849000
*                           TR(QCTSSID(2:2),NUMBRS);/* ADJUST      1443 05850000
*                                                            @OZ30157*/ 05851000
         TR    QCTSSID+1(1,@04),NUMBRS                             1443 05852000
*                         END;      /* SA SSID SET           @OZ30157*/ 05853000
*                       ELSE        /* NOT SA, IS IT         @OZ30157*/ 05854000
*                         IF QCBRDC=BONE THEN/* A DRC        @OZ30157*/ 05855000
         B     @RC01439                                            1445 05856000
@RF01439 L     @04,QCBPTR                                          1445 05857000
         TM    QCBRDC(@04),B'00000100'                             1445 05858000
         BNO   @RF01445                                            1445 05859000
*                           DO;     /* YES, SET              @OZ30157*/ 05860000
*                             QCTSSID='4XX';/* BASE VALUE    @OZ30157*/ 05861000
         L     @04,TABPTR                                          1447 05862000
         MVC   QCTSSID(3,@04),@CC03217                             1447 05863000
*                             QCTSSID(2:2)=SQTBFLG&'03'X;/*        1448 05864000
*                                      MSF@OZ30157                   */ 05865000
         L     @15,QAPTR+4                                         1448 05866000
         MVC   QCTSSID+1(1,@04),SQTBFLG(@15)                       1448 05867000
         NI    QCTSSID+1(@04),X'03'                                1448 05868000
*                             QCTSSID(2:2)=QCTSSID(2:2)|'0';/*     1449 05869000
*                                                            @OZ30157*/ 05870000
         OI    QCTSSID+1(@04),C'0'                                 1449 05871000
*                           END;    /* DRC SSID SET          @OZ30157*/ 05872000
*                         ELSE      /*                       @OZ30157*/ 05873000
*                           IF QCBRDD=BONE THEN/* IF DRD     @OZ30157*/ 05874000
         B     @RC01445                                            1451 05875000
@RF01445 L     @04,QCBPTR                                          1451 05876000
         TM    QCBRDD(@04),B'00000010'                             1451 05877000
         BNO   @RF01451                                            1451 05878000
*                             DO;   /* THEN CALC THAT ONE    @OZ30157*/ 05879000
*                               QCTSSID='2XX';/* SET BASE    @OZ30157*/ 05880000
         L     @04,TABPTR                                          1453 05881000
         MVC   QCTSSID(3,@04),@CC03218                             1453 05882000
*                               QCTSSID(2:2)=SQTBFLG1&'03'X;/*     1454 05883000
*                                                            @OZ30157*/ 05884000
         L     @15,QAPTR+4                                         1454 05885000
         MVC   QCTSSID+1(1,@04),SQTBFLG1(@15)                      1454 05886000
         NI    QCTSSID+1(@04),X'03'                                1454 05887000
*                               QCTSSID(3:3)=SQTDRDAD;/*     @OZ30157*/ 05888000
         MVC   QCTSSID+2(1,@04),SQTDRDAD(@15)                      1455 05889000
*                               QCTSSID=QCTSSID|'000';/*     @OZ30157*/ 05890000
         OC    QCTSSID(3,@04),@CC01500                             1456 05891000
*                             END;  /* END DRD SSID          @OZ30157*/ 05892000
*                           ELSE    /* IS IT CSF             @OZ30157*/ 05893000
*                             IF QCBRCS=BONE THEN/* YES      @OZ30157*/ 05894000
         B     @RC01451                                            1458 05895000
@RF01451 L     @04,QCBPTR                                          1458 05896000
         TM    QCBRCS(@04),B'00000001'                             1458 05897000
         BNO   @RF01458                                            1458 05898000
*                               DO; /* DO THAT ONE           @OZ30157*/ 05899000
*                                 QCTSSID='1XX';/* BASE VAL  @OZ30157*/ 05900000
         L     @04,TABPTR                                          1460 05901000
         MVC   QCTSSID(3,@04),@CC03219                             1460 05902000
*                                 QCTSSID(2:2)=SQTBFLG1&'03'X;/*   1461 05903000
*                                                            @OZ30157*/ 05904000
         L     @15,QAPTR+4                                         1461 05905000
         MVC   QCTSSID+1(1,@04),SQTBFLG1(@15)                      1461 05906000
         NI    QCTSSID+1(@04),X'03'                                1461 05907000
*                                 QCTSSID(2:2)=QCTSSID(2:2)|'0';/* 1462 05908000
*                                                            @OZ30157*/ 05909000
         OI    QCTSSID+1(@04),C'0'                                 1462 05910000
*                               END;/*                       @OZ30157*/ 05911000
*                             ELSE  /* NONE OF ABOVE         @OZ30157*/ 05912000
*                               QCTSSID='   ';/* NONE        @OZ30157*/ 05913000
         B     @RC01458                                            1464 05914000
@RF01458 L     @04,TABPTR                                          1464 05915000
         MVC   QCTSSID(3,@04),@CC03112                             1464 05916000
*                 END;              /* END GOOD SQT RTN      @OZ30157*/ 05917000
@RC01458 DS    0H                                                  1465 05918000
@RC01451 DS    0H                                                  1465 05919000
@RC01445 DS    0H                                                  1465 05920000
@RC01439 DS    0H                                                  1465 05921000
@RC01415 DS    0H                                                  1465 05922000
@RF01414 DS    0H                                                  1466 05923000
*               LVUPTR=ADDR(QCTCHAIN)-1;/* SET ADDRESS FOR CHAIN   1466 05924000
*                                                            @OZ30157*/ 05925000
@RC01388 L     @04,TABPTR                                          1466 05926000
         LA    @00,QCTCHAIN(,@04)                                  1466 05927000
         BCTR  @00,0                                               1466 05928000
         ST    @00,LVUPTR                                          1466 05929000
*               TABPTR=TABPTR+QCTLEN;/* BUMP TABPTR TO NEXT  @OZ30157*/ 05930000
         AH    @04,@CH00049                                        1467 05931000
         ST    @04,TABPTR                                          1467 05932000
*             END;                  /* END GOOD RETC         @OZ30157*/ 05933000
*         END;                      /* END ONE QCB LOOP      @OZ30157*/ 05934000
@RF01386 DS    0H                                                  1470 05935000
*     END;                          /* END SECTOR LOOP       @OZ30157*/ 05936000
@RF01362 LA    @04,4                                               1470 05937000
         AL    @04,QCBPTR                                          1470 05938000
         ST    @04,QCBPTR                                          1470 05939000
@DE01361 C     @04,QCBLST                                          1470 05940000
         BNH   @DL01361                                            1470 05941000
*   END;                            /* END BOTH SECTORS      @OZ30157*/ 05942000
         LA    @04,1                                               1471 05943000
         AH    @04,I                                               1471 05944000
         STH   @04,I                                               1471 05945000
         CH    @04,@CH00056                                        1471 05946000
         BNH   @DL01351                                            1471 05947000
@DC01351 DS    0H                                                  1472 05948000
*   IF RETC=F0 THEN                 /* IF GOOD RUN           @OZ30157*/ 05949000
         LH    @04,RETC                                            1472 05950000
         LTR   @04,@04                                             1472 05951000
         BNZ   @RF01472                                            1472 05952000
*     DO;                           /* SETUP TO DISPLAY THE  @OZ30157*/ 05953000
*       VALCODE=BONE;               /* MESSAGE AND IF        @OZ30157*/ 05954000
         OI    VALCODE,B'00001000'                                 1474 05955000
*       IF ENDSW=BONE THEN          /* ANY ERR FOUND, TO     @OZ30157*/ 05956000
         TM    ENDSW,B'00000100'                                   1475 05957000
         BNO   @RF01475                                            1475 05958000
*         VALSSID=BONE;             /* DISPLAY THE TABLE     @OZ30157*/ 05959000
         OI    VALSSID,B'01000000'                                 1476 05960000
*     END;                          /* END CHECK RESULTS     @OZ30157*/ 05961000
@RF01475 DS    0H                                                  1478 05962000
*   RFY                                                            1478 05963000
*     R14 RSTD;                     /*                       @OZ30157*/ 05964000
@RF01472 DS    0H                                                  1479 05965000
*   R14=MS56QC14;                   /* RESTORE RETURN REG    @OZ30157*/ 05966000
         L     R14,MS56QC14                                        1479 05967000
*   RFY                                                            1480 05968000
*     R14 UNRSTD;                   /*                       @OZ30157*/ 05969000
*   RETURN;                         /*                       @OZ30157*/ 05970000
@EL00005 DS    0H                                                  1481 05971000
@EF00005 DS    0H                                                  1481 05972000
@ER00005 BR    @14                                                 1481 05973000
*   END MSG56QC;                    /* END QCB STAT ROUTINE  @OZ30157*/ 05974000
*MSG56TR:                                                          1483 05975000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @OZ30157*/ 05976000
MSG56TR  DS    0H                                                  1484 05977000
*/********************************************************************/ 05978000
*/*                                                                  */ 05979000
*/* PROCEDURE NAME: MSG56TR                                          */ 05980000
*/*                                                                  */ 05981000
*/* FUNCTION: DISPLAY TRACE STATUS                                   */ 05982000
*/*                                                                  */ 05983000
*/* INPUTS: MSC SECTOR 57                                            */ 05984000
*/*                                                                  */ 05985000
*/* OUTPUTS: ONE WTO LINE WITH TRACE STATUS                  @OZ30157*/ 05986000
*/*                                                                  */ 05987000
*/********************************************************************/ 05988000
*                                                                  1484 05989000
*   DCL                                                            1484 05990000
*     MS56TR14 FIXED(31);           /* LOCAL RETURN REG SAVE @OZ30157*/ 05991000
*   DCL                                                            1485 05992000
*     1 TRCCHK BASED(QAPTR(1)),     /* TRACE CHECK AREA IN WCS 57  1485 05993000
*                                                            @OZ30157*/ 05994000
*      2 TRCCHKA BIT(8),            /*                       @OZ30157*/ 05995000
*       3 TRCACT BIT(1),            /* TRACE IS ACTIVE       @OZ30157*/ 05996000
*       3 TRCXACT BIT(1),           /* TRACE X IS ACTIVE     @OZ30157*/ 05997000
*       3 TRCXX1 BIT(6),            /* NOT USED HERE         @OZ30157*/ 05998000
*      2 TRCCHR FIXED(24),          /* NEXT REC TO BE WRITTEN      1485 05999000
*                                                            @OZ30157*/ 06000000
*       3 TRCNC FIXED(8),           /* CYL NO                @OZ30157*/ 06001000
*       3 TRCNH FIXED(8),           /* HEAD NO               @OZ30157*/ 06002000
*       3 TRCNR FIXED(8);           /* RECORD NO             @OZ30157*/ 06003000
*   DCL                                                            1486 06004000
*     1 TRCCHRS BASED(QAPTR(2)),    /* CHRS FOR TRACE RECS   @OZ30157*/ 06005000
*      2 * CHAR(64),                /*                       @OZ30157*/ 06006000
*      2 * FIXED(32),               /* END OF X AREA         @OZ30157*/ 06007000
*       3 * FIXED(8),               /* FLAGS- NOT USED HERE  @OZ30157*/ 06008000
*       3 TRCEXC FIXED(8),          /* CYL                   @OZ30157*/ 06009000
*       3 TRCEXH FIXED(8),          /* HEAD                  @OZ30157*/ 06010000
*       3 TRCEXR FIXED(8),          /* REC                   @OZ30157*/ 06011000
*      2 * FIXED(32),               /* END OF Y AREA         @OZ30157*/ 06012000
*       3 * FIXED(8),               /* FLAGS- NOT USED HERE  @OZ30157*/ 06013000
*       3 TRCEYC FIXED(8),          /* CYL                   @OZ30157*/ 06014000
*       3 TRCEYH FIXED(8),          /* HEAD                  @OZ30157*/ 06015000
*       3 TRCEYR FIXED(8),          /* REC                   @OZ30157*/ 06016000
*      2 * FIXED(32),               /* START OF X AREA       @OZ30157*/ 06017000
*       3 * FIXED(8),               /* FLAGS- NOT USED HERE  @OZ30157*/ 06018000
*       3 TRCSXC FIXED(8),          /* CYL                   @OZ30157*/ 06019000
*       3 TRCSXH FIXED(8),          /* HEAD                  @OZ30157*/ 06020000
*       3 TRCSXR FIXED(8),          /* REC                   @OZ30157*/ 06021000
*      2 * FIXED(32),               /* START OF Y AREA       @OZ30157*/ 06022000
*       3 * FIXED(8),               /* FLAGS- NOT USED HERE  @OZ30157*/ 06023000
*       3 TRCSYC FIXED(8),          /* CYL                   @OZ30157*/ 06024000
*       3 TRCSYH FIXED(8),          /* HEAD                  @OZ30157*/ 06025000
*       3 TRCSYR FIXED(8);          /* REC                   @OZ30157*/ 06026000
*   DCL                                                            1487 06027000
*     1 MSGTRB CHAR(44) BASED(WPLPTR+4),/* MAP TRACE MSG     @OZ30157*/ 06028000
*      2 * CHAR(6),                 /* HEADER PORTION        @OZ30157*/ 06029000
*      2 MTRACTIN CHAR(8),          /* INACTIVE/ACTIVE       @OZ30157*/ 06030000
*      2 MTRCLR,                    /*                       @OZ30157*/ 06031000
*       3 * CHAR(8),                /* AREA CONSTANT         @OZ30157*/ 06032000
*       3 MTRAREA CHAR(1),          /* AREA VARIABLE         @OZ30157*/ 06033000
*       3 * CHAR(2),                /* -                     @OZ30157*/ 06034000
*       3 MTRPCT CHAR(3),           /* PERCENT FULL          @OZ30157*/ 06035000
*        4 * CHAR(1),               /* USE ONLY IF 100%      @OZ30157*/ 06036000
*        4 MTRPCTB CHAR(2),         /* 01 TO 99%             @OZ30157*/ 06037000
*       3 * CHAR(6);                /* % FULL CONSTANT       @OZ30157*/ 06038000
*/********************************************************************/ 06039000
*/*                                                                  */ 06040000
*/* LOCAL STATIC VARIABLES AND WORK AREAS FOR TRACE ONLY     @OZ30157*/ 06041000
*/*                                                                  */ 06042000
*/********************************************************************/ 06043000
*                                                                  1488 06044000
*   DCL                                                            1488 06045000
*     1 TRCCALC LOCAL STATIC,       /* AREA FOR CALCULATIONS @OZ30157*/ 06046000
*      2 TRNXC FIXED(15),           /* NEXT CYLINDER         @OZ30157*/ 06047000
*      2 TRNXH FIXED(15),           /* NEXT HEAD             @OZ30157*/ 06048000
*      2 TRNXR FIXED(15),           /* NEXT RECORD           @OZ30157*/ 06049000
*      2 TRCTREC FIXED(15),         /* TOTAL RECORDS         @OZ30157*/ 06050000
*      2 TRCTHDS FIXED(15),         /* TOTAL HEADS           @OZ30157*/ 06051000
*      2 TRCTCYL FIXED(15),         /* TOTAL CYLINDERS       @OZ30157*/ 06052000
*      2 TRCUREC FIXED(15),         /* RECORDS USED          @OZ30157*/ 06053000
*      2 TRCUHDS FIXED(15),         /* HEADS USED            @OZ30157*/ 06054000
*      2 TRCUCYL FIXED(15),         /* CYLINDERS USED        @OZ30157*/ 06055000
*      2 TRCUSE FIXED(15),          /* USAGE WORK AREA       @OZ30157*/ 06056000
*      2 TRCPCT FIXED(15);          /* PERCENT FINAL CALC    @OZ30157*/ 06057000
*   DCL                                                            1489 06058000
*     1 TRCWORK STATIC LOCAL,       /* CONVERSION WORK AREA  @OZ30157*/ 06059000
*      2 TRCWORKA CHAR(1),          /* USED ONLY IF 3 CHARS  @OZ30157*/ 06060000
*      2 TRCWORKB CHAR(2);          /*                       @OZ30157*/ 06061000
*   DCL                                                            1490 06062000
*     TCYLCNT FIXED(15) INIT(608),  /* CALC WORK AREAS       @OZ30157*/ 06063000
*     THDCNT FIXED(15) INIT(32),    /*                       @OZ30157*/ 06064000
*     TRNXCC FIXED(15),             /*                       @OZ30157*/ 06065000
*     TRNXHH FIXED(15),             /*                       @OZ30157*/ 06066000
*     TRNXRR FIXED(15),             /*                       @OZ30157*/ 06067000
*     TRCRECS FIXED(15),            /*                       @OZ30157*/ 06068000
*     TRCTOT FIXED(15);             /*                       @OZ30157*/ 06069000
*   DCL                                                            1491 06070000
*     CHARX CHAR(1) CONSTANT('X'),  /* CHAR X FOR MESSAGE    @OZ30157*/ 06071000
*     CHARY CHAR(1) CONSTANT('Y'),  /* CHAR Y FOR MESSAGE    @OZ30157*/ 06072000
*     ACTIVE CHAR(8) CONSTANT('ACTIVE  '),/*                 @OZ30157*/ 06073000
*     INACTIVE CHAR(8) CONSTANT('INACTIVE');/*               @OZ30157*/ 06074000
*   DCL                                                            1492 06075000
*     CZEROS CHAR(3) INIT('000');   /* TO CLEAR SIGNS        @OZ30157*/ 06076000
*   RFY                                                            1493 06077000
*     R14 RSTD;                     /*                       @OZ30157*/ 06078000
*   MS56TR14=R14;                   /* SAVE RETURN REG       @OZ30157*/ 06079000
         ST    R14,MS56TR14                                        1494 06080000
*   RFY                                                            1495 06081000
*     R14 UNRSTD;                   /*                       @OZ30157*/ 06082000
*   DO;                             /* GOOD QUERY RESULT     @OZ30157*/ 06083000
*     IF TRCACT=BZERO THEN          /* IF TRACE NOT ACTIVE   @OZ30157*/ 06084000
         L     @04,QAPTR                                           1497 06085000
         TM    TRCACT(@04),B'10000000'                             1497 06086000
         BNZ   @RF01497                                            1497 06087000
*       DO;                         /* THEN SET MESSAGE TO   @OZ30157*/ 06088000
*         MTRACTIN=INACTIVE;        /* NEITHER ACTIVE        @OZ30157*/ 06089000
         LA    @04,4                                               1499 06090000
         AL    @04,WPLPTR                                          1499 06091000
         MVC   MTRACTIN(8,@04),@CC03296                            1499 06092000
*         MTRCLR=BLANK;             /* AND CLEAR REST        @OZ30157*/ 06093000
         MVI   MTRCLR+13(@04),C' '                                 1500 06094000
         MVC   MTRCLR+14(6,@04),MTRCLR+13(@04)                     1500 06095000
         MVC   MTRCLR(13,@04),@CC02699                             1500 06096000
*       END;                        /*                       @OZ30157*/ 06097000
*     ELSE                          /* ONE IS - SO GO        @OZ30157*/ 06098000
*       DO;                         /* TRACE ACTIVE          @OZ30157*/ 06099000
         B     @RC01497                                            1502 06100000
@RF01497 DS    0H                                                  1503 06101000
*         MTRACTIN=ACTIVE;          /* FIRST SAY ACTIVE      @OZ30157*/ 06102000
         LA    @04,4                                               1503 06103000
         AL    @04,WPLPTR                                          1503 06104000
         MVC   MTRACTIN(8,@04),@CC03294                            1503 06105000
*         TRNXCC=TRCNC;             /* GET NEXT CYL NUMBER   @OZ30157*/ 06106000
         L     @15,QAPTR                                           1504 06107000
         SLR   @14,@14                                             1504 06108000
         IC    @14,TRCNC(,@15)                                     1504 06109000
         STH   @14,TRNXCC                                          1504 06110000
*         TRNXHH=TRCNH;             /* HEAD NUMBER           @OZ30157*/ 06111000
         SLR   @03,@03                                             1505 06112000
         IC    @03,TRCNH(,@15)                                     1505 06113000
         STH   @03,TRNXHH                                          1505 06114000
*         TRNXRR=TRCNR;             /* AND RECORD NUMBER     @OZ30157*/ 06115000
         SLR   @02,@02                                             1506 06116000
         IC    @02,TRCNR(,@15)                                     1506 06117000
         STH   @02,TRNXRR                                          1506 06118000
*/********************************************************************/ 06119000
*/*                                                                  */ 06120000
*/*   CALCULATE THE AMOUNT OF AREA IN USE AND PUT IN MESSAGE @OZ30157*/ 06121000
*/*                                                                  */ 06122000
*/********************************************************************/ 06123000
*                                                                  1507 06124000
*         IF TRCXACT=BZERO THEN     /* CALC PERCENT          @OZ30157*/ 06125000
         TM    TRCXACT(@15),B'01000000'                            1507 06126000
         BNZ   @RF01507                                            1507 06127000
*           DO;                     /* FROM Y AREA           @OZ30157*/ 06128000
*             MTRAREA=CHARY;        /* SAY IT IS             @OZ30157*/ 06129000
         MVI   MTRAREA(@04),C'Y'                                   1509 06130000
*             TRCTCYL=TRCEYC-TRCSYC;/* GET NBR CYLS          @OZ30157*/ 06131000
         L     @04,QAPTR+4                                         1510 06132000
         SLR   @15,@15                                             1510 06133000
         IC    @15,TRCSYC(,@04)                                    1510 06134000
         SLR   @00,@00                                             1510 06135000
         IC    @00,TRCEYC(,@04)                                    1510 06136000
         SLR   @00,@15                                             1510 06137000
         STH   @00,TRCTCYL                                         1510 06138000
*             TRCTHDS=TRCEYH-TRCSYH;/* NMBR OF HEADS         @OZ30157*/ 06139000
         SLR   @00,@00                                             1511 06140000
         IC    @00,TRCSYH(,@04)                                    1511 06141000
         ST    @15,@TF00001                                        1511 06142000
         SLR   @15,@15                                             1511 06143000
         IC    @15,TRCEYH(,@04)                                    1511 06144000
         SLR   @15,@00                                             1511 06145000
         STH   @15,TRCTHDS                                         1511 06146000
*             TRCRECS=TRCEYR-TRCSYR;/* NBR OF RECRDS         @OZ30157*/ 06147000
         SLR   @15,@15                                             1512 06148000
         IC    @15,TRCSYR(,@04)                                    1512 06149000
         ST    @00,@TF00002                                        1512 06150000
         SLR   @00,@00                                             1512 06151000
         IC    @00,TRCEYR(,@04)                                    1512 06152000
         SLR   @00,@15                                             1512 06153000
         STH   @00,TRCRECS                                         1512 06154000
*             TRCUCYL=TRCNC-TRCSYC; /* TOT USED CYLS         @OZ30157*/ 06155000
         SL    @14,@TF00001                                        1513 06156000
         STH   @14,TRCUCYL                                         1513 06157000
*             TRCUHDS=TRCNH-TRCSYH; /* HEADS, AND            @OZ30157*/ 06158000
         SL    @03,@TF00002                                        1514 06159000
         STH   @03,TRCUHDS                                         1514 06160000
*             TRCUREC=TRCNR-TRCSYR; /* RECORDS IN Y          @OZ30157*/ 06161000
         SLR   @02,@15                                             1515 06162000
         STH   @02,TRCUREC                                         1515 06163000
*           END;                    /* END GET Y FIGURES     @OZ30157*/ 06164000
*         ELSE                      /* OR FROM X AREA        @OZ30157*/ 06165000
*           DO;                     /*                       @OZ30157*/ 06166000
         B     @RC01507                                            1517 06167000
@RF01507 DS    0H                                                  1518 06168000
*             MTRAREA=CHARX;        /* X IS ACTIVE           @OZ30157*/ 06169000
         L     @04,WPLPTR                                          1518 06170000
         MVI   MTRAREA+4(@04),C'X'                                 1518 06171000
*             TRCTCYL=TRCEXC-TRCSXC;/* GET CYL COUNT         @OZ30157*/ 06172000
         L     @04,QAPTR+4                                         1519 06173000
         SLR   @15,@15                                             1519 06174000
         IC    @15,TRCSXC(,@04)                                    1519 06175000
         SLR   @00,@00                                             1519 06176000
         IC    @00,TRCEXC(,@04)                                    1519 06177000
         SLR   @00,@15                                             1519 06178000
         STH   @00,TRCTCYL                                         1519 06179000
*             TRCTHDS=TRCEXH-TRCSXH;/* NUMB OF HEADS         @OZ30157*/ 06180000
         SLR   @14,@14                                             1520 06181000
         IC    @14,TRCSXH(,@04)                                    1520 06182000
         SLR   @00,@00                                             1520 06183000
         IC    @00,TRCEXH(,@04)                                    1520 06184000
         SLR   @00,@14                                             1520 06185000
         STH   @00,TRCTHDS                                         1520 06186000
*             TRCTREC=TRCEXR-TRCSXR;/* NUM OF RECRDS         @OZ30157*/ 06187000
         SLR   @03,@03                                             1521 06188000
         IC    @03,TRCSXR(,@04)                                    1521 06189000
         SLR   @00,@00                                             1521 06190000
         IC    @00,TRCEXR(,@04)                                    1521 06191000
         SLR   @00,@03                                             1521 06192000
         STH   @00,TRCTREC                                         1521 06193000
*             TRCUCYL=TRCNC-TRCSXC; /* TOT USED CYLS         @OZ30157*/ 06194000
         L     @04,QAPTR                                           1522 06195000
         LCR   @15,@15                                             1522 06196000
         MVC   @ZT00003+3(1),TRCNC(@04)                            1522 06197000
         AL    @15,@ZT00003                                        1522 06198000
         STH   @15,TRCUCYL                                         1522 06199000
*             TRCUHDS=TRCNH-TRCSXH; /* HEADS, AND            @OZ30157*/ 06200000
         LCR   @14,@14                                             1523 06201000
         MVC   @ZT00003+3(1),TRCNH(@04)                            1523 06202000
         AL    @14,@ZT00003                                        1523 06203000
         STH   @14,TRCUHDS                                         1523 06204000
*             TRCUREC=TRCNR-TRCSXR; /* RECORDS IN X          @OZ30157*/ 06205000
         LCR   @03,@03                                             1524 06206000
         MVC   @ZT00003+3(1),TRCNR(@04)                            1524 06207000
         AL    @03,@ZT00003                                        1524 06208000
         STH   @03,TRCUREC                                         1524 06209000
*           END;                    /* END GET Y FIGURES     @OZ30157*/ 06210000
*         IF TRCTREC<F0 THEN        /* IF RECORDS IS NEGATIVE      1526 06211000
*                                                            @OZ30157*/ 06212000
@RC01507 LH    @04,TRCTREC                                         1526 06213000
         LTR   @04,@04                                             1526 06214000
         BNM   @RF01526                                            1526 06215000
*           DO;                     /* ADJUST CALC VALUES    @OZ30157*/ 06216000
*             TRCTHDS=TRCTHDS-F1;   /* DECREMENT HD CNT      @OZ30157*/ 06217000
         LH    @00,TRCTHDS                                         1528 06218000
         BCTR  @00,0                                               1528 06219000
         STH   @00,TRCTHDS                                         1528 06220000
*             TRCTREC=TRCTREC+F32;  /* MAKE REC CNT VALID    @OZ30157*/ 06221000
         LA    @04,32(,@04)                                        1529 06222000
         STH   @04,TRCTREC                                         1529 06223000
*           END;                    /*                       @OZ30157*/ 06224000
*         IF TRCTHDS<F0 THEN        /* IF HEAD COUNT NEGATIVE      1531 06225000
*                                                            @OZ30157*/ 06226000
@RF01526 LH    @04,TRCTHDS                                         1531 06227000
         LTR   @04,@04                                             1531 06228000
         BNM   @RF01531                                            1531 06229000
*           DO;                     /*                       @OZ30157*/ 06230000
*             TRCTCYL=TRCTCYL-F1;   /* THEN DECR CYL CT      @OZ30157*/ 06231000
         LH    @00,TRCTCYL                                         1533 06232000
         BCTR  @00,0                                               1533 06233000
         STH   @00,TRCTCYL                                         1533 06234000
*             TRCTHDS=TRCTHDS+F19;  /* MAKE HD CT VALID      @OZ30157*/ 06235000
         LA    @04,19(,@04)                                        1534 06236000
         STH   @04,TRCTHDS                                         1534 06237000
*           END;                    /*                       @OZ30157*/ 06238000
*         TRCTOT=(TRCTCYL*TCYLCNT)+(TRCTHDS*THDCNT)+TRCTREC;       1536 06239000
*                                                                  1536 06240000
@RF01531 LH    @04,TCYLCNT                                         1536 06241000
         LR    @00,@04                                             1536 06242000
         MH    @00,TRCTCYL                                         1536 06243000
         LH    @15,THDCNT                                          1536 06244000
         LR    @14,@15                                             1536 06245000
         MH    @14,TRCTHDS                                         1536 06246000
         ALR   @00,@14                                             1536 06247000
         AH    @00,TRCTREC                                         1536 06248000
         STH   @00,TRCTOT                                          1536 06249000
*         /***********************************************************/ 06250000
*         /*                                                         */ 06251000
*         /* TOTAL RECORD COUNT                              @OZ30157*/ 06252000
*         /*                                                         */ 06253000
*         /***********************************************************/ 06254000
*                                                                  1537 06255000
*         TRCUSE=(TRCUCYL*TCYLCNT)+(TRCUHDS*THDCNT)+TRCUREC;       1537 06256000
*                                                                  1537 06257000
         MH    @04,TRCUCYL                                         1537 06258000
         MH    @15,TRCUHDS                                         1537 06259000
         ALR   @04,@15                                             1537 06260000
         AH    @04,TRCUREC                                         1537 06261000
         STH   @04,TRCUSE                                          1537 06262000
*         /***********************************************************/ 06263000
*         /*                                                         */ 06264000
*         /* USED RECORD COUNT                               @OZ30157*/ 06265000
*         /*                                                         */ 06266000
*         /***********************************************************/ 06267000
*                                                                  1538 06268000
*         IF TRCUSE>F0 THEN         /* IF ANY USED,          @OZ30157*/ 06269000
         LTR   @04,@04                                             1538 06270000
         BNP   @RF01538                                            1538 06271000
*           DO;                     /* THEN CALC PERCENT     @OZ30157*/ 06272000
*             TRCPCT=(TRCUSE*100)/TRCTOT;/* CALC PCT FULL    @OZ30157*/ 06273000
         LR    @03,@04                                             1540 06274000
         M     @02,@CF03298                                        1540 06275000
         DR    @02,@00                                             1540 06276000
         STH   @03,TRCPCT                                          1540 06277000
*             CVD(TRCPCT,TRCWORK);  /* CONVERT FOR PRINT     @OZ30157*/ 06278000
         CVD   @03,@TS00001                                        1541 06279000
         MVC   TRCWORK(3),@TS00001+5                               1541 06280000
*             IF TRCWORKA^='00'X THEN/* IF OVER 99 MUST      @OZ30157*/ 06281000
         CLI   TRCWORKA,X'00'                                      1542 06282000
         BE    @RF01542                                            1542 06283000
*               DO;                 /*                       @OZ30157*/ 06284000
*                 UNPK(MTRPCT,TRCWORK);/* IN 3 BYTE AREA     @OZ30157*/ 06285000
         LA    @04,4                                               1544 06286000
         AL    @04,WPLPTR                                          1544 06287000
         UNPK  MTRPCT(3,@04),TRCWORK(3)                            1544 06288000
*                 MTRPCT=MTRPCT|CZEROS;/* AND CLEAR SIGN     @OZ30157*/ 06289000
         OC    MTRPCT(3,@04),CZEROS                                1545 06290000
*               END;                /*                       @OZ30157*/ 06291000
*             ELSE                  /* ELSE PUT IN           @OZ30157*/ 06292000
*               DO;                 /*                       @OZ30157*/ 06293000
         B     @RC01542                                            1547 06294000
@RF01542 DS    0H                                                  1548 06295000
*                 UNPK(MTRPCTB,TRCWORKB);/* TWO BYTE AREA    @OZ30157*/ 06296000
         LA    @04,4                                               1548 06297000
         AL    @04,WPLPTR                                          1548 06298000
         UNPK  MTRPCTB(2,@04),TRCWORKB(2)                          1548 06299000
*                 MTRPCTB=MTRPCTB|CZEROS(1:2);/*             @OZ30157*/ 06300000
         OC    MTRPCTB(2,@04),CZEROS                               1549 06301000
*               END;                /*                       @OZ30157*/ 06302000
*           END;                    /* BUT IF NONE           @OZ30157*/ 06303000
*         ELSE                      /* WERE USED,            @OZ30157*/ 06304000
*           MTRPCTB=CZEROS(1:2);    /* PUT IN ZEROS          @OZ30157*/ 06305000
         B     @RC01538                                            1552 06306000
@RF01538 L     @04,WPLPTR                                          1552 06307000
         MVC   MTRPCTB+4(2,@04),CZEROS                             1552 06308000
*       END;                        /* END TRACE ACTIVE      @OZ30157*/ 06309000
@RC01538 DS    0H                                                  1554 06310000
*   END;                            /* END GOOD QUERY        @OZ30157*/ 06311000
@RC01497 DS    0H                                                  1555 06312000
*   WPLMLLTF=''B;                   /* CLEAR FLAG FIELD      @OZ30157*/ 06313000
         L     @04,WPLPTR                                          1555 06314000
         XC    WPLMLLTF(2,@04),WPLMLLTF(@04)                       1555 06315000
*   WPLMLLTC=BONE;                  /* DATA LINE             @OZ30157*/ 06316000
         OI    WPLMLLTC(@04),B'00100000'                           1556 06317000
*   WPLPTR=WPLPTR+WPLMLLEN;         /* BUMP TO NEXT LINE     @OZ30157*/ 06318000
         SLR   @00,@00                                             1557 06319000
         IC    @00,WPLMLLEN(,@04)                                  1557 06320000
         ALR   @00,@04                                             1557 06321000
         ST    @00,WPLPTR                                          1557 06322000
*   MSGCNT=F2;                      /* TWO LINE MESSAGE      @OZ30157*/ 06323000
         MVC   MSGCNT(2),@CH00056                                  1558 06324000
*   RFY                                                            1559 06325000
*     R14 RSTD;                     /*                       @OZ30157*/ 06326000
*   R14=MS56TR14;                   /* RESTORE RETURN REG    @OZ30157*/ 06327000
         L     R14,MS56TR14                                        1560 06328000
*   RFY                                                            1561 06329000
*     R14 UNRSTD;                   /*                       @OZ30157*/ 06330000
*   RETURN;                         /*                       @OZ30157*/ 06331000
@EL00006 DS    0H                                                  1562 06332000
@EF00006 DS    0H                                                  1562 06333000
@ER00006 BR    @14                                                 1562 06334000
*   END MSG56TR;                    /* END TRACE DISPLAY     @OZ30157*/ 06335000
*MSG56GQ:                                                          1564 06336000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @OZ30157*/ 06337000
MSG56GQ  DS    0H                                                  1565 06338000
*/********************************************************************/ 06339000
*/*                                                                  */ 06340000
*/* PROCEDURE NAME: MSG56GQ                                          */ 06341000
*/*                                                                  */ 06342000
*/* FUNCTIONS:                                                       */ 06343000
*/*    1. ISSUE UP TO 28 QUERIES PER PARM LIST PASSED                */ 06344000
*/*       FROM USER.                                                 */ 06345000
*/*                                                                  */ 06346000
*/* INPUTS:                                                          */ 06347000
*/*    1. QUERY REQUEST LIST IN QBTAB.                               */ 06348000
*/*                                                                  */ 06349000
*/* OUTPUTS:                                                         */ 06350000
*/*    1. QUERY AREA - UP TO 28 QUERIES REQUESTED                    */ 06351000
*/*                                                                  */ 06352000
*/* RETURN CODES - PLACED IN GLOBAL RETC FIELD                       */ 06353000
*/*    4 - GOT AT LEAST ONE PER REQUEST - NOT ENOUGH                 */ 06354000
*/*        STORAGE FOR ALL                                           */ 06355000
*/*    8 - ERROR ON QUERY - CHECK AREAS FOR RESULTS                  */ 06356000
*/*   12 - COULD NOT ISSUE A QUERY - NO STORAGE OR ERROR IN          */ 06357000
*/*        CALLING PARAMETERS.                               @OZ30157*/ 06358000
*/*                                                                  */ 06359000
*/********************************************************************/ 06360000
*                                                                  1565 06361000
*   DCL                                                            1565 06362000
*     MVSRC CHAR(512) BASED(QWPTR), /* OVERLAY FOR SOURCE    @OZ30157*/ 06363000
*     MVREC CHAR(512) BASED(MVPTR); /* AND RECEIVER AREAS    @OZ30157*/ 06364000
*   DCL                                                            1566 06365000
*     MOVEMAP(*) FIXED(15) BASED(MAPPTR);/* MOVE MAP OVERLAY @OZ30157*/ 06366000
*   DCL                                                            1567 06367000
*     MVPTR PTR(32),                /* MOVE RECEIVE POINTER  @OZ30157*/ 06368000
*     MAPPTR PTR(32);               /* MAP POINTER           @OZ30157*/ 06369000
*   DCL                                                            1568 06370000
*     QCNT FIXED(31);               /* COUNTER               @OZ30157*/ 06371000
*   DCL                                                            1569 06372000
*     MS56GQ14 FIXED(31);           /* LOCAL RETURN REG SAVE @OZ30157*/ 06373000
*   DCL                                                            1570 06374000
*     1 QBCHRF FIXED(32),           /* CHR UPDATE AREA       @OZ30157*/ 06375000
*      2 * FIXED(8),                /* NOT USED - 00         @OZ30157*/ 06376000
*      2 QBPCYL FIXED(8),           /* CYL NUMBER            @OZ30157*/ 06377000
*      2 QBPHD FIXED(8),            /* HEAD NUMBER           @OZ30157*/ 06378000
*      2 QBPREC FIXED(8);           /* RECORD NUMBER         @OZ30157*/ 06379000
*   DCL                                                            1571 06380000
*     QBCHRC CHAR(4) DEF(QBCHRF);   /* REDEF FOR MOVE        @OZ30157*/ 06381000
*   DCL                                                            1572 06382000
*     QPEND PTR(31),                /* MAX QUERY ADDRESS     @OZ30157*/ 06383000
*     QWPTR PTR(31),                /* CURR QUERY ADDRESS    @OZ30157*/ 06384000
*     QENT FIXED(15),               /* CURRENT QUERY INDEX   @OZ30157*/ 06385000
*     QI FIXED(15),                 /* CURRENT SUBINDEX      @OZ30157*/ 06386000
*     QMI FIXED(15),                /* MOVE MAP INDEX        @OZ30157*/ 06387000
*     MFB FIXED(15),                /* MOVE FROM BEGIN INDEX @OZ30157*/ 06388000
*     MFE FIXED(15),                /* MOVE FROM END INDEX   @OZ30157*/ 06389000
*     M2B FIXED(15),                /* MOVE TO BEGIN INDEX   @OZ30157*/ 06390000
*     M2E FIXED(15),                /* MOVE TO END INDEX     @OZ30157*/ 06391000
*     QMCT FIXED(15);               /* MOVE COUNT INDEX      @OZ30157*/ 06392000
*   DCL                                                            1573 06393000
*     1 QBPRMAR,                    /* QUERY PARAMETER BUILD @OZ30157*/ 06394000
*      2 QBPSUB,                    /* FOR MOVE QBPARM       @OZ30157*/ 06395000
*       3 QBPTID FIXED(8),          /* AREA - TABLE ID/SECTOR@OZ30157*/ 06396000
*       3 QBPTRD CHAR(1),           /* READ OR ALT MSC FLAG  @OZ30157*/ 06397000
*       3 QBPTVAR1 CHAR(1),         /* 08 OR SA NUMBER       @OZ30157*/ 06398000
*       3 QBPTVAR2 FIXED(8),        /* SDG, INTFC, OR 00     @OZ30157*/ 06399000
*      2 QBPTFIL CHAR(16) INIT(''B),/* FILL WITH BINARY ZEROS@OZ30157*/ 06400000
*      2 QBPCHR CHAR(4),            /* DASD CHR FOR TID F0   @OZ30157*/ 06401000
*      2 * CHAR(8) INIT(''B),       /* FILL WITH ZEROS       @OZ30157*/ 06402000
*      2 QBPBUF PTR(32);            /* BUFFER POINTER        @OZ30157*/ 06403000
*   DCL                                                            1574 06404000
*     QBPORD CHAR(1);               /* TO HOLD QUERY ORDER   @OZ30157*/ 06405000
*   RFY                                                            1575 06406000
*     R14 RSTD;                     /*                       @OZ30157*/ 06407000
*   MS56GQ14=R14;                   /* SAVE RETURN REG       @OZ30157*/ 06408000
         ST    R14,MS56GQ14                                        1576 06409000
*   RFY                                                            1577 06410000
*     R14 UNRSTD;                   /*                       @OZ30157*/ 06411000
*   RETC=F0;                        /* START WITH 0 RETURN   @OZ30157*/ 06412000
         SLR   @04,@04                                             1578 06413000
         STH   @04,RETC                                            1578 06414000
*   QPEND=ADDR(WPLBUF)-512;         /* LAST POSSIBLE QUERY   @OZ30157*/ 06415000
         L     @15,WORKPTR                                         1579 06416000
         LR    @00,@15                                             1579 06417000
         SH    @00,@CH03603                                        1579 06418000
         ST    @00,QPEND                                           1579 06419000
*   IF QAPTR(1)=F0 THEN             /* IF FIRST QUERY PTR 0  @OZ30157*/ 06420000
         CL    @04,QAPTR                                           1580 06421000
         BNE   @RF01580                                            1580 06422000
*     QAPTR(1)=ADDR(QUBUF1);        /* SET TO BUFFER 1 ADDR  @OZ30157*/ 06423000
         AH    @15,@CH01372                                        1581 06424000
         ST    @15,QAPTR                                           1581 06425000
*   QWPTR=QAPTR(QBINDX(1));         /* SET START LOCATION    @OZ30157*/ 06426000
@RF01580 SLR   @04,@04                                             1582 06427000
         IC    @04,QBINDX                                          1582 06428000
         LR    @15,@04                                             1582 06429000
         SLA   @15,2                                               1582 06430000
         L     @00,QAPTR-4(@15)                                    1582 06431000
         ST    @00,QWPTR                                           1582 06432000
*   QCNT=QBINDX(1);                 /* TO START VALUE        @OZ30157*/ 06433000
         ST    @04,QCNT                                            1583 06434000
*/********************************************************************/ 06435000
*/*                                                                  */ 06436000
*/* BUILD AND ISSUE QUERIES AS REQUESTED UP TO MAX SPACE     @OZ30157*/ 06437000
*/*                                                                  */ 06438000
*/********************************************************************/ 06439000
*                                                                  1584 06440000
*   DO QENT=1 TO QBCNT WHILE(RETC=F0);/* LOOP THROUGH LIST   @OZ30157*/ 06441000
         LA    @04,1                                               1584 06442000
         B     @DE01584                                            1584 06443000
@DL01584 LH    @00,RETC                                            1584 06444000
         LTR   @00,@00                                             1584 06445000
         BNZ   @DC01584                                            1584 06446000
*     MVPTR=QWPTR;                  /* SET START LOCATION    @OZ30157*/ 06447000
         MVC   MVPTR(4),QWPTR                                      1585 06448000
*     QBPRMAR=QBPRMAR&&QBPRMAR;     /* CLEAR PARM AREA       @OZ30157*/ 06449000
         XC    QBPRMAR(36),QBPRMAR                                 1586 06450000
*     QBPSUB=QBPARM(QENT);          /* SET UP PARAMETER AREA @OZ30157*/ 06451000
         MH    @04,@CH01372                                        1587 06452000
         LA    @15,QBPARM-44(@04)                                  1587 06453000
         MVC   QBPSUB(4),0(@15)                                    1587 06454000
*     QBPORD=QBORD(QENT);           /* AND SAVE THE ORDER    @OZ30157*/ 06455000
         LA    @15,QBORD-44(@04)                                   1588 06456000
         MVC   QBPORD(1),0(@15)                                    1588 06457000
*     IF QBPORD='05'X&QBPTID=CZERO THEN/* IF CHR REQUEST     @OZ30157*/ 06458000
         CLI   QBPORD,X'05'                                        1589 06459000
         BNE   @RF01589                                            1589 06460000
         CLI   QBPTID,240                                          1589 06461000
         BNE   @RF01589                                            1589 06462000
*       QBCHRF='00070100'X+QBREC(QENT);/* GET START ADDRESS  @OZ30157*/ 06463000
         SLR   @00,@00                                             1590 06464000
         IC    @00,QBREC-44(@04)                                   1590 06465000
         AL    @00,@CF03336                                        1590 06466000
         ST    @00,QBCHRF                                          1590 06467000
*     ELSE                                                         1591 06468000
*       QBCHRC=''B;                 /* IF NOT, SET NULLS     @OZ30157*/ 06469000
         B     @RC01589                                            1591 06470000
@RF01589 XC    QBCHRC(4),QBCHRC                                    1591 06471000
*     DO QI=1 TO QBECNT(QENT) WHILE(RETC=F0);/* LOOP THRU QU @OZ30157*/ 06472000
@RC01589 LA    @04,1                                               1592 06473000
         B     @DE01592                                            1592 06474000
@DL01592 LH    @04,RETC                                            1592 06475000
         LTR   @04,@04                                             1592 06476000
         BNZ   @DC01592                                            1592 06477000
*       IF QWPTR>QPEND THEN         /* CHECK FOR SPACE AVAIL @OZ30157*/ 06478000
         CLC   QWPTR(4),QPEND                                      1593 06479000
         BNH   @RF01593                                            1593 06480000
*         RETC=F8;                  /* OUT OF SPACE          @OZ30157*/ 06481000
         MVC   RETC(2),@CH00036                                    1594 06482000
*       IF RETC<F8 THEN             /* IF CAN DO 1 OR MORE   @OZ30157*/ 06483000
@RF01593 LH    @04,RETC                                            1595 06484000
         CH    @04,@CH00036                                        1595 06485000
         BNL   @RF01595                                            1595 06486000
*         DO;                       /* DO THEM               @OZ30157*/ 06487000
*/********************************************************************/ 06488000
*/*                                                                  */ 06489000
*/* DETERMINE QUERY TYPE AND ISSUE PROPER ONE                @OZ30157*/ 06490000
*/*                                                                  */ 06491000
*/********************************************************************/ 06492000
*                                                                  1597 06493000
*           IF QBPORD='05'X THEN    /* IF QTAB REQUEST       @OZ30157*/ 06494000
         CLI   QBPORD,X'05'                                        1597 06495000
         BNE   @RF01597                                            1597 06496000
*             DO;                   /*                       @OZ30157*/ 06497000
*               QUERYAR=QUERYAR&&QUERYAR;/* CLEAR QUERY AREA @OZ30157*/ 06498000
         L     @04,WORKPTR                                         1599 06499000
         XC    QUERYAR(44,@04),QUERYAR(@04)                        1599 06500000
*               QUPTR=QWPTR;        /* SET ADDRESS FOR DATA  @OZ30157*/ 06501000
         MVC   QUPTR(4,@04),QWPTR                                  1600 06502000
*               QBPCHR=QBCHRC;      /* MOVE CHR              @OZ30157*/ 06503000
*                                                                  1601 06504000
         MVC   QBPCHR(4),QBCHRC                                    1601 06505000
*               /*****************************************************/ 06506000
*               /*                                                   */ 06507000
*               /* ***************************************************/ 06508000
*               /* *****                                     @Z40LB22*/ 06509000
*               /* MSSC ICBQUERY QSWCS/QLAB/QTAB/QSWCS QCEL MACRO    */ 06510000
*               /*                                           @Z40LB22*/ 06511000
*               /* OS/VS2 VERSION-- 03/21/75 LEVEL 00        @Z40LB22*/ 06512000
*               /* THIS IS THE OUTPUT FOR THE EXECUTE FORM.  @Z40LB22*/ 06513000
*               /* THE LIST FORM OF THIS MACRO SHOULD BE     @Z40LB22*/ 06514000
*               /* INVOKED FIRST IN ORDER TO SET UP NECESSARY        */ 06515000
*               /*                                           @Z40LB22*/ 06516000
*               /* DECLARES. IF THE COMPLETE ARGUMENT IS     @Z40LB22*/ 06517000
*               /* SPECIFIED THE REQ BLOCK WILL BE ZEROED.   @Z40LB22*/ 06518000
*               /* ***************************************************/ 06519000
*               /* *****                                     @Z40LB22*/ 06520000
*               /*                                                   */ 06521000
*               /*****************************************************/ 06522000
*                                                                  1602 06523000
*               RFY                                                1602 06524000
*                (QUERR1) RSTD;     /* RESTRICT R1           @Z40LB22*/ 06525000
*               QUERR1=ADDR(QUERYAR);/* SET QUERR1 TO REQ BLOCK    1603 06526000
*                                                            @Z40LB22*/ 06527000
         LR    QUERR1,@04                                          1603 06528000
*               QULEN='2C'X;        /* SET LENGTH FIELD      @Z40LB22*/ 06529000
         LA    @00,44                                              1604 06530000
         ST    @00,QULEN(,@04)                                     1604 06531000
*               QUORD='05'X;        /* SET OPCODE FIELD      @Z40LB22*/ 06532000
         MVI   QUORD(@04),X'05'                                    1605 06533000
*               QUCODE='06'X;       /* SET CODE TYPE         @Z40LB22*/ 06534000
         MVI   QUCODE(@04),X'06'                                   1606 06535000
*               QUPARM=(QBPRMAR);   /* FILL IN PARAMETERS    @Z40LB22*/ 06536000
         MVC   QUPARM(32,@04),QBPRMAR                              1607 06537000
*               SVC(126);           /* ISSUE SVC INST.       @Z40LB22*/ 06538000
         SVC   126                                                 1608 06539000
*               RFY                                                1609 06540000
*                (QUERR1) UNRSTD;   /* UNRESTRICT R1         @Z40LB22   06541000
*                                      ISSUE QTAB            @OZ30157*/ 06542000
*               RFY                                                1610 06543000
*                 R15 RSTD;         /* MUST CHECK RETURN CODE@OZ30157*/ 06544000
*               RETC=R15;           /*                       @OZ30157*/ 06545000
         STH   R15,RETC                                            1611 06546000
*               RFY                                                1612 06547000
*                 R15 UNRSTD;       /*                       @OZ30157*/ 06548000
*               IF QBPTID^=CZERO THEN/* IF NOT DASD CHR      @OZ30157*/ 06549000
         CLI   QBPTID,240                                          1613 06550000
         BE    @RF01613                                            1613 06551000
*                 QBPTVAR2=QBPTVAR2+1;/* INCREMENT POINTER   @OZ30157*/ 06552000
         IC    @04,QBPTVAR2                                        1614 06553000
         LA    @04,1(,@04)                                         1614 06554000
         STC   @04,QBPTVAR2                                        1614 06555000
*               ELSE                /* IF IT IS, INCREMENT   @OZ30157*/ 06556000
*                 DO;               /* ADDRESS               @OZ30157*/ 06557000
         B     @RC01613                                            1615 06558000
@RF01613 DS    0H                                                  1616 06559000
*                   QBPREC=QBPREC+1;/* TO NEXT VALID RECORD  @OZ30157*/ 06560000
         LA    @04,1                                               1616 06561000
         SLR   @00,@00                                             1616 06562000
         IC    @00,QBPREC                                          1616 06563000
         ALR   @00,@04                                             1616 06564000
         STC   @00,QBPREC                                          1616 06565000
*                   IF QBPREC>32 THEN/* IF PAST TRACK        @OZ30157*/ 06566000
         CLI   QBPREC,32                                           1617 06567000
         BNH   @RF01617                                            1617 06568000
*                     DO;           /* ADD TO TRACK ADDRESS  @OZ30157*/ 06569000
*                       QBPREC=1;   /* AND SET REC TO 1      @OZ30157*/ 06570000
         MVI   QBPREC,X'01'                                        1619 06571000
*                       QBPHD=QBPHD+1;/*                     @OZ30157*/ 06572000
         SLR   @00,@00                                             1620 06573000
         IC    @00,QBPHD                                           1620 06574000
         ALR   @00,@04                                             1620 06575000
         STC   @00,QBPHD                                           1620 06576000
*                       IF QBPHD>19 THEN/* IF PAST CYL BOUND @OZ30157*/ 06577000
         CLI   QBPHD,19                                            1621 06578000
         BNH   @RF01621                                            1621 06579000
*                         DO;       /* BUMP CYL              @OZ30157*/ 06580000
*                           QBPHD=0;/* SET TRACK             @OZ30157*/ 06581000
         MVI   QBPHD,X'00'                                         1623 06582000
*                           QBPCYL=QBPCYL+1;/* AND BUMP CYL  @OZ30157*/ 06583000
         MVC   @ZT00003+3(1),QBPCYL                                1624 06584000
         AL    @04,@ZT00003                                        1624 06585000
         STC   @04,QBPCYL                                          1624 06586000
*                         END;      /* END CYL ADJUST        @OZ30157*/ 06587000
*                     END;          /* END TRACK ADJUST      @OZ30157*/ 06588000
*                 END;              /* END RECORD ADJUST     @OZ30157*/ 06589000
*             END;                  /* END QTAB              @OZ30157*/ 06590000
*           ELSE                    /* NOT QTAB,             @OZ30157*/ 06591000
*             IF QBPORD='07'X THEN  /* IS IT QCEL            @OZ30157*/ 06592000
         B     @RC01597                                            1629 06593000
@RF01597 CLI   QBPORD,X'07'                                        1629 06594000
         BNE   @RF01629                                            1629 06595000
*               DO;                 /* YES, ISSUE IT         @OZ30157*/ 06596000
*                 QUERYAR=QUERYAR&&QUERYAR;/* CLEAR THE AIR  @OZ30157*/ 06597000
         L     @04,WORKPTR                                         1631 06598000
         XC    QUERYAR(44,@04),QUERYAR(@04)                        1631 06599000
*                 QUPTR=QWPTR;      /* POINT TO AREA         @OZ30157*/ 06600000
*                                                                  1632 06601000
         MVC   QUPTR(4,@04),QWPTR                                  1632 06602000
*                 /***************************************************/ 06603000
*                 /*                                                 */ 06604000
*                 /* *************************************************/ 06605000
*                 /* *******                                 @Z40LB22*/ 06606000
*                 /* MSSC ICBQUERY QSWCS/QLAB/QTAB/QSWCS QCEL MACRO  */ 06607000
*                 /*                                         @Z40LB22*/ 06608000
*                 /* OS/VS2 VERSION-- 03/21/75 LEVEL 00      @Z40LB22*/ 06609000
*                 /* THIS IS THE OUTPUT FOR THE EXECUTE FORM.        */ 06610000
*                 /*                                         @Z40LB22*/ 06611000
*                 /* THE LIST FORM OF THIS MACRO SHOULD BE   @Z40LB22*/ 06612000
*                 /* INVOKED FIRST IN ORDER TO SET UP NECESSARY      */ 06613000
*                 /*                                         @Z40LB22*/ 06614000
*                 /* DECLARES. IF THE COMPLETE ARGUMENT IS   @Z40LB22*/ 06615000
*                 /* SPECIFIED THE REQ BLOCK WILL BE ZEROED. @Z40LB22*/ 06616000
*                 /* *************************************************/ 06617000
*                 /* *******                                 @Z40LB22*/ 06618000
*                 /*                                                 */ 06619000
*                 /***************************************************/ 06620000
*                                                                  1633 06621000
*                 RFY                                              1633 06622000
*                  (QUERR1) RSTD;   /* RESTRICT R1           @Z40LB22*/ 06623000
*                 QUERR1=ADDR(QUERYAR);/* SET QUERR1 TO REQ BLOCK  1634 06624000
*                                                            @Z40LB22*/ 06625000
         LR    QUERR1,@04                                          1634 06626000
*                 QULEN='2C'X;      /* SET LENGTH FIELD      @Z40LB22*/ 06627000
         LA    @00,44                                              1635 06628000
         ST    @00,QULEN(,@04)                                     1635 06629000
*                 QUORD='07'X;      /* SET OPCODE FIELD      @Z40LB22*/ 06630000
         MVI   QUORD(@04),X'07'                                    1636 06631000
*                 QUXADDR=(QBPTID); /* FILL IN X ADDR        @Z40LB22*/ 06632000
         MVC   QUXADDR(1,@04),QBPTID                               1637 06633000
*                 QUPARM=(MAP);     /* FILL IN CELL BIT MAP  @Z40LB22*/ 06634000
         MVC   QUPARM(32,@04),MAP                                  1638 06635000
*                 SVC(126);         /* ISSUE SVC INST.       @Z40LB22*/ 06636000
         SVC   126                                                 1639 06637000
*                 RFY                                              1640 06638000
*                  (QUERR1) UNRSTD; /* UNRESTRICT R1         @Z40LB22   06639000
*                                      ISSUE QCEL            @OZ30157*/ 06640000
*                 RFY                                              1641 06641000
*                   R15 RSTD;       /* MUST CHECK RETURN CODE@OZ30157*/ 06642000
*                 RETC=R15;         /*                       @OZ30157*/ 06643000
         STH   R15,RETC                                            1642 06644000
*                 RFY                                              1643 06645000
*                   R15 UNRSTD;     /*                       @OZ30157*/ 06646000
*               END;                /* END QCEL DO           @OZ30157*/ 06647000
*             ELSE                  /*                       @OZ30157*/ 06648000
*               DO;                 /* MUST BE QMWCS         @OZ30157*/ 06649000
         B     @RC01629                                            1645 06650000
@RF01629 DS    0H                                                  1646 06651000
*                 QUERYAR=QUERYAR&&QUERYAR;/* CLEAR QUERY AREA     1646 06652000
*                                                            @OZ30157*/ 06653000
         L     @04,WORKPTR                                         1646 06654000
         XC    QUERYAR(44,@04),QUERYAR(@04)                        1646 06655000
*                 QUPTR=QWPTR;      /* SET AREA POINTER      @OZ30157*/ 06656000
*                                                                  1647 06657000
         MVC   QUPTR(4,@04),QWPTR                                  1647 06658000
*                 /***************************************************/ 06659000
*                 /*                                                 */ 06660000
*                 /* *************************************************/ 06661000
*                 /* *******                                 @Z40LB22*/ 06662000
*                 /* MSSC ICBQUERY QSWCS/QLAB/QTAB/QSWCS QCEL MACRO  */ 06663000
*                 /*                                         @Z40LB22*/ 06664000
*                 /* OS/VS2 VERSION-- 03/21/75 LEVEL 00      @Z40LB22*/ 06665000
*                 /* THIS IS THE OUTPUT FOR THE EXECUTE FORM.        */ 06666000
*                 /*                                         @Z40LB22*/ 06667000
*                 /* THE LIST FORM OF THIS MACRO SHOULD BE   @Z40LB22*/ 06668000
*                 /* INVOKED FIRST IN ORDER TO SET UP NECESSARY      */ 06669000
*                 /*                                         @Z40LB22*/ 06670000
*                 /* DECLARES. IF THE COMPLETE ARGUMENT IS   @Z40LB22*/ 06671000
*                 /* SPECIFIED THE REQ BLOCK WILL BE ZEROED. @Z40LB22*/ 06672000
*                 /* *************************************************/ 06673000
*                 /* *******                                 @Z40LB22*/ 06674000
*                 /*                                                 */ 06675000
*                 /***************************************************/ 06676000
*                                                                  1648 06677000
*                 RFY                                              1648 06678000
*                  (QUERR1) RSTD;   /* RESTRICT R1           @Z40LB22*/ 06679000
*                 QUERR1=ADDR(QUERYAR);/* SET QUERR1 TO REQ BLOCK  1649 06680000
*                                                            @Z40LB22*/ 06681000
         LR    QUERR1,@04                                          1649 06682000
*                 QULEN='2C'X;      /* SET LENGTH FIELD      @Z40LB22*/ 06683000
         LA    @00,44                                              1650 06684000
         ST    @00,QULEN(,@04)                                     1650 06685000
*                 QUORD='0B'X;      /* SET OPCODE FIELD      @Z40LB22*/ 06686000
         MVI   QUORD(@04),X'0B'                                    1651 06687000
*                 QUCODE='03'X;     /* SET CODE TYPE         @Z40LB22*/ 06688000
         MVI   QUCODE(@04),X'03'                                   1652 06689000
*                 QUSECT=(QBPTID);  /* FILL IN SECTOR ID     @Z40LB22*/ 06690000
         MVC   QUSECT(1,@04),QBPTID                                1653 06691000
*                 QWFLAG=(QBPTRD);  /* FILL IN FLAGS FIELD   @ZA09556*/ 06692000
         MVC   QWFLAG(1,@04),QBPTRD                                1654 06693000
*                 SVC(126);         /* ISSUE SVC INST.       @Z40LB22*/ 06694000
         SVC   126                                                 1655 06695000
*                 RFY                                              1656 06696000
*                  (QUERR1) UNRSTD; /* UNRESTRICT R1         @Z40LB22   06697000
*                                      ISSUE QMWCS           @OZ30157*/ 06698000
*                 RFY                                              1657 06699000
*                   R15 RSTD;       /* MUST CHECK RETURN CODE@OZ30157*/ 06700000
*                 RETC=R15;         /*                       @OZ30157*/ 06701000
         STH   R15,RETC                                            1658 06702000
*                 RFY                                              1659 06703000
*                   R15 UNRSTD;     /*                       @OZ30157*/ 06704000
*                 QBPTID=QBPTID+F1; /* INCREMENT SECTOR ADR  @OZ30157*/ 06705000
         IC    @04,QBPTID                                          1660 06706000
         LA    @04,1(,@04)                                         1660 06707000
         STC   @04,QBPTID                                          1660 06708000
*               END;                /* END QMWCS             @OZ30157*/ 06709000
*/* ******************************************************************  06710000
*                                                                    */ 06711000
*/*                                                                  */ 06712000
*/*  IF QUERY WAS UNSUCCESSFUL, TELL CALLER VIA RETURN CODE   @OZ30157  06713000
*                                                                    */ 06714000
*/*                                                                  */ 06715000
*/* ******************************************************************  06716000
*                                                                    */ 06717000
*                                                                  1662 06718000
*           IF RETC=F0 THEN         /* IF GOOD QUERY         @OZ30157*/ 06719000
@RC01629 DS    0H                                                  1662 06720000
@RC01597 SLR   @04,@04                                             1662 06721000
         CH    @04,RETC                                            1662 06722000
         BNE   @RF01662                                            1662 06723000
*             IF QBMAP(QENT)^=F0 THEN/* IF ANY MOVE MAP      @OZ30157*/ 06724000
         LH    @15,QENT                                            1663 06725000
         MH    @15,@CH01372                                        1663 06726000
         L     @15,QBMAP-45(@15)                                   1663 06727000
         LA    @15,0(,@15)                                         1663 06728000
         LTR   @15,@15                                             1663 06729000
         BZ    @RF01663                                            1663 06730000
*               DO;                 /* MOVE PER MOVE MAP     @OZ30157*/ 06731000
*                 MAPPTR=QBMAP(QENT);/* SET MAP POINTER      @OZ30157*/ 06732000
         ST    @15,MAPPTR                                          1665 06733000
*                 M2B=F1;           /* FIRST POSITION        @OZ30157*/ 06734000
         LA    @14,1                                               1666 06735000
         STH   @14,M2B                                             1666 06736000
*                 QMCT=MOVEMAP(1)*F2;/* GET COUNT OF MOVES*2 @OZ30157*/ 06737000
         LH    @00,MOVEMAP(,@15)                                   1667 06738000
         ALR   @00,@00                                             1667 06739000
         STH   @00,QMCT                                            1667 06740000
*                 IF QMCT>F0 THEN   /* IF MOVE REQUIRED      @OZ30157*/ 06741000
         CR    @00,@04                                             1668 06742000
         BNH   @RF01668                                            1668 06743000
*                   DO;             /*                       @OZ30157*/ 06744000
*                     M2E=F1;       /* AVOID ERROR MESSAGE   @OZ30157*/ 06745000
         STH   @14,M2E                                             1670 06746000
*                     DO QMI=2 TO QMCT BY 2;/* LOOP THRU MOVES     1671 06747000
*                                                            @OZ30157*/ 06748000
         LA    @04,2                                               1671 06749000
         STH   @04,QMI                                             1671 06750000
         B     @DE01671                                            1671 06751000
@DL01671 DS    0H                                                  1672 06752000
*                       MFE=MOVEMAP(QMI+1);/* LENGTH OF MOVE -1    1672 06753000
*                                                            @OZ30157*/ 06754000
         L     @15,MAPPTR                                          1672 06755000
         ALR   @04,@04                                             1672 06756000
         LH    @00,MOVEMAP(@04,@15)                                1672 06757000
         STH   @00,MFE                                             1672 06758000
*                       MFB=MOVEMAP(QMI)+1;/* START OF MOVE  @OZ30157*/ 06759000
         LA    @14,1                                               1673 06760000
         BCTR  @15,0                                               1673 06761000
         BCTR  @15,0                                               1673 06762000
         AH    @14,MOVEMAP(@04,@15)                                1673 06763000
         STH   @14,MFB                                             1673 06764000
*                       M2E=M2B+MFE-1;/* LAST POS IN RCVR    @OZ30157*/ 06765000
         AH    @00,M2B                                             1674 06766000
         BCTR  @00,0                                               1674 06767000
         STH   @00,M2E                                             1674 06768000
*                       IF QBPORD='05'X THEN/* IF QTAB THEN  @OZ30157*/ 06769000
         CLI   QBPORD,X'05'                                        1675 06770000
         BNE   @RF01675                                            1675 06771000
*                         MFB=MFB+256;/* USE LAST HALF OF BFR      1676 06772000
*                                                            @OZ30157*/ 06773000
         LA    @14,256(,@14)                                       1676 06774000
         STH   @14,MFB                                             1676 06775000
*                       MFE=MFE+MFB-1;/* LAST POS IN SOURCE  @OZ30157*/ 06776000
@RF01675 LH    @04,MFB                                             1677 06777000
         LH    @00,MFE                                             1677 06778000
         ALR   @00,@04                                             1677 06779000
         BCTR  @00,0                                               1677 06780000
         STH   @00,MFE                                             1677 06781000
*                       MVREC(M2B:M2E)=MVSRC(MFB:MFE);/* MOVE      1678 06782000
*                                                            @OZ30157*/ 06783000
         LH    @15,M2B                                             1678 06784000
         L     @14,MVPTR                                           1678 06785000
         ALR   @14,@15                                             1678 06786000
         BCTR  @14,0                                               1678 06787000
         LH    @03,M2E                                             1678 06788000
         LCR   @15,@15                                             1678 06789000
         ALR   @15,@03                                             1678 06790000
         L     @02,QWPTR                                           1678 06791000
         ALR   @02,@04                                             1678 06792000
         BCTR  @02,0                                               1678 06793000
         EX    @15,@SM03659                                        1678 06794000
*                       M2B=M2E+1;  /* BUMP TO NEXT FIELD    @OZ30157*/ 06795000
         LA    @03,1(,@03)                                         1679 06796000
         STH   @03,M2B                                             1679 06797000
*                     END;          /* LOOP MOVES            @OZ30157*/ 06798000
         LA    @04,2                                               1680 06799000
         AH    @04,QMI                                             1680 06800000
         STH   @04,QMI                                             1680 06801000
@DE01671 CH    @04,QMCT                                            1680 06802000
         BNH   @DL01671                                            1680 06803000
*                     MVPTR=MVPTR+M2E;/* SET NEXT MOVE AREA  @OZ30157*/ 06804000
         LH    @04,M2E                                             1681 06805000
         AL    @04,MVPTR                                           1681 06806000
         ST    @04,MVPTR                                           1681 06807000
*                   END;            /* END MOVES             @OZ30157*/ 06808000
*               END;                /* END MOVE MAP          @OZ30157*/ 06809000
*             ELSE                  /* IF NO MOVE MAP, THEN  @OZ30157*/ 06810000
*               DO;                 /* USE ALL 256 BYTES     @OZ30157*/ 06811000
         B     @RC01663                                            1684 06812000
@RF01663 DS    0H                                                  1685 06813000
*                 IF QBPORD='05'X THEN/* IF QTAB REQUEST     @OZ30157*/ 06814000
         CLI   QBPORD,X'05'                                        1685 06815000
         BNE   @RF01685                                            1685 06816000
*                   MVREC(1:256)=MVSRC(257:512);/* MOVE 256 BYTES  1686 06817000
*                                                            @OZ30157*/ 06818000
         L     @04,MVPTR                                           1686 06819000
         L     @15,QWPTR                                           1686 06820000
         MVC   MVREC(256,@04),MVSRC+256(@15)                       1686 06821000
*                 MVPTR=MVPTR+256;  /* BUMP MOVE POINTER     @OZ30157*/ 06822000
@RF01685 LA    @04,256                                             1687 06823000
         AL    @04,MVPTR                                           1687 06824000
         ST    @04,MVPTR                                           1687 06825000
*               END;                /* END MOVE ALL          @OZ30157*/ 06826000
*         END;                      /* END ISSUE QUERY       @OZ30157*/ 06827000
@RC01663 DS    0H                                                  1689 06828000
@RF01662 DS    0H                                                  1690 06829000
*       QWPTR=MVPTR;                /* TO NEXT QUERY AREA    @OZ30157*/ 06830000
@RF01595 L     @04,MVPTR                                           1690 06831000
         ST    @04,QWPTR                                           1690 06832000
*       QCNT=QCNT+F1;               /* BUMP COUNT FOR NEXT   @OZ30157*/ 06833000
         LA    @00,1                                               1691 06834000
         AL    @00,QCNT                                            1691 06835000
         ST    @00,QCNT                                            1691 06836000
*       QAPTR(QCNT)=QWPTR;          /* AND SET NEXT QAPTR    @OZ30157*/ 06837000
         SLA   @00,2                                               1692 06838000
         LR    @15,@00                                             1692 06839000
         ST    @04,QAPTR-4(@15)                                    1692 06840000
*     END;                          /* END ENTRY LOOP        @OZ30157*/ 06841000
         LA    @04,1                                               1693 06842000
         AH    @04,QI                                              1693 06843000
@DE01592 STH   @04,QI                                              1693 06844000
         LH    @15,QENT                                            1693 06845000
         MH    @15,@CH01372                                        1693 06846000
         LA    @14,QBECNT-44(@15)                                  1693 06847000
         MVC   @ZT00003+3(1),0(@14)                                1693 06848000
         C     @04,@ZT00003                                        1693 06849000
         BNH   @DL01592                                            1693 06850000
@DC01592 DS    0H                                                  1694 06851000
*   END;                            /* END LIST LOOP         @OZ30157*/ 06852000
         LA    @04,1                                               1694 06853000
         AH    @04,QENT                                            1694 06854000
@DE01584 STH   @04,QENT                                            1694 06855000
         C     @04,QBCNT                                           1694 06856000
         BNH   @DL01584                                            1694 06857000
@DC01584 DS    0H                                                  1695 06858000
*   RFY                                                            1695 06859000
*     R14 RSTD;                     /*                       @OZ30157*/ 06860000
*   R14=MS56GQ14;                   /* RESTORE RETURN REG    @OZ30157*/ 06861000
         L     R14,MS56GQ14                                        1696 06862000
*   RFY                                                            1697 06863000
*     R14 UNRSTD;                   /*                       @OZ30157*/ 06864000
*   RETURN;                         /* BACK TO CALLER        @OZ30157*/ 06865000
@EL00007 DS    0H                                                  1698 06866000
@EF00007 DS    0H                                                  1698 06867000
@ER00007 BR    @14                                                 1698 06868000
*   END MSG56GQ;                    /* END GET/QUERY ROUTINE @OZ30157*/ 06869000
*MSG56B:                                                           1700 06870000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Z40LB01*/ 06871000
MSG56B   DS    0H                                                  1701 06872000
*/*********************************************************  @Z40LB01*/ 06873000
*/*                                                          @Z40LB01*/ 06874000
*/* PROCEDURE NAME - MSG56B                                  @Z40LB01*/ 06875000
*/*                                                          @Z40LB01*/ 06876000
*/* FUNCTION - FOR DASD SSIDS, THE MSC SDG PAB MUST BE READ  @Z40LB01*/ 06877000
*/*            FOR THE SDG AND A TABLE OF STATUS FOR EACH    @Z40LB01*/ 06878000
*/*            SSID TO BE DISPLAYED BUILT. THIS IS NECESSARY @Z40LB01*/ 06879000
*/*            TO REDUCE THE AMOUNT OF CODE EXECUTED BETWEEN @Z40LB01*/ 06880000
*/*            ISSUING THE ML WTO FOR EACH DISPLAY GROUP.    @Z40LB01*/ 06881000
*/*                                                          @Z40LB01*/ 06882000
*/* INPUTS - INTERNAL FIELDS INITIALIZED BY ICBMSG56.        @Z40LB01*/ 06883000
*/*                                                          @Z40LB01*/ 06884000
*/* OUTPUTS - DASD SSID STATUS TABLE ENTRIES FOR EACH SSID   @Z40LB01*/ 06885000
*/*           TO BE DISPLAYED.                               @Z40LB01*/ 06886000
*/*                                                          @Z40LB01*/ 06887000
*/*********************************************************  @Z40LB01*/ 06888000
*                                                                  1701 06889000
*   DCL                                                            1701 06890000
*     MSG56B14 FIXED(31);           /* LOCAL RETURN REG SAVE @Z40LB01*/ 06891000
*   RFY                                                            1702 06892000
*     R14 RSTD;                     /* RESTRICT REG 14       @Z40LB01*/ 06893000
*   MSG56B14=R14;                   /*                       @Z40LB01*/ 06894000
         ST    R14,MSG56B14                                        1703 06895000
*   RFY                                                            1704 06896000
*     R14 UNRSTD;                   /* FREE REG 14           @Z40LB01*/ 06897000
*   DO I=F1 TO F28;                 /* SCAN BY SDG           @Z40LB01*/ 06898000
         LA    @04,1                                               1705 06899000
         STH   @04,I                                               1705 06900000
@DL01705 DS    0H                                                  1706 06901000
*     IF SDGREQ(I)^=F0 THEN         /* ANY REQUESTS THIS SDG @Z40LB01*/ 06902000
         SLR   @00,@00                                             1706 06903000
         IC    @00,SDGREQ-1(@04)                                   1706 06904000
         CH    @00,@CH00226                                        1706 06905000
         BE    @RF01706                                            1706 06906000
*       DO;                         /* READ MSC PAB TABLE    @Z40LB01*/ 06907000
*         TABSDG=I-F1;              /* SET SDG NUMBER        @Z40LB01*/ 06908000
         BCTR  @04,0                                               1708 06909000
         STC   @04,TABSDG                                          1708 06910000
*         QUERYAR=''B;              /* CLEAR PARM AREA       @OZ30157*/ 06911000
         L     @04,WORKPTR                                         1709 06912000
         XC    QUERYAR(44,@04),QUERYAR(@04)                        1709 06913000
*         PABPTR=ADDR(QUBUF3)+256;  /* SET POINTER FOR PAB   @OZ30157*/ 06914000
         AH    @04,@CH03604                                        1710 06915000
         ST    @04,PABPTR                                          1710 06916000
*IQUERY1:                                                          1711 06917000
*                                                                  1711 06918000
*         /***********************************************************/ 06919000
*         /*                                                         */ 06920000
*         /* ******************************************************* */ 06921000
*         /*                                                 @Z40LB22*/ 06922000
*         /* MSSC ICBQUERY QSWCS/QLAB/QTAB/QSWCS QCEL MACRO  @Z40LB22*/ 06923000
*         /* OS/VS2 VERSION-- 03/21/75 LEVEL 00              @Z40LB22*/ 06924000
*         /* THIS IS THE OUTPUT FOR THE EXECUTE FORM.        @Z40LB22*/ 06925000
*         /* THE LIST FORM OF THIS MACRO SHOULD BE           @Z40LB22*/ 06926000
*         /* INVOKED FIRST IN ORDER TO SET UP NECESSARY      @Z40LB22*/ 06927000
*         /* DECLARES. IF THE COMPLETE ARGUMENT IS           @Z40LB22*/ 06928000
*         /* SPECIFIED THE REQ BLOCK WILL BE ZEROED.         @Z40LB22*/ 06929000
*         /* ******************************************************* */ 06930000
*         /*                                                 @Z40LB22*/ 06931000
*         /*                                                         */ 06932000
*         /***********************************************************/ 06933000
*                                                                  1711 06934000
*         RFY                                                      1711 06935000
*          (QUERR1) RSTD;           /* RESTRICT R1           @Z40LB22*/ 06936000
IQUERY1  DS    0H                                                  1712 06937000
*         QUERR1=ADDR(QUERYAR);     /* SET QUERR1 TO REQ BLOCK     1712 06938000
*                                                            @Z40LB22*/ 06939000
         L     @04,WORKPTR                                         1712 06940000
         LR    QUERR1,@04                                          1712 06941000
*         QULEN='2C'X;              /* SET LENGTH FIELD      @Z40LB22*/ 06942000
         LA    @00,44                                              1713 06943000
         ST    @00,QULEN(,@04)                                     1713 06944000
*         QUORD='05'X;              /* SET OPCODE FIELD      @Z40LB22*/ 06945000
         MVI   QUORD(@04),X'05'                                    1714 06946000
*         QUCODE='06'X;             /* SET CODE TYPE         @Z40LB22*/ 06947000
         MVI   QUCODE(@04),X'06'                                   1715 06948000
*         QUPARM=(TABPARM);         /* FILL IN PARAMETERS    @Z40LB22*/ 06949000
         MVI   QUPARM+20(@04),C' '                                 1716 06950000
         MVC   QUPARM+21(11,@04),QUPARM+20(@04)                    1716 06951000
         MVC   QUPARM(20,@04),TABPARM                              1716 06952000
*         QUPTR=ADDR(QUBUF3);       /* ADDR OF DATAPTR FIELD @Z40LB22*/ 06953000
         LA    @00,1488                                            1717 06954000
         ALR   @00,@04                                             1717 06955000
         ST    @00,QUPTR(,@04)                                     1717 06956000
*         SVC(126);                 /* ISSUE SVC INST.       @Z40LB22*/ 06957000
         SVC   126                                                 1718 06958000
*         RFY                                                      1719 06959000
*          (QUERR1) UNRSTD;         /* UNRESTRICT R1         @Z40LB22*/ 06960000
*                                                                  1719 06961000
*         /***********************************************************/ 06962000
*         /*                                                         */ 06963000
*         /*                                                 @OZ30157*/ 06964000
*         /*                                                         */ 06965000
*         /***********************************************************/ 06966000
*                                                                  1720 06967000
*         RFY                                                      1720 06968000
*           R15 RSTD;               /* RESTRICT REG 15       @Z40LB01*/ 06969000
*         IF R15^=F0 THEN           /* CHECK FOR ERROR       @Z40LB01*/ 06970000
         LTR   R15,R15                                             1721 06971000
         BZ    @RF01721                                            1721 06972000
*           DO;                     /* PROCESS ERROR         @Z40LB01*/ 06973000
*             RFY                                                  1723 06974000
*               R15 UNRSTD;         /* FREE REG 15           @Z40LB01*/ 06975000
*             DO K=F1 TO F8;        /* SCAN BY SSID          @Z40LB01*/ 06976000
         LA    @04,1                                               1724 06977000
         STH   @04,K                                               1724 06978000
@DL01724 DS    0H                                                  1725 06979000
*               IF CONFGMSK(K)=(SDGREQ(I)&CONFGMSK(K)) THEN/*      1725 06980000
*                                                            @Z40LB01*/ 06981000
         L     @15,@CA01312                                        1725 06982000
         LH    @14,I                                               1725 06983000
         LA    @03,SDGREQ-1(@14)                                   1725 06984000
         MVC   @TS00001(1),0(@03)                                  1725 06985000
         ST    @04,@TF00001                                        1725 06986000
         ALR   @04,@15                                             1725 06987000
         BCTR  @04,0                                               1725 06988000
         NC    @TS00001(1),CONFGMSK-CONFGMSK(@04)                  1725 06989000
         AL    @15,@TF00001                                        1725 06990000
         BCTR  @15,0                                               1725 06991000
         CLC   CONFGMSK-CONFGMSK(1,@15),@TS00001                   1725 06992000
         BNE   @RF01725                                            1725 06993000
*                 STATFLG((I-1)*8+K)='*';/* ERROR IND        @Z40LB01*/ 06994000
         BCTR  @14,0                                               1726 06995000
         SLA   @14,3                                               1726 06996000
         AL    @14,@TF00001                                        1726 06997000
         MH    @14,@CH00060                                        1726 06998000
         L     @04,WORKPTR                                         1726 06999000
         ALR   @04,@14                                             1726 07000000
         MVI   STATFLG+41(@04),C'*'                                1726 07001000
*             END;                  /* END SSID SCAN         @Z40LB01*/ 07002000
@RF01725 LA    @04,1                                               1727 07003000
         AH    @04,K                                               1727 07004000
         STH   @04,K                                               1727 07005000
         CH    @04,@CH00036                                        1727 07006000
         BNH   @DL01724                                            1727 07007000
*           END;                    /* END ERROR PROC        @Z40LB01*/ 07008000
*         ELSE                      /* GOOD RETURN           @Z40LB01*/ 07009000
*           DO K=F1 TO F8;          /* SCAN BY SSID          @Z40LB01*/ 07010000
         B     @RC01721                                            1729 07011000
@RF01721 LA    @04,1                                               1729 07012000
         STH   @04,K                                               1729 07013000
@DL01729 DS    0H                                                  1730 07014000
*             IF CONFGMSK(K)=(SDGREQ(I)&CONFGMSK(K)) THEN/*  @Z40LB01*/ 07015000
         L     @15,@CA01312                                        1730 07016000
         LH    @14,I                                               1730 07017000
         LA    @03,SDGREQ-1(@14)                                   1730 07018000
         MVC   @TS00001(1),0(@03)                                  1730 07019000
         ST    @04,@TF00001                                        1730 07020000
         ALR   @04,@15                                             1730 07021000
         BCTR  @04,0                                               1730 07022000
         NC    @TS00001(1),CONFGMSK-CONFGMSK(@04)                  1730 07023000
         LR    @04,@15                                             1730 07024000
         AL    @04,@TF00001                                        1730 07025000
         BCTR  @04,0                                               1730 07026000
         CLC   CONFGMSK-CONFGMSK(1,@04),@TS00001                   1730 07027000
         BNE   @RF01730                                            1730 07028000
*               DO;                 /* BUILD STAT TBL ENTRY  @Z40LB01*/ 07029000
*                                                                  1731 07030000
*                 /***************************************************/ 07031000
*                 /*                                                 */ 07032000
*                 /* BUILD STATUS TABLE ENTRY FOR SSID       @Z40LB01*/ 07033000
*                 /*                                                 */ 07034000
*                 /***************************************************/ 07035000
*                                                                  1732 07036000
*                 STATFLG((I-1)*8+K)=PABFLG(K);/* FLAGS FR PAB     1732 07037000
*                                                            @Z40LB01*/ 07038000
         BCTR  @14,0                                               1732 07039000
         SLA   @14,3                                               1732 07040000
         AL    @14,@TF00001                                        1732 07041000
         MH    @14,@CH00060                                        1732 07042000
         LA    @04,44                                              1732 07043000
         AL    @04,WORKPTR                                         1732 07044000
         ST    @14,@TF00002                                        1732 07045000
         ALR   @14,@04                                             1732 07046000
         AL    @14,@CF03655                                        1732 07047000
         L     @03,PABPTR                                          1732 07048000
         L     @02,@TF00001                                        1732 07049000
         SLA   @02,2                                               1732 07050000
         ST    @02,@TF00001                                        1732 07051000
         ALR   @02,@03                                             1732 07052000
         MVC   STATFLG(1,@14),PABFLG-4(@02)                        1732 07053000
*                 STATUNIT((I-1)*8+K)=PABUNIT(K);/* UNITS FR PAB   1733 07054000
*                                                            @Z40LB01*/ 07055000
*                                                                  1733 07056000
         LR    @14,@04                                             1733 07057000
         AL    @14,@TF00002                                        1733 07058000
         BCTR  @14,0                                               1733 07059000
         BCTR  @14,0                                               1733 07060000
         LR    @02,@03                                             1733 07061000
         AL    @02,@TF00001                                        1733 07062000
         MVC   STATUNIT-1(2,@14),PABUNIT-4(@02)                    1733 07063000
*                 /***************************************************/ 07064000
*                 /*                                                 */ 07065000
*                 /* THE MSC PAB FLAG BIT FOR 3330 MOD 2 SECOND      */ 07066000
*                 /*                                         @Z40LB01*/ 07067000
*                 /* HALF (BIT(7)) IS BEING OVERLAID IN THE NEXT     */ 07068000
*                 /*                                         @Z40LB01*/ 07069000
*                 /* CODE. THIS BIT IS BEING USED TO KEEP TRACK      */ 07070000
*                 /*                                         @Z40LB01*/ 07071000
*                 /* OF THE CONVERTABLE STATUS OF THE SSID. IF       */ 07072000
*                 /*                                         @Z40LB01*/ 07073000
*                 /* THIS BIT IS NOT USED, AN ADDITIONAL 224 @Z40LB01*/ 07074000
*                 /* BYTES WILL BE REQUIRED IN THE STATUS TABLE      */ 07075000
*                 /*                                         @Z40LB01*/ 07076000
*                 /* TO STORE THE PAB REAL INTERFACE BYTE.   @Z40LB01*/ 07077000
*                 /*                                                 */ 07078000
*                 /***************************************************/ 07079000
*                                                                  1734 07080000
*                 IF PABRI(K)^=HEX00 THEN/* NON ZERO         @Z40LB01*/ 07081000
         AL    @03,@TF00001                                        1734 07082000
         CLI   PABRI-4(@03),X'00'                                  1734 07083000
         BE    @RF01734                                            1734 07084000
*                   STATFLG((I-1)*8+K)=/*                    @Z40LB01*/ 07085000
*                       (STATFLG((I-1)*8+K)|CONFGMSK(8));/*  @Z40LB01*/ 07086000
         AL    @04,@TF00002                                        1735 07087000
         AL    @04,@CF03655                                        1735 07088000
         OC    STATFLG(1,@04),CONFGMSK-CONFGMSK+7(@15)             1735 07089000
*                 ELSE              /* MAKE SURE BIT OFF     @Z40LB01*/ 07090000
*                   STATFLG((I-1)*8+K)=/*                    @Z40LB01*/ 07091000
*                       (STATFLG((I-1)*8+K)&'FE'X);/* CLEAR BIT    1736 07092000
*                                                            @Z40LB01*/ 07093000
         B     @RC01734                                            1736 07094000
@RF01734 LH    @04,I                                               1736 07095000
         BCTR  @04,0                                               1736 07096000
         SLA   @04,3                                               1736 07097000
         AH    @04,K                                               1736 07098000
         MH    @04,@CH00060                                        1736 07099000
         L     @15,WORKPTR                                         1736 07100000
         ALR   @15,@04                                             1736 07101000
         NI    STATFLG+41(@15),X'FE'                               1736 07102000
*               END;                /* END STAT ENTRY        @Z40LB01*/ 07103000
@RC01734 DS    0H                                                  1738 07104000
*           END;                    /* END SSID SCAN         @Z40LB01*/ 07105000
@RF01730 LA    @04,1                                               1738 07106000
         AH    @04,K                                               1738 07107000
         STH   @04,K                                               1738 07108000
         CH    @04,@CH00036                                        1738 07109000
         BNH   @DL01729                                            1738 07110000
*       END;                        /* END THIS SDG          @Z40LB01*/ 07111000
@RC01721 DS    0H                                                  1740 07112000
*   END;                            /* END SDG TBL BUILD     @Z40LB01*/ 07113000
@RF01706 LA    @04,1                                               1740 07114000
         AH    @04,I                                               1740 07115000
         STH   @04,I                                               1740 07116000
         CH    @04,@CH01339                                        1740 07117000
         BNH   @DL01705                                            1740 07118000
*   RFY                                                            1741 07119000
*     R14 RSTD;                     /* RESTRICT REG 14       @Z40LB01*/ 07120000
*   R14=MSG56B14;                   /* RESTORE RETURN REG    @Z40LB01*/ 07121000
         L     R14,MSG56B14                                        1742 07122000
*   RFY                                                            1743 07123000
*     R14 UNRSTD;                   /* FREE REG 14           @Z40LB01*/ 07124000
*   RETURN;                         /* RETURN TO ICBMSG56    @Z40LB01*/ 07125000
@EL00008 DS    0H                                                  1744 07126000
@EF00008 DS    0H                                                  1744 07127000
@ER00008 BR    @14                                                 1744 07128000
*   END MSG56B;                     /* END MSG56B SUB        @Z40LB01*/ 07129000
*                                                                  1746 07130000
*/************ SUBROUTINE MSG56AA ***********                @OZ30157*/ 07131000
*                                                                  1746 07132000
*MSG56AA:                                                          1746 07133000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @OZ30157*/ 07134000
MSG56AA  DS    0H                                                  1747 07135000
*/********************************************************   @OZ30157*/ 07136000
*/*                                                          @OZ30157*/ 07137000
*/* PROCEDURE NAME - MSG56AA                                 @OZ30157*/ 07138000
*/*                                                          @OZ30157*/ 07139000
*/* FUNCTION: CALL MSG56A THEN BUMP MSGIND TO NEXT VALUE     @OZ30157*/ 07140000
*/*           AND MOVE IN BASE FOR NEXT LINE OF MESSAGE.     @OZ30157*/ 07141000
*/*                                                          @OZ30157*/ 07142000
*/* INPUT -  MSGIND SET TO LINE INDEX FOR FIRST MESSAGE      @OZ30157*/ 07143000
*/*                                                          @OZ30157*/ 07144000
*/* OUTPUT - ML WTO BUFFER CLEARED WITH HEADER LINES BUILT   @OZ30157*/ 07145000
*/*                                                          @OZ30157*/ 07146000
*/********************************************************   @OZ30157*/ 07147000
*                                                                  1747 07148000
*   DCL                                                            1747 07149000
*     MS56AA14 FIXED(31);           /* LOCAL RETURN REG SAVE @OZ30157*/ 07150000
*   RFY                                                            1748 07151000
*     R14 RSTD;                     /* RESTRICT REG 14       @OZ30157*/ 07152000
*   MS56AA14=R14;                   /* SAVE RETURN REG       @OZ30157*/ 07153000
         ST    R14,MS56AA14                                        1749 07154000
*   RFY                                                            1750 07155000
*     R14 UNRSTD;                   /* FREE REG 14           @OZ30157*/ 07156000
*   CALL MSG56A;                    /* CALL MSG BUILD SUB    @OZ30157*/ 07157000
         BAL   @14,MSG56A                                          1751 07158000
*   IF DSPNEW=BZERO THEN            /* SET IND FOR NXT LINE  @OZ30157*/ 07159000
         L     @04,@CA00041                                        1752 07160000
         L     @04,CWBPTR-CWBPTR(,@04)                             1752 07161000
         TM    DSPNEW(@04),B'01000000'                             1752 07162000
         BNZ   @RF01752                                            1752 07163000
*     MSGIND=MSG05605;              /* IF SSID DISPLAY       @OZ30157*/ 07164000
         MVI   MSGIND,X'15'                                        1753 07165000
*   ELSE                                                           1754 07166000
*     MSGIND=MSGIND+1;              /* IF NOT                @OZ30157*/ 07167000
         B     @RC01752                                            1754 07168000
@RF01752 IC    @04,MSGIND                                          1754 07169000
         LA    @04,1(,@04)                                         1754 07170000
         STC   @04,MSGIND                                          1754 07171000
*   WPLML0=F0;                      /* INSURE ZERO LENGTH    @OZ30157*/ 07172000
@RC01752 L     @04,WPLPTR                                          1755 07173000
         MVI   WPLML0(@04),X'00'                                   1755 07174000
*   WPLMLLTF=''B;                   /* AND FLAGS             @OZ30157*/ 07175000
         XC    WPLMLLTF(2,@04),WPLMLLTF(@04)                       1756 07176000
*   WPLMLLTC=BONE;                  /* DATA LINE FLAG        @OZ30157*/ 07177000
         OI    WPLMLLTC(@04),B'00100000'                           1757 07178000
*   WPLMLTXT=MESGS(MSGIND);         /* LINE LABEL            @OZ30157*/ 07179000
         MVI   WPLMLTXT+72(@04),C' '                               1758 07180000
         MVC   WPLMLTXT+73(53,@04),WPLMLTXT+72(@04)                1758 07181000
         SLR   @15,@15                                             1758 07182000
         IC    @15,MSGIND                                          1758 07183000
         MH    @15,@CH03605                                        1758 07184000
         LA    @14,MESGS-76(@15)                                   1758 07185000
         MVC   WPLMLTXT(72,@04),0(@14)                             1758 07186000
*   WPLMLLEN=MESGLEN(MSGIND)+F4;    /* LEN + TYPE            @OZ30157*/ 07187000
         LA    @00,4                                               1759 07188000
         LA    @14,MESGLEN-76(@15)                                 1759 07189000
         MVC   @ZT00003+3(1),0(@14)                                1759 07190000
         AL    @00,@ZT00003                                        1759 07191000
         STC   @00,WPLMLLEN(,@04)                                  1759 07192000
*/*********************************************************  @Z40LB01*/ 07193000
*/* RESTORE RETURN REG AND RETURN TO ICBMSG56                @Z40LB01*/ 07194000
*/*********************************************************  @Z40LB01*/ 07195000
*                                                                  1760 07196000
*   RFY                                                            1760 07197000
*     R14 RSTD;                     /* RESTRICT REG 14       @Z40LB01*/ 07198000
*   R14=MS56AA14;                   /* RESTORE RETURN REG    @Z40LB01*/ 07199000
         L     R14,MS56AA14                                        1761 07200000
*   RFY                                                            1762 07201000
*     R14 UNRSTD;                   /* FREE REG 14           @Z40LB01*/ 07202000
*   RETURN;                         /* RETURN TO ICBMSG56    @Z40LB01*/ 07203000
@EL00009 DS    0H                                                  1763 07204000
@EF00009 DS    0H                                                  1763 07205000
@ER00009 BR    @14                                                 1763 07206000
*   END MSG56AA;                    /* END OF ROUTINE        @OZ30157*/ 07207000
*                                                                  1765 07208000
*/************ SUBROUTINE MSG56A ***********                 @Z40LB01*/ 07209000
*                                                                  1765 07210000
*MSG56A:                                                           1765 07211000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Z40LB01*/ 07212000
MSG56A   DS    0H                                                  1766 07213000
*/********************************************************   @Z40LB01*/ 07214000
*/*                                                          @Z40LB01*/ 07215000
*/* PROCEDURE NAME - MSG56A                                  @Z40LB01*/ 07216000
*/*                                                          @Z40LB01*/ 07217000
*/* FUNCTION - INITIALIZES ML WTO COUNTS AND CLEARS ML       @Z40LB01*/ 07218000
*/*            WTO BUFFER AREA. CREATE TWO HEADER LINES      @Z40LB01*/ 07219000
*/*            FOR THE DISPLAY MESSAGE AND SINGLE LINE       @Z40LB01*/ 07220000
*/*            MESSAGES AS REQUIRED.                         @Z40LB01*/ 07221000
*/*                                                          @Z40LB01*/ 07222000
*/*            ____________________________________          @Z40LB01*/ 07223000
*/*            |   LENGTH        |     FLAGS      |          @Z40LB01*/ 07224000
*/*            |_________________|________________|          @Z40LB01*/ 07225000
*/*            |         HEADER 1                 |          @Z40LB01*/ 07226000
*/*            |          TEXT                    |          @Z40LB01*/ 07227000
*/*            |__________________________________|          @Z40LB01*/ 07228000
*/*        SL  |   DESC CODE     |  ROUTE CODE    |  SL      @Z40LB01*/ 07229000
*/*        ___ |_________________|________________| ___      @Z40LB01*/ 07230000
*/*        ML  |  LINE TYPE      | AREA   |# LINES|  ML      @Z40LB01*/ 07231000
*/*            |_________________|________|_______|          @Z40LB01*/ 07232000
*/*            |        | LENGTH |  LINE TYPE     |          @Z40LB01*/ 07233000
*/*            |________|________|________________|          @Z40LB01*/ 07234000
*/*            |         HEADER 2                 |          @Z40LB01*/ 07235000
*/*            |          TEXT                    |          @Z40LB01*/ 07236000
*/*            |__________________________________|          @Z40LB01*/ 07237000
*/*            |        | LENGTH |  LINE TYPE     |          @Z40LB01*/ 07238000
*/*            |________|________|________________|          @Z40LB01*/ 07239000
*/*            |         DATA LINE                |          @Z40LB01*/ 07240000
*/*            |          TEXT                    |          @Z40LB01*/ 07241000
*/*            | UP TO 8 (LENGTH,LINE TYPE, DATA  |          @Z40LB01*/ 07242000
*/*            |   TEXT LINES CAN EXIST HERE      |          @Z40LB01*/ 07243000
*/*            |__________________________________|          @Z40LB01*/ 07244000
*/*                                                          @Z40LB01*/ 07245000
*/* INPUTS - MSGIND SET TO MSG05603 FOR ML HEADERS           @Z40LB01*/ 07246000
*/*          MSGIND SET TO LINE INDEX FOR OTHER MSGS         @Z40LB01*/ 07247000
*/*                                                          @Z40LB01*/ 07248000
*/* OUTPUT - ML WTO BUFFER CLEARED WITH HEADER LINES BUILT   @Z40LB01*/ 07249000
*/*          IN THE BUFFER AND WPLPTR SET TO NEXT MESSAGE    @Z40LB01*/ 07250000
*/*          LINE ENTRY. MSGCNT USED TO RECORD THE NUMBER    @Z40LB01*/ 07251000
*/*          OF LINES IN BUFFER IS SET.                      @Z40LB01*/ 07252000
*/*                                                          @Z40LB01*/ 07253000
*/********************************************************   @Z40LB01*/ 07254000
*                                                                  1766 07255000
*   DCL                                                            1766 07256000
*     MSG56A14 FIXED(31);           /* LOCAL RETURN REG SAVE @Z40LB01*/ 07257000
*   RFY                                                            1767 07258000
*     R14 RSTD;                     /* RESTRICT REG 14       @Z40LB01*/ 07259000
*   MSG56A14=R14;                   /* SAVE RETURN REG       @Z40LB01*/ 07260000
         ST    R14,MSG56A14                                        1768 07261000
*   RFY                                                            1769 07262000
*     R14 UNRSTD;                   /* FREE REG 14           @Z40LB01*/ 07263000
*/*********************************************************  @Z40LB01*/ 07264000
*/* SET COUNTS, BUILD FIRST LINE AND FLAGS FOR WTO           @Z40LB01*/ 07265000
*/*********************************************************  @Z40LB01*/ 07266000
*                                                                  1770 07267000
*   FLIPSW=BZERO;                   /* SET HALF LINE SWITCH  @Z40LB01*/ 07268000
         NI    FLIPSW,B'11101111'                                  1770 07269000
*   MSGCNT=F2;                      /* SET LINE COUNT TO 2   @Z40LB01*/ 07270000
         MVC   MSGCNT(2),@CH00056                                  1771 07271000
*   WPLPTR=ADDR(WPLBUF);            /* SET PTR TO ML BUFFER  @Z40LB01*/ 07272000
         LA    @04,1200                                            1772 07273000
         AL    @04,WORKPTR                                         1772 07274000
         ST    @04,WPLPTR                                          1772 07275000
*   WPLTXT=MESGS(MSGIND);           /* HDR1 LINE             @Z40LB01*/ 07276000
         MVI   WPLTXT+72(@04),C' '                                 1773 07277000
         MVC   WPLTXT+73(53,@04),WPLTXT+72(@04)                    1773 07278000
         SLR   @15,@15                                             1773 07279000
         IC    @15,MSGIND                                          1773 07280000
         MH    @15,@CH03605                                        1773 07281000
         LA    @14,MESGS-76(@15)                                   1773 07282000
         MVC   WPLTXT(72,@04),0(@14)                               1773 07283000
*   WPLLGH=MESGLEN(MSGIND)+F4;      /* LINE LENGTH + LIN TYP @Z40LB01*/ 07284000
         LA    @00,4                                               1774 07285000
         LA    @14,MESGLEN-76(@15)                                 1774 07286000
         MVC   @ZT00003+3(1),0(@14)                                1774 07287000
         AL    @00,@ZT00003                                        1774 07288000
         STH   @00,WPLLGH(,@04)                                    1774 07289000
*   WPLMCSF=''B;                    /* CLEAR FLAG FIELD      @Z40LB01*/ 07290000
         XC    WPLMCSF(2,@04),WPLMCSF(@04)                         1775 07291000
*   WPLMCSFA=BONE;                  /* ROUT AND DESC CODES FLG     1776 07292000
*                                                            @ZA14724*/ 07293000
*   WPLMCSFB=BONE;                  /* QUEUE MESSAGES TO CONS      1777 07294000
*                                                            @Z40LB01*/ 07295000
*   WPLMCSFC=BONE;                  /* CMD RESPONSE FLG      @Z40LB01*/ 07296000
         OI    WPLMCSFA(@04),B'11100000'                           1778 07297000
*   IF MSGIND^=MSG05604 THEN        /* IF NO SYNTAX ERROR    @ZA14724*/ 07298000
         CLI   MSGIND,20                                           1779 07299000
         BE    @RF01779                                            1779 07300000
*     IF MSGIND^=MSG05601 THEN      /* AND NOT INSUFF STORAGE      1780 07301000
*                                                            @OZ30157*/ 07302000
         CLI   MSGIND,17                                           1780 07303000
         BE    @RF01780                                            1780 07304000
*       DO;                         /* THEN                  @OZ30157*/ 07305000
*         WPLMCSFJ=BONE;            /* SET THE ML FLAG       @ZA14724*/ 07306000
         OI    WPLMCSFJ(@04),B'01000000'                           1782 07307000
*         WPLTXT(11:18)=MSGTIME;    /* FILL TIME FIELD       @Z40LB01*/ 07308000
         MVC   WPLTXT+10(8,@04),MSGTIME                            1783 07309000
*       END;                        /*                       @OZ30157*/ 07310000
*     ELSE                          /* AND IF MSG 1          @OZ30157*/ 07311000
*       MSG01TXT=MSG01FIL;          /* OVERLAY WITH STORAGE MSG    1785 07312000
*                                                            @OZ30157*/ 07313000
         B     @RC01780                                            1785 07314000
@RF01780 L     @04,WPLPTR                                          1785 07315000
         MVC   MSG01TXT+36(30,@04),MSG01FIL                        1785 07316000
*   ELSE                            /* FOR SYNTAX ERROR MESSAGE    1786 07317000
*                                                            @OZ30157*/ 07318000
*     DO;                           /* MUST FILL IN THE BLANKS     1786 07319000
*                                                            @OZ30157*/ 07320000
         B     @RC01779                                            1786 07321000
@RF01779 DS    0H                                                  1787 07322000
*       IF DSPRNG=BONE THEN         /* IF BAD SSID RANGE     @OZ30157*/ 07323000
         L     @04,@CA00041                                        1787 07324000
         L     @04,CWBPTR-CWBPTR(,@04)                             1787 07325000
         TM    DSPRNG(@04),B'00001000'                             1787 07326000
         BNO   @RF01787                                            1787 07327000
*         DO;                       /* SET BOTH QUALIFIERS   @OZ30157*/ 07328000
*           MSG04TXT=MSG04FIL(3);   /* RANGE TEXT            @OZ30157*/ 07329000
         LA    @04,37                                              1789 07330000
         AL    @04,WPLPTR                                          1789 07331000
         MVC   MSG04TXT(30,@04),MSG04FIL+60                        1789 07332000
*           MSG04RN1=QUAL(1,1:3);   /* FIRST SSID IN RANGE   @OZ30157*/ 07333000
         MVC   MSG04RN1(3,@04),QUAL                                1790 07334000
*           MSG04RN2=QUAL(2,1:3);   /* SECOND IN RANGE       @OZ30157*/ 07335000
         MVC   MSG04RN2(3,@04),QUAL+11                             1791 07336000
*         END;                      /* END RANGE SECTION     @OZ30157*/ 07337000
*       ELSE                        /* NON-RANGE SECTION     @OZ30157*/ 07338000
*         IF DSPCPU=BONE THEN       /* IF CPUID REQUEST      @OZ30157*/ 07339000
         B     @RC01787                                            1793 07340000
@RF01787 L     @04,@CA00041                                        1793 07341000
         L     @04,CWBPTR-CWBPTR(,@04)                             1793 07342000
         TM    DSPCPU(@04),B'00000010'                             1793 07343000
         BNO   @RF01793                                            1793 07344000
*           DO;                     /* THEN BUILD CPU MSG    @OZ30157*/ 07345000
*             MSG04TXT=MSG04FIL(1); /* FILL WITH CPU TEXT    @OZ30157*/ 07346000
         LA    @04,37                                              1795 07347000
         AL    @04,WPLPTR                                          1795 07348000
         MVC   MSG04TXT(30,@04),MSG04FIL                           1795 07349000
*             MSG04CPU=QUAL(1,1:10);/* PUT IN CPUID          @OZ30157*/ 07350000
         MVC   MSG04CPU(10,@04),QUAL                               1796 07351000
*           END;                    /* END FILL CPU MSG      @OZ30157*/ 07352000
*         ELSE                                                     1798 07353000
*           IF DSPSDG=BONE THEN     /* ELSE IF SDGNN, GET BAD      1798 07354000
*                                                            @OZ30157*/ 07355000
         B     @RC01793                                            1798 07356000
@RF01793 L     @04,@CA00041                                        1798 07357000
         L     @04,CWBPTR-CWBPTR(,@04)                             1798 07358000
         TM    DSPSDG(@04),B'00010000'                             1798 07359000
         BNO   @RF01798                                            1798 07360000
*             DO;                   /* THEN BUILD CPU MSG    @OZ30157*/ 07361000
*               MSG04TXT=MSG04FIL(4);/* FILL WITH SDG TEXT   @OZ30157*/ 07362000
         LA    @04,37                                              1800 07363000
         AL    @04,WPLPTR                                          1800 07364000
         MVC   MSG04TXT(30,@04),MSG04FIL+90                        1800 07365000
*               MSG04SDG=QUAL(1,1:2);/* SDG NUMBER           @OZ30157*/ 07366000
         MVC   MSG04SDG(2,@04),QUAL                                1801 07367000
*             END;                  /* END FILL CPU MSG      @OZ30157*/ 07368000
*           ELSE                                                   1803 07369000
*             IF DSPDRC=BONE THEN   /* ELSE IF DRCNN GET BAD @OZ30157*/ 07370000
         B     @RC01798                                            1803 07371000
@RF01798 L     @04,@CA00041                                        1803 07372000
         L     @04,CWBPTR-CWBPTR(,@04)                             1803 07373000
         TM    DSPDRC(@04),B'10000000'                             1803 07374000
         BNO   @RF01803                                            1803 07375000
*               DO;                 /* THEN BUILD CPU MSG    @OZ30157*/ 07376000
*                 MSG04TXT=MSG04FIL(5);/* FILL WITH DRC TEXT @OZ30157*/ 07377000
         LA    @04,37                                              1805 07378000
         AL    @04,WPLPTR                                          1805 07379000
         MVC   MSG04TXT(30,@04),MSG04FIL+120                       1805 07380000
*                 MSG04DRC=QUAL(1,1:2);/* DRC NUMBER         @OZ30157*/ 07381000
         MVC   MSG04DRC(2,@04),QUAL                                1806 07382000
*               END;                /* END FILL CPU MSG      @OZ30157*/ 07383000
*             ELSE                                                 1808 07384000
*               IF DSPSSID=BONE THEN/* ELSE GET BAD          @OZ30157*/ 07385000
         B     @RC01803                                            1808 07386000
@RF01803 L     @04,@CA00041                                        1808 07387000
         L     @04,CWBPTR-CWBPTR(,@04)                             1808 07388000
         TM    DSPSSID(@04),B'00000100'                            1808 07389000
         BNO   @RF01808                                            1808 07390000
*                 DO;               /* THEN BUILD CPU MSG    @OZ30157*/ 07391000
*                   MSG04TXT=MSG04FIL(2);/* FILL WITH SSID TEXT    1810 07392000
*                                                            @OZ30157*/ 07393000
         LA    @04,37                                              1810 07394000
         AL    @04,WPLPTR                                          1810 07395000
         MVC   MSG04TXT(30,@04),MSG04FIL+30                        1810 07396000
*                   MSG04SSI=QUAL(1,1:3);/* SSID '           @OZ30157*/ 07397000
         MVC   MSG04SSI(3,@04),QUAL                                1811 07398000
*                 END;              /* END FILL CPU MSG      @OZ30157*/ 07399000
*               ELSE                                               1813 07400000
*                 ;                 /*                       @OZ30157*/ 07401000
@RF01808 DS    0H                                                  1814 07402000
*     END;                          /* END MSG05604 LINE 2   @OZ30157*/ 07403000
@RC01803 DS    0H                                                  1814 07404000
@RC01798 DS    0H                                                  1814 07405000
@RC01793 DS    0H                                                  1814 07406000
@RC01787 DS    0H                                                  1815 07407000
*/*********************************************************  @ZA14724*/ 07408000
*/* SET WPLPTR TO ROUT DESC FIELDS AND FILL THEM.            @Z40LB01*/ 07409000
*/*********************************************************  @Z40LB01*/ 07410000
*                                                                  1815 07411000
*   WPLPTR=WPLPTR+WPLLGH;           /* POINT TO DESC ROUT FIELD    1815 07412000
*                                                            @Z40LB01*/ 07413000
@RC01779 L     @04,WPLPTR                                          1815 07414000
         LH    @00,WPLLGH(,@04)                                    1815 07415000
         ALR   @00,@04                                             1815 07416000
         ST    @00,WPLPTR                                          1815 07417000
*   WPLFLGS=''B;                    /* CLEAR FLAG FIELD      @Z40LB01*/ 07418000
         LR    @04,@00                                             1816 07419000
         XC    WPLFLGS(8,@04),WPLFLGS(@04)                         1816 07420000
*   WPLDESCE=BONE;                  /* IMMED CMD RESPONSE    @Z40LB01*/ 07421000
*   WPLDESCH=BONE;                  /* OUT-OF-LINE MESSAGE   @ZA14724*/ 07422000
         LR    @04,@00                                             1818 07423000
         OI    WPLDESCE(@04),B'00001001'                           1818 07424000
*   WPLDESCI=BONE;                  /* DESCRIPTOR CODE 9     @ZA14724*/ 07425000
         LR    @04,@00                                             1819 07426000
         OI    WPLDESCI(@04),B'10000000'                           1819 07427000
*   IF MSGIND=MSG05604|MSGIND=MSG05601 THEN/* IF ERROR MSG   @OZ30157*/ 07428000
         CLI   MSGIND,20                                           1820 07429000
         BE    @RT01820                                            1820 07430000
         CLI   MSGIND,17                                           1820 07431000
         BNE   @RF01820                                            1820 07432000
@RT01820 DS    0H                                                  1821 07433000
*     WPLROUTB=BONE;                /* ROUTE MAS CONS INFO   @ZA14724*/ 07434000
         L     @04,WPLPTR                                          1821 07435000
         OI    WPLROUTB(@04),B'01000000'                           1821 07436000
*   ELSE                            /* IF MULTI-LINE, THEN   @OZ30157*/ 07437000
*     DO;                           /* MUST SET UP FOR IT    @OZ30157*/ 07438000
         B     @RC01820                                            1822 07439000
@RF01820 DS    0H                                                  1823 07440000
*       WPLPTR=WPLPTR+LENGTH(WPLFLGS)-F4;/* POINT TO LINE TYPE     1823 07441000
*                                                            @Z40LB01*/ 07442000
         L     @04,WPLPTR                                          1823 07443000
         SL    @04,@CF03609                                        1823 07444000
         ST    @04,WPLPTR                                          1823 07445000
*       WPLLTF=''B;                 /* CLEAR FLAG FIELD      @Z40LB01*/ 07446000
         XC    WPLLTF(2,@04),WPLLTF(@04)                           1824 07447000
*       IF MSGIND=MSG05602 THEN     /* SSID MSG SHOULD HAVE A      1825 07448000
*                                                            @ZA14724*/ 07449000
         CLI   MSGIND,18                                           1825 07450000
         BNE   @RF01825                                            1825 07451000
*         WPLLTFA=BONE;             /* CONTROL LINE FLAG     @ZA14724*/ 07452000
         OI    WPLLTFA(@04),B'10000000'                            1826 07453000
*       ELSE                        /* OTHER LINES SHOULD HAVE A   1827 07454000
*                                                            @ZA14724*/ 07455000
*         WPLLTFC=BONE;             /* DATA LINE FLAG        @OZ30157*/ 07456000
         B     @RC01825                                            1827 07457000
@RF01825 L     @04,WPLPTR                                          1827 07458000
         OI    WPLLTFC(@04),B'00100000'                            1827 07459000
*       WPLAREA=CWBLA;              /* AREA ID FOR MSG       @Z40LB01*/ 07460000
@RC01825 L     @04,WPLPTR                                          1828 07461000
         L     @15,@CA00041                                        1828 07462000
         L     @15,CWBPTR-CWBPTR(,@15)                             1828 07463000
         MVC   WPLAREA(1,@04),CWBLA(@15)                           1828 07464000
*/*********************************************************  @Z40LB01*/ 07465000
*/* BUILD FIRST DATA HEADER AND SET MULTI LINE FLAGS         @Z40LB01*/ 07466000
*/*********************************************************  @Z40LB01*/ 07467000
*                                                                  1829 07468000
*       WPLPTR=WPLPTR+LENGTH(WPLLS01);/* POINT TO NEXT LINE  @Z40LB01*/ 07469000
         AL    @04,@CF00045                                        1829 07470000
         ST    @04,WPLPTR                                          1829 07471000
*       WPLMLLTF=''B;               /* CLEAR FLAG FIELD      @Z40LB01*/ 07472000
         XC    WPLMLLTF(2,@04),WPLMLLTF(@04)                       1830 07473000
*       WPLML0=F0;                  /* CLEAR FILL FIELD      @Z40LB01*/ 07474000
         MVI   WPLML0(@04),X'00'                                   1831 07475000
*     END;                          /* END MULTI-LINE ROUTINE      1832 07476000
*                                                            @OZ30157*/ 07477000
*/*********************************************************  @Z40LB01*/ 07478000
*/* RESTORE RETURN REG AND RETURN TO ICBMSG56                @Z40LB01*/ 07479000
*/*********************************************************  @Z40LB01*/ 07480000
*                                                                  1833 07481000
*   RFY                                                            1833 07482000
*     R14 RSTD;                     /* RESTRICT REG 14       @Z40LB01*/ 07483000
@RC01820 DS    0H                                                  1834 07484000
*   R14=MSG56A14;                   /* RESTORE RETURN REG    @Z40LB01*/ 07485000
         L     R14,MSG56A14                                        1834 07486000
*   RFY                                                            1835 07487000
*     R14 UNRSTD;                   /* FREE REG 14           @Z40LB01*/ 07488000
*   RETURN;                         /* RETURN TO ICBMSG56    @Z40LB01*/ 07489000
@EL00010 DS    0H                                                  1836 07490000
@EF00010 DS    0H                                                  1836 07491000
@ER00010 BR    @14                                                 1836 07492000
*   END MSG56A;                     /* END MSG56A SUB        @Z40LB01*/ 07493000
*MSG56CA:                                                          1838 07494000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @OZ30157*/ 07495000
MSG56CA  DS    0H                                                  1839 07496000
*/********************************************************   @OZ30157*/ 07497000
*/*                                                          @OZ30157*/ 07498000
*/* PROCEDURE NAME - MSG56CA                                 @OZ30157*/ 07499000
*/*                                                          @OZ30157*/ 07500000
*/* FUNCTION - CLEANUP RESIDUAL MESSAGES IN THE WPL BUFFER   @OZ30157*/ 07501000
*/*           BUILD BLANK LINE FOR OUTPUT AND CALL MSG56C TO @OZ30157*/ 07502000
*/*           DISPLAY THE MESSAGE BUFFER.                    @OZ30157*/ 07503000
*/*                                                          @OZ30157*/ 07504000
*/* INPUT: MESSAGES IN BUFFER, BUT BUFFER NOT FULL.          @OZ30157*/ 07505000
*/*                                                          @OZ30157*/ 07506000
*/* OUTPUT: MESSAGES WRITTEN.                                @OZ30157*/ 07507000
*/*                                                          @OZ30157*/ 07508000
*/********************************************************   @OZ30157*/ 07509000
*                                                                  1839 07510000
*   DCL                                                            1839 07511000
*     MS56CA14 FIXED(31);           /* LOCAL RETURN REG SAVE @OZ30157*/ 07512000
*   RFY                                                            1840 07513000
*     R14 RSTD;                     /* RESTRICT REG 14       @OZ30157*/ 07514000
*   MS56CA14=R14;                   /* SAVE RETURN REG       @OZ30157*/ 07515000
         ST    R14,MS56CA14                                        1841 07516000
*   RFY                                                            1842 07517000
*     R14 UNRSTD;                   /* FREE REG 14           @OZ30157*/ 07518000
*   WPLML0=F0;                      /* CLEAR FILL FIELD      @OZ30157*/ 07519000
         L     @04,WPLPTR                                          1843 07520000
         MVI   WPLML0(@04),X'00'                                   1843 07521000
*   WPLMLLTF=''B;                   /* CLEAR FLAG FIELD      @OZ30157*/ 07522000
         XC    WPLMLLTF(2,@04),WPLMLLTF(@04)                       1844 07523000
*   WPLMLLTC=BONE;                  /* DATA LINE FLAG        @OZ30157*/ 07524000
*   WPLMLLTD=BONE;                  /* SET END LINE IND      @OZ30157*/ 07525000
         OI    WPLMLLTC(@04),B'00110000'                           1846 07526000
*   WPLMLLEN=LENGTH(FHALF)+F4;      /* HALF LINE LENGTH      @OZ30157*/ 07527000
         MVI   WPLMLLEN(@04),X'27'                                 1847 07528000
*   MSGCNT=MSGCNT+F1;               /* UP MSG LINE COUNT     @OZ30157*/ 07529000
         LH    @04,MSGCNT                                          1848 07530000
         LA    @04,1(,@04)                                         1848 07531000
         STH   @04,MSGCNT                                          1848 07532000
*   CALL MSG56C;                    /* WRITE SUBROUTINE      @OZ30157*/ 07533000
         BAL   @14,MSG56C                                          1849 07534000
*/*********************************************************  @OZ30157*/ 07535000
*/* RESTORE RETURN REG AND RETURN TO ICBMSG56                @OZ30157*/ 07536000
*/*********************************************************  @OZ30157*/ 07537000
*                                                                  1850 07538000
*   RFY                                                            1850 07539000
*     R14 RSTD;                     /* RESTRICT REG 14       @OZ30157*/ 07540000
*   R14=MS56CA14;                   /* RESTORE RETURN REG    @OZ30157*/ 07541000
         L     R14,MS56CA14                                        1851 07542000
*   RFY                                                            1852 07543000
*     R14 UNRSTD;                   /* FREE REG 14           @OZ30157*/ 07544000
*   RETURN;                         /* RETURN TO ICBMSG56    @OZ30157*/ 07545000
@EL00011 DS    0H                                                  1853 07546000
@EF00011 DS    0H                                                  1853 07547000
@ER00011 BR    @14                                                 1853 07548000
*   END MSG56CA;                    /* END OF ROUTINE        @OZ30157*/ 07549000
*MSG56C:                                                           1855 07550000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Z40LB01*/ 07551000
MSG56C   DS    0H                                                  1856 07552000
*/********************************************************   @Z40LB01*/ 07553000
*/*                                                          @Z40LB01*/ 07554000
*/* PROCEDURE NAME - MSG56C                                  @Z40LB01*/ 07555000
*/*                                                          @Z40LB01*/ 07556000
*/* FUNCTION - SET REGS AND ISSUE WTO MACRO FOR MULTI-       @Z40LB01*/ 07557000
*/*            LINE DISPLAY MESSAGES.                        @Z40LB01*/ 07558000
*/*                                                          @Z40LB01*/ 07559000
*/* INPUTS - WPLPTR SET TO ML WTO BUFFER                     @Z40LB01*/ 07560000
*/*          CONSOLE SET TO THE TARGET CONSOLE FROM CWB      @Z40LB01*/ 07561000
*/*                                                          @Z40LB01*/ 07562000
*/* OUTPUTS - MESSAGE WRITTEN TO SPECIFIED CONSOLE           @Z40LB01*/ 07563000
*/*                                                          @Z40LB01*/ 07564000
*/* MESSAGE ISSUED THIS SUB-ROUTINE                          @Z40LB01*/ 07565000
*/*                                                          @Z40LB01*/ 07566000
*/*          ICB056I DISPLAY LINES                           @Z40LB01*/ 07567000
*/*                                                          @Z40LB01*/ 07568000
*/********************************************************   @Z40LB01*/ 07569000
*                                                                  1856 07570000
*   DCL                                                            1856 07571000
*     MSG56C14 FIXED(31);           /* LOCAL RETURN REG SAVE @Z40LB01*/ 07572000
*   RFY                                                            1857 07573000
*     R14 RSTD;                     /* RESTRICT REG 14       @Z40LB01*/ 07574000
*   MSG56C14=R14;                   /* SAVE RETURN REG       @Z40LB01*/ 07575000
         ST    R14,MSG56C14                                        1858 07576000
*   RFY                                                            1859 07577000
*     R14 UNRSTD;                   /* FREE REG 14           @Z40LB01*/ 07578000
*/********************************************************   @Z40LB01*/ 07579000
*/* SET WPL POINTER AND FILL LINE COUNT FIELD                @Z40LB01*/ 07580000
*/********************************************************   @Z40LB01*/ 07581000
*                                                                  1860 07582000
*   WPLPSAVE=WPLPTR;                /* SAVE WPLPTR ADDRESS   @ZA14724*/ 07583000
         MVC   WPLPSAVE(4),WPLPTR                                  1860 07584000
*   WPLPTR=ADDR(WPLBUF);            /* SET TO START OF BUF   @Z40LB01*/ 07585000
         LA    @04,1200                                            1861 07586000
         AL    @04,WORKPTR                                         1861 07587000
         ST    @04,WPLPTR                                          1861 07588000
*   WPLPTR=WPLPTR+WPLLGH-F4+LENGTH(WPLFLGS);/* TO LINE CNT FLD     1862 07589000
*                                                            @Z40LB01*/ 07590000
         LH    @00,WPLLGH(,@04)                                    1862 07591000
         ALR   @00,@04                                             1862 07592000
         AL    @00,@CF00045                                        1862 07593000
         ST    @00,WPLPTR                                          1862 07594000
*   WPLLINES=MSGCNT;                /* SET LINE COUNT        @Z40LB01*/ 07595000
         LR    @04,@00                                             1863 07596000
         MVC   WPLLINES(1,@04),MSGCNT+1                            1863 07597000
*/********************************************************   @Z40LB01*/ 07598000
*/* SET CONSOLE ID                                           @Z40LB01*/ 07599000
*/********************************************************   @Z40LB01*/ 07600000
*                                                                  1864 07601000
*   RFY                                                            1864 07602000
*    (R0) RSTD;                     /* RESTRICT R0 AND R1    @Z40LB01*/ 07603000
*   IF MSGIND=MSG05604 THEN         /* IF ERROR MSG THEN WE  @ZA14724*/ 07604000
         CLI   MSGIND,20                                           1865 07605000
         BNE   @RF01865                                            1865 07606000
*     CONSID4=CWBUCMID;             /* SET ORIG CONSODE ID   @ZA14724*/ 07607000
         L     @04,@CA00041                                        1866 07608000
         L     @04,CWBPTR-CWBPTR(,@04)                             1866 07609000
         MVC   CONSID4(1),CWBUCMID(@04)                            1866 07610000
*   ELSE                            /* OTHERWISE             @ZA14724*/ 07611000
*     CONSID4=CWBLCC;               /* SET TARGET CONSOLE ID @ZA14724*/ 07612000
         B     @RC01865                                            1867 07613000
@RF01865 L     @04,@CA00041                                        1867 07614000
         L     @04,CWBPTR-CWBPTR(,@04)                             1867 07615000
         MVC   CONSID4(1),CWBLCC(@04)                              1867 07616000
*   R0=CONSOL;                      /* SET R0 FOR ML CONNECT @ZA14724*/ 07617000
@RC01865 L     R0,CONSOL                                           1868 07618000
*   DO;                             /* WTOP MF(E,WPLBUF)             */ 07619000
*     RFY                                                          1870 07620000
*       GPR01P RSTD;                /* RESTRICT REG 1                */ 07621000
*     GPR01P=ADDR(WPLBUF);          /* ADDRESS CONTROL PROGRAM LIST  */ 07622000
         LA    GPR01P,1200                                         1871 07623000
         AL    GPR01P,WORKPTR                                      1871 07624000
*     SVC(35);                      /* ISSUE WTO SVC                 */ 07625000
         SVC   35                                                  1872 07626000
*     RFY                                                          1873 07627000
*       GPR01P UNRSTD;              /* RELEASE REG 1                 */ 07628000
*   END;                            /* WTOP MF(E,WPLBUF) WTO MACRO 1874 07629000
*                                                            @Z40LB01*/ 07630000
*   RFY                                                            1875 07631000
*     GPR01P RSTD;                  /* RESTRICT R1           @OZ30157*/ 07632000
*   SAVDOMID=GPR01P;                /* SAVE DOM FROM REG 1   @ZA14724*/ 07633000
         ST    GPR01P,@TF00001                                     1876 07634000
         MVC   SAVDOMID(3),@TF00001+1                              1876 07635000
*   RFY                                                            1877 07636000
*     GPR01P UNRSTD;                /* FREE R1               @OZ30157*/ 07637000
*   RFY                                                            1878 07638000
*    (R0) UNRSTD;                   /* FREE R0               @OZ30157*/ 07639000
*   RFY                                                            1879 07640000
*     R14 RSTD;                     /* RESTRICT REG 14       @Z40LB01*/ 07641000
*   R14=MSG56C14;                   /* RESTORE CALLER RETURN @Z40LB01*/ 07642000
         L     R14,MSG56C14                                        1880 07643000
*   RFY                                                            1881 07644000
*     R14 UNRSTD;                   /* FREE REG 14           @Z40LB01*/ 07645000
*   RETURN;                         /* RETURN TO ICBMSG56    @Z40LB01*/ 07646000
@EL00012 DS    0H                                                  1882 07647000
@EF00012 DS    0H                                                  1882 07648000
@ER00012 BR    @14                                                 1882 07649000
*   END MSG56C;                     /* END OF MSG56C SUB     @Z40LB01*/ 07650000
*MSG56D:                                                           1884 07651000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Z40LB01*/ 07652000
MSG56D   DS    0H                                                  1885 07653000
*/********************************************************   @Z40LB01*/ 07654000
*/*                                                          @Z40LB01*/ 07655000
*/* PROCEDURE NAME - MSG56D                                  @Z40LB01*/ 07656000
*/*                                                          @Z40LB01*/ 07657000
*/* FUNCTION - THIS ROUTINE CHECKS FOR A FULL MULTI-LINE     @OZ30157*/ 07658000
*/*            WTO BUFFER AND, IF FULL, CLOSES IT OUT,       @OZ30157*/ 07659000
*/*            CALLS THE ML WTO WRITE SUB (MSG56C),          @OZ30157*/ 07660000
*/*            CHECKS THE WRITE RESULTS, AND SETS UP         @Z40LB01*/ 07661000
*/*            REQUIRED POINTERS AND COUNTS FOR THE          @Z40LB01*/ 07662000
*/*            NEXT BUFFER FILL.                             @Z40LB01*/ 07663000
*/*            IF NOT FULL, IT CLEANS UP THE CURRENT LINE,   @OZ30157*/ 07664000
*/*            AND BUILDS THE BASE FOR THE NEXT LINE.        @OZ30157*/ 07665000
*/*                                                          @Z40LB01*/ 07666000
*/* INPUTS - INITIALIZED WPL ML BUFFER AND POINTER           @Z40LB01*/ 07667000
*/*                                                          @Z40LB01*/ 07668000
*/* OUTPUTS - ML WTO LINES WRITTEN AND POINTERS              @Z40LB01*/ 07669000
*/*           SET FOR NEXT DATA, OR POINTERS SET FOR         @OZ30157*/ 07670000
*/*           NEXT DATA LINE.                                @OZ30157*/ 07671000
*/*                                                          @Z40LB01*/ 07672000
*/********************************************************   @Z40LB01*/ 07673000
*                                                                  1885 07674000
*   DCL                                                            1885 07675000
*     MSG56D14 FIXED(31);           /* LOCAL SAVE AREA       @Z40LB01*/ 07676000
*   RFY                                                            1886 07677000
*     R14 RSTD;                     /* RESTRICT REG 14       @Z40LB01*/ 07678000
*   MSG56D14=R14;                   /* SAVE RETURN REG       @Z40LB01*/ 07679000
         ST    R14,MSG56D14                                        1887 07680000
*   RFY                                                            1888 07681000
*     R14 UNRSTD;                   /* FREE REG 14           @Z40LB01*/ 07682000
*   WPLMLLTC=BONE;                  /* DATA LINE TYPE FLG    @OZ30157*/ 07683000
         L     @04,WPLPTR                                          1889 07684000
         OI    WPLMLLTC(@04),B'00100000'                           1889 07685000
*   WPLML0=F0;                      /* CLEAR FILL FIELD      @OZ30157*/ 07686000
         MVI   WPLML0(@04),X'00'                                   1890 07687000
*   WPLMLLEN=MESGLEN(MSGIND)+F4;    /* LINE LEN              @OZ30157*/ 07688000
         SLR   @15,@15                                             1891 07689000
         IC    @15,MSGIND                                          1891 07690000
         MH    @15,@CH03605                                        1891 07691000
         LA    @00,4                                               1891 07692000
         LA    @14,MESGLEN-76(@15)                                 1891 07693000
         MVC   @ZT00003+3(1),0(@14)                                1891 07694000
         AL    @00,@ZT00003                                        1891 07695000
         STC   @00,WPLMLLEN(,@04)                                  1891 07696000
*   FLIPSW=BZERO;                   /*                       @OZ30157*/ 07697000
         NI    FLIPSW,B'11101111'                                  1892 07698000
*   MSGCNT=MSGCNT+F1;               /*                       @OZ30157*/ 07699000
         LA    @04,1                                               1893 07700000
         AH    @04,MSGCNT                                          1893 07701000
         STH   @04,MSGCNT                                          1893 07702000
*/********************************************************************/ 07703000
*/*                                                                  */ 07704000
*/* TEST FOR FULL ML WTO BUFFER, WRITE IF FULL               @OZ30157*/ 07705000
*/*                                                                  */ 07706000
*/********************************************************************/ 07707000
*                                                                  1894 07708000
*   IF MSGCNT=F10 THEN              /* IF BUFFER FULL, WRITE @OZ30157*/ 07709000
         CH    @04,@CH00034                                        1894 07710000
         BNE   @RF01894                                            1894 07711000
*     DO;                           /*                       @OZ30157*/ 07712000
*       MSGCNT=MSGCNT-F1;           /* ALL BUT LAST LINE     @ZA14724*/ 07713000
         BCTR  @04,0                                               1896 07714000
         STH   @04,MSGCNT                                          1896 07715000
*       CALL MSG56C;                /* CALL WRITE SUB        @Z40LB01*/ 07716000
         BAL   @14,MSG56C                                          1897 07717000
*/* ******************************************************   @Z40LB01*/ 07718000
*/*  RESET THE ML POINTER TO FIRST DATA LINE, MOVE IN        @Z40LB01*/ 07719000
*/*  DATA LINE SKELETON AND SET COUNTER.                     @Z40LB01*/ 07720000
*/* ******************************************************   @Z40LB01*/ 07721000
*                                                                  1898 07722000
*       MSGCNT=F1;                  /* INITIALIZE MESSAGE COUNT    1898 07723000
*                                                            @ZA14724*/ 07724000
         MVC   MSGCNT(2),@CH00047                                  1898 07725000
*       WPLPTR=ADDR(WPLBUF);        /* SET UP WPL POINTER    @Z40LB01*/ 07726000
         LA    @04,1200                                            1899 07727000
         AL    @04,WORKPTR                                         1899 07728000
         ST    @04,WPLPTR                                          1899 07729000
*       WPLTXT=LASMLTXT;            /* COPY TEXT FROM LAST   @ZA14724*/ 07730000
         L     @15,WPLPSAVE                                        1900 07731000
         MVC   WPLTXT(126,@04),LASMLTXT(@15)                       1900 07732000
*       WPLLGH=LASMLLEN;            /* COPY LINE LENGTH      @ZA14724*/ 07733000
         SLR   @00,@00                                             1901 07734000
         IC    @00,LASMLLEN(,@15)                                  1901 07735000
         STH   @00,WPLLGH(,@04)                                    1901 07736000
*       WPLMCSF=''B;                /* CLEAR FLAG FIELD      @Z40LB01*/ 07737000
         XC    WPLMCSF(2,@04),WPLMCSF(@04)                         1902 07738000
*       WPLMCSFA=BONE;              /* ROUT AND DESC CODES FLG     1903 07739000
*                                                            @ZA14724*/ 07740000
*       WPLMCSFB=BONE;              /* QUEUE MESSAGES TO CONS      1904 07741000
*                                                            @Z40LB01*/ 07742000
*       WPLMCSFC=BONE;              /* CMD RESPONSE FLG      @Z40LB01*/ 07743000
         OI    WPLMCSFA(@04),B'11100000'                           1905 07744000
*       WPLMCSFJ=BONE;              /* SET THE ML FLAG       @ZA14724*/ 07745000
         OI    WPLMCSFJ(@04),B'01000000'                           1906 07746000
*       WPLPTR=WPLPTR+WPLLGH;       /* POINT TO DESC ROUT FIELD    1907 07747000
*                                                            @Z40LB01*/ 07748000
         ALR   @04,@00                                             1907 07749000
         ST    @04,WPLPTR                                          1907 07750000
*       WPLFLGS=''B;                /* CLEAR FLAG FIELD      @ZA14724*/ 07751000
         XC    WPLFLGS(8,@04),WPLFLGS(@04)                         1908 07752000
*       WPLDESCE=BONE;              /* IMMED CMD RESPONSE    @ZA14724*/ 07753000
*       WPLDESCH=BONE;              /* OUT-OF-LINE MESSAGE   @ZA14724*/ 07754000
         OI    WPLDESCE(@04),B'00001001'                           1910 07755000
*       WPLDESCI=BONE;              /* DESCRIPTOR CODE 9     @ZA14724*/ 07756000
         OI    WPLDESCI(@04),B'10000000'                           1911 07757000
*       WPLPTR=WPLPTR+LENGTH(WPLFLGS)-F4;/* POINT TO LINE TYPE     1912 07758000
*                                                            @ZA14724*/ 07759000
         SL    @04,@CF03609                                        1912 07760000
         ST    @04,WPLPTR                                          1912 07761000
*       WPLLTF=''B;                 /* CLEAR FLAG FIELD      @ZA14724*/ 07762000
         XC    WPLLTF(2,@04),WPLLTF(@04)                           1913 07763000
*       WPLLTFC=BONE;               /* DATA LINE FLAG        @ZA14724*/ 07764000
         OI    WPLLTFC(@04),B'00100000'                            1914 07765000
*       WPLAREA=CWBLA;              /* AREA ID FOR MSG       @ZA14724*/ 07766000
         L     @15,@CA00041                                        1915 07767000
         L     @15,CWBPTR-CWBPTR(,@15)                             1915 07768000
         MVC   WPLAREA(1,@04),CWBLA(@15)                           1915 07769000
*       WPLPTR=WPLPTR+LENGTH(WPLLS01);/* POINT TO NEXT LINE  @ZA14724*/ 07770000
         AL    @04,@CF00045                                        1916 07771000
         ST    @04,WPLPTR                                          1916 07772000
*     END;                          /*                       @OZ30157*/ 07773000
*/********************************************************************/ 07774000
*/*                                                                  */ 07775000
*/* BUFFER NOT FULL, SET POINTERS FOR NEXT DATA              @OZ30157*/ 07776000
*/*                                                                  */ 07777000
*/********************************************************************/ 07778000
*                                                                  1918 07779000
*   ELSE                            /* NO WRITE REQUIRED     @OZ30157*/ 07780000
*     WPLPTR=WPLPTR+WPLMLLEN;       /* NEXT LINE             @OZ30157*/ 07781000
         B     @RC01894                                            1918 07782000
@RF01894 L     @04,WPLPTR                                          1918 07783000
         SLR   @00,@00                                             1918 07784000
         IC    @00,WPLMLLEN(,@04)                                  1918 07785000
         ALR   @00,@04                                             1918 07786000
         ST    @00,WPLPTR                                          1918 07787000
*   WPLMLLTF=''B;                   /* CLEAR FLAG FIELD      @ZA14724*/ 07788000
@RC01894 L     @04,WPLPTR                                          1919 07789000
         XC    WPLMLLTF(2,@04),WPLMLLTF(@04)                       1919 07790000
*   WPLMLTXT=MESGS(MSGIND);         /* BLANK DATA LINE       @ZA14724*/ 07791000
         MVI   WPLMLTXT+72(@04),C' '                               1920 07792000
         MVC   WPLMLTXT+73(53,@04),WPLMLTXT+72(@04)                1920 07793000
         SLR   @15,@15                                             1920 07794000
         IC    @15,MSGIND                                          1920 07795000
         MH    @15,@CH03605                                        1920 07796000
         LA    @14,MESGS-76(@15)                                   1920 07797000
         MVC   WPLMLTXT(72,@04),0(@14)                             1920 07798000
*   WPLML0=F0;                      /* ZERO AND FILL         @OZ30157*/ 07799000
         MVI   WPLML0(@04),X'00'                                   1921 07800000
*   WPLMLLEN=MESGLEN(MSGIND)+F4;    /* LENGTH FIELD          @OZ30157*/ 07801000
         LA    @00,4                                               1922 07802000
         LA    @14,MESGLEN-76(@15)                                 1922 07803000
         MVC   @ZT00003+3(1),0(@14)                                1922 07804000
         AL    @00,@ZT00003                                        1922 07805000
         STC   @00,WPLMLLEN(,@04)                                  1922 07806000
*   RFY                                                            1923 07807000
*     R14 RSTD;                     /* RESTRICT REG 14       @Z40LB01*/ 07808000
*   R14=MSG56D14;                   /* RESTORE RETURN REG    @Z40LB01*/ 07809000
         L     R14,MSG56D14                                        1924 07810000
*   RFY                                                            1925 07811000
*     R14 UNRSTD;                   /* FREE REG 14           @Z40LB01*/ 07812000
*   RETURN;                         /* RETURN TO ICBMSG56    @Z40LB01*/ 07813000
@EL00013 DS    0H                                                  1926 07814000
@EF00013 DS    0H                                                  1926 07815000
@ER00013 BR    @14                                                 1926 07816000
*   END MSG56D;                     /* END SUBROUTINE        @Z40LB01*/ 07817000
*MSG56E:                                                           1928 07818000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @OZ24706*/ 07819000
MSG56E   DS    0H                                                  1929 07820000
*/********************************************************   @OZ24706*/ 07821000
*/*                                                          @OZ24706*/ 07822000
*/* PROCEDURE NAME - MSG56E                                  @OZ24706*/ 07823000
*/*                                                          @OZ24706*/ 07824000
*/* FUNCTION - BUILD AND ISSUE THE DISPLAY 3850 ML START MESSAGE     */ 07825000
*/*                                                          @OZ24706*/ 07826000
*/* INPUTS - NONE                                            @OZ24706*/ 07827000
*/*                                                          @OZ24706*/ 07828000
*/* OUTPUTS - MESSAGE WRITTEN TO SPECIFIED CONSOLE           @OZ24706*/ 07829000
*/*                                                          @OZ24706*/ 07830000
*/* MESSAGE ISSUED THIS SUB-ROUTINE                          @OZ24706*/ 07831000
*/*                                                          @OZ24706*/ 07832000
*/*          ICB056I MULTI-LINE START MESSAGE                @OZ24706*/ 07833000
*/*                                                          @OZ24706*/ 07834000
*/********************************************************   @OZ24706*/ 07835000
*                                                                  1929 07836000
*   DCL                                                            1929 07837000
*     MSG56E14 FIXED(31);           /* LOCAL RETURN REG SAVE @OZ24706*/ 07838000
*   RFY                                                            1930 07839000
*     R14 RSTD;                     /* RESTRICT REG 14       @OZ24706*/ 07840000
*   MSG56E14=R14;                   /* SAVE RETURN REG       @OZ24706*/ 07841000
         ST    R14,MSG56E14                                        1931 07842000
*   RFY                                                            1932 07843000
*     R14 UNRSTD;                   /* FREE REG 14           @OZ24706*/ 07844000
*                                                                  1932 07845000
*   /*****************************************************************/ 07846000
*   /*                                                               */ 07847000
*   /* BUILD AND ISSUE THE DISPLAY 3850 ML START MESSAGE     @OZ24706*/ 07848000
*   /*                                                               */ 07849000
*   /*****************************************************************/ 07850000
*                                                                  1933 07851000
*   MSGIND=MSG05602;                /* SET MSG LINE INDEX    @OZ24706*/ 07852000
         MVI   MSGIND,X'12'                                        1933 07853000
*   CALL MSG56A;                    /* FORMAT CONTROL/LABEL LINES  1934 07854000
*                                                            @OZ24706*/ 07855000
         BAL   @14,MSG56A                                          1934 07856000
*   WPLMLLTC=BONE;                  /* DATA LINE FLAG        @OZ24706*/ 07857000
         L     @04,WPLPTR                                          1935 07858000
         OI    WPLMLLTC(@04),B'00100000'                           1935 07859000
*   WPLMLTXT=MESGS(MSG05607);       /* CONTROL LINE          @OZ24706*/ 07860000
         MVI   WPLMLTXT+72(@04),C' '                               1936 07861000
         MVC   WPLMLTXT+73(53,@04),WPLMLTXT+72(@04)                1936 07862000
         MVC   WPLMLTXT(72,@04),MESGS+1672                         1936 07863000
*   WPLMLLEN=MESGLEN(MSG05607)+F4;  /* LINE LEN + LIN TYP    @OZ24706*/ 07864000
         LA    @00,4                                               1937 07865000
         MVC   @ZT00003+3(1),MESGLEN+1672                          1937 07866000
         AL    @00,@ZT00003                                        1937 07867000
         STC   @00,WPLMLLEN(,@04)                                  1937 07868000
*/*********************************************************  @OZ24706*/ 07869000
*/* FILL PHOST AND SECONDARY HOST FIELDS AFTER START LINE    @OZ24706*/ 07870000
*/*********************************************************  @OZ24706*/ 07871000
*                                                                  1938 07872000
*   UCBPTR=ICBPUCB;                 /* SET UCBPTR            @OZ24706*/ 07873000
         L     @15,@CA00927                                        1938 07874000
         L     @14,CVTPTR                                          1938 07875000
         L     @14,CVTEXT2(,@14)                                   1938 07876000
         L     @14,CVTICB(,@14)                                    1938 07877000
         L     @00,ICBPUCB(,@14)                                   1938 07878000
         ST    @00,UCBPTR-UCBPTR(,@15)                             1938 07879000
*   WPLTXT(19:21)=UCBNAME;          /* MOVE IN UCB NAME      @OZ24706*/ 07880000
         LR    @15,@00                                             1939 07881000
         MVC   WPLTXT+18(3,@04),UCBNAME(@15)                       1939 07882000
*   IF UCBONLI=BZERO THEN           /* IF PRIMARY DEVICE OFFLINE   1940 07883000
*                                                            @OZ24706*/ 07884000
         LR    @15,@00                                             1940 07885000
         TM    UCBONLI(@15),B'10000000'                            1940 07886000
         BNZ   @RF01940                                            1940 07887000
*     WPLTXT(25:31)='OFFLINE';      /*                       @OZ24706*/ 07888000
         MVC   WPLTXT+24(7,@04),@CC02856                           1941 07889000
*   IF ICBAUCB^=F0 THEN             /* IS THERE AN ALT MSC ? @OZ24706*/ 07890000
@RF01940 L     @04,CVTPTR                                          1942 07891000
         L     @04,CVTEXT2(,@04)                                   1942 07892000
         L     @04,CVTICB(,@04)                                    1942 07893000
         L     @04,ICBAUCB(,@04)                                   1942 07894000
         LTR   @04,@04                                             1942 07895000
         BZ    @RF01942                                            1942 07896000
*     DO;                           /* ALT MSC AVAIL CODE    @OZ24706*/ 07897000
*       UCBPTR=ICBAUCB;             /* SET UCBPTR TO ALT UCB @FIXLENS*/ 07898000
         L     @15,@CA00927                                        1944 07899000
         ST    @04,UCBPTR-UCBPTR(,@15)                             1944 07900000
*       WPLTXT(42:44)=UCBNAME;      /* MOVE IN UCB NAME      @OZ24706*/ 07901000
         L     @15,WPLPTR                                          1945 07902000
         MVC   WPLTXT+41(3,@15),UCBNAME(@04)                       1945 07903000
*       IF UCBONLI=BZERO THEN       /* IF SECNDRY DEVICE OFFLINE   1946 07904000
*                                                            @OZ24706*/ 07905000
         TM    UCBONLI(@04),B'10000000'                            1946 07906000
         BNZ   @RF01946                                            1946 07907000
*         WPLTXT(48:54)='OFFLINE';  /*                       @OZ24706*/ 07908000
         MVC   WPLTXT+47(7,@15),@CC02856                           1947 07909000
*     END;                          /* END ALT MSC CODE      @OZ24706*/ 07910000
*   ELSE                            /* NO ALT MSC            @OZ24706*/ 07911000
*     DO;                           /* ALT MSC AVAIL CODE    @OZ24706*/ 07912000
         B     @RC01942                                            1949 07913000
@RF01942 DS    0H                                                  1950 07914000
*       WPLTXT(42:54)=BLANK;        /* BLANK OUT PORTION FIRST     1950 07915000
*                                                            @OZ24706*/ 07916000
         L     @04,WPLPTR                                          1950 07917000
         MVC   WPLTXT+41(13,@04),@CC02699                          1950 07918000
*       WPLTXT(42:45)='NONE';       /* INDICATE NONE FOR ALT MSC   1951 07919000
*                                                            @OZ24706*/ 07920000
         MVC   WPLTXT+41(4,@04),@CC03373                           1951 07921000
*     END;                          /* END ALT MSC CODE      @OZ24706*/ 07922000
*   MSGCNT=MSGCNT+1;                /* INCREMENT LINE COUNT  @OZ24706*/ 07923000
@RC01942 LH    @04,MSGCNT                                          1953 07924000
         LA    @04,1(,@04)                                         1953 07925000
         STH   @04,MSGCNT                                          1953 07926000
*   WPLPTR=WPLPTR+WPLMLLEN;         /* BUMP WPL POINTER      @OZ24706*/ 07927000
         L     @04,WPLPTR                                          1954 07928000
         SLR   @00,@00                                             1954 07929000
         IC    @00,WPLMLLEN(,@04)                                  1954 07930000
         ALR   @00,@04                                             1954 07931000
         ST    @00,WPLPTR                                          1954 07932000
*   WPLMLLTF=''B;                   /* CLEAR FLAGS           @OZ24706*/ 07933000
         LR    @04,@00                                             1955 07934000
         XC    WPLMLLTF(2,@04),WPLMLLTF(@04)                       1955 07935000
*   WPLMLLTC=BONE;                  /* SET UP AS DATA LINE   @OZ24706*/ 07936000
         LR    @04,@00                                             1956 07937000
         OI    WPLMLLTC(@04),B'00100000'                           1956 07938000
*   WPLMLTXT=MESGS(MSG05606);       /* INSERT BLANK LINE     @OZ24706*/ 07939000
         LR    @04,@00                                             1957 07940000
         MVI   WPLMLTXT+72(@04),C' '                               1957 07941000
         MVC   WPLMLTXT+73(53,@04),WPLMLTXT+72(@04)                1957 07942000
         MVC   WPLMLTXT(72,@04),MESGS+1596                         1957 07943000
*   WPLMLLEN=LENGTH(FHALF)+F4;      /* SET UP LINE COUNT     @OZ24706*/ 07944000
         LR    @04,@00                                             1958 07945000
         MVI   WPLMLLEN(@04),X'27'                                 1958 07946000
*   WPLML0=F0;                      /* CLEAR FILL FIELD      @OZ24706*/ 07947000
         LR    @04,@00                                             1959 07948000
         MVI   WPLML0(@04),X'00'                                   1959 07949000
*   CALL MSG56C;                    /* WRITE START MESSAGE   @OZ24706*/ 07950000
         BAL   @14,MSG56C                                          1960 07951000
*   RFY                                                            1961 07952000
*     R14 RSTD;                     /* RESTRICT REG 14       @OZ24706*/ 07953000
*   R14=MSG56E14;                   /* RESTORE CALLER RETURN @OZ24706*/ 07954000
         L     R14,MSG56E14                                        1962 07955000
*   RFY                                                            1963 07956000
*     R14 UNRSTD;                   /* FREE REG 14           @OZ24706*/ 07957000
*   RETURN;                         /* RETURN TO ICBMSG56    @OZ24706*/ 07958000
@EL00014 DS    0H                                                  1964 07959000
@EF00014 DS    0H                                                  1964 07960000
@ER00014 BR    @14                                                 1964 07961000
*   END MSG56E;                     /* END OF MSG56C SUB     @OZ24706*/ 07962000
*MSG56F:                                                           1966 07963000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @OZ30157*/ 07964000
MSG56F   DS    0H                                                  1967 07965000
*/********************************************************** @OZ30157*/ 07966000
*/*                                                          @OZ30157*/ 07967000
*/* PROCEDURE NAME: MSG56F                                   @OZ30157*/ 07968000
*/*                                                          @OZ30157*/ 07969000
*/* FUNCTION: DO GETMAIN FOR AREA OF REQUESTED SIZE AND      @OZ30157*/ 07970000
*/*           STORE A POINTER TO THE AREA IN CALLERS PARM    @OZ30157*/ 07971000
*/*                                                          @OZ30157*/ 07972000
*/* INPUTS: R1 POINTS TO PARAMETER LIST:                     @OZ30157*/ 07973000
*/*               --------------------------------           @OZ30157*/ 07974000
*/*              | LENGTH |  ADDRESS OF POINTER   |          @OZ30157*/ 07975000
*/*               --------------------------------           @OZ30157*/ 07976000
*/*        LENGTH SHOULD BE 00 IF 2K IS DESIRED, OTHERWISE   @OZ30157*/ 07977000
*/*        ROUTINE WILL GET THE NUMBER OF 8 BYTE AREAS       @OZ30157*/ 07978000
*/*        SPECIFIED.                                        @OZ30157*/ 07979000
*/*                                                          @OZ30157*/ 07980000
*/* OUTPUTS: PLACES ADDRESS OF AREA OBTAINED IN POINTER TO   @OZ30157*/ 07981000
*/*          WHICH PASSED ADDRESS POINTS. ALSO PLACES IT IN  @OZ30157*/ 07982000
*/*          A TABLE OF GETMAINS TO BE USED TO FREE ALL      @OZ30157*/ 07983000
*/*          AREAS AT END OF EXECUTION.                      @OZ30157*/ 07984000
*/*          ALSO SETS RETURN CODE IN REGISTER 15: 0 - GOOD  @OZ30157*/ 07985000
*/*                                                4 - ERROR @OZ30157*/ 07986000
*/*                                                          @OZ30157*/ 07987000
*/********************************************************** @OZ30157*/ 07988000
*                                                                  1967 07989000
*   DCL                                                            1967 07990000
*     MSG56F14 FIXED(31);           /* LOCAL RETURN REG SAVE @OZ30157*/ 07991000
*   DCL                                                            1968 07992000
*     PARMPTR PTR(31);              /* PARAMETER POINTER     @OZ30157*/ 07993000
*   DCL                                                            1969 07994000
*     SVPTR PTR(31);                /* SAVE INADDR HERE      @OZ30157*/ 07995000
*   DCL                                                            1970 07996000
*     1 PARMS BASED(PARMPTR),       /* INPUT PARAMETER PTR   @OZ30157*/ 07997000
*      2 INLEN FIXED(8),            /* INPUT LENGTH          @OZ30157*/ 07998000
*      2 INADDR PTR(24);            /* INPUT POINTER ADDRESS @OZ30157*/ 07999000
*   RFY                                                            1971 08000000
*     R14 RSTD;                     /*                       @OZ30157*/ 08001000
*   MSG56F14=R14;                   /* SAVE RETURN REG       @OZ30157*/ 08002000
         ST    R14,MSG56F14                                        1972 08003000
*   RFY                                                            1973 08004000
*     R14 UNRSTD;                   /*                       @OZ30157*/ 08005000
*   RETC=F0;                        /* INITIALIZE RETURN CODE@OZ30157*/ 08006000
         SLR   @04,@04                                             1974 08007000
         STH   @04,RETC                                            1974 08008000
*   RFY                                                            1975 08009000
*     R0 RSTD;                      /* RESTRICT R0 FOR LENGTH@OZ30157*/ 08010000
*   PARMPTR=R1;                     /*                       @OZ30157*/ 08011000
         ST    R1,PARMPTR                                          1976 08012000
*   R0=INLEN;                       /* GET LENGTH            @OZ30157*/ 08013000
         L     @15,PARMPTR                                         1977 08014000
         SLR   R0,R0                                               1977 08015000
         IC    R0,INLEN(,@15)                                      1977 08016000
*   SVPTR=INADDR;                   /* AND POINTER ADDRESS   @OZ30157*/ 08017000
         L     @15,INADDR-1(,@15)                                  1978 08018000
         LA    @15,0(,@15)                                         1978 08019000
         ST    @15,SVPTR                                           1978 08020000
*   IF R0=F0 THEN                   /* IF 0 INLEN            @OZ30157*/ 08021000
         CR    R0,@04                                              1979 08022000
         BNE   @RF01979                                            1979 08023000
*     R0=F2K;                       /* SET FOR 2K BYTES      @OZ30157*/ 08024000
         LA    R0,2048                                             1980 08025000
*   ELSE                                                           1981 08026000
*     R0=(R0*F8);                   /* OR MULTIPLE OF 8      @OZ30157*/ 08027000
         B     @RC01979                                            1981 08028000
@RF01979 SLL   R0,3                                                1981 08029000
*   IF GMCUR<GMSTT THEN             /* IS IT FIRST GETMAIN   @OZ30157*/ 08030000
@RC01979 L     @04,GMCUR                                           1982 08031000
         L     @15,GMSTT                                           1982 08032000
         CLR   @04,@15                                             1982 08033000
         BNL   @RF01982                                            1982 08034000
*     IF GMCUR=F0 THEN              /* IS IT FIRST EVER      @OZ30157*/ 08035000
         LTR   @04,@04                                             1983 08036000
         BNZ   @RF01983                                            1983 08037000
*       DO;                         /* YES, INIT GMEND       @OZ30157*/ 08038000
*         GMEND=ADDR(GMTAB(64));    /* TO LAST POSSIBLE ENTRY@OZ30157*/ 08039000
         LA    @04,GMTAB+252                                       1985 08040000
         ST    @04,GMEND                                           1985 08041000
*         GMPTR=GMSTT;              /* AND GMCUR TO FIRST    @OZ30157*/ 08042000
         ST    @15,GMPTR                                           1986 08043000
*       END;                        /*                       @OZ30157*/ 08044000
*     ELSE                          /* FIRST THIS TIME THRU  @OZ30157*/ 08045000
*       GMPTR=GMSTT;                /* YES, SET FIRST ENTRY  @OZ30157*/ 08046000
         B     @RC01983                                            1988 08047000
@RF01983 MVC   GMPTR(4),GMSTT                                      1988 08048000
*   ELSE                            /* NO,                   @OZ30157*/ 08049000
*     GMPTR=GMCUR+F8;               /* SET FOR NEXT ENTRY    @OZ30157*/ 08050000
         B     @RC01982                                            1989 08051000
@RF01982 LA    @04,8                                               1989 08052000
         AL    @04,GMCUR                                           1989 08053000
         ST    @04,GMPTR                                           1989 08054000
*   GMLEN=R0;                       /* SAVE LENGTH           @OZ30157*/ 08055000
@RC01982 L     @04,GMPTR                                           1990 08056000
         ST    R0,GMLEN(,@04)                                      1990 08057000
*   GMSUB=CWBSBPOL;                 /* AND SUBPOOL FROM CWB  @OZ30157*/ 08058000
         L     @15,@CA00041                                        1991 08059000
         L     @15,CWBPTR-CWBPTR(,@15)                             1991 08060000
         MVC   GMSUB(1,@04),CWBSBPOL(@15)                          1991 08061000
*   RFY                                                            1992 08062000
*     R2 RSTD;                      /* RESTRICT R2           @OZ30157*/ 08063000
*   R2=GMSUB;                       /* GET SUBPOOL NUMBER    @OZ30157*/ 08064000
         SLR   R2,R2                                               1993 08065000
         IC    R2,GMSUB(,@04)                                      1993 08066000
*   GEN CODE REFS(R2,R0);                                          1994 08067000
*                                   /* GET QUEUE SPACE       @OZ30157*/ 08068000
GET1     GETMAIN RC,LV=(R0),SP=(R2)                                     08069000
*   RFY                                                            1995 08070000
*     R2 UNRSTD;                    /* FREE R2               @OZ30157*/ 08071000
*   RFY                                                            1996 08072000
*     R0 UNRSTD;                    /* FREE R0               @OZ30157*/ 08073000
*   RFY                                                            1997 08074000
*     R15 RSTD;                     /* AND RESTRICT R15      @OZ30157*/ 08075000
*   RETC=R15;                       /* GET RETURN CODE       @OZ30157*/ 08076000
         STH   R15,RETC                                            1998 08077000
*   RFY                                                            1999 08078000
*     R15 UNRSTD;                   /* AND FREE R15          @OZ30157*/ 08079000
*   IF RETC=0 THEN                  /* IF STORAGE OBTAINED   @OZ30157*/ 08080000
         LH    @04,RETC                                            2000 08081000
         LTR   @04,@04                                             2000 08082000
         BNZ   @RF02000                                            2000 08083000
*     DO;                           /* THEN REMEMBER IT      @OZ30157*/ 08084000
*       INADDR=R1;                  /* PUT ADDR IN POINTER   @OZ30157*/ 08085000
         ST    R1,@TF00001                                         2002 08086000
         L     @04,PARMPTR                                         2002 08087000
         MVC   INADDR(3,@04),@TF00001+1                            2002 08088000
*       GMADR=R1;                   /* AND IN SAVE AREA      @OZ30157*/ 08089000
         L     @04,GMPTR                                           2003 08090000
         ST    R1,GMADR(,@04)                                      2003 08091000
*       GMCUR=GMPTR;                /* FIX ENTRY             @OZ30157*/ 08092000
         ST    @04,GMCUR                                           2004 08093000
*     END;                          /*                       @OZ30157*/ 08094000
*   ELSE                            /* ELSE                  @OZ30157*/ 08095000
*     DO;                           /*                       @OZ30157*/ 08096000
         B     @RC02000                                            2006 08097000
@RF02000 DS    0H                                                  2007 08098000
*       INADDR=F0;                  /* GIVE ZERO ADDRESS     @OZ30157*/ 08099000
         L     @04,PARMPTR                                         2007 08100000
         SLR   @00,@00                                             2007 08101000
         ST    @00,@TF00001                                        2007 08102000
         MVC   INADDR(3,@04),@TF00001+1                            2007 08103000
*       GMCUR=GMPTR-F4;             /* AND GO BACK TO LAST   @OZ30157*/ 08104000
         L     @04,GMPTR                                           2008 08105000
         SL    @04,@CF00045                                        2008 08106000
         ST    @04,GMCUR                                           2008 08107000
*       RETC=F256;                  /* SET HIGH RET CODE     @OZ30157*/ 08108000
         MVC   RETC(2),@CH00866                                    2009 08109000
*       STORER=BONE;                /* AND STORAGE ERROR SW  @OZ30157*/ 08110000
         OI    STORER,B'00000001'                                  2010 08111000
*     END;                          /* SAVE ENTRY            @OZ30157*/ 08112000
*   RFY                                                            2012 08113000
*     R14 RSTD;                     /*                       @OZ30157*/ 08114000
@RC02000 DS    0H                                                  2013 08115000
*   R14=MSG56F14;                   /* RESTORE RETURN REG    @OZ30157*/ 08116000
         L     R14,MSG56F14                                        2013 08117000
*   RFY                                                            2014 08118000
*     R14 UNRSTD;                   /*                       @OZ30157*/ 08119000
*   RETURN;                         /* BACK TO CALLER        @OZ30157*/ 08120000
@EL00015 DS    0H                                                  2015 08121000
@EF00015 DS    0H                                                  2015 08122000
@ER00015 BR    @14                                                 2015 08123000
*   END MSG56F;                     /* END GETMAIN ROUTINE   @OZ30157*/ 08124000
*MSG56G:                                                           2017 08125000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @OZ30157*/ 08126000
MSG56G   DS    0H                                                  2018 08127000
*/********************************************************** @OZ30157*/ 08128000
*/*                                                          @OZ30157*/ 08129000
*/* PROCEDURE NAME: MSG56G                                   @OZ30157*/ 08130000
*/*                                                          @OZ30157*/ 08131000
*/* FUNCTION: DISPLAY CPU PATH STATUS ON CALL FROM MSG56PA   @OZ30157*/ 08132000
*/*                                                          @OZ30157*/ 08133000
*/* INPUTS: CPU PATH STATUS TABLE                            @OZ30157*/ 08134000
*/*                                                          @OZ30157*/ 08135000
*/* OUTPUTS: ONE OR MORE WTO LINES WITH CPU PATH STATUS      @OZ30157*/ 08136000
*/*                                                          @OZ30157*/ 08137000
*/********************************************************** @OZ30157*/ 08138000
*                                                                  2018 08139000
*   DCL                                                            2018 08140000
*     1 CPUMSG BASED(WPLPTR+4),     /* CPU MESSAGE LINE 2    @OZ30157*/ 08141000
*      2 CMCPUID CHAR(10),          /* CPU IDENTIFIER        @OZ30157*/ 08142000
*      2 CMCPSTAT CHAR(5),          /* TOTAL CPU STATUS AREA @OZ30157*/ 08143000
*       3 CMCPST1 CHAR(1),          /* FIRST BYTE OF STATUS  @OZ30157*/ 08144000
*       3 CMCPST2 CHAR(1),          /* SECOND BYTE           @OZ30157*/ 08145000
*       3 CMCPST3 CHAR(1),          /* THIRD                 @OZ30157*/ 08146000
*       3 CMCPST4 CHAR(1),          /* FOURTH                @OZ30157*/ 08147000
*       3 CMCPST5 CHAR(1),          /* FIFTH                 @OZ30157*/ 08148000
*      2 * CHAR(1),                 /* BLANK                 @OZ30157*/ 08149000
*      2 CMCHAN CHAR(1),            /* CHANNEL               @OZ30157*/ 08150000
*      2 * CHAR(2),                 /* BLANK                 @OZ30157*/ 08151000
*      2 CMINTF CHAR(1),            /* INTERFACE             @OZ30157*/ 08152000
*      2 * CHAR(2),                 /* BLANK                 @OZ30157*/ 08153000
*      2 CMSANO CHAR(3),            /* SA OR MSF NUMBER      @OZ30157*/ 08154000
*      2 CMSAST CHAR(6),            /* TOTAL SA STATUS       @OZ30157*/ 08155000
*       3 CMSAST1 CHAR(2),          /* SPACE FOR /O          @OZ30157*/ 08156000
*       3 CMSAST2 CHAR(4),          /* SPACE FOR -SUU        @OZ30157*/ 08157000
*      2 * CHAR(1),                 /* BLANK                 @OZ30157*/ 08158000
*      2 CMSDGS CHAR(5),            /* TOTAL SDG NUMBERS     @OZ30157*/ 08159000
*       3 CMSDG1 CHAR(2),           /* FIRST SDG             @OZ30157*/ 08160000
*       3 CMSDGSEP CHAR(1),         /* SEPARATOR             @OZ30157*/ 08161000
*       3 CMSDG2 CHAR(2),           /* SECOND SDG            @OZ30157*/ 08162000
*      2 * CHAR(1),                 /* BLANK                 @OZ30157*/ 08163000
*      2 CMUSTAT CHAR(33),          /* STATUS AREA           @OZ30157*/ 08164000
*       3 CMUSTON CHAR(31),         /* FOR ONLINE STATUS     @OZ30157*/ 08165000
*        4 CMUSTOF CHAR(29),        /* FOR OFFLINE STATUS    @OZ30157*/ 08166000
*         5 CMUSTSU CHAR(25),       /* FOR SUU STATUS        @OZ30157*/ 08167000
*         5 CMUSUEND CHAR(2),       /* END OF SUU STATUS     @OZ30157*/ 08168000
*        4 CMUOFEND CHAR(2),        /* END OF OFFLINE STATUS @OZ30157*/ 08169000
*       3 CMUONEND CHAR(2);         /* END ONLINE STATUS     @OZ30157*/ 08170000
*   DCL                                                            2019 08171000
*     CMSASTO CHAR(4) DEF(CMSAST) POS(1);/* REDEF FOR /OFF   @OZ30157*/ 08172000
*   DCL                                                            2020 08173000
*     CMCPUIDU CHAR(11) DEF(CMCPUID);/* REDEF FOR UNPACK     @OZ30157*/ 08174000
*   DCL                                                            2021 08175000
*     MUONDSP FIXED(15) INIT(LENGTH(CMUSTON));/*             @OZ30157*/ 08176000
*   DCL                                                            2022 08177000
*     MUOFDSP FIXED(15) INIT(LENGTH(CMUSTOF));/*             @OZ30157*/ 08178000
*   DCL                                                            2023 08179000
*     MUSUDSP FIXED(15) INIT(LENGTH(CMUSTSU));/*             @OZ30157*/ 08180000
*   DCL                                                            2024 08181000
*     1 CMUST BASED(STPTR),         /* REDEF FOR STATUS SET  @OZ30157*/ 08182000
*      2 CMUST1 CHAR(3),            /* FIRST OR ONLY IN GROUP@OZ30157*/ 08183000
*      2 CMUSEP CHAR(1),            /* SLASH OR COMMA        @OZ30157*/ 08184000
*      2 CMUST2 CHAR(3),            /* SECOND IN GROUP       @OZ30157*/ 08185000
*       3 CMUCMA CHAR(1),           /* COMMA WITH ONE VUA    @OZ30157*/ 08186000
*      2 CMUCMA2 CHAR(1);           /* COMMA WITH 2 VUAS     @OZ30157*/ 08187000
*   DCL                                                            2025 08188000
*     CMUSTX CHAR(6) BASED(STPTR);  /* GROUP STATUS          @OZ30157*/ 08189000
*   DCL                                                            2026 08190000
*     1 CMUSTY DEF(CMUSTX) POS(1),  /* REDEF FOR -SUU        @OZ30157*/ 08191000
*      2 * CHAR(3),                 /* NOT USED IN THIS DEF  @OZ30157*/ 08192000
*      2 CMUSTSUU CHAR(4);          /* -SUU SPACE            @OZ30157*/ 08193000
*   DCL                                                            2027 08194000
*     MUEND PTR(32);                /* ADDR OF END           @OZ30157*/ 08195000
*   DCL                                                            2028 08196000
*     MUDSP FIXED(15);              /* DISP OF STATUS FIELD  @OZ30157*/ 08197000
*   DCL                                                            2029 08198000
*     MSTAT CHAR(6);                /* ACTUAL STATUS FIELD   @OZ30157*/ 08199000
*   DCL                                                            2030 08200000
*     MSG56G14 FIXED(31);           /* LOCAL RETURN REG SAVE @OZ30157*/ 08201000
*   RFY                                                            2031 08202000
*     R14 RSTD;                     /*                       @OZ30157*/ 08203000
*   MSG56G14=R14;                   /* SAVE RETURN REG       @OZ30157*/ 08204000
         ST    R14,MSG56G14                                        2032 08205000
*   RFY                                                            2033 08206000
*     R14 UNRSTD;                   /*                       @OZ30157*/ 08207000
*   WPLPTR=WPLPTR+WPLMLLEN;         /* UP BY HDR 2 LENGTH    @OZ30157*/ 08208000
         L     @04,WPLPTR                                          2034 08209000
         SLR   @00,@00                                             2034 08210000
         IC    @00,WPLMLLEN(,@04)                                  2034 08211000
         ALR   @00,@04                                             2034 08212000
         ST    @00,WPLPTR                                          2034 08213000
*   WPLML0=F0;                      /* CLEAR LENGTH HIGH ORD@OZ30157 */ 08214000
         LR    @04,@00                                             2035 08215000
         MVI   WPLML0(@04),X'00'                                   2035 08216000
*   WPLMLLTF=''B;                   /* CLEAR FLAG FIELD      @OZ30157*/ 08217000
         LR    @04,@00                                             2036 08218000
         XC    WPLMLLTF(2,@04),WPLMLLTF(@04)                       2036 08219000
*   WPLMLLTC=BONE;                  /* SET DATA LINE FLAG    @OZ30157*/ 08220000
         LR    @04,@00                                             2037 08221000
         OI    WPLMLLTC(@04),B'00100000'                           2037 08222000
*   WPLMLTXT=MESGS(MSG05606);       /* CLEAR THE LINE        @OZ30157*/ 08223000
         LR    @04,@00                                             2038 08224000
         MVI   WPLMLTXT+72(@04),C' '                               2038 08225000
         MVC   WPLMLTXT+73(53,@04),WPLMLTXT+72(@04)                2038 08226000
         MVC   WPLMLTXT(72,@04),MESGS+1596                         2038 08227000
*   WPLMLLEN=MESGLEN(MSG05606)+F4;  /* SET LENGTH            @OZ30157*/ 08228000
         LA    @04,4                                               2039 08229000
         MVC   @ZT00003+3(1),MESGLEN+1596                          2039 08230000
         AL    @04,@ZT00003                                        2039 08231000
         LR    @15,@00                                             2039 08232000
         STC   @04,WPLMLLEN(,@15)                                  2039 08233000
*   MSGIND=MSG05606;                /* AND INDICATOR         @OZ30157*/ 08234000
         MVI   MSGIND,X'16'                                        2040 08235000
*   IF CPUPTR^=F0 THEN              /* SHOULD WE DO IT       @OZ30157*/ 08236000
         L     @04,CPUPTR                                          2041 08237000
         LTR   @04,@04                                             2041 08238000
         BZ    @RF02041                                            2041 08239000
*     DO CPHPTR=CPUPTR TO CPHEND BY CPHLEN;/* LOOP ALL CPUS  @OZ30157*/ 08240000
         ST    @04,CPHPTR                                          2042 08241000
         B     @DE02042                                            2042 08242000
@DL02042 DS    0H                                                  2043 08243000
*       UNPK(CMCPUIDU,CPHIDP);      /* UNPACK CPUID          @OZ30157*/ 08244000
         LA    @15,4                                               2043 08245000
         AL    @15,WPLPTR                                          2043 08246000
         UNPK  CMCPUIDU(11,@15),CPHIDP(6,@04)                      2043 08247000
*       IF CPHIN=BONE|CPHPRI=BONE|CPHASC=BONE THEN/* IF ANY STAT   2044 08248000
*                                                            @OZ30157*/ 08249000
         TM    CPHIN(@04),B'11100000'                              2044 08250000
         BZ    @RF02044                                            2044 08251000
*         DO;                       /* THEN SET SLASH IN     @OZ30157*/ 08252000
*           CMCPSTAT='/   ';        /* AND CLEAR REST        @OZ30157*/ 08253000
         MVI   CMCPSTAT+4(@15),C' '                                2046 08254000
         MVC   CMCPSTAT(4,@15),@CC03435                            2046 08255000
*           K=2;                    /* SET INDEX FOR START   @OZ30157*/ 08256000
         MVC   K(2),@CH00056                                       2047 08257000
*           IF CPHIN=BONE THEN      /* IF INITIALIZED        @OZ30157*/ 08258000
         TM    CPHIN(@04),B'10000000'                              2048 08259000
         BNO   @RF02048                                            2048 08260000
*             DO;                   /* SET INIT STATUS       @OZ30157*/ 08261000
*               CMCPSTAT='/I  ';    /* INTO FIELD AND        @OZ30157*/ 08262000
         MVI   CMCPSTAT+4(@15),C' '                                2050 08263000
         MVC   CMCPSTAT(4,@15),@CC03436                            2050 08264000
*               K=3;                /* INDEX TO THIRD POS    @OZ30157*/ 08265000
         MVC   K(2),@CH00060                                       2051 08266000
*             END;                  /*                       @OZ30157*/ 08267000
*           IF CPHPRI=BONE THEN     /* IF PRIMARY CPU        @OZ30157*/ 08268000
@RF02048 L     @04,CPHPTR                                          2053 08269000
         TM    CPHPRI(@04),B'01000000'                             2053 08270000
         BNO   @RF02053                                            2053 08271000
*             DO;                   /* THEN SAY SO           @OZ30157*/ 08272000
*               CMCPSTAT(K:K)='P';  /* WITH P IN STAT        @OZ30157*/ 08273000
         LH    @04,K                                               2055 08274000
         L     @15,WPLPTR                                          2055 08275000
         ALR   @15,@04                                             2055 08276000
         MVI   CMCPSTAT+3(@15),C'P'                                2055 08277000
*               K=K+1;              /* AND BUMP INDEX        @OZ30157*/ 08278000
         LA    @04,1(,@04)                                         2056 08279000
         STH   @04,K                                               2056 08280000
*             END;                  /* END PRI STAT          @OZ30157*/ 08281000
*           IF CPHASC=BONE THEN     /* IF ASSOCIATED,        @OZ30157*/ 08282000
@RF02053 L     @04,CPHPTR                                          2058 08283000
         TM    CPHASC(@04),B'00100000'                             2058 08284000
         BNO   @RF02058                                            2058 08285000
*             CMCPSTAT(K:K+1)='-A'; /* SAY SO                @OZ30157*/ 08286000
         LH    @04,K                                               2059 08287000
         L     @15,WPLPTR                                          2059 08288000
         ALR   @15,@04                                             2059 08289000
         MVC   CMCPSTAT+3(2,@15),@CC03438                          2059 08290000
*         END;                      /* END CPU STATUS        @OZ30157*/ 08291000
*       ELSE                                                       2061 08292000
*         CMCPSTAT='     ';         /* ELSE CLEAR STATUS     @OZ30157*/ 08293000
         B     @RC02044                                            2061 08294000
@RF02044 L     @04,WPLPTR                                          2061 08295000
         MVC   CMCPSTAT+4(5,@04),@CC03439                          2061 08296000
*       CMCHAN=CPHCH;               /* SET MSC CHANNEL       @OZ30157*/ 08297000
@RC02044 LA    @04,4                                               2062 08298000
         AL    @04,WPLPTR                                          2062 08299000
         L     @15,CPHPTR                                          2062 08300000
         MVC   CMCHAN(1,@04),CPHCH(@15)                            2062 08301000
*       CMINTF=CPHINT;              /* AND INTERFACE ID      @OZ30157*/ 08302000
         MVC   CMINTF(1,@04),CPHINT(@15)                           2063 08303000
*       CMSANO=CPHMSAD;             /* UNIT ADDRESS          @OZ30157*/ 08304000
         MVC   CMSANO(3,@04),CPHMSAD(@15)                          2064 08305000
*       CALL MSG56D;                /* BUMP MSG POINTERS     @OZ30157*/ 08306000
         BAL   @14,MSG56D                                          2065 08307000
*       CPDPTR=CPHDET;              /* LOCATE FIRST DET ENTRY@OZ30157*/ 08308000
         L     @04,CPHPTR                                          2066 08309000
         L     @04,CPHDET-1(,@04)                                  2066 08310000
         LA    @04,0(,@04)                                         2066 08311000
         ST    @04,CPDPTR                                          2066 08312000
*       CMCPUID=BLANK;              /* NO CPUID HERE         @OZ30157*/ 08313000
         LA    @15,4                                               2067 08314000
         AL    @15,WPLPTR                                          2067 08315000
         MVC   CMCPUID(10,@15),@CC02699                            2067 08316000
*       CMCPSTAT=BLANK;             /* NO CPU STATUS         @OZ30157*/ 08317000
         MVC   CMCPSTAT(5,@15),@CC02699                            2068 08318000
*       IF CPDPTR^=F0 THEN          /* DO ONLY IF TABLE EX.  @OZ30157*/ 08319000
         LTR   @04,@04                                             2069 08320000
         BZ    @RF02069                                            2069 08321000
*         DO UNTIL(CPDPTR=F0);      /* LOOP TO DET END       @OZ30157*/ 08322000
@DL02070 DS    0H                                                  2071 08323000
*           VALFLG=BZERO;           /* START AS INVALID      @OZ30157*/ 08324000
         NI    VALFLG,B'11011111'                                  2071 08325000
*           IF(CPDONL^=F0)&(DSPON=BONE) THEN/* IF ANY VALID LINE   2072 08326000
*                                                            @OZ30157*/ 08327000
         L     @04,CPDPTR                                          2072 08328000
         L     @00,CPDONL-1(,@04)                                  2072 08329000
         N     @00,@CF03658                                        2072 08330000
         LTR   @00,@00                                             2072 08331000
         BZ    @RF02072                                            2072 08332000
         L     @15,@CA00041                                        2072 08333000
         L     @15,CWBPTR-CWBPTR(,@15)                             2072 08334000
         TM    DSPON(@15),B'01000000'                              2072 08335000
         BNO   @RF02072                                            2072 08336000
*             CPDSAVAL=BONE;        /* THEN MUST DISPLAY SA  @OZ30157*/ 08337000
         OI    CPDSAVAL(@04),B'00100000'                           2073 08338000
*           IF(CPDOFF^=F0)&(DSPOFF=BONE) THEN/* OR ANY VAL OFFL    2074 08339000
*                                                            @OZ30157*/ 08340000
@RF02072 L     @04,CPDPTR                                          2074 08341000
         L     @00,CPDOFF(,@04)                                    2074 08342000
         LTR   @00,@00                                             2074 08343000
         BZ    @RF02074                                            2074 08344000
         L     @15,@CA00041                                        2074 08345000
         L     @15,CWBPTR-CWBPTR(,@15)                             2074 08346000
         TM    DSPOFF(@15),B'00100000'                             2074 08347000
         BNO   @RF02074                                            2074 08348000
*             CPDSAVAL=BONE;        /* MUST DISP ALSO        @OZ30157*/ 08349000
         OI    CPDSAVAL(@04),B'00100000'                           2075 08350000
*           IF CPDSAVAL=BONE THEN   /* IF SA VALID STATUS    @OZ30157*/ 08351000
@RF02074 L     @04,CPDPTR                                          2076 08352000
         TM    CPDSAVAL(@04),B'00100000'                           2076 08353000
         BNO   @RF02076                                            2076 08354000
*             DO;                   /* FOR DISPLAY, THEN     @OZ30157*/ 08355000
*               CMSANO=CPDSAAD;     /* SA SSID               @OZ30157*/ 08356000
         LA    @15,4                                               2078 08357000
         AL    @15,WPLPTR                                          2078 08358000
         MVC   CMSANO(3,@15),CPDSAAD(@04)                          2078 08359000
*               IF CPDSAOF=BONE THEN/* IF SA IS OFFLINE      @OZ30157*/ 08360000
         TM    CPDSAOF(@04),B'10000000'                            2079 08361000
         BNO   @RF02079                                            2079 08362000
*                 CMSAST='/OFF  ';  /* SAY SO                @OZ30157*/ 08363000
         MVC   CMSAST(6,@15),@CC03440                              2080 08364000
*               ELSE                /* IF NOT                @OZ30157*/ 08365000
*                 DO;               /* THEN IS ONLINE        @OZ30157*/ 08366000
         B     @RC02079                                            2081 08367000
@RF02079 DS    0H                                                  2082 08368000
*                   CMSAST='/O    ';/* SAY THAT AND          @OZ30157*/ 08369000
         LA    @04,4                                               2082 08370000
         AL    @04,WPLPTR                                          2082 08371000
         MVC   CMSAST(6,@04),@CC03441                              2082 08372000
*                   IF CPDSARDY=BZERO THEN/* IF NOT READY    @OZ30157*/ 08373000
         L     @15,CPDPTR                                          2083 08374000
         TM    CPDSARDY(@15),B'01000000'                           2083 08375000
         BNZ   @RF02083                                            2083 08376000
*                     CMSAST2='-SUU';/* THEN IS SUU          @OZ30157*/ 08377000
         MVC   CMSAST2(4,@04),@CC03442                             2084 08378000
*                 END;              /* END SA STATUS SET     @OZ30157*/ 08379000
@RF02083 DS    0H                                                  2086 08380000
*             END;                  /* END VALID SA STATUS   @OZ30157*/ 08381000
@RC02079 DS    0H                                                  2087 08382000
*           CMCHAN=CPDCH;           /* CHANNEL FOR SA        @OZ30157*/ 08383000
@RF02076 LA    @04,4                                               2087 08384000
         AL    @04,WPLPTR                                          2087 08385000
         L     @15,CPDPTR                                          2087 08386000
         MVC   CMCHAN(1,@04),CPDCH(@15)                            2087 08387000
*           TR(CMCHAN,TRANS);       /* TRANSLATE ALPHAS      @OZ30157*/ 08388000
         TR    CMCHAN(1,@04),TRANS                                 2088 08389000
*           CMINTF=CPDINT;          /* INTERFACE FOR SA      @OZ30157*/ 08390000
         MVC   CMINTF(1,@04),CPDINT(@15)                           2089 08391000
*           CMSDG1=CPDSDG1;         /* FIRST OR ONLY SDG     @OZ30157*/ 08392000
         MVC   CMSDG1(2,@04),CPDSDG1(@15)                          2090 08393000
*           IF CPDSDG2^='0000'X THEN/* IF SECOND SDG, THEN   @OZ30157*/ 08394000
         CLC   CPDSDG2(2,@15),@CB03443                             2091 08395000
         BE    @RF02091                                            2091 08396000
*             DO;                   /* SET SEPARATOR AND     @OZ30157*/ 08397000
*               CMSDGSEP=',';       /* ALSO SET              @OZ30157*/ 08398000
         MVI   CMSDGSEP(@04),C','                                  2093 08399000
*               CMSDG2=CPDSDG2;     /* SDG2 FIELD            @OZ30157*/ 08400000
         MVC   CMSDG2(2,@04),CPDSDG2(@15)                          2094 08401000
*             END;                  /* END SDG PRINT         @OZ30157*/ 08402000
*           IF CPDONL^=F0 THEN      /* ONLINE                @OZ30157*/ 08403000
@RF02091 L     @04,CPDPTR                                          2096 08404000
         L     @15,CPDONL-1(,@04)                                  2096 08405000
         LA    @15,0(,@15)                                         2096 08406000
         LTR   @15,@15                                             2096 08407000
         BZ    @RF02096                                            2096 08408000
*             DO;                   /*                       @OZ30157*/ 08409000
*               TABPTR=CPDONL;      /* SET SCANNING POINTER  @OZ30157*/ 08410000
         ST    @15,TABPTR                                          2098 08411000
*               MUDSP=MUONDSP;      /* END LINE DISPLACEMENT @OZ30157*/ 08412000
         MVC   MUDSP(2),MUONDSP                                    2099 08413000
*               IF CPDFLG1=BZERO THEN/* IF IS ACTUALLY ONLINE      2100 08414000
*                                                            @OZ30157*/ 08415000
         TM    CPDFLG1(@04),B'10000000'                            2100 08416000
         BNZ   @RF02100                                            2100 08417000
*                 IF DSPON=BONE THEN/* THEN IF ONL OR BOTH   @OZ30157*/ 08418000
         L     @04,@CA00041                                        2101 08419000
         L     @04,CWBPTR-CWBPTR(,@04)                             2101 08420000
         TM    DSPON(@04),B'01000000'                              2101 08421000
         BNO   @RF02101                                            2101 08422000
*                   DO;             /* REQUESTED             @OZ30157*/ 08423000
*                     MSTAT='/O    ';/* STATUS VALUE         @OZ30157*/ 08424000
         MVC   MSTAT(6),@CC03441                                   2103 08425000
*                     CALL VUAPRT;  /* AND PRINT LINE        @OZ30157*/ 08426000
         BAL   @14,VUAPRT                                          2104 08427000
*                   END;            /* END ACTUAL ONLINE     @OZ30157*/ 08428000
*                 ELSE                                             2106 08429000
*                   ;               /*                       @OZ30157*/ 08430000
@RF02101 DS    0H                                                  2107 08431000
*               ELSE                                               2107 08432000
*                 IF CPDSAVAL=BONE THEN/* IF NOT, MUST BE    @OZ30157*/ 08433000
         B     @RC02100                                            2107 08434000
@RF02100 L     @04,CPDPTR                                          2107 08435000
         TM    CPDSAVAL(@04),B'00100000'                           2107 08436000
         BNO   @RF02107                                            2107 08437000
*                   DO;             /* GENERAL - NOT SAME CPU@OZ30157*/ 08438000
*                     MSTAT='      ';/* STATUS VALUE         @OZ30157*/ 08439000
         MVC   MSTAT(6),@CC01404                                   2109 08440000
*                     CALL VUAPRT;  /* AND PRINT LINE        @OZ30157*/ 08441000
         BAL   @14,VUAPRT                                          2110 08442000
*                   END;            /* END NOT SAME CPU      @OZ30157*/ 08443000
*             END;                  /*                       @OZ30157*/ 08444000
@RF02107 DS    0H                                                  2112 08445000
@RC02100 DS    0H                                                  2113 08446000
*           IF(CPDOFF^=F0)&(DSPOFF=BONE) THEN/* IF ANY VALID @OZ30157*/ 08447000
@RF02096 L     @04,CPDPTR                                          2113 08448000
         L     @04,CPDOFF(,@04)                                    2113 08449000
         LTR   @04,@04                                             2113 08450000
         BZ    @RF02113                                            2113 08451000
         L     @15,@CA00041                                        2113 08452000
         L     @15,CWBPTR-CWBPTR(,@15)                             2113 08453000
         TM    DSPOFF(@15),B'00100000'                             2113 08454000
         BNO   @RF02113                                            2113 08455000
*             DO;                   /* DISPLAY THEM          @OZ30157*/ 08456000
*               TABPTR=CPDOFF;      /* SET SCANNING POINTER  @OZ30157*/ 08457000
         ST    @04,TABPTR                                          2115 08458000
*               MUDSP=MUOFDSP;      /* END LINE DISPLACEMENT @OZ30157*/ 08459000
         MVC   MUDSP(2),MUOFDSP                                    2116 08460000
*               MSTAT='/OFF  ';     /* STATUS VALUE          @OZ30157*/ 08461000
         MVC   MSTAT(6),@CC03440                                   2117 08462000
*               CALL VUAPRT;        /* AND CALL PRT RTN      @OZ30157*/ 08463000
         BAL   @14,VUAPRT                                          2118 08464000
*             END;                  /*                       @OZ30157*/ 08465000
*           IF CPDSUU^=F0 THEN      /* DO ONLINE FIRST       @OZ30157*/ 08466000
@RF02113 L     @04,CPDPTR                                          2120 08467000
         L     @04,CPDSUU(,@04)                                    2120 08468000
         LTR   @04,@04                                             2120 08469000
         BZ    @RF02120                                            2120 08470000
*             DO;                   /*                       @OZ30157*/ 08471000
*               TABPTR=CPDSUU;      /* SET SCANNING POINTER  @OZ30157*/ 08472000
         ST    @04,TABPTR                                          2122 08473000
*               MUDSP=MUSUDSP;      /* END LINE DISPLACEMENT @OZ30157*/ 08474000
         MVC   MUDSP(2),MUSUDSP                                    2123 08475000
*               MSTAT='/O-SUU';     /* STATUS VALUE          @OZ30157*/ 08476000
         MVC   MSTAT(6),@CC03446                                   2124 08477000
*               CALL VUAPRT;        /* AND CALL PRT RTN      @OZ30157*/ 08478000
         BAL   @14,VUAPRT                                          2125 08479000
*             END;                  /*                       @OZ30157*/ 08480000
*           IF VALFLG=BZERO THEN    /* IF NO VUA PRINT DONE  @OZ30157*/ 08481000
@RF02120 TM    VALFLG,B'00100000'                                  2127 08482000
         BNZ   @RF02127                                            2127 08483000
*             IF CPDSAVAL=BONE THEN /* BUT SA IS VALID       @OZ30157*/ 08484000
         L     @04,CPDPTR                                          2128 08485000
         TM    CPDSAVAL(@04),B'00100000'                           2128 08486000
         BNO   @RF02128                                            2128 08487000
*               CALL MSG56D;        /* PRINT SA LINE         @OZ30157*/ 08488000
         BAL   @14,MSG56D                                          2129 08489000
*             ELSE                  /* NONE VALID, WIPE      @OZ30157*/ 08490000
*               WPLMLTXT=MESGS(MSG05606);/* OUT DATA IN LINE @OZ30157*/ 08491000
         B     @RC02128                                            2130 08492000
@RF02128 L     @04,WPLPTR                                          2130 08493000
         MVI   WPLMLTXT+72(@04),C' '                               2130 08494000
         MVC   WPLMLTXT+73(53,@04),WPLMLTXT+72(@04)                2130 08495000
         MVC   WPLMLTXT(72,@04),MESGS+1596                         2130 08496000
*           ELSE                                                   2131 08497000
*             ;                     /* PRINT WAS DONE        @OZ30157*/ 08498000
@RF02127 DS    0H                                                  2132 08499000
*           CPDPTR=CPDCHN;          /* BUMP TO NEXT DETAIL   @OZ30157*/ 08500000
@RC02127 L     @04,CPDPTR                                          2132 08501000
         L     @04,CPDCHN(,@04)                                    2132 08502000
         ST    @04,CPDPTR                                          2132 08503000
*         END;                      /* END DETAIL CHAIN LOOP @OZ30157*/ 08504000
@DE02070 L     @04,CPDPTR                                          2133 08505000
         LTR   @04,@04                                             2133 08506000
         BNZ   @DL02070                                            2133 08507000
*     END;                          /* END CPU LOOP          @OZ30157*/ 08508000
@RF02069 LA    @04,16                                              2134 08509000
         AL    @04,CPHPTR                                          2134 08510000
         ST    @04,CPHPTR                                          2134 08511000
@DE02042 C     @04,CPHEND                                          2134 08512000
         BNH   @DL02042                                            2134 08513000
*   VALFLG=BZERO;                   /* RESET FOR LATER       @OZ30157*/ 08514000
@RF02041 NI    VALFLG,B'11011111'                                  2135 08515000
*   RFY                                                            2136 08516000
*     R14 RSTD;                     /*                       @OZ30157*/ 08517000
*   R14=MSG56G14;                   /* RESTORE RETURN REG    @OZ30157*/ 08518000
         L     R14,MSG56G14                                        2137 08519000
*   RFY                                                            2138 08520000
*     R14 UNRSTD;                   /*                       @OZ30157*/ 08521000
*   RETURN;                         /* BACK TO CALLER        @OZ30157*/ 08522000
@EL00016 DS    0H                                                  2139 08523000
@EF00016 DS    0H                                                  2139 08524000
@ER00016 BR    @14                                                 2139 08525000
*VUAPRT:                                                           2140 08526000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @OZ30157*/ 08527000
VUAPRT   DS    0H                                                  2141 08528000
*/********************************************************** @OZ30157*/ 08529000
*/*                                                          @OZ30157*/ 08530000
*/* PROCEDURE NAME: VUAPRT                                   @OZ30157*/ 08531000
*/*                                                          @OZ30157*/ 08532000
*/* FUNCTION: SCAN THROUGH ALL VUA TABLE ENTRIES ON ONE CPD  @OZ30157*/ 08533000
*/*           TABLE CHAIN, FORMAT WTO LINES AND CALL MSG56G  @OZ30157*/ 08534000
*/*           AS NECESSARY TO WRITE THEM.                    @OZ30157*/ 08535000
*/*                                                          @OZ30157*/ 08536000
*/* INPUTS: CPU PATH STATUS VUA TABLE                        @OZ30157*/ 08537000
*/*         TABPTR SET TO ADDR OF FIRST VUA ENTRY            @OZ30157*/ 08538000
*/*         MUEDISP SET TO DISPLACEMENT OF LAST POSSIBLE     @OZ30157*/ 08539000
*/*             STATUS FIELD IN THIS LINE                    @OZ30157*/ 08540000
*/*         MSTAT SET TO STATUS VALUE                        @OZ30157*/ 08541000
*/*                                                          @OZ30157*/ 08542000
*/* OUTPUTS: ONE OR MORE WTO LINES WITH CPU PATH STATUS      @OZ30157*/ 08543000
*/*                                                          @OZ30157*/ 08544000
*/********************************************************** @OZ30157*/ 08545000
*                                                                  2141 08546000
*   DCL                                                            2141 08547000
*     MSG56V14 FIXED(31);           /*                       @OZ30157*/ 08548000
*   RFY                                                            2142 08549000
*     R14 RSTD;                     /*                       @OZ30157*/ 08550000
*   MSG56V14=R14;                   /* SAVE RETURN REG       @OZ30157*/ 08551000
         ST    R14,MSG56V14                                        2143 08552000
*   RFY                                                            2144 08553000
*     R14 UNRSTD;                   /*                       @OZ30157*/ 08554000
*   IF TABPTR^=F0 THEN              /* IF VUA IS VALID       @OZ30157*/ 08555000
         L     @04,TABPTR                                          2145 08556000
         LTR   @04,@04                                             2145 08557000
         BZ    @RF02145                                            2145 08558000
*     DO;                           /* MUST PRINT DATA       @OZ30157*/ 08559000
*       VALFLG=BONE;                /* AND SAY THAT WE DID   @OZ30157*/ 08560000
         OI    VALFLG,B'00100000'                                  2147 08561000
*       DO UNTIL(TABPTR=F0);        /* LOOP THROUGH ALL ONL  @OZ30157*/ 08562000
@DL02148 DS    0H                                                  2149 08563000
*         STPTR=ADDR(CMUSTAT);      /* INIT STATUS POINTER   @OZ30157*/ 08564000
         L     @04,WPLPTR                                          2149 08565000
         LA    @04,CMUSTAT+4(,@04)                                 2149 08566000
         ST    @04,STPTR                                           2149 08567000
*         MUEND=STPTR+MUDSP;        /* POINT TO END OF LINE  @OZ30157*/ 08568000
         AH    @04,MUDSP                                           2150 08569000
         ST    @04,MUEND                                           2150 08570000
*         DO K=1 TO VUACNT BY 1;    /* LOOP THROUGH ENTRY    @OZ30157*/ 08571000
         LA    @04,1                                               2151 08572000
         STH   @04,K                                               2151 08573000
         B     @DE02151                                            2151 08574000
@DL02151 DS    0H                                                  2152 08575000
*           I=0;                    /* CLEAR                 @OZ30157*/ 08576000
         SLR   @00,@00                                             2152 08577000
         STH   @00,I                                               2152 08578000
*           IF VUAB(K)^='   ' THEN  /* IF TWO VUAS           @OZ30157*/ 08579000
         MH    @04,@CH00038                                        2153 08580000
         L     @15,TABPTR                                          2153 08581000
         ALR   @15,@04                                             2153 08582000
         CLC   VUAB-6(3,@15),@CC03112                              2153 08583000
         BE    @RF02153                                            2153 08584000
*             I=4;                  /* ADJUST CHECK LOCATE   @OZ30157*/ 08585000
         MVC   I(2),@CH00045                                       2154 08586000
*           IF STPTR>=MUEND-I THEN  /* IF REACH END OF LINE  @OZ30157*/ 08587000
@RF02153 L     @04,STPTR                                           2155 08588000
         L     @00,MUEND                                           2155 08589000
         LH    @15,I                                               2155 08590000
         SLR   @00,@15                                             2155 08591000
         CLR   @04,@00                                             2155 08592000
         BL    @RF02155                                            2155 08593000
*             DO;                   /* MUST PLACE PROPER     @OZ30157*/ 08594000
*               STPTR=STPTR-1;      /* STATUS IN RIGHT POS.  @OZ30157*/ 08595000
         BCTR  @04,0                                               2157 08596000
         ST    @04,STPTR                                           2157 08597000
*               CMUSTX=MSTAT;       /* SO DO SO              @OZ30157*/ 08598000
         MVC   CMUSTX(6,@04),MSTAT                                 2158 08599000
*               CALL MSG56D;        /* CALL MSG56D FOR MOVE  @OZ30157*/ 08600000
         BAL   @14,MSG56D                                          2159 08601000
*               STPTR=ADDR(CMUSTAT);/* FOR NEXT LINE         @OZ30157*/ 08602000
         L     @04,WPLPTR                                          2160 08603000
         LA    @04,CMUSTAT+4(,@04)                                 2160 08604000
         ST    @04,STPTR                                           2160 08605000
*             END;                  /*                       @OZ30157*/ 08606000
*           CMUST1=VUAA(K);         /* PUT IN FIRST VUA      @OZ30157*/ 08607000
@RF02155 L     @04,STPTR                                           2162 08608000
         L     @15,TABPTR                                          2162 08609000
         LH    @14,K                                               2162 08610000
         MH    @14,@CH00038                                        2162 08611000
         ST    @14,@TF00001                                        2162 08612000
         ALR   @14,@15                                             2162 08613000
         BCTR  @14,0                                               2162 08614000
         BCTR  @14,0                                               2162 08615000
         MVC   CMUST1(3,@04),VUAA-4(@14)                           2162 08616000
*           IF VUAB(K)^='   ' THEN  /* IF SECOND VUA         @OZ30157*/ 08617000
         LR    @14,@15                                             2163 08618000
         AL    @14,@TF00001                                        2163 08619000
         CLC   VUAB-6(3,@14),@CC03112                              2163 08620000
         BE    @RF02163                                            2163 08621000
*             DO;                   /* PUT IT IN             @OZ30157*/ 08622000
*               CMUSEP='-';         /* WITH SEPARATOR        @OZ30157*/ 08623000
         MVI   CMUSEP(@04),C'-'                                    2165 08624000
*               CMUST2=VUAB(K);     /* AND VUA               @OZ30157*/ 08625000
         AL    @15,@TF00001                                        2166 08626000
         MVC   CMUST2(3,@04),VUAB-6(@15)                           2166 08627000
*               CMUCMA2=',';        /*                       @OZ30157*/ 08628000
         MVI   CMUCMA2(@04),C','                                   2167 08629000
*               STPTR=STPTR+8;      /* BUMP FOR NEXT GROUP   @OZ30157*/ 08630000
         AH    @04,@CH00036                                        2168 08631000
         ST    @04,STPTR                                           2168 08632000
*             END;                  /* END VUA GROUP         @OZ30157*/ 08633000
*           ELSE                    /* ELSE SINGLE VUA       @OZ30157*/ 08634000
*             DO;                   /* SO SET ONLY ONE       @OZ30157*/ 08635000
         B     @RC02163                                            2170 08636000
@RF02163 DS    0H                                                  2171 08637000
*               CMUSEP=',';         /* WITH COMMA FOR SEP    @OZ30157*/ 08638000
         L     @04,STPTR                                           2171 08639000
         MVI   CMUSEP(@04),C','                                    2171 08640000
*               STPTR=STPTR+4;      /* VUA NUMBER AND        @OZ30157*/ 08641000
         AL    @04,@CF00045                                        2172 08642000
         ST    @04,STPTR                                           2172 08643000
*             END;                  /* END SINGLE VUA        @OZ30157*/ 08644000
*         END;                      /* END LINE              @OZ30157*/ 08645000
@RC02163 LA    @04,1                                               2174 08646000
         AH    @04,K                                               2174 08647000
         STH   @04,K                                               2174 08648000
@DE02151 L     @15,TABPTR                                          2174 08649000
         MVC   @ZT00003+3(1),VUACNT(@15)                           2174 08650000
         C     @04,@ZT00003                                        2174 08651000
         BNH   @DL02151                                            2174 08652000
*         STPTR=STPTR-1;            /* SET FOR STATUS MOVE   @OZ30157*/ 08653000
         L     @04,STPTR                                           2175 08654000
         BCTR  @04,0                                               2175 08655000
         ST    @04,STPTR                                           2175 08656000
*         CMUSTX=MSTAT;             /* MOVE STATUS           @OZ30157*/ 08657000
         MVC   CMUSTX(6,@04),MSTAT                                 2176 08658000
*         CALL MSG56D;              /* CALL MSG56D FOR LINE  @OZ30157*/ 08659000
         BAL   @14,MSG56D                                          2177 08660000
*         TABPTR=VUACHN;            /* BUMP TO NEXT ENTRY    @OZ30157*/ 08661000
         L     @04,TABPTR                                          2178 08662000
         L     @04,VUACHN-1(,@04)                                  2178 08663000
         LA    @04,0(,@04)                                         2178 08664000
         ST    @04,TABPTR                                          2178 08665000
*       END;                        /* END ONE VUA ENTRY     @OZ30157*/ 08666000
@DE02148 L     @04,TABPTR                                          2179 08667000
         LTR   @04,@04                                             2179 08668000
         BNZ   @DL02148                                            2179 08669000
*     END;                          /* END VALID DATA        @OZ30157*/ 08670000
*   RFY                                                            2181 08671000
*     R14 RSTD;                     /*                       @OZ30157*/ 08672000
@RF02145 DS    0H                                                  2182 08673000
*   R14=MSG56V14;                   /* RESTORE RETURN REG    @OZ30157*/ 08674000
         L     R14,MSG56V14                                        2182 08675000
*   RFY                                                            2183 08676000
*     R14 UNRSTD;                   /*                       @OZ30157*/ 08677000
*   RETURN;                         /*                       @OZ30157*/ 08678000
@EL00017 DS    0H                                                  2184 08679000
@EF00017 DS    0H                                                  2184 08680000
@ER00017 BR    @14                                                 2184 08681000
*   END VUAPRT;                     /* END OF PRINT ROUTINE  @OZ30157*/ 08682000
*   END MSG56G;                     /* END DISP CPU PATHS    @OZ30157*/ 08683000
*MSG56H:                                                           2187 08684000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @OZ30157*/ 08685000
MSG56H   DS    0H                                                  2188 08686000
*/********************************************************** @OZ30157*/ 08687000
*/*                                                          @OZ30157*/ 08688000
*/* PROCEDURE NAME: MSG56H                                   @OZ30157*/ 08689000
*/*                                                          @OZ30157*/ 08690000
*/* FUNCTION: DISPLAY SDG PATH STATUS ON CALL FROM MSG56PA   @OZ30157*/ 08691000
*/*                                                          @OZ30157*/ 08692000
*/* INPUTS: SDG PATH STATUS TABLE                            @OZ30157*/ 08693000
*/*                                                          @OZ30157*/ 08694000
*/* OUTPUTS: ONE OR MORE WTO LINES WITH SDG PATH STATUS      @OZ30157*/ 08695000
*/*                                                          @OZ30157*/ 08696000
*/********************************************************** @OZ30157*/ 08697000
*                                                                  2188 08698000
*   DCL                                                            2188 08699000
*     1 SDGMSG BASED(SDGMPTR),      /* ONE HALF LINE         @OZ30157*/ 08700000
*      2 SDMSDGN CHAR(2),           /* SDG NUMBER            @OZ30157*/ 08701000
*       3 * CHAR(1),                /* FIRST BYTE            @OZ30157*/ 08702000
*       3 SDMSDGN2 CHAR(1),         /* SECOND BYTE           @OZ30157*/ 08703000
*      2 * CHAR(3),                 /* BLANKS                @OZ30157*/ 08704000
*      2 * CHAR(3),                 /* SA SSID               @OZ30157*/ 08705000
*       3 SDMSA CHAR(1),            /* FIRST BYTE            @OZ30157*/ 08706000
*       3 SDMSAU CHAR(2),           /* DEF FOR UNPACK        @OZ30157*/ 08707000
*        4 * CHAR(1),               /* NOT REF'D             @OZ30157*/ 08708000
*        4 SDMSAX CHAR(1),          /* CLEAR TO 0            @OZ30157*/ 08709000
*      2 SDMSASUU CHAR(6),          /* SUU STATUS            @OZ30157*/ 08710000
*       3 SDMSAOFF CHAR(4),         /* OFFLINE STATUS        @OZ30157*/ 08711000
*        4 SDMSAON CHAR(2),         /* ONLINE STATUS         @OZ30157*/ 08712000
*      2 * CHAR(1),                 /* BLANK SEPARATOR       @OZ30157*/ 08713000
*      2 SDMDR CHAR(3),             /* DRC SSID              @OZ30157*/ 08714000
*      2 SDMDRSUU CHAR(6),          /* SUU STATUS            @OZ30157*/ 08715000
*       3 SDMDROFF CHAR(4),         /* OFFLINE STATUS        @OZ30157*/ 08716000
*        4 SDMDRON CHAR(2),         /* ONLINE STATUS         @OZ30157*/ 08717000
*      2 * CHAR(12);                /* BLANKS                @OZ30157*/ 08718000
*   DCL                                                            2189 08719000
*     1 * CHAR(4) DEF(SDMDR),       /* REDEF FOR UNPACK      @OZ30157*/ 08720000
*      2 * CHAR(1),                 /* NO REF                @OZ30157*/ 08721000
*      2 SDMDRU CHAR(3),            /* FOR UNPACK            @OZ30157*/ 08722000
*       3 SDMDRA CHAR(2),           /* FOR TRANSLATE         @OZ30157*/ 08723000
*       3 SDMDRX CHAR(1);           /* CLEAR TO 0            @OZ30157*/ 08724000
*   DCL                                                            2190 08725000
*     SDGMPTR PTR(31);              /* HALF LINE BASE        @OZ30157*/ 08726000
*   DCL                                                            2191 08727000
*     MSG56H14 FIXED(31);           /* LOCAL RETURN REG SAVE @OZ30157*/ 08728000
*   RFY                                                            2192 08729000
*     R14 RSTD;                     /*                       @OZ30157*/ 08730000
*   MSG56H14=R14;                   /* SAVE RETURN REG       @OZ30157*/ 08731000
         ST    R14,MSG56H14                                        2193 08732000
*   RFY                                                            2194 08733000
*     R14 UNRSTD;                   /*                       @OZ30157*/ 08734000
*   RETC=F0;                        /* INITIALIZE RET CODE   @OZ30157*/ 08735000
         SLR   @04,@04                                             2195 08736000
         STH   @04,RETC                                            2195 08737000
*   WPLPTR=WPLPTR+WPLMLLEN;         /* UP BY HDR 2 LENGTH    @OZ30157*/ 08738000
         L     @15,WPLPTR                                          2196 08739000
         SLR   @00,@00                                             2196 08740000
         IC    @00,WPLMLLEN(,@15)                                  2196 08741000
         ALR   @00,@15                                             2196 08742000
         ST    @00,WPLPTR                                          2196 08743000
*   MSGIND=MSG05606;                /* SET MESSAGE TYPE      @OZ30157*/ 08744000
         MVI   MSGIND,X'16'                                        2197 08745000
*   WPLMLLTF=''B;                   /* CLEAR FLAG FIELD      @OZ30157*/ 08746000
         LR    @15,@00                                             2198 08747000
         XC    WPLMLLTF(2,@15),WPLMLLTF(@15)                       2198 08748000
*   WPLMLLTC=BONE;                  /* SET DATA LINE FLAG    @OZ30157*/ 08749000
         LR    @15,@00                                             2199 08750000
         OI    WPLMLLTC(@15),B'00100000'                           2199 08751000
*   WPLMLTXT=MESGS(MSG05606);       /* CLEAR THE LINE        @OZ30157*/ 08752000
         LR    @15,@00                                             2200 08753000
         MVI   WPLMLTXT+72(@15),C' '                               2200 08754000
         MVC   WPLMLTXT+73(53,@15),WPLMLTXT+72(@15)                2200 08755000
         MVC   WPLMLTXT(72,@15),MESGS+1596                         2200 08756000
*   WPLMLLEN=MESGLEN(MSG05606)+F4;  /* SET LENGTH            @OZ30157*/ 08757000
         LA    @15,4                                               2201 08758000
         SLR   @14,@14                                             2201 08759000
         IC    @14,MESGLEN+1596                                    2201 08760000
         ALR   @14,@15                                             2201 08761000
         LR    @03,@00                                             2201 08762000
         STC   @14,WPLMLLEN(,@03)                                  2201 08763000
*   FLIPSW=BZERO;                   /* START IN FIRST HALF   @OZ30157*/ 08764000
         NI    FLIPSW,B'11101111'                                  2202 08765000
*   TABPTR=SDGPTR;                  /* START OF TABLE        @OZ30157*/ 08766000
         L     @14,SDGPTR                                          2203 08767000
         ST    @14,TABPTR                                          2203 08768000
*   SDGMPTR=ADDR(FHALF);            /* INITIAL VALUE         @OZ30157*/ 08769000
         ALR   @00,@15                                             2204 08770000
         ST    @00,SDGMPTR                                         2204 08771000
*   ERRFLG=BONE;                    /* SET IN CASE NO VALID  @OZ30157*/ 08772000
         OI    ERRFLG,B'10000000'                                  2205 08773000
*   IF TABPTR=F0 THEN               /* CHECK FOR VALID ENTRY @OZ30157*/ 08774000
         CR    @14,@04                                             2206 08775000
         BNE   @RF02206                                            2206 08776000
*     DO;                           /*                       @OZ30157*/ 08777000
*       RETC=F2;                    /* IF NONE, SAY SO       @OZ30157*/ 08778000
         MVC   RETC(2),@CH00056                                    2208 08779000
*     END;                          /*                       @OZ30157*/ 08780000
*   ELSE                            /* AT LEAST ONE          @OZ30157*/ 08781000
*     DO;                           /* SO SCAN ALL SDG ENTRY @OZ30157*/ 08782000
         B     @RC02206                                            2210 08783000
@RF02206 DS    0H                                                  2211 08784000
*       RETC=F0;                    /* INSURE GOOD END       @OZ30157*/ 08785000
         SLR   @04,@04                                             2211 08786000
         STH   @04,RETC                                            2211 08787000
*       DO UNTIL(TABPTR=F0);        /* EXISTS, SO LOOP       @OZ30157*/ 08788000
@DL02212 DS    0H                                                  2213 08789000
*         DO I=1 TO 2;              /* DO BOTH SAS           @OZ30157*/ 08790000
         LA    @04,1                                               2213 08791000
         STH   @04,I                                               2213 08792000
@DL02213 DS    0H                                                  2214 08793000
*           IF FLIPSW=BZERO THEN    /* SET PROPER HALF-LINE  @OZ30157*/ 08794000
         TM    FLIPSW,B'00010000'                                  2214 08795000
         BNZ   @RF02214                                            2214 08796000
*             SDGMPTR=ADDR(FHALF);  /* INTO LINE POINTER     @OZ30157*/ 08797000
         LA    @04,4                                               2215 08798000
         AL    @04,WPLPTR                                          2215 08799000
         ST    @04,SDGMPTR                                         2215 08800000
*           ELSE                    /*                       @OZ30157*/ 08801000
*             SDGMPTR=ADDR(SHALF);  /*                       @OZ30157*/ 08802000
         B     @RC02214                                            2216 08803000
@RF02214 L     @04,WPLPTR                                          2216 08804000
         LA    @04,SHALF+4(,@04)                                   2216 08805000
         ST    @04,SDGMPTR                                         2216 08806000
*           VALFLG=BZERO;           /* SAY LINE NOT VALID    @OZ30157*/ 08807000
@RC02214 NI    VALFLG,B'11011111'                                  2217 08808000
*           IF(DSPON=BONE)&(DSPOFF=BONE) THEN/* IF BOTH      @OZ30157*/ 08809000
         L     @04,@CA00041                                        2218 08810000
         L     @04,CWBPTR-CWBPTR(,@04)                             2218 08811000
         TM    DSPON(@04),B'01100000'                              2218 08812000
         BNO   @RF02218                                            2218 08813000
*             VALFLG=BONE;          /* LINE IS VALID         @OZ30157*/ 08814000
         OI    VALFLG,B'00100000'                                  2219 08815000
*           ELSE                    /* ELSE IF ONLINE ONLY   @OZ30157*/ 08816000
*             IF DSPON=BONE THEN    /* THEN CK ANY ONLINE    @OZ30157*/ 08817000
         B     @RC02218                                            2220 08818000
@RF02218 L     @04,@CA00041                                        2220 08819000
         L     @04,CWBPTR-CWBPTR(,@04)                             2220 08820000
         TM    DSPON(@04),B'01000000'                              2220 08821000
         BNO   @RF02220                                            2220 08822000
*               IF(SDGSAOF(I)=BZERO)|(SDGDCOF(I)=BZERO) THEN/*     2221 08823000
*                                                            @OZ30157*/ 08824000
         L     @04,TABPTR                                          2221 08825000
         LH    @15,I                                               2221 08826000
         MH    @15,@CH00038                                        2221 08827000
         ST    @15,@TF00001                                        2221 08828000
         ALR   @15,@04                                             2221 08829000
         BCTR  @15,0                                               2221 08830000
         TM    SDGSAOF-5(@15),B'10000000'                          2221 08831000
         BZ    @RT02221                                            2221 08832000
         AL    @04,@TF00001                                        2221 08833000
         TM    SDGDCOF-6(@04),B'10000000'                          2221 08834000
         BNZ   @RF02221                                            2221 08835000
@RT02221 DS    0H                                                  2222 08836000
*                 VALFLG=BONE;      /* FOUND AT LEAST ONE ONLINE   2222 08837000
*                                                            @OZ30157*/ 08838000
         OI    VALFLG,B'00100000'                                  2222 08839000
*               ELSE                                               2223 08840000
*                 ;                 /* NONE ONLINE           @OZ30157*/ 08841000
@RF02221 DS    0H                                                  2224 08842000
*             ELSE                  /* CHECK OFFLINE         @OZ30157*/ 08843000
*               IF(SDGSAOF(I)=BONE)|(SDGDCOF(I)=BONE) THEN/* @OZ30157*/ 08844000
         B     @RC02220                                            2224 08845000
@RF02220 L     @04,TABPTR                                          2224 08846000
         LH    @15,I                                               2224 08847000
         MH    @15,@CH00038                                        2224 08848000
         ST    @15,@TF00001                                        2224 08849000
         ALR   @15,@04                                             2224 08850000
         BCTR  @15,0                                               2224 08851000
         TM    SDGSAOF-5(@15),B'10000000'                          2224 08852000
         BO    @RT02224                                            2224 08853000
         AL    @04,@TF00001                                        2224 08854000
         TM    SDGDCOF-6(@04),B'10000000'                          2224 08855000
         BNO   @RF02224                                            2224 08856000
@RT02224 DS    0H                                                  2225 08857000
*                 VALFLG=BONE;      /* MUST PRINT LINE       @OZ30157*/ 08858000
         OI    VALFLG,B'00100000'                                  2225 08859000
*           IF VALFLG=BONE THEN     /* IF VALID FOR DISPLAY  @OZ30157*/ 08860000
@RF02224 DS    0H                                                  2226 08861000
@RC02220 DS    0H                                                  2226 08862000
@RC02218 TM    VALFLG,B'00100000'                                  2226 08863000
         BNO   @RF02226                                            2226 08864000
*             DO;                   /* THEN PUT IN LINE      @OZ30157*/ 08865000
*               CVD(SDGNUM,SDMSAU); /* GET IN DECIMAL        @OZ30157*/ 08866000
         L     @04,TABPTR                                          2228 08867000
         SLR   @00,@00                                             2228 08868000
         IC    @00,SDGNUM(,@04)                                    2228 08869000
         L     @15,SDGMPTR                                         2228 08870000
         CVD   @00,@TS00001                                        2228 08871000
         MVC   SDMSAU(2,@15),@TS00001+6                            2228 08872000
*               UNPK(SDMSDGN,SDMSAU);/* UNPACK SDG NUMBER    @OZ30157*/ 08873000
         UNPK  SDMSDGN(2,@15),SDMSAU(2,@15)                        2229 08874000
*               SDMSDGN2=SDMSDGN2|'0';/* CLEAR SIGN          @OZ30157*/ 08875000
         OI    SDMSDGN2(@15),C'0'                                  2230 08876000
*               ERRFLG=BZERO;       /* SAY FOUND ONE LINE    @OZ30157*/ 08877000
         NI    ERRFLG,B'01111111'                                  2231 08878000
*               UNPK(SDMSAU,SDGSANOP(I));/* UNPACK IT (1 TO F)     2232 08879000
*                                                            @OZ30157*/ 08880000
         LH    @14,I                                               2232 08881000
         MH    @14,@CH00038                                        2232 08882000
         ST    @14,@TF00001                                        2232 08883000
         ALR   @14,@04                                             2232 08884000
         BCTR  @14,0                                               2232 08885000
         BCTR  @14,0                                               2232 08886000
         UNPK  SDMSAU(2,@15),SDGSANOP-4(2,@14)                     2232 08887000
*               TR(SDMSAU,TRANS);   /* TRANSLATE TO PRINT    @OZ30157*/ 08888000
         TR    SDMSAU(2,@15),TRANS                                 2233 08889000
*               SDMSA='8';          /* SET FIRST CHARACTER   @OZ30157*/ 08890000
         MVI   SDMSA(@15),C'8'                                     2234 08891000
*               SDMSAX='0';         /* AND THIRD CHARACTER   @OZ30157*/ 08892000
         MVI   SDMSAX(@15),C'0'                                    2235 08893000
*               IF SDGSAOF(I)=BONE THEN/* IF OFFLINE         @OZ30157*/ 08894000
         AL    @04,@TF00001                                        2236 08895000
         BCTR  @04,0                                               2236 08896000
         TM    SDGSAOF-5(@04),B'10000000'                          2236 08897000
         BNO   @RF02236                                            2236 08898000
*                 SDMSAOFF='/OFF';  /* SAY SO                @OZ30157*/ 08899000
         MVC   SDMSAOFF(4,@15),@CC03482                            2237 08900000
*               ELSE                /* IF NOT, CHECK SUU     @OZ30157*/ 08901000
*                 IF SDGSARDY(I)=BZERO THEN/* IF SUU, THEN   @OZ30157*/ 08902000
         B     @RC02236                                            2238 08903000
@RF02236 LH    @04,I                                               2238 08904000
         MH    @04,@CH00038                                        2238 08905000
         L     @15,TABPTR                                          2238 08906000
         ALR   @15,@04                                             2238 08907000
         BCTR  @15,0                                               2238 08908000
         TM    SDGSARDY-5(@15),B'01000000'                         2238 08909000
         BNZ   @RF02238                                            2238 08910000
*                   SDMSASUU='/O-SUU';/* SAY THAT            @OZ30157*/ 08911000
         L     @04,SDGMPTR                                         2239 08912000
         MVC   SDMSASUU(6,@04),@CC03446                            2239 08913000
*                 ELSE              /* IF NOT THAT, MUST     @OZ30157*/ 08914000
*                   SDMSAON='/O';   /* BE ONLINE             @OZ30157*/ 08915000
         B     @RC02238                                            2240 08916000
@RF02238 L     @04,SDGMPTR                                         2240 08917000
         MVC   SDMSAON(2,@04),@CC03483                             2240 08918000
*               IF((SDGDCOF(I)=BONE)&(DSPOFF=BONE))|((SDGDCOF(I)=BZERO) 08919000
*                   &(DSPON=BONE))|(SDGDCRDY(I)=BZERO) THEN/* IF VLD    08920000
*                                      FOR DISPLAY           @OZ30157*/ 08921000
@RC02238 DS    0H                                                  2241 08922000
@RC02236 LH    @04,I                                               2241 08923000
         MH    @04,@CH00038                                        2241 08924000
         L     @15,TABPTR                                          2241 08925000
         ALR   @15,@04                                             2241 08926000
         TM    SDGDCOF-6(@15),B'10000000'                          2241 08927000
         BNO   @GL00027                                            2241 08928000
         L     @04,@CA00041                                        2241 08929000
         L     @04,CWBPTR-CWBPTR(,@04)                             2241 08930000
         TM    DSPOFF(@04),B'00100000'                             2241 08931000
         BO    @RT02241                                            2241 08932000
@GL00027 LH    @04,I                                               2241 08933000
         MH    @04,@CH00038                                        2241 08934000
         L     @15,TABPTR                                          2241 08935000
         ALR   @15,@04                                             2241 08936000
         TM    SDGDCOF-6(@15),B'10000000'                          2241 08937000
         BNZ   @GL00026                                            2241 08938000
         L     @04,@CA00041                                        2241 08939000
         L     @04,CWBPTR-CWBPTR(,@04)                             2241 08940000
         TM    DSPON(@04),B'01000000'                              2241 08941000
         BO    @RT02241                                            2241 08942000
@GL00026 LH    @04,I                                               2241 08943000
         MH    @04,@CH00038                                        2241 08944000
         L     @15,TABPTR                                          2241 08945000
         ALR   @15,@04                                             2241 08946000
         TM    SDGDCRDY-6(@15),B'01000000'                         2241 08947000
         BNZ   @RF02241                                            2241 08948000
@RT02241 DS    0H                                                  2242 08949000
*                 DO;               /* THEN DO IT            @OZ30157*/ 08950000
*                   SDMDR='400';    /* SET BASE VALUE        @OZ30157*/ 08951000
         L     @04,SDGMPTR                                         2243 08952000
         MVC   SDMDR(3,@04),@CC01484                               2243 08953000
*                   SDMDRA=SDGCSFNP(I);/* PUT IN CSF AND DRC @OZ30157*/ 08954000
         L     @15,TABPTR                                          2244 08955000
         LH    @14,I                                               2244 08956000
         MH    @14,@CH00038                                        2244 08957000
         ST    @14,@TF00001                                        2244 08958000
         ALR   @14,@15                                             2244 08959000
         MVC   SDMDRA(2,@04),SDGCSFNP-6(@14)                       2244 08960000
*                   TR(SDMDRA,NUMBRS);/* TRANSLATE FOR PRINT @OZ30157*/ 08961000
         TR    SDMDRA(2,@04),NUMBRS                                2245 08962000
*                   SDMDRX=' ';     /* CLEAR EXTRA BYTE      @OZ30157*/ 08963000
         MVI   SDMDRX(@04),C' '                                    2246 08964000
*                   IF SDGDCOF(I)=BONE THEN/* IF OFFLINE     @OZ30157*/ 08965000
         AL    @15,@TF00001                                        2247 08966000
         TM    SDGDCOF-6(@15),B'10000000'                          2247 08967000
         BNO   @RF02247                                            2247 08968000
*                     SDMDROFF='/OFF';/* SAY SO              @OZ30157*/ 08969000
         MVC   SDMDROFF(4,@04),@CC03482                            2248 08970000
*                   ELSE            /*                       @OZ30157*/ 08971000
*                     IF SDGDCRDY(I)=BONE THEN/* SUU         @OZ30157*/ 08972000
         B     @RC02247                                            2249 08973000
@RF02247 LH    @04,I                                               2249 08974000
         MH    @04,@CH00038                                        2249 08975000
         L     @15,TABPTR                                          2249 08976000
         ALR   @15,@04                                             2249 08977000
         TM    SDGDCRDY-6(@15),B'01000000'                         2249 08978000
         BNO   @RF02249                                            2249 08979000
*                       SDMDRSUU='/O-SUU';/*                 @OZ30157*/ 08980000
         L     @04,SDGMPTR                                         2250 08981000
         MVC   SDMDRSUU(6,@04),@CC03446                            2250 08982000
*                     ELSE          /*                       @OZ30157*/ 08983000
*                       SDMDRON='/O';/* ONLINE               @OZ30157*/ 08984000
         B     @RC02249                                            2251 08985000
@RF02249 L     @04,SDGMPTR                                         2251 08986000
         MVC   SDMDRON(2,@04),@CC03483                             2251 08987000
*                 END;              /*                       @OZ30157*/ 08988000
@RC02249 DS    0H                                                  2252 08989000
@RC02247 DS    0H                                                  2253 08990000
*               IF FLIPSW=BONE THEN /* IF SECOND HALF DONE   @OZ30157*/ 08991000
@RF02241 TM    FLIPSW,B'00010000'                                  2253 08992000
         BNO   @RF02253                                            2253 08993000
*                 CALL MSG56D;      /* PRINT MESSAGE         @OZ30157*/ 08994000
         BAL   @14,MSG56D                                          2254 08995000
*               ELSE                /*                       @OZ30157*/ 08996000
*                 FLIPSW=BONE;      /*                       @OZ30157*/ 08997000
         B     @RC02253                                            2255 08998000
@RF02253 OI    FLIPSW,B'00010000'                                  2255 08999000
*             END;                  /* END VALID SA          @OZ30157*/ 09000000
@RC02253 DS    0H                                                  2257 09001000
*         END;                      /* END ONE SA            @OZ30157*/ 09002000
@RF02226 LA    @04,1                                               2257 09003000
         AH    @04,I                                               2257 09004000
         STH   @04,I                                               2257 09005000
         CH    @04,@CH00056                                        2257 09006000
         BNH   @DL02213                                            2257 09007000
*         TABPTR=SDGCHN;            /* CHAIN TO NEXT ONE     @OZ30157*/ 09008000
         L     @04,TABPTR                                          2258 09009000
         L     @04,SDGCHN-1(,@04)                                  2258 09010000
         LA    @04,0(,@04)                                         2258 09011000
         ST    @04,TABPTR                                          2258 09012000
*       END;                        /* END SCAN ROUTINE      @OZ30157*/ 09013000
@DE02212 L     @04,TABPTR                                          2259 09014000
         LTR   @04,@04                                             2259 09015000
         BNZ   @DL02212                                            2259 09016000
*       VALSSID=BONE;               /* INSURE PRINT IT       @OZ30157*/ 09017000
         OI    VALSSID,B'01000000'                                 2260 09018000
*     END;                          /* END GOOD RUN          @OZ30157*/ 09019000
*   IF ERRFLG=BONE THEN             /* IF NO VALID FOR DISP  @OZ30157*/ 09020000
@RC02206 TM    ERRFLG,B'10000000'                                  2262 09021000
         BNO   @RF02262                                            2262 09022000
*     DO;                           /* MUST PRINT ERR MSG    @OZ30157*/ 09023000
*       IF DSPON=BONE THEN          /* EITHER NO PATHS ONL   @OZ30157*/ 09024000
         L     @04,@CA00041                                        2264 09025000
         L     @04,CWBPTR-CWBPTR(,@04)                             2264 09026000
         TM    DSPON(@04),B'01000000'                              2264 09027000
         BNO   @RF02264                                            2264 09028000
*         SDGMSG='NO PATHS ONLINE'; /* IN MESSAGE            @OZ30157*/ 09029000
         L     @04,SDGMPTR                                         2265 09030000
         MVI   SDGMSG+15(@04),C' '                                 2265 09031000
         MVC   SDGMSG+16(20,@04),SDGMSG+15(@04)                    2265 09032000
         MVC   SDGMSG(15,@04),@CC03484                             2265 09033000
*       ELSE                        /* OR NONE OFFLINE       @OZ30157*/ 09034000
*         SDGMSG='NO PATHS OFFLINE';/* IN MESSAGE            @OZ30157*/ 09035000
         B     @RC02264                                            2266 09036000
@RF02264 L     @04,SDGMPTR                                         2266 09037000
         MVI   SDGMSG+16(@04),C' '                                 2266 09038000
         MVC   SDGMSG+17(19,@04),SDGMSG+16(@04)                    2266 09039000
         MVC   SDGMSG(16,@04),@CC03486                             2266 09040000
*       CALL MSG56D;                /* DISPLAY MESSAGE       @OZ30157*/ 09041000
@RC02264 BAL   @14,MSG56D                                          2267 09042000
*     END;                          /* AND END IT ALL        @OZ30157*/ 09043000
*   RFY                                                            2269 09044000
*     R14 RSTD;                     /*                       @OZ30157*/ 09045000
@RF02262 DS    0H                                                  2270 09046000
*   R14=MSG56H14;                   /* RESTORE RETURN REG    @OZ30157*/ 09047000
         L     R14,MSG56H14                                        2270 09048000
*   RFY                                                            2271 09049000
*     R14 UNRSTD;                   /*                       @OZ30157*/ 09050000
*   RETURN;                                                        2272 09051000
@EL00018 DS    0H                                                  2272 09052000
@EF00018 DS    0H                                                  2272 09053000
@ER00018 BR    @14                                                 2272 09054000
*   ;                               /*                       @OZ30157*/ 09055000
*   END MSG56H;                     /* END SDG DISPLAY RTN   @OZ30157*/ 09056000
*MSG56I:                                                           2275 09057000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @OZ30157*/ 09058000
MSG56I   DS    0H                                                  2276 09059000
*/********************************************************** @OZ30157*/ 09060000
*/*                                                          @OZ30157*/ 09061000
*/* PROCEDURE NAME: MSG56I                                   @OZ30157*/ 09062000
*/*                                                          @OZ30157*/ 09063000
*/* FUNCTION: DISPLAY DRC PATH STATUS ON CALL FROM MSG56PA   @OZ30157*/ 09064000
*/*                                                          @OZ30157*/ 09065000
*/* INPUTS: DRC PATH STATUS TABLE                            @OZ30157*/ 09066000
*/*                                                          @OZ30157*/ 09067000
*/* OUTPUTS: ONE OR MORE WTO LINES WITH DRC PATH STATUS      @OZ30157*/ 09068000
*/*                                                          @OZ30157*/ 09069000
*/********************************************************** @OZ30157*/ 09070000
*                                                                  2276 09071000
*   DCL                                                            2276 09072000
*     1 DRCMSG CHAR(70) BASED(WPLPTR+4),/* DRC PATH MSG      @OZ30157*/ 09073000
*      2 MDRSA CHAR(3),             /* SA SSID               @OZ30157*/ 09074000
*      2 MDRSASUU CHAR(6),          /* SUU STATUS            @OZ30157*/ 09075000
*       3 MDRSAOFF CHAR(4),         /* OFFLINE STATUS        @OZ30157*/ 09076000
*        4 MDRSAON CHAR(2),         /* ONLINE STATUS         @OZ30157*/ 09077000
*      2 * CHAR(1),                 /* BLANK                 @OZ30157*/ 09078000
*      2 MDRDRC CHAR(3),            /* DRC SSID              @OZ30157*/ 09079000
*      2 MDRDCUNA CHAR(7),          /* DRC UNAVAILABLE       @OZ30157*/ 09080000
*       3 MDRDCSUU CHAR(6),         /* DRC SUU               @OZ30157*/ 09081000
*        4 MDRDCOFF CHAR(4),        /* DRC OFFLINE           @OZ30157*/ 09082000
*         5 MDRDCON CHAR(2),        /* DRC ONLINE            @OZ30157*/ 09083000
*      2 MDRDRDS(4) CHAR(12),       /* ARRAY OF 4 DRDS       @OZ30157*/ 09084000
*       3 * CHAR(2),                /* BLANK                 @OZ30157*/ 09085000
*       3 MDRDRD CHAR(3),           /* DRD SSID              @OZ30157*/ 09086000
*       3 MDRDDUNA CHAR(7),         /* UNAVAILABLE STATUS    @OZ30157*/ 09087000
*        4 MDRDDSUU CHAR(6),        /* SUU STATUS            @OZ30157*/ 09088000
*         5 MDRDDOFF CHAR(4),       /* OFFLINE STATUS        @OZ30157*/ 09089000
*          6 MDRDDON CHAR(2);       /* ONLINE STATUS         @OZ30157*/ 09090000
*   DCL                                                            2277 09091000
*     STDEF CHAR(7);                /* SAVE AREA FOR STATUS  @OZ30157*/ 09092000
*   DCL                                                            2278 09093000
*     MSG56I14 FIXED(31);           /* LOCAL RETURN REG SAVE @OZ30157*/ 09094000
*   RFY                                                            2279 09095000
*     R14 RSTD;                     /*                       @OZ30157*/ 09096000
*   MSG56I14=R14;                   /* SAVE RETURN REG       @OZ30157*/ 09097000
         ST    R14,MSG56I14                                        2280 09098000
*   RFY                                                            2281 09099000
*     R14 UNRSTD;                   /*                       @OZ30157*/ 09100000
*   WPLPTR=WPLPTR+WPLMLLEN;         /* UP BY HDR 2 LENGTH    @OZ30157*/ 09101000
         L     @04,WPLPTR                                          2282 09102000
         SLR   @00,@00                                             2282 09103000
         IC    @00,WPLMLLEN(,@04)                                  2282 09104000
         ALR   @00,@04                                             2282 09105000
         ST    @00,WPLPTR                                          2282 09106000
*   WPLMLLTF=''B;                   /* CLEAR FLAG FIELD      @OZ30157*/ 09107000
         LR    @04,@00                                             2283 09108000
         XC    WPLMLLTF(2,@04),WPLMLLTF(@04)                       2283 09109000
*   WPLMLLTC=BONE;                  /* SET DATA LINE FLAG    @OZ30157*/ 09110000
         LR    @04,@00                                             2284 09111000
         OI    WPLMLLTC(@04),B'00100000'                           2284 09112000
*   WPLMLTXT=MESGS(MSG05606);       /* CLEAR THE LINE        @OZ30157*/ 09113000
         LR    @04,@00                                             2285 09114000
         MVI   WPLMLTXT+72(@04),C' '                               2285 09115000
         MVC   WPLMLTXT+73(53,@04),WPLMLTXT+72(@04)                2285 09116000
         MVC   WPLMLTXT(72,@04),MESGS+1596                         2285 09117000
*   WPLMLLEN=MESGLEN(MSG05606)+F4;  /* SET LENGTH            @OZ30157*/ 09118000
         LA    @04,4                                               2286 09119000
         MVC   @ZT00003+3(1),MESGLEN+1596                          2286 09120000
         AL    @04,@ZT00003                                        2286 09121000
         LR    @15,@00                                             2286 09122000
         STC   @04,WPLMLLEN(,@15)                                  2286 09123000
*   MSGIND=MSG05606;                /* AND INDICATOR FOR D   @OZ30157*/ 09124000
         MVI   MSGIND,X'16'                                        2287 09125000
*/* START AT DRCPTR AND SCAN WITH TABPTR2 TO LAST DRC ENTRY  @OZ30157*/ 09126000
*                                                                  2288 09127000
*   TABPTR2=DRCPTR;                 /* INITIAL START VALUE   @OZ30157*/ 09128000
         L     @04,DRCPTR                                          2288 09129000
         ST    @04,TABPTR2                                         2288 09130000
*   ERRFLG=BONE;                    /* SAY NO VALID ONES     @OZ30157*/ 09131000
         OI    ERRFLG,B'10000000'                                  2289 09132000
*   IF TABPTR2^=F0 THEN             /* IF TABLE BUILT        @OZ30157*/ 09133000
         LTR   @04,@04                                             2290 09134000
         BZ    @RF02290                                            2290 09135000
*     DO UNTIL(TABPTR2=0);          /* LOOP TO END OF CHAIN  @OZ30157*/ 09136000
@DL02291 DS    0H                                                  2292 09137000
*       VALFLG=BZERO;               /* NO VALID IN LOOP YET  @OZ30157*/ 09138000
         NI    VALFLG,B'11011111'                                  2292 09139000
*       IF DSPON=BONE&DSPOFF=BONE THEN/* IF ACCEPT ANY       @OZ30157*/ 09140000
         L     @04,@CA00041                                        2293 09141000
         L     @04,CWBPTR-CWBPTR(,@04)                             2293 09142000
         TM    DSPON(@04),B'01100000'                              2293 09143000
         BNO   @RF02293                                            2293 09144000
*         VALFLG=BONE;              /* SAY ONE FOUND         @OZ30157*/ 09145000
         OI    VALFLG,B'00100000'                                  2294 09146000
*       ELSE                        /* IF WANT ONLY          @OZ30157*/ 09147000
*         IF DSPON=BONE THEN        /* ONLINE, CHECK FOR ONE @OZ30157*/ 09148000
         B     @RC02293                                            2295 09149000
@RF02293 L     @04,@CA00041                                        2295 09150000
         L     @04,CWBPTR-CWBPTR(,@04)                             2295 09151000
         TM    DSPON(@04),B'01000000'                              2295 09152000
         BNO   @RF02295                                            2295 09153000
*           IF(DRCSAOF=BZERO)|(DRCDCOF=BZERO) THEN/* IF ANY DRC ON 2296 09154000
*                                                            @OZ30157*/ 09155000
         L     @04,TABPTR2                                         2296 09156000
         TM    DRCSAOF(@04),B'10001000'                            2296 09157000
         BO    @RF02296                                            2296 09158000
*             VALFLG=BONE;          /* THEN LINE VALID       @OZ30157*/ 09159000
         OI    VALFLG,B'00100000'                                  2297 09160000
*           ELSE                    /* IF NOT, MUST CK DRD   @OZ30157*/ 09161000
*             DO I=1 TO 4;          /* PATHS - ALL FOUR      @OZ30157*/ 09162000
         B     @RC02296                                            2298 09163000
@RF02296 LA    @04,1                                               2298 09164000
         STH   @04,I                                               2298 09165000
@DL02298 DS    0H                                                  2299 09166000
*               IF DRCDRDOF(I)=BZERO THEN/* IF ONLINE, THEN  @OZ30157*/ 09167000
         SLA   @04,2                                               2299 09168000
         L     @15,TABPTR2                                         2299 09169000
         ALR   @15,@04                                             2299 09170000
         TM    DRCDRDOF-4(@15),B'10000000'                         2299 09171000
         BNZ   @RF02299                                            2299 09172000
*                 VALFLG=BONE;      /* SET FLAG ON           @OZ30157*/ 09173000
         OI    VALFLG,B'00100000'                                  2300 09174000
*             END;                  /* LOOP THROUGH 4        @OZ30157*/ 09175000
@RF02299 LA    @04,1                                               2301 09176000
         AH    @04,I                                               2301 09177000
         STH   @04,I                                               2301 09178000
         CH    @04,@CH00045                                        2301 09179000
         BNH   @DL02298                                            2301 09180000
*         ELSE                      /* MUST BE OFFL REQUEST  @OZ30157*/ 09181000
*           IF(DRCSAOF=BONE)|(DRCDCOF=BONE) THEN/* IF OFFLINE      2302 09182000
*                                                            @OZ30157*/ 09183000
         B     @RC02295                                            2302 09184000
@RF02295 L     @04,TABPTR2                                         2302 09185000
         TM    DRCSAOF(@04),B'10001000'                            2302 09186000
         BZ    @RF02302                                            2302 09187000
*             VALFLG=BONE;          /* THEN VALID DISPLAY    @OZ30157*/ 09188000
         OI    VALFLG,B'00100000'                                  2303 09189000
*           ELSE                    /* IF NOT, CHECK DRDS    @OZ30157*/ 09190000
*             DO I=1 TO 4;          /* INVALID AND RESET     @OZ30157*/ 09191000
         B     @RC02302                                            2304 09192000
@RF02302 LA    @04,1                                               2304 09193000
         STH   @04,I                                               2304 09194000
@DL02304 DS    0H                                                  2305 09195000
*               IF DRCDCOF=BONE THEN/* IF OFFLINE THEN       @OZ30157*/ 09196000
         L     @04,TABPTR2                                         2305 09197000
         TM    DRCDCOF(@04),B'00001000'                            2305 09198000
         BNO   @RF02305                                            2305 09199000
*                 VALFLG=BONE;      /* SAY VALID             @OZ30157*/ 09200000
         OI    VALFLG,B'00100000'                                  2306 09201000
*             END;                  /* END LOOP OFFLINE      @OZ30157*/ 09202000
@RF02305 LA    @04,1                                               2307 09203000
         AH    @04,I                                               2307 09204000
         STH   @04,I                                               2307 09205000
         CH    @04,@CH00045                                        2307 09206000
         BNH   @DL02304                                            2307 09207000
*       IF VALFLG=BONE THEN         /* IF VALID ENTRY        @OZ30157*/ 09208000
@RC02302 DS    0H                                                  2308 09209000
@RC02295 DS    0H                                                  2308 09210000
@RC02293 TM    VALFLG,B'00100000'                                  2308 09211000
         BNO   @RF02308                                            2308 09212000
*         DO;                       /* MUST DISPLAY IT       @OZ30157*/ 09213000
*           ERRFLG=BZERO;           /* SAY ONE FOUND         @OZ30157*/ 09214000
         NI    ERRFLG,B'01111111'                                  2310 09215000
*           MDRSA=DRCSAID;          /* GET SA SSID           @OZ30157*/ 09216000
         LA    @04,4                                               2311 09217000
         AL    @04,WPLPTR                                          2311 09218000
         L     @15,TABPTR2                                         2311 09219000
         MVC   MDRSA(3,@04),DRCSAID(@15)                           2311 09220000
*           IF DRCSAOF=BONE THEN    /* IF SA IS OFFLINE      @OZ30157*/ 09221000
         TM    DRCSAOF(@15),B'10000000'                            2312 09222000
         BNO   @RF02312                                            2312 09223000
*             DO;                   /* SAY SO, SET DEF TO UNA@OZ30157*/ 09224000
*               STDEF='/O-UNAV';    /* DEFAULT VALUE         @OZ30157*/ 09225000
         MVC   STDEF(7),@CC03511                                   2314 09226000
*               MDRSAOFF='/OFF';    /* SA IS OFFLINE         @OZ30157*/ 09227000
         MVC   MDRSAOFF(4,@04),@CC03482                            2315 09228000
*             END;                  /*                       @OZ30157*/ 09229000
*           ELSE                    /*                       @OZ30157*/ 09230000
*             IF DRCSARDY=BZERO|DRCSANA=BONE THEN/* IF UNAVAILABLE 2317 09231000
*                                                            @OZ30157*/ 09232000
         B     @RC02312                                            2317 09233000
@RF02312 L     @04,TABPTR2                                         2317 09234000
         TM    DRCSANA(@04),B'00100000'                            2317 09235000
         BNZ   @RT02317                                            2317 09236000
         TM    DRCSARDY(@04),B'01000000'                           2317 09237000
         BO    @RF02317                                            2317 09238000
@RT02317 DS    0H                                                  2318 09239000
*               DO;                 /* SAME AS ABOVE         @OZ30157*/ 09240000
*                 STDEF='/O-UNAV';  /* FOR DEFAULT VALUE     @OZ30157*/ 09241000
         MVC   STDEF(7),@CC03511                                   2319 09242000
*                 MDRSASUU='/O-SUU';/* BUT SA IS SUU         @OZ30157*/ 09243000
         L     @04,WPLPTR                                          2320 09244000
         MVC   MDRSASUU+4(6,@04),@CC03446                          2320 09245000
*               END;                /* END SASUU             @OZ30157*/ 09246000
*             ELSE                  /* IF ONLINE             @OZ30157*/ 09247000
*               DO;                 /* THEN DEFAULT IS ONLINE@OZ30157*/ 09248000
         B     @RC02317                                            2322 09249000
@RF02317 DS    0H                                                  2323 09250000
*                 STDEF='/O     ';  /* SET IT                @OZ30157*/ 09251000
         MVC   STDEF(7),@CC03512                                   2323 09252000
*                 MDRSAON='/O';     /* SA STATUS             @OZ30157*/ 09253000
         L     @04,WPLPTR                                          2324 09254000
         MVC   MDRSAON+4(2,@04),@CC03483                           2324 09255000
*               END;                /*                       @OZ30157*/ 09256000
*           MDRDRC=DRCDRSS;         /* DRC SSID              @OZ30157*/ 09257000
@RC02317 DS    0H                                                  2326 09258000
@RC02312 LA    @04,4                                               2326 09259000
         AL    @04,WPLPTR                                          2326 09260000
         L     @15,TABPTR2                                         2326 09261000
         MVC   MDRDRC(3,@04),DRCDRSS(@15)                          2326 09262000
*           IF DRCDCOF=BONE THEN    /* IF DRC OFFLINE        @OZ30157*/ 09263000
         TM    DRCDCOF(@15),B'00001000'                            2327 09264000
         BNO   @RF02327                                            2327 09265000
*             MDRDCOFF='/OFF';      /* SAY SO                @OZ30157*/ 09266000
         MVC   MDRDCOFF(4,@04),@CC03482                            2328 09267000
*           ELSE                    /* ELSE IF NOT AVAIL     @OZ30157*/ 09268000
*             IF DRCDCNA=BONE THEN  /* SAY THAT              @OZ30157*/ 09269000
         B     @RC02327                                            2329 09270000
@RF02327 L     @04,TABPTR2                                         2329 09271000
         TM    DRCDCNA(@04),B'00000010'                            2329 09272000
         BNO   @RF02329                                            2329 09273000
*               MDRDCUNA='/O-UNAV'; /* IS UNAVAILABLE        @OZ30157*/ 09274000
         L     @04,WPLPTR                                          2330 09275000
         MVC   MDRDCUNA+4(7,@04),@CC03511                          2330 09276000
*             ELSE                  /* OTHERWISE,            @OZ30157*/ 09277000
*               IF DRCDCRDY=BZERO THEN/* IF NOT READY        @OZ30157*/ 09278000
         B     @RC02329                                            2331 09279000
@RF02329 L     @04,TABPTR2                                         2331 09280000
         TM    DRCDCRDY(@04),B'00000100'                           2331 09281000
         BNZ   @RF02331                                            2331 09282000
*                 MDRDCSUU='/O-SUU';/* SAY IS SUU            @OZ30157*/ 09283000
         L     @04,WPLPTR                                          2332 09284000
         MVC   MDRDCSUU+4(6,@04),@CC03446                          2332 09285000
*               ELSE                /* IF NONE OF THE ABOVE  @OZ30157*/ 09286000
*                 MDRDCON='/O';     /* IT IS ONLINE          @OZ30157*/ 09287000
         B     @RC02331                                            2333 09288000
@RF02331 L     @04,WPLPTR                                          2333 09289000
         MVC   MDRDCON+4(2,@04),@CC03483                           2333 09290000
*           DO I=1 TO 4;            /* GET ALL 4 DRDS        @OZ30157*/ 09291000
@RC02331 DS    0H                                                  2334 09292000
@RC02329 DS    0H                                                  2334 09293000
@RC02327 LA    @04,1                                               2334 09294000
         STH   @04,I                                               2334 09295000
@DL02334 DS    0H                                                  2335 09296000
*             IF((DSPON=BONE)&(DRCDRDOF(I)=BZERO))|((DSPOFF=BONE)&(     09297000
*                 DRCDRDOF(I)=BONE))|((DRCDRDOF(I)=BZERO)&(DRCDRDRD(I)= 09298000
*                 BZERO)) THEN      /*                       @OZ30157*/ 09299000
         L     @15,@CA00041                                        2335 09300000
         L     @15,CWBPTR-CWBPTR(,@15)                             2335 09301000
         TM    DSPON(@15),B'01000000'                              2335 09302000
         BNO   @GL00031                                            2335 09303000
         SLA   @04,2                                               2335 09304000
         L     @15,TABPTR2                                         2335 09305000
         ALR   @15,@04                                             2335 09306000
         TM    DRCDRDOF-4(@15),B'10000000'                         2335 09307000
         BZ    @RT02335                                            2335 09308000
@GL00031 L     @04,@CA00041                                        2335 09309000
         L     @04,CWBPTR-CWBPTR(,@04)                             2335 09310000
         TM    DSPOFF(@04),B'00100000'                             2335 09311000
         BNO   @GL00030                                            2335 09312000
         LH    @04,I                                               2335 09313000
         SLA   @04,2                                               2335 09314000
         L     @15,TABPTR2                                         2335 09315000
         ALR   @15,@04                                             2335 09316000
         TM    DRCDRDOF-4(@15),B'10000000'                         2335 09317000
         BO    @RT02335                                            2335 09318000
@GL00030 LH    @04,I                                               2335 09319000
         SLA   @04,2                                               2335 09320000
         L     @15,TABPTR2                                         2335 09321000
         ALR   @15,@04                                             2335 09322000
         TM    DRCDRDOF-4(@15),B'11000000'                         2335 09323000
         BNZ   @RF02335                                            2335 09324000
@RT02335 DS    0H                                                  2336 09325000
*               DO;                 /* IF IT IS VALID FOR PRINT, GO     09326000
*                                      AHEAD                 @OZ30157*/ 09327000
*                 MDRDRD(I)=DRCDRDAD(I);/* SET DRD SSID      @OZ30157*/ 09328000
         LH    @04,I                                               2337 09329000
         LR    @15,@04                                             2337 09330000
         MH    @15,@CH00032                                        2337 09331000
         LA    @14,4                                               2337 09332000
         AL    @14,WPLPTR                                          2337 09333000
         ST    @15,@TF00001                                        2337 09334000
         ALR   @15,@14                                             2337 09335000
         L     @03,TABPTR2                                         2337 09336000
         SLA   @04,2                                               2337 09337000
         ST    @04,@TF00002                                        2337 09338000
         ALR   @04,@03                                             2337 09339000
         MVC   MDRDRD-12(3,@15),DRCDRDAD-4(@04)                    2337 09340000
*                 IF DRCDRDOF(I)=BONE THEN/* IF OFFLINE      @OZ30157*/ 09341000
         AL    @03,@TF00002                                        2338 09342000
         TM    DRCDRDOF-4(@03),B'10000000'                         2338 09343000
         BNO   @RF02338                                            2338 09344000
*                   MDRDDOFF(I)='/OFF';/* SAY SO             @OZ30157*/ 09345000
         AL    @14,@TF00001                                        2339 09346000
         MVC   MDRDDOFF-12(4,@14),@CC03482                         2339 09347000
*                 ELSE              /*                       @OZ30157*/ 09348000
*                   IF DRCDRDNA(I)=BONE THEN/*               @OZ30157*/ 09349000
         B     @RC02338                                            2340 09350000
@RF02338 LH    @04,I                                               2340 09351000
         LR    @15,@04                                             2340 09352000
         SLA   @15,2                                               2340 09353000
         L     @14,TABPTR2                                         2340 09354000
         ALR   @14,@15                                             2340 09355000
         TM    DRCDRDNA-4(@14),B'00100000'                         2340 09356000
         BNO   @RF02340                                            2340 09357000
*                     MDRDDUNA(I)='/O-UNAV';/*               @OZ30157*/ 09358000
         MH    @04,@CH00032                                        2341 09359000
         L     @15,WPLPTR                                          2341 09360000
         ALR   @15,@04                                             2341 09361000
         MVC   MDRDDUNA-8(7,@15),@CC03511                          2341 09362000
*                   ELSE            /*                       @OZ30157*/ 09363000
*                     IF DRCDRDRD(I)=BZERO THEN/*            @OZ30157*/ 09364000
         B     @RC02340                                            2342 09365000
@RF02340 LH    @04,I                                               2342 09366000
         LR    @15,@04                                             2342 09367000
         SLA   @15,2                                               2342 09368000
         L     @14,TABPTR2                                         2342 09369000
         ALR   @14,@15                                             2342 09370000
         TM    DRCDRDRD-4(@14),B'01000000'                         2342 09371000
         BNZ   @RF02342                                            2342 09372000
*                       MDRDDSUU(I)='/O-SUU';/*              @OZ30157*/ 09373000
         MH    @04,@CH00032                                        2343 09374000
         L     @15,WPLPTR                                          2343 09375000
         ALR   @15,@04                                             2343 09376000
         MVC   MDRDDSUU-8(6,@15),@CC03446                          2343 09377000
*                     ELSE          /*                       @OZ30157*/ 09378000
*                       MDRDDUNA(I)=STDEF;/* USE DEFAULT     @OZ30157*/ 09379000
         B     @RC02342                                            2344 09380000
@RF02342 LH    @04,I                                               2344 09381000
         MH    @04,@CH00032                                        2344 09382000
         L     @15,WPLPTR                                          2344 09383000
         ALR   @15,@04                                             2344 09384000
         MVC   MDRDDUNA-8(7,@15),STDEF                             2344 09385000
*               END;                /* END DISPLAYABLE DRD   @OZ30157*/ 09386000
@RC02342 DS    0H                                                  2345 09387000
@RC02340 DS    0H                                                  2345 09388000
@RC02338 DS    0H                                                  2346 09389000
*           END;                    /* END OF ONE LINE       @OZ30157*/ 09390000
@RF02335 LA    @04,1                                               2346 09391000
         AH    @04,I                                               2346 09392000
         STH   @04,I                                               2346 09393000
         CH    @04,@CH00045                                        2346 09394000
         BNH   @DL02334                                            2346 09395000
*           CALL MSG56D;            /* PRINT IT OR BUMP NEXT @OZ30157*/ 09396000
         BAL   @14,MSG56D                                          2347 09397000
*         END;                      /* END VALID DISPLAY LIN @OZ30157*/ 09398000
*       TABPTR2=DRCCHN;             /* CHAIN TO NEXT ENTRY   @OZ30157*/ 09399000
@RF02308 L     @04,TABPTR2                                         2349 09400000
         L     @04,DRCCHN(,@04)                                    2349 09401000
         ST    @04,TABPTR2                                         2349 09402000
*     END;                          /* END OF DRC CHAIN      @OZ30157*/ 09403000
@DE02291 L     @04,TABPTR2                                         2350 09404000
         LTR   @04,@04                                             2350 09405000
         BNZ   @DL02291                                            2350 09406000
*   IF ERRFLG=BONE THEN             /* IF NO PATHS FOUND     @OZ30157*/ 09407000
@RF02290 TM    ERRFLG,B'10000000'                                  2351 09408000
         BNO   @RF02351                                            2351 09409000
*     DO;                           /* MUST PRINT ERR MSG    @OZ30157*/ 09410000
*       IF DSPON=BONE THEN          /* EITHER NO PATHS ONL   @OZ30157*/ 09411000
         L     @04,@CA00041                                        2353 09412000
         L     @04,CWBPTR-CWBPTR(,@04)                             2353 09413000
         TM    DSPON(@04),B'01000000'                              2353 09414000
         BNO   @RF02353                                            2353 09415000
*         DRCMSG='NO PATHS ONLINE'; /* IN MESSAGE            @OZ30157*/ 09416000
         L     @04,WPLPTR                                          2354 09417000
         MVI   DRCMSG+19(@04),C' '                                 2354 09418000
         MVC   DRCMSG+20(54,@04),DRCMSG+19(@04)                    2354 09419000
         MVC   DRCMSG+4(15,@04),@CC03484                           2354 09420000
*       ELSE                        /* OR NONE OFFLINE       @OZ30157*/ 09421000
*         DRCMSG='NO PATHS OFFLINE';/* IN MESSAGE            @OZ30157*/ 09422000
         B     @RC02353                                            2355 09423000
@RF02353 L     @04,WPLPTR                                          2355 09424000
         MVI   DRCMSG+20(@04),C' '                                 2355 09425000
         MVC   DRCMSG+21(53,@04),DRCMSG+20(@04)                    2355 09426000
         MVC   DRCMSG+4(16,@04),@CC03486                           2355 09427000
*       CALL MSG56D;                /* DISPLAY MESSAGE       @OZ30157*/ 09428000
@RC02353 BAL   @14,MSG56D                                          2356 09429000
*     END;                          /* AND END IT ALL        @OZ30157*/ 09430000
*   RFY                                                            2358 09431000
*     R14 RSTD;                     /*                       @OZ30157*/ 09432000
@RF02351 DS    0H                                                  2359 09433000
*   R14=MSG56I14;                   /* RESTORE RETURN REG    @OZ30157*/ 09434000
         L     R14,MSG56I14                                        2359 09435000
*   RFY                                                            2360 09436000
*     R14 UNRSTD;                   /*                       @OZ30157*/ 09437000
*   RETURN;                         /*                       @OZ30157*/ 09438000
@EL00019 DS    0H                                                  2361 09439000
@EF00019 DS    0H                                                  2361 09440000
@ER00019 BR    @14                                                 2361 09441000
*   END MSG56I;                     /* END DRC STATUS RTN    @OZ30157*/ 09442000
*MSG56J:                                                           2363 09443000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @OZ30157*/ 09444000
MSG56J   DS    0H                                                  2364 09445000
*/********************************************************** @OZ30157*/ 09446000
*/*                                                          @OZ30157*/ 09447000
*/* PROCEDURE NAME: MSG56J                                   @OZ30157*/ 09448000
*/*                                                          @OZ30157*/ 09449000
*/* FUNCTION: DISPLAY QCB PATH STATUS ON CALL FROM MSG56QC   @OZ30157*/ 09450000
*/*                                                          @OZ30157*/ 09451000
*/* INPUTS: QCB PATH STATUS TABLE                            @OZ30157*/ 09452000
*/*                                                          @OZ30157*/ 09453000
*/* OUTPUTS: ONE OR MORE WTO LINES WITH QCB PATH STATUS      @OZ30157*/ 09454000
*/*                                                          @OZ30157*/ 09455000
*/********************************************************** @OZ30157*/ 09456000
*                                                                  2364 09457000
*   DCL                                                            2364 09458000
*     1 QCBMSG CHAR(35) BASED(QCMPTR),/* QCB MESSAGE         @OZ30157*/ 09459000
*      2 QCMQCBU CHAR(3),           /* FOR UNPACK            @OZ30157*/ 09460000
*       3 QCMQCB CHAR(2),           /* QCB NUMBER            @OZ30157*/ 09461000
*       3 QCMX1 CHAR(1),            /* BLANK                 @OZ30157*/ 09462000
*      2 * CHAR(1),                 /* BLANK                 @OZ30157*/ 09463000
*      2 QCMSDGU CHAR(3),           /* FOR UNPACK            @OZ30157*/ 09464000
*       3 QCMSDG CHAR(2),           /* SDG NUMBER            @OZ30157*/ 09465000
*       3 QCMX2 CHAR(1),            /* BLANK                 @OZ30157*/ 09466000
*      2 * CHAR(1),                 /* BLANK                 @OZ30157*/ 09467000
*      2 QCMCART CHAR(6),           /* VOL SER               @OZ30157*/ 09468000
*       3 * CHAR(3),                /* BLANK IF SSID         @OZ30157*/ 09469000
*       3 QCMSSID CHAR(3),          /* SSID IF NOT VOLSER    @OZ30157*/ 09470000
*      2 QCMCDSH CHAR(1),           /* BLANK OR DASH         @OZ30157*/ 09471000
*      2 QCMCSEQ CHAR(1),           /* CART SEQ NO OR BLANK  @OZ30157*/ 09472000
*      2 * CHAR(2),                 /* BLANKS                @OZ30157*/ 09473000
*      2 QCML CHAR(1),              /* L VALUE               @OZ30157*/ 09474000
*      2 * CHAR(1),                 /* BLANK                 @OZ30157*/ 09475000
*      2 QCMX CHAR(3),              /* X VALUE               @OZ30157*/ 09476000
*      2 * CHAR(1),                 /* BLANK                 @OZ30157*/ 09477000
*      2 QCMY CHAR(2),              /* Y VALUE               @OZ30157*/ 09478000
*      2 * CHAR(1),                 /* BLANK                 @OZ30157*/ 09479000
*      2 QCMZ CHAR(1),              /* Z VALUE               @OZ30157*/ 09480000
*      2 * CHAR(2),                 /* BLANKS                @OZ30157*/ 09481000
*      2 QCMRCOD CHAR(2),           /* RESTART CODE          @OZ30157*/ 09482000
*      2 * CHAR(3);                 /* BLANKS                @OZ30157*/ 09483000
*   DCL                                                            2365 09484000
*     QCMPTR PTR(31);               /* LOCAL POINTER HALF LN @OZ30157*/ 09485000
*   DCL                                                            2366 09486000
*     QCNMSG CHAR(26) INIT('THERE ARE NO QCBS IN ERROR');/*  @OZ30157*/ 09487000
*   DCL                                                            2367 09488000
*     QCNMSL FIXED(31) CONSTANT(26);/*                       @OZ30157*/ 09489000
*   DCL                                                            2368 09490000
*     MSG56J14 FIXED(31);           /* LOCAL RETURN REG SAVE @OZ30157*/ 09491000
*   RFY                                                            2369 09492000
*     R14 RSTD;                     /*                       @OZ30157*/ 09493000
*   MSG56J14=R14;                   /* SAVE RETURN REG       @OZ30157*/ 09494000
         ST    R14,MSG56J14                                        2370 09495000
*   RFY                                                            2371 09496000
*     R14 UNRSTD;                   /*                       @OZ30157*/ 09497000
*   FLIPSW=BZERO;                   /* START WITH SWITCH OFF @OZ30157*/ 09498000
         NI    FLIPSW,B'11101111'                                  2372 09499000
*   TABPTR=QCTPTR;                  /* START ADDRESS         @OZ30157*/ 09500000
         MVC   TABPTR(4),QCTPTR                                    2373 09501000
*   IF VALSSID=BZERO THEN           /* CHECK FOR VALID ENTRY @OZ30157*/ 09502000
         TM    VALSSID,B'01000000'                                 2374 09503000
         BNZ   @RF02374                                            2374 09504000
*     DO;                           /* IF NONE, SAY SO       @OZ30157*/ 09505000
*       WPLMLTXT=MESGS(MSG05606);   /* SET BLANK LINE        @OZ30157*/ 09506000
         L     @04,WPLPTR                                          2376 09507000
         MVI   WPLMLTXT+72(@04),C' '                               2376 09508000
         MVC   WPLMLTXT+73(53,@04),WPLMLTXT+72(@04)                2376 09509000
         MVC   WPLMLTXT(72,@04),MESGS+1596                         2376 09510000
*       WPLMLLTF=''B;               /* CLEAR FLAGS           @OZ30157*/ 09511000
         XC    WPLMLLTF(2,@04),WPLMLLTF(@04)                       2377 09512000
*       WPLMLTXT(1:QCNMSL)=QCNMSG;  /* SET MESSAGE           @OZ30157*/ 09513000
         MVC   WPLMLTXT(26,@04),QCNMSG                             2378 09514000
*       WPLMLLEN=LENGTH(QCNMSG)+F4; /* WPL BUFFER            @OZ30157*/ 09515000
         LA    @00,30                                              2379 09516000
         STC   @00,WPLMLLEN(,@04)                                  2379 09517000
*       WPLMLLTC=BONE;              /* DATA LINE FLAG        @OZ30157*/ 09518000
         OI    WPLMLLTC(@04),B'00100000'                           2380 09519000
*       WPLPTR=WPLPTR+WPLMLLEN;     /* UP BY HDR 2 LENGTH    @OZ30157*/ 09520000
         ALR   @04,@00                                             2381 09521000
         ST    @04,WPLPTR                                          2381 09522000
*       VALSSID=BONE;               /* NO ERROR MESSAGE      @OZ30157*/ 09523000
         OI    VALSSID,B'01000000'                                 2382 09524000
*     END;                          /*                       @OZ30157*/ 09525000
*   ELSE                            /* AT LEAST ONE          @OZ30157*/ 09526000
*     DO;                           /* SO SCAN ALL SDG ENTRY @OZ30157*/ 09527000
         B     @RC02374                                            2384 09528000
@RF02374 DS    0H                                                  2385 09529000
*       RETC=F0;                    /* INSURE GOOD END       @OZ30157*/ 09530000
         SLR   @04,@04                                             2385 09531000
         STH   @04,RETC                                            2385 09532000
*       WPLPTR=WPLPTR+WPLMLLEN;     /* POINT TO NEXT LINE    @OZ30157*/ 09533000
         L     @04,WPLPTR                                          2386 09534000
         SLR   @00,@00                                             2386 09535000
         IC    @00,WPLMLLEN(,@04)                                  2386 09536000
         ALR   @00,@04                                             2386 09537000
         ST    @00,WPLPTR                                          2386 09538000
*       WPLMLLTF=''B;               /* CLEAR FLAG FIELD      @OZ30157*/ 09539000
         LR    @04,@00                                             2387 09540000
         XC    WPLMLLTF(2,@04),WPLMLLTF(@04)                       2387 09541000
*       WPLMLTXT=MESGS(MSG05606);   /* DATA LINE SKELETON    @OZ30157*/ 09542000
         LR    @04,@00                                             2388 09543000
         MVI   WPLMLTXT+72(@04),C' '                               2388 09544000
         MVC   WPLMLTXT+73(53,@04),WPLMLTXT+72(@04)                2388 09545000
         MVC   WPLMLTXT(72,@04),MESGS+1596                         2388 09546000
*       WPLMLLEN=MESGLEN(MSG05606)+F4;/* LENGTH              @OZ30157*/ 09547000
         LA    @04,4                                               2389 09548000
         MVC   @ZT00003+3(1),MESGLEN+1596                          2389 09549000
         AL    @04,@ZT00003                                        2389 09550000
         LR    @15,@00                                             2389 09551000
         STC   @04,WPLMLLEN(,@15)                                  2389 09552000
*       MSGIND=MSG05606;            /* INDICATOR             @OZ30157*/ 09553000
         MVI   MSGIND,X'16'                                        2390 09554000
*       MSGCNT=MSGCNT+F1;           /* COUNT A LINE          @OZ30157*/ 09555000
         LH    @04,MSGCNT                                          2391 09556000
         LA    @04,1(,@04)                                         2391 09557000
         STH   @04,MSGCNT                                          2391 09558000
*       DO UNTIL(TABPTR=F0);        /* EXISTS, SO LOOP       @OZ30157*/ 09559000
@DL02392 DS    0H                                                  2393 09560000
*         IF FLIPSW=BZERO THEN      /* SET PROPER HALF-LINE  @OZ30157*/ 09561000
         TM    FLIPSW,B'00010000'                                  2393 09562000
         BNZ   @RF02393                                            2393 09563000
*           QCMPTR=ADDR(FHALF);     /* INTO LINE POINTER     @OZ30157*/ 09564000
         LA    @04,4                                               2394 09565000
         AL    @04,WPLPTR                                          2394 09566000
         ST    @04,QCMPTR                                          2394 09567000
*         ELSE                      /*                       @OZ30157*/ 09568000
*           QCMPTR=ADDR(SHALF);     /*                       @OZ30157*/ 09569000
         B     @RC02393                                            2395 09570000
@RF02393 L     @04,WPLPTR                                          2395 09571000
         LA    @04,SHALF+4(,@04)                                   2395 09572000
         ST    @04,QCMPTR                                          2395 09573000
*         UNPK(QCMQCBU,QCTNOP);     /* MESSAGE FIELD         @OZ30157*/ 09574000
@RC02393 L     @04,QCMPTR                                          2396 09575000
         L     @15,TABPTR                                          2396 09576000
         UNPK  QCMQCBU(3,@04),QCTNOP(2,@15)                        2396 09577000
*         TR(QCMQCB,TRANS);         /* MAKE PRINTABLE        @OZ30157*/ 09578000
         TR    QCMQCB(2,@04),TRANS                                 2397 09579000
*         QCMX1=' ';                /* CLEAR EXTRA BYTE      @OZ30157*/ 09580000
         MVI   QCMX1(@04),C' '                                     2398 09581000
*         UNPK(QCMSDGU,QCTSDGP);    /* MESSAGE FIELD         @OZ30157*/ 09582000
         UNPK  QCMSDGU(3,@04),QCTSDGP(2,@15)                       2399 09583000
*         TR(QCMSDG,TRANS);         /* MAKE PRINTABLE        @OZ30157*/ 09584000
         TR    QCMSDG(2,@04),TRANS                                 2400 09585000
*         QCMX2=' ';                /* CLEAR EXTRA BYTE      @OZ30157*/ 09586000
         MVI   QCMX2(@04),C' '                                     2401 09587000
*         IF QCTSSID=NULLS(1:3) THEN/* IF HAS CART. SER      @OZ30157*/ 09588000
         CLC   QCTSSID(3,@15),NULLS                                2402 09589000
         BNE   @RF02402                                            2402 09590000
*           DO;                     /* THEN PUT IN MSG       @OZ30157*/ 09591000
*             QCMCART=QCTCVOL;      /* GET VOLID,            @OZ30157*/ 09592000
         MVC   QCMCART(6,@04),QCTCVOL(@15)                         2404 09593000
*             QCMCDSH='-';          /* A DASH,               @OZ30157*/ 09594000
         MVI   QCMCDSH(@04),C'-'                                   2405 09595000
*             QCMCSEQ=QCTCSEQ;      /* AND SEQUENCE NUMBER   @OZ30157*/ 09596000
         MVC   QCMCSEQ(1,@04),QCTCSEQ(@15)                         2406 09597000
*             QCML=QCTLVAL;         /* COPY L                @OZ30157*/ 09598000
         MVC   QCML(1,@04),QCTLVAL(@15)                            2407 09599000
*             QCMX=QCTXVAL;         /* X                     @OZ30157*/ 09600000
         MVC   QCMX(3,@04),QCTXVAL(@15)                            2408 09601000
*             QCMY=QCTYVAL;         /* Y                     @OZ30157*/ 09602000
         MVC   QCMY(2,@04),QCTYVAL(@15)                            2409 09603000
*             QCMZ=QCTZVAL;         /* AND Z VALUES          @OZ30157*/ 09604000
         MVC   QCMZ(1,@04),QCTZVAL(@15)                            2410 09605000
*           END;                    /* OTHERWISE,            @OZ30157*/ 09606000
*         ELSE                      /* PUT                   @OZ30157*/ 09607000
*           QCMSSID=QCTSSID;        /* SSID                  @OZ30157*/ 09608000
         B     @RC02402                                            2412 09609000
@RF02402 L     @04,QCMPTR                                          2412 09610000
         L     @15,TABPTR                                          2412 09611000
         MVC   QCMSSID(3,@04),QCTSSID(@15)                         2412 09612000
*         QCMRCOD=QCTRCOD;          /* MESSAGE FIELD         @OZ30157*/ 09613000
@RC02402 L     @04,QCMPTR                                          2413 09614000
         L     @15,TABPTR                                          2413 09615000
         MVC   QCMRCOD(2,@04),QCTRCOD(@15)                         2413 09616000
*         IF FLIPSW=BONE THEN       /* IF SECOND HALF DONE   @OZ30157*/ 09617000
         TM    FLIPSW,B'00010000'                                  2414 09618000
         BNO   @RF02414                                            2414 09619000
*           CALL MSG56D;            /* THROUGH MSG56D        @OZ30157*/ 09620000
         BAL   @14,MSG56D                                          2415 09621000
*         ELSE                      /*                       @OZ30157*/ 09622000
*           FLIPSW=BONE;            /*                       @OZ30157*/ 09623000
         B     @RC02414                                            2416 09624000
@RF02414 OI    FLIPSW,B'00010000'                                  2416 09625000
*         TABPTR=QCTCHAIN;          /* CHAIN TO NEXT ENTRY   @OZ30157*/ 09626000
@RC02414 L     @04,TABPTR                                          2417 09627000
         L     @04,QCTCHAIN-1(,@04)                                2417 09628000
         LA    @04,0(,@04)                                         2417 09629000
         ST    @04,TABPTR                                          2417 09630000
*       END;                        /* END SCAN ROUTINE      @OZ30157*/ 09631000
@DE02392 L     @04,TABPTR                                          2418 09632000
         LTR   @04,@04                                             2418 09633000
         BNZ   @DL02392                                            2418 09634000
*     END;                          /* END GOOD RUN          @OZ30157*/ 09635000
*   RFY                                                            2420 09636000
*     R14 RSTD;                     /*                       @OZ30157*/ 09637000
@RC02374 DS    0H                                                  2421 09638000
*   R14=MSG56J14;                   /* RESTORE RETURN REG    @OZ30157*/ 09639000
         L     R14,MSG56J14                                        2421 09640000
*   RFY                                                            2422 09641000
*     R14 UNRSTD;                   /*                       @OZ30157*/ 09642000
*   RETURN;                         /*                       @OZ30157*/ 09643000
@EL00020 DS    0H                                                  2423 09644000
@EF00020 DS    0H                                                  2423 09645000
@ER00020 BR    @14                                                 2423 09646000
*   END MSG56J;                     /* END QCB DISPLAY RTN   @OZ30157*/ 09647000
*MSG56QU:                                                          2425 09648000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @OZ30157*/ 09649000
MSG56QU  DS    0H                                                  2426 09650000
*/********************************************************************/ 09651000
*/*                                                                  */ 09652000
*/* PROCEDURE NAME: MSG56QU                                          */ 09653000
*/*                                                                  */ 09654000
*/* FUNCTION: GET QUALIFIER VALUE(S) AND LENGTH(S) ON CALL           */ 09655000
*/*                                                                  */ 09656000
*/* INPUTS: CWB WITH QUALIFIED OPERAND AND DSPQUAL SET               */ 09657000
*/*         QUALLEN(1) SET TO EXPECTED LENGTH OF FIRST QUAL.         */ 09658000
*/*         QUALLEN(2) SET TO EXPECTED LENGTH OF SEC. QUAL.          */ 09659000
*/*                                                                  */ 09660000
*/* OUTPUTS: QUALLEN(X) SET TO ACTUAL QUALIFIER LENGTH(S)            */ 09661000
*/*          QUAL(X) SET TO ACTUAL QUALIFIER VALUE(S)                */ 09662000
*/*          RETURN CODE IN RETC  =0 IF GOT QUALIFIER AS             */ 09663000
*/*                                  EXPECTED (INCLUDING             */ 09664000
*/*                                  LENGTH).                        */ 09665000
*/*                               =4 IF GOT QUALIFIER WITH           */ 09666000
*/*                                  DIFFERENT LENGTH.               */ 09667000
*/*                               =8 IF GOT DIFFERENT NUMBER         */ 09668000
*/*                                  OF QUALIFIERS.                  */ 09669000
*/*                               =C IF DISASTROUS ERROR     @OZ30157*/ 09670000
*/*                                                                  */ 09671000
*/********************************************************************/ 09672000
*                                                                  2426 09673000
*   DCL                                                            2426 09674000
*     MS56QU14 FIXED(31);           /* LOCAL RETURN REG SAVE @OZ30157*/ 09675000
*   DCL                                                            2427 09676000
*     QUINPTR PTR(31);              /* CURRENT INPUT POINTER @OZ30157*/ 09677000
*   DCL                                                            2428 09678000
*     QUSCPTR PTR(31);              /* SCAN POINTER          @OZ30157*/ 09679000
*   DCL                                                            2429 09680000
*     QUNDPTR PTR(31);              /* END POINTER           @OZ30157*/ 09681000
*   DCL                                                            2430 09682000
*     QUALX FIXED(31);              /* INDEX WORK AREA       @OZ30157*/ 09683000
*   DCL                                                            2431 09684000
*     QUALY FIXED(31);              /* INDEX WORK AREA       @OZ30157*/ 09685000
*   DCL                                                            2432 09686000
*     ENDCH CHAR(1) BASED(QUNDPTR); /* LAST CHARACTER        @OZ30157*/ 09687000
*   DCL                                                            2433 09688000
*     CURCH CHAR(1) BASED(QUSCPTR); /* CURRENT CHARACTER     @OZ30157*/ 09689000
*   DCL                                                            2434 09690000
*     CURQUAL CHAR(*) BASED(QUINPTR);/* CURRENT QUALIFIER    @OZ30157*/ 09691000
*   RFY                                                            2435 09692000
*     R14 RSTD;                     /*                       @OZ30157*/ 09693000
*   MS56QU14=R14;                   /* SAVE RETURN REG       @OZ30157*/ 09694000
         ST    R14,MS56QU14                                        2436 09695000
*   RFY                                                            2437 09696000
*     R14 UNRSTD;                   /*                       @OZ30157*/ 09697000
*/********************************************************************/ 09698000
*/*                                                                  */ 09699000
*/*  SET UP POINTERS TO SCAN QUALIFIER                       @OZ30157*/ 09700000
*/*                                                                  */ 09701000
*/********************************************************************/ 09702000
*                                                                  2438 09703000
*   QUINPTR=ADDR(CWBCMND)+DSPOFFS-1;/* GET QUALIFIER START   @OZ30157*/ 09704000
         L     @04,@CA00041                                        2438 09705000
         L     @04,CWBPTR-CWBPTR(,@04)                             2438 09706000
         LA    @00,CWBCMND(,@04)                                   2438 09707000
         AH    @00,DSPOFFS(,@04)                                   2438 09708000
         BCTR  @00,0                                               2438 09709000
         ST    @00,QUINPTR                                         2438 09710000
*   QUNDPTR=QUINPTR+QUALLEN(1);     /* AND LENGTH            @OZ30157*/ 09711000
         AH    @00,QUALLEN                                         2439 09712000
         ST    @00,QUNDPTR                                         2439 09713000
*   IF QUALLEN(2)>F0 THEN           /* IF TWO QUALIFIERS     @OZ30157*/ 09714000
         LH    @04,QUALLEN+2                                       2440 09715000
         LTR   @04,@04                                             2440 09716000
         BNP   @RF02440                                            2440 09717000
*     DO;                           /* SAY SO                @OZ30157*/ 09718000
*       QUNDPTR=QUNDPTR+QUALLEN(2)+1;/* SET END PTR TO ACT         2442 09719000
*                                      END@OZ30157                   */ 09720000
         ALR   @00,@04                                             2442 09721000
         AL    @00,@CF00047                                        2442 09722000
         ST    @00,QUNDPTR                                         2442 09723000
*       QUALY=F2;                   /* SET MAX NUMBER        @OZ30157*/ 09724000
         MVC   QUALY(4),@CF00056                                   2443 09725000
*     END;                          /* TO 2                  @OZ30157*/ 09726000
*   ELSE                                                           2445 09727000
*     QUALY=F1;                     /* OTHERWISE, TO 1       @OZ30157*/ 09728000
         B     @RC02440                                            2445 09729000
@RF02440 MVC   QUALY(4),@CF00047                                   2445 09730000
*   QUAL(1)=' ';                    /* CLEAR QUALIFIER FIELDS@OZ30157*/ 09731000
@RC02440 MVI   QUAL+1,C' '                                         2446 09732000
         MVC   QUAL+2(9),QUAL+1                                    2446 09733000
         MVI   QUAL,C' '                                           2446 09734000
*   QUAL(2)=' ';                    /* TO BLANKS             @OZ30157*/ 09735000
         MVI   QUAL+12,C' '                                        2447 09736000
         MVC   QUAL+13(9),QUAL+12                                  2447 09737000
         MVI   QUAL+11,C' '                                        2447 09738000
*   RETC=F0;                        /* ASSUME GOOD LENGTH    @OZ30157*/ 09739000
         SLR   @04,@04                                             2448 09740000
         STH   @04,RETC                                            2448 09741000
*   IF ENDCH^=' '&ENDCH^=','&ENDCH^=')' THEN/* IS BAD LENGTH?      2449 09742000
*                                                            @OZ30157*/ 09743000
         L     @04,QUNDPTR                                         2449 09744000
         CLI   ENDCH(@04),C' '                                     2449 09745000
         BE    @RF02449                                            2449 09746000
         CLI   ENDCH(@04),C','                                     2449 09747000
         BE    @RF02449                                            2449 09748000
         CLI   ENDCH(@04),C')'                                     2449 09749000
         BE    @RF02449                                            2449 09750000
*     QUNDPTR=QUINPTR+11;           /* THEN SET TO MAX VALUE @OZ30157*/ 09751000
         LA    @04,11                                              2450 09752000
         AL    @04,QUINPTR                                         2450 09753000
         ST    @04,QUNDPTR                                         2450 09754000
*   QUALX=F1;                       /* START WITH QUAL 1     @OZ30157*/ 09755000
@RF02449 MVC   QUALX(4),@CF00047                                   2451 09756000
*   ENDSW=BZERO;                    /* STOP SWITCH IF >2     @OZ30157*/ 09757000
         NI    ENDSW,B'11111011'                                   2452 09758000
*   DO QUSCPTR=QUINPTR TO QUNDPTR WHILE(ENDSW=BZERO);/*      @OZ30157*/ 09759000
         L     @04,QUINPTR                                         2453 09760000
         B     @DE02453                                            2453 09761000
@DL02453 TM    ENDSW,B'00000100'                                   2453 09762000
         BNZ   @DC02453                                            2453 09763000
*/********************************************************************/ 09764000
*/*                                                                  */ 09765000
*/*  FIND ACTUAL END OF QUALIFIER(S), MOVE AND SET LENGTH    @OZ30157*/ 09766000
*/*                                                                  */ 09767000
*/********************************************************************/ 09768000
*                                                                  2454 09769000
*     IF CURCH=' '|CURCH=','|CURCH=')'|CURCH='-' THEN/*      @OZ30157*/ 09770000
         CLI   CURCH(@04),C' '                                     2454 09771000
         BE    @RT02454                                            2454 09772000
         CLI   CURCH(@04),C','                                     2454 09773000
         BE    @RT02454                                            2454 09774000
         CLI   CURCH(@04),C')'                                     2454 09775000
         BE    @RT02454                                            2454 09776000
         CLI   CURCH(@04),C'-'                                     2454 09777000
         BNE   @RF02454                                            2454 09778000
@RT02454 DS    0H                                                  2455 09779000
*       DO;                         /* GOT ACTUAL END        @OZ30157*/ 09780000
*         QUALLEN(QUALX)=QUSCPTR-QUINPTR;/* SET LENGTH       @OZ30157*/ 09781000
         L     @04,QUALX                                           2456 09782000
         LR    @15,@04                                             2456 09783000
         ALR   @15,@15                                             2456 09784000
         L     @14,QUSCPTR                                         2456 09785000
         L     @03,QUINPTR                                         2456 09786000
         LR    @00,@14                                             2456 09787000
         SLR   @00,@03                                             2456 09788000
         STH   @00,QUALLEN-2(@15)                                  2456 09789000
*         QUAL(QUALX,1:QUALLEN(QUALX))=CURQUAL(1:QUALLEN(QUALX));/*     09790000
*                                      MOVE THE QUALIFIER    @OZ30157*/ 09791000
         LR    @15,@04                                             2457 09792000
         MH    @15,@CH00033                                        2457 09793000
         LA    @02,QUAL-11(@15)                                    2457 09794000
         BCTR  @00,0                                               2457 09795000
         LR    @15,@00                                             2457 09796000
         EX    @15,@SM03663                                        2457 09797000
*         QUINPTR=QUSCPTR+F1;       /* GOT ONE QUALIFIER     @OZ30157*/ 09798000
         LA    @15,1                                               2458 09799000
         LR    @00,@14                                             2458 09800000
         ALR   @00,@15                                             2458 09801000
         ST    @00,QUINPTR                                         2458 09802000
*         QUALX=QUALX+F1;           /* GO TO NEXT QUALIFIER  @OZ30157*/ 09803000
         ALR   @04,@15                                             2459 09804000
         ST    @04,QUALX                                           2459 09805000
*         IF QUALX>F2|CURCH^='-' THEN/* OVER 2 OR END        @OZ30157*/ 09806000
         CH    @04,@CH00056                                        2460 09807000
         BH    @RT02460                                            2460 09808000
         CLI   CURCH(@14),C'-'                                     2460 09809000
         BE    @RF02460                                            2460 09810000
@RT02460 DS    0H                                                  2461 09811000
*           ENDSW=BONE;             /* STOP HERE             @OZ30157*/ 09812000
         OI    ENDSW,B'00000100'                                   2461 09813000
*         QUSCPTR=QUINPTR;          /* SKIP ONE INCREMENT    @OZ30157*/ 09814000
@RF02460 MVC   QUSCPTR(4),QUINPTR                                  2462 09815000
*       END;                        /* END QUAL SCAN         @OZ30157*/ 09816000
*   END;                            /* END FETCH QUALIFIERS  @OZ30157*/ 09817000
@RF02454 LA    @04,1                                               2464 09818000
         AL    @04,QUSCPTR                                         2464 09819000
@DE02453 ST    @04,QUSCPTR                                         2464 09820000
         C     @04,QUNDPTR                                         2464 09821000
         BNH   @DL02453                                            2464 09822000
@DC02453 DS    0H                                                  2465 09823000
*   RFY                                                            2465 09824000
*     R14 RSTD;                     /*                       @OZ30157*/ 09825000
*   R14=MS56QU14;                   /* RESTORE RETURN REG    @OZ30157*/ 09826000
         L     R14,MS56QU14                                        2466 09827000
*   RFY                                                            2467 09828000
*     R14 UNRSTD;                   /*                       @OZ30157*/ 09829000
*   RETURN;                         /* RETURN TO CALLER      @OZ30157*/ 09830000
@EL00021 DS    0H                                                  2468 09831000
@EF00021 DS    0H                                                  2468 09832000
@ER00021 BR    @14                                                 2468 09833000
*   END MSG56QU;                    /* END DISP CPU PATHS    @OZ30157*/ 09834000
*ICBMSG46:                                                         2470 09835000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @ZD00086*/ 09836000
ICBMSG46 DS    0H                                                  2471 09837000
*/*  ****************************************************    @Z40LB01*/ 09838000
*/*                                                          @Z40LB01*/ 09839000
*/*    THIS SUBROUTINE ISSUES THE FREEMAIN MACRO FOR         @Z40LB01*/ 09840000
*/*    THE DEQ'D COMTASK CWB.                                @Z40LB01*/ 09841000
*/*                                                          @Z40LB01*/ 09842000
*/*  ****************************************************    @Z40LB01*/ 09843000
*                                                                  2471 09844000
*   DCL                                                            2471 09845000
*     SBPOL CHAR(1);                /* SUBPOOL               @Z40LB01*/ 09846000
*   RESPECIFY                                                      2472 09847000
*    (R14,                                                         2472 09848000
*     R2) RSTD;                     /* RESTRICT REG 2        @Z40LB01*/ 09849000
*   SAVR1446=R14;                   /* SAVE CALLERS REGISTER FOURTEEN   09850000
*                                                            @Z40LB01*/ 09851000
         L     @15,@CA01321                                        2473 09852000
         ST    R14,SAVR1446-SAVR1446(,@15)                         2473 09853000
*   RESPECIFY                                                      2474 09854000
*     R14 UNRSTD;                   /* FREE REG 14           @Z40LB01*/ 09855000
*   R2=CWBPTR;                      /* SET R2 -> CWB         @Z40LB01*/ 09856000
         L     @04,@CA00041                                        2475 09857000
         L     @04,CWBPTR-CWBPTR(,@04)                             2475 09858000
         LR    R2,@04                                              2475 09859000
*   SBPOL=CWBSBPOL;                 /* SET SUBPOOL FOR       @Z40LB01   09860000
*                                      FREEMAIN              @Z40LB01*/ 09861000
         MVC   SBPOL(1),CWBSBPOL(@04)                              2476 09862000
*/*********************************************************  @Z40LB01*/ 09863000
*/* ISSUE FREEMAIN FOR COM WORK AREA                         @Z40LB01*/ 09864000
*/*********************************************************  @Z40LB01*/ 09865000
*                                                                  2477 09866000
*   GEN REFS(R2,R3,SBPOL);                                         2477 09867000
*                                                          /*@XD00086*/ 09868000
          SR    R3,R3               ZERO REG 3                 @X50AC01 09869000
          IC    R3,SBPOL            PUT SBPOL IN LOW BYTE      @X50AC01 09870000
IFREEMN1  FREEMAIN R,LV=136,A=(R2),SP=(R3) ISSUE FREEMAIN      @XD00086 09871000
*   RESPECIFY                                                      2478 09872000
*     R2 UNRSTD;                    /* RELEASE REG 2         @Z40LB01*/ 09873000
*   RECOVER(3)=BONE;                /* SET RECOVERY BIT      @Z40LB01   09874000
*                                      FOR FREED             @Z40LB01*/ 09875000
         L     @04,@CA01313                                        2479 09876000
         OI    RECOVER-RECOVER(@04),B'00100000'                    2479 09877000
*   RFY                                                            2480 09878000
*     R14 RSTD;                     /* RESTRICT REG 14       @Z40LB01*/ 09879000
*   R14=SAVR1446;                   /* RESTORE CALLERS REGISTER    2481 09880000
*                                      FOURTEEN              @Z40LB01*/ 09881000
         L     @04,@CA01321                                        2481 09882000
         L     R14,SAVR1446-SAVR1446(,@04)                         2481 09883000
*   RFY                                                            2482 09884000
*     R14 UNRSTD;                   /* FREE REG 14           @Z40LB01*/ 09885000
*   RETURN;                         /* RTN TO CALLER         @Z40LB01*/ 09886000
@EL00022 DS    0H                                                  2483 09887000
@EF00022 DS    0H                                                  2483 09888000
@ER00022 BR    @14                                                 2483 09889000
*   END ICBMSG46;                   /*                       @Z40LB01*/ 09890000
*ICBMSG82:                                                         2485 09891000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Z40LB01*/ 09892000
*                                                                  2485 09893000
ICBMSG82 DS    0H                                                  2486 09894000
*   /*****************************************************************/ 09895000
*   /*                                                               */ 09896000
*   /* **************************************************    @Z40LB01*/ 09897000
*   /* THIS SUBROUTINE IS USED FOR 2 CONVERSION NEEDS:       @Z40LB01*/ 09898000
*   /* (1)                                                   @Z40LB01*/ 09899000
*   /* THIS SUBROUTINE IS CALLED WHENEVER AN MSSC MACRO IS   @Z40LB01*/ 09900000
*   /* IS ISSUED THAT RESULTS WITH FAILURE INDICATION ON     @Z40LB01*/ 09901000
*   /* RETURN FROM SVC 126.                                  @Z40LB01*/ 09902000
*   /* ON ERROR SITUATIONS A REASON CODE IS PASSED BACK      @Z40LB01*/ 09903000
*   /* TO THE CALLED IN REGISTER 0. THIS SUBROUTINE          @Z40LB01*/ 09904000
*   /* CONVERTS THE REASON CODE TO A 3-BYTE PRINTABLE        @Z40LB01*/ 09905000
*   /* FIELD. THIS FIELD IS THEN INSERTED INTO A WTO         @Z40LB01*/ 09906000
*   /* MESSAGE.                                              @Z40LB01*/ 09907000
*   /* (2)                                                   @Z40LB01*/ 09908000
*   /* CONVERT 2 BYTE HEX SSID(UNIT)                         @Z40LB01*/ 09909000
*   /* TO 3 BYTE REAL UNIT IN EBCDIC                         @Z40LB01*/ 09910000
*   /* SO THAT THE UNIT CAN BE PRINTED                       @Z40LB01*/ 09911000
*   /* VIA WTO.                                              @Z40LB01*/ 09912000
*   /* THIS SUBROUTINE IS CALLED FOR THIS REASON IN          @Z40LB01*/ 09913000
*   /* SUBROUTINES ICBMSG15 AND ICBMSG20                     @Z40LB01*/ 09914000
*   /* WHEN MESSAGE PROCESSING WARRANTS                      @Z40LB01*/ 09915000
*   /* ITS USE.                                              @Z40LB01*/ 09916000
*   /*                                                       @Z40LB01*/ 09917000
*   /* *************************************                 @Z40LB01*/ 09918000
*   /*                                                               */ 09919000
*   /*****************************************************************/ 09920000
*                                                                  2486 09921000
*   RFY                                                            2486 09922000
*     R14 RSTD;                     /* RESTRICT REG 14       @Z40LB01*/ 09923000
*   SAVR1482=R14;                   /* SAVE CALLERS REGISTER FOURTEEN   09924000
*                                                            @Z40LB01*/ 09925000
         L     @15,@CA01322                                        2487 09926000
         ST    R14,SAVR1482-SAVR1482(,@15)                         2487 09927000
*   RFY                                                            2488 09928000
*     R14 UNRSTD;                   /* FREE REG 14           @Z40LB01*/ 09929000
*   BYTES234=BYTES234*F16;          /* SHIFT LEFT            @Z40LB01   09930000
*                                      FOUR BITS             @Z40LB01*/ 09931000
         L     @04,@CA01302                                        2489 09932000
         L     @00,BYTES234-INTER-1(,@04)                          2489 09933000
         N     @00,@CF03658                                        2489 09934000
         SLA   @00,4                                               2489 09935000
         ST    @00,@TF00001                                        2489 09936000
         MVC   BYTES234-INTER(3,@04),@TF00001+1                    2489 09937000
*   BYTE4=(BYTE4|HEX0F);            /* OR IN X0F             @Z40LB01*/ 09938000
         LA    @00,15                                              2490 09939000
         MVC   @ZT00003+3(1),BYTE4-INTER(@04)                      2490 09940000
         O     @00,@ZT00003                                        2490 09941000
         STC   @00,BYTE4-INTER(,@04)                               2490 09942000
*   UNPK(INTER,BYTES34);            /* UNPACK                @Z40LB01*/ 09943000
         UNPK  INTER-INTER(4,@04),BYTES34-INTER(2,@04)             2491 09944000
*   TR(BYTES234,TRANS);             /* TRANS TO EBCDIC       @OZ24706*/ 09945000
*                                                                  2492 09946000
         TR    BYTES234-INTER(3,@04),TRANS                         2492 09947000
*   /*****************************************************************/ 09948000
*   /*                                                               */ 09949000
*   /* *************************************                 @Z40LB01*/ 09950000
*   /*                                                       @Z40LB01*/ 09951000
*   /* TRANSLATED TO 3 BYTES                                 @Z40LB01*/ 09952000
*   /*                                                       @Z40LB01*/ 09953000
*   /* *************************************                 @Z40LB01*/ 09954000
*   /*                                                               */ 09955000
*   /*****************************************************************/ 09956000
*                                                                  2493 09957000
*   RFY                                                            2493 09958000
*     R14 RSTD;                     /* RESTRICT REG 14       @Z40LB01*/ 09959000
*   R14=SAVR1482;                   /* RESTORE CALLERS REGISTER    2494 09960000
*                                      FOURTEEN              @Z40LB01*/ 09961000
         L     @04,@CA01322                                        2494 09962000
         L     @04,SAVR1482-SAVR1482(,@04)                         2494 09963000
         LR    R14,@04                                             2494 09964000
*   RFY                                                            2495 09965000
*     R14 UNRSTD;                   /* FREE REG 14           @Z40LB01*/ 09966000
*   RETURN;                         /* RTN TO CALLER         @Z40LB01*/ 09967000
@EL00023 DS    0H                                                  2496 09968000
@EF00023 DS    0H                                                  2496 09969000
@ER00023 BR    @14                                                 2496 09970000
*   END ICBMSG82;                   /*                       @Z40LB01*/ 09971000
*SDGMSGS:                                                          2498 09972000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Z40LB01*/ 09973000
SDGMSGS  DS    0H                                                  2499 09974000
*/*********************************************************  @Z40LB01*/ 09975000
*/*                                                          @Z40LB01*/ 09976000
*/* PROCEDURE NAME - SDGMSGS                                 @Z40LB01*/ 09977000
*/*                                                          @Z40LB01*/ 09978000
*/* FUNCTION - THIS SUB ROUTINE BUILDS SDG DASD MESSAGE      @Z40LB01*/ 09979000
*/*            DATA LINES AND WHEN THE ML WTO BUFFER         @Z40LB01*/ 09980000
*/*            BECOMES FULL WILL CALL THE WTO WRITE SUB      @Z40LB01*/ 09981000
*/*            ROUTINE (MSG56C) TO ISSUE THE ML WTO.         @Z40LB01*/ 09982000
*/*                                                          @Z40LB01*/ 09983000
*/* INPUTS - INTERNAL FIELDS INITIALIZED BY ICBMSG56.        @Z40LB01*/ 09984000
*/*                                                          @Z40LB01*/ 09985000
*/* OUTPUTS - SDG DASD MESSAGE LINE DATA IN ML WTO BUFFER.   @Z40LB01*/ 09986000
*/*                                                          @Z40LB01*/ 09987000
*/*********************************************************  @Z40LB01*/ 09988000
*                                                                  2499 09989000
*   DCL                                                            2499 09990000
*     SAV14SDG FIXED(31);           /* LOCAL RETURN REG SAVE AREA  2499 09991000
*                                                            @Z40LB01*/ 09992000
*   RFY                                                            2500 09993000
*     R14 RSTD;                     /* RESTRICT REG 14       @Z40LB01*/ 09994000
*   SAV14SDG=R14;                   /* SAVE RETURN REG       @Z40LB01*/ 09995000
         ST    R14,SAV14SDG                                        2501 09996000
*   RFY                                                            2502 09997000
*     R14 UNRSTD;                   /* FREE REG 14           @Z40LB01*/ 09998000
*   SAVTYP13='SD-';                 /* STAG DRIVE CONST      @OZ30157*/ 09999000
*                                                                  2503 10000000
         MVC   SAVTYP13(3),@CC03574                                2503 10001000
*   /*****************************************************************/ 10002000
*   /*                                                               */ 10003000
*   /* CONVERT PRIM TBL PACK TO EBCDIC                       @Z40LB01*/ 10004000
*   /*                                                               */ 10005000
*   /*****************************************************************/ 10006000
*                                                                  2504 10007000
*   INTER=''B;                      /* CLEAR CONV AREA       @Z40LB01*/ 10008000
         L     @04,@CA01302                                        2504 10009000
         XC    INTER-INTER(4,@04),INTER-INTER(@04)                 2504 10010000
*   BYTE4C=PRITBL;                  /* MOVE IN SSID VALUE    @Z40LB01*/ 10011000
         L     @15,@CA01293                                        2505 10012000
         L     @15,MSGPTR-MSGPTR(,@15)                             2505 10013000
         MVC   BYTE4C-INTER(1,@04),PRITBL+2(@15)                   2505 10014000
*   CALL ICBMSG82;                  /* CONV SUB ROUTINE      @Z40LB01*/ 10015000
         BAL   @14,ICBMSG82                                        2506 10016000
*   PRITP=BYTES234;                 /* SAVE PRI TBL SSID     @Z40LB01*/ 10017000
*                                                                  2507 10018000
         L     @04,@CA01302                                        2507 10019000
         MVC   PRITP(3),BYTES234-INTER(@04)                        2507 10020000
*   /*****************************************************************/ 10021000
*   /*                                                               */ 10022000
*   /* CONVERT SECONDARY TBL PACK TO EBCDIC                  @Z40LB01*/ 10023000
*   /*                                                               */ 10024000
*   /*****************************************************************/ 10025000
*                                                                  2508 10026000
*   INTER=''B;                      /* CLEAR CONV AREA       @Z40LB01*/ 10027000
         XC    INTER-INTER(4,@04),INTER-INTER(@04)                 2508 10028000
*   BYTE4C=SECTBL;                  /* MOVE IN SSID VALUE    @Z40LB01*/ 10029000
         L     @15,@CA01293                                        2509 10030000
         L     @15,MSGPTR-MSGPTR(,@15)                             2509 10031000
         MVC   BYTE4C-INTER(1,@04),SECTBL+2(@15)                   2509 10032000
*   CALL ICBMSG82;                  /* CONV SUB ROUTINE      @Z40LB01*/ 10033000
         BAL   @14,ICBMSG82                                        2510 10034000
*   SECTP=BYTES234;                 /* SAVE SEC TBL SSID     @Z40LB01*/ 10035000
         L     @04,@CA01302                                        2511 10036000
         MVC   SECTP(3),BYTES234-INTER(@04)                        2511 10037000
*SDG:                               /* DO LOOP START LABEL - END   2512 10038000
*                                      LABEL ENDSDG:         @Z40LB01*/ 10039000
*   DO I=F1 TO F28;                 /* SCAN BY SDG           @Z40LB01*/ 10040000
SDG      LA    @04,1                                               2512 10041000
         STH   @04,I                                               2512 10042000
@DL02512 DS    0H                                                  2513 10043000
*     IF SDGREQ(I)^=F0 THEN         /* ANY VAL REQ THIS SDG  @Z40LB01*/ 10044000
         SLR   @00,@00                                             2513 10045000
         IC    @00,SDGREQ-1(@04)                                   2513 10046000
         CH    @00,@CH00226                                        2513 10047000
         BE    @RF02513                                            2513 10048000
*VALID:                             /* DO GROUP START LABEL - END  2514 10049000
*                                      LABEL ENDVALID:       @Z40LB01*/ 10050000
*       DO;                         /* PROCESS THE VALID REQUESTS  2514 10051000
*                                      THIS SDG              @Z40LB01*/ 10052000
*                                                                  2514 10053000
VALID    DS    0H                                                  2515 10054000
*         /***********************************************************/ 10055000
*         /*                                                         */ 10056000
*         /* CONVERT I-1 TO SDG # EBCDIC                     @Z40LB01*/ 10057000
*         /*                                                         */ 10058000
*         /***********************************************************/ 10059000
*                                                                  2515 10060000
*         INTER=''B;                /* CLEAR CONV AREA       @Z40LB01*/ 10061000
         L     @04,@CA01302                                        2515 10062000
         XC    INTER-INTER(4,@04),INTER-INTER(@04)                 2515 10063000
*         BYTE4=I-F1;               /* MOVE IN SDG VALUE     @Z40LB01*/ 10064000
         LH    @00,I                                               2516 10065000
         BCTR  @00,0                                               2516 10066000
         STC   @00,BYTE4-INTER(,@04)                               2516 10067000
*         CVD(BYTE4,INTER);         /* CONVERT TO DEC        @Z40LB01*/ 10068000
         CVD   @00,@TS00001                                        2517 10069000
         MVC   INTER-INTER(4,@04),@TS00001+4                       2517 10070000
*         INTER=INTER/F16;          /* SHIFT OUT SIGN        @Z40LB01*/ 10071000
         L     @00,INTER-INTER(,@04)                               2518 10072000
         SRL   @00,4                                               2518 10073000
         ST    @00,INTER-INTER(,@04)                               2518 10074000
*         CALL ICBMSG82;            /* CONV SUB ROUTINE      @Z40LB01*/ 10075000
         BAL   @14,ICBMSG82                                        2519 10076000
*         SAVTYP45=BYTES34;         /* SAVE SDG #            @OZ30157*/ 10077000
         L     @04,@CA01302                                        2520 10078000
         MVC   SAVTYP45(2),BYTES34-INTER(@04)                      2520 10079000
*SSID:                              /* DO LOOP START LABEL - END   2521 10080000
*                                      LABEL ENDSSID:        @Z40LB01*/ 10081000
*         DO K=F1 TO F8;            /* SCAN SSID WITHIN SDG  @Z40LB01*/ 10082000
*                                                                  2521 10083000
SSID     LA    @04,1                                               2521 10084000
         STH   @04,K                                               2521 10085000
@DL02521 DS    0H                                                  2522 10086000
*           /*********************************************************/ 10087000
*           /*                                                       */ 10088000
*           /* LOOP THROUGH THE REQUEST BITS AND PROCESS     @Z40LB01*/ 10089000
*           /* THE DASD SSID MESSAGE LINES FOR THOSE THAT    @Z40LB01*/ 10090000
*           /* ARE SET.                                      @Z40LB01*/ 10091000
*           /*                                                       */ 10092000
*           /*********************************************************/ 10093000
*                                                                  2522 10094000
*           IF CONFGMSK(K)=(CONFGMSK(K)&SDGREQ(I)) THEN/*    @Z40LB01*/ 10095000
         L     @15,@CA01312                                        2522 10096000
         LH    @14,I                                               2522 10097000
         ST    @04,@TF00001                                        2522 10098000
         ALR   @04,@15                                             2522 10099000
         BCTR  @04,0                                               2522 10100000
         MVC   @TS00001(1),CONFGMSK-CONFGMSK(@04)                  2522 10101000
         LA    @04,SDGREQ-1(@14)                                   2522 10102000
         NC    @TS00001(1),0(@04)                                  2522 10103000
         AL    @15,@TF00001                                        2522 10104000
         BCTR  @15,0                                               2522 10105000
         CLC   CONFGMSK-CONFGMSK(1,@15),@TS00001                   2522 10106000
         BNE   @RF02522                                            2522 10107000
*             DO;                   /*                       @Z40LB01*/ 10108000
*                                                                  2523 10109000
*               /*****************************************************/ 10110000
*               /*                                                   */ 10111000
*               /* FILL THE DASD STATUS FIELDS FROM          @Z40LB01*/ 10112000
*               /* SDG STATUS TABLE.                         @Z40LB01*/ 10113000
*               /*                                                   */ 10114000
*               /*****************************************************/ 10115000
*                                                                  2524 10116000
*               IF FLIPSW=BONE THEN /* SECOND HALF MSG LINE ?      2524 10117000
*                                                            @Z40LB01*/ 10118000
         TM    FLIPSW,B'00010000'                                  2524 10119000
         BNO   @RF02524                                            2524 10120000
*                 DTAPTR=ADDR(SHALF);/* PNT TO SECOND HALF   @OZ30157*/ 10121000
         L     @04,WPLPTR                                          2525 10122000
         LA    @04,SHALF+4(,@04)                                   2525 10123000
         ST    @04,DTAPTR                                          2525 10124000
*               ELSE                /* FIRST HALF MESSAGE LINE     2526 10125000
*                                                            @Z40LB01*/ 10126000
*                 DTAPTR=ADDR(FHALF);/* POINT TO IT          @OZ30157*/ 10127000
         B     @RC02524                                            2526 10128000
@RF02524 LA    @04,4                                               2526 10129000
         AL    @04,WPLPTR                                          2526 10130000
         ST    @04,DTAPTR                                          2526 10131000
*               STATI=((I-1)*8+K);  /* SAVE SSID INDEX       @Z40LB01*/ 10132000
@RC02524 LH    @04,K                                               2527 10133000
         LH    @15,I                                               2527 10134000
         LR    @00,@15                                             2527 10135000
         BCTR  @00,0                                               2527 10136000
         SLA   @00,3                                               2527 10137000
         ALR   @00,@04                                             2527 10138000
         STH   @00,STATI                                           2527 10139000
*               DTYPE=SAVTYP;       /* MESSAGE TYPE FIELD    @Z40LB01*/ 10140000
         L     @14,DTAPTR                                          2528 10141000
         MVC   DTYPE(5,@14),SAVTYP                                 2528 10142000
*               DSSID=SDGSSIDS(STATI);/* SSID FLD            @Z40LB01*/ 10143000
*                                                                  2529 10144000
         MH    @00,@CH00060                                        2529 10145000
         LR    @03,@00                                             2529 10146000
         LA    @02,SDGSSIDS-3(@03)                                 2529 10147000
         MVC   DSSID(3,@14),0(@02)                                 2529 10148000
*               /*****************************************************/ 10149000
*               /*                                                   */ 10150000
*               /* IF THE STAT TABLE HAS * THEN THE          @Z40LB01*/ 10151000
*               /* PAB READ FAILED AND MESSAGE HAS           @Z40LB01*/ 10152000
*               /* TO REFLECT THIS.                          @Z40LB01*/ 10153000
*               /*                                                   */ 10154000
*               /*****************************************************/ 10155000
*                                                                  2530 10156000
*               IF STATFLG(STATI)='*' THEN/* TEST PAB READ   @Z40LB01*/ 10157000
         L     @03,WORKPTR                                         2530 10158000
         ALR   @03,@00                                             2530 10159000
         CLI   STATFLG+41(@03),C'*'                                2530 10160000
         BNE   @RF02530                                            2530 10161000
*                 DO;               /* PAB READ ERROR        @Z40LB01*/ 10162000
*                   IF CONFGMSK(K)=(SDGON(I)&CONFGMSK(K))/*  @Z40LB01*/ 10163000
*                     THEN          /*                       @Z40LB01*/ 10164000
         L     @03,@CA01312                                        2532 10165000
         L     @02,@CA01293                                        2532 10166000
         L     @02,MSGPTR-MSGPTR(,@02)                             2532 10167000
         ALR   @02,@15                                             2532 10168000
         MVC   @TS00001(1),SDGON+1(@02)                            2532 10169000
         ST    @04,@TF00001                                        2532 10170000
         ALR   @04,@03                                             2532 10171000
         BCTR  @04,0                                               2532 10172000
         NC    @TS00001(1),CONFGMSK-CONFGMSK(@04)                  2532 10173000
         AL    @03,@TF00001                                        2532 10174000
         BCTR  @03,0                                               2532 10175000
         CLC   CONFGMSK-CONFGMSK(1,@03),@TS00001                   2532 10176000
         BNE   @RF02532                                            2532 10177000
*                     DO;           /* MARK ONLINE STATUS    @Z40LB01*/ 10178000
*                       DSTAT1='O'; /* ONLINE                @OZ30157*/ 10179000
         MVI   DSTAT1(@14),C'O'                                    2534 10180000
*                       DSTAT27='      ';/* CLEAR            @OZ30157*/ 10181000
         MVC   DSTAT27(6,@14),@CC01404                             2535 10182000
*                     END;          /* END ONLINE STATUS     @Z40LB01*/ 10183000
*                   ELSE            /* NOT ONLINE STATUS     @Z40LB01*/ 10184000
*                     DSTAT='OFFLINE';/* OFFLINE             @Z40LB01*/ 10185000
         B     @RC02532                                            2537 10186000
@RF02532 L     @04,DTAPTR                                          2537 10187000
         MVC   DSTAT(7,@04),@CC02856                               2537 10188000
*                   DUSE='********';/* ERROR INDICATOR       @Z40LB01*/ 10189000
@RC02532 L     @04,DTAPTR                                          2538 10190000
         MVC   DUSE(8,@04),@CC03581                                2538 10191000
*                 END;              /* END UNSUCCESSFUL PAB READ   2539 10192000
*                                      STATUS                @Z40LB01*/ 10193000
*                                                                  2539 10194000
*               /*****************************************************/ 10195000
*               /*                                                   */ 10196000
*               /* GOOD PAB DATA AVAILABLE.                  @Z40LB01*/ 10197000
*               /*                                                   */ 10198000
*               /*****************************************************/ 10199000
*                                                                  2540 10200000
*               ELSE                /* PAB READ WAS SUCCESSFUL     2540 10201000
*                                                            @Z40LB01*/ 10202000
*                 DO;               /* GOOD STATUS PROCESS   @Z40LB01*/ 10203000
*                                                                  2540 10204000
         B     @RC02530                                            2540 10205000
@RF02530 DS    0H                                                  2541 10206000
*                   /*************************************************/ 10207000
*                   /*                                               */ 10208000
*                   /* DASD STATUS                           @Z40LB01*/ 10209000
*                   /*                                               */ 10210000
*                   /*************************************************/ 10211000
*                                                                  2541 10212000
*                   IF STSTAG(STATI)=BONE|STREAL(STATI)=BONE THEN/*     10213000
*                                                            @OZ30157*/ 10214000
         LH    @04,STATI                                           2541 10215000
         MH    @04,@CH00060                                        2541 10216000
         LA    @15,44                                              2541 10217000
         AL    @15,WORKPTR                                         2541 10218000
         ST    @04,@TF00001                                        2541 10219000
         ALR   @04,@15                                             2541 10220000
         AL    @04,@CF03655                                        2541 10221000
         TM    STSTAG(@04),B'01100000'                             2541 10222000
         BZ    @RF02541                                            2541 10223000
*                     DO;           /* SSID ONLINE CODE      @Z40LB01*/ 10224000
*                       DSTAT1='O'; /* ONLINE CONSTANT       @OZ30157*/ 10225000
         L     @04,DTAPTR                                          2543 10226000
         MVI   DSTAT1(@04),C'O'                                    2543 10227000
*                       IF STBIND(STATI)=BONE THEN/*         @OZ30157*/ 10228000
         AL    @15,@TF00001                                        2544 10229000
         AL    @15,@CF03655                                        2544 10230000
         TM    STBIND(@15),B'00000100'                             2544 10231000
         BNO   @RF02544                                            2544 10232000
*                         DSTAT25='/BND';/* BIND CONST       @OZ30157*/ 10233000
         MVC   DSTAT25(4,@04),@CC03582                             2545 10234000
*                       ELSE        /* NOT BOUND             @Z40LB01*/ 10235000
*                         IF STNEUT(STATI)=BONE THEN/*       @OZ30157*/ 10236000
         B     @RC02544                                            2546 10237000
@RF02544 LH    @04,STATI                                           2546 10238000
         MH    @04,@CH00060                                        2546 10239000
         L     @15,WORKPTR                                         2546 10240000
         ALR   @15,@04                                             2546 10241000
         TM    STNEUT+41(@15),B'00000010'                          2546 10242000
         BNO   @RF02546                                            2546 10243000
*                           DSTAT25='/SUU';/* UNUSABLE       @OZ30157*/ 10244000
         L     @04,DTAPTR                                          2547 10245000
         MVC   DSTAT25(4,@04),@CC03583                             2547 10246000
*                     END;          /* END ONLINE CODE       @Z40LB01*/ 10247000
*                   ELSE            /* CHECK FOR OFFPEND STATUS    2549 10248000
*                                                            @ZD00005*/ 10249000
*                     IF CONFGMSK(K)=(SDGRDY(I)&CONFGMSK(K))/*     2549 10250000
*                                                            @Z40LB01*/ 10251000
*                       THEN        /*                       @Z40LB01*/ 10252000
         B     @RC02541                                            2549 10253000
@RF02541 LH    @04,K                                               2549 10254000
         L     @15,@CA01312                                        2549 10255000
         LH    @14,I                                               2549 10256000
         L     @03,@CA01293                                        2549 10257000
         L     @03,MSGPTR-MSGPTR(,@03)                             2549 10258000
         ALR   @03,@14                                             2549 10259000
         MVC   @TS00001(1),SDGRDY+1(@03)                           2549 10260000
         ST    @04,@TF00001                                        2549 10261000
         ALR   @04,@15                                             2549 10262000
         BCTR  @04,0                                               2549 10263000
         NC    @TS00001(1),CONFGMSK-CONFGMSK(@04)                  2549 10264000
         AL    @15,@TF00001                                        2549 10265000
         BCTR  @15,0                                               2549 10266000
         CLC   CONFGMSK-CONFGMSK(1,@15),@TS00001                   2549 10267000
         BNE   @RF02549                                            2549 10268000
*                       DO;         /* MARK OFFPEND STATUS   @ZD00005*/ 10269000
*                         DSTAT='OFFPEND';/* OFFLINE PENDING @ZD00005*/ 10270000
         L     @04,DTAPTR                                          2551 10271000
         MVC   DSTAT(7,@04),@CC03584                               2551 10272000
*                       END;        /* END OFFPEND STATUS    @ZD00005*/ 10273000
*                     ELSE          /* MARK OFFLINE STATUS   @Z40LB01*/ 10274000
*                       DSTAT='OFFLINE';/* SET FIELD OFFLINE @Z40LB01*/ 10275000
*                                                                  2553 10276000
         B     @RC02549                                            2553 10277000
@RF02549 L     @04,DTAPTR                                          2553 10278000
         MVC   DSTAT(7,@04),@CC02856                               2553 10279000
*                   /*************************************************/ 10280000
*                   /*                                               */ 10281000
*                   /* DASD USE                              @ZD00005*/ 10282000
*                   /*                                               */ 10283000
*                   /*************************************************/ 10284000
*                                                                  2554 10285000
*                   IF STSTAG(STATI)=BONE THEN/* IF STAGING        2554 10286000
*                                      DRIVE@OZ30157                 */ 10287000
@RC02549 DS    0H                                                  2554 10288000
@RC02541 LH    @04,STATI                                           2554 10289000
         MH    @04,@CH00060                                        2554 10290000
         L     @15,WORKPTR                                         2554 10291000
         ALR   @15,@04                                             2554 10292000
         TM    STSTAG+41(@15),B'01000000'                          2554 10293000
         BNO   @RF02554                                            2554 10294000
*                     DUSE14='STAG';/* STAGE CONST           @OZ30157*/ 10295000
         L     @04,DTAPTR                                          2555 10296000
         MVC   DUSE14(4,@04),@CC03585                              2555 10297000
*                   IF DSSID=PRITP THEN/* IS IT PRI TBL      @Z40LB01*/ 10298000
@RF02554 L     @04,DTAPTR                                          2556 10299000
         CLC   DSSID(3,@04),PRITP                                  2556 10300000
         BNE   @RF02556                                            2556 10301000
*                     DUSE58='/PRI';/* FILL PRIMARY          @OZ30157*/ 10302000
         MVC   DUSE58(4,@04),@CC03586                              2557 10303000
*                   ELSE            /* NOT PRIMARY           @Z40LB01*/ 10304000
*                     IF DSSID=SECTP THEN/* IS IT SEC TBL    @Z40LB01*/ 10305000
         B     @RC02556                                            2558 10306000
@RF02556 L     @04,DTAPTR                                          2558 10307000
         CLC   DSSID(3,@04),SECTP                                  2558 10308000
         BNE   @RF02558                                            2558 10309000
*                       DUSE58='/SEC';/* FILL SEC            @OZ30157*/ 10310000
         MVC   DUSE58(4,@04),@CC03587                              2559 10311000
*                     ELSE          /* NOT PRI OR SEC        @Z40LB01*/ 10312000
*                       IF CONFGMSK(5)=/*                    @Z40LB01*/ 10313000
*                           (STATFLG(STATI)&CONFGMSK(5))/*   @Z40LB01*/ 10314000
*                         THEN      /* ALT TBL PACK ?        @Z40LB01*/ 10315000
         B     @RC02558                                            2560 10316000
@RF02558 L     @04,@CA01312                                        2560 10317000
         LH    @15,STATI                                           2560 10318000
         MH    @15,@CH00060                                        2560 10319000
         L     @14,WORKPTR                                         2560 10320000
         ALR   @14,@15                                             2560 10321000
         MVC   @TS00001(1),STATFLG+41(@14)                         2560 10322000
         NC    @TS00001(1),CONFGMSK-CONFGMSK+4(@04)                2560 10323000
         CLC   CONFGMSK-CONFGMSK+4(1,@04),@TS00001                 2560 10324000
         BNE   @RF02560                                            2560 10325000
*                         DUSE58='/ALT';/* ALT CONST         @OZ30157*/ 10326000
*                                                                  2561 10327000
         L     @04,DTAPTR                                          2561 10328000
         MVC   DUSE58(4,@04),@CC03588                              2561 10329000
*                   /*************************************************/ 10330000
*                   /*                                               */ 10331000
*                   /* UNIQUE STAGING USE                    @Z40LB01*/ 10332000
*                   /*                                               */ 10333000
*                   /*************************************************/ 10334000
*                                                                  2562 10335000
*                   IF STCONV(STATI)=BONE THEN/* IF CONVERTIBLE    2562 10336000
*                                                            @OZ30157*/ 10337000
@RF02560 DS    0H                                                  2562 10338000
@RC02558 DS    0H                                                  2562 10339000
@RC02556 LH    @04,STATI                                           2562 10340000
         MH    @04,@CH00060                                        2562 10341000
         L     @15,WORKPTR                                         2562 10342000
         ALR   @15,@04                                             2562 10343000
         TM    STCONV+41(@15),B'00000001'                          2562 10344000
         BNO   @RF02562                                            2562 10345000
*                     DUSE58='/CNV';/* CONVERTABLE           @OZ30157*/ 10346000
         L     @04,DTAPTR                                          2563 10347000
         MVC   DUSE58(4,@04),@CC03589                              2563 10348000
*                   IF STREAL(STATI)=BONE THEN/* IF REAL DRIVE     2564 10349000
*                                                            @OZ30157*/ 10350000
@RF02562 LH    @04,STATI                                           2564 10351000
         MH    @04,@CH00060                                        2564 10352000
         L     @15,WORKPTR                                         2564 10353000
         ALR   @15,@04                                             2564 10354000
         TM    STREAL+41(@15),B'00100000'                          2564 10355000
         BNO   @RF02564                                            2564 10356000
*                     DUSE14='REAL';/* REAL CONST            @OZ30157*/ 10357000
         L     @04,DTAPTR                                          2565 10358000
         MVC   DUSE14(4,@04),@CC03590                              2565 10359000
*                   IF STNEUT(STATI)=BONE THEN/* IF NEUTRAL STAT   2566 10360000
*                                                            @OZ30157*/ 10361000
@RF02564 LH    @04,STATI                                           2566 10362000
         MH    @04,@CH00060                                        2566 10363000
         L     @15,WORKPTR                                         2566 10364000
         ALR   @15,@04                                             2566 10365000
         TM    STNEUT+41(@15),B'00000010'                          2566 10366000
         BNO   @RF02566                                            2566 10367000
*                     DUSE14='NEUT';/* NEUTRAL CONST         @OZ30157*/ 10368000
         L     @04,DTAPTR                                          2567 10369000
         MVC   DUSE14(4,@04),@CC03591                              2567 10370000
*                   IF STCUA1(STATI)=BONE|STCUA2(STATI)=BONE THEN/*     10371000
*                                                            @OZ30157*/ 10372000
@RF02566 LH    @04,STATI                                           2568 10373000
         MH    @04,@CH00060                                        2568 10374000
         L     @15,WORKPTR                                         2568 10375000
         ALR   @15,@04                                             2568 10376000
         TM    STCUA1+41(@15),B'11000000'                          2568 10377000
         BZ    @RF02568                                            2568 10378000
*                     DUSE14='TEST';/* TEST CONSTANT         @OZ30157*/ 10379000
*                                                                  2569 10380000
         L     @04,DTAPTR                                          2569 10381000
         MVC   DUSE14(4,@04),@CC03592                              2569 10382000
*                   /*************************************************/ 10383000
*                   /*                                               */ 10384000
*                   /* DASD CONFIG                           @Z40LB01*/ 10385000
*                   /*                                               */ 10386000
*                   /*************************************************/ 10387000
*                                                                  2570 10388000
*                   STCUA(STATI)=   /*                       @Z40LB01*/ 10389000
*                       (STCUA(STATI)&HEX1F);/* CLEAR BITS   @Z40LB01*/ 10390000
@RF02568 LH    @04,STATI                                           2570 10391000
         MH    @04,@CH00060                                        2570 10392000
         LA    @15,44                                              2570 10393000
         AL    @15,WORKPTR                                         2570 10394000
         ST    @04,@TF00001                                        2570 10395000
         ALR   @04,@15                                             2570 10396000
         BCTR  @04,0                                               2570 10397000
         NI    STCUA-2(@04),X'1F'                                  2570 10398000
*                   INTER=''B;      /* CLEAR CONV AREA       @Z40LB01*/ 10399000
         L     @04,@CA01302                                        2571 10400000
         XC    INTER-INTER(4,@04),INTER-INTER(@04)                 2571 10401000
*                   BYTE4C=STCUA(STATI);/* MOVE IN CUA DATA  @Z40LB01*/ 10402000
         AL    @15,@TF00001                                        2572 10403000
         BCTR  @15,0                                               2572 10404000
         MVC   BYTE4C-INTER(1,@04),STCUA-2(@15)                    2572 10405000
*                   CALL ICBMSG82;  /* CALL CONV SUB         @Z40LB01*/ 10406000
         BAL   @14,ICBMSG82                                        2573 10407000
*                   DCONF12=BYTES34;/* FILL CUR RUA FLD      @OZ30157*/ 10408000
         L     @04,DTAPTR                                          2574 10409000
         L     @15,@CA01302                                        2574 10410000
         MVC   DCONF12(2,@04),BYTES34-INTER(@15)                   2574 10411000
*                   IF STATOUA1(STATI)=BONE THEN/*           @OZ30157*/ 10412000
         LH    @04,STATI                                           2575 10413000
         MH    @04,@CH00060                                        2575 10414000
         LA    @14,44                                              2575 10415000
         AL    @14,WORKPTR                                         2575 10416000
         ST    @04,@TF00001                                        2575 10417000
         ALR   @04,@14                                             2575 10418000
         BCTR  @04,0                                               2575 10419000
         BCTR  @04,0                                               2575 10420000
         TM    STATOUA1-1(@04),B'10000000'                         2575 10421000
         BNO   @RF02575                                            2575 10422000
*                     DO;           /* ORIG RUA CODE         @Z40LB01*/ 10423000
*                       STATOUA(STATI)=/*                    @Z40LB01*/ 10424000
*                           (STATOUA(STATI)&HEX1F);/* CLR BITS     2577 10425000
*                                                            @Z40LB01*/ 10426000
         LR    @04,@14                                             2577 10427000
         AL    @04,@TF00001                                        2577 10428000
         BCTR  @04,0                                               2577 10429000
         BCTR  @04,0                                               2577 10430000
         NI    STATOUA-1(@04),X'1F'                                2577 10431000
*                       INTER=''B;  /* CLEAR CONV AREA       @Z40LB01*/ 10432000
         XC    INTER-INTER(4,@15),INTER-INTER(@15)                 2578 10433000
*                       BYTE4C=STATOUA(STATI);/* MOVE IN OUA DATA  2579 10434000
*                                                            @Z40LB01*/ 10435000
         AL    @14,@TF00001                                        2579 10436000
         BCTR  @14,0                                               2579 10437000
         BCTR  @14,0                                               2579 10438000
         MVC   BYTE4C-INTER(1,@15),STATOUA-1(@14)                  2579 10439000
*                       CALL ICBMSG82;/* CALL CONV SUB       @Z40LB01*/ 10440000
         BAL   @14,ICBMSG82                                        2580 10441000
*                       DCONF45=BYTES34;/* FILL ORIG RUA     @OZ30157*/ 10442000
         L     @04,DTAPTR                                          2581 10443000
         L     @15,@CA01302                                        2581 10444000
         MVC   DCONF45(2,@04),BYTES34-INTER(@15)                   2581 10445000
*                     END;          /* END ORIG RUA CODE     @Z40LB01*/ 10446000
*                 END;              /* GOOD PAB READ STATUS CODE   2583 10447000
*                                                            @Z40LB01*/ 10448000
*                                                                  2583 10449000
@RF02575 DS    0H                                                  2584 10450000
*               /*****************************************************/ 10451000
*               /*                                                   */ 10452000
*               /* ONE MESSAGE LINE CONTAINS THE STATUS      @Z40LB01*/ 10453000
*               /* OF TWO SSIDS. SWITCH FIELD (FLIPSW)       @Z40LB01*/ 10454000
*               /* IS USED TO KEEP TRACK OF THIS SO WHEN     @Z40LB01*/ 10455000
*               /* THE TWO SSIDS HAVE BEEN PUT IN THE        @Z40LB01*/ 10456000
*               /* LINE, THE LINE CAN BE MOVED TO THE        @Z40LB01*/ 10457000
*               /* ML WTO BUFFER AREA. FLIPSW = 0 FOR        @Z40LB01*/ 10458000
*               /* FIRST SSID AND FLIPSW = 1 FOR 2ND         @Z40LB01*/ 10459000
*               /* SSID STATUS.                              @Z40LB01*/ 10460000
*               /*                                                   */ 10461000
*               /*****************************************************/ 10462000
*                                                                  2584 10463000
*               IF FLIPSW=BONE THEN /*                       @Z40LB01*/ 10464000
*                                                                  2584 10465000
@RC02530 TM    FLIPSW,B'00010000'                                  2584 10466000
         BNO   @RF02584                                            2584 10467000
*                 /***************************************************/ 10468000
*                 /*                                                 */ 10469000
*                 /* FILL PART TWO MESSAGE FIELDS            @Z40LB01*/ 10470000
*                 /*                                                 */ 10471000
*                 /***************************************************/ 10472000
*                                                                  2585 10473000
*                 CALL MSG56D;      /*                       @Z40LB01*/ 10474000
         BAL   @14,MSG56D                                          2585 10475000
*               ELSE                /* FIRST HALF MESSAGE LINE     2586 10476000
*                                                            @Z40LB01*/ 10477000
*                                                                  2586 10478000
*                 /***************************************************/ 10479000
*                 /*                                                 */ 10480000
*                 /* FILL PART ONE MESSAGE FIELDS            @Z40LB01*/ 10481000
*                 /*                                                 */ 10482000
*                 /***************************************************/ 10483000
*                                                                  2586 10484000
*                 FLIPSW=BONE;      /* SET SWITCH FOR SEC HALF     2586 10485000
*                                                            @Z40LB01*/ 10486000
         B     @RC02584                                            2586 10487000
@RF02584 OI    FLIPSW,B'00010000'                                  2586 10488000
*             END;                  /* END MESSAGE BUILD     @Z40LB01*/ 10489000
@RC02584 DS    0H                                                  2588 10490000
*ENDSSID:                           /* END OF THE SSID SCAN DO LOOP     10491000
*                                                            @Z40LB01*/ 10492000
*         END;                      /* END SSID SCAN         @Z40LB01*/ 10493000
@RF02522 DS    0H                                                  2588 10494000
ENDSSID  LA    @04,1                                               2588 10495000
         AH    @04,K                                               2588 10496000
         STH   @04,K                                               2588 10497000
         CH    @04,@CH00036                                        2588 10498000
         BNH   @DL02521                                            2588 10499000
*ENDVALID:                          /* END OF THE VALID SDG REQUEST     10500000
*                                      CODE                  @Z40LB01*/ 10501000
*       END;                        /* END VALID REQUEST CODE FOR SDG   10502000
*                                                            @Z40LB01*/ 10503000
ENDVALID DS    0H                                                  2590 10504000
*ENDSDG:                            /* END OF THE SDG SCAN DO LOOP 2590 10505000
*                                                            @Z40LB01*/ 10506000
*   END;                            /* END SDG SCAN          @Z40LB01*/ 10507000
@RF02513 DS    0H                                                  2590 10508000
ENDSDG   LA    @04,1                                               2590 10509000
         AH    @04,I                                               2590 10510000
         STH   @04,I                                               2590 10511000
         CH    @04,@CH01339                                        2590 10512000
         BNH   @DL02512                                            2590 10513000
*   RFY                                                            2591 10514000
*     R14 RSTD;                     /* RESTRICT REG 14       @Z40LB01*/ 10515000
*   R14=SAV14SDG;                   /* RESTORE RETURN REG    @Z40LB01*/ 10516000
         L     R14,SAV14SDG                                        2592 10517000
*   RFY                                                            2593 10518000
*     R14 UNRSTD;                   /* FREE REG 14           @Z40LB01*/ 10519000
*   RETURN;                         /* RETURN ICBMSG56       @Z40LB01*/ 10520000
@EL00024 DS    0H                                                  2594 10521000
@EF00024 DS    0H                                                  2594 10522000
@ER00024 BR    @14                                                 2594 10523000
*   END SDGMSGS;                    /* END SUB ROUTINE       @Z40LB01*/ 10524000
*   END ICBMSG56                    /*                       @Z40LB01*/ 10525000
*                                                                  2596 10526000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 10527000
*/*%INCLUDE SYSLIB  (IEZCWB  )                                       */ 10528000
*/*%INCLUDE SYSLIB  (IEZWPL  )                                       */ 10529000
*/*%INCLUDE SYSLIB  (IEZVVICB)                                       */ 10530000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 10531000
*/*%INCLUDE SYSLIB  (IEZSSC  )                                       */ 10532000
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                       */ 10533000
*                                                                  2596 10534000
*       ;                                                          2596 10535000
@DATA    DS    0H                                                       10536000
@CH00226 DC    H'0'                                                     10537000
@CH00060 DC    H'3'                                                     10538000
@CH00038 DC    H'6'                                                     10539000
@CH00036 DC    H'8'                                                     10540000
@CH00034 DC    H'10'                                                    10541000
@CH00033 DC    H'11'                                                    10542000
@CH00032 DC    H'12'                                                    10543000
@CH01227 DC    H'16'                                                    10544000
@CH00049 DC    H'24'                                                    10545000
@CH01339 DC    H'28'                                                    10546000
@CH01342 DC    H'36'                                                    10547000
@CH01344 DC    H'40'                                                    10548000
@CH01372 DC    H'44'                                                    10549000
@CH03605 DC    H'76'                                                    10550000
@CH00866 DC    H'256'                                                   10551000
@CH01353 DC    H'296'                                                   10552000
@CH01355 DC    H'320'                                                   10553000
@CH03055 DC    H'388'                                                   10554000
@CH03211 DC    H'1512'                                                  10555000
@CH03604 DC    H'1744'                                                  10556000
@CH03110 DC    H'2047'                                                  10557000
@CH03603 DC    H'-688'                                                  10558000
@SM03659 MVC   MVREC(0,@14),MVSRC(@02)                                  10559000
@SM03663 MVC   0(0,@02),CURQUAL(@03)                                    10560000
         DS    0F                                                       10561000
@SA00001 DS    18F                                                      10562000
@TF00001 DS    F                                                        10563000
@TF00002 DS    F                                                        10564000
@ZTEMPS  DS    0F                                                       10565000
@ZT00002 DC    F'0'                                                     10566000
@ZT00003 DC    F'0'                                                     10567000
@ZTEMPND EQU   *                                                        10568000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         10569000
         DS    0F                                                       10570000
@CF00047 DC    F'1'                                                     10571000
@CH00047 EQU   @CF00047+2                                               10572000
@CF00056 DC    F'2'                                                     10573000
@CH00056 EQU   @CF00056+2                                               10574000
@CF00045 DC    F'4'                                                     10575000
@CH00045 EQU   @CF00045+2                                               10576000
@CF00291 DC    F'32'                                                    10577000
@CF01346 DC    F'64'                                                    10578000
@CH01346 EQU   @CF01346+2                                               10579000
@CF03298 DC    F'100'                                                   10580000
@CF03658 DC    F'16777215'                                              10581000
@CF03654 DC    F'-8'                                                    10582000
@CF03609 DC    F'-4'                                                    10583000
@CF03655 DC    F'-3'                                                    10584000
@CF03336 DC    XL4'00070100'                                            10585000
@CA00041 DC    A(CWBPTR)                                                10586000
@CA00927 DC    A(UCBPTR)                                                10587000
@CA01293 DC    A(MSGPTR)                                                10588000
@CA01294 DC    A(BITSW)                                                 10589000
@CA01302 DC    A(INTER)                                                 10590000
@CA01311 DC    A(CMDQUE)                                                10591000
@CA01312 DC    A(CONFGMSK)                                              10592000
@CA01313 DC    A(RECOVER)                                               10593000
@CA01321 DC    A(SAVR1446)                                              10594000
@CA01322 DC    A(SAVR1482)                                              10595000
@CA01310 DC    A(CMDPTR)                                                10596000
         DS    0D                                                       10597000
WPLPTR   DS    A                                                        10598000
VVIPTR   DS    A                                                        10599000
WORKPTR  DC    AL4(WORK)                                                10600000
SDGPTR   DS    A                                                        10601000
DRCPTR   DS    A                                                        10602000
CPUPTR   DS    A                                                        10603000
CPHPTR   DS    A                                                        10604000
CPDPTR   DS    A                                                        10605000
VUAPTR   DS    A                                                        10606000
STPTR    DS    A                                                        10607000
CPHEND   DS    A                                                        10608000
SDGEND   DS    A                                                        10609000
DRCEND   DS    A                                                        10610000
QCBPTR   DS    A                                                        10611000
TABPTR   DS    A                                                        10612000
TABPTR1  DS    A                                                        10613000
TABPTR2  DS    A                                                        10614000
QCTPTR   DS    A                                                        10615000
CONDPTR  DS    A                                                        10616000
PWCS7X   DS    A                                                        10617000
PABPTR   DS    A                                                        10618000
PTHPTR   DS    A                                                        10619000
VERPTR   DS    A                                                        10620000
CELPTR   DS    A                                                        10621000
DTAPTR   DS    A                                                        10622000
QCTEND   DS    A                                                        10623000
WPLPSAVE DS    A                                                        10624000
GMSTT    DC    AL4(GMTAB)                                               10625000
GMCUR    DC    A(0)                                                     10626000
GMEND    DC    AL4(GMTAB)                                               10627000
GMPTR    DS    A                                                        10628000
SDGLEN   DC    AL4(16)                                                  10629000
DRCLEN   DC    AL4(30)                                                  10630000
LVUPTR   DS    A                                                        10631000
CONSOL   DC    F'0'                                                     10632000
MS56AL14 DS    F                                                        10633000
MS56MS14 DS    F                                                        10634000
MS56PA14 DS    F                                                        10635000
CONXPTR  DS    A                                                        10636000
PWCS0F   DS    A                                                        10637000
PKPTR    DS    A                                                        10638000
LASTENT  DS    A                                                        10639000
ENDPTR   DS    A                                                        10640000
TESTVAL  DC    F'32768'                                                 10641000
MS56QC14 DS    F                                                        10642000
QCBLST   DS    A                                                        10643000
QCBEPTR  DS    A                                                        10644000
MHPTR    DS    A                                                        10645000
MHSAPTR  DS    A                                                        10646000
MS56TR14 DS    F                                                        10647000
QWPTR    DS    A                                                        10648000
MVPTR    DS    A                                                        10649000
MAPPTR   DS    A                                                        10650000
QCNT     DS    F                                                        10651000
MS56GQ14 DS    F                                                        10652000
QBCHRF   DS    FL4                                                      10653000
         ORG   QBCHRF                                                   10654000
@NM00153 DS    FL1                                                      10655000
QBPCYL   DS    FL1                                                      10656000
QBPHD    DS    FL1                                                      10657000
QBPREC   DS    FL1                                                      10658000
         ORG   QBCHRF+4                                                 10659000
QPEND    DS    A                                                        10660000
MSG56B14 DS    F                                                        10661000
MS56AA14 DS    F                                                        10662000
MSG56A14 DS    F                                                        10663000
MS56CA14 DS    F                                                        10664000
MSG56C14 DS    F                                                        10665000
MSG56D14 DS    F                                                        10666000
MSG56E14 DS    F                                                        10667000
MSG56F14 DS    F                                                        10668000
PARMPTR  DS    A                                                        10669000
SVPTR    DS    A                                                        10670000
MUEND    DS    A                                                        10671000
MSG56G14 DS    F                                                        10672000
MSG56V14 DS    F                                                        10673000
SDGMPTR  DS    A                                                        10674000
MSG56H14 DS    F                                                        10675000
MSG56I14 DS    F                                                        10676000
QCMPTR   DS    A                                                        10677000
MSG56J14 DS    F                                                        10678000
MS56QU14 DS    F                                                        10679000
QUINPTR  DS    A                                                        10680000
QUSCPTR  DS    A                                                        10681000
QUNDPTR  DS    A                                                        10682000
QUALX    DS    F                                                        10683000
QUALY    DS    F                                                        10684000
SAV14SDG DS    F                                                        10685000
CPDLEN   DC    AL2(28)                                                  10686000
CWBIX    DS    H                                                        10687000
I        DS    H                                                        10688000
I2       DS    H                                                        10689000
J        DS    H                                                        10690000
K        DS    H                                                        10691000
K1       DS    H                                                        10692000
K2       DS    H                                                        10693000
K3       DS    H                                                        10694000
IEND     DS    H                                                        10695000
RETC     DS    H                                                        10696000
SDGNO    DS    H                                                        10697000
STARTI   DS    H                                                        10698000
ENDI     DS    H                                                        10699000
MSGCNT   DS    H                                                        10700000
STATI    DS    H                                                        10701000
SATST    DS    H                                                        10702000
TCYLCNT  DC    H'608'                                                   10703000
THDCNT   DC    H'32'                                                    10704000
TRNXCC   DS    H                                                        10705000
TRNXHH   DS    H                                                        10706000
TRNXRR   DS    H                                                        10707000
TRCRECS  DS    H                                                        10708000
TRCTOT   DS    H                                                        10709000
QENT     DS    H                                                        10710000
QI       DS    H                                                        10711000
QMI      DS    H                                                        10712000
MFB      DS    H                                                        10713000
MFE      DS    H                                                        10714000
M2B      DS    H                                                        10715000
M2E      DS    H                                                        10716000
QMCT     DS    H                                                        10717000
MUONDSP  DC    AL2(31)                                                  10718000
MUOFDSP  DC    AL2(29)                                                  10719000
MUSUDSP  DC    AL2(25)                                                  10720000
MUDSP    DS    H                                                        10721000
MSGIND   DS    FL1                                                      10722000
CURSTAT  DS    FL1                                                      10723000
PRVSTAT  DS    FL1                                                      10724000
         DS    0D                                                       10725000
@TS00001 DS    CL8                                                      10726000
@CC03486 DC    C'NO PATHS OFFLINE'                                      10727000
@CC03484 DC    C'NO PATHS ONLINE'                                       10728000
@CC02699 DC    C'             '                                         10729000
@CC02912 DC    C'REASON CODE '                                          10730000
@CC02909 DC    C'NOT INIT '                                             10731000
@CC02908 DC    C'UNUSABLE'                                              10732000
@CC02919 DC    C'DISABLED'                                              10733000
@CC02921 DC    C'ENABLED '                                              10734000
@CC03294 DC    C'ACTIVE  '                                              10735000
@CC03296 DC    C'INACTIVE'                                              10736000
@CC03581 DC    C'********'                                              10737000
@CC02856 DC    C'OFFLINE'                                               10738000
@CC02906 DC    C'O/     '                                               10739000
@CC03511 DC    C'/O-UNAV'                                               10740000
@CC03512 DC    C'/O     '                                               10741000
@CC03584 DC    C'OFFPEND'                                               10742000
@CC01404 EQU   @CC02699                                                 10743000
@CC02850 DC    C'/SUU  '                                                10744000
@CC02905 DC    C'ALTMSC'                                                10745000
@CC02911 DC    C'USABLE'                                                10746000
@CC03440 DC    C'/OFF  '                                                10747000
@CC03441 EQU   @CC03512                                                 10748000
@CC03446 DC    C'/O-SUU'                                                10749000
@CC02855 DC    C' */* '                                                 10750000
@CC02907 DC    C'READY'                                                 10751000
@CC03439 EQU   @CC02699                                                 10752000
@CC01402 DC    C'0000'                                                  10753000
@CC02848 DC    C'MSF-'                                                  10754000
@CC02858 DC    C'DRD-'                                                  10755000
@CC02859 DC    C'DRC-'                                                  10756000
@CC02860 DC    C'SA  '                                                  10757000
@CC03373 DC    C'NONE'                                                  10758000
@CC03435 DC    C'/   '                                                  10759000
@CC03436 DC    C'/I  '                                                  10760000
@CC03442 DC    C'-SUU'                                                  10761000
@CC03482 EQU   @CC03440                                                 10762000
@CC03582 DC    C'/BND'                                                  10763000
@CC03583 EQU   @CC02850                                                 10764000
@CC03585 DC    C'STAG'                                                  10765000
@CC03586 DC    C'/PRI'                                                  10766000
@CC03587 DC    C'/SEC'                                                  10767000
@CC03588 DC    C'/ALT'                                                  10768000
@CC03589 DC    C'/CNV'                                                  10769000
@CC03590 DC    C'REAL'                                                  10770000
@CC03591 DC    C'NEUT'                                                  10771000
@CC03592 DC    C'TEST'                                                  10772000
@CC01468 DC    C'800'                                                   10773000
@CC01484 DC    C'400'                                                   10774000
@CC01500 EQU   @CC01402                                                 10775000
@CC02854 DC    C'/1 '                                                   10776000
@CC03112 EQU   @CC02699                                                 10777000
@CC03116 DC    C'20X'                                                   10778000
@CC03117 DC    C'21X'                                                   10779000
@CC03216 DC    C'00X'                                                   10780000
@CC03217 DC    C'4XX'                                                   10781000
@CC03218 DC    C'2XX'                                                   10782000
@CC03219 DC    C'1XX'                                                   10783000
@CC03574 DC    C'SD-'                                                   10784000
@CC02853 DC    C' 2'                                                    10785000
@CC02904 EQU   @CC03486                                                 10786000
@CC03438 DC    C'-A'                                                    10787000
@CC03483 EQU   @CC03511                                                 10788000
@CB03443 DC    X'0000'                                                  10789000
NULLS    DC    X'000000000000'                                          10790000
         DS    CL2                                                      10791000
WORK     DS    CL2000                                                   10792000
QBTAB    DS    CL268                                                    10793000
         ORG   QBTAB                                                    10794000
QBCNT    DS    FL4                                                      10795000
QBENT    DS    CL44                                                     10796000
         ORG   QBENT+0                                                  10797000
QBECNT   DS    FL1                                                      10798000
QBMAP    DS    AL3                                                      10799000
QBINDX   DS    FL1                                                      10800000
QBORD    DS    CL1                                                      10801000
QBPARM   DS    CL4                                                      10802000
         ORG   QBPARM+0                                                 10803000
QBSECT   DS    CL1                                                      10804000
         ORG   QBSECT+0                                                 10805000
QBTID    DS    CL1                                                      10806000
         ORG   QBPARM+1                                                 10807000
QBFLAGS  DS    CL1                                                      10808000
QBVAR1   DS    CL1                                                      10809000
QBVAR2   DS    CL1                                                      10810000
         ORG   QBENT+10                                                 10811000
QBREC    DS    FL1                                                      10812000
@NM00017 DS    CL1                                                      10813000
QBRSV    DC    XL32'0'                                                  10814000
         ORG   QBTAB+268                                                10815000
QBTBL    DS    CL156                                                    10816000
         ORG   QBTBL                                                    10817000
QBCIX    DS    CL12                                                     10818000
         ORG   QBCIX                                                    10819000
QBCIECNT DC    AL1(1)                                                   10820000
QBCIMAD  DC    AL3(QMCIX)                                               10821000
QBCIINDX DC    AL1(1)                                                   10822000
QBCIORD  DC    X'05'                                                    10823000
QBCIPRM  DS    CL4                                                      10824000
         ORG   QBCIPRM                                                  10825000
QBCITID  DC    X'70'                                                    10826000
QBCIFLGS DC    X'01'                                                    10827000
QBCIVAR1 DC    XL1'0'                                                   10828000
QBCIVAR2 DC    XL1'0'                                                   10829000
         ORG   QBCIX+10                                                 10830000
QBCIRSV  DC    XL2'0'                                                   10831000
         ORG   QBTBL+12                                                 10832000
QBW0F    DS    CL12                                                     10833000
         ORG   QBW0F                                                    10834000
QB0FECNT DC    AL1(1)                                                   10835000
QB0FMAD  DC    AL3(QMW0F)                                               10836000
QB0FINDX DC    AL1(2)                                                   10837000
QB0FORD  DC    X'0B'                                                    10838000
QB0FPRM  DS    CL4                                                      10839000
         ORG   QB0FPRM                                                  10840000
QB0FSEC  DC    X'0F'                                                    10841000
QB0FFLGS DC    X'00'                                                    10842000
QB0FVAR1 DC    XL1'0'                                                   10843000
QB0FVAR2 DC    XL1'0'                                                   10844000
         ORG   QBW0F+10                                                 10845000
QB0FRSV  DC    XL2'0'                                                   10846000
         ORG   QBTBL+24                                                 10847000
QBCTB    DS    CL12                                                     10848000
         ORG   QBCTB                                                    10849000
QBCTECNT DC    AL1(4)                                                   10850000
QBCTMAD  DC    AL3(QMCTB)                                               10851000
QBCTINDX DC    AL1(1)                                                   10852000
QBCTORD  DC    X'05'                                                    10853000
QBCTPRM  DS    CL4                                                      10854000
         ORG   QBCTPRM                                                  10855000
QBCTTID  DC    X'70'                                                    10856000
QBCTFLGS DC    X'01'                                                    10857000
QBCTVAR1 DC    X'00'                                                    10858000
QBCTVAR2 DC    X'FF'                                                    10859000
         ORG   QBCTB+10                                                 10860000
QBCTRSV  DC    XL2'0'                                                   10861000
         ORG   QBTBL+36                                                 10862000
QBW7C    DS    CL12                                                     10863000
         ORG   QBW7C                                                    10864000
QB7CECNT DC    AL1(4)                                                   10865000
QB7CMAD  DC    AL3(QMW7C)                                               10866000
QB7CINDX DC    AL1(1)                                                   10867000
QB7CORD  DC    X'0B'                                                    10868000
QB7CPRM  DS    CL4                                                      10869000
         ORG   QB7CPRM                                                  10870000
QB7CSEC  DC    X'7C'                                                    10871000
QB7CFLGS DC    X'00'                                                    10872000
QB7CVAR1 DC    XL1'0'                                                   10873000
QB7CVAR2 DC    XL1'0'                                                   10874000
         ORG   QBW7C+10                                                 10875000
QB7CRSV  DC    XL2'0'                                                   10876000
         ORG   QBTBL+48                                                 10877000
QBW6A    DS    CL12                                                     10878000
         ORG   QBW6A                                                    10879000
QB6AECNT DC    AL1(2)                                                   10880000
QB6AMAD  DC    AL3(QMW6A)                                               10881000
QB6AINDX DC    AL1(1)                                                   10882000
QB6AORD  DC    X'0B'                                                    10883000
QB6APRM  DS    CL4                                                      10884000
         ORG   QB6APRM                                                  10885000
QB6ASEC  DC    X'6A'                                                    10886000
QB6AFLGS DC    X'00'                                                    10887000
QB6AVAR1 DC    XL1'0'                                                   10888000
QB6AVAR2 DC    XL1'0'                                                   10889000
         ORG   QBW6A+10                                                 10890000
QB6ARSV  DC    XL2'0'                                                   10891000
         ORG   QBTBL+60                                                 10892000
QBW04    DS    CL12                                                     10893000
         ORG   QBW04                                                    10894000
QB04ECNT DC    AL1(1)                                                   10895000
QB04MAD  DC    AL3(QMW04)                                               10896000
QB04INDX DC    AL1(1)                                                   10897000
QB04ORD  DC    X'0B'                                                    10898000
QB04PRM  DS    CL4                                                      10899000
         ORG   QB04PRM                                                  10900000
QB04SEC  DC    X'04'                                                    10901000
QB04FLGS DC    X'01'                                                    10902000
QB04VAR1 DC    XL1'0'                                                   10903000
QB04VAR2 DC    XL1'0'                                                   10904000
         ORG   QBW04+10                                                 10905000
QB04RSV  DC    XL2'0'                                                   10906000
         ORG   QBTBL+72                                                 10907000
QBW4C    DS    CL12                                                     10908000
         ORG   QBW4C                                                    10909000
QB4CECNT DC    AL1(1)                                                   10910000
QB4CMAD  DC    AL3(QMW4C)                                               10911000
QB4CINDX DC    AL1(2)                                                   10912000
QB4CORD  DC    X'0B'                                                    10913000
QB4CPRM  DS    CL4                                                      10914000
         ORG   QB4CPRM                                                  10915000
QB4CSEC  DC    X'4C'                                                    10916000
QB4CFLGS DC    X'01'                                                    10917000
QB4CVAR1 DC    XL1'0'                                                   10918000
QB4CVAR2 DC    XL1'0'                                                   10919000
         ORG   QBW4C+10                                                 10920000
QB4CRSV  DC    XL2'0'                                                   10921000
         ORG   QBTBL+84                                                 10922000
QBW57    DS    CL12                                                     10923000
         ORG   QBW57                                                    10924000
QB57ECNT DC    AL1(1)                                                   10925000
QB57MAD  DC    AL3(QMW57)                                               10926000
QB57INDX DC    AL1(1)                                                   10927000
QB57ORD  DC    X'0B'                                                    10928000
QB57PRM  DS    CL4                                                      10929000
         ORG   QB57PRM                                                  10930000
QB57SEC  DC    X'57'                                                    10931000
QB57FLGS DC    X'00'                                                    10932000
QB57VAR1 DC    XL1'0'                                                   10933000
QB57VAR2 DC    XL1'0'                                                   10934000
         ORG   QBW57+10                                                 10935000
QB57RSV  DC    XL2'0'                                                   10936000
         ORG   QBTBL+96                                                 10937000
QBVER1   DS    CL12                                                     10938000
         ORG   QBVER1                                                   10939000
QBV1ECNT DC    AL1(1)                                                   10940000
QBV1MAD  DC    AL3(QMVE1)                                               10941000
QBV1INDX DC    AL1(2)                                                   10942000
QBV1ORD  DC    X'05'                                                    10943000
QBV1PRM  DS    CL4                                                      10944000
         ORG   QBV1PRM                                                  10945000
QBV1TID  DC    X'F0'                                                    10946000
QBV1FLGS DC    X'11'                                                    10947000
QBV1VAR1 DC    XL1'0'                                                   10948000
QBV1VAR2 DC    XL1'0'                                                   10949000
         ORG   QBVER1+10                                                10950000
QBV1REC  DC    AL1(1)                                                   10951000
@NM00018 DC    XL1'0'                                                   10952000
         ORG   QBTBL+108                                                10953000
QBVER2   DS    CL12                                                     10954000
         ORG   QBVER2                                                   10955000
QBV2ECNT DC    AL1(1)                                                   10956000
QBV2MAD  DC    AL3(QMVE2)                                               10957000
QBV2INDX DC    AL1(1)                                                   10958000
QBV2ORD  DC    X'05'                                                    10959000
QBV2PRM  DS    CL4                                                      10960000
         ORG   QBV2PRM                                                  10961000
QBV2TID  DC    X'F0'                                                    10962000
QBV2FLGS DC    X'11'                                                    10963000
QBV2VAR1 DC    XL1'0'                                                   10964000
QBV2VAR2 DC    XL1'0'                                                   10965000
         ORG   QBVER2+10                                                10966000
QBV2REC  DC    AL1(2)                                                   10967000
@NM00019 DC    XL1'0'                                                   10968000
         ORG   QBTBL+120                                                10969000
QBVER3   DS    CL12                                                     10970000
         ORG   QBVER3                                                   10971000
QBV3ECNT DC    AL1(2)                                                   10972000
QBV3MAD  DC    AL3(QMVE3)                                               10973000
QBV3INDX DC    AL1(2)                                                   10974000
QBV3ORD  DC    X'05'                                                    10975000
QBV3PRM  DS    CL4                                                      10976000
         ORG   QBV3PRM                                                  10977000
QBV3TID  DC    X'F0'                                                    10978000
QBV3FLGS DC    X'11'                                                    10979000
QBV3VAR1 DC    XL1'0'                                                   10980000
QBV3VAR2 DC    XL1'0'                                                   10981000
         ORG   QBVER3+10                                                10982000
QBV3REC  DC    AL1(3)                                                   10983000
@NM00020 DC    XL1'0'                                                   10984000
         ORG   QBTBL+132                                                10985000
QBDSQ    DS    CL12                                                     10986000
         ORG   QBDSQ                                                    10987000
QBDSECNT DC    AL1(1)                                                   10988000
QBDSMAD  DC    AL3(QMDSQ)                                               10989000
QBDSINDX DC    AL1(2)                                                   10990000
QBDSORD  DC    X'05'                                                    10991000
QBDSPRM  DS    CL4                                                      10992000
         ORG   QBDSPRM                                                  10993000
QBDSTID  DC    X'C0'                                                    10994000
QBDSFLGS DC    X'01'                                                    10995000
QBDSVAR1 DC    X'00'                                                    10996000
QBDSVAR2 DC    X'FF'                                                    10997000
         ORG   QBDSQ+10                                                 10998000
QBDSRSV  DC    XL2'0'                                                   10999000
         ORG   QBTBL+144                                                11000000
QBCEL    DS    CL12                                                     11001000
         ORG   QBCEL                                                    11002000
QBCEECNT DC    AL1(1)                                                   11003000
QBCEMAD  DC    AL3(QMCEL)                                               11004000
QBCEINDX DC    AL1(1)                                                   11005000
QBCEORD  DC    X'07'                                                    11006000
QBCEPRM  DS    CL4                                                      11007000
         ORG   QBCEPRM                                                  11008000
QBCETID  DC    X'EA'                                                    11009000
QBCEFLGS DC    X'00'                                                    11010000
QBCEVAR1 DC    X'00'                                                    11011000
QBCEVAR2 DC    X'00'                                                    11012000
         ORG   QBCEL+10                                                 11013000
QBCERSV  DC    XL2'0'                                                   11014000
         ORG   QBTBL+156                                                11015000
QMCIX    DS    CL6                                                      11016000
         ORG   QMCIX                                                    11017000
@NM00021 DC    H'1'                                                     11018000
@NM00022 DC    H'0'                                                     11019000
         DC    H'256'                                                   11020000
         ORG   QMCIX+6                                                  11021000
QMW0F    DS    CL26                                                     11022000
         ORG   QMW0F                                                    11023000
@NM00023 DC    H'6'                                                     11024000
@NM00024 DC    H'1'                                                     11025000
         DC    H'1'                                                     11026000
         DC    H'3'                                                     11027000
         DC    H'1'                                                     11028000
         DC    H'50'                                                    11029000
         DC    H'1'                                                     11030000
         DC    H'54'                                                    11031000
         DC    H'1'                                                     11032000
         DC    H'58'                                                    11033000
         DC    H'1'                                                     11034000
         DC    H'62'                                                    11035000
         DC    H'1'                                                     11036000
         ORG   QMW0F+26                                                 11037000
QMCTB    DS    CL6                                                      11038000
         ORG   QMCTB                                                    11039000
@NM00025 DC    H'1'                                                     11040000
         DC    H'0'                                                     11041000
         DC    H'256'                                                   11042000
         ORG   QMCTB+6                                                  11043000
QMW7C    DS    CL10                                                     11044000
         ORG   QMW7C                                                    11045000
@NM00026 DC    H'2'                                                     11046000
@NM00027 DC    H'96'                                                    11047000
         DC    H'64'                                                    11048000
         DC    H'208'                                                   11049000
         DC    H'16'                                                    11050000
         ORG   QMW7C+10                                                 11051000
QMW6A    DS    CL6                                                      11052000
         ORG   QMW6A                                                    11053000
@NM00028 DC    H'1'                                                     11054000
@NM00029 DC    H'0'                                                     11055000
         DC    H'256'                                                   11056000
         ORG   QMW6A+6                                                  11057000
QMW04    DS    CL2                                                      11058000
         ORG   QMW04                                                    11059000
@NM00030 DC    H'0'                                                     11060000
         ORG   QMW04+2                                                  11061000
QMW4C    DS    CL6                                                      11062000
         ORG   QMW4C                                                    11063000
@NM00031 DC    H'1'                                                     11064000
@NM00032 DC    H'0'                                                     11065000
         DC    H'1'                                                     11066000
         ORG   QMW4C+6                                                  11067000
QMW57    DS    CL6                                                      11068000
         ORG   QMW57                                                    11069000
@NM00033 DC    H'1'                                                     11070000
@NM00034 DC    H'0'                                                     11071000
         DC    H'16'                                                    11072000
         ORG   QMW57+6                                                  11073000
QMVE1    DS    CL10                                                     11074000
         ORG   QMVE1                                                    11075000
@NM00035 DC    H'2'                                                     11076000
@NM00036 DC    H'80'                                                    11077000
         DC    H'64'                                                    11078000
         DC    H'220'                                                   11079000
         DC    H'16'                                                    11080000
         ORG   QMVE1+10                                                 11081000
QMVE2    DS    CL6                                                      11082000
         ORG   QMVE2                                                    11083000
@NM00037 DC    H'1'                                                     11084000
@NM00038 DC    H'96'                                                    11085000
         DC    H'16'                                                    11086000
         ORG   QMVE2+6                                                  11087000
QMVE3    DS    CL6                                                      11088000
         ORG   QMVE3                                                    11089000
@NM00039 DC    H'1'                                                     11090000
@NM00040 DC    H'20'                                                    11091000
         DC    H'16'                                                    11092000
         ORG   QMVE3+6                                                  11093000
QMDSQ    DS    CL6                                                      11094000
         ORG   QMDSQ                                                    11095000
@NM00041 DC    H'1'                                                     11096000
@NM00042 DC    H'0'                                                     11097000
         DC    H'256'                                                   11098000
         ORG   QMDSQ+6                                                  11099000
QMCEL    DS    CL6                                                      11100000
         ORG   QMCEL                                                    11101000
@NM00043 DC    H'1'                                                     11102000
@NM00044 DC    H'34'                                                    11103000
         DC    H'1'                                                     11104000
         ORG   QMCEL+6                                                  11105000
TABPARM  DS    CL20                                                     11106000
         ORG   TABPARM                                                  11107000
TABID    DC    X'10'                                                    11108000
TABRD    DC    X'01'                                                    11109000
TABSECT  DC    X'08'                                                    11110000
TABSDG   DS    FL1                                                      11111000
TABFIL   DC    XL16'0'                                                  11112000
         ORG   TABPARM+20                                               11113000
MAP      DC    XL32'0'                                                  11114000
CMPSSID1 DS    CL3                                                      11115000
CMPSSID2 DS    CL3                                                      11116000
SAVTYP   DS    CL5                                                      11117000
         ORG   SAVTYP                                                   11118000
SAVTYP13 DS    CL3                                                      11119000
SAVTYP45 DS    CL2                                                      11120000
         ORG   SAVTYP+5                                                 11121000
PRITP    DS    CL3                                                      11122000
SECTP    DS    CL3                                                      11123000
CONE     DC    X'01'                                                    11124000
FLAGS    DS    BL1                                                      11125000
         ORG   FLAGS                                                    11126000
ERRFLG   DS    BL1                                                      11127000
VALSSID  EQU   FLAGS+0                                                  11128000
VALFLG   EQU   FLAGS+0                                                  11129000
FLIPSW   EQU   FLAGS+0                                                  11130000
VALCODE  EQU   FLAGS+0                                                  11131000
ENDSW    EQU   FLAGS+0                                                  11132000
NEWVUA   EQU   FLAGS+0                                                  11133000
STORER   EQU   FLAGS+0                                                  11134000
         ORG   FLAGS+1                                                  11135000
REQFLG   DS    BL1                                                      11136000
         ORG   REQFLG                                                   11137000
SDGFLG   DS    BL1                                                      11138000
MSFFLG   EQU   REQFLG+0                                                 11139000
DRDFLG   EQU   REQFLG+0                                                 11140000
DRCFLG   EQU   REQFLG+0                                                 11141000
SAFLG    EQU   REQFLG+0                                                 11142000
@NM00078 EQU   REQFLG+0                                                 11143000
         ORG   REQFLG+1                                                 11144000
         DS    CL2                                                      11145000
TMESTAMP DS    CL4                                                      11146000
         DS    CL4                                                      11147000
TIMEFLD  DS    CL8                                                      11148000
         ORG   TIMEFLD                                                  11149000
@NM00079 DS    CL1                                                      11150000
HH       DS    CL2                                                      11151000
MM       DS    CL2                                                      11152000
SS       DS    CL2                                                      11153000
@NM00080 DS    CL1                                                      11154000
         ORG   TIMEFLD+8                                                11155000
MSGTIME  DS    CL8                                                      11156000
         ORG   MSGTIME                                                  11157000
HRS      DS    CL2                                                      11158000
PER1     DC    CL1'.'                                                   11159000
MINS     DS    CL2                                                      11160000
PER2     DC    CL1'.'                                                   11161000
SECS     DS    CL2                                                      11162000
         ORG   MSGTIME+8                                                11163000
REQBIT   DS    BL40                                                     11164000
OFFMASK  DS    BL40                                                     11165000
MSG01FIL DC    CL30'INSUFFICIENT STORAGE'                               11166000
PTCHAREA DS    CL400                                                    11167000
         ORG   PTCHAREA                                                 11168000
@NM00088 DC    CL256'ICBMSG56 PATCH AREA'                               11169000
         DC    CL144' '                                                 11170000
         ORG   PTCHAREA+400                                             11171000
TRANS    DS    CL256                                                    11172000
         ORG   TRANS                                                    11173000
FILL1    DC    CL193' '                                                 11174000
ALPHAS   DC    X'FAFBFCFDFEFF'                                          11175000
FILL2    DC    CL41' '                                                  11176000
NUMBRS   DC    CL16'0123456789ABCDEF'                                   11177000
         ORG   TRANS+256                                                11178000
         DS    CL2                                                      11179000
CURSTR   DS    CL12                                                     11180000
         ORG   CURSTR                                                   11181000
@NM00114 DS    BL1                                                      11182000
ONLPTR   DS    AL3                                                      11183000
@NM00115 DS    BL1                                                      11184000
OFFPTR   DS    AL3                                                      11185000
@NM00116 DS    BL1                                                      11186000
SUUPTR   DS    AL3                                                      11187000
         ORG   CURSTR+12                                                11188000
         DS    CL4                                                      11189000
PTHWK    DS    CL12                                                     11190000
         ORG   PTHWK                                                    11191000
PCHAN    DS    FL4                                                      11192000
         ORG   PCHAN                                                    11193000
@NM00119 DS    CL3                                                      11194000
PCHANCX  DS    CL1                                                      11195000
         ORG   PCHANCX                                                  11196000
BITWK1   DS    BL1                                                      11197000
         ORG   PTHWK+4                                                  11198000
PCNTL    DS    FL4                                                      11199000
         ORG   PCNTL                                                    11200000
@NM00120 DS    CL3                                                      11201000
PCNTLCX  DS    CL1                                                      11202000
         ORG   PCNTLCX                                                  11203000
BITWK2   DS    BL1                                                      11204000
         ORG   PTHWK+8                                                  11205000
PUNIT    DS    FL4                                                      11206000
         ORG   PUNIT                                                    11207000
@NM00121 DS    CL1                                                      11208000
PUNIT3   DS    CL3                                                      11209000
         ORG   PUNIT3                                                   11210000
@NM00122 DS    CL1                                                      11211000
PUNITCY  DS    CL2                                                      11212000
         ORG   PUNITCY                                                  11213000
PUNITCX  DS    CL1                                                      11214000
         ORG   PUNITCX                                                  11215000
BITWK3   DS    BL1                                                      11216000
         ORG   PTHWK+12                                                 11217000
CURRCPUW DS    CL11                                                     11218000
         ORG   CURRCPUW                                                 11219000
CPXIDC   DS    CL6                                                      11220000
CPXMODC1 DS    CL5                                                      11221000
         ORG   CPXMODC1                                                 11222000
CPXMODC  DS    CL4                                                      11223000
         ORG   CURRCPUW+11                                              11224000
CURCPUP  DS    CL5                                                      11225000
COMPAREA DS    CL6                                                      11226000
         ORG   COMPAREA                                                 11227000
CMPCPUX  DS    CL6                                                      11228000
         ORG   CMPCPUX                                                  11229000
CMPCPU   DS    CL5                                                      11230000
         ORG   COMPAREA+6                                               11231000
VUA00    DC    X'000000'                                                11232000
VUA3F    DC    X'00030F'                                                11233000
LZYXCALC DS    CL8                                                      11234000
         ORG   LZYXCALC                                                 11235000
LCALC    DS    FL2                                                      11236000
         ORG   LCALC                                                    11237000
LCALCC   DS    CL2                                                      11238000
         ORG   LCALCC                                                   11239000
@NM00134 DS    CL1                                                      11240000
LCALCC2  DS    CL1                                                      11241000
         ORG   LCALCC2                                                  11242000
@NM00135 DS    BL1                                                      11243000
LCALCB7  EQU   LCALCC2+0                                                11244000
         ORG   LZYXCALC+2                                               11245000
ZCALC    DS    FL2                                                      11246000
         ORG   ZCALC                                                    11247000
ZCALCC   DS    CL2                                                      11248000
         ORG   ZCALCC                                                   11249000
@NM00136 DS    CL1                                                      11250000
ZCALCC2  DS    CL1                                                      11251000
         ORG   LZYXCALC+4                                               11252000
YCALC    DS    FL2                                                      11253000
         ORG   YCALC                                                    11254000
YCALCC   DS    CL2                                                      11255000
         ORG   YCALCC                                                   11256000
@NM00137 DS    CL1                                                      11257000
YCALCC2  DS    CL1                                                      11258000
         ORG   LZYXCALC+6                                               11259000
XCALC    DS    FL2                                                      11260000
         ORG   XCALC                                                    11261000
XCALCC   DS    CL2                                                      11262000
         ORG   XCALCC                                                   11263000
@NM00138 DS    CL1                                                      11264000
XCALCC2  DS    CL1                                                      11265000
         ORG   LZYXCALC+8                                               11266000
TRCCALC  DS    CL22                                                     11267000
         ORG   TRCCALC                                                  11268000
TRNXC    DS    FL2                                                      11269000
TRNXH    DS    FL2                                                      11270000
TRNXR    DS    FL2                                                      11271000
TRCTREC  DS    FL2                                                      11272000
TRCTHDS  DS    FL2                                                      11273000
TRCTCYL  DS    FL2                                                      11274000
TRCUREC  DS    FL2                                                      11275000
TRCUHDS  DS    FL2                                                      11276000
TRCUCYL  DS    FL2                                                      11277000
TRCUSE   DS    FL2                                                      11278000
TRCPCT   DS    FL2                                                      11279000
         ORG   TRCCALC+22                                               11280000
TRCWORK  DS    CL3                                                      11281000
         ORG   TRCWORK                                                  11282000
TRCWORKA DS    CL1                                                      11283000
TRCWORKB DS    CL2                                                      11284000
         ORG   TRCWORK+3                                                11285000
CZEROS   DC    CL3'000'                                                 11286000
QBPRMAR  DS    CL36                                                     11287000
         ORG   QBPRMAR                                                  11288000
QBPSUB   DS    CL4                                                      11289000
         ORG   QBPSUB                                                   11290000
QBPTID   DS    FL1                                                      11291000
QBPTRD   DS    CL1                                                      11292000
QBPTVAR1 DS    CL1                                                      11293000
QBPTVAR2 DS    FL1                                                      11294000
         ORG   QBPRMAR+4                                                11295000
QBPTFIL  DC    XL16'0'                                                  11296000
QBPCHR   DS    CL4                                                      11297000
@NM00154 DC    XL8'0'                                                   11298000
QBPBUF   DS    AL4                                                      11299000
         ORG   QBPRMAR+36                                               11300000
QBPORD   DS    CL1                                                      11301000
MSTAT    DS    CL6                                                      11302000
STDEF    DS    CL7                                                      11303000
QCNMSG   DC    CL26'THERE ARE NO QCBS IN ERROR'                         11304000
SBPOL    DS    CL1                                                      11305000
SSIDS    DC    CL3'200'                                                 11306000
         DC    CL3'201'                                                 11307000
         DC    CL3'202'                                                 11308000
         DC    CL3'203'                                                 11309000
         DC    CL3'204'                                                 11310000
         DC    CL3'205'                                                 11311000
         DC    CL3'206'                                                 11312000
         DC    CL3'207'                                                 11313000
         DC    CL3'210'                                                 11314000
         DC    CL3'211'                                                 11315000
         DC    CL3'212'                                                 11316000
         DC    CL3'213'                                                 11317000
         DC    CL3'214'                                                 11318000
         DC    CL3'215'                                                 11319000
         DC    CL3'216'                                                 11320000
         DC    CL3'217'                                                 11321000
         DC    CL3'220'                                                 11322000
         DC    CL3'221'                                                 11323000
         DC    CL3'222'                                                 11324000
         DC    CL3'223'                                                 11325000
         DC    CL3'224'                                                 11326000
         DC    CL3'225'                                                 11327000
         DC    CL3'226'                                                 11328000
         DC    CL3'227'                                                 11329000
         DC    CL3'230'                                                 11330000
         DC    CL3'231'                                                 11331000
         DC    CL3'232'                                                 11332000
         DC    CL3'233'                                                 11333000
         DC    CL3'234'                                                 11334000
         DC    CL3'235'                                                 11335000
         DC    CL3'236'                                                 11336000
         DC    CL3'237'                                                 11337000
         DC    CL3'800'                                                 11338000
         DC    CL3'810'                                                 11339000
         DC    CL3'820'                                                 11340000
         DC    CL3'830'                                                 11341000
         DC    CL3'840'                                                 11342000
         DC    CL3'850'                                                 11343000
         DC    CL3'860'                                                 11344000
         DC    CL3'870'                                                 11345000
         DC    CL3'880'                                                 11346000
         DC    CL3'890'                                                 11347000
         DC    CL3'8A0'                                                 11348000
         DC    CL3'8B0'                                                 11349000
         DC    CL3'8C0'                                                 11350000
         DC    CL3'8D0'                                                 11351000
         DC    CL3'8E0'                                                 11352000
         DC    CL3'8F0'                                                 11353000
         DC    CL3'400'                                                 11354000
         DC    CL3'401'                                                 11355000
         DC    CL3'402'                                                 11356000
         DC    CL3'403'                                                 11357000
         DC    CL3'410'                                                 11358000
         DC    CL3'411'                                                 11359000
         DC    CL3'412'                                                 11360000
         DC    CL3'413'                                                 11361000
         DC    CL3'420'                                                 11362000
         DC    CL3'421'                                                 11363000
         DC    CL3'422'                                                 11364000
         DC    CL3'423'                                                 11365000
         DC    CL3'430'                                                 11366000
         DC    CL3'431'                                                 11367000
         DC    CL3'432'                                                 11368000
         DC    CL3'433'                                                 11369000
         DC    CL3'000'                                                 11370000
         DC    CL3'001'                                                 11371000
         DC    CL3'002'                                                 11372000
         DC    CL3'003'                                                 11373000
         DC    CL3'004'                                                 11374000
         DC    CL3'005'                                                 11375000
         DC    CL3'006'                                                 11376000
         DC    CL3'007'                                                 11377000
         DC    CL3'008'                                                 11378000
         DC    CL3'009'                                                 11379000
         DC    CL3'00A'                                                 11380000
         DC    CL3'00B'                                                 11381000
         DC    CL3'00C'                                                 11382000
         DC    CL3'00D'                                                 11383000
         DC    CL3'00E'                                                 11384000
         DC    CL3'00F'                                                 11385000
         DC    CL3'010'                                                 11386000
         DC    CL3'011'                                                 11387000
         DC    CL3'012'                                                 11388000
         DC    CL3'013'                                                 11389000
         DC    CL3'014'                                                 11390000
         DC    CL3'015'                                                 11391000
         DC    CL3'016'                                                 11392000
         DC    CL3'017'                                                 11393000
         DC    CL3'018'                                                 11394000
         DC    CL3'019'                                                 11395000
         DC    CL3'01A'                                                 11396000
         DC    CL3'01B'                                                 11397000
         DC    CL3'01C'                                                 11398000
         DC    CL3'01D'                                                 11399000
         DC    CL3'01E'                                                 11400000
         DC    CL3'01F'                                                 11401000
         DC    CL3'020'                                                 11402000
         DC    CL3'021'                                                 11403000
         DC    CL3'022'                                                 11404000
         DC    CL3'023'                                                 11405000
         DC    CL3'024'                                                 11406000
         DC    CL3'025'                                                 11407000
         DC    CL3'026'                                                 11408000
         DC    CL3'027'                                                 11409000
         DC    CL3'028'                                                 11410000
         DC    CL3'029'                                                 11411000
         DC    CL3'02A'                                                 11412000
         DC    CL3'02B'                                                 11413000
         DC    CL3'02C'                                                 11414000
         DC    CL3'02D'                                                 11415000
         DC    CL3'02E'                                                 11416000
         DC    CL3'02F'                                                 11417000
         DC    CL3'030'                                                 11418000
         DC    CL3'031'                                                 11419000
         DC    CL3'032'                                                 11420000
         DC    CL3'033'                                                 11421000
         DC    CL3'034'                                                 11422000
         DC    CL3'035'                                                 11423000
         DC    CL3'036'                                                 11424000
         DC    CL3'037'                                                 11425000
         DC    CL3'038'                                                 11426000
         DC    CL3'039'                                                 11427000
         DC    CL3'03A'                                                 11428000
         DC    CL3'03B'                                                 11429000
         DC    CL3'03C'                                                 11430000
         DC    CL3'03D'                                                 11431000
         DC    CL3'03E'                                                 11432000
         DC    CL3'03F'                                                 11433000
         DC    CL3'040'                                                 11434000
         DC    CL3'041'                                                 11435000
         DC    CL3'042'                                                 11436000
         DC    CL3'043'                                                 11437000
         DC    CL3'044'                                                 11438000
         DC    CL3'045'                                                 11439000
         DC    CL3'046'                                                 11440000
         DC    CL3'047'                                                 11441000
         DC    CL3'048'                                                 11442000
         DC    CL3'049'                                                 11443000
         DC    CL3'04A'                                                 11444000
         DC    CL3'04B'                                                 11445000
         DC    CL3'04C'                                                 11446000
         DC    CL3'04D'                                                 11447000
         DC    CL3'04E'                                                 11448000
         DC    CL3'04F'                                                 11449000
         DC    CL3'050'                                                 11450000
         DC    CL3'051'                                                 11451000
         DC    CL3'052'                                                 11452000
         DC    CL3'053'                                                 11453000
         DC    CL3'054'                                                 11454000
         DC    CL3'055'                                                 11455000
         DC    CL3'056'                                                 11456000
         DC    CL3'057'                                                 11457000
         DC    CL3'058'                                                 11458000
         DC    CL3'059'                                                 11459000
         DC    CL3'05A'                                                 11460000
         DC    CL3'05B'                                                 11461000
         DC    CL3'05C'                                                 11462000
         DC    CL3'05D'                                                 11463000
         DC    CL3'05E'                                                 11464000
         DC    CL3'05F'                                                 11465000
         DC    CL3'060'                                                 11466000
         DC    CL3'061'                                                 11467000
         DC    CL3'062'                                                 11468000
         DC    CL3'063'                                                 11469000
         DC    CL3'064'                                                 11470000
         DC    CL3'065'                                                 11471000
         DC    CL3'066'                                                 11472000
         DC    CL3'067'                                                 11473000
         DC    CL3'068'                                                 11474000
         DC    CL3'069'                                                 11475000
         DC    CL3'06A'                                                 11476000
         DC    CL3'06B'                                                 11477000
         DC    CL3'06C'                                                 11478000
         DC    CL3'06D'                                                 11479000
         DC    CL3'06E'                                                 11480000
         DC    CL3'06F'                                                 11481000
         DC    CL3'070'                                                 11482000
         DC    CL3'071'                                                 11483000
         DC    CL3'072'                                                 11484000
         DC    CL3'073'                                                 11485000
         DC    CL3'074'                                                 11486000
         DC    CL3'075'                                                 11487000
         DC    CL3'076'                                                 11488000
         DC    CL3'077'                                                 11489000
         DC    CL3'078'                                                 11490000
         DC    CL3'079'                                                 11491000
         DC    CL3'07A'                                                 11492000
         DC    CL3'07B'                                                 11493000
         DC    CL3'07C'                                                 11494000
         DC    CL3'07D'                                                 11495000
         DC    CL3'07E'                                                 11496000
         DC    CL3'07F'                                                 11497000
         DC    CL3'080'                                                 11498000
         DC    CL3'081'                                                 11499000
         DC    CL3'082'                                                 11500000
         DC    CL3'083'                                                 11501000
         DC    CL3'084'                                                 11502000
         DC    CL3'085'                                                 11503000
         DC    CL3'086'                                                 11504000
         DC    CL3'087'                                                 11505000
         DC    CL3'088'                                                 11506000
         DC    CL3'089'                                                 11507000
         DC    CL3'08A'                                                 11508000
         DC    CL3'08B'                                                 11509000
         DC    CL3'08C'                                                 11510000
         DC    CL3'08D'                                                 11511000
         DC    CL3'08E'                                                 11512000
         DC    CL3'08F'                                                 11513000
         DC    CL3'090'                                                 11514000
         DC    CL3'091'                                                 11515000
         DC    CL3'092'                                                 11516000
         DC    CL3'093'                                                 11517000
         DC    CL3'094'                                                 11518000
         DC    CL3'095'                                                 11519000
         DC    CL3'096'                                                 11520000
         DC    CL3'097'                                                 11521000
         DC    CL3'098'                                                 11522000
         DC    CL3'099'                                                 11523000
         DC    CL3'09A'                                                 11524000
         DC    CL3'09B'                                                 11525000
         DC    CL3'09C'                                                 11526000
         DC    CL3'09D'                                                 11527000
         DC    CL3'09E'                                                 11528000
         DC    CL3'09F'                                                 11529000
         DC    CL3'0A0'                                                 11530000
         DC    CL3'0A1'                                                 11531000
         DC    CL3'0A2'                                                 11532000
         DC    CL3'0A3'                                                 11533000
         DC    CL3'0A4'                                                 11534000
         DC    CL3'0A5'                                                 11535000
         DC    CL3'0A6'                                                 11536000
         DC    CL3'0A7'                                                 11537000
         DC    CL3'0A8'                                                 11538000
         DC    CL3'0A9'                                                 11539000
         DC    CL3'0AA'                                                 11540000
         DC    CL3'0AB'                                                 11541000
         DC    CL3'0AC'                                                 11542000
         DC    CL3'0AD'                                                 11543000
         DC    CL3'0AE'                                                 11544000
         DC    CL3'0AF'                                                 11545000
         DC    CL3'0B0'                                                 11546000
         DC    CL3'0B1'                                                 11547000
         DC    CL3'0B2'                                                 11548000
         DC    CL3'0B3'                                                 11549000
         DC    CL3'0B4'                                                 11550000
         DC    CL3'0B5'                                                 11551000
         DC    CL3'0B6'                                                 11552000
         DC    CL3'0B7'                                                 11553000
         DC    CL3'0B8'                                                 11554000
         DC    CL3'0B9'                                                 11555000
         DC    CL3'0BA'                                                 11556000
         DC    CL3'0BB'                                                 11557000
         DC    CL3'0BC'                                                 11558000
         DC    CL3'0BD'                                                 11559000
         DC    CL3'0BE'                                                 11560000
         DC    CL3'0BF'                                                 11561000
         DC    CL3'0C0'                                                 11562000
         DC    CL3'0C1'                                                 11563000
         DC    CL3'0C2'                                                 11564000
         DC    CL3'0C3'                                                 11565000
         DC    CL3'0C4'                                                 11566000
         DC    CL3'0C5'                                                 11567000
         DC    CL3'0C6'                                                 11568000
         DC    CL3'0C7'                                                 11569000
         DC    CL3'0C8'                                                 11570000
         DC    CL3'0C9'                                                 11571000
         DC    CL3'0CA'                                                 11572000
         DC    CL3'0CB'                                                 11573000
         DC    CL3'0CC'                                                 11574000
         DC    CL3'0CD'                                                 11575000
         DC    CL3'0CE'                                                 11576000
         DC    CL3'0CF'                                                 11577000
         DC    CL3'0D0'                                                 11578000
         DC    CL3'0D1'                                                 11579000
         DC    CL3'0D2'                                                 11580000
         DC    CL3'0D3'                                                 11581000
         DC    CL3'0D4'                                                 11582000
         DC    CL3'0D5'                                                 11583000
         DC    CL3'0D6'                                                 11584000
         DC    CL3'0D7'                                                 11585000
         DC    CL3'0D8'                                                 11586000
         DC    CL3'0D9'                                                 11587000
         DC    CL3'0DA'                                                 11588000
         DC    CL3'0DB'                                                 11589000
         DC    CL3'0DC'                                                 11590000
         DC    CL3'0DD'                                                 11591000
         DC    CL3'0DE'                                                 11592000
         DC    CL3'0DF'                                                 11593000
         DC    CL3'0E0'                                                 11594000
         DC    CL3'0E1'                                                 11595000
         DC    CL3'0E2'                                                 11596000
         DC    CL3'0E3'                                                 11597000
         DC    CL3'0E4'                                                 11598000
         DC    CL3'0E5'                                                 11599000
         DC    CL3'0E6'                                                 11600000
         DC    CL3'0E7'                                                 11601000
         DC    CL3'0E8'                                                 11602000
         DC    CL3'0E9'                                                 11603000
         DC    CL3'0EA'                                                 11604000
         DC    CL3'0EB'                                                 11605000
         DC    CL3'0EC'                                                 11606000
         DC    CL3'0ED'                                                 11607000
         DC    CL3'0EE'                                                 11608000
         DC    CL3'0EF'                                                 11609000
         DC    CL3'FFF'                                                 11610000
         DC    CL3'FFF'                                                 11611000
         DC    CL3'FFF'                                                 11612000
         DC    CL3'FFF'                                                 11613000
         DC    CL3'FFF'                                                 11614000
         DC    CL3'FFF'                                                 11615000
         DC    CL3'FFF'                                                 11616000
         DC    CL3'FFF'                                                 11617000
         DC    CL3'102'                                                 11618000
         DC    CL3'101'                                                 11619000
         DC    CL3'112'                                                 11620000
         DC    CL3'111'                                                 11621000
         DC    CL3'122'                                                 11622000
         DC    CL3'121'                                                 11623000
         DC    CL3'132'                                                 11624000
         DC    CL3'131'                                                 11625000
         DS    CL3                                                      11626000
QAPTR    DS    28A                                                      11627000
GMTAB    DS    64F                                                      11628000
QUAL     DS    CL11                                                     11629000
         ORG   QUAL+0                                                   11630000
QUAL10   DS    CL10                                                     11631000
         ORG   QUAL10+0                                                 11632000
QUAL7    DS    CL7                                                      11633000
         ORG   QUAL7+0                                                  11634000
QUAL3    DS    CL3                                                      11635000
         ORG   QUAL3+0                                                  11636000
QUAL2    DS    CL2                                                      11637000
         ORG   QUAL2+0                                                  11638000
QUAL1    DS    CL1                                                      11639000
         ORG   QUAL+22                                                  11640000
QUALLEN  DS    2H                                                       11641000
         DS    CL2                                                      11642000
MSGS     DS    CL76                                                     11643000
         ORG   MSGS+0                                                   11644000
@NM00087 DS    CL1                                                      11645000
MCDE     DS    CL2                                                      11646000
         ORG   MCDE+0                                                   11647000
MESGCODE DC    XL1'80'                                                  11648000
MESGLINE DC    XL1'01'                                                  11649000
         ORG   MSGS+3                                                   11650000
MESGLEN  DC    AL1(47)                                                  11651000
MESGS    DS    CL72                                                     11652000
         ORG   MESGS+0                                                  11653000
MESGID   DC    CL10'  ICB080I '                                         11654000
MESGTXT  DC    CL62'- CARTRIDGE ENTERED MSF*, XYZ XXXYYZ '              11655000
         ORG   MSGS+76                                                  11656000
         ORG   MSGS+76                                                  11657000
         DS    CL1                                                      11658000
         ORG   MCDE+76                                                  11659000
         DC    XL1'81'                                                  11660000
         DC    XL1'01'                                                  11661000
         ORG   MSGS+79                                                  11662000
         DC    AL1(68)                                                  11663000
         ORG   MESGS+76                                                 11664000
         DC    CL10'  ICB081I '                                         11665000
         DC    CL62'- ************ ENTERED AS UNASSIGNED CSN MSF*, XYZ C11666000
               XXXYYZ '                                                 11667000
         ORG   MSGS+152                                                 11668000
         ORG   MSGS+152                                                 11669000
         DS    CL1                                                      11670000
         ORG   MCDE+152                                                 11671000
         DC    XL1'82'                                                  11672000
         DC    XL1'01'                                                  11673000
         ORG   MSGS+155                                                 11674000
         DC    AL1(71)                                                  11675000
         ORG   MESGS+152                                                11676000
         DC    CL10'  ICB082I '                                         11677000
         DC    CL62'- ****** ENTERED AS CE VOL MSF*, XYZ XXXYYZ,CSN=***C11678000
               ********* '                                              11679000
         ORG   MSGS+228                                                 11680000
         ORG   MSGS+228                                                 11681000
         DS    CL1                                                      11682000
         ORG   MCDE+228                                                 11683000
         DC    XL1'83'                                                  11684000
         DC    XL1'01'                                                  11685000
         ORG   MSGS+231                                                 11686000
         DC    AL1(72)                                                  11687000
         ORG   MESGS+228                                                11688000
         DC    CL10'  ICB083I '                                         11689000
         DC    CL62' VOLID ******, CSN(*)************ ENTERED IN MSF * C11690000
               LOC ******,'                                             11691000
         ORG   MSGS+304                                                 11692000
         ORG   MSGS+304                                                 11693000
         DS    CL1                                                      11694000
         ORG   MCDE+304                                                 11695000
         DC    XL1'83'                                                  11696000
         DC    XL1'02'                                                  11697000
         ORG   MSGS+307                                                 11698000
         DC    AL1(56)                                                  11699000
         ORG   MESGS+304                                                11700000
         DC    CL10'  ICB083I '                                         11701000
         DC    CL62' VOLID ******, CSN(*)************ **** IN MSF.'     11702000
         ORG   MSGS+380                                                 11703000
         ORG   MSGS+380                                                 11704000
         DS    CL1                                                      11705000
         ORG   MCDE+380                                                 11706000
         DC    XL1'84'                                                  11707000
         DC    XL1'01'                                                  11708000
         ORG   MSGS+383                                                 11709000
         DC    AL1(30)                                                  11710000
         ORG   MESGS+380                                                11711000
         DC    CL10'  ICB084I '                                         11712000
         DC    CL62'- MSC TRACE STARTED '                               11713000
         ORG   MSGS+456                                                 11714000
         ORG   MSGS+456                                                 11715000
         DS    CL1                                                      11716000
         ORG   MCDE+456                                                 11717000
         DC    XL1'85'                                                  11718000
         DC    XL1'01'                                                  11719000
         ORG   MSGS+459                                                 11720000
         DC    AL1(38)                                                  11721000
         ORG   MESGS+456                                                11722000
         DC    CL10'  ICB085I '                                         11723000
         DC    CL62'- MSC TRACE * NOW RECORDING '                       11724000
         ORG   MSGS+532                                                 11725000
         ORG   MSGS+532                                                 11726000
         DS    CL1                                                      11727000
         ORG   MCDE+532                                                 11728000
         DC    XL1'86'                                                  11729000
         DC    XL1'01'                                                  11730000
         ORG   MSGS+535                                                 11731000
         DC    AL1(30)                                                  11732000
         ORG   MESGS+532                                                11733000
         DC    CL10'  ICB086I '                                         11734000
         DC    CL62'- MSC TRACE * ENDED '                               11735000
         ORG   MSGS+608                                                 11736000
         ORG   MSGS+608                                                 11737000
         DS    CL1                                                      11738000
         ORG   MCDE+608                                                 11739000
         DC    XL1'93'                                                  11740000
         DC    XL1'01'                                                  11741000
         ORG   MSGS+611                                                 11742000
         DC    AL1(58)                                                  11743000
         ORG   MESGS+608                                                11744000
         DC    CL10'  ICB093I '                                         11745000
         DC    CL62'- PACK CHANGE INTERRUPT ON SSID XXX, STATUS YYY '   11746000
         ORG   MSGS+684                                                 11747000
         ORG   MSGS+684                                                 11748000
         DS    CL1                                                      11749000
         ORG   MCDE+684                                                 11750000
         DC    XL1'8F'                                                  11751000
         DC    XL1'01'                                                  11752000
         ORG   MSGS+687                                                 11753000
         DC    AL1(48)                                                  11754000
         ORG   MESGS+684                                                11755000
         DC    CL10'  ICB100I '                                         11756000
         DC    CL62'- VOLUME ****** NOW AVAILABLE FOR USE '             11757000
         ORG   MSGS+760                                                 11758000
         ORG   MSGS+760                                                 11759000
         DS    CL1                                                      11760000
         ORG   MCDE+760                                                 11761000
         DC    XL1'95'                                                  11762000
         DC    XL1'01'                                                  11763000
         ORG   MSGS+763                                                 11764000
         DC    AL1(56)                                                  11765000
         ORG   MESGS+760                                                11766000
         DC    CL10'  ICB095A '                                         11767000
         DC    CL62'- MSS DASD I/O ERROR ON SSID AAA, BBBB '            11768000
         ORG   MSGS+836                                                 11769000
         ORG   MSGS+836                                                 11770000
         DS    CL1                                                      11771000
         ORG   MCDE+836                                                 11772000
         DC    XL1'96'                                                  11773000
         DC    XL1'01'                                                  11774000
         ORG   MSGS+839                                                 11775000
         DC    AL1(65)                                                  11776000
         ORG   MESGS+836                                                11777000
         DC    CL10'  ICB096D '                                         11778000
         DC    CL62'- MSS AAAAAAA ERROR, RP BB ON SSID CCC MARKED UNUSAC11779000
               BLE '                                                    11780000
         ORG   MSGS+912                                                 11781000
         ORG   MSGS+912                                                 11782000
         DS    CL1                                                      11783000
         ORG   MCDE+912                                                 11784000
         DC    XL1'96'                                                  11785000
         DC    XL1'02'                                                  11786000
         ORG   MSGS+915                                                 11787000
         DC    AL1(63)                                                  11788000
         ORG   MESGS+912                                                11789000
         DC    CL10'  ICB096D '                                         11790000
         DC    CL62'- (CONT''D) VIRT CYL XXX, REAL CYL YYY, VOLID ZZZZZC11791000
               Z '                                                      11792000
         ORG   MSGS+988                                                 11793000
         ORG   MSGS+988                                                 11794000
         DS    CL1                                                      11795000
         ORG   MCDE+988                                                 11796000
         DC    XL1'97'                                                  11797000
         DC    XL1'01'                                                  11798000
         ORG   MSGS+991                                                 11799000
         DC    AL1(47)                                                  11800000
         ORG   MESGS+988                                                11801000
         DC    CL10'  ICB097I '                                         11802000
         DC    CL62'- MSC SSID RECONFIGURE DDD,EEE,AA,BB '              11803000
         ORG   MSGS+1064                                                11804000
         ORG   MSGS+1064                                                11805000
         DS    CL1                                                      11806000
         ORG   MCDE+1064                                                11807000
         DC    XL1'98'                                                  11808000
         DC    XL1'01'                                                  11809000
         ORG   MSGS+1067                                                11810000
         DC    AL1(64)                                                  11811000
         ORG   MESGS+1064                                               11812000
         DC    CL10'  ICB098I '                                         11813000
         DC    CL62'- MSC DATA REUSE OVERRIDE VVVVVV,DDD,AA,BB,CCCCCCCCC11814000
               CC '                                                     11815000
         ORG   MSGS+1140                                                11816000
         ORG   MSGS+1140                                                11817000
         DS    CL1                                                      11818000
         ORG   MCDE+1140                                                11819000
         DC    XL1'9A'                                                  11820000
         DC    XL1'01'                                                  11821000
         ORG   MSGS+1143                                                11822000
         DC    AL1(67)                                                  11823000
         ORG   MESGS+1140                                               11824000
         DC    CL10'  ICB101I '                                         11825000
         DC    CL62'- MSS UNIDENTIFIABLE PACK CHANGE INTERRUPT SA X, UNC11826000
               IT YY '                                                  11827000
         ORG   MSGS+1216                                                11828000
         ORG   MSGS+1216                                                11829000
         DS    CL1                                                      11830000
         ORG   MCDE+1216                                                11831000
         DC    XL1'56'                                                  11832000
         DC    XL1'01'                                                  11833000
         ORG   MSGS+1219                                                11834000
         DC    AL1(59)                                                  11835000
         ORG   MESGS+1216                                               11836000
         DC    CL10'  ICB056I '                                         11837000
         DC    CL62'DISPLAY 3850 FAILED - INITIALIZE REASON CODE AAA '  11838000
         ORG   MSGS+1292                                                11839000
         ORG   MSGS+1292                                                11840000
         DS    CL1                                                      11841000
         ORG   MCDE+1292                                                11842000
         DC    XL1'56'                                                  11843000
         DC    XL1'02'                                                  11844000
         ORG   MSGS+1295                                                11845000
         DC    AL1(30)                                                  11846000
         ORG   MESGS+1292                                               11847000
         DC    CL10'  ICB056I '                                         11848000
         DC    CL62'HH.MM.SS MSC  STATUS'                               11849000
         ORG   MSGS+1368                                                11850000
         ORG   MSGS+1368                                                11851000
         DS    CL1                                                      11852000
         ORG   MCDE+1368                                                11853000
         DC    XL1'56'                                                  11854000
         DC    XL1'03'                                                  11855000
         ORG   MSGS+1371                                                11856000
         DC    AL1(30)                                                  11857000
         ORG   MESGS+1368                                               11858000
         DC    CL10'  ICB056I '                                         11859000
         DC    CL62'HH.MM.SS SSID STATUS'                               11860000
         ORG   MSGS+1444                                                11861000
         ORG   MSGS+1444                                                11862000
         DS    CL1                                                      11863000
         ORG   MCDE+1444                                                11864000
         DC    XL1'56'                                                  11865000
         DC    XL1'04'                                                  11866000
         ORG   MSGS+1447                                                11867000
         DC    AL1(64)                                                  11868000
         ORG   MESGS+1444                                               11869000
         DC    CL10'  ICB056I '                                         11870000
         DC    CL62'3850 STATUS - NO VALID SSIDS FOUND'                 11871000
         ORG   MSGS+1520                                                11872000
         ORG   MSGS+1520                                                11873000
         DS    CL1                                                      11874000
         ORG   MCDE+1520                                                11875000
         DC    XL1'56'                                                  11876000
         DC    XL1'05'                                                  11877000
         ORG   MSGS+1523                                                11878000
         DC    AL1(70)                                                  11879000
         ORG   MESGS+1520                                               11880000
         DC    CL10'SSID TYPE '                                         11881000
         DC    CL62' STATUS  USE      CONFIG SSID TYPE  STATUS  USE    C11882000
                 CONFIG '                                               11883000
         ORG   MSGS+1596                                                11884000
         ORG   MSGS+1596                                                11885000
         DS    CL1                                                      11886000
         ORG   MCDE+1596                                                11887000
         DC    XL1'56'                                                  11888000
         DC    XL1'06'                                                  11889000
         ORG   MSGS+1599                                                11890000
         DC    AL1(72)                                                  11891000
         ORG   MESGS+1596                                               11892000
         DC    CL10'          '                                         11893000
         DC    CL62'                                                   C11894000
                          '                                             11895000
         ORG   MSGS+1672                                                11896000
         ORG   MSGS+1672                                                11897000
         DS    CL1                                                      11898000
         ORG   MCDE+1672                                                11899000
         DC    XL1'56'                                                  11900000
         DC    XL1'07'                                                  11901000
         ORG   MSGS+1675                                                11902000
         DC    AL1(54)                                                  11903000
         ORG   MESGS+1672                                               11904000
         DC    CL10'          '                                         11905000
         DC    CL62'PRI MSC AAA -  ONLINE, ALT MSC BBB -  ONLINE'       11906000
         ORG   MSGS+1748                                                11907000
         ORG   MSGS+1748                                                11908000
         DS    CL1                                                      11909000
         ORG   MCDE+1748                                                11910000
         DC    XL1'94'                                                  11911000
         DC    XL1'01'                                                  11912000
         ORG   MSGS+1751                                                11913000
         DC    AL1(69)                                                  11914000
         ORG   MESGS+1748                                               11915000
         DC    CL10'  ICB194E '                                         11916000
         DC    CL62'MSS VOLUME ****** CART * UNAVAILABLE - MSC RESTART C11917000
               CODE ** '                                                11918000
         ORG   MSGS+1824                                                11919000
         ORG   MSGS+1824                                                11920000
         DS    CL1                                                      11921000
         ORG   MCDE+1824                                                11922000
         DC    XL1'99'                                                  11923000
         DC    XL1'01'                                                  11924000
         ORG   MSGS+1827                                                11925000
         DC    AL1(72)                                                  11926000
         ORG   MESGS+1824                                               11927000
         DC    CL10'  ICB099I '                                         11928000
         DC    CL62'MSS INVALID PATCH SSID AAA,ADDR BBBB,VER CCCCCCCC,CC11929000
               UR DDDDDDDD'                                             11930000
         ORG   MSGS+1900                                                11931000
         ORG   MSGS+1900                                                11932000
         DS    CL1                                                      11933000
         ORG   MCDE+1900                                                11934000
         DC    XL1'00'                                                  11935000
         DC    XL1'01'                                                  11936000
         ORG   MSGS+1903                                                11937000
         DC    AL1(28)                                                  11938000
         ORG   MESGS+1900                                               11939000
         DC    CL10'  ICB010I '                                         11940000
         DC    CL62'****** *********** '                                11941000
         ORG   MSGS+1976                                                11942000
         ORG   MSGS+1976                                                11943000
         DS    CL1                                                      11944000
         ORG   MCDE+1976                                                11945000
         DC    XL1'00'                                                  11946000
         DC    XL1'01'                                                  11947000
         ORG   MSGS+1979                                                11948000
         DC    AL1(55)                                                  11949000
         ORG   MESGS+1976                                               11950000
         DC    CL10'  ICB012I '                                         11951000
         DC    CL62'MSS INOPERATIVE. READY FAILED, REAS CODE=XXX '      11952000
         ORG   MSGS+2052                                                11953000
         ORG   MSGS+2052                                                11954000
         DS    CL1                                                      11955000
         ORG   MCDE+2052                                                11956000
         DC    XL1'00'                                                  11957000
         DC    XL1'01'                                                  11958000
         ORG   MSGS+2055                                                11959000
         DC    AL1(51)                                                  11960000
         ORG   MESGS+2052                                               11961000
         DC    CL10'  ICB013I '                                         11962000
         DC    CL62'- VARY SNNN OFF *********** POST CODE=XX '          11963000
         ORG   MSGS+2128                                                11964000
         ORG   MSGS+2128                                                11965000
         DS    CL1                                                      11966000
         ORG   MCDE+2128                                                11967000
         DC    XL1'00'                                                  11968000
         DC    XL1'01'                                                  11969000
         ORG   MSGS+2131                                                11970000
         DC    AL1(36)                                                  11971000
         ORG   MESGS+2128                                               11972000
         DC    CL10'  ICB014I '                                         11973000
         DC    CL62'3850 TYPE COMMAND INVALID '                         11974000
         ORG   MSGS+2204                                                11975000
         ORG   MSGS+2204                                                11976000
         DS    CL1                                                      11977000
         ORG   MCDE+2204                                                11978000
         DC    XL1'00'                                                  11979000
         DC    XL1'01'                                                  11980000
         ORG   MSGS+2207                                                11981000
         DC    AL1(39)                                                  11982000
         ORG   MESGS+2204                                               11983000
         DC    CL10'  ICB090I '                                         11984000
         DC    CL62'- SNNN EXISTS BUT IS OFFLINE '                      11985000
         ORG   MSGS+2280                                                11986000
         ORG   MSGS+2280                                                11987000
         DS    CL1                                                      11988000
         ORG   MCDE+2280                                                11989000
         DC    XL1'00'                                                  11990000
         DC    XL1'01'                                                  11991000
         ORG   MSGS+2283                                                11992000
         DC    AL1(45)                                                  11993000
         ORG   MESGS+2280                                               11994000
         DC    CL10'  ICB092E '                                         11995000
         DC    CL62'- SNNN IS ONLINE BUT NOT AVAILABLE '                11996000
         ORG   MSGS+2356                                                11997000
         ORG   MSGS+2356                                                11998000
         DS    CL1                                                      11999000
         ORG   MCDE+2356                                                12000000
         DC    XL1'00'                                                  12001000
         DC    XL1'01'                                                  12002000
         ORG   MSGS+2359                                                12003000
         DC    AL1(64)                                                  12004000
         ORG   MESGS+2356                                               12005000
         DC    CL10'  ICB094I '                                         12006000
         DC    CL62'MSC PRIMARY TABLE PACK IS ON SCUU,SECONDARY IS ON SC12007000
               CUU'                                                     12008000
         ORG   MSGS+2432                                                12009000
         ORG   MSGS+2432                                                12010000
         DS    CL1                                                      12011000
         ORG   MCDE+2432                                                12012000
         DC    XL1'00'                                                  12013000
         DC    XL1'01'                                                  12014000
         ORG   MSGS+2435                                                12015000
         DC    AL1(28)                                                  12016000
         ORG   MESGS+2432                                               12017000
         DC    CL10'  ICB302I '                                         12018000
         DC    CL62' SNNN NOW ***LINE '                                 12019000
         ORG   MSGS+2508                                                12020000
         ORG   MSGS+2508                                                12021000
         DS    CL1                                                      12022000
         ORG   MCDE+2508                                                12023000
         DC    XL1'00'                                                  12024000
         DC    XL1'01'                                                  12025000
         ORG   MSGS+2511                                                12026000
         DC    AL1(32)                                                  12027000
         ORG   MESGS+2508                                               12028000
         DC    CL10'  ICB303I '                                         12029000
         DC    CL62' SNNN ALREADY ***LINE '                             12030000
         ORG   MSGS+2584                                                12031000
         ORG   MSGS+2584                                                12032000
         DS    CL1                                                      12033000
         ORG   MCDE+2584                                                12034000
         DC    XL1'00'                                                  12035000
         DC    XL1'01'                                                  12036000
         ORG   MSGS+2587                                                12037000
         DC    AL1(49)                                                  12038000
         ORG   MESGS+2584                                               12039000
         DC    CL10'  ICB311I '                                         12040000
         DC    CL62' VARY SNNN ***LINE FAILED,REAS CODE=XXX'            12041000
         ORG   MSGS+2660                                                12042000
         ORG   MSGS+2660                                                12043000
         DS    CL1                                                      12044000
         ORG   MCDE+2660                                                12045000
         DC    XL1'00'                                                  12046000
         DC    XL1'01'                                                  12047000
         ORG   MSGS+2663                                                12048000
         DC    AL1(42)                                                  12049000
         ORG   MESGS+2660                                               12050000
         DC    CL10'  ICB314I '                                         12051000
         DC    CL62' SYNTAX ERROR IN HALT S COMMAND '                   12052000
         ORG   MSGS+2736                                                12053000
         ORG   MSGS+2736                                                12054000
         DS    CL1                                                      12055000
         ORG   MCDE+2736                                                12056000
         DC    XL1'00'                                                  12057000
         DC    XL1'01'                                                  12058000
         ORG   MSGS+2739                                                12059000
         DC    AL1(42)                                                  12060000
         ORG   MESGS+2736                                               12061000
         DC    CL10'  ICB315I '                                         12062000
         DC    CL62' SYNTAX ERROR IN VARY S COMMAND '                   12063000
         ORG   MSGS+2812                                                12064000
         ORG   MSGS+2812                                                12065000
         DS    CL1                                                      12066000
         ORG   MCDE+2812                                                12067000
         DC    XL1'00'                                                  12068000
         DC    XL1'01'                                                  12069000
         ORG   MSGS+2815                                                12070000
         DC    AL1(59)                                                  12071000
         ORG   MESGS+2812                                               12072000
         DC    CL10'  ICB316I '                                         12073000
         DC    CL62'HOSTID MISSING IN PURGE COMMAND, COMMAND REJECTED'  12074000
         ORG   MSGS+2888                                                12075000
         ORG   MSGS+2888                                                12076000
         DS    CL1                                                      12077000
         ORG   MCDE+2888                                                12078000
         DC    XL1'00'                                                  12079000
         DC    XL1'01'                                                  12080000
         ORG   MSGS+2891                                                12081000
         DC    AL1(62)                                                  12082000
         ORG   MESGS+2888                                               12083000
         DC    CL10'  ICB985I '                                         12084000
         DC    CL62'NO 3850. GETMAIN FAILURE DURING MSSC INITIALIZATIONC12085000
                '                                                       12086000
         ORG   MSGS+2964                                                12087000
         ORG   MSGS+2964                                                12088000
         DS    CL1                                                      12089000
         ORG   MCDE+2964                                                12090000
         DC    XL1'00'                                                  12091000
         DC    XL1'01'                                                  12092000
         ORG   MSGS+2967                                                12093000
         DC    AL1(56)                                                  12094000
         ORG   MESGS+2964                                               12095000
         DC    CL10'  ICB987I '                                         12096000
         DC    CL62'GETMAIN FAILURE. NO MSS CONFIGURATION MESSAGES'     12097000
         ORG   MSGS+3040                                                12098000
         ORG   MSGS+3040                                                12099000
         DS    CL1                                                      12100000
         ORG   MCDE+3040                                                12101000
         DC    XL1'00'                                                  12102000
         DC    XL1'01'                                                  12103000
         ORG   MSGS+3043                                                12104000
         DC    AL1(55)                                                  12105000
         ORG   MESGS+3040                                               12106000
         DC    CL10'  ICB533I '                                         12107000
         DC    CL62'MSS INOPERATIVE. ICBMSG05 LOAD FAILED, ABEND CODE=XC12108000
               XX'                                                      12109000
         ORG   MSGS+3116                                                12110000
         ORG   MSGS+3116                                                12111000
         DS    CL1                                                      12112000
         ORG   MCDE+3116                                                12113000
         DC    XL1'9C'                                                  12114000
         DC    XL1'01'                                                  12115000
         ORG   MSGS+3119                                                12116000
         DC    AL1(65)                                                  12117000
         ORG   MESGS+3116                                               12118000
         DC    CL10'  ICB102E '                                         12119000
         DC    CL62'FFFFFFFFFFFF,SS                                    C12120000
                  '                                                     12121000
         ORG   MSGS+3192                                                12122000
         ORG   MSGS+3192                                                12123000
         DS    CL1                                                      12124000
         ORG   MCDE+3192                                                12125000
         DC    XL1'9C'                                                  12126000
         DC    XL1'02'                                                  12127000
         ORG   MSGS+3195                                                12128000
         DC    AL1(62)                                                  12129000
         ORG   MESGS+3192                                               12130000
         DC    CL10'  ICB102E '                                         12131000
         DC    CL62'                                                   C12132000
                 '                                                      12133000
         ORG   MSGS+3268                                                12134000
         ORG   MSGS+3268                                                12135000
         DS    CL1                                                      12136000
         ORG   MCDE+3268                                                12137000
         DC    XL1'56'                                                  12138000
         DC    XL1'01'                                                  12139000
         ORG   MSGS+3271                                                12140000
         DC    AL1(34)                                                  12141000
         ORG   MESGS+3268                                               12142000
         DC    CL10'  ICB056I '                                         12143000
         DC    CL62'HH.MM.SS CPU PATH STATUS'                           12144000
         ORG   MSGS+3344                                                12145000
         ORG   MSGS+3344                                                12146000
         DS    CL1                                                      12147000
         ORG   MCDE+3344                                                12148000
         DC    XL1'56'                                                  12149000
         DC    XL1'02'                                                  12150000
         ORG   MSGS+3347                                                12151000
         DC    AL1(66)                                                  12152000
         ORG   MESGS+3344                                               12153000
         DC    CL10'CPUID/STAT'                                         12154000
         DC    CL62'US   CH INT SA/STATUS  SDG  UNIT ADDRESS(VIRTUAL)/SC12155000
               TATUS'                                                   12156000
         ORG   MSGS+3420                                                12157000
         ORG   MSGS+3420                                                12158000
         DS    CL1                                                      12159000
         ORG   MCDE+3420                                                12160000
         DC    XL1'56'                                                  12161000
         DC    XL1'01'                                                  12162000
         ORG   MSGS+3423                                                12163000
         DC    AL1(34)                                                  12164000
         ORG   MESGS+3420                                               12165000
         DC    CL10'  ICB056I '                                         12166000
         DC    CL62'HH.MM.SS SDG PATH STATUS'                           12167000
         ORG   MSGS+3496                                                12168000
         ORG   MSGS+3496                                                12169000
         DS    CL1                                                      12170000
         ORG   MCDE+3496                                                12171000
         DC    XL1'56'                                                  12172000
         DC    XL1'02'                                                  12173000
         ORG   MSGS+3499                                                12174000
         DC    AL1(64)                                                  12175000
         ORG   MESGS+3496                                               12176000
         DC    CL10'SDG SA/STA'                                         12177000
         DC    CL62'TUS DRC/STATUS            SDG SA/STATUS DRC/STATUS C12178000
                 '                                                      12179000
         ORG   MSGS+3572                                                12180000
         ORG   MSGS+3572                                                12181000
         DS    CL1                                                      12182000
         ORG   MCDE+3572                                                12183000
         DC    XL1'56'                                                  12184000
         DC    XL1'01'                                                  12185000
         ORG   MSGS+3575                                                12186000
         DC    AL1(34)                                                  12187000
         ORG   MESGS+3572                                               12188000
         DC    CL10'  ICB056I '                                         12189000
         DC    CL62'HH.MM.SS DRC PATH STATUS'                           12190000
         ORG   MSGS+3648                                                12191000
         ORG   MSGS+3648                                                12192000
         DS    CL1                                                      12193000
         ORG   MCDE+3648                                                12194000
         DC    XL1'56'                                                  12195000
         DC    XL1'02'                                                  12196000
         ORG   MSGS+3651                                                12197000
         DC    AL1(66)                                                  12198000
         ORG   MESGS+3648                                               12199000
         DC    CL10'SA        '                                         12200000
         DC    CL62' DRC         DRD-00      DRD-01      DRD-10      DRC12201000
               D-11'                                                    12202000
         ORG   MSGS+3724                                                12203000
         ORG   MSGS+3724                                                12204000
         DS    CL1                                                      12205000
         ORG   MCDE+3724                                                12206000
         DC    XL1'56'                                                  12207000
         DC    XL1'01'                                                  12208000
         ORG   MSGS+3727                                                12209000
         DC    AL1(33)                                                  12210000
         ORG   MESGS+3724                                               12211000
         DC    CL10'  ICB056I '                                         12212000
         DC    CL62'HH.MM.SS ERR QCB STATUS'                            12213000
         ORG   MSGS+3800                                                12214000
         ORG   MSGS+3800                                                12215000
         DS    CL1                                                      12216000
         ORG   MCDE+3800                                                12217000
         DC    XL1'56'                                                  12218000
         DC    XL1'02'                                                  12219000
         ORG   MSGS+3803                                                12220000
         DC    AL1(68)                                                  12221000
         ORG   MESGS+3800                                               12222000
         DC    CL10'QCB SDG CA'                                         12223000
         DC    CL62'RT/SSID L XXX YY Z RSTT  QCB SDG CART/SSID L XXX YYC12224000
                Z RSTT'                                                 12225000
         ORG   MSGS+3876                                                12226000
         ORG   MSGS+3876                                                12227000
         DS    CL1                                                      12228000
         ORG   MCDE+3876                                                12229000
         DC    XL1'56'                                                  12230000
         DC    XL1'01'                                                  12231000
         ORG   MSGS+3879                                                12232000
         DC    AL1(30)                                                  12233000
         ORG   MESGS+3876                                               12234000
         DC    CL10'  ICB056I '                                         12235000
         DC    CL62'HH.MM.SS MSVC STATUS'                               12236000
         ORG   MSGS+3952                                                12237000
         ORG   MSGS+3952                                                12238000
         DS    CL1                                                      12239000
         ORG   MCDE+3952                                                12240000
         DC    XL1'56'                                                  12241000
         DC    XL1'02'                                                  12242000
         ORG   MSGS+3955                                                12243000
         DC    AL1(31)                                                  12244000
         ORG   MESGS+3952                                               12245000
         DC    CL10'MSVI XXXXX'                                         12246000
         DC    CL62'XX , JOURNAL XXXXXXXX'                              12247000
         ORG   MSGS+4028                                                12248000
         ORG   MSGS+4028                                                12249000
         DS    CL1                                                      12250000
         ORG   MCDE+4028                                                12251000
         DC    XL1'56'                                                  12252000
         DC    XL1'01'                                                  12253000
         ORG   MSGS+4031                                                12254000
         DC    AL1(31)                                                  12255000
         ORG   MESGS+4028                                               12256000
         DC    CL10'  ICB056I '                                         12257000
         DC    CL62'HH.MM.SS TRACE STATUS'                              12258000
         ORG   MSGS+4104                                                12259000
         ORG   MSGS+4104                                                12260000
         DS    CL1                                                      12261000
         ORG   MCDE+4104                                                12262000
         DC    XL1'56'                                                  12263000
         DC    XL1'02'                                                  12264000
         ORG   MSGS+4107                                                12265000
         DC    AL1(34)                                                  12266000
         ORG   MESGS+4104                                               12267000
         DC    CL10'TRACE INAC'                                         12268000
         DC    CL62'TIVE - AREA X - XX% FULL'                           12269000
         ORG   MSGS+4180                                                12270000
         ORG   MSGS+4180                                                12271000
         DS    CL1                                                      12272000
         ORG   MCDE+4180                                                12273000
         DC    XL1'56'                                                  12274000
         DC    XL1'01'                                                  12275000
         ORG   MSGS+4183                                                12276000
         DC    AL1(36)                                                  12277000
         ORG   MESGS+4180                                               12278000
         DC    CL10'  ICB056I '                                         12279000
         DC    CL62'HH.MM.SS STATUS OF ALT MSC'                         12280000
         ORG   MSGS+4256                                                12281000
         ORG   MSGS+4256                                                12282000
         DS    CL1                                                      12283000
         ORG   MCDE+4256                                                12284000
         DC    XL1'56'                                                  12285000
         DC    XL1'02'                                                  12286000
         ORG   MSGS+4259                                                12287000
         DC    AL1(52)                                                  12288000
         ORG   MESGS+4256                                               12289000
         DC    CL10'ALT MSC XX'                                         12290000
         DC    CL62'X IS                                      '         12291000
         ORG   MSGS+4332                                                12292000
MSG04FIL DC    CL30'CPU XXXXXXXXXX FOUND'                               12293000
         DC    CL30'SSID XXX FOUND'                                     12294000
         DC    CL30'SSIDS (XXX-XXX) FOUND'                              12295000
         DC    CL30'SSIDS IN SDG XX FOUND'                              12296000
         DC    CL30'DRC SSID 4XX FOUND'                                 12297000
LZYXCP   DS    4CL2                                                     12298000
LZYXCU   DS    4CL4                                                     12299000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       12300000
@01      EQU   01                                                       12301000
@02      EQU   02                                                       12302000
@03      EQU   03                                                       12303000
@04      EQU   04                                                       12304000
@05      EQU   05                                                       12305000
@06      EQU   06                                                       12306000
@07      EQU   07                                                       12307000
@08      EQU   08                                                       12308000
@09      EQU   09                                                       12309000
@10      EQU   10                                                       12310000
@11      EQU   11                                                       12311000
@12      EQU   12                                                       12312000
@13      EQU   13                                                       12313000
@14      EQU   14                                                       12314000
@15      EQU   15                                                       12315000
R0       EQU   @00                                                      12316000
R1       EQU   @01                                                      12317000
R2       EQU   @02                                                      12318000
R3       EQU   @03                                                      12319000
R14      EQU   @14                                                      12320000
R15      EQU   @15                                                      12321000
GPR01P   EQU   @01                                                      12322000
QUERR1   EQU   @01                                                      12323000
         ENTRY MSGS                                                     12324000
         ENTRY SSIDS                                                    12325000
         EXTRN CWBPTR                                                   12326000
         EXTRN UCBPTR                                                   12327000
         EXTRN MSGPTR                                                   12328000
         EXTRN BITSW                                                    12329000
         EXTRN INTER                                                    12330000
         EXTRN CMDQUE                                                   12331000
         EXTRN CONFGMSK                                                 12332000
         EXTRN RECOVER                                                  12333000
         EXTRN SAVR1446                                                 12334000
         EXTRN SAVR1482                                                 12335000
         EXTRN CMDPTR                                                   12336000
CVTPTR   EQU   16                                                       12337000
CWB      EQU   0                                                        12338000
CWBFREE  EQU   CWB+4                                                    12339000
CWBSBPOL EQU   CWBFREE                                                  12340000
CWBCMND  EQU   CWB+9                                                    12341000
CWBCOMQ  EQU   CWB+135                                                  12342000
CWBUCMID EQU   CWB+136                                                  12343000
CWBLCC   EQU   CWB+139                                                  12344000
CWBLA    EQU   CWB+140                                                  12345000
CWBRESV  EQU   CWB+141                                                  12346000
WPLRF    EQU   0                                                        12347000
WPLRPTR  EQU   WPLRF                                                    12348000
WPL      EQU   0                                                        12349000
WPLLGH   EQU   WPL                                                      12350000
WPLMCSF  EQU   WPL+2                                                    12351000
WPLMCSF1 EQU   WPLMCSF                                                  12352000
WPLMCSFA EQU   WPLMCSF1                                                 12353000
WPLMCSFB EQU   WPLMCSF1                                                 12354000
WPLMCSFC EQU   WPLMCSF1                                                 12355000
WPLMCSF2 EQU   WPLMCSF+1                                                12356000
WPLMCSFJ EQU   WPLMCSF2                                                 12357000
WPLTXT   EQU   WPL+4                                                    12358000
WPLFLGS  EQU   0                                                        12359000
WPLDESC  EQU   WPLFLGS                                                  12360000
WPLDESC1 EQU   WPLDESC                                                  12361000
WPLDESCE EQU   WPLDESC1                                                 12362000
WPLDESCH EQU   WPLDESC1                                                 12363000
WPLDESC2 EQU   WPLDESC+1                                                12364000
WPLDESCI EQU   WPLDESC2                                                 12365000
WPLROUT  EQU   WPLFLGS+2                                                12366000
WPLROUT1 EQU   WPLROUT                                                  12367000
WPLROUTB EQU   WPLROUT1                                                 12368000
WPLROUT2 EQU   WPLROUT+1                                                12369000
WPLMSGTY EQU   WPLFLGS+4                                                12370000
WPLMSGT1 EQU   WPLMSGTY                                                 12371000
WPLMSGT2 EQU   WPLMSGTY+1                                               12372000
WPLLS01  EQU   0                                                        12373000
WPLLTF   EQU   WPLLS01                                                  12374000
WPLLTF1  EQU   WPLLTF                                                   12375000
WPLLTFA  EQU   WPLLTF1                                                  12376000
WPLLTFC  EQU   WPLLTF1                                                  12377000
WPLAREA  EQU   WPLLS01+2                                                12378000
WPLLINES EQU   WPLLS01+3                                                12379000
WPLML    EQU   0                                                        12380000
WPLML0   EQU   WPLML                                                    12381000
WPLMLLEN EQU   WPLML+1                                                  12382000
WPLMLLTF EQU   WPLML+2                                                  12383000
WPLMLLT1 EQU   WPLMLLTF                                                 12384000
WPLMLLTC EQU   WPLMLLT1                                                 12385000
WPLMLLTD EQU   WPLMLLT1                                                 12386000
WPLMLTXT EQU   WPLML+4                                                  12387000
VVICB    EQU   0                                                        12388000
VVIFLGA  EQU   VVICB+15                                                 12389000
VVIFLG0  EQU   VVIFLGA                                                  12390000
VVIFLG1  EQU   VVIFLGA                                                  12391000
VVIFLG2  EQU   VVIFLGA                                                  12392000
VVIUCB   EQU   VVICB+60                                                 12393000
CVTMAP   EQU   0                                                        12394000
CVTDAR   EQU   CVTMAP+72                                                12395000
CVTFLGS1 EQU   CVTDAR                                                   12396000
CVTDCB   EQU   CVTMAP+116                                               12397000
CVTIOQET EQU   CVTMAP+120                                               12398000
CVTIERLC EQU   CVTMAP+144                                               12399000
CVTHEAD  EQU   CVTMAP+160                                               12400000
CVTSV76C EQU   CVTHEAD                                                  12401000
CVTOPTA  EQU   CVTMAP+182                                               12402000
CVTOPTB  EQU   CVTMAP+183                                               12403000
CVTGTF   EQU   CVTMAP+236                                               12404000
CVTGTFST EQU   CVTGTF                                                   12405000
CVTGTFS  EQU   CVTGTFST                                                 12406000
CVTSTATE EQU   CVTGTFST                                                 12407000
CVTTMODE EQU   CVTGTFST                                                 12408000
CVTFORM  EQU   CVTGTFST                                                 12409000
CVTAQAVT EQU   CVTMAP+240                                               12410000
CVTTCMFG EQU   CVTAQAVT                                                 12411000
CVTVOLM2 EQU   CVTMAP+244                                               12412000
CVTTATA  EQU   CVTVOLM2                                                 12413000
CVTTSKS  EQU   CVTTATA                                                  12414000
CVTVOLF2 EQU   CVTTSKS                                                  12415000
CVTTAT   EQU   CVTTATA+1                                                12416000
CVTATER  EQU   CVTMAP+248                                               12417000
CVTEXT1  EQU   CVTMAP+252                                               12418000
CVTPURG  EQU   CVTMAP+260                                               12419000
CVTQMSG  EQU   CVTMAP+268                                               12420000
CVTDMSR  EQU   CVTMAP+272                                               12421000
CVTRSV37 EQU   CVTDMSR                                                  12422000
CVTDMSRF EQU   CVTRSV37                                                 12423000
CVTERPV  EQU   CVTMAP+316                                               12424000
CVTINTLA EQU   CVTMAP+320                                               12425000
CVTAPF   EQU   CVTMAP+324                                               12426000
CVTEXT2  EQU   CVTMAP+328                                               12427000
CVTHJES  EQU   CVTMAP+332                                               12428000
CVTPGSIA EQU   CVTMAP+348                                               12429000
CVTA1F1  EQU   CVTMAP+356                                               12430000
CVTSYSK  EQU   CVTMAP+357                                               12431000
CVTVOLM1 EQU   CVTMAP+380                                               12432000
CVTVOLF1 EQU   CVTVOLM1                                                 12433000
CVTATMCT EQU   CVTMAP+388                                               12434000
CVTXTNT1 EQU   0                                                        12435000
CVTXTNT2 EQU   0                                                        12436000
CVTDSSV  EQU   CVTXTNT2                                                 12437000
CVTFLGBT EQU   CVTXTNT2+5                                               12438000
CVTQID   EQU   CVTXTNT2+24                                              12439000
CVTICB   EQU   CVTXTNT2+48                                              12440000
CVTRV400 EQU   CVTXTNT2+52                                              12441000
CVTRV409 EQU   CVTXTNT2+53                                              12442000
CVTATCVT EQU   CVTXTNT2+64                                              12443000
CVTRV429 EQU   CVTXTNT2+84                                              12444000
CVTRV438 EQU   CVTXTNT2+85                                              12445000
CVTRV457 EQU   CVTXTNT2+112                                             12446000
CVTRV466 EQU   CVTXTNT2+113                                             12447000
CVTFIX   EQU   0                                                        12448000
CVTRELNO EQU   CVTFIX+252                                               12449000
ICB2SSCB EQU   0                                                        12450000
ICBPUCB  EQU   ICB2SSCB+28                                              12451000
ICBAUCB  EQU   ICB2SSCB+32                                              12452000
ICBOPT   EQU   ICB2SSCB+48                                              12453000
ICBFLG   EQU   ICB2SSCB+52                                              12454000
ICBFG1   EQU   ICBFLG                                                   12455000
ICBVVICB EQU   ICB2SSCB+76                                              12456000
ICBTRACE EQU   ICB2SSCB+148                                             12457000
UCB      EQU   0                                                        12458000
UCBOB    EQU   0                                                        12459000
UCBJBNR  EQU   UCBOB                                                    12460000
UCBFL5   EQU   UCBOB+1                                                  12461000
UCBAF    EQU   UCBFL5                                                   12462000
UCBSTAT  EQU   UCBOB+3                                                  12463000
UCBONLI  EQU   UCBSTAT                                                  12464000
UCBCHAN  EQU   UCBOB+4                                                  12465000
UCBSFLS  EQU   UCBOB+6                                                  12466000
UCBFLA   EQU   UCBSFLS                                                  12467000
UCBFL1   EQU   UCBFLA                                                   12468000
UCBBSY   EQU   UCBFL1                                                   12469000
UCBNRY   EQU   UCBFL1                                                   12470000
UCBNOTRD EQU   UCBNRY                                                   12471000
UCBPST   EQU   UCBFL1                                                   12472000
UCBCUB   EQU   UCBFL1                                                   12473000
UCBFLB   EQU   UCBSFLS+1                                                12474000
UCBCHM   EQU   UCBOB+8                                                  12475000
UCBCHM1  EQU   UCBCHM                                                   12476000
UCBPTH0  EQU   UCBCHM1                                                  12477000
UCBPTH1  EQU   UCBCHM1                                                  12478000
UCBWGT   EQU   UCBOB+12                                                 12479000
UCBNAME  EQU   UCBOB+13                                                 12480000
UCBTYP   EQU   UCBOB+16                                                 12481000
UCBTBYT1 EQU   UCBTYP                                                   12482000
UCB1FEA5 EQU   UCBTBYT1                                                 12483000
UCB1FEA6 EQU   UCBTBYT1                                                 12484000
UCBTBYT2 EQU   UCBTYP+1                                                 12485000
UCB2OPT2 EQU   UCBTBYT2                                                 12486000
UCBDUDN1 EQU   UCB2OPT2                                                 12487000
UCB2OPT3 EQU   UCBTBYT2                                                 12488000
UCBDUDN2 EQU   UCB2OPT3                                                 12489000
UCB2OPT4 EQU   UCBTBYT2                                                 12490000
UCBRWTAU EQU   UCB2OPT4                                                 12491000
UCB2OPT6 EQU   UCBTBYT2                                                 12492000
UCB2OPT7 EQU   UCBTBYT2                                                 12493000
UCBTBYT3 EQU   UCBTYP+2                                                 12494000
UCBDVCLS EQU   UCBTBYT3                                                 12495000
UCBTBYT4 EQU   UCBTYP+3                                                 12496000
UCBEXTPT EQU   UCBOB+20                                                 12497000
UCBFLC   EQU   UCBEXTPT                                                 12498000
UCBDEV   EQU   UCBOB+24                                                 12499000
UCBCMEXT EQU   0                                                        12500000
UCBATI   EQU   UCBCMEXT+3                                               12501000
@NM00008 EQU   UCBATI                                                   12502000
UCBFLP1  EQU   UCBCMEXT+5                                               12503000
UCBMT    EQU   0                                                        12504000
UCBOCR   EQU   0                                                        12505000
UCB3540X EQU   0                                                        12506000
UCBDKBYT EQU   UCB3540X+6                                               12507000
UCBUCS   EQU   0                                                        12508000
UCBUCSOP EQU   UCBUCS+4                                                 12509000
UCBFCBOP EQU   UCBUCS+5                                                 12510000
GMENT    EQU   0                                                        12511000
GMLEN    EQU   GMENT                                                    12512000
GMSUB    EQU   GMLEN                                                    12513000
GMADR    EQU   GMENT+4                                                  12514000
CPHTAB   EQU   0                                                        12515000
CPHENT   EQU   0                                                        12516000
CPHID    EQU   CPHENT                                                   12517000
CPHPTI   EQU   CPHENT+5                                                 12518000
CPHPTA   EQU   CPHENT+6                                                 12519000
CPHFLGS  EQU   CPHENT+7                                                 12520000
CPHVALID EQU   CPHFLGS                                                  12521000
CPHFASC  EQU   CPHFLGS                                                  12522000
CPHINTF  EQU   CPHFLGS                                                  12523000
CPHALTP  EQU   CPHFLGS                                                  12524000
CPHALTF1 EQU   CPHALTP                                                  12525000
CPHALTF2 EQU   CPHALTP                                                  12526000
CPHSTAT  EQU   CPHENT+8                                                 12527000
CPHIN    EQU   CPHSTAT                                                  12528000
CPHPRI   EQU   CPHSTAT                                                  12529000
CPHASC   EQU   CPHSTAT                                                  12530000
CPHFPOT  EQU   CPHSTAT                                                  12531000
CPHFALT  EQU   CPHSTAT                                                  12532000
CPHMBUF  EQU   CPHSTAT                                                  12533000
CPHMSOF  EQU   CPHSTAT                                                  12534000
CPHDET   EQU   CPHENT+9                                                 12535000
CPHMSAD  EQU   CPHENT+12                                                12536000
CPHCH    EQU   CPHMSAD                                                  12537000
CPHINT   EQU   CPHENT+15                                                12538000
CPDTAB   EQU   0                                                        12539000
CPDET    EQU   0                                                        12540000
CPDSAAD  EQU   CPDET                                                    12541000
CPDSAST  EQU   CPDET+3                                                  12542000
CPDSAOF  EQU   CPDSAST                                                  12543000
CPDSARDY EQU   CPDSAST                                                  12544000
CPDSAVAL EQU   CPDSAST                                                  12545000
CPDVUA   EQU   CPDSAST                                                  12546000
CPDCHN   EQU   CPDET+4                                                  12547000
CHNPTRS  EQU   CPDET+8                                                  12548000
CPDFLGS  EQU   CHNPTRS                                                  12549000
CPDFLG1  EQU   CPDFLGS                                                  12550000
CPDONL   EQU   CHNPTRS+1                                                12551000
CPDOFF   EQU   CHNPTRS+4                                                12552000
CPDSUU   EQU   CHNPTRS+8                                                12553000
CPDINT   EQU   CPDET+20                                                 12554000
CPDCH    EQU   CPDET+21                                                 12555000
CPDSDG1  EQU   CPDET+22                                                 12556000
CPDSDG12 EQU   CPDSDG1+1                                                12557000
CPDSDG2  EQU   CPDET+24                                                 12558000
CPDSDG22 EQU   CPDSDG2+1                                                12559000
VUATAB   EQU   0                                                        12560000
VUACNT   EQU   VUATAB                                                   12561000
VUACHN   EQU   VUATAB+1                                                 12562000
VUALST   EQU   VUATAB+4                                                 12563000
VUAA     EQU   VUALST                                                   12564000
VUAB     EQU   VUALST+3                                                 12565000
SDGENT   EQU   0                                                        12566000
SDGNUM   EQU   SDGENT                                                   12567000
SDGCHN   EQU   SDGENT+1                                                 12568000
SDGVALS  EQU   SDGENT+4                                                 12569000
SDGSANOP EQU   SDGVALS                                                  12570000
SDGSANO  EQU   SDGSANOP                                                 12571000
SDGSAST  EQU   SDGSANOP+1                                               12572000
SDGSAOF  EQU   SDGSAST                                                  12573000
SDGSARDY EQU   SDGSAST                                                  12574000
SDGSAVAL EQU   SDGSAST                                                  12575000
SDGSAP   EQU   SDGSAST                                                  12576000
SDGCSFNP EQU   SDGVALS+2                                                12577000
SDGCSFNO EQU   SDGCSFNP                                                 12578000
SDGDCCNO EQU   SDGCSFNP+1                                               12579000
SDGDCCST EQU   SDGVALS+4                                                12580000
SDGDCOF  EQU   SDGDCCST                                                 12581000
SDGDCRDY EQU   SDGDCCST                                                 12582000
DRCTAB   EQU   0                                                        12583000
DRCCHN   EQU   DRCTAB                                                   12584000
DRCSAID  EQU   DRCTAB+4                                                 12585000
DRCSAID2 EQU   DRCSAID+1                                                12586000
DRCSAST  EQU   DRCTAB+7                                                 12587000
DRCSAOF  EQU   DRCSAST                                                  12588000
DRCSARDY EQU   DRCSAST                                                  12589000
DRCSANA  EQU   DRCSAST                                                  12590000
DRCSAVAL EQU   DRCSAST                                                  12591000
DRCDCOF  EQU   DRCSAST                                                  12592000
DRCDCRDY EQU   DRCSAST                                                  12593000
DRCDCNA  EQU   DRCSAST                                                  12594000
DRCDRNO  EQU   DRCTAB+8                                                 12595000
DRCSANO  EQU   DRCTAB+9                                                 12596000
DRCDRSS  EQU   DRCTAB+10                                                12597000
DRCDRSS2 EQU   DRCDRSS+1                                                12598000
DRCDRSS3 EQU   DRCDRSS+2                                                12599000
DRCCSNO  EQU   DRCTAB+13                                                12600000
DRCDRD   EQU   DRCTAB+14                                                12601000
DRCDRDAD EQU   DRCDRD                                                   12602000
DRCDRDST EQU   DRCDRD+3                                                 12603000
DRCDRDOF EQU   DRCDRDST                                                 12604000
DRCDRDRD EQU   DRCDRDST                                                 12605000
DRCDRDNA EQU   DRCDRDST                                                 12606000
QCTENT   EQU   0                                                        12607000
QCTNOP   EQU   QCTENT                                                   12608000
QCTNO    EQU   QCTNOP                                                   12609000
QCTSDG   EQU   QCTNOP+1                                                 12610000
QCTCVOL  EQU   QCTENT+2                                                 12611000
QCTCSEQ  EQU   QCTENT+8                                                 12612000
QCTSSID  EQU   QCTENT+9                                                 12613000
QCTLVAL  EQU   QCTENT+12                                                12614000
QCTXVAL  EQU   QCTENT+13                                                12615000
QCTYVAL  EQU   QCTENT+16                                                12616000
QCTZVAL  EQU   QCTENT+18                                                12617000
QCTRCOD  EQU   QCTENT+19                                                12618000
QCTCHAIN EQU   QCTENT+21                                                12619000
CHAIN    EQU   0                                                        12620000
CHNADR   EQU   CHAIN+1                                                  12621000
STATTAB  EQU   0                                                        12622000
STATFLG  EQU   STATTAB                                                  12623000
STSTAG   EQU   STATFLG                                                  12624000
STREAL   EQU   STATFLG                                                  12625000
STBIND   EQU   STATFLG                                                  12626000
STNEUT   EQU   STATFLG                                                  12627000
STCONV   EQU   STATFLG                                                  12628000
STATUNIT EQU   STATTAB+1                                                12629000
STATOUA  EQU   STATUNIT                                                 12630000
STATOUA1 EQU   STATOUA                                                  12631000
STCUA    EQU   STATUNIT+1                                               12632000
STCUA1   EQU   STCUA                                                    12633000
STCUA2   EQU   STCUA                                                    12634000
PABMAP   EQU   0                                                        12635000
PABSTAT  EQU   PABMAP+192                                               12636000
PABFLG   EQU   PABSTAT                                                  12637000
PABRI    EQU   PABSTAT+1                                                12638000
PABUNIT  EQU   PABSTAT+2                                                12639000
BYTE022  EQU   0                                                        12640000
ACC2BIT  EQU   BYTE022                                                  12641000
ACC1BIT  EQU   BYTE022                                                  12642000
LASTLINE EQU   0                                                        12643000
LASMLLEN EQU   LASTLINE+1                                               12644000
LASMLTXT EQU   LASTLINE+4                                               12645000
MSG04TXT EQU   0                                                        12646000
MSG04CPU EQU   MSG04TXT+4                                               12647000
MSG04RNG EQU   MSG04CPU+3                                               12648000
MSG04RN1 EQU   MSG04RNG                                                 12649000
MSG04RN2 EQU   MSG04RNG+4                                               12650000
DATAFLDS EQU   0                                                        12651000
DSSID    EQU   DATAFLDS                                                 12652000
DSSID2   EQU   DSSID+1                                                  12653000
DTYPE    EQU   DATAFLDS+5                                               12654000
DTYPE14  EQU   DTYPE                                                    12655000
DTYPE5   EQU   DTYPE+4                                                  12656000
DSTAT    EQU   DATAFLDS+11                                              12657000
DSTAT1   EQU   DSTAT                                                    12658000
DSTAT27  EQU   DSTAT+1                                                  12659000
DSTAT25  EQU   DSTAT27                                                  12660000
DUSE     EQU   DATAFLDS+19                                              12661000
DUSE14   EQU   DUSE                                                     12662000
DUSE58   EQU   DUSE+4                                                   12663000
DCONF    EQU   DATAFLDS+28                                              12664000
DCONF12  EQU   DCONF                                                    12665000
DCONF35  EQU   DCONF+2                                                  12666000
DCONF45  EQU   DCONF35+1                                                12667000
DATALINE EQU   0                                                        12668000
FHALF    EQU   DATALINE                                                 12669000
SHALF    EQU   DATALINE+35                                              12670000
CONFARY  EQU   0                                                        12671000
PRITBL   EQU   CONFARY                                                  12672000
SECTBL   EQU   CONFARY+1                                                12673000
EXISTARY EQU   CONFARY+2                                                12674000
ONLINARY EQU   CONFARY+42                                               12675000
AVAILARY EQU   CONFARY+82                                               12676000
MSG01TXT EQU   0                                                        12677000
REQCHAR  EQU   0                                                        12678000
RNGCHAR  EQU   0                                                        12679000
DSPSSIDS EQU   0                                                        12680000
QUBUF1   EQU   0                                                        12681000
QUBUF3   EQU   0                                                        12682000
QUERYAR  EQU   0                                                        12683000
QULEN    EQU   QUERYAR                                                  12684000
QUORD    EQU   QUERYAR+4                                                12685000
QUCODE   EQU   QUERYAR+6                                                12686000
QUSECT   EQU   QUERYAR+7                                                12687000
QUXADDR  EQU   QUSECT                                                   12688000
QUFLAG   EQU   QUXADDR                                                  12689000
QUPARM   EQU   QUERYAR+8                                                12690000
QUPTR    EQU   QUERYAR+40                                               12691000
WPLBUF   EQU   0                                                        12692000
MSGBMAP  EQU   0                                                        12693000
ALMSCAD  EQU   MSGBMAP+8                                                12694000
ALTMONOF EQU   MSGBMAP+15                                               12695000
ALTMRDYO EQU   ALTMONOF+2                                               12696000
ALTMUNUS EQU   MSGBMAP+25                                               12697000
ALTMUS   EQU   ALTMUNUS                                                 12698000
ALTMRCD  EQU   MSGBMAP+36                                               12699000
ALTMNIML EQU   ALTMRCD                                                  12700000
ALTMRSNU EQU   MSGBMAP+49                                               12701000
ALTMRSN  EQU   ALTMRSNU                                                 12702000
ALTMRSNY EQU   ALTMRSNU+2                                               12703000
WCS4C    EQU   0                                                        12704000
WC4CRSNP EQU   WCS4C                                                    12705000
WC4CRSN  EQU   WC4CRSNP                                                 12706000
MSGBDS   EQU   0                                                        12707000
MSGBVIST EQU   MSGBDS+5                                                 12708000
MSGBJRST EQU   MSGBDS+23                                                12709000
CONFXTBL EQU   0                                                        12710000
CONFXTAB EQU   CONFXTBL                                                 12711000
MIDCTAB  EQU   CONFXTBL+128                                             12712000
MIDCPUID EQU   MIDCTAB                                                  12713000
MIDCPAIR EQU   MIDCTAB+5                                                12714000
MIDCFLG1 EQU   MIDCTAB+6                                                12715000
MIDCFPOT EQU   MIDCFLG1                                                 12716000
MIDCFALT EQU   MIDCFLG1                                                 12717000
MIDCFIF  EQU   MIDCFLG1                                                 12718000
MIDCFLG2 EQU   MIDCTAB+7                                                12719000
MIDCFVAL EQU   MIDCFLG2                                                 12720000
MIDCFASC EQU   MIDCFLG2                                                 12721000
MIDCFCBF EQU   MIDCFLG2                                                 12722000
MIDCFAIF EQU   MIDCFLG2                                                 12723000
MIDCFAI1 EQU   MIDCFAIF                                                 12724000
MIDCFAI2 EQU   MIDCFAIF                                                 12725000
CONFXENT EQU   0                                                        12726000
CXCSCON  EQU   CONFXENT                                                 12727000
CXCSCCS  EQU   CXCSCON                                                  12728000
CXCSCS0  EQU   CXCSCON                                                  12729000
CXCSCS1  EQU   CXCSCON                                                  12730000
CXSAIF   EQU   CONFXENT+2                                               12731000
CXSACPU  EQU   CXSAIF                                                   12732000
CXSACUCH EQU   CXSAIF+1                                                 12733000
CONFDATA EQU   0                                                        12734000
CONDCONF EQU   CONFDATA                                                 12735000
CONDALTP EQU   CONFDATA+1                                               12736000
WCS7X    EQU   0                                                        12737000
DRCSA    EQU   WCS7X                                                    12738000
DRCCON   EQU   DRCSA                                                    12739000
DRCUCB   EQU   WCS7X+16                                                 12740000
DRDUCB   EQU   WCS7X+32                                                 12741000
DRDFLGS  EQU   DRDUCB                                                   12742000
SAUCB    EQU   WCS7X+64                                                 12743000
SAFLGS   EQU   SAUCB                                                    12744000
SAFVAL   EQU   SAFLGS                                                   12745000
SAFONL   EQU   SAFLGS                                                   12746000
SAFRDY   EQU   SAFLGS                                                   12747000
DRCPUCB  EQU   0                                                        12748000
DRCFLGS  EQU   DRCPUCB                                                  12749000
DRCFONL  EQU   DRCFLGS                                                  12750000
DRCFUSA  EQU   DRCFLGS                                                  12751000
WCS0F    EQU   0                                                        12752000
WC0FINIT EQU   WCS0F                                                    12753000
WC0FINA  EQU   WC0FINIT                                                 12754000
WC0FINB  EQU   WC0FINIT                                                 12755000
WC0FINC  EQU   WC0FINIT                                                 12756000
WC0FIND  EQU   WC0FINIT                                                 12757000
WC0FP    EQU   WCS0F+1                                                  12758000
WC0FAP   EQU   WCS0F+2                                                  12759000
WC0FAPCK EQU   WC0FAP                                                   12760000
VUCBAD   EQU   0                                                        12761000
VERTAB   EQU   0                                                        12762000
VESDGNDX EQU   VERTAB                                                   12763000
VESDG1   EQU   VESDGNDX                                                 12764000
VESDG2   EQU   VESDGNDX+1                                               12765000
QCBAR    EQU   0                                                        12766000
QCB      EQU   0                                                        12767000
QCBFLG1  EQU   QCB                                                      12768000
QCBERR   EQU   QCBFLG1                                                  12769000
QCBFLG2  EQU   QCB+2                                                    12770000
QCBCSEQ  EQU   QCBFLG2                                                  12771000
QCBRCOD  EQU   QCB+3                                                    12772000
QCBRCE   EQU   QCBRCOD                                                  12773000
QCBRCC   EQU   QCBRCOD                                                  12774000
QCBRMC   EQU   QCBRCOD                                                  12775000
QCBRDA   EQU   QCBRCOD                                                  12776000
QCBRSA   EQU   QCBRCOD                                                  12777000
QCBRDC   EQU   QCBRCOD                                                  12778000
QCBRDD   EQU   QCBRCOD                                                  12779000
QCBRCS   EQU   QCBRCOD                                                  12780000
QCBEXT   EQU   0                                                        12781000
SQTENT   EQU   0                                                        12782000
SQTBFLG  EQU   SQTENT                                                   12783000
SQTMHPTR EQU   SQTENT+1                                                 12784000
SQTBFLG1 EQU   SQTENT+2                                                 12785000
SQTBFLG2 EQU   SQTENT+3                                                 12786000
SQTSA1   EQU   SQTENT+4                                                 12787000
SQTDRDAD EQU   SQTENT+14                                                12788000
SQTCVOL  EQU   SQTENT+16                                                12789000
SQTLZYX  EQU   SQTENT+22                                                12790000
SQLZYXC1 EQU   SQTLZYX                                                  12791000
SQLZYXC2 EQU   SQTLZYX+1                                                12792000
MHDR     EQU   0                                                        12793000
MHF1     EQU   MHDR+1                                                   12794000
MHF1B1   EQU   MHF1                                                     12795000
MHF1B6   EQU   MHF1                                                     12796000
MHF1B7   EQU   MHF1                                                     12797000
MHIOLUA  EQU   MHDR+8                                                   12798000
MHPLNDX  EQU   MHDR+14                                                  12799000
MHSALUA  EQU   0                                                        12800000
TRCCHK   EQU   0                                                        12801000
TRCCHKA  EQU   TRCCHK                                                   12802000
TRCACT   EQU   TRCCHKA                                                  12803000
TRCXACT  EQU   TRCCHKA                                                  12804000
TRCCHR   EQU   TRCCHK+1                                                 12805000
TRCNC    EQU   TRCCHR                                                   12806000
TRCNH    EQU   TRCCHR+1                                                 12807000
TRCNR    EQU   TRCCHR+2                                                 12808000
TRCCHRS  EQU   0                                                        12809000
@NM00140 EQU   TRCCHRS+64                                               12810000
TRCEXC   EQU   @NM00140+1                                               12811000
TRCEXH   EQU   @NM00140+2                                               12812000
TRCEXR   EQU   @NM00140+3                                               12813000
@NM00142 EQU   TRCCHRS+68                                               12814000
TRCEYC   EQU   @NM00142+1                                               12815000
TRCEYH   EQU   @NM00142+2                                               12816000
TRCEYR   EQU   @NM00142+3                                               12817000
@NM00144 EQU   TRCCHRS+72                                               12818000
TRCSXC   EQU   @NM00144+1                                               12819000
TRCSXH   EQU   @NM00144+2                                               12820000
TRCSXR   EQU   @NM00144+3                                               12821000
@NM00146 EQU   TRCCHRS+76                                               12822000
TRCSYC   EQU   @NM00146+1                                               12823000
TRCSYH   EQU   @NM00146+2                                               12824000
TRCSYR   EQU   @NM00146+3                                               12825000
MSGTRB   EQU   0                                                        12826000
MTRACTIN EQU   MSGTRB+6                                                 12827000
MTRCLR   EQU   MSGTRB+14                                                12828000
MTRAREA  EQU   MTRCLR+8                                                 12829000
MTRPCT   EQU   MTRCLR+11                                                12830000
MTRPCTB  EQU   MTRPCT+1                                                 12831000
MVSRC    EQU   0                                                        12832000
MVREC    EQU   0                                                        12833000
MOVEMAP  EQU   0                                                        12834000
PARMS    EQU   0                                                        12835000
INLEN    EQU   PARMS                                                    12836000
INADDR   EQU   PARMS+1                                                  12837000
CPUMSG   EQU   0                                                        12838000
CMCPUID  EQU   CPUMSG                                                   12839000
CMCPSTAT EQU   CPUMSG+10                                                12840000
CMCHAN   EQU   CPUMSG+16                                                12841000
CMINTF   EQU   CPUMSG+19                                                12842000
CMSANO   EQU   CPUMSG+22                                                12843000
CMSAST   EQU   CPUMSG+25                                                12844000
CMSAST2  EQU   CMSAST+2                                                 12845000
CMSDGS   EQU   CPUMSG+32                                                12846000
CMSDG1   EQU   CMSDGS                                                   12847000
CMSDGSEP EQU   CMSDGS+2                                                 12848000
CMSDG2   EQU   CMSDGS+3                                                 12849000
CMUSTAT  EQU   CPUMSG+38                                                12850000
CMUSTON  EQU   CMUSTAT                                                  12851000
CMUSTOF  EQU   CMUSTON                                                  12852000
CMUSTSU  EQU   CMUSTOF                                                  12853000
CMUST    EQU   0                                                        12854000
CMUST1   EQU   CMUST                                                    12855000
CMUSEP   EQU   CMUST+3                                                  12856000
CMUST2   EQU   CMUST+4                                                  12857000
CMUCMA2  EQU   CMUST+7                                                  12858000
CMUSTX   EQU   0                                                        12859000
SDGMSG   EQU   0                                                        12860000
SDMSDGN  EQU   SDGMSG                                                   12861000
SDMSDGN2 EQU   SDMSDGN+1                                                12862000
@NM00163 EQU   SDGMSG+5                                                 12863000
SDMSA    EQU   @NM00163                                                 12864000
SDMSAU   EQU   @NM00163+1                                               12865000
SDMSAX   EQU   SDMSAU+1                                                 12866000
SDMSASUU EQU   SDGMSG+8                                                 12867000
SDMSAOFF EQU   SDMSASUU                                                 12868000
SDMSAON  EQU   SDMSAOFF                                                 12869000
SDMDR    EQU   SDGMSG+15                                                12870000
SDMDRSUU EQU   SDGMSG+18                                                12871000
SDMDROFF EQU   SDMDRSUU                                                 12872000
SDMDRON  EQU   SDMDROFF                                                 12873000
DRCMSG   EQU   0                                                        12874000
MDRSA    EQU   DRCMSG                                                   12875000
MDRSASUU EQU   DRCMSG+3                                                 12876000
MDRSAOFF EQU   MDRSASUU                                                 12877000
MDRSAON  EQU   MDRSAOFF                                                 12878000
MDRDRC   EQU   DRCMSG+10                                                12879000
MDRDCUNA EQU   DRCMSG+13                                                12880000
MDRDCSUU EQU   MDRDCUNA                                                 12881000
MDRDCOFF EQU   MDRDCSUU                                                 12882000
MDRDCON  EQU   MDRDCOFF                                                 12883000
MDRDRDS  EQU   DRCMSG+20                                                12884000
MDRDRD   EQU   MDRDRDS+2                                                12885000
MDRDDUNA EQU   MDRDRDS+5                                                12886000
MDRDDSUU EQU   MDRDDUNA                                                 12887000
MDRDDOFF EQU   MDRDDSUU                                                 12888000
QCBMSG   EQU   0                                                        12889000
QCMQCBU  EQU   QCBMSG                                                   12890000
QCMQCB   EQU   QCMQCBU                                                  12891000
QCMX1    EQU   QCMQCBU+2                                                12892000
QCMSDGU  EQU   QCBMSG+4                                                 12893000
QCMSDG   EQU   QCMSDGU                                                  12894000
QCMX2    EQU   QCMSDGU+2                                                12895000
QCMCART  EQU   QCBMSG+8                                                 12896000
QCMSSID  EQU   QCMCART+3                                                12897000
QCMCDSH  EQU   QCBMSG+14                                                12898000
QCMCSEQ  EQU   QCBMSG+15                                                12899000
QCML     EQU   QCBMSG+18                                                12900000
QCMX     EQU   QCBMSG+20                                                12901000
QCMY     EQU   QCBMSG+24                                                12902000
QCMZ     EQU   QCBMSG+27                                                12903000
QCMRCOD  EQU   QCBMSG+30                                                12904000
ENDCH    EQU   0                                                        12905000
CURCH    EQU   0                                                        12906000
CURQUAL  EQU   0                                                        12907000
PACK2    EQU   0                                                        12908000
QUBUF2   EQU   0                                                        12909000
SDGTAB   EQU   0                                                        12910000
UCBBGN   EQU   0                                                        12911000
EXITSW   EQU   BITSW                                                    12912000
BYTES234 EQU   INTER+1                                                  12913000
BYTES34  EQU   BYTES234+1                                               12914000
BYTE4    EQU   BYTES34+1                                                12915000
BYTE4C   EQU   BYTE4                                                    12916000
CVTS01   EQU   CVTPGSIA                                                 12917000
CVTLPDIA EQU   CVTS01+12                                                12918000
CVTDIRST EQU   CVTLPDIA                                                 12919000
CVTSLIDA EQU   CVTS01+24                                                12920000
CVTCTLFG EQU   CVTS01+50                                                12921000
CVTRV210 EQU   CVTS01+424                                               12922000
CVTRV219 EQU   CVTS01+425                                               12923000
CVTRV228 EQU   CVTS01+426                                               12924000
CVTRV237 EQU   CVTS01+427                                               12925000
CVTMFRTR EQU   CVTS01+452                                               12926000
CVTRV262 EQU   CVTS01+468                                               12927000
CVTRV271 EQU   CVTS01+469                                               12928000
CVTRV280 EQU   CVTS01+470                                               12929000
CVTRV289 EQU   CVTS01+471                                               12930000
CVTGSDA  EQU   CVTS01+600                                               12931000
UCBOBS01 EQU   UCBDEV                                                   12932000
UCBSTAB  EQU   UCBOBS01+10                                              12933000
UCBBSVL  EQU   UCBSTAB                                                  12934000
UCBPRSRS EQU   UCBSTAB                                                  12935000
UCBDMCT  EQU   UCBOBS01+11                                              12936000
UCBFL4   EQU   UCBOBS01+13                                              12937000
UCBOBS02 EQU   UCBDEV                                                   12938000
UCBTFL1  EQU   UCBOBS02+19                                              12939000
UCBXTN   EQU   UCBOBS02+20                                              12940000
UCBVOPT  EQU   UCBXTN                                                   12941000
UCBOBS03 EQU   UCBDEV                                                   12942000
UCBXTADR EQU   UCBOBS03                                                 12943000
UCBOBS04 EQU   UCBDEV                                                   12944000
UCBBTA   EQU   UCBOBS04+12                                              12945000
UCBOBS06 EQU   UCBDEV                                                   12946000
UCBAOF   EQU   UCBOBS06                                                 12947000
UCBAOF1  EQU   UCBAOF                                                   12948000
UCBAOF2  EQU   UCBAOF+1                                                 12949000
@NM00007 EQU   UCBOBS06+3                                               12950000
UCBIRB   EQU   UCBOBS06+4                                               12951000
UCBGRAF  EQU   UCBIRB                                                   12952000
UCBLDNCA EQU   UCBOBS06+8                                               12953000
UCBRDYQ  EQU   UCBLDNCA                                                 12954000
UCBIRLN  EQU   UCBRDYQ                                                  12955000
UCBLDNCB EQU   UCBRDYQ+1                                                12956000
UCBCTLNK EQU   UCBOBS06+12                                              12957000
UCBOBS07 EQU   UCBDEV                                                   12958000
UCBOBS08 EQU   UCBDEV                                                   12959000
UCBOBS09 EQU   UCBDEV                                                   12960000
CPHIDP   EQU   CPHENT                                                   12961000
CHNPTR   EQU   CHNPTRS                                                  12962000
QCTSDGP  EQU   QCTSDG                                                   12963000
QCTRCODU EQU   QCTRCOD                                                  12964000
MSG0402  EQU   MSG04TXT                                                 12965000
MSG04SSI EQU   MSG0402+5                                                12966000
MSG04DRC EQU   MSG0402+10                                               12967000
MSG04SDG EQU   MSG0402+13                                               12968000
DEFSSIDS EQU   SSIDS                                                    12969000
SRTDRDS  EQU   DEFSSIDS                                                 12970000
DRDSSIDS EQU   SRTDRDS                                                  12971000
SRTSAS   EQU   DEFSSIDS+96                                              12972000
SASSIDS  EQU   SRTSAS                                                   12973000
SRTDRCS  EQU   DEFSSIDS+144                                             12974000
DRCSSIDS EQU   SRTDRCS                                                  12975000
SDGSSIDS EQU   DEFSSIDS+192                                             12976000
SRTMSFS  EQU   DEFSSIDS+936                                             12977000
MSFSSIDS EQU   SRTMSFS                                                  12978000
SRTSDAS  EQU   SDGSSIDS                                                 12979000
SRTSDA1  EQU   SRTSDAS                                                  12980000
SRTSDA2  EQU   SRTSDAS+224                                              12981000
SRTSDA3  EQU   SRTSDAS+448                                              12982000
CONSID   EQU   CONSOL                                                   12983000
SAVDOMID EQU   CONSID                                                   12984000
CONSID4  EQU   CONSID+3                                                 12985000
INTFC    EQU   NUMBRS+10                                                12986000
DSPFLG   EQU   CWBCOMQ                                                  12987000
DSPALL   EQU   DSPFLG                                                   12988000
DSPON    EQU   DSPFLG                                                   12989000
DSPOFF   EQU   DSPFLG                                                   12990000
DSPSDG   EQU   DSPFLG                                                   12991000
DSPRNG   EQU   DSPFLG                                                   12992000
DSPSSID  EQU   DSPFLG                                                   12993000
DSPCPU   EQU   DSPFLG                                                   12994000
DSPPATH  EQU   DSPFLG                                                   12995000
DSPADDS  EQU   CWBRESV                                                  12996000
DSPFLG2  EQU   DSPADDS                                                  12997000
DSPDRC   EQU   DSPFLG2                                                  12998000
DSPNEW   EQU   DSPFLG2                                                  12999000
DSPQUAL  EQU   DSPFLG2                                                  13000000
DSPMSVC  EQU   DSPFLG2                                                  13001000
DSPTRC   EQU   DSPFLG2                                                  13002000
DSPQCB   EQU   DSPFLG2                                                  13003000
DSPALTM  EQU   DSPFLG2                                                  13004000
DSPINP   EQU   DSPFLG2                                                  13005000
DSPOFFS  EQU   CWBRESV+1                                                13006000
EXIST    EQU   EXISTARY                                                 13007000
DRCXST   EQU   EXIST+6                                                  13008000
SDGXST   EQU   EXIST+8                                                  13009000
ONLINE   EQU   ONLINARY                                                 13010000
DRDON    EQU   ONLINE                                                   13011000
SAON     EQU   ONLINE+4                                                 13012000
DRCON    EQU   ONLINE+6                                                 13013000
SDGON    EQU   ONLINE+8                                                 13014000
MSFON    EQU   ONLINE+39                                                13015000
READY    EQU   AVAILARY                                                 13016000
DRDRDY   EQU   READY                                                    13017000
SARDY    EQU   READY+4                                                  13018000
DRCRDY   EQU   READY+6                                                  13019000
SDGRDY   EQU   READY+8                                                  13020000
MSFRDY   EQU   READY+39                                                 13021000
RBIT     EQU   REQBIT                                                   13022000
REQBITB  EQU   REQBIT                                                   13023000
DRDREQ   EQU   REQBITB                                                  13024000
SAREQ    EQU   REQBITB+4                                                13025000
DRCREQ   EQU   REQBITB+6                                                13026000
SDGREQ   EQU   REQBITB+8                                                13027000
MSFREQ   EQU   REQBITB+39                                               13028000
REQCHARB EQU   REQCHAR                                                  13029000
DRDCHRA  EQU   REQCHARB                                                 13030000
SACHRA   EQU   REQCHARB+32                                              13031000
DRCCHRA  EQU   REQCHARB+48                                              13032000
SDGCHRA  EQU   REQCHARB+64                                              13033000
SDGCHR   EQU   SDGCHRA                                                  13034000
MSFCHRA  EQU   REQCHARB+312                                             13035000
RNGCHARB EQU   RNGCHAR                                                  13036000
SDGRNGA  EQU   RNGCHARB                                                 13037000
MSFRNGA  EQU   RNGCHARB+224                                             13038000
DRDRNGA  EQU   RNGCHARB+232                                             13039000
DRCRNGA  EQU   RNGCHARB+264                                             13040000
SARNGA   EQU   RNGCHARB+280                                             13041000
DSPSSTB  EQU   DSPSSIDS                                                 13042000
DTBDA    EQU   DSPSSTB                                                  13043000
DTBDA1   EQU   DTBDA                                                    13044000
DTBDA2   EQU   DTBDA+224                                                13045000
DTBDA3   EQU   DTBDA+448                                                13046000
DTBMSF   EQU   DSPSSTB+672                                              13047000
DTBDRD   EQU   DSPSSTB+696                                              13048000
DTBDRC   EQU   DSPSSTB+792                                              13049000
DTBSA    EQU   DSPSSTB+840                                              13050000
QWPARM   EQU   QUPARM                                                   13051000
QWRES1   EQU   QWPARM                                                   13052000
QWFLAG   EQU   QWPARM+2                                                 13053000
QTPARM   EQU   QUPARM                                                   13054000
QTID     EQU   QTPARM                                                   13055000
QLPARM   EQU   QUPARM                                                   13056000
QCPARM   EQU   QUPARM                                                   13057000
CURPTRS  EQU   CURSTR                                                   13058000
@NM00117 EQU   CURPTRS                                                  13059000
USEADB   EQU   @NM00117                                                 13060000
CURPTR   EQU   CURPTRS+1                                                13061000
CPXWK    EQU   PTHWK                                                    13062000
CPXMODP1 EQU   CPXWK+4                                                  13063000
CPYWK    EQU   PTHWK                                                    13064000
CPXIDP1  EQU   CPYWK+1                                                  13065000
CPXCPU   EQU   PTHWK+1                                                  13066000
CURRCPU  EQU   CURRCPUW                                                 13067000
CPXIDC1  EQU   CURRCPU                                                  13068000
QCBRCODP EQU   QCBRCOD                                                  13069000
LZYXFX   EQU   LZYXCALC                                                 13070000
QBCHRC   EQU   QBCHRF                                                   13071000
CMCPUIDU EQU   CMCPUID                                                  13072000
CMUSTY   EQU   CMUSTX                                                   13073000
@NM00167 EQU   SDMDR                                                    13074000
SDMDRU   EQU   @NM00167+1                                               13075000
SDMDRA   EQU   SDMDRU                                                   13076000
SDMDRX   EQU   SDMDRU+2                                                 13077000
CMSASTO  EQU   CMSAST                                                   13078000
RCHAR    EQU   REQCHAR                                                  13079000
RGCHAR   EQU   RNGCHAR                                                  13080000
*                                      START UNREFERENCED COMPONENTS    13081000
@NM00168 EQU   @NM00167                                                 13082000
CMUSTSUU EQU   CMUSTY+3                                                 13083000
@NM00160 EQU   CMUSTY                                                   13084000
@NM00124 EQU   CPYWK                                                    13085000
CPXMODP  EQU   CPXMODP1                                                 13086000
CPXIDP   EQU   CPXWK+1                                                  13087000
@NM00123 EQU   CPXWK                                                    13088000
@NM00118 EQU   @NM00117                                                 13089000
QCMAD3Z1 EQU   QCPARM+28                                                13090000
QCMAD3Z0 EQU   QCPARM+24                                                13091000
QCMAD2Z1 EQU   QCPARM+20                                                13092000
QCMAD2Z0 EQU   QCPARM+16                                                13093000
QCMAD1Z1 EQU   QCPARM+12                                                13094000
QCMAD1Z0 EQU   QCPARM+8                                                 13095000
QCMAD0Z1 EQU   QCPARM+4                                                 13096000
QCMAD0Z0 EQU   QCPARM                                                   13097000
QLRES    EQU   QLPARM+2                                                 13098000
QLZYX    EQU   QLPARM                                                   13099000
QTRES    EQU   QTPARM+24                                                13100000
QTDASCHR EQU   QTPARM+20                                                13101000
QTDATA   EQU   QTPARM+2                                                 13102000
QTFLAG   EQU   QTPARM+1                                                 13103000
QTTABID  EQU   QTID                                                     13104000
QWRES2   EQU   QWPARM+3                                                 13105000
QWALTMSC EQU   QWFLAG                                                   13106000
@NM00091 EQU   QWFLAG                                                   13107000
QWMEM    EQU   QWFLAG                                                   13108000
QWSSID   EQU   QWRES1                                                   13109000
@NM00090 EQU   RNGCHARB+296                                             13110000
SARNG    EQU   SARNGA                                                   13111000
DRCRNG   EQU   DRCRNGA                                                  13112000
DRDRNG   EQU   DRDRNGA                                                  13113000
MSFRNG   EQU   MSFRNGA                                                  13114000
SDGRNG   EQU   SDGRNGA                                                  13115000
MSFCHR   EQU   MSFCHRA                                                  13116000
@NM00089 EQU   REQCHARB+304                                             13117000
DRCCHR   EQU   DRCCHRA                                                  13118000
SACHR    EQU   SACHRA                                                   13119000
DRDCHR   EQU   DRDCHRA                                                  13120000
@NM00086 EQU   REQBITB+38                                               13121000
@NM00085 EQU   READY+38                                                 13122000
@NM00084 EQU   ONLINE+38                                                13123000
MSFXST   EQU   EXIST+39                                                 13124000
@NM00083 EQU   EXIST+38                                                 13125000
@NM00082 EQU   EXIST+7                                                  13126000
SAXST    EQU   EXIST+4                                                  13127000
@NM00081 EQU   EXIST+2                                                  13128000
DRDXST   EQU   EXIST                                                    13129000
CWBOFFS  EQU   DSPADDS+1                                                13130000
@NM00069 EQU   DEFSSIDS+864                                             13131000
@NM00068 EQU   MSG0402+12                                               13132000
@NM00067 EQU   MSG0402+8                                                13133000
@NM00066 EQU   MSG0402                                                  13134000
UCBRV066 EQU   UCBOBS09+4                                               13135000
UCBIOSBA EQU   UCBOBS09                                                 13136000
UCBRV042 EQU   UCBOBS08+5                                               13137000
UCBCTCF1 EQU   UCBOBS08+4                                               13138000
UCBCTCAD EQU   UCBOBS08                                                 13139000
UCBICNCB EQU   UCBOBS07+4                                               13140000
UCBRV040 EQU   UCBOBS07                                                 13141000
UCBCTLNA EQU   UCBCTLNK+1                                               13142000
UCBRLN   EQU   UCBCTLNK                                                 13143000
UCBRDYQA EQU   UCBLDNCB                                                 13144000
UCBINRLN EQU   UCBIRLN                                                  13145000
UCBIRBA  EQU   UCBIRB+1                                                 13146000
UCBRV039 EQU   UCBGRAF                                                  13147000
UCBDWNR  EQU   UCBGRAF                                                  13148000
UCBRPND  EQU   UCBGRAF                                                  13149000
UCBUPM   EQU   UCBGRAF                                                  13150000
UCBBTAM  EQU   UCBGRAF                                                  13151000
UCBDRNO  EQU   UCBGRAF                                                  13152000
UCBDRO   EQU   UCBGRAF                                                  13153000
UCBOIP   EQU   UCBGRAF                                                  13154000
UCBATRCD EQU   @NM00007                                                 13155000
UCBSKPFG EQU   @NM00007                                                 13156000
UCBRIPND EQU   @NM00007                                                 13157000
UCBRTIAC EQU   @NM00007                                                 13158000
UCBRSV79 EQU   @NM00007                                                 13159000
UCBRSV78 EQU   @NM00007                                                 13160000
UCBRSV77 EQU   @NM00007                                                 13161000
UCBOLTEP EQU   @NM00007                                                 13162000
UCBATNCT EQU   UCBOBS06+2                                               13163000
UCBRSV76 EQU   UCBAOF2                                                  13164000
UCBRSV75 EQU   UCBAOF2                                                  13165000
UCBRSV74 EQU   UCBAOF2                                                  13166000
UCBRSV73 EQU   UCBAOF2                                                  13167000
UCBRSV72 EQU   UCBAOF2                                                  13168000
UCBRSV71 EQU   UCBAOF2                                                  13169000
UCBRSV70 EQU   UCBAOF2                                                  13170000
UCBRSV69 EQU   UCBAOF2                                                  13171000
UCBRSV68 EQU   UCBAOF1                                                  13172000
UCBRSV67 EQU   UCBAOF1                                                  13173000
UCBRSV66 EQU   UCBAOF1                                                  13174000
UCBRSV65 EQU   UCBAOF1                                                  13175000
UCBRSV64 EQU   UCBAOF1                                                  13176000
UCBOFNL  EQU   UCBAOF1                                                  13177000
UCBOFSP  EQU   UCBAOF1                                                  13178000
UCBOFMCR EQU   UCBAOF1                                                  13179000
UCBBTB   EQU   UCBBTA+1                                                 13180000
UCBDI    EQU   UCBBTA                                                   13181000
UCBSNS   EQU   UCBOBS04+8                                               13182000
UCBTEB   EQU   UCBOBS04+4                                               13183000
UCBGCB   EQU   UCBOBS04+3                                               13184000
UCBOPEN  EQU   UCBOBS04+2                                               13185000
UCBSTART EQU   UCBOBS04                                                 13186000
UCBXTNB  EQU   UCBXTN+1                                                 13187000
UCBRSV22 EQU   UCBVOPT                                                  13188000
UCBRSV21 EQU   UCBVOPT                                                  13189000
UCBRSV20 EQU   UCBVOPT                                                  13190000
UCBESVE  EQU   UCBVOPT                                                  13191000
UCBERPC  EQU   UCBVOPT                                                  13192000
UCBESVC  EQU   UCBVOPT                                                  13193000
UCBEVA   EQU   UCBVOPT                                                  13194000
UCBESV   EQU   UCBVOPT                                                  13195000
UCBRV009 EQU   UCBTFL1                                                  13196000
UCBRV008 EQU   UCBTFL1                                                  13197000
UCBRV007 EQU   UCBTFL1                                                  13198000
UCBRV006 EQU   UCBTFL1                                                  13199000
UCBRV005 EQU   UCBTFL1                                                  13200000
UCBRV038 EQU   UCBTFL1                                                  13201000
UCBNSLTP EQU   UCBTFL1                                                  13202000
UCBNLTP  EQU   UCBTFL1                                                  13203000
UCBRES1B EQU   UCBOBS02+18                                              13204000
UCBFSER  EQU   UCBOBS02+12                                              13205000
@NM00006 EQU   UCBOBS02+4                                               13206000
UCBFSEQ  EQU   UCBOBS02+2                                               13207000
UCBFSCT  EQU   UCBOBS02                                                 13208000
UCBNEXP  EQU   UCBOBS01+20                                              13209000
UCBBASE  EQU   UCBOBS01+16                                              13210000
UCBRES1A EQU   UCBOBS01+15                                              13211000
UCBUSER  EQU   UCBOBS01+14                                              13212000
UCBFL47  EQU   UCBFL4                                                   13213000
UCBFL46  EQU   UCBFL4                                                   13214000
UCBFL45  EQU   UCBFL4                                                   13215000
UCBRV065 EQU   UCBFL4                                                   13216000
UCBDSS   EQU   UCBFL4                                                   13217000
UCBRV028 EQU   UCBFL4                                                   13218000
UCBWDAV  EQU   UCBFL4                                                   13219000
UCBDAVV  EQU   UCBFL4                                                   13220000
UCBSQC   EQU   UCBOBS01+12                                              13221000
UCBDATP  EQU   UCBOBS01+12                                              13222000
UCBDMC   EQU   UCBDMCT                                                  13223000
UCBMOUNT EQU   UCBDMCT                                                  13224000
UCBBNUL  EQU   UCBSTAB                                                  13225000
UCBSHAR  EQU   UCBSTAB                                                  13226000
UCBBSTR  EQU   UCBSTAB                                                  13227000
UCBBPUB  EQU   UCBSTAB                                                  13228000
UCBBPRV  EQU   UCBSTAB                                                  13229000
UCBBALB  EQU   UCBPRSRS                                                 13230000
UCBPGFL  EQU   UCBSTAB                                                  13231000
UCBDVSHR EQU   UCBBSVL                                                  13232000
UCBVOLI  EQU   UCBOBS01+4                                               13233000
UCBVTOC  EQU   UCBOBS01                                                 13234000
CVTRV628 EQU   CVTS01+728                                               13235000
CVTRV627 EQU   CVTS01+724                                               13236000
CVTRV626 EQU   CVTS01+720                                               13237000
CVTRV625 EQU   CVTS01+716                                               13238000
CVTRV624 EQU   CVTS01+712                                               13239000
CVTRV623 EQU   CVTS01+708                                               13240000
CVTRV622 EQU   CVTS01+704                                               13241000
CVTRV621 EQU   CVTS01+700                                               13242000
CVTIHASU EQU   CVTS01+696                                               13243000
CVTSUSP  EQU   CVTS01+692                                               13244000
CVTT6SVC EQU   CVTS01+688                                               13245000
CVTCDAL  EQU   CVTS01+684                                               13246000
CVTTCTL  EQU   CVTS01+680                                               13247000
CVTRSUME EQU   CVTS01+676                                               13248000
CVTJTERM EQU   CVTS01+672                                               13249000
CVTASMRM EQU   CVTS01+668                                               13250000
CVTTCASP EQU   CVTS01+664                                               13251000
CVT0PT03 EQU   CVTS01+660                                               13252000
CVT0PT0E EQU   CVTS01+656                                               13253000
CVTRV609 EQU   CVTS01+652                                               13254000
CVTCGK   EQU   CVTS01+648                                               13255000
CVTRAC   EQU   CVTS01+644                                               13256000
CVTHSM   EQU   CVTS01+640                                               13257000
CVTRV605 EQU   CVTS01+636                                               13258000
CVTRV604 EQU   CVTS01+632                                               13259000
CVTEFF02 EQU   CVTS01+628                                               13260000
CVTCBBR  EQU   CVTS01+624                                               13261000
CVTSSCR  EQU   CVTS01+620                                               13262000
CVTEVENT EQU   CVTS01+616                                               13263000
CVTCRCA  EQU   CVTS01+612                                               13264000
CVTTPIO  EQU   CVTS01+608                                               13265000
CVTADV   EQU   CVTS01+604                                               13266000
CVTGSDAB EQU   CVTGSDA                                                  13267000
CVTQV3   EQU   CVTS01+596                                               13268000
CVTQV2   EQU   CVTS01+592                                               13269000
CVTQV1   EQU   CVTS01+588                                               13270000
CVTRPT   EQU   CVTS01+584                                               13271000
CVTSSRB  EQU   CVTS01+580                                               13272000
CVTCSDRL EQU   CVTS01+576                                               13273000
CVTEXP1  EQU   CVTS01+572                                               13274000
CVTRMPMT EQU   CVTS01+568                                               13275000
CVTRMPTT EQU   CVTS01+564                                               13276000
CVTVPSA  EQU   CVTS01+560                                               13277000
CVTVSTOP EQU   CVTS01+556                                               13278000
CVTGTFR8 EQU   CVTS01+552                                               13279000
CVTQUIT  EQU   CVTS01+548                                               13280000
CVTVACR  EQU   CVTS01+544                                               13281000
CVTWTCB  EQU   CVTS01+540                                               13282000
CVTSTPRS EQU   CVTS01+536                                               13283000
CVT0PT02 EQU   CVTS01+532                                               13284000
CVTDARCM EQU   CVTS01+528                                               13285000
CVTIRECM EQU   CVTS01+524                                               13286000
CVTJRECM EQU   CVTS01+520                                               13287000
CVTVEMS0 EQU   CVTS01+516                                               13288000
CVTSPFRR EQU   CVTS01+512                                               13289000
CVTRLSTG EQU   CVTS01+508                                               13290000
CVT0TC0A EQU   CVTS01+504                                               13291000
CVTGMBR  EQU   CVTS01+500                                               13292000
CVTLFRM  EQU   CVTS01+496                                               13293000
CVTRMBR  EQU   CVTS01+492                                               13294000
CVTVIOP  EQU   CVTS01+488                                               13295000
CVTRV307 EQU   CVTS01+486                                               13296000
CVTRV306 EQU   CVTS01+484                                               13297000
CVTRV305 EQU   CVTS01+482                                               13298000
CVTRV304 EQU   CVTS01+480                                               13299000
CVTRV303 EQU   CVTS01+478                                               13300000
CVTRV302 EQU   CVTS01+476                                               13301000
CVTTRCA  EQU   CVTS01+472                                               13302000
CVTRV297 EQU   CVTRV289                                                 13303000
CVTRV296 EQU   CVTRV289                                                 13304000
CVTRV295 EQU   CVTRV289                                                 13305000
CVTRV294 EQU   CVTRV289                                                 13306000
CVTRV293 EQU   CVTRV289                                                 13307000
CVTRV292 EQU   CVTRV289                                                 13308000
CVTRV291 EQU   CVTRV289                                                 13309000
CVTRV290 EQU   CVTRV289                                                 13310000
CVTRV288 EQU   CVTRV280                                                 13311000
CVTRV287 EQU   CVTRV280                                                 13312000
CVTRV286 EQU   CVTRV280                                                 13313000
CVTRV285 EQU   CVTRV280                                                 13314000
CVTRV284 EQU   CVTRV280                                                 13315000
CVTRV283 EQU   CVTRV280                                                 13316000
CVTRV282 EQU   CVTRV280                                                 13317000
CVTRV281 EQU   CVTRV280                                                 13318000
CVTRV279 EQU   CVTRV271                                                 13319000
CVTRV278 EQU   CVTRV271                                                 13320000
CVTRV277 EQU   CVTRV271                                                 13321000
CVTRV276 EQU   CVTRV271                                                 13322000
CVTRV275 EQU   CVTRV271                                                 13323000
CVTRV274 EQU   CVTRV271                                                 13324000
CVTRV273 EQU   CVTRV271                                                 13325000
CVTRV272 EQU   CVTRV271                                                 13326000
CVTRV270 EQU   CVTRV262                                                 13327000
CVTRV269 EQU   CVTRV262                                                 13328000
CVTRV268 EQU   CVTRV262                                                 13329000
CVTRV267 EQU   CVTRV262                                                 13330000
CVTRV266 EQU   CVTRV262                                                 13331000
CVTRV265 EQU   CVTRV262                                                 13332000
CVTRV264 EQU   CVTRV262                                                 13333000
CVTRV263 EQU   CVTRV262                                                 13334000
CVTVFP   EQU   CVTS01+464                                               13335000
CVTVSI   EQU   CVTS01+460                                               13336000
CVTVPSIB EQU   CVTS01+456                                               13337000
CVTMFACT EQU   CVTMFRTR                                                 13338000
CVTMFCTL EQU   CVTS01+448                                               13339000
CVTPVBP  EQU   CVTS01+444                                               13340000
CVTPWI   EQU   CVTS01+440                                               13341000
CVTRV254 EQU   CVTS01+438                                               13342000
CVTRV253 EQU   CVTS01+436                                               13343000
CVTRV252 EQU   CVTS01+434                                               13344000
CVTRV251 EQU   CVTS01+433                                               13345000
CVTRV250 EQU   CVTS01+432                                               13346000
CVTRV249 EQU   CVTS01+431                                               13347000
CVTRV248 EQU   CVTS01+430                                               13348000
CVTRV247 EQU   CVTS01+429                                               13349000
CVTRV246 EQU   CVTS01+428                                               13350000
CVTRV245 EQU   CVTRV237                                                 13351000
CVTRV244 EQU   CVTRV237                                                 13352000
CVTRV243 EQU   CVTRV237                                                 13353000
CVTRV242 EQU   CVTRV237                                                 13354000
CVTRV241 EQU   CVTRV237                                                 13355000
CVTRV240 EQU   CVTRV237                                                 13356000
CVTRV239 EQU   CVTRV237                                                 13357000
CVTRV238 EQU   CVTRV237                                                 13358000
CVTRV236 EQU   CVTRV228                                                 13359000
CVTRV235 EQU   CVTRV228                                                 13360000
CVTRV234 EQU   CVTRV228                                                 13361000
CVTRV233 EQU   CVTRV228                                                 13362000
CVTRV232 EQU   CVTRV228                                                 13363000
CVTRV231 EQU   CVTRV228                                                 13364000
CVTRV230 EQU   CVTRV228                                                 13365000
CVTRV229 EQU   CVTRV228                                                 13366000
CVTRV227 EQU   CVTRV219                                                 13367000
CVTRV226 EQU   CVTRV219                                                 13368000
CVTRV225 EQU   CVTRV219                                                 13369000
CVTRV224 EQU   CVTRV219                                                 13370000
CVTRV223 EQU   CVTRV219                                                 13371000
CVTRV222 EQU   CVTRV219                                                 13372000
CVTRV221 EQU   CVTRV219                                                 13373000
CVTRV220 EQU   CVTRV219                                                 13374000
CVTRV218 EQU   CVTRV210                                                 13375000
CVTRV217 EQU   CVTRV210                                                 13376000
CVTRV216 EQU   CVTRV210                                                 13377000
CVTRV215 EQU   CVTRV210                                                 13378000
CVTRV214 EQU   CVTRV210                                                 13379000
CVTRV213 EQU   CVTRV210                                                 13380000
CVTRV212 EQU   CVTRV210                                                 13381000
CVTRV211 EQU   CVTRV210                                                 13382000
CVTLCCAT EQU   CVTS01+420                                               13383000
CVTPCCAT EQU   CVTS01+416                                               13384000
CVTIPCRP EQU   CVTS01+412                                               13385000
CVTIPCRI EQU   CVTS01+408                                               13386000
CVTIPCDS EQU   CVTS01+404                                               13387000
CVTAIDVT EQU   CVTS01+400                                               13388000
CVTSSAP  EQU   CVTS01+396                                               13389000
CVTEHCIR EQU   CVTS01+392                                               13390000
CVTEHDEF EQU   CVTS01+388                                               13391000
CVTDAIR  EQU   CVTS01+384                                               13392000
CVTPERFM EQU   CVTS01+380                                               13393000
CVT044R2 EQU   CVTS01+376                                               13394000
CVTFETCH EQU   CVTS01+372                                               13395000
CVTRSTWD EQU   CVTS01+368                                               13396000
CVTSPOST EQU   CVTS01+364                                               13397000
CVTIOBP  EQU   CVTS01+360                                               13398000
CVTASMVT EQU   CVTS01+356                                               13399000
CVTRECRQ EQU   CVTS01+352                                               13400000
CVTWSAC  EQU   CVTS01+348                                               13401000
CVTRV149 EQU   CVTS01+344                                               13402000
CVTWSAL  EQU   CVTS01+340                                               13403000
CVTSPSA  EQU   CVTS01+336                                               13404000
CVTGLMN  EQU   CVTS01+332                                               13405000
CVTVEAC0 EQU   CVTS01+328                                               13406000
CVT062R1 EQU   CVTS01+324                                               13407000
CVTRPOST EQU   CVTS01+320                                               13408000
CVTDQIQE EQU   CVTS01+316                                               13409000
CVTCSD   EQU   CVTS01+312                                               13410000
CVTLKRMA EQU   CVTS01+308                                               13411000
CVTRSPIE EQU   CVTS01+304                                               13412000
CVTRENQ  EQU   CVTS01+300                                               13413000
CVTLQCB  EQU   CVTS01+296                                               13414000
CVTFQCB  EQU   CVTS01+292                                               13415000
CVTQCS01 EQU   CVTS01+288                                               13416000
CVTAPFT  EQU   CVTS01+284                                               13417000
CVTPARRL EQU   CVTS01+280                                               13418000
CVTVWAIT EQU   CVTS01+276                                               13419000
CVTGSPL  EQU   CVTS01+272                                               13420000
CVTLSMQ  EQU   CVTS01+268                                               13421000
CVTGSMQ  EQU   CVTS01+264                                               13422000
CVTEXPRO EQU   CVTS01+260                                               13423000
CVTOPCTP EQU   CVTS01+256                                               13424000
CVTSIC   EQU   CVTS01+252                                               13425000
CVTTPIOS EQU   CVTS01+248                                               13426000
CVTRTMS  EQU   CVTS01+244                                               13427000
CVTSDBF  EQU   CVTS01+240                                               13428000
CVTSCBP  EQU   CVTS01+236                                               13429000
CVTSDMP  EQU   CVTS01+232                                               13430000
CVTSV60  EQU   CVTS01+228                                               13431000
CVTRTMCT EQU   CVTS01+224                                               13432000
CVTASCBL EQU   CVTS01+220                                               13433000
CVTASCBH EQU   CVTS01+216                                               13434000
CVTGDA   EQU   CVTS01+212                                               13435000
CVTASVT  EQU   CVTS01+208                                               13436000
CVTVVMDI EQU   CVTS01+204                                               13437000
CVTAQTOP EQU   CVTS01+200                                               13438000
CVTIOSCS EQU   CVTS01+196                                               13439000
CVTSDRM  EQU   CVTS01+192                                               13440000
CVTOPTE  EQU   CVTS01+188                                               13441000
CVTSTXU  EQU   CVTS01+184                                               13442000
CVTQUIS  EQU   CVTS01+180                                               13443000
CVTPARS  EQU   CVTS01+176                                               13444000
CVTS1EE  EQU   CVTS01+172                                               13445000
CVTFRAS  EQU   CVTS01+168                                               13446000
CVTQSAS  EQU   CVTS01+164                                               13447000
CVTCRAS  EQU   CVTS01+160                                               13448000
CVTCRMN  EQU   CVTS01+156                                               13449000
CVTDELCP EQU   CVTS01+152                                               13450000
CVTFRECL EQU   CVTS01+148                                               13451000
CVTGETCL EQU   CVTS01+144                                               13452000
CVTBLDCP EQU   CVTS01+140                                               13453000
CVTAUTHL EQU   CVTS01+136                                               13454000
CVTSCAN  EQU   CVTS01+132                                               13455000
CVTRV144 EQU   CVTS01+130                                               13456000
CVTMAXMP EQU   CVTS01+128                                               13457000
CVTSTCK  EQU   CVTS01+124                                               13458000
CVTRV139 EQU   CVTS01+123                                               13459000
CVTDSSAC EQU   CVTS01+122                                               13460000
CVTRV513 EQU   CVTS01+121                                               13461000
CVTIOSPL EQU   CVTS01+120                                               13462000
CVTPTGT  EQU   CVTS01+116                                               13463000
CVTCSPIE EQU   CVTS01+112                                               13464000
CVTSMFEX EQU   CVTS01+108                                               13465000
CVTOLT0A EQU   CVTS01+104                                               13466000
CVTSRBRT EQU   CVTS01+100                                               13467000
CVTPUTL  EQU   CVTS01+96                                                13468000
CVTASCRL EQU   CVTS01+92                                                13469000
CVTASCRF EQU   CVTS01+88                                                13470000
CVTRV326 EQU   CVTS01+84                                                13471000
CVTRV325 EQU   CVTS01+80                                                13472000
CVTRV324 EQU   CVTS01+76                                                13473000
CVT0VL01 EQU   CVTS01+72                                                13474000
CVTSHRVM EQU   CVTS01+68                                                13475000
CVTRV332 EQU   CVTS01+64                                                13476000
CVTTAS   EQU   CVTS01+60                                                13477000
CVTRSCN  EQU   CVTS01+56                                                13478000
CVTTRAC2 EQU   CVTS01+54                                                13479000
CVTTRACE EQU   CVTS01+52                                                13480000
CVTAPG   EQU   CVTS01+51                                                13481000
CVTSDTRC EQU   CVTCTLFG                                                 13482000
CVTGTRCE EQU   CVTCTLFG                                                 13483000
CVTNOMP  EQU   CVTCTLFG                                                 13484000
CVTRSV79 EQU   CVTCTLFG                                                 13485000
CVTDSTAT EQU   CVTCTLFG                                                 13486000
CVTRSV78 EQU   CVTCTLFG                                                 13487000
CVTRV333 EQU   CVTCTLFG                                                 13488000
CVTRV323 EQU   CVTCTLFG                                                 13489000
CVTSPVLK EQU   CVTS01+49                                                13490000
CVTRSV77 EQU   CVTS01+48                                                13491000
CVTRV331 EQU   CVTS01+44                                                13492000
CVTRV330 EQU   CVTS01+40                                                13493000
CVTRV329 EQU   CVTS01+36                                                13494000
CVTRV328 EQU   CVTS01+32                                                13495000
CVTRV322 EQU   CVTS01+28                                                13496000
CVTSLID  EQU   CVTSLIDA+1                                               13497000
CVTSYLK  EQU   CVTSLIDA                                                 13498000
CVTRV321 EQU   CVTS01+20                                                13499000
CVTRV320 EQU   CVTS01+16                                                13500000
CVTLPDIR EQU   CVTLPDIA+1                                               13501000
CVTRSV69 EQU   CVTDIRST                                                 13502000
CVTRSV68 EQU   CVTDIRST                                                 13503000
CVTRSV67 EQU   CVTDIRST                                                 13504000
CVTRSV66 EQU   CVTDIRST                                                 13505000
CVTRSV65 EQU   CVTDIRST                                                 13506000
CVTRSV64 EQU   CVTDIRST                                                 13507000
CVTRSV63 EQU   CVTDIRST                                                 13508000
CVTDICOM EQU   CVTDIRST                                                 13509000
CVTPVTP  EQU   CVTS01+8                                                 13510000
CVTLPDSR EQU   CVTS01+4                                                 13511000
CVTGETL  EQU   CVTS01                                                   13512000
@NM00016 EQU   RECOVER                                                  13513000
@NM00015 EQU   RECOVER                                                  13514000
@NM00014 EQU   RECOVER                                                  13515000
@NM00013 EQU   RECOVER                                                  13516000
@NM00012 EQU   RECOVER                                                  13517000
@NM00011 EQU   RECOVER                                                  13518000
@NM00010 EQU   RECOVER                                                  13519000
BYTE3    EQU   BYTES34                                                  13520000
BYTE2    EQU   BYTES234                                                 13521000
BYTE1    EQU   INTER                                                    13522000
@NM00009 EQU   BITSW                                                    13523000
DSPERR   EQU   BITSW                                                    13524000
LOOPEND  EQU   BITSW                                                    13525000
LINETWO  EQU   BITSW                                                    13526000
DSTGERR  EQU   BITSW                                                    13527000
MSG92FLG EQU   BITSW                                                    13528000
@NM00179 EQU   QCBMSG+32                                                13529000
@NM00178 EQU   QCBMSG+28                                                13530000
@NM00177 EQU   QCBMSG+26                                                13531000
@NM00176 EQU   QCBMSG+23                                                13532000
@NM00175 EQU   QCBMSG+19                                                13533000
@NM00174 EQU   QCBMSG+16                                                13534000
@NM00173 EQU   QCMCART                                                  13535000
@NM00172 EQU   QCBMSG+7                                                 13536000
@NM00171 EQU   QCBMSG+3                                                 13537000
MDRDDON  EQU   MDRDDOFF                                                 13538000
@NM00170 EQU   MDRDRDS                                                  13539000
@NM00169 EQU   DRCMSG+9                                                 13540000
@NM00166 EQU   SDGMSG+24                                                13541000
@NM00165 EQU   SDGMSG+14                                                13542000
@NM00164 EQU   SDMSAU                                                   13543000
@NM00162 EQU   SDGMSG+2                                                 13544000
@NM00161 EQU   SDMSDGN                                                  13545000
CMUCMA   EQU   CMUST2                                                   13546000
CMUONEND EQU   CMUSTAT+31                                               13547000
CMUOFEND EQU   CMUSTON+29                                               13548000
CMUSUEND EQU   CMUSTOF+25                                               13549000
@NM00159 EQU   CPUMSG+37                                                13550000
@NM00158 EQU   CPUMSG+31                                                13551000
CMSAST1  EQU   CMSAST                                                   13552000
@NM00157 EQU   CPUMSG+20                                                13553000
@NM00156 EQU   CPUMSG+17                                                13554000
@NM00155 EQU   CPUMSG+15                                                13555000
CMCPST5  EQU   CMCPSTAT+4                                               13556000
CMCPST4  EQU   CMCPSTAT+3                                               13557000
CMCPST3  EQU   CMCPSTAT+2                                               13558000
CMCPST2  EQU   CMCPSTAT+1                                               13559000
CMCPST1  EQU   CMCPSTAT                                                 13560000
@NM00152 EQU   MTRCLR+14                                                13561000
@NM00151 EQU   MTRPCT                                                   13562000
@NM00150 EQU   MTRCLR+9                                                 13563000
@NM00149 EQU   MTRCLR                                                   13564000
@NM00148 EQU   MSGTRB                                                   13565000
@NM00147 EQU   @NM00146                                                 13566000
@NM00145 EQU   @NM00144                                                 13567000
@NM00143 EQU   @NM00142                                                 13568000
@NM00141 EQU   @NM00140                                                 13569000
@NM00139 EQU   TRCCHRS                                                  13570000
TRCXX1   EQU   TRCCHKA                                                  13571000
@NM00133 EQU   MHDR+9                                                   13572000
@NM00132 EQU   MHDR+2                                                   13573000
@NM00131 EQU   MHF1                                                     13574000
MHF1B0   EQU   MHF1                                                     13575000
MHSEQ    EQU   MHDR                                                     13576000
SQTMHDRS EQU   SQTENT+32                                                13577000
SQTNU    EQU   SQTENT+24                                                13578000
SQTQCBPT EQU   SQTENT+15                                                13579000
SQTQCB   EQU   SQTENT+8                                                 13580000
SQTVVA   EQU   SQTENT+6                                                 13581000
SQTSA2   EQU   SQTENT+5                                                 13582000
SQTSDG   EQU   SQTBFLG2                                                 13583000
@NM00130 EQU   SQTBFLG2                                                 13584000
SQT2RCL  EQU   SQTBFLG2                                                 13585000
@NM00129 EQU   SQTBFLG                                                  13586000
SQTBFSA2 EQU   SQTBFLG                                                  13587000
@NM00128 EQU   SQTBFLG                                                  13588000
QCBXXXX  EQU   QCBEXT                                                   13589000
@NM00127 EQU   QCBFLG2                                                  13590000
QCBF2RS  EQU   QCBFLG2                                                  13591000
@NM00126 EQU   QCBFLG2                                                  13592000
QCBDSQ0  EQU   QCBFLG2                                                  13593000
QCBMVTP  EQU   QCB+1                                                    13594000
QCBFMVTP EQU   QCBFLG1                                                  13595000
@NM00125 EQU   QCBFLG1                                                  13596000
QCBEXC   EQU   QCBFLG1                                                  13597000
@NM00113 EQU   VESDGNDX+2                                               13598000
WC0FMPPR EQU   WC0FAPCK                                                 13599000
@NM00112 EQU   WC0FAPCK                                                 13600000
WC0FAPVL EQU   WC0FAPCK                                                 13601000
@NM00111 EQU   WC0FAPCK                                                 13602000
@NM00110 EQU   WC0FP                                                    13603000
WC0FPHIF EQU   WC0FP                                                    13604000
@NM00109 EQU   WC0FP                                                    13605000
@NM00108 EQU   WC0FINIT                                                 13606000
DRCFADR  EQU   DRCFLGS                                                  13607000
DRCFAPR  EQU   DRCFLGS                                                  13608000
DRCFVAL  EQU   DRCFLGS                                                  13609000
@NM00107 EQU   SAUCB+1                                                  13610000
@NM00106 EQU   SAFLGS                                                   13611000
SAFBSY   EQU   SAFLGS                                                   13612000
@NM00105 EQU   DRDUCB+1                                                 13613000
DRDDRC3  EQU   DRDFLGS                                                  13614000
DRDDRC2  EQU   DRDFLGS                                                  13615000
DRDDRC1  EQU   DRDFLGS                                                  13616000
DRDDRC0  EQU   DRDFLGS                                                  13617000
DRDFAPR  EQU   DRDFLGS                                                  13618000
DRDFRDY  EQU   DRDFLGS                                                  13619000
DRDFONL  EQU   DRDFLGS                                                  13620000
DRDFVAL  EQU   DRDFLGS                                                  13621000
@NM00104 EQU   DRCSA+2                                                  13622000
CONDMVTP EQU   CONFDATA+2                                               13623000
CONA2D   EQU   CONDALTP                                                 13624000
CONA2C   EQU   CONDALTP                                                 13625000
CONA2B   EQU   CONDALTP                                                 13626000
CONA2NU  EQU   CONDALTP                                                 13627000
CONA1D   EQU   CONDALTP                                                 13628000
CONA1C   EQU   CONDALTP                                                 13629000
CONA1B   EQU   CONDALTP                                                 13630000
CONA1NU  EQU   CONDALTP                                                 13631000
CONDSDG  EQU   CONDCONF                                                 13632000
CONDDTYP EQU   CONDCONF                                                 13633000
CONDVINU EQU   CONDCONF                                                 13634000
CONDNSHR EQU   CONDCONF                                                 13635000
CXSACH   EQU   CXSACUCH                                                 13636000
@NM00103 EQU   CXSACUCH                                                 13637000
CXSACU   EQU   CXSACUCH                                                 13638000
@NM00102 EQU   CONFXENT+1                                               13639000
@NM00101 EQU   CXCSCON                                                  13640000
@NM00100 EQU   CXCSCON                                                  13641000
MIDCFZZZ EQU   MIDCFLG2                                                 13642000
MIDCFIF2 EQU   MIDCFIF                                                  13643000
MIDCFIF1 EQU   MIDCFIF                                                  13644000
MIDCFZZ1 EQU   MIDCFLG1                                                 13645000
@NM00099 EQU   MIDCFLG1                                                 13646000
@NM00098 EQU   MSGBDS+13                                                13647000
@NM00097 EQU   MSGBDS                                                   13648000
@NM00096 EQU   MSGBMAP+48                                               13649000
@NM00095 EQU   MSGBMAP+33                                               13650000
@NM00094 EQU   MSGBMAP+22                                               13651000
ALTMONON EQU   ALTMONOF                                                 13652000
@NM00093 EQU   MSGBMAP+11                                               13653000
ALMSCCU  EQU   ALMSCAD+1                                                13654000
ALMSCCH  EQU   ALMSCAD                                                  13655000
@NM00092 EQU   MSGBMAP                                                  13656000
QURES1   EQU   QUFLAG                                                   13657000
QULIB    EQU   QUCODE                                                   13658000
QURES    EQU   QUERYAR+5                                                13659000
ABIT     EQU   AVAILARY                                                 13660000
OBIT     EQU   ONLINARY                                                 13661000
EBIT     EQU   EXISTARY                                                 13662000
@NM00077 EQU   DATAFLDS+33                                              13663000
@NM00076 EQU   DCONF35                                                  13664000
@NM00075 EQU   DATAFLDS+27                                              13665000
@NM00074 EQU   DATAFLDS+18                                              13666000
@NM00073 EQU   DATAFLDS+10                                              13667000
DTYPE13  EQU   DTYPE14                                                  13668000
@NM00072 EQU   DATAFLDS+3                                               13669000
@NM00071 EQU   DSSID+2                                                  13670000
@NM00070 EQU   DSSID                                                    13671000
@NM00065 EQU   MSG04TXT+14                                              13672000
@NM00064 EQU   MSG04RNG+3                                               13673000
@NM00063 EQU   MSG04CPU                                                 13674000
@NM00062 EQU   MSG04TXT                                                 13675000
LASMLLTF EQU   LASTLINE+2                                               13676000
LASTML0  EQU   LASTLINE                                                 13677000
@NM00061 EQU   BYTE022                                                  13678000
@NM00060 EQU   PABMAP                                                   13679000
STTABL   EQU   STATFLG                                                  13680000
@NM00059 EQU   STATFLG                                                  13681000
@NM00058 EQU   STATFLG                                                  13682000
@NM00057 EQU   CHAIN                                                    13683000
@NM00056 EQU   DRCDRDST                                                 13684000
DRCCSNOC EQU   DRCCSNO                                                  13685000
@NM00055 EQU   DRCDRSS                                                  13686000
@NM00054 EQU   DRCSAST                                                  13687000
@NM00053 EQU   DRCSAID+2                                                13688000
@NM00052 EQU   DRCSAID                                                  13689000
@NM00051 EQU   SDGVALS+5                                                13690000
SDGSDRU  EQU   SDGDCCST                                                 13691000
SDGDCNA  EQU   SDGDCCST                                                 13692000
SDGSANU  EQU   SDGSAST                                                  13693000
SDGSANA  EQU   SDGSAST                                                  13694000
@NM00050 EQU   CPDET+26                                                 13695000
@NM00049 EQU   CPDSDG2                                                  13696000
@NM00048 EQU   CPDSDG1                                                  13697000
@NM00047 EQU   CPDFLGS                                                  13698000
@NM00046 EQU   CPDSAST                                                  13699000
CPDENTRY EQU   CPDTAB                                                   13700000
CPHMSRDY EQU   CPHSTAT                                                  13701000
@NM00045 EQU   CPHFLGS                                                  13702000
CPHINTF2 EQU   CPHINTF                                                  13703000
CPHINTF1 EQU   CPHINTF                                                  13704000
CPHENTRY EQU   CPHTAB                                                   13705000
GMLNG    EQU   GMLEN+1                                                  13706000
UCBERADR EQU   UCBUCS+12                                                13707000
UCBFCBID EQU   UCBUCS+8                                                 13708000
UCBERCNT EQU   UCBUCS+7                                                 13709000
UCBRSV51 EQU   UCBUCS+6                                                 13710000
UCBRSV50 EQU   UCBFCBOP                                                 13711000
UCBRSV49 EQU   UCBFCBOP                                                 13712000
UCBRSV48 EQU   UCBFCBOP                                                 13713000
UCBRSV47 EQU   UCBFCBOP                                                 13714000
UCBRSV46 EQU   UCBFCBOP                                                 13715000
UCBRSV45 EQU   UCBFCBOP                                                 13716000
UCBRSV44 EQU   UCBFCBOP                                                 13717000
UCBFCBO1 EQU   UCBFCBOP                                                 13718000
UCBUCSPE EQU   UCBUCSOP                                                 13719000
UCBRSV43 EQU   UCBUCSOP                                                 13720000
UCBRSV42 EQU   UCBUCSOP                                                 13721000
UCBRSV41 EQU   UCBUCSOP                                                 13722000
UCBRSV40 EQU   UCBUCSOP                                                 13723000
UCBRSV39 EQU   UCBUCSOP                                                 13724000
UCBUCSO2 EQU   UCBUCSOP                                                 13725000
UCBUCSO1 EQU   UCBUCSOP                                                 13726000
UCBUCSID EQU   UCBUCS                                                   13727000
UCBRV073 EQU   UCB3540X+7                                               13728000
UCBRV072 EQU   UCBDKBYT                                                 13729000
UCBRV071 EQU   UCBDKBYT                                                 13730000
UCBRV070 EQU   UCBDKBYT                                                 13731000
UCBRV069 EQU   UCBDKBYT                                                 13732000
UCBRV068 EQU   UCBDKBYT                                                 13733000
UCBRV067 EQU   UCBDKBYT                                                 13734000
UCBVLVER EQU   UCBDKBYT                                                 13735000
UCBDKAMX EQU   UCBDKBYT                                                 13736000
UCBVLSER EQU   UCB3540X                                                 13737000
UCBRDATA EQU   UCBOCR+4                                                 13738000
UCBFRID  EQU   UCBOCR                                                   13739000
UCBCLN   EQU   UCBMT+14                                                 13740000
UCBERG   EQU   UCBMT+12                                                 13741000
UCBMS    EQU   UCBMT+11                                                 13742000
UCBNB    EQU   UCBMT+10                                                 13743000
UCBPW    EQU   UCBMT+9                                                  13744000
UCBPR    EQU   UCBMT+8                                                  13745000
UCBSIO   EQU   UCBMT+6                                                  13746000
UCBTW    EQU   UCBMT+5                                                  13747000
UCBTR    EQU   UCBMT+4                                                  13748000
UCBTWT   EQU   UCBMT+3                                                  13749000
UCBTRT   EQU   UCBMT+2                                                  13750000
UCBCTD   EQU   UCBMT                                                    13751000
UCBWTOID EQU   UCBCMEXT+17                                              13752000
UCBRV043 EQU   UCBCMEXT+16                                              13753000
UCBASID  EQU   UCBCMEXT+14                                              13754000
UCBMFCNT EQU   UCBCMEXT+12                                              13755000
UCBPMSK  EQU   UCBCMEXT+10                                              13756000
UCBCCWOF EQU   UCBCMEXT+8                                               13757000
UCBRV041 EQU   UCBCMEXT+6                                               13758000
UCBRV036 EQU   UCBFLP1                                                  13759000
UCBRV035 EQU   UCBFLP1                                                  13760000
UCBRV034 EQU   UCBFLP1                                                  13761000
UCBRV033 EQU   UCBFLP1                                                  13762000
UCBRV032 EQU   UCBFLP1                                                  13763000
UCBRV031 EQU   UCBFLP1                                                  13764000
UCBSHRUP EQU   UCBFLP1                                                  13765000
UCBNSRCH EQU   UCBFLP1                                                  13766000
UCBSNSCT EQU   UCBCMEXT+4                                               13767000
UCBHPDV  EQU   @NM00008                                                 13768000
UCBHALI  EQU   @NM00008                                                 13769000
UCBRSV09 EQU   @NM00008                                                 13770000
UCBRSV08 EQU   @NM00008                                                 13771000
UCBRSV07 EQU   @NM00008                                                 13772000
UCBRSV06 EQU   @NM00008                                                 13773000
UCBRSV05 EQU   @NM00008                                                 13774000
UCBRSV04 EQU   @NM00008                                                 13775000
UCBDTI   EQU   UCBCMEXT+2                                               13776000
UCBSTI   EQU   UCBCMEXT+1                                               13777000
UCBETI   EQU   UCBCMEXT                                                 13778000
UCBEXTP  EQU   UCBEXTPT+1                                               13779000
UCBDDRSW EQU   UCBFLC                                                   13780000
UCBTICBT EQU   UCBFLC                                                   13781000
UCBIVRR  EQU   UCBFLC                                                   13782000
UCBIVRS  EQU   UCBFLC                                                   13783000
UCBITF   EQU   UCBFLC                                                   13784000
UCBUDE   EQU   UCBFLC                                                   13785000
UCBWAA   EQU   UCBFLC                                                   13786000
UCBATTP  EQU   UCBFLC                                                   13787000
UCBUNTYP EQU   UCBTBYT4                                                 13788000
UCBRSV11 EQU   UCBDVCLS                                                 13789000
UCBRSV10 EQU   UCBDVCLS                                                 13790000
UCB3CHAR EQU   UCBDVCLS                                                 13791000
UCB3UREC EQU   UCBDVCLS                                                 13792000
UCB3DISP EQU   UCBDVCLS                                                 13793000
UCB3DACC EQU   UCBDVCLS                                                 13794000
UCB3COMM EQU   UCBDVCLS                                                 13795000
UCB3TAPE EQU   UCBDVCLS                                                 13796000
UCBDVPWR EQU   UCB2OPT7                                                 13797000
UCBVLPWR EQU   UCB2OPT6                                                 13798000
UCB2OPT5 EQU   UCBTBYT2                                                 13799000
UCBRVDEV EQU   UCBRWTAU                                                 13800000
UCBRPS   EQU   UCBDUDN2                                                 13801000
UCBRR    EQU   UCBDUDN1                                                 13802000
UCB2OPT1 EQU   UCBTBYT2                                                 13803000
UCB2OPT0 EQU   UCBTBYT2                                                 13804000
UCB1FEA7 EQU   UCBTBYT1                                                 13805000
UCBD6250 EQU   UCB1FEA6                                                 13806000
UCBD1600 EQU   UCB1FEA5                                                 13807000
UCB1FEA4 EQU   UCBTBYT1                                                 13808000
UCB1FEA3 EQU   UCBTBYT1                                                 13809000
UCB1FEA2 EQU   UCBTBYT1                                                 13810000
UCB1FEA1 EQU   UCBTBYT1                                                 13811000
UCB1FEA0 EQU   UCBTBYT1                                                 13812000
UCBRV029 EQU   UCBWGT                                                   13813000
UCBVHRSN EQU   UCBWGT                                                   13814000
UCBVORSN EQU   UCBWGT                                                   13815000
UCBMTPXP EQU   UCBWGT                                                   13816000
UCBREW   EQU   UCBWGT                                                   13817000
UCBPUB   EQU   UCBWGT                                                   13818000
UCBOUT   EQU   UCBWGT                                                   13819000
UCBIN    EQU   UCBWGT                                                   13820000
UCBCPU   EQU   UCBOB+11                                                 13821000
UCBLCI   EQU   UCBOB+10                                                 13822000
UCBCNT   EQU   UCBOB+9                                                  13823000
UCBRV017 EQU   UCBCHM1                                                  13824000
UCBRV016 EQU   UCBCHM1                                                  13825000
UCBRV015 EQU   UCBCHM1                                                  13826000
UCBRV014 EQU   UCBCHM1                                                  13827000
UCBSPB   EQU   UCBPTH1                                                  13828000
UCBPPB   EQU   UCBPTH1                                                  13829000
UCBSPA   EQU   UCBPTH0                                                  13830000
UCBPPA   EQU   UCBPTH0                                                  13831000
UCBFLB7  EQU   UCBFLB                                                   13832000
UCBVALPH EQU   UCBFLB                                                   13833000
UCBCRHSN EQU   UCBFLB                                                   13834000
UCBCRHRV EQU   UCBFLB                                                   13835000
UCBRESVH EQU   UCBFLB                                                   13836000
UCBSPST  EQU   UCBFLB                                                   13837000
UCBASNS  EQU   UCBFLB                                                   13838000
UCBIORST EQU   UCBFLB                                                   13839000
UCBQISCE EQU   UCBFL1                                                   13840000
UCBACTV  EQU   UCBFL1                                                   13841000
UCBSAP   EQU   UCBFL1                                                   13842000
UCBNOTRC EQU   UCBCUB                                                   13843000
UCBPSNS  EQU   UCBFL1                                                   13844000
UCBUSING EQU   UCBPST                                                   13845000
UCBBUSYD EQU   UCBBSY                                                   13846000
UCBUA    EQU   UCBCHAN+1                                                13847000
UCBCHA   EQU   UCBCHAN                                                  13848000
UCBDADI  EQU   UCBSTAT                                                  13849000
UCBSYSR  EQU   UCBSTAT                                                  13850000
UCBPRES  EQU   UCBSTAT                                                  13851000
UCBALOC  EQU   UCBSTAT                                                  13852000
UCBUNLD  EQU   UCBSTAT                                                  13853000
UCBRESV  EQU   UCBSTAT                                                  13854000
UCBCHGS  EQU   UCBSTAT                                                  13855000
UCBID    EQU   UCBOB+2                                                  13856000
UCBALTPH EQU   UCBFL5                                                   13857000
UCBALTCU EQU   UCBFL5                                                   13858000
UCBNALOC EQU   UCBFL5                                                   13859000
UCBENVRD EQU   UCBFL5                                                   13860000
UCBVSDR  EQU   UCBFL5                                                   13861000
UCBSASK  EQU   UCBFL5                                                   13862000
UCBAMV   EQU   UCBAF                                                    13863000
UCBDCC   EQU   UCBFL5                                                   13864000
UCBMONT  EQU   UCBJBNR                                                  13865000
UCBRV011 EQU   UCBJBNR                                                  13866000
UCBRSV02 EQU   UCBJBNR                                                  13867000
UCBOLDSM EQU   UCBJBNR                                                  13868000
UCBRV003 EQU   UCBJBNR                                                  13869000
UCBRV002 EQU   UCBJBNR                                                  13870000
UCBJES3  EQU   UCBJBNR                                                  13871000
UCBVRDEV EQU   UCBJBNR                                                  13872000
UCBCMSEG EQU   UCBOB                                                    13873000
UCBPFXND EQU   UCB+512                                                  13874000
UCBIOQ   EQU   UCB+508                                                  13875000
UCBLOCK  EQU   UCB+504                                                  13876000
UCBPXST  EQU   UCB+504                                                  13877000
@NM00005 EQU   UCB                                                      13878000
ICBLORD  EQU   ICBTRACE+256                                             13879000
ICBOTRC  EQU   ICBTRACE                                                 13880000
ICBRESV  EQU   ICB2SSCB+128                                             13881000
ICBVOLST EQU   ICB2SSCB+124                                             13882000
ICBVSCRA EQU   ICB2SSCB+120                                             13883000
ICBSAMP  EQU   ICB2SSCB+118                                             13884000
ICBRESVD EQU   ICB2SSCB+117                                             13885000
ICBCPUID EQU   ICB2SSCB+112                                             13886000
ICBFAB   EQU   ICB2SSCB+108                                             13887000
ICBMSSC  EQU   ICB2SSCB+104                                             13888000
ICBRSVP  EQU   ICB2SSCB+100                                             13889000
ICBAEAP  EQU   ICB2SSCB+96                                              13890000
ICBSIOBP EQU   ICB2SSCB+92                                              13891000
ICBIATNA EQU   ICB2SSCB+88                                              13892000
ICBIPRGA EQU   ICB2SSCB+84                                              13893000
ICBSRBP  EQU   ICB2SSCB+80                                              13894000
ICBVVIC  EQU   ICB2SSCB+72                                              13895000
ICBSIOP  EQU   ICB2SSCB+68                                              13896000
ICBMEP   EQU   ICB2SSCB+64                                              13897000
ICBIORCI EQU   ICB2SSCB+60                                              13898000
ICB2ACTP EQU   ICB2SSCB+56                                              13899000
ICBFG3   EQU   ICBFLG+2                                                 13900000
ICBFG2   EQU   ICBFLG+1                                                 13901000
@NM00004 EQU   ICBFG1                                                   13902000
ICBMSCA  EQU   ICBFG1                                                   13903000
ICBMSCMP EQU   ICBFG1                                                   13904000
ICBS     EQU   ICBFG1                                                   13905000
ICBB     EQU   ICBFG1                                                   13906000
ICBV     EQU   ICBFG1                                                   13907000
ICBR     EQU   ICBFG1                                                   13908000
ICBI     EQU   ICBFG1                                                   13909000
ICBNVT   EQU   ICBOPT                                                   13910000
ICBVN02P EQU   ICB2SSCB+44                                              13911000
ICBTCB   EQU   ICB2SSCB+40                                              13912000
ICBQHEAD EQU   ICB2SSCB+36                                              13913000
ICBCOMQ  EQU   ICB2SSCB+24                                              13914000
ICBIOR   EQU   ICB2SSCB+20                                              13915000
ICBCOM   EQU   ICB2SSCB+16                                              13916000
ICBACTV  EQU   ICB2SSCB+12                                              13917000
ICBECB   EQU   ICB2SSCB+8                                               13918000
ICBSSNAM EQU   ICB2SSCB                                                 13919000
CVTLEVL  EQU   CVTRELNO+2                                               13920000
CVTNUMB  EQU   CVTRELNO                                                 13921000
CVTMDL   EQU   CVTFIX+250                                               13922000
@NM00003 EQU   CVTFIX+248                                               13923000
@NM00002 EQU   CVTFIX                                                   13924000
CVTRV482 EQU   CVTXTNT2+128                                             13925000
CVTRV481 EQU   CVTXTNT2+124                                             13926000
CVTRV480 EQU   CVTXTNT2+120                                             13927000
CVTRV479 EQU   CVTXTNT2+118                                             13928000
CVTRV478 EQU   CVTXTNT2+117                                             13929000
CVTRV477 EQU   CVTXTNT2+116                                             13930000
CVTRV476 EQU   CVTXTNT2+115                                             13931000
CVTRV475 EQU   CVTXTNT2+114                                             13932000
CVTRV474 EQU   CVTRV466                                                 13933000
CVTRV473 EQU   CVTRV466                                                 13934000
CVTRV472 EQU   CVTRV466                                                 13935000
CVTRV471 EQU   CVTRV466                                                 13936000
CVTRV470 EQU   CVTRV466                                                 13937000
CVTRV469 EQU   CVTRV466                                                 13938000
CVTRV468 EQU   CVTRV466                                                 13939000
CVTRV467 EQU   CVTRV466                                                 13940000
CVTRV465 EQU   CVTRV457                                                 13941000
CVTRV464 EQU   CVTRV457                                                 13942000
CVTRV463 EQU   CVTRV457                                                 13943000
CVTRV462 EQU   CVTRV457                                                 13944000
CVTRV461 EQU   CVTRV457                                                 13945000
CVTRV460 EQU   CVTRV457                                                 13946000
CVTRV459 EQU   CVTRV457                                                 13947000
CVTRV458 EQU   CVTRV457                                                 13948000
CVTRV456 EQU   CVTXTNT2+108                                             13949000
CVTRV455 EQU   CVTXTNT2+104                                             13950000
CVTRV454 EQU   CVTXTNT2+100                                             13951000
CVTRV453 EQU   CVTXTNT2+96                                              13952000
CVTRV452 EQU   CVTXTNT2+94                                              13953000
CVTRV451 EQU   CVTXTNT2+92                                              13954000
CVTRV450 EQU   CVTXTNT2+90                                              13955000
CVTRV449 EQU   CVTXTNT2+88                                              13956000
CVTRV448 EQU   CVTXTNT2+87                                              13957000
CVTRV447 EQU   CVTXTNT2+86                                              13958000
CVTRV446 EQU   CVTRV438                                                 13959000
CVTRV445 EQU   CVTRV438                                                 13960000
CVTRV444 EQU   CVTRV438                                                 13961000
CVTRV443 EQU   CVTRV438                                                 13962000
CVTRV442 EQU   CVTRV438                                                 13963000
CVTRV441 EQU   CVTRV438                                                 13964000
CVTRV440 EQU   CVTRV438                                                 13965000
CVTRV439 EQU   CVTRV438                                                 13966000
CVTRV437 EQU   CVTRV429                                                 13967000
CVTRV436 EQU   CVTRV429                                                 13968000
CVTRV435 EQU   CVTRV429                                                 13969000
CVTRV434 EQU   CVTRV429                                                 13970000
CVTRV433 EQU   CVTRV429                                                 13971000
CVTRV432 EQU   CVTRV429                                                 13972000
CVTRV431 EQU   CVTRV429                                                 13973000
CVTRV430 EQU   CVTRV429                                                 13974000
CVTRV428 EQU   CVTXTNT2+80                                              13975000
CVTRV427 EQU   CVTXTNT2+76                                              13976000
CVTRV426 EQU   CVTXTNT2+72                                              13977000
CVTRV425 EQU   CVTXTNT2+68                                              13978000
CVTATACT EQU   CVTATCVT                                                 13979000
CVTRV423 EQU   CVTXTNT2+62                                              13980000
CVTRV422 EQU   CVTXTNT2+60                                              13981000
CVTRV421 EQU   CVTXTNT2+58                                              13982000
CVTRV420 EQU   CVTXTNT2+56                                              13983000
CVTRV419 EQU   CVTXTNT2+55                                              13984000
CVTRV418 EQU   CVTXTNT2+54                                              13985000
CVTRV417 EQU   CVTRV409                                                 13986000
CVTRV416 EQU   CVTRV409                                                 13987000
CVTRV415 EQU   CVTRV409                                                 13988000
CVTRV414 EQU   CVTRV409                                                 13989000
CVTRV413 EQU   CVTRV409                                                 13990000
CVTRV412 EQU   CVTRV409                                                 13991000
CVTRV411 EQU   CVTRV409                                                 13992000
CVTRV410 EQU   CVTRV409                                                 13993000
CVTRV408 EQU   CVTRV400                                                 13994000
CVTRV407 EQU   CVTRV400                                                 13995000
CVTRV406 EQU   CVTRV400                                                 13996000
CVTRV405 EQU   CVTRV400                                                 13997000
CVTRV404 EQU   CVTRV400                                                 13998000
CVTRV403 EQU   CVTRV400                                                 13999000
CVTRV402 EQU   CVTRV400                                                 14000000
CVTRV401 EQU   CVTRV400                                                 14001000
CVTSKTA  EQU   CVTXTNT2+44                                              14002000
CVTCCVT  EQU   CVTXTNT2+40                                              14003000
CVTRSV98 EQU   CVTXTNT2+36                                              14004000
CVTRSV97 EQU   CVTXTNT2+34                                              14005000
CVTRSV96 EQU   CVTXTNT2+32                                              14006000
CVTOLTEP EQU   CVTXTNT2+28                                              14007000
CVTQIDA  EQU   CVTQID+1                                                 14008000
CVTRSV95 EQU   CVTQID                                                   14009000
CVTRSV94 EQU   CVTXTNT2+20                                              14010000
CVTRSV93 EQU   CVTXTNT2+16                                              14011000
CVTRSV92 EQU   CVTXTNT2+12                                              14012000
CVTDEBVR EQU   CVTXTNT2+8                                               14013000
CVTRSV91 EQU   CVTXTNT2+6                                               14014000
CVTRSV9H EQU   CVTFLGBT                                                 14015000
CVTRSV9G EQU   CVTFLGBT                                                 14016000
CVTRSV9F EQU   CVTFLGBT                                                 14017000
CVTRSV9E EQU   CVTFLGBT                                                 14018000
CVTRSV9D EQU   CVTFLGBT                                                 14019000
CVTRSV9C EQU   CVTFLGBT                                                 14020000
CVTVME   EQU   CVTFLGBT                                                 14021000
CVTNPE   EQU   CVTFLGBT                                                 14022000
CVTNUCLS EQU   CVTXTNT2+4                                               14023000
CVTDSSVA EQU   CVTDSSV+1                                                14024000
CVTRSV89 EQU   CVTDSSV                                                  14025000
CVTRSV88 EQU   CVTXTNT1+8                                               14026000
CVTRSV87 EQU   CVTXTNT1+4                                               14027000
CVTFACHN EQU   CVTXTNT1                                                 14028000
CVTRV488 EQU   CVTMAP+412                                               14029000
CVTRV487 EQU   CVTMAP+408                                               14030000
CVTRV486 EQU   CVTMAP+404                                               14031000
CVTRV485 EQU   CVTMAP+400                                               14032000
CVTACTAP EQU   CVTMAP+396                                               14033000
CVTAUTH  EQU   CVTMAP+392                                               14034000
CVTATMCA EQU   CVTATMCT+1                                               14035000
CVTATMST EQU   CVTATMCT                                                 14036000
CVTRSV61 EQU   CVTMAP+384                                               14037000
CVTVOLT1 EQU   CVTVOLM1+1                                               14038000
CVTVOLI1 EQU   CVTVOLF1                                                 14039000
CVTSTOA  EQU   CVTMAP+376                                               14040000
CVTRSV58 EQU   CVTMAP+374                                               14041000
CVTRSV57 EQU   CVTMAP+372                                               14042000
CVTDDCE  EQU   CVTMAP+368                                               14043000
CVTPNWFR EQU   CVTMAP+364                                               14044000
CVTSMF   EQU   CVTMAP+360                                               14045000
CVTSULK  EQU   CVTMAP+358                                               14046000
CVTSLKO  EQU   CVTSYSK                                                  14047000
CVTSLKP  EQU   CVTSYSK                                                  14048000
CVTSLKQ  EQU   CVTSYSK                                                  14049000
CVTSLKR  EQU   CVTSYSK                                                  14050000
CVTRSV56 EQU   CVTSYSK                                                  14051000
CVTRSV55 EQU   CVTSYSK                                                  14052000
CVTRSV54 EQU   CVTSYSK                                                  14053000
CVTRSV53 EQU   CVTSYSK                                                  14054000
CVTRSV52 EQU   CVTA1F1                                                  14055000
CVTRSV51 EQU   CVTA1F1                                                  14056000
CVTRSV50 EQU   CVTA1F1                                                  14057000
CVTRSV49 EQU   CVTA1F1                                                  14058000
CVTRSV48 EQU   CVTA1F1                                                  14059000
CVTRSV47 EQU   CVTA1F1                                                  14060000
CVTSRSW  EQU   CVTA1F1                                                  14061000
CVTPFSW  EQU   CVTA1F1                                                  14062000
CVTPCVT  EQU   CVTMAP+352                                               14063000
CVTRSV46 EQU   CVTMAP+344                                               14064000
CVTRSV45 EQU   CVTMAP+340                                               14065000
CVTRSV44 EQU   CVTMAP+338                                               14066000
CVTRSV43 EQU   CVTMAP+336                                               14067000
CVTHJESA EQU   CVTHJES+1                                                14068000
CVTRSV42 EQU   CVTHJES                                                  14069000
CVTEXT2A EQU   CVTEXT2+1                                                14070000
CVTRSV41 EQU   CVTEXT2                                                  14071000
CVTAPFA  EQU   CVTAPF+1                                                 14072000
CVTRSV40 EQU   CVTAPF                                                   14073000
CVTRV518 EQU   CVTINTLA                                                 14074000
CVTRV517 EQU   CVTERPV                                                  14075000
CVTEORM  EQU   CVTMAP+312                                               14076000
CVTMCHPR EQU   CVTMAP+308                                               14077000
CVTTZ    EQU   CVTMAP+304                                               14078000
CVTJEPS  EQU   CVTMAP+300                                               14079000
CVTJESCT EQU   CVTMAP+296                                               14080000
CVTMODE  EQU   CVTMAP+292                                               14081000
CVTPTRV  EQU   CVTMAP+288                                               14082000
CVTREAL  EQU   CVTMAP+284                                               14083000
CVTRSV39 EQU   CVTMAP+280                                               14084000
CVTRSV38 EQU   CVTMAP+276                                               14085000
CVTDMSRA EQU   CVTDMSR+1                                                14086000
CVTRV634 EQU   CVTDMSRF                                                 14087000
CVTRV633 EQU   CVTDMSRF                                                 14088000
CVTRV632 EQU   CVTDMSRF                                                 14089000
CVTRV631 EQU   CVTDMSRF                                                 14090000
CVTRV630 EQU   CVTDMSRF                                                 14091000
CVTRV629 EQU   CVTDMSRF                                                 14092000
CVTUDUMP EQU   CVTDMSRF                                                 14093000
CVTSDUMP EQU   CVTDMSRF                                                 14094000
CVTQMSGA EQU   CVTQMSG+1                                                14095000
CVTRSV36 EQU   CVTQMSG                                                  14096000
CVTAMFF  EQU   CVTMAP+264                                               14097000
CVTPURGA EQU   CVTPURG+1                                                14098000
CVTRSV35 EQU   CVTPURG                                                  14099000
CVTCBSP  EQU   CVTMAP+256                                               14100000
CVTATERA EQU   CVTATER+1                                                14101000
CVTSYST  EQU   CVTATER                                                  14102000
CVTVOLT2 EQU   CVTTAT                                                   14103000
CVTVOLI2 EQU   CVTVOLF2                                                 14104000
CVTAQAVB EQU   CVTAQAVT+1                                               14105000
CVTRSV34 EQU   CVTTCMFG                                                 14106000
CVTRSV33 EQU   CVTTCMFG                                                 14107000
CVTRSV32 EQU   CVTTCMFG                                                 14108000
CVTRSV31 EQU   CVTTCMFG                                                 14109000
CVTRSV30 EQU   CVTTCMFG                                                 14110000
CVTRSV29 EQU   CVTTCMFG                                                 14111000
CVTLDEV  EQU   CVTTCMFG                                                 14112000
CVTTCRDY EQU   CVTTCMFG                                                 14113000
CVTGTFA  EQU   CVTGTF+1                                                 14114000
CVTRSV27 EQU   CVTGTFST                                                 14115000
CVTRNIO  EQU   CVTGTFST                                                 14116000
CVTUSR   EQU   CVTGTFST                                                 14117000
CVTRV318 EQU   CVTFORM                                                  14118000
CVTRV317 EQU   CVTTMODE                                                 14119000
CVTRV316 EQU   CVTSTATE                                                 14120000
CVTRV315 EQU   CVTGTFS                                                  14121000
CVTGTFAV EQU   CVTGTFS                                                  14122000
CVT0SCR1 EQU   CVTMAP+232                                               14123000
CVTRV515 EQU   CVTMAP+228                                               14124000
CVTRMS   EQU   CVTMAP+224                                               14125000
CVTPATCH EQU   CVTMAP+220                                               14126000
CVTTSCE  EQU   CVTMAP+216                                               14127000
CVTLNKSC EQU   CVTMAP+214                                               14128000
CVTQABST EQU   CVTMAP+212                                               14129000
CVTMDLDS EQU   CVTMAP+208                                               14130000
CVTUSER  EQU   CVTMAP+204                                               14131000
CVTABEND EQU   CVTMAP+200                                               14132000
CVTSMCA  EQU   CVTMAP+196                                               14133000
CVTRSV18 EQU   CVTMAP+192                                               14134000
CVTQLPAQ EQU   CVTMAP+188                                               14135000
CVTQCDSR EQU   CVTMAP+184                                               14136000
CVTRSV17 EQU   CVTOPTB                                                  14137000
CVTRSV16 EQU   CVTOPTB                                                  14138000
CVTFP    EQU   CVTOPTB                                                  14139000
CVTAPTHR EQU   CVTOPTB                                                  14140000
CVTNLOG  EQU   CVTOPTB                                                  14141000
CVTTOD   EQU   CVTOPTB                                                  14142000
CVTCTIMS EQU   CVTOPTB                                                  14143000
CVTPROT  EQU   CVTOPTB                                                  14144000
CVTXPFP  EQU   CVTOPTA                                                  14145000
CVTASCII EQU   CVTOPTA                                                  14146000
CVTRSV13 EQU   CVTOPTA                                                  14147000
CVTRSV12 EQU   CVTOPTA                                                  14148000
CVTNIP   EQU   CVTOPTA                                                  14149000
CVTDDR   EQU   CVTOPTA                                                  14150000
CVTAPR   EQU   CVTOPTA                                                  14151000
CVTCCH   EQU   CVTOPTA                                                  14152000
CVTSNCTR EQU   CVTMAP+180                                               14153000
CVTQMWR  EQU   CVTMAP+176                                               14154000
CVTQOCR  EQU   CVTMAP+172                                               14155000
CVT1EF00 EQU   CVTMAP+168                                               14156000
CVTMZ00  EQU   CVTMAP+164                                               14157000
CVTSV76Q EQU   CVTSV76C                                                 14158000
CVTRSV11 EQU   CVTMAP+156                                               14159000
CVT0PT01 EQU   CVTMAP+152                                               14160000
CVTMSER  EQU   CVTMAP+148                                               14161000
CVTRV516 EQU   CVTIERLC                                                 14162000
CVTILCH  EQU   CVTMAP+140                                               14163000
CVT0DS   EQU   CVTMAP+136                                               14164000
CVTFBOSV EQU   CVTMAP+132                                               14165000
CVTNUCB  EQU   CVTMAP+128                                               14166000
CVTIXAVL EQU   CVTMAP+124                                               14167000
CVTSV76M EQU   CVTIOQET                                                 14168000
CVTDCBA  EQU   CVTMAP+117                                               14169000
CVTMVS2  EQU   CVTDCB                                                   14170000
CVT6DAT  EQU   CVTDCB                                                   14171000
CVT4MPS  EQU   CVTDCB                                                   14172000
CVTRSV09 EQU   CVTDCB                                                   14173000
CVT4MS1  EQU   CVTDCB                                                   14174000
CVT2SPS  EQU   CVTDCB                                                   14175000
CVT1SSS  EQU   CVTDCB                                                   14176000
CVTRSV08 EQU   CVTDCB                                                   14177000
CVTSTB   EQU   CVTMAP+112                                               14178000
CVTQTD00 EQU   CVTMAP+108                                               14179000
CVTQTE00 EQU   CVTMAP+104                                               14180000
CVTCUCB  EQU   CVTMAP+100                                               14181000
CVTSJQ   EQU   CVTMAP+96                                                14182000
CVTPBLDL EQU   CVTMAP+92                                                14183000
CVTTPC   EQU   CVTMAP+88                                                14184000
CVTSVDCB EQU   CVTMAP+84                                                14185000
CVTBRET  EQU   CVTMAP+82                                                14186000
CVTEXIT  EQU   CVTMAP+80                                                14187000
CVT0FN00 EQU   CVTMAP+76                                                14188000
CVTDARA  EQU   CVTDAR+1                                                 14189000
CVTRSV07 EQU   CVTFLGS1                                                 14190000
CVTRSV06 EQU   CVTFLGS1                                                 14191000
CVTRSV05 EQU   CVTFLGS1                                                 14192000
CVTRSV04 EQU   CVTFLGS1                                                 14193000
CVTRSV03 EQU   CVTFLGS1                                                 14194000
CVTRSV02 EQU   CVTFLGS1                                                 14195000
CVTRSV01 EQU   CVTFLGS1                                                 14196000
CVTDMPLK EQU   CVTFLGS1                                                 14197000
CVTXITP  EQU   CVTMAP+68                                                14198000
CVTZDTAB EQU   CVTMAP+64                                                14199000
CVTMSLT  EQU   CVTMAP+60                                                14200000
CVTDATE  EQU   CVTMAP+56                                                14201000
CVTBTERM EQU   CVTMAP+52                                                14202000
CVTSYSAD EQU   CVTMAP+48                                                14203000
CVTXTLER EQU   CVTMAP+44                                                14204000
CVTILK2  EQU   CVTMAP+40                                                14205000
CVTILK1  EQU   CVTMAP+36                                                14206000
CVTPRLTV EQU   CVTMAP+32                                                14207000
CVTPCNVT EQU   CVTMAP+28                                                14208000
CVT0VL00 EQU   CVTMAP+24                                                14209000
CVTXAPG  EQU   CVTMAP+20                                                14210000
CVTBUF   EQU   CVTMAP+16                                                14211000
CVTJOB   EQU   CVTMAP+12                                                14212000
CVTLINK  EQU   CVTMAP+8                                                 14213000
CVT0EF00 EQU   CVTMAP+4                                                 14214000
CVTTCBP  EQU   CVTMAP                                                   14215000
CVT      EQU   CVTMAP                                                   14216000
VVIUNUSD EQU   VVICB+116                                                14217000
VVINUSDC EQU   VVICB+112                                                14218000
VVITPFCH EQU   VVICB+108                                                14219000
VVIDVMEL EQU   VVICB+104                                                14220000
VVIVBSTF EQU   VVICB+100                                                14221000
VVISSOBA EQU   VVICB+96                                                 14222000
VVIVSCRA EQU   VVICB+92                                                 14223000
VVISTPTB EQU   VVICB+88                                                 14224000
VVIDVMTA EQU   VVICB+84                                                 14225000
VVIJUCB  EQU   VVICB+80                                                 14226000
VVIIUCB  EQU   VVICB+76                                                 14227000
VVIRES6  EQU   VVICB+72                                                 14228000
VVIRES5  EQU   VVICB+68                                                 14229000
VVIRES4  EQU   VVICB+64                                                 14230000
VVIVJL   EQU   VVICB+56                                                 14231000
VVIVRR   EQU   VVICB+52                                                 14232000
VVIQLSPL EQU   VVICB+48                                                 14233000
VVIQRPL2 EQU   VVICB+44                                                 14234000
VVIQRPL1 EQU   VVICB+40                                                 14235000
VVIVTRK  EQU   VVICB+37                                                 14236000
VVIOPCD  EQU   VVICB+36                                                 14237000
VVIVQMP  EQU   VVICB+32                                                 14238000
VVIECB1  EQU   VVICB+28                                                 14239000
VVICATAD EQU   VVICB+24                                                 14240000
VVIDCBAD EQU   VVICB+20                                                 14241000
VVIACBAD EQU   VVICB+16                                                 14242000
VVIFLG7  EQU   VVIFLGA                                                  14243000
VVIFLG6  EQU   VVIFLGA                                                  14244000
VVIFLG5  EQU   VVIFLGA                                                  14245000
VVIFLG4  EQU   VVIFLGA                                                  14246000
VVIFLG3  EQU   VVIFLGA                                                  14247000
VVIALCON EQU   VVICB+14                                                 14248000
VVICPUID EQU   VVICB+12                                                 14249000
VVIUCAT  EQU   VVICB+4                                                  14250000
VVICID   EQU   VVICB                                                    14251000
WPLMLLT2 EQU   WPLMLLTF+1                                               14252000
WPLRSV24 EQU   WPLMLLT1                                                 14253000
WPLRSV23 EQU   WPLMLLT1                                                 14254000
WPLRSV22 EQU   WPLMLLT1                                                 14255000
WPLRSV21 EQU   WPLMLLT1                                                 14256000
WPLMLLTB EQU   WPLMLLT1                                                 14257000
WPLMLLTA EQU   WPLMLLT1                                                 14258000
WPLLTF2  EQU   WPLLTF+1                                                 14259000
WPLRSV20 EQU   WPLLTF1                                                  14260000
WPLRSV19 EQU   WPLLTF1                                                  14261000
WPLRSV18 EQU   WPLLTF1                                                  14262000
WPLRSV17 EQU   WPLLTF1                                                  14263000
WPLLTFD  EQU   WPLLTF1                                                  14264000
WPLLTFB  EQU   WPLLTF1                                                  14265000
WPLQID   EQU   WPLFLGS+6                                                14266000
WPLRSV32 EQU   WPLMSGT2                                                 14267000
WPLRSV31 EQU   WPLMSGT2                                                 14268000
WPLRSV30 EQU   WPLMSGT2                                                 14269000
WPLRSV29 EQU   WPLMSGT2                                                 14270000
WPLRSV28 EQU   WPLMSGT2                                                 14271000
WPLRSV27 EQU   WPLMSGT2                                                 14272000
WPLRSV26 EQU   WPLMSGT2                                                 14273000
WPLRSV25 EQU   WPLMSGT2                                                 14274000
WPLRSV16 EQU   WPLMSGT1                                                 14275000
WPLRSV15 EQU   WPLMSGT1                                                 14276000
WPLMSGTF EQU   WPLMSGT1                                                 14277000
WPLRSV14 EQU   WPLMSGT1                                                 14278000
WPLMSGTD EQU   WPLMSGT1                                                 14279000
WPLMSGTC EQU   WPLMSGT1                                                 14280000
WPLMSGTB EQU   WPLMSGT1                                                 14281000
WPLMSGTA EQU   WPLMSGT1                                                 14282000
WPLRSV13 EQU   WPLROUT2                                                 14283000
WPLROUTO EQU   WPLROUT2                                                 14284000
WPLROUTN EQU   WPLROUT2                                                 14285000
WPLROUTM EQU   WPLROUT2                                                 14286000
WPLROUTL EQU   WPLROUT2                                                 14287000
WPLROUTK EQU   WPLROUT2                                                 14288000
WPLROUTJ EQU   WPLROUT2                                                 14289000
WPLROUTI EQU   WPLROUT2                                                 14290000
WPLROUTH EQU   WPLROUT1                                                 14291000
WPLROUTG EQU   WPLROUT1                                                 14292000
WPLROUTF EQU   WPLROUT1                                                 14293000
WPLROUTE EQU   WPLROUT1                                                 14294000
WPLROUTD EQU   WPLROUT1                                                 14295000
WPLROUTC EQU   WPLROUT1                                                 14296000
WPLROUTA EQU   WPLROUT1                                                 14297000
WPLRSV12 EQU   WPLDESC2                                                 14298000
WPLRSV11 EQU   WPLDESC2                                                 14299000
WPLRSV10 EQU   WPLDESC2                                                 14300000
WPLRSV09 EQU   WPLDESC2                                                 14301000
WPLRSV08 EQU   WPLDESC2                                                 14302000
WPLRSV07 EQU   WPLDESC2                                                 14303000
WPLDESCJ EQU   WPLDESC2                                                 14304000
WPLDESCG EQU   WPLDESC1                                                 14305000
WPLDESCF EQU   WPLDESC1                                                 14306000
WPLDESCD EQU   WPLDESC1                                                 14307000
WPLDESCC EQU   WPLDESC1                                                 14308000
WPLDESCB EQU   WPLDESC1                                                 14309000
WPLDESCA EQU   WPLDESC1                                                 14310000
WPLTXTL  EQU   WPLTXT+125                                               14311000
@NM00001 EQU   WPLTXT                                                   14312000
WPLRSV05 EQU   WPLMCSF2                                                 14313000
WPLRSV04 EQU   WPLMCSF2                                                 14314000
WPLMCSFN EQU   WPLMCSF2                                                 14315000
WPLRSV03 EQU   WPLMCSF2                                                 14316000
WPLNOWTP EQU   WPLMCSF2                                                 14317000
WPLMCSFK EQU   WPLMCSF2                                                 14318000
WPLMCSFI EQU   WPLMCSF2                                                 14319000
WPLMCSFH EQU   WPLMCSF1                                                 14320000
WPLMCSFG EQU   WPLMCSF1                                                 14321000
WPLMCSFF EQU   WPLMCSF1                                                 14322000
WPLMCSFE EQU   WPLMCSF1                                                 14323000
WPLMCSFD EQU   WPLMCSF1                                                 14324000
WPLRECB  EQU   WPLRF+4                                                  14325000
WPLRPTRA EQU   WPLRPTR+1                                                14326000
WPLRLN   EQU   WPLRPTR                                                  14327000
CWBAUTH  EQU   CWB+137                                                  14328000
CWBVBCDE EQU   CWB+8                                                    14329000
CWBFLGTH EQU   CWBFREE+1                                                14330000
CWBCHAIN EQU   CWB                                                      14331000
*                                      END UNREFERENCED COMPONENTS      14332000
@RC00270 EQU   @RC00255                                                 14333000
@RC00268 EQU   @RC00255                                                 14334000
@RC00258 EQU   @RC00255                                                 14335000
@RC00477 EQU   @RC00474                                                 14336000
@RC00486 EQU   @RC00474                                                 14337000
@RF00521 EQU   @RC00518                                                 14338000
@RF00575 EQU   @RC00572                                                 14339000
@RF00558 EQU   @RC00452                                                 14340000
@RF00603 EQU   @RC00589                                                 14341000
@RC00804 EQU   @RC00798                                                 14342000
@RC00972 EQU   @RC00967                                                 14343000
@RF00988 EQU   @RC00967                                                 14344000
@RF01018 EQU   @RC01006                                                 14345000
@RF01105 EQU   @RC01100                                                 14346000
@RF01181 EQU   @RC01176                                                 14347000
@RC01428 EQU   @RC01427                                                 14348000
@RC01542 EQU   @RC01538                                                 14349000
@RC01613 EQU   @RC01597                                                 14350000
@RF01617 EQU   @RC01597                                                 14351000
@RF01621 EQU   @RC01597                                                 14352000
@RF01668 EQU   @RC01663                                                 14353000
@RC01780 EQU   @RC01779                                                 14354000
@RF01946 EQU   @RC01942                                                 14355000
@RC01983 EQU   @RC01982                                                 14356000
@RF02058 EQU   @RC02044                                                 14357000
@RC02128 EQU   @RC02127                                                 14358000
@RC02296 EQU   @RC02295                                                 14359000
@RF02546 EQU   @RC02541                                                 14360000
@RC02544 EQU   @RC02541                                                 14361000
@RF00278 EQU   @RC00270                                                 14362000
@RF00491 EQU   @RC00486                                                 14363000
@RF00815 EQU   @RC00804                                                 14364000
@ENDDATA EQU   *                                                        14365000
         END   ICBMSG56,(C'PLS1109',0701,78180)                         14366000
