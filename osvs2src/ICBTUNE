* %/* START OF SPECIFICATIONS****                              @Y30LB02 00050003
.*                                                             @Y30LB02 00100003
.*01   MODULE-NAME = ICBTUNE                                   @Y30LB02 00150003
.*                                                             @Y30LB02 00200003
.*01   DESCRIPTIVE-NAME = TUNING MACRO                         @Y30LB02 00250003
.*                                                             @Y30LB02 00300003
.*01   COPYRIGHT = NONE                                        @Y30LB02 00350003
.*                                                             @Y30LB02 00400003
.*01   FUNCTION = THIS MACRO WILL CAUSE TUNING                 @Y30LB02 00450003
.*     PARAMETERS TO BE MODIFIED OR DISPLAYED                  @Y30LB02 00500003
.*                                                             @Y30LB02 00550003
.*01   STATUS = OS/VS1 RELEASE 4, OS/VS2 RELEASE 3             @Y30LB02 00600003
.*                                                             @Y30LB02 00650003
.*01   NOTES = AS FOLLOWS:                                     @Y30LB02 00700003
.*                                                             @Y30LB02 00750003
.*02     CODE = MACRO IS BILINGUALLY CODED                     @Y30LB02 00800003
.*                                                             @Y30LB02 00850003
.*02     RESTRICTIONS = THE FOLLOWING PREFIXES SHOULD BE       @Y30LB02 00900003
.*                      AVOIDED IN THE USER'S INVOCATION:      @Y30LB02 00950003
.*                      ICB AND TUN                            @Y30LB02 01000003
.*                                                             @Y30LB02 01050003
.*02     REGISTER-CONVENTIONS = FOLLOWS NORMAL USE OF          @Y30LB02 01100003
.*                              REGISTERS BY MACROS:           @Y30LB02 01150003
.*                              R0,R1,R14, AND R15             @Y30LB02 01200003
.*                                                             @Y30LB02 01250003
.*01   MODULE-TYPE = MACRO                                     @Y30LB02 01300003
.*                                                             @Y30LB02 01350003
.*02     PROCESSOR = ASSEMBLER AND PLS                         @Y30LB02 01400003
.*                                                             @Y30LB02 01450003
.*02     ATTRIBUTES = REUSABLE                                 @Y30LB02 01500003
.*                                                             @Y30LB02 01550003
.*02     ENTRY-POINT = ICBTUNE                                 @Y30LB02 01600003
.*                                                             @Y30LB02 01650003
.*02     LINKAGE = SVC 126                                     @Y30LB02 01700003
.*                                                             @Y30LB02 01750003
.*01  INPUT =                                                  @Y30LB02 01800003
.*                                                             @Y30LB02 01850003
.*  THE TUNING REQUEST IS ISSUED IF A HOST WISHES TO           @Y30LB02 01900003
.*  TO UPDATE SPECIFIED LRU TUNING PARAMETERS.  THIS           @Y30LB02 01950003
.*  FUNCTION ALSO HAS THE CAPABILITY TO DISPLAY SPECIFIC       @Y30LB02 02000003
.*  LRU TUNING PARAMETERS.                                     @Y30LB02 02050003
.*                                                             @Y30LB02 02100003
.*   MACRO SYNTAX                                              @Y30LB02 02150003
.*                                                             @Y30LB02 02200003
.*   LIST FORM                                                 @Y30LB02 02250003
.*                                                             @Y30LB02 02300003
.* VERB    REQUIRED PARMS        OPTIONAL PARMS                @Y30LB02 02350003
.*                                                             @Y30LB02 02400003
.*ICBTUNE  MF=L - (BAL)          MF=(L,MAP) - BAL              @Y30LB02 02450003
.*         MF(L,NAME/(R))-PLS    MF(L,NAME/(R),ATTR)-PLS       @Y30LB02 02500003
.*                                                             @Y30LB02 02550003
.*   STANDARD FORM                                             @Y30LB02 02600003
.*                                                             @Y30LB02 02650003
.* VERB    REQUIRED PARMS        OPTIONAL PARMS                @Y30LB02 02700003
.*                                                             @Y30LB02 02750003
.*ICBTUNE  FLAGS=ADDR/(R)        SDGNUM=ADDR/(R)               @Y30LB02 02800003
.*                               ECB=ADDR/(R)                  @Y30LB02 02850003
.*                               DATA=ADDR/(R)                 @Y30LB02 02900003
.*                                                             @Y30LB02 02950003
.* EXECUTE FORM                                                @Y30LB02 03000003
.*                                                             @Y30LB02 03050003
.* VERB    REQUIRED PARMS        OPTIONAL PARMS                @Y30LB02 03100003
.*                                                             @Y30LB02 03150003
.*ICBTUNE  MF(E,NAME/(R)        MF(E,NAME/(R),COMPLETE)-PLS    @Y30LB02 03200003
.*                              ECB=ADDR/(R)                   @Y30LB02 03250003
.*                              SDGNUM=ADDR/(R)                @Y30LB02 03300003
.*                              DATA=ADDR/(R)                  @Y30LB02 03350003
.*                              FLAGS=ADDR/(R)                 @Y30LB02 03400003
.*                                                             @Y30LB02 03450003
.*  RESTRICTION:                                               @Y30LB02 03500003
.*                                                             @Y30LB02 03550003
.*  THE MF PARAMETER IS SPECIFIED WITH THE LIST AND            @Y30LB02 03600003
.*  EXECUTE FORMS.  THE DEFAULT (NULL) WILL REPRESENT          @Y30LB02 03650003
.*  STANDARD FORM.  IF STANDARD FORM IS INDICATED, THEN        @Y30LB02 03700003
.*  THE FLAGS PARAMETER IS NOT OPTIONAL.                       @Y30LB02 03750003
.*                                                             @Y30LB02 03800003
.*   KEYWORD PARAMETERS:                                       @Y30LB02 03850003
.*                                                             @Y30LB02 03900003
.*   MF  -  MACRO FORMAT: THIS PARAMETER DESCRIBES THE         @Y30LB02 03950003
.*          MACRO FORMAT AND MAY GIVE THE ADDRESS OR           @Y30LB02 04000003
.*          ADDRESS IN A REGISTER WHERE THE REQUEST BLOCK      @Y30LB02 04050003
.*          IS STORED.                                         @Y30LB02 04100003
.*                                                             @Y30LB02 04150003
.*          L - LIST FORM: THE EXPANSION OF THE L-FORM         @Y30LB02 04200003
.*              MACRO WILL RESULT IN A REQUEST BLOCK WITH      @Y30LB02 04250003
.*              THE ONLY NON-ZERO FIELDS BEING THE OPCODE      @Y30LB02 04300003
.*              AND LENGTH FIELDS.                             @Y30LB02 04350003
.*                                                             @Y30LB02 04400003
.*          (1) 'MAP' - IF MAP IS SPECIFIED WITH THE           @Y30LB02 04450003
.*              ASSEMBLER MACRO CALL A DSECT EQUIVALENT TO     @Y30LB02 04500003
.*              A MAPPING MACRO IS PRODUCED.                   @Y30LB02 04550003
.*                                                             @Y30LB02 04600003
.*          (2) NAME - THE MACRO INVOKER MUST SPECIFY A        @Y30LB02 04650003
.*              NAME FOR HIS STRUCTURE WHEN INVOKING THE       @Y30LB02 04700003
.*              PLS LIST FORM.                                 @Y30LB02 04750003
.*                                                             @Y30LB02 04800003
.*          (3) ATTRIBUTE - THE MACRO WILL PLACE ANY PLS       @Y30LB02 04850003
.*              ATTRIBUTE SPECIFIED IN THE MACRO INVOCATION    @Y30LB02 04900003
.*              IN AN UNINITIALIZED REQUEST BLOCK.  ATTRI-     @Y30LB02 04950003
.*              BUTE EXAMPLE:                                  @Y30LB02 05000003
.*                                                             @Y30LB02 05050003
.*              CHAR, FIXED, STATIC LOCAL, NONLOCAL,           @Y30LB02 05100003
.*              BASED(*), ETC.                                 @Y30LB02 05150003
.*                                                             @Y30LB02 05200003
.*       NULL - STANDARD FORM: THE EXPANSION OF THIS FORM      @Y30LB02 05250003
.*              CONSISTS OF A REQUEST BLOCK, A LINKAGE         @Y30LB02 05300003
.*              INSTRUCTION, AND, POSSIBLY, PARAMETER          @Y30LB02 05350003
.*              BINDING INSTRUCTION.                           @Y30LB02 05400003
.*                                                             @Y30LB02 05450003
.*          E - EXECUTABLE FORM: THE EXPANSION OF THIS FORM    @Y30LB02 05500003
.*              CONSISTS OF A LINKAGE INSTRUCTION AND          @Y30LB02 05550003
.*              POSSIBLY, PARAMETER BINDING INSTRUCTIONS.      @Y30LB02 05600003
.*                                                             @Y30LB02 05650003
.*              SUB-PARAMETERS                                 @Y30LB02 05700003
.*                                                             @Y30LB02 05750003
.*              (1)  AN E MUST BE SPECIFIED IN THE FIRST       @Y30LB02 05800003
.*                   SUB-PARAMETER POSITION.  THIS INDICATES   @Y30LB02 05850003
.*                   THAT THE MACRO IS IN EXECUTABLE FORM.     @Y30LB02 05900003
.*                                                             @Y30LB02 05950003
.*              (2)  A NAME OR A REGISTER MUST BE SPECIFIED    @Y30LB02 06000003
.*                   IN THE SECOND SUB-PARAMETER.              @Y30LB02 06050003
.*                                                             @Y30LB02 06100003
.*              (3)  'COMPLETE' - COMPLETE WILL CAUSE THE      @Y30LB02 06150003
.*                   MACRO TO ZERO OUT THE REQUEST BLOCK.      @Y30LB02 06200003
.*                   AFTER ZEROING THE REQUEST BLOCK THE       @Y30LB02 06250003
.*                   FUNCTION OPCODE AND LENGTH ARE PLACED     @Y30LB02 06300003
.*                   IN THE REQUEST BLOCK.                     @Y30LB02 06350003
.*                                                             @Y30LB02 06400003
.*  FLAGS - A 2 BYTE FIELD WHICH INDICATES THE FUNCTION TO     @Y30LB02 06450003
.*          BE PERFORMED.  (BITS 8, 9, 10 ARE MUTUALLY EX-     @Y30LB02 06500003
.*          EXCLUSIVE)  THE FORMAT OF THE FLAGS FIELD IS AS    @Y30LB02 06550003
.*          FOLLOWS:                                           @Y30LB02 06600003
.*                                                             @Y30LB02 06650003
.*  -----------------------------------------                  @Y30LB02 06700003
.*  | X |0|0|0|0|0|0|0| X | X | X |0|0|0|0|0|                  @Y30LB02 06750003
.*  -----------------------------------------                  @Y30LB02 06800003
.*                                                             @Y30LB02 06850003
.*  BIT 0-------'1'B    MODIFY MODE                            @Y30LB02 06900003
.*              '0'B    DISPLAY MODE                           @Y30LB02 06950003
.*                                                             @Y30LB02 07000003
.*  BITS 1-7---         |RESERVED AND MUST BE ZERO|            @Y30LB02 07050003
.*                                                             @Y30LB02 07100003
.*  BIT 8-------'1'B    DISPLAY OR MODIFY THRESHOLDS           @Y30LB02 07150003
.*              '0'B    NO FUNCTION (DEFAULT)                  @Y30LB02 07200003
.*                                                             @Y30LB02 07250003
.*  BIT 9-------'1'B    DISPLAY OR MODIFY SLICE RANGE          @Y30LB02 07300003
.*                      PARAMETER                              @Y30LB02 07350003
.*              '0'B    NO FUNCTION (DEFAULT)                  @Y30LB02 07400003
.*                                                             @Y30LB02 07450003
.*  BIT 10------'1'B    DISPLAY OR MODIFY LRU CLOCK            @Y30LB02 07500003
.*                      RESOLUTION                             @Y30LB02 07550003
.*              '0'B    NO FUNCTION (DEFAULT)                  @Y30LB02 07600003
.*                                                             @Y30LB02 07650003
.*  BIT 11-15---        |RESERVED AND MUST BE ZERO|            @Y30LB02 07700003
.*                                                             @Y30LB02 07750003
.*  MODIFY MODE                                                @Y30LB02 07800003
.*                                                             @Y30LB02 07850003
.*  THRESHOLDS:  IF MODIFY IS SPECIFIED WITH BIT 8 ON, THEN    @Y30LB02 07900003
.*  THE UPPER AND LOWER THRESHOLD DELTAS SPECIFIED WITH THE    @Y30LB02 07950003
.*  DATA PARAMETER WILL REPLACE THE UPPER AND LOWER THRESHOLD  @Y30LB02 08000003
.*  DELTAS IN THE STAGING DRIVE GROUP PAGE AVAILABILITY BLOCK. @Y30LB02 08050003
.*                                                             @Y30LB02 08100003
.*  SLICE RANGES:  IF MODIFY IS SPECIFIED WITH BIT 9 ON, THEN  @Y30LB02 08150003
.*  THE RANGES SPECIFIED WITH THE 'DATA' PARAMETER WILL RE-    @Y30LB02 08200003
.*  PLACE THE CURRENT SLICE RANGE FIELD.                       @Y30LB02 08250003
.*                                                             @Y30LB02 08300003
.*  LRU TIME DELTA:  IF MODIFY IS SPECIFIED WITH BIT 10 ON,    @Y30LB02 08350003
.*  THEN THE NEW TIME DELTA SPECIFIED WITH THE DATA PARAMETER  @Y30LB02 08400003
.*  WILL REPLACE THE OLD IN THE IMPL RECORD ON THE DASD TABLE  @Y30LB02 08450003
.*  PACK.  IF THE NEW DELTA SUCCESSFULLY REPLACES THE OLD,     @Y30LB02 08500003
.*  THEN THE 'IN CORE' LRU DELTA WILL BE CHANGED TO AGREE      @Y30LB02 08550003
.*  WITH THE NEW DELTA.                                        @Y30LB02 08600003
.*                                                             @Y30LB02 08650003
.*  DISPLAY MODE                                               @Y30LB02 08700003
.*                                                             @Y30LB02 08750003
.*  A MESSAGE WILL BE RETURNED TO THE USER IN THE AREA         @Y30LB02 08800003
.*  PROVIDED BY THE ECB PARAMETER.  THE DATA WILL HAVE THE     @Y30LB02 08850003
.*  FOLLOWING FORMAT:                                          @Y30LB02 08900003
.*                                                             @Y30LB02 08950003
.*  THRESHOLD DELTAS FOR THE SPECIFIED DRIVE GROUP:            @Y30LB02 09000003
.*                                                             @Y30LB02 09050003
.*    BYTE 0  -   THE UPPER THRESHOLD DELTA                    @Y30LB02 09100003
.*    BYTE 1  -   THE LOWER THRESHOLD DELTA                    @Y30LB02 09150003
.*    BYTES 2,3 - UNUSED                                       @Y30LB02 09200003
.*                                                             @Y30LB02 09250003
.*  SLICE RANGES FOR THE SPECIFIED STAGING DRIVE GROUP:        @Y30LB02 09300003
.*    BYTE 0  -   LRU TIME DELTA                               @Y30LB02 09350003
.*    BYTES 1-3 - UNUSED                                       @Y30LB02 09400003
.*                                                             @Y30LB02 09450003
.*  SDGNUM -  STAGING DRIVE GROUP NUMBER:  A ONE BYTE FIELD    @Y30LB02 09500003
.*            THAT CONTAINS THE STAGING DRIVE GROUP DESIGNA-   @Y30LB02 09550003
.*            TION.  THIS PARAMETER NEED NOT BE SPECIFIED      @Y30LB02 09600003
.*            IF BIT 10 (MODIFY OR DISPLAY LRU CLOCK           @Y30LB02 09650003
.*            RESOLUTION) IS SPECIFIED.                        @Y30LB02 09700003
.*                                                             @Y30LB02 09750003
.*  ECB    -  EVENT CONTROL BLOCK:  THE NAME OF THE EVENT      @Y30LB02 09800003
.*            CONTROL BLOCK.  THE USER MUST DECLARE A          @Y30LB02 09850003
.*            MINIMUM 12 BYTES CONTIGUOUS AREA TO CONTAIN      @Y30LB02 09900003
.*            THE MESSAGE.  THIS PARAMETER IS REQUIRED FOR     @Y30LB02 09950003
.*            DISPLAY MODE ONLY.  (THE ECB AND APPENDED        @Y30LB02 10000003
.*            DATA AREA MUST BE IN COMMON CORE IN VS/2.)       @Y30LB02 10050003
.*            THE ECB IS POSTED WITH ONE OF THE FOLLOWING      @Y30LB02 10100003
.*            POST CODES:  71, 72, 73, 74, AND ETC.  THE       @Y30LB02 10150003
.*            POST CODE WILL BE PLACED IN THE LOW-ORDER BYTE   @Y30LB02 10200003
.*            OF THE ECB - '7F'X INDICATES SUCCESSFUL          @Y30LB02 10250003
.*            COMPLETION.  THE MSC DATA WILL BE MOVED TO       @Y30LB02 10300003
.*            CORE LOCATION ADDR(ECB)+4.  THE ECB AREA MUST    @Y30LB02 10350003
.*            BE CLEARED(SET TO BINARY 0) BEFORE INVOKING      @Y30LB02 10400003
.*            THE MACRO.                                       @Y30LB02 10450003
.*                                                             @Y30LB02 10500003
.*  DATA   -  A FOUR BYTE FIELD THAT CONTAINS INFORMATION      @Y30LB02 10550003
.*            TO MODIFY THE MSC MEMORY, OR THE MSC TABLE       @Y30LB02 10600003
.*            BLOCK.  THIS PARAMETER IS REQUIRED FOR THE       @Y30LB02 10650003
.*            MODIFY MODE AND HAS THE FOLLOWING FORMAT:        @Y30LB02 10700003
.*                                                             @Y30LB02 10750003
.*  IF THRESHOLDS ARE TO BE MODIFIED THEN:                     @Y30LB02 10800003
.*                                                             @Y30LB02 10850003
.*    BYTE 0  -   NEW UPPER THRESHOLD DELTA VALUE              @Y30LB02 10900003
.*    BYTE 1  -   NEW LOWER THRESHOLD DELTA VALUE              @Y30LB02 10950003
.*    BYTES 2-3 - RESERVED                                     @Y30LB02 11000003
.*                                                             @Y30LB02 11050003
.*  IF SLICE RANGES ARE TO BE MODIFIED THEN:                   @Y30LB02 11100003
.*                                                             @Y30LB02 11150003
.*    BYTES 0-3 - NEW SLICE RANGE VALUES                       @Y30LB02 11200003
.*                                                             @Y30LB02 11250003
.*  IF LRU CLOCK DELTA IS TO BE MODIFIED THEN:                 @Y30LB02 11300003
.*                                                             @Y30LB02 11350003
.*    BYTE 0  -   NEW LRU CLOCK DELTA VALUE                    @Y30LB02 11400003
.*    BYTE 1-3  - RESERVED                                     @Y30LB02 11450003
.*                                                             @Y30LB02 11500003
.*                                                             @Y30LB02 11550003
.*01  EXIT-NORMAL = VALID INVOCATION                           @Y30LB02 11600003
.*                                                             @Y30LB02 11650003
.*02     CONDITION = RETURN CODE = 0                           @Y30LB02 11700003
.*                                                             @Y30LB02 11750003
.*02     OUTPUT = IN-LINE PLS/BAL STATEMENTS THAT PERFORM      @Y30LB02 11800003
.*       THE REQUESTED FUNCTION                                @Y30LB02 11850003
.*                                                             @Y30LB02 11900003
.*01  EXIT-ERROR = INVALID INVOCATION                          @Y30LB02 11950003
.*                                                             @Y30LB02 12000003
.*02     CONDITION = RETURN CODE = 12                          @Y30LB02 12050003
.*                                                             @Y30LB02 12100003
.*02     OUTPUT = ERROR MESSAGE AS A COMMENT AT POINT OF       @Y30LB02 12150003
.*                INVOCATION                                   @Y30LB02 12200003
.*                                                             @Y30LB02 12250003
.*01  EXTERNAL REFERENCES = NONE                               @Y30LB02 12300003
.*                                                             @Y30LB02 12350003
.*01  TABLES = NONE                                            @Y30LB02 12400003
.*                                                             @Y30LB02 12450003
.*01  TABLES = NONE                                            @Y30LB02 12500003
.*                                                             @Y30LB02 12550003
.*01  MESSAGES = AS FOLLOWS:                                   @Y30LB02 12600003
.*     ICB602I:  A NAME FOR THE REQUEST BLOCK MUST BE          @Y30LB02 12650003
.*               SPECIFIED IN MF(2)                            @Y30LB02 12700003
.*     ICB604I:  WARNING ONLY THE MF PARAMETER IS              @Y30LB02 12750003
.*               VALID FOR LIST FORM                           @Y30LB02 12800003
.*     ICB607I:  FLAGS MUST BE SPECIFIED FOR STANDARD          @Y30LB02 12850003
.*               FORM MACRO                                    @Y30LB02 12900003
.*     ICB612I:  MF(2) MUST CONTAIN REQ BLK NAME IF            @Y30LB02 12950003
.*               EXEC MACRO FORM REQUESTED                     @Y30LB02 13000003
.*     ICB615I:  INVALID MF PARAMETER SPECIFIED, MUST BE       @Y30LB02 13050003
.*               L, E, OR NULL                                 @Y30LB02 13100003
.*                                                             @Y30LB02 13150003
.*01  CONTROL-BLOCKS = NONE                                    @Y30LB02 13200003
.*                                                             @Y30LB02 13250003
.*01  INNER MACROS = NONE                                      @Y30LB02 13300003
.*                                                             @Y30LB02 13350003
.*01  SYSTEM MACRO = IHBINNRA                                  @Y30LB02 13400003
.*                                                             @Y30LB02 13450003
.*01  CHANGE-ACTIVITY = S/D X04AC02 & Y30LB02                  @Y30LB02 13500003
.*                                                             @Y30LB02 13550003
.**** END OF SPECIFICATIONS ***                                @Y30LB02 13600003
         MACRO                                                          13650003
&SYMBOL  ICBTUNE &MF=,&FLAGS=,&SDGNUM=,&ECB=,&DATA=                     13700003
         LCLB &ERSW               ERROR SWITCH                 @Y30LB02 13750003
         LCLC &TUNEU              TUNE MACRO INSTR INDX        @Y30LB02 13800003
&TUNEU   SETC 'TU'.'&SYSNDX'      ASSIGN CHARACTER VALUE       @Y30LB02 13850003
.*                                                             @Y30LB02 13900003
.*       DETERMINATION OF DESIRED MACRO FORM,L MEANS           @Y30LB02 13950003
.*       THE LIST FORM, E REPRESENTS THE EXECUTE               @Y30LB02 14000003
.*       FORM AND THE DEFAULT IS STANDARD FORM                 @Y30LB02 14050003
.*                                                             @Y30LB02 14100003
         AIF  ('&MF(1)' NE 'L').EFORM       LIST FORM?         @Y30LB02 14150003
         AIF  ('&FLAGS' NE '' OR '&SDGNUM' NE '').WARN         @Y30LB02 14200003
         AIF  ('&ECB' NE '' OR '&DATA' NE '').WARN             @Y30LB02 14250003
         AGO  .LISTOK                                          @Y30LB02 14300003
.WARN    MNOTE 4,'  ICB604I - WARNING-ONLY THE MF  '           @Y30LB02 14350003
         MNOTE 4,'  PARAMETER IS VALID FOR LIST FORM '         @Y30LB02 14400003
.*                                                             @Y30LB02 14450003
.LISTOK  ANOP                                                  @Y30LB02 14500003
         AIF  ('&MF(2)' EQ 'MAP').LISTDS  MAPPING DSECT REQ?   @Y30LB02 14550003
*  MACMEAN  TUNING MACRO--INITIALIZED LIST FORM                @Y30LB02 14600003
*  VS1-4/VS2-3 VERSION--06/09/74   LEVEL 00                    @Y30LB02 14650003
&SYMBOL  DS   0F                                               @Y30LB02 14700003
TUNELEN  DC   F'20'               LENGTH OF TUNE REQ BLK       @Y30LB02 14750003
TUNEOPCD DC   XL1'1C'             TUNING  FUNCTION OPCODE      @YM02853 14800003
TUNERES1 DC   XL1'00'             1-BYTE RESERVED AREA         @Y30LB02 14850003
TUNEFLAG DC   XL2'0000'           2-BYTE FLAGS AREA            @Y30LB02 14900003
TUNESDGN DC   XL1'00'             1-BYTE SDGNUM AREA           @Y30LB02 14950003
TUNERES2 DC   XL1'00'             1-BYTE RESERVED AREA         @Y30LB02 15000003
TUNEASID DC   XL2'0000'           2-BYTE ASID AREA             @Y30LB02 15050003
TUNEECB  DC   XL4'00000000'       4-BYTE ECB AREA              @Y30LB02 15100003
TUNEDATA DC   XL4'00000000'       2-BYTE RESERVED AREA         @Y30LB02 15150003
         AGO  .FINISH                                          @Y30LB02 15200003
.*                                                             @Y30LB02 15250003
.*                                                             @Y30LB02 15300003
.LISTDS  ANOP                                                  @Y30LB02 15350003
*  MACMEAN  TUNING MACRO--UNINITIALIZED LIST FORM              @Y30LB02 15400003
*  VS1-4/VS2-3 VERSION--06/09/74   LEVEL 00                    @Y30LB02 15450003
ICBTUNE  DSECT                                                 @Y30LB02 15500003
TUNELEN  DS   F                   LEN OF 20 BYTES              @Y30LB02 15550003
TUNEOPCD DS   XL1                 TUNING OPCODE                @YM02853 15600003
TUNERES1 DS   XL1                 1-BYTE RESERVE-ZERO          @Y30LB02 15650003
TUNEFLAG DS   XL2                 2-BYTE FLAGS AREA            @Y30LB02 15700003
TUNESDGN DS   XL1                 1-BYTE SDGNUM AREA           @Y30LB02 15750003
TUNERES2 DS   XL1                 1-BYTE RESERVED AREA         @Y30LB02 15800003
TUNEASID DS   XL2                 2-BYTE ASID AREA             @Y30LB02 15850003
TUNEECB  DS   A                   4-BYTE ECB AREA              @Y30LB02 15900003
TUNEDATA DS   XL4                 4-BYTE DATA AREA             @Y30LB02 15950003
         AGO  .FINISH                                          @Y30LB02 16000003
.*                                                             @Y30LB02 16050003
.*       THE FOLLOWING PROCESSING IS ACCOMPLISHED FOR THE      @Y30LB02 16100003
.*       EXECUTABLE MACRO FORM                                 @Y30LB02 16150003
.*                                                             @Y30LB02 16200003
.EFORM   AIF  ('&MF(1)' NE 'E').SFORM       EXECUTE FORM?      @Y30LB02 16250003
         AIF  ('&MF(2)' EQ '').EXFAIL       MF(2) NULL?        @Y30LB02 16300003
*  MACMEAN  TUNING MACRO--EXECUTE FORM                         @Y30LB02 16350003
*  VS1-4/VS2-3 VERSION--06/09/74   LEVEL 00                    @Y30LB02 16400003
&SYMBOL  IHBINNRA &MF(2)          LD ADDR OF REQUEST BLK       @Y30LB02 16450003
         LA   0,20                LD LEN OF TUNE BLK           @Y30LB02 16500003
         ST   0,0(1)              STORE LEN IN REQ BLK         @Y30LB02 16550003
         MVI  4(1),X'1C'          LD TUNING OPCODE IN BLK      @YM02853 16600003
         AGO  .CKSW1                                           @Y30LB02 16650003
.*                                                             @Y30LB02 16700003
.EXFAIL  ANOP                                                  @Y30LB02 16750003
         MNOTE 12,'  ICB612I - MF(2) MUST CONTAIN REQ BLK '    @Y30LB02 16800003
         MNOTE 12,'  NAME IF EXEC MACRO FORM REQUESTED '       @Y30LB02 16850003
&ERSW    SETB 1                   SET ERROR SWITCH TO 1        @Y30LB02 16900003
.*                                                             @Y30LB02 16950003
.CKSW1   AIF  (&ERSW).FINISH      IF ERROR-END PROCESSING      @Y30LB02 17000003
         AGO  .COMMON                                          @Y30LB02 17050003
.*                                                             @Y30LB02 17100003
.*       PROCESSING OF THE STANDARD FORM MACRO                 @Y30LB02 17150003
.*                                                             @Y30LB02 17200003
.SFORM   AIF  ('&MF(1)' NE '').BADFORM      STANDARD FORM?     @Y30LB02 17250003
         AIF  ('&FLAGS' NE '').CKSW2      FLAGS SPECIFIED?     @Y30LB02 17300003
&ERSW    SETB 1                   SET ERROR SWITCH TO 1        @Y30LB02 17350003
         MNOTE 12,'  ICB607I - FLAGS MUST BE SPECIFIED '       @Y30LB02 17400003
         MNOTE 12,'  FOR STANDARD FORM MACRO '                 @Y30LB02 17450003
         AGO  .CKSW2                                           @Y30LB02 17500003
.*                                                             @Y30LB02 17550003
.BADFORM ANOP                                                  @Y30LB02 17600003
&ERSW    SETB 1                   SET ERROR SWITCH TO 1        @Y30LB02 17650003
         MNOTE 12,'  ICB615I - INVALID MF PARAMETER '          @Y30LB02 17700003
         MNOTE 12,'  SPECIFIED, MUST BE L, E, OR NULL.'        @Y30LB02 17750003
.*                                                             @Y30LB02 17800003
.*       THE FOLLOWING CODE CHECKS TO DETERMINE IF THE ERROR   @Y30LB02 17850003
.*       SWITCH IS ON.  IF YES, PROCESSING IS TERMINATED,      @Y30LB02 17900003
.*       OTHERWISE STANDARD FORM MACRO PROCESSING WILL BE      @Y30LB02 17950003
.*       CONTINUE                                              @Y30LB02 18000003
.*                                                             @Y30LB02 18050003
.CKSW2   AIF  (&ERSW).FINISH      IF YES-END PROCESSING        @Y30LB02 18100003
*  MACMEAN TUNING MACRO--STANDARD FORM                         @Y30LB02 18150003
*  VS1-4/VS2-3 VERSION--06/09/74   LEVEL 00                    @Y30LB02 18200003
         CNOP 0,4                                              @Y30LB02 18250003
&SYMBOL  BAL  1,&TUNEU            LD R1 WITH ADDR REQ BLK      @Y30LB02 18300003
TUNELEN  DC   A(&TUNEU-*)         LEN OF TUN REQ BLK           @Y30LB02 18350003
TUNEOPCD DC   XL1'1C'             TUNING  FUNCTION OPCODE      @YM02853 18400003
TUNERES1 DC   XL1'00'             1-BYTE RESERVED AREA         @Y30LB02 18450003
TUNEFLAG DC   XL2'0000'           2-BYTE FLAGS AREA            @Y30LB02 18500003
TUNESDGN DC   XL1'00'             1-BYTE SDGNUM AREA           @Y30LB02 18550003
TUNERES2 DC   XL1'00'             1-BYTE RESERVED AREA         @Y30LB02 18600003
TUNEASID DC   XL2'0000'           2-BYTE ASID AREA             @Y30LB02 18650003
TUNEECB  DC   XL4'00000000'       4-BYTE ECB AREA              @Y30LB02 18700003
TUNEDATA DC   XL4'00000000'       2-BYTE RESERVED AREA         @Y30LB02 18750003
&TUNEU   EQU  *                                                @Y30LB02 18800003
.*                                                             @Y30LB02 18850003
.*       THE FOLLOWING CODE CHECKS FOR VALID PARAMETERS IF     @Y30LB02 18900003
.*       STANDARD OR EXECUTE FORM MACRO IS SPECIFIED.          @Y30LB02 18950003
.*       IF PARAMETERS ARE SPECIFIED, THEY WILL BE STORED      @Y30LB02 19000003
.*       IN THE REQUEST BLOCK.                                 @Y30LB02 19050003
.*                                                             @Y30LB02 19100003
.COMMON  AIF  ('&FLAGS' EQ '').SDGN   FLAGS SPECIFIED?         @Y30LB02 19150003
         AIF  ('&FLAGS'(1,1) EQ '(').FLREG   FLAGS REGFORM?    @Y30LB02 19200003
         MVC  6(2,1),&FLAGS       PUT FLAGS IN REQ BLOCK       @Y30LB02 19250003
         AGO  .SDGN               BRANCH TO CK HOSTID          @Y30LB02 19300003
.*                                                             @Y30LB02 19350003
.FLREG   ANOP                                                  @Y30LB02 19400003
         MVC  6(2,1),0(&FLAGS(1)) REGFORM PLACE FLAGS IN BLK   @Y30LB02 19450003
.*                                                             @Y30LB02 19500003
.SDGN    AIF  ('&SDGNUM' EQ '').CKECB       SDGNUM SPECIFIED?  @Y30LB02 19550003
         AIF  ('&SDGNUM'(1,1) EQ '(').HREG  REGISTER FORM?     @Y30LB02 19600003
         MVC  8(1,1),&SDGNUM      ADDRFORM-ST SDGNUM IN BLK    @Y30LB02 19650003
         AGO  .CKECB                                           @Y30LB02 19700003
.*                                                             @Y30LB02 19750003
.HREG    ANOP                                                  @Y30LB02 19800003
         MVC  8(1,1),0(&SDGNUM(1)) REGFORM-ST SDGNUM IN BLK    @Y30LB02 19850003
.*                                                             @Y30LB02 19900003
.CKECB   AIF  ('&ECB' EQ '').CKDATA       ECB SPECIFIED?       @Y30LB02 19950003
         AIF  ('&ECB'(1,1) EQ '(').EREG   REGISTER FORM?       @Y30LB02 20000003
         LA   15,&ECB             LOAD ECB IN REG 15           @Y30LB02 20050003
         ST   15,12(1)            ST ECB IN REQUEST BLK        @Y30LB02 20100003
         AGO  .CKDATA                                          @Y30LB02 20150003
.*                                                             @Y30LB02 20200003
.EREG    ANOP                                                  @Y30LB02 20250003
         ST   &ECB,12(1)          REGFORM-ST ECB IN BLK        @Y30LB02 20300003
.*                                                             @Y30LB02 20350003
.CKDATA  AIF  ('&DATA' EQ '').INVOKE      DATA SPECIFIED?      @Y30LB02 20400003
         AIF  ('&DATA'(1,1) EQ '(').DREG  REGISTER FORM?       @Y30LB02 20450003
         MVC  16(4,1),&DATA       MOVE DATA IN REQ BLK         @Y30LB02 20500003
         AGO  .INVOKE                                          @Y30LB02 20550003
.*                                                             @Y30LB02 20600003
.DREG    ANOP                                                  @Y30LB02 20650003
         MVC  16(4,1),0(&DATA(1)) REGFORM-PUT DATA IN BLK      @Y30LB02 20700003
.INVOKE  ANOP                                                  @Y30LB02 20750003
         SVC  126                 INVOKE THE SVC               @Y30LB02 20800003
.FINISH  MEND                                                  @Y30LB02 20850003
**/                                                                     20900003
*/*                                                          @Y30LB02*/ 20950003
*   ICBTUNE: MACRO KEYS(MF,FLAGS,SDGNUM,ECB,DATA);         /*@Y30LB02*/ 21000003
*/*                                                          @Y30LB02*/ 21050003
*/*                     EXTERNAL DECLARES                    @Y30LB02*/ 21100003
*/*********************************************************  @Y30LB02*/ 21150003
*/*      TUNETES IS USED TO DETERMINE WHETHER THE STANDARD   @Y30LB02*/ 21200003
*/*      FORM MACRO HAS BEEN INVOKED MORE THAN ONCE BY THE   @Y30LB02*/ 21250003
*/*      SAME CALLER.                                        @Y30LB02*/ 21300003
*/*********************************************************  @Y30LB02*/ 21350003
*/*      TUTESTR1 WILL BE USED TO DETERMINE IF IT IS NECES-  @Y30LB02*/ 21400003
*/*      SARY TO DECLARE R1 OR WHETHER IT IS ALREADY DCLD    @Y30LB02*/ 21450003
*/*********************************************************  @Y30LB02*/ 21500003
*/*                                                          @Y30LB02*/ 21550003
*   DCL  TUTESTR1  FIXED  EXT;    /*REG1 DECLARE COUNTER     @Y30LB02*/ 21600003
*   DCL  TUNETES  FIXED  EXT;     /*STANDARD INVOC COUNTER   @Y30LB02*/ 21650003
*/*                                                          @Y30LB02*/ 21700003
*/*      INTERNAL DECLARES                                   @Y30LB02*/ 21750003
*   DCL  OPCODE   CHAR;      /*DEFINE TUNE OPCODE            @Y30LB02*/ 21800003
*   DCL  TUNLEN  CHAR;       /*DECLARE LENGTH OF ORDER       @Y30LB02*/ 21850003
*   DCL  ERSW     FIXED;     /*DECLARE ERROR COND SWITCH     @Y30LB02*/ 21900003
*   DCL  RETCODE  FIXED;     /*DECLARE RETURN CODE AREA      @Y30LB02*/ 21950003
*   DCL  CTR      FIXED;     /*DECLARE CTR FOR LIST FORM     @Y30LB02*/ 22000003
*        ERSW=0;             /*INITIALIZE ERROR SWITCH       @Y30LB02*/ 22050003
*        RETCODE=0;          /*INITIALIZE RETURN CODE        @Y30LB02*/ 22100003
*        TUNLEN='14';        /*INITIALIZE LENGTH FIELD       @Y30LB02*/ 22150003
*        OPCODE='1C';        /*INITIALIZE OPCODE VARIABLE    @YM02853*/ 22200003
*        CTR=0;              /*INITIALIZE INCREMENT CTR      @Y30LB02*/ 22250003
*/********************************************************   @Y30LB02*/ 22300003
*/*      CHECK FOR VALID MACRO FORM--E INDICATES EXECUTE     @Y30LB02*/ 22350003
*/*      FORM, L INDICATES LIST FORM AND IF THE MF PARA-     @Y30LB02*/ 22400003
*/*      METER IS NULL THE STANDARD FORM MACRO IS INVOKED    @Y30LB02*/ 22450003
*/********************************************************   @Y30LB02*/ 22500003
*        IF TUTESTR1=0 THEN  /*REG1 DECLARED BEFORE?         @Y30LB02*/ 22550003
*             DO;            /*                              @Y30LB02*/ 22600003
*                  ANS('DCL TUNER1 REG(1) PTR ;/*PTR'||                 22650003
*                  ' TO REQUEST BLOCK @Y30LB02*/')SKIP;                 22700003
*                  TUTESTR1=TUTESTR1+1;/*INCREMENT CTR       @Y30LB02*/ 22750003
*             END;           /*                              @Y30LB02*/ 22800003
*   IF MF(1) ^= 'L' THEN     /*LIST FORM?                    @Y30LB02*/ 22850003
*        GO TO EFORM;        /*CHECK FOR EXECUTE FORM        @Y30LB02*/ 22900003
*   IF MF(2) = '' THEN       /*LIST NAME SPECIFIED           @Y30LB02*/ 22950003
*        DO;                 /*SET UP ERROR MESSAGE          @Y30LB02*/ 23000003
*             ERSW=1;        /*SET ERROR SWITCH ON           @Y30LB02*/ 23050003
*             RETCODE=12;    /*SET RETURN CODE TO 12         @Y30LB02*/ 23100003
*             ANS MSG('  ICB602I - A NAME FOR THE REQUEST BLOCK '||     23150003
*             'MUST BE SPECIFIED IN MF(2) ')SKIP;          /*@Y30LB02*/ 23200003
*             GO TO FINISH;  /*BRANCH TO END                 @Y30LB02*/ 23250003
*        END;                /*                              @Y30LB02*/ 23300003
*/********************************************************   @Y30LB02*/ 23350003
*/*  THE FOLLOWING CODE CHECKS TO INSURE THAT THE USER       @Y30LB02*/ 23400003
*/*  DOES NOT ATTEMPT TO PASS ARGUMENTS OTHER THAN THE MF    @Y30LB02*/ 23450003
*/*  PARAMETER ON THE LIST FORM MACRO INVOCATION.  IF A      @Y30LB02*/ 23500003
*/*  VIOLATION IS DETECTED, A WARNING MESSAGE WILL BE        @Y30LB02*/ 23550003
*/*  GIVEN AND PROCESSING WILL CONTINUE.                     @Y30LB02*/ 23600003
*/********************************************************   @Y30LB02*/ 23650003
*/*                                                          @Y30LB02*/ 23700003
*   IF FLAGS ^= '' THEN      /*IS THE FLAGS AREA NULL        @Y30LB02*/ 23750003
*        CTR=CTR+1;          /*INCREMENT PARAMETER COUNTER   @Y30LB02*/ 23800003
*   IF SDGNUM ^= '' THEN     /*IS THE SDGNUM AREA NULL       @Y30LB02*/ 23850003
*        CTR=CTR+1;          /*INCREMENT PARAMETER COUNTER   @Y30LB02*/ 23900003
*   IF ECB ^= '' THEN        /*IS THE ECB AREA NULL          @Y30LB02*/ 23950003
*        CTR=CTR+1;          /*INCREMENT PARAMETER COUNTER   @Y30LB02*/ 24000003
*   IF DATA ^= '' THEN       /*IS THE DATA AREA NULL         @Y30LB02*/ 24050003
*        CTR=CTR+1;          /*INCREMENT PARAMETER COUNTER   @Y30LB02*/ 24100003
*   IF CTR > 0 THEN          /*INCREMENT CTR > ZERO?         @Y30LB02*/ 24150003
*        DO;                 /*SET UP ERROR MESSAGE          @Y30LB02*/ 24200003
*          RETCODE=4;     /*SET RETURN CODE TO 4             @Y30LB02*/ 24250003
*          ANS MSG('  ICB604I - WARNING-ONLY THE MF PARAMETER'||        24300003
*             ' IS VALID FOR LIST FORM')SKIP;              /*@Y30LB02*/ 24350003
*        END;                /*                              @Y30LB02*/ 24400003
*   IF MF(3) ^= '' THEN      /*ARGUMENT THREE SPECIFIED      @Y30LB02*/ 24450003
*        GO TO ATTRLST;      /*IF YES, THEN BRANCH           @Y30LB02*/ 24500003
*/*                                                          @Y30LB02*/ 24550003
*             ANS('/*******************************************'||      24600003
*                 '************** @Y30LB02*/')SKIP;                     24650003
*             ANS('/*MACMEAN  MSSC TUNING MACRO                '||      24700003
*                 '               @Y30LB02*/')SKIP;                     24750003
*             ANS('/*VS1-4/VS2-3 VERSION--06/09/74 LEVEL 00    '||      24800003
*                 '               @Y30LB02*/')SKIP;                     24850003
*             ANS('/*THIS IS THE INITIALIZED LIST FORM         '||      24900003
*                 '               @Y30LB02*/')SKIP;                     24950003
*             ANS('/*******************************************'||      25000003
*                 '************** @Y30LB02*/')SKIP;                     25050003
*             ANS('DCL 1 '||MF(2)||'  STATIC LOCAL,'||                  25100003
*             ' /*TUNING REQUEST BLOCK @Y30LB02*/')SKIP;                25150003
*             ANS('    2  TUNELEN  FIXED(31)INIT('||QUOTE               25200003
*             ('14')||'X),/*LEN OF TUNING REQ BLK @Y30LB02*/')SKIP;     25250003
*             ANS('    2  TUNEOPCD CHAR(1)INIT('||QUOTE('1C')||         25300003
*             'X),/*TUNING OPCODE @YM02853*/')SKIP;                     25350003
*             ANS('    2  TUNERES1 CHAR(1)INIT('||QUOTE('00')||'X),'||  25400003
*             '/*RESERVED AND ZERO @Y30LB02*/')SKIP;                    25450003
*             ANS('    2  TUNEFLAG BIT(16)INIT('||QUOTE                 25500003
*             ('0000000000000000')||'B),/*TWO BYTE ATTRIBUTE '||        25550003
*             'AREA @Y30LB02*/')SKIP;                                   25600003
*             ANS('       3  TUNMODE BIT(1),/*IF ON, THEN'||            25650003
*             ' MODIFY MODE-OFF RESULT IN DISPLAY @Y30LB02*/')SKIP;     25700003
*             ANS('       3  TUNRES1 BIT(7),/*SEVEN BITS'||             25750003
*             ' RESERVED @Y30LB02*/')SKIP;                              25800003
*             ANS('       3  TUNTHRES BIT(1),/*DISPLAY OR'||            25850003
*             ' MODIFY THRESHOLDS @Y30LB02*/')SKIP(1);                  25900003
*             ANS('       3  TUNSLICE BIT(1),/*DISPLAY OR'||            25950003
*             ' MODIFY SLICE RANGES @Y30LB02*/')SKIP(1);                26000003
*             ANS('       3  TUNCLOCK BIT(1),/*DISPLAY OR'||            26050003
*             ' MODIFY LRU CLOCK @Y30LB02*/')SKIP(1);                   26100003
*             ANS('       3  TUNRES2 BIT(5),/*5 BITS'||                 26150003
*             ' RESERVED @Y30LB02*/')SKIP;                              26200003
*             ANS('    2  TUNESDGN  FIXED(8) INIT(0),'||                26250003
*             '/*STAGING DRIVE GROUP NUMBER @Y30LB02*/')SKIP;           26300003
*             ANS('    2  TUNERES2  CHAR(1) INIT('||QUOTE               26350003
*             ('00')||'X),/*RESERVED AREA @Y30LB02*/')SKIP;             26400003
*             ANS('    2  TUNEASID  CHAR(2) INIT('||QUOTE               26450003
*             ('0000')||'X),/*ADDRESS SPACE ID @Y30LB02*/')SKIP;        26500003
*             ANS('    2  TUNEECB  FIXED(31) INIT(0),'||                26550003
*             '/*EVENT CONTROL BLOCK @Y30LB02*/')SKIP;                  26600003
*             ANS('    2  TUNEDATA  FIXED(31)INIT(0);'||                26650003
*             '/*DATA PARAMETER @Y30LB02*/')SKIP;                       26700003
*             GO TO FINISH;    /*BRANCH TO END               @Y30LB02*/ 26750003
*/*                                                          @Y30LB02*/ 26800003
*ATTRLST:                                                               26850003
*/*                                                          @Y30LB02*/ 26900003
*             ANS('/*******************************************'||      26950003
*                 '************** @Y30LB02*/')SKIP;                     27000003
*             ANS('/*MACMEAN  MSSC TUNING MACRO                '||      27050003
*                 '               @Y30LB02*/')SKIP;                     27100003
*             ANS('/*VS1-4/VS2-3 VERSION--06/09/74 LEVEL 00    '||      27150003
*                 '               @Y30LB02*/')SKIP;                     27200003
*             ANS('/*THIS IS THE UNINITIALIZED LIST FORM       '||      27250003
*                 '               @Y30LB02*/')SKIP;                     27300003
*             ANS('/*******************************************'||      27350003
*                 '************** @Y30LB02*/')SKIP;                     27400003
*             ANS('DCL 1 '||MF(2)||' '||MF(3)||','||                    27450003
*             ' /*TUNING REQUEST BLOCK @Y30LB02*/')SKIP;                27500003
*             ANS('    2  TUNELEN  FIXED(31),'||                        27550003
*             '/*LEN OF TUNING REQ BLK 20 BYTES @Y30LB02*/')SKIP;       27600003
*             ANS('    2  TUNEOPCD CHAR(1),'||                          27650003
*             '/*TUNING MACRO OPCODE @YM02853*/')SKIP;                  27700003
*             ANS('    2  TUNERES1 CHAR(1),'||                          27750003
*             '/*RESERVED AND ZERO @Y30LB02*/')SKIP;                    27800003
*             ANS('    2  TUNEFLAG BIT(16),'||                          27850003
*             '/*TWO BYTE ATTRIBUTE AREA @Y30LB02*/')SKIP;              27900003
*             ANS('       3  TUNMODE BIT(1),/*IF ON, THEN'||            27950003
*             ' MODIFY MODE-OFF RESULT IN DISPLAY @Y30LB02*/')SKIP;     28000003
*             ANS('       3  TUNRES1 BIT(7),/*SEVEN BITS'||             28050003
*             ' RESERVED @Y30LB02*/')SKIP;                              28100003
*             ANS('       3  TUNTHRES BIT(1),/*DISPLAY OR'||            28150003
*             ' MODIFY THRESHOLDS @Y30LB02*/')SKIP;                     28200003
*             ANS('       3  TUNSLICE BIT(1),/*DISPLAY OR'||            28250003
*             ' MODIFY SLICE RANGES @Y30LB02*/')SKIP;                   28300003
*             ANS('       3  TUNCLOCK BIT(1),/*DISPLAY OR'||            28350003
*             ' MODIFY LRU CLOCK @Y30LB02*/')SKIP;                      28400003
*             ANS('       3  TUNRES2 BIT(5),/*5 BITS'||                 28450003
*             ' RESERVED @Y30LB02*/')SKIP;                              28500003
*             ANS('    2  TUNESDGN  FIXED(8) ,'||                       28550003
*             '/*STAGING DRIVE GROUP NUMBER @Y30LB02*/')SKIP;           28600003
*             ANS('    2  TUNERES2  CHAR(1) ,'||                        28650003
*             '/*RESERVED AREA @Y30LB02*/')SKIP;                        28700003
*             ANS('    2  TUNEASID  CHAR(2) ,'||                        28750003
*             '/*ADDRESS SPACE ID @Y30LB02*/')SKIP;                     28800003
*             ANS('    2  TUNEECB  FIXED(31) ,'||                       28850003
*             '/*EVENT CONTROL BLOCK @Y30LB02*/')SKIP;                  28900003
*             ANS('    2  TUNEDATA  FIXED(31);'||                       28950003
*             '/*DATA PARAMETER @Y30LB02*/')SKIP;                       29000003
*             GO TO FINISH;    /*BRANCH TO END               @Y30LB02*/ 29050003
*/*                                                          @Y30LB02*/ 29100003
*/*      PROCESSING THE EXECUTE MACRO FORM                   @Y30LB02*/ 29150003
*/*                                                          @Y30LB02*/ 29200003
*EFORM:                                                                 29250003
*   IF MF(1) ^= 'E' THEN       /*EXECUTE FORM SPECIFIED?     @Y30LB02*/ 29300003
*        GO TO SFORM;          /*NO, BRANCH TO CK FOR STD    @Y30LB02*/ 29350003
*   IF MF(2) = '' THEN         /*LIST NAME SPECIFIED?        @Y30LB02*/ 29400003
*        DO;                   /*SETUP ERROR MESSAGE         @Y30LB02*/ 29450003
*             ERSW=1;          /*SET ERROR SWITCH ON         @Y30LB02*/ 29500003
*             RETCODE=12;      /*SET RETURN CODE TO 12       @Y30LB02*/ 29550003
*             ANS MSG('  ICB612I - MF(2) MUST CONTAIN '||               29600003
*                'REQ BLK NAME IF EXEC '||                              29650003
*                'MACRO FORM REQUESTED ')SKIP;             /*@Y30LB02*/ 29700003
*             GO TO CKSW;      /*BRANCH TO CK ERROR SWITCH   @Y30LB02*/ 29750003
*        END;                  /*                            @Y30LB02*/ 29800003
*/*                                                          @Y30LB02*/ 29850003
*   ELSE              /*CONTINUE EXECUTE PROCESSING          @Y30LB02*/ 29900003
*        ANS('/*******************************************'||           29950003
*            '************** @Y30LB02*/')SKIP;                          30000003
*        ANS('/*MACMEAN  MSSC TUNING MACRO                '||           30050003
*            '               @Y30LB02*/')SKIP;                          30100003
*        ANS('/*VS1-4/VS2-3 VERSION-- 06/09/74 LEVEL 00   '||           30150003
*            '               @Y30LB02*/')SKIP;                          30200003
*        ANS('/*THIS IS THE OUTPUT FOR THE EXECUTE FORM.  '||           30250003
*            '               @Y30LB02*/')SKIP;                          30300003
*        ANS('/*THE LIST FORM OF THIS MACRO SHOULD BE     '||           30350003
*            '               @Y30LB02*/')SKIP;                          30400003
*        ANS('/*INVOKED FIRST IN ORDER TO SET UP NECESSARY'||           30450003
*            '               @Y30LB02*/')SKIP;                          30500003
*        ANS('/*DECLARES.  IF THE COMPLETE ARGUMENT IS    '||           30550003
*            '               @Y30LB02*/')SKIP;                          30600003
*        ANS('/*SPECIFIED THE REQ BLOCK WILL BE ZEROED.   '||           30650003
*            '               @Y30LB02*/')SKIP;                          30700003
*        ANS('/*******************************************'||           30750003
*            '************** @Y30LB02*/')SKIP;                          30800003
*/*                                                          @Y30LB02*/ 30850003
*        ANS('RFY(TUNER1)RSTD;/*RESTRICT REG 1 @Y30LB02*/')SKIP;        30900003
*        ANS('TUNER1=ADDR('||MF(2)||');/*R1 POINTER TO'||               30950003
*        ' REQUEST BLOCK @Y30LB02*/')SKIP;                              31000003
*   IF MF(3) = 'COMPLETE' THEN  /*COMPLETE SPECIFIED?        @Y30LB02*/ 31050003
*     DO;                       /*PREPARE TO ZERO BLK        @Y30LB02*/ 31100003
*        ANS(' '||MF(2)||'='||MF(2)||'&&'||MF(2)||';'||                 31150003
*        '/*ZERO REQUEST BLOCK @Y30LB02*/')SKIP;                        31200003
*     END;                      /*                           @Y30LB02*/ 31250003
*        ANS('TUNELEN= '||QUOTE(TUNLEN)||'X;/*LENGTH '||                31300003
*        ' OF TUNING REQUEST @Y30LB02*/')SKIP;                          31350003
*        ANS('TUNEOPCD= '||QUOTE(OPCODE)||'X;/*TUNING'||                31400003
*        ' OPCODE @Y30LB02*/')SKIP;                                     31450003
*/*                                                          @Y30LB02*/ 31500003
*CKSW:                                                                  31550003
*   IF ERSW=1 THEN          /*IS ERROR SWITCH ON?            @Y30LB02*/ 31600003
*        GO TO FINISH;      /*YES, BRANCH TO END             @Y30LB02*/ 31650003
*   ELSE                    /*PROCESS PARAMETERS             @Y30LB02*/ 31700003
*        GO TO COMPROC;     /*BRANCH TO PROCESS PARAMETERS   @Y30LB02*/ 31750003
*/*                                                          @Y30LB02*/ 31800003
*SFORM:                                                                 31850003
*   IF MF(1) ^= '' THEN     /*STANDARD FORM?                 @Y30LB02*/ 31900003
*     DO;                   /*                               @Y30LB02*/ 31950003
*        ERSW=1;            /*SET ERROR SWITCH TO 1          @Y30LB02*/ 32000003
*        RETCODE=12;        /*SET RETURN CODE TO 12          @Y30LB02*/ 32050003
*        ANS MSG('  ICB615I - INVALID MF PARAMETER'||                   32100003
*                ' SPECIFIED, MUST BE L,E, OR NULL')SKIP;  /*@Y30LB02*/ 32150003
*        GO TO CKSW2;       /*BRANCH TO CK SWITCH            @Y30LB02*/ 32200003
*     END;                  /*                               @Y30LB02*/ 32250003
*/*                                                          @Y30LB02*/ 32300003
*   IF FLAGS = '' THEN      /*FLAGS SPECIFIED?               @Y30LB02*/ 32350003
*     DO;                   /*                               @Y30LB02*/ 32400003
*        ERSW=1;            /*SET ERROR SWITCH TO 1          @Y30LB02*/ 32450003
*        RETCODE=12;        /*SET RETURN CODE TO 12          @Y30LB02*/ 32500003
*        ANS MSG('  ICB607I - FLAGS MUST BE SPECIFIED  '||              32550003
*        'FOR STANDARD FORM MACRO ')SKIP;                  /*@Y30LB02*/ 32600003
*        GO TO CKSW2;       /*BRANCH TO CK SWITCH            @Y30LB02*/ 32650003
*     END;                  /*                               @Y30LB02*/ 32700003
*/*                                                          @Y30LB02*/ 32750003
*CKSW2:                                                                 32800003
*/*                                                          @Y30LB02*/ 32850003
*   IF ERSW = 1 THEN        /*ERROR SWITCH ON?               @Y30LB02*/ 32900003
*        GO TO FINISH;      /*YES, BRANCH TO END             @Y30LB02*/ 32950003
*/*                                                          @Y30LB02*/ 33000003
*   IF TUNETES = 1 THEN     /*STANDARD FORM INVOKED BEFORE?  @Y30LB02*/ 33050003
*     DO;                   /*DO NOT PUT OUT DECLARES        @Y30LB02*/ 33100003
*        ANS('/*******************************************'||           33150003
*            '************** @Y30LB02*/')SKIP;                          33200003
*        ANS('/*MACMEAN  MSSC TUNING MACRO                '||           33250003
*            '               @Y30LB02*/')SKIP;                          33300003
*        ANS('/*VS1-4/VS2-3 VERSION--06/09/74 LEVEL 00    '||           33350003
*            '               @Y30LB02*/')SKIP;                          33400003
*        ANS('/*THIS IS THE OUTPUT FOR A SECONDARY        '||           33450003
*            '               @Y30LB02*/')SKIP;                          33500003
*        ANS('/*INVOCATION OF THE STANDARD FORM MACRO     '||           33550003
*            '               @Y30LB02*/')SKIP;                          33600003
*        ANS('/*******************************************'||           33650003
*            '************** @Y30LB02*/')SKIP;                          33700003
*        ANS('RFY(TUNER1)RSTD;/*RESTRICT REG 1 @Y30LB02*/')SKIP;        33750003
*        ANS('TUNER1=ADDR(TUNELEN);/*R1 PTR TO BLK @Y30LB02*/')SKIP;    33800003
*        ANS('TUNELEN= '||QUOTE(TUNLEN)||'X;/*LENGTH OF '||             33850003
*        'TUNING REQUEST @Y30LB02*/')SKIP;                              33900003
*        ANS('TUNEOPCD='||QUOTE(OPCODE)||'X;/*TUNING'||                 33950003
*        ' OPCODE @Y30LB02*/')SKIP;                                     34000003
*        GO TO COMPROC;       /*BRANCH TO CK PARAMETERS      @Y30LB02*/ 34050003
*     END;                    /*                             @Y30LB02*/ 34100003
*/*                                                          @Y30LB02*/ 34150003
*   ELSE                      /*PUT OUT DECLARES             @Y30LB02*/ 34200003
*     DO;                     /*                             @Y30LB02*/ 34250003
*        ANS('/*******************************************'||           34300003
*            '************** @Y30LB02*/')SKIP;                          34350003
*        ANS('/*MACMEAN  MSSC TUNING MACRO                '||           34400003
*            '               @Y30LB02*/')SKIP;                          34450003
*        ANS('/*VS1-4/VS2-3 VERSION--06/09/74 LEVEL 00    '||           34500003
*            '               @Y30LB02*/')SKIP;                          34550003
*        ANS('/*THIS IS THE STANDARD FORM - TUNING MACRO  '||           34600003
*            '               @Y30LB02*/')SKIP;                          34650003
*        ANS('/*******************************************'||           34700003
*            '************** @Y30LB02*/')SKIP;                          34750003
*/*                                                          @Y30LB02*/ 34800003
*        ANS('RFY(TUNER1)RSTD;/*RESTRICT REG 1 @Y30LB02*/')SKIP;        34850003
*        ANS('TUNER1=ADDR(TUNELEN);/*R1 PTR  '||                        34900003
*        'TO LIST @Y30LB02*/')SKIP;                                     34950003
*        ANS('DCL 1 TUNELST  STATIC LOCAL,'||                           35000003
*        ' /*TUNING REQUEST BLOCK @Y30LB02*/')SKIP;                     35050003
*        ANS('    2  TUNELEN  FIXED(31)INIT('||QUOTE                    35100003
*        ('14')||'X),/*LEN OF TUNING REQ BLK @Y30LB02*/')SKIP;          35150003
*        ANS('    2  TUNEOPCD CHAR(1)INIT('||QUOTE                      35200003
*        ('1C')||'X),/*TUNING MACRO OPCODE @YM02853*/')SKIP;            35250003
*        ANS('    2  TUNERES1 CHAR(1)INIT('||QUOTE                      35300003
*        ('00')||'X),/*RESERVED AND ZERO @Y30LB02*/')SKIP;              35350003
*        ANS('    2  TUNEFLAG BIT(16)INIT('||QUOTE                      35400003
*        ('0000000000000000')||'B),/*TWO BYTE ATTRI'||                  35450003
*        'BUTE AREA @Y30LB02*/')SKIP;                                   35500003
*        ANS('       3  TUNMODE BIT(1),/*IF ON, THEN'||                 35550003
*        ' MODIFY MODE-OFF RESULT IN DISPLAY @Y30LB02*/')SKIP;          35600003
*        ANS('       3  TUNRES1 BIT(7),/*SEVEN BITS'||                  35650003
*        ' RESERVED @Y30LB02*/')SKIP;                                   35700003
*        ANS('       3  TUNTHRES BIT(1),/*DISPLAY OR'||                 35750003
*        ' MODIFY THRESHOLDS @Y30LB02*/')SKIP;                          35800003
*        ANS('       3  TUNSLICE BIT(1),/*DISPLAY OR'||                 35850003
*        ' MODIFY SLICE RANGES @Y30LB02*/')SKIP;                        35900003
*        ANS('       3  TUNCLOCK BIT(1),/*DISPLAY OR'||                 35950003
*        ' MODIFY LRU CLOCK @Y30LB02*/')SKIP;                           36000003
*        ANS('       3  TUNRES2 BIT(5),/*5 BITS'||                      36050003
*        ' RESERVED @Y30LB02*/')SKIP;                                   36100003
*        ANS('    2  TUNESDGN  FIXED(8) INIT(0),'||                     36150003
*        '/*STAGING DRIVE GROUP NUMBER @Y30LB02*/')SKIP;                36200003
*        ANS('    2  TUNERES2  CHAR(1) INIT('||QUOTE                    36250003
*        ('00')||'X),/*RESERVED AREA @Y30LB02*/')SKIP;                  36300003
*        ANS('    2  TUNEASID  CHAR(2) INIT('||QUOTE                    36350003
*        ('0000')||'X),/*ADDRESS SPACE ID @Y30LB02*/')SKIP;             36400003
*        ANS('    2  TUNEECB  FIXED(31) INIT(0),'||                     36450003
*        '/*EVENT CONTROL BLOCK @Y30LB02*/')SKIP;                       36500003
*        ANS('    2  TUNEDATA  FIXED(31)INIT(0);'||                     36550003
*        '/*DATA PARAMETER @Y30LB02*/')SKIP;                            36600003
*        TUNETES=TUNETES+1;   /*INCREMENT INVOCATION CTR     @Y30LB02*/ 36650003
*        GO TO COMPROC;       /*BRANCH TO CHECK PARAMETERS   @Y30LB02*/ 36700003
*     END;                    /*                             @Y30LB02*/ 36750003
*/*                                                          @Y30LB02*/ 36800003
*/*********************************************************  @Y30LB02*/ 36850003
*/*      COMMON PROCESSING FOR EXECUTE AND STANDARD FORMS    @Y30LB02*/ 36900003
*/*      THE FOLLOWING CODE WILL CHECK TO DETERMINE WHAT     @Y30LB02*/ 36950003
*/*      PARAMETERS ARE SPECIFIED AND PLACE THE VALUE IN     @Y30LB02*/ 37000003
*/*      THE REQUEST BLOCK                                   @Y30LB02*/ 37050003
*/*********************************************************  @Y30LB02*/ 37100003
*COMPROC:                                                               37150003
*   IF FLAGS ^= '' THEN       /*FLAGS SPECIFIED?             @Y30LB02*/ 37200003
*        ANS('TUNEFLAG= '||FLAGS||';/*VALUE OF FLAGS '||                37250003
*        'PARAMETER @Y30LB02*/')SKIP;                                   37300003
*/*                                                          @Y30LB02*/ 37350003
*   IF SDGNUM ^= '' THEN      /*STAGING DRIVE GROUP SPECD    @Y30LB02*/ 37400003
*        ANS('TUNESDGN= '||SDGNUM||';/*STAGING DRIVE'||                 37450003
*        ' GROUP NUMBER LOADED @Y30LB02*/')SKIP;                        37500003
*/*                                                          @Y30LB02*/ 37550003
*   IF DATA ^= '' THEN        /*DATA SPECIFIED?              @Y30LB02*/ 37600003
*        ANS('TUNEDATA= '||DATA||';/*VALUE OF DATA '||                  37650003
*        'PARAMETER @Y30LB02*/')SKIP;                                   37700003
*/*                                                          @Y30LB02*/ 37750003
*   IF ECB ^= '' THEN         /*ECB SPECIFIED?               @Y30LB02*/ 37800003
*        ANS('TUNEECB=ADDR'||ECB||';/*EVENT CONTROL'||                  37850003
         ' BLOCK ADDRESS LOADED @Y30LB02*/')SKIP;                       37900003
*/********************************************************   @Y30LB02*/ 37950003
*/*      THIS SECTION OF CODE WILL INVOKE SVC 126 AND        @Y30LB02*/ 38000003
*/*      SET THE PROPER RETURN CODE, THEN END PROCESSING     @Y30LB02*/ 38050003
*/********************************************************   @Y30LB02*/ 38100003
*        ANS('SVC (126);/*INVOKE THE SVC  @Y30LB02*/')SKIP;             38150003
*        ANS('RFY (TUNER1)UNRSTD;/*UNRSTD REG ONE  @Y30LB02*/')SKIP;    38200003
*/*                                                          @Y30LB02*/ 38250003
*FINISH:                                                                38300003
*        RETURN CODE(RETCODE);   /*SET THE RETURN CODE       @Y30LB02*/ 38350003
*        %END;                   /*                          @Y30LB02*/ 38400003
