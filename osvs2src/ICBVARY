* %/*  START OF SPECIFICATIONS****                             @Y30LB02 00050003
.*                                                             @Y30LB02 00100003
.*01   MODULE-NAME = ICBVARY                                   @Y30LB02 00150003
.*                                                             @Y30LB02 00200003
.*01   DESCRIPTIVE-NAME = VARYON/VARYOFF MACRO                 @Y30LB02 00250003
.*                                                             @Y30LB02 00300003
.*01   COPYRIGHT = NONE                                        @Y30LB02 00350003
.*                                                             @Y30LB02 00400003
.*01   STATUS = OS/VS1 RELEASE 4, OS/VS2 RELEASE 3             @Y30LB02 00450003
.*                                                             @Y30LB02 00500003
.*01   FUNCTION = REQUEST VARYON/VARYOFF OF SS1 DEVICES        @Y30LB02 00550003
.*                BY THE MSC                                   @Y30LB02 00600003
.*                                                             @Y30LB02 00650003
.*01   NOTES = AS FOLLOWS:                                     @Y30LB02 00700003
.*                                                             @Y30LB02 00750003
.*02     CODE = MACRO IS BILINGUALLY CODED                     @Y30LB02 00800003
.*                                                             @Y30LB02 00850003
.*02     RESTRICTIONS = THE FOLLOWING PREFIXES SHOULD BE       @Y30LB02 00900003
.*                      AVOIDED IN THE USER'S INVOCATION:      @Y30LB02 00950003
.*                      ICB, VON, AND VOF.                     @Y30LB02 01000003
.*                                                             @Y30LB02 01050003
.*02   REGISTER-CONVENTIONS = FOLLOWS NORMAL USE OF REGISTERS  @Y30LB02 01100003
.*                              BY MACROS: R0,R1,R14, AND R15  @Y30LB02 01150003
.*                                                             @Y30LB02 01200003
.*01   MODULE-TYPE = MACRO                                     @Y30LB02 01250003
.*                                                             @Y30LB02 01300003
.*02     PROCESSOR = PLS2 AND ASSEMBLER                        @Y30LB02 01350003
.*                                                             @Y30LB02 01450003
.*02     ATTRIBUTES = REUSABLE                                 @Y30LB02 01500003
.*                                                             @Y30LB02 01550003
.*02     ENTRY-POINT = ICBVARY                                 @Y30LB02 01600003
.*                                                             @Y30LB02 01650003
.*02     PURPOSE = THE VARY ON REQUEST NOTIFIES THE MSS        @Y30LB02 01700003
.*       THAT IT CAN START USING  A SPECIFIED ADDRESSABLE      @Y30LB02 01750003
.*       UNIT; THE VARY OFF REQUEST NOTIFIES THE MSS TO        @Y30LB02 01800003
.*       STOP USING A SPECIFIED ADDRESSABLE UNIT (E.G.         @Y30LB02 01850003
.*       MSF, DRD, DASD UNIT).                                 @Y30LB02 01900003
.*                                                             @Y30LB02 01950003
.*02     LINKAGE = SVC 126                                     @Y30LB02 02000003
.*                                                             @Y30LB02 02050003
.*01  INPUT = PARAMETERS SPECIFIED ON THE PLS/BAL MACRO        @Y30LB02 02100003
.*            INVOCATION                                       @Y30LB02 02150003
.*                                                             @Y30LB02 02200003
.* VARY-ON:  THIS REQUEST IS ISSUED WHEN                       @Y30LB02 02250003
.*  A UNIT PREVIOUSLY ADDRESSABLE TO THE MSC                   @Y30LB02 02300003
.*  IS AVAILABLE FOR USE.  THE UNIT SPECIFIED MAY BE           @Y30LB02 02350003
.*  EITHER A  SUBSYSTEM DASD, DRD, CONTROLLER, STAGING         @Y30LB02 02400003
.*  ADAPTER(SA), MSF OR UC0 OF A MSF.                          @Y30LB02 02450003
.*  VARY-ON COMPLETION IS INDICATED BY DEVICE END.             @Y30LB02 02500003
.*                                                             @Y30LB02 02550003
.*                                                             @Y30LB02 02600003
.* VARY-OFF:  THIS REQUEST IS ISSUED WHEN THE                  @Y30LB02 02650003
.*  MSC IS TO STOP USING A  SPECIFIC UNIT.  THE UNIT           @Y30LB02 02700003
.*  SPECIFIED MAY BE EITHER A SUBSYSTEM DASD, DRD,             @Y30LB02 02750003
.*  CONTROLLER, STAGING ADAPTER(SA), MSF OR UC0 OF A           @Y30LB02 02800003
.*  MSF.  VARY-OFF COMPLETION IS INDICATED BY DEVICE           @Y30LB02 02850003
.*  END, EXCEPT FOR A DASD WITH THE STAGING DASD ATTRIBUTE.    @Y30LB02 02900003
.*                                                             @Y30LB02 02950003
.* MACRO SYNTAX                                                @Y30LB02 03000003
.*   LIST FORM                                                 @Y30LB02 03050003
.*                                                             @Y30LB02 03100003
.* VERB    REQUIRED PARMS        OPTIONAL PARMS                @Y30LB02 03150003
.*                                                             @Y30LB02 03200003
.*ICBVARY  MF=L - (BAL)          MF=(L,MAP) - BAL              @Y30LB02 03250003
.*         MF(L,NAME/(R))-PLS    MF(L,NAME/(R),ATTR)-PLS       @Y30LB02 03300003
.*         TYPE=VON/VOF                                        @Y30LB02 03350003
.*                                                             @Y30LB02 03400003
.*   STANDARD FORM                                             @Y30LB02 03450003
.*                                                             @Y30LB02 03500003
.* VERB    REQUIRED PARMS        OPTIONAL PARMS                @Y30LB02 03550003
.*                                                             @Y30LB02 03600003
.*ICBVARY  TYPE=VON/VOF          ECB=ADDR/(R)                  @Y30LB02 03650003
.*         SSID=ADDR/(R)         FLAGS=ADDR/(R)                @Y30LB02 03700003
.*                               RUA=ADDR/(R)                  @Y30LB02 03750003
.*                                                             @Y30LB02 03800003
.* EXECUTE FORM                                                @Y30LB02 03850003
.*                                                             @Y30LB02 03900003
.* VERB    REQUIRED PARMS        OPTIONAL PARMS                @Y30LB02 03950003
.*                                                             @Y30LB02 04000003
.*ICBVARY  MF(E,NAME/(R))       MF(E,NAME/(R),COMPLETE)-PLS    @Y30LB02 04050003
.*         TYPE=VON/VOF         SSID=ADDR/(R)                  @Y30LB02 04100003
.*                              ECB=ADDR/(R)                   @Y30LB02 04150003
.*                              RUA=ADDR/(R)                   @Y30LB02 04200003
.*                              FLAGS=ADDR/(R)                 @Y30LB02 04250003
.*                                                             @Y30LB02 04300003
.*   KEYWORD PARAMETERS:                                       @Y30LB02 04350003
.*                                                             @Y30LB02 04400003
.*   MF  -  MACRO FORMAT: THIS PARAMETER DESCRIBES THE         @Y30LB02 04450003
.*          MACRO FORMAT AND MAY GIVE THE ADDRESS OR           @Y30LB02 04500003
.*          ADDRESS IN A REGISTER WHERE THE REQUEST BLOCK      @Y30LB02 04550003
.*          IS STORED.                                         @Y30LB02 04600003
.*                                                             @Y30LB02 04650003
.*          L - LIST FORM: THE EXPANSION OF THE L-FORM         @Y30LB02 04700003
.*              MACRO WILL RESULT IN A REQUEST BLOCK WITH      @Y30LB02 04750003
.*              THE ONLY NON-ZERO FIELDS BEING THE OPCODE      @Y30LB02 04800003
.*              AND LENGTH FIELDS.                             @Y30LB02 04850003
.*                                                             @Y30LB02 04900003
.*          (1) 'MAP' - IF MAP IS SPECIFIED WITH THE           @Y30LB02 04950003
.*              ASSEMBLER MACRO CALL A DSECT EQUIVALENT TO     @Y30LB02 05000003
.*              A MAPPING MACRO IS PRODUCED.                   @Y30LB02 05050003
.*                                                             @Y30LB02 05100003
.*          (2) NAME - THE MACRO INVOKER MUST SPECIFY A        @Y30LB02 05150003
.*              NAME FOR HIS STRUCTURE WHEN INVOKING THE       @Y30LB02 05200003
.*              PLS LIST FORM.                                 @Y30LB02 05250003
.*                                                             @Y30LB02 05300003
.*          (3) ATTRIBUTE - THE MACRO WILL PLACE ANY PLS       @Y30LB02 05350003
.*              ATTRIBUTE SPECIFIED IN THE MACRO INVOCATION    @Y30LB02 05400003
.*              IN AN UNINITIALIZED REQUEST BLOCK.  ATTRI-     @Y30LB02 05450003
.*              BUTE EXAMPLE:                                  @Y30LB02 05500003
.*                                                             @Y30LB02 05550003
.*              CHAR, FIXED, STATIC LOCAL, NONLOCAL,           @Y30LB02 05600003
.*              BASED(*), ETC.                                 @Y30LB02 05650003
.*                                                             @Y30LB02 05700003
.*       NULL - STANDARD FORM: THE EXPANSION OF THIS FORM      @Y30LB02 05750003
.*              CONSISTS OF A REQUEST BLOCK, A LINKAGE         @Y30LB02 05800003
.*              INSTRUCTION, AND, POSSIBLY, PARAMETER          @Y30LB02 05850003
.*              BINDING INSTRUCTION.                           @Y30LB02 05900003
.*                                                             @Y30LB02 05950003
.*          E - EXECUTABLE FORM: THE EXPANSION OF THIS FORM    @Y30LB02 06000003
.*              CONSISTS OF A LINKAGE INSTRUCTION AND          @Y30LB02 06050003
.*              POSSIBLY, PARAMETER BINDING INSTRUCTIONS.      @Y30LB02 06100003
.*                                                             @Y30LB02 06150003
.*              SUB-PARAMETERS                                 @Y30LB02 06200003
.*                                                             @Y30LB02 06250003
.*              (1)  AN E MUST BE SPECIFIED IN THE FIRST       @Y30LB02 06300003
.*                   SUB-PARAMETER POSITION.  THIS INDICATES   @Y30LB02 06350003
.*                   THAT THE MACRO IS IN EXECUTABLE FORM.     @Y30LB02 06400003
.*                                                             @Y30LB02 06450003
.*              (2)  A NAME OR A REGISTER MUST BE SPECIFIED    @Y30LB02 06500003
.*                   IN THE SECOND SUB-PARAMETER.              @Y30LB02 06550003
.*                                                             @Y30LB02 06600003
.*              (3)  'COMPLETE' - COMPLETE WILL CAUSE THE      @Y30LB02 06650003
.*                   MACRO TO ZERO OUT THE REQUEST BLOCK.      @Y30LB02 06700003
.*                   AFTER ZEROING THE REQUEST BLOCK THE       @Y30LB02 06750003
.*                   FUNCTION OPCODE AND LENGTH ARE PLACED     @Y30LB02 06800003
.*                   IN THE REQUEST BLOCK.                     @Y30LB02 06850003
.*                                                             @Y30LB02 06900003
.*                                                             @Y30LB02 06950003
.* TYPE- INDICATES WHETHER THE REQUEST IS FOR THE              @Y30LB02 07000003
.*       VARY-ON (VON) OR VARY-OFF (VOF) COMMAND.              @Y30LB02 07050003
.*                                                             @Y30LB02 07100003
.* FLAGS -  THE TWO BYTE FIELD WHICH INDICATES THE             @Y30LB02 07150003
.*  FUNCTION(S) TO BE PERFORMED.  THE FLAGS FIELD IS ONLY      @Y30LB02 07200003
.*  VALID IF THE REQUEST IS FOR SUBSYSTEM DASD.                @Y30LB02 07250003
.*  IF A SUBSYSTEM'S STAGING DEVICE IS REQUESTED, THEN         @Y30LB02 07300003
.*  ONE AND ONLY ONE FLAG BIT MUST BE SET TO '1'B.             @Y30LB02 07350003
.*                                                             @Y30LB02 07400003
.*       -------------------------------------------------     @Y30LB02 07450003
.*       | X | X | X | X |OTHER BITS MUST BE SET TO ZERO |     @Y30LB02 07500003
.*       -------------------------------------------------     @Y30LB02 07550003
.*                                                             @Y30LB02 07600003
.*       BIT 0------------'1'B     STAGING DASD                @Y30LB02 07650003
.*                         '0'B    NO FUNCTION                 @Y30LB02 07700003
.*                                                             @Y30LB02 07750003
.*       BIT 1------------'1'B     REAL DASD                   @Y30LB02 07800003
.*                         '0'B    NO FUNCTION                 @Y30LB02 07850003
.*                                                             @Y30LB02 07900003
.*       BIT 2------------'1'B     NEUTRAL DASD                @Y30LB02 07950003
.*                         '0'B    NO FUNCTION                 @Y30LB02 08000003
.*                                                             @Y30LB02 08050003
.*       BIT 3------------'1'B     TEST DASD                   @Y30LB02 08100003
.*                         '0'B    NO FUNCTION                 @Y30LB02 08150003
.*                                                             @Y30LB02 08200003
.*       BITS 4-15--------         |RESERVED AND MUST BE       @Y30LB02 08250003
.*                                  ZERO|                      @Y30LB02 08300003
.*                                                             @Y30LB02 08350003
.*  STAGING DASD                                               @Y30LB02 08400003
.*                                                             @Y30LB02 08450003
.*   VARY-ON:  THE SPECIFIED SUBSYSTEM DASD IS MADE            @Y30LB02 08500003
.*   AVAILABLE FOR STAGING SPACE.  THE SSID PARAMETER          @Y30LB02 08550003
.*   MUST BE SPECIFIED.                                        @Y30LB02 08600003
.*                                                             @Y30LB02 08650003
.*  VARY-OFF:  THE SPECIFIED SUBSYSTEM DASD IS MADE            @Y30LB02 08700003
.*   UNAVAILABLE FOR STAGING SPACE.  THE CALLER MUST           @Y30LB02 08750003
.*   SPECIFY THE  ECB PARAMETER IN ORDER TO RECEIVE COMPLE-    @Y30LB02 08800003
.*   TION NOTIFICATION OF NECESSARY DESTAGING.                 @Y30LB02 08850003
.*   BOTH THE SSID AND ECB PARAMETERS MUST BE                  @Y30LB02 08900003
.*   SPECIFIED.                                                @Y30LB02 08950003
.*                                                             @Y30LB02 09000003
.*  REAL                                                       @Y30LB02 09050003
.*                                                             @Y30LB02 09100003
.*  VARY-ON:  USE OF THIS ATTRIBUTE CAUSES                     @Y30LB02 09150003
.*   THE SSID SPECIFIED TO BECOME A REAL DASD                  @Y30LB02 09200003
.*   UNTIL VARIED OFF.                                         @Y30LB02 09250003
.*                                                             @Y30LB02 09300003
.*  VARY-OFF: APPLIES ONLY TO DASD WHICH HAVE BEEN             @Y30LB02 09350003
.*   PREVIOUSLY VARIED ON WITH THE REAL ATTRIBUTE.             @Y30LB02 09400003
.*   THE SPINDLE WILL NO LONGER BE DESIGNATED AS REAL.         @Y30LB02 09450003
.*                                                             @Y30LB02 09500003
.*   NEUTRAL                                                   @Y30LB02 09550003
.*                                                             @Y30LB02 09600003
.*  VARY-OFF: THIS ATTRIBUTE APPLIES TO SUBSYSTEM              @Y30LB02 09650003
.*   DASD VARIED ON WITH THE STAGING SUBSYSTEM                 @Y30LB02 09700003
.*   DASD ATTRIBUTE.  THE SPECIFIED DASD IS MARKED             @Y30LB02 09750003
.*   UNAVAILABLE FOR THE MSC AFTER CURRENT STAGE/              @Y30LB02 09800003
.*   DESTAGE ACTIVITY IS COMPLETE.                             @Y30LB02 09850003
.*   A VARYON WITH THE STAGING DASD ATTRIBUTE                  @Y30LB02 09900003
.*   NULLIFIES THE NEUTRAL STATE.                              @Y30LB02 09950003
.*                                                             @Y30LB02 10000003
.*  TEST                                                       @Y30LB02 10050003
.*                                                             @Y30LB02 10100003
.*  VARY-OFF: FOR USE BY OLTEP.                                @Y30LB02 10150003
.*   THE RUA PARAMETER IS REQUIRED.                            @Y30LB02 10200003
.*   THE HOSTID WILL BE INSERTED BY THE MSSC-SVC.              @Y30LB02 10250003
.*   THE PATH INDICATED BY THE RUA (MAY BE                     @Y30LB02 10300003
.*   EITHER A VIRTUAL 3330 UCB OR A REAL 3330                  @Y30LB02 10350003
.*   UCB) WILL BE DESIGNATED REAL FOR OLTEP'S USE.             @Y30LB02 10400003
.*                                                             @Y30LB02 10450003
.*                                                             @Y30LB02 10500003
.* SSID  - SUB-SYSTEM IDENTIFICATION:  A UNIQUE NUMBER         @Y30LB02 10550003
.*  WHICH APPEARS EXTERNALLY ON EACH  UNIT                     @Y30LB02 10600003
.*  IN THE SUBSYSTEM. THE SSID PARAMETER MUST                  @Y30LB02 10650003
.*  BE SPECIFIED WITH EACH VARY REQUEST.                       @Y30LB02 10700003
.*                                                             @Y30LB02 10750003
.* RUA  -   THE UNIT (UCB) TO BE USED BY OLTEP.                @Y30LB02 10800003
.*                                                             @Y30LB02 10850003
.* ECB - THE NAME OF THE EVENT CONTROL BLOCK;                  @Y30LB02 10900003
.*  THE CALLER WILL BE NOTIFIED WHEN THE VARY OFF              @Y30LB02 10950003
.*  PROCESS HAS COMPLETED.  THE ECB PARAMETER IS REQUIRED      @Y30LB02 11000003
.*  ONLY IF THE STAGING DASD ATTRIBUTE IS SPECIFIED            @Y30LB02 11050003
.*  WITH A VARYOFF REQUEST OF A SUBSYSTEM                      @Y30LB02 11100003
.*  DASD UNIT.  THE ECB IS POSTED WITH A POST CODE             @Y30LB02 11150003
.*  OF 71, 72, 73, 74, ETC.. THE POST CODE WILL  BE            @Y30LB02 11200003
.*  PLACED IN THE LOW-ORDER BYTE OF THE ECB - '7F'X            @Y30LB02 11250003
.*  INDICATES SUCCESSFUL COMPLETION.  THE ECB AREA MUST        @Y30LB02 11300003
.*  BE CLEARED(SET TO BINARY 0) BEFORE INVOKING THE MACRO.     @Y30LB02 11350003
.*                                                             @Y30LB02 11400003
.*01  EXIT-NORMAL = VALID INVOCATION                           @Y30LB02 11450003
.*                                                             @Y30LB02 11500003
.*02     CONDITION = RETURN CODE = 0                           @Y30LB02 11550003
.*                                                             @Y30LB02 11600003
.*02     OUTPUT = IN-LINE PLS/BAL STATEMENTS THAT PERFORM      @Y30LB02 11650003
.*                THE REQUESTED FUNCTION                       @Y30LB02 11700003
.*                                                             @Y30LB02 11750003
.*01  EXIT-ERROR = INVALID INVOCATION                          @Y30LB02 11800003
.*                                                             @Y30LB02 11850003
.*02     CONDITION = RETURN CODE = 12                          @Y30LB02 11900003
.*                                                             @Y30LB02 11950003
.*02     OUTPUT = ERROR MESSAGE AS A COMMENT AT POINT OF       @Y30LB02 12000003
.*                INVOCATION                                   @Y30LB02 12050003
.*                                                             @Y30LB02 12100003
.*01  EXTERNAL REFERENCES = NONE                               @Y30LB02 12150003
.*                                                             @Y30LB02 12200003
.*01  TABLES = NONE                                            @Y30LB02 12250003
.*                                                             @Y30LB02 12300003
.*01  MESSAGES = AS FOLLOWS:                                   @Y30LB02 12350003
.*     ICB600I:  TYPE MUST BE SPECIFIED                        @Y30LB02 12400003
.*     ICB601I:  TYPE IS INCORRECTLY SPECIFIED                 @Y30LB02 12450003
.*     ICB602I:  A NAME FOR THE REQUEST BLOCK MUST BE          @Y30LB02 12500003
.*               SPECIFIED IN MF(2)                            @Y30LB02 12550003
.*     ICB603I:  WARNING-ONLY MF AND TYPE PARAMETERS ARE       @Y30LB02 12600003
.*               VALID FOR LIST FORM                           @Y30LB02 12650003
.*     ICB612I:  MF(2) MUST CONTAIN REQ BLK NAME IF            @Y30LB02 12700003
.*               EXEC MACRO FORM REQUESTED                     @Y30LB02 12750003
.*     ICB613I:  MISSING REQ BLK NAME OR MORE                  @Y30LB02 12800003
.*               THAN 2 SUBPARAMETERS FOR MF                   @Y30LB02 12850003
.*     ICB615I:  INVALID MF PARAMETER SPECIFIED, MUST BE       @Y30LB02 12900003
.*               L, E, OR NULL                                 @Y30LB02 12950003
.*                                                             @Y30LB02 13000003
.*01  CONTROL-BLOCKS = NONE                                    @Y30LB02 13050003
.*                                                             @Y30LB02 13100003
.*01  INNER MACROS = NONE                                      @Y30LB02 13150003
.*                                                             @Y30LB02 13200003
.*01  SYSTEM MACRO = IHBINNRA                                  @Y30LB02 13250003
.*                                                             @Y30LB02 13300003
.*01  CHANGE-ACTIVITY = S/D X04AC02 AND Y30LB02                @Y30LB02 13350003
.*                                                             @Y30LB02 13400003
.**** END OF SPECIFICATIONS ***                                @Y30LB02 13450003
         MACRO                                                          13500003
&SYMBOL  ICBVARY &MF=,&TYPE=,&FLAGS=,&ECB=,&RUA=,&SSID=                 13550003
         LCLC  &LBL                DEFINE MACRO INSTR INDX     @Y30LB02 13600003
         LCLB  &ERSW               DEFINE ERROR SWITCH         @Y30LB02 13650003
&LBL     SETC  'V'.'&SYSNDX'       ASSIGN CHARACTER VALUE      @Y30LB02 13700003
.*                                                             @Y30LB02 13750003
.*       CHECK FOR VALID TYPE SPECIFICATION                    @Y30LB02 13800003
.TYPE    AIF   ('&TYPE' EQ '').NUL                             @Y30LB02 13850003
         AIF   ('&TYPE' EQ 'VON' OR '&TYPE' EQ 'VOF').START    @Y30LB02 13900003
         MNOTE 12,'  ICB601I - TYPE IS INCORRECTLY SPECIFIED'  @Y30LB02 13950003
         MEXIT                                                 @Y30LB02 14000003
.*                                                             @Y30LB02 14050003
.NUL     ANOP                                                  @Y30LB02 14100003
         MNOTE 12,'  ICB600I - TYPE MUST BE SPECIFIED '        @Y30LB02 14150003
         MEXIT                                                 @Y30LB02 14200003
.*                                                             @Y30LB02 14250003
.*       DETERMINATION OF DESIRED MACRO FORM                   @Y30LB02 14300003
.*                                                             @Y30LB02 14350003
.START   AIF   ('&MF(1)' EQ 'L').LFORM      LIST FORM?         @Y30LB02 14400003
         AIF   ('&MF(1)' EQ 'E').EFORM      EXECUTE FORM?      @Y30LB02 14450003
         AIF   ('&MF(1)' EQ '').SFORM       STANDARD FORM?     @Y30LB02 14500003
         MNOTE 12,'  ICB615I - INVALID MF PARAMETER '          @Y30LB02 14550003
         MNOTE 12,'  SPECIFIED, MUST BE L, E, OR NULL.'        @Y30LB02 14600003
&ERSW    SETB  1                                               @Y30LB02 14650003
         AGO   .PROCES                                         @Y30LB02 14700003
.*                                                             @Y30LB02 14750003
.*       PROCESSING OF 'LIST' MACRO FORM                       @Y30LB02 14800003
.*       THE FOLLOWING CODE CHECKS FOR ILLEGAL PARAMETERS ON   @Y30LB02 14850003
.*       THE LIST FORM MACRO AND GIVES WARNING IF FOUND        @Y30LB02 14900003
.*                                                             @Y30LB02 14950003
.LFORM   ANOP                                                  @Y30LB02 15000003
         AIF   ('&FLAGS' NE '' OR '&ECB' NE '' OR '&RUA' NE            *15050003
               '' OR '&SSID' NE '').WARN                       @Y30LB02 15100003
         AGO   .LIST1                                          @Y30LB02 15150003
.*                                                             @Y30LB02 15200003
.WARN    MNOTE 4,'  ICB603I - WARNING-ONLY MF AND TYPE '       @Y30LB02 15250003
         MNOTE 4,'  PARAMETERS ARE VALID FOR LIST FORM '       @Y30LB02 15300003
.*                                                             @Y30LB02 15350003
.LIST1   ANOP                                                  @Y30LB02 15400003
         AIF   ('&TYPE' EQ 'VON').VARYON  VARYON REQUEST?      @Y30LB02 15450003
         AIF   ('&MF(2)' EQ 'MAP').VOFDS  DSECT REQUESTED      @Y30LB02 15500003
*  MACMEAN  VARYOFF MACRO--INITIALIZED LIST FORM               @Y30LB02 15550003
*  VS1-4/VS2-3 VERSION--06/09/74   LEVEL 00                    @Y30LB02 15600003
&SYMBOL  DS    0F                                              @Y30LB02 15650003
VOFLEN   DC    F'24'               LENGTH OF VOF REQ BLK       @Y30LB02 15700003
VOFOPCD  DC    XL1'0C'             OPCODE PLACED IN REQ        @Y30LB02 15750003
VOFRES1  DC    XL1'00'             1-BYTE RESERVED AREA        @Y30LB02 15800003
VOFFLAG  DC    XL2'0000'           2-BYTE FLAGS AREA           @Y30LB02 15850003
VOFSSID  DC    XL2'0000'           2-BYTE SSID AREA            @Y30LB02 15900003
VOFRUA   DC    XL2'0000'           2-BYTE RUA AREA             @Y30LB02 15950003
VOFHOST  DC    XL5'0000000000'     5-BYTE HOST ID AREA         @Y30LB02 16000003
VOFRES2  DC    XL1'00'             1-BYTE RESERVED AREA        @Y30LB02 16050003
VOFASID  DC    XL2'0000'           2-BYTE ASID AREA            @Y30LB02 16100003
VOFECB   DC    XL4'00000000'       4-BYTE AREA FOR ECB         @Y30LB02 16150003
         MEXIT                                                 @Y30LB02 16200003
.*                                                             @Y30LB02 16250003
.VOFDS   ANOP                                                  @Y30LB02 16300003
*  MACMEAN  VARYOFF MACRO--UNINITIALIZED LIST FORM             @Y30LB02 16350003
*  VS1-4/VS2-3 VERSION--06/09/74   LEVEL 00                    @Y30LB02 16400003
ICBVARY  DSECT                                                 @Y30LB02 16450003
VOFLEN   DS    F                   LENGTH OF VOF 24 DEC        @Y30LB02 16500003
VOFOPCD  DS    XL1                 VOF OPCODE 0C HEX           @Y30LB02 16550003
VOFRES1  DS    XL1                 1-BYTE RESERVED AREA        @Y30LB02 16600003
VOFFLAG  DS    XL2                 2-BYTE FLAGS AREA           @Y30LB02 16650003
VOFSSID  DS    XL2                 2-BYTE SSID AREA            @Y30LB02 16700003
VOFRUA   DS    XL2                 2-BYTE RUA AREA             @Y30LB02 16750003
VOFHOST  DS    CL5                 5-BYTE HOST ID AREA         @Y30LB02 16800003
VOFRES2  DS    XL1                 1-BYTE RESERVED AREA        @Y30LB02 16850003
VOFASID  DS    XL2                 2-BYTE ASID AREA            @Y30LB02 16900003
VOFECB   DS    A                   4-BYTE ECB ADDR             @Y30LB02 16950003
         MEXIT                                                 @Y30LB02 17000003
.*                                                             @Y30LB02 17050003
.VARYON  ANOP                                                  @Y30LB02 17100003
         AIF   ('&MF(2)' EQ 'MAP').VONDS   DSECT REQUEST       @Y30LB02 17150003
*  MACMEAN  VARYON MACRO--INITIALIZED LIST FORM                @Y30LB02 17200003
*  VS1-4/VS2-3 VERSION--06/09/74   LEVEL 00                    @Y30LB02 17250003
&SYMBOL  DS    0F                                              @Y30LB02 17300003
VONLEN   DC    F'12'               LENGTH OF VON REQ BLK       @Y30LB02 17350003
VONOPCD  DC    XL1'0A'             OPCODE PLACED IN BLOCK      @Y30LB02 17400003
VONRES1  DC    XL1'00'             1-BYTE RESERVED AREA        @Y30LB02 17450003
VONFLAG  DC    XL2'0000'           2-BYTE FLAGS AREA-ZERO      @Y30LB02 17500003
VONSSID  DC    XL2'0000'           2 BYTE SSID AREA            @Y30LB02 17550003
VONRES2  DC    XL2'0000'           2-BYTE RESERVED AREA        @Y30LB02 17600003
         MEXIT                                                 @Y30LB02 17650003
.*                                                             @Y30LB02 17700003
.VONDS   ANOP                                                  @Y30LB02 17750003
*  MACMEAN  VARYON MACRO--UNINITIALIZED LIST FORM              @Y30LB02 17800003
*  VS1-4/VS2-3 VERSION--06/09/74   LEVEL 00                    @Y30LB02 17850003
ICBVARY1 DSECT                                                 @Y30LB02 17900003
VONLEN   DS    F                   LENGTH OF VON 12 DEC        @Y30LB02 17950003
VONOPCD  DS    XL1                 VON OPCODE 0A HEX           @Y30LB02 18000003
VONRES1  DS    XL1                 1-BYTE RESERVED AREA        @Y30LB02 18050003
VONFLAG  DS    XL2                 2-BYTE FLAGS AREA-ZERO      @Y30LB02 18100003
VONSSID  DS    XL2                 2 BYTE SSID AREA            @Y30LB02 18150003
VONRES2  DS    XL2                 2-BYTE RESERVED AREA        @Y30LB02 18200003
         MEXIT                                                 @Y30LB02 18250003
.*       PROCESSING OF THE 'EXECUTE' MACRO FORM                @Y30LB02 18300003
.*                                                             @Y30LB02 18350003
.EFORM   ANOP                                                  @Y30LB02 18400003
         AIF   (N'&MF EQ 2).PARMOK  MORE THAN TWO MF SUB-      @Y30LB02 18450003
.*                                 PARAMETERS SPECD?           @Y30LB02 18500003
         MNOTE 12,'  ICB613I - MISSING REQ BLK NAME OR '       @Y30LB02 18550003
         MNOTE 12,'  MORE THAN 2 SUBPARAMETERS FOR MF '        @Y30LB02 18600003
&ERSW    SETB  1                                               @Y30LB02 18650003
         AGO   .PROCES                                         @Y30LB02 18700003
.*                                                             @Y30LB02 18750003
.PARMOK  ANOP                                                  @Y30LB02 18800003
*  MACMEAN  VARYON/VARYOFF--EXECUTE FORM                       @Y30LB02 18850003
*  VS1-4/VS2-3 VERSION--06/09/74   LEVEL 00                    @Y30LB02 18900003
&SYMBOL  IHBINNRA &MF(2)          LD ADDR OF REQUEST BLK       @Y30LB02 18950003
.*                                USING IHBINNRA MACRO         @Y30LB02 19000003
.*                                                             @Y30LB02 19050003
         AIF   ('&TYPE' EQ 'VON').VON1          TYPE VARYON?   @Y30LB02 19100003
         LA    0,24                LD LENGTH OF VARYOFF        @Y30LB02 19150003
         ST    0,0(1)              STORE LENGTH IN REQ BLK     @Y30LB02 19200003
         MVI   4(1),X'0C'          LOAD VARYOFF OPCODE         @Y30LB02 19250003
         AGO   .PROCES                                         @Y30LB02 19300003
.*                                                             @Y30LB02 19350003
.VON1    ANOP                                                  @Y30LB02 19400003
         LA    0,12                LD LENG OF VARYON REQ       @Y30LB02 19450003
         ST    0,0(1)              STORE LENGTH                @Y30LB02 19500003
         MVI   4(1),X'0A'          LD VARYON OPCODE IN REG     @Y30LB02 19550003
         AGO   .PROCES                                         @Y30LB02 19600003
.*                                                             @Y30LB02 19650003
.*       PROCESSING OF 'STANDARD' MACRO FORM                   @Y30LB02 19700003
.*                                                             @Y30LB02 19750003
.*                                                             @Y30LB02 19800003
.SFORM   ANOP                                                  @Y30LB02 19850003
*  MACMEAN VARYON/VARYOFF MACRO--STANDARD FORM                 @Y30LB02 19900003
*  VS1-4/VS2-3 VERSION--06/09/74   LEVEL 00                    @Y30LB02 19950003
         CNOP 0,4                                              @Y30LB02 20000003
&SYMBOL  BAL   1,&LBL              BRCH AROUND REQ BLK         @Y30LB02 20050003
         AIF   ('&TYPE' EQ 'VON').VON2           VARYON?       @Y30LB02 20100003
VOFLEN   DC    A(&LBL-*)           LENGTH OF VOF REQ BLK       @Y30LB02 20150003
VOFOPCD  DC    XL1'0C'             DEFINE VARYOFF OPCODE       @Y30LB02 20200003
VOFRES1  DC    XL1'00'             1-BYTE RESERVED AREA        @Y30LB02 20250003
VOFFLAG  DC    XL2'0000'           2-BYTE FLAGS AREA           @Y30LB02 20300003
VOFSSID  DC    XL2'0000'           2-BYTE SSID AREA            @Y30LB02 20350003
VOFRUA   DC    XL2'0000'           2-BYTE RUA AREA             @Y30LB02 20400003
VOFHOST  DC    XL5'0000000000'     5-BYTE HOSTID AREA          @Y30LB02 20450003
VOFRES2  DC    XL1'00'             1-BYTE RESERVED AREA        @Y30LB02 20500003
VOFASID  DC    XL2'0000'           2-BYTE ASID AREA            @Y30LB02 20550003
VOFECB   DC    XL4'00000000'       4-BYTE ECB AREA             @Y30LB02 20600003
&LBL     EQU   *                                               @Y30LB02 20650003
         AGO   .PROCES                                         @Y30LB02 20700003
.*                                                             @Y30LB02 20750003
.VON2    ANOP                                                  @Y30LB02 20800003
VONLEN   DC    A(&LBL-*)           LENGTH OF VON REQ BLK       @Y30LB02 20850003
VONOPCD  DC    XL1'0A'             DEFINE VARYON OPCODE        @Y30LB02 20900003
VONRES1  DC    XL1'00'             1-BYTE RESERVED AREA        @Y30LB02 20950003
VONFLAG  DC    XL2'0000'           2-BYTE FLAGS AREA           @Y30LB02 21000003
VONSSID  DC    XL2'0000'           2-BYTE SSID AREA            @Y30LB02 21050003
VONRES2  DC    XL2'0000'           2-BYTE RESERVED AREA        @Y30LB02 21100003
&LBL     EQU   *                                               @Y30LB02 21150003
.*                                                             @Y30LB02 21200003
.*       PROCESS REQUEST BLOCK FOR STANDARD & EXECUTE FORMS    @Y30LB02 21250003
.*                                                             @Y30LB02 21300003
.PROCES  AIF   (&ERSW).FINISH                                  @Y30LB02 21350003
         AIF   ('&FLAGS' EQ '').SSID       FLAGS SPECIFIED?    @Y30LB02 21400003
         AIF   ('&FLAGS'(1,1) EQ '(').REGF   FLAGS REGFORM?    @Y30LB02 21450003
         MVC   6(2,1),&FLAGS       PUT FLAGS IN REQ BLOCK      @Y30LB02 21500003
         AGO   .SSID               BR TO CHECK FOR SSID        @Y30LB02 21550003
.*                                                             @Y30LB02 21600003
.REGF    ANOP                                                  @Y30LB02 21650003
         MVC   6(2,1),0(&FLAGS(1)) REG-FORM-STORE FLAGS        @Y30LB02 21700003
.*                                                             @Y30LB02 21750003
.SSID    AIF   ('&SSID' EQ '').RUA          SSID SPECIFIED?    @Y30LB02 21800003
         AIF   ('&SSID'(1,1) EQ '(').SREG   REG-FORM?          @Y30LB02 21850003
         MVC   8(2,1),&SSID        PUT SSID IN REQ BLOCK       @Y30LB02 21900003
         AGO   .RUA                                            @Y30LB02 21950003
.*                                                             @Y30LB02 22000003
.SREG    ANOP                                                  @Y30LB02 22050003
         MVC   8(2,1),0(&SSID(1))  REG-FORM--STORE SSID        @Y30LB02 22100003
.*                                                             @Y30LB02 22150003
.RUA     AIF   ('&TYPE' EQ 'VON').CVS2     BR IF VARYON        @Y30LB02 22200003
         AIF   ('&RUA' EQ '').CKECB        RUA SPECIFIED?      @Y30LB02 22250003
         AIF   ('&RUA'(1,1) EQ '(').VREG    REG-FORM?          @Y30LB02 22300003
         MVC   10(2,1),&RUA        PUT RUA IN REQ BLOCK        @Y30LB02 22350003
         AGO   .CKECB                                          @Y30LB02 22400003
.*                                                             @Y30LB02 22450003
.VREG    ANOP                                                  @Y30LB02 22500003
         MVC   10(2,1),0(&RUA(1))  REG-FORM--STORE RUA         @Y30LB02 22550003
.*                                                             @Y30LB02 22600003
.CKECB   AIF   ('&ECB' EQ '').CVS2                             @Y30LB02 22650003
         AIF   ('&ECB'(1,1) EQ '(').UREG     REGISTER FORM?    @Y30LB02 22700003
         LA    15,&ECB             LOAD ADDRESS OF ECB         @Y30LB02 22750003
         ST    15,20(1)            STORE ADDRESS OF ECB        @Y30LB02 22800003
         AGO   .CVS2                                           @Y30LB02 22850003
.*                                                             @Y30LB02 22900003
.UREG    ANOP                                                  @Y30LB02 22950003
         ST    &ECB,20(1)          REG-FORM,STORE ECB          @Y30LB02 23000003
.*                                                             @Y30LB02 23050003
.*                                                             @Y30LB02 23100003
.CVS2    ANOP                                                  @Y30LB02 23150003
         SVC   126                 INVOKE SVC                  @Y30LB02 23200003
.FINISH  MEND                                                  @Y30LB02 23250003
**/                                                                     23300003
*   ICBVARY:  MACRO KEYS(MF,TYPE,FLAGS,SSID,RUA,ECB);      /*@Y30LB02*/ 23350003
*/*                                                          @Y30LB02*/ 23400003
*/*            EXTERNAL DECLARES                             @Y30LB02*/ 23450003
*        DCL ICBTESTR FIXED EXT;/*INVOCATION COUNTER         @Y30LB02*/ 23500003
*        DCL VONTEST FIXED EXT; /*COUNTER FOR STANDARD FORM  @Y30LB02*/ 23550003
*        DCL VOFTES1 FIXED EXT;  /*COUNTER FOR  VOF S-FORM   @Y30LB02*/ 23600003
*/*                                                          @Y30LB02*/ 23650003
*/*                                                          @Y30LB02*/ 23700003
*/*            INTERNAL DECLARES                             @Y30LB02*/ 23750003
*/*                                                          @Y30LB02*/ 23800003
*   DCL CTR        FIXED;         /*CTR FOR LIST PARAMETERS  @Y30LB02*/ 23850003
*   DCL ERSW       FIXED;         /*ERROR COND SWITCH        @Y30LB02*/ 23900003
*   DCL VONCOD     CHAR;         /*VARYON OPCODE             @Y30LB02*/ 23950003
*   DCL VOFCOD     CHAR;         /*VARYOFF OPCODE            @Y30LB02*/ 24000003
*   DCL RETCODE    FIXED;        /*RETURN CODE AREA          @Y30LB02*/ 24050003
*   DCL VNLEN      CHAR;         /*LENGTH OF VON REQ BLOCK   @Y30LB02*/ 24100003
*   DCL VFLEN      CHAR;         /*LENGTH OF VOF REQ BLOCK   @Y30LB02*/ 24150003
*        VONCOD='0A';            /*INIT VARYON OPCODE        @Y30LB02*/ 24200003
*        VOFCOD='0C';            /*INITIALIZE VARYOFF OPCOD  @Y30LB02*/ 24250003
*        RETCODE=0;              /*INITIALIZE RETURNCODE     @Y30LB02*/ 24300003
*        VNLEN='0C';             /*INITIALIZE VARYON LENGTH  @Y30LB02*/ 24350003
*        ERSW = 0;               /*INITIALIZE ERROR SWITCH   @Y30LB02*/ 24400003
*        VFLEN='18';             /*INITIALIZE VARYOFF LEN    @Y30LB02*/ 24450003
*        CTR = 0;                /*INITIALIZE PARM COUNTER   @Y30LB02*/ 24500003
*/*                                                          @Y30LB02*/ 24550003
*/*            CHECK FOR VALID TYPE SPECIFICATION            @Y30LB02*/ 24600003
*/*                                                          @Y30LB02*/ 24650003
*   IF TYPE='' THEN              /*TYPE SPECIFIED?           @Y30LB02*/ 24700003
*     DO;                        /*NO,PROCESS ERROR MSG      @Y30LB02*/ 24750003
*        ERSW=1;                 /*SET ERROR SWITCH TO 1     @Y30LB02*/ 24800003
*        ANS MSG('  ICB600I - TYPE MUST BE '||                          24850003
*                'SPECIFIED')SKIP;                         /*@Y30LB02*/ 24900003
*        RETCODE=12;        /*SET RETURN CODE TO 12          @Y30LB02*/ 24950003
*        GO TO FINISH;      /*BRANCH TO END                  @Y30LB02*/ 25000003
*     END;                  /*                               @Y30LB02*/ 25050003
*   IF ERSW=1 THEN          /*ERROR SWITCH SET?              @Y30LB02*/ 25100003
*        GO TO FINISH;      /*YES,BRCH END PROCES            @Y30LB02*/ 25150003
*   IF ICBTESTR = 0 THEN    /*REG 1 ALREADY DCLD?            @Y30LB02*/ 25200003
*      DO;                  /*NO,PRINT DECLARE               @Y30LB02*/ 25250003
*        ANS('DCL ICBR1 REG(1) PTR ;/*'||                               25300003
*        'ADDRESS OF REQUEST BLOCK @Y30LB02*/')SKIP;                    25350003
*        ICBTESTR=1;        /*INCREM DCL COUNTER             @Y30LB02*/ 25400003
*      END;                 /*                               @Y30LB02*/ 25450003
*   IF TYPE(1)='VON' THEN   /*TYPE VARYON?                   @Y30LB02*/ 25500003
*        GO TO START;       /*YES,BRCH,VALID TYPE            @Y30LB02*/ 25550003
*   IF TYPE(1) = 'VOF' THEN /*TYPE VARYOFF?                  @Y30LB02*/ 25600003
*        GO TO START;       /*YES,BRCH,VALID TYPE            @Y30LB02*/ 25650003
*/*                                                          @Y30LB02*/ 25700003
*/*      INVALID 'TYPE' WILL CREATE THE FOLLOWING ERR MSGS   @Y30LB02*/ 25750003
*/*                                                          @Y30LB02*/ 25800003
*   ERSW=1;                 /*SET ERROR SWITCH TO ONE        @Y30LB02*/ 25850003
*   ANS MSG('  ICB601I - TYPE IS INCORRECTLY '||                        25900003
*           'SPECIFIED')SKIP(3);                           /*@Y30LB02*/ 25950003
*   RETCODE=12;             /*SET RETURN CODE TO 12          @Y30LB02*/ 26000003
*   IF ERSW=1 THEN          /*ERROR SWITCH SET TO ONE?       @Y30LB02*/ 26050003
*   GO TO FINISH;           /*YES,BRCH TO END PROCESS        @Y30LB02*/ 26100003
*/*                                                          @Y30LB02*/ 26150003
*START:                                                                 26200003
*   IF MF(1) ^= 'L' THEN    /*LIST FORM REQUEST?             @Y30LB02*/ 26250003
*        GO TO CKFORM;      /*NO,CHECK FOR OTHER FORMS       @Y30LB02*/ 26300003
*   IF MF(2) ^= '' THEN     /*LIST NAME SPECIFIED?           @Y30LB02*/ 26350003
*        GO TO LISTFORM;    /*YES,BRCH PROCESS REQUEST       @Y30LB02*/ 26400003
*   ERSW=1;                 /*NO,SET ERROR SWITCH            @Y30LB02*/ 26450003
*   ANS MSG('  ICB602I - A NAME FOR THE '||                             26500003
*           'REQUEST BLOCK MUST BE SPECIFIED IN '||                     26550003
*           'MF(2) ')SKIP(3);                              /*@Y30LB02*/ 26600003
*   RETCODE=12;             /*SET RETURN CODE TO 12          @Y30LB02*/ 26650003
*   IF ERSW=1 THEN          /*CHECK THE ERROR SWITCH         @Y30LB02*/ 26700003
*   GO TO FINISH;                                          /*@Y30LB02*/ 26750003
*/*                                                          @Y30LB02*/ 26800003
*LISTFORM:                                                              26850003
*/********************************************************@Y30LB02*/    26900003
*/*  CHECK FOR ILLEGAL PARAMETERS AND PRINT OUT DECLARES  @Y30LB02*/    26950003
*/********************************************************@Y30LB02*/    27000003
*   IF FLAGS ^= '' THEN     /*FLAGS SPECIFIED?               @Y30LB02*/ 27050003
*        CTR = CTR + 1;     /*YES,INCREMENT COUNTER          @Y30LB02*/ 27100003
*   IF SSID ^= '' THEN      /*SSID SPECIFIED?                @Y30LB02*/ 27150003
*        CTR = CTR + 1;     /*YES,INCREMENT COUNTER          @Y30LB02*/ 27200003
*   IF RUA ^= '' THEN       /*RUA SPECIFIED?                 @Y30LB02*/ 27250003
*        CTR = CTR + 1;     /*YES,INCREMENT COUNTER          @Y30LB02*/ 27300003
*   IF ECB ^= '' THEN       /*ECB SPECIFIED?                 @Y30LB02*/ 27350003
*        CTR = CTR + 1;     /*YES,INCREMENT COUNTER          @Y30LB02*/ 27400003
*   IF CTR > 0 THEN         /*COUNTER GT ZERO?               @Y30LB02*/ 27450003
*     DO;                   /*YES,WARN USER                  @Y30LB02*/ 27500003
*        RETCODE=4;         /*SET RETURN CODE TO 4           @Y30LB02*/ 27550003
*        ANS MSG('  ICB603I - WARNING-ONLY MF'||                        27600003
*             ' AND TYPE PARAMETERS ARE VALID FOR'||                    27650003
*             ' LIST FORM  ')SKIP(3);                      /*@Y30LB02*/ 27700003
*     END;                  /*                               @Y30LB02*/ 27750003
*/*                                                          @Y30LB02*/ 27800003
*   IF MF(3) ^= '' THEN     /*PLS ATTRIBUTE SPECIFIED?       @Y30LB02*/ 27850003
*       GO TO ATTRLST;      /*YES,PROCESS IT                 @Y30LB02*/ 27900003
*   IF TYPE(1)='VON' THEN   /*IS TYPE VARYON?                @Y30LB02*/ 27950003
*     DO;                   /*YES,PUT VARYON REQ BLOCK       @Y30LB02*/ 28000003
*        ANS('/*******************************************'||           28050003
*            '************** @Y30LB02*/')SKIP;                          28100003
*        ANS('/*MACMEAN  MSSC VARYON MACRO                '||           28150003
*            '               @Y30LB02*/')SKIP;                          28200003
*        ANS('/*VS1-4/VS2-3 VERSION--06/09/74 LEVEL 00    '||           28250003
*            '               @Y30LB02*/')SKIP;                          28300003
*        ANS('/*THIS IS THE INITIALIZED LIST FORM         '||           28350003
*            '               @Y30LB02*/')SKIP;                          28400003
*        ANS('/*******************************************'||           28450003
*           '************** @Y30LB02*/')SKIP;                           28500003
*        ANS('DCL 1 ' ||MF(2)|| '  STATIC LOCAL,'||                     28550003
*        ' /*VARYON REQ BLOCK @Y30LB02*/')SKIP;                         28600003
*        ANS('    2  VONLEN  FIXED(31)INIT('||QUOTE                     28650003
*        ('0C')||'X),/*LENGTH OF VON REQUEST BLOCK @Y30LB02*/')SKIP;    28700003
*        ANS('    2  VONOPCD CHAR(1)INIT('||QUOTE('0A')||               28750003
*        'X),/*VARYON OPCODE @Y30LB02*/')SKIP;                          28800003
*        ANS('    2  VONRES1 CHAR(1)INIT('||QUOTE('00')||               28850003
*        'X), /*ONE BYTE OF ZERO @Y30LB02*/')SKIP;                      28900003
*        ANS('    2  VONFLG BIT(16)INIT('||QUOTE                        28950003
*        ('0000000000000000')||'B), /*FLAGS AREA @Y30LB02*/')SKIP;      29000003
*        ANS('     3  VONSTAG  BIT(1), /*STAGING '||                    29050003
*        'ATTRIBUTE @Y30LB02*/')SKIP;                                   29100003
*        ANS('     3  VONREAL  BIT(1), /*REAL '||                       29150003
*        'ATTRIBUTE @Y30LB02*/')SKIP;                                   29200003
*        ANS('     3  *      BIT(14),'||                                29250003
*        ' /*FOURTEEN BITS RESERVED @Y30LB02*/')SKIP;                   29300003
*        ANS('    2  VONSSID  FIXED(15) INIT(0),'||                     29350003
*        ' /*SUBSYSTEM ID  @Y30LB02*/')SKIP;                            29400003
*        ANS('    2  VONRES2  CHAR(2) INIT('||QUOTE                     29450003
*        ('0000')||'X);/*RESERVED AREA @Y30LB02*/')SKIP;                29500003
*        GO TO FINISH;                                     /*@Y30LB02*/ 29550003
*     END;                                                 /*@Y30LB02*/ 29600003
*/*                                                          @Y30LB02*/ 29650003
*  ELSE                                                                 29700003
*     DO;                                                  /*@Y30LB02*/ 29750003
*        ANS('/*******************************************'||           29800003
*            '************** @Y30LB02*/')SKIP;                          29850003
*        ANS('/*MACMEAN  MSSC VARYOFF MACRO               '||           29900003
*            '               @Y30LB02*/')SKIP;                          29950003
*        ANS('/*VS1-4/VS2-3 VERSION--06/09/74 LEVEL 00    '||           30000003
*            '               @Y30LB02*/')SKIP;                          30050003
*        ANS('/*THIS IS THE INITIALIZED LIST FORM         '||           30100003
*            '               @Y30LB02*/')SKIP;                          30150003
*        ANS('/*******************************************'||           30200003
*            '************** @Y30LB02*/')SKIP;                          30250003
*        ANS('DCL 1 ' ||MF(2)|| '  STATIC LOCAL,'||                     30300003
*        ' /*VARYOFF REQ BLOCK @Y30LB02*/')SKIP;                        30350003
*        ANS('    2  VOFLEN  FIXED(31)INIT('||QUOTE                     30400003
*        ('18')||'X),/*LENGTH OF VOF REQUEST BLK @Y30LB02*/')SKIP;      30450003
*        ANS('    2  VOFOPCD CHAR(1)INIT('||QUOTE('0C')||               30500003
*        'X),/*VARYOFF OPCODE @Y30LB02*/')SKIP;                         30550003
*        ANS('    2  VOFRES1 CHAR(1)INIT('||QUOTE('00')||               30600003
*        'X), /*ONE BYTE OF ZERO @Y30LB02*/')SKIP;                      30650003
*        ANS('    2  VOFFLG BIT(16)INIT('||QUOTE                        30700003
*        ('0000000000000000')||'B), /*FLAGS AREA @Y30LB02*/')SKIP;      30750003
*        ANS('     3  VOFSTAG  BIT(1), /*VIRTUAL '||                    30800003
*        'ATTRIBUTE @Y30LB02*/')SKIP;                                   30850003
*        ANS('     3  VOFREAL  BIT(1), /*REAL '||                       30900003
*        'ATTRIBUTE @Y30LB02*/')SKIP;                                   30950003
*        ANS('     3  VOFNEUT  BIT(1), /*NEUTRAL '||                    31000003
*        'ATTRIBUTE @Y30LB02*/')SKIP;                                   31050003
*        ANS('     3  VOFTEST  BIT(1), /*TEST '||                       31100003
*        'ATTRIBUTE @Y30LB02*/')SKIP;                                   31150003
*        ANS('     3  *      BIT(12),'||                                31200003
*        ' /*TWELVE BITS RESERVED @Y30LB02*/')SKIP;                     31250003
*        ANS('    2  VOFSSID  FIXED(15) INIT(0),'||                     31300003
*        ' /*SUBSYSTEM ID  @Y30LB02*/')SKIP;                            31350003
*        ANS('    2  VOFRUA  FIXED(15) INIT(0),'||                      31400003
*        ' /*REAL UNIT ADDRESS  @Y30LB02*/')SKIP;                       31450003
*        ANS('    2  VOFHOST  CHAR(5) INIT('||QUOTE                     31500003
*        ('0000000000')||'X),/*HOSTID AREA @Y30LB02*/')SKIP;            31550003
*        ANS('    2  *     CHAR(1) INIT('||QUOTE                        31600003
*        ('00')||'X),/*RESERVED AREA @Y30LB02*/')SKIP;                  31650003
*        ANS('    2  VOFASID CHAR(2) INIT('||QUOTE                      31700003
*        ('0000')||'X),/*ASID AREA @Y30LB02*/')SKIP;                    31750003
*        ANS('    2  VOFECB  FIXED(31) INIT(0);'||                      31800003
*        ' /* EVENT CONTROL BLOCK AREA @Y30LB02*/')SKIP;                31850003
*        GO TO FINISH;       /*BRCH TO END                   @Y30LB02*/ 31900003
*     END;                   /*                              @Y30LB02*/ 31950003
*ATTRLST:                                                               32000003
*   IF TYPE(1)='VON' THEN    /*VARYON REQUEST                @Y30LB02*/ 32050003
*     DO;                    /*OUTPUT UNINIT REQ BLOCK       @Y30LB02*/ 32100003
*        ANS('/*******************************************'||           32150003
*            '************* @Y30LB02*/')SKIP;                           32200003
*        ANS('/*MACMEAN  MSSC VARYON MACRO                '||           32250003
*            '              @Y30LB02*/')SKIP;                           32300003
*        ANS('/*VS1-4/VS2-3 VERSION--06/09/74 LEVEL 00    '||           32350003
*            '              @Y30LB02*/')SKIP;                           32400003
*        ANS('/*THIS IS THE UNINITIALIZED LIST FORM       '||           32450003
*            '              @Y30LB02*/')SKIP;                           32500003
*        ANS('/*******************************************'||           32550003
*            '************* @Y30LB02*/')SKIP;                           32600003
*        ANS('DCL 1 ' ||MF(2)||'  '||MF(3)||','||                       32650003
*        ' /*VARYON REQ BLOCK @Y30LB02*/')SKIP;                         32700003
*        ANS('    2  VONLEN  FIXED(31), /*LENGTH'||                     32750003
*        ' OF BLOCK = 0C BYTES HEX @Y30LB02*/')SKIP;                    32800003
*        ANS('    2  VONOPCD CHAR(1),/*VARYON'||                        32850003
*        ' OPCODE = 0A HEX @Y30LB02*/')SKIP;                            32900003
*        ANS('    2  VONRES1 CHAR(1),/*ONE '||                          32950003
*        ' BYTE OF ZERO @Y30LB02*/')SKIP;                               33000003
*        ANS('    2  VONFLG BIT(16), /*FLAGS AREA @Y30LB02*/')SKIP;     33050003
*        ANS('     3  VONSTAG  BIT(1), /*STAGING '||                    33100003
*        'ATTRIBUTE @Y30LB02*/')SKIP;                                   33150003
*        ANS('     3  VONREAL  BIT(1), /*REAL '||                       33200003
*        'ATTRIBUTE @Y30LB02*/')SKIP;                                   33250003
*        ANS('     3  *      BIT(14),'||                                33300003
*        ' /*FOURTEEN BITS RESERVED @Y30LB02*/')SKIP;                   33350003
*        ANS('    2  VONSSID  FIXED(15),'||                             33400003
*        ' /*SUBSYSTEM ID  @Y30LB02*/')SKIP;                            33450003
*        ANS('    2  VONRES2  CHAR(2);'||                               33500003
*        '/*RESERVED AREA @Y30LB02*/')SKIP;                             33550003
*        GO TO FINISH;           /*BRCH TO END               @Y30LB02*/ 33600003
*     END;                       /*                          @Y30LB02*/ 33650003
*/*                                                          @Y30LB02*/ 33700003
*  ELSE                          /*VARYOFF REQUEST           @Y30LB02*/ 33750003
*     DO;                        /*OUTPUT VARYOFF BLOCK      @Y30LB02*/ 33800003
*        ANS('/*******************************************'||           33850003
*            '************** @Y30LB02*/')SKIP;                          33900003
*        ANS('/*MACMEAN  MSSC VARYOFF MACRO               '||           33950003
*            '               @Y30LB02*/')SKIP;                          34000003
*        ANS('/*VS1-4/VS2-3 VERSION--06/09/74 LEVEL 00    '||           34050003
*            '               @Y30LB02*/')SKIP;                          34100003
*        ANS('/*THIS IS THE UNINITIALIZED LIST FORM       '||           34150003
*            '               @Y30LB02*/')SKIP;                          34200003
*        ANS('/*******************************************'||           34250003
*            '************** @Y30LB02*/')SKIP;                          34300003
*        ANS('DCL 1 ' ||MF(2)||'  '||MF(3)||','||                       34350003
*        ' /*VARYOFF REQ BLOCK @Y30LB02*/')SKIP;                        34400003
*        ANS('    2  VOFLEN  FIXED(31),/*LENGTH OF'||                   34450003
*        ' REQUEST BLOCK = 18 HEX @Y30LB02*/')SKIP;                     34500003
*        ANS('    2  VOFOPCD CHAR(1), '||                               34550003
*        '/*VARYOFF OPCODE = 0C HEX @Y30LB02*/')SKIP;                   34600003
*        ANS('    2  VOFRES1  CHAR(1),/*ONE '||                         34650003
*        'BYTE OF ZERO @Y30LB02*/')SKIP;                                34700003
*        ANS('    2  VOFFLG BIT(16),/*FLAGS AREA @Y30LB02*/')SKIP;      34750003
*        ANS('     3  VOFSTAG  BIT(1), /*STAGING '||                    34800003
*        'ATTRIBUTE @Y30LB02*/')SKIP;                                   34850003
*        ANS('     3  VOFREAL  BIT(1), /*REAL '||                       34900003
*        'ATTRIBUTE @Y30LB02*/')SKIP;                                   34950003
*        ANS('     3  VOFNEUT  BIT(1), /*NEUTRAL '||                    35000003
*        'ATTRIBUTE @Y30LB02*/')SKIP;                                   35050003
*        ANS('     3  VOFTEST  BIT(1), /*TEST '||                       35100003
*        'ATTRIBUTE @Y30LB02*/')SKIP;                                   35150003
*        ANS('     3  *      BIT(12),'||                                35200003
*        ' /*TWELVE BITS RESERVED @Y30LB02*/')SKIP;                     35250003
*        ANS('    2  VOFSSID FIXED(15),'||                              35300003
*        ' /*SUBSYSTEM ID  @Y30LB02*/')SKIP;                            35350003
*        ANS('    2  VOFRUA  FIXED(15),'||                              35400003
*        ' /*REAL UNIT ADDRESS  @Y30LB02*/')SKIP;                       35450003
*        ANS('    2  VOFHOST  CHAR(5),'||                               35500003
*        '/*HOSTID AREA @Y30LB02*/')SKIP;                               35550003
*        ANS('    2  * CHAR(1) ,/*RESERVED AREA @Y30LB02*/')SKIP;       35600003
*        ANS('    2  VOFASID  CHAR(2),'||                               35650003
*        '/*ASID AREA @Y30LB02*/')SKIP;                                 35700003
*        ANS('    2  VOFECB  FIXED(31);'||                              35750003
*        ' /* EVENT CONTROL BLOCK AREA @Y30LB02*/')SKIP;                35800003
*        GO TO FINISH;           /*BRANCH TO END             @Y30LB02*/ 35850003
*/*                                                          @Y30LB02*/ 35900003
*     END;                       /*                          @Y30LB02*/ 35950003
*/*                                                          @Y30LB02*/ 36000003
*/*      CHECK FOR EXECUTE FORM SPECIFICATION                @Y30LB02*/ 36050003
*/*                                                          @Y30LB02*/ 36100003
*CKFORM:                                                                36150003
*   IF MF(1) ^= 'E' THEN       /* EXECUTE FORM SPECIFIED?    @Y30LB02*/ 36200003
*        GO TO SFORM;         /*NO,CHECK FOR STANDARD        @Y30LB02*/ 36250003
*   IF MF(2)='' THEN          /* BLOCK NAME SPECIFIED?       @Y30LB02*/ 36300003
*     DO;                     /*YES,PRINT ERROR MESSAGE      @Y30LB02*/ 36350003
*        ANS MSG('  ICB612I - MF(2) MUST CONTAIN'||                     36400003
*                ' REQ BLK NAME IF EXEC'||                              36450003
*                ' MACRO FORM REQUESTED')SKIP(3);          /*@Y30LB02*/ 36500003
*        RETCODE=12;          /*SET RETURN CODE TO 12        @Y30LB02*/ 36550003
*        ERSW = 1;            /*SET ERROR SWITCH             @Y30LB02*/ 36600003
*        GO TO COMPROC;       /*BRCH TO CHECK SWITCH         @Y30LB02*/ 36650003
*     END;                    /*                             @Y30LB02*/ 36700003
*/*                                                          @Y30LB02*/ 36750003
*        ANS('/*******************************************'||           36800003
*            '************** @Y30LB02*/')SKIP;                          36850003
*        ANS('/*MACMEAN  MSSC VARYON/VARYOFF MACRO        '||           36900003
*            '               @Y30LB02*/')SKIP;                          36950003
*        ANS('/*VS1-4/VS2-3 VERSION-- 06/09/74 LEVEL 00   '||           37000003
*            '               @Y30LB02*/')SKIP;                          37050003
*        ANS('/*THIS IS THE OUTPUT FOR THE EXECUTE FORM.  '||           37100003
*            '               @Y30LB02*/')SKIP;                          37150003
*        ANS('/*THE LIST FORM OF THIS MACRO SHOULD BE     '||           37200003
*            '               @Y30LB02*/')SKIP;                          37250003
*        ANS('/*INVOKED FIRST IN ORDER TO SET UP NECESSARY'||           37300003
*            '               @Y30LB02*/')SKIP;                          37350003
*        ANS('/*DECLARES.  IF THE COMPLETE ARGUMENT IS    '||           37400003
*            '               @Y30LB02*/')SKIP;                          37450003
*        ANS('/*SPECIFIED THE REQ BLOCK WILL BE ZEROED.   '||           37500003
*            '               @Y30LB02*/')SKIP;                          37550003
*        ANS('/*******************************************'||           37600003
*            '************** @Y30LB02*/')SKIP;                          37650003
*        ANS('RFY(ICBR1)RSTD;/*RESTRICT REG 1 @Y30LB02*/')SKIP;         37700003
*        ANS('ICBR1=ADDR('||MF(2)||'); /*R1 PTR'||                      37750003
*        ' TO REQUEST BLOCK @Y30LB02*/')SKIP(2);                        37800003
*   IF MF(3) = 'COMPLETE' THEN     /*COMPLETE SPECIFIED      @Y30LB02*/ 37850003
*        GO TO EXCOMP;             /*YES,BRCH TO ZERO BLK    @Y30LB02*/ 37900003
*   ELSE                           /*NO ZERO REQUESTED       @Y30LB02*/ 37950003
*        GO TO COMPROC;            /*BRANCH TO CK PARAMETERS @Y30LB02*/ 38000003
*EXCOMP:                                                                38050003
*        ANS(' '||MF(2)||'='||MF(2)||'&&'||MF(2)||';/*ZERO'||           38100003
*        ' REQUEST BLOCK @Y30LB02*/')SKIP;                              38150003
*        GO TO COMPROC;           /*BRANCH TO CK PARAMETERS  @Y30LB02*/ 38200003
*/*                                                          @Y30LB02*/ 38250003
*/*                                                          @Y30LB02*/ 38300003
*SFORM:                                                                 38350003
*   IF MF(1) ^= '' THEN       /* FORM STANDARD?              @Y30LB02*/ 38400003
*     DO;                     /*PRINT OUT ERROR MESSAGE      @Y30LB02*/ 38450003
*        ANS MSG('  ICB615I - INVALID MF PARAMETER'||                   38500003
*                ' SPECIFIED, MUST BE L,E, OR NULL')SKIP;  /*@Y30LB02*/ 38550003
*        ERSW = 1;            /*SET ERROR SWITCH TO 1        @Y30LB02*/ 38600003
*        RETCODE=12;          /*SET RETURN CODE TO 12        @Y30LB02*/ 38650003
*        GO TO COMPROC;       /*BRANCH TO CK SWITCH          @Y30LB02*/ 38700003
*     END;                    /*                             @Y30LB02*/ 38750003
*/*                                                          @Y30LB02*/ 38800003
*/*                                                          @Y30LB02*/ 38850003
*   IF TYPE(1)='VON' THEN     /*TYPE EQUAL VARYON?           @Y30LB02*/ 38900003
*     IF VONTEST => 1 THEN    /*1ST VARYON STD FORM?         @Y30LB02*/ 38950003
*      DO;                    /*NO,DON'T PRINT DCLS          @Y30LB02*/ 39000003
*        ANS('/*******************************************'||           39050003
*            '************* @Y30LB02*/')SKIP;                           39100003
*        ANS('/*MACMEAN  MSSC VARYON MACRO                '||           39150003
*            '              @Y30LB02*/')SKIP;                           39200003
*        ANS('/*VS1-4/VS2-3 VERSION--06/09/74 LEVEL 00    '||           39250003
*            '              @Y30LB02*/')SKIP;                           39300003
*        ANS('/*THIS IS THE OUTPUT FOR A SECONDARY        '||           39350003
*            '              @Y30LB02*/')SKIP;                           39400003
*        ANS('/*INVOCATION OF THE STANDARD FORM MACRO     '||           39450003
*           '              @Y30LB02*/')SKIP;                            39500003
*        ANS('/*******************************************'||           39550003
*            '************* @Y30LB02*/')SKIP;                           39600003
*        ANS('RFY(ICBR1)RSTD;/*RESTRICT REG 1 @Y30LB02*/')SKIP;         39650003
*        ANS('ICBR1=ADDR(VONLEN);/*PTR TO REQ BLK @Y30LB02*/')SKIP;     39700003
*        GO TO COMPROC;        /*BRANCH TO CK PARAMETERS     @Y30LB02*/ 39750003
*      END;                    /*                            @Y30LB02*/ 39800003
*/*                                                          @Y30LB02*/ 39850003
*     IF TYPE(1) = 'VON' THEN  /*TYPE EQUAL VARYON?          @Y30LB02*/ 39900003
*      DO;                     /*PUT OUT THE DCLS            @Y30LB02*/ 39950003
*        ANS('/*******************************************'||           40000003
*            '************* @Y30LB02*/')SKIP;                           40050003
*        ANS('/*MACMEAN  MSSC VARYON MACRO                '||           40100003
*            '              @Y30LB02*/')SKIP;                           40150003
*        ANS('/*VS1-4/VS2-3 VERSION--06/09/74 LEVEL 00    '||           40200003
*            '              @Y30LB02*/')SKIP;                           40250003
*        ANS('/*THIS IS THE STANDARD FORM - VARYON MACRO  '||           40300003
*            '              @Y30LB02*/')SKIP;                           40350003
*        ANS('/*******************************************'||           40400003
*            '************* @Y30LB02*/')SKIP;                           40450003
*        ANS('RFY(ICBR1)RSTD;/*RESTRICT REG 1 @Y30LB02*/')SKIP;         40500003
*        ANS('ICBR1=ADDR(VONLEN);/*R1 PTR TO REQ BLK @Y30LB02*/')SKIP;  40550003
*        ANS('DCL 1  VONLST01  STATIC LOCAL,'||                         40600003
*        ' /*VARYON REQUEST BLOCK @Y30LB02*/')SKIP;                     40650003
*        ANS('    2  VONLEN  FIXED(31)INIT('||QUOTE('0C')||             40700003
*        'X),/*LENGTH OF VARYON REQ BLK @Y30LB02*/')SKIP;               40750003
*        ANS('    2  VONOPCD CHAR(1)INIT('||QUOTE('0A')||               40800003
*        'X),/*VARYON OPCODE @Y30LB02*/')SKIP;                          40850003
*        ANS('    2  VONRES1 CHAR(1)INIT('||QUOTE('00')||               40900003
*        'X), /*ONE BYTE OF ZERO @Y30LB02*/')SKIP;                      40950003
*        ANS('    2  VONFLG BIT(16)INIT('||QUOTE                        41000003
*        ('0000000000000000')||'B), /*FLAGS AREA @Y30LB02*/')SKIP;      41050003
*        ANS('     3  VONSTAG  BIT(1), /*STAGING '||                    41100003
*        'ATTRIBUTE @Y30LB02*/')SKIP;                                   41150003
*        ANS('     3  VONREAL  BIT(1), /*REAL '||                       41200003
*        'ATTRIBUTE @Y30LB02*/')SKIP;                                   41250003
*        ANS('     3  *      BIT(14),'||                                41300003
*        ' /*FOURTEEN BITS RESERVED @Y30LB02*/')SKIP;                   41350003
*        ANS('    2  VONSSID  FIXED(15) INIT(0),'||                     41400003
*        ' /*SUBSYSTEM ID  @Y30LB02*/')SKIP;                            41450003
*        ANS('    2  VONRES2  CHAR(2) INIT('||QUOTE                     41500003
*        ('0000')||'X);/*RESERVED AREA @Y30LB02*/')SKIP;                41550003
*        VONTEST=VONTEST+1;    /*INCREMENT STD FORM CTR      @Y30LB02*/ 41600003
*        GO TO COMPROC;        /*BRANCH TO CK PARAMETERS     @Y30LB02*/ 41650003
*     END;                     /*                            @Y30LB02*/ 41700003
*/*                                                          @Y30LB02*/ 41750003
*   ELSE                       /*VARYOFF PROCESSING          @Y30LB02*/ 41800003
*     IF VOFTES1 => 1 THEN     /*1ST VARYOFF STD FORM?       @Y30LB02*/ 41850003
*      DO;                     /*NO,DON'T PRINT DCLS         @Y30LB02*/ 41900003
*        ANS('/*******************************************'||           41950003
*            '************** @Y30LB02*/')SKIP;                          42000003
*        ANS('/*MACMEAN  MSSC VARYOFF MACRO               '||           42050003
*            '               @Y30LB02*/')SKIP;                          42100003
*        ANS('/*VS1-4/VS2-3 VERSION--06/09/74 LEVEL 00    '||           42150003
*            '               @Y30LB02*/')SKIP;                          42200003
*        ANS('/*THIS IS THE OUTPUT FOR A SECONDARY        '||           42250003
*            '               @Y30LB02*/')SKIP;                          42300003
*        ANS('/*INVOCATION OF THE STANDARD FORM MACRO     '||           42350003
*            '               @Y30LB02*/')SKIP;                          42400003
*        ANS('/*******************************************'||           42450003
*            '************** @Y30LB02*/')SKIP;                          42500003
*        ANS('RFY(ICBR1)RSTD;/*RESTRICT REG 1 @Y30LB02*/')SKIP;         42550003
*        ANS('ICBR1=ADDR(VOFLEN);/*PTR TO REQ BLK @Y30LB02*/')SKIP;     42600003
*        GO TO COMPROC;        /*BRANCH TO CK PARAMETERS     @Y30LB02*/ 42650003
*      END;                    /*                            @Y30LB02*/ 42700003
*     IF VOFTES1=0 THEN        /*1ST VARYOFF STD FORM        @Y30LB02*/ 42750003
*     DO;                      /*PUT OUT THE DCLS            @Y30LB02*/ 42800003
*        ANS('/*******************************************'||           42850003
*            '************* @Y30LB02*/')SKIP;                           42900003
*        ANS('/*MACMEAN  MSSC VARYOFF MACRO               '||           42950003
*            '              @Y30LB02*/')SKIP;                           43000003
*        ANS('/*VS1-4/VS2-3 VERSION--06/09/74 LEVEL 00    '||           43050003
*            '              @Y30LB02*/')SKIP;                           43100003
*        ANS('/*THIS IS THE STANDARD FORM - VARYOFF MACRO '||           43150003
*            '              @Y30LB02*/')SKIP;                           43200003
*        ANS('/*******************************************'||           43250003
*            '************* @Y30LB02*/')SKIP;                           43300003
*        ANS('RFY(ICBR1)RSTD;/*RESTRICT REG 1 @Y30LB02*/')SKIP;         43350003
*        ANS('ICBR1=ADDR(VOFLEN);/*R1 PTR TO REQ BLK @Y30LB02*/')SKIP;  43400003
*        ANS('DCL 1 VOFLST01  STATIC LOCAL,'||                          43450003
*        ' /*VARYOFF REQUEST BLOCK @Y30LB02*/')SKIP;                    43500003
*        ANS('    2  VOFLEN  FIXED(31)INIT('||QUOTE('18')||             43550003
*        'X),/*LENGTH OF VOF REQ BLOCK @Y30LB02*/')SKIP;                43600003
*        ANS('    2  VOFOPCD CHAR(1)INIT('||QUOTE('0C')||               43650003
*        'X),/*VARYOFF OPCODE @Y30LB02*/')SKIP;                         43700003
*        ANS('    2  VOFRES1 CHAR(1)INIT('||QUOTE('00')||               43750003
*        'X), /*ONE BYTE OF ZERO @Y30LB02*/')SKIP;                      43800003
*        ANS('    2  VOFFLG BIT(16)INIT('||QUOTE                        43850003
*        ('0000000000000000')||'B), /*FLAGS AREA @Y30LB02*/')SKIP;      43900003
*        ANS('     3  VOFSTAG  BIT(1), /*STAGING '||                    43950003
*        'ATTRIBUTE @Y30LB02*/')SKIP;                                   44000003
*        ANS('     3  VOFREAL  BIT(1), /*REAL '||                       44050003
*        'ATTRIBUTE @Y30LB02*/')SKIP;                                   44100003
*        ANS('     3  VOFNEUT  BIT(1), /*NEUTRAL '||                    44150003
*        'ATTRIBUTE @Y30LB02*/')SKIP;                                   44200003
*        ANS('     3  VOFTEST  BIT(1), /*TEST '||                       44250003
*        'ATTRIBUTE @Y30LB02*/')SKIP;                                   44300003
*        ANS('     3  *      BIT(12),'||                                44350003
*        ' /*TWELVE BITS RESERVED @Y30LB02*/')SKIP;                     44400003
*        ANS('    2  VOFSSID  FIXED(15) INIT(0),'||                     44450003
*        ' /*SUBSYSTEM ID  @Y30LB02*/')SKIP;                            44500003
*        ANS('    2  VOFRUA  FIXED(15) INIT(0),'||                      44550003
*        ' /*REAL UNIT ADDRESS  @Y30LB02*/')SKIP;                       44600003
*        ANS('    2  VOFHOST CHAR(5) INIT('||QUOTE                      44650003
*        ('0000000000')||'X),/*HOSTID AREA @Y30LB02*/')SKIP;            44700003
*        ANS('    2  *     CHAR(1) INIT('||QUOTE                        44750003
*        ('00')||'X),/*RESERVED AREA @Y30LB02*/')SKIP;                  44800003
*        ANS('    2  VOFASID  CHAR(2) INIT('||QUOTE                     44850003
*        ('0000')||'X),/*ASID AREA @Y30LB02*/')SKIP;                    44900003
*        ANS('    2  VOFECB  FIXED(31) INIT(0);'||                      44950003
*        ' /* EVENT CONTROL BLOCK AREA @Y30LB02*/')SKIP;                45000003
*        VOFTES1=VOFTES1+1;    /*INCREM VOF STD FORM CTR     @Y30LB02*/ 45050003
*     END;                     /*                            @Y30LB02*/ 45100003
*/*                                                          @Y30LB02*/ 45150003
*COMPROC:                                                               45200003
*/*                                                          @Y30LB02*/ 45250003
*   IF ERSW =1 THEN           /*ERROR SWITCH SET?            @Y30LB02*/ 45300003
*     GO TO FINISH;           /*YES,BRANCH OUT               @Y30LB02*/ 45350003
*/*                                                          @Y30LB02*/ 45400003
*   IF TYPE(1)='VON' THEN  /*VARYON REQUEST?                 @Y30LB02*/ 45450003
*    DO;                   /*PROCESS LEN AND OPCOD           @Y30LB02*/ 45500003
*     ANS('VONLEN=' ||QUOTE(VNLEN)|| 'X;'||                             45550003
*     '  /*LENG-VARYON REQUEST BLOCK @Y30LB02*/')SKIP;                  45600003
*     ANS('VONOPCD=' ||QUOTE(VONCOD)|| 'X;/*VARYON '||                  45650003
*     ' OPCODE @Y30LB02*/')SKIP;                                        45700003
*    END;                   /*                               @Y30LB02*/ 45750003
*/*                                                          @Y30LB02*/ 45800003
*   ELSE                    /*PROCESS LEN AND OPC FOR VOF    @Y30LB02*/ 45850003
*    DO;                    /*                               @Y30LB02*/ 45900003
*     ANS('VOFLEN=' ||QUOTE(VFLEN)|| 'X;'||                             45950003
*     '  /*LENG-VARYOFF REQUEST BLOCK @Y30LB02*/')SKIP;                 46000003
*     ANS('VOFOPCD=' ||QUOTE(VOFCOD)|| 'X;/*OPCODE FOR'||               46050003
*    ' VARYOFF REQ @Y30LB02*/')SKIP;                                    46100003
*    END;                                                  /*@Y30LB02*/ 46150003
*/*                                                          @Y30LB02*/ 46200003
*   IF TYPE(1)='VON' THEN     /*VARYON REQUEST?              @Y30LB02*/ 46250003
*    IF FLAGS ^= '' THEN      /*FLAGS SPECIFIED              @Y30LB02*/ 46300003
*     ANS('VONFLG=' ||FLAGS|| '; /*VALUE OF FLAGS @Y30LB02*/')SKIP;     46350003
*/*                                                          @Y30LB02*/ 46400003
*   IF TYPE(1)='VOF' THEN     /*VARYOFF SPECIFIED?           @Y30LB02*/ 46450003
*    IF FLAGS ^= '' THEN      /*FLAGS SPECIFIED?             @Y30LB02*/ 46500003
*     ANS('VOFFLG=' ||FLAGS|| '; /*VALUE OF FLAGS @Y30LB02*/')SKIP;     46550003
*/*                                                          @Y30LB02*/ 46600003
*   IF SSID ^= '' THEN          /*SSID SPECIFIED?            @Y30LB02*/ 46650003
*    IF TYPE(1) = 'VON' THEN   /*VARYON SPECIFIED?           @Y30LB02*/ 46700003
*     ANS('VONSSID=' ||SSID|| '; /*VALUE OF SSID @Y30LB02*/')SKIP;      46750003
*/*                                                          @Y30LB02*/ 46800003
*   IF SSID ^= '' THEN          /*SSID SPECIFIED ?           @Y30LB02*/ 46850003
*    IF TYPE(1) = 'VOF' THEN    /*VARYOFF SPECIFIED?         @Y30LB02*/ 46900003
*     ANS('VOFSSID= ' ||SSID|| ';/*VALUE OF SSID @Y30LB02*/')SKIP;      46950003
*/*                                                          @Y30LB02*/ 47000003
*   IF TYPE(1) = 'VON' THEN     /*TYPE EQUAL VARYON?         @Y30LB02*/ 47050003
*     GO TO LINK;               /*BRCH TO LINK TO SVC        @Y30LB02*/ 47100003
*/*                                                          @Y30LB02*/ 47150003
*   IF RUA ^= '' THEN           /*RUA SPECIFIED?             @Y30LB02*/ 47200003
*    IF TYPE(1) = 'VOF' THEN    /*TYPE EQUAL VARRYOFF?       @Y30LB02*/ 47250003
*     ANS('VOFRUA= ' ||RUA|| ';/*VALUE OF RUA @Y30LB02*/')SKIP;         47300003
*/*                                                          @Y30LB02*/ 47350003
*   IF ECB ^= ''  THEN    /*ECB SPECIFIED?                   @Y30LB02*/ 47400003
*        ANS('VOFECB=ADDR' ||ECB||';/*ADDRESS OF ECB'||                 47450003
*        ' @Y30LB02*/')SKIP;                                            47500003
*/*                                                          @Y30LB02*/ 47550003
*LINK:                                                                  47600003
*     ANS('SVC   (126);/*INVOKE THE SVC @Y30LB02*/')SKIP;               47650003
*     ANS('RFY  ICBR1  UNRSTD;/*UNRESTRICT REG 1 @Y30LB02*/')SKIP;      47700003
*/*                                                          @Y30LB02*/ 47750003
*FINISH:  RETURN CODE(RETCODE);                            /*@Y30LB02*/ 47800003
*         %END;                                            /*@Y30LB02*/ 47850003
