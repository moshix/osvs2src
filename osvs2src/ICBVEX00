         TITLE '*********** ICBVEX00: MSVC EOV EXTEND SPACE UTILITY ****00001000
               *********'                                               00002000
ICBVEX00 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'ICBVEX00  76.273'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         ST    @13,@SA00001+4                                      0001 00014000
         LA    @14,@SA00001                                        0001 00015000
         ST    @14,8(,@13)                                         0001 00016000
         LR    @13,@14                                             0001 00017000
*   RPLVPTR=REG1;                   /*                       @G24LB35*/ 00018000
         LR    RPLVPTR,REG1                                        0039 00019000
*   RFY                                                            0040 00020000
*     REG1 UNRESTRICTED;            /*                       @G24LB35*/ 00021000
*   VVIPTR=RPLVVICB;                /*                       @G24LB35*/ 00022000
         L     VVIPTR,RPLVVICB(,RPLVPTR)                           0041 00023000
*   PARMPTR=ADDR(RPLVUTIL);         /*                       @G24LB35   00024000
*                                                            @G24LB35*/ 00025000
*                                                                  0042 00026000
         LA    PARMPTR,RPLVUTIL(,RPLVPTR)                          0042 00027000
*   /*****************************************************************/ 00028000
*   /*                                                               */ 00029000
*   /* IF THE MSVI INVENTORY DATA SET IS NOT DISABLED THEN   @G24LB35*/ 00030000
*   /* THE INVENTORY IS RESERVED.                            @G24LB35*/ 00031000
*   /* NOTE - THE RELEASE WILL BE DONE BY ICBVCR00           @G24LB35*/ 00032000
*   /*                                                               */ 00033000
*   /*****************************************************************/ 00034000
*                                                                  0043 00035000
*                                   /*                       @G24LB35*/ 00036000
*   IF VVIFLG0=OFF THEN             /*                       @G24LB35*/ 00037000
         TM    VVIFLG0(VVIPTR),B'10000000'                         0043 00038000
         BNZ   @RF00043                                            0043 00039000
*     RETCODE=ZERO;                 /*                       @G24LB35*/ 00040000
         SLR   RETCODE,RETCODE                                     0044 00041000
*   ELSE                            /*                       @G24LB35*/ 00042000
*     RETCODE=DISABLED;             /*                       @G24LB35   00043000
*                                                            @G24LB35*/ 00044000
*                                                                  0045 00045000
         B     @RC00043                                            0045 00046000
@RF00043 LA    RETCODE,4                                           0045 00047000
*   /*****************************************************************/ 00048000
*   /*                                                               */ 00049000
*   /* CALL TO RESERVE MSVI DATA SET                         @G24LB35*/ 00050000
*   /*                                                               */ 00051000
*   /*****************************************************************/ 00052000
*                                                                  0046 00053000
*                                   /*                       @G24LB35*/ 00054000
*   IF RETCODE=ZERO THEN            /*                       @G24LB35*/ 00055000
@RC00043 LTR   RETCODE,RETCODE                                     0046 00056000
         BNZ   @RF00046                                            0046 00057000
*     DO;                           /*                       @G24LB35*/ 00058000
*       RFY                                                        0048 00059000
*        (REG0,                                                    0048 00060000
*         REG1) RESTRICTED;         /*                       @G24LB35*/ 00061000
*       REG0=RESCODE;               /*                       @G24LB35*/ 00062000
         LA    REG0,1                                              0049 00063000
*       REG1=RPLVPTR;               /*                       @G24LB35*/ 00064000
         LR    REG1,RPLVPTR                                        0050 00065000
*       CALL ICBVRR00;              /*                       @G24LB35*/ 00066000
         L     @15,@CV00293                                        0051 00067000
         BALR  @14,@15                                             0051 00068000
*       RFY                                                        0052 00069000
*        (REG0,                                                    0052 00070000
*         REG1) UNRESTRICTED;       /*                       @G24LB35*/ 00071000
*     END;                          /*                       @G24LB35   00072000
*                                                            @G24LB35*/ 00073000
*                                                                  0054 00074000
*   /*****************************************************************/ 00075000
*   /*                                                               */ 00076000
*   /* THE FINDGRP PROCEDURE IS CALLED TO DETERMINE          @G24LB35*/ 00077000
*   /* WHETHER THE VOLUME IS A GENERAL USE GROUP VOLUME      @G24LB35*/ 00078000
*   /* AND NOT A MEMBER OF SYSGROUP.                         @G24LB35*/ 00079000
*   /*                                                               */ 00080000
*   /*****************************************************************/ 00081000
*                                                                  0054 00082000
*                                   /*                       @G24LB35*/ 00083000
*   IF RETCODE=ZERO THEN            /*                       @G24LB35*/ 00084000
@RF00046 LTR   RETCODE,RETCODE                                     0054 00085000
         BNZ   @RF00054                                            0054 00086000
*     CALL FINDGRP;                 /*                       @G24LB35   00087000
*                                                            @G24LB35*/ 00088000
*                                                                  0055 00089000
         BAL   @14,FINDGRP                                         0055 00090000
*   /*****************************************************************/ 00091000
*   /*                                                               */ 00092000
*   /* IF THE RETURN CODE IS ZERO, THE FINDEXT PROCEDURE     @G24LB35*/ 00093000
*   /* IS CALLED TO LOCATE THE GROUP EXTENSION RECORD AND    @G24LB35*/ 00094000
*   /* THE SLOT LOCATION WITHIN THE EXTENSION RECORD.        @G24LB35*/ 00095000
*   /*                                                               */ 00096000
*   /*****************************************************************/ 00097000
*                                                                  0056 00098000
*                                   /*                       @G24LB35*/ 00099000
*   IF RETCODE=ZERO THEN            /*                       @G24LB35*/ 00100000
@RF00054 LTR   RETCODE,RETCODE                                     0056 00101000
         BNZ   @RF00056                                            0056 00102000
*     CALL FINDEXT;                 /*                       @G24LB35   00103000
*                                                            @G24LB35*/ 00104000
*                                                                  0057 00105000
         BAL   @14,FINDEXT                                         0057 00106000
*   /*****************************************************************/ 00107000
*   /*                                                               */ 00108000
*   /* IF THE RETURN CODE IS ZERO, THE SPACERCD IS CALLED    @G24LB35*/ 00109000
*   /* TO CALCULATE THE AMOUNT OF CYLINDERS ALLOCATED.       @G24LB35*/ 00110000
*   /*                                                               */ 00111000
*   /*****************************************************************/ 00112000
*                                                                  0058 00113000
*                                   /*                       @G24LB35*/ 00114000
*   IF RETCODE=ZERO THEN            /*                       @G24LB35*/ 00115000
@RF00056 LTR   RETCODE,RETCODE                                     0058 00116000
         BNZ   @RF00058                                            0058 00117000
*     CALL SPACERCD;                /*                       @G24LB35   00118000
*                                                            @G24LB35*/ 00119000
         BAL   @14,SPACERCD                                        0059 00120000
*                                                                  0060 00121000
*   /*****************************************************************/ 00122000
*   /*                                                               */ 00123000
*   /* IF THE RETURN CODE IS ZERO, ICBVIO00 IS CALLED TO     @G24LB35*/ 00124000
*   /* WRITE THE EXTENSION RECORD BACK OUT TO THE MSVI DATA  @G24LB35*/ 00125000
*   /* SET. (ANY I/O ERRORS ENCOUNTERED WILL HAVE ERROR      @G24LB35*/ 00126000
*   /* MESSAGES BY ICBVIO00)                                 @G24LB35*/ 00127000
*   /*                                                               */ 00128000
*   /*****************************************************************/ 00129000
*                                                                  0060 00130000
*                                   /*                       @G24LB35*/ 00131000
*   IF RETCODE=ZERO THEN                                           0060 00132000
@RF00058 LTR   RETCODE,RETCODE                                     0060 00133000
         BNZ   @RF00060                                            0060 00134000
*     DO;                           /*                       @G24LB35*/ 00135000
*       RPLVTYP=RPLVPUT;            /*                       @G24LB35*/ 00136000
         MVI   RPLVTYP(RPLVPTR),X'01'                              0062 00137000
*       RFY                                                        0063 00138000
*         REG1 RESTRICTED;          /*                       @G24LB35*/ 00139000
*       REG1=RPLVPTR;               /*                       @G24LB35*/ 00140000
         LR    REG1,RPLVPTR                                        0064 00141000
*       CALL ICBVIO00;              /*                       @G24LB35*/ 00142000
         L     @15,@CV00292                                        0065 00143000
         BALR  @14,@15                                             0065 00144000
*       RFY                                                        0066 00145000
*         REG1 UNRESTRICTED;        /*                       @G24LB35*/ 00146000
*     END;                          /*                       @G24LB35   00147000
*                                                            @G24LB35*/ 00148000
*                                                                  0067 00149000
*   /*****************************************************************/ 00150000
*   /*                                                               */ 00151000
*   /* CONTROL IS RETURNED TO CONTROLLER WITH ZERO RETURN AND REASON */ 00152000
*   /* CODES.                                                @G24LB35*/ 00153000
*   /*                                                               */ 00154000
*   /*****************************************************************/ 00155000
*                                                                  0068 00156000
*                                   /*                       @G24LB35*/ 00157000
*   RETURN;                         /*                       @G24LB35*/ 00158000
@EL00001 L     @13,4(,@13)                                         0068 00159000
@EF00001 DS    0H                                                  0068 00160000
@ER00001 LM    @14,@12,12(@13)                                     0068 00161000
         BR    @14                                                 0068 00162000
*                                                                  0069 00163000
*/********************************************************************/ 00164000
*/*                                                          @G24LB35*/ 00165000
*/*     PROCEDURE NAME - FINDGRP                             @G24LB35*/ 00166000
*/*                                                          @G24LB35*/ 00167000
*/*     FUNCTION - THIS PROCEDURE RECEIVES CONTROL FROM      @G24LB35*/ 00168000
*/*                ICBVEX00 MAIN PROCEDURE, CALLS ICBVIO00   @G24LB35*/ 00169000
*/*                TO READ BASE VOLUME RECORD, DETERMINES IF @G24LB35*/ 00170000
*/*                THE VOLUME IS A GROUP GENERAL USE VOLUME, @G24LB35*/ 00171000
*/*                DETERMINES IF THE VOLUME IS NOT A MEMBER  @G24LB35*/ 00172000
*/*                OF SYSGROUP, AND RETURNS TO ICBVEX00.     @G24LB35*/ 00173000
*/*                                                          @G24LB35*/ 00174000
*/*     INPUT -    THE ARLIST IS USED TO OBTAIN THE VOLSER   @G24LB35*/ 00175000
*/*                                                          @G24LB35*/ 00176000
*/*     OUTPUT -   THE BASEV RECORD IS READ INTO CORE        @G24LB35*/ 00177000
*/*                FOR THE GROUP NAME.   THE RETURN CODE:    @G24LB35*/ 00178000
*/*                   0 = SUCCESSFUL READ OF GROUP RECORD.   @G24LB35*/ 00179000
*/*                   4 = NOT FOUND, NOT IN GROUP, NOT       @G24LB35*/ 00180000
*/*                       GENERAL USE, OR SYSGROUP           @G24LB35*/ 00181000
*/*                                                          @G24LB35*/ 00182000
*/********************************************************************/ 00183000
*                                                                  0069 00184000
*                                   /*                       @G24LB35*/ 00185000
*FINDGRP:                           /*                       @G24LB35*/ 00186000
*   PROCEDURE OPTIONS(SAVE(REG14)); /*                       @G24LB35*/ 00187000
*                                                                  0069 00188000
         B     @EL00001                                            0069 00189000
FINDGRP  ST    @14,@SA00002                                        0069 00190000
*   /*****************************************************************/ 00191000
*   /*                                                               */ 00192000
*   /* DECLARES FOR PROCEDURE                                @G24LB35*/ 00193000
*   /*                                                               */ 00194000
*   /*****************************************************************/ 00195000
*                                                                  0070 00196000
*   DCL                                                            0070 00197000
*     SYSGROUP CHAR(8) INIT('SYSGROUP');/* DEFAULT GROUP     @G24LB35   00198000
*                                                            @G24LB35*/ 00199000
*                                                                  0071 00200000
*   /*****************************************************************/ 00201000
*   /*                                                               */ 00202000
*   /* BUILD THE RPLV TO READ THE BASE VOLUME RECORD         @G24LB35*/ 00203000
*   /* AND CALL ICBVIO00 TO READ RECORD.                     @G24LB35*/ 00204000
*   /*                                                               */ 00205000
*   /*****************************************************************/ 00206000
*                                                                  0071 00207000
*                                   /*                       @G24LB35*/ 00208000
*   BASEVPTR=ADDR(BASEVBUF);        /* ADDRESSIBILITY TO BUF @G24LB35*/ 00209000
         LA    @06,BASEVBUF                                        0071 00210000
         ST    @06,BASEVPTR                                        0071 00211000
*   BASEVNAM=ARVOL;                 /* VOLSER INTO KEY       @G24LB35*/ 00212000
         MVC   BASEVNAM(6),ARVOL(PARMPTR)                          0072 00213000
*   RPLVKEY=ADDR(BASEKEY);          /* ADDRESS OF GROUP KEY  @G24LB35*/ 00214000
         LA    @15,BASEKEY                                         0073 00215000
         ST    @15,RPLVKEY(,RPLVPTR)                               0073 00216000
*   RPLVDIR=ON;                     /* READ DIRECT FLAG ON   @G24LB35*/ 00217000
         OI    RPLVDIR(RPLVPTR),B'01000000'                        0074 00218000
*   RPLVTYP=RPLVREAD;               /* READ GROUP RECORD     @G24LB35*/ 00219000
         MVI   RPLVTYP(RPLVPTR),X'00'                              0075 00220000
*   RPLVBUF=BASEVPTR;               /* ADDRESS OF GVSNE      @G24LB35*/ 00221000
         ST    @06,RPLVBUF(,RPLVPTR)                               0076 00222000
*   RPLVBLN=LENGTH(BASEV);          /* LENGTH OF BUFFER      @G24LB35*/ 00223000
         MVC   RPLVBLN(4,RPLVPTR),@CF00340                         0077 00224000
*   RFY                                                            0078 00225000
*     REG1 RESTRICTED;              /*                       @G24LB35*/ 00226000
*   REG1=RPLVPTR;                   /* PASS RPLV             @G24LB35*/ 00227000
         LR    REG1,RPLVPTR                                        0079 00228000
*   CALL ICBVIO00;                  /* READ GROUP EXT REC    @G24LB35*/ 00229000
         L     @15,@CV00292                                        0080 00230000
         BALR  @14,@15                                             0080 00231000
*   RFY                                                            0081 00232000
*     REG1 UNRESTRICTED;            /*                       @G24LB35*/ 00233000
*                                                                  0081 00234000
*   /*****************************************************************/ 00235000
*   /*                                                               */ 00236000
*   /* ICBVIO00 WILL ISSUE MESSAGES TO THE SPACE MANAGER     @G24LB35*/ 00237000
*   /* SHOULD AN I/O ERROR OCCUR. IF THE RETURN CODE IS      @G24LB35*/ 00238000
*   /* NOT A ZERO THEN SET RETURN CODE TO FOUR.              @G24LB35*/ 00239000
*   /*                                                               */ 00240000
*   /*****************************************************************/ 00241000
*                                                                  0082 00242000
*                                   /*                       @G24LB35*/ 00243000
*   IF RPLVRETC^=ZERO THEN          /*                       @G24LB35*/ 00244000
         LH    @06,RPLVRETC(,RPLVPTR)                              0082 00245000
         N     @06,@CF00347                                        0082 00246000
         LTR   @06,@06                                             0082 00247000
         BZ    @RF00082                                            0082 00248000
*     RETCODE=FOUR;                 /*                       @G24LB35   00249000
*                                                            @G24LB35*/ 00250000
         LA    RETCODE,4                                           0083 00251000
*                                                                  0084 00252000
*   /*****************************************************************/ 00253000
*   /*                                                               */ 00254000
*   /* IF THE RECORD WAS READ SUCCESSFULLY, THE RECORD       @G24LB35*/ 00255000
*   /* WILL BE TESTED TO DETERMINE WHETHER THE VOLUME        @G24LB35*/ 00256000
*   /* IS A GENERAL USE GROUP VOLUME AND WHETHER IT IS A     @G24LB35*/ 00257000
*   /* MEMBER OF SYSGROUP.                                   @G24LB35*/ 00258000
*   /*                                                               */ 00259000
*   /*****************************************************************/ 00260000
*                                                                  0084 00261000
*                                   /*                       @G24LB35*/ 00262000
*   IF RETCODE=ZERO THEN            /*                       @G24LB35*/ 00263000
@RF00082 LTR   RETCODE,RETCODE                                     0084 00264000
         BNZ   @RF00084                                            0084 00265000
*     DO;                           /*                       @G24LB35*/ 00266000
*                                                                  0085 00267000
*       /*************************************************************/ 00268000
*       /*                                                           */ 00269000
*       /* TEST FOR VOLUME BEING A MEMBER OF GROUP,          @G24LB35*/ 00270000
*       /* GENERAL USE, OR A MEMBER OF SYSGROUP              @G24LB35*/ 00271000
*       /*                                                           */ 00272000
*       /*************************************************************/ 00273000
*                                                                  0086 00274000
*       IF BASGRPV=OFF|BASGENUS=OFF|BASGROUP=SYSGROUP THEN         0086 00275000
         L     @06,BASEVPTR                                        0086 00276000
         TM    BASGRPV(@06),B'00110000'                            0086 00277000
         BNO   @RT00086                                            0086 00278000
         CLC   BASGROUP(8,@06),SYSGROUP                            0086 00279000
         BNE   @RF00086                                            0086 00280000
@RT00086 DS    0H                                                  0087 00281000
*         RETCODE=FOUR;             /*                       @G24LB35*/ 00282000
         LA    RETCODE,4                                           0087 00283000
*     END;                          /*                       @G24LB35   00284000
*                                                            @G24LB35*/ 00285000
*                                                                  0088 00286000
*   /*****************************************************************/ 00287000
*   /*                                                               */ 00288000
*   /* RETURN TO CALLER, RETURN CODE IS SET IN RETCODE AREA. @G24LB35*/ 00289000
*   /*                                                               */ 00290000
*   /*****************************************************************/ 00291000
*                                                                  0089 00292000
*                                   /*                       @G24LB35*/ 00293000
*   RETURN;                         /* RET TO ICBVEX00 PROC  @G24LB35   00294000
*                                                            @G24LB35*/ 00295000
@EL00002 DS    0H                                                  0089 00296000
@EF00002 DS    0H                                                  0089 00297000
@ER00002 L     @14,@SA00002                                        0089 00298000
         BR    @14                                                 0089 00299000
*   END FINDGRP;                    /* END OF FINDGRP PROC   @G24LB35*/ 00300000
         B     @EL00002                                            0090 00301000
*                                                                  0091 00302000
*/********************************************************************/ 00303000
*/*                                                          @G24LB35*/ 00304000
*/*     PROCEDURE NAME - FINDEXT                             @G24LB35*/ 00305000
*/*                                                          @G24LB35*/ 00306000
*/*     FUNCTION - THIS PROCEDURE RECEIVES CONTROL FROM      @G24LB35*/ 00307000
*/*                ICBVEX00 MAIN PROCEDURE, CALLS ICBVIO00   @G24LB35*/ 00308000
*/*                TO READ GROUP EXTENSION RECORD, DETERMINES@G24LB35*/ 00309000
*/*                IF THE VOLUME IS WITHIN EXTENSION RECORD, @G24LB35*/ 00310000
*/*                AND RETURNS TO ICBVEX00 WITH VOLUME       @G24LB35*/ 00311000
*/*                POSITION IN EXTENSION RECORD.             @G24LB35*/ 00312000
*/*                                                          @G24LB35*/ 00313000
*/*     INPUT -    THE BASEV RECORD IS USED FOR GROUP NAME   @G24LB35*/ 00314000
*/*                                                          @G24LB35*/ 00315000
*/*     OUTPUT -   THE GVSNE RECORD IS READ INTO CORE FOR    @G24LB35*/ 00316000
*/*                VOLUME INFORMATION.  THE RETURN CODE:     @G24LB35*/ 00317000
*/*                   0 = SUCCESSFUL READ OF GROUP EXTENSION @G24LB35*/ 00318000
*/*                       AND VOLSER LOCATED.                @G24LB35*/ 00319000
*/*                   4 = GVSNE NOT READ OR VOLSER NOT       @G24LB35*/ 00320000
*/*                       LOCATED IN GVSNE.                  @G24LB35*/ 00321000
*/*                                                          @G24LB35*/ 00322000
*/********************************************************************/ 00323000
*                                                                  0091 00324000
*                                   /*                       @G24LB35*/ 00325000
*FINDEXT:                           /*                       @G24LB35*/ 00326000
*   PROCEDURE OPTIONS(SAVE(REG14)); /*                       @G24LB35   00327000
*                                                            @G24LB35*/ 00328000
*                                                                  0091 00329000
FINDEXT  ST    @14,@SA00003                                        0091 00330000
*   /*****************************************************************/ 00331000
*   /*                                                               */ 00332000
*   /* DECLARES FOR PROCEDURE                                @G24LB35*/ 00333000
*   /*                                                               */ 00334000
*   /*****************************************************************/ 00335000
*                                                                  0092 00336000
*                                   /*                       @G24LB35*/ 00337000
*   DCL                                                            0092 00338000
*     FOUNDSW BIT(1);               /* SWITCH FOR LOOP       @G24LB35*/ 00339000
*                                                                  0093 00340000
*   /*****************************************************************/ 00341000
*   /*                                                               */ 00342000
*   /* BUILD THE RPLV TO READ THE GROUP EXTENSION RECORD     @G24LB35*/ 00343000
*   /* AND CALL ICBVIO00 TO READ RECORD.                     @G24LB35*/ 00344000
*   /*                                                               */ 00345000
*   /*****************************************************************/ 00346000
*                                                                  0093 00347000
*                                   /*                       @G24LB35*/ 00348000
*   GVSNEPTR=ADDR(GVSNEBUF);        /* ADDRESSABILITY TO BUF @G24LB35*/ 00349000
         LA    @06,GVSNEBUF                                        0093 00350000
         ST    @06,GVSNEPTR                                        0093 00351000
*   GROUPNAM=BASGROUP;              /* MOVE IN GROUP NAME    @G24LB35*/ 00352000
         L     @01,BASEVPTR                                        0094 00353000
         MVC   GROUPNAM(8),BASGROUP(@01)                           0094 00354000
*   GROUPIND=ONE;                   /* SET INDEX TO ONE      @G24LB35*/ 00355000
         MVI   GROUPIND,X'01'                                      0095 00356000
*   RPLVKEY=ADDR(GROUPKEY);         /* ADDRESS OF GROUP KEY  @G24LB35*/ 00357000
         LA    @15,GROUPKEY                                        0096 00358000
         ST    @15,RPLVKEY(,RPLVPTR)                               0096 00359000
*   RPLVDIR=ON;                     /* READ DIRECT FLAG ON   @G24LB35*/ 00360000
*   RPLVKGE=ON;                     /* READ EQUAL OR GREATER @G24LB35*/ 00361000
         OI    RPLVDIR(RPLVPTR),B'01000100'                        0098 00362000
*   RPLVUPD=ON;                     /* UPDATE MODE           @G24LB35*/ 00363000
         OI    RPLVUPD(RPLVPTR),B'00000010'                        0099 00364000
*   RPLVTYP=RPLVREAD;               /* READ GROUP EXTENSION  @G24LB35*/ 00365000
         MVI   RPLVTYP(RPLVPTR),X'00'                              0100 00366000
*   RPLVBUF=GVSNEPTR;               /* ADDRESS OF GVSNE BUFF @G24LB35*/ 00367000
         ST    @06,RPLVBUF(,RPLVPTR)                               0101 00368000
*   RPLVBLN=LENGTH(GVSNE);          /* LENGTH OF BUFFER      @G24LB35*/ 00369000
         MVC   RPLVBLN(4,RPLVPTR),@CF00341                         0102 00370000
*   RFY                                                            0103 00371000
*     REG1 RESTRICTED;              /*                       @G24LB35*/ 00372000
*   REG1=RPLVPTR;                   /*                       @G24LB35*/ 00373000
         LR    REG1,RPLVPTR                                        0104 00374000
*   CALL ICBVIO00;                  /* READ GROUP EXT REC    @G24LB35*/ 00375000
         L     @15,@CV00292                                        0105 00376000
         BALR  @14,@15                                             0105 00377000
*   RFY                                                            0106 00378000
*     REG1 UNRESTRICTED;            /*                       @G24LB35   00379000
*                                                            @G24LB35*/ 00380000
*                                                                  0106 00381000
*   /*****************************************************************/ 00382000
*   /*                                                               */ 00383000
*   /* ICBVIO00 WILL ISSUE MESSAGES TO THE SPACE MANAGER     @G24LB35*/ 00384000
*   /* SHOULD AN I/O ERROR OCCUR. IF THE RETURN CODE IS      @G24LB35*/ 00385000
*   /* NOT A ZERO, THEN SET RETURN CODE TO FOUR. IF THE      @G24LB35*/ 00386000
*   /* RETURN CODE IS ZERO, SET THE RETURN CODE TO ZERO.     @G24LB35*/ 00387000
*   /*                                                               */ 00388000
*   /*****************************************************************/ 00389000
*                                                                  0107 00390000
*                                   /*                       @G24LB35*/ 00391000
*   IF RPLVRETC^=ZERO THEN          /*                       @G24LB35*/ 00392000
         LH    @06,RPLVRETC(,RPLVPTR)                              0107 00393000
         N     @06,@CF00347                                        0107 00394000
         LTR   @06,@06                                             0107 00395000
         BZ    @RF00107                                            0107 00396000
*     RETCODE=FOUR;                 /*                       @G24LB35   00397000
*                                                            @G24LB35*/ 00398000
         LA    RETCODE,4                                           0108 00399000
*                                                                  0109 00400000
*   /*****************************************************************/ 00401000
*   /*                                                               */ 00402000
*   /* IF THE RECORD WAS READ SUCCESSFULLY AND THE RECORD IS @G24LB35*/ 00403000
*   /* OF THE SAME GROUP, THEN THE SLOTS WILL BE LOOPED      @G24LB35*/ 00404000
*   /* THROUGH TO DETERMINE WHETHER THE VOLSER IS IN THE     @G24LB35*/ 00405000
*   /* GROUP EXTENSION RECORD.                               @G24LB35*/ 00406000
*   /*                                                               */ 00407000
*   /*****************************************************************/ 00408000
*                                                                  0109 00409000
*                                   /*                       @G24LB35*/ 00410000
*   FOUNDSW=OFF;                    /* INITIALIZE OFF        @G24LB35   00411000
*                                                            @G24LB35*/ 00412000
@RF00107 NI    FOUNDSW,B'01111111'                                 0109 00413000
*   IF RETCODE=ZERO THEN            /*                       @G24LB35*/ 00414000
*                                                                  0110 00415000
         LTR   RETCODE,RETCODE                                     0110 00416000
         BNZ   @RF00110                                            0110 00417000
*     /***************************************************************/ 00418000
*     /*                                                             */ 00419000
*     /* CONTROL LOOPS TO READ AND SEARCH GVSNE RECORDS      @G24LB35*/ 00420000
*     /*                                                             */ 00421000
*     /***************************************************************/ 00422000
*                                                                  0111 00423000
*     DO WHILE FOUNDSW=OFF&RETCODE=ZERO&GVSVVGRP=BASGROUP;         0111 00424000
         B     @DE00111                                            0111 00425000
@DL00111 DS    0H                                                  0112 00426000
*       DO SLOT=ONE TO(GVSESIND-ONE) WHILE FOUNDSW=OFF;            0112 00427000
*                                                                  0112 00428000
         LA    @06,1                                               0112 00429000
         B     @DE00112                                            0112 00430000
@DL00112 TM    FOUNDSW,B'10000000'                                 0112 00431000
         BNZ   @DC00112                                            0112 00432000
*         /***********************************************************/ 00433000
*         /*                                                         */ 00434000
*         /* TEST FOR VOLSER IN SLOT.                        @G24LB35*/ 00435000
*         /*                                                         */ 00436000
*         /***********************************************************/ 00437000
*                                                                  0113 00438000
*         IF GVSVOLID(SLOT)=ARVOL THEN/*                     @G24LB35*/ 00439000
         MH    @06,@CH00342                                        0113 00440000
         L     @01,GVSNEPTR                                        0113 00441000
         ALR   @01,@06                                             0113 00442000
         CLC   GVSVOLID-20(6,@01),ARVOL(PARMPTR)                   0113 00443000
         BNE   @RF00113                                            0113 00444000
*           FOUNDSW=ON;             /*                       @G24LB35*/ 00445000
         OI    FOUNDSW,B'10000000'                                 0114 00446000
*       END;                        /*                       @G24LB35*/ 00447000
*                                                                  0115 00448000
@RF00113 LA    @06,1                                               0115 00449000
         AH    @06,SLOT                                            0115 00450000
@DE00112 STH   @06,SLOT                                            0115 00451000
         L     @01,GVSNEPTR                                        0115 00452000
         LH    @15,GVSESIND(,@01)                                  0115 00453000
         BCTR  @15,0                                               0115 00454000
         CR    @06,@15                                             0115 00455000
         BNH   @DL00112                                            0115 00456000
@DC00112 DS    0H                                                  0116 00457000
*       /*************************************************************/ 00458000
*       /*                                                           */ 00459000
*       /* SET SLOT COUNTER BACK TO SLOT WITH VOLUME         @G24LB35*/ 00460000
*       /*                                                           */ 00461000
*       /*************************************************************/ 00462000
*                                                                  0116 00463000
*       SLOT=SLOT-ONE;              /*                       @G24LB35*/ 00464000
*                                                                  0116 00465000
         LH    @06,SLOT                                            0116 00466000
         BCTR  @06,0                                               0116 00467000
         STH   @06,SLOT                                            0116 00468000
*       /*************************************************************/ 00469000
*       /*                                                           */ 00470000
*       /* IF VOLSER STILL NOT FOUND, DETERMINE              @G24LB35*/ 00471000
*       /* IF THERE IS MORE GVSNE RECORDS TO READ            @G24LB35*/ 00472000
*       /*                                                           */ 00473000
*       /*************************************************************/ 00474000
*                                                                  0117 00475000
*       IF FOUNDSW=OFF THEN         /*                       @G24LB35   00476000
*                                                            @G24LB35*/ 00477000
         TM    FOUNDSW,B'10000000'                                 0117 00478000
         BNZ   @RF00117                                            0117 00479000
*         IF GVSEX=ON THEN                                         0118 00480000
         L     @06,GVSNEPTR                                        0118 00481000
         TM    GVSEX(@06),B'10000000'                              0118 00482000
         BNO   @RF00118                                            0118 00483000
*           DO;                     /*                       @G24LB35*/ 00484000
*             GROUPIND=GVSNO+ONE;   /*                       @G24LB35*/ 00485000
         LA    @15,1                                               0120 00486000
         SLR   @14,@14                                             0120 00487000
         IC    @14,GVSNO(,@06)                                     0120 00488000
         ALR   @15,@14                                             0120 00489000
         STC   @15,GROUPIND                                        0120 00490000
*             RFY                                                  0121 00491000
*               REG1 RESTRICTED;    /*                       @G24LB35*/ 00492000
*             REG1=RPLVPTR;         /*                       @G24LB35*/ 00493000
         LR    REG1,RPLVPTR                                        0122 00494000
*             CALL ICBVIO00;        /* READ GROUP EXT REC    @G24LB35*/ 00495000
         L     @15,@CV00292                                        0123 00496000
         BALR  @14,@15                                             0123 00497000
*             RFY                                                  0124 00498000
*               REG1 UNRESTRICTED;  /*                       @G24LB35*/ 00499000
*             IF RPLVRETC^=ZERO THEN/*                       @G24LB35*/ 00500000
         LH    @06,RPLVRETC(,RPLVPTR)                              0125 00501000
         N     @06,@CF00347                                        0125 00502000
         LTR   @06,@06                                             0125 00503000
         BZ    @RF00125                                            0125 00504000
*               RETCODE=FOUR;       /*                       @G24LB35*/ 00505000
         LA    RETCODE,4                                           0126 00506000
*           END;                    /*                       @G24LB35*/ 00507000
*                                                                  0127 00508000
*       /*************************************************************/ 00509000
*       /*                                                           */ 00510000
*       /* IF NO MORE GVSNE TO READ AND VOLSER NOT           @G24LB35*/ 00511000
*       /* FOUND, SET ERROR CODE & FALL THROUGH              @G24LB35*/ 00512000
*       /*                                                           */ 00513000
*       /*************************************************************/ 00514000
*                                                                  0128 00515000
*         ELSE                      /*                       @G24LB35*/ 00516000
*           RETCODE=FOUR;           /*                       @G24LB35*/ 00517000
         B     @RC00118                                            0128 00518000
@RF00118 LA    RETCODE,4                                           0128 00519000
*     END;                          /*                       @G24LB35*/ 00520000
*                                                                  0129 00521000
@RC00118 DS    0H                                                  0129 00522000
@RF00117 DS    0H                                                  0129 00523000
@DE00111 TM    FOUNDSW,B'10000000'                                 0129 00524000
         BNZ   @DC00111                                            0129 00525000
         LTR   RETCODE,RETCODE                                     0129 00526000
         BNZ   @DC00111                                            0129 00527000
         L     @06,GVSNEPTR                                        0129 00528000
         L     @01,BASEVPTR                                        0129 00529000
         CLC   GVSVVGRP(8,@06),BASGROUP(@01)                       0129 00530000
         BE    @DL00111                                            0129 00531000
@DC00111 DS    0H                                                  0130 00532000
*   /*****************************************************************/ 00533000
*   /*                                                               */ 00534000
*   /* ENSURE THAT IF VOLSER WAS NOT FOUND THAT A FOUR CODE  @G24LB35*/ 00535000
*   /* IS SET TO STOP FURTHER PROCESSING.                    @G24LB35*/ 00536000
*   /*                                                               */ 00537000
*   /*****************************************************************/ 00538000
*                                                                  0130 00539000
*   IF FOUNDSW=OFF THEN                                            0130 00540000
@RF00110 TM    FOUNDSW,B'10000000'                                 0130 00541000
         BNZ   @RF00130                                            0130 00542000
*     RETCODE=FOUR;                 /*                       @G24LB35*/ 00543000
         LA    RETCODE,4                                           0131 00544000
*                                                                  0132 00545000
*   /*****************************************************************/ 00546000
*   /*                                                               */ 00547000
*   /* RETURN TO CALLER, RETURN CODE IS SET IN RETCODE AREA. @G24LB35*/ 00548000
*   /*                                                               */ 00549000
*   /*****************************************************************/ 00550000
*                                                                  0132 00551000
*                                   /*                       @G24LB35*/ 00552000
*   RETURN;                         /* RETURN TO ICBVEX00    @G24LB35   00553000
*                                                            @G24LB35*/ 00554000
@EL00003 DS    0H                                                  0132 00555000
@EF00003 DS    0H                                                  0132 00556000
@ER00003 L     @14,@SA00003                                        0132 00557000
         BR    @14                                                 0132 00558000
*   END FINDEXT;                    /* END OF FINDEXT PROC   @G24LB35*/ 00559000
         B     @EL00003                                            0133 00560000
*                                                                  0134 00561000
*/********************************************************************/ 00562000
*/*                                                          @G24LB35*/ 00563000
*/*     PROCEDURE NAME - SPACERCD                            @G24LB35*/ 00564000
*/*                                                          @G24LB35*/ 00565000
*/*     FUNCTION - THIS PROCEDURE RECEIVES CONTROL FROM      @G24LB35*/ 00566000
*/*                ICBVEX00 MAIN PROCEDURE, CALCULATES THE   @G24LB35*/ 00567000
*/*                NUMBER OF CYLINDERS BEING ACQUIRED BY     @G24LB35*/ 00568000
*/*                EOV, UPDATES THE GVSMTDSP VALUE (WHICH IS @G24LB35*/ 00569000
*/*                APPROXIMATE FREE SPACE ON VOLUME) IN THE  @G24LB35*/ 00570000
*/*                GROUP EXTENSION RECORD, AND RETURNS.      @G24LB35*/ 00571000
*/*                                                          @G24LB35*/ 00572000
*/*     INPUT -    THE GVSNE RECORD IS USED FOR GVSMTDSP AND @G24LB35*/ 00573000
*/*                GVSRCFSI FIELD.                           @G24LB35*/ 00574000
*/*                THE ARLIST IS USED FOR ARNMEXT AND AREXT  @G24LB35*/ 00575000
*/*                                                          @G24LB35*/ 00576000
*/*     OUTPUT -   THE GVSNE RECORD IS UPDATED WITH GVSMTDSP @G24LB35*/ 00577000
*/*                THE RETURN CODE IS SET WITH:              @G24LB35*/ 00578000
*/*                   0 = OK - WRITE EXTENSION RECORD        @G24LB35*/ 00579000
*/*                   4 = DO NOT WRITE EXTENSION RECORD      @G24LB35*/ 00580000
*/*                                                          @G24LB35*/ 00581000
*/********************************************************************/ 00582000
*                                                                  0134 00583000
*                                   /*                       @G24LB35*/ 00584000
*SPACERCD:                          /*                       @G24LB35*/ 00585000
*   PROCEDURE OPTIONS(SAVE(REG14)); /*                       @G24LB35   00586000
*                                                            @G24LB35*/ 00587000
*                                                                  0134 00588000
SPACERCD ST    @14,12(,@13)                                        0134 00589000
*   /*****************************************************************/ 00590000
*   /*                                                               */ 00591000
*   /* DECLARES FOR PROCEDURE                                @G24LB35*/ 00592000
*   /*                                                               */ 00593000
*   /*****************************************************************/ 00594000
*                                                                  0135 00595000
*                                   /*                       @G24LB35*/ 00596000
*   DCL                                                            0135 00597000
*     1 EXTENT(16),                 /* EXTENTS ARRAY         @G24LB35*/ 00598000
*      2 BEGCC FIXED(16),           /* BEGINNING EXTENT      @G24LB35*/ 00599000
*      2 ENDCC FIXED(16);           /* ENDING EXTENT         @G24LB35*/ 00600000
*   DCL                                                            0136 00601000
*     ARRAY CHAR(256) BASED(EXTPTR);/* STRUCTURE TO          @G24LB35   00602000
*                                      MOVE UP BOTTOM HALF OF      0136 00603000
*                                                            @G24LB35   00604000
*                                      EXTENT ARRAY AFTER A  @G24LB35   00605000
*                                      CONSOLIDATION 2 EXTS  @G24LB35*/ 00606000
*   DCL                                                            0137 00607000
*     EXTPTR PTR(31);               /* POINTER TO EXTENT ARRAY       */ 00608000
*   DCL                                                            0138 00609000
*     LOOPCTR FIXED(15);            /* SORT LOOP COUNTER     @G24LB35*/ 00610000
*   DCL                                                            0139 00611000
*     SPACE FIXED(15);              /* VARIABLE TO CAL SPACE @G24LB35*/ 00612000
*   DCL                                                            0140 00613000
*     SIXTEEN FIXED(15) INIT(16);   /* NUMBER OF MAX EXTS    @G24LB35*/ 00614000
*   DCL                                                            0141 00615000
*     SORTWORK CHAR(LENGTH(EXTENT));/* REPLACE AREA          @G24LB35*/ 00616000
*   DCL                                                            0142 00617000
*     ELEMENTS FIXED(15);           /* NUMBER OF ELEMENTS    @G24LB35*/ 00618000
*   DCL                                                            0143 00619000
*     EXTCTR FIXED(15);             /* NUMBER OF EXTENTS CTR @G24LB35*/ 00620000
*   DCL                                                            0144 00621000
*     ELEMOVE BIT(1);               /* SWITCH FOR SORTING    @G24LB35*/ 00622000
*   DCL                                                            0145 00623000
*     DONE BIT(1);                  /* SWITCH FOR LOOPING    @G24LB35*/ 00624000
*                                                                  0146 00625000
*   /*****************************************************************/ 00626000
*   /*                                                               */ 00627000
*   /* THE GVSRCFSI BIT INDICATES THAT THE "APPROXIMATE      @G24LB35*/ 00628000
*   /* FREE SPACE" IS INACCURATE. ALSO TESTED IS GVSMTDSP    @G24LB35*/ 00629000
*   /* FOR ALREADY ZERO(LOWEST POSSIBLE). IF EITHER          @G24LB35*/ 00630000
*   /* IS TRUE, THERE IS NO NEED TO UPDATE SPACE.            @G24LB35*/ 00631000
*   /*                                                               */ 00632000
*   /*****************************************************************/ 00633000
*                                                                  0146 00634000
*   IF GVSRCFSI(SLOT)=OFF&GVSMTDSP(SLOT)>ZERO THEN                 0146 00635000
         L     @06,GVSNEPTR                                        0146 00636000
         LH    @15,SLOT                                            0146 00637000
         MH    @15,@CH00342                                        0146 00638000
         ST    @15,@TF00001                                        0146 00639000
         ALR   @15,@06                                             0146 00640000
         TM    GVSRCFSI-20(@15),B'10000000'                        0146 00641000
         BNZ   @RF00146                                            0146 00642000
         L     @01,@TF00001                                        0146 00643000
         LH    @06,GVSMTDSP-20(@01,@06)                            0146 00644000
         LTR   @06,@06                                             0146 00645000
         BNP   @RF00146                                            0146 00646000
*     DO;                           /*                       @G24LB35*/ 00647000
*       ELEMENTS=ARNMEXT;           /* INIT NUMBER OF EXTS   @G24LB35*/ 00648000
*                                                                  0148 00649000
         SLR   ELEMENTS,ELEMENTS                                   0148 00650000
         IC    ELEMENTS,ARNMEXT(,PARMPTR)                          0148 00651000
*       /*************************************************************/ 00652000
*       /*                                                           */ 00653000
*       /* MOVE ACQUIRE EXTENTS INTO WORKAREA                @G24LB35*/ 00654000
*       /*                                                           */ 00655000
*       /*************************************************************/ 00656000
*                                                                  0149 00657000
*       EXTENT(ONE,ONE:LENGTH(EXTENT(ONE))*SIXTEEN)/*        @G24LB35*/ 00658000
*           =AREXT(ONE,ONE:LENGTH(EXTENT(ONE))*SIXTEEN);/*   @G24LB35   00659000
*                                                            @G24LB35*/ 00660000
*                                                                  0149 00661000
         LH    @15,SIXTEEN                                         0149 00662000
         SLA   @15,2                                               0149 00663000
         BCTR  @15,0                                               0149 00664000
         EX    @15,@SM00351                                        0149 00665000
*       /*************************************************************/ 00666000
*       /*                                                           */ 00667000
*       /* IF THE EXTENT IS MADE IN TWO EXTENTS, THEN THE    @G24LB35*/ 00668000
*       /* SORTING IS SKIPPED IN FOLLOWING STEP.             @G24LB35*/ 00669000
*       /*                                                           */ 00670000
*       /*************************************************************/ 00671000
*                                                                  0150 00672000
*                                   /*                       @G24LB35   00673000
*                                                            @G24LB35*/ 00674000
*       IF ELEMENTS>ONE THEN        /*                       @G24LB35*/ 00675000
         C     ELEMENTS,@CF00037                                   0150 00676000
         BNH   @RF00150                                            0150 00677000
*         DO;                       /*                       @G24LB35*/ 00678000
*                                                                  0151 00679000
*           /*********************************************************/ 00680000
*           /*                                                       */ 00681000
*           /* EXTENTS ARE SORTED IN ASCENDING ORDER         @G24LB35*/ 00682000
*           /*                                                       */ 00683000
*           /*********************************************************/ 00684000
*                                                                  0152 00685000
*           DONE=OFF;               /*                       @G24LB35*/ 00686000
         NI    DONE,B'01111111'                                    0152 00687000
*           DO LOOPCTR=ELEMENTS-ONE TO ONE BY-ONE WHILE DONE=OFF;/*     00688000
*                                                            @G24LB35*/ 00689000
         LR    LOOPCTR,ELEMENTS                                    0153 00690000
         BCTR  LOOPCTR,0                                           0153 00691000
         B     @DE00153                                            0153 00692000
@DL00153 TM    DONE,B'10000000'                                    0153 00693000
         BNZ   @DC00153                                            0153 00694000
*             DO EXTCTR=ONE TO LOOPCTR;/*                    @G24LB35*/ 00695000
*                                                                  0154 00696000
         LA    EXTCTR,1                                            0154 00697000
         B     @DE00154                                            0154 00698000
@DL00154 DS    0H                                                  0155 00699000
*               /*****************************************************/ 00700000
*               /*                                                   */ 00701000
*               /* ONCE AN EXTENT IS FOUND OUT OF ORDER,     @G24LB35*/ 00702000
*               /* IT IS EXCHANGED.                          @G24LB35*/ 00703000
*               /*                                                   */ 00704000
*               /*****************************************************/ 00705000
*                                                                  0155 00706000
*               IF EXTENT(EXTCTR,ONE:LENGTH(EXTENT(ONE)))>EXTENT(EXTCTR 00707000
*                   +ONE,ONE:LENGTH(EXTENT(ONE))) THEN             0155 00708000
         LR    @07,EXTCTR                                          0155 00709000
         SLA   @07,2                                               0155 00710000
         LA    @01,EXTENT-4(@07)                                   0155 00711000
         LA    @15,EXTENT(@07)                                     0155 00712000
         CLC   0(4,@01),0(@15)                                     0155 00713000
         BNH   @RF00155                                            0155 00714000
*                 DO;               /*                       @G24LB35*/ 00715000
*                   ELEMOVE=ON;     /*                       @G24LB35*/ 00716000
         OI    ELEMOVE,B'10000000'                                 0157 00717000
*                   SORTWORK=EXTENT(EXTCTR);/*               @G24LB35*/ 00718000
         LA    @01,EXTENT-4(@07)                                   0158 00719000
         MVC   SORTWORK(4),0(@01)                                  0158 00720000
*                   EXTENT(EXTCTR)=EXTENT(EXTCTR+ONE);             0159 00721000
         LA    @01,EXTENT-4(@07)                                   0159 00722000
         LA    @15,EXTENT(@07)                                     0159 00723000
         MVC   0(4,@01),0(@15)                                     0159 00724000
*                   EXTENT(EXTCTR+ONE)=SORTWORK;/*           @G24LB35*/ 00725000
         LA    @01,EXTENT(@07)                                     0160 00726000
         MVC   0(4,@01),SORTWORK                                   0160 00727000
*                 END;              /*                       @G24LB35*/ 00728000
*             END;                  /*                       @G24LB35*/ 00729000
*                                                                  0162 00730000
@RF00155 AL    EXTCTR,@CF00037                                     0162 00731000
@DE00154 CR    EXTCTR,LOOPCTR                                      0162 00732000
         BNH   @DL00154                                            0162 00733000
*             /*******************************************************/ 00734000
*             /*                                                     */ 00735000
*             /* IF AN ELEMENT WAS INTERCHANGED THEN TURN    @G24LB35*/ 00736000
*             /* ELEMOVE SWITCH OFF. IF NO INTERCHANGE WAS   @G24LB35*/ 00737000
*             /* MADE AFTER COMPLETE PASS, TURN DONE SWITCH ON       */ 00738000
*             /*                                             @G24LB35*/ 00739000
*             /*                                                     */ 00740000
*             /*******************************************************/ 00741000
*                                                                  0163 00742000
*                                   /*                       @G24LB35*/ 00743000
*             IF ELEMOVE=ON THEN    /* DETERMINE IF DONE     @G24LB35*/ 00744000
         TM    ELEMOVE,B'10000000'                                 0163 00745000
         BNO   @RF00163                                            0163 00746000
*               ELEMOVE=OFF;        /* RESET ELEMOVE SWITCH  @G24LB35*/ 00747000
         NI    ELEMOVE,B'01111111'                                 0164 00748000
*             ELSE                  /*                       @G24LB35*/ 00749000
*               DONE=ON;            /* INDICATE DONE         @G24LB35*/ 00750000
         B     @RC00163                                            0165 00751000
@RF00163 OI    DONE,B'10000000'                                    0165 00752000
*           END;                    /*                       @G24LB35*/ 00753000
*                                                                  0166 00754000
@RC00163 BCTR  LOOPCTR,0                                           0166 00755000
@DE00153 LTR   LOOPCTR,LOOPCTR                                     0166 00756000
         BP    @DL00153                                            0166 00757000
@DC00153 DS    0H                                                  0167 00758000
*           /*********************************************************/ 00759000
*           /*                                                       */ 00760000
*           /* AFTER THE EXTENTS HAVE BEEN SORTED, THEY      @G24LB35*/ 00761000
*           /* ARE LOOPED THROUGH AND CONSOLIDATED WHERE     @G24LB35*/ 00762000
*           /* THE EXTENTS ARE CONTIGUOUS OR SAME CYLINDERS  @G24LB35*/ 00763000
*           /*                                                       */ 00764000
*           /*********************************************************/ 00765000
*                                                                  0167 00766000
*           DO LOOPCTR=ELEMENTS TO TWO BY-ONE;/*             @G24LB35*/ 00767000
         LR    LOOPCTR,ELEMENTS                                    0167 00768000
         B     @DE00167                                            0167 00769000
@DL00167 DS    0H                                                  0168 00770000
*             IF BEGCC(LOOPCTR)=ENDCC(LOOPCTR-ONE) THEN/*    @G24LB35*/ 00771000
         LR    @07,LOOPCTR                                         0168 00772000
         SLA   @07,2                                               0168 00773000
         LA    @03,BEGCC-4(@07)                                    0168 00774000
         LA    @01,ENDCC-8(@07)                                    0168 00775000
         CLC   0(2,@03),0(@01)                                     0168 00776000
         BNE   @RF00168                                            0168 00777000
*               DO;                 /*                       @G24LB35*/ 00778000
*                                                                  0169 00779000
*                 /***************************************************/ 00780000
*                 /*                                                 */ 00781000
*                 /* THE LARGEST ENDING CC OF THE TWO IS USED        */ 00782000
*                 /*                                         @G24LB35*/ 00783000
*                 /*                                                 */ 00784000
*                 /***************************************************/ 00785000
*                                                                  0170 00786000
*                 ENDCC(LOOPCTR-ONE)=ENDCC(LOOPCTR);/*       @G24LB35*/ 00787000
*                                                                  0170 00788000
         LH    @03,ENDCC-4(@07)                                    0170 00789000
         N     @03,@CF00347                                        0170 00790000
         STH   @03,ENDCC-8(@07)                                    0170 00791000
*                 /***************************************************/ 00792000
*                 /*                                                 */ 00793000
*                 /* ALL THE EXTENTS BELOW ARE MOVED UP ONE  @G24LB35*/ 00794000
*                 /*                                                 */ 00795000
*                 /***************************************************/ 00796000
*                                                                  0171 00797000
*                 IF LOOPCTR<SIXTEEN THEN/*                  @G24LB35*/ 00798000
         LH    @03,SIXTEEN                                         0171 00799000
         CR    LOOPCTR,@03                                         0171 00800000
         BNL   @RF00171                                            0171 00801000
*                   DO;             /*                       @G24LB35*/ 00802000
*                     EXTPTR=ADDR(EXTENT(LOOPCTR+ONE));/*    @G24LB35*/ 00803000
         LA    EXTPTR,EXTENT(@07)                                  0173 00804000
*                     EXTENT(LOOPCTR,ONE:LENGTH(EXTENT)*/*   @G24LB35*/ 00805000
*                         (SIXTEEN-LOOPCTR))=ARRAY;/*        @G24LB35*/ 00806000
         LA    @01,EXTENT-4(@07)                                   0174 00807000
         LH    @07,SIXTEEN                                         0174 00808000
         SLR   @07,LOOPCTR                                         0174 00809000
         SLA   @07,2                                               0174 00810000
         BCTR  @07,0                                               0174 00811000
         EX    @07,@SM00353                                        0174 00812000
*                   END;            /*                       @G24LB35*/ 00813000
*                 ELEMENTS=ELEMENTS-ONE;/*                   @G24LB35*/ 00814000
@RF00171 BCTR  ELEMENTS,0                                          0176 00815000
*               END;                /*                       @G24LB35*/ 00816000
*           END;                    /*                       @G24LB35*/ 00817000
@RF00168 BCTR  LOOPCTR,0                                           0178 00818000
@DE00167 C     LOOPCTR,@CF00054                                    0178 00819000
         BNL   @DL00167                                            0178 00820000
*         END;                      /*                       @G24LB35*/ 00821000
*                                                                  0179 00822000
*       /*************************************************************/ 00823000
*       /*                                                           */ 00824000
*       /* THE SORTED AND CONSOLIDATED EXTENTS ARE LOOPED    @G24LB35*/ 00825000
*       /* THROUGH AND THE SPACE USED IS CALCULATED.         @G24LB35*/ 00826000
*       /*                                                           */ 00827000
*       /*************************************************************/ 00828000
*                                                                  0180 00829000
*       SPACE=ZERO;                 /*                       @G24LB35*/ 00830000
@RF00150 SLR   SPACE,SPACE                                         0180 00831000
*       DO LOOPCTR=ONE TO ELEMENTS BY ONE;/*                 @G24LB35*/ 00832000
         LA    LOOPCTR,1                                           0181 00833000
         B     @DE00181                                            0181 00834000
@DL00181 DS    0H                                                  0182 00835000
*         SPACE=SPACE+ENDCC(LOOPCTR)-BEGCC(LOOPCTR)+ONE;           0182 00836000
         LR    @07,LOOPCTR                                         0182 00837000
         SLA   @07,2                                               0182 00838000
         LR    @15,SPACE                                           0182 00839000
         LH    @14,ENDCC-4(@07)                                    0182 00840000
         N     @14,@CF00347                                        0182 00841000
         ALR   @15,@14                                             0182 00842000
         LH    @07,BEGCC-4(@07)                                    0182 00843000
         N     @07,@CF00347                                        0182 00844000
         SLR   @15,@07                                             0182 00845000
         AL    @15,@CF00037                                        0182 00846000
         LR    SPACE,@15                                           0182 00847000
*       END;                        /*                       @G24LB35*/ 00848000
*                                                                  0183 00849000
         AL    LOOPCTR,@CF00037                                    0183 00850000
@DE00181 CR    LOOPCTR,ELEMENTS                                    0183 00851000
         BNH   @DL00181                                            0183 00852000
*       /*************************************************************/ 00853000
*       /*                                                           */ 00854000
*       /* THE SPACE USED IS DECREMENTED FROM THE GVSNE.     @G24LB35*/ 00855000
*       /* IF THE SPACE TO BE DECREMENTED IS LARGER THAN     @G24LB35*/ 00856000
*       /* THE AMOUNT OF RUNNING FREE SPACE, IT IS SET       @G24LB35*/ 00857000
*       /* TO ITS LOWEST POSSIBLE VALUE - ZERO.              @G24LB35*/ 00858000
*       /*                                                           */ 00859000
*       /*************************************************************/ 00860000
*                                                                  0184 00861000
*       IF GVSMTDSP(SLOT)<SPACE THEN/*                       @G24LB35*/ 00862000
         L     @02,GVSNEPTR                                        0184 00863000
         LH    @15,SLOT                                            0184 00864000
         MH    @15,@CH00342                                        0184 00865000
         CH    SPACE,GVSMTDSP-20(@15,@02)                          0184 00866000
         BNH   @RF00184                                            0184 00867000
*         GVSMTDSP(SLOT)=ZERO;      /*                       @G24LB35*/ 00868000
         SLR   @14,@14                                             0185 00869000
         STH   @14,GVSMTDSP-20(@15,@02)                            0185 00870000
*       ELSE                        /*                       @G24LB35*/ 00871000
*         GVSMTDSP(SLOT)=GVSMTDSP(SLOT)-SPACE;/*             @G24LB35*/ 00872000
         B     @RC00184                                            0186 00873000
@RF00184 L     @02,GVSNEPTR                                        0186 00874000
         LH    @15,SLOT                                            0186 00875000
         MH    @15,@CH00342                                        0186 00876000
         LH    @14,GVSMTDSP-20(@15,@02)                            0186 00877000
         SLR   @14,SPACE                                           0186 00878000
         STH   @14,GVSMTDSP-20(@15,@02)                            0186 00879000
*     END;                          /*                       @G24LB35*/ 00880000
*                                                                  0187 00881000
*   /*****************************************************************/ 00882000
*   /*                                                               */ 00883000
*   /* IF THE INVALID RUNNING SPACE FLAG IS                  @G24LB35*/ 00884000
*   /* FOUND ON OR THE RUNNING SPACE IS ALREADY ZERO,        @G24LB35*/ 00885000
*   /* THE NO SPACE UPDATE CODE IS SET SO THE RECORD         @G24LB35*/ 00886000
*   /* WILL NOT BE REWRITTEN BACK TO THE MSVI DATA SET       @G24LB35*/ 00887000
*   /*                                                               */ 00888000
*   /*****************************************************************/ 00889000
*                                                                  0188 00890000
*   ELSE                                                           0188 00891000
*     RETCODE=FOUR;                 /*                       @G24LB35*/ 00892000
         B     @RC00146                                            0188 00893000
@RF00146 LA    RETCODE,4                                           0188 00894000
*   RETURN;                         /*                       @G24LB35*/ 00895000
@EL00004 DS    0H                                                  0189 00896000
@EF00004 DS    0H                                                  0189 00897000
@ER00004 L     @14,12(,@13)                                        0189 00898000
         BR    @14                                                 0189 00899000
*   END SPACERCD;                   /*                       @G24LB35*/ 00900000
         B     @EL00004                                            0190 00901000
*   END ICBVEX00                    /*                       @G24LB35*/ 00902000
*                                                                  0191 00903000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00904000
*/*%INCLUDE SYSLIB  (IEZRPLV )                                       */ 00905000
*/*%INCLUDE SYSLIB  (IEZVVICB)                                       */ 00906000
*/*%INCLUDE SYSLIB  (IEZGVSNE)                                       */ 00907000
*/*%INCLUDE SYSLIB  (IEZBASEV)                                       */ 00908000
*                                                                  0191 00909000
*       ;                                                          0191 00910000
@DATA    DS    0H                                                       00911000
@CH00342 DC    H'20'                                                    00912000
@SM00351 MVC   EXTENT(0),AREXT(PARMPTR)                                 00913000
@SM00353 MVC   0(0,@01),ARRAY(EXTPTR)                                   00914000
         DS    0F                                                       00915000
@SA00001 DS    18F                                                      00916000
@SA00003 DS    0F                                                       00917000
@SA00002 DS    0F                                                       00918000
         DS    1F                                                       00919000
@TF00001 DS    F                                                        00920000
         DS    0F                                                       00921000
@CF00037 DC    F'1'                                                     00922000
@CF00054 DC    F'2'                                                     00923000
@CF00340 DC    F'224'                                                   00924000
@CF00341 DC    F'988'                                                   00925000
@CF00347 DC    XL4'0000FFFF'                                            00926000
@CV00292 DC    V(ICBVIO00)                                              00927000
@CV00293 DC    V(ICBVRR00)                                              00928000
         DS    0D                                                       00929000
GVSNEPTR DS    A                                                        00930000
BASEVPTR DS    A                                                        00931000
SLOT     DS    H                                                        00932000
SIXTEEN  DC    H'16'                                                    00933000
FIXAREA  DS    CL250                                                    00934000
         ORG   FIXAREA                                                  00935000
@NM00021 DC    250X'00'                                                 00936000
         ORG   FIXAREA+250                                              00937000
GROUPKEY DS    CL13                                                     00938000
         ORG   GROUPKEY                                                 00939000
GROUPG   DC    CL3'G  '                                                 00940000
GROUPNAM DS    CL8                                                      00941000
GROUPBLK DC    CL1' '                                                   00942000
GROUPIND DS    FL1                                                      00943000
         ORG   GROUPKEY+13                                              00944000
BASEKEY  DS    CL13                                                     00945000
         ORG   BASEKEY                                                  00946000
BASEVG   DC    CL5'V    '                                               00947000
BASEVNAM DS    CL6                                                      00948000
BASEVBLK DC    CL1' '                                                   00949000
BASEVIND DC    XL1'00'                                                  00950000
         ORG   BASEKEY+13                                               00951000
GVSNEBUF DS    CL988                                                    00952000
BASEVBUF DS    CL224                                                    00953000
SYSGROUP DC    CL8'SYSGROUP'                                            00954000
FOUNDSW  DS    BL1                                                      00955000
SORTWORK DS    CL4                                                      00956000
ELEMOVE  DS    BL1                                                      00957000
DONE     DS    BL1                                                      00958000
         DS    CL1                                                      00959000
EXTENT   DS    CL4                                                      00960000
         ORG   EXTENT+0                                                 00961000
BEGCC    DS    FL2                                                      00962000
ENDCC    DS    FL2                                                      00963000
         ORG   EXTENT+64                                                00964000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00965000
@01      EQU   01                                                       00966000
@02      EQU   02                                                       00967000
@03      EQU   03                                                       00968000
@04      EQU   04                                                       00969000
@05      EQU   05                                                       00970000
@06      EQU   06                                                       00971000
@07      EQU   07                                                       00972000
@08      EQU   08                                                       00973000
@09      EQU   09                                                       00974000
@10      EQU   10                                                       00975000
@11      EQU   11                                                       00976000
@12      EQU   12                                                       00977000
@13      EQU   13                                                       00978000
@14      EQU   14                                                       00979000
@15      EQU   15                                                       00980000
EXTCTR   EQU   @03                                                      00981000
ELEMENTS EQU   @06                                                      00982000
SPACE    EQU   @03                                                      00983000
LOOPCTR  EQU   @02                                                      00984000
EXTPTR   EQU   @03                                                      00985000
RETCODE  EQU   @05                                                      00986000
PARMPTR  EQU   @07                                                      00987000
VVIPTR   EQU   @02                                                      00988000
RPLVPTR  EQU   @04                                                      00989000
REG0     EQU   @00                                                      00990000
REG1     EQU   @01                                                      00991000
REG14    EQU   @14                                                      00992000
ARR1     EQU   @01                                                      00993000
RPLV     EQU   0                                                        00994000
RPLTCBPR EQU   RPLV+8                                                   00995000
RPLVVICB EQU   RPLV+12                                                  00996000
RPLFLAGA EQU   RPLV+28                                                  00997000
RPLVRETC EQU   RPLV+34                                                  00998000
RPLVSAM  EQU   RPLV+56                                                  00999000
RPLVTYP  EQU   RPLVSAM+2                                                01000000
RPLVBUF  EQU   RPLVSAM+32                                               01001000
RPLVKEY  EQU   RPLVSAM+36                                               01002000
RPLVOPT  EQU   RPLVSAM+40                                               01003000
RPLVDIR  EQU   RPLVOPT                                                  01004000
RPLVKGE  EQU   RPLVOPT                                                  01005000
RPLVUPD  EQU   RPLVOPT+1                                                01006000
RPLVBLN  EQU   RPLVSAM+52                                               01007000
RPLVUTIL EQU   RPLV+132                                                 01008000
VVICB    EQU   0                                                        01009000
VVIFLGA  EQU   VVICB+15                                                 01010000
VVIFLG0  EQU   VVIFLGA                                                  01011000
GVSNE    EQU   0                                                        01012000
GVSHDR   EQU   GVSNE                                                    01013000
GVSNAME  EQU   GVSHDR                                                   01014000
GVSVVGRP EQU   GVSNAME+3                                                01015000
GVSID    EQU   GVSNAME+11                                               01016000
GVSNO    EQU   GVSID+1                                                  01017000
GVSFLAGA EQU   GVSHDR+13                                                01018000
GVSTYPE  EQU   GVSFLAGA                                                 01019000
GVSEX    EQU   GVSFLAGA+2                                               01020000
GVSESIND EQU   GVSHDR+18                                                01021000
GVSSLOTS EQU   GVSNE+28                                                 01022000
GVSVOLID EQU   GVSSLOTS                                                 01023000
GVSVOLFL EQU   GVSSLOTS+6                                               01024000
GVSRCFSI EQU   GVSVOLFL+2                                               01025000
GVSMTDSP EQU   GVSSLOTS+18                                              01026000
BASEV    EQU   0                                                        01027000
BASNAME  EQU   BASEV                                                    01028000
BASID    EQU   BASNAME+11                                               01029000
BASFLAGA EQU   BASEV+14                                                 01030000
BASTYPE  EQU   BASFLAGA                                                 01031000
BASGRPV  EQU   BASFLAGA+2                                               01032000
BASGENUS EQU   BASFLAGA+2                                               01033000
BASRCVYF EQU   BASEV+20                                                 01034000
BASSATIA EQU   BASRCVYF                                                 01035000
BASMISCF EQU   BASRCVYF+2                                               01036000
BASLIB1  EQU   BASEV+36                                                 01037000
BASLID1  EQU   BASLIB1                                                  01038000
BASLIB2  EQU   BASEV+49                                                 01039000
BASLID2  EQU   BASLIB2                                                  01040000
BASKLCPY EQU   BASEV+76                                                 01041000
BASCOPID EQU   BASKLCPY+11                                              01042000
BASGROUP EQU   BASEV+180                                                01043000
ARLIST   EQU   0                                                        01044000
ARFLG    EQU   ARLIST+6                                                 01045000
ARNMEXT  EQU   ARLIST+7                                                 01046000
ARVOL    EQU   ARLIST+8                                                 01047000
AREXT    EQU   ARLIST+28                                                01048000
ARRAY    EQU   0                                                        01049000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01050000
ARNEDB   EQU   ARLIST+92                                                01051000
@NM00020 EQU   AREXT                                                    01052000
ARCOMPC  EQU   ARLIST+26                                                01053000
@NM00019 EQU   ARLIST+25                                                01054000
ARHOST   EQU   ARLIST+20                                                01055000
ARECB    EQU   ARLIST+16                                                01056000
ARASID   EQU   ARLIST+14                                                01057000
@NM00018 EQU   ARFLG                                                    01058000
ARSEC    EQU   ARFLG                                                    01059000
ARINH    EQU   ARFLG                                                    01060000
ARDRES   EQU   ARFLG                                                    01061000
ARBDUBD  EQU   ARFLG                                                    01062000
@NM00017 EQU   ARLIST+5                                                 01063000
AROP     EQU   ARLIST+4                                                 01064000
ARLL     EQU   ARLIST                                                   01065000
@NM00016 EQU   BASEV+192                                                01066000
BASXPDT2 EQU   BASEV+188                                                01067000
BASRECOV EQU   BASEV+174                                                01068000
BASDEST  EQU   BASEV+144                                                01069000
BASOWNER EQU   BASEV+134                                                01070000
BASDESCR EQU   BASEV+104                                                01071000
BASDTREM EQU   BASEV+100                                                01072000
BASEXPDT EQU   BASEV+96                                                 01073000
BASDLMTD EQU   BASEV+92                                                 01074000
BASRES6  EQU   BASEV+89                                                 01075000
BASCOPNO EQU   BASCOPID+1                                               01076000
BASCOPBK EQU   BASCOPID                                                 01077000
BASCOPSN EQU   BASKLCPY+5                                               01078000
BASCOPV  EQU   BASKLCPY                                                 01079000
BASFREXT EQU   BASEV+72                                                 01080000
BASLEXT  EQU   BASEV+70                                                 01081000
BASFRESP EQU   BASEV+68                                                 01082000
@NM00015 EQU   BASEV+65                                                 01083000
BASBKLMT EQU   BASEV+64                                                 01084000
BASNBKUP EQU   BASEV+63                                                 01085000
BASNCOPY EQU   BASEV+62                                                 01086000
BASNEXTV EQU   BASEV+56                                                 01087000
BASPREV  EQU   BASEV+50                                                 01088000
BAS2BIT2 EQU   BASLID2                                                  01089000
BAS2BIT1 EQU   BASLID2                                                  01090000
BASRES5  EQU   BASLIB2                                                  01091000
BASCSN2  EQU   BASEV+37                                                 01092000
BAS1BIT2 EQU   BASLID1                                                  01093000
BAS1BIT1 EQU   BASLID1                                                  01094000
BASRES4  EQU   BASLIB1                                                  01095000
BASCSN1  EQU   BASEV+24                                                 01096000
BASRES3  EQU   BASMISCF                                                 01097000
BASHOLD  EQU   BASMISCF                                                 01098000
BASRES8  EQU   BASSATIA                                                 01099000
BASVSMIS EQU   BASSATIA                                                 01100000
BASIVCPY EQU   BASSATIA                                                 01101000
BASIVCRE EQU   BASSATIA                                                 01102000
BASCPUID EQU   BASEV+18                                                 01103000
@NM00014 EQU   BASFLAGA+3                                               01104000
BASLAST  EQU   BASFLAGA+3                                               01105000
BASFIRST EQU   BASFLAGA+3                                               01106000
BASREASS EQU   BASFLAGA+3                                               01107000
BASRONLY EQU   BASFLAGA+3                                               01108000
BASDAERA EQU   BASFLAGA+3                                               01109000
BASEXCL  EQU   BASFLAGA+2                                               01110000
BASBIND  EQU   BASFLAGA+2                                               01111000
BASINAC  EQU   BASFLAGA+2                                               01112000
BASRSTD  EQU   BASFLAGA+2                                               01113000
BASNOCPY EQU   BASFLAGA+2                                               01114000
BASDLSF  EQU   BASFLAGA+2                                               01115000
BASRES2  EQU   BASTYPE                                                  01116000
BASBASVR EQU   BASTYPE                                                  01117000
BASRES1  EQU   BASTYPE                                                  01118000
BASRES7  EQU   BASEV+13                                                 01119000
BASZERO  EQU   BASID+1                                                  01120000
BASBLANK EQU   BASID                                                    01121000
BASSERNO EQU   BASNAME+5                                                01122000
BASEVKEY EQU   BASNAME                                                  01123000
GVSEXPDT EQU   GVSSLOTS+14                                              01124000
GVSLEXT  EQU   GVSSLOTS+12                                              01125000
GVSFRESP EQU   GVSSLOTS+10                                              01126000
@NM00013 EQU   GVSVOLFL+2                                               01127000
GVSMTNSH EQU   GVSVOLFL+2                                               01128000
GVSCPUBM EQU   GVSVOLFL                                                 01129000
@NM00012 EQU   GVSHDR+20                                                01130000
@NM00011 EQU   GVSHDR+17                                                01131000
@NM00010 EQU   GVSFLAGA+2                                               01132000
@NM00009 EQU   GVSTYPE                                                  01133000
GVSGVSEX EQU   GVSTYPE                                                  01134000
@NM00008 EQU   GVSTYPE                                                  01135000
GVSRES1  EQU   GVSID                                                    01136000
GVSG     EQU   GVSNAME                                                  01137000
VVIUNUSD EQU   VVICB+116                                                01138000
VVINUSDC EQU   VVICB+112                                                01139000
VVITPFCH EQU   VVICB+108                                                01140000
VVIDVMEL EQU   VVICB+104                                                01141000
VVIVBSTF EQU   VVICB+100                                                01142000
VVISSOBA EQU   VVICB+96                                                 01143000
VVIVSCRA EQU   VVICB+92                                                 01144000
VVISTPTB EQU   VVICB+88                                                 01145000
VVIDVMTA EQU   VVICB+84                                                 01146000
VVIJUCB  EQU   VVICB+80                                                 01147000
VVIIUCB  EQU   VVICB+76                                                 01148000
VVIRES6  EQU   VVICB+72                                                 01149000
VVIRES5  EQU   VVICB+68                                                 01150000
VVIRES4  EQU   VVICB+64                                                 01151000
VVIUCB   EQU   VVICB+60                                                 01152000
VVIVJL   EQU   VVICB+56                                                 01153000
VVIVRR   EQU   VVICB+52                                                 01154000
VVIQLSPL EQU   VVICB+48                                                 01155000
VVIQRPL2 EQU   VVICB+44                                                 01156000
VVIQRPL1 EQU   VVICB+40                                                 01157000
VVIRES3  EQU   VVICB+36                                                 01158000
VVIVQMP  EQU   VVICB+32                                                 01159000
VVIECB1  EQU   VVICB+28                                                 01160000
VVICATAD EQU   VVICB+24                                                 01161000
VVIDCBAD EQU   VVICB+20                                                 01162000
VVIACBAD EQU   VVICB+16                                                 01163000
VVIFLG7  EQU   VVIFLGA                                                  01164000
VVIFLG6  EQU   VVIFLGA                                                  01165000
VVIFLG5  EQU   VVIFLGA                                                  01166000
VVIFLG4  EQU   VVIFLGA                                                  01167000
VVIFLG3  EQU   VVIFLGA                                                  01168000
VVIFLG2  EQU   VVIFLGA                                                  01169000
VVIFLG1  EQU   VVIFLGA                                                  01170000
VVIALCON EQU   VVICB+14                                                 01171000
VVICPUID EQU   VVICB+12                                                 01172000
VVIUCAT  EQU   VVICB+4                                                  01173000
VVICID   EQU   VVICB                                                    01174000
RPLVRLN  EQU   RPLVSAM+48                                               01175000
@NM00007 EQU   RPLVSAM+44                                               01176000
@NM00006 EQU   RPLVOPT                                                  01177000
@NM00005 EQU   RPLVOPT                                                  01178000
RPLVNEXT EQU   RPLVOPT                                                  01179000
RPLVLOC  EQU   RPLVOPT                                                  01180000
@NM00004 EQU   RPLVSAM+28                                               01181000
RPLVACB  EQU   RPLVSAM+24                                               01182000
@NM00003 EQU   RPLVSAM+3                                                01183000
@NM00002 EQU   RPLVSAM                                                  01184000
@NM00001 EQU   RPLV+38                                                  01185000
RPLRMSCC EQU   RPLV+36                                                  01186000
RPLRCODE EQU   RPLV+32                                                  01187000
RPLVTLEN EQU   RPLV+30                                                  01188000
RPLVRES1 EQU   RPLFLAGA+1                                               01189000
RPLVJRNL EQU   RPLFLAGA                                                 01190000
RPLJRCVY EQU   RPLFLAGA                                                 01191000
RPLVVOP  EQU   RPLFLAGA                                                 01192000
RPLVVIN  EQU   RPLFLAGA                                                 01193000
RPLVCOMP EQU   RPLFLAGA                                                 01194000
RPLVPROG EQU   RPLFLAGA                                                 01195000
RPLVPOST EQU   RPLFLAGA                                                 01196000
RPLFTIME EQU   RPLFLAGA                                                 01197000
RPLVRSV3 EQU   RPLV+24                                                  01198000
RPLVRSV2 EQU   RPLV+20                                                  01199000
RPLVRSV1 EQU   RPLV+16                                                  01200000
RPLASCBP EQU   RPLTCBPR                                                 01201000
RPLVECB  EQU   RPLV+4                                                   01202000
RPLVQPTR EQU   RPLV                                                     01203000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01204000
@RF00060 EQU   @EL00001                                                 01205000
@RF00084 EQU   @EL00002                                                 01206000
@RF00086 EQU   @EL00002                                                 01207000
@RF00125 EQU   @RC00118                                                 01208000
@RF00130 EQU   @EL00003                                                 01209000
@RC00146 EQU   @EL00004                                                 01210000
@RC00184 EQU   @RC00146                                                 01211000
@ENDDATA EQU   *                                                        01212000
         END   ICBVEX00,(C'PLS1953',0603,76273)                         01213000
