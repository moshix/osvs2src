         TITLE 'ICBVMT00 MSVC MOUNT SERVICE MODULE - MVS               *00001000
                        '                                               00002000
ICBVMT00 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'ICBVMT00  78.158'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  LA    @11,4095(,@12)                                      0001 00012000
         LA    @10,4095(,@11)                                      0001 00013000
         USING @PSTART,@12                                         0001 00014000
         USING @PSTART+4095,@11                                    0001 00015000
         USING @PSTART+8190,@10                                    0001 00016000
         ST    @13,@SA00001+4                                      0001 00017000
         LA    @14,@SA00001                                        0001 00018000
         ST    @14,8(,@13)                                         0001 00019000
         LR    @13,@14                                             0001 00020000
*                                                                  0211 00021000
*   /*****************************************************************/ 00022000
*   /*                                                               */ 00023000
*   /* INITIALIZATION OF VARIABLES                           @Y30LB11*/ 00024000
*   /*                                                               */ 00025000
*   /*****************************************************************/ 00026000
*                                                                  0211 00027000
*   RPLVPTR=REG1;                   /* SET RPLV BASE         @Y30LB11*/ 00028000
         LR    RPLVPTR,REG1                                        0211 00029000
*   VVIPTR=RPLVVICB;                /* BASE MSVC CB          @Y30LB11*/ 00030000
         L     VVIPTR,RPLVVICB(,RPLVPTR)                           0212 00031000
*   JPTRFX=ADDR(RPLVUTIL)+          /* SET BASE FOR          @Y30LB11*/ 00032000
*       LENGTH(ICBMTLST);           /* JFCB LIST             @Y30LB11*/ 00033000
         LA    @14,RPLVUTIL(,RPLVPTR)                              0213 00034000
         AL    @14,@CF00901                                        0213 00035000
         ST    @14,JPTRFX                                          0213 00036000
*   MSGRQ=''B;                      /* ZERO MACRO LIST       @Y30LB11*/ 00037000
         XC    MSGRQ(32),MSGRQ                                     0214 00038000
*   MSGRPLV=RPLVPTR;                /* MSVC RPLV ADDR        @Y30LB11*/ 00039000
         ST    RPLVPTR,MSGRPLV                                     0215 00040000
*   Z5=''B;                         /* ZERO 5 CHARACTERS     @Y30LB11*/ 00041000
         XC    Z5(5),Z5                                            0216 00042000
*   RCUNPACK(3:4)=RPLRCODE;         /* SAVE REASON CODE      @VS32876*/ 00043000
         MVC   RCUNPACK+2(2),RPLRCODE(RPLVPTR)                     0217 00044000
*   VUAUNPCK(3:4)=MDVUA;            /* SAVE VUA ADDRESS      @ZA09516*/ 00045000
         MVC   VUAUNPCK+2(2),MDVUA+132(RPLVPTR)                    0218 00046000
*   SAVRETC=Z2;                     /* ZERO RETURN CODE      @Y30LB11*/ 00047000
         MVC   SAVRETC(2),Z2                                       0219 00048000
*   SAVRCODE=R000;                  /* ZERO REASON CODE      @Y30LB11*/ 00049000
         MVC   SAVRCODE(2),@CB00170                                0220 00050000
*   SAVGRPCD=R000;                  /* ZERO REASON CODE      @Y30LB11*/ 00051000
         MVC   SAVGRPCD(2),@CB00170                                0221 00052000
*   ARGNUM=0;                       /* ZERO GROUP ARGUMENT   @Y30LB11*/ 00053000
         MVI   ARGNUM,X'00'                                        0222 00054000
*   DLMTD=CVTDATE;                  /* SAVE DATE             @Y30LB11*/ 00055000
         L     @14,CVTPTR                                          0223 00056000
         MVC   DLMTD(4),CVTDATE(@14)                               0223 00057000
*   DLMTD=DLMTD&FC;                 /* SIGN DATE             @VS34306*/ 00058000
         NC    DLMTD(4),@CB00106                                   0224 00059000
*   GXPDTOLD=FOX;                   /* NULL OLD EXP DATE     @ZA17172*/ 00060000
         MVC   GXPDTOLD(4),FOX                                     0225 00061000
*   SWITCHES=''B;                   /* ZERO SWITCH AT ENTRY  @ZA17172*/ 00062000
         MVI   SWITCHES,X'00'                                      0226 00063000
*                                                                  0227 00064000
*   /*****************************************************************/ 00065000
*   /*                                                               */ 00066000
*   /* IF MSC MOUNT SUCESSFUL THEN RETURN                    @Y30LB11*/ 00067000
*   /*                                                               */ 00068000
*   /*****************************************************************/ 00069000
*                                                                  0227 00070000
*   IF RPLFTIME=ON&                 /* SECOND CALL           @Y30LB11*/ 00071000
*       RPLVRETC=Z2 THEN            /* MOUNT SUCESSFUL?      @Y30LB11*/ 00072000
         TM    RPLFTIME(RPLVPTR),B'10000000'                       0227 00073000
         BNO   @RF00227                                            0227 00074000
         CLC   RPLVRETC(2,RPLVPTR),Z2                              0227 00075000
         BNE   @RF00227                                            0227 00076000
*     DO;                           /* YES                   @Y30LB11*/ 00077000
*       RPLVRETC=Z2;                /* GOOD RETURN CODE      @Y30LB11*/ 00078000
         MVC   RPLVRETC(2,RPLVPTR),Z2                              0229 00079000
*       RPLRCODE=R000;              /* GOOD REASON CODE      @Y30LB11*/ 00080000
         MVC   RPLRCODE(2,RPLVPTR),@CB00170                        0230 00081000
*       RETURN;                     /* RETURN TO ICBVCR00    @Y30LB11*/ 00082000
@EL00001 L     @13,4(,@13)                                         0231 00083000
@EF00001 DS    0H                                                  0231 00084000
@ER00001 LM    @14,@12,12(@13)                                     0231 00085000
         BR    @14                                                 0231 00086000
*     END;                          /*                       @Y30LB11*/ 00087000
*                                                                  0232 00088000
*   /*****************************************************************/ 00089000
*   /*                                                               */ 00090000
*   /* IF MSVC IS DISABLED THEN RETURN                       @Y30LB11*/ 00091000
*   /*                                                               */ 00092000
*   /*****************************************************************/ 00093000
*                                                                  0233 00094000
*   IF VVIFLG0=ON THEN              /* MSVC DISABLED?        @Y30LB11*/ 00095000
@RF00227 TM    VVIFLG0(VVIPTR),B'10000000'                         0233 00096000
         BNO   @RF00233                                            0233 00097000
*     DO;                           /* YES                   @Y30LB11*/ 00098000
*       IF MDSRTCH=ON THEN          /* MOUNT NON-SPECIFIC?   @Y30LB11*/ 00099000
         TM    MDSRTCH+132(RPLVPTR),B'00010000'                    0235 00100000
         BNO   @RF00235                                            0235 00101000
*         DO;                       /* YES                   @Y30LB11*/ 00102000
*           RPLVRETC=FOUR;          /* SET BAD RC            @Y30LB11*/ 00103000
         MVC   RPLVRETC(2,RPLVPTR),@CB00103                        0237 00104000
*           RPLRCODE=R213;          /* MSVC IS DISABLED      @Y30LB11*/ 00105000
         MVC   RPLRCODE(2,RPLVPTR),@CB00174                        0238 00106000
*         END;                      /*                       @Y30LB11*/ 00107000
*       RETURN;                     /* RETURN TO ICBVCR00    @Y30LB11*/ 00108000
         B     @EL00001                                            0240 00109000
*     END;                          /*                       @Y30LB11*/ 00110000
*                                                                  0241 00111000
*   /*****************************************************************/ 00112000
*   /*                                                               */ 00113000
*   /* RESERVE THE MSVC INVENTORY EXCLUSIVELY                #Y30LB11*/ 00114000
*   /*                                                               */ 00115000
*   /*****************************************************************/ 00116000
*                                                                  0242 00117000
*   REG0=1;                         /* MSVC EXCLUSIVE        @Y30LB11*/ 00118000
@RF00233 LA    REG0,1                                              0242 00119000
*   REG1=RPLVPTR;                   /* RPLV ADDRESS          @Y30LB11*/ 00120000
         LR    REG1,RPLVPTR                                        0243 00121000
*   CALL ICBVRR00;                  /* RESERVE MSVC INVENTRY @Y30LB11*/ 00122000
         L     @15,@CV00248                                        0244 00123000
         BALR  @14,@15                                             0244 00124000
*   RPLVTYP=RPLVREAD;               /* READ RECORD           @ZM31134*/ 00125000
         MVI   RPLVTYP(RPLVPTR),X'00'                              0245 00126000
*   RPLVDIR=ON;                     /* READ DIRECT           @ZM31134*/ 00127000
         OI    RPLVDIR(RPLVPTR),B'01000000'                        0246 00128000
*                                                                  0247 00129000
*   /*****************************************************************/ 00130000
*   /*                                                               */ 00131000
*   /* THIS SECTION OF CODE PICKS THE CPU ASSOCIATION BIT MASK       */ 00132000
*   /* CORRESPONDING TO THE HOST. IF THE MASK IN THE MSVC CONTROL    */ 00133000
*   /* BLOCK DOES NOT CORRESPOND TO THE HOST OR IS ZERO, THEN THE    */ 00134000
*   /* CPUID RECORD IS READ AND THE MASK ASSOCIATED WITH THE HOST IS */ 00135000
*   /* USED.                                                 @Y30LB11*/ 00136000
*   /*                                                               */ 00137000
*   /*****************************************************************/ 00138000
*                                                                  0247 00139000
*   CPU=Z2;                         /* ZERO CPU VARIABLE     @Y30LB11*/ 00140000
         MVC   CPU(2),Z2                                           0247 00141000
*   IF ICBCPUID=MDHOST|             /* IF CPUID = HOST OR    @G24LB05*/ 00142000
*       MDHOST=Z5 THEN              /* MDHOST = ZERO         @Y30LB11*/ 00143000
         L     @14,CVTPTR                                          0248 00144000
         L     @14,CVTEXT2(,@14)                                   0248 00145000
         L     @14,CVTICB(,@14)                                    0248 00146000
         LA    @09,132                                             0248 00147000
         ALR   @09,RPLVPTR                                         0248 00148000
         CLC   ICBCPUID(5,@14),MDHOST(@09)                         0248 00149000
         BE    @RT00248                                            0248 00150000
         CLC   MDHOST(5,@09),Z5                                    0248 00151000
         BNE   @RF00248                                            0248 00152000
@RT00248 DS    0H                                                  0249 00153000
*     CPU=VVICPUID;                 /* SET CPU ASSOC MASK    @Y30LB11*/ 00154000
         MVC   CPU(2),VVICPUID(VVIPTR)                             0249 00155000
*   ELSE                            /* OTHERWISE             @Y30LB11*/ 00156000
*     DO;                           /* SET CPUID ASSOC MASK  @Y30LB11*/ 00157000
         B     @RC00248                                            0250 00158000
@RF00248 DS    0H                                                  0251 00159000
*       RPLVLOC=ON;                 /* LOCATE MODE           @Y30LB11*/ 00160000
         OI    RPLVLOC(RPLVPTR),B'10000000'                        0251 00161000
*       RPLVKEY=ADDR(ARGCPU);       /* ADDR CPU ID KEY       @Y30LB11*/ 00162000
         LA    @14,ARGCPU                                          0252 00163000
         ST    @14,RPLVKEY(,RPLVPTR)                               0252 00164000
*       MSGID=M410;                 /* CPUID RECORD NOT READ @Y30LB11*/ 00165000
         MVC   MSGID(4),@CF00156                                   0253 00166000
*       CALL COMONRTN;              /* GET CPUID RECORD      @Y30LB11*/ 00167000
         BAL   @14,COMONRTN                                        0254 00168000
*       IF RETCOD=0 THEN            /* RECORD GOTTEN?        @Y30LB11*/ 00169000
         LTR   RETCOD,RETCOD                                       0255 00170000
         BNZ   @RF00255                                            0255 00171000
*         DO;                       /* YES                   @Y30LB11*/ 00172000
*           DO I=1 TO 16;           /* SEARCH THRU CPUID     @Y30LB11*/ 00173000
         LA    @14,1                                               0257 00174000
         STH   @14,I                                               0257 00175000
@DL00257 DS    0H                                                  0258 00176000
*             IF MDHOST=CPUIDREC(I) THEN/* HOST/CPUID =?     @Y30LB11*/ 00177000
         SLA   @14,3                                               0258 00178000
         L     @09,CPUIDPTR(,RPLVPTR)                              0258 00179000
         ST    @14,@TF00001                                        0258 00180000
         ALR   @14,@09                                             0258 00181000
         CLC   MDHOST+132(5,RPLVPTR),CPUIDREC-8(@14)               0258 00182000
         BNE   @RF00258                                            0258 00183000
*               CPU=CPUMASK(I);     /* SET CPUID MASK        @Y30LB11*/ 00184000
         AL    @09,@TF00001                                        0259 00185000
         MVC   CPU(2),CPUMASK-8(@09)                               0259 00186000
*           END;                    /*                       @Y30LB11*/ 00187000
@RF00258 LA    @14,1                                               0260 00188000
         AH    @14,I                                               0260 00189000
         STH   @14,I                                               0260 00190000
         C     @14,@CF00100                                        0260 00191000
         BNH   @DL00257                                            0260 00192000
*         END;                      /*                       @Y30LB11*/ 00193000
*       RPLVLOC=OFF;                /* MOVE MODE RESTORED    @Y30LB11*/ 00194000
@RF00255 NI    RPLVLOC(RPLVPTR),B'01111111'                        0262 00195000
*     END;                          /*                       @Y30LB11*/ 00196000
*                                                                  0263 00197000
*   /*****************************************************************/ 00198000
*   /*                                                               */ 00199000
*   /* THIS SECTION OF CODE INSURES THAT A CPUID ASSOCIATION MASK HAS*/ 00200000
*   /* BEEN SET PROPERLY. NOTICE THAT IN MOUNT NON- SPECIFIC CASES A */ 00201000
*   /* BAD RETURN AND REASON CODE IS PASSED.                         */ 00202000
*   /*                                                               */ 00203000
*   /*****************************************************************/ 00204000
*                                                                  0264 00205000
*   IF CPU=Z2 THEN                  /* CPUID FOUND?          @Y30LB11*/ 00206000
@RC00248 CLC   CPU(2),Z2                                           0264 00207000
         BNE   @RF00264                                            0264 00208000
*     DO;                           /* NO                    @Y30LB11*/ 00209000
*       MSGID=M404;                 /* CPUID MSG             @Y30LB11*/ 00210000
         MVC   MSGID(4),@CF00152                                   0266 00211000
*       REG1=ADDR(MSGRQ);           /* REG1 PARM             @Y30LB11*/ 00212000
         LA    REG1,MSGRQ                                          0267 00213000
*       CALL ICBVOP00;              /* OPER/LIB ROUTINE      @Y30LB11*/ 00214000
         L     @15,@CV00250                                        0268 00215000
         BALR  @14,@15                                             0268 00216000
*       RPLVRETC=Z2;                /* GOOD RETURN CODE      @Y30LB11*/ 00217000
         MVC   RPLVRETC(2,RPLVPTR),Z2                              0269 00218000
*       RPLRCODE=R000;              /* GOOD REASON CODE      @Y30LB11*/ 00219000
         MVC   RPLRCODE(2,RPLVPTR),@CB00170                        0270 00220000
*       IF MDSRTCH=ON THEN          /* MOUNT NON-SPECIFIC?   @Y30LB11*/ 00221000
         TM    MDSRTCH+132(RPLVPTR),B'00010000'                    0271 00222000
         BNO   @RF00271                                            0271 00223000
*         DO;                       /* SET REASON & RC CODES @Y30LB11*/ 00224000
*           RPLRCODE=R22B;          /* ID NOT IN CPUID       @Y30LB11*/ 00225000
         MVC   RPLRCODE(2,RPLVPTR),@CB00176                        0273 00226000
*           RPLVRETC=FOUR;          /* BAD RETURN            @Y30LB11*/ 00227000
         MVC   RPLVRETC(2,RPLVPTR),@CB00103                        0274 00228000
*         END;                      /*                       @Y30LB11*/ 00229000
*       RETURN;                     /* RETURN TO ICBVCR00    @Y30LB11*/ 00230000
         B     @EL00001                                            0276 00231000
*     END;                          /*                       @Y30LB11*/ 00232000
*                                                                  0278 00233000
*   /*****************************************************************/ 00234000
*   /*                                                               */ 00235000
*   /* PROCESS MOUNT SPECIFIC.                               @Y30LB11*/ 00236000
*   /*                                                               */ 00237000
*   /*****************************************************************/ 00238000
*                                                                  0278 00239000
*   IF MDSRTCH=OFF THEN             /* MOUNT SPECIFIC?       @Y30LB11*/ 00240000
@RF00264 TM    MDSRTCH+132(RPLVPTR),B'00010000'                    0278 00241000
         BNZ   @RF00278                                            0278 00242000
*     DO;                           /* YES                   @Y30LB11*/ 00243000
*                                                                  0279 00244000
*       /*************************************************************/ 00245000
*       /*                                                           */ 00246000
*       /* MOUNT SPECIFIC FAILURE, SECOND CALL               @Y30LB11*/ 00247000
*       /*                                                           */ 00248000
*       /*************************************************************/ 00249000
*                                                                  0280 00250000
*       IF RPLFTIME=ON THEN         /* SECOND CALL           @Y30LB11*/ 00251000
         TM    RPLFTIME(RPLVPTR),B'10000000'                       0280 00252000
         BNO   @RF00280                                            0280 00253000
*         DO;                       /* YES                   @Y30LB11*/ 00254000
*           CALL MNTRSTR;           /* RESTORE MOUNT STATUS  @Y30LB11*/ 00255000
         BAL   @14,MNTRSTR                                         0282 00256000
*           RPLVRETC=Z2;            /* GOOD RETURN CODE      @Y30LB11*/ 00257000
         MVC   RPLVRETC(2,RPLVPTR),Z2                              0283 00258000
*           RPLRCODE=R000;          /* GOOD REASON CODE      @Y30LB11*/ 00259000
         MVC   RPLRCODE(2,RPLVPTR),@CB00170                        0284 00260000
*           RETURN;                 /* RETURN TO ICBVCR00    @Y30LB11*/ 00261000
         B     @EL00001                                            0285 00262000
*         END;                      /*                       @Y30LB11*/ 00263000
*                                                                  0287 00264000
*       /*************************************************************/ 00265000
*       /*                                                           */ 00266000
*       /* PROCESS MOUNT SPECIFIC, FIRST CALL.               @Y30LB11*/ 00267000
*       /*                                                           */ 00268000
*       /*************************************************************/ 00269000
*                                                                  0287 00270000
*                                                                  0287 00271000
*       /*************************************************************/ 00272000
*       /*                                                           */ 00273000
*       /* THE BASE VOLUME IS READ TO UPDATE THE MOUNT STATUS. IF AN */ 00274000
*       /* ERROR OCCURS IN ICBVIO00, AN ERROR MESSAGE IS SENT TO THE */ 00275000
*       /* LIBRARIAN, AND PROCESSING IS TERMINATED.          @Y30LB11*/ 00276000
*       /*                                                           */ 00277000
*       /*************************************************************/ 00278000
*                                                                  0287 00279000
*       ARGVOL=MDVOL;               /* KEY VOLUME RECORD     @Y30LB11*/ 00280000
@RF00280 LA    @14,132                                             0287 00281000
         ALR   @14,RPLVPTR                                         0287 00282000
         MVC   ARGVOL(6),MDVOL(@14)                                0287 00283000
*       MSGTEXT1=ADDR(MDVOL);       /* INSERT TEXT           @Y30LB11*/ 00284000
         LA    @14,MDVOL(,@14)                                     0288 00285000
         STCM  @14,7,MSGTEXT1                                      0288 00286000
*       MSGLEN1=SIX;                /* INSERT LENGTH         @Y30LB11*/ 00287000
         MVI   MSGLEN1,X'06'                                       0289 00288000
*       MSGID=M402;                 /* BASEV NOT FOUND       @Y30LB11*/ 00289000
         MVC   MSGID(4),@CF00150                                   0290 00290000
*       RPLVKEY=ADDR(ARGV);         /* ADDR OF VOLUME KEY    @Y30LB11*/ 00291000
         LA    @14,ARGV                                            0291 00292000
         ST    @14,RPLVKEY(,RPLVPTR)                               0291 00293000
*       RPLVUPD=ON;                 /* UPDATE RECORD         @Y30LB11*/ 00294000
         OI    RPLVUPD(RPLVPTR),B'00000010'                        0292 00295000
*       CALL COMONRTN;              /* GET BASEV RECORD      @Y30LB11*/ 00296000
*                                                                  0293 00297000
         BAL   @14,COMONRTN                                        0293 00298000
*       /*************************************************************/ 00299000
*       /*                                                           */ 00300000
*       /* IF I/O SUCESSFUL, UPDATE THE BASE VOLUME RECORD, AND IF   */ 00301000
*       /* THE VOLUME IS A GENERAL USE TYPE THE GVSNE RECORD IS      */ 00302000
*       /* UPDATED.                                          @Y30LB11*/ 00303000
*       /*                                                           */ 00304000
*       /*************************************************************/ 00305000
*                                                                  0294 00306000
*       IF RETCOD=0 THEN            /* SUCCESSFUL I/O        @Y30LB11*/ 00307000
         LTR   RETCOD,RETCOD                                       0294 00308000
         BNZ   @RF00294                                            0294 00309000
*         DO;                       /* YES                   @Y30LB11*/ 00310000
*           BASCPUID=BASCPUID|CPU;  /* SET CPUID MASK        @Y30LB11*/ 00311000
         L     @14,BASEVPTR(,RPLVPTR)                              0296 00312000
         OC    BASCPUID(2,@14),CPU                                 0296 00313000
*           BASDLMTD=DLMTD;         /* UPDATE TIME IN RECORD @Y30LB11*/ 00314000
         MVC   BASDLMTD(4,@14),DLMTD                               0297 00315000
*           BASXPDT2=BASEXPDT;      /* SAVE OLD EXP DATE     @ZA17172*/ 00316000
         L     @04,BASEXPDT(,@14)                                  0298 00317000
         ST    @04,BASXPDT2                                        0298 00318000
*           GXPDTOLD=BASEXPDT;      /* SAVE OLD EXP DATE     @ZA17172*/ 00319000
         MVC   GXPDTOLD(4),BASEXPDT(@14)                           0299 00320000
*           RPLVTYP=RPLVPUT;        /* SET VIO PUT SW ON     @Y30LB11*/ 00321000
         MVI   RPLVTYP(RPLVPTR),X'01'                              0300 00322000
*           CALL COMONRTN;          /* PUT BASE VOL RECORD   @Y30LB11*/ 00323000
         BAL   @14,COMONRTN                                        0301 00324000
*           IF BASGENUS=ON THEN     /* GENERAL USE TYPE?     @Y30LB11*/ 00325000
         L     @14,BASEVPTR(,RPLVPTR)                              0302 00326000
         TM    BASGENUS(@14),B'00010000'                           0302 00327000
         BNO   @RF00302                                            0302 00328000
*             DO;                   /* YES                   @Y30LB11*/ 00329000
*               ARGGP=BASGROUP;     /* SET GVSNE KEY         @Y30LB11*/ 00330000
         MVC   ARGGP(8),BASGROUP(@14)                              0304 00331000
*               ARGNUM=1;           /* SET GVSNE INDEX       @Y30LB11*/ 00332000
         MVI   ARGNUM,X'01'                                        0305 00333000
*               SCRTCHSW=OFF;       /* INDICATE GVSNE UPDATE @Y30LB11*/ 00334000
*               RSTRSW=OFF;         /* NOT RESTORATION       @Y30LB11*/ 00335000
         NI    SCRTCHSW,B'10011111'                                0307 00336000
*               CALL GVSRECRD;      /* UPDATE GVSNE RECORD   @Y30LB11*/ 00337000
         BAL   @14,GVSRECRD                                        0308 00338000
*             END;                  /*                       @Y30LB11*/ 00339000
*         END;                      /*                       @Y30LB11*/ 00340000
@RF00302 DS    0H                                                  0311 00341000
*       RPLVRETC=Z2;                /* GOOD RETURN CODE      @Y30LB11*/ 00342000
@RF00294 MVC   RPLVRETC(2,RPLVPTR),Z2                              0311 00343000
*       RPLRCODE=R000;              /* GOOD REASON CODE      @Y30LB11*/ 00344000
         MVC   RPLRCODE(2,RPLVPTR),@CB00170                        0312 00345000
*       RETURN;                     /* RETURN TO ICBVCR00    @Y30LB11*/ 00346000
         B     @EL00001                                            0313 00347000
*     END;                          /*                       @Y30LB11*/ 00348000
*                                                                  0315 00349000
*   /*****************************************************************/ 00350000
*   /*                                                               */ 00351000
*   /* PROCESS MOUNT NON-SPECIFIC                            @Y30LB11*/ 00352000
*   /*                                                               */ 00353000
*   /*****************************************************************/ 00354000
*                                                                  0315 00355000
*                                                                  0315 00356000
*   /*****************************************************************/ 00357000
*   /*                                                               */ 00358000
*   /* MOUNT NON-SPECIFIC FAILURE, SECOND CALL               @Y30LB11*/ 00359000
*   /*                                                               */ 00360000
*   /*****************************************************************/ 00361000
*                                                                  0315 00362000
*   IF RPLFTIME=ON THEN             /* SECOND CALL           @Y30LB11*/ 00363000
@RF00278 TM    RPLFTIME(RPLVPTR),B'10000000'                       0315 00364000
         BNO   @RF00315                                            0315 00365000
*     DO;                           /* YES                   @Y30LB11*/ 00366000
*       IF RCUNPACK(3:4)=RJES       /* IS THIS A JES3 REJECT ?     0317 00367000
*                                                            @G18MB04*/ 00368000
*         THEN                                                     0317 00369000
         CLC   RCUNPACK+2(2),@CB00192                              0317 00370000
         BNE   @RF00317                                            0317 00371000
*         DO;                       /* YES, SET UP FOR THAT MESSAGE     00372000
*                                                            @G18MB04*/ 00373000
*           MSGID=M479;             /* MESSAGE ID            @G18MB04*/ 00374000
         MVC   MSGID(4),@CF00164                                   0319 00375000
*           MSGLEN1=SIX;            /* VOLID LENGTH          @G18MB04*/ 00376000
         MVI   MSGLEN1,X'06'                                       0320 00377000
*           MSGTEXT1=ADDR(MDVOL);   /* VOLID REJECTED        @G18MB04*/ 00378000
         LA    @14,MDVOL+132(,RPLVPTR)                             0321 00379000
         STCM  @14,7,MSGTEXT1                                      0321 00380000
*           REG1=ADDR(MSGRQ);       /* POINT REG1 TO REQUEST @G18MB04*/ 00381000
         LA    REG1,MSGRQ                                          0322 00382000
*           CALL ICBVOP00;          /* CALL OPER/LIB COMM    @G18MB04*/ 00383000
         L     @15,@CV00250                                        0323 00384000
         BALR  @14,@15                                             0323 00385000
*           MSGRQ=''B;              /* ZERO REQUEST BLOCK    @G18MB04*/ 00386000
         XC    MSGRQ(32),MSGRQ                                     0324 00387000
*           MSGRPLV=RPLVPTR;        /* RPLV ADDR             @G18MB04*/ 00388000
         ST    RPLVPTR,MSGRPLV                                     0325 00389000
*           CALL MNTRSTR;           /* RESTORE MOUNT STATUS  @G18MB04*/ 00390000
         BAL   @14,MNTRSTR                                         0326 00391000
*           RPLVDIR=ON;             /* READ DIRECT           @G18MB04*/ 00392000
*           RPLVNEXT=OFF;           /* READ EXACT KEY        @G18MB04*/ 00393000
*           RPLVKGE=OFF;            /* KEY >= OFF            @G18MB04*/ 00394000
         OI    RPLVDIR(RPLVPTR),B'01000000'                        0329 00395000
         NI    RPLVNEXT(RPLVPTR),B'11011011'                       0329 00396000
*         END;                      /*                       @G18MB04*/ 00397000
*       ELSE                                                       0331 00398000
*         DO;                       /*                       @G18MB04*/ 00399000
         B     @RC00317                                            0331 00400000
@RF00317 DS    0H                                                  0332 00401000
*           MSGID=M473;             /* MESSAGE ID            @VS32876*/ 00402000
         MVC   MSGID(4),@CF00162                                   0332 00403000
*           MSGLEN1=3;              /* VUA LENGTH            @OX10810*/ 00404000
         MVI   MSGLEN1,X'03'                                       0333 00405000
*           MSGTEXT1=ADDR(WRKVUA);  /* VUA ADDRESS           @OX10810*/ 00406000
         LA    @14,WRKVUA                                          0334 00407000
         STCM  @14,7,MSGTEXT1                                      0334 00408000
*           MSGTEXT1=MSGTEXT1+1;    /* GET 3 DIGIT VUA       @OX10810*/ 00409000
         LA    @14,1(,@14)                                         0335 00410000
         STCM  @14,7,MSGTEXT1                                      0335 00411000
*           MSGLEN2=SIX;            /* VOLID LENGTH          @OX10810*/ 00412000
         MVI   MSGLEN2,X'06'                                       0336 00413000
*           MSGTEXT2=ADDR(MDVOL);   /* VOLID                 @OX10810*/ 00414000
         LA    @14,MDVOL+132(,RPLVPTR)                             0337 00415000
         STCM  @14,7,MSGTEXT2                                      0337 00416000
*           MSGLEN3=4;              /* MSC CODE LENGTH       @OX10810*/ 00417000
         MVI   MSGLEN3,X'04'                                       0338 00418000
*           MSGTEXT3=ADDR(WORK1);   /* MSC CODE              @OX10810*/ 00419000
         LA    @14,WORK1                                           0339 00420000
         STCM  @14,7,MSGTEXT3                                      0339 00421000
*           VUAUNPCK(5:5)=SIGN;     /* SIGN FOR UNPACK       @OX10810*/ 00422000
         MVC   VUAUNPCK+4(1),SIGN                                  0340 00423000
*           GEN(UNPK  WRKVUA(5),VUAUNPCK+2(3));/* UNPACK     @OX10810*/ 00424000
         UNPK  WRKVUA(5),VUAUNPCK+2(3)                                  00425000
*           GEN(TR    WRKVUA(4),TRANS-240);/* TRANSLATE      @OX10810*/ 00426000
         TR    WRKVUA(4),TRANS-240                                      00427000
*           RCUNPACK(5:5)=SIGN;     /* SIGN FOR UNPACK       @VS32876*/ 00428000
         MVC   RCUNPACK+4(1),SIGN                                  0343 00429000
*           GEN(UNPK WORK1(5),RCUNPACK+2(3));/* UNPACK       @VS32892*/ 00430000
         UNPK WORK1(5),RCUNPACK+2(3)                                    00431000
*           GEN(TR WORK1(4),TRANS-240);/* TRANSLATE          @VS32892*/ 00432000
         TR WORK1(4),TRANS-240                                          00433000
*           REG1=ADDR(MSGRQ);       /* POINT REG1 TO REQUEST         */ 00434000
         LA    REG1,MSGRQ                                          0346 00435000
*           CALL ICBVOP00;          /* CALL OPER/LIB COMM    @VS32876*/ 00436000
         L     @15,@CV00250                                        0347 00437000
         BALR  @14,@15                                             0347 00438000
*           MSGRQ=''B;              /* ZERO REQUEST BLOCK    @VS32876*/ 00439000
         XC    MSGRQ(32),MSGRQ                                     0348 00440000
*           MSGRPLV=RPLVPTR;        /* RPLV ADDR             @VS32876*/ 00441000
         ST    RPLVPTR,MSGRPLV                                     0349 00442000
*           CALL MNTRSTR;           /* RESTORE MOUNT STATUS  #Y30LB11*/ 00443000
         BAL   @14,MNTRSTR                                         0350 00444000
*           RPLVDIR=ON;             /* READ DIRECT           #Y30LB11*/ 00445000
*           RPLVNEXT=OFF;           /* READ EXACT KEY        #Y30LB11*/ 00446000
*           RPLVKGE=OFF;            /* KEY >= OFF            #Y30LB11*/ 00447000
         OI    RPLVDIR(RPLVPTR),B'01000000'                        0353 00448000
         NI    RPLVNEXT(RPLVPTR),B'11011011'                       0353 00449000
*           IF RPLRMSCC<=MSCRC04|   /* IS VUA USE            @ZA27804*/ 00450000
*               RPLRMSCC=MSCRC0B|   /*                       @ZA27804*/ 00451000
*               RPLRMSCC=>MSCRCF0 THEN/*                     @ZA27804*/ 00452000
         CLC   RPLRMSCC(2,RPLVPTR),MSCRC04                         0354 00453000
         BNH   @RT00354                                            0354 00454000
         CLC   RPLRMSCC(2,RPLVPTR),MSCRC0B                         0354 00455000
         BE    @RT00354                                            0354 00456000
         CLC   RPLRMSCC(2,RPLVPTR),MSCRCF0                         0354 00457000
         BL    @RF00354                                            0354 00458000
@RT00354 DS    0H                                                  0355 00459000
*             DO;                   /* YES                   @ZA09516*/ 00460000
*               RPLVRETC=FOUR;      /* SAVE RETURN CODE      @ZA09516*/ 00461000
         MVC   RPLVRETC(2,RPLVPTR),@CB00103                        0356 00462000
*               RPLRCODE=RPLRMSCC;  /* SAVE REASON CODE      @ZA11667*/ 00463000
         MVC   RPLRCODE(2,RPLVPTR),RPLRMSCC(RPLVPTR)               0357 00464000
*               RETURN;             /* RETURN TO ICBVCR00    @ZA09516*/ 00465000
         B     @EL00001                                            0358 00466000
*             END;                  /*                       @ZA09516*/ 00467000
*         END;                      /*                       @Y30LB11*/ 00468000
@RF00354 DS    0H                                                  0361 00469000
*     END;                          /*                       @G18MB04*/ 00470000
@RC00317 DS    0H                                                  0362 00471000
*                                                                  0362 00472000
*   /*****************************************************************/ 00473000
*   /*                                                               */ 00474000
*   /* MOUNT NON-SPECIFIC SELECTION OF A VOLUME              @Y30LB11*/ 00475000
*   /*                                                               */ 00476000
*   /*****************************************************************/ 00477000
*                                                                  0362 00478000
*   ALGOSW=OFF;                     /* POSSIBLE 1ST ALGO REQ @Y30LB11*/ 00479000
@RF00315 NI    ALGOSW,B'01111111'                                  0362 00480000
*   IF ALGOBIT=ON THEN              /* CHECK ALGORITHM REQ   @Y30LB11*/ 00481000
         L     @14,JFCBPTR                                         0363 00482000
         TM    ALGOBIT(@14),B'10000000'                            0363 00483000
         BNO   @RF00363                                            0363 00484000
*     ALGOSW=ON;                    /* SET SWITCH            @Y30LB11*/ 00485000
         OI    ALGOSW,B'10000000'                                  0364 00486000
*   CALL MTSCRTCH;                  /* CALL MT SCRATCH RTN   @Y30LB11*/ 00487000
@RF00363 BAL   @14,MTSCRTCH                                        0365 00488000
*   IF RETCOD^=0&                   /* SCRATCH NOT MOUNTED?  @Y30LB11*/ 00489000
*       SAVGRPCD^=R23D&             /* NOT FATAL ERROR       @G24LB04*/ 00490000
*       ALGOBIT=OFF THEN            /* 1ST ALGORITHM?        @Y30LB11*/ 00491000
         SLR   @14,@14                                             0366 00492000
         CR    RETCOD,@14                                          0366 00493000
         BE    @RF00366                                            0366 00494000
         CLC   SAVGRPCD(2),@CB00190                                0366 00495000
         BE    @RF00366                                            0366 00496000
         L     @04,JFCBPTR                                         0366 00497000
         TM    ALGOBIT(@04),B'10000000'                            0366 00498000
         BNZ   @RF00366                                            0366 00499000
*     DO;                           /* NO                    @Y30LB11*/ 00500000
*       ALGOSW=ON;                  /* ALTERNATE ALGORITHM   @Y30LB11*/ 00501000
         OI    ALGOSW,B'10000000'                                  0368 00502000
*       SAVGRPCD=R000;              /* RESET REASON CODE     @Y30LB11*/ 00503000
         MVC   SAVGRPCD(2),@CB00170                                0369 00504000
*       VOLINDEX=0;                 /* RESET VOLINDEX        @Y30LB11*/ 00505000
         STH   @14,VOLINDEX                                        0370 00506000
*       CALL CALSPACE;              /* RECALIBRATE SPACE     @Y30LB11*/ 00507000
         BAL   @14,CALSPACE                                        0371 00508000
*       CALL MTSCRCH2;              /* RECALL MT SCRTCH RTN  @Y30LB11*/ 00509000
         BAL   @14,MTSCRCH2                                        0372 00510000
*     END;                          /*                       @Y30LB11*/ 00511000
*   IF SAVGRPCD^=0 THEN             /* BAD RETURN CODE?      @Y30LB11*/ 00512000
@RF00366 ICM   @14,3,SAVGRPCD                                      0374 00513000
         BZ    @RF00374                                            0374 00514000
*     DO;                           /* YES                   @Y30LB11*/ 00515000
*       IF SAVGRPCD^=R23D           /* MESSAGE NOT WRITTEN   @G24LB04*/ 00516000
*         THEN                                                     0376 00517000
         CLC   SAVGRPCD(2),@CB00190                                0376 00518000
         BE    @RF00376                                            0376 00519000
*         DO;                       /* WRITE MESSAGE         @G24LB04*/ 00520000
*           MSGRQ=''B;              /* ZERO MACRO LIST       @Y30LB11*/ 00521000
         XC    MSGRQ(32),MSGRQ                                     0378 00522000
*           MSGRPLV=RPLVPTR;        /* RESET RPLV PTR        @Y30LB11*/ 00523000
         ST    RPLVPTR,MSGRPLV                                     0379 00524000
*           MSGID=M407;             /* SET MSGID             @Y30LB11*/ 00525000
         MVC   MSGID(4),@CF00154                                   0380 00526000
*           MSGTEXT1=ADDR(ARGGP);   /* PARM TEXT             @Y30LB11*/ 00527000
         LA    @14,ARGGP                                           0381 00528000
         STCM  @14,7,MSGTEXT1                                      0381 00529000
*           MSGLEN1=EIGHT;          /* PARM LENGTH           @Y30LB11*/ 00530000
         MVI   MSGLEN1,X'08'                                       0382 00531000
*           REG1=ADDR(MSGRQ);       /* ADDR MSGRQ            @Y30LB11*/ 00532000
         LA    REG1,MSGRQ                                          0383 00533000
*           CALL ICBVOP00;          /* CALL MSG ROUTINE      @Y30LB11*/ 00534000
         L     @15,@CV00250                                        0384 00535000
         BALR  @14,@15                                             0384 00536000
*         END;                      /*                       @G24LB04*/ 00537000
*       ELSE                                                       0386 00538000
*         ;                         /*                       @G24LB04*/ 00539000
@RF00376 DS    0H                                                  0387 00540000
*       SAVRETC=FOUR;               /* SET BAD RC            @Y30LB11*/ 00541000
         MVC   SAVRETC(2),@CB00103                                 0387 00542000
*       SAVRCODE=SAVGRPCD;          /* SET REASON CODE       @Y30LB11*/ 00543000
         MVC   SAVRCODE(2),SAVGRPCD                                0388 00544000
*     END;                          /*                       @Y30LB11*/ 00545000
*   ELSE                                                           0390 00546000
*     IF SAVGRETN=ON&               /* NEED TO JRNAL?        @ZA11015*/ 00547000
*         GXPDTOLD=FOX THEN         /*                       @ZA11665*/ 00548000
         B     @RC00374                                            0390 00549000
@RF00374 TM    SAVGRETN,B'10000000'                                0390 00550000
         BNO   @RF00390                                            0390 00551000
         CLC   GXPDTOLD(4),FOX                                     0390 00552000
         BNE   @RF00390                                            0390 00553000
*       CALL JOURNAL;               /* SET UP TO JOURNAL     @ZA11015*/ 00554000
         BAL   @14,JOURNAL                                         0391 00555000
*   RPLVRETC=SAVRETC;               /* RESTORE RETURN CODE   @Y30LB11*/ 00556000
@RF00390 DS    0H                                                  0392 00557000
@RC00374 MVC   RPLVRETC(2,RPLVPTR),SAVRETC                         0392 00558000
*   RPLRCODE=SAVRCODE;              /* RESTORE REASON CODE   @Y30LB11*/ 00559000
         MVC   RPLRCODE(2,RPLVPTR),SAVRCODE                        0393 00560000
*   RETURN;                         /* RETURN TO ICBVCR00    @Y30LB11*/ 00561000
         B     @EL00001                                            0394 00562000
*                                                                  0395 00563000
*/*  START OF SPECIFICATIONS ****                            @Y30LB11   00564000
*                                                                  0395 00565000
*01*  NAME = MNTRSTR                                         @Y30LB11   00566000
*                                                                  0395 00567000
*01*  FUNCTION = THIS SUBROUTINE IS CALLED TO RESTORE THE VOLUME   0395 00568000
*                MOUNT STATUS IF A MOUNT FAILS.              @Y30LB11   00569000
*                                                                  0395 00570000
*02*    INPUT = RPLV                                         @Y30LB11   00571000
*                                                                  0395 00572000
*02*    OUTPUT = RESTORED BASE VOLUME RECORD AND ALSO THE          0395 00573000
*                GROUP EXTENSION RECORD, IF VOLUME BELONGS TO A    0395 00574000
*                GENERAL USE GROUP.                         @Y30LB11    00575000
*                                                                  0395 00576000
**** END OF SPECIFICATIONS **                                        */ 00577000
*                                                                  0395 00578000
*MNTRSTR:                                                          0395 00579000
*   PROCEDURE;                      /*                       @Y30LB11*/ 00580000
MNTRSTR  STM   @14,@04,@SA00002                                    0395 00581000
         STM   @06,@12,@SA00002+28                                 0395 00582000
*   ARGVOL=MDVOL;                   /* SET VOLUME ARGUMENT   @Y30LB11*/ 00583000
         LA    @14,132                                             0396 00584000
         ALR   @14,RPLVPTR                                         0396 00585000
         MVC   ARGVOL(6),MDVOL(@14)                                0396 00586000
*   RPLVUPD=ON;                     /* RESTORE BASEV         @Y30LB11*/ 00587000
         OI    RPLVUPD(RPLVPTR),B'00000010'                        0397 00588000
*   RPLVTYP=RPLVREAD;               /* VIO READ SW ON        @Y30LB11*/ 00589000
         MVI   RPLVTYP(RPLVPTR),X'00'                              0398 00590000
*   RPLVKEY=ADDR(ARGV);             /* ADDR OF KEY           @Y30LB11*/ 00591000
         LA    @09,ARGV                                            0399 00592000
         ST    @09,RPLVKEY(,RPLVPTR)                               0399 00593000
*   RPLVKGE=OFF;                    /* READ EXACT KEY ONLY   @Y30LB11*/ 00594000
         NI    RPLVKGE(RPLVPTR),B'11111011'                        0400 00595000
*   MSGTEXT1=ADDR(MDVOL);           /* INSERT TEXT           @Y30LB11*/ 00596000
         LA    @14,MDVOL(,@14)                                     0401 00597000
         STCM  @14,7,MSGTEXT1                                      0401 00598000
*   MSGLEN1=SIX;                    /* INSERT LENGTH         @Y30LB11*/ 00599000
         MVI   MSGLEN1,X'06'                                       0402 00600000
*   MSGID=M411;                     /* BASEV NOT RESTORED    @Y30LB11*/ 00601000
         MVC   MSGID(4),@CF00158                                   0403 00602000
*   CALL COMONRTN;                  /* READ DIRECT           @Y30LB11*/ 00603000
         BAL   @14,COMONRTN                                        0404 00604000
*   IF RETCOD^=0 THEN               /* RECORD READ?          @Y30LB11*/ 00605000
         LTR   RETCOD,RETCOD                                       0405 00606000
         BNZ   @RT00405                                            0405 00607000
*     RETURN;                       /* NO, RETURN            @Y30LB11*/ 00608000
*   BASCPUID=BASCPUID&&CPU;         /* RESET CPUID MASK      @Y30LB11*/ 00609000
         L     @14,BASEVPTR(,RPLVPTR)                              0407 00610000
         XC    BASCPUID(2,@14),CPU                                 0407 00611000
*   IF BASEXPDT^=BASXPDT2 THEN      /* ARE OLD AND CURRENT EQ@ZA17172*/ 00612000
         L     @09,BASXPDT2                                        0408 00613000
         CL    @09,BASEXPDT(,@14)                                  0408 00614000
         BE    @RF00408                                            0408 00615000
*     DO;                           /* IF NOT EQUAL DO       @ZA17172*/ 00616000
*       BASEXPDT=BASXPDT2;          /* SET EXP TO OLD DATE   @ZA17172*/ 00617000
         ST    @09,BASEXPDT(,@14)                                  0410 00618000
*       JRNLFLG=ON;                 /* REMBER TO JRNL        @ZA17172*/ 00619000
         OI    JRNLFLG,B'00001000'                                 0411 00620000
*     END;                          /*                       @ZA17172*/ 00621000
*   GXPDTOLD=BASXPDT2;              /* RESTORE EXPDT         @ZA20327*/ 00622000
@RF00408 MVC   GXPDTOLD(4),BASXPDT2                                0413 00623000
*   RPLVTYP=RPLVPUT;                /* PUT I/O ON            @Y30LB11*/ 00624000
         MVI   RPLVTYP(RPLVPTR),X'01'                              0414 00625000
*   CALL COMONRTN;                  /* RESTORE VOL RECORD    @Y30LB11*/ 00626000
         BAL   @14,COMONRTN                                        0415 00627000
*   IF JRNLFLG=ON THEN              /* SHOULD JRNL BE UPDT   @ZA11665*/ 00628000
         TM    JRNLFLG,B'00001000'                                 0416 00629000
         BNO   @RF00416                                            0416 00630000
*     CALL JOURNAL;                 /* UPDATE JOURNAL        @ZA11665*/ 00631000
*                                                                  0417 00632000
         BAL   @14,JOURNAL                                         0417 00633000
*   /*****************************************************************/ 00634000
*   /*                                                               */ 00635000
*   /* IF THE VOLUME IS A GENERAL USE TYPE THE GVSNE RECORD IS READ  */ 00636000
*   /* TO BE RESTORED.                                       @Y30LB11*/ 00637000
*   /*                                                               */ 00638000
*   /*****************************************************************/ 00639000
*                                                                  0418 00640000
*   IF BASGENUS=ON THEN             /* GENERAL USE TYPE?     @Y30LB11*/ 00641000
@RF00416 L     @14,BASEVPTR(,RPLVPTR)                              0418 00642000
         TM    BASGENUS(@14),B'00010000'                           0418 00643000
         BNO   @RF00418                                            0418 00644000
*     DO;                           /* YES                   @Y30LB11*/ 00645000
*       ARGGP=BASGROUP;             /* SET GVSNE KEY         @Y30LB11*/ 00646000
         MVC   ARGGP(8),BASGROUP(@14)                              0420 00647000
*       ARGNUM=1;                   /* GET GVSNE             @Y30LB11*/ 00648000
         MVI   ARGNUM,X'01'                                        0421 00649000
*       SCRTCHSW=OFF;               /* INDICATE GVSNE UPDATE @Y30LB11*/ 00650000
*       RSTRSW=ON;                  /* SET RESTORE SW ON     @Y30LB11*/ 00651000
         OI    RSTRSW,B'01000000'                                  0423 00652000
         NI    SCRTCHSW,B'11011111'                                0423 00653000
*       CALL GVSRECRD;              /* UPDATE GVSNE RECORD   @Y30LB11*/ 00654000
         BAL   @14,GVSRECRD                                        0424 00655000
*     END;                          /*                       @Y30LB11*/ 00656000
*   END MNTRSTR;                    /*                       @Y30LB11*/ 00657000
@EL00002 DS    0H                                                  0426 00658000
@EF00002 DS    0H                                                  0426 00659000
@ER00002 LM    @14,@04,@SA00002                                    0426 00660000
         LM    @06,@12,@SA00002+28                                 0426 00661000
         BR    @14                                                 0426 00662000
*                                                                  0427 00663000
*/*  START OF SPECIFICATIONS ****                            @Y30LB11   00664000
*                                                                  0427 00665000
*01*  NAME = MTSCRTCH                                        @Y30LB11   00666000
*                                                                  0427 00667000
*01*  FUNCTION = THIS SUBROUTINE IS CALLED WHENEVER A VOLUME       0427 00668000
*                IS TO BE SELECTED AS A CANDIDATE FOR MOUNT        0427 00669000
*                NON-SPECIFIC.                               @Y30LB11   00670000
*                                                                  0427 00671000
*02*    INPUT = UPDATE PARAMETERS                            @Y30LB11   00672000
*                                                                  0427 00673000
*02*    OUTPUT = UPDATED BASEV AND GVSNE RECORDS             @Y30LB11   00674000
*       MESSAGE (VIA ICBVOP00) WITH ANY EXPIRATION DATE      @G24LB04   00675000
*       ASSIGNED, AND VOLUME IDENTIFICATION                  @G24LB04   00676000
*                                                                  0427 00677000
**** END OF SPECIFICATIONS **                                        */ 00678000
*                                                                  0427 00679000
*MTSCRTCH:                          /* MOUNT SCRATCH ROUTINE @Y30LB11*/ 00680000
*   PROCEDURE;                      /*                       @Y30LB11*/ 00681000
MTSCRTCH STM   @14,@08,@SA00003                                    0427 00682000
         STM   @10,@12,@SA00003+44                                 0427 00683000
*   CALL FINDGRP;                   /* GET GROUP NAME        @Y30LB11*/ 00684000
         BAL   @14,FINDGRP                                         0428 00685000
*   IF RETCOD^=0 THEN               /* GROUP GOTTEN?         @Y30LB11*/ 00686000
         SLR   @14,@14                                             0429 00687000
         CR    RETCOD,@14                                          0429 00688000
         BE    @RF00429                                            0429 00689000
*     RETURN CODE(0);               /* NO, RETURN TO VCR     @VS32850*/ 00690000
         LR    @15,@14                                             0430 00691000
         L     @14,@SA00003                                        0430 00692000
         LM    @00,@08,@SA00003+8                                  0430 00693000
         LM    @10,@12,@SA00003+44                                 0430 00694000
         BR    @14                                                 0430 00695000
*   SAVGRETN=OFF;                   /* SET SW OFF            @Y30LB11*/ 00696000
@RF00429 NI    SAVGRETN,B'01111111'                                0431 00697000
*   IF GRORETN=ON THEN              /* RETENTION SPECIFIED?  @Y30LB11*/ 00698000
         L     @14,GROUPPTR(,RPLVPTR)                              0432 00699000
         TM    GRORETN(@14),B'00000100'                            0432 00700000
         BNO   @RF00432                                            0432 00701000
*     DO;                           /* YES                   @Y30LB11*/ 00702000
*       SAVGRETN=ON;                /* YES, SET SAVE VALUE   @Y30LB11*/ 00703000
         OI    SAVGRETN,B'10000000'                                0434 00704000
*       SAVRETPD=GRORETPD;          /* SAVE VALUE            @Y30LB11*/ 00705000
         L     @14,GRORETPD(,@14)                                  0435 00706000
         ST    @14,SAVRETPD                                        0435 00707000
*     END;                          /*                       @Y30LB11*/ 00708000
*MTSCRCH2:                          /*                       @Y30LB11*/ 00709000
*   ENTRY;                          /* ENTRY                 @Y30LB11*/ 00710000
         B     @EC00437                                            0437 00711000
MTSCRCH2 STM   @14,@08,@SA00003                                    0437 00712000
         STM   @10,@12,@SA00003+44                                 0437 00713000
@EC00437 DS    0H                                                  0438 00714000
*   ARGNUM=1;                       /* GET GVSNE             @Y30LB11*/ 00715000
         MVI   ARGNUM,X'01'                                        0438 00716000
*   RPLVUPD=ON;                     /* READ FOR UPDATE       @Y30LB11*/ 00717000
         OI    RPLVUPD(RPLVPTR),B'00000010'                        0439 00718000
*   RPLVLOC=OFF;                    /* MOVE MODE             @Y30LB11*/ 00719000
*   RPLVNEXT=OFF;                   /* TURN READ NEXT OFF    @ZA13051*/ 00720000
*   RPLVDIR=ON;                     /* TURN READ DIR ON      @ZA13051*/ 00721000
*                                                                  0442 00722000
         OI    RPLVDIR(RPLVPTR),B'01000000'                        0442 00723000
         NI    RPLVLOC(RPLVPTR),B'01011111'                        0442 00724000
*   /*****************************************************************/ 00725000
*   /*                                                               */ 00726000
*   /* GET GVSNE RECORD                                      @Y30LB11*/ 00727000
*   /*                                                               */ 00728000
*   /*****************************************************************/ 00729000
*                                                                  0443 00730000
*   DO WHILE I=I;                   /* LOOP CONDITION        @Y30LB11*/ 00731000
         B     @DE00443                                            0443 00732000
@DL00443 DS    0H                                                  0444 00733000
*     SCRTCHSW=ON;                  /* INDICATE GVSNE READ   @Y30LB11*/ 00734000
*     RSTRSW=OFF;                   /* NOT RESTORATION       @Y30LB11*/ 00735000
         OI    SCRTCHSW,B'00100000'                                0445 00736000
         NI    RSTRSW,B'10111111'                                  0445 00737000
*     CALL GVSRECRD;                /* GET GVSNE RECORD      @Y30LB11*/ 00738000
         BAL   @14,GVSRECRD                                        0446 00739000
*     IF RETCOD^=0 THEN             /* GVSNE FOUND?          @Y30LB11*/ 00740000
         LTR   RETCOD,RETCOD                                       0447 00741000
         BZ    @RF00447                                            0447 00742000
*       RETURN CODE(4);             /* RETURN CODE           @Y30LB11*/ 00743000
         LA    @15,4                                               0448 00744000
         L     @14,@SA00003                                        0448 00745000
         LM    @00,@08,@SA00003+8                                  0448 00746000
         LM    @10,@12,@SA00003+44                                 0448 00747000
         BR    @14                                                 0448 00748000
*     DO I=INDEX TO LAST WHILE INDEX<=LAST;/* SEARCH SLOTS   @Y30LB11*/ 00749000
@RF00447 LR    @14,INDEX                                           0449 00750000
         B     @DE00449                                            0449 00751000
@DL00449 CH    INDEX,LAST                                          0449 00752000
         BH    @DC00449                                            0449 00753000
*       WRKRETPD=SAVRETPD;          /* SET WORK VALUE        @Y30LB11*/ 00754000
         L     WRKRETPD,SAVRETPD                                   0450 00755000
*       VOLINDEX=VOLINDEX+1;        /* INCREMENT INDEX       @Y30LB11*/ 00756000
         LH    @06,VOLINDEX                                        0451 00757000
         LA    @06,1(,@06)                                         0451 00758000
         STH   @06,VOLINDEX                                        0451 00759000
*       GXPDTOLD=GVSEXPDT(I);       /* SAVE OLD EXP DATE     @ZA11665*/ 00760000
         MH    @14,@CH00325                                        0452 00761000
         L     @06,GVSNEPTR(,RPLVPTR)                              0452 00762000
         ST    @14,@TF00001                                        0452 00763000
         ALR   @14,@06                                             0452 00764000
         MVC   GXPDTOLD(4),GVSEXPDT-20(@14)                        0452 00765000
*       IF GVSEXPDT(I)=FOX THEN     /* EXPDT SET IN GVSNE?   @VS32879*/ 00766000
         AL    @06,@TF00001                                        0453 00767000
         CLC   GVSEXPDT-20(4,@06),FOX                              0453 00768000
         BNE   @RF00453                                            0453 00769000
*         GXPDT=DLMTD;              /* SET DATE              @Y30LB11*/ 00770000
         MVC   GXPDT(4),DLMTD                                      0454 00771000
*       ELSE                        /* OTHERWISE             @Y30LB11*/ 00772000
*         GXPDT=GVSEXPDT(I);        /* USE GVSNE EXPDT       @Y30LB11*/ 00773000
         B     @RC00453                                            0455 00774000
@RF00453 LH    @14,I                                               0455 00775000
         MH    @14,@CH00325                                        0455 00776000
         L     @06,GVSNEPTR(,RPLVPTR)                              0455 00777000
         ALR   @06,@14                                             0455 00778000
         MVC   GXPDT(4),GVSEXPDT-20(@06)                           0455 00779000
*       IF SAVGRETN=ON&             /* RETENTION PERIOD?     @Y30LB11*/ 00780000
*           GVSEXPDT(I)=FOX THEN    /* AND EXP SPECIFIED     @VS32879*/ 00781000
@RC00453 TM    SAVGRETN,B'10000000'                                0456 00782000
         BNO   @RF00456                                            0456 00783000
         LH    @14,I                                               0456 00784000
         MH    @14,@CH00325                                        0456 00785000
         L     @06,GVSNEPTR(,RPLVPTR)                              0456 00786000
         ALR   @06,@14                                             0456 00787000
         CLC   GVSEXPDT-20(4,@06),FOX                              0456 00788000
         BNE   @RF00456                                            0456 00789000
*         DO WHILE WRKRETPD>0;      /* YES                   @Y30LB11*/ 00790000
         B     @DE00457                                            0457 00791000
@DL00457 DS    0H                                                  0458 00792000
*           CVB(TEMP,GX2PDT);       /* CONVERT               @Y30LB11*/ 00793000
         XC    @TS00001(8),@TS00001                                0458 00794000
         MVC   @TS00001+6(2),GX2PDT                                0458 00795000
         CVB   TEMP,@TS00001                                       0458 00796000
*           IF WRKRETPD>TSF THEN    /* RETENTION PERIOD> 365 @Y30LB11*/ 00797000
         LA    @14,365                                             0459 00798000
         CR    WRKRETPD,@14                                        0459 00799000
         BNH   @RF00459                                            0459 00800000
*             DO;                   /* YES                   @Y30LB11*/ 00801000
*               TEMP=TEMP+TSF;      /* INCREMENT BY 365      @Y30LB11*/ 00802000
         ALR   TEMP,@14                                            0461 00803000
*               WRKRETPD=WRKRETPD-TSF;/* REDUCE RET PERIOD   @Y30LB11*/ 00804000
         SLR   WRKRETPD,@14                                        0462 00805000
*             END;                  /*                       @Y30LB11*/ 00806000
*           ELSE                    /* OTHERWISE             @Y30LB11*/ 00807000
*             DO;                   /*                       @Y30LB11*/ 00808000
         B     @RC00459                                            0464 00809000
@RF00459 DS    0H                                                  0465 00810000
*               TEMP=TEMP+WRKRETPD; /* SET TEMP              @Y30LB11*/ 00811000
         ALR   TEMP,WRKRETPD                                       0465 00812000
*               WRKRETPD=0;         /* ZERO SAVRETPD         @Y30LB11*/ 00813000
         SLR   WRKRETPD,WRKRETPD                                   0466 00814000
*             END;                  /*                       @Y30LB11*/ 00815000
*           IF TEMP>TSF THEN        /* > 365?                @Y30LB11*/ 00816000
@RC00459 LA    @14,365                                             0468 00817000
         CR    TEMP,@14                                            0468 00818000
         BNH   @RF00468                                            0468 00819000
*             DO;                   /* YES                   @Y30LB11*/ 00820000
*               TEMP=TEMP-TSF;      /* REDUCE # OF DAYS      @Y30LB11*/ 00821000
         SLR   TEMP,@14                                            0470 00822000
*               CVD(TEMP,GX2PDT);   /* CONVERT               @Y30LB11*/ 00823000
         CVD   TEMP,@TS00001                                       0471 00824000
         MVC   GX2PDT(2),@TS00001+6                                0471 00825000
*               GENERATE REFS(GX1PDT,F);                           0472 00826000
*                                   /*                       @VS34306*/ 00827000
         LH    15,GX1PDT               LOAD YEAR             @VS34306   00828000
         SLL   15,4(0)                 SHIFT FOR SIGN        @VS34306   00829000
         O     15,F                    PUT IN SIGN           @VS34306   00830000
         STH   15,GX1PDT               RESTORE YEAR          @VS34306   00831000
*               CVB(TEMP,GX1PDT);   /* CONVERT               @Y30LB11*/ 00832000
         XC    @TS00001(8),@TS00001                                0473 00833000
         MVC   @TS00001+6(2),GX1PDT                                0473 00834000
         CVB   TEMP,@TS00001                                       0473 00835000
*               TEMP=TEMP+1;        /* INCREMENT YEAR BY 1   @Y30LB11*/ 00836000
         AL    TEMP,@CF00112                                       0474 00837000
*               CVD(TEMP,GX1PDT);   /* CONVERT               @VS34306*/ 00838000
         CVD   TEMP,@TS00001                                       0475 00839000
         MVC   GX1PDT(2),@TS00001+6                                0475 00840000
*               GENERATE REFS(GX1PDT);                             0476 00841000
*                                   /*                       @VS34306*/ 00842000
         LH    15,GX1PDT               LOAD YEAR             @VS34306   00843000
         SRL   15,4(0)                 SHIFT SIGN            @Y30LB11   00844000
         STH   15,GX1PDT               RESTORE YEAR          @Y30LB11   00845000
*             END;                  /*                       @Y30LB11*/ 00846000
*           ELSE                    /*                       @Y30LB11*/ 00847000
*             CVD(TEMP,GX2PDT);     /* OVERLAY DATE          @Y30LB11*/ 00848000
         B     @RC00468                                            0478 00849000
@RF00468 CVD   TEMP,@TS00001                                       0478 00850000
         MVC   GX2PDT(2),@TS00001+6                                0478 00851000
*           IF GXPDT>MAXIMUM THEN   /* > '0099365C'?         @Y30LB11*/ 00852000
@RC00468 CLC   GXPDT(4),@CB00146                                   0479 00853000
         BNH   @RF00479                                            0479 00854000
*             GXPDT=MAXIMUM;        /* SET EQUAL             @Y30LB11*/ 00855000
         MVC   GXPDT(4),@CB00146                                   0480 00856000
*         END;                      /*                       @Y30LB11*/ 00857000
@RF00479 DS    0H                                                  0481 00858000
@DE00457 LTR   WRKRETPD,WRKRETPD                                   0481 00859000
         BP    @DL00457                                            0481 00860000
*       SAVCPUBM=GVSCPUBM(I);       /* SET CPUBM             @Y30LB11*/ 00861000
@RF00456 LH    @14,I                                               0482 00862000
         MH    @14,@CH00325                                        0482 00863000
         L     @04,GVSNEPTR(,RPLVPTR)                              0482 00864000
         ALR   @04,@14                                             0482 00865000
         MVC   SAVCPUBM(2),GVSCPUBM-20(@04)                        0482 00866000
*       DO WHILE SAVCPUBM=Z2&       /* VOL NOT MOUNTED       @Y30LB11*/ 00867000
*             GVSFRESP(I)>=FRSP&    /* ENOUGH FR SPACE?      @Y30LB11*/ 00868000
*             GVSLEXT(I)>=LEXT&     /* CNTIG SPACE OK?       @Y30LB11*/ 00869000
*             (GXPDT>=EXPDT|        /* IN PERIOD?            @Y30LB11*/ 00870000
*             SAVGRETN=OFF);        /* NO RETENSION?         @Y30LB11*/ 00871000
         B     @DE00483                                            0483 00872000
@DL00483 DS    0H                                                  0484 00873000
*         CALL JFCBCK;              /* VOLID IN JFCB?        @Y30LB11*/ 00874000
         BAL   @14,JFCBCK                                          0484 00875000
*         IF RETCOD=0 THEN          /* VOL NOT EXTENDED?     @Y30LB11*/ 00876000
         LTR   RETCOD,RETCOD                                       0485 00877000
         BNZ   @RF00485                                            0485 00878000
*           CALL UCBCK;             /* CHECK UCBLIST         @Y30LB11*/ 00879000
         BAL   @14,UCBCK                                           0486 00880000
*         IF RETCOD=0 THEN          /* VOLUME NOT FOUND?     @Y30LB11*/ 00881000
@RF00485 LTR   RETCOD,RETCOD                                       0487 00882000
         BNZ   @RF00487                                            0487 00883000
*           DO;                     /*                       @Y30LB11*/ 00884000
*             ARGVOL=GVSVOLID(I);   /* SET ARGUMENT          @Y30LB11*/ 00885000
         LH    @14,I                                               0489 00886000
         MH    @14,@CH00325                                        0489 00887000
         L     @04,GVSNEPTR(,RPLVPTR)                              0489 00888000
         ST    @14,@TF00001                                        0489 00889000
         ALR   @14,@04                                             0489 00890000
         MVC   ARGVOL(6),GVSVOLID-20(@14)                          0489 00891000
*             IF GVSEXPDT(I)=FOX&   /* NO EXPIRATION DATE?   @VS32879*/ 00892000
*                 SAVGRETN=ON THEN  /* AND RETENTION         @Y30LB11*/ 00893000
         LR    @14,@04                                             0490 00894000
         AL    @14,@TF00001                                        0490 00895000
         CLC   GVSEXPDT-20(4,@14),FOX                              0490 00896000
         BNE   @RF00490                                            0490 00897000
         TM    SAVGRETN,B'10000000'                                0490 00898000
         BNO   @RF00490                                            0490 00899000
*               DO;                 /* SET & TRACK EXP DATE  @G24LB04*/ 00900000
*                 GVSEXPDT(I)=GXPDT;/* SET GVSNE XPDT        @G24LB04*/ 00901000
         AL    @04,@TF00001                                        0492 00902000
         MVC   GVSEXPDT-20(4,@04),GXPDT                            0492 00903000
*                 CALL WRITEXPD;    /* WRITE MESSAGE         @G24LB04*/ 00904000
         BAL   @14,WRITEXPD                                        0493 00905000
*               END;                /*                       @G24LB04*/ 00906000
*             GVSCPUBM(I)=GVSCPUBM(I)|CPU;/* SET CPU MASK    @Y30LB11*/ 00907000
@RF00490 LH    @14,I                                               0495 00908000
         MH    @14,@CH00325                                        0495 00909000
         L     @04,GVSNEPTR(,RPLVPTR)                              0495 00910000
         ALR   @04,@14                                             0495 00911000
         OC    GVSCPUBM-20(2,@04),CPU                              0495 00912000
*             CALL AMVGVSUD;        /* MORE GVSNE UPDATING   @G24LB04*/ 00913000
         BAL   @14,AMVGVSUD                                        0496 00914000
*             IF RETCOD^=0          /* FAILURE ?             @G24LB04*/ 00915000
*               THEN                /*                       @G24LB04*/ 00916000
         LTR   RETCOD,RETCOD                                       0497 00917000
         BZ    @RF00497                                            0497 00918000
*               DO;                 /*                       @G24LB04*/ 00919000
*                 SAVGRPCD=R23D;    /* UCB LOOK UP FAILED    @G24LB04*/ 00920000
         MVC   SAVGRPCD(2),@CB00190                                0499 00921000
*                 RETURN CODE(4);   /* REQUEST WILL FAIL     @G24LB04*/ 00922000
         LA    @15,4                                               0500 00923000
         L     @14,@SA00003                                        0500 00924000
         LM    @00,@08,@SA00003+8                                  0500 00925000
         LM    @10,@12,@SA00003+44                                 0500 00926000
         BR    @14                                                 0500 00927000
*               END;                /*                       @G24LB04*/ 00928000
*             RPLVTYP=RPLVPUT;      /* SET VIO WRITE SW ON   @Y30LB11*/ 00929000
@RF00497 MVI   RPLVTYP(RPLVPTR),X'01'                              0502 00930000
*             CALL COMONRTN;        /* PUT RECORD            @Y30LB11*/ 00931000
*                                                                  0503 00932000
         BAL   @14,COMONRTN                                        0503 00933000
*             /*******************************************************/ 00934000
*             /*                                                     */ 00935000
*             /* UPDATE BASE VOLUME RECORD.                  @Y30LB11*/ 00936000
*             /*                                                     */ 00937000
*             /*******************************************************/ 00938000
*                                                                  0504 00939000
*             RPLVNEXT=OFF;         /* READ NDIRECT          @Y30LB11*/ 00940000
*             RPLVDIR=ON;           /* DIRECT SW ON          @Y30LB11*/ 00941000
*             RPLVKGE=OFF;          /* EXACT KEY             @Y30LB11*/ 00942000
         OI    RPLVDIR(RPLVPTR),B'01000000'                        0506 00943000
         NI    RPLVNEXT(RPLVPTR),B'11011011'                       0506 00944000
*             IF RETCOD=0 THEN      /* PUT OK?               @Y30LB11*/ 00945000
         LTR   RETCOD,RETCOD                                       0507 00946000
         BNZ   @RF00507                                            0507 00947000
*               CALL BASUPDTE;      /* UPDATE VOL RECORD     @Y30LB11*/ 00948000
         BAL   @14,BASUPDTE                                        0508 00949000
*             IF RETCOD=0 THEN      /* RECORD UPDATED?       @Y30LB11*/ 00950000
@RF00507 LTR   RETCOD,RETCOD                                       0509 00951000
         BNZ   @RF00509                                            0509 00952000
*               DO;                 /* YES                   @Y30LB11*/ 00953000
*                 JFCVINDX=VOLINDEX;/* RESET JFCVINDX > 0    @Y30LB11*/ 00954000
         L     @14,JFCBPTR                                         0511 00955000
         LH    @08,VOLINDEX                                        0511 00956000
         STH   @08,JFCVINDX(,@14)                                  0511 00957000
*                 IF ALGOSW=ON THEN /* ALTERNATE ALGORITHM?  @Y30LB11*/ 00958000
         TM    ALGOSW,B'10000000'                                  0512 00959000
         BNO   @RF00512                                            0512 00960000
*                   ALGOBIT=ON;     /* SET 2ND ALGORITHM     @Y30LB11*/ 00961000
         OI    ALGOBIT(@14),B'10000000'                            0513 00962000
*                 RETURN CODE(0);   /* EXIT LOOP             @Y30LB11*/ 00963000
@RF00512 SLR   @15,@15                                             0514 00964000
         L     @14,@SA00003                                        0514 00965000
         LM    @00,@08,@SA00003+8                                  0514 00966000
         LM    @10,@12,@SA00003+44                                 0514 00967000
         BR    @14                                                 0514 00968000
*               END;                /*                       @Y30LB11*/ 00969000
*           END;                    /*                       @Y30LB11*/ 00970000
@RF00509 DS    0H                                                  0517 00971000
*         SAVCPUBM=CPU;             /* END LOOP CONDITION    @Y30LB11*/ 00972000
@RF00487 MVC   SAVCPUBM(2),CPU                                     0517 00973000
*       END;                        /*                       @Y30LB11*/ 00974000
@DE00483 CLC   SAVCPUBM(2),Z2                                      0518 00975000
         BNE   @DC00483                                            0518 00976000
         LH    @14,I                                               0518 00977000
         MH    @14,@CH00325                                        0518 00978000
         L     @04,GVSNEPTR(,RPLVPTR)                              0518 00979000
         LH    @07,GVSFRESP-20(@14,@04)                            0518 00980000
         CH    @07,FRSP                                            0518 00981000
         BL    @DC00483                                            0518 00982000
         LH    @14,GVSLEXT-20(@14,@04)                             0518 00983000
         L     @04,LEXT-1                                          0518 00984000
         LA    @04,0(,@04)                                         0518 00985000
         CR    @14,@04                                             0518 00986000
         BL    @DC00483                                            0518 00987000
         CLC   GXPDT(4),EXPDT                                      0518 00988000
         BNL   @DL00483                                            0518 00989000
         TM    SAVGRETN,B'10000000'                                0518 00990000
         BZ    @DL00483                                            0518 00991000
@DC00483 DS    0H                                                  0519 00992000
*     END;                          /*                       @Y30LB11*/ 00993000
         LA    @14,1                                               0519 00994000
         AH    @14,I                                               0519 00995000
@DE00449 STH   @14,I                                               0519 00996000
         CH    @14,LAST                                            0519 00997000
         BNH   @DL00449                                            0519 00998000
@DC00449 DS    0H                                                  0520 00999000
*     IF INDEX>LAST THEN            /* NEED ANOTHER GVSNE?   @Y30LB11*/ 01000000
         LH    @14,LAST                                            0520 01001000
         CR    INDEX,@14                                           0520 01002000
         BNH   @RF00520                                            0520 01003000
*       INDEX=INDEX-LAST;           /* NO, DECREMENT         @Y30LB11*/ 01004000
         SLR   INDEX,@14                                           0521 01005000
*     ELSE                          /* OTHERWISE             @Y30LB11*/ 01006000
*       INDEX=1;                    /* RESET INDEX TO 1      @Y30LB11*/ 01007000
         B     @RC00520                                            0522 01008000
@RF00520 LA    INDEX,1                                             0522 01009000
*     IF GVSEX=ON THEN              /* ANOTHER GVSNE?        @Y30LB11*/ 01010000
@RC00520 L     @14,GVSNEPTR(,RPLVPTR)                              0523 01011000
         TM    GVSEX(@14),B'10000000'                              0523 01012000
         BNO   @RF00523                                            0523 01013000
*       DO;                         /* YES                   @Y30LB11*/ 01014000
*         RPLVNEXT=ON;              /* READ NEXT             @Y30LB11*/ 01015000
*         RPLVDIR=OFF;              /* READ DIRECT OFF       @Y30LB11*/ 01016000
         OI    RPLVNEXT(RPLVPTR),B'00100000'                       0526 01017000
         NI    RPLVDIR(RPLVPTR),B'10111111'                        0526 01018000
*       END;                        /*                       @Y30LB11*/ 01019000
*     ELSE                          /* OTHERWISE             @Y30LB11*/ 01020000
*       DO;                         /*                       @Y30LB11*/ 01021000
         B     @RC00523                                            0528 01022000
@RF00523 DS    0H                                                  0529 01023000
*         SAVGRPCD=R232;            /* SET GROUP CODE        @Y30LB11*/ 01024000
         MVC   SAVGRPCD(2),@CB00188                                0529 01025000
*         RETURN CODE(4);           /* RETURN TO ICBVMT00    @Y30LB11*/ 01026000
         LA    @15,4                                               0530 01027000
         L     @14,@SA00003                                        0530 01028000
         LM    @00,@08,@SA00003+8                                  0530 01029000
         LM    @10,@12,@SA00003+44                                 0530 01030000
         BR    @14                                                 0530 01031000
*       END;                        /*                       @Y30LB11*/ 01032000
*   END;                            /*                       @Y30LB11*/ 01033000
@RC00523 DS    0H                                                  0532 01034000
@DE00443 LH    @14,I                                               0532 01035000
         CR    @14,@14                                             0532 01036000
         BE    @DL00443                                            0532 01037000
*   END MTSCRTCH;                   /*                       @Y30LB11*/ 01038000
@EL00003 DS    0H                                                  0533 01039000
@EF00003 DS    0H                                                  0533 01040000
@ER00003 LM    @14,@08,@SA00003                                    0533 01041000
         LM    @10,@12,@SA00003+44                                 0533 01042000
         BR    @14                                                 0533 01043000
*                                                                  0534 01044000
*/*  START OF SPECIFICATIONS ****                            @Y30LB11   01045000
*                                                                  0534 01046000
*01*  NAME = FINDGRP                                         @Y30LB11   01047000
*                                                                  0534 01048000
*01*  FUNCTION = THIS SUBROUTINE IS CALLED TO DETERMINE FROM       0534 01049000
*                WHICH GROUP THE NON-SPECIFIC MOUNT REQUEST WILL   0534 01050000
*                USE IN SELECTING A VOLUME.                  @Y30LB11   01051000
*                                                                  0534 01052000
*02*    INPUT = NONE                                         @Y30LB11   01053000
*                                                                  0534 01054000
*02*    OUTPUT = GROUP NAME                                  @Y30LB11   01055000
*                                                                  0534 01056000
**** END OF SPECIFICATIONS **                                        */ 01057000
*                                                                  0534 01058000
*FINDGRP:                           /* FINDGRP ROUTINE       @Y30LB11*/ 01059000
*   PROCEDURE;                      /*                       @Y30LB11*/ 01060000
FINDGRP  STM   @14,@08,@SA00004                                    0534 01061000
         STM   @10,@12,@SA00004+44                                 0534 01062000
*   RPLVTYP=RPLVREAD;               /* VIO READ SW ON        @Y30LB11*/ 01063000
         MVI   RPLVTYP(RPLVPTR),X'00'                              0535 01064000
*   RPLVUPD=OFF;                    /* NOT FOR UPDATE        @Y30LB11*/ 01065000
         NI    RPLVUPD(RPLVPTR),B'11111101'                        0536 01066000
*   RPLVLOC=ON;                     /* LOCATE MODE           @Y30LB11*/ 01067000
         OI    RPLVLOC(RPLVPTR),B'10000000'                        0537 01068000
*   JD1=JFCBDRLH;                   /* INITIALIZE JD1        @Y30LB11*/ 01069000
         L     @14,JFCBPTR                                         0538 01070000
         MVC   JD1(3),JFCBDRLH(@14)                                0538 01071000
*   JP1=JFCBPQTY;                   /* INITIALIZE JP1        @Y30LB11*/ 01072000
         MVC   JP1(3),JFCBPQTY(@14)                                0539 01073000
*   JS1=JFCBSQTY;                   /* INITIALIZE JS1        @Y30LB11*/ 01074000
         MVC   JS1(3),JFCBSQTY(@14)                                0540 01075000
*   JFCBYD=JFCBXPDT;                /* INITIALIZE JFCBYD     @Y30LB11*/ 01076000
         MVC   JFCBYD(3),JFCBXPDT(@14)                             0541 01077000
*   VOLINDEX=VINDX&OFFBIT;          /* SET VOLINDEX POSITIVE @Y30LB11*/ 01078000
         L     @08,@CF00117                                        0542 01079000
         LH    @04,VINDX(,@14)                                     0542 01080000
         N     @04,@CF02120                                        0542 01081000
         NR    @08,@04                                             0542 01082000
         STH   @08,VOLINDEX                                        0542 01083000
*   INDEX=VOLINDEX+1;               /* INCREMENT BY 1        @Y30LB11*/ 01084000
         AL    @08,@CF00112                                        0543 01085000
         LR    INDEX,@08                                           0543 01086000
*   NVOLINDX=NVOL;                  /* INITIALIZE NVOLINDX   @Y30LB11*/ 01087000
         IC    @08,NVOL(,@14)                                      0544 01088000
         STC   @08,NVOLINDX                                        0544 01089000
*   SPACESW=OFF;                    /* INITIALIZE SPACE SW   @Y30LB11*/ 01090000
         NI    SPACESW,B'11101111'                                 0545 01091000
*   IF JPQTY=0&                     /* PRIM SPACE NOT SPEC?  @Y30LB11*/ 01092000
*       JSQTY=0&                    /* SECDY SPACE NOT SPEC? @Y30LB11*/ 01093000
*       JFCBSPAC=JSPACE&            /* SPACE NOT SPECIFIED?  @Y30LB11*/ 01094000
*       JFCBNVOL=Z1&                /* NVOL ZERO             @ZA14749*/ 01095000
*       JFCBABST=0 THEN             /* REL TRACK ADDR 0?     @Y30LB11*/ 01096000
         L     @08,JPQTY-1                                         0546 01097000
         LA    @08,0(,@08)                                         0546 01098000
         LTR   @08,@08                                             0546 01099000
         BNZ   @RF00546                                            0546 01100000
         L     @08,JSQTY-1                                         0546 01101000
         LA    @08,0(,@08)                                         0546 01102000
         LTR   @08,@08                                             0546 01103000
         BNZ   @RF00546                                            0546 01104000
         TM    JFCBSPAC(@14),B'11000000'                           0546 01105000
         BNZ   @RF00546                                            0546 01106000
         CLC   JFCBNVOL(1,@14),Z1                                  0546 01107000
         BNE   @RF00546                                            0546 01108000
         LH    @08,JFCBABST(,@14)                                  0546 01109000
         LTR   @08,@08                                             0546 01110000
         BNZ   @RF00546                                            0546 01111000
*     DO;                           /* YES                   @Y30LB11*/ 01112000
*       IF JFCBMSGP=OFF THEN        /* MSVGRP SPECIFIED?     @Y30LB11*/ 01113000
         TM    JFCBMSGP(@14),B'00100000'                           0548 01114000
         BNZ   @RF00548                                            0548 01115000
*         DO;                       /* NO                    @Y30LB11*/ 01116000
*           SAVRETC=FOUR;           /* SET REASON CODE       @Y30LB11*/ 01117000
         MVC   SAVRETC(2),@CB00103                                 0550 01118000
*           SAVRCODE=R22E;          /* NOT SPACE NOR MSVGRP  @Y30LB11*/ 01119000
         MVC   SAVRCODE(2),@CB00182                                0551 01120000
*           RETURN CODE(4);         /* RETURN TO CALLER      @Y30LB11*/ 01121000
         LA    @15,4                                               0552 01122000
         L     @14,@SA00004                                        0552 01123000
         LM    @00,@08,@SA00004+8                                  0552 01124000
         LM    @10,@12,@SA00004+44                                 0552 01125000
         BR    @14                                                 0552 01126000
*         END;                      /*                       @Y30LB11*/ 01127000
*       IF JFCORGIS=ON|             /* INDEXED SEQUENTIAL?   @Y30LB11*/ 01128000
*           JFCORGPO=ON THEN        /* PARTITIONED ORG?      @Y30LB11*/ 01129000
@RF00548 L     @14,JFCBPTR                                         0554 01130000
         TM    JFCORGIS(@14),B'10000010'                           0554 01131000
         BZ    @RF00554                                            0554 01132000
*         DO;                       /* YES                   @Y30LB11*/ 01133000
*           SAVRETC=FOUR;           /* SET REASON CODE       @Y30LB11*/ 01134000
         MVC   SAVRETC(2),@CB00103                                 0556 01135000
*           SAVRCODE=R22F;          /* BAD ORGANIZATION      @Y30LB11*/ 01136000
         MVC   SAVRCODE(2),@CB00184                                0557 01137000
*           RETURN CODE(4);         /* RETURN TO CALLER      @Y30LB11*/ 01138000
         LA    @15,4                                               0558 01139000
         L     @14,@SA00004                                        0558 01140000
         LM    @00,@08,@SA00004+8                                  0558 01141000
         LM    @10,@12,@SA00004+44                                 0558 01142000
         BR    @14                                                 0558 01143000
*         END;                      /*                       @Y30LB11*/ 01144000
*       SPACESW=ON;                 /* SET SPACE SW ON       @Y30LB11*/ 01145000
@RF00554 OI    SPACESW,B'00010000'                                 0560 01146000
*     END;                          /*                       @Y30LB11*/ 01147000
*   IF JFCBNVOL=Z1 THEN             /* NVOL = 0?             @Y30LB11*/ 01148000
@RF00546 L     @14,JFCBPTR                                         0562 01149000
         CLC   JFCBNVOL(1,@14),Z1                                  0562 01150000
         BNE   @RF00562                                            0562 01151000
*     DO;                           /* YES                   @Y30LB11*/ 01152000
*       IF JFCBMSGP=ON&             /* MSVGRP SPECIFIED?     @Y30LB11*/ 01153000
*           JFCMSVGP^=BK THEN       /* MSVGRP NOT BLANK?     @Y30LB11*/ 01154000
         TM    JFCBMSGP(@14),B'00100000'                           0564 01155000
         BNO   @RF00564                                            0564 01156000
         CLC   JFCMSVGP(8,@14),@CC00108                            0564 01157000
         BE    @RF00564                                            0564 01158000
*         ARGGP=JFCMSVGP;           /* USE JFCVVGRP          @Y30LB11*/ 01159000
         MVC   ARGGP(8),JFCMSVGP(@14)                              0565 01160000
*       ELSE                        /* OTHERWISE             @Y30LB11*/ 01161000
*         ARGGP=SYSGRP;             /* USE SYSGROUP          @Y30LB11*/ 01162000
         B     @RC00564                                            0566 01163000
@RF00564 MVC   ARGGP(8),@CC00214                                   0566 01164000
*     END;                          /*                       @Y30LB11*/ 01165000
*   ELSE                            /* OTHERWISE             @Y30LB11*/ 01166000
*     DO;                           /* SET GROUP ARGUMENT    @Y30LB11*/ 01167000
         B     @RC00562                                            0568 01168000
@RF00562 DS    0H                                                  0569 01169000
*       ARGVOL=JFCAVOLS(1);         /* SET ARGUMENT          @Y30LB11*/ 01170000
         L     @14,JFCBPTR                                         0569 01171000
         MVC   ARGVOL(6),JFCAVOLS(@14)                             0569 01172000
*       RPLVKEY=ADDR(ARGV);         /* ADDR OF KEY           @Y30LB11*/ 01173000
         LA    @14,ARGV                                            0570 01174000
         ST    @14,RPLVKEY(,RPLVPTR)                               0570 01175000
*       MSGTEXT1=ADDR(ARGVOL);      /* INSERT TEXT           @Y30LB11*/ 01176000
         LA    @14,ARGVOL                                          0571 01177000
         STCM  @14,7,MSGTEXT1                                      0571 01178000
*       MSGLEN1=SIX;                /* INSERT LENGTH         @Y30LB11*/ 01179000
         MVI   MSGLEN1,X'06'                                       0572 01180000
*       MSGID=M402;                 /* BASEV NOT FND         @Y30LB11*/ 01181000
         MVC   MSGID(4),@CF00150                                   0573 01182000
*       CALL COMONRTN;              /* GET VOLID RECORD      @Y30LB11*/ 01183000
         BAL   @14,COMONRTN                                        0574 01184000
*       IF RETCOD^=0 THEN           /* GOOD RETURN?          @Y30LB11*/ 01185000
         LTR   RETCOD,RETCOD                                       0575 01186000
         BZ    @RF00575                                            0575 01187000
*         DO;                       /* NO                    @Y30LB11*/ 01188000
*           SAVRETC=FOUR;           /* SET RETURN CODE       @Y30LB11*/ 01189000
         MVC   SAVRETC(2),@CB00103                                 0577 01190000
*           SAVRCODE=R231;          /* SET REASON CODE       @Y30LB11*/ 01191000
         MVC   SAVRCODE(2),@CB00186                                0578 01192000
*           RETURN CODE(4);         /* PASS BAD RETURN       @Y30LB11*/ 01193000
         LA    @15,4                                               0579 01194000
         L     @14,@SA00004                                        0579 01195000
         LM    @00,@08,@SA00004+8                                  0579 01196000
         LM    @10,@12,@SA00004+44                                 0579 01197000
         BR    @14                                                 0579 01198000
*         END;                      /*                       @Y30LB11*/ 01199000
*       IF BASGENUS=ON|             /* GENERAL USE VOLUME    @YM30739*/ 01200000
*           BASRSTD=ON THEN         /* RESTRICTED USE VOLUME @YM30739*/ 01201000
@RF00575 L     @14,BASEVPTR(,RPLVPTR)                              0581 01202000
         TM    BASGENUS(@14),B'00011000'                           0581 01203000
         BZ    @RF00581                                            0581 01204000
*         ARGGP=BASGROUP;           /* USE BASGROUP          @Y30LB11*/ 01205000
         MVC   ARGGP(8),BASGROUP(@14)                              0582 01206000
*       ELSE                        /* OTHERWISE             @Y30LB11*/ 01207000
*         ARGGP=SYSGRP;             /* USE SYSGROUP          @Y30LB11*/ 01208000
         B     @RC00581                                            0583 01209000
@RF00581 MVC   ARGGP(8),@CC00214                                   0583 01210000
*     END;                          /*                       @Y30LB11*/ 01211000
@RC00581 DS    0H                                                  0585 01212000
*   ARGNUM=0;                       /* SET ARG FOR GROUP RCD @Y30LB11*/ 01213000
@RC00562 MVI   ARGNUM,X'00'                                        0585 01214000
*   RPLVKEY=ADDR(ARGGR);            /* ADDR OF GROUP KEY     @Y30LB11*/ 01215000
         LA    @14,ARGGR                                           0586 01216000
         ST    @14,RPLVKEY(,RPLVPTR)                               0586 01217000
*   MSGTEXT1=ADDR(ARGGP);           /* TEXT INSERT           @Y30LB11*/ 01218000
         LA    @14,ARGGP                                           0587 01219000
         STCM  @14,7,MSGTEXT1                                      0587 01220000
*   MSGLEN1=EIGHT;                  /* INSERT LENGTH         @Y30LB11*/ 01221000
         MVI   MSGLEN1,X'08'                                       0588 01222000
*   MSGID=M415;                     /* GROUP NOT FND         @Y30LB11*/ 01223000
         MVC   MSGID(4),@CF00160                                   0589 01224000
*   CALL COMONRTN;                  /* GET GROUP RECORD      @Y30LB11*/ 01225000
         BAL   @14,COMONRTN                                        0590 01226000
*   IF RETCOD^=0 THEN               /* GOOD RETURN?          @Y30LB11*/ 01227000
         LTR   RETCOD,RETCOD                                       0591 01228000
         BZ    @RF00591                                            0591 01229000
*     DO;                           /* NO                    @Y30LB11*/ 01230000
*       SAVRETC=FOUR;               /* SET RETURN CODE       @Y30LB11*/ 01231000
         MVC   SAVRETC(2),@CB00103                                 0593 01232000
*       SAVRCODE=R231;              /* SET REASON CODE       @Y30LB11*/ 01233000
         MVC   SAVRCODE(2),@CB00186                                0594 01234000
*       RETURN CODE(4);             /* PASS BAD RETURN       @Y30LB11*/ 01235000
         LA    @15,4                                               0595 01236000
         L     @14,@SA00004                                        0595 01237000
         LM    @00,@08,@SA00004+8                                  0595 01238000
         LM    @10,@12,@SA00004+44                                 0595 01239000
         BR    @14                                                 0595 01240000
*     END;                          /*                       @Y30LB11*/ 01241000
*   IF SPACESW=ON THEN              /* WAS SPACE SPECIFIED?  @Y30LB11*/ 01242000
@RF00591 TM    SPACESW,B'00010000'                                 0597 01243000
         BNO   @RF00597                                            0597 01244000
*     DO;                           /* FILL IN FROM GROUP    @Y30LB11*/ 01245000
*       JFCBFQTY=GROPSPD;           /* JFCB PRIMARY SPACE    @Y30LB11*/ 01246000
         L     @14,GROUPPTR(,RPLVPTR)                              0599 01247000
         LH    @08,GROPSPD(,@14)                                   0599 01248000
         STCM  @08,7,JFCBFQTY                                      0599 01249000
*       JFCBPQTY=JFCBQTY;           /* SET JFCB WITH SPACE   @Y30LB11*/ 01250000
         L     @04,JFCBPTR                                         0600 01251000
         MVC   JFCBPQTY(3,@04),JFCBQTY                             0600 01252000
*       JFCBFQTY=GROSSPD;           /* JFCB SECONDARY SPACE  @Y30LB11*/ 01253000
         LH    @07,GROSSPD(,@14)                                   0601 01254000
         STCM  @07,7,JFCBFQTY                                      0601 01255000
*       JFCBSQTY=JFCBQTY;           /* SET JFCB WITH SPACE   @Y30LB11*/ 01256000
         MVC   JFCBSQTY(3,@04),JFCBQTY                             0602 01257000
*       JFCBSPAC=CYLSPACE;          /* SET CYLINDER BOUN ON  @Y30LB11*/ 01258000
         OI    JFCBSPAC(@04),B'11000000'                           0603 01259000
*       JPQTY=GROPSPD;              /* PRIMARY SPACE         @Y30LB11*/ 01260000
         STCM  @08,7,JPQTY                                         0604 01261000
*       JSQTY=GROSSPD;              /* SECONDARY SPACE       @Y30LB11*/ 01262000
         STCM  @07,7,JSQTY                                         0605 01263000
*       PQTY=JPQTY;                 /* SET PQTY              @Y30LB11*/ 01264000
         STCM  @08,7,PQTY                                          0606 01265000
*       SQTY=JSQTY;                 /* SET SQTY              @Y30LB11*/ 01266000
         STCM  @07,7,SQTY                                          0607 01267000
*       IF GRORLSE=ON THEN          /* IS RELEASE SET?       @Y30LB11*/ 01268000
         TM    GRORLSE(@14),B'00001000'                            0608 01269000
         BNO   @RF00608                                            0608 01270000
*         DO;                       /*                       @Y30LB11*/ 01271000
*           JFCRLSE1=ON;            /* YES, SET JFCB RELEASE @Y30LB11*/ 01272000
*           JFCRLSE2=ON;            /* YES, SET JFCB RELEASE @Y30LB11*/ 01273000
         OI    JFCRLSE1(@04),B'11000000'                           0611 01274000
*         END;                      /*                       @Y30LB11*/ 01275000
*       JFCONTIG=ON;                /* SET CONTIGUOUS BIT ON @Y30LB11*/ 01276000
@RF00608 L     @14,JFCBPTR                                         0613 01277000
         OI    JFCONTIG(@14),B'00001000'                           0613 01278000
*     END;                          /*                       @Y30LB11*/ 01279000
*   ELSE                            /* OTHERWISE             @Y30LB11*/ 01280000
*     DO;                           /* CALCULATE IT          @Y30LB11*/ 01281000
         B     @RC00597                                            0615 01282000
@RF00597 DS    0H                                                  0616 01283000
*       IF JFCBSPAC=CYLSPACE THEN   /* SPACE NOT SPECIFIED   @Y30LB11*/ 01284000
         L     @14,JFCBPTR                                         0616 01285000
         TM    JFCBSPAC(@14),B'11000000'                           0616 01286000
         BNO   @RF00616                                            0616 01287000
*         DO;                       /*                       @Y30LB11*/ 01288000
*           PQTY=JPQTY;             /* SET PRIMARY QTY       @Y30LB11*/ 01289000
         MVC   PQTY(3),JPQTY                                       0618 01290000
*           SQTY=JSQTY;             /* SET SECONDARY QTY     @Y30LB11*/ 01291000
         MVC   SQTY(3),JSQTY                                       0619 01292000
*         END;                      /*                       @Y30LB11*/ 01293000
*       ELSE                        /*                       @Y30LB11*/ 01294000
*         IF JFCBSPAC=TRKSPACE THEN /* SPACE IN TRACKS?      @Y30LB11*/ 01295000
         B     @RC00616                                            0621 01296000
@RF00616 L     @14,JFCBPTR                                         0621 01297000
         TM    JFCBSPAC(@14),B'10000000'                           0621 01298000
         BNO   @RF00621                                            0621 01299000
         TM    JFCBSPAC(@14),B'01000000'                           0621 01300000
         BNZ   @RF00621                                            0621 01301000
*           DO;                     /* SET QUANTITIES        @Y30LB11*/ 01302000
*             IF JPQTY//TRKCYL>0 THEN/* MULTIPLE OF 19?      @ZM30745*/ 01303000
         L     @02,JPQTY-1                                         0623 01304000
         LA    @02,0(,@02)                                         0623 01305000
         SRDA  @02,32                                              0623 01306000
         D     @02,@CF00148                                        0623 01307000
         LTR   @02,@02                                             0623 01308000
         BNP   @RF00623                                            0623 01309000
*               ROUND=1;            /* YES, ROUND UP         @Y30LB11*/ 01310000
         LA    ROUND,1                                             0624 01311000
*             ELSE                  /* OTHERWISE             @Y30LB11*/ 01312000
*               ROUND=0;            /* DO NOT ROUND          @Y30LB11*/ 01313000
         B     @RC00623                                            0625 01314000
@RF00623 SLR   ROUND,ROUND                                         0625 01315000
*             PQTY=(JPQTY/TRKCYL)+ROUND;/* SET PRIMARY       @ZM30745*/ 01316000
@RC00623 LA    @14,19                                              0626 01317000
         L     @03,JPQTY-1                                         0626 01318000
         LA    @03,0(,@03)                                         0626 01319000
         SLR   @02,@02                                             0626 01320000
         DR    @02,@14                                             0626 01321000
         ALR   @03,ROUND                                           0626 01322000
         STCM  @03,7,PQTY                                          0626 01323000
*             IF JSQTY//TRKCYL>0 THEN/* MULTIPLE OF 19?      @ZM30745*/ 01324000
         L     @02,JSQTY-1                                         0627 01325000
         LA    @02,0(,@02)                                         0627 01326000
         SRDA  @02,32                                              0627 01327000
         DR    @02,@14                                             0627 01328000
         LTR   @02,@02                                             0627 01329000
         BNP   @RF00627                                            0627 01330000
*               ROUND=1;            /* YES, ROUND UP         @Y30LB11*/ 01331000
         LA    ROUND,1                                             0628 01332000
*             ELSE                  /* OTHERWISE             @Y30LB11*/ 01333000
*               ROUND=0;            /* DO NOT ROUND          @Y30LB11*/ 01334000
         B     @RC00627                                            0629 01335000
@RF00627 SLR   ROUND,ROUND                                         0629 01336000
*             SQTY=(JSQTY/TRKCYL)+ROUND;/* SET SECONDARY     @ZM30745*/ 01337000
@RC00627 L     @03,JSQTY-1                                         0630 01338000
         LA    @03,0(,@03)                                         0630 01339000
         SLR   @02,@02                                             0630 01340000
         D     @02,@CF00148                                        0630 01341000
         ALR   @03,ROUND                                           0630 01342000
         STCM  @03,7,SQTY                                          0630 01343000
*           END;                    /*                       @Y30LB11*/ 01344000
*         ELSE                      /* OTHERWISE             @Y30LB11*/ 01345000
*           IF JFCBSPAC=AVBSPACE THEN/* BLOCK REQUEST        @YM30739*/ 01346000
         B     @RC00621                                            0632 01347000
@RF00621 L     @14,JFCBPTR                                         0632 01348000
         TM    JFCBSPAC(@14),B'01000000'                           0632 01349000
         BNO   @RF00632                                            0632 01350000
         TM    JFCBSPAC(@14),B'10000000'                           0632 01351000
         BNZ   @RF00632                                            0632 01352000
*             DO;                   /*                       @YM30739*/ 01353000
*               IF JFCBDRLH^=0 THEN /* BLKLENG - CALCULATE   @YM30739*/ 01354000
         ICM   @08,7,JFCBDRLH(@14)                                 0634 01355000
         BZ    @RF00634                                            0634 01356000
*                 DO;               /*                       @YM30739*/ 01357000
*                   IF KEYLE>0 THEN /*                       @ZM30745*/ 01358000
         CLI   KEYLE(@14),0                                        0636 01359000
         BNH   @RF00636                                            0636 01360000
*                     RECLEN=CON1+KEYLE+DRLH;/* RECORD LENGTH-KEY  0637 01361000
*                                                            @YM30739*/ 01362000
         LA    RECLEN,191                                          0637 01363000
         SLR   @04,@04                                             0637 01364000
         IC    @04,KEYLE(,@14)                                     0637 01365000
         ALR   RECLEN,@04                                          0637 01366000
         L     @14,DRLH-1                                          0637 01367000
         LA    @14,0(,@14)                                         0637 01368000
         ALR   RECLEN,@14                                          0637 01369000
*                   ELSE            /*                       @ZM30745*/ 01370000
*                     RECLEN=CON2+DRLH;/* RECORD LENGTH NO-KEY     0638 01371000
*                                                            @YM30739*/ 01372000
         B     @RC00636                                            0638 01373000
@RF00636 LA    RECLEN,135                                          0638 01374000
         L     @14,DRLH-1                                          0638 01375000
         LA    @14,0(,@14)                                         0638 01376000
         ALR   RECLEN,@14                                          0638 01377000
*                   RECORDS=TKCAPCTY/RECLEN;/*               @ZM30745   01378000
*                                      CALCULATE NO OF       @ZM30745   01379000
*                                      RECORDS               @ZM30745*/ 01380000
@RC00636 L     @02,@CF00217                                        0639 01381000
         SRDA  @02,32                                              0639 01382000
         DR    @02,RECLEN                                          0639 01383000
         LR    RECORDS,@03                                         0639 01384000
*                   IF(JFCRFO=OFF&RECORDS^=0) THEN/* CHECK IF      0640 01385000
*                                                            @ZM30745   01386000
*                                      TRACK OVER FLOW       @ZM30745   01387000
*                                      IS REQUESTED          @ZM30745*/ 01388000
         L     @14,JFCBPTR                                         0640 01389000
         TM    JFCRFO(@14),B'00100000'                             0640 01390000
         BNZ   @RF00640                                            0640 01391000
         SLR   @14,@14                                             0640 01392000
         CR    RECORDS,@14                                         0640 01393000
         BE    @RF00640                                            0640 01394000
*                     DO;           /*                       @ZM30745*/ 01395000
*                       IF(JPQTY//RECORDS)>0 THEN/* CHECK    @ZM30745   01396000
*                                      IF ANOTHER TRACK      @ZM30745   01397000
*                                      REQUIRED              @ZM30745*/ 01398000
         L     @02,JPQTY-1                                         0642 01399000
         LA    @02,0(,@02)                                         0642 01400000
         SRDA  @02,32                                              0642 01401000
         DR    @02,RECORDS                                         0642 01402000
         CR    @02,@14                                             0642 01403000
         BNH   @RF00642                                            0642 01404000
*                         ROUND=1;  /* SET FOR ANOTHER TRACK @ZM30745*/ 01405000
         LA    ROUND,1                                             0643 01406000
*                       ELSE        /*                       @ZM30745*/ 01407000
*                         ROUND=0;  /* NO TRACK REQUIRED     @ZM30745*/ 01408000
         B     @RC00642                                            0644 01409000
@RF00642 SLR   ROUND,ROUND                                         0644 01410000
*                       PQTY=(JPQTY/RECORDS)+ROUND;/* CALCULATE    0645 01411000
*                                                            @ZM30745   01412000
*                                      PRIMARY               @ZM30745   01413000
*                                      QUANTITY IN TRKS      @ZM30745*/ 01414000
@RC00642 L     @03,JPQTY-1                                         0645 01415000
         LA    @03,0(,@03)                                         0645 01416000
         SLR   @02,@02                                             0645 01417000
         DR    @02,RECORDS                                         0645 01418000
         ALR   @03,ROUND                                           0645 01419000
         STCM  @03,7,PQTY                                          0645 01420000
*                       IF(JSQTY//RECORDS)>0 THEN/* CHECK    @ZM30745   01421000
*                                      IF ANOTHER TRACK      @ZM30745   01422000
*                                      REQUIRED              @ZM30745*/ 01423000
         L     @02,JSQTY-1                                         0646 01424000
         LA    @02,0(,@02)                                         0646 01425000
         SRDA  @02,32                                              0646 01426000
         DR    @02,RECORDS                                         0646 01427000
         LTR   @02,@02                                             0646 01428000
         BNP   @RF00646                                            0646 01429000
*                         ROUND=1;  /* SET FOR ANOTHER TRACK @ZM30745*/ 01430000
         LA    ROUND,1                                             0647 01431000
*                       ELSE        /*                       @ZM30745*/ 01432000
*                         ROUND=0;  /* NO TRACK REQUIRED     @ZM30745*/ 01433000
         B     @RC00646                                            0648 01434000
@RF00646 SLR   ROUND,ROUND                                         0648 01435000
*                       SQTY=(JSQTY/RECORDS)+ROUND;/* CALCULATE    0649 01436000
*                                                            @ZM30745   01437000
*                                      SECONDARY             @ZM30745   01438000
*                                      QTY IN TRKS           @ZM30745*/ 01439000
@RC00646 L     @03,JSQTY-1                                         0649 01440000
         LA    @03,0(,@03)                                         0649 01441000
         SLR   @02,@02                                             0649 01442000
         DR    @02,RECORDS                                         0649 01443000
         ALR   @03,ROUND                                           0649 01444000
         STCM  @03,7,SQTY                                          0649 01445000
*                       IF(PQTY//TRKCYL)>0 THEN/* CHECK IF EXTRA   0650 01446000
*                                                            @ZM30745   01447000
*                                      CYL REQUIRED          @ZM30745*/ 01448000
         L     @02,PQTY-1                                          0650 01449000
         LA    @02,0(,@02)                                         0650 01450000
         SRDA  @02,32                                              0650 01451000
         D     @02,@CF00148                                        0650 01452000
         LTR   @02,@02                                             0650 01453000
         BNP   @RF00650                                            0650 01454000
*                         ROUND=1;  /* EXTRA CYLINDER REQUIRED     0651 01455000
*                                                            @ZM30745*/ 01456000
         LA    ROUND,1                                             0651 01457000
*                       ELSE        /*                       @ZM30745*/ 01458000
*                         ROUND=0;  /* NO EXTRA CYLINDER REQUIRED  0652 01459000
*                                                            @ZM30745*/ 01460000
         B     @RC00650                                            0652 01461000
@RF00650 SLR   ROUND,ROUND                                         0652 01462000
*                       PQTY=(PQTY/TRKCYL)+ROUND;/* CALCULATE      0653 01463000
*                                                            @ZM30745   01464000
*                                      PRIMARY QTY IN        @ZM30745   01465000
*                                      CYL                   @ZM30745*/ 01466000
@RC00650 LA    @14,19                                              0653 01467000
         L     @03,PQTY-1                                          0653 01468000
         LA    @03,0(,@03)                                         0653 01469000
         SLR   @02,@02                                             0653 01470000
         DR    @02,@14                                             0653 01471000
         ALR   @03,ROUND                                           0653 01472000
         STCM  @03,7,PQTY                                          0653 01473000
*                       IF(SQTY//TRKCYL)>0 THEN/* CHECK IF EXTRA   0654 01474000
*                                                            @ZM30745   01475000
*                                      CYL REQUIRED          @ZM30745*/ 01476000
         L     @02,SQTY-1                                          0654 01477000
         LA    @02,0(,@02)                                         0654 01478000
         SRDA  @02,32                                              0654 01479000
         DR    @02,@14                                             0654 01480000
         LTR   @02,@02                                             0654 01481000
         BNP   @RF00654                                            0654 01482000
*                         ROUND=1;  /*                       @ZM30745*/ 01483000
         LA    ROUND,1                                             0655 01484000
*                       ELSE        /*                       @ZM30745*/ 01485000
*                         ROUND=0;  /* NO EXTRA CYLINDER REQUIRED  0656 01486000
*                                                            @ZM30745*/ 01487000
         B     @RC00654                                            0656 01488000
@RF00654 SLR   ROUND,ROUND                                         0656 01489000
*                       SQTY=(SQTY/TRKCYL)+ROUND;/* CALCULATE      0657 01490000
*                                                            @ZM30745   01491000
*                                      SECONDARY QTY IN      @ZM30745   01492000
*                                      CYL                   @ZM30745*/ 01493000
@RC00654 L     @03,SQTY-1                                          0657 01494000
         LA    @03,0(,@03)                                         0657 01495000
         SLR   @02,@02                                             0657 01496000
         D     @02,@CF00148                                        0657 01497000
         ALR   @03,ROUND                                           0657 01498000
         STCM  @03,7,SQTY                                          0657 01499000
*                     END;          /*                       @ZM30745*/ 01500000
*                   ELSE            /*                       @ZM30745*/ 01501000
*                     DO;           /*                       @ZM30745*/ 01502000
         B     @RC00640                                            0659 01503000
@RF00640 DS    0H                                                  0660 01504000
*                       TOTLEN=RECLEN*JPQTY;/* TOTAL         @ZM30745   01505000
*                                      LENGTH OF RECORDS     @ZM30745*/ 01506000
         L     @03,JPQTY-1                                         0660 01507000
         LA    @03,0(,@03)                                         0660 01508000
         MR    @02,RECLEN                                          0660 01509000
         LR    TOTLEN,@03                                          0660 01510000
*                       IF(TOTLEN//TKCAPCTY)>0 THEN/*        @ZM30745*/ 01511000
         LR    @02,TOTLEN                                          0661 01512000
         SRDA  @02,32                                              0661 01513000
         D     @02,@CF00217                                        0661 01514000
         LTR   @02,@02                                             0661 01515000
         BNP   @RF00661                                            0661 01516000
*                         ROUND=1;  /* SET FOR ANOTHER       @ZM30745   01517000
*                                      TRACK                 @ZM30745*/ 01518000
         LA    ROUND,1                                             0662 01519000
*                       ELSE        /*                       @ZM30745*/ 01520000
*                         ROUND=0;  /* NO OTHER TRACK        @ZM30745   01521000
*                                      NEEDED                @ZM30745*/ 01522000
         B     @RC00661                                            0663 01523000
@RF00661 SLR   ROUND,ROUND                                         0663 01524000
*                       PQTY=(TOTLEN/TKCAPCTY)+ROUND;/*      @ZM30745   01525000
*                                      CALCULATE NO OF       @ZM30745   01526000
*                                      TRACKS                @ZM30745*/ 01527000
@RC00661 L     @14,@CF00217                                        0664 01528000
         LR    @02,TOTLEN                                          0664 01529000
         SRDA  @02,32                                              0664 01530000
         DR    @02,@14                                             0664 01531000
         ALR   @03,ROUND                                           0664 01532000
         STCM  @03,7,PQTY                                          0664 01533000
*                       TOTLEN=RECLEN*JSQTY;/* TOTAL         @ZM30745   01534000
*                                      LENGTH OF RECORDS     @ZM30745*/ 01535000
         L     @03,JSQTY-1                                         0665 01536000
         LA    @03,0(,@03)                                         0665 01537000
         MR    @02,RECLEN                                          0665 01538000
         LR    TOTLEN,@03                                          0665 01539000
*                       IF(TOTLEN//TKCAPCTY)>0 THEN/*        @ZM30745*/ 01540000
         LR    @02,TOTLEN                                          0666 01541000
         SRDA  @02,32                                              0666 01542000
         DR    @02,@14                                             0666 01543000
         LTR   @02,@02                                             0666 01544000
         BNP   @RF00666                                            0666 01545000
*                         ROUND=1;  /* SET FOR ANOTHER       @ZM30745   01546000
*                                      TRACK                 @ZM30745*/ 01547000
         LA    ROUND,1                                             0667 01548000
*                       ELSE        /*                       @ZM30745*/ 01549000
*                         ROUND=0;  /* NO OTHER TRACK        @ZM30745   01550000
*                                      NEEDED                @ZM30745*/ 01551000
         B     @RC00666                                            0668 01552000
@RF00666 SLR   ROUND,ROUND                                         0668 01553000
*                       SQTY=(TOTLEN/TKCAPCTY)+ROUND;/*      @ZM30745   01554000
*                                      CALCULATE NO OF       @ZM30745   01555000
*                                      TRACKS                @ZM30745*/ 01556000
@RC00666 LR    @02,TOTLEN                                          0669 01557000
         SRDA  @02,32                                              0669 01558000
         D     @02,@CF00217                                        0669 01559000
         ALR   @03,ROUND                                           0669 01560000
         STCM  @03,7,SQTY                                          0669 01561000
*                       IF PQTY//TRKCYL>0 THEN/* MULTIPLE OF 19?   0670 01562000
*                                                            @ZM30745*/ 01563000
         L     @02,PQTY-1                                          0670 01564000
         LA    @02,0(,@02)                                         0670 01565000
         SRDA  @02,32                                              0670 01566000
         D     @02,@CF00148                                        0670 01567000
         LTR   @02,@02                                             0670 01568000
         BNP   @RF00670                                            0670 01569000
*                         ROUND=1;  /* YES, ROUND UP         @YM30739*/ 01570000
         LA    ROUND,1                                             0671 01571000
*                       ELSE        /* OTHERWISE             @YM30739*/ 01572000
*                         ROUND=0;  /* DO NOT ROUND          @YM30739*/ 01573000
         B     @RC00670                                            0672 01574000
@RF00670 SLR   ROUND,ROUND                                         0672 01575000
*                       PQTY=(PQTY/TRKCYL)+ROUND;/* SET PRIMARY    0673 01576000
*                                                            @ZM30745*/ 01577000
@RC00670 LA    @14,19                                              0673 01578000
         L     @03,PQTY-1                                          0673 01579000
         LA    @03,0(,@03)                                         0673 01580000
         SLR   @02,@02                                             0673 01581000
         DR    @02,@14                                             0673 01582000
         ALR   @03,ROUND                                           0673 01583000
         STCM  @03,7,PQTY                                          0673 01584000
*                       IF SQTY//TRKCYL>0 THEN/* MULTIPLE OF 19?   0674 01585000
*                                                            @ZM30745*/ 01586000
         L     @02,SQTY-1                                          0674 01587000
         LA    @02,0(,@02)                                         0674 01588000
         SRDA  @02,32                                              0674 01589000
         DR    @02,@14                                             0674 01590000
         LTR   @02,@02                                             0674 01591000
         BNP   @RF00674                                            0674 01592000
*                         ROUND=1;  /* YES, ROUND UP         @YM30739*/ 01593000
         LA    ROUND,1                                             0675 01594000
*                       ELSE        /* OTHERWISE             @YM30739*/ 01595000
*                         ROUND=0;  /* DO NOT ROUND          @YM30739*/ 01596000
         B     @RC00674                                            0676 01597000
@RF00674 SLR   ROUND,ROUND                                         0676 01598000
*                       SQTY=(SQTY/TRKCYL)+ROUND;/* SET SECONDARY  0677 01599000
*                                                            @ZM30745*/ 01600000
@RC00674 L     @03,SQTY-1                                          0677 01601000
         LA    @03,0(,@03)                                         0677 01602000
         SLR   @02,@02                                             0677 01603000
         D     @02,@CF00148                                        0677 01604000
         ALR   @03,ROUND                                           0677 01605000
         STCM  @03,7,SQTY                                          0677 01606000
*                     END;          /*                       @ZM30745*/ 01607000
*                 END;              /*                       @YM30739*/ 01608000
*             END;                                                 0680 01609000
*           ELSE                    /* OTHERWISE             @Y30LB11*/ 01610000
*             IF JFCBNVOL^=Z1&      /* NVOL NOT ZERO         @ZA14749*/ 01611000
*                 JFCBSPAC=JSPACE THEN/* SPACE NOT SPECIFIED @ZA14749*/ 01612000
         B     @RC00632                                            0681 01613000
@RF00632 L     @14,JFCBPTR                                         0681 01614000
         CLC   JFCBNVOL(1,@14),Z1                                  0681 01615000
         BE    @RF00681                                            0681 01616000
         TM    JFCBSPAC(@14),B'11000000'                           0681 01617000
         BNZ   @RF00681                                            0681 01618000
*               DO;                 /*                       @Y30LB11*/ 01619000
*                 PQTY=GROPSPD;     /* SET PRIMARY QTY       @ZA31053*/ 01620000
         L     @14,GROUPPTR(,RPLVPTR)                              0683 01621000
         LH    @08,GROPSPD(,@14)                                   0683 01622000
         STCM  @08,7,PQTY                                          0683 01623000
*                 SQTY=GROSSPD;     /* SET SECONDARY QTY     @ZA31053*/ 01624000
         LH    @14,GROSSPD(,@14)                                   0684 01625000
         STCM  @14,7,SQTY                                          0684 01626000
*               END;                /*                       @Y30LB11*/ 01627000
*             ELSE                  /*                       @YM30739*/ 01628000
*               DO;                 /* ERROR CONDITION       @YM30739*/ 01629000
         B     @RC00681                                            0686 01630000
@RF00681 DS    0H                                                  0687 01631000
*                 SAVRCODE=R22C;    /* NOT PROPER SPACE      @Y30LB11*/ 01632000
         MVC   SAVRCODE(2),@CB00178                                0687 01633000
*                 SAVRETC=FOUR;     /* SET RETURN CODE       @Y30LB11*/ 01634000
         MVC   SAVRETC(2),@CB00103                                 0688 01635000
*                 RETURN CODE(4);   /* RETURN                @Y30LB11*/ 01636000
         LA    @15,4                                               0689 01637000
         L     @14,@SA00004                                        0689 01638000
         LM    @00,@08,@SA00004+8                                  0689 01639000
         LM    @10,@12,@SA00004+44                                 0689 01640000
         BR    @14                                                 0689 01641000
*               END;                /*                       @Y30LB11*/ 01642000
*     END;                          /*                       @Y30LB11*/ 01643000
@RC00681 DS    0H                                                  0691 01644000
@RC00632 DS    0H                                                  0691 01645000
@RC00621 DS    0H                                                  0691 01646000
@RC00616 DS    0H                                                  0692 01647000
*   CALL CALSPACE;                  /* CALCULATE SPACE/CYLS  @Y30LB11*/ 01648000
@RC00597 BAL   @14,CALSPACE                                        0692 01649000
*   IF JFCBYFX=0&                   /* YEAR 0?               @Y30LB11*/ 01650000
*       JFCBDFX=0 THEN              /* DAY 0?                @Y30LB11*/ 01651000
         CLI   JFCBYFX,0                                           0693 01652000
         BNE   @RF00693                                            0693 01653000
         LH    @14,JFCBDFX                                         0693 01654000
         LTR   @14,@14                                             0693 01655000
         BNZ   @RF00693                                            0693 01656000
*     EXPDT=DLMTD;                  /* YES, USE TODAYS DATE  @Y30LB11*/ 01657000
         MVC   EXPDT(4),DLMTD                                      0694 01658000
*   ELSE                            /* OTHERWISE             @Y30LB11*/ 01659000
*     DO;                           /* USE JFCBS             @Y30LB11*/ 01660000
         B     @RC00693                                            0695 01661000
@RF00693 DS    0H                                                  0696 01662000
*       CVD(JFCBYFX,GX1PDT);        /* SET YEAR              @Y30LB11*/ 01663000
         SLR   @14,@14                                             0696 01664000
         IC    @14,JFCBYFX                                         0696 01665000
         CVD   @14,@TS00001                                        0696 01666000
         MVC   GX1PDT(2),@TS00001+6                                0696 01667000
*       GENERATE REFS(GX1PDT);                                     0697 01668000
*                                   /*                       @Y30LB11*/ 01669000
         LH    15,GX1PDT               LOAD YEAR             @Y30LB11   01670000
         SRL   15,4(0)                 SHIFT SIGN            @Y30LB11   01671000
         STH   15,GX1PDT               RESTORE YEAR          @Y30LB11   01672000
*       CVD(JFCBDFX,GX2PDT);        /* SET DAY               @Y30LB11*/ 01673000
         LH    @14,JFCBDFX                                         0698 01674000
         CVD   @14,@TS00001                                        0698 01675000
         MVC   GX2PDT(2),@TS00001+6                                0698 01676000
*       EXPDT=GXPDT;                /* SET EXPDT             @Y30LB11*/ 01677000
         MVC   EXPDT(4),GXPDT                                      0699 01678000
*     END;                          /*                       @Y30LB11*/ 01679000
*   RETURN CODE(0);                 /* OK RETURN CODE        @Y30LB11*/ 01680000
@RC00693 SLR   @15,@15                                             0701 01681000
         L     @14,@SA00004                                        0701 01682000
         LM    @00,@08,@SA00004+8                                  0701 01683000
         LM    @10,@12,@SA00004+44                                 0701 01684000
         BR    @14                                                 0701 01685000
*   END FINDGRP;                    /*                       @Y30LB11*/ 01686000
*                                                                  0703 01687000
*/*  START OF SPECIFICATIONS ****                            @Y30LB11   01688000
*                                                                  0703 01689000
*01*  NAME = CALSPACE                                        @Y30LB11   01690000
*                                                                  0703 01691000
*01*  FUNCTION = THIS SUBROUTINE IS CALLED TO CALCULATE THE        0703 01692000
*                SPACE REQUESTED IN CYLINDERS.  CARE IS TAKEN      0703 01693000
*                TO USE THE BEST OF THREE ALGORITHMS DEPENDING UPON     01694000
*                THE DATA SET JFCB PARAMETERS.               @Y30LB11   01695000
*                                                                  0703 01696000
*02*    INPUT = JFCB PARAMETERS                              @Y30LB11   01697000
*                                                                  0703 01698000
*02*    OUTPUT = SPACE CONVERSION IN CYLINDERS               @Y30LB11   01699000
*                                                                  0703 01700000
**** END OF SPECIFICATIONS **                                        */ 01701000
*                                                                  0703 01702000
*CALSPACE:                          /* CALSPACE ROUTINE      @Y30LB11*/ 01703000
*   PROCEDURE;                      /*                       @Y30LB11*/ 01704000
CALSPACE STM   @14,@12,12(@13)                                     0703 01705000
*   FRSP=0;                         /* INITIALIZE FREE SPACE @Y30LB11*/ 01706000
         SLR   @14,@14                                             0704 01707000
         STH   @14,FRSP                                            0704 01708000
*   IF ALGOBIT=OFF&                 /* ALGORITHM 1?          @Y30LB11*/ 01709000
*       ALGOSW=OFF THEN             /* 1ST ALGORITHM REQUEST @Y30LB11*/ 01710000
         L     @14,JFCBPTR                                         0705 01711000
         TM    ALGOBIT(@14),B'10000000'                            0705 01712000
         BNZ   @RF00705                                            0705 01713000
         TM    ALGOSW,B'10000000'                                  0705 01714000
         BNZ   @RF00705                                            0705 01715000
*     DO;                           /* YES                   @Y30LB11*/ 01716000
*       IF MDVSVRQ=OFF THEN         /* PRIMARY VOL REQUEST?  @Y30LB11*/ 01717000
         TM    MDVSVRQ+132(RPLVPTR),B'00100000'                    0707 01718000
         BNZ   @RF00707                                            0707 01719000
*         DO;                       /* SET SPACE RQMTS       @Y30LB11*/ 01720000
*           LEXT=PQTY;              /* CONTIG SPACE          @Y30LB11*/ 01721000
         L     @14,PQTY-1                                          0709 01722000
         LA    @14,0(,@14)                                         0709 01723000
         STCM  @14,7,LEXT                                          0709 01724000
*           FRSP=PQTY+15*SQTY;      /* CYLS REQUESTED        @Y30LB11*/ 01725000
         L     @04,SQTY-1                                          0710 01726000
         LA    @04,0(,@04)                                         0710 01727000
         MH    @04,@CH00085                                        0710 01728000
         ALR   @14,@04                                             0710 01729000
         STH   @14,FRSP                                            0710 01730000
*         END;                      /*                       @Y30LB11*/ 01731000
*       ELSE                        /* OTHERWISE             @Y30LB11*/ 01732000
*         DO;                       /* SET SECDY SPACE RQMTS @Y30LB11*/ 01733000
         B     @RC00707                                            0712 01734000
@RF00707 DS    0H                                                  0713 01735000
*           LEXT=SQTY;              /* CONTIG SPACE          @Y30LB11*/ 01736000
         L     @14,SQTY-1                                          0713 01737000
         LA    @14,0(,@14)                                         0713 01738000
         STCM  @14,7,LEXT                                          0713 01739000
*           FRSP=16*SQTY;           /* CYLS REQUESTED        @Y30LB11*/ 01740000
         SLA   @14,4                                               0714 01741000
         STH   @14,FRSP                                            0714 01742000
*         END;                      /*                       @Y30LB11*/ 01743000
*     END;                          /*                       @Y30LB11*/ 01744000
@RC00707 DS    0H                                                  0717 01745000
*   IF FRSP>MAX|ALGOSW=ON THEN      /* FREE SPACE>403 CYLS?  @Y30LB11*/ 01746000
@RF00705 LH    @14,FRSP                                            0717 01747000
         C     @14,@CF00098                                        0717 01748000
         BH    @RT00717                                            0717 01749000
         TM    ALGOSW,B'10000000'                                  0717 01750000
         BNO   @RF00717                                            0717 01751000
@RT00717 DS    0H                                                  0718 01752000
*     DO;                           /* YES                   @Y30LB11*/ 01753000
*       ALGOBIT=ON;                 /* SET 2ND ALGORITHM     @Y30LB11*/ 01754000
         L     @14,JFCBPTR                                         0719 01755000
         OI    ALGOBIT(@14),B'10000000'                            0719 01756000
*       IF JFCONTIG=ON|             /* CONTIGUOUS?           @Y30LB11*/ 01757000
*           JFCMIXG=ON|             /* MIXG REQUEST?         @Y30LB11*/ 01758000
*           JFCALX=ON THEN          /* ALX REQUEST?          @Y30LB11*/ 01759000
         TM    JFCONTIG(@14),B'00001110'                           0720 01760000
         BZ    @RF00720                                            0720 01761000
*         DO;                       /* YES                   @Y30LB11*/ 01762000
*           IF MDVSVRQ=OFF THEN     /* PRIMARY VOL REQUEST?  @Y30LB11*/ 01763000
         TM    MDVSVRQ+132(RPLVPTR),B'00100000'                    0722 01764000
         BNZ   @RF00722                                            0722 01765000
*             DO;                   /* SET SPACE RQMTS       @Y30LB11*/ 01766000
*               LEXT=PQTY;          /* CONTIG SPACE          @Y30LB11*/ 01767000
         L     @14,PQTY-1                                          0724 01768000
         LA    @14,0(,@14)                                         0724 01769000
         STCM  @14,7,LEXT                                          0724 01770000
*               FRSP=PQTY;          /* CYLS REQUESTED        @Y30LB11*/ 01771000
         STH   @14,FRSP                                            0725 01772000
*             END;                  /*                       @Y30LB11*/ 01773000
*           ELSE                    /* OTHERWISE             @Y30LB11*/ 01774000
*             DO;                   /* SET SECDY SPACE RQMTS @Y30LB11*/ 01775000
         B     @RC00722                                            0727 01776000
@RF00722 DS    0H                                                  0728 01777000
*               LEXT=SQTY;          /* CONTIG SPACE          @Y30LB11*/ 01778000
         L     @14,SQTY-1                                          0728 01779000
         LA    @14,0(,@14)                                         0728 01780000
         STCM  @14,7,LEXT                                          0728 01781000
*               FRSP=SQTY;          /* CYLS REQUESTED        @Y30LB11*/ 01782000
         STH   @14,FRSP                                            0729 01783000
*             END;                  /*                       @Y30LB11*/ 01784000
*         END;                      /*                       @Y30LB11*/ 01785000
*       ELSE                        /* OTHERWISE             @Y30LB11*/ 01786000
*         DO;                       /* YES                   @Y30LB11*/ 01787000
         B     @RC00720                                            0732 01788000
@RF00720 DS    0H                                                  0733 01789000
*           IF MDVSVRQ=OFF THEN     /* PRIMARY VOL REQUEST?  @Y30LB11*/ 01790000
         TM    MDVSVRQ+132(RPLVPTR),B'00100000'                    0733 01791000
         BNZ   @RF00733                                            0733 01792000
*             FRSP=PQTY;            /* CYLS REQUESTED        @Y30LB11*/ 01793000
         L     @14,PQTY-1                                          0734 01794000
         LA    @14,0(,@14)                                         0734 01795000
         STH   @14,FRSP                                            0734 01796000
*           ELSE                    /* OTHERWISE             @Y30LB11*/ 01797000
*             FRSP=SQTY;            /* CYLS REQUESTED        @Y30LB11*/ 01798000
         B     @RC00733                                            0735 01799000
@RF00733 L     @14,SQTY-1                                          0735 01800000
         LA    @14,0(,@14)                                         0735 01801000
         STH   @14,FRSP                                            0735 01802000
*           LEXT=(FRSP+4)/5;        /* SET CONTIG SPACE      @ZA31053*/ 01803000
@RC00733 LA    @02,4                                               0736 01804000
         AH    @02,FRSP                                            0736 01805000
         SRDA  @02,32                                              0736 01806000
         D     @02,@CF00089                                        0736 01807000
         STCM  @03,7,LEXT                                          0736 01808000
*         END;                      /*                       @Y30LB11*/ 01809000
*     END;                          /*                       @Y30LB11*/ 01810000
*   END CALSPACE;                   /*                       @Y30LB11*/ 01811000
@EL00005 DS    0H                                                  0739 01812000
@EF00005 DS    0H                                                  0739 01813000
@ER00005 LM    @14,@12,12(@13)                                     0739 01814000
         BR    @14                                                 0739 01815000
*                                                                  0740 01816000
*/*  START OF SPECIFICATIONS ****                            @Y30LB11   01817000
*                                                                  0740 01818000
*01*  NAME = BASUPDTE                                        @Y30LB11   01819000
*                                                                  0740 01820000
*01*  FUNCTION = THIS SUBROUTINE IS CALLED WHENEVER A VOLUME       0740 01821000
*                IS TO BE SELECTED AS A CANDIDATE FOR MOUNT        0740 01822000
*                NON-SPECIFIC.  IF IT CANNOT BE SELECTED THE       0740 01823000
*                GVSNE RECORD MUST BE RESTORED.              @Y30LB11   01824000
*                                                                  0740 01825000
*02*    INPUT = UPDATE PARAMETERS                            @Y30LB11   01826000
*                                                                  0740 01827000
*02*    OUTPUT = UPDATED BASEV                               @Y30LB11   01828000
*                                                                  0740 01829000
**** END OF SPECIFICATIONS **                                        */ 01830000
*                                                                  0740 01831000
*BASUPDTE:                          /* BASEV UPDATE ROUTINE  @Y30LB11*/ 01832000
*   PROCEDURE;                      /*                       @Y30LB11*/ 01833000
BASUPDTE STM   @14,@12,@SA00006                                    0740 01834000
*   RPLVKEY=ADDR(ARGV);             /* ADDR OF VOLUME KEY    @Y30LB11*/ 01835000
         LA    @14,ARGV                                            0741 01836000
         ST    @14,RPLVKEY(,RPLVPTR)                               0741 01837000
*   RPLVTYP=RPLVREAD;               /* SET VIO READ SW ON    @Y30LB11*/ 01838000
         MVI   RPLVTYP(RPLVPTR),X'00'                              0742 01839000
*   MSGRQ=''B;                      /* ZERO MSG PARMLIST     @Y30LB11*/ 01840000
         XC    MSGRQ(32),MSGRQ                                     0743 01841000
*   MSGRPLV=RPLVPTR;                /* RESET RPLV PTR        @Y30LB11*/ 01842000
         ST    RPLVPTR,MSGRPLV                                     0744 01843000
*   MSGTEXT1=ADDR(ARGVOL);          /* INSERT TEXT           @Y30LB11*/ 01844000
         LA    @14,ARGVOL                                          0745 01845000
         STCM  @14,7,MSGTEXT1                                      0745 01846000
*   MSGLEN1=SIX;                    /* INSERT LENGTH         @Y30LB11*/ 01847000
         MVI   MSGLEN1,X'06'                                       0746 01848000
*   MSGID=M402;                     /* BASEV NOT FND         @Y30LB11*/ 01849000
         MVC   MSGID(4),@CF00150                                   0747 01850000
*   CALL COMONRTN;                  /* GET RECORD            @Y30LB11*/ 01851000
         BAL   @14,COMONRTN                                        0748 01852000
*   IF RETCOD^=0 THEN               /* RECORD HANDLED?       @Y30LB11*/ 01853000
         LTR   RETCOD,RETCOD                                       0749 01854000
         BZ    @RF00749                                            0749 01855000
*     RETURN CODE(4);               /* NO                    @Y30LB11*/ 01856000
         LA    @15,4                                               0750 01857000
         L     @14,@SA00006                                        0750 01858000
         LM    @00,@12,@SA00006+8                                  0750 01859000
         BR    @14                                                 0750 01860000
*   MDVOL=BASSERNO;                 /* SET VOLID IN LIST     @Y30LB11*/ 01861000
@RF00749 L     @14,BASEVPTR(,RPLVPTR)                              0751 01862000
         MVC   MDVOL+132(6,RPLVPTR),BASSERNO(@14)                  0751 01863000
*   GXPDTOLD=BASEXPDT;              /* REMBER CURRENT DATE   @ZA17172*/ 01864000
         MVC   GXPDTOLD(4),BASEXPDT(@14)                           0752 01865000
*   IF BASRCVYF=Z4 THEN             /* BASE RECORD OK?       @Y30LB11*/ 01866000
         CLC   BASRCVYF(4,@14),Z4                                  0753 01867000
         BNE   @RF00753                                            0753 01868000
*     DO;                           /* YES                   @Y30LB11*/ 01869000
*       BASDLMTD=DLMTD;             /* UPDATE DATE           @Y30LB11*/ 01870000
         MVC   BASDLMTD(4,@14),DLMTD                               0755 01871000
*       BASXPDT2=BASEXPDT;          /* ZERO OUT OLD EXP DTE  @ZA17172*/ 01872000
         L     @04,BASEXPDT(,@14)                                  0756 01873000
         ST    @04,BASXPDT2                                        0756 01874000
*       IF BASEXPDT=FOX&            /* SET ONLY IF ZERO AND  @VS32879*/ 01875000
*           SAVGRETN=ON THEN        /* GP RETEN SPECIFIED    @Y30LB11*/ 01876000
         CLC   BASEXPDT(4,@14),FOX                                 0757 01877000
         BNE   @RF00757                                            0757 01878000
         TM    SAVGRETN,B'10000000'                                0757 01879000
         BNO   @RF00757                                            0757 01880000
*         BASEXPDT=GXPDT;           /* UPDATE EXPIR DATE     @Y30LB11*/ 01881000
         MVC   BASEXPDT(4,@14),GXPDT                               0758 01882000
*       BASCPUID=BASCPUID|CPU;      /* UPDATE CPU ASSOC MASK @Y30LB11*/ 01883000
@RF00757 L     @14,BASEVPTR(,RPLVPTR)                              0759 01884000
         OC    BASCPUID(2,@14),CPU                                 0759 01885000
*       RPLVTYP=RPLVPUT;            /* SET VIO PUT SW ON     @Y30LB11*/ 01886000
         MVI   RPLVTYP(RPLVPTR),X'01'                              0760 01887000
*       CALL COMONRTN;              /* GET RECORD            @Y30LB11*/ 01888000
         BAL   @14,COMONRTN                                        0761 01889000
*       RETURN CODE(RETCOD);        /* RETURN RESULTS        @Y30LB11*/ 01890000
         L     @14,@SA00006                                        0762 01891000
         LM    @00,@12,@SA00006+8                                  0762 01892000
         BR    @14                                                 0762 01893000
*     END;                          /*                       @Y30LB11*/ 01894000
*   ARGGP=BASGROUP;                 /* SET GVSNE KEY         @Y30LB11*/ 01895000
@RF00753 L     @14,BASEVPTR(,RPLVPTR)                              0764 01896000
         MVC   ARGGP(8),BASGROUP(@14)                              0764 01897000
*   RSTRSW=ON;                      /* RESTORE GVSNE         @Y30LB11*/ 01898000
*   SCRTCHSW=OFF;                   /* ITERATE UNTIL FOUND   @Y30LB11*/ 01899000
         OI    RSTRSW,B'01000000'                                  0766 01900000
         NI    SCRTCHSW,B'11011111'                                0766 01901000
*   CALL GVSRECRD;                  /* GET RECORD            @Y30LB11*/ 01902000
         BAL   @14,GVSRECRD                                        0767 01903000
*   RPLVDIR=ON;                     /* READ DIRECT           @ZA17148*/ 01904000
*   RPLVNEXT=OFF;                   /* NOT READ NEXT         @ZA17148*/ 01905000
*   RPLVKGE=OFF;                    /* NOT READ KEY GT OR EQ @ZA17148*/ 01906000
         OI    RPLVDIR(RPLVPTR),B'01000000'                        0770 01907000
         NI    RPLVNEXT(RPLVPTR),B'11011011'                       0770 01908000
*   RPLVUPD=ON;                     /* READ FOR UPD          @ZA17148*/ 01909000
         OI    RPLVUPD(RPLVPTR),B'00000010'                        0771 01910000
*   RPLVTYP=RPLVREAD;               /*                       @ZA17148*/ 01911000
         MVI   RPLVTYP(RPLVPTR),X'00'                              0772 01912000
*   RPLVKEY=ADDR(GVSBUFR);          /* READ GVSNE            @ZA17148*/ 01913000
         LA    @14,GVSBUFR                                         0773 01914000
         ST    @14,RPLVKEY(,RPLVPTR)                               0773 01915000
*   MSGTEXT1=ADDR(ARGGP);           /* INSERT TEXT           @ZA17148*/ 01916000
         LA    @14,ARGGP                                           0774 01917000
         STCM  @14,7,MSGTEXT1                                      0774 01918000
*   MSGLEN1=EIGHT;                  /* INSERT LENGTH         @ZA17148*/ 01919000
         MVI   MSGLEN1,X'08'                                       0775 01920000
*   MSGID=M415;                     /* GVSNE NOT FOUND       @ZA17148*/ 01921000
         MVC   MSGID(4),@CF00160                                   0776 01922000
*   CALL COMONRTN;                  /* GET RECORD            @ZA17148*/ 01923000
         BAL   @14,COMONRTN                                        0777 01924000
*   RETURN CODE(4);                 /* BAD VOL CHOICE        @Y30LB11*/ 01925000
         LA    @15,4                                               0778 01926000
         L     @14,@SA00006                                        0778 01927000
         LM    @00,@12,@SA00006+8                                  0778 01928000
         BR    @14                                                 0778 01929000
*   END BASUPDTE;                   /*                       @Y30LB11*/ 01930000
*                                                                  0780 01931000
*/*  START OF SPECIFICATIONS ****                            @Y30LB11   01932000
*                                                                  0780 01933000
*01*  NAME = GVSRECRD                                        @Y30LB11   01934000
*                                                                  0780 01935000
*01*  FUNCTION = THIS ROUTINE IS CALLED TO PREPARE TO GET THE      0780 01936000
*                GROUP VOLUME SERIAL NUMBER EXTENSION RECORDS.     0780 01937000
*                                                            @Y30LB11   01938000
*                                                                  0780 01939000
*02*    INPUT = RPLV                                         @Y30LB11   01940000
*                                                                  0780 01941000
*02*    OUTPUT = GROUP VOLUME SERIAL EXTENSION RECORD        @Y30LB11   01942000
*                                                                  0780 01943000
**** END OF SPECIFICATIONS **                                        */ 01944000
*                                                                  0780 01945000
*GVSRECRD:                                                         0780 01946000
*   PROCEDURE;                      /*                       @Y30LB11*/ 01947000
GVSRECRD STM   @14,@12,@SA00007                                    0780 01948000
*   RPLVKEY=ADDR(ARGGR);            /* ADDRESS OF KEY        @Y30LB11*/ 01949000
         LA    @14,ARGGR                                           0781 01950000
         ST    @14,RPLVKEY(,RPLVPTR)                               0781 01951000
*   RPLVTYP=RPLVREAD;               /* VIO READ SW ON        @Y30LB11*/ 01952000
         MVI   RPLVTYP(RPLVPTR),X'00'                              0782 01953000
*   RPLVKGE=ON;                     /* READ KEY >= ON        @Y30LB11*/ 01954000
         OI    RPLVKGE(RPLVPTR),B'00000100'                        0783 01955000
*   MSGTEXT1=ADDR(ARGGP);           /* INSERT TEXT           @Y30LB11*/ 01956000
         LA    @14,ARGGP                                           0784 01957000
         STCM  @14,7,MSGTEXT1                                      0784 01958000
*   MSGLEN1=EIGHT;                  /* INSERT LENGTH         @Y30LB11*/ 01959000
         MVI   MSGLEN1,X'08'                                       0785 01960000
*   MSGID=M415;                     /* GVSNE NOT FOUND       @Y30LB11*/ 01961000
         MVC   MSGID(4),@CF00160                                   0786 01962000
*   CALL COMONRTN;                  /* GET GVSNE RECORD      @Y30LB11*/ 01963000
         BAL   @14,COMONRTN                                        0787 01964000
*   IF RETCOD^=0|                   /* RECORD NOT HANDLED?   @Y30LB11*/ 01965000
*       GVSGVSEX=OFF THEN           /* NOT EXTENSION RECORD? @Y30LB11*/ 01966000
         LTR   RETCOD,RETCOD                                       0788 01967000
         BNZ   @RT00788                                            0788 01968000
         L     @14,GVSNEPTR(,RPLVPTR)                              0788 01969000
         TM    GVSGVSEX(@14),B'01000000'                           0788 01970000
         BNZ   @RF00788                                            0788 01971000
@RT00788 DS    0H                                                  0789 01972000
*     DO;                           /* NO,BAD                @Y30LB11*/ 01973000
*       SAVGRPCD=R232;              /* SET REASON CODE       @Y30LB11*/ 01974000
         MVC   SAVGRPCD(2),@CB00188                                0790 01975000
*       RETURN CODE(4);             /* RETURN TO GVSCODE     @Y30LB11*/ 01976000
         LA    @15,4                                               0791 01977000
         L     @14,@SA00007                                        0791 01978000
         LM    @00,@12,@SA00007+8                                  0791 01979000
         BR    @14                                                 0791 01980000
*     END;                          /*                       @Y30LB11*/ 01981000
*   LAST=GVSESIND-1;                /* INITIALIZE LAST SLOT  @Y30LB11*/ 01982000
@RF00788 L     @14,GVSNEPTR(,RPLVPTR)                              0793 01983000
         LH    @14,GVSESIND(,@14)                                  0793 01984000
         BCTR  @14,0                                               0793 01985000
         STH   @14,LAST                                            0793 01986000
*   IF SCRTCHSW=OFF THEN            /* SPECIFIC RECORD READ? @Y30LB11*/ 01987000
         TM    SCRTCHSW,B'00100000'                                0794 01988000
         BNZ   @RF00794                                            0794 01989000
*     DO;                           /* YES                   @Y30LB11*/ 01990000
*       CALL GVSCODE;               /* READ RECORD(S)        @Y30LB11*/ 01991000
         BAL   @14,GVSCODE                                         0796 01992000
*       IF RETCOD^=0 THEN           /* RECORD READ?          @Y30LB11*/ 01993000
         LTR   RETCOD,RETCOD                                       0797 01994000
         BZ    @RF00797                                            0797 01995000
*         RETURN CODE(4);           /* GOOD RETURN CODE      @Y30LB11*/ 01996000
         LA    @15,4                                               0798 01997000
         L     @14,@SA00007                                        0798 01998000
         LM    @00,@12,@SA00007+8                                  0798 01999000
         BR    @14                                                 0798 02000000
*     END;                          /*                       @Y30LB11*/ 02001000
@RF00797 DS    0H                                                  0800 02002000
*   RETURN CODE(0);                 /* GOOD RETURN CODE      @Y30LB11*/ 02003000
@RF00794 SLR   @15,@15                                             0800 02004000
         L     @14,@SA00007                                        0800 02005000
         LM    @00,@12,@SA00007+8                                  0800 02006000
         BR    @14                                                 0800 02007000
*   END GVSRECRD;                   /* END GVSRECRD          @Y30LB11*/ 02008000
*                                                                  0802 02009000
*/*  START OF SPECIFICATIONS ****                            @Y30LB11   02010000
*                                                                  0802 02011000
*01*  NAME = GVSCODE                                         @Y30LB11   02012000
*                                                                  0802 02013000
*01*  FUNCTION = THIS SUBROUTINE IS CALLED TO LOOP THROUGH THE     0802 02014000
*                SLOTS IN THE GVSNE LOOKING FOR A MATCH ON THE     0802 02015000
*                VOLID IN ORDER TO UPDATE MOUNT STATUS.            0802 02016000
*                 IF THE APPROPRIATE SLOT IS NOT FOUND,            0802 02017000
*                RETURN IS MADE TO THE MAIN PROGRAM AND THEN TO    0802 02018000
*                THE USER.                                   @Y30LB11   02019000
*                                                                  0802 02020000
*02*    INPUT = RPLV                                         @Y30LB11   02021000
*                                                                  0802 02022000
*02*    OUTPUT = UPDATED GVSNE                               @Y30LB11   02023000
*                                                                  0802 02024000
**** END OF SPECIFICATIONS **                                        */ 02025000
*                                                                  0802 02026000
*GVSCODE:                                                          0802 02027000
*   PROCEDURE;                      /*                       @Y30LB11*/ 02028000
GVSCODE  STM   @14,@12,@SA00008                                    0802 02029000
*   DO WHILE I=I;                   /* LOOPING PROCEDURE     @Y30LB11*/ 02030000
         B     @DE00803                                            0803 02031000
@DL00803 DS    0H                                                  0804 02032000
*     DO I=1 TO LAST;               /* ITERATE THRU SLOTS    @Y30LB11*/ 02033000
         LA    @14,1                                               0804 02034000
         B     @DE00804                                            0804 02035000
@DL00804 DS    0H                                                  0805 02036000
*       IF MDVOL=GVSVOLID(I) THEN   /* MOUNT VOLID SLOT &    @Y30LB11*/ 02037000
         MH    @14,@CH00325                                        0805 02038000
         L     @04,GVSNEPTR(,RPLVPTR)                              0805 02039000
         ST    @14,@TF00001                                        0805 02040000
         ALR   @14,@04                                             0805 02041000
         CLC   MDVOL+132(6,RPLVPTR),GVSVOLID-20(@14)               0805 02042000
         BNE   @RF00805                                            0805 02043000
*         DO;                       /* YES                   @Y30LB11*/ 02044000
*           IF RSTRSW=OFF THEN      /* UPDATE RECORD?        @Y30LB11*/ 02045000
         TM    RSTRSW,B'01000000'                                  0807 02046000
         BNZ   @RF00807                                            0807 02047000
*             GVSCPUBM(I)=GVSCPUBM(I)|CPU;/* SET GVSNE CPUID @Y30LB11*/ 02048000
         AL    @04,@TF00001                                        0808 02049000
         OC    GVSCPUBM-20(2,@04),CPU                              0808 02050000
*           ELSE                    /* OTHERWISE             @Y30LB11*/ 02051000
*             DO;                   /*                       @ZA11665*/ 02052000
         B     @RC00807                                            0809 02053000
@RF00807 DS    0H                                                  0810 02054000
*               GVSCPUBM(I)=GVSCPUBM(I)&&CPU;/* RSTR CPUID   @Y30LB11*/ 02055000
         LH    @14,I                                               0810 02056000
         MH    @14,@CH00325                                        0810 02057000
         L     @04,GVSNEPTR(,RPLVPTR)                              0810 02058000
         ST    @14,@TF00001                                        0810 02059000
         ALR   @14,@04                                             0810 02060000
         XC    GVSCPUBM-20(2,@14),CPU                              0810 02061000
*               GVSEXPDT(I)=GXPDTOLD;/* REST GRP EXT EXPDT   @ZA11665*/ 02062000
         AL    @04,@TF00001                                        0811 02063000
         MVC   GVSEXPDT-20(4,@04),GXPDTOLD                         0811 02064000
*             END;                  /*                       @ZA11665*/ 02065000
*           CALL AMVGVSUD;          /* MORE GVSNE UPDATE     @G24LB04*/ 02066000
*                                                                  0813 02067000
@RC00807 BAL   @14,AMVGVSUD                                        0813 02068000
*           /*********************************************************/ 02069000
*           /*                                                       */ 02070000
*           /* NOTE RETURN CODE IS NOT CHECKED BECAUSE MSVC DOES NOT */ 02071000
*           /* FAIL MOUNT SPECIFIC, WHICH IS THE ONLY PATH THROUGH   */ 02072000
*           /* HERE FOR WHICH AMVGVSUD COULD RETURN A FAILURE CODE   */ 02073000
*           /*                                               @G24LB04*/ 02074000
*           /*                                                       */ 02075000
*           /*********************************************************/ 02076000
*                                                                  0814 02077000
*           RPLVTYP=RPLVPUT;        /* VIO PUT SW ON         @Y30LB11*/ 02078000
         MVI   RPLVTYP(RPLVPTR),X'01'                              0814 02079000
*           CALL COMONRTN;          /* PUT GVSNE RECORD      @Y30LB11*/ 02080000
         BAL   @14,COMONRTN                                        0815 02081000
*           IF RETCOD^=0 THEN       /* RECORD NOT HANDLED?   @Y30LB11*/ 02082000
         LTR   RETCOD,RETCOD                                       0816 02083000
         BZ    @RF00816                                            0816 02084000
*             DO;                   /* NO,BAD                @Y30LB11*/ 02085000
*               SAVGRPCD=R232;      /* SET REASON CODE       @Y30LB11*/ 02086000
         MVC   SAVGRPCD(2),@CB00188                                0818 02087000
*               RETURN CODE(4);     /* RETURN TO GVSCODE     @Y30LB11*/ 02088000
         LA    @15,4                                               0819 02089000
         L     @14,@SA00008                                        0819 02090000
         LM    @00,@12,@SA00008+8                                  0819 02091000
         BR    @14                                                 0819 02092000
*             END;                  /*                       @Y30LB11*/ 02093000
*           RETURN CODE(0);         /* GOOD RETURN CODE      @Y30LB11*/ 02094000
@RF00816 SLR   @15,@15                                             0821 02095000
         L     @14,@SA00008                                        0821 02096000
         LM    @00,@12,@SA00008+8                                  0821 02097000
         BR    @14                                                 0821 02098000
*         END;                      /* CHECK NEXT SLOT       @Y30LB11*/ 02099000
*     END;                          /*                       @Y30LB11*/ 02100000
@RF00805 LA    @14,1                                               0823 02101000
         AH    @14,I                                               0823 02102000
@DE00804 STH   @14,I                                               0823 02103000
         CH    @14,LAST                                            0823 02104000
         BNH   @DL00804                                            0823 02105000
*     IF GVSEX=ON THEN              /* ANOTHER RECORD EXIST? @Y30LB11*/ 02106000
         L     @14,GVSNEPTR(,RPLVPTR)                              0824 02107000
         TM    GVSEX(@14),B'10000000'                              0824 02108000
         BNO   @RF00824                                            0824 02109000
*       DO;                         /* READ NEXT RECORD      @Y30LB11*/ 02110000
*         RPLVDIR=OFF;              /* DIRECT OFF            @Y30LB11*/ 02111000
*         RPLVNEXT=ON;              /* READ NEXT             @Y30LB11*/ 02112000
         OI    RPLVNEXT(RPLVPTR),B'00100000'                       0827 02113000
         NI    RPLVDIR(RPLVPTR),B'10111111'                        0827 02114000
*         CALL COMONRTN;            /* GET GVSNE RECORD      @Y30LB11*/ 02115000
         BAL   @14,COMONRTN                                        0828 02116000
*         IF RETCOD^=0|             /* RECORD NOT HANDLED?   @Y30LB11*/ 02117000
*             GVSGVSEX=OFF THEN     /* NOT EXTENSION RECORD? @Y30LB11*/ 02118000
         LTR   RETCOD,RETCOD                                       0829 02119000
         BNZ   @RT00829                                            0829 02120000
         L     @14,GVSNEPTR(,RPLVPTR)                              0829 02121000
         TM    GVSGVSEX(@14),B'01000000'                           0829 02122000
         BNZ   @RF00829                                            0829 02123000
@RT00829 DS    0H                                                  0830 02124000
*           DO;                     /* NO,BAD                @Y30LB11*/ 02125000
*             SAVGRPCD=R232;        /* SET REASON CODE       @Y30LB11*/ 02126000
         MVC   SAVGRPCD(2),@CB00188                                0831 02127000
*             RETURN CODE(4);       /* RETURN TO GVSCODE     @Y30LB11*/ 02128000
         LA    @15,4                                               0832 02129000
         L     @14,@SA00008                                        0832 02130000
         LM    @00,@12,@SA00008+8                                  0832 02131000
         BR    @14                                                 0832 02132000
*           END;                    /*                       @Y30LB11*/ 02133000
*         LAST=GVSESIND-1;          /* INITIALIZE LAST SLOT  @Y30LB11*/ 02134000
@RF00829 L     @14,GVSNEPTR(,RPLVPTR)                              0834 02135000
         LH    @14,GVSESIND(,@14)                                  0834 02136000
         BCTR  @14,0                                               0834 02137000
         STH   @14,LAST                                            0834 02138000
*       END;                        /*                       @Y30LB11*/ 02139000
*     ELSE                          /* OTHERWISE             @Y30LB11*/ 02140000
*       RETURN CODE(4);             /* RETURN TO CALLER      @Y30LB11*/ 02141000
         B     @RC00824                                            0836 02142000
@RF00824 LA    @15,4                                               0836 02143000
         L     @14,@SA00008                                        0836 02144000
         LM    @00,@12,@SA00008+8                                  0836 02145000
         BR    @14                                                 0836 02146000
*   END;                            /*                       @Y30LB11*/ 02147000
@RC00824 DS    0H                                                  0837 02148000
@DE00803 LH    @14,I                                               0837 02149000
         CR    @14,@14                                             0837 02150000
         BE    @DL00803                                            0837 02151000
*   END GVSCODE;                    /* END                   @G24LB04*/ 02152000
@EL00008 DS    0H                                                  0838 02153000
@EF00008 DS    0H                                                  0838 02154000
@ER00008 LM    @14,@12,@SA00008                                    0838 02155000
         BR    @14                                                 0838 02156000
*                                                                  0839 02157000
*/*  START OF SPECIFICATIONS ****                            @Y30LB11   02158000
*                                                                  0839 02159000
*01*  NAME = JFCBCK                                          @Y30LB11   02160000
*                                                                  0839 02161000
*01*  FUNCTION = THIS SUBROUTINE IS CALLED TO DETERMINE WHETHER    0839 02162000
*                THE VOLUME SELECTED FROM THE GVSNE RECORD IS ALREADY   02163000
*                IN THE JFCB OR ITS EXTENTIONS.  IF IT IS A NEW VOLUME  02164000
*                MUST BE SELECTED.                           @Y30LB11   02165000
*                                                                  0839 02166000
*02*    INPUT = GVSNE RECORD                                 @Y30LB11   02167000
*                                                                  0839 02168000
*02*    OUTPUT = RETURN=0 - VOLID NOT FOUND                  @Y30LB11   02169000
*                RETURN=4 - VOLID FOUND                      @Y30LB11   02170000
*                                                                  0839 02171000
**** END OF SPECIFICATIONS **                                        */ 02172000
*                                                                  0839 02173000
*JFCBCK:                            /* JFCB CHECKING ROUTINE @Y30LB11*/ 02174000
*   PROCEDURE;                      /*                       @Y30LB11*/ 02175000
JFCBCK   STM   @14,@12,12(@13)                                     0839 02176000
*   IF NVOLINDX>0 THEN              /* ITERATE THROUGH JFCBN @Y30LB11*/ 02177000
         CLI   NVOLINDX,0                                          0840 02178000
         BNH   @RF00840                                            0840 02179000
*     DO;                           /*                       @Y30LB11*/ 02180000
*       DO J=1 TO 5;                /* INDEX THRU JFCB       @Y30LB11*/ 02181000
         LA    J,1                                                 0842 02182000
@DL00842 DS    0H                                                  0843 02183000
*         IF JFCAVOLS(J)=GVSVOLID(I) THEN/* VOLID FOUND?     @Y30LB11*/ 02184000
         LR    @14,J                                               0843 02185000
         MH    @14,@CH00091                                        0843 02186000
         LH    @07,I                                               0843 02187000
         MH    @07,@CH00325                                        0843 02188000
         L     @04,GVSNEPTR(,RPLVPTR)                              0843 02189000
         L     @09,JFCBPTR                                         0843 02190000
         ALR   @09,@14                                             0843 02191000
         ALR   @04,@07                                             0843 02192000
         CLC   JFCAVOLS-6(6,@09),GVSVOLID-20(@04)                  0843 02193000
         BNE   @RF00843                                            0843 02194000
*           RETURN CODE(4);         /* RETURN CODE           @Y30LB11*/ 02195000
         LA    @15,4                                               0844 02196000
         L     @14,12(,@13)                                        0844 02197000
         LM    @00,@12,20(@13)                                     0844 02198000
         BR    @14                                                 0844 02199000
*         ELSE                      /* OTHERWISE             @Y30LB11*/ 02200000
*           NVOLINDX=NVOLINDX-1;    /* REDUCE NVOLINDX       @Y30LB11*/ 02201000
@RF00843 SLR   @14,@14                                             0845 02202000
         IC    @14,NVOLINDX                                        0845 02203000
         BCTR  @14,0                                               0845 02204000
         STC   @14,NVOLINDX                                        0845 02205000
*       END;                        /*                       @Y30LB11*/ 02206000
         AL    J,@CF00112                                          0846 02207000
         C     J,@CF00089                                          0846 02208000
         BNH   @DL00842                                            0846 02209000
*     END;                          /*                       @Y30LB11*/ 02210000
*   JXPTRFX=JPTRFX+176;             /* INIT BASE             @Y30LB11*/ 02211000
@RF00840 LA    @14,176                                             0848 02212000
         AL    @14,JPTRFX                                          0848 02213000
         ST    @14,JXPTRFX                                         0848 02214000
*   DO WHILE NVOLINDX>0;            /* ITERATE THROUGH JFCB  @Y30LB11*/ 02215000
         B     @DE00849                                            0849 02216000
@DL00849 DS    0H                                                  0850 02217000
*     DO J=1 TO 15;                 /* INDEX THRU JFCB EXTS  @Y30LB11*/ 02218000
         LA    J,1                                                 0850 02219000
@DL00850 DS    0H                                                  0851 02220000
*       IF JFCBXVOL(J)=GVSVOLID(I) THEN/* VOLID FOUND?       @Y30LB11*/ 02221000
         LR    @14,J                                               0851 02222000
         MH    @14,@CH00091                                        0851 02223000
         LH    @07,I                                               0851 02224000
         MH    @07,@CH00325                                        0851 02225000
         L     @04,GVSNEPTR(,RPLVPTR)                              0851 02226000
         L     @09,JFCBXPTR                                        0851 02227000
         ALR   @09,@14                                             0851 02228000
         BCTR  @09,0                                               0851 02229000
         BCTR  @09,0                                               0851 02230000
         ALR   @04,@07                                             0851 02231000
         CLC   JFCBXVOL-4(6,@09),GVSVOLID-20(@04)                  0851 02232000
         BNE   @RF00851                                            0851 02233000
*         RETURN CODE(4);           /* RETURN CODE           @Y30LB11*/ 02234000
         LA    @15,4                                               0852 02235000
         L     @14,12(,@13)                                        0852 02236000
         LM    @00,@12,20(@13)                                     0852 02237000
         BR    @14                                                 0852 02238000
*       ELSE                        /* OTHERWISE             @Y30LB11*/ 02239000
*         NVOLINDX=NVOLINDX-1;      /* REDUCE NVOLINDX       @Y30LB11*/ 02240000
@RF00851 SLR   @14,@14                                             0853 02241000
         IC    @14,NVOLINDX                                        0853 02242000
         BCTR  @14,0                                               0853 02243000
         STC   @14,NVOLINDX                                        0853 02244000
*     END;                          /*                       @Y30LB11*/ 02245000
         AL    J,@CF00112                                          0854 02246000
         C     J,@CF00085                                          0854 02247000
         BNH   @DL00850                                            0854 02248000
*     JXPTRFX=JXPTRFX+LENGTH(JFCBX);/* NEXT EXT RECORD       @Y30LB11*/ 02249000
         LA    @14,176                                             0855 02250000
         AL    @14,JXPTRFX                                         0855 02251000
         ST    @14,JXPTRFX                                         0855 02252000
*   END;                            /*                       @Y30LB11*/ 02253000
@DE00849 CLI   NVOLINDX,0                                          0856 02254000
         BH    @DL00849                                            0856 02255000
*   RETURN CODE(0);                 /* VOLID NOT FOUND       @Y30LB11*/ 02256000
         SLR   @15,@15                                             0857 02257000
         L     @14,12(,@13)                                        0857 02258000
         LM    @00,@12,20(@13)                                     0857 02259000
         BR    @14                                                 0857 02260000
*   END JFCBCK;                     /*                       @Y30LB11*/ 02261000
*                                                                  0859 02262000
*/*  START OF SPECIFICATIONS ****                            @Y30LB11   02263000
*                                                                  0859 02264000
*01*  NAME = UCBCK                                           @Y30LB11   02265000
*                                                                  0859 02266000
*01*  FUNCTION = THIS SUBROUTINE IS CALLED TO DETERMINE WHETHER    0859 02267000
*                THE VOLUME SELECTED FROM THE GVSNE RECORD IS ALREADY   02268000
*                IN THE UCB LIST.  IF IT IS A NEW VOLUME MUST BE   0859 02269000
*                SELECTED.                                   @Y30LB11   02270000
*                                                                  0859 02271000
*02*    INPUT = GVSNE RECORD                                 @Y30LB11   02272000
*                                                                  0859 02273000
*02*    OUTPUT = RETURN=0 - VOLID NOT FOUND                  @Y30LB11   02274000
*                RETURN=4 - VOLID FOUND                      @Y30LB11   02275000
*                                                                  0859 02276000
**** END OF SPECIFICATIONS **                                        */ 02277000
*                                                                  0859 02278000
*   DCL                                                            0859 02279000
*     TENQVOL CHAR(6) BDY(WORD);    /*                       @ZA11687*/ 02280000
*   DCL                                                            0860 02281000
*     MAJRNAM CHAR(8) BDY(WORD) INIT('SYSZVOLS');/*          @ZA11687*/ 02282000
*UCBCK:                             /* UCB CK RTN (VS/2 ONLY)      0861 02283000
*                                                            @Y30LB11*/ 02284000
*   PROCEDURE;                      /*                       @Y30LB11*/ 02285000
UCBCK    STM   @14,@12,@SA00010                                    0861 02286000
*   UCBPR1=VVIUCB;                  /* INITIALIZE UCBPR1 PTR @Y30LB11*/ 02287000
         L     @14,VVIUCB(,VVIPTR)                                 0862 02288000
         LR    UCBPR1,@14                                          0862 02289000
*   IF VVIUCB=0 THEN                /* NO UCB LIST           @Y30LB11*/ 02290000
         SLR   @09,@09                                             0863 02291000
         CR    @14,@09                                             0863 02292000
         BNE   @RF00863                                            0863 02293000
*     RETURN CODE(0);               /* RETURN W/0 TESTING    @Y30LB11*/ 02294000
         LR    @15,@09                                             0864 02295000
         L     @14,@SA00010                                        0864 02296000
         LM    @00,@12,@SA00010+8                                  0864 02297000
         BR    @14                                                 0864 02298000
*   DO WHILE UCBPR2>FOXES;          /* END OF TABLE?         @Y30LB11*/ 02299000
@RF00863 B     @DE00865                                            0865 02300000
@DL00865 DS    0H                                                  0866 02301000
*     IF UCBVOLI=GVSVOLID(I) THEN   /* VOLID FOUND?          @Y30LB11*/ 02302000
         L     @14,UCBPTR(,UCBPR1)                                 0866 02303000
         LH    @09,I                                               0866 02304000
         MH    @09,@CH00325                                        0866 02305000
         L     @07,GVSNEPTR(,RPLVPTR)                              0866 02306000
         ALR   @07,@09                                             0866 02307000
         CLC   UCBVOLI(6,@14),GVSVOLID-20(@07)                     0866 02308000
         BNE   @RF00866                                            0866 02309000
*       RETURN CODE(4);             /* BAD RETURN CODE       @Y30LB11*/ 02310000
         LA    @15,4                                               0867 02311000
         L     @14,@SA00010                                        0867 02312000
         LM    @00,@12,@SA00010+8                                  0867 02313000
         BR    @14                                                 0867 02314000
*     ELSE                          /* OTHERWISE             @Y30LB11*/ 02315000
*       UCBPR1=UCBPR1+4;            /* GET NEXT VIRTUAL UCB  @Y30LB11*/ 02316000
@RF00866 AL    UCBPR1,@CF00087                                     0868 02317000
*   END;                            /*                       @Y30LB11*/ 02318000
@DE00865 L     @14,UCBPR2(,UCBPR1)                                 0869 02319000
         LTR   @14,@14                                             0869 02320000
         BNM   @DL00865                                            0869 02321000
*   TENQVOL=GVSVOLID(I);            /*                       @ZA11687*/ 02322000
         LH    @14,I                                               0870 02323000
         MH    @14,@CH00325                                        0870 02324000
         L     @09,GVSNEPTR(,RPLVPTR)                              0870 02325000
         ALR   @09,@14                                             0870 02326000
         MVC   TENQVOL(6),GVSVOLID-20(@09)                         0870 02327000
*   GEN REFS(MAJRNAM,TENQVOL);                                     0871 02328000
*                                   /*                       @ZA11687*/ 02329000
LENQ1    ENQ  (MAJRNAM,TENQVOL,E,6,SYSTEM),RET=TEST                     02330000
*   IF RETCOD^=0 THEN                                              0872 02331000
         LTR   RETCOD,RETCOD                                       0872 02332000
         BZ    @RF00872                                            0872 02333000
*     RETURN CODE(4);               /*                       @ZA11687*/ 02334000
         LA    @15,4                                               0873 02335000
         L     @14,@SA00010                                        0873 02336000
         LM    @00,@12,@SA00010+8                                  0873 02337000
         BR    @14                                                 0873 02338000
*   RETURN CODE(0);                 /* VOL NOT FOUND         @Y30LB11*/ 02339000
@RF00872 SLR   @15,@15                                             0874 02340000
         L     @14,@SA00010                                        0874 02341000
         LM    @00,@12,@SA00010+8                                  0874 02342000
         BR    @14                                                 0874 02343000
*   END UCBCK;                      /*                       @Y30LB11*/ 02344000
*                                                                  0876 02345000
*/*  START OF SPECIFICATIONS ****                            @Y30LB11   02346000
*                                                                  0876 02347000
*01*  NAME = COMONRTN                                        @Y30LB11   02348000
*                                                                  0876 02349000
*01*  FUNCTION = THIS SUBROUTINE IS CALLED A RECORD NEEDS TO BE    0876 02350000
*                RETRIEVED OR PUT OUT.  THE ORIGINAL CALLING       0876 02351000
*                SUBROUTINE MUST SET UP THE CALL FOR VSAM.   @Y30LB11   02352000
*                                                                  0876 02353000
*02*    INPUT = VSAM PARAMETERS                              @Y30LB11   02354000
*                                                                  0876 02355000
*02*    OUTPUT = DESIRED RECORD IN LOCATE OR MOVE MOVE       @Y30LB11   02356000
*                                                                  0876 02357000
**** END OF SPECIFICATIONS **                                        */ 02358000
*                                                                  0876 02359000
*COMONRTN:                          /* COMONRTN ROUTINE      @Y30LB11*/ 02360000
*   PROCEDURE;                      /*                       @Y30LB11*/ 02361000
COMONRTN STM   @14,@12,@SA00011                                    0876 02362000
*   RPLVBUF=ADDR(GVSBUFR);          /* INITIALIZE GVSNE PTR  @Y30LB11*/ 02363000
         LA    @14,GVSBUFR                                         0877 02364000
         ST    @14,RPLVBUF(,RPLVPTR)                               0877 02365000
*   RPLVBLN=LENGTH(GVSBUFR);        /* BUFFER LENGTH         @Y30LB11*/ 02366000
         MVC   RPLVBLN(4,RPLVPTR),@CF00331                         0878 02367000
*   REG1=RPLVPTR;                   /* REG1 PARAMETER        @Y30LB11*/ 02368000
         LR    REG1,RPLVPTR                                        0879 02369000
*   CALL ICBVIO00;                  /* GET RECORD            @Y30LB11*/ 02370000
         L     @15,@CV00249                                        0880 02371000
         BALR  @14,@15                                             0880 02372000
*   IF RPLVRETC^=Z2 THEN            /* RECORD HANDLED?       @Y30LB11*/ 02373000
         CLC   RPLVRETC(2,RPLVPTR),Z2                              0881 02374000
         BE    @RF00881                                            0881 02375000
*     DO;                           /* NO                    @Y30LB11*/ 02376000
*       IF RPLVTYP=RPLVREAD THEN    /* RECORD FOUND?         @Y30LB11*/ 02377000
         CLI   RPLVTYP(RPLVPTR),0                                  0883 02378000
         BNE   @RF00883                                            0883 02379000
*         DO;                       /* NO                    @Y30LB11*/ 02380000
*           SAVRETC=RPLVRETC;       /* SAVE RETURN CODE      @Y30LB11*/ 02381000
         MVC   SAVRETC(2),RPLVRETC(RPLVPTR)                        0885 02382000
*           SAVRCODE=RPLRCODE;      /* SAVE REASON CODE      @Y30LB11*/ 02383000
         MVC   SAVRCODE(2),RPLRCODE(RPLVPTR)                       0886 02384000
*           MSGRPLV=RPLVPTR;        /* MSVC RPLV ADDR        @Y30LB11*/ 02385000
         ST    RPLVPTR,MSGRPLV                                     0887 02386000
*           REG1=ADDR(MSGRQ);       /* REG1 PARM             @Y30LB11*/ 02387000
         LA    REG1,MSGRQ                                          0888 02388000
*           CALL ICBVOP00;          /* OPER/LIB ROUTINE      @Y30LB11*/ 02389000
         L     @15,@CV00250                                        0889 02390000
         BALR  @14,@15                                             0889 02391000
*           RPLVRETC=SAVRETC;       /* RESET RETURN CODE     @Y30LB11*/ 02392000
         MVC   RPLVRETC(2,RPLVPTR),SAVRETC                         0890 02393000
*           RPLRCODE=SAVRCODE;      /* RESET REASON CODE     @Y30LB11*/ 02394000
         MVC   RPLRCODE(2,RPLVPTR),SAVRCODE                        0891 02395000
*         END;                      /*                       @Y30LB11*/ 02396000
*     END;                          /*                       @Y30LB11*/ 02397000
@RF00883 DS    0H                                                  0894 02398000
*   RETURN CODE(RPLVRETC);          /* RETURN TO CALLER      @Y30LB11*/ 02399000
@RF00881 LH    @15,RPLVRETC(,RPLVPTR)                              0894 02400000
         N     @15,@CF02120                                        0894 02401000
         L     @14,@SA00011                                        0894 02402000
         LM    @00,@12,@SA00011+8                                  0894 02403000
         BR    @14                                                 0894 02404000
*   END COMONRTN;                   /*                       @Y30LB11*/ 02405000
*                                                                  0896 02406000
*   /*****************************************************************/ 02407000
*   /*                                                               */ 02408000
*   /* NAME - JOURNAL                                        @ZA11665*/ 02409000
*   /*                                                       @ZA11665*/ 02410000
*   /* FUNCTION - THIS ROUTINE JOURNALS THE RPLV AND         @ZA11665*/ 02411000
*   /* IS CALLED AFTER THE FIRST SUCCESSFUL UPDATE           @ZA11015*/ 02412000
*   /* OF THE INVENTORY DATA SET.                            @ZA11665*/ 02413000
*   /*                                                       @ZA11665*/ 02414000
*   /* INPUT - MDVOL, GXPDT                                  @ZA11665*/ 02415000
*   /*                                                       @ZA11665*/ 02416000
*   /* OUTPUT - DUMMY RPLV FOR MVR                           @ZA11665*/ 02417000
*   /*                                                               */ 02418000
*   /*****************************************************************/ 02419000
*                                                                  0896 02420000
*JOURNAL:                                                          0896 02421000
*   PROC;                           /*                       @ZA11015*/ 02422000
*                                                                  0896 02423000
JOURNAL  STM   @14,@04,@SA00012                                    0896 02424000
         STM   @06,@12,@SA00012+28                                 0896 02425000
*   /*****************************************************************/ 02426000
*   /*                                                               */ 02427000
*   /* THIS PART OF PROCEDURE WILL SET UP THE RPLV.          @ZA11665*/ 02428000
*   /*                                                               */ 02429000
*   /*****************************************************************/ 02430000
*                                                                  0897 02431000
*   DRPLV=DRPLV&&DRPLV;             /* ZERO OUT RPLV         @ZA11015*/ 02432000
         XC    DRPLV(220),DRPLV                                    0897 02433000
*   SAVEPTR=RPLVPTR;                /* SAVE PRLVPTR          @ZA11665*/ 02434000
         LR    SAVEPTR,RPLVPTR                                     0898 02435000
*   RPLVPTR=ADDR(DRPLV);            /* ADDR DUMMY RPLV       @ZA11665*/ 02436000
         LA    RPLVPTR,DRPLV                                       0899 02437000
*   RPLVTLEN=LENGTH(RPLV)+LENGTH(MVR);/* RPLV LENGTH         @ZA11665*/ 02438000
         MVC   RPLVTLEN(2,RPLVPTR),@CH02098                        0900 02439000
*   RPLVVICB=VVIPTR;                /* SET VVICB PTR         @ZA11665*/ 02440000
         ST    VVIPTR,RPLVVICB(,RPLVPTR)                           0901 02441000
*   MVRPTR=ADDR(RPLVUTIL);          /* ADDR FOR MVR IN RPLV  @ZA17172*/ 02442000
         LA    MVRPTR,RPLVUTIL(,RPLVPTR)                           0902 02443000
*   RPLVPTR=SAVEPTR;                /* RESTORE RPLVPTR       @ZA17172*/ 02444000
*                                                                  0903 02445000
         LR    RPLVPTR,SAVEPTR                                     0903 02446000
*   /*****************************************************************/ 02447000
*   /*                                                               */ 02448000
*   /* SET UP MODIFY VOLUME                                  @ZA11665*/ 02449000
*   /*                                                               */ 02450000
*   /*****************************************************************/ 02451000
*                                                                  0904 02452000
*   MVROPCD=MVROP;                  /* SET MVR OP CODE       @ZA11665*/ 02453000
         MVI   MVROPCD(MVRPTR),X'85'                               0904 02454000
*   MVRLNGTH=LENGTH(MVR);           /* MODV LENGTH           @ZA11665*/ 02455000
         MVC   MVRLNGTH(4,MVRPTR),@CF00312                         0905 02456000
*   MVRFLBAS=ON;                    /* BASE VOLUME SPEC      @ZA11665*/ 02457000
*   MVRFLTO=ON;                     /* EXPIR DATE SPEC       @ZA11665*/ 02458000
         OI    MVRFLBAS(MVRPTR),B'00101000'                        0907 02459000
*   MVRBVOL=MDVOL;                  /* VOLID                 @ZA11665*/ 02460000
         MVC   MVRBVOL(6,MVRPTR),MDVOL+132(RPLVPTR)                0908 02461000
*   MVRTO=BASEXPDT;                 /* EXPIR DATE            @ZA17172*/ 02462000
*                                                                  0909 02463000
         L     @14,BASEVPTR(,RPLVPTR)                              0909 02464000
         MVC   MVRTO(4,MVRPTR),BASEXPDT(@14)                       0909 02465000
*   /*****************************************************************/ 02466000
*   /*                                                               */ 02467000
*   /* RESERVE THE JOURNAL DATA SET                          @ZA11015*/ 02468000
*   /*                                                               */ 02469000
*   /*****************************************************************/ 02470000
*                                                                  0910 02471000
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          @ZA17172*/ 02472000
         LR    REG1,RPLVPTR                                        0910 02473000
*   REG0=RESEXVJL;                  /* INDICATE JOURNAL      @ZA11015*/ 02474000
         LA    REG0,17                                             0911 02475000
*   CALL ICBVRR00;                  /* RESERVE JOURNAL       @ZA11015*/ 02476000
*                                                                  0912 02477000
         L     @15,@CV00248                                        0912 02478000
         BALR  @14,@15                                             0912 02479000
*   /*****************************************************************/ 02480000
*   /*                                                               */ 02481000
*   /* CALL ROUTINE TO JOURNAL THE RPLV                      @ZA11015*/ 02482000
*   /*                                                               */ 02483000
*   /*****************************************************************/ 02484000
*                                                                  0913 02485000
*   REG1=ADDR(DRPLV);               /* ADDR OF RPLV          @ZA17172*/ 02486000
         LA    REG1,DRPLV                                          0913 02487000
*   CALL ICBVJL00;                  /* JOURNAL REQUEST BLK   @ZA11015*/ 02488000
*                                                                  0914 02489000
         L     @15,@CV00251                                        0914 02490000
         BALR  @14,@15                                             0914 02491000
*   /*****************************************************************/ 02492000
*   /*                                                               */ 02493000
*   /* CALL ROUTINE TO RELEASE JOURNAL DATA SET              @ZA11015*/ 02494000
*   /*                                                               */ 02495000
*   /*****************************************************************/ 02496000
*                                                                  0915 02497000
*   REG1=RPLVPTR;                   /* ADDR OF RPLV          @ZA17172*/ 02498000
         LR    REG1,RPLVPTR                                        0915 02499000
*   REG0=DEQJRNL;                   /* INDICATE FREE JOURNAL @ZA11015*/ 02500000
         LA    REG0,16                                             0916 02501000
*   CALL ICBVRR00;                  /* FREE IT               @ZA11015*/ 02502000
*                                                                  0917 02503000
         L     @15,@CV00248                                        0917 02504000
         BALR  @14,@15                                             0917 02505000
*   /*****************************************************************/ 02506000
*   /*                                                               */ 02507000
*   /* MAKE IT APPEAR THAT JOURNALING WAS SUCCESSFUL         @ZA11015*/ 02508000
*   /* EVEN IF IT WAS NOT.                                   @ZA11015*/ 02509000
*   /* SET SWITCH INDICATING IT HAS BEEN JOURNALED           @ZA11015*/ 02510000
*   /*                                                               */ 02511000
*   /*****************************************************************/ 02512000
*                                                                  0918 02513000
*   RPLVRETC=R000;                  /* ZERO RETURN           @ZA11015*/ 02514000
         MVC   RPLVRETC(2,RPLVPTR),@CB00170                        0918 02515000
*   RPLRCODE=R000;                  /* ZERO REASON CODE      @ZA11015*/ 02516000
         MVC   RPLRCODE(2,RPLVPTR),@CB00170                        0919 02517000
*   JRNLFLG=OFF;                    /* END JOURNALLING       @ZA11015*/ 02518000
         NI    JRNLFLG,B'11110111'                                 0920 02519000
*   RETURN;                         /*                       @ZA11015*/ 02520000
@EL00012 DS    0H                                                  0921 02521000
@EF00012 DS    0H                                                  0921 02522000
@ER00012 LM    @14,@04,@SA00012                                    0921 02523000
         LM    @06,@12,@SA00012+28                                 0921 02524000
         BR    @14                                                 0921 02525000
*   END JOURNAL;                    /*                       @ZA11015*/ 02526000
*                                                                  0923 02527000
*/*  START OF SPECIFICATIONS ****                            @G24LB04   02528000
*                                                                  0923 02529000
*01*  NAME = AMVGVSUD                                        @G24LB04   02530000
*                                                                  0923 02531000
*01*  FUNCTION = GROUP EXTENSION RECORD UPDATE FOR ALLOCATE  @G24LB04   02532000
*                TO MOUNTED VOLUMES SUPPORT                  @G24LB04   02533000
*                                                                  0923 02534000
*02*  INPUT = ADDRESSABILITY TO GVSNE AND RPLV WITH JFCB AND @G24LB04   02535000
*             MOUNT PARAMETER LIST(GVSNE SLOT INDEXED BY I). @G24LB04   02536000
*                                                                  0923 02537000
*02*  OUTPUT = FOR SUCCESS (RETURN CODE ZERO)                @G24LB04   02538000
*              GVSNE UPDATED THUS --                         @G24LB04   02539000
*              FOR MOUNT FOR GENERAL-USE VOLUME,             @G24LB04   02540000
*                HOST SHAREABILITY IS SET ACCORDING TO UCB   @G24LB04   02541000
*              FOR MOUNT FOR GENERAL-USE VOLUME NOT IN       @G24LB04   02542000
*              SYSGROUP, ON A NONSPECIFIC REQUEST WITH NO    @G24LB04   02543000
*              VOLUMES IN THE JFCB,                          @G24LB04   02544000
*                THE AMOUNT OF PRIMARY EXTENT IS SUBTRACTED  @G24LB04   02545000
*                FROM THE RUNNING COUNT OF FREE SPACE        @G24LB04   02546000
*              FOR MOUNT FAILURE FOR GENERAL-USE VOLUME,     @G24LB04   02547000
*                1) IF VOLUME IS MOUNTED TO NO HOST, THE     @G24LB04   02548000
*                   MOUNTED NON-SHARE INDICATOR IS SET OFF   @G24LB04   02549000
*                2) IF NOT IN SYSGROUP, NO VOLUMES IN JFCB   @G24LB04   02550000
*                   FOR NONSPECIFIC REQUEST, THE AMOUNT OF   @G24LB04   02551000
*                   THE PRIMARY EXTENT IS ADDED TO THE       @G24LB04   02552000
*                   RUNNING COUNT OF FREE SPACE              @G24LB04   02553000
*              FOR FAILURE (RETURN CODE FOUR)                @G24LB04   02554000
*              (ONLY CAN BE INCURRED FOR FIRST ENTRY FOR A   @G24LB04   02555000
*              REQUEST)                                      @G24LB04   02556000
*                GVSNE SET TO SHOW MOUNTED NON-SHAREABLE     @G24LB04   02557000
*                                                                  0923 02558000
**** END OF SPECIFICATIONS ***                               @G24LB04*/ 02559000
*                                                                  0923 02560000
*AMVGVSUD:                          /* GVSNE UPDATE          @G24LB04*/ 02561000
*   PROCEDURE;                      /*                       @G24LB04*/ 02562000
AMVGVSUD STM   @14,@12,@SA00013                                    0923 02563000
*   IF RPLFTIME=OFF                 /* MOUNT                 @G24LB04*/ 02564000
*     THEN                          /* FIRST ENTRY,          @G24LB04*/ 02565000
         TM    RPLFTIME(RPLVPTR),B'10000000'                       0924 02566000
         BNZ   @RF00924                                            0924 02567000
*     DO;                           /* NOT FAILURE           @G24LB04*/ 02568000
*       CALL FINDUCB;               /* GET UCB ADDRESS       @G24LB04*/ 02569000
         BAL   @14,FINDUCB                                         0926 02570000
*       IF RETCOD=0                 /* WAS UCB FOUND?        @G24LB04*/ 02571000
*         THEN                      /* YES                   @G24LB04*/ 02572000
         LTR   RETCOD,RETCOD                                       0927 02573000
         BNZ   @RF00927                                            0927 02574000
*         IF FOUNDUCB->UCBRR=OFF    /* SHAREABLE BETW CPUS?  @G24LB04*/ 02575000
*           THEN                    /*                       @G24LB04*/ 02576000
         L     @14,FOUNDUCB                                        0928 02577000
         TM    UCBRR(@14),B'00100000'                              0928 02578000
         BNZ   @RF00928                                            0928 02579000
*           GVSMTNSH(I)=ON;         /* MARK NOT SHAREABLE    @G24LB04*/ 02580000
         LH    @14,I                                               0929 02581000
         MH    @14,@CH00325                                        0929 02582000
         L     @04,GVSNEPTR(,RPLVPTR)                              0929 02583000
         ALR   @04,@14                                             0929 02584000
         OI    GVSMTNSH-20(@04),B'01000000'                        0929 02585000
*         ELSE                                                     0930 02586000
*           ;                       /*                       @G24LB04*/ 02587000
@RF00928 DS    0H                                                  0931 02588000
*       ELSE                                                       0931 02589000
*         DO;                       /* UCB NOT FOUND, ERROR  @G24LB04*/ 02590000
         B     @RC00927                                            0931 02591000
@RF00927 DS    0H                                                  0932 02592000
*           GVSMTNSH(I)=ON;         /* SET NOT SHAREABLE AND @G24LB04*/ 02593000
         LH    @14,I                                               0932 02594000
         MH    @14,@CH00325                                        0932 02595000
         L     @04,GVSNEPTR(,RPLVPTR)                              0932 02596000
         ALR   @04,@14                                             0932 02597000
         OI    GVSMTNSH-20(@04),B'01000000'                        0932 02598000
*           RETURN CODE(4);         /* SET TO FAIL IF REQ.   @G24LB04*/ 02599000
         LA    @15,4                                               0933 02600000
         L     @14,@SA00013                                        0933 02601000
         LM    @00,@12,@SA00013+8                                  0933 02602000
         BR    @14                                                 0933 02603000
*         END;                      /* CONTINUE PROCESSING   @G24LB04*/ 02604000
*       IF MDSRTCH=ON&              /* MOUNT NON-SPECIFIC?   @G24LB04*/ 02605000
*           GVSVVGRP^=SYSGRP&       /* NOT IN SYSGROUP?      @G24LB04*/ 02606000
*           JFCBNVOL=Z1             /* NO VOLUMES IN JFCB?   @G24LB04*/ 02607000
*         THEN                      /* UPDATE RUNNING COUNT  @G24LB04*/ 02608000
@RC00927 TM    MDSRTCH+132(RPLVPTR),B'00010000'                    0935 02609000
         BNO   @RF00935                                            0935 02610000
         L     @14,GVSNEPTR(,RPLVPTR)                              0935 02611000
         CLC   GVSVVGRP(8,@14),@CC00214                            0935 02612000
         BE    @RF00935                                            0935 02613000
         L     @14,JFCBPTR                                         0935 02614000
         CLC   JFCBNVOL(1,@14),Z1                                  0935 02615000
         BNE   @RF00935                                            0935 02616000
*         DO;                       /* OF FREE SPACE         @G24LB04*/ 02617000
*           CALL PRISCALC;          /* CALC IN CYLINDERS     @G24LB04*/ 02618000
         BAL   @14,PRISCALC                                        0937 02619000
*           GVSMTDSP(I)=GVSMTDSP(I)-PRIQUANC;/* DECREMENT    @G24LB04*/ 02620000
         LH    @14,I                                               0938 02621000
         MH    @14,@CH00325                                        0938 02622000
         L     @06,GVSNEPTR(,RPLVPTR)                              0938 02623000
         LH    @04,GVSMTDSP-20(@14,@06)                            0938 02624000
         SLR   @04,PRIQUANC                                        0938 02625000
         STH   @04,GVSMTDSP-20(@14,@06)                            0938 02626000
*         END;                      /*                       @G24LB04*/ 02627000
*     END;                          /* END 1ST TIME PROCESS  @G24LB04*/ 02628000
*   ELSE                            /* MOUNT FAILURE         @G24LB04*/ 02629000
*     DO;                           /* SECOND CALL           @G24LB04*/ 02630000
         B     @RC00924                                            0941 02631000
@RF00924 DS    0H                                                  0942 02632000
*       IF GVSCPUBM(I)=Z2 THEN      /* MOUNTED TO NO CPU?    @G24LB04*/ 02633000
         LH    @14,I                                               0942 02634000
         MH    @14,@CH00325                                        0942 02635000
         L     @04,GVSNEPTR(,RPLVPTR)                              0942 02636000
         ST    @14,@TF00001                                        0942 02637000
         ALR   @14,@04                                             0942 02638000
         CLC   GVSCPUBM-20(2,@14),Z2                               0942 02639000
         BNE   @RF00942                                            0942 02640000
*         GVSMTNSH(I)=OFF;          /* TURN OFF NON-SHARABLE @G24LB04*/ 02641000
         AL    @04,@TF00001                                        0943 02642000
         NI    GVSMTNSH-20(@04),B'10111111'                        0943 02643000
*       IF MDSRTCH=ON&              /* MOUNT NON-SPECIFIC    @G24LB04*/ 02644000
*           RSTRSW=ON&              /* RESTORING ?           @G24LB04*/ 02645000
*           GVSVVGRP^=SYSGRP&       /* NOT IN SYSGROUP?      @G24LB04*/ 02646000
*           JFCBNVOL=Z1             /* NO VOLUMES IN JFCB?   @G24LB04*/ 02647000
*         THEN                                                     0944 02648000
@RF00942 TM    MDSRTCH+132(RPLVPTR),B'00010000'                    0944 02649000
         BNO   @RF00944                                            0944 02650000
         TM    RSTRSW,B'01000000'                                  0944 02651000
         BNO   @RF00944                                            0944 02652000
         L     @14,GVSNEPTR(,RPLVPTR)                              0944 02653000
         CLC   GVSVVGRP(8,@14),@CC00214                            0944 02654000
         BE    @RF00944                                            0944 02655000
         L     @14,JFCBPTR                                         0944 02656000
         CLC   JFCBNVOL(1,@14),Z1                                  0944 02657000
         BNE   @RF00944                                            0944 02658000
*         DO;                       /* UPDATE RUNNING COUNT  @G24LB04*/ 02659000
*           CALL PRISCALC;          /* PRIMARY SPACE IN CYLS @G24LB04*/ 02660000
         BAL   @14,PRISCALC                                        0946 02661000
*           GVSMTDSP(I)=GVSMTDSP(I)+PRIQUANC;/* ADD BACK IN  @G24LB04*/ 02662000
         LH    @14,I                                               0947 02663000
         MH    @14,@CH00325                                        0947 02664000
         L     @06,GVSNEPTR(,RPLVPTR)                              0947 02665000
         LR    @04,PRIQUANC                                        0947 02666000
         AH    @04,GVSMTDSP-20(@14,@06)                            0947 02667000
         STH   @04,GVSMTDSP-20(@14,@06)                            0947 02668000
*         END;                      /* FREE SPACE UPDATE     @G24LB04*/ 02669000
*     END;                          /*                       @G24LB04*/ 02670000
@RF00944 DS    0H                                                  0950 02671000
*   RETURN CODE(0);                 /* GOOD RETURN           @G24LB04*/ 02672000
@RC00924 SLR   @15,@15                                             0950 02673000
         L     @14,@SA00013                                        0950 02674000
         LM    @00,@12,@SA00013+8                                  0950 02675000
         BR    @14                                                 0950 02676000
*   END AMVGVSUD;                   /*                       @G24LB04*/ 02677000
*                                                                  0952 02678000
*/*  START OF SPECIFICATIONS ****                            @G24LB04   02679000
*                                                                  0952 02680000
*01* NAME = FINDUCB                                          @G24LB04   02681000
*                                                                  0952 02682000
*01* FUNCTION = FIND UCB ADDRESS FOR VUA IN MOUNT REQUEST    @G24LB04   02683000
*               USES IOSGEN MACRO TO PERFORM LOOK-UP         @G24LB04   02684000
*                                                                  0952 02685000
*02* INPUT = ADDRESSABILITY TO MOUNT PARAMETER LIST          @G24LB04   02686000
*               AND TO GVSNE SLOT WITH VOLID, INDEXED BY I   @G24LB04   02687000
*                                                                  0952 02688000
*02* OUTPUT =  RETURN CODE OF ZERO WHEN UCB FOUND OK         @G24LB04   02689000
*                 ADDRESS OF UCB IN FOUNDUCB                 @G24LB04   02690000
*              RETURN CODE OF FOUR WHEN UCB LOOK UP FAILED   @G24LB04   02691000
*                 MESSAGE VIA ICBVOP00                       @G24LB04   02692000
*                                                                  0952 02693000
**** END OF SPECIFICATIONS ***                               @G24LB04*/ 02694000
*                                                                  0952 02695000
*FINDUCB:                           /* FIND ONE UCB ADDRESS  @G24LB04*/ 02696000
*   PROCEDURE;                      /*                       @G24LB04*/ 02697000
*                                                                  0952 02698000
FINDUCB  STM   @14,@12,@SA00014                                    0952 02699000
*   /*****************************************************************/ 02700000
*   /*                                                               */ 02701000
*   /* SAVE REGS AROUND IOSGEN USE, RESTORE ASAP             @G24LB04*/ 02702000
*   /*                                                               */ 02703000
*   /*****************************************************************/ 02704000
*                                                                  0953 02705000
*   STM(REG13,REG15,SAV2UCBL);      /*                       @G24LB04*/ 02706000
         STM   REG13,REG15,SAV2UCBL                                0953 02707000
*   STM(REG6,REG7,SAV3UCBL);        /*                       @G24LB04*/ 02708000
         STM   REG6,REG7,SAV3UCBL                                  0954 02709000
*   RFY                                                            0955 02710000
*    (REG6,                                                        0955 02711000
*     REG7,                                                        0955 02712000
*     REG13) RSTD;                  /*                       @G24LB04*/ 02713000
*   REG13=ADDR(SAV1UCBL);           /* SAVE AREA FOR IOSGEN  @G24LB04*/ 02714000
         LA    REG13,SAV1UCBL                                      0956 02715000
*   REG6=MDVUA;                     /* VUA TO FIND UCB FOR   @G24LB04   02716000
*                                      USE IOSGEN MACRO      @G24LB04*/ 02717000
         LH    REG6,MDVUA+132(,RPLVPTR)                            0957 02718000
*IOSGEN1:                           /*                       @G24LB04*/ 02719000
*   GEN REFS(CVTILK1,CVTILK2,CVTIXAVL,CVTMAP,CVTPTR)/*       @G24LB04*/ 02720000
*       SETS(REG7,REG15,FOUNDUCB,SAVR15);                          0958 02721000
IOSGEN1  DS    0H                                                  0958 02722000
*                                                          /*@G24LB04*/ 02723000
         IOSGEN UCBLOOK                                        @G24LB04 02724000
         ST     REG7,FOUNDUCB         SAVE UCB ADDRESS         @G24LB04 02725000
         ST     REG15,SAVR15          SAVE RETURN CODE         @G24LB04 02726000
*   RFY                                                            0959 02727000
*    (REG6,                                                        0959 02728000
*     REG7,                                                        0959 02729000
*     REG13) UNRSTD;                /*                       @G24LB04*/ 02730000
*   LM(REG13,REG15,SAV2UCBL);       /* RESTORE OWN REGS      @G24LB04*/ 02731000
         LM    REG13,REG15,SAV2UCBL                                0960 02732000
*   LM(REG6,REG7,SAV3UCBL);         /*                       @G24LB04*/ 02733000
         LM    REG6,REG7,SAV3UCBL                                  0961 02734000
*   IF SAVR15^=FX31ZERO             /* GOOD RETURN?          @G24LB04*/ 02735000
*     THEN                          /* UCB NOT FOUND         @G24LB04*/ 02736000
         L     @14,SAVR15                                          0962 02737000
         LTR   @14,@14                                             0962 02738000
         BZ    @RF00962                                            0962 02739000
*     DO;                           /* ERROR PROCESSING      @G24LB04*/ 02740000
*       RPLRCODE=R23D;              /* SET MSSC REASON CODE  @G24LB04*/ 02741000
         MVC   RPLRCODE(2,RPLVPTR),@CB00190                        0964 02742000
*       MSGRQ=''B;                  /* CLEAR MESSAGE REQUEST @G24LB04*/ 02743000
         XC    MSGRQ(32),MSGRQ                                     0965 02744000
*       MSGRPLV=RPLVPTR;            /* RPLV ADDRESS          @G24LB04*/ 02745000
         ST    RPLVPTR,MSGRPLV                                     0966 02746000
*       MSGID=M482;                 /* MESSAGE ICB482I       @G24LB04*/ 02747000
         MVC   MSGID(4),@CF00168                                   0967 02748000
*       MSGLEN1=FOURFIX8;           /* LENGTH OF VUA REPRES  @G24LB04*/ 02749000
*                                                                  0968 02750000
         MVI   MSGLEN1,X'04'                                       0968 02751000
*       /*************************************************************/ 02752000
*       /*                                                           */ 02753000
*       /* SINCE VUA WAS NOT KNOWN, HERE PRINT EBCDIC OF     @G24LB04*/ 02754000
*       /* THE HEX VALUE IN THE VUA POSITIONS OF THE MOUNT   @G24LB04*/ 02755000
*       /* REQUEST LIST AS AN AID IN DEBUGGING               @G24LB04*/ 02756000
*       /*                                                           */ 02757000
*       /*************************************************************/ 02758000
*                                                                  0969 02759000
*       DO ICHAR=1 TO 2;            /* 1 BYTE HEX TO 2 CHARS @G24LB04*/ 02760000
         LA    ICHAR,1                                             0969 02761000
@DL00969 DS    0H                                                  0970 02762000
*         FRCHAR=VUACHAR(ICHAR);    /* PICK UP 1 BYTE OF VUA @G24LB04*/ 02763000
         LR    @14,RPLVPTR                                         0970 02764000
         ALR   @14,ICHAR                                           0970 02765000
         MVC   FRCHAR(1),VUACHAR+131(@14)                          0970 02766000
*         EIX=0;                    /* ZERO THE INDEX        @G24LB04*/ 02767000
         MVI   EIX,X'00'                                           0971 02768000
*         TOBIT8=TOBIT8|FRBIT8/16;  /* MOVE IN LEFT HALF     @G24LB04*/ 02769000
         SLR   @14,@14                                             0972 02770000
         IC    @14,FRBIT8                                          0972 02771000
         SRL   @14,4                                               0972 02772000
         SLR   @07,@07                                             0972 02773000
         IC    @07,TOBIT8                                          0972 02774000
         OR    @14,@07                                             0972 02775000
         STC   @14,TOBIT8                                          0972 02776000
*         PRHXCH(2*(ICHAR-1)+1)=EBC(EIX+1);/* EBCDIC OF      @G24LB04   02777000
*                                      LEFT HALF             @G24LB04*/ 02778000
         LR    @14,ICHAR                                           0973 02779000
         BCTR  @14,0                                               0973 02780000
         ALR   @14,@14                                             0973 02781000
         LA    @07,PRHXCH(@14)                                     0973 02782000
         SLR   @14,@14                                             0973 02783000
         IC    @14,EIX                                             0973 02784000
         LA    @04,EBC(@14)                                        0973 02785000
         MVC   0(1,@07),0(@04)                                     0973 02786000
*         EIX=0;                    /* ZERO THE INDEX        @G24LB04*/ 02787000
         MVI   EIX,X'00'                                           0974 02788000
*         TOBIT8=TOBIT8|FRBIT8&'0F'X;/* PICK UP RIGHT HALF   @G24LB04*/ 02789000
         MVC   @TS00001(1),FRBIT8                                  0975 02790000
         NI    @TS00001,X'0F'                                      0975 02791000
         OC    TOBIT8(1),@TS00001                                  0975 02792000
*         PRHXCH(2*ICHAR)=EBC(EIX+1);/* EBCDIC OF RIGHT      @G24LB04   02793000
*                                      HALF                  @G24LB04*/ 02794000
         LR    @14,ICHAR                                           0976 02795000
         ALR   @14,@14                                             0976 02796000
         LA    @07,PRHXCH-1(@14)                                   0976 02797000
         SLR   @14,@14                                             0976 02798000
         IC    @14,EIX                                             0976 02799000
         LA    @04,EBC(@14)                                        0976 02800000
         MVC   0(1,@07),0(@04)                                     0976 02801000
*       END;                        /* ONE CHAR AT A TIME    @G24LB04*/ 02802000
         AL    ICHAR,@CF00112                                      0977 02803000
         C     ICHAR,@CF00076                                      0977 02804000
         BNH   @DL00969                                            0977 02805000
*       MSGTEXT1=ADDR(PRINTHEX);    /* EBCDIC FOR HEX OF VUA @G24LB04*/ 02806000
         LA    @14,PRINTHEX                                        0978 02807000
         STCM  @14,7,MSGTEXT1                                      0978 02808000
*       MSGLEN2=SIX;                /* LENGTH OF VOLSER      @G24LB04*/ 02809000
         MVI   MSGLEN2,X'06'                                       0979 02810000
*       MSGTEXT2=ADDR(GVSVOLID(I)); /* PROVIDE VOLSER        @G24LB04*/ 02811000
         LH    @14,I                                               0980 02812000
         MH    @14,@CH00325                                        0980 02813000
         L     @04,GVSNEPTR(,RPLVPTR)                              0980 02814000
         LA    @14,GVSVOLID-20(@14,@04)                            0980 02815000
         STCM  @14,7,MSGTEXT2                                      0980 02816000
*       RFY                                                        0981 02817000
*        (REG1) RSTD;               /*                       @G24LB04*/ 02818000
*       REG1=ADDR(MSGRQ);           /* PROVIDE REQUEST ADDR  @G24LB04*/ 02819000
         LA    REG1,MSGRQ                                          0982 02820000
*       CALL ICBVOP00;              /* WRITE MESSAGE         @G24LB04*/ 02821000
         L     @15,@CV00250                                        0983 02822000
         BALR  @14,@15                                             0983 02823000
*       RFY                                                        0984 02824000
*        (REG1) UNRSTD;             /*                       @G24LB04*/ 02825000
*       RETURN CODE(4);             /* SET TO FAIL IF REQ    @G24LB04*/ 02826000
         LA    @15,4                                               0985 02827000
         L     @14,@SA00014                                        0985 02828000
         LM    @00,@12,@SA00014+8                                  0985 02829000
         BR    @14                                                 0985 02830000
*     END;                          /*                       @G24LB04*/ 02831000
*   RETURN CODE(0);                 /* GOOD RETURN           @G24LB04*/ 02832000
@RF00962 SLR   @15,@15                                             0987 02833000
         L     @14,@SA00014                                        0987 02834000
         LM    @00,@12,@SA00014+8                                  0987 02835000
         BR    @14                                                 0987 02836000
*   END FINDUCB;                    /*                       @G24LB04*/ 02837000
*                                                                  0989 02838000
*/*  START OF SPECIFICATIONS                                 @G24LB04   02839000
*                                                                  0989 02840000
*01* NAME = PRISCALC                                         @G24LB04   02841000
*                                                                  0989 02842000
*01* FUNCTION = CALCULATE PRIMARY EXTENT SPACE IN CYLINDERS  @G24LB04   02843000
*                                                                  0989 02844000
*02* INPUT = ADDRESSABILITY TO JFCB IN MOUNT PARAMETER LIST. @G24LB04   02845000
*            JFCBPQTY MUST HAVE PRIMARY SPACE VALUE.         @G24LB04   02846000
*                                                                  0989 02847000
*02* OUTPUT = PRIQUANC CONTAINS THE PRIMARY EXTENT QUANTITY, @G24LB04   02848000
*             IN CYLINDERS                                   @G24LB04   02849000
*                                                                  0989 02850000
**** END OF SPECIFICATIONS ***                               @G24LB04*/ 02851000
*                                                                  0989 02852000
*PRISCALC:                          /* CALC PRIMARY SPACE    @G24LB04*/ 02853000
*   PROCEDURE;                      /*                       @G24LB04*/ 02854000
PRISCALC STM   @14,@06,12(@13)                                     0989 02855000
         STM   @08,@12,52(@13)                                     0989 02856000
*   PRIQUANC=FX24ZERO;              /* ZERO PRIMARY QUANTITY @G24LB04*/ 02857000
         SLR   PRIQUANC,PRIQUANC                                   0990 02858000
*   NP1=JFCBPQTY;                   /* PICK UP PRIMARY SPEC  @G24LB04*/ 02859000
         L     @14,JFCBPTR                                         0991 02860000
         MVC   NP1(3),JFCBPQTY(@14)                                0991 02861000
*   JD1=JFCBDRLH;                   /* AVE. DATA BLOCK LENGTH@G24LB04*/ 02862000
         MVC   JD1(3),JFCBDRLH(@14)                                0992 02863000
*   IF JFCBSPAC=CYLSPACE            /* SPACE IN CYLINDERS?   @G24LB04*/ 02864000
*     THEN                                                         0993 02865000
         TM    JFCBSPAC(@14),B'11000000'                           0993 02866000
         BNO   @RF00993                                            0993 02867000
*     PRIQUANC=NPQTY;               /* PICK UP PRIMARY       @G24LB04*/ 02868000
         L     PRIQUANC,NPQTY-1                                    0994 02869000
         LA    PRIQUANC,0(,PRIQUANC)                               0994 02870000
*   ELSE                            /* SPACE NOT IN CYLINDER @G24LB04*/ 02871000
*     IF JFCBSPAC=TRKSPACE          /* SPACE IN TRACKS?      @G24LB04*/ 02872000
*       THEN                        /* SPACE IN TRACKS       @G24LB04*/ 02873000
         B     @RC00993                                            0995 02874000
@RF00993 L     @14,JFCBPTR                                         0995 02875000
         TM    JFCBSPAC(@14),B'10000000'                           0995 02876000
         BNO   @RF00995                                            0995 02877000
         TM    JFCBSPAC(@14),B'01000000'                           0995 02878000
         BNZ   @RF00995                                            0995 02879000
*       DO;                         /* SET QUANTITIES        @G24LB04*/ 02880000
*         IF NPQTY//TRKCYL>0        /* MULTIPLE OF 19?       @G24LB04*/ 02881000
*           THEN                                                   0997 02882000
         L     @02,NPQTY-1                                         0997 02883000
         LA    @02,0(,@02)                                         0997 02884000
         SRDA  @02,32                                              0997 02885000
         D     @02,@CF00148                                        0997 02886000
         LTR   @02,@02                                             0997 02887000
         BNP   @RF00997                                            0997 02888000
*           ROUND=1;                /* ROUND UP              @G24LB04*/ 02889000
         LA    ROUND,1                                             0998 02890000
*         ELSE                                                     0999 02891000
*           ROUND=0;                /* DO NOT ROUND          @G24LB04*/ 02892000
         B     @RC00997                                            0999 02893000
@RF00997 SLR   ROUND,ROUND                                         0999 02894000
*         PRIQUANC=(NPQTY/TRKCYL)+ROUND;/* SET PRIMARY       @G24LB04*/ 02895000
@RC00997 L     @03,NPQTY-1                                         1000 02896000
         LA    @03,0(,@03)                                         1000 02897000
         SLR   @02,@02                                             1000 02898000
         D     @02,@CF00148                                        1000 02899000
         ALR   @03,ROUND                                           1000 02900000
         LR    PRIQUANC,@03                                        1000 02901000
*       END;                        /*                       @G24LB04*/ 02902000
*     ELSE                          /*                       @G24LB04*/ 02903000
*       IF JFCBSPAC=AVBSPACE        /* BLOCK REQUEST         @G24LB04*/ 02904000
*         THEN                                                     1002 02905000
         B     @RC00995                                            1002 02906000
@RF00995 L     @14,JFCBPTR                                         1002 02907000
         TM    JFCBSPAC(@14),B'01000000'                           1002 02908000
         BNO   @RF01002                                            1002 02909000
         TM    JFCBSPAC(@14),B'10000000'                           1002 02910000
         BNZ   @RF01002                                            1002 02911000
*         DO;                       /*                       @G24LB04*/ 02912000
*           IF JFCBDRLH^=0          /* BLKLENG - CALCULATE   @G24LB04*/ 02913000
*             THEN                  /*                       @G24LB04*/ 02914000
         ICM   @06,7,JFCBDRLH(@14)                                 1004 02915000
         BZ    @RF01004                                            1004 02916000
*             DO;                   /*                       @G24LB04*/ 02917000
*               IF KEYLE>0          /* KEY GT ZERO?          @G24LB04*/ 02918000
*                 THEN                                             1006 02919000
         CLI   KEYLE(@14),0                                        1006 02920000
         BNH   @RF01006                                            1006 02921000
*                 NRECLN=CON1+KEYLE+DRLH;/*                  @G24LB04   02922000
*                                      RECORD LENGTH-KEY     @G24LB04*/ 02923000
         LA    NRECLN,191                                          1007 02924000
         SLR   @01,@01                                             1007 02925000
         IC    @01,KEYLE(,@14)                                     1007 02926000
         ALR   NRECLN,@01                                          1007 02927000
         L     @14,DRLH-1                                          1007 02928000
         LA    @14,0(,@14)                                         1007 02929000
         ALR   NRECLN,@14                                          1007 02930000
*               ELSE                                               1008 02931000
*                 NRECLN=CON2+DRLH; /* RECORD LENGTH,        @G24LB04   02932000
*                                      NO KEY                @G24LB04*/ 02933000
         B     @RC01006                                            1008 02934000
@RF01006 LA    NRECLN,135                                          1008 02935000
         L     @14,DRLH-1                                          1008 02936000
         LA    @14,0(,@14)                                         1008 02937000
         ALR   NRECLN,@14                                          1008 02938000
*               NRECRDS=TKCAPCTY/NRECLN;/* CALC NO OF RECORDS      1009 02939000
*                                                            @G24LB04*/ 02940000
@RC01006 L     @02,@CF00217                                        1009 02941000
         SRDA  @02,32                                              1009 02942000
         DR    @02,NRECLN                                          1009 02943000
         LR    NRECRDS,@03                                         1009 02944000
*               IF(JFCRFO=OFF&NRECRDS^=0)/* TRACK OVERFLOW   @G24LB04   02945000
*                                      REQUEST               @G24LB04*/ 02946000
*                 THEN              /* YES                   @G24LB04*/ 02947000
         L     @14,JFCBPTR                                         1010 02948000
         TM    JFCRFO(@14),B'00100000'                             1010 02949000
         BNZ   @RF01010                                            1010 02950000
         SLR   @14,@14                                             1010 02951000
         CR    NRECRDS,@14                                         1010 02952000
         BE    @RF01010                                            1010 02953000
*                 DO;               /*                       @G24LB04*/ 02954000
*                   IF(NPQTY//NRECRDS)>0/* ANOTHER TRACK     @G24LB04   02955000
*                                      REQUIRED              @G24LB04*/ 02956000
*                     THEN                                         1012 02957000
         L     @02,NPQTY-1                                         1012 02958000
         LA    @02,0(,@02)                                         1012 02959000
         SRDA  @02,32                                              1012 02960000
         DR    @02,NRECRDS                                         1012 02961000
         CR    @02,@14                                             1012 02962000
         BNH   @RF01012                                            1012 02963000
*                     ROUND=1;      /* YES                   @G24LB04*/ 02964000
         LA    ROUND,1                                             1013 02965000
*                   ELSE                                           1014 02966000
*                     ROUND=0;      /* NO TRACK REQUIRED     @G24LB04*/ 02967000
         B     @RC01012                                            1014 02968000
@RF01012 SLR   ROUND,ROUND                                         1014 02969000
*                   PRIQUANC=(NPQTY/NRECRDS)+ROUND;/*        @G24LB04   02970000
*                                      CALC PRI Q IN TRACKS  @G24LB04*/ 02971000
@RC01012 L     @03,NPQTY-1                                         1015 02972000
         LA    @03,0(,@03)                                         1015 02973000
         SLR   @02,@02                                             1015 02974000
         DR    @02,NRECRDS                                         1015 02975000
         ALR   @03,ROUND                                           1015 02976000
         LR    PRIQUANC,@03                                        1015 02977000
*                   IF(PRIQUANC//TRKCYL)>0/* EXTRA CYL       @G24LB04   02978000
*                                      REQUIRED?             @G24LB04*/ 02979000
*                     THEN                                         1016 02980000
         LR    @02,PRIQUANC                                        1016 02981000
         SRDA  @02,32                                              1016 02982000
         D     @02,@CF00148                                        1016 02983000
         LTR   @02,@02                                             1016 02984000
         BNP   @RF01016                                            1016 02985000
*                     ROUND=1;      /* YES                   @G24LB04*/ 02986000
         LA    ROUND,1                                             1017 02987000
*                   ELSE                                           1018 02988000
*                     ROUND=0;      /* NO                    @G24LB04*/ 02989000
         B     @RC01016                                            1018 02990000
@RF01016 SLR   ROUND,ROUND                                         1018 02991000
*                   PRIQUANC=(PRIQUANC/TRKCYL)+ROUND;/*      @G24LB04   02992000
*                                      CALC PRI QTY IN CYLS  @G24LB04*/ 02993000
@RC01016 LR    @03,PRIQUANC                                        1019 02994000
         SLR   @02,@02                                             1019 02995000
         D     @02,@CF00148                                        1019 02996000
         ALR   @03,ROUND                                           1019 02997000
         LR    PRIQUANC,@03                                        1019 02998000
*                 END;              /*                       @G24LB04*/ 02999000
*               ELSE                                               1021 03000000
*                 DO;               /*                       @G24LB04*/ 03001000
         B     @RC01010                                            1021 03002000
@RF01010 DS    0H                                                  1022 03003000
*                   PRIQUANC=NRECLN*NPQTY;/* TOTAL LENGTH OF @G24LB04   03004000
*                                      RECS                  @G24LB04*/ 03005000
         L     @03,NPQTY-1                                         1022 03006000
         LA    @03,0(,@03)                                         1022 03007000
         MR    @02,NRECLN                                          1022 03008000
         LR    PRIQUANC,@03                                        1022 03009000
*                   IF(PRIQUANC//TKCAPCTY)>0/*               @G24LB04*/ 03010000
*                     THEN                                         1023 03011000
         LR    @02,PRIQUANC                                        1023 03012000
         SRDA  @02,32                                              1023 03013000
         D     @02,@CF00217                                        1023 03014000
         LTR   @02,@02                                             1023 03015000
         BNP   @RF01023                                            1023 03016000
*                     ROUND=1;      /* SET FOR ANOTHER TRACK @G24LB04*/ 03017000
         LA    ROUND,1                                             1024 03018000
*                   ELSE                                           1025 03019000
*                     ROUND=0;      /* NO OTHER TRACK NEEDED @G24LB04*/ 03020000
         B     @RC01023                                            1025 03021000
@RF01023 SLR   ROUND,ROUND                                         1025 03022000
*                   PRIQUANC=(PRIQUANC/TKCAPCTY)+ROUND;/*    @G24LB04   03023000
*                                      CALC NO OF TRACKS     @G24LB04*/ 03024000
@RC01023 LR    @03,PRIQUANC                                        1026 03025000
         SLR   @02,@02                                             1026 03026000
         D     @02,@CF00217                                        1026 03027000
         ALR   @03,ROUND                                           1026 03028000
         LR    PRIQUANC,@03                                        1026 03029000
*                   IF(PRIQUANC//TRKCYL)>0/* MULTIPLE OF 19? @G24LB04*/ 03030000
*                     THEN                                         1027 03031000
         LR    @02,PRIQUANC                                        1027 03032000
         SRDA  @02,32                                              1027 03033000
         D     @02,@CF00148                                        1027 03034000
         LTR   @02,@02                                             1027 03035000
         BNP   @RF01027                                            1027 03036000
*                     ROUND=1;      /*                       @G24LB04*/ 03037000
         LA    ROUND,1                                             1028 03038000
*                   ELSE                                           1029 03039000
*                     ROUND=0;      /*                       @G24LB04*/ 03040000
         B     @RC01027                                            1029 03041000
@RF01027 SLR   ROUND,ROUND                                         1029 03042000
*                   PRIQUANC=(PRIQUANC/TRKCYL)+ROUND;/*      @G24LB04   03043000
*                                      PRIMARY QUAN IN CYLS  @G24LB04*/ 03044000
@RC01027 LR    @03,PRIQUANC                                        1030 03045000
         SLR   @02,@02                                             1030 03046000
         D     @02,@CF00148                                        1030 03047000
         ALR   @03,ROUND                                           1030 03048000
         LR    PRIQUANC,@03                                        1030 03049000
*                 END;              /*                       @G24LB04*/ 03050000
*             END;                  /*                       @G24LB04*/ 03051000
*         END;                      /*                       @G24LB04*/ 03052000
*   END PRISCALC;                   /*                       @G24LB04*/ 03053000
@EL00015 DS    0H                                                  1034 03054000
@EF00015 DS    0H                                                  1034 03055000
@ER00015 LM    @14,@06,12(@13)                                     1034 03056000
         LM    @08,@12,52(@13)                                     1034 03057000
         BR    @14                                                 1034 03058000
*                                                                  1035 03059000
*/*  START OF SPECIFICATIONS                                 @G24LB04   03060000
*                                                                  1035 03061000
*01* NAME = WRITEXPD                                         @G24LB04   03062000
*                                                                  1035 03063000
*01* FUNCTION = WRITES MESSAGE FOR EACH EXPIRATION DATE      @G24LB04   03064000
*               ASSIGNED BY MSVC                             @G24LB04   03065000
*                                                                  1035 03066000
*02* INPUT = ADDRESSABILITY TO GVSNE AND SLOT, INDEXED BY I. @G24LB04   03067000
*            GVSNE HAS GROUP AND SLOT HAS VOLID FOR MESSAGE. @G24LB04   03068000
*            DATE ASSIGNED IS IN GXPDT, A LOCAL VARIABLE.    @G24LB04   03069000
*                                                                  1035 03070000
*02* OUTPUT = MESSAGE ICB481I                                @G24LB04   03071000
*             VOLUME VVVVVV IN GROUP GGGGGGGG EXPIRES YYDDD  @G24LB04   03072000
*                                                                  1035 03073000
**** END OF SPECIFICATIONS ****                              @G24LB04*/ 03074000
*                                                                  1035 03075000
*WRITEXPD:                          /* WRITE EXPIRATION DATE @G24LB04*/ 03076000
*   PROCEDURE;                      /*                       @G24LB04*/ 03077000
WRITEXPD STM   @14,@12,@SA00016                                    1035 03078000
*   MSGRQ=''B;                      /* CLEAR MESSAGE REQUEST @G24LB04*/ 03079000
         XC    MSGRQ(32),MSGRQ                                     1036 03080000
*   MSGRPLV=RPLVPTR;                /* RPLV ADDRESS          @G24LB04*/ 03081000
         ST    RPLVPTR,MSGRPLV                                     1037 03082000
*   MSGID=M481;                     /* ICB481I               @G24LB04*/ 03083000
         MVC   MSGID(4),@CF00166                                   1038 03084000
*   MSGLEN1=SIX;                    /* LENGTH OF VOLSER      @G24LB04*/ 03085000
         MVI   MSGLEN1,X'06'                                       1039 03086000
*   MSGTEXT1=ADDR(GVSVOLID(I));     /* VOLSER                @G24LB04*/ 03087000
         LH    @14,I                                               1040 03088000
         MH    @14,@CH00325                                        1040 03089000
         L     @04,GVSNEPTR(,RPLVPTR)                              1040 03090000
         LA    @14,GVSVOLID-20(@14,@04)                            1040 03091000
         STCM  @14,7,MSGTEXT1                                      1040 03092000
*   MSGLEN2=EIGHT;                  /* LENGTH OF GRP NAME    @G24LB04*/ 03093000
         MVI   MSGLEN2,X'08'                                       1041 03094000
*   MSGTEXT2=ADDR(GVSVVGRP);        /* GROUP NAME            @G24LB04*/ 03095000
         LA    @14,GVSVVGRP(,@04)                                  1042 03096000
         STCM  @14,7,MSGTEXT2                                      1042 03097000
*   MSGLEN3=FIVE;                   /* LENGTH OF YYDDD DATE  @G24LB04*/ 03098000
*                                                                  1043 03099000
         MVI   MSGLEN3,X'05'                                       1043 03100000
*   /*****************************************************************/ 03101000
*   /*                                                               */ 03102000
*   /* CONVERT DATE TO EBCDIC                                @G24LB04*/ 03103000
*   /*                                                               */ 03104000
*   /*****************************************************************/ 03105000
*                                                                  1044 03106000
*   WDATE(1:4)=GXPDT;               /* GET EXPIRATION DATE   @G24LB04*/ 03107000
         MVC   WDATE(4),GXPDT                                      1044 03108000
*   WDATE(5:5)=SIGN;                /* PROVIDE FAKE SIGN     @G24LB04*/ 03109000
         MVC   WDATE+4(1),SIGN                                     1045 03110000
*   GEN(UNPK WRKDATE(7),WDATE+1(4));/* UNPACK 3 BYTES TO 6   @G24LB04*/ 03111000
         UNPK WRKDATE(7),WDATE+1(4)                                     03112000
*   MSGTEXT3=ADDR(WRKDATE);         /* (LAST BYTE NOT USED)  @G24LB04*/ 03113000
         LA    @14,WRKDATE                                         1047 03114000
         STCM  @14,7,MSGTEXT3                                      1047 03115000
*   RFY                                                            1048 03116000
*    (REG1) RSTD;                   /*                       @G24LB04*/ 03117000
*   REG1=ADDR(MSGRQ);               /* MESSAGE REQUEST DATA  @G24LB04*/ 03118000
         LA    REG1,MSGRQ                                          1049 03119000
*   CALL ICBVOP00;                  /* CALLS WRITES MESSAGE  @G24LB04*/ 03120000
         L     @15,@CV00250                                        1050 03121000
         BALR  @14,@15                                             1050 03122000
*   RFY                                                            1051 03123000
*    (REG1) UNRSTD;                 /*                       @G24LB04*/ 03124000
*   END WRITEXPD;                   /*                       @G24LB04*/ 03125000
@EL00016 DS    0H                                                  1052 03126000
@EF00016 DS    0H                                                  1052 03127000
@ER00016 LM    @14,@12,@SA00016                                    1052 03128000
         BR    @14                                                 1052 03129000
*   END ICBVMT00                    /* END ICBVMT00          #Y30LB11*/ 03130000
*                                                                  1053 03131000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 03132000
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                       */ 03133000
*/*%INCLUDE SYSLIB  (IEZVVICB)                                       */ 03134000
*/*%INCLUDE SYSLIB  (IEZRPLV )                                       */ 03135000
*/*%INCLUDE SYSLIB  (IEZBASEV)                                       */ 03136000
*/*%INCLUDE SYSLIB  (IEZGROUP)                                       */ 03137000
*/*%INCLUDE SYSLIB  (IEZGVSNE)                                       */ 03138000
*/*%INCLUDE SYSLIB  (IEZCPUID)                                       */ 03139000
*/*%INCLUDE SYSLIB  (IEZMSGRQ)                                       */ 03140000
*/*%INCLUDE SYSLIB  (IEFJFCBN)                                       */ 03141000
*/*%INCLUDE SYSLIB  (IEFJFCBX)                                       */ 03142000
*/*%INCLUDE SYSLIB  (IEZMVR  )                                       */ 03143000
*/*%INCLUDE SYSLIB  (IEZSSC  )                                       */ 03144000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 03145000
*                                                                  1053 03146000
*       ;                                                          1053 03147000
@DATA    DS    0H                                                       03148000
@CH00091 DC    H'6'                                                     03149000
@CH00325 DC    H'20'                                                    03150000
@CH02098 DC    H'220'                                                   03151000
         DS    0F                                                       03152000
@SA00001 DS    18F                                                      03153000
@SA00002 DS    14F                                                      03154000
@SA00007 DS    15F                                                      03155000
@SA00003 DS    14F                                                      03156000
@SA00004 DS    14F                                                      03157000
@SA00010 DS    15F                                                      03158000
@SA00016 DS    15F                                                      03159000
@SA00013 DS    15F                                                      03160000
@SA00006 DS    15F                                                      03161000
@SA00008 DS    15F                                                      03162000
@SA00014 DS    15F                                                      03163000
@SA00012 DS    0F                                                       03164000
@SA00011 DS    0F                                                       03165000
         DS    15F                                                      03166000
@TF00001 DS    F                                                        03167000
         DS    0F                                                       03168000
@CF00112 DC    F'1'                                                     03169000
@CF00076 DC    F'2'                                                     03170000
@CF00087 DC    F'4'                                                     03171000
@CF00089 DC    F'5'                                                     03172000
@CF00085 DC    F'15'                                                    03173000
@CH00085 EQU   @CF00085+2                                               03174000
@CF00100 DC    F'16'                                                    03175000
@CF00148 DC    F'19'                                                    03176000
@CF00901 DC    F'28'                                                    03177000
@CF00312 DC    F'88'                                                    03178000
@CF00150 DC    F'402'                                                   03179000
@CF00098 DC    F'403'                                                   03180000
@CF00152 DC    F'404'                                                   03181000
@CF00154 DC    F'407'                                                   03182000
@CF00156 DC    F'410'                                                   03183000
@CF00158 DC    F'411'                                                   03184000
@CF00160 DC    F'415'                                                   03185000
@CF00162 DC    F'473'                                                   03186000
@CF00164 DC    F'479'                                                   03187000
@CF00166 DC    F'481'                                                   03188000
@CF00168 DC    F'482'                                                   03189000
@CF00331 DC    F'1024'                                                  03190000
@CF00217 DC    F'13165'                                                 03191000
@CF02120 DC    XL4'0000FFFF'                                            03192000
@CF00117 DC    XL4'7FFF'                                                03193000
@CV00248 DC    V(ICBVRR00)                                              03194000
@CV00249 DC    V(ICBVIO00)                                              03195000
@CV00250 DC    V(ICBVOP00)                                              03196000
@CV00251 DC    V(ICBVJL00)                                              03197000
         DS    0D                                                       03198000
JPTRFX   DS    F                                                        03199000
JXPTRFX  DS    F                                                        03200000
SAVRETPD DS    F                                                        03201000
BASXPDT2 DS    F                                                        03202000
VOLINDEX DS    H                                                        03203000
I        DS    H                                                        03204000
LAST     DS    H                                                        03205000
FRSP     DS    H                                                        03206000
MVRLEN   DC    AL2(88)                                                  03207000
NVOLINDX DS    FL1                                                      03208000
         DS    CL2                                                      03209000
LEXT     DS    FL3                                                      03210000
         DS    CL1                                                      03211000
PQTY     DS    FL3                                                      03212000
         DS    CL1                                                      03213000
SQTY     DS    FL3                                                      03214000
         DS    0D                                                       03215000
@TS00001 DS    CL8                                                      03216000
@CC00108 DC    C'        '                                              03217000
@CC00214 DC    C'SYSGROUP'                                              03218000
@CB00106 DC    X'FFFFFFFC'                                              03219000
@CB00146 DC    X'0099366C'                                              03220000
@CB00103 DC    X'0004'                                                  03221000
@CB00170 DC    X'0000'                                                  03222000
@CB00174 DC    X'0213'                                                  03223000
@CB00176 DC    X'022B'                                                  03224000
@CB00178 DC    X'022C'                                                  03225000
@CB00182 DC    X'022E'                                                  03226000
@CB00184 DC    X'022F'                                                  03227000
@CB00186 DC    X'0231'                                                  03228000
@CB00188 DC    X'0232'                                                  03229000
@CB00190 DC    X'023D'                                                  03230000
@CB00192 DC    X'0261'                                                  03231000
         DS    CL3                                                      03232000
JFCBQTY  DS    CL3                                                      03233000
FOX      DC    X'FFFFFFFF'                                              03234000
F        DC    X'0000000F'                                              03235000
CPU      DS    CL2                                                      03236000
EXPDT    DS    CL4                                                      03237000
DLMTD    DS    CL4                                                      03238000
         DS    CL2                                                      03239000
RCUNPACK DS    CL5                                                      03240000
SAVCPUBM DS    BL2                                                      03241000
SAVGRETN DS    BL1                                                      03242000
SAVGRPCD DS    BL2                                                      03243000
SAVRCODE DS    BL2                                                      03244000
SAVRETC  DS    BL2                                                      03245000
         DS    CL2                                                      03246000
SAV1UCBL DS    CL64                                                     03247000
SAV2UCBL DS    CL12                                                     03248000
SAV3UCBL DS    CL8                                                      03249000
SIGN     DC    X'0F'                                                    03250000
TRANS    DC    CL16'0123456789ABCDEF'                                   03251000
         DS    CL3                                                      03252000
WORK1    DS    CL8                                                      03253000
WRKVUA   DS    CL8                                                      03254000
WRKDATE  DS    CL8                                                      03255000
WDATE    DS    CL5                                                      03256000
         DS    CL3                                                      03257000
VUAUNPCK DS    CL5                                                      03258000
MSCRCF0  DC    X'00F0'                                                  03259000
MSCRC04  DC    X'0004'                                                  03260000
MSCRC0B  DC    X'000B'                                                  03261000
TOBIT8   DS    BL1                                                      03262000
FRBIT8   DS    BL1                                                      03263000
PRINTHEX DS    CL4                                                      03264000
ARGV     DS    CL13                                                     03265000
         ORG   ARGV                                                     03266000
@NM00001 DC    CL5'V    '                                               03267000
ARGVOL   DS    CL6                                                      03268000
@NM00002 DC    CL1' '                                                   03269000
@NM00003 DC    XL1'0'                                                   03270000
         ORG   ARGV+13                                                  03271000
ARGGR    DS    CL13                                                     03272000
         ORG   ARGGR                                                    03273000
@NM00004 DC    CL3'G  '                                                 03274000
ARGGP    DS    CL8                                                      03275000
@NM00005 DC    CL1' '                                                   03276000
ARGNUM   DS    FL1                                                      03277000
         ORG   ARGGR+13                                                 03278000
ARGCPU   DS    CL13                                                     03279000
         ORG   ARGCPU                                                   03280000
@NM00006 DC    CL3'C  '                                                 03281000
@NM00007 DC    CL3'CPU'                                                 03282000
@NM00008 DC    CL1' '                                                   03283000
@NM00009 DC    CL2'ID'                                                  03284000
@NM00010 DC    CL4' '                                                   03285000
         ORG   ARGCPU+13                                                03286000
GXPDT    DS    CL4                                                      03287000
         ORG   GXPDT                                                    03288000
GX1PDT   DS    CL2                                                      03289000
GX2PDT   DS    CL2                                                      03290000
         ORG   GXPDT+4                                                  03291000
GXPDTOLD DS    CL4                                                      03292000
JFCBDATE DS    CL4                                                      03293000
         ORG   JFCBDATE                                                 03294000
@NM00012 DS    FL1                                                      03295000
JFCBYD   DS    CL3                                                      03296000
         ORG   JFCBYD                                                   03297000
JFCBYFX  DS    FL1                                                      03298000
JFCBDFX  DS    FL2                                                      03299000
         ORG   JFCBDATE+4                                               03300000
JD       DS    CL4                                                      03301000
         ORG   JD                                                       03302000
@NM00013 DS    CL1                                                      03303000
JD1      DS    CL3                                                      03304000
         ORG   JD+4                                                     03305000
JP       DS    CL4                                                      03306000
         ORG   JP                                                       03307000
@NM00014 DS    CL1                                                      03308000
JP1      DS    CL3                                                      03309000
         ORG   JP+4                                                     03310000
NP       DS    CL4                                                      03311000
         ORG   NP                                                       03312000
@NM00015 DS    CL1                                                      03313000
NP1      DS    CL3                                                      03314000
         ORG   NP+4                                                     03315000
JS       DS    CL4                                                      03316000
         ORG   JS                                                       03317000
@NM00016 DS    CL1                                                      03318000
JS1      DS    CL3                                                      03319000
         ORG   JS+4                                                     03320000
SWITCHES DS    BL1                                                      03321000
         ORG   SWITCHES                                                 03322000
ALGOSW   DS    BL1                                                      03323000
RSTRSW   EQU   SWITCHES+0                                               03324000
SCRTCHSW EQU   SWITCHES+0                                               03325000
SPACESW  EQU   SWITCHES+0                                               03326000
JRNLFLG  EQU   SWITCHES+0                                               03327000
@NM00018 EQU   SWITCHES+0                                               03328000
         ORG   SWITCHES+1                                               03329000
         DS    CL3                                                      03330000
WORKAREA DS    CL368                                                    03331000
         ORG   WORKAREA                                                 03332000
QMGRLIST DS    CL24                                                     03333000
         ORG   QMGRLIST                                                 03334000
@NM00019 DS    CL12                                                     03335000
QMIDSKA3 DS    CL3                                                      03336000
         ORG   WORKAREA+24                                              03337000
SAVEREGS DS    CL88                                                     03338000
QMGRWORK DS    CL256                                                    03339000
         ORG   WORKAREA+368                                             03340000
Z5       DS    CL5                                                      03341000
         ORG   Z5                                                       03342000
Z4       DS    CL4                                                      03343000
         ORG   Z4                                                       03344000
Z3       DS    CL3                                                      03345000
         ORG   Z3                                                       03346000
Z2       DS    CL2                                                      03347000
Z1       DS    CL1                                                      03348000
         ORG   Z4+3                                                     03349000
@NM00020 DS    CL1                                                      03350000
         ORG   Z5+4                                                     03351000
@NM00021 DS    CL1                                                      03352000
         ORG   Z5+5                                                     03353000
         DS    CL3                                                      03354000
VMTPATCH DS    CL200                                                    03355000
         ORG   VMTPATCH                                                 03356000
@NM00022 DC    CL20'ICBVMT00 PATCH AREA '                               03357000
@NM00023 DC    XL180'0'                                                 03358000
         ORG   VMTPATCH+200                                             03359000
GVSBUFR  DS    CL1024                                                   03360000
MSGRQ    DS    CL32                                                     03361000
         ORG   MSGRQ                                                    03362000
MSGID    DS    FL4                                                      03363000
MSGRPLV  DS    AL4                                                      03364000
MSGRLEN  DS    BL1                                                      03365000
MSGREPLY DS    AL3                                                      03366000
MSGLEN1  DS    BL1                                                      03367000
MSGTEXT1 DS    AL3                                                      03368000
MSGLEN2  DS    BL1                                                      03369000
MSGTEXT2 DS    AL3                                                      03370000
MSGLEN3  DS    BL1                                                      03371000
MSGTEXT3 DS    AL3                                                      03372000
MSGLEN4  DS    BL1                                                      03373000
MSGTEXT4 DS    AL3                                                      03374000
MSGLEN5  DS    BL1                                                      03375000
MSGTEXT5 DS    AL3                                                      03376000
         ORG   MSGRQ+32                                                 03377000
DRPLV    DS    CL220                                                    03378000
TENQVOL  DS    CL6                                                      03379000
         DS    CL2                                                      03380000
MAJRNAM  DC    CL8'SYSZVOLS'                                            03381000
ICBVMT00 CSECT                                                          03382000
FOUNDUCB  DS    F                    UCB ADDRESS FOUND                  03383000
SAVR15    DS    F                    RETURN CODE                        03384000
ICBVMT00 CSECT                                                          03385000
*                                   /* CONSTANTS FOR IOSGEN  @G24LB04*/ 03386000
         IECDIOCM                                              @G24LB04 03387000
         IECDIOCX                                              @G24LB04 03388000
ICBVMT00 CSECT                                                          03389000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       03390000
@01      EQU   01                                                       03391000
@02      EQU   02                                                       03392000
@03      EQU   03                                                       03393000
@04      EQU   04                                                       03394000
@05      EQU   05                                                       03395000
@06      EQU   06                                                       03396000
@07      EQU   07                                                       03397000
@08      EQU   08                                                       03398000
@09      EQU   09                                                       03399000
@10      EQU   10                                                       03400000
@11      EQU   11                                                       03401000
@12      EQU   12                                                       03402000
@13      EQU   13                                                       03403000
@14      EQU   14                                                       03404000
@15      EQU   15                                                       03405000
ICHAR    EQU   @06                                                      03406000
TEMP     EQU   @06                                                      03407000
WRKRETPD EQU   @07                                                      03408000
ROUND    EQU   @06                                                      03409000
NRECRDS  EQU   @05                                                      03410000
RECORDS  EQU   @07                                                      03411000
TOTLEN   EQU   @07                                                      03412000
NRECLN   EQU   @04                                                      03413000
RECLEN   EQU   @08                                                      03414000
PRIQUANC EQU   @07                                                      03415000
INDEX    EQU   @09                                                      03416000
J        EQU   @06                                                      03417000
UCBPR1   EQU   @06                                                      03418000
MVRPTR   EQU   @06                                                      03419000
SAVEPTR  EQU   @07                                                      03420000
VVIPTR   EQU   @08                                                      03421000
RPLVPTR  EQU   @05                                                      03422000
REG0     EQU   @00                                                      03423000
REG1     EQU   @01                                                      03424000
REG6     EQU   @06                                                      03425000
REG7     EQU   @07                                                      03426000
REG13    EQU   @13                                                      03427000
REG15    EQU   @15                                                      03428000
RETCOD   EQU   @15                                                      03429000
MDREG1   EQU   @01                                                      03430000
CVTPTR   EQU   16                                                       03431000
UCBPTR   EQU   0                                                        03432000
UCB      EQU   0                                                        03433000
UCBOB    EQU   0                                                        03434000
UCBJBNR  EQU   UCBOB                                                    03435000
UCBFL5   EQU   UCBOB+1                                                  03436000
UCBAF    EQU   UCBFL5                                                   03437000
UCBSTAT  EQU   UCBOB+3                                                  03438000
UCBCHAN  EQU   UCBOB+4                                                  03439000
UCBSFLS  EQU   UCBOB+6                                                  03440000
UCBFLA   EQU   UCBSFLS                                                  03441000
UCBFL1   EQU   UCBFLA                                                   03442000
UCBBSY   EQU   UCBFL1                                                   03443000
UCBNRY   EQU   UCBFL1                                                   03444000
UCBPST   EQU   UCBFL1                                                   03445000
UCBCUB   EQU   UCBFL1                                                   03446000
UCBFLB   EQU   UCBSFLS+1                                                03447000
UCBCHM   EQU   UCBOB+8                                                  03448000
UCBCHM1  EQU   UCBCHM                                                   03449000
UCBPTH0  EQU   UCBCHM1                                                  03450000
UCBPTH1  EQU   UCBCHM1                                                  03451000
UCBWGT   EQU   UCBOB+12                                                 03452000
UCBTYP   EQU   UCBOB+16                                                 03453000
UCBTBYT1 EQU   UCBTYP                                                   03454000
UCB1FEA5 EQU   UCBTBYT1                                                 03455000
UCB1FEA6 EQU   UCBTBYT1                                                 03456000
UCBTBYT2 EQU   UCBTYP+1                                                 03457000
UCB2OPT2 EQU   UCBTBYT2                                                 03458000
UCBDUDN1 EQU   UCB2OPT2                                                 03459000
UCBRR    EQU   UCBDUDN1                                                 03460000
UCB2OPT3 EQU   UCBTBYT2                                                 03461000
UCBDUDN2 EQU   UCB2OPT3                                                 03462000
UCB2OPT4 EQU   UCBTBYT2                                                 03463000
UCBRWTAU EQU   UCB2OPT4                                                 03464000
UCB2OPT6 EQU   UCBTBYT2                                                 03465000
UCB2OPT7 EQU   UCBTBYT2                                                 03466000
UCBTBYT3 EQU   UCBTYP+2                                                 03467000
UCBDVCLS EQU   UCBTBYT3                                                 03468000
UCBTBYT4 EQU   UCBTYP+3                                                 03469000
UCBEXTPT EQU   UCBOB+20                                                 03470000
UCBFLC   EQU   UCBEXTPT                                                 03471000
UCBDEV   EQU   UCBOB+24                                                 03472000
UCBCMEXT EQU   0                                                        03473000
UCBATI   EQU   UCBCMEXT+3                                               03474000
@NM00027 EQU   UCBATI                                                   03475000
UCBFLP1  EQU   UCBCMEXT+5                                               03476000
UCBMT    EQU   0                                                        03477000
UCBOCR   EQU   0                                                        03478000
UCB3540X EQU   0                                                        03479000
UCBDKBYT EQU   UCB3540X+6                                               03480000
UCBUCS   EQU   0                                                        03481000
UCBUCSOP EQU   UCBUCS+4                                                 03482000
UCBFCBOP EQU   UCBUCS+5                                                 03483000
VVICB    EQU   0                                                        03484000
VVICPUID EQU   VVICB+12                                                 03485000
VVIFLGA  EQU   VVICB+15                                                 03486000
VVIFLG0  EQU   VVIFLGA                                                  03487000
VVIUCB   EQU   VVICB+60                                                 03488000
RPLV     EQU   0                                                        03489000
RPLTCBPR EQU   RPLV+8                                                   03490000
RPLVVICB EQU   RPLV+12                                                  03491000
RPLFLAGA EQU   RPLV+28                                                  03492000
RPLFTIME EQU   RPLFLAGA                                                 03493000
RPLVTLEN EQU   RPLV+30                                                  03494000
RPLRCODE EQU   RPLV+32                                                  03495000
RPLVRETC EQU   RPLV+34                                                  03496000
RPLRMSCC EQU   RPLV+36                                                  03497000
RPLVSAM  EQU   RPLV+56                                                  03498000
RPLVTYP  EQU   RPLVSAM+2                                                03499000
RPLVBUF  EQU   RPLVSAM+32                                               03500000
RPLVKEY  EQU   RPLVSAM+36                                               03501000
RPLVOPT  EQU   RPLVSAM+40                                               03502000
RPLVLOC  EQU   RPLVOPT                                                  03503000
RPLVDIR  EQU   RPLVOPT                                                  03504000
RPLVNEXT EQU   RPLVOPT                                                  03505000
RPLVKGE  EQU   RPLVOPT                                                  03506000
RPLVUPD  EQU   RPLVOPT+1                                                03507000
RPLVBLN  EQU   RPLVSAM+52                                               03508000
RPLVUTIL EQU   RPLV+132                                                 03509000
BASEV    EQU   0                                                        03510000
BASNAME  EQU   BASEV                                                    03511000
BASSERNO EQU   BASNAME+5                                                03512000
BASID    EQU   BASNAME+11                                               03513000
BASFLAGA EQU   BASEV+14                                                 03514000
BASTYPE  EQU   BASFLAGA                                                 03515000
BASGENUS EQU   BASFLAGA+2                                               03516000
BASRSTD  EQU   BASFLAGA+2                                               03517000
BASCPUID EQU   BASEV+18                                                 03518000
BASRCVYF EQU   BASEV+20                                                 03519000
BASSATIA EQU   BASRCVYF                                                 03520000
BASMISCF EQU   BASRCVYF+2                                               03521000
BASLIB1  EQU   BASEV+36                                                 03522000
BASLID1  EQU   BASLIB1                                                  03523000
BASLIB2  EQU   BASEV+49                                                 03524000
BASLID2  EQU   BASLIB2                                                  03525000
BASKLCPY EQU   BASEV+76                                                 03526000
BASCOPID EQU   BASKLCPY+11                                              03527000
BASDLMTD EQU   BASEV+92                                                 03528000
BASEXPDT EQU   BASEV+96                                                 03529000
BASGROUP EQU   BASEV+180                                                03530000
GROUP    EQU   0                                                        03531000
GRONAME  EQU   GROUP                                                    03532000
GROID    EQU   GRONAME+11                                               03533000
GROFLAGA EQU   GROUP+13                                                 03534000
GROTYPE  EQU   GROFLAGA                                                 03535000
GRORLSE  EQU   GROFLAGA+2                                               03536000
GRORETN  EQU   GROFLAGA+2                                               03537000
GROPSPD  EQU   GROUP+36                                                 03538000
GROSSPD  EQU   GROUP+38                                                 03539000
GRORETPD EQU   GROUP+52                                                 03540000
GROERRTS EQU   GROUP+56                                                 03541000
GVSNE    EQU   0                                                        03542000
GVSHDR   EQU   GVSNE                                                    03543000
GVSNAME  EQU   GVSHDR                                                   03544000
GVSVVGRP EQU   GVSNAME+3                                                03545000
GVSID    EQU   GVSNAME+11                                               03546000
GVSFLAGA EQU   GVSHDR+13                                                03547000
GVSTYPE  EQU   GVSFLAGA                                                 03548000
GVSGVSEX EQU   GVSTYPE                                                  03549000
GVSEX    EQU   GVSFLAGA+2                                               03550000
GVSESIND EQU   GVSHDR+18                                                03551000
GVSSLOTS EQU   GVSNE+28                                                 03552000
GVSVOLID EQU   GVSSLOTS                                                 03553000
GVSVOLFL EQU   GVSSLOTS+6                                               03554000
GVSCPUBM EQU   GVSVOLFL                                                 03555000
GVSMTNSH EQU   GVSVOLFL+2                                               03556000
GVSFRESP EQU   GVSSLOTS+10                                              03557000
GVSLEXT  EQU   GVSSLOTS+12                                              03558000
GVSEXPDT EQU   GVSSLOTS+14                                              03559000
GVSMTDSP EQU   GVSSLOTS+18                                              03560000
CPUID    EQU   0                                                        03561000
CPUTYPE  EQU   CPUID+18                                                 03562000
CPUMAP   EQU   CPUID+20                                                 03563000
CPUIDREC EQU   CPUMAP                                                   03564000
CPUMASK  EQU   CPUMAP+6                                                 03565000
INFMJFCB EQU   0                                                        03566000
JFCBDSNM EQU   INFMJFCB                                                 03567000
JFCBELNM EQU   INFMJFCB+44                                              03568000
JFCBTSDM EQU   INFMJFCB+52                                              03569000
JFCFCBID EQU   INFMJFCB+56                                              03570000
JFCBFRID EQU   JFCFCBID                                                 03571000
JFCVINDX EQU   INFMJFCB+64                                              03572000
JFCBLTYP EQU   INFMJFCB+66                                              03573000
JFCBOTTR EQU   INFMJFCB+67                                              03574000
JFCBUFOF EQU   JFCBOTTR                                                 03575000
JFCBFLSQ EQU   JFCBOTTR+1                                               03576000
JFCFUNC  EQU   JFCBFLSQ                                                 03577000
JFCBMASK EQU   INFMJFCB+72                                              03578000
JFCBFLG1 EQU   JFCBMASK+5                                               03579000
JFCOPEN  EQU   JFCBFLG1                                                 03580000
JFCBFLG2 EQU   JFCBMASK+6                                               03581000
JFCDEFER EQU   JFCBFLG2                                                 03582000
JFCBXPDT EQU   INFMJFCB+83                                              03583000
JFCBIND1 EQU   INFMJFCB+86                                              03584000
JFCRLSE  EQU   JFCBIND1                                                 03585000
JFCBIND2 EQU   INFMJFCB+87                                              03586000
JFCAMPTR EQU   INFMJFCB+88                                              03587000
JFCBUFRQ EQU   JFCAMPTR                                                 03588000
JFCBUFNO EQU   JFCBUFRQ                                                 03589000
JFCBGNCP EQU   JFCAMPTR+1                                               03590000
JFCBHIAR EQU   JFCBGNCP                                                 03591000
JFCBFALN EQU   JFCBHIAR                                                 03592000
JFCBFTEK EQU   JFCBFALN                                                 03593000
JFCBBFTA EQU   JFCBFTEK                                                 03594000
JFCEROPT EQU   INFMJFCB+92                                              03595000
JFCTRTCH EQU   INFMJFCB+93                                              03596000
JFCBX    EQU   0                                                        03597000
JFCBXVOL EQU   JFCBX+4                                                  03598000
MVR      EQU   0                                                        03599000
MVRLNGTH EQU   MVR                                                      03600000
MVRCODE  EQU   MVR+4                                                    03601000
MVROPCD  EQU   MVRCODE                                                  03602000
MVRFLAGA EQU   MVR+8                                                    03603000
MVRFLBAS EQU   MVRFLAGA                                                 03604000
MVRFLTO  EQU   MVRFLAGA                                                 03605000
MVRBVOL  EQU   MVR+12                                                   03606000
MVRTO    EQU   MVR+58                                                   03607000
ICB2SSCB EQU   0                                                        03608000
ICBOPT   EQU   ICB2SSCB+48                                              03609000
ICBFLG   EQU   ICB2SSCB+52                                              03610000
ICBFG1   EQU   ICBFLG                                                   03611000
ICBCPUID EQU   ICB2SSCB+112                                             03612000
ICBTRACE EQU   ICB2SSCB+148                                             03613000
CVTMAP   EQU   0                                                        03614000
CVTILK1  EQU   CVTMAP+36                                                03615000
CVTILK2  EQU   CVTMAP+40                                                03616000
CVTDATE  EQU   CVTMAP+56                                                03617000
CVTDAR   EQU   CVTMAP+72                                                03618000
CVTFLGS1 EQU   CVTDAR                                                   03619000
CVTDCB   EQU   CVTMAP+116                                               03620000
CVTIOQET EQU   CVTMAP+120                                               03621000
CVTIXAVL EQU   CVTMAP+124                                               03622000
CVTIERLC EQU   CVTMAP+144                                               03623000
CVTHEAD  EQU   CVTMAP+160                                               03624000
CVTSV76C EQU   CVTHEAD                                                  03625000
CVTOPTA  EQU   CVTMAP+182                                               03626000
CVTOPTB  EQU   CVTMAP+183                                               03627000
CVTGTF   EQU   CVTMAP+236                                               03628000
CVTGTFST EQU   CVTGTF                                                   03629000
CVTGTFS  EQU   CVTGTFST                                                 03630000
CVTSTATE EQU   CVTGTFST                                                 03631000
CVTTMODE EQU   CVTGTFST                                                 03632000
CVTFORM  EQU   CVTGTFST                                                 03633000
CVTAQAVT EQU   CVTMAP+240                                               03634000
CVTTCMFG EQU   CVTAQAVT                                                 03635000
CVTVOLM2 EQU   CVTMAP+244                                               03636000
CVTTATA  EQU   CVTVOLM2                                                 03637000
CVTTSKS  EQU   CVTTATA                                                  03638000
CVTVOLF2 EQU   CVTTSKS                                                  03639000
CVTTAT   EQU   CVTTATA+1                                                03640000
CVTATER  EQU   CVTMAP+248                                               03641000
CVTEXT1  EQU   CVTMAP+252                                               03642000
CVTPURG  EQU   CVTMAP+260                                               03643000
CVTQMSG  EQU   CVTMAP+268                                               03644000
CVTDMSR  EQU   CVTMAP+272                                               03645000
CVTRSV37 EQU   CVTDMSR                                                  03646000
CVTDMSRF EQU   CVTRSV37                                                 03647000
CVTERPV  EQU   CVTMAP+316                                               03648000
CVTINTLA EQU   CVTMAP+320                                               03649000
CVTAPF   EQU   CVTMAP+324                                               03650000
CVTEXT2  EQU   CVTMAP+328                                               03651000
CVTHJES  EQU   CVTMAP+332                                               03652000
CVTPGSIA EQU   CVTMAP+348                                               03653000
CVTA1F1  EQU   CVTMAP+356                                               03654000
CVTSYSK  EQU   CVTMAP+357                                               03655000
CVTVOLM1 EQU   CVTMAP+380                                               03656000
CVTVOLF1 EQU   CVTVOLM1                                                 03657000
CVTATMCT EQU   CVTMAP+388                                               03658000
CVTXTNT1 EQU   0                                                        03659000
CVTXTNT2 EQU   0                                                        03660000
CVTDSSV  EQU   CVTXTNT2                                                 03661000
CVTFLGBT EQU   CVTXTNT2+5                                               03662000
CVTQID   EQU   CVTXTNT2+24                                              03663000
CVTICB   EQU   CVTXTNT2+48                                              03664000
CVTRV400 EQU   CVTXTNT2+52                                              03665000
CVTRV409 EQU   CVTXTNT2+53                                              03666000
CVTATCVT EQU   CVTXTNT2+64                                              03667000
CVTRV429 EQU   CVTXTNT2+84                                              03668000
CVTRV438 EQU   CVTXTNT2+85                                              03669000
CVTRV457 EQU   CVTXTNT2+112                                             03670000
CVTRV466 EQU   CVTXTNT2+113                                             03671000
CVTFIX   EQU   0                                                        03672000
CVTRELNO EQU   CVTFIX+252                                               03673000
ICBMTLST EQU   0                                                        03674000
MDLEN    EQU   ICBMTLST                                                 03675000
MDOPCD   EQU   ICBMTLST+4                                               03676000
MDFLG    EQU   ICBMTLST+6                                               03677000
MDVSVRQ  EQU   MDFLG                                                    03678000
MDSRTCH  EQU   MDFLG                                                    03679000
MDVOL    EQU   ICBMTLST+8                                               03680000
MDVUA    EQU   ICBMTLST+14                                              03681000
MDHOST   EQU   ICBMTLST+16                                              03682000
MNTEXTP  EQU   ICBMTLST+24                                              03683000
MDJFCB   EQU   MNTEXTP                                                  03684000
UCBBGN   EQU   0                                                        03685000
CPUIDPTR EQU   RPLVBUF                                                  03686000
BASEVPTR EQU   RPLVBUF                                                  03687000
GROUPPTR EQU   RPLVBUF                                                  03688000
GVSNEPTR EQU   RPLVBUF                                                  03689000
UCBPR2   EQU   UCBPTR                                                   03690000
JPTR     EQU   JPTRFX                                                   03691000
JFCBPTR  EQU   JPTR                                                     03692000
JXPTR    EQU   JXPTRFX                                                  03693000
JFCBXPTR EQU   JXPTR                                                    03694000
DRLH     EQU   JD1                                                      03695000
JFCBFQTY EQU   JFCBQTY                                                  03696000
JPQTY    EQU   JP1                                                      03697000
NPQTY    EQU   NP1                                                      03698000
JSQTY    EQU   JS1                                                      03699000
JFCSPPRT EQU   JFCTRTCH                                                 03700000
JFCBABFS EQU   JFCSPPRT+2                                               03701000
JFCLIMCT EQU   JFCBABFS                                                 03702000
JFCDSORG EQU   JFCSPPRT+5                                               03703000
JFCDSRG1 EQU   JFCDSORG                                                 03704000
JFCORGIS EQU   JFCDSRG1                                                 03705000
JFCORGPO EQU   JFCDSRG1                                                 03706000
JFCDSRG2 EQU   JFCDSORG+1                                               03707000
JFCRECFM EQU   JFCSPPRT+7                                               03708000
JFCRCFM  EQU   JFCRECFM                                                 03709000
JFCRFO   EQU   JFCRCFM                                                  03710000
JFCOPTCD EQU   JFCSPPRT+8                                               03711000
JFCWVCSP EQU   JFCOPTCD                                                 03712000
JFCWVCIS EQU   JFCWVCSP                                                 03713000
JFCWVCBD EQU   JFCWVCIS                                                 03714000
JFCALLOW EQU   JFCOPTCD                                                 03715000
JFCRSV17 EQU   JFCALLOW                                                 03716000
JFCOVER  EQU   JFCRSV17                                                 03717000
JFCPCIBT EQU   JFCOPTCD                                                 03718000
JFCMAST  EQU   JFCPCIBT                                                 03719000
JFCEXT   EQU   JFCMAST                                                  03720000
JFCBCKPT EQU   JFCOPTCD                                                 03721000
JFCIND   EQU   JFCBCKPT                                                 03722000
JFCRSV18 EQU   JFCOPTCD                                                 03723000
JFCCYL   EQU   JFCRSV18                                                 03724000
JFCACT   EQU   JFCCYL                                                   03725000
JFCREDUC EQU   JFCOPTCD                                                 03726000
JFCRSV19 EQU   JFCREDUC                                                 03727000
JFCRSV20 EQU   JFCRSV19                                                 03728000
JFCRSV21 EQU   JFCOPTCD                                                 03729000
JFCDEL   EQU   JFCRSV21                                                 03730000
JFCOPTJ  EQU   JFCOPTCD                                                 03731000
JFCREORG EQU   JFCOPTJ                                                  03732000
JFCBLKSI EQU   JFCSPPRT+9                                               03733000
JFCBUFSI EQU   JFCBLKSI                                                 03734000
JFCAMSYN EQU   JFCSPPRT+11                                              03735000
JFCNCP   EQU   JFCAMSYN+2                                               03736000
JFCNTM   EQU   JFCAMSYN+3                                               03737000
JFCBFSEQ EQU   JFCNTM                                                   03738000
JFCPCI   EQU   JFCBFSEQ                                                 03739000
JFCRESRV EQU   JFCAMSYN+4                                               03740000
JFCUCSEG EQU   JFCRESRV                                                 03741000
JFCUCSOP EQU   JFCUCSEG+4                                               03742000
JFCOUTLI EQU   JFCUCSEG+5                                               03743000
JFCTHRSH EQU   JFCOUTLI                                                 03744000
JFCCPRI  EQU   JFCTHRSH                                                 03745000
JFCBNVOL EQU   JFCUCSEG+9                                               03746000
JFCBVOLS EQU   JFCUCSEG+10                                              03747000
JFCAVOLS EQU   JFCBVOLS                                                 03748000
NVOL     EQU   JFCBNVOL                                                 03749000
JFCKEYLE EQU   JFCTRTCH                                                 03750000
JFCCODE  EQU   JFCKEYLE                                                 03751000
KEYLE    EQU   JFCKEYLE                                                 03752000
VUACHAR  EQU   MDVUA                                                    03753000
FRCHAR   EQU   FRBIT8                                                   03754000
PRHXCH   EQU   PRINTHEX                                                 03755000
EBC      EQU   TRANS                                                    03756000
EIX      EQU   TOBIT8                                                   03757000
@NM00011 EQU   JFCRLSE                                                  03758000
JFCRLSE1 EQU   @NM00011                                                 03759000
JFCRLSE2 EQU   @NM00011                                                 03760000
VINDX    EQU   JFCVINDX                                                 03761000
ALGOBIT  EQU   VINDX                                                    03762000
UCBOBS01 EQU   UCBDEV                                                   03763000
UCBVOLI  EQU   UCBOBS01+4                                               03764000
UCBSTAB  EQU   UCBOBS01+10                                              03765000
UCBBSVL  EQU   UCBSTAB                                                  03766000
UCBPRSRS EQU   UCBSTAB                                                  03767000
UCBDMCT  EQU   UCBOBS01+11                                              03768000
UCBFL4   EQU   UCBOBS01+13                                              03769000
UCBOBS02 EQU   UCBDEV                                                   03770000
UCBTFL1  EQU   UCBOBS02+19                                              03771000
UCBXTN   EQU   UCBOBS02+20                                              03772000
UCBVOPT  EQU   UCBXTN                                                   03773000
UCBOBS03 EQU   UCBDEV                                                   03774000
UCBXTADR EQU   UCBOBS03                                                 03775000
UCBOBS04 EQU   UCBDEV                                                   03776000
UCBBTA   EQU   UCBOBS04+12                                              03777000
UCBOBS06 EQU   UCBDEV                                                   03778000
UCBAOF   EQU   UCBOBS06                                                 03779000
UCBAOF1  EQU   UCBAOF                                                   03780000
UCBAOF2  EQU   UCBAOF+1                                                 03781000
@NM00026 EQU   UCBOBS06+3                                               03782000
UCBIRB   EQU   UCBOBS06+4                                               03783000
UCBGRAF  EQU   UCBIRB                                                   03784000
UCBLDNCA EQU   UCBOBS06+8                                               03785000
UCBRDYQ  EQU   UCBLDNCA                                                 03786000
UCBIRLN  EQU   UCBRDYQ                                                  03787000
UCBLDNCB EQU   UCBRDYQ+1                                                03788000
UCBCTLNK EQU   UCBOBS06+12                                              03789000
UCBOBS07 EQU   UCBDEV                                                   03790000
UCBOBS08 EQU   UCBDEV                                                   03791000
UCBOBS09 EQU   UCBDEV                                                   03792000
JFCSTACK EQU   JFCTRTCH                                                 03793000
JFCMODE  EQU   JFCSTACK                                                 03794000
JFCBS001 EQU   JFCBVOLS                                                 03795000
JFCMSVGP EQU   JFCBS001+22                                              03796000
JFCBPQTY EQU   JFCBS001+34                                              03797000
JFCBCTRI EQU   JFCBS001+37                                              03798000
JFCBSPAC EQU   JFCBCTRI                                                 03799000
JFCBMSGP EQU   JFCBCTRI                                                 03800000
JFCONTIG EQU   JFCBCTRI                                                 03801000
JFCMIXG  EQU   JFCBCTRI                                                 03802000
JFCALX   EQU   JFCBCTRI                                                 03803000
JFCBSQTY EQU   JFCBS001+38                                              03804000
JFCFLGS1 EQU   JFCBS001+41                                              03805000
JFCBSPNM EQU   JFCBS001+45                                              03806000
JFCBFLG3 EQU   JFCBSPNM                                                 03807000
JFCBABST EQU   JFCBS001+48                                              03808000
JFCBDRLH EQU   JFCBS001+53                                              03809000
CVTS01   EQU   CVTPGSIA                                                 03810000
CVTLPDIA EQU   CVTS01+12                                                03811000
CVTDIRST EQU   CVTLPDIA                                                 03812000
CVTSLIDA EQU   CVTS01+24                                                03813000
CVTCTLFG EQU   CVTS01+50                                                03814000
CVTRV210 EQU   CVTS01+424                                               03815000
CVTRV219 EQU   CVTS01+425                                               03816000
CVTRV228 EQU   CVTS01+426                                               03817000
CVTRV237 EQU   CVTS01+427                                               03818000
CVTMFRTR EQU   CVTS01+452                                               03819000
CVTRV262 EQU   CVTS01+468                                               03820000
CVTRV271 EQU   CVTS01+469                                               03821000
CVTRV280 EQU   CVTS01+470                                               03822000
CVTRV289 EQU   CVTS01+471                                               03823000
CVTGSDA  EQU   CVTS01+600                                               03824000
MNTFLAGS EQU   MDFLG                                                    03825000
MNTHOSTD EQU   MDHOST                                                   03826000
MNTJFCB  EQU   MDJFCB                                                   03827000
MNTLEN   EQU   MDLEN                                                    03828000
MNTOPCD  EQU   MDOPCD                                                   03829000
MNTVOLID EQU   MDVOL                                                    03830000
MNTVUA   EQU   MDVUA                                                    03831000
TOCHAR   EQU   TOBIT8                                                   03832000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    03833000
CVTRV628 EQU   CVTS01+728                                               03834000
CVTRV627 EQU   CVTS01+724                                               03835000
CVTRV626 EQU   CVTS01+720                                               03836000
CVTRV625 EQU   CVTS01+716                                               03837000
CVTRV624 EQU   CVTS01+712                                               03838000
CVTRV623 EQU   CVTS01+708                                               03839000
CVTRV622 EQU   CVTS01+704                                               03840000
CVTRV621 EQU   CVTS01+700                                               03841000
CVTIHASU EQU   CVTS01+696                                               03842000
CVTSUSP  EQU   CVTS01+692                                               03843000
CVTT6SVC EQU   CVTS01+688                                               03844000
CVTCDAL  EQU   CVTS01+684                                               03845000
CVTTCTL  EQU   CVTS01+680                                               03846000
CVTRSUME EQU   CVTS01+676                                               03847000
CVTJTERM EQU   CVTS01+672                                               03848000
CVTASMRM EQU   CVTS01+668                                               03849000
CVTTCASP EQU   CVTS01+664                                               03850000
CVT0PT03 EQU   CVTS01+660                                               03851000
CVT0PT0E EQU   CVTS01+656                                               03852000
CVTRV609 EQU   CVTS01+652                                               03853000
CVTCGK   EQU   CVTS01+648                                               03854000
CVTRAC   EQU   CVTS01+644                                               03855000
CVTHSM   EQU   CVTS01+640                                               03856000
CVTRV605 EQU   CVTS01+636                                               03857000
CVTRV604 EQU   CVTS01+632                                               03858000
CVTEFF02 EQU   CVTS01+628                                               03859000
CVTCBBR  EQU   CVTS01+624                                               03860000
CVTSSCR  EQU   CVTS01+620                                               03861000
CVTEVENT EQU   CVTS01+616                                               03862000
CVTCRCA  EQU   CVTS01+612                                               03863000
CVTTPIO  EQU   CVTS01+608                                               03864000
CVTADV   EQU   CVTS01+604                                               03865000
CVTGSDAB EQU   CVTGSDA                                                  03866000
CVTQV3   EQU   CVTS01+596                                               03867000
CVTQV2   EQU   CVTS01+592                                               03868000
CVTQV1   EQU   CVTS01+588                                               03869000
CVTRPT   EQU   CVTS01+584                                               03870000
CVTSSRB  EQU   CVTS01+580                                               03871000
CVTCSDRL EQU   CVTS01+576                                               03872000
CVTEXP1  EQU   CVTS01+572                                               03873000
CVTRMPMT EQU   CVTS01+568                                               03874000
CVTRMPTT EQU   CVTS01+564                                               03875000
CVTVPSA  EQU   CVTS01+560                                               03876000
CVTVSTOP EQU   CVTS01+556                                               03877000
CVTGTFR8 EQU   CVTS01+552                                               03878000
CVTQUIT  EQU   CVTS01+548                                               03879000
CVTVACR  EQU   CVTS01+544                                               03880000
CVTWTCB  EQU   CVTS01+540                                               03881000
CVTSTPRS EQU   CVTS01+536                                               03882000
CVT0PT02 EQU   CVTS01+532                                               03883000
CVTDARCM EQU   CVTS01+528                                               03884000
CVTIRECM EQU   CVTS01+524                                               03885000
CVTJRECM EQU   CVTS01+520                                               03886000
CVTVEMS0 EQU   CVTS01+516                                               03887000
CVTSPFRR EQU   CVTS01+512                                               03888000
CVTRLSTG EQU   CVTS01+508                                               03889000
CVT0TC0A EQU   CVTS01+504                                               03890000
CVTGMBR  EQU   CVTS01+500                                               03891000
CVTLFRM  EQU   CVTS01+496                                               03892000
CVTRMBR  EQU   CVTS01+492                                               03893000
CVTVIOP  EQU   CVTS01+488                                               03894000
CVTRV307 EQU   CVTS01+486                                               03895000
CVTRV306 EQU   CVTS01+484                                               03896000
CVTRV305 EQU   CVTS01+482                                               03897000
CVTRV304 EQU   CVTS01+480                                               03898000
CVTRV303 EQU   CVTS01+478                                               03899000
CVTRV302 EQU   CVTS01+476                                               03900000
CVTTRCA  EQU   CVTS01+472                                               03901000
CVTRV297 EQU   CVTRV289                                                 03902000
CVTRV296 EQU   CVTRV289                                                 03903000
CVTRV295 EQU   CVTRV289                                                 03904000
CVTRV294 EQU   CVTRV289                                                 03905000
CVTRV293 EQU   CVTRV289                                                 03906000
CVTRV292 EQU   CVTRV289                                                 03907000
CVTRV291 EQU   CVTRV289                                                 03908000
CVTRV290 EQU   CVTRV289                                                 03909000
CVTRV288 EQU   CVTRV280                                                 03910000
CVTRV287 EQU   CVTRV280                                                 03911000
CVTRV286 EQU   CVTRV280                                                 03912000
CVTRV285 EQU   CVTRV280                                                 03913000
CVTRV284 EQU   CVTRV280                                                 03914000
CVTRV283 EQU   CVTRV280                                                 03915000
CVTRV282 EQU   CVTRV280                                                 03916000
CVTRV281 EQU   CVTRV280                                                 03917000
CVTRV279 EQU   CVTRV271                                                 03918000
CVTRV278 EQU   CVTRV271                                                 03919000
CVTRV277 EQU   CVTRV271                                                 03920000
CVTRV276 EQU   CVTRV271                                                 03921000
CVTRV275 EQU   CVTRV271                                                 03922000
CVTRV274 EQU   CVTRV271                                                 03923000
CVTRV273 EQU   CVTRV271                                                 03924000
CVTRV272 EQU   CVTRV271                                                 03925000
CVTRV270 EQU   CVTRV262                                                 03926000
CVTRV269 EQU   CVTRV262                                                 03927000
CVTRV268 EQU   CVTRV262                                                 03928000
CVTRV267 EQU   CVTRV262                                                 03929000
CVTRV266 EQU   CVTRV262                                                 03930000
CVTRV265 EQU   CVTRV262                                                 03931000
CVTRV264 EQU   CVTRV262                                                 03932000
CVTRV263 EQU   CVTRV262                                                 03933000
CVTVFP   EQU   CVTS01+464                                               03934000
CVTVSI   EQU   CVTS01+460                                               03935000
CVTVPSIB EQU   CVTS01+456                                               03936000
CVTMFACT EQU   CVTMFRTR                                                 03937000
CVTMFCTL EQU   CVTS01+448                                               03938000
CVTPVBP  EQU   CVTS01+444                                               03939000
CVTPWI   EQU   CVTS01+440                                               03940000
CVTRV254 EQU   CVTS01+438                                               03941000
CVTRV253 EQU   CVTS01+436                                               03942000
CVTRV252 EQU   CVTS01+434                                               03943000
CVTRV251 EQU   CVTS01+433                                               03944000
CVTRV250 EQU   CVTS01+432                                               03945000
CVTRV249 EQU   CVTS01+431                                               03946000
CVTRV248 EQU   CVTS01+430                                               03947000
CVTRV247 EQU   CVTS01+429                                               03948000
CVTRV246 EQU   CVTS01+428                                               03949000
CVTRV245 EQU   CVTRV237                                                 03950000
CVTRV244 EQU   CVTRV237                                                 03951000
CVTRV243 EQU   CVTRV237                                                 03952000
CVTRV242 EQU   CVTRV237                                                 03953000
CVTRV241 EQU   CVTRV237                                                 03954000
CVTRV240 EQU   CVTRV237                                                 03955000
CVTRV239 EQU   CVTRV237                                                 03956000
CVTRV238 EQU   CVTRV237                                                 03957000
CVTRV236 EQU   CVTRV228                                                 03958000
CVTRV235 EQU   CVTRV228                                                 03959000
CVTRV234 EQU   CVTRV228                                                 03960000
CVTRV233 EQU   CVTRV228                                                 03961000
CVTRV232 EQU   CVTRV228                                                 03962000
CVTRV231 EQU   CVTRV228                                                 03963000
CVTRV230 EQU   CVTRV228                                                 03964000
CVTRV229 EQU   CVTRV228                                                 03965000
CVTRV227 EQU   CVTRV219                                                 03966000
CVTRV226 EQU   CVTRV219                                                 03967000
CVTRV225 EQU   CVTRV219                                                 03968000
CVTRV224 EQU   CVTRV219                                                 03969000
CVTRV223 EQU   CVTRV219                                                 03970000
CVTRV222 EQU   CVTRV219                                                 03971000
CVTRV221 EQU   CVTRV219                                                 03972000
CVTRV220 EQU   CVTRV219                                                 03973000
CVTRV218 EQU   CVTRV210                                                 03974000
CVTRV217 EQU   CVTRV210                                                 03975000
CVTRV216 EQU   CVTRV210                                                 03976000
CVTRV215 EQU   CVTRV210                                                 03977000
CVTRV214 EQU   CVTRV210                                                 03978000
CVTRV213 EQU   CVTRV210                                                 03979000
CVTRV212 EQU   CVTRV210                                                 03980000
CVTRV211 EQU   CVTRV210                                                 03981000
CVTLCCAT EQU   CVTS01+420                                               03982000
CVTPCCAT EQU   CVTS01+416                                               03983000
CVTIPCRP EQU   CVTS01+412                                               03984000
CVTIPCRI EQU   CVTS01+408                                               03985000
CVTIPCDS EQU   CVTS01+404                                               03986000
CVTAIDVT EQU   CVTS01+400                                               03987000
CVTSSAP  EQU   CVTS01+396                                               03988000
CVTEHCIR EQU   CVTS01+392                                               03989000
CVTEHDEF EQU   CVTS01+388                                               03990000
CVTDAIR  EQU   CVTS01+384                                               03991000
CVTPERFM EQU   CVTS01+380                                               03992000
CVT044R2 EQU   CVTS01+376                                               03993000
CVTFETCH EQU   CVTS01+372                                               03994000
CVTRSTWD EQU   CVTS01+368                                               03995000
CVTSPOST EQU   CVTS01+364                                               03996000
CVTIOBP  EQU   CVTS01+360                                               03997000
CVTASMVT EQU   CVTS01+356                                               03998000
CVTRECRQ EQU   CVTS01+352                                               03999000
CVTWSAC  EQU   CVTS01+348                                               04000000
CVTRV149 EQU   CVTS01+344                                               04001000
CVTWSAL  EQU   CVTS01+340                                               04002000
CVTSPSA  EQU   CVTS01+336                                               04003000
CVTGLMN  EQU   CVTS01+332                                               04004000
CVTVEAC0 EQU   CVTS01+328                                               04005000
CVT062R1 EQU   CVTS01+324                                               04006000
CVTRPOST EQU   CVTS01+320                                               04007000
CVTDQIQE EQU   CVTS01+316                                               04008000
CVTCSD   EQU   CVTS01+312                                               04009000
CVTLKRMA EQU   CVTS01+308                                               04010000
CVTRSPIE EQU   CVTS01+304                                               04011000
CVTRENQ  EQU   CVTS01+300                                               04012000
CVTLQCB  EQU   CVTS01+296                                               04013000
CVTFQCB  EQU   CVTS01+292                                               04014000
CVTQCS01 EQU   CVTS01+288                                               04015000
CVTAPFT  EQU   CVTS01+284                                               04016000
CVTPARRL EQU   CVTS01+280                                               04017000
CVTVWAIT EQU   CVTS01+276                                               04018000
CVTGSPL  EQU   CVTS01+272                                               04019000
CVTLSMQ  EQU   CVTS01+268                                               04020000
CVTGSMQ  EQU   CVTS01+264                                               04021000
CVTEXPRO EQU   CVTS01+260                                               04022000
CVTOPCTP EQU   CVTS01+256                                               04023000
CVTSIC   EQU   CVTS01+252                                               04024000
CVTTPIOS EQU   CVTS01+248                                               04025000
CVTRTMS  EQU   CVTS01+244                                               04026000
CVTSDBF  EQU   CVTS01+240                                               04027000
CVTSCBP  EQU   CVTS01+236                                               04028000
CVTSDMP  EQU   CVTS01+232                                               04029000
CVTSV60  EQU   CVTS01+228                                               04030000
CVTRTMCT EQU   CVTS01+224                                               04031000
CVTASCBL EQU   CVTS01+220                                               04032000
CVTASCBH EQU   CVTS01+216                                               04033000
CVTGDA   EQU   CVTS01+212                                               04034000
CVTASVT  EQU   CVTS01+208                                               04035000
CVTVVMDI EQU   CVTS01+204                                               04036000
CVTAQTOP EQU   CVTS01+200                                               04037000
CVTIOSCS EQU   CVTS01+196                                               04038000
CVTSDRM  EQU   CVTS01+192                                               04039000
CVTOPTE  EQU   CVTS01+188                                               04040000
CVTSTXU  EQU   CVTS01+184                                               04041000
CVTQUIS  EQU   CVTS01+180                                               04042000
CVTPARS  EQU   CVTS01+176                                               04043000
CVTS1EE  EQU   CVTS01+172                                               04044000
CVTFRAS  EQU   CVTS01+168                                               04045000
CVTQSAS  EQU   CVTS01+164                                               04046000
CVTCRAS  EQU   CVTS01+160                                               04047000
CVTCRMN  EQU   CVTS01+156                                               04048000
CVTDELCP EQU   CVTS01+152                                               04049000
CVTFRECL EQU   CVTS01+148                                               04050000
CVTGETCL EQU   CVTS01+144                                               04051000
CVTBLDCP EQU   CVTS01+140                                               04052000
CVTAUTHL EQU   CVTS01+136                                               04053000
CVTSCAN  EQU   CVTS01+132                                               04054000
CVTRV144 EQU   CVTS01+130                                               04055000
CVTMAXMP EQU   CVTS01+128                                               04056000
CVTSTCK  EQU   CVTS01+124                                               04057000
CVTRV139 EQU   CVTS01+123                                               04058000
CVTDSSAC EQU   CVTS01+122                                               04059000
CVTRV513 EQU   CVTS01+121                                               04060000
CVTIOSPL EQU   CVTS01+120                                               04061000
CVTPTGT  EQU   CVTS01+116                                               04062000
CVTCSPIE EQU   CVTS01+112                                               04063000
CVTSMFEX EQU   CVTS01+108                                               04064000
CVTOLT0A EQU   CVTS01+104                                               04065000
CVTSRBRT EQU   CVTS01+100                                               04066000
CVTPUTL  EQU   CVTS01+96                                                04067000
CVTASCRL EQU   CVTS01+92                                                04068000
CVTASCRF EQU   CVTS01+88                                                04069000
CVTRV326 EQU   CVTS01+84                                                04070000
CVTRV325 EQU   CVTS01+80                                                04071000
CVTRV324 EQU   CVTS01+76                                                04072000
CVT0VL01 EQU   CVTS01+72                                                04073000
CVTSHRVM EQU   CVTS01+68                                                04074000
CVTRV332 EQU   CVTS01+64                                                04075000
CVTTAS   EQU   CVTS01+60                                                04076000
CVTRSCN  EQU   CVTS01+56                                                04077000
CVTTRAC2 EQU   CVTS01+54                                                04078000
CVTTRACE EQU   CVTS01+52                                                04079000
CVTAPG   EQU   CVTS01+51                                                04080000
CVTSDTRC EQU   CVTCTLFG                                                 04081000
CVTGTRCE EQU   CVTCTLFG                                                 04082000
CVTNOMP  EQU   CVTCTLFG                                                 04083000
CVTRSV79 EQU   CVTCTLFG                                                 04084000
CVTDSTAT EQU   CVTCTLFG                                                 04085000
CVTRSV78 EQU   CVTCTLFG                                                 04086000
CVTRV333 EQU   CVTCTLFG                                                 04087000
CVTRV323 EQU   CVTCTLFG                                                 04088000
CVTSPVLK EQU   CVTS01+49                                                04089000
CVTRSV77 EQU   CVTS01+48                                                04090000
CVTRV331 EQU   CVTS01+44                                                04091000
CVTRV330 EQU   CVTS01+40                                                04092000
CVTRV329 EQU   CVTS01+36                                                04093000
CVTRV328 EQU   CVTS01+32                                                04094000
CVTRV322 EQU   CVTS01+28                                                04095000
CVTSLID  EQU   CVTSLIDA+1                                               04096000
CVTSYLK  EQU   CVTSLIDA                                                 04097000
CVTRV321 EQU   CVTS01+20                                                04098000
CVTRV320 EQU   CVTS01+16                                                04099000
CVTLPDIR EQU   CVTLPDIA+1                                               04100000
CVTRSV69 EQU   CVTDIRST                                                 04101000
CVTRSV68 EQU   CVTDIRST                                                 04102000
CVTRSV67 EQU   CVTDIRST                                                 04103000
CVTRSV66 EQU   CVTDIRST                                                 04104000
CVTRSV65 EQU   CVTDIRST                                                 04105000
CVTRSV64 EQU   CVTDIRST                                                 04106000
CVTRSV63 EQU   CVTDIRST                                                 04107000
CVTDICOM EQU   CVTDIRST                                                 04108000
CVTPVTP  EQU   CVTS01+8                                                 04109000
CVTLPDSR EQU   CVTS01+4                                                 04110000
CVTGETL  EQU   CVTS01                                                   04111000
JFCBEND  EQU   JFCBS001+58                                              04112000
JFCBSPTN EQU   JFCBS001+57                                              04113000
JFCBVLCT EQU   JFCBS001+56                                              04114000
JFCBSBNM EQU   JFCBS001+50                                              04115000
JFCBRV08 EQU   JFCBSPNM+1                                               04116000
JFCBRV07 EQU   JFCBFLG3                                                 04117000
JFCBRV06 EQU   JFCBFLG3                                                 04118000
JFCBRV05 EQU   JFCBFLG3                                                 04119000
JFCBRV04 EQU   JFCBFLG3                                                 04120000
JFCBRV03 EQU   JFCBFLG3                                                 04121000
JFCBRV02 EQU   JFCBFLG3                                                 04122000
JFCBRV01 EQU   JFCBFLG3                                                 04123000
JFCDQDSP EQU   JFCBFLG3                                                 04124000
JFCBDQTY EQU   JFCBS001+42                                              04125000
JFCBUAFF EQU   JFCFLGS1                                                 04126000
JFCRSV45 EQU   JFCFLGS1                                                 04127000
JFCVRDS  EQU   JFCFLGS1                                                 04128000
JFCBCEOV EQU   JFCFLGS1                                                 04129000
JFCRSV42 EQU   JFCFLGS1                                                 04130000
JFCBADSP EQU   JFCFLGS1                                                 04131000
JFCTOPEN EQU   JFCFLGS1                                                 04132000
JFCBDLET EQU   JFCFLGS1                                                 04133000
JFCRQID  EQU   JFCBSQTY                                                 04134000
JFCROUND EQU   JFCBCTRI                                                 04135000
JFCRSV29 EQU   JFCBCTRI                                                 04136000
JFCRUNIT EQU   JFCBPQTY                                                 04137000
JFCBEXAD EQU   JFCBS001+31                                              04138000
JFCBEXTL EQU   JFCBS001+30                                              04139000
@NM00052 EQU   JFCBS001                                                 04140000
JFCONE   EQU   JFCMODE                                                  04141000
JFCTWO   EQU   JFCMODE                                                  04142000
JFCRSV07 EQU   JFCMODE                                                  04143000
JFCRSV06 EQU   JFCMODE                                                  04144000
JFCMODER EQU   JFCMODE                                                  04145000
JFCMODEO EQU   JFCMODE                                                  04146000
JFCEBCD  EQU   JFCMODE                                                  04147000
JFCBIN   EQU   JFCMODE                                                  04148000
UCBRV066 EQU   UCBOBS09+4                                               04149000
UCBIOSBA EQU   UCBOBS09                                                 04150000
UCBRV042 EQU   UCBOBS08+5                                               04151000
UCBCTCF1 EQU   UCBOBS08+4                                               04152000
UCBCTCAD EQU   UCBOBS08                                                 04153000
UCBICNCB EQU   UCBOBS07+4                                               04154000
UCBRV040 EQU   UCBOBS07                                                 04155000
UCBCTLNA EQU   UCBCTLNK+1                                               04156000
UCBRLN   EQU   UCBCTLNK                                                 04157000
UCBRDYQA EQU   UCBLDNCB                                                 04158000
UCBINRLN EQU   UCBIRLN                                                  04159000
UCBIRBA  EQU   UCBIRB+1                                                 04160000
UCBRV039 EQU   UCBGRAF                                                  04161000
UCBDWNR  EQU   UCBGRAF                                                  04162000
UCBRPND  EQU   UCBGRAF                                                  04163000
UCBUPM   EQU   UCBGRAF                                                  04164000
UCBBTAM  EQU   UCBGRAF                                                  04165000
UCBDRNO  EQU   UCBGRAF                                                  04166000
UCBDRO   EQU   UCBGRAF                                                  04167000
UCBOIP   EQU   UCBGRAF                                                  04168000
UCBATRCD EQU   @NM00026                                                 04169000
UCBSKPFG EQU   @NM00026                                                 04170000
UCBRIPND EQU   @NM00026                                                 04171000
UCBRTIAC EQU   @NM00026                                                 04172000
UCBRSV79 EQU   @NM00026                                                 04173000
UCBRSV78 EQU   @NM00026                                                 04174000
UCBRSV77 EQU   @NM00026                                                 04175000
UCBOLTEP EQU   @NM00026                                                 04176000
UCBATNCT EQU   UCBOBS06+2                                               04177000
UCBRSV76 EQU   UCBAOF2                                                  04178000
UCBRSV75 EQU   UCBAOF2                                                  04179000
UCBRSV74 EQU   UCBAOF2                                                  04180000
UCBRSV73 EQU   UCBAOF2                                                  04181000
UCBRSV72 EQU   UCBAOF2                                                  04182000
UCBRSV71 EQU   UCBAOF2                                                  04183000
UCBRSV70 EQU   UCBAOF2                                                  04184000
UCBRSV69 EQU   UCBAOF2                                                  04185000
UCBRSV68 EQU   UCBAOF1                                                  04186000
UCBRSV67 EQU   UCBAOF1                                                  04187000
UCBRSV66 EQU   UCBAOF1                                                  04188000
UCBRSV65 EQU   UCBAOF1                                                  04189000
UCBRSV64 EQU   UCBAOF1                                                  04190000
UCBOFNL  EQU   UCBAOF1                                                  04191000
UCBOFSP  EQU   UCBAOF1                                                  04192000
UCBOFMCR EQU   UCBAOF1                                                  04193000
UCBBTB   EQU   UCBBTA+1                                                 04194000
UCBDI    EQU   UCBBTA                                                   04195000
UCBSNS   EQU   UCBOBS04+8                                               04196000
UCBTEB   EQU   UCBOBS04+4                                               04197000
UCBGCB   EQU   UCBOBS04+3                                               04198000
UCBOPEN  EQU   UCBOBS04+2                                               04199000
UCBSTART EQU   UCBOBS04                                                 04200000
UCBXTNB  EQU   UCBXTN+1                                                 04201000
UCBRSV22 EQU   UCBVOPT                                                  04202000
UCBRSV21 EQU   UCBVOPT                                                  04203000
UCBRSV20 EQU   UCBVOPT                                                  04204000
UCBESVE  EQU   UCBVOPT                                                  04205000
UCBERPC  EQU   UCBVOPT                                                  04206000
UCBESVC  EQU   UCBVOPT                                                  04207000
UCBEVA   EQU   UCBVOPT                                                  04208000
UCBESV   EQU   UCBVOPT                                                  04209000
UCBRV009 EQU   UCBTFL1                                                  04210000
UCBRV008 EQU   UCBTFL1                                                  04211000
UCBRV007 EQU   UCBTFL1                                                  04212000
UCBRV006 EQU   UCBTFL1                                                  04213000
UCBRV005 EQU   UCBTFL1                                                  04214000
UCBRV038 EQU   UCBTFL1                                                  04215000
UCBNSLTP EQU   UCBTFL1                                                  04216000
UCBNLTP  EQU   UCBTFL1                                                  04217000
UCBRES1B EQU   UCBOBS02+18                                              04218000
UCBFSER  EQU   UCBOBS02+12                                              04219000
@NM00025 EQU   UCBOBS02+4                                               04220000
UCBFSEQ  EQU   UCBOBS02+2                                               04221000
UCBFSCT  EQU   UCBOBS02                                                 04222000
UCBNEXP  EQU   UCBOBS01+20                                              04223000
UCBBASE  EQU   UCBOBS01+16                                              04224000
UCBRES1A EQU   UCBOBS01+15                                              04225000
UCBUSER  EQU   UCBOBS01+14                                              04226000
UCBFL47  EQU   UCBFL4                                                   04227000
UCBFL46  EQU   UCBFL4                                                   04228000
UCBFL45  EQU   UCBFL4                                                   04229000
UCBRV065 EQU   UCBFL4                                                   04230000
UCBDSS   EQU   UCBFL4                                                   04231000
UCBRV028 EQU   UCBFL4                                                   04232000
UCBWDAV  EQU   UCBFL4                                                   04233000
UCBDAVV  EQU   UCBFL4                                                   04234000
UCBSQC   EQU   UCBOBS01+12                                              04235000
UCBDATP  EQU   UCBOBS01+12                                              04236000
UCBDMC   EQU   UCBDMCT                                                  04237000
UCBMOUNT EQU   UCBDMCT                                                  04238000
UCBBNUL  EQU   UCBSTAB                                                  04239000
UCBSHAR  EQU   UCBSTAB                                                  04240000
UCBBSTR  EQU   UCBSTAB                                                  04241000
UCBBPUB  EQU   UCBSTAB                                                  04242000
UCBBPRV  EQU   UCBSTAB                                                  04243000
UCBBALB  EQU   UCBPRSRS                                                 04244000
UCBPGFL  EQU   UCBSTAB                                                  04245000
UCBDVSHR EQU   UCBBSVL                                                  04246000
UCBVTOC  EQU   UCBOBS01                                                 04247000
@NM00017 EQU   VINDX                                                    04248000
JFCRSV32 EQU   JFCCODE                                                  04249000
JFCTTY   EQU   JFCCODE                                                  04250000
JFCASCII EQU   JFCCODE                                                  04251000
JFCNCR   EQU   JFCCODE                                                  04252000
JFCBUR   EQU   JFCCODE                                                  04253000
JFCFRI   EQU   JFCCODE                                                  04254000
JFCBCD   EQU   JFCCODE                                                  04255000
JFCNOCON EQU   JFCCODE                                                  04256000
JFCBNTCS EQU   JFCUCSEG+8                                               04257000
JFCSOWA  EQU   JFCOUTLI+1                                               04258000
JFCSEND  EQU   JFCCPRI                                                  04259000
JFCEQUAL EQU   JFCCPRI                                                  04260000
JFCRECV  EQU   JFCCPRI                                                  04261000
JFCRSV34 EQU   JFCCPRI                                                  04262000
JFCRSV33 EQU   JFCCPRI                                                  04263000
JFCRSV55 EQU   JFCCPRI                                                  04264000
JFCRSV54 EQU   JFCCPRI                                                  04265000
JFCRSV53 EQU   JFCCPRI                                                  04266000
JFCRSV27 EQU   JFCUCSOP                                                 04267000
JFCRSV26 EQU   JFCUCSOP                                                 04268000
JFCFCBVR EQU   JFCUCSOP                                                 04269000
JFCFCBAL EQU   JFCUCSOP                                                 04270000
JFCVER   EQU   JFCUCSOP                                                 04271000
JFCRSV25 EQU   JFCUCSOP                                                 04272000
JFCFOLD  EQU   JFCUCSOP                                                 04273000
JFCBEXTP EQU   JFCUCSOP                                                 04274000
JFCUCSID EQU   JFCUCSEG                                                 04275000
JFCINTVL EQU   JFCSPPRT+19                                              04276000
JFCDBUFN EQU   JFCRESRV+3                                               04277000
JFCCYLOF EQU   JFCRESRV+2                                               04278000
JFCRKP   EQU   JFCRESRV                                                 04279000
JFCPCIR2 EQU   JFCPCI                                                   04280000
JFCPCIR1 EQU   JFCPCI                                                   04281000
JFCPCIN2 EQU   JFCPCI                                                   04282000
JFCPCIN1 EQU   JFCPCI                                                   04283000
JFCPCIA2 EQU   JFCPCI                                                   04284000
JFCPCIA1 EQU   JFCPCI                                                   04285000
JFCPCIX2 EQU   JFCPCI                                                   04286000
JFCPCIX1 EQU   JFCPCI                                                   04287000
JFCBUFMX EQU   JFCNCP                                                   04288000
JFCLRECL EQU   JFCAMSYN                                                 04289000
JFCBAXBF EQU   JFCBUFSI                                                 04290000
JFCREL   EQU   JFCREORG                                                 04291000
JFCRSV22 EQU   JFCDEL                                                   04292000
JFCSRCHD EQU   JFCRSV20                                                 04293000
JFCOPTQ  EQU   JFCACT                                                   04294000
JFCFEED  EQU   JFCIND                                                   04295000
JFCCBWU  EQU   JFCEXT                                                   04296000
JFCWUMSG EQU   JFCOVER                                                  04297000
JFCSDNAM EQU   JFCWVCBD                                                 04298000
@NM00051 EQU   JFCRECFM                                                 04299000
JFCCHAR  EQU   JFCRECFM                                                 04300000
JFCRFS   EQU   JFCRECFM                                                 04301000
JFCRFB   EQU   JFCRECFM                                                 04302000
JFCFMREC EQU   JFCRCFM                                                  04303000
JFCRSV16 EQU   JFCDSRG2                                                 04304000
JFCRSV15 EQU   JFCDSRG2                                                 04305000
JFCORGTR EQU   JFCDSRG2                                                 04306000
JFCORGAM EQU   JFCDSRG2                                                 04307000
JFCRSV13 EQU   JFCDSRG2                                                 04308000
JFCORGTQ EQU   JFCDSRG2                                                 04309000
JFCORGTX EQU   JFCDSRG2                                                 04310000
JFCORGGS EQU   JFCDSRG2                                                 04311000
JFCORGU  EQU   JFCDSRG1                                                 04312000
JFCORGMQ EQU   JFCDSRG1                                                 04313000
JFCORGCQ EQU   JFCDSRG1                                                 04314000
JFCORGCX EQU   JFCDSRG1                                                 04315000
JFCORGDA EQU   JFCDSRG1                                                 04316000
JFCORGPS EQU   JFCDSRG1                                                 04317000
JFCTRKBL EQU   JFCLIMCT+1                                               04318000
@NM00050 EQU   JFCLIMCT                                                 04319000
JFCDEN   EQU   JFCSPPRT+1                                               04320000
JFCPRTSP EQU   JFCSPPRT                                                 04321000
MNTRES2  EQU   ICBMTLST+21                                              04322000
@NM00063 EQU   MDFLG                                                    04323000
MDMEXT   EQU   MDFLG                                                    04324000
MDVISMNT EQU   MDFLG                                                    04325000
@NM00062 EQU   MDFLG                                                    04326000
MNTRES1  EQU   ICBMTLST+5                                               04327000
CVTLEVL  EQU   CVTRELNO+2                                               04328000
CVTNUMB  EQU   CVTRELNO                                                 04329000
CVTMDL   EQU   CVTFIX+250                                               04330000
@NM00061 EQU   CVTFIX+248                                               04331000
@NM00060 EQU   CVTFIX                                                   04332000
CVTRV482 EQU   CVTXTNT2+128                                             04333000
CVTRV481 EQU   CVTXTNT2+124                                             04334000
CVTRV480 EQU   CVTXTNT2+120                                             04335000
CVTRV479 EQU   CVTXTNT2+118                                             04336000
CVTRV478 EQU   CVTXTNT2+117                                             04337000
CVTRV477 EQU   CVTXTNT2+116                                             04338000
CVTRV476 EQU   CVTXTNT2+115                                             04339000
CVTRV475 EQU   CVTXTNT2+114                                             04340000
CVTRV474 EQU   CVTRV466                                                 04341000
CVTRV473 EQU   CVTRV466                                                 04342000
CVTRV472 EQU   CVTRV466                                                 04343000
CVTRV471 EQU   CVTRV466                                                 04344000
CVTRV470 EQU   CVTRV466                                                 04345000
CVTRV469 EQU   CVTRV466                                                 04346000
CVTRV468 EQU   CVTRV466                                                 04347000
CVTRV467 EQU   CVTRV466                                                 04348000
CVTRV465 EQU   CVTRV457                                                 04349000
CVTRV464 EQU   CVTRV457                                                 04350000
CVTRV463 EQU   CVTRV457                                                 04351000
CVTRV462 EQU   CVTRV457                                                 04352000
CVTRV461 EQU   CVTRV457                                                 04353000
CVTRV460 EQU   CVTRV457                                                 04354000
CVTRV459 EQU   CVTRV457                                                 04355000
CVTRV458 EQU   CVTRV457                                                 04356000
CVTRV456 EQU   CVTXTNT2+108                                             04357000
CVTRV455 EQU   CVTXTNT2+104                                             04358000
CVTRV454 EQU   CVTXTNT2+100                                             04359000
CVTRV453 EQU   CVTXTNT2+96                                              04360000
CVTRV452 EQU   CVTXTNT2+94                                              04361000
CVTRV451 EQU   CVTXTNT2+92                                              04362000
CVTRV450 EQU   CVTXTNT2+90                                              04363000
CVTRV449 EQU   CVTXTNT2+88                                              04364000
CVTRV448 EQU   CVTXTNT2+87                                              04365000
CVTRV447 EQU   CVTXTNT2+86                                              04366000
CVTRV446 EQU   CVTRV438                                                 04367000
CVTRV445 EQU   CVTRV438                                                 04368000
CVTRV444 EQU   CVTRV438                                                 04369000
CVTRV443 EQU   CVTRV438                                                 04370000
CVTRV442 EQU   CVTRV438                                                 04371000
CVTRV441 EQU   CVTRV438                                                 04372000
CVTRV440 EQU   CVTRV438                                                 04373000
CVTRV439 EQU   CVTRV438                                                 04374000
CVTRV437 EQU   CVTRV429                                                 04375000
CVTRV436 EQU   CVTRV429                                                 04376000
CVTRV435 EQU   CVTRV429                                                 04377000
CVTRV434 EQU   CVTRV429                                                 04378000
CVTRV433 EQU   CVTRV429                                                 04379000
CVTRV432 EQU   CVTRV429                                                 04380000
CVTRV431 EQU   CVTRV429                                                 04381000
CVTRV430 EQU   CVTRV429                                                 04382000
CVTRV428 EQU   CVTXTNT2+80                                              04383000
CVTRV427 EQU   CVTXTNT2+76                                              04384000
CVTRV426 EQU   CVTXTNT2+72                                              04385000
CVTRV425 EQU   CVTXTNT2+68                                              04386000
CVTATACT EQU   CVTATCVT                                                 04387000
CVTRV423 EQU   CVTXTNT2+62                                              04388000
CVTRV422 EQU   CVTXTNT2+60                                              04389000
CVTRV421 EQU   CVTXTNT2+58                                              04390000
CVTRV420 EQU   CVTXTNT2+56                                              04391000
CVTRV419 EQU   CVTXTNT2+55                                              04392000
CVTRV418 EQU   CVTXTNT2+54                                              04393000
CVTRV417 EQU   CVTRV409                                                 04394000
CVTRV416 EQU   CVTRV409                                                 04395000
CVTRV415 EQU   CVTRV409                                                 04396000
CVTRV414 EQU   CVTRV409                                                 04397000
CVTRV413 EQU   CVTRV409                                                 04398000
CVTRV412 EQU   CVTRV409                                                 04399000
CVTRV411 EQU   CVTRV409                                                 04400000
CVTRV410 EQU   CVTRV409                                                 04401000
CVTRV408 EQU   CVTRV400                                                 04402000
CVTRV407 EQU   CVTRV400                                                 04403000
CVTRV406 EQU   CVTRV400                                                 04404000
CVTRV405 EQU   CVTRV400                                                 04405000
CVTRV404 EQU   CVTRV400                                                 04406000
CVTRV403 EQU   CVTRV400                                                 04407000
CVTRV402 EQU   CVTRV400                                                 04408000
CVTRV401 EQU   CVTRV400                                                 04409000
CVTSKTA  EQU   CVTXTNT2+44                                              04410000
CVTCCVT  EQU   CVTXTNT2+40                                              04411000
CVTRSV98 EQU   CVTXTNT2+36                                              04412000
CVTRSV97 EQU   CVTXTNT2+34                                              04413000
CVTRSV96 EQU   CVTXTNT2+32                                              04414000
CVTOLTEP EQU   CVTXTNT2+28                                              04415000
CVTQIDA  EQU   CVTQID+1                                                 04416000
CVTRSV95 EQU   CVTQID                                                   04417000
CVTRSV94 EQU   CVTXTNT2+20                                              04418000
CVTRSV93 EQU   CVTXTNT2+16                                              04419000
CVTRSV92 EQU   CVTXTNT2+12                                              04420000
CVTDEBVR EQU   CVTXTNT2+8                                               04421000
CVTRSV91 EQU   CVTXTNT2+6                                               04422000
CVTRSV9H EQU   CVTFLGBT                                                 04423000
CVTRSV9G EQU   CVTFLGBT                                                 04424000
CVTRSV9F EQU   CVTFLGBT                                                 04425000
CVTRSV9E EQU   CVTFLGBT                                                 04426000
CVTRSV9D EQU   CVTFLGBT                                                 04427000
CVTRSV9C EQU   CVTFLGBT                                                 04428000
CVTVME   EQU   CVTFLGBT                                                 04429000
CVTNPE   EQU   CVTFLGBT                                                 04430000
CVTNUCLS EQU   CVTXTNT2+4                                               04431000
CVTDSSVA EQU   CVTDSSV+1                                                04432000
CVTRSV89 EQU   CVTDSSV                                                  04433000
CVTRSV88 EQU   CVTXTNT1+8                                               04434000
CVTRSV87 EQU   CVTXTNT1+4                                               04435000
CVTFACHN EQU   CVTXTNT1                                                 04436000
CVTRV488 EQU   CVTMAP+412                                               04437000
CVTRV487 EQU   CVTMAP+408                                               04438000
CVTRV486 EQU   CVTMAP+404                                               04439000
CVTRV485 EQU   CVTMAP+400                                               04440000
CVTACTAP EQU   CVTMAP+396                                               04441000
CVTAUTH  EQU   CVTMAP+392                                               04442000
CVTATMCA EQU   CVTATMCT+1                                               04443000
CVTATMST EQU   CVTATMCT                                                 04444000
CVTRSV61 EQU   CVTMAP+384                                               04445000
CVTVOLT1 EQU   CVTVOLM1+1                                               04446000
CVTVOLI1 EQU   CVTVOLF1                                                 04447000
CVTSTOA  EQU   CVTMAP+376                                               04448000
CVTRSV58 EQU   CVTMAP+374                                               04449000
CVTRSV57 EQU   CVTMAP+372                                               04450000
CVTDDCE  EQU   CVTMAP+368                                               04451000
CVTPNWFR EQU   CVTMAP+364                                               04452000
CVTSMF   EQU   CVTMAP+360                                               04453000
CVTSULK  EQU   CVTMAP+358                                               04454000
CVTSLKO  EQU   CVTSYSK                                                  04455000
CVTSLKP  EQU   CVTSYSK                                                  04456000
CVTSLKQ  EQU   CVTSYSK                                                  04457000
CVTSLKR  EQU   CVTSYSK                                                  04458000
CVTRSV56 EQU   CVTSYSK                                                  04459000
CVTRSV55 EQU   CVTSYSK                                                  04460000
CVTRSV54 EQU   CVTSYSK                                                  04461000
CVTRSV53 EQU   CVTSYSK                                                  04462000
CVTRSV52 EQU   CVTA1F1                                                  04463000
CVTRSV51 EQU   CVTA1F1                                                  04464000
CVTRSV50 EQU   CVTA1F1                                                  04465000
CVTRSV49 EQU   CVTA1F1                                                  04466000
CVTRSV48 EQU   CVTA1F1                                                  04467000
CVTRSV47 EQU   CVTA1F1                                                  04468000
CVTSRSW  EQU   CVTA1F1                                                  04469000
CVTPFSW  EQU   CVTA1F1                                                  04470000
CVTPCVT  EQU   CVTMAP+352                                               04471000
CVTRSV46 EQU   CVTMAP+344                                               04472000
CVTRSV45 EQU   CVTMAP+340                                               04473000
CVTRSV44 EQU   CVTMAP+338                                               04474000
CVTRSV43 EQU   CVTMAP+336                                               04475000
CVTHJESA EQU   CVTHJES+1                                                04476000
CVTRSV42 EQU   CVTHJES                                                  04477000
CVTEXT2A EQU   CVTEXT2+1                                                04478000
CVTRSV41 EQU   CVTEXT2                                                  04479000
CVTAPFA  EQU   CVTAPF+1                                                 04480000
CVTRSV40 EQU   CVTAPF                                                   04481000
CVTRV518 EQU   CVTINTLA                                                 04482000
CVTRV517 EQU   CVTERPV                                                  04483000
CVTEORM  EQU   CVTMAP+312                                               04484000
CVTMCHPR EQU   CVTMAP+308                                               04485000
CVTTZ    EQU   CVTMAP+304                                               04486000
CVTJEPS  EQU   CVTMAP+300                                               04487000
CVTJESCT EQU   CVTMAP+296                                               04488000
CVTMODE  EQU   CVTMAP+292                                               04489000
CVTPTRV  EQU   CVTMAP+288                                               04490000
CVTREAL  EQU   CVTMAP+284                                               04491000
CVTRSV39 EQU   CVTMAP+280                                               04492000
CVTRSV38 EQU   CVTMAP+276                                               04493000
CVTDMSRA EQU   CVTDMSR+1                                                04494000
CVTRV634 EQU   CVTDMSRF                                                 04495000
CVTRV633 EQU   CVTDMSRF                                                 04496000
CVTRV632 EQU   CVTDMSRF                                                 04497000
CVTRV631 EQU   CVTDMSRF                                                 04498000
CVTRV630 EQU   CVTDMSRF                                                 04499000
CVTRV629 EQU   CVTDMSRF                                                 04500000
CVTUDUMP EQU   CVTDMSRF                                                 04501000
CVTSDUMP EQU   CVTDMSRF                                                 04502000
CVTQMSGA EQU   CVTQMSG+1                                                04503000
CVTRSV36 EQU   CVTQMSG                                                  04504000
CVTAMFF  EQU   CVTMAP+264                                               04505000
CVTPURGA EQU   CVTPURG+1                                                04506000
CVTRSV35 EQU   CVTPURG                                                  04507000
CVTCBSP  EQU   CVTMAP+256                                               04508000
CVTATERA EQU   CVTATER+1                                                04509000
CVTSYST  EQU   CVTATER                                                  04510000
CVTVOLT2 EQU   CVTTAT                                                   04511000
CVTVOLI2 EQU   CVTVOLF2                                                 04512000
CVTAQAVB EQU   CVTAQAVT+1                                               04513000
CVTRSV34 EQU   CVTTCMFG                                                 04514000
CVTRSV33 EQU   CVTTCMFG                                                 04515000
CVTRSV32 EQU   CVTTCMFG                                                 04516000
CVTRSV31 EQU   CVTTCMFG                                                 04517000
CVTRSV30 EQU   CVTTCMFG                                                 04518000
CVTRSV29 EQU   CVTTCMFG                                                 04519000
CVTLDEV  EQU   CVTTCMFG                                                 04520000
CVTTCRDY EQU   CVTTCMFG                                                 04521000
CVTGTFA  EQU   CVTGTF+1                                                 04522000
CVTRSV27 EQU   CVTGTFST                                                 04523000
CVTRNIO  EQU   CVTGTFST                                                 04524000
CVTUSR   EQU   CVTGTFST                                                 04525000
CVTRV318 EQU   CVTFORM                                                  04526000
CVTRV317 EQU   CVTTMODE                                                 04527000
CVTRV316 EQU   CVTSTATE                                                 04528000
CVTRV315 EQU   CVTGTFS                                                  04529000
CVTGTFAV EQU   CVTGTFS                                                  04530000
CVT0SCR1 EQU   CVTMAP+232                                               04531000
CVTRV515 EQU   CVTMAP+228                                               04532000
CVTRMS   EQU   CVTMAP+224                                               04533000
CVTPATCH EQU   CVTMAP+220                                               04534000
CVTTSCE  EQU   CVTMAP+216                                               04535000
CVTLNKSC EQU   CVTMAP+214                                               04536000
CVTQABST EQU   CVTMAP+212                                               04537000
CVTMDLDS EQU   CVTMAP+208                                               04538000
CVTUSER  EQU   CVTMAP+204                                               04539000
CVTABEND EQU   CVTMAP+200                                               04540000
CVTSMCA  EQU   CVTMAP+196                                               04541000
CVTRSV18 EQU   CVTMAP+192                                               04542000
CVTQLPAQ EQU   CVTMAP+188                                               04543000
CVTQCDSR EQU   CVTMAP+184                                               04544000
CVTRSV17 EQU   CVTOPTB                                                  04545000
CVTRSV16 EQU   CVTOPTB                                                  04546000
CVTFP    EQU   CVTOPTB                                                  04547000
CVTAPTHR EQU   CVTOPTB                                                  04548000
CVTNLOG  EQU   CVTOPTB                                                  04549000
CVTTOD   EQU   CVTOPTB                                                  04550000
CVTCTIMS EQU   CVTOPTB                                                  04551000
CVTPROT  EQU   CVTOPTB                                                  04552000
CVTXPFP  EQU   CVTOPTA                                                  04553000
CVTASCII EQU   CVTOPTA                                                  04554000
CVTRSV13 EQU   CVTOPTA                                                  04555000
CVTRSV12 EQU   CVTOPTA                                                  04556000
CVTNIP   EQU   CVTOPTA                                                  04557000
CVTDDR   EQU   CVTOPTA                                                  04558000
CVTAPR   EQU   CVTOPTA                                                  04559000
CVTCCH   EQU   CVTOPTA                                                  04560000
CVTSNCTR EQU   CVTMAP+180                                               04561000
CVTQMWR  EQU   CVTMAP+176                                               04562000
CVTQOCR  EQU   CVTMAP+172                                               04563000
CVT1EF00 EQU   CVTMAP+168                                               04564000
CVTMZ00  EQU   CVTMAP+164                                               04565000
CVTSV76Q EQU   CVTSV76C                                                 04566000
CVTRSV11 EQU   CVTMAP+156                                               04567000
CVT0PT01 EQU   CVTMAP+152                                               04568000
CVTMSER  EQU   CVTMAP+148                                               04569000
CVTRV516 EQU   CVTIERLC                                                 04570000
CVTILCH  EQU   CVTMAP+140                                               04571000
CVT0DS   EQU   CVTMAP+136                                               04572000
CVTFBOSV EQU   CVTMAP+132                                               04573000
CVTNUCB  EQU   CVTMAP+128                                               04574000
CVTSV76M EQU   CVTIOQET                                                 04575000
CVTDCBA  EQU   CVTMAP+117                                               04576000
CVTMVS2  EQU   CVTDCB                                                   04577000
CVT6DAT  EQU   CVTDCB                                                   04578000
CVT4MPS  EQU   CVTDCB                                                   04579000
CVTRSV09 EQU   CVTDCB                                                   04580000
CVT4MS1  EQU   CVTDCB                                                   04581000
CVT2SPS  EQU   CVTDCB                                                   04582000
CVT1SSS  EQU   CVTDCB                                                   04583000
CVTRSV08 EQU   CVTDCB                                                   04584000
CVTSTB   EQU   CVTMAP+112                                               04585000
CVTQTD00 EQU   CVTMAP+108                                               04586000
CVTQTE00 EQU   CVTMAP+104                                               04587000
CVTCUCB  EQU   CVTMAP+100                                               04588000
CVTSJQ   EQU   CVTMAP+96                                                04589000
CVTPBLDL EQU   CVTMAP+92                                                04590000
CVTTPC   EQU   CVTMAP+88                                                04591000
CVTSVDCB EQU   CVTMAP+84                                                04592000
CVTBRET  EQU   CVTMAP+82                                                04593000
CVTEXIT  EQU   CVTMAP+80                                                04594000
CVT0FN00 EQU   CVTMAP+76                                                04595000
CVTDARA  EQU   CVTDAR+1                                                 04596000
CVTRSV07 EQU   CVTFLGS1                                                 04597000
CVTRSV06 EQU   CVTFLGS1                                                 04598000
CVTRSV05 EQU   CVTFLGS1                                                 04599000
CVTRSV04 EQU   CVTFLGS1                                                 04600000
CVTRSV03 EQU   CVTFLGS1                                                 04601000
CVTRSV02 EQU   CVTFLGS1                                                 04602000
CVTRSV01 EQU   CVTFLGS1                                                 04603000
CVTDMPLK EQU   CVTFLGS1                                                 04604000
CVTXITP  EQU   CVTMAP+68                                                04605000
CVTZDTAB EQU   CVTMAP+64                                                04606000
CVTMSLT  EQU   CVTMAP+60                                                04607000
CVTBTERM EQU   CVTMAP+52                                                04608000
CVTSYSAD EQU   CVTMAP+48                                                04609000
CVTXTLER EQU   CVTMAP+44                                                04610000
CVTPRLTV EQU   CVTMAP+32                                                04611000
CVTPCNVT EQU   CVTMAP+28                                                04612000
CVT0VL00 EQU   CVTMAP+24                                                04613000
CVTXAPG  EQU   CVTMAP+20                                                04614000
CVTBUF   EQU   CVTMAP+16                                                04615000
CVTJOB   EQU   CVTMAP+12                                                04616000
CVTLINK  EQU   CVTMAP+8                                                 04617000
CVT0EF00 EQU   CVTMAP+4                                                 04618000
CVTTCBP  EQU   CVTMAP                                                   04619000
CVT      EQU   CVTMAP                                                   04620000
ICBLORD  EQU   ICBTRACE+256                                             04621000
ICBOTRC  EQU   ICBTRACE                                                 04622000
ICBRESV  EQU   ICB2SSCB+128                                             04623000
ICBVOLST EQU   ICB2SSCB+124                                             04624000
ICBVSCRA EQU   ICB2SSCB+120                                             04625000
ICBSAMP  EQU   ICB2SSCB+118                                             04626000
ICBRESVD EQU   ICB2SSCB+117                                             04627000
ICBFAB   EQU   ICB2SSCB+108                                             04628000
ICBMSSC  EQU   ICB2SSCB+104                                             04629000
ICBRSVP  EQU   ICB2SSCB+100                                             04630000
ICBAEAP  EQU   ICB2SSCB+96                                              04631000
ICBSIOBP EQU   ICB2SSCB+92                                              04632000
ICBIATNA EQU   ICB2SSCB+88                                              04633000
ICBIPRGA EQU   ICB2SSCB+84                                              04634000
ICBSRBP  EQU   ICB2SSCB+80                                              04635000
ICBVVICB EQU   ICB2SSCB+76                                              04636000
ICBVVIC  EQU   ICB2SSCB+72                                              04637000
ICBSIOP  EQU   ICB2SSCB+68                                              04638000
ICBMEP   EQU   ICB2SSCB+64                                              04639000
ICBIORCI EQU   ICB2SSCB+60                                              04640000
ICB2ACTP EQU   ICB2SSCB+56                                              04641000
ICBFG3   EQU   ICBFLG+2                                                 04642000
ICBFG2   EQU   ICBFLG+1                                                 04643000
@NM00059 EQU   ICBFG1                                                   04644000
ICBMSCA  EQU   ICBFG1                                                   04645000
ICBMSCMP EQU   ICBFG1                                                   04646000
ICBS     EQU   ICBFG1                                                   04647000
ICBB     EQU   ICBFG1                                                   04648000
ICBV     EQU   ICBFG1                                                   04649000
ICBR     EQU   ICBFG1                                                   04650000
ICBI     EQU   ICBFG1                                                   04651000
ICBNVT   EQU   ICBOPT                                                   04652000
ICBVN02P EQU   ICB2SSCB+44                                              04653000
ICBTCB   EQU   ICB2SSCB+40                                              04654000
ICBQHEAD EQU   ICB2SSCB+36                                              04655000
ICBAUCB  EQU   ICB2SSCB+32                                              04656000
ICBPUCB  EQU   ICB2SSCB+28                                              04657000
ICBCOMQ  EQU   ICB2SSCB+24                                              04658000
ICBIOR   EQU   ICB2SSCB+20                                              04659000
ICBCOM   EQU   ICB2SSCB+16                                              04660000
ICBACTV  EQU   ICB2SSCB+12                                              04661000
ICBECB   EQU   ICB2SSCB+8                                               04662000
ICBSSNAM EQU   ICB2SSCB                                                 04663000
@NM00058 EQU   MVR+82                                                   04664000
MVRLABEL EQU   MVR+76                                                   04665000
MVRBLNK1 EQU   MVR+75                                                   04666000
MVRBKUPN EQU   MVR+74                                                   04667000
MVRCSN   EQU   MVR+62                                                   04668000
MVRDES   EQU   MVR+28                                                   04669000
MVRGROUP EQU   MVR+20                                                   04670000
MVRFOR   EQU   MVR+18                                                   04671000
@NM00057 EQU   MVRFLAGA+2                                               04672000
MVRCICPY EQU   MVRFLAGA+2                                               04673000
MVRCIVCF EQU   MVRFLAGA+2                                               04674000
MVRCLMIS EQU   MVRFLAGA+1                                               04675000
MVRSLMIS EQU   MVRFLAGA+1                                               04676000
MVRNEXPD EQU   MVRFLAGA+1                                               04677000
MVRNDESC EQU   MVRFLAGA+1                                               04678000
MVRBKUP  EQU   MVRFLAGA+1                                               04679000
MVRNGRP  EQU   MVRFLAGA+1                                               04680000
MVRRSTD  EQU   MVRFLAGA+1                                               04681000
MVRGEN   EQU   MVRFLAGA+1                                               04682000
MVRFLLAB EQU   MVRFLAGA                                                 04683000
MVRFLBK  EQU   MVRFLAGA                                                 04684000
MVRFLCSN EQU   MVRFLAGA                                                 04685000
MVRFLDES EQU   MVRFLAGA                                                 04686000
MVRFLGRO EQU   MVRFLAGA                                                 04687000
MVRFLFOR EQU   MVRFLAGA                                                 04688000
@NM00056 EQU   MVRCODE+1                                                04689000
JFCBXNXT EQU   JFCBX+172                                                04690000
@NM00055 EQU   JFCBX+144                                                04691000
JFCBXDEV EQU   JFCBX+140                                                04692000
JFCBXNAM EQU   JFCBX+96                                                 04693000
@NM00054 EQU   JFCBX+94                                                 04694000
@NM00053 EQU   JFCBX+3                                                  04695000
JFCBXTTR EQU   JFCBX                                                    04696000
JFCRSV05 EQU   JFCEROPT                                                 04697000
JFCRSV04 EQU   JFCEROPT                                                 04698000
JFCRSV03 EQU   JFCEROPT                                                 04699000
JFCRSV02 EQU   JFCEROPT                                                 04700000
JFCTOPT  EQU   JFCEROPT                                                 04701000
JFCABN   EQU   JFCEROPT                                                 04702000
JFCSKP   EQU   JFCEROPT                                                 04703000
JFCACC   EQU   JFCEROPT                                                 04704000
JFCBUFL  EQU   JFCAMPTR+2                                               04705000
JFCFWORD EQU   JFCBFTEK                                                 04706000
JFCDWORD EQU   JFCBFTEK                                                 04707000
JFCHIER1 EQU   JFCBFTEK                                                 04708000
JFCDYN   EQU   JFCBFTEK                                                 04709000
JFCEXC   EQU   JFCBFTEK                                                 04710000
JFCBBFTR EQU   JFCBBFTA                                                 04711000
JFCSIM   EQU   JFCBBFTA                                                 04712000
JFCHIER  EQU   JFCBFTEK                                                 04713000
JFCBFOUT EQU   JFCBUFNO                                                 04714000
JFCBUFIN EQU   JFCBUFNO                                                 04715000
JFCTEMP  EQU   JFCBIND2                                                 04716000
JFCREQ   EQU   JFCBIND2                                                 04717000
JFCENT   EQU   JFCBIND2                                                 04718000
JFCSHARE EQU   JFCBIND2                                                 04719000
JFCSECUR EQU   JFCBIND2                                                 04720000
JFCDISP  EQU   JFCBIND2                                                 04721000
JFCPDS   EQU   JFCBIND1                                                 04722000
JFCGDG   EQU   JFCBIND1                                                 04723000
JFCADDED EQU   JFCBIND1                                                 04724000
JFCLOC   EQU   JFCBIND1                                                 04725000
JFCBCRDT EQU   INFMJFCB+80                                              04726000
JFCBOPS2 EQU   JFCBMASK+7                                               04727000
JFCRCTLG EQU   JFCBFLG2                                                 04728000
JFCBBUFF EQU   JFCBFLG2                                                 04729000
JFCTRACE EQU   JFCBFLG2                                                 04730000
JFCSDRPS EQU   JFCBFLG2                                                 04731000
JFCMODNW EQU   JFCBFLG2                                                 04732000
JFCNRPS  EQU   JFCDEFER                                                 04733000
JFCOUTOP EQU   JFCBFLG2                                                 04734000
JFCINOP  EQU   JFCBFLG2                                                 04735000
JFCBPWBP EQU   JFCOPEN                                                  04736000
@NM00049 EQU   JFCOPEN                                                  04737000
JFCDUAL  EQU   JFCBFLG1                                                 04738000
JFCSLDES EQU   JFCBFLG1                                                 04739000
JFCSLCRE EQU   JFCBFLG1                                                 04740000
JFCSTAND EQU   JFCBFLG1                                                 04741000
JFCBOPS1 EQU   JFCBMASK                                                 04742000
JFCBVLSQ EQU   INFMJFCB+70                                              04743000
JFCRSV31 EQU   JFCFUNC                                                  04744000
JFCFNCBT EQU   JFCFUNC                                                  04745000
JFCFNCBX EQU   JFCFUNC                                                  04746000
JFCFNCBD EQU   JFCFUNC                                                  04747000
JFCFNCBW EQU   JFCFUNC                                                  04748000
JFCFNCBP EQU   JFCFUNC                                                  04749000
JFCFNCBR EQU   JFCFUNC                                                  04750000
JFCFNCBI EQU   JFCFUNC                                                  04751000
JFCBFOFL EQU   JFCBUFOF                                                 04752000
JFCNL    EQU   JFCBLTYP                                                 04753000
JFCSL    EQU   JFCBLTYP                                                 04754000
JFCNSL   EQU   JFCBLTYP                                                 04755000
JFCSUL   EQU   JFCBLTYP                                                 04756000
JFCBLP   EQU   JFCBLTYP                                                 04757000
JFCBLTM  EQU   JFCBLTYP                                                 04758000
JFCBAL   EQU   JFCBLTYP                                                 04759000
JFCRSV38 EQU   JFCBLTYP                                                 04760000
JFCNLREC EQU   INFMJFCB+62                                              04761000
JFCBADBF EQU   INFMJFCB+60                                              04762000
JFCAMSTR EQU   JFCBFRID+2                                               04763000
JFCAMCRO EQU   JFCBFRID                                                 04764000
JFCBDSCB EQU   INFMJFCB+53                                              04765000
JFCPAT   EQU   JFCBTSDM                                                 04766000
JFCNDCB  EQU   JFCBTSDM                                                 04767000
JFCNDSCB EQU   JFCBTSDM                                                 04768000
JFCNWRIT EQU   JFCBTSDM                                                 04769000
JFCTTR   EQU   JFCBTSDM                                                 04770000
JFCSDS   EQU   JFCBTSDM                                                 04771000
JFCVSL   EQU   JFCBTSDM                                                 04772000
JFCCAT   EQU   JFCBTSDM                                                 04773000
JFCIPLTX EQU   JFCBELNM                                                 04774000
JFCBQNAM EQU   JFCBDSNM                                                 04775000
@NM00048 EQU   CPUID+150                                                04776000
CPUPURGE EQU   CPUID+148                                                04777000
@NM00047 EQU   CPUMAP+5                                                 04778000
CPURES2  EQU   CPUTYPE                                                  04779000
CPUASSOC EQU   CPUTYPE                                                  04780000
CPURES1  EQU   CPUTYPE                                                  04781000
CPUDNEXT EQU   CPUID+16                                                 04782000
CPUINEXT EQU   CPUID+14                                                 04783000
@NM00046 EQU   CPUID+13                                                 04784000
CPUNAME  EQU   CPUID                                                    04785000
@NM00045 EQU   GVSVOLFL+2                                               04786000
GVSRCFSI EQU   GVSVOLFL+2                                               04787000
@NM00044 EQU   GVSHDR+20                                                04788000
@NM00043 EQU   GVSHDR+17                                                04789000
@NM00042 EQU   GVSFLAGA+2                                               04790000
@NM00041 EQU   GVSTYPE                                                  04791000
@NM00040 EQU   GVSTYPE                                                  04792000
GVSNO    EQU   GVSID+1                                                  04793000
GVSRES1  EQU   GVSID                                                    04794000
GVSG     EQU   GVSNAME                                                  04795000
@NM00039 EQU   GROUP+136                                                04796000
GROADDR  EQU   GROUP+106                                                04797000
GROOWNER EQU   GROUP+96                                                 04798000
GRORESSP EQU   GROUP+95                                                 04799000
GROCONUS EQU   GROUP+94                                                 04800000
GRODESCR EQU   GROUP+64                                                 04801000
GROERRTM EQU   GROERRTS+4                                               04802000
GROERRDT EQU   GROERRTS                                                 04803000
GROFREXT EQU   GROUP+48                                                 04804000
GROFRESP EQU   GROUP+44                                                 04805000
GROSTRSH EQU   GROUP+40                                                 04806000
GRONINAC EQU   GROUP+34                                                 04807000
GRONRSTD EQU   GROUP+32                                                 04808000
GRONGEN  EQU   GROUP+30                                                 04809000
GROPCENT EQU   GROUP+29                                                 04810000
GROLSN   EQU   GROUP+23                                                 04811000
GROFSN   EQU   GROUP+17                                                 04812000
@NM00038 EQU   GROFLAGA+2                                               04813000
GROMSG1  EQU   GROFLAGA+2                                               04814000
GRORONLY EQU   GROFLAGA+2                                               04815000
GRODAERA EQU   GROFLAGA+2                                               04816000
GROEXCL  EQU   GROFLAGA+2                                               04817000
GROBIND  EQU   GROFLAGA+2                                               04818000
GRORES1  EQU   GROTYPE                                                  04819000
GROGVR   EQU   GROTYPE                                                  04820000
GROZERO  EQU   GROID+1                                                  04821000
GROBLANK EQU   GROID                                                    04822000
GROVVGRP EQU   GRONAME+3                                                04823000
GROG     EQU   GRONAME                                                  04824000
@NM00037 EQU   BASEV+188                                                04825000
BASRECOV EQU   BASEV+174                                                04826000
BASDEST  EQU   BASEV+144                                                04827000
BASOWNER EQU   BASEV+134                                                04828000
BASDESCR EQU   BASEV+104                                                04829000
BASDTREM EQU   BASEV+100                                                04830000
BASRES6  EQU   BASEV+89                                                 04831000
BASCOPNO EQU   BASCOPID+1                                               04832000
BASCOPBK EQU   BASCOPID                                                 04833000
BASCOPSN EQU   BASKLCPY+5                                               04834000
BASCOPV  EQU   BASKLCPY                                                 04835000
BASFREXT EQU   BASEV+72                                                 04836000
BASLEXT  EQU   BASEV+70                                                 04837000
BASFRESP EQU   BASEV+68                                                 04838000
@NM00036 EQU   BASEV+65                                                 04839000
BASBKLMT EQU   BASEV+64                                                 04840000
BASNBKUP EQU   BASEV+63                                                 04841000
BASNCOPY EQU   BASEV+62                                                 04842000
BASNEXTV EQU   BASEV+56                                                 04843000
BASPREV  EQU   BASEV+50                                                 04844000
BAS2BIT2 EQU   BASLID2                                                  04845000
BAS2BIT1 EQU   BASLID2                                                  04846000
BASRES5  EQU   BASLIB2                                                  04847000
BASCSN2  EQU   BASEV+37                                                 04848000
BAS1BIT2 EQU   BASLID1                                                  04849000
BAS1BIT1 EQU   BASLID1                                                  04850000
BASRES4  EQU   BASLIB1                                                  04851000
BASCSN1  EQU   BASEV+24                                                 04852000
BASRES3  EQU   BASMISCF                                                 04853000
BASHOLD  EQU   BASMISCF                                                 04854000
BASRES8  EQU   BASSATIA                                                 04855000
BASVSMIS EQU   BASSATIA                                                 04856000
BASIVCPY EQU   BASSATIA                                                 04857000
BASIVCRE EQU   BASSATIA                                                 04858000
@NM00035 EQU   BASFLAGA+3                                               04859000
BASLAST  EQU   BASFLAGA+3                                               04860000
BASFIRST EQU   BASFLAGA+3                                               04861000
BASREASS EQU   BASFLAGA+3                                               04862000
BASRONLY EQU   BASFLAGA+3                                               04863000
BASDAERA EQU   BASFLAGA+3                                               04864000
BASEXCL  EQU   BASFLAGA+2                                               04865000
BASBIND  EQU   BASFLAGA+2                                               04866000
BASINAC  EQU   BASFLAGA+2                                               04867000
BASGRPV  EQU   BASFLAGA+2                                               04868000
BASNOCPY EQU   BASFLAGA+2                                               04869000
BASDLSF  EQU   BASFLAGA+2                                               04870000
BASRES2  EQU   BASTYPE                                                  04871000
BASBASVR EQU   BASTYPE                                                  04872000
BASRES1  EQU   BASTYPE                                                  04873000
BASRES7  EQU   BASEV+13                                                 04874000
BASZERO  EQU   BASID+1                                                  04875000
BASBLANK EQU   BASID                                                    04876000
BASEVKEY EQU   BASNAME                                                  04877000
RPLVRLN  EQU   RPLVSAM+48                                               04878000
@NM00034 EQU   RPLVSAM+44                                               04879000
@NM00033 EQU   RPLVOPT                                                  04880000
@NM00032 EQU   RPLVOPT                                                  04881000
@NM00031 EQU   RPLVSAM+28                                               04882000
RPLVACB  EQU   RPLVSAM+24                                               04883000
@NM00030 EQU   RPLVSAM+3                                                04884000
@NM00029 EQU   RPLVSAM                                                  04885000
@NM00028 EQU   RPLV+42                                                  04886000
RPLVDATE EQU   RPLV+38                                                  04887000
RPLVRES1 EQU   RPLFLAGA+1                                               04888000
RPLVJRNL EQU   RPLFLAGA                                                 04889000
RPLJRCVY EQU   RPLFLAGA                                                 04890000
RPLVVOP  EQU   RPLFLAGA                                                 04891000
RPLVVIN  EQU   RPLFLAGA                                                 04892000
RPLVCOMP EQU   RPLFLAGA                                                 04893000
RPLVPROG EQU   RPLFLAGA                                                 04894000
RPLVPOST EQU   RPLFLAGA                                                 04895000
RPLVRSV3 EQU   RPLV+24                                                  04896000
RPLVRSV2 EQU   RPLV+20                                                  04897000
RPLVRSV1 EQU   RPLV+16                                                  04898000
RPLASCBP EQU   RPLTCBPR                                                 04899000
RPLVECB  EQU   RPLV+4                                                   04900000
RPLVQPTR EQU   RPLV                                                     04901000
VVIUNUSD EQU   VVICB+116                                                04902000
VVINUSDC EQU   VVICB+112                                                04903000
VVITPFCH EQU   VVICB+108                                                04904000
VVIDVMEL EQU   VVICB+104                                                04905000
VVIVBSTF EQU   VVICB+100                                                04906000
VVISSOBA EQU   VVICB+96                                                 04907000
VVIVSCRA EQU   VVICB+92                                                 04908000
VVISTPTB EQU   VVICB+88                                                 04909000
VVIDVMTA EQU   VVICB+84                                                 04910000
VVIJUCB  EQU   VVICB+80                                                 04911000
VVIIUCB  EQU   VVICB+76                                                 04912000
VVIRES6  EQU   VVICB+72                                                 04913000
VVIRES5  EQU   VVICB+68                                                 04914000
VVIRES4  EQU   VVICB+64                                                 04915000
VVIVJL   EQU   VVICB+56                                                 04916000
VVIVRR   EQU   VVICB+52                                                 04917000
VVIQLSPL EQU   VVICB+48                                                 04918000
VVIQRPL2 EQU   VVICB+44                                                 04919000
VVIQRPL1 EQU   VVICB+40                                                 04920000
VVIVTRK  EQU   VVICB+37                                                 04921000
VVIOPCD  EQU   VVICB+36                                                 04922000
VVIVQMP  EQU   VVICB+32                                                 04923000
VVIECB1  EQU   VVICB+28                                                 04924000
VVICATAD EQU   VVICB+24                                                 04925000
VVIDCBAD EQU   VVICB+20                                                 04926000
VVIACBAD EQU   VVICB+16                                                 04927000
VVIFLG7  EQU   VVIFLGA                                                  04928000
VVIFLG6  EQU   VVIFLGA                                                  04929000
VVIFLG5  EQU   VVIFLGA                                                  04930000
VVIFLG4  EQU   VVIFLGA                                                  04931000
VVIFLG3  EQU   VVIFLGA                                                  04932000
VVIFLG2  EQU   VVIFLGA                                                  04933000
VVIFLG1  EQU   VVIFLGA                                                  04934000
VVIALCON EQU   VVICB+14                                                 04935000
VVIUCAT  EQU   VVICB+4                                                  04936000
VVICID   EQU   VVICB                                                    04937000
UCBERADR EQU   UCBUCS+12                                                04938000
UCBFCBID EQU   UCBUCS+8                                                 04939000
UCBERCNT EQU   UCBUCS+7                                                 04940000
UCBRSV51 EQU   UCBUCS+6                                                 04941000
UCBRSV50 EQU   UCBFCBOP                                                 04942000
UCBRSV49 EQU   UCBFCBOP                                                 04943000
UCBRSV48 EQU   UCBFCBOP                                                 04944000
UCBRSV47 EQU   UCBFCBOP                                                 04945000
UCBRSV46 EQU   UCBFCBOP                                                 04946000
UCBRSV45 EQU   UCBFCBOP                                                 04947000
UCBRSV44 EQU   UCBFCBOP                                                 04948000
UCBFCBO1 EQU   UCBFCBOP                                                 04949000
UCBUCSPE EQU   UCBUCSOP                                                 04950000
UCBRSV43 EQU   UCBUCSOP                                                 04951000
UCBRSV42 EQU   UCBUCSOP                                                 04952000
UCBRSV41 EQU   UCBUCSOP                                                 04953000
UCBRSV40 EQU   UCBUCSOP                                                 04954000
UCBRSV39 EQU   UCBUCSOP                                                 04955000
UCBUCSO2 EQU   UCBUCSOP                                                 04956000
UCBUCSO1 EQU   UCBUCSOP                                                 04957000
UCBUCSID EQU   UCBUCS                                                   04958000
UCBRV073 EQU   UCB3540X+7                                               04959000
UCBRV072 EQU   UCBDKBYT                                                 04960000
UCBRV071 EQU   UCBDKBYT                                                 04961000
UCBRV070 EQU   UCBDKBYT                                                 04962000
UCBRV069 EQU   UCBDKBYT                                                 04963000
UCBRV068 EQU   UCBDKBYT                                                 04964000
UCBRV067 EQU   UCBDKBYT                                                 04965000
UCBVLVER EQU   UCBDKBYT                                                 04966000
UCBDKAMX EQU   UCBDKBYT                                                 04967000
UCBVLSER EQU   UCB3540X                                                 04968000
UCBRDATA EQU   UCBOCR+4                                                 04969000
UCBFRID  EQU   UCBOCR                                                   04970000
UCBCLN   EQU   UCBMT+14                                                 04971000
UCBERG   EQU   UCBMT+12                                                 04972000
UCBMS    EQU   UCBMT+11                                                 04973000
UCBNB    EQU   UCBMT+10                                                 04974000
UCBPW    EQU   UCBMT+9                                                  04975000
UCBPR    EQU   UCBMT+8                                                  04976000
UCBSIO   EQU   UCBMT+6                                                  04977000
UCBTW    EQU   UCBMT+5                                                  04978000
UCBTR    EQU   UCBMT+4                                                  04979000
UCBTWT   EQU   UCBMT+3                                                  04980000
UCBTRT   EQU   UCBMT+2                                                  04981000
UCBCTD   EQU   UCBMT                                                    04982000
UCBWTOID EQU   UCBCMEXT+17                                              04983000
UCBRV043 EQU   UCBCMEXT+16                                              04984000
UCBASID  EQU   UCBCMEXT+14                                              04985000
UCBMFCNT EQU   UCBCMEXT+12                                              04986000
UCBPMSK  EQU   UCBCMEXT+10                                              04987000
UCBCCWOF EQU   UCBCMEXT+8                                               04988000
UCBRV041 EQU   UCBCMEXT+6                                               04989000
UCBRV036 EQU   UCBFLP1                                                  04990000
UCBRV035 EQU   UCBFLP1                                                  04991000
UCBRV034 EQU   UCBFLP1                                                  04992000
UCBRV033 EQU   UCBFLP1                                                  04993000
UCBRV032 EQU   UCBFLP1                                                  04994000
UCBRV031 EQU   UCBFLP1                                                  04995000
UCBSHRUP EQU   UCBFLP1                                                  04996000
UCBNSRCH EQU   UCBFLP1                                                  04997000
UCBSNSCT EQU   UCBCMEXT+4                                               04998000
UCBHPDV  EQU   @NM00027                                                 04999000
UCBHALI  EQU   @NM00027                                                 05000000
UCBRSV09 EQU   @NM00027                                                 05001000
UCBRSV08 EQU   @NM00027                                                 05002000
UCBRSV07 EQU   @NM00027                                                 05003000
UCBRSV06 EQU   @NM00027                                                 05004000
UCBRSV05 EQU   @NM00027                                                 05005000
UCBRSV04 EQU   @NM00027                                                 05006000
UCBDTI   EQU   UCBCMEXT+2                                               05007000
UCBSTI   EQU   UCBCMEXT+1                                               05008000
UCBETI   EQU   UCBCMEXT                                                 05009000
UCBEXTP  EQU   UCBEXTPT+1                                               05010000
UCBDDRSW EQU   UCBFLC                                                   05011000
UCBTICBT EQU   UCBFLC                                                   05012000
UCBIVRR  EQU   UCBFLC                                                   05013000
UCBIVRS  EQU   UCBFLC                                                   05014000
UCBITF   EQU   UCBFLC                                                   05015000
UCBUDE   EQU   UCBFLC                                                   05016000
UCBWAA   EQU   UCBFLC                                                   05017000
UCBATTP  EQU   UCBFLC                                                   05018000
UCBUNTYP EQU   UCBTBYT4                                                 05019000
UCBRSV11 EQU   UCBDVCLS                                                 05020000
UCBRSV10 EQU   UCBDVCLS                                                 05021000
UCB3CHAR EQU   UCBDVCLS                                                 05022000
UCB3UREC EQU   UCBDVCLS                                                 05023000
UCB3DISP EQU   UCBDVCLS                                                 05024000
UCB3DACC EQU   UCBDVCLS                                                 05025000
UCB3COMM EQU   UCBDVCLS                                                 05026000
UCB3TAPE EQU   UCBDVCLS                                                 05027000
UCBDVPWR EQU   UCB2OPT7                                                 05028000
UCBVLPWR EQU   UCB2OPT6                                                 05029000
UCB2OPT5 EQU   UCBTBYT2                                                 05030000
UCBRVDEV EQU   UCBRWTAU                                                 05031000
UCBRPS   EQU   UCBDUDN2                                                 05032000
UCB2OPT1 EQU   UCBTBYT2                                                 05033000
UCB2OPT0 EQU   UCBTBYT2                                                 05034000
UCB1FEA7 EQU   UCBTBYT1                                                 05035000
UCBD6250 EQU   UCB1FEA6                                                 05036000
UCBD1600 EQU   UCB1FEA5                                                 05037000
UCB1FEA4 EQU   UCBTBYT1                                                 05038000
UCB1FEA3 EQU   UCBTBYT1                                                 05039000
UCB1FEA2 EQU   UCBTBYT1                                                 05040000
UCB1FEA1 EQU   UCBTBYT1                                                 05041000
UCB1FEA0 EQU   UCBTBYT1                                                 05042000
UCBNAME  EQU   UCBOB+13                                                 05043000
UCBRV029 EQU   UCBWGT                                                   05044000
UCBVHRSN EQU   UCBWGT                                                   05045000
UCBVORSN EQU   UCBWGT                                                   05046000
UCBMTPXP EQU   UCBWGT                                                   05047000
UCBREW   EQU   UCBWGT                                                   05048000
UCBPUB   EQU   UCBWGT                                                   05049000
UCBOUT   EQU   UCBWGT                                                   05050000
UCBIN    EQU   UCBWGT                                                   05051000
UCBCPU   EQU   UCBOB+11                                                 05052000
UCBLCI   EQU   UCBOB+10                                                 05053000
UCBCNT   EQU   UCBOB+9                                                  05054000
UCBRV017 EQU   UCBCHM1                                                  05055000
UCBRV016 EQU   UCBCHM1                                                  05056000
UCBRV015 EQU   UCBCHM1                                                  05057000
UCBRV014 EQU   UCBCHM1                                                  05058000
UCBSPB   EQU   UCBPTH1                                                  05059000
UCBPPB   EQU   UCBPTH1                                                  05060000
UCBSPA   EQU   UCBPTH0                                                  05061000
UCBPPA   EQU   UCBPTH0                                                  05062000
UCBFLB7  EQU   UCBFLB                                                   05063000
UCBVALPH EQU   UCBFLB                                                   05064000
UCBCRHSN EQU   UCBFLB                                                   05065000
UCBCRHRV EQU   UCBFLB                                                   05066000
UCBRESVH EQU   UCBFLB                                                   05067000
UCBSPST  EQU   UCBFLB                                                   05068000
UCBASNS  EQU   UCBFLB                                                   05069000
UCBIORST EQU   UCBFLB                                                   05070000
UCBQISCE EQU   UCBFL1                                                   05071000
UCBACTV  EQU   UCBFL1                                                   05072000
UCBSAP   EQU   UCBFL1                                                   05073000
UCBNOTRC EQU   UCBCUB                                                   05074000
UCBPSNS  EQU   UCBFL1                                                   05075000
UCBUSING EQU   UCBPST                                                   05076000
UCBNOTRD EQU   UCBNRY                                                   05077000
UCBBUSYD EQU   UCBBSY                                                   05078000
UCBUA    EQU   UCBCHAN+1                                                05079000
UCBCHA   EQU   UCBCHAN                                                  05080000
UCBDADI  EQU   UCBSTAT                                                  05081000
UCBSYSR  EQU   UCBSTAT                                                  05082000
UCBPRES  EQU   UCBSTAT                                                  05083000
UCBALOC  EQU   UCBSTAT                                                  05084000
UCBUNLD  EQU   UCBSTAT                                                  05085000
UCBRESV  EQU   UCBSTAT                                                  05086000
UCBCHGS  EQU   UCBSTAT                                                  05087000
UCBONLI  EQU   UCBSTAT                                                  05088000
UCBID    EQU   UCBOB+2                                                  05089000
UCBALTPH EQU   UCBFL5                                                   05090000
UCBALTCU EQU   UCBFL5                                                   05091000
UCBNALOC EQU   UCBFL5                                                   05092000
UCBENVRD EQU   UCBFL5                                                   05093000
UCBVSDR  EQU   UCBFL5                                                   05094000
UCBSASK  EQU   UCBFL5                                                   05095000
UCBAMV   EQU   UCBAF                                                    05096000
UCBDCC   EQU   UCBFL5                                                   05097000
UCBMONT  EQU   UCBJBNR                                                  05098000
UCBRV011 EQU   UCBJBNR                                                  05099000
UCBRSV02 EQU   UCBJBNR                                                  05100000
UCBOLDSM EQU   UCBJBNR                                                  05101000
UCBRV003 EQU   UCBJBNR                                                  05102000
UCBRV002 EQU   UCBJBNR                                                  05103000
UCBJES3  EQU   UCBJBNR                                                  05104000
UCBVRDEV EQU   UCBJBNR                                                  05105000
UCBCMSEG EQU   UCBOB                                                    05106000
UCBPFXND EQU   UCB+512                                                  05107000
UCBIOQ   EQU   UCB+508                                                  05108000
UCBLOCK  EQU   UCB+504                                                  05109000
UCBPXST  EQU   UCB+504                                                  05110000
@NM00024 EQU   UCB                                                      05111000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      05112000
@RF00235 EQU   @EL00001                                                 05113000
@RF00271 EQU   @EL00001                                                 05114000
@RT00405 EQU   @EL00002                                                 05115000
@RF00418 EQU   @EL00002                                                 05116000
@RF00432 EQU   @EC00437                                                 05117000
@RC00564 EQU   @RC00562                                                 05118000
@RF00634 EQU   @RC00632                                                 05119000
@RC00640 EQU   @RC00632                                                 05120000
@RF00717 EQU   @EL00005                                                 05121000
@RC00720 EQU   @EL00005                                                 05122000
@RF00935 EQU   @RC00924                                                 05123000
@RF01002 EQU   @EL00015                                                 05124000
@RC00995 EQU   @EL00015                                                 05125000
@RC00993 EQU   @EL00015                                                 05126000
@RF01004 EQU   @EL00015                                                 05127000
@RC01010 EQU   @EL00015                                                 05128000
@RC00722 EQU   @RC00720                                                 05129000
@ENDDATA EQU   *                                                        05130000
         END   ICBVMT00,(C'PLS1244',0701,78158)                         05131000
